# StackOverflow 问答 11937000-11937999

# java - Vaadin 未找到请求的资源

> ID：11937002
> 
> 赞同：0
> 
> 时间：2012-08-13T15:02:10.583
> 
> 标签：java, vaadin, oc4j

我们正在开发一个 Vaadin 应用程序，在 oc4j 10.1.3 上运行它。有一个窗口，可以将查询结果导出为 csv 文件。将 csv 文件创建为 vaadin FileResource 后，打开文件失败。这是片段：

```
File file = exporter.exportToFile();
final FileResource resource = new FileResource(file, getApplication());
resource.setCacheTime(0);
resource.getStream().setParameter("Content-Disposition", "attachment;filename=\""+file.getName()+"\"");
event.getButton().getWindow().open(resource); 
```

此时，资源的uri为：`app://APP/1/xy.csv`

我们有一个过滤器用于重定向“/VAADIN”的“/”路径。当这个过滤器被调用时，文件的 uri`/VAADIN/APP/1/xy.csv`不是`/APP/1/xy.csv`，所以我删除了不必要的 /VAADIN 部分，并`requestdispatcher.forward`使用新的 uri 调用。但有趣的是，应用程序仍然失败，它在日志中说：

```
Aug 13, 2012 1:55:58 PM com.vaadin.terminal.gwt.server.AbstractApplicationServlet serveStaticResourcesInVAADIN
INFO: Requested resource [VAADIN/APP/1/xy.csv] not found from filesystem or through class loader. Add widgetset and/or theme JAR to your classpath or add files to WebContent/VAADIN folder. 
```

所以uri又错了。它出现在地址栏中，应用程序重置到主页。但是，由于此 uri 仍在地址栏中，当我尝试再次创建 csv 文件时，在应用程序中执行与其他一些查询相同的操作时，导出部分确实会返回一个文件，即先前生成的文件。如果我尝试再次进行另一个查询（之前的 url 仍在浏览器的地址栏中），它似乎会生成新的 csv 文件，但会再次返回第一个文件。

它是一个 vaadin 错误还是一些 oc4j 魔法？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T23:12:20.827

Vaadin 框架在服务器端工作。那么为什么需要在服务器上创建不必要的临时 CSV 文件呢？尝试将所需数据直接导出到流中。

如果您需要导出少量数据，只需使用 ByteArrayOutputStream 和 Vaadin StreamResource。将您的 CSV 值写入 OutputStream 并将此流赋予如下功能：

```
 public void openResourceFromStream(final OutputStream out, String filename) {
    StreamSource streamSource = new StreamSource() {
        private static final long serialVersionUID = 1L;

        @Override
        public InputStream getStream() {
            ByteArrayOutputStream byteStream = (ByteArrayOutputStream) out;
            return new ByteArrayInputStream(byteStream.toByteArray());
        }
    };

    Resource sr = new StreamResource(streamSource, filename, getApplication());
    getWindow().open(sr, "_parent");
    } 
```

如您所见，此代码执行从 OutputStream 到 InputStream 的简单对话，并使用结果 InputStream 来创建 Vaadin StreamResource 对象。

'filename' 参数设置将加载到客户端浏览器中的文件的默认名称（注意，用户始终可以使用“始终显示保存对话框”浏览器选项“即时”重命名文件）。

当然，这个变体有点难看，因为它将所有导出的数据保存在内存中。

如果您需要导出大量数据并且不想将它们全部保存在内存中，则可以使用 PipedOutputStream 或自定义循环缓冲区而不是 ByteArrayOutputStream 字节缓冲区。算法将是相同的。有关更多信息，请参阅[有关 OutputStream 到 InputStream 对话的文章](http://ostermiller.org/convert_java_outputstream_inputstream.html) 和[有关资源的 Vaadin 书籍章节](https://vaadin.com/book/-/page/application.resources.html)。

PS不要忘记在数据导出成功后完全关闭输入和输出流。

# hibernate - Hibernate 错误：重复的集合角色映射

> ID：11937004
> 
> 赞同：1
> 
> 时间：2012-08-13T15:02:15.927
> 
> 标签：hibernate, mapping

我使用 hibernate 对一些 mySQL 表进行逆向工程，这些表与`ID`字段的外键链接。现在我`org.hibernate.DuplicateMappingException: Duplicate collection role mapping com.hibernate.user.User.empHours.`在摆弄我的代码之前已经解决了这个问题，但是我不得不重做逆向工程，这次似乎无法摆脱错误。如果有人可以解释如何解决问题以及发生了什么，以便我了解将来如何解决它，将不胜感激。

用户信息 .hbm.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.hibernate.user.User" table="user" catalog="secondsql">
        <id name="id" type="java.lang.String">
            <column name="ID" length="10" />
            <generator class="assigned" />
        </id>
        <property name="username" type="java.lang.String">
            <column name="Username" length="20" unique="true" />
        </property>
        <property name="password" type="java.lang.String">
            <column name="Password" length="20" />
        </property>
        <property name="firstName" type="java.lang.String">
            <column name="FirstName" length="20" />
        </property>
        <property name="lastName" type="java.lang.String">
            <column name="LastName" length="20" />
        </property>
        <property name="resume" type="java.lang.String">
            <column name="Resume" length="100" />
        </property>
        <property name="admin" type="java.lang.Boolean">
            <column name="admin" not-null="true" />
        </property>
        <property name="colorScheme" type="java.lang.String">
            <column name="colorScheme" length="10" not-null="true" />
        </property>
        <set name="empHours" inverse="true" table="emp_hours">
            <key>
                <column name="ID" length="10" />
            </key>
            <one-to-many class="com.hibernate.hours.EmpHours" />
        </set>
    </class>
</hibernate-mapping> 
```

员工工时 .hbm.xml

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.hibernate.hours.EmpHours" table="emp_hours" catalog="secondsql">
        <id name="timesheetId" type="java.lang.Long">
            <column name="Timesheet_ID" />
            <generator class="identity" />
        </id>
        <many-to-one name="user" class="com.hibernate.user.User" fetch="select">
            <column name="ID" length="10" />
        </many-to-one>
        <property name="weekOf" type="java.util.Date">
            <column name="WeekOf" length="10" />
        </property>
        <property name="workType" type="java.lang.String">
            <column name="Work_Type" length="20" />
        </property>
        <property name="monday" type="java.lang.Integer">
            <column name="Monday" />
        </property>
        <property name="tuesday" type="java.lang.Integer">
            <column name="Tuesday" />
        </property>
        <property name="wednesday" type="java.lang.Integer">
            <column name="Wednesday" />
        </property>
        <property name="thursday" type="java.lang.Integer">
            <column name="Thursday" />
        </property>
        <property name="friday" type="java.lang.Integer">
            <column name="Friday" />
        </property>
        <property name="saturday" type="java.lang.Integer">
            <column name="Saturday" />
        </property>
        <property name="sunday" type="java.lang.Integer">
            <column name="Sunday" />
        </property>
        <property name="weekTotal" type="java.lang.Integer">
            <column name="Week_Total" />
        </property>
    </class>
</hibernate-mapping> 
```

我发现这个错误的有趣之处在于 empHours 在`com.hibernate.hours`并且用户信息在`com.hibernate.user`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:41:46.273

如果有人偶然发现这一点，我只使用注释映射解决了这个问题，而不是`.hbm.xml`使用起来更简单。

# android - Android - 从网络线程更改 ViewElements（或其他方式）

> ID：11937008
> 
> 赞同：0
> 
> 时间：2012-08-13T15:02:30.620
> 
> 标签：android, multithreading, user-interface

我已经在两部 Android 手机之间实现了套接字连接。本地电话需要更新一些视图元素，因为我想在自制地图上显示位置。

Android 编程指南不允许从我的活动之外更改视图元素。这意味着我不能调用这样的方法：

```
mainActivity.updateView(positionX); 
```

因为我会在网络线程中运行它。那么官方的做法是什么呢？我知道有*runOnUIThread*但乍一看似乎是一个快速修复。

或者我应该需要一个 AsyncTask 吗？但是 API 说对于较长的任务不可行，我需要线程一直在后台运行（并且经常获取更新）。

那么创建一个新的 Handler/AsyncTask 来简单地在 MainActivity 的其他地方设置一个小图标不是一件大事吗？毕竟，我假设每秒甚至可能有 50 次更改。

希望这里有人知道正确的方法。谢谢！

PS 好的，所以请允许我问一下，是否至少有一个选项可以覆盖诸如 onDraw 方法之类的东西。毕竟，这听起来像是最好的主意，因为总是创建新线程似乎有点矫枉过正。所以我想告诉“redraw()”方法来获取我在网络线程中存储（同步）的信息。所以我不需要任何进一步的线程。有人知道吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:16:36.577

你应该使用处理程序！处理程序是做你想做的事的好方法。您应该在 Activity 中实现一个处理程序，如下所示：

```
private class NetworkHandler extends Handler {

    @Override
    public void handleMessage(Message msg) {
        Bundle data = msg.getData();
        int message = data.getInt("message");
        switch (message) {

        case Network.NET_GAME_FINISHED: UPDATE YOUR UI
                                                    break;
                    case ...
                    }
             }
} 
```

当您从网络接收到某些东西时，您只需向该处理程序发送一条消息。

看看[这个](http://www.vogella.com/articles/AndroidPerformance/article.html)教程。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:20:27.213

如果您有对活动的引用，则可以在 UI 线程上运行代码，如下所示：

```
 Activity activity = getActivity();
    activity.runOnUiThread (new Runnable() {
                            @Override
                            public void run() {
                                //UI thread code here
                            }
                        }); 
```

就个人而言，我会使用 AsyncTask，因为该类在优化创建新线程和管理其生命周期的过程方面做了更多工作。在 AsyncTask 中，您可以简单地将 UI 代码放在 onPostExecute() 方法中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:10:56.557

我建议让您的活动注册以接收意图，并且您在网络线程上运行的代码可以广播该意图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T15:12:14.923

如何使用服务来处理您的套接字（因为它是一个可以在后台运行的长时间运行的任务）并使用[处理](http://developer.android.com/reference/android/os/Handler.html)程序和消息实现您的 UI 和服务之间的通信（或者可能使用服务的[AIDL](http://developer.android.com/guide/components/aidl.html)接口和另一个朝向你的用户界面，但这会更复杂）？

# json - 资源表示的 XML 格式是否比 REST API 中的 JSON 更不容易引入破坏性更改？

> ID：11937013
> 
> 赞同：0
> 
> 时间：2012-08-13T15:02:38.663
> 
> 标签：json, rest

如果您的 REST api 的数据表示使用 XML 而不是 JSON，这是否有助于在不破坏客户端的情况下修改数据表示？

例如，如果今天我们在数据表示中有名字、姓氏，明天我们在这个表示中添加一个电子邮件地址，我可以看到如果我们使用 XML，我们可能要做的就是添加一个新的 XML 元素这不会影响现有元素。使用“旧”表示的客户将简单地忽略/跳过新的电子邮件元素。

JSON 也一样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:10:54.457

是的，只要您使用命名键而不是数字索引，JSON 也是如此。想象以下 XML：

```
<xml>
<person>
    <first_name>Person</first_name>
</person>
</xml> 
```

这可以表示为以下 JSON：

```
{
    person: {
        "first_name": "Person"
    }
} 
```

在这里，您可以在两个片段中的 first_name 之后添加 last_name，它适用于任何按名称访问元素的客户端。

# mercurial - TortoiseHg - 显示未推送的提交

> ID：11937021
> 
> 赞同：1
> 
> 时间：2012-08-13T15:02:59.350
> 
> 标签：mercurial, tortoisehg

这种情况发生了不止一次，我会提交一些代码，然后忘记将代码实际推送到我们的远程存储库（直到我的老板告诉我 XYZ 仍然不起作用，我觉得很傻）。

有什么方法可以让 Tortoise 显示未以不同方式推送的已提交代码？理想情况下，如果有办法让这些变更集以灰色背景或其他方式显示，我会很高兴。

所以在下面的屏幕截图中，如果版本 1270 没有被推送，则显示为阴影，或以某种方式标记。

![在此处输入图像描述](../Images/593747b8835921ef1dbf698f8919cc95.png)

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:08:50.350

已推送的代码将以“公开”为阶段。未推送的代码将显示为“草稿”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:15:00.397

您可以使用[同步工具栏](http://tortoisehg.bitbucket.io/manual/2.4/workbench.html#sync-toolbar)查看您拥有的“传出”变更集。

# php - 显示多个父级的子页面，同时删除父级

> ID：11937027
> 
> 赞同：0
> 
> 时间：2012-08-13T15:03:12.617
> 
> 标签：php, wordpress, loops, wordpress-theming

结构：

*   家

    *   项目
        *   项目页面 1
            *   项目一
        *   项目页面 2
            *   项目 2
        *   项目页面 3
            *   项目 3

我想遍历项目类别以便按 desc 顺序显示页面。

我到目前为止：

```
<?php query_posts("posts_per_page=2&post_type=page&order=DESC&post_parent=61&exclude=168,170,166");

if ( have_posts() ) :
                    while ( have_posts() ) : the_post(); ?> 
```

但是，这仅显示项目页面，而不是项目本身。我不确定排除是否在查询中起作用。

编辑：

我发现它使用 args_merge 返回所有子页面。我想知道如何修改它以便只返回所有子页面中的两个最新帖子。

```
<? $args = array( 
             'child_of'    => 61,
             'sort_column' => 'post_date',
             'sort_order'  => 'desc'
        );
$child_pages = get_pages( $args );

$args['child_of'] = 166;
        $second_page_group = get_pages( $args );
        $child_pages = array_merge( $child_pages, $second_page_group );
$args['child_of'] = 168;
        $third_page_group = get_pages( $args );
        $child_pages = array_merge( $child_pages, $third_page_group );
$args['child_of'] = 170;
        $forth_page_group = get_pages( $args );
        $child_pages = array_merge( $child_pages, $forth_page_group );
unset( $second_page_group, $third_page_group, $args );

if( !empty( $child_pages ) )
foreach( $child_pages as $_my_page ) {
    $title   = apply_filters( 'the_title', $_my_page->post_title );
    //$content = apply_filters( 'the_content', $_my_page->post_content );
    //$content = str_replace( ']]>', ']]&gt;', $content );
    $link    = apply_filters( 'the_permalink', get_permalink( $_my_page->ID ) );
                ?> 
```

然而，这似乎有点过分。我添加了第三个块，并从找到的原始帖子中稍微编辑了[https://wordpress.stackexchange.com/questions/5580/child-page-from-2-different-parent-pages](https://wordpress.stackexchange.com/questions/5580/child-page-from-2-different-parent-pages)

# python - subprocess.popen 的 poll 方法返回 None 用于长进程

> ID：11937028
> 
> 赞同：8
> 
> 时间：2012-08-13T15:03:12.617
> 
> 标签：python, subprocess, popen

我正在通过子进程执行 curl 命令。此 curl 命令在另一台服务器上启动视频处理，并等待响应。该过程完成后，远程服务器返回 json 对象。我正在使用 poll() 值检查子进程的状态，即 None - 进程未完成，0- 进程成功完成，1- 错误。

如果远程服务器上的处理时间约为 30 分钟/或更短，我会得到正确的响应，但如果处理时间更长，我只会得到 None 值，即使我可以看到远程服务器已经完成处理并且已经返回 json 对象。

谁能告诉我， poll() 在特定时间后只返回 None 的可能原因是什么。先感谢您。

我的 Popen 对象是：

```
object = subprocess.Popen(str(curlCmd), shell=True,
                           stdout=subprocess.PIPE,
                           stderr=subprocess.PIPE) 
```

我`object.poll()`每 2 秒调用一次以检查该过程是否成功完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-06T09:24:12.313

`.poll() is None`表示孩子还在跑。

除非您从管道的末端读取，否则该`curl` 进程可能会在其填充其 stdout 或 stderr OS 管道缓冲区（在我的 Linux 机器上大约 64K）时挂起。

也就是说，当您等待孩子完成时，孩子等待您排空管道缓冲区 - **deadlock**。从[文档](https://docs.python.org/3/library/subprocess.html#subprocess.Popen.poll)：[_`subprocess`](https://docs.python.org/3/library/subprocess.html#subprocess.Popen.poll)

> this[ `.wait()`] 在使用`stdout=PIPE`or时会死锁，`stderr=PIPE`并且子进程会向管道生成足够的输出，从而阻塞等待 OS 管道缓冲区接受更多数据。在使用`Popen.communicate()` 管道时使用以避免这种情况。

您可以使用线程 async.io 来同时使用管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T07:17:11.610

在 python 2.7 和可能的 3.x 中可以使用：

```
object._internal_poll(_deadstate=127) 
```

而不是常规`Popen.poll()`的解决方法。如果进程终止，这将返回 127 而不是 None。

当然，这是一个内部模块的方法，不能保证在 Python 的库更新后它会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-23T15:37:03.190

为了补充 hegemon，此代码适用于 2.7：

```
process = subprocess.Popen(cmd, cwd=current_dir, shell=True, stdout=subprocess.PIPE, stdin=subprocess.PIPE, stderr=subprocess.PIPE )
process._internal_poll(_deadstate='dead')

while timeout > 0:
  if process.poll() is not 'dead': 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T18:00:34.393

最后我最终使用 PyCurl 而不是创建一个子进程并通过它调用 curl 命令。这似乎是一个引发的问题位 subprocess ，其中 .poll 方法在一定时间后没有返回，原因尚不清楚。如果您正在运行长进程，我想通知正在使用 subprocess-poll 方法（无需等待/通信）的人要注意这一点。感谢 JF Sebastian 和 Pranav 的指导。

# blackberry - 在真正的 BlackBerry 设备/模拟器上调试失败

> ID：11937031
> 
> 赞同：1
> 
> 时间：2012-08-13T15:03:24.600
> 
> 标签：blackberry, java-me, blackberry-simulator, blackberry-eclipse-plugin

嗨，我正在尝试在黑莓粗体 9900 上调试我的应用程序。当我尝试在真实设备上调试它时，eclipse 会抛出一个错误，提示“无法获取 jre6 的调试器”，同样，当我尝试在模拟器上调试时它会抛出错误提示“无法获取 Blackberry JRE 7.1.0 的调试器”。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T12:25:28.837

“jre6”消息听起来像是您在调试配置中使用了错误的运行时库。

在 Eclipse 中，右键单击项目并转到`Debug As`-> `Debug configurations`。然后单击`JRE`选项卡，确保您使用的是 BlackBerry `Runtime JRE`。

# html - Wicket：使用 ajax 使用重复表单的更好方法是什么？

> ID：11937033
> 
> 赞同：0
> 
> 时间：2012-08-13T15:03:29.707
> 
> 标签：html, ajax, wicket

我有以下课程：

```
public class Group {
    private long id;
    private String name;
    ...
    private List<Person> members;
}

public class Person {
    private long id;
    private String name;
    private String comments;
} 
```

我有以下检票口面板：

```
<wicket:panel>
   <div>
     <!-- Group data -->
   </div>
   <form wicket:id="group">
   <table>
      <tbody wicket:id="container">
         <tr wicket:id="members">
             <td wicket:id="personId"></td>
             <td wicket:id="name"></td>
             <td><input type="text" name="comments" wicket:id="comments" value="" /></td>
         </tr>
      </tbody>
   </table>
   <input type="submit" value="save" >
   </form>      
</wicket:panel> 
```

另一方面，我有一个具有过滤功能的网页并向我显示不同的组：

```
<html>
<body>
   <form wicket:id="filterOptions">
     <!-- filter options -->
   </form>
   <div wicket:id="resultingGroups">
       <!-- contains the groups that matching the filters -->
   </div>
</body>
</html> 
```

我想更新执行 ajax 提交的组。我尝试使用 ListView，但是，我不知道为什么，当我单击“保存”按钮时，更改会反映在第一个组面板中，如果我更新任何其他组并单击“保存”，则组对象不会更新。

我研究了很多，发现 ListView 不是我想做的好选择，但我不知道哪个 View 是正确的。

过滤器表单也适用于 ajax 按钮，并且工作正常。

我对 Wicket 很陌生。

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T13:23:15.140

实际上 ListView、DataView 和其他中继器对你想做的事情有好处。

*   ListView 应该由带有您想要的项目集合的模型填充

```
    ListModel peopleModel = //... DAO 访问（数据库）
    ListView peopleList = new ListView("resultingGroups", peopleModel){ ... };

```

*   为了重新绘制（刷新 ListView），您应该将其封装`peopleList`在一个容器中`.setOutputMarkupId(true);`（以便 Wicket 能够通过 ajax 找到该容器）。

```
...
    WebMarkupContainer peopleContainer = new WebMarkupContainer("container");
    peopleContainer.setOutputMarkupId(true);
    peopleContainer.add(peopleList);
...

```

*   ...然后每当您想刷新 List 中显示的结果时，您需要将新结果设置为模型 ( `peopleModel`) 并**重新绘制具有 ListView** ( `(*)`)的容器

```
公共无效 onEvent（AjaxRequestTarget 目标）{
    //...点击按钮或其他东西
    newPeopleList = // ... DAO
    peopleModel.setObject(newPeopleList);

    目标.add(peopleContainer); // (*) 重绘
}

```

希望有帮助。更多示例在这里

[https://cwiki.apache.org/WICKET/how-to-repaint-a-listview-via-ajax.html](https://cwiki.apache.org/WICKET/how-to-repaint-a-listview-via-ajax.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T15:12:09.820

检查[https://github.com/vineetsemwal/quickview/wiki](https://github.com/vineetsemwal/quickview/wiki)

# vb.net - SSIS 包中的脚本任务到 FTP

> ID：11937054
> 
> 赞同：3
> 
> 时间：2012-08-13T15:04:58.980
> 
> 标签：vb.net, ssis

全部，

我有一个 SSIS 包（Sql Server 2008），它执行一些数据流和文件操作，然后最终将文件上传到 FTP 服务器。

我能够完成大部分工作，但最后一个关键部分。使用“数据流”，使用来自数据库的数据生成一个文本文件。现在该文件已在末尾带有时间戳压缩，例如：“filename_08132012.zip”。

时间戳每天都在变化，所以每次上传到 FTP 服务器都是一个新文件。因此，我有一个“脚本任务”来查找具有今天日期的文件并将其上传到 FTP 服务器，而不是“FTP 任务”（我想不出一种方法来完成这项工作）。以下是代码，但我有两个与此相关的问题：

1.  我希望这个“脚本任务”能够获取当天的文件，例如：filename_08132012.zip、filename_08142012.zip。我有将日期转换为格式正确的字符串的代码。但由于某种原因，事实并非如此。
2.  如何逐步执行此脚本文件，Visual Studio 是否允许 VB.net 代码？此脚本任务 GUI 不允许单步执行。
3.  它将一个空文件上传到 FTP 服务器。一个 0 字节的文件。我该如何解决这个问题？

```
' Microsoft SQL Server Integration Services Script Task
' Write scripts using Microsoft Visual Basic 2008.
' The ScriptMain is the entry point class of the script.

Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime

<System.AddIn.AddIn("ScriptMain", Version:="1.0", Publisher:="", Description:="")> _
<System.CLSCompliantAttribute(False)> _
Public Class ScriptMain
    Inherits Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
Enum ScriptResults
    Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success
    Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
End Enum

Public Sub Main()
    '
    ' Add your code here
    '

    Try

        'Create the connection to the ftp server

        Dim cm As ConnectionManager = Dts.Connections.Add("FTP")

        'Set the properties like username & password

        cm.Properties("ServerName").SetValue(cm, "172.24.97.21")

        cm.Properties("ServerUserName").SetValue(cm, "bbxuser")

        cm.Properties("ServerPassword").SetValue(cm, "blockbuster")

        cm.Properties("ServerPort").SetValue(cm, "21")

        cm.Properties("Timeout").SetValue(cm, "0") 'The 0 setting will make it not timeout

        cm.Properties("ChunkSize").SetValue(cm, "1000") '1000 kb

        cm.Properties("Retries").SetValue(cm, "1")

        'create the FTP object that sends the files and pass it the connection created above.

        Dim ftp As FtpClientConnection = New FtpClientConnection(cm.AcquireConnection(Nothing))

        'Connects to the ftp server

        ftp.Connect()

        'Build a array of all the file names that is going to be FTP'ed (in this case only one file)

        Dim files(0) As String

        Dim FileDate As Date
        FileDate = System.DateTime.Today

        files(0) = "D:\NCR\Apps\RBX.SSIS.BBX_Customer_Extract\Email_Campaign\Redbox_EmailCampaign_and_Analytics_Extract_" + FileDate.ToString("mmddyyyy") + ".zip"

        'ftp the file

        'Note: I had a hard time finding the remote path directory. I found it by mistake by creating both the FTP connection and task in the SSIS package and it defaulted the remote path setting in the FTP task.

        ftp.SendFiles(files, "/Email Campaign", True, False) ' the True makes it overwrite existing file and False is saying that it is not transferring ASCII

        ftp.Close()

    Catch ex As Exception

        Dts.TaskResult = ScriptResults.Failure

    End Try

    Dts.TaskResult = ScriptResults.Success
End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:13:36.493

在我写完这个问题之后，我想出了一些事情。

1.  我使用了不正确的格式。正确的格式是 FileDate.ToString("MMddyyyy") + ".zip"

```
files(0) = "D:\NCR\Apps\RBX.SSIS.BBX_Customer_Extract\Email_Campaign\Redbox_EmailCampaign_and_Analytics_Extract_" + FileDate.ToString("mmddyyyy") + ".zip"
files(0) = "D:\NCR\Apps\RBX.SSIS.BBX_Customer_Extract\Email_Campaign\Redbox_EmailCampaign_and_Analytics_Extract_" + FileDate.ToString("MMddyyyy") + ".zip" 
```

1.  （看上面）
2.  我刚刚找到了它并且它有效：[Troubleshoot Script Task](http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/e4362d4c-80fa-459b-8030-48f66e2a8664)
3.  解决 1 和 2，解决 3

# jquery - 如何使用 (This) 来定位带有 slideToggle JQuery 的类？

> ID：11937055
> 
> 赞同：0
> 
> 时间：2012-08-13T15:04:59.143
> 
> 标签：jquery

我需要了解（这个）是如何工作的。我见过许多使用它的不同案例和实例，但使用方式不同。我只想针对具有类名的几个 div 中的一个。我似乎无法让它正常工作。我已经阅读了 Stackoverflow 中的几个答案，但似乎仍然无法使用 (this) 来定位一个类。再次感谢您帮助我。

js

```
<script type="text/javascript">
  jQuery(document).ready(function(){
     jQuery('.expandCollapseMenu').click(function(){
      jQuery(this).parent().find('.menu_product_main_container').slideToggle();
    });
  });
</script> 
```

html

```
<div class="menu_category_category">
    <h3 class="basic_catolog">Beverages</h3>        
    <div class="toggle_menu">
        <img alt="" style="border: 0px none;" src="/images/icons/collapse_menu_icon_on.png" class="expandCollapseMenu {src: '/images/icons/expand_menu_icon.png'}" />
    </div>
</div>
<div class="menu_product_main_container">
    <p>Menu Item 1</p>
    <p>Menu Item 2</p>
</div>
<div class="menu_category_category">
    <h3 class="basic_catolog">Lunch</h3>
    <div class="toggle_menu">
    <img alt="" style="border: 0px none;" src="/images/icons/collapse_menu_icon_on.png" class="expandCollapseMenu {src: '/images/icons/expand_menu_icon.png'}" />
    </div>
</div>
<div class="menu_product_main_container">
    <p>Lunch Item 1</p>
    <p>Lunch Item 2</p>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:14:02.600

的值`this`取决于代码所在的上下文。

在事件处理程序的上下文中（例如传递给 的函数`.click()`），`this`将引用触发事件的元素（也称为*事件目标*）。

在迭代函数的上下文中，例如`.each()`，`this`将引用当前元素进行迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:09:17.310

它错过了一个`.parent()`

`jQuery(this).parent().find('.menu_product_main_container').slideToggle();`这条线你得到`<div class="toggle_menu">`

所以解决方案是`jQuery(this).parent().parent().find('.menu_product_main_container').slideToggle();`

编辑 ：

好的，缩进我们可以更好地看到问题。一个解决方案可以像这样放置一个新的 div

```
<div>
  <div class="menu_category_category">
    <h3 class="basic_catolog">Beverages</h3>        
    <div class="toggle_menu">
        <img alt="" style="border: 0px none;" src="/images/icons/collapse_menu_icon_on.png" class="expandCollapseMenu {src: '/images/icons/expand_menu_icon.png'}" />
    </div>
  </div>
  <div class="menu_product_main_container">
    <p>Menu Item 1</p>
    <p>Menu Item 2</p>
   </div>
</div> 
```

如果不更改 DOM，我对您的问题一无所知。

# c# - 如何根据文化仅显示日期和月份的日期字符串？

> ID：11937056
> 
> 赞同：3
> 
> 时间：2012-08-13T15:05:03.697
> 
> 标签：c#, windows-phone-7, datetime, windows-phone-7.1, datetime-format

我需要在 windows phone 上显示一些日期，只有日期和月份。

例如，1 月 1 日，对于美国用户，我希望文本为“1/31”，而对于英国用户，我希望文本为“31/1”。

实现这样的事情的最简单方法是什么？

**更新：** 我的应用程序将在许多国家/地区可用。我是否必须指定每种文化才能获得我想要的东西？

例如，

```
de-DE Culture                         01.10
en-US Culture                         10/1
es-ES Culture                         01/10
fr-FR Culture                         01/10 
```

左列包含我的应用程序将支持的一些国家/地区，右列是我希望我的日期文本的样子。

有什么通用的方法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:13:25.657

```
// 13 August
string americanDate = theDate.ToString("m", new CultureInfo("en-us"));

// August 13
string ukDate = theDate.ToString("m", new CultureInfo("en-gb")); 
```

有关可用格式的完整列表，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.aspx)。

编辑：

在您的应用程序中，不要手动指定`CultureInfo`实例：使用默认文化`DateTime.ToString`，即执行线程的文化。

所以你的代码变成：

```
string cultureSpecificDate = theDate.ToString("m"); 
```

`"m"`您在可用格式列表中选择的日期格式在哪里。您想要的似乎不是[`DateTimeFormatInfo`](http://msdn.microsoft.com/en-us/library/1at0z4ew)班级提供的标准。您不能在下面的列表中选择支持的模式吗？

```
/*
This code produces the following output.

FORMAT  en-US EXAMPLE
CHAR    VALUE OF ASSOCIATED PROPERTY, IF ANY

  d     1/3/2002
        M/d/yyyy (ShortDatePattern)

  D     Thursday, January 03, 2002
        dddd, MMMM dd, yyyy (LongDatePattern)

  f     Thursday, January 03, 2002 12:00 AM

  F     Thursday, January 03, 2002 12:00:00 AM
        dddd, MMMM dd, yyyy h:mm:ss tt (FullDateTimePattern)

  g     1/3/2002 12:00 AM

  G     1/3/2002 12:00:00 AM

  m     January 03
        MMMM dd (MonthDayPattern)

  M     January 03
        MMMM dd (MonthDayPattern)

  o     2002-01-03T00:00:00.0000000

  r     Thu, 03 Jan 2002 00:00:00 GMT
        ddd, dd MMM yyyy HH':'mm':'ss 'GMT' (RFC1123Pattern)

  R     Thu, 03 Jan 2002 00:00:00 GMT
        ddd, dd MMM yyyy HH':'mm':'ss 'GMT' (RFC1123Pattern)

  s     2002-01-03T00:00:00
        yyyy'-'MM'-'dd'T'HH':'mm':'ss (SortableDateTimePattern)

  t     12:00 AM
        h:mm tt (ShortTimePattern)

  T     12:00:00 AM
        h:mm:ss tt (LongTimePattern)

  u     2002-01-03 00:00:00Z
        yyyy'-'MM'-'dd HH':'mm':'ss'Z' (UniversalSortableDateTimePattern)

  U     Thursday, January 03, 2002 8:00:00 AM

  y     January, 2002
        MMMM, yyyy (YearMonthPattern)

  Y     January, 2002
        MMMM, yyyy (YearMonthPattern)

*/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T15:27:39.973

哇，这个问题特别有趣！我没有找到一些明显的解决方案，所以这里是：

```
 char[] trimmer = DateTimeFormatInfo.CurrentInfo.DateSeparator.ToCharArray();
    string dateStr = date.ToString("d").Replace(date.ToString("yyyy"), string.Empty).Trim(trimmer); 
```

如果你不能使用`DateTimeFormatInfo`，那么下面的代码应该可以解决问题：

```
string tmp = date.ToString("d").Replace(date.ToString("yyyy"), string.Empty);
char last = tmp[tmp.Length - 1];
char[] trimmer = char.IsDigit(last) ? new char[] { tmp[0] } : new char[] { last };
string dateStr = tmp.Trim(trimmer); 
```

正如[@ken2k](https://stackoverflow.com/users/870604/ken2k)正确提到的，这个解决方案也有缺陷（而且比我实际预期的要多得多）。这是完整的测试套件（[编译为控制台应用程序](http://ideone.com/jhtmQ)）：

```
using System;
using System.Diagnostics;
using System.Globalization;

class Program
{
    static void Main(string[] args)
    {
        CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.SpecificCultures);

        DateTime date = DateTime.Now;

        foreach (CultureInfo culture in cultures)
        {
            string tmp = date.ToString("d", culture).Replace(date.ToString("yyyy", culture), string.Empty);
            char last = tmp[tmp.Length - 1];
            char[] trimmer = char.IsDigit(last) ? new char[] { tmp[0] } : new char[] { last };
            string dateStr = tmp.Trim(trimmer);

            Console.WriteLine(string.Format("{0,12}, {1,15} => {2,10}", culture.IetfLanguageTag, date.ToString("d", culture), dateStr));
        }

        if (Debugger.IsAttached)
        {
            Console.WriteLine();
            Console.WriteLine("Press any key to exit..");
            Console.ReadKey();
        }
    }
} 
```

进一步的优化是可能的（至少在完整的框架中），但是它变得相当复杂（Windows Phone 的有限框架也增加了复杂性）并且不清楚这种日期表示在某些文化中是否有意义。例如，在某些文化中，日期部分分隔符是两个字符序列：

> 胡胡, 2012\. 08\. 14\. => 08\. 14

实际上`08\. 14`看起来不错吗？或者应该是`08\. 14.`？我不知道。如果我是你，并且我真的想处理最大数量的文化，我会坚持使用标准的“d”格式说明符。

# php - UNIX_TIMESTAMP 结果不正确

> ID：11937060
> 
> 赞同：-2
> 
> 时间：2012-08-13T15:05:16.970
> 
> 标签：php, mysql, date

我需要使用正确的日期从数据库中检查日期 + 1 个月。我尝试：

```
$todayDate = date("Y-m-d");
$dateOneMonthAdded = strtotime(date("Y-m-d", strtotime($todayDate)) . "+1 month");

$result = mysql_query('SELECT UNIX_TIMESTAMP("date") AS date FROM followform WHERE id = "28"') or die(mysql_error());  
$date = mysql_fetch_assoc($result);

if ($dateOneMonthAdded == $date['date']) echo 'nice'; 
```

但是 $date['date'] == 0

如果我使用 -`mysql_query('SELECT date FROM followform WHERE id = "28"')`

```
$date['date'] == 2012-08-13 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:10:34.907

`UNIX_TIMESTAMP("date")`应该是`UNIX_TIMESTAMP(date)`。使用引号，它试图将文字字符串“日期”转换为时间戳。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:11:19.807

`"`从`unix_timestamp`查询中的函数中删除双引号。它应该是：

```
SELECT UNIX_TIMESTAMP(date) AS date FROM followform WHERE id = "28" 
```

# php - 如何在 Zend 上启动多个页面的缓存？

> ID：11937074
> 
> 赞同：0
> 
> 时间：2012-08-13T15:05:59.480
> 
> 标签：php, zend-framework, caching, zend-cache

我有一个“文章”控制器和一个“视图”动作。我的操作采用 id 参数，允许访问者查看具有特定 id 的文章（从 mysql 数据库获取信息）。我想创建一个脚本来立即生成我所有的缓存。事实上，我不想等待我的访问者访问文章来生成我的缓存文件。任何提示我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:15:30.760

创建一个 cron 作业/计划任务并按照您选择的时间间隔生成它们。

# c# - 在 C++ 项目中读取 C# 函数

> ID：11937075
> 
> 赞同：1
> 
> 时间：2012-08-13T15:06:01.570
> 
> 标签：c#, visual-c++

再会，

我想采用现有的 C# 项目并将函数包装到 C++/CLI DLL 中。我需要能够从 VB 6 读取这个 DLL。我选择这条路线是因为我不必注册 .net DLL 就可以在 VB 6 中使用它。坦率地说，我对这种事情没有经验，所以我将不胜感激一个很好的例子。我知道有很多类似的问题，但我无法找到足够简单的东西让我理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:44:16.327

这是一条相当不明智的做法，制作 C# 代码 [ComVisible] 非常简单，而且 Regasm.exe 不会吓到你。Regasm 的常见错误是忘记在您的开发机器上使用它的 /codebase 选项。

如果您坚持不利用这一点，那么您需要找到一种方法来自己加载 CLR，以便它可以执行您的 C++/CLI 和 C# 代码。有三种基本方法可以做到这一点。如果主机应用程序是 VB6，您已经注销了 COM 互操作并且自己托管 CLR 不是很实用。但是，您可以利用 C++/CLI 编译器生成非托管 DLL 入口点存根的能力，为您加载 CLR 并切换到托管代码执行。通过编写一个用 . 装饰的静态函数来做到这一点`__declspec(dllexport)`。该技术显示在[此答案](https://stackoverflow.com/questions/6110820/loading-mixed-mode-assembly-from-unmanaged-code)中。请注意，它的性能不是特别好，您将不得不忍受 VB6 Declare 语句所施加的限制。

还要检查这个可以将这些存根直接注入 C# 程序集的[后处理工具。](https://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports)不知道它有多可靠，我自己没用过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:15:00.037

做一个男人，在几个不同的编译/链接/函数调用协议配置下制作那个 DLL。然后继续在您的 VB6 项目中尝试几种不同的引用配置。发布有效的方法。贡献，前进！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:56:02.957

看看[将托管代码导出为非托管](http://www.c-sharpcorner.com/UploadFile/JTeeuwen/ExportManagedCodeasUnmanaged11262005051206AM/ExportManagedCodeasUnmanaged.aspx)

和[用于非托管导出的 C# 项目模板](https://sites.google.com/site/robertgiesecke/)

# asp.net-mvc - MVC3 如何在 TryUpdate 之前修改传入的模型？

> ID：11937078
> 
> 赞同：1
> 
> 时间：2012-08-13T15:06:08.643
> 
> 标签：asp.net-mvc, value-provider

这应该很简单，但我没有看到它，所以我希望有人能提供帮助（我所有的帖子可能都是这样开始的）。所以我有一个模型进入控制器。

```
[HttpPost]
public ActionResult Index(Policy screenModel) 
```

我想在更新之前对该模型做一些特定的事情，例如：

```
If (condition)
    screenModel.AgentNumber = 1000; 
```

现在我需要在 TryUpdateModel 或 ModelState.IsValid 触发之前将 screenModel 返回到 ValueProvider 中，否则更改不会做任何事情。如果我在方法中接受 FormCollection，我可以简单地这样做：

```
this.ValueProvider = collection.ToValueProvider(); 
```

但还有其他原因我没有使用 FormCollection。如何将对象返回到 ValueProvider？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:37:54.190

首先，在使用模型作为参数传递的方法时，不应该调用 TryUpdateModel 或 UpdateModel。这些基本上是在调用方法之前执行 UpdateModel 。

其次，UpdateModel 旨在将对象从 FormsCollection 复制到模型中，它会覆盖您放入其中的任何内容。

第三，ModelState 也在方法被调用之前更新。

如果您想做这种事情，那么自定义模型绑定器可能是要走的路。

# java - 如何创建可以捕获网页的一部分的在线捕获工具？

> ID：11937079
> 
> 赞同：0
> 
> 时间：2012-08-13T15:06:08.063
> 
> 标签：java, javascript, jquery

我看到了这个演示：[捕获演示](http://www.gbin1.com/technology/democenter/20120720jsoupjquerysnatchpage/index.html)，它看起来使用 jsoup 来捕获 Web 元素。我们还有其他选择可以更好地捕获网页内容吗？例如，抓取网页的一部分，还包括js，所以它可以像原始页面一样正常运行。有任何想法吗？谢谢！

# jquery - 使用 jQuery 克隆为字段添加序列号

> ID：11937080
> 
> 赞同：-1
> 
> 时间：2012-08-13T15:06:09.663
> 
> 标签：jquery

我已经在以下链接中实现了 jQuery 克隆：

[http://jsfiddle.net/sunalive/gqQnJ/5/](http://jsfiddle.net/sunalive/gqQnJ/5/)

现在我希望每次添加（克隆）行时自动生成一个序列号（行号）。此外，当删除一行时（通过 DelRow 按钮），我需要对整个内容重新编号（这样当我们从中间删除一行时，序列中就不会丢失数字）。该数字必须显示在 lineNo 字段中。

谁能帮助我如何实现这一目标？

此外，我只需要从第一行隐藏“DelRow”按钮，这样所有行都不会被意外删除，并且至少有一行始终存在（但这是被克隆的行，我需要该按钮显示在所有其他克隆的行）。

感谢您的时间和帮助。

**更新：**感谢 Charles 和 Kei 的帮助。我必须融合你的两个解决方案才能达到我想要的。更新的解决方案发布在下面：

[http://jsfiddle.net/sunalive/gqQnJ/13/](http://jsfiddle.net/sunalive/gqQnJ/13/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:24:03.163

[http://jsfiddle.net/gqQnJ/10/](http://jsfiddle.net/gqQnJ/10/)但是您假设 html 无效，因为 id lineNo 是重复的 id。所以我认为你应该使用另一种方式来选择或识别输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:25:19.723

[演示](http://jsfiddle.net/cSKEZ/)

```
$(document).ready(function() {
    var autonumber = function() {
        $("tr.gridrow").each(function(i) {
            $(this).find("input[name='lineNo']").val(i + 1);
        });
    };
    autonumber();

    var emptyItems = $(".gridrow:first").clone();
    $(".addrow").live('click', function(e) {
        e.preventDefault();
        $(this).parents('.gridcontainer').append(emptyItems.clone());
        autonumber();
    });

    $(".delrow").live('click', function(e) {
        e.preventDefault();
        $(this).parents('.gridrow').remove();
        autonumber();
    });
}) 
```

请注意，您没有克隆具有相同 ID 的标签。你最好改用一个类。

# python - 两个外部包中的python冲突

> ID：11937081
> 
> 赞同：10
> 
> 时间：2012-08-13T15:06:16.627
> 
> 标签：python, packages, conflict

我正在编写代码来组合来自 python rawdog RSS 阅读器库和 BeautifulSoup webscraping 库的函数。我正在努力克服内心的某个地方的冲突。

我可以用这个简化的代码复制这个问题：

```
 import sys, gzip
    def scrape(filename):
        contents = gzip.open(filename,'rb').read()
        contents = contents.decode('utf-8','replace')
        import BeautifulSoup as BS
        print 'before rawdog: ', len(BS.BeautifulSoup(contents)) # prints 4, correct answer
        from rawdoglib import rawdog as rd
        print 'after rawdog: ', len(BS.BeautifulSoup(contents)) # prints 3, incorrect answer 
```

导入的顺序或位置无关紧要，rawdog 的导入总是会导致 BS.BeautifulSoup() 方法返回错误的响应。当我需要 BeautifulSoup 时，我实际上不再需要 rawdog，所以我当时尝试删除包，但 BS 仍然坏了。我尝试过但没有奏效的修复：

*   我注意到 rawdog 代码自己导入 BeautifulSoup。所以我尝试`import BeautifulSoup`从 rawdog 代码中删除并重新安装 rawdog
*   在导入 BeautifulSoup 之前删除 rawdog 模块：
    *   `for x in filter(lambda y: y.startswith('rawdog'), sys.modules.keys()): del sys.modules[x]`
*   从 rawdog 导入更具体的类/方法，例如`from rawdoglib.rawdog import FeedState`
*   在导入 rawdog 之前和之后给问题方法起一个新名称：`from BeautifulSoup import BeautifulSoup as BS`
*   `from __future__ import absolute_import`

不走运，如果 rawdog 曾被导入命名空间，我总是得到 len(BeautifulSoup(contents)) == 3 。这两个包都足够复杂，以至于我无法确切地弄清楚问题重叠是什么，而且我不确定使用什么工具来尝试解决这个问题，除了通过 dir(BeautifulSoup) 和 dir( rawdog），我还没有找到好的线索。

更新，回复答案：我忽略了每个输入文件都不会出现问题，这很重要，抱歉。有问题的文件很大，所以我认为我不能在这里发布它们。我将尝试找出好文件和坏文件之间的关键区别并将其发布。感谢到目前为止的调试帮助。

进一步调试！我已将输入文本中的此块标识为有问题：

```
 function SwitchMenu(obj){
      if(document.getElementById){
      var el = document.getElementById(obj);
      var ar = document.getElementById("masterdiv").getElementsByTagName("span"); //DynamicDrive.com change
         if(el.style.display != "block"){ //DynamicDrive.com change
         for (var i=0; i<ar.length; i++){
            if (ar[i].className=="submenu") //DynamicDrive.com change
            ar[i].style.display = "none";
      }
      el.style.display = "block";
      }else{
        el.style.display = "none";
    }
} 
```

}

如果我注释掉这个块，那么无论是否导入 rawdog，我都会通过 BeautifulSoup 获得正确的解析。使用该块，rawdog + BeautifulSoup 是错误的。那么我应该只在我的输入中搜索这样的块，还是有更好的解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T10:10:34.637

这是`rawdoglib.feedparser.py`. `rawdog`是猴子补丁`smglib`：在第 198 行，它显示：

```
if sgmllib.endbracket.search(' <').start(0):
    class EndBracketMatch:
        endbracket = re.compile('''([^'"<>]|"[^"]*"(?=>|/|\s|\w+=)|'[^']*'(?=>|/|\s|\w+=))*(?=[<>])|.*?(?=[<>])''')
        def search(self,string,index=0):
            self.match = self.endbracket.match(string,index)
            if self.match: return self
        def start(self,n):
            return self.match.end(n)
    sgmllib.endbracket = EndBracketMatch() 
```

这是重现错误的脚本：

```
contents = '''<a><ar "none";                                                 
</a> '''                                                                     
import BeautifulSoup as BS                                                   
print 'before rawdog: ', len(BS.BeautifulSoup(contents)) # prints 4, correct answer
from rawdoglib import rawdog as rd                                           
print 'after rawdog: ', len(BS.BeautifulSoup(contents)) # prints 3, incorrect 
```

它在“a”标签内的“<”处中断。在 OP 的代码段中，它由以下行触发：（`for (var i=0; i<ar.length; i++){`注意“<”字符）。

在 rawdog 的 ML 上提交的问题：http: [//lists.us-lot.org/pipermail/rawdog-users/2012-August/000327.html](http://lists.us-lot.org/pipermail/rawdog-users/2012-August/000327.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:41:06.103

我认为您遇到的问题是一连串的`imports`；您要导入`BS`包的两个不同位置存在冲突。

[那么，这个线程](https://stackoverflow.com/questions/5226893/understanding-a-chain-of-imports-in-python)可能是您所需要的。

（另外，`BS`在严肃的语境中，包装是一件很棒的事情。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T10:28:22.610

如果 rawdog 可以在不导入的情况下触发错误`BeautifulSoup`（我认为您已经检查过它不是间接导入的？），那么它们必须具有以某种方式加载不一致的共享依赖项。但问题不一定是猴子补丁：如果他们加载同一个库的不同版本，你可能会得到不一致的行为。例如，如果其中一个使用特殊的导入路径，提供自己的顶级模块版本，或者具有如下代码：

```
try: 
    import ElementPath 
except ImportError: 
    ElementPath = _SimpleElementPath() 
```

要查看这是否是问题所在，请尝试以下操作：`BeautifulSoup`自行加载，仅此而已，然后转储模块列表及其位置：

```
import BeautifulSoup
import sys
sys.stdout = open("soup-modules.txt", "w")
for k,v in sorted(sys.modules.items()):
    if v:
        print k, v.__dict__.get('__file__') 
```

然后对 rawdog 做同样的事情并区分输出。如果您看到一个名称相同但来源不同的模块，那可能是您的罪魁祸首。

# powershell - 在不使用 WMI 的情况下获取操作系统

> ID：11937087
> 
> 赞同：1
> 
> 时间：2012-08-13T15:06:31.963
> 
> 标签：powershell, wmi, virtual-machine, code-cleanup

我有一个 Powershell 脚本，我需要在其中获取各种服务器的操作系统。到目前为止，我一直在使用 WMI 来完成此任务，但是我已经阅读了有关 WMI 如何获取超时的信息，所以我想知道是否有另一种获取服务器操作系统的方法？这是我目前使用并希望更改以避免 WMI 的代码：

```
$serverVersion = Get-WMIObject -computer $server -class Win32_OperatingSystem 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:29:54.203

您可能会在注册表中找到您要查找的内容。从 Windows 2000 开始，`ProductName`可以在以下位置找到该值：`HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion`.

要使用 Powershell 查询此注册表值，请尝试：

```
(get-itemproperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name ProductName).ProductName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-12T18:47:00.177

根据您需要多少粒度，您还可以使用 .Net 的[System.Environment.OSVersion](https://docs.microsoft.com/en-us/dotnet/api/system.environment.osversion?view=netframework-4.7.2)：

```
PS C:\> $os = [Environment]::OSVersion 
```

在窗户上：

```
PS C:\> $os
Platform ServicePack    Version        VersionString
-------- -----------    -------        -------------
 Win32NT Service Pack 1 6.1.7601.65536 Microsoft Windows NT 6.1.7601 Service Pack 1 
```

在 Linux (Ubuntu 18.04) 上：

```
PS /home> $os
Platform ServicePack Version   VersionString
-------- ----------- -------   ------------- 
Unix             4.15.0.36 Unix 4.15.0.36 
```

# java - JScrollPane 没有出现

> ID：11937094
> 
> 赞同：2
> 
> 时间：2012-08-13T15:06:52.790
> 
> 标签：java, swing, jscrollpane, layout-manager, null-layout-manager

我想`JscrollPane`在我的面板中创建一个 jsp `panneau`。但这`JscroolPane`并没有出现。我觉得麻烦的是我习惯`setLayout`了`null`。

代码可能会产生这样的布局，文本字段的行数和列数是可变的（在构造函数中）：

![布局](../Images/5e7f11d341b410552b1129e820253fea.png)

那是我的代码：

```
public class Cadre_fenetreA3 extends JFrame 
{
    JButton boutonOK = new JButton ("OK");
    public Cadre_fenetreA3 (String nom,int X, int Y, int lo, int la, int nbligne,int nbcolonne,String[] nomGrpGen, int Na, File file, boolean dernier)      
    {

        super(nom);                     
        setBounds(X,Y,500,500);     
        setVisible(true);   
        setFocusable(true);

        JLabel phrase = new JLabel("<html>Veuillez indiquer l'appartenance ou non d'un attribut <br> a un groupe d'attribut du Niveau :</html>"+Na);
        JTextField[][] allField = new JTextField [nbligne][nbcolonne];
        JLabel phrases[] = new JLabel [nbligne];
        JPanel panneau = new JPanel();
        JScrollPane jsp = new JScrollPane(panneau);

        jsp.createVerticalScrollBar(); 
        jsp.createHorizontalScrollBar(); 
            jsp.setBounds(20,20, 20, 20);
        panneau.setLayout(null);

        for(int i = 0;i < nbligne;i++)
        {
            for(int j = 0;j<nbcolonne;j++)
            {
                int random = (int)(Math.random()*2);
                 allField[i][j] = new JTextField(String.valueOf(random));
                 allField[i][j].setBounds(150+j * 30, 75 + i * 30, 20, 20);
                 panneau.add(allField[i][j]);
            }

           phrases[i] = new JLabel(nomGrpGen[i]);
           phrases[i].setBounds(5, 75+ i * 30, 200, 20);

          panneau.add( phrases[i]);
        }
        phrase.setBounds(0,0,1000,50);
         panneau.add(phrase);

        boutonOK.setBounds(lo-90,la-110,60,60);
        boutonOK.addActionListener(new ecout(nbligne,nbcolonne,allField, file, dernier));
         panneau.add(boutonOK);
         add(jsp);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:12:49.363

那是因为你在`panneau`最后添加 - 你应该添加`jsp`;-)

另外，不要设置为`LayoutManager`，`null`因为这会导致问题（除非你知道你在做什么）。对于您的要求，您需要的一切都可以在[Layout Managers 视觉指南中](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)找到。

# php - PHP从存储在db中的逗号分隔字符串中删除数字

> ID：11937097
> 
> 赞同：0
> 
> 时间：2012-08-13T15:07:01.523
> 
> 标签：php, string, str-replace, replace

我正在将数字存储在数据库中，其中包含类似的字符串`5,55,15,17,2,35`

我想从字符串中删除说数字 5，保持逗号分隔设置不变。

使用的问题`str_replace()`是所有的 5 都将被删除。如果我使用`str_replace('5,'', $string)`那很好，但如果逗号位于字符串的中间或末尾，则逗号不会在 5 之后。同样的 str_replace 也会删除 15 和 55 的一部分，

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:09:42.533

```
$array = explode(',', $string);
foreach ($array as $k => $v)
  if ($v == 5) unset($array[$k]);
$string = implode(',', $array); 
```

首先，您可能不应该将逗号分隔的值列表存储在单个数据库列中。它看起来像一个一对多的关联，应该用一个单独的表来建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:08:45.037

首先用逗号分割字符串，以便您可以直接使用数字。从数组中删除 5，然后将数组重新组合成逗号分隔的字符串。

这是一个例子：

```
<?php
    $input = '5,55,15,17,2,35';
    echo "Input: $input<br />";

    // Split the string by "exploding" the string on the delimiter character
    $nums = explode(',', $input);

    // Remove items by comparing to an array containing unwanted elements
    $nums = array_diff($nums, array(5));

    // Combine the array back into a comma-delimited string
    $output = implode(',', $nums);

    echo "Output: $output<br />";

    // Outputs:
    // Input: 5,55,15,17,2,35
    // Output: 55,15,17,2,35

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-29T12:57:35.593

```
str_replace([$num.",",",".$num],"",$input); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-13T12:51:56.913

你可以尝试这样的事情：

```
// Convert string into array of numbers
$arrOfNumbers = explode(',', $string);

// Find id of number for del
$numberForDelId = array_search($numberForDel, $arrOfNumbers);

//Delete number
unset($arrOfNumbers[$numberForDelId]);

// Convert back to string
$resultString = implode(',' $arrOfNumbers) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-13T15:09:03.397

你应该：

1.  获取字符串
2.  然后将值“分解”到数组中
3.  并重新创建没有要删除的数字的字符串。

# c# - 将 RowID 从应用程序传递到 SQL Server 存储过程（或替代方法）

> ID：11937106
> 
> 赞同：0
> 
> 时间：2012-08-13T15:07:33.223
> 
> 标签：c#, asp.net

我的应用程序中有一个方法正在传递`list<listitem>`给存储过程。我创建了一个表类型数据类型来传递`list<listitem>`。现在我需要在存储过程中循环插入到另一个表中。为此，我在自动生成的表类型中创建了行 id 列。

由于表类型有 2 列，因此它期望从外部传递 2 个参数，但我通过标识列生成它。有什么办法可以避免，这样我就不会在外面传递价值形式？

```
 public void test(List<string> listItem)            {
                 var table = new DataTable(); 
                 table.Columns.Add("col1", typeof(string));
                 foreach (string col1 in listItem) { table.Rows.Add(col1); }

                 SqlCommand cmd1 = new SqlCommand("TableTypeUpdateAnswers", conn);
                cmd1.CommandType = CommandType.StoredProcedure;
                SqlParameter sqlParam = cmd1.Parameters.AddWithValue("@tvpUpdateAnswers",table);
                  sqlParam.SqlDbType = SqlDbType.Structured ;
                  sqlParam.TypeName = "dbo.AnswerTableType";

                conn.Open();
                try
                { }
              catch (Exception e)
                { }
  } 
```

这是创建表类型的 SQL：

```
CREATE TYPE [dbo].[AnswerTableType] AS TABLE(
    RowID int not null primary key identity(1,1),
    [col1] [nvarchar](50) NULL
) 
```

这是存储过程：

```
ALTER PROCEDURE [dbo].[TestTableType]
    @TVPUPDATEANSWERS DBO.ANSWERTABLETYPE READONLY
AS
DECLARE
    @CURRENTROW INT,
         @VANSID int ,
    @ROWSTOPROCESS INT

BEGIN
    SET @CURRENTROW=0
    SELECT L.col1 FROM @TVPUPDATEANSWERS L;
    SET @ROWSTOPROCESS=@@ROWCOUNT
        WHILE @CURRENTROW<@ROWSTOPROCESS
            BEGIN
                SET @CURRENTROW=@CURRENTROW+1
                                     (SELECT @VANSID = col1
                 FROM @TVPUPDATEANSWERS 
                 WHERE ROWID=@CURRENTROW);

                //do something with table type datatype

                INSERT INTO DBO.table1(col3,col4) 
                VALUES(@VANSID ,@col4);
            END
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:38:48.123

似乎您可能会从使用这种方法中受益-检查一下并告诉我... [http://ilovedevelopment.blogspot.co.uk/2012/01/manage-multiple-updates-to-data-using- c.html](http://ilovedevelopment.blogspot.co.uk/2012/01/manage-multiple-updates-to-data-using-c.html)

# javascript - 如果父元素具有preventDefault，如何将点击传播到子元素？

> ID：11937111
> 
> 赞同：2
> 
> 时间：2012-08-13T15:07:41.350
> 
> 标签：javascript, jquery

**更新**：这在最新版本的 firefox (15.0.1) 中不起作用：http: [//jsfiddle.net/DerNalia/NdrNV/5/](http://jsfiddle.net/DerNalia/NdrNV/5/)

点击复选框导航到谷歌......但它不应该:(

似乎添加 e.stopPropagation() 没有帮助/不起作用。

* * *

游戏区：http : [//jsfiddle.net/DerNalia/NdrNV/1/](http://jsfiddle.net/DerNalia/NdrNV/1/)

我正在尝试做的事情：当我单击锚旁边（但实际上是其子元素）的复选框时，它应该更改状态，并更改“其他”复选框的状态。

但是因为锚点调用了 e.preventDefault() ，所以该复选框永远不会被选中。

这是我的标记

```
<a href="#">Link Name <input class="home" type="checkbox"/></a>
<br />
Sync'd checkbox: <input class="other" type="checkbox" />​ 
```

这是一些陷入困境的jquery

```
$(function() {
    $("input.home").click(function() {
        $("input.other").click();
    });

    $("a").click(function(e) {
        e.preventDefault();
        // prevent default so we can do some ajaxy things instead of follow the href
    });
})​ 
```

那么，如何更改锚标记上的 jQuery 单击操作，以便单击传播到子元素（但我仍然可以在没有浏览器跟随锚标记的 href 的情况下执行 ajaxy 操作）？

有没有办法在不更改标记的情况下做到这一点？（现在的方式对我的 Web 应用程序具有语义意义）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:26:45.867

您可以像这样放置条件 e.target.tagName，

```
 if(e.target.tagName == 'A')        
       e.preventDefault(); 
```

**[现场演示](http://jsfiddle.net/rajaadil/NdrNV/3/)**

```
$(function() {
    $("input.home").click(function() {
        $("input.other").click();
    });

    $("a").click(function(e) {
        if(e.target.tagName == 'A')        
           e.preventDefault();      

        // prevent default so we can do some ajaxy things instead of follow the href
    });
})​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T19:36:29.760

它不起作用，因为`event.preventDefault`会取消活动。

使用 e.preventDefault 单击`checkbox`其中包含的内容`<a>`不会让您更改复选框状态。

我能想到的一种解决方法是在不同的上下文中设置复选框状态，以使`e.preventDefault`代码无效。

**演示：http:** [//jsfiddle.net/NdrNV/10/](http://jsfiddle.net/NdrNV/10/)

```
$(function() {
    $("input.home").click(function() {
        $("input.other").click();
    });

    $("a").click(function(e) {
        e.preventDefault();

        var setCheckbox = function() {
            var checkbox = $(e.target)[0];
            checkbox.checked = checkbox.checked?false:true;
        }

        if ($(e.target).is(':checkbox')) {
            setTimeout(setCheckbox, 0);
        }

    });
}) 
```

***注意：**这是一种解决方法。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:17:07.967

```
$(function() {
        $("input.home").click(function() {
            if($(this).attr('checked') == 'checked')
                $(this).removeAttr('checked');
            else                               
                $(this).attr('checked', 'checked');
            $("input.other").click();
        });

    $("a").click(function(e) {
        e.preventDefault();
        // prevent default so we can do some ajaxy things instead of follow the href

        var target = e.target; // object that triggers the event
        $(target).children().trigger('click');
    });
}); 
```

# javascript - 更改代码以读取不同的 JSON 格式

> ID：11937112
> 
> 赞同：0
> 
> 时间：2012-08-13T15:07:52.897
> 
> 标签：javascript, jquery, json

我有这个读取 JSON 数据的代码：

```
$.getJSON("data.json", function(data){
    var output = '';

    $.each(data, function(index, value){
    output += '<li>' + value.title + '</li>';

    });
    $('#listview').append(output).listview('refresh');
    }); 
```

上面的代码可以读取这种格式的 JSON：

```
[
    {"title":"mytitle1"},
    {"title":"mytitle2"},
    {"title":"mytitle3"}

] 
```

我现在需要让它读取这个 JSON 格式：

```
{"cats":

[

{"title":"mytitle1"},
{"title":"mytitle2"},
{"title":"mytitle3"}

]

} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:10:14.593

这应该有效。您需要在函数中引用该`cats`元素。`each`

```
$.getJSON("data.json", function(data){
  var output = '';

  $.each(data.cats, function(index, value){
    output += '<li>' + value.title + '</li>';

  });
  $('#listview').append(output).listview('refresh');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:12:57.937

您只需更改回调以使用返回数据的“cats”属性。

将带有 $.each 的行更改为如下所示：

```
$.each(data.cats, function(index, value){ 
```

请注意，它正在迭代 data.cats，而不仅仅是数据。

# c# - 对 csv 文件使用 WHERE 子句 ADO.NET / C#

> ID：11937120
> 
> 赞同：3
> 
> 时间：2012-08-13T15:08:14.033
> 
> 标签：c#, csv, ado.net, oledb

我有一个小问题。我正在使用 csv 文件作为数据库，并使用 ADO.NET 的 OLEDB 函数来询问它。我只想选择两个数据之间包含“DATA”列的行，如下所示：

```
String conn = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\;
;Extended Properties='text;HDR=Yes;Format=Delimited(;)';";

OleDbConnection cn = new OleDbConnection(conn);
OleDbCommand cmd = new OleDbCommand("SELECT * FROM [mydb]", cn);
OleDbDataAdapter daAd = new OleDbDataAdapter();
daAd.SelectCommand= cmd;
cn.Open();
DataTable dt = new DataTable();
daAd.Fill(dt);
DateTime mydata= Convert.ToDateTime("01/01/1990");
DateTime mydata2= Convert.ToDateTime("01/01/2000"); 
```

直到现在都没有错，但是当我改变时

```
 "SELECT * FROM [mydb]" 
```

和

```
 "SELECT * FROM [mydb] WHERE DATA>= '"+ mydata.Date +"' AND DATA<='"+ mydata2.Date +"' 
```

我有一个错误说“查询'WHERE DATA => mydata AND DATA <= mydata2'中的语法错误（缺少运算符）。我真的不知道如何解决它。更多信息：.CSV文件的格式如下：

```
DATA;INFO1;INFO2;INFO3
01/01/1990;1;2;3` 
```

进入 schema.ini 是这样的：

```
[mydb.csv]
Format=Delimited(;)
ColNameHeader=True
DateTimeFormat=dd-MM-yyyy
Col1=DATA DateTime
Col2=info1 Long Width 3
Col3=info2 Integer 
Col4=info3 Integer 
```

**编辑：** 我正在运行 x86 七，我读到对于解决 JET 驱动程序的不兼容问题，schema.ini 文件就足够了，希望我是对的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:10:50.940

嗯，这个：

```
SELECT * FROM [mydb] WHERE DATA=> mydata AND DATA<= mydata2 
```

显然是无效的 SQL。也许你的意思是：

```
SELECT * FROM [mydb] WHERE DATA>= mydata AND DATA<= mydata2 
```

（您使用`=>`“大于”而不是`>=`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:12:01.100

我想你的意思是：

```
SELECT * FROM [mydb] WHERE DATA >= mydata AND DATA <= mydata2 
```

你刚刚得到了 => 错误的方式！

**OP更正后更新**

是因为你的 schema.ini 吗？您似乎有错误的 DateTimeFormat：

```
DateTimeFormat=dd-MM-yyyy 
```

不应该是：

```
DateTimeFormat=dd/MM/yyyy 
```

**第二次更新**

将您的 mydata 更改为以下内容：

```
"SELECT * FROM [mydb] WHERE DATA >= '" + 
    mydata.ToString("dd/MM/yyyy") + 
    "' AND DATA <= '" + mydata2.ToString("dd/MM/yyyy") + "'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:10:52.177

尝试

```
SELECT * FROM [mydb] WHERE DATA >= mydata AND DATA <= mydata2 
```

注意第一次比较中“<”和“=”的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T12:36:11.547

因为我正在查询一个 csv，所以我不能使用 sql 的函数（错误说它们不存在），甚至不能将我的 DATA 与字符串进行比较。如果我在查询中输入一个不带引号的日期，它可以工作，但我不尊重 WHERE 子句，选择所有记录。查询似乎不仅仅适用于 DateTime 格式，所以我会将我的 DATA 放在 yyyyMMdd 整数格式中。这是我想到的唯一选择，仍然不知道为什么不能使用 Datetime 字段进行搜索。

# php - 显示php数组的单个值

> ID：11937121
> 
> 赞同：-9
> 
> 时间：2012-08-13T15:08:18.767
> 
> 标签：php, joomla

我有可以通过代码显示的数组：

```
foreach($form->data as $key => $value){
echo 'Key is '.$key.' and Value is '.$value.'<br />';
} 
```

我得到以下显示：

```
Key is language and Value is lv-LV
Key is Itemid and Value is 114
Key is option and Value is com_content
Key is pumpis_1 and Value is 1
Key is lietussargs and Value is 2 
```

但我只需要显示`[Itemid]`在这种情况下是`114` 我该怎么做的值？谢谢！雷维斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:09:54.303

```
echo $form->data['Itemid']; 
```

或者，如果你的意思是在 foreach 循环内（因为你还有其他事情要做），那么使用这个：

```
foreach($form->data as $key => $value) {
    if( $key === 'Itemid' )
        echo $form->data['Itemid'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:10:31.710

您应该阅读[PHP 数组](http://php.net/manual/en/language.types.array.php)。语法是这样的：

```
echo $form->data['Itemid'] 
```

# c - 结构声明 WLAN_AVAILABLE_NETWORK Network[1];

> ID：11937128
> 
> 赞同：3
> 
> 时间：2012-08-13T15:08:40.197
> 
> 标签：c, struct

鉴于此结构：

```
typedef struct _WLAN_AVAILABLE_NETWORK_LIST {
    WLAN_AVAILABLE_NETWORK Network[1];
} *PWLAN_AVAILABLE_NETWORK_LIST; 
```

声明`WLAN_AVAILABLE_NETWORK Network[1]`是什么意思？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T15:14:41.023

看起来很可能`Network`是为了充当一个[灵活的数组成员](https://stackoverflow.com/questions/246977/flexible-array-members-in-c-bad)。通过按字节过度分配结构`sizeof(Network) * (n - 1)`，库和客户端代码可以访问结构的末尾，就好像数组成员是`n`长元素一样。

库代码：

```
PWLAN_AVAILABLE_NETWORK_LIST list = malloc(sizeof(_WLAN_AVAILABLE_NETWORK_LIST)
    + (sizeof(WLAN_AVAILABLE_NETWORK) * (n - 1)));
for (int i = 0; i < n; ++i) {
    list->Network[i] = ...;
} 
```

客户端代码：

```
for (int i = 0; i < n; ++i) {
    do_something(list->Network[i]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:13:14.317

`typedef struct _WLAN_AVAILABLE_NETWORK_LIST {`声明一个名为`_wlan...list`

`WLAN_AVAILABLE_NETWORK Network[1];`假设在`WLAN_AVAILABLE_NETWORK`某处声明了一个被调用的结构。它是一个长度为 1（无意义）的数组，称为 Network。

`} *PWLAN_AVAILABLE_NETWORK_LIST;`立即创建此结构的（指针）变量，称为`pwlan...list`

# struts2 - Struts2 - 验证 Action 类中另一个类的实例

> ID：11937132
> 
> 赞同：1
> 
> 时间：2012-08-13T15:08:45.800
> 
> 标签：struts2

我有一个 Action 类，里面有几个字段（String、int 等）+ User 类（userBean）的实例。如果我想验证字段值，我可以使用验证框架来完成，但是如果我想从 User 类验证“userBean.username”，我该如何使用验证框架来做到这一点？

在下面尝试但没有用

```
<field name="userBean.username">
    <field-validator type="requiredstring">
      <param name="trim">true</param>
      <message key="errors.required" />
    </field-validator>
</field> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T23:45:10.613

您需要验证表单的输入，您不能以这种方式使用它。验证框架在操作处理请求之前启动（参见[拦截器](http://struts.apache.org/2.x/docs/interceptors.html)），这就是为什么你不能做你正在做的事情。因此，关于您的问题，您需要输入与您的用户名匹配的实际字段名称，然后将其值设置为您的 UserBean 实例。

如果您需要更多信息，请查看官方文档。

# sql - 为具身代理开发基于英语查询的搜索

> ID：11937134
> 
> 赞同：0
> 
> 时间：2012-08-13T15:09:02.020
> 
> 标签：sql, algorithm, search

我正在寻找一个用于处理网站上的搜索请求的[具体代理。](http://en.wikipedia.org/wiki/Embodied_agent)代理需要能够处理简单的问题，并提供一系列网站链接以获得答案。

所有文章都在数据库中。每篇文章都有一个标题字段，以及一系列用于对文章进行分类的标签。

在这一点上，我的简单算法是：

*   将问题分成一系列单词。
*   删除所有常用词，如“a”、“the”、“how”等。
*   创建一个“where”子句，在文章正文、文章标题和标签中搜索剩余的单词。
*   显示列表，可能与标题匹配的文章排名第一，标签第二，文章正文第三。

有没有更好的算法将英语问题转换为 SQL 查询？文章作者是否应该跟踪每篇文章的具体细节以进一步改善搜索结果？在使用搜索时是否应记录一些详细信息以进一步改进搜索结果？

**更新：** 该网站将使用最新的 ASP.NET 在 IIS 上运行。后端数据库将是 SQL Server。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:31:56.263

真正的英语查询解析确实没有简单的解决方案。大多数搜索引擎只是简单地消除干扰词，就像你提议的那样，然后寻找剩余的词。如果您使用的是 Microsoft SQL，则可能需要查看[全文搜索 (SQL Server)](http://msdn.microsoft.com/en-us/library/ms142571%28v=sql.105%29.aspx)。如果您可以使用 Microsoft SQL Server 2012，您可能还想阅读[语义搜索 (SQL Server)](http://msdn.microsoft.com/en-us/library/gg492075.aspx)。如果您使用的是 MySQL，请参阅[12.9。全文搜索功能](http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T15:21:44.660

您可能会发现[Kueri.me](http://kueri.me)相关。

Kueri 将自然语言转换为 SQL。它带有一个开箱即用的 Javascript 库，可以集成到网站中。

你可以问：

*   给我看文章
*   排名前 10 的文章
*   按创建日期排列的最后 5 篇文章
*   上周添加的最后 7 篇文章，描述中包含“xx”或“yy”
*   显示所有排名超过 2 的文章
*   每个部分有多少没有评分的文章
    等

# objective-c - NSMutableDictionary setValue:forKeyPath: 设置多个key

> ID：11937139
> 
> 赞同：1
> 
> 时间：2012-08-13T15:09:10.680
> 
> 标签：objective-c, nsmutabledictionary

```
// populate 'project' with contents of key in `gDictRoot`
NSDictionary *project = [gDictRoot valueForKeyPath:@"root.project0"];

// modify 'project' as necessary - actual code omitted for brevity
[project setValue:[someDict valueForKey:@"foo"] forKeyPath:@"parameters.foo"];

// add 'project' to 'gDictRoot' so it isn't lost when the view is dismissed
[gDictRoot setValue:project forKeyPath:@"root.project2"]; 
```

第三行，我添加`project`的地方`gDictRoot`——`project0`也被修改了。不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:16:16.037

您看到的行为是由于两者都`project0`指向`project2`同一个字典实例。对其中一个的更改将始终反映在另一个上。

如果您不想要这种行为，请`project0`在制作之前制作一份副本`project2`：

```
NSMutableDictionary *project = [NSMutableDictionary
    dictionaryWithDictionary:[gDictRoot valueForKeyPath:@"root.project0"]
]; 
```

# php - 重定向和路由通配符 URL - 下划线到连字符

> ID：11937147
> 
> 赞同：2
> 
> 时间：2012-08-13T15:09:49.307
> 
> 标签：php, .htaccess, codeigniter, redirect

我正在使用**CodeIgniter**，我需要将几个带下划线的 url 重定向到带连字符的等价物。

> /some-controller --> /some_controller

我通过调整`config/routes.php`文件部分解决了这个问题。

**事情是 ：**

我如何将其扩展为带有参数的控制器功能。

假设我有一个控制器`some_controller`（`some-controller`重定向到`some_controller`）和一个函数`func`（可选地接受一个参数）。

```
$route['some-controller'] = 'some_controller';
$route['some-controller/func'] = 'some_controller/func'; 
```

这行得通。但是，如果我有`some-controller/func/someparam`. （`someparam`可以是任何东西）。如何实现此重定向？

**基本上我需要的是来自以下的重定向：**

```
some-controller/func/* 
```

**到**

```
some_controller/func/* 
```

有任何想法吗？

* * *

**暗示 ：**

我不需要像这样复杂的东西（ [如何用破折号替换codeigniter url中的下划线？](https://stackoverflow.com/questions/8052245/how-to-replace-underscores-in-codeigniter-url-with-dashes)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:20:08.163

没有足够的搜索 - 我承认（这是那些看起来总是比他们应该更复杂的问题之一）：

[http://codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html)

```
$route['some-controller/func/(:any)'] = "some_controller/func/$1"; 
```

或者你可以使用`(:num)`，如果你期待的是一个数字......

# javascript - bxSlider - 在滑块内移动控件

> ID：11937155
> 
> 赞同：1
> 
> 时间：2012-08-13T15:10:21.930
> 
> 标签：javascript, jquery, css, slideshow, bxslider

我正在尝试使用 bxSlider ( [http://bxslider.com/](http://bxslider.com/) )。

禁用控件 ( `controls:false`) 时，控件以前所在的左侧和右侧的边距或填充仍然存在。这意味着我失去了很多宝贵的空间。

![在此处输入图像描述](../Images/ea82110fe97f3094813ed98c20faf768.png)

看到第一张图片是我在禁用控件后得到的，第二张是它应该是的宽度。我不仅浪费空间，而且在单击下一张幻灯片时，我会看到上一张幻灯片的一部分不适合。

我试图强制`<ul>`标签和标签上的宽度，`<li>`但它没有帮助：

```
<ul id="slider1" width="660">
  <li width="660">
  <div class="home-slider">

                    <div class="slide">
                        <div class="description">
                            <h3>La cuisine au style industriel</h3>
                            <div class="author dark">Marie Clairet Maison</div>

                            <p class="gray">
                                J'aime beaucoup le concept de self service pour la cuisine. 
                                J'ai vraiment l'impression d'être devant un e comptoir de self à la cantine. 
                                Le problème, c'est qu'il faut vraiment avoir de la place pour s'offrir ce genre d'installation.
                            </p>
                        </div>
                        <img src="images/home-slider-placeholder.png" />
                    </div>

                </div>    
  </li>
  <li>Slide two content</li>
  <li>Slide three content</li>
  <li>And so on...</li>
</ul> 
```

在查看 Firebug 时，我看到插件到处都添加了 626 的宽度。我没有写这个，有些东西正在生成那个数字：

![在此处输入图像描述](../Images/601f5fd44ba782d9b1ed055cdd4619fc.png)

作为参考，我试图构建的最终东西应该是这样的：

![在此处输入图像描述](../Images/1b0a31f6abb8012875a666c88ddcee62.png)

看看我需要如何将控件放在幻灯片内...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T16:32:03.857

我正在回答我自己的问题。似乎使用`<ul>`and`<li>`不会产生与`<div>`在此插件中使用相同的行为。

我的最终代码如下所示：

```
<script type="text/javascript">
  $(document).ready(function(){
    $('#slider1').bxSlider({
        wrapperClass: 'bx-wrapper home-slider'
    });
  });
</script>
<div id="slider1">

                    <div class="slide">
                        <div class="description">
                            <h3>La cuisine au style industriel</h3>
                            <div class="author dark">Marie Clairet Maison</div>

                            <p class="gray">
                                J'aime beaucoup le concept de self service pour la cuisine. 
                                J'ai vraiment l'impression d'être devant un e comptoir de self à la cantine. 
                                Le problème, c'est qu'il faut vraiment avoir de la place pour s'offrir ce genre d'installation.
                            </p>
                        </div>
                        <img src="images/home-slider-placeholder.png" />
                    </div>

  <div>Slide two content</div>
  <div>Slide three content</div>
  <div>And so on...</div>
</div> 
```

至于在滑块内移动箭头控件，编辑 bx_styles.css 并更改 bx-next 和 bx-prev 的位置。

# ruby - 尝试安装 RVM 时无法解析主机

> ID：11937157
> 
> 赞同：6
> 
> 时间：2012-08-13T15:10:31.667
> 
> 标签：ruby, macos, rvm

我正在尝试按照 RVM 页面上的说明在我的环境中安装 RVM

```
curl -L https://get.rvm.io | bash -s stable --ruby 
```

但我总是得到这个：

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   185  100   185    0     0    198      0 --:--:-- --:--:-- --:--:--   246
100  9979  100  9979    0     0   3821      0  0:00:02  0:00:02 --:--:-- 14740
Please read and follow further instructions.
Press ENTER to continue.
Downloading RVM from wayneeseguin branch stable
curl: (6) Could not resolve host: github.com; nodename nor servname provided, or not known 
```

在尝试 RVM 之前尝试安装 gem 时，我遇到了同样的错误。有人说是网络问题，但我不知道是什么问题。我是 ruby​​ 新手，正在尝试设置我的环境以使用 rails。

我尝试 ping github.com，大多数数据包都正常，丢失率不到 10%。

那么这真的是我的网络问题吗？如果是这样，我该如何解决这个问题？

我正在运行 Mac OS X 10.8。

**更新：**

当然，这是我在 Mac OS X 上的网络配置中的一些问题。我无法在 git 或 svn 上运行命令。我总是收到“无法解析主机名”错误。需要对此进行一些调查。有人遇到过同样的问题吗？所以我可以尝试改变我的网络配置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T12:57:26.430

它看起来像 DNS 或代理问题。根据您的评论，您没有使用代理。将您的 DNS 服务器更改为[Google DNS](https://developers.google.com/speed/public-dns/docs/using)，然后重试。

该问题与 git 或 svn 无关，因此您不会在他们的网站上找到有关 DNS 的信息。这是由于网络配置、网络可用性或互联网提供商（可能是前者）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-12T15:05:13.720

尝试以 sudo 运行；为我工作！我知道这并不理想，但证明它可能是权限问题。

# c++ - 如何从 Visual Studio 在控制台中运行程序？

> ID：11937165
> 
> 赞同：2
> 
> 时间：2012-08-13T15:10:54.457
> 
> 标签：c++, visual-studio-2010, visual-studio-express

> **可能重复：**
> [C++ - 保持控制台窗口打开？](https://stackoverflow.com/questions/1908512/c-hold-the-console-window-open)

我是 Visual Studio 的新手（实际上是 Express），我正在编写用 C++ 写入控制台的简单程序。

如何在 Visual Studio 的控制台中运行程序？

直接运行程序（即选择 Debug > Start Debugging）使程序打开一个控制台窗口然后关闭。

我现在这样做的方式是打开命令提示符并从那里运行程序。可以直接从 Visual Studio 执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:29:59.780

不要使用 F5 运行它，而是尝试使用 ctrl+F5 运行它。这样您就无法调试，但程序退出时窗口不会关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:22:14.803

一些建议：

1.  在最后一行设置断点`main`。

2.  在 的末尾`main`，添加一个等待按键的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:27:45.060

如果您设置了任何断点，程序应该在它们被击中时暂停。

如果没有，如果您不等待任何用户输入或某些事件，运行或启动应用程序当然会退出。

您可以使用**F10****进入**应用程序。这会将调试器设置为第一行，您可以继续单步执行应用程序。**`main`**

# github - git Error: Permission denied (publickey) 出现

> ID：11937167
> 
> 赞同：1
> 
> 时间：2012-08-13T15:10:56.327
> 
> 标签：github

美好的一天，git的问题是：

```
git push
Agent admitted failure to sign using the key.
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

我不能说我改变了我的系统（它曾经工作得很好）当我比较`ssh-add -l`我在[https://github.com/settings/ssh](https://github.com/settings/ssh)上的密钥时，我看到我的帐户附加了两个密钥，其中一个它们与上一个输出相同。

更新 1 生成新密钥并没有解决问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T07:41:31.303

这对我[有用 https://help.github.com/articles/error-agent-admitted-failure-to-sign](https://help.github.com/articles/error-agent-admitted-failure-to-sign)

# vb.net - 创建 DBContext Initializer 获取“类型参数” 不继承或实现约束类型“System.Data.Entity.DBContext”

> ID：11937169
> 
> 赞同：0
> 
> 时间：2012-08-13T15:10:55.613
> 
> 标签：vb.net, entity-framework, ef-code-first, dbcontext

我正在尝试使用 Database.SetInitializer 初始化数据库，但是当我的初始化程序类确实从 DBContext 继承时，我得到一个“类型参数不继承自或实现约束类型“System.Data.Entity.DBContext”错误。有任何想法吗？顺便说一句，我是 Code First EF 的新手！

上下文类：

```
Imports System.Data.Entity
Imports System.Collections.Generic
Imports System.Data.Entity.Infrastructure
Imports System.Configuration

Public Class PropertyManagementContext
    Inherits DbContext

#Region "Constructor"
    Public Sub New()
        MyBase.New("Data Source=WSBS2K3SQL;Initial Catalog=AQUARIUS_TEST;Persist    Security Info=True;User ID=SomeUser;Password=SomePassword;")

    End Sub

#End Region

#Region "Tables"
    Public Complexes As DbSet(Of Complex)
    Public Buildings As DbSet(Of Building)
    Public Units As DbSet(Of Unit)
    Public Tenants As DbSet(Of Tenant)
#End Region

Protected Overrides Sub OnModelCreating(modelBuilder As DbModelBuilder)
    MyBase.OnModelCreating(modelBuilder)

    'Set the Primary Keys
    modelBuilder.Entity(Of Complex).HasKey(Function(c) c.ComplexId)
    modelBuilder.Entity(Of Building).HasKey(Function(b) b.BuildingId).HasKey(Function(b) b.ComplexId)
    modelBuilder.Entity(Of Unit).HasKey(Function(u) u.UnitId).HasKey(Function(u) u.BuildingId)
    modelBuilder.Entity(Of Tenant).HasKey(Function(t) t.TenantId)

    'Set Complex Primary Key to Identity(MS SQL Auto-Increment)
    modelBuilder.Entity(Of Complex).Property(Function(c) c.ComplexId) _
    .HasDatabaseGeneratedOption(ComponentModel.DataAnnotations.DatabaseGeneratedOption.Identity)

End Sub

End Class 
```

初始化类：

```
Imports System.Collections.Generic
Imports System.Linq
Imports System.Text
Imports System.Data.Entity

Public Class PropertyManagementInitializer
    Inherits DropCreateDatabaseAlways(Of PropertyManagementContext)

Protected Overrides Sub Seed(context As PropertyManagementContext)
    MyBase.Seed(context)

    Dim complex As New Complex With {
        .Name = "SomeComplex",
        .City = "SomeCity",
        .Address = "SomeStreet",
        .PostalCode = "R2R2R2",
        .Type = "1"
    }
    context.Complexes.Add(complex)

    context.SaveChanges()

End Sub

End Class 
```

调用 Database.SetInitializer() 并给出错误的主窗体：

```
Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    Try    
        Database.SetInitializer(Of PropertyManagementContext)(New PropertyManagementInitializer)

    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T04:36:58.090

我以前见过这种情况，对我来说，Visual Studio 似乎以一种有趣的方式来修复我删除“继承 DbContext”运行构建，然后重新添加“继承 DbContext”并再次构建解决方案，Visual Studio 不再抱怨。

# javascript - Javascript：按值传递字符串

> ID：11937170
> 
> 赞同：2
> 
> 时间：2012-08-13T15:10:59.853
> 
> 标签：javascript

我的一个javascript代码有一点问题。这是代码

```
//assume array is an array containing strings and myDiv, some div in my doc
for(var i in array) {
    var myString = array[i];
    var a = document.createElement('a');
    a.innerHTML = myString;
    a.addEventListener("click", function() {myFunc(myString)}, false);
    myDiv.appendChild(a)
}
function myFunc(s) {alert(s);} 
```

但是，由于字符串在 JavaScript 中是通过引用传递的，所以`array`当我单击相关链接时，我总是看到 my 的最后一个字符串`a`。因此，我的问题是“我如何`myString`通过价值传递？”。感谢您的帮助 ！菲尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:13:06.077

在 Javascript 中，原始变量*不是*通过引用传递的。

这是经典的“闭包内调用循环变量”问题。

这是该问题的一种常用解决方案：

```
for (var i = 0, n = array.length; i < n; ++i) {
    var myString = array[i];
    var a = document.createElement('a');
    a.innerHTML = myString;
    a.addEventListener("click", make_callback(myString), false);
    myDiv.appendChild(a)
}

function make_callback(s) {
     return function() {
         alert(s);
     }
} 
```

请注意，这并不是特别有效的内存，因为它为数组中的*每个元素创建了一个新的函数范围。*

更好的解决方案可能是将变量数据实际存储在元素上（即作为新属性）并在回调中检索它。事实上，您已经将该字符串存储在`.innerHTML`属性中，因此您可以读取它，然后利用*委托*在元素的父级上仅注册一个处理程序：

```
for (var i = 0, n = array.length; i < n; ++i) {
    var a = document.createElement('a');
    a.innerHTML = array[i];
    myDiv.appendChild(a)
}

myDiv.addEventListener('click', function(ev) {
    alert(ev.target.innerHTML);
}, false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:13:36.857

您应该在事件处理程序周围添加一个闭包：

[循环内的 JavaScript 闭包——简单实用的示例](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

```
a.addEventListener("click", function (s) {
    return function () {
        alert(s)
    };
}(myString), false); 
```

此外，您不应`for...in`在数组上使用循环。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T15:13:55.323

试试这个：我认为最好不要练习使用 for...in 迭代数组

```
for(var i=0; i<array.length;i++) {
    var myString = array[i];
    var a = document.createElement('a');
    a.innerHTML = myString;
    a.addEventListener("click", function() {myFunc(myString)}, false);
    myDiv.appendChild(a)
}
function myFunc(s) {alert(s);} 
```

# java - 如何使用 java.util.logging.* 更改存储日志的目录

> ID：11937181
> 
> 赞同：1
> 
> 时间：2012-08-13T15:11:24.813
> 
> 标签：java, tomcat, logging

我在 tomcat 下运行一个网络应用程序，并且我已经配置了这样的日志记录（通过 contextInitialized 挂钩）：

```
 Logger rootLogger = Logger.getLogger("");
    String date = new SimpleDateFormat("yyyy-MM-dd").format(new Date());
    FileHandler logHandler = new FileHandler(
        "myapp_" + date + "_%u.log",
        524288000, // 500 MB max size
        1, // one log file at a time
        true // if it exists: append, don't overwrite
    );
    Level defaultLevel = Level.INFO;
    logHandler.setFormatter(new XMLFormatter());
    logHandler.setLevel(defaultLevel);
    for (Handler h : rootLogger.getHandlers()) {
        rootLogger.removeHandler(h);
    }
    rootLogger.setLevel(defaultLevel);
    rootLogger.addHandler(logHandler); 
```

不幸的是，日志没有在 /var/log 下创建。它们是在 /var/lib/tomcat6/ 中创建的，例如 /var/lib/tomcat6/myapp_2012-08-13_0.log。我想将其更改为 /var/log/myapp/ ，例如： /var/log/myapp/myapp_2012-08-13_0.log 我没有看到任何我可以在 FileLogger 上设置来实现这一点。我错过了一些明显的东西，还是有办法实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:32:41.777

您可以使用 JVM 属性添加到文件名前面。在下面的示例中，传入类似**-Dlog_directory=C:\logs**

```
package sample;

import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.logging.FileHandler;
import java.util.logging.Handler;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.logging.XMLFormatter;

import org.apache.commons.lang.StringUtils;

public class stackoverflow11937181 {

    /**
     * @param args
     */
    public static void main(String[] args) {
        Logger rootLogger = Logger.getLogger("");
        String date = new SimpleDateFormat("yyyy-MM-dd").format(new Date());
        String logDirectory = System.getProperty("log_directory");
        String logFile = (logDirectory == null ? StringUtils.EMPTY : logDirectory) + "/myapp_" + date + "_%u.log";
        try {
            FileHandler logHandler = new FileHandler(logFile, 524288000, // 500 MB max size
                    1, // one log file at a time
                    true // if it exists: append, don't overwrite
            );
            Level defaultLevel = Level.INFO;
            logHandler.setFormatter(new XMLFormatter());
            logHandler.setLevel(java.util.logging.Level.FINE);
            for (Handler h : rootLogger.getHandlers()) {
                rootLogger.removeHandler(h);
            }
            rootLogger.setLevel(defaultLevel);
            rootLogger.addHandler(logHandler);

        }
        catch (SecurityException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        rootLogger.log(Level.FINE, "sample");

    }

} 
```

# java - 在 Java 中推断泛型类

> ID：11937182
> 
> 赞同：0
> 
> 时间：2012-08-13T15:11:27.047
> 
> 标签：java, generics, inheritance, casting

我有以下课程：

```
public abstract class ClassWithHelper<T extends HelperInterface> {
    Class<T> helperClass;
    protected T helper;
        protected Gson gson = new GsonBuilder().create();

        public void loadHelper(String helperString) throws InstantiationException,        IllegalAccessException {
        if (!Strings.isNullOrEmpty(helperString)) {
            wizard = gson.fromJson(helperString, getHelperClass());
        } else {
            wizard = getHelperClass().newInstance();
        }
    }

    protected abstract Class<T> getHelperClass();
}

public class ImplementingClass extends ClassWithHelper<HelperClass> {

    @Override
    protected Class<HelperClass> getHelperClass() {
        return HelperClass.class;
    }
} 
```

现在，很好的是，当我调用 implementationClass.helperClass 时，它会自动将其转换为 HelperClass。但是，我想知道我是否真的需要编写和覆盖 getHelperClass。我不能写 helper.getClass （因为它可能是空的），而且我知道我写它的方式有一个类型擦除问题。

但是，有没有办法让我重写我的代码以避免必须以两种方式声明 helperClass 并且仍然对其进行类型推断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:48:32.530

试试这个 ：

```
protected Class<T> getHelperClass() {
    final ParameterizedType parameterizedType = (ParameterizedType) getClass().getGenericSuperclass();
    return (Class<T>) parameterizedType.getActualTypeArguments()[0];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:33:08.770

Afaik，除非您可以反思，否则`helper`遗憾的是*没有*可用的运行时类型信息 - 泛型*严格来说*是一种编译时工具。

有不同的方法可以做到这一点 - 将类型作为参数包含到 ClassWithHelper 的构造函数中，而不是重写方法，或者强制子类型提供`helperFromJSON`和`newHelper`方法 - 如果您认为这样看起来更好，但如果您在运行时需要该类型，您可以需要“以两种方式陈述”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:54:02.390

这个怎么样：

```
public abstract class ClassWithHelper<T extends HelperInterface> {
    Class<T> helperClass;
    protected T helper;
    protected Gson gson = new GsonBuilder().create();

    public void loadHelper(String helperString) throws InstantiationException,        IllegalAccessException {
        if (!Strings.isNullOrEmpty(helperString)) {
            wizard = gson.fromJson(helperString, getHelperClass());
        } else {
            wizard = getHelperClass().newInstance();
        }
    }

    public Class<T> getHelperClass() {
        return helperClass;
    }

    protected ClassWithHelper(Class<T> helperClass) {
        this.helperClass = helperClass;
    }

}

public class ImplementingClass extends ClassWithHelper<HelperClass> {

    public ImplementingClass() {
        super(HelperClass.class);
    }

} 
```

# linq - 在 EF 中链接相关实体

> ID：11937184
> 
> 赞同：0
> 
> 时间：2012-08-13T15:11:35.767
> 
> 标签：linq, entity-framework, linq-to-entities

我有两个实体 - Project 和 ProjectType

项目有 -ID,TypeID,name ProjectType 有 -ID,name

TypeId 是 Project 和 ProjectType 表之间的外键

现在说我在做了下面这样的事情后手头有一个对象

```
var selprojtype = db.ProjectTypes.Single(p => p.Name == id); 
```

然后我说我正在创建一个要链接到项目类型的新项目

```
Project project = new Project(); 
```

如果我做

```
project.ProjectType = selprojtype; 
```

未设置 TypeId。所以我总是在调用 SaveChanges 方法之前专门设置如下外键。

```
project.TypeId= selprojecttype.ID 
```

有没有更好的方法来链接相关实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T05:11:21.753

在建立对象之间的关系之前，两个对象必须位于相同的数据上下文中。所以你的代码应该是：

```
var selprojtype = db.ProjectTypes.Single(p => p.Name == id);
Project project = new Project();

//now add newly created project object to the context
db.Projects.Attach(project);

//now establish the relation
 project.ProjectType=selprojtype; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T05:20:45.450

你可以做的是：

```
public int? TypeId { get; set; }
private ProjectType projectType;
public ProjectType ProjectType{
    get { return projectType;}
    set {
          projectType = value;
          TypeId = value != null ? value.Id : null;
        }
} 
```

这样，您在分配关系时可以直接控制 FK。

# security - 在登录时重新散列存储的密码有什么好处吗？

> ID：11937188
> 
> 赞同：10
> 
> 时间：2012-08-13T15:11:49.493
> 
> 标签：security, salt

我正在使用各种不安全/极不安全的基于 MD5 的密码哈希来更新几个项目。我现在至少对最佳实践有了更好的了解，但我仍然想知道我是否做错了什么。我还没有看到我在其他地方使用的具体流程，[但至少有一个 SO 用户似乎想做类似的事情](https://stackoverflow.com/questions/9545266/yii-user-login-system-with-password-rehashing)。就我而言：

*   密码哈希是使用 bcrypt 生成的。（因为正确的选项似乎是 bcrypt、scrypt 或 pbkdf2，而我在 PHP 中最容易访问 bcrypt。）

*   每个哈希使用不同的随机盐。（防止攻击者生成使用单个静态盐计算的自定义彩虹表。）

*   哈希、算法设置和盐存储在一起。（因为这就是 PHP 的 crypt 函数为我提供的哈希值。）

*   成功登录后，使用新的随机盐重新计算哈希。

这是我想知道的最后一步。我的意图是允许随着时间的推移更新散列算法，以便定期登录的用户将他们的密码存储在最安全的可用格式中。

我的问题是：

1.  这是浪费时间吗？

2.  这样做有什么危险吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:20:07.577

**UDPATE**

对不起。完全错过了您关于使用较新算法的观点。这是一件好事。:-) 但正如我在下面的原始答案中所述，当算法保持不变时，它是无用的。

**原来的**

重新散列密码是没有用的，因为如果攻击者已经掌握了散列，你就不会阻止任何事情。

考虑以下：

*   我是您网站上的用户，其哈希值为：1234567890。
*   一些攻击者掌握了该哈希值。
*   我再次登录并更改了哈希。
*   攻击者并不关心哈希值的变化，因为他只需要一个哈希值就可以尝试破解。

所以什么都没有被阻止。攻击者仍然拥有哈希并且仍然可以尝试破解它。可能的攻击者只对最终结果（密码）感兴趣，而不对哈希感兴趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T15:23:15.603

**更新**

Re delnan 的评论：如果您要重新散列已经散列的密码，请不要——您永远不知道在链接散列时可能会出现和发现哪些漏洞。显然，另一方面是每次验证用户密码时都需要计算整个散列链——所以只需重新散列明文。

**原来的**

我在阅读中途投了赞成票。看起来你是一个在提出正确的问题来做这种工作的人。

1.  不是浪费时间。
2.  总是有危险。有人可以通过折磨或更可能的社会工程来获取您用户的密码。有人可以访问大量资源，并且您的影子密码文件仍然可以破解密码。有人可能会破坏您的服务器，秘密插入一个木马，在成功登录时拦截用户明文密码。

因此，无法保证完美的安全性。曾经。但我相信你已经知道了。这就是为什么我只想添加一件事：

*   鼓励用户选择难以破解的密码。

而且，严格来说，如果您在每次登录时重新散列的唯一原因是始终使用最新更新存储密码，那么可以 - 您的方法是浪费时间，假设您不会在每个用户登录时更新您的算法。因此，对于连续两次登录，将会有使用相同算法和（假定的）安全性的重新散列。重新散列浪费了几个时钟周期。严格来说，它没有优化。为什么不在您的密码存储中包含一个算法版本，如果系统算法比用户的哈希算法更新，则在登录 rehash 时包含。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:22:56.747

1.  如果有人可以访问哈希，每次更改它都不会有任何帮助，除非该人可以访问每个更新并愿意重新开始。这不会发生，如果发生了，那么您将遇到更大的问题。

2.  不，没有危险，只会浪费服务器资源。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-08T06:22:49.837

实际上，它可以防止新手 cookie 攻击者将 cookie 复制到他的浏览器中只是为了冒充……所以如果所有者稍后登录，使用更改的哈希值，它将使攻击者注销，从而减少对用户帐户的破坏。

# cryptography - SHA 256 伪代码？

> ID：11937192
> 
> 赞同：22
> 
> 时间：2012-08-13T15:11:57.717
> 
> 标签：cryptography, pseudocode, sha, sha256

我一直在尝试弄清楚 SHA-256 是如何工作的。我一直在为其他算法做的一件事是我已经为该算法制定了一种逐步的伪代码函数。

我尝试对 SHA256 做同样的事情，但到目前为止我遇到了很多麻烦。

我试图弄清楚维基百科图表是如何工作的，但除了解释功能的文本部分之外，我不确定我是否做对了。

这是我到目前为止所拥有的：

```
Input is an array 8 items long where each item is 32 bits.
Output is an array 8 items long where each item is 32 bits.
Calculate all the function boxes and store those values. 
|I'll refer to them by function name
Store input, right shifted by 32 bits, into output. 
| At this point, in the out array, E is the wrong value and A is empty
Store the function boxes.
| now we need to calculate out E and out A.
| note: I've replaced the modulo commands with a bitwise AND 2^(32-1) 
| I can't figure out how the modulus adding lines up, but I think it is like this
Store (Input H + Ch + ( (Wt+Kt) AND 2^31 ) ) AND 2^31 As mod1
Store (sum1 + mod1) AND 2^31 as mod2
Store (d + mod2) AND 2^31 into output E 
|now output E is correct and all we need is output A
Store (MA + mod2) AND 2^31 as mod3
Store (sum0 + mod3) AND 2^31 into output A
|output now contains the correct hash of input.
|Do we return now or does this need to be run repeatedly? 
```

我得到所有这些加法模数了吗？还有什么是 Wt 和 Kt？这也将运行一次并且您已完成或是否需要运行一定次数，输出被重新用作输入。

顺便说一下，这是链接。 [http://en.wikipedia.org/wiki/SHA-2#Hash_function](http://en.wikipedia.org/wiki/SHA-2#Hash_function)

非常感谢，布赖恩

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-25T11:09:26.463

看看描述算法的官方标准，这里描述了变量：http: [//csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf](http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf)

（哦，现在我发现我的答案迟到了将近一年，啊，没关系......）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-10-24T17:11:18.430

**W_t**源自正在处理的当前块，而**K_t**是由迭代次数确定的固定常数。SHA256 中每个块的压缩函数重复 64 次。对于每次迭代 0 <= t <= 63，都有一个特定的常数 K_t 和一个派生值 W_t。

我使用 Python 3.6 提供了自己的 SHA256 实现。元组 K 包含 K_t 的 64 个常数值。*Sha256*函数显示了如何在列表*W*中计算 W_t的值。实现的重点是代码清晰而不是高性能。

```
W = 32          #Number of bits in word
M = 1 << W
FF = M - 1      #0xFFFFFFFF (for performing addition mod 2**32)

#Constants from SHA256 definition
K = (0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,
     0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
     0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,
     0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
     0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,
     0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
     0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
     0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
     0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,
     0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
     0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,
     0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
     0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,
     0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
     0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,
     0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2)

#Initial values for compression function
I = (0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a,
     0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19)

def RR(x, b):
    '''
    32-bit bitwise rotate right
    '''
    return ((x >> b) | (x << (W - b))) & FF

def Pad(W):
    '''
    Pads a message and converts to byte array
    '''
    mdi = len(W) % 64           
    L = (len(W) << 3).to_bytes(8, 'big')        #Binary of len(W) in bits
    npad = 55 - mdi if mdi < 56 else 119 - mdi  #Pad so 64 | len; add 1 block if needed
    return bytes(W, 'ascii') + b'\x80' + (b'\x00' * npad) + L   #64 | 1 + npad + 8 + len(W)

def Sha256CF(Wt, Kt, A, B, C, D, E, F, G, H):
    '''
    SHA256 Compression Function
    '''
    Ch = (E & F) ^ (~E & G)
    Ma = (A & B) ^ (A & C) ^ (B & C)        #Major
    S0 = RR(A, 2) ^ RR(A, 13) ^ RR(A, 22)   #Sigma_0
    S1 = RR(E, 6) ^ RR(E, 11) ^ RR(E, 25)   #Sigma_1
    T1 = H + S1 + Ch + Wt + Kt
    return (T1 + S0 + Ma) & FF, A, B, C, (D + T1) & FF, E, F, G

def Sha256(M):
    '''
    Performs SHA256 on an input string 
    M: The string to process
    return: A 32 byte array of the binary digest
    '''
    M = Pad(M)          #Pad message so that length is divisible by 64
    DG = list(I)        #Digest as 8 32-bit words (A-H)
    for j in range(0, len(M), 64):  #Iterate over message in chunks of 64
        S = M[j:j + 64]             #Current chunk
        W = [0] * 64
        W[0:16] = [int.from_bytes(S[i:i + 4], 'big') for i in range(0, 64, 4)]  
        for i in range(16, 64):
            s0 = RR(W[i - 15], 7) ^ RR(W[i - 15], 18) ^ (W[i - 15] >> 3)
            s1 = RR(W[i - 2], 17) ^ RR(W[i - 2], 19) ^ (W[i - 2] >> 10)
            W[i] = (W[i - 16] + s0 + W[i-7] + s1) & FF
        A, B, C, D, E, F, G, H = DG #State of the compression function
        for i in range(64):
            A, B, C, D, E, F, G, H = Sha256CF(W[i], K[i], A, B, C, D, E, F, G, H)
        DG = [(X + Y) & FF for X, Y in zip(DG, (A, B, C, D, E, F, G, H))]
    return b''.join(Di.to_bytes(4, 'big') for Di in DG)  #Convert to byte array

if __name__ == "__main__":
    bd = Sha256('Hello World')
    print(''.join('{:02x}'.format(i) for i in bd)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-16T19:08:31.753

```
initial_hash_values=[
'6a09e667','bb67ae85','3c6ef372','a54ff53a',
'510e527f','9b05688c','1f83d9ab','5be0cd19'
]

sha_256_constants=[
'428a2f98','71374491','b5c0fbcf','e9b5dba5',
'3956c25b','59f111f1','923f82a4','ab1c5ed5',
'd807aa98','12835b01','243185be','550c7dc3',
'72be5d74','80deb1fe','9bdc06a7','c19bf174',
'e49b69c1','efbe4786','0fc19dc6','240ca1cc',
'2de92c6f','4a7484aa','5cb0a9dc','76f988da',
'983e5152','a831c66d','b00327c8','bf597fc7',
'c6e00bf3','d5a79147','06ca6351','14292967',
'27b70a85','2e1b2138','4d2c6dfc','53380d13',
'650a7354','766a0abb','81c2c92e','92722c85',
'a2bfe8a1','a81a664b','c24b8b70','c76c51a3',
'd192e819','d6990624','f40e3585','106aa070',
'19a4c116','1e376c08','2748774c','34b0bcb5',
'391c0cb3','4ed8aa4a','5b9cca4f','682e6ff3',
'748f82ee','78a5636f','84c87814','8cc70208',
'90befffa','a4506ceb','bef9a3f7','c67178f2'
]

def bin_return(dec):
    return(str(format(dec,'b')))

def bin_8bit(dec):
    return(str(format(dec,'08b')))

def bin_32bit(dec):
    return(str(format(dec,'032b')))

def bin_64bit(dec):
    return(str(format(dec,'064b')))

def hex_return(dec):
    return(str(format(dec,'x')))

def dec_return_bin(bin_string):
    return(int(bin_string,2))

def dec_return_hex(hex_string):
    return(int(hex_string,16))

def L_P(SET,n):
    to_return=[]
    j=0
    k=n
    while k<len(SET)+1:
        to_return.append(SET[j:k])
        j=k
        k+=n 
    return(to_return)

def s_l(bit_string):
    bit_list=[]
    for i in range(len(bit_string)):
        bit_list.append(bit_string[i])
    return(bit_list)

def l_s(bit_list):
    bit_string=''
    for i in range(len(bit_list)):
        bit_string+=bit_list[i]
    return(bit_string)

def rotate_right(bit_string,n):
    bit_list = s_l(bit_string)
    count=0
    while count <= n-1:
        list_main=list(bit_list)
        var_0=list_main.pop(-1)
        list_main=list([var_0]+list_main)
        bit_list=list(list_main)
        count+=1
    return(l_s(list_main))

def shift_right(bit_string,n):
    bit_list=s_l(bit_string)
    count=0
    while count <= n-1:
        bit_list.pop(-1)
        count+=1
    front_append=['0']*n
    return(l_s(front_append+bit_list))

def mod_32_addition(input_set):
    value=0
    for i in range(len(input_set)):
        value+=input_set[i]
    mod_32 = 4294967296
    return(value%mod_32)

def xor_2str(bit_string_1,bit_string_2):
    xor_list=[]
    for i in range(len(bit_string_1)):
        if bit_string_1[i]=='0' and bit_string_2[i]=='0':
            xor_list.append('0')
        if bit_string_1[i]=='1' and bit_string_2[i]=='1':
            xor_list.append('0')
        if bit_string_1[i]=='0' and bit_string_2[i]=='1':
            xor_list.append('1')
        if bit_string_1[i]=='1' and bit_string_2[i]=='0':
            xor_list.append('1')
    return(l_s(xor_list))

def and_2str(bit_string_1,bit_string_2):
    and_list=[]
    for i in range(len(bit_string_1)):
        if bit_string_1[i]=='1' and bit_string_2[i]=='1':
            and_list.append('1')
        else:
            and_list.append('0')

    return(l_s(and_list))

def or_2str(bit_string_1,bit_string_2):
    or_list=[]
    for i in range(len(bit_string_1)):
        if bit_string_1[i]=='0' and bit_string_2[i]=='0':
            or_list.append('0')
        else:
            or_list.append('1')
    return(l_s(or_list))

def not_str(bit_string):
    not_list=[]
    for i in range(len(bit_string)):
        if bit_string[i]=='0':
            not_list.append('1')
        else:
            not_list.append('0')
    return(l_s(not_list))

'''
SHA-256 Specific Functions:
'''

def Ch(x,y,z):
    return(xor_2str(and_2str(x,y),and_2str(not_str(x),z)))

def Maj(x,y,z):
    return(xor_2str(xor_2str(and_2str(x,y),and_2str(x,z)),and_2str(y,z)))

def e_0(x):
    return(xor_2str(xor_2str(rotate_right(x,2),rotate_right(x,13)),rotate_right(x,22)))

def e_1(x):
    return(xor_2str(xor_2str(rotate_right(x,6),rotate_right(x,11)),rotate_right(x,25)))

def s_0(x):
    return(xor_2str(xor_2str(rotate_right(x,7),rotate_right(x,18)),shift_right(x,3)))

def s_1(x):
    return(xor_2str(xor_2str(rotate_right(x,17),rotate_right(x,19)),shift_right(x,10)))

def message_pad(bit_list):
    pad_one = bit_list + '1'
    pad_len = len(pad_one)
    k=0
    while ((pad_len+k)-448)%512 != 0:
        k+=1
    back_append_0 = '0'*k
    back_append_1 = bin_64bit(len(bit_list))
    return(pad_one+back_append_0+back_append_1)

def message_bit_return(string_input):
    bit_list=[]
    for i in range(len(string_input)):
        bit_list.append(bin_8bit(ord(string_input[i])))
    return(l_s(bit_list))

def message_pre_pro(input_string):
    bit_main = message_bit_return(input_string)
    return(message_pad(bit_main))

def message_parsing(input_string):
    return(L_P(message_pre_pro(input_string),32))

def message_schedule(index,w_t):
    new_word = bin_32bit(mod_32_addition([int(s_1(w_t[index-2]),2),int(w_t[index-7],2),int(s_0(w_t[index-15]),2),int(w_t[index-16],2)]))
    return(new_word)

'''
This example of SHA_256 works for an input string >56 characters.
'''

def sha_256(input_string):
    w_t=message_parsing(input_string)
    a=bin_32bit(dec_return_hex(initial_hash_values[0]))
    b=bin_32bit(dec_return_hex(initial_hash_values[1]))
    c=bin_32bit(dec_return_hex(initial_hash_values[2]))
    d=bin_32bit(dec_return_hex(initial_hash_values[3]))
    e=bin_32bit(dec_return_hex(initial_hash_values[4]))
    f=bin_32bit(dec_return_hex(initial_hash_values[5]))
    g=bin_32bit(dec_return_hex(initial_hash_values[6]))
    h=bin_32bit(dec_return_hex(initial_hash_values[7]))
    for i in range(0,64):
        if i <= 15: 
            t_1=mod_32_addition([int(h,2),int(e_1(e),2),int(Ch(e,f,g),2),int(sha_256_constants[i],16),int(w_t[i],2)])
            t_2=mod_32_addition([int(e_0(a),2),int(Maj(a,b,c),2)])
            h=g
            g=f
            f=e
            e=mod_32_addition([int(d,2),t_1])
            d=c
            c=b
            b=a 
            a=mod_32_addition([t_1,t_2])
            a=bin_32bit(a)
            e=bin_32bit(e)
        if i > 15:
            w_t.append(message_schedule(i,w_t))
            t_1=mod_32_addition([int(h,2),int(e_1(e),2),int(Ch(e,f,g),2),int(sha_256_constants[i],16),int(w_t[i],2)])
            t_2=mod_32_addition([int(e_0(a),2),int(Maj(a,b,c),2)])
            h=g
            g=f
            f=e
            e=mod_32_addition([int(d,2),t_1])
            d=c
            c=b
            b=a 
            a=mod_32_addition([t_1,t_2])
            a=bin_32bit(a)
            e=bin_32bit(e)
    hash_0 = mod_32_addition([dec_return_hex(initial_hash_values[0]),int(a,2)])
    hash_1 = mod_32_addition([dec_return_hex(initial_hash_values[1]),int(b,2)])
    hash_2 = mod_32_addition([dec_return_hex(initial_hash_values[2]),int(c,2)])
    hash_3 = mod_32_addition([dec_return_hex(initial_hash_values[3]),int(d,2)])
    hash_4 = mod_32_addition([dec_return_hex(initial_hash_values[4]),int(e,2)])
    hash_5 = mod_32_addition([dec_return_hex(initial_hash_values[5]),int(f,2)])
    hash_6 = mod_32_addition([dec_return_hex(initial_hash_values[6]),int(g,2)])
    hash_7 = mod_32_addition([dec_return_hex(initial_hash_values[7]),int(h,2)])
    final_hash = (hex_return(hash_0),
                  hex_return(hash_1),
                  hex_return(hash_2),
                  hex_return(hash_3),
                  hex_return(hash_4),
                  hex_return(hash_5),
                  hex_return(hash_6),
                  hex_return(hash_7))
    return(final_hash) 
```

# cmd - CMD 从管道输入返回特定行

> ID：11937196
> 
> 赞同：0
> 
> 时间：2012-08-13T15:12:03.300
> 
> 标签：cmd

在课堂上无聊试图弄清楚这一点。

在 Windows 命令提示符下：

`ipconfig /all`返回所有的环回、隧道等。

如果我运行`ipconfig /all | find /n "Internal"`它将返回 [11] 以太网适配器内部。我想要做的是将 11 从开头插入字符串，然后将其通过管道传输到其他内容，这将允许我返回第 11-19 行或其他内容。您可以在类似于 jquery 和链接的单行中执行此操作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:51:21.820

使用 FOR /F 循环解析出 11 很简单。但是在命令行中使用该值是困难的。

这是我能想到的从命令行运行的最好的方法。

```
set "stop="&for /f "delims=[]" %N in ('ipconfig /all^|find /n "Internal"') do @for /f "tokens=1* delims=:" %A in ('ipconfig /all^|findstr /n "^"') do @if %A geq %N if not defined stop echo(%B&>nul 2>nul set /a 1/(%A-%N-8)||set stop=1 
```

我能想到的最短的一个班轮使用了不同的策略。

```
set n=&for /f "delims=" %A in ('ipconfig/all') do @if defined n (set/a"1/n,n-=1">nul 2>&1&&echo %A) else echo %A|find "Internal"&&set n=8 
```

但上述解决方案忽略了空行。

如果要保留空白行，则以下工作：

```
set n=&for /f "tokens=1* delims=:" %A in ('ipconfig/all^|findstr/n "^"') do @if defined n (set/a"1/n,n-=1">nul 2>&1&&echo(%B) else echo %B|find "Internal"&&set n=8 
```

**编辑**

我稍微缩短和简化了第二和第三解决方案的逻辑。

我将尝试解释第二个选项：

我首先明确地取消定义一个计数器，然后使用 FOR 来读取 IPCONFIG/ALL 命令的输出。现在开始 DO 子句中有趣的部分。

起初，计数器未定义，因此执行 ELSE 子句。我将当前行通过管道传输到 FIND 以查找“内部”。如果未找到该字符串，则不会发生任何事情，我们会进入下一行。但如果找到，则打印该行。`&&`然后在找到字符串后执行之后的代码。在那里我将计数器设置为 8，因为我们想要打印接下来的 8 行。

计数器是为其余的行定义的，所以我们现在切换到 IF 语句的第一部分。我使用 SET /A 来做一些数学运算。首先，我将 1 除以计数器的当前值。如果计数器为 0，则引发错误并忽略语句的其余部分。如果计数器不为 0，那么接下来我将计数器减 1。我将 stdout 和 stderr 都重定向到 nul，因为我们不想看到来自 SET /A 命令的任何消息。如果 SET 命令成功，那么我会回显该行。由于我最初在找到字符串时将计数器设置为 8，因此在计数器达到 0 之前将打印多达 8 行。

# objective-c-blocks - 带有块参数的存根方法

> ID：11937197
> 
> 赞同：0
> 
> 时间：2012-08-13T15:12:06.463
> 
> 标签：objective-c-blocks, ocmock

我正在尝试对具有块参数的方法进行存根。

```
[[[myMock stub] andCall:@selector(performBlock:) onObject:self] performBlock:[OCMArg any]]; 
```

该块属于简单类型。

```
typedef void (^MyBlock)(void); 
```

执行后我收到以下错误：

```
unexpected method invoked: performBlock:<__NSStackBlock__: 0xbffff418>
                  stubbed: performBlock:<OCMAnyConstraint: 0x1c1ff70> 
```

似乎块参数与`[OCMArg any]`. 任何提示如何存根此方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T11:14:24.957

好的，我从我的例子中裁剪了太多。我有第二个类型的参数，`bool`它与`[OCMArg any]`.

更糟糕的是：除非您使用它，否则您不会收到编译器警告`BOOL`...

# tinymce - 如何动态更改tinymce编辑器的字体样式和大小？

> ID：11937203
> 
> 赞同：1
> 
> 时间：2012-08-13T15:12:32.943
> 
> 标签：tinymce

tinymce 的[常见问题解答解释了](http://www.tinymce.com/wiki.php/Configuration%3acontent_css)如何通过引用自定义文件来更改编辑器的**默认字体样式。**`content_css`

但我想以编程方式即时更改编辑器的字体样式。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:40:32.677

这是可能的，但需要一些知识。

你需要调用类似的东西

```
self.switchStyle(url, ed); 
```

switchStyle 在哪里

```
 // url is the url to the stylesheet file to be added to the editor iframes head
    // ed is the editor object or editor id
    switchStyle: function(url, ed) {

        if (typeof ed != 'object') {
            ed = tinymce.get(ed);
        }

                    //replace the custom content_css if set
        var url_to_replace = ed.getParam('content_css');

        var doc = ed.getDoc();
        var $doc = $(doc);

        var sheets_urls = [];

        if (url_to_replace){
            sheets_urls.push(url_to_replace);
        }

        // remove all stylesheets from sheets_urls
        $doc.find('link').each(function() {
            if (tinymce.inArray(sheets_urls, $(this).attr('href').split('?')[0]) !== -1) {
                $(this).remove();
            }
        });

        var link  = doc.createElement('link');
        link.type = 'text/css';
        link.rel  = 'stylesheet';
        link.href = url;

        // setstylesheet
        $doc.find('head:first').append(link);
    }, 
```

# sql-server - SQL 仅在一列上使用 Distinct 查询多列

> ID：11937206
> 
> 赞同：32
> 
> 时间：2012-08-13T15:12:46.167
> 
> 标签：sql-server, select

我正在尝试编写一个 SQL 查询，该查询从表中选择多个列，并且仅在一列上使用 distinct 运算符。

表很简单。这些列是：

```
tblFruit_ID, tblFruit_FruitType, tblFruit_FruitName
int          NVarChar            Text 
```

我正在尝试选择所有 tblFruit_FruitType 及其对应的 tblFruit_ID。

我试过了：

```
Select Distinct(tblFruit_FruitType), tblFruit_ID FROM tblFruit 
```

-返回所有结果，而不仅仅是不同的

```
Select tblFruit_FruitType, tblFruit_ID FROM tblFruit Group By tblFruit_FruitType 
```

- 列 tblFruit_ID 的错误在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。

```
Select tblFruit_FruitType, tblFruit_ID FROM tblFruit Group By tblFruit_FruitType, tblFruit_ID 
```

-返回所有结果，而不仅仅是不同的

我还查看了这些类似的帖子，但没有任何工作:(

[mySQL 选择一列 DISTINCT，与对应的其他列](https://stackoverflow.com/questions/5967130/mysql-select-one-column-distinct-with-corresponding-other-columns)

[一列的 SQL Server Distinct Union](https://stackoverflow.com/questions/7338884/sql-server-distinct-union-for-one-column)

希望这是足够的信息来回答。

感谢您的时间！

编辑（样本数据和所需结果）

```
tblFruit_ID, tblFruit_FruitType, tblFruit_FruitName
int          NVarChar            Text
1            Citrus              Orange
2            Citrus              Lime
3            Citrus              Lemon
4            Seed                Cherry
5            Seed                Banana 
```

结果：

```
1            Citrus
4            Seed 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-13T15:26:45.707

```
select * from tblFruit where
tblFruit_ID in (Select max(tblFruit_ID) FROM tblFruit group by tblFruit_FruitType) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-13T15:16:08.963

您必须对未分组的列使用聚合函数。在这个例子中，我随意选择了 Min 函数。您正在组合具有相同`FruitType`值的行。例如，如果我有两行值相同`FruitType`但值不同`Fruit_Id`，系统应该怎么做？

```
Select Min(tblFruit_id) As tblFruit_id
    , tblFruit_FruitType
From tblFruit
Group By tblFruit_FruitType 
```

[SQL 小提琴示例](http://www.sqlfiddle.com/#!3/18544/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-17T08:18:24.167

您有多种方法可以在一列或多列上区分值。

*   **使用 GROUP BY**

    ```
    SELECT DISTINCT MIN(o.tblFruit_ID)  AS tblFruit_ID,
       o.tblFruit_FruitType,
       MAX(o.tblFruit_FruitName)
    FROM   tblFruit  AS o
    GROUP BY
         tblFruit_FruitType 
    ```

*   **使用子查询**

    ```
    SELECT b.tblFruit_ID,
       b.tblFruit_FruitType,
       b.tblFruit_FruitName
    FROM   (
           SELECT DISTINCT(tblFruit_FruitType),
                  MIN(tblFruit_ID) tblFruit_ID
           FROM   tblFruit
           GROUP BY
                  tblFruit_FruitType
       ) AS a
       INNER JOIN tblFruit b
            ON  a.tblFruit_ID = b.tblFruit_I 
    ```

*   **使用带有子查询的连接**

    ```
    SELECT t1.tblFruit_ID,
        t1.tblFruit_FruitType,
        t1.tblFruit_FruitName
    FROM   tblFruit  AS t1
       INNER JOIN (
                SELECT DISTINCT MAX(tblFruit_ID) AS tblFruit_ID,
                       tblFruit_FruitType
                FROM   tblFruit
                GROUP BY
                       tblFruit_FruitType
            )  AS t2
            ON  t1.tblFruit_ID = t2.tblFruit_ID 
    ```

*   **使用窗口函数只有一列不同**

    ```
    SELECT tblFruit_ID,
        tblFruit_FruitType,
        tblFruit_FruitName
    FROM   (
             SELECT tblFruit_ID,
                  tblFruit_FruitType,
                  tblFruit_FruitName,
                  ROW_NUMBER() OVER(PARTITION BY tblFruit_FruitType ORDER BY tblFruit_ID) 
        rn
           FROM   tblFruit
        ) t
        WHERE  rn = 1 
    ```

*   **使用窗口函数多列不同**

    ```
    SELECT tblFruit_ID,
        tblFruit_FruitType,
        tblFruit_FruitName
    FROM   (
             SELECT tblFruit_ID,
                  tblFruit_FruitType,
                  tblFruit_FruitName,
                  ROW_NUMBER() OVER(PARTITION BY tblFruit_FruitType,     tblFruit_FruitName 
        ORDER BY tblFruit_ID) rn
              FROM   tblFruit
         ) t
        WHERE  rn = 1 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-03T14:39:37.083

我需要做同样的事情，并且必须查询一个查询才能得到结果

我将第一个查询设置为从表中引入所有 ID 以及过滤所需的所有其他信息：

```
SELECT tMAIN.tLOTS.NoContract, tMAIN.ID
FROM tMAIN INNER JOIN tLOTS ON tMAIN.ID = tLOTS.id
WHERE (((tLOTS.NoContract)=False)); 
```

将此另存为 Q04_1 -0 这返回 1229 个结果（有 63 条唯一记录要查询 - 具有多个 LOT）

```
SELECT DISTINCT ID
FROM q04_1; 
```

另存为 q04_2

然后我写了另一个查询，它引入了与 ID 相关的所需信息

```
SELECT q04_2.ID, tMAIN.Customer, tMAIN.Category
FROM q04_2 INNER JOIN tMAIN ON q04_2.ID = tMAIN.ID; 
```

辛苦了，得到了我所需要的——63 条独特的记录返回了客户和类别的详细信息。

这就是我解决它的方式，因为我根本无法通过工作来获得小组 - 尽管我对 SQL 相当“耳后”（所以请对反馈保持温和和建设性）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-12T10:05:14.860

```
select * from 
(select 
ROW_NUMBER() OVER(PARTITION BY tblFruit_FruitType ORDER BY tblFruit_FruitType DESC) as tt
,*
from tblFruit
) a
where a.tt=1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-07T14:08:09.910

我想最简单和最好的解决方案是使用`OUTER APPLY`. 您只使用一个字段，`DISTINCT`但要检索有关该记录的更多数据，您使用`OUTER APPLY`.

要测试解决方案，请执行以下查询，该查询首先创建一个临时表，然后检索数据：

```
 DECLARE @tblFruit TABLE (tblFruit_ID int, tblFruit_FruitType varchar(10), tblFruit_FruitName varchar(50))
 SET NOCOUNT ON
 INSERT @tblFruit VALUES (1,'Citrus ','Orange')
 INSERT @tblFruit VALUES (2,'Citrus','Lime')
 INSERT @tblFruit VALUES (3,'Citrus','Lemon')
 INSERT @tblFruit VALUES (4,'Seed','Cherry')
 INSERT @tblFruit VALUES (5,'Seed','Banana')

SELECT DISTINCT (f.tblFruit_FruitType), outter_f.tblFruit_ID
FROM @tblFruit AS f
OUTER APPLY (
    SELECT TOP(1) *
    FROM @tblFruit AS inner_f
    WHERE inner_f.tblFruit_FruitType = f.tblFruit_FruitType
) AS outter_f 
```

结果将是：

`Citrus 1`

`Seed 4`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-10T05:07:13.377

```
SELECT * FROM table_name GROUP BY columnName 
```

这将从表中选择所有具有不同值的列 columnName

# jquery-mobile - ui-btn-right 对于列表视图中的链接不可见

> ID：11937208
> 
> 赞同：0
> 
> 时间：2012-08-13T15:12:55.720
> 
> 标签：jquery-mobile

我编写了一个包含列表视图的应用程序。当我使用原始 css 文件时：

```
href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" 
```

列表视图在右侧显示图标。

当我使用 css 文件的本地副本（应用程序应该能够在没有网络连接的情况下运行）时

```
href="css/jquery.mobile-1.1.1.min.css" the icons are missing. 
```

如何使图标再次可见？他们为什么要隐藏？我已将以下图像添加到我的项目中。

```
images/ajax-loader.gif
images/ajax-loader.png
images/icons-18-black.png
images/icons-18-white.png
images/icons-36-black.png 
images/icons-36-white.png 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:22:00.317

你能告诉我你的图像文件夹在哪里吗？它在css文件夹中吗？如果没有，则将其复制到 css 文件夹或将 css 代码更改为：

```
../images/icons-36-white.png 
```

# android - 如何管理“返回”按钮上的压力以显示警报对话框

> ID：11937212
> 
> 赞同：0
> 
> 时间：2012-08-13T15:13:03.153
> 
> 标签：android, android-layout, android-intent

我想处理按钮`onBack`，当它被按下时，会`AlertDialog`出现一个，以便 onBack 按钮的压力，你将一个变量设置为-1。

这是我的警报对话框的代码：

```
protected Dialog onCreateDialog(int id)
{
    switch(id)
    {
      case CUSTOM_DIALOG:        
        AlertDialog.Builder builder1;
        builder1 = new AlertDialog.Builder(SecondaAttivita.this);       
        builder1.setView(layout);
        builder1.setCancelable(true);
        InputMethodManager imm = (InputMethodManager)getSystemService(
                    Context.INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(testo.getWindowToken(), 0);
        testo.setInputType(0);      
        alertDialog1 = builder1.create();       
        break;
      default:
        alertDialog1.dismiss();
        alertDialog1 = null;
    }

    return alertDialog1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:19:33.553

您可以通过以下代码在您的活动类中使用智能手机的按钮事件

```
public boolean onKeyDown(int keyCode, KeyEvent event) {
    // TODO Auto-generated method stub
    if (keyCode == KeyEvent.KEYCODE_BACK) {

        //Action against pressing back button here
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

# android - Android 布局更改

> ID：11937216
> 
> 赞同：0
> 
> 时间：2012-08-13T15:13:12.707
> 
> 标签：android, layout

我在布局上排列元素，但如果我使用线性布局，所有内容都沿左侧排列。如果我将`gravity`一些元素设置为`"center"`，例如，一些文本，那么在手机上，它看起来还可以。但是如果是一个垫子，那么整个视图都在左侧，而在右侧留下了很大的区域。

那么如何在任何设备上使视图居中呢？

第二个问题是：如果我将文本设置为更长，那么一些单词会消失（因为它们超出了布局）。如有必要，我怎样才能使单词位于多行的中心，而不是仅是一条非常长的行和视图之外的某些部分？

![问题布局.png](../Images/30094e1fa30397f6ab05a14228df912f.png)

```
<?xml version="1.0" encoding="utf-8"?>
<GridLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:background="#FFFFFF"
    android:layout_gravity="center">

    <TextView
        android:id="@+id/text"
        android:layout_column="0"
        android:layout_columnSpan="2"
        android:layout_gravity="right"
        android:layout_row="0"
        android:layout_rowSpan="3"
        android:ems="10" />

    <RadioGroup
        android:id="@+id/first_radiogroup"
        android:layout_column="0"
        android:layout_columnSpan="3"
        android:layout_gravity="bottom"
        android:layout_row="1"
        android:layout_rowSpan="3" >

        <RadioButton
            android:id="@+id/1_1"
            android:text="1_1" />

        <RadioButton
            android:id="@+id/1_2"
            android:text="1_2" />

        <RadioButton
            android:id="@+id/1_3"
            android:text="1_3" />
    </RadioGroup>

    <TextView
        android:id="@+id/firsttext"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_column="2"
        android:layout_row="2"
        android:shadowColor="#000000"
        android:shadowDx="1"
        android:shadowDy="1"
        android:shadowRadius="1.5"
        android:text="please choose from the below:"
        android:textColor="#000000"
        android:textSize="40px"
        android:textStyle="normal"
        android:typeface="serif" 
        android:gravity="center"/>

    <RadioGroup
        android:id="@+id/secon_radiogroup"
        android:layout_column="0"
        android:layout_gravity="bottom"
        android:layout_row="3"
        android:layout_rowSpan="3" >

        <RadioButton
            android:id="@+id/2_1"
            android:text="2_1" />

        <RadioButton
            android:id="@+id/2_2"
            android:text="2_2" />

        <RadioButton
            android:id="@+id/2_3"
            android:text="2_3" />
    </RadioGroup>

    <TextView
        android:id="@+id/secondtext"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_column="1"
        android:layout_columnSpan="2"
        android:layout_row="5"
        android:shadowColor="#000000"
        android:shadowDx="1"
        android:shadowDy="1"
        android:shadowRadius="1.5"
        android:text="please choose from the below:"
        android:textColor="#000000"
        android:textSize="40px"
        android:textStyle="normal"
        android:typeface="serif" />

    <Button
        android:id="@+id/final"
        android:layout_column="2"
        android:layout_row="6"
        android:text="final" />

    <Space
        android:layout_width="1dp"
        android:layout_height="21dp"
        android:layout_column="0"
        android:layout_row="0" />

    <Space
        android:layout_width="1dp"
        android:layout_height="20dp"
        android:layout_column="0"
        android:layout_row="4" />

    <Space
        android:layout_width="1dp"
        android:layout_height="174dp"
        android:layout_column="0"
        android:layout_gravity="fill_horizontal"
        android:layout_row="5" />

    <Space
        android:layout_width="1dp"
        android:layout_height="70dp"
        android:layout_column="0"
        android:layout_row="6" />

    <Space
        android:layout_width="213dp"
        android:layout_height="1dp"
        android:layout_column="2"
        android:layout_row="0" />

    <Space
        android:layout_width="104dp"
        android:layout_height="1dp"
        android:layout_column="0"
        android:layout_row="0" />

    <Space
        android:layout_width="3dp"
        android:layout_height="1dp"
        android:layout_column="1"
        android:layout_row="0" />

    <Space
        android:layout_width="1dp"
        android:layout_height="26dp"
        android:layout_column="0"
        android:layout_row="1" />

    <Space
        android:layout_width="1dp"
        android:layout_height="166dp"
        android:layout_column="0"
        android:layout_row="2" />

</GridLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:27:10.757

您应该为不同的屏幕尺寸制作不同的布局文件。下面的链接可以帮助你

[http://developer.android.com/training/basics/supporting-devices/index.html](http://developer.android.com/training/basics/supporting-devices/index.html)

# qt - QImage 和 valgrind ；内存泄漏

> ID：11937218
> 
> 赞同：3
> 
> 时间：2012-08-13T15:13:24.423
> 
> 标签：qt, valgrind

我对以下代码有疑问：

```
#include <QtGui/QImage>

int main(int argc, char* argv[]) {
  QImage qimage(100, 100, QImage::Format_ARGB32);
  qimage.fill(Qt::white);
  qimage.save("test.png", "PNG", 70);

  return 0;
} 
```

编译如下：

```
gcc -I/usr/include/qt4 test.cpp -lQtGui 
```

该代码生成正确的图像。但是，当我对它进行 valgrind 时：

```
valgrind --leak-check=full ./a.out 
```

它会产生一系列丢失的块，如下所示：

```
==5974== 158 (56 direct, 102 indirect) bytes in 1 blocks are definitely lost in loss record 54 of 79
==5974==    at 0x402B9B4: operator new(unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5974==    by 0x4E4E427: QLibraryPrivate::findOrCreate(QString const&, QString const&) (qlibrary.cpp:437)
==5974==    by 0x4E4E721: QLibrary::setFileNameAndVersion(QString const&, QString const&) (qlibrary.cpp:1110)
==5974==    by 0x56290DF: ??? 
```

或者这个：

```
==5974== 396 (56 direct, 340 indirect) bytes in 1 blocks are definitely lost in loss record 61 of 79
==5974==    at 0x402B9B4: operator new(unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5974==    by 0x4E4E427: QLibraryPrivate::findOrCreate(QString const&, QString const&) (qlibrary.cpp:437)
==5974==    by 0x4E44FB6: QFactoryLoader::updateDir(QString const&, QSettings&) (qfactoryloader.cpp:145)
==5974==    by 0x56F9E67: ??? 
```

我把完整的日志留给你，你可以在家里执行同样的操作:)

我试图理解，它们似乎位于我在 QImageWriter 的源代码中找到的以下几行中：

```
QFactoryLoader *l = loader();
QStringList keys = l->keys(); 
```

在我看来，当您第一次尝试生成 PNG 图像时，它会构建一些将在您每次构建 PNG 图像时重用的东西，并且永远不会释放内存。QFactoryLoader 的析构函数似乎知道如何清理东西，我很想亲自做一个`delete l;` 但没有办法调用它，因为 QFactoryLoader 是 Qt 实现的私有。

有人可能会争辩说这不是真正的内存泄漏，因为每种图像格式只有一个键，但是恕我直言，做事的干净方法是能够在退出之前清除所有内容。

所以我的问题是：有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:18:15.880

Qt 的图像 I/O 功能基于插件。当您请求`QImage`加载 png 文件时，PNG 库将作为`QObject` *一次*加载，直到程序退出才会卸载 - 这就是 Valgrind 认为的内存泄漏。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-13T15:53:27.380

你为什么不使用 QCoreApplication。只有这样 QObject GC 才会起作用。只有这样适当的清理才会起作用。Qt 是围绕着太多的指针在内部构建的，这些指针由主事件循环管理，没有这些指针完全是混乱和破坏性的。

# javascript - jqplot--如何在一张图表中使用 2 条具有非常不同的值的线来缩放以获得好的值？

> ID：11937220
> 
> 赞同：1
> 
> 时间：2012-08-13T15:13:28.467
> 
> 标签：javascript, charts, jqplot

我正在使用 jqplot 绘制图表，在一个图表中它将有 2 个线系列，但值有很大不同，一个是大约 2000，另一个可能超过 1,000,000，

我如何指定它具有 2 条 y 轴的 2 行，并且可以很好地显示在一个图表中？

目前我只看到一条线，它只是底部的一条普通线？我的代码如下

```
 $.ajax({url: myurl,
     success:function(json){

        $.jqplot.config.enablePlugins = true;

         var data = eval(json);
         var ssList = data[0];

         var sdList = data[1];

         var dataOption  = [ssList];
         if(sdList.length > 0){
             dataOption[1] = sdList;
         }

         var seriesOption = {lineWidth:2, markerOptions:{style:'square'}};
        if(sdList.length > 0){
            seriesOption[1] = {renderer:$.jqplot.OHLCRenderer, rendererOptions:{candleStick:true}};
        }

        var axisOption ={};
        axisOption.xaxis = {
                  renderer:$.jqplot.DateAxisRenderer,
                     tickOptions:{formatString:'%Y-%m-%d'}
                    };
        axisOption.yaxis = {autoscale:true,label: "time"};
        if(sdList.length > 0){
            axisOption.y2axis = {autoscale:true,label: "index"};
        }

         var plot2 = $.jqplot('chart2', dataOption, {
              title:'水木社区股票版人气指数',
              axes:axisOption,
              series:seriesOption,
             highlighter:{
                showMarker:false,
                tooltipAxes: 'xy',
                yvalues: 1,
                formatString:'<table class="jqplot-highlighter"><tr><td>日期:%s</td></tr><tr><td>人气指数:%s</td></tr></table>'    
             }

          });

    }}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-09T13:08:17.900

您可以创建具有更多“y”轴的图。第二个例子在这里[http://www.jqplot.com/tests/zooming.php](http://www.jqplot.com/tests/zooming.php) 不要使用自动缩放，尝试为每个设置最大值和最小值，你会让你的情节更具可读性。

# c# - Winforms Designer：如何禁用我的用户控件成为容器？

> ID：11937226
> 
> 赞同：5
> 
> 时间：2012-08-13T15:13:48.293
> 
> 标签：c#, winforms, drag-and-drop, containers, windows-forms-designer

我有一个相对简单的设置。我有一个自定义用户控件，上面有一堆组件、一些文本框和一个列表视图。

在设计器中，我可以将其他控件拖放到我的用户控件中，并将它们添加到用户控件实例中。我不想要这个。

我如何明确地说“不允许将其他控件添加到此用户控件？”

![再生产](../Images/45a15bdd8571640ff5191d251195153d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:52:47.853

这不是它的工作方式。当您将用户控件放在表单上时，不支持向其添加控件。这需要一个特殊的设计师，[这个答案](https://stackoverflow.com/questions/2785376/how-to-bubble-a-controls-features-when-place-in-a-custom-usercontrol/2863807#2863807)显示了需要什么。也许*看起来*控件已添加，但它们仅与您的用户控件*重叠。*他们的父母仍然是形式。

如果程序员自己在设计器中打开您的用户控件类，那么当然，他可以随心所欲地添加控件。阻止这种情况的唯一方法是不发布源代码并使用*sealed*关键字来防止从中派生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:31:32.137

您可以创建一个布尔属性`MyContainer.DisableAddControls`或其他东西。

如果你`MyContainer.Controls.Add(..)`的被覆盖，那么你可以在该方法中抛出一些自定义异常，`Add()`如下所示：

```
if(DisableAddControls)
{
    throw new DisableAddControlsException();
} 
```

如果您直接从 继承该方法`ContainerControl`，那么您可以处理该`ControlAdded`事件并在那里引发异常。

```
myContainer.ControlAdded += myContainerControlAdded;

private void Control_Added(object sender, System.Windows.Forms.ControlEventArgs e)
{
    if(DisableAddControls)
    {
        throw new DisableAddControlsException();
    }
} 
```

**再想一想，这不会在设计时抛弃你的设计师......没关系。**

# ruby-on-rails - 有没有办法返回当前登录的设计用户数？

> ID：11937228
> 
> 赞同：2
> 
> 时间：2012-08-13T15:13:54.190
> 
> 标签：ruby-on-rails, ruby, devise

有没有办法确定有多少用户使用 devise 主动登录到 rails 应用程序？

导轨 3.1

宝石'设计'，'〜> 1.4'宝石'dm-设计'，'〜> 1.5'

with : 数据库可验证

我正在寻找专门的红宝石代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:47:25.457

由于与登录相关的所有信息都在会话中处理，因此没有简单的开箱即用方法。我建议在 ApplicationController 中做一些事情来管理这些信息。

我们在许多应用程序中使用 before_filter 来跟踪有关每个页面请求的非常具体的信息。您可以执行类似的操作来跟踪他们点击的页面、点击时间以及他们是谁。

然后确定登录用户就像确定他们的最后一次页面加载需要多长时间才能算作登录一样简单，然后根据此在您的视图表上进行选择。就像是

MyPageView.select(["DISTINCT user WHERE created_at > ?", my_threshold_time]) 会给你不同的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-19T15:43:29.277

我写了[一篇](http://dainger.us/blog_posts/tracking-currently-logged-in-users-with-devise)关于这个的博客文章。我们不得不在工作中这样做，而这个解决方案似乎符合我们的需求。

您应该将 last_request_at 和 logged_in 添加到您的用户模型中。last_request_at 可以从请求的 user_session 信息中获取。Logged_in 应设置在 sign_in / sign_out 上。

# ruby-on-rails-3 - Elasticsearch/Tire 文本查询 DSL，用于排除某些字段被搜索

> ID：11937230
> 
> 赞同：2
> 
> 时间：2012-08-13T15:14:01.087
> 
> 标签：ruby-on-rails-3, elasticsearch, tire

我有一个弹性搜索查询，如下所示，

```
{
  "query": {
    "bool": {
      "must": [
        {
          "query_string": {
            "fields": ["title"],
            "query": "test"
          }
        }
      ],
      "must_not": [],
      "should": []
    }
  },
  "from": 0,
  "size": 50,
  "sort": [],
  "facets": {}
} 
```

如上所述，我可以通过向 query_string 提供字段参数来对某些字段执行弹性搜索查询。在我的索引映射中，我索引了大约 50 个字段。我如何查询除一个字段之外的所有字段。类似于查询字符串的排除选项。轮胎/弹性搜索可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:18:51.910

我认为它无法完成并继续获取所有映射并解析实际上有点糟糕的哈希。

# asp.net - 强制控制器/动作接受 MVC4 的 JSON 的本机属性？

> ID：11937233
> 
> 赞同：0
> 
> 时间：2012-08-13T15:14:08.307
> 
> 标签：asp.net, ajax, asp.net-mvc, asp.net-ajax, asp.net-mvc-4

我正在使用 ASP.NET MVC 4 想强制内容类型默认为 application/json 以进行操作。有没有办法强制控制器/动作使用 JSON？

注意：有一个[答案，但关于 MVC3](https://stackoverflow.com/questions/9036017/how-to-force-controller-action-to-use-jsonvalueprovider)。MVC4 中是否发布过任何原生的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:38:57.787

MVC 4 中没有添加任何新内容来改变对 MVC 3 给出的答案。抱歉。

# php - Symfony2：在 SonataAdmin 中覆盖 createAction()

> ID：11937235
> 
> 赞同：7
> 
> 时间：2012-08-13T15:14:32.793
> 
> 标签：php, symfony, sonata-admin

在过去的几天里，我一直在疯狂地搜索（但没有成功）如何覆盖 SonataAdmin 操作以捕获会话用户名并将其保存在外键字段中。

AttachmentAdminController 类：

```
<?php

namespace Application\Sonata\UserBundle\Controller;

use Sonata\AdminBundle\Controller\CRUDController as Controller;
#use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use FOS\UserBundle\Entity\User;
use Symfony\Component\Security\Core\SecurityContextInterface;
use Symfony\Bridge\Monolog\Logger;
use Mercury\CargoRecognitionBundle\Entity\Attachment;

class AttachmentAdminController extends Controller
{
    /**
     * (non-PHPdoc)
     * @see Sonata\AdminBundle\Controller.CRUDController::createAction()
     */
    public function createAction()
    {
        $result = parent::createAction();

        if ($this->get('request')->getMethod() == 'POST')
        {
            $flash = $this->get('session')->getFlash('sonata_flash_success');

            if (!empty($flash) && $flash == 'flash_create_success')
            {
                #$userManager = $this->container->get('fos_user.user_manager');
                #$user = $this->container->get('context.user');
                #$userManager = $session->get('username');
                $user = $this->container->get('security.context')->getToken()->getUser()->getUsername();

                $attachment = new Attachment();
                $attachment->setPath('/tmp/image.jpg');
                $attachment->setNotes('nothing interesting to say');
                $attachment->getSystemUser($user);

                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($product);
                $em->flush();
            }
        }

        return $result;
    }
} 
```

服务附件：

```
mercury.cargo_recognition.admin.attachment:
    class: Mercury\CargoRecognitionBundle\Admin\AttachmentAdmin
    tags:
        - { name: sonata.admin, manager_type: orm, group: General, label: Attachments }
    arguments: [ null, Mercury\CargoRecognitionBundle\Entity\Attachment, "SonataAdminBundle:CRUD" ] 
```

在我看来，actionController() 被 SonataAdminBundle （可能还有整个类文件）忽略了，因为根本没有错误消息，但我不知道为什么。实际上，我不确定我是否从会话中获取用户名。

我真的需要一个很好的教程，但似乎我得到的任何信息在某些方面都是过时的。顺便说一句，我使用的是 Symfony 2.0.16

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T21:04:43.690

最后我得到了解决方案。我敢肯定还有其他一些（例如使用事件侦听器，这似乎更简单），但现在这是我能找到的最好的（它有效，这很重要）。

我试图覆盖`createAction()`我在另一个论坛线程中找到的基于示例，但我在表中得到了两条记录，而不是只有一条。最重要的是覆盖整个操作方法并将自定义代码放入其中。

**控制器**：

```
<?php

namespace Mercury\CargoRecognitionBundle\Controller;

use Symfony\Component\Security\Core\SecurityContextInterface;
use Symfony\Bridge\Monolog\Logger;
use Sonata\AdminBundle\Controller\CRUDController as Controller;
use Application\Sonata\UserBundle\Entity\User;
use Mercury\CargoRecognitionBundle\Entity\Attachment;
use Mercury\CargoRecognitionBundle\Entity\SystemUser;
use Mercury\CargoRecognitionBundle\Repository\SystemUserRepository;

class AttachmentAdminController extends Controller
{
    /**
     * Set the system user ID
     */
    private function updateFields($object)
    {
        $userName = $this->container->get('security.context')
                        ->getToken()
                        ->getUser()
                        ->getUsername();

        $user = $this->getDoctrine()
                    ->getRepository('ApplicationSonataUserBundle:User')
                    ->findOneByUsername($userName);

        $object->setSystemUser($user);

        return $object;
    }

    /**
     * (non-PHPdoc)
     * @see Sonata\AdminBundle\Controller.CRUDController::createAction()
     */
    public function createAction()
    {
        // the key used to lookup the template
        $templateKey = 'edit';

        if (false === $this->admin->isGranted('CREATE')) {
            throw new AccessDeniedException();
        }

        $object = $this->admin->getNewInstance();

        $object = $this->updateFields($object);

        // custom method
        $this->admin->setSubject($object);

        $form = $this->admin->getForm();
        $form->setData($object);

        if ($this->get('request')->getMethod() == 'POST') {
            $form->bindRequest($this->get('request'));

            $isFormValid = $form->isValid();

            // persist if the form was valid and if in preview mode the preview was approved
            if ($isFormValid && (!$this->isInPreviewMode() || $this->isPreviewApproved())) {
                $this->admin->create($object);

                if ($this->isXmlHttpRequest()) {
                    return $this->renderJson(array(
                        'result' => 'ok',
                        'objectId' => $this->admin->getNormalizedIdentifier($object)
                    ));
                }

                $this->get('session')->setFlash('sonata_flash_success','flash_create_success');
                // redirect to edit mode
                return $this->redirectTo($object);
            }

            // show an error message if the form failed validation
            if (!$isFormValid) {
                $this->get('session')->setFlash('sonata_flash_error', 'flash_create_error');
            } elseif ($this->isPreviewRequested()) {
                // pick the preview template if the form was valid and preview was requested
                $templateKey = 'preview';
            }
        }

        $view = $form->createView();

        // set the theme for the current Admin Form
        $this->get('twig')->getExtension('form')->setTheme($view, $this->admin->getFormTheme());

        return $this->render($this->admin->getTemplate($templateKey), array(
            'action' => 'create',
            'form'   => $view,
            'object' => $object,
        ));
    }
} 
```

**控制器服务**：

```
mercury.cargo_recognition.admin.attachment:
    class: Mercury\CargoRecognitionBundle\Admin\AttachmentAdmin
    tags:
        - { name: sonata.admin, manager_type: orm, group: General, label: Attachments }
    arguments: [ null, Mercury\CargoRecognitionBundle\Entity\Attachment, "MercuryCargoRecognitionBundle:AttachmentAdmin" ] 
```

我从以下站点获取了解决方案：

*   [奏鸣曲用户](https://groups.google.com/forum/?fromgroups#!msg/sonata-users/xs3cNFD7oO4/pJYtqHgULY8J%5B1-25%5D)，
*   [Symfony 框架论坛](http://forum.symfony-project.org/viewtopic.php?f=23&t=44695&p=137924#p137924)，

（以及奏鸣曲项目文档）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-15T12:32:12.420

使用您自己的逻辑仅覆盖**preCreate**挂钩可能很有用：

```
/**
 * This method can be overloaded in your custom CRUD controller.
 * It's called from createAction.
 *
 * @param mixed $object
 *
 * @return Response|null
 */
protected function preCreate(Request $request, $object)
{
} 
```

# sql - 别名列 SQL

> ID：11937240
> 
> 赞同：0
> 
> 时间：2012-08-13T15:15:08.467
> 
> 标签：sql, sql-server, sql-server-2008

我有两个简单的列： 我尝试编写一个单独计算每天的查询，`datetime PayDate`但它不起作用。`int Amount``Amount`

```
SELECT YEAR(PayDate) + '/' + MONTH(PayDate) + '/' + DAY(PayDate) as a,
COUNT(Amount) as b
FROM TABLE1
GROUP BY a,b 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:16:20.407

至少在 SQL Server 中，不能在 GROUP BY 语句中使用*别名。*您必须重复该声明。

悲伤，但真实。

```
SELECT YEAR(PayDate) + '/' + MONTH(PayDate) + '/' + DAY(PayDate) as a,
COUNT(Amount) as b
FROM TABLE1
GROUP BY YEAR(PayDate) + '/' + MONTH(PayDate) + '/' + DAY(PayDate),COUNT(Amount) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:19:34.567

你为什么要为所有这些凌乱的字符串连接而烦恼？如果您想要特定的输出，请在客户端上格式化。尽可能使用基本类型而不是字符串。

```
SELECT CONVERT(DATE, PayDate) AS a, COUNT(Amount) AS b
FROM dbo.TABLE1
GROUP BY CONVERT(DATE, PayDate); 
```

如果您有一个*合理*的复杂表达式，避免重复它的最简单方法是使用子查询或 CTE：

```
SELECT a, COUNT(b) FROM
(SELECT CONVERT(DATE, PayDate) AS a, Amount AS b FROM dbo.TABLE1) AS x
GROUP BY a;

-- or

WITH x(a,b) AS
(SELECT CONVERT(DATE, PayDate), Amount FROM dbo.TABLE1)
SELECT a, COUNT(b) FROM x
GROUP BY a; 
```

（我不知道你为什么在你的问题中同时按 a 和 b 分组。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:18:09.027

您不能在语句中使用*别名。*`GROUP BY`而且不需要使用`GROUP BY Count(Amount)`

```
SELECT YEAR(PayDate) + '/' + MONTH(PayDate) + '/' + DAY(PayDate) as a,
COUNT(Amount) as b
FROM TABLE1
GROUP BY YEAR(PayDate) + '/' + MONTH(PayDate) + '/' + DAY(PayDate) 
```

或在 SQL Server 中执行此操作的其他方式：

```
SELECT Convert(varchar(20),PayDate,111) as a,
COUNT(Amount) as b
FROM TABLE1
GROUP BY Convert(varchar(20),PayDate,111) 
```

请参阅[投射和转换](http://msdn.microsoft.com/en-us/library/aa226054%28v=sql.80%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T15:19:42.273

在 MySQL 上，您还可以简单地使用购买来获取 datetime 列的日期。我不知道为什么在这种情况下你会按别名 b 分组。在大多数情况下，您可能还想按日期值排序。

```
SELECT DATE(PayDate) as a, COUNT(Amount) as b
FROM TABLE1
GROUP BY a
ORDER BY a 
```

# git - git pull 无法识别它“拉”的文件

> ID：11937241
> 
> 赞同：0
> 
> 时间：2012-08-13T15:15:09.460
> 
> 标签：git

在以前的项目中，我曾经使用运行“svn up”的 cron 作业来使测试站点保持最新。

我正在尝试在使用 git 的新项目中重现相同的内容。

```
*/5 * * * * cd /path/to/project; git checkout .;  sudo -u nonrootuser git pull >/dev/null 2>> /path/to/project/cron.log; chgrp web . -R; 
```

我添加了最初的 git checkout 。看看我是否可以解决这个问题，但它仍然存在。问题如下，大约每周一次，我收到此消息：

```
error: Your local changes to 'path/to/aFileThatDidntExistLocally.xxx' would be overwritten by merge.  Aborting. Please, commit your changes or stash them before you can merge. 
```

但是在 pull 命令之前该文件确实不存在。几乎就像 git pull 命令正在获取文件，暂存它们，然后就像阿尔茨海默病一样，无法识别已创建文件，因此由于文件已经存在而中止。

即使我删除了文件，它也会再次发生。如果我用我的根用户运行一个简单的“git pull”，也会发生这种情况。而且它似乎是一种随机的，在过去的三周里它发生在我身上大约 3 次。其余时间，cron 作业按预期工作，每 5 分钟一次。

我发现让它再次正确拉动的唯一方法是运行“git clean -f”，但它不是我想放在我的 cron 作业中的东西，因为它会删除我所有未跟踪的文件。

我怀疑提交/推送，但我没有看到任何异常。发生了什么事，我怎样才能持续更新我的测试站点，而不必每次都删除所有未跟踪的文件？

（编辑）这是我的 .gitignore 和 .git/config 文件的副本：http: [//pastebin.com/SxXbshuN](http://pastebin.com/SxXbshuN)

# vhdl - 设计用于初始化的 VHDL 状态机

> ID：11937254
> 
> 赞同：2
> 
> 时间：2012-08-13T15:15:41.483
> 
> 标签：vhdl

您如何最聪明地设计用于初始化芯片的 VHDL 状态机。

我目前的设计是（在伪代码中）：

> ....
> ....
> 案例状态：
> 当 s0 =>
> VHDL_CODE_FOR_WRITING_VALUE_TO_REGISTER
> 状态：= s1;
> 当 s1 =>
> VHDL_CODE_FOR_WRITING_ANOTHER_VALUE_TO_REGISTER
> 状态：= s1；
> 当 s2 =>
> DO_SOMETHING_ELSE_TO_FINISH_INIT
> ....
> ....
> 结束时；

s0 和 s1 中的代码仅因写入寄存器的值不同。

这让我觉得一定有更聪明的方法（仍然可以合成）？

让我觉得可以做得更聪明的是“不要重复自己”这句话，但我不确定这是否适用于 VHDL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T16:57:11.410

如果你在状态 s0 和 s1 有共同的赋值，把它从 case 语句中拉出来。

```
case state:
when s0 =>    
    a <= '0';
    b <= '1';
    c <= '0';
    nextState <= s1;
when s1 =>    
    a <= '0';
    b <= '1';
    c <= '1';
    nextState <= s2;
when s2 =>    
    a <= '1';
    b <= '0';
    c <= '1';
endcase; 
```

...会成为...

```
a <= '0';
b <= '1';
c <= '1';

case state:
when s0 =>    
    c <= '0';
    nextState <= s1;
when s1 =>    
    nextState <= s2;
when s2 =>    
    a <= '1';
    b <= '0';
endcase; 
```

...或者如果这不合适，请将代码拉入一个函数并在每种情况下调用它。

不过，VHDL 并没有什么具体的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T08:44:44.230

尽管 VHDL 回答者（包括我）的不断重复是“思考硬件，而不是软件”，但这一次软件思考过程是为您服务的一个很好的过程 :)

通常的[不重复自己（DRY）](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)解决方案是将您想要的行为封装在函数或过程中。您可以在 VHDL 中做到这一点，任何有能力的工具都可以使用它。

# xcode - 显示 ABPeoplePickerNavigationController 时如何指定组？

> ID：11937256
> 
> 赞同：0
> 
> 时间：2012-08-13T15:15:44.843
> 
> 标签：xcode, abpeoplepickerview

这个问题似乎只有 50% 的人回答了： [如何在显示 ABPeoplePickerNavigationController 时指定组](https://stackoverflow.com/questions/2434334/how-to-specify-a-group-when-displaying-an-abpeoplepickernavigationcontroller)

显示联系人后，将显示所有联系人组。

我想显示特殊组的所有联系人。

那可能吗？

# .net - 在动作链接内渲染跨度

> ID：11937258
> 
> 赞同：2
> 
> 时间：2012-08-13T15:15:59.550
> 
> 标签：.net, asp.net-mvc, razor

我想知道是否有一种方法可以使用内联跨度在链接旁边呈现 html 链接`HTML.ActionLink`？

结果应该是：

```
<a href="Controller/Action">Test<span></span></a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:20:50.867

现在不行。但是，您可以执行以下操作：

```
<a href="@Url.Action("action", "controller")">Test<span></span></a> 
```

# c# - 在 form2 关闭时检索变量 A 的更新值？C＃

> ID：11937259
> 
> 赞同：0
> 
> 时间：2012-08-13T15:16:00.277
> 
> 标签：c#, forms, variables, formclosing

这是一个非常简单的问题，但我找不到解决方案（如果这是原始的，我不是专业程序员，抱歉！）。在 Form1 中，我有一个名为“A”的变量，它的值为 1。我将其发送到 Form2 并将值更改为 2。在 Form2 关闭时，我需要将更新后的值发送到 Form1。最后一部分我不知道该怎么做，我需要你的帮助。如何在 form2 关闭时检索变量 A 的更新值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:21:03.320

如果您有一个由 Form2 更改的值，并且该值由 Form2 管理，则可以将其公开为 Form2 的属性，例如

```
public class Form2
{
    public string MyValue
    {
        get { return myValue; }
    }
} 
```

然后你可以像

```
Form2 f2 = new Form2();
f2.ShowDialog();
string theValue = f2.MyValue; 
```

通常，您可能希望检查 ShowDialog() 返回的 DialogResult 以查看用户是否按下了例如 OK 或 Cancel 按钮。我不确定在这种特殊情况下您是否需要它。

**更新**

如果 Form2 不是对话框，则可以改为使用回调模式通知 Form1 Form2 正在关闭，以允许 Form1 从 Form2 检索它需要的任何值。或者，您可以让回调直接提供您需要的值。

具体来说，您可以将 a 传递`Func<T>`给指向 Form1 中的回调方法的 Form2。`Func<T>`当 Form2确定它正在关闭时，它会调用它。此处，`T`表示您要传回 Form1 的变量类型。

这是一个假设`T`是字符串的示例：

```
public Form2 : Form
{
    public void MyCallback(string value) { /* Do something with value */
}

public Form1 : Form
{
    Func<string> callback;
    public Form1(Func<string> callback)     
    {
        this.callback = callback;
    }

    private void Form1_FormClosed(object sender, FormClosedEventArgs e)
    {
        if (callback != null) callback(myValue);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:22:52.293

WinForm 有一个名为`FormClosing`. 右键单击表单并选择属性，在 IDE 右侧，您将获得属性。会有一个黄色的“闪电”图标。你会在`FormClosing`那里找到活动。现在在表单关闭时添加您想要的代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T15:23:45.427

您可以`form2.FormClosing`在`form1`. 在那里，您可以在关闭时检索您的价值`form2.B`（前提是它是可公开访问的） 。`form1``form2`

```
form2.FormClosing += OnFormBClosing;

private void OnFormBClosing(object sender, FormClosingEventArgs eventArgs)
{
    A = form2.B;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T15:25:20.957

从结束事件使用

```
private void Form2_Closing(object sender, System.ComponentModel.CancelEventArgs e)
{
   //update 
} 
```

[MSDN 库](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.closing.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T15:27:40.247

如果您可以发布您的实际源代码可能会更好。

我想你从Form1打开Form2，对吗？如果是真的，我认为写这样的东西可能会更好，尝试从 form2 关闭事件更新 form1。

```
Form2 form2 = new Form2();
form2.A = this.A; // here this = form1
if (DialogResult.OK == form2.ShowDialog())
{
    // So here, retrieve the property from form2.
    this.A = form2.A;
} 
```

# c# - 我可以将任何类型的测试添加到我现有的解决方案中吗？

> ID：11937260
> 
> 赞同：0
> 
> 时间：2012-08-13T15:16:06.563
> 
> 标签：c#, asp.net, testing

我研究过 TDD，不幸的是该项目已经完成了大部分开发，现在实施它没有任何意义。*但是*，该项目尚未部署，每周都会有更改以添加到现有代码中。

是否有任何类型的测试可以添加到我可以每天运行的站点以确保我的代码始终有效？万一其他人在网站上开始开发，或者添加了任何新代码，或者编辑了旧代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:19:54.653

当然，您可以添加一些类型的测试：

*   [单元测试](http://en.wikipedia.org/wiki/Unit_testing)- 单独测试类（假设代码的 DI 结构）
*   [集成测试](http://en.wikipedia.org/wiki/Integration_testing)- 测试类之间的交互（通常是两个类）
*   [UI 测试](http://en.wikipedia.org/wiki/List_of_GUI_testing_tools)- 使用自动化（例如 selenium，自动化浏览器）来测试从 UI 到数据库的应用程序
*   [性能测试](http://en.wikipedia.org/wiki/Software_performance_testing)

最好专注于更改领域（错误修复、功能请求），以获得最大的收益。

Nitpick：[TDD](http://en.wikipedia.org/wiki/Test-driven_development)是一种使用测试框架的设计方法，而不是一种测试方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:18:25.303

如果每周都有变化，那么“项目已经完成了大部分开发”可能不是一个真实的说法。事实上，大部分的发展仍在前面。

引入单元测试还是很值得的。我建议每周创建新的测试，涵盖需要维护的代码区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:20:30.457

好吧，如果您将测试重新安装到遗留代码库中，您将不会实施 TDD。我建议花时间至少为新代码生成单元测试。希望您的代码会侵占遗留代码，然后您可以放置​​单元测试。小步骤是遗留代码的关键。没有硬性和快速的方法可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T15:23:28.743

单元测试总是可以添加的，添加它们总是一个好主意。在您的情况下，我建议使用 NUnit，因为它似乎与现有代码一起工作得很好。它也很容易使用。

# wpf - 组合框性能缓慢

> ID：11937268
> 
> 赞同：4
> 
> 时间：2012-08-13T15:16:55.607
> 
> 标签：wpf, performance, combobox, styles, datatemplate

正如以下文章[http://vbcity.com/blogs/xtab/archive/2009/12/15/wpf-using-a-virtualizingstackpanel-to-improve-combobox-performance.aspx](http://vbcity.com/blogs/xtab/archive/2009/12/15/wpf-using-a-virtualizingstackpanel-to-improve-combobox-performance.aspx)中解释的那样，我使用**VirtualizingStackPanel**来**改进**我项目的**ComboBoxes**的**性能**。

 **而且效果很好......直到我将样式应用于 ComboBox 以更改布局（我在这里找到了样式：http: [//msdn.microsoft.com/en-us/library/ee230084.aspx](http://msdn.microsoft.com/en-us/library/ee230084.aspx)）

这是演示该问题的示例的源代码（计算 ComboBox 的 ItemSource 属性填充了 10 000 个项目）。

如果有人有想法...

```
 <Window.Resources>

    <!-- Fill Brushes -->
    <LinearGradientBrush x:Key="NormalBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#CCC" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="HorizontalNormalBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#CCC" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="LightBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#EEE" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="HorizontalLightBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#EEE" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="DarkBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#AAA" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="PressedBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#BBB" Offset="0.0"/>
                <GradientStop Color="#EEE" Offset="0.1"/>
                <GradientStop Color="#EEE" Offset="0.9"/>
                <GradientStop Color="#FFF" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="DisabledForegroundBrush" Color="Black" />
    <SolidColorBrush x:Key="DisabledBackgroundBrush" Color="#E5E5E5" />
    <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFF" />
    <SolidColorBrush x:Key="SelectedBackgroundBrush" Color="#DDD" />

    <!-- Border Brushes -->
    <LinearGradientBrush x:Key="NormalBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#AAA" Offset="0.0"/>
                <GradientStop Color="#AAA" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="HorizontalNormalBorderBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#AAA" Offset="0.0"/>
                <GradientStop Color="#AAA" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="DefaultedBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#AAA" Offset="0.0"/>
                <GradientStop Color="#AAA" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="PressedBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#AAA" Offset="0.0"/>
                <GradientStop Color="#AAA" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <SolidColorBrush x:Key="DisabledBorderBrush" Color="#AAA" />
    <SolidColorBrush x:Key="SolidBorderBrush" Color="#888" />
    <SolidColorBrush x:Key="LightBorderBrush" Color="#AAA" />

    <!-- Miscellaneous Brushes -->
    <SolidColorBrush x:Key="GlyphBrush" Color="#444" />
    <SolidColorBrush x:Key="LightColorBrush" Color="#DDD" />

    <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="16" />
            </Grid.ColumnDefinitions>
            <Border x:Name="Border" Grid.ColumnSpan="2" CornerRadius="2" Background="{StaticResource NormalBrush}" BorderBrush="{StaticResource NormalBorderBrush}" BorderThickness="1" />
            <Border x:Name="Border2" Grid.Column="0" CornerRadius="2,0,0,2" Margin="1" Background="{StaticResource WindowBackgroundBrush}" BorderBrush="{StaticResource NormalBorderBrush}" BorderThickness="0,0,1,0" />
            <Path x:Name="Arrow" Grid.Column="1" Fill="{StaticResource GlyphBrush}" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 4 4 L 8 0 Z"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="ToggleButton.IsMouseOver" Value="true">
                <Setter TargetName="Border" Property="Background" Value="{StaticResource DarkBrush}" />
            </Trigger>
            <Trigger Property="ToggleButton.IsChecked" Value="true">
                <Setter TargetName="Border" Property="Background" Value="{StaticResource PressedBrush}" />
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="Border" Property="Background" Value="{StaticResource DisabledBackgroundBrush}" />
                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DisabledBorderBrush}" />
                <Setter TargetName="Border2" Property="Background" Value="{StaticResource DisabledBackgroundBrush}" />
                <Setter TargetName="Border2" Property="BorderBrush" Value="{StaticResource DisabledBorderBrush}" />
                <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}"/>
                <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource DisabledForegroundBrush}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="ComboBoxTextBox" TargetType="TextBox">
        <Border x:Name="PART_ContentHost" Focusable="False" Background="{TemplateBinding Background}" />
    </ControlTemplate>

    <Style x:Key="ComboBoxBaseStyle" TargetType="ComboBox">
        <Setter Property="SnapsToDevicePixels" Value="true"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
        <Setter Property="MinHeight" Value="20"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <ToggleButton Name="ToggleButton" Template="{StaticResource ComboBoxToggleButton}" Grid.Column="2" Focusable="false" IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press">
                        </ToggleButton>
                        <ContentPresenter Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="3,3,23,3" VerticalAlignment="Center" HorizontalAlignment="Left" />
                        <TextBox x:Name="PART_EditableTextBox" Style="{x:Null}" Template="{StaticResource ComboBoxTextBox}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="3,3,23,3" Focusable="True" Background="Transparent" Visibility="Hidden" IsReadOnly="{TemplateBinding IsReadOnly}"/>
                        <Popup Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                            <Grid Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                <Border x:Name="DropDownBorder" Background="{StaticResource WindowBackgroundBrush}" BorderThickness="1" BorderBrush="{StaticResource SolidBorderBrush}"/>
                                <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                    <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                </ScrollViewer>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasItems" Value="false">
                            <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}"/>
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="true">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                        </Trigger>
                        <Trigger SourceName="Popup" Property="Popup.AllowsTransparency" Value="true">
                            <Setter TargetName="DropDownBorder" Property="CornerRadius" Value="4"/>
                            <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0"/>
                        </Trigger>
                        <Trigger Property="IsEditable" Value="true">
                            <Setter Property="IsTabStop" Value="false"/>
                            <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
        </Style.Triggers>
    </Style>

</Window.Resources>

<StackPanel>

    <ComboBox x:Name="CustomerComboBox_WithoutStyle" SelectedValuePath="Id" DisplayMemberPath="Text" >
        <ComboBox.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel />
            </ItemsPanelTemplate>
        </ComboBox.ItemsPanel>
    </ComboBox>

    <ComboBox x:Name="CustomerComboBox_WithStyle" SelectedValuePath="Id" DisplayMemberPath="Text" Style="{StaticResource ComboBoxBaseStyle}" >
        <ComboBox.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel />
            </ItemsPanelTemplate>
        </ComboBox.ItemsPanel>
    </ComboBox>

</StackPanel> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T15:53:09.413

您的风格的问题在于它不使用任何类型的 UI 虚拟化。尝试用 VirtualizingStackpanel 替换 StackPanel 并将 VirtualizationMode 设置为 Recycle，您将看到巨大的性能提升。

您的方法强制 WPF 为您的 10k 个项目中的每一个实现一个容器和 FrameworkElement，因为您只有 1 个 UI 线程，这需要一个永恒。只需更换

```
<StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" /> 
```

和

```
<VirtualizingStackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" /> 
```

看看它是否变得更快。

更准确地说，您在派生样式中覆盖 ItemsPanel，但在基本样式中没有“ItemsPresenter”。而不是使用 StackPanel “硬编码”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:23:34.950

这么多项目可能是（UI）设计缺陷的结果。

尝试使用一个列表框或多个组合框，其中第一个组合框是一个类别，第二个是第一个组合框的子类别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:39:17.100

在一个组合框中有 10000 个项目不是很好的设计。MaxDropDownItems 可能会为您提供帮助，因为需要较少的渲染。（这是单击下拉菜单时显示的可见项目数）

但是，您应该考虑使用列表框。当您应用列表框时，您应该使用页面，并且每个页面上有 1000 条记录。或使用搜索框**

# slickgrid - slickgrid 中的新行，验证器不会触发

> ID：11937271
> 
> 赞同：1
> 
> 时间：2012-08-13T15:17:07.713
> 
> 标签：slickgrid

我为我的一列配置了 requiredFieldValidator，它对现有行按预期工作。当我通过 Tab 或单击开始编辑新行时，验证器在移出该列时不会触发。当移出新行（列中没有数据）以便提交，然后移回该行时，现在验证器可以工作......但只有当我在编辑器中放入一些数据，然后删除它时。

换句话说，对于新行，requiredFieldValidator 不会做任何事情，直到我在列中实际键入内容。如果我将一列留空，它将永远不会触发，从而违背了它的目的。有趣的是，他们提供的示例（http://mleibman.github.com/SlickGrid/examples/example3-editing.html）也存在同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T19:47:07.753

这将检查两个值是否为“”。我相信这应该返回 true，因为验证器可能是“必需的”验证器。

```
 this.isValueChanged = function () {
  // this needs to validate if both are empty since a validator might be a "required" validator
  if ($input.val() == "" && defaultValue == "")
    return true;
  else 
    return (!($input.val() == "" && defaultValue == "")) && ($input.val() != defaultValue);
}; 
```

首选方法是创建一个自定义编辑器，这样您就不会使用核心库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T05:27:44.643

我同意，我自己也遇到过这种行为。这是解决方案。

将 this.isValueChanged 函数内容更改为以下内容。

```
if(($input.val().length > 0) && ($input.val() != defaultValue))
            return true;
    else if(($input.val() == defaultValue)&&($input.val().length > 0))
            return true;
    else if(($input.val().length == 0) && ((undefined === defaultValue )||(defaultValue == "")))
            return true;
    else
            return false; 
```

由于某种原因，在第一次交互期间未设置 defaultValue，我猜如果将其初始化为“”，则无需检查未定义。

无论如何，defaultValue 保存单元格的先前值，因此当它为空并且它是正在编辑的第一个单元格时，它是未定义的，之后对于所有其他空单元格，它被设置为“”。

问题是这个函数需要告诉网格值已经改变，以便单元格编辑器验证输入。在提供的实现中，表达式总是返回 false，因为

```
$input.val() == "" evaluates to true and then the expression 
!($input.val() == "" && defaultValue == null)) evaluates to false 
```

这意味着 defaultValue 是连续未定义的。

希望这是有道理的，我的代码可以帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T08:14:16.920

Roman的第一个else if有错误，返回false。否则，即使值未更改，单元格中的任何更改都会返回 true。我试过这个并且它有效。

```
this.isValueChanged = function () {
        var attuale = $input.val();
        if((attuale.length > 0) && (attuale != defaultValue))
            return true;
        else if((attuale == defaultValue)&&(attuale.length > 0))
            return false;
        else if((attuale.length == 0) && ((undefined === defaultValue )||(defaultValue == "")))
            return true;
        else
            return false;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T14:02:39.603

有同样的问题，我相信理想情况下 defaultValue 应该设置为 undefined 或 null，当它没有被初始化时。所以我通过以下方式修改了 TextEditor：

```
function TextEditor(args) {
    var $input;
    var defaultValue;
    var scope = this;

    this.loadValue = function (item) {
        defaultValue = item[args.column.field] || null;
        $input.val(defaultValue);
        $input[0].defaultValue = defaultValue;
        $input.select();
    };

    this.isValueChanged = function () {
        return $input.val() != defaultValue;
    };

    .... 
```

将默认 defaultValue 设置为 null 并简化 isValueChanged。

# php - 在单选按钮之间添加 Zend 表单元素

> ID：11937275
> 
> 赞同：-1
> 
> 时间：2012-08-13T15:17:38.347
> 
> 标签：php, zend-framework, zend-form, zend-form-element

我想在同一个单选按钮的 2 个选项之间创建一个带有文本元素的表单，以便在选择该选项时使用 javascript 显示它。

谁能提供一些关于如何做到这一点的线索？

坦克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:55:03.797

您可能想看看[复合表单元素元素](http://framework.zend.com/manual/en/learning.form.decorators.composite.html)。底线是，你不能按照你的要求去做。您必须创建一个新的表单元素，以在呈现每个单选按钮时呈现您想要的表单元素。

# wcf - 使用 UserNamePasswordValidation 和会话的 WCF 服务

> ID：11937284
> 
> 赞同：1
> 
> 时间：2012-08-13T15:18:09.320
> 
> 标签：wcf, session, authentication

我有一个当前使用的 WCF 服务`basicHttpBinding`，`userNamePasswordValidationMode`并且 `TransportWithMessageCredential`，这是我的配置：

```
<behavior name="Secure">
      <serviceMetadata httpsGetEnabled="true" httpGetEnabled="false" />
      <serviceDebug includeExceptionDetailInFaults="true"/>
      <serviceCredentials>
        <userNameAuthentication userNamePasswordValidationMode="Custom"
                                customUserNamePasswordValidatorType="Kestrel.MIS3.Server.Services.Security.LoginAuthentication, Kestrel.MIS3.Server.Services" />
      </serviceCredentials>
      <serviceAuthorization principalPermissionMode="Custom">
        <authorizationPolicies>
          <add policyType="Kestrel.MIS3.Server.Services.Security.AuthorizationPolicy, Kestrel.MIS3.Server.Services"/>
        </authorizationPolicies>
      </serviceAuthorization>
<behaviour>

<services>
  <service name="Kestrel.MIS3.Server.Services.UserService" behaviorConfiguration="Secure">
    <endpoint address=""
              binding="wsHttpBinding"
              bindingConfiguration="wsSecure"
              contract="Kestrel.MIS3.Server.Services.IUserService" />
    <endpoint address="mex"
              binding="mexHttpsBinding"
              contract="IMetadataExchange" />
  </service>
</services>

<wsHttpBinding>
    <binding name="wsSecure">
      <reliableSession enabled="true"/>
      <security mode="TransportWithMessageCredential">
        <message clientCredentialType="UserName" />
      </security>
    </binding>
  </wsHttpBinding> 
```

我希望能够使用会话，以便在创建服务实例时我不需要每次都查找用户详细信息。这可能吗？

我用以下内容标记了服务，但没有运气：

```
[ServiceContract(SessionMode = SessionMode.Required)]    
public interface IUserService

[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession)]
public class UserService : ServiceBase, IUserService 
```

# java - im4java 将 svg 转换为 png，保持透明背景

> ID：11937286
> 
> 赞同：1
> 
> 时间：2012-08-13T15:18:15.600
> 
> 标签：java, imagemagick, im4java

我正在使用 im4java 库将 svg 文件转换为 png 文件。我希望透明背景保持透明，但它们总是变成白色。这是我正在使用的操作：

```
IMOperation hdpiOperation = new IMOperation();
hdpiOperation.addImage();
hdpiOperation.background("none");
hdpiOperation.addImage(); 
```

如果我使用此命令从命令行手动尝试使用 ImageMagick，它确实有效：

```
convert -background none a.svg b.png 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:26:14.923

由于*im4java*按方法执行顺序附加参数，因此您可以`hdpiOperation.background("none")`在图像占位符之前移动调用以模仿工作“原始”命令：

```
hdpiOperation.background("none");
hdpiOperation.addImage();
hdpiOperation.addImage(); 
```

# linux-kernel - 已安装触摸屏和驱动程序但 tslib 无法校准

> ID：11937287
> 
> 赞同：3
> 
> 时间：2012-08-13T15:18:19.333
> 
> 标签：linux-kernel, linux-device-driver, embedded-linux, touchscreen

[我已经从 github ( https://github.com/kergoth/tslib/commits/master](https://github.com/kergoth/tslib/commits/master) )交叉编译了 tslib 的最新提交。我的触摸屏连接到我的嵌入式板，我启用了供应商的驱动程序。当我启动并查看“cat /dev/input/touchscreen”的输出时，我可以看到在屏幕上移动手指会产生大量输出。内核还向控制台输出格式良好的“finger1”和“finger2”消息。

但是我无法校准。当我设置如下所示的环境变量并运行 ts_calibrate 时，它​​会输出消息“xres = 640, yres = 480 tslib: Selected device is not a touchscreen (must support ABS and KEY event types)”并且什么也不做。 .

所以 Linux 知道我的设备存在并且我可以看到滚动输出，但是 tslib 无法校准。我做错了什么，我该如何解决？

```
# ls -rlt /dev/input/touchscreen
lrwxrwxrwx    1 root     root             6 Jan 17 21:06 /dev/input/touchscreen -> event1
# chmod 777 /dev/input/touchscreen
# chmod 777 /dev/input/event1

# cat /dev/input/touchscreen  | hexdump
0000000 9011 3883 565f 0001 0003 0030 0001 0000
0000010 9011 3883 565f 0001 0003 0032 0001 0000
0000020 9011 3883 565f 0001 0003 0035 04c9 0000
0000030 9011 3883 565f 0001 0003 0036 0c3f 0000
0000040 9011 3883 565f 0001 0000 0002 0000 0000
0000050 9011 3883 565f 0001 0000 0000 0000 0000
0000060 9011 3883 90a9 0001 0003 0030 0001 0000
0000070 9011 3883 90a9 0001 0003 0032 0001 0000

# cat /sys/devices/virtual/input/input1/uevent
PRODUCT=0/0/0/0
NAME="aura-touchscreen"
PROP=0
EV=9
ABS=650000 0
MODALIAS=input:b0000v0000p0000e0000-e0,3,kra30,32,35,36,mlsfw

# cat /etc/ts.conf
# Uncomment if you wish to use the linux input layer event interface
module_raw input
module pthres pmin=1
module variance delta=30
module dejitter delta=100
module linear

export TSLIB_TSEVENTTYPE=INPUT
export TSLIB_TSDEVICE=/dev/input/touchscreen
export TSLIB_CALIBFILE=/etc/pointercal
export TSLIB_CONFFILE=/etc/ts.conf
export TSLIB_PLUGINDIR=/usr/lib/ts
export TSLIB_FBDEVICE=/dev/fb0
export TSLIB_CONSOLEDEVICE=none
export TSTS_INFO_FILE=/sys/devices/virtual/input/input1/uevent
export QWS_MOUSE_PROTO=tslib:/dev/input/touchscreen
export PATH=$PATH:/usr/bin
ts_calibrate
xres = 640, yres = 480
tslib: Selected device is not a touchscreen (must support ABS and KEY event types) 
```

有趣的是，如果我执行“cat /proc/bus/input/devices”，那么我可以看到我的触摸屏，但只有一个 ABS 条目（没有 KEY），并且 tslib 说我需要两者。我可以在这里分配一个“KEY”条目吗？

```
# cat /proc/bus/input/devices
I: Bus=0019 Vendor=0001 Product=0001 Version=0003
N: Name="TWL4030 Keypad"
P: Phys=twl4030_keypad/input0
S: Sysfs=/devices/platform/omap/omap_i2c.1/i2c-1/1-004a/twl4030_keypad/input/input0
U: Uniq=
H: Handlers=kbd event0
B: PROP=0
B: EV=100013
B: KEY=ffc
B: MSC=10

I: Bus=0000 Vendor=0000 Product=0000 Version=0000
N: Name="aura-touchscreen"
P: Phys=
S: Sysfs=/devices/virtual/input/input1
U: Uniq=
H: Handlers=event1
B: PROP=0
B: EV=9
B: ABS=650000 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:41:57.360

尝试添加

```
input_dev = input_allocate_device();
[..]
set_bit(EV_ABS, input_dev->evbit);
set_bit(EV_KEY, input_dev->evbit); 
```

因此 tslib 将设备视为同时支持 EV_ABS 和 EV_KEY 事件（即使它实际上并没有发送这两个事件）。

如果您有更多问题，您知道如何联系我... ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T14:19:08.067

我有同样的问题

```
tslib: Selected device is not a touchscreen (must support ABS and KEY event types) 
```

我添加了

```
set_bit(EV_SYN, aura.input_dev->evbit);
set_bit(EV_ABS, aura.input_dev->evbit);
set_bit(EV_KEY, aura.input_dev->evbit);
# I had to add this line so that tslib was happy 
```

在我的触摸屏驱动程序中，但仍然有同样的问题。我无法校准触摸屏。请给建议。

```
 static int goodix_ts_probe(struct i2c_client *client, const struct i2c_device_id *id)
{
    s32 ret = -1;
    struct goodix_ts_data *ts;
    u16 version_info;

    GTP_DEBUG_FUNC();
    set_bit(EV_SYN, aura.input_dev->evbit);
set_bit(EV_ABS, aura.input_dev->evbit);
set_bit(EV_KEY, aura.input_dev->evbit); # I had to add this line so that tslib was happy
    //do NOT remove these output log
    GTP_INFO("GTP Driver Version:%s",GTP_DRIVER_VERSION);
    GTP_INFO("GTP Driver build@%s,%s", __TIME__,__DATE__);
    GTP_INFO("GTP I2C Address:0x%02x", client->addr);

    i2c_connect_client = client;
    if (!i2c_check_functionality(client->adapter, I2C_FUNC_I2C)) 
    {
        GTP_ERROR("I2C check functionality failed.");
        return -ENODEV;
    }
    ts = kzalloc(sizeof(*ts), GFP_KERNEL);
    if (ts == NULL)
    {
        GTP_ERROR("Alloc GFP_KERNEL memory failed.");
        return -ENOMEM;
    }

    memset(ts, 0, sizeof(*ts));
    INIT_WORK(&ts->work, goodix_ts_work_func);
    ts->client = client;
    i2c_set_clientdata(client, ts);
    ts->irq_lock = SPIN_LOCK_UNLOCKED;
    ts->gtp_rawdiff_mode = 0;

    ret = gtp_request_io_port(ts);
    if (ret < 0)
    {
        GTP_ERROR("GTP request IO port failed.");
        kfree(ts);
        return ret;
    }

    ret = gtp_i2c_test(client);
    if (ret < 0)
    {
        GTP_ERROR("I2C communication ERROR!");
    }

#if GTP_AUTO_UPDATE
    //ret = gup_init_update_proc(ts);
    //if (ret < 0)
    //{
        //GTP_ERROR("Create update thread error.");
    //}
#endif

    ret = gtp_init_panel(ts);
    if (ret < 0)
    {
        GTP_ERROR("GTP init panel failed.");
    }

    ret = gtp_request_input_dev(ts);
    if (ret < 0)
    {
        GTP_ERROR("GTP request input dev failed");
    }

    ret = gtp_request_irq(ts); 
    if (ret < 0)
    {
        GTP_INFO("GTP works in polling mode.");
    }
    else
    {
        GTP_INFO("GTP works in interrupt mode.");
    }

    ret = gtp_read_version(client, &version_info);
    if (ret < 0)
    {
        GTP_ERROR("Read version failed.");
    }
    spin_lock_init(&ts->irq_lock);
    ts->irq_lock = SPIN_LOCK_UNLOCKED;

    gtp_irq_enable(ts);

#if GTP_CREATE_WR_NODE
    //init_wr_node(client);
#endif

#if GTP_ESD_PROTECT
    INIT_DELAYED_WORK(&gtp_esd_check_work, gtp_esd_check_func);
    gtp_esd_check_workqueue = create_workqueue("gtp_esd_check");
    queue_delayed_work(gtp_esd_check_workqueue, &gtp_esd_check_work, GTP_ESD_CHECK_CIRCLE); 
#endif

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-20T11:39:36.943

这基本上是旧版本 tslib 中的错误。最新版本应该可以正常工作。

# algorithm - Rtrees - 算法基础

> ID：11937289
> 
> 赞同：6
> 
> 时间：2012-08-13T15:18:38.497
> 
> 标签：algorithm, r-tree

我试图了解 RTree 算法的基础知识，并试图弄清楚它如何执行搜索，例如 1 公里内的所有 retaurants。我们会将所有对象存储在数据库中的矩形中，然后（可能）根据当前位置构建一个查询矩形，然后找到与其重叠的所有矩形。然后我们是否会扫描结果以找到感兴趣的对象，即只有餐厅的对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T20:02:16.230

是的，这基本上就是R 树上的*范围*查询的工作方式：如果一个矩形与您的查询区域重叠，则展开它（查看内容、矩形或点）。否则，忽略它。对于矩形到矩形的重叠测试很简单，对于球形查询，您需要计算球体中心到矩形的最小距离（“minDist”）。

k 最近邻查询有点棘手；在这里你需要优先队列。始终扩展最佳候选对象（通过“minDist”），直到找到比下一个矩形“minDist”更近的 k 个对象。

由于您无法真正索引“是餐厅”属性，因此您必须构建仅包含餐厅的 r-tree，或者按餐厅属性过滤结果。（这也是在 SQLite 中完成的方式；空间部分使用 R-tree 进行索引，而餐厅属性例如通过连接或位图索引获得）

R-tree 的棘手部分*不是*查询，而是如何构建它。批量加载点数据 (STR) 有非常简单但很好的方法，但对于在线数据库，您需要一些棘手的方法。根据我的经验，R*-trees 明显优于经典 R-trees；R*-trees 使用的重新插入在真正的 DBMS 中实现特别棘手。一个有趣的权衡是只使用 R* 的插入和拆分，而不是重新插入。在查询方面，无论如何 R 和 R* 之间没有区别。

kd-trees：它们与 r-trees 相关，但有一些关键区别：首先，它们不是为*磁盘*存储而设计的，而是仅用于内存中的操作。其次，它们并不意味着要更新（它们不是平衡树），但是如果您有更改，则必须不时重新构建它们以保持良好的性能。所以在某些情况下，它们会表现得非常好（而且它们实现起来相当简单），但是一旦你获得大数据和磁盘，它们就会更加痛苦。此外，它们不允许不同的加载策略。

# php - 在 PHP 中使用 $_GET id 过滤 mysql_fetch_array

> ID：11937290
> 
> 赞同：0
> 
> 时间：2012-08-13T15:18:38.590
> 
> 标签：php

所以我有一个查询，我将所有项目返回到 mysql_fetch_array 中。现在，我知道我可以编写另一个查询，然后将我需要的项目选择到一个单独的查询中，但是，有没有办法从更大的查询中过滤出我想要依赖于 $_GET 的内容？

因此，在英语中，用户来自具有 ?id=1 的超链接，我执行了一段时间来获取所有值，但仅在列表中显示 $_GET['id'] 项目

```
<?php //give ma all values but only echo out list of the $_GET['id'] in the url
  while ($row = mysql_fetch_array($result) {
    $id = $rowvideo["id"];
    $title = $rowvideo["title"];
    $length = $rowvideo["length"];
}
echo("<li><a href='#'>". $title." " .$length. "</a></li>");
?> 
```

希望这是有道理的。谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:24:29.197

如果您不希望第二个查询得到*您所需要*的，那么您的循环中的 simple-`if-statement`应该可以工作：

```
<?php
$getId = isset($_GET['id']) ? $_GET['id'] : false;
//give ma all values but only echo out list of the $_GET['id'] in the url
while ($row = mysql_fetch_array($result)) {
    $id = $row["id"];
    $title = $row["title"];
    $length = $row["length"];

    if ($id == $getId) {
        echo("<li><a href='#'>". $title." " .$length. "</a></li>");
    }
}
?> 
```

请注意，我`$getId`在循环之外声明以防止`isset()`在每次迭代期间都必须使用。如果您不验证它是否已设置并尝试使用它，它将引发`undefined index`警告 - 假设您已`error_reporting`打开（启用该级别）。

[`array_filter()`](http://php.net/array_filter)或者，您可以在解析完所有数据后对数据使用 PHP ：

```
$results = array();
while ($row = mysql_fetch_array($result)) $results[] = $row;
if (isset($_GET['id'])) {
    $filtered = array_filter($results, function($element) use ($_GET['id']) { return ($element['id'] == $_GET['id']); });
    $results = $filtered;
}
foreach ($results as $result) {
    echo("<li><a href='#'>". $result['title']." " .$result['length']. "</a></li>");
} 
```

我个人的意见是提高效率并编写第二个查询，当然假设您在指定 an 时实际上并不需要所有结果`id`。这很简单：

```
if (isset($_GET['id']) && is_numeric($_GET['id'])) {
    $query = 'SELECT id, title, length FROM table WHERE id=' . (int)$_GET['id'];
} else {
    $query = 'SELECT id, title, length FROM table';
}
// your existing code as-is 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:24:07.313

```
<?php //give ma all values but only echo out list of the $_GET['id'] in the url
  while ($row = mysql_fetch_array($result)) {
    $id = $rowvideo["id"];
    $title = $rowvideo["title"];
    $length = $rowvideo["length"];
    if ($id == $_GET['id']) { // or even ===
      echo("<li><a href='#'>". $title." " .$length. "</a></li>");
    }
  }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:38:17.047

这里更清楚一点：

这将允许通过指定 id=xxx 在 url 中按 id 进行过滤，如果 xxx 是一个正整数。所以'bob'或-1的id不会过滤结果仍然给出所有结果

```
$filter=false;
if(isset($_GET['id']))
{
    $filter_id=intval($_GET['id']);
    if($id>0) $filter=true;
}

while($row = mysql_fetch_array($result))
{
    if( (!$filter) || ( ($filter) && ($filter_id==$row['id']) ) )
    {
        $id = $row["id"];
        $title = $row["title"];
        $length = $row["length"];

        // do other stuff here
    }
} 
```

我还将 $rowvideo 更改为 $row，因为这是您用来获取结果的数组。

# java - 如何正确使用 concurrentskiplistmap？

> ID：11937297
> 
> 赞同：2
> 
> 时间：2012-08-13T15:19:20.690
> 
> 标签：java, concurrency, java.util.concurrent, concurrentskiplistmap

尝试使用并发跳过列表映射。我在[如何正确使用同步链接哈希映射](https://stackoverflow.com/questions/11792202/how-to-use-a-synchronized-linked-hash-map-correctly)方面遇到问题，所以我决定尝试并发跳过列表映射。

我有同样的问题。下面的单元测试失败，因为当我获取条目集时，当 size() 指示地图不为空时，它具有空值。naict，我可以访问同步的地图。

我认为不需要这样做（同步），因为这是一个并发地图。

服务器只是将数字 0,1,2,3, ... 放入地图中，使其大小保持在阈值以下。它尝试在服务器启动后的每一毫秒内输入一个数字。

任何指针将不胜感激。

谢谢

```
import static org.junit.Assert.*;
import java.util.*;
import java.util.Map.Entry;
import java.util.concurrent.ConcurrentSkipListMap;
import org.junit.*;
class DummyServer implements Runnable {
    DummyServer(int pieces) {
        t0=System.currentTimeMillis();
        this.pieces=pieces;
        max=pieces;
        lruMap=new ConcurrentSkipListMap<Long,Long>();
    }
    Set<Map.Entry<Long,Long>> entrySet() {
        Set<Entry<Long,Long>> entries=null;
        synchronized(lruMap) {
            entries=Collections.unmodifiableSet(lruMap.entrySet());
        }
        return entries;
    }
    Set<Long> keySet() {
        Set<Long> entries=null;
        synchronized(lruMap) {
            entries=Collections.unmodifiableSet(lruMap.keySet());
        }
        return entries;
    }
    @Override public void run() {
        int n=0;
        while(piece<stopAtPiece) {
            long target=piece(System.currentTimeMillis()-t0);
            long n0=piece;
            for(;piece<target;piece++,n++)
                put(piece);
            if(n>max+max/10) {
                Long[] keys=keySet().toArray(new Long[0]);
                synchronized(lruMap) {
                    for(int i=0;n>max;i++,n--)
                        lruMap.remove(keys[i]);
                }
            }
            try {
                Thread.sleep(10);
            } catch(InterruptedException e) {
                e.printStackTrace();
                break;
            }
        }
    }
    private void put(long piece) {
        synchronized(lruMap) {
            lruMap.put(piece,piece);
        }
    }
    public long piece() {
        return piece;
    }
    public Long get(long piece) {
        synchronized(lruMap) {
            return lruMap.get(piece);
        }
    }
    public int size() {
        synchronized(lruMap) {
            return lruMap.size();
        }
    }
    public long piece(long dt) {
        return dt/period*pieces+dt%period*pieces/period;
    }
    private long piece;
    int period=2000;
    private volatile Map<Long,Long> lruMap;
    public final long t0;
    protected final int pieces;
    public final int max;
    public long stopAtPiece=Long.MAX_VALUE;
}
public class DummyServerTestCase {
    void checkMap(Long n) {
        if(server.size()>0) {
            final Set<Map.Entry<Long,Long>> mapValues=server.entrySet();
            @SuppressWarnings("unchecked") final Map.Entry<Long,Long>[] entries=new Map.Entry[mapValues.size()];
            mapValues.toArray(entries);
            try {
                if(entries[0]==null)
                    System.out.println(server.piece());
                assertNotNull(entries[0]);
            } catch(Exception e) {
                fail(e.toString());
            }
        }
    }
    @Test public void testRunForFirstIsNotZero() {
        server.stopAtPiece=1*server.pieces;
        Thread thread=new Thread(server);
        thread.start();
        while(thread.isAlive()) {
            for(long i=0;i<server.piece();i++) {
                server.get(i);
                Thread.yield();
                checkMap(server.piece());
                Thread.yield();
            }
        }
    }
    DummyServer server=new DummyServer(1000);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:32:29.753

问题是你正在执行

```
final Map.Entry<Long,Long>[] entries=new Map.Entry[mapValues.size()]; // size>0
mapValues.toArray(entries); // size is 0. 
```

在创建数组和调用 toArray 之间，您正在清除地图。

如果您使用迭代器获取副本，您将不会获得此竞争条件。

```
void checkMap(Long n) {
    final Set<Map.Entry<Long, Long>> mapValues = server.entrySet();
    Set<Map.Entry<Long, Long>> entries = new LinkedHashSet<>(mapValues);

    for (Entry<Long, Long> entry : entries) {
        assertNotNull(entry);
    }
} 
```

或者

```
void checkMap(Long n) {
    for (Entry<Long, Long> entry : server.entrySet())
        assertNotNull(entry);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:33:47.543

`synchronize`首先，除非您必须执行一些复合操作，否则您永远不必使用线程安全的集合实现。它`ConcurrentMap`为您提供了良好的原子复合功能，因此即使那样您也不必这样做。

第二。在执行并发操作时，您永远不应该依赖该`size`方法是正确的。javadoc 注释：

> 请注意，与大多数集合不同，size 方法不是恒定时间操作。由于这些映射的异步特性，确定当前元素的数量需要遍历元素。

从开始调用到获得返回时，大小可能不同。

简而言之，您的测试不是有效的并发测试。你能详细说明你想要达到的目标吗？

# flash - Flash Builder 代码完成在针对不同的播放器 API 时不起作用

> ID：11937300
> 
> 赞同：4
> 
> 时间：2012-08-13T15:19:31.197
> 
> 标签：flash, apache-flex, flash-builder

我正在使用 FlashBuilder 4.6 构建针对不同 Flash Player 的应用程序。我主要使用 4.5.1 SDK，因为我希望使用旧版 Flash Player 的用户能够使用我的应用程序，同时受益于 Spark 框架。SDK 4.6 需要 FP 11.2，因此会淘汰太多用户。

这意味着我可以针对 10.2 及更高版本的 Flash Player。我的应用程序使用音频和视频，因此我希望拥有较新 Flash Player 的用户能够从较新的功能中受益。例如，10.3 支持回声消除。因此，如果我的 HTML 包装器检测到 10.3 或更高版本，则会加载带有 AEC 的版本。

为了能够针对 FP 10.3 的新 API，我必须下载 10.3 的 playerglobal.swc 并将其放在我的 SDK 的 libs 目录中。并将编译器选项“使用特定版本”设置为 10.3.0，我添加了编译器指令 -swf-version=12。这工作正常，应用程序编译并且功能工作。

但是，Flash Builder 中的语法高亮和代码完成似乎仍然不知道 10.3 中的新类和方法，例如 Microphone.getEnhancedMicrophone()。所以，代码完成模块似乎没有使用 playerglobal.swc 来获取它的信息。

我的问题是：我怎样才能告诉 FlashBuilder 的代码完成关于较新的播放器 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T01:03:01.800

几周前发布的 Apache Flex 4.9.0 将允许您以 Flash Player 10.2 及更高版本为目标。

在 README 中查找有关如何为其他任何版本的 Flash Player 编译的说明（默认为 11.1）。在开发分支（在 SVN 中）的 ide 目录中也有一些脚本，可以使设置最低 Flash Player 版本更容易一些。

Apache Flex 4.9.0 可以从以下网址下载：http: [//flex.apache.org/](http://flex.apache.org/)

但我建议您使用安装程序下载并创建 SDK。可以在这里找到：http: [//flex.apache.org/installer.html](http://flex.apache.org/installer.html)

代码完成应该可以工作，并且基于 flex-config.xml 中包含的内容（在 SDK 的 frameworks 目录中）。检查这两行是否正确。

```
<!-- Specifies the minimum player version that will run the compiled SWF. -->
<target-player>11.1<target-player>

<!-- Specifies the version of the compiled SWF -->
<swf-version>14<swf-version> 
```

即在您的情况下设置为 10.3 和 12。

# java - Java ZipInputStream 异常在代码执行之前抛出

> ID：11937309
> 
> 赞同：1
> 
> 时间：2012-08-13T15:19:47.627
> 
> 标签：java, exception-handling

我有 Java 代码，它传入一个 Zip 文件列表，其中一个是故意格式错误的。此 Zip 文件位于列表的末尾。

我的代码看起来有点像：

```
System.out.println("Hi Stinky Pete ");
try
{
    for (File files : file)
    {
       zip_str = new ZipInputStream(new BufferedInputStream(new FileInputStream(file)));
       yada;
    }
}
catch(Exception)
{
} 
```

它从不打印“Hi Stinky Pete”或处理任何文件，然后才到达坏的 zip 文件，这是列表中的第 4 或第 20 个文件，它只是抛出 ZipException。另外，我无法捕捉到 ZipException！它总是冒泡并终止我的程序。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:27:09.677

我很抱歉，但我继承了代码。我继承的代码通过文件列表执行循环，将它们投射到`ZipFile`单独的运行线程中。这就是为什么我无法抓住它或获取 StackTrace。基本上是这样，

```
for( File files : file)
{
    ZipFile zip = new ZipFile(file);
} 
```

他们这样做是为了检查他们的 Zip 文件，但没有抓到。对不起这个帖子！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:59:10.473

这个格式错误的 ZIPfile 在你的类路径上是否有任何机会？或者你的类中有一个静态初始化器试图打开它？

仔细查看异常*堆栈跟踪*以了解它被抛出的位置。如果您无法解释它，*请在您的问题中发布堆栈跟踪*。

# service - 将来自网络服务器的打印队列列为模拟用户时出错

> ID：11937311
> 
> 赞同：1
> 
> 时间：2012-08-13T15:19:48.157
> 
> 标签：service, printing, impersonation

我一直在尝试设置一个简单的端点服务，它位于服务器上，接受 Web 请求，然后以用户身份将作业打印到特定服务器上的特定打印队列，其凭据被传递到服务中。这是用于自动化测试，因此我们使用的用户具有有限的权限，因此安全性不是问题。

当我在没有模拟的情况下尝试此代码时：

```
PrintServer ps = new PrintServer(@"\\" + serverName, PrintSystemDesiredAccess.EnumerateServer);
            response = "Created PrintServer object";
            foreach (PrintQueue pq in ps.GetPrintQueues())
            {
                response = response + "~@~" + pq.Name;
            } 
```

它工作正常，并为我提供了远程服务器上的打印机列表，例如：
Created PrintServer object~@~Sc-4 Pull Port~@~Microsoft XPS Document Writer

当我尝试模拟时，我得到了这个：
System.Printing.PrintServerException：创建 PrintServer 对象时发生异常。Win32 错误：打印机名称无效。
在 System.Printing.PrintServer.Initialize（字符串路径，字符串 [] propertiesFilter，PrinterDefaults 打印机默认值）
在 System.Printing.PrintServer..ctor（字符串路径，PrintSystemDesiredAccess desiredAccess）
在 PrintService.PrintService.ImpersonatedInstalledPrinterList（字符串服务器名，字符串用户名，字符串用户密码，字符串域）

我一直无法弄清楚或在网上找到它为什么会抛出上述错误。我正在使用一个有效的域帐户，甚至给了我用来测试服务器上打印队列的完全权限的用户。当我尝试以模拟用户身份打印时遇到同样的错误，当我不执行模拟时发送打印作业没有问题。

谢谢你尽你所能的帮助，

月

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T12:39:02.273

我发现我正在使用的代码存在问题，问题是我在使用模拟时正在使用，当我需要使用委托时，我正在使用模拟的 SECURITY_IMPERSONATION_LEVEL。一旦我改变错误就消失了。

# delphi - WinInet+SSL：无法进行简短的 SSL 握手

> ID：11937312
> 
> 赞同：0
> 
> 时间：2012-08-13T15:19:50.973
> 
> 标签：delphi, ssl, ssl-certificate, sessionid, wininet

我的 ActiveX 组件使用 WinInet.dll 并使用 SSL 证书颁发机构与服务器建立 SSL 连接。

如果它不在 IE 进程中，它总是与服务器进行完整的 SSL 握手。而且我找不到任何方法来重用 Client Hello 中的 SessionID 标头来进行简短的 SSL 握手。

否则，如果我的 ActiveX 托管在 IE 进程中，那么 SessionID 标头的重用会自动工作。

看起来 IE 对我的连接应用了其他设置。有人知道这些附加设置吗？任何人都可以建议我一些技巧来解决这个问题吗？

PS这是Delphi项目，所以我不能使用WCF，也不能移动到OpenSSL。

* * *

我想我应该在这里澄清一下：

1.  我的 ActiveX 在这两种情况下（在 IE 进程上下文和非 IE 进程上下文中）肯定都使用 WinInet.dll。

2.  WinInet.dll 自己进行 SSL/TLS 握手。我无法访问 WinInet 级别的 SessionID 标头，但 IE 可以。

3.  如果我的 ActiveX 托管在 IE 进程中，IE 知道如何设置 WinInet 以使用以前的 SessionID。WinInet 会进行缩写 SSL/TLS 握手。

4.  如果我在非 IE 进程中使用 WinInet.dll，那么 WinInet 没有使用 SessionID 来表示 Client Hello。WinInet 进行完整的 SSL/TLS 握手。

5.  所以我们这里有两种 SSL/TLS 握手场景：full 表示非 IE 进程，缩写表示 IE 进程。[在 MSDN 博客http://blogs.msdn.com/b/huizhu/archive/2009/12/17/ssl-_2f00_tls-full-handshake-vs.-abbreviated-handshake.aspx](http://blogs.msdn.com/b/huizhu/archive/2009/12/17/ssl-_2f00_tls-full-handshake-vs.-abbreviated-handshake.aspx)中查看有关这些场景的更多信息

希望现在更清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:46:51.087

Internet Explorer 使用 WinInet 进行自己的连接。假设您的 ActiveX 是一个进程内对象，当它托管在 IE 内部时，WinInet 只是在同一进程中与其自身共享信息。当您的 ActiveX 托管在本身不使用 WinInet 的非 IE 进程中时，您不会明白这一点。

# mysql - Database design for a sell/rent eCommerce

> ID：11937332
> 
> 赞同：5
> 
> 时间：2012-08-13T15:21:00.757
> 
> 标签：mysql, database, e-commerce

I am working on my school project to create an eCommerce website that sell and rent product.

My main problem is that I can't find the best design for the "Renting" part. For now I am thinking about two designs:

The first database design suggestion: ![The first database design suggestion](../Images/bd3342b5f7ee4e273eede4ef741860e8.png)

* * *

The second database design suggestion: ![The second database design suggestion](../Images/caecc2bacd880061059baeeab2f1d7b0.png)

As you can see there are the same tables in both designs but with different relations, but I can't tell which one is better.

I will be happy if you can tell me which design is better or if there is a better way to design my database altogether.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T13:01:20.297

Think of your problem from the real-life perspective:

1.  You will be offering “something”, being `products` in your schema;
2.  You will be working with “somebody” or `customers` in your schema.

These 2 tables are most important, as without them the whole thing has no meaning.

Next, in real life, you have to have papers for each deal you'll make in order to:

1.  Report to authorities and pay taxes (don't you like to pay taxes?);
2.  Keep track of products that are “on hands” of your customers.

These are `orders` of 2 types: purchase and rent.

Note, though, that it is unlikelly to rent a set of products with different return dates in one order. Typically, one will rent a set of related items for some special case, like wedding celebration or bathroom repair. In case you need some products for 2 days while others for 2 weeks, it is better to create 2 orders, as different delivery conditions or discounts may apply.

Therefore I think that initial **variant #1** matches your goal better with the following updates:

1.  `order_type` column should be added to the `orders` table;
2.  `rent_details` should relate to `orders` table;
3.  `rent_details` should have only `order_id` in place of `rent_detail_id` + `order_items_id`;
4.  it very necessary to have a separate `price` column in the `order_items` table along with `discount`;

# scala - 从 Play 2 Scala 控制器提供静态 /public/ 文件

> ID：11937335
> 
> 赞同：4
> 
> 时间：2012-08-13T15:21:11.040
> 
> 标签：scala, playframework-2.0

[从Play Framework 2](http://playframework.org) Scala 控制器提供静态文件的首选方法是什么？

该文件与我的应用程序捆绑在一起，因此无法对文件系统 absolute 进行硬编码`/path/to/the/file`，因为它的位置取决于 Play 应用程序的安装位置。

该文件放在 public/ 目录中，但不在 app/assets/ 中，因为我不想让 Play 编译它。

（我不简单地向该文件添加路由的原因是，在访问该文件之前需要登录，否则它没有用。）

这是我到目前为止所做的，但这在我的生产服务器上中断了。

```
object Application ...

  def viewAdminPage = Action ... {
    ... authorization ...
    val adminPageFile = Play.getFile("/public/admin/index.html")
    Ok.sendFile(adminPageFile, inline = true)
  } 
```

在我的`routes`文件中，我有这一行：

`GET /-/admin/ controllers.Application.viewAdminPage`

问题是在我的生产服务器上，发生了这个错误：
`FileNotFoundException: app1/public/admin/index.html`

是否有其他方法而不是`Play.getFile`and`OK.sendFile`来指定要提供的文件？那在生产中永远不会中断？

（我的应用程序安装在`/some-dir/app1/`，我从`/some-dir/`（没有`app1/`）启动它 - 如果我改为从 启动应用程序，也许一切都会工作`/some-dir/app1/`。但我想知道一个“应该”如何从控制器内部提供静态文件？所以无论我碰巧从哪里启动应用程序，一切都在生产服务器上也能正常工作）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:54:36.943

检查[流式 HTTP 响应](http://www.playframework.org/documentation/2.0.2/ScalaStream)文档

```
def index = Action {
  Ok.sendFile(
    content = new java.io.File("/tmp/fileToServe.pdf"),
    fileName = _ => "termsOfService.pdf"
  )
} 
```

您可以向`fileName`（每个登录用户的个人）添加一些随机字符串，以避免在经过身份验证的用户和未经过身份验证的用户之间共享下载链接，并进行高级下载统计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T06:00:38.003

我这样做了：（但请参阅下面的*更新*！）

```
val fileUrl: java.net.URL = this.getClass().getResource("/public/admin/file.html")
val file = new java.io.File(adminPageUrl.toURI())
Ok.sendFile(file, inline = true) 
```

（`this`是控制器，它（并且必须）位于与所服务的文件相同的包中。）

这是一个相关的问题：[open resource with relative path in java](https://stackoverflow.com/questions/573679/open-resource-with-relative-path-in-java)

## 更新

通过 URI 访问文件会导致错误：`IllegalArgumentException: URI is not hierarchical`，如果文件位于 JAR 中，如果您像这样运行 Play 就是这种情况：`play stage`然后`target/start`.

因此，我将文件作为流读取，将其转换为字符串，然后将该字符串作为 HTML 发送：

```
val adminPageFileString: String = {
  // In prod builds, the file is embedded in a JAR, and accessing it via
  // an URI causes an IllegalArgumentException: "URI is not hierarchical".
  // So use a stream instead.
  val adminPageStream: java.io.InputStream =
    this.getClass().getResourceAsStream("/public/admin/index.html")
  io.Source.fromInputStream(adminPageStream).mkString("")
}

...

return Ok(adminPageFileString) as HTML 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-10T13:18:56.127

Play 有一个内置的方法：

```
 Ok.sendResource("public/admin/file.html", classLoader) 
```

`Environment`您可以从注入的 with`environment.classLoader`或 from获取类加载器`this.getClass.getClassLoader`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-18T12:34:50.490

手动方法如下：

```
val url = Play.resource(file)
url.map { url =>
  val stream = url.openStream()
  val length = stream.available 
  val resourceData = Enumerator.fromStream(stream)

  val headers = Map(
        CONTENT_LENGTH -> length.toString,
        CONTENT_TYPE -> MimeTypes.forFileName(file).getOrElse(BINARY),
        CONTENT_DISPOSITION -> s"""attachment; filename="$name"""")

  SimpleResult(
    header = ResponseHeader(OK, headers), 
    body = resourceData) 
```

使用资产控制器的等价物是这样的：

```
val name = "someName.ext"

val response = Assets.at("/public", name)(request)
response
  .withHeaders(CONTENT_DISPOSITION -> s"""attachment; filename="$name"""") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-07T06:05:15.397

另一种变体，不使用字符串，而是通过流式传输文件内容：

```
def myStaticRessource() = Action { implicit request =>

  val contentStream = this.getClass.getResourceAsStream("/public/content.html")

  Ok.chunked(Enumerator.fromStream(contentStream)).as(HTML)

} 
```

# java - 比较对象的映射

> ID：11937336
> 
> 赞同：0
> 
> 时间：2012-08-13T15:21:15.543
> 
> 标签：java, collections, map

我已经设置了一个测试：

*   检索有关多个法庭案件的数据：每个法庭案件都存储在一个 CourtCase 对象中
*   然后将一组 CourtCase 对象存储在 Map
*   我两次检索这些数据（来自两个不同的来源）所以我最终得到了两个地图

对象内的数据在 Map 之间应该相同，但 Map 内对象的顺序可能不一样：

地图1：A，案例1 - B，案例2 - C，案例3

地图2：B，案例2 - A，案例1 - C，案例3

我怎样才能最好地比较这两个地图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:26:30.990

`Map#equals`不关心订单。只要您的 2 个地图包含相同的映射，它就会返回 true。

`Map#equals`使用`Set#equals`方法，应用于条目集。[`Set#equals`合同](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html#equals%28java.lang.Object%29)：

> 如果指定对象也是一个集合，则返回 true，这两个集合具有相同的大小，并且指定集合的​​每个成员都包含在此集合中（或等效地，此集合的每个成员都包含在指定集合中）。

注意：这假设您的`CourtCase`对象具有要比较的适当`equals`和方法。`hashcode`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:25:24.797

Map 实现提供了一个 equals 方法来解决问题。[Map.equals](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Map.html#equals%28java.lang.Object%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T12:45:46.470

@user973718 在java中比较两个映射对象的最佳方法是-您可以将映射的键添加到列表中，并且使用这两个列表，您可以使用方法retainAll() 和removeAll() 并将它们添加到另一个公共键列表和不同的键列表。使用公共列表和不同列表的键可以遍历映射，使用等于可以比较映射。

下面的代码给出了这个输出： Before {b=2, c=3, a=1} After {c=333, a=1} Unequal: Before- 3 After- 333 Equal: Before- 1 After- 1 仅存在值在地图之前：2

 `````
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import org.apache.commons.collections.CollectionUtils;

public class Demo 
{
    public static void main(String[] args) 
    {
        Map<String, String> beforeMap = new HashMap<String, String>();
        beforeMap.put("a", "1");
        beforeMap.put("b", "2");
        beforeMap.put("c", "3");

        Map<String, String> afterMap = new HashMap<String, String>();
        afterMap.put("a", "1");
        afterMap.put("c", "333");

        System.out.println("Before "+beforeMap);
        System.out.println("After "+afterMap);

        List<String> beforeList = getAllKeys(beforeMap);

        List<String> afterList = getAllKeys(afterMap);

        List<String> commonList1 = beforeList;
        List<String> commonList2 = afterList;
        List<String> diffList1 = getAllKeys(beforeMap);
        List<String> diffList2 = getAllKeys(afterMap);

        commonList1.retainAll(afterList);
        commonList2.retainAll(beforeList);

        diffList1.removeAll(commonList1);
        diffList2.removeAll(commonList2);

        if(commonList1!=null & commonList2!=null) // athough both the size are same
        {
            for (int i = 0; i < commonList1.size(); i++) 
            {
                if ((beforeMap.get(commonList1.get(i))).equals(afterMap.get(commonList1.get(i)))) 
                {
                    System.out.println("Equal: Before- "+ beforeMap.get(commonList1.get(i))+" After- "+afterMap.get(commonList1.get(i)));
                }
                else
                {
                    System.out.println("Unequal: Before- "+ beforeMap.get(commonList1.get(i))+" After- "+afterMap.get(commonList1.get(i)));
                }
            }
        }
        if (CollectionUtils.isNotEmpty(diffList1)) 
        {
            for (int i = 0; i < diffList1.size(); i++) 
            {
                System.out.println("Values present only in before map: "+beforeMap.get(diffList1.get(i)));
            }
        }
        if (CollectionUtils.isNotEmpty(diffList2)) 
        {
            for (int i = 0; i < diffList2.size(); i++) 
            {
                System.out.println("Values present only in after map: "+afterMap.get(diffList2.get(i)));
            }
        }
    }

    /**getAllKeys API adds the keys of the map to a list */
    private static List<String> getAllKeys(Map<String, String> map1)
    {
        List<String> key = new ArrayList<String>();
        if (map1 != null) 
        {
            Iterator<String> mapIterator = map1.keySet().iterator();
            while (mapIterator.hasNext()) 
            {
                key.add(mapIterator.next());
            }
        }
        return key;
    }
} 
`````

# .htaccess - .htaccess，Rewriterule 无法按我的意愿工作

> ID：11937340
> 
> 赞同：1
> 
> 时间：2012-08-13T15:21:22.987
> 
> 标签：.htaccess, mod-rewrite

我有这个链接：`http://www.domain.com.mk/lajmi.php?id=2790,` 我想把它改成`http://www.domain.com.mk/lajmi/2790`

使用此代码，我可以将链接更改为 /lajmi/2790，但出现 404 错误。我的意思是我得到了链接

`http://www.domain.com.mk/lajmi/2790`，但它有 404 错误（我不查看内容）

这是我的代码：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^domain\.com\.mk$ [OR]
RewriteCond %{HTTP_HOST} ^www\.domain\.com\.mk$
RewriteCond %{QUERY_STRING} ^id=([0-9]*)$
RewriteRule ^lajmi\.php$ http://domain.com.mk/lajmi/%1? [R=302,L] 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:50:03.783

试试这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com\.mk$
RewriteCond %{QUERY_STRING} ^id=(\d*)$
RewriteRule ^lajmi\.php$ http://domain.com.mk/lajmi/%1? [R=302,L]
RewriteRule ^lajmi/(\d*)$ lajmi.php?id=$1&r=0 [L] 
```

（最终规则中的 &r=0 是为了不进入无限循环）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T09:43:32.163

单向重写：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com\.mk$ 
RewriteRule ^lajmi/(\d*)$ lajmi.php?id=$1 [L,QSA] 
```

这意味着每个类型的 uri 都`/lajmi/2790`将`/lajmi.php?id=2790`在子请求中传递。

但是，在这种情况下，如果用户`/lajmi.php?id=2790`自己点击，那么这是他将在浏览器中看到的 url，而不是“美化的”。

* * *

双向重写：

```
RewriteEngine On
RewriteBase /

; Redirect lajmi.php?id=2790 to a beutified version, but only if not in sub-request!
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com\.mk$
RewriteCond %{IS_SUBREQ} !=true
RewriteCond %{QUERY_STRING} ^id=(\d*)$
RewriteRule ^lajmi\.php$ lajmi/%1 [R=301,L]

; Make the beutified uri be actually served by lajmi.php
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com\.mk$
RewriteRule ^lajmi/(\d*)$ lajmi.php?id=$1 [L] 
```

在这里，`RewriteCond`在第一个规则中添加了一个附加项，检查这不是子请求，以确保规则不会循环。

* * *

您可以选择您喜欢的方式，但如果您已经以“美化”方式在 HTML 中构建链接，则第一种方法就足够了（无需为了查看页面而重定向浏览器两次）。

# java - 如何将 Hibernate.TIMESTAMP 转换为日期？

> ID：11937341
> 
> 赞同：0
> 
> 时间：2012-08-13T15:21:24.830
> 
> 标签：java, hibernate, date, timestamp

如何将 Hibernate.TIMESTAMP 转换为 java.util.Date 格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-29T19:04:04.063

```
public void setStartDate(Date startDate) {
    if (startDate != null) {
        this.startDate = new Date(startDate.getTime());
    } else {
        this.startDate = null;
    }
} 
```

# magento - 如何在 Magento 中以编程方式添加 JS？

> ID：11937348
> 
> 赞同：6
> 
> 时间：2012-08-13T15:21:40.697
> 
> 标签：magento, magento-layout-xml

我需要在块文件中有条件地以编程方式添加一个 JS 文件。我尝试使用这些代码：

```
if (Mage::getStoreConfig('mymodule/settings/enable')) {
$this->getLayout()->getBlock('head')->addJs('path-to-file/file1.js');
} else {
$this->getLayout()->getBlock('head')->addJs('path-to-file/file2.js');
} 
```

但是，无论设置是什么，都不会加载此文件。我什至试图消除条件并仅显式加载一个文件，但它仍然不起作用。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-13T17:54:59.110

这里的问题可能是处理订单之一。我的猜测是你的 PHP 代码是在 head 块被渲染之后被评估的。虽然您的代码成功更新了头块类实例，但它发生在从该实例生成输出之后。

更好的解决方案是`addJs()`在布局 XML 中添加调用，以便在渲染之前对其进行处理。如果有一个`ifnotconfig`属性会很好，但现在你可以使用一个助手。

使用基于配置设置返回脚本路径的方法创建一个辅助类，然后将其用作返回参数。

```
<?php 
class My_Module_Helper_Class extends Mage_Core_Helper_Abstract
{
    public function getJsBasedOnConfig()
    {
        if (Mage::getStoreConfigFlag('mymodule/settings/enable')) {
            return 'path-to-file/file1.js';
        }
        else {
            return 'path-to-file/file2.js';
        }
    }
} 
```

然后在布局 XML 中：

```
<?xml version="1.0"?>
<layout>
    <default>
        <reference name="head">
            <action method="addJs">
                <file helper="classgroup/class/getJsBasedOnConfig" />
                <!-- i.e. Mage::helper('module/helper')->getJsBasedOnConfig() -->
            </action>
        </reference>
    </default>
</layout> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T16:41:53.293

```
$this->getLayout()->getBlock('head')->addJs('path'); 
```

它是正确的代码，搜索您的路径是否正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T14:42:52.847

我知道这是很久以前问过的，但如果有人正在寻找这个，我建议在你的 local.xml 中使用它：

```
<layout>
    <default>
        <reference  name="head">
            <action ifconfig="path/to/config" method="addJs">
                <script>pathto/file.js</script>
            </action>
        </reference>
    </default> 
</layout> 
```

当然，这是针对位于 /js/ 文件夹中的 JS 文件。如果要添加 skin_js 或 skin_css，请使用适当的方法。

PS。通过 CE 1.9 测试

# javascript - HTML5 和 Javascript

> ID：11937349
> 
> 赞同：-1
> 
> 时间：2012-08-13T15:21:44.513
> 
> 标签：javascript, html

我对javascript一无所知。只是想稍微调整一段代码，但在网上找不到答案，或者至少我能理解的答案。希望你能帮助我。

这是 HTML5 的 onMouseover/onClick javascript（播放音频）事件。脚本的 HEAD 部分在一个地方说：

* * *

```
<Script>
............
...........

}
    else{
        return {playclip:function(){throw new Error("Your browser doesn't support HTML5 audio unfortunately")}}
    } 
```

* * *

换句话说，据我所知，这意味着如果用户的浏览器不支持 HTML5 音频，脚本将返回此错误消息/对话框：“*不幸的是，您的浏览器不支持 HTML5 音频*”。

但是，我不希望返回/生成/抛出此错误消息/对话框！相反，我更希望脚本在显示任何错误消息之前自动将用户发送到新的非 HTML5 无 JavaScript 纯网页。

我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:25:04.667

你可以做

```
window.location.href = "myhtml.html"; 
```

立即定向到新站点，而不是“返回...”行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:28:03.517

您的 else 语句返回一个具有一个属性（称为`playclip`）的对象，该属性是一个引发错误的函数。如果您想将用户重定向到另一个页面，只需执行重定向而不是抛出错误：

```
else {
    return {
        playclip: function() {
            // it might be nice to tell a user why they're being redirected:
            alert('You are being redirected to another page because your browser does not support HTML5 audio!');
            window.location.href = 'whateverPageYouWant.html';
        }
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:24:42.907

最简单的做法是将位置更改为另一个 url。

```
else {
    window.location = 'http://newnonhtml5webpage/';
} 
```

# objective-c - 没有故事板的静态分组 UITableView

> ID：11937353
> 
> 赞同：0
> 
> 时间：2012-08-13T15:22:04.137
> 
> 标签：objective-c, ios, cocoa-touch

我一直在寻找，在任何地方都找不到答案。我想为我的应用程序的“设置”创建一个非常简单的分组表视图。用户点击一个按钮，我想加载一个类别中有 3 或 4 个单元格的 UITableView。有没有办法在没有动态代码构建的情况下在 IB 中设置一个（即 cellForRowAtIndexPath）。

注意：我发现的大多数答案都与我没有使用的情节提要有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:30:49.423

不，你不能。tableView:cellForRowAtIndexPath: 是表格获取数据的方式——在 iOS 中没有它就无法填充表格（在 OSX 中，您可以使用绑定，但它们在 iOS 中不可用）。

如果您只需要几个单元格，您确定需要使用表格吗？

# java - @Cacheable 中断 DependencyInjection

> ID：11937354
> 
> 赞同：6
> 
> 时间：2012-08-13T15:22:08.270
> 
> 标签：java, spring, dependency-injection, annotations, proxy-classes

我偶然发现了使用@Cacheable 创建的AOP 代理破坏了Spring 3.1.1 中的依赖注入的情况。这是我的场景：

我有一个接口和一个类在实现的方法中使用@Cacheable 实现这个接口。

示例界面：

```
public interface ImgService {
    public byte[] getImage(String name);
} 
```

示例实现：

```
public class ImgServiceImpl implements ImgService {

    @Cacheable(cacheName = "someCache")
    public byte[] getImage(String name){//TODO};

    protected String someOtherMethod(){//};
} 
```

我还必须对 JUnit 测试类 - 一个注入接口，一个注入实现：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:META-INF/spring.xml" })
public class ImgServiceTest {

    @Inject
    private ImgService;
} 
```

和

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:META-INF/spring.xml" })
public class ImgServiceImplTest {

    @Inject
    private ImgServiceImpl;
} 
```

接口的依赖注入工作正常。但是，当我在第二个测试类中注入实现时，我得到一个*"Injection of autowired dependencies failed"*。我能够对其进行调试，并且似乎*ClassUtils.isAssignableValue()*错误地将所需类型与代理类进行了比较。它由*DefaultListableBeanFactory*调用。更奇怪的是，如果我从实现的方法中删除 @Cacheable 注释并将其添加到其他一些受保护/私有方法中，依赖注入再次正常工作。这是一个错误吗？处理这种情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T15:40:45.190

这不是一个错误，它是使用 JDK 动态代理来实现 AOP 的预期副作用。

由于对 的可缓存方法的所有调用都`ImgServiceImpl`应该通过 type 的动态代理`ImgService`，因此无法将此依赖项注入到 type 的字段中`ImgServiceImpl`。

当您移动`@Cacheable`到`private`​​or`protected`方法时，注入会起作用，因为`@Cacheable`在这种情况下不会生效 - 只有`public`方法可以使用基于代理的 AOP 来建议。

因此，您应该将要注入的字段声明为`ImgService`，或者将 Spring 配置为使用基于目标类的代理，而不是使用`proxy-target-class = "true"`.

另一个选择是将 Spring 配置为使用[基于 AspectJ 的 AOP 实现](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/aop.html#aop-using-aspectj)（需要编译时或加载时编织）。

它适用于 Spring 提供的所有基于 AOP 的特性（事务、安全、异步执行、缓存、自定义方面等）。

**也可以看看：**

*   [7.6 代理机制](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/aop.html#aop-proxying)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T07:26:56.370

好的，这就是我最终提出的解决方案。我实现了一个简单的方法，它试图根据`org.springframework.aop.framework.Advised`类的实现从代理中提取目标对象：

```
@SuppressWarnings({"unchecked"})
public static <T> T getTargetObject(Object proxy, Class<T> targetClass) {
  if (AopUtils.isJdkDynamicProxy(proxy)) {
    try {
        return (T) ((Advised)proxy).getTargetSource().getTarget();
    } catch (Exception e) {
        return null;
    }
  } else {
    return (T) proxy;
  }
} 
```

我的实现测试类现在看起来像这样：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath*:META-INF/spring.xml" })
public class ImgServiceImplTest {

    @Inject
    private ImgService imgService;

    private ImgServiceImpl imgServiceImpl;

    @PostConstruct
    public void setUp() {
        imgServiceImpl = getTargetObject(imgService, ImgServiceImpl.class);
    }

} 
```

# amazon-ec2 - 在 Amazon Web Services 中，AMI 编号表示什么

> ID：11937357
> 
> 赞同：1
> 
> 时间：2012-08-13T15:22:12.180
> 
> 标签：amazon-ec2, amazon-web-services

我正在尝试创建一个 Amazon EC2 实例。我想创建一个微型 64 位 Ubuntu 12.04 LTS 实例。

在亚马逊网络服务中，我看到所有实例都有`AMI`数字。现在我找到了两个带有数字`ami-8a7f3ed8`和`ami-b8a8e9ea`. 两者在我看来都一样——微型、基于 ebs 的 64 位 Ubuntu 12.04LTS 映像。

如果是这样，有什么区别，为什么同一机器映像有两个数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:24:46.577

无限数量的人可以创建无限数量的仍然是“64 位微型 Ubuntu 12.04 LTS”的磁盘映像变体。就像世界上有超过 5 亿台 PC 运行 Windows 7 64 位一样，但它们的硬盘驱动器都包含不同的数据。如果您希望能够区分 Joe 的磁盘映像和 Sue 的磁盘映像，则需要为它们提供不同的标识符。这就是 AMI 编号不同的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:25:52.253

AMI 只是磁盘的映像。它与类型（微）无关。您可以从同一个实例创建多个 AMI，它们将具有不同的 ID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T15:28:45.420

选择 AMI 时，请从受信任的来源中进行选择。

AMI 编号只是某人发布的特定图像的唯一标识符。标题（例如 Ubuntu 12.04LTS）只是发布 AMI 的人对上面内容的声明。

如果您从不可靠的来源获取 AMI，则它可能包含内置安全漏洞、预安装的垃圾邮件中继等。

**来自亚马逊**

> 您启动 AMI 需要您自担风险。Amazon 无法保证其他 EC2 用户共享的 AMI 的完整性或安全性。因此，您应该像对待您可能考虑在自己的数据中心部署的任何外部代码一样对待共享 AMI，并执行适当的尽职调查。
> 
> 理想情况下，您应该从受信任的来源（网站、另一个 EC2 用户等）获取 AMI ID。如果您不知道 AMI 的来源，我们建议您在启动 AMI 之前搜索论坛以获取有关该 AMI 的评论。相反，如果您对共享 AMI 有任何疑问或意见，请随时使用 AWS 论坛提问或发表评论。
> 
> 亚马逊的公共图像有一个别名所有者，并在 userId 字段中显示 amazon。这使您可以轻松找到亚马逊的公共图像。

[http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AESDG-chapter-usingsharedamis.html#usingsharedamis-security](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AESDG-chapter-usingsharedamis.html#usingsharedamis-security)

我个人选择 AMI 发布的知名实体，如 Amazon 或 RighScale。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T15:25:29.357

它们只是不同的图像。您可以在一分钟后从同一台机器上制作两个图像，而机器上根本没有任何变化，它们将具有不同的 AMI id。AMI ID 只是在创建图像时作为唯一标识符应用，它不会推断图像内容的唯一性。

# html - 为什么会有间距？

> ID：11937359
> 
> 赞同：0
> 
> 时间：2012-08-13T15:22:16.903
> 
> 标签：html, css

我有这个恼人的一点点间距，我无法消除。

这是一个[小提琴。](http://jsfiddle.net/MichaelT/QzYcf/)

这是狗和灰色盒子之间的白色填充（？）。

我可能应该提到我正在学习盒子模型（相对/绝对）等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T15:23:54.140

`display: block;`在你的 img 上使用[http://jsfiddle.net/QzYcf/1/](http://jsfiddle.net/QzYcf/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:25:07.247

```
#header img { width: 100%; display: block; border: none;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:28:35.023

移动包装器 div 以包含所有 div。像这样：[小提琴](http://jsfiddle.net/djp122/QzYcf/14/)

你什么标题喜欢这个[小提琴](http://jsfiddle.net/djp122/QzYcf/34/)吧

HTML：

```
<div id="wrapper">
<div id="outer">
       <div id="inner"></div>
</div></div>
<div id="header">
    <img src="http://davesizer.com/blogs/wp-content/uploads/2010/03/eva_jump.jpg" alt="Dog">
</div> 
```

将此 #wrapper 和 #header 更改为：

```
#wrapper{
  position: relative; /*or position: absolute; top: 250px;*/
  top: 240px;
  width:100%;
  background-color: lightgrey;
 }

#header{
  position: fixed;
  top: 0;
  width: 100%;
  height:auto;
  background-size: 100%;
} 
```

# asp.net-mvc-3 - MVC3 DropDownListFor 不填充 selectedValue

> ID：11937361
> 
> 赞同：0
> 
> 时间：2012-08-13T15:22:22.413
> 
> 标签：asp.net-mvc-3, razor

我觉得我正在服用疯狂的药丸。我有一个视图的下拉列表，它从我们的数据库中读取我们拥有的所有葡萄酒生产商。我想将 selectedValue 设置为由引用页面驱动的特定 ID。我可以看到它在调试中获取了 selectedValue，我看到填充了选定的值（本例中为 906），但是在呈现页面时它没有将下拉列表设置为正确的值，它始终默认为默认值 1价值。我尝试在 razor 中创建 selectList 而不是我的控制器，但没有任何效果。对此的任何帮助将不胜感激，我猜它很小。

控制器：

```
 if (User.IsInRole("admin"))
        {
            if (ID != 0)
            {
                ViewBag.ProducerSelect = new SelectList(db.Producers.OrderBy(p => p.Name), "ProducerID", "Name", ID);
            }
            else
            {
                ViewBag.ProducerSelect = new SelectList(db.Producers.OrderBy(p => p.Name), "ProducerID", "Name");
            }
        } 
```

看法：

```
if (User.IsInRole("producereditor"))
{
    <h3>@ViewBag.ProducerName</h3>
}
    else
{
<div class="editor-label">
    @Html.LabelFor(m => m.Wine.ProducerID, "Producer")
</div>
<div class="editor-field">
    @Html.DropDownListFor(m => m.Wine.ProducerID, ViewBag.ProducerSelect as SelectList)
</div>
} 
```

尝试了以下但没有成功：

```
 ViewBag.ProducerSelect = new SelectList(from p in db.Producers
                                                    orderby p.Name
                                                    select new { p.ProducerID, p.Name }
                                                    , "ProducerID", "Name", ID); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:25:11.347

用户 ViewModel ex WineViewModel

```
public class WineViewModel
    {

        public Wine Wine { get; set; }

        public SelectList PProducerList { get; set; }

        public WineViewModel() { }

        public WineViewModel(Wine wine) 
        {
            this.Wine = wine;          

        }
    } 
```

在您的控制器中尝试以下操作 var model = new WineViewModel(selectwine);

```
 model.ProjectTypeList = new SelectList( from p in db.Producers
                                            orderby p.Name
                                           select new { p.ID, p.Name }, "ID", "Name") 
```

请注意我是如何专门声明哪个是 ID，哪个是我的 SelectList 中的值

然后在你看来做

```
 @Html.DropDownListFor(model => model.Wine.ProducerID, Model.ProjectTypeList) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:31:00.550

如果您想预先选择一个项目，您可以将该值设置为您的 ProducerId 属性。

```
var yourViewModelObj=new YourViewModel;
yourViewModelObj.Wine.ProducerId=906; //or whatever value you want
return View(yourViewModelObj); 
```

***建议***：为了更好的代码可读性/维护性，尽量避免使用 ViewBag / ViewData 并使用 ViewModel 来传递数据。

我会在我的 ViewModel 中添加一个属性来保存生产者的集合

```
public class WineViewModel
{
   //Other Existing properties also
   public IEnumerable<SelectListItem> Producers{ get; set; }
   public string SelectedProducer { get; set; }
} 
```

然后在你的 GetAction 方法中，你可以像这样设置值，如果你想将一个选择选项设置为默认选择一个。

```
public ActionResult CreateWine()
{
  var vm=new WineViewModel();
  //The below code is hardcoded for demo. you mat replace with DB data.
  vm.Producers= new[]
  {
    new SelectListItem { Value = "1", Text = "Prodcer A" },
    new SelectListItem { Value = "2", Text = "Prodcer B" },
    new SelectListItem { Value = "3", Text = "Prodcer C" }
  };      
  //Now let's set the default one's value
  vm.SelectedProducer = "2";  

  return View(vm);    
} 
```

在您的强类型视图中，

```
@Html.DropDownListFor(x => x.SelectedProducer, 
     new SelectList(Model.Producers, "Value", "Text"), "Select Producer") 
```

上述代码生成的 HTML 标记将选择带有值为 2 的选项的 HTML 选项`selected`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:40:52.960

我想通了。我在页面其他地方的隐藏字段中有 ViewModel.wine.ProducerID，默认为 1，所以我只是将其分配给传入的值，效果很好。我知道是这样的。谢谢！

# ios - ios LINESTRING解析

> ID：11937362
> 
> 赞同：0
> 
> 时间：2012-08-13T15:22:22.753
> 
> 标签：ios, xcode, json, parsing, map

我一直在为 iOS 的谷歌地图定制路线。

如何解析 LINESTRING 中的传入 JSON？

我的线路：

```
"coordInfo": "LINESTRING (28.646751729297 40.9993029074749, 28.6470087874434 40.9995465119554, 28.6470087874434 40.9995465119554, 28.6474633603416 41.0000088561426)"
    }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:43:13.303

从您发布的内容看来， objectForKey@"coordInfo" 为您提供了一个带有括号中数字的字符串。您可以使用 NSString 方法 componentsSeparatedByCharactersInSet 对其进行解析：传递包含左右括号、逗号和空格的集合以生成单个数字字符串的数组（以及单词“LINESTRING”作为数组中的第一个字符串） . 该数组还将包含一些空字符串，其中 2 个分隔字符在一起（如逗号和空格），因此在将对象从数组中取出时必须对其进行测试。

你也可以像这样使用 NSScanner：

```
NSString *toParse = @"LINESTRING (28.646751729297 40.9993029074749, 28.6470087874434 40.9995465119554, 28.6470087874434 40.9995465119554, 28.6474633603416 41.0000088561426)";
    NSScanner *scanner = [NSScanner scannerWithString:toParse];
    double num;
    while (! [scanner isAtEnd]) {
      [scanner scanUpToCharactersFromSet:[NSCharacterSet decimalDigitCharacterSet] intoString:nil];
      [scanner scanDouble:&num];
      // put numbers into an array here or use them somehow
      NSLog(@"%f",num);
    } 
```

# vim - 如何向 VIM 添加自定义动词？

> ID：11937363
> 
> 赞同：7
> 
> 时间：2012-08-13T15:22:39.840
> 
> 标签：vim, vi

我想为 vim 定义一个新动词（比如'o'），它可以对任何现有的 vim 文本对象进行操作。关于我如何去做这件事的任何指示？

谢谢 AB

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T15:39:42.867

这些动词称为操作符（参见 参考资料`:h operator`）。如果要构建自己的运算符，则必须使用`'operatorfunc'`设置然后执行`g@`。vim 文档最好地解释了如何执行此操作，请参阅 ( `:h :map-operator`) 以下是 vim 文档中的示例：

```
nmap <silent> <F4> :set opfunc=CountSpaces<CR>g@
vmap <silent> <F4> :<C-U>call CountSpaces(visualmode(), 1)<CR>

function! CountSpaces(type, ...)
  let sel_save = &selection
  let &selection = "inclusive"
  let reg_save = @@

  if a:0  " Invoked from Visual mode, use '< and '> marks.
    silent exe "normal! `<" . a:type . "`>y"
  elseif a:type == 'line'
    silent exe "normal! '[V']y"
  elseif a:type == 'block'
    silent exe "normal! `[\<C-V>`]y"
  else
    silent exe "normal! `[v`]y"
  endif

  echomsg strlen(substitute(@@, '[^ ]', '', 'g'))

  let &selection = sel_save
  let @@ = reg_save
endfunction 
```

如果您想要另一个示例，请查看 Tim Pope 的[评论插件](https://github.com/tpope/vim-commentary/blob/master/plugin/commentary.vim)。

如需更多帮助

```
:h operator
:h :map-operator
:h 'opfunc'
:h g@ 
```

# websphere-mq-fte - 如何配置 fte ant 脚本，以便它可以在文件传输之前执行一些任务

> ID：11937369
> 
> 赞同：0
> 
> 时间：2012-08-13T15:22:56.220
> 
> 标签：websphere-mq-fte

谁能给我推荐一些好的网站，这样我就可以学习如何使用 FTE 和 FTE ant 脚本。基本上我想在文件传输之前使用 ant 脚本来执行一些任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T21:39:55.743

我解决了..以下是参考的解决方案：

```
<request version="1.00" xsi:noNamespaceSchemaLocation="FileTransfer.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <managedCall>
      <originator>
         <hostName>X.com</hostName>
         <userID>X</userID>
         <mqmdUserID>X</mqmdUserID>
      </originator>
      <agent QMgr="X" agent="X"/>
      <reply QMGR="X">reply</reply>
      <transferSet priority="1">
         <metaDataSet>
            <metaData key="com.ibm.wmqfte.SourceAgent">X</metaData>
            <metaData key="com.ibm.wmqfte.DestinationAgent">X</metaData>
         </metaDataSet>
         <call>
            <command name="X.xml" type="antscript" retryCount="2" retryWait="30" successRC="0">
               <target>X</target>
               <property name="trigger.filename" value="${FileName}"/>   

            </command>
         </call>
      </transferSet>
      <job>
         <name>X</name>
      </job>
   </managedCall>
</request> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T03:47:29.153

[WMQ InfoCenter](http://publib.boulder.ibm.com/infocenter/wmqfte/v7r0/topic/com.ibm.wmqfte.doc/using_ant.htm)有关于 FTE Ant 脚本的很好的信息。您还可以查看这篇[developerWorks](http://www.ibm.com/developerworks/websphere/library/techarticles/1206_thambrahalli/1206_thambrahalli.html)文章。

# node.js - Azure node.js iisnode_shema.xml 系统找不到指定的路径

> ID：11937373
> 
> 赞同：0
> 
> 时间：2012-08-13T15:23:02.857
> 
> 标签：node.js, azure

我正在使用来自 Web Platform Installer 的最新 Windows Azure SDK for Node.js（2012 年 8 月）。当我尝试运行我的节点应用程序时，我在日志文件中收到此错误：

G:\node\mathwizard\local_package.csx\roles\WebRole2\approot\bin>copy /y "C:\Program Files (x86)\Microsoft SDKs\Windows Azure\PowerShell\x64\iisnode_schema.xml" "C:\ Program Files\IIS Express\config\schema\iisnode_schema.xml" 系统找不到指定的路径。

无法连接到浏览器中的应用程序。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T19:09:52.887

我们在 7 月和 8 月版本之间进行了一些更改，如果您想使用 August 工具，则必须将您的项目迁移到新的 August 格式。正如您所发现的，如果您重新创建项目，复制所有节点文件不变，它应该可以正常工作。带来不便敬请谅解！

我们已提交此问题[https://github.com/WindowsAzure/azure-sdk-tools/issues/331](https://github.com/WindowsAzure/azure-sdk-tools/issues/331)以进一步调查。

# selenium - 拆卸后的phpunit数据库测试

> ID：11937382
> 
> 赞同：1
> 
> 时间：2012-08-13T15:23:43.273
> 
> 标签：selenium, phpunit, database-testing

我想在测试用例/测试套件中执行几个测试（通过 selenium），并将数据库测试挂钩到每个 tearDown 的末尾（使用无法在 tearDown 中调用的断言）。

所以工作流程是：

*   在 setUpBeforeClass() 中设置与数据库和模式的连接
*   在 setUp() 中设置数据库（仅内容）
*   执行 test01
*   拆解内容
*   断言数据库中的每个表的行数是否为零。

那么有没有办法在每次拆解的末尾附加一个断言？

我尝试在 assertPreConditions 中进行设置，并在 assertPostConditions 中进行拆卸，但这有点难看。

提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T23:44:45.683

似乎您可以在任何地方使用断言，甚至在`tearDown()`. 此测试用例（另存为 testTearDown.php，使用 运行`phpunit testTearDown.php`）正确地给出了失败：

```
class TearDownTest extends PHPUnit_Framework_TestCase
{

/** */
public function setUp(){
    echo "In setUp\n";
    //$this->assertTrue(false);
    }

/** */
public function tearDown(){
    echo "In tearDown\n";
    $this->assertTrue(false);
    }

/** */
public function assertPreConditions(){
    echo "In assertPreConditions\n";
    //$this->assertTrue(false);
    }

/** */
public function assertPostConditions(){
    echo "In assertPostConditions\n";
    //$this->assertTrue(false);
    }

/**
*/
public function testAdd(){
    $this->assertEquals(3, 1+2);
    }

} 
```

但是，我的一条经验法则是：如果软件让我的生活变得困难，也许我做错了什么。您写道，在`tearDown`代码运行后您想要：“*断言如果数据库中的每个表的 rowCount 为零。* ”

这听起来像是您想验证您的*单元测试代码*是否已正确编写，在这种情况下，tearDown 是否正确完成了它的工作？这与您实际测试的代码没有任何关系。使用 phpUnit 断言机制会令人困惑和误导；在我上面的示例中，当 tearDown 断言它告诉我 testAdd() 失败了。如果实际上是 tearDown() 中的代码不能正常工作，我想被告知。所以，为了验证你的单元测试代码，为什么不使用 PHP 的断言：

所以我想知道你想要的 tearDown() 函数是否看起来像这样：

```
public function tearDown(){
    tidyUpDatabase();
    $cnt=selectCount("table1");
    assert($cnt==0);
    $cnt=selectCount("table2");
    assert($cnt==0);
    } 
```

# android - 如何解析这个？

> ID：11937390
> 
> 赞同：-5
> 
> 时间：2012-08-13T15:24:06.807
> 
> 标签：android, json, parsing, arrays

朋友请帮助我使用 Json 对象和 json 数组概念解析此响应我将所有字段作为字符串显示

```
{"status": "OK", 
 "data": {
       "passenger": [
               {"status": "S2 , 26", 
               "seat_number": "RAC 53,GNWL"}, 
               {"status": "S2 , 27", "seat_number": "RAC 54,GNWL"}], 
       "from": {"code": "MAQ", 
               "name": "MANGALORE", 
               "time": "14:40"}, 
       "chart_prepared": true, 
       "alight": 
               {"code": "LTT", 
               "name": "LOKMANYA TILAK (T)", 
               "time": "06:35"}, 
       "pnr_number": "4243907794", 
       "train_number": "12620", 
       "to":   {"code": "LTT", 
               "name": "LOKMANYA TILAK (T)", 
               "time": "06:35"}, 
       "board": {"timestamp": 1344849000, 
               "code": "MAQ", 
               "name": "MANGALORE", 
               "time": "14:40"}, 
       "train_name": "MATSYAGANDA EXP", 
       "travel_date": {"date": "13-8-2012", 
               "timestamp": 1344796200}, 
       "class": "SL"
       }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:28:38.520

您可以使用[http://www.json.org/java/](http://www.json.org/java/)，使用您的字符串作为第一个参数实例化一个新的 JSONObject 并从那里继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:33:17.303

在上面的 JSON 结构图像中 ![在此处输入图像描述](../Images/ec85e102429c97cdd3858d176e29f3b2.png)

您最好使用[http://jsonviewer.stack.hu/](http://jsonviewer.stack.hu/)并将您的 json 粘贴到此处以查看和了解其结构，然后可以使用 GSON 或任何其他库对其进行解析并从中获取您想要的内容

# jquery - fadeToggle 使用切换功能

> ID：11937401
> 
> 赞同：1
> 
> 时间：2012-08-13T15:24:49.890
> 
> 标签：jquery

这是我的代码：

```
$('#retouche_a_faire').click(function() {
$("#retouche_a_faire_alert").toggle(this.checked);
}); 
```

它工作得很好。基本上，它是一个`div`在“retouche_a_faire”复选框被选中时出现的功能，当它不是时消失。但我想使用该`fadeToggle`选项而不是`toggle`. 我怎样才能使这项工作？

我试过 ：

```
$('#retouche_a_faire').click(function() {
$("#retouche_a_faire_alert").fadeToggle(this.checked);
}); 
```

但它不起作用，因为我需要设置持续时间和缓动我认为......但我也需要在括号中使用“this.checked”......我有点困惑。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:35:54.557

[http://jsfiddle.net/a6Dkw/4/](http://jsfiddle.net/a6Dkw/4/)

在这种情况下，您不想使用 fadeToggle() ，除非您知道它会以 开头`display:none`，否则测试它是否被检查会更安全。此外，如果您使用的是 jQuery 1.7.2，您可以使用`.on('click')`和`.prop()`

```
$('#retouche_a_faire').on('click', function() {
    if ($(this).prop('checked')) {
        $("#retouche_a_faire_alert").fadeIn();
    }
    else {
        $("#retouche_a_faire_alert").fadeOut();
    }
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:30:43.170

fadeToggle 没有布尔选项，但您可以使用基于复选框的 fadeOut/fadeIn，如下所示：

```
$('#retouche_a_faire').click(function() {
    if ($(this).prop('checked')) {
        $("#retouche_a_faire_alert").fadeIn( [duration] [, easing] [, callback] );
    } else {
        $("#retouche_a_faire_alert").fadeOut( [duration] [, easing] [, callback] );
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:32:02.357

其基本形式：

```
$('#retouche_a_faire').click(function() {
  $("#retouche_a_faire_alert").fadeToggle();
}); 
```

如果您想使用`.fadeToggle()`，您可以运行检查 onload 以显示隐藏警报，具体取决于是否选中了它的复选框：

```
if (!$("#retouche_a_faire").attr('checked'))
    $("#retouche_a_faire_alert").hide(); 
```

请参阅我的示例小提琴 - [http://jsfiddle.net/Y2cnR/](http://jsfiddle.net/Y2cnR/)

**更新** 我已经更新了我的小提琴以显示将我的答案应用于多个输入 - [http://jsfiddle.net/Y2cnR/1/](http://jsfiddle.net/Y2cnR/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T15:42:21.710

例如，您可以将布尔值与 fadeTo 一起使用

```
$('#retouche_a_faire').click(function() { 
    $('#retouche_a_faire_alert').stop().fadeTo(200,this.checked ? 1 : 0);
}); 
```

[http://jsfiddle.net/VqD5C/1/](http://jsfiddle.net/VqD5C/1/)

# regex - .htaccess 中的 RewriteRule 循环不起作用

> ID：11937409
> 
> 赞同：1
> 
> 时间：2012-08-13T15:25:09.943
> 
> 标签：regex, .htaccess, mod-rewrite, rewrite

我正在尝试为网站中的所有页面制作漂亮的链接，我`foo.com/services/domestic`想去`foo.com/index.php?page=services-domestic`. 我的 .htaccess 文件中有以下内容，并且对于上面的示例运行良好，但是如果我尝试转到`foo.com/services/domestic/case/1`（预期`/index.php?page=services-domestic-case-1`）我会得到 404。

```
# a/b/c/d -> a-b-c-d
RewriteRule ^([a-zA-Z0-9]+)/([a-zA-Z0-9_-]+)$ $1-$2 [N]

# a-b-c-d -> index.php?page=a-b-c-d
RewriteRule ^([^(/|\.)]+)$ index.php?page=$1 
```

我试过在`[N]`没有标志的情况下重复该行三遍，但无济于事。除了第一个深度之外，它对任何东西都不起作用。可能只是我的业余正则表达式，但我不明白发生了什么问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:43:41.573

试试这个 ：

```
RewriteRule ^([\w-]+)/([\w-]+)$ $1-$2 [N]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)$ index.php?page=$1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:47:50.010

看起来您只需要调整正则表达式并重写标志：

```
# a/b/c/d -> a-b-c-d
RewriteRule ^(.*)/(.*) /$1-$2 [L]

# a-b-c-d -> index.php?page=a-b-c-d
RewriteRule ^([^/.]+)$ /index.php?page=$1 [L] 
```

# c# - 比较不同文件夹中的文件名字符串

> ID：11937415
> 
> 赞同：0
> 
> 时间：2012-08-13T15:25:21.280
> 
> 标签：c#, string, string-comparison

我正在尝试编写一些代码来检查用户选择的模糊图片是否与正常图片相同。

一旦选择了所有 6 个图片选项，它就会使用图像位置字符串来比较每个选项。到目前为止，它已经将普通图片作为文本文件中的图片位置数组，作为一种密码。

本质上，我想获取密码字符串数组中每个条目的图像位置字符串（文件名部分）的最后一部分，并将其与用户单击的模糊图片的当前选择（数组）进行比较

到目前为止，比较部分是这样的：

```
//Test to see whether the password entered is the same as the saved password.
if (passwordEntered[0] == passwordLocation[0] && passwordEntered[1] == passwordLocation[1] && passwordEntered[2] == passwordLocation[2])
{
      MessageBox.Show(TextResources.alertMessageText.passwordCorrect);
      Application.Exit();
} 
```

但是，这不起作用，因为 passwordEntered[] 的图像位置与 passwordLocation[] 查找不同的目录（即，如果 "...filepath/cat.jpg" == "...filepath/Blurred/cat.jpg ”）。

我在想子字符串是这里的解决方案，但我不确定如何正确使用它们。

任何人都可以帮助或给我一个如何提取子字符串的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:27:25.387

使用[`System.IO.Path.GetFileName(path)`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)方法：

```
string fileone = GetFileName(pathone); // > fileone.ext
string filetwo = GetFileName(pathtwo); // > filetwo.ext

if(fileone == filetwo) doStuff(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:28:20.063

该类[`Path`](http://msdn.microsoft.com/en-us/library/system.io.path.aspx)具有内置的-[`GetFileName`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)方法。

```
if ( Path.GetFileName(pathOne) == Path.GetFileName(pathTwo) ) 
```

# facebook - Facebook Feed Dialog 链接格式

> ID：11937416
> 
> 赞同：2
> 
> 时间：2012-08-13T15:25:22.253
> 
> 标签：facebook, dialog, feed

我的网站上有以下代码：

```
<a onclick='postToFeed(); return false;'><img style="width: 27px; height: 27px; border: 0px;" src="{$baseurl}/images/fb_m.png"/></a>
<p id='msg'></p>
{literal}
<script> 
  FB.init({appId: "xxx", status: true, cookie: true});

  function postToFeed() {

    // calling the API ...
    var obj = {
      method: 'feed',
      display: 'iframe',
      link: 'https://developers.facebook.com/docs/reference/dialogs/',
      picture: 'http://fbrell.com/f8.jpg',
      name: 'Facebook Dialogs',
      caption: 'Reference Documentation',
      description: 'Using Dialogs to interact with users.'
    };

    function callback(response) {
      document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
    }

    FB.ui(obj, callback);
  }

</script>
{/literal} 
```

我网站上的链接格式如下：

```
{$baseurl}/post/{$posts[i].PID} 
```

我试图在“链接：”部分添加这个字符串，但是它没有共享正确的链接。

任何想法将不胜感激。谢谢

好的，我设法正确插入了链接。以下是链接参数的外观：

```
link: '{/literal}{$baseurl}/post/{$posts[i].PID}{literal}', 
```

现在弹出脚本发布了一个正确的链接，例如[http://mysite.com/post/1234](http://mysite.com/post/1234)。然而，又出现了一个问题。我的网站页面是网格布局，类似于 pinterest 样式。每个帖子都有自己的链接。但是，无论我在哪个帖子上单击共享按钮，该脚本都会共享网格中的最后一个帖子。如果我使用分享按钮作为链接，例如：

> ```
> <a href="http://www.facebook.com/share.php?u={$baseurl}/post/{$posts[i].PID}"       onclick=”return fbs_click()” target=”_blank”&gt;share</a> 
> ```

正确的帖子已共享。

我需要使用带有正确链接的弹出提要对话框。任何帮助将不胜感激。

# ruby - 在文件中查找日期，在其后获取数据

> ID：11937418
> 
> 赞同：0
> 
> 时间：2012-08-13T15:25:23.390
> 
> 标签：ruby, parsing, csv

帮助我集思广益，我将如何解决这个问题。

我有一个包含相应数据的日期文件，格式如下：

```
Date,data,data,data,data,data
Date,data,data,data,data,data 
```

这是一个普通的 csv 文件，只使用逗号。

我需要能够选择开始日期。然后从所选日期开始获取接下来 20 天的数据。

日期格式：2007.05.21 (y,m,d)

所以我认为最好搜索日期。要么首先将整个文件加载到内存中，要么逐行读取。该文件只有 1 兆字节，但我可能也想使用 100 兆字节的文件来执行此操作。这还小吗？

我也想做很多次。我想我可能想在程序的整个运行过程中将文件保存在内存中。所以我可以反复访问它。

找到日期后。我需要能够获得第 2 列第 1 天，第 4 列第 4 天。等等。但是，每天总是有相同数量的列。所以我想如果这被加载到某种数组中，我总是可以知道第二天和第二天开始的数组编号。

任何帮助将不胜感激。此外，提供的任何代码示例都会有帮助。这不是家庭作业问题或类似的问题，我对编程真的很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:06:14.043

您可以使用用户`csv`库来逐行解析您的文件

```
require 'csv'
date_to_search = Date(2009, 10, 10)
CSV.read('yourfilename.txt', :col_sep => ',') do |row|
  # row will be an array of strings which you can parse
  cur_date = Date.parse(row[0])
  if cur_date == date_to_search
    # you are set to read next 19 lines
    # you can keep a counter and increment it after parsing each line (row here)
  end
  # compare and check if you need this line (and next 19)
  # other calculations
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:15:09.950

当您的数据被排序时，[二分搜索](http://en.wikipedia.org/wiki/Binary%20Search)就是您想要使用的。

简而言之，您在 CSV 中间查找一个元素，将其日期与您要查找的日期进行比较，然后在文件的匹配部分中继续递归（有关详细信息，请参阅 Wikipedia 链接）。

二分查找的运行时复杂度为 O(log n)，这意味着对包含 1,000,000 行的文件（合理估计为 100 MB）的读取操作次数永远不会（在正常情况下，即不同长度的行是相等的）分布式）超过 20 个。

因此，没有必要将文件保存在内存中，恰恰相反。操作系统的磁盘缓存将为您完成加速连续操作的任务，而不会遇到内存不足的情况。

要读取和处理一行，首先需要找到它的第一个字符，它可以是换行符 (\n) 之后的第一个字母，也可以是文件的开头。读取多行也可以实现类似的。要解析一行，我建议您在分隔字符和/或日期的点处拆分行。当然，这仅适用于 CSV 来自可靠来源并且从不更改其布局的情况。

# python - pyPDF在startxref处有错误的外部参照字符

> ID：11937424
> 
> 赞同：3
> 
> 时间：2012-08-13T15:25:33.180
> 
> 标签：python, pdf, pypdf

我正在使用 pyPDF 进行 pdf 页面提取和合并。我的问题并不完全依赖于 pyPDF，因为我过去在同一个 pdf 文件上遇到过与 pdfSharp 相同类型的错误。

问题是我在尝试阅读我们从供应商处收到的一些 pdf 文档时遇到错误。我不能告诉他们修复它们，所以我必须在我们这边处理它。现在我在java中使用iText来处理pdf合并并且这些文件没有任何问题，但是iText比pyPDF慢而且更难维护。pyPDF 在外部参照表中有一个供阅读的部分。在该部分中，有几个选项，行以“xref”开头，行以数字开头，或者行以“xref”开头，但在 x 之前有一个额外的字符。

在我的情况下，该行以“196 0 obj”开头，但下一行是“<< /Length 197 0 R”。pyPDF 和 pdfSharp 不承认这一点，他们试图将其读取为交叉引用并抛出异常。*关于我可以做些什么来避免这种情况或修补 pyPDF 的任何建议？它可能格式不正确，但我需要像 Acrobat 和 iText 一样解决它。*

这是 pyPDF 库中 pdf.py 的部分。这是很多代码，但重要的是系列中以**if x == "x" 开头的 if 语句：**

```
# read all cross reference tables and their trailers
    self.xref = {}
    self.xref_objStm = {}
    self.trailer = DictionaryObject()
    while 1:
        # load the xref table
        stream.seek(startxref, 0)
        x = stream.read(1)
        if x == "x":
            # standard cross-reference table
            ref = stream.read(4)
            if ref[:3] != "ref":
                raise utils.PdfReadError, "xref table read error"
            readNonWhitespace(stream)
            stream.seek(-1, 1)
            while 1:
                num = readObject(stream, self)
                readNonWhitespace(stream)
                stream.seek(-1, 1)
                size = readObject(stream, self)
                readNonWhitespace(stream)
                stream.seek(-1, 1)
                cnt = 0
                while cnt < size:
                    line = stream.read(20)
                    # It's very clear in section 3.4.3 of the PDF spec
                    # that all cross-reference table lines are a fixed
                    # 20 bytes.  However... some malformed PDF files
                    # use a single character EOL without a preceeding
                    # space.  Detect that case, and seek the stream
                    # back one character.  (0-9 means we've bled into
                    # the next xref entry, t means we've bled into the
                    # text "trailer"):
                    if line[-1] in "0123456789t":
                        stream.seek(-1, 1)
                    offset, generation = line[:16].split(" ")
                    offset, generation = int(offset), int(generation)
                    if not self.xref.has_key(generation):
                        self.xref[generation] = {}
                    if self.xref[generation].has_key(num):
                        # It really seems like we should allow the last
                        # xref table in the file to override previous
                        # ones. Since we read the file backwards, assume
                        # any existing key is already set correctly.
                        pass
                    else:
                        self.xref[generation][num] = offset
                    cnt += 1
                    num += 1
                readNonWhitespace(stream)
                stream.seek(-1, 1)
                trailertag = stream.read(7)
                if trailertag != "trailer":
                    # more xrefs!
                    stream.seek(-7, 1)
                else:
                    break
            readNonWhitespace(stream)
            stream.seek(-1, 1)
            newTrailer = readObject(stream, self)
            for key, value in newTrailer.items():
                if not self.trailer.has_key(key):
                    self.trailer[key] = value
            if newTrailer.has_key("/Prev"):
                startxref = newTrailer["/Prev"]
            else:
                break
        elif x.isdigit():
            # PDF 1.5+ Cross-Reference Stream
            stream.seek(-1, 1)
            idnum, generation = self.readObjectHeader(stream)
            xrefstream = readObject(stream, self)
            assert xrefstream["/Type"] == "/XRef"
            self.cacheIndirectObject(generation, idnum, xrefstream)
            streamData = StringIO(xrefstream.getData())
            idx_pairs = xrefstream.get("/Index", [0, xrefstream.get("/Size")])
            entrySizes = xrefstream.get("/W")
            for num, size in self._pairs(idx_pairs):
                cnt = 0
                while cnt < size:
                    for i in range(len(entrySizes)):
                        d = streamData.read(entrySizes[i])
                        di = convertToInt(d, entrySizes[i])
                        if i == 0:
                            xref_type = di
                        elif i == 1:
                            if xref_type == 0:
                                next_free_object = di
                            elif xref_type == 1:
                                byte_offset = di
                            elif xref_type == 2:
                                objstr_num = di
                        elif i == 2:
                            if xref_type == 0:
                                next_generation = di
                            elif xref_type == 1:
                                generation = di
                            elif xref_type == 2:
                                obstr_idx = di
                    if xref_type == 0:
                        pass
                    elif xref_type == 1:
                        if not self.xref.has_key(generation):
                            self.xref[generation] = {}
                        if not num in self.xref[generation]:
                            self.xref[generation][num] = byte_offset
                    elif xref_type == 2:
                        if not num in self.xref_objStm:
                            self.xref_objStm[num] = [objstr_num, obstr_idx]
                    cnt += 1
                    num += 1
            trailerKeys = "/Root", "/Encrypt", "/Info", "/ID"
            for key in trailerKeys:
                if xrefstream.has_key(key) and not self.trailer.has_key(key):
                    self.trailer[NameObject(key)] = xrefstream.raw_get(key)
            if xrefstream.has_key("/Prev"):
                startxref = xrefstream["/Prev"]
            else:
                break
        else:
            # bad xref character at startxref.  Let's see if we can find
            # the xref table nearby, as we've observed this error with an
            # off-by-one before.
            stream.seek(-11, 1)
            tmp = stream.read(20)
            print tmp
            xref_loc = tmp.find("xref")
            if xref_loc != -1:
                startxref -= (10 - xref_loc)
                continue
            else:
                # no xref table found at specified location
                assert False
                break 
```

注意：我的示例是在最后三行中抛出断言 False

# boost - 这个 boost::lambda::bind 用法有什么问题？

> ID：11937425
> 
> 赞同：2
> 
> 时间：2012-08-13T15:25:32.110
> 
> 标签：boost, boost-bind, boost-function, boost-lambda, boost-signals2

这段代码有问题吗？我不断收到编译错误。基本上我想将一个 void 返回函数连接到一个具有非 void 返回类型的信号。增强版：1.46.1 版

```
#include <boost/signals2.hpp>
#include <boost/lambda/bind.hpp>
#include <boost/lambda/lambda.hpp>
using namespace boost::signals2;

void func()
{
  printf("Func called!");
}

main()
{
  signal<int(int)> sig;
  sig.connect( (boost::lambda::bind(func),  1) );
} 
```

编译时出现以下错误：

```
/opt/include/boost/signals2/detail/slot_template.hpp: In member function ‘void boost::signals2::slot1<R, T1, SlotFunction>::init_slot_function(const F&) [with F = int, R = int, T1 = int, SlotFunction = boost::function<int(int)>]’:
/opt/include/boost/signals2/detail/slot_template.hpp:81:9:   instantiated from ‘boost::signals2::slot1<R, T1, SlotFunction>::slot1(const F&) [with F = int, R = int, T1 = int, SlotFunction = boost::function<int(int)>]’
hello-world-example.cpp:13:51:   instantiated from here
/opt/include/boost/signals2/detail/slot_template.hpp:156:9: error: invalid conversion from ‘int’ to ‘boost::function<int(int)>::clear_type*’ [-fpermissive]
/opt/include/boost/function/function_template.hpp:1110:14: error:   initializing argument 1 of ‘boost::function<R(T0)>::self_type& boost::function<R(T0)>::operator=(boost::function<R(T0)>::clear_type*) [with R = int, T0 = int, boost::function<R(T0)>::self_type = boost::function<int(int)>]’ [-fpermissive] 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T10:09:04.170

似乎在 Boost 版本 1.49 上编译没有问题

# ruby-on-rails - 多对多关系中的映射方法

> ID：11937441
> 
> 赞同：0
> 
> 时间：2012-08-13T15:26:44.813
> 
> 标签：ruby-on-rails, ruby, activerecord

我的应用程序中有以下 3 个模型：

```
class Submission < ActiveRecord::Base
 has_many :linkedsubmissions
end

class Linkedsubmission < ActiveRecord::Base
  belongs_to :submission
  has_many   :lnksubtypes
end

class Lnksubtype < ActiveRecord::Base
  belongs_to :linkedsubmission
end 
```

在下面的代码中 ' `@submission.linkedsubmissions.lnksubtypes`' 是不正确的。

```
@history = Audit.find(:all, :conditions => ["auditable_id IN (?)",@submission.linkedsubmissions.lnksubtypes.map{|b| b.LSU_ID} ]) 
```

我需要在@submission.linkedsubmissions.lnksubtypes 中找到所有带有“auditable_id”的审计

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:50:04.503

您需要将以下`has_many`关系添加到您的`Submission`模型中。

```
class Submission < ActiveRecord::Base
 has_many :linkedsubmissions
 has_many :lnksubtypes, :through => :linkedsubmissions
end 
```

现在，您将能够像这样重新格式化您的查询

```
@history = Audit.find(:all, :conditions => ["auditable_id IN (?)", @submission.lnksubtypes.map(&:LSU_ID) ]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:50:25.563

```
Audit.find(:all, :conditions => ["auditable_id IN (?)",@submission.linkedsubmissions.map{|b| b.lnksubtypes.map{&:LSU_OID) }.flatten ]) 
```

但是应该有更好的方法来仅使用 sql 获取那些 LSU_OID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T16:58:20.477

```
@history = Audit.where(:auditable_id => @submission.lnksubtypes.map(&:LSU_ID)) 
```

略短

# c - 通过引用将字符串数组传递给 C 函数 - 无效指针

> ID：11937444
> 
> 赞同：1
> 
> 时间：2012-08-13T15:26:59.543
> 
> 标签：c, arrays, string, pointers, reference

我在通过 C 中的引用将字符串数组传递给函数时遇到问题。

上下文：我正在尝试用一些命令制作一个非常简单的外壳。当在命令中键入命令时，命令的每个参数都保存在字符串数组的槽中。用于解析命令的函数称为 lineParsing（我没有这个的源代码 - 我只有 .o 和 .h）

有问题的函数具有以下标题：

```
void lineParsing (char **, int, char **, char **, char **, int *);

void lineParsing (char **item, int nargs, char **inputRedir, char **outputRedir, char **errorRedir, int *background); 
```

该函数的描述如下： 指定参数数组（第一个参数）是否包含重定向或后台执行。

输入： 1 - 参数数组 2 - 引用的参数数量： 3 - 用于放置输入重定向文件名称的字符串数组 4 - 用于放置文件名称的字符串数组输出重定向 5-一个字符串数组，用于放置错误重定向的文件名 6-如果使用 &，则在后台保存 1，如果不是 0

我在一个临时主程序中调用这个函数，如下所示：

```
int main (int argc, char *argv[]){
    char **parrayArgumentos=NULL;
    int i,numargs,background;

    char *inputRedir[4]={"","","",""};
    char *outputRedir[4]={"","","",""};
    char *errorRedir[4]={"","","",""};

    parrayArgumentos = lineInput (&numargs); //Asks for command via standard input.
    printf ("You have typed in: %d arguments \n",numargs); //displays number of arguments

    i=0;
    while(i<=numargs-1){
        printf ("%s \n",parrayArgumentos[i]);
        i++;
    }

lineParsing(parrayArgumentos,numargs,inputRedir,outputRedir,errorRedir,&background);
//This call is problematic

    printf ("The command you have introduced has:\n%c for input redirection\n%c for output Redirection\n%s For error Ridirection\n%d background\n",inputRedir[0],outputRedir[0],errorRedir[0],background); 

    freeLineInput(parrayArgumentos);

    return 0;

} 
```

这通过我制作的makefile编译没有错误或警告：

```
mishell: mishell.o parser64.o
    gcc mishell.o parser64.o -o mishell

mishell.o: mishell.c

clean:
    rm -f mishell.o mishell 
```

当我执行二进制文件时，在调用 lineParsing 时出现以下错误：

```
[xxxx@xxxx src]$ ./mishell 
ls -la > listoffiles
You have typed in: 4 arguments 
ls 
-la 
> 
listoffiles 
*** glibc detected *** ./mishell: free(): invalid pointer: 0x0000000000401078 ***
======= Backtrace: =========
/lib/libc.so.6(+0x784a6)[0x7f8a5f76b4a6]
./mishell[0x400d99]
./mishell[0x4007b6]
/lib/libc.so.6(__libc_start_main+0xf5)[0x7f8a5f714725]
./mishell[0x4005e9]
======= Memory map: ========
00400000-00402000 r-xp 00000000 08:04 7865560                            /home/xxxxx/Desktop/xxxx/xxxx/xxxxx/src/mishell
00601000-00602000 rw-p 00001000 08:04 7865560                            /home/xxxxx/Desktop/xxxxx/xxxxx/xxxxx/src/mishell
00e25000-00e46000 rw-p 00000000 00:00 0                                  [heap]
7f8a5f4de000-7f8a5f4f3000 r-xp 00000000 08:03 1185891                    /usr/lib/libgcc_s.so.1
7f8a5f4f3000-7f8a5f6f2000 ---p 00015000 08:03 1185891                    /usr/lib/libgcc_s.so.1
7f8a5f6f2000-7f8a5f6f3000 rw-p 00014000 08:03 1185891                    /usr/lib/libgcc_s.so.1
7f8a5f6f3000-7f8a5f88e000 r-xp 00000000 08:03 2490393                    /lib/libc-2.16.so
7f8a5f88e000-7f8a5fa8d000 ---p 0019b000 08:03 2490393                    /lib/libc-2.16.so
7f8a5fa8d000-7f8a5fa91000 r--p 0019a000 08:03 2490393                    /lib/libc-2.16.so
7f8a5fa91000-7f8a5fa93000 rw-p 0019e000 08:03 2490393                    /lib/libc-2.16.so
7f8a5fa93000-7f8a5fa97000 rw-p 00000000 00:00 0 
7f8a5fa97000-7f8a5fab8000 r-xp 00000000 08:03 2490410                    /lib/ld-2.16.so
7f8a5fc8a000-7f8a5fc8d000 rw-p 00000000 00:00 0 
7f8a5fcb4000-7f8a5fcb8000 rw-p 00000000 00:00 0 
7f8a5fcb8000-7f8a5fcb9000 r--p 00021000 08:03 2490410                    /lib/ld-2.16.so
7f8a5fcb9000-7f8a5fcba000 rw-p 00022000 08:03 2490410                    /lib/ld-2.16.so
7f8a5fcba000-7f8a5fcbb000 rw-p 00000000 00:00 0 
7fff8533d000-7fff8535e000 rw-p 00000000 00:00 0                          [stack]
7fff853ff000-7fff85400000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
Aborted 
```

我在 ArchLinux 3.4.4-2-ARCH x86_64 下使用 gcc 4.7.1

有谁知道为什么会这样？

非常感谢您提前提供的所有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:47:14.823

一个可能的原因是试图释放 中的任何元素`inputRedir`，`outputRedir`或者`errorRedir` *如果*它们没有改变。由于它们被初始化为字符串文字（空字符串），因此将其传递给`free()`是非法的：

> 如果 ptr 是空指针，则不会发生任何操作。否则，如果参数与 calloc、malloc 或 realloc 函数先前返回的指针不匹配，或者如果空间已通过调用 free 或 realloc 被释放，则行为未定义。

`free()`一个推测性的解决方法是将这三个数组的元素初始化为 NULL 指针（将 NULL 指针传递给 是安全的）：

```
char *inputRedir[4]  = { NULL, NULL, NULL, NULL };
char *outputRedir[4] = { NULL }; /* Unspecifed initializers will */
char *errorRedir[4]  = { NULL }; /* be NULL by default.          */ 
```

请注意，`printf()`语句中的格式说明符不正确，因为`inputRedir[0]`(and `outputRedir[0]`) 是 a`char*`但提供的格式说明符是`%c`，它用于 type `char`：use `%s`for `char*`。

# objective-c - 委托和保留周期？

> ID：11937446
> 
> 赞同：2
> 
> 时间：2012-08-13T15:27:07.537
> 
> 标签：objective-c, ios, delegates

编辑：我真的很抱歉。我编辑了我在帖子中犯的令人困惑的错误。

我有这些`ivars`声明`WhereamiViewController.h`：

```
CLLocationManager *locationManager;
IBOutlet MKMapView *worldView;
IBOutlet UITextField *locationTitleField; 
```

作者写道，由于`WhereamiViewController`拥有`locationManager`和`locationManager's`委托是`WhereamiViewController`，`locationManager`委托必须`nil`在`WhereamiViewController's` `dealloc`方法中设置为，因为委托是`assigned`而不是`weak`。在`.xib`文件中`worldView`并`locationTitleField`设置为委托，但是当这两个委托也都不是时`File's Owner`，为什么不需要将这两个委托设置为？`nil``assign``weak`

PS：它使用ARC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:38:38.420

> `locationManager must be set to nil in the WhereamiViewController's dealloc method`

[`CLLocationManager`](http://developer.apple.com/library/ios/DOCUMENTATION/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instp/CLLocationManager/delegate)不保留其代表。即使它确实设置`locationManager`为`nil`in`dealloc`也不会破坏保留周期，因为保留周期将导致`dealloc`永远不会被调用。需要有一些其他事件打破保留周期，例如关闭/弹出视图控制器。

> 但是为什么不需要将这两个设置为零？

如果 t 记录了该类不保留委托，那么您不必担心保留周期。有时文档来自仅查看头文件并寻找`assign`而不是`strong`or `retain`。`CLLocationManager`不保留其委托，因此您不必分配`locationManager`给`nil`. 但是，如果在您的类被解除分配后仍可能收到事件，您应该在方法`locationManager`中将其委托设置为以防止在您的类被解除分配后发生回调。`nil``dealloc`

```
- (void)dealloc
{
    //Prevent callbacks after dealloc
    //Useful if locationManager is a singleton or used elsewhere
    locationManager.delegate = nil;

    [locationManager release]; //If not ARC
    [super dealloc];//If not ARC
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:08:38.173

好吧，您需要将其设置为`nil`仅作为预防措施。我让你困惑了吗？让我解释。

to 的设置`nil`实际上与循环无关`retain` `release`，只是为了避免`locationManager`向您的控制器发送委托调用。例如，如果`locationManager`在您的控制器被释放的同时更新位置，`locationManager`仍然具有`delegate`对您的视图控制器设置的引用，将使用位置参数调用委托。

但是由于您的控制器已被释放，因此该调用将导致错误的内存访问。

但是，如果将其设置为`nil`，则不会引发异常，因为`nil`指针的操作没有任何影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:42:04.430

> `locationManager`在 WhereamiViewController 的 dealloc 方法中必须设置为 nil。

那没有任何作用。

如果你使用手动引用计数，它应该在 WhereamiViewController 的 dealloc 中*释放*（因为 WhereamiViewController 拥有它）。如果你有一个封装了 locationManager 实例变量的属性，你可以在 dealloc 中将该属性设置为 nil 来达到同样的效果，只要该属性是一个保留属性。但是，Apple 通常不鼓励在 dealloc 中使用属性。

如果您使用 ARC，编译器将为您完成所有这些工作。

您在 WhereamiViewController 的 dealloc 中应该做的是将位置管理器的委托设置为 nil，因为如果位置管理器在 dealloc 之后仍然存在，您不希望它向不存在的 WhereamiViewController 发送委托消息。

同样，如果 CLLocationManager 的委托是弱引用，则使用 ARC 会为您完成 nilling。

> 但是为什么不需要将这两个设置为零？

他们没有，但是当他们的代表被解除分配时，同样的推理也适用于他们的代表。

# linux - 有没有办法检查磁盘页面缓存中存在多少文件？

> ID：11937453
> 
> 赞同：3
> 
> 时间：2012-08-13T15:27:29.147
> 
> 标签：linux, linux-kernel

我想看看有多少文件块存储在内核的磁盘页面缓存中。有没有我可以查看的界面来检查这个？也许有什么`/proc`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T07:59:57.713

据我所知，在`/proc`. 跟踪该信息并通过它公开它的开销`/proc`可能会令人望而却步。

正如 Damon 建议的那样，您最好的选择是`mmap()`'ing 文件并使用`mincore()`.

**更新**：我编写了这个`mincore()`想法，它似乎按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T10:39:24.027

您可以使用[fincore](http://code.google.com/p/linux-ftools/)。这是相当不错的。

# extjs4 - 使用休息调用收到的数据渲染雷达图

> ID：11937455
> 
> 赞同：0
> 
> 时间：2012-08-13T15:27:33.870
> 
> 标签：extjs4, radar-chart

我有一个从 json 文件读取时呈现的雷达图。我为此目的使用了听众。现在，我需要将其升级为休息通话。我有一个休息电话，当我单击一个按钮时会触发。此 rest 调用将数据返回到存储和数据模型。我想使用这些数据渲染雷达图。所以每次单击按钮时，都会返回一组新数据。每次接收到新数据时，如何实现雷达图的渲染？

如果需要任何代码，请随时索取。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:17:04.193

我最初使用侦听器渲染模拟图表。在按钮单击时，我使用一组不同的数据模型、存储和侦听器（在按钮的处理函数中）。每次单击按钮时，此存储都会触发 rest 调用并加载新图表。

# jpa - EJB3.0 用相同的值更新表中的字段

> ID：11937457
> 
> 赞同：0
> 
> 时间：2012-08-13T15:27:38.287
> 
> 标签：jpa, ejb-3.0

我有一个数据库表“MyTable”，它在更新字段“状态”时触发。

下面是我正在尝试做的虚拟代码：

```
MyTable table = new Mytable();
table.setTableId(1);
table.setStatus ("NEW");
em.persist (table); //At this point the trigger did not kick in since this inserted a new record

...

MyTable table2 = em.find(MyTable.class, 1);
table2.setStatus ("NEW"); 
em.merge(table2)//Even though im updating the record with the same status with the same value, i still want the trigger to kick. However the trigger is not being activated.

...

MyTable table3 = em.find(MyTable.class, 1);
table3.setStatus ("OLD"); 
em.merge(table3)//The trigger is being activated here since the status is different the status value when it was inserted the first time. 
```

长话短说，即使状态相同，我如何才能对“transfer2”进行更改以触发更新？

-谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:08:56.157

用于`em.flush();`将持久性上下文同步到底层数据库。您的待处理查询应发送到数据库，但您仍然可以完全回滚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T11:36:38.410

您能否尝试更新实体并提交事务，而不使用合并。

像

```
em.getTransaction().begin();
MyTable table2 = em.find(MyTable.class, 1); 
table2.setStatus ("NEW");  

//em.merge(table2)//Even though im updating the record with the same status with the
// same value, i still want the trigger to kick. However the trigger is not being activated.  
em.getTransaction().commit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T13:56:24.827

JPA 不会更新没有更改的对象。

您可以尝试更改为其他内容（刷新），然后将其更改回来。

您还可以使用 JPQL 更新查询来更新它。

根据您的 JPA 提供程序，您可能会强制它更新未更改的字段，但这会导致非常糟糕的性能。

# javascript - 如何在 blueimp jquery 下载程序中过滤要下载的文件

> ID：11937462
> 
> 赞同：1
> 
> 时间：2012-08-13T15:27:43.883
> 
> 标签：javascript, jquery, ajax, blueimp

我正在尝试使用 Blueimp jQuery File Upload File 程序[https://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)。我搜索了 wiki 和文档，但找不到如何过滤可供下载的文件的答案。

我在经过验证的“受保护”区域内使用它。我已经成功地为所有上传的文件添加了一个唯一的 id（例如 UID-filename.jpg ），我将在经过身份验证的会话中使用它。所以我所要做的就是只选择具有正确 UID 的那些。

显示下载表的 jquery 代码是：

```
<!-- The template to display files available for download -->
<script id="template-download" type="text/x-tmpl">
{% for (var i=0, file; file=o.files[i]; i++) { %}
<!--    <tr class="template-download fade">-->
    <tr class="template-download ">
    {% if (file.error) { %}
        <td></td>
        <td class="name"><span>{%=file.name%}</span></td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
    {% } else { %}
        <td class="preview">{% if (file.thumbnail_url) { %}
            <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
        {% } %}</td>
        <td class="name">
            <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
        </td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td colspan="2"></td>
    {% } %}
    <td class="delete">
        <button class="btn btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}">
            <i class="icon-trash icon-white"></i>
            <span>{%=locale.fileupload.destroy%}</span>
        </button>
        <input type="checkbox" name="delete" value="1">
    </td>
</tr> 
```

我在 JS/Jquery 方面不是很有经验。我会很感激任何关于下一步做什么的想法。是否有人熟悉过滤这些文件的设置/选项。或者，我假设该文件是我怀疑可以过滤的文件名或路径数组。在 PHP 中，我可能会使用 glob 函数。有没有人在 JS 中有这方面的经验？

先感谢您，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-17T20:00:59.860

use the plugin [http://sunnywalker.github.io/jQuery.FilterTable/](http://sunnywalker.github.io/jQuery.FilterTable/) It works on any table and is easy to deploy.

Include dependencies:

```
<script src="/path/to/jquery.js"></script>
<script src="/path/to/bindWithDelay.js"></script> <!-- optional -->
<script src="/path/to/jquery.filtertable.js"></script>
<style>
    .filter-table .quick { margin-left: 0.5em; font-size: 0.8em; text-decoration: none; }
    .fitler-table .quick:hover { text-decoration: underline; }
    td.alt { background-color: #ffc; background-color: rgba(255, 255, 0, 0.2); }
</style> <!-- or put the styling in your stylesheet --> 
```

enter the code

```
<script>
$('table').filterTable(); //if this code appears after your tables; otherwise, include it in your document.ready() code.
</script> 
```

Okay! Good luck!

# c# - 如何将（错误的）12:00 时间转换为 2400 时间？

> ID：11937463
> 
> 赞同：1
> 
> 时间：2012-08-13T15:27:44.290
> 
> 标签：c#, time-format

我这里有点问题，我自己要放弃了，希望这里的专家能帮助我挽救我的数据。

我有一个程序来收集一些财务数据。数据格式如下

时间、数据

时间、数据

...

它是文本格式，我有大约 30 个文件，每个文件大约 1-2 GB。我遇到的问题是当我第一次启动它时，我不小心将其格式化为 12 小时时间格式“yyyy/MM/dd hh:mm:ss.fff”而不是 2400 小时时间“yyyy/MM/dd HH:mm ：ss.fff”。

现在我的数据是没有上午/下午的 12 小时格式。

我现在需要编写一个程序将 12 小时格式转换为 2400 格式。我面临的问题如下：

1.  数据大致按时间顺序排列。时间戳来自数据服务器，取决于互联网流量，顺序可能为 1 秒左右。但考虑到我收集的数据量，它可能有多达 100000 行乱序。

2.  没有上午/下午，1200 可能是上午 1200（我需要从中减去 12 小时）或下午 1200，我什么都不做。

3.  文件的开头可能在任何给定时间开始（我手动打开程序来收集，所以时间不准确），所以如果不向前看，看看天的变化，我不知道 10:00 是上午还是下午

我尝试转换之前的时间但不成功。任何人都可以通过提供一些代码或伪代码来帮助我吗？

编辑：现在我可以准确地说出我的问题，我需要从数据中确定我是处于 AM 模式还是 PM 模式，如果没有那么多行，我可能可以使用 excel 并更正它，手动查看下一个几行并推断它是AM模式还是PM模式。有 1/20 亿行，我需要对其进行逻辑编程以确定它是 AM 还是 PM 模式，我很难这样做。以及如何处理在过渡期间出现问题的那几分钟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:53:28.883

假设记录之间的时间间隔不超过 12 小时，您的转换程序只需要跟踪它当前查看的是上午时间还是下午时间。然后，每当小时数达到 12 或转为较低的数字时，您切换 AM/PM 标志。您必须提供一个参数，告诉它以哪种模式启动。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-13T15:42:25.890

上午 12 点是 0000，下午 12 点是 1200，但凌晨 1 点是 0100，下午 1 点是 1300（所以它不仅仅是从上午 12 点减去 12。

如果您将时间读入**DateTime**对象，则与使用 .AddHours(double) 一样简单

```
myDateTime=myDateTime.AddHours(12);//Add 12 hours
//Or
myDateTime=myDateTime.AddHours(-12);//Subtract 12 hours 
```

您如何决定是处于 AM 还是 PM 模式取决于您，我不太明白为什么您无法解决问题，因为您说数据是随时生成的。

我会说如果你在字符串上运行“yyyy/MM/dd hh:mm:ss.fff”（没有上午/下午的 12 小时格式）。

*   如果它有效，您知道：日期仍处于上午/下午模式或上午 24 小时格式
*   如果失败，您知道：日期处于 24 小时模式并且它是 PM（因为它将超出 12 小时模式的范围）

使用格式“yyyy/MM/dd HH:mm:ss.fff”应该始终解析您的字符串，并且您知道以下内容：

*   如果它真的是上午时间，那么你有正确的日期。
*   如果时间超过 12:59，您将获得 PM 的正确日期（因为它以 24 小时格式报告）
*   如果日期应该是 PM 时间，但读取为 AM 时间，那么您知道您是 12 小时格式，并且需要检查前面或后面的行来尝试确定它应该是 AM 还是 PM。

您可能可以根据该信息和任何其他日期/时间信息设计某种逻辑来获得您想要的结果。

编辑：

您可以做的是查看文件修改时间（或创建时间，如果可以的话），这应该为您提供 AM 或 PM。然后，您应该知道第一个（或最后一个）条目是否是 AM/PM，然后可以从那里继续。

示例：如果最后输入的时间是 11:00 (AM)，然后下一行是同一天的 3:00，则您会知道它是 3:00 (PM)。但是，如果日期发生变化，您可能无法判断条目是否从上午/下午开始。查看某一天的所有数据可能会给您答案。如果当天的条目仅来自上午或仅来自下午，您将无法确定。

# macros - NSIS 难以移动文件夹

> ID：11937466
> 
> 赞同：0
> 
> 时间：2012-08-13T15:27:56.920
> 
> 标签：macros, directory, nsis

我有一个寻找旧版本的安装程序，作为卸载过程的一部分，将它备份到一个文件夹中。

对于备份，我尝试过`Rename`（有时会失败），`CreateDirectory`然后`CopyFiles`删除它们（耗时，大量文件和目录），并且更喜欢使用[Move Folder](http://nsis.sourceforge.net/MoveFileFolder)，其中每个功能都替换为其非版本（如`.MoveFolder_Locate_moveFile`-> `un.MoveFolder_Locate_moveFile`） .

```
StrCpy $switch_overwrite 1
!insertmacro un.MoveFolder "$INSTDIR" "$BACKUP_FOLDER" "*.*" 
```

它工作正常...

然而，我正在启动卸载程序：

```
ExecWait '$R0' 
```

一旦我将其更改为

```
ExecWait '$R0 _?=$INSTDIR' 
```

MoveFile 给出错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:53:57.587

在没有 _?= 的情况下运行卸载程序会导致卸载程序将自身复制到 $temp，然后从那里运行一个新实例（无需等待）。您应该尝试混合使用；将卸载程序自己复制到 $temp 并使用 _?=$instdir 运行它，这应该允许您等待进程而不锁定 $instdir ...

# iphone - 将 iOS 上的 printf 重定向到用户界面

> ID：11937467
> 
> 赞同：2
> 
> 时间：2012-08-13T15:27:59.313
> 
> 标签：iphone, objective-c, ios, multithreading, pipe

我是 iOS 开发（和 Obj-C）的新手，我正在尝试将现有的 C 程序移植到 iOS。

C程序通常在控制台中运行，但我想在iPhone上为它制作一个UI。我已经移植了 C 代码，当模拟器运行时，我可以在控制台窗口中获得 printf 输出。我想尽可能避免更改原始代码，所以这是我的计划：

1.  该程序需要一些时间来执行，所以我想我需要在单独的线程上运行它。看起来我只需要一个 NSInvocationOperation 来调用它的主要方法。
2.  我会将标准输出重定向到管道。
3.  在另一个线程上，我将从管道中读取，并将其扔给 UI。我不确定为此使用的最佳并发 API 是什么。

这对 iOS 来说是一个好的策略，还是有更好的移植方法？有什么我应该注意的陷阱吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:40:57.937

对于并发，使用调度队列进行最快的编程。[请参阅本指南：http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html)

要打印到屏幕上，您可以通过多种不同的方式执行此操作，但`UILabel`如果您只想立即将文本显示在屏幕上，只需使用 a。您也可以稍后很好地格式化它。

多线程的主要缺陷就像在任何操作系统上一样——锁定任何同时读/写的数据模型。您可以通过使用上面链接指南中的说明来使用`@synchronize`或使您的调度队列线程安全。`dispatch barriers`

# php - 将选定图像文件夹下的所有图像重定向到 PHP 文件

> ID：11937468
> 
> 赞同：0
> 
> 时间：2012-08-13T15:28:01.323
> 
> 标签：php, apache, .htaccess, mod-rewrite

我一直在挖掘，但也许我错过了。

我希望 /images/user-images 下的所有图像都重定向到 php 文件。

示例：[http ://domain.com/images/user-images/Montreal/private/2012_08_10/YzAbCdE.jpg](http://domain.com/images/user-images/Montreal/private/2012_08_10/YzAbCdE.jpg)

转到[http://domain.com/photo](http://domain.com/photo)

但我希望能够知道他们仍然要求的图像。URL 路径不需要更改，只要请求该路径，他们就可以在网页上获取图像，以便我可以对其进行皮肤处理。

这是我目前正在使用的 mod 重写。

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
RewriteRule ^css/.*$ - [PT]
RewriteRule ^js/.*$ - [PT] 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:34:05.400

```
RewriteRule ^images/user-images/(.*)$ /my-php-file.php?image=$1 
```

`$_GET['image']`请求的图像将以`Montreal/private/2012_08_10/YzAbCdE.jpg`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:01:42.293

Mod_rewrite 对此太过分了。这也可以

> 别名 /images/user-images /photo

# jquery - 从图像中删除未知的 css 元素，仅在 IE 中

> ID：11937469
> 
> 赞同：1
> 
> 时间：2012-08-13T15:28:02.120
> 
> 标签：jquery, html, css, internet-explorer

使用 IE 查看我的页面时，我得到了这些似乎无法删除的图像的未知 CSS 元素。 **奇怪的 3d 样式图像插图类型的东西。** 我在 Chrome 中**没有这个问题。**这个问题不是网站破坏，但我想解决这个问题。

[http://www.cashgrainbids.com/ie_issue.png http://www.cashgrainbids.com/ie_issue.png](http://www.cashgrainbids.com/ie_issue.png)

HTML

```
 <img src="" id="areaMappingToggle" class="toggleImageClose" alt=""/> 
```

CSS

```
 .toggleImageOpen
    {
    float: right;
    margin: 0px;
    width: 12px;
    height: 12px;
    display: inline;
    background: url(../Images/Basis/arrow_open.png) no-repeat;
    background-position: 0 0;
    overflow: hidden;
    }

    .toggleImageOpen:hover
    {
    background-position: 0px -12px;
    cursor: pointer;
    }

    .toggleImageClose
    {
    float: right;
    margin: 0px;
    width: 12px;
    height: 12px;
    display: inline;
    background: url(../Images/Basis/arrow_close.png) no-repeat;
    background-position: 0 0;
    overflow: hidden;
    }

    .toggleImageClose:hover
    {
    background-position: 0px -12px;
    cursor: pointer;
    } 
```

我已经尝试了所有我能想到的 CSS 更改并在网上搜索了这个问题，但找不到任何类似的东西。任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:42:09.367

IE 无法加载图像时会显示此边框。从您的样式中删除背景图像并将路径放在 img 元素的 src 属性中或将`img`元素更改为 a`<div>`或`<span>`

# git - id_rsa* 的 ssh 密钥设置问题

> ID：11937473
> 
> 赞同：0
> 
> 时间：2012-08-13T15:28:14.070
> 
> 标签：git, ssh, github

我正在尝试设置我的 ssh 密钥，但出现此错误。

```
$ rm id_rsa*

rm: id_rsa*: No such file or directory

$ cp id_rsa* key_backup

cp: id_rsa*: No such file or directory 
```

这是一个主要问题，还是我可以跳过？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:37:10.677

你在 .ssh 目录中吗？试试 sudo ls ~/.ssh 看看你那里有没有钥匙

# c# - 如何确定图像中的最大颜色？

> ID：11937474
> 
> 赞同：2
> 
> 时间：2012-08-13T15:28:16.810
> 
> 标签：c#, image-processing

我在 C# 应用程序中有一个图片框。

我想从图像中确定最大数量的颜色，即覆盖图像最大区域的颜色。是否有任何第三方工具可以帮助我这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:32:19.613

您可以使用 256*256*256 int 数组来存储图片中每个点的 RGB 值的所有出现次数，这将占用 64 MB 的空间和一些迭代。

就像是：

```
occurences = int[256][256][256] 
for x in picture.width()
    for y in picture.height()
        p = point(x,y) in picture;
        occurences[p.red][p.blue][p.green]++;

Find max value in occurences 
```

# testing - 如何为一个完整的页面构建 UIMap，而不是记录某些动作？

> ID：11937481
> 
> 赞同：0
> 
> 时间：2012-08-13T15:28:35.503
> 
> 标签：testing, user-interface, coded-ui-tests

我正在做一些编码的 UI 测试。我想为被测页面生成一个 UIMap 类。

有没有有效的方法或工具来做到这一点？我不想一一点击页面上的所有控件。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:42:13.563

这听起来是个好主意，但可能不是。任何给定的“页面”或控件组......实际上可能是数十个甚至可能是数百个 UI 元素。用户可以与之交互的实际控件可能非常小。

您不希望每个标签和每个边框等都破坏可用选项。因此，虽然单击每个控件以使其在地图中显示很痛苦，但最好还是让您的测试保持简洁和健壮。

此外，如果用户在一个“页面”上实际交互的一大堆控件，我什至建议为“页面”的各个部分创建单独的 UIMap。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T17:38:25.840

这根本不是一个好主意。您将希望尽可能多地分解您的 CUIT。如果您将每个控件都放在一个 UIMap 中，则地图可能会变得太大，从而导致调试最简单的事情的时间增加。

将 CUIT 分解为单独的 UIMap 的另一个原因是，如果 UIMap 中的某个控件发生问题（比如您不小心删除了它）并且您无法修复它，您将需要从头开始！重做几个控件比重做整个页面要容易得多。

# point-of-sale - 如何为 Ingenico 5100 创建应用程序

> ID：11937485
> 
> 赞同：1
> 
> 时间：2012-08-13T15:28:42.917
> 
> 标签：point-of-sale

我想为inggenico 5100 构建应用程序。它必须从链接下载数据并打印。例如[http://domain.com/data.txt](http://domain.com/data.txt)或[http://domain.com/data.xml](http://domain.com/data.xml)此操作应定期执行。我为 windowsCE 创建了应用程序，但 ingenico OS 不同。你能帮我这个话题吗？我只是想听听你的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T13:29:08.113

您需要 Ingedev(Ingenico SDK) 在 i5100 等设备上开发应用程序。您可以从 Ingenico 获得此 SDK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T17:46:26.980

或者，您可以使用 RxTx (java lib) 通过串行端口实现 Concert 协议。

# django - 模型多对多字段 Django 中的异常

> ID：11937487
> 
> 赞同：1
> 
> 时间：2012-08-13T15:28:46.813
> 
> 标签：django, django-models

我需要自己对模型提出请求：

```
class Course(models.Model):
    owner = models.ForeignKey(User, related_name='course', limit_choices_to={'userprofile__status': 'teacher'})

class Assignment (models.Model):
    course = models.ForeignKey(Course, related_name='assignment')
    admins = models.ManyToManyField(User, blank=True, null=True, limit_choices_to={'userprofile__status': 'teacher'}) 
```

我需要管理员包含没有所有者的所有用户（以教师为状态）。我尝试过使用 Q 对象，但没有成功...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:42:33.630

我不确定您是否可以在模型上正确执行此操作，但如果可以的话，可以使用`F`. 就像是：

```
from django.db.models import Q, F

...

limit_choices_to=Q(userprofile__status='teacher') & ~Q(id=F('owner_id')) 
```

你必须使用`Q`，因为你不能用字典模式断言否定。`~`否定第二个并`Q`用于`F('owner_id')`选择所有者的值。

不过，就像我说的那样，我自己没有尝试过这样做，所以我不能说它是否会起作用。你只需要试一试，然后告诉我们。

# bash - 基于 cammand 输出/完成的 Shell if 语句

> ID：11937488
> 
> 赞同：1
> 
> 时间：2012-08-13T15:28:47.387
> 
> 标签：bash, shell

我已经在互联网上搜索了这个答案，但可惜找不到。

在 PHP 中，我可以在 if 块中运行命令，就像这样

```
if(command(blah)) {} else {} 
```

因为每个函数都会返回一个真/假值。我可以在 shell 脚本中做同样的事情吗？我想根据命令是否正确运行来回显输出。运行的推荐是：

```
find . -type d -exec sudo chmod -R 775 {} \\; 
```

我想输出它运行成功或失败，然后继续执行另一个命令。

我可以将命令运行到变量或类似的东西中吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:31:07.047

Shell 命令通常返回一个指示成功或失败的退出代码，`0`指示成功，其他任何指示某种错误（具体取决于您正在运行的命令）。

您可以在 if 语句中测试此退出代码：

```
if my_command; then
  echo It worked.
fi 
```

您还可以使用`||`and`&&`运算符将命令链接在一起。

```
my_command && echo It worked.
my_command || echo It failed. 
```

您使用该命令的具体示例`find`有点棘手。该`chmod`命令可能会失败，但该`find`命令仍将“成功”完成。这样的事情可能会有所帮助：

```
find . -type d -exec sudo sh -c 'chmod -R 775 {} || echo "FAILED {}"' \; 
```

这将打印...

```
FAILED ./path/to/directory 
```

...对于它失败的任何地方，所以你可以检查输出。但我不确定这是绝对必要的。在少数情况下您的命令会失败：例如，在只读文件系统上，或者可能在 NFS 挂载上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:18:00.163

我的看法是：

```
find . -type d|while read directory
do
  chmod -R 755 ${directory}
  if [ $? = 0 ];then
     echo "successfully changed ${directory}
  else
     echo "Did not change ${directory}
  fi
done 
```

这打破了它并且更具可读性，您可以测试每个命令。美元？是用成功（0）或失败（1或更大）填充的变量

# c# - 对 WebSphere MQ Queue 进行原子更新

> ID：11937489
> 
> 赞同：1
> 
> 时间：2012-08-13T15:28:48.687
> 
> 标签：c#, ssis, queue, ibm-mq, bids

我正在使用用 C# 编写的 SSIS 脚本任务写入 IBM WebSphere MQ 队列。目前，我们使用几个简单的循环将我们需要的信息收集到一个 Dictionary 对象中，然后将这些项目一个接一个地放入队列中。然而，我们现在正在从 SQL 数据库中提取数据，我需要使这些更新成为原子更新。

这是用于将信息添加到字典的代码

```
 //add to list so we can weed out the duplicates
   if (!qContents.ContainsKey(retrievedMessage.Substring(0, 13)))
   {
        qContents.Add(retrievedMessage.Substring(0, 13), retrievedMessage);
   } 
```

这是他们被添加到队列中的地方。MqPut 方法用于将每个项目单独发布到队列中。

```
 //write out unique agent ids to consolidated queue
   foreach (string agentItem in qContents.Values)
   {
        MqPut(agentItem, _outputQueue);
   } 
```

整个代码块包含在 try/catch/finally 块中，所以我确信我必须以某种方式利用它，但是我对 WebSphere MQ 很陌生，不知道如何使用。谢谢！

编辑使用下面答案中的代码会导致抛出异常。一旦程序到达 MQMessage 对象的“put”方法，就会抛出 MQ 异常“MQRC_FUNCTION_NOT_SUPPORTED”。这是 _COMPlusExceptionCode = -532459699

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T04:11:09.120

我给你的建议：

1.  阅读一些关于 Messaging 和 WebSphere MQ 的信息。
2.  查看 WebSphere MQ C# 示例（位于`<mq_installation>\tools\dotnet\samples\cs\base`文件夹下）。
3.  写一些样本让自己舒服。

要使其具有原子性，您可以使用 WebSphere MQ 的 XA 事务特性。您基本上需要将您的工作包装在 Transaction 范围内。示例伪代码段。

```
// Open queue
MQQueue q = MQQueueManager.AccessQueue( ...);

using (CommittableTransaction transScope = new CommittableTransaction())
{
      CommittableTransaction.Current = transScope;

      try
      {
          MQMessage mqMsg = new MQMessage();

          // Add message contents
          mqMsg.Write(<data>);
          q.Put(mqMsg);

          transScope.Commit();
      }
      catch (Exception ex)
      {
           transScope.Rollback();
           Console.Write(ex);
      }
      CommittableTransaction.Current = null;
    } 
```

顺便说一句，我有兴趣了解`MqPut`方法？这是您自己的方法还是由某个库提供的？

# svn - Subversion - 我需要备份什么？

> ID：11937491
> 
> 赞同：4
> 
> 时间：2012-08-13T15:29:03.037
> 
> 标签：svn, repository, backup

我有一个关于 Subversion 的问题。我一直是最终用户，所以我对它实际工作原理的了解是，好吧，让我们说非常有限（所以如果这是一个愚蠢的问题，请原谅）。

我已经安装了 WAMP，并使用它进行了初步开发和测试。因此`C:\wamp\www\`包含我当时正在处理的代码，我使用`http://localhost/template/`

然后我决定使用我在[http://www.codinghorror.com/blog/2008/04/setting-up-subversion-on-windows.html](http://www.codinghorror.com/blog/2008/04/setting-up-subversion-on-windows.html)找到的说明安装 Subversion 。我使用以下命令安装`c:\svn`并创建并添加了我的项目：`c:\svn\repository`

```
svn mkdir svn://localhost/template 
```

我现在结帐，`C:\wamp\www\`这意味着我现在有一个如下所示的目录结构：

`C:\wamp\www\template`其中包含称为分支、标签、主干和网站的文件夹。网站文件夹包含项目的代码，我使用`http://localhost/template/website`

**现在回答我的问题**

`svn://localhost/template`保存到的物理位置是什么？因此，当我在工作副本中进行更改`C:\wamp\www\template`并提交它们时，*它会保存到哪里？它是否包含原始文件的副本？*

为什么我问：我试图弄清楚**备份我的存储库的内容/方式**。在我看来，我认为我应该只需要备份**c:\svn\repository**但是当我在那里查看时，我看不到任何代码。

感谢您的帮助，非常感谢。安吉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:38:36.203

得到一个想法：

**颠覆将您的源代码保存在哪里？**

检查问题：[使用 Subversion，“实际”源代码存储在哪里？](https://stackoverflow.com/questions/1763167/using-subversion-where-is-actual-source-code-stored)

**备份颠覆存储库的最佳方法是什么？**

检查问题： [备份颠覆存储库的最佳方法是什么？](https://stackoverflow.com/questions/33055/what-is-the-best-way-to-backup-subversion-repositories)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:34:52.410

c:\svn\repository 文件夹是保存签到的位置。如果您查看那里，您应该会看到 \db\revs\ - 此文件夹包含有关签入的信息（尽管不是易于阅读的格式。）

您应该备份 c:\svn\repository。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:37:02.433

你是对的，你只需要备份 C:\svn\repository。您看不到您的代码，因为它没有存储在目录树中。它存储在文件夹 C:\svn\repository\db\revs 中的文件中。

在您的工作副本中，您的目录结构的每个文件夹中都有隐藏的 .svn 文件夹。在这些文件夹中是您进行最后一次 SVN 更新或 SVN 提交时的代码版本。

# javascript - 查找所选项目是否在集合中

> ID：11937493
> 
> 赞同：-2
> 
> 时间：2012-08-13T15:29:08.273
> 
> 标签：javascript, jquery

我在这个奇怪的大杂烩代码中使用了一些 jquery 和 javascript。

```
var SELECTED_ELEMENT;  //this ends up being a JS array of ELEMENTS like the following line.
SELECTED_ELEMENT.push($(this).closest(".draggable"));
//Now i wanted to select stuff
$(".draggable").click(function(){
   var found = 0;
   for (var i = 0; i < SELECTED_ELEMENT.length; i++){
      if(SELECTED_ELEMENT[i] == this){
         found = 1;
      }
   }
   if(found == 1){
      alert("yep");
   }else{
      alert("nope");
   }
});
//this doesnt seem to do what i want. 
```

手头的问题是，这永远不会返回真实，即使它是真实的。我只是想找到一种在 javascript 中搜索数组的方法。您会认为通过数组进行简单搜索就可以解决问题，但可能是对“this”的不正确引用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:33:36.037

有一些问题，比如`int found = 0`甚至不是javascript。然后你将 jQuery 对象推送到一个数组，并将它们与 dom 元素进行比较。

而是推送元素：

```
var selectedElements = [],

    closest = $(this).closest(".draggable")[0];

if( closest ) {
    selectedElements.push( closest );
}

$(".draggable").click( function() {
    var index = selectedElements.indexOf(this);

    alert( index > -1 ? "yep" : "nope" );
}); 
```

演示：http: [//jsfiddle.net/sqj42/](http://jsfiddle.net/sqj42/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:31:46.973

在您的第二行中，您有`SELECT_ELEMENT`而不是`SELECTED_ELEMENT`.

这更短：

```
if(SELECTED_ELEMENT.indexOf(this) != -1)
    alert('yep');
else
    alert('nope'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:36:25.423

我正在寻找的真正答案是：

我的搜索是错误的。它应该是：

```
var found = 0;
for(var i = 0; i < SELECTED_ELEMENT.length; i++){
   if ( this == SELECTED_ELEMENT[i][0] ){  //the key is the extra [0] as the stored element is a jquery object, so it needs to be de-referenced by selecting the object itself and not the jquery wrapper-thingy for it..
      found = 1;
   }
}
if(found == 1){
    alert("yep");
}else{
    alert("nope");
} 
```

# csv - 如何使用空格分隔的键访问值？

> ID：11937495
> 
> 赞同：2
> 
> 时间：2012-08-13T15:29:09.287
> 
> 标签：csv, map, clojure

当我有一个以空格分隔的键时，如何在不重新创建键的情况下使用它来提取值？

我有一组潜在的键，实际上是列名，作为从 clojure-csv 返回的数据中的第一个序列：（这是为了避免滚动而格式化的。）

```
["AGY/DIV " "STS" "GIC-ID     " 
"LAST-NAME      " 
"FIRST-NAME     " 
"COVERAGE DESCRIPTION                                   " 
"PREMIUM  " 
"RUN-DATE" 
"BIL MO "] 
```

然后我从这一行创建密钥，并将密钥与每个后续数据行（序列）压缩映射：

```
(defn create-map-keys
  "Takes a sequence, and turns it into viable keys for a map."
  [in-seq]
  (map (fn [element] (keyword element)) (map #(cstr/trim %1) in-seq)))

; gic-csv-keys    
(:AGY/DIV :STS :GIC-ID :LAST-NAME :FIRST-NAME 
:COVERAGE DESCRIPTION :PREMIUM :RUN-DATE :BIL MO) 

(defn zip-apply-col-nams
   [col-keys row]
   (zipmap col-keys row)) 
```

对于测试数据，我将键压缩到 csv 数据的第二行。

```
(def zm2 (zip-apply-col-nams gic-csv-keys (first gic-csv-data))) 
```

当我尝试从`:COVERAGE DESCRIPTION`键中提取值时，出现此错误

```
 (:COVERAGE DESCRIPTION zm2)
CompilerException java.lang.RuntimeException: Unable to resolve symbol: DESCRIPTION in this context, compiling:(NO_SOURCE_PATH:23) 
```

但是，这有效：

```
(zm2 (keyword "COVERAGE DESCRIPTION"))
"HARVARD PILGRIM FAMILY - INSURED                       " 
```

我应该修改空格分隔的键以用例如破折号替换空格，还是有另一种方法来引用键而不重新创建它？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T16:42:26.673

`(keyword "some key")` does not "recreate" a keyword, it *interns* a keyword, meaning that it will always return the same keyword object when given the same name. You can also store the returned keyword and re-use it that way:

```
(def coverage-description (keyword "COVERAGE DESCRIPTION"))

(coverage-description my-row-map) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T06:03:38.220

For the record: "some key" is (at the moment) not a valid keyword in Clojure. You should either replace the whitespace with - or _. Or you should go with plain strings as keys and use `get`.

# java - 手动删除目标文件夹后无法构建 Maven 项目

> ID：11937499
> 
> 赞同：0
> 
> 时间：2012-08-13T15:29:36.863
> 
> 标签：java, eclipse, maven

我想签入svn中的代码并且不想保存二进制文件，所以我删除`Target`了由maven自动创建的文件夹。问题是自从我这样做以来，maven build 就失败了。

这是我尝试过的所有内容：

1.  `mvn clean install`
2.  `mvn clean compile -DskipTests=true install`
3.  手动清理所有文件夹并重新构建。
4.  Eclipse 能够构建它。

有趣的是，eclipse 不再显示标题`Maven Dependencies`为该项目的子节点，因为其他项目工作正常。我根本没有修改 POM 文件。

Pastebin 在此处被阻止，因此在此处附加构建输出。

任何帮助将不胜感激！

```
[INFO] 23 errors
[INFO] -------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO]
[INFO] Extractors ........................................ SUCCESS [0.125s]
[INFO] GenericExtractor .................................. FAILURE [0.687s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.968s
[INFO] Finished at: Fri Aug 10 15:36:44 EDT 2012
[INFO] Final Memory: 5M/15M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project GenericExtractor: Compilation failure: Compilation failure:
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\DelimitedExtractor.java:[8,23] package org.apache.log4j does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[11,23] package org.apache.log4j does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[13,37] package com.ABCInc.ef.common.core.caching does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[14,37] package com.ABCInc.ef.common.core.caching does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\DelimitedExtractor.java:[17,22] cannot find symbol
[ERROR] symbol  : class Logger
[ERROR] location: class com.ABCInc.ef.extractors.core.DelimitedExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[5,31] package org.springframework.util does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[22,22] cannot find symbol
[ERROR] symbol  : class Logger
[ERROR] location: class com.ABCInc.ef.extractors.core.CoreExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[6,23] package org.apache.log4j does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[7,34] package org.springframework.context does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[8,42] package org.springframework.context.support does not exist
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[19,22] cannot find symbol
[ERROR] symbol  : class Logger
[ERROR] location: class com.ABCInc.ef.extractors.application.Launcher
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[22,38] cannot find symbol
[ERROR] symbol  : variable Logger
[ERROR] location: class com.ABCInc.ef.extractors.core.CoreExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[148,3] cannot find symbol
[ERROR] symbol  : class ICacheManager
[ERROR] location: class com.ABCInc.ef.extractors.core.CoreExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\CoreExtractor.java:[148,32] cannot find symbol
[ERROR] symbol  : variable CacheManagerFactory
[ERROR] location: class com.ABCInc.ef.extractors.core.CoreExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\DelimitedExtractor.java:[17,38] cannot find symbol
[ERROR] symbol  : variable Logger
[ERROR] location: class com.ABCInc.ef.extractors.core.DelimitedExtractor<TKey,TValue>
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[15,15] cannot find symbol
[ERROR] symbol  : variable ReflectionUtils
[ERROR] location: class com.ABCInc.ef.extractors.core.FieldInfo
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[16,2] cannot find symbol
[ERROR] symbol  : variable ReflectionUtils
[ERROR] location: class com.ABCInc.ef.extractors.core.FieldInfo
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[49,15] cannot find symbol
[ERROR] symbol  : variable ReflectionUtils
[ERROR] location: class com.ABCInc.ef.extractors.core.FieldInfo
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[55,15] cannot find symbol
[ERROR] symbol  : variable ReflectionUtils
[ERROR] location: class com.ABCInc.ef.extractors.core.FieldInfo
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\core\FieldInfo.java:[78,15] cannot find symbol
[ERROR] symbol  : variable ReflectionUtils
[ERROR] location: class com.ABCInc.ef.extractors.core.FieldInfo
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[19,38] cannot find symbol
[ERROR] symbol  : variable Logger
[ERROR] location: class com.ABCInc.ef.extractors.application.Launcher
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[28,2] cannot find symbol
[ERROR] symbol  : class ApplicationContext
[ERROR] location: class com.ABCInc.ef.extractors.application.Launcher
[ERROR] \ABCInc\DEV\GemFireCode\src\java\Extractors\GenericExtractor\src\main\java\com\ABCInc\ef\extractors\application\Launcher.java:[28,30] cannot find symbol
[ERROR] symbol  : class ClassPathXmlApplicationContext
[ERROR] location: class com.ABCInc.ef.extractors.application.Launcher
[ERROR] -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project GenericExtractor: Compilation failure
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:213)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.CompilationFailureException: Compilation failure
        at org.apache.maven.plugin.AbstractCompilerMojo.execute(AbstractCompilerMojo.java:656)
        at org.apache.maven.plugin.CompilerMojo.execute(CompilerMojo.java:128)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        ... 19 more
[ERROR]
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR]
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :GenericExtractor 
```

聚甲醛：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.ABCInc.ef.extractors</groupId>
    <artifactId>Extractors</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    <name>Extractors</name>
    <url>http://maven.apache.org</url>

    <modules>
        <module>GenericExtractor</module>
    </modules>

    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>2.3.2</version>
                    <configuration>
                        <source>1.6</source>
                        <target>1.6</target>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>appassembler-maven-plugin</artifactId>
                    <version>1.2.2</version>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    <dependencyManagement>
        <dependencies>

            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.8.2</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>log4j</groupId>
                <artifactId>log4j</artifactId>
                <version>1.2.14</version>
            </dependency>

            <!-- spring -->
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-core</artifactId>
                <version>3.0.5.RELEASE</version>
            </dependency>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-context</artifactId>
                <version>3.0.5.RELEASE</version>
            </dependency>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-beans</artifactId>
                <version>3.0.5.RELEASE</version>
            </dependency>
        </dependencies>
    </dependencyManagement>

</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:51:53.613

看起来您只`<dependencyManagement>`在 POM 中声明了一个部分。为了将依赖项实际添加到编译时类路径中，您还需要`<dependencies>`在 POM 根目录下的块中直接声明它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:52:24.250

在您的`pom.xml`中，您应该在顶级`<dependencies>`元素中指定依赖项，而不是在`<dependencyManagement>`元素中，如下所示：

```
<project>
    ...
    <url>
    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.2</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.14</version>
        </dependency>
        <!-- spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>3.0.5.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.0.5.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>3.0.5.RELEASE</version>
        </dependency>
    </dependencies>
    ...
</project> 
```

# c# - 实体框架过滤子集合

> ID：11937500
> 
> 赞同：0
> 
> 时间：2012-08-13T15:29:43.260
> 
> 标签：c#, entity-framework

我有这些课程：

```
public class Project
{
    public int ProjectId { get; set; }
    public int AccountId { get; set; }
    public int UserId { get; set; }
    public string Name { get; set; }
    public DateTime StartDate { get; set; }
    public string Description { get; set; }
    public string Tags { get; set; }
    public virtual List<Task> Tasks { get; set; }
}

public class Task
    {
        public int TaskId { get; set; }
        public int ProjectId { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }
        public DateTime StartDate { get; set; }
        public DateTime? DueDate { get; set; }
        public int TaskOwnerId { get; set; }
        public string Tags { get; set; }
        public virtual Project Project { get; set; }
        public virtual List<TaskAssigned> TaskAssigns { get; set; }
        public virtual List<TaskComment> TaskComments { get; set; }
    }

public class TaskAssigned
    {
        public int TaskAssignedId { get; set; }
        public int TaskId { get; set; }
        public int UserId { get; set; }
    } 
```

我需要根据分配给他/她的任务来处理属于每个用户的所有项目我已经提出了这个解决方案，但我无法继续前进：

```
public List<Project> GetProjectsByAccountIdUserId(int accountId, int userId)
        {
            var tasks = context.TaskAssigns.Where(ta => ta.UserId == userId).ToList();
            var projects =context.Projects.Where(p => p.AccountId == accountId).Include("Tasks").ToList();
            return projects;
        } 
```

我不知道如何通过 taskId 关联和过滤每个项目的任务。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T15:44:18.167

```
 context.Projects.Where( 
            p => p.Tasks.Any( 
                        t => t.TaskAssigns.Any( ta => ta.UserId == userId ) 
                        ) 
                      ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:43:49.777

当您执行此类任务时，您希望将数据与谁拥有什么相关联。

所以一个项目有任务。用户有分配给他们的任务。用户在一个项目中。

因此，对于给定的用户，我想要他们的项目。对？（您现在正在点头）但最初我只从用户的角度了解任务，并且任务了解用户所在的项目。

```
 var projectIdentities = (from t in context.Tasks 
                join a in context.TaskAssigned on t.TaskId equals a.TaskId
                where a.UserId == userId
                select t.ProjectId).Distinct();
   List<Project> userProjects = (from p in context.Projects
                     where projectIdentities.Contains(p.ProjectId)
                     select p).ToList();
   return userProjects; 
```

# c# - 实体框架更新对象和更改引用

> ID：11937501
> 
> 赞同：1
> 
> 时间：2012-08-13T15:29:54.947
> 
> 标签：c#, entity-framework-4

我正在尝试更新 CustomerRailcard 对象，该对象对 Railcard 对象的引用以 end * 为 1。问题是，我无法删除 Railcard 对象，我只需将 CustomerRailcard 对象上的引用更改为另一个 RailcardObject。我这样做是这样的：

更新：

```
// Updating properties in existing CustomerRailcard. 
// This won't update navigation properties (Railcard).
context.ObjectStateManager.ChangeObjectState(existingCustomerRailcard, EntityState.Modified);
context.ApplyCurrentValues("CustomerRailcardsDbo", newCustomerRailcard);

// Now I'm trying to update navigation property of CustomerRailcard to the Railcard
// by removing the reference from old Railcard to CustomerRailcard. 
// Railcard can have references to many CustomerRailcards.
var oldRailcard = railcardRepository.FindById(customerDetails.CustomerRailcards.FirstOrDefault(r => r.Id == railcard.Id).Railcard.Id);
var customerRailcardToRemove = oldRailcard.CustomerRailcards.FirstOrDefault(cr => cr.Id == railcard.Id);

// Removing reference to CustomerRailcard from Railcard
oldRailcard.CustomerRailcards.Remove(customerRailcardToRemove);

// Now I'm getting new Railcard I want to have referenced by CustomerRailcard
// and I'm changing its reference tu CustomerRailcard
var newRailcard = railcardRepository.FindById(railcard.Railcard.Id);

// Adding reference to CustomerRailcard
newRailcardDboReference.CustomerRailcards.Add(railcard); 
```

运行后我会得到这个错误

来自“CR_RL_FK”关联集的关系处于“已删除”状态。给定多重约束，相应的“CustomerRailcardDbo”也必须处于“已删除”状态。

我还应该如何对这种关系进行更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:13:58.273

从导航属性中删除是不够`customerReilcardToRemove`的 - 只会破坏关系但不会删除`CustomerReilcard`实例。您的关系需要`CustomerReilcard`具有主体`Reilcard`，因此您必须`customerReilcardToRemove`通过调用删除实例`DeleteObject`或使关系可为空并保留孤立实例。

# javascript - 正则表达式匹配 JQM 路由器插件中的“项目”而不是“项目”

> ID：11937506
> 
> 赞同：0
> 
> 时间：2012-08-13T15:30:13.627
> 
> 标签：javascript, regex, jquery-mobile

我很确定这个问题都是关于正则表达式的。

我正在使用[此处](https://github.com/azicchetti/jquerymobile-router)找到的 JQM 路由器插件。它使用正则表达式来匹配页面和绑定事件处理程序。在文档中它指出：

> 一个典型的错误是忘记了 $ 运算符。如果您有两个页面，例如 #product 和 #productList，假设路径“#product”将匹配两个页面，从而导致意外行为

行。所以我有一个#item 页面和一个#items 页面，所以我在#item 前面加上一个$。但现在它根本不绑定事件处理程序。如果我不使用美元，那么项目的绑定将应用于两个页面。这是实际的实现：

```
var router = new $.mobile.Router([
    {"#items": {events:"i", handler: items.controller.init}},
    {"#items(?:[?/](.*))?": {events:"bs", handler: items.controller.onPageBeforeShow}},

    {"#item": {events:"i", handler: item.controller.init}},
    {"#item(?:[?/](.*))?": {events:"bs", handler: item.controller.onPageBeforeShow}},

]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:33:51.117

匹配正则表达式中字符串的`$`结尾。你不想把它放在开头，你想把它放在最后。

例如：

```
#product
  matches
#product
#productList

#product$
  matches
#product 
```

试试这个代码：

```
var router = new $.mobile.Router([
    {"#items$": {events:"i", handler: items.controller.init}},
    {"#items(?:[?/](.*))?$": {events:"bs", handler: items.controller.onPageBeforeShow}},

    {"#item$": {events:"i", handler: item.controller.init}},
    {"#item(?:[?/](.*))?$": {events:"bs", handler: item.controller.onPageBeforeShow}},

]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:35:58.383

你必须后缀，而不是前缀，*即*

```
#items$
#items(?:[?/](.*))?$
#item$
#item(?:[?/](.*))?$ 
```

# ida - 更改 IDA 5.0 的汇编语言

> ID：11937510
> 
> 赞同：5
> 
> 时间：2012-08-13T15:30:46.713
> 
> 标签：ida

是否可以将汇编语言设置为 IDA 5.0 的 AT&T 语法？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T16:13:19.640

不，Ida Pro 5.0 只有 intel 和 tasm 语法

# ruby-on-rails - 示例登录验证 Rails “NilClass:Class 的未定义方法‘model_name’”

> ID：11937512
> 
> 赞同：0
> 
> 时间：2012-08-13T15:30:49.237
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我做了一个简单的登录验证，我想验证名称和密码。

财务控制器.rb

```
 def login
    @user = User.find_by_name(params[:user])
    if @user
      session[:user_id] = @user.id
      redirect_to :action => 'index'
    end

  end 
```

登录.html.erb

```
<h1>Login</h1>
<%= form_for @user do |f| %>
Nome: <%= f.text_field :name %>
Senha: <%= f.password_field :password %>
<%= f.submit %>
<% end %> 
```

这是错误：

```
undefined method `model_name' for NilClass:Class

Extracted source (around line #2):

1: <h1>Login</h1>
2: <%= form_for @user do |f| %>
3: Nome: <%= f.text_field :name %>
4: Senha: <%= f.password_field :password %>
5: <%= f.submit %> 
```

模型用户.rb

```
class User < ActiveRecord::Base
  attr_accessible :name, :password, :password_digest

end 
```

ps：摘要是为了确保安全。

任何人都可以提供任何输入吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:36:34.010

似乎您正在按她的名字搜索用户，但给出一个由用户属性组成的哈希作为参数 ( `params[:user]`)。我认为这是`@user`仍然存在的原因`nil`，并且显示了此错误。

你能检查一下改变参数是否能`params[:user][:name]`得到更好的结果吗？

# eclipse - 如何显示单个参数的 Javadoc？

> ID：11937522
> 
> 赞同：0
> 
> 时间：2012-08-13T15:31:28.333
> 
> 标签：eclipse, javadoc

通常在查看具有许多参数的方法调用时，我想知道特定参数的 Javadoc 是什么而不计算逗号的数量，然后再去声明并再次计数。

如何从客户端方法调用中直接查看特定参数的 Javadoc？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T11:44:31.993

一种解决方法/类似功能是：

`foo(34, bar1, [cursor]bar2)`

按 ctrl-空格

这显示了上面的方法签名，其中与 bar2 对应的形式参数突出显示。

（这至少在朱诺有效）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:31:28.333

Eclipse 不支持这一点，我已经提交了[增强请求](https://bugs.eclipse.org/bugs/show_bug.cgi?id=387078)。

> 假设我有以下代码：
> 
> ```
> void foo(int i) {}
> void bar() {
>    foo(1);
> } 
> ```
> 
> 如果我将鼠标悬停在 1 上，我希望看到“int i”，就像将鼠标悬停在“foo”上一样。我知道这可能与在参数中显示方法或字段的 Javadoc 相冲突，例如 Eclipse 目前如何在悬停下面的 random() 的 Javadoc 时显示：
> 
> ```
> void bar() {
>    foo(random());
> } 
> ```
> 
> 也许可以有一个悬停修饰键来覆盖它和一个优先顺序来确定在这种情况下显示哪个 Javadoc。

# html - 元素对齐 - 减少项目符号左侧的空间

> ID：11937525
> 
> 赞同：4
> 
> 时间：2012-08-13T15:31:38.957
> 
> 标签：html, css, css-float, html-lists

我在对齐`<li>`左侧的元素时遇到问题。

在下面给出的图像中，您可以看到每个子弹的左侧都有空间。我想删除该空间，以便`Imported`&`100% Genuine`项目符号都位于绿色刻度线的正下方。

![在此处输入图像描述](../Images/3df3658e2e0225b9d116bc1d6600cf46.png)

这是我正在使用的代码。

```
<table border="1">
    <tr>
        <td><ul style="margin:0;"><li>Imported</li></ul></td>
        <td><ul style="margin:0;"><li>Authentic & Licensed</li></ul></td>
    </tr>
    <tr>
        <td><ul style="margin:0;"><li>100% Genuine</li></ul></td>
        <td><ul style="margin:0;"><li>200 GSM Paper Depth</li></ul></td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T15:33:54.493

更改 的`padding-left`属性`ul`。

```
ul {
  padding-left: 20px;
} 
```

[http://jsbin.com/upehik/1/](http://jsbin.com/upehik/1/)

尽管我不得不想知道如果每个列表只有一项，为什么要使用列表？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-23T08:07:15.013

另一种选择...默认情况下，大多数 Web 浏览器都会在内容流之外显示项目符号。`list-style-position`您可以通过将 更改为来更改此设置`inside`。如果您在下面的示例中注意到，当项目符号位于内部而不是外部时，它们会显示在 JSFiddle 中。让子弹在外面时显示的唯一另一种方法是`padding-left`为`ul`元素设置 （在[本例](http://jsfiddle.net/hfwen06p/)中）。

[里面有子弹的例子](http://jsfiddle.net/tLkqnkkj/)

[外面有子弹的例子](http://jsfiddle.net/jaym19td/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:37:03.213

我相信您必须更改`li`属性的 padding-left 。

```
li {
padding-left: 0px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T15:46:15.510

这是您可以采取不同方式的一种方法；

[http://jsfiddle.net/EeHYg/](http://jsfiddle.net/EeHYg/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T15:41:48.513

不同的浏览器以不同的方式显示列表。

执行此操作的最一致的方法是将 ul 及其包含的 li 元素的填充和边距设置为 0。

在此之后，您可能希望将 ul 边距增加到所需的水平。

# php - PHP - 算出它是什么学年

> ID：11937526
> 
> 赞同：3
> 
> 时间：2012-08-13T15:31:43.420
> 
> 标签：php, datetime

我正在尝试编写一个可以解决当前学年的脚本。

学年从每年的 8 月 1 日开始。

我如何根据当前日期计算出我们所在的学年。

即 2012 年 7 月 31 日（20120631）将作为 2011/2012

2012 年 8 月 13 日（20120801）将作为 2012/2013

目前这就是我所拥有的，但它不是很好，因为我不想定义日期并且它不会返回正确的学年，只是最初定义的 $academic_start_date。

```
function check_in_range($start_date, $end_date, $date_from_user)
{
  // Convert to timestamp
  $start_ts = strtotime($start_date);
  $end_ts = strtotime($end_date);
  $user_ts = strtotime($date_from_user);

  // Check that user date is between start & end
  return (($user_ts >= $start_ts) && ($user_ts <= $end_ts));
}

$academic_start_date = '20110801';
$academic_end_date = '20120731';
$startdate = '20120813';

$acyear_check = check_in_range($academic_start_date, $academic_end_date, $startdate);
if ($acyear_check == 1) { $acyear = $academic_start_date;}
else { $acyear = '';} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T15:35:53.493

```
$time = ??;// here you put timestamp, it also may be strtotime(smth);

$year = date('Y', $time);
if(date('n', $time) < 8)
     $ayear = ($year - 1).'/'.$year;
else
    $ayear = ($year).'/'.($year + 1); 
```

对于您的格式：

```
$datestr = 'YYYYmmdd';
$year = substr($datestr, 0, 4);
if(intval(substr($datestr,4,2)) < 8)
     $ayear = ($year - 1).'/'.$year;
else
    $ayear = ($year).'/'.($year + 1); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-13T15:41:06.033

我会改用 Datetime 对象。在代码中传递 DateTime 对象要好得多，可以避免与日期格式（例如美国/英国）等混淆。

```
function academicYear(DateTime $userDate) {
    $currentYear = $userDate->format('Y');
    $cutoff = new DateTime($userDate->format('Y') . '/07/31 23:59:59');
    if ($userDate < $cutoff) {
        return ($currentYear-1) . '/' . $currentYear;
    }
    return $currentYear . '/' . ($currentYear+1);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:00:27.887

这比其他的要长一点，但想法是一样的..我把它做成了一个我可以品尝/验证的页面，所以它是一个表单而不是一个函数。一些修改，你有一个模型。

```
<?PHP
if (!isset($_REQUEST['start']) || empty($_REQUEST['start'])) {
    echo "Enter a date to check for.<br>\n";
} else {
    $start = $_REQUEST['start'];
    $startYear = (int)substr($start,0,4);
    $start_date = date("M d, Y", mktime(0,0,0,substr($start,4,2),substr($start,6,2),substr($start,0,4)));
    $ac_start_date = date("M d, Y", mktime(0,0,0,'8','1',$startYear));
    if ($start_date < $ac_start_date) {
        $AC_Year = ($startYear-1)."/".($startYear);
    } else {
        $AC_Year = ($startYear)." / ".($startYear+1);
    }
    echo "Academic Year for ".$start." = ".$AC_Year.".<br>\n<br>\n";
}
?>
<form name="aychk">
    <div style="float:left;">
        Student start date
    </div>
    <div style="float:left;">
        <input name="start" type="text" placeholder="YYYYMMDD" />
    </div>
    <div style="clear:both;"></div>
    <input type="submit" value="Check">
</form> 
```

但我认为它有效......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-11T14:43:04.630

通常你只需要得到一个值而不是 2001/2002 并使这个函数公开和静态，所以

```
public static function getAcademicYear()
{
    $now = new DateTime();

    $year = $now->format('Y');
    return ($now->format('m') < 8) ? $year - 1 : $year;
} 
```

那么你可以在任何地方重复使用它，例如*$academicYear = ClassName::getAcademicYear();*

# ruby - 是什么导致了这种 RVM/捆绑器差异？

> ID：11937537
> 
> 赞同：-1
> 
> 时间：2012-08-13T15:32:13.917
> 
> 标签：ruby, rvm, bundler

要求 RVM 安装`ruby-1.9.3-head`，然后运行`ruby -v`​​yield `ruby 1.9.3p260`。

做一个`bundle install`，我得到一个错误`Looking for http://ftp.ruby-lang.org/pub/ruby/1.9/ruby -1.9.3-p260.tar.gz and all I got was a 404!`

看着`http://ftp.ruby-lang.org/pub/ruby/1.9/`我没看到的清单`1.9.3-p260`。

RVM 如何/为什么认为 head 是不存在的东西`http://ftp.ruby-lang.org/pub/ruby/1.9/`？

事实上，`rvm list known`它甚至没有`1.9.3-p260`被列为已知的 Ruby！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:31:54.350

确保使用新的 RVM：

```
rvm get stable 
```

然后确保你使用红宝石：

```
rvm use 1.9.3-head --install 
```

您可以验证 ruby​​ 是否用于：

```
rvm info 
```

目前 1.9.3-head 开发分支的补丁级别为 260：[https://github.com/ruby/ruby/blob/ruby_1_9_3/version.h#L2](https://github.com/ruby/ruby/blob/ruby_1_9_3/version.h#L2) / [https://github.com/ruby/ruby/blob/b800677425e0839eac1014d0a2fe9201cabe3a18 /version.h#L2](https://github.com/ruby/ruby/blob/b800677425e0839eac1014d0a2fe9201cabe3a18/version.h#L2)

# javascript - 行之间有空格会影响javascript代码的性能吗

> ID：11937540
> 
> 赞同：2
> 
> 时间：2012-08-13T15:32:23.627
> 
> 标签：javascript, performance

这可能是一个愚蠢的问题，但我仍然有它。代码行之间有空格是否会影响 JavaScript 代码的性能。

JavaScript 文件的缩小版本的效果如何？有什么方法可以优化代码性能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T15:36:06.170

缩小代码将减少下载文件以及最初解析和编译它所需的时间。运行时性能不会受到影响。

除非您拥有绝对巨大的源文件（数万行），否则效果可能非常小，在这种情况下，缩小它确实有意义。缩小的效果取决于文件的大小，但我看到一些库在缩小时会显着减小（例如 ExtJS）。

除非您有想要优化的特定代码，否则提高运行时性能是无法真正涵盖在单个答案中的。如果您希望优化代码的运行时性能，请首先对其进行分析并确定其大部分时间花费在哪里。如果您使用的是 Chrome，它的开发人员工具中有一个内置的分析器。Firefox 这些天可能也有一个，但我不确定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T15:35:00.070

通过缩小的 JS 代码优化的不是性能，而是脚本大小。这可以提高您的页面在连接速度较慢的情况下的加载速度。

现在，浏览器使用所谓的 JIT 编译器编译脚本代码。所以运行时绝对不受空格的影响。如果编译时间会有微小的差异，但由于编译器只是跳过空格，我什至不期望有可测量的差异，更不用说明显的差异了。

如果您想真正提高代码的运行时性能，那么您将无法自行优化代码。有数以百万计的资源涵盖了这个主题。

尽管如此，优化页面加载速度是一件好事，因为每一毫秒都可以让您的访问者开心（[http://www.strangeloopnetworks.com/web-performance-infographics/](http://www.strangeloopnetworks.com/web-performance-infographics/)）。并不是每个人都有高速互联网连接。因此，当您完成调试代码时，最小化它并不是一个坏主意，尤其是对于像 jquery 或 extjs 这样的大型代码库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:36:52.887

据我所知，代码行之间的空格不会影响性能，并且 JavaScript 文件的缩小版本并不比原始文件快。

缩小的源代码只会下载得更快。

# google-maps - Google Maps API 是否可用于根据 GPS 坐标确定您是在路上还是在路上？

> ID：11937546
> 
> 赞同：1
> 
> 时间：2012-08-13T15:32:47.067
> 
> 标签：google-maps

我正在寻找一种方法，我可以使用 google maps api 来确定给定 gps 坐标，该点是否落在道路上。

任何人都知道这是否可能，甚至更好，如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:41:17.297

如果您使用路线服务，它将返回最近的道路（如果可以找到的话）。您可以测量它返回的点和您的点之间的距离，以确定它们是否“相同”（取决于您的 GPS 的准确度）。

您可能会发现[Google Maps API v3 的搜索](https://groups.google.com/group/google-maps-js-api-v3/search?hl=en&group=google-maps-js-api-v3&q=snap+to+road&qt_g=Search+this+group)结果很有用

# c++ - Webkit GTK：获取 HTTP 响应

> ID：11937547
> 
> 赞同：2
> 
> 时间：2012-08-13T15:32:54.423
> 
> 标签：c++, c, webkit, gtk

我一直在尝试弄清楚如何使用 Webkit GTK API 来获取特定页面加载的 HTTP 响应代码。

Webkit GTK 使用**[Soup API](http://developer.gnome.org/libsoup/stable/)**进行 HTTP 网络，根据[文档](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html)，似乎有两个相关信号：`"resource-request-starting"`和`"resource-response-received"`.

所以，我尝试连接一个信号`"resource-request-starting"`：

```
g_signal_connect(web_view, "resource-request-starting", G_CALLBACK(resource_request_starting_callback), 0); 
```

......它的工作原理。在回调处理程序中，我可以访问底层`SoupMessage`对象，它为我提供有关 HTTP 请求的信息。

所以这让我得到了 HTTP*请求*，但是......当我尝试获得实际的 HTTP*响应*时，我遇到了麻烦。我试着听`"resource-response-received"`信号：

```
g_signal_connect(web_view, "resource-response-received", G_CALLBACK(resource_response_received_callback), 0); 
```

这会导致 GTK 发出警告：

```
GLib-GObject-WARNING **: /build/buildd/glib2.0-2.30.0/./gobject/gsignal.c:2295: signal `resource-response-received' is invalid for instance `0x2b46c00' 
```

谷歌搜索`resource-response-received`，我发现几乎没有关于这个信号的信息。该[文档声称](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#WebKitWebView-resource-response-received)它可以满足我的需求，但实际上它并没有真正起作用。

所以，我不知道我是不是走错了路。但总的来说，谁能提供一个示例，说明如何使用 Webkit GTK 获取页面加载的实际 HTTP 状态代码（如 200、404 等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:51:27.510

您使用的是 WebKit 1.7.5 或更高版本吗？请参阅您链接到的文档底部的注释。

# php - JQUERY 在 2 种不同的环境中。标准 PHP 和 MVC。第一个作品第二个没有

> ID：11937548
> 
> 赞同：0
> 
> 时间：2012-08-13T15:32:56.037
> 
> 标签：php, jquery

问题是：它在第一个环境中加载选定的索引值。

它不会在第二个 MVC codeigniter 中发送它。控制器没有获得加载之前发送的选定索引。

第一个作品：看是多么容易理解。

```
//jquery code for source list
$(document).ready(function()
      {
        $('#sel_pais').change(function()
             {
              if ($(this).val()!='')
             {
            $("#sel_source").load("includes/getchilds5.php",{pais_id: $(this).val()});
             }
                 });

    });  // end of first function

=========================================================
getchilds5.php file

if(isset($_REQUEST['pais_id']) && !empty($_REQUEST['pais_id'])) {
    $result = mysql_query("select * from tabla_from where pais_id='".$_REQUEST['pais_id']."' ");
    if(mysql_num_rows($result) > 0) {
        echo '<option value="">Select</option>';
        while($row = mysql_fetch_assoc($result)) {              
                echo '<option value="'.$row['id_from'].'">'.$row['from_name'].'</option>';
        }
    } else {
        echo '<option value="">Select</option>';
    }
}  # end of IF ISSET FOR PAIS 
```

======= 现在 MVC 不起作用，因为控制器没有获取到值：

```
$(document).ready(function()
        {
         $('#country').change(function() 
                 {
                  if ($(this).val()!='') 
                      {
                       $("#source").load("/CI-3/application/controllers/control_form.php/",{pais_id: $(this).val()},  

                      }

                  });

        });  // end of first function
</script>

============================================================

        <?php echo form_open('control_form/add_all'); ?>
       <label for="country">Country<span class="red"></span></label>
        <select id="country" name="country">
            <option value="">Select</option>
            <?php

                foreach($result as $row)
                {
                echo '<option value="' . $row->pais_id . '">' . $row->pais_name . '</option>';
                }

            ?>
        </select>

        <label for="source">Source Language<span class="red"></span></label>
        <!--this will be filled based on the tree selection above-->
        <select id="source" name="source"> 
            <option value="">Select</option>

           <?php
=============================================================== 
```

控制器会这样做：

```
 $pais_id = $this->input->get_post('country', TRUE); # but I am not getting anything 
```

但它得到一个空对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:51:13.880

~~看起来您正在尝试从 POST 请求中获取数据，但您将其作为 GET 发送。jQuery 的 $.load 执行 GET 请求，正如[手册](http://api.jquery.com/load/)所说，它等于~~

`$.get(url, data, success)`

在您的第一个示例中，您曾经`$_REQUEST`获取表单数据，但在第二个示例中，您似乎明确使用`$_POST`了数组，在使用`$.load`.

~~您可以了解如何使用整个 $_REQUEST 或从 $_GET 数组中获取数据。~~

看起来您的名称不匹配。在 jQuery 中你使用`pais_id`，但在 MVC 中你得到它，因为`country`它当然不会被发现。

**UPD：**删除线文本出于历史原因留在这里。它与我们在聊天讨论中清除的原始主题无关。

**UPD2：**可能有帮助的链接：

*   [无法访问通过 jQuery ajax 发送的我的 Post 值](https://stackoverflow.com/questions/5855003/cant-access-my-post-values-send-through-with-jquery-ajax)
*   [PHP 问题中的 mod_rewrite 和 POST 方法，$_POST 始终为空](https://stackoverflow.com/questions/6079371/updated-mod-rewrite-and-post-method-in-php-problem-post-is-always-empty)
*   [Codeigniter 为空 $_POST & $_FILES](https://stackoverflow.com/questions/9362587/codeigniter-empty-post-files)

# java - 将文件从临时目录复制到两个不同的目录失败

> ID：11937550
> 
> 赞同：0
> 
> 时间：2012-08-13T15:33:03.900
> 
> 标签：java, file-upload

我正在尝试将文件上传到两个不同的目录。但不知何故，它将文件复制到一个目录，但无法复制到第二个目录。

我的 src 文件目录是这样的

> C:\路径\到\临时

我的目标目录是这样的

> C:\path\to\destination\1 & C:\path\to\destination\2

目录 1 和 2 正在动态创建。

这就是我在我的代码中使用的

```
public final static boolean move(String src, String dest, boolean createDestDir, boolean overwrite) {
   try{
       if(src == null || src.length() == 0 || dest == null || dest.length() == 0){ 
           return false;
       }
       File srcFile = new File(src);
       if(srcFile.isFile() == false){
          return false;
       }

       String destPath = path(dest);
        String destFileName;
        if (destPath.equals(dest)) {
            destFileName = srcFile.getName();
        } else {
            destFileName = name(dest);
        }
        File destDir = new File(destPath);
        if (destDir.exists() == false) {
            if (createDestDir == false) return false;
            if (destDir.mkdirs() == false) {
                return false;
            }
        }
        File destFile = new File(destPath + destFileName);
        if (destFile.exists()) {
            if (overwrite == false) return false;
            if (destFile.delete() == false) {
                return false;
            }
        }
        return srcFile.renameTo(destFile);
   }

} 
```

在我的循环`srcFile.isFile()`第二次失败期间，它第一次工作，但第二次失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:07:56.557

该`mkdirs`方法在文件路径中创建任何缺少的父目录。例如。如果目标位置是 C:\some\path\to\file\，那么如果您调用`mkdirs`，它将检查 C:\some 是否存在，然后是 C:\some\path，依此类推。如果路径不存在，它将创建该文件夹并继续。完成后，只有在必须创建任何文件夹时*才会*返回 true。如果目录结构存在，则返回false。

在你的代码中，你有这个：

```
File destDir = new File(destPath);
if (destDir.exists() == false) {
    if (createDestDir == false) return false;
    if (destDir.mkdirs() == false) {
        return false;
    }
}
File destFile = new File(destPath + destFileName);
if (destFile.exists()) {
    if (overwrite == false) return false;
    if (destFile.delete() == false) {
       return false;
    }
} 
```

我不确定您为什么要采用如此复杂的方式来创建目录结构。而不是整个`createDestDir`变量（我怀疑`false`它应该是真的），你可以只调用该`mkdirs()`方法。如果目录结构已经存在，则没有硬调用该方法。

然后在下一段代码中，检查文件系统上是否已经存在该文件。如果它确实存在，并且您没有将`overwrite`布尔值设置为`true`，那么您尝试删除该文件。但*你绝不会打电话给`createNewFile()`*. 您实际上从未在文件系统上创建文件。

尝试用以下代码替换上面的代码：

```
new File(destPath).mkdirs();
File destFile = new File(destPath + destFileName);
if (destFile.exists()) 
    if (!overwrite) {
        return false;
    } else {
        destFile.delete();
    }
}
destFile.createNewFile(); 
```

这将在必要时创建目标目录，检查文件是否存在（如果允许和必要，则将其删除），然后在该位置创建文件。

此外，您应该检查以确保`destPath`以文件分隔符结尾 - 例如。Linux/Unix 中的“/”或 Windows 中的“\”——否则`destPath + destFileName`会给你一些奇怪的东西。

# python - 如何在 Django 中获取 TextField 的长度？

> ID：11937554
> 
> 赞同：2
> 
> 时间：2012-08-13T15:01:24.097
> 
> 标签：python, django

我知道使用常规字符串，您可以执行 x.len() 来获取它的长度，但是 Django 模型 TextField 似乎并不想要这样。我找到并查看了[模型字段参考](https://docs.djangoproject.com/en/dev/ref/models/fields/)。如何在 Django 中获取文本字段的长度？帮助和示例表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:41:48.690

Django 模型实例实际上并不将字段公开为字段类：一旦从数据库加载，它们只是相关数据类型的实例。因此，CharField 和 TextField 都作为简单字符串进行访问。这意味着，与任何其他 Python 字符串一样，您可以调用`len(x)`它们 - 注意，这是一个内置函数，而不是字符串方法。所以`len(myinstance.mytextfield)`并且`len(myinstance.mycharfield)`会起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T15:54:29.660

试试[`len(obj.your_field)`](http://docs.python.org/library/functions.html#len)。这应该会给你你想要的，因为结果它将是一个相应数据类型的对象（TextField 字段和 CharField 字段都是字符串）。这是一个基于文档的[快速示例：](http://docs.python.org/library/functions.html#len)

```
from django.db import models

class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)

 person = Person.objects.get(pk=1)

 len(person.first_name) 
```

此外，除非您以某种方式添加它，否则 python 中没有 'string'.len() 方法。

# ruby-on-rails-3 - 使用 Rails 对 Postgres Follower（数据库镜像）运行分析

> ID：11937562
> 
> 赞同：2
> 
> 时间：2012-08-13T15:33:28.207
> 
> 标签：ruby-on-rails-3, heroku

Heroku 在 Postgres Followers 上的文档吹捧“Followers 可能被用来……提供数据的只读视图以供分析”，但它没有提供任何关于如何实现这一点的见解。

我的计划是让“分析数据库”镜像“主数据库”；在分析数据库上运行一些主要的、数字运算的 sql 查询，并将结果存储在主数据库的表中。

我还没有找到有关如何为这些查询访问分析数据库的详细信息，同时仍使用主数据库进行一般访问。我发现的大多数资源都在谈论调用

```
class MyModel < ActiveRecord::Base
    establish_connection :analytics   # and configure analytics within config/database.yml
end 
```

但是，这将导致 MyModel 的所有存储都在追随者上（顺便说一句，这将不起作用，因为追随者是只读的）。我希望主存储空间位于主数据库上，但只需对跟随者进行一些（只读）访问。

# 可能的解决方案：

1）有一个运行不同环境的rails应用程序的*单独*实例，例如“分析”而不是“生产”。因此，它将使用分析数据库进行所有访问。然后将结果存储在

```
class AnalyticsData < ActiveRecord::Base
    establish_connection :production if Rails.env == 'analytics'
end 
```

这将导致 AnalyticsData 结果存储在主生产数据库中。

2) 拥有一个*Rails*应用程序实例。

*   在开始分析工作之前，调用 ActiveRecord::Base.establish_connection(:analytics)
*   做嘎吱嘎吱的声音
*   调用 ActiveRecord::Base.establish_connection(:production)
*   实例化 AnalyticsData 对象以保存结果

我完全不确定后一种方法是否可行，但它的优点是不必担心保持两个 Heroku 应用程序同步。

想法？谢谢！

### 参考：

*   [https://devcenter.heroku.com/articles/improving-heroku-postgres-availability-with-followers](https://devcenter.heroku.com/articles/improving-heroku-postgres-availability-with-followers)
*   [https://devcenter.heroku.com/articles/heroku-postgres-documentation#follow-beta](https://devcenter.heroku.com/articles/heroku-postgres-documentation#follow-beta)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:09:48.480

关注者的数据库 URL 将在您的应用程序中作为配置变量提供。您可以通过`heroku config --app your-app`.

我会将其分配为 READONLY_DATABASE_URL 通过

```
heroku config:add READONLY_DATABASE_URL=<the url> --app your-app 
```

然后使用任何用于 activerecord 的分片插件，基于`ENV['READONLY_DATABASE_URL']`. 我没有使用任何这些，但你应该在这里调查你的选择：[https](https://www.ruby-toolbox.com/categories/Active_Record_Sharding) ://www.ruby-toolbox.com/categories/Active_Record_Sharding （并在整个互联网上分享对你有用的东西！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-17T03:44:22.683

要仅为分析工作访问只读追随者，请创建一个单独的模型，然后：

1.  手动将其指向正确的表
2.  让新模型扩展原始模型（让您可以访问相同的范围或方法）

### 例子：

```
class AnalyzeMyModel < MyModel
  set_table_name 'my_models'

  # ...connect to follower db...

  def self.sold_today_by_model_number(model)
    NumberCrunch.create name: "#{model} sold #{Date.today}",
                        data: created_today.where(model_number: model).to_json
  end

  def self.number_sold_today_by_model_number(model)
    NumberCrunch.create name: "Number of #{model} sold #{Date.today}",
                        data: sold_today_by_model_number(model).count
  end
end

# Usage:

  numbers_crunched = AnalyzeMyModel.number_sold_today_by_model_number(9001)
  puts "#{numbers_crunched.name}: #{numbers_crunched.data}"
  # "Number of 9001 sold DATE: 9876" 
```

现在，在同一个应用程序中，您可以像往常一样使用 MyModel，并使用 AnalyzeMyModel 来报告/分析来自您的关注者的数据。

# java - 在android中刷新app php vs java的数据

> ID：11937563
> 
> 赞同：1
> 
> 时间：2012-08-13T15:33:28.587
> 
> 标签：java, php, android

我有一个应用程序可以通过 httpconnection 检索数据，只需调用 php 脚本即可。我想实现以下功能：当新数据到达时启用像 facebook 这样的通知。我找到了一种方法，但我想知道是否有更好的解决方案。到目前为止，我的应用程序在后台运行并一直在获取数据。我想知道任何其他方法是否会更好（因为我总是通过http连接获取数据，我认为这是无效的）。还有其他方法吗？喜欢通过我的服务器启用我的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:15:02.797

将 GCM 集成到您的应用程序中可能更有意义。让您的服务器查询该数据，并且当它满足您在客户端更新所需的条件时......从您的服务器向您的客户端发送 GCM 通知。当您的客户获取该消息时......然后运行您的“更新”调用。

可以在此处找到有关 GCM 的更多信息：

[http://developer.android.com/guide/google/gcm/index.html](http://developer.android.com/guide/google/gcm/index.html)

如果您有更具体的需求或功能，请告诉我，我可以帮助您以较少数据密集型的方式处理它们。

# forms - 谁能把表格放在左边？

> ID：11937564
> 
> 赞同：-3
> 
> 时间：2012-08-13T15:33:31.060
> 
> 标签：forms

任何人都可以移动地图下方左侧的表格吗？我真的很难，努力去做。我可以把它放在最右边，但不能放在最左边。它不会比地图更远（在地图下方）。

```
<!DOCTYPE html> 
    <html> 
        <head> 
        <title>Finding the best location</title> 
        <meta name="viewport" content="width=device-width, initial-scale=1"> 

        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.ie.css" />
    <![endif]-->

    <script src="http://cdn.leafletjs.com/leaflet-0.4.4/leaflet.js"></script>

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>

    </head> 

    <body> 
    <div data-role="page">
    <div data-role="header">
    <h1>Location suitability application</h1>
        </div><!-- /header -->
    <div data-role="content" >

        <div id="mymap" style="height:300px;width:300px" align="right"></div>           

    <form name="theform" align="left">
            <table width="600" align="left">    
            <tr>
                <td width="400" align="right">

                <td width="9"> 
                <td width="224"> 
                <b>Business importance factor:</b>
                <SELECT name="busfac"> 
                <OPTION selected value="1">1</OPTION>
                <OPTION value="2">2</OPTION>
                <OPTION value="3">3</OPTION>
                <OPTION value="4">4</OPTION>
                <OPTION value="5">5</OPTION>

                </SELECT>
            </tr>

            <tr>
                <td width="154" align="left">
                <td width="9">
                <td width="224">
                <b>Neighborhood importance factor:</b>
                <SELECT name="neifac">
                <OPTION selected value="1">1</OPTION>
                <OPTION value="2">2</OPTION>
                <OPTION value="3">3</OPTION>
                <OPTION value="4">4</OPTION>
                <OPTION value="5">5</OPTION>
                </SELECT>
            </tr>

            <tr>
                <td width="154" align="left">
                <td width="9">
                <td width="224">    
                <input type="button" Value="Store point" 
                onclick="insertW(this.form.busfac.value,this.form.neifac.value);"/>
            </tr>

            <tr>
                <td width="154" align="left">
                <td width="9">
                <td width="224">    
                <input type="button" Value="Calculate best location" 
                onclick="nese(handleLoc);"/>
            </tr>
            <tr>
            <td width="154" align="left">
                <td width="9">
                <td width="224">    
                <p> Your Latitude is: <b id="C1" name="Latitude"> </b> </p>
                <p> Your Longitude is: <b id="C2" name="Longitude"> </b> </p>
            </tr>
            </table>
            </form>

            <script>

    function mark(p) {
    theMarker=new L.Marker(p);
    map.addLayer(theMarker);
    theMarker.bindPopup("You are here");
    }

    function handleLoc(pos)  {
    var a=pos.coords.latitude;
    var b=pos.coords.longitude;
    var p = new L.LatLng(+a, +b);
    mark(p);
    document.getElementById("C1").innerHTML;
    document.getElementById("C2").innerHTML;
    }

    function handleErr(pos) {
    document.write("could not determine location");
    }

    if (navigator.geolocation) {
    navigator.geolocation.watchPosition(handleLoc, handleErr);
    } else {
    document.write("geolocation not supported");
    }

    var map = new L.Map('mymap');
    var osmTile = "http://tile.openstreetmap.org/{z}/{x}/{y}.png";
    var osmCopyleft = "Map data &copy;2012 OpenStreetMap contributors";

    var osmLayer = new L.TileLayer(osmTile, {
        attribution: osmCopyleft
    });
    map.addLayer(osmLayer);
    map.setView(new L.LatLng(41.33,19.8), 13);

        </script> 
            </div><!-- /content -->
            <div data-role="footer">
            <h4>Page Footer</h4>
            </div>
        </div>  
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:39:17.137

你的问题不是很清楚你想如何布局页面（一些示例截图会有所帮助），但我会猜测一下。考虑使用 CSS 浮动属性和宽度（就像你正在做的那样）。

[您可以在此处](http://www.w3schools.com/css/css_float.asp)阅读有关 float的信息。

编辑以下评论：

查看您的示例，如果您将地图 div（id=mymap）向左浮动，然后将包含控件（标记为 data-role=content）的另一个 div 向左浮动，并为其赋予宽度，您应该会得到类似的东西.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T11:09:00.160

使用`float:left;`属性..如果你在间距方面有问题你初始化`margin:0px; padding:0px;`然后`float:left;`

# silverlight - 如何在 Silverlight 4 中异步调用方法？

> ID：11937565
> 
> 赞同：0
> 
> 时间：2012-08-13T15:33:31.577
> 
> 标签：silverlight, sharepoint, asynchronous, silverlight-4.0, sharepoint-2010

我正在为 SharePoint 开发 Silverlight 应用程序，并希望从列表中获取 ListItems。我知道我需要异步查询以避免阻塞 UI 线程。通常我使用 ExecuteQueryAsync 但这不起作用，因为我喜欢将结果设置为 DataGrid 源。

如何异步调用 GetItemsFromList 方法并将结果设置为 DataGrid 源而不产生太多代码开销？（拉姆达？）

SharePointHelper 类：

```
public static ListItemCollection GetItemsFromList(string name)
{
    var context = ClientContext.Current;
    var targetList = context.Web.Lists.GetByTitle("ListName");

    CamlQuery camlQuery = new CamlQuery();
    camlQuery.ViewXml = string.Format("<View><Query><Where><Eq><FieldRef Name='Title'/><Value Type='Text'>{0}</Value></Eq></Where></Query>RowLimit>4</RowLimit></View>",
                                      name);

    ListItemCollection collListItems = targetList.GetItems(camlQuery);
    context.ExecuteQuery();

    return collListItems;
} 
```

用户界面类：

```
private void SetDataGridItemSource()
{
    dataGrid.Source = GetItemsFromList("name");
} 
```

我现在已经实现了 Shawn Kendrot 的解决方案：

```
BackgroundWorker worker = new BackgroundWorker();
worker.DoWork += (sender, args) => 
{
    args.Result = SharePointHelpers.GetItemsFromList("name");
};
worker.RunWorkerCompleted += (s, e) => dataSource.Source = e.Result as ListItemCollection;
worker.RunWorkerAsync(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:33:36.350

我不熟悉 SharePoint 的 ClientContext 类（甚至是 SharePoint），但我在[docs](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.client.clientcontext_members.aspx)中看不到任何异步方法。如果此调用成本很高，您可以将调用包装在[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker%28v=vs.95%29.aspx)中。BackgroundWorker 将执行查询，您可以返回结果。您将无法按照您的描述分配 Source，而是需要在工作人员完成时设置 Source。

```
 private void SetDataGridItemSource()
    {
        BackgroundWorker worker = new BackgroundWorker();
        worker.DoWork += WorkerOnDoWork;
        worker.RunWorkerCompleted += WorkerOnRunWorkerCompleted;
        worker.RunWorkerAsync("name");       
    }

    private void WorkerOnDoWork(object sender, DoWorkEventArgs args)
    {
        if(args.Argument != null)
        {
            string name = args.Argument.ToString();
            var context = ClientContext.Current;
            var targetList = context.Web.Lists.GetByTitle("ListName");

            CamlQuery camlQuery = new CamlQuery();
            camlQuery.ViewXml = string.Format("<View><Query><Where><Eq><FieldRef Name='Title'/><Value Type='Text'>{0}</Value></Eq></Where></Query>RowLimit>4</RowLimit></View>",
                                              name);

            ListItemCollection collListItems = targetList.GetItems(camlQuery);
            context.ExecuteQuery();

            args.Result = collListItems;
        }
    }

    private void WorkerOnRunWorkerCompleted(object sender, RunWorkerCompletedEventArgs args)
    {
        dataGrid.Source = args.Result as ListItemCollection;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:33:06.343

像这样的东西？

```
public delegate void ItemsLoadedCallback(IEnumerable<object> Entities);
public static void GetItemsFromList(string name, ItemsLoadedCallback Callback)
{
    // codesnip

    // Do async thing, on return call:
    if (Callback != null)
    {
        Callback(collListItems);
    }
}

private void SetDataGridItemSource()
{
    GetItemsFromList("name", (items) => dataGrid.Source = items);
} 
```

# apache - Apache：匹配静态资源

> ID：11937571
> 
> 赞同：0
> 
> 时间：2012-08-13T15:33:51.857
> 
> 标签：apache

我将添加`Expires "access"`作为默认配置设置，并添加`Etag:`标头，以添加到 apache 网络服务器上的所有**静态**资源，其中包含大量组织不良的内容（来自我大学的网络服务器）。也就是说，我不想弄乱以任何方式动态生成的资源标头，因为我希望它们实现自己的缓存策略。

那么，提出一个更一般的问题，是否可以将映射到完全静态资源的请求匹配？

不幸的是，我的 search-foo 并没有将我带到一个回答我问题的网站，所以我（大概）在这里复制它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T08:32:12.373

看看[`<FilesMatch>`](http://httpd.apache.org/docs/current/mod/core.html#filesmatch)指令。它类似于`<Location>`or`<Directory>`但适用于名称与模式匹配的文件。

它无法确定某些文件内容是否是动态生成的，但这是一个开始，因为它与不是文件的 URL 不匹配。

# gps - 纬度/经度元数据。GPS 坐标 - 度、分、秒

> ID：11937575
> 
> 赞同：2
> 
> 时间：2012-08-13T15:33:54.510
> 
> 标签：gps, metadata, latitude-longitude

我有一个打印图片经度和纬度的程序。程序将它们都打印成以下格式：度、分、秒。

由于我想为 GoogleEarth 生成一个 KML 文件，而 GoogleEarth 只支持十进制度，我需要考虑一种转换坐标的方法。

每次我做数学试卷的时候，我都会得到一个错误的答案。有人可以指出我哪里出错了。

我有坐标-

> +51° 26' 13.57", -2° 34' 38.55"

我被告知要这样计算。加 51 加 26/60 加 13.57/3600。

正确答案应该是——

> 51.437103，-2.577375

我的下一个问题是将字符串分解为不同的段，因为我使用的元数据库将坐标打印为一个单独的字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:05:28.437

你学到的方法很好，如果你在谷歌查询 (51+26/60+13.57/3600) 你得到 (51.4371028)，同样的 -(2+34/60+38.55/3600)，你得到 (- 2.577375）。在某些编程语言中，您必须小心`/`，当给定整数参数时，会截断运算结果（在这种情况下，您希望将除数或被除数转换为浮点数）。

破坏字符串的部分高度取决于您正在使用/舒适的语言。

# plugins - 如何创建netbeans 插件？

> ID：11937579
> 
> 赞同：0
> 
> 时间：2012-08-13T15:34:11.340
> 
> 标签：plugins, netbeans

如何制作一个在 netbeans 启动时运行的简单插件，并将一些内容写入控制台和所有内容。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:40:38.913

谷歌做到了：

[http://platform.netbeans.org/tutorials/nbm-google.html](http://platform.netbeans.org/tutorials/nbm-google.html)

# vb.net - 在 VB.Net 中创建一个通用类型列表并将其分配给一个属性

> ID：11937580
> 
> 赞同：0
> 
> 时间：2012-08-13T15:34:19.500
> 
> 标签：vb.net, generics

经过几天的研究，我遇到了一个无法解决的问题...

我必须创建一个应用程序来读取 Excel 文件并根据列的名称和值生成对象以测试其他应用程序。这部分没有问题，我可以在不知道对象类型的情况下为对象创建和分配值。

我遇到的问题是其中一些对象之间有关系，因为对象 A 有一个列表（对象 B）。我可以识别这些。

我的对象是这样声明的：

```
Public Class Person
     Public Property Name as String
     Public Property Age as Integer
     Public Property Dogs as List(Of Dog)
     ...
End Class

Public Class Dog
     Public Property Name as String
     ...
End Class 
```

当我调试时，我得到类似的东西： Person: Name = "Something", Age = 30, Dogs = Nothing

由于我的 List(Of T) 不等于任何内容，因此我需要在将对象添加到其中之前对其进行实例化。由于我还没有找到任何方法来告诉 List 实例化自身，因此我尝试为该属性分配一个 New List。

我有一些我试过的代码：

```
'In this case, unObjetParent would be a Person, and unObjetEnfant would be a Dog
Private Function AssocierObjets(ByRef unObjetParent As Object, ByRef unObjetEnfant As Object) As Boolean
    Dim proprietes() As Reflection.PropertyInfo = unObjetParent.GetType.GetProperties
    Dim typeEnfant As Type = unObjetEnfant.GetType

    For Each p As Reflection.PropertyInfo In proprietes
        If p.PropertyType.Name.Equals("List`1") Then
            Dim type As Type = p.PropertyType
            Dim splittedAssemblyQualifiedName As String() = type.AssemblyQualifiedName.Split(","c)
            Dim typeOfList As Type = type.GetType(splittedAssemblyQualifiedName(0).Substring(splittedAssemblyQualifiedName(0).LastIndexOf("["c) + 1))
            ' ^ The way I found to get the Type of the GenericArgument of the List before instantiating it.

            If typeOfList = typeEnfant Then

                'This create a object with it's name, in this case, it returns a Dog
                Dim prototype = DefinirObjet(typeOfList.Name)

                'My first try, it returns a List(Of VB$AnonymousType_0`1[System.Object])
                'which I can't convert into a List(Of Dog(for this example))
                Dim prop = New With {unObjetEnfant}
                Dim l = prop.CreateTypedList
                p.SetValue(unObjetParent, l, Nothing)

                'This one doesn't work either as it returns a List(Of Object)
                'which I can't convert into a List(Of Dog(for this example))
                p.SetValue(unObjetParent, CreateTypedList2(prototype), Nothing)

            End If
        End If
    Next
    Return True
End Function

<System.Runtime.CompilerServices.Extension()> _
Function CreateTypedList(Of T)(ByVal Prototype As T) As List(Of T)
    Return New List(Of T)()
End Function

Private Function CreateTypedList2(Of T)(ByVal unPrototype As T) As List(Of T)
    Return New List(Of T)
End Function 
```

另外，我不能修改对象，因为我应该能够接受我们需要测试的任何对象库。

这可能吗？我需要解决这个问题。提前致谢

PS对不起，如果我的英语不好，那不是我的母语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:19:20.040

最后，我找到了一种方法来做我需要的事情：

```
 Dim t1 As Type = GetType(List(Of ))
      Dim constructed As Type = t1.MakeGenericType(typeEnfant)
      Dim o As Object = Activator.CreateInstance(constructed) 
```

这将创建一个泛型集合的实例，在我的例子中是一个指定类型的 List(Of T)，并且我可以将它分配给我正在处理的属性。

# php - 正则表达式和逻辑 AND 运算符

> ID：11937581
> 
> 赞同：0
> 
> 时间：2012-08-13T15:34:20.937
> 
> 标签：php, regex

尝试在正则表达式中插入 AND 运算符，但经过一番搜索，我意识到正则表达式不支持 AND 运算符。任何人都可以帮助我建议替代 AND 运算符。问题是：我需要找到我们词汇表中的单词并突出显示它们，但标签内的单词必须不受影响。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:37:15.530

```
if (preg_match($vocab, $word) && !preg_match($tag, $word)) highlight($word); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:17:37.940

我想你会有两个选择：

1.

```
if(preg_match($pat1, $subject) > 0 && preg_match($pat2, $subject) > 0){ 
    /* do something */ 
} 
```

2.使用正/负前瞻来模拟AND：

示例：匹配除`span`and之外的任何 html 标签`div`：`</?(?!span\b)(?!div\b)[^>]+>`
根据 De Morgan 定律 =`</?(?!(span|div)\b)[^>]+>`

我希望这些可以帮助你:)

# php - 使用 CodeIgniter 动态设置语言

> ID：11937582
> 
> 赞同：0
> 
> 时间：2012-08-13T15:34:25.633
> 
> 标签：php, codeigniter

我想将默认应用程序语言设置为我的访问者国家语言。我有一个 API 来获取 IP 前缀习语，并基于此信息，我想设置语言。

做这个的最好方式是什么？我想制作一个 cookie 来存储语言标识符，但是我必须在哪里设置呢？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:49:57.617

你看过[CodeIgniter 的语言库](http://codeigniter.com/user_guide/libraries/language.html)吗？

**语言类提供了检索语言文件和文本行以实现国际化的功能。**

**在您的 CodeIgniter 系统文件夹中，您会找到一个名为 language 的包含语言文件集的语言。您可以根据需要创建自己的语言文件，以便以其他语言显示错误和其他消息。**

**语言文件通常存储在您的系统/语言目录中。或者，您可以在应用程序文件夹中创建一个名为 language 的文件夹并将它们存储在那里。CodeIgniter 将首先在您的应用程序/语言目录中查找。如果该目录不存在或指定的语言不存在，CI 将改为在您的全局系统/语言文件夹中查找。**

在你的情况...

*   您需要在应用程序/语言/抛光中创建一个`polish_lang.php`和`english_lang.php`
*   然后在该文件中创建您的密钥（例如`$lang['hello'] = "Witaj"`；
*   然后将其加载到您的控制器中`$this->lang->load('polish_lang', 'polish');`
*   然后获取行，`$this->lang->line('hello');`就像将这个函数的返回值存储在一个变量中，这样你就可以在你的视图中使用它。

对英语和您需要的所有其他语言重复这些步骤。

# php - PHP / MYSql 按名称、日期、alpha 等对数据库条目进行排序

> ID：11937583
> 
> 赞同：0
> 
> 时间：2012-08-13T15:34:33.423
> 
> 标签：php, mysql

是否有任何现成的脚本可以显示带有可单击表头的 mysql 查询结果以对每列数据进行排序（和反向排序）？自己编写代码似乎并不难，但我想知道是否有任何好的函数或库已经实现了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:39:19.923

试试这个[http://datatables.net/](http://datatables.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:37:43.667

有一些库可以做到这一点，但它们不是 PHP，而是 Javascript。一个例子是“可排序的”，你可以在这里找到：[http ://www.kryogenix.org/code/browser/sorttable/](http://www.kryogenix.org/code/browser/sorttable/)

# c# - 如何动态增加 C# 中固定数组的大小？

> ID：11937585
> 
> 赞同：1
> 
> 时间：2012-08-13T15:34:36.960
> 
> 标签：c#, memory-management, garbage-collection

我正在开发一个具有垃圾收集功能的基本 POC VM。我使用的语言是 C#，我使用**固定**字节数组作为 VM 的内存。是否可以在不通过 .net GC 移动的情况下动态增加内存的大小？

我使用的代码非常简单

```
byte[] _memory = new byte[2048];
var _gcHandle = GCHandle.Alloc(_memory, GCHandleType.Pinned);
var _memHandler = _gcHandle.AddrOfPinnedObject(); 
```

如果我想在之后重新调整代码中的 _memory 大小，我将如何在不取消固定它的情况下做到这一点？我应该使用另一种技术吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:36:49.970

> 如果我想在之后重新调整代码中的 _memory 大小，我将如何在不取消固定它的情况下做到这一点？

没有可靠的方法来做到这一点，也没有任何托管 API 来完成它。问题是，一旦内存被固定，就无法移动。调整数组的大小很可能需要在不同的位置进行分配（因为在当前位置可能没有足够大的连续内存块）。

因此，您需要取消固定内存、重新分配/调整大小，然后创建新的固定数组。确保任何持有内存的本机代码（这将是首先固定的原因）更新为不使用以前的内存位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T15:38:16.207

在 C# 中，根本无法重新调整数组的大小（无论它是否固定）。您只能创建所需大小的新数组。

如果您创建一个新阵列，则无法将其固定到旧阵列已固定的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T16:04:03.477

不，如果你仔细想想，这是不可能做到可靠的。

想象一块内存设置如下：

[some_string][_memory][boxed_int32][some_URI]

`_memory`那么如果不移动它就不可能重新调整大小。

您可能希望的最好结果是一个电话，如果可能的话，它将重新调整它的大小，而不是其他方式（失败并迫使您通过复制重新调整大小，或者在必要时进行复制并让您知道哪种方法有效） .

因此，就目前而言，这不太可能，但是如何抓住可能作为优化的情况。如果同时收集了 [some_URI] 怎么办？

遗憾的是（尽管对于大多数代码，包括你的应用程序的其余部分来说真的很高兴），对于这种相对罕见的情况，这不会作为一种优化，因为已经对整个内存管理进行了优化，因为 GC 会移动东西如果有差距，则进入该位置，以减少碎片化。固定阵列会降低移动东西的效率，只会增加它这样做的机会（因为你可能已经强迫它在阵列之前留出不少空间）。

如果您的阵列位于 LOH 上，则它之后的空间更有可能未被使用，但它被释放的可能性较小。

因此，即使这种 re-malloc 在理论上有时可以工作，但它在任何给定时间工作的几率太小，不值得实施。

# php - Php 表单提交 - 在同一页面而不是另一个页面上的“谢谢”消息？

> ID：11937586
> 
> 赞同：1
> 
> 时间：2012-08-13T15:34:46.880
> 
> 标签：php, html, forms, lightbox

我有一个带有 php 表单提交的 html 页面，它非常基本.. 我现在要做的是提交，然后转到一个空白页面，上面写着“谢谢”等，但我在看什么要做的是当用户提交表单时，它会弹出一个窗口或灯箱，上面写着“谢谢提交”。我怎样才能做到这一点？这是表单的 html 代码，以及提交的实际 php 代码。

html代码：

```
 <form method="post" action="includes/buy.php">
        <h2> Sizes: </h2><select name="sizes"><option value="1">1</option></select>
        <h2> Email: </h2><input type="text" name="email" />
        <input type="hidden" value="black" name="color" />
        <input  type="image" value="submit" src="images/buynow.jpg" />
        </form> 
```

php表单提交代码：

```
<?php
if(isset($_POST['email'])) {

$email_to = " ";
$email_subject = "subject line here";

function died($error) {
echo "We're sorry, but there's errors found with the form you submitted.<br /><br />";
echo $error."<br /><br />";
echo "Please go back and fix these errors.<br /><br />";
die();
}

if(!isset($_POST['email'])) {
died('We are sorry, but there appears to be a problem with the form you submitted.');       
}

$email_from = $_POST['email']; 
$color = $_POST['color'];
$sizes = $_POST['sizes'];

$error_message = "";
$email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
if(!preg_match($email_exp,$email_from)) {
$error_message .= 'The Email Address you entered does not appear to be valid.<br />';
}

if(strlen($error_message) > 0) {
died($error_message);
}
$email_message = "Form details:\n\n";

function clean_string($string) {
$bad = array("content-type","bcc:","to:","cc:","href");
return str_replace($bad,"",$string);
}

$email_message .= "Email: ".clean_string($email_from)."\n";
$email_message .= "Size: ".clean_string($sizes)."\n";
$email_message .= "Color: ".clean_string($color)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<?php
}
die();
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T16:13:51.500

我建议你使用[**AJAX**](http://api.jquery.com/jQuery.ajax/)。这是一个例子：

**HTML：**

```
<form name="yourForm" action="">
    <input type="text" name="field1" />
    <input type="text" name="field2" />
    <input type="submit" class="formSubmit" />
</form> 
```

**JavaScript (jQuery):**

```
$('.formSubmit').on('click', function() {
    var field1 = $('input[name=field1]').val();
    var field2 = $('input[name=field2]').val();
    $.ajax({
        type: 'POST';
        url: 'yourPHPScript.php?f1='+ field1 +'&f2='+ field2;
        success: function(result) {
            alert(result);
        }
    });
}); 
```

**PHP：**

```
// proccess the data
die('successful'); 
```

在 PHP 文件中：如果有问题，只`die()`显示那个结果，它会显示一个`alert()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:38:02.483

如果您想在没有页面加载的情况下执行此操作（即使用弹出对话框或类似的方法），则需要考虑使用 AJAX。但是，如果重新加载页面没问题，您可以只使用当前页面作为页面表单的目标并在同一脚本中处理表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:39:00.607

如果您对它在单独的窗口中弹出感到满意，您可以将表单的目标设置为 _new 或 _blank。更好的解决方案是使用javascript通过AJAX提交表单，然后在页面中显示结果。

[在将 JavaScript 与 AJAX 一起使用时，查看 jQuery，特别是jQuery.post](http://api.jquery.com/jQuery.post/)可能是明智之举。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-25T04:02:12.713

如果您想将一个快速简单的 PHP 链接到另一个 .php 文件

你可以做类似的事情

```
<?php
  echo $_POST['field1'];
?> 
```

不得不从我的手机上快速阅读我在课堂上，但希望这会有所帮助

# objective-c - iOS 目标 c - NSDictionary 异常的 JSON 字符串

> ID：11937587
> 
> 赞同：2
> 
> 时间：2012-08-13T15:34:48.673
> 
> 标签：objective-c, ios, json, nsdictionary, sbjson

我对 Objective-C 比较陌生，并且遵循了 MapKit 简介的教程（位于[此处](http://www.raywenderlich.com/2847/introduction-to-mapkit-on-ios-tutorial)）。我一直在尝试调试将 JSON 字符串传递给 NSDictionary 的问题。我收到以下错误：

```
2012-08-13 11:18:30.370 ArrestsPlotter[76578:c07] -[__NSCFString JSONValue]: unrecognized
selector sent to instance 0x73a6400
2012-08-13 11:18:30.372 ArrestsPlotter[76578:c07] *** Terminating app due to uncaught 
exception 'NSInvalidArgumentException', reason: '-[__NSCFString JSONValue]: unrecognized 
selector sent to instance 0x73a6400'
*** First throw call stack:
(0x17b4022 0x131bcd6 0x17b5cbd 0x171aed0 0x171acb2 0x34782 0x35351 0x1c65e 0x17b5e42 
0xda49df 0x178894f 0x16ebb43 0x16eb424 0x16ead84 0x16eac9b 0x1ddd7d8 0x1ddd88a 0x47e626 
0x3403d 0x20f5)
terminate called throwing an exception 
```

我已将其缩小到给我问题的这条线：

```
NSDictionary * root = [responseString JSONValue]; 
```

根据 SBJSON 库文档，这是可能的。我认为这与我传递给 NSDictionary 的字符串有关。下面是创建 JSON 字符串的代码：

```
// 1
MKCoordinateRegion mapRegion = [_mapView region];
CLLocationCoordinate2D centerLocation = mapRegion.center;

// 2
NSString *jsonFile = [[NSBundle mainBundle] pathForResource:@"command" ofType:@"json"];
NSString *formatString = [NSString stringWithContentsOfFile:jsonFile encoding:NSUTF8StringEncoding error:nil];
NSString *json = [NSString stringWithFormat:formatString,
                  centerLocation.latitude, centerLocation.longitude, 0.5*METERS_PER_MILE];

// 3
NSURL *url = [NSURL URLWithString:@"http://data.baltimorecity.gov/api/views/INLINE/rows.json?method=index"];

// 4
ASIHTTPRequest *_request = [ASIHTTPRequest requestWithURL:url];
__weak ASIHTTPRequest *request = _request;

request.requestMethod = @"POST";
[request addRequestHeader:@"Content-Type" value:@"application/json"];
[request appendPostData:[json dataUsingEncoding:NSUTF8StringEncoding]];
// 5
[request setDelegate:self];
[request setCompletionBlock:^{
    NSString *responseString = [request responseString];
    NSLog(@"Response: %@", responseString);
    [self plotCrimePositions:responseString]; 
```

字符串被正确填充，并且在终端中显示如下（整个事情很大，所以我只会发布少量）：

```
2012-08-13 11:18:30.210 ArrestsPlotter[76578:c07] Response: {
"meta" : {
"view" : {
  "id" : "zzzz-zzzz",
  "name" : "Inline View",
  "attribution" : "Baltimore Police Department",
  "attributionLink" : "http://www.baltimorepolice.org/",
  "averageRating" : 0,
  "category" : "Crime",
  "licenseId" : "CC_30_BY",
  "numberOfComments" : 0,
  "oid" : 0,
  "publicationAppendEnabled" : false,
  "publicationStage" : "unpublished",
  "rowsUpdatedAt" : 1338813661,
  "rowsUpdatedBy" : "n22b-663u",
  "signed" : false,
  "tableId" : 354024,
  "totalTimesRated" : 0,
  "viewType" : "tabular",
  "columns" : [ {
    "id" : -1,
    "name" : "sid",
    "dataTypeName" : "meta_data",
    "fieldName" : ":sid",
    "position" : 0,
    "renderTypeName" : "meta_data",
    "format" : {
    }
  }, {
    "id" : -1,
    "name" : "id",
    "dataTypeName" : "meta_data",
    "fieldName" : ":id",
    "position" : 0,
    "renderTypeName" : "meta_data",
    "format" : {
    }
  } 
```

任何帮助，将不胜感激。我意识到我使用的教程有点过时了，但我以前从未使用过 JSON，所以我不太确定问题出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:51:28.307

该问题是由于尝试将消息发送到不支持此方法`JSONValue`的实例而引起的。`NSString`请尝试以下代码

```
SBJsonParser *jsonParser = [[SBJsonParser alloc] init];
NSError *error = nil;
NSArray *jsonObjects = [jsonParser objectWithString:responseString error:&error]; 
```

这应该给你一个包含响应数据的 NSDictionaries 的 NSArray。

您还可以尝试在此处复制和粘贴整个 JSON 响应以检查它是否有效

[http://jsonformatter.curiousconcept.com/](http://jsonformatter.curiousconcept.com/)

编辑：尽管正如其他一些答案所指出的，`#importing SBJSON.h`应该使用类别动态地将`JSONValue`方法添加到类中。`NSString`在这里解释

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:54:09.070

实际上问题不在于缺少标头导入（嗯，这可能是问题的一部分），而是缺少实现`.m`文件。您需要确保它`NSObject+SBJson.m`包含在您的项目中，无论是独立的还是作为库的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:45:36.713

该错误表明该`JSONValue`方法未知。您是否已将其添加`#import "SBJSON.h"`到您的课程中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T15:45:48.510

这里的问题是您没有将 SBJSON 正确导入到您的项目中。看看并确保您在源文件的顶部包含了带有正确标题的导入语句。

# sql - 如何将多行结果连接到一行？

> ID：11937590
> 
> 赞同：1
> 
> 时间：2012-08-13T15:35:00.657
> 
> 标签：sql, sql-server

> **可能重复：**
> [连接分组行](https://stackoverflow.com/questions/9139472/concatenate-grouped-rows)

我正在使用这张桌子：

```
fecha                    cliente    preg  resp  puntos  calif   pagoxejec
2009-03-28 00:00:00 2005   9        23     1      94       5    5
2009-03-28 00:00:00 2005   9        31     1      94       5    5
2009-03-28 00:00:00 2005   9        32     1      55       3    3
2009-03-28 00:00:00 2005   9        33     1      37       2    2
2009-03-28 00:00:00 2005   9        34     0      0        0    0
2009-03-28 00:00:00 2379   7         8     1      0       35    35 
```

（这有更多的记录。）

我有一个名为的表`cliente`，现在这是我的查询：

```
DECLARE @supervisor varchar(50)/* sera una cadena de tipo 1 ó   3,4,5 para usarse como supervisor in (@supervisor)*/      
DECLARE @fechainicial datetime /*será la fecha inicial tomada*/      
DECLARE @fechafinal datetime /*será la fecha final tomada*/      
SET @supervisor='1,2,3,4'
SET @fechainicial='2009-02-1 00:00:00.000'
SET @fechafinal='2009-03-19 00:00:00.000'

SELECT smerc.cliente, nivelmkt nivel, MAX(fecha) ultima, preg, resp
FROM smerc
INNER JOIN clientes on smerc.cliente=clientes.cliente
WHERE fecha BETWEEN @fechainicial AND @fechafinal
    AND resp=1
GROUP BY smerc.cliente, preg, resp, nivelmkt
ORDER BY smerc.cliente 
```

还有一些结果：

```
cliente nivel   ultima          preg resp
 892     1  2009-03-03 00:00:00 2   1
 892     1  2009-03-03 00:00:00 3   1
 892     1  2009-03-03 00:00:00 6   1
 892     1  2009-03-03 00:00:00 23  1
 892     1  2009-03-03 00:00:00 32  1
 892     1  2009-03-03 00:00:00 34  1
 892     1  2009-03-03 00:00:00 44  1
 892     1  2009-03-03 00:00:00 999 1
1889     1  2009-03-03 00:00:00 2   1 
```

表`nivel`：

```
 nivel preg    nomtiny
1   1   E  
1   2   OME
1   3   EX 
1   4   EP 
1   5   E7 
1   6   ROT
1   11  H  
1   12  PPA
1   21  PDV
1   23  CDP
1   31  EXI
1   32  PLC
1   33  COP
1   34  PM 
1   40  O  
1   41  PAP
1   44  NCA
1   999 PRP
2   1   E 
```

现在我需要下一个结果：

```
cliente    nivel    preg    nomtiny
892    1    1   E  
892    1    4   EP 
892    1    5   E7 
892    1    11  H  
892    1    12  PPA
892    1    21  PDV
892    1    31  EXI
892    1    33  COP
892    1    40  O  
892    1    41  PAP 
```

你可以在`smerc (BETWEEN @fechainicial AND @fechafinal)` 这个客户端上看到最后一个结果没有这个 spreguntas'records 或 respuesta=0

> （2条件客户没有这个preg，（与cliente'nivel）或者他确实有这个记录但resp等于0）

那么我的最终结果一定是这样的：

```
client  allnomtinyforthisclient
892   E,EP,E7,H,PPA,PDV,EXI,COP,O,PAP 
```

如上所述，如何让多行出现在一行上？

服务器是 sql 2005

# ios - 如何显示在同一个 nib 文件中定义的自定义 UITableViewCell

> ID：11937591
> 
> 赞同：1
> 
> 时间：2012-08-13T15:35:00.077
> 
> 标签：ios, uitableview

我在与 UITableView 相同的 nib 文件中设计了一个自定义 UITableViewCell。然后我使用以下代码显示它：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"SearchViewCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...
    NSInteger section = [indexPath section];

    switch (section) {
        case 0: // First cell in section 1
            return self.priceRangeCell;
            break;
        default:
            // Do something else here if a cell other than 1,2,3 or 4 is requested

            return cell;
            break;
    } 
```

我的问题是我对整个 dequeueReusableCellWithIdentifier 业务感到困惑。我什至需要以下部分吗？？：

```
 static NSString *CellIdentifier = @"SearchViewCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    } 
```

你能看到我的代码有什么其他问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:51:02.360

您不必绝对使用您提到的代码，但不这样做会很糟糕。如果您不使用该 if 子句，则每次滚动表格时都会创建新单元格，而不是重用旧单元格——这对内存使用不利。

其次，你的代码中缺少一些东西——你没有用任何东西填充你的单元格。您返回了一个单元格，但尚未向其中添加任何内容。

# javascript - 如何换行以填充 DIV（如在 MS-Excel 中）

> ID：11937597
> 
> 赞同：0
> 
> 时间：2012-08-13T15:35:26.193
> 
> 标签：javascript, jquery, html, css

> **可能重复：**
> [自动调整大小的动态文本以填充固定大小的容器](https://stackoverflow.com/questions/687998/auto-size-dynamic-text-to-fill-fixed-size-container)

我怎样才能让这个文本自动缩小/放大字体大小以完美地包裹在盒子大小中？

我正在尝试使用 HTML 和 CSS 来执行此操作，但我没有看到任何选项。如果有办法，我不介意使用 javascript/jquery。

![溢出容器的文本](../Images/6e9b0b65f45d9aa968b339d038a72289.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:59:53.637

可能是这样的？

[http://jsbin.com/opuzur/3/edit](http://jsbin.com/opuzur/3/edit)

编辑：当然有人已经提出了更好的解决方案......查看约翰评论中的链接，有一些很好的解决方案！尽管如此，尝试一下还是很有趣的！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:15:43.617

试试 jQuery 截断插件[trunk8](https://github.com/rviscomi/trunk8)

# eclipse - 在 Linux 中从命令行安装 Eclipse 插件

> ID：11937598
> 
> 赞同：0
> 
> 时间：2012-08-13T15:35:38.487
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我在 linux 中使用 [http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Fguide%2Fp2_director.html安装 eclipse 插件时失败](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Fguide%2Fp2_director.html)

在 Windows 的 Eclipse 中，我可以找到文件 eclipsec，但在 linux 中找不到。

此外，当我在 linux 中使用 eclipse 而不是 eclipsec 时，我得到了未找到可安装单元的错误，并且它存在并且相同的命令适用于 windows

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:51:15.060

您提供的链接已失效。但是，您应该能够将插件 jar 文件直接放在 Eclipse 文件夹中的 dropins 文件夹下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T11:09:08.947

我使用 eclipse 而不是 eclipsec 并且它已正确安装

# jquery - 将子元素分组到较小的子组中

> ID：11937611
> 
> 赞同：1
> 
> 时间：2012-08-13T15:36:37.720
> 
> 标签：jquery

我希望能够将元素分组为 4 组或尽可能接近 4 组。假设我的 html 看起来像：

```
<div class="container">
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
</div> 
```

我希望输出为：

```
<div class="container">
    <div class="section">
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
    </div>
    <div class="section">
        <div class="item"></div>
        <div class="item"></div>
    </div>
</div> 
```

在一个完美的世界中，我只会更改 html，但在这种情况下我不能，因为它是在服务器端生成的。我认为`nextUntil()`这是我想要的，但我不确定如何实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:53:03.330

试试这个：

```
var $items = $('.container div.items');

for (var i = 0; i < $items.length; i+=4) {
  $items.slice(i, i+4).wrapAll('<div class="section"/>')
} 
```

​<a href="http://jsfiddle.net/4sv66/1/" rel="nofollow">演示

# ios - 是否可以轻松显示在视图控制器更改时保持可见的视图？

> ID：11937613
> 
> 赞同：0
> 
> 时间：2012-08-13T15:36:49.733
> 
> 标签：ios

我需要在导航栏下方显示一个类似状态栏的薄视图，该视图滑入视图并在发生某些操作时滑回视线之前保持可见几秒钟。

对于任何给定的视图控制器，我可以很容易地做到这一点，方法是在需要出现/消失时适当地为其框架设置动画。

但是我有几个不同的视图控制器，我不想复制相同的代码来管理每个控制器中栏的外观。除了代码重复之外，我怀疑如果在更改控制器时该栏当前是可见的，则在控制器之间导航时会出现闪烁。

有哪些方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:49:48.223

在您的 appDelegate 中创建一个方法以将您的自定义视图添加到主窗口。这样，每当您触发显示自定义视图方法时，它将位于视图层次结构的顶部。

需要注意的一件事是，如果您的应用程序更改了方向，您必须为自定义视图手动更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:47:18.170

只需将其`UIView`在层次结构中向上移动即可。例如，将它放在您`UINavigationController`的 's`superview`中，这样它将显示在 UINavigationController 的视图上方。

您可能需要将它放在前面，并可能`UIView`使用[convertRect:toView:](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/doc/uid/TP40006816-CH3-DontLinkElementID_63)或类似的东西来转换这个“类似状态栏”的框架。

# php - 突然无法从数据库中读取？

> ID：11937617
> 
> 赞同：0
> 
> 时间：2012-08-13T15:37:06.847
> 
> 标签：php, mysql, database

在过去的一个小时里，我一直在努力弄清楚为什么当我确定行列式是正确的时某些函数总是返回错误的布尔值。

因此，作为调试器，我越来越抽象地测试所有变量，直到我实际测试血腥数据库连接。

我可以连接到我的数据库，但发送给它的每个查询总是返回 false。我很混乱。这怎么可能是错的？

```
$db = new PDO('mysql:db=privatechat;host=127.0.0.1', 'root', '');
var_dump($db);
$stmt = $db->prepare("SELECT * FROM `accounts`");
var_dump($stmt);
$stmt->execute();
$row = $stmt->fetch();
var_dump($row); 
```

结果：

```
object(PDO)#1 (0) { } object(PDOStatement)#2 (1) { ["queryString"]=> string(24) "SELECT * FROM `accounts`" } bool(false) 
```

这是疯狂的部分......当我连接到另一个本地项目时，它很好！？

这是我的数据库和表的屏幕截图：

![数据库和表](../Images/4337906d3e5f6b0022e200abd1996d68.png)

当我提交这个问题时，我才意识到“db=”应该是“dbname=”

好心疼！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:40:08.403

您想要`dbname=privatechat`在您的 DSN 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:40:16.923

PDO 连接字符串应该是“mysql:dbname=privatechat” 我错过了“名称”部分！哎呀！

# java - 非法状态异常： 目前不在 FragmentManager 中

> ID：11937622
> 
> 赞同：34
> 
> 时间：2012-08-13T15:37:18.857
> 
> 标签：java, android, android-fragments, android-viewpager, illegalstateexception

我知道这听起来像是[FragmentStatePagerAdapter IllegalStateException: <MyFragment> 当前不在 FragmentManager 中](https://stackoverflow.com/questions/11296411/fragmentstatepageradapter-illegalstateexception-myfragment-is-not-currently)的副本， 但他的解决方案与我的情况无关。

我很少遇到以下崩溃：

> java.lang.RuntimeException：无法暂停活动 {MyActivity}：
> 
> ...
> 
> 引起：java.lang.IllegalStateException: Fragment MyFragment {40648258 id=0x7f070051} 当前不在 android.support.v4.app.FragmentManagerImpl.putFragment(MT:516) 的 FragmentManager 中 android.support.v4.app.FragmentStatePagerAdapter .saveState(MT:185) 在 android.support.v4.view.ViewPager.onSaveInstanceState(MT:881)
> 
> ...
> 
> 在 android.view.View.saveHierarchyState(View.java:6238) 在 com.android.internal.policy.impl.PhoneWindow.saveHierarchyState(PhoneWindow.java:1522) 在 android.app.Activity.onSaveInstanceState(Activity.java:1138 ) 在 android.support.v4.app.FragmentActivity.onSaveInstanceState(MT:480) 在 MyActivity.onSaveInstanceState(MT:336)

这似乎是我无法理解的奇怪代码`FragmentStatePagerAdapter`：

```
for (int i=0; i<mFragments.size(); i++) {
    Fragment f = mFragments.get(i);
    if (f != null) {
        if (state == null) {
            state = new Bundle();
        }
        String key = "f" + i;
        mFragmentManager.putFragment(state, key, f);
    }
} 
```

看起来适配器从我的位置`Fragment`获取`mFragments`但无法将其状态添加到`FragmentManager`.

我找不到任何方法在我的测试设备上重新创建它，只从一些用户那里收到。

我正在使用支持包 v4。

有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-04-16T16:19:39.377

这`FragmentStatePagerAdapter`是一段可怕的代码，充满了谷歌承认或不承认的错误，所以我使用这段代码来修复这个特定的崩溃：

```
 @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        // Yet another bug in FragmentStatePagerAdapter that destroyItem is called on fragment that hasnt been added. Need to catch
        try {
            super.destroyItem(container, position, object);
        } catch (IllegalStateException ex) {
            ex.printStackTrace();
        }
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-10-13T15:03:31.593

当在 ViewPager 上设置 FragmentStatePagerAdapter 时，可能会发生这种情况，并且 Fragment 已填充，但由于在 ViewPager 发生布局之前 Activity 暂停而尚未添加到 FragmentManager。这可以通过从 onCreate 启动另一个 Activity 来可靠地实现，适配器也在 onCreate 中设置。在这种情况下，最好不要设置 Adapter，而是将其设置为 onActivityResult。看到这个问题：[https ://code.google.com/p/android/issues/detail?id=77285](https://code.google.com/p/android/issues/detail?id=77285)

我还提交了一个补丁来检查是否在尝试保存状态之前添加了 Fragment。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-09-05T05:47:29.823

我遇到了确切的例外。

就我而言，我有几个 FragmentPagerStateAdapter 管理的片段，但有时片段会切换到位。

我重写 getItemPosition() 并返回新位置并调用 notifyDataSetChanged() 以刷新 ViewPager。一切正常，但有时当我离开 ViewPager 时会发生崩溃。

经过几个小时的深入研究，我发现 FragmentPagerStateAdapter 中有一个错误。

适配器不仅缓存状态，还缓存它认为“活跃”的片段

```
private ArrayList<Fragment.SavedState> mSavedState = new ArrayList<Fragment.SavedState>();
private ArrayList<Fragment> mFragments = new ArrayList<Fragment>(); 
```

但它不检查片段的位置是否已失效或移动。

这就是它如何得到这个异常：

1.ViewPager和Adapter中有A,B,C三个Fragment。

2.我在适配器中将位置切换到B，A，C并调用notifyDataSetChanged（）。

3.ViewPager 按新顺序重新布局片段。但是 mFragments 缓存仍然是 {A,B,C}

4.Swipe几个页面，ViewPager会要求adapter销毁第一个Fragment。**然后片段 B，而不是 A，在缓存中设置为空。**现在 mFragments 是 {null,A,C}。

5.离开ViewPager，触发onSaveInstanceState。mFragments 中的所有片段都被认为是活动的，并且调用 putFragment() 直到 FragmentManagerImpl 发现 A 不在其中并抛出异常。

所以这是我不那么温和的解决方案：

1.复制整个 FragmentPagerStateAdapter 源代码。

2.重写 notifyDataSetChanged() 方法以重新排列缓存，如下所示。

```
@Override
public void notifyDataSetChanged() {
  List<Fragment> oldFragments = new ArrayList<>(mFragments);
  List<Fragment.SavedState> oldStates = new ArrayList<>(mSavedState);
  for (int i = 0; i < getCount(); i++) {
    if (i < mFragments.size()) {
      Fragment f = mFragments.get(i);
      if (f != null) {
        int newPosition = getItemPosition(f);
        if (newPosition == POSITION_UNCHANGED || newPosition == i) {
        } else if (newPosition == POSITION_NONE) {
          if (i < mSavedState.size()) {
            mSavedState.set(i, null);
          }
          mFragments.set(i, null);
        } else {
          while (i >= mFragments.size()) {
            mFragments.add(null);
          }
          if (oldStates.size() > i) {
            mSavedState.set(newPosition, oldStates.get(i));
          }
          mFragments.set(newPosition, oldFragments.get(i));
        }
      } else {
        /*
         * No Fragment but that's possible there's savedState and position has
         * changed.
         */
      }
    }
  }
  super.notifyDataSetChanged();
} 
```

希望这对你们中的一些人有用！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-10-12T09:21:47.997

如果您有片段层次结构，请使用`getChildFragmentManager()`而不是。`getFragmentManager()`例如。如果你有片段寻呼机。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-03T18:18:51.880

如果您的 ViewPager 布局在片段（不是活动）内：

`mViewPager.setAdapter(new MyFragmentStatePagerAdapter(get**Child**FragmentManager()));`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-20T11:34:45.530

使用以下

```
final FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
ft.add(f, key); 
```

代替

```
mFragmentManager.putFragment(state, key, f); 
```

并明确传递捆绑包..

以供参考，

[http://developer.android.com/reference/android/app/FragmentTransaction.html#add%28android.app.Fragment,%20java.lang.String%29](http://developer.android.com/reference/android/app/FragmentTransaction.html#add%28android.app.Fragment,%20java.lang.String%29)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-31T05:20:31.357

写在 Activity onCreate() 方法中：

```
pager = (ViewPager) findViewById(R.id.pager);
    adapter = new SwipePagerAdapter(getSupportFragmentManager());
    pageOneFragment = new PageOneFragment();
    adapter.addFragment(pageOneFragment); 
```

适配器代码：

```
public class SwipePagerAdapter extends FragmentStatePagerAdapter
{
private final ArrayList<Fragment> mFragments = new ArrayList<Fragment>();

public SwipePagerAdapter(FragmentManager fm)
{
    super(fm);
}

@Override
public Fragment getItem(int position)
{
    return mFragments.get(position);
}

@Override
public int getCount()
{
    return mFragments.size();
}

public void addFragment(Fragment fragment)
{
    mFragments.add(fragment);
    notifyDataSetChanged();
}

@Override
public void destroyItem(ViewGroup container, int position, Object object)
{
    super.destroyItem(container, position, object);
}

@Override
public CharSequence getPageTitle(int position)
{
    return super.getPageTitle(position);
}} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-26T06:56:55.100

您是从自己的代码中调用**FragmentStatePagerAdapter.instantiateItem()吗？**通常，ViewPager 应该是调用此方法的唯一客户端，但是，很容易遇到依赖此方法的其他限制的变通方法。

由于`FragmentStatePagerAdapter`工作方式的原因，我猜适配器已经实例化了 Fragment，将其添加到其内部的 Fragment 集合中，甚至开始了一个事务以将该 Fragment 添加到 FragmentManager，但该片段事务尚未提交或执行。这正是`instantiateItem()`它尚未实例化请求的 Fragment 时所做的事情。

另一种方法`FragmentStatePagerAdapter.finishUpdate()`是负责提交事务以及执行挂起的事务。 **finishUpdate() 必须在 instantiateItem() 之后调用，**否则 Fragment 可能不会添加到 FragmentManager。

尝试这样的事情：

```
// Get the current Fragment presented by the ViewPager.
pagerAdapter.startUpdate(viewPager);
Fragment fragment = pagerAdapter.instantiateItem(viewPager, viewPager.getCurrentItem());
pagerAdapter.finishUpdate(viewPager);
return fragment; 
```

从 API 级别 19 开始，startUpdate() 的实现为空。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-14T23:54:12.580

尝试使用

```
use fragmentTransaction.add() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-15T21:12:48.543

你可以尝试使用`mFragmentManager.add();`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-20T12:46:22.520

ViewPager 中的 Fragment 是固定的，而不是尝试替换适配器中的 Fragment，而是尝试给不同的 Fragment 集并更改 notifyDataSet，或者利用 FrameLayout 在视图分页器选项卡的当前 Fragment 上显示另一个 Fragment。

有我的解决方案有效：

[在 Fragment 级别与 ViewPager 一起应用的滑动手势，默认滑动禁用](https://stackoverflow.com/questions/18821775/swipe-gesture-applied-at-fragment-level-along-with-viewpager-with-its-default-s/19020100#19020100)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-07T23:05:55.190

仔细检查您是否已实现`onSaveInstanceState`并`onRestoreInstanceState`在您的活动中，并验证它们是否正确保存和加载片段的状态。

# python - 为 mac os 10.5.8 安装 numpy 时遇到问题

> ID：11937626
> 
> 赞同：0
> 
> 时间：2012-08-13T15:37:45.650
> 
> 标签：python, numpy, installation

我的 Mac 上有 python 版本 2.7.2。当我下载适用于 Python 2.7 的 numPy/sciPy/matplotlib 的 sourceforge 版本时，我经历了一个 5 步安装过程，这会导致错误：

```
"You cannot install numpy 1.6.2 on this volume. numpy requires python.org Python 2.7 to install." 
```

然而，当我通过在终端中输入“python”来检查我的 python 版本号时，我得到：

```
Enthought Python Distribution -- www.enthought.com
Version: 7.1-2 (32-bit)
Python 2.7.2 |EPD 7.1-2 (32-bit)| (default, Jul 27 2011, 13:29:32) 
```

这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:46:29.443

听起来 numpy 安装程序只想安装在 Python 的标准发行版之上，而您的默认解释器是 Enthought 发行版。不过很简单：Enthought[已经有了](http://www.enthought.com/products/epdlibraries.php)numpy/scipy/matplotlib，所以我认为你根本不需要安装它们。

# vbscript - 复制文件夹中第二个最新修改的文 件：需要帮助

> ID：11937629
> 
> 赞同：0
> 
> 时间：2012-08-13T15:37:52.697
> 
> 标签：vbscript

我遇到了麻烦，我需要在 VBScripting 中执行以下任务。提前感谢您的帮助。

我想将第二个最新修改的文​​件从一个文件夹复制到另一个位置。

例如：源文件夹“Final”将包含许多子文件夹。运行脚本后，它应该检查“Final”的所有子文件夹中第二个最新修改的文​​件，并将其复制到目标文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T02:52:47.873

@user，我相信这是您正在寻找的功能。我在`Sub Find()`. 不保证没有错误，我相信异常处理可以进一步改进。

**提示**：有关将 Microsoft 的权威 WSH 参考下载为 Windows 帮助文件的信息，请参阅[此答案。](https://stackoverflow.com/a/11371416/1497596)

```
Option Explicit

Dim oFF : Set oFF = New FileFinder
oFF.RootFolder = "C:\Source\Folder"  ' absolute or relative path
oFF.DestinationFolder = "C:\Copy\Folder\" ' must end with backslash

On Error Resume Next

'
' Find the newest and second-newest files.
'
oFF.Find

If Err Then
    WScript.Echo "Find error: " & Err.Description
    WScript.Quit(1)
Else
    WScript.Echo "Newest file: " & oFF.NewestFilePath
    WScript.Echo "Second-newest file: " & oFF.SecondNewestFilePath
End If

'
' Copy the second-newest file to the destination folder.
'
oFF.CopySecondNewestFileToDestination

If Err Then
    WScript.Echo "Copy error: " & Err.Description
    WScript.Quit(1)
Else
    WScript.Echo "'" & oFF.SecondNewestFilePath _
           & "' was copied to folder '" & oFF.DestinationFolder & "'."
End If

Set oFF = Nothing

' ============================================================

Class FileFinder

' Public RootFolder
Public NewestFilePath
Public NewestFileDate
Public SecondNewestFilePath
Public SecondNewestFileDate

Private mFso
Private mRootFolder
Private mDestinationFolder

Private Sub Class_Initialize()
    Set mFso = CreateObject("Scripting.FileSystemObject")
    Me.SecondNewestFilePath = ""
    Me.SecondNewestFileDate = CDate("1970/01/01")
    Me.NewestFilePath = ""
    Me.NewestFileDate = DateAdd("s", 1, Me.SecondNewestFileDate)
End Sub

Private Sub Class_Terminate()
    Set mFso = Nothing
End Sub

Public Property Let RootFolder(sValue)
    If Not mFso.FolderExists(sValue) Then
        Err.Raise vbObjectError + 1, "", _
           "Root folder '" & sValue & "' does not exist."
    End If

    mRootFolder = sValue
End Property

Public Property Get RootFolder()
    RootFolder = mRootFolder
End Property

Public Property Let DestinationFolder(sValue)
    If Not (Right(sValue, 1) = "\") Then
        Err.Raise vbObjectError + 1, "", _
           "Destination folder '" & sValue & "' must end with a backslash."
    End If

    If Not mFso.FolderExists(sValue) Then
        Err.Raise vbObjectError + 1, "", _
           "Destination folder '" & sValue & "' does not exist."
    End If

    mDestinationFolder = sValue
End Property

Public Property Get DestinationFolder()
    DestinationFolder = mDestinationFolder
End Property

Public Sub Find()
    Dim oFolder : Set oFolder = mFso.GetFolder(RootFolder)
    Dim oSubFolder, oFile

    For Each oSubFolder In oFolder.SubFolders
        For Each oFile In oSubFolder.Files
            '
            ' File is newer than newest file.
            '
            If DateDiff("s", NewestFileDate, _
                        oFile.DateLastModified) > 0 Then
                SecondNewestFilePath = NewestFilePath
                SecondNewestFileDate = NewestFileDate
                NewestFilePath = oFile.Path
                NewestFileDate = oFile.DateLastModified

            '
            ' File is newer than second-newest file.
            '
            ElseIf DateDiff("s", SecondNewestFileDate, _
                            oFile.DateLastModified) > 0 Then
                SecondNewestFilePath = oFile.Path
                SecondNewestFileDate = oFile.DateLastModified
            End If
        Next
    Next
End Sub

Public Sub CopySecondNewestFileToDestination()
    mFso.CopyFile SecondNewestFilePath, DestinationFolder
End Sub

End Class 
```

# sql - 如何使用 BCP 卸载数据？

> ID：11937632
> 
> 赞同：0
> 
> 时间：2012-08-13T15:37:53.420
> 
> 标签：sql

如何从 DbArtisan 或 Sql Server Management Studio 生成 BCP 命令行？我已经挣扎了 2 个小时才能通过我的 windows shell 从表中获取数据，无论我做什么，它告诉我的只是“未找到请求的服务器名称”，尽管服务器本身和 Sql Server 的实例是“可ping通的” “……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T09:14:10.283

我终于选择了使用 SSMS 工具。它是 SQL Server Management Studio 的免费插件。我正在使用的一个功能是只需单击一下即可为一堆表生成插入语句的能力......考虑到我正在使用日志传送并且这些插入语句将与 BCP 操作相反地被捕获，这对我来说也很有趣。

# c - 为什么我们不能对 C 中的结构进行算术运算？

> ID：11937638
> 
> 赞同：2
> 
> 时间：2012-08-13T15:38:13.210
> 
> 标签：c

```
struct a{
int a;
char b;
} c,d={1,2},e;

c=d //allowed
c=d+e  //not allowed 
```

赋值有效，因为编译器生成汇编代码来移动字节。所以其他运营商也可以做同样的事情。那么为什么C没有这个功能呢？

<============>

正如所问的，一些功能可以...... 1.在添加大量（超过长的）时，我们不必使用循环来长长地添加它。

c=a+b

将工作。

1.  移动数组。

2.  乘法。

所以我们不必编写额外的代码，因为这些东西编译器可以生成汇编代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-13T15:39:48.637

因为在 C 中没有办法告诉编译器预期的结果是什么。例如，您将如何添加 2 个这样的对象：

```
struct ss {
    char *str;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T15:51:19.523

因为你不能在结构上定义算术运算。它们不是数字，也不是字符串，也不是浮点数，也不是任何可计算的。如果您的结构是一些个人数据的列表，例如：

```
struct person {
  int age;
  char name[200];
  int zipcode;
  int sex;
  whatever_t whatever;
} Mary, Ivan; 
```

那你怎么定义 Mary + Ivan 呢？

编辑：

如果要添加下面的位，可以创建一个 char 数组，然后在其中创建 memcpy

```
int size = sizeof (struct person); 
char arr[size];
memcpy(arr, &person, size); 
```

然后将位与您以相同方式转换的另一个结构添加到内部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:53:06.057

我们可以。我们应该使用另一种技术。

作为 cnicutar 可悲的是，为什么我们不能告诉 C 编译器如何将 uperator`+`用于结构。基线是 complie 不知道这样的操作会产生什么结果。存在支持运算符重载（C++/C#）的语言，但对于这种情况，我们必须使用一些设计方法，因为 C 不是其中之一，因此我们必须为该操作创建方法。

所以`c = d + e`我们可以写而不是`MyStructMath_add(d,e)`.

并自行实现您对此类操作所期望的逻辑。

# ruby - 无法在 OSX 上安装 gem mysql

> ID：11937643
> 
> 赞同：1
> 
> 时间：2012-08-13T15:38:34.160
> 
> 标签：ruby, macos, rubygems

我无法在我的 10.8 (mac osx) 机器上安装 mysql gem。我用自制软件安装了mysql

$brew 安装 mysql

然后我做：

```
$sudo gem install mysql
Building native extensions.  This could take a while...
ERROR:  Error installing mysql:
    ERROR: Failed to build gem native extension.

        /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/bin/ruby extconf.rb
checking for mysql_ssl_set()... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/bin/ruby
    --with-mysql-config
    --without-mysql-config
/Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
You have to install development tools first.
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:461:in `try_link0'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:476:in `try_link'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:619:in `try_func'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:894:in `block in have_func'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
    from /Users/marcinkrzyzanowski/.rvm/rubies/ruby-1.9.3-head/lib/ruby/1.9.1/mkmf.rb:893:in `have_func'
    from extconf.rb:50:in `<main>'

Gem files will remain installed in /Users/marcinkrzyzanowski/.rvm/gems/ruby-1.9.3-head/gems/mysql-2.8.1 for inspection.
Results logged to /Users/marcinkrzyzanowski/.rvm/gems/ruby-1.9.3-head/gems/mysql-2.8.1/ext/mysql_api/gem_make.out 
```

知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T23:37:33.003

升级到 Mountain Lion 之前是否安装了 mysql？我有同样的问题，这解决了它：

```
brew uninstall mysql
brew install mysql
gem install mysql 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:48:10.847

您需要一个 C 编译器来编译一些本机扩展。（这是 Ruby 要求。在 gem 使用 C 代码的更多情况下，您会看到此错误）

*   最简单的方法是安装[Xcode](https://developer.apple.com/xcode/)。
*   但是 Xcode 有很多额外的实用程序，如果您不仅想要编译器，那么您可能不需要这些实用程序。有一个项目（现在由 Apple 支持）只安装名为[Commandline tools for Xcode](http://kennethreitz.com/xcode-gcc-and-homebrew.html)的命令行工具（各种编译器和东西） 。安装这个（或 Xcode），然后尝试安装 gem。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T14:40:29.750

我有完全相同的问题，所以让我们看看我们是否可以一起解决它。我浏览了大量 Stack Overflow 帖子，但没有任何人建议有效。

*   XCode 4.6.3 已安装
*   从 DMG 安装的 Mysql 5.6.12 x64
*   OSX 10.8.4
*   红宝石 2.0.0-p195

Mysql 安装到**/usr/local/mysql**

尝试使用以下安装但没有成功：

```
sudo env ARCHFLAGS="-arch x86_64" gem install mysql --   --with-mysql-dir=/usr/local/mysql --with-mysql-lib=/usr/local/mysql/lib   --with-mysql-include=/usr/local/mysql/include 
```

`sudo find / -name mysql.h`结果是 `/usr/local/mysql-5.6.12-osx10.7-x86_64/include/mysql.h`

**/usr/local/mysql**是**/usr/local/mysql-5.6.12-osx10.7-x86_64的符号链接**

我会一直努力解决这个问题，所以如果我遇到任何事情，我会发布它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T16:10:47.487

我在尝试从命令行安装 mysql 时感到很痛苦，所以我只是去了网站并得到了它。这是链接：[http ://dev.mysql.com/downloads](http://dev.mysql.com/downloads)

然后选择dmg版本并安装。

我敢打赌，这绝对是您确实希望收到的答案（这里也一样），但否则我无法做到。

我在 OS X 10.7.4

# html - In Emacs, How to export Links to a clickable link, when htmlize emacs buffer?

> ID：11937649
> 
> 赞同：5
> 
> 时间：2012-08-13T15:38:53.043
> 
> 标签：html, emacs, lisp, elisp, org-mode

**BACKGROUND**

1.  I using great [htmlize.el](http://emacswiki.org/emacs/Htmlize) to export my org-mode buffer contents with font [hi-lock.](http://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively.html)
2.  Emacs org-mode has a [Link format.](http://orgmode.org/manual/Link-format.html)

**PROBLEM**

For Example, here is a org-mode file with contents:

```
[[http://hunmr.blogspot.com][blog]] 
```

When I Using [Htmlize.el](http://emacswiki.org/emacs/Htmlize) to htmlize buffer to HTML contents, The link was missing. produces HTML like:

```
<span style="hyperlinkFOOBAR">blog</span> 
```

**EXPECTED**

I expected it produces clickable link like:

```
<a style="hyperlinkFOOBAR" href="http://hunmr.blogspot.com">blog</a> 
```

**QUESTION**

**EDIT1** The org-export-as-html can export link, but can not create CSS for the Hi-locks.

*   Do you know other ways to to export org-mode links to HTML?
*   To read the real link in org-mode buffer using elisp, how to do that? read text property?

THANKS IN ADVANCE, YOUR HELP WILL BE HIGHLY APPRECIATED.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T09:06:50.520

org-export-as-html should DTRT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T13:16:31.367

Thanks for @Andreas 's hints, I add following code to htmlize.el. Currently the org-link can be htmlized to clickable link.

The code was shared on github:

[https://github.com/whunmr/dotemacs/blob/master/site-lisp/htmlize.el](https://github.com/whunmr/dotemacs/blob/master/site-lisp/htmlize.el)

and

[http://hunmr.blogspot.com/2012/08/enhance-htmlizeel-now-can-export-org.html](http://hunmr.blogspot.com/2012/08/enhance-htmlizeel-now-can-export-org.html)

**FOLLOWING IS THE MAIN CODE:**

```
(defun expand-org-link (&optional buffer)
  "Change [[url][shortname]] to [[url] [shortname]] by adding a space between url and shortname"
  (goto-char (point-min))
  (while (re-search-forward "\\[\\[\\([^][]+\\)\\]\\(\\[\\([^][]+\\)\\]\\)?\\]"
                nil t)
    (let ((url (match-string 1))
      (link-text (match-string 3)))
      (delete-region (match-beginning 0) (match-end 0))
      (insert "[[" url "] [" link-text "]]"))))

(defun shrink-org-link (&optional buffer)
  "Change [[url] [shortname]] to [[url][shortname]], remove the space between url and shortname"
  (goto-char (point-min))
  (while (re-search-forward "\\[\\[\\([^][]+\\)\\] \\(\\[\\([^][]+\\)\\]\\)?\\]"
                nil t)
    (let ((url (match-string 1))
      (link-text (match-string 3)))
      (delete-region (match-beginning 0) (match-end 0))
      (insert "[[" url "][" link-text "]]"))))

(defun transform-org-link ()
  "transform htmlized <span> to <a>"
  (goto-char (point-min))
  (while (re-search-forward "\\[\\[<span \\([^>]+\\)>\\([^][]+\\)</span>\\] \\[\\([^][]+\\)\\]\\]"
                nil t)
    (let ((style (match-string 1))
          (url (match-string 2))
      (link-text (match-string 3)))
      (delete-region (match-beginning 0) (match-end 0))
      (insert "<a " style " href=\"" url "\">" link-text "</a>")))) 
```

# extjs - ExtJS 如何在控制器中处理组件的元素相关事件？

> ID：11937652
> 
> 赞同：6
> 
> 时间：2012-08-13T15:38:58.613
> 
> 标签：extjs, extjs4, extjs4.1, extjs-mvc

我有一个[面板](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.panel.Panel)，我需要捕获/处理此面板**元素的**[鼠标悬停事件](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.dom.Element-event-mouseover)。

 **目前，我通过使用以下侦听器扩展 ExtJS 面板来做到这一点（如此[处](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.panel.Panel-cfg-listeners)建议）：

```
...

listeners: {
    mouseover : {
        element : 'el',
        fn : function(){
            console.log('captured mouseover');
        }
    }
},

... 
```

可以通过[ExtJS 控制器](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.app.Controller)完成吗？这样我就可以在一个控制器中处理事件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T19:55:23.403

你在正确的轨道上，只是还没有完全到那里。控制器的工作是控制*组件*而不是*元素*。如果您想让元素的鼠标悬停事件在组件级别可用，只需将其重新触发为不同的“mypanelmouseover”事件并在控制器的 control() 中使用它。
漂亮整洁。

**编辑**：

这是如何做到的：

```
Ext.define('My.Panel', {
    extend: 'Ext.panel.Panel',

    constructor: function(config) {
        var me = this;

        me.callParent(arguments);

        me.addEvents(
            'mypanelmouseover'
        );
    },

    afterRender: function() {
        var me = this;

        me.callParent();

        // Declarative style with listeners reads better,
        // but this is shorter and does the same
        me.mon(me.getEl(), 'mouseover', function() {
            this.fireEvent('mypanelmouseover')
        }, me);
    }
});

Ext.define('My.Controller', {
    extend: 'Ext.app.Controller',

    init: function() {
        var me = this;

        me.control({
            'panel': {
                mypanelmouseover: me.onMyPanelMouseover
            }
        });
    }
}); 
```

希望这可以帮助。主要思想是保持声明性和解耦代码，而不是创建不可读的回调链。一个很好的副作用是您可以控制并且可以决定要重新触发哪些事件以及何时以及如何对它们做出反应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T17:26:25.997

您可以在组件呈现后附加侦听器：

```
Ext.define('My.controller.A', {
    extend:'Ext.app.Controller',

    init: function(){ 
        this.control({
            'panel1':{
                afterrender: function(cmp){
                    cmp.getEl().on('mouseover', this.panel1_mouseOver);
                }
            }
        });
    },

    panel1_mouseOver: function(e, t, eOpts){
        alert('mouseover');
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T16:23:17.477

我认为添加该功能的唯一方法是更改​​ Panel 组件的库源。我认为这不是一个好主意，因为它可能会因为所有额外的听众而减慢您的网站速度，但这就是您的做法。

[http://docs.sencha.com/ext-js/4-1/source/Panel.html#Ext-panel-Panel](http://docs.sencha.com/ext-js/4-1/source/Panel.html#Ext-panel-Panel) 查找“me.addEvents”以查看 ExtJS 决定授予访问权限的事件。您可以在那里添加鼠标悬停事件，然后在控制器中添加侦听器。

你到底在为那个听众做什么？如果您只是向面板的 div 元素添加一个类，那么您可以只使用 overCls 配置[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-cfg-overCls](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-cfg-overCls)

看起来只有少数组件支持 mouseover 事件。是否可以将此鼠标悬停功能分离为[菜单](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.menu.Menu-event-mouseover)或[按钮](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.button.Button-event-mouseover)组件？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T17:01:41.803

每个组件都有“getEl”方法。使用此方法获取 Dom 元素，然后在其上注册事件。**

# php - 由于业务逻辑错误而离开功能的最佳实践

> ID：11937655
> 
> 赞同：1
> 
> 时间：2012-08-13T15:39:05.380
> 
> 标签：php, exception, business-logic, control-flow

我只是在寻找一些最佳实践建议。

我有一项服务，“价格表服务”，用户可以在其中保存某种价格表。

有一些实例或配置可能会留下不一致的数据，在这些情况下，我想结束函数执行。

例如，如果没有在对象上设置 customerId，或者在数据库中找不到销售人员的 userId。

* * *

我的问题是当您遇到业务逻辑错误时离开函数的最佳方法是什么？

我喜欢异常停止执行并允许您重新抛出异常的方式。问题是，我听说异常不能用于流量控制。

目前我只有一堆嵌套的 if/else，除非`$service_error_message`没有设置局部变量，否则我不会提交我的事务。

如果`$service_error_message`为空，那么我知道我的验证器都没有失败，可以保存。

有没有人建议如何更好地处理这些情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:49:48.117

如果您遇到一个毫无疑问是致命的错误，并且无法从中恢复，请清理并退出。如果您在当前过程的范围之外没有清理工作（关闭文件/数据库连接/无论如何，生成一些错误输出等），那么`exit`最有意义。*如果错误可能是可恢复的，或者您想通过当前过程外部的某种方式以*有序的方式清理/记录错误，那么异常是最有意义的。这是一个个案决定。

`I've have heard exceptions aren't to be used for flow control`- 这是真的，但并不真正适用于您所描述的情况。如果您遇到实际*错误*，则完全可以接受异常。你*不应该*做的是使用异常来确定接下来执行哪一段代码，有点像`goto`.

可以在[这里](https://stackoverflow.com/questions/729379/why-not-use-exceptions-as-regular-flow-of-control)找到关于什么不该做以及为什么不做的一个很好的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:50:28.943

通常我不会使用 Exception 进行流控制，就好像我希望在我想摆脱脚本的地方经常发生一些情况，我会使用`exit()`调用。

在我看来，只有当你在代码中遇到不应该发生的事情时才会抛出异常（比如传递给对象的方法或函数的无效参数）——即真正异常的事情。我也只会在调用代码周围有 try-catch 块的情况下使用它们，这些块可以适当地捕获和处理异常。

因此，例如，我可能会在 try-catch 块中实例化数据库连接，然后在无法建立连接的情况下让 DB 抽象层抛出异常。然后我会捕获异常并记录`exit()`如果数据库连接对于服务的功能是绝对必要的，则它并适当地退出应用程序。

对我来说，仅仅从数据库查询中获取空结果集（即检查用户登录）并不是我不会通过抛出异常来处理的事情，而是宁愿提供适当的最终用户消息并在需要时优雅地退出脚本.

# jquery - 将数组传递给 jQuery 选择器

> ID：11937656
> 
> 赞同：2
> 
> 时间：2012-08-13T15:39:09.923
> 
> 标签：jquery, arrays, selector

我相信可以将一个 DOM 对象数组传递给 jQuery 的选择器，这样您就可以同时操作多个对象。我已经尝试按如下方式执行此操作，但由于某种原因无法使其正常工作......

```
$(Sel).animate({
        backgroundColor: "#FF0000"
    }, 250, 'linear', function() {

        $(this).animate({
            backgroundColor: "#FFFFFF"
        }, 250, 'linear');

    }); 
```

真的有可能做到这一点，还是我在吠叫错误的树？

我已经把[这个 jsFiddle](http://jsfiddle.net/PottyMonster/AX3C8/)放在一起来测试一下。目的是制作一个预订系统，其中选择半小时的时段，因此我需要操纵“这个”和下一行下面的单元格。

非常感谢任何建议。

小提琴的代码：

```
function HighlightCells() {

    $('table#Calendar tbody tr td:not(".TimeCell")').live('mouseenter', function() {
        var Sel = new Array();
        Sel[1] = $(this);

        // Count number of previous TDs. Resut is base 0
        var NumIn = $(this).prevAll('td').length;

        // Increment count to compensate for nth-child being base 1
        NumIn++;

        var NextRow = $(this).closest('tr').next('tr');

        Sel[2] = $(NextRow).children("td:nth-child(" + NumIn + ")");

        // Animate the cell background colour red to white
        $(Sel).animate({
            backgroundColor: "#FF0000"
        }, 250, 'linear', function() {

            $(this).animate({
                backgroundColor: "#FFFFFF"
            }, 250, 'linear');

        });

        $('table#Calendar tbody td').live('mouseleave', function() {
            $(this).text("");
        });

    });

}

HighlightCells(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:49:25.877

您正在从一组 jQuery 对象中创建一个 jQuery 对象。你不能那样做，这是行不通的。

您需要创建`Sel`一个 DOM 元素数组（注意：数组是零索引的，`Sel[1]`实际上第二个元素也是如此，但是在构建数组时，`.push`除非您*确实*需要使用实际的键，否则请使用）：

```
var Sel = [];  // this is preferred over `new Array()`
Sel.push($(this).get(0)); // or Sel.push(this)
// ...
Sel.push($(NextRow).children("td:nth-child(" + NumIn + ")").get(0)); 
```

或者先创建`Sel`一个 jQuery 对象，然后向其中添加元素。

```
var Sel = $();
Sel = Sel.add(this);
// ...
Sel = Sel.add($(NextRow).children("td:nth-child(" + NumIn + ")"));
// ...
Sel.animate({ // sel is already a jQuery object, so we don't need `$(Sel)` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:41:19.093

您正在使用一组 jQuery 对象。相反，您需要一个 DOM 对象数组。

```
var Sel = new Array();
        Sel[1] = this; 
```

和

```
Sel[2] = $(NextRow).children("td:nth-child(" + NumIn + ")").get(); 
```

但是，不应该是`Sel[0] = this`and`Sel[1] = ...`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:49:53.433

你可以这样做

```
var Sel = new Array();
Sel[1] = this; 
```

和

```
Sel[2] = NextRow.children("td:nth-child(" + NumIn + ")")[0]; 
//  retrieves the DOM element  
// Also no need to wrap NextRow with $() since it's already a jQuery object 
```

[http://jsfiddle.net/wirey00/AX3C8/27/](http://jsfiddle.net/wirey00/AX3C8/27/)

# c# - SQL Server CE 错误 不允许访问数据库文件

> ID：11937657
> 
> 赞同：3
> 
> 时间：2012-08-13T15:39:11.543
> 
> 标签：c#, .net, sql, wpf, sql-server

我有一个 WPF 应用程序，我在上面使用 SQL Server CE。使用 Visual Studio 调试时它工作正常，但是当我在任何计算机上安装应用程序时，会显示一条错误消息：

> *不允许访问数据库文件*

和我的数据库的路径（通常是安装应用程序的文件夹`C:/ProgramFiles`）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:44:09.807

文件夹`C:\program files`或`C:\program files (x86)`不能用于存储应用程序的可写元素，如数据库文件。这是在 Vista 和 Win7 (UAC) 中所做的安全更改。

您应该在设置期间选择不同的位置（MyDocuments、ProgramData 或其他）来存储数据库文件。

在 Visual Studio 中调试时，您正在解决方案目录和子文件夹 bin\debug 中运行您的应用程序，您拥有读/写权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-24T12:16:50.507

请检查文件是否是只读的，如果是只读的，请在打开之前取消选中。

# jsf - JSF，RichFaces，分页

> ID：11937660
> 
> 赞同：7
> 
> 时间：2012-08-13T15:39:19.410
> 
> 标签：jsf, pagination, richfaces

我知道这里有很多关于 JSF paginatin 的帖子，但没有一个让我满意。

要将相当大的数据拆分为页面，我将使用 RichFaces Data 滚动组件。

它似乎适合于此，但它看起来像是“人工”分页。

我不喜欢这里的是它加载所有数据，然后只显示其中的一部分。至少它看起来是这样的。如我错了请纠正我。

丰富的面孔有很好的演示，但由于某种原因，他们跳过了 bean 定义——只有 xhtml。我看到有人提到了 ExtendedDataModel，但我发现的唯一例子并没有给我留下深刻印象。为什么我应该有 5 个屏幕代码只是显示数据子集？

老实说，像分页这样简单的问题在 JSF 中恰好非常复杂，我真的不明白为什么。

所以我的问题是：1.是否可以在 Richfaces 中仅加载一页数据 2.不将其存储到会话中（我的意思是实际数据未列出状态-当前页面等）

我只对richfaces lib感兴趣，因为我已经在我的项目中使用了它，而不是引入对其他东西的依赖

提前谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T11:21:43.893

在 RichFaces 论坛上讨论之后，提出了以下解决方案（感谢 Brendan Healey）：

RichLazyDataModel.java

```
/**
 * Extended data model
 * @author Brendan Healey
 */
public abstract class RichLazyDataModel<T> extends ExtendedDataModel<T> {

private SequenceRange cachedRange;
private Integer cachedRowCount;
private List<T> cachedList;
private Object rowKey;

public abstract List<T> getDataList(int firstRow, int numRows);
public abstract Object getKey(T t);
public abstract int getTotalCount();

@Override
public void walk(FacesContext ctx, DataVisitor dv, Range range, Object argument) {

    SequenceRange sr = (SequenceRange) range;

    if (cachedList == null || !equalRanges(cachedRange, sr)) {
        cachedList = getDataList(sr.getFirstRow(), sr.getRows());
        cachedRange = sr;
    }

    for (T t : cachedList) {
        if (getKey(t) == null) {
            /*
            * the 2nd param is used to build the client id of the table
            * row, i.e. mytable:234:inputname, so don't let it be null.
            */
            throw new IllegalStateException("found null key");
        }
        dv.process(ctx, getKey(t), argument);
    }

}

/*
* The rowKey is the id from getKey, presumably obtained from
* dv.process(...).
*/
@Override
public void setRowKey(Object rowKey) {
    this.rowKey = rowKey;
}

@Override
public Object getRowKey() {
    return rowKey;
}

@Override
public boolean isRowAvailable() {
    return (getRowData() != null);
}

@Override
public int getRowCount() {
    if (cachedRowCount == null) {
        cachedRowCount = getTotalCount();
    }
    return cachedRowCount;
}

@Override
public T getRowData() {
    for (T t : cachedList) {
        if (getKey(t).equals(this.getRowKey())) {
            return t;
        }
    }
    return null;
}

protected static boolean equalRanges(SequenceRange range1, SequenceRange range2) {
    if (range1 == null || range2 == null) {
        return range1 == null && range2 == null;
    } else {
        return range1.getFirstRow() == range2.getFirstRow() && range1.getRows() == range2.getRows();
    }
}

/*
* get/setRowIndex are used when doing multiple select in an
* extendedDataTable, apparently. Not tested. Actually, the get method is
* used when using iterationStatusVar="it" & #{it.index}.
*/
@Override
public int getRowIndex() {
    if (cachedList != null) {
        ListIterator<T> it = cachedList.listIterator();
        while (it.hasNext()) {
            T t = it.next();
            if (getKey(t).equals(this.getRowKey())) {
                return it.previousIndex() + cachedRange.getFirstRow();
            }
        }
    }
    return -1;
}

@Override
public void setRowIndex(int rowIndex) {
    int upperBound = cachedRange.getFirstRow() + cachedRange.getRows();
    if (rowIndex >= cachedRange.getFirstRow() && rowIndex < upperBound) {
        int index = rowIndex % cachedRange.getRows();
        T t = cachedList.get(index);
        setRowKey(getKey(t));
    }
}

@Override
public Object getWrappedData() {
    throw new UnsupportedOperationException("Not supported yet.");
}

@Override
public void setWrappedData(Object data) {
    throw new UnsupportedOperationException("Not supported yet.");

}

public List<T> getCachedList() {
    return cachedList;
} 
```

}

ListState.java

```
/**
 * Holds list state
 */
public class ListState implements Serializable {

private int page;

private Map<String, Serializable> searchCriteria = new HashMap<String, Serializable>();

public int getPage() {
    return page;
}

public void setPage(int page) {
    this.page = page;
}

public Map<String,Serializable> getSearchCriteria() {
    return searchCriteria;
} 
```

}

CardsBean.java

```
@ManagedBean(name="cardsBean")
public class CardsBean {

@ManagedProperty("#{cardService}")
private CardService cardService;

private ListState state;

private RichLazyDataModel<Card> cardsModel = new RichLazyDataModel<Card>() {
    @Override
    public List<Card> getDataList(int firstRow, int numRows) {
        MyUserDetails user = SecurityUtils.getCurrentUser();
        return cardService.findUserCards(user.getUser(), firstRow, numRows, state.getSearchCriteria());
    }

    @Override
    public Object getKey(Card card) {
        return card.getId();
    }

    @Override
    public int getTotalCount() {
        MyUserDetails user = SecurityUtils.getCurrentUser();
        return cardService.countUserCards(user.getUser(), state.getSearchCriteria());
    }
};

public RichLazyDataModel<Card> getCards() {
    return cardsModel;
}

public String getSearchString() {
    return (String)state.getSearchCriteria().get("searchString");
}

public int getCurrentPage() {
    return state.getPage();
}

public void setCurrentPage(int page) {
    state.setPage(page);
}

public void setSearchString(String searchString) {
    state.getSearchCriteria().put("searchString", searchString);
}

public void setCardService(CardService cardService) {
    this.cardService = cardService;
}

public boolean isPinned() {
    return Boolean.TRUE.equals(state.getSearchCriteria().get("pinned"));
}

public void setPinned(boolean pinned) {
    state.getSearchCriteria().put("pinned", pinned);
}

public void togglePinned() {
    setPinned(!isPinned());
}

@PostConstruct
public void init() {
    state = getFromSession("cardsList", null);
    if (state == null) {
        state = new ListState();
        storeInSession("cardsList", state);
    }
}

public <T extends Serializable> T getFromSession(String name, T defaultValue) {
    T ret = (T) FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get(name);
    if (ret == null) {
        ret = defaultValue;
    }
    return ret;
}

public void storeInSession(String name, Serializable obj) {
    FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put(name, obj);
}
} 
```

卡片.xhtml（部分）

```
...

<h:form>

  <rich:dataGrid value="#{cardsBean.cards}" var="card" columns="2" elements="20" first="#{cardsBean.currentPage}" style="margin:0 auto;width:70em" id="cardsTable">
      <f:facet name="header">
          <h:inputText value="#{cardsBean.searchString}">
              <a4j:ajax event="keyup" render="cardsTable@body, cardsTable@footer">
                <a4j:attachQueue requestDelay="700" ignoreDupResponses="true" />
              </a4j:ajax>

          </h:inputText>
      </f:facet>

      <rich:panel id="cd">
          <ui:include src="WEB-INF/parts/card.xhtml">
              <ui:param name="card" value="#{card}"/>
          </ui:include>

      </rich:panel>

      <f:facet name="footer">
          <rich:dataScroller page="#{cardsBean.currentPage}"   />
      </f:facet>

  </rich:dataGrid>

  </h:form>
... 
```

# c# - 我的计算机的 VS2010 C# 项目的参考属性字段指向 System.Activites.dll 的旧版本

> ID：11937662
> 
> 赞同：1
> 
> 时间：2012-08-13T15:39:24.207
> 
> 标签：c#, .net, visual-studio-2010

问题是：我从团队的 TFS 下载了我的解决方案。但我是团队中唯一收到此消息的人：

> 找不到类型或命名空间名称 StateMachine（您是否缺少...）

解决问题时我发现，在我收到错误的那个特定项目中，当查看项目引用下 System.activities 的属性时，路径文件指向旧版本，`System.activities.dll`但我所有队友的路径都指向新版本的`System.activities.dll`。我的机器中有些东西不同步，我不知道是什么。我的注册表项，我的 VS2010 版本，和队友的软件是一样的，但我仍然得到上述错误。

我不知道为什么我的属性上的路径`System.activities`指向旧版本`System.activities.dll`- 我错过了什么？我什至检查了我机器上最新安装的 .NET 下的 Machine.Config，它看起来和其他队友一样（只是瞥了一眼）。

任何帮助，将不胜感激。如果我需要重新安装，我应该重新安装 VS2010、.NET 和整个九码吗？

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:41:29.280

您需要安装[.NET Framework 4 Platform Update 1](http://msdn.microsoft.com/en-us/library/ee264171.aspx)。它有两个下载：

1.  [运行时更新](http://support.microsoft.com/kb/2478063)：运行 WF4 StateMachine 工作流需要。将其安装在运行您的应用程序的计算机和您的开发机器上
2.  [设计时更新](http://support.microsoft.com/kb/2495593)：需要 WF4 StateMachine 工作流的设计时支持。如果您想编辑 StateMachine 工作流程，请将其安装在您的开发机器上。

原因是 .NET 4 没有附带 StateMachine 工作流。它是后来添加的，并通过上述平台更新 1 提供

# adobe - Adobe LiveCycle Designer -- 子窗体中的中心内容

> ID：11937663
> 
> 赞同：0
> 
> 时间：2012-08-13T15:39:28.783
> 
> 标签：adobe, position, center, livecycle, subform

我有一个包含两 (2) 个文本字段的子表单。我将子表单设置为 Flowed / Western Text，以便内容从左到右。问题是我希望子表单（或内容）居中，但我不知道如何做到这一点。我不使用位置的原因是因为两个文本字段中的每个文本字段都是动态的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:04:47.143

我意识到这不是一个通用的解决方案，但它仍然可以解决您的问题：

文本字段的内容可以水平和垂直居中。将它们拉伸到您希望文本居中的宽度和高度，然后从[段落调色板](http://help.adobe.com/en_US/livecycle/9.0/designerHelp/000434.html#1581237)中选择水平对齐的*中心*和垂直对齐的*中间*。

由于您使用两个文本字段，因此您不能使用此功能将两个文本同时居中。

那么如何在一个文本字段中显示两个动态文本呢？
您可以使用*[浮动文本](http://help.adobe.com/en_US/livecycle/9.0/designerHelp/000357.html#1581107)*来做到这一点。这样，您可以同时显示两个文本，并且仍然使它们水平和垂直居中。

# objective-c - 如何为 getoptlong 编写测试

> ID：11937665
> 
> 赞同：0
> 
> 时间：2012-08-13T15:39:37.750
> 
> 标签：objective-c, unit-testing, xcode4, getopt-long

我在 Mac 上用 Objective-c 编写了一个小型终端应用程序，它使用 getoptlong 来解析命令行参数。解析命令行的代码如下：

```
+ (void) parseCommandLine:(int) argc
                     args:(char **) argv
            outSocketPath:(NSURL **) socketPath
          outSocketHandle:(int *) socketHandle
          outTestModePath:(NSURL **) testModePath {

    *socketPath = nil;
    *testModePath = nil; 
    socketHandle = 0;

    // are we running with launchd, the default is true
    BOOL noLaunchdFlag = NO;
    struct sockaddr_un un;

    // description of the available options of the daemon
    static struct option longopts[] = {
        { "no-launchd", no_argument, NULL, 'l' },
        { "socket", required_argument, NULL, 's' },
        { "testing", required_argument, NULL, 't'},
        { "help", no_argument, NULL, 'h'}
    };

    // parse the options and decide how to move
    int ch;
    while ((ch = getopt_long(argc, argv, "lst:h", longopts, NULL)) != -1){
        switch (ch) {
            case 'l':
                noLaunchdFlag = YES;
                break;
            case 's':
                *socketPath = [NSURL fileURLWithPath: [NSString 
                    stringWithCString:optarg encoding:NSUTF8StringEncoding]];
                break;
            case 't':
                *testModePath = [NSURL fileURLWithPath: [NSString 
                    stringWithCString:optarg encoding:NSUTF8StringEncoding]];
            case 'h':
            default:
                return [FSEventsDaemon usage];
        } // switch
    } // while looping through args
    // assert the parameters
    if(noLaunchdFlag) {
        if(*socketPath == nil){
            // we always need to have a socket path
            [NSException raise:@"Invalid Parameter" format:@""];
        }
        if([[*socketPath absoluteString] length] > sizeof(un.sun_path) - 1) {
            // socket path is too long    
            [NSException raise:@"Invalid Parameter" format:@""];
        }
        if(*testModePath == nil && geteuid() != 0){
            // if we are not running in test mode we must be root
            [NSException raise:@"" format:@""];
        }
        // all args are ok
        return;
    }
    else {
        if(testModePath != nil) {
            [NSException raise:@"Invalid Paramter" 
                format:@"You cannot use -t because testing is not supported via launchd"];
        }
        // get the handle
        *socketHandle = [FSEventsDaemon getLauchdSocketHandle];
        // all args are ok
        return;
    }
} 
```

完成后，我想使用单元测试来断言操作已正确完成。例如，我编写了以下测试：

```
- (void) testParseArgsNotTestNotRoot {
    char * argv[] = {"./FsEvents", "--socket=", [self getPath], "-l"};
    int argc = 4;
    NSURL *sockPath = nil;
    int handle;
    NSURL *testPath = nil;
    // should raise an exception because we are not root
    STAssertThrows([FSEventsDaemon parseCommandLine:argc args:argv 
        outSocketPath:&sockPath outSocketHandle:&handle 
        outTestModePath:&testPath], nil);
} 
```

通过调试器运行测试时，getoptlong args 解析永远不会获得路径。这是测试getoptlong用法的正确方法吗？是否有更好的模式用于测试命令行参数的解析？

# vbscript - VBScript 批处理 html 到 Word

> ID：11937670
> 
> 赞同：0
> 
> 时间：2012-08-13T15:39:54.740
> 
> 标签：vbscript, ms-word, copy, webpage

我正在寻找以下 VB 的解决方案来批处理 .html 文件/url。我想保存要在 Microsoft Word 中打开的 .html 文件。

这是我正在使用的代码，但我需要它来处理多个 .html 文件：

```
Option Explicit
'Just change these two lines
Const HTMLFileIn="http://www.example.com"   
Const DocFileOut="H:\Word"

Dim MyWord,oIE
Set MyWord=CreateObject("Word.Document") 
Set oIE=CreateObject("InternetExplorer.Application")
oIE.Navigate HTMLFileIn
Attend
oIE.document.body.createTextRange.execCommand("Copy")
Attend
MyWord.Content.Paste
MyWord.SaveAs DocFileOut
MyWord.Close
oIE.Quit
Set oIE=Nothing
Set MyWord=Nothing 
MsgBox HTMLFileIn & " is now saved as " & DocFileOut

Sub Attend
    Wscript.Sleep 500
    While oIE.busy
        Wscript.Sleep 1000
    Wend
    While oIE.Document.readyState <> "complete"
        Wscript.Sleep 1000
    Wend
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:16:34.053

尝试这个。（**经过试验和测试**）

```
'~~> Replace this with the text file which has the links
Const hLinksFile As String = "C:\Temp\MyLinks.txt"

Sub Sample()
    Dim MyData As String, strData() As String
    Dim i As Long
    Dim ie As Object

    '~~> Open text file in one go
    Open hLinksFile For Binary As #1
    MyData = Space$(LOF(1))
    Get #1, , MyData
    Close #1
    strData() = Split(MyData, vbCrLf)

    Set ie = CreateObject("InternetExplorer.Application")

    ie.Visible = True

    Set XML = CreateObject("msxml2.serverxmlhttp.6.0")

    For i = LBound(strData) To UBound(strData)
        ie.Navigate "about:blank"

        With XML
            .Open "get", strData(i), False
            .send
            ie.Document.body.InnerHTML = .responsetext
        End With

        Do While ie.readystate <> 4: DoEvents: Loop

        ie.Document.body.createtextrange.execCommand "Copy"

        Selection.Paste

        '~~> Move to the end for the next pasting
        Selection.EndKey Unit:=wdStory
        Selection.TypeParagraph: Selection.TypeParagraph

        Doevents
    Next i
End Sub 
```

# sql - 按年/月拆分 SQL 查询

> ID：11937673
> 
> 赞同：2
> 
> 时间：2012-08-13T15:40:10.730
> 
> 标签：sql, sql-server-2008, tsql, reporting-services

我编写了一个 SQL 查询，用于填充临时表中的以下列：

```
CODE | MODULE | MONTH | YEAR | SO_NUM | LABOR_HRS | LABOR_COST 
```

从这个表中，我需要创建一个返回相同数据的选择语句，按月份拆分，如下所示：

```
CODE | MODULE | SO_NUM_MONTH1 | LABOR_HRS_MONTH1 | LABOR_COST_MONTH1 | SO_NUM_MONTH2 | LABOR_HRS_MONTH2 | LABOR_COST_MONTH2 | etc... 
```

如您所见，代码和模块不会随月份变化。临时表中总会有六个月的数据。然而，让我明白的是，月份并不总是从 1 开始（月份和年份是整数）。

我还希望根据月份和年份来命名结果列，因此在上面的示例中，假设数据从 2011 年 1 月开始，名称可能是：

```
CODE | MODULE | SO_NUM_JAN_2011 | LABOR_HRS_JAN_2011 | LABOR_COST_JAN_2011 | SO_NUM_FEB_2011 | LABOR_HRS_FEB_2011 | LABOR_COST_FEB_2011 | etc... 
```

该项目正在 SQL Server 2008 R2 中开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:24:24.570

这里有一些代码可以帮助您入门。基本上，它会创建一个包含您需要的字段的表，您可以删除它并根据需要重新创建它。您需要完成将其余字段添加到动态 SQL 部分 (@CreateTable)，然后您需要构建一些插入和更新查询来填充它。我会使用一些动态 sql，就像我用来创建表的那样来执行这些操作，以便您从变量中获取字段名称。

```
DECLARE @Month1 VARCHAR(15),
@Month2 VARCHAR(15),
@Month3 VARCHAR(15),
@Month4 VARCHAR(15),
@Month5 VARCHAR(15),
@Month6 VARCHAR(15),
@Year VARCHAR(4)

SELECT @Year = Year(GetDate())

SELECT @Month1 = LEFT(DateName(mm,DateAdd(mm,-6,GetDate())),3) + '_' + @Year, 
@Month2 = LEFT(DateName(mm,DateAdd(mm,-5,GetDate())),3) + '_' + @Year,
@Month3 = LEFT(DateName(mm,DateAdd(mm,-4,GetDate())),3) + '_' + @Year,
@Month4 = LEFT(DateName(mm,DateAdd(mm,-3,GetDate())),3) + '_' + @Year,
@Month5 = LEFT(DateName(mm,DateAdd(mm,-2,GetDate())),3) + '_' + @Year,
@Month6 = LEFT(DateName(mm,DateAdd(mm,-1,GetDate())),3) + '_' + @Year

PRINT @Month1
PRINT @Month2
PRINT @Month3
PRINT @Month4
PRINT @Month5
PRINT @Month6

DECLARE @CreateTable VARCHAR(MAX)

SELECT @CreateTable = 'CREATE TABLE tblTESTING (
    CODE VARCHAR(10),
    MODULE VARCHAR(10),
    SO_NUM_' + @Month1 + ' VARCHAR(10),
    LABOR_HOURS_' + @Month1 + ' VARCHAR(10),
    LABOR_COST_' + @Month1 + ' VARCHAR(10)
    )'

PRINT ''    
PRINT @CreateTable

--DROP TABLE tblTesting

EXECUTE(@CreateTable) 
```

# c++ - 动态库（dll/dylib）的内存管理

> ID：11937674
> 
> 赞同：1
> 
> 时间：2012-08-13T15:40:12.873
> 
> 标签：c++, memory-management, dll, dylib

在应用程序中分配内存并在从 dll/dylib 调用的函数中释放内存有什么问题吗？

但是要从 dll/dylib 的函数中分配内存并在调用者应用程序中释放它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:47:08.187

对于静态库，这通常不是问题，但对于动态库通常不是一个好主意。特别是对于项目之间共享的库。

问题是您需要确保内存分配函数（new/delete、malloc/free）在您的调用代码和动态库之间完全匹配。例如，如果您将 C 运行时与可执行文件静态链接，但动态库是动态链接的（反之亦然），那么您有单独的代码为可执行文件和动态库运行 malloc。

为了避免任何问题，动态库通常会公开它们自己的 alloc 和 free 例程以保证一致性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:58:55.593

不，从某种意义上说它可以工作没有根本问题，但是执行内存分配的应用程序必须返回一个指针，然后可以将其传递给 DLL，以便它可以执行删除（或释放）。

当然，应用程序和 DLL 必须使用与其他人指出的相同的内存分配，否则会出现混乱。

虽然很危险，而且容易出错。一般来说，最好在同一个地方处理内存分配和解除分配，并将指针传递给需要访问已分配对象的任何其他对象。

我确实为一个 C# 库工作，该库调用一个 DLL，它分配内存以返回（大）结果，并提供了一个删除方法，然后在应用程序完成它们时调用该方法。它工作得很好。

# html - 具有列表样式位置的列表项上的意外间距：在 Internet Explorer 中

> ID：11937675
> 
> 赞同：1
> 
> 时间：2012-08-13T15:40:13.007
> 
> 标签：html, css, internet-explorer, internet-explorer-9

[http://krill.larvit.se/resihop_dev/](http://krill.larvit.se/resihop_dev/)，右栏排序列表。

HTML：

```
<ol class="instructions">
  <li>
    <p>För att hitta samåkningar, klicka på kartan på platsen du vill åka ifrån.</p>
  </li>
</ol> 
```

我相信是相关的CSS：

```
.instructions{
    padding-left: 0;
}
.instructions li{
    padding: 0 10px;
    margin: 0 0 10px 0;
    list-style-position: inside;
    font-size: 25px;
}

.instructions li p{
    font-size: 12px;
    display: inline-block;
    vertical-align: middle;
    width: 360px;
} 
```

在Internet Explorer 9 中，在“1”的右侧添加了一个大空格。我能做些什么呢？如果可能的话，我想保留 html 标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:01:13.963

不同的浏览器呈现略有不同，但我个人会做以下事情：

```
.instructions li{
    padding: 0;
    margin: 0 0 10px 30px;
    font-size: 25px;
} 
```

这将在所有浏览器中显示得相当接近，如果你想让它更接近，你需要使 1\. 的字体大小更小**或**在段落中添加 -XXpx 的左边距

```
.instructions li p{
    font-size: 12px;
    display: inline-block;
    vertical-align: middle;
    width: 360px;
    margin-left:-8px;
} 
```

另一种选择是将数字作为 li 上的 CSS sprite + 背景图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T23:53:25.473

I would remove the `<p>` tag from inside the `<li>` tag as its a list entry you don't need it, (*what you have done is added a paragraph the list entry*) you then just style the `<ol>` tag and `<li>` tag

# javascript - 带有 javascript 的按钮标签转换为链接标签

> ID：11937677
> 
> 赞同：1
> 
> 时间：2012-08-13T15:40:26.600
> 
> 标签：javascript, html

我目前有一个按钮标记为“提交”类型，单击它时会执行 javascript。

按钮：

```
<button class="glossyBtn" type="submit" value="Cancel"  onclick="goBack(); return false;"> 
```

脚本：

```
<script type="text/javascript">
function goBack() {
    window.history.back();
}
</script> 
```

保存脚本：

```
<script type="text/javascript">
$(function () {
    $('form').submit(function () {
        $('#saveButton').attr('disabled', 'disabled');
    });
});
</script> 
```

我想把它改成

```
<a class="glossyBtn" type="submit"> Cancel</a> 
```

如何在不使用按钮标签的情况下使链接正确执行？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:44:25.277

我相信这就是您在常规链接中使用 javascript 的方式。

```
<a href="javascript:goBack(); return false;" class="glossyBtn">Cancel</a> 
```

编辑：您可以删除 type="submit" 因为它不再是一个按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:53:57.620

javascript的工作原理完全相同

```
<a class="glossyBtn" onclick="goBack(); return false;" href="#">Cancel</a> 
```

实际上并没有使用 href（return false 会阻止它），但是如果没有 href，某些浏览器的样式会与您期望的链接不同。

请注意，我将其`type`作为属性删除，因为这在 HTML 中没有任何意义。

Also not that there may be accessibility issues with this since you have no alternative for those not running javascript. This is not a problem most peopel worry about these days though. :)

# unix - 让 ssh -Y 通过 su 跟随你

> ID：11937679
> 
> 赞同：2
> 
> 时间：2012-08-13T15:40:31.453
> 
> 标签：unix, ssh

当 ssh 进入 Unix 机器（特别是 Sun OS）时，我有一个关于 -Y 选项的问题。我知道此选项允许您将图形推送到您的机器（即：gedit），唯一的问题是，一旦我使用任何其他用途，此选项就不会传输。我的问题是，有没有办法在你 su 到另一个用户之后保持这个选项处于活动状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:43:14.070

当然。当您登录您的帐户时，键入：

```
xauth list $DISPLAY 
```

这应该给你一些类似的东西：

```
host.example.com/unix:0  MIT-MAGIC-COOKIE-1  3d1e4422a15470a236770dedf87335b0 
```

`su`转到另一个帐户，确保`DISPLAY`变量设置正确（可能通过手动设置），然后运行：

```
xauth add host.example.com/unix:0  MIT-MAGIC-COOKIE-1  3d1e4422a15470a236770dedf87335b0 
```

你应该准备好了。[这在这里](http://xpt.sourceforge.net/techdocs/nix/conn/ssh/ssh04-SshAndX/single/)和[这里](http://www.debian-administration.org/articles/494)都有更详细的描述。

# ios-provisioning - 将新设备添加到现有的通配符配置文件

> ID：11937681
> 
> 赞同：2
> 
> 时间：2012-08-13T15:40:33.800
> 
> 标签：ios-provisioning

我正在尝试将几个新设备添加到我们的团队配置文件中。我说的是我们在为每个应用程序创建特定配置文件之前用于测试应用程序的通用“通配符”配置文件。

据我回忆，到目前为止，任何新设备都会自动添加到我的团队配置文件中。我今天添加的最新 2 台设备未列为团队资料的一部分。它们是配置文件列中仅有的 2 个计数为“0”的设备。此外，团队资料不可编辑，因为它使用通配符。

根据定义，团队资料不应该包括所有设备吗？这是开发门户上的错误吗？你有什么建议吗？

干杯，戴维德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T12:37:22.567

我相信 iOS Team Provisioning Profile 是由 Xcode 生成和管理的。

如果您在 Provisioning Portal 中添加设备，然后在 Xcode 管理器窗口中点击刷新（在 Xcode 4 中查看 Library->Provisioning Profiles 时的右下角），应该重新生成并下载配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-15T03:04:33.957

尽管我现在使用的是 Xcode 7，但我还是使用了 Xcode 6 来刷新配置文件。

我去 Xcode > Preferences > Account [![优先](../Images/999acadd504773fdda4e7b92781f509a.png)](https://i.stack.imgur.com/CbEKP.png) [![账户](../Images/70286b46c864fa8eb2e3437aec120278.png)](https://i.stack.imgur.com/TV8Wp.png)

我选择帐户并按查看详细信息 [![查看详情](../Images/3c21e7f08d5a911c76a080b54de84a0d.png)](https://i.stack.imgur.com/Y5gQh.png)

我选择通配符配置文件并按下刷新按钮 [![通配符配置文件](../Images/18aaba0cb718bf381bab375a8eaecb27.png)](https://i.stack.imgur.com/CfLOT.png) [![在此处输入图像描述](../Images/2302c55499b5d0d0c95c83f3d44cb264.png)](https://i.stack.imgur.com/zgDyk.png)

之后，我去会员开发者中心验证我添加的新设备是否包含在通配符配置文件中。确认这将起作用。

参考：[https ://stackoverflow.com/a/32574260/1635363](https://stackoverflow.com/a/32574260/1635363)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:43:00.653

添加新设备后，您是否重新创建/下载了配置文件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T09:58:15.427

正如评论中所建议的，唯一可靠的解决方案实际上是创建一个特定于应用程序的配置文件。这实际上更像是一种解决方法，但它可以完成工作。

# wordpress - 获取 Wordpress 中的所有帖子 ID

> ID：11937683
> 
> 赞同：5
> 
> 时间：2012-08-13T15:40:44.807
> 
> 标签：wordpress

是否可以获得当前存在于 wordpress 数据库中的所有帖子 ID 的数组（与 post_types 无关）？此外，是否可以获得特定 post_type 的所有帖子 ID 的数组？

如果可以，如何实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-01-27T06:55:49.767

你可以试试这个方法

```
 $post_ids = get_posts(array(
        $args, //Your arguments
        'posts_per_page'=> -1,
        'fields'        => 'ids', // Only get post IDs
    )); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T16:56:46.973

可能最好使用 wordpress 的 DB 对象运行自定义查询。（来自functions.php或主题文件等）：

```
 // pseudo-code check how to refer to the field columns and table name!
                global $wpdb; 

                $sql="SELECT id, title FROM posts";

                $posts = $wpdb->get_results($sql);

                print("<ul>");
                foreach ($posts as $post)
                {
                    print('<li>'.$post->FIELD1.'|'.$post->FIELD2.'<br/>');
                     print('</li>');
                }
                print("</ul>"); 
```

我认为实际上您也可以使用标准 wp_query 对象来获得它....但至少我的方式可以先在 phpmyadmin 中进行查询，然后调整语法/wordpress 前缀。（阅读数据库对象上的法典）。如果它是一次性的，只需使用 phpmyadmin，但对于编程使用，您应该将其转换为从您的 functions.php 文件运行。

# objective-c - 在 Objective-C 中设置文本字段的值

> ID：11937690
> 
> 赞同：3
> 
> 时间：2012-08-13T15:41:12.303
> 
> 标签：objective-c, cocoa

我有一个`NSTextField`电话`resultsView`，我想用字符串填充`graphical_availability`。

我尝试了以下方法：

```
[resultsView setValue:graphical_availability]; 
```

但在运行时不断出错：

```
2012-08-13 08:39:08.468 App-Name[75231:6003] -[NSTextField setValue:]: unrecognized selector sent to instance 0x100509730
2012-08-13 08:39:08.470 App-Name[75231:6003] An uncaught exception was raised
2012-08-13 08:39:08.470 App-Name[75231:6003] -[NSTextField setValue:]: unrecognized selector sent to instance 0x100509730 
```

所以，显然`setValue`不被认为是`NSTextField`我正在使用的类的方法。我是 Objective-C 的新手（显然）并且在 Apple 的文档中找不到它。

如何设置此文本字段的值？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T15:46:57.450

`setStringValue:`是您需要的方法。

从[NSTextField 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextField_Class/Reference/Reference.html)：

> **概述**
> 
> 父类NSControl提供了设置文本字段值的方法，例如：setStringValue:、setDoubleValue:等。有相应的取值方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T07:56:18.197

不要忘记调用 setter 的下划线：

```
[_resultsView setStringValue:graphical_availability]; 
```

# javascript - 在每个函数中处理“那个”时奇怪的 JS 行为

> ID：11937697
> 
> 赞同：0
> 
> 时间：2012-08-13T15:41:24.130
> 
> 标签：javascript

我在使用 javascript 开发时注意到了一个不寻常的行为，有人可以向我解释一下吗？

我有这个 javascript 代码：

```
function MyFunction(){
   var categoryId = 'abc';
   var that = this;
   $(_elem).parent().find('[data-id]').each(function(){
   that.categoryId += $(this).data('id') + ',';
   });
   setEventsCategoryEx(categoryId, url, parentUrl);
} 
```

这**应该**是错误的，因为 categoryId 不是全局的，所以它不应该使用“that.categoryId”来访问。

问题是：当执行第一次进入 each 方法时，输出 that.categoryId 会生成“abc”（我分配给本地 categoryId 变量的值）。

当鼠标离开 each 函数时，that.categoryId 和 categoryId 有不同的值： categoryId = "abc" that.categoryId = "abc+"

我不明白以下内容：它们应该是单独的变量，为什么它们以相同的值开头？

谢谢，奥斯卡

编辑：对不起，复制和粘贴时我忘记添加函数声明。它位于由“onclick”事件调用的函数内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:46:37.527

如果您不在函数内部，则`var categoryId = 'abc'`与`window.categoryId = 'abc'`.

如果您不在函数内部，`this`则为`window`

所以你看到的是预期的行为。

请参阅[您的 js 控制台以获取此实时示例](http://jsfiddle.net/Euvz9/)

> 编辑：对不起，复制和粘贴时我忘记添加函数声明。它位于由“onclick”事件调用的函数内。

编辑后，[我无法重现该问题](http://jsfiddle.net/Euvz9/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:49:36.353

当您在非严格模式下调用未用作方法的函数时，则为`this`全局对象。

[语言规范的第 11.2.3 节](http://es5.github.com/#x11.2.3)说：

> 产生*式 CallExpression* `:` *MemberExpression* *Arguments* 评估如下：
> 
> ```
> 6\. If Type(ref) is Reference, then
>      If IsPropertyReference(ref) is true, then
>        Let thisValue be GetBase(ref).
>    Else, the base of ref is an Environment Record
>      Let thisValue be the result of calling the ImplicitThisValue concrete method of GetBase(ref). 
> ```

# wcf - 一个 SL 客户端而不是另一个客户端的微小 WCF 查询超时

> ID：11937703
> 
> 赞同：0
> 
> 时间：2012-08-13T15:41:57.203
> 
> 标签：wcf, silverlight, timeout

我有一个 WCF 服务，我的 SL 应用程序与之对话。我有一个旧版本的应用程序和一个新版本 - 我已将新版本部署到实时服务器上，但它无法工作（只是坐在那里并最终引发超时错误）

我已将原始应用程序放回原处并将新应用程序放在旁边。我已经运行了两个，一个工作，另一个没有。新应用程序的调试器显示该应用程序正在调用一些非常简单的 Web 方法，这些方法查询后端数据库并返回一组查找值（事实上，出于好奇，我已经跳过了所有调用，除了一个调用并且从数据库返回 3 行的单个调用仍然超时）。我自己查询了数据库，另一个应用程序也在查询相同的表，所以我认为问题不存在，因为我得到了即时响应。我现在不知道在哪里看...

奇怪的是：偶尔回调会触发并且我得到响应，但大多数时候它会超时。这仍然需要一段时间（10-15 秒）

我不知道为什么会发生这种情况，或者为什么两个应用程序之间存在差异 - 两个应用程序都使用相同的服务引用和相同的应用程序配置设置。一个有效，一个无效...

我开始拔头发了！

有人有类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T10:09:21.363

不知道它到底是什么，但它可能与在 App_Startup 中调用 WCF 服务有关（或者它可能只是疯了一天）

我最终将代码从 App_Startup 移到了一个新的“正在加载”的 UC 上

当应用程序启动时，它使用正在加载的 UC 作为 RootVisual。这通过调用 WCF 服务加载数据，同时显示一个保持页面。

加载数据后，UC 会隐藏加载屏幕并将主窗口添加到它的子集合中，从而让一切顺利进行

我认为这对用户来说也更好，因为它给了他们一些应用程序已加载并且很忙的反馈，而不仅仅是几秒钟的白屏。它还向他们表明在服务关闭等情况下正在发生某些事情并且它没有立即响应

现在我不再拉自己的头发了！

# python - 调用具有超过 1 个返回值的 python 脚本

> ID：11937706
> 
> 赞同：3
> 
> 时间：2012-08-13T15:42:15.927
> 
> 标签：python, python-c-api

如何处理返回多个列表的 Python 函数

Python脚本：

```
display():
    a = [ 'a','b','abc']
    b = [ 1 , 2 , 3]
    return [a,b] 
```

调用上述 python 函数的 c 函数片段：

```
pValue,pValue1 = PyObject_CallObject(pFunc, pArgs); 
```

这是调用函数的正确方法吗？但是我不能使用这些对象来提取列表值。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:47:04.827

```
PyObject *ret;
ret=PyObject_CallObject(pFunc,pArgs);
PyObject *ob1,*ob2;

PyArg_ParseTuple(ret,"oo",ob1,ob2); //o-> pyobject |i-> int|s-> char* 
```

这就是你的做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T23:13:03.973

所有 Python 函数/方法都返回一个“事物”，但该“事物”可以是“容器”。你一直在问如何返回多个列表；您要做的是返回一个元组或一个列表，其中包含您要返回的“多个列表”。然后，在调用代码中，您访问元组或列表的元素以获取您想要返回的“多个列表”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T15:45:16.860

您不会收到两个对象，您会收到一个`PyTuple`实际上由您的函数返回的新引用。

# configuration - 使用 Symfony2 配置类，如何定义其子节点没有键的数组节点？

> ID：11937710
> 
> 赞同：7
> 
> 时间：2012-08-13T15:42:30.630
> 
> 标签：configuration, symfony

使用配置类，如何定义没有数字键的数组节点？数组的子代不代表进一步的配置选项。相反，它们将是一个无法选择性地覆盖的列表，只能作为一个整体来覆盖。

到目前为止，我有：

```
public function getConfigTreeBuilder()
{
    $treeBuilder = new TreeBuilder;
    $root = $treeBuilder->root('acme_base');

    $root
        ->children()
            ->arrayNode('entities')

                // Unfortunately, this doesn't work
                ->defaultValue(array(
                    'Acme\BaseBundle\Entity\DefaultEntity1',
                    'Acme\BaseBundle\Entity\DefaultEntity2',
                ))

            ->end()
        ->end();

    return $treeBuilder;
} 
```

在`app/config.yml`中，我希望能够像这样覆盖它：

```
acme_base:
  entities:
    - 'Acme\BaseBundle\Entity\AnotherEntity1'
    - 'Acme\BaseBundle\Entity\AnotherEntity2'
    - 'Acme\BaseBundle\Entity\AnotherEntity3'
    - 'Acme\BaseBundle\Entity\AnotherEntity4' 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-13T16:13:09.553

我想你需要

```
$root
    ->children()
        ->arrayNode('entities')
        ->addDefaultsIfNotSet()
        ->prototype('scalar')->end()
        ->defaultValue(array(
            'Acme\BaseBundle\Entity\DefaultEntity1',
            'Acme\BaseBundle\Entity\DefaultEntity2',
        ))
    ->end() 
```

# visual-studio-lightswitch - Lightswitch 中新行的自动递增日期

> ID：11937712
> 
> 赞同：2
> 
> 时间：2012-08-13T15:42:41.820
> 
> 标签：visual-studio-lightswitch

我有一张米表。然后是一个仪表读数表（其中引用了仪表表，还有一个日期列和一个读数值列）。这个想法是，每天都会记录给定仪表的读数。UI 工作正常，我可以选择一个仪表，然后单击按钮添加一个新的读数，一个空白的“读数”行被添加到读数网格中。读数的输入日期默认为今天。

我想做的是将阅读日期默认为特定仪表的最后阅读日期，+ 1 天。我的设想是在 Reading_Created 处理程序中，我有这样的伪代码：

```
 var lastDate = DataWorkspace.Data.Readings
                  .Where(r=> r.MeterID == this.MeterID)
                  .Max(r=> r.ReadingDate);
    this.ReadingDate = lastDate.AddDays(1); 
```

这在 Lightswitch 应用程序中是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T01:56:40.410

如果您使用*this.ReadingCollection.AddNew();添加新的**阅读* 那么新添加的*读数*将具有其父*仪表*已经正确设置。

 ****鉴于Meter*与其*Readings*之间存在关系，您可以通过将代码修改为如下所示的内容来利用它：

```
partial void Reading_Created()
{
    //get parent meter's existing Readings
    var previousReadings = (from r in this.Meter.Readings select r)

    //if previous readings exist for this meter, get the last date, & add a day to it
    if (previousReadings.Any())
    { 
        this.ReadingDate = previousReadings.Max(d => d.ReadingDate).AddDays(1);
    }
    //otherwise, just use today's date
    else
    {
        this.ReadingDate = Date.Today();
    }
} 
```

这样做，您不需要过滤 Readings 表的记录（关系为您完成），您不需要对它们进行排序，并且您不需要*TakeOne*（如果没有记录）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-05T12:28:02.737

```
 I know this post is older but for anyone researching the method, thanks to Beth Massi vid HDI#20 I came up with this for a similar screen. 
```

/*此方法在单击绿色 + 按钮时触发，查看集合中的选定项并将选定项中的信息复制到要添加的新项中。*/

```
 partial void Worklists_Changed(NotifyCollectionChangedEventArgs e)
    { 

          if (e.Action == System.Collections.Specialized.NotifyCollectionChangedAction.Add)
        {
            if (this.Worklists.Count > 1 & e.NewItems.Count == 1)
                {
                    try
                    {
                        Worklist newRecord = (Worklist)e.NewItems[0];
                        Worklist currentRecord = this.Worklists.SelectedItem;

                        newRecord.StartTime = currentRecord.StartTime.Value.AddDays(1);
                        newRecord.EndTime = currentRecord.EndTime.Value.AddDays(1);
                        newRecord.WorklistCode = currentRecord.WorklistCode;
                    }

                    catch (Exception ex)
                    {
                        Trace.TraceInformation("Could not copy data into new row " + ex.ToString());
                    }
                }
        }
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T20:38:38.047

您可以将此代码添加到实体的 Created() 事件中：

```
partial void Readings_Created()
{
    ReadingDate = (from o in this.DataWorkspace.Data.Readings
                  where MeterID == this.MeterID
                  orderby o.ReadingDate descending
                  select o).Take(1).Execute().Max(o => o.ReadingDate).AddDays(1);
} 
```

我测试了一组类似的代码，它计算出新行的正确日期。如果没有 MeterID 条目，我没有测试这是否可行。***

# javascript - javascript - 减少重复点击事件

> ID：11937713
> 
> 赞同：1
> 
> 时间：2012-08-13T15:42:50.450
> 
> 标签：javascript

我刚刚进入我的 javascript（模式、命名空间、对象等），并试图在我的最新项目中实践其中的一些。

我有一个简单的表单，我正在尝试根据选中的复选框来显示/隐藏某些内容。HTML 无法更改（长篇大论），所以我只关注手头的 javascript 问题，也就是说，当 ID 不止一个时，我怎样才能很好地减少重复性？

脚本（我确定可以压缩）如下：

```
var prereg = {

    hideItems: (function() {
        document.getElementById('companyName-element').style.display = 'none';
        document.getElementById('companyName-label').style.display = 'none';
    })(),

    showItems: function() {
        var checkbox = document.getElementById('businessCustomer'); 
        if(checkbox.checked) {
            document.getElementById('companyName-element').style.display = 'block';
            document.getElementById('companyName-label').style.display = 'block';
        } else {
            document.getElementById('companyName-element').style.display = 'none';
            document.getElementById('companyName-label').style.display = 'none';
        }
    },

    addEvent: function (el, ev, fn) {
         if (el.addEventListener) {
             el.addEventListener(ev, fn, false);
         } else if (el.attachEvent) {
             el.attachEvent('on' + ev, fn);
         } else {
             el['on' + ev] = fn;
         }
     }

}

prereg.addEvent(document.getElementById('businessCustomer-label'), 'click', prereg.showItems);
prereg.addEvent(document.getElementById('businessCustomer-element'), 'click', prereg.showItems); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:54:24.803

我认为您正在寻找事件委托，这是一种奇特的说法*，即对同一类型的所有事件使用单个处理程序*。好吧，即使是不同的类型也是一种选择。但只是一个例子：

假设您的 html 如下所示：

```
<form id="formId"><input type="checkbox" id="foo"/>
    <input type="checkbox" id="bar"/> 
```

等等（不能被打扰）。您的 JS 可以使用 1 个事件侦听器和处理程序处理所有点击事件：

```
var form = document.getElementById('formId');
if (form.addEventListener)
{
    form.addEventListener('click',clickDelegator,false);
}
else
{
    form.attachEvent('onclick',clickDelegator);
}
function clickDelegator(e)
{
    e = e || window.event;
    var target = e.target || e.srcElement;//target holds reference to clicked element
    if (target.tagName.toLowerCase() !== 'input')
    {
        //not interested in this, just let the event pass
        return e;// or return true; or return;... doesn't matter
    }
    switch(target.type.toLowerCase())//target is an input field, we've established that
    {
        case 'checkbox':
            //code for checkboxes;
            //target is a checkbox, use target.checked, target.id, as normal
        break;
        case 'button':
            //deal with buttons here
        break;
        //etc...
    }
} 
```

如果您希望 1 个*委托函数*来处理所有事件，则可以，但随后您将不得不使用`switch...case`all `e.type`，当然这通常会导致无用、无法维护的蒙特函数。但你知道：这*是*可能的。

需要关闭吗？好没问题：

```
form.addEventListener('click',(function(someVar)
{
    return function(e)
    {
        e = e || window.event;
        clickDelegator.apply(this,[e,someVar]);
        //pass as argument, the clickDelegator was declared outside closure scope
        //and doesn't have access to someVar, but this way, it has the closure var
        //as an argument
    }
})(theClosureVar),false); 
```

谷歌一些事件委托的更多例子，你不会后悔的……这是 JavaScript 的那些被严重低估的特性之一，并且没有像他们应该的那样广为人知。我希望我能给你一个更好的闭包-委托组合的例子，因为这是一个非常强大的组合。以移动设备为例：没有点击事件，只有 touchstart 和 touchend 事件。因此，您将 touchstart 处理程序设置为绑定 touchend 侦听器，并通过闭包将超时 id 添加到 touchend 事件的处理程序。如果一段时间过去了，用户可能没有点击该元素，而是使用了他/她手机的其他一些触摸功能，因此您可以分离监听器。

我不擅长解释这一点，但看一些自定义`tab`事件如何工作的例子，它通常归结为类似于我在这里运球的东西，现在我要睡觉了......祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:13:00.550

无需过多地重构代码，您只需将要操作的对象缓存在一个数组中并在循环中处理它们。

```
var prereg = (function () {

    // add your style elements to this array. We only call getElementId once
    // and not on each function call.
    var styleObjects = [ 
            document.getElementById('companyName-element'),
            document.getElementById('companyName-label')
        ],

        checkbox = document.getElementById('businessCustomer'),

        i;

    // Function applies display style to all elements in styleObjects array
    function applyStyle(display) {
        var i;
        for (i = 0; i < styleObjects.length; i += 1) {
            styleObjects[i].style.display = display;
        }
    }

    function hideItems() {
        applyStyle('none');
    }

    function showItems() {            
        if(checkbox.checked) {
            applyStyle('block');
        } else {
            applyStyle('none');
        }
    }

    function addEvent(el, ev, fn) {
        if (el.addEventListener) {
         el.addEventListener(ev, fn, false);
        } else if (el.attachEvent) {
         el.attachEvent('on' + ev, fn);
        } else {
         el['on' + ev] = fn;
        }
    }    

    // Attach event handler to all objects in styleObjects array
    for (i = 0; i < styleObjects.length; i += 1) {
        addEvent(styleObjects[i], 'click', showItems);
    }

    return {
        hideItems: hideItems,
        showItems: showItems,
        addEvent: addEvent
    };
}()); 
```

如果你想多次这样做，修改它以接受复选框和元素数组作为参数将是微不足道的。

# google-chrome - Chrome 21 不检查单选按钮

> ID：11937715
> 
> 赞同：5
> 
> 时间：2012-08-13T15:42:52.497
> 
> 标签：google-chrome, radio-button

我经过一番努力才弄清楚这一点，所以我想我会分享我遇到的东西，这样其他人就可以从我的努力中受益。Firefox IE 和 chrome 19（我手头唯一的其他版本）对此没有问题，但 chrome 21 有。

如果你有这个单选按钮

```
<input type='radio' name'k1' value='v1' checked> 
```

如果它位于无效位置，它将不会在页面上显示为选中状态。

例如我有

```
<table>
<input type='radio' name'k1' value='v1' checked> 
<tr><td>table information</td></tr> 
</table> 
```

而且无论我做什么，加载页面时都不会显示为选中状态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T18:14:35.887

在 Google Chrome 21.0.1180.75 和 .79 上测试

```
<table>
  <input type="checkbox" name="n" value="v" checked="checked" />
</table> 
```

缺少`<tr><td></tr></td>`输入元素周围的复选框会导致`checked`复选框不显示为选中状态。此外，当提交表单时，这些复选框也不会被检查到服务器端！

正确格式化 html 后，复选框应显示为选中，如`checked`属性所示：

```
<table>
  <tr>
    <td>
      <input type="checkbox" name="n" value="v" checked="checked" />
    </td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T15:42:52.497

我的 html 肯定是无效的，但在我的情况下它是隐藏的，所以我没有立即注意到，但无论是否隐藏，当页面加载时按钮将不会被检查（因此不会与表单一起提交）。

如果您将输入放在有效的位置，它可以正常工作......

> ```
> <table>
> <tr><td>table information
> <input type='radio' name'k1' value='v1' checked>
> </td></tr>
> </table> 
> ```

所以确定我的布局有误，我确定流行的反应是“你怎么能指望浏览器解释无效的 html？” 我同意，但不检查单选按钮，特别是因为它被隐藏（并且它曾经在以前的 chrome 版本中工作）使得难以追踪错误。所以我想我可以为别人节省几个小时的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:51:59.553

尽管它与所讨论的浏览器无关，但某些移动设备（例如 Galaxy S3）不会检查单选按钮，除非它在表单中。根据我的经验，大多数其他输入（例如复选框）都很好。

# object - 对象矩阵？

> ID：11937717
> 
> 赞同：0
> 
> 时间：2012-08-13T15:42:56.023
> 
> 标签：object, boost, stl, matrix

我想创建一个对象矩阵，并且我还想以“矩阵（i，j）”的方式访问它的元素。我首先想到了 Boost，但据我所知，Boost 矩阵由基本数据类型（如 int 或 double）组成，而不是由其他更复杂的对象组成。

我也考虑过使用STL；我记得曾两次使用向量看到二维矩阵的 STL 定义。

干杯，何塞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:20:55.960

我很确定您可以将 boost 矩阵类用于任意类型；只是一堆数值算法需要矩阵中的元素具有类似数值的语义。

请参阅[http://www.boost.org/doc/libs/1_50_0/libs/numeric/ublas/doc/types_overview.htm](http://www.boost.org/doc/libs/1_50_0/libs/numeric/ublas/doc/types_overview.htm)和[http://www.boost.org/doc/libs/1_50_0/libs/numeric/ublas /doc/matrix.htm](http://www.boost.org/doc/libs/1_50_0/libs/numeric/ublas/doc/matrix.htm)

这是一个例子：

```
#include <boost/numeric/ublas/matrix.hpp>
#include <string>
int main (int argc, const char * argv [] ) {
    boost::numeric::ublas::matrix <std::string> strMatrix (5, 4);
    strMatrix ( 3, 4 ) = std::string ( "Hello!" );
    return 0 ;
} 
```

# gwt - GWT 编译失败并出现 emma - InvocationTargetException；嵌套异常为空：非法局部变量

> ID：11937720
> 
> 赞同：1
> 
> 时间：2012-08-13T15:43:04.323
> 
> 标签：gwt, maven, java-7, emma

即使您的代码编译为 java 1.6，您在 Java7 环境中运行时是否遇到过 emma 问题？

我有一个多模块构建，其中大多数为 jdk 1.7，为 GWT 模块及其依赖项使用 jdk 1.6（或者我认为 - 我怀疑我在这一点上弄错了，这是我问题的核心）。

```
Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.9:test 
(default-test) on project ...: Execution default-test of goal 
org.apache.maven.plugins:maven-surefire-plugin:2.9:test failed: java.lang.reflect.InvocationTargetException; nested exception is 
java.lang.reflect.InvocationTargetException: null: Illegal local variable 
table length 16 in method ....<init>()V -> [Help 1] 
```

如果 GWT 和 emma 存在已知问题或解决方法，请告诉我。

谢谢

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:36:41.833

问题似乎是依赖模块中的 java7 字节码不兼容。将支持 GWT 的基本模块的源和目标设置为 1.6 解决了这个问题。GWT 目前报告与 1.5 的兼容性，但 1.6 似乎可以正常工作。但是1.7是个问题。

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    ...
    <configuration>
      <source>1.6</source>
      <target>1.6</target>
    </configuration> 
```

# svg - 同一 SVG 结构内的 SVG 链接

> ID：11937725
> 
> 赞同：0
> 
> 时间：2012-08-13T15:43:21.277
> 
> 标签：svg, hyperlink, href, xlink

我的 HTML 文档中有两个 SVG 结构。比如说，

```
<svg width="8cm" height="3cm"
 xmlns="http://www.w3.org/2000/svg" version="1.1">
  <desc>Local URI references within ancestor's 'defs' element.</desc>
  <defs>
   <linearGradient id="Gradient01">
     <stop offset="20%" stop-color="#39F" />
     <stop offset="90%" stop-color="#F3F" />
   </linearGradient>
  </defs>
  <rect x="1cm" y="1cm" width="6cm" height="1cm" fill="url(#Gradient01)" />
</svg> 
```

和

```
<svg width="8cm" height="3cm"
 xmlns="http://www.w3.org/2000/svg" version="1.1">
  <defs>
   <linearGradient id="Gradient01">
     <stop offset="20%" stop-color="#85F" />
     <stop offset="90%" stop-color="#35F" />
   </linearGradient>
  </defs>
  <rect x="10cm" y="10cm" width="60cm" height="10cm" fill="url(#Gradient01)" />
</svg> 
```

尽管在两个 SVG 结构中都有一个 ID 为“Gradient01”的“linearGradient 标签”，但第二个 SVG 结构的矩形也遵循第一个的“linearGradient”。（因为它在整个文档中搜索 id）

无论如何，它总是只在那个 SVG 结构中链接。（因为在我的情况下，我无法更改 ID）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:05:19.357

`<iframe>`您可以将 svg 转换为独立图像，然后使用or`<object>`标记将它们嵌入到 html 文档中。

# objective-c - NSTextView 粘贴：粘贴“foo”时如何粘贴“bar”？

> ID：11937726
> 
> 赞同：4
> 
> 时间：2012-08-13T15:43:26.733
> 
> 标签：objective-c, cocoa, nstextview

我有一个 NSTextView，用户可以将纯文本粘贴到其中。

当用户在粘贴板中有“foo”时，我希望粘贴“bar”。换句话说，用户进入网络浏览器，选择“foo”，cmd+c，切换到我的 NSTextView，cmd+v 并且“bar”出现在插入点。

请问，有谁知道如何解决这个问题？

编辑：是否有可能以某种方式`readSelectionFromPasteboard:type:`用于此？我只是不知道在我重写的文本视图的方法体中放什么..？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T20:21:06.247

试试这个。子类化您的文本视图，并覆盖 paste: 这样：

```
@implementation RDTextView

-(void)paste:(id)sender {
    NSPasteboard *pb = [NSPasteboard generalPasteboard];
    NSString *pbItem = [pb readObjectsForClasses: @[[NSString class],[NSAttributedString class]] options:nil].lastObject;
    if ([pbItem isKindOfClass:[NSAttributedString class]]) 
        pbItem = [(NSAttributedString *)pbItem string];

    if ([pbItem isEqualToString:@"foo"]) {
        [self insertText:@"bar"];
    }else{
        [super paste:sender];
    }
}

@end 
```

# php - TCPDF 使页眉边距比正文宽

> ID：11937727
> 
> 赞同：2
> 
> 时间：2012-08-13T15:43:31.110
> 
> 标签：php, tcpdf

在 TCPDF 中，我试图让标题占据页面的整个宽度，但其他地方仍然有边距。因为页眉包含在页边距中，所以我发现很难做到这一点。怎么做到呢？

# sql - 满足一个条件时如何检索多行

> ID：11937731
> 
> 赞同：0
> 
> 时间：2012-08-13T15:43:53.987
> 
> 标签：sql, sql-server-2008

我要做的就是在满足条件时检索与特定销售相关的所有行。

所以我可能在一个订单上有 5 行，我正试图撤回所有 5 行，其中一行有一个特定的产品代码。

我试图检索的行具有相同的 orderid，并且不同

如您所见，两行的 orderid 相同，我想检索 ManualCode 等于“STKCORRECTION”的两行

简单吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:56:10.927

您遗漏了许多重要的细节，但我会对此进行尝试。假设您有下表：

```
OrderItemId   | Code   | OrderId
---------------------------------
1               red      2 
2               black    2
3               green    2
4               green    3
5               blue     3 
```

并且您想选择订单中的一个 OrderItems 具有 code 的所有 OrderItems `red`，您可以使用以下查询：

```
with reds as
(
    SELECT distinct OrderId FROM OrderItems WHERE Code = 'red'
)
SELECT * FROM OrderItems as oi
INNER JOIN reds as r
ON oi.OrderId = r.OrderId 
```

这将返回示例表中的前三个 OrderItem。

# api - 如何使用新的 facebook php sdk_api 获取 offline_access

> ID：11937732
> 
> 赞同：1
> 
> 时间：2012-08-13T15:44:02.393
> 
> 标签：api, facebook-graph-api, facebook-app-requests

参考以下网址-：

[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

2012年10月起不再支持使用offline_access获取用户信息（脸书好友、出生日期、好友墙发帖）的现有方式。

是否有任何方法可以离线访问用户的信息。

在这方面的任何帮助将不胜感激。

提前致谢。

# silverlight - 根据屏幕大小设置 Silverlight 应用程序的宽度

> ID：11937741
> 
> 赞同：1
> 
> 时间：2012-08-13T15:44:49.803
> 
> 标签：silverlight, silverlight-4.0

在 silverlight 4.0 应用程序上，我需要根据用户屏幕的大小将主窗口的宽度设置为可能的最大宽度。

如何做到这一点？

# c# - 网络上的命令行控制

> ID：11937742
> 
> 赞同：0
> 
> 时间：2012-08-13T15:44:51.900
> 
> 标签：c#, c++, windows, linux, remote-access

有什么方法可以远程访问另一台 PC 并以完全访问权限使用它的命令行？

我正在尝试开发一个可以通过命令行完全控制其所有客户端的服务器。

它将是一个 ubuntu 服务器，但所有客户端都是 Windows 7 Pro x64。

我希望能够在 VC# .Net 3.5 中编写此脚本，但作为最后的手段，我会在 C++ 中编写。

我有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:49:38.147

远程命令行？

我使用来自[sysinternals的](http://technet.microsoft.com/en-US/sysinternals)[PSEXEC](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)就像这样：

`psexec \\machinename cmd.exe`

再简单不过了

**抱歉 - 我显然错过了需要从 linux 控制它的一点。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:02:25.640

我从未在 Linux 中尝试过这个，但它在完整的 Windows 环境中很有用。查看远程计算机上的 PowerShell Remoting。您可能能够通过 Linux 机器上的 C# MONO 连接到远程机器，但我不确定 MONO 中是否还提供适当的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:52:21.700

也许我误解了你，但你总是可以在 Windows 机器上实现一个 C# 客户端，它使用 IPC 从命令提示符发送输入和读取输出，你会有一个在 Linux 上运行的 C++/mono C#/netcat 服务器。客户端将来自流的所有内容转换为字符串并将其写入命令提示符，然后获取输出并将其写入流。代码项目的礼貌：http: [//www.codeproject.com/Articles/20250/Reverse-Connection-Shell](http://www.codeproject.com/Articles/20250/Reverse-Connection-Shell)

```
cmd = new Process();
        cmd.StartInfo.FileName = "cmd.exe";
        cmd.StartInfo.CreateNoWindow = true;
        cmd.StartInfo.UseShellExecute = false;
        cmd.StartInfo.RedirectStandardOutput = true;
        cmd.StartInfo.RedirectStandardInput = true;
        cmd.StartInfo.RedirectStandardError = true;
        cmd.OutputDataReceived += new
        DataReceivedEventHandler(CmdOutputDataHandler);
        cmd.Start();
        cmd.BeginOutputReadLine();

public void CmdOutputDataHandler(object sendingProcess,
    DataReceivedEventArgs cmdout)
    {                         
                output.Append(cmdout.Data);
                writer.WriteLine(output);
                writer.Flush();                

    }

// Run this in a separate thread to prevent blocking
while (true)
{
input.Append(reader.ReadLine());
input.Append("\n");
cmd.StandardInput.WriteLine(input);
input.Remove(0, input.Length);
} 
```

# python - 在 Python 中以编程方式创建带有下拉单元格的 XLS

> ID：11937746
> 
> 赞同：5
> 
> 时间：2012-08-13T15:44:59.460
> 
> 标签：python, excel, xlwt

我目前正在使用 Python 和`XLWT/XLRD`库以编程方式创建 XLS 文件。

我已经能够用值填充单元格并插入简单的公式。我的挑战是我想为我的用户创建一个下拉列表（[http://office.microsoft.com/en-us/excel-help/create-or-remove-a-drop-down-list-HP005202215.aspx](http://office.microsoft.com/en-us/excel-help/create-or-remove-a-drop-down-list-HP005202215.aspx) )

是的，我可以在 EXCEL 中轻松地做到这一点，但我需要让这个过程自动化——我正在使用 Python 和`XLWT/XLRD`库——我宁愿坚持使用它们，但如果有必要我会切换到其他东西（我是在 Ubuntu Linux 服务器中）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-23T20:48:37.253

openpyxl 还通过数据验证支持 XLSX 文件中的下拉单元格：http: [//openpyxl.readthedocs.org/en/latest/validation.html](http://openpyxl.readthedocs.org/en/latest/validation.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-17T15:19:42.983

仅作记录，[xlsxwriter](https://pypi.python.org/pypi/XlsxWriter/0.4.3)可以处理 XLSX 上的下拉列表：

[https://xlsxwriter.readthedocs.org/en/latest/example_data_validate.html](https://xlsxwriter.readthedocs.org/en/latest/example_data_validate.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T15:55:28.117

简短的回答：你不能 - 不受 XLWT/XLRD 的支持。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-13T20:30:21.827

你最好的选择是通过 COM。

[http://oreilly.com/catalog/pythonwin32/chapter/ch12.html](http://oreilly.com/catalog/pythonwin32/chapter/ch12.html)

从那里，您可以在 Office 的本机 Visual Basic 中获得所有可用选项——包括（至少）向窗口中的各种对象发送点击和按键的能力。

# python - Google App Engine + webbapp2 上带有“hello world”应用程序的动态子域

> ID：11937748
> 
> 赞同：2
> 
> 时间：2012-08-13T15:45:11.770
> 
> 标签：python, google-app-engine, subdomain, webapp2, cname

我有几个问题。我工作了好几天都想不通。

目标：在 Google App Engine 上动态创建子域。

我只是一个我想推荐实施的“hello world”，剩下的可以自己处理。

1-http://eqsudmoain.appid.appspot.com 写入 = “eqsubdomain”

2-http://appid.appspot.com 写成=“你好世界”

我只想做他们，我需要你的帮助。我找到了这段代码的文档，而不是动态的。

这是代码； [https://snipt.net/mehmetkose/google-app-engine-dynamic-subdomains-question/?key=7a99428d29d9aa8376158a22dbb63c94](https://snipt.net/mehmetkose/google-app-engine-dynamic-subdomains-question/?key=7a99428d29d9aa8376158a22dbb63c94)

这也是使用cname的域名注册商你会推荐吗？谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:04:38.003

您不能在代码中动态设置域。

但是，您可以通过设置不同的应用程序版本来拥有不同的子域。这是各种版本的映射方式（请注意，版本是字符串而不是数字）：

```
http://1.appid.appspot.com   // version "1"

http://eqsudmoain.appid.appspot.com   // version "eqsudmoain"

http://appid.appspot.com   // default version 
```

您可以[在 app.yaml 中设置版本](https://developers.google.com/appengine/docs/python/config/appconfig#Required_Elements)。您在管理员 - 版本中设置默认版本。

所以，你的建议是可能的，通过在不同版本下多次上传代码，然后使用链接中的示例代码来区分代码中的子域。

**编辑：**

您不能在 上进行动态子域映射`*.appid.appspot.com`，但可以在自己的域上进行[通配符 DNS 映射](http://en.wikipedia.org/wiki/Wildcard_DNS_record)`*.yourdomain.com`，即. 然后在代码中，您可以检查主机并将请求路由到正确的代码。

# java - pack() 不会正确打包

> ID：11937751
> 
> 赞同：0
> 
> 时间：2012-08-13T15:45:22.243
> 
> 标签：java, swing, jframe, jpanel, layout-manager

我在这里有一个 JFrame：

```
import javax.swing.JFrame;

public class Game extends JFrame {
    private static final long serialVersionUID = -7919358146481096788L;
    Arena a = new Arena();
    public static void main(String[] args) {
        new Game();
    }
    private Game() {
        setTitle("Insert name of game here");
        setLocationRelativeTo(null);
        setLayout(null);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        add(a);
        pack();
        setResizable(false);
        setVisible(true);
    }
    private void refresh() {

    }
} 
```

这`Arena`是一个JPanel：

```
import java.awt.Dimension;

import javax.swing.JPanel;

public class Arena extends JPanel {
    private static final long serialVersionUID = 6499922741928110264L;
    byte[][] world = new byte[6000][2000];
    int blockPix = 20;
    int x = 2999 * blockPix, y = 999 * blockPix;
    public Arena() {
        setLayout(null);
        setMinimumSize(new Dimension(600, 600));
        setMaximumSize(new Dimension(600, 600));
        setPreferredSize(new Dimension(600, 600));
    }
} 
```

然而，JFrame 的大小最终是 0 x 0！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:09:52.497

您应该删除构造函数中的`setLayout(null);`指令`Game`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T15:48:29.537

也许您可以`setSize(600, 600);`在构造函数中进行所有其他修复的地方？

# cocoa - 山狮 nssharing 服务

> ID：11937752
> 
> 赞同：0
> 
> 时间：2012-08-13T15:45:25.993
> 
> 标签：cocoa, service, share

我一直在研究 NSShareService 并且我想制作一项新服务，但它可以从任何地方获得。我真的一直在寻找，但我找不到任何此类信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:00:29.353

可悲的是，您无法编写随处可用的。您只能编写在您自己的应用程序中可用的内容。

# objective-c - 在 AFNetworking 中禁用特定图像缓存

> ID：11937755
> 
> 赞同：0
> 
> 时间：2012-08-13T15:45:38.263
> 
> 标签：objective-c, ios, afnetworking

我正在开发一个应用程序，人们可以在其中上传照片并进行编辑（例如提供效果、裁剪、旋转等）。对于上传和下载，我使用的是 AFNetworking 框架。

我的问题如下：当我编辑照片时，我将新版本上传到文件服务器。在应用程序中，我正在调整 AFImageCache 以保存对新（已编辑）照片的引用。当我关闭并再次打开应用程序时，旧图像被加载。

所以我的问题是：除了 iPhone 使用的 AFImageCache 之外，还有其他类型的缓存吗？如果是这样，我如何从该缓存中清除图像，以便在我重新启动应用程序时从服务器获取新图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:52:10.050

iPhone 上没有内置缓存，因此发生的任何缓存都是：

1.  在服务器上
2.  在您项目中的代码中

您可以尝试在调试器中单步执行，查看实际从何处加载过时的图像数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T10:24:49.367

我遇到了同样的问题，问题是编辑图像的 URL 和以前的图像相同，并且 url 被 AFNetworking uiimage 类别用作缓存键

在 UIImage+afnetworking.m 中转到

```
- (void)setImageWithURL:(NSURL *)url
       placeholderImage:(UIImage *)placeholderImage 
```

然后添加到它

```
request.cachePolicy=NSURLRequestReloadIgnoringCacheData;//my change for disabling 
```

你可以检查这个[链接](http://codefriends.blogspot.in/2013/05/how-to-disable-caching-of-particular.html)

# asp.net - 从 Repeater 控件中的数据中选择 RadioButtonList 中的值

> ID：11937756
> 
> 赞同：0
> 
> 时间：2012-08-13T15:45:38.397
> 
> 标签：asp.net

我有一个中继器控件，在其中我有两个单选按钮选择性别（男性，女性）。当我保存页面时，我将选定的值“M”或“F”保存到数据中。当我加载页面时，我希望根据保存的内容选择单选按钮。

因此，在这种情况下，我的中继器具有 (Container.DataItem).Sex，它等于“M”或“F”。如何在我的单选按钮中使用这些数据来选择合适的值？

这是我想使用的那种功能（但它不存在）：

```
<asp:RadioButtonList runat="server" SelectedValue='<%# ((Dependent)(Container.DataItem)).Sex %>' /> 
```

请注意，我无法操作代码隐藏中的单选按钮，因为我无权访问各个中继器项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:52:06.607

您需要做的是使用 2 个`RadioButton`控件（1 个用于女性，1 个用于男性）。

然后指定`GroupName`，以便在选择另一个时取消选择一个。比方说`GroupName="Sex"`。

然后根据您的指定何时检查每个控件`DataItem`：

```
<asp:RadioButton ID="radioMale" runat="server" GroupName="Sex" Checked="<%# ((Dependent)(Container.DataItem)).Sex == 'M' %>" />
<asp:RadioButton ID="radioFemale" runat="server" GroupName="Sex" Checked="<%# ((Dependent)(Container.DataItem)).Sex == 'F' %>" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:05:48.017

在此处查看此答案 在[表单视图中的转发器中从代码隐藏的下拉列表中设置选定的值，](https://stackoverflow.com/questions/11907291/setting-selected-value-on-a-dropdownlist-from-codebehind-in-a-repeater-in-a-form)您应该能够执行以下操作：

```
<asp:RadioButtonList runat="server" SelectedValue='<%# Eval("Sex") %>' /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T15:58:41.040

> 请注意，我无法操作代码隐藏中的单选按钮，因为我无权访问各个中继器项目。

这`ItemDataBound`就是为了...

```
 <asp:Repeater id="Repeater1" OnItemDataBound="repeaterDatabound" runat="server"> 
```

在后面的代码上：

```
protected void repeaterDatabound(object Sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        (e.Item.FindControl("Repeater1") as RadioButtonList).SelectedValue=((Dependent)e.Item.DataItem).Sex.ToString();
    }
} 
```

# javascript - 在 KnockoutJS 中使用单个动画对多个对象进行动画转换

> ID：11937761
> 
> 赞同：2
> 
> 时间：2012-08-13T15:45:53.577
> 
> 标签：javascript, jquery, knockout.js

我将 KnockoutJS 2.1 用于我目前正在开发的新闻应用程序。我创建了一个 4 x 2 网格，一次显示 8 篇新闻文章（见下图）。

![4 x 2 网格的新闻项目](../Images/7c2256c538a1cedeb4351bb87a60b5a5.png)

我在这个网格中添加了分页，所以当您单击下一步按钮时，会显示 8 条新的新闻文章。这工作得很好！但是，我**想要在过渡中添加一个动画**，所以当您单击下一步时，**8 篇新文章会从右侧滑入，将之前的 8 篇文章从屏幕中推到左侧。**像这样的东西：

![动画过渡](../Images/00d87889bfe6bc22cc3d79b535a28660.png)

我在 Knockout 网站上看到了使用 jQuery并应用动画过渡[的示例。](http://knockoutjs.com/examples/animatedTransitions.html)这种方法的问题是动画被应用到每个单独的新闻文章中。**我需要用一个动画同时为所有文章制作动画。**`afterAdd``beforeRemove`

 **我的想法是，我将在所有 8 篇新闻文章周围使用一个包装元素，使用`overflow: hidden`. 然后我可以在当前文章的右侧添加 8 篇新文章，由于隐藏溢出，新文章仍然看不见。然后我可以将所有 16 篇文章向左滑动，以便新文章可见，而旧文章则在左侧看不见。然后我可以从 DOM 中删除 8 篇旧文章。

我不确定 Knockout 是否可以做到这一点，或者是否有更好的方法可以采用。

**您将如何通过单个动画为添加到 DOM 的 8 篇文章和从 DOM 中删除的 8 篇文章的过渡设置动画？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:55:07.120

您的 Knockout 模板是否可以将它们以 8 个一组的形式添加到整个容器中，然后将容器向左或向右设置为一组宽度的动画？像这样的东西：

```
<div class="newsCarousel">

  <div class="newsGroup">
    <h2>Title 1</h2>
    <h2>Title 2</h2>
    <h2>Title 3</h2>
    ...
    <h2>Title 8</h2>
  </div>

  <div class="newsGroup">
    <h2>Title 9</h2>
    <h2>Title 10</h2>
    <h2>Title 11</h2>
    ...
    <h2>Title 16</h2>
  </div>

</div> 
```**

# magento - 会话到期时重定向 - [Magento]

> ID：11937762
> 
> 赞同：0
> 
> 时间：2012-08-13T15:46:14.090
> 
> 标签：magento, magento-1.7

在我的商店中，当会话到期时，单击我的帐户，用户将重定向到登录页面，但我想将其更改为主页。

所以，如果有人可以帮助我，我很高兴。我会继续尝试这样做，如果我找到了我会在这里发布的方法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T19:45:15.170

终于我找到了答案！

文件：`app/code/core/mage/custoumer/model/session.php`

线路：266

```
$action->setRedirectWithCookieCheck(Mage_Customer_Helper_Data::ROUTE_ACCOUNT_LOGIN,
   Mage::helper('customer')->getLoginUrlParams() 
); 
```

你只需要改变常数`Mage_Customer_Helper_Data::ROUTE_ACCOUNT_LOGIN`

这是所有的了！

# javascript - 将 JavaScript Array.slice + 隐式扩展转换为 C++ 向量

> ID：11937770
> 
> 赞同：1
> 
> 时间：2012-08-13T15:46:49.417
> 
> 标签：javascript, c++, arrays

我正在将 JavaScript 代码移植到 C++ 。

伪代码：

> 如果 n = 1 则追加（订单，订单）

JavaScript（订单和订单是数组）：

```
var order = new array();
var orders = new array();
//....
if (n == 1)
{
    orders[orders.length] = order.slice(); // append copy
} 
```

我在 C++ 中使用向量而不是数组。我认为 C++ 代码应该只是：

```
vector<int> order;
vector<vector<int> > orders;
//.....
orders.push_back(order) 
```

此代码对于上述伪代码和 javascript 代码是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:17:25.720

您有一个条件`n == 1`，我不知道您为什么在 C++ 实现中跳过了它。
在你说你`slice()`用来制作原始列表的副本的评论中，所以你也需要在你的 C++ 实现中做同样的事情。

```
vector< vector<int> > orders;
vector<int> order;
//and to clone and append
std::vector cloned;
std::copy(order.begin(), order.end(), std::back_inserter(cloned));
if(n == 1)
   orders.push_back(cloned); 
```

# c# - 返回 Task 的异步方法返回的任务代表什么？

> ID：11937773
> 
> 赞同：0
> 
> 时间：2012-08-13T15:47:02.610
> 
> 标签：c#, async-await

如果使用 async 声明的异步方法具有 Task 或 Task<TResult> 的返回类型，则可以等待它。在该方法内部，C# 代码中不会返回任何任务，但如果是 Task<TResult>，则返回 TResult 的值。例如：

```
private static async Task<int> AsyncDemo()
{
    await Task.Delay(1000);
    return 1;
} 
```

生成的 IL 代码返回启动已编译状态机的 AsyncTaskMethodBuilder 的任务。我的问题是这个任务实际上代表了什么。我认为这是一个不代表线程左右的任务，而是状态机的执行。我还假设任务在状态机完成时完成，或者在发生异常时设置为故障状态。我感谢澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:10:09.387

任务在概念上代表方法。

当方法返回时，任务完成（成功），结果设置为方法返回的值（如果适用）。如果方法抛出异常，则任务出错（以错误完成）。有一个特殊情况`OperationCanceledException`：在这种情况下，任务被取消（完成并取消）。

从技术上讲，任务确实代表了状态机，这是对方法的重写。但是由于状态机是隐藏的，因此任务在概念上代表了方法本身。

# linux - 使用 ls 命令显示文件按复制时间排序？

> ID：11937775
> 
> 赞同：1
> 
> 时间：2012-08-13T15:47:06.983
> 
> 标签：linux, shell

我有一台远程机器，我`scp`从主机编辑了一堆文件。我想使用`ls`命令来显示这些文件，按复制时间排序。我怎样才能做到这一点？

我试过`ls -lt`了，但似乎不对。它只显示文件创建时间，而不是我的复制时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:49:56.993

`ls -lt`不显示文件创建时间...因为大多数 Unix 文件系统实际上并没有记录文件创建时间。对于那些这样做的人来说，获得它并不一定容易（`ext4`您可以使用`debugfs`命令（[doc](http://www.linuxquestions.org/questions/linux-software-2/how-to-get-file-creation-time-ext4-ntfs-3g-814130/)），但这与您的问题并不密切相关）。

默认情况下，该`-t`标志按修改时间排序。`ctime`您可以通过添加`-c`标志来使用 inode 更改时间 ( )，因此`-lct`.

按 inode 更改时间排序可能会得到您想要的，因为当文件元数据（大小、所有权、权限）更改时会更新，这将在您创建新文件时发生。

# asp.net-mvc-3 - MVCWizard.Wizard - 使用复杂模型

> ID：11937776
> 
> 赞同：0
> 
> 时间：2012-08-13T15:47:07.557
> 
> 标签：asp.net-mvc-3

只是尝试使用 NuGet 中的 MVCWizard.Wizard 作为多页向导 UI 的一部分。

我有一些“父”模型类，以“子”类为小节，例如

```
public class MainModel
{
public virtual int MainModelId { get; set; }
public virtual PersonalDetails CustomerPersonalDetails { get; set; }
public virtual AddressDetails CustomerAddressDetails{ get; set; }
public virtual FinanceDetails CustomerFinanceDetails{ get; set; }
} 
```

通过反复试验，我发现要使用 MVCWizard.Wizard，我必须为要显示的页面的每个子部分创建一个“WizardManager”（因此，一个 WizardManager、控制器、部分视图等用于 CustomerPersonalDetails，一个用于CustomerAddressDetails 等等..)

..到目前为止，一切都很好..

为每个小节创建控制器继承自 WizardController T，其中 T 是模型。我想做的是对每个小节用来接受 MainModel 整体的控制器进行编码，然后根据需要从那里将 MainModel.Child 传递给每个局部视图（MVCWizard.Wizard 似乎需要的方式）

这样做，一切都可以编译，但在使用中，在向导页面（部分视图）之间来回导航，base.Wizard().WizardModel 中的数据正在被清除。

我发现，为了让它在来回导航时保留 Base.Wizard().WizardModel 中的数据，我必须为每个 WizardManager 显式指定子类类型。

所以..（控制器）

```
public MyController : WizardManager < MainModel >...
public PartialViewResult SubsectionPage1(MainModel mdl).. 
```

（看法）

```
@model MainModel
CustName:  @Html.TextBoxFor(m => m.CustomerPersonalDetails.CustName) 
```

..看起来它可以工作，但没有保留数据..但是..

（控制器）

```
public MyController : WizardManager< PersonalDetails >...
public PartialViewResult SubsectionPage1(PersonalDetails details).. 
```

（看法）

```
@model PersonalDetails
CustName:  @Html.TextBoxFor(m => m.CustName) 
```

工作得很好......为什么 MVCWizard.Wizard 似乎无法处理包含一个或多个“子”类型的“复杂”模型，我是否遗漏了什么？最终我可以对其进行编码，因此我将这些较小的模型传递给 WizardManager，然后将它们组合并映射到我的域模型，然后再持久化到数据存储区，但我将不胜感激。

*** 编辑 ***

好的，我已经挖掘了更多，初始模型绑定在大多数正常情况下应该可以正常工作。但是在使用 MVCWizard.Wizard 时，问题似乎出在 MVCWizard.Wizard 的“EnableSimpleMerge”功能上。它在页面导航期间使用，合并函数如何使用反射来发现模型中的属性似乎存在问题。从我最初的外观来看，它似乎没有被编码为在更复杂的模型结构中递归和“发现”子对象。

```
private void Merge(T wizard, T model)
        {
            foreach (PropertyInfo info in model.GetType().GetProperties())
            {
                object obj2 = info.GetGetMethod().Invoke(model, null);
                if (obj2 != null)
                {
                    wizard.GetType().GetProperty(info.Name).GetSetMethod().Invoke(wizard, new object[] { obj2 });
                }
            }
            foreach (FieldInfo info3 in model.GetType().GetFields())
            {
                object obj3 = info3.GetValue(model);
                if (obj3 != null)
                {
                    wizard.GetType().GetField(info3.Name).SetValue(wizard, obj3);
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:38:28.787

（见上面的评论：）

需要使用深度属性反射编写更详细的 Merge 方法

# python - 将二维可变长度数组传入/传出 Python 和 C 的好方法？

> ID：11937778
> 
> 赞同：6
> 
> 时间：2012-08-13T15:47:08.683
> 
> 标签：python, c, ctypes

通过一些黑客攻击，我使用 python c-types 在 Python 和 C 之间来回传输数据。看起来有点乱，所以我希望有更多经验的人能告诉我我做错了什么，或者让这件事变得比需要的更困难。

蟒蛇代码：

```
from ctypes import cdll, POINTER, byref, c_double
lib = cdll.LoadLibrary('./test.so')

def alloc_arrays(length, python_list):
    # Create array of float*
    data = ((POINTER(c_double)) * length)()
    out_data = ((POINTER(c_double)) * length)()
    for i in xrange(length):
        # Create arrays of float
        data[i] = (c_double * 3)()
        out_data[i] = (c_double * 3)()
        # Set Values
        for j in xrange(3):
            data[i][j] = python_list[i][j]
            out_data[i][j] = 0.0
    return data, out_data

if __name__ == "__main__":
    a = [[1.0, 11.0, 21.0],
         [2.0, 12.0, 22.0],
         [3.0, 13.0, 23.0],
         [4.0, 14.0, 24.0],
         [5.0, 15.0, 25.0],
         [6.0, 16.0, 26.0],
         [7.0, 17.0, 27.0]]
    in_data, out_data = alloc_arrays(len(a), a)
    out_len = lib.smain(byref(in_data), len(a), out_data)

    print "out_len", out_len
    clean_out = [None, None, None]
    clean_out = [clean_out[:] for i in xrange(out_len)]
    for i in xrange(out_len):
        for j in xrange(3):
            clean_out[i][j] = out_data[i][j]
    print "Out:", clean_out 
```

C代码（test.c）：

```
int smain(double* in_points[3], int in_len, double* out_points[3]){
    int i;
    int j;
    printf("%s", "\n");
    for(i = 0; i < in_len; i++){
        for(j = 0; j < 3; j++){
            printf("%g, ", *in_points[i][j]);
        }
        printf("%s", "\n");
    }
    printf("%s", "\n");

    //*out_points = malloc(len*sizeof(float[3]));
    int out_len = in_len-2; //Randomly chosen shorter length
    for(i = 0; i < out_len; i++){
        for(j = 0; j < 3; j++){
            //Random function just to see I can do this
            *out_points[i][j] = i*j;
        }
    }
    return out_len;
} 
```

要构建我使用：

```
gcc -c -fPIC test.c
gcc -shared -o test.so test.o 
```

我想知道的主要事情是是否有更好的方法来创建空二维向量以传递给 C，以及是否有更好的方法将变量转换为/从 ctypes 转换为 python 类型。我不喜欢 alloc_arrays 函数必须进行转换，而且我不喜欢让我的 for 循环读取 c_types 2D 列表（刚刚意识到我这样做也有点乱）。

编辑：只是想清楚这段代码按预期工作，我只是认为必须有一些方法来改进它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:56:32.413

这不是关于您的确切代码和 ctypes 的答案，但我想贡献...

我最近刚接触到cython。我什至还不是中级，但它似乎对编写扩展更加友好，并且有很多关于使用 numpy 数组的示例。

*   [面向 NumPy 用户的 Cython](http://wiki.cython.org/tutorials/numpy)
*   [用 cython 简单包装 C 代码](https://stackoverflow.com/questions/3046305/simple-wrapping-of-c-code-with-cython)
*   [类型化的内存视图（cython-array）](http://docs.cython.org/src/userguide/memoryviews.html#cython-array)
*   [NumpyPointerToC](http://wiki.cython.org/tutorials/NumpyPointerToC)

到目前为止，我发现 cython 非常棒，因为它可以让你保持类似于 python 的语法，并且可以自由地混合 python。在帮助将代码转换为包装器中的 C 方面，它为您处理了很多繁重的工作，这是在引擎盖下完成的。并且在produced中没有中间依赖`.so`。只是一个纯粹的扩展。

如果您要在 Python 代码中使用 numpy，那么将它们传递到您的扩展中将毫不费力，因为它不必进行任何转换。numpy 本身在 python 端已经是一个很大的加速，但是做额外的自定义东西可以让你将 numpy 指针传递到 cython 扩展端。

# jquery - Rails 提交按钮和模式视图

> ID：11937785
> 
> 赞同：0
> 
> 时间：2012-08-13T15:47:32.383
> 
> 标签：jquery, ruby-on-rails, ruby

抱歉，如果是菜鸟问题，这里已经出现了 100 次。我有一个文章列表，上面是“到购物车”按钮。我阅读了很多关于模态视图和rails的内容，但它们都是针对link_to的，如何做到这一点，如果我按下我的按钮，它会向我显示一个带有我的购物车的模态窗口？这是我的代码的一部分，带有按钮（它没有 form_tag 等，它位于：

```
- @articles.each do |art|
  = button_to 'В корзину', line_items_path(ART_ID: art), :id => "to-cart" 
```

我想要，如果我点击它，控制器方法会做什么，但它不会重定向到任何地方，我仍然必须在同一页面上，并且模式视图（使用 html 和 jquery）必须出现在我的购物车部分：

```
-unless cart.line_items.empty?
  %table.zebra
    %tr
      %th Наименование
      %th Артикул
      %th Производитель
      %th Количество 
      %th Сумма
    = render(cart.line_items)
  %p
    Общая сумма
    = cart.total_price
  %p
    Наименований (количество):
    = cart.total_count
  = button_to 'Очистить корзину', cart, method: :delete, confirm: 'Вы уверены?'
  -if current_user
    = button_to "Оформить заказ", new_order_path, method: :get
  -else
    %p
      Пожалуйста, для оформления заказа войдите в систему:
      %a#cartlogin{:href => "#"} Логин
    %p
      Если у вас нет аккаунта, зарегистрируйтесь:
      = link_to "Регистрация", new_user_path 
-else
  Увы, ваша корзина пуста 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:58:43.160

The things you want can be done through jQuery/JavaScript. If you're looking for good looking modals, I suggest you checkout [jQuery UI dialog](http://jqueryui.com/demos/dialog/).

You should first attach an event handler to the link, like so. Then disable the default action (which may be a redirect) by adding the event.preventDefault() line. Then you can request for the view data using ajax (probably in JSON format) and show the modal with the data.

```
$("#link").click(function(event) {
  event.preventDefault();

  //do an ajax call here and show modal
}); 
```

I suggest you check out these links:

[http://api.jquery.com/click/](http://api.jquery.com/click/)

[http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

[http://api.jquery.com/load/](http://api.jquery.com/load/)

..or you can check out this plugin, I haven't tried it myself but it looks really easy to use.

[https://github.com/kylefox/jquery-modal](https://github.com/kylefox/jquery-modal)

# c# - 是否有必要在 finally 块中处理数据集

> ID：11937786
> 
> 赞同：4
> 
> 时间：2012-08-13T15:47:33.953
> 
> 标签：c#, dataset, dispose

> **可能重复：**
> [我应该 Dispose() DataSet 和 DataTable 吗？](https://stackoverflow.com/questions/913228/should-i-dispose-dataset-and-datatable)

我在我的应用程序中使用 3 层架构，在 Datalayer 上我很简单地获取数据集

```
Dataset dset= new Dataset();

try 
{
    dset = SqlHelper.ExecuteDataset(Con, CommandType.StoredProcedure, "StoredProcedureName", arParms);
}
catch 
{}
finally 
{
    Con.Close();
    dset.Dispose()
} 
```

处理数据集对象是否有任何性能优势？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T15:51:43.780

如果一个对象实现了`IDisposable`，你应该处理它。

处理任何对象实现的最佳方法`IDisposable`是将创建包装在一个`using`语句中：

```
using(var dset = SqlHelper.ExecuteDataset(Con, CommandType.StoredProcedure, 
                                                 "StoredProcedureName", arParms))
{
} 
```

以上为创建的对象生成了正确的处置模式。使用这种模式是一个很好的经验法则——如果你一直这样做，你忘记处理重要东西的机会就会大大降低。

* * *

正如 Tim Schmelter[评论](https://stackoverflow.com/questions/11937786/is-it-necessary-to-dispose-dataset-in-finally-block/11937858#comment15901488_11937858)的那样，我没有解决性能问题。

在数据集的情况下，将没有性能优势，因为在构造函数中抑制了处置，如[对此 SO question](https://stackoverflow.com/questions/913228/should-i-dispose-dataset-and-datatable)的答案中所述。同时，调用 dispose 的开销是最小的。

我建议您针对您的特定用例测试这两种方法，看看哪一种性能更好，以及使用一种方法的好处是否值得缺点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:12:31.650

您应该处理和关闭具有 IDisposable 接口的连接/对象，因为您的程序将使用更少的资源和/或更快地释放它们，所以性能上最有好处。

您可以创建一个新的辅助函数来执行操作，这样您就不必在每次使用数据集时都考虑清理：

```
 public static void UseDataSet(Action<Dataset> code)
        {
            ...

            Dataset dset= new Dataset(); 

            try  
            { 
                dset = SqlHelper.ExecuteDataset(Con, CommandType.StoredProcedure, "StoredProcedureName", arParms); 
                code(dset);
            } 
            catch  
            {  } 
            finally  
            { 
               Con.Close(); 
               dset.Dispose() ;
            } 
        } 
```

要使用该功能：

```
 Helper.UseDataSet( (dataset) =>
 {
    //use data set here, it will be closed and disposed afterwards
    dataset.something

 }); 
```

# ruby-on-rails - 如何在 Ubuntu 11（在 VPS 服务器上）上使用 Apache2 安装Passenger 3.0.11？

> ID：11937795
> 
> 赞同：1
> 
> 时间：2012-08-13T15:48:01.313
> 
> 标签：ruby-on-rails, ubuntu, apache2, passenger, vps

寻求乘客安装方面的帮助。

我有预装了 Ubuntu 11 的 VPS。Rails (Rails 2) 应用程序和 gem 以及所有 rubies 都安装在用户下`xuser`，该用户也添加到 sudoers。

我已经成功安装了乘客 3.0.11`home/xuser/.rvm/gems/ruby-1.8.7-p370/gems/passenger-3.0.11`

但是，我需要将乘客与 Apache2 绑定，所以当我尝试这样做时：

```
passenger-install-apache2-module 
```

我被这条消息卡住了

```
[rake aborted! Command failed with status (1): [g++ -Iext -Iext/common -Iext/libev -fPIC -...] 
```

任何人都可以帮助并解释它是什么意思以及这个问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:26:17.387

尝试通过 'apt-get install libapache2-mod-passenger' 安装 apache 乘客模块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T21:07:30.670

我有同样的问题，但我可以修复将 ruby​​ 从 2.0.0-p645 升级到 2.2.2

# cakephp - CakePHP Ajax 表单 - 克隆表单字段

> ID：11937796
> 
> 赞同：0
> 
> 时间：2012-08-13T15:48:04.363
> 
> 标签：cakephp

使用蛋糕 2.2。我目前有一个表单（使用表单助手构建），允许用户添加费用报销。每项索赔都包含许多费用。因此，表单包含每个费用的一行以及一个按钮，该按钮使用 jQuery 克隆第一行字段并插入它们（带有递增的 ids/names）。问题是当表单提交并且出现错误时，克隆的字段会随着页面的刷新而消失（我猜是因为它们不再在 dom 中了）。

这些值仍在 $this->data 中，所以我想我可以手动重建它们，但如果我通过 ajax 提交表单，它会解决问题吗？IE 出错了，克隆的字段还会保留吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:55:20.320

从 Javascript 构建的东西不会从一个页面加载到下一个页面加载。

要么使用 Ajax（可能是理想的），要么根据提供的数据使用 PHP 构建字段。

无论哪种方式都是相当“正常”的方式。

# jsf - jsf2 f:selectItem itemLabel 复杂 i18n 渲染

> ID：11937797
> 
> 赞同：2
> 
> 时间：2012-08-13T15:48:09.740
> 
> 标签：jsf, internationalization, tags, el

我有 af:selectitem 及其 itemLabel，我想将标签渲染得如此“漂亮”！

问题：

```
<p:selectOneRadio id="selectRadio" value="#{somebean.somevalue}" layout="pageDirection" >
<f:selectItem itemLabel="#{msg['message.1']}" itemValue="1" />
<f:selectItem itemLabel="#{msg['message.2']}" itemValue="2" />
</p:selectOneRadio> 
```

我的属性 i18n 文件：

```
message.1=some message by {0}
message.2=another message by {0} 
```

我想用 #{somebean.theUser} 对 {0} 进行内联替换 结果应该是这样的（包括粗体）：

```
some message by <b>HUSTON</b> 
```

在标记文件中我应该做这样的事情（或以类似的方式）

```
<f:selectItem itemLabel="#{msg['message.1']{'<b>'+somebean.theUser+'</b>'}}" itemValue="1" /> 
```

换句话说，我想将 i18n 字符串参数替换直接添加到 itemLabel 标记中。

我试过了， `<f:facet name="itemLabel">`但没有。

有人可以帮助我吗？

谢谢指教，

阿格哈塔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T17:47:34.940

JSF 不会让您从标记方面这样做。例如，没有办法使用`<h:outputFormat />`它。

相反，您需要简单地创建一个 bean，它将从属性文件中读取内容并相应地格式化：

```
<p:selectOneRadio id="selectRadio" value="#{somebean.somevalue}" layout="pageDirection" >
<f:selectItem itemLabel="#{helperbean.someMessage}" itemValue="1" />
<f:selectItem itemLabel="#{helperbean.anotherMessage}" itemValue="2" />
</p:selectOneRadio> 
```

那是 JSF 的一部分，在你的 bean 中：

```
public String getSomeMessage() {
  // Actually you need some common access helper, it is just simplified example
  String messagePattern = null;
  try {
    ResourceBundle rb = ResourceBundle.getBundle("path/to/properties/file");
    String messagePattern = rb.getString("message.1");
    return MessageFormat.format(messagePattern, somebean.getTheUser());
  } catch (MissingResourceException mre) {
     logger.warn("Missing resource file or resource key", mre);
     return "!message.1!"; // That will show you where the problem is
  }
} 
```

关于可本地化的几点补充：

1.  请使用有意义的键名。像“message.1”这样的东西没有给翻译者提供上下文。我不知道你在做什么，但也许“some-module.select.message.radio.message.sent.by.pattern”会更好——译者需要知道 a) 它将在哪里显示， b) 该文本的目的是什么（是否是一些描述、消息模式、一般文本、窗口/对话框标题、按钮标题等）。一定要为他们提供这样的背景。

2.  确保在消息本身中**包含**格式标记。这意味着，消息应该类似于`message.1=some message by <b>{0}</b>`您的属性文件中的内容。您会惊讶于这些标签需要多久被删除（或用其他强调方式替换）。您应该特别小心，因为您似乎在使用 RTL 语言做一些事情，而粗体字体不能很好地使用它们。

# ruby-on-rails - Rails 回调在模型中更改

> ID：11937799
> 
> 赞同：0
> 
> 时间：2012-08-13T15:48:12.720
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

在这里我想验证我的模型中的属性是否发生了变化

模型柱

```
Customer
ID
First
Last
curr_gender 
```

模型

```
 before_update :gender_changed
    protected
    def gender_changed
      self.curr_gender.changed?
        #do code
    end 
```

但我猜是以下错误

```
NoMethodError in CustomersController#update

undefined method `changed?' for "2":String 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:49:42.800

我想这是`curr_gender_changed?`

# .htaccess - HTTPS 的替代品

> ID：11937808
> 
> 赞同：1
> 
> 时间：2012-08-13T15:48:51.490
> 
> 标签：.htaccess, authentication, encryption, https

当被要求研究对我公司的网站进行身份验证时，我最终使用了 htaccess 和 htpasswd。现在我被要求寻找更安全的解决方案。我被建议注意的一种情况是嗅探。我环顾四周，发现 HTTPS 似乎是我正在寻找的解决方案。

如果身份验证仅由我们的员工访问并允许他们访问数据库。这个数据库上的活动应该很轻。我的印象只是说......每个会话 5 个查询，检索到的数据也很轻量级。

从我读过的内容来看，似乎 HTTPS 是我应该押注在这里的。我在身份验证和加密方面的知识几乎为零，所以我想知道是否还有其他选项可以为我们的网站进行安全身份验证。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:49:39.167

HTTPS主要提供：

*   保密
*   正直
*   **服务器对客户端的**身份验证

 ***后者是防范中间人*攻击和冒充攻击的重要措施。想想有人冒充服务器并欺骗客户端提交密码等敏感数据。

请注意 - 为了工作 - 服务器必须具有由客户端浏览器识别的 CA 签名的 SSL 证书。这可以是由 Verisign 等商业 CA 获得的 SSL 证书，也可以是所有用户必须导入证书存储的自定义 SSL 证书。

最重要的是，HTTPS 可以保护您免受欺骗攻击，但前提是证书设置正确。不过，请务必禁用纯 HTTP，否则攻击者可能会尝试*降级*攻击。

使用 HTTPS，您可以使用多种方法中的任何一种来**向服务器验证客户端**，包括您现在使用的任何方法（我猜是 HTTP Basic 或 Digest）。其他选项包括 Kerberos、旧 NTLM、RADIUS 或客户端 SSL 证书。**

# c# - 使用 Telerik RadGrid 导出到 Excel 会添加一个空白行来代替过滤器行

> ID：11937811
> 
> 赞同：3
> 
> 时间：2012-08-13T15:49:00.283
> 
> 标签：c#, asp.net, telerik, telerik-grid

我正在使用打开了列过滤的 RadGrid。当我将数据导出到 Excel 时，我总是在数据的顶部和底部得到一个额外的行，这似乎是由于过滤器行。它出现在列标题和数据之间。有什么办法可以隐藏这个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T07:58:27.060

```
void Button1_Click(object sender, EventArgs e)
{
    exporting = true;
    RadGrid1.Rebind();
    RadGrid1.MasterTableView.ExportToExcel();
}

void RadGrid1_ItemCreated(object sender, Telerik.Web.UI.GridItemEventArgs e)
{
    if (exporting && e.Item.ItemType == Telerik.Web.UI.GridItemType.FilteringItem)
    {
        e.Item.Visible = false;
    }
} 
```

# php - PHP/JS 文本差异

> ID：11937813
> 
> 赞同：10
> 
> 时间：2012-08-13T15:49:23.047
> 
> 标签：php, javascript, jquery

首先，这是这四个问题的完全重复：

*   [突出PHP中两个字符串的区别](https://stackoverflow.com/questions/321294/highlight-the-difference-between-two-strings-in-php)
*   [基于 JavaScript 的 diff 实用程序](https://stackoverflow.com/questions/3053587/javascript-based-diff-utility)
*   [如何使用 PHP 进行文本 DIFF？](https://stackoverflow.com/questions/736771/how-to-do-text-diff-using-php)
*   [在 PHP 中计算文本差异](https://stackoverflow.com/questions/112523/calculate-text-diffs-in-php)

自从第一次提出这些问题以来，似乎时代已经发生了变化，我想知道现在有什么好的工具可以进行这种比较？我看过（除了这些问题）：

*   [https://github.com/nuxodin/diff_match_patch-php](https://github.com/nuxodin/diff_match_patch-php)
*   [http://pear.php.net/package/Text_Diff](http://pear.php.net/package/Text_Diff)
*   [https://github.com/paulgb/simplediff/blob/5bfe1d2a8f967c7901ace50f04ac2d9308ed3169/simplediff.php](https://github.com/paulgb/simplediff/blob/5bfe1d2a8f967c7901ace50f04ac2d9308ed3169/simplediff.php)
*   [http://www.raymondhill.net/finediff/viewdiff-ex.php](http://www.raymondhill.net/finediff/viewdiff-ex.php)

但是我得到的所有这些要么现在没有维护，要么看起来有点狡猾，因为它们没有被太多使用（有些甚至暗示它们的性能不是很好），而 PEAR 让我担心。我讨厌为一个小模块安装 PEAR 不仅如此，而且与一般的 PEAR 相比，它似乎是从我自己的窗口扔一块砖来为这么小的模块安装它，不仅如此，而且该模块已被取代并放置在一个不同的频道（不知道为什么？）。如果这是我唯一的选择，我会使用 PEAR 版本，但我想使用最新的包。

有谁知道 PHP 和/或 JavaScript（也包括 JQuery）的一个使用良好且当前维护或内置的函数（即使它是 PHP 扩展）文本差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T18:39:36.737

好的，已经有一段时间了。

实际上，我决定看看其他人使用什么，并偶然发现了 Yii ( [http://www.yiiframework.com](http://www.yiiframework.com) ) 使用什么。

他们实际上使用 PEAR 模块，`text_diff`并在部落频道上以新形式使用它。现在看起来它`text_diff`是一个部落项目，但你可以很容易地将它的一个版本集成到你的应用程序中，这就是 Yii 默认所做的（它预先捆绑了它的一个版本）。

所以我四处搜索以了解他们如何使用它以及如何进入它，我遇到了：

```
public function actionDiff()
{
    Yii::import('gii.components.TextDiff');

    $model=$this->prepare();
    if(isset($_GET['id']) && isset($model->files[$_GET['id']]))
    {
        $file=$model->files[$_GET['id']];
        if(!in_array($file->type,array('php', 'txt','js','css')))
            $diff=false;
        elseif($file->operation===CCodeFile::OP_OVERWRITE)
            $diff=TextDiff::compare(file_get_contents($file->path), $file->content);
        else
            $diff='';

        $this->renderPartial('/common/diff',array(
            'file'=>$file,
            'diff'=>$diff,
        ));
    }
    else
        throw new CHttpException(404,'Unable to find the code you requested.');
} 
```

在`CCodeGenerator`他们的 Gii 模块中（[http://www.yiiframework.com/doc/api/1.1/CCodeGenerator/](http://www.yiiframework.com/doc/api/1.1/CCodeGenerator/)）。重要的部分是它们实际连接到 PEAR 模块的位置：

```
$diff=TextDiff::compare(file_get_contents($file->path), $file->content); 
```

通过读入产生`diffed`输出的两个文件的内容。

最初我不想使用 PEAR，因为它太臃肿了，但是这个模块对于一个功能齐全的功能来说非常纤薄，`text_diff`所以我决定使用它。不仅如此，目前，它是唯一`text_diff`真正为我工作的模块，所以我坚持使用最好的模块，即使最好的模块非常消耗内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:53:13.027

您是否在[此线程](https://stackoverflow.com/questions/1209800/difference-between-two-strings-in-python-php)上尝试过 Philippe 的两种解决方案之一？

在此引用：

> 在 PHP 中。array_diff 将第一个数组与第二个数组进行比较并返回差值。
> 
> ```
> $a1 = str_split('abcdefghijklmnop');
> $a2 = str_split('abcdefghi');
> echo join('', array_diff($a1, $a2)); // jklmnop 
> ```
> 
> 这也将起作用：
> 
> ```
> $s1 = 'abcdefghijklmnop';
> $s2 = 'abcdefghi';
> echo str_replace(str_split($s2), '', $s1); // jklmnop 
> ```
> 
> 这也可以处理`$s2 = 'ghiabcdef';`，因为`str_replace()`输入的是数组，而不是字符串。

# javascript - jquery根据字符串大小调整li

> ID：11937818
> 
> 赞同：0
> 
> 时间：2012-08-13T15:49:36.620
> 
> 标签：javascript, jquery

我有一些查询将计算每个 li 的像素宽度。问题是它没有考虑 A href 中的字符数量。

您可能会得到“Cartouches/Réservoirs”，它会尝试根据其他项目的计算分配 124px 宽度。

我需要首先检查字符数是否适合分配的大小，如果它们不适合则通过从具有足够空间的 LI 中删除一些来增加大小。

```
$('div#new-menu-lower ul li').css('width', ($('div#new-menu-lower ul').width() / $('div#new-menu-lower ul li').length));
    $(function() {
        var menuWidth = $('div#new-menu-lower ul').width();
        var listItems = $('div#new-menu-lower > ul > li').length;
        var itemWidth = Math.floor(menuWidth * (1/listItems)) - 20;

    $('div#new-menu-lower ul li').css('width', itemWidth);
}); 
```

这是演示：http: [//jsfiddle.net/zwqYf/3/](http://jsfiddle.net/zwqYf/3/)

正如您在悬停时看到的那样，项目已损坏。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:59:21.940

我可以看到您正在尝试做什么，但是有一些方法可以更容易地完成您需要的操作，甚至不需要 javascript/jquery。

考虑一下：

[http://jsfiddle.net/zwqYf/4/](http://jsfiddle.net/zwqYf/4/)

*   删除了内联宽度样式。
*   将 position:relative 和 top:3 更改为 line-height
*   将 li 的填充更改为“unbunching”

如果您需要使它们更加分开，请更改 li 上的填充。

如果您需要更改按钮的高度，请不要忘记更改 a 的行高。

**编辑：**

[http://jsfiddle.net/zwqYf/5/](http://jsfiddle.net/zwqYf/5/) - 更新，删除了一些多余的 css，使 li 之间的填充更大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:48:24.077

见[http://jsfiddle.net/zwqYf/10/](http://jsfiddle.net/zwqYf/10/)：

我们得到`li`元素。

```
var els=$('div#new-menu-lower ul li'); 
```

我们存储每个`li`的宽度（包括边框、填充和边距）。

```
elsWidth=new Array();
for(var i=0;i<els.length;i++){
 elsWidth[i]=$(els[i]).outerWidth(true);  
} 
```

我们将它们总结为`total`

```
var total=0;
for(var i=0;i<elsWidth.length;i++){
 total+=elsWidth[i];  
} 
```

然后我们有一个`ul`其中`960px`必须至少包含`total`px。

那么，可用空间为`$('div#new-menu-lower ul').width()-total`。

所以每个都`li`可以有一个额外的宽度`($('div#new-menu-lower ul').width()-total)/(els.length)`。

```
var availWidthForEl=($('div#new-menu-lower ul').width()-total)/(els.length); 
```

我们将其四舍五入到小数点后两位

```
availWidthForEl=Math.floor(availWidthForEl*100)/100; 
```

最后，我们将`li`其当前的（不带边框、填充和边距）加上其额外宽度分配给每个：

```
for(var i=0;i<els.length;i++){
 $(els[i]).css('width', $(els[i]).width()+availWidthForEl);
} 
```

# sql - Crystal Reports 交叉表计算或动态列

> ID：11937831
> 
> 赞同：1
> 
> 时间：2012-08-13T15:50:10.223
> 
> 标签：sql, crystal-reports, crystal-reports-xi

我在sql中有以下数据。

```
Date |Customer|DespatchOrder|Value|ApprovedCredit
08/10|Axe     |AGB-01       |50   |200
08/12|Axe     |AGB-02       |75   |200
08/13|Axe     |AGB-03       |80   |200
08/15|Axe     |AGB-04       |10   |200
08/09|Vex     |VSE-01       |50   |150
08/10|Vex     |VSE-02       |60   |150
08/13|Vex     |VSE-03       |40   |150 
```

通过 sql 中的一些操作，我设法在水晶报表的交叉表中显示我的数据，如下例所示：

```
AXE
Date |ApprovedCredit|Total|AGB-01|AGB-02|AGB-03|AGB-04
08/09|200           |0    |0     |0     |0     |0
08/10|200           |50   |50    |0     |0     |0
08/11|200           |50   |50    |0     |0     |0
08/12|200           |125  |50    |75    |0     |0
08/13|200           |205  |50    |75    |80    |0
08/14|200           |205  |50    |75    |80    |0
08/15|200           |215  |50    |75    |80    |10

VEX
Date |ApprovedCredit|Total|VSE-01|VSE-02|VSE-03
08/09|120           |50   |50    |0     |0     
08/10|120           |110  |50    |60    |0     
08/11|120           |110  |50    |60    |0     
08/12|120           |110  |50    |60    |0     
08/13|120           |150  |50    |60    |40    
08/14|120           |150  |50    |60    |40    
08/15|120           |150  |50    |60    |40 
```

我遇到的问题是，我找不到在交叉表内计算我的超限列的方法，超限是由approvedcredit-Total（交叉表内的列）计算的

```
AXE
Date |ApprovedCredit|Total|OverLimit|AGB-01|AGB-02|AGB-03|AGB-04
08/09|200           |0    |0        |0     |0     |0     |0
08/10|200           |50   |0        |50    |0     |0     |0
08/11|200           |50   |0        |50    |0     |0     |0
08/12|200           |125  |0        |50    |75    |0     |0
08/13|200           |205  |5        |50    |75    |80    |0
08/14|200           |205  |5        |50    |75    |80    |0
08/15|200           |215  |15       |50    |75    |80    |10

VEX
Date |ApprovedCredit|Total|OverLimit|VSE-01|VSE-02|VSE-03
08/09|120           |50   |0        |50    |0     |0     
08/10|120           |110  |0        |50    |60    |0     
08/11|120           |110  |0        |50    |60    |0     
08/12|120           |110  |0        |50    |60    |0     
08/13|120           |150  |30       |50    |60    |40    
08/14|120           |150  |30       |50    |60    |40    
08/15|120           |150  |30       |50    |60    |40 
```

如果您知道如何执行此操作，请提供帮助，我尝试创建没有交叉表的报告，但使用动态列标题没有成功。由于此报告的动态性质，我想继续使用交叉表，有时可能会有超过 10 个 DespatchOrders，但如果无法使用交叉表执行此操作，请提供替代方案。

我发现使用带有值公式的计算成员在 Crystal Report 内创建超限列

```
ApprovedCredit - GridValueAt(CurrentRowIndex, 0 ,0) 
```

Crystal 报表现在支持 GridValueAt 函数 xi 也不是计算成员。只是另一堵砖墙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:52:39.660

如果您可以在上游计算您的上限值，则交叉表将很容易。如果您不能这样做，则需要将交叉表列和汇总字段值基于公式，而不是数据源中的实际字段。在您的公式中，您返回要在大多数列中显示的字段值，并计算要在超限列中显示的值。

# java - 使用控制台更改连接池

> ID：11937834
> 
> 赞同：1
> 
> 时间：2012-08-13T15:50:22.687
> 
> 标签：java, mongodb, console

我在 Java 项目中使用 MongoDB，我有一个问题要问你：

如何使用 mongodb 的控制台更改连接池？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T08:49:37.817

我在 MongoDB Google Group 上回答了这个问题，我将在这里重新引用：

```
You can control how many connections there are with the [MongoOptions class][1]:

The connection pool is controlled in the driver configuration, not through the mongo shell. 
```

# r - R：在对数 x 轴上绘制未转换的数据（类似于在对数坐标纸上绘制）

> ID：11937836
> 
> 赞同：1
> 
> 时间：2012-08-13T15:50:26.730
> 
> 标签：r, plot, logarithm

我有 3 组数据，我试图在一个图上绘制。第一个数据集的 x 值范围从 ~ 1 到 1700，而其他两个数据集的 x 值小于 20。因此我想将它们绘制在对数轴上以显示所有数据集的变化。但是我不想转换数据，因为我希望能够从图表中读取值。我想要的 x 轴标签是 1、10、100 和 1000，它们都是等距的。有谁知道如何做到这一点？我只能找到数据是日志以及轴的示例。我在下面附上了我目前使用的代码：提前感谢您提供的任何帮助。冬青

```
Stats_nineteen<-read.csv('C:/Users/Holly/Documents/Software Manuals/R Stuff/Stats_nineteen.csv')
attach(Stats_nineteen)
x<-Max
x1<-Min
x2<-Max
y1<-Depth
y2<-Depth
par(bg="white")
par(xlog=TRUE)
plot(x2,y1, type="n", ylim=c(555,0), log="x", axes=FALSE, ann=FALSE)
box()
axis(3, at=c(1,10,100,1000), label=c(1,10,100,1000), pos=0, cex.axis=0.6)
axis(1, at=c(1,10,100,1000), label=c(1,10,100,1000), cex.axis=0.6)
axis(2, at=c(600,550,500,450,400,350,300,250,200,150,100,50,0), label=c
(600,"",500,"",400,"",300,"",200,"",100,"",0), cex.axis=0.6)
mtext("CLAST SIZE / mm", side=3, line=1, cex=0.6, las=0, col="black")
mtext("DEPTH / m", side=2, line=2, cex=0.6, las=0, col="black")
grid(nx = NULL, ny = NULL, col = "lightgray", lty = "solid",
lwd = par("lwd"), equilogs = TRUE)
par(new=TRUE)
lines(x1,y1, col="black", lty="solid", lwd=1)
lines(x2,y2, col="black", lty="solid", lwd=1)
polygon(c(x1,rev(x2)), c(y1,rev(y2)), col="grey", border="black")
par(new=TRUE)
plot(x=Average,y=Depth, type="o",
bg="red", cex=0.5, pch=21,
col="red", lty="solid",
axes=FALSE, xlim=c(0,1670), ylim=c(555,0),
ylab = "",xlab = "")
par(new=TRUE)
plot(x=Mode,y=Depth, type="o",
bg="blue", cex=0.5, pch=21,
col="blue", lty="solid",
axes=FALSE, xlim=c(0,1670), ylim=c(555,0),
ylab = "",xlab = "") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T16:51:43.067

您可以在 ggplot 中使用`scale_x_log`

所以像：

```
myplot <- ggplot( StatsNinetee, 
                  aes (x = myResponse,
                       y = myPredictor,
                       groups = myGroupingVariable) ) +
          geom_point() +
          scale_x_log()
myplot 
```

另外，避免`attach()`它会产生奇怪的行为。

# ruby-on-rails - 如何使 Rails 关系可访问？

> ID：11937838
> 
> 赞同：3
> 
> 时间：2012-08-13T15:50:29.883
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

我已经写 Rails 几年了，和之间的区别`attr_accessible :person`真的`attr_accessible :person_id`让我很烦。

`attr_accessible :person`处理表单数据很烦人，尤其是选择助手，需要访问`f.select :person_id...`

`attr_accessible :person_id`: 让设置 AR finder 结果变得更加冗长，比如`User.person_id = Person.create!(name: "Hugh").id`

我不太介意，但两者都使用似乎应该是不必要的。我也从未真正在其他人的代码中看到过偏好。我应该遵循这里的约定吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T15:54:43.250

据我所知，使用`attr_accessible :person_id`. 模型对象将自动转换为 id，因此您应该能够编写如下内容：`User.first.person_id = Person.create!(name: "Hugh")`甚至更短：`User.first.person.create!(name: "Hugh")`

# deployment - 从不同的文件夹运行 ant exec 任务

> ID：11937839
> 
> 赞同：15
> 
> 时间：2012-08-13T15:50:30.287
> 
> 标签：deployment, ant, build, continuous-integration

我想将我的“exec grails”任务运行到我的 grails 项目中。我在 exec 任务中设置了圣杯路径，例如

```
 <exec executable="${grails}" 
```

我怎么说，那个 exec 应该从我的项目文件夹开始？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-13T17:12:00.543

来自[`exec`Ant 任务文档](http://ant.apache.org/manual/Tasks/exec.html)：

```
属性    说明
dir 应该在其中执行命令的目录。

```

```
<exec executable="${grails}" dir="${my.project.dir}"> 
```

# jquery - 使用 jquery .css 修改的元素样式未在 Chrome 上刷新

> ID：11937843
> 
> 赞同：5
> 
> 时间：2012-08-13T15:50:51.457
> 
> 标签：jquery, css, select, width

当发生 onchange 事件时，我正在使用 .css 更新选择元素的宽度。在 HTML 中：

```
<select name="city_search" id="city_search" onchange='resetDropDown("#state_search");'>
<select name="state_search" id="state_search" onchange='resetDropDown("#city_search");'> 
```

在 JS 中

```
function resetDropDown(elementObj)
{
    var selectBoxWidth = $(elementObj).attr('id') == 'college_search' ? 143 : 113;
    $(elementObj).css({width:selectBoxWidth});
} 
```

由于某种原因，属性宽度已正确更改，但 chrome 在检查元素或刷新页面之前不会显示更改。有没有办法强制 chrome 显示应用于元素样式的更改？

提前致谢。伊丽莎白

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T16:03:13.777

这个问题可以通过强制 webkit 重绘/重绘样式更改来解决。你可以参考这个答案：[https ://stackoverflow.com/a/3485654/567101](https://stackoverflow.com/a/3485654/567101)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-01T21:35:45.080

非常简单的解决方案对我有用。尝试更改`$(document).ready`为`$(window).load`

问题可能在于准备好文件。如果函数在 Windows 加载后运行，那么它可能会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:02:17.783

OnChange 事件仅在对象更改和失去焦点时触发。您可以使用一些解决方法，例如对文本输入使用 keyup 事件或对复选框使用单击事件。根据选择更改的上下文，您可能需要手动触发更改事件。如果当用户选择不同的选项时您的选择元素发生变化，我建议 onclick 而不是 onchange 应该适合您。

# c++ - 将元数据添加到 Qt 属性

> ID：11937844
> 
> 赞同：2
> 
> 时间：2012-08-13T15:50:52.643
> 
> 标签：c++, qt, metadata

我正在开发一个在`QGraphicsScene`. 这些项目具有属性，如果选择了该项目，我想在树视图中显示这些属性。如果可能的话，我想坚持使用`QObject`. 但是，这并不适合我的所有需求，因为我需要沿属性存储一些元数据，例如

*   用于分组的类别（例如“系统属性”和“用户属性”）
*   当鼠标悬停在树视图中的属性上时显示的工具提示文本。

受[Qt 属性浏览器](http://doc.trolltech.com/solutions/4/qtpropertybrowser/index.html)和 Qt 的对象框架的启发，我想实现以下系统：

1.  场景中的所有项目都派生自`PropertyItem`（它本身继承 `QGraphicsItem`或`QGraphicsObject`）。它包含获取和设置属性值的逻辑。
2.  每个派生的类`PropertyItem`都有一个 static `MetaPropertyItem`。
3.  A`MetaPropertyItem`持有类`MetaProperty`的实例，以便存储有关属性的元数据，例如类别、工具提示字符串和属性的类型。
4.  每当在场景中选择一个项目时，`Property`都会为每个`MetaProperty`关联的`MetaPropertyItem`. 然后，这些属性会显示在树视图中，并在取消选择该项目时将其删除。

我越想这个设计，就越觉得我做错了什么。看来我只是在复制已经是 Qt 一部分的内容：

```
PropertyItem     <--> QObject
MetaPropertyItem <--> QMetaObject
MetaProperty     <--> QMetaProperty
Property         <--> needs to be implemented 
```

我还发现了这个[bug ticket](https://bugreports.qt-project.org/browse/QTBUG-17301)，它建议将元数据添加到 Qt 属性。不幸的是，到目前为止，它没有引起任何关注。

在寻找替代方案时，我还偶然发现了`QMetaPropertyBuilder`哪个（可能？）将成为 Qt 5 的一部分。不幸的是，关于这个类的文档很少，而且我从阅读源代码中了解到的内容并不能解决我的问题。

**因此，我的问题**是：实际上是否有更好的方法可以在不重新实现另一个 Qt 框架的情况下实现我正在寻找的东西？

# iphone - 在 App 处于后台时保持 UIWebView 播放音乐

> ID：11937845
> 
> 赞同：1
> 
> 时间：2012-08-13T15:50:53.370
> 
> 标签：iphone, xcode, uiwebview

我认为一切都在标题中。

我有一个播放音乐的 UIWebiew，当用户使用电源或主页按钮时，将应用程序置于后台，我希望音乐继续播放。

可能吗 ？

谢谢您的帮助 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T01:39:23.740

您实际上无法使用 UIWebView 执行此操作，但您仍然可以执行此操作。此方法仍通过 URL 从在线资源流式传输音频。这里有一些代码可以帮助你。现在，假设您想在应用程序退出视频时流式传输音频，那么它非常相似，但使用 MediaPlayer 框架而不是 AVAudioPlayer 框架。

```
NSURL *url = [NSURL URLWithString:@"http://website.com/audio.mp3"];

NSData *data = [NSData dataWithContentsOfURL:url];

AVAudioPlayer *audioPlayer = [[AVAudioPlayer alloc] initWithData:data error:nil];

[audioPlayer play]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-24T03:59:20.257

有点棘手，但这是可能的。来自下面的官方 Apple 文档：

[https://developer.apple.com/library/ios/qa/qa1668/_index.html](https://developer.apple.com/library/ios/qa/qa1668/_index.html)

您需要首先在您的 plist 中声明`UIBackgroundModes`for `audio`，然后在您的`AppDelegate`

```
#import <AVFoundation/AVFoundation.h>
#import <AudioToolbox/AudioToolbox.h>

AVAudioSession *audioSession = [AVAudioSession sharedInstance];

NSError *setCategoryError = nil;
BOOL success = [audioSession setCategory:AVAudioSessionCategoryPlayback error:&setCategoryError];
if (!success) { /* handle the error condition */ }

NSError *activationError = nil;
success = [audioSession setActive:YES error:&activationError];
if (!success) { /* handle the error condition */ } 
```

现在，当您从 UIWebView 播放音频时，您可以转到主屏幕，切换到另一个应用程序，或锁定屏幕，音频将继续播放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T16:20:57.820

我不相信这是可能的，即使在查看`UIWebView`了 的文档后，我也只发现了以下三个与媒体播放相关的属性。

```
 allowsInlineMediaPlayback  property
  mediaPlaybackRequiresUserAction  property
  mediaPlaybackAllowsAirPlay  property 
```

不幸的是，他们都没有这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-15T07:13:57.660

对的，这是可能的。你需要做：

1.  激活播放会话：

`@import AVFoundation; [[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: nil];`

2.  在 Info.plist 中添加音频背景模式：

所需的背景模式：应用程序使用 AirPlay 播放音频或流式传输音频/视频

`<key>UIBackgroundModes</key> <array> <string>audio</string> </array>`

# jsf - JSF 1.2 Impl - 自定义组件问题 - WebSphere v7.0，从 v6.1 迁移，数组索引超出范围：12

> ID：11937846
> 
> 赞同：1
> 
> 时间：2012-08-13T15:50:58.037
> 
> 标签：jsf, migration, custom-component, jsf-1.2, websphere-7

我们在将我们的一个应用程序从 WebSphere 6.1 (JSF 1.1 Impl) 迁移到 WebSphere 7.0（JSF 1.2 Impl，Sun Impl [v7.0 中的默认值]）时遇到了 JSF 问题。该应用程序使用一个 IBM jar，IBM 告诉我它是一个提供自定义 IBM JSF 功能和标签等的小部件 (jsf-ibm.jar)，我们认为这是 JSF 1.2 Impl 支持所需的版本。

当我们点击应用程序时，我们会在具有支持 UI 类的自定义组件周围收到错误。该应用程序在我们最初访问时加载正常，但是当我们点击控件上的任何按钮或其他任何地方时，我们会收到以下异常（如下）。自定义组件是一个分页控件，添加到页面中如下：

```
<appname:dataTableNav id="navTable1" dataComponent="#{appSession.cLog.cLogLine}" pageSize="#{appSession.cLogPreferences.pageSize}" startingIndex="#{appSession.caseLog.cLogPref.startingIndex}" actionListener="#{pc_Log.handleSelectedPageEvent}" backImage="images/arrow_previous.gif"forwardImage="images/arrow_next.gif" pageStyleClass="resultlinks" currentPageStyleClass="selectedPage"/> 
```

IBM 建议的问题是 JSF 1.2 Impl 在呈现自定义控件时遇到问题，因为 JSF 1.1 在保存/序列化自定义控件状态等并再次呈现时的行为与 1.2 不同。他们建议我们在我添加的支持 UI 类中缺少 saveState 和 restoreState 方法，但没有成功，即下面的代码片段和代码参考 url：

```
 ** Ref url:
    http://blog.evolutionarydawn.com/2009/06/11/custom-jsf-component-12/

    ** Our code snippet:
    public Object saveState(FacesContext context) {
        System.out.println("Out .. In DataTableNavigatorUI.saveState-Begin!");

        Object values[] = new Object[5];
        values[0] = super.saveState(context);

        values[1] = forwardImage;
        values[2] = backImage;
        values[3] = pageStyleClass;
        values[4] = currentPageStyleClass;

        System.out.println("Out .. In DataTableNavigatorUI.saveState-Exit!");
        return ((Object) (values));
    }

    public void restoreState(FacesContext context, Object state) {
        System.out.println("Out .. In DataTableNavigatorUI.restoreState-Begin!");

        Object values[] = (Object[])state;
        super.restoreState(context, values[0]);

        forwardImage = (String) values[1];
        backImage = (String) values[2];
        pageStyleClass = (String) values[3];
        currentPageStyleClass = (String) values[4];

        System.out.println("Out .. In DataTableNavigatorUI.restoreState-Exit!");
    } 
```

来自 IBM 支持：

> 组件类缺少 saveState 和 restoreState 方法。这将导致此自定义组件的状态无法保存和恢复，我认为这会导致 ArrayIndexOutOfBoundsException。

我可以看到这段代码在调试和通过日志记录时被调用，并且可以在调用时调试每个方法，并且可以检查被捕获和恢复的值（当我通过调试检查时）。

正如您从下面的堆栈跟踪中看到的那样，应用程序似乎在 JSF 框架代码中崩溃了，所以不确定我们是否需要根据框架的需要来修改我们的代码！？

所以我们完全不知所措，因此欢迎任何想法、解决方案或反馈。

谢谢和问候，斯蒂芬

**异常堆栈跟踪：** [8/13/12 15:01:24:101 BST] 00000029 servlet E com.ibm.ws.webcontainer.servlet.ServletWrapper 服务 SRVE0068E：在应用程序 spocs-中的 servlet Faces Servlet 的服务方法之一中创建了未捕获的异常耳朵。异常创建：javax.servlet.ServletException：数组索引超出范围：com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper. java:1663) 在 com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1597) 在 com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:131) 在 com.ourapp .ourapp2.ourapp3.web.filter.LogonFilter.doFilter(LogonFilter.java:173) 在 com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188) 在 com.ibm.ws。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T01:12:45.423

您是否使用 Rational Application Developer 来开发您的 JSF 应用程序？你用的是什么版本的`jsf-ibm.jar`？查看 JAR 的清单文件。RAD 8.0.4.1 中包含的 JWL 实现修复了一个展示类似行为的错误，因此如果您使用 RAD 8.0.4 或更低版本创建 JSF 应用程序，您可能希望迁移到 8.0.4.1 并更新 JWL 库.

# ios - iOS中不可见的pdf文本

> ID：11937848
> 
> 赞同：1
> 
> 时间：2012-08-13T15:51:06.853
> 
> 标签：ios, pdf-generation

我想将不可见的文本插入到 iOS 中生成的 pdf 中。如何才能做到这一点？

这就是我目前生成 PDF 的方式：

```
- (void) generatePdfWithFilePath: (NSString *)thefilePath words:(NSString *)string
{
    UIGraphicsBeginPDFContextToFile(thefilePath, CGRectZero, nil);

    UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);

    [self drawText:string];

    // Close the PDF context and write the contents out.
    UIGraphicsEndPDFContext();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:50:34.517

*在 PDF 源代码中，可以使用文本渲染模式 3*（“既不填充也不描边字形”）编写不可见文本。这就是 OCR 将其文本插入基本上仅包含扫描图像的 PDF 页面的方式：

```
3 Tr 
```

其他文本渲染模式在 PDF 源代码中表示如下：

*   `0 Tr` （填写文字）
*   `1 Tr` （笔画文字）
*   `2 Tr` （填充，然后描边文本）
*   `4 Tr` （填充文本并添加到剪切路径）
*   `5 Tr` （描边文本并添加到剪切路径）

不过，您必须自己找出如何指示您的 PDF 生成库使用文本渲染模式 3。

另请参阅此答案（在超级用户上）：[**“通过 Ghostscript 运行后，PDF 在所有单词中都有一个额外的空白”**](https://superuser.com/a/285688/40894)

**注意：**这个“不可见”的文本仍然可以选择；用户仍然可以复制'n'粘贴它；屏幕阅读器可以大声朗读；文本提取工具可以提取它；`pdftotext`可以转换成文本文件...

# java - 如何减少失败的数据库连接的挂起时间

> ID：11937851
> 
> 赞同：1
> 
> 时间：2012-08-13T15:51:19.630
> 
> 标签：java, sql-server, hibernate

我有一个使用 Hibernate 连接到 MSSQL 2005 数据库的 Java Web 应用程序。

由于从我的应用程序到数据库的连接并不重要，我想测试当数据库不可用时应用程序的行为。

当我停止 SQL 服务并运行在数据库上运行查询的 Web 应用程序的一部分时，我的应用程序挂起大约 30 秒，然后继续正常运行。

正如预期的那样，日志中的错误是：

```
2012-08-13 16:33:04,974 WARN  [JDBCExceptionReporter] SQL Error: 0, SQLState: 08S01
2012-08-13 16:33:04,974 ERROR [JDBCExceptionReporter] The TCP/IP connection to the host bonnie.uk, port 1433 has failed. Error: "Connection refused. Verify the connection properties, check that an instance of SQL Server is running on the host and accepting TCP/IP connections at the port, and that no firewall is blocking TCP connections to the port.". 
```

有谁知道我可以如何减少应用程序的挂起时间？

谢谢

肖

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:28:48.153

正如您提到它是一个 Web 应用程序，我想您使用的是容器（Tomcat、JBoss AS、...）提供的数据源，对吗？正确的？？:-)

如果是这种情况，那么您的容器肯定有办法配置它。对于 JBoss AS，这将是“blocking-timeout-millis”。

# delphi - Eurekalog：将异常堆栈跟踪保存到日志文件中

> ID：11937853
> 
> 赞同：5
> 
> 时间：2012-08-13T15:51:26.153
> 
> 标签：delphi, error-handling, delphi-7

我正在使用德尔福 7。

我需要将发生的任何**异常的完整信息****记录到文件**中。

 **通常我使用 Eurekalog。这个出色的产品显示了一个包含所有堆栈跟踪信息和许多其他用于调试目的的对话框。

我需要访问 Eureka 日志给我的这些信息（实际上我只需要堆栈跟踪），因为我需要将它们发送到 syslog 守护进程中。**有没有办法以编程**方式访问 Eureka 日志中的信息？

我可以使用裸露的 delphi 7 或**Eurekalog** 6.1

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T17:21:51.060

处理[`OnExceptionNotify`](http://www.eurekalog.com/help/eurekalog/topic_type_eevents_televexceptionnotifymeth.php)事件。在您的事件处理程序中，对属性执行任何您想要的操作[`AExceptionInfo.CallStack`](http://www.eurekalog.com/help/eurekalog/topic_property_eexception_teurekaexceptioninfo_callstack.php)，例如将其保存到磁盘或将其发送到其他进程。请注意，默认情况下，EurekaLog 已经将错误报告保存到磁盘，因此，如果您只想这样做，则不需要任何特殊代码。

用于[`RegisterEventExceptionNotify`](http://www.eurekalog.com/help/eurekalog/topic_function_eevents_registereventexceptionnotify.php)注册您的事件处理程序，或使用[`TEurekaLogV7`](http://www.eurekalog.com/help/eurekalog/topic_class_ecomponent_teurekalogv7.php)组件。有关处理 EurekaLog 事件的详细信息和一般信息，请参阅[EEvents 单元的文档](http://www.eurekalog.com/help/eurekalog/topic_unit_eevents.php)。

`OnExceptionNotify`发生未处理的异常。如果您想收到*任何*异常的通知，包括最终在您的程序中处理的异常，那么您应该使用该[`OnRaise`](http://www.eurekalog.com/help/eurekalog/topic_type_eevents_televraisemeth.php)事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:16:48.080

大多数人只是简单地使用 JCL Debug。

关于 TSynlog 的讨论 [http://blog.synopse.info/post/2011/04/14/Enhanced-logging-in-SynCommons](http://blog.synopse.info/post/2011/04/14/Enhanced-logging-in-SynCommons)

或 Hallvard Vassbotn [http://hallvards.blogspot.co.at/2008/03/tdm9-exceptional-stack-tracing-hvest.html](http://hallvards.blogspot.co.at/2008/03/tdm9-exceptional-stack-tracing-hvest.html)**

# php - Javascript 从 php 变量定义 getElementById()？

> ID：11937857
> 
> 赞同：0
> 
> 时间：2012-08-13T15:51:42.127
> 
> 标签：php, javascript, variables, loops

我有一个正在尝试更新的运输模块。我希望能够为我的 php 表单/表格中的每个行项目添加行。最终发生的是根据需要为每个行项目显示添加/删除行按钮，但仅影响第一个行项目。如果我在行项目 1 中添加一行，它会正确添加一行。但是，如果我为订单项 2 添加一行，它实际上也为订单项 1 添加了一行。如果我尝试为行项目 3 添加一行，它会再次为项目 1 添加一行。我希望能够为每个项目添加行。

我在 php 中有一个调用 javascript 函数的 while 循环。问题是 javascript 中的变量之一需要一个 ID。尽管经历了我的循环，但 ID 永远不会改变，因此我的 javascript 仅适用于不是我想要的输出的单个循环。我在想如果我可以让 javascript 从 PHP 接收一个包含我的 ID 的变量，我可以让 javascript 在每次通过我的循环时运行。

这是我的javascript：

```
 <SCRIPT language="javascript">
      // Last updated 2006-02-21
function addRowToTable()
{
  var tbl = document.getElementById('tblSample');
  var lastRow = tbl.rows.length;
  // if there's no header row in the table, then iteration = lastRow + 1
  var iteration = lastRow + 1;
  var row = tbl.insertRow(lastRow);

  // Item cell
  var cellLeft = row.insertCell(0);
  var textNode = document.createTextNode(iteration);
  cellLeft.appendChild(textNode);

  // Cust PN cell
  var cellBox_Num = row.insertCell(1);
  var el = document.createElement('input');
  el.type = 'text';
  el.name = 'Box_Num[]';
  el.id = 'Box_Num' + iteration;
  el.size = 18;

  el.onkeypress = keyPressTest;
  cellBox_Num.appendChild(el);
}
function keyPressTest(e, obj)
{
  var validateChkb = document.getElementById('chkValidateOnKeyPress');
  if (validateChkb.checked) {
    var displayObj = document.getElementById('spanOutput');
    var key;
    if(window.event) {
      key = window.event.keyCode; 
    }
    else if(e.which) {
      key = e.which;
    }
    var objId;
    if (obj != null) {
      objId = obj.id;
    } else {
      objId = this.id;
    }
    displayObj.innerHTML = objId + ' : ' + String.fromCharCode(key);
  }
}
function removeRowFromTable()
{
  var tbl = document.getElementById('tblSample');
  var lastRow = tbl.rows.length;
  if (lastRow > 1) tbl.deleteRow(lastRow - 1);
}

    </SCRIPT> 
```

这是我的循环：

```
<?php

$i=0;
$n=1;

while($i < $num1) {

$SO_Line_Item=mysql_result($result1,$i,"SO_Line_Item");
$Cust_PN=mysql_result($result1,$i,"Cust_PN");
$Cust_PN_Rev=mysql_result($result1,$i,"Cust_PN_Rev");
$Description=mysql_result($result1,$i,"Description");
$SOItemQty=mysql_result($result1,$i,"Qty");
$UOM=mysql_result($result1,$i,"UOM");
$Program=mysql_result($result1,$i,"Program");
$Required_Date=mysql_result($result1,$i,"Required_Date");   
$SOItemShipQty=mysql_result($result2,$i,"count(E9_SN)"); 

?>
<tr>
<td width="3px" valign="top" align="center"><?php
echo "$SO_Line_Item";?>
</td>
<td nowrap="nowrap" valign="top" align="center"><?php
echo "$Cust_PN - $Cust_PN_Rev";?>
</td>
<td nowrap="nowrap" valign="top" align="center"><?php
echo "$Description";?>
</td>
<td nowrap="nowrap" valign="top" align="center">
<?php
echo "$SOItemQty";?>
</td>
<td nowrap="nowrap" valign="top" align="center">
<?php
echo "$UOM";?>
</td>
<td nowrap="nowrap" valign="top" align="center">
<?php
echo $SOItemQty - $SOItemShipQty;?>
</td>
<td nowrap="nowrap" valign="top" align="center">
<input size="2" align="right" type="text" name="Qty">
</td>
<td nowrap="nowrap" valign="top" align="center">
<?php
echo "$Required_Date";?>
</td>
<td nowrap="nowrap" valign="top" align="center">
<?php
echo "$Program";?>
</td>
</tr>

//HERE IS WHERE THINGS GO SOUTH.  I'd LIKE TO BE ABLE TO ADD A LINE FOR EACH PART 
//NUMBER... WHAT HAPPENS IS THIS IS ALWAYS RUN FOR THE SAME ID AND WHILE THE FORM 
//DISPLAYS PROPERLY THE ADD AND DELETE ALWAYS MODIFY THE FIRST PART

<tr>
<td colspan="10">
<p>
<input type="button" value="Add" onclick="addRowToTable();" />
<input type="button" value="Remove" onclick="removeRowFromTable();" />
<!-- 
<input type="button" value="Submit" onclick="validateRow(this.form);" />
<input type="checkbox" id="chkValidate" /> Validate Submit  
-->
<b><font color="RED">Add/Remove Box Number For This Line Item</font></b>
</p>
</td>
</tr>

<tr>
<td></td>
<td>
<table id="tblSample">
<tr>
    <td>1</td>
    <td><input type="text" name="Box_Num[]"
     id="Box_Num1" size="18" onkeypress="keyPressTest(event, this);" /></td>

  </tr>
</table>
</td>
</tr>
<?php

$i++;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:41:36.717

只需将表 id 传递到您的行添加和删除 javascript 函数中。您可以将这两个函数的第一行更改为如下所示：

```
function addRowToTable(tableID)
{
    var tbl = document.getElementById('tblSample_' + tableID);
    ...
} 
```

您还可以使用您的 PHP 计数器将表计数器值传递给这样的 javascript 函数

```
<input type="button" value="Add" onclick="addRowToTable('<?php echo $i; ?>');" />
<input type="button" value="Remove" onclick="removeRowFromTable('<?php echo $i; ?>');" /> 
```

并将计数器添加到表 id 中，如下所示。

```
<table id="tblSample_<?php echo $i; ?>"> 
```

# javascript - 有状态的单例模块

> ID：11937859
> 
> 赞同：0
> 
> 时间：2012-08-13T15:51:44.297
> 
> 标签：javascript, node.js, commonjs

你能有一个有状态的 Node.js 模块吗？像：

```
exports.connectionsCache = new (function () {
    var cache = {};

    this.getOrCreate = function (url) {
        if (!cache[url]) {
            cache[url] = new Connection(url);
        }
        return cache[url];
    };
}()); 
```

国家会在多次`require`通话中幸存下来吗？还是应该为此使用一个简单的全局对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T15:55:49.723

`require`已经缓存了模块：

test2.js：

```
module.exports = {
    state: 0
}; 
```

测试.js

```
var state = require("./test2.js");

state.state = 3;

console.log(state.state);

var state2 = require("./test2.js");

console.log(state2.state);

state2.state = 4;

console.log(state.state); 
```

输出

```
$ node test.js
3
3
4 
```

# c++ - QT C++ 框架 QlistwidgetItem 转换

> ID：11937860
> 
> 赞同：-2
> 
> 时间：2012-08-13T15:51:47.277
> 
> 标签：c++, qt

我有一个列表，您可以自己填写它`QfileDialog`并将选定的文件放在一个小部件列表中。

我可以访问列表并为所有这些项目着色并做任何我想做的事情，除了这个问题：

我想从列表中选择一项并以某种方式将其转换为，`QStringList`以便我可以将其用作 Phonon MediaSource。

我不知道如何提取这个项目，我想要显示的文本`ListWidget`并将其放入我的`mediaObj`，以便我可以播放它。

这是我的一些代码：

我如何打开 FileDialog（有效）：

```
 QStringList fileNames;
QFileDialog fDialog(this);
fDialog.setFileMode(QFileDialog::AnyFile);
fDialog.setNameFilter(tr("Music(*.mp3)"));
fDialog.setViewMode(QFileDialog::Detail);

while (true) {
    if (fDialog.exec()) {
        fileNames = fDialog.selectedFiles();
        widget.list->addItems(fileNames);
        musicObj->enqueue(fileNames.last());
    } else {
        break;
    }
} 
```

我如何访问列表中单击的一项：

```
 QListWidgetItem *list_itm = widget.list->currentItem();
 list_itm->setTextColor(Qt::red); 
```

但我可以提取光标位置上显示的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:10:08.603

```
QListWidgetItem *list_itm = widget.list->currentItem();
list_itm->setTextColor(Qt::red);

QStringList list;
list << list_itm.text(); 
```

除非我误解了，否则您只需要一个`QStringList`包含单个项目的当前小部件项目。

# javascript - 点击 Html5 画布图像

> ID：11937862
> 
> 赞同：1
> 
> 时间：2012-08-13T15:51:53.370
> 
> 标签：javascript, html, canvas

我的代码有问题。我在圆形路径上画了一些圆圈，我希望什么时候点击它们会在萤火虫控制台中返回 0 以外的东西，但这并没有发生；我不知道我的代码有什么问题，我希望有人能告诉我。这是我的代码：

```
 var canvas, ctx;
  var circle_data = [];

  function circles(x, y, radius) {
      this.x = x;
      this.y = y;
      this.radius = radius;
      circle_data.push(this);
  }
  circles.prototype = {
      draw: function (context) {
          context.beginPath();
          context.arc(this.x, this.y, this.radius / 5, 0, 2 * Math.PI, false);
          context.fillStyle = "red";
          context.fill();
      }
  }
  function draw() {
      ctx.translate(250, 250);
      for (var n = 0; n < 10; n++) {
          var radi = (Math.PI / 180);
          var x = Math.sin(radi * n * 36) * 70;
          var y = Math.cos(radi * n * 36) * 70;
          var radius = 50;
          var thiscircle = new circles(x, y, radius);
          thiscircle.draw(ctx);
      }
  }
  function mouseDown(e) {
      var img_data = ctx.getImageData(e.pageX, e.pageY, 1, 1);
      console.log(img_data.data[3]);
  }

  function init() {
      canvas = document.getElementById('canvas'),
      ctx = canvas.getContext('2d');
      canvas.addEventListener('mousedown', mouseDown, false);
  } 
```

## 在里面（）;

没关系我使用数据[3]；我试过了 console.log(img_data.data[0]+" "+img_data.data[1]+" "+img_data.data[2]); 仍然得到 0 0 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:01:51.367

您检测鼠标相对于页面而不是画布的位置，您需要获取画布在页面上的位置，然后从鼠标的 X 和 Y 中减去该位置，以找到您相对于画布的位置。在使用画布时，我使用类似于以下功能的功能。

```
getOffsetPosition = function(obj){
            /*obj is the Canvas element*/ 
        var offsetX = offsetY = 0;

        if (obj.offsetParent) {
            do {
                offsetX += obj.offsetLeft;
                offsetY += obj.offsetTop;
            }while(obj = obj.offsetParent);
        }   
        return [offsetX,offsetY];
    }

getMouse = function(e,canvasElement){
        OFFSET = getOffsetPosition(canvasElement);

        mouse_x = (e.pageX || (e.clientX + document.body.scrollLeft +  document.documentElement.scrollLeft)) - OFFSET[0];
        mouse_y = (e.pageY || (e.clientY + document.body.scrollTop + document.documentElement.scrollTop)) - OFFSET[1];  

        return [mouse_x,mouse_y];
    } 
```

以下代码有效。

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
<canvas id="canvas" width="500" height="500" style="background-color:#999999;"></canvas>
</body>
<script>
var canvas,ctx;

var circle_data = [];
function circles(x,y,radius)
{
this.x = x;
this.y = y;
this.radius = radius;
circle_data.push(this);

}

circles.prototype = {

draw: function(context){

context.beginPath();
context.arc(this.x, this.y, this.radius / 5, 0, 2* Math.PI, false);
context.fillStyle = "red";
context.fill();

}
}

getOffsetPosition = function(obj){
/*obj is the Canvas element*/ 
var offsetX = offsetY = 0;

if (obj.offsetParent) {
do {
offsetX += obj.offsetLeft;
offsetY += obj.offsetTop;
}while(obj = obj.offsetParent);
}   
return [offsetX,offsetY];
}

getMouse = function(e,canvasElement){
OFFSET = getOffsetPosition(canvasElement);

mouse_x = (e.pageX || (e.clientX + document.body.scrollLeft +  document.documentElement.scrollLeft)) - OFFSET[0];
mouse_y = (e.pageY || (e.clientY + document.body.scrollTop + document.documentElement.scrollTop)) - OFFSET[1];  

return [mouse_x,mouse_y];
}

function draw(){

ctx.translate(250, 250);
for (var n = 0; n < 10; n++) {
var radi = (Math.PI/180);
var x = Math.sin(radi*n*36)*70;
var y = Math.cos(radi*n*36)*70;
var radius = 50;
var thiscircle = new circles(x,y,radius);
thiscircle.draw(ctx);
}

}

function mouseDown(e)
{

var pos = getMouse(e,ctx.canvas);
var img_data = ctx.getImageData(pos[0],pos[1],1,1);

console.log(img_data.data[3]);

}

function init() {

canvas = document.getElementById('canvas'),
ctx = canvas.getContext('2d');
draw();

canvas.addEventListener('mousedown', mouseDown, false);

}

init();

</script>
</html> 
```

# vb.net - 使用模型的下拉列表

> ID：11937864
> 
> 赞同：1
> 
> 时间：2012-08-13T15:51:56.747
> 
> 标签：vb.net, asp.net-mvc-3

我正在尝试使用以下下拉框来选择要为模型编辑的值范围。

到目前为止，我已经得到了以下代码：

```
@Html.DropDownList("Services", "") 
```

但本质上我想在这里保存该字符串而不是这个：

```
@Html.EditorFor(Function(model) model.ServiceName) 
```

我的看法是：

```
@Using Html.BeginForm()
    @Html.ValidationSummary(True)
    @<fieldset>
        <legend>RequestedService</legend>

        <div class="editor-label">
            @Html.LabelFor(Function(model) model.ServiceId)
        </div>
        <div class="editor-field">
            @Html.EditorFor(Function(model) model.ServiceId)
            @Html.DropDownList("Services", "")
            @Html.ValidationMessageFor(Function(model) model.ServiceId)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
End Using 
```

目前这两件事。

我的控制器：

```
Function AddService(id As Integer) As ViewResult
        Dim serv As RequestedService = New RequestedService
        serv.JobId = id

        Dim ServiceList = New List(Of String)()

        Dim ServiceQuery = From s In db.Services
                           Select s.ServiceName

        ServiceList.AddRange(ServiceQuery)

        ViewBag.Services = New SelectList(ServiceList)

        Return View(serv)
    End Function 
```

最后是我的模型：

```
Imports System.Data.Entity
Imports System.ComponentModel.DataAnnotations

Public Class RequestedService

Public Property RequestedServiceId() As Integer

Public Property ServiceId() As Integer

<Required()>
<Display(Name:="Job Number *")>
Public Property JobId() As Integer

<Required()>
<Display(Name:="Station ID *")>
Public Property StationId() As Integer

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:00:11.340

`SelectList`您需要告诉选择列表的问题是值和显示文本是什么。您不能只传递字符串列表，以正确填充，添加键和值，如下所示

```
Dim ServiceQuery = (From s In db.Services
                       Select s) 
```

可能是这样如果您需要与服务相关的ID

```
ViewBag.Services = New SelectList(ServiceList, s.IDServices, s.ServiceName) 
```

或者像这样如果您需要值的唯一文本

```
ViewBag.Services = New SelectList(ServiceList, s.ServiceName, s.ServiceName) 
```

**更新**

要完成此操作，您需要修改视图和您的操作。

首先在您的操作中更改您的 Viewbag 元素的名称，如下所示

```
ViewBag.ServiceId = New SelectList(ServiceList, s.IDServices, s.ServiceName) 
```

现在你的观点明显的变化是

```
@Using Html.BeginForm()
@Html.ValidationSummary(True)
@<fieldset>
    <legend>RequestedService</legend>

    <div class="editor-label">
        @Html.LabelFor(Function(model) model.ServiceId)
    </div>
    <div class="editor-field">
        @Html.DropDownList("ServiceId", "")
        @Html.ValidationMessageFor(Function(model) model.ServiceId)
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset> 
```

结束使用

所以你不需要

```
@Html.EditorFor(Function(model) model.ServiceId) 
```

当用户从下拉列表中选择选项并单击创建按钮时，属性 ServiceID 将自动映射到您的类中，即 mvc3 与元素的名称一起为您完成所有神奇的工作

# codeigniter - 嵌套where子句codeigniter mysql查询

> ID：11937867
> 
> 赞同：3
> 
> 时间：2012-08-13T15:52:07.213
> 
> 标签：codeigniter

有没有办法嵌套 where 子句？例如：

```
SELECT * FROM table WHERE (colA = 'valueA' AND colB = 'valueB') OR (colA = 'valueC' AND colB = 'valueD') 
```

我知道我可以把它写成一个`query`函数调用，例如：

```
$this->db->query("SELECT ...") 
```

但我想知道在codeigniter中是否有一种“正确”的方式来做到这一点，例如：

```
$this->db->where(array('colA'=>'valueA'), array('colB'=>valueB'))->or_where(array('colA'=>'valueC'), array('colB'=>'valueD')) 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T19:14:55.950

**有了codeigniter 3，现在有了，看看更新！**
~~没有`where()`允许您这样做的数组的方法使用变体。~~在这些情况下，我通常只是将零件构建成一个长字符串，如下所示：

```
$this->db->where("
    (
    (colA = '".$this->db->escape($v0)."' and colB = '".$this->db->escape($v1)."') 
    or 
    (colA = '".$this->db->escape($v2)."' and colB = '".$this->db->escape($v3)."') 
    )
"); 
```

转义可以通过`escape`（进行一些自动检测）`escape_str`或`escape_like_str`手动完成，具体取决于预期的参数或使用的谓词。

如果我在使用[Datamapper 库](http://datamapper.wanwizard.eu/)的项目中，我更喜欢在构建此类查询时使用`group_start()`and方法，它们有[很多不同的风格](http://datamapper.wanwizard.eu/pages/get.html#Query.Grouping)。`group_end()`

## 更新

现在有了 Codeigniter 3，它在查询构建器中[具有分组方法](http://www.codeigniter.com/userguide3/database/query_builder.html#query-grouping)`->group_start()`，因此您可以执行s 和`->group_end()`s。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-21T09:40:34.837

你也可以试试

```
$this->db->where(condition1);
$this->db->or_where(condition2); 
```

# cognos - Title "not centered" when the report is being run using excel 2007

> ID：11937869
> 
> 赞同：0
> 
> 时间：2012-08-13T15:52:13.140
> 
> 标签：cognos, cognos-8

I'm working on an existing cognos report where a user specifically asked me to make changes. When the user runs the report, they run it in excel. When the user downloads the report to excel the title isn't centered. This threw me off because when viewing my report in Cognos Report Studio, the title is centered. What is the cause of this and is there a fix? They seek this change so they don't have to manually make the changes in excel before putting it to their use.

**EDIT:**

Report studio:

![enter image description here](../Images/48a4522ddc3b6d0891da96b9fc931c74.png)

Excel:

![enter image description here](../Images/3700ac1b1cfaec7a7d8479f11980a2eb.png)

When I run the report in HTML or PDF the title is perfectly in the middle, only excel renders it off.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T05:21:43.360

IBM Cognos has limitations when producing reports in Microsoft Excel format.

One work around for this problem is to use include the report title text in a table cell in the Page header block. Given below are the steps.

1.  Insert a table of 1 column and 1 row (i.e. 1 table cell) in the Page header block.
2.  Add "Text Item" in the table cell.
3.  Give appropriate report title in that text item.
4.  Select the table cell; In the 'Font & Text' properties, specify the horizontal alignment property to be 'Center'.
5.  Run the report in Excel 2007 format.

This also works for Excel 2002 format.

You can find some of the limitations for Excel format here:

[Unsupported Excel Formatting](http://publib.boulder.ibm.com/infocenter/c8bi/v8r4m0/index.jsp?topic=/com.ibm.swg.im.cognos.ug_rptstd_fin.8.4.0.doc/ug_rptstd_fin_id4744UnsupportedExcelFormatting.html)

[Unsupported IBM Cognos 8 Formatting](http://publib.boulder.ibm.com/infocenter/c8bi/v8r4m0/index.jsp?topic=/com.ibm.swg.im.cognos.ug_rptstd_fin.8.4.0.doc/ug_rptstd_fin_id4621excel_appendx_unsupp_formatting.html)

[Limitations When Producing Reports in Microsoft Excel Format](http://publib.boulder.ibm.com/infocenter/c8bi/v8r4m0/index.jsp?topic=/com.ibm.swg.im.cognos.ug_rptstd_fin.8.4.0.doc/ug_rptstd_fin_id4565excel_limitations.html)

@MichaelYounani Instead of having title texts (6 rows) in 2 different table structures, you can move all the 6 rows of title in the same table. Please refer to the screen shot.

![Align Table cells in report studio](../Images/465387f514c1c4f743b1d904a06e2df9.png)

That way, when the report is run in Excel format, you can get all the title rows in one column and aligned to the center. ![After Aligned](../Images/cb790ef1ee37bd2dc273a84804fa9fbf.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T13:57:15.657

Take a list object..

unlock the report. add list header. (note not the page header..) select the list header and select split cells. Place a text item in the first list header cell. Select all the list header cells and select merge cells.

Now, you can format the merge cells with center and bold.

This will ensure the total number or columns and the list header cells are same.

Run the report and export to excel. This method work in any version of cognos. --Srrinivas.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-14T17:40:56.683

Go to Page Layout, then next to the Gridlines tab is Headings. Click on the expanding arrow right below that. From within there, go to Header/Footer. Uncheck the boxes that say, "Scale with document" and "Align with page margins". Problem solved.

# android - Android 空异常构造函数

> ID：11937872
> 
> 赞同：0
> 
> 时间：2012-08-13T15:52:37.807
> 
> 标签：android, android-context

您好，我对消除 NullEx 有疑问...

我设置`mContext = context`了，现在我有错误：

```
Implicit super constructor LinearLayout() is undefined. Must explicitly invoke another constructor

Constructor call must be the first statement in a constructor

public DigitalClock(Context context) {
    mContext=context;
    this(context, null);
 } 
```

较早的线程[Android闹钟](https://stackoverflow.com/questions/11816248/android-alarm-clock)显示问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:57:11.380

您需要一个超类构造函数调用。

```
public DigitalClock(Context context) {
    super(context); // Add a line like this.  
                   // Consult constructor documentation for correct usage.
    this(context, null); // this line must also be at the top.
    mContext=context;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:57:12.047

我假设您正在扩展 View，在这种情况下，您至少需要两个构造函数。

```
//...Override Constructors...    
public DigitalClock(Context context, AttributeSet attrs) {
    super(context, attrs); 

}

public DigitalClock(Context context){
    super(context); 

} 
```

看看是否有帮助。

# python - Python、flask 和创建双语言应用程序

> ID：11937876
> 
> 赞同：5
> 
> 时间：2012-08-13T15:52:49.647
> 
> 标签：python, flask, multilingual, gettext

我需要创建一个可以支持双语即英语和日语的网络应用程序。我不需要翻译，只需要根据用户偏好显示文本的工作流程。

有没有这样一个框架，我不必重新发明轮毂？还是我必须创建两个单独的站点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T15:56:21.970

多语言网站通常使用[gettext](http://docs.python.org/library/gettext.html)创建（许多系统都支持它，包括 Django 和 Flask）。我没有亲自使用过它，但[Flask-Babel](http://packages.python.org/Flask-Babel/)似乎是你需要的包。

基本思想是：您将所有英文字符串标记为可翻译，然后您可以创建其他语言的翻译文件，例如日语。然后，您可以在请求页面时从适当的语言加载字符串（在 Django 中，这是在一些配置后自动完成的，我可以想象它在 Flask 中是相似的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T15:57:43.480

使用 python 的[gettext](http://docs.python.org/library/gettext.html)包管理多语言文本，然后根据“Accept-Language”标头或某些 URL 参数设置语言。

# winforms - DropDownList 缺少字体或字符串编码问题

> ID：11937877
> 
> 赞同：4
> 
> 时间：2012-08-13T15:52:51.630
> 
> 标签：winforms, unicode, .net-3.5, cjk

我有一些韩文文本需要在我的 WinForm 上显示。文本在我的 ListBox 控件中显示良好。我的 DropDownList 控件中不显示相同的文本。两个控件的字体均为 Arial 8pt。这两个控件的 ItemHeight 属性都是 14。我无法发现这些控件的属性有任何差异，这意味着一个控件正确显示文本而另一个不正确。

我在[下面的文章](https://stackoverflow.com/questions/1096441/what-does-it-mean-the-text-in-control-appear-to-be-all-squares)中读到问题是由字体或字符编码引起的。

据我所知，代码使用标准的 .NET 字符串。没有进行字符转换。必须安装显示韩语所需的字体，否则我将无法在一个控件而不是另一个控件中查看它。我究竟做错了什么？

![韩语正确显示](../Images/c445e331107ddf8bdbb15135143a2e2c.png)

![韩文显示不正确](../Images/b33d275b0c8dde4f394dd9b68a00a621.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T13:50:21.170

我通过将字体从 Arial 8pt 更改为**[Arial Unicode MS](http://support.microsoft.com/kb/287247)** 8.25pt 解决了这个问题。正如[Luis Quijada](https://stackoverflow.com/users/1203135/luis-quijada)在建议我看这个问题时指出的那样

[带有 Segoe UI 和日语文本的 ComboBox](https://stackoverflow.com/questions/4157398/combobox-with-segoe-ui-and-japanese-text)

将字体从 Arial 更改为[Arial Unicode MS](http://support.microsoft.com/kb/287247)对我来说是一种可以接受的解决方法。我不确定 Arial 应该支持哪些语言。Arial 在 ListBox 中工作但在韩文文本的 DropDownList 中不工作可能是 Microsoft 错误。

# matlab - 在 Matlab 计算中忽略包含 NaN 条目的向量

> ID：11937878
> 
> 赞同：0
> 
> 时间：2012-08-13T15:52:58.430
> 
> 标签：matlab, dynamic-data, finance, nan, quantitative-finance

此代码根据[fitSvensson](http://www.mathworks.co.uk/help/toolbox/finfixed/fitsvenssonirfunctioncurve.html)函数对债券进行定价。How do I get Matlab to ignore NaN values in the CleanPrice vector when a date is selected for which some bonds have a NaN entry for a missing price. 在推导零曲线时，如何让它完全忽略该键？似乎 NaN 的许多解决方案都采用插值或设置为零，但这会导致错误的曲线。

```
Maturity=gcm3.data.CouponandMaturity(1:36,2);

[r,c]=find(gcm3.data.CleanPrice==datenum('11-May-2012'));
row=r

SettleDate=gcm3.data.CouponandMaturity(row,3);
Settle = repmat(SettleDate,[length(Maturity) 1]);

CleanPrices =transpose(gcm3.data.CleanPrice(row,2:end));
CouponRate = gcm3.data.CouponandMaturity(1:36,1);
Instruments = [Settle Maturity CleanPrices CouponRate];
PlottingPoints = gcm3.data.CouponandMaturity(1,2):gcm3.data.CouponandMaturity(36,2);
Yield = bndyield(CleanPrices,CouponRate,Settle,Maturity);

SvenssonModel = IRFunctionCurve.fitSvensson('Zero',SettleDate,Instruments)
ParYield=SvenssonModel.getParYields(Maturity); 
```

数据看起来像这样，其中每列是债券，第 1 列是日期，元素是净价。如您所见，数据的第一部分包含大量尚未有价格的债券的 NaN。在某一点之后，所有债券都有价格，但不幸的是，有些情况下会丢失一两天的价格。理想情况下，如果存在 NaN，我希望它尽可能忽略该日期的该键，因为生成的曲线越多（无论使用的键数如何）越好。如果这是不可能的，则可以选择忽略该日期，但会导致许多曲线无法生成。 ![清洁价格数据](../Images/9281b7a945cf1c9a4afdbd31e57a0d20.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:58:36.503

这是您问题的一般解决方案。我的工作计算机上没有那个工具箱，所以我无法测试它是否适用于 IRFunctionCurve.fitSvensson 命令

```
[row,~]=find(gcm3.data.CleanPrice(:,1)==datenum('11-May-2012'));
col_set=find(~isnan(gcm3.data.CleanPrice(row,2:end)));
CleanPrices=transpose(gcm3.data.CleanPrice(row,col)); 
```

# javascript - ASP 语句中的多个 "s

> ID：11937884
> 
> 赞同：0
> 
> 时间：2012-08-13T15:53:17.713
> 
> 标签：javascript, asp.net, datagrid, datarow

我正在将一些 SQL 数据绑定到 GridView，现在想要链接到带有 2 个参数的 javascript 函数，其中一个是行中的另一个字段。

```
NavigateUrl="javascript:ShowDialogTest('2','<% ((DataRow)Container.DataItem)["SQLItem"] %>')" /> 
```

但是我不能用双引号得到 SQLItem，因为它认为它是 NavigateURL 的结尾。我也不能有单引号，因为它会停止参数。

不知道我是怎么知道的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:56:58.320

一个简单的解决方法是在事件`NavigateUrl`中从后面的代码中绑定属性。`OnItemDataBound`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:02:01.520

我同意弗朗西斯的回答，这是一个好方法。如果您想避免使用`OnItemDataBound`.

```
"javascript:ShowDialogTest('2','<% ((DataRow)Container.DataItem)[1] %>')" 
```

# php - file_get_contents('php://input') 一直返回空

> ID：11937886
> 
> 赞同：3
> 
> 时间：2012-08-13T15:53:24.467
> 
> 标签：php, file-get-contents

我正在尝试在我的网站中设置 gitkit，但无法通过这一行代码。不管我做什么，`file_get_contents`总是空着回来。

我已经设置了我的 php.ini ：`always_populate_raw_post_data = On`

我的环境是`PHP 5.3.3`, `Apache 2.2.6`, localhost。

这是一些代码。

在我的 index.php 中，我调用 google API 并尝试使用 gmail 帐户登录，即联合登录。

（这是来自 Google API 控制台）

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/googleapis/0.0.4/googleapis.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/jsapi"></script>
<script type="text/javascript">
  google.load("identitytoolkit", "1", {packages: ["ac"], language:"en"});
</script>
<script type="text/javascript">
  $(function() {
    window.google.identitytoolkit.setConfig({
        developerKey: "HERE_GOES_MY_DEVELOPER_KEY",
        companyName: "Valentinos Pizzaria",
        callbackUrl: "http://localhost/valentinos/callback.php",
        realm: "",
        userStatusUrl: "http://localhost/valentinos/userstatus.php",
        loginUrl: "http://localhost/valentinos/login.php",
        signupUrl: "http://localhost/valentinos/register.php",
        homeUrl: "http://localhost/valentinos/index.php",
        logoutUrl: "http://localhost/valentinos/logout.php",
        idps: ["Gmail", "Yahoo"],
        tryFederatedFirst: true,
        useCachedUserStatus: false,
        useContextParam: true
    });
    $("#navbar").accountChooser();
  });
</script> 
```

我收到 IDP 响应、登录并被要求授予权限。返回到我的回调页面后，我在其中使用了 Google 提供的代码示例（如下所示），这一行代码似乎没有正确返回。

我在做任何愚蠢的事情吗？

任何帮助将不胜感激。

到目前为止，这是整个 callback.php（目前还没有任何 HTML）：

```
 session_start();

  $url = EasyRpService::getCurrentUrl();
  #$postData = @file_get_contents('php://input');
  $postData = file_get_contents('php://input');
  $result = EasyRpService::verify($url, $postData);
  // Turn on for debugging.
  // var_dump($result);

class EasyRpService {
  // Replace $YOUR_DEVELOPER_KEY
  private static $SERVER_URL = 'https://www.googleapis.com/rpc?key=HERE_GOES_MY_DEVELOPER_KEY';

  public static function getCurrentUrl() {
    $url = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on') ? 'https://' : 'http://';
    $url .= $_SERVER['SERVER_NAME'];
    if ($_SERVER['SERVER_PORT'] != '80') {
      $url .= ':'. $_SERVER['SERVER_PORT'];
    }
    $url .= $_SERVER['REQUEST_URI'];
    return $url;
  }

  private static function post($postData) {
    $ch = curl_init();
    curl_setopt_array($ch, array(
        CURLOPT_URL => EasyRpService::$SERVER_URL,
        CURLOPT_RETURNTRANSFER => 1,
        CURLOPT_HTTPHEADER => array('Content-Type: application/json'),
        CURLOPT_POSTFIELDS => json_encode($postData)));
    $response = curl_exec($ch);
    $http_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    if ($http_code == '200' && !empty($response)) {
      return json_decode($response, true);
    }
    return NULL;
  }

  public static function verify($continueUri, $response) {
    $request = array();
    $request['method'] = 'identitytoolkit.relyingparty.verifyAssertion';
    $request['apiVersion'] = 'v1';
    $request['params'] = array();
    $request['params']['requestUri'] = $continueUri;
    $request['params']['postBody'] = $response;

    $result = EasyRpService::post($request);
    if (!empty($result['result'])) {
      return $result['result'];
    }
    return NULL;
  }

} # End Class EasyRpService 
```

在有人问之前，我确实`HERE_GOES_MY_DEVELOPER_KEY`用我的开发人员密钥替换...

再次，任何帮助将不胜感激。C呀。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T16:34:23.590

您是否尝试过使用 $_POST ？`php://input` [不适](http://www.php.net/manual/en/wrappers.php.php)用于 enctype="multipart/form-data"。在这种情况下，您可能会收到 multipart/form-data 的响应 $_POST[0] 应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T16:05:03.700

HTTP POST 数据通常填充在 $_POST 中，php://input 通常包含 PUT 数据。

# .net - TF30073 无法对覆盖文件合并 wsdl 执行撤消

> ID：11937887
> 
> 赞同：1
> 
> 时间：2012-08-13T15:53:25.900
> 
> 标签：.net, tfs, merge, wsdl, undo

我有以下问题：

1.  在主线上完成了一些工作（ WebService 和一个使用它的应用程序）
2.  我想在一个分支上合并我的更改，所以我使用了合并选项。
3.  编译时发现 Web 服务存在差异，因此我在 asmx.cs 文件中添加了所需的 Web 方法。
4.  我在使用它的应用程序上更新 Web 服务引用
5.  问题：我无法签入 wsdl 或对其执行撤消操作。所以我被困住了。我得到的消息是 TF30073 SQL 错误 515

TF30073：请联系您的管理员。处理您的请求时出错 技术信息 SQL 错误：515

1.  我尝试只在这两个文件上创建一个毫无根据的分支，但没有成功。
2.  我尝试重命名它（这只做最糟糕的事情）现在我也得到了错误：

TF10210：源代码管理在撤消操作期间遇到错误：

顺便提一句

1.  现在我意识到合并仅适用于简单的更改。
2.  我不想用不同的名字重新生成网络引用，因为我们是一群开发人员，但这是我今晚晚些时候的最后一个选择:)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T14:37:42.627

好吧，我通过删除工作区并再次添加它来解决它。（为避免丢失所有挂起的更改，请执行搁置）

为此，需要执行以下步骤：

1.  文件 -> 源代码管理 -> 工作区
2.  删除当前工作区（不仅仅是文件夹映射，我指的是整个工作区）
3.  重新添加
4.  再次获取并映射所有内容。
5.  问题消失了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-04T19:55:28.333

它发生在我身上。问题是我删除了一个文件（一个待定更改），而我的 IDE 在同一目录中生成了相同的文件。因此，当我试图撤消更改时，它会抛出错误弹出窗口。我在目录中手动删除了文件，并撤消了更改。一切顺利。

# java - InputStream.read(byte[], 0 length) 提前停止？

> ID：11937891
> 
> 赞同：5
> 
> 时间：2012-08-13T15:53:56.443
> 
> 标签：java, servlets, inputstream

我一直在写一些东西来从传入的 HttpServletRequest （下面的“请求”）读取请求流（包含压缩数据），但是看起来普通的 InputStream 读取方法实际上并没有读取所有内容？

我的代码是：

```
InputStream requestStream = request.getInputStream();
if ((length = request.getContentLength()) != -1)
{
    received = new byte[length];
    requestStream.read(received, 0, length);
}
else
{
    // create a variable length list of bytes
    List<Byte> bytes = new ArrayList<Byte>();

    boolean endLoop = false;
    while (!endLoop)
    {
        // try and read the next value from the stream.. if not -1, add it to the list as a byte. if
        // it is, we've reached the end.
        int currentByte = requestStream.read();
        if (currentByte != -1)
            bytes.add((byte) currentByte);
        else
            endLoop = true;
    }
    // initialize the final byte[] to the right length and add each byte into it in the right order.
    received = new byte[bytes.size()];
    for (int i = 0; i < bytes.size(); i++)
    {
        received[i] = bytes.get(i);
    }
} 
```

我在测试过程中发现，有时顶部（当存在内容长度时）会停止读取传入请求流的一部分，并将“接收”字节数组的其余部分留空。如果我只是让它始终运行 if 语句的 else 部分，它会正常读取，并且所有预期的字节都放在“已接收”中。

因此，似乎我现在可以通过该更改单独保留我的代码，但是有人知道为什么正常的“读取”（字节[]，int，int）”方法停止读取吗？描述说如果存在文件结尾，它可能会停止。可能是 gzip 压缩的数据恰好包含与签名匹配的字节吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T15:59:12.787

您需要`while`在顶部添加一个循环以获取所有字节。流将尝试读取尽可能多的字节，但不需要`len`一次返回字节：

> 尝试读取多达 len 个字节，但可能会读取较小的字节数，可能为零。

```
if ((length = request.getContentLength()) != -1)
{
    received = new byte[length];
    int pos = 0;
    do {
        int read = requestStream.read(received, pos, length-pos);

        // check for end of file or error
        if (read == -1) {
            break;
        } else {
            pos += read;
        }
    } while (pos < length);
} 
```

编辑：固定时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T15:57:53.703

您需要查看填充了多少缓冲区。它只保证给你至少一个字节。

也许你想要的是[DataInputStream.readFully()](http://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html#readFully%28byte%5B%5D%29)；

# python - python多处理，管理器启动进程生成循环

> ID：11937895
> 
> 赞同：4
> 
> 时间：2012-08-13T15:54:04.467
> 
> 标签：python, process, multiprocessing, python-multiprocessing, pool

我有一个简单的 python 多处理脚本，它设置了一个试图将工作输出附加到管理器列表的工作人员池。该脚本有 3 个调用堆栈： - main 调用 f1，它产生多个调用另一个函数 g1 的工作进程。当尝试调试脚本时（顺便说一下在 Windows 7/64 位/VS 2010/PyTools 上），脚本会运行到嵌套的进程创建循环中，从而产生无穷无尽的进程。谁能确定为什么？我确定我错过了一些非常简单的东西。这是有问题的代码： -

```
import multiprocessing
import logging

manager = multiprocessing.Manager()
results = manager.list()

def g1(x):
    y = x*x
    print "processing: y = %s" % y
    results.append(y)

def f1():
    logger = multiprocessing.log_to_stderr()
    logger.setLevel(multiprocessing.SUBDEBUG)

    pool = multiprocessing.Pool(processes=4)
    for (i) in range(0,15):
        pool.apply_async(g1, [i])
    pool.close()
    pool.join()

def main():
    f1()

if __name__ == "__main__":
    main() 
```

PS：尝试添加`multiprocessing.freeze_support()`到 main 无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T16:54:23.293

基本上，sr2222 在他的评论中提到的是正确的。从[多处理管理器文档](http://docs.python.org/library/multiprocessing.html#multiprocessing-managers)中，它说____main____ 模块必须可由子模块导入。每个管理器**“对象对应于一个衍生的子进程”**，因此每个子进程基本上都在重新导入您的模块（您可以通过在我的固定版本中添加模块范围内的打印语句来查看！）......这会导致无限递归。

一种解决方案是将您的管理器代码移动到 f1() 中：

```
import multiprocessing
import logging

def g1(results, x):
    y = x*x
    print "processing: y = %s" % y
    results.append(y)

def f1():
    logger = multiprocessing.log_to_stderr()
    logger.setLevel(multiprocessing.SUBDEBUG)
    manager = multiprocessing.Manager()
    results = manager.list()
    pool = multiprocessing.Pool(processes=4)
    for (i) in range(0,15):
        pool.apply_async(g1, [results, i])
    pool.close()
    pool.join()

def main():
    f1()

if __name__ == "__main__":
    main() 
```

# c++ - C ++中的EOF键是什么

> ID：11937902
> 
> 赞同：2
> 
> 时间：2012-08-13T15:54:17.323
> 
> 标签：c++, io

我正在使用 Windows 7 旗舰版。我是 C++ 新手。以下是我对 switch 语句的练习。

```
void GradeBook::inputGrades()
{
    int grade;

    cout << "Enter Grade: " << endl;

    while((grade=cin.get()) != EOF)
    {
       switch(grade)
        {
            case 'A':
            case 'a':
                aCount++;
                break;

            case 'B':
            case 'b':
                bCount++;
                break;

            case 'C':
            case'c':
                cCount++;
                break;

            case 'd':
            case 'D':
                dCount++;
                break;

            case 'F':
            case 'f':
                fCount++;
                break;

           case '\n':
           case ' ':
           case '\t':
               break;

            default:
                cout << "Incorrect data. Re Enter" << endl;
                break;
        }

    }
} 
```

我在netbeans中运行它，我按下了所有组合 ctrl+c ， ctrl+z ， ctrl+d 但它没有结束！这是为什么？我做错了什么吗？请帮忙！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:01:22.920

cin.get() 是相当低的水平。代码应该使用更高级别的接口。它应该一次读取一个字符，所以这样写：

```
char grade;
while (cin >> grade) 
```

流提取器将在文件末尾失败，这将使 while 循环终止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T16:27:29.817

在 Windows 平台上，[EOF 字符](https://stackoverflow.com/questions/1793616/why-doesnt-getchar-recognise-return-as-eof-in-windows-console/1793631#1793631)是 Ctrl+Z 后跟换行符。

据推测，Netbeans 中的控制台也是如此。

# javascript - Ember.js 路由器，从 View 获取路由器

> ID：11937905
> 
> 赞同：1
> 
> 时间：2012-08-13T15:54:26.747
> 
> 标签：javascript, ember.js, coffeescript, ember-old-router

我有一个基于 ember.js 路由器的应用程序，需要在转换到不同的应用程序状态之前对操作执行一些基本逻辑。我的按钮的动作看起来像

```
<button {{action doSomethingThenNavigate target="view"}}>Compute the Change</button> 
```

我会`doSomethingThenNavigate`在我的子类上有一个方法`Ember.View`。

我的问题是我不知道如何让路由器从视图中触发更改，我试过了

```
doSomethingThenNavigate: ->
    console.log "computing something..." 
    App.router.showCat() 
```

`showCat()`我的路由器上的方法在哪里。这行不通。

我有一个 jsfiddle 来说明这个[问题](http://jsfiddle.net/wmarbut/EzxBw/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:09:32.840

这是工作[小提琴](http://jsfiddle.net/UzDze/1/)。

你应该使用：

```
App.router.send('showCat') 
```

代替：

```
App.router.showCat() 
```

# perl - 从不同文件发送数据的简单 perl 程序

> ID：11937906
> 
> 赞同：3
> 
> 时间：2012-08-13T15:54:27.847
> 
> 标签：perl

我编写了一个 perl 程序，它定期将更新的数据从文件发送到远程服务器。但是现在我希望它从不同的文件中读取它并发送更新的数据，以便接收者应该知道如何将数据与混合数据分开。我只需要放置某种分隔符吗？此类事情是否已有任何标准？

```
#############
#Change parameters
############
$PeerAddr='192.168.0.7';
$PeerPort='7070';
##############
# Import packages
##############
use Text::Diff;
use IO::Socket;
#############
# Define global variables
#############
$lineCount=0;
$loopCount=0;
our $stats2 = 0;
for($count = 0; $count <= 10000; $count++){
        my $data_dir="archive/otat/*dat";
        my $data_file= `ls -t $data_dir | head -1`;
        chomp($changed_data_file);
        print "old data_file is $changed_data_file \n";
        chomp($data_file);
        if($data_file ne $changed_data_file){
                $lineCount2=0;
                $changed_data_file=$data_file;
                print ("String:$data_file :$changed_data_file  are not equal\n");
                }
        while(defined($data_file)){
                print "$data_file \n";
                open (DAT,$data_file) || die("Could not open file! $!");
                @iofile = <DAT>;
                $lineCount = @iofile;
                splice(@diffLines);
                print "printing: $lineCount\n";
                print "printing 2: $lineCount2 \n";
                chomp $lineCount;
                chomp $lineCount2;
                if($lineCount != $lineCount2){
                        $j=0;
                        for($i=$lineCount2;$i <= $lineCount; $i++){
                        $diffLines[$j] = $iofile[$i];
                                $j++;
                }
                        $num=@diffLines;
                        print "count of diff lines:$num\n";
                        $lineCount2 = $lineCount;
                        $loopCount=0;
                }
                if($loopCount>2){
                        $loopCount=0;
                        print "Look for recent file \n";
                        last;
                }
                $loopCount++;
                sleep(5);
############################
                &socket_con(@diffLines);
        }

}
#### Methods/Functions
sub socket_con {
        if ($sock== 0){
                $sock = new IO::Socket::INET (
                                                        PeerAddr => $PeerAddr,
                                                        PeerPort => $PeerPort,
                                                        Proto => 'tcp'
                                                        );
                die "Could not create socket: $!\n" unless $sock;
        }
        print $sock @_;
#close($sock);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T20:42:32.760

我经常使用 JSON，效果很好[http://metacpan.org/pod/JSON](http://metacpan.org/pod/JSON) 您可以将数据存储在散列中，将其序列化，将文本发送到客户端，然后让它将字符串转回 Perl 散列方便使用。例如：

```
# on the server
use JSON;
...
# store changed lines in a hash
$diffLines->{$data_file}[$j]=$io_file[$i];
...
# Serialize the hash reference into a string which you then send to the client
$diffLinesSerialized = encode_json $diffLines;

# on the clinet
use JSON;
...
# convert received data from serialized string into hash
$diffLines = decode_json $diffLinesSerialized;
# $diffLines is now a has reference which can be accessed like normal
foreach my $data_file (keys %$diffLines) {
  foreach my $line (@{$diffLines->{$data_file}}) {
    ...
  }
} 
```

说了这么多，尽管从编程的角度来看我不太喜欢 XML，但它是这类事物的普遍标准。如果这只是一个专门的内部工具，不会发展成更大的东西，那可能没关系，但如果你认为这可以变成更通用的服务，比如对于非 perl 客户，最好考虑XML 作为一个选项。从面向服务的角度进行编程可以使未来的发展变得更加容易。

# c++ - Awesomium 1.7RC2 与 VS11

> ID：11937908
> 
> 赞同：2
> 
> 时间：2012-08-13T15:54:43.050
> 
> 标签：c++, visual-studio-2012, awesomium

我有一个小问题，我不知道如何解决（很遗憾）。

我想编译一个 Awesomium 1.7RC2 SDK 的示例项目，它在 vs10 上运行良好，但在 vs11 上我确实遇到了一些错误。

这些是错误：

```
http://pastebin.com/6RdUffve 
```

它们是由这些代码行引起的：

```
method_dispatcher_.Bind(app_object,
WSLit("SayHello"),
&Application::OnSayHello);
method_dispatcher_.Bind(app_object,
WSLit("Exit"),
&Application::OnExit);

method_dispatcher_.BindWithRetval(app_object,
WSLit("GetSecretMessage"),
&Application::OnGetSecretMessage); 
```

调度程序类的代码：

标题： http: [//pastebin.com/ktTEuQ4T](http://pastebin.com/ktTEuQ4T)

来源： http: [//pastebin.com/FTDHQzJ9](http://pastebin.com/FTDHQzJ9)

我希望有一个人可以帮助我 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T16:20:11.810

这似乎是由 VS2012 中的一个错误引起的，其中 std::function 没有将成员函数指针隐式转换为函数指针。这个例子应该根据 Bjarne Stroustroups C++11 FAQ 工作，在我的 VS2012 中抛出同样的错误：

```
struct X {
    int foo(int);
};

function<int (X*, int)> f;
f = &X::foo;        // pointer to member

X x;
int v = f(&x, 5);   // call X::foo() for x with 5 
```

您可以通过创建静态函数来解决这个问题

```
void StaticOnSayHello(Application* app, Awesomium::WebView* caller, const Awesomium::JSArray &args) {
    app->OnSayHello(caller, args);
} 
```

等等，并将它们作为第三个参数提供给 method_dispatcher::Bind。

# javascript - FB Like 按钮功能遇到的问题

> ID：11937912
> 
> 赞同：1
> 
> 时间：2012-08-13T15:54:49.057
> 
> 标签：javascript, iframe-app

我在我的网站上使用了一个类似 fb 的按钮。但它只是在活动日志中创建一个活动。我希望将其与我朋友列表中的每个人共享，即我希望将其张贴在我的墙上。

我怎样才能做到这一点？

任何帮助将不胜感激..

注意：我刚刚使用以下 URL 创建了一个链接：[https](https://developers.facebook.com/docs/reference/plugins/like/) ://developers.facebook.com/docs/reference/plugins/like/ 。

如果我需要任何额外的东西，请告诉我。

# mysql - GROUP BY 不同年份的连续月份

> ID：11937913
> 
> 赞同：6
> 
> 时间：2012-08-13T15:54:51.363
> 
> 标签：mysql, date, group-by

我有一张桌子（但在很多地方）：

```
DATE         STUFF
-------------------
2011-12-01   DATA
2011-12-02   DATA
2011-12-03   DATA
...
2011-12-31   DATA
2012-01-01   DATA
2012-01-02   DATA 
```

我的表涵盖了从 2005 年到 2012 年的多年。我想获取每年中每个月的 AGGREGATE 函数值，即 SUM/AVG/MAX/MIN。简单的：

```
GROUP BY DATE_FORMAT(DATE, '%Y'), DATE_FORMAT(DATE, '%m') 
```

我想在那些年的 3 个月时间段内做同样的事情......这适用于除一个以外的所有人：

```
GROUP BY DATE_FORMAT(DATE, '%Y'), DATE_FORMAT(DATE, '%m') IN (12, 01, 02) 
```

我的其他时间段有效，因为它们在同一年（03、04、05）、（06、07、08）和（09、10、11）......但上面的 GROUP BY 是在 2012 年 12 月分组2012 年 1 月/2 月。我的时间段必须是 2011 年 12 月和 2012 年 1 月/2 月、2010 年 12 月和 2011 年 1 月/2 月……

我想保持这个通用性，所以我不必更新日期跨度，以便将代码放在多个位置的存储过程中。

如果 MONTH 12，我试图通过将前一年移动一年来自行加入表格。这产生​​了不良结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T16:10:07.023

```
 GROUP BY floor((month(DATE) + year(DATE) * 12 -1 + %month_shift%) / %month_group_period%) 
```

其中 %month_group_period% 在您的示例中是三 (3)
并且 %month_shift% 是一 (1) 以获得 12 月、1 月、2 月一起，依此类推

**编辑：** 这也适用于 5 个月（如果你愿意）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:01:13.923

我在这里假设您真正想要做什么`DATE_FORMAT(DATE, '%m') IN (12, 01, 02)`，但是：

```
SELECT IF(DATE_FORMAT(DATE, '%m') = 12, DATE_FORMAT(DATE, '%Y') + 1, DATE_FORMAT(DATE, '%Y')) AS yr, 
    CASE DATE_FORMAT(DATE, '%m')
        WHEN 12 THEN 1
        WHEN 1 THEN 1
        WHEN 2 THEN 1
        WHEN 3 THEN 2
        WHEN 4 THEN 2
        WHEN 5 THEN 2
        WHEN 6 THEN 3
        WHEN 7 THEN 3
        WHEN 8 THEN 3
        WHEN 9 THEN 4
        WHEN 10 THEN 4
        WHEN 11 THEN 4
    END AS qtr
FROM ...
GROUP BY IF(DATE_FORMAT(DATE, '%m') = 12, DATE_FORMAT(DATE, '%Y') + 1, DATE_FORMAT(DATE, '%Y')), 
    CASE DATE_FORMAT(DATE, '%m')
        WHEN 12 THEN 1
        WHEN 1 THEN 1
        WHEN 2 THEN 1
        WHEN 3 THEN 2
        WHEN 4 THEN 2
        WHEN 5 THEN 2
        WHEN 6 THEN 3
        WHEN 7 THEN 3
        WHEN 8 THEN 3
        WHEN 9 THEN 4
        WHEN 10 THEN 4
        WHEN 11 THEN 4
    END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:04:06.330

我会尝试这样的事情：

```
GROUP BY DATE_FORMAT(IF(MONTH(`DATE`)=12,DATE_ADD(`DATE`,INTERVAL 1 YEAR),`DATE`),'%Y')
       , DATE_FORMAT(`DATE`,'%m') 
```

基本上，如果月份是 12，则添加 1 年。

实际上，我倾向于这样做：

```
GROUP BY DATE_FORMAT(DATE_ADD(`DATE`,INTERVAL IF(MONTH(`DATE`)=12,1,0) YEAR),'%Y')
       , CASE WHEN MONTH(`DATE`) IN (12,1,2) THEN 1
              WHEN MONTH(`DATE`) IN (3,4,5) THEN 2
              WHEN MONTH(`DATE`) IN (6,7,8) THEN 3
              WHEN MONTH(`DATE`) IN (9,10,11) THEN 4
          END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T16:02:01.757

我不认为你想使用`GROUP BY`你正在尝试的方式。你可能想这样写你的查询

```
SELECT MONTH(date) as `month`, SUM(stuff) as `sum`
FROM table
WHERE YEAR(date) IN ('2010', '2011', 2012')
GROUP BY `month` 
```

GROUP BY 子句不是您应该过滤/格式化数据的地方。

当然，您可以使用任何您想要的聚合函数来代替 SUM。您也可以省略所有年份的 WHERE 子句，或根据需要修改要包含的年份。

如果你想要年份和月份，你可以像这样简单地修改查询：

```
SELECT YEAR(date) as `year`, MONTH(date) as `month`, SUM(stuff) as `sum`
FROM table
WHERE `year` IN ('2010', '2011', 2012')
GROUP BY `year`, `month` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T16:03:01.107

您需要通过以下方式从该组的日期中减去一个月：

```
GROUP BY DATE_FORMAT(date_add(DATE,  interval 1 month), '%Y'),
         DATE_FORMAT(date_add(date, interval 1 month), '%m') IN (12, 01, 02) 
```

您可能还必须修改选择。

```
select DATE_FORMAT(date_add(date_add(DATE,  interval 1 month), interval -1 month), '%Y'),
       DATE_FORMAT(date_add(date_add(date, interval 1 month), interval -1 month), '%m') 
```

# windows - mysqldb python winserver元数据错误

> ID：11937915
> 
> 赞同：1
> 
> 时间：2012-08-13T15:55:03.133
> 
> 标签：windows, module, mysql-python, plesk

我正在尝试在我的 Windows 虚拟服务器上安装适用于 python2.7 的 mysqldb 模块。所以我在 cmd 中运行 mysqldb 的 setup.py 并得到一个错误 - 称为“No Sectoin: 'metadata'”。

所以我认为这可能是一个路径问题。因为在我的服务器上安装了 plesk。并且 MySQL 安装在 Plesk 中，MySQL 的路径不正常：“C:\Parallels\Plesk\Databases\MySQL51”，我的问题是我如何告诉模块 MySQL 安装在那里，这会修复错误吗？

对不起我的英语不好，谢谢你的回答！

吉兹韦恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:25:23.307

您必须在那里编辑`site.cfg`和修复注册表设置，但由于您已发布此内容，SourceForge 上有一个[Windows MSI 包](https://sourceforge.net/projects/mysql-python/files/latest/download)应该可以解决您的问题。SVN 版本（即将成为 1.2.4）跳过使用注册表，并且在 Windows 上构建会更容易一些。

# android - Android 上的 Wave Launcher 如何响应手势事件

> ID：11937918
> 
> 赞同：2
> 
> 时间：2012-08-13T15:55:10.630
> 
> 标签：android

[Android 1](https://play.google.com/store/apps/details?id=com.mobilemerit.wavelauncher)上的 Wave Launcher 如何在不替换默认 Launcher App 的情况下响应手势事件？

有趣的权限是“显示系统级警报”，我假设它们用来绘制启动器和“在启动时自动启动”，我假设它是一项服务？他们用来听手势？

他们是否使用服务来检测手势，如果是，您如何做到这一点？或者他们只是创建一个透明窗口来进行检测？

[https://play.google.com/store/apps/details?id=com.mobilemerit.wavelauncher](https://play.google.com/store/apps/details?id=com.mobilemerit.wavelauncher)

# performance - O(M+N) 是什么意思？

> ID：11937919
> 
> 赞同：7
> 
> 时间：2012-08-13T15:55:17.260
> 
> 标签：performance, complexity-theory, big-o

这是一个基本问题......但我认为 O(M+N) 与 O(max(M,N)) 相同，因为随着我们走向无穷大，更大的项应该占主导地位？此外，这与 O(min(M,N)) 不同，对吗？我一直看到这个符号，特别是。在讨论图算法时。例如，您通常会看到：O(|V| + |E|)（例如，[http://algs4.cs.princeton.edu/41undirected/](http://algs4.cs.princeton.edu/41undirected/)）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T16:16:04.120

是的，O(M+N) 与 O(max(M, N)) 的含义相同。这与 O(min(M, N)) 不同。正如@Dr_Asik 所说，O(M+N) 在技术上是线性的 O(N) 但是当 M 和 N 有意义时，能​​够说“线性在什么方面”很好。想象一下，算法在行数和列数上是线性的。我们可以定义 N = rows + cols 并说 O(N) 或者我们可以说 O(M+N) 其中 M 是行，N 是列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T16:01:12.777

线性时间记为 O(N)。由于 (M+N) 是一个线性函数，因此也应该简单地记为 O(N)。同样，将 O(1) 与 O(2)、O(10) 等进行比较是没有意义的，它们都是常数时间，都应该记为 O(1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-12T23:13:16.697

我知道这是一个旧线程，但是当我现在正在研究这个时，我想我会为那些目前正在搜索类似问题的人添加两分钱。

我认为 O(n+m) 在表示为[adjacency list](https://en.wikipedia.org/wiki/Adjacency_list)的图的上下文中正是如此，并且由于以下原因不能更改：

1) O(n+m) = O(n) + O(m)，但 O(m) 的上限为 O(n^2)，因此 O(n+m) = O(n) + O( n^2) = O(n^2)。然而，这纯粹是关于 n 的，也就是说，它只考虑顶点并给出一个弱的上限（弱是因为它试图用顶点表示边）。这确实表明 O(n) 不等于 O(n+m)，因为与顶点相比，边的数量可能是二次的。

2) 说 O(n+m) 考虑了在实现一种算法时必须通过的所有元素，这种算法被简化为[广度优先搜索](https://en.wikipedia.org/wiki/Breadth-first_search)(BFS) 之类的算法。由于它只考虑一次图中的所有元素，因此可以认为它是线性的，并且是一种更严格的分析，比用 n^2 限制边的上限。为了符号的缘故，可以写出类似 n = |V| 的东西。+ |E| 因此 BFS 的运行时间为 O(n)，并给读者一种线性的感觉，但通常，正如 OP 所提到的，它写为 O(n+m)，其中 n= |V| 和 m = |E|。

非常感谢，希望这对某人有所帮助。

# c++ - 从文件并发处理

> ID：11937921
> 
> 赞同：3
> 
> 时间：2012-08-13T15:55:22.437
> 
> 标签：c++, windows, file, memory-mapped-files, ppl

考虑以下代码：

```
std::vector<int> indices = /* Non overlapping ranges. */;
std::istream& in = /*...*/;

for(std::size_t i= 0; i< indices.size()-1; ++i)
{
    in.seekg(indices[i]);

    std::vector<int> data(indices[i+1] - indices[i]);

    in.read(reinterpret_cast<char*>(data.data()), data.size()*sizeof(int));

    process_data(data);
} 
```

我想让这段代码尽可能快地并行。

[使用PPL](http://msdn.microsoft.com/en-us/library/dd492418.aspx)将其并行化的一种方法是：

```
std::vector<int> indices = /* Non overlapping ranges. */;
std::istream& in = /*...*/;
std::vector<concurrency::task<void>> tasks;    

for(std::size_t i= 0; i< indices.size()-1; ++i)
{
    in.seekg(indices[i]);

    std::vector<int> data(indices[i+1] - indices[i]);

    in.read(reinterpret_cast<char*>(data.data()), data.size()*sizeof(int));

    tasks.emplace_back(std::bind(&process_data, std::move(data)));
}
concurrency::when_all(tasks.begin(), tasks.end()).wait(); 
```

这种方法的问题是我想在同一个线程中处理数据（适合 CPU 缓存），因为它被读入内存（数据在缓存中很热），这不是这里的情况，它只是浪费了使用热数据的机会。

我有两个想法如何改进这一点，但是，我也无法实现。

1.  在单独的任务上开始下一次迭代。

    ```
    /* ??? */
    {
         in.seekg(indices[i]);

         std::vector<int> data(indices[i+1] - indices[i]); // data size will fit into CPU cache.

         in.read(reinterpret_cast<char*>(data.data()), data.size()*sizeof(int));

         /* Start a task that begins the next iteration? */

         process_data(data);
    } 
    ```

2.  使用内存映射文件并映射文件的所需区域，而不是仅仅从具有正确偏移量的指针中读取。使用 处理数据范围`parallel_for_each`。但是，我不了解内存映射文件在何时读取到内存和缓存注意事项方面的性能影响。也许我什至不必考虑缓存，因为文件只是 DMA:d 到系统内存，从不通过 CPU？

有什么建议或意见吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T12:27:23.923

你很可能追求错误的目标。如前所述，“热数据”的任何优势都将与磁盘速度相形见绌。否则，有些重要的细节你没有告诉。
1）文件是否“大”
2）单条记录是否“大”
3）处理是否“慢”

如果文件是“大”的，那么您的首要任务是确保按顺序读取文件。你的“指数”让我不这么认为。根据我自己的经验，最近的例子是 6 秒 vs 20 分钟，具体取决于随机读取还是顺序读取。不开玩笑。

如果文件“小”并且您确定它已完全缓存，您只需要一个同步队列来将任务交付给您的线程，那么在同一个线程中处理不会有问题。

另一种方法是将“索引”分成两半，每个线程一个。

# java - Eclipse 在尝试使用 WritableList 调用构造函数时抱怨歧义

> ID：11937927
> 
> 赞同：4
> 
> 时间：2012-08-13T15:55:56.730
> 
> 标签：java, eclipse-rcp

我有一个带有一些这样的构造函数的类：

```
public MyClass(Control caller, WritableList elements, String pattern) {
    this(caller, elements, pattern, new LabelProvider());
}

public MyClass(Control caller, WritableList elements, String pattern, ILabelProvider labelProvider) {
    super(caller.getShell(), labelProvider);
    // ...
}

public MyClass(Control caller, Collection<String> elements, String pattern) {
    super(caller.getShell(), new LabelProvider());
    // ...
} 
```

如果我尝试使用以下方法创建它的实例：

```
new MyClass(getControl(), getWritableList(), "test"); 
```

或这个：

```
new MyClass(getControl(), (WritableList) getWritableList(), "test"); 
```

Eclipse 抱怨构造函数不明确。但是，如果我这样做：

```
new MyClass(getControl(), (Collection<SomeType>) getWritableList(), "test"); 
```

一切安好。我想知道可能是什么问题？我使用`org.eclipse.core.databinding.observable.list.WritableList`的是 RCP 框架附带的。

**编辑：**

我认为`WritableList`扩展`Collection`接口可能是错误，但我创建了一些测试类，结果事实并非如此：

```
public class Main {
    /**
     * Main.
     * @param args
     */
    public static void main(String[] args) {
        TestClass obj = new TestClass(getTypeAInstance(), "asd");
    }

    public static SomeTypeA getTypeAInstance() {
        return new SomeTypeA();
    }

    public static interface SomeInterface<T> {

    }

    @SuppressWarnings("rawtypes")
    public static interface SomeInterfaceExtensionWithoutTypeParam extends SomeInterface {

    }

    public static interface SomeInterfaceExtensionWithTypeParam<T> extends SomeInterface<T> {

    }

    @SuppressWarnings("rawtypes")
    public static interface SomeIntermediateInterface extends SomeInterfaceExtensionWithoutTypeParam, SomeInterfaceExtensionWithTypeParam {

    }

    public static class SomeTypeA implements SomeIntermediateInterface {

    }

    public static class TestClass {
        public TestClass(SomeInterface<String> i, String s) {
        }

        public TestClass(SomeTypeA a, String s) {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T12:56:38.643

似乎问题出在 Eclipse 自己的 Java 编译器上。

# database - 为什么不使用 db_query？（drupal 数据库层）

> ID：11937930
> 
> 赞同：1
> 
> 时间：2012-08-13T15:56:05.760
> 
> 标签：database, drupal

drupal 数据库层 api 说关于 db_query

> 不要将此函数用于 INSERT、UPDATE 或 DELETE 查询。这些应分别通过 db_insert()、db_update() 和 db_delete() 处理。 [（来源）](http://api.drupal.org/api/drupal/includes!database!database.inc/function/db_query/7)

我认为这也适用于其他数据库层。有人知道为什么吗？是否不安全、效率低下等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:09:46.200

据我所知，这只是惯例。`INSERT`当然，运行/ `UPDATE`through没有技术问题`db_query()`；它所做的只是对数据库运行一个普通的 SQL 查询，所以它肯定会工作。

我想文档只是简单地指出这些操作有专用的功能，并且应该优先于`INSERT`直接运行 SQL 等。

“结构化”查询（即使用`db_select()`、`db_insert()`和`db_update()`的查询`db_merge()`）还将获得在[`hook_query_alter()`](http://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_query_alter/7)执行之前运行的额外好处，这意味着系统的其他部分可以根据需要更改它们。使用`db_query()`.

# bison - 歧义语法的 Yacc 规则

> ID：11937931
> 
> 赞同：0
> 
> 时间：2012-08-13T15:56:06.060
> 
> 标签：bison, yacc

我正在尝试编写一个 yacc 语法来识别以下模式：

```
AAAA  -> Multiple As
BBBB  -> Multiple Bs
AAAABB -> 2 As followed by (AABB)
AAABBBBB  -> (AAABBB) followed by 2Bs 
```

一般来说，我想将相等的连续 As 和 B 块组合在一起，优先于仅 As 或 B 的运行。一个简单的语法显示了一堆冲突。

我需要一种方法来优先处理这种生产。

```
T -> | AB | ATB 
```

超过

```
U -> | AU 
```

（其中 T 和 U 是 yacc 产生式，A 和 B 是令牌）

这是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T17:58:24.627

In general, yacc cannot deal with ambiguous grammars. If you give it an ambiguous grammar (or any non-LALR(1) grammar), it will parse a subset of the language of that grammar, which may or may not be what you want.

With bison, you can use `%glr-parser` to create a glr parser that can parse an ambiguous grammar. However, you need to add `%dprec` and `%merge` directives to the appropriate spots in the grammar to resolve ambiguities, or you'll end up with a runtime error.

However, the language you've described isn't particularly ambiguous. In fact, its fairly trivially LALR(1), so can be easily handled by yacc:

```
%token A B
%%
input: multiA | multiB | twoA | twoB ;
multiA: A | A A | A A A | A A A moreAs ;
moreAs: A | moreAs A ;
multiB: B | multiB B ;
twoA: A A A A B B ;
twoB: A A A B B B B B ; 
```

# python - 如何使用 xcb python 为 X11 窗口管理器在根窗口上设置 SubstructureRedirect 事件掩码

> ID：11937935
> 
> 赞同：1
> 
> 时间：2012-08-13T15:56:18.677
> 
> 标签：python, x11, xcb

我有这段代码没有给出任何异常，但我似乎没有收到像 MapRequests 或 ConfigureNotifys 这样的事件：

```
import xcb
import xcb.xproto as xproto
conn = xcb.connect()
root = conn.get_setup().roots[0].root
eventmask = [xproto.EventMask.SubstructureRedirect, xproto.EventMask.SubstructureNotify]
conn.core.ChangeWindowAttributesChecked(self.root, xproto.CW.EventMask, eventmask)
while True:
    e = conn.wait_for_event()
    print e 
```

我正在 Xephyr 中对此进行测试。

难道我做错了什么？如果是这样，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T23:48:33.257

编辑：问题在于参数数量不正确：`xproto.CW.EventMask`表示您有一个值并且您传递了两个`[xproto.EventMask.SubstructureRedirect, xproto.EventMask.SubstructureNotify]`应该是`[xproto.EventMask.SubstructureRedirect|xproto.EventMask.SubstructureNotify]`

```
import xcb
import xcb.xproto as xproto
conn = xcb.connect()
root = conn.get_setup().roots[0].root
conn.core.ChangeWindowAttributesChecked(self.root, xproto.CW.EventMask, [xproto.EventMask.SubstructureRedirect|xproto.EventMask.SubstructureNotify])
while True:
    e = conn.wait_for_event()
    print e 
```

# asp.net - ASP.NET 请求验证和服务器端验证

> ID：11937942
> 
> 赞同：0
> 
> 时间：2012-08-13T15:56:35.870
> 
> 标签：asp.net, validation

我对 ASP.NET 请求验证和服务器端验证感到困惑。如果我们设置ValidateRequest="false"，如下。

```
<%@ Language="C#" ValidateRequest="false" %>
<html>
  <script runat="server">
   void btnSubmit_Click(Object sender, EventArgs e)
   {
      // If ValidateRequest is false, then 'hello' is displayed
      // If ValidateRequest is true, then ASP.NET returns an exception
      Response.Write(txtString.Text);
   }
  </script>
<body>
  <form id="form1" runat="server">
    <asp:TextBox id="txtString" runat="server" 
             Text="<script>alert('hello');</script>" />
    <asp:Button id="btnSubmit" runat="server" OnClick="btnSubmit_Click" 
             Text="Submit" />
  </form>
</body>
</html> 
```

那我们可以使用RequiredFieldValidator控件这样的服务端验证吗？

它们是不同的东西吗？但他们都有 validate 关键字。

谢谢你解释他们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:13:29.123

是的，它们是不同的。

`ValidateRequest`如果任何提交的表单字段值包含“危险”值（例如您那里的脚本标记），则会引发错误并中止请求，以防止脚本注入攻击。

验证器控件例如在`RequiredFieldValidator`失败时不会停止页面处理。它们用于帮助您处理规则，通常与保护服务器或应用程序免受攻击无关。

# .net - .net 3.5 的 microsoft.visualbasic.dll 在哪里？

> ID：11937944
> 
> 赞同：3
> 
> 时间：2012-08-13T15:56:43.003
> 
> 标签：.net, sharepoint, dll

我正在构建一个 Sharepoint webpart，我需要使用 .net 3.5 microsoft.visualbasic.dll 参考，因为 Sharepoint 使用 .net 3.5。

我在哪里可以找到它？

我试着看这里，但找不到

```
C:\Windows\Microsoft.NET\Framework\v3.5 
```

我尝试了 .net 4.0 dll，但该项目不允许我导入它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T17:03:27.963

它不是 v3.5 特定的程序集，它是核心 .NET 程序集的一部分。因此，您会在 中找到它`c:\windows\microsoft.net\framework\v2.0.50727`，以及 System.dll 和 mscorlib.dll 等其他核心程序集。v2.0.50727 是 .NET 框架版本 2.0 到 3.5 SP1 的运行时版本，它们都使用完全相同的 CLR 和核心程序集。

在 .NET 4 及更高版本中不同，引用程序集存储在不同的主目录中。它们在内部是不同的。GAC 中不再是程序集的副本，它们只包含元数据，没有 IL。你会发现它在`c:\program files\reference assemblies\microsoft\framework\.netframework\v4.0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:43:01.470

据我了解，如果您进入项目的编译选项并将目标框架设置为 .net 3.5，则不需要显式引用任何 visualbasic.dll

# asp.net - 奇怪的 Visual Studio 检查变量值

> ID：11937945
> 
> 赞同：0
> 
> 时间：2012-08-13T15:56:44.263
> 
> 标签：asp.net, vb.net

真的很奇怪......所以我试图将我的gridview的页面索引保存在会话变量中，然后在用户导航回gridView时重置索引。下面是我的代码；

```
Protected Sub Page_PreRender(ByVal sender As Object, ByVal e As EventArgs)
    If Not Page.IsPostBack Then
        If Not Session("CurrentPage") Is Nothing AndAlso 
Session("CurrentPage") <= GridView1.PageCount Then
            GridView1.PageIndex = Session("CurrentPage")
        End If
    End If
End Sub 
```

奇怪的是，当我在上面的第二个 IF 上断点并将鼠标悬停在 pageCount 上时，它说它是 0。如果我然后进入我的监视窗口并查看它（再次为 0），然后返回我的代码并再次悬停它是 2（应该是）！然后我可以继续越过断点，页面将按原样显示在第 2 页上。然而，这就是它变得非常奇怪的地方，如果我删除断点并运行它，我最终会在第 1 页！所以它好像`PageCount`没有更新，除非我在它上面放了一个断点并专门查看它。任何人都解释了这种行为以及如何解决它？！

**更新**

这是相关变量值的图片。您可以看到 PageIndex 没有更新，因为它从未进入`IF`语句，因为之前的 PageCount 为 0！我不能是唯一一个被这个难住的人：/

变量值的图像：![在此处输入图像描述](../Images/a76c5e39b1f96b1ee2c9a70581f06dd2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:58:28.007

我想您可能需要将 Session 值转换为 Integer

```
 If Not Session("CurrentPage") Is Nothing AndAlso 
               DirectCast(Session("CurrentPage"),
                                           Integer) <= GridView1.PageCount Then
         GridView1.PageIndex = DirectCast(Session("CurrentPage"),Integer)
    End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T14:29:31.153

好的有点hacky，但它的工作原理。简单使用；

```
If Not Session("CurrentPage") Is Nothing Then
    GridView1.PageIndex = DirectCast(Session("CurrentPage"), Integer)
End If 
```

无法让 GridView.PageCount 等于 2，除非进入 WatchWindow 并刷新 value 字段（很难向您的日常在线用户解释如何做到这一点，因此这不是一个真正的选择：P）。所以我试着把它排除在外。现在工作正常。可能会遇到页面不存在错误，但我认为这不太可能，因为页面数量根本没有太大变化，并且`Session("CurrecntPage")`变量会定期更新。

# php - 在php中搜索函数调用以生成翻译文件

> ID：11937950
> 
> 赞同：4
> 
> 时间：2012-08-13T15:57:01.277
> 
> 标签：php, grep, pattern-matching

我正在开发一个需要多语言的 php 网站。出于这个原因，我实现了一个具有以下标头的翻译函数：

```
function t($string, $replace_pairs = array(), $language = NULL) 
```

基本上，这个函数在我的项目的多个文件中是这样调用的：

```
echo '<p>' . t('Hello world!') . '</p>';
$hello_String = t("Hello @name!", array('@name'=>$username)); 
```

我还没有生成翻译字符串，我想自动生成多个翻译文件（每种语言一个）。

我正在寻找的是一个 bash 程序（或单个命令，例如使用 grep），它将查找对此 t() 函数的每次调用并生成具有以下结构的 php 文件：

```
<?php
/* Translation file "fr.php" */
$strings['fr']['Hello world!'] = '';
$strings['fr']['Hello @name!'] = ''; 
```

有没有人遇到过这种情况并可以帮助我解决这个问题？

非常感谢你。

亲切的问候，

马蒂厄

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-13T16:03:01.430

是的，您并不是第一个遇到这种情况的人。:)

您可以为此使用古老的 gettext 系统，而无需发明自己的功能。然后你就可以使用了，这是一个命令行实用程序，可以使用[函数](http://php.net/manual/en/function.gettext.php)[`xgettext`](http://www.gsp.com/cgi-bin/man.cgi?section=1&topic=xgettext)来提取字符串。[`_()`](http://php.net/manual/en/function.gettext.php)

如果您出于某种原因想推出自己的系统，最好的办法是编写一个 PHP 脚本，用于[`token_get_all`](http://php.net/token_get_all)标记源代码，然后检查标记并查找`T_FUNCTION`具有 value 的 s `t`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T15:32:20.537

试试这个脚本[http://pastie.org/4568713](http://pastie.org/4568713)

用法：

```
php script.php ./proj-directory lang1 lang2 lang3 
```

这会在目录中创建`lang1.php`, `lang2.php`,`lang3.php`文件`./lang`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T01:27:09.157

# 无需重新发明轮子

Drupal 使用相同的 t() 函数进行本地化，[potx](http://drupal.org/project/potx)模块是您的朋友。

如果您还没有或想要安装 drupal 实例，您可以查看[potx.inc](https://git.drupalcode.org/project/potx/blob/7.x-3.x/potx.inc)文件并在您的脚本中重用它。

这是翻译模板提取器的完整[API 文档](http://api.drupalhelp.net/api/potx/potx.module/6.3)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:12:42.363

你需要两个功能：

1- 扫描目录中的 php 文件。像[这样](http://lixlpixel.org/recursive_function/php/recursive_directory_scan/)

2-匹配您的 t 函数，grep 字符串并生成语言文件。像

```
 function genLang($file) {
    $content = file_get_contents($file);
    preg_match(...);
    foreach(...){
        echo(...);
    }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-24T20:04:32.743

Yii 框架也使用相同的功能，请参阅他们的 MessageCommand 类 [https://github.com/yiisoft/yii/blob/master/framework/cli/commands/MessageCommand.php#L125](https://github.com/yiisoft/yii/blob/master/framework/cli/commands/MessageCommand.php#L125)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-24T22:04:45.270

您需要的是一个（非常简单的）“模板系统”，但是您的问题中有两个模板实例。

1.  将 " `Hello $X!`" 转换为 " `Hello Jonh!`" 或 " `Hello Maria!`"，设置 $X。（PHP 在字符串声明中为您执行此操作）。
2.  选择适当的模板：“ `Hello $X!`”表示英语，“ `¡Hola $X!`”表示西班牙语。

项目 1 更简单，但算法顺序为 2,1（项目 2 和项目 1）。对于这个简单的任务，您不需要正则表达式（重新发明 PHP 的“带占位符的字符串”）。

## 说明

对于第 1 项，最简单的方法是声明一个专门的函数来说“你好”，

```
// for any PHP version.
function template1($name) { return "<p>Hello $name!</p>";}
print template1("Maria"); 
```

对于第 2 项，你需要一个概括，PHP 也为你做一个闭包，

```
header('Content-Type: text/html; charset=utf-8'); // only for remember UTF8.
// for PHP 5.3+. Use 
function generalTemplate1($K) {
    // $K was a literal constant, now is a customized content.
    return function($name) use ($K) {return "<p>$K $name!</p>"; };
}
// Configuring template1 (T1) for each language: 
$T1_en = generalTemplate1('Hello'); // english template
$T1_es = generalTemplate1('¡Hola'); // spanish template 
// using the T1 multilingual
print $T1_en('Jonh');  // Hello Jonh!
print $T1_es('Maria'); // ¡Hola Maria! 
```

更多模板，使用generalTemplate2()、generalTemplate3()等；`$T2_en`, `$T2_es`, `$T2_fr`, `$T3_en`,`$T3_es`等

## 解决方案

现在，为了实际使用，你喜欢使用数组......嗯，有一个数据结构问题，还有更多1级的泛化。成本是占位符的变量名解析器。我在 preg_replace_callback() 中使用了简单的正则表达式。

```
function expandMultilangTemplate($T,$K,$lang,$X) {
// string $T is a template, a HTML structure with $K and $X placeholders. 
// array  $K is a specific language constants for the template.
// array  $lang is the language, a standard 2-letter code. "en", "fr", etc.
// array  $X is a set of name-value (compatible with $T placeholders).
// Parsing steps:
$T = str_replace('{#K}',$K[$lang],$T);  // STEP-1: expand K into T with lang.
// STEP-2: expand X into T 
global $_expMultTpl_X;  // need to be global for old PHP versions
$_expMultTpl_X = $X;   
$T = preg_replace_callback(
        '/@([a-z]+)/',
        create_function(
                '$m',
                'global $_expMultTpl_X; 
                 return array_key_exists($m[1],$_expMultTpl_X)? 
                     $_expMultTpl_X[$m[1]]: 
                     "";
                 '
        ),
        $T
    );
    return $T;
}
// CONFIGURING YOUR TEMPLATE AND LANGUAGES:
$T = "<p>{#K} @name@surname!</p>";
$K = array('en'=>'Hello','es'=>'¡Hola');
// take care with things like "!", that is generic, and "¡" that is not.

// USING! 
print expandMultilangTemplate(
        $T, $K, 'en', array('name'=>'Jonh', 'surname'=>' Smith')    );
print expandMultilangTemplate($T, $K, 'es', array('name'=>'Maria')); 
```

我用 PHP5 测试了这个脚本，但它运行在旧版本（PHP 4.0.7+）上。

关于“多语言文件”：如果您的翻译是文件，您可以使用类似

```
$K = getTranslation('translationFile.txt');
function getTranslation($file,$sep='|') {
  $K = array();
  foreach (file($file) as $line) {
      list($lang,$words) = explode($sep,$line);
      $K[$lang]=$words;
  }
} 
```

和一个文件

```
en|Hello 
es|¡Hola 
```

## PHP 5.3 最简单

如果您使用 PHP 5.3+，有一种简单而优雅的方式来表达这个“最简单的多语言模板系统”，

```
function expandMultilangTemplate($T,$K,$lang,$X) {
    $T = str_replace('{#K}',$K[$lang],$T);
    $T = preg_replace_callback(
            '/@([a-z]+)/',
            function($m,$X=NULL) use ($X) {
                    return array_key_exists($m[1],$X)? $X[$m[1]]: '';
            },
            $T
     );
     return $T;
} 
```

# configuration - AppTools.Init 是唯一依赖物理配置文件的方法吗？

> ID：11937953
> 
> 赞同：1
> 
> 时间：2012-08-13T15:57:22.920
> 
> 标签：configuration, configuration-files, enterprise-web-library

如果不是，EWL 的其他哪些部分需要配置文件位于特定位置？

对于 AppTools.Init 确实需要的配置文件，是否可以以不同的方式指定该信息？（例如，通过直接传递配置 XML）。

我正在尝试将使用 EWL 的程序部署到我可能无法完全控制文件系统的环境中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:20:56.240

我相信这`AppTools.Init`是 EWL 中唯一*直接*依赖于物理配置文件的部分。但是 EWL 的许多其他部分通过使用依赖于正在加载的配置文件的功能来*间接*使用配置文件。`AppTools`

目前无法以任何其他方式指定配置信息，但添加对替代方法的支持并不难，因为这只需要修改`AppTools.Init`.

# asp.net-mvc-3 - 页面加载 MVC3 时显示验证错误

> ID：11937955
> 
> 赞同：1
> 
> 时间：2012-08-13T15:57:37.413
> 
> 标签：asp.net-mvc-3, validation

我有一个评论页面，显示用户在前几页中输入的信息。我知道通常 MCV 在提交表单时会显示验证错误。我希望在页面首次显示时显示验证消息。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:17:06.190

如果您想在页面加载时抛出一些验证错误，您可以执行类似的操作

```
public ActionResult MyReadOnlyPage(MyModel model)
{
  /* do your logic with the model */
  ModelState.AddModelError("ModelPropertyName1", "My property error 1");
  ModelState.AddModelError("ModelPropertyName2", "My property error 2");

  return View(model);
} 
```

然后，如果您有 ValidationErrorFor 或 ValidationSummary，您的错误消息应该会按预期显示。如果您希望错误未链接到属性（因此它将仅显示在摘要中），请使用

```
ModelState.AddModelError("", "generic error"); 
```

**更新**

我做的测试是这样的（从模板创建了一个新的 MVC 应用程序）：

该模型

```
public class MyViewModel
{
  public string name { get; set; }
  public string surname { get; set; }
} 
```

控制器

```
public ActionResult Index()
{
  ViewBag.Message = "Welcome to ASP.NET MVC!";
  var model = new MyViewModel();
  ModelState.AddModelError("name", "errror 1");
  return View(model);
} 
```

html

```
@model MvcApplication1.Models.MyViewModel
@{
   ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>
<p>
  To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
  @Html.ValidationSummary(false)
  @Html.ValidationMessageFor(model => model.name)
  @Html.ValidationMessageFor(model => model.surname)
</p> 
```

它对我有用。希望能帮助到你

# vba - 使用命令按钮 VBA 的奇怪删除行为

> ID：11937962
> 
> 赞同：2
> 
> 时间：2012-08-13T15:58:02.770
> 
> 标签：vba, excel

我正在继续努力处理从大型机中提取的数据。目前，我正在继续对[用于表单](https://stackoverflow.com/questions/11904443/pushing-data-from-datasheet-into-generated-template-worksheets)和潜在数据处理等的数据进行排序。这些数据是字母数字的，在形式上与我[之前关于](https://stackoverflow.com/questions/11620118/finding-numerical-value-pairs-with-conditionals-and-nested-if-then-statements)我持续数据工作的问题之一相似。

我当前的开发线之一涉及以启用宏的按钮的形式提高可用性。一个这样的按钮涉及一个宏，该宏旨在删除从 A2 到工作表中任何现有数据行末尾的一列“A”中的所有数据。

代码如下：

```
Sub DeleteCriteria_Click()

Dim CriteriaRange As Range

Dim LastCriteriaCell As Long

With Sheets("Criteria")
    LastCriteriaCell = .Range("A" & Sheets("Criteria").Rows.Count).End(xlUp).Row
    Set CriteriaRange = .Range("A2:A" & LastCriteriaCell)
End With

CriteriaRange.Cells.Select

Selection.Delete

End Sub 
```

奇怪的是，每次我激活按钮时，这段代码都会将我的列移动一格，并最终通过重复点击删除我的标题和后续列。此行为类似于列的正常删除函数。重构范围命令`CriteriaRange.Cells.Select`| `Selection.Delete`进入表格`CriteriaRange.Cells.Delete`，`CriteriaRange.Delete`并没有纠正这个问题。

我的意图是完全删除条目，以便在删除条目后输入新条件时没有空白或剩余数据集。因此，我有两个问题：

1）是什么导致了这种行为，即我做错了什么，在这里？

2）如何纠正这种行为以完全删除单元格或在功能上执行等效操作，从而防止对空白或空单元格的任何引用，同时保留我的列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:21:21.517

将您的代码更改为

```
CriteriaRange.Delete Shift:=xlUp 
```

默认是

```
CriteriaRange.Delete Shift:=xlToLeft 
```

因此，您的列被移动。

你的代码可以写成

```
Sub DeleteCriteria_Click()
    Dim LastCriteriaCell As Long

    With Sheets("Criteria")
        LastCriteriaCell = .Range("A" & .Rows.Count).End(xlUp).Row

        '~~> This is required so that your header cells are not touched
        If LastCriteriaCell < 2 Then Exit Sub

        .Range("A2:A" & LastCriteriaCell).Delete Shift:=xlUp
    End With
End Sub 
```

**或者**

```
Sub DeleteCriteria_Click()
    Dim LastCriteriaCell As Long

    With Sheets("Criteria")
        LastCriteriaCell = .Range("A" & .Rows.Count).End(xlUp).Row

        '~~> This is required so that your header cells are not touched
        If LastCriteriaCell >= 2 Then _
        .Range("A2:A" & LastCriteriaCell).Delete Shift:=xlUp
    End With
End Sub 
```

# internet-explorer - 似乎超过了 IE7 中 GET 请求的 URL 限制

> ID：11937964
> 
> 赞同：0
> 
> 时间：2012-08-13T15:58:09.130
> 
> 标签：internet-explorer, url, internet-explorer-8, internet-explorer-7, get

这里有很多关于各种浏览器中的 URL 长度限制的问题，但我发现了一个奇怪的情况，我很好奇其他人是否遇到过这个问题。

Interent Explorer 上的 url 字符限制有据可查： http: [//support.microsoft.com/kb/208427](http://support.microsoft.com/kb/208427) 根据我的研究，这篇文章并不完全正确，但是，因为我发现 IE8 限制正好是 4096 个字符。比这更长的 URL 显然会被截断。

在这个应用程序中，有一些 Javascript 执行基本的 GET 请求，并且由于各种因素，请求长度通常在 1000 个字符左右。但是，字符长度存在长尾分布，目前约有 1% 的请求超过 3000 个字符。我的服务器正在数据库中记录这些请求和浏览器标识信息。在我的测试环境（使用 IE7 运行 XP 的虚拟机）中，2083 个字符的限制似乎保持不变，并且请求似乎失败。

奇怪的是，我的生产数据库中有多个 IE7 条目远远超过 2083 个字符的限制，一个甚至长达 3043 个字符。

我的问题涉及到这种信息冲突的答案可能是什么。浏览器欺骗是否流行到足以成为解决方案？（例如，Firefox 用户是否伪装成 IE7）是否有例外或 Microsoft 补丁允许长 url 通过？非常感谢您的想法。

（作为旁注，我知道实际的修复——缩短我的 url 是一个可行的选择，我正在寻找将长度保持在 2000 以下的方法，例如 POST 或删除参数）。

# javascript - 如何让 JSLint 停止抱怨 Ember.js “.property()”？

> ID：11937973
> 
> 赞同：3
> 
> 时间：2012-08-13T15:58:42.860
> 
> 标签：javascript, properties, ember.js, jslint

如何让 JSLint 在我的模型定义中停止抱怨 Ember.js “.property()”？

例如，当给定时：

```
isBlah: function() {
    "use strict";
    ...
}.property("foo", "bar").cacheable() 
```

JSLint 抱怨：

```
Unexpected '.'. 
```

与 .property() 调用一致。每次出现“.property()”都会发生这种情况，这使得 JSLint 输出充满了“噪音”并且没有完全有用......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-05T23:06:28.957

Ember[记录](http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/)了以下方法来避免函数原型扩展。

代替**.property()**，使用**Ember.computed()**：

```
fullName: Ember.computed('firstName', 'lastName', function() {
  return this.get('firstName') + ' ' + this.get('lastName');
}) 
```

代替**.observes()**，使用**Ember.observer()**：

```
fullNameDidChange: Ember.observer('fullName', function() {
  console.log("Full name changed");
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T13:20:23.383

我的解决方案是将其转换为：

```
isBlah: Em.property(function() {
    "use strict";
    ...
}, "foo", "bar").cacheable() 
```

我首先将“属性”方法添加到 Ember（在启动我的应用程序之前）：

```
Em.property = function (func) {
    var params = Array.prototype.slice.call(arguments, 1);
    return Function.prototype.property.apply(func, params);
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-08T13:28:04.960

目前没有办法配置它。不过，您可以手动更改 jslint。

在`jslint.js`第 3397 行（版本 2013-11-23）附近，您会发现这些行

```
 case '.':
        if (peek().string !== 'bind' || peek(1).id !== '(') {
            next_token.warn('unexpected_a');
        }
        break; 
```

注释掉 if 语句和警告将消失！

```
 case '.':
        // if (peek().string !== 'bind' || peek(1).id !== '(') {
        //     next_token.warn('unexpected_a');
        // }
        break; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-04T09:27:21.030

Arne 的解决方案是正确的。但是 JSlint 不会警告你一些东西。而不是注释掉相关行在第 3387 行更改`jslint.js`

```
case '.':
    if (peek().string !== 'bind' || peek(1).id !== '(') {
        next_token.warn('unexpected_a');
    }
    break; 
```

对此（第 2 行）

```
 case '.':
        if (peek().string !== 'bind' && peek().string !== 'property' || peek(1).id !== '(') {
            next_token.warn('unexpected_a');
        }
        break; 
```

# php - PHP 我可以将文件复制到 web 文件夹之外吗？

> ID：11937975
> 
> 赞同：-3
> 
> 时间：2012-08-13T15:58:45.297
> 
> 标签：php, xampp

我正在使用 XAMPP

DocumentRoot 是 C:/xampp/htdocs

我想上传文件到 C:/DATA/SLIDES

这可能吗（不更改 Apache 的默认 DocumentRoot）。

我想添加一个新安装的 XAMPP。

PHP INI 文件是默认设置。我需要对 PHP.INI 进行哪些更改才能使其正常工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T15:59:50.197

是的。PHP 不知道也不关心 Apache 的`DocumentRoot`设置。重要的是操作系统级别的文件/目录权限以及您在其中启用的任何限制`php.ini`

例子：

```
$tmp_name = $_FILES['uploaded']['tmp_name'];
$destination = 'c:/DATA/SLIDES/' . $_FILES['uploaded']['name'];
move_uploaded_file($tmp_name, $destination); 
```

# c# - 多次调用异步回调函数（C#）

> ID：11937976
> 
> 赞同：1
> 
> 时间：2012-08-13T15:58:45.727
> 
> 标签：c#

这是通过 AsyncCallback 函数处理 HttpWebRequest 的代码片段。服务器端响应良好。它只响应一条返回消息，但是这个客户端代码被多次调用，让人头疼。

// 创建请求 HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestUri);

```
 try
        {
            // Make request with the following inline Asynchronous callback
            request.BeginGetResponse(new AsyncCallback((asynchronousResult) =>
                {
                    HttpWebRequest aRequest = (HttpWebRequest)asynchronousResult.AsyncState;
                    HttpWebResponse aResponse = (HttpWebResponse)aRequest.EndGetResponse(asynchronousResult);

                    using (StreamReader streamReader = new StreamReader(aResponse.GetResponseStream()))
                    {
                        // Deserialize the result
                        string jsonString = streamReader.ReadToEnd();
                        result = DeserializeToListOfObject(jsonString);

                        JavaScriptSerializer jS = new JavaScriptSerializer();
                        result = (List<object>)jS.Deserialize<List<object>>(jsonString);

                        if (result[0] is object[])
                        {
                            foreach (object message in (object[])result[0])
                            {
                                this.ReturnMessage = message;
                            }
                        } 
```

我得到了非常连续的相同返回消息。任何人都可以帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:15:50.747

似乎问题在行

```
request.BeginGetResponse(new AsyncCallback((asynchronousResult) => {} 
```

[MSDN](http://msdn.microsoft.com/tr-tr/library/system.net.httpwebrequest.begingetresponse.aspx)描述了异步请求和响应的正确实现

注意这一行：

```
IAsyncResult result=
        (IAsyncResult) myHttpWebRequest.BeginGetResponse(new AsyncCallback(RespCallback),myRequestState); 
```

希望这可以帮助。

# javascript - 使用 Javascript 的正则表达式从循环中检索内容

> ID：11937978
> 
> 赞同：3
> 
> 时间：2012-08-13T15:59:04.027
> 
> 标签：javascript, jquery, regex

这看起来很简单，但我从未做过正则表达式，所以只是来自 JS 正则表达式专家的一个简单问题。

```
var str = '<a href="test">luckyy1</a> born on october 21, 1986 <a href="test">sdf2</a> born on september 22, 1985 <a href="test">erere</a> born on November 23, 1984 '; 
```

我成功获得了以下值：`luckyy1`, `sdf2`,`erere`

但我需要它`luckyy1+october+21+1986,sdf2+september+22+1985,erere+`......等等（也许我需要正则表达式对吗？？）

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:20:36.643

试试这个：

```
str = $("<div/>").html(str).text();
str = str.replace(/,?/g, '').replace(/born on?/g, '').split(' ').join('+') 
```

[演示](http://jsfiddle.net/SdtqZ/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T16:05:30.380

虽然我建议不要[使用 regex 解析 HTML](https://stackoverflow.com/a/1732454/451590)，但这足够简单，您应该能够做到。

`"test"\s*>(.+?\d{4})`

这将捕获`"test">`标签后的任何内容，并以 4 个数字结尾（在您的示例中为年份）。

您的信息在组*1*中以空格分隔。在那之后，我建议分割空间来让你的个人元素发挥作用。

[玩正则表达式](http://regexr.com?31qqg)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:13:03.930

基本上，你想剥离 html 标签？

试试这个：

```
var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig,""); 
```

来自[http://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/](http://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/)

如果您希望为每个 dom 元素获取单独的字符串（如您的示例所示），您可以使用 jQuery 横向遍历 DOM 元素并分别剥离每个元素。

**编辑：**

像这样的东西：

```
var $s = jQuery( the_string ); 
var result = [];
$s.each(function(i, item){ result.push( $(item).text().replace(/(<([^>]+)>)/ig,"") ); }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T16:15:25.907

严格使用您提供的标记，您可以执行以下操作：

```
var values = $('<div><a href="test">luckyy1</a> born on october 21, '+
  '1986 <a href="test">sdf2</a> born on september 22, 1985 ' +
  '<a href="test">erere</a> born on November 23, 1984</div>')
  .contents()
  .map(function(){
    return $(this).text().replace('born on', '').trim();
}).get();

console.log(values); // ["luckyy1", "october 21, 1986", "sdf2", "september 22, 1985", "erere", "November 23, 1984"] 
```

我唯一改变的是`div`在字符串中添加了一个包装。然后，您可以使用`values.join('+')`to concat`+`和更多的字符串替换空格。

```
values.join('+').replace(/\s/g, '+'); // to make all whitespace `+` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T16:43:10.440

这是一个肮脏的解决方案，但不知何故可以帮助你......

```
var str = '<a href="test">luckyy1</a> born on october 21, 1986 <a href="test">sdf2</a> born on september 22, 1985 <a href="test">erere</a> born on November 23, 1984 ';

var r= /<a[^>]*>(.*)<\/a> born on ([\w]*) ([\d]*), ([\d]*) <a[^>]*>(.*)<\/a> born on ([\w]*) ([\d]*), ([\d]*) <a[^>]*>(.*)<\/a> born on ([\w]*) ([\d]*), ([\d]*)/;

r.exec(str).splice(1).join('+'); 
```

# java - 使用 eclipselink MOXy 的 XmlPath 映射问题

> ID：11937980
> 
> 赞同：1
> 
> 时间：2012-08-13T15:59:05.487
> 
> 标签：java, jaxb, eclipselink, moxy

我不明白为什么我在下面所做的 XmlPath 映射显示为空。我的语法有问题吗？我在其他地方使用了类似的语法，没有问题。

感谢您提供任何线索..约翰

```
<clip lane="-1" offset="2591065664/720000s" name="Music" duration="22304160/240000s" start="176794/48000s" enabled="0" format="r5">
    <adjust-volume amount="1dB">
      <param name="amount">
        <fadeIn type="easeIn" duration="1220/262144s"/>
      </param>
    </adjust-volume>
    <audio ref="r9" name="VoiceOver-26 - audio" duration="4639346/48000s" role="dialogue"/>
</clip>

@XmlRootElement(name = "clip")
@XmlAccessorType(XmlAccessType.FIELD)
public class Clip extends StoryElement {

@XmlPath("adjust-volume/@amount")
@XmlJavaTypeAdapter(DecibelValueAdapter.class)
private Double adjustVolume;

@XmlPath("adjust-volume/param[@name='amount']/fadeIn/@duration")
@XmlJavaTypeAdapter(TimeValueAdapter.class)
private TimeValue fadeIn;

@XmlPath("adjust-volume/param[@name='amount']/fadeOut/@duration")
@XmlJavaTypeAdapter(TimeValueAdapter.class)
private TimeValue fadeOut; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:12:37.927

我无法重现您使用 EclipseLink 2.4.0 看到的问题。以下是我尝试过的。

**夹子**

您的映射似乎没问题。

```
package forum11937980;

import javax.xml.bind.annotation.*;
import javax.xml.bind.annotation.adapters.XmlJavaTypeAdapter;

import org.eclipse.persistence.oxm.annotations.XmlPath;

@XmlRootElement(name = "clip")
@XmlAccessorType(XmlAccessType.FIELD)
public class Clip extends StoryElement {

    @XmlPath("adjust-volume/@amount")
    @XmlJavaTypeAdapter(DecibelValueAdapter.class)
    private Double adjustVolume;

    @XmlPath("adjust-volume/param[@name='amount']/fadeIn/@duration")
    @XmlJavaTypeAdapter(TimeValueAdapter.class)
    private TimeValue fadeIn;

    @XmlPath("adjust-volume/param[@name='amount']/fadeOut/@duration")
    @XmlJavaTypeAdapter(TimeValueAdapter.class)
    private TimeValue fadeOut;

} 
```

**jaxb.properties**

您在与域模型相同的包中是否有一个 jaxb.properties 文件，其中包含以下条目以将 MOXy 指定为您的 JAXB 提供程序？

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**输入.xml**

```
<clip lane="-1" offset="2591065664/720000s" name="Music" duration="22304160/240000s"
    start="176794/48000s" enabled="0" format="r5">
    <adjust-volume amount="1dB">
        <param name="amount">
            <fadeIn type="easeIn" duration="1220/262144s" />
            <fadeOut duration="I/Added/This"/>
        </param>
    </adjust-volume>
    <audio ref="r9" name="VoiceOver-26 - audio" duration="4639346/48000s"
        role="dialogue" />
</clip> 
```

**演示**

```
package forum11937980;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Clip.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum11937980/input.xml");
        Clip clip = (Clip) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(clip, System.out);
    }

} 
```

**输出**

下面是运行演示代码的输出。请注意，只有输入中的映射部分出现在输出中。

```
<?xml version="1.0" encoding="UTF-8"?>
<clip>
   <adjust-volume amount="1.0dB">
      <param name="amount">
         <fadeIn duration="1220/262144s"/>
         <fadeOut duration="I/Added/This"/>
      </param>
   </adjust-volume>
</clip> 
```

* * *

**支持文件**

以下是运行此示例所需的其余文件：

***故事元素***

```
package forum11937980;

public class StoryElement {

} 
```

***十进制值适配器***

```
package forum11937980;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class DecibelValueAdapter extends XmlAdapter<String, Double> {

    @Override
    public String marshal(Double v) throws Exception {
        return String.valueOf(v) + "dB";
    }

    @Override
    public Double unmarshal(String v) throws Exception {
        return Double.valueOf(v.substring(0, v.length() - 2));
    }

} 
```

***时间价值***

```
package forum11937980;

import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class TimeValue {

    @XmlValue
    private String value;

} 
```

***时间值适配器***

```
package forum11937980;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class TimeValueAdapter extends XmlAdapter<TimeValue, TimeValue> {

    @Override
    public TimeValue marshal(TimeValue v) throws Exception {
        return v;
    }

    @Override
    public TimeValue unmarshal(TimeValue v) throws Exception {
        return v;
    }

} 
```

# c# - SQL 删除查询无法正常工作

> ID：11937983
> 
> 赞同：3
> 
> 时间：2012-08-13T15:59:21.253
> 
> 标签：c#, winforms, visual-studio-2010, sql-server-2008

我的 sql`delete`查询中有一个逻辑错误，它不会在 Visual Studio 中给出任何错误，也没有删除数据库中的记录

这是我的代码片段

```
SqlCommand cmd = new SqlCommand(
   @"DELETE FROM table_name 
     WHERE item_id=" + itmIDs + 
         " AND vendor_id=" + vendIDs + 
         " AND dozen=" + selectedItmDzn + 
         " AND quantity=" + selectedItmQty + 
         " AND total_price=" + selectedItmTotPrc + "",
   con);
cmd.ExecuteNonQuery(); 
```

这是我的 conString

`SqlConnection con = new SqlConnection("Data Source=localhost;Initial Catalog=InvenotyBB;Integrated Security=SSPI")`

我已经确认其他动词*（**select**，**update**等）***有效，只是不是 delete 的***特定*****命令**。**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T16:34:31.233

我几乎可以保证你的连接字符串有：

```
User Instance=true;AttachDbFileName=|Data Directory|...something.mdf; 
```

如果是这种情况，请停止这样做。AttachDbFileName 功能实际上会创建数据库文件的*副本*。因此，您在 Management Studio 或 Visual Studio 中打开的那个与您的应用程序通过连接字符串创建的那个不同。您的应用程序从副本中删除，没有例外（因为它有效），您刷新原始应用程序，看起来它不起作用。

在此处查看@marc_s 的答案：

[https://stackoverflow.com/a/7222952/61305](https://stackoverflow.com/a/7222952/61305)

如果不是这样，那么我怀疑（a）由于某处错误被忽略`try/catch`，或者（b）您检查命令是否有效的方法是可疑的。例如，如果您依赖计数，并且 where 子句匹配零行，则该命令*有效*，但它没有删除任何内容，因此计数保持不变。

如果这些都不正确，那么转到我的答案的第 1 行。这里没有魔法，删除命令要么影响 0 行或多行，要么返回异常。其他任何事情都只能通过不正确的故障排除/调试来解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T16:39:50.573

鉴于此原始代码（通过我的格式）：

```
SqlCommand cmd = new SqlCommand(
   @"DELETE FROM table_name 
     WHERE item_id=" + itmIDs + 
         " AND vendor_id=" + vendIDs + 
         " AND dozen=" + selectedItmDzn + 
         " AND quantity=" + selectedItmQty + 
         " AND total_price=" + selectedItmTotPrc + "",
   con);
cmd.ExecuteNonQuery(); 
```

让我们将其更改为：

```
string deleteQuery = 
   @"DELETE FROM table_name 
     WHERE item_id=" + itmIDs + 
         " AND vendor_id=" + vendIDs + 
         " AND dozen=" + selectedItmDzn + 
         " AND quantity=" + selectedItmQty + 
         " AND total_price=" + selectedItmTotPrc + "";
SqlCommand cmd = new SqlCommand(deleteQuery, con); /* set a breakpoint here */
cmd.ExecuteNonQuery(); 
```

设置断点并将该查询复制粘贴到此处的注释中，以便我们可以看到它。**

# python - 如何使用 PIL (Python Image Library) 旋转图像并让黑色背景透明

> ID：11937985
> 
> 赞同：12
> 
> 时间：2012-08-13T15:59:27.103
> 
> 标签：python, python-imaging-library

我想旋转一个灰色的“测试”图像并将其粘贴到蓝色背景图像上。现在我可以在旋转我的灰色“测试”图像后去除黑色，但它们现在是白色部分。如何使用 Python 将“白色”颜色部分更改为蓝色？

这是我的代码，有人可以帮助我吗？我会很感激的。

```
dst_im = Image.new("RGBA", (196,283), "blue" )
im = src_im.convert('RGBA')
rot = im.rotate( angle, expand=1 ).resize(size)
f = Image.new( 'RGBA', rot.size, (255,)*4 )
im2 = Image.composite( rot, f, rot )
im2.convert(src_im.mode)
im2_width, im2_height = im2.size
cut_box = (0, 0, im2_width, im2_height )
paste_box = ( left, top, im2_width+left, im2_height+top )
region = im2.crop( cut_box )
dst_im.paste( region, paste_box )
dst_im.save("test.gif") 
```

![在此处输入图像描述](../Images/8e5d2a7fe77c0644fc62c5424524b69e.png)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-13T16:44:52.410

我的印象是您的代码可以简化如下：

```
from PIL import Image

src_im = Image.open("winter3.jpg")
angle = 45
size = 100, 100

dst_im = Image.new("RGBA", (196,283), "blue" )
im = src_im.convert('RGBA')
rot = im.rotate( angle, expand=1 ).resize(size)
dst_im.paste( rot, (50, 50), rot )
dst_im.save("test.png") 
```

这给出了以下结果：

![在此处输入图像描述](../Images/2ced6761ec8a5c9fec5823ef57a18200.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T05:20:45.240

使用 PIL 的另一个答案显然更简洁。我有一个类似的问题，并将图像放在一个 ndarray 中。是的，我的比user1202136更复杂。我发布它只是因为它演示了另一个使用 numpy 和数组堆叠的解决方案，但 user1202136 的解决方案要好得多。

```
 import matplotlib.pyplot as plt
    import numpy as np
    import scipy.ndimage 

    def rgba(rgb_img, alpha):
        '''
        ' takes an rgb ndarray r x c x 3 of dtype=uint8
        ' and adds an alpha 0-255 to each pixel
        '''
        rows = len(rgb_img)                                # get image dimensions
        columns = len(rgb_img[0])
        rgb_flat = rgb_img.reshape([rows * columns, 3])    # list of rgb pixels
        a = np.zeros([rows*columns, 1], dtype=np.uint8)  # alpha for each pixel
        a.fill(alpha)
        rgba = np.column_stack([rgb_flat, a])              # place 4th column
        return rgba.reshape([rows, columns, 4])           # reform into r x c x 4

    def pad_with_transparent_pixels(rgba_img):
        '''
        ' takes an rgba image r x c
        ' and places within a buffer of [ 0 0 0 0] to become square,
        ' with sides = diagonal of img
        '''
        rows = len(rgba_img)                                # get image dimensions
        columns = len(rgba_img[0])
        diag = (rows**2 + columns**2)**0.5
        diag = int(diag) + 1
        top_pad_height = (diag-rows)/2 + 1
        left_pad_width = (diag-columns)/2 + 1
        top_pad = np.zeros([top_pad_height, diag, 4], dtype=np.uint8)
        left_pad = np.zeros([rows, left_pad_width, 4], dtype=np.uint8)
        right_pad = np.zeros([rows, 
                              # assures total width of top_pad for row_stack:
                              diag - left_pad_width - columns, 
                              4 ], 
                             dtype=np.uint8)
        center = np.column_stack([left_pad, rgba_img, right_pad])
        return np.row_stack([top_pad, center, top_pad])

    def clean_rotate(rgba_img,angle):
        rows = len(rgba_img)
        columns = len(rgba_img[0])
        diag = (rows**2 + columns**2)**.5
        diag = int(diag)
        pad_img = pad_with_transparent_pixels(rgba_img)
        rot_img = scipy.ndimage.rotate(pad_img, angle)
        rot_img_rows = len(rot_img)
        rot_img_columns = len(rot_img[0])
        crop_side = max(1,(rot_img_columns - diag) / 2) #max to avoid splicing [:0]
        crop_top = max(1,(rot_img_rows - diag) / 2)
        print diag, crop_side, crop_top
        return rot_img[crop_top:-crop_top,crop_side:-crop_side]

    img = plt.imread('C:\\Users\\bbrown\\Desktop\\Maurine.jpg') # read in a jpg

    figure, axes = plt.subplots(1, 2)              # create 1x2 grid of axes
    axes[0].imshow(img)                            # place image on first axes
    rgba_image = rgba(img, 255)                      # create an opaque rgba image
    rot_img = clean_rotate(rgba_image,50)

    #make a pattern of 10 images
    for i in range(10):
        rot_img = clean_rotate(rgba_image,5*i)
        axes[1].imshow(rot_img)
        plt.show() 
```

# java - 每次按下“写入”按钮时如何将字符串行写入文件

> ID：11937993
> 
> 赞同：0
> 
> 时间：2012-08-13T16:00:00.873
> 
> 标签：java, io, save, java-io, read-write

这是我的代码。当我按下按钮时，它只能在文件中写入一行，但是，如果我用一组新字符再次按下它，它只会删除旧字符并存储新的字符集。我不知道如何让它在每次按下按钮时在不同的行中写入字符而不删除其他行

```
package datasaving;

import java.awt.HeadlessException;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import javax.swing.*;

public class Datasaving {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        JPanel panel = new JPanel();
        JFrame frame = new JFrame();
        final JTextField input = new javax.swing.JTextField(20);

        JButton save = new javax.swing.JButton("Write");

        frame.add(panel);
        frame.setSize(200,200);
        panel.add(input);
        panel.add(save);

        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        frame.setVisible(true);

        save.addActionListener(new ActionListener() {
                            @Override
                            public void actionPerformed(ActionEvent e) {
                                 File file = new File("data.dat");

    try {
            try (FileWriter writer = new FileWriter(file)) {

                writer.write(input.getText()+"\n");

            }
        System.out.println("Game saved");
    } catch (IOException | HeadlessException z) {
        JOptionPane.showMessageDialog(null, e);
    }

                            } 
                        });

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:02:56.240

您需要`FileWriter`通过构造函数设置附加..

```
FileWriter writer = new FileWriter(file, true) 
```

[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T16:06:17.753

哇，在一个声明中发生了很多事情。这不是我最喜欢的处理方式，但这不是你的问题.. :-) 当你创建一个新的 FileWriter 时，它会创建一个新文件，所以你只能看到一行文本。

看看 API - FileWriter 有一个构造函数，它接受一个布尔值来决定是否追加。你想用它来代替。

另一种选择是打开文件一次，然后每次按下都写入它。如果您希望在每次写入时打开/关闭文件，那么使用另一个 ctor 是更好的方法。

# asp.net-mvc - 如何测试这个 ASP.NET MVC 代码？

> ID：11937994
> 
> 赞同：3
> 
> 时间：2012-08-13T16:00:08.633
> 
> 标签：asp.net-mvc

我正在努力测试以下代码。考虑到它没有作为 Web 请求的一部分运行，我需要模拟什么才能使其正常工作？我得到的当前异常是“在应用程序的预启动初始化阶段无法调用此方法”

```
public void Handle(HttpContextBase ctx)
{
    RequestContext rc = ((MvcHandler)ctx.CurrentHandler).RequestContext;
    IControllerFactory factory = ControllerBuilder.Current.GetControllerFactory();
    IController controller = factory.CreateController(rc, "home");
    var cc = new ControllerContext (rc, (ControllerBase)controller);
} 
```

请任何帮助将不胜感激。

# php - PHP - 使用 GD 裁剪图像，并将生成的图像居中到背景上

> ID：11937995
> 
> 赞同：1
> 
> 时间：2012-08-13T16:00:17.370
> 
> 标签：php, image, gd, image-manipulation, crop

我正在尝试制作一个简单的应用程序，它为用户提供标准的背景/模板图像，他们可以在上面放置他们的徽标/品牌/任何东西。我查看了一些允许用户上传和裁剪图像的 jQuery 插件，它们中的大多数似乎通过将 x 和 y 坐标以及宽度和高度发布到服务器来工作。

然后我可以使用 imagecopyresampled() 将图像与背景图像合并，但是 (a) 用户的图像似乎最终真的偏斜，即使我对我知道应该工作的尺寸进行硬编码，并且 (b)我需要将上传的图像定位在几乎死点的中心——实现这一目标的最佳方法是什么？

有什么帮助吗？这是我第一次使用GD。如果需要，我会添加我自己的代码，但是我搞乱了不同的 GD 函数，所以我已经把我之前的那个删掉了。会重现它。

谢谢