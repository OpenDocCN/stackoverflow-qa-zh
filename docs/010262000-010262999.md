# StackOverflow 问答 10262000-10262999

# ios - 从 NSString 返回数字

> ID：10262001
> 
> 赞同：0
> 
> 时间：2012-04-21T18:58:23.917
> 
> 标签：ios, iphone, ipad, nsstring

我有这样的 NSString：@“text 932”。

我如何从这个字符串返回数字。数字总是在字符串的末尾，但我不能使用 stringWithRange，因为数字没有恒定的长度。所以我正在寻找更好的方法。

我也想知道如何从@“text 3232 text”这样的字符串中返回数字。我也不知道号码的位置。

有什么函数可以在字符串中找到数字吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:43:08.347

这是一个适用于两个字符串的解决方案

```
NSString *myString = @"text 3232 text";

//Create a scanner with the string
NSScanner *scanner = [NSScanner scannerWithString:myString];

//Create a character set that includes all letters, whitespaces, and newlines
//These will be used as skip tokens
NSMutableCharacterSet *charactersToBeSkipped = [[NSMutableCharacterSet alloc]init];

[charactersToBeSkipped formUnionWithCharacterSet:[NSCharacterSet letterCharacterSet]];
[charactersToBeSkipped formUnionWithCharacterSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];

[scanner setCharactersToBeSkipped:charactersToBeSkipped];
[charactersToBeSkipped release];

//Create an int to hold the number   
int i;

//Do the work
if ([scanner scanInt:&i]) {

    NSLog(@"i = %d", i);
} 
```

的输出`NSLog`是

```
i = 3232 
```

# 编辑

处理小数：

```
float f;

if ([scanner scanFloat:&f]) {

   NSLog(@"f = %f", f);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T01:49:39.050

**更新：**
更新以测试是否匹配，并处理负数/十进制数

```
NSString *inputString=@"text text -9876.234 text";
NSString *regExprString=@"-{0,1}\\d*\\.{0,1}\\d+";
NSRegularExpression * regex = [NSRegularExpression regularExpressionWithPattern:regExprString options:NSRegularExpressionCaseInsensitive|NSRegularExpressionDotMatchesLineSeparators error:nil];
NSRange rangeOfFirstMatch=[regex firstMatchInString:inputString options:0 range:NSMakeRange(0, inputString.length)].range;
if(rangeOfFirstMatch.length>0){
    NSString *firstMatch=[inputString substringWithRange:rangeOfFirstMatch];
    NSLog(@"firstmatch:%@",firstMatch);
}
else{
    NSLog(@"No Match");
} 
```

**原文：** 这是一个使用正则表达式的解决方案：

```
NSString *inputString=@"text text 0123456 text";
NSString *regExprString=@"[0-9]+";
NSRegularExpression * regex = [NSRegularExpression regularExpressionWithPattern:regExprString options:NSRegularExpressionCaseInsensitive|NSRegularExpressionDotMatchesLineSeparators error:nil];
NSString *firstMatch=[inputString substringWithRange:[regex firstMatchInString:inputString options:0 range:NSMakeRange(0, inputString.length)].range];
NSLog(@"%@",firstMatch); 
```

输出为：0123456

如果你想要一个实际的整数，你可以添加：

```
NSInteger i=[firstMatch integerValue];
NSLog(@"%d",i); 
```

输出是：123456

# iphone - 一个应用程序可以调用另一个应用程序然后返回结果吗？

> ID：10262002
> 
> 赞同：3
> 
> 时间：2012-04-21T18:58:47.057
> 
> 标签：iphone, ios, ipad, interop

我知道可以使用 openURL 方法从应用程序中启动另一个应用程序。如果该应用程序可以打开该 URL，也可以使用 canHandleURL 检查。

但是有没有办法调用一个应用程序，让它做一个计算然后返回结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T19:21:14.440

看看[这里](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-working-with-url-schemes/)（例如如何向被调用的应用程序发送文本）

在您的情况下：假设您有 2 个应用程序（app1 和 app2）和 2 个 url 方案（`protocolThatCallsApp1://`和`protocolThatCallsApp2://`）

在您的 app1 中，您使用 app2 调用 app2，`protocolThatCallsApp2://` 然后在 app2 中进行计算并使用 app1 调用，然后`protocolThatCallsApp1://+yourCalculations`进行所需的解析以在 app1 中获取结果

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T19:02:19.557

第二个应用程序应该使用相同的机制 ( `openURL`) 来调用第一个应用程序。

Facebook sdk 使用这种方法来实现[单点登录](http://developers.facebook.com/docs/mobile/ios/build/#implementsso)：

> 如果应用程序在支持多任务处理的 iOS 版本中运行，并且设备安装了 3.2.3 或更高版本的 Facebook 应用程序，SDK 会尝试在 Facebook 应用程序中打开授权对话框。在用户授予或拒绝授权后，**Facebook 应用程序重定向回调用应用程序**，并传递授权令牌、过期时间和 Facebook OAuth 服务器可能返回的任何其他参数。

# javascript - Jquery 互连滑块

> ID：10262003
> 
> 赞同：0
> 
> 时间：2012-04-21T18:58:49.020
> 
> 标签：javascript, jquery, jquery-slider

我想创建通用的 jquery ui 滑块，这样如果我传递任何数字，它应该返回我那个数量的互连滑块。

如果我滑动任何 1 个滑块，它应该会改变其他滑块。但是，所有滑块的总和在任何时候都必须始终为 100。

我自己尝试了它，它正在工作，但是一旦滑块的值超过 50，并且您尝试增加另一个滑块，那么所有滑块的总和就会大于 100。

[这](http://jsfiddle.net/rRtAq/6874/)是我的代码的链接。

任何人都可以帮助我吗？谢谢'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T21:59:38.693

我已经为一个客户项目完成了这项工作，并开源了我的解决方案。它使用 noUiSlider 代替 jQuery UI Sliders，但如果你想修改它，也不会太难。它还没有完全完善，我意识到这个问题已经有一年了，但以防万一有人想要它：

Github：[jQuery 互连滑块](https://github.com/gburtini/jquery-interconnected-sliders)

它支持锁（允许您设置一个值，然后不再移动它），它看起来像这样：[screenshot](http://i.stack.imgur.com/WZbhV.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T18:54:36.627

啊，你把我丑陋的CSS当作你的jsfiddle。我尝试做完全相同的事情，看看这个： [3 jquery ui slider connected](https://stackoverflow.com/questions/10270976/3-jquery-ui-slider-connected)

# javascript - 如何使用 Jquery 编辑元素的样式属性

> ID：10262010
> 
> 赞同：0
> 
> 时间：2012-04-21T18:59:44.730
> 
> 标签：javascript, jquery

我需要用 jQuery 编辑样式属性。这是我想要做的。

我有一个 div

```
<div style="background:url('images/image.png') no-repeat scroll 0 0 transparent;color:red;">
hello
</div> 
```

我需要将其更改`background`为其他类似`image2.png`

我怎么能用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:02:51.967

使用[`.css()`](http://api.jquery.com/css/)：

```
$('div').css('background', 'url(images/image2.png)') 
```

要设置整个背景字符串，可以使用属性映射：

```
var cssObj = {
  'background-image': 'url(images/image2.png)',
  'background-repeat': 'no-repeat',
  'background-attachment': 'scroll',
  'background-position': '0 0',
  'background-color': 'transparent'
}
$('div').css(cssObj); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:10:56.877

```
$(function(){
   var cssObj = {
      'background-image' : 'url(http://www.mousescrappers.com/forums/xperience/icons/teacups24.png)',
      'background-repeat' : 'no-repeat',      
    }
   $("div").css(cssObj);
}); 
```

上面的脚本在准备好的文档上加载图像。请注意，它会为所有 Div 加载。所以你最好更具体地了解元素（使用 Id 或 class 作为选择器）

示例[http://jsfiddle.net/XsRuC/9/](http://jsfiddle.net/XsRuC/9/)

# c - LIST_HEAD_INIT 和 INIT_LIST_HEAD 之间的区别

> ID：10262017
> 
> 赞同：9
> 
> 时间：2012-04-21T19:00:43.343
> 
> 标签：c, linux-kernel, linked-list

我正在尝试了解 Linux 内核链表 API。

根据[Linux Kernel Linked List](http://isis.poly.edu/kulesh/stuff/src/klist/)，我应该初始化列表头，`INIT_LIST_HEAD`但[在这里（Linux Kernel Program）](http://www.roman10.net/linux-kernel-programminglinked-list/) 建议使用它`LIST_HEAD_INIT`。

这是我编写的工作代码，但我不确定我是否以正确的方式完成了它。有人可以验证它没问题吗？

```
#include <stdio.h>
#include <stdlib.h>
#include "list.h"

typedef struct edge_attr {
        int d;
        struct list_head list;
} edge_attributes_t;

typedef struct edge {
        int id;
        edge_attributes_t *attributes;
} edge_t;

int main () {
        int i;
        struct list_head *pos;
        edge_attributes_t *elem;
        edge_t *a = (edge_t*)malloc(sizeof(edge_t));

        a->id = 12;
        a->attributes = (edge_attributes_t*) malloc(sizeof(edge_attributes_t));

        INIT_LIST_HEAD(&a->attributes->list);

        for (i=0; i<5; ++i) {
                elem = (edge_attributes_t*)malloc(sizeof(edge_attributes_t));
                elem->d = i;
                list_add(&elem->list, &a->attributes->list);
        }

        list_for_each(pos, &(a->attributes->list)) {
                elem = list_entry(pos, edge_attributes_t, list);
                printf("%d \n", elem->d);
        }

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-22T04:21:18.573

`LIST_HEAD_INIT`是一个静态初始化器，`INIT_LIST_HEAD`是一个函数。他们都将 a 初始化`list_head`为空。

如果您静态声明 a `list_head`，则应使用`LIST_HEAD_INIT`，例如：

```
static struct list_head mylist = LIST_HEAD_INIT(mylist); 
```

您应该使用`INIT_LIST_HEAD()`动态分配的列表头，通常是另一个结构的一部分。内核源码中有很多例子。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-21T19:26:44.913

快速[LXR](http://lxr.linux.no/#linux+v3.3.2/include/linux/list.h#L24)搜索显示：

```
#define LIST_HEAD_INIT(name) { &(name), &(name) }

static inline void INIT_LIST_HEAD(struct list_head *list)
{
        list->next = list;
        list->prev = list;
} 
```

因此`INIT_LIST_HEAD`获取 a`struct list_head *`并对其进行初始化，同时`LIST_HEAD_INIT`以合适的方式返回传递的指针的地址，以用作列表的初始化程序：

```
struct list_head lst1;
/* .... */
INIT_LIST_HEAD(&lst1);

struct list_head lst2 = LIST_HEAD_INIT(lst2); 
```

# javascript - 使用字段中的查询字符串重定向的简单表单

> ID：10262020
> 
> 赞同：0
> 
> 时间：2012-04-21T19:00:57.057
> 
> 标签：javascript, django, forms, redirect, query-string

在学习 django 的过程中，我正在复习我的 HTML，并且想要创建一个表单（单个字段和按钮）。该按钮在按下时应重定向到将表单中的值作为查询字符串的页面。例如，如果用户输入“test”，然后按下按钮，他们应该被重定向到“webpage.com?test”。

我认为最好的方法是使用 javascript 是否正确？如果是这样，有人介意提供一个例子吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:04:41.480

```
document.forms[0].addEventListener('submit', function() {
    window.location.href = 'webpage.com?fieldname='
                           + document.getElementById('yourfieldid').value;
}, false); 
```

因为您没有发布任何代码，所以我只是在页面上采用了第一个表单并找到了一个虚构字段用作查询字符串参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:05:47.707

您可以直接使用 javascript 进行重定向：

```
 location.href = "webpage.com?" + your_variable 
```

或者制作一个针对webpage.com 的表单，其中有一个名为test 的输入区域。这样，当它提交时，测试值将自动添加到 url。

当您单击按钮更改该值并提交表单时：

```
$('#button').click(function() {
 $('#your_test_field').val(your_variable);
 $('#your_form').submit();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-28T12:00:56.827

```
window.location.href="mypage.php?arg="+variable 
```

# java - 适应静态类进行修改的安全有效的方法

> ID：10262021
> 
> 赞同：0
> 
> 时间：2012-04-21T19:01:14.247
> 
> 标签：java

我正在调整用 Java 编写的模拟。我有限的背景都是C++。

模拟的当前实现依赖于一个名为`Parameters`. 类的实例`Simulation`引用 的属性`Parameters`，我认为它从未被实例化。该类`Parameters`具有类似的结构

```
public class Parameters {
  public static int day = 0;
  public static final int endDay = 365;
  ....
  public static int getDate() {
    return day;
  }
} 
```

在 的一个实例中`Simulation`，有对例如 的引用`Parameters.day`。

目前， 的所有属性`Parameters`都是硬编码的。我需要能够使用命令行参数更改其中的一些。例如，我希望能够`endDay`使用`Parameters::setEndDay(int customDay)`某种函数来设置不同的值。

我的第一个想法是创建一个实例 ( `Parameters parameters = new Parameters()`) 并完全重写`Parameters`该类，使其所有属性都是私有的，并且只能通过访问器函数访问。**我担心这种方法效率不高。**到目前为止，我已经尝试了一种混合方法，在该方法中我创建了一个`Parameters`类的实例，然后我将它传递给一个实例，`Simulation`同时仍然偶尔引用`Parameters.day`（我不需要更改）。

问题之一是我对 Java 中的类权限没有很好的认识。

建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:04:34.883

`Simulation`如果你让它们都不是最终的，那么你可以在实例化类之前直接从你的命令行参数中设置它们：

```
// read command-line arguments

Parameters.endDay = 123; // this will change all reference to Parameters.endDay
new Simulation(...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:06:15.477

`setEndDay(int customDay)`在`Parameters`类中创建静态方法。而且您可以在不使用 class not object: 的情况下更改值`Parameter.setEndDay(10)`。请注意，`endDay`变量应该是非最终的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:21:02.253

## 访问静态成员变量与实例化对象

本质上，这是在全局数据或本地数据之间进行选择。一个类变量（关键字静态）存在于您的整个应用程序的一个地方。例如，您不能在同一个应用程序中同时运行两个参数化（尽管您可以并行或顺序运行两个应用程序）。使用实例化对象，您可以拥有多个包含不同值的 Parameter 对象。

## 访问器方法与可访问的成员变量

There are some controversy around this. Schoolbooks usually state that all data should be encapsulated using accessor methods to protect the objects internal state. It is however as you state slightly less efficient and there are cases where making member variables directly accessible is considered good practice.

## Java Access Modifiers

Java supports four different access modifiers for methods and member variables.

*   **Private**. Only accessible from within the class itself.
*   **Protected**. Can be accessed from the same *package* and a subclass existing in any *package*.
*   **Default** (no keyword). Only accessible by classes from the same *package*.
*   **Public**. Accessible from all classes.

# python - 协助将矩阵乘以常数的幂

> ID：10262023
> 
> 赞同：0
> 
> 时间：2012-04-21T19:01:26.023
> 
> 标签：python, algorithm, matrix, numpy

下面我提供了我正在尝试开发的这个程序的所有代码。这需要作为输入的是一个 N x 3 文件；我将在下面提供我使用的示例（它只是一个 5x3 示例）。每个样本代表图像中像素的一个坐标，该坐标已使用多维缩放缩放到某个 XYZ 坐标。该程序的目的是从 XYZ 坐标到 LaB 颜色...然后被翻译成sRGB。下面的代码（第二部分）显示了从 XYZ 到 LaB 的转换，而上半部分（标记为 Fast XYZ - RGB）是我发现从 XYZ 到 RGB 的捷径，去掉了 LaB 步骤。问题在于 Fast XYZ - RGB 步骤。

我想做的是使 sRGBmat = (1 + val) * RGBLin ^ (1/2.4) - val

我一直遇到的问题是 RGBLin 有时可能是负数……这意味着我必须使用 Cmath 或其他东西。我尝试使用 Cmath，但它给了我不正确的值 - 在 MatLab 中，它给了我一个正确的数字（以及一个实数 + 虚数部分），我仍然可以使用它。

文件 xyztest.txt 包含具有以下值的 5x3 矩阵：

```
.2345   .9817   .7612
.5465   .7897   .3514
.7796   .6765   .5645
.1221   .6376   .8790
.5432   .5853   .4652 
```

输出应该（通过更多计算）产生一个 N x 3 矩阵，其中每一行代表第 1 行的像素 1-n 处的 RGB 值（对于前 n 个值），然后是第 2 行代表下一个 n +1 值-

任何帮助将不胜感激！

```
import numpy as np
d=open('xyztest.txt', 'r')
import cmath

a=[]
count = 0
b = []
AoverAn = []
XoX = []
YoY = []
ZoZ = []
aova=[]
c = 0
while 1:
    line = d.readline()
    a.append(line.split())
    count = count + 1
    if not line:
        break
#print a #contains all of the line elements in a list
t=[]
XYZM = []

illuminant = [94.9423, 100.0000, 108.7201]
##or is it [ .9424, 1.000, .8249] which is in matlab-

#print count
for i in range(count-1):
    b = a[i:(i+1)]
    #print "this is", b
    c = b[0]
    x = c[0]
    y = c[1]
    z = c[2]
    XoverXn = round(float(x) /illuminant [0], 10)
    YoverYn = round(float(y) / illuminant [1], 10)
    ZoverZn = round(float(z) / illuminant [2], 10)
    XoX.append(XoverXn)
    YoY.append(YoverYn)
    ZoZ.append(ZoverZn)
    x.replace('\'', '')
    mmaker = (float("".join(x)), float("".join(y)), float("".join(z)))
    XYZM.append(mmaker)

L = []
a = []
b = []
fXoX = []
fYoY = []
fZoZ = []
Lab = []

##print "YOUR XYZ MAT", XYZM
##Get an XYZ matrix so i can use fast XYZ to RGB 
```

快速 XYZ > RGB

```
##A is the thing we want to multiply
A= np.matrix('3.2410, -1.5374, -0.4986 ;-.9692, 1.8760, 0.0416 ; .0556, -.2040, 1.0570')

##we get [R,G,B]' = A * [X,Y,Z]'
##Must be in the range 0-1 
RGBLin=[]
##XYZM = float(XYZM)
print "XYZ"
print XYZM
xyzt = np.transpose(np.matrix(XYZM))
RGBLin = np.transpose(A * xyzt)

val = 0.555
temp = (RGBLin <= 0.00304)
#print temp

print "RGB"
##print RGBLin
## Do power multiplcation because numpy doesnt want to work for non square mat
for i in range(len(RGBLin)):
    for j in range(1):  
        rgbline = RGBLin[i].tolist()
        for item in rgbline:
            for i in range(3):
                print item[i]
                item[i] = 1.055 + item[i+1]**(1/2.4)
                print item[i]
            print item
        #print rgbline
        #te[i][j] = pow(RGBLin[i][j] , (1./2.4))
#print te 
```

-> 问题出在这一步，我试图将矩阵取为 (1/2.4) 的幂，但矩阵的某些值是负数 - 我如何让 python 给我一个值？？！

```
#te = pow(RGBLin, (1./2.4)) 
```

XYZ -> 实验室

```
for i in range(len(XoX)):
    #print YoY[i]

    xyz = []

    test = float(pow(YoY[i],(1./3)))
    #print test
    if (YoY[i] > 0.008856):
        L.append((116 * (YoY[i] **(1./3))) - 16)               
        #L1 = (116 * (YoY[i] **(1./3))) - 16
    else:
        L.append(903.3* YoY[i])
        #L1 = 903.3* YoY[i]
    ##    
    if (XoX[i] > 0.008856):
        fXoX.append(pow(XoX[i], (1./3)))
        #A1 = pow(XoX[i], (1./3))
    else:
        fXoX.append((7.787 * XoX[i])+(16/116))
        #A1 = (7.787 * XoX[i])+(16/116)
    ##   
    if (YoY[i] > 0.008856):
        fYoY.append(pow(YoY[i], (1./3)))
        #B1 = pow(YoY[i], (1./3))
    else:
        fYoY.append((7.787 * YoY[i])+(16/116))
        #B1 = (7.787 * YoY[i])+(16/116)
    ##
    if (ZoZ[i] > 0.008856):
        fZoZ.append(pow(ZoZ[i], (1./3)))
        #Z1 = pow(ZoZ[i], (1./3))
    else:
        fZoZ.append((7.787 * ZoZ[i])+(16/116))
        #Z1 = (7.787 * ZoZ[i])+(16/116)
    ##

    a.append(500*(fXoX[i]-fYoY[i]))
    b.append(500*(fYoY[i]-fZoZ[i]))
    xyz.append((L[i], a[i], b[i]))
    ##print xyz
######### NOW we must go from Lab to RGB, where XYZ is the LaB co-ordinates###### 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:12:08.343

告诉 numpy 你的数字很复杂。

```
In [1]: import numpy as np

In [2]: r = np.array([-5, 2, 8, -1])

In [3]: r ** (1/2.4)
/usr/local/share/python3/ipython3:1: RuntimeWarning: invalid value encountered in power
   #!/usr/local/Cellar/python3/3.2.2/bin/python3.2
Out[3]: array([        nan,  1.33483985,  2.37841423,         nan])

In [4]: c = r.astype(complex)

In [5]: c ** (1/2.4)
Out[5]: 
array([ 0.50609696+1.88877958j,  1.33483985+0.j        ,
        2.37841423+0.j        ,  0.25881905+0.96592583j]) 
```

[在 scipy.org 上](http://www.scipy.org/NegativeSquareRoot)有一些讨论。

# javascript - 删除文本区域的初始值“”

> ID：10262028
> 
> 赞同：0
> 
> 时间：2012-04-21T19:01:49.477
> 
> 标签：javascript, html, prototypejs, textarea

我想删除文本区域中的初始空间。当没有给文本区域的文本并且您获得 textarea.value 时，您将获得一个空格“”，而不是像普通输入文本框那样的空字符串。此外，当有文本（即测试）时，它会返回“测试”。是否可以防止这个额外的空间？我更喜欢使用 Textarea 的原型，因为我使用通用过程来获取输入文本框和 textarea 的值。

目前我写了这样的东西：

```
Textarea.prototype.value = function() {
        var val = this.value;
        if (val[0] == "0") val.splice(0,1);
        return val;
    }; 
```

但这并没有解决问题，我仍然获得了额外的空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T19:06:31.990

你的 HTML 应该是这样的：

```
<textarea></textarea>
---------^ no space, tab or new line there 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-21T19:07:37.177

只需确保开始标签和结束标签之间没有空格，例如以下错误：

```
<textarea> </textarea> 
```

或者

```
<textarea> 
         </textarea> 
```

正确的：

```
<textarea></textarea> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T19:08:24.087

“ \b” 将导致“”。因此，您可以将字符串与 \b 连接以消除字符串的最后一个字符

# java - Android上的菜单按钮问题

> ID：10262030
> 
> 赞同：0
> 
> 时间：2012-04-21T19:01:52.327
> 
> 标签：java, android, xml

我正在尝试使用手机上的菜单按钮，但由于某种原因它不起作用？没有错误，但是当我按下菜单时它什么也不做。我正在运行 2.3.3 Android 模拟器。

这是我的活动：

```
public boolean onCreatOptionsMenu(Menu menu){

MenuInflater Inflater = getMenuInflater();
Inflater.inflate(R.menu.main_menu, menu);
return true;
}
@Override
public boolean onOptionsItemSelected(MenuItem item){
    switch (item.getItemId()){          
        case R.id.MenuClass:
            startActivity (new Intent ("com.clayton.calendar.TOCLASS"));
    return true;

    case R.id.MenuFriends:
        startActivity (new Intent ("com.clayton.calendar.TOFRIENDS"));
    return true;

    default:
    return super.onOptionsItemSelected(item);

}
} 
```

这是我的 XML：

```
<item
    android:id="@+id/MenuClass"
    android:title="Open Classes"/>
<item
    android:id="@+id/MenuFriends"
    android:title="Open Friends"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:12:42.883

试试这个：

```
@Override
public boolean onCreateOptionsMenu(Menu menu){
    MenuInflater Inflater = getMenuInflater();
    Inflater.inflate(R.menu.main_menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item){
    switch (item.getItemId()){          
        case R.id.MenuClass:
            startActivity (new Intent ("com.clayton.calendar.TOCLASS"));
            return true;

        case R.id.MenuFriends:
            startActivity (new Intent ("com.clayton.calendar.TOFRIENDS"));
            return true;

        default:
            return super.onOptionsItemSelected(item);
    }   
} 
```

（不要把它放在`onCreate()`方法中）

# jquery - jQuery - 我的滑块需要一个限制器

> ID：10262037
> 
> 赞同：0
> 
> 时间：2012-04-21T19:02:28.287
> 
> 标签：jquery, slideshow

[你可以在这里](http://nbvfx.net/_test_js/)看到我从 jquery == >开始

我用 vimeo-videos 制作了一个简单的幻灯片。如果您单击向上/向下箭头，我的`<ul>`-List 会上下移动。`<li><</li>`但是，如果最后一个视频 ( ) 已经到达，我怎么能停止移动。我需要一个 If/else 条件，但我不知道如何..

某事。像这样，如果我最后一次`<li>`到达，请停止添加 80px 和 return.false() ..

我的页面上有几次这些幻灯片，有时我有 2 个视频，3 个、4 个或 15 个 .. 所以我需要一个通用的解决方案 ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:17:53.393

滚动 80px 可能不是我会做的方式，但使用你的方法，试试这个：

```
<script type="text/javascript">
// vimeo videos
$(document).ready(function(){
    $(".mediagallery").mediaGallery({autoplay:1});

// scroll action
$('#mediagallery_down').click(function() {
    var pos = $('#med_list_cont').css("top").replace("px", "");
    if (pos <= 0 )
        $('#med_list_cont').css("top", parseFloat(pos) + -80 +"px");
});

$('#mediagallery_up').click(function() {
    var pos = $('#med_list_cont').css("top").replace("px", "");
    if (pos >= ($('#med_list_cont').height() - $('#mediagallery_list').height()))
    {
        $('#med_list_cont').css("top", parseFloat(pos) + 80 +"px");
    }
});

});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:11:29.950

```
if($('ul li').last()){
  $(this).stop().animate({'margin-top':'80px'}, function(){
    return false;
  });

}else{
  // all other list items. 
  // Normal stuff here.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T06:16:01.637

是的 offset(); 这就是我需要的提示。谢谢

```
jQuery('#mediagallery_down').click(function() {

     if(jQuery('#med_list_cont li:last').offset().top <= 790)
                    jQuery(this).fadeOut('fast');
    var pos = jQuery('#med_list_cont').css("top").replace("px", "");
    jQuery('#med_list_cont').css("top", parseFloat(pos) + -80 +"px");

});

jQuery('#mediagallery_up').click(function() {
        jQuery('#mediagallery_down').show();
 if(jQuery('#med_list_cont li:first').offset().top >= 464)
               return false;    

var pos = jQuery('#med_list_cont').css("top").replace("px", "");
    jQuery('#med_list_cont').css("top", parseFloat(pos) + 80 +"px");

}); 
```

# jquery - 在 jQuery 中为函数指定目标

> ID：10262038
> 
> 赞同：0
> 
> 时间：2012-04-21T19:02:46.650
> 
> 标签：jquery, animation

我想在鼠标悬停时为某些导航按钮触发多个动画。我想在一个函数中指定所有动画和参数，并在鼠标悬停在该按钮上时为每个按钮调用它。到目前为止，我只能将它应用于按钮的所有实例。我尝试在函数中使用“（this）”，但它不起作用。

```
<script type="text/javascript">
    $(document).ready(function(){
        function navmouseover1() {
            $(this).animate({ left:"+=10",top:"+=10",width:"-=20px",height:"-=20px",opacity:1 },100 );   
        }
        $("#nav1").mouseover(function() { navmouseover1(); });
        $("#nav2").mouseover(function() { navmouseover1(); });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:04:37.490

您可以使用它，但您需要将事件绑定到您的函数，而不是将其包装在另一个函数中。例子：

```
$('#nav1').mouseover(navmouseover1); 
```

您现在遇到的问题是“this”变量正在为事件侦听器正确设置，但是，因为您随后从该事件侦听器内部调用您的函数，所以它具有不同的范围。

# android - 屏幕关闭时检查音量按钮的使用情况

> ID：10262040
> 
> 赞同：13
> 
> 时间：2012-04-21T19:02:53.317
> 
> 标签：android, button, volume

对于这个问题，我将引用另一个没有回答他们的问题的用户：

> 我编写了一个将硬件音量按钮用于其他目的的 Andoid 应用程序。
> 
> 如果应用程序正在运行并且可见，它工作正常，但是当我关闭屏幕或让它超时时，按钮点击不会进入我的处理程序。
> 
> 有谁知道屏幕关闭时是否有办法检测这些按钮点击？来源：[AV695的问题](https://stackoverflow.com/questions/10019335/detect-hardware-volume-button-clicks-when-screen-is-off)

我自己正在开发一个使用音量按钮的应用程序，但正如该用户还指出的那样，一旦屏幕关闭，使用 onKeyPress 检查按钮的正常行为就会停止工作。这是因为 Activity 在屏幕关闭时暂停。

有没有办法在屏幕关闭时保持活动运行，或者在屏幕关闭时检查音量按钮的使用情况？我之前尝试过为此使用服务，但无法像 Commonsware 所指出的那样检查音量键。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T02:09:18.253

我怀疑这在平台、内核或底层无线电固件级别是否受支持（无需使用耗尽电池的唤醒锁），而无需修改最后一个以引起内核注意睡眠期间的音量按压。

在合理的系统 ROM 修改范围内，更合理的做法可能是修改现有的开源 ROM 以使设备在电源按钮的处理中插入一些自定义平台级代码，该按钮通常用于唤醒设备以准备解锁它——至少我们知道它确实引起了内核的注意。如果有未确认的通知，该代码可以通过声音或振动通知用户。

您可以选择短暂等待、检查设备方向或寻找另一个按键以避免在用户将设备放在口袋外面并尝试解锁时以令人讨厌的方式执行此操作。

* * *

或者您不能使用音量键，只需设置一个定时器，每 15 分钟唤醒一次，并在有未确认通知时振动，避免在口袋里摸索。

* * *

您提到这是一个自定义请求：如果暗示它是一个关闭或小批量，另一个需要考虑的选择是一些供应商使用 SDK 提供“蓝牙手表”，让您从 android 设备推送通知。

如果您可以在通知生成时捕获通知，则可以将其推送到用户的手腕上，然后让手机重新进入睡眠状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T22:09:39.017

当您的应用程序在后台时，您不能拦截密钥，而是收听 KeyPress 本身。您可以注册一个 ContentObserver，[如此问题](https://stackoverflow.com/questions/6896746/android-is-there-a-broadcast-action-for-volume-changes)中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-23T02:00:42.787

正如 Chris Stratton 所提到的，让您的应用程序保持活力的唯一方法是使用耗电的唤醒锁。

然而，由于我发现自己处于同样的情况，我想出了另一个解决方案。不幸的是，您需要有根设备以及 Xposed 框架。

使用 Xposed 替代了 zygot 进程，因此您可以将自己挂接到系统的任何构造函数和方法中，您将能够在系统处理原始 KeyEvent 之前捕获它们。

这是在 PhoneWindowManager.interceptKeyBeforeQueueing() 中完成的。通过使用 XC_MethodHook，您可以在上述方法上使用 beforeHookedMethod() 来捕获每个硬件按钮事件，即使设备处于深度睡眠状态。

捕获您感兴趣的事件后，您可以创建一个临时唤醒锁来做您的事情，但不要忘记在完成工作后释放唤醒锁。

如何实现这一点的一个很好的例子是[Xposed Torch](http://repo.xposed.info/module/ma.wanam.torch)模块。但是，如果您依赖无根系统，那么坏消息是，如果不耗尽电池就不可能......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-28T18:37:49.950

我还尝试在我的应用程序中实现音量按钮按下检测，一旦核心部分完成，我就将该部分留待以后开发。即使手机被锁定，我也能够从后台服务检测到屏幕开启时的音量键按下。

Background Video Recorder 2 (BVR2)（也可能是 BVR1，我没有尝试过）是即使在屏幕关闭时也可以检测音量键按下的应用程序之一。在我的应用程序中尝试在屏幕关闭时实现音量键检测时，我安装了 BVR2，希望能找到它的工作原理。令我惊讶的是，即使屏幕关闭，它也让我的应用程序能够检测到音量键。我的应用程序有一个 ContentObserver 来监控音量变化，但在屏幕关闭时无法正常工作。当 BVR2 处于活动状态时，我的应用程序还可以在屏幕关闭时检测到音量键按下。还在挖。

但是 BVR2 有自己的触发动作，即录制视频，您可能不希望发生这种动作，只是为了让您的应用程序检测到音量键按下。

另一个应用程序是 QuickClick。这个应用程序可以为您的应用程序提供它所缺乏的功能，即使在屏幕关闭时也可以检测音量键按下，而无需额外的不必要的操作。只需安装 QuickClick，无需配置任何操作。创建一个`ContentObserver`来监控流体积变化，你就准备好了。即使屏幕关闭，您的应用程序现在也能够检测到音量键按下。

请注意，我的应用程序作为后台服务运行。

上面提到的两个应用程序都用于其他用途，但使用音量键检测来执行操作。我绝不会连接到提到的任何应用程序。

如果这些应用程序（可能还有其他几十个应用程序）可以检测到音量键按下，则可以完成。我要求专家找出如何做到这一点，以便我们可以在我们的应用程序中实现而不依赖另一个应用程序。

如果您觉得这个答案有用，请投票。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-26T22:38:10.247

我不确定它是否像这样简单，但请查看这个 android 博客：

[允许应用程序相互播放 nice(r)：处理遥控器按钮](http://android-developers.blogspot.com/2010/06/allowing-applications-to-play-nicer.html)

它解释了接收上/下音量控制和其他音乐控制的广播接收器的用法。

总之，您应该使用[registerMediaButtonEventReceiver](http://developer.android.com/reference/android/media/AudioManager.html#registerMediaButtonEventReceiver%28android.content.ComponentName%29)

# jquery - jQuery init 函数返回其父对象

> ID：10262053
> 
> 赞同：2
> 
> 时间：2012-04-21T19:04:02.480
> 
> 标签：jquery, object, slideshow

我正在尝试实现一些非常基本的东西。我正在使用一个公开可用的 jQuery 模块（称为[幻灯片](http://slidesjs.com/)），但我需要以某种方式修改它，以便我可以从外部控制对象。

现在像这样初始化时：

```
$('#myDivId').slides({
    preload: false,
    generatePagination: false
}); 
```

这一切都有效，但我没有看到稍后访问幻灯片对象的任何方法。像这样：

```
var slideshow=$('#myDivId').slides({
    preload: false,
    generatePagination: false
}); 
```

现在我希望能够做这样的事情：

```
slideshow.animate('next'); 
```

可变*幻灯片*的内容不是实际对象。我认为这与 jQuery 的工作方式有关。

一旦这工作，我将能够对幻灯片进行更具体的调用，从而使其在我的“前端使用环境”中正常工作。

现在我想要的是要返回的实际生成的对象，或者至少在返回的数据中额外可用。

谁能在这里指出我正确的方向？

**[单击此处查看 jsFiddle 中的演示](http://jsfiddle.net/dwUtY/)**

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:48:46.323

function `slides()` `($.fn.slides)` is a jQuery method. in jQuery, jQuery.fn or $.fn is the prototype object for all jQuery objects. If you add a function to this object, that function becomes a jQuery method.

* * *

for using variable as an jQuery object, you should do this:

```
var obj = $("#myDivId") // now obj, is a jquery object 
```

and you can use jquery object methods this way:

```
obj.slides(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T12:52:52.853

使用 jQuery 的触发方法，我能够模拟幻灯片中某些元素的行为，从而找到一种不需要调用父对象上的任何方法的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:05:46.493

> 一旦这工作，我将能够对**幻灯片进行更具体的调用**，从而使其在我的“前端使用环境”中正常工作。

嘿看... [https://github.com/nathansearles/Slides/blob/master/source/slides.js#L123](https://github.com/nathansearles/Slides/blob/master/source/slides.js#L123)

这对你有帮助吗？

```
/*
Method Calls - The good stuff
============================================================

Play:
    $("#slides").slides("play");

Pause:
    $("#slides").slides("pause");

Stop:
    $("#slides").slides("stop");

Next:
    $("#slides").slides("next");
        - Uses default effect

    $("#slides").slides("next","fade");
        - Define effect, "slide" or "fade"

Previous:
    $("#slides").slides("previous");
        - Uses default effect

    $("#slides").slides("previous","fade");
        - Define effect, "slide" or "fade"

Goto a slide
    $("#slides").slides("slide",2);
        - Goto slide 2 using default effect

    $("#slides").slides("slide",4,"fade");
        - Define effect, "slide" or "fade"

Update:
    $("#slides").slides("update");
        - Rebuilds pagination 

Destroy:
    $("#slides").slides("destroy");
        - Removes SlidesJS, returns to predefined state

Status:
    $("#slides").slides("status");
        - Returns JSON object:
            {
                current: 4,
                state: "playing",
                total: 7
            }

    $("#slides").slides("status","current");
        - Returns current slide number

    $("#slides").slides("status","state");
        - Returns playing, paused, or stopped

    $("#slides").slides("status","total");
        - Returns total slides in slideshow
*/ 
```

如果这不是您想要做的，您可以随时查看示例[http://slidesjs.com/](http://slidesjs.com/)或报告问题[https://github.com/nathansearles/slides/issues](https://github.com/nathansearles/slides/issues)以获得更具体的信息帮助或要求新功能。如果您想要做的事情不是由插件处理，您必须请求该功能或编辑插件代码（提示：第一个答案更好）

# mysql - 是否可以插入一行，但前提是值已更改？

> ID：10262055
> 
> 赞同：0
> 
> 时间：2012-04-21T19:04:12.927
> 
> 标签：mysql

我已经读过这个：

[仅当值已更改时，如何插入数据库？](https://stackoverflow.com/questions/3781501/how-do-i-insert-into-a-database-only-if-a-value-has-changed)

所以我的问题非常接近，但并不完全相同。

我有一个包含 4 个“主”列的表（即我的所有表上都有这 4 个相同的列）：

*   `id`- int - autoinc
*   `id_origin`- int - 创建第一条记录时的 id
*   `date_v_start`- datetime - 记录有效期的开始日期
*   `date_v_end`- 日期时间 - 记录的有效期结束（如果`NULL`它是当前的“有效”记录）

以下是此表特有的一些其他字段： - `summary`- 文本 - `detail`- 文本

知道了这一点，当我将某些东西更改为该表时，这就是我所做的：

*   我`date_v_end`将当前记录更新为“now()”
*   我插入一条新记录，其中`date_v_start`=`date_v_end`前一个，`id_origin`= 与前一个相同，- `date_v_end`=`NULL`和（当然）新值`summary`and `detail`。

我的问题是，如果`summary`and的值`detail`没有改变，我不想插入新记录，这是浪费时间和硬盘空间。

有没有办法（如果可能的话，一次性）像：

“如果`summary<>'a value' or detail<>'another value' then update this record and insert this new one`”

?

所以，我的问题和我上面提供的链接之间的区别是： - 有多个字段要比较 - 有两个请求 - 如果可能，我想在一个请求中进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T09:17:32.467

以下是我在一个“php 查询”= 一个中间带逗号的字符串中的做法（这非常耗时，但如果我的网络服务器无法再处理它，我会在某一天更改它）：

```
CREATE TEMPORARY TABLE tmp
SELECT * FROM table
WHERE id=:id;
ALTER TABLE tmp drop ID;
INSERT INTO table
SELECT 0,tmp.* FROM tmp;
DROP TABLE tmp:
UPDATE table
SET date_v_fin=NOW()
WHERE id=LAST_INSERT_ID(); 
```

# php - 当 php 代码没有达到 release-mysql-lock 阶段时会发生什么？

> ID：10262063
> 
> 赞同：3
> 
> 时间：2012-04-21T19:05:07.863
> 
> 标签：php, mysql

例如，使用此脚本；

```
mysql_query("LOCK TABLES mytest WRITE;");

for ($i = 1; $i < 100000; ++$i) {
    mysql_query("INSERT INTO mytest (Value, Value2, Value3) VALUES ($i, $i, $i);");
}

mysql_query("UNLOCK TABLES;"); 
```

如果脚本超时/用户计算机崩溃/在`UNLOCK TABLES`到达阶段之前发生什么？mysql会“注意到”请求锁的客户端已断开连接并适当地释放锁，还是会无限期地卡住？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-21T19:07:48.377

根据[MySQL](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)文档：

> 如果客户端会话的连接终止，无论是正常还是异常，服务器都会隐式释放会话持有的所有表锁（事务性和非事务性）。如果客户端重新连接，锁将不再有效。

# algorithm - 基于统计/模式问题的算法

> ID：10262064
> 
> 赞同：3
> 
> 时间：2012-04-21T19:05:08.610
> 
> 标签：algorithm, math, statistics, pattern-matching

我有一组设备，每个设备都有时间列表 T 表示设备何时打开，例如

设备 A : [周一 16:03, 周一 15:59, 周三 16:05, ... n]

我正在检测使用模式，例如第二天一个人以平均 T+/-5 分钟打开开关，该时间与平均 T 值之间可能存在很强的联系。我们可以说有一种模式，它可以随着时间的推移而建立起来。如果有一天没有值（开关没有打开），即。错过那么信心就会降低。一个问题是需要考虑一天丢失的数据。我们可以说，如果置信度低于阈值，则不存在模式。

我创建了一个简单的工作版本（不考虑失误），但我更感兴趣的是更伟大的头脑会考虑评估和检测是否每天发生事件的最佳方法。我认为这是最好的地方，因为我对一种优雅而美丽的方法很感兴趣。是否存在更好的统计模型来计算出这样的模式？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T19:16:21.210

要尝试的一件相当明显的事情是生成时序数据的功率谱（使用 fft）并寻找显着的峰值。如果您有第 1 天的信号，那么您知道每天都在发生某些事情；如果你也有一个周期为 7 天的信号，那么你就知道有一个每周的组成部分——也许他们在周末没有相同的行为。

这是一种经典的定量方法。你也可以尝试使用更现代的、非结构化的方法——也许训练神经网络以某种方式识别模式？并且没有理由不将这些结合起来 - 功率谱可能会提供参数（周期），用于以更结构化的形式将数据呈现给网络（例如，通过以适当的周期取模）。

最后，我也会做一个文献搜索，看看其他人做了什么。与谷歌一起玩，似乎“时间模式检测”将是一个合适的阶段。

ps 另外，我会将变化的检测与模式的检测分开。首先，我将致力于检测模式。只有当它运作良好时，我才会考虑将其扩展到“每天早 5 分钟”等。部分原因是从简单开始更好，但也因为我不相信这样的更正很重要。大多数人不会每天提前 5 分钟做某事，否则他们最终会在晚上很忙……我们天生就是周期性的，所以我会首先寻找周期，并且只有在有证据表明它们很重要时才考虑线性变化.

pps 统计仅用于评估特定假设的证据。它更多的是关于模式匹配/模式检测，您可能会通过添加这些标签获得更多回复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T19:16:28.383

根据您的定义，如果事件*e*每 24 小时在 10 分钟间隔内发生，并且概率高于给定阈值，则存在模式。这类似于[日出问题](http://en.wikipedia.org/wiki/Sunrise_problem)。在您的情况下，布尔每日事件不是日出，而是事件*e*在预期间隔内的发生。

事件*e*明天发生的概率，可以根据[继承规则](http://en.wikipedia.org/wiki/Rule_of_succession)计算出来。根据您的定义，如果此值高于给定阈值 - 存在模式。

# svn - 使用提交时禁止访问存储库 '/dir/!svn/act/b724faeb-c0a7-c144-9f2e-9e2e9c882cfc'

> ID：10262065
> 
> 赞同：1
> 
> 时间：2012-04-21T19:05:20.850
> 
> 标签：svn

我在 Windows 的命令行（DOS）上使用 svn，因为 svnTortoise 不在我的系统上。

我已经使用 C:/>svn [https://dir.svn.application.com从存储库下载了文件](https://dir.svn.application.com)

并在目录中进行了更改。现在，当我要使用提交文件时

`C:/dir/application/lib>svn commit`
我得到了错误`Access to repository '/dir/!svn/act/b724faeb-c0a7-c144-9f2e-9e2e9c882cfc' forbidden.`

# java - cron 谷歌电子表格

> ID：10262066
> 
> 赞同：-1
> 
> 时间：2012-04-21T19:05:32.583
> 
> 标签：java, google-app-engine, cron, google-docs, google-sheets

我对 Cron Jobs 了解不多，但我希望它能解决我网站的问题。

我在 Google App Engine (Java) 上设置了一个应用程序，其中嵌入了已发布的 google 电子表格 (html)。

但是，自从有人访问该站点已有一段时间后，该站点需要很长时间才能加载（“加载 docs.google.com”）。

我可以在谷歌应用引擎上安排 cron 定期访问我发布的电子表格吗？（我不知道怎么做，但我希望这是可能的）。还是有其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:14:32.287

是的。您可以部署一个 cron.xml 文件来执行此操作。[https://developers.google.com/appengine/docs/java/config/cron](https://developers.google.com/appengine/docs/java/config/cron)

# prolog - 在 Prolog 中测试处理列表

> ID：10262070
> 
> 赞同：0
> 
> 时间：2012-04-21T19:05:54.787
> 
> 标签：prolog

我希望它像这样工作，然后`d`消失等。

```
?- remove_last_item([a,b,c,d], L).    
L = [a, b, c] ? 
```

有谁知道如何做到这一点，因为我得到了这条线，但是我应该添加什么其他线，这样
才能实现上述目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:17:38.390

通常，在 Prolog 中，要理解问题，就必须已经有了答案。所以你需要定义一个谓词，`remove_last_item(A,B)`这样`B`就`A`没有最后一项。那么Prolog*中的列表是什么？*就像在 Lisp 中一样，它是在对的顶部递归定义的，带有特殊符号 - 空列表 - 表示“列表结束”。

这意味着什么？一对, `'.'(A,B)`, 显然有两个部分。然后将该列表`[a,b,c,d]`编码为`'.'(a,'.'(b,'.'(c,'.'(d,[]))))`. 这也可以写成`[a|[b,c,d]]`, or `[a,b|[c,d]]`, or `[a,b,c|[d]]`, or `[a,b,c,d|[]]`。这`a`是列表的所谓“头”和`[b,c,d]`“尾”或“其余” `[a,b,c,d]`。

所以现在我们只需从最简单的情况开始写下我们想要谓词说的内容：

```
remove_last_item([_A],[]).
remove_last_item([A|B],[A|C]):- B=[_|_], remove_last_item(B,C). 
```

它写道，“从单例列表中删除最后一项会给我们留下一个空列表；从多个元素的列表中删除最后一项意味着从列表的其余部分中删除最后一项，在它的头部之后”。

***编辑：***另一种看待它的方式是“从顶部开始”：写下谓词必须遵循的一些等效“法则”：

```
remove_last_item(L,R):- is_list(L), is_list(R), same_head(L,R),
                        tail(L,L1), tail(R,R1), 
  remove_last_item(L1,R1). 
```

我们仍然不*“知道”*什么`remove_last_item` *“做什么”*，我们只是写了一个它必须遵循的等效定律，对吧？但随后它就变成了我们所追求的定义本身。充实所有暗示性的名字，它变成了（熟悉的）

```
remove_last_item(L,R):- L=[A|L1], R=[A|R1], remove_last_item(L1,R1). 
```

所以现在我们可以将其识别为列表的[*结构递归*](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29)，只需添加一个终止子句，为其添加一些“实质”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:13:02.893

```
?- append(L, [_], [a,b,c,d]). 
```

观察它`[_]`表示具有单个任意元素的列表，因此该查询询问“当我们将单个元素列表附加到它时，`L`会给出哪个列表？”`[a,b,c,d]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:40:28.307

另一种方法是让 prolog 进行递归.. 这表示'查找列表中列表项的索引不等于列表最后一项的索引的所有项（其索引与长度相同名单）。（无论如何使用 nth1 时.. nth0 不起作用...

```
rli(List, Res) :-
    length(List, Y),
    findall(Item, (nth1(Idx, List, Item), not(Idx =:= Y)), Res). 
```

# ios - IOS：处理nsstring

> ID：10262079
> 
> 赞同：1
> 
> 时间：2012-04-21T19:07:29.420
> 
> 标签：ios, xcode, nsstring

我有两个问题：

第一的：

我有一个 NSSTring 作为 @"abcdef\n" ，我想从这个字符串中删除 "\n"，我该怎么办？

第二：

如果我有一个字符串为@“abcdef \n”，我不知道长空格是多少，但我只想要这个nsstring的文本

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:11:49.230

[@"abcdef\n" stringByReplacingOccurrencesOfString:@"\n" withString:@""];
[@"abcdef \n" stringByReplacingOccurrencesOfString:@" " withString:@""];

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:11:36.970

只需将所有出现的 \n 替换为空字符串，如下所示：

```
myString = [myString stringByReplacingOccurrencesOfString:@"\n" withString:@""]; 
```

# java - JMock - 如何模拟控制台输出

> ID：10262080
> 
> 赞同：0
> 
> 时间：2012-04-21T19:07:31.303
> 
> 标签：java, junit, jmock

这篇文章类似于：[this](https://stackoverflow.com/questions/10256119/jmock-how-to-automate-mock-out-console-user-input)

我有一个控制台应用程序，它需要用户输入和响应式用户输出。我正在为它编写一些单元测试以确保代码正常工作。我需要能够确保它的输出和输入是我期望的。

本质上，我有一个正在测试的主要方法，它要求提供文件或输入。在我的测试中，我使用`System.setOut`and`System.setIn`将它们分别设置为 PrintStream 和 InputStream 对象的 context.mock 版本。`System.out.println`在我必须测试程序数据的实际处理并将其结果输出到控制台时，我才关心进行了哪些调用。所以总结一下：

这是我正在测试的来源（接近的东西，我修剪了很多）：http: [//ideone.com/rptC0](http://ideone.com/Tmh1M)

这是我在模拟过程中的内容：http: [//ideone.com/VkvqM](http://ideone.com/QnL2a)

这是我得到的例外：[ideone.com/OEOS8](http://ideone.com/OEOS8)

正如您在我的期望中清楚地看到的那样，我明确表示我计划打印完全相同的字符串，并且我在我的期望中指定了这一点。但是例外说这是出乎意料的。我不明白...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:06:16.580

JMock 希望您使用`context.checking()` *然后*调用被测代码来声明期望，*然后*调用`context.assertIsSatisfied()`（尽管有时如果使用适当的测试运行程序，最后一步是隐式完成的）。

您似乎`context.assertIsSatisfied()`在运行任何代码之前立即调用。

`mn`此外，您发布的代码使用了似乎未定义的变量- 这实际上是您正在运行的代码吗？还是应该`mockIn`改为该变量？

**更新**：好的，问题可能是您正在尝试模拟静态方法 - JMock 不支持这一点 - 请参阅[jmock mocking a static method](https://stackoverflow.com/questions/218813/jmock-mocking-a-static-method)。请特别参阅 JMock 的作者之一 Steve Freeman 的回答。

**更新 2**：我会尝试这样的事情，在 @Before 设置中设置期望：

```
@Before
public void setMinimalMockingExpectations() throws IOException
{
    oldIn = System.in;
    oldOut = System.out;
    pipe = new PipedOutputStream();
    testIn = new PipedInputStream(pipe);
    mockOut = context.mock(PrintStream.class);
    System.setOut(mockOut);
    System.setIn(testIn);

    expectQuestion();
}

private void expectQuestion()
{
    Expectations exp = new Expectations()
    {
        {
            one(mockOut).println(main.QUESTION);
        }
    };
    context.checking(exp);

}

@After
public void reset()
{
    System.setIn(oldIn);
    System.setOut(oldOut);
}

@Test
public void fileChoiceReturnsFalse() throws IOException
{
    String FILE = "F\n";
    pipe.write(FILE.getBytes());

    assertFalse(main.promptStringOrFile());

    context.assertIsSatisfied(); // can avoid this call by using the right
                                    // test runner
} 
```

并创建两个类似的测试来检查输入“I”和任何其他输入的行为（问题应该重复一次）。

如果您使用而不是担心字符，该`promptStringOrFile()`方法可能会更清晰。`BufferedReader.readLine()`

# css - CSS 媒体查询和 !important

> ID：10262082
> 
> 赞同：12
> 
> 时间：2012-04-21T19:07:34.133
> 
> 标签：css, media-queries

我有一个使用@media 查询的网站，但似乎没有设置它们。他们始终保持默认样式。

例如：

```
#div1 { background:red}

@media screen and (max-height:912px) {
#div1{background:blue}
} 
```

将始终坚持使用**背景：红色**，除非我使用`!important`但在我的媒体查询中，我设计了这么多选择器。我需要设置每个选择器样式`!important`吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-01-24T20:32:17.327

我有同样的问题。我意识到媒体查询必须在样式表的末尾（即使您在工作流程中使用/导入多个文件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T21:52:38.103

将最大高度更改为最小高度：http: [//jsfiddle.net/jnQYb/](http://jsfiddle.net/jnQYb/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T19:32:27.177

这对我来说可以。

看一下：http: [//jsfiddle.net/TUL6h/1/](http://jsfiddle.net/TUL6h/1/) - 背景是红色的，但是当您更改结果部分高度时，它会在某个点变为蓝色。

你在尝试什么浏览器？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-31T09:51:43.133

查看 //jsfiddle.net/TUL6h/55/ 中的示例：您需要更改媒体查询的顺序。最大高度：510px；包括最大高度：500px；它必须排在第一位，以便完全显示 500px 蜜蜂的更特殊情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T13:30:34.987

不一定，**!important**用于覆盖默认css，即覆盖默认样式中使用的属性。因此，如果媒体查询中有新属性，您不必同时使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-23T00:10:44.313

在 @media 查询中包含的代码中使用 !important 是向页面元素添加动态样式属性的有效方法，同时保持“默认”css 不变以便于维护。

例子：

```
<html>
    <head>
    <style>
    @media all and (max-width: 768px) {

    /* CSS styles targeting screens of smaller sizes and/or resolutions (IE phones and tablets)  */

        #semantically-named-element p 
        { width: 60% !important;
        background: rgba(0,0,255,1)!important;
        margin: auto !important; }

        #semantically-named-element span 
        { display: none !important; }

    } 
    /* Look ma no media queries needed for default CSS below! Very easy to discern default styles, when the default code is the stuff not wrapped in queries. Period. */    

    /* Default CSS style attributes for any viewports that do not fit into the low or high resolution/screen size parameters set above and below. Also the fallback for browsers that still disregard CSS media queries */  
    #semantically-named-element p 
        { width: 90%;
          background: rgba(255,0,0,1);
          margin: auto; }

    #semantically-named-element span 
        { display: block;
          background: rgba(0,0,0,0.8);
          color: #FFF;
          text-align: center;}  
    @media all and (min-width: 968px) {
    /* CSS styles targeting very large or very high resolution viewports at the 769 pixels wide "break-point" */
        #semantically-named-element p 
        { width: 80% !important;
        background: rgba(0,255,0,1)!important;
        margin: auto !important; }

        #semantically-named-element span 
        { display: block !important;
        background: rgba(0,0,0,0.8)!important;
        color: #FFF !important; font-size: 200%; }
    }
    </style>
  </head>

  <body>
      <div id="semantically-named-element">  
        <p> Usage of !important inside of the code contained within your @media queries is an effective way to add dynamic style properties to your pages elements, while leaving your 'default' css intact for easy maintenance.<span>hidden until tablet greater 768 viewport pixel width</span></p>
      </div>  
   </body>
</html> 
```

# css - 将 div 向左浮动和 div 居中而不在调整大小时重叠

> ID：10262084
> 
> 赞同：2
> 
> 时间：2012-04-21T19:07:38.887
> 
> 标签：css, positioning, css-float, html, resize

我正在寻找一个 div 左对齐（Div 1）和一个 div 对齐中心（Div 2）。

当用户调整窗口大小时，居中的 div (Div 2) 应保持居中，直到碰到 Div 1 的边缘。
Div 2 (居中的 div) 不应总是靠左停靠，除非 Div 1 (left div) 的宽度加上Div 2 的一半宽度大于浏览器宽度的一半。

关于在没有 javascript 的情况下实现这一点的任何想法？

[![以图像为例](../Images/b03609f768f9e32398da2eca336e494d.png)](https://i.stack.imgur.com/1VLLj.jpg)

这是一个工作示例：http: [//jsfiddle.net/pjg8D/9/](http://jsfiddle.net/pjg8D/9/)

```
<div id="fixedBar">
    <div id="div1"></div>
    <div id="div2"></div>
</div>

<!-- http://i42.tinypic.com/iqv5tu.jpg --> 
```

```
#fixedBar {
    height: 50px;
    width: 100%;
    background: #f99;       

}

#div1 {
    width: 200px;
    height: 50px;
    background: green;
    float: left;
}

#div2 {
    width: 100px;
    height: 50px;
    margin: 0 auto;
    background: blue;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:42:01.173

该问题的解决方案是`min-width`在容器 div 上使用。此宽度的比率计算如下：( Div1 宽度 + Div2 宽度的一半) x 2。

解决方案在这里：http: [//jsfiddle.net/pjg8D/16/](http://jsfiddle.net/pjg8D/16/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:12:47.470

你需要给左边的 div 一个`%`宽度，然后给右边的 div 一个`left-margin`相同的宽度`%`。试试这个：

```
#div1 {
    width: 25%;
    height: 50px;
    background: green;
    float: left;
}

#div2 {
    width: 250px;
    height: 50px;
    margin: 0 0 0 25%;
    background: blue;
} 
```

[**更新的小提琴**](http://jsfiddle.net/pjg8D/13/)

# sql-server - 如何使用 vb.net 代码将 PDF 文件保存在 SQL Server 列中

> ID：10262087
> 
> 赞同：1
> 
> 时间：2012-04-21T19:07:49.127
> 
> 标签：sql-server, vb.net

如何使用 vb.net 代码通过内存流将 PDF 文件保存在 SQL Server 列中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T06:06:17.443

谢谢你！！！我现在的解决方案是：

```
public void SaveFile()
{
    //Try
    OpenFileDialog fd = new OpenFileDialog();
    fd.Filter = "pdf file|*.pdf";
    if (fd.ShowDialog == System.Windows.Forms.DialogResult.OK) {
        //PdfDocument1.FilePath = fd.FileName

        byte[] filebyte = null;
        SqlConnection con = new SqlConnection("Data Source=LOCALHOS-A4AE79\\LOCALHOST1;Initial Catalog=library_alborz;Integrated Security=True");

        SqlCommand cmd = default(SqlCommand);

        filebyte = System.IO.File.ReadAllBytes(fd.FileName);

        cmd = new SqlCommand("Insert into pdftbl ( pdffld ) Values(@pdf)", con);
        //cmd.Parameters.Add("@filepath", SqlType.VarChar).Value = txtfilepath.Text
        cmd.Parameters.Add("@pdf", SqlDbType.Binary).Value = filebyte;
        con.Open();
        cmd.ExecuteNonQuery();
        con.Close();
        Interaction.MsgBox("File saved into database", MsgBoxStyle.Information);
        //Catch ex As Exception
        //    MsgBox(Err.Description, MsgBoxStyle.Exclamation)
        //End Try

    }
}

------------
// load pdf file

private void Button2_Click(System.Object sender, System.EventArgs e)
{
    string strsql = null;
    SqlConnection con = new SqlConnection("Data Source=LOCALHOS-A4AE79\\LOCALHOST1;Initial Catalog=library_alborz;Integrated Security=True");
    SqlDataAdapter da = new SqlDataAdapter();
    DataSet ds = new DataSet();

    try {
        strsql = "select pdffld from  pdftbl ";
        da = new SqlDataAdapter(strsql, con);
        da.Fill(ds, "tbl");

        //Get image data from gridview column.
        byte[] pdfData = Convert.ToByte(ds.Tables["tbl"].Rows[0][0]);

        //Initialize pdf  variable

        //Read pdf  data into a memory stream
        using (MemoryStream ms = new MemoryStream(pdfData, 0, pdfData.Length)) {
            ms.Write(pdfData, 0, pdfData.Length);

            //Set pdf variable value using memory stream.
            PdfDocument1.Load(ms);
            PdfPageView1.Document = PdfDocument1;
            PdfPageView1.Refresh();

        }

    } catch (Exception ex) {
        MessageBox.Show(ex.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T19:16:17.000

首先，您的数据库表中必须有类型为 varbinary(MAX) 的列。它允许您在其中保存字节数组。

接下来，您可以使用这样的代码行将 PDF 文件的内容作为字节数组获取：

```
IO.File.ReadAllBytes("C:\my.pdf") 
```

# gwt - CssResource 中定义的 CSS 的问题

> ID：10262089
> 
> 赞同：0
> 
> 时间：2012-04-21T19:07:55.880
> 
> 标签：gwt

我在使用 UiBinder 和 CssResource 显示 CSS 时遇到了一些问题：

```
public interface Resources extends ClientBundle {

    @NotStrict
    @Source("style.css")
    Style style();

    @Source("logo.png")
    ImageResource logo();
}

public interface Style extends CssResource {
    @ClassName("orange")
    public String orange();
} 
```

如果我将这样的 CSS 与 UiBinder 一起应用：

```
styleName="{res.style.orange}" 
```

它不起作用，尽管`.orange`这里的 CSS " " 规则已经过全面测试以正确呈现。

我在 UiBinder 中定义了这样的资源：

```
<ui:with field='res' type='com.mygwtapp.client.Resources'/> 
```

如果我把它放在例如：

```
<g:Image resource='{res.logo}'/> 
```

它可以工作，显示徽标图像但 CSS 不起作用。是否有任何其他我错过的过程或方法导致 CSS 不被呈现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:12:32.837

你必须调用`ensureInjected()`你的`CssResources`.

UiBinder 会自动为 a 执行此操作`ui:style`，但不会为`CssResources`您*通过*`ui:with`.

# java - Java GridBagLayout 布局问题

> ID：10262090
> 
> 赞同：1
> 
> 时间：2012-04-21T19:07:56.740
> 
> 标签：java, swing, layout, gridbaglayout

似乎一切都向中心挤压，但我不知道为什么。这是我的代码。我尽量让它易于阅读。

```
import java.awt.Component;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import javax.swing.DefaultComboBoxModel;
import javax.swing.DefaultListModel;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JTextField;

/**
 *
 * @author rubixibuc
 */
public class RulesWindow extends JFrame {

    public GridBagLayout layout = new GridBagLayout();
    public GridBagConstraints constr = new GridBagConstraints();
    public DefaultComboBoxModel modelE = new DefaultComboBoxModel();
    public DefaultComboBoxModel modelA = new DefaultComboBoxModel();
    public DefaultListModel modelL = new DefaultListModel();

    public RulesWindow()
    {
        super("Rules Window");
        /* layout for window
        |_P_|__E__|_T_|__A__|_a_|
        |                   |xxx|
        |                   |xxx|
        |                   |xxx|
        |_________L_________|_M_|
         X = no fill
         P = pattern field
         E = extension combobox
         T = target action
         A = action combobox
         a = add rule
         M = remove rule
         L = rule list
        */

        setLayout(layout);

        JTextField P = new JTextField(); // 0,0,1,1 
        JComboBox E = new JComboBox(modelE); // 1,0,2,1
        JTextField T = new JTextField(); // 3,0,1,1
        JComboBox A = new JComboBox(modelA); // 4,0,2,1
        JButton a = new JButton("+"); // 6,0,1,1
        JList L = new JList(modelL); // 1,1,6,4
        JButton M = new JButton("-"); // 6,4,1,1

        changeConstraints(0,0,1,1);
        add(P);
        changeConstraints(1,0,2,1);
        add(E);
        changeConstraints(3,0,1,1);
        add(T);
        changeConstraints(4,0,2,1);
        add(A);
        changeConstraints(6,0,1,1);
        add(a);
        changeConstraints(1,1,6,4);
        add(L);
        changeConstraints(6,4,1,1);
        add(M);

        setSize(200,200);
        setVisible(true);
        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
    }
    public final void changeConstraints(int gridx, int gridy, int gridwidth, int gridheight)
    {
        constr.anchor = GridBagConstraints.NORTHEAST;
        constr.fill = GridBagConstraints.BOTH;
        constr.gridx = gridx;
        constr.gridy = gridy;
        constr.gridwidth = gridwidth;
        constr.gridheight = gridheight;
    }
    @Override
    public final Component add(Component comp)
    {
        layout.setConstraints(comp, constr);
        super.add(comp);
        return comp;
    }
} 
```

提前致谢。我在评论中绘制了它应该是什么样子的图表。

我调用重写方法的方式也是正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:38:03.123

每当我在这里

> 似乎一切都向中心挤压，但我不知道为什么

与 GridBagLayout 相关，我问 weightx 和 weighty 约束在哪里？

所以一个可能的快速解决方案：记住将 GridBagConstraints weightx 和 weighty 字段设置为合理的值（您可以将其默认为 1.0 以开始然后使用它们）。

# asp.net-mvc - 如何将节点添加到动态节点提供程序？

> ID：10262092
> 
> 赞同：0
> 
> 时间：2012-04-21T19:08:11.123
> 
> 标签：asp.net-mvc, asp.net-mvc-sitemap

我已经通过在 SiteMap 文件的 mvcSiteMapNode 中指定节点提供程序名称来实现动态节点提供程序，并且它工作正常。但是，我只想在用户通过身份验证后添加动态节点。原因是我想访问 HttpContext.User.Identity，以便我可以按 user.Identity 过滤节点。

因此，我已经删除了 SiteMap 文件中的 mvcSiteMapNode，而是在 Action 方法中调用 GetDynamicNodeCollection 方法（一旦用户经过身份验证），并且节点正在被用户过滤。这也按预期工作。

我的问题：获得节点后，如何将它们添加到 SiteMapNodeCollection 以便它们显示在从 ActionResult 返回的视图中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T22:01:17.337

这可能是 SiteMapNodeVisibility 提供者的工作，而不是 DynamicNodeProvider 的工作。

原因是节点的缓存。

# javascript - 如何使用 ajax 调用实现页面浏览量计数？

> ID：10262093
> 
> 赞同：0
> 
> 时间：2012-04-21T19:08:14.383
> 
> 标签：javascript, analytics, visitors

假设我的网站上有许多不同的资源，并且我想计算每个资源的页面浏览量。当然，我可以只增加每个请求，但是 1）我只想要独特的视图 2）我不想作弊。

因此，我想到的想法是通过 ajax 调用批准页面视图。而且不是简单的，而是棘手的。用户应该在客户端进行一些工作，我应该检查该工作服务器端的结果，并且只有在用户做对的情况下才增加视图。我认为它应该是一些带有“后门”的加密功能，用于快速服务器检查。但是我对这种加密货币的经验几乎为零，并且不知道这种东西是否存在。

谢谢关注。ps 随意告诉我是否应该去监狱、疯人院或 6 年级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:24:06.340

该算法的名称是HashCash（[官方网站](http://hashcash.org "官方网站")）。由于移动计算机的处理能力与静态计算机的处理能力存在较大差异，因此在实际使用中存在局限性。因此，由于不同设备上的内存访问速度差异不大，因此应该阅读“内存绑定拼图”（[链接）。](http://www.cs.jhu.edu/~sdoshi/index_files/fulltext.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:21:23.190

我不会为所有这些客户端工作而烦恼。客户端代码在用户手中，用户知道它是如何工作的，并且可以重放代码来执行工作。

我建议对用户的环境进行一些限制。就像不允许来自同一 IP 的两次投票（页面视图或其他）一样。这很容易实现并且被广泛使用。当然，恶意用户会希望通过代理进行投票，但是您可以为一个用户限制多个不同的 IP，这样如果用户表现良好，他就不会超过它。

# amazon-s3 - 浏览到特定的 S3 存储桶？

> ID：10262095
> 
> 赞同：2
> 
> 时间：2012-04-21T19:08:20.453
> 
> 标签：amazon-s3

想知道如何在普通 AWS S3 控制台中查看此 S3 存储桶？如果我浏览到下面的链接，我得到的只是一个 xml 内容列表。我想在普通 AWS 控制台中查看存储桶，以便从存储桶下载特定文件。

[http://hadoopbook.s3.amazonaws.com/](http://hadoopbook.s3.amazonaws.com/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-22T14:01:33.537

由于以下两个原因，无法直接在[AWS 管理控制台中查看](http://aws.amazon.com/console/)[Amazon S3存储桶 URL：](http://aws.amazon.com/s3/)

*   首先，您需要成为存储桶的所有者，因为*AWS 管理控制台可以方便地管理**您的**计算、存储和其他云资源 [强调我的]*；也就是说，您必须登录您的帐户才能访问与该特定帐户关联的资源，无法访问其他帐户的资源。

*   即使这将是您的存储桶，但仍然不可能，因为 AWS 管理控制台是[富 Internet 应用程序 (RIA)](http://en.wikipedia.org/wiki/Rich_Internet_application)，它广泛使用 JavaScript 来实现其功能，因此不提供 URL 可寻址资源/视图它的大部分功能（不幸的是）。这不是 RIA 限制，原则上可以放宽或补救（例如，控制台的某些部分`region`已经提供查询参数），但对于 RIA 来说通常也不是高优先级，而且据我所知不可用马上。

因此，如果它确实是您的存储桶，您需要自己通过 AWS 管理控制台浏览到它。

# .htaccess - 我的网址重写不起作用

> ID：10262099
> 
> 赞同：0
> 
> 时间：2012-04-21T19:08:36.127
> 
> 标签：.htaccess, url-rewriting

我是 htaccess 文件的第一个计时器，一直在寻找 stackoverflow 中的低谷样本，而不是什么，但似乎对我没有任何作用，我是一个菜鸟做错了什么。

我得到了下一个网址：

[http://www.example.com/index.php?page=page1]

我想重写为：

[http://www.example.com]

或者

[http://www.example.com/page1]

我将如何做到这一点，有人可以给出一个对我有用的简单的 url 重写示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:41:21.577

将其放入您的`.htaccess`文件中：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} page=(.*)
RewriteRule ^index.php /%1 [L] 
```

除此之外，请阅读有关重写 url 的 apache 文档： [http ://httpd.apache.org/docs/2.2/rewrite/](http://httpd.apache.org/docs/2.2/rewrite/)

我知道它很干，很长，很无聊，但这是值得的。

# asp.net-mvc - MVC 3 HtmlHelper 不包含扩展

> ID：10262101
> 
> 赞同：2
> 
> 时间：2012-04-21T19:08:57.437
> 
> 标签：asp.net-mvc, asp.net-mvc-3, visual-studio, razor

我得到的 HtmlHelper 不包含 LabelFor、DropDownListFor 等的扩展名。

剃刀视图可以编译，但没有设计器支持。

Rick Strahl 在这里详细介绍了这个问题：

[http://www.west-wind.com/weblog/posts/2012/Apr/14/Odd-MVC-4-Beta-Razor-Designer-Issue](http://www.west-wind.com/weblog/posts/2012/Apr/14/Odd-MVC-4-Beta-Razor-Designer-Issue)

我在 .NET 4、xp sp3 上的 VS 2010 上使用 MVC 3

我试过了：

*   网页版的 web.config appsetting
*   web.config 编译 targetframework=4
*   使用 vs 2010 命令行删除 web.pages 3.5 dll
*   重新安装 vs 2010
*   使用 vs 11 beta，同样的问题
*   在win 7上使用vs 2010

# zend-framework - realpath() open_basedir 限制生效。

> ID：10262104
> 
> 赞同：0
> 
> 时间：2012-04-21T19:09:34.270
> 
> 标签：zend-framework, vps, open-basedir

我正在尝试让我的 Zend Framework 应用程序在我的 VPS 上启动并运行。我收到此错误：

**错误**

警告：realpath() [function.realpath]：open_basedir 限制生效。

显然这在 Plesk 的默认限制中很常见，所以我相信你们中的一些人也遇到过同样的问题。

**我试过的**

在 /var/www/vhosts/DOMAIN/conf/ 中，我使用 Virtuozzo 电源面板创建了文件 vhost.conf。下面是我放在 vhost.conf 中的代码：

**尝试 1**

```
<Directory /var/www/vhosts/DOMAIN/public>
<IfModule sapi_apache2.c>
        php_admin_value open_basedir none
</IfModule>
<IfModule mod_php5.c>
        php_admin_value open_basedir none
</IfModule>
</Directory> 
```

**尝试 2**

```
<Directory /var/www/vhosts/DOMAIN/public>
    php_admin_value open_basedir none
</Directory> 
```

我还重新启动了 httpd 服务。

**文件夹结构**

我的文件夹结构如下：

```
/var/www/vhosts/DOMAIN/application
/var/www/vhosts/DOMAIN/library
/var/www/vhosts/DOMAIN/public 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:39:03.827

我认为您需要`open_basedir`为整个项目设置：

```
<Directory /var/www/vhosts/DOMAIN>
    php_admin_value open_basedir none
</Directory> 
```

您还需要设置`DocumentRoot`为：

```
DocumentRoot "/var/www/vhosts/DOMAIN/public" 
```

尽管。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:51:15.207

我遇到了同样的问题并在没有将 open_basedir 设置为 none 的情况下解决了它。您可以通过在 Linux 中使用“:”和“;”将多个路径添加到 open_basedir 在 Windows 中。因此，如果您的警告中提到“realpath”，请将“realpath”添加到您的 open_basedir 设置或“realpath”的父目录中。例如像这样：

```
php_admin_value open_basedir "/srv/www/vhosts/domain.com/httpdocs:/tmp:/usr/share/php5/" 
```

现在您的 open_basedir 配置了 3 个路径：

```
/srv/www/vhosts/domain.com/httpdocs
/tmp
/usr/share/php5 
```

在我的情况下，zend 需要上述 3 的最后一条路径才能在我的系统上运行而不会发出警告。

另请注意，是否以“/”结束路径是有区别的！如果没有“/”，所有子文件夹都将包含在 open_basedir 中。看看这里：[http ://www.php.net/manual/en/ini.core.php#ini.open-basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)

卢西安

# c# - 从 Listview 的右键菜单中删除文件夹（Windows 窗体、C#、Net）

> ID：10262107
> 
> 赞同：-1
> 
> 时间：2012-04-21T19:09:49.127
> 
> 标签：c#, visual-studio-2010, .net

我一直无法找到从 winforms 中的列表视图制作右键菜单的好例子。

我正在扫描硬盘中的文件夹，我想创建一个右键菜单。我可以将上下文菜单条拖到我的列表视图中，详细显示文件夹：文件夹名称和大小。当我右键单击时，我可以看到我的菜单。

如何添加删除所选目录及其内容的功能？另外，如何从列表视图中删除它？

我找到了从列表视图中删除文本的代码，但没有关于实际删除显示内容背后的内容的好例子！

任何代码都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T22:19:06.903

您如何在列表视图中构建数据？您可以只将路径存储在列表视图项的标记中。由于您知道如何获取列表视图中的项目以将其删除，因此您可以在删除它之前简单地访问其标记属性并运行 System.IO.Directory.Delete 方法。

# python - 代码中的 Python 条件错误

> ID：10262108
> 
> 赞同：0
> 
> 时间：2012-04-21T19:09:51.557
> 
> 标签：python, regex, command-line-arguments, fasta

我之前曾问过这个问题，试图开始使用这段代码：命令行参数需要采用 2 或 3 个参数

-s：这是一个可选参数或开关，表示用户想要剪接的基因序列（去除内含子）。用户不必提供这个（意味着他想要整个基因序列），但他确实提供了它，那么它必须是第一个参数

输入文件（带有基因）

输出文件（程序将在其中创建以存储 fasta 文件

该文件包含这样的行：

NM_001003443 chr11 + 5925152 592608098 2 5925152,5925652, 5925404,5926898,

然后我需要创建多个条件以确保输入的所有内容都是正确的，否则程序将退出：

*   用户指定不以 .genes 结尾的输入文件名
*   用户指定不以 .fa 或 .fasta 结尾的输出名称
*   用户提供少于两个或多于三个参数
*   用户的第一个参数以破折号开头，但不是'-s'
*   输入文件违反以下任何一项：

    *   第一行应以“#”符号开头
    *   每行应该正好有十列（由一个或多个空格分隔的列）
    *   第 2 列（从 0 开始计数）应为 + 或 - 符号
    *   第 8 列应该是一个制表符分隔的整数列表
    *   第 9 列应该是一个制表符分隔的整数列表，其整数与第 8 列完全相同。

我已经为此编写了代码，但其中某处存在错误。但是，我最近无法找到错误。有人可以帮我看看我的代码，看看某处是否存在错误吗？我真的很感激！！

在我的实际代码中，所有 if 语句都被标记了，但是我在这里导入它时遇到了麻烦......

```
import sys

p = '(NM_\d+)\s+(chr\d+)([(\+)|(-)])\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+,\d+,)s+(\d+,\d+,)'
e = '([(\+)|(-)])'
def getGenes(spliced, infile, outfile):
spliced = False
if '-s' in sys.argv:
    spliced = True
    sys.argv.remove('s')
    infile, outfile = sys.argv[1:]
if '.genes' not in infile:
    print('Incorrect input file type')
    sys.exit(1)
if '.fa' or '.fasta' not in outfile:
    print('Incorrect output file type')
    sys.exit(1)
if len(sys.argv[0]) < 2 or len(sys.argv[0]) > 3:
    print('Command line parameters missing')
    sys.exit(1)
if sys.argv[1] != '-s':
    print('Invalid parameter, if spliced, must be -s')
    sys.exit(1)
fp = open(infile, 'r')
wp = open(outfile, 'r')
FirstLine = fp.readline().strip()
if not FirstLine.startswith('#'):
    print ('First line does not start with #')
    sys.exit(1)
n = 1
for line in fp.readlines():
    n += 1
    cols = line.strip().split('')
    if len(cols) != 10:
        print('Lenth not equal to 10')
        sys.exit(1)
    if cols[2] != '+' or '-':
        print('Column 2 is not a + or - symbol')
        sys.exit(1)
    if cols[8] != '\t\d+':
        print('Column 8 is not a tab-separated list of integers')
        sys.exit(1)
    if cols[9] != '\t\d+' and len(cols[9]) != len(cols[8]):
        print('Column 9 in not a tab-separated list of integers with the exact same number of integers in column 8')
        sys.exit(1) 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-21T19:48:56.763

删除此块：

```
if sys.argv[1] != '-s':
    print('Invalid parameter, if spliced, must be -s')
    sys.exit(1) 
```

`sys.argv[1]`将始终不等于`'-s'`，因为如果`'-s'`存在于 argv 中，则您之前将其删除了一些行：

```
if '-s' in sys.argv:
    spliced = True
    sys.argv.remove('s') 
```

这条线

```
if len(sys.argv[0]) < 2 or len(sys.argv[0]) > 3: 
```

不检查有用的东西，并且会更频繁地触发。它检查调用脚本的名称的长度是否正好是 2 或 3 个字符。那没有意义。看起来您想检查两个文件名是否都通过了 -s 标志，仅此而已。

在这种情况下，您的意思是：

```
if not 3 <= len(sys.argv) <= 4: # len(sys.argv) - 1 is the number of parameters for the script, as sys.argv[0] is the scriptname itself 
```

如果您需要更多帮助，您必须更准确地了解观察到的不当行为。

编辑：

```
if cols[8] != '\t\d+': 
```

won't work the way you'd like it. it compares the value in cols[8] to the *literal* '\t\d+' string. You might want to learn about the `re` module. same problem in the next if line.

# jquery - 从ajax返回值的函数？

> ID：10262109
> 
> 赞同：0
> 
> 时间：2012-04-21T19:09:56.530
> 
> 标签：jquery

基本上，我尝试编写以下代码。（请注意，我是 jQuery 的新手，正在努力学习。）

```
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

<style>
    img.box:hover { opacity: 0.4; }
</style>

<script type="text/javascript">
jQuery(document).ready(function() 
{
  $(".box").click(function(event){
      $.post("./itemdrop.php", { id: "Item:1" }, function(data){
            $('#box').append(data);
         }
      );
  });

  $("li").click(function(event){
     $(".box").append("clicked");

  })
});
</script>
</head>

<body>

<div id="box">
    <img class="box" src="./img/box.jpg" width="150" height="150">
</div>

</body>
</html> 
```

它应该像这样工作：

1.  用户点击“盒子”图像，jQuery 从 itemdrop.php 获取值

**返回值为`<li class="item">Shield of Walmar</li>`**

但是，当我单击 Shield of Walmar 时，jQuery 不会起作用。（我不知何故有一种感觉，顶部的文档准备功能会导致它。）

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:11:38.747

您需要使用现场活动/代表。由于您使用的是最新的 jQuery 版本，因此您希望使用[`.on()`](http://api.jquery.com/on/)它：

```
$('#box').on('click', 'li', function(event){
     $("#box").append("clicked");
}); 
```

我还建议您替换`jQuery(document).ready(function()`为`jQuery(document).ready(function($)`- 否则`$`该函数仅在全局可用时才有效（即`$.noConflict`未使用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:13:08.983

使用[`on()`](http://api.jquery.com/on/)：

```
$("#box").on('click', 'li', function(event){
   $(".box").append("clicked");
}) 
```

**引用文档：**

> 委托事件的优点是它们可以处理来自**以后添加到文档的后代元素的**事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。

# python - 选择脚本语言

> ID：10262114
> 
> 赞同：2
> 
> 时间：2012-04-21T19:10:35.737
> 
> 标签：python, scripting, programming-languages, lua

我需要为我的应用程序（不是游戏）编写脚本，但我遇到了一个问题，为此选择了脚本语言。Lua 看起来不错（实际上，它非常适合我的任务），但它在 unicode 字符串方面存在问题，将使用它。另外，我考虑过 Python，但我不喜欢它的语法，而且它的 Dll 对我来说太大（大约 2.5 Mib）。Python 和其他这样的语言有太多我不需要的功能、电池和模块（例如 I/O 功能）——脚本只需要实现逻辑，所有其他的都会做我的应用程序。所以，我想知道是否有满足此条件的脚本语言：

*   Unicode 字符串
*   我可以导入 C++ 函数，然后从脚本中调用它们
*   可以毫无问题地嵌入到应用程序（无 dll）

重新发明轮子不是一个好主意，所以我不想开发自己的 lang。或者有一种方法可以在 Lua 的源代码中编写 unicode 字符串？就像在 C++ L“Unicode 字符串”中一样

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T19:45:43.437

Lua 字符串与编码无关。所以，是的，您可以在 Lua 脚本中编写 unicode 字符串。如果您需要模式匹配，那么标准 Lua 字符串库不支持 unicode 类。但是普通的子字符串搜索有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-22T14:44:41.943

没有真正的“unicode 字符串”这样的东西。字符串是可以包含任何内容的字节序列。但是，知道字符串中数据的编码很重要。

我使用 Lua 和[UTF-8 字符串](http://en.wikipedia.org/wiki/UTF-8)，它只适用于我关心的所有操作。我不使用任何 Unicode 字符串库，尽管它们可用于 Lua（[ICU4Lua](http://luaforge.net/projects/icu-lua/)、[slnunicode](http://luaforge.net/projects/sln/)等）。

关于在 Lua 中使用 UTF-8 字符串的一些注意事项：

*   字符串长度（# 运算符）返回以字节为单位的字符串长度，而不是字符或代码点（非 ASCII 字符可能是多个字节的序列）。
*   字符串拆分（例如 string.sub）不得拆分 UTF-8 序列。
*   字符串匹配（string.find、string.match）适用于 ASCII 模式。
*   子字符串搜索（例如 'plain' 模式下的 string.find）使用 UTF-8 作为针或干草堆。

以 UTF-8 计算代码点非常简单，但效率略低于其他编码。例如在 Lua 中：

```
function utf8_length(str)
        return select(2, string.gsub(str, "[^\128-\193]", ""));
end 
```

如果您需要的不仅仅是这种东西，我提到的 unicode 库为您提供了所有 API，包括编码之间的转换。

就我个人而言，我更喜欢这种直接的方法，而不是任何强制你使用某种 unicode 风格的语言（例如 Javascript），或者尝试通过在语言中内置多种编码来变得聪明（例如 Python）。根据我的经验，它们只会导致头痛和性能瓶颈。

无论如何，我认为每个开发人员都应该对 unicode 的工作原理以及不同编码之间的原理差异有一个很好的基本了解，以便他们可以就如何在他们的应用程序中处理 unicode 做出最佳选择。

例如，如果您的应用程序中所有现有的字符串都采用宽字符编码，那么使用 Lua 就不太方便，因为您必须为进出 Lua 的每个字符串添加转换。这是完全可能的，但如果您的应用程序可能受 CPU 限制（如在游戏中），那么这将是一个负面的性能方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:27:42.593

看一下 JavaScript - [V8 引擎](https://developers.google.com/v8/embed)非常强大，而且 JavaScript 没有大的标准库。除此之外，您可以轻松地嵌入它，并且据我所知它可以很好地处理 unicode。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T10:13:25.577

看看[`Io`](http://www.iolanguage.com)。

它一直是[unicode](http://www.iolanguage.com/scm/io/docs/IoGuide.html#Unicode)并且可以[嵌入](http://www.iolanguage.com/scm/io/docs/IoGuide.html#Embedding)。它似乎还提供了一些[C++ 绑定库](https://stackoverflow.com/a/3153987/12195)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T19:23:54.957

看看[Jim Tcl](http://jim.tcl.tk)。它体积小，易于嵌入和扩展，支持 UTF-8 字符串，而且非常强大

# css - 使用 CSS 自动调整面板

> ID：10262118
> 
> 赞同：0
> 
> 时间：2012-04-21T19:11:16.503
> 
> 标签：css, gwt

即使调整了浏览器窗口的大小，是否有任何 CSS 规则可以呈现一个适合浏览器页面的小部件？

我的意思是这样我就不必执行处理程序来监视窗口调整大小事件？

# vb.net - 使用 VB 在列表框中播放 .mp3 项目

> ID：10262121
> 
> 赞同：0
> 
> 时间：2012-04-21T19:11:31.900
> 
> 标签：vb.net, visual-studio-2008, ms-access

我正在学习用visual basic制作一个mp3播放器。我所做的只是使用 windows-media-Player 插件在 Visual Studio 中制作了一个 Visual Basic 应用程序。接下来我所做的是将一个 Ms Access 数据库附加到列表框中以在列表框中显示一些歌曲。

列表框显示我的歌曲列表。

现在我想要的是，每当我双击该列表框中的歌曲名称时，它应该在我的应用程序的插件中播放它。

我尝试在访问中使用超链接，但找不到有关如何使用它的任何有用信息。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:59:03.673

您需要查看[`WMPLib`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd562692%28v=vs.85%29.aspx).

这允许您创建和控制 Windows Media Player 控制器。您可以将它传递给您希望直接播放的 .mp3 的路径，或者为了获得更好的体验，创建一个播放列表并将其传递给播放器。

我链接到的页面有一些 VB.NET 和 C# 代码。

```
Player = New WMPLib.WindowsMediaPlayer
Player.URL = url
Player.controls.play() 
```

`url`您要播放的文件的完整路径在哪里。

# python - 如何将密钥永久添加到 os.environ？

> ID：10262131
> 
> 赞同：0
> 
> 时间：2012-04-21T19:12:05.987
> 
> 标签：python, django

我正在实现 Django 部署，并且在我的设置文件中有以下逻辑。

```
if 'DEPLOYMENT_TYPE' in os.environ:
    DEPLOYMENT = os.environ['DEPLOYMENT_TYPE'].upper() 
```

因此，我希望能够在每台计算机的基础上在 os.environ 中设置“DEPLOYMENT_TYPE”键。我在一个单独的外壳中尝试过：

```
os.putenv('DEPLOYMENT_TYPE', ...)
os.environ['DEPLOYMENT_TYPE'] = ... 
```

但是，这些不起作用，因为我猜 os.environ 在导入 os 时会被填充。因此，在每台计算机上设置“DEPLOYMENT_TYPE”的最佳方法是什么？我不能只在我的设置文件中坚持这一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:17:41.210

关键`os.environ`在于它是从运行它的 shell 环境初始化的。所以你应该在`bash_profile`运行部署的用户的环境设置中设置它 - 即或其他任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:17:06.453

您可以[在 Apache 中使用 SetEnv](http://httpd.apache.org/docs/2.2/mod/mod_env.html#setenv)来处理此问题，假设它仅适用于您的 Django Web 环境。

# c - 从函数返回字符串数组时无法访问地址 0x0 处的内存

> ID：10262133
> 
> 赞同：1
> 
> 时间：2012-04-21T19:12:15.270
> 
> 标签：c, malloc

我将指向 char* 数组的指针发送到函数 (args)。在该函数中，我将数组中的前两个位置的值设置为 malloc'd 字符串。当我返回数组本身是 malloc 的原始调用函数时，数组的最后一个位置给了我一个“无法访问地址 0x0 的内存”。我在 malloc/realloc/ 或存储值中做错了吗？

调用函数：

```
int bufspace = 0; /* bytes in table */

    ...

args = emalloc(BUFSIZ); /* initialize array */
bufspace = BUFSIZ;     //size=8192
spots = BUFSIZ / sizeof(char *);

while (*cp != '\0') //While not at the end
    cp = read_segment(cp, &len, &indollarsign, &argnum, start, &args, &prev_char_escape);
    start = cp;
    len = 0;

    if (argnum + 1 >= spots) {
        args = erealloc(args, bufspace + BUFSIZ);
        bufspace += BUFSIZ;
        spots += (BUFSIZ / sizeof(char *));
        }
    } 
```

调用函数 (read_segment) - 首先调用存储在位置 0，然后存储在位置 1：

```
*args[*argnum] = newstr(start, *len); //Generate the string through malloc 
```

在这一行，我在这些位置有字符串： *args[0] 和 *args[1]

但是一旦我返回调用函数 args[0] 有一个字符串，但 args[1] 显示“无法访问地址 0x0 的内存”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:06:21.123

`*args[*argnum]`取消引用 处的指针`args[*argnum]`。我想你的意思是

```
(*args)[*argnum] = newstr(start, *len); 
```

# python - 如何“多处理” itertools 产品模块？

> ID：10262138
> 
> 赞同：7
> 
> 时间：2012-04-21T19:12:48.610
> 
> 标签：python, multithreading, itertools

所以我试着计算下面字符串的数百万个不同的组合，但我每秒只计算大约 1,750 个组合，这甚至不接近我需要的速度。那么我将如何重塑这一点，使同一事物的多个过程计算不同的部分，而不计算已经计算的部分并保持快速？下面的代码部分是我一直在使用的。任何例子将不胜感激！

```
from itertools import product
for chars in product("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12234567890!@#$%^&*?,()-=+[]/;", repeat = 4):
   print chars 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-21T19:18:53.097

将产品分解成多个部分的一种方法是将产品的第一个组件分解，以便每个独立的工作都具有以一组特定首字母开头的所有元素。例如：

```
import string
import multiprocessing as mp
import itertools

alphabet = string.ascii_letters+string.digits+"!@#$%^&*?,()-=+[]/;"
num_parts = 4
part_size = len(alphabet) // num_parts

def do_job(first_bits):
    for x in itertools.product(first_bits, alphabet, alphabet, alphabet):
        print(x)

if __name__ == "__main__":
    pool = mp.Pool()
    results = []
    for i in xrange(num_parts):
        if i == num_parts - 1:
            first_bit = alphabet[part_size * i :]
        else:
            first_bit = alphabet[part_size * i : part_size * (i+1)]
        results.append(pool.apply_async(do_job(first_bit)))

    pool.close()
    pool.join() 
```

（显然你只会`results`在`do_job`实际返回某些东西时使用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T19:26:09.113

您确定每秒只能获得 1750 个组合吗？我得到了大约1000万。

```
def test(n):
    start = time.time()
    count = 0
    for chars in product("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ12234567890!@#$%^&*?,()-=+[]/;", repeat = 4):

        count += 1
        if count == n: break
    return time.time() - start    

>>> test(10000)
0.03300023078918457
>>> test(1000000)
0.15799999237060547
>>> test(10000000)
1.0469999313354492 
```

我不认为我的电脑比你的快得多*。*

**注意：** 我将其发布为答案，因为我想显示代码。这真的更像是一个评论。所以，请不要赞成或反对。

# javascript - MediaElement.js - 如何动态调整视频大小？

> ID：10262140
> 
> 赞同：3
> 
> 时间：2012-04-21T19:12:59.763
> 
> 标签：javascript, mediaelement.js

我知道如何加载不同尺寸的视频，但我不知道如何更改它们。例如，在我的应用程序中，可以调整视频面板的大小 - 我想调整视频的大小。问题是，创建了几个元素，我试图避免调整每个子元素的大小，而只使用一些内置函数。

发现[了这个选项](http://webtonio.com/40/)，但它似乎有点粗略的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:11:09.257

```
<div id="video-wrapper">
    <video width="640" height="360" style="width: 100%; height: 100%;" id="player1">
        <source/>
    </video>
</div> 
```

通过 2.9.3 下载中的 demos/mediaelementplayer-responsive.html 文档（也在 github 上）。我知道内联样式很难看，但是……它有效！我只是根据需要调整视频包装器的大小（jquery 示例）：

```
var newHeight = 360 / 640 * newWidth;
$('#video-wrapper').css('width',newWidth);
$('#video-wrapper').css('height',newHeight+'px'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T16:53:02.693

For the default video player for YouTube & Vimeo, this often will help to "responsively" resize vids: [http://FitVidsjs.com/](http://FitVidsjs.com/)

I have had a friend use it with WordPress without MediaElement.js; it worked with the browser resizing, but left a black box around it. Let me know if you can get the 2 to work well together, with a test page please. :)

# javascript - Opera 用户脚本加载太频繁

> ID：10262142
> 
> 赞同：1
> 
> 时间：2012-04-21T19:13:08.933
> 
> 标签：javascript, jquery, opera, userscripts

我制作了用户脚本。我在 Opera 11.62 上对此进行了测试。我有一个代码：

```
(
    function() {
        var headID = document.getElementsByTagName("head")[0];         
        var newScript = document.createElement('script');
        newScript.type = 'text/javascript';
        newScript.id = 'myjQuery';
        newScript.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js';
        headID.appendChild(newScript);

        newScript.addEventListener('load', function (e) {
            jQuery (
                function($) {
                    alert('loaded');
                }
            );          
        },false);

        newScript.removeEventListener('load');
    }
)(); 
```

我的问题是它显示警报消息的次数太多，每次都在警报标题中使用不同的域。

我知道这是 Facebook 和广告窗口的错。
我可以在加载站点上的所有脚本后加载用户脚本吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T20:21:31.833

似乎问题在于 Opera 正在为每个 iframe 触发脚本。将此代码添加到脚本顶部应该可以清除：

```
if (window.top != window.self)  //-- Don't run on frames or iframes.
    return; 
```

此外，尚不清楚您是否按照 Opera 期望的方式设置脚本的目标。

除非您[在 Greasemonkey 模式下运行脚本，](http://www.opera.com/docs/userjs/examples/#greasemonkey)否则请确保您的代码由域/URL 感应包装，如下所示：

```
if (location.hostname.indexOf('example.com') != -1) {
    // YOUR CODE HERE
} 
```

请参阅[Opera 手册中的“加载脚本”](http://www.opera.com/docs/userjs/examples/#loadingscripts)。

# prolog - 漂亮地打印一个序言词

> ID：10262143
> 
> 赞同：4
> 
> 时间：2012-04-21T19:13:27.127
> 
> 标签：prolog, pretty-print

如何在 SWI-Prolog 中漂亮地打印术语列表。

我努力了：

`portray_clause([term1, term2]).`

但这只是在一个长流中写出，甚至一个字符串作为 ascii 字符代码列表出现——我希望在其中打印“abc”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:16:16.560

这是 SWI 中经常出现的问题。默认情况下，“abc”是字符代码列表，因此打印为：

```
?- Xs = "abc"。
Xs = [97, 98, 99]。

```

这可以轻松转换回来吗？想象一下，您有一个距离列表，*恰好*是 97、98 和 99。在这种情况下，字符串作为答案会非常容易产生误导。因此，您的问题没有干净的解决方案，只要字符串表示法表示字符列表代码！

您可以将“abc”的含义切换为长度为 1 的原子的字符列表：

```
?- set_prolog_flag(double_quotes,chars)。
真的。

?- Xs = "abc"。
Xs = [a, b, c]。

```

如果您对它感到满意，您可以使用[`library(double_quotes)`](http://www.complang.tuwien.ac.at/ulrich/Prolog-inedit/double_quotes.pl).

```
?-使用模块（库（双引号））。
真的。
?- Xs = "abc"。
Xs = "abc"。

```

有关更多信息，请参阅[此线程](https://stackoverflow.com/a/8269897/772868)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:56:59.247

这是一个提示..查找字符串和原子之间的区别..如果您想将它们分开分析字符串的单个字符，您可能只需要将它们保存为字符串。使用 nth0 或 nth1。否则，原子对于大多数事情都可以正常工作/可以轻松操作。

```
?- write(["a", "b", "c"]).
[[97],[98],[99]]
true.

?- write(['a','b','c']).
[a,b,c]
true. 
```

# android - 电池小部件不更新

> ID：10262144
> 
> 赞同：0
> 
> 时间：2012-04-21T19:13:36.453
> 
> 标签：android, service, broadcastreceiver, power-management

在创建电池小部件失败后，我再次尝试使用不同的技术。

在浏览和研究之后，我决定在`AppWidgetProvider`课堂上使用服务和广播接收器。

我的电池值始终为空并且永远不会改变。

我在清单中注册了该服务，并看到该服务已启动。

`onRecieve`我添加了日志并注意到在广播之前调用了 Start 命令。

值会发生变化，但在我更新视图`onReceieve`的地方永远不会改变。`onStartCommand`

我究竟做错了什么？

另外，我在哪里注销接收者？

我的课在下面

```
public class BatteryWidgetProvider extends AppWidgetProvider
{
    private RemoteViews views;
    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
            int[] appWidgetIds) 
    {
        context.startService(new Intent(context, BatteryMonitorReceiver.class));
        /*context.getApplicationContext().registerReceiver(this, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
        ComponentName name = new ComponentName(context, BatteryWidgetProvider.class);
        appWidgetManager.updateAppWidget(name, this.views);

        super.onUpdate(context, appWidgetManager, appWidgetIds);*/

    }

    public static class BatteryMonitorReceiver extends Service
    {
        private RemoteViews views;
        private Integer level;
        private BroadcastReceiver batteryReceiver = new BroadcastReceiver(){
            @Override
            public void onReceive( Context context, Intent intent )
            {
                String action = intent.getAction();
                if(action.equals(Intent.ACTION_BATTERY_CHANGED))
                {
                    level = intent.getIntExtra( "level", 0 );
                    Log.d("BATTERY ON Receieve", "Battery Level is "+level);
views = new RemoteViews(getPackageName(), R.layout.battery100layout);

                }
ComponentName thisWidget = new ComponentName(context,BatteryWidgetProvider.class);
                    AppWidgetManager manager = AppWidgetManager.getInstance(context);
                    manager.updateAppWidget(thisWidget, views);

            }
        };

        @Override
        public int onStartCommand(Intent intent, int flags, int startId) 
        {
            registerReceiver( this.batteryReceiver, new IntentFilter( Intent.ACTION_BATTERY_CHANGED ) );

            Log.d("BATTERY Service", "Battery Level is "+level);

            super.onStart(intent, startId);
            return super.onStartCommand(intent, flags, startId);
        }

        @Override
        public void onStart(Intent intent, int startId) 
        {

        }

        @Override
        public IBinder onBind(Intent intent) 
        {
            // TODO Auto-generated method stub
            return null;
        }

    }
} 
```

这是我的堆栈跟踪

```
java.lang.RuntimeException: Unable to start service com.mischel.batterywidget.BatteryWidgetProvider$BatteryMonitorReceiver@40522428 with null: java.lang.NullPointerException
at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2473)
at android.app.ActivityThread.access$2800(ActivityThread.java:135)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1127)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:150)
at android.app.ActivityThread.main(ActivityThread.java:4385)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at com.test.batterywidget.BatteryWidgetProvider$BatteryMonitorReceiver.onStartCommand(BatteryWidgetProvider.java:102)
at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2456)
... 10 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:28:59.673

> 我究竟做错了什么？

您正在尝试从 更新您的应用小部件`onStartCommand()`，而不是从`onReceive()`。

> 另外我在哪里注销接收者？

`onDestroy()`的`Service`似乎是一个可能的地方这样做。

# javascript - 为什么这个while Javascript循环是无限的？

> ID：10262146
> 
> 赞同：1
> 
> 时间：2012-04-21T19:13:51.557
> 
> 标签：javascript, while-loop, qunit

我不明白为什么这个`while`循环是无限的：

```
window.prevRandomNumber = -1;
function getRandomNumber(limit) {
    if (!limit)
        limit = 9;

    var actualRandomNumber = Math.floor((Math.random() * limit) + 1);

    while (window.prevRandomNumber == actualRandomNumber) {
        actualRandomNumber = Math.floor((Math.random() * limit) + 1)
    }

    window.prevRandomNumber = actualRandomNumber;

    return actualRandomNumber;
} 
```

对此的 QUnit 测试：

```
 test("getRandomNumber() should never return the same number once and again", function () {
        //http://www.askageek.com/2006/01/31/javascript-random-function-that-does-not-return-two-consecutive-identical-results/

        var prevNumber, actualNumber, assertResult;

        for (var i = 0; i <= 200; i++) {
            actualNumber = getRandomNumber();
            assertResult = prevNumber != actualNumber;

            equal(assertResult, true);

            if (!assertResult)
                break;

            prevNumber = actualNumber;
        }
    }); 
```

**解决方案：**

抱歉，错误出现在另一个测试中，就像@Jon 回答的描述一样，当 anyNumber 等于 1 时，会发生无限循环：

```
 test("getRandomNumber(anyNumber) should return a number between 1..anyNumber", function () {

        var anyNumber, result;

        for (var i = 0; i <= 100; i++) {
            anyNumber = Math.floor((Math.random() * 9) + 1);
            result = getRandomNumber(anyNumber);

            equal((0 < result && result < (anyNumber + 1)), true);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T19:21:01.133

## 无尽循环#1

如果 . 循环将是无限的`limit == 1`。考虑：

```
var actualRandomNumber = Math.floor((Math.random() * limit) + 1); 
```

[`Math.random`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)返回 [0, 1) 范围内的数字。乘以`limit`不会改变这一点，加一会将其带到 [1, 2) 因此根据定义`Math.floor`将返回`1`。

```
while (window.prevRandomNumber == actualRandomNumber) {
    actualRandomNumber = Math.floor((Math.random() * limit) + 1)
} 
```

这里我们有相同的逻辑，所以：

*   第一次调用该方法时它会返回`1`（它不会进入循环，因为`prevRandomNumber`是-1）
*   第二次及以后该方法将永远不会返回，因为`prevRandomNumber`已经是 1

`limit`如果是一个大于 1 的数字，我看不出循环是如何无限的。

## 无尽循环#2

考虑如果`limit`不是数字会发生什么。

```
var actualRandomNumber = Math.floor((Math.random() * limit) + 1); 
```

在这里，`Math.random() * limit`将会是`NaN`，表达式的最终结果也是如此。所以`actualRandomNumber`将*永远*等于`NaN`。该方法将`Nan`在第一次调用时返回，第二次不会返回，原因同上。

## 解决方案

```
function getRandomNumber(limit) {
    limit = Number(limit) || 9;

    var actualRandomNumber = Math.floor(Math.random() * (limit + 1)); 
```

第一行修复了无限循环#2，第二行修复了循环#1，方法是在限制结果之前加 1。因此，如果`limit`是 1，您将拥有

```
Math.floor( /* something in [0, 1) */ * 2 ) 
```

很容易看到返回 0 或 1（并不*总是*1）。

# actionscript-3 - 从 as3 对 REST 服务进行 POST 调用时出现问题

> ID：10262149
> 
> 赞同：0
> 
> 时间：2012-04-21T19:14:00.667
> 
> 标签：actionscript-3, rest, post

我正在使用由第 3 方开发人员编写的基于 Jetty 的 REST 服务，我必须从 actionscript 3 调用该服务。有多个可用的调用，其中大多数都有效，只有一个我遇到问题：结束一个会话，我必须向`http://localhost/control/end`.

我在 Chrome 中使用[Simple Rest Client](https://chrome.google.com/webstore/detail/fhjcajmcbmldlhcimfajhfbgofnpcjmb)进行了基本测试，并且有效：

1.  我收到状态 200 响应
2.  在服务控制台中，我看到一个`setEnd`呼叫

问题是，当我在 actionscript 中尝试相同的操作时，它似乎不起作用。这是我的基本电话：

```
private function deleteSID(event : MouseEvent) : void {
            var request:URLRequest = new URLRequest(SERVER+"control/end"); 
            request.method = URLRequestMethod.POST;
            var loader:URLLoader = new URLLoader();
            loader.addEventListener(Event.COMPLETE, deletedSID);
            loader.addEventListener(IOErrorEvent.IO_ERROR, onIOError);
            loader.addEventListener(HTTPStatusEvent.HTTP_STATUS , onHTTPStatus);
            loader.load(request);
        } 
```

但我得到的是 404 而不是 200，就好像它实际上并没有做 POST。

不幸的是，我对 REST API 没有太多经验，因此对我可能缺少的任何提示/提示表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T15:10:13.947

尝试使用 POST 调用发送一些数据：

```
var requestVars:URLVariables = new URLVariables(); 
requestVars.dummy = "lol"; 
...
request.data = requestVars; 
```

# http - 如何在 http 代理中传输 png 或 jpg

> ID：10262153
> 
> 赞同：-1
> 
> 时间：2012-04-21T19:15:03.757
> 
> 标签：http, sockets, png, jpeg

我正在使用 c 套接字在 linux 中开发 http 代理。我使用的 io 函数是*Computer Systems:A Programmer's Perspective* 中引入的*健壮 io*。

 *现在一切正常，除非我传输嵌入网页的 jpg 或 png 部分。应该出现图片的地方总是一个红十字。有人可以帮助我或有什么建议吗？抱歉细节。我的意思是我正在使用 http 代理。逻辑是客户端从 IE 浏览器发起网页请求，代理将启动 DNS 查询并将相同的请求发送到服务器并将回复发送给客户端. 接收和发送回复信息很简单， `while((number = readnb(&rio,buf,n))>=0){ writen(fd,buf,number); }` 结果如果网页中有jpg或png，则浏览器什么也没有，我按CTRL+C停止代理，浏览器会显示字符部分和红叉对于 jpg 部分

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:38:49.283

> 结果是，如果网页中有 jpg 或 png，则浏览器不显示任何内容

听起来您不支持[持久的 HTTP 连接](http://en.wikipedia.org/wiki/HTTP_persistent_connection)。

检查您是否可以单独访问图像。*

# markdown - markdown - 如何显示 HTML？

> ID：10262154
> 
> 赞同：14
> 
> 时间：2012-04-21T19:15:12.833
> 
> 标签：markdown

我正在尝试在 GitHub 上添加一个包含示例 HTML 的 wiki 页面，但无法弄清楚如何显示实际的 HTML，而不是尝试呈现它。

我试过了 > 和 < < 但后来它使它像

<桌子>

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-21T19:21:40.743

如果要将 HTML 显示为代码示例。[您可以对代码](http://en.wikipedia.org/wiki/Markdown#Code)使用格式

例子：

```
```html
<!DOCTYPE html>
<html>
  <head>
    <title>This is a title</title>
  </head>
  <body>
    <p>Hello world!</p>
  </body>
</html>
```

```xml
<?xml version="1.0" encoding="ISO-8859-1" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
</xs:schema>
``` 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-09-19T18:50:09.020

提示：您还可以通过添加一个反引号来显示“内联”HTML：

```
`<html>` 
```

# python - 尝试从拆分列表中添加特定列

> ID：10262156
> 
> 赞同：0
> 
> 时间：2012-04-21T19:15:31.527
> 
> 标签：python

我有一个需要拆分的输入文件。该文件可以有任意数量的行，但每行有 4 个内容。首先是地区代码，其次是在该地区销售的小说书籍数量，其次是在该地区销售的非小说书籍数量，最后是该地区的税收（例如：TX 493 515 0.055）。除了总结所有小说书籍、非小说书籍和总销售额之外，我已经弄清楚了我需要对程序做的所有事情。假设总共只有三行，每个地区的小说书销量分别为 493、500、489 册，显然它们各自位于不同的行中。这是我写的，想知道我做错了什么：

```
while (myFile != ""):

    myFile = myFile.split()
    sumFiction = 0
    for i in range(myFile):
        sumFiction = sumFiction + eval(myFile[1]) 
```

如果我拆分 (CO 493 515 0.055) 的文件，CO 不会是 myFile[0]、493 是 myFile[1] 等。任何帮助将不胜感激。

编辑：对不起，我应该更具体一点。我正在从一个文件中读取，假设这个文件有 3 行（但我的代码需要用于无限数量的行）：

```
TX 415 555 0.55
MN 330 999 0.78
HA 401 674 0.99 
```

首先是地区代码，然后是小说书籍的销量，然后是非小说书籍的销量，然后是该地区的税收。我需要弄清楚我已经完成的地区等销售的书籍总量。唯一我不知道的是如何总结所有三行出售的小说（例如：415、330、401）。到目前为止，这是代码：

```
def ComputeSales(fictionBooks,nonFictionBooks,areaTax):
    total = (fictionBooks * 14.95) + (nonFictionBooks * 9.95)
    tax = total * areaTax
    totalSales = total + tax

    return total,tax,totalSales

def main():
    #inFile = input("Please enter name of book data file:  ")
    #inFile = open(inFile,"r")
    inFile = open("pa7.books","r")
    myFile = inFile.readline()

    print()
    print("{0:14}{1:10}".format("","Units Sold"))
    print("{0:10}{1:11}{2:17}{3:12}{4:8}{5:11}".format(
                "Region","Fiction","Non-Fiction","Total","Tax","Total Sales"))
    print("---------------------------------------------------------------------")

    while (myFile != ""):
        myFile = myFile.split()
        sumFiction = 0
        #for i in range(myFile):
            #sumFiction = sumFiction + eval(myFile[1])

        total,tax,totalSales = ComputeSales(eval(myFile[1]),eval(myFile[2]),eval(myFile[3]))

        print("{0:2}{1:10}{2:13}{3:4}{4:14.2f}{5:10.2f}{6:16.2f}".format(
                   "",myFile[0],myFile[1],myFile[2],total,tax,totalSales))

        myFile = inFile.readline()

     print("---------------------------------------------------------------------")
    #print("{0:11}{1:13}{2:34}{3:2}{4:8}".format(
    #             "Total","15035","3155","$","272843.41"))
    print(sumFiction)

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:23:31.160

**编辑**：好的，我之前的回答是基于假设它`myFile`实际上是一个文件对象，而不是文件的一行。

你的主要问题似乎是你试图在另一个循环中做一个循环，这并没有什么意义：你只需要一个循环在这里，在文件的行上，并为每个循环加起来线。

`main`这是执行此操作的函数的编辑版本。我也有：

*   切换到`for`文件的循环，因为它更自然。
*   按照评论中的建议，使用`float`而不是`eval`，这样恶意或错误的数据文件只会使您的程序崩溃，而不是运行任意代码。
*   切换到使用`with`语句打开文件：这保证即使您的程序中途崩溃，文件也会被关闭，这是一个很好的习惯，尽管在这里并没有太大的区别。
*   切换到`snake_case`变量名的标准 Python 样式样式，而不是`camelCase`. （此外，`ComputeSales`通常是`compute_sales`;`CamelCase`名称通常仅用于类名。）
*   将文件名更改为参数，以便您可以使用例如调用它`main(sys.argv[1] if len(sys.argv) > 1 else "pa7.books")`来支持命令行参数。

这里是：

```
def main(filename="pa7.books"):
    sum_fiction = 0
    sum_nonfiction = 0
    sum_total = 0

    with open(filename) as in_file:
        for line in in_file:
            if not line.strip():
                 continue # skip any blank lines

            fields = line.split()
            region = fields[0]
            fiction, nonfiction, area_tax = [float(x) for x in fields[1:]]

            total, tax, total_sales = ComputeSales(fiction, nonfiction, area_tax)

            sum_fiction += fiction
            sum_nonfiction += nonfiction
            sum_total += total_sales

    print("{0:2}{1:10}{2:13}{3:4}{4:14.2f}{5:10.2f}{6:16.2f}".format(
           "", region, fiction, nonfiction, total, tax, total_sales))

    print("---------------------------------------------------------------------")
    print("{0:11}{1:13}{2:34}{3:2}{4:8}".format(
           "Total", sum_fiction, sum_nonfiction, "$", sum_total)) 
```

如果您不理解我建议的任何更改，请随时提问！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T22:51:42.597

啊。这是丑陋的。[美丽胜于丑陋](http://www.python.org/dev/peps/pep-0020/)。我不再主要是 Python 程序员，所以可能有更好的工具来解决这个问题。但是让我们从概念层面来解决这个问题。

这是标准的命令式编程，使问题过于复杂。它很容易迷失在实施噪音中，比如你遇到的问题。它使您无法只见树木不见森林。让我们尝试另一种方法。

让我们专注于我们需要做的事情，并让实施由此产生。首先我们知道我们需要从文件中读取。

## 从文件中读取

```
Scenario: Calculate totals within region database
Feature: Read from database

As a user, in order to be able to view the total sales of my books and differentiate them by fiction and nonfiction, I want to be able to read data from a file.

Given: I have a file that has region data, for example data.text
When: I load data from it
Then: I should have associated region data available in my program. 
```

这是作为测试用例的 Python 实现：

```
import unittest

class RegionTests(unittest.TestCase):
    def testLoadARegionDatabase(self):
        """Given a region file,when I load it, then it should be stored in memory"""
        # Given region database
        regionDatabase = []
        # When I load it
        with open('./regions.txt','r') as f:
            regionDatabase = f.readlines()
        # Then contents should be available
        self.assertTrue(len(regionDatabase) > 0) 
```

## 从文件中获取区域数据

从概念上讲，我们知道该文件中的每一行都是有意义的。从根本上说，每一行都是一个**Region**。我们在文件中存储了代码、虚构销售、非虚构销售和税率。区域的概念在我们的系统中应该有一个明确的、一流的表示，因为[Explicit 比 Implicit 更好](http://www.python.org/dev/peps/pep-0020/)。

```
Feature: Create a Region

As a user, in order to be able to know a region is information--including nonfiction sales, fiction sales, and tax rate-- I want to be able to create a Region.

Given: I have data for fiction sales, non-fiction sales, and tax rate
When:  I create a Region
Then:  Its sales, non-fiction sales, and tax-rate should be set accordingly 
```

这是作为测试用例的 Python 实现：

```
def testCreateRegionFromData(self):
        """Given a set of data, when I create a region, then its non-fiction sales, fiction sales,and tax rate should be set"""
        # Given a set of data
        texas = { "regionCode": "TX", "fiction" : 415, "nonfiction" : 555, "taxRate" : 0.55 }
        # When I create a region
        region = Region(texas["regionCode"], texas["fiction"], texas["nonfiction"], texas["taxRate"])
        # Then its attributes should be set
        self.assertEquals("TX", region.code)
        self.assertEquals(415, region.fiction)
        self.assertEquals(555, region.nonfiction)
        self.assertEquals(0.55, region.taxRate) 
```

这失败了。让我们让它过去吧。

```
class Region:
    def __init__(self, code, fiction, nonfiction,rate):
        self.code = code
        self.fiction = fiction
        self.nonfiction = nonfiction
        self.taxRate = rate 
```

## 分析总计

现在我们知道我们的系统可以表示区域。我们想要一些可以分析大量地区并为我们提供销售汇总统计数据的东西。让我们称其为**Analyst**。

```
Feature: Calculate Total Sales

As a user, in order to be able to know what is going on, I want to be able to ask an Analyst what the total sales are for my region

Given: I have a set of regions
When : I ask my Analyst what the total sales are
Then : The analyst should return me the correct answers 
```

这是作为测试用例的 Python 实现。

```
def testAnalyzeRegionsForTotalNonFictionSales(self):
    """Given a set of Region, When I ask an Analyst for total non-fiction sales, then I should get the sum of non-fiction sales"""
    # Given a set of regions
    regions = [ Region("TX", 415, 555, 0.55), Region("MN", 330, 999, 0.78), Region("HA", 401, 674, 0.99) ]
    # When I ask my analyst for the total non-fiction sales
    analyst = Analyst(regions)
    result = analyst.calculateTotalNonFictionSales()
    self.assertEquals(2228, result) 
```

这失败了。让我们让它过去吧。

```
class Analyst:
    def __init__(self,regions):
        self.regions = regions

    def calculateTotalNonFictionSales(self):
        return sum([reg.nonfiction for reg in self.regions]) 
```

您应该能够从这里推断小说的销售情况。

# 决定，决定

当涉及到总销售额时，需要做出一个有趣的设计决策。

*   我们是否应该让分析师直接阅读一个地区的小说和非小说属性并总结它们？

我们可以这样做：

```
def calculateTotalSales(self):
    return sum([reg.fiction + reg.nonfiction for reg in self.regions]) 
```

但是，如果我们添加“历史剧”（小说和非小说）或其他属性会发生什么？然后每次我们更改 Region 时，我们都必须更改我们的 Analyst，以便将 Region 的新结构考虑在内。

**不**，这是一个糟糕的设计决定。*Region 已经知道它需要知道的关于其总销售额的所有信息*。地区应该能够报告其总数。

## 做出好的选择！

```
Feature: Report Total Sales
Given: I have a region with fiction and non-fiction sales
When : I ask the region for its total sales
Then: The region should tell me its total sales 
```

这是作为测试用例的 Python 实现：

```
def testGetTotalSalesForRegion(self):
        """Given a region with fiction and nonfiction sales, when I ask for its total sales, then I should get the result"""
        # Given a set of data
        texas = { "regionCode": "TX", "fiction" : 415, "nonfiction" : 555, "taxRate" : 0.55 }
        region = Region("TX", 415, 555, 0.55)
        # When I ask the region for its total sales
        result = region.totalSales()
        # Then I should get the sum of the sales
        self.assertEquals(970,result) 
```

分析师应该[告诉，不要问](http://pragprog.com/articles/tell-dont-ask)

```
def calculateTotalSales(self):
        return sum([reg.totalSales() for reg in self.regions]) 
```

现在您拥有编写此应用程序所需的一切。另外，如果您以后进行更改，您可以使用自动回归套件。它可以准确地告诉你你破坏了什么，并且测试明确地指定应用程序是什么以及它可以做什么。

## 结果

这是生成的程序：

```
from region import Region
from analyst import Analyst

def main():
   text = readFromRegionFile()
   regions = createRegionsFromText(text)
   analyst = Analyst(regions)
   printResults(analyst)

def readFromRegionFile():
    regionDatabase = []
    with open('./regions.txt','r') as f:
            regionDatabase = f.readlines()
    return regionDatabase

def createRegionsFromText(text):
    regions = []
    for line in text:
        data = line.split()
        regions.append(Region(data[0],data[1], data[2], data[3]))
    return regions

def printResults(analyst):
    totSales = analyst.calculateTotalSales()
    totFic = analyst.calculateTotalFictionSales()
    totNon = analyst.calculateTotalNonFictionSales()
    for r in analyst.regions:
        print("{0:2}{1:10}{2:13}{3:4}{4:14.2f}{5:10.2f}".format(
           "", r.code, r.fiction, r.nonfiction, r.totalSales(), r.taxRate))

    print("---------------------------------------------------------------------")
    print("{0:11}{1:13}{2:34}{3:2}{4:8}".format(
           "Total", totFic, totNon, "$", totSales))

if __name__ == "__main__":
    main() 
```

把你写的和这个比较一下。哪一个更容易理解？简洁的？如果：

*   您为每个地区添加了音乐销售？
*   您从文本文件转移到 MySQL 数据库或 Web 服务调用？

***让你的概念体现出来。使您的代码清晰、简洁且富有表现力。***

# qt - Qt：在新选项卡中添加 QPlainTextEdit

> ID：10262157
> 
> 赞同：1
> 
> 时间：2012-04-21T19:15:36.640
> 
> 标签：qt, tabs, qt-designer

我有很多 Qt 问题 :) 我有一个名为 MainWindow 的类。在这里，我有菜单（文件、编辑、设置）、工具栏按钮（新建、打开等）和 tabContainer。每个选项卡代表一个新文件（制作一个简单的 c++ 编辑器）。此外，我还有另一个包含 QPlainTextEdit 的类，以及在编辑器中操作文本的某些函数。但是我可以连接这两个类吗？所以我在每个选项卡中创建这个类的一个新对象？我正在使用 Qt Creator，如果这是一种简单的方法。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:38:47.487

```
mainWindow::on_NewFile_triggered()
{
  tabWidget->addTab( new TextEditor );
} 
```

你还需要什么？你做了什么，什么没用？

# ios - 通过 iTunes 更新 iPhone 应用程序似乎导致它崩溃

> ID：10262158
> 
> 赞同：1
> 
> 时间：2012-04-21T19:15:53.350
> 
> 标签：ios, crash, uistoryboard

我刚刚将我的 iPhone 应用程序更新发布到应用程序商店，似乎很多客户都遇到了崩溃的问题。我已经对其进行了一百万次测试，并且没有一次发生崩溃。然后我从我设备上的应用商店更新了应用程序，并启动了崩溃。谁能帮我找出问题？

```
Hardware Model:      iPod4,1
Process:         minecraft [354]
Path:            /var/mobile/Applications/BF192AFD-86D6-4C90-B577-EAABC5A13845/minecraft.app/minecraft
Identifier:      minecraft
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-04-21 13:59:43.892 -0500
OS Version:      iPhone OS 5.1 (9B176)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x312fe88f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x31366259 objc_exception_throw + 33
2   UIKit                           0x33e746e7 +[UIStoryboard storyboardWithName:bundle:] + 439
3   UIKit                           0x33cab571 -[UIApplication _loadMainStoryboardFileNamed:bundle:] + 45
4   UIKit                           0x33b34893 -[UIApplication _loadMainInterfaceFile] + 223
5   UIKit                           0x33b2e8d7 -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 235
6   UIKit                           0x33afcc6b -[UIApplication handleEvent:withNewEvent:] + 1011
7   UIKit                           0x33afc70f -[UIApplication sendEvent:] + 55
8   UIKit                           0x33afc0e3 _UIApplicationHandleEvent + 5827
9   GraphicsServices                0x343ec22b PurpleEventCallback + 883
10  CoreFoundation                  0x312d2523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 39
11  CoreFoundation                  0x312d24c5 __CFRunLoopDoSource1 + 141
12  CoreFoundation                  0x312d1313 __CFRunLoopRun + 1371
13  CoreFoundation                  0x312544a5 CFRunLoopRunSpecific + 301
14  CoreFoundation                  0x3125436d CFRunLoopRunInMode + 105
15  UIKit                           0x33b2da13 -[UIApplication _run] + 551
16  UIKit                           0x33b2ae7d UIApplicationMain + 1081
17  minecraft                       0x0000aac7 0x9000 + 6855
18  minecraft                       0x0000aa7c 0x9000 + 6780

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x3477832c __pthread_kill + 8
1   libsystem_c.dylib               0x37c33208 pthread_kill + 48
2   libsystem_c.dylib               0x37c2c298 abort + 88
3   libc++abi.dylib                 0x35184f64 abort_message + 40
4   libc++abi.dylib                 0x35182346 _ZL17default_terminatev + 18
5   libobjc.A.dylib                 0x31366350 _objc_terminate + 140
6   libc++abi.dylib                 0x351823be _ZL19safe_handler_callerPFvvE + 70
7   libc++abi.dylib                 0x3518244a std::terminate() + 14
8   libc++abi.dylib                 0x3518381e __cxa_rethrow + 82
9   libobjc.A.dylib                 0x313662a2 objc_exception_rethrow + 6
10  CoreFoundation                  0x31254506 CFRunLoopRunSpecific + 398
11  CoreFoundation                  0x31254366 CFRunLoopRunInMode + 98
12  UIKit                           0x33b2da0c -[UIApplication _run] + 544
13  UIKit                           0x33b2ae76 UIApplicationMain + 1074
14  minecraft                       0x0000aac0 0x9000 + 6848
15  minecraft                       0x0000aa74 0x9000 + 6772

Thread 1 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 1:
0   libsystem_kernel.dylib          0x347683a8 kevent + 24
1   libdispatch.dylib               0x36e45ea4 _dispatch_mgr_invoke + 708
2   libdispatch.dylib               0x36e45bc2 _dispatch_mgr_thread + 30

Thread 2:
0   libsystem_kernel.dylib          0x34778cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x37beef36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x37beecc8 start_wqthread + 0

Thread 3:
0   libsystem_kernel.dylib          0x34778cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x37beef36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x37beecc8 start_wqthread + 0

Thread 4 name:  WebThread
Thread 4:
0   libsystem_kernel.dylib          0x34768004 mach_msg_trap + 20
1   libsystem_kernel.dylib          0x347681fa mach_msg + 50
2   CoreFoundation                  0x312d23ec __CFRunLoopServiceMachPort + 120
3   CoreFoundation                  0x312d1124 __CFRunLoopRun + 876
4   CoreFoundation                  0x3125449e CFRunLoopRunSpecific + 294
5   CoreFoundation                  0x31254366 CFRunLoopRunInMode + 98
6   WebCore                         0x325e30f0 _ZL12RunWebThreadPv + 396
7   libsystem_c.dylib               0x37bf472e _pthread_start + 314
8   libsystem_c.dylib               0x37bf45e8 thread_start + 0

Thread 0 crashed with ARM Thread State:
    r0: 0x00000000    r1: 0x00000000      r2: 0x00000001      r3: 0x00000000
    r4: 0x00000006    r5: 0x3fdfbd98      r6: 0x00000002      r7: 0x2fe07a5c
    r8: 0x001790c0    r9: 0x35185a4a     r10: 0x33edb8dc     r11: 0x001790c0
    ip: 0x00000148    sp: 0x2fe07a50      lr: 0x37c3320f      pc: 0x3477832c
  cpsr: 0x00000010

Binary Images:
    0x9000 -    0x19fff +minecraft armv7  <3efcb8c4a3313f5ab6e4939f55c5696c> /var/mobile/Applications/BF192AFD-86D6-4C90-B577-EAABC5A13845/minecraft.app/minecraft
0x2fe08000 - 0x2fe29fff  dyld armv7  <4a817f3e0def30d5ae2032157d889c1d> /usr/lib/dyld
0x3066a000 - 0x306b4fff  libvDSP.dylib armv7  <441b42aca07b3da39feab25f8349918f> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/libvDSP.dylib
0x30984000 - 0x309b0fff  libtidy.A.dylib armv7  <3aacc5b650e037c086a8ff6657d154bf> /usr/lib/libtidy.A.dylib
0x309b1000 - 0x309b2fff  libsystem_sandbox.dylib armv7  <66e985f3eea03ef08afb7cf4c153f76e> /usr/lib/system/libsystem_sandbox.dylib
0x309b9000 - 0x309bcfff  libmacho.dylib armv7  <e52b77623bd031bc807e77029566c777> /usr/lib/system/libmacho.dylib
0x309bf000 - 0x309c1fff  libCoreVMClient.dylib armv7  <d4d4aa3090c83e87bcb15ed00b93fd5c> /System/Library/Frameworks/OpenGLES.framework/libCoreVMClient.dylib
0x309c9000 - 0x309d8fff  SpringBoardServices armv7  <ca5b10014b473d2eaec5c48d89ee1b54> /System/Library/PrivateFrameworks/SpringBoardServices.framework/SpringBoardServices
0x30ab3000 - 0x30ab4fff  DataMigration armv7  <d77f0e8f39ee37f5a2ac713a3fd9e693> /System/Library/PrivateFrameworks/DataMigration.framework/DataMigration
0x30ab5000 - 0x30abefff  libMobileGestalt.dylib armv7  <4a15e845dc6f3a4a980de66c1cc44c42> /usr/lib/libMobileGestalt.dylib
0x30ac0000 - 0x30c3efff  Foundation armv7  <c40ddb073142315bb4ebb214343d0b7f> /System/Library/Frameworks/Foundation.framework/Foundation
0x30c3f000 - 0x30c4bfff  libCRFSuite.dylib armv7  <bdb2b4d1a78c39c1ba60d791207aed2a> /usr/lib/libCRFSuite.dylib
0x30c8e000 - 0x30c95fff  MailServices armv7  <ab2388ce733e38b7a261273a401bbbf1> /System/Library/PrivateFrameworks/MailServices.framework/MailServices
0x30e37000 - 0x30f0ffff  vImage armv7  <caf3648be2933384b6aa1ae7408ab4f0> /System/Library/Frameworks/Accelerate.framework/Frameworks/vImage.framework/vImage
0x30f10000 - 0x30f17fff  AssetsLibraryServices armv7  <0703f561f9a038b6850d6e93bba7e5f4> /System/Library/PrivateFrameworks/AssetsLibraryServices.framework/AssetsLibraryServices
0x30f5d000 - 0x30f69fff  libz.1.dylib armv7  <36ce86a3dc8c344596c8c325615f374b> /usr/lib/libz.1.dylib
0x31038000 - 0x3103efff  libnotify.dylib armv7  <9406297de3e43742887890662a87ab53> /usr/lib/system/libnotify.dylib
0x31119000 - 0x31119fff  vecLib armv7  <a2cfe25e77aa36bfb4a30b2d0d2dd465> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/vecLib
0x31245000 - 0x3135cfff  CoreFoundation armv7  <6d450fe923d7387f8b01845e0edd713d> /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
0x3135d000 - 0x31423fff  libobjc.A.dylib armv7  <90014d1bc583366d85622e43097df416> /usr/lib/libobjc.A.dylib
0x31424000 - 0x31429fff  libsystem_dnssd.dylib armv7  <27bb5462450732e380f5a2c170546e93> /usr/lib/system/libsystem_dnssd.dylib
0x3142c000 - 0x31461fff  SystemConfiguration armv7  <4464a4e3bb3f32f7abaa35ebf31fda49> /System/Library/Frameworks/SystemConfiguration.framework/SystemConfiguration
0x31462000 - 0x3161ffff  ImageIO armv7  <02e3578171fa3b6a969b244275fd2bab> /System/Library/Frameworks/ImageIO.framework/ImageIO
0x31620000 - 0x31625fff  libcopyfile.dylib armv7  <52e874396c393ed29099789ce702cfe2> /usr/lib/system/libcopyfile.dylib
0x31626000 - 0x3162bfff  ApplePushService armv7  <f424c0340de637c08bbeb4f3bd8c6eaf> /System/Library/PrivateFrameworks/ApplePushService.framework/ApplePushService
0x31772000 - 0x317affff  FTServices armv7  <28ed78e01a77388cb4c0f2f6ec33482c> /System/Library/PrivateFrameworks/FTServices.framework/FTServices
0x3188a000 - 0x318c9fff  QuickLook armv7  <802b1092542a3017a0380632502610d4> /System/Library/Frameworks/QuickLook.framework/QuickLook
0x318d1000 - 0x3196afff  EventKit armv7  <d67aa1508ee7306b8e2a45c76ffddff0> /System/Library/Frameworks/EventKit.framework/EventKit
0x3196b000 - 0x3196efff  CaptiveNetwork armv7  <f5cc4b97ce9432da9426f12621453325> /System/Library/PrivateFrameworks/CaptiveNetwork.framework/CaptiveNetwork
0x31a65000 - 0x31a7bfff  EAP8021X armv7  <fffe86a22bc434a6ae84f23bfecef9d6> /System/Library/PrivateFrameworks/EAP8021X.framework/EAP8021X
0x31a80000 - 0x31abcfff  iCalendar armv7  <f2836083051132d3aa40ad82d7f73aea> /System/Library/PrivateFrameworks/iCalendar.framework/iCalendar
0x31ac1000 - 0x31ac7fff  liblaunch.dylib armv7  <aa2bcba6fc7a36a191958fef2e995475> /usr/lib/system/liblaunch.dylib
0x31aff000 - 0x31b73fff  MediaControlSender armv7  <87315c54b2293ab589950341ff91b45d> /System/Library/PrivateFrameworks/MediaControlSender.framework/MediaControlSender
0x31c6c000 - 0x31c77fff  AccountSettings armv7  <373e59421d983c93931cfbad87b1ae35> /System/Library/PrivateFrameworks/AccountSettings.framework/AccountSettings
0x31cec000 - 0x31cfdfff  libxpc.dylib armv7  <ccf25b1e49ce3b2fa58d8c8546755505> /usr/lib/system/libxpc.dylib
0x31d17000 - 0x31d24fff  libbsm.0.dylib armv7  <750a0de73a733019a77144b805d4d2f8> /usr/lib/libbsm.0.dylib
0x31d25000 - 0x31d65fff  libGLImage.dylib armv7  <40448706190031f6b0d9636cc11ee81d> /System/Library/Frameworks/OpenGLES.framework/libGLImage.dylib
0x31ec5000 - 0x31f95fff  WebKit armv7  <6ff2796c2f933050ac6ecdee9fc6a216> /System/Library/PrivateFrameworks/WebKit.framework/WebKit
0x31faa000 - 0x31fc2fff  Notes armv7  <724966ed5cd4395cb70f9c996b123f53> /System/Library/PrivateFrameworks/Notes.framework/Notes
0x31feb000 - 0x31ff0fff  CrashReporterSupport armv7  <2bb524b3bb3c3eb2932ce13b655b7c7c> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/CrashReporterSupport
0x32068000 - 0x32068fff  libkeymgr.dylib armv7  <ebd2dddf55d83cf48a18913968775960> /usr/lib/system/libkeymgr.dylib
0x32186000 - 0x32188fff  MobileInstallation armv7  <215d93dbb0f63cbf828f9126eb7b5349> /System/Library/PrivateFrameworks/MobileInstallation.framework/MobileInstallation
0x324fe000 - 0x324fefff  libCVMSPluginSupport.dylib armv7  <a80aaa9989483ce3a496a061fd1e9e0a> /System/Library/Frameworks/OpenGLES.framework/libCVMSPluginSupport.dylib
0x32522000 - 0x32531fff  OpenGLES armv7  <e80acc691001301e96101bb89d940033> /System/Library/Frameworks/OpenGLES.framework/OpenGLES
0x3253a000 - 0x32cf8fff  WebCore armv7  <814351ff217e3425a8e532c2e2251f73> /System/Library/PrivateFrameworks/WebCore.framework/WebCore
0x32cf9000 - 0x32d0dfff  PersistentConnection armv7  <65682d21486836a3aa3e17b9461e7b3a> /System/Library/PrivateFrameworks/PersistentConnection.framework/PersistentConnection
0x32d0e000 - 0x32d58fff  ManagedConfiguration armv7  <5e0a131bbfec305ea01f9e01f486da63> /System/Library/PrivateFrameworks/ManagedConfiguration.framework/ManagedConfiguration
0x32d59000 - 0x32d76fff  libsystem_info.dylib armv7  <50863bcbf478323e96a8e5b1a83ea6f9> /usr/lib/system/libsystem_info.dylib
0x32d77000 - 0x32ddafff  IMCore armv7  <6e26e99b9b5f3829a8486ffd8c64f0d2> /System/Library/PrivateFrameworks/IMCore.framework/IMCore
0x32e0a000 - 0x32e0efff  IOSurface armv7  <6ae77a40f8e93f28bc466ca93f5675d4> /System/Library/PrivateFrameworks/IOSurface.framework/IOSurface
0x32e42000 - 0x32f8bfff  libicucore.A.dylib armv7  <b70646b63f1f3b33896dd8cb91b8dab1> /usr/lib/libicucore.A.dylib
0x3308b000 - 0x3308efff  CoreTime armv7  <a398de5ba1e43a11b7008e9bb5a7f6fe> /System/Library/PrivateFrameworks/CoreTime.framework/CoreTime
0x3308f000 - 0x33090fff  libremovefile.dylib armv7  <402f8956975d3b6fb86ab9b31a43242c> /usr/lib/system/libremovefile.dylib
0x3315f000 - 0x3315ffff  libgcc_s.1.dylib armv7  <eb82984fa36c329387aa518aa5205f3d> /usr/lib/libgcc_s.1.dylib
0x331b2000 - 0x331fafff  CoreMedia armv7  <eb1f503312be3c93b07b2d0d25177000> /System/Library/Frameworks/CoreMedia.framework/CoreMedia
0x33359000 - 0x3335dfff  AggregateDictionary armv7  <3a3a33f3a05538988c6e2bb363dc46a8> /System/Library/PrivateFrameworks/AggregateDictionary.framework/AggregateDictionary
0x336f8000 - 0x336fbfff  NetworkStatistics armv7  <7848d8ebad99367cb4f7f4e3fe88e5d6> /System/Library/PrivateFrameworks/NetworkStatistics.framework/NetworkStatistics
0x33702000 - 0x33732fff  ContentIndex armv7  <7a64670bb2ff3ee39ddee1dc1c72f92d> /System/Library/PrivateFrameworks/ContentIndex.framework/ContentIndex
0x3373b000 - 0x3391ffff  AudioToolbox armv7  <c91e27850452330ea804db6408840fd2> /System/Library/Frameworks/AudioToolbox.framework/AudioToolbox
0x339d7000 - 0x33a13fff  AppSupport armv7  <311eac85b2a433a884dacba77217b49e> /System/Library/PrivateFrameworks/AppSupport.framework/AppSupport
0x33a16000 - 0x33a73fff  StoreServices armv7  <628fbbc73ed93730962c53bfbfde6794> /System/Library/PrivateFrameworks/StoreServices.framework/StoreServices
0x33ae0000 - 0x33ae4fff  libcache.dylib armv7  <d6a7436ed8dc33d795c9b42baf864882> /usr/lib/system/libcache.dylib
0x33ae5000 - 0x33ae8fff  ActorKit armv7  <434c756a6b053f4ba3c954cfccddbf59> /System/Library/PrivateFrameworks/ActorKit.framework/ActorKit
0x33af9000 - 0x33f9bfff  UIKit armv7  <d72bcc68e76a3a55a963590cdcffe8cd> /System/Library/Frameworks/UIKit.framework/UIKit
0x33fe3000 - 0x33ff8fff  libresolv.9.dylib armv7  <66f7557fa4b43979b186e00271839fdb> /usr/lib/libresolv.9.dylib
0x33fff000 - 0x34003fff  IOMobileFramebuffer armv7  <42dbc26828e934acabb4f3b0a35d8250> /System/Library/PrivateFrameworks/IOMobileFramebuffer.framework/IOMobileFramebuffer
0x34004000 - 0x3400efff  libvMisc.dylib armv7  <e8248c797b9b363594bb652ddf7ce16d> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/libvMisc.dylib
0x34017000 - 0x3413cfff  JavaScriptCore armv7  <2ffc6c87b94434288366bd53765ee267> /System/Library/PrivateFrameworks/JavaScriptCore.framework/JavaScriptCore
0x3414c000 - 0x34195fff  AddressBook armv7  <b17a2962e9043e0385c3c2c652155f2b> /System/Library/Frameworks/AddressBook.framework/AddressBook
0x3424f000 - 0x342f9fff  libBLAS.dylib armv7  <bf822cc1a3243ae7b104cf73ca22d352> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/libBLAS.dylib
0x34306000 - 0x3431ffff  libRIP.A.dylib armv7  <1828cddc5dd93c61afbefb59587d7f8a> /System/Library/Frameworks/CoreGraphics.framework/Resources/libRIP.A.dylib
0x343e7000 - 0x343f1fff  GraphicsServices armv7  <e21a6e61bdd136b6805a9e3abe2e3d1f> /System/Library/PrivateFrameworks/GraphicsServices.framework/GraphicsServices
0x3449a000 - 0x3449afff  liblangid.dylib armv7  <644ff4bcfbf337b5b5859e3f0fc0a9a8> /usr/lib/liblangid.dylib
0x344d2000 - 0x344d6fff  FTClientServices armv7  <21de970d7ebb3e7fb502a0a5451b0806> /System/Library/PrivateFrameworks/FTClientServices.framework/FTClientServices
0x34530000 - 0x34573fff  libcommonCrypto.dylib armv7  <95b49daf4cf038b6bea8010bba3a1e26> /usr/lib/system/libcommonCrypto.dylib
0x345a9000 - 0x345bafff  DataAccessExpress armv7  <e6144ba265da3bb7b9a263aa1a29b054> /System/Library/PrivateFrameworks/DataAccessExpress.framework/DataAccessExpress
0x345c5000 - 0x345d1fff  CoreVideo armv7  <364fa32d513f3c11b50970120545f1a8> /System/Library/Frameworks/CoreVideo.framework/CoreVideo
0x345d2000 - 0x34620fff  CoreLocation armv7  <44550ebedf23334d85441d9743b74e03> /System/Library/Frameworks/CoreLocation.framework/CoreLocation
0x3466d000 - 0x3475bfff  libiconv.2.dylib armv7  <2cfefe2ad1d335dd9549562910e7a2e2> /usr/lib/libiconv.2.dylib
0x34767000 - 0x3477dfff  libsystem_kernel.dylib armv7  <7ac5560851ce3cb3981068092074b409> /usr/lib/system/libsystem_kernel.dylib
0x347b8000 - 0x3483efff  CoreMotion armv7  <6a9355d5a8e238b5b8f193605d509e15> /System/Library/Frameworks/CoreMotion.framework/CoreMotion
0x34858000 - 0x348b0fff  CoreAudio armv7  <be335e8eb6f93594b028a6ddd503a183> /System/Library/Frameworks/CoreAudio.framework/CoreAudio
0x348d0000 - 0x348d8fff  MobileWiFi armv7  <b76c3e9fb78234c392058250d4620e72> /System/Library/PrivateFrameworks/MobileWiFi.framework/MobileWiFi
0x348dd000 - 0x34902fff  OpenCL armv7  <ec915bfc3f7633dda61b5fc87459119b> /System/Library/PrivateFrameworks/OpenCL.framework/OpenCL
0x34928000 - 0x34937fff  MobileDeviceLink armv7  <70ac33720f513f0f97ea2279260678ca> /System/Library/PrivateFrameworks/MobileDeviceLink.framework/MobileDeviceLink
0x34a7f000 - 0x34b41fff  Celestial armv7  <2a59586b0ae937c3b25fe526924aa885> /System/Library/PrivateFrameworks/Celestial.framework/Celestial
0x34cf9000 - 0x34d10fff  WebBookmarks armv7  <bd20a05587783a8e9596eef1d3615ea7> /System/Library/PrivateFrameworks/WebBookmarks.framework/WebBookmarks
0x34d11000 - 0x34d17fff  MobileKeyBag armv7  <e1f06241ef0e3f0aae00f15df572077e> /System/Library/PrivateFrameworks/MobileKeyBag.framework/MobileKeyBag
0x34e04000 - 0x350c5fff  libLAPACK.dylib armv7  <0e94e9a7e7a334649afaccae0f1215a2> /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/libLAPACK.dylib
0x350c6000 - 0x3512afff  MessageUI armv7  <b74d79ea691a35ada276f063b7217a20> /System/Library/Frameworks/MessageUI.framework/MessageUI
0x3517e000 - 0x35185fff  libc++abi.dylib armv7  <bab4dcbfc5943d3fbb637342d35e8045> /usr/lib/libc++abi.dylib
0x35186000 - 0x351c1fff  libCGFreetype.A.dylib armv7  <55941c96cf1f3b048e72a148c4496c16> /System/Library/Frameworks/CoreGraphics.framework/Resources/libCGFreetype.A.dylib
0x35304000 - 0x35848fff  FaceCoreLight armv7  <f326d88709683520b251dc53cb847c11> /System/Library/PrivateFrameworks/FaceCoreLight.framework/FaceCoreLight
0x35857000 - 0x35861fff  libbz2.1.0.dylib armv7  <40e4045fb79e382b8833707746cf28b1> /usr/lib/libbz2.1.0.dylib
0x35862000 - 0x358d2fff  CoreImage armv7  <86ac6f5a267637b6b7f8a831dfc7c64b> /System/Library/Frameworks/CoreImage.framework/CoreImage
0x358d3000 - 0x358d7fff  libGFXShared.dylib armv7  <998fccc16cf735dbb62324202995e193> /System/Library/Frameworks/OpenGLES.framework/libGFXShared.dylib
0x358d8000 - 0x3590dfff  DataAccess armv7  <89fd0c22338b37538cf61803a0bca9e2> /System/Library/PrivateFrameworks/DataAccess.framework/DataAccess
0x3590e000 - 0x35953fff  GeoServices armv7  <a26be2e76e8730ab91a16502aba376be> /System/Library/PrivateFrameworks/GeoServices.framework/GeoServices
0x359ac000 - 0x359acfff  Accelerate armv7  <55b24cf91a8b3532bde6733c96f14c08> /System/Library/Frameworks/Accelerate.framework/Accelerate
0x359ad000 - 0x35b53fff  CoreData armv7  <b0215b6d4d143859a2b313ecade095ec> /System/Library/Frameworks/CoreData.framework/CoreData
0x35c21000 - 0x35ca0fff  libsqlite3.dylib armv7  <bf01f5ed47b033d8bde30d735ff44416> /usr/lib/libsqlite3.dylib
0x35ca1000 - 0x35cf2fff  CoreText armv7  <5bfac4ee88d03d5b87a1f105abb7756c> /System/Library/Frameworks/CoreText.framework/CoreText
0x35d2a000 - 0x35d2efff  libAccessibility.dylib armv7  <9a17d07b5a3b38cfafdf16f78c99b572> /usr/lib/libAccessibility.dylib
0x35d2f000 - 0x35d6dfff  IOKit armv7  <fcda71d29d6136dfbd84c1725f4998e5> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
0x35dd6000 - 0x35e1ffff  libc++.1.dylib armv7  <5b690e5dd5a43a7fb166ade9fe58a7a4> /usr/lib/libc++.1.dylib
0x35e20000 - 0x35f11fff  QuartzCore armv7  <a2afbe6483683d05ad51b106f98776e2> /System/Library/Frameworks/QuartzCore.framework/QuartzCore
0x35fa8000 - 0x35fccfff  PrintKit armv7  <08509c7bc915358b953de6f5cbef5c56> /System/Library/PrivateFrameworks/PrintKit.framework/PrintKit
0x35fcd000 - 0x36073fff  AddressBookUI armv7  <da424fecc66e3628ab03378ae80b38fc> /System/Library/Frameworks/AddressBookUI.framework/AddressBookUI
0x360e1000 - 0x360e2fff  libdnsinfo.dylib armv7  <9aede8d6579d3430ac39ae5f95cce498> /usr/lib/system/libdnsinfo.dylib
0x36193000 - 0x361dffff  CoreTelephony armv7  <e8eb52ca5fe33c7488a33efd222e7804> /System/Library/Frameworks/CoreTelephony.framework/CoreTelephony
0x361e0000 - 0x361f6fff  libmis.dylib armv7  <258bc92be5823b239b4412dd42cb4807> /usr/lib/libmis.dylib
0x361ff000 - 0x36203fff  CertUI armv7  <f503892ef60e36108d28d8f9d6144d2a> /System/Library/PrivateFrameworks/CertUI.framework/CertUI
0x3620f000 - 0x3622ffff  libxslt.1.dylib armv7  <39348471007e39dab80af68b08390456> /usr/lib/libxslt.1.dylib
0x362dd000 - 0x362defff  libsystem_blocks.dylib armv7  <9fdc27af7350323bbc7d98e14e027907> /usr/lib/system/libsystem_blocks.dylib
0x362df000 - 0x36302fff  MobileSync armv7  <e42604c550283f4aa517ae8f108b340f> /System/Library/PrivateFrameworks/MobileSync.framework/MobileSync
0x36e39000 - 0x36e4ffff  libdispatch.dylib armv7  <9ecfaef4110a3bf9a92d12f0fe8d1d78> /usr/lib/system/libdispatch.dylib
0x36ebd000 - 0x36f6afff  libxml2.2.dylib armv7  <58d47f064e0232119f4b838ad659f9c1> /usr/lib/libxml2.2.dylib
0x36f7e000 - 0x36fbafff  IMFoundation armv7  <77bb4365a65b32a49523b03da0340dbc> /System/Library/PrivateFrameworks/IMCore.framework/Frameworks/IMFoundation.framework/IMFoundation
0x3708a000 - 0x370c1fff  Security armv7  <eea56f71fde83c2981f9281dc7823725> /System/Library/Frameworks/Security.framework/Security
0x3724d000 - 0x37291fff  MobileCoreServices armv7  <757226927a873d5492be721908077b48> /System/Library/Frameworks/MobileCoreServices.framework/MobileCoreServices
0x37292000 - 0x3729afff  ProtocolBuffer armv7  <0e846afacf823d2b8c029cc3010a8253> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/ProtocolBuffer
0x373b4000 - 0x373bafff  liblockdown.dylib armv7  <9e45ce468a6f31e5b8263f2c224aa800> /usr/lib/liblockdown.dylib
0x373c3000 - 0x373f7fff  MIME armv7  <d30292ea8f7e360fa5f5d5b1b62b602d> /System/Library/PrivateFrameworks/MIME.framework/MIME
0x374af000 - 0x374c5fff  DictionaryServices armv7  <6ed2e967136f37d4a4b9b318d6c43b83> /System/Library/PrivateFrameworks/DictionaryServices.framework/DictionaryServices
0x374cf000 - 0x374f2fff  Bom armv7  <c3435ecd2e5839f89de51edad0e1bb00> /System/Library/PrivateFrameworks/Bom.framework/Bom
0x374f3000 - 0x37720fff  MediaToolbox armv7  <ec9bc89489763c6c93f86c5c490b2d69> /System/Library/PrivateFrameworks/MediaToolbox.framework/MediaToolbox
0x37789000 - 0x37789fff  libunwind.dylib armv7  <e0a73a57795f3e1698a52ebe6fc07005> /usr/lib/system/libunwind.dylib
0x37869000 - 0x37888fff  libSystem.B.dylib armv7  <0c55744b6f7335eebba4ca2c3d10b43c> /usr/lib/libSystem.B.dylib
0x37890000 - 0x378e1fff  libstdc++.6.dylib armv7  <c352af5a742e3c7a8d4d7e5f6f454793> /usr/lib/libstdc++.6.dylib
0x378f3000 - 0x378f4fff  libdyld.dylib armv7  <977b0ad6f2f433108b4a0324a57cd2ab> /usr/lib/system/libdyld.dylib
0x3795c000 - 0x37a33fff  CFNetwork armv7  <765a472c824830eea91b8f02d12867e4> /System/Library/Frameworks/CFNetwork.framework/CFNetwork
0x37be4000 - 0x37be5fff  CoreSurface armv7  <7850befd26b630f183ee326aaadd7b34> /System/Library/PrivateFrameworks/CoreSurface.framework/CoreSurface
0x37be6000 - 0x37c72fff  libsystem_c.dylib armv7  <f859ce1ad1773f0ba98d7c6e135b7697> /usr/lib/system/libsystem_c.dylib
0x37c75000 - 0x37c79fff  Marco armv7  <8dea3e558fe534ff868fc92e215ce53b> /System/Library/PrivateFrameworks/Marco.framework/Marco
0x37cad000 - 0x37cb0fff  libsystem_network.dylib armv7  <356cb66612e836968ef24e6e5c3364cc> /usr/lib/system/libsystem_network.dylib
0x37cb3000 - 0x37d2cfff  ProofReader armv7  <6db611d8df6530d480f97a40bc519f70> /System/Library/PrivateFrameworks/ProofReader.framework/ProofReader
0x37d2d000 - 0x37d30fff  libcompiler_rt.dylib armv7  <b2c05d8601c13be884097192dca4e187> /usr/lib/system/libcompiler_rt.dylib
0x37e09000 - 0x37e41fff  VideoToolbox armv7  <9f25f38d1cd13a1daff99cfde8884410> /System/Library/PrivateFrameworks/VideoToolbox.framework/VideoToolbox
0x37ecf000 - 0x37edefff  GenerationalStorage armv7  <d84c3fd0e7bd36e78c256f2f4c5a4e91> /System/Library/PrivateFrameworks/GenerationalStorage.framework/GenerationalStorage
0x37edf000 - 0x37ee5fff  MobileIcons armv7  <ed1b46f917903c9b9baaa2be4392dafe> /System/Library/PrivateFrameworks/MobileIcons.framework/MobileIcons
0x37eea000 - 0x37f13fff  AppleAccount armv7  <2ba44023410231fcb3f72f762ea3ce6e> /System/Library/PrivateFrameworks/AppleAccount.framework/AppleAccount
0x38097000 - 0x381dcfff  CoreGraphics armv7  <903545b89a7f311d95100ac7d1d44709> /System/Library/Frameworks/CoreGraphics.framework/CoreGraphics
0x381e3000 - 0x38291fff  Message armv7  <b8221d43401d315fb84398b7aa570fc1> /System/Library/PrivateFrameworks/Message.framework/Message 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:09:45.193

确保您了解更新的机制，而不是全新安装。

许多开发人员都遇到的一个常见问题；

NSUserDefaults 与您的应用程序的先前版本保持一致，这可能会使您的应用程序进入您从未真正假设/测试过的状态。

您的应用程序的整个沙箱（文档文件夹等）保持不变 - 旧文件仍然存在，并且只有在新版本实际存在时才会被新版本覆盖。

为了在与真实交易匹配的环境中正确测试更新，一种可能的解决方案是使用越狱设备。

*   首先安装旧版本——使用 iPhone 配置实用程序执行此步骤或使用 SFTP 客户端

*   运行它并确保你触发了所有可能将文件写入设备的东西

*   然后用您的新应用程序版本覆盖旧版本（但请确保您没有删除任何内容）——在此步骤中使用 SFTP 客户端

*   再次运行应用程序，看看会发生什么

您将需要一个越狱设备，因为除了直接 (s)FTP 上传之外的任何东西都会首先删除旧版本并用新版本完全替换它。您不希望这种情况发生，因为当您通过 AppStore 更新应用程序时不会发生这种情况。此外，越狱设备将允许您在不通过 AppStore 安装的情况下运行 AppStore 构建，因此另一个问题使您更接近真实场景。

# windows-phone-7 - 在 WP7 中进行同步 Http/REST 调用？

> ID：10262163
> 
> 赞同：2
> 
> 时间：2012-04-21T19:16:08.297
> 
> 标签：windows-phone-7, httpwebrequest

我一直在研究 Windows Phone 7 应用程序并试图通过使用 HttpWebRequest.GetResponse() 进行同步 REST 调用，但编译器抱怨 GetResponse() 不可用。我在 HttpWebRequest 中找到了 BeginGetResponse() 和 EndGetResponse()。但是当我读到这两种方法用于异步调用时。

我们的设计已实现仅支持同步请求，谁能告诉我“有什么方法可以在 WP7 中进行同步调用”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:21:52.167

`AutoResetEvent`您可以通过阻塞直到异步调用返回来模拟同步请求。[请参阅此处以获取参考实现。](http://dotnet.dzone.com/news/adding-synchronous-methods)

# excel - 这个VB代码有什么问题？

> ID：10262170
> 
> 赞同：-5
> 
> 时间：2012-04-21T19:16:48.887
> 
> 标签：excel, vba

```
Function nameTonumber(name As String)

    Dim number As Integer
    number = 0

    If (name = "Aa") Then

        number = 1

    ElseIf (name = "Bb") Then

        number = 2

    ElseIf (name = "Cc") Then

        number = 3

    Else

        number = 0

    End If

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:21:00.577

1.  条件句周围的括号`If`是多余的。
2.  是多余的`Else`- <code>number 已经为零。
3.  您不返回任何值。
4.  您没有指定返回类型。
5.  您可以使用`Select Case`使这种形式的多个测试更具可读性。

如果这是 VB.NET 代码，还有更多。

从风格上讲，您的代码占用了太多空间：删除不必要的空行，它们不会使代码更具可读性 - 相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:54:39.883

将第一行更改为： Function nameTonumber(name As String) As Integer

在结束函数之上添加：

nameTonumber=number '如果您使用的是 VB6.

return number '如果你使用的是 VB.NET

# c# - 设计问题：在使用 Consts 时尽量避免代码重复

> ID：10262171
> 
> 赞同：0
> 
> 时间：2012-04-21T19:16:50.027
> 
> 标签：c#, inheritance, constants

考虑这个类图：

![在此处输入图像描述](../Images/91003ce3ee3ad4052c81359f2c197ffe.png)

汽车的最高速度**恒定**为 200 公里/小时，公共汽车的最高速度为 100 公里/小时。我将其表示为子类中的 const maxSpeed 字段；

如何让 getMaxSpeed() 返回这个常量。这是一个简单的示例，仅用于说明我的问题，因此将 getMaxSpeed() 复制到每个子类对我没有帮助。

有什么办法吗？

我已经考虑过避免使用 const 和使用虚拟属性的解决方案，但是该类的每个实例都会保存一个 maxSpeed 字段，这很浪费空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:58:42.157

虚拟化的全部意义在于您在编译时不知道要调用什么方法，因此 a `const`can 是不可能的`virtual`。典型的解决方案是先`abstract public double MaxSpeed { get; }`在基类中，然后`override public double MaxSpeed { get { return 200; } }`在`Car`派生类中。

此解决方案允许复杂的 JIT 编译器确定 a 的特定实例`Vehicle`始终为 a`Car`并能够内联`get_MaxSpeed`方法调用（如您所愿），同时仍允许每辆车拥有自己的最大速度。

# c# - 实现业务逻辑时如何避免使用数字或枚举

> ID：10262173
> 
> 赞同：2
> 
> 时间：2012-04-21T19:17:01.927
> 
> 标签：c#

我正在努力在我的 C# 应用程序中实现业务逻辑。我无法将逻辑拟合到一段理智的代码中。实现的逻辑是这样的：

有一棵元素树，比如说：项目、国家、地区、城市。单个项目包含国家。国家包含地区，地区包含城市，城市包含数据条目。我们将根据可用信息使用数据条目填充元素。

*   如果*Country*、*Region*和*City*信息可用，则将数据推送到项目并使用该信息知道在哪里插入数据条目。
*   如果*国家*信息不可用，则创建一个新*国家*并使用*地区*和*城市*信息插入数据条目。
*   如果只有城市信息可用，请在新*国家/**地区*内创建一个新区域并使用*城市*信息将数据放在那里。
***   如果没有可用信息，请在新国家/地区内的新区域内创建新城市*并将**数据*放在*那里*。***   如果任何信息不可用（例如*Country*和*Region*可用但*City*不可用），我们必须回退到更一般的情况（在这种情况下创建新的*Country*、*Region*和*City*）。****

 **此外：

*   创建叶类时，必须在构造函数中提供父类。
*   查询可用的信息是昂贵的。
*   我想避免重复创建新类的代码。
*   我不能改变类的实现`Country`，，。`Region``City`

我下面的解决方案有效，但它很丑陋，使用整数来控制应用程序流让我不寒而栗。

**如何改进下面的代码片段？**

```
Country country = null;
Region region = null;
City city = null;

int level;

if (!IsCityInfoAvailable())
{
    // we have to make a new country, region and city
    level = 3;
}
else if (!IsRegionInfoAvailable())
{
    // we have to make a new country and region
    level = 2;
}
else if (!IsCountryRegionAvailable())
{
    // we have to make a new country
    level = 1;
}
else
{
    // we have all the info we need
    level = 0;
}

IDataEntryTarget target;

if (level > 0)
{
    country = new Country(Project, "Unnamed Country");
    target = country;
}
if (level > 1)
{
    region = new Region(country, "Unnamed Region", Region.DefaultRegionSettings);
    target = region;
}
if (level > 2)
{
    city = new City(region, "Unnamed City", 0);
    target = city;
}

// ... proceed with data entry code using `target`... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:33:16.743

**编辑：**像这样尝试：我唯一的问题是城市、地区和国家在哪里初始化？在 Is() 方法中？

```
Func<Country> GetCountry = () => country ?? (country = new Country(Project, "Unnamed Country"));
Func<Region> GetRegion = () => region ?? (region = new Region(GetCountry(), "Unnamed Region", Region.DefaultRegionSettings));
Func<City> GetCity = () => city ?? (city = new City(GetRegion(), "Unnamed City", 0));

IDataEntryTarget target = null;

if (!IsCityInfoAvailable())
{
    // we have to make a new country, region and city
     target = GetCity();
}
else if (!IsRegionInfoAvailable())
{
    // we have to make a new country and region
    target = GetRegion();
}
else if (!IsCountryRegionAvailable())
{
    // we have to make a new country
    target = GetCountry();
} 
```**

# php - 带有返回码和返回信息的 PHP 函数

> ID：10262176
> 
> 赞同：2
> 
> 时间：2012-04-21T19:17:23.783
> 
> 标签：php, javascript, ajax, json

这个 php 代码是通过 ajax 从 javascript 调用的，应该返回一个数字代码和一条消息。我可以从 PHP 脚本返回一个数组，但是当我读取 ajax 响应时，响应包含的不仅仅是返回的数组，它还有其他回显语句。有没有办法从仅返回数组的 Php 发送信息？我只想要 json 对象`{"return_code":0,"return_msg":"Login successful."}`。

这是通过 ajax 返回到 javascript 的信息`alert(login_info);`。

> ```
> Warning: date(): It is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the 
> ```
> 
> date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们在第 60 行的 /Library/WebServer/Documents/Pagelinks_Dev/login_user.php 中为 'EDT/-4.0/DST' 选择了 'America/New_York' {"return_code":0,"return_msg":"登录成功。"}

这是ajax调用。

```
var message = $.ajax({
    url: "login_user.php",
    type: "POST",
    data: { username_email: username_email, upass: user_passwd },
    cache: false,
    async: false,
    success: function (login_info) {
        if (login_info != '') 
        {
          alert(login_info);
        }
    },
    error: function (request, status, error) {
        alert ("status "+status+" error "+error+"responseText "+request.responseText);
    },
}).responseText; 
```

PHP 脚本

```
<?php include("dbconnect.php"); ?>

<?php
ini_set('display_errors', 1);
error_reporting(E_ALL);
session_start();

function login_user( $username_email, $password_text ) {
    global $dbco;

    $password = md5($password_text);
    $privPost = 1; // 3: max.
    $privSedit = 0;

    $messages = array( 'log_no_un_em' => 'Enter username or email.',
            'log_no_pw' => 'Enter password.',
            'log_un_em_pw_incorrect' => 'Incorrect login info.',
            'log_success' => 'Login successful.'
    );

    $return = array();

    $l_un_em = isset($username_email) ? $username_email : '';
    $l_pword = isset($password_text) ? $password_text : '';

    if (!$l_un_em) {
        /* echo $messages['log_no_un_em'];
        return; */
        $return['return_code'] = -1;
        $return['return_msg'] = $messages['log_no_un_em'];
        echo json_encode($return);
    }
    if (!$l_pword) {
        /* echo $messages['log_no_pw'];
        return; */
        $return['return_code'] = -1;
        $return['return_msg'] = $messages['log_no_pw'];
        echo json_encode($return);
    }

    mysql_select_db("luxcal", $dbco);

    while (true) {
        $md5_pw = md5($password_text);
        $r_getuser = mysql_query("SELECT * FROM users WHERE (user_name = BINARY '".mysql_real_escape_string($l_un_em)."' OR email = '".mysql_real_escape_string($l_un_em)."') AND (password = '$md5_pw' OR temp_password = '$md5_pw') AND status >= 0");
        if (mysql_num_rows($r_getuser) == 0) {
            /* echo $messages['log_un_em_pw_incorrect'];
            return; */
            $return['return_code'] = -1;
            $return['return_msg'] = $messages['log_un_em_pw_incorrect'];
            echo json_encode($return);
        }
        $row = mysql_fetch_assoc($r_getuser);
        /* if ($row['privs'] < 1) { echo $messages['log_no_privs']; break; } */
        if ($row['temp_password'] == $md5_pw) { //new password
            mysql_query("UPDATE users SET password = '".$md5_pw."', temp_password = NULL WHERE user_id = '{$row['user_id']}'");
        }
        $today = date('Y-m-d');
        if ($row['login_0'][0] == '9') { //first login
            mysql_query("UPDATE users SET login_0 = '".$today."', login_1 = '".$today."', login_cnt = 1 WHERE user_id = '{$row['user_id']}'");
        } else {
            mysql_query("UPDATE users SET login_1 = '".$today."', login_cnt = login_cnt+1 WHERE user_id = '{$row['user_id']}'");
        }
        $_SESSION['uid'] = $row['user_id'];
        $_SESSION['unm'] = stripslashes($row['user_name']);
        $_SESSION['uml'] = stripslashes($row['email']);
        $_SESSION['cL'] = $row['language'];
        /* echo '<meta http-equiv="refresh" content="0;url=livemass_CENTER34.php">'; */ //default page
        break;
    }

    $return['return_code'] = 0;
    $return['return_msg'] = $messages['log_success'];

    echo json_encode($return);
    /* return; */
}

echo login_user(trim($_REQUEST['username_email']), trim($_REQUEST['upass']));

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:32:55.940

在你的 php 文件中使用

```
 date_default_timezone_set('your time zone'); 
```

告诉 php 你的时区是什么。有关更多详细信息，请参阅[date_default_timezone_set()](http://php.net/manual/en/function.date-default-timezone-set.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:21:04.827

如果要返回 json，则不能使用 json 字符串输出任何其他文本。更改`ini_set('display_errors', 1);`为`ini_set('display_errors', 0);`

# c++ - 音频输入示例不起作用 - QAudioInput: IOError

> ID：10262177
> 
> 赞同：1
> 
> 时间：2012-04-21T19:17:32.567
> 
> 标签：c++, qt, audio

我是 Qt 的新手。（C++ 也是如此）

我从 QAudioInput 类参考中看到了一个示例，为了通过编译，我做了一些更改（您从我的代码中看到的示例与示例的所有差异都是因为一开始编译失败）。

我在网上查了很多，还是一无所获。示例[http://doc.qt.io/archives/qt-4.7/multimedia-audioinput-audioinput-h.html](http://doc.qt.io/archives/qt-4.7/multimedia-audioinput-audioinput-h.html) 确实有效。我仔细阅读了它，除了我的是保存到文件之外没有什么不同，而那个是保存到缓冲区。

所以，请帮助我 1，导致 QAudioInput: IOError 的原因是什么（我知道 IO 设备有问题，但问题是什么？） 2，我怎样才能使代码工作？

这是代码：

```
 //audioprocess.h
#ifndef AUDIOPROCESS_H
#define AUDIOPROCESS_H

#include <QAudioInput>
#include <QFile>
#include <QDebug>
#include <QTimer>
#include <QObject>

class audioprocess : public QObject
{
  Q_OBJECT
public:
  void startRecording();
private slots:
  void stopRecording();
private:
  QFile outputFile; // class member.
  QAudioInput *audioInput; // class member.
};

#endif // AUDIOPROCESS_H

//----------------------------------------------
//audioprocess.cpp

#include "audioprocess.h"

void audioprocess::startRecording()
{
  outputFile.setFileName("/audio_qt.raw");
  outputFile.open( QIODevice::WriteOnly | QIODevice::Truncate );

  QAudioFormat format;
  // set up the format you want, eg.
  format.setFrequency(8000);
  format.setChannels(1);
  format.setSampleSize(8);
  format.setCodec("audio/pcm");
  format.setByteOrder(QAudioFormat::LittleEndian);
  format.setSampleType(QAudioFormat::UnSignedInt);

  QAudioDeviceInfo info = QAudioDeviceInfo::defaultInputDevice();
  if (!info.isFormatSupported(format)) {
  qWarning()<<"default format not supported try to use nearest";
  format = info.nearestFormat(format);
  }

  audioInput = new QAudioInput(format,reinterpret_cast<QObject*>(this));

  QTimer::singleShot(100, reinterpret_cast<QObject*>(this), SLOT(stopRecording()));
  audioInput->start(&outputFile);
  // Records audio for 3000ms
}

void audioprocess::stopRecording()
{
  audioInput->stop();
  outputFile.close();
  delete audioInput;
}
//--------------------------------------------------------

//main.cpp
#include <QtGui/QApplication>
#include "audioprocess.h"

int main(int argc, char *argv[])
{
  QApplication a(argc, argv);
  audioprocess audiorecord;
  audiorecord.startRecording();

  return a.exec();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:46:19.887

您确定应用程序有权写入根文件夹（文件名=“/audio_qt.raw”）吗？

我会尝试写入用户的主文件夹。

检查这是否真的是问题的一个快速测试是检查`outputFile.open()`(应该返回 true) 的返回值。

# c# - 如何删除按钮运行时间？

> ID：10262178
> 
> 赞同：1
> 
> 时间：2012-04-21T19:17:33.570
> 
> 标签：c#, winforms, button

我的 C# winform 项目有问题。
在我的项目中，我有在运行时创建一个新按钮的功能。因为有时我制作了太多按钮，所以我想编写一个函数来删除我想在运行时删除的按钮。有人可能已经有了这个功能？

```
private void button2_Click(object sender, EventArgs e)
{
        Button myText = new Button();
        myText.Tag = counter;
        myText.Location = new Point(x2,y2);
        myText.Text = Convert.ToString(textBox3.Text);
        this.Controls.Add(myText);
} 
```

这就是我在运行时制作按钮的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:35:45.370

为了删除您添加的最后一个按钮，您可以使用以下内容：

```
//a list where you save all the buttons created
List<Button> buttonsAdded = new List<Button>();

private void button2_Click(object sender, EventArgs e)
{
    Button myText = new Button();
    myText.Tag = counter;
    myText.Location = new Point(x2,y2);
    myText.Text = Convert.ToString(textBox3.Text);
    this.Controls.Add(myText);
    //add reference of the button to the list
    buttonsAdded.Insert(0, myText);

}

//atach this to a button removing the other buttons
private void removingButton_Click(object sender, EventArgs e)
{
    if (buttonsAdded.Count > 0)
    {
        Button buttonToRemove = buttonsAdded[0];
        buttonsAdded.Remove(buttonToRemove);
        this.Controls.Remove(buttonToRemove);
    }
} 
```

这应该允许您通过始终删除现有按钮中添加的最后一个按钮来删除任意数量的按钮。

**更新**

如果您希望能够将鼠标光标悬停在按钮上，然后使用*Delete*键将其删除，则可以使用以下解决方案：

*   设置`KeyPreview`为*true*，因此`Form`可以接收在其控件中发生的关键事件
*   添加`buttonsAdded`列表并`button2_Click`按照此答案中描述的第一个解决方案进行修改

*   为您创建`KeyDown`事件处理程序`Form`并添加此代码：

    ```
    private void MySampleForm_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.Delete)
        {
            //get control hovered with mouse
            Button buttonToRemove = (this.GetChildAtPoint(this.PointToClient(Cursor.Position)) as Button);
            //if it's a Button, remove it from the form
            if (buttonsAdded.Contains(buttonToRemove))
                {
                    buttonsAdded.Remove(buttonToRemove);

                    this.Controls.Remove(buttonToRemove);
                }
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T19:20:24.580

你应该可以使用 this.Controls.Remove(myText);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:31:37.367

```
public Button myText ; // keep public button to assign your new Button 

private void buttonAdd_Click(object sender, EventArgs e)
{
        myText = new Button();
        myText.Tag = counter;
        myText.Location = new Point(x2,y2);
        myText.Text = Convert.ToString(textBox3.Text);
        this.Controls.Add(myText);
}

private void buttonRemove_Click(object sender, EventArgs e)
{
      if(Button != null && this.Controls.Contains(myText))
      {
           this.Controls.Remove(myText);
           myText.Dispose();
      )
} 
```

如果您想在删除按键时删除，您可以使用如下按键事件

```
private void Window_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.Delete)
    {
          if(Button != null && this.Controls.Contains(myText))
          {
               this.Controls.Remove(myText);
               myText.Dispose();
          )
    }
} 
```

# vba - VB6值传递和引用传递

> ID：10262186
> 
> 赞同：12
> 
> 时间：2012-04-21T19:18:01.570
> 
> 标签：vba, vbscript, vb6

我正在努力理解 VB6 中的值传递和引用传递。我在 .NET 和 Java 等面向对象的编程语言中完全理解这些概念（我意识到 Java 没有通过引用传递）。看看下面的代码：

```
Private Sub Form_Load()

Dim Test As Integer
Test = 1
TestFunction Test 'line 5
MsgBox (Test)

End Sub

Private Sub TestFunction(ByVal i As Integer)
    i = i + 1
End Sub 
```

当我在第 5 行的 Test 周围加上括号时，消息框会按我的预期打印 1。现在看看下面的代码：

```
Private Sub Form_Load()

Dim Test As Integer
Test = 1
TestFunction Test 'line 5
MsgBox Test

End Sub

Private Sub TestFunction(ByRef i As Integer)
    i = i + 1
End Sub 
```

正如我所料，消息框打印 2 。但是，如果您在第 5 行添加方括号，那么消息框会打印 1，这与我的预期不同。即使被调用函数中定义的变量是 ByRef，调用函数似乎也可以按值传递。反之亦然，即如果被调用函数的签名带有定义为 ByVal 的变量，那么它将始终是 ByVal（即使调用函数中的变量周围没有括号）。VB6背后的想法是什么？我意识到这是 VB6 中的一个基本问题，但它让我感到困惑。我已经阅读了 MSDN 文档，我意识到这一切都是真的，但是它并没有解释其背后的原因。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-21T19:27:30.070

这是 VB6 中的经典问题。[VB6 手册中对此进行了](http://msdn.microsoft.com/en-us/library/aa263527(VS.60).aspx)说明。在下面的代码中，VB6 将参数视为*表达式*(Test) 而不是变量引用

```
TestFunction (Test) 
```

为了传递对变量的引用，要么省略括号，要么使用遗留[`Call`语句](http://msdn.microsoft.com/en-us/library/aa243242%28v=vs.60%29.aspx)（需要括号）

```
TestFunction Test
Call TestFunction(Test) 
```

VB6 允许您将表达式传递给`ByRef`参数，即使方法更改了它们。例如你可以写

```
TestFunction (Test + 2) 
```

编译器创建一个临时副本并通过引用传递它。VB.Net[以类似的方式使用括号](http://msdn.microsoft.com/en-us/library/chy4288y.aspx)。

如果 TestFunction 采用如下两个参数，您还可以让编译器创建临时副本：

```
TestFunction (one), (two) 
```

即使将括号加倍，也可以获得临时副本`Call`，添加一个额外的不必要的对：

```
Call TestFunction((Test)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-21T19:32:21.860

将任何表达式括在括号内会导致在执行任何其他操作之前先计算该表达式，*即使该表达式只是一个变量*。在您的情况下，该表达式的结果然后作为参数传递。

因此，您实际上是通过引用传递参数。但是您传递的参数是表达式的结果，而不是原始变量。这就是为什么原始变量没有得到更新的原因。

# audio - 精确的 mp4 帧速率（同步问题）

> ID：10262190
> 
> 赞同：4
> 
> 时间：2012-04-21T19:18:43.770
> 
> 标签：audio, sync, mp4, frame-rate, sample-rate

我正在编写一个音频扩展器来将音频从 24p 转换为 PAL 视频。24p 是 24000 / 1001 ~= 23.976 fps PAL 正好是 25 fps。

我使用的算法非常简单。如果“m”是输出样本数，“n”是输入样本数，则 m = floor(f(n + 0.5))，其中 f 是速度因子。在这种情况下 f = 25 / (24000 / 1001) = 1001 / 960 。是的，我基本上每 30 个左右的样本丢弃一次样本，但音频应该是同步的，而且你会听到大约 2kHz 的振铃。

但是，在生成的视频中，我在电影 1.5 小时后的 0.1 - 0.3 秒内可能失去了 a/v 同步。

我尝试通过使用长双精度而不是双精度来提高计算精度，但我得到了相同的音频偏移量。无论如何，只要你有 >9 sig figs，这不应该是一个因素，因为在 48kHz 采样的 2 小时电影中有 345 600 000 个样本。

我不认为我错过了一些神奇的同步数据，因为当我将原始视频拆分为视频和 wav 文件并将它们一起播放时，它们完全保持同步。

我意识到媒体容器/流可能不会将帧速率存储为有理数，即 24000 / 1001 ，（如果我错了，请纠正我！）他们会使用小数。如果是这样，我的加速因子不正确。

我尝试从各种播放器获取 fps：ffmpeg 23.98、vlc 23.976023。但我真的需要知道原始视频的*确切*帧率。从外观上看，它需要小数点后 5 位（0.2s / 2hrs）。我尝试插入 vlc 的 fps，但我仍然有点出局。

总而言之，有没有办法从 mp4 文件中提取准确的帧率？

或者我在这里错过了一些东西，比如让流保持同步的交错。

（代码在这里[https://raw.github.com/rhlee/speed-alpha/22c28ddcb357649efd3dedd099e159ff024657fe/speed.c](https://raw.github.com/rhlee/speed-alpha/22c28ddcb357649efd3dedd099e159ff024657fe/speed.c)如果有人感兴趣的话。）

# maven - M2E 删除我的源目录？

> ID：10262193
> 
> 赞同：0
> 
> 时间：2012-04-21T19:18:55.470
> 
> 标签：maven, m2e

我有一个在 Eclipse 中构建的现有库，并已使用 m2e 将 Maven 性质添加到我的项目中以添加依赖项。当我将它转换为 Maven 项目时，我现有的源目录（和我的 bin）成为普通文件夹。是否有一个原因？我是 Maven 的新手，所以我可能做错了什么，只是不确定是什么......

我的项目结构如下：

```
workspace
  project
    src (in build path)
    resources (in build path)
    bin (output dir) 
```

我尝试了“mvn eclipse：eclipse”并右键单击项目->配置->转换为Maven项目，并从我的构建路径中删除了我的src和资源文件夹，并将结构更改为以下内容后，将输出更改为目标/测试用例。即使我手动调整构建路径和输出，我的依赖项也无法解决。

```
workspace
  project
    src (no longer in build path)
    resources (no longer in build path)
    bin  (no longer output)
    target (new output dir)
      test-cases (empty) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:31:39.467

我认为您在使用 Eclipse（没有 Maven）时具有以下结构：

```
/workspace
  /project1
    .project
    /src
    /bin 
```

但是Maven想使用如下结构

```
/workspace
  /project1
     .project
     pom.xml
     /src
        /main
           /java
           /resources
        /test
           /java
     /target
        /classes
        /test-classes 
```

等等。所以很正常，该文件夹`src`不再是 Eclipse 的直接源文件夹，但现在有`src/main/java`, `src/main/resources`, ...

因此，在开始时从一个新的 Maven 项目开始，并将您的原始源代码移动到它们应该属于的目录会更容易。Maven 有着悠久的传统，即“约定优于配置”，偏离这一点是可能的。查看[“处理非常规源目录...”](https://stackoverflow.com/questions/224373/handling-unconventional-source-directory-for-a-web-project-in-maven)的答案以解决此问题。

# php - “{% %}”语法是什么意思？

> ID：10262195
> 
> 赞同：-1
> 
> 时间：2012-04-21T19:19:25.860
> 
> 标签：php, javascript, html

我正在使用某人的 PHP 文件。它的文字如下：

```
<html>
... regular HTML
{% if (some condition){       
    <another regular html tag>
    </another regular html tag>
}%}
</html> 
```

如果这些 {% tags %} 是 javascript 或 PHP，或者其他什么，我不明白吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T19:20:39.070

这是一些模板语言。很可能是服务器端的一种，即基于 PHP 的一种。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:21:26.310

对我来说看起来像一个模板。`{%`and`%}`是模板识别它必须在哪里工作的系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:22:24.687

它可以想到两个原因：

1.  用户可能已更改`"<?" to "<%"`

2.  它是一种模板语言

# events - bone.js 中的移动手势

> ID：10262201
> 
> 赞同：6
> 
> 时间：2012-04-21T19:20:37.183
> 
> 标签：events, jquery-mobile, backbone.js

我可以在 Backbone.js 视图事件中使用滑动、点击、捏合等移动手势吗？更具体地说，以下是我的代码。

```
Backbone.View.extend({
     initialize:function(){
        //initialization 
     },
     Events:{
          "swipe-left #homeBtn":"homeSwipe"
     },
     homeSwipe:function(){
        alert("Event Swipe left triggered!");
     }
}); 
```

我可以使用滑动、向左/向右滑动、捏合、点击等移动手势来使用backbone.js吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-17T21:20:05.547

下载并包含[Hammer.js](http://eightmedia.github.com/hammer.js/)，然后像往常一样使用 Backbone 视图事件！

```
events:{
    'swipe': 'onSwipe'
},

initialize: function(){
    // I think you can get away doing this here once, but I have not tested.
    // If not, just move it to the `render` method
    new Hammer(this.el);
},

onSwipe: function(e){
    console.log(e.direction); // left or right
} 
```

另外，你可以看看我的简单[Backbone view Gist](https://gist.github.com/4279025)

### 更新

根据反馈，看起来`new Hammer(this.el)`必须在主干视图上调用才能使其工作。我已经更新了示例以反映这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T09:26:34.060

Backbone[依赖 jQuery.bind](https://github.com/documentcloud/backbone/blob/master/backbone.js#L1236)来管理 DOM 事件。

所以问题是，如果 jQuery 支持这些事件并且看起来像[jQuery Mobile 那样](http://forum.jquery.com/topic/mobile-events-documentation)，现在您必须检查[如何集成 jQuery Mobile 和 Backbone](https://stackoverflow.com/questions/5537993/how-to-use-jquery-mobile-and-backbone-js-together-in-one-app)。

# sql - sql查询垂直显示结果

> ID：10262208
> 
> 赞同：2
> 
> 时间：2012-04-21T19:21:19.930
> 
> 标签：sql, sql-server-2008-r2, pivot, pivot-without-aggregate

如何转换这个：

```
ID   Name    Description
1    Test1a   TestDesc1a
1    Test1b   TestDesc1b
2    Test2a   TestDesc2a
2    Test2b   TestDesc2b 
```

进入这个：

```
ID   Column          1            2
1    Name          test1a       test1b
1    Description   testDesc1a   testDesc1b 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T19:53:56.717

You need to use a PIVOT query.

A basic discussion of PIVOT queries can be found at [MSDN][1].

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:39:13.870

您要求复杂的数据透视表。在这里阅读：http: [//msdn.microsoft.com/en-us/library/ms177410.aspx](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T21:09:41.797

这是一个很难解决的问题，但是指定的输出不正确/冲突。以下是您可以尝试的类似解决方案

**示例表创建：**

```
CREATE TABLE [dbo].[TestTable](
[Id] [int] NULL,
[Name] [nvarchar](50) NULL,
[Description] [nvarchar](50) NULL) 
```

**插入样本值：**

```
INSERT INTO TestTable VALUES (1,'Test1a','TestDesc1a')
INSERT INTO TestTable VALUES (2,'Test1b','TestDesc1b')
INSERT INTO TestTable VALUES (3,'Test2a','TestDesc2a')
INSERT INTO TestTable VALUES (4,'Test2b','TestDesc2b') 
```

**使用 Pivot 查询以获取所需的输出：**

```
SELECT  'Name' AS [Column], [1], [2],[3],[4]
FROM
(SELECT Name, id from TestTable) AS ST
PIVOT
(Max(Name) FOR ID IN ([1], [2],[3],[4])) AS PT

UNION

SELECT  'Description' AS [Column], [1], [2],[3],[4]
FROM
(SELECT  id,[Description] from TestTable) AS ST
PIVOT
(Max([Description]) FOR ID IN ([1], [2],[3],[4])) AS PT
ORDER BY [Column] DESC 
```

**输出：**

```
Column         1           2          3           4
Name           Test1a      Test1b     Test2a      Test2b
Description    TestDesc1a  TestDesc1b TestDesc2a  TestDesc2b 
```

希望这有助于解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T15:57:06.077

如果您只有几列，则可以使用静态`PIVOT`，但我猜您将拥有超过 2 个 ID，因此您可能希望`PIVOT`对此查询使用动态。使用动态数据透视表将允许您拥有超过您提供的两个 ID，它将从表中获取所有 ID，然后`PIVOT`：

```
create table temp
(
    id int,
    name varchar(10),
    description varchar(20)
)

insert into temp values (1, 'Test1a', 'TestDesc1a')
insert into temp values (1, 'Test1b', 'TestDesc1b')
insert into temp values (2, 'Test2a', 'TestDesc2a')
insert into temp values (2, 'Test2b', 'TestDesc2b')

DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

SET @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.id) 
            FROM temp c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT ''Name'' as [Column], ' + @cols + ' from 
            (
                select id
                    , name
                from temp
           ) x
            pivot 
            (
                 max(name)
                for id in (' + @cols + ')
            ) p 
            UNION 
            SELECT ''Description'' as [Column], ' + @cols + ' from 
            (
                select id
                    , description
                from temp
           ) x
            pivot 
            (
                 max(description)
                for id in (' + @cols + ')
            ) p '

execute(@query)

drop table temp 
```

结果：

```
Column          1             2
Description     TestDesc1b    TestDesc2b
Name            Test1b        Test2b 
```

# java - 如何在Java中的任意数字组上创建笛卡尔积？

> ID：10262215
> 
> 赞同：11
> 
> 时间：2012-04-21T19:21:40.430
> 
> 标签：java, algorithm, recursion, cartesian-product

假设我有两组数字：

```
{1, 2, 3},
{4, 5} 
```

我想创建一个输出以下 6 种组合的算法（在 Java 中）：

```
1,4
1,5
2,4
2,5
3,4
3,5 
```

每个组内可以有任意数量的组和任意数量的成员。所以在上面的例子中，有 2 个组，第一个组有 3 个成员，第二个组有 2 个成员。另一个示例如下（3 个组，第一组 3 个成员，第二组和第三组 2 个成员）：

```
{1, 2, 3},
{4, 5},
{6, 7} 
```

这将产生以下 12 种组合：

```
1,4,6
1,4,7
1,5,6
1,5,7

2,4,6
2,4,7
2,5,6
2,5,7

3,4,6
3,4,7
3,5,6
3,5,7 
```

我怎样才能在 Java 中做到这一点？我正在尝试使用递归，并且我已经看过一个[类似的问题](https://stackoverflow.com/questions/1313642/simulating-nested-loops)，但我仍然做不到。谢谢您的帮助！（PS这不是家庭作业）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-21T19:45:14.960

有点无聊，决定试一试。应该正是您需要的：

```
public static void main(String args[]) {
    ArrayList<int[]> input = new ArrayList<int[]>();
    input.add(new int[]{1, 2, 3});
    input.add(new int[]{4, 5});
    input.add(new int[]{6, 7});

    combine(input, new int[input.size()], 0);
}

private static void combine(ArrayList<int[]> input, int[] current, int k) {
    if (k == input.size()) {
        for (int i = 0; i < k; i++) {
            System.out.print(current[i] + " ");
        }
        System.out.println();
    } else {
        for (int j = 0; j < input.get(k).length; j++) {
            current[k] = input.get(k)[j];
            combine(input, current, k + 1);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-21T19:49:55.000

如果您可以使用库，那么[Guava 的](http://google.github.io/guava/) [`Sets.cartesianProduct(List<Set<E>>)`](http://google.github.io/guava/releases/snapshot-jre/api/docs/com/google/common/collect/Sets.html#cartesianProduct-java.util.List-)功能*正是*您想要的。（披露：我为 Guava 做出了贡献。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-21T19:32:08.053

一种可能的方法（不一定是最有效的）可能是采取分而治之的方法。查找两个组的所有排列相对简单（最愚蠢的方法就是嵌套 for 循环）。假设您编写了一个名为的函数`permute`，它`permute(A,B)`在 A（例如 {(1), (2), (3)}）和 B（例如 {(4), (5)} 是一组数字，它返回所有A & B 作为单个组的排列（例如 {(1,4), (1,5), (2,4), (2,5), (3,4), (3,5)}） .

因此，当您有 N 个组而不是 2 个时，最简单的做法就是挑出问题的一小部分。假设您有 A、B 和 C 组。与其单独担心它们，不如将其视为：

`permute(permute(A,B),C)`

首先找到 A 和 B 的所有排列。一旦你有了这个结果，用 C 找到这个结果的所有排列。四个组 A、B、C、D 可能看起来像：

`permute(permute(permute(A,B),C),D)`

等等。在此过程中的每一步，您都会获取当前的排列结果，并将其与作为输入的组列表中的下一个组进行排列。您一次只能组合两个组，因此算法不必根据您作为输入获得的组数而改变。

当您进行递归时，您需要回答几个主要问题：

1.  你能递归地将问题分解成更小、更容易解决的问题吗？我认为上面的例子证明你可以。

2.  基本情况是什么？导致递归停止和展开的解决方案是什么？它通常应该是一些非常简单的东西，你的递归可以朝着这个方向努力。在这种情况下，它可能归结为`permute(A,{})`{} 是空集。

3.  什么是递归案例？你将如何分解问题的一部分并递归到问题的较小子集上？我认为最初的解释为您提供了一种可能这样做的方法。只需一次拆分一组，然后根据您不断增长的结果对其进行排列。

这个问题当然还有其他解决方案，这只是我脑海中浮现的第一个。随着 N 越来越大，这个算法会变得非常慢，因为它不是很有效。

所以即使你不使用这个解决方案，我希望它能让你走上正轨！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-21T19:38:26.007

下面的伪代码怎么样（没有递归）

```
// Create the initial result filled with the first set of numbers
List result = new List()
For each number in the first set
   result.add(new List(number))

// Iterate over the following sets to permutate over
For each remaining set S
   List newResult = new List()
   For each list L in result
     For each number N in S
       newResult.add(copy of L with N added)
   result = newResult 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-24T00:52:26.317

*您可以使用map 和 reduce*方法获得任意数量列表的笛卡尔积。

[在线尝试！](https://tio.run/##rVRNj9MwEL3nV8wxQdmsGj4O3SUSQhyQ4LTcEAfXnXZdHNuyJ4sqtL@9jJ2mH8qmBQkf6tp@4zdv3jgb8SRurEOzWf7c7VTrrCfY8GbVkdLVq7tstBfIo2irj1ZrlGR9mMY8pOkuy6QWIcA3DAS/M@DhuoVWEgIJ4unJqiW0QpmcI5RZf/8Bwq9DsQfH8UUFuk8/nw3hGn3TgOZlgPfwwXuxDZUI8Tw/hAzj/HhWQl3C66K8gntTwturoHdFweqGs9tbkMITBiUMOG@XnSSwK@CV8AtFXvgtmK5doI/bKf2LAqVjdQm2r2hejBJiUo/OY0BDgEI@Amps4yIyp2gQgf8FLqxGsibtje6pWuHyhL7pK3ugTCe97vm8Fz5O4ySd3vX7o6De1KZpJqMq2XdTfuyqimwqcVG8qDl0bcu9w2pYphPKh6GkoAzZg94JsR7ZHMyTYO6IONXFoHw2Xe1Tq227UCblkLiVMezruakj3pUW9JXLmcCzgbC@TnhGbKQgZGr8G60vGp3468jfu1XZ1T6nshdSX09lJCr6NZ/3Uv4h/KL3Fy1IdnPpT634jz1m6RH9LxUwvmBsHW0nusn6TzrgcHHMokrw/eXnnwjbkeuOl0hXrTieH27@sA2EbEXHVXT8ZEgbjo2g5@x5t/sD "Java (OpenJDK 8) – 在线试用")

```
List<List<Integer>> lists = Arrays.asList(
        Arrays.asList(1, 2, 3),
        Arrays.asList(4, 5),
        Arrays.asList(6));

// cartesian product of an arbitrary number of lists
List<List<Integer>> cp = lists.stream()
        // represent each element of a list as a singleton list
        .map(list -> list.stream().map(Arrays::asList)
                // Stream<List<List<String>>>
                .collect(Collectors.toList()))
        // summation of pairs of list into a single list
        .reduce((list1, list2) -> list1.stream()
                // combinations of inner lists
                .flatMap(inner1 -> list2.stream()
                        // concatenate into a single list
                        .map(inner2 -> Stream.of(inner1, inner2)
                                .flatMap(List::stream)
                                .collect(Collectors.toList())))
                // list of combinations
                .collect(Collectors.toList()))
        // otherwise an empty list
        .orElse(Collections.emptyList());

// output
cp.forEach(System.out::println); 
```

输出：

```
[1, 4, 6]
[1, 5, 6]
[2, 4, 6]
[2, 5, 6]
[3, 4, 6]
[3, 5, 6] 
```

* * *

^(另请参阅：[地图值的笛卡尔积](https://stackoverflow.com/a/68506104/16497917))

# c - “c”问题中的动态内存分配

> ID：10262217
> 
> 赞同：5
> 
> 时间：2012-04-21T19:21:48.700
> 
> 标签：c, malloc, dynamic-memory-allocation

我正在使用 malloc 编写代码，然后遇到了一个问题，所以我编写了一个测试代码，它实际上总结了整个混乱，如下所示：

```
# include <stdio.h>
# include <stdlib.h>
# include <error.h>

int main()     
{
     int *p = NULL;
     void *t = NULL;
     unsigned short *d = NULL;

     t = malloc(2);
     if(t == NULL) perror("\n ERROR:");
     printf("\nSHORT:%d\n",sizeof(short));
     d =t;
     (*d) = 65536;
     p = t; 
     *p = 65536;
     printf("\nP:%p: D:%p:\n",p,d);
     printf("\nVAL_P:%d ## VAL_D:%d\n",(*p),(*d));
     return 0;
  }
   Output:: abhi@ubuntu:~/Desktop/ad/A1/CC$ ./test

            SHORT:2
            P:0x9512008: D:0x9512008:
            VAL_P:65536 ## VAL_D:0 
```

我正在使用 malloc 分配**2 个字节**的内存。返回 void * 指针的 Malloc**存储在 void* 指针 't'**中。

然后在这 2 个指针被声明为**p-整数类型和 d-短类型**。然后我将 t 分配给它们* *（p = t 和 d = t）* * *，这意味着 d 和 p 都指向堆上的相同内存位置。*

在尝试将 65536(2^16) 保存到 (*d) 时，我收到警告说大 int 值被截断，这是预期的。现在我再次将 65536(2^16) 保存到 (*p) 没有引起任何警告。

*在打印 (*p) 和 ( *d) 时，我得到了不同的值（尽管每个值都对自己定义的指针类型正确）。*

我的问题是：

1.  虽然我已经使用 malloc 分配了 2 个字节（即 16 位）的堆内存，但我如何能够在这两个字节中保存 65536（通过使用（*p），它是一个整数类型的指针）。？？我有一种感觉，这是因为将 void 自动类型转换*为 int* 指针（在 p = t 中），因此将 t 分配给 p 会导致访问通过 malloc 分配的内存区域之外的内存区域。？？？。

2.  即使所有这一切都在发生，地狱如何通过 (*p) 和 (*d) 取消引用同一内存区域会打印两个不同的答案（尽管如果我在想问题 1 中的原因，这也可以解释）。

**有人可以对此有所了解，这将非常感激..如果有人可以解释这背后的原因..**

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:34:47.513

先回答你的第二个问题：

解释是an`int`一般是4个字节，最重要的字节可能存放在前两个位置。A`short`只有 2 个字节，它的数据也存储在前两个位置。显然，存储`65536`在 an`int`和 a`short`中，但指向相同的内存位置，将导致存储的数据相对于 偏移两个字节`int`，`short`其中两个最低有效字节`int`对应于存储的`short`.

因此，当编译器打印 时`*d`，它会将其解释为 a`short`并查看与存储对应的区域 a `short`，这不是编译器先前存储写入`65536`时间的位置。`*p`请注意，写入会`*p = 65536;`覆盖前一个`*d = 65536;`，用 . 填充两个最低有效字节`0`。

关于第一个问题：编译器*不会*将`65536`for存储`*p`在 2 个字节内。它只是超出了您分配的内存范围 - 这可能会在某些时候导致错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:27:13.683

在 C 语言中，对于超出分配范围的写入根本没有保护。只是不要这样做，任何事情都可能发生。在这里它似乎对您有用，因为巧合的是，您分配的两个字节后面的空间没有用于其他用途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T19:33:54.090

1）OS内存管理器的粒度为4K。一位的覆盖不太可能触发 AV/segfault，但它会破坏相邻位置的任何数据，导致：

2) 未定义的行为。这组行为包括“明显正确的操作”，（现在！）。

# java - 短信气球/长聊天框

> ID：10262220
> 
> 赞同：0
> 
> 时间：2012-04-21T19:21:56.170
> 
> 标签：java, android

我希望能够在每次用户从 HttpGet 恢复数据时添加一个文本消息气球，我希望它看起来与默认的 Android 文本消息 UI 几乎相同。我对所有代码都很好，我只需要一种方法来创建 UI 并在每次从 HttpGet 请求返回数据时创建另一个文本气球。

非常感谢您回答这个问题，我确信有一种简单的方法可以做到这一点，但我没有找到使用“ole Google”的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:28:57.140

我正在为我的应用程序做类似的事情正在执行以下操作来实现它：

1.  您将需要一个代表气泡的 9-Patch-Image（可拉伸的 PNG，请参见[此处](http://developer.android.com/guide/developing/tools/draw9patch.html)）。您想要使不包括气泡角的部分可拉伸。您可以使用您选择的图像编辑器创建气泡（我推荐像 Inkscape 这样的矢量图形编辑器）。然后使用 Android 开发者工具中包含的 9-Patch 编辑器将 PNG 图像转换为 9-Patch PNG。
2.  为一个气泡创建自定义布局文件。在其中创建一个 textview，并将您的气泡添加为背景资源。( `android:background`)
3.  使用带有自定义适配器的数组列表来膨胀和填充您的项目。

到目前为止，这将为您提供相同的气泡作为所有消息的背景。如果你想变得花哨，你可以为参与者创建不同的气泡，并使用`setBackgroundResource`你的适配器中的方法来设置正确的背景。

此外，如果您希望将它们左对齐或右对齐，例如在消息应用程序中，您需要在布局文件中的 TextView 的左侧和右侧添加分隔符。我使用了固定宽度的 FrameLayouts。确保将其可见性设置为`GONE`。与交换不同的气泡颜色一样，只需设置左/右垫片的可见性。

# entity-framework-4 - 实体框架以及普通的旧 ADO.Net

> ID：10262222
> 
> 赞同：0
> 
> 时间：2012-04-21T19:22:20.873
> 
> 标签：entity-framework-4

我正在构建一个新的应用程序架构，我需要您的建议。我们有一个作为 SQL Azure 托管的中央 MSSQL 服务器数据库。该数据库需要从许多不同的应用程序中访问，其中大多数是托管在 Windows azure 中的 Web 应用程序，其中一些是 winforms 应用程序。

使用 ADO.Net 可以直接访问 Web 应用程序的数据库。对于 winforms 应用程序，wcf 数据服务技术与客户端身份验证服务一起用于安全性似乎令人印象深刻。

我需要知道这种混合的数据库访问模式是否可行？换句话说，如果使用 ADO.Net 和 Entity 框架的混合应用程序攻击数据库完整性，它将保持数据库完整性。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:38:56.323

如果您使用 EntityFramework 查询数据库，它将缓存数据，直到您调用 SaveChanges()。如果同时修改数据库（例如使用普通的旧 ADO.NET），则存在来自数据库的数据被使用实体框架的应用程序覆盖的风险。为了防止这种情况，您需要使用并发令牌。您可以在此处找到一些详细信息：[http](http://social.technet.microsoft.com/wiki/contents/articles/3866.aspx) ://social.technet.microsoft.com/wiki/contents/articles/3866.aspx 请注意，当您开始使用并发令牌时，您需要了解可能需要处理的并发异常. 你可以看看这篇博[文 http://blogs.msdn.com/b/rickandy/archive/2011/02/17/handling-optimistic-concurrency-exception-with-ef-and-mvc-3.aspx](http://blogs.msdn.com/b/rickandy/archive/2011/02/17/handling-optimistic-concurrency-exception-with-ef-and-mvc-3.aspx)一些想法。WCF 数据服务使用 ETags 进行并发 (http://blogs.msdn.com/b/astoriateam/archive/2008/04/22/optimistic-concurrency-data-services.aspx) 但您可能不需要在此处执行任何操作，如果您在 EF 模型中为通过 WCF 数据服务公开的数据库设置并发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T21:52:30.133

我们将使用 WCF RIA 服务。它们似乎适用于提供开箱即用数据访问层的多种客户端类型。

# android - 在 2 个布局之间来回切换

> ID：10262223
> 
> 赞同：0
> 
> 时间：2012-04-21T19:22:24.173
> 
> 标签：android, android-activity, android-fragments, fragment

我正在尝试制作一个具有闪烁效果的应用程序，

例如，在两种布局之间来回切换，例如一种是红色的，另一种是蓝色的。

（任何布局都有不同的图像）

当尝试在 2 个活动或 2 个片段之间快速切换时，应用程序崩溃了。

如何以更好的方式以编程方式更改活动布局？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:26:09.740

我个人对闪烁的保留意见放在一边，您可以使用计时器仅更改根布局的背景颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:17:56.283

您应该只更改 Activity 显示的背景颜色或布局。

考虑效率：

*   如果您更改布局，android 将不得不膨胀 XML 及其小部件，并且您必须通过查询和布局（即 findViewById）来获取所有这些的句柄。您可以将第一个问题视为刷新网页以更改元素的颜色，而不仅仅是动态呈现。您可以将第二部分视为不缓存 DOM 句柄，并且每次您想在 JavaScript 中提供和操作时都必须重新查询 DOM。两者都是不好的做法。

*   或者，您可以每隔 X 秒、分钟或任何您想要做的事情更改当前布局的背景。有很多方法可以做到这一点——AlarmManager，或者启动一个超时的线程——或者更好的是，启动一个新的线程，它将一个可运行的线程发布回主线程以更改背景颜色——然后休眠 X 的辅助线程秒并重复循环。

第二个想法不仅是好的做法——而且您正确地使用了 SDK 框架。

祝你好运！

# iphone - ModalViewController 保留值

> ID：10262227
> 
> 赞同：1
> 
> 时间：2012-04-21T19:23:20.550
> 
> 标签：iphone, ios5

从 modalViewController (UniversitiesViewController *)，我尝试在 rootViewController 中设置一个变量，但没有成功。在我的 tableview:didSelectRowAtIndexPath: 方法中，我使用以下代码设置 rootViewController (MapsViewController *) selectedIndex 属性：

```
MapsViewController *mapsView = (MapsViewController *)[self.storyboard instantiateViewControllerWithIdentifier:@"MapsView"];
mapsView.selectedIndex = [NSNumber numberWithInt:indexPath.row];

[self dismissModalViewControllerAnimated:YES]; 
```

当我在 MapViewController 中打印 self.selectedIndex 的值时，它始终为 0，这不是选择的值。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:40:56.053

正确的做法是为 UniversitiesViewController 创建一个委托协议。

```
@protocol UniversitiesViewControllerDelegate <NSObject>
- (void)universitiesViewController:(UniversitiesViewController *)uvc selectedIndex:(NSInteger)index;
@end 
```

并添加

```
@property (weak, nonatomic) id <UniversitiesViewControllerDelegate> delegate; 
```

到 UniversitiesViewController 类。

在 UniversitiesViewController 的 didSelectRow 中，调用

```
[self.delegate universitiesViewController:self selectedIndex:indexPath.row] 
```

然后从 MapsViewController，在实例化 UniversitiesViewController 时（或者如果使用 segue，在 prepareForSegue 中）将委托设置为“self”。并让 MapsViewController 处理委托方法。

```
- (void)universitiesViewController:(UniversitiesViewController *)uvc selectedIndex:(NSInteger)index
{
     // do stuff
} 
```

# asp.net-mvc - 动态生成sitemap.xml

> ID：10262228
> 
> 赞同：4
> 
> 时间：2012-04-21T19:23:23.563
> 
> 标签：asp.net-mvc, webforms, sitemap

[我已经使用此处](http://www.blackbeltcoder.com/Articles/asp/dynamic-sitemaps-in-asp-net)描述的技术实现了动态生成的站点地图。

由于我的站点是一个 WebForms 应用程序，因此我的站点地图 URL 最终为 www.mydomain.com/Sitemap.aspx。

这很好用，我可以使用搜索引擎网站管理员工具告诉他们我的站点地图的 URL。但是，较小的搜索引擎可能不知道在哪里可以找到此文件。如果我的动态生成的站点地图可以位于 www.mydomain.com/sitemap.xml 会更好。这是站点地图的标准 URL。

生成我现在所做的相同站点地图数据但让它显示为文件 sitemap.xml 的最简单方法是什么。我可以使用路由来完成，还是需要自定义 HTTP 处理程序？

我正在使用网络表单，但也有使用 ASP.NET MVC 的网站，所以我非常有兴趣找到在这两个平台上执行此操作的最佳技术。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-21T19:37:36.177

对于 Webforms，您可以使用 HttpModule，查看[UrlRewriting.NET](http://urlrewriting.net/149/en/home.html)

对于 MVC，使用路由：

```
routes.MapRoute("Sitemap", 
                "sitemap.xml",
                new { controller = "Home", action = "Sitemap" }) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T12:36:59.343

对于 Webforms，您还可以如上所述更新您的 web.config，您只需使用纯 aspx 或 ascx 页面，然后使用 rewrite 进行魔术:-)（我使用 .net 4.0）

例如

```
<system.webServer>
<rewrite>
  <rules>
    <rule name="Main Sitemap" stopProcessing="true">
      <match url="^sitemap.xml"/>
      <action type="Rewrite" url="sitemap/sitemap.aspx" appendQueryString="false"/>
    </rule>
  </rules>
</rewrite>
</system.webServer> 
```

# powershell - 使用 Start-Process 和 WaitForExit 而不是 -Wait 获取 ExitCode

> ID：10262231
> 
> 赞同：87
> 
> 时间：2012-04-21T19:23:46.903
> 
> 标签：powershell, powershell-2.0

我正在尝试从 PowerShell 运行程序，等待退出，然后访问 ExitCode，但我运气不佳。我不想使用`-Wait`with [`Start-Process`](https://technet.microsoft.com/en-us/library/hh849848.aspx)，因为我需要在后台进行一些处理。

这是一个简化的测试脚本：

```
cd "C:\Windows"

# ExitCode is available when using -Wait...
Write-Host "Starting Notepad with -Wait - return code will be available"
$process = (Start-Process -FilePath "notepad.exe" -PassThru -Wait)
Write-Host "Process finished with return code: " $process.ExitCode

# ExitCode is not available when waiting separately
Write-Host "Starting Notepad without -Wait - return code will NOT be available"
$process = (Start-Process -FilePath "notepad.exe" -PassThru)
$process.WaitForExit()
Write-Host "Process exit code should be here: " $process.ExitCode 
```

运行此脚本将导致[记事本](http://en.wikipedia.org/wiki/Notepad_%28software%29)启动。手动关闭后，会打印退出码，重新启动，不使用`-wait`. 退出时不提供 ExitCode：

```
Starting Notepad with -Wait - return code will be available
Process finished with return code:  0
Starting Notepad without -Wait - return code will NOT be available
Process exit code should be here: 
```

我需要能够在启动程序和等待它退出之间执行额外的处理，所以我不能使用`-Wait`. 我怎样才能做到这一点，并且仍然可以从此过程中访问 .ExitCode 属性？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2013-04-15T14:51:05.090

这里有两件事要记住。一是添加`-PassThru`论据，二是添加`-Wait`论据。[由于这个缺陷](http://web.archive.org/web/20120315185607/http://connect.microsoft.com:80/PowerShell/feedback/details/520554/start-process-does-not-return-exitcode-property)，您需要添加等待参数。

```
-PassThru [<SwitchParameter>]
    Returns a process object for each process that the cmdlet started. By default,
    this cmdlet does not generate any output. 
```

完成此操作后，将返回一个流程对象，您可以查看该对象的 ExitCode 属性。这是一个例子：

```
$process = start-process ping.exe -windowstyle Hidden -ArgumentList "-n 1 -w 127.0.0.1" -PassThru -Wait
$process.ExitCode

# This will print 1 
```

如果你在没有`-PassThru`or的情况下运行它`-Wait`，它不会打印任何内容。

相同的答案在这里：*[如何运行 Windows 安装程序并在 PowerShell 中获得成功/失败值？](https://stackoverflow.com/questions/4749186/how-do-i-run-a-windows-installer-and-get-a-succeed-fail-value-in-powershell/7109778#7109778)*

还值得注意的是，上面的“缺陷报告”链接中提到了一种解决方法，如下所示：

```
# Start the process with the -PassThru command to be able to access it later
$process = Start-Process 'ping.exe' -WindowStyle Hidden -ArgumentList '-n 1 -w 127.0.0.1' -PassThru

# This will print out False/True depending on if the process has ended yet or not
# Needs to be called for the command below to work correctly
$process.HasExited

# This will print out the actual exit code of the process
$process.GetType().GetField('exitCode', 'NonPublic, Instance').GetValue($process) 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2014-05-22T04:20:34.500

在尝试上面的最终建议时，我发现了一个更简单的解决方案。我所要做的就是缓存进程句柄。一旦我这样做了， $process.ExitCode 就可以正常工作。如果我没有缓存进程句柄，则 $process.ExitCode 为空。

例子：

```
$proc = Start-Process $msbuild -PassThru
$handle = $proc.Handle # cache proc.Handle
$proc.WaitForExit();

if ($proc.ExitCode -ne 0) {
    Write-Warning "$_ exited with status code $($proc.ExitCode)"
} 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-04-21T19:32:19.613

我认为你可以做两件事...

1.  手动创建 System.Diagnostics.Process 对象并绕过 Start-Process
2.  在后台作业中运行可执行文件（仅适用于非交互式进程！）

您可以这样做：

```
$pinfo = New-Object System.Diagnostics.ProcessStartInfo
$pinfo.FileName = "notepad.exe"
$pinfo.RedirectStandardError = $true
$pinfo.RedirectStandardOutput = $true
$pinfo.UseShellExecute = $false
$pinfo.Arguments = ""
$p = New-Object System.Diagnostics.Process
$p.StartInfo = $pinfo
$p.Start() | Out-Null
#Do Other Stuff Here....
$p.WaitForExit()
$p.ExitCode 
```

**或者**

```
Start-Job -Name DoSomething -ScriptBlock {
    & ping.exe somehost
    Write-Output $LASTEXITCODE
}
#Do other stuff here
Get-Job -Name DoSomething | Wait-Job | Receive-Job 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-05-02T01:56:30.910

即使我的过程已经完成，“-Wait”选项似乎也阻止了我。

我尝试了 Adrian 的解决方案并且它有效。但是我使用了[Wait-Process](https://msdn.microsoft.com/en-us/powershell/reference/3.0/microsoft.powershell.management/wait-process)而不是依赖于检索进程句柄的副作用。

所以：

```
$proc = Start-Process $msbuild -PassThru
Wait-Process -InputObject $proc

if ($proc.ExitCode -ne 0) {
    Write-Warning "$_ exited with status code $($proc.ExitCode)"
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-14T01:12:49.893

Or try adding this...

```
$code = @"
[DllImport("kernel32.dll")]
public static extern int GetExitCodeProcess(IntPtr hProcess, out Int32 exitcode);
"@
$type = Add-Type -MemberDefinition $code -Name "Win32" -Namespace Win32 -PassThru
[Int32]$exitCode = 0
$type::GetExitCodeProcess($process.Handle, [ref]$exitCode) 
```

By using this code, you can still let PowerShell take care of managing redirected output/error streams, which you cannot do using System.Diagnostics.Process.Start() directly.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-21T21:38:29.257

这是这个主题的一个变体。我想卸载 Cisco Amp，等待，然后获取退出代码。但是卸载程序会启动另一个名为“un_a”的程序并退出。使用此代码，我可以等待 un_a 完成并获取它的退出代码，即“需要重新启动”的 3010。这实际上是在一个 .bat 文件中。

如果您曾经想卸载 fold@home，它的工作方式类似。

```
rem uninstall cisco amp, probably needs a reboot after

rem runs Un_A.exe and exits

rem start /wait isn't useful
"c:\program files\Cisco\AMP\6.2.19\uninstall.exe" /S

powershell while (! ($proc = get-process Un_A -ea 0)) { sleep 1 }; $handle = $proc.handle; 'waiting'; wait-process Un_A; exit $proc.exitcode 
```

# ruby - 在控制台中打印一个 ASCII 旋转“光标”

> ID：10262235
> 
> 赞同：14
> 
> 时间：2012-04-21T19:25:08.180
> 
> 标签：ruby, command-line, progress

我有一个 Ruby 脚本，它做了一些耗时的工作。它只是命令行，我想表明脚本仍在运行并且没有停止。在过去，我曾经喜欢所谓的“旋转光标”，我设法在 Windows 下的 Ruby 中重现了它。

问题：这在其他操作系统中是否有效？如果没有，是否有独立于操作系统的方法来实现这一点？

请不要 IRB 解决方案。

```
10.times {
  print "/"
  sleep(0.1)
  print "\b"
  print "-"
  sleep(0.1)
  print "\b"
  print "\\"
  sleep(0.1)
  print "\b"
  print "|"
  sleep(0.1)
  print "\b"
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-21T21:52:57.503

是的，这适用于 Windows、OS X 和 Linux。改进 Niklas 的建议，您可以使这个更通用，如下所示：

```
def show_wait_cursor(seconds,fps=10)
  chars = %w[| / - \\]
  delay = 1.0/fps
  (seconds*fps).round.times{ |i|
    print chars[i % chars.length]
    sleep delay
    print "\b"
  }
end

show_wait_cursor(3) 
```

如果您不知道该过程需要多长时间，您可以在另一个线程中执行此操作：

```
def show_wait_spinner(fps=10)
  chars = %w[| / - \\]
  delay = 1.0/fps
  iter = 0
  spinner = Thread.new do
    while iter do  # Keep spinning until told otherwise
      print chars[(iter+=1) % chars.length]
      sleep delay
      print "\b"
    end
  end
  yield.tap{       # After yielding to the block, save the return value
    iter = false   # Tell the thread to exit, cleaning up after itself…
    spinner.join   # …and wait for it to do so.
  }                # Use the block's return value as the method's
end

print "Doing something tricky..."
show_wait_spinner{
  sleep rand(4)+2 # Simulate a task taking an unknown amount of time
}
puts "Done!" 
```

这个输出：

```
Doing something tricky...|
Doing something tricky.../
Doing something tricky...-
Doing something tricky...\ 
(et cetera)
Doing something tricky...done! 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-01T15:24:49.460

```
# First define your chars
pinwheel = %w{| / - \\}

# Rotate and print as often as needed to "spin"
def spin_it
  print "\b" + pinwheel.rotate!.first
end 
```

彼得编辑：这里是一个工作版本

```
def spin_it(times)
  pinwheel = %w{| / - \\}
  times.times do
    print "\b" + pinwheel.rotate!.first
    sleep(0.1)
  end
end

spin_it 10 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-06T04:01:18.017

我写了一个 gem [spin_to_win](https://github.com/mguymon/spin_to_win)，它在产生一个块的同时显示一个微调器。例如：

```
SpinToWin.with_spinner('Zzzz') do |spinner| 
  spinner.banner('sleepy')
  sleep 1 
end 
```

```
Zzzz \ [sleepy] 
```

它还可以跟踪待处理的工作与已完成的工作：

```
SpinToWin.with_spinner('Zzzz') do |spinner|
    spinner.increment_todo!(3)

    spinner.banner('snore')
    sleep 1
    spinner.increment_done!

    spinner.banner('dream')
    sleep 1
    spinner.increment_done!

    spinner.banner('wake up!')
    sleep 1
    spinner.increment_done!
end 
```

```
Zzzz \ 3 of 3 [wake up!] 
```

# linux - 分组文件和管道到 awk 命令

> ID：10262237
> 
> 赞同：1
> 
> 时间：2012-04-21T19:25:34.483
> 
> 标签：linux, bash, awk, xargs

我在目录中有文件；它们使用 YYYY_MM_DD 命名：

```
-rw-r--r-- 1 root root 497186 Apr 21 13:17 2012_03_25
-rw-r--r-- 1 root root 490558 Apr 21 13:17 2012_03_26
-rw-r--r-- 1 root root 488797 Apr 21 13:17 2012_03_27
-rw-r--r-- 1 root root 316290 Apr 21 13:17 2012_03_28
-rw-r--r-- 1 root root 490081 Apr 21 13:17 2012_03_29
-rw-r--r-- 1 root root 486621 Apr 21 13:17 2012_03_30
-rw-r--r-- 1 root root 490904 Apr 21 13:17 2012_03_31
-rw-r--r-- 1 root root 491788 Apr 21 13:17 2012_04_01
-rw-r--r-- 1 root root 488630 Apr 21 13:17 2012_04_02 
```

文件中的第一列是一个数字，我使用以下`awk`命令取第一列的平均值。

```
awk -F, '{ x += $1 } END { print x/NR }' MyFile 
```

使用相同的命令，我可以将两个文件传递给 awk 以获得两个文件作为一个整体的总平均值。

```
awk -F, '{ x += $1 } END { print x/NR }' File1 File2 
```

我想做的是这个...

我想获取我目录中的所有文件，并每月对它们进行分组，然后将当月的所有文件传递给 awk 命令。

因此，根据相同的数据，3 月份有 7 个文件，我希望将所有 7 个文件都传递给我的`awk`命令，如下所示：

```
awk -F, '{ x += $1 } END { print x/NR }' File1 File2 File3 File4 File5 File6 File7 
```

然后同样适用于四月的设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:36:23.217

您是想以某种方式仅使用 awk 来完成此任务，还是可以使用文件通配符？例如：

```
awk -F, '{ #Do stuff }' 2012_03_[0-3][0-9] 
```

将获得所有 March 文件。

您也可以使用`2012_03*`，但它的 globbing 模式不如上述具体。

***编辑***

您可以使用这样的 shell 脚本：

```
DIR="/tmp/tmp"
for month in $(find "$DIR" -maxdepth 1 -type f | sed 's/.*\/\([0-9]\{4\}_[0-9]\{2\}\).*/\1/' | sort -u); do
  awk -F, '#dostuff' "$DIR/${month}"_[0-3][0-9] > output/dir/SUM_"${month}"
done 
```

与往常一样，有一些警告。带有空格的文件会破坏它。如果目录中存在不符合 YYYY_MM_DD 格式的文件，您会收到错误消息，但不会影响性能。让我知道这些限制是否不可接受，我会再考虑一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:47:40.963

在 Perl 中，你可以这样做：

```
#!/usr/bin/env perl
$dir = shift || ".";
opendir(DIR, $dir);
@files=grep (/\d{4}_\d{2}_\d{2}/, readdir(DIR));

foreach $file (@files)
{
    ($year_month) = $file =~ /(\d{4}_\d{2})/;
    open(FILE, "<$dir/$file");
    while($col = <FILE>)
    {
        $col =~ s/^(\d*)/\1/;
        if($col)
        {
            $hash{"$year_month"}{"count"}++;
            $hash{"$year_month"}{"sum"} += $col;
        }
    }
}

foreach $year_month (keys %hash)
{
    $avg = $hash{"$year_month"}{"sum"} / $hash{"$year_month"}{"count"};
    print "$year_month : $avg\n";
} 
```

可能可以做得更短，但是这样你就有一个很好的哈希数据结构，以防你以后想以不同的方式计算它。像这样调用：

```
script.pl /path/to/dir 
```

编辑：错误：忘记将目录添加到路径

# c# - 如何创建和设置多态属性？

> ID：10262245
> 
> 赞同：7
> 
> 时间：2012-04-21T19:27:08.960
> 
> 标签：c#, design-patterns, polymorphism

我想创建一个可以在属性中采用不同类型值的类。我正在尝试使用多态性来做到这一点，但我还没有学习如何正确地做到这一点，因此我请求建议。

我有一个基类和两个继承自它的类：

```
public abstract class BaseClass
{
    public string Name { get; set; }
    public Unit Unit { get; set; }
}

public class DerivedClassFloat : BaseClass
{
    public float Value { get; set; }

    public override string ToString()
    {
        return Value.ToString();
    }
}

public class DerivedClassString : BaseClass
{
    public string Value { get; set; }

    public override string ToString()
    {
        return Value;
    }
} 
```

一切都很好，我可以创建一个列表并添加不同的专业子类。当我需要更改列表中项目的值时，我的问题就出现了：

```
foreach (var item in ListOfBaseClasses)
{
   if(item is DerivedClassFloat)
     ((DerivedClassFloat) item).Value = float.NaN;
   if (item is DerivedClassString)
      ((DerivedClassString) item).Value = string.Empty;
} 
```

根据我所读到的，这看起来像是一种代码味道。有没有更好的方法可以根据我要分配的类型访问派生类的 value 属性？

当您想根据值创建正确的子类时怎么办？

```
BaseClass newClass = null;
if (phenotype is DerivedClassFloat)
    newClass = new DerivedClassFloat(){Value = 12.2};
if (phenotype is DerivedClassString)
    newClass = new DerivedClassString(){Value = "Hello"}; 
```

我读过关于覆盖虚拟方法的文章，但是如果我想处理该值，而不是添加或更改它……也许我遗漏了什么？

* * *

我应该让这个更具体，我很抱歉，我不习惯在这个伟大的网站上发布问题。

我需要一个由属性列表组成的属性。每个属性都有一个名称和一个值，但该值可以是不同的类型。例如：

```
public class Organism
{
    public string Name { get; set; }
    public List<Attribute> Attributes { get; set; }
}

public class Attribute
{
    public string AttributeName { get; set; }
    public object AttributeValue { get; set; }
} 
```

对于给定的有机体，我可以有几个属性持有不同的值类型。我想避免使用对象类型，这样我就不必转换为正确的类型。我虽然属性多态是优雅地处理这种情况的解决方案，但后来我发现自己使用 If ..Then 这似乎与一开始的强制转换并没有太大区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:37:04.150

如果在您的特定情况下要重置`Value`，您可以在基类中定义一个抽象`ResetValue`方法，该方法将由派生类实现。

至于您的第二种情况，您应该查看[Creational Design Patterns](http://www.oodesign.com/creational-patterns/)，特别是 Factory 和 Prototype 设计模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T19:41:32.290

对于这种特殊情况，您可以使用泛型：

```
public abstract class BaseClass<T>
{
    public string Name { get; set; }
    public Unit Unit { get; set; }
    public T Value { get; set; }
}

public class DerivedClassFloat : BaseClass<float>
{
    public override string ToString()
    {
        return Value.ToString();
    }
}

public class DerivedClassString : BaseClass<string>
{
    public override string ToString()
    {
        return Value;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:41:18.320

您可以使用泛型来定义类型，实现子类会将类型设置`Value`为类型约束：

```
public abstract class BaseClass<T>
{
    public string Name { get; set; }
    public Unit Unit { get; set; }
    public T Value { get; set; }

    public override string ToString()
    {
        return Value.ToString();
    }
}

public class DerivedFloat : BaseClass<float> {}

public class DerivedString : BaseClass<string> {} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-21T19:48:03.907

多态行为适用于抽象。根据您的尝试，您可以减少代码异味，以将代码中的尽可能多的可变性转移到基类中。

我建议不要使用如下的属性写入方法。你可以像下面这样。

```
public void setValue(string val, Type type);//move this to your base class

    Class MyValue{
private string strVal;
private int intVal;

//constructor
MyValue(string val, Type type){
     //check the type enum here and set the values accordingly
}
}

then when set values
foreach (var item in ListOfBaseClasses)
{
     item.setValue = MyValue("",Type.INT);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-21T19:38:38.173

我不太确定你想用这种方法实现什么 - Value 属性不是同一类型，基类上也没有 Value 属性，这表明从基类派生的其他类型可能没有它一点也不。

如果您的所有类都需要 Value 属性，那么它可能应该是最通用的类​​型`object`- 您可以将它放在基类中，但这需要在派生类中转换值。但是你可以有一个`NullObject`表示没有值的值，你可以为每个派生类分配给 Value 属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-21T19:58:45.547

您可以使用[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。考虑这个例子：

```
// Base class

class Button
{
    protected Button()
    {
    }

    public string Name { get; set; }
}

// Factory interface

public interface ButtonFactory
{
    Button CreateButton();
}

// And the concrete classes

class WindowsButton : Button
{
    // ...
}

class WindowsButtonFactory : ButtonFactory
{
    public Button CreateButton()
    {
        return new WindowsButton();
    }
}

class MacButton : Button
{
    // ...
}

class MacButtonFactory : ButtonFactory
{
    public Button CreateButton()
    {
        return new MacButton();
    }
} 
```

此外，您可以将[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)与[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)结合起来，封装随类型变化的自定义行为。

# django - Django 查询命中 db 超出预期

> ID：10262252
> 
> 赞同：0
> 
> 时间：2012-04-21T19:27:53.563
> 
> 标签：django, django-queryset

我有一个这样的**model.py**：

```
class Muestraonline(models.Model):
    accessionnumber = models.ForeignKey(Muestra, related_name='online_accessionnumber')
    muestraid = models.ForeignKey(Muestra)
    taxonid = models.ForeignKey(Taxon, null=True, blank=True)
    collectedby = models.ForeignKey(Person, null=True, blank=True)
    locality = models.ForeignKey(Localitymayor, null=True, blank=True) 
```

在我的**views.py中：**

```
def search(request):
    ...
        if genus:
           q &= Q(taxonid__genus__icontains = genus)
        if species:
           q &= (Q(taxonid__specificepithet__icontains = species | Q(taxonid__infraspecificepithet__icontains = species ))) 
        if island_group:
           q &= Q(locality__islandgroup__icontains = island_group)
        if island_name:
           q &= Q(locality__islandname__icontains = island_name)
        if collection_acronym:
           q &= Q(muestraid__collectionid__collectioncode__icontains = collection_acronym)
        if accession_number:
           q &= Q(muestraid__accessionnumber = accession_number)
        if last_name:
           q &= Q(collectedby__verbatimname__icontains = last_name)
        if collection_number:
           q &= Q(muestraid__collectionnumber = collection_number)

        query_set = Muestraonline.objects.filter(q).order_by('taxonid__genus', 'taxonid__specificepithet', 'muestraid') 

        query_set = list(query_set) 
```

在我的**模板**中我做了这样的事情：

```
{% for specimen in items.object_list %}
 {{ specimen.taxonid.genus }} -- {{ specimen.taxonid.specificepithet }}
 {{ specimen.muestraid_id }}
 {{ specimen.accessionnumber_id }}
 {{ specimen.muestraid.localitymayorid.islandname }}
{% endfor %} 
```

当我使用 django 调试工具栏查看结果时，我发现初始搜索查询在 db 上非常繁重，但鉴于结构（不会改变），我想这是不可避免的。但是，当我在模板中迭代时，每个对象也会进行查询以获取`taxon`和`locality`数据。

我认为使用`select_related()`可以避免这种情况，但它实际上减慢了请求速度（通过在初始查询中添加一堆连接），并且查询总数保持不变。

我的问题是：我怎样才能最大限度地减少对数据库的命中？例如，我可以让查询集评估一次，然后在模板中的迭代期间从中提取结果吗？如您所见，我已经尝试将其转换`query_set`为列表，但这没有区别。

这里的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T17:07:01.147

我建议您尝试说出`select_related`要遵循的确切关系。`select_related`添加使查询太慢的事实可能是因为它遵循了不需要的关系。尝试以下操作：

```
query_set = Muestraonline.objects.filter(q).order_by('taxonid__genus', 'taxonid__specificepithet', 'muestraid').select_related('taxonid', 'muestraid__localitymayorid') 
```

我很难相信在添加`select_related`到您的查询之后，它仍然会针对每个实例访问数据库——您确定您正在评估正确的 QuerySet 吗？

此外，在将 QuerySet 提供给分页器之前将其转换为列表并不是最好的主意——它最终会从数据库中获取所有内容，然后将大部分内容丢弃，因为您只显示了一小部分。如果您将 QuerySet 直接提供给分页器，它会限制 QuerySet 本身仅获取您想要的项目。

# jsp - 如何在 Alloy UI 组合框中设置所选项目？

> ID：10262253
> 
> 赞同：1
> 
> 时间：2012-04-21T19:28:09.990
> 
> 标签：jsp, liferay

用项目填充合金 UI 组合框后，如何设置选定项目？我的意思是，插入组合框中的项目之一应该是默认选中的项目。我该如何设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T11:00:06.210

jsp：

```
 <aui:select name="selectedCity" label="City:" id="selectedCity">
        <c:forEach items="${cities}" var="city">
            <aui:option value="${city}" label="${city}" selected="${selectedCity == city}"/>
        </c:forEach>
    </aui:select> 
```

爪哇：

```
 renderRequest.setAttribute("selectedCity", selectedCity);
    List<String> cities = Lists.newArrayList("New Yourk", "Moskau", "London", "Rom");
    renderRequest.setAttribute("cities", cities); 
```

# ios - 对于 iPad / iPhone 应用程序，如何有一个数组点？

> ID：10262254
> 
> 赞同：4
> 
> 时间：2012-04-21T19:29:03.967
> 
> 标签：ios, core-animation, quartz-graphics

我们可以有一个`NSMutableArray`对象，并向它添加对象。

但`CGPoint`不是对象...是否有适合添加到 NSMutableArray 对象的 Point 对象？

我看到一些`NSStringFromCGPoint`用于创建`NSString`对象的代码，以便可以将其添加到数组中，然后再用于`CGPointFromString`返回`CGPoint`...但这看起来太过分了...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T19:35:09.377

`NSValue`您可以使用包装器将点存储在数组中：

```
CGPoint a = CGPointMake(10.0, 10.0);
[array addObject:[NSValue valueWithCGPoint:a]];

CGPoint b = [(NSValue *)[array objectAtIndex:0] CGPointValue]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-21T19:33:05.743

您应该通过以下方法使用[NSValue 类：](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/NSValue_UIKit_Additions/Reference/Reference.html)

```
+ valueWithCGPoint:
- CGPointValue 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-21T19:34:03.137

你必须在...之间做出选择

A.c 指针数组（[看这里](https://stackoverflow.com/questions/859634/c-pointer-to-array-array-of-pointers-disambiguation)）

或者

B.`NSValue`或您的`NSStringFromCGPoint`. 像这样： `[NSValue valueWithCGPoint:CGPointMake(5.5, 6.6)`]

# silverlight - 如何使用 VisualStateManager 定位多个 UIElement？

> ID：10262257
> 
> 赞同：2
> 
> 时间：2012-04-21T19:29:18.083
> 
> 标签：silverlight, visualstatemanager, uielement

如果我做这样的事情来改变椭圆的不透明度：

```
<VisualStateManager.VisualStateGroups>
  <VisualStateGroup x:Name="VisualStateGroup">
    <VisualStateGroup.Transitions>
      <VisualTransition GeneratedDuration="0:0:1">
        <VisualTransition.GeneratedEasingFunction>
          <CircleEase EasingMode="EaseIn"/>
        </VisualTransition.GeneratedEasingFunction>
      </VisualTransition>
    </VisualStateGroup.Transitions>
    <VisualState x:Name="Lit"/>
    <VisualState x:Name="Unlit">
      <Storyboard>
        <DoubleAnimation Duration="0" To="0.225" 
                         Storyboard.TargetProperty="(UIElement.Opacity)" 
                         Storyboard.TargetName="ellipse"  d:IsOptimized="True"/>
      </Storyboard>
    </VisualState>
  </VisualStateGroup>
</VisualStateManager.VisualStateGroups>

<Ellipse x:Name="ellipse" Width="100" Height="100" Fill="Azure"/>

VisualStateManager.GoToState(this, "Unlit", true); 
```

它工作得很好。

但是假设我有一些椭圆并且想将其应用于`StoryBoard`它们，我该怎么做？

```
<Ellipse x:Name="ellipse1" Width="100" Height="100" Fill="Azure"/>
<Ellipse x:Name="ellipse2" Width="100" Height="100" Fill="Azure"/>
<Ellipse x:Name="ellipse3" Width="100" Height="100" Fill="Azure"/> 
```

一种方法是将多个`DoubleAnimation`s 定义为相同的`StoryBoard`：

```
 <Storyboard>
    <DoubleAnimation Duration="0" To="0.225" 
                     Storyboard.TargetProperty="(UIElement.Opacity)" 
                     Storyboard.TargetName="ellipse1"
                       d:IsOptimized="True"/>
    <DoubleAnimation Duration="0" To="0.225" 
                     Storyboard.TargetProperty="(UIElement.Opacity)" 
                     Storyboard.TargetName="ellipse2"
                       d:IsOptimized="True"/>
  </Storyboard> 
```

但是当我有动态数量的椭圆时，这有点麻烦。
有没有更优雅的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T11:56:49.083

我不确定优雅，但一种方法可能是为中间属性设置动画，并将真正的目标属性绑定到该属性：

```
<Grid x:Name="animationTarget" Visibility="Collapsed" />
<Ellipse x:Name="ellipse1" Width="100" Height="100" Fill="Azure" 
    Opacity={Binding Opacity, ElementName=animationTarget}/>
<Ellipse x:Name="ellipse2" Width="100" Height="100" Fill="Azure" 
    Opacity={Binding Opacity, ElementName=animationTarget}/> 
```

和

```
<Storyboard>
    <DoubleAnimation Duration="0" To="0.225" 
                     Storyboard.TargetProperty="(UIElement.Opacity)" 
                     Storyboard.TargetName="animationTarget" />
</Storyboard> 
```

（如果使用不可见的额外元素作为中间绑定目标似乎不太好，则它可能位于椭圆所在的任何容器上的某个附加属性上）

# java - 具有非常大的不经常初始化的字段的实体对象

> ID：10262263
> 
> 赞同：2
> 
> 时间：2012-04-21T19:30:11.293
> 
> 标签：java, object

我的实体对象没有大量未初始化的字段，这些字段的数据类型从基元到集合对象等。但是问题是，在大多数情况下，并非所有字段都是必需的，因此它们未初始化。

每次用户请求时都会创建和销毁大量此类实体对象！所以我有点担心这是否可能是内存或性能方面的问题？！除非需要，否则不会初始化字段。所以我想问一下，如果我在我的类中声明了很多字段但只初始化/使用几个字段，这是否真的很重要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:20:16.163

正如[this](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html) java tutorial page`Fields that are declared but not initialized will be set to a reasonable default by the compiler.` 这意味着每个未初始化的字段将占用几个字节，通常为 4 个字节用于`int`s 和对象。

也就是说，这在很大程度上取决于您的特定系统 - 您的对象有多少字段，每个请求创建多少个对象，每秒有多少个请求等。这可能对不同的垃圾收集器产生不同的影响。

我建议您进行一些分析 - 查看当前对象和大量请求对系统（CPU、内存）的负载。然后，创建一些具有较少字段的假对象，并以相同的负载重新运行您的测试。如果您无法衡量任何差异，那么可能没有什么可担心的，您可以使用一些额外的未使用字段。

# android - 地理点 android 和谷歌地图上的 onClick 侦听器

> ID：10262266
> 
> 赞同：2
> 
> 时间：2012-04-21T19:31:00.833
> 
> 标签：android, google-maps

这是我的代码：

```
geopoint =  new GeoPoint((int) (1.352566007* 1E6), (int) (103.78921587* 1E6));
        mapView.getOverlays().add( new  DrawableMapOverlay(this,geopoint,R.drawable.pushpin, "test"));
        geopoint.setOnClickListener(new OnClickListener()
          {   
              public void onClick(View v)
              {
              System.out.println("Clicked");
              }
          }); 
```

我收到了这个错误：

```
The method setOnClickListener(new View.OnClickListener(){}) is undefined for the type GeoPoint 
```

点击监听器不是在地理点上工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:21:52.730

您应该扩展`ItemizedOverlay<>`类和覆盖`onTap()`方法。

像这样的东西：

```
public class MapOverlay extends ItemizedOverlay<OverlayItem> {

    private ArrayList<OverlayItem> mapOverlay = new ArrayList<OverlayItem>();
    Context mContext;

    public MapOverlay(Drawable itemMarker) {
        super(boundCenterBottom(itemMarker));
        // TODO Auto-generated constructor stub
    }

    public void addItem(OverlayItem item){
        mapOverlay.add(item);
        populate();
    }

    @Override
    protected OverlayItem createItem(int i) {
        // TODO Auto-generated method stub
        return mapOverlay.get(i);
    }

    @Override
    public int size() {
        // TODO Auto-generated method stub
        return mapOverlay.size();
    }

    public MapOverlay(Drawable itemMarker, Context context){
        super(boundCenterBottom(itemMarker));
        mContext = context;
    }

    @Override
    protected boolean onTap(int index) {
        // TODO Auto-generated method stub
        final OverlayItem item = mapOverlay.get(index);
        AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);

        dialog.setTitle(item.getTitle());
        dialog.setMessage(item.getSnippet());

        dialog.show();

        return true;
    }
} 
```

在活动中添加项目：

```
Drawable voltaIcon = this.getResources().getDrawable(R.drawable.arch);
MapOverlay volte = new MapOverlay(voltaIcon, this);

GeoPoint p_Volta = new GeoPoint(45373024, 14348799); 
OverlayItem volta = new OverlayItem(p_Volta,
            getResources().getStringArray(R.array.volta)[0], 
            getResources().getStringArray(R.array.volta)[1]);
volte.addItem(volta); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:24:57.640

您只能在作为视图子类的对象上设置 onClickListener。基本上这意味着像 Button 或 TextView 或任何在屏幕上**可见**的东西，以便您可以单击或触摸它。GeoPoint 本身没有可见性。

# haskell - Haskell 中的无限映射

> ID：10262267
> 
> 赞同：6
> 
> 时间：2012-04-21T19:31:07.927
> 
> 标签：haskell

我正在写一些代码，我想我可以从一个无限的元组列表中创建一个无限的映射。类似于以下内容： `Map.fromList [(i,i+1)|i<-[1..]]`

当然，我立刻发现 Data.Map 和 Data.Set 分别不支持无限 Maps 和 Sets。我注意到一个关于 Data.Set 的贪婪实现的类似问题`fromList`，并且在阅读了[这里](https://stackoverflow.com/questions/7123501/why-doesnt-haskells-data-set-support-infinite-sets)的答案之后，很明显 Set 可以实现惰性和贪婪，只是贪婪的实现更好。但是，我真的不明白为什么懒惰的实现`Map.fromList`不起作用。与密钥的存储方式有关吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-21T19:44:35.370

`Data.Map`被实现为平衡树（我认为大致是二元的）；如果没有对输入的一些预知，很难懒惰地创建和平衡无限二叉树！但是，您可能喜欢[MemoTrie](http://hackage.haskell.org/package/MemoTrie)包之类的东西，它使用惰性无限尝试（位）代替。

```
> let x = trie (\x -> x+1)
> untrie x 72
73
> untrie x 37
38 
```

# java - 带有 Android ArrayList 的 IndexOutOfBoundsException

> ID：10262269
> 
> 赞同：0
> 
> 时间：2012-04-21T19:31:27.100
> 
> 标签：java, android, arraylist, indexing, indexoutofboundsexception

我遇到了一个非常烦人的问题，一些代码抛出了 IndexOutOfBoundsException，我真的不明白为什么。logcat 指向以下代码的“addTimetableItem”，这将进一步解释：

```
if(sortedFridayTimes.size()>0){
    insertDay("Friday");
    for(int i=1; i<sortedFridayTimes.size()+1;i++){
        addTimetableItem(sortedFridayTimes.get(i));
    }
} 
```

“sortedFridayTimes”是一个 ArrayList，其中包含我自己的“时间表条目”对象，我已经按顺序进行了排序。首先检查大小以查看是否有任何对象，然后如果有“insertDay”运行，它会为标题创建一个新的文本视图并将其添加到布局中（这工作正常..）。在 for 循环中，想法是然后将 arraylist 中的所有对象添加到布局中。现在我知道“addTimetableItem”代码就像我已经测试过的那样工作，但我的问题是我似乎无法从数组列表中取出最后一个对象。如果我声明 for 循环只运行

```
"i<sortedFridayTimes.size()" 
```

然后程序运行良好，但我没有得到我知道存在的arraylist 中的最后一个条目，因为我已经调试并观察了我的变量。在添加如上所示的“+1”时，我现在得到了 IndexOutOfBoundsException，我真的不知道为什么。正如我所说，我已经调试过并且我知道我试图指向的数组列表中存在一个条目，但它只是崩溃了。如果需要，我可以提供更多代码，但是有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:44:05.190

您应该接受@Tim 或@Graham 的回答，这只是一个附录。他们对您`size()+1`越过数组末尾是正确的。

如果您无法使用索引正确地从列表中取出所有内容，您还可以尝试使用 for-each 循环（取决于您使用的 Android SDK 版本）。我假设`sortedFridayTimes`是一个类列表，`TimetableItem`因为您没有指定。

所以这：

```
if(sortedFridayTimes.size()>0){
    insertDay("Friday");
    for(int i=1; i<sortedFridayTimes.size()+1;i++){
        addTimetableItem(sortedFridayTimes.get(i));
    }
} 
```

变成这样：

```
if(!sortedFridayTimes.isEmtpy()){
    insertDay("Friday");
    for(TimetimeItem item : sortedFridayTimes){
        addTimetableItem(item);
    }
} 
```

如果您实际上不需要在`i`任何地方使用，请稍微清洁一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:35:32.013

```
i<sortedFridayTimes.size()+1 
```

您正在遍历数组中的最后一个元素。为什么`+1`？

如果数组中有`N`元素，则元素从索引`0`到`N-1`。

所以应该是：

```
for(int i=0; i<sortedFridayTimes.size(); i++) { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:36:21.033

for 循环中的最后一个循环运行：

`sortedFridayTimes.get(sortedFridayTimes.size())`

这将始终超出范围，因为元素是零索引的。

例如，如果数组大小为“5”，那么您无法访问索引“5”，因为数组中的 5 个元素是`0,1,2,3,4`.

# java - GNUmakefile 无法编译 bison 和 flex 程序

> ID：10262273
> 
> 赞同：0
> 
> 时间：2012-04-21T19:32:11.047
> 
> 标签：java, c, bison, flex-lexer

我目前正在使用 flex 和 bison 开发一个简单的编译器。文件夹结构：MainFolder --> src --> Compiler，其中包含以下文件 add_inp.flex、bison.y main.c 和 stack.c 基本上当我单独运行时，它们编译良好并生成以下文件 flex 生成 lex.yy .c 和 bison 产生 add_inp.tab.c & add_inp.tab.h 以下是我的 GNUmake 文件

```
 lex.yy.c: src/dplc/add_inp.flex bison.tab.c src/dplc/bison.tab.h
           flex src/dplc/add_inp.flex   

     bison.tab.c: src/dplc/bison.y 
           bison -d -t src/dplc/bison.y

     a.exe: src/dplc/main.c lex.yy.c bison.tab.c
            gcc src/dplc/main.c

    clean: 
      rm src/dplc/bison.tab.c src/dplc/bison.tab.h src/dplc/lex.yy.c src/dplc/a.exe 
```

我收到这个错误

```
make: *** No rule to make target `src/dplc/bison.y', needed by `bison.tab.c'.  Stop. 
```

如果我没有单独编译 flex 和 bison 程序：

```
make: *** No rule to make target `src/dplc/bison.y', needed by `bison.tab.c'.  Stop. 
```

我很感激这方面的任何帮助我还需要进行构建，以便这些程序与用 Java 编写的 Executor 一起运行，有人可以就我如何完成这项工作提出一些建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T06:41:21.507

这就是我让它工作的方式，感谢大家的帮助。

```
 CC=gcc
  IDIR =src/dplc/
  CFLAGS=-I$(IDIR)
  a.exe: src/dplc/main.c lex.yy.c bison.tab.c 
$(CC) src/dplc/main.c $(CFLAGS) -I.
    bison.tab.c: src/dplc/bison.y 
bison -d -t src/dplc/bison.y
    lex.yy.c: src/dplc/add_inp.flex bison.tab.c bison.tab.h 
flex src/dplc/add_inp.flex  

    clean: 
rm bison.tab.c bison.tab.h lex.yy.c a.exe 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T02:21:02.417

您正在讲述`make`一个文件`src/dplc/bison.y`，但您声称您的目录结构是`MainFolder --> src --> Compiler`. 那不应该`src/Compiler/bison.y`吗？

# umbraco - Umbraco - 通常和 ajax 请求的不同行为

> ID：10262276
> 
> 赞同：0
> 
> 时间：2012-04-21T19:32:21.313
> 
> 标签：umbraco

我正在开发一个“单页”的 Umbraco 站点——无需重新加载，只有 ajax 调用。

该站点将有很好的 url 并使用 html5 推送状态历史记录。

这里的问题是每次向服务器发出请求时，我都需要根据请求的类型进行不同的处理：普通或 ajax。

对于通常的请求，我需要显示内容及其母版页。

对于 ajax 请求，我只需要显示内容。

我不知道如何做到这一点 - 路由和母版页魔术。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:41:21.560

您可以使用备用模板。有关更多信息[，请参见此处](http://www.nibble.be/?p=42)。基本上，让备用模板以您想要的任何格式呈现内容，而不需要完整的 html 模板，然后确保您的所有 AJAX 请求都使用备用模板调用页面。

不过要提醒一句，如果您使用 AJAX 进行所有网站导航并且没有重新加载页面，那么 Google（或大多数其他搜索引擎蜘蛛）将无法正确索引您的网站（因为他们没有） t 处理 javascript) 并且您的网站排名不会很好。

# python - 从同一包中的另一个模块导入包层次结构根目录的python模块的最佳方法

> ID：10262278
> 
> 赞同：5
> 
> 时间：2012-04-21T19:32:22.813
> 
> 标签：python, python-2.7

我写了一个包P。在P的根有一个模块m0。P 内部的某处有模块 m1,m2,... 需要从 m0 导入

当然，我可以在每个模块中编写：

```
from P.m0 import ... 
```

但是，如果我更改 PI 的名称，则必须重新访问所有地方并重写此类语句。

我也可以使用相对导入，但如果我在包层次结构中移动一个不同级别的模块，我必须修复点数。

还有其他一些原因，但归根结底，我真的想说从位于我的包根目录的模块 m0 导入，最好的表达方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:42:45.597

那是不可能的。

但是，如果您执行重大重构，在子包之间移动模块，则必须更新一些相对导入不是一个大问题。

如果您不使用相对导入，同样适用于重命名顶级包名称 - 甚至可以通过搜索和替换所有文件来快速完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:48:02.103

如果你愿意稍微修改你的问题，你可以摆脱这个。

如果您的包的唯一入口点受到控制；例如，您只能通过执行类似调用之类的操作来测试您的`testsuite package/.../module.py`代码

那么你可以确保你做的第一件事是`import firstthing`，并且在 package/firstthing.py 你有：

```
import sys
import os.path
packageDir = os.path.split(__name__)[0]
sys.path[:] = sys.path+[packageDir]  # or maybe you want it first... 
```

主要的警告是，如果不通过入口点，您将无法运行 python 文件。我总是想为我用 python 编写的每个项目执行此操作（以使相对导入工作得很好），但我个人觉得这太不方便了，我就放弃了。

* * *

还有第二种选择。指定你的包需要 python 路径中的另一个包并不是不合理*的。*这个包可能是一个执行重大黑客攻击的实用程序包。例如，如果包的名称是“x”，您可以`import x`使用检查模块在解释器堆栈上执行反射，让您确定从哪个模块导入它。然后，您可以通过向上父目录执行某种“向后 os.walk”，直到找到包的根目录（通过检查一些特殊的指示文件、清单或其他东西）。然后代码将以编程方式执行上述python路径的修改`sys.path`. 它与上面的相同，但是您可以自由地执行诸如运行任何 python 文件之类的操作，而无需通过一个糟糕的入口点。

如果你对 shell 环境有极端的控制，你也可以增加 $PYTHONPATH 以包含你的包目录，但这在很多方面都非常脆弱，而且相当不雅。

# iteration - 为什么我们在训练隐马尔可夫模型时要迭代

> ID：10262283
> 
> 赞同：0
> 
> 时间：2012-04-21T19:33:01.563
> 
> 标签：iteration, hidden-markov-models

我正在使用隐藏马尔可夫模型进行分类，即 jahmm 实现。

在训练模型时，我使用 kMeans 聚类作为初始模型。然后 ia 使用任意迭代轮次来优化模型。我想知道在这些迭代中会发生什么。

我的直觉告诉我，序列是基于初始模型生成的，而这些序列又用于再次训练模型，依此类推。

这是真的还是发生了其他事情？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T19:36:38.640

BaumWelchLearner.java：

```
public <O extends Observation> Hmm<O>
    learn(Hmm<O> initialHmm, List<? extends List<? extends O>> sequences)
    {
        Hmm<O> hmm = initialHmm;

        for (int i = 0; i < nbIterations; i++)
            hmm = iterate(hmm, sequences);

        return hmm;
    } 
```

实际上，它在每次迭代中一遍又一遍地使用提供的观察序列。需要迭代，因为模型有时只能缓慢收敛到局部最大值。编写这样的程序以查看每次迭代后的模型：

```
BaumWelchLearner bwl = new BaumWelchLearner();
for (int i=0; i<=bwl.getNbIterations(); i++) {
    Hmm iteration = bwl.iterate(yourHmm, learningSequences);
    System.out.println("\nIteration " + i + ":\n" + iteration.toString());
    yourHmm = iteration;
} 
```

# apache - 使用 .htaccess 重写 URL

> ID：10262288
> 
> 赞同：1
> 
> 时间：2012-04-21T19:33:19.987
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

参考[这里](http://wettone.com/code/clean-urls)的文章，我用以下几行创建了我的 .htaccess 文件

```
RewriteEngine on

RewriteRule ^/product/([0-9]+)/(.*)$ /index.php?route=product&product=$1 [L] 
```

但这不起作用，我收到 404 错误。

我想要像这样的网址

```
http://localhost/product/12/some-random-text.html 
```

被重定向到

```
http://localhost/index.php?route=product&product=12 
```

我正在使用`GoDaddy's`Linux 主机

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:52:48.310

尝试将您的 RewriteRule 更改为：

```
RewriteRule ^product/([0-9]+)/(.*)$ /index.php?route=product&product=$1 [QSA,L] 
```

# java - 在Android应用程序的for循环中检测按钮点击

> ID：10262289
> 
> 赞同：0
> 
> 时间：2012-04-21T19:33:24.230
> 
> 标签：java, android

我有点麻烦。我的 Android 应用中有 12 个按钮和 10 个问题。如果我对所有问题都运行了一个 for 循环，有没有一种方法可以检查按钮是否被按下以及它是否是当前问题的答案？然后它会继续下一个问题，并做同样的事情直到循环结束。我不知道确切的措辞，但我希望你能明白我的意思。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:43:56.190

该过程是事件驱动的。你按下一个按钮，转到下一个问题。所以你不能使用循环。相反，请使用状态变量来告诉您您所在的问题。每次按下按钮时，您都会检查与您的状态变量相对应的问题的正确性。

如果答案正确，则将状态变量更新为下一个问题。您还可以在这些事件中应用图形，将问题标记为已完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:01:09.177

我只会`setOnClickListener`第一个`Button`，在确认问题的答案是正确的之后，我会让他去下一个问题，这是你的做法..

首先将您的答案存储在某个集合中，例如字符串数组或列表，然后比较以查看`Button`用户单击的答案是否正确。

```
yourFirstButton.setOnClickListener(new View.OnClickListener() {
             public void onClick(View v) {
                 // Perform action on click like
             String str = yourFirstButton.getText();
           //if answer is correct then let him go to next question..
             if(str == StringArray[5]){ //here StringArray[5] refers to correct answer 
             // go to next question here
             }
             else{
            //stay on the same question or let him try again...
             }
         }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T22:06:53.150

另一种方法是创建 10 个活动（或 1 个将问题作为额外的活动）。

然后，用户将在回答问题时逐步完成这些活动。

# c++ - C++ 在没有分配信息的情况下正确释放内存

> ID：10262294
> 
> 赞同：0
> 
> 时间：2012-04-21T19:34:16.070
> 
> 标签：c++, memory-management, memory-leaks

这听起来像是一个愚蠢的问题，但在这种情况下我找不到有关如何正确释放内存的信息：

假设有一个函数返回 a `double*`（没有关于此函数的其他可用信息）。进一步假设以下用例：

```
for (int i = 0; i < SIZE; i++) {
    double *ptr = new double[3];

    /// do something with ptr, e.g., print

    // delete[] ptr;
} 
```

在这种情况下如何正确释放内存，因为`delete[] ptr;`放在上面的评论中会导致回溯（为什么？）？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T19:35:51.443

> 没有关于此功能的其他信息

那你就不知道怎么释放内存了。如果有函数的源代码，请查看它，否则请联系其作者或使用调试工具了解它是如何分配内存的。原始指针根本不携带知道如何释放它的必要信息。

至于您的第二个不相关的情况，这`delete[]`是正确的，因此问题必须在“ `do something`”部分（假设您没有执行`new`重载等技巧）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T19:41:19.253

正在做

```
double *ptr = new double[3];

delete[] ptr; 
```

是完全正确的。因此，您的问题必须存在于其他地方。我可以建议使用调试器来检查发生了什么，如果您使用的是 linux 系统，我建议您尝试 valgrind/helgrind - 非常好

# class - Dart 中的重复类

> ID：10262297
> 
> 赞同：2
> 
> 时间：2012-04-21T19:34:54.747
> 
> 标签：class, import, dart

我正在编写一个简单的应用程序来学习一些基本的 Dart 编程，但我无法弄清楚结构和包含 - 我得到了一个 Duplicate class Point

首先，我有一个名为*MouseTrack*的主类。它初始化列表并将有一个循环。

```
#import('dart:html');
#import('Eye.dart');

class MouseTrace {
List<Eye> eyes;
...
} 
```

其次，我有一个名为*Eye*的类，它应该将眼睛的信息保存为一个圆圈。这很简单：

```
#library('app:eye');

#import('dart:html'); // without this one, I get no error but I want to have it to use CanvasRenderingContext2D

#import('Point.dart');

class Eye {
  Point position;
  num radius;

  Eye() :
      position = new Point() {
  }

  void draw(CanvasRenderingContext2D context) {
    // draws a circle
  }
} 
```

最后*点*：

```
#library('app:point');

class Point {
    num x, y;

    Point(this.x, this.y);
} 
```

我想要实现的是 3 个独立的类 - *main*、*Eye*和*Point*，因此我可以在*main中有**Eye*的实例（为了简单和漂亮的模型）和*Point* in *Eye*的实例（用于存储位置）。至少我习惯这样做。

 ***PS我知道我可以跳过类型，但我想要它，我猜这是包含问题而不是语言的问题（并且想要修复它，所以我知道如何正确地做到这一点）。PSS 我已经剪掉了一些代码，这样你就不必阅读所有内容，但如果你愿意，我会全部发布。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T21:59:35.490

问题出在`app:eye`库中（在`Eye.dart`文件中）。您导入`dart:html`和`app:point`库，但它们都定义了一个`Point`类。这种情况是无效的。您可以通过根本不导入来解决它`dart:html`，如果您不需要它，或者为这些导入之一添加前缀：

```
#import('dart:html', prefix: 'html');
#import('Point.dart'); 
```

在这种情况下，您必须`dart:html`使用`html.`前缀来引用名称。在您的情况下，如果您想使用`CanvasRenderingContext2D`该类，则必须改为编写`html.CanvasRenderingContext2D`。***

# mysql - 在 MySQL 中使用 UPDATE 和 JOIN 时出现语法错误“near FROM”？

> ID：10262300
> 
> 赞同：5
> 
> 时间：2012-04-21T19:35:29.050
> 
> 标签：mysql, sql, syntax-error

```
UPDATE bestall SET view = t1.v, rawview = t1.rv 

FROM bestall INNER JOIN beststat as t1

ON bestall.bestid = t1.bestid 
```

此查询在附近给出语法错误

```
 'FROM bestall INNER JOIN beststat as t1 ON bestall.bestid = t1.bestid' at line 3 
```

有什么理由吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T19:38:06.337

这不是有效的 MySQL 语法。但是，它在 MS SQL Server*中有效。*对于 MySQL，使用：

```
UPDATE 
  bestall
  JOIN beststat AS t1 ON bestall.bestid = t1.bestid 
SET view = t1.v, rawview = t1.rv 
```

MySQL 要求更新表在`SET`子句之前。有关完整详细信息，请参阅[MySQL`UPDATE`语法参考](http://dev.mysql.com/doc/refman/5.5/en/update.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:37:52.077

试试这种方式：

```
UPDATE bestall INNER JOIN beststat as t1
ON bestall.bestid = t1.bestid SET view = t1.v, rawview = t1.rv 
```

# .net - 如何在提琴手中传递 Web 服务发布方法请求正文

> ID：10262304
> 
> 赞同：0
> 
> 时间：2012-04-21T19:35:47.787
> 
> 标签：.net, wcf, web-services, fiddler

我在.net 中有一个非常简单的网络服务

```
[WebInvoke(Method = "POST",
ResponseFormat = WebMessageFormat.Json,
BodyStyle = WebMessageBodyStyle.Wrapped,
UriTemplate = "xml?id={id}")]

string XMLData(string id); 
```

当我通过传递以下 URL 在 Fiddler 中检查它时，它工作正常

```
http://localhost:60104/IO_100_Service.svc/xml?id=123} 
```

但是当我在提琴手的请求正文中传递参数时，它不起作用

```
URL
http://localhost:60104/IO_100_Service.svc/xml

Request Header
Content-Type: application/x-www-form-urlencoded

Request Body
id=123 
```

如果有人对此有任何想法，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:55:44.250

You have specified URI template for your paramerter, threrfore to call this method you should request exactly that URL with parameter in it.

You can pass additionaly some data in body. But with such URI template paramter also should be passed through URI.

When you want you can change URI template and pass your data only on body

# python - 如何将点子指向 Mercurial 分支？

> ID：10262306
> 
> 赞同：31
> 
> 时间：2012-04-21T19:36:03.700
> 
> 标签：python, mercurial, pip

我正在尝试通过 pip 将我的应用程序安装到 virtualenv 进行测试。

适用于安装`default`或`tip`类似：

```
pip install -e hg+https://username@bitbucket.org/username/app_name#egg=app_name 
```

但是有没有办法指向一个分支，而不仅仅是得到小费。不确定这是否是一个反复无常的东西，bitbucket 或 pip。

Bitbucket 允许下载代码的标记版本，但我只能在登录浏览器时让它工作。我尝试`tag`像这样从 tar.gz 安装：

```
pip install https://username@bitbucket.org/username/app_name/get/bbc4286a75db.tar.gz 
```

但即使在输入我的密码后，它也会返回 401 Unauthorized (Its a Private Repo)

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-06T11:01:53.133

在[VCS Support](https://pip.pypa.io/en/latest/reference/pip_install/#vcs-support)部分的官方 pip 文档中：

> 水银
> 
> 支持的方案有：hg+http、hg+https、hg+static-http 和 hg+ssh：
> 
> ```
> -e hg+http://hg.myproject.org/MyProject/#egg=MyProject
> -e hg+https://hg.myproject.org/MyProject/#egg=MyProject
> -e hg+ssh://hg@myproject.org/MyProject/#egg=MyProject 
> ```
> 
> 您还可以指定修订号、修订哈希、标签名称或本地分支名称：
> 
> ```
> -e hg+http://hg.myproject.org/MyProject/@da39a3ee5e6b#egg=MyProject
> -e hg+http://hg.myproject.org/MyProject/@2019#egg=MyProject
> -e hg+http://hg.myproject.org/MyProject/@v1.0#egg=MyProject
> -e hg+http://hg.myproject.org/MyProject/@special_feature#egg=MyProject 
> ```

在命令行指定 repo 时语法相同

```
pip install -e hg+http://hg.myproject.org/MyProject/@special_feature#egg=MyProject 
```

它在不使用从 0.8.2 版本[开始](https://stackoverflow.com/q/5008162/95735)`-e`的选项时有效。

# java - 递归代码的基本情况以打印格式良好的数字

> ID：10262308
> 
> 赞同：0
> 
> 时间：2012-04-21T19:36:13.230
> 
> 标签：java, algorithm

我在网上发现了一个问题：**给定输入大小，打印所有该大小的格式良好的数字。**

**示例**：size = 3 数字：123、234、125 等条件，比如数字是 abc，然后 a < b < c

我正在尝试为此编写一个递归代码，并且由于我很擅长递归，因此无法弄清楚基本情况，或者如何摆脱递归。我有一个想法：

1.  我从给定大小的最小格式良好的数字开始（只需用 填充数组`for loop`）。说 size = 3，我从`123`. 然后我继续，直到`arr[0] == (10 - size))`因为给定大小的最大值`arr[0]`是一个格式良好的数字。

我的功能是`printNumbers(int arr[], int size)`

但我不确定这是否可行。需要一些关于正确方向的指示。

```
public void findNumbers(int arr[], int size, int pos)
    {
        if(arr[0] == (10 - size))
            return;
        if(arr[pos] == (10 - size + pos))
        {
            pos--;
            findNumbers(arr,size,pos);
        }
        System.out.println(Arrays.toString(arr));
        arr[pos] = arr[pos] + 1;
        findNumbers(arr,size,pos);
    }

    public static void main(String[] args)
    {
        int size = 3;
        int pos = size-1;
        int arr[] = new int[size];
        for(int i = 0; i<size; i++)
        {
            arr[i] = i+1;
        }
        //System.out.println(Arrays.toString(arr));
        WellFormed obj = new WellFormed();
        obj.findNumbers(arr, size, pos);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T11:55:40.527

```
import java.util.Arrays;

public class WellFormed {

    public static int maxDigit;

    public void findNumbers(int[] digits, int start, int currPos) {
        if (currPos >= digits.length) {
            System.out.println(Arrays.toString(digits));
            return;
        }

        int maxDigitInCurrPos = maxDigit - digits.length + currPos + 1;
        for (int i = start; i <= maxDigitInCurrPos; i++) {
            digits[currPos] = i;
            findNumbers(digits, i+1, currPos + 1);
        }
    }

    public static void main(String[] args)
    {   
        WellFormed obj = new WellFormed();
        maxDigit = 5;
        int inputSize = 3;
        int[] digits = new int[inputSize];
        obj.findNumbers(digits, 1, 0);
    }
} 
```

这工作正常：

```
For inputSize = 3 and maxDigit = 5, output is:

[1, 2, 3]
[1, 2, 4]
[1, 2, 5]
[1, 3, 4]
[1, 3, 5]
[1, 4, 5]
[2, 3, 4]
[2, 3, 5]
[2, 4, 5]
[3, 4, 5] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T15:18:06.323

它必须是Java吗？这是 Haskell 的五行解决方案。我喜欢这个（和其他 Haskell 代码）的地方在于它基本上读起来像是问题的定义。

```
wellFormed::Int->[a]->[[a]]
wellFormed _ [] = []
wellFormed 1 xs = map (\x -> [x]) xs
wellFormed n (x:xs) = helper n x xs ++ wellFormed n xs
  where helper n init rest = map ((:) init) (wellFormed (n - 1) rest)

> wellFormed 3 "123456789"
["123","124","125","126","127","128","129","134","135","136","137","138","139","145","146","147","148","149","156","157","158","159","167","168","169","178","179","189","234","235","236","237","238","239","245","246","247","248","249","256","257","258","259","267","268","269","278","279","289","345","346","347","348","349","356","357","358","359","367","368","369","378","379","389","456","457","458","459","467","468","469","478","479","489","567","568","569","578","579","589","678","679","689","789"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T19:57:17.683

看到您的清晰描述，我认为您对问题的了解多于对问题的了解。所以这一次我回答了这样典型的“家庭作业”。

```
public void giveWellFormedNumbers(int inputSize) {
    int[] digits = new int[intputSize];
    giveWFNumbers(digits, 0, 1);
}

/**
 * @param fromIndex the numbers of digits done, the starting index to continue.
 */
private giveWFNumbers(int[] digits, int fromIndex, int fromDigitValue) {
    if (fromIndex >= digits.length) {
        System.out.println(Arrays.toString(digits));
        return;
    }

    // Do one digit yourself, at digits[fromIndex]:

    int maxDigit = 10 - digits.length; // What is the maximal digit you have to do?
    for (int digitValue = fromDigitValue; digitValue <= maxDigit; ++digitValue) {
        digits[fromIndex = digitValue;
        giveFWNumbers(digits, fromIndex + 1, digitValue + 1);
    }
} 
```

请注意，如果这是家庭作业，您还没有完成。

# objective-c - NS_INLINE 与静态内联相比有什么优势？

> ID：10262313
> 
> 赞同：19
> 
> 时间：2012-04-21T19:36:36.293
> 
> 标签：objective-c, cocoa, static, inline

查看它的定义`NS_INLINE`似乎使用它的优势`static inline`是编译器兼容性，对吗？在objective-c项目中应该`NS_INLINE`总是使用而不是c函数吗？`static inline`

```
#if !defined(NS_INLINE)
    #if defined(__GNUC__)
        #define NS_INLINE static __inline__ __attribute__((always_inline))
    #elif defined(__MWERKS__) || defined(__cplusplus)
        #define NS_INLINE static inline
    #elif defined(_MSC_VER)
        #define NS_INLINE static __inline
    #elif TARGET_OS_WIN32
        #define NS_INLINE static __inline__
    #endif
#endif 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-22T20:47:51.573

> 查看 NS_INLINE 的定义，似乎使用它优于静态内联的优点是编译器兼容性，对吗？

只是一部分。您必须评估这里的主要工具链，并问“为什么`static inline` *没有*使用，或者为什么它不充分？”。主要工具链包含属性`__attribute__((always_inline))`。所以这实际上有两个部分：

*   a) 兼容性因此它增加了对多个编译器的兼容性。

*   b)`__attribute__((always_inline))`在主要工具链中使用。`inline`已演变为对`inline`. 使用`always_inline`，编译器仍然可以保留不内联函数的权利（出于显而易见的原因）。然而，它也说“相信我，我想要这个内联——编译器，如果可能的话，内联这个”。这个属性恢复了程序员的部分内联能力。这可以用于性能，但我怀疑（在这种情况下）它更多地与减少私有导出函数的数量有关，而不是性能要求。

> 在 Objective-C 项目中是否应该始终使用 NS_INLINE 而不是静态内联？

不`__attribute__((always_inline))`应该留给那些在优化程序方面有很多经验并且使用过这个工具的人。此属性可应用于 C 函数、C++ 方法和其他静态调用。它不能应用于 ObjC 类或实例方法（它们是动态的）。我提到这一点是因为编译器、优化器和 LTO 非常擅长它们的工作。同时，内联的不当使用可能会导致（任何）几个性能损失。例外情况（对于没有花费大量时间进行优化的人）当然是当人们花时间衡量它所产生的差异时。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-21T19:49:47.017

是的，它是为了编译器的兼容性，但我认为它更多的是为了使用框架而不是你自己的代码。当然，您可以免费使用它，但我不会打扰。

# language-agnostic - 词法作用域和静态作用域有什么区别？

> ID：10262316
> 
> 赞同：12
> 
> 时间：2012-04-21T19:36:54.120
> 
> 标签：language-agnostic, scope, lexical-scope

在[为那些来自其他语言的人进行 R 编程时，](http://www.johndcook.com/R_language_for_programmers.html) John Cook 说

> R 使用词法作用域，而 S-PLUS 使用静态作用域。差异可能很微妙，尤其是在使用闭包时。

我觉得这很奇怪，因为我一直认为词法作用域和静态作用域是同义词。

词汇和静态作用域是否有不同的属性，或者这是从社区到社区、个人到个人的区别？如果是这样，一般营地是什么，我如何区分它们，以便我可以更好地理解某人使用这些词时的含义。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T20:25:03.793

[维基百科](http://en.wikipedia.org/wiki/Scope_%28computer_science%29)（和我）同意你的观点，术语“词汇范围”和“静态范围”是同义词。 [这个 Lua 讨论](http://lua-users.org/wiki/LuaScopingDiscussion)试图做出区分，但指出人们不同意这种区别是什么。:-)

在我看来，尝试的区别与访问不同的函数激活记录（“堆栈块”，如果你愿意的话）中的名称有关，而不是最新的执行记录，这主要（仅？）发生在嵌套职能：

```
function f:
    var x
    function h:
        var y
        use(y)  -- obviously, accesses y in current activation of h
        use(x)  -- the question is, which x does this access? 
```

对于词法范围，答案是“被`f`称为激活的激活`h`”，而对于动态范围，它意味着“具有任何名为的变量的最新激活`x`”（可能不是`f`）。另一方面，如果语言完全禁止使用`x`，则毫无疑问“这`x`是哪个”，因为答案是“错误”。:-) 看起来好像有些人使用“静态范围”来指代第三种情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T18:42:27.780

R 官方文档还解决了 R 和 S-plus 之间的范围差异：http: [//cran.r-project.org/doc/manuals/R-intro.html#Scope](http://cran.r-project.org/doc/manuals/R-intro.html#Scope)

链接中给出的示例可以简化如下：

```
 cube <- function(n) {
   sq <- function() n*n
   n*sq()
 } 
```

S-Plus 和 R 的结果不同：

```
 ## first evaluation in S
 S> cube(2)
 Error in sq(): Object "n" not found
 Dumped
 S> n <- 3
 S> cube(2)
 [1] 18
 ## then the same function evaluated in R
 R> cube(2)
 [1] 8 
```

我个人认为在 R 中处理变量的方式更自然。

# windows-phone-7 - 从 WP7 应用程序访问 SD 卡上的文件

> ID：10262318
> 
> 赞同：1
> 
> 时间：2012-04-21T19:37:03.933
> 
> 标签：windows-phone-7

有什么方法可以从 Windows Phone 7 应用程序访问 SD 卡上的任何类型的文件（图像/文本/媒体）。我从多篇文章中读到 WP7 应用程序只能访问那些在应用程序的 IsolatedStorageFile 下可用的文件（这是应用程序的本地文件）。有谁知道直接从手机上的 SD 卡读取文件的方法，或者可以将 SD 卡文件移动/写入应用程序的独立存储文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T21:06:28.023

当前版本的 Windows Phone 7 不支持 SD 卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-23T20:40:37.033

In Windows Phone 8, you can access files under the device SD Card using Microsoft.Phone.Storage API: [http://msdn.microsoft.com/en-us/library/windows/apps/jj720573(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windows/apps/jj720573(v=vs.105).aspx)

# javascript - Aptana Studio 3.1.1 中的 jQuery 代码辅助

> ID：10262320
> 
> 赞同：0
> 
> 时间：2012-04-21T19:37:06.227
> 
> 标签：javascript, jquery, aptana, aptana3

这不是重复的问题，因为 Aptana Studio 3.1.1 中发生了很多变化，并且没有关于该版本的问题。

我想在 Aptana Studio 中为 jQuery 提供代码协助。我已经安装了 jQuery 包。但是我的代码仍然没有得到任何代码帮助。

例如，我输入：$("div#chat")。键入 dot 后，我​​应该会看到所有 jQuery 函数的列表。但我什么也没看到。

我必须做些什么来修复它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-23T05:34:26.830

使用此处的说明，它按预期对我有用：

1.  命令 > 安装包 > jQuery
2.  右键单击一个项目，选择 Properties > Project Build Path 并选择 jQuery 1.6.2 的复选框。

如果你不做第二部分，你只会得到片段。这可以防止您需要将其复制到每个项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:50:37.670

修好了 如果您想为 jquery 提供代码提示，您需要下载（未压缩的）jQuery 库并将其放在与脚本相同的文件夹中。

这是有效的，但它并不能让我满意。我有很多文件夹，我不想在所有文件夹中复制 jQuery 文件。

# php - PHP 和 post 数组

> ID：10262324
> 
> 赞同：1
> 
> 时间：2012-04-21T19:37:38.080
> 
> 标签：php, post

将 post 数组用于 post 变量有什么不好的吗？

```
<input type="text" id="stuff" name="stuff[text]"/> 
```

代替

```
<input type="text" id="stuff" name="stuff"/> 
```

提示何时使用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:44:56.563

不，没有理由不这样做。

然而，PHP 几乎是唯一一种允许创建这样的数组的语言——因此，如果您将后端更改为不同的语言，您可能需要进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:51:46.153

这不是一个坏方法。通常，程序员以这种方式使用数组来发布长度不确定的数组。仍然。不确定，但是当您想将方法更改为 GET 时，IE <= 8 的地址长度限制为 2048 个字符。而动态生成的数组可以很容易地消除这个限制。在其他浏览器上，限制要高得多，或者没有。

此方法的另一个缺点是 PHP 将正确执行，但其他服务器端语言可能不会。据我所知，这在官方 HTML 文档中没有指定。

所以将它放在后数组中的单个单元格中更方便，即子数组。如果你想做一些命名空间，那么你可以这样写名字：

名称="styff.text"

就像一些论坛引擎一样（对于某些 Vanilla 2 来说）。

如果它与您没有差异，我将保留 html 名称中的单个变量名称。主要是因为后端。

对于如何使用它们的提示，我可以推荐使用这样的数组来覆盖现场动态生成的内容。仍然可以用普通名称处理它，但它非常难看。如果我们有一个案例，你想做一个图片添加系统，我会用“pic []”命名每个输入文件并在服务器上迭代整个表。在客户端生成文档也是如此。然后我会使用“content[][name]”“content[][type]”“content[][value]”等名称。无论我在文档部分类中拥有什么，我都会使用这种命名，并且在服务器上只检查设置并为某些文档块做某些事情。

这可能会讨论很长时间，因为每个程序员都有自己的技术并且他们倾向于坚持下去。例如，我在现场的每种形式中都抛出一个，每个动作都由一个通用控制器解析，然后由特定控制器传递。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T19:43:49.550

没什么不好。如果它对你四个有用，请使用它。

# php - 从大型数据库中提取数据

> ID：10262334
> 
> 赞同：-2
> 
> 时间：2012-04-21T19:38:50.577
> 
> 标签：php, mysql

我正在尝试从包含大约 170,000 行数据的数据库中查询电子邮件。我有一个基本的 mysql php 脚本可以工作，但只会显示前 34,000 个左右的数据。

我的最终目标是清除大量重复的数据库。我该怎么办？

```
<?php
$query="SELECT * FROM guess ORDER BY id";
$result=mysql_query($query);
$num=mysql_numrows($result);
mysql_close();
?>

First

<?php
$b=30000;
while ($b < 60000) {
    $id = mysql_result($result,$b,"id");
    $email = mysql_result($result,$b,"Email");
?>

<?php echo $b;  ?>. <?php echo $email ?> <br />
<?php $nummer++;   $b++; } ?> 

second 
```

通过使用上述内容，我打算将所有包含电子邮件的行存储在 php 数组中。

然后，编写一个脚本来查找重复的电子邮件并删除它们。最后，在浏览器中打印代码，复制并粘贴文本并上传到我的 chimpmail。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:43:20.983

一个可能不是一个好的想法，但无论如何......如果您一次只读取 34K 数据并且您知道总行数，那么在查询中使用 LIMIT 可能是一个解决方案。

# ruby-on-rails-3.1 - Heroku 上的资产预编译错误

> ID：10262336
> 
> 赞同：0
> 
> 时间：2012-04-21T19:38:57.070
> 
> 标签：ruby-on-rails-3.1, heroku

我是 RoR 的新手，正试图部署到 Heroku，但它让我发疯！这是我的日志：

```
2012-04-21T19:32:27+00:00 app[web.1]: 
2012-04-21T19:32:27+00:00 app[web.1]: 
2012-04-21T19:32:27+00:00 app[web.1]: Started GET "/" for 89.240.212.20 at 2012-04-21 19:32:27 +0000
2012-04-21T19:32:27+00:00 app[web.1]: Processing by StoreController#index as HTML
2012-04-21T19:32:27+00:00 app[web.1]:   Rendered store/index.html.erb within layouts/application (86.1ms)
2012-04-21T19:32:27+00:00 app[web.1]: Completed 500 Internal Server Error in 266ms
2012-04-21T19:32:27+00:00 app[web.1]: 
2012-04-21T19:32:27+00:00 app[web.1]: ActionView::Template::Error (scaffold.css isn't precompiled):
2012-04-21T19:32:27+00:00 app[web.1]:     4: <head>
2012-04-21T19:32:27+00:00 app[web.1]:     5:   <title>Pragprog Books Online Store</title>
2012-04-21T19:32:27+00:00 app[web.1]:     6: <!-- START:stylesheet -->
2012-04-21T19:32:27+00:00 app[web.1]:     7:   <%= stylesheet_link_tag "scaffold" %>
2012-04-21T19:32:27+00:00 app[web.1]:     8:   <%= stylesheet_link_tag "depot", :media => "all" %><!-- <label id="code.slt"/> -->
2012-04-21T19:32:27+00:00 app[web.1]:     9: <!-- END:stylesheet -->
2012-04-21T19:32:27+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__3129246563521504454_25831520'
2012-04-21T19:32:27+00:00 app[web.1]:     10:   <%= javascript_include_tag :defaults %>
2012-04-21T19:32:27+00:00 app[web.1]: 
2012-04-21T19:32:27+00:00 app[web.1]: 
2012-04-21T19:32:27+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=384ms status=500 bytes=643
2012-04-21T19:32:28+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=10ms status=200 bytes=0
2012-04-21T19:32:28+00:00 heroku[web.1]: Error R12 (Exit timeout) -> Process failed to exit within 10 seconds of SIGTERM
2012-04-21T19:32:28+00:00 heroku[web.1]: Stopping process with SIGKILL
2012-04-21T19:32:29+00:00 heroku[web.1]: Process exited with status 137
2012-04-21T19:33:09+00:00 app[web.1]: 
2012-04-21T19:33:09+00:00 app[web.1]: 
2012-04-21T19:33:09+00:00 app[web.1]: Processing by StoreController#index as HTML
2012-04-21T19:33:09+00:00 app[web.1]: Started GET "/" for 89.240.212.20 at 2012-04-21 19:33:09 +0000
2012-04-21T19:33:09+00:00 app[web.1]:   Rendered store/index.html.erb within layouts/application (1.6ms)
2012-04-21T19:33:09+00:00 app[web.1]: Completed 500 Internal Server Error in 7ms
2012-04-21T19:33:09+00:00 app[web.1]: 
2012-04-21T19:33:09+00:00 app[web.1]: ActionView::Template::Error (scaffold.css isn't precompiled):
2012-04-21T19:33:09+00:00 app[web.1]:     4: <head>
2012-04-21T19:33:09+00:00 app[web.1]:     5:   <title>Pragprog Books Online Store</title>
2012-04-21T19:33:09+00:00 app[web.1]:     8:   <%= stylesheet_link_tag "depot", :media => "all" %><!-- <label id="code.slt"/> -->
2012-04-21T19:33:09+00:00 app[web.1]:     6: <!-- START:stylesheet -->
2012-04-21T19:33:09+00:00 app[web.1]:     7:   <%= stylesheet_link_tag "scaffold" %>
2012-04-21T19:33:09+00:00 app[web.1]:     9: <!-- END:stylesheet -->
2012-04-21T19:33:09+00:00 app[web.1]:     10:   <%= javascript_include_tag :defaults %>
2012-04-21T19:33:09+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__3129246563521504454_25831520'
2012-04-21T19:33:09+00:00 app[web.1]: 
2012-04-21T19:33:09+00:00 app[web.1]: 
2012-04-21T19:33:09+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=19ms status=500 bytes=643
2012-04-21T19:33:10+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=34ms status=304 bytes=0
2012-04-21T19:33:11+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=31ms status=500 bytes=643
2012-04-21T19:33:11+00:00 app[web.1]: 
2012-04-21T19:33:11+00:00 app[web.1]: 
2012-04-21T19:33:11+00:00 app[web.1]: Processing by StoreController#index as HTML
2012-04-21T19:33:11+00:00 app[web.1]: Started GET "/" for 89.240.212.20 at 2012-04-21 19:33:11 +0000
2012-04-21T19:33:11+00:00 app[web.1]: Completed 500 Internal Server Error in 12ms
2012-04-21T19:33:11+00:00 app[web.1]: 
2012-04-21T19:33:11+00:00 app[web.1]: ActionView::Template::Error (scaffold.css isn't precompiled):
2012-04-21T19:33:11+00:00 app[web.1]:     5:   <title>Pragprog Books Online Store</title>
2012-04-21T19:33:11+00:00 app[web.1]:     4: <head>
2012-04-21T19:33:11+00:00 app[web.1]:   Rendered store/index.html.erb within layouts/application (1.4ms)
2012-04-21T19:33:11+00:00 app[web.1]:     7:   <%= stylesheet_link_tag "scaffold" %>
2012-04-21T19:33:11+00:00 app[web.1]: 
2012-04-21T19:33:11+00:00 app[web.1]:     8:   <%= stylesheet_link_tag "depot", :media => "all" %><!-- <label id="code.slt"/> -->
2012-04-21T19:33:11+00:00 app[web.1]:     9: <!-- END:stylesheet -->
2012-04-21T19:33:11+00:00 app[web.1]:     10:   <%= javascript_include_tag :defaults %>
2012-04-21T19:33:11+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__3129246563521504454_25831520'
2012-04-21T19:33:11+00:00 app[web.1]: 
2012-04-21T19:33:11+00:00 app[web.1]:     6: <!-- START:stylesheet -->
2012-04-21T19:33:13+00:00 app[web.1]: 
2012-04-21T19:33:13+00:00 app[web.1]: 
2012-04-21T19:33:13+00:00 app[web.1]: Processing by StoreController#index as HTML
2012-04-21T19:33:13+00:00 app[web.1]: Started GET "/" for 89.240.212.20 at 2012-04-21 19:33:13 +0000
2012-04-21T19:33:13+00:00 app[web.1]:   Rendered store/index.html.erb within layouts/application (14.5ms)
2012-04-21T19:33:13+00:00 app[web.1]: Completed 500 Internal Server Error in 66ms
2012-04-21T19:33:13+00:00 app[web.1]: ActionView::Template::Error (scaffold.css isn't precompiled):
2012-04-21T19:33:13+00:00 app[web.1]:     4: <head>
2012-04-21T19:33:13+00:00 app[web.1]: 
2012-04-21T19:33:13+00:00 app[web.1]:     5
:   <title>Pragprog Books Online Store</title>
2012-04-21T19:33:13+00:00 app[web.1]:     6: <!-- START:stylesheet -->
2012-04-21T19:33:13+00:00 app[web.1]:     7:   <%= stylesheet_link_tag "scaffold" %>
2012-04-21T19:33:13+00:00 app[web.1]:     8:   <%= stylesheet_link_tag "depot", :media => "all" %><!-- <label id="code.slt"/> -->
2012-04-21T19:33:13+00:00 app[web.1]:     9: <!-- END:stylesheet -->
2012-04-21T19:33:13+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__3129246563521504454_25831520'
2012-04-21T19:33:13+00:00 app[web.1]:     10:   <%= javascript_include_tag :defaults %>
2012-04-21T19:33:13+00:00 app[web.1]: 
2012-04-21T19:33:13+00:00 app[web.1]: 
2012-04-21T19:33:13+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=89ms status=500 bytes=643
2012-04-21T19:33:15+00:00 app[web.1]: 
2012-04-21T19:33:15+00:00 app[web.1]: 
2012-04-21T19:33:15+00:00 app[web.1]: Started GET "/" for 89.240.212.20 at 2012-04-21 19:33:15 +0000
2012-04-21T19:33:15+00:00 app[web.1]: Processing by StoreController#index as HTML
2012-04-21T19:33:15+00:00 app[web.1]:   Rendered store/index.html.erb within layouts/application (1.4ms)
2012-04-21T19:33:15+00:00 app[web.1]: Completed 500 Internal Server Error in 20ms
2012-04-21T19:33:15+00:00 app[web.1]: 
2012-04-21T19:33:15+00:00 app[web.1]:     4: <head>
2012-04-21T19:33:15+00:00 app[web.1]:     6: <!-- START:stylesheet -->
2012-04-21T19:33:15+00:00 app[web.1]: ActionView::Template::Error (scaffold.css isn't precompiled):
2012-04-21T19:33:15+00:00 app[web.1]:     7:   <%= stylesheet_link_tag "scaffold" %>
2012-04-21T19:33:15+00:00 app[web.1]:     5:   <title>Pragprog Books Online Store</title>
2012-04-21T19:33:15+00:00 app[web.1]:     9: <!-- END:stylesheet -->
2012-04-21T19:33:15+00:00 app[web.1]:     10:   <%= javascript_include_tag :defaults %>
2012-04-21T19:33:15+00:00 app[web.1]:     8:   <%= stylesheet_link_tag "depot", :media => "all" %><!-- <label id="code.slt"/> -->
2012-04-21T19:33:15+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__3129246563521504454_25831520'
2012-04-21T19:33:15+00:00 app[web.1]: 
2012-04-21T19:33:15+00:00 heroku[router]: GET depotalghamdi.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=65ms status=500 bytes=643
2012-04-21T19:33:15+00:00 app[web.1]: 
```

我尝试了我所知道的一切来预编译所有 css 和 js 文件，但仍然收到我什至设置`config.assets.precompile += ['*.js', '*.css']`但仍然无法正常工作的这个错误。当我转向`config.serve_static_assets`一切`true`工作时，但如您所知，它有一些缺点！有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:21:11.837

看起来您正在尝试直接加载脚手架 css 文件 - application.html.erb 的第 7 行？我不熟悉您所依据的教程，但通常您的`stylesheet_link_tag`is`application`本身就是一个清单文件，让 sprockets 知道需要编译什么。

在您的 assets\stylesheets 目录中创建一个`application.css`文件，它应该如下所示；

```
/*
*= require_self
*= require_tree
*/ 
```

您可以保留现有的 scaffold.css 文件，因为 require_tree 将使 sprockets 在其编译任务中包含该文件。

# github - 我如何“声明”一个 GitHub 存储库？或者找主人？

> ID：10262350
> 
> 赞同：1
> 
> 时间：2012-04-21T19:41:39.440
> 
> 标签：github

大约 18 个月前，我编写了[一些代码](https://github.com/ghettonet/GhettoNet)并将其粘贴在 GitHub 上。那里的[提交](https://github.com/ghettonet/GhettoNet/commits/master)在我的名下。如果我登录然后单击“andrew cooke”（来自提交消息），我最终会进入[一个显示](https://github.com/andrewcooke)“this is you”的页面。所以是我，我猜。但“成员来自”日期是今年 2 月。

在同一页面上，它说我有 0 个公共和 0 个私人回购。那么我是否以其他人的身份创建了回购协议？谁？我将如何发现并索回它？或者，我是否误解了 GitHib 界面中的某些内容？

这不是一个伟大的项目，但它是我的。我即将开始另一个，但想使用相同的帐户，我很困惑。

[**更新**：链接可能已损坏，因为我已使用答案将项目移至我的新帐户]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:46:11.823

您链接到的存储库归用户[ghettonet 所有](https://github.com/ghettonet)。提交通过电子邮件地址链接到您的“andrewcooke”帐户。您的“andrewcooke”帐户不拥有该`ghettonet/GhettoNet`存储库。

您是否可能创建了“ghettonet”帐户然后忘记了它？您是否尝试过*该*帐户的密码恢复？

# android - 如何更改apk文件并在线辞职？

> ID：10262355
> 
> 赞同：1
> 
> 时间：2012-04-21T19:41:50.233
> 
> 标签：android, sign

出于某些安全原因，我需要在用户下载 apk 文件之前更改 apk 文件。但是当我更改 .apk 内容时，我的应用程序无法安装。它需要辞职。

所以我想知道如何仅使用 zip-open/read/write 操作或使用 php 的其他操作将其辞职。

我看到的唯一方法是在服务器上安装 sdk 工具并在 php 中使用 shell 命令使用它们。但我想知道是否有更简单的方法可以做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:56:18.077

> 我看到的唯一方法是在服务器上安装 sdk 工具并在 php 中使用 shell 命令使用它们。

很可能，这是您唯一的选择。即使 PHP 以某种方式`jarsigner`嵌入了功能齐全的功能，也不太可能具有`zipalign`.

但是请注意，通过“sdk 工具”，您实际上只需要 Java SDK (for `jarsigner`) 和`zipalign`二进制文件（AFAIK 没有其他依赖项）。您不需要整个 Android SDK。

# jquery - jquery从函数返回？

> ID：10262356
> 
> 赞同：1
> 
> 时间：2012-04-21T19:41:56.970
> 
> 标签：jquery, function, return

我试图了解从函数返回 jquery 值的正确方法。我在这里检查了 API 以及其他问题，但找不到正确的方法。我想要的只是一个要返回的简单变量，因此我可以将其设置为全局变量。这是我得到的：

```
var a = 0, b, c;
var imgArr = [];

  $(document).ready(function() { //populates array with images

        var smooth = popArr();
        alert(smooth);
  }

 function popArr(){
        $("#thumb_slider").children().each(function(index, element) {
            var newImg = $("<img />").attr({
                src: this.src,
                alt: 'space'
            }).addClass(index == 0 ? "left_slot" : (index == 1 ? "middle_slot" : "right_slot"));
            imgArr.push(newImg);
          return imgArr;               // This comes back as undefined.

        });
    } 
```

我的问题是为什么它返回未定义？我什至应该在 Jquery 中使用“return”吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T19:46:05.550

你尝试从`.each`回调中返回一些东西。该函数唯一有用的返回值是`false`提前取消“循环”。

只需将您的退货声明移到之后`});`，一切都会正常工作。

您还可以避免使用全局变量 - 您返回数组，因此无需将其设为全局变量：

```
function popArr() {
    var imgArr = [];
    $("#thumb_slider").children().each(function (index, element) {
        var newImg = $("<img />").attr({
            src: this.src,
            alt: 'space'
        }).addClass(index == 0 ? "left_slot" : (index == 1 ? "middle_slot" : "right_slot"));
        imgArr.push(newImg);
    });
    return imgArr;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:47:22.477

该方法`popArr()`没有返回任何东西。相反，它正在调用`.each()`

因为它是一个全局变量，只需将元素推入其中就足够了。

# javascript - 可见性时关闭元素之间的间隙：隐藏

> ID：10262361
> 
> 赞同：0
> 
> 时间：2012-04-21T19:42:16.423
> 
> 标签：javascript, html

如果我用 隐藏其中的一些元素，如何缩小元素之间的差距`visibility: hidden`？

我有这个 HTML。

```
 <div id="logged_in" style="display:inline; visibility: hidden;"><a onclick=""></a>&nbsp;&#8226;&nbsp;</div>
    <a id="login_box" onclick="show_login_user();">Login</a>
    <a id="logout_box" onclick="logout_user();" style="visibility: hidden;">Logout</a>&nbsp;|&nbsp;
    <a onclick="show_register_user();">Register</a>&nbsp;|&nbsp; 
```

当用户注销时，注销是隐藏的，登录和注册之间存在间隙。`logged_in`如果用户已登录，则用户名和注销之间存在间隙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:43:49.217

改为使用`display:none;`。`visibility:hidden;`不会“释放”隐藏元素使用的空间。

# android-layout - TabHost 布局中不需要的边距

> ID：10262362
> 
> 赞同：0
> 
> 时间：2012-04-21T19:42:31.247
> 
> 标签：android-layout, android-tabhost

我是 Android 开发的相对论新手，但我确实喜欢认为我很快就会赶上。我一直在重新开发我为垒球队制作的应用程序。以前我使用过 Google 的 App Inventor，但遇到了很多缺点，所以我现在尝试使用 Eclipse 对其进行重新设计。

总之，说到点子上了。我似乎在我的 LinearLayout 中添加了一些多余的填充，我不确定它来自哪里。

我正在使用 TabHost 在顶部创建选项卡（Google 选项卡示例的修改版本）。

布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/main_linlay_parent"
  android:orientation="vertical"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  >

    <TabHost 
        android:id="@android:id/tabhost"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        >

            <RelativeLayout
                android:orientation="vertical"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:background="@drawable/background"
                >        

                <!-- Allow the "Tabs" to scroll horizontally -->
                <HorizontalScrollView 
                    android:layout_width="match_parent" 
                    android:layout_height="match_parent" 
                    android:fillViewport="true" 
                    android:scrollbars="none" 
                    >

                    <!-- The "Tabs" widget -->
                    <TabWidget
                        android:id="@android:id/tabs"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content" 
                        android:background="#000000"
                        />

                </HorizontalScrollView>

                <!-- Provide the "Content" the ability to vertically scroll -->
                <ScrollView
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"
                    android:layout_marginTop="65dp"
                    >
                    <FrameLayout
                        android:id="@android:id/tabcontent"
                        android:layout_width="match_parent"
                        android:layout_height="wrap_content"
                        >
                        <LinearLayout
                            android:id="@+id/tabdata"
                            android:orientation="vertical"
                            android:layout_width="match_parent"
                            android:layout_height="match_parent"
                             >
                         </LinearLayout>
                    </FrameLayout>
                </ScrollView>
            </RelativeLayout>
    </TabHost>
</LinearLayout> 
```

我相信这个问题与`android:layout_marginTop="65dp"`ScrollView 中的有关，但如果我删除它，我的选项卡就会消失（我假设我的选项卡内容只是覆盖在它的顶部）。

最后，这是一个屏幕截图，显示了我正在经历的一个示例（忽略 XML 字符串，我仍然需要按摩那部分。我只是想展示一个带有数据的示例。）。 [http://kahunaball.com/android/screenshot_0.jpg](http://kahunaball.com/android/screenshot_0.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T03:03:22.577

在从头开始 XML 并向前迈出一小步后，我能够重新处理 XML 并解决布局中多余的填充问题。

我不是 100% 确定哪个更改产生了影响，但我怀疑改变`RelativeLayout`to`LinearLayout`和移动 the`LinearLayout`和`TableLayout`外部是成功的`FrameLayout`方法。

对于其他可能偶然发现并希望看到我的新 XML 解决问题的人，这里是：

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
    <LinearLayout 
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/background">
        <HorizontalScrollView 
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:fillViewport="true"
            android:scrollbars="none">
            <TabWidget 
                android:id="@android:id/tabs"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="#000000" />
        </HorizontalScrollView>
        <ScrollView
            android:layout_width="match_parent"
            android:layout_height="match_parent" >
            <HorizontalScrollView 
                android:layout_width="match_parent" 
                android:layout_height="wrap_content" 
                android:fillViewport="true" 
                android:scrollbars="none" >
                <FrameLayout 
                    android:id="@android:id/tabcontent"
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent" >
                    <LinearLayout
                        android:id="@+id/tabdata"
                        android:orientation="vertical"
                        android:layout_width="match_parent"
                        android:layout_height="match_parent"
                        android:gravity="center_horizontal" />
                    <TableLayout
                        android:id="@+id/myTableLayout"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="#33B5E5" />
                </FrameLayout>
            </HorizontalScrollView>
        </ScrollView>
  </LinearLayout>
</TabHost> 
```

# asp.net-mvc-3 - Asp.net MVC3 中的多个角色

> ID：10262369
> 
> 赞同：3
> 
> 时间：2012-04-21T19:43:39.127
> 
> 标签：asp.net-mvc-3, role

我有一个管理员站点供管理员创建用户。在这里，他必须为用户选择角色——比如 Asp.NET 配置站点。我制作了 3 个具有不同角色的复选框。

```
[Authorize(Roles = "Admin")]
    [HttpPost]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {

            var Rolemodel = model.RolesContainer; 
            // Attempt to register the user
            MembershipCreateStatus createStatus;
            Membership.CreateUser(model.UserName, model.Password, model.Email, null, null, true, null, out createStatus);
            if (createStatus == MembershipCreateStatus.Success)
            {
                FormsAuthentication.SetAuthCookie(model.UserName, false /* createPersistentCookie */);
                return RedirectToAction("Index", "Home");
            }
            else
            {
                ModelState.AddModelError("", ErrorCodeToString(createStatus));
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    }

   [Authorize(Roles = "Admin")]
    public ActionResult Register()
    {
        List<SelectListItem> tempRoles = new List<SelectListItem>();
        tempRoles.Add(new SelectListItem{ Text = "Admin", Selected = false, Value = "Admin" });
            tempRoles.Add(new SelectListItem{ Text = "Production", Selected = false, Value = "Production"});
                tempRoles.Add(new SelectListItem{ Text = "Sale", Selected = false, Value = "Sale"});

                return View(new RegisterModel { RolesContainer = tempRoles });
    } 
```

- - 看法 - - - -

```
@{ foreach (var item in Model.RolesContainer)
               {
                    @Html.DisplayFor(m => item.Text)
                    @Html.CheckBoxFor(m => item.Selected)
               }
            } 
```

当我检查它们并提交时，我在我的操作中到达断点`Register`，但此时`RolesContainer`为空 - 谁能告诉我这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:50:13.523

我将您的代码（cshtml 除外）复制并粘贴到以下文件中，它按预期工作。

**家庭控制器.cs**

```
using System.Collections.Generic;
using System.Web.Mvc;
using MvcApplication1.Models;

namespace MvcApplication1.Controllers
{
    public class HomeController : Controller
    {
        //
        // GET: /Home/

        public ActionResult Index()
        {
            List<SelectListItem> tempRoles = new List<SelectListItem>();
            tempRoles.Add(new SelectListItem { Text = "Admin", 
                                               Selected = false, 
                                               Value = "Admin" });
            tempRoles.Add(new SelectListItem { Text = "Production", 
                                               Selected = false, 
                                               Value = "Production" });
            tempRoles.Add(new SelectListItem { Text = "Sale", 
                                               Selected = false, 
                                               Value = "Sale" });

            return View(new RegisterModel { RolesContainer = tempRoles });
        }

    }
} 
```

**注册模型**

```
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Web.Mvc;

namespace MvcApplication1.Models
{
    public class RegisterModel
    {
        [Required]
        [Display(Name = "Brugernavn")]
        public string UserName { get; set; }

        [Required]
        [DataType(DataType.EmailAddress)]
        [Display(Name = "Email adresse")]
        public string Email { get; set; }

        public List<SelectListItem> RolesContainer { get; set;}
    }
} 
```

**主页/Index.cshtml**

```
@model MvcApplication1.Models.RegisterModel

@{ 
    foreach (var item in Model.RolesContainer)
    {
        @Html.DisplayFor(m => item.Text)
        @Html.CheckBoxFor(m => item.Selected)
    }
} 
```

您的 Register.cshtml 文件中很可能有问题，我们无需对其进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:00:35.853

当前，当您为其分配值时，`RolesContainer`尚未初始化。你只需要在你的类的构造函数中初始化它：

```
public class RegisterModel
{
    public RegisterModel() {
        RolesContainer = new List<SelectListItem>;
    }

    // rest of your code
} 
```

或者，您可以创建一个接受`List<>`作为参数的构造函数，但上述方法将适用于您当前的代码结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:03:16.027

如果我理解得很好（可能我完全错了），您发布到 httppost 寄存器 (RegisterModel) 的模型不包含您期望的 RolesContainer。我认为，asp.net mvc 无法将多个复选框与 a 匹配`List<SelectListItem>`， ListBox 应该更好

# android - .xml (android) 中的 Coverview 小部件

> ID：10262376
> 
> 赞同：0
> 
> 时间：2012-04-21T19:44:08.040
> 
> 标签：android, coverflow

Coverview 是我从[http://www.inter-fuser.com/2010/02/android-coverflow-widget-v2.html](http://www.inter-fuser.com/2010/02/android-coverflow-widget-v2.html)实现的一个小部件，它可以工作，直到我想使用它 .xml 而不是添加按钮和东西。我不知道如何将两者联系起来，任何帮助将不胜感激

我的主要活动：

```
package cover.flow.test;

import java.io.FileInputStream;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.LinearGradient;
import android.graphics.Matrix;
import android.graphics.Paint;
import android.graphics.PorterDuffXfermode;
import android.graphics.Bitmap.Config;
import android.graphics.PorterDuff.Mode;
import android.graphics.Shader.TileMode;
import android.graphics.drawable.BitmapDrawable;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.ImageView.ScaleType;

 public class CoverFlowExampleActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);

 CoverFlow coverFlow;
 coverFlow = new CoverFlow(this);

 coverFlow.setAdapter(new ImageAdapter(this));

 ImageAdapter coverImageAdapter =  new ImageAdapter(this);

 //coverImageAdapter.createReflectedImages();

 coverFlow.setAdapter(coverImageAdapter);

 coverFlow.setSpacing(-25);
 coverFlow.setSelection(4, true);
 coverFlow.setAnimationDuration(1000);

 setContentView(coverFlow);

}

 public class ImageAdapter extends BaseAdapter {
 int mGalleryItemBackground;
 private Context mContext;

 private FileInputStream fis;

 private Integer[] mImageIds = {
   R.drawable.kasabian_kasabian,
         R.drawable.starssailor_silence_is_easy,
         R.drawable.killers_day_and_age,
         R.drawable.garbage_bleed_like_me,
         R.drawable.death_cub_for_cutie_the_photo_album,
         R.drawable.kasabian_kasabian,
         R.drawable.massive_attack_collected,
         R.drawable.muse_the_resistance,
         R.drawable.starssailor_silence_is_easy
 };

 private ImageView[] mImages;

 public ImageAdapter(Context c) {
  mContext = c;
  mImages = new ImageView[mImageIds.length];
 }
  public boolean createReflectedImages() {
      //The gap we want between the reflection and the original image
      final int reflectionGap = 4;

      int index = 0;
      for (int imageId : mImageIds) {
    Bitmap originalImage = BitmapFactory.decodeResource(getResources(), 
      imageId);
       int width = originalImage.getWidth();
       int height = originalImage.getHeight();

       //This will not scale but will flip on the Y axis
       Matrix matrix = new Matrix();
       matrix.preScale(1, -1);

       //Create a Bitmap with the flip matrix applied to it.
       //We only want the bottom half of the image
       Bitmap reflectionImage = Bitmap.createBitmap(originalImage, 0, height/2, width, height/2, matrix, false);

       //Create a new bitmap with same width but taller to fit reflection
       Bitmap bitmapWithReflection = Bitmap.createBitmap(width 
         , (height + height/2), Config.ARGB_8888);

      //Create a new Canvas with the bitmap that's big enough for
      //the image plus gap plus reflection
      Canvas canvas = new Canvas(bitmapWithReflection);
      //Draw in the original image
      canvas.drawBitmap(originalImage, 0, 0, null);
      //Draw in the gap
      Paint deafaultPaint = new Paint();
      canvas.drawRect(0, height, width, height + reflectionGap, deafaultPaint);
      //Draw in the reflection
      canvas.drawBitmap(reflectionImage,0, height + reflectionGap, null);

      //Create a shader that is a linear gradient that covers the reflection
      Paint paint = new Paint(); 
      LinearGradient shader = new LinearGradient(0, originalImage.getHeight(), 0, 
        bitmapWithReflection.getHeight() + reflectionGap, 0x70ffffff, 0x00ffffff, 
        TileMode.CLAMP); 
      //Set the paint to use this shader (linear gradient)
      paint.setShader(shader); 
      //Set the Transfer mode to be porter duff and destination in
      paint.setXfermode(new PorterDuffXfermode(Mode.DST_IN)); 
      //Draw a rectangle using the paint with our linear gradient
      canvas.drawRect(0, height, width, 
        bitmapWithReflection.getHeight() + reflectionGap, paint); 

      ImageView imageView = new ImageView(mContext);
      imageView.setImageBitmap(bitmapWithReflection);
      imageView.setLayoutParams(new CoverFlow.LayoutParams(120, 180));
      imageView.setScaleType(ScaleType.MATRIX);
      mImages[index++] = imageView;

      }
   return true;
}

 public int getCount() {
     return mImageIds.length;
 }

 public Object getItem(int position) {
     return position;
 }

 public long getItemId(int position) {
     return position;
 }

 public View getView(int position, View convertView, ViewGroup parent) {

  //Use this code if you want to load from resources
     ImageView i = new ImageView(mContext);
     i.setImageResource(mImageIds[position]);
     i.setLayoutParams(new CoverFlow.LayoutParams(130, 130));
     i.setScaleType(ImageView.ScaleType.CENTER_INSIDE); 

     //Make sure we set anti-aliasing otherwise we get jaggies
     BitmapDrawable drawable = (BitmapDrawable) i.getDrawable();
     drawable.setAntiAlias(true);
     return i;

  //return mImages[position];
 }
   /** Returns the size (0.0f to 1.0f) of the views 
  * depending on the 'offset' to the center. */ 
  public float getScale(boolean focused, int offset) { 
    /* Formula: 1 / (2 ^ offset) */ 
      return Math.max(0, 1.0f / (float)Math.pow(2, Math.abs(offset))); 
   } 

 }
 } 
```

我的 main.xml （这是我试图链接但没有运气）

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>

<cover.flow.test.CoverFlow
    android:id="@+id/coverflow"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/button1"
    android:layout_alignParentTop="true" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:text="Button" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:16:10.310

要与视图链接，您需要类似的东西

设置内容视图（R.layout.main）；

并删除创建 CoverFlow 实例的代码（而不是使用 findViewById 等获取它）

# java - Java Associate 考试和 Java Programmer 考试有什么区别

> ID：10262377
> 
> 赞同：4
> 
> 时间：2012-04-21T19:44:11.873
> 
> 标签：java, associate

在接下来的 6 个月内，我将不得不参加上述其中一项考试才能通过我的部分课程，并且我在学校的最后 2 年一直在学习 Java，我想知道这两项考试之间是否存在巨大差异，我会最好只参加程序员考试并绕过助理考试，或者助理考试的技能有很大的提高。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T20:25:32.397

Java Associate 考试范围更广。它面向刚毕业的新开发人员，或转换语言的开发人员。Java 程序员考试更深入。您需要了解语言和语言规范的更多细节。它针对有一定经验的人。

我建议在 Java Ranch 认证子论坛中查看以下主题。他们详细介绍了考试之间的差异。

*   [从哪个认证开始：SCJA 还是 SCJP？](http://www.coderanch.com/t/565422/java-SCJA/certification/which-certification-start-SCJA-or)
*   [关于 Java SE 7 OCA 和 OCP 的一些问题](http://www.coderanch.com/t/560202/java-SCJA/certification/Some-questions-Java-SE-OCA)

鉴于您的情况，Associates 考试可能是更好的起点。

# javascript - JavaScript：将输入元素添加到当前 div

> ID：10262393
> 
> 赞同：2
> 
> 时间：2012-04-21T19:45:41.837
> 
> 标签：javascript, html, add

我有一个 javascript 函数，它向页面添加一个带有三个输入的 div，以及一个向同一个 div 添加更多输入的链接（想象一下，用户不知道会有多少字段，所以他可以动态添加它们）。

```
var div=document.createElement("div");
div.innerHTML='<input type="text" name="question" /><br><br>'+
              '<input type="text" name="input1"/><br />'+
              '<input type="text" name="input2"/><br />'+
              '<a href="javascript:addInput()">Add input field</a>';

var parent_div=document.getElementById('dinamicni_div');
parent_div.appendChild(div); 
```

我现在如何实现这个 addInput() 函数以在同一 div中的最后一个输入（当前*input2 ）下方添加一个输入（但在链接上方）？*

*澄清一下——我有两个动态生成内容的 JS 函数：addDiv()，你可以在上面看到它被缩短了；和我想实现的 addInput() ，它应该在当前 div 中添加一个输入，点击链接。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T19:50:57.607

尝试

```
document.getElementById('yourdiveID').innerHTML += "<input type='text' value='' /><br />"; 
```

它将添加到 div 的末尾。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T19:50:54.550

给你的链接一个类或 id 并使用这个方法插入： http: [//api.jquery.com/insertBefore/](http://api.jquery.com/insertBefore/)

编辑：

我同意，问题与 jquery 无关，但提问者暗示，他的要求允许这样做，为了完整起见，这里是 jquery 中的代码（以海报无理恐吓学习 jquery）

```
function createInputMethod(){
    return $('<input type="text" name="question" /><br><br>'+
              '<input type="text" name="input1"/><br />'+
              '<input type="text" name="input2"/><br />');
}

var div = $("<div/>");
div.append(createInputMethod());
div.append($('<a href="javascript:addInput()" id="btn">Add input field</a>');
var parent_div=$('dinamicni_div');
div.appendTo(parent_div);

function addInput(){
   createInputMethod().insertBefore("#btn");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T19:49:15.733

您可以在您创建的 div 中添加一个包含输入字段的 div，然后像以前一样通过附加子项来轻松添加新元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-21T20:00:35.590

我会做这样的事情。获取所有输入。计算输入数量并使用 jquery`after`方法添加。代码是这样的：

```
function addInputMethod() {

    var len = $('div').find('input').length;

    $('input:nth-child(' + len + ')').after('<input type="text" name="input' + (len + 1) +'"/><br />'); 
} 
```

**编辑**

如果您没有`id`for`div`您可以将长度更改为此

`var len = $(this).parent().find('input').length;`

还将第二行更改为

`$(this).parent().find('input:nth-child...`

# c - 如何编译 C 文件但限制库的使用？

> ID：10262401
> 
> 赞同：1
> 
> 时间：2012-04-21T19:46:36.147
> 
> 标签：c, unix, gcc, compilation

我正在使用 Unix 服务器。

我正在从我的客户端获取 ac 文件作为输入，并对其进行编译。

c 文件应该是非常基本的，并且只包含来自 stdio 、 stdlib 、数学、字符串的函数。

GCC 编译器中是否有任何标志不允许使用任何其他库，并且在使用其他库的情况下会引发编译错误？

如果有不涉及 GCC 的解决方案，它也可能很好，但我不想检查文件。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T20:08:49.970

限制库（包括编译时的头文件和链接时的库链接）不会阻止不受信任的代码直接调用危险的（如与安全相关的）内核系统调用。这可以通过不受信任的代码来完成，例如通过使用内联汇编或 shellcode/exploit 技术，例如通过故意覆盖堆栈上的返回地址以指向包含 shellcode 的字符串。

话虽如此，您可以使用`-nostdlib -nodefaultlibs`链接器选项来防止链接到库。但是，这仍然只允许您拥有整个 libc，或者一个都没有。您不能有选择地仅链接到 libc 的一部分（例如 have `printf()`but not `system()`）。

只允许某些包含也不是很有效：代码可以只从包含文件中复制声明，而不是包含某些标头来绕过仅允许特定`#include`语句的限制。例子：

```
int system(const char *);
int main() {
    return system("uname -a");
} 
```

如果它必须是安全的，您可能应该考虑在运行时对代码进行沙箱处理，而不是试图阻止不安全的代码编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:59:50.460

将选项`-nodefaultlibs`或传递`-nostdlib`给 gcc，以及仅包含允许库的选项（如`-lm`数学库）。有关这些选项的更多信息，请查看[gcc 手册](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)。

> **`-nodefaultlibs`**
> 链接时不要使用标准系统库。只有您指定的库才会传递给链接器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T20:13:19.843

为了说明您允许包含 stdlib.h 的不安全性，我将编写一个可以在您的机器上运行任意代码的小程序。

```
#include <stdlib.h>

int main() {
    system("`which python` -c \"print 'hello word'\"");
    // instead of simply printing hello world i could open a socket back to the 
    // attacker's machine and start reading in abitrary code and executing it.
    return 0;
} 
```

# jquery - jQuery循环访问数组中的数据并附加到div

> ID：10262403
> 
> 赞同：0
> 
> 时间：2012-04-21T19:46:56.027
> 
> 标签：jquery, arrays, cycle

我在我的网站上设计了一个稍微复杂的 jQuery 循环，我需要`data`将特定幻灯片中的 jQuery 循环加载到位于实际滑块顶部的不同 div 中，所以每次我点击 next/prev 时，它都会加载正确的数据- 我的问题是在回调中如何设置索引以使其与数组中的正确数据相对应？我想真正的问题是关于访问数组中的数据，而不是循环。

```
 var array = [ 
        {
            url: 'slide01.jpg',
            data : 'Eat, <br /> Drink, <br /> Escape!'
        },    
        {
            url: 'slide02.jpg',
            data : 'Eat, <br /> Drink, <br /> Escape!2'
        },  
        {
            url: 'slide03.jpg',
            data : 'Eat, <br /> Drink, <br /> Escape!3'
        },  
        {
            url: 'slide04.jpg',
            data : 'Eat, <br /> Drink, <br /> Escape!4'
        },  
        {
            url: 'slide05.jpg',
            data : 'Eat, <br /> Drink, <br /> Escape!5'
        }                        
    ];

    var path = 'img/';

        $.each(array, function(i) {
            $('#slider').append('<li data-id="' + i + '"><img src=' + path + array[i].url + '></li>');
        });

        $('#slider').cycle({
        fx: "scrollHorz",
        next: "#next",
        prev: "#prev",
        speed: 1000,
        timeout: 5000,
        before: onBefore(),
        after: onAfter(),
        cssBefore: {
            opacity: 0
        },
        animIn: {
            opacity: 1
        },
        animOut: {
            opacity: 0
        },
        cssAfter: {
            opacity: 1
        },
        delay: 3000
        });
        function onBefore() { 
        $('#content').html("Scrolling image:<br>" + this.src); 
        } 
        function onAfter() { 
        $('#content').empty().append('<h1>' + array[i].data + '</h1>'); 
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T19:17:34.917

after 事件具有以下参数[http://jquery.malsup.com/cycle/options.html](http://jquery.malsup.com/cycle/options.html)：

`function(currSlideElement, nextSlideElement, options, forwardFlag)`

因此，您可以在该事件中执行类似 array[options.currSlide] 的操作。

```
 function onAfter(currSlideElement, nextSlideElement, options, forwardFlag) { 
      $('#content').empty().append('<h1>' + array[options.currSlide].data + '</h1>'); 
    } 
```

# java - Jetty Tapestry 热部署 = 服务器重启？

> ID：10262405
> 
> 赞同：0
> 
> 时间：2012-04-21T19:47:03.943
> 
> 标签：java, jetty, tapestry

有人可以确认使用 Jetty 的挂毯热部署是：“扫描项目以查找更改并重新启动服务器？”

或者是：监视更改并替换服务器上的新文件，但不重新启动它？

Atm 我使用 jetty 每 5 秒监控一次我的项目，如果检测到更改，它会重新启动服务器？

但这就是所谓的“热部署”吗？Bc 如果在进行更改后无论如何都必须重新启动服务器，我并没有真正节省时间？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T11:19:46.233

热部署意味着组件类、模板和服务（使用 Tapestry IOC 时）在更改时无需重新启动服务器即可重新加载。此行为通过开关关闭和`SymbolConstants.PRODUCTION_MODE`打开。

有关详细信息，请参阅文档中的[类重新加载部分](http://tapestry.apache.org/class-reloading.html)。

# visual-studio-2012 - 如何在 Visual Studio 11 中更改“突出显示当前行”的边框宽度和颜色

> ID：10262411
> 
> 赞同：26
> 
> 时间：2012-04-21T19:47:32.977
> 
> 标签：visual-studio-2012

通过更改安装更新后，我已经能够更改背景颜色

工具/选项/环境/文本编辑器/突出显示当前行（活动）

有没有办法改变高光边框的宽度或颜色？

我喜欢突出显示，所以我不想只是禁用它。但是最好消除边框，缩小边框或更改颜色。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-10T09:49:38.493

您可以通过以下方式使边界消失

工具 > 选项... > 环境 > 字体和颜色 > 显示设置：文本编辑器 > 显示项目：突出显示当前行（活动）/（非活动）

为了更改边框颜色，您应该更改它们的设置“项目前景”。您也可以选择任何背景颜色，但似乎无法更改宽度。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-04-24T13:05:23.493

自从编写了原始答案以来，这种行为似乎已得到修复。所以答案需要更新，这里是：

[https://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3012415-remove-the-light-border-around-highlight-current](https://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3012415-remove-the-light-border-around-highlight-current)

```
You can remove the border by matching the Background color of the
Highlight Current Line (Active) setting in Fonts and Colors to the
Foreground color. This is a simple customization. 
```

转到工具 > 选项 > 环境 > 字体和颜色并在那里查找突出显示当前行，活动和非活动。如 VS 团队所述，通过链接删除边框并在上面引用。

![在此处输入图像描述](../Images/6380c2e12dc105d87a3be3ab5bd70abb.png)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-10T15:07:27.420

来自Cathy Sullivan Visual Studio Program Manager 提供的[MSDN 线程](http://social.msdn.microsoft.com/Forums/da-DK/vseditor/thread/aa5877cc-e207-491d-b88c-d2b29dfd83b4)

转到工具 > 选项 > 环境 > 字体和颜色中的字体和颜色。确保“显示设置”设置为“文本编辑器”，并在“显示项目”列表中找到“突出显示当前行（活动）”项目。将前景色与该项目的背景色相匹配，您会注意到突出显示当前行周围的较浅边框“消失”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-25T22:40:24.217

试试这些设置...

工具（菜单）> 选项
环境（选项卡）> 常规

将颜色主题设置为深色。

环境（选项卡）> 字体和颜色
显示项>“突出显示当前行（活动）”（列表项）

将“项目前景”设置为“默认”
将“项目背景”设置为“自动”

当前行周围的边框不应再让人感到压抑'-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-04T14:31:07.643

我喜欢为代码使用黑色背景，所以我将线条突出显示颜色更改为非常深的灰色 [通过工具 > 选项... > 环境 > 字体和颜色 > 显示项目：> 突出显示当前行（活动）] 这样它就是在背景下不那么明显。有帮助的是，虽然边框太厚，但文本实际上是在边框顶部呈现的，这很好。

当然，更细的线条和改变整条线条颜色的能力，而不仅仅是边框，会受到欢迎。

# java - 带有 ObjectInputStream 的 Android ClassNotFoundException

> ID：10262418
> 
> 赞同：2
> 
> 时间：2012-04-21T19:48:13.733
> 
> 标签：java, android, classnotfoundexception, objectinputstream

我正在尝试将对象从服务器应用程序发送到 android 客户端。所有的类都在同一个包中，并且在 Eclipse 的 src 文件夹中，包括导致 ClassNotFoundException: CardGame 的类。我是android新手，对java还很陌生，并且已经坚持了几天，所以我想知道是否有人能够帮助我找出问题所在......

这是导致问题的代码...

```
CardGame game = (CardGame) in.readObject(); 
```

这是堆栈跟踪...

```
04-21 19:21:35.608: W/System.err(482): java.lang.ClassNotFoundException: CardGame
04-21 19:21:35.618: W/System.err(482):  at java.lang.Class.classForName(Native Method)
04-21 19:21:35.618: W/System.err(482):  at java.lang.Class.forName(Class.java:235)
04-21 19:21:35.618: W/System.err(482):  at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:2590)
04-21 19:21:35.618: W/System.err(482):  at java.io.ObjectInputStream.readNewClassDesc(ObjectInputStream.java:1846)
04-21 19:21:35.618: W/System.err(482):  at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:826)
04-21 19:21:35.618: W/System.err(482):  at java.io.ObjectInputStream.readNewObject(ObjectInputStream.java:2066)
04-21 19:21:35.618: W/System.err(482):  at java.io.ObjectInputStream.readNonPrimitiveContent(ObjectInputStream.java:929)
04-21 19:21:35.628: W/System.err(482):  at java.io.ObjectInputStream.readObject(ObjectInputStream.java:2285)
04-21 19:21:35.628: W/System.err(482):  at java.io.ObjectInputStream.readObject(ObjectInputStream.java:2240)
04-21 19:21:35.628: W/System.err(482):  at com.client.activity.play.init(play.java:107)
04-21 19:21:35.628: W/System.err(482):  at com.client.activity.play.onCreate(play.java:54)
04-21 19:21:35.628: W/System.err(482):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-21 19:21:35.628: W/System.err(482):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-21 19:21:35.628: W/System.err(482):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-21 19:21:35.628: W/System.err(482):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-21 19:21:35.628: W/System.err(482):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-21 19:21:35.638: W/System.err(482):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-21 19:21:35.638: W/System.err(482):  at android.os.Looper.loop(Looper.java:123)
04-21 19:21:35.638: W/System.err(482):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-21 19:21:35.638: W/System.err(482):  at java.lang.reflect.Method.invokeNative(Native Method)
04-21 19:21:35.638: W/System.err(482):  at java.lang.reflect.Method.invoke(Method.java:521)
04-21 19:21:35.638: W/System.err(482):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-21 19:21:35.638: W/System.err(482):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-21 19:21:35.648: W/System.err(482):  at dalvik.system.NativeStart.main(Native Method)
04-21 19:21:35.648: W/System.err(482): Caused by: java.lang.NoClassDefFoundError: CardGame
04-21 19:21:35.648: W/System.err(482):  ... 24 more
04-21 19:21:35.658: W/System.err(482): Caused by: java.lang.ClassNotFoundException: CardGame in loader dalvik.system.PathClassLoader[/data/app/com.client.activity-1.apk]
04-21 19:21:35.658: W/System.err(482):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
04-21 19:21:35.668: W/System.err(482):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
04-21 19:21:35.668: W/System.err(482):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
04-21 19:21:35.668: W/System.err(482):  ... 24 more 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T16:46:03.733

事实证明，通过 ObjectOutputStream 发送的对象的类在服务器和客户端设备上必须具有相同的包名称。这似乎解决了我的问题。感谢大家的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T15:39:47.620

值得注意的是，不同 VM（例如 Android 的 Delvik 和 Sun JVM）之间的序列化可能不兼容。

我建议如果您进行服务器/Android 通信，那么您应该依赖 XML 或 JSON 之类的东西（我更喜欢后者，并且有一些 Android 类可以使它更容易）

见：http: [//developer.android.com/reference/org/json/JSONObject.html](http://developer.android.com/reference/org/json/JSONObject.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T19:53:10.897

It's hard to say much more without being able to see your Eclipse setup, but that error indicates that your `CardGame` class is not ending up getting package into the APK that's getting built.

Is that class in the Android project or is it in the Server project? If it's in the server project, make sure that project is being referenced by the Android project and that your `CardGame` class is getting exported properly and is visible in that project.

If you look at the source code in Eclipse with the line:

`CardGame game = (CardGame) in.readObject();`

Is it finding `CardGame` OK? If not, then your classpath setup is bad. If yes, then the Android build is not pulling in all the necessary resources when building the APK.

# delphi - Delphi 7：在 dll 中调用时函数崩溃，在 exe 中工作

> ID：10262420
> 
> 赞同：2
> 
> 时间：2012-04-21T19:48:21.150
> 
> 标签：delphi, function, dll, crash, pascal

我在网上找到的 Delphi 7 字符串解码器函数（“解密”）有问题。它需要一个字符串和 1 到 120 之间的四个数值来解码。将函数放在可执行文件中并运行它效果很好。但是，我想在 DLL 中运行它。我正在使用一个额外的函数从调用任务接收必要的值并从那里调用解密函数。由于某种原因，我无法确定，每次 dll 调用解密函数时，主机应用程序都会崩溃。在过去的几个小时里，我一直在尝试我能想出的一切来让它发挥作用，但没有成功。一般来说，我是 Delphi 和 Pascal 的新手，所以我可能只是忽略了一些明显的事情。不管怎样，我迷路了。任何帮助将不胜感激。

编辑：这是崩溃时弹出的Windows错误：

```
 Fault Module Name:    StackHash_0a9e
  Fault Module Version: 0.0.0.0
  Fault Module Timestamp:   00000000
  Exception Code:   c0000005
  Exception Offset: 00000000
  OS Version:   6.1.7600.2.0.0.256.1
  Locale ID:    1031
  Additional Information 1: 0a9e
  Additional Information 2: 0a9e372d3b4ad19135b953a78882e789
  Additional Information 3: 0a9e
  Additional Information 4: 0a9e372d3b4ad19135b953a78882e789 
```

这是我使用的代码：

```
library decrypt_test_dll;

uses
  SysUtils,
  Classes,
  Dialogs;

{$R *.res}

function callfunction(externalstring, value1, value2, value3, value4: PAnsiChar):integer; cdecl;
var
  convkey1, convkey2, convkey3, convkey4 : string;
  convstring, decodedstring : string;
  Decrypt : function(Text : string; Key1, Key2, Key3, Key4 : Integer) : string;
begin
  convkey1 := value1;
  convkey2 := value2;
  convkey3 := value3;
  convkey4 := value4;
  convstring := externalstring;
  decodedstring := Decrypt(externalstring, strtoint(convkey1), strtoint(convkey2), strtoint(convkey3), strtoint(convkey4));
  showmessage(decodedstring);
end;

function Decrypt(Text : string; Key1, Key2, Key3, Key4 : Integer) : string;
var
 BufS, Hexa1, Hexa2 : string;
  BufI, BufI2, Divzr, Sc, Sl, Num1, Num2, Num3, Num4, Res1, Res2, Res3, Res4 : Integer;
begin
  showmessage('within decryption function');
 Sl := Length(Text);
  Sc := 0;
  BufS := '';
  if (Key1 in [1 .. 120]) and (Key2 in [1 .. 120]) and (Key3 in [1 .. 120]) and (Key4 in [1 .. 120]) then
    begin
      Divzr := Key1 * Key4;
      BufI2 := Key3 * Key2;
      Divzr := Divzr - BufI2;
      if Divzr = 0 then
        begin
          Result := '';
          Exit;
        end;
    end
  else
    begin
      Result := '';
      Exit;
    end;
  repeat
    for BufI := 1 to 4 do
      begin
        Inc(Sc);
        Hexa1 := IntToHex(Ord(Text[Sc]), 2);
        Inc(Sc);
        Hexa2 := IntToHex(Ord(Text[Sc]), 2);
        if Hexa1 = 'FF' then
          begin
            Hexa1 := '00';
            Hexa2 := '00';
          end;
        if Hexa1 = 'FE' then Hexa1 := '00';
        if Hexa1 = 'FD' then
          begin
            Hexa1 := Hexa2;
            Hexa2 := '00';
          end;
        case BufI of
          1 : Res1 := StrToInt('$' + Hexa1 + Hexa2);
          2 : Res2 := StrToInt('$' + Hexa1 + Hexa2);
          3 : Res3 := StrToInt('$' + Hexa1 + Hexa2);
          4 : Res4 := StrToInt('$' + Hexa1 + Hexa2);
        end;
      end;
    BufI := Res1 * Key4;
    BufI2 := Res2 * Key3;
    Num1 := BufI - BufI2;
    Num1 := Num1 div Divzr;
    BufI := Res2 * Key1;
    BufI2 := Res1 * Key2;
    Num2 := BufI - BufI2;
    Num2 := Num2 div Divzr;
    BufI := Res3 * Key4;
    BufI2 := Res4 * Key3;
    Num3 := BufI - BufI2;
    Num3 := Num3 div Divzr;
    BufI := Res4 * Key1;
    BufI2 := Res3 * Key2;
    Num4 := BufI - BufI2;
    Num4 := Num4 div Divzr;
    BufS := BufS + Chr(Num1) + Chr(Num2) + Chr(Num3) + Chr(Num4);
    until Sc >= Sl;
    Result := BufS;
end;

exports
  Decrypt index 1,
  callfunction index 2;

begin
end. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T19:56:23.083

这段代码全错了：

```
function callfunction(externalstring, value1, value2, value3, value4: PAnsiChar):integer; cdecl;
var
  convkey1, convkey2, convkey3, convkey4 : string;
  convstring, decodedstring : string;
  Decrypt : function(Text : string; Key1, Key2, Key3, Key4 : Integer) : string;
begin
  convkey1 := value1;
  convkey2 := value2;
  convkey3 := value3;
  convkey4 := value4;
  convstring := externalstring;
  decodedstring := Decrypt(externalstring, strtoint(convkey1), strtoint(convkey2), strtoint(convkey3), strtoint(convkey4));
  showmessage(decodedstring);
end; 
```

`Decrypt`永远不会分配局部变量。所以当你打电话时`Decrypt`，任何事情都可能发生。您需要移动`callfunction`到单元的底部，以便它出现在真实的`Decrypt`. 并且您需要删除函数指针变量。

```
function callfunction(externalstring, value1, value2, value3, value4: PAnsiChar):integer; cdecl;
var
  convkey1, convkey2, convkey3, convkey4 : string;
  convstring, decodedstring : string;
begin
  convkey1 := value1;
  convkey2 := value2;
  convkey3 := value3;
  convkey4 := value4;
  convstring := externalstring;
  decodedstring := Decrypt(externalstring, strtoint(convkey1), strtoint(convkey2), strtoint(convkey3), strtoint(convkey4));
  showmessage(decodedstring);
end; 
```

您也不应该`string`在导出的 DLL 函数中用作参数（或者实际上是返回值）。`string`它不是互操作的有效类型，因为它依赖于使用相同实现和相同内存管理器的接口两侧。`Decrypt`如果要导出接口，您需要找到一种不同的方式来定义接口。或者您可能根本不应该导出该函数。我不可能确定地知道。我的猜测是您实际上是在调用`callfunction`而不是`Decrypt`从调用代码中调用。无论如何，在当前状态下，您不能导出`Decrypt`.

还有一点要说明。当你问一个涉及模块接口的问题时，你应该总是展示接口的两面。在这里，您显示了 DLL，但没有显示调用 DLL 的代码。错误可能在那里。事实上，除了我指出的错误之外，那里可能还有一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:02:55.637

如果字符串操作代码如 exe 中所示工作，但不是来自 DLL，请检查 DLL 是否具有 delphi 内存管理器作为 FIRST 使用项。

```
uses
  ShareMem 
```

这隐含在 Dephi exe 中，但不在其 DLL 中。

这一直是 Delphi 6 DLL 和字符串最喜欢的问题，但不能说它是否仍然适用于 Delphi 7！

# sql - 新表的索引策略 - SQL Server

> ID：10262421
> 
> 赞同：1
> 
> 时间：2012-04-21T19:48:26.187
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

当我创建一个全新的数据库和/或表时，应该遵循什么索引策略。因为我不会有任何用户查询来分析或要求找到最常用的列。我的索引策略应该是什么/（哪些列应该构成集群，哪些列应该参与非集群）？在这种情况下我应该如何继续？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:03:49.313

索引当前在您的函数/存储过程中使用的列。一旦您的应用程序开始使用，您可以相应地进行调整并运行调整向导。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:17:26.470

当谈到新的开发项目与生产支持时，很难有一个绝对的答案，索引属于优先级列表。对于一个新的开发项目，在构建数据库设计、索引策略和数据访问代码上花费相同的时间是明智的。没有它，应用程序可能成为维护的噩梦，需要在生产环境中投入大量精力。在许多方面，如果数据库只是被认为是一个黑匣子，它可以在没有任何注意的情况下永远运行，那么说起来容易做起来难。如果您面临这个问题，那么有必要首先改变这种心态，并确保时间、精力和资源正确地满足数据库向前发展的需求。

对于生产应用程序，当出现性能问题时，检查索引和查询计划应该是一个高优先级。在许多方面，更改或添加索引应该是审查、分析、测试和部署的众多项目之一，而不是将索引视为解决性能问题的灵丹妙药。

索引的另一个重要考虑因素是，随着应用程序的更改，索引可能也需要更改。不要认为索引停滞不前，而是在考虑索引含义的情况下查看代码。因此，当应用程序更改时不要害怕更改、测试和部署改进的索引策略。

您可以在此处进一步阅读[http://www.mssqltips.com/sqlservertip/1452/sql-server-index-checklist/](http://www.mssqltips.com/sqlservertip/1452/sql-server-index-checklist/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T20:28:34.660

在事先不知道任何事情的情况下，您能做的最好的事情就是慷慨地应用索引。这将在很大程度上降低您的写入性能，但至少您可以很好地处理意外查询。

# sql - SQL Server：无法将显式值插入时间戳列

> ID：10262426
> 
> 赞同：69
> 
> 时间：2012-04-21T19:49:04.503
> 
> 标签：sql, sql-server-2008, insert, timestamp

使用此语句时

```
create table demo (
    ts timestamp
)

insert into demo select current_timestamp 
```

我收到以下错误：

> 无法将显式值插入时间戳列。将 INSERT 与列列表一起使用以排除时间戳列，或将 DEFAULT 插入时间戳列

如何将当前时间插入`timestamp`列？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-21T19:53:03.363

[根据 MSDN](http://msdn.microsoft.com/en-us/library/ms182776%28v=sql.90%29.aspx)，`timestamp`

> 是一种在数据库中公开自动生成的唯一二进制数的数据类型。时间戳通常用作对表行进行版本标记的机制。存储大小为 8 个字节。时间戳数据类型只是一个递增的数字，不保留日期或时间。要记录日期或时间，请使用 datetime 数据类型。

您可能正在寻找`datetime`数据类型。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-05-03T16:56:05.567

如果您需要复制完全相同的时间戳数据，请将目标表中的数据类型从时间戳更改为二进制（8）——我使用了 varbinary（8），它工作正常。

这显然会破坏目标表中的任何时间戳功能，因此请确保您首先对此表示满意。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-21T19:56:46.137

您不能将值显式插入时间戳列。它是自动生成的。不要在插入语句中使用此列。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms182776(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms182776(SQL.90).aspx)。

您可以使用日期时间而不是像这样的时间戳：

```
create table demo (
    ts datetime
)

insert into demo select current_timestamp

select ts from demo 
```

回报：

```
2014-04-04 09:20:01.153 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-04-04T14:04:31.273

## 如何使用 SQL Server 将当前时间插入时间戳：

在较新版本的 SQL Server 中，`timestamp`重命名为`RowVersion`. 没错，因为时间戳名称具有误导性。

SQL Server 的`timestamp`不是由用户设置，不代表日期或时间。时间戳仅有助于确保行在读取后没有更改。

如果要存储日期或时间，请勿使用时间戳，必须使用其他数据类型之一，例如`datetime`, `smalldatetime`, `date`,`time`或`DATETIME2`

例如：

```
create table wtf (
    id INT,
    leet timestamp
)

insert into wtf (id) values (15)

select * from wtf

15    0x00000000000007D3 
```

mssql 中的“时间戳”是某种内部数据类型。将该数字转换为 datetime 会产生一个无意义的数字。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-29T10:26:17.140

假设 Table1 和 Table2 有三列 A、B 和 TimeStamp。我想从 Table1 插入 Table2。

这会因时间戳错误而失败：

```
Insert Into Table2
Select Table1.A, Table1.B, Table1.TimeStamp From Table1 
```

这有效：

```
Insert Into Table2
Select Table1.A, Table1.B, null From Table1 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-04-13T20:27:39.563

这些答案中有一些很好的信息。假设您正在处理无法更改的数据库，并且您正在将数据从表的一个版本复制到另一个版本，或者从一个数据库中的同一个表复制到另一个。还假设有很多列，并且您需要来自所有列的数据，或者您不需要的列没有默认值。您需要编写一个包含所有列名的查询。

这是一个查询，它返回表的所有非时间戳列名称，您可以将其剪切并粘贴到插入查询中。仅供参考：189 是时间戳的类型 ID。

```
declare @TableName nvarchar(50) = 'Product';

select stuff(
    (select 
        ', ' + columns.name
    from 
        (select id from sysobjects where xtype = 'U' and name = @TableName) tables
        inner join syscolumns columns on tables.id = columns.id
    where columns.xtype <> 189
    for xml path('')), 1, 2, '') 
```

只需将顶部的表格名称从“产品”更改为您的表格名称。查询将返回列名列表：

```
ProductID, Name, ProductNumber, MakeFlag, FinishedGoodsFlag, Color, SafetyStockLevel, ReorderPoint, StandardCost, ListPrice, Size, SizeUnitMeasureCode, WeightUnitMeasureCode, Weight, DaysToManufacture, ProductLine, Class, Style, ProductSubcategoryID, ProductModelID, SellStartDate, SellEndDate, DiscontinuedDate, rowguid, ModifiedDate 
```

如果要将数据从一个数据库 (DB1) 复制到另一个数据库 (DB2)，则可以使用此查询。

```
insert DB2.dbo.Product (ProductID, Name, ProductNumber, MakeFlag, FinishedGoodsFlag, Color, SafetyStockLevel, ReorderPoint, StandardCost, ListPrice, Size, SizeUnitMeasureCode, WeightUnitMeasureCode, Weight, DaysToManufacture, ProductLine, Class, Style, ProductSubcategoryID, ProductModelID, SellStartDate, SellEndDate, DiscontinuedDate, rowguid, ModifiedDate)
select ProductID, Name, ProductNumber, MakeFlag, FinishedGoodsFlag, Color, SafetyStockLevel, ReorderPoint, StandardCost, ListPrice, Size, SizeUnitMeasureCode, WeightUnitMeasureCode, Weight, DaysToManufacture, ProductLine, Class, Style, ProductSubcategoryID, ProductModelID, SellStartDate, SellEndDate, DiscontinuedDate, rowguid, ModifiedDate 
from DB1.dbo.Product 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-02-26T19:59:40.770

创建表演示（id int，ts 时间戳）

插入 demo(id,ts) 值 (1, DEFAULT)

# php - 使用 PHP/AJAX 添加和更新数据库行

> ID：10262427
> 
> 赞同：1
> 
> 时间：2012-04-21T19:49:05.720
> 
> 标签：php, mysql, ajax

我遇到了一些奇怪的情况，我正在建立一个网站来跟踪支出，在我的网站上，您可以在我的表格中插入无限数量的“支出”或“账单”，这是使用 AJAX 完成的。

一旦插入，记录就会显示在页面上，用户可以选择更新或删除记录。

我的问题是，当插入并回发记录时，我不知道该记录在表中的 ID 是什么，因此更新功能无法正常工作。我尝试添加一个隐藏字段“随机键”，当用户插入记录时，会插入一个随机数，并且仅将其发回用于我的更新功能，我似乎无法使其正常工作。

有人知道如何最好地执行此操作吗？

谢谢

我的代码...

PHP 表单

```
 <form id='bill-upd'>
     <input type='hidden' value='".$info['rand']."' name='rand2' id='rand2'>
     <input type='hidden' value='".$info['id']."' name='billid' id='billid'>
     Total <input type='text' id='total' name='total' /><br />
     Bill name<input type='text' id='bill-name' name='bill-name' /><br />
     Bill descriptiion <input type='text' id='bill-description' name='bill-description' /><br />
     Bill colour<input type='text' id='bill-colour' name='bill-colour' />
     <input type='button' value='submit' onClick='updateBill();' />
 </form> 
```

更新 PHP 页面

```
 $uid = $_SESSION['oauth_id'];
   $id = mysql_real_escape_string($_POST['billid']);       
   $bill = mysql_real_escape_string($_POST['total']);
   $billname = mysql_real_escape_string($_POST['bill-name']);
   $billdescription = mysql_real_escape_string($_POST['bill-description']);
   $billcolour  = mysql_real_escape_string($_POST['bill-colour']);
   $rand = mysql_real_escape_string($_POST['rand2']);

        #update Record
       $query = mysql_query("UPDATE `outgoings` SET id = '$id', user_id = '$uid', bill = '$bill', bill_name = '$billname', bill_description = '$billdescription', bill_colour = '$billcolour', rand = '$rand' WHERE user_id = '$uid' AND rand = '$rand' ") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:54:30.787

在插入新记录时，从表中获取***新添加***的id（假设您对每条记录都有一个唯一的 id）并将其作为您在 ajax 调用后返回的结果的一部分返回。然后您可以使用该 id 来更新记录。

您可以使用以下脚本将要更新的详细信息发送到更新页面

```
$("#bill-upd").submit(function(e){
   e.preventDefault();

     $.post("update.php",{ 
                     billid: $("#billid").val()
                     total: $("#total").val();
                     bill-name : $("#bill-name").val();
                     bill-description :  $("#bill-description").val();
                     bill-color: $("#bill-color").val();
                     },
                     function(result){
                        //Update / Show a message to user about the action. 
                        //alert(result);   
                     });    
     });
  }); 
```

在您的 update.php 页面中，像这样更改您的查询

```
$query = mysql_query("UPDATE `outgoings` user_id = '$uid', bill = '$bill', bill_name = '$billname', bill_description = '$billdescription', bill_colour = '$billcolour', rand = '$rand' WHERE id = '$uid' AND rand = '$id' ") or die(mysql_error()); 
```

假设 ID 是表中的唯一 id / 主键，我们可以使用它来更新表记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T19:58:29.567

使用`INSERT`查询时，可以使用[mysql_insert_id()](http://php.net/manual/en/function.mysql-insert-id.php)来获取`AUTO_INCREMENT`为插入的行创建的字段的值。您可以使用 JSON 将其发回，以便 Javascript 知道您新插入的行的 ID。但是考虑如果另一个用户（使用不同的浏览器）在另一个用户打开页面时添加了一行，Javascript 将不会获取新行。例子：

**用户 1**加载页面并且看不到任何行。
**用户 1**添加第 1 行。
**用户 2**加载页面并看到第 1 行。
**用户 2**添加第 2 行，现在看到第 1,2 行
**用户 1**添加第 3 行，但只看到第 1,3 行

现在**用户 2**只会看到第 #1,2 行

您可能真的应该`SELECT * from table`在每次查询之后确保您拥有所有行（包括其他用户可能插入的行）。您还应该考虑使用[PDO](http://php.net/pdo)。

# jquery-mobile - jQueryMobile page transition functionality broken

> ID：10262435
> 
> 赞同：1
> 
> 时间：2012-04-21T19:50:06.813
> 
> 标签：jquery-mobile, transitions

I am building a cross-platform app using jQueryMobile and Phonegap. Currently using jQM 1.1.0 and Phonegap 1.6.1.

The page transition function sometimes just seems to break down when the user clicks a button or list item that links to another page in the app.

```
<a href="#page2"> 
```

This kind of link is what the whole app is made of. But depending on god knows what, sometimes when you click a link the app stalls. External links will still be followed, and buttons that don't trigger any page changing work fine. But anything with href and $.mobile.changePage seems to be broken.

This problem occurs in iPad Simulator and iPhone Simulator, not in Chrome. It seems to have something to do with the type of page transition specified (i.e. fade or slide or flip etc). Some transitions seem to cause problems, sometimes it seems to be the lack of a specified transition that is the cause, and sometimes neither of those explanations have any traction.

Before I add a whole bunch of code, I'm interested if anyone has similar experiences.

# javascript - 带有传递动态数据的jQuery表单插件

> ID：10262436
> 
> 赞同：0
> 
> 时间：2012-04-21T19:50:16.937
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用 jquery 表单插件。这是我的示例表格

```
<form id='formId' action='<?php echo $_SERVER['PHP_SELF']l?>' method='POST'>
<input type='text' name='username'/>
</form> 
```

这是我的 Javascript

```
$('#formId').ajaxForm({
    success:function(data){
       console.log(data)
    }
}) 
```

在这种情况下，我想动态传递另一个数据值而不用 HTML 实现它。例如，我想传递密码字段。有什么方法可以实现这个选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-16T12:54:09.183

老问题，但这是一个有效的代码片段。
该方法将以与“Ohgodwhy”回答相同的方式实施

```
beforeSubmit: function(formData, formObject, formOptions){        
    formData.push(
        {name: 'password',value: 'password/variable'},
        {name: 'username',value: 'username/variable'}
    );
} 
```

您需要像这样传递参数名称和参数值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-21T20:10:14.270

从此[页面](http://jquery.malsup.com/form/#options-object)，该`beforeSubmit`功能允许您挂钩提交的表单数据并注入/修改数据。

它允许 3 个参数，作为数组呈现的表单（这意味着我们可以推入它），作为 jquery 对象呈现的表单（用于序列化），以及与 ajaxForm/ajaxSubmit 一起使用的选项对象。工作示例->

```
$('#formId').ajaxForm({
  beforeSubmit: function(formData, formObject, formOptions){
    //formData is the form array. We can push the password into the array before we submit the form.
    formData.push({
      password: //this is where you put the password you want
    });
  },
  success:function(data){
   console.log(data)
  }
}); 
```

# cocoa - 如何保持 MVC ！:)

> ID：10262440
> 
> 赞同：0
> 
> 时间：2012-04-21T19:51:00.197
> 
> 标签：cocoa, model-view-controller, nsnotification

我对编码很陌生，但我不惜一切代价努力维护 MVC 设计模式！

我有一个应用程序，其中选择了一个 tableview 来推送到一个新的 tableview。plist 和字典在模型类中处理，它返回一个填充 tableview 的数组。选择一个人时，我是否将该信息发送到控制器，而不是制作某种查询来获取下一个数组，因为我相信我无法查看到模型？我听说过 NSNotification，我是否应该以某种方式进行设置，以便模型“知道”选择了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:15:24.320

从 MVC 的角度来看，所有应用程序逻辑都应该驻留在控制器本身内。现在自己决定。

你想做什么对我来说不是很清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:42:59.577

在您的情况下，将模型数据直接传递到下一个 tableview 是非常好的。在这种情况下，管理第一个 tableview 的控制器会将模型数据传递给下一个控制器（如果您使用的是导航控制器，则该控制器被推送）。从 MVC 的角度来看，这完全没问题，而且是做这类事情的一种非常常见的方式。

# iphone - 隐藏的 UITabBar 仍然裁剪任何放在它上面的 UIView

> ID：10262444
> 
> 赞同：1
> 
> 时间：2012-04-21T19:51:42.643
> 
> 标签：iphone, ios, xcode, uiview, uitabbarcontroller

当用户第一次启动我的应用程序时，我一直在尝试添加一个 UIView（带有 UIImageView）作为初始屏幕。但是，即使在我隐藏标签栏或将其框架移出屏幕后，UIView 仍然会自行裁剪，就好像标签栏仍然存在一样。

这两个代码块产生了相同的结果：

```
[appDelegate.tabBarController.tabBar setFrame:CGRectMake(0,1000,0,0)];
[self setView:InitialView]; 
```

和

```
[appDelegate.tabBarController.tabBar setHidden:YES];
[self setView:InitialView]; 
```

以下是该事件的截图：

[![在此处输入图像描述](../Images/319a52c6f329cadef6677c78b1568c85.png)](https://i.stack.imgur.com/3Ic1Q.png)

有谁知道如何解决这个问题？在过去的几个小时里，我一直对此感到困惑，我似乎对此无能为力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:57:55.793

大概您在此选项卡栏控制器中有视图的视图控制器。结果，视图控制器的视图被适当地调整大小以适合标签栏控制器的视图。为什么不直接获取标签栏的框架并通过视图的当前高度+标签栏的高度来调整视图的高度？

作为旁注，我假设`InitialView`是一个 UIView （或子类）实例。标准的面向对象编程约定用小写字母命名类的实例，然后以驼峰形式继续，如`initialView`. 仅供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:02:32.843

试试这个参考你的 App Delegate，它应该考虑到 UITabBarController。只是 UIImageView 作为子视图，完成后将其删除。您显然必须导入您的 AppDelegate。

```
AppDelegate *appDelegate = (AppDelegate*)[[UIApplication sharedApplication]delegate];

[imageView addSubview:appDelegate.window]; 
```

# c# - Combining ObservableCollection and List in a MVC application

> ID：10262446
> 
> 赞同：1
> 
> 时间：2012-04-21T19:52:01.177
> 
> 标签：c#, .net, wpf, data-binding, observablecollection

I'm trying to display a list of alarms in a WPF ListVieuw. To accomplish this I databinded the Listbox to a property containing the list of alarms. Since I use the MVC programming paradigm the property is located in the controller, and the datacontext of the view is set to that controller.

I noticed that when I added an alarm to the list, the view didn't display the new alarm. After some research I found I need to use the ObservableCollection class to do this correctly.

However, displaying the list of alarms isn't the only thing that needs to be done with it, so I can't / don't want to change the variable type of the list to ObservableCollection.

I now tried to make a property of the type ObservableCollection, but this doesn't work either. This is pretty normal, since I don't add the alarm to the property, I add it to the variable, which is still of the type List.

Is there a way to tell the property when the List is updated, or an other/better way to display my alarms and keep them easy to use for other parts of the program?

Edit:

My workaround: I trigger the `PropertyChanged` event by clearing my property FutureEvents in the eventhandler of the `PropertyChanged` event from my alarms variable.

My code: class cMain { private static volatile cMain instance; private static object syncRoot = new Object();

```
 ObservableCollection<Alarm> alarms;

    #region properties
    /// <summary>
    /// Returns the list of alarms in the model. Can't be used to add alarms, use the AddAlarm method
    /// </summary>
    public ObservableCollection<Alarm> Alarms
    {
        get
        {
            return alarms;
        }
    }

    /// <summary>
    /// Returns the ObservableCollection of future alarms in the model to be displayed by the vieuw.
    /// </summary>
    public ObservableCollection<Alarm> FutureAlarms
    {
        get
        {
            //Only show alarms in the future and alarm that recure in the future
            var fAlarms = new ObservableCollection<Alarm>(alarms.Where(a => a.DateTime > DateTime.Now || (a.EndRecurrency != null && a.EndRecurrency > DateTime.Now)));
            return fAlarms;
        }
    }

    /// <summary>
    /// Returns a desctription of the date and time of the next alarm
    /// </summary>
    public String NextAlarmDescription
    {
        get
        {
            if (alarms != null)
            {
                return alarms.Last().DateTimeDescription;
            }
            else
            {
                return null;
            }
        }
    }
    #endregion //properties

    #region public

    /// <summary>
    /// Returns the instance of the singleton
    /// </summary>
    public static cMain Instance
    {
        get
        {
            if (instance == null) //Check if an instance has been made before
            {
                lock (syncRoot) //Lock the ability to create instances, so this thread is the only thread that can excecute a constructor
                {
                    if (instance == null) //Check if another thread initialized while we locked the object class
                        instance = new cMain();
                }
            }
            return instance;
        }
    }

    /// <summary>
    /// Shows a new intance of the new alarm window
    /// </summary>
    public void NewAlarmWindow()
    {
        vNewAlarm newAlarm = new vNewAlarm();
        newAlarm.Show();
    }

    public void AddAlarm(Alarm alarm)
    {
        alarms.Add(alarm);            
    }

    public void RemoveAlarm(Alarm alarm)
    {
        alarms.Remove(alarm);
    }

    public void StoreAlarms()
    {
        mXML.StoreAlarms(new List<Alarm>(alarms));
    }

    #endregion //public

    #region private

    //Constructor is private because cMain is a singleton
    private cMain()
    {
        alarms = new ObservableCollection<Alarm>(mXML.GetAlarms());
        alarms.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(alarms_CollectionChanged);
    }

    private void alarms_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        FutureAlarms.Clear(); //Needed to trigger the CollectionChanged event of FutureAlarms
        StoreAlarms();
    }

    #endregion //private
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T13:14:43.673

将属性添加到警报

```
public bool Future 
{   get return (DateTime > DateTime.Now 
            || (EndRecurrency != null && EndRecurrency > DateTime.Now));  
} 
```

当更新警报时，为所有（或适当的子集）在 Future 上调用 NotifyPropertyChanged。

然后使用 DataTrigger 或 CollectionViewSource 过滤器将其隐藏

```
<DataTrigger Binding="{Binding Path=Future, Mode=OneWay}" Value="False">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger> 
```

过滤或隐藏是一种表示级别，因此它应该为业务和数据层留下警报类和警报集合。

由于 ObservableCollection 实现 iList 应该是兼容的。

对于您当前的模型，FurtureAlarms 也可能是一个列表。可以缩短语法

```
 (alarms.Where(a => a.DateTime > DateTime.Now || (a.EndRecurrency != null && a.EndRecurrency > DateTime.Now))).toList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T19:59:34.983

WPF 对接口的[`PropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.propertychanged.aspx)事件做出反应`INotifyPropertyChanged`，因此您应该实现此接口并在您更改模型中的属性时引发事件。如果你这样做，你根本不需要使用`ObservableCollection<T>`。但是请注意，如果您的属性是 a`List`并且您所做的唯一事情是添加或删除项目，WPF 仍然会认为它是同一个列表并且什么也不做。因此，在引发`PropertyChanged`事件之前，您需要将属性设置为列表的新实例，这很容易完成，如下所示：

```
MyList.add(newItem);
MyList = new List<something>(MyList);
#raise the event 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:14:24.413

不要在每次获取时使用未来警报重新创建 ObservableCollection，而是尝试在列表更改时直接更新集合：

```
public ObservableCollection<Alarm> FutureAlarms { get; private set;} // initialize in constructor

private void UpdateFutureAlarms() {
    fAlarms.Clear();
    fAlarms.AddRange(
        alarms.Where(
            a => a.DateTime > DateTime.Now 
                || (a.EndRecurrency != null && a.EndRecurrency > DateTime.Now)
        )
    )
}

//... somewhere else in the code... 

public void Foo () {
    // change the list
    alarms.Add(someAlarm);
    UpdateFutureAlarms();
} 
```

`List`如果在更改时触发了事件，您还可以将 UpdateFutureAlarms 注册为事件处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T20:17:50.717

你最好从它派生出你自己的类`ObservableCollection<T>`并使用它，而不是像你那样尝试将两个现有的类封装在一个组合中。至于为什么：

*   首先，它会少很多痛苦，因为`ObservableCollection<T>`已经实现了所有`List<T>`支持的接口，所以你只需要直接实现你实际需要的方法`List<T>`，WPF数据绑定就可以工作；
*   其次，唯一现实的另一种选择，该`INotifyPropertyChanged`方法实施起来很麻烦（您将有效地重写`ObservableCollection<T>`），或者如果您在每次更改后将它们替换为新的集合以更新绑定，则会导致更大的集合性能不佳。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-22T22:04:39.117

在 WPF 中，正确地绑定到集合需要绑定到的集合实现 INotifyCollectionChanged，该集合具有 CollectionChanged 事件，每当从集合中添加或删除项目时都应触发该事件。

因此，建议您使用`<T>`已经为您实现该接口的 ObservableCollection 类。关于您使用的 List`<T>`变量，我认为最好将它们切换到接口类型 IList `<T>`，而不是由 ObservableCollection 实现，并且作为额外的好处，不需要 ObservableCollection 通知的应用程序部分不需要添加其他引用或了解 Observable 集合。

# user-interface - 如何添加数字和字母 - python（字母也是数字）

> ID：10262447
> 
> 赞同：0
> 
> 时间：2012-04-21T19:52:05.717
> 
> 标签：user-interface, python-idle

```
 print("How old are you")

        c = input()

        d = 1 
```

问题是 - 如何将 d + c 加在一起

或者如何将 1 + c 加在一起

我只是一个初学者，我已经做了几个小时了，真的很困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:58:30.893

如果您的意思是 c 是输入数字，则使用将其转换为整数`int(c)`

所以你有了`d + int(c)`

# python - Django admin page missing styling when deployed on Apache

> ID：10262450
> 
> 赞同：1
> 
> 时间：2012-04-21T19:52:31.010
> 
> 标签：python, django, apache

I deployed my Django project on Apache but when I navigate to the admin page, it doesn't seem to have the same formatting as the test server that is included with Django. I have tinkered around with the configurations and soft links quite a bit but have had no success thus far. I'm hoping that someone more experienced than me in Django and Apache can spot check my issue and diagnose the problem. Find below the steps I took while installing Django as well as the contents of the configuration files.

installation process

```
svn co http://code.djangoproject.com/svn/django/trunk/ /usr/share/django
chown -R www-data:www-data /usr/share/django
ln -s /usr/share/django/django /usr/lib/python2.6/dist-packages/django
ln -s /usr/share/django/django/bin/django-admin.py /usr/local/bin/django-admin.py
mkdir /var/www/mydjango/django_projects
mkdir /var/www/mydjango/django_templates
mkdir /var/www/mydjango/media
ln -s /usr/share/django/django/contrib/admin/media /var/www/mydjango/admin_media
django-admin.py startproject /var/www/mydjango/django_projects/mydjango
/var/www/mydjango/django_projects/mydjango/manage.py collectstatic --noinput
(I've added the static files generated to 
/usr/share/django/django/contrib/admin/media since it was empty) 
```

settings.py

```
MEDIA_ROOT = '/var/www/mydjango/media/admin/' 
(I've also tried '/var/www/mydjango/media/')
MEDIA_URL = 'http://mydjango.mydomain.com/media/admin/'
STATIC_ROOT = ''
STATIC_URL = '/static/' 
```

http.conf

```
Alias /admin_media/ /var/www/mydjango/admin_media/
Alias /media/ /var/www/mydjango/media/

<Directory "/admin_media/">
Order deny,allow
Allow from all
</Directory>

<Directory "/media/">
Order deny,allow
Allow from all
</Directory>

WSGIScriptAlias / /var/www/apache/django.wsgi
<Directory /var/www/apache/>
Order deny,allow
Allow from all
</Directory> 
```

django.wsgi

```
import os
import sys

path = '/var/www/mydjango/django_projects/mydjango'
if path not in sys.path:
    sys.path.append(path)

os.environ['DJANGO_SETTINGS_MODULE'] = 'mydjango.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T06:47:40.423

Moderna Django 版本不在 MEDIA_URL 中查找管理内容。使用[collectstatic](https://docs.djangoproject.com/en/1.4/ref/contrib/staticfiles/)。

# mysql - 当另一个表中没有行时如何从 MySQL 中选择一行

> ID：10262457
> 
> 赞同：2
> 
> 时间：2012-04-21T19:53:25.783
> 
> 标签：mysql

仅当另一个表中没有用户和站点的数据时，我才尝试从一个表中选择数据。

这就是我到目前为止所拥有的。

```
SELECT 
    l.link_id,
    l.link_name,
    l.link_points,
    l.link_time,
    COUNT(uc.user_id) AS clicks
FROM 
    links AS l LEFT OUTER JOIN
    (SELECT user_id, site_id FROM user_clicks WHERE site_id = l.link_id AND user_id = ".$user['user_id'].") as uc
    USING (link_id)
GROUP BY
    l.link_id 
```

这是我目前的尝试，但是当我试图在外部连接中提取数据时，我得到“'where 子句'中的未知列'l.link_id'”。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:08:46.913

这应该工作：

```
SELECT 
    l.link_id,
    l.link_name,
    l.link_points,
    l.link_time,
    COUNT(uc.user_id) AS clicks
FROM 
    links AS l LEFT JOIN
    user_clicks uc ON uc.site_id = l.link_id 
WHERE user_id = ".$user['user_id']."
    AND uc.site_id IS NULL
GROUP BY
    l.link_id 
```

LEFT JOIN 从表中选择所有内容，`links`并使用您确保在另一个表中没有行`uc.site_id IS NULL`的子句。`WHERE`实际上，您在那里命名哪一列并不重要，只要它来自`user_clicks`

# android - Android esclipe

> ID：10262459
> 
> 赞同：0
> 
> 时间：2012-04-21T19:53:36.607
> 
> 标签：android

I have installed sdk, esclipe and avd . Every thing working . But when i select window link and then preference for giving sdk location . Nothing happen there . I give full path where sdk unzipped . I also give sdk tool path but also nothing happen there .I am failed to enable sdk path button ok . I also set path in environment variable but nothing is the result .I am using window xp service pack 3 . Can any one help me . Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:00:58.583

也许你提供的路径很早就结束了。例如，`c:\Program Files\Android`还不够。你需要 tp 供应`c:\Program Files\Android\android-sdk`。

# c# - NHibernate 查询相关表中的列

> ID：10262461
> 
> 赞同：0
> 
> 时间：2012-04-21T19:53:38.590
> 
> 标签：c#, nhibernate

我有 2 节课，`Log`并且`UserProfile`. `Log`对 有零个或一个引用`UserProfile`。

我正在尝试实现一个过滤器来搜索我的日志。目前它看起来像这样：

```
 /// <summary>
    /// Searches the logs for matching records
    /// </summary>
    /// <param name="fromUTC">Start point timestamp of the search</param>
    /// <param name="toUTC">End point timestamp of the search</param>
    /// <param name="ofSeverity">Severity level of the log entry</param>
    /// <param name="orHigher">Retrieve more severe log entries as well that match</param>
    /// <param name="sourceStartsWith">The source field starts with these characters</param>
    /// <param name="usernameStartsWith">The username field starts with these characters</param>
    /// <param name="maxRecords">The maximum number of records to return</param>
    /// <returns>A list of Log objects with attached UserProfile objects</returns>
    public IEnumerable<Log> SearchLogs(
        DateTime fromUTC,
        DateTime toUTC,
        string ofSeverity,
        bool orHigher,
        string sourceStartsWith,
        string usernameStartsWith,
        int maxRecords)
    {
        ofSeverity = ofSeverity ?? "INFO";

        var query = DetachedCriteria.For<Log>()
            .SetFetchMode("UserProfile", NHibernate.FetchMode.Eager)
            .Add(Restrictions.In("Severity", (orHigher ?
                Translator.SeverityOrHigher(ofSeverity) : Translator.Severity(ofSeverity)).ToArray()))
            .Add(Restrictions.Between("TimeStamp", fromUTC, toUTC))
            .AddOrder(Order.Desc("TimeStamp"))
            .SetMaxResults(maxRecords);

        if ((sourceStartsWith ?? string.Empty).Length > 0)
        {
            query
                .Add(Restrictions.InsensitiveLike("Source", sourceStartsWith, MatchMode.Start));
        }

        if ((usernameStartsWith ?? string.Empty).Length > 0)
        {
            query
                .Add(Restrictions.InsensitiveLike("UserProfile.UserName",
                    usernameStartsWith, MatchMode.Start));
        }

        return query.GetExecutableCriteria(_Session).List<Log>();
    } 
```

...只要我不指定`usernameStartsWith`值，它就可以正常工作。

如果我确实指定了一个`usernameStartsWith`值，我会得到一个可爱的黄色死亡屏幕，上面写着：

```
could not resolve property: UserProfile.UserName of: C3.DataModel.Log 
```

我已经尝试了所有我能想到的排列来让它工作，但我做不到。有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:17:44.587

我知道您说过您已经尝试了一些事情，但是您是否尝试过使用调用`CreateCriteria`而不是加入 UserProfiles `SetFetchMode`？也许是这样的：

```
 if ((usernameStartsWith ?? string.Empty).Length > 0)
    {
        query.CreateCriteria("UserProfile")
             .Add(Restrictions.InsensitiveLike("UserName",
                usernameStartsWith, MatchMode.Start));
    } 
```

# c# - Displaying time on a website from SQL

> ID：10262463
> 
> 赞同：0
> 
> 时间：2012-04-21T19:53:50.803
> 
> 标签：c#, sql, asp.net-mvc, datetime

I just can't seem to find an answer for this hence the post. I want the time stored in the SQL database to be displayed on my website to be the exact time that is in the database. Currently, this is not the case. The time being displayed is being converted to the browsing computers local time. Since the time being saved is an appointment time, regardless of where or what time zone the browsing computer is in, having it converted makes no sense. I thought that the methods TimeZone and TimeZoneInfo were used to convert the time to local time, but this seems to be happening automatically. How do I get the exact time saved to be the time displayed on my site?

The SQL database fields ETAStart and ETAEnd are defined as datetime.

Updates to the database are handled in the controller as such:

```
if (TryUpdateModel(model)) {

    System.DateTime ETAEnd = Convert.ToDateTime(model.ETAStart).AddHours(3);

    model.ETAEnd = ETAEnd;
    model.UpdatedBy = CurrentUser();

    model.UpdateDate = Convert.ToDateTime(DateTime.Now.ToString("U"));

    dc.SubmitChanges();

    return View(new GridModel<ManifestMasterModel> { Data = GetMMList(0) });

} else {
    return View();
} 
```

Thank you in advance and I am very appreciative to all who respond.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:28:05.017

您是否尝试使用以下方式将日期时间存储为 UTC：

```
model.UpdateDate = Convert.ToDateTime(DateTime.Now.ToString("U")); 
```

您可以像这样使用它来不进行转换：

```
model.UpdateDate = DateTime.Now.ToUniversalTime(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:05:44.123

您是否检查了服务器上设置的时区？几天前发生在我身上，结果托管服务器有不同的时区。

以下是检查方法：

```
Response.Write(TimeZoneInfo.Local.DisplayName) 
```

编辑1：

您可以使用 Utc 时间将其转换为您想要的时区。看：

```
TimeZoneInfo.ConvertTimeFromUtc(DateTime.UtcNow, TimeZoneInfo.FindSystemTimeZoneById("Central Standard Time")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T00:42:28.823

我不完全确定我理解问题所在，但在我看来，您需要实现自定义模型绑定器。

这些资源可能会帮助您：

[时区策略](https://stackoverflow.com/questions/8797597/timezone-strategy)

[Asp.net MVC 中的自定义 DateTime 模型绑定器](https://stackoverflow.com/questions/2356601/custom-datetime-model-binder-in-asp-net-mvc)

[http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx](http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx)

虽然，我认为仅使用字符串的快速修复建议没有任何问题（我认为您会帮自己一个忙）。听起来您正试图让客户端和 MVC 忽略处理日期的时区影响，这可能需要更多的工作并且比仅使用字符串方法更不干净。您仍然可以在数据库中有一个 DateTime，只需提取用户提交的字符串值并使用适当的时区将其解析为日期时间。

# jquery - jQuery 将文本转换为输入字段

> ID：10262466
> 
> 赞同：1
> 
> 时间：2012-04-21T19:54:17.093
> 
> 标签：jquery

在我的页面上，我有几个如下所示的标签：

```
<parameter name="address" class="transform">@ViewBag.Address</parameter> 
```

为此，我创建了这个函数：

```
 function transform(id) {
     $('#' + id + ' .transform').each(function (index) {
         var tag = $(this).parent().html();
         $(this).parent().html() = tag.replace('parameter','input type="text"');
     });
 } 
```

现在，如果我提醒 $(this).parent().html() 我得到原始标签，但该功能不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T19:57:56.577

试试这个（给html函数一个参数，可能是问题的原因

```
function transform(id) {
 $('#' + id + ' .transform').each(function (index) {
     var tag = $(this).parent().html();
     $(this).parent().html( tag.replace('parameter','input type="text"') );
 });
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:22:30.840

您接受的答案对我不起作用，所以我创建了这个**[jsFiddle 示例](http://jsfiddle.net/j08691/f68qA/)**。

jQuery：

```
function transform(id) {
    $('#' + id + ' .transform').each(function(index) {
        $(this).replaceWith($('<input value="' + $(this).html() + '" type="text" name="address" class="transform" />'));
    });
} 
```

这会将参数标签转换为输入元素，并将 @ViewBag.Address 文本作为每个输入的默认值。

# iphone - 如果您的网站不支持 Retina，iPhone 4+ 显示的图像大小是 2 倍吗？

> ID：10262473
> 
> 赞同：0
> 
> 时间：2012-04-21T19:55:20.803
> 
> 标签：iphone, html, css, image

我刚刚开始阅读有关 iphone 4+ 上的 Retina Display 的信息，我想知道如果您没有 imagefilename@2x.extension，现在所有这些 iphone4+ 是否在网页上显示的图像是正常大小的 2 倍？！

如果我必须编写所有额外的代码（如媒体查询）并在每个背景图像后添加@2x，这将是一个巨大的头痛......

如果是这样，您最快的解决方案是什么？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T19:58:49.867

文件名与您的网站无关。您可以随意命名您的图像文件。'@2x' 只是许多用于视网膜网络图像的非正式标准。如果您想使用视网膜图像，您可以使用媒体查询通过 CSS 将图像换成更高分辨率的版本。

[http://benfrain.com/how-to-serve-high-resolution-website-images-for-retina-displays-new-ipadiphone4/](http://benfrain.com/how-to-serve-high-resolution-website-images-for-retina-displays-new-ipadiphone4/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T20:55:47.733

Mobile Safari 将其解释`px`为点，因此您无需为您的应用程序在视网膜设备上运行做任何事情。

但是，如果您想提供高分辨率图像，请将其包装在 CSS 媒体查询中：

```
@media all and (-webkit-device-pixel-ratio:2) {
    #id {
        background-image: url(background@2x.png);
        background-size: 100% 100%;
    }
} 
```

# c# - C# 链委托和“未知”签名

> ID：10262477
> 
> 赞同：0
> 
> 时间：2012-04-21T19:56:00.897
> 
> 标签：c#, delegates, method-chaining

我想做以下事情：

```
private static Dictionary<string, Delegate> handlers = new Dictionary<string, Delegate>();
private static void RecievedMessage(object sender, RecievedMessageEventArgs e) {
  if(e == null  || e.Message == null) return;

  if(e.Message is RegisterMethodMessage) {
    var registerMethodMsg = (RegisterMethodMessage)e.Message;
    if(handlers.ContainsKey(registerMethodMsg.MethodName)) {
      handlers[registerMethodMsg.MethodName] += registerMethodMsg.Handler; //Error
    } else {
      handlers.Add(registerMethodMsg.MethodName, registerMethodMsg.Handler);
    }
  }
} 
```

在字典中使用相同键添加到链中的委托将具有相同的方法签名。
如果我将“委托”替换为特定的操作，例如操作，上面的代码就可以工作。

所以我的问题是：
是否可以在没有替换且没有大量“黑客攻击”的情况下做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:03:22.420

有什么理由你不能这样做：

```
handlers[registerMethodMsg.MethodName] =
    Delegate.Combine(
        handlers[registerMethodMsg.MethodName],
        registerMethodMsg.Handler); 
```

# javascript - 如何获得 Facebook 用户访问令牌过期的通知

> ID：10262487
> 
> 赞同：3
> 
> 时间：2012-04-21T19:58:01.817
> 
> 标签：javascript, facebook-graph-api

我已经看过很多示例，并且阅读了一些文章以深入了解访问令牌过期，并且在这篇文章[Access Token Expiration](https://developers.facebook.com/docs/authentication/access-token-expiration/)中对此进行了很好的解释。

我知道如何更新过期访问令牌。但是，问题在于，如文章中所述，可能有 4 个原因导致 access token 过期。

因此，无法确定访问令牌何时到期，并且可以随时到期。传统的解决方案是使用将很快被 FB 弃用的 offline_permision。

这是我想要实现的目标：

1.  一旦访问令牌过期，当用户使用我们的 Facebook 应用程序时，我希望 FB 通知我。

2.  收到通知后，更新访问令牌。

我不认为以下实现了我想要的。

```
FB.Event.subscribe('auth.authResponseChange', function(response) {
     alert('The status of the session is: ' + response.status);
}); 
```

因此，当访问令牌过期时，有什么方法可以从 FB 获得通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T23:19:59.810

当您尝试使用过期令牌访问 API 时，Facebook 将发回一条错误消息。您只需在处理 Facebook 响应的回调函数中检查该错误，如果存在错误，请刷新令牌并再次尝试 API 调用。

来自脸书：

> Facebook**不会通知您之前发布的访问令牌已失效**。除非您将过期时间与访问令牌一起传递给您的应用程序，否则您的应用程序通常会在您尝试向 API 发出请求时首先知道给定令牌已失效。

# c# - 在 C# 和 JavaScript 之间传递元素

> ID：10262491
> 
> 赞同：4
> 
> 时间：2012-04-21T19:58:30.147
> 
> 标签：c#, .net, webkit, webbrowser-control, webkit.net

我正在为 .NET 替换 .NET `WebBrowser`，`WebKit.NET`而我一直在使用的功能之一是`WebBrowser`我无法弄清楚如何在我正在编写的包装器中实现`WebKit`的功能是传递 DOM JavaScript 和 C# 代码之间的元素。

在 a 中`WebBrowser`，您只需调用[`InvokeScript`](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.invokescript.aspx)并传递 an 的[`DomElement`](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmlelement.domelement.aspx)属性`HtmlElement`作为参数，JavaScript 函数就会获取该元素。同样，您可以将一个元素从 JavaScript 传递给 C#，然后 C# 代码将获得一个`DomElement`对象。

据`WebKit`我所知，我不能这样做。该`InvokeStriptMethod`方法已损坏，但`StringByEvaluatingJavaScriptFromString`不是，这让我可以将脚本注入当前文档并在以后随时调用它们。

请注意，这些文档不会是我自己创建的文档，所以我不能做诸如为每个元素分配 ID 之类的事情。这是一个网络爬虫，我需要尽可能避免弄乱文档的元素。

一种可能可行的技巧是为元素分配一个临时 ID 并备份旧 ID，然后我可以`GetElementById`从 JavaScript 或 C# 调用以获取元素，然后重新分配旧元素的 ID。问题是`GetAttribute('id')`当 ID 为 时，WebKit 会给我一个空字符串`undefined`，所以我的 C# 代码无法知道 ID 是空字符串还是`undefined`，谁知道，当前网页的脚本可能依赖于 ID出于某种原因`undefined`，因此将 ID 设置为空字符串可能会弄乱他们的 javascript。

任何人都有更好的主意或者`WebKit`我可以使用其他任何方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T19:44:30.320

您可以使用此库[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js) 并使用此代码

```
var json_text = JSON.stringify(your_object, null, 2); 
```

您的对象现在是一个字符串，您可以这样做以使您的字符串成为一个对象

```
var your_object = JSON.parse(json_text); 
```

你可以将你的字符串从 javascript 传递给 c sharp。

在 csharp 你可以使用 fastjason 和

```
var o = fastJSON.JSON.Instance.ToObject<List<Retclass>>(s); // return a generic list 
```

和

```
string str = fastJSON.JSON.Instance.ToJSON(obj, 
                 new fastJSON.JSONParamters { EnableAnonymousTypes = true }); // using the parameters 
```

您可以使用 JSON 来做到这一点

> JSON（JavaScript Object Notation）是一种轻量级的数据交换格式。人类很容易阅读和写作。机器很容易解析和生成。它基于 JavaScript 编程语言标准 ECMA-262 第 3 版 - 1999 年 12 月的一个子集。JSON 是一种完全独立于语言的文本格式，但使用 C 系列语言的程序员熟悉的约定，包括 C 、C++、C#、Java、JavaScript、Perl、Python 等等。这些属性使 JSON 成为一种理想的数据交换语言。

[http://www.json.org/](http://www.json.org/)

[http://www.codeproject.com/Articles/159450/fastJSON](http://www.codeproject.com/Articles/159450/fastJSON)

# javascript - 骨干模型 .toJSON() 不会将所有属性呈现为 JSON

> ID：10262498
> 
> 赞同：10
> 
> 时间：2012-04-21T19:59:08.620
> 
> 标签：javascript, backbone.js

我需要将模型的属性呈现为 JSON，以便可以将它们传递到模板中。下面是视图的 render() 函数的样子：

```
render: function() {
  console.log(this.model);
  console.log(this.model.toJSON());
  $(this.el).html(this.template(this.model.toJSON()));
  return this;
}, 
```

这是执行 console.log(this.model) 后的属性输出：

```
created_at: "2012-04-19"
id: "29"
name: "item"
resource_uri: "/api/v1/item/29/"
updated_at: "2012-04-21"
user: "/api/v1/user/9/" 
```

这是执行 console.log(this.model.toJSON()) 后模型的 JSON 输出：

```
id: "29"
__proto__: Object 
```

发生了什么？

编辑：这是实例化：

```
 var goal = new Goal({id: id});
  goal.fetch();
  var goalFullView = new GoalFullView({
    model: goal,
  }); 
```

以下是新视图的内容：

```
 console.log(this.model.attributes);
  console.log(this.model.toJSON()); 
```

这是控制台所说的：

```
Object
created_at: "2012-04-23"
id: "32"
name: "test"
resource_uri: "/api/v1/goal/32/"
updated_at: "2012-04-23"
user: "/api/v1/user/9/"
__proto__: Object

Object
id: "32"
name: "test"
__proto__: Object 
```

如果 toJSON 应该克隆属性，为什么它不复制正确的名称或为什么不复制 created_at、updated_at 字段？

编辑2：这是模型：

```
 var Goal = Backbone.Model.extend({

    // Default attributes for Goal
    defaults: {
      name: "empty goal",
    },

    // Check that the user entered a goal
    validate: function(attrs) {
      if (!attrs.name) {
        return "name is blank";
      }
    },

    // Do HTTP requests on this endpoint
    url: function() {
      if (this.isNew()) {
        return API_URL + "goal/" + this.get("id") + FORMAT_JSON;
      }
      return API_URL + "goal/" + FORMAT_JSON;
      //API_URL + "goal" + FORMAT_JSON, 
    },
  }); 
```

编辑 3：我发现我需要使用 fetch 中的成功回调来呈现使用模型的视图：

目标.fetch（{成功：函数（模型）{ var goalFullView = new GoalFullView（{模型：目标，}）；}}）；

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-21T22:29:33.193

该方法只返回模型属性`toJSON()`的浅层克隆。`attributes`

来自带[注释的 Backbone.js 源代码](http://documentcloud.github.com/backbone/docs/backbone.html#section-36)：

```
toJSON: function(options) {
  return _.clone(this.attributes);
} 
```

在没有看到更多代码的情况下，看起来您直接在模型对象上设置属性，而不是使用`set`函数来设置模型属性。

即不要这样做：

```
model.name = "item"; 
```

做这个：

```
model.set("name", "item"); 
```

编辑：

对于您的特定问题，您可能在模型完成从服务器加载之前调用了 toJSON。

例如，这并不总是按预期工作：

```
var model = new Goal({id: 123});
model.fetch();
console.log(model.toJSON()); 
```

但这将：

```
var model = new Goal({id: 123});
model.fetch({
  success: function() {
    console.log(model.toJSON());
  }
}); 
```

# c# - C# ASP.NET (VS 2008 Exp) 数据库将来自 UPDATE 的希伯来语值保存为“？”

> ID：10262503
> 
> 赞同：0
> 
> 时间：2012-04-21T19:59:24.470
> 
> 标签：c#, sql, character-encoding

由于我还没有找到我之前的问题（[链接](https://stackoverflow.com/questions/10253053/c-sharp-asp-net-vs-2008-db-ignores-insert-if-it-contains-hebrew-characters "这里")）的解决方案，我发布了一个新问题，希望有一个解决方案。如果我违反了规则，我很抱歉，但我还没有收到解决方案。

当我尝试更新一行时，我已经跟踪了发送的查询，例如：

```
UPDATE global_status SET title = 'Login_Failure', info = 'שדכ' WHERE id = '2' 
```

所以你可以看到发送的最终查询是希伯来语的，所以在此之前它不是问题。我这样执行它：

```
string Status_Update = "UPDATE global_status SET title = '" + Title + "', info = '" + Info + "' WHERE id = '" + Request.Form["Status_Key"] + "'";

MyAdoHelper.DoQuery(GlobalVar.DatabaseName, Status_Update); 
```

方法：

```
public static void DoQuery(string fileName, string sql)
{
    SqlConnection conn = ConnectToDb(fileName);
    conn.Open();
    SqlCommand com = new SqlCommand(sql, conn);
    com.ExecuteNonQuery();
    com.Dispose();
    conn.Close();
} 
```

更新后，数据库包含??? 我插入希伯来字母的地方。

我可以手动将希伯来语值插入数据库，也可以将它们取回。

我有另一种形式（注册），我可以在其中插入希伯来语值，使用 DoQuery();

这是更新页面的源代码（它正在更新记录的标题和信息，没什么特别的）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;

public partial class admin_EditGlobalStatus : System.Web.UI.Page
{
    public string StatusesTable;
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Request.Form["Status_Update"] != null)
        {
            string Title = Request.Form["Status_Title"].Secure();
            string Info = Request.Form["Status_Info"].Secure();

            Info = Info.Replace("/s", "<span class\"res\">").Replace("/e", "</span>");

            string Status_Update = "UPDATE global_status SET title = '" + Title + "', info = '" + Info + "' WHERE id = '" + Request.Form["Status_Key"] + "'";

            MyAdoHelper.DoQuery(GlobalVar.DatabaseName, Status_Update);
        }

        if (Request.Form["Status_Delete"] != null)
        {
            string Status_Delete = "DELETE FROM global_status WHERE id = '" + Request.Form["Status_Key"] + "'";
            MyAdoHelper.DoQuery(GlobalVar.DatabaseName, Status_Delete);
        }

        string GetGlobalStatuses = "SELECT * FROM global_status";
        DataTable dt = MyAdoHelper.ExecuteDataTable(GlobalVar.DatabaseName, GetGlobalStatuses);

        if (dt.Rows.Count > 0)
        {
            StatusesTable = "<table cellspacing=\"15\">";

            StatusesTable += "<th>כותרת ההודעה</th><th>מידע ההודעה</th>";

            foreach (DataRow status in dt.Rows)
            {
                StatusesTable += "<tr><form method=\"post\" action=\"\">";

                StatusesTable += "<input type=\"hidden\" name=\"Status_Key\" value=\"" + status["id"].ToString() + "\" />";
                StatusesTable += "<td><input size=\"25\" dir=\"ltr\" type=\"text\" name=\"Status_Title\" value=\"" + status["title"].ToString() + "\" /></td>";
                StatusesTable += "<td><input size=\"90\" type=\"text\" name=\"Status_Info\" value=\"" + status["info"].ToString().Secure() + "\" /></td>";

                StatusesTable += "<td><input type=\"submit\" name=\"Status_Update\" value=\"עדכן\"><input type=\"submit\" name=\"Status_Delete\" value=\"מחק\"></td></form></tr>\r\n";
            }

            StatusesTable += "</table>";
        }
        else
        {
            StatusesTable = "<h1>אין משתמשים קיימים</h1>";
        }
    }
} 
```

希望有解决办法，谢谢！

盖伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:20:56.147

在阅读了几篇文字解释后，我发现很多人都能够像这样解决字符串开头 N 的问题

```
 string Status_Update = "UPDATE global_status SET  title = '" +
 Title + "', info =N'" + Info + "'  WHERE id = '" +
 Request.Form["Status_Key"] + "'"; 
```

还要确保尝试 nvarchar 或 unicode

# java - 为什么在计算器类完成后这段代码不允许我输入命令？

> ID：10262505
> 
> 赞同：0
> 
> 时间：2012-04-21T19:59:32.657
> 
> 标签：java

我正在尝试制作一个简单的基于文本的操作系统，但我无法弄清楚为什么我的代码在计算器类完成后不允许我输入命令。它应该继续执行代码，直到我输入“off”，但事实并非如此。Eclipse 说它正在运行，但我无能为力。有人可以帮帮我吗？

这是我的两门课：

```
public class Calculator extends Start{

public static void calStrt() {

    System.out.print("\nEnter operator you wish to use: ");
    StringInput = scan.nextLine();

    if (StringInput.equals("+")) {

        add();

    } else if (StringInput.equals("-")) {

        sub();

    } else if (StringInput.equals("*")) {

        mul();

    } else if (StringInput.equals("/")) {

        div();

    } else {

        System.out.println("\nSyntax error: Operator not recognized");
        System.out.println("Please try again");
        calStrt();

    }

}

public static void add() {

    System.out.print("\nEnter first number: ");
    intInput = scan.nextInt();
    int intVar1 = intInput;

    System.out.print("\nEnter second number: ");
    intInput = scan.nextInt();
    int intVar2 = intInput;

    System.out.println("\nAnswer: " + (intVar1 + intVar2));

}

public static void sub() {

    System.out.print("\nEnter first number: ");
    intInput = scan.nextInt();
    int intVar1 = intInput;

    System.out.print("\nEnter second number: ");
    intInput = scan.nextInt();
    int intVar2 = intInput;

    System.out.println("\nAnswer: " + (intVar1 - intVar2));

}

public static void mul() {

    System.out.print("\nEnter first number: ");
    intInput = scan.nextInt();
    int intVar1 = intInput;

    System.out.print("\nEnter second number: ");
    intInput = scan.nextInt();
    int intVar2 = intInput;

    System.out.println("\nAnswer: " + (intVar1 * intVar2));

}

public static void div() {

    System.out.print("\nEnter first number: ");
    intInput = scan.nextInt();
    int intVar1 = intInput;

    System.out.print("\nEnter second number: ");
    intInput = scan.nextInt();
    int intVar2 = intInput;

    System.out.println("\nAnswer: " + (intVar1 / intVar2));

}

}

import java.util.Scanner;

class Start {

static Scanner scan = new Scanner(System.in);
static String StringInput;
static int intInput;

public static void main(String[] args) {

    System.out.println("\nWelcome to RobOS");

    passLoop: while (true) {

        System.out.print("\nPlease enter password: ");
        StringInput = scan.nextLine();

        if (StringInput.equals("banana")) {

            System.out.print("Logging in, please wait");
            System.out.print(".");
            System.out.print(".");
            System.out.println(".");

            System.out.println("\nWelcome User");

            outerLoop: while (true) {

                System.out.println("\nType \"help\" to see a list of programs");

                StringInput = scan.nextLine();  

                innerLoop: while (true) {

                    if (StringInput.equalsIgnoreCase("cal")) {

                        Calculator.calStrt();
                        continue outerLoop;

                    } else if (StringInput.equalsIgnoreCase("guess")) {

                        GuessGame.guess();
                        continue outerLoop;

                    } else if (StringInput.equalsIgnoreCase("help")) {

                        System.out.println("\n\"cal\" uses the calculator");
                        System.out.println("\"guess\" plays guessing game");
                        System.out.println("\"help\" shows list of programs");
                        System.out.println("\"off\" turns RobOS off");
                        continue outerLoop;

                    } else if (StringInput.equalsIgnoreCase("off")){

                        break passLoop;

                    } 

                }

            }

        } else { 

            System.out.println("\nWrong password. Please try again");
            continue passLoop;

        }

    }

}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T07:40:39.957

布伦特纳什是正确的。但是，要修复错误，请尝试使用而不是`scan.nextInt()`：`Integer.parseInt(scan.nextLine());` 希望这有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:20:26.343

您的代码进入无限循环。当你打电话`StringInput = scan.nextLine()`时，第一次它工作正常。我输入了`cal`，我可以运行一次计算器。问题是第二次`scan.nextLine()`被调用时，它会自动返回一个空字符串 "" 作为`StringInput`. 您的`if/else`语句集`while(true)`无法处理此问题，因此它只会永远循环。

更深层的原因是您调用`scan.nextInt()`读取数字，但问题是当您读取第二个数字以进行计算器操作时，仍然有一个“\n” `System.in`。结果，当您循环并`scan.nextLine()`再次调用时，它不会提示您进行任何操作，因为它只是读取仍然坐在上面的“\n”，`System.in`然后将您送入无限循环。

# memory-management - 在 Linux 中插入模块时出错 -- 1 无法分配内存

> ID：10262510
> 
> 赞同：3
> 
> 时间：2012-04-21T19:59:47.960
> 
> 标签：memory-management, filesystems, linux-kernel

eCryptfs 是一个符合 POSIX 的加密文件系统，自 2.6.19 版以来一直是主线 Linux 内核的一部分。

当我尝试插入模块 (ecryptfs.ko) 时，我收到以下错误：

> insmod：插入“ecryptfs.ko”时出错：-1 无法分配内存

有人可以帮我吗？

下面是`dmesg`

```
Failed to allocate one or more kmem_cache objects

kmem_cache_create: duplicate cache ecryptfs_auth_tok_list_item

Pid: 3332, comm: insmod Tainted: G           O 3.2.2+ #1

Call Trace:

[<c102bfe0>] ? printk+0x15/0x17

[<c10878b6>] kmem_cache_create+0x41c/0x458

[<d0ebd038>] ecryptfs_init+0x38/0x1b1 [ecryptfs]

[<c1001071>] do_one_initcall+0x71/0x118

[<d0ebd000>] ? 0xd0ebcfff

[<c1055703>] sys_init_module+0x60/0x18c

[<c12db9b0>] sysenter_do_call+0x12/0x36

ecryptfs_init_kmem_caches: ecryptfs_auth_tok_list_item: kmem_cache_create 
failed

 Failed to allocate one or more kmem_cache objects 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T04:15:24.130

从您在 dmesg 中看到的错误开始：

```
kmem_cache_create: duplicate cache ecryptfs_auth_tok_list_item 
```

当`ecryptfs`模块被加载时，它做的第一件事就是为自己创建一堆内存缓存。该错误表明已经存在具有该名称的缓存。

您可以通过查看 sysfs 来检查缓存是否已经存在：

```
$ ls -ld /sys/kernel/slab/ecryptfs* 
```

**注意。**`/proc/slabinfo`由于平板合并，它可能不会显示。

如果您看到任何表明 ecryptfs 模块已加载或已内置到内核中的 ecryptfs 平板。

通常模块加载器不会让你加载同一个模块两次，但也许你做了一些奇怪的事情来混淆它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T04:51:22.597

发生这种情况的一个可能原因是，如果重新编译并安装内核及其模块，但在安装内核之前忘记挂载 /boot。重新启动后，将使用旧内核但新模块运行。无论如何，请检查*正在运行*的内核是否是最新的，如果有疑问，请重新安装内核和模块：

```
mount /boot 
cd /usr/src/linux 
make && make install && make modules_install 
```

我已完成上述步骤，错误已解决

# 3d - 使用两个 90 度分离的 Wiimote 计算 3D 姿势

> ID：10262512
> 
> 赞同：0
> 
> 时间：2012-04-21T19:59:58.910
> 
> 标签：3d, camera, position, angle

我想在一个框架上安装两个 wii 遥控器，相对于彼此安装 90 度，希望在 3D 空间中找到给定像素的 x、y、z 位置。

我不担心从 wiimotes 获取数据，这很容易。我正在努力理解的是它背后的计算。

我花了一些时间研究（和试验），据我了解，不可能使用简单的笛卡尔几何来获得一个点的真实 3D 位置。

我在这里和其他网站上看到的大多数问题都与安装在一定距离处的两个摄像头（立体）有关。我的需求不同，因为我需要*看到背后的*点。

从我目前收集到的信息来看，我需要获取一个*相机矩阵*来将 x,y 坐标与 3D 位置相关联。但这就是我所得到的……而且我真的不明白。

假设我可以在 2 个相隔 90 度的相机上获得给定像素的 x、y 位置。如何获得 x,y,z 位置？

下面的废话图说明了这种情况：

![在此处输入图像描述](../Images/f69f6b69dab08ba6e9d816d49cadf1e0.png)

注意：摄像机是倾斜的，因此 (0,0) 响应于地板的中间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:05:42.273

如果你从一个相机中获取点，那并不是一个真正的点，而是一个从相机穿过物体到地板或墙壁的矢量。

所以我会从尝试计算这个向量开始。

然后，您将添加来自其他相机的矢量信息并比较它们以找到它们相遇的位置。

# mysql - rails mysql capistrano 数据库迁移失败

> ID：10262513
> 
> 赞同：1
> 
> 时间：2012-04-21T20:00:06.460
> 
> 标签：mysql, ruby-on-rails, deployment, capistrano

现在是从我添加的 sqlite 迁移到 mysql 的时候了

```
gem 'mysql2' 
```

到 Gemfile 并在此处安装它。使用 sqlite 的旧产品运行正常。当我`database.yml`在生产中切换到 mysql 和 mysql 服务器 DBName 和 Password 并通过 git 将其提交到服务器尝试部署时，我收到此错误：

```
 [out :: server] rake aborted!
 ** [out :: server] Please install the mysql adapter: `gem install activerecord-mysql-adapter` (mysql is not part of the bundle. Add it to Gemfile.)
 ** [out :: server] 
 ** [out :: server] Tasks: TOP => db:migrate => db:load_config
 ** [out :: server] (See full trace by running task with --trace)
    command finished in 9827ms 
```

我该如何修复它或如何在服务器上安装 gem？如果我运行，`bundle list`我可以看到 mysql2 已安装。我必须安装哪个模块？

如果我尝试安装，我会收到错误：activerecord-mysql-adapter

```
ERROR:  Could not find a valid gem 'activerecord-mysql-adapter' (>= 0) in any repository
ERROR:  Possible alternatives: activerecord-jdbcmysql-adapter,
activerecord-jdbc-adapter, activerecord-jdbcmssql-adapter, activerecord-odbc-adapter,
activerecord-nulldb-adapter 
```

# php - 如何从 php 返回 CGI 标头？

> ID：10262515
> 
> 赞同：0
> 
> 时间：2012-04-21T20:00:30.600
> 
> 标签：php, apache, cgi

php 如何返回 CGI 标头？

我一直在用 C++ 编写 CGI“脚本”，这很简单：我只是手动输出 a`Content-type`和`Status`一行。但是，我需要使用 phpmailer，所以我也有一些 php 代码。问题是我的简单 php 代码可以正常工作，即使我没有明确返回任何标题。我已经到了现在必须向客户端返回失败状态代码的地步，但我看不出我是如何做到这一点的。有任何想法吗？Apache 是否会自动为我执行此操作，如果是，我如何说服它返回 400 状态？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:02:28.150

根据[文档](http://php.net/manual/en/function.header.php)，发送以“HTTP/”开头的标头。

```
header("HTTP/1.0 400 Bad Request"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:03:36.057

Php 具有此功能，可满足您的需求：

[php头文件](http://php.net/manual/en/function.header.php)

例子：

```
header("HTTP/1.0 404 Not Found"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:03:45.650

您可以使用 header 功能添加自定义标题。请参考头功能文档。

[PHP 标头](http://php.net/manual/es/function.header.php)

# vb.net - 使用 vb 运行 cygwin 终端

> ID：10262518
> 
> 赞同：0
> 
> 时间：2012-04-21T20:00:43.660
> 
> 标签：vb.net

我需要一个代码来使用 Visual Basic 在隐藏模式（背景）下在 cygwin 终端中键入和执行命令，我使用的是 cmd，但现在我想使用 Linux 源代码，所以我必须使用 linux。我在隐藏模式下成功运行了 cmd，但它不适用于 cygwin，这是 cmd 代码：
`Shell("cmd.exe /k tracert -h " & _h & " " & domain.Text & " > temp" & i + 1 & ".txt & exit", AppWinStyle.Hide, True)`

所以我试过了

`Shell(""C:\cygwin\Cygwin.bat -k tracert -h " & _h & " " & domain.Text & " > temp" & i + 1 & ".txt & exit", AppWinStyle.Hide, True)`

和

`Shell("C:\cygwin\Cygwin.bat") 'SendKeys.Send("tracert -h " & _h & " " & domain.Text & " > temp" & i + 1 & ".txt"))`

但这仍然不起作用，在第二个代码中我仍然必须在 cygwin 中按 enter 来处理 traceroute 并且应该自动处理，所以我希望我能在这里找到帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T09:35:48.793

```
Shell("C:\cygwin\Cygwin.bat")

SendKeys.Send("tracert -h " & _h & " " & domain.Text & " > temp" & i + 1 & ".txt"))

SendKeys.Send("{ENTER}") 
```

这就是答案，如果有人需要这个。

# java - 创建具有多个列标题和行标题的自定义 TableModel

> ID：10262521
> 
> 赞同：2
> 
> 时间：2012-04-21T20:00:51.657
> 
> 标签：java, swing, jtable

我正在尝试创建一个类似于以下模型的 JTable：

![自定义 JTable](../Images/a74fbc9e2ef251dc6534a4779bc05c20.png)

绿色角落基本上是红色列和行标题的缓冲区空间。单元格不需要以如图所示的颜色呈现；但是，它们需要与表格中的其他“白色”单元格区分开来。

该表也是不可编辑或可选择的；它只是在更新时由用户查看。

我知道这可以使用 DefaultTableModel 来实现，该模型具有自定义渲染行 1,2 && cols 1,2 并在设置和获取表值时添加 +2（考虑用作标题的行和列）。

## 我的问题如下：

1.  有没有更干净的方法来做到这一点，而不会用标题中使用的这些静态值污染我的表模型？
2.  我已经阅读了有关扩展表模型的信息，但我不确定应该扩展哪个类（DefaultTableModel、AbstractTableModel）以及应该覆盖哪些方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T21:56:15.590

> 输入限制为 20x20，因此包括 22x22 的标题。

还要考虑一个`JScrollPane`包含一个`JPanel`具有`GridLayout`和包含 22x22 个实例的实例`JLabel`，或者一个合适的子类。这很容易扩展到数千个单元。

附录：如果需要，`CellRendererPane`制作一个好的[享](http://en.wikipedia.org/wiki/Flyweight_pattern)元渲染器，如此处所建议[的](https://stackoverflow.com/a/7776211/230513)。

如果您选择`JTable`渲染可扩展性，

1.  这不是滥用；这正是`TableModel`预期的使用方式。`TableModel`对您决定的任何矩形矩阵进行建模。`JTable`只是该模型的（有效渲染）视图。

2.  我更喜欢`AbstractTableModel`，显示[在这里](https://stackoverflow.com/a/9134371/230513)，因为`Vector`很少需要所需的数据结构。使用使您的索引最方便的任何容器。`DefaultTableModel`很方便，可以作为扩展的指南`AbstractTableModel`。特别是，您需要一个`setValueAt()`.

    ```
    @Override
    public void setValueAt(Object aValue, int row, int col) {
        ... // update your data structure
        this.fireTableCellUpdated(row, col); // notify the view
    } 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-21T21:02:58.773

更长的评论，一切取决于

1）如果可能的话`Columns`

*   调整大小

*   重新排序

2）如果可能的话`Columns`

*   过滤

*   排序

一个。然后您查看了两个 JTable，第一个 JTable 仅带有 TableHeader，简单删除了行，第二个全尺寸 JTable 带有 TableHeader 和列和行，

湾。对于两个 JTableHeader 之间的交互，是否存在
[TableColumnModelListener#columnMarginChanged(ChangeEvent e)](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/event/TableColumnModelListener.html#columnMarginChanged%28javax.swing.event.ChangeEvent%29)和`columnMoved(TableColumnModelEvent e)`

C。`JPanel`在 JScrollPane中将所有内容归为一个

d。如果您要更改行数或列数（或过滤/排序），那么您必须通知`JPanel`rezize `JTable#getPreferredScrollableViewportSize()`+ `Dimension`for ontop`JTable`仅使用`TableHeader`

非常相似的方式（是你需要的一切）

![在此处输入图像描述](../Images/9226060cdf9e97c05a2f8e22c9ef5492.png)![在此处输入图像描述](../Images/113d0629698b67004ca56652ca24ba42.png)![在此处输入图像描述](../Images/5275265fe111641b3def64475ac30d1d.png)

（对 Rob 的无限赞誉）

```
import java.awt.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.table.*;

public class TableFilterRow extends JFrame implements TableColumnModelListener {
    private static final long serialVersionUID = 1L;

    private JTable table;
    private JPanel filterRow;

    public TableFilterRow() {
        table = new JTable(3, 5);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane scrollPane = new JScrollPane(table);
        getContentPane().add(scrollPane);
        table.getColumnModel().addColumnModelListener(this);
        //  Panel for text fields
        filterRow = new JPanel(new FlowLayout(FlowLayout.CENTER, 0, 0));
        for (int i = 0; i < table.getColumnCount(); i++) {
            filterRow.add(new JTextField(" Sum at - " + i));
        }
        columnMarginChanged(new ChangeEvent(table.getColumnModel()));
        getContentPane().add(filterRow, BorderLayout.SOUTH);
    }

    //  Implement TableColumnModelListener methods
    //  (Note: instead of implementing a listener you should be able to
    //  override the columnMarginChanged and columMoved methods of JTable)
    @Override
    public void columnMarginChanged(ChangeEvent e) {
        TableColumnModel tcm = table.getColumnModel();
        int columns = tcm.getColumnCount();

        for (int i = 0; i < columns; i++) {
            JTextField textField = (JTextField) filterRow.getComponent(i);
            Dimension d = textField.getPreferredSize();
            d.width = tcm.getColumn(i).getWidth();
            textField.setPreferredSize(d);
        }

        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                filterRow.revalidate();
            }
        });
    }

    @Override
    public void columnMoved(TableColumnModelEvent e) {
        Component moved = filterRow.getComponent(e.getFromIndex());
        filterRow.remove(e.getFromIndex());
        filterRow.add(moved, e.getToIndex());
        filterRow.validate();
    }

    @Override
    public void columnAdded(TableColumnModelEvent e) {
    }

    @Override
    public void columnRemoved(TableColumnModelEvent e) {
    }

    @Override
    public void columnSelectionChanged(ListSelectionEvent e) {
    }

    public static void main(String[] args) {
        JFrame frame = new TableFilterRow();
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

3) 否则请查看[如何使用凸起的](http://docs.oracle.com/javase/tutorial/uiswing/components/border.html)边框`prepareRederer`

4）这个问题与类型无关`TableModel`

# ios - UIViewController 不会卸载

> ID：10262522
> 
> 赞同：1
> 
> 时间：2012-04-21T20:00:53.717
> 
> 标签：ios, uiviewcontroller, uitabbarcontroller

几乎自从我开始学习为 iOS 编程（2012 年 2 月）以来，我一直在研究这个问题。我在这里阅读了很多似乎都在问同样问题的帖子，我试图将答案实施到我的应用程序中但无济于事。我确定我错过了一些简单的东西。

我有一个视图切换测试应用程序。共有三种视图：橙色、蓝色、黄色。它从带有两个按钮的橙色视图开始 - 切换到蓝色视图并切换到黄色视图。当我点击切换到黄色视图时 - 视图围绕白色背景旋转。黄色视图也有两个按钮——切换到橙色视图和切换到蓝色视图。当我单击切换到橙色视图时，视图会翻转回来，但橙色视图不是白色背景，而是背景。如何使橙色视图不存在？

这是我用来进行转换的代码：

```
-(IBAction)switchToYellowView:(id)sender {

YellowViewController *myViewController = [[YellowViewController alloc]
                                         initWithNibName:@"YellowViewController"
                                         bundle:nil];

[UIView beginAnimations:@"flipview" context:nil];
[UIView setAnimationDuration:2];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft 
                       forView:self.view cache:YES];

[self.view addSubview:myViewController.view];

[UIView commitAnimations]; 
```

}

根据我的阅读，我认为我需要从超级视图中删除橙色视图。但是当我使用

```
[OrangeViewController.view removeFromSuperView] 
```

我收到一条错误消息，提示“在对象 OrangeViewController 上找不到属性视图”。

如果我从黄色视图切换到蓝色视图，橙色视图仍在背景中。然后从蓝色切换回橙色，黄色仍然在背景中。

我在其他地方读到，我还需要通过添加来发布这些视图

```
[myViewController release] 
```

在我提交动画之后。我认为在使用 ARC（我正在使用）时这是不必要的。当我这样做时，试图返回橙色视图会导致 Bad Access 崩溃。

也许我需要对 rootViewController 做点什么？我确实在应用程序 delegate.m 中将 OrangeView 设置为“窗口”的子视图：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

// Override point for customization after application launch.

// Add the view controller's view to the window and display.
[self.window addSubview:viewController2.view];
[self.window makeKeyAndVisible];

return YES; 
```

}

viewController2 是指向 OrangeViewController 的指针。

由于第一个评论，我开始四处寻找切换 rootViewController - 并找到了 Ken Anderson 关于以编程方式切换 rootviewcontroller 的讲义。我可以让黄色改变，但它不是动画。

接下来的两条评论将我引向其他方向——最好的办法是使用容器控制器——比如 UITabBarController？除了使用我自己的按钮并且从不显示标签栏？

当然，我可以提供整个应用程序以供阅读。先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T05:02:47.133

Try to use:

```
[self transitionFromViewController:currentViewController toViewController:firstViewNav duration: options: animations:^{
        } completion:^(BOOL finished){

        }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T22:01:52.593

在 switchToYellowView: 中，您将黄色视图添加为当前视图的子视图，即橙色视图。因此，如果您尝试使用 [OrangeViewController.view removeFromSuperView] 删除橙色视图（这可能不起作用，因为视图不是 OrangeViewController 的公共属性），那么您将删除具有黄色视图的橙色视图子视图，有效地从窗口中删除两者。我认为你想在 switchToYellowView 里面做的是这样的：

```
[self.view removeFromSuperview]; //remove the orange view
[window addSubview:myViewController.view]; //replace it with the yellow view 
```

# google-fusion-tables - 插入谷歌融合表

> ID：10262526
> 
> 赞同：2
> 
> 时间：2012-04-21T20:01:16.527
> 
> 标签：google-fusion-tables

我想将数据插入到我的公开融合表中。我查看了[https://developers.google.com/fusiontables/docs/sample_code](https://developers.google.com/fusiontables/docs/sample_code) 的帮助，特别是[http://code.google.com/p/fusion-tables-client-php/source/browse/trunk/samples/ form_example.php](http://code.google.com/p/fusion-tables-client-php/source/browse/trunk/samples/form_example.php)。我下载了运行此脚本所需的文件，即下载了 clienlogin.php、file.php、sql.php 和 constants.php。脚本正在运行，但没有插入行，我无法找到原因。我已经粘贴了我的代码（它是一个小代码..请看一下，让我知道我正在犯的错误）。本质上，我想在通过用户表单收集用户信息后将数据插入到我的融合表中。我不想使用谷歌表格。在这个方向上的任何帮助/指示都会有所帮助。

```
<html>

<?php

include('D:\xampp\htdocs\itpold\clientlogin.php');
include('D:\xampp\htdocs\itpold\sql.php');
include('D:\xampp\htdocs\itpold\file.php');

// Table id
$tableid = 3544282;

//Enter your username and password
$username = "ABCD@gmail.com";
$password = "XYZ";

$token = ClientLogin::getAuthToken($username, $password);
$ftclient = new FTClientLogin($token);

// If the request is a post, insert the data into the table
if($_SERVER['REQUEST_METHOD'] == 'POST') {
// Insert form data into table
  $insertresults = $ftclient->query(SQLBuilder::insert($tableid, 
    array('Name'=> $_POST['Name'],
    'Location' => $_POST['Location'])));
  $insertresults = explode("\n", $insertresults);
  $rowid1 = $insertresults[1];
  echo $rowid1 ;
}

?>

<head>
<title>Simple Form Example</title>

<style>
  body { font-family: Arial, sans-serif; }

</style>

<script type="text/javascript">

// Simple form checking.
function check_form() {
  if(document.getElementById('Name').value == '' ||
    document.getElementById('Location').value == '') {

      alert('Name and location required.');
      return false;
  } 
  return true;
}

</script>
</head>

<body >

<h1>Simple Form Example</h1>

<h2>Insert data</h2>
<form method="post" action="forms.php" onsubmit="return check_form();">
  Name: <input type="text" name="Name" id="Name" /><br />
  Result: <input type="text" name="Location" id="Location" /><br />

  <input type="submit" value="Submit" />
</form>

<h2>Table data</h2>
<p>
<?php
// Show the data from table
$table_data = $ftclient->query(SQLBuilder::select($tableid));
$table_data = explode("\n", $table_data);
for($i = 0; $i < count($table_data); $i++) {
  echo $table_data[$i] . '<br />';
} 
?>
</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T23:21:21.387

通常，服务器无法向安全 URL 发送请求。有关如何解决问题的一些想法，请参阅以下 StackOverflow 帖子：

[无法使用 cURL 连接到 HTTPS 站点。而是返回 0 长度的内容。我能做些什么？](https://stackoverflow.com/questions/316099/cant-connect-to-https-site-using-curl-returns-0-length-content-instead-what-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T03:16:38.623

我怀疑这是您的表的权限问题。您是否确定您登录时使用的帐户已设置为该表的编辑器？检查这一点的最简单方法是以表所有者身份进入 Fusion Tables，然后单击右上角的共享链接。

# django - 如何在 Django 模板中减少我的 url 标签？

> ID：10262530
> 
> 赞同：0
> 
> 时间：2012-04-21T20:02:28.763
> 
> 标签：django, django-urls

我在 Django 模板的导航栏中有很多长长的 URL 列表。

```
<a href="{% url animals.views.bear %}">The Big Bad Bear</a>
<a href="{% url animals.views.cat %}">The Cat</a>
<a href="{% url animals.views.dog %}">The Dog</a>
... 
```

如何避免`animals.views.`在每个 URL 模板标记之前重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:19:11.417

您可以使用[`with`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#with)标签：

```
{% with av=animals.views %}
<a href="{% url av.bear %}">The Big Bad Bear</a>
<a href="{% url av.cat %}">The Cat</a>
<a href="{% url av.dog %}">The Dog</a>
{% endwith %} 
```

然而，正确的方法是在您的 URL conf 中设置正确的名称，正如 Alex 所描述的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:14:18.423

您可以命名您的网址：[文档](https://docs.djangoproject.com/en/dev/topics/http/urls/#url)

在你的 urls.py 中：

```
import views
urlpatterns = patterns('',
    url(r'^bear/$', views.bear, name="bear"),
    url(r'^cat/$', views.cat, name="cat"),
    url(r'^dog/$', views.dog, name="dog"),
    ...
) 
```

那么您的模板代码将如下所示：

```
<a href="{% url bear %}">The Big Bad Bear</a>
<a href="{% url cat %}">The Cat</a>
<a href="{% url dog %}">The Dog</a>
... 
```

但请记住，在您的情况下，使用应用前缀命名您的网址是很方便的`animal`

# php - 从命令行运行 PHP 脚本

> ID：10262532
> 
> 赞同：93
> 
> 时间：2012-04-21T20:02:32.690
> 
> 标签：php, command-line

如何使用用于解析 Web 脚本的 PHP 解释器从命令行运行 PHP 脚本？

我有一个`phpinfo.php`可以从已安装的网络节目访问的文件`German`。但是，如果我使用 -和for`phpinfo.php`从命令行运行，我找不到它。所以两个 PHP 文件是不同的。我需要运行一个安装了它的脚本。`php phpinfo.php``grep``German``php``German`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2012-04-21T20:15:23.257

您应该检查您的服务器配置文件。查找以`LoadModule php`... 开头的行，可能有命名的配置文件/目录`mods`或类似名称。从那里开始。

您还可以检查来自 Web 服务器的输出`php -r 'phpinfo();' | grep php`并比较`phpinfo();`来自 Web 服务器的行。

### `php`交互式运行：

（因此您可以在控制台中粘贴/编写代码。）

```
php -a 
```

### 要使其解析文件并输出到控制台：

```
php -f file.php 
```

### 解析一个文件并输出到另一个文件：

```
php -f file.php > results.html 
```

### 你还需要别的吗？

要只运行一小部分，一行或类似的，您可以使用：

```
php -r '$x = "Hello World"; echo "$x\n";' 
```

如果您正在运行 Linux，请`man php`在控制台中执行。

如果您需要/想要通过 fpm ( [FastCGI Process Manager](https://en.wikipedia.org/wiki/PHP#Installation_and_configuration) ) 运行 PHP，请使用 cli fcgi：

```
SCRIPT_NAME="file.php" SCRIP_FILENAME="file.php" REQUEST_METHOD="GET" cgi-fcgi -bind -connect "/var/run/php-fpm/php-fpm.sock" 
```

其中*/var/run/php-fpm/php-fpm.sock*是您的 php-fpm 套接字文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-17T18:54:54.043

在[SUSE Linux](https://en.wikipedia.org/wiki/SUSE_Linux)上，PHP 有两种不同的配置文件：一种用于 Apache，另一种用于 CLI（命令行界面）。在*/etc/php5/*目录中，您将找到一个“apache2”目录和一个“cli”目录。每个都有一个“php.ini”文件。这些文件用于相同的目的（PHP 配置），但适用于两种不同的 PHP 运行方式。除其他外，这些文件加载​​ PHP 使用的模块。

如果您的操作系统相似，那么这两个文件可能不一样。您的 Apache *php.ini*可能正在加载德语模块，而 CLI *php.ini*没有。安装模块时（自动或手动），它可能只更新了 Apache *php.ini*文件。

您可以简单地将 Apache *php.ini*文件复制到该`cli`目录中，以使 CLI 环境与 Apache 环境完全一样。

或者，您可以在 Apache 文件中找到加载德语模块的行，然后将其复制/粘贴到 CLI 文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-20T19:17:41.223

我一直在寻找Windows中这个问题的解决方案，似乎是如果你没有环境变量ok，你需要放置完整的目录。例如，与 PHP 在同一目录中的文件：

```
F:\myfolder\php\php.exe -f F:\myfolder\php\script.php 
```

# linux - 为什么需要硬链接和软链接？

> ID：10262535
> 
> 赞同：2
> 
> 时间：2012-04-21T20:02:40.707
> 
> 标签：linux, unix

创建硬链接和软链接有什么用？我们在什么样的场景中创建它们？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T20:11:22.433

这已在更适合此问题的网站上进行了详细讨论。

[创建硬链接什么时候有用？](https://superuser.com/questions/288286/when-would-creating-a-hard-link-be-useful/288287#288287)

[软（符号）链接和硬链接有什么区别？](https://serverfault.com/questions/10543/what-is-the-difference-between-a-soft-symbolic-link-and-a-hard-link)

# php - php 将 xml 解析为数组以获得相同级别的同名键

> ID：10262539
> 
> 赞同：1
> 
> 时间：2012-04-21T20:03:08.377
> 
> 标签：php, xml, soap, xml-parsing

我尝试了许多预构建的解析器，包括 xml2array 解析器，但都没有运气。我也尝试过自己的方法，但也没有任何成功。我已经尝试了 simplexmlelement/xpath 和一堆不同的方法，结果相同，所以我在一个我用头敲键盘的地方。

基本上，我正在尝试解析 API 调用向我吐回的代码。我正在打一个肥皂电话并通过 curl (https) 获取 xml 内容。

这是我返回的 xml 示例：HTTP/1.1 100 Continue

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
X-Powered-By: Servlet 2.5; JBoss-5.0/JBossWeb-2.1
Content-Type: text/xml;charset=UTF-8
Transfer-Encoding: chunked
Date: Sat, 21 Apr 2012 19:49:30 GMT

<env:Envelope xmlns:env='http://schemas.xmlsoap.org/soap/envelope/'>
    <env:Header></env:Header>
    <env:Body>
        <ns:processRequestResponse xmlns:ns='hidden.address'>
            <result>
                <?xml version="1.0" encoding="UTF-8"?>
                    <CRMMessage language="en_US" currency="USD" isTrustedSAT="false" hostversion="hiddenINT">
                        <RequestCode>HiddenMethoForCall</RequestCode>
                        <ResponseCode>A</ResponseCode>
                        <ResultSet>
                            <ResultSetMetaData>
                                <RSColumn name="FirstName" type="string" nullable="true"></RSColumn>
                                <RSColumn name="LastName" type="string" nullable="true"></RSColumn>
                                <RSColumn name="EmailAddress" type="string" nullable="true"></RSColumn>
                            </ResultSetMetaData>
                            <Rows>
                                <Row id="hiddenINT">
                                    <Col>John</Col>
                                    <Col>Doe</Col>
                                    <Col>john@doe.com</Col>
                                </Row>
                            </Rows>
                        </ResultSet>
                    </CRMMessage>

            </result>
        </ns:processRequestResponse>
    </env:Body>
</env:Envelope> 
```

我尝试使用 xml2array，但它明确指出它不支持在同一级别解析同名键。

我不确定这是否重要，因为我对任何建议的解析器持开放态度，但这是我放在一起的一个（这是在发出请求后处理请求的类内部）：

```
$retVal = curl_exec($soap_do);  

if($retVal === false) {
    $err = 'Curl error: ' . curl_error($soap_do);  
    throw new requestManager($err);
} else {
    $string = strstr($retVal, '<');
        // $aResp = simplexml_load_string($string);

    if(!function_exists('xml_parser_create')) { 
        //print "'xml_parser_create()' function not found!"; 
        return array(); 
    } 
    curl_close($soap_do);

    //custom parse
    $aResp = array();
    $i=0;
    $parser = xml_parser_create();
    xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, 0);
    xml_parser_set_option($parser, XML_OPTION_SKIP_WHITE, 1);
    // xml_parse_into_struct($parser, $string, $values, $tags);
    xml_parser_set_option($parser, XML_OPTION_TARGET_ENCODING, "UTF-8");
    xml_parse_into_struct($parser, trim($string), $values); 
    xml_parser_free($parser);
    // var_dump($values);
    foreach($values as $val) {
        foreach($val as $key=>$value) {
            if($key=='value'){
                if(is_array($value)) {
                    foreach($value as $k=>$v) {
                        echo $v;
                        $value[$i]=$value;
                    }
                }else {
                    $aResp[$i]=$value;
                    echo '<h1>'.$key.'</h1>';
                    echo '<h2>'.$value.'</h2><br>';
                }
                $i++;
            }

        }
    }
} 
```

任何帮助将不胜感激，因为我在这里碰壁。我已经检查了我能想到的所有资源，但没有运气。谢谢！

# eclipse - eclipse - 构建依赖于 jar 的项目 - 在 ant 期间创建

> ID：10262541
> 
> 赞同：1
> 
> 时间：2012-04-21T20:03:21.160
> 
> 标签：eclipse, ant, clearcase

我在 Eclipse 构建项目时遇到问题。

设置开发环境的过程是：

1.  创建一个清晰的视图。
2.  开幕日食。
3.  导入首选项。
4.  连接到 clearcase 插件。
5.  导入团队集。
6.  运行蚂蚁 -`build.xml`

在 期间`build.xml`，会生成一些文件并将其从其工作目录移动到一些项目的 lib 目录中。

之后，有一些`eclipse.referesh`任务和`eclipse.incrementalBuild`调用`build.xml`。

现在，将 jars（在 期间生成`build.xml`）复制到的项目确实可以成功编译，但依赖于它们的其他项目则没有。

即使我尝试刷新整个工作区并手动清理其所有项目，这也不起作用。

仅当我关闭项目并打开它们（eclipse 功能）时，问题才得到解决。

这可能是由于 ClearCase 插件而发生的吗？
无论如何如何解决这个问题（它导致`build.xml`失败，因为编译器问题）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:25:23.417

使用官方的[IBM ClearCase Eclipse 插件](http://www.ibm.com/developerworks/rational/downloads/07/cc_eclipse3_2/clearcase_plugins.html)（在“ [What Clearcase eclipse-plugin to use to work on both clearcase 6 and 7 projects?](https://stackoverflow.com/questions/1297176/what-clearcase-eclipse-plugin-to-use-in-order-to-work-on-both-clearcase-6-and-7/1297739#1297739) ”中介绍），如果出现以下情况，我不会遇到这样的问题：

**.project 和 .classpath 位于 ClearCase 视图中，以及版本化的源代码**
（请参阅“ [Clearcase plugin for eclipse usage](https://stackoverflow.com/questions/3393758/clearcase-plugin-for-eclipse-usage/3393857#3393857) ”）

换句话说，所有文件（eclipse 文件，ant 文件，...）都应该是项目目录的一部分，在 eclipse 工作区本身*之外*（说 eclipse 工作区只包含对项目的引用，没有实际文件的一部分ClearCase 视图，位于 CC 视图实际所在的其他位置）

如果您尊重该组织，那么 ClearCase 插件应该对您的项目所做的事情产生 0 影响。

# r - 覆盖函数（？）：在r中开发新包时如何处理依赖包

> ID：10262543
> 
> 赞同：1
> 
> 时间：2012-04-21T20:03:28.333
> 
> 标签：r, package

我的 R 包依赖于其他包（例如“字段”）

当我的包被加载时，确保包被加载的最佳实践是什么。

我应该编写cover r程序来做到这一点吗？可以或应该与我的发行版一起分发此类依赖项吗？

我会很感激带有脚本的详细答案

编辑：根据以下建议，我在描述文件中添加了以下内容。

```
Depends: R (>= 1.8.0), fields 
```

当我加载我的包时，字段包仍然没有自动加载。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T20:09:07.800

这是您在随包裹一起提供的说明文件中指定的内容。您可以使用“Depends”字段，或者将“Imports”字段与 NAMESPACE 文件结合使用。查看其他包中的DESCRIPTION 和NAMESPACE 文件，或阅读[Writing R Extensions 手册](http://cran.r-project.org/doc/manuals/R-exts.pdf)。

# css - 使用 CSS 设计定制

> ID：10262549
> 
> 赞同：0
> 
> 时间：2012-04-21T20:05:20.037
> 
> 标签：css, ruby-on-rails-3, devise

我已经在我的 Rails 应用程序中实现了设计。呈现 Flash 消息/Flash 通知时，它在页面上显示为文本 IE 您的会话已过期，请重新登录以继续。

这出现在页面顶部的页面顶部。

我想做的是使用一些 CSS 自定义它，添加边框，更改文本样式等，理想情况下，我希望通知在顶角用 ax 关闭，而不是刷新页面以使通知消失。

有没有人这样做或者可以指出我正确的方向

所有帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:26:22.003

添加这个，或者类似于你的 CSS 文件的东西：

```
.flash {
  text-align: center;
  width: 100%;
  padding: 10px 0 10px 0;
  margin-top: 1em;
  color: #333333;
  border: 1px solid black; 
}

/*
 Flash message styles
*/
.notice {
  background: #fefad9; 
} 
```

其他 Flash 类是：.success、.alert、.error。可能还有一些我忘记了。但这应该有望使您朝着正确的方向前进。

不要忘记添加：

```
<% flash.each do |key, value| %>
  <%= content_tag(:div, value, :class => "flash #{key}") %>
<% end %> 
```

到您的标头或 application.html.erb。

# php - 用一个类设置每个第一个和第四个元素

> ID：10262556
> 
> 赞同：2
> 
> 时间：2012-04-21T20:06:23.163
> 
> 标签：php

我有一个设置为 620px 宽的 jquery 轮播。我正在使用网格 960 将图像放置在里面。我一次显示 4 张图像。

为了做到这一点，我将显示的 4 个组中的每个第一个图像类设置为“grid_2 alpha”，每隔四个设置为“grid_2 omega”，而在两者之间我设置为仅 grid_2。

这给了我需要的 620 像素。我正在从数据库中提取，我正在尝试动态设置类，但不能完全获得类组中的每个第一个和第四个。

```
 <?php $loopIndex = 1; ?>
                    <?php foreach ($pub_values as $v) { 
                    if($v['pub_of_the_month'] == 1)
                    {
                    ?>
                    <?php if ($loopIndex == 1 || $grid_class=="grid_2 omega") $grid_class="grid_2 alpha";
                            else if($loopIndex%4 == 0) $grid_class="grid_2 omega"; 
                            else $grid_class="grid_2"; 
                          $filename = "images/pub_images/120x160/".$v['id'].".jpg";
                          if (!file_exists($filename)) $filename = "images/pub_images/120x160/blank.gif";       
                    ?>
                        <div class="<?php echo $grid_class?>">
                            <a href="#">
                                <img src="<?=$filename;?>" alt="<?=$v['name'];?>" width="120" height="160" />
                                <?=$v['name'];?>
                            </a>
                        </div>
                    <?php $loopIndex = $loopIndex + 1; } }?> 
```

上面的代码是我实现以下目标的最佳尝试。

图片

1 - grid_2 阿尔法

2 - 网格_2

3 - 网格_2

4 - grid_2 欧米茄

5 - grid_2 阿尔法

6 - 网格_2

7 - 网格_2

8 - grid_2 欧米茄

9 - grid_2 阿尔法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:28:32.487

简单的数学，除以余数。

也许您可以通过查看以下代码来弄清楚：

```
for($i = 1; $i <= 9; $i++){
    echo "\n $i ";
    if($i % 4 == 1){
        echo " alpha";
    }elseif($i % 4 == 0){
        echo " omega";
    }
} 
```

现场示例：[http ://codepad.org/LIepxlJm](http://codepad.org/LIepxlJm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:33:05.780

也许你应该只使用一个for循环：

```
for ($i = 0; $i< sizeof($pub_values); $i++) { 
   $classes =['grid_2'];
   if($i%4 == 0) $classes[] = 'alpha';
   if($i%4 == 3) $classes[] = 'omega';
} 
```

编辑：这只是试图展示一种方法，而不是试图在语法上正确。最后，您想加入（或在 php 中内爆）您的类以获取字符串....（也没有为您实现）

# javascript - 不知道为什么这个选择器返回大小 0

> ID：10262559
> 
> 赞同：0
> 
> 时间：2012-04-21T20:06:45.970
> 
> 标签：javascript, jquery, html

我正在尝试编写一些 javascript 以确保表中包含特定类的*lineNumber tr 元素。*我有以下循环这样做：

```
 while ($(".functionCodeLine").size() < lineNumber) {

        console.log($(".functionCodeLine").size());

        funcLineRow = $('<tr class="functionCodeLine"></tr>');
        table.append(funcLineRow);

...
} 
```

但是在我的日志语句中，我看到返回的大小始终为 0。如果我检查 DOM，我会看到新的 tr 正在添加类属性。所以我有点不明白为什么 size 总是 0 并且循环永远不会终止。我错过了什么？

[这是一个 jsfiddle.net 演示](http://jsfiddle.net/ZdmmD/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:09:50.860

试试这个说法

```
$(".functionCodeLine").length 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:55:32.257

所以我不太确定上面代码中的问题是什么，但我能够解决它：

```
while (table.find(".functionCodeLine").size() < lineNumber) {

    console.log(table.(".functionCodeLine").size());

    funcLineRow = $('<tr class="functionCodeLine"></tr>');
    table.append(funcLineRow);

...
} 
```

# php - php://input 作为资源和字符串

> ID：10262563
> 
> 赞同：1
> 
> 时间：2012-04-21T20:08:44.317
> 
> 标签：php, inputstream

使用以下代码：

```
$file = fopen('php://input', 'r');
$temp = tmpfile();
$imageSize = stream_copy_to_stream($file, $temp);
$imageDimensions = getimagesize($file); // Error here
$imageInfos = pathinfo($_GET['selected-image']); 
```

我收到这个错误 `getimagesize() expects parameter 1 to be string, resource given`

因为`$file`是 的资源`fopen`。如果我不能读`php://input`两次，我怎么能有一个资源和一个字符串？

* * *

**更新**

我试过这个：

```
$file = fopen('php://input', 'r');
$tempName = tempnam(sys_get_temp_dir(), '.upload');
$imageSize = fwrite(fopen($tempName, 'w+'), stream_get_contents($file));
$imageDimensions = getimagesize($tempName);
$imageInfos = pathinfo($_GET['selected-image']);

// Unlinks and other stuffs 
```

错误：

```
Notice: getimagesize() [function.getimagesize]: Read error! in 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:12:55.240

因为[`getimagesize()`](http://php.net/getimagesize)只接受字符串文件名，而不接受资源，所以您需要使用[`tempnam()`](http://php.net/tempnam)创建一个临时文件，其名称可以传递给[`getimagesize()`](http://php.net/getimagesize).

```
$file = fopen('php://input', 'r');
$tempName = tempnam('/var/tmp', 'img_');
$temp = fopen($tempName, 'w');
$imageSize = stream_copy_to_stream($file, $temp);
fclose($temp);
$imageDimensions = getimagesize($tempName); 
```

这假设运行 PHP 的用户对该目录具有写入和读取权限`/var/tmp`，但如果没有，您可以更改为该用户确实具有 r/w 权限的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:16:52.883

用于[`tempnam()`](http://uk.php.net/manual/en/function.tempnam.php)生成临时文件，而不是`tmpfile()`. 然后你有一个文件路径，你可以传递给`getimagesize()`：

```
$file = fopen('php://input', 'r');
$tempname = tempnam('.', 'img');
$tempfile = fopen($tempname, 'w+');
$imageSize = stream_copy_to_stream($file, $tempfile);
$imageDimensions = getimagesize($tempname);
$imageInfos = pathinfo($_GET['selected-image']);

// At the end of the script, you need to remember to...
fclose($tempfile);
unlink($tempname); 
```

# performance - 快速计算 (nxdxt) 矩阵中点之间的成对余弦方向距离

> ID：10262565
> 
> 赞同：0
> 
> 时间：2012-04-21T20:08:49.500
> 
> 标签：performance, matlab, distance, cosine-similarity

我知道 Matlab 中的 pdist(X,distance) 采用 (nxd) 点矩阵并计算它们之间的成对距离。我也知道，如果矩阵包含向量而不是点，它还有一个额外的选项来计算余弦距离。

我想做的是采用（nxdxt）矩阵，它保存样本随时间 t 的变化位置，并有效/快速地计算所有对/所有帧之间的余弦方向距离，其中 av(t) 被定义为方向由 p(t+1) - p(t) 计算，p(t) 指的是行 M(p,:,t)。

显然，如果可以得到帮助，我不想使用循环。有什么建议么？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T00:39:05.140

回想一下，余弦距离等于归一化向量之间的欧几里得距离的两倍。这使我们不必在余弦距离函数中一遍又一遍地计算范数。

听起来您想要矢量差异与每次时间变化之间的距离。那是对的吗？

```
data = diff(data,1,3);
[m,n,nt] = size(data);
data = reshape(data,m*nt,n);
data = data./repmat(sqrt(sum(data.^2,2)),1,n);
d = pdist(data);
d = d/2; %# The uniform scaling may not matter to you. 
```

# opengl - 将浮点数传递给 GLSL 着色器什么都不做

> ID：10262571
> 
> 赞同：0
> 
> 时间：2012-04-21T20:09:42.713
> 
> 标签：opengl, glsl, shader

我在将光泽因子发送到凹凸贴图着色器时遇到问题。结果总是这样：http: [//i.imgur.com/unzdx.jpg](http://i.imgur.com/unzdx.jpg)

但是，如果我将着色器内的值硬编码为 0.0，它就可以正常工作。当我将 0.0 发送到着色器时，结果如上图所示。

有任何想法吗？

这是我的着色器

```
#version 110

uniform sampler2D tex;
uniform sampler2D bmap;

uniform bool boolBump;
uniform vec4 vecColor;
uniform bool onlyColor;

uniform float fTransparencyThresh;
uniform float fShininess;
uniform float alpha;

varying vec3 vecLight;
varying vec3 vecEye;
varying vec3 vecNormal;

vec4 getLighting()
{
    //Ambient part
    vec4 color = (gl_FrontLightModelProduct.sceneColor * gl_FrontMaterial.ambient) + (gl_LightSource[0].ambient * gl_FrontMaterial.ambient);

    //For bump mapping, the normal comes from the bump map texture lookup
    vec3 n = normalize(vecNormal);
    if(boolBump)
    {
         n = normalize(texture2D(bmap, gl_TexCoord[0].st).xyz * 2.0 - 1.0);
    }

    vec3 l = normalize(vecLight);

    //Lambert term
    float NdotL = dot(n, l);

    if(NdotL > 0.0)
    {
        //Diffuse part
        color += gl_LightSource[0].diffuse * gl_FrontMaterial.diffuse * max(0.0, NdotL);

        //Specular part
        vec3 e = normalize(vecEye);
        vec3 r = normalize(-reflect(l,n));  

        float spec = pow(max(0.0, dot(r, e)), fShininess);

        color += gl_LightSource[0].specular * gl_FrontMaterial.specular * spec;
    }

    return color;
}

void main(void)
{
    vec4 texel = texture2D(tex, gl_TexCoord[0].st);
    if(texel.a < fTransparencyThresh)
        discard;

    //Get shading
        vec4 color = getLighting();

    //Color only mode?
    if(onlyColor)
    {
        color *= vecColor;
    }
    else
    {
        color *= texel;
    }   

    //Set fragment color, alpha comes from MTL file
    gl_FragColor = vec4(color.xyz, alpha);
} 
```

编辑，OpenGL代码：

```
void MyClass::sendToShader(const OBJ::StelModel* pStelModel, Effect cur, bool& tangEnabled, int& tangLocation)
{
    int location;
    tangEnabled = false;

    if(cur != No)
    {
        location = curShader->uniformLocation("fTransparencyThresh");
        curShader->setUniform(location, fTransparencyThresh);

        location = curShader->uniformLocation("alpha");
        curShader->setUniform(location, pStelModel->pMaterial->alpha);

        location = curShader->uniformLocation("fShininess");
        curShader->setUniform(location, 0.0f);

... 
```

编辑：即使这样也行不通：

```
GLint loc = glGetUniformLocation(curShader->program, "fShininess");
glUniform1f(loc, 0.0f); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T00:55:28.577

请注意 pow(0, 0) 是未定义的。这意味着`spec`未定义 if`dot(r, e) == 0`和`fShininess == 0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:27:55.890

当你调用 glUniform 时，你确定程序是主动绑定的吗？你在任何地方检查 glGetError 吗？

# oop - scala：如何建模基本的父子关系

> ID：10262574
> 
> 赞同：6
> 
> 时间：2012-04-21T20:09:49.643
> 
> 标签：oop, scala, relationship

我有一个包含多种产品的品牌类

在产品类中，我想引用品牌，如下所示：

```
case class Brand(val name:String, val products: List[Product])

case class Product(val name: String, val brand: Brand) 
```

我怎样才能填充这些类？？？

我的意思是，除非我有品牌，否则我无法创造产品

除非我有产品列表，否则我无法创建品牌（因为 Brand.products 是 val）

模拟这种关系的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T20:27:46.157

我会质疑您为什么要重复这些信息，即哪些产品与列表和每个产品中的哪个品牌相关。

不过，你可以这样做：

```
class Brand(val name: String, ps: => List[Product]) {
  lazy val products = ps
  override def toString = "Brand("+name+", "+products+")" 
}

class Product(val name: String, b: => Brand) { 
  lazy val brand = b
  override def toString = "Product("+name+", "+brand.name+")"
}

lazy val p1: Product = new Product("fish", birdseye)
lazy val p2: Product = new Product("peas", birdseye)
lazy val birdseye = new Brand("BirdsEye", List(p1, p2))

println(birdseye) 
  //Brand(BirdsEye, List(Product(fish, BirdsEye), Product(peas, BirdsEye))) 
```

不幸的是，案例类似乎不允许使用按名称参数。

另请参阅这个类似的问题：[实例化不可变配对对象](https://stackoverflow.com/questions/7507965/instantiating-immutable-paired-objects)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T22:54:44.653

既然您的问题是关于模型与这种关系的，我会说为什么不像我们在数据库中所做的那样对它们进行建模？分离实体和关系。

```
val productsOfBrand: Map[Brand, List[Product]] = {
    // Initial your brand to products mapping here, using var
    // or mutable map to construct the relation is fine, since
    // it is limit to this scope, and transparent to the outside
    // world
}
case class Brand(val name:String){
    def products = productsOfBrand.get(this).getOrElse(Nil)
}
case class Product(val name: String, val brand: Brand) // If you really need that brand reference 
```

# ruby-on-rails - 消息控制器中未定义的方法“stringify_keys”

> ID：10262576
> 
> 赞同：2
> 
> 时间：2012-04-21T20:10:09.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, nomethoderror

当我尝试提交表单时出现以下错误（当 1 个用户想要向另一个用户发送消息时显示该表单）

```
NoMethodError in MessagesController#create

undefined method `stringify_keys' for "":String
Rails.root: /Users/fkhalid2008/loand

Application Trace | Framework Trace | Full Trace
app/controllers/messages_controller.rb:31:in `new'
app/controllers/messages_controller.rb:31:in `create' 
```

这是消息控制器的相关代码：

```
def new
  @message = Message.new

  if params[:reply_to]
    @reply_to = @user.received_messages.find(params[:reply_to])
    unless @reply_to.nil?
      @message.to = @reply_to.sender.login
      @message.subject = "Re: #{@reply_to.subject}"
      @message.body = "\n\n*Original message*\n\n #{@reply_to.body}"
    end
  end
end

def create
  @message = Message.new(params[:message])
  @message.sender = @user
  @message.recipient = User.find_by_login(params[:message][:to])

  if @message.save
    flash[:notice] = "Message sent"
    redirect_to user_messages_path(@user)
  else
    render :action => :new
  end
end 
```

我该如何解决？

更多支持代码如下：

**消息>新视图（这是创建表单的地方）**

```
<%= form_for @message, :url => messages_path(:user_id => @user) do |f| %>
<br>
<br />
<br />
<div class="field">
<label>Name</label>
<input type="text" name="name" id="contact_name" class="required" />
</div>

<div class="field">
<label>Email</label>
<input type="text" name="email" id="contact_email" class="required" />
</div>

<div class="field">
<label>Subject</label>
<input type="text" name="subject" id="contact_subject" class="required" />
</div>

<div class="field">
<label>Message</label>
<textarea name="message" rows="8" cols="25" id="contact_message" class="required max_len", max_length=1000 /></textarea>
</div>
<div class="btn">
<%= submit_tag 'Send Message' %>
</div>

<% end %> 
```

**消息模型**

```
class Message < ActiveRecord::Base

is_private_message

attr_accessor :to

end 
```

**用户模型**

```
class User < ActiveRecord::Base

has_many :posts  
has_one :profile
has_private_messages

attr_accessible :email

validates_presence_of :email
validates_uniqueness_of :email, :message =>"Hmm, that email's already taken"
validates_format_of :email, :with => /^([^\s]+)((?:[-a-z0-9]\.)[a-z]{2,})$/i, :message => "Hi! Please use a valid email"

end 
```

**POSTS>INDEX VIEW（这是表单链接到的地方）**

```
<table class="table table-striped">
<tbody>
<% @posts.each do |post| %>
<tr>
<td>I am a <%= post.title %> getting married in <%= post.job %> in <%= post.location %>, and looking for a <%= post.salary %>. My budget is <%= post.salary %>.</td>
<td> <button class="btn" data-toggle="button" onClick="javascript:location.href = '/messages/new';" />Contact</button></td>
<td><%= time_ago_in_words(post.created_at) %> ago.</td>
<!--/. 
<td><%= link_to 'Show', post %></td>
<td><%= link_to 'Edit', edit_post_path(post) %></td>
<td><%= link_to 'Destroy', post, :confirm => 'Are you sure?', :method => :delete %></td>
-->
</tr>
<% end %>
</tbody>
</table> 
```

**开发日志**

```
Started POST "/messages" for 127.0.0.1 at Sun Apr 22 01:54:57 +0500 2012
Processing by MessagesController#create as HTML
Parameters: {"name"=>"faisal", "commit"=>"Send Message", "authenticity_token"=>"Qyww9hP6jLmqpQ+ua21FAk9vePju8Gpq39Gpaflf3wE=", "utf8"=>"\342\234\223", "subject"=>"testing", "message"=>"hello", "email"=>"fas@fas.com"}
User Load (0.1ms)  SELECT "users".* FROM "users" LIMIT 1

Completed 500 Internal Server Error in 17ms

NoMethodError (undefined method `stringify_keys' for "hello":String):
app/controllers/messages_controller.rb:31:in `new'
app/controllers/messages_controller.rb:31:in `create' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T21:29:37.117

现在我明白了。您以完全不一致的方式构建了表单：

```
<%= form_for @message, :url => messages_path(:user_id => @user) do |f| %> 
```

进而：

```
<input type="text" name="name" id="contact_name" class="required" /> 
```

是什么导致您遇到此文本字段与消息无关的情况。您`message`在最后一个标签中看到任何提及吗？

解决方案很简单：使用助手。

而不是你的标记：

```
<label>Name</label>
<input type="text" name="name" id="contact_name" class="required" /> 
```

使用助手：

```
<%= f.label :name %>
<%= f.text_field :name %> 
```

并且您的字段将被正确命名（例如`message[name]`），并且您将正确进入控制器`params[:message]`。当然，您可以手动进行，但实践表明这不是最佳决定。

对所有其他字段重复此步骤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:35:17.353

我猜正在发生的事情`params[:message]`并不是 Rails 期望的那样。您绝对应该遵循 jdoe 的建议并发布您的表单代码 b/c 我怀疑这是不对的。

此外，您可以在开发日志中查看您发布到应用程序的数据。也发一下。它看起来像：

```
Started POST "/message" for 127.0.0.1 at 2012-04-19 16:49:22 -0400
  Processing by MessagesController#create as HTML
  Parameters: {"key"=>"value"} 
```

“参数”是您要查看的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T21:27:58.763

调用时`Message.new(params[:message])`，`params[:message]`需要是带有消息属性的哈希。在您的表单中，因此在日志文件中显示的帖子中，`params[:message]`是一个字符串。

改变

```
<textarea name="message" rows="8" cols="25" id="contact_message" class="required max_len", max_length=1000 /></textarea> 
```

到

```
<textarea name="message[message]" rows="8" cols="25" id="contact_message" class="required max_len", max_length=1000 /></textarea> 
```

或更好

```
<%= f.text_area :message, :rows => 9, :cols => 25, :class => "required max_len", :max_length => 1000 %> 
```

但是 - 您的表单中还有很多其他错误，您很快就会遇到 - 例如，没有`message[to]`参数，但您希望控制器中有一个。我建议阅读一些 Rails 教程，比如[这个](http://guides.rubyonrails.org/form_helpers.html)。

# c - 字符串文字是否保证在内存中彼此相邻？

> ID：10262578
> 
> 赞同：5
> 
> 时间：2012-04-21T20:10:44.760
> 
> 标签：c

是否保证字符串文字相邻存储在内存中？

因此以下是否一定会得到输出`hellohello`

```
printf(3 + "%d");
printf("hello"); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-21T20:12:30.230

不，字符串文字存储在编译器喜欢的任何地方。您在连续行中声明其中两个的事实是无关紧要的。您不能对编译器将它们存储在哪里做任何假设。

编译器可以做各种各样的事情。例如，如果您编写以下代码

```
printf("hello");
printf("hello"); 
```

那么编译器完全可以自由地只创建一个文字。或不。

# ios - iPad上，基于UIView的新类的initWithFrame没有被调用？

> ID：10262580
> 
> 赞同：1
> 
> 时间：2012-04-21T20:11:08.783
> 
> 标签：ios, uiview, uikit

对于单视图应用，添加了一个 DrawView 类，它是 UIView 类的子类。

它作为应用程序的主视图，所以`drawRect`这个类的方法效果很好，可以画东西，例如，但是Xcode生成的代码有一行“//初始​​化代码”表示将初始化代码放在那里，里面`initWithFrame`，但是我在里面放了一些代码，它没有被调用，并且在那里设置了一个断点，但它永远不会停在那里？`init`然后我使用通常的方法添加了一个，它也没有被调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:18:11.763

尝试覆盖 -(id)initWithCoder:(NSCoder*)coder。我相信当从 nib 加载视图时，它会使用这个 init 方法。看到[这个](https://stackoverflow.com/questions/3425598/uiview-subclass-initwithframe-not-being-called)问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:34:49.800

*   initWithCoder: -**如果您从 Interface Builder nib 文件加载视图并且您的视图需要自定义初始化，建议您实现此方法**。nib 加载代码不使用 initWithFrame: 方法来实例化新的视图对象。相反，它使用 initWithCoder: 方法，该方法是 NSCoding 协议的一部分。***nib 加载代码不使用 initWithFrame: 方法来实例化新的视图对象。相反，它使用 initWithCoder: 方法，该方法是 NSCoding 协议的一部分。***[苹果的文档](http://UIView%20reference%20page%3a)

*   initWithFrame: - 视图的默认初始化方法，新的视图对象必须插入到窗口的视图层次中才能使用。如果您以编程方式创建视图对象，则此方法是 UIView 类的指定初始化程序。

这里有一些更多信息：[覆盖方法](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/CreatingViews/CreatingViews.html#//apple_ref/doc/uid/TP40009503-CH5-SW23)

很高兴能帮助你：）

# javascript - 用javascript停止随机字母

> ID：10262585
> 
> 赞同：-4
> 
> 时间：2012-04-21T20:12:20.123
> 
> 标签：javascript, html, random

这里我有一个代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Letters</title>
</head>

<body>
<div id="stop">STOP</div>

<div id="letter">A</div>
<div id="letter">G</div>
<div id="letter">D</div>
<div id="letter">M</div>
<div id="letter">S</div>
<script type="text/javascript">
var letters = ['a','b','c','d', ... ];
var getRandLetter = function () {
    return letters[ Math.random() * 25 ] //generate a random number between 0 and 25, use this to pick a letter
}
setInterval($('#letter').text(getRandLetter()), 500) //pop a random letter in the DOM every 500 ms
</script>

</body>
</html> 
```

使用脚本，我需要每 0.5 秒更改一次 div 上的字母，但是-

现在，当我单击 STOP div 时，我需要： 1st div - "A" 2nd div "B" ... ... 等等。我该怎么做。请帮忙！有没有机会这样做！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:20:16.877

即使您可能不应该为您的 div 提供与上述相同的 id，但这实际上可以工作（显然未经测试）：

```
var curIdx = 0;
//choose a new first letter index every 500 ms
var interval = setInterval(function(){curIdx = Math.random() * 25;}, 500);

$('#stop').click(function(){
    var allDivs = $('#letter');
    for( var i = 0; i < letters.length; i++ )
    { 
       var offset = (curIdx + i) % letters.length;
       allDivs[i].text(letters[offset]);
    }
    //edit: to stop the thing from running
    clearInterval(interval);
}

this is assuming, you have as many divs as letters...

edit: i made a fiddle yesterday, that i forgot to post: [http://jsfiddle.net/qpg4V/8/][1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:43:09.960

```
<div id="s">STOP</div>
<div id="L1"></div>
<div id="L2"></div>
<div id="L3"></div>
<div id="L4"></div>
<div id="L5"></div>

v=setInterval(function(){for(i=0;i<6;i++){$("#L"+i).html(String.fromCharCode(Math.floor(Math.random()*26+65)))};},500);
$("#s").click(function(){clearInterval(v);}); 
```

[http://jsfiddle.net/Hx28c/1/](http://jsfiddle.net/Hx28c/1/)

享受你的游戏。

# ios - 使用加速度计获取相对于地平面的设备平面

> ID：10262586
> 
> 赞同：5
> 
> 时间：2012-04-21T20:12:21.857
> 
> 标签：ios, accelerometer

假设 iPhone 放在一个平板上。我想确定桌面平面的角度，其中 0 的角度意味着桌子完全垂直于重力矢量。我正在使用以下公式：

```
 radians = atanf (z / sqrt (x^2 + y^2) 
```

在.h

```
double      accelerationXAverage;
double      accelerationYAverage;
double      accelerationZAverage;

double      accelerationXSum;
double      accelerationYSum;
double      accelerationZSum;
int         readingsCount; 
```

在他们中

```
#define kThresholdMovementHigh 0.05

- (void)accelerometer:(UIAccelerometer *)accelerometer
        didAccelerate:(UIAcceleration *)acceleration 
{
    // did device move a lot? if so, reset sums
    if (fabsf(acceleration.x - accelerationXAverage) > kThresholdMovementHigh ||
        fabsf(acceleration.y - accelerationYAverage) > kThresholdMovementHigh ||
        fabsf(acceleration.z - accelerationZAverage) > kThresholdMovementHigh   )
    {
        NSLog(@"deviceDidMove a lot");
        accelerationXSum = acceleration.x;
        accelerationYSum = acceleration.y;
        accelerationZSum = acceleration.z;
        readingsCount = 1;
    }

    else 
    {
        // because the device is at rest, we can take an average of readings
        accelerationXSum += acceleration.x;
        accelerationYSum += acceleration.y;
        accelerationZSum += acceleration.z;
        readingsCount ++;        
    }

    accelerationXAverage = accelerationXSum / readingsCount;
    accelerationYAverage = accelerationYSum / readingsCount;
    accelerationZAverage = accelerationZSum / readingsCount;

    float angle = RadiansToDegrees(atanf(accelerationZAverage/sqrtf(pow(accelerationXAverage, 2) + pow(accelerationYAverage, 2)))) + 90;

    labelAngle.text = [NSString stringWithFormat:@"%.2f°", angle];
} 
```

我通过平均加速度计读数来滤除噪音。加速度计更新间隔为 1/60，现在在进行实验时，我让设备静置 10 秒（因此平均读数为 600）。

这个公式似乎有效，它给了我关于我所期望的角度。但是，我也期望如果我尝试将设备旋转到不同的静态位置同时仍然平放在桌面上，我应该得到相同的答案（因为相对于重力矢量，角度没有改变） . 但是，当我尝试它时，这不是我得到的。角度相差几度。

我使用了正确的公式？为什么同一桌面上不同位置的角度会不同？仅仅是误差范围吗？

我添加了一张图片（来自[http://gotoandplay.freeblog.hu/](http://gotoandplay.freeblog.hu/)）以确保我在谈论相同的 x-y- 和 z- 轴。![在此处输入图像描述](../Images/c214c7a72f10e27c8b423a62471af6b4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T09:38:54.477

你的方法和公式是正确的。

x、y 和 z 与设备相关。理论上，无论设备在桌面上的角度位置如何，角度都应该相同。然而，有几个因素有助于此处的准确性，包括在如此小角度的反正切计算。我建议您尝试使用桌子倾斜度（不与地面水平）。假设将您的桌子与地面保持 30 度角并尝试一下。我假设你的 x,y,z 都是双倍的

# ruby-on-rails - 在 Rails 3.2 App 中使用多个模型时如何使用 Devise 处理身份验证

> ID：10262589
> 
> 赞同：12
> 
> 时间：2012-04-21T20:12:36.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authentication, devise, single-table-inheritance

我正在开发一个使用 Devise 进行身份验证的 Rails 3.2 应用程序。我决定尝试单表继承来管理用户角色，但很快就遇到了问题。我目前有三个用户模型`User < ActiveRecord`，`Admin < User`和`Collaborator < User`。Admin 和 Collaborator 共享大多数 User 列，但它们的行为和权限略有不同。我的模型目前看起来像这样：

```
class User < ActiveRecord::Base

  devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable, :token_authenticatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :name, :password, :password_confirmation, :remember_me

  before_save :ensure_authentication_token

  [...]

end

class Admin < User
  has_one :account, dependent: :destroy 
  attr_accessible :account_attributes 
  accepts_nested_attributes_for :account
end

class Collaborator < User
  has_one :account
end

class Account < ActiveRecord::Base
  attr_accessible :name
  validates_presence_of :name 
  has_many :projects, dependent: :destroy
  has_many :users
end 
```

当我尝试在我的 ProjectController（以及我需要身份验证的其他控制器）中对管理员和协作者进行身份验证时，问题就出现了：

```
# Causes problem, no one can access anything.
before_filter :authenticate_admin!
before_filter :authenticate_collaborator! 
```

我遇到的一个类似问题是设计的 ie 辅助方法。current_user，现在我有了 current_admin 和 current_collaborator，我通过创建一个 before 过滤器和方法“解决了”这个问题：

```
def set_current_user
  @current_user = current_admin || current_collaborator
end 
```

对于我的 Devise 身份验证问题是否有类似或简单的解决方案，或者您会推荐其他方法而不是单表继承，那会是什么？

我的目标是，1.当新用户注册时，他们成为管理员，当他们创建帐户时，也会创建一个帐户模型。2\. 然后，新（管理员）用户可以邀请其他用户加入帐户，这些用户将是协作者。3\. 管理员和协作者应该有不同的权限。协作者在注册时不会创建新的“帐户”（公司可能是我的帐户模型的更好名称），因此管理员和协作者将需要稍微不同的表单来注册和编辑。

谢谢。

**更新**

我通过创建一个类似的前置过滤器来“解决”它：

```
def authenticate!
  if @current_user == current_admin
    :authenticate_admin!
  elsif @current_user == current_collaborator
    :authenticate_collaborator!
  end
end 
```

关于可能更优雅的解决方案的建议仍然会受到赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-17T19:23:06.273

您可以使用以下解决方案解决此问题

```
def 认证！
    如果模型A_user_signed_in？
      @current_user = current_modelA
      真的
    别的
      验证模型B！
    结尾

  结尾

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-03T20:36:27.497

不知道这是否仍然需要解决这个问题......

进行双重身份验证的更优雅的方法可能是执行以下操作：

```
private

def authenticate!
   :authenticate_admin! || :authenticate_collaborator!
   @current_user = admin_signed_in? ? current_admin : current_collaborator
end 
```

然后调用 before_filter :authenticate!

如果您不需要通用的“@current_user”变量，只需省略第二行。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T08:49:07.413

您可以将所有常见逻辑分离到模块并仅使用同一张表。

```
module UserMethods
  #...
end

class User < ActiveRecord::Base
  include UserMethods
  devise ...

end  

class Admin < ActiveRecord::Base
  include UserMethods
  self.table_name = "users"
  devise ...
end 
```

并在路由、视图中分别配置所有设计模型（如有必要，请参阅[配置视图](https://github.com/plataformatec/devise)）。在这种情况下，您可以轻松处理所有不同的逻辑。

# javascript - asp.net MVC 与 MVVM 通过 Knockout，将模型传递给 javascript

> ID：10262592
> 
> 赞同：4
> 
> 时间：2012-04-21T20:12:51.043
> 
> 标签：javascript, asp.net-mvc, json, knockout.js

我正在编写一个 MVC 应用程序，并且我认为 Knockout.js 将帮助解决我的很多问题，除了在此过程中，它创建了一个我正在解决的问题的新问题。

我将所有 MVC 端点转换为仅返回视图，然后我创建了其他几个返回 JSON 对象的端点。当用户浏览网站时，网站会加载基本的 UI 框架。之后，Knockout.js 通过 AJAX 调用加载模型。这导致每个页面都加载，然后再次“加载”，就像 MVC 一样，页面加载并且所有数据都存在。

我一直在寻找同时加载两者的方法，但我还没有找到不需要我完全重构网站的任何东西。最好的选择是：

*   将 JSON 端点合并到视图端点中，并使用代码隐藏将模型转换为 JSON`@Html.Raw(Json.Encode(object))`

但随后我必须摆脱我所有的纯 JSON 端点。

我还能做些什么来将 JSON 端点数据传递到服务器端的视图？或者有什么方法可以同时加载模型和视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:21:02.677

您的架构是正确的，但您希望初始加载使用模型中的数据预先填充您的视图。在只返回视图的控制器操作中，您应该将要填充的数据放入 ViewData。然后视图最初加载模型值，并且每个 UI 元素都可以有一个 AJAX 更新，该更新为该特定字段调用控制器操作。

这也是[ViewModel 的理想情况](http://stephenwalther.com/blog/archive/2009/04/13/asp-net-mvc-tip-50-ndash-create-view-models.aspx)。这也可能有所[帮助](https://stackoverflow.com/questions/4529057/knockoutjs-updating-viewmodel-after-ajax-call)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T00:17:58.470

我也同意让您的初始视图生成将初始数据直接呈现到视图中是一个好主意。一般来说，这确实比单独的 AJAX 调用 + JavaScript 之后填充数据产生更好的性能。

但我也认为这真的取决于你正在加载的页面类型。如果您的应用程序主要基于 AJAX（SPA 样式模型），那么第一次加载可能并不那么重要，因为它只发生一次，并且可能需要花费一些额外的时间。通过 AJAX 或通过传统的视图操作以一种方式加载所有数据会更容易和更一致。当您的客户端代码要求您重新加载列表或记录的整个数据集时，您最终不会复制模板/视图逻辑来生成该输出。

# java - 使用反射时处理或转换从 method.invoke() 返回的对象

> ID：10262599
> 
> 赞同：2
> 
> 时间：2012-04-21T20:13:47.307
> 
> 标签：java, exception, object, reflection, casting

使用Java，我有一个方法，我用method.invoke 调用它返回一个字符串。Method.invoke 返回一个不能转换为字符串的对象。我应该如何将对象用作字符串？

在反射文档中，它显示以下内容：

```
Object o = m.invoke(t, new Locale(args[1], args[2], args[3]));
out.format("%s() returned %b%n", mname, (Boolean) o); 
```

但是我的代码这样做了，我得到了一个异常：java.lang.Class cannot be cast to java.lang.String

这是一个抽象类 - 然后会有几个 bean 的实现。

```
 Method[] methods = this.getClass().getMethods();
    for (Method method : methods) {
        if (isMethodGetter(method)) {

            try {

                Object message = method.invoke(this); // expect a string    
                       Object message = method.invoke(this); // expect a string

                if (message == null) {
                    // no messeage
                } else {
                    logger.debug("Calling listAnswers: got an answer: "
                            + message);

                    // create an answer object from the reflected
                    Answer answer = new Answer();
                    answer.setText((String)message);//cast as string
                    answerList.add(answer);
        } 
```

编辑：根据以下答案，我在验证时遇到了问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:16:19.077

这很简单：您没有得到 的实例`java.lang.String`，而是 的`java.lang.Class`。您在评论中的澄清说明一切都非常清楚：该方法`java.lang.Object.getClass`通过了您的`isMethodGetter`测试，但它不是您想要的。只需增强检查代码以不让确切的名称`getClass`通过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:20:49.993

我认为如果你得到一个 ClassCastException 那么你需要检查你是否真的调用了正确的方法。但是为了有帮助，如果实际上您期望的是一个字符串，那么如果返回的对象不为空，您可以调用 toString() 方法。

# c++ - 如何使用 OpenCV 检测大量白色像素的区域？

> ID：10262600
> 
> 赞同：19
> 
> 时间：2012-04-21T20:14:01.730
> 
> 标签：c++, image-processing, opencv, object-detection

我想检测图像中的徽标以将其删除。我有一个想法是寻找具有大量像素然后删除的对象。另一个想法是遍历所有白色像素（我已经反转了我的图像）并寻找形成大区域的像素，然后删除该区域。有没有比这个更好的算法。此外，OpenCV 中的哪些方法将帮助我检测大像素数的对象。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-22T09:18:02.910

我有办法做到这一点。我不知道这种方法是否适用于所有人，但在这里效果很好。

以下是代码（在 Python 中）：

首先将图像转换为灰度，调整图像大小，应用阈值，并制作与调整大小的灰度图像相同大小和类型的蒙版图像。（面具图像只是黑色图像）

```
import cv2
import numpy as np

img = cv2.imread('bus.png')
img = cv2.resize(img,(400,500))
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
ret,gray = cv2.threshold(gray,127,255,0)
gray2 = gray.copy()
mask = np.zeros(gray.shape,np.uint8) 
```

现在在阈值图像中找到轮廓。过滤 500 到 5000 之间区域的轮廓。它很可能是一个大的白色斑点，显然不是字母。（记住，这个区域是这个图像的特殊区域。我不知道你的其他图像。你必须自己找到它）。现在在填充了白色的蒙版图像上绘制此轮廓。

```
contours, hier = cv2.findContours(gray,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
for cnt in contours:
    if 200<cv2.contourArea(cnt)<5000:
        cv2.drawContours(img,[cnt],0,(0,255,0),2)
        cv2.drawContours(mask,[cnt],0,255,-1) 
```

`Below is the detected contour image:`

![检测到在输入图像上绘制的轮廓](../Images/ad82ce5b450e0ff2357b421cedab768a.png)

`Next is the mask image:`

![新蒙版图像](../Images/d92db1d013fe256f305739eec772520a.png)

`cv2.bitwise_not`现在您使用函数反转图像。您可以选择在我们提供蒙版图像的地方提供蒙版，以便该功能仅在输入图像中蒙版图像中有白色的区域上运行。

```
cv2.bitwise_not(gray2,gray2,mask) 
```

最后显示图像：

```
cv2.imshow('IMG',gray2)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

结果如下：

![在此处输入图像描述](../Images/96086a23bbdc6ceec46ae9181e3cc85f.png)

* * *

**笔记：**

完成上述方法以将“橙色”保留在白色方块中。这就是为什么存在一些文物的原因。如果你也不想要那个橙色，它可以更准确。

只需找到区域过滤轮廓的边界矩形并绘制填充黑色的矩形。

代码 ：

```
import cv2
import numpy as np

img = cv2.imread('bus.png')
img = cv2.resize(img,(400,500))
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
ret,gray = cv2.threshold(gray,127,255,0)
gray2 = gray.copy()

contours, hier = cv2.findContours(gray,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
for cnt in contours:
    if 200<cv2.contourArea(cnt)<5000:
        (x,y,w,h) = cv2.boundingRect(cnt)
        cv2.rectangle(gray2,(x,y),(x+w,y+h),0,-1)

cv2.imshow('IMG',gray2)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

结果 ：

检测到的边界矩形：

![在此处输入图像描述](../Images/0978a016a84d37e4eec5c9815efcf0e7.png)

然后用黑色填充这些矩形：

![在此处输入图像描述](../Images/be47acd4a43581a2547437b26a367482.png)

它比以前更好，当然如果你不想要“橙色”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:21:42.507

您可以使用形态过滤器（可能是交替顺序过滤）来简化您的多色图像，然后使用分水岭或某些粒度方法等分割算法并选择最大的对象。您可能会在网上找到几个实现。但这仅在徽标是离散的（例如不在背景上）时才有效

# linux - 从可能重复的文件中随机选择 n 行

> ID：10262601
> 
> 赞同：-4
> 
> 时间：2012-04-21T20:14:02.883
> 
> 标签：linux, perl, bash

我有一个超过 100 万行的文本文件。单独的行不是很大（每行大约 200-270 个字符）。

我试图在输入中随机选择 60% 的行数，其中每一行都可以在输出中重复。在上面的示例中，我的输出将有 600,000 行，但其中只有 500,000 行可能是唯一的。我还需要在不同的输出文件中根本没有选择的行。任何单独的行都不应该出现在两个输出文件中。

输入文件中的每一行都有如下记录。

*   记录1
*   记录2
*   记录3
*   记录4
*   记录5
*   记录6
*   记录7

如果我试图在文件 output1.txt 中选择 5 个随机行，其中每一行都可以重复。可以说以下是选择的行并且在 output1.txt 中

*   记录3
*   记录5
*   记录2
*   记录2
*   记录5

其余记录应转到 output2.txt。

*   记录1
*   记录4
*   记录6
*   记录7

记录的顺序无关紧要。

我想我可以使用 Java 编写代码来执行此操作，但我想知道我可以使用一些命令或脚本快速完成此操作。我尝试使用 'shuf' 来选择线条，但是我怎样才能确保已选择的线条不会出现在我想要获得的第二个输出中。

我正在使用 Linux 机器。欢迎任何建议或意见。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T22:24:46.120

这是一个 Perl 解决方案。

我最近似乎写了很多，但是索引一个非常大的文本文件是在不将整个文件读入内存的情况下随机访问它的最佳方法。

该程序使用[`tell`](http://perldoc.perl.org/functions/tell.html)操作符在源文件中建立当前记录的偏移量，[`seek`](http://perldoc.perl.org/functions/seek.html)操作符返回到特定记录，并[`vec`](http://perldoc.perl.org/functions/vec.html)跟踪已选择的记录。

请注意，`do { ... } while EXPR`表单在第一次检查条件之前执行 do-block，并且是专门为此目的选择的。

该程序希望扫描文件以查找要在命令行上指定的数据。输出文件`selected.txt`用于选定的 60% 和`unselected.txt`其余部分。

```
use strict;
use warnings;

my $file = shift or die "No input file specified";

open my $infh, '<', $file or die qq(Unable to open "$file" for input: $!);
my @index;
do { push @index, tell $infh } while <$infh>;

my $used = "\0" x (@index / 8 + 1);

my $outfh;

open $outfh, '>', 'selected.txt' or die $!;
my $n = 0;
while ($n++ / @index < 0.6) {
  my $rec = int rand scalar @index;
  seek $infh, $index[$rec], 0;
  print $outfh scalar <$infh>;
  vec($used, $rec, 1) = 1;
}

open $outfh, '>', 'unselected.txt' or die $!;
for my $rec (0 .. $#index) {
  next if vec($used, $rec, 1);
  seek $infh, $index[$rec], 0;
  print $outfh scalar <$infh>;
} 
```

* * *

**编辑**

我犹豫是否要使用模块来替换这么少的代码，但这里有一个使用*ikegami*[`Tie::File`](https://metacpan.org/module/Tie%3a%3aFile)推荐的版本，以防有人更喜欢这种方法。

 *```
use strict;
use warnings;

use Tie::File;

my $file = shift or die "No input file specified";

tie my @index, 'Tie::File', $file, mode => O_RDONLY
    or die qq(Unable to open "$file" for input: $!);

my $outfh;
my @used;

open $outfh, '>', 'selected.txt' or die $!;
my $n = 0;
while ($n++ / @index < 0.6) {
  my $rec = int rand scalar @index;
  print $outfh $index[$rec], "\n";
  $used[$rec]++;
}

open $outfh, '>', 'unselected.txt' or die $!;
for my $rec (0 .. $#index) {
  print $outfh $index[$rec], "\n" unless $used[$rec];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T22:17:56.357

这会随机选择文件的 N 行中的一行，直到选择 N/6 行。重复率不受控制。

为了节省内存，我们将在内存中保留行的文件位置而不是行本身。[Tie::File](http://search.cpan.org/perldoc?Tie%3a%3aFile)为我们做到了这一点。

```
#!/usr/bin/env perl
use strict;
use warnings;

use Tie::File  qw( );

my ($input_qfn, $picked_qfn, $unpicked_qfn) = @ARGV;

tie(my @lines, 'Tie::File', $input_qfn, autochomp => 0)
   or die;

my $num_lines = @lines;
my @unpicked_indexes = 0..$num_lines-1;
my @picked_indexes;
for (1..$num_lines*.6) {
   my $rnd_idx = int(rand($num_lines));
   $unpicked_indexes[$rnd_idx] = undef;
   push @picked_indexes, $rnd_idx;
}

open(my $picked_fh, '>', $picked_qfn)
   or die $!;
print($picked_fh $lines[$_]) for @picked_indexes;

open(my $unpicked_fh, '>', $unpicked_qfn)
   or die $!;
print($unpicked_fh $lines[$_]) for grep defined, @unpicked_indexes; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:38:29.570

您可以`bash script`使用以下代码执行此操作：

**在输出中不重复行：**

```
#!/bin/bash

lines=$(wc -l inputfile.txt | awk '{print $1}')

echo $lines

# computation of percentage of random lines we
# want to pick e.g. 60%
let percentage=$((lines*60/100))

echo $percentage

# pick the random lines
random_lines=$(sort -R inputfile.txt | head -n $percentage)

# show the random lines
echo $random_lines 
```

**在输出中重复行：**

```
#!/bin/bash

lines=$(wc -l inputfile.txt | awk '{print $1}')

echo $lines

# computation of percentage of random lines we
# want to pick e.g. 60%
let percentage=$((lines*60/100))

echo $percentage

# pick the random lines
for ((i=1; i<$percentage; i++))
do
  echo $(sort -R inputfile.txt | head -n 1)
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T20:36:43.513

示例 ~ STDOUT 两次 10%，STDOUT 一次 50%，STDERR 其余 40%

```
awk 'BEGIN {srand()} !/^$/ { r = rand(); if (r <= .60) print $0; if (r <= 0.10) print $0; if (r > .60) print $0 > "/dev/stderr"; }' 
```

注意：将 STDOUT 重定向到一个文件`> file1`，将 STDERR 重定向到另一个文件`2> file2`...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-21T21:04:24.280

您正在寻找的数学术语如下：您有一组 100 万个元素，并且您希望“替换”选择样本元素；此外，您想知道未选择的元素。

```
universe = range(10**6)  # or whatever your elements are
numElementsToChoose = int(0.6*len(universe))

chosen = [random.choice(universe) for _ in range(numElementsToChoose)]
unchosen = set(universe) - set(chosen) 
```

演示：

```
>>> len(chosen), len(unchosen)
(600000, 548815) 
```

（这段代码不优雅，因为`universe`应该是一个集合，但是python本身不支持从集合中选择一个随机元素，只支持一个序列......呃。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-22T00:48:22.723

如果你有`shuf`，你可能有`comm`，它有 -3 选项来比较两个排序的文件并输出仅在一个文件中找到的行。*

# sorting - 自然归并排序一个链表

> ID：10262602
> 
> 赞同：6
> 
> 时间：2012-04-21T20:14:04.960
> 
> 标签：sorting, linked-list, mergesort

我一直在寻找一个**自然的**合并排序实现（**链表**）一段时间，但没有运气。

[合并排序链接列表](https://stackoverflow.com/questions/7685/merge-sort-a-linked-list)

在这里，我们同时拥有递归和迭代实现，但我不知道如何将其变成自然的归并排序。

在最佳情况下，如何检查运行以获得**O(n)**复杂度？它不必是 C/C++，可以是任何语言甚至是伪代码。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:21:33.167

[维基百科](http://www.algorithmist.com/index.php/Merge_sort#Natural_mergesort)上有一个伪代码实现：

```
 # Original data is on the input tape; the other tapes are blank
 function mergesort(input_tape, output_tape, scratch_tape_C, scratch_tape_D)
     while any records remain on the input_tape
         while any records remain on the input_tape
             merge( input_tape, output_tape, scratch_tape_C)
             merge( input_tape, output_tape, scratch_tape_D)
         while any records remain on C or D
             merge( scratch_tape_C, scratch_tape_D, output_tape)
             merge( scratch_tape_C, scratch_tape_D, input_tape)

 # take the next sorted chunk from the input tapes, and merge into the single given output_tape.
 # tapes are scanned linearly.
 # tape[next] gives the record currently under the read head of that tape.
 # tape[current] gives the record previously under the read head of that tape.
 # (Generally both tape[current] and tape[previous] are buffered in RAM ...)
 function merge(left[], right[], output_tape[])
     do
        if left[current] ≤ right[current]
            append left[current] to output_tape
            read next record from left tape
        else
            append right[current] to output_tape
            read next record from right tape
    while left[current] < left[next] and right[current] < right[next]
    if left[current] < left[next]
        append current_left_record to output_tape
    if right[current] < right[next]
        append current_right_record to output_tape
    return 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T05:43:31.480

这是我在 F# 中的尝试。一个常规合并排序的实现供参考：

```
// Sorts a list containing elements of type T.  Takes a comparison
// function comp that takes two elements of type T and returns -1
// if the first element is less than the second, 0 if they are equal,
// and 1 if the first element is greater than the second.
let rec sort comp = function 
| []  -> []  // An empty list is sorted
| [x] -> [x] // A single element list is sorted
| xs  ->
    // Split the list in half, sort both halves,
    // and merge the sorted halves.
    let half = (List.length xs) / 2
    let left, right = split half xs
    merge comp (sort comp left) (sort comp right) 
```

现在尝试自然版本。在最好的情况下这将是 O(n)，但最好的情况是输入列表是反向排序的。

```
let rec sort' comp ls =

    // Define a helper function.  Streaks are stored in an accumulator.
    let rec helper accu = function
    | [] -> accu 
    | x::xs -> 
        match accu with
        // If we are not in a streak, start a new one
        | [] -> helper [x] xs 

        // If we are in a streak, check if x continues
        // the streak.
        | y::ys -> 
            if comp y x > 0 

            // x continues the streak so we add it to accu
            then helper (x::y::ys) xs

            // The streak is over. Merge the streak with the rest
            // of the list, which is sorted by calling our helper function on it.
            else merge comp accu (helper [x] xs)

    helper [] ls 
```

第二次尝试。在最好的情况下，这也是 O(n)，现在最好的情况是输入列表已经排序。我否定了比较功能。排序列表将以相反的顺序构建，因此您需要在最后反转它。

```
let rec sort'' comp ls =
    // Flip the comparison function
    let comp' = fun x y -> -1 * (comp x y)
    let rec helper accu = function
    | [] -> accu
    | x::xs -> 
        match accu with
        | [] -> helper [x] xs
        | y::ys -> 
            if comp' y x > 0 
            then helper (x::y::ys) xs
            else merge comp' accu (helper [x] xs)

    // The list is in reverse sorted order so reverse it.
    List.rev (helper [] ls) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-20T00:51:56.920

我不确定什么是自然合并排序，但是对于链表的合并排序，我是这样写的：

> [Java代码]

```
// Merge sort the linked list.
// From min to max.
// Time complexity = O(nlgn).
public static Node mergeSortLLFromMinToMax (Node head) {
    if (head == null || head.next == null) return head; // No need to sort.
    // Get the mid point of this linked list.
    Node prevSlower = head;
    Node slower = head;
    Node faster = head;
    while (faster != null && faster.next != null) {
        prevSlower = slower;
        slower = slower.next;
        faster = faster.next.next;
    }
    // Cut of the main linked list.
    prevSlower.next = null;

    // Do recursion.
    Node left = mergeSortLLFromMinToMax (head);
    Node right = mergeSortLLFromMinToMax (slower);

    // Merge the left and right part from min to max.
    Node currHead = new Node ();
    Node tempCurrHead = currHead;
    while (left != null && right != null) {
        if (left.data <= right.data) {
            // Add the elem of the left part into main linked list.
            tempCurrHead.next = left;
            left = left.next;
        } else {
            // Add the elem of the right part into main linked list.
            tempCurrHead.next = right;
            right = right.next;
        }
        tempCurrHead = tempCurrHead.next;
    }
    if (left != null) {
        // Add the remaining part of left part into main linked list.
        tempCurrHead.next = left;
        left = left.next;
        tempCurrHead = tempCurrHead.next;
    } else if (right != null) {
        // Add the remaining part of right part into main linked list.
        tempCurrHead.next = right;
        right = right.next;
        tempCurrHead = tempCurrHead.next;
    }

    return currHead.next;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-01-07T19:51:58.647

我使用 C# 对算法的非常原始的实现

```
public static class LinkedListSort
{
    public static DataStructures.Linear.LinkedListNode<T> Sort<T>(DataStructures.Linear.LinkedListNode<T> firstNode) where T : IComparable<T>
    {
        if (firstNode == null)
            throw new ArgumentNullException();

        if (firstNode.Next == null)
            return firstNode;

        var head = firstNode;
        var leftNode = head;
        int iterNum = 0;

        while (leftNode != null)
        {
            //Let's start again from the begining
            leftNode = head;
            iterNum = 0;
            DataStructures.Linear.LinkedListNode<T> tailNode = null;

            while (leftNode != null)
            {
                //Let's get the left sublist

                //Let's find the node which devides sublist into two ordered sublists
                var sentinelNode = GetSentinelNode(leftNode);
                var rightNode = sentinelNode.Next;

                //If the right node is null it means that we don't have two sublist and the left sublist is ordered already
                //so we just add the rest sublist to the tail
                if (rightNode == null)
                {
                    if (tailNode == null)
                        break;
                    tailNode.Next = leftNode;
                    break;
                }

                sentinelNode.Next = null;

                //Let's find the node where the right sublist ends
                sentinelNode = GetSentinelNode(rightNode);
                var restNode = sentinelNode.Next;
                sentinelNode.Next = null;

                DataStructures.Linear.LinkedListNode<T> newTailNode = null;

                //Merging of two ordered sublists   
                var mergedList = Merge(leftNode, rightNode, ref newTailNode);
                //If we're at the beginning of the list the head of the merged sublist becomes the head of the list
                if (iterNum == 0)                   
                    head = mergedList;                  
                else //add the                  
                    tailNode.Next = mergedList;                     

                tailNode = newTailNode;
                leftNode = restNode;
                iterNum++;
            }
            if (iterNum == 0)
                break;
        }
        return head;
    }

    /// <summary>
    /// Merges two ordered sublists   
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="aNode">Left part of sublist</param>
    /// <param name="bNode">Right part of sublist</param>
    /// <param name="tailNode">Tail node of the merged list</param>
    /// <returns>The result of merging</returns>
    private static DataStructures.Linear.LinkedListNode<T> Merge<T>(DataStructures.Linear.LinkedListNode<T> leftNode,                                                                       
                                                                    DataStructures.Linear.LinkedListNode<T> rightNode,
                                                                    ref DataStructures.Linear.LinkedListNode<T> tailNode) where T : IComparable<T>
    {
        var dummyHead = new DataStructures.Linear.LinkedListNode<T>();
        var curNode = dummyHead;

        while (leftNode != null || rightNode != null)
        {
            if (rightNode == null)
            {
                curNode.Next = leftNode;
                leftNode = leftNode.Next;
            }
            else if (leftNode == null)
            {
                curNode.Next = rightNode;
                rightNode = rightNode.Next;
            }
            else if (leftNode.Value.CompareTo(rightNode.Value) <= 0)
            {
                curNode.Next = leftNode;
                leftNode = leftNode.Next;
            }
            else
            {
                curNode.Next = rightNode;
                rightNode = rightNode.Next;
            }
            curNode = curNode.Next;
        }
        tailNode = curNode;
        return dummyHead.Next;
    }

    /// <summary>
    /// Returns the sentinel node
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="firstNode"></param>
    /// <returns></returns>
    private static DataStructures.Linear.LinkedListNode<T> GetSentinelNode<T>(DataStructures.Linear.LinkedListNode<T> firstNode) where T : IComparable<T>
    {
        var curNode = firstNode;

        while (curNode != null && curNode.Next != null && curNode.Value.CompareTo(curNode.Next.Value) <= 0)             
            curNode = curNode.Next;

        return curNode;
    }
} 
```

# c#-4.0 - Castle Windsor 3.0、服务和多重实现

> ID：10262603
> 
> 赞同：5
> 
> 时间：2012-04-21T20:14:16.917
> 
> 标签：c#-4.0, castle-windsor

在阅读和搜索到筋疲力尽的地步后，我觉得我可能需要一些指导。

这可能部分是因为 Castle Windsor 3.0 的引入，但是大多数博客文章、SO 问题和其他文档都明确依赖于我所看到的现在已弃用的代码。

所以：问题？

在我的应用程序中，这是一个为 MVC3 应用程序提供后端代码的 WCF 服务，我有多个层，其中一个为文件上传系统提供病毒扫描服务。

客户要求支持多个扫描服务，我自然答应了，每个扫描服务都实现了一个 IScanService 接口，因此：

```
public interface IScanService
{
    void Execute();
    ScanResult GetResult();
} 
```

因此，在 WCf 服务中，构造函数可能如下所示：

```
public McAfeeFileScanService(IScanService mcAfeeScanService)
    {
        _scanService = scanService;
    } 
```

如何确定注入的 IScanService 是 McAfeeScanService 或 NortonScanService 或其他实现类型的实现？

默认情况下，AFAIK Windsor 将提供第一个注册的实现，无论它是否属于 McAfeeScanService 类型。

我正在研究 ServiceOverrides，但似乎在 Windsor 3.0 中已弃用，取而代之的是 DependsOn(Dependency.OnComponenent()) [但我没有找到任何相关示例] 我还研究了类型化工厂设施和 IHandlerSelector ，但觉得这个（看似常见且可能很简单）任务需要一些指导。

谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T12:39:45.183

在 Windsor 3 中不推荐使用 ServiceOverride。您必须像这样使用 Dependency.OnComponent：

```
Component.For<ISerializer>().ImplementedBy<JsonSerializer>().Named("jsonSerializer"),
Component.For<WebConnectionAcceptor, IChannelManager>().ImplementedBy<WebConnectionAcceptor>().Named("webAcceptor"),
Component.For<ConnectionAcceptorProxy>().Named("webProxy").DependsOn(
         Dependency.OnComponent("connectionAcceptor", "webAcceptor"), 
         Dependency.OnComponent("serializer", "jsonSerializer")) 
```

OnComponent 中的第一个参数是绑定名称，第二个是组件名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T11:08:16.103

[在http://docs.castleproject.org/Default.aspx?Page=Inline-Dependencies&NS=Windsor&AspxAutoDetectCookieSupport=1](http://docs.castleproject.org/Default.aspx?Page=Inline-Dependencies&NS=Windsor&AspxAutoDetectCookieSupport=1)上查看城堡 Windsor wiki 上的第二个示例

它认为这就是您要寻找的东西:)

container.Register( Component.For().ImplementedBy() .DependsOn(ServiceOverride.ForKey("Logger").Eq("secureLogger")) );

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-21T03:19:28.110

我发布了一些非常类似的东西。我有两个接口实现，我希望 MVC 控制器使用我决定的其中一个实现。

在[文章中](http://nodogmablog.bryanhogan.net/2014/09/castlewindsor-chained-dependency/)，我解释了一种方法，但随附的源代码显示了另外两种方法。

希望这可以帮助。

# ruby-on-rails - rails，如何在“显示”操作时传递用户 ID

> ID：10262609
> 
> 赞同：1
> 
> 时间：2012-04-21T20:15:03.807
> 
> 标签：ruby-on-rails, forms, params, hidden-field

我在用户个人资料上，即路径是......

```
http://localhost:3000/users/2 
```

我有一个文本字段，因此当前用户（我）可以在他的个人资料页面上向用户 2 发送私人消息。

如何检索用户 ID 并将其传递到隐藏字段中？

```
<div><%= f.hidden_field :????, :value => ???? %></div> 
```

谢谢。隐藏标签字段在表单中。如果有帮助，这是表格

```
<%= form_for(current_user.microposts.build(params[:micropost])) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="field">
    <%= f.text_area :content, placeholder: "Send a private message" %>
  </div>
  <div><%= f.hidden_field :private, :value => "true" %></div>

  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

再次感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:42:17.957

我会尝试嵌套路由，例如

```
resources :users do
  resources :microposts
end 
```

然后使用

```
<%= form_for([current_user, @micropost])  do |f| %> 
```

我尽量避免通常在 rails 中出现隐藏字段，这通常意味着我错过了一个约定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:17:12.150

在您的控制器中，您将拥有：

`@user = User.find(params[:id])`

所以：

`<div><%= f.hidden_field :user_id, :value => @user.id %></div>`

# sql - 如果 B 列为 Null，如何从 A 列插入数据，如果 A 列为 Null，如何从 B 列插入数据

> ID：10262615
> 
> 赞同：3
> 
> 时间：2012-04-21T20:15:53.197
> 
> 标签：sql, sql-server-2008, tsql

我想我正在接近但不确定：

我有一个包含电子邮件地址、个人和工作的示例表。我正在尝试创建一个包含单个地址的新表。

然后插入一个电子邮件地址，例如：如果用户有工作电子邮件但没有个人电子邮件，则插入工作电子邮件，如果没有工作电子邮件，则插入个人电子邮件。

以下代码不起作用，但它只是为了显示我使用的许多变体中的一些：

使用示例数据库

去

```
CREATE TABLE USER_EMAIL(
 USER_NBR CHAR(1) NOT NULL
,EMAIL VARCHAR(30)NULL
)

GO

INSERT INTO USER_EMAIL(
 USER_NBR
,EMAIL
)

SELECT USER_NBR
,CASE WHEN EMAIL_ADDR IS NULL AND EMAIL_TYPE = 'Personal' THEN EMAIL_TYPE = 'Work' END EMAIL
,CASE WHEN EMAIL_ADDR IS NULL AND EMAIL_TYPE = 'Work'     THEN EMAIL_TYPE =  'Personal' END EMAIL
FROM EMAIL_DATA 
```

这是 EMAIL_DATA 的表：

```
USER_NBR   EMAIL_TYPE       EMAIL_ADDR
1          Personal 
2          Personal     user2personal@demo.com
3          Personal         user3personal@demo.com
4          Personal 
5          Personal         user5personal@demo.com
1          Work         user1work@demo.com
2          Work         user2work@demo.com
3          Work 
4          Work         user4work@demo.com
5          Work 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:25:54.720

这是一个使用示例`row_number`：

```
insert  user_email
        (user_nbr, email)
select  user_nbr
,       mail.email_addr
from    (
        select  user_nbr
        ,       email_addr
        ,       row_number() over (partition by user_nbr
                  order by
                  case 
                  when email_type = 'personal' then 1
                  when email_type = 'work' then 2
                  end) as rn
        from    email_data
        ) usr
where   usr.rn = 1 
```

由于只有两种电子邮件类型，因此您也可以使用`left join`两次：

```
insert  user_email
        (user_nbr, email)
select  user_nbr
,       coalesce(pers.email_addr, work.email_addr)
from    (
        select  distinct user_nbr
        from    email_data
        ) usr
left join 
        email_data as pers 
on      pers.user_nbr = usr.user_nbr
        and work.email_type = 'personal'
left join 
        email_data as work
on      work.user_nbr = usr.user_nbr
        and work.email_type = 'work' 
```

另一种使用以下方法查找首选电子邮件地址的方法`cross apply`：

```
insert  user_email
        (user_nbr, email)
select  user_nbr
,       mail.email_addr
from    (
        select  distinct user_nbr
        from    email_data
        ) usr
cross apply
        (
        select  top 1 *
        from    email_data mail
        where   mail.user_nbr = usr.user_nbr
                and mail.email_addr is not null
        order by
                case 
                when email_type = 'personal' then 1
                when email_type = 'work' then 2
                end
        ) mail 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T21:12:33.903

根据您的需求说明，每个用户在源中只有一种或另一种类型，听起来您可以简单地这样做：

```
INSERT INTO USER_EMAIL(USER_NBR, EMAIL_ADDR)
SELECT USER_NBR, EMAIL_ADDR
FROM EMAIL_DATA
WHERE EMAIL_ADDR IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:33:09.973

这会执行以下操作：如果`EMAIL_ADDR`为 null，它将查看同一个表并为同一用户搜索其他电子邮件类型的电子邮件。是你想要的吗？

```
INSERT INTO USER_EMAIL(
 USER_NBR
,EMAIL 
)
SELECT e.USER_NBR
     , EMAIL = COALESCE(e.EMAIL_ADDR
                    , (CASE e.EMAIL_TYPE
                        WHEN 'Work' THEN (SELECT TOP 1 EMAIL_ADDR  
                                      FROM EMAIL_DATA e1
                                      WHERE e1.USER_NBR=e.USER_NBR
                                      AND EMAIL_TYPE='Personal')
                        WHEN 'Personal' THEN (SELECT TOP 1 EMAIL_ADDR 
                                      FROM EMAIL_DATA e1
                                      WHERE e1.USER_NBR=e.USER_NBR
                                      AND EMAIL_TYPE='Work')
                    END))
FROM EMAIL_DATA e 
```

结果与您的样本数据：

```
USER_NBR    EMAIL
1           user1work@demo.com
2           user2personal@demo.com
3           user3personal@demo.com
4           user4work@demo.com
5           user5personal@demo.com
1           user1work@demo.com
2           user2work@demo.com
3           user3personal@demo.com
4           user4work@demo.com
5           user5personal@demo.com 
```

# c++ - SFML 中的 OpenGL 累积缓冲区？

> ID：10262621
> 
> 赞同：0
> 
> 时间：2012-04-21T20:16:22.790
> 
> 标签：c++, opengl, sfml

如何在 SFML 中启用 glAccum 缓冲区？默认情况下它似乎不存在（glGet(GL_ACCUM_BLUE_BIT) 返回 0）。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:15:11.593

不适用于 SFML 1.6 或 2.0。而且我不会在他们很快添加这样的功能时屏住呼吸。他们[对允许 sRGB 帧缓冲区的简单建议非常抗拒。](https://github.com/LaurentGomila/SFML/issues/175)

我建议切换到[Allegro 5](http://alleg.sourceforge.net/)，因为它们提供累积缓冲区支持。

# visual-studio - 在 Visual Studio 中以发布模式构建启动速度极慢

> ID：10262622
> 
> 赞同：1
> 
> 时间：2012-04-21T20:16:48.093
> 
> 标签：visual-studio, performance, build, release

我有一个包含大约 20 个 C# 项目的小解决方案。调试构建大约需要 10 秒。但是，发布构建需要 1 分 10 秒。在发布版本的第一分钟，Visual Studio 没有响应并且似乎什么也没做。没有 CPU 活动，只有少量磁盘活动，并且没有出现编译器输出。我可能会怀疑项目自定义预构建步骤，但它甚至没有达到这一点。一旦它开始编译项目并且我看到构建输出，一切都会以正常速度进行 - 就像调试一样。

有人遇到过这种情况么？

# javascript - 如何发送要在 CSS 属性中使用的 Jquery var

> ID：10262625
> 
> 赞同：1
> 
> 时间：2012-04-21T20:17:15.180
> 
> 标签：javascript, jquery, css

需要知道如何在 CSS 属性中使用 Jquery var，我在网上搜索过，但没有找到任何与我想要的答案相关的答案，而且我也不是最能解决这个问题的程序员。没用过jquery！

代码查询：

```
 <script>
//find window height
          var winHeight = $(window).height(); 
          alert(winHeight);//=692
$('menuHolder').css(height(), winHeight);

 </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:26:05.407

你的代码有很多问题：

1.  `menuHolder`不是有效的 html 标记。

2.  `height()`是一个我无法想象应该返回字符串的函数调用`"height"`。

3.  文档完全加载后，您似乎没有运行它？

假设您的 html 如下所示：

```
<div id="menuHolder">This is the menu holder</div> 
```

请注意，相关标签的 id 属性必须设置为“menuHolder”。如果您有多个 menuHolder，则应使用该`class`属性。

那么你的js应该是：

```
$(function(){
   $('#menuHolder').css("height", $(window).height());
}); 
```

[http://jsfiddle.net/93hFW/](http://jsfiddle.net/93hFW/)

或者

```
$(function(){
   $('#menuHolder').height($(window).height());
}); 
```

[http://jsfiddle.net/93hFW/1/](http://jsfiddle.net/93hFW/1/)

如果您`class`按照上面的建议使用属性，那么您应该使用`.`（点）而不是作为`#`jQuery 选择器的前缀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:18:38.310

你想设置元素的高度吗？

```
$('menuHolder').css("height", winHeight); 
```

会更好

```
$('menuHolder').height(winHeight); 
```

# ruby-on-rails-3.2 - 未定义的局部变量或方法“页面”

> ID：10262626
> 
> 赞同：1
> 
> 时间：2012-04-21T20:17:16.130
> 
> 标签：ruby-on-rails-3.2

我正在使用导轨。我使用以下命令执行 ruby​​ 脚本。它给出了一个错误。会有什么问题？如果我删除“page.should have_content('Demo App')”，那么它可以正常工作！

```
 bundle exec rspec spec/requests/test_pages_spec.rb 
```

* * *

```
 Failures:

1) Test pages Home page should have the content 'Demo App'
 Failure/Error: page.should have_content('Demo App')
 NameError:
   undefined local variable or method `page' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_1:0xa60d538>
 # ./spec/requests/test_pages_spec.rb:9:in `block (3 levels) in <top (required)>'

Finished in 0.27788 seconds
1 example, 1 failure

Failed examples:

rspec ./spec/requests/test_pages_spec.rb:7 # Test pages Home page should have the content 'Demo App' 
```

test_pages_spec.rb 如下：

```
require 'spec_helper'

describe "Test pages" do

describe "Home page" do

   it "should have the content 'Demo App'" do
    visit '/test_pages/home'
    page.should have_content('Demo App')
   end
 end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:52:47.383

我已经解决了这个问题。如果我同时使用 webrat 和 capybara，那么我看不到正确的结果。所以我必须从 Gemfile 中删除**gem 'webrat'**并输入**bundle update**并使用以下命令，问题就解决了！

```
bundle exec rspec spec/requests/test_pages_spec.rb 
```

# javascript - 如何修改 jQuery 移动历史后退按钮行为

> ID：10262629
> 
> 赞同：13
> 
> 时间：2012-04-21T20:17:35.713
> 
> 标签：javascript, django, jquery-mobile, browser-history

我将首先进行一些研究，但是没有解决方案可以解决看起来应该是简单的 JQM 修改的问题。

我有一个葡萄酒评论网络应用程序，它具有以下视图用户流程：http: [//5buckchuck.com/](http://5buckchuck.com/)

葡萄酒类型 > 酒单 > 葡萄酒详情 > 葡萄酒评论（通过 django 重定向回） > 葡萄酒详情从评论更新

我想要发生的是当用户按下后退按钮时它应该回到酒单。当前发生的是 Wine Detail 视图被重新加载。需要按三下才能回到酒单。:-(

我解决这个问题的想法有两个：

1.  如果历史堆栈中的最后一项是 Wine Review，则拼接历史堆栈中的最后 3 个项目。我很难自省最后一个历史对象以获取 pageURL。我觉得这个解决方案有点太脆弱了。

    ```
    var last_hist = $.mobile.urlHistory.getActive();
    last_hist.data.pageURL; 
    ```

2.  第二个想法是覆盖后退按钮的行为，以便 Wine Detail 视图中的后退按钮始终返回到 Wine 列表视图

    ```
    $('div#wine_detail').live('pageshow',function(event, ui){      
      $("a.ui-btn-left").bind("click", function(){
        location.replace("/wines/{{wine.wine_type}}/#");
      });   
    }); 
    ```

可能有更好的方法可以做到这一点，但我有点没有想法。

更新：所以我继续破解这个，结果有点微不足道。我发现这是我基本上需要工作的：`window.history.go(-3)`

从控制台它完全符合我的需要。

所以我尝试将它绑定到后退按钮，如下所示：

```
$('div#wine_detail').live('pageshow',function(event, ui){
  var last = $.mobile.urlHistory.stack.length - 1;
  var last_url = $.mobile.urlHistory.stack[last].url;
  var review_url = /review/g;
   if (last_url.match(review_url) )
     {
       $('div#wine_detail a.ui-btn-left').bind( 'click', function( ) {  
         console.log("click should be bound and going back in time...")
         window.history.go(-2);
         });
   }
   else
   {
     console.log('err nope its: ' + last_url);
   }
 }); 
```

没有骰子，有什么东西打断了交易……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T08:22:48.247

我不希望与 urlHistory 拼接/弹出/推送。如何在 pagebeforechange 上重定向，如下所示：

```
$(document).on("pagebeforechange", function (e, data) {

    var overrideToPage;

    // some for-loop to go through the urlHistory TOP>DOWN
    for (var i = $.mobile.urlHistory.activeIndex - 1; i >= 0; i--) {
        // this checks if # = your target id. You probably need to adapt this;
        if ($.mobile.urlHistory.stack[i].url = $('#yourPageId').attr('id')) {
            // save and break
            overrideToPage = $.mobile.urlHistory.stack[i].url;
            break;
        }
        // set new Page
        data.toPage = overrideToPage;
    }
}); 
```

这将捕获您的后退按钮 changePage 调用并重定向到您想要的页面。当然，您也可以直接设置*data.toPage = winelist*。

我只对#internal 页面进行此操作，但使用 winelist.html 等进行设置并不难。

[有关更多信息，请查看 JQM文档](http://jquerymobile.com/test/docs/api/events.html)中的事件页面

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T11:57:34.227

为什么页面的标题部分没有后退按钮？像这样的东西：

```
<div data-role="header">
    <a data-direction="reverse" data-role="button" href="#winelist" data-icon="back">Back</a>
    <h1>Wine Detail</h1>
</div><!-- /header --> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-09T21:10:01.650

我最近也为此苦苦挣扎。在考虑之后，我意识到我可以重写我的 JQM 应用程序，以便为那些我不希望出现在我的历史记录中的页面使用弹出“窗口”。这最终是一个比浏览器历史记录更容易和更清洁的修复。

现在用户可以直观地使用浏览器的后退按钮，而我不必编写应用程序后退按钮。

您唯一需要确保的是弹出窗口本身不会进入浏览器历史记录，因此请确保将“历史记录”选项设置为 false，如下所示：

```
$('#some_popup').popup( { history: false } ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-05T23:00:27.123

好的，所以解决方案接近我发布的更新。以前的解决方案的问题是有很多东西绑定到“后退”按钮。虽然我的新绑定操作有时可能会起作用，但其他操作也会发生，我尝试了`unbind()`但仍然没有工作。

我的解决方案是有点烟雾和镜子。我检查上一页是否是评论页面，如果是，我将旧的后退按钮换成新的人造按钮，并带有历史后退步骤，如下所示：

```
$('div#wine_detail').live('pageshow',function(event, ui){
  var last = $.mobile.urlHistory.stack.length - 1;
  var last_url = $.mobile.urlHistory.stack[last].url;
  var review_url = /review/g;
  if (last_url.match(review_url) )
    {
      $('a.ui-btn-left').replaceWith('<a href="" id="time_machine" class="ui-btn-left ui-btn ui-btn-icon-left ui-btn-corner-all ui-shadow ui-btn-up-a" data-icon="arrow-l"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Back</span><span class="ui-icon ui-icon-arrow-l ui-icon-shadow"></span></span></a>');

      $('#time_machine').bind( 'click', function( ) {  
        console.log("click should be bound and going back in time...")
        window.history.go(-3);
        });
    }
  else
    {
      console.log('err nope its: ' + last_url);
    } 
```

它看起来完全一样，没有人更聪明。它可能可以通过使用 jQm 方法得到改进，`pagebeforeshow`因此用户永远看不到交换。希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-20T10:06:03.167

如果您希望关闭按钮指向任意（不是最后一个）页面，您也可以先更改为目标页面，然后再打开对话框。因此对话框中的关闭按钮将打开目标页面。

```
// First: change to the target page
$.mobile.changePage('#target_page'); 
```

然后像这样打开对话框。

```
// Second: change to the dialog 
window.setTimeout(
   // for some reason you have to wrap it in a timeout  
   function(){
      $.mobile.changePage('#dialog');
   },
   1
); 
```

现在您可以打开对话框，关闭按钮将打开#target_page。

好处：

*   解决方案适用于单个对话框，而不是从所有对话框中删除所有关闭按钮
*   在单点代码上无缝集成
*   不需要历史操作

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-26T02:47:09.973

我之前在使用 jquery mobile 时看到过类似的问题，并且在文档中得到了解决。在“页面开头”设置 Javascript 时，请使用 pageinit 而不是 ready 或在您的情况下使用 pageshow。我认为这将解决您的问题，而无需解决历史队列。

# bash - 使用管道邮件命令隐藏标准输出

> ID：10262638
> 
> 赞同：2
> 
> 时间：2012-04-21T20:18:31.450
> 
> 标签：bash, shell

我试图隐藏 stdout 和 stderr 以防止显示并且无法正确使用语法。

每当有 root 登录时，我在 root 的 .profile 中有一个衬线给我发送电子邮件：

```
netstat -antp | grep ESTABLISHED | grep -v 127.0.0.1 | mail -s "alert: root access on server" email@address.com 2>&1>/dev/null & 
```

问题是邮件发送后，我在标准输出上得到了这个：

```
[1]+  Done  mail -s "alert: root access on server" email@address.com 2>&1 > /dev/null 
```

我不希望它在发送邮件时在命令行上显示任何内容，我错过了什么？我也试过这个，但没有运气：

```
mail -s "alert: root access on server" email@address.com > /dev/null 2>&1 & 
```

我必须在最后加上“&”，否则它会在登录前暂停约 30 秒。

关于如何发送电子邮件、隐藏标准输出和标准错误以及将其作为后台程序运行的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:32:23.750

(netstat -antp | grep ESTABLISHED | grep -v 127.0.0.1 | mail -s "alert: root access on server" email@address.com &)

# asp.net-mvc-3 - IoC 的泛型关注点分离

> ID：10262641
> 
> 赞同：4
> 
> 时间：2012-04-21T20:18:47.003
> 
> 标签：asp.net-mvc-3, architecture, inversion-of-control, unity-container

**我的项目组织如下**

*   ASP.NET MVC 3 Web 应用程序
*   Domain.Core - 接口 [库]
*   Domain.Core.Entity - 实体 [库]
*   Infrastructure.Core - 接口的实现 [库]
*   Infrastructure.IoC - 使用 Unity 作为实现控制反转的手段 [库]

**困境如下：**

如果我要向我的 Domain.Core 中的接口添加通用方法，如下所示，我会收到一个编译错误，要求我在 Infrastructure.IoC 项目中添加对 Domain.Core.Entity 的引用。

```
T Get<T>(int Id) where T : EntityBase, new(); 
```

T 可以是继承自 EntityBase 的类 EntityBase 或 Blog，也可以是其他一些都继承自 EntityBase 的实体。这个想法是根据提供的子类返回一个实体，以便子类加载所有实现 EntityBase 的类所需的默认数据。

**所以，问题有两个方面：**

1.  在 IoC 项目中不引用 Domain.Core.Entity 项目并保持清洁会更好吗？

2.  我将如何实现上述目标而不必弄乱参考文献的清洁度？

谢谢你。

**注意：**我在这里浏览了一些问题来搜索这个主题，但没有看到任何问题。如果您确实看到它，请告诉我，我将删除此问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T08:33:11.107

使用依赖注入，最好有一个*组件*负责组成所有不同的协作者。这是Nat Pryce 的[Third-Party Connect概念中的](http://www.natpryce.com/articles/000783.html)*第三方*，或者我称之为[Composition Root](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)的东西。在上面概述的架构中，这个责任似乎落在了 Infrastructure.IoC 身上，因此，鉴于这种结构，将 Infrastructure.IoC 的引用添加到 Domain.Core.Entity 并没有错——事实上，如果这样做，我会觉得更令人惊讶并非如此。

然而，作为一个整体的反馈，我认为值得考虑拥有一个单独的 Infrastructure.IoC 库实际上会带来什么好处。该应用程序（ASP.NET MVC 应用程序）的入口点将需要对 Infrastructure.IoC 的引用，它必须再次引用*所有*库才能组合它们。因此，ASP.NET MVC 应用程序最终会间接引用所有其他库，您不妨合并这两个库。

（从技术上讲，您可以通过依赖某种后期绑定机制（例如 XML 配置或约定优于配置）来解耦各种库，但 Infrastructure.IoC 的概念责任将保持不变。）

有关更多信息，您可能需要阅读此答案：[Ioc/DI - 为什么我必须在入口应用程序中引用所有层/组件？](https://stackoverflow.com/questions/9501604/ioc-di-why-do-i-have-to-reference-all-layers-assemblies-in-entry-application/9503612#9503612)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-21T21:50:52.637

为什么要从 Domain.Core.Entity 中拆分 Domain.Core？为什么要从 Infrastructure.IoC 中拆分 Infrastructure.Core？

我认为您可以摆脱 3 个项目结构：

1.  域 - 不依赖于其他 2 个项目。可能包含实体和接口。
2.  基础设施 - 包含接口实现和 Unity 容器。仅取决于域项目。
3.  MVC - 取决于域和基础设施。

如果您担心针对具体类而不是接口进行编程，请为基础设施项目中的类提供不同的命名空间。如果有的话，您应该只需要使用该命名空间几次（在 Global.asax 或引导程序中）。

这样就很清楚哪些项目依赖于什么。由于您使用的是统一，因此这是一种[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)。如果您稍后发现应该将基础架构或域拆分为多个项目，则可以重构。

***IMO，只有当您的域项目中***有 System.Web.Mvc 或 Microsoft.Practices.Unity 之类的引用时，依赖项才会变得混乱或不干净。就像马克在他的回答中所说的那样，你的“洋葱”的外层将依赖于内层，你无法避免这种情况。但是尽量让该领域专注于其核心业务，尽可能避免在 UI 中如何使用它的细节。

# python - Where does Flask store uploaded files?

> ID：10262642
> 
> 赞同：5
> 
> 时间：2012-04-21T20:18:48.893
> 
> 标签：python, file-upload, flask, werkzeug

Where does Flask store uploaded files before the application code has a chance to save the file? Unless I've missed something it doesn't appear to be showing up in the /tmp directory, which is what I'd have expected, and obviously it's not showing up in the directory I've specified in `app.config['UPLOAD_DIRECTORY']`. It's not storing it in memory, is it?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-21T21:01:40.357

Did you check [the documentation](http://flask.pocoo.org/docs/patterns/fileuploads/#improving-uploads)? It seems pretty clear:

> So how exactly does Flask handle uploads? Well it will store them in the webserver’s memory if the files are reasonable small otherwise in a temporary location (as returned by **`tempfile.gettempdir()`**)

# php - 是否可以防止特定元字段在 wordpress 中更新？

> ID：10262644
> 
> 赞同：0
> 
> 时间：2012-04-21T20:19:10.853
> 
> 标签：php, arrays, wordpress, custom-fields

我想阻止 wordpress 保存年、月和日数组。我使用 JavaScript 将隐藏输入中的 3 合为一个值，因此我不需要将 3 存储在数据库中。我该怎么做？

```
$meta_box = array(
    'id' => 'global-releasedate',
    'title' => 'Releasedate',
    'page' => 'films',
    'context' => 'normal',
    'priority' => 'high',
    'fields' => array(
        array(
            'name' => '',
            'id' => $prefix . 'airdate',
            'type' => 'hidden',
            'std' => ''
        ),

        array(
            'name' => 'Year',
            'id' => $prefix . 'year',
            'type' => 'select',
            'options' => $years,
        ),

         array(
            'name' => 'Month',
            'id' => $prefix . 'month',
            'type' => 'select',
            'options' => $months,
        ),

          array(
            'name' => 'Day',
            'id' => $prefix . 'day',
            'type' => 'select',
            'options' => $days,
        ),
    )); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T16:13:11.783

解决方案实际上是删除它们或在functions.php 文件中注释它们。如果您删除它们，它们不会从帖子中删除，它们将不再对用户可见，这正是您所需要的。

# java - 检索手机上已安装应用程序所需功能的列表

> ID：10262651
> 
> 赞同：0
> 
> 时间：2012-04-21T20:20:29.670
> 
> 标签：java, android, installed-applications

我可以通过包管理器在我的代码中获取已安装应用程序的列表：

```
public ArrayList<InstalledAppData> importInstalledAppsData(){
        ArrayList<InstalledAppData> appList=new ArrayList<InstalledAppData>();
        PackageManager pkgManager=getApplicationContext().getPackageManager();
        List<ApplicationInfo> packages=getInstalledApplicationsList(pkgManager);
        String deviceId=Util.getDeviceId(getApplicationContext());

        for (ApplicationInfo packageInfo : packages) {
        String packageName=packageInfo.packageName;
        String appName="";
        String appFile = packageInfo.sourceDir;
        long installTime = new File(appFile).lastModified();
        String status="s";
        if ((packageInfo.flags & ApplicationInfo.FLAG_SYSTEM) == 1) {
                appName = (String) pkgManager.getApplicationLabel(packageInfo);
            }
            else {
            appName = (String) pkgManager.getApplicationLabel(packageInfo);
        }                
        InstalledAppData data=new InstalledAppData(deviceId, packageName, appName, installTime, status);
            appList.add(data);

        }
        return appList;
    } 
```

现在我想识别手机上当前启用了定位服务的所有已安装应用程序。我该怎么做？提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:23:17.363

> 我怎样才能做到这一点？

你不能。Android SDK 无法让一个应用程序监视另一个应用程序对`LocationManager`.

您可以注册`PASSIVE_PROVIDER`以查看是否*有人*碰巧请求位置更新，但您不能将其绑定到特定应用程序。

# oracle11g - 当存在按引用分区的表时，无法导入由数据泵创建的文件

> ID：10262652
> 
> 赞同：1
> 
> 时间：2012-04-21T20:20:31.353
> 
> 标签：oracle11g, data-migration, database-partitioning, datapump

我们正在使用 Oracle 11g R2 开发一个大型项目。我们的数据库由 170 多个表组成，其中包含大量的分区引用（Oracle 11 的一个特性）。

有时我们想将我们的数据库移植到另一个数据库，因此我们使用数据泵创建了一个转储文件，当导出数据时一切正常，但我们无法将其导入另一个数据库。

导入正确的表时，正常导入，但不导入引用表的分区。

通过引用表创建分区时，应在`create table`语句中创建外键（基于哪个分区），但似乎数据泵在脚本末尾创建了所有外键。

我不敢相信 Oracle 人忘记在 Oracle 11g 中升级数据泵。有谁知道如何解决这个问题？

**更新 1：** 这些是我们使用的导入和脚本脚本：

出口：

```
declare
    h1   NUMBER;
begin
    h1 := dbms_datapump.open (operation => 'EXPORT', job_mode => 'SCHEMA', job_name => 'EXPORT000185', version => 'COMPATIBLE'); 
    dbms_datapump.set_parallel(handle => h1, degree => 1); 
    dbms_datapump.add_file(handle => h1, filename => '910202.LOG', directory => 'DATA_PUMP_DIR', filetype => 3); 
    dbms_datapump.set_parameter(handle => h1, name => 'KEEP_MASTER', value => 0); 
    dbms_datapump.metadata_filter(handle => h1, name => 'SCHEMA_EXPR', value => 'IN(''PAYESH_ACCOUNTING'',''PAYESH_CORE'',''PAYESH_CRM'',''PAYESH_LIFE'',''PAYESH_SECURITY'')'); 
     dbms_datapump.add_file(handle => h1, filename => '910202_db4.DMP', directory => 'DATA_PUMP_DIR', filetype => 1); 
    dbms_datapump.set_parameter(handle => h1, name => 'INCLUDE_METADATA', value => 1); 
    dbms_datapump.set_parameter(handle => h1, name => 'DATA_ACCESS_METHOD', value => 'AUTOMATIC'); 
    dbms_datapump.set_parameter(handle => h1, name => 'ESTIMATE', value => 'BLOCKS'); 
    dbms_datapump.start_job(handle => h1, skip_current => 0, abort_step => 0); 
    dbms_datapump.detach(handle => h1); 
end; 
```

进口：

```
declare
    h1   NUMBER;
begin
    h1 := dbms_datapump.open (operation => 'IMPORT', job_mode => 'SCHEMA', job_name => 'IMPORT000189', version => 'COMPATIBLE'); 
    dbms_datapump.set_parallel(handle => h1, degree => 1); 
    dbms_datapump.add_file(handle => h1, filename => '910228.LOG', directory => 'DATA_PUMP_DIR', filetype => 3); 
    dbms_datapump.set_parameter(handle => h1, name => 'KEEP_MASTER', value => 0); 
    dbms_datapump.add_file(handle => h1, filename => '910128.DMP', directory => 'DATA_PUMP_DIR', filetype => 1); 
    dbms_datapump.metadata_filter(handle => h1, name => 'SCHEMA_EXPR', value => 'IN(''PAYESH_ACCOUNTING'',''PAYESH_CORE'',''PAYESH_CRM'',''PAYESH_LIFE'',''PAYESH_SECURITY'')'); 
    dbms_datapump.set_parameter(handle => h1, name => 'INCLUDE_METADATA', value => 1); 
    dbms_datapump.set_parameter(handle => h1, name => 'DATA_ACCESS_METHOD', value => 'AUTOMATIC'); 
    dbms_datapump.set_parameter(handle => h1, name => 'SKIP_UNUSABLE_INDEXES', value => 0); 
    dbms_datapump.start_job(handle => h1, skip_current => 0, abort_step => 0); 
    dbms_datapump.detach(handle => h1); 
end; 
```

**更新 2：** 我们发现问题仅存在于跨模式的外键分区上。

所以问题已经存在，有没有办法通过模式一起导出/导入具有跨模式分区的表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T04:05:19.850

我能够重现您的问题。当我使用命令行 IMPDB 时，它给了我一个更有用的错误消息：

```
ORA-39083: Object type TABLE:"SCHEMA2"."CHILD_TABLE" failed to create with error:
ORA-00942: table or view does not exist 
```

如果您在 My Oracle Support 上查找这些内容，您会发现错误 8477142。据说该问题已在 11.2.0.2 中修复。

# php - 返回随机行而不使用ID，MySQL

> ID：10262653
> 
> 赞同：1
> 
> 时间：2012-04-21T20:20:34.147
> 
> 标签：php, mysql, database, random

我正在寻找一种更好的方法来做到这一点：

```
SELECT * FROM $tbl_name WHERE id >= (SELECT FLOOR( MAX(id) * RAND()) FROM $tbl_name ) ORDER BY id LIMIT 1; 
```

**它很慢而且不是很随机，每 10 个左右的查询我都会得到相同的结果。**

这会从表中选择一个随机行，而不考虑其 ID。

到目前为止，我有这个：

```
// Get amount of rows in database
$result = mysql_query("SELECT * FROM $tbl_name");
$num_rows = mysql_num_rows($result);

// Generate random number
$random_row = rand(1, $num_rows); 
```

但我不知道如何获得某一行。

我不是那意思

```
SELECT * FROM $tbl_name WHERE id = $random_row 
```

因为我的数据库在 ID 列中有间隙，所以它有时会失败。

有没有人有脚本可以从 MySQL 数据库中获取随机结果而无需回复 ID 并且速度非常快？（数据库包含大约 20000 行）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:22:36.627

```
SELECT * FROM $tbl_name WHERE 1 ORDER BY RAND() LIMIT 1; 
```

20,000 行其实不算多，上面的应该够快了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:33:27.713

Juhana 说得对：“ORDER BY RAND() LIMIT 1”，当然 20k 并没有那么多。其他选项将与子选择一起使用：SELECT [fields] FROM myTable, (SELECT FLOOR(MAX(myTable.id) * RAND()) AS randId FROM myTable) AS someRandId WHERE myTable.id = someRandId.randId

[此处](http://forums.mysql.com/read.php?132,185266,219422#msg-219422)讨论 （请避免选择 * 不必要时）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T13:36:47.943

经过对阿迪发送的链接的评论进行一些搜索后，我找到了一个不错的解决方案。

```
SELECT * FROM $tbl_name T JOIN (SELECT CEIL(MAX(ID)*RAND()) AS ID FROM $tbl_name) AS x ON T.ID >= x.ID LIMIT 1; 
```

来源：wanderr.com/jay/order-by-slow/2008/01/30

似乎非常快而且非常随机！

# iphone - 可以存储在 NSUserDefaults 中的对象的最大大小

> ID：10262654
> 
> 赞同：13
> 
> 时间：2012-04-21T20:20:42.273
> 
> 标签：iphone

谁能告诉我 NSUserDefaults 的最大大小。表示我们可以存储在 userdefaults 中的对象或原语。例如 10 MB 等。

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-21T20:30:50.550

不，除了设备本身的存储容量之外，NSUserDefaults 没有大小限制。

见[NSUserDefaults 存储大小容量](https://discussions.apple.com/thread/1763096?start=0&tstart=0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:23:15.237

我不知道确切的值，但是 NSUserDefaults 是用来存储少量数据的，我认为最大值是千字节的数量级。

如果您想存储更大的属性列表，请考虑将它们存储在自己的文件中。

# ruby-on-rails - 如何为嵌套资源使用复数名称？

> ID：10262659
> 
> 赞同：2
> 
> 时间：2012-04-21T20:21:06.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, routes

我正在使用 Ruby on Rails v3.2.2，我想为嵌套资源使用复数名称。也就是说，在我的`config/routes.rb`我有（注意：“类别”和“文章”是示例资源）：

```
resources :categories do
  resources :articles do
    collection do
      get  'one'
      post 'two'
      put  'three'
    end
    member do
      get  'four'
      post 'five'
      put  'six'
    end
  end
end 
```

上述语句生成以下内容：

```
$ rake routes
  one_category_articles GET    /categories/:category_id/articles/one(.:format)      articles#one
  two_category_articles POST   /categories/:category_id/articles/two(.:format)      articles#two
three_category_articles PUT    /categories/:category_id/articles/three(.:format)    articles#three
  four_category_article GET    /categories/:category_id/articles/:id/four(.:format) articles#four
  five_category_article POST   /categories/:category_id/articles/:id/five(.:format) articles#five
   six_category_article PUT    /categories/:category_id/articles/:id/six(.:format)  articles#six
      category_articles GET    /categories/:category_id/articles(.:format)          articles#index
                        POST   /categories/:category_id/articles(.:format)          articles#create
   new_category_article GET    /categories/:category_id/articles/new(.:format)      articles#new
  edit_category_article GET    /categories/:category_id/articles/:id/edit(.:format) articles#edit
       category_article GET    /categories/:category_id/articles/:id(.:format)      articles#show
                        PUT    /categories/:category_id/articles/:id(.:format)      articles#update
                        DELETE /categories/:category_id/articles/:id(.:format)      articles#destroy
             categories GET    /categories(.:format)                                categories#index
                        POST   /categories(.:format)                                categories#create
           new_category GET    /categories/new(.:format)                            categories#new
          edit_category GET    /categories/:id/edit(.:format)                       categories#edit
               category GET    /categories/:id(.:format)                            categories#show
                        PUT    /categories/:id(.:format)                            categories#update
                        DELETE /categories/:id(.:format)                            categories#destroy 
```

我想更改我的`config/routes.rb`so 中的语句以生成以下*仅*用于“部分”的*复数*名称的路由器（也就是说，我想分别使用/而不是/ ）：**`category_article`*`categories_article``categories_articles``category_article``category_articles`*

 *```
$ rake routes
# Note: I marked changes from the previous outputting with '=>'.
=>   one_categories_articles GET    /categories/:category_id/articles/one(.:format)      articles#one
=>   two_categories_articles POST   /categories/:category_id/articles/two(.:format)      articles#two
=> three_categories_articles PUT    /categories/:category_id/articles/three(.:format)    articles#three
=>   four_categories_article GET    /categories/:category_id/articles/:id/four(.:format) articles#four
=>   five_categories_article POST   /categories/:category_id/articles/:id/five(.:format) articles#five
=>    six_categories_article PUT    /categories/:category_id/articles/:id/six(.:format)  articles#six
=>       categories_articles GET    /categories/:category_id/articles(.:format)          articles#index
                             POST   /categories/:category_id/articles(.:format)          articles#create
        new_category_article GET    /categories/:category_id/articles/new(.:format)      articles#new
       edit_category_article GET    /categories/:category_id/articles/:id/edit(.:format) articles#edit
            category_article GET    /categories/:category_id/articles/:id(.:format)      articles#show
                             PUT    /categories/:category_id/articles/:id(.:format)      articles#update
                             DELETE /categories/:category_id/articles/:id(.:format)      articles#destroy
                  categories GET    /categories(.:format)                                categories#index
                             POST   /categories(.:format)                                categories#create
                new_category GET    /categories/new(.:format)                            categories#new
               edit_category GET    /categories/:id/edit(.:format)                       categories#edit
                    category GET    /categories/:id(.:format)                            categories#show
                             PUT    /categories/:id(.:format)                            categories#update
                             DELETE /categories/:id(.:format) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T06:42:10.333

如果您对提供的助手不满意，那么您可以使用魔法：

```
<%= link_to 'One', [:one, @category, Article] %>
# /categories/123/articles/one

<%= link_to 'Four', [:four, @category, @article] %>
# /categories/123/articles/456/four

<%= link_to 'Edit the article', [:edit, @category, @article] %>
# /categories/123/articles/456/edit

<%= link_to 'All articles for the category', [@category, Article] %>
# /categories/123/articles 
```

可以使用完全相同的方法来指定帮助程序的`:url`选项`form_for`。

我希望你明白了！

PS 注意使用类（like `Article`）表示您想查看所有记录，使用模型实例（like `@article`）表示您将要看到一篇文章。*

# javafx-2 - 如何在 JavaFX 2 应用程序中正确使用 Weld？

> ID：10262660
> 
> 赞同：3
> 
> 时间：2012-04-21T20:21:07.940
> 
> 标签：javafx-2, jboss-weld

我试图让 Weld 在我的 JavaFX 2 (SE) 应用程序中工作（或者我应该在 Weld 中说 JavaFX？）。我有响应用户交互的控制器。现在我想将我的服务（例如数据库服务）注入到这些控制器中。

使用 Weld 这应该很简单：

```
@Inject
private MyService service; 
```

现在为了初始化 Weld，有三个选项。
**选项1）**

```
public void main(@Observes ContainerInitialized event) {
    launch(); // start JavaFX
} 
```

**选项 2)**

```
public static void main(final String[] args) {
    new StartMain(args).go();
    launch(args);
} 
```

**选项 3)**

```
public static void main(final String[] args) {
    final WeldContainer weld = new Weld().initialize();
    service = weld.instance().select(MyService.class).get();
    launch(args);
} 
```

选项 1 和 2 在我的控制器中导致 NullPointerExceptions，因为在带注释的注入点处没有注入任何内容。只有选项 3 有效，但这并不是我真正需要的，因为我不希望该服务出现在我的主应用程序类中，而是在我的 JavaFX 控制器中。使用选项 3，我必须以某种方式将初始化的服务传递给我的控制器类，在这种情况下，我不需要 Weld。那么如何将服务 bean 注入 JavaFX 控制器呢？不幸的是，我没有找到关于我的问题的文档。

也许有人已经积累了使用 Weld 和 JavaFX 的经验，可以帮助我。

**更新**

[我在Weld 讨论论坛上](https://community.jboss.org/message/732768)写下了我的一些努力，但不幸的是我没有得到答复。在我看来 Weld 不适用于 JavaFX。我想我必须使用好的旧设置器将我的服务插入到我的控制器中（请参阅论坛以获取解决方案）。

**更新 2**

我发现了[一篇关于 Weld 和 JavaFX 2](http://blog.matthieu.brouillard.fr/2012/08/fxml-javafx-powered-by-cdi-jboss-weld_6.html)的博客。我还没有尝试过这个解决方案，但我认为它对其他程序员很有用。

# php - 如何找出 crypt() 在您的机器上使用的算法？

> ID：10262663
> 
> 赞同：8
> 
> 时间：2012-04-21T20:21:26.423
> 
> 标签：php, hash, mamp

我不确定 crypt() 在散列时使用哪种算法。我查看了 PHP 手册，但它只是说它使用了任何可用的东西。但是我怎么知道它使用的是哪一个，如果它确实使用了一个，如何告诉它使用哪一个？我目前正在使用 MAMP 作为我的开发环境，但我认为必须有一种方法可以通过 PHP 中的语句进行查找。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-21T20:48:51.650

您将算法指定为盐字符串的一部分。例如，从`$2a$`给你一个 Blowfish 密码开始。如果机器不支持您尝试使用的算法，您将不会得到有意义的结果。您可以尝试通过检查一些预定义的常量来提前找出支持哪些算法，例如`CRYPT_BLOWFISH`，尽管我注意到这些常量`CRYPT_SHA256`并不`CRYPT_SHA512`总是被定义，至少在 PHP 5.2 上是这样。从 PHP 5.3 开始，PHP 拥有自己的算法实现，因此与 PHP 5.2 及更早版本一样，系统在 PHP 编译时可用的内容并不重要。PHP 5.2 的 Suhosin 补丁据称至少添加了 Blowfish，但它的实现似乎与 PHP 5.3 中使用的补丁不兼容。

该[函数的](http://us2.php.net/manual/en/function.crypt.php)[PHP 文档`crypt()`](http://us2.php.net/manual/en/function.crypt.php)确实提供了一些关于如何使用 salt 字符串来指定要使用的算法的信息：

> *   CRYPT_STD_DES - 基于标准 DES 的哈希，带有来自字母“./0-9A-Za-z”的两个字符的盐。在 salt 中使用无效字符会导致 crypt() 失败。
> *   CRYPT_EXT_DES - 扩展的基于 DES 的散列。“salt”是一个 9 字符的字符串，由一个下划线后跟 4 个字节的迭代计数和 4 个字节的 salt 组成。这些被编码为可打印字符，每个字符 6 位，最低有效字符在前。值 0 到 63 被编码为“./0-9A-Za-z”。在 salt 中使用无效字符会导致 crypt() 失败。
> *   CRYPT_MD5 - 以 $1$ 开头的 12 个字符盐的 MD5 散列
> *   CRYPT_BLOWFISH - 使用盐的 Blowfish 散列如下：“$2a$”，两位数的成本参数，“$”和字母表中的 22 位数字“./0-9A-Za-z”。在 salt 中使用超出此范围的字符将导致 crypt() 返回零长度字符串。两位数的成本参数是底层基于 Blowfish 的散列算法的迭代计数的以 2 为底的对数，必须在 04-31 范围内，超出此范围的值将导致 crypt() 失败。
> *   CRYPT_SHA256 - SHA-256 哈希，带有 16 个字符的盐，前缀为 $5$。如果 salt 字符串以 'rounds=$' 开头，则 N 的数值用于指示应该执行多少次散列循环，很像 Blowfish 上的成本参数。默认轮数为 5000，最小为 1000，最大为 999,999,999。超出此范围的任何 N 选择都将被截断到最近的限制。
> *   CRYPT_SHA512 - SHA-512 哈希，带有 16 个字符的盐，前缀为 $6$。如果 salt 字符串以 'rounds=$' 开头，则 N 的数值用于指示应该执行多少次散列循环，很像 Blowfish 上的成本参数。默认轮数为 5000，最小为 1000，最大为 999,999,999。超出此范围的任何 N 选择都将被截断到最近的限制。

因此，要指定您希望使用 Blowfish 对字符串“密码”进行 2^10 次迭代，您可以使用

```
crypt('password', '$2a$10$XA86t7EJ0xD9OYEUbnTulT'); 
```

`XA86`其中以盐开头的字符串。

最后，如果您想要更多示例，或者只是想为您处理所有这些密码兼容性业务，请查看[phpass](http://www.openwall.com/phpass/)。它是公共领域，在我的经验中运行良好。除非您指定要与多个系统兼容的哈希，否则它将自动在系统上使用“最佳”算法，在这种情况下（我认为）它使用 MD5。

# android - 防止第三方库发出 Toast 消息？

> ID：10262670
> 
> 赞同：2
> 
> 时间：2012-04-21T20:22:12.607
> 
> 标签：android, toast

我必须调用第三方库中的方法，不幸的是该方法发出了不必要的 Toast 消息。有没有办法阻止 Toast 消息显示（例如，在调用该方法之前暂时关闭所有 Toast 消息，然后立即打开它们）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:26:49.533

不，对不起。如果你有第三方库的源代码，你可以删掉有问题的`Toast`. 或者，您可以要求库的开发人员摆脱`Toast`，或使其可配置。否则，你会被它困住。

# php - cURL 执行后如何“删除 cookie”？

> ID：10262673
> 
> 赞同：2
> 
> 时间：2012-04-21T20:22:36.547
> 
> 标签：php, curl

我正在测试我的站点的 cURL，并且我正在尝试使 cURL “清除缓存”，以便重新生成会话 cookie。

所以我有一个index.php 和一个login.php。我使用正确的凭据进行 POST 索引，然后按预期重定向到 login.php。然后，我尝试“清除缓存”和 cURL 到 login.php。我期望得到一个 302（重定向）到 index.php，但我得到一个 200 OK...

我正在使用这些设置来尝试清除缓存：

```
$cookiefile = "d://cookie.txt";
curl_setopt($curl, CURLOPT_FRESH_CONNECT , 0);
curl_setopt($curl, CURLOPT_COOKIESESSION, true);
curl_setopt($curl, CURLOPT_COOKIEFILE, $cookiefile);
curl_setopt($curl, CURLOPT_COOKIEJAR, $cookiefile); 
curl_setopt($curl, CURLOPT_FRESH_CONNECT , 1); 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-21T20:26:01.567

如果您想清除 cookie，您应该取消链接文件`unlink($cookiefile);`，然后，您可以在没有旧 cookie 的情况下再次登录。

好锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:25:35.300

删除名称在`$cookiefile`.

# matlab - 在 MATLAB 中将两个参数放入 UnifDist

> ID：10262674
> 
> 赞同：2
> 
> 时间：2012-04-21T20:22:48.310
> 
> 标签：matlab

尝试计算以下表达式，

```
quad(@(n)quad(@(m)unifpdf(m-n,0,1),-10,10),-10,10) 
```

但是我收到一条消息说：

```
??? Error using ==> minus
Matrix dimensions must agree.

Error in ==> @(m)unifpdf(m-n,0,1) 
```

你能告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:43:47.147

这里的问题是以下[要求](http://www.mathworks.com/help/techdoc/ref/quad.html)：

> 函数 y = fun(x) 应该接受向量参数 x 并返回向量结果 y，即在 x 的每个元素处计算的被积函数。

`unipdf`似乎满足这个要求，但`quad`它本身却不是。

要解决此问题，您需要编写一个接受向量参数的包装函数，`x`使用函数计算内部积分`quad`，并返回结果向量：

```
function [r] = Test()
    r = quad(@(n)InnerIntegral(n),-10,10);
end

function [y] = InnerIntegral(n)
    y = zeros(size(n));
    for i = 1 : length(n)
        y(i) = quad(@(m)unifpdf(m - n(i), 0, 1), -10, 10);
    end;
end 
```

# android - 安卓。与自定义列表视图中的适配器相关的错误

> ID：10262675
> 
> 赞同：0
> 
> 时间：2012-04-21T20:23:07.467
> 
> 标签：android, listener, adapter

我希望有人能帮助我，因为我现在完全迷路了。

我制作了这个从给定列表填充列表视图的自定义适配器。

问题在于减号和加号按钮。他们都有侦听器，可以根据按下哪个来修改文本视图，计数为 1，它还修改了源列表。

这是说明最终视图的图片[PIC 。](http://imageshack.us/photo/my-images/824/screenshot2012042120594.png)

如果从第一行开始按下的按钮一切正常，那么您可以使用其余的按钮来解决问题。但是，如果按下的是其他之一，则应用程序崩溃。

尝试在特定列表项的原始列表中添加+1 或remove-1 时，给出的错误是空指针异常。

如果还需要什么，请询问。感谢您的关注。

公共类 MenuListAdapter 扩展 BaseAdapter {

```
private Context mContext;
private int mLayoutResourceId;

public MenuListAdapter(Context context, int textViewResourceId) {
     mContext = context;
     mLayoutResourceId = textViewResourceId;
}

public int getCount() {
    return SavedMenuList.INSTANCE.size();
}

public MenuListItem getItem(int position) {
    return SavedMenuList.INSTANCE.getItem(position);
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View rowView = convertView;
    if (convertView == null) {
        LayoutInflater inflater = (LayoutInflater) mContext.getSystemService( Context.LAYOUT_INFLATER_SERVICE );
        rowView = inflater.inflate(mLayoutResourceId, null);
        final ViewHolder viewHolder = new ViewHolder();
        viewHolder.checkBox = (CheckBox) rowView.findViewById(R.id.confirmation_list_row_check);
        viewHolder.text = (TextView) rowView.findViewById(R.id.confirmation_list_row_name);
        viewHolder.minus = (ImageButton) rowView.findViewById(R.id.confirmation_list_row_remove_button);
        viewHolder.minus.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                MenuListItem item = (MenuListItem) viewHolder.minus.getTag();
                SavedMenuList.INSTANCE.removeOneItemCount(item);
                notifyDataSetChanged();
            }
        });
        viewHolder.count = (TextView) rowView.findViewById(R.id.confirmation_list_row_count);
        viewHolder.plus = (ImageButton) rowView.findViewById(R.id.confirmation_list_row_add_button);
        viewHolder.plus.setOnClickListener(new OnClickListener() {      
            public void onClick(View v) {
                MenuListItem item = (MenuListItem) viewHolder.plus.getTag();
                SavedMenuList.INSTANCE.addOneItemCount(item);
                notifyDataSetChanged();
            }
        });
        viewHolder.itemid = (TextView) rowView.findViewById(R.id.confirmation_list_row_itemid);
        viewHolder.typeid = (TextView) rowView.findViewById(R.id.confirmation_list_row_typeid);
        rowView.setTag(viewHolder);
    }else{
        rowView = convertView;
        ((ViewHolder) rowView.getTag()).checkBox.setTag(getItem(position));
        ((ViewHolder) rowView.getTag()).minus.setTag(getItem(position));
        ((ViewHolder) rowView.getTag()).plus.setTag(getItem(position));
    }
    ViewHolder holder = (ViewHolder) rowView.getTag();
    MenuListItem item = getItem(position);

    holder.text.setText(item.getmItemName() + " (" + item.getmItemTypeName() + ")");
    holder.count.setText(String.valueOf(item.getmItemCount()));
    holder.typeid.setText(String.valueOf(item.getmItemId()));
    holder.typeid.setText(String.valueOf(item.getmItemTypeId()));

    return rowView;
}

static class ViewHolder {
    public CheckBox checkBox;
    public TextView text;
    public ImageButton minus;
    public TextView count;
    public ImageButton plus;
    public TextView itemid;
    public TextView typeid;
} 
```

}

这是错误：

04-22 02:54:22.398: E/AndroidRuntime(7112): 在 giorgi.betaproject.utils.SavedMenuList.addOneItemCount(SavedMenuList.java:34)

```
public enum SavedMenuList {
    INSTANCE;

    List <MenuListItem> mList = new ArrayList<MenuListItem> ();

...
    public boolean addOneItemCount(MenuListItem item) {
        for (MenuListItem mItem: mList){
            if (item.equals(mItem)){
                mItem.addOneItemCount();
                return true;
            }
        }
        return false;
    }
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T02:07:29.433

```
public boolean addOneItemCount(MenuListItem item) {
    for (MenuListItem mItem: mList){
        if (item.equals(mItem)){
            mItem.addOneItemCount();
            return true;
        }
    }
    return false;
} 
```

`item`在上面的代码中是空的，因为你从来没有在你的`getView`方法中设置它。

```
viewHolder.plus.setOnClickListener(new OnClickListener() {      
    public void onClick(View v) {
    MenuListItem item = (MenuListItem) viewHolder.plus.getTag();
    SavedMenuList.INSTANCE.addOneItemCount(item);
    notifyDataSetChanged();
    }
}); 
```

请注意这一行：`MenuListItem item = (MenuListItem) viewHolder.plus.getTag();`，您`getTag()`从`minus`视图中执行，但您从未`viewHolder.plus.setTag(...)`在代码中执行此操作，这肯定会导致 NullPoinaterException。

# ruby - 将 SSL 添加到连接

> ID：10262676
> 
> 赞同：6
> 
> 时间：2012-04-21T20:23:09.453
> 
> 标签：ruby, ssl, openssl

当您需要首先通过明文进行通信时，如何在 Ruby 中使用 SSL 保护套接字？

我不能使用[`OpenSSL::SSL::SSLServer`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/SSL/SSLServer.html)，因为首先请求 SSL 连接是客户的责任

长话短说，我正在尝试实现 RFC3207，客户端发送关键字“STARTTLS”，然后创建 SSL 连接。

我的问题是“服务器发送‘220 OK’后如何创建 SSL 连接？”

我知道我可以[`OpenSSL::SSL::SSLSocket`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/SSL/SSLSocket.html)在客户端使用，但我不知道在服务器端该怎么做

如果你知道如何用 Ruby 以外的语言做到这一点，只需发布​​代码，我会翻译它，我已经为此工作了大约 8 个小时，我需要我能得到的一切

我在#ruby-lang 中询问过，但无济于事，我尝试同时在服务器和客户端上的 SSLSockets 中包装 Socket 对象，但这也不起作用

简而言之，我很困，我需要我能得到的所有帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-06T20:55:03.753

您必须将 SSLServer 的 start_immediately 字段设置为 false 才能以纯文本模式启动 SSL 服务器。在任何时候（即当您从客户端收到 STARTTLS 命令时），您都可以调用 SSLSocket 的 accept 方法来启动 SSL/TLS 握手。客户当然必须同意协议:)

这是我为测试而编写的示例服务器：

```
#!/usr/bin/ruby

require 'socket';
require 'openssl';

certfile = 'mycert.pem';
port = 9002;

server = TCPServer.new( port );

# Establish an SSL context 
sslContext = OpenSSL::SSL::SSLContext.new
sslContext.cert = OpenSSL::X509::Certificate.new( File.open( certfile ) );
sslContext.key = OpenSSL::PKey::RSA.new( File.open( certfile ) );

# Create SSL server
sslServer = OpenSSL::SSL::SSLServer.new( server, sslContext );

# Don't expect an immidate SSL handshake upon connection.
sslServer.start_immediately = false;

sslSocket = sslServer.accept;

sslSocket.puts( "Toast.." );

# Server loop
while line = sslSocket.gets

        line.chomp!;

        if "STARTTLS" == line
                # Starting TLS
                sslSocket.accept;
        end

        sslSocket.puts( "Got '#{line}'" );

end

sslSocket.close; 
```

我确定原始发帖人知道如何测试 STARTTLS，但我们其他人可能需要这个提醒。实际上，我通常使用 GNUTLS 包（debian/ubuntu 中的 gnutls-bin）中的 utils 来测试 starttls，因为它允许我随时开始握手：

```
$ gnutls-cli --starttls --port 9002 --insecure localhost 
```

这以纯文本 TCP 套接字模式连接。键入一些行并让它们回显。此流量未加密。如果您发送`STARTTLS`，`sslSocket.accept`则调用 ，并且服务器等待 SSL 握手。按 ctrl-d (EOF) 从 gnutls 客户端开始握手，并观察它建立加密的 SSL 连接。随后的行也将被回显，但流量现在已加密。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-17T14:52:51.347

我创建了这个[gist](https://gist.github.com/2791400)来说明如何设置最小的 TLS 服务器。您可能想省略第 62-67 行，这是为了说明中继上的一个新功能。

但除此之外，它是一个功能齐全的 TLS 服务器，您可以在其上构建以添加更多功能。

如果您想认真使用它，您可能还想将服务器证书的 CN 从“localhost”更改为真实域:)

您可能会注意到，工作的最大部分实际上是正确设置 PKI 方面。核心服务器部分是这样的：

```
ctx = OpenSSL::SSL::SSLContext.new
ctx.cert = ... # the server certificate
ctx.key = ... # the key associated with this certificate
ctx.ssl_version = :SSLv23
tcps = TCPServer.new('127.0.0.1', 8443)
ssls = OpenSSL::SSL::SSLServer.new(tcps, ctx)
ssls.start_immediately = true
begin
  loop do
    ssl = ssls.accept
    puts "Connected"
    begin
      while line = ssl.gets
        puts "Client says: #{line}"
        ssl.write(line) # simple echo, do something more useful here
      end
    ensure
      ssl.close
    end
  end
ensure
  tcps.close if tcps
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T22:43:42.417

我在这方面取得了一些进展，保存以备将来使用：

*   是的，您应该在两端使用 OpenSSL::SSL::SSLSocket
*   在服务器端，您必须创建一个 OpenSSL::SSL::SSLContext 对象~~，传入一个带有您希望使用的协议的符号，并在末尾附加“_server”，请参阅 OpenSSL::SSL::SSLContext::METHODS我的意思是，简而言之，对 RFC3207 使用“：TLSv1_server”~~甚至不需要这样做，在服务器端使用证书创建上下文，然后在套接字上调用#accept 以等待客户端传输
*   将 SSL 证书传递给 ctx 对象

随意编辑

# postgresql - osm2pgsql 在 Mac 上失败

> ID：10262677
> 
> 赞同：2
> 
> 时间：2012-04-21T20:23:09.383
> 
> 标签：postgresql

我正在尝试使用 TileMill 处理 openstreetmaps。

我已经使用自制软件安装了 postgres、postgis 和 osm2pgsql。

但是，在将 osm 数据导入 postgres 时，我收到一个错误：“错误：AddGeometryColumn() - invalid SRID”

就像 osm2pgsql 正在创建与 postgis 不兼容的 sql。

我正在关注教程： http: [//mapbox.com/tilemill/docs/guides/osm-bright-mac-quickstart/](http://mapbox.com/tilemill/docs/guides/osm-bright-mac-quickstart/)

使用的操作系统：狮子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T20:29:16.543

我最近也有同样的问题。你的问题意味着你还没有安装墨卡托投影。您可以使用以下方法修复它：

wget [http://svn.openstreetmap.org/applications/utils/export/osm2pgsql/900913.sql](http://svn.openstreetmap.org/applications/utils/export/osm2pgsql/900913.sql) && psql -f 900913.sql gis

您很快就会遇到下一个错误*“错误：函数 setsrid(box3d, integer) 不存在”*： [https ://github.com/mapbox/tilemill/issues/1375](https://github.com/mapbox/tilemill/issues/1375)

:)

尝试按照我的笔记： [https ://gist.github.com/2417488](https://gist.github.com/2417488)

祝你好运！

# c++ - 如何获取模板化 WTL 类对象 C++ 的地址

> ID：10262682
> 
> 赞同：2
> 
> 时间：2012-04-21T20:23:19.643
> 
> 标签：c++, templates, template-specialization, wtl

我继承了一些 C++ 代码，这让我很困惑。

有一个像这样声明的类。

```
class CIENavigator :  public CWTLAxControl<CIENavigator,IWebBrowser2>
{
public: 
```

像这样的实例

```
CIENavigator CIE;
CIENavigator * pCIE = &CIE; 
```

得到这个编译错误

```
1>.\IENavigator.cpp(446) : error C2440: 'initializing' :
          cannot convert from 'IWebBrowser2 **' to 'CIENavigator *'
1>        Types pointed to are unrelated; conversion requires 
          reinterpret_cast, C-style cast or function-style cast 
```

虽然 CIE 被声明为 CIENavigator，但它认为 &CIE 的类型是 IWebBrowser2 **

如果我像这样强制演员：

```
CIENavigator CIE;
CIENavigator * pCIE = (CIENavigator *) &CIE; 
```

它编译，但指针确实是错误的指针。

我注意到类名出现在自身的声明中，但我不知道它的意义是什么。我不喜欢类模板。

如何获得正确的 CIENavigator 对象 (CIE) 地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:33:42.737

`CWTLAxControl`可能有一个重载`operator&`，以规避使用[Boost.AddressOf](http://www.boost.org/doc/libs/1_46_1/libs/utility/utility.htm#addressof)。

# iphone - 选项卡栏项目在情节提要上无法调用另一个视图

> ID：10262688
> 
> 赞同：1
> 
> 时间：2012-04-21T20:24:27.823
> 
> 标签：iphone, ios, xcode

选项卡栏项目在情节提要上无法调用另一个视图

我按 ctrl + 拖动到视图，等待与常规按钮相同的行为（显示选择模式调用的选项）

任何方向？

# php - 多个实例时使用 PHP AJAX 更新表记录

> ID：10262696
> 
> 赞同：0
> 
> 时间：2012-04-21T20:25:34.580
> 
> 标签：php, javascript, mysql, ajax

在我的页面上，我有多个与此相同的表单...

```
<form class='bill-upd'>
   <input type='hidden' value='".$info['rand']."' name='rand2' id='rand2'>
   <input type='hidden' value='".$info['id']."' name='billid' id='billid'>
   Total <input type='text' id='total' name='total' /><br />
   Bill name<input type='text' id='bill-name' name='bill-name' /><br />
   bill descriptiion <input type='text' id='bill-description' name='bill-description' /><br />
   bill colour<input type='text' id='bill-colour' name='bill-colour' />
   <input type='button' value='submit' onClick='updateBill();' />
</form> 
```

然后我有我的 AJAX

```
function updateBill()
{
    $.post('update_bill.php', $('.bill-upd').serialize(), 
        function(data) {
        $(this).append(data);
    });
}; 
```

如果我的页面上有一个表单，这可以正常工作，但是当有多个实例时，我的相同记录被覆盖，有人可以告诉我哪里出错了吗？

谢谢

* * *

在@Armatus 和@Bricriu 的帮助下，我对它进行了排序，标记为有效的答案，愚蠢地忘记将它包装在 document.ready 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:01:00.913

您需要一种方法来指定要更新的账单，否则它只会占用所有账单。这应该可以工作，因为我们可以通过单击哪个按钮来确定它是哪一个。

编辑：我个人会使用 jQuery 而不是 onClick 来绑定元素本身：

```
$(".bill-upd input:submit").click(function(){
    var elem = $(this);
    $.post('update_bill.php', elem.parent('.bill-upd').serialize(), 
        function(data) {
        elem.append(data);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:48:46.440

如果其他表单具有相同的类`.bill-upd`，则 javascript`.serlialize()`也会从中获取值。确保其他表格有备用课程。

如果你给表单一个唯一的 id 会更好，例如`id="billform"`然后替换`$('.bill-upd').serialize()`为`$('#billform').serialize()`.

希望这可以帮助。

编辑：

用这个：

```
$(this).parent('.bill-upd').serialize() 
```

序列化被点击的父级。

# android - 如何知道所拨号码已收到响铃？

> ID：10262698
> 
> 赞同：0
> 
> 时间：2012-04-21T20:25:53.787
> 
> 标签：android

我的应用程序需要知道对方是否接听了我的电话。我需要在 1 或 2 次响铃后执行一些逻辑。

为此，我重写了 onCallStateChanged 方法，并检查 CALL_STATE_RINGING 状态。但看起来这种方法并不是 100% 完美的，因为在状态更改为 CALL_STATE_RINGING 后，响铃需要一些时间才能发生。

关于如何继续实施的任何建议？一种方法是在状态更改为 CALL_STATE_RINGING 后延迟 2 到 3 秒。但是这种方法真的很愚蠢，因为延迟会因电信公司而异。还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:47:38.267

不确定是否可以检测到对方何时接听，但我认为这个链接对你有用

[如何在 Android 手机中获取拨出电话的状态？](https://stackoverflow.com/questions/2872214/how-do-i-get-state-of-a-outgoing-call-in-android-phone)

# php - PHP输出图像问题

> ID：10262700
> 
> 赞同：1
> 
> 时间：2012-04-21T20:25:59.783
> 
> 标签：php, image, header, mime

```
if (file_exists($path)) {

    $fileContent = id3_getImage($path); 
    $fileMime = id3_getMimeOfImage($path); // is set to image/jpeg

    if ($fileMime != "") {
        header('Content-Type: '.$fileMime);
        print($fileContent);
        die;
    }
} 
```

所以上面的代码在浏览器中不起作用，但是当我用图像制作图像时

```
$img = imagecreatefromstring($fileContent);
imagejpeg($img, 'test.jpg');die; 
```

图像已创建，我可以在我的计算机上查看它。所以我不知道我做错了什么:(

*这可能是apache conf中的设置吗？老实说，我对此一无所知

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:41:32.577

从数据库读取时，这个对我有用

```
$image = imagecreatefromstring([path/DBfiels]);  
header('content-type: image/jpeg');  
imagejpeg($image); 
imagedestroy($image); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:30:18.307

```
header('Content-Type: image/jpeg');

// Output the image
imagejpeg($img); 
```

您需要先发送标头。但是，如果您想创建图像并显示，则需要创建并为浏览器阅读此内容。

```
readfile($filename); 
```

你可以在这里阅读这个人：http: [//php.net/manual/en/function.readfile.php](http://php.net/manual/en/function.readfile.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:34:36.617

我使用 Google Groups 中的 smartReadFile.php 来显示任何类型的文件。

[https://jplayer.googlegroups.com/attach/f308294ddea52f6c/smartReadFile.php?view=1&part=4](https://jplayer.googlegroups.com/attach/f308294ddea52f6c/smartReadFile.php?view=1&part=4)

它真的很聪明。=)

```
<?php 

require "smartReadFile.php";

$dir = 'images/';
$filename = 'someimage' . '.jpg';
$location = $dir.$filename;

smartReadFile($location, $filename);

?> 
```

# c++ - C 和 C++ 中的套接字解 释

> ID：10262702
> 
> 赞同：4
> 
> 时间：2012-04-21T20:26:02.830
> 
> 标签：c++, c, sockets

好吧，我一直想知道是否有 C++ 的标准套接字头文件

我确实搜索了整个互联网（使用谷歌搜索引擎），但找不到任何标准的 C++ 套接字头文件，除了找到一些库，如 Boost、chilkat 等......

我只成功地找到了 C 编程语言的标准套接字头文件。如果我使用 C 标准套接字头文件，但在我的 C++ 代码中，这是否意味着我的程序是纯 C++ 或 C 和 C++？

因为我没有找到任何标准的 C++ 套接字头文件。就像`<string>`C++ 和`<string.h>`C 一样，但 C++ 没有套接字标准头文件。

我希望 C/C++ 明智的人会一步一步地为我解释所有这些。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T20:29:43.450

C++ 中没有标准的套接字库。您可以使用操作系统提供的任何套接字 API（通常是 C API，在 Unix 操作系统上将是[BSD 套接字 API](http://www.cs.vu.nl/~jms/socket-info.html)），或者您可以使用跨平台的 C++ 库（如[Boost.ASIO ）。](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:43:59.033

[BSD 套接字](http://en.wikipedia.org/wiki/Berkeley_sockets)，由 Bill Joy 在 70 年代发明，可以说是“标准套接字 API”。

通常，您会包含以下标题：

```
#include <sys/socket.h> // Core BSD socket functions and data structures.
#include <netinet/in.h> // AF_INET and AF_INET6 address families and their
                        // corresponding protocol families PF_INET and PF_INET6.
#include <arpa/inet.h>  // Functions for manipulating numeric IP addresses.
#include <netdb.h>      // Name resolution 
```

Beej's Guide 是关于套接字（BSD 套接字）编程的优秀教程：

[http://beej.us/guide/bgnet/](http://beej.us/guide/bgnet/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:39:12.280

如果您包含 c 头文件但使用 c++ 编译代码，那么它将生成一个 c++ 应用程序。您可以使用许多 c++ 框架，例如 Boost::asio、ACE、WinSock 等。这取决于您是否希望您的代码是可移植的，以及您的应用程序是否只能在特定的操作系统上运行，即。Linux、Mac 或 Windows。

此外，由于 C++ 是 C 的超集，因此无论您使用 C 还是 C++ 都无关紧要，因为您正在编译 C++ 程序，因此您生成的 C++ 纯粹而简单。

# ios - iTunes Connect 中对当前版本信息的修改并未真正保存

> ID：10262716
> 
> 赞同：0
> 
> 时间：2012-04-21T20:27:33.737
> 
> 标签：ios, app-store-connect

我在 iTunes Connect (ITC) 中有一个处于“准备上传”状态的应用程序。我最初用临时信息设置了 ITC，并准备上传最终信息，例如高分辨率图标、类别选择、版权声明等。

ITC 允许我进行所有这些更改，但是当我单击“保存”按钮并返回上一个屏幕时，它显示了旧图标和旧信息。我尝试了几次，结果都是一样的不成功。

我还联系了 Apple 的 ITC 支持，但他们给了我一些绕路，并没有提供任何明确的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T20:01:31.580

幸运的是，我找到了解决方法。我上传的图标文件是一个名为“iTunesArtwork”的PNG文件，没有扩展名，因为你必须命名它才能将它嵌入到包中。凭直觉，我给该图像文件添加了“.png”扩展名，并再次在 ITC 中更新。这次更新进行了，我能够提交我的应用程序，并且所有设置都完全符合要求。

那么文件扩展名真的是诀窍吗？ *耸耸肩*根据我重试的次数，这对我来说似乎是这样，但这也可能是苹果方面的改变，所以我不能保证这对你有用。

# maven - 在构建服务器上多次构建同一应用程序

> ID：10262722
> 
> 赞同：0
> 
> 时间：2012-04-21T20:28:23.207
> 
> 标签：maven, build, jenkins

我正在开发一个 java 应用程序，我们构建了它的 32 位和 64 位版本。软件使用本机代码，因此32位和64位版本需要打包相应的库。

目前在我们的构建服务器 (jenkins) 上，我们在单个项目中构建 32 位和 64 位。这样做的原因是因为我们希望保持两个构建同步 - 基本上如果一个失败，我们不想在 32 位版本而不是 64 位版本上部署某些功能。由于底层代码库是相同的，只是库不同，我认为内部版本号也应该始终相同。

此解决方案有效，但构建时间是其两倍，因为它进行了两次构建。如果我将它们拆分为单独的项目，则无法保证 32 位和 64 位版本在构建号和构建状态方面保持同步。

听起来我真正想要的是一个有两个孩子的父版本——32 位和 64 位版本。我不确定这是否应该在构建服务器上处理，或者可能作为 maven 中的多模块项目。拥有一个多模块项目似乎并不完全正确，因为只有库不同，而不是任何代码。

有没有人处理过这种情况并可以在这里提供指导？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T22:20:07.153

我认为多配置工作将非常适合您的情况。我不会帮助构建时间。唯一有用的是同时构建 32 位和 64 位版本。如果您的构建服务器不够强大，无法处理该问题，您可以获取另一台服务器并将其添加为 Jenkins 的从属服务器。然后分配 32 位配置构建在一个和 64 位配置上构建另一个。

# python - 没有 u"" 的解析字符串

> ID：10262723
> 
> 赞同：-1
> 
> 时间：2012-04-21T20:28:24.590
> 
> 标签：python, string

如何在没有`u''`包装器的情况下创建字符串？
我正在生成一些我想放入数组的字符串。

例如

```
STR = ""
for i in some_array:
    STR += '\'\t<img src="media/'+i+'" alt="" />\n,\' '
arr = ['i"m', 'the', 'array', STR, 'end']

# The result is:
# arr = ['i"m', 'the', 'array', u'\'\t<img src="media/1.jpg" alt="" />\n\', \'\t<img src="media/2.jpg" alt="" />\n\' ', 'end']
# i'd like to have it like:
# arr = ['i"m', 'the', 'array', '\t<img src="media/1.jpg" alt="" />\n', '\t<img src="media/2.jpg" alt="" />\n', 'end'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:31:03.970

那*是*一个字符串。如果您希望它是一个字节串，那么[您需要先对其进行编码](http://farmdev.com/talks/unicode/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:41:08.690

该包装器只是在交互式 Python 控制台中表明它是一个`unicode`字符串。如果您将其打印出来或放入模板中（例如使用`print(' '.join(arr))`），`u""`则不会显示。

# c# - 如果 xml 文件存在执行某些任务

> ID：10262726
> 
> 赞同：-1
> 
> 时间：2012-04-21T20:28:40.300
> 
> 标签：c#, xml

嗨，我的目标是允许 xml 文件写入一个新的 xml 文档，如果它不存在并且如果它确实存在，那么将元素添加到 xml 文件中。问题是如果在 else if() 语句之后给我一个错误，说“xwriter 在当前上下文中不存在”。谢谢

到目前为止，我已经尝试过了，但它不起作用。

```
 private void button1(object sender, EventArgs e)
    {

        if (!File.Exists("doc.xml"))
        {
            XmlTextWriter xwriter = new XmlTextWriter("doc.xml", Encoding.UTF8);
            XmlWriterSettings settings = new XmlWriterSettings();
        }

        else if (File.Exists("doc.xml"))
        {
            xwriter.Formatting = Formatting.Indented;
            xwriter.WriteStartDocument();
            xwriter.WriteStartElement("myCourse");
            xwriter.WriteString("Test");
            xwriter.WriteEndElement();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:43:11.467

你有两个主要问题

1) 您的`else`语句尝试使用在`if`语句中声明和创建的变量。也就是说，xwriter 根本不存在于 中`else`，因为它被本地化到`if`代码分支的范围内。要在`else`语句中也使用它，它必须在语句之前`if`声明，以便代码的分支`if`和`else`分支都可以使用它。

2) 您不能附加到 XML 文件。如果您在语句之外创建 xwriter `if`，代码将编译并运行，但您`else`的代码块将简单地覆盖 xml 文件的现有内容。

要根据需要附加到 xml，您需要打开文件，查找根/文档元素的结束标记开始的位置，然后使用 xml 编写器写入，以便覆盖结束标记并形成新的有效 xml . 要关闭文件，您必须附加原始文本，为根/文档元素添加新的结束标记，以使 xml 文件保持有效。

另一种（效率较低的）方法是从文件中加载 XML，然后重写现有内容以及新数据。

（您也不需要两次检查文件是否存在）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:42:29.720

变量 xwriter 仅在第一个 if 块内定义 - 您必须将其设为全局变量才能在第二个块中定义。

请注意，您使用的 XmlTextWriter 构造函数会*截断*xml 文件（如果存在），因此您必须切换到采用 Stream 参数的构造函数。

另请注意，您不应该将 WriteStartDocument 写入现有文件...

总而言之，当您需要以增量方式将数据附加到现有文件时，Xml 并不是很好——如果可能，请考虑切换到不同的文件。

# javascript - js和html中的onmouseout行为

> ID：10262730
> 
> 赞同：2
> 
> 时间：2012-04-21T20:29:14.220
> 
> 标签：javascript, html, onmouseout

```
<a href="/somewhere" onmouseout="someFunction()">blah blah blah<img src="blah.jpg"></a> 
```

在上面的链接中，我`someFunction()`在鼠标离开链接时触发。似乎直截了当。但是当我将鼠标悬停在图像“blah.jpg”上时，onmouseout 事件也会触发。这是不可取的，因为“blah.jpg”实际上在`a`节点中。`a`如果我在节点内有一个 div，或者除了纯文本之外的任何其他 html 元素，也会发生同样的事情：javascript 认为这是在*节点之外*`a`。有没有办法阻止这些事件不正确地触发？所描述的行为是在 win7 上的 chrome 和 ff 中。

*更新：如果有 jquery 解决方案，请告诉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:43:08.767

您可以通过验证节点类型来做到这一点。尝试

```
onmouseout="if ((event.relatedTarget || event.toElement) == this.parentNode) someFunction()" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T01:18:02.220

在概念上与 shehzad 相似，所以我投票支持他。应该跨浏览器工作。在 html 中：

```
onmouseout='out(this)' 
```

在 js 中（包含 jquery 文件）：

```
out(thisRef) {
   var newHover = event.relatedTarget || event.toElement;
   if(!jQuery.contains(thisRef,newHover) && !(thisRef==newHover)) {
        someFunction();
   } 
```

}

# php - 什么是解析巨大的 sql 文件的最佳方法

> ID：10262732
> 
> 赞同：1
> 
> 时间：2012-04-21T20:29:16.670
> 
> 标签：php, mysql, database, csv

我正在尝试将大型 sql 文件解析为 csv 文件。我曾考虑在 php 中使用 fread，但无法确定 sql 是否由行分隔...bc 我假设 fread 正在将数据加载到 RAM 中，但这是行不通的。

关于如何快速将 sql 转换为 csv 的任何想法？（我也在与我的数据库不同的机器上运行......所以很遗憾我不能导出为 csv）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:49:02.120

“大” - 这对你意味着什么。您可以保存到服务器上的文件（机器数据库正在运行）并压缩/下载。

例如：

```
SELECT name,lastname,age FROM profile 
```

该查询返回 mysql 表的三列。现在用于重定向/打印到文件中：

```
SELECT name,lastname,age FROM profile INTO OUTFILE '/tmp/userdata.txt' 
```

这会将数据输出到上述语句中传递的文件中。要以 CSV 格式输出数据，请在查询中添加更多选项，如下所示：

```
SELECT name,lastname,age FROM profile INTO OUTFILE '/tmp/userdata.txt'
    FIELDS enclosed by '"' separated by "," LINES TERMINATED BY '\n' 
```

[原帖](http://forums.mysql.com/read.php?79,150417,285428#msg-285428)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T22:01:20.660

在本地机器上安装 mysql。现在您可以导入 sql 文件，然后自由导出为 csv 或任何您想要的。

# iphone - 带有 Static Lib 的 iOS 应用程序仅在启动 Archive Build 加载的 Ad Hoc 时崩溃。无法在调试器中重现

> ID：10262733
> 
> 赞同：12
> 
> 时间：2012-04-21T20:29:24.737
> 
> 标签：iphone, ios, xcode4

我意识到这是一个延伸，我无法提供太多信息来提供帮助，但我正在寻求任何帮助。我的应用程序已经持续开发了 3 年，从未见过这样的事情。我最近向 Apple 提交了一个小点发布以供发布，现在两次因为在他们的所有设备上启动时崩溃而被拒绝？

崩溃报告指向静态库中的一些代码，但关键行没有被符号化。试过Atos没有运气。

关键是我有 7 台设备在我能想到的每种模式下都测试了该应用程序，特别是没有连接到任何东西：Wifi-OFF、AirplaneMode-ON、位置服务-OFF。我永远无法模拟他们声称看到的内容，即每次启动时应用程序崩溃？！

我在 AAPL 开发论坛上发现了一份听起来很相似的报告，但他从来没有得到任何关于发生了什么的解释。在他提交了一个包含大量登录的应用程序后，他绝望地要求他们发送日志。他们得到了那个版本并且……在几个小时内就批准了。

有人有想法么。我需要发布这个版本。

 ***** * *

注意：已解决

* * *

事实证明，这不是一个薄弱环节问题。正如 Brad 建议的那样，我们只在使用存档版本的 Ad Hoc 分发运行应用程序时才看到崩溃......所以这很有帮助。** 

**然而，分辨率原来是我在这里列出的一些编译器标志： [https ://stackoverflow.com/a/10302012/754494](https://stackoverflow.com/a/10302012/754494 "分辨率在这里")** 

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-22T04:06:20.053

我将重新发布并扩展我上面的评论，以便这个问题可以得到一个可接受的答案。

我最近在构建我的 GPUImage 框架时遇到了一个类似的案例。归档时的构建过程似乎与通过 Xcode 在设备上构建和直接安装应用程序时的构建过程略有不同。

这可以通过构建和归档应用程序来公开，然后选择分发它以进行临时或企业分发。获取 .ipa 并将其放入 iTunes 中，然后以这种方式手动将其加载到您的一台测试设备上。以这种方式准备的应用程序的行为可能与通过 Xcode 构建和安装的应用程序不同，并且应该更接近提交审核的构建的行为方式。

就我而言，问题是由于缺乏适当的弱链接。在高于 iOS 4.3 的 SDK 上，如果您希望有条件地使用新 SDK 中存在但旧 SDK 中缺少的类和函数，则不再需要弱链接整个框架。如果您的目标是 4.0 和更高版本，链接器现在应该执行类和函数级的弱链接。

然而，这对于使用我的静态库的人来说是失败的，它会在运行时检查 iOS 5.0 中是否存在新的纹理缓存功能，但它只在这些归档版本中失败。我从未在针对 4.x 设备的所有测试中看到它，因为这是通过 Xcode 安装完成的。最后，我需要让用户明确地对整个 Core Video 框架进行弱链接，以便使用该框架的应用程序在通过 iTunes 归档和安装时能够正常运行。

请注意，这不是由于 Release vs. Debug 构建配置，因为当通过 Xcode 部署到设备时，我尝试在构建方案中在这些配置之间进行切换，并且在那里没有任何区别。归档应用程序的构建和链接方式也有所不同。**

# css - Chrome 中的列数可以，但 IE 和 Firefox 中的列数不行

> ID：10262736
> 
> 赞同：1
> 
> 时间：2012-04-21T20:29:40.287
> 
> 标签：css, grid

[删除链接]

应该有 5 列。每个帖子都有 20% 的宽度，在 Chrome 中看起来不错，但在 IE 和 Firefox 中，最后一列被推到下面，所以只有 4 个。有人知道为什么吗？

```
.post {
  width: 20%;
  float: left;
  overflow: hidden;
}

<article class="col post">
    stuff inside
</article>
<article class="col post">
    stuff inside
</article>
<article class="col post">
    stuff inside
</article>
.... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:34:26.870

不同的浏览器对页边距和填充有不同的默认设置，我怀疑这些设置会造成您的问题。您应该能够通过使用[重置 css](http://meyerweb.com/eric/tools/css/reset/)样式表来消除您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T13:07:18.980

在这里找到我的答案：[https](https://github.com/desandro/masonry/issues/166) ://github.com/desandro/masonry/issues/166我将 20% 更改为 19,8%

> 看起来 Firefox 计算百分比宽度与 WebKit 有点不同。一个简单的解决方法是在您的 CSS 布局中留出一点摆动空间，这样列的总和就不会达到 100%。

# android - 过滤后光标未关闭

> ID：10262739
> 
> 赞同：2
> 
> 时间：2012-04-21T20:29:55.200
> 
> 标签：android, filter, android-cursoradapter

我正在尝试使用自定义 CursorAdapter 和 ContentProvider 为数据库条目列表实现过滤器功能。该代码实际上确实按预期工作，但会导致警告，在某些情况下甚至会导致错误。在 CursorAdapter 中，我覆盖了执行过滤并返回游标的**runQueryOnBackgroundThread**：

```
@Override
public Cursor runQueryOnBackgroundThread(CharSequence constraint) {

  if (getFilterQueryProvider() != null) {
    return getFilterQueryProvider().runQuery(constraint);
  }

  if (constraint == null || constraint.length() == 0) {
    return context.getContentResolver().query(DBContentProvider.URI_LOGS, null,
        LRMDatabase.LogTable.TYPE + " >= " + this.filterType, null, sqlOrder);
  } else {
    return context.getContentResolver().query(
        DBContentProvider.URI_LOGS, null,
        LRMDatabase.LogTable.TYPE + " >= " + this.filterType  + " AND " +
        LRMDatabase.LogTable.MSG + " LIKE '%" + constraint.toString() + "%'", null,
        this.sqlOrder);
  }
} 
```

在我的相应活动中，我使用了**TextWatcher**来过滤数据集：

```
private TextWatcher filterTextWatcher = new TextWatcher() {
  public void afterTextChanged(Editable s) {    
  }

  public void beforeTextChanged(CharSequence s, int start, int count, int after) {
  }

  public void onTextChanged(CharSequence s, int start, int before, int count) {
    adapter.getFilter().filter(s);
  }
}; 
```

我现在的问题是，每次我之前调用**onTextChanged**（否则一切正常）然后从显示过滤数据集的活动返回时，我都会收到类似“*检测到未关闭光标*”之类的警告，甚至会收到类似“*完成中”之类的错误尚未停用或关闭的光标*”。任何想法为什么会发生这种情况？

我知道我请求一个初始光标来显示未过滤的列表，并且从我的活动返回后应该关闭这个光标（这似乎有效）。我还知道，随着我的过滤请求，我创建了一个新游标——根据[ANDROID 开发人员的参考](http://developer.android.com/reference/android/widget/CursorAdapter.html#runQueryOnBackgroundThread%28java.lang.CharSequence%29)——应该在从**runQueryOnBackgroundThread**返回后与旧游标交换，因此旧游标应该被关闭。由于某种原因，这似乎出错了！

# regex - 在 Google Analytics 中使用正则表达式匹配类型来跟踪我的更改日期 URL 一个可跟踪的目标

> ID：10262740
> 
> 赞同：0
> 
> 时间：2012-04-21T20:30:01.427
> 
> 标签：regex, google-analytics

我想使用正则表达式匹配类型在 Google Analytics 中跟踪 URL 目标目标类型。

我有一个使用唯一日期生成的 URL，我想将其设置为目标。

有人可以帮我验证我对字符串做错了什么吗？我不能让它在 GA 中工作。谢谢你。

生成的网址：

```
 /products/usedleadestimator.aspx?ckSRC=030712success 
```

Google Analytics（分析）中的目标跟踪 URL（W/RegEx）：

```
^/products/usedleadestimator\.aspx\?ckSRC=\[^/]*\success 
```

生成的网址：

```
/products/newleadestimator.aspx?ckSRC=040712success 
```

Google Analytics（分析）中的目标跟踪 URL（W/RegEx）：

```
^/products/newleadestimator\.aspx\?ckSRC=\[^/]*\success 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:42:19.207

我不确定 GA 的“目标跟踪”是如何工作的，但我相信您正在寻找的正则表达式是：

```
^/products/usedleadestimator\.aspx\?ckSRC=\d+success$ 
```

在您的模式中，您有`\success`，这将被解释为尝试匹配空格字符，后跟“成功”。我不知道为什么斜线一开始就在那里！

# c++ - 链接 boost 库

> ID：10262742
> 
> 赞同：6
> 
> 时间：2012-04-21T20:30:25.327
> 
> 标签：c++, xcode, boost, linker

我已经下载了 boost 库（版本 1.46.1），但我不知道如何通过 xcode 链接它。我发现一个老问题说要放置 -lfftw3 标志，所以我把它放了。
我还添加了路径：/home/Documents/C++/boost_1_46_1（这是我放置库的目录），但我从链接器收到错误消息：

```
ld: warning: directory not found for option '-L/home/ramy/Documents/C++/boost_1_46_1'
ld: library not found for -lfftw3
clang: error: linker command failed with exit code 1 (use -v to see invocation)
Command /Developer/usr/bin/clang++ failed with exit code 1 
```

所以问题是两个：
1）如何管理xcode链接boost？
2）将库放在文件系统中的什么位置？linux里面有/usr/lib，这里没有这个路径，我应该把它放在/Developer/usr/lib吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-12-10T10:28:25.840

或者对于那些正在寻找快速答案（并且在 linux 上）的人来说，魔法就是添加以下标志：

```
-l boost_system 
```

# c - C malloc，仅在填充时使用内存

> ID：10262747
> 
> 赞同：4
> 
> 时间：2012-04-21T20:30:58.570
> 
> 标签：c, memory-management, malloc

当我的应用程序启动时，我正在使用 malloc 分配一些空间。如果我不填充此变量 top 显示此应用程序使用的内存为 0%，但如果我开始填充此变量 top 开始显示增加的 ram 使用量，因为我正在填充此数组。

所以我的问题是：不应该将 malloc 分配的这个空间显示为我的应用程序的已用空间吗？为什么当我填充此变量时它只显示我的应用程序的 RAM 使用量增加？

我在 Ubuntu 10.10 64 位。这是填充它的代码：

```
char pack(uint64_t list, char bits, uint64_t *list_compressed, char control, uint64_t *index){
uint64_t a, rest;   

if(control == 0){
    a = list;
}
else{
    rest = list >> (64 - control);

    a = (control == 64 ? list_compressed[*index] : list_compressed[*index] + (list << control));

    if(control + bits >= 64){
        control = control - 64;
        //list_compressed[*index] = a;
        (*index)++;
        a = rest;
    } 
}

//list_compressed[*index] = a;
control = control + bits;

return control;
} 
```

“malloqued”变量是 list_compressed。

如果我取消注释 list_compressed 人口，则内存使用量会增加，如果我保留它的注释，则使用量为 0%。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T20:34:20.830

简短的回答，不。在许多操作系统上，当您调用 malloc 时，它不会直接为您分配内存，而是仅在您访问它时分配。

从`malloc` [手册页](http://www.kernel.org/doc/man-pages/online/pages/man3/malloc.3.html)：

> 默认情况下，Linux 遵循乐观的内存分配策略。这意味着当 malloc() 返回非 NULL 时，不能保证内存确实可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:34:05.480

现代操作系统可能只是在您分配时返回一个虚拟内存地址，它实际上并不指向内存块。只有在您想使用它时才“分配”它。

# symfony - 如何从 Symfony 2 编辑对象表单中的对象列表中进行选择

> ID：10262751
> 
> 赞同：2
> 
> 时间：2012-04-21T20:31:17.493
> 
> 标签：symfony, symfony-forms

我有一个表单，您可以在其中编辑对象“一个”的属性。该对象与另一个对象“many”具有一对多的关系。我希望用户能够从表单中选择将“许多”对象分配给“一个”。我不知道该怎么做！

现在：

\Entity\One.php

```
class One
{
 ...
  /*
   * @ORM\ManyToOne(targetEntity="many", inversedBy="one")
   * @ORM\JoinColumn(name="manyId", referencedColumnName="id")
   */
  protected $manyId;
 ...
} 
```

\控制器\OneController.php

```
class OneController extends Controller
{
  ... 
    public function editAction($oneId, Request $request)
    {
        if ($oneId) {
            $one = $this->getDoctrine()
                ->getRepository('One')
                ->find($oneId);
        } else {
            $one = new One();
        }

        $em = $this->getDoctrine()->getEntityManager();
        $manyEntity = 'Bundle\Entity\Many';
        $manyList = new EntityChoiceList($em, $manyEntity);

        $form = $this->createFormBuilder($one)
            ->add('many', 'choice', array('choice_list' => $manyList))
            ->getForm();

        if ($request->getMethod() == 'POST') {
            $form->bindRequest($request);

            if ($form->isValid()) {
                $entityManager = $this->getDoctrine()->getEntityManager();
                $entityManager->persist($one);
            }
        }
     }
 ...
} 
```

这会导致错误消息““标量”类型的预期参数，“Proxies\BundleEntityManyProxy”给定”。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-22T20:16:42.893

解决了！我应该写`->add('many', 'entity', array('class' => 'BundleMany'))`的。

请参阅[http://forum.symfony-project.org/viewtopic.php?f=23&t=36604](http://forum.symfony-project.org/viewtopic.php?f=23&t=36604)。

# jquery - jQuery AJAX getJSON() 方法示例对我不起作用

> ID：10262753
> 
> 赞同：2
> 
> 时间：2012-04-21T20:31:37.820
> 
> 标签：jquery, ajax, getjson

我直接从 w3 学校示例中获取了此代码，但是，在他们的“Tryit 编辑器”之外，它对我不起作用。有任何想法吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("button").click(function () {
                $.getJSON("http://w3schools.com/jquery/demo_ajax_json.js", function (result) {
                    $.each(result, function (i, field) {
                        $("div").append(field + " ");
                    });
                });
            });
        });
    </script>
</head>
<body>
    <button>Get JSON data</button>
    <div></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:35:44.450

您只能向当前域上的某个位置发出 AJAX 请求，除非您请求的是 JSONP 响应。这是所有浏览器中的安全功能。谷歌“同源策略”和“跨站点脚本”以获取更多信息。

解决方法是使用服务器端代理从外部域请求数据，然后使用 jQuery 查询本地代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T06:45:15.660

您需要替换`jquery/demo_ajax_json.js`为`your file name.js`

即， `$.getJSON("http://w3schools.com/jquery/demo_ajax_json.js", function (result)`与 `$.getJSON("path/your file", function (result) {`

# git - 将 debuild/dpkg 设置为始终忽略 .git 目录

> ID：10262754
> 
> 赞同：3
> 
> 时间：2012-04-21T20:31:51.563
> 
> 标签：git, ubuntu, debian, packaging, dpkg

为了分发我的 Ubuntu 包，我使用`debuild -S`创建源包，然后将其上传到启动板，它会创建二进制包。这非常方便。但是，我注意到我的源包的大小正在迅速增长，因为我的所有包都包含一个`.git`目录，该目录包含在所有源包中。

什么是设置全局选项的方法，以便 debuild/dpkg`.git`在创建源包时总是跳过任何目录？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-02-26T01:20:51.003

要忽略 .git 目录，请尝试：`debuild -S -i -I`

该`-i`选项将忽略由 VCS 软件等创建的许多文件和目录。它还将忽略可能仍然存在的构建工件（`.so`文件等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-27T03:29:12.240

如果您的代码位于 Git 存储库中，请安装`git-buildpackage`并使用它来创建您的 Debian 源代码包（`.dsc`和朋友）。

`git-buildpackage`默认情况下将`-i`选项设置为，这将在导出到源包时`dpkg-source`忽略目录。`.git`

它还带来了许多关于从 Git 存储库创建 Debian 包的附加功能，您可能需要也可能不需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:37:58.817

你可以使用这样的东西

```
git archive master | tar -x -C /somewhere/else 
```

然后从 /somewhere/else 创建不应包含 .git 目录的 .deb

# php - PHP如何遍历一个post数组

> ID：10262763
> 
> 赞同：16
> 
> 时间：2012-04-21T20:33:22.937
> 
> 标签：php, post

我需要遍历一个 post 数组并将其汇总。

```
#stuff 1
<input type="text" id="stuff" name="stuff[]" />
<input type="text" id="more_stuff" name="more_stuff[]" />
#stuff 2
<input type="text" id="stuff" name="stuff[]" />
<input type="text" id="more_stuff" name="more_stuff[]" /> 
```

但我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-21T20:37:02.640

你会这样做：

```
foreach( $_POST as $stuff ) {
    if( is_array( $stuff ) ) {
        foreach( $stuff as $thing ) {
            echo $thing;
        }
    } else {
        echo $stuff;
    }
} 
```

这照顾传入的变量和数组`$_POST`。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-16T15:23:08.333

您可能还需要每个表单元素的值，例如从下拉列表或复选框中选择的值。

```
 foreach( $_POST as $stuff => $val ) {
     if( is_array( $stuff ) ) {
         foreach( $stuff as $thing) {
             echo $thing;
         }
     } else {
         echo $stuff;
         echo $val;
     }
 } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-21T20:37:42.403

```
for ($i = 0; $i < count($_POST['NAME']); $i++)
{
   echo $_POST['NAME'][$i];
} 
```

或者

```
foreach ($_POST['NAME'] as $value)
{
    echo $value;
} 
```

替换`NAME`为元素名称，例如`stuff`或`more_stuff`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-26T08:32:31.493

我已经修改了接受的答案并将其转换为可以执行第 n 个数组并包含数组键的函数。

```
function LoopThrough($array) {
    foreach($array as $key => $val) {
        if (is_array($key))
            LoopThrough($key);
        else 
            echo "{$key} - {$val} <br>";
    }
}

LoopThrough($_POST); 
```

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-17T20:18:51.793

您可以使用 array_walk_recursive 和匿名函数，例如：

```
$sweet = array('a' => 'apple', 'b' => 'banana');
$fruits = array('sweet' => $sweet, 'sour' => 'lemon');
array_walk_recursive($fruits,function ($item, $key){
    echo "$key holds $item <br/>\n";
}); 
```

遵循这个答案版本：

```
array_walk_recursive($_POST,function ($item, $key){
    echo "$key holds $item <br/>\n";
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-31T22:33:16.680

出于某种原因，我使用发布的答案丢失了我的索引名称。因此我不得不像这样循环它们：

```
foreach($_POST as $i => $stuff) {
  var_dump($i);
  var_dump($stuff);
  echo "<br>";
} 
```

# ruby-on-rails - 编辑具有多个表单字段的单个属性

> ID：10262767
> 
> 赞同：0
> 
> 时间：2012-04-21T20:33:34.170
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, has-many-through

**背景：**用户和社区共享一个

> has_many：通过

关系。每个社区都有一个标识它的“community_type”字符串（即“Gender”、“City”等）。

**目标：**在我的编辑表单中，我想允许用户根据社区类型编辑他的 :community_ids。就像是：

> ```
> <%= form_for current_user do |f| %>
> <%= f.collection_select(:community_ids, Community.filtered_by("Gender"), :id, :name) %>
> <%= f.collection_select(:community_ids, Community.filtered_by("City"), :id, :name) %>
> <% end %> 
> ```

问题是表单只接受 :community_ids 的最后一个表单字段值 - 在这种情况下是“城市” - 而不是将它们全部合并为一个大的 :community_ids 数组。

**解决方案：**

对于那些感兴趣的人，我最终从以下答案重构了我的模型代码：

```
 %W[ community1 community2 community3 community4 ].each do |name|
    define_method "#{name}" do
      self.communities.filtered_by("#{name}").map(&:name)
    end
    define_method "#{name}_ids" do
      self.communities.filtered_by("#{name}").map(&:id)
    end
    define_method "#{name}_ids=" do |val|
      self.community_ids += val
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:10:07.487

更新以完成 tsherif 的（比我原来的）答案。

视图.rb

```
<%= form_for current_user do |f| %>
  <%= f.collection_select(:community_gender_ids, Community.filtered_by("Gender"), :id, :name, {}, id: 'community-gender-options') %>
  <%= f.collection_select(:community_city_ids, Community.filtered_by("City"), :id, :name, {}, id: 'community-city-options') %>
<% end %> 
```

模型.rb

```
def community_gender_ids=(cg_ids)
  self.community_ids ||= []
  self.community_ids += cg_ids
end

def community_city_ids=(cc_ids)
  self.community_ids ||= []
  self.community_ids += cc_ids
end

def community_gender_ids
  self.communities.select(:id).where(:community_type => 'gender').map(&:id)
end

def community_city_ids
  self.communities.select(:id).where(:community_type => 'city').map(&:id)
end 
```

或者，您可以编写一些 CoffeeScript/Javascript 来绑定到选择标签并将 ID 添加到隐藏值，然后将其与表单一起提交给服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:26:44.090

您是否有理由使用选择框来建立`has_many`关系？似乎复选框会更合适。如果您想使用选择框，我认为您不能使用`FormHelper#select`，因为据我所知，它需要一个值，而 your`community_ids`是一个数组。这就是为什么它只选择你给它的值之一。

对于选择框（或任何字段），您可以通过添加`[]`参数名称来组合字段中的值，该名称告诉 Rails 该参数是一个值数组。您可以通过使用常规`select_tag`创建字段并设置参数名称来执行此操作，如下所示：

```
<%= form_for current_user do |f| %>
  <%= select_tag("user[community_ids][]", options_for_select(Community.filtered_by("Gender").map{|c| [c.name, c.id]}, :selected => current_user.communities.filtered_by("Gender").first.id) %>
  <%= select_tag("user[community_ids][]", options_for_select(Community.filtered_by("City").map{|c| [c.name, c.id]}, :selected => current_user.communities.filtered_by("City").first.id) %>
<% end %> 
```

您也可以采用 Ryan 发送单独参数的方法，但一个缺点是您的`User`模型必须非常了解存在的社区类型，并且您必须在`User`模型中为每种类型的社区编写单独的逻辑。这将使您的资源不那么模块化。但是，如果您确实这样做，我建议您使用伪属性而不是 a`before_save`以便您`community_ids`从以下位置自动更新`params`：

```
class User < ActiveRecord::Base
  ...
  def community_gender_ids=(cg_ids)
    self.community_ids ||= []
    self.community_ids += cg_ids
  end

  def community_city_ids=(cc_ids)
    self.community_ids ||= []
    self.community_ids += cc_ids
  end
  ...
end 
```

然后你的`select_tag`电话看起来像这样：

```
<%= form_for current_user do |f| %>
  <%= select_tag("user[community_gender_ids][]", options_for_select(Community.filtered_by("Gender").map{|c| [c.name, c.id]}, :selected => current_user.communities.filtered_by("Gender").first.id) %>
  <%= select_tag("user[community_city_ids][]", options_for_select(Community.filtered_by("City").map{|c| [c.name, c.id]}, :selected => current_user.communities.filtered_by("City").first.id) %>
<% end %> 
```

# java - Java中的Facebook用户身份验证

> ID：10262768
> 
> 赞同：0
> 
> 时间：2012-04-21T20:33:38.477
> 
> 标签：java, facebook

我可以在 facebook iframe 中加载我的应用程序，但是任何人都可以帮助我在 java 中进行用户身份验证。任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:44:17.823

所有 java API 客户端都提供了有关身份验证的大量文档。这里有两个：

*   [休息fb](http://restfb.com/)
*   [春天社交脸书](http://static.springsource.org/spring-social-facebook/docs/1.0.x/reference/html/)

身份验证遵循[OAuth](http://oauth.net/2/)舞蹈，其中包括交换令牌。一个棘手的问题是，您应该将初始请求令牌存储在会话中，以便在 facebook 之后将用户重定向回来时能够获取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T21:39:42.797

您可以使用像[这样](http://code.google.com/p/facebook-java-sdk/)的 sdk，或者您可以通过[facebook api](https://developers.facebook.com/docs/authentication/)找到自己的方式，请求很简单。

# java - Java：生成任何大小的基于图块的圆圈

> ID：10262772
> 
> 赞同：0
> 
> 时间：2012-04-21T20:33:52.563
> 
> 标签：java, grid, geometry, tile

![在此处输入图像描述](../Images/9126b8a5270647c12f393ee6fa55444b.png)

以上是我一段时间以来一直试图弄清楚如何生成的模式。我非常想将圆的半径输入到一个方法中，并让它返回一个包含正确值的数组。（例如，0 = 最暗，1 = 较暗，2 = 较暗等）

我的问题是我不知道如何在数学上做到这一点。每增加一次半径，边界方块的边缘就会被侵蚀得更多。我没有看到尺寸 3、4、5 等之间变化的清晰模式。谁能帮我？谢谢！

这是我想出的一些信息：

*   半径 3 表示 (x-2,y-2) (x-2, y-1) 和 (x-1, y-2) 在左侧和每个其他相应的角上都不会改变。
*   半径 4 表示 (x-3, y-1) (x-3, y-2) (x-3,y-3) (x-2, y-2) (x-2, y-3) 和(x-1, y-3) 在左侧和每个其他相应的角落都没有改变。
*   x 中心点 - (Radius - 1) = 左，x 中心点 + (Radius - 1) = 右
*   y 中心点 - (Radius - 1) = 顶部，y 中心点 - (Radius - 1) = 底部

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:15:51.967

这个问题非常令人困惑，尤其是因为您的示例看起来根本不像一个圆圈。@pst 完全正确。您可以在屏幕外缓冲区绘制一个圆圈，然后将其用于输出。

例如，

```
import javax.swing.*;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.util.Arrays;

/**
 * @author Nicholas Dunn
 * @date 4/21/12
 */
public class CircleGridCreator {

    /**
     *
     * @param radius
     * @return 2 dimensional array in row major order, where entry is 0 if not part
     * of circle, or 1 otherwise
     */
    public static int[][] getGrid(int radius) {
        if (radius < 0) {
            throw new IllegalArgumentException("Invalid radius " + radius);
        }

        BufferedImage buffer = new BufferedImage(radius*2, radius*2, BufferedImage.TYPE_INT_RGB);
        Color c = Color.BLUE;
        Graphics2D context = buffer.createGraphics();
        context.setColor(c);
        context.fillOval(0, 0, radius * 2, radius * 2);

        int[][] results = new int[radius*2][radius*2];
        for (int row = 0; row < radius*2; row++) {
            for (int col = 0; col < radius*2; col++) {
                if (buffer.getRGB(col, row) == c.getRGB()) {
                    results[row][col] = 1;
                }
            }
        }
        return results;
    }

    public static void main(String[] args) {
        for (int i = 1; i < 10; i++) {

            int[][] grid = getGrid(i);

            for (int[] row : grid) {
                System.out.println(Arrays.toString(row));
            }
        }
    }

} 
```

输出：

```
[1, 1]
[1, 1]
[0, 1, 1, 1]
[1, 1, 1, 1]
[1, 1, 1, 1]
[1, 1, 1, 1]
[0, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1]
[0, 0, 1, 1, 1, 1, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 0, 1, 1, 1, 1, 1, 0, 0]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0]
[0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]
[0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0]
[0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0] 
```

# regex - 将 grep 用于 xinput 属性时遇到问题

> ID：10262778
> 
> 赞同：1
> 
> 时间：2012-04-21T20:34:42.983
> 
> 标签：regex, bash, grep, xinput

我正在尝试使用 grep 在命令行上解析出字符串属性。我正在使用以下方式获取属性：

```
jarrett@jarrett-g74s:~$ xinput --list-props "FSPPS/2 Sentelic FingerSensingPad"
Device 'FSPPS/2 Sentelic FingerSensingPad':
    Device Enabled (131):   0
    Coordinate Transformation Matrix (133): 1.000000, 0.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000, 0.000000, 1.000000
    Device Accel Profile (257): 0
    Device Accel Constant Deceleration (258):   1.000000
    Device Accel Adaptive Deceleration (259):   1.000000
    Device Accel Velocity Scaling (260):    10.000000
    Device Product ID (248):    2, 15
    Device Node (249):  "/dev/input/event9"
    Evdev Axis Inversion (261): 0, 0
    Evdev Axes Swap (263):  0
    Axis Labels (264):  "Rel X" (141), "Rel Y" (142)
    Button Labels (265):    "Button Left" (134), "Button Middle" (135), "Button Right" (136), "Button Wheel Up" (137), "Button Wheel Down" (138), "Button Horiz Wheel Left" (139), "Button Horiz Wheel Right" (140), "Button Unknown" (251), "Button Unknown" (251), "Button Forward" (254), "Button Back" (255), "Button Unknown" (251), "Button Unknown" (251), "Button Unknown" (251), "Button Unknown" (251)
    Evdev Middle Button Emulation (266):    0
    Evdev Middle Button Timeout (267):  50
    Evdev Third Button Emulation (268): 0
    Evdev Third Button Emulation Timeout (269): 1000
    Evdev Third Button Emulation Button (270):  3
    Evdev Third Button Emulation Threshold (271):   20
    Evdev Wheel Emulation (272):    0
    Evdev Wheel Emulation Axes (273):   0, 0, 4, 5
    Evdev Wheel Emulation Inertia (274):    10
    Evdev Wheel Emulation Timeout (275):    200
    Evdev Wheel Emulation Button (276): 4
    Evdev Drag Lock Buttons (277):  0 
```

该物业是`Device Enabled`。所以，我像这样使用grep：

```
jarrett@jarrett-g74s:~$ xinput --list-props "FSPPS/2 Sentelic FingerSensingPad" | grep "Device Enabled (131):"
    Device Enabled (131):   0 
```

哪个有效。但是，我想对整个属性字符串（包括末尾的 0 或 1）进行 grep，所以我试试这个：

```
jarrett@jarrett-g74s:~$ xinput --list-props "FSPPS/2 Sentelic FingerSensingPad" | grep "Device Enabled (131):*0" 
```

但是，这不会返回任何内容。我放了一个`*0`，我认为它会覆盖 0 之前的任何字符。有人知道为什么这不起作用吗？（我是 bash 工作的新手，我实际上是在 bash 脚本中运行它，但我也在命令行中运行它以进行测试，但它仍然不起作用）。

我很感激任何帮助！

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:40:02.403

这对于 shell glob 是正确的，但对于正则表达式则不然；`.*`匹配任意数量的任意字符，尽管您可能更喜欢`" *"`任意数量的空格（不带引号，我之所以输入引号只是因为否则空格将不可见）。您所拥有的`:*0`, 将匹配 . 之前的零个或多个冒号`0`。

# php - PHP 显示单个表格

> ID：10262782
> 
> 赞同：0
> 
> 时间：2012-04-21T20:35:13.950
> 
> 标签：php, html-table

目前，我从数据库中生成结果，然后将所有结果插入到一个 HTML 表中。

有什么方法可以让每个返回的结果都创建一个单独的 HTML 表（与进入一个 HTML 表的所有结果相反）

我的代码：

```
<table class=\"board\" width='100%' border='0' align='center' cellpadding='1' cellspacing='1'> 
");
            $type = $_GET["type"];
            if ($type == "" || $type == "request") {
                $get = mysql_query("SELECT * FROM request WHERE type='Request' AND deleted != 'yes' ORDER BY id DESC");
            } else {
                if ($type == "shoutout") {
                    $get = mysql_query("SELECT * FROM request WHERE type='Shoutout' AND deleted != 'yes' ORDER BY id DESC");
                } else {
                    if ($type == "competition") {
                        $get = mysql_query("SELECT * FROM request WHERE type='Competition' AND deleted != 'yes' ORDER BY id DESC");
                    } else {
                        if($type == "all") {
                            $get = mysql_query("SELECT * FROM request WHERE deleted != 'yes' ORDER BY id DESC");                            
                        }
                    }
                }
            }
            $num = @mysql_num_rows($get);
            if ($num == 0) {
                echo ("<div class=\"board\"><center><font color=\"red\">There aren't any requests in this category!<br />
Why not ask listeners to send in their requests?</font></center></div>");
            } else {
                while ($r = mysql_fetch_array($get)) {
                    echo " 
 <tr>
    <td><font face=\"verdana\" size=\"1\"><b>User</b></td>
    <td><font face=\"verdana\" size=\"1\"><b>$r[habboname]</b></td>
  </tr>
  <tr>
    <td><font face=\"verdana\" size=\"1\"><b>Date</b></td>
    <td><font face=\"verdana\" size=\"1\">$r[date]</td>
  </tr>
  <tr>
    <td><font face=\"verdana\" size=\"1\"><b>IP</b></td>
    <td><font face=\"verdana\" size=\"1\">$r[ip]</td>
  </tr>
  <tr>
    <td><font face=\"verdana\" size=\"1\"><b>Message</b></td>
    <td><font face=\"verdana\" size=\"1\">$r[message]</td>
  </tr>
   <tr>
    <td><font face=\"verdana\" size=\"1\"><b>Type</b></td>
    <td><font face=\"verdana\" size=\"1\">$r[type]</td>
  </tr>
  <tr>
  <!--  <td><font face=\"verdana\" size=\"1\"><b>Refferer</b></td>
    <td><font face=\"verdana\" size=\"1\">"; 
    if($r[refferer] == 1){ echo "Site.com</td>"; } else { echo "Site1.com</td>"; } 

echo "--></tr>
  <tr>
    <td><font face=\"verdana\" size=\"1\"><b>Commands</b></td>
    <td><a href=\"vrequest.php?id=$r[id]\"><font face=\"verdana\" size=\"1\">Delete</a> - <a href=\"mode.php?ban=1&id=$r[id]&ip=$r[ip]&message=$r[message]\">Ban</a> - <!--<a href=\"site_alert.php?type=user&ip=" . $r["ip"] . "\">Alert</a>--><a href=\"lotw.php\">Nominate LoTW</a></font></td>
  </tr>
  <tr>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  </tr>
";
                    $id = htmlspecialchars($_GET['id']);
                    $delete = mysql_query("UPDATE request SET deleted = 'yes' WHERE id = '$id'");
                }
                echo ("</table></div>");
            }
            break;
        case 'delete': 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:43:58.240

如果您的意思是创建与返回的行一样多的表，只需将开头`<table>`放在`while`'s 开头，将结尾`</table>`放在`while`. 但是，我不明白为什么会这样。你真的想用一行创建很多表吗？它有点违背了桌子的目的。制作一个列表或使用`span`'s 或除表格以外的任何其他内容。

```
while ($r = mysql_fetch_array($get)) {
echo "<table class=\"board\">
<tr>
  <td><b>User</b></td>
  <td><b>$r[habboname]</b></td>
</tr>
<tr>
  <td><b>Date</b></td>
  <td>$r[date]</td>
</tr>
  <tr>
  <td><b>IP</b></td>
  <td>$r[ip]</td>
</tr>
  <tr>
  <td><b>Message</b></td>
  <td>$r[message]</td>
</tr>
<tr>
  <td><b>Type</b></td>
  <td>$r[type]</td>
</tr>
<tr>
  <!--  <td><b>Refferer</b></td>
  <td>"; 

if($r[refferer] == 1){ echo "Site.com</td>"; } else { echo "Site1.com</td>"; } 

echo "--></tr>
<tr>
  <td><b>Commands</b></td>
  <td><a href=\"vrequest.php?id=$r[id]\">Delete</a> - <a href=\"mode.php?ban=1&id=$r[id]&ip=$r[ip]&message=$r[message]\">Ban</a> - <!--<a href=\"site_alert.php?type=user&ip=" . $r["ip"] . "\">Alert</a>--><a href=\"lotw.php\">Nominate LoTW</a></font></td>
</tr>
<tr>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
</table>";

$id = htmlspecialchars($_GET['id']);
$delete = mysql_query("UPDATE request SET deleted = 'yes' WHERE id = '$id'");
}

echo "</div>"; //remove () after echo 
```

* * *

更新。另一件事。请不要使用内联样式。你有`table class="board"`，所以你可能已经知道 CSS 的力量了。

第二次更新。我删除了`<font ...>`标签。例如像这样使用 CSS：

```
table.board{
  width:100%;
  border:0;
  align:center;
  cellpadding:1;
  cellspacing:1;
}

table.board td{
  font-family: Verdana, Geneva, Arial, sans-serif;
  font-size: 1em;
} 
```

当您想要更改样式时，CSS 可以省去很多麻烦。相信我，总有一天你会想要改变它（或者你的老板想要对网站进行炫耀......）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T21:17:03.043

ZZ-bb is absolutely right and as a hint try to put if/else construction in mysql - it will move faster or optimize it in php, like:

```
$get = mysql_query("SELECT * FROM request WHERE " . ($type == 'all' ? 'type = 1' : 'type = ucfirst($type)' ) . " AND deleted != 'yes' ORDER BY id DESC"); 
```

# regex - 两个正则表达式的区别

> ID：10262783
> 
> 赞同：2
> 
> 时间：2012-04-21T20:35:14.310
> 
> 标签：regex

我有两个正则表达式：

```
«(\w+\.)+?» 
```

和

```
«(\w+\.)+» 
```

我认为第一个会尝试找到最小的模式，但对于下一个，我不知道。

有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:40:41.237

它被称为“贪婪”与“非贪婪”，这里有一个很好的[概述](http://www.regular-expressions.info/repeat.html)。

考虑一些更简单的事情：

```
.+?\s 
```

如果文本是这句话，第一个例子会匹配“If”，因为“?” 修饰符让它寻找最小的匹配。

```
.+\s 
```

如果这个句子被第二个例子匹配，整个句子将被返回（直到 .），因为它是最大的匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:43:45.723

这是一个贪婪与非贪婪正则表达式的示例。（它在 java 文档中有介绍）

[http://docs.oracle.com/javase/tutorial/essential/regex/quant.html](http://docs.oracle.com/javase/tutorial/essential/regex/quant.html)

# php - 与后台服务交互？

> ID：10262786
> 
> 赞同：1
> 
> 时间：2012-04-21T20:35:27.103
> 
> 标签：php

与后台服务交互的最佳方式是什么？我有一个在后台运行的 C# 程序来处理向外部服务器发送 api 请求。我希望 php 能够对服务的 api 请求进行排队并获得响应。所以这是我的两个想法。哪个更好或有更好的方法？

C# 服务运行一个迷你 http 服务器来接受 api 请求。php 脚本将 api 请求发送到服务而不是 api。服务完成请求并将响应添加到数据库。php 脚本检查数据库中 api 响应（由 ajax 请求触发）的状态。

或者

C# 服务轮询 api 请求的队列表。php 脚本将请求行添加到队列中。当服务找到行时，它会完成请求并将响应添加到响应表或更新队列行。php 脚本检查数据库中 api 响应（由 ajax 请求触发）的状态。

第二个想法似乎更容易执行，但我想不断轮询数据库（MYSQL）可能不是一个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:40:02.297

使用[消息队列](http://en.wikipedia.org/wiki/Message_queue)，例如[RabbitMQ](http://www.rabbitmq.com/)。

# ruby-on-rails - 清除嵌入式文档 Mongoid

> ID：10262792
> 
> 赞同：0
> 
> 时间：2012-04-21T20:36:40.363
> 
> 标签：ruby-on-rails, mongoid

有没有办法清除所有嵌入文档的数据。

例如，我有一个联系人：

*   电子邮件地址
*   电话号码
*   地址

我有所有这些字段的新数据，我想全部替换它们。这是通过 gem 完成的，所以它必须是动态的。我不能只调用每个嵌入式模型并运行 destroy_all。

从嵌入式文档中删除所有数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T19:35:09.057

没有更好的办法。您必须在要清除的每个引用上调用 destroy_all。这是一个特定领域的要求，不是很常见。

# java - java.lang.NoClassDefFoundError: BoothServer

> ID：10262794
> 
> 赞同：0
> 
> 时间：2012-04-21T20:36:52.607
> 
> 标签：java

我正在按照本教程[http://stilius.net/java/java_ssl.php](http://stilius.net/java/java_ssl.php)创建简单的 SSLServer 和客户端套接字。我已经使用 keytool 创建了证书，但是我在执行上述教程中的这一行时遇到了问题，

“java -Djavax.net.ssl.keyStore=mySrvKeystore -Djavax.net.ssl.keyStorePassword=123456 EchoServer”。

我应该把证书放在哪里？在项目目录中？我怎样才能传递上面提到的参数？

我正在这样做并出错；

```
C:\Users\abc\workspace\VirtualElectionBoothServer\bin>java -Djavax.net.ssl.keyStore=mySrvKeystore -Djavax.net.ssl.keyStorePassword=123456 BoothServer
    Exception in thread "main" java.lang.NoClassDefFoundError: BoothServer
Caused by: java.lang.ClassNotFoundException: BoothServer
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: BoothServer.  Program will exit. 
```

## 编辑：

我的问题是我从不从命令行运行项目，所以我不知道如何从命令行运行这一行；

```
C:\Users\abc\workspace\VirtualElectionBoothServer\bin>java -Djavax.net.ssl.keyStore=mySrvKeystore -Djavax.net.ssl.keyStorePassword=123456 BoothServer 
```

我应该从哪个目录运行它？我有不止一个 .java 文件。运行哪一个？一个有main（）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T21:00:09.337

看起来您不知道如何从命令行运行 Java 应用程序。

我只是假设您的`BoothServer`课程不在一个包中。如果是，请使用其全名（例如`the.package.name.BoothServer`）。

我还将假设您已经在 eclipse 中编译了它，并且生成的类文件在`bin`目录中。（如果你使用包，你应该把你的文件放在 . 目录下`bin\the\package\name\BoothServer.class`。如果是这种情况，用实际的包名替换目录名，当然。）

> javax.net.ssl.SSLException：没有可用的证书或密钥对应于启用的 SSL 密码套件

这是找不到密钥库时发生的典型错误（以及其他原因）。

确保您使用的路径`-Djavax.net.ssl.keyStore=`指向您生成的实际密钥库。例如，`-Djavax.net.ssl.keyStore=..\mySrvKeyStore`如果您的文件位于`C:\Users\abc\workspace\VirtualElectionBoothServer`.

我还怀疑 Eclipse 可能会在`bin`每次重新编译时清除内容（不确定），因此`bin`不一定是保存该密钥库文件的好地方。

# ruby-on-rails - Rspec and_return 按 id 排序？

> ID：10262795
> 
> 赞同：0
> 
> 时间：2012-04-21T20:36:58.053
> 
> 标签：ruby-on-rails, testing, rspec

使用以下 rspec 测试：

```
@search_text = "California"
@search_condition = "location"
Video.stub_chain(:where,:order).and_return([@vid1,@vid2,@vid3])
Video.should_receive(:where).with("lower(#{@search_condition}) LIKE ?", "%#{@search_text}%".downcase)

return_val = Video.search(@search_text, @search_condition)
return_val.should == [@vid1,@vid2,@vid3] 
```

测试以下范围：

```
 scope :search, (lambda do |search_text, search_condition|
                where("lower(#{search_condition}) LIKE ?", "%#{search_text}%".downcase).order("name")
              end) 
```

我为 return_value 获得的值不会使我从 stub_chain 返回的值。特别是，返回的数组中的项目是相同的，但它们的顺序似乎是按 id 而不是按名称排序的。有谁知道为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T21:03:15.957

尝试这个：

```
unordered_videos = double "Video"
Video.should_receive(:where).with("lower(#{@search_condition}) LIKE ?", "%#{@search_text}%".downcase).and_return unordered_videos
unordered_videos.should_receive(:order).and_return [@vid1,@vid2,@vid3] 
```

# php - 如何阻止“为 foreach() 提供的参数无效”在网站前端被报告

> ID：10262797
> 
> 赞同：0
> 
> 时间：2012-04-21T20:37:10.360
> 
> 标签：php, sql

`PHP Warning: Invalid argument supplied for foreach() in /home/synergie/public_html/ss/libraries/joomla/database/database/mysql.php on line 377`

它间歇性地出现，但经常出现在我的 joomla 网站的前后。我不是这方面的专家，但它似乎超出了我寻求帮助的每个人的范围。由于我无法阻止错误的发生，我希望您能帮助我禁用或阻止它报告。

这是我正在处理的代码：

```
 // If we want the whole field data object add that to the list.
            //else
            {
                foreach ($fields as $field)
                {
                    $result[$field->Field] = $field;
                }
            }

            return $result; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:54:41.960

你确定你循环的是一个数组而不是一个对象吗？可以肯定的是，考虑更改为：

```
foreach((array)$fields as $field)
{
    $result[$field->Field] = $field;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T20:40:03.777

也许是一个 try catch 块？

```
try {
    foreach( $array as $v ) {
        // do dtuff
    }
} catch( Exception $e ) {
    echo 'Caught exception';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T21:17:40.217

Instead of hiding the error, you should be checking that you are passing something [`Traversable`](http://php.net/manual/en/class.iterator.php) to [`foreach()`](http://php.net/manual/en/control-structures.foreach.php). You can do that with [@NullUserException's `is_iterable()`](https://stackoverflow.com/a/3584781/568785):

```
function is_iterable($var) {
    return (is_array($var) || $var instanceof Traversable);
}

if(is_iterable($fields)) {
     foreach($fields as $field) {
         // Processing $field here
     }
} else {
    echo "Fields is not iterable";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-21T20:41:06.150

您可以使用此功能关闭错误报告：

```
error_reporting(0); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-21T20:44:07.100

如果这是一个生产环境，并且您只是想禁用这样的警告消息（我假设这是您在提到 Joomla 后没有编写的代码），请尝试在您的 php.ini 文件中禁用错误​​报告。

改变：

```
display_errors On 
```

至

```
display_errors Off 
```

请注意，如果这是一个开发环境，您可能应该保留错误报告并修复任何警告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-17T12:17:28.073

我肯定会选择语法：

```
if(is_array($fields)){
    foreach($fields as $field){
        //do stuff
    }
} 
```

小心使用漂亮而有吸引力的简短形式：

```
foreach((array)$fields as $field) 
```

如果 $fields 包含复杂的数据结构（不是简单的数组），则转换可能会损害您的内容。

# java - java中将ArrayList转为数组的方法

> ID：10262798
> 
> 赞同：0
> 
> 时间：2012-04-21T20:37:16.433
> 
> 标签：java, arrays

在这里我有

```
class x{
    ArrayList<Double> values;
    x() {
        values= new ArrayList<Double>();
    } 
```

//这里我想写一个方法来将我在class(x)中的arraylis(values)转换成一个数组，以便能够在我的程序中使用它。有没有办法做到这一点。谢谢你的帮助。

```
public double [] getarray(){

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:51:44.000

您实际上并不需要将 ArrayList 转换为数组，但如果您这样做了，方法如下。

```
public double [] getArray(){
    double[] array = new double[values.size()];
    for(int i =0;i<values.size();i++)
    {
        array[i] = values.get(i) != null ?values.get(i):  0.0;
    }
    return array;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:44:14.947

您的数组列表有一个 toArray() 方法。尝试使用这样的：

```
public double [] getarray(){
    return values.toArray();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T20:53:27.920

[在Apache Commons Lang](http://commons.apache.org/lang/download_lang.cgi)的帮助下（见：） [`ArrayUtils.toPrimitive()`](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/ArrayUtils.html#toPrimitive%28java.lang.Double%5b%5d%29)：

```
final ArrayList<Double> objList = new ArrayList<Double>();
final Double[] objArray = objList.toArray(new Double[objList.size()]);
final double[] primArray = ArrayUtils.toPrimitive(objArray); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T22:56:27.183

如果问题是将其转换为原始类型`double[]`，并且您可以使用[Guava](http://guava-libraries.googlecode.com)，那么[`double[] Doubles.toArray(Collection<Double>)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/primitives/Doubles.html#toArray%28java.util.Collection%29)这项工作就可以了。（披露：我为 Guava 做出了贡献。）

# android - ListPreference 如何获取已选择项目的 onClick 事件？

> ID：10262799
> 
> 赞同：3
> 
> 时间：2012-04-21T20:37:22.687
> 
> 标签：android, sharedpreferences, listpreference

我有一个 ListPreference，我需要在选择一个项目后进行一些操作， **即使它是选定的项目**

我尝试这个事件：

```
@Override
public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,String key) {... 
```

但只有当我选择其他项目时我才会得到它。

谢谢你帮助我。

# php - Views Galleriffic 分页不显示

> ID：10262800
> 
> 赞同：0
> 
> 时间：2012-04-21T20:37:31.547
> 
> 标签：php, drupal, module, views, themes

当我更新视图模块 6.x-3.x-dev 时，视图 Galleriffic 6.x-1.x-dev 中没有显示分页。[http://demo.dolphin-sch.ir/Doctor/fa/galleriffic/95](http://demo.dolphin-sch.ir/Doctor/fa/galleriffic/95)我设置使用寻呼机：分页，9 个项目和样式：Galleriffic 画廊启用底部寻呼机：是的，我添加了 17 个图像。请指导我我想显示分页，像这个链接[http://demo.dolphin-sch.ir/nagara/fa/galleriffic/95](http://demo.dolphin-sch.ir/nagara/fa/galleriffic/95)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T02:34:54.287

1) 关闭视图分页器（即将其设置为“所有项目”）。

2) 在“样式”中设置要在寻呼机前显示的缩略图数量。如果您有 17 张图像，您可以在此处将其设置为“9”。

3) 确保您在“样式”中将顶部或底部寻呼机设置为“是”。

运气好的话？我刚刚使用 views-6.x-3.x 对其进行了测试，因此如果您有正确的设置，它应该可以工作。

# sql - 数据库结构，一个大实体多个实体

> ID：10262805
> 
> 赞同：0
> 
> 时间：2012-04-21T20:38:16.073
> 
> 标签：sql, database, architecture, structure

假设我有一个商店网站，用户可以在其中对任何产品发表评论。

假设我的网站数据库中有表格（实体）：让它成为“鞋子”、“帽子”和“溜冰鞋”。我不想为每个实体创建单独的“评论”表（如“shoes_comments”、“hats_comments”、“skates_comments”）。我的想法是以某种方式将所有评论存储在一张大表中。

我想到的一种方法是创建一个表：

```
table (comments): 
ID (int, Primary Key), 
comment (text),  
Product_id (int), 
isSkates (boolean), 
isShoes (boolean), 
isHats (boolean) 
```

并为每个可能有评论的实体点赞。

然后，当我想获得某些产品的评论时，SELECT 查询将如下所示：

```
SELECT comment 
FROM comments, ___SOMETABLE___
WHERE ____SOMEFLAG____ = TRUE 
  AND ___SOMETABLE___.ID = comments.Product_id 
```

这是为所需功能实现数据库的有效方法吗？我还有什么其他方法可以做到这一点？>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:44:21.640

我建议您为评论制作一个表，并在评论表中使用其他表的外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:52:48.313

对不起，这感觉很奇怪。

您是否确实为每种产品类型提供了一个单独的表格？他们没有共同的领域（例如名称、描述、价格、产品图片等）吗？

我对表格的建议：`product`对于公共字段，`comments`具有外键`product`但没有`hasX`列，`hat`只有特定于帽子产品线的字段。中的主键`hat`是`product`PK 或单独的唯一值（那么您需要一个额外的字段作为外键的`product`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T21:05:49.990

执行此操作的“标准化”方法是添加一个实体（例如，“产品”），将鞋子、帽子和溜冰鞋的所有共同特征（包括评论）分组

```
 +-- 0..1 [Shoe]
              |
[Product] 1 --+-- 0..1 [Hat]
    1         |
    |         +-- 0..1 [Skate]
    *
[Comment] 
```

除了性能考虑之外，这里的缺点是数据模型中没有任何内容阻止 Product 中的一行被 Shoe 中的一行和 Hat 中的一行引用。

还有其他替代方案（每个都有优点和缺陷）-您可能想阅读有关“jpa继承策略”的内容-您会发现讨论相同问题的java特定文章（只需忽略java babbling并阅读其余部分）

就个人而言，我经常最终对层次结构中的所有实体（在我们的例子中是鞋、帽子和溜冰鞋）使用一个表，并牺牲对性能和简单性的限制（例如：在鞋类必需的字段中不为空，但不适合帽子和溜冰鞋）。

# sql-server-2008 - 使用 odbc 驱动程序从链接服务器检索表列表

> ID：10262806
> 
> 赞同：0
> 
> 时间：2012-04-21T20:38:23.370
> 
> 标签：sql-server-2008, odbc, linked-server

我有一个使用 ODBC 驱动程序的 SQL 链接服务器。如果我已经知道要查看的表的名称，我可以像这样检索它：

```
select * from GPData..root.TableName 
```

问题是我知道查看所有可用表的唯一方法是打开 Microsoft Access 并表现得就像我要创建一个链接表一样，在此过程中它会列出表供我选择。

有没有办法可以直接从 SSMS 列出表格？如果没有，我该如何以编程方式进行（最好在 C# 中）？必须有某种方式，因为 Access 显然能够做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T03:09:50.910

这是我在 C# 中的做法。我创建了一个带有两个文本框的表单。DSNTextBox 采用 ODBC DSN 的名称，OutputFileText 采用您要放置生成的 sql 文件的目录，其中包含为找到的每个表创建视图的命令。

运行 sql 文件后，我可以通过视图访问表，就好像它们是我自己的数据库的一部分一样。这样我可以在编写查询时浏览表名，而不必事先知道表的名称。

```
 OdbcConnection con = new OdbcConnection();
    con.ConnectionString = "DSN=" + DSNTextBox.Text;
    con.Open();

    DataTable schema = con.GetSchema("tables");

    foreach (DataRow r in schema.Rows)
    {
        var name = r["TABLE_NAME"];
        sqlLines.Add("create view " + name + " as select * from " + DSNTextBox.Text + "..root." + name);
        sqlLines.Add("go");
    }
    con.Close();

    if(OutputFileTextBox.Text.Substring(OutputFileTextBox.Text.Length - 1, 1) != "\\") 
        OutputFileTextBox.Text += "\\";

    File.WriteAllLines(OutputFileTextBox.Text + DSNTextBox.Text + ".sql" , sqlLines.ToArray()); 
```

# android - 未调用自定义 ArrayAdapter 的 getView

> ID：10262813
> 
> 赞同：1
> 
> 时间：2012-04-21T20:39:19.770
> 
> 标签：android, android-layout

由于某些原因，我的自定义 ArrayAdapter 的 getView 没有被调用，并且 android 显示一个空列表。我已经在我的数据源类中插入了 cursor.getCount() 以确保我的查询不为空。

活动：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(TAG, "onCreate called");

    setContentView(R.layout.conference_list_layout);

    Log.d(TAG, "create ConferenceDataSource");
    datasource = new ConferenceDataSource(this);

    Log.d(TAG, "open ConferenceDataSource");
    datasource.open();

    Log.d(TAG, "getAllUpcomingConferences");
    List<Conference> conferences = datasource.getAllUpcomingConferences();

    Log.d(TAG, "set ConferenceArrayAdapter");
    setListAdapter(new ConferenceArrayAdapter(this, conferences));
} 
```

数据源：

```
public List<Conference> getAllUpcomingConferences() {
    Log.d(TAG, "getAllUpcomingConferences called");

    List<Conference> conferences = new ArrayList<Conference>();

    Cursor cursor = database.query(
            DatabaseConstants.TABLE_CONFERENCES, 
            fields, 
            DatabaseConstants.CONFERENCE_START + ">" + (Calendar.getInstance()).getTimeInMillis(), 
            null, 
            null, 
            null, 
            null);

    cursor.moveToFirst();

    while(!cursor.isAfterLast()) {
        Conference conference = cursorToConference(cursor);
        conferences.add(conference);
        cursor.moveToNext();
    }

    cursor.close();

    return conferences;
}

private Conference cursorToConference(Cursor cursor) {
    Log.d(TAG, "cursorToConference called");

    Conference conference = new Conference();

    conference.setId(
            cursor.getLong(cursor.getColumnIndex(DatabaseConstants.CONFERENCE_ID)));

    conference.setStart(
            cursor.getLong(cursor.getColumnIndex(DatabaseConstants.CONFERENCE_START)));

    conference.setEnd(
            cursor.getLong(cursor.getColumnIndex(DatabaseConstants.CONFERENCE_END)));

    conference.setTopic(
            cursor.getString(cursor.getColumnIndex(DatabaseConstants.CONFERENCE_TOPIC)));

    conference.setCreator(
            cursor.getLong(cursor.getColumnIndex(DatabaseConstants.CONFERENCE_CREATOR)));

    return conference;
} 
```

阵列适配器：

```
public ConferenceArrayAdapter(Context context, List<Conference> conferences) {
    super(context, R.layout.conference_list_item);
    Log.d(TAG, "constructor called");
    this.context = context;
    this.conferences = conferences;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    Log.d(TAG, "getView called");

    LayoutInflater inflator = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View view = inflator.inflate(R.layout.conference_list_item, parent, false);

    Date conferenceDate = new Date(conferences.get(position).getStart());

    TextView dayOfWeek = (TextView) view.findViewById(R.id.conference_list_dayofweek);

    dayOfWeek.setText(new SimpleDateFormat("E").format(conferenceDate));

    TextView date = (TextView) view.findViewById(R.id.conference_list_date);

    date.setText(new SimpleDateFormat("dd.MM.yyyy").format(conferenceDate));

    TextView time = (TextView) view.findViewById(R.id.conference_list_time);

    time.setText(new SimpleDateFormat("HH:mm").format(new Date(conferences.get(position).getStart())) + 
            new SimpleDateFormat("HH:mm").format(new Date(conferences.get(position).getEnd())));

    return view;
} 
```

会议列表布局.xml

```
<include layout="@layout/actionbar_layout" />

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:orientation="vertical">

    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

会议列表项目.xml

```
<TextView
    android:id="@+id/conference_list_dayofweek"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true" />

<TextView
    android:id="@+id/conference_list_date"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@id/conference_list_dayofweek" />

<TextView
    android:id="@+id/conference_list_time"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@id/conference_list_date" /> 
```

可能是错误在xml文件中。我正在使用几个自定义的 ArrayAdapter，它们都可以正常工作并且看起来几乎相同。我读过一些关于使用 match_parent 而不是 wrap_content 的内容，但没有成功。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-21T20:46:40.560

在您的自定义适配器（您可能正在扩展`ArrayAdapter`）中实现该[`getCount`](http://developer.android.com/reference/android/widget/ArrayAdapter.html#getCount%28%29)方法并返回`Conferences`大小列表：

```
public int getCount() {
   return conferences.size();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:46:29.587

您需要`extends ArrayAdapter`为您的数组适配器类 - 否则它不知道要调用的方法

# javascript - 主干js中的自定义鼠标事件

> ID：10262822
> 
> 赞同：1
> 
> 时间：2012-04-21T20:40:55.210
> 
> 标签：javascript, backbone.js, backbone-events

支持自定义鼠标事件的好方法是什么？例如，我目前有：

```
events: {
  "mousedown .canvas-container" : "getPixel",
}, 
```

但是`mousedown`，我想创建一个名为的自定义事件，而不是和`mousedrag`的组合。有没有推荐的方法来添加这样的自定义事件？`mousedown``mousemove`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T07:53:55.197

由于 Backbone 元素事件只是 jQuery（或您使用的任何库）事件，您可能想要使用 jQuery UI：http: [//jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)。通过使用 jQuery 和 Backbone 加载，您将拥有“拖动”事件，您可以将其绑定到代码中，就像任何其他事件一样：

```
 events: { "drag .canvas-container" : "getPixel" } 
```

当然，有一种方法可以在 jQuery 中创建自定义事件，但我认为可拖动对象需要做很多工作，因为它已经编写了跨浏览器支持，所以最好使用 jQuery UI。

PS jQuery UI 是完全可定制的，因此您可以在网站上构建自己的版本，其中包括您想要的特定方法：http: [//jqueryui.com/download](http://jqueryui.com/download)

# c# - 在写入文件之前写入缓冲区以避免被锁定

> ID：10262827
> 
> 赞同：0
> 
> 时间：2012-04-21T20:41:10.360
> 
> 标签：c#, io, buffer

我目前正在处理需要将内容写入文件的 ac# 项目。在写入文件时，一个单独的线程会访问文件以获取文件大小，因此有时当我写入文件时，它会被锁定，因为文件大小检查已锁定文件。

我想做的是创建某种缓冲区，但是每当我用谷歌搜索它时，它都会返回不适合作为本地的网络流。计划不是直接写入文件的线程，而是写入某种缓冲区，一个单独的线程检查文件是否可写，然后读取缓冲区并将内容写入文件。

另一个问题是我需要添加一个参数，以便当它写入文件时它会写入正确的文件，因为我的程序正在接收来自多个地方的输入，所以我需要将此值保存在缓冲区中的某个位置，但来自我所拥有的看到流你只能写字符串。

所以基本问题是如何写入缓冲区然后从缓冲区读取，以便将其写入文件并将参数保留在缓冲区中，以便在写入文件时知道要写入哪个文件。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:52:03.320

声明一个具有缓冲区空间和文件规范的类。为每个写入创建一个并将其排队到 BackgroundWorker 写入线程。线程将缓冲区实例出列并使用合适的 sleep() 循环 etry 写入文件，以确保解决任何临时文件锁定问题。

您可以为队列使用 BlockingCollection。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:56:59.433

获取文件的长度不应锁定文件。你是怎么做那个手术的？

如果您使用缓冲区，您的长度检查操作将不再为您提供正确的值。

# python - 我可以在python类层次结构中调用超类中的方法而不使用当前类的名称吗

> ID：10262831
> 
> 赞同：0
> 
> 时间：2012-04-21T20:41:45.183
> 
> 标签：python, python-2.7

我知道在 python 中调用超类中的方法的最佳方法是编写：

```
class Foo(Bar):
    def foo(self):
        ...
        super(Foo, self).foo()
        ... 
```

但是，这意味着如果我更改类 Foo 的名称或将代码剪切并粘贴到另一个类中，我必须记住更改调用超类中的方法的行。有没有办法解决这个问题？至少很烦人，最坏的情况是很容易出错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:51:39.937

在 Python 3 中，您可以编写`super()`它，它会为您填写课程。

在 Python 2 中，您需要编写类的名称。但是更改类的名称并不完全是一种常见的操作，所以我真的不认为这有多困难。如果你改变它，你只需要记住搜索和替换类的名称——但是你可能无论如何都必须这样做，因为它的子类也会按名称引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T22:15:07.620

您的意思是对每个人来说都是简单、安全且易于理解的方式（就 super() 而言）？

简短的回答：没有。

长答案：是的。有几种方法可以做到这一点。其中之一是使用元类在类初始化期间自动创建 super()。

```
>>> class AutoSuper(type):
...     def __init__(cls, name, bases, dict):
...         super(AutoSuper, cls).__init__(name, bases, dict)
...         setattr(cls, '_%s__super'%name, super(cls))
... 
>>> 
```

因此，对正在创建的类的 super() 调用分配给 __super 属性。名称修改必须手动完成，但实例和子类会相应地命中它。现在您甚至不必调用 super，只需使用 __super 属性即可。

```
>>> class A(object):
...     __metaclass__ = AutoSuper
...     def m(self):
...         print 'A'
... 
>>> 
>>> class B(A):
...     def m(self):
...         print 'B'
...         self.__super.m()
... 
>>> 
>>> class C(B):
...     def m(self):
...         print 'C'
...         self.__super.m()
... 
>>> obj = C()
>>> obj.m()
C
B
A
>>> 
```

当然，我只是出于学习目的发布此内容，我不建议使用它。这就是某些人在 Python 中谴责的[过分聪明的事情。](http://www.ibm.com/developerworks/linux/library/l-pymeta3/index.html)

# iphone - 如何将我的方法添加到 UITableviewDelegate

> ID：10262833
> 
> 赞同：0
> 
> 时间：2012-04-21T20:42:15.400
> 
> 标签：iphone

是否可以在 UITableViewDelegate 添加我自己的方法？如果可能，请使用一些示例进行解释。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:47:49.993

您可以将 UITableViewDelegate 协议“子类化”，但您也必须将 UITableView 子类化，以便在所需时间调用这些方法。

```
@protocol MyTableViewDelegate <UITableViewDelegate>
- (void)newMethod;
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T21:09:56.777

我认为您的意思是“是否可以在 UITableView 委托中添加我自己的方法？” 如果是这样，是的，你可以；我建议你从 Apple 提供的 UITableViewController 模板开始。只需在标题行后面加上代码即可添加您的方法；这使它们能够从您的 tableViewController 中被调用。如果您还希望它们可从其他对象调用，那么还将标题行添加到 .h 文件中，然后将该标题导入将调用您的 tableViewController 的对象中。

# python - 匹配文件中的部分行（python）

> ID：10262838
> 
> 赞同：2
> 
> 时间：2012-04-21T20:42:35.570
> 
> 标签：python, regex, bioinformatics, fasta, complement

我目前在一个文件中有一个基因列表。每条线都有一条带有它的信息的染色体。这样的条目显示为：

NM_198212 chr7 + **115926679** **115935830** 115927071 11593344 2 *115926679* ,'115933260', *115927221* ,'115935830',

染色体的序列从碱基**115926679**开始，一直到（但不包括）碱基**115935830**

如果我们想要拼接序列，我们使用外显子。第一个从 *115926679*延伸到*155927221*，第二个从 '115933260' 到 '115935830'

但是，我在互补序列上遇到了一个问题，例如：

NM_001005286 chr1 - **245941755** ***245942680*** 245941755 245942680 1 *245941755*，'245942680'

由于第 3 列是“-”，因此这些坐标是指反义链（链的补码）。第一个碱基（粗体）与有义链上的最后一个碱基（斜体）匹配。由于文件只有有义支架，我需要尝试将反义链上的坐标转换为有义链，挑选出正确的序列，然后对其进行反向补码。

也就是说，我只编程了大约半年，并且不知道如何开始这样做。

我写了一个正则表达式：

```
'(NM_\d+)\s+(chr\d+)([(\+)|(-)])\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+)\s+(\d+),(\d+),s+(\d+),(\d+),' 
```

但现在我不确定如何启动这个功能......如果有人可以帮助我开始这方面的工作，也许让我知道如何做到这一点，我将非常感激。

好的：假设这是 25 号染色体：

啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊！

（每个字符有 10 个）。

现在：如果我正在寻找未剪接的基因：chr25 + 10 20

然后基因从位置 10（从 0 开始）开始，向上但不包括位置 20。所以它：

中交中交中交

这很简单。它非常适合 python 字符串切片。

如果我给你，它会更令人困惑：

chr25 - 10 20

你所拥有的是积极的一面。但是这个基因在负（互补）链上。记住染色体看起来像双链：

啊啊
啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊！

我们正在寻找底部链上的基因。这意味着我们从右边开始从 0 开始计数。上链从左开始编号，下链从右开始。所以我在这里想要的是 AAAAAAAAAA。

问题是我只给你最上面的部分。我不会给你底线。（你可以从顶层生成自己——但考虑到它有多大，我建议不要这样做。）

所以你需要转换坐标。在底链上，碱基 0（最右边的 C）与顶链上的碱基 39 相对。以 1 为底数与 38 为底数。以 2 为底数以 37 为底数。（重要一点：注意每次将这两个数字相加时会发生什么。）因此，以 10 为底数以 29 为底数，以 19 为底数以 20 为底数。

所以：如果我想在底部链上找到基数 10-20，我可以查看顶部的基数 20-29（然后反向补码）。

我需要弄清楚如何将底部链上的坐标转换为底部链上的等效坐标。是的：这很混乱

我试过[weronika的原始答案](https://stackoverflow.com/a/10263670/456876)：

```
fields = line.split(' \t')
geneID, chr, strand = fields[:2]
start = int(fields[3])
end = int(fields[4])
if strand == '-':
    start,end = -(start + 1), -(end + 1) # this part was changed from original answer. 
```

这是在正确的轨道上，但这还不够。这将把 10 和 20 变成 20 和 10。

而且我知道我可以通过这样做来反向补充字符串：

```
r = s[::-1]
bc = {'A': 'T', 'C': 'G', 'G': 'C', 'T': 'A'}
l = list(r)
o = [bc[base] for base in l]
     return ''.join(o) 
```

**已编辑！这看起来对吗？！**

```
fp2 = open('chr22.fa', 'r')
fp = open('chr22.fa', 'r')
for line in fp2:
    newstring = ''
    z = line.strip()
    newstring += z
for line in fp:
    fields = line.split('\t')
    gene_ID, chr, strand = fields[:2]
    start = int(fields[3])
    end = int(fields[4])
    bc = {'A': 'T', 'C': 'G', 'G': 'C', 'T': 'A', 'a': 't', 't': 'a', 'c':'g', 'g':'c', 'N':'N', 'n':'n'}
    l = list(newstring)        
    if strand == '+':
        geneseq = ''.join([bc[base] for base in l[start:end]]) 
    if strand == '-':
        newstart, newend = -(start + 1), -(end + 1)
        genseq = ''.join([bc[base] for base in l[newstart:newend]]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T21:51:22.620

我不明白域问题，但看起来你试图在一个正则表达式中塞进太多东西。尝试将其分解为更简单的子问题，如下所示（在伪代码中）：

```
if third column is a '+'
    parseRegularSequence()
else
    parseComplementarySequence() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T22:42:04.927

正如我在对该问题的评论中所指出的，这似乎是一种非常奇怪的文件格式，因此我最初感到困惑。

注意：如果这是标准生物学文件格式之一，您最好使用[Biopython](http://www.biopython.org/DIST/docs/tutorial/Tutorial.html)或类似的东西来解析它。

如果您想进行自己的解析，正则表达式似乎仍然是错误的方法 - 使用简单的空格/制表符分隔文件难以阅读且不必要。我假设你已经解析了你的染色体 fasta 文件，并将所有染色体的序列作为`chrom_sequences`name:seq 字典，并且你有一个`reverse_complement`函数（这两件事都可以很容易地手动实现，但用 biopython 可能更好） .

```
fields = line.split(' ')  # or '\t' instead of ' ' if the file is tab-separated
gene_ID, chr, strand = fields[:2]
start, end = [int(x) for x in fields[3:5])
this_chromosome_seq = chrom_sequences[chr]
# if strand is +, just take the sequence based on the start-end position
if strand == '+':
  # be careful about off-by-one errors here - some formats give you a 1-based position, 
  #  other formats make it 0-based, and they can also be end-inclusive or end-exclusive
  gene_sequence = this_chromosome_seq[start:end]
# if your coordinates really are given as antisense strand coordinates when strand is -,
#  you just need to subtract them from the chromosome length to get sense-strand coordinates,
#  (switching start and end so they're still in smaller-to-larger order),
#  and then reverse-complement the resulting sequence. 
if strand == '-':
  chrom_length = len(this_chromosome_seq)
  # again, be careful about off-by-one errors here!
  new_start,new_end = chrom_length-end, chrom_length-start
  gene_sequence = reverse_complement(this_chromosome_seq[new_start:new_end]) 
```

**原始答案，实际上并没有按照要求做：**

如果您只想获取开始/结束位置，请执行以下操作：

```
fields = line.split(' ')  # or '\t' instead of ' ' if the file is tab-separated
gene_ID, chr, strand = fields[:2]
start = int(fields[3])
end = int(fields[4])
if strand == '-':
  start,end = end,start 
```

然后，您必须解析您的 fasta 文件以实际获取这些起点坐标的序列，并在`strand=='-'`. 同样，我认为 Biopython 可以为您完成大部分工作。

另一个注意事项 - [Biostar](http://www.biostars.org)是一个很好的 StackExchange 类型的站点，专门用于生物信息学，您可能会在那里得到更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T16:16:20.543

如果用*负数*对字符串进行切片，Python 会从末尾倒数。

```
complement = {'A': 'T', 'C': 'G', 'G': 'C', 'T': 'A'}
s = "AAAAAAAAAACCCCCCCCCCTTTTTTTTTTGGGGGGGGGG"
"".join(complement[c] for c in s[-20:-10]) 
```

* * *

编辑：

你的编辑看起来对我来说是正确的，是的。我非常不擅长检查[栅栏错误](http://en.wikipedia.org/wiki/Off-by-one_error)，但无论如何你比我更能看到这些错误！

我已经将您的代码重写为更加 Pythonic，但没有改变任何实质性内容。

```
bc = {'A': 'T', 'C': 'G', 'G': 'C', 'T': 'A', 'N':'N'}

f = open('chr22.fa')
l = ''.join(line.strip() for line in f)
f.seek(0)

for line in f:
    fields = line.split('\t')
    gene_ID, chr, strand = fields[:2]

    start = int(fields[3])
    end = int(fields[4])

    if strand == '-':
        start, end = -(start + 1), -(end + 1)

    geneseq = ''.join(bc[base.upper()] for base in l[start:end]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T01:15:21.523

我想（尤其是因为您的文件很大）直接从文件缓冲区读取和写入会容易得多。

假设您已经解析了头文件。您解析的行如下所示：

```
line = "NM_001005286 chr1 - 245941755 245942680 245941755 245942680 1" 
```

然后，您确定开始/结束位置是什么（反义坐标）：

```
name, chromosome, direction, start, end = line[:5] 
```

然后，执行以下操作：

```
#Open up the file `chr1.txt`.
f = open("chr1.txt", "r")

#Determine the read length.
read_len = end - start

#Seek to the appropriate position (notice the second argument, 2 -- this means
#seek from the end of the file)
f.seek(-end, 2)

#Read the data
sense_seq = f.read(read_len) 
```

之后，只需将序列转换为反义即可。

简单的 ：）

# java - 如何在 Apache Solr 中创建自己的字段并上传文档？

> ID：10262850
> 
> 赞同：2
> 
> 时间：2012-04-21T20:43:57.487
> 
> 标签：java, xml, search, solr, lucene

我只是第一次玩 Solr。在 Ubuntu Server 上安装并运行它，发布 exampledocs 目录中的示例 xml 文档，并且能够搜索“monitor”、“apple”和“Dell”等关键字，因为这些都在示例文件中。

现在我想添加我自己的带有自定义字段的文档。这是 scheme.xml 中默认的内容：

```
 <fields>
   <!-- Valid attributes for fields:
     name: mandatory - the name for the field
     type: mandatory - the name of a previously defined type from the 
       <types> section
     indexed: true if this field should be indexed (searchable or sortable)
     stored: true if this field should be retrievable
     multiValued: true if this field may contain multiple values per document
     omitNorms: (expert) set to true to omit the norms associated with
       this field (this disables length normalization and index-time
       boosting for the field, and saves some memory).  Only full-text
       fields or fields that need an index-time boost need norms.
       Norms are omitted for primitive (non-analyzed) types by default.
     termVectors: [false] set to true to store the term vector for a
       given field.
       When using MoreLikeThis, fields used for similarity should be
       stored for best performance.
     termPositions: Store position information with the term vector.  
       This will increase storage costs.
     termOffsets: Store offset information with the term vector. This 
       will increase storage costs.
     default: a value that should be used if no value is specified
       when adding a document.
   -->

   <field name="id" type="string" indexed="true" stored="true" required="true" /> 
   <field name="sku" type="text_en_splitting_tight" indexed="true" stored="true" omitNorms="true"/>
   <field name="name" type="text_general" indexed="true" stored="true"/>
   <field name="alphaNameSort" type="alphaOnlySort" indexed="true" stored="false"/>
   <field name="manu" type="text_general" indexed="true" stored="true" omitNorms="true"/>
   <field name="cat" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="features" type="text_general" indexed="true" stored="true" multiValued="true"/>
   <field name="includes" type="text_general" indexed="true" stored="true" termVectors="true" termPositions="true" termOffsets="true" />

   <field name="weight" type="float" indexed="true" stored="true"/>
   <field name="price"  type="float" indexed="true" stored="true"/>
   <field name="popularity" type="int" indexed="true" stored="true" />
   <field name="inStock" type="boolean" indexed="true" stored="true" />

   <!--
   The following store examples are used to demonstrate the various ways one might _CHOOSE_ to
    implement spatial.  It is highly unlikely that you would ever have ALL of these fields defined.
    -->
   <field name="store" type="location" indexed="true" stored="true"/>

   <!-- Common metadata fields, named specifically to match up with
     SolrCell metadata when parsing rich documents such as Word, PDF.
     Some fields are multiValued only because Tika currently may return
     multiple values for them.
   -->
   <field name="title" type="text_general" indexed="true" stored="true" multiValued="true"/>
   <field name="subject" type="text_general" indexed="true" stored="true"/>
   <field name="description" type="text_general" indexed="true" stored="true"/>
   <field name="comments" type="text_general" indexed="true" stored="true"/>
   <field name="author" type="text_general" indexed="true" stored="true"/>
   <field name="keywords" type="text_general" indexed="true" stored="true"/>
   <field name="category" type="text_general" indexed="true" stored="true"/>
   <field name="content_type" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="last_modified" type="date" indexed="true" stored="true"/>
   <field name="links" type="string" indexed="true" stored="true" multiValued="true"/>

   <!-- catchall field, containing all other searchable text fields (implemented
        via copyField further on in this schema  -->
   <field name="text" type="text_general" indexed="true" stored="false" multiValued="true"/>

   <!-- catchall text field that indexes tokens both normally and in reverse for efficient
        leading wildcard queries. -->
   <field name="text_rev" type="text_general_rev" indexed="true" stored="false" multiValued="true"/>

   <!-- non-tokenized version of manufacturer to make it easier to sort or group
        results by manufacturer.  copied from "manu" via copyField -->
   <field name="manu_exact" type="string" indexed="true" stored="false"/>

   <field name="payloads" type="payloads" indexed="true" stored="true"/>

   <!-- Uncommenting the following will create a "timestamp" field using
        a default value of "NOW" to indicate when each document was indexed.
     -->
   <!--
   <field name="timestamp" type="date" indexed="true" stored="true" default="NOW" multiValued="false"/>
     -->

   <!-- Dynamic field definitions.  If a field name is not found, dynamicFields
        will be used if the name matches any of the patterns.
        RESTRICTION: the glob-like pattern in the name attribute must have
        a "*" only at the start or the end.
        EXAMPLE:  name="*_i" will match any field ending in _i (like myid_i, z_i)
        Longer patterns will be matched first.  if equal size patterns
        both match, the first appearing in the schema will be used.  -->
   <dynamicField name="*_i"  type="int"    indexed="true"  stored="true"/>
   <dynamicField name="*_s"  type="string"  indexed="true"  stored="true"/>
   <dynamicField name="*_l"  type="long"   indexed="true"  stored="true"/>
   <dynamicField name="*_t"  type="text_general"    indexed="true"  stored="true"/>
   <dynamicField name="*_txt" type="text_general"    indexed="true"  stored="true" multiValued="true"/>
   <dynamicField name="*_en"  type="text_en"    indexed="true"  stored="true" multiValued="true" />
   <dynamicField name="*_b"  type="boolean" indexed="true"  stored="true"/>
   <dynamicField name="*_f"  type="float"  indexed="true"  stored="true"/>
   <dynamicField name="*_d"  type="double" indexed="true"  stored="true"/>

   <!-- Type used to index the lat and lon components for the "location" FieldType -->
   <dynamicField name="*_coordinate"  type="tdouble" indexed="true"  stored="false"/>

   <dynamicField name="*_dt" type="date"    indexed="true"  stored="true"/>
   <dynamicField name="*_p"  type="location" indexed="true" stored="true"/>

   <!-- some trie-coded dynamic fields for faster range queries -->
   <dynamicField name="*_ti" type="tint"    indexed="true"  stored="true"/>
   <dynamicField name="*_tl" type="tlong"   indexed="true"  stored="true"/>
   <dynamicField name="*_tf" type="tfloat"  indexed="true"  stored="true"/>
   <dynamicField name="*_td" type="tdouble" indexed="true"  stored="true"/>
   <dynamicField name="*_tdt" type="tdate"  indexed="true"  stored="true"/>

   <dynamicField name="*_pi"  type="pint"    indexed="true"  stored="true"/>
   <dynamicField name="*_c"   type="currency" indexed="true"  stored="true"/>

   <dynamicField name="ignored_*" type="ignored" multiValued="true"/>
   <dynamicField name="attr_*" type="text_general" indexed="true" stored="true" multiValued="true"/>

   <dynamicField name="random_*" type="random" />

   <!-- uncomment the following to ignore any fields that don't already match an existing 
        field name or dynamic field, rather than reporting them as an error. 
        alternately, change the type="ignored" to some other type e.g. "text" if you want 
        unknown fields indexed and/or stored by default --> 
   <!--dynamicField name="*" type="ignored" multiValued="true" /-->

 </fields> 
```

默认示例文件如下所示：

```
<add><doc>
  <field name="id">3007WFP</field>
  <field name="name">Dell Widescreen UltraSharp 3007WFP</field>
  <field name="manu">Dell, Inc.</field>
  <field name="cat">electronics</field>
  <field name="cat">monitor</field>
  <field name="features">30" TFT active matrix LCD, 2560 x 1600, .25mm dot pitch, 700:1 contrast</field>
  <field name="includes">USB cable</field>
  <field name="weight">401.6</field>
  <field name="price">2199</field>
  <field name="popularity">6</field>
  <field name="inStock">true</field>
  <!-- Buffalo store -->
  <field name="store">43.17614,-90.57341</field>
</doc></add> 
```

我用自己的自定义字段替换了 schema.xml 文件中的字段：

```
<fields>
  <field name="user_id" type="string" indexed="true" stored="true" />
  <field name="about" type="string" indexed="true" stored="true" />
  <field name="music" type="string" indexed="true" stored="true" />
  <field name="movies" type="string" indexed="true" stored="true" />
  <field name="occupation" type="string" indexed="true" stored="true" />
</fields> 
```

并尝试发布此名为 mydoc.xml 的文档：

```
<add>
    <doc>
        <field name="user_id">foobar</field>
        <field name="about">I am a somebody</field>
        <field name="music">pop, rock</field>
        <field name="movies">titanic</field>
        <field name="occupation">web developer</field>
    </doc>
</add> 
```

当我尝试使用相同的旧命令发布时：

```
java -jar post.jar mydoc.xml 
```

这是我收到的错误：

```
SimplePostTool: version 1.4
SimplePostTool: POSTing files to http://localhost:8983/solr/update..
SimplePostTool: POSTing file mydoc.xml
SimplePostTool: FATAL: Solr returned an error #400 ERROR: [doc=null] unknown field 'user_id' 
```

我还注意到，如果我重新启动 Solr 服务，它将无法加载 Solr Admin，并给出以下消息：

```
HTTP ERROR 500

Problem accessing /solr/admin/. Reason:

    Severe errors in solr configuration.

Check your log files for more detailed information on what may be wrong.

If you want solr to continue after configuration errors, change: 

 <abortOnConfigurationError>false</abortOnConfigurationError>

in solr.xml 
```

其次是一堆其他java类型错误......

如果我从 schema.xml 中删除我自己的自定义字段并重新启动 Solr，它会很好地加载 Solr Admin。

所以我在这里不知所措，如何添加自己的自定义字段并能够将我的文档发布到 Solr？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T00:38:44.920

问题是，我忘了更新这个：

```
<uniqueKey>id</uniqueKey> 
```

成为：

```
<uniqueKey>user_id</uniqueKey> 
```

在 schema.xml 的底部。另一个问题是，当我`*:*`在 Solr 管理员中使用搜索时，一切都很好，但是当我通过字符串（关键字）搜索时，它给出了`undefined field text`错误。为了解决这个问题，我必须将其添加为我的字段之一：

```
<field name="text" type="text_general" indexed="true" stored="false" multiValued="true"/> 
```

# node.js - MongoDB GridFS - 是文件名还是文件名

> ID：10262858
> 
> 赞同：2
> 
> 时间：2012-04-21T20:45:00.340
> 
> 标签：node.js, mongodb, gridfs

请看下图，来自[http://mongoexplorer.com/](http://mongoexplorer.com/)：

![http://mongoexplorer.com/](../Images/70dd10e93868706545acb2b913816dd0.png)

我一直在尝试通过 GridFS 工作，参考[https://github.com/jamescarr/nodejs-mongodb-streaming](https://github.com/jamescarr/nodejs-mongodb-streaming)。我上传的文件很好地返回，通过以下 get 函数返回的流看起来正确。

```
var gridfs = (function () {
    function gridfs() { }
    gridfs.get = function (id, fn) {
        var db, store;
        db = mongoose.connection.db;
        id = new ObjectID(id);
        store = new GridStore(db, id, "r", {
            root: "fs"
        });
        return store.open(function (err, store) {
            if (err) {
                return fn(err);
            }
            return fn(null, store);
        });
    };
    return gridfs;
})(); 
```

使用[http://mongoexplorer.com/](http://mongoexplorer.com/)我将文件上传到 GridFS 进行测试，但是当我使用上面的节点代码检索它们时，它们似乎损坏了。

那是我注意到文件名/文件名的时候。看这里**/node_modules/mongodb/lib/mongodb/gridfs/gridstore.js**我看到文件名的引用带有小写的“N”，但在我的 GridFS 中，它是带有大写“N”的文件名。

好的，只是为了好玩，我在 GridFS 中将其更改为小写，但在检索使用[http://mongoexplorer.com/](http://mongoexplorer.com/)上传的文件时，流中仍然存在一些损坏（上面的节点代码） 。单击[http://mongoexplorer.com/中的](http://mongoexplorer.com/)**另存为...**，但是完美地恢复了我的罚款。

回到我的问题，（因为我的测试似乎没有证明任何东西，）我想知道它是什么：带有小写“N”的文件名，还是带有“N”大写字母的文件名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:18:31.637

另一个 Windows 工具 nl。MongoVue 还会查找*文件名*而不是*文件*名。我会说答案更有可能是文件名而不是文件名。

* * *

从 GridStore 中检索 Windows 小文件时，我发现了一个错误，但我不知道如何修复它。我想一定有一些像 Chunk.CurrentSize 之类的值，但是查看本机节点 mongo 驱动程序中的 chunk.js 文件[https://github.com/mongodb/node-mongodb-native/blob/master/lib /mongodb/gridfs/chunk.js](https://github.com/mongodb/node-mongodb-native/blob/master/lib/mongodb/gridfs/chunk.js)，我做了以下......

我找到了这个：

```
Chunk.prototype.readSlice = function(length) {
  if ((this.length() - this.internalPosition + 1) >= length) {
    var data = null;
    if (this.data.buffer != null) { //Pure BSON
      data = this.data.buffer.slice(this.internalPosition, this.internalPosition + length);
    } else { //Native BSON
      data = new Buffer(length);
      length = this.data.readInto(data, this.internalPosition);
    }
    this.internalPosition = this.internalPosition + length;
    return data;
  } else {
    return null;
  }
}; 
```

并移动了以下

```
data = this.data.buffer.slice(this.internalPosition, this.internalPosition + length); 
```

进入 this if 语句（1024 * 256 是来自 Chunk.DEFAULT_CHUNK_SIZE = 1024 * 256; 的值）

```
 if (this.data.buffer != null) { //Pure BSON
      if (this.data.buffer.length > 1024 * 256) {
        // move to here
      } 
      else 
      {
        data = this.data.buffer;
      } 
```

像这样：

```
Chunk.prototype.readSlice = function(length) {
  if ((this.length() - this.internalPosition + 1) >= length) {
    var data = null;
    if (this.data.buffer != null) { //Pure BSON
      if (this.data.buffer.length > 1024 * 256) {
        data = this.data.buffer.slice(this.internalPosition, this.internalPosition + length);
      } 
      else 
      {
        data = this.data.buffer;
      }
    } else { //Native BSON
      data = new Buffer(length);
      length = this.data.readInto(data, this.internalPosition);
    }
    this.internalPosition = this.internalPosition + length;
    return data;
  } else {
    return null;
  }
}; 
```

解决了 Windows 文件小于块大小的问题，但这不是最优雅的解决方案。我想提出这个作为答案，但我意识到使用硬编码的默认块大小不是动态值，这会减少这种解决方法;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T06:50:39.383

请使用最新的 mongodb 本机驱动程序，因为有大量针对 GridFS 的修复程序，在 github 目录中有大量用于测试的驱动程序示例，用于将 GridFS 用作流。

文档位于

[http://mongodb.github.com/node-mongodb-native](http://mongodb.github.com/node-mongodb-native)

一般来说，我会说，如果您使用核心功能，请坚持使用驱动程序，因为您使用的驱动程序是最新的驱动程序，它可以解释您的腐败问题。

# php - 从文本框中提取值以显示在选项值中

> ID：10262860
> 
> 赞同：0
> 
> 时间：2012-04-21T20:45:08.703
> 
> 标签：php, select, field

您好，我有一个值为 2012-21-04 的盒子。我想做的是使用 3 个选择选项来显示年、月和日。我会使用 php 来提取每个值。我将如何处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:22:04.073

如果您总是使用相同类型的字符串，只需拆分字符串，使用“-”作为分隔符：

```
$arr_date = explode("-",$date); // $date being "2012-21-04" 
```

$arr_date 将是一个由三个元素组成的数组，其中包含三个单独的数值

问候， 斯特凡

# android - 表面视图在 ontouchevnt 中获取像素值类转换错误

> ID：10262862
> 
> 赞同：0
> 
> 时间：2012-04-21T20:45:11.713
> 
> 标签：android, view, surfaceview, touch-event

我想在触摸屏幕时获取像素值。它在一个扩展表面视图的类中

```
@Override
    public boolean onTouchEvent(MotionEvent event) {

        float x = event.getX();
        float y = event.getY();

        if(event.getAction()==MotionEvent.ACTION_MOVE)
        {View v =this;
        ImageView imageView = ((ImageView)v);
        Bitmap bitmap = ((BitmapDrawable)imageView.getDrawable()).getBitmap();
        int pixel = bitmap.getPixel((int)x,(int)y);

        } 
```

我收到类转换异常错误

> ImageView imageView = ((ImageView)v);

我在这里做错了什么。请帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:55:15.563

什么是“this”，它是对 ImageView 的引用吗？

这段代码是哪个类？活动课？

您需要提供更多的代码来帮助我们。

可能“this”是一个 Activity 上下文引用，您不能将其转换为 ImageView。

尝试一下

```
ImageView imageView = (ImageView)findViewById(R.id.XXXX) 
```

其中 XXXX 是您的 ImageView ID

**添加**

```
 for (View objView : this.getTouchables()){
        if (objView instanceof ImageView){
            ImageView imageView = (ImageView)objView;
            //...
        }
    } 
```

如果您的 surfaceView 上只有一个 ImageView，您可以执行此操作。如果您有多个，您可能需要有关它的额外信息，例如它的 id/tag。

# javascript - 未定义的函数

> ID：10262863
> 
> 赞同：1
> 
> 时间：2012-04-21T20:45:14.430
> 
> 标签：javascript

我正在学习 javascript，但无法弄清楚为什么我的脚本无法正常工作。我猜是因为 imageIn 和 imageOut 函数无法访问 counter 变量。我将如何解决这个问题？imageIn 和 imageOut 在我的错误控制台“未定义”中都有错误。

```
<style type="text/css">

ul {
    list-style-type:none;
}

</style>

<body>

<div id="slideShow">

    <ul>
        <li>
            <img src="stockboat.png" alt="Steam Boat" id="boat" />
        </li>   
    </ul>

</div>

<script type="text/javascript" src="getElementsByClassName.js"></script>
<script type="text/javascript">

    var image = document.getElementsByTagName('img');

    for (i = 0, ii = image.length; i < ii; i++)  {
        image[i].style.opacity = "0.5";
        image[i].addEventListener('mouseover', imageIn, 'false');
        image[i].addEventListener('mouseout', imageOut, 'false');   
    }

    function imageIn() {
        image[i].style.opacity = "1";   
    }

    function imageOut() {
        image[i].style.opacity = "0.5";
    }
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:52:23.187

我认为您没有识别出您的迭代变量是对的，您必须这样做：

### 使用参考对象：

```
function imageIn() {
    this.style.opacity = "1";         // use "this" instead of image array
}

function imageOut() {
    this.style.opacity = "0.5";        // use "this" instead of image array
} 
```

-或者-

### 关闭方法：

```
image[i].addEventListener('mouseover'
                         , (function(obj){return function(){imageIn(obj)};})(image[i])
                         , 'false');
image[i].addEventListener('mouseout'
                         , (function(obj){return function(){imageOut(obj)};})(image[i])
                         , 'false'); 
```

需要更改函数定义：

```
function imageIn(obj) {          // added parameters "obj"
    obj.style.opacity = "1";   
} 
```

*此方法允许您引用循环变量，这是在循环中使用 setTimeOut 时很好的示例 - 因此您可以稍后重用代码:)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T20:52:54.533

您可以尝试[jsfiddle](http://jsfiddle.net/)并将 2 个函数imagineIn 和 imageOut 放在使用它们的代码之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T20:59:15.553

您可能存在错误，`<script type="text/javascript" src="getElementsByClassName.js"></script>`导致脚本的其余部分停止执行。

除了这里提到的答案，我还会提供一些其他建议：

1.  定义你的计数器变量：`var i = 0, ii = image.length`. 否则，您最终可能会使用一些已设置的全局 i 和 ii 变量......
2.  使用[Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/docs/overview)之类的检查器来查找 JS 代码中的问题。
3.  [添加和删​​除 CSS 类](https://stackoverflow.com/a/196038/296889)而不是更改元素样式。这将允许您毫不费力地进行多种样式更改。
4.  学习在代码中使用[事件委托](http://www.sitepoint.com/javascript-event-delegation-is-easier-than-you-think/)，从长远来看，它将对您有所帮助，尤其是当您想开始使用动态内容时。

祝你学习顺利。

此外，就让代码工作而言，您可以查看这个 jsFiddle，它使用您的代码并进行了一些修改：http: [//jsfiddle.net/b9Fua/](http://jsfiddle.net/b9Fua/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T21:04:01.340

我发现 jQuery 非常节省时间和直观。你只需要习惯一次性的功能。看看这个！[http://jsfiddle.net/wgxZu/1/](http://jsfiddle.net/wgxZu/1/)

```
<style type="text/css">

ul {
    list-style-type:none;
}

</style>

<body>

<div id="slideShow">

    <ul>
        <li>
            <img src="http://placekitten.com/100/100" alt="Steam Boat" id="boat" />
        </li>   
        <li>
            <img src="http://placekitten.com/200/100" alt="Steam Boat" id="boat" />
        </li>   
        <li>
            <img src="http://placekitten.com/300/60" alt="Steam Boat" id="boat" />
        </li>   
    </ul>

</div>

<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">

    var image = document.getElementsByTagName('img');

    for (i = 0, ii = image.length; i < ii; i++)  {
        image[i].style.opacity = "0.5";
        $(image[i]).hover(function(){$(this).css({"opacity":"1.0"})},
                          function(){$(this).css({"opacity":"0.5"})});
    }
</script>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-21T21:05:41.387

在访问任何元素之前，您需要等待 dom 完成加载。使用以下内容包装您的代码：

```
window.addEventListener('load', function () {
    . . . // Your code
}); 
```

此外，您的`i`变量包含在 和 的闭包`imageIn`中`imageOut`。这意味着每当任何图像接收到 mouseover 或 mouseout 事件时，不透明度将始终为您的列表中的最后一个图像发生变化`images`。

要解决此问题，您可以将范围绑定到函数：

```
image[i].addEventListener('mouseover', imageIn.bind(image[i]), false); 
```

然后在你的`imageIn`函数中你会做：

```
this.style.opacity = "1"; 
```

最后一点：您将字符串`'false'`作为第三个参数传递给 addEventListener。在 JavaScript 中，任何非空字符串都将评估为 true，因此您应该传递布尔值`false`以防止事件冒泡。

# performance - 在图像的缩略图版本中重用 UIImage 会更快吗？

> ID：10262866
> 
> 赞同：1
> 
> 时间：2012-04-21T20:46:00.610
> 
> 标签：performance, ios5, uiimage, uibutton

我有大量大小为 768 x 1024 的图像。我想用它们的缩略图版本作为程序生成的按钮制作一个滚动视图。现在我的问题是：我应该为每个图像制作缩略图并将它们添加为资源并使用这些小（100x100 像素）版本创建我的按钮，还是应该使用相同的大图像但只制作大小为 100x100 的按钮？第二个会尝试先加载整个大图像然后调整大小吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T20:59:39.703

您可能希望看到此堆栈帖子在 UIScrollView 中延迟加载图像：

[UIScrollView 延迟加载图片以减少内存使用并避免崩溃](https://stackoverflow.com/questions/6786614/uiscrollview-lazy-loading-of-images-to-reduce-memory-usage-and-avoid-crash)

另请参阅 UIScrollView 示例应用程序和讨论。他们涵盖了这个问题

# c# - 随机数生成器作为唯一的所有

> ID：10262868
> 
> 赞同：-2
> 
> 时间：2012-04-21T20:46:06.910
> 
> 标签：c#, algorithm, random

我正忙于 C#，我尝试生成 0-256 之间的唯一值。我为此使用数组列表。数组是一个数组列表

```
for (int i = 0; i < 256; i++)
      array.Add(i);

for (int i = 0; i < 256; i++)
            {
                x = rand.Next(0, m);
                dizi_random[i] = (int)array[x];               
                array.Remove(x);               
                m--;
            } 
```

但我没有产生独特的价值。我能做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:55:53.567

相反，它可以使用 Linq 相当简洁地完成；生成一个范围并随机排序；

```
Random rand = new Random((int)DateTime.UtcNow.Ticks);

var randomArray = Enumerable.Range(0, 256).OrderBy(_ => rand.NextDouble()); 
```

# android - 查看动画不改变触摸区域

> ID：10262876
> 
> 赞同：5
> 
> 时间：2012-04-21T20:47:48.437
> 
> 标签：android, animation, touch, bounds

在 TranslateAnimation 之后，未翻译视图上的 OnClickListener。我尝试在自定义 LinearLayout 中覆盖 getHitRect 但没有成功。我还尝试使用 touchdelegate 和在整个互联网上找到的所有其他建议但没有成功:)

```
TranslateAnimation open = new TranslateAnimation(0, displayWidth - ivTimelineWidth, 0, 0);
open.setDuration(1000);   
open.setFillAfter(true);
llMapContent.startAnimation(open); 
```

请帮我 ：）

朱利安

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-21T21:24:26.737

如果我正确理解您的问题，您想在翻译后单击某些内容并且它没有注册某些内容的 onTouch。出现此问题是因为 TranslateAnimation 实际上并不移动对象，而只是移动屏幕上的像素。如果触摸项目所在的区域，您将调用 onTouch。要实际移动对象而不是屏幕上的像素，我建议使用以下代码片段：

```
MarginLayoutParams marginParams = new MarginLayoutParams(someobject.getLayoutParams());
marginParams.setMargins(xx, xx, xx, xx);
RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(marginParams);
someobject.setLayoutParams(layoutParams); 
```

您可能应该将它放在`onAnimationEnd`or`onAnimationStart`方法中。希望这可以帮助。

# android - 从xy坐标查找视图？

> ID：10262877
> 
> 赞同：0
> 
> 时间：2012-04-21T20:47:49.493
> 
> 标签：android, events, view

如何从给定的 xy 坐标获取视图？实际上，我正在为 android 开发蓝牙鼠标驱动程序，其中我从鼠标接收 x ， y 坐标，因此当用户单击时，事件将被调度到该特定视图。我找到了这段代码

```
void simulateEventDown( View v, long x, long y )
{
MotionEvent e = MotionEvent.obtain( SystemClock.uptimeMillis(),
SystemClock.uptimeMillis(),  MotionEvent.ACTION_DOWN, x, y, 0);
v.dispatchTouchEvent(e);
} 
```

调度事件，但我不知道 x,y 的视图。任何帮助谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T22:01:11.617

看起来活动也有一个`dispatchTouchEvent()`功能。

[http://developer.android.com/reference/android/app/Activity.html#dispatchTouchEvent(android.view.MotionEvent](http://developer.android.com/reference/android/app/Activity.html#dispatchTouchEvent(android.view.MotionEvent) )

# c# - 一维 FFT 的输入

> ID：10262879
> 
> 赞同：0
> 
> 时间：2012-04-21T20:47:50.040
> 
> 标签：c#, .net, math, signal-processing, fft

我有一个从传感器获得的浮点数组，并希望在通过 FFT 运行信号后获得幅度（在此之前，样本是使用高通滤波器和 Hann 窗函数处理的）。

使用 AForge.Math 库 FFT 类，它将复数数组作为参数，我想出了以下代码：

```
Complex[] complex = new Complex[1024];
for (int i = 0; i < 1024 - 1; i++)
{
     complex[i] = new Complex(windowedSamples[i], 0);
}

FourierTransform.FFT(complex, FourierTransform.Direction.Forward);
return complex.Select(x =>  Math.Sqrt(Math.Sqrt(x.Re) + Math.Sqrt(x.Im))).ToArray(); 
```

运行这个我得到了一些奇怪的结果，并且无法锁定问题。

前 10 个输入值：

> 0 0 -3.8454E-05 0.0001737584 0.0006910793 0.001071334 0.00204984 0.00276812 0.001741312 0.001796867

前 10 个输出值：

> 0.482303347948843 0.706458195192639 NaN NaN NaN NaN NaN NaN NaN NaN

我的第一个猜测是它可能与虚部有关，但到目前为止，我读过的所有内容都说在这种情况下它应该设置为 0。

我真的很感激一些帮助解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T21:07:31.947

这个表达

```
Math.Sqrt(Math.Sqrt(x.Re) + Math.Sqrt(x.Im)) 
```

对我来说看起来有点奇怪。你想得到这里的绝对值`x`吗？那么你可能应该将虚部和实部提高到 2 的幂，而不是取它们的平方根。

如果绝对值是您想要的，那么只需将该表达式替换为

```
x.Magnitude 
```

# php - 使用符合要求的php显示数据库中的数据

> ID：10262887
> 
> 赞同：1
> 
> 时间：2012-04-21T20:48:52.777
> 
> 标签：php, mysql, html, json

我正在使用我制作的日历设计事件提要。我使用数据库中的相同数据，但要匹配特定的日期和时间。

1.  我只希望一次显示 4 个事件（为什么我指定`length < 4`）
2.  如果数据库值为`'showFeed'`true，则仅显示这些行。
3.  我希望它按日期时间显示，我对数据库中的每个值都有奇数的 id，这可能会使它们乱序。

我当前的代码：

```
$sql = "SELECT `title`, `time`, `start`, `showFeed` FROM calender WHERE length('column') > '0'";

$result = $dbh->query($sql)->fetchAll(PDO::FETCH_ASSOC);

echo "<div class=\"eventfeed\">";
echo "<ul>";

foreach ($result as $row){

$show = $row['showFeed'];

if ($show == 1 && length.$result < 4){
    echo "<li>";
    echo $row['title']. "<br />";
    echo $row['start'].' '.$row['time'];
    echo "</li>";
} 
else {

    return false;
}
}

echo "</ul>";
echo "</div>";

$dbh = null;

echo json_encode($return);

?> 
```

我从数据库中得到结果并且没有错误，但我只看到一个返回`$results`.

老实说，我不知道从这里还能去哪里。我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:55:59.590

我不知道这是否是您的实际代码，但您应该通过 $result.length 而不是相反的方式确定数组的长度。

此外，您可以在查询结束时使用“LIMIT 4”来限制查询中的结果数量。这样 MySQL 只返回 4 个结果，您不必担心代码中的这一点，只需打印所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:59:43.300

对于 1+.2.+3。修改您的查询`SELECT title, time, start, showFeed FROM calender WHERE length('column') > '0' and showFeed=1 and time<current_timestamp ORDER BY time DESC LIMIT 0,3`并删除您的`if (...)`语句。

# c - 等待执行

> ID：10262889
> 
> 赞同：-1
> 
> 时间：2012-04-21T20:49:56.653
> 
> 标签：c, unix, operating-system, fork, signals

我正在制作一个程序，我必须在其中分叉 4 个程序，然后再执行 exec 。我的问题是如何等待执行 exec 的孩子。当孩子执行 exec 时，Wait() 不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:53:56.453

> 我的问题是如何等待执行 exec 的孩子。当孩子执行 exec 时，Wait() 不起作用

假设您正在谈论该`wait(3)`功能，无论孩子是否执行系统调用，它对任何孩子都*非常有效。*`execve(2)`

由于您显然想等待 4 个孩子，因此您可能也对`waitpid(3)`.

# java - 如何在 Android 中创建我的自定义类？

> ID：10262890
> 
> 赞同：1
> 
> 时间：2012-04-21T20:50:06.427
> 
> 标签：java, class, byte, bit

我总是在 Android 中创建不同的类，例如调用不同的活动，但现在我想创建一个类来测试一个字节。我创建了一个简单的方法来做到这一点，所以我可以这样做：

```
if(bitTest(my_byte,7)){
   ...
} 
```

测试 my_byte 的第 7 位，但我想做类似的事情：

```
if(my_byte.bitTest(7)){
   ...
} 
```

我怎样才能做到这一点？因为我无法修改字节类中的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T21:26:32.260

您可以按照 Sword22 的建议进行操作，也可以编写一个封装字节的类，而无需实际扩展 Byte。您也可以在此处保留修改字节的方法。

```
class Bits {
  private byte value;

  public Bits() { this(0x0); }
  public Bits(byte initial) { value = initial; }

  public boolean isSet(int bit) {
    return (value & (1<<bit)) != 0;
  }

  public void set(int bit) { /* ... */ }
  public void unset(int bit) { /* ... */ }

  public byte toByte() { return value; }
} 
```

还要确保您确实需要一个原语`byte`，或者您是否可以使用类似`BitSet`甚至`EnumSet`存储您的标志集的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:07:33.923

由于 Byte 是一个有限的类，你不能这样做。

您可以做的（例如）是使一个新的 Byte 类（即：Byte2）使用继承并在 Byte2 中实现 bitTest。

它会是这样的：

```
Public Class Byte2 extends Byte {
    (...)
    Public boolean bitTest(int i) {

    }
} 
```

并用 Byte2 声明所有“字节”。

编辑：见评论。

# ruby-on-rails - 如何在 Rails 控制器中选择？

> ID：10262892
> 
> 赞同：0
> 
> 时间：2012-04-21T20:50:22.837
> 
> 标签：ruby-on-rails, model-view-controller

现在我有这样的控制器方法：

```
 def modelv
    @model = Model.find(:all, :conditions => { :MOD_MFA_ID => params[:man]}) 
    @ct = CountryDesignation.find(:all, :conditions => { :CDS_ID => "110000002"})
    @destext = DesText.find(:all, :conditions => { :TEX_ID => "388555"})
    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @model }
    end
  end 
```

但我希望它看起来像这样：

```
 def modelv
    @model = Model.find(:all, :conditions => { :MOD_MFA_ID => params[:man]}) 
    @ct = CountryDesignation.find(:all, :conditions => { :CDS_ID => @model.MOD_CDS_ID})
    @destext = DesText.find(:all, :conditions => { :TEX_ID => @ct.CDS_TEX_ID})
    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @model }
    end
  end 
```

但我的模型结构是：

COUNTRY_DESIGNATIONS has_many 型号

DES_TEXTS has_many COUNTRY_DESIGNATIONS

制造商 has_many 型号

因此，如果我选择 @model - 它是数组，如果选择 @ct - 它是数组（对于每个模型），如果选择 @destext - 它是数组。如何正确选择这个。以及如何在视图中显示它？现在我的观点是这样的：

```
%p#notice= notice

%h3
  - @model.each do |model| 
    %tr
      %p
        mod_id
        %td= model.MOD_ID
        name
        -#%td= model.country_designations.des_texts.TEX_TEXT
      = link_to 'Show model', model
= link_to 'Back', manufacturers_path 
```

我不会看起来像这样：

```
%p#notice= notice

%h3
  - @model.each do |model| 
    %tr
      %p
        mod_id
        %td= model.MOD_ID
        name
        %td= @destext.TEX_TEXT
      = link_to 'Show model', model

= link_to 'Back', manufacturers_path 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T23:27:00.210

如果 MODELS belongs_to COUNTRY_DESIGNATIONS 和 COUNTRY_DESIGNATIONS belongs_to DES_TEXTS 那么查找应该只返回一个结果。那你就不需要 find(:all, ...)，你需要

```
@model = Model.find(:first, :conditions => { :MOD_MFA_ID => params[:man]}) 
@ct = CountryDesignation.find(:first, :conditions => { :CDS_ID => "110000002"})
@destext = DesText.find(:first, :conditions => { :TEX_ID => "388555"}) 
```

# social-networking - 如何对活动流中的条目进行分组

> ID：10262893
> 
> 赞同：4
> 
> 时间：2012-04-21T20:50:23.770
> 
> 标签：social-networking

我们目前有一个活动流，用于用户发布照片、喜欢帖子和评论等活动。每个人基本上都有自己的流，我在写的时候会扇出来。我想像 Facebook 一样将类似的活动流条目分组在一起。例如，“吉姆、玛丽和约翰喜欢你的帖子”显示为一个条目而不是 3 个条目，吉姆、玛丽和约翰分别显示一个条目。

这是否意味着我不应该再在写入时使用扇出并且必须更改我的架构？或者，我是否仍应保持活动流原样并在读取时对条目进行分组和处理？我可以做些什么来提高效率吗？关于如何将活动组合在一起的最佳实践有哪些，例如过去一天、过去一小时或自上次登录以来的所有相同类型的条目应该组合在一起？

我应该在客户端做这个吗？对于与某个时间段相关的每个提要项目，我是否应该按整数自动递增递增组？

# css - 适用于 Mac 和 Windows 的漂亮 CSS 字体

> ID：10262894
> 
> 赞同：1
> 
> 时间：2012-04-21T20:50:30.683
> 
> 标签：css, fonts

我看到很多网站都显示了不是图像的好字体。例如：[Firebug 站点](http://getfirebug.com/)和[Happy Cog](http://happycog.com/)。似乎有很多 CSS 的“技巧”、一些 JavaScript 以及各种网页设计师使用的任何其他技巧来完成工作（我不建议上述任何一个网站都这样做）。

我的问题是，在 CSS / 字体实践方面什么是可以接受的？还是应该只使用一组核心的常用字体吗？如果不是，那么显示漂亮字体的可接受/可靠做法是什么，特别是对于 Mac / Windows 一致性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T20:52:16.347

您现在可以嵌入字体。这是一个很好的起点：[http ://www.google.com/webfonts](http://www.google.com/webfonts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T21:41:12.967

如果您有想要使用的字体，您可以使用生成器，它会生成您只需要包含在您的网站中的文件

[http://www.fontsquirrel.com/fontface/generator](http://www.fontsquirrel.com/fontface/generator)

只需在样式表中包含这样的内容：

```
@font-face {
    font-family: 'ArchitectsDaughterRegular';
    src: url('fonts/ArchitectsDaughter-webfont.eot');
    src: url('fonts/ArchitectsDaughter-webfont.eot?#iefix') format('embedded-opentype'),
         url('fonts/ArchitectsDaughter-webfont.woff') format('woff'),
         url('fonts/ArchitectsDaughter-webfont.ttf') format('truetype'),
         url('fonts/ArchitectsDaughter-webfont.svg#ArchitectsDaughterRegular') format('svg');
     font-weight: normal;
     font-style: normal;
} 
```

只需将 url 指向您实际拥有该字体的位置即可。还有很多预制字体可用。

# mysql - 如果只有值为空或 NULL，则更新 MySQL 表中的列

> ID：10262896
> 
> 赞同：6
> 
> 时间：2012-04-21T20:51:10.680
> 
> 标签：mysql, sql, joomla

我以前应用过这个查询......它工作得很好，并得到了这个论坛的一位成员的回答

```
UPDATE
    jos_jbjobs_jobseeker a
    INNER JOIN jos_users b ON a.email = b.email
SET
    a.user_id = b.id 
```

现在我想使用相同的查询添加一个条件......即

仅当 a.user_id 为空时才设置 a.user_id = b.id ,,

我可以应用这个吗：

> 如果 a.user_id = '' 设置 a.user_id = b.id ;

?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-21T20:54:05.330

```
UPDATE
    jos_jbjobs_jobseeker a
    INNER JOIN jos_users b ON a.email = b.email
SET
    a.user_id = b.id
WHERE a.id IS NULL OR LENGTH(a.id)=0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:59:32.533

用这个

```
UPDATE
    jos_jbjobs_jobseeker a
    INNER JOIN jos_users b ON a.email = b.email
SET
    a.user_id = b.id
WHERE a.id =''; 
```

如果 id 也有空值，那么使用这个-

```
UPDATE
    jos_jbjobs_jobseeker a
    INNER JOIN jos_users b ON a.email = b.email
SET
    a.user_id = b.id
WHERE a.id is null or a.id =''; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-18T12:31:06.437

试试这个代码**SQL** native 它对我很有用：

```
UPDATE table 
SET field = 'New value'
WHERE field 
IS NULL
OR field = '' 
```

仅更新**NULL**值或**EMPTY**。

# javascript - 隐藏 Div 但在它向上滑动时显示它？

> ID：10262901
> 
> 赞同：0
> 
> 时间：2012-04-21T20:51:53.737
> 
> 标签：javascript, jquery, hide

我的标签按我想要的方式工作 - 请在此处查看该网站：http: [//beelinetest.site50.net/uw_virtual_tour.html#](http://beelinetest.site50.net/uw_virtual_tour.html#)

有谁知道我如何隐藏屏幕底部的内容（向下滚动），这是单击选项卡时向上滑动的信息。但是确保它从页脚后面滑动时出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T20:58:40.413

在 CSS 中，添加`overflow: hidden`到您的`#maincontentcontainer`元素。

# javascript - 当我单击一个元素时，如何找出运行的 javascript？

> ID：10262902
> 
> 赞同：45
> 
> 时间：2012-04-21T20:51:56.217
> 
> 标签：javascript

我正在查看**Bing 地图**网站。我正在打开**我的位置编辑器**并单击绘图工具栏中的**折线工具**。

我想知道当我单击绘图工具栏中的工具时运行的 javascript 是什么。

我查看了 html 并没有`onclick`在元素上声明事件。

我已经对页面引用的所有脚本进行了文本搜索，以获取折线工具元素的 ID。这是为了尝试找到将单击事件附加到元素的 javascript，但我根本没有匹配项。

当我点击一个工具时，一定有一些脚本在运行。当我单击工具栏中的工具 div 时，如何找出正在执行的脚本？

如果我不首先知道要在哪个脚本上设置断点，我认为无论如何我都无法设置断点。无论如何我可以捕获运行的javascript以发现它是什么，无论是在IE F12开发人员工具还是在萤火虫中？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-21T21:00:19.263

您可以查看 Chrome 中的“事件侦听器”面板，它包含有关附加到元素的每个侦听器的详细信息。

![在此处输入图像描述](../Images/e337c0b9bfe3c4f86341c99b7eb90520.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-21T20:57:48.200

在 Chrome 开发者工具中点击时间线标签，取消选中“加载”和“渲染”，然后点击录制按钮（实心圆圈）。单击按钮触发您的事件，然后再次单击圆圈停止录制。在时间线中找到您的活动，然后单击旁边的箭头将其展开。在左侧，它将告诉您事件调用了哪个函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-21T20:58:00.510

为此，我之前在 Chrome 的调试工具中使用了 Profiler。

在 Chrome 中打开该站点，`F12`以打开调试工具。在工具顶部的选项卡中，单击配置文件。

确保选中收集 JavaScript CPU 配置文件，然后点击开始，然后点击您感兴趣的折线工具，然后点击停止。探查器现在应该列出探查器处于活动状态时进行的所有 Javascript 调用。

Firebug 可能有类似的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-21T20:56:31.973

要为已*动态*添加的特定元素找到*潜在的事件处理程序，请尝试在**类*名和*ids*的所有源中执行搜索。找到事件处理程序后，您可以设置断点并进行验证。

 ***谷歌浏览器有一个很好的全球搜索。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-21T20:56:01.943

打开调试器并启动分析器。点击你想要的。查看分析器并查看调用了什么。***

# java - 如何在数据表上实现服务器端排序

> ID：10262909
> 
> 赞同：1
> 
> 时间：2012-04-21T20:52:30.277
> 
> 标签：java, sorting, server-side

我计划为要在网页上显示的数据表实现服务器端排序和分页。数据表是一个带有外部 CSS 的 Javascript 管理的 HTML 表。Ajax 将从服务器端提取数据。我正在考虑在服务器端创建一个类来表示数据表，但不知道如何在不同列上实现排序。对于备份表的任何类，排序应该足够通用。

**编辑：这样的备份类：**

```
public class Inventory 
{
   private int itemsLeft = 0;
   private float price = 0.0f;
   private boolean status = false;
   private int itemsSold = 0;

   public int getItemsSold()
   {
       return itemsSold;
   }
   public void setItemsSold(int itemsSold)
   {
       this.itemsSold = itemsSold;
   }
   //... and other getters and setters
} 
```

每个私有字段都将是数据表的列之一，整个表将表示为 ArrayList of Inventory。备份类的每个实例由一个数据库表行组成。

当点击任意可排序列的表头时，该列的索引或名称将被发送到服务器，以根据选择的列对数据进行排序。

我现在被困在如何为任何备份类制作通用排序功能。您的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:56:20.720

为要排序的列实现不同的[比较器。](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)然后，您可以使用 Collections.sort 或类似方法在服务器上进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T23:27:47.010

感谢 Amir 和 cuberoot，经过一番努力，我终于想出了这个：

```
import java.util.Comparator;
import java.lang.reflect.Method;

public class ObjectComparator<T> implements Comparator<T>{

   private String field;
   private String order;
   private Method method;
   private Class<T> cls;

   public ObjectComparator(String field, String order, Class<T> c){
       this.field = field;
       this.order = order;
       this.cls = c; 
       init();
   }

   private void init(){
       String field_name = "get"+field.substring(0,1).toUpperCase()+field.substring(1);
       try{
          method = cls.getDeclaredMethod(field_name,new Class[]{});
       }
       catch(Exception ex){
          System.err.println("No Such Method Found!");
       }        
   }
   @SuppressWarnings("unchecked")
   public int compare(T o1, T o2) {
        try{    
          Object o1_ = method.invoke(o1,new Object[]{});
          Object o2_ = method.invoke(o2,new Object[]{});
          //Move all objects with null field values
          //to the end of the list regardless of sorting order.
          if(o1_== null) return 1;
          else if(o2_== null) return -1;
           //////////////////////////////////
          if (order.equalsIgnoreCase("asc"))                
              return ((Comparable<Object>)o1_).compareTo(o2_);    
          else 
              return ((Comparable<Object>)o2_).compareTo(o1_);   
       }
       catch (Exception ex)
       {
           System.err.println("error sorting");
           return 0;
       }        
   }
} 
```

这可以用作：

```
List<Inventory> list = new ArrayList<Inventory>();//populate list    
Collections.sort(list, new ObjectComparator<Inventory>(field_name, order, Inventory.class)); 
```

这里 field_name 是要排序的字段的名称。单击表头时，它作为请求参数发送到服务器。这种方法有一个要求：域对象中的所有可排序字段都必须实现 Comparable 接口。对于感兴趣的领域，还必须有 JavaBean 样式的 getter 和 setter 方法。

# c++ - 如何将整数和双精度数输出到二进制文件

> ID：10262913
> 
> 赞同：0
> 
> 时间：2012-04-21T20:52:58.717
> 
> 标签：c++, integer, double, binaryfiles

我正在处理一项作业，但我被困在其中的一部分上，即整数和双精度的输出到二进制文件。

我知道我需要使用 write() 函数以及输出流的二进制标志，但是 write() 需要一个字符数组来输出。当我输出一个常规字符串时，我可以使用 (char *) 或使用 .c_str() 函数对其进行类型转换，但是我在使用双精度和整数时遇到了问题。

我将如何将整数和双精度数输出为二进制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T20:57:30.180

您可以取消引用您的变量，然后将指针转换为 a `char*`，然后用于`sizeof()`确定要写入的字节数。例如：

```
int var;
char* varAsCharP = (char*)&var;
size_t bytesToWrite = sizeof(int); 
```

此外，如果您需要文件是可移植的，您可能希望首先将变量转换为网络字节顺序，使用各种 hton 函数（保存时）和 ntoh 函数（回读时）——尽管这只适用于整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T20:57:52.440

您可以使用此处描述的 stdlib 方法：http: [//msdn.microsoft.com/en-us/library/0heszx3w%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/0heszx3w%28v=vs.71%29.aspx)

或者你可以使用`boost::lexical_cast`

或者你可以使用`stringstream`

任你选

如果您只想要字节表示，那么您可以像这样执行 memcpy：

```
int myVar = 10;
char * dest = new char[sizeof(myVar)];
memcpy(&dest, &myVar, sizeof(myVar)); 
```

# python - 运行 Python 脚本以从 Amazon S3 检索文件链接

> ID：10262917
> 
> 赞同：0
> 
> 时间：2012-04-21T20:54:04.020
> 
> 标签：python, django, amazon-s3

我将 mp3 文件存储在 Amazon S3 中，并且我有一个 MySQL 数据库，其中包含一个名为 Songs 的表。我想运行一个 Python 脚本，通过转到 Amazon S3 来更新我的数据库，检索 mp3 文件的详细信息（例如使用 ID3），然后在我的数据库中填充 Songs 表。我正在使用 Django。有什么方法可以让我通过简单地点击“更新库”按钮来运行这个脚本，例如通过 Django 管理面板？另外，是否可以按计划运行它？

PS 我是 Django 和 Amazon S3 的新手

**编辑**：我写了一个小脚本，从我的本地机器中的 mp3 文件中获取元标记。这是它的代码：

```
import eyeD3
import sys
import urllib
import os

class Track():
    def __init__(self, audioFile):
        self.title = audioFile.getTag().getTitle()
        self.artist = audioFile.getTag().getArtist()
        self.year = audioFile.getTag().getYear()
    self.genre = audioFile.getTag().getGenre()
    self.length = audioFile.getPlayTimeString()
    self.album = audioFile.getTag().getAlbum()

def main():
    for root, dirs, files in os.walk('.'):
        for f in files:
            if eyeD3.isMp3File(f):
                audioFile = eyeD3.Mp3AudioFile(root+'/'+f)
                t = Track(audioFile)
                print t.artist," ",t.title, " ", t.length, " ", t.album, " ", t.genre    

if __name__ == '__main__':
    main() 
```

即使 ti 在本地，我也想找到一种在 Django 上运行此脚本的方法。我希望我的观点更清楚。

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T04:39:33.697

你需要看看[Boto](http://boto.readthedocs.org/en/latest/index.html)和[django-storages](http://django-storages.readthedocs.org/en/latest/index.html)来了解如何做你想做的事。django-storages 使替换 Django 的 FileStorage 机制变得非常简单，因此您可以将图像/文件直接上传到 S3 的存储桶。

从 S3 读取和更新数据库对象只是相反的工作流程，但 Boto 使连接到存储桶和读取信息变得简单。

希望对您有所帮助。

# python - 了解 Python 传递函数参数的对象调用风格

> ID：10262920
> 
> 赞同：14
> 
> 时间：2012-04-21T20:54:31.617
> 
> 标签：python, function

我不确定我是否理解 Python 通过传递函数参数的对象风格调用的概念（在此处解释[http://effbot.org/zone/call-by-object.htm](http://effbot.org/zone/call-by-object.htm)）。似乎没有足够的例子来很好地阐明这个概念（或者我的 google-fu 可能很弱！：D）

我写了这个小小的 Python 程序来试图理解这个概念

```
def foo( itnumber, ittuple,  itlist, itdict   ):
    itnumber +=1 
    print id(itnumber) , itnumber 

    print id(ittuple)  , ittuple

    itlist.append(3.4)
    print id(itlist)   , itlist

    itdict['mary']  = 2.3
    print id(itdict),    itdict

# Initialize a number, a tuple, a list and a dictionary
tnumber = 1
print id( tnumber ), tnumber 

ttuple  = (1, 2, 3)
print id( ttuple ) , ttuple

tlist   = [1, 2, 3]
print id( tlist ) , tlist

tdict = tel = {'jack': 4098, 'sape': 4139}
print '-------'
# Invoke a function and test it
foo(tnumber, ttuple, tlist , tdict)

print '-------'
#Test behaviour after the function call is over
print id(tnumber) , tnumber 
print id(ttuple)  , ttuple
print id(tlist)   , tlist
print id(tdict),  tdict 
```

程序的输出是

```
146739376 1
3075201660 (1, 2, 3)
3075103916 [1, 2, 3]
3075193004 {'sape': 4139, 'jack': 4098}

---------

146739364 2
3075201660 (1, 2, 3)
3075103916 [1, 2, 3, 3.4]
3075193004 {'sape': 4139, 'jack': 4098, 'mary': 2.3}

---------

146739376 1
3075201660 (1, 2, 3)
3075103916 [1, 2, 3, 3.4]
3075193004 {'sape': 4139, 'jack': 4098, 'mary': 2.3} 
```

如您所见，除了传递的整数之外，对象 id（据我所知是指内存位置）保持不变。

因此，在整数的情况下，它（有效地）通过值传递，而其他数据结构（有效地）通过引用传递。我尝试更改 list 、 number 和 dictionary 来测试数据结构是否已就地更改。数字不在列表中，字典在。

我在上面**有效地**使用了这个词，因为参数传递的“按对象调用”样式似乎具有两种方式，具体取决于上面代码中传递的数据结构

对于更复杂的数据结构（比如 numpy 数组等），是否有任何快速的经验法则来识别哪些参数将通过引用传递，哪些参数将通过值传递？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-21T20:57:42.770

**关键的区别在于，在 C 风格的语言中，变量是内存中的一个盒子，你可以在其中放置东西。在 Python 中，变量是一个名称。**

Python 既不是引用调用也不是值调用。这是更明智的事情！（事实上​​，我在学习更常见的语言之前就学习了 Python，所以按值调用和按引用调用对我来说似乎很陌生。）

在 Python 中，有*东西*，有*名字*。列表、整数、字符串和自定义对象都是东西。`x`, `y`, 和`z`是名称。写作

```
x = [] 
```

意思是“构建一个新事物`[]`并为其命名`x`”。写作

```
x = []
foo = lambda x: x.append(None)
foo(x) 
```

意思是“用 name 构造一个新事物`[]`，用 name`x`构造一个新函数（这是另一个事物）`foo`，并用 name 调用`foo`这个事物`x`”。现在`foo`只是附加`None`到它收到的任何内容，所以这减少到“附加`None`到空列表”。写作

```
x = 0
def foo(x):
    x += 1
foo(x) 
```

`0`意思是“用 name构造一个新事物`x`，构造一个新函数`foo`，然后调用`foo`” `x`。在里面`foo`，赋值只是说“重命名为 1 加上它以前*的*`x`名字”，但这并没有改变0。

 ** * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-21T21:06:26.113

其他人已经发布了很好的答案。我认为还有一件事会有所帮助：

```
 x = expr 
```

评估`expr`并绑定`x`到结果。另一方面：

```
 x.operate() 
```

做某事*并* `x`因此可以更改它（导致相同的基础对象具有不同的值）。

有趣的案例包括：

```
 x += expr 
```

它转化为*（* `x = x + expr`重新绑定）或`x.__iadd__(expr)`（修改），有时以非常特殊的方式：

```
>>> x = 1
>>> x += 2
>>> x
3 
```

（`x`反弹也是如此，因为整数是不可变的）

```
>>> x = ([1], 2)
>>> x
([1], 2)
>>> x[0] += [3]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'tuple' object does not support item assignment
>>> x
([1, 3], 2) 
```

这里`x[0]`本身是可变的，被原地变异了；但随后 Python 也尝试对`x`自身进行变异（如`x.__iadd__`），由于元组是不可变的，因此出错了。但那时`x[0]`已经变异了！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-21T20:58:58.387

Python 中的数字、字符串和元组是不可变的；使用扩充分配将**重新绑定**名称。

您的其他类型只是**mutated**，并且保持相同的对象。*

# c# - 在字符串数组中初始化新字符串

> ID：10262929
> 
> 赞同：2
> 
> 时间：2012-04-21T20:55:22.960
> 
> 标签：c#, .net, initialization

我一直在尝试找出是否有更好的方法来初始化我在此代码片段中使用的字符串数组。我想知道是否有一个函数，或者也许使用`new`它会使代码中所有空字符串的调用和分配变得不必要。所以我可以在创建数组的同时初始化它们。

```
 foreach (var unit in unitList)
                    {
                        //Sort units by each army
                        string unitName = unit.UnitName;
                        armyUnits.Add(unitName, unit);

                        //Sort unit properties by unit
                        List<string> properites = new List<string>();

                        string composition        ="";
                        string weaponSkill        ="";
                        string ballisticSkill     ="";
                        string strength           ="";
                        string initiative         ="";
                        string toughness          ="";
                        string wounds             ="";
                        string attacks            ="";
                        string leadership         ="";
                        string savingThrow        ="";
                        string specialRules       ="";
                        string dedicatedTransport ="";
                        string options            ="";
                        string armour             ="";
                        string weapons            ="";

                        properites.AddRange(new string[15]{

                        composition            = unit.Composition,
                        weaponSkill            = unit.WeaponSkill,
                        ballisticSkill         = unit.BallisticSkill,
                        strength               = unit.Strength,
                        initiative             = unit.Initiative,
                        toughness              = unit.Toughness,
                        wounds                 = unit.Wounds,
                        attacks                = unit.Attacks,
                        leadership             = unit.Leadership,
                        savingThrow            = unit.SaveThrow,
                        specialRules           = unit.SpecialRules,
                        dedicatedTransport     = unit.DedicatedTransport,
                        options                = unit.Options,
                        armour                 = unit.Armour,
                        weapons                = unit.Weapons
                        });

                    } 
```

编辑：所以看起来你可以`new String(unit.Composition.ToCharArray())`在数组内做。我不认为这更具可读性或写起来更快。

```
 properites.AddRange(new string[1]{
  new String(unit.Composition.ToCharArray())} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:58:35.273

```
 foreach (var unit in unitList)
                    {
                        //Sort units by each army
                        string unitName = unit.UnitName;
                        armyUnits.Add(unitName, unit);

                        //Sort unit properties by unit
                        List<string> properites = new List<string>();

                        properites.AddRange(new string[15]{

                        unit.Composition,
                        unit.WeaponSkill,
                        unit.BallisticSkill,
                        unit.Strength,
                        unit.Initiative,
                        unit.Toughness,
                        unit.Wounds,
                        unit.Attacks,
                        unit.Leadership,
                        unit.SaveThrow,
                        unit.SpecialRules,
                        unit.DedicatedTransport,
                        unit.Options,
                        unit.Armour,
                        unit.Weapons
                        });

                    } 
```

你根本不需要变量。实际上，您不需要列表！

```
 var properties = new [] {
                        unit.Composition,
                        unit.WeaponSkill,
                        unit.BallisticSkill,
                        unit.Strength,
                        unit.Initiative,
                        unit.Toughness,
                        unit.Wounds,
                        unit.Attacks,
                        unit.Leadership,
                        unit.SaveThrow,
                        unit.SpecialRules,
                        unit.DedicatedTransport,
                        unit.Options,
                        unit.Armour,
                        unit.Weapons,
                    } 
```

列表支持添加和删除此处似乎未使用的项目。您也不需要 15 的数组计数，因为编译器会计算出来。出于同样的原因，您也不需要数组类型。C# 是一种非常简洁的语言！

我还在“unit.Weapons”之后添加了一个逗号，以使所有列表项对称。这编译得很好，使复制、粘贴和重新排序更简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-22T01:09:49.927

您也不需要使用 AddRange 方法。您可以简单地使用集合初始化语法。

```
//Sort unit properties by unit
var properites = new List<string>
                     {
                         unit.Composition,
                         unit.WeaponSkill,
                         unit.BallisticSkill,
                         unit.Strength,
                         unit.Initiative,
                         unit.Toughness,
                         unit.Wounds,
                         unit.Attacks,
                         unit.Leadership,
                         unit.SaveThrow,
                         unit.SpecialRules,
                         unit.DedicatedTransport,
                         unit.Options,
                         unit.Armour,
                         unit.Weapons
                     }; 
```

# algorithm - 在 O(n) 中运行的数组“最大差异”算法？

> ID：10262937
> 
> 赞同：11
> 
> 时间：2012-04-21T20:56:23.097
> 
> 标签：algorithm, sorting

给定一个包含 N 个整数的数组，对数组进行排序，并在排序后的数组中找出差值最大的 2 个连续数。

示例 – 在输入`[1,7,3,2]`输出上`4`（排序后的数组为`[1,2,3,7]`，最大差值为 7-3=4）。

算法 A`O(NlogN)`及时运行。

我需要找到一个功能与算法 A 相同的算法，该算法在 O(N) 时间内运行。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-21T21:51:19.017

设数组为 X 并设 n = length(X)。将每个元素 x 放入桶号 floor((x - min(X)) * (n - 1) / (max(X) - min(X))) 中。每个桶的宽度是 (max(X) - min(X))/(n - 1) 并且最大相邻差异至少是那么多，所以有问题的数字最终会出现在不同的桶中。现在我们要做的就是考虑一对是桶 i 中的最大值，另一个是桶 j 中的最小值，其中 i < j 并且 (i, j) 中的所有桶 k 都是空的。这是线性时间。

证明我们确实需要地板：设函数为 f(X)。如果我们可以在线性时间内计算 f(X)，那么我们当然可以在线性时间内决定是否

0 < f(X) ≤ (max(X) - min(X))/(长度(X) - 1),

即，X 的元素是否均匀分布且不完全相同。令此谓词为 P(X)。P 的支持具有阶乘(length(X)) 连通分量，因此适用于代数计算模型的通常 Ω(n log n) 下限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-21T21:09:36.130

执行[*计数排序*](http://en.wikipedia.org/wiki/Sorting_algorithm#Counting_sort)，然后扫描最大差异的结果。

由于连续数字要求，乍一看似乎任何解决方案都需要排序，这意味着最多 O( *n* log *n* )，除非您的数字范围受到足够的限制以进行计数排序。但如果是这样，你会以 O( *n* ) 获胜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-11T21:43:12.427

现在，首先试着想想如果你已经给出了 的最小值`MIN`和最大值`MAX`，那么在什么情况`array`下`size N`，最大间隙会是最小值和最大值？

显然，当所有元素都是`MIN`or 或make 时，最大间隙将是最大`MAX`的`maxgap = MAX - MIN`。

`MIN`当所有元素在和之间等间距时，最大间隙将最小`MAX`。可以说它们之间的间距是间隙。

因此，它们排列为

```
MIN, MIN + gap, MIN + 2*gap, MIN + 3*gap, ... MIN + (N-1)*gap 
where

MIN + (N-1)*gap = MAX .

gap = (MAX - MIN) / (N - 1). 
```

所以，我们现在知道我们的答案将在`range [gap, MAX - MIN]`. 现在，如果我们知道答案不仅仅是 gap，我们所做的就是为 range 创建大小 gap 的桶。

```
[MIN, MIN + gap), [Min + gap, `MIN` + 2* gap) ... and so on 
```

只会有`(N-1)`这样的桶。我们根据它们的值将数字放入这些桶中。

如果您从一个桶中选择任何 2 个数字，它们的差异将小于差距，因此它们永远不会有助于`maxgap`（记住`maxgap >= gap`）。我们只需要存储每个桶中的最大数和最小数，我们只看跨桶的数字。

现在，我们只需要按顺序遍历桶（它们已经按值排序），并得到至少一个值的前一个桶的 min_value 与 max_value 的差。我们取所有这些值的最大值。

```
int maximumGap(const vector<int> &num) {
    if (num.empty() || num.size() < 2) return 0;

    int maxNum = *max_element(num.begin(), num.end());
    int minNum = *min_element(num.begin(), num.end());

    //average gap from minNum to maxNum.
    int gap = (maxNum - minNum - 1) / (num.size() - 1) + 1;

    //number of buckets = num.size() - 1
    vector<int> bucketsMin(num.size() - 1, INT_MAX);
    vector<int> bucketsMax(num.size() - 1, INT_MIN);

    //put into buckets
    for (int i = 0; i < num.size(); i++) 
    {
        if (num[i] != maxNum && num[i] != minNum)
        {
            int buckInd = (num[i] - minNum) / gap;
            bucketsMin[buckInd] = min(bucketsMin[buckInd], num[i]);
            bucketsMax[buckInd] = max(bucketsMax[buckInd], num[i]);
        }
    }
    int maxGap = INT_MIN;
    int previous = minNum;

    for (int i = 0; i < num.size() - 1; i++) 
    {
        if (bucketsMin[i] == INT_MAX && bucketsMax[i] == INT_MIN) continue;   //empty
        //i_th gap is minvalue in i+1_th bucket minus maxvalue in i_th bucket
        maxGap = max(maxGap, bucketsMin[i] - previous);
        previous = bucketsMax[i];
    }
    maxGap = max(maxGap, maxNum - previous);
    return maxGap;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-16T06:55:11.753

1.  找到最小值和最大值
2.  `k`从数组中选择一个随机数
3.  通过将所有小于`k`左侧和大于`k`右侧的值放置来对算法进行排序。
4.  您知道两组的最小值和最大值，假设值在一条直线上，计算左组的间隙。对正确的组做同样的事情。
5.  与差距较大的组一起转到 2，您知道该组的最小值和最大值。执行此操作，直到所选组的值不超过 4 个。
6.  你现在有一个只有 4 个元素的组，排序并找到解决方案。

这是该算法如何工作的示例：

*   输入：9 5 3 4 12 9 31 17
*   选择随机数：k = 9
*   按较小和较大的 k 值排序
*   5 3 4 9 9 12 31 17，k 在索引 3 中
*   左组间隙 = (9 + 3) / (4 - 1) = 4
*   右组间隙 = (31 + 9) / (5 - 1) = 10
*   我们选择正确的组 9 9 12 31 17
*   选择随机数：k = 12
*   按较小和较大的 k 值排序
*   9 9 12 31 17，k 在索引 2 中
*   左组差距 = (12 + 9) / (3 - 1) = 11.5
*   右组间隙 = (31 + 12) / (3 - 1) = 21.5
*   12 31 17 中的最大间隙是 31 - 17 = 14

我的算法非常类似于[选择算法](http://en.wikipedia.org/wiki/Selection_algorithm)，用于在线性时间内找到排序算法的 k 索引值。

# python - SQLAlchemy 默认过滤器

> ID：10262938
> 
> 赞同：22
> 
> 时间：2012-04-21T20:56:27.560
> 
> 标签：python, sqlalchemy

我有一个带有字段 is_deleted 的模型，现在除了传递给 .filter 和 .filter_by 的任何过滤参数之外，我希望该模型的所有形式的查询始终按 is_deleted=False 过滤。

在 Django 中，我通常会覆盖管理器并添加我自己的过滤器，但我需要 SQLAlchemy 的帮助。

**更新：**

我最终做了以下事情：

```
class CustomQuery(Query):
    def __new__(cls, *args, **kwargs):
        if args and hasattr(args[0][0], "is_deleted"):
            return Query(*args, **kwargs).filter_by(is_deleted=False)
        else:
            return object.__new__(cls)
session = scoped_session(sessionmaker(query_cls=CustomQuery)) 
```

它可以工作，但如果我以后有更多字段，我想我将不得不添加更多条件，必须有一种方法可以在模型级别上做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2021-03-25T10:02:39.837

这是一个非常古老的问题，所以我确信 OP 解决了他们的问题，但由于它仍未得到解答（在 2021 年），这就是我们如何将自定义查询类应用于所有模型：

1.  如上定义自定义查询

```
class CustomQuery(Query): ... 
```

2.  然后将此查询类设置为基本模型类的查询属性：

```
class BaseModel(Model):
    __abstract__ = True
    query_class = CustomQuery
    ... 
```

那么任何实现 BaseModel 的模型显然都会继承这种行为：

```
class MyModel(BaseModel):
    __tablename__ = 'my_model' 
    .... 
```

注意，在我们的例子中，并不是所有的表都遵循软删除模式（我们不关心每个表的历史）。在这里，您可以实现一个使用默认查询类的单独 BaseModel。

```
class ImmutableBaseModel(Model):
    __abstract__ = True
    query_class = CustomQuery
    ...

class MutableBaseModel(Model):
    __abstract__ = True 
```

如果您发现自己在这里并且还没有阅读它，请查看 Miguel Grinberg 的这篇关于实现[软删除模式](https://blog.miguelgrinberg.com/post/implementing-the-soft-delete-pattern-with-flask-and-sqlalchemy)和[随附 repo的优秀博客文章](https://github.com/miguelgrinberg/sqlalchemy-soft-delete)

# c++ - 返回值后防止控制台窗口自行关闭

> ID：10262942
> 
> 赞同：0
> 
> 时间：2012-04-21T20:57:13.443
> 
> 标签：c++

我是 C++ 新手。我的第一个应用程序看起来像这样。

```
#include "stdafx.h"
#include <iostream>
using namespace std;
int add (int x, int y);

int add (int x, int y){
return (x+y);
}
int _tmain(int argc, _TCHAR* argv[])
{
    int x, y;
    cin >>x>>y;
    cout <<add (x,y);
    cin.get();
    return 0;
} 
```

有2个问题：

1.  为什么即使我使用了函数返回值后控制台窗口也会直接关闭`cin.get();`？
2.  我`int add (int x, int y);`在文件顶部没有一行测试了这个应用程序。它运作良好。如果没有它，我是否也需要为每个功能或应用程序编写原型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-21T20:59:38.493

问题 1：`cin >>x>>y`在输入缓冲区中留下一个换行符，而是被读取`cin.get`，导致它继续。

尝试

```
cin.sync(); //remove unread characters
cin.get(); //read one character (press enter) 
```

问题2：原型在那里所以你可以让编译器知道函数存在，然后使用函数（比如在main中），然后再定义函数的主体（比如在main之后）。

```
int add (int, int); //compile error if left out

int main()
{
    add (3, 4);
}

int add (int a, int b)
{
    return a + b;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:00:01.897

当您使用`cin >> x >> y`时，该语句仅读取两个数字输入值，而*不是*您输入该行所需的 Enter 键。该 Enter 按键停留在输入缓冲区中，供`cin.get()`以后使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T21:08:50.350

您可以使用此行来保持控制台打开：

```
cin.ignore(numeric_limits<streamsize>::max()); 
```

或者，如果您使用的是 Visual Studio，您可以使用 ctrl+F5 运行您的程序，并且控制台应该保持打开状态而无需这些技巧。或者您可以从您自己启动的 cmd.exe 窗口运行您的程序。

* * *

仅当您想在当前翻译单元中定义函数之前（或代替）调用函数时才需要函数原型。这就是为什么标头包含您在另一个实现文件中定义的函数的函数原型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T09:26:19.597

```
#include <iostream>
using namespace std ;

int main(void)
{

  cout<<" \nPress any key to continue\n";

  cin.get();

   return 0;
} 
```

# django - 每次用户访问我的 Django 应用程序时，我如何运行一个函数？

> ID：10262946
> 
> 赞同：0
> 
> 时间：2012-04-21T20:57:44.193
> 
> 标签：django, django-views

我有一个功能可以检查是否应向在我的 Django 应用程序中延迟付款的用户收取滞纳金。由于我无法编写 cron 作业，因此每次用户访问我的应用程序时我都必须运行此函数。

我可以在我的应用程序的每个视图的开头调用这个函数，但这会重复很多函数名。

每次用户访问我的 Django 应用程序时，我如何运行一个函数？我是否应该在 settings.py 中调用该函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:10:12.283

编写自己的中间件并将其添加到设置中的中间件列表中。中间件本身只是一个具有一些函数的类，这些函数充当请求处理链中某些点的钩子：

```
class MyMiddleware (request):

    process_request(self,request):
       # do something here before passing the request to the view

    process_response(self,request,response):
       # do something here before passing the response to the client 
```

还有一些其他钩子可用于指定您的功能启动的确切点，您最好查看[文档](https://docs.djangoproject.com/en/1.4/topics/http/middleware/#writing-your-own-middleware)以了解最适合您的情况。

在设置中，只需将中间件添加到中间件类中：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'your_app.middleware.MyMiddleware', 
```

)

那应该完全符合您的要求。

# c++ - 忽略调试器中的默认库

> ID：10262950
> 
> 赞同：0
> 
> 时间：2012-04-21T20:58:14.087
> 
> 标签：c++, visual-studio, debugging

我希望能够告诉调试器不要深入研究 C++ 中的默认库。（我同时使用 VS 2003 和 VS 2010，具体取决于项目。）我几乎从来没有从中得到任何有用的信息，而且必须逐步执行默认代码真的很乏味。

例如，当它作为函数参数传递时，我几乎不必观看将字符串文字更改为 std::string 的代码，也不必观看该字符串随后与另一个字符串进行比较、破坏或任何。每次调试器开始将我带入其中一个兔子洞时都必须退出，这很烦人。

C# 似乎没有这个问题——我只在调试器中看到我自己的代码，并且不会陷入我永远不会更改的晦涩的默认库代码中，而且无论如何都非常接近不可读。我只是希望我也可以在 C++ 中使用它。如果确实有错误是一回事（尽管这通常不是很有用 - 最好让错误指向我的代码中导致错误发生的行）。但是当代码没有问题时单步执行几乎是没有用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:58:15.887

在 Visual Studio 中：
解决方案属性 -> 调试源文件 -> “不要查看这些源文件”

每当调试器将您带到您不想看到的无用位置时，您可以将其添加到那里，它将被忽略。

# php - 从字符串的开头和结尾删除双引号

> ID：10262951
> 
> 赞同：5
> 
> 时间：2012-04-21T20:58:22.317
> 
> 标签：php

我试图找出的是哪个php函数允许我从文本字符串的开头和结尾删除双引号（如果它们存在）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-21T21:00:47.293

使用[修剪](http://php.net/manual/en/function.trim.php)功能：

```
$str = '"Hello"';
echo trim($str, '"'); // Outputs Hello 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-21T21:00:54.850

[修剪](http://php.net/manual/en/function.trim.php)是你的朋友：

```
trim($string,'"'); 
```

# django - 擦干我的观点

> ID：10262956
> 
> 赞同：1
> 
> 时间：2012-04-21T20:59:01.040
> 
> 标签：django, django-models

我的views.py中有这种丑陋的模式，其中几乎我的观点中的每个方法都包括

`Products.objects.active().filter(user=request.user) # Return all products for the current user`

或者

```
user = get_object_or_404(User, user=request.user)
products = user.product_set.all() 
```

这是因为每种方法都依赖于用户。有没有办法将它提取到我的模型或干燥的东西中，所以我不需要在每种方法中重复自己？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:18:37.753

Why don't you write a service function? Or decorate your functions with a user object if available?

```
services.py

def get_products(request, *args, **kwargs):
    user = request.user
    return somethings **depending** on the arguments passed... 
```

and

```
views.py

def someview(request):
    context['user_products'] = services.get_products(request, commonCase)
    render ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:57:17.007

使用[基于类的通用视图](https://docs.djangoproject.com/en/1.4/topics/class-based-views/)并将通用代码放在基类的方法中。像这样的东西：

```
from django.contrib.auth.decorators import login_required
from django.utils.decorators import method_decorator
from django.views import generic

class UserView(generic.View):
    """
    A generic view which requires an authenticated user and shows only
    active products belonging to that user.
    """

    def get_products(self):
        """
        Return queryset of products belonging to the authenticated user.
        """
        return self.request.user.product_set.all()

    @method_decorator(login_required)
    def dispatch(self, *args, **kwargs):
        return super(UserView, self).dispatch(*args, **kwargs) 
```

# python - 开始使用 mkvtoolnix？

> ID：10262958
> 
> 赞同：0
> 
> 时间：2012-04-21T20:59:16.780
> 
> 标签：python, python-3.x, popen, mkv

现在大多数 Matroska 视频文件 (.mkv) 都启用了标头压缩。这破坏了与硬件播放器的兼容性，因此我很久以前创建了一批“修复”该问题，方法是使用 mkvtoolnix 重新组装文件而不使用标头压缩。但奇怪的是，即使来源是正确的，该批次也不适用于某些 .mkv。只是打嗝没有规律...

正因为如此，我今天开始编写一个小的 Python 3.2 脚本，唯一的目的是遍历 CWD 中的 .mkv 文件并将它们用作参数，以使用参数调用 mkvtoolnix-.exe。我尝试在准备好的命令上同时使用 os.popen() 和 os.system() ，虽然 system() 似乎误解了命令，在不应该的地方删除双引号，即使转义，popen 似乎至少可以工作少量。

这就是我的问题。现在执行脚本，它为文件夹中的每个 .mkv 文件创建一个 .mkv_fix 文件，这很好，但它的大小只是原始文件的一小部分，并且无法播放。对我来说，popen 似乎调用 .exe 就好了，但之后几乎立即终止它，只留下一个未完成的文件。

我从[这里](http://www.bunkus.org/videotools/mkvtoolnix/downloads.html)将 mkvtoolnix windows 可执行文件作为 7zip 存档，并将它们放在脚本 CWD 的子目录中。

我还应该注意，当从批处理调用时，可执行文件会产生控制台输出，而 .py-script 则不是这种情况。

代码的重要部分：

```
for file in glob.iglob('*.mkv'):
    if file.count('_fix') == 0:
        print(file)
        convertCMD = '"{0}\mkvtoolnix\mkvmerge.exe" -o "{1}_fix" --engage keep_bitstream_ar_info -A -S --compression -1:none "{1}" -D -S --compression -1:none "{1}" -A -D "{1}"'.format(os.getcwd(),file)
        os.popen(convertCMD)
        print('Converted '+file) 
```

任何形式的帮助表示赞赏。

附加信息：

通常的 mkvtoolnix 输出：

```
mkvmerge v5.5.0 ('Healer') built on Apr  6 2012 21:43:24
'F:\$PRECONVERT\MKVFILENAME': Using the demultiplexer for the format 'Matroska'.
'F:\$PRECONVERT\MKVFILENAME': Using the demultiplexer for the format 'Matroska'.
'F:\$PRECONVERT\MKVFILENAME': Using the demultiplexer for the format 'Matroska'.
'F:\$PRECONVERT\MKVFILENAME' track 0: Using the output module for the format 'MPEG-4'.
'F:\$PRECONVERT\MKVFILENAME' track 1: Using the output module for the format 'Vorbis'.
'F:\$PRECONVERT\MKVFILENAME' track 2: Using the output module for the format 'Vorbis'.
'F:\$PRECONVERT\MKVFILENAME' track 3: Using the output module for the format 'text subtitles'.
'F:\$PRECONVERT\MKVFILENAME' track 4: Using the output module for the format 'text subtitles'.
The file 'F:\$PRECONVERT\MKVFILENAME.mkv_fix' has been opened for writing.
Progress: 0%
Progress: 16%
Progress: 39%
Progress: 56%
Progress: 78%
Progress: 96%
Progress: 100%
The cue entries (the index) are being written...
Muxing took 3 seconds. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T05:08:05.320

os.popen is deprecated, and I haven't used it, at least not the last few years, so I don't remember the details. But documentation indicates that you need to call os.wait() to wait for the subprocess to finish.

For subprocess.Popen you need to call wait() on that object to see if it has finished. If you do so before starting the next one, outputs will not be mixed. On the other hand, if you start all at once, you can use any number of processor cores, which would be nice. To not have mixed outputs you then need to create one output for each subprocess, by calling Popen() with a stdout argument pointing to a file you opened for the purpose. You'll get one logfile per conversion that way, which makes sense.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T15:14:02.753

我编写了一个脚本，我每天都使用它来将一些 .srt 字幕混合到 mkv 文件中。
这是相关代码：

```
import subprocess

mkvmerge_args = [
    mkvmerge_path,
    '-o',
    dest_file_path,
    original_file,
    #other arguments...
    ]

returncode = subprocess.call(mkvmerge_args) 
```

（在我的 Ubuntu Server 机器上完美运行，它也应该在 Windows 上运行）

# python - 在 Python for 循环中更改列表中项目的值

> ID：10262961
> 
> 赞同：0
> 
> 时间：2012-04-21T20:59:37.550
> 
> 标签：python

我创建了一个函数，并向函数传递了一个字符串列表，如下所示： `['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'XX']`

我创建了一个具有 26 个值的变量 X；我在下面的代码中将这些值称为“卡片”（“用于 X 中的卡片”）。

我正在使用 itertools 和列表推导来创建一个字符串列表，以便 X 中的每个值都替换为新列表中的“XX”。

例如：`['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'XX']`将扩展为`['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value1'], ['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value2'] etc`

我正在创建一个名为 tmp 的值列表，并使用 for 循环将“X”值列表（称为卡）替换 tmp 中的一个项目（称为“XX”）。

```
 unitoffive = list(itertools.combinations(unit,5))
 newunit = [list(line) for line in unitoffive if 'XX' in line]

 tmp = [[line,card] for line in newunit for card in X]
 for line in tmp:
     line[0][4] = line.pop(line.index(line[1]))
     print line

  for line in tmp:
     print line 
```

我的脚本表现出我无法理解的行为。当我的第一个 for 循环中的打印行语句被执行时，我看到了我期望的修改列表。当调用第二个打印行语句时，我看到了另一个不正确的列表版本。我无法返回和使用 tmp，因为它似乎只在修改它的 for 循环中包含正确的值。

我知道在 for 循环中修改 Python 列表可能很棘手，我尝试将代码更改为循环，`for line in tmp[:]`但这并没有解决我的问题。

这部分代码中的打印行语句`['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value1'], ['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value2'] etc`按预期打印：

```
for line in tmp:
  line[0][4] = line.pop(line.index(line[1]))
  print line 
```

其后的打印行语句打印`['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value26'], ['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'value26'] etc`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:15:21.483

You're changing the [line, card] sublists and expecting the tmp list to have a copy of them, not the same objects. Try changing:

```
for line in tmp: 
```

For:

```
import copy
for line in copy.deepcopy(tmp): 
```

And see if it works as you expect.

**edit**

It seems like this is what you want, to append to the inlist instead of inserting:

```
>>> line = [['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'XX'], ['value1']]
>>> line[0].append(line.pop()[0])
>>> line
[['CC', 'DC', 'EC', 'FC', 'GC', 'HC', 'XX', 'value1']]
>>> 
```

# c# - C# 或 Fortran 95 循环中的标记中断/继续？

> ID：10262964
> 
> 赞同：2
> 
> 时间：2012-04-21T20:59:42.743
> 
> 标签：c#, fortran, break, continue

我的作业任务是将 C# 中的循环转换为 Fortran 95。

```
outerLoop:
  for(row = 0; row < numRows; rows++){
    for(col = 0; col < numCols; col++){
      if(mat[row][col] == 0)
        continue outerLoop;
      sum += mat[row][col];
    }
  } 
```

正如你们中的一些人所看到的，这看起来类似于 Java 和 Perl 中使用的 exit 语句标签规范，据我了解，它用于中断具有嵌套循环或“ *if* ”语句的循环，而不仅仅是单个循环/陈述。我对 Java 中的这个特性还是新手，所以我不确定它是否存在于其他任何地方，特别是在 C# 和 Fortran 95 中。

我在谷歌上环顾四周，但我没有找到任何适合它的东西。我在制定要在 Google 上使用的搜索词时遇到了麻烦，因此这也是其中的一个因素。

请注意：我不是在寻找讲义答案；我只是在寻找自己在哪里找到答案。

感谢您抽出时间阅读这篇文章。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T21:04:55.713

Fortran 95 中循环控制结构的示例，请参阅我在上一个 Fortran 问题中的示例代码，其中包含“循环”和“退出”的示例用法：[Reading comment lines correct in an input file using Fortran 90](https://stackoverflow.com/questions/10259712/reading-comment-lines-correctly-in-an-input-file-using-fortran-90) , .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:06:24.913

我相信`break x`C# 不支持这样的功能。您需要使用标志手动跳出嵌套循环。

```
bool stop = false;
for (row = 0; row < numRows; rows++)
{
    for (col = 0; col < numCols; col++)
    {
        if (mat[row][col] == 0)
        {
            stop = true;
            break;
        }

        sum += mat[row][col];
    }

    if (stop)
        break;
} 
```

更简单的替代方案包括`goto`声明（被广泛反对）；并将你的循环封装在一个专用的方法中，在这种情况下，你可以`return`在你想停止迭代的时候。

# java - 如何在java中快速重置加载的类？

> ID：10262970
> 
> 赞同：2
> 
> 时间：2012-04-21T21:00:19.820
> 
> 标签：java, performance, classloader

我正在使用自定义类加载器来加载一些 java 类。我需要在循环中从这些加载的类中执行一些方法。对于每个循环迭代，我需要对所有类（所有静态字段）进行全新的初始化。我测量到，如果我为每次迭代使用新的类加载器，执行时间比在每次迭代中不使用新的类加载器时的执行时间慢三倍。

我可以在不使用新的类加载器加载它们的情况下将加载的类重置为其初始状态吗？

或者有没有办法加快在不同类加载器中重复加载相同类的速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:05:59.203

当你用新的类加载器加载类时，JMV 几乎肯定会[重新 jit 字节码](http://en.wikipedia.org/wiki/Just-in-time_compilation)。在此之前，新加载的类的第一次使用会比较慢。

我假设这些类是您无法修改的库代码？因为您必须以这种方式使用这些类的事实表明我的设计存在缺陷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T15:05:03.033

就在我的脑海中：你能用反射拍摄类的初始状态然后恢复它吗？

# xml - JSP XML Filewriter 给出 NullpointerException

> ID：10262971
> 
> 赞同：0
> 
> 时间：2012-04-21T21:00:26.903
> 
> 标签：xml, jsp, nullpointerexception, filewriter

以下代码给了我这个错误：

> java.lang.NullPointerException java.io.FileOutputStream.(Unknown Source) java.io.FileOutputStream.(Unknown Source) java.io.FileWriter.(Unknown Source)

```
SAXBuilder parser = new SAXBuilder();
this.document = parser.build(path);

//changes on the doc happening here

FileWriter writer = new FileWriter(path);
XMLOutputter out = new XMLOutputter();
out.output(this.document, writer);
writer.flush();
writer.close(); 
```

怎么来的？文件被锁定还是什么？

旁注：使用 BufferedOutputStream 类有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:03:47.850

问题是文件的路径错误，如建议的那样。

# java - $在表达式语言中做了什么

> ID：10262972
> 
> 赞同：0
> 
> 时间：2012-04-21T21:00:38.640
> 
> 标签：java, jsp, el

$在Jsp的表达语言中做了什么？我想知道这个符号的意义及其工作。请有人在这方面帮助我。

仅供参考，我知道它用于直接打印某些值，而不是通过表达式，即 <%= %>。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T21:05:16.917

您可以使用表达式语言中的分隔符 $ 或 # 访问（的 getter 方法）bean。

该语言基于java并且区分大小写。

# gcc - gcc 交叉编译链接器错误：无法读取符号：文件格式无法识别 collect2

> ID：10262974
> 
> 赞同：3
> 
> 时间：2012-04-21T21:00:41.753
> 
> 标签：gcc

我正在尝试使用 gcc-eabi 交叉编译一个包应用程序。我已修改配置文件以指向所有目标目录。但是链接器在链接一些共享库时仍然会报错。确切的错误如下：

```
Linking CXX shared library /home/aeodrs/JAUS++-2.110519-src/libraries/jaus++/2.0/lib   /libcxutils.so

/home/aeodrs/JAUS++-2.110519-src/libraries/jaus++/2.0/lib/libcxjpeg-6b.a: could not read symbols: File format not recognized collect2: ld returned 1 exit status

make[2]: *** [/home/aeodrs/JAUS++-2.110519-src/libraries/jaus++/2.0/lib/libcxutils.so] Error 1
make[1]: *** [libcxutils/CxUtils/libcxutils/CMakeFiles/cxutils.dir/all] Error 2
make: *** [all] Error 2
aeodrs@ubuntu:~/JAUS++-2.110519-src/libraries/jaus++/2.0/build/cmake$ 
```

我不确定为什么链接器无法读取或损坏库文件。

# google-chrome-extension - 谷歌浏览器扩展 - 弹出 js 文件中的 document.body 为空

> ID：10262976
> 
> 赞同：5
> 
> 时间：2012-04-21T21:00:54.610
> 
> 标签：google-chrome-extension

我从谷歌文档开始使用 hello world 应用程序来编写 chrome 扩展。[http://code.google.com/chrome/extensions/getstarted.html](http://code.google.com/chrome/extensions/getstarted.html)

我只是将 popup.js 修改为：

```
var span = document.createElement("span");
span.innerHTML = "<b>blah</b>";
alert(document.head);
alert(document.body);
document.body.appendChild(span); 
```

我希望这会在我的弹出窗口中显示“blah”，但我将 document.body 设为 null。我是 js 和 chrome 的新手，我试图弄清楚这里发生了什么。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-06-29T23:43:40.563

弹出脚本运行时，DOM 还不存在。您需要`DOMContentLoaded`在弹出脚本中监听一个事件。

像这样的东西会起作用：

```
 document.addEventListener('DOMContentLoaded', function(event) {
    console.log(document.body);
  }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T21:06:50.747

当输入结束脚本标签时，直接评估相应的代码。

由于`background.js`被加载在头部，`<body>`不存在（还）。因此，`document.body`是`null`。

# c - 使 gcc 警告隐式转换

> ID：10262983
> 
> 赞同：8
> 
> 时间：2012-04-21T21:01:35.157
> 
> 标签：c, gcc, warnings

> **可能重复：**
> [我可以让 GCC 在将过宽的类型传递给函数时发出警告吗？](https://stackoverflow.com/questions/310108/can-i-make-gcc-warn-on-passing-too-wide-types-to-functions)

很多时候，我通过将 long 传递给整数函数来导致错误。

当我这样做时，我可以让 gcc 警告我吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-21T21:05:17.953

试试`-Wconversion`。

```
int fn(int);
int bar(long x) { return fn(x); }

gcc -c t.c  -Wconversion
t.c: In function ‘bar’:
t.c:3: warning: conversion to ‘int’ from ‘long int’ may alter its value 
```

# python - AppEngine Python 获取所有引用

> ID：10262986
> 
> 赞同：0
> 
> 时间：2012-04-21T21:01:55.357
> 
> 标签：python, google-app-engine, google-cloud-datastore

我的问题很简单。我有`Model_A`并且`Model_B`：

```
class Lobby(db.Model):
    name = db.StringProperty()  

class UserModel(db.Model):
    name = db.StringProperty()
    lobby = db.ReferenceProperty(Lobby, collection_name="lobby") 
```

现在我`Lobby`从存储中获取一个/所有实体，并且我想访问每个大厅的相关用户。我不能通过调用来做到这一点`lobby_entity.aUsers`。

这是如何实现的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T05:33:46.973

使用 GQL：

```
lobbies = Lobby.all().fetch(10)
keys = [lobby.key() for lobby in lobbies]
q = aUser.gql('WHERE lobby IN :1', keys)
users = q.fetch(1000) 
```

请注意，如果您有很多大厅，这将无法正常工作。IN 查询最多支持 30 个值。（https://developers.google.com/appengine/docs/python/datastore/gqlreference）

PS。请不要以小写字母开头模型类名称。查看 PEP 8。

# mysql - 如何建立可变关系？

> ID：10262987
> 
> 赞同：1
> 
> 时间：2012-04-21T21:02:13.647
> 
> 标签：mysql, cakephp

每个评论可以是问题、游戏或用户的子项。我设计了这个表，使它有两个字段来管理关系，parent_type 和 parent_id。我不明白如何使这种关系与 CakePHP 2.1 一起工作。我知道这是一个 belongsTo 关系，但我将如何根据该表中的另一个字段指定它所属的表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T21:40:09.697

[http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T22:19:31.603

评论模型

```
var $belongsTo = array(
                'Question' => array('className' => 'Question', 'foreignKey' => 'id'), 
                'Game' => array('className' => 'Game', 'foreignKey' => 'id'), 
                'User' => array('className' => 'User', 'foreignKey' => 'id')); 
```

问题模型

```
var $hasMany = array(
    'Comment' => array(
        'className' => 'Comment', 
        'foreignKey' => 'parent_id', 
        'conditions' => array('Comment.parent_type' => 'question')
    )
); 
```

# java - 编译错误：j 已在 main(java.lang.String[]) 中定义

> ID：10262988
> 
> 赞同：3
> 
> 时间：2012-04-21T21:02:16.637
> 
> 标签：java

我正在尝试编译以下代码：

```
class Looping {
    public static void main(String ar[]) {
        long j;
        for (int i = 0, j = 3; i <= 10; i++, j++) {
            System.out.println(j);
        }
    }
} 
```

我收到以下编译错误：

> j 已经在 main(java.lang.String[]) 中定义

错误发生在`for`循环所在的行。这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T21:04:30.933

您实际上是以这种方式声明了两个 j 变量。您的解决方案是不在循环中重新声明 j ，而是在循环之前将其声明为 long ，或者在 for 循环初始条件中将其声明为 int （正如您所做的那样）。例如，您可以尝试：

```
 long j = 3;
  for (int i = 0; i <= 10; i++, j++) {
     System.out.println(j);
  } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-21T21:08:24.343

当你写：

```
long j;
for(int i=0, j=3;i<=10;i++,j++)
{
    System.out.println(j);
} 
```

这基本上相当于：

```
long j;
int i = 0, j = 3;
while (i <= 10)
{
    System.out.println(j);
    i++, j++;
} 
```

本质上，您正在尝试创建一个新`j`的类型变量，`int`该变量是循环本地的。已经定义了一个名为`j`类型的变量`long`，因此出现错误。您可以省略`long j;`声明，或将其更改为`long j = 3;`以在循环开始之前对其进行初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T17:54:10.780

```
int i = 0, j = 3; is the same thing as
int i = 0;
int j = 3; 
```

因此，您实际上是在尝试创建另一个 j 变量。我建议用分号替换逗号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-21T21:07:58.413

任何一个：

```
class Looping {
    public static void main(String ar[]) {
      for(int i=0, j=3;i<=10;i++,j++) {
        System.out.println(j);
      }
    }
} 
```

或者：

```
class Looping {
    public static void main(String ar[]) {
       long j=3;
       for(int i=0;i<=10;i++,j++) {
        System.out.println(j);
      }
    }
} 
```

说明：代码示例中的逗号 (,)`int i=0`不算作语句分隔符，但有效地告诉编译器：`Define an integer i with value 0 AND a integer J with value 3`

# django - 如果所有字段为空，Django 表单会引发一般验证错误

> ID：10262990
> 
> 赞同：0
> 
> 时间：2012-04-21T21:02:34.407
> 
> 标签：django, forms

我有一个表单，其中不需要单独的任何字段，但是如果所有字段都留空，我想引发验证错误。做这个的最好方式是什么？我尝试了以下方法，但没有奏效：

```
def clean(self):
    cleaned_data = super(SearchForm, self).clean()
    if len(cleaned_data) == 0:
        raise forms.ValidationError(ugettext_lazy("You must fill at least one field!")) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T21:05:31.797

`cleaned_data`您应该检查每个条目并确认所有值都是空的，而不是检查的长度（它应该始终包含每个表单字段的一个条目）。

这是一个如何做到这一点的例子。

```
def clean(self):
    cleaned_data = super(SearchForm, self).clean()
    form_empty = True
    for field_value in cleaned_data.itervalues():
        # Check for None or '', so IntegerFields with 0 or similar things don't seem empty.
        if field_value is not None and field_value != '':
            form_empty = False
            break
    if form_empty:
        raise forms.ValidationError(ugettext_lazy("You must fill at least one field!"))
    return cleaned_data   # Important that clean should return cleaned_data! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-07T19:16:38.350

忽略仅填充空格的字段：`and not field_value.isspace()`

# ruby-on-rails-3 - 针对页面修改黑客的 Rails 集成测试？

> ID：10262993
> 
> 赞同：4
> 
> 时间：2012-04-21T21:03:00.053
> 
> 标签：ruby-on-rails-3, capybara, rspec-rails

我正在使用 Capybara 1.1.2、Rails 3.1.3、rspec-rails 2.9.0 和 Ruby 1.9.3p0。

假设一个具有标准用户和 account_admin 用户的应用程序。标准用户可以创建另一个标准用户，但标准用户不能创建 account_admin 用户。

当然，UI 不会为标准用户提供创建帐户管理员的选项。但是使用 Firebug 30 秒后，用户可以重写 HTML，因此它提交一个 POST 请求来创建一个 account_admin。

如何测试我的应用程序是否可以防止这种简单的黑客攻击？

正常的标准用户测试如下所示：

```
context "when standard user is signed in" do

  before do
    login_as standard_user
    visit users_path       # go to index
    click_link('Add user') # click link like user would
  end

  describe "when fields are filled in" do

    let(:new_email) { "new_user@example.com" }

    before do
      fill_in "Email", with: new_email
      fill_in "Password", with: "password"
      fill_in "Password confirmation", with: "password"
      choose "Standard user" # radio button for Role
    end

    it "should create a user" do
      expect { click_button submit }.to change(User, :count).by(1)
    end

  end

end 
```

有没有办法“欺骗”测试以获取表单上不允许的值？我尝试将单选按钮视为文本字段，但 Capybara 拒绝将其视为不存在的字段：

```
fill_in "Role", with: "account_admin" # doesn't work 
```

直接修改 params 哈希也不起作用：

```
params[:role] = "account_admin" # doesn't work 
```

我是否必须将其编写得更像控制器测试，并直接调用`post :create`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:45:18.630

Capybara 作者 jnicklas[在这里](https://groups.google.com/d/msg/ruby-capybara/aMnVRN9ooZc/9f4lUASeoaYJ)确认 Capybara无法让应用程序执行 UI 中不可用的操作。他建议对控制器进行授权测试。

然而，在*不使用 Capybara 语法的情况下用 RSpec 编写的请求规范确实允许直接使用*[RSpec](https://www.relishapp.com/rspec/rspec-rails/v/2-9/docs/request-specs/request-spec)和[Rails](http://guides.rubyonrails.org/testing.html#integration-testing)文档中概述的 HTML 动词（和一些额外的帮助程序） 。因此，您可以使用属性散列、动词（如、、）和对象，而不是 Capybara 的`fill_in`和`click_link`指令和对象。它类似于控制器测试，但您使用 Rails 的路由根据提供的路径选择适当的控制器操作。以下是后一种技术的示例：`page``get``post``post_via_redirect``response.body`

```
describe "when standard user attempts to create account_admin user" do

  let(:standard_user) { FactoryGirl.create(:standard_user) }

  let(:attr) { { email: "account_admin@example.com",
                 password: "password",
                 password_confirmation: "password",
                 role: "account_admin" }
              }

  before do
    login_as standard_user
    get new_user_path
  end

  it "should not create a account_admin user" do
    lambda do
      post users_path, user: attr
    end.should_not change(User, :count)
  end

  describe "after user posts invalid create" do
    before { post_via_redirect users_path, user: attr }

    # redirect to user's profile page
    it { response.body.should have_selector('title', text: 'User Profile') }
    it { response.body.should have_selector('div.alert.alert-error', text: 'not authorized') }
  end

end 
```

# android - 如何以编程方式连接到已在 Android 手机中设置的 VPN

> ID：10262997
> 
> 赞同：9
> 
> 时间：2012-04-21T21:03:40.150
> 
> 标签：android, vpn

我已经在我的 Android 手机中配置了 VPN 连接。现在我想通过一个小部件连接这个 VPN。如何以编程方式启动连接？大多数代码假设还没有 VPN 设置，但这不是我要找的地方。我特别寻找连接到已配置 VPN 的代码。

在[http://code.google.com/p/android/issues/detail?id=8915](http://code.google.com/p/android/issues/detail?id=8915)我找到了这段代码：

```
VpnService service = context.getSystemService(VPN_SERVICE);
VpnProfile profile = VpnProfile.create(L2TP_PROFILE);
profile.setName(myServerName);
profile.setServerName(myServerAddress);
profile.setRouteList(“192.168.1.0/255.255.255.0,192.168.10.0/255.255.255.0”);

service.connect(profile, myUserName, myPassword);
service.setNotificationIntent(myIntent); 
```

其中配置了一个新的 VPN。我只想连接现有的 VPN。

此页面[http://developer.android.com/reference/android/net/VpnService.html](http://developer.android.com/reference/android/net/VpnService.html)描述了如何实现自己的 VPN 服务，这也不是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T06:46:03.697

这里使用 VpnService 的例子[https://android.googlesource.com/platform/development/+/master/samples/ToyVpn/src/com/example/android/toyvpn](https://android.googlesource.com/platform/development/+/master/samples/ToyVpn/src/com/example/android/toyvpn)

# java - 反射清除 Android 应用缓存的方法

> ID：10262998
> 
> 赞同：0
> 
> 时间：2012-04-21T21:03:43.220
> 
> 标签：java, android, caching, reflection, delete-file

我正在尝试清除除我自己之外的其他 android 应用程序的应用程序缓存。为此，我在 PackageManager 类上使用反射。但是，每当我在调用它之前初始化该方法时，它总是最终为空。

```
 private  void initiateClearUserData() {
    // Invoke uninstall or clear user data based on sysPackage
    String thePackageName;
    PackageManager pm = speedy.this.getPackageManager();
    List<ApplicationInfo> installedApps = pm.getInstalledApplications(0);
    ApplicationInfo ai;// = installedApps.get(0);
    ActivityManager.RunningAppProcessInfo process;
    for(int x=0; x<4; x++){
        ai = installedApps.get(x); 
```

这是我的问题所在：

```
 thePackageName = ai.packageName.toString();// mAppEntry.info.packageName;
        Method deleteApplicationCacheFiles = null;
        mClearCacheObserver = new ClearCacheObserver();
    try {
        deleteApplicationCacheFiles = pm.getClass().getMethod(
             "deleteApplicationCacheFiles", String.class, PackageManager.class);
    } catch (SecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (NoSuchMethodException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
 if(deleteApplicationCacheFiles!= null){
     try {
        deleteApplicationCacheFiles.invoke(thePackageName, mClearCacheObserver);
    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InvocationTargetException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    }else{
    Toast.makeText(speedy.this, "Hell naw",
            Toast.LENGTH_SHORT).show();
    }
    }
} 
```

因为方法 deleteApplicationCacheFiles 为空，所以我的 toast 消息出现了。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T21:57:51.520

查看 Android 上的安全文档：http: [//developer.android.com/guide/topics/security/security.html](http://developer.android.com/guide/topics/security/security.html)

> Android 安全架构的核心设计点是，默认情况下，任何应用程序都无权执行任何会对其他应用程序、操作系统或用户产生不利影响的操作。这包括读取或写入用户的私人数据（如联系人或电子邮件）、读取或写入另一个应用程序的文件、执行网络访问、保持设备唤醒等。

听起来系统会阻止你这样做（也通过反射）。