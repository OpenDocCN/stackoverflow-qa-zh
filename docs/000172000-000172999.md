# StackOverflow 问答 000172000-000172999

# svn - 更新整个项目的根目录时，如何排除 svn externals 的更新？

> ID：172018
> 
> 赞同：11
> 
> 时间：2008-10-05T13:55:26.050
> 
> 标签：svn, svn-externals

进行递归更新时，有没有办法排除所有 svn 外部项？

进行递归更新时，有没有办法仅排除所有 svn 外部项中的 1 个？

基本上我想减少 svn 更新时间，而我拥有的一些 SVN 外部组件几乎永远不会更新。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-05T14:12:29.103

是的，有一个选项（忽略所有）：

```
> svn update --ignore-externals 
```

我不知道有任何选项可以在更新其余部分时专门忽略一个或一些外部因素。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-17T22:45:48.823

如果您使用的是 TortoiseSVN，您可以执行与“svn update --ignore-externals”相同的操作。使用“**更新到修订版...** ”菜单项而不是普通的“**更新**”。在该对话框中，您有一个“**省略外部**”复选框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T05:21:13.160

我建议将默认上下文菜单项更改为在主上下文菜单上具有更新到修订版。

在 TortoiseSVN 设置中，转到“外观和感觉”，然后取消选中您想要的主文件夹上下文菜单中的项目并在子菜单中选中您想要的项目。

我有以下***未选中***的。

*   查看
*   犯罪
*   显示日志
*   检查修改
*   更新到修订

拥有所有这些项目的好处是它们只在相关时显示，即当目录是工作副本时。因此，对于非 SVN 文件夹，您只会得到 Checkout。

# python - 您如何在本地针对 OpenID 进行开发

> ID：172040
> 
> 赞同：41
> 
> 时间：2008-10-05T14:08:42.483
> 
> 标签：python, django, openid

我正在开发一个使用 OpenID 对用户进行身份验证的网站（在 Django 中）。由于我目前仅在本地计算机上运行，​​因此无法使用网络上的 OpenID 提供程序之一进行身份验证。所以我想我需要运行一个本地 OpenID 服务器，它只允许我输入用户名，然后将其传递回我的主应用程序。

这样的 OpenID 开发服务器是否存在？这是最好的方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-06T17:22:39.190

The libraries at [OpenID Enabled](http://openidenabled.com/) ship with examples that are sufficient to run a local test provider. Look in the examples/djopenid/ directory of the python-openid source distribution. Running that will give you an instance of [this test provider](http://openidenabled.com/python-openid/trunk/examples/server/).

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-05T15:29:43.083

[我用myopenid.com](http://myopenid.com)测试没有问题。我以为在我的本地机器上测试会有问题，但它确实有效。（我将 ASP.NET 与 DotNetOpenId 库一起使用）。

“领域”和返回 url 必须包含端口号，例如“ [http://localhost:93359](http://localhost:93359) ”。

我认为它可以正常工作，因为提供商会进行客户端重定向。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-05T14:20:57.840

我也在研究这个。我也在开发一个可能使用 Open Id 的 Django 项目。如需参考，请查看：

*   [PHPMyId](http://siege.org/projects/phpMyID/)
*   [OpenId 的页面](http://openid.net/get/)

希望这里有人解决了这个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-05T14:22:37.477

我现在正在使用[phpMyID](http://siege.org/projects/phpMyID/)在 StackOverflow 进行身份验证。生成标准的 HTTP 身份验证领域并完美运行。它应该正是您所需要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-05T15:24:31.330

您可能可以使用 django OpenID 库来编写一个提供程序来进行测试。有一个总是验证和一个总是失败。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-05T14:48:18.173

为什么不在本地机器上运行 OpenID 提供程序？

如果您是 .Net 开发人员，[Google Code](http://code.google.com/p/dotnetopenid/)上有一个用于 .Net 的 OpenID 提供程序库。这使用标准的 .Net 配置文件提供程序机制并用 OpenID 层包装它。我们正在使用它将 OpenID 添加到我们的自定义身份验证引擎中。

[如果您使用另一种语言/平台工作，这里](http://wiki.openid.net/Libraries)的 OpenID 社区站点提供了许多 OpenID 实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-05T16:40:16.933

您不应该在针对自己的机器进行开发时遇到问题。你遇到了什么错误？

OpenID 提供者会要求您授予您的网站（在本例中为[http://localhost:8000](http://localhost:8000)或类似的）访问您的身份的权限。如果您单击确定，那么它将重定向您该网址。我从来没有遇到过[livejournal](http://www.livejournal.com)的问题，我希望[myopenid.com](http://myopenid.com)也能正常工作。

如果您在本地开发时遇到问题，我建议您遇到的问题与 url 是 localhost 无关，而是与其他问题无关。如果没有错误消息或问题描述，就不可能多说。

**编辑**：事实证明，雅虎与我遇到的其他 OpenID 提供商的做法不同，并且不允许重定向到 IP 地址、域名中没有正确 tld 的站点以及在 80 或 443 以外的端口上运行的站点。请参见[此处](http://openid.net/pipermail/general/2008-January/004024.html)来自 Yahoo 开发人员的关于此主题的帖子。[这篇文章](http://openid.net/pipermail/general/2008-January/004023.html)提供了一种解决方法，但我建议 myopenid.com 的开发比在 Yahoo 周围工作或运行您自己的提供商要简单得多。

# windows-mobile - GPSID - 轮询驱动程序 V2.0

> ID：172050
> 
> 赞同：2
> 
> 时间：2008-10-05T14:17:53.260
> 
> 标签：windows-mobile

在页面 [http://msdn.microsoft.com/en-us/library/bb202066.aspx](http://msdn.microsoft.com/en-us/library/bb202066.aspx)

如果引用名为“POLL Driver V2”的东西，但是这是我能看到的唯一谈论这个的地方。我对这个 `GPSSetDeviceParam: GPS_QUERY_FIX`电话非常感兴趣，但在搜索了大约 2 个小时后，我找不到任何信息。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T16:56:01.757

根据 MS 的说法，GPSID - Poll Driver v2.0 不适用于 WM6.1 中的 ISV。他们正在评估将其包含在操作系统的未来版本中。

我的解决方案是创建一个按预定时间间隔触发的 Windows CE 通知。然后，当我的应用收到通知时，我将电源模式设置为“无人值守”。但是，要使这项工作正常进行，您需要在“无人值守”电源模式下将 GPDO 的注册表中的电源要求设置为 D0。

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Power\State\Unattended

gpd0: = 0

使用 SetPowerRequirement 或 SetDevicePower = D0 不会完成同样的事情。

# .net - 为什么当我将文件复制到目录时 FileSystemWatcher 会创建多个更改事件

> ID：172060
> 
> 赞同：4
> 
> 时间：2008-10-05T14:24:11.593
> 
> 标签：.net, filesystems, filesystemwatcher

我使用 .Net FileSystemWatcher 编写了一个小型测试应用程序来监视目录。当我将一个大（几 Mb​​）文件复制到该目录中时，我会列出以下事件（请参见屏幕截图 - 并忽略 Delete 事件开始）。

[替代文字 http://robinwilson.homelinux.com/FSW.png](http://robinwilson.homelinux.com/FSW.png)

我得到了一个创建的事件（如预期的那样），但随后发生了两个更改的事件（相隔约 0.7 秒）。为什么是这样？这将导致我计划开发的应用程序出现重大问题 - 因为我会尝试对文件执行两次操作（大概在完成写入之前一次！）。我能做些什么来阻止这种情况的发生吗？从我在 StackOverflow 和其他地方读到的内容来看，一旦文件被更改然后关闭，您应该只得到一个更改的事件。为什么我要两个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-05T14:37:56.213

根据[文档](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)（请参阅*Events and Buffer Sizes*下的第一个要点）：

> **常见的文件系统操作可能会引发多个事件。**例如，当一个文件从一个目录移动到另一个目录时，可能会引发几个 OnChanged 以及一些 OnCreated 和 OnDeleted 事件。**移动文件是一个复杂的操作，由多个简单的操作组成，因此会引发多个事件。**同样，某些应用程序（例如，防病毒软件）可能会导致 FileSystemWatcher 检测到的其他文件系统事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T14:29:32.300

通常，复制程序是以块的形式进行的，而不是一次整个文件。我不认为你可以做任何事情来避免这种情况，你将不得不采用你的算法来处理这个问题。

您可以尝试以独占读取权限打开文件，只有在其他程序完成复制并关闭文件时才应授予您的程序。否则你会得到 IOException 并且你可以等待下一次更改。但这并不意味着您不应该处理多重变化事件。在记事本中打开文本文件并偶尔保存会产生更改事件，但文件不会一直被锁定。

另一种方法是在一段时间内收集触摸的文件，当 FileSystemWatcher 停止生成事件时，一次处理所有文件。

# svn - 从 ClearCase 迁移到 SVN/Mercurial

> ID：172065
> 
> 赞同：15
> 
> 时间：2008-10-05T14:29:48.883
> 
> 标签：svn, mercurial, clearcase

在工作中，我们现在正在使用 ClearCase。但是，需要很多开销，尤其是当有人做了一些愚蠢的事情时（比如删除一个视图，在后备箱上有多个保留的结账......）。由于我们试图降低开销并尽可能轻量级，因此我们已经考虑了放弃 CC 并采用更轻量级（Subversion 或 Mercurial）的可能性，看看我们如何不使用 90% 的 CC 功能反正。这听起来合理吗，还是我们会将我们的法拉利换成旅行车？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-05T14:32:38.423

根据我的经验，ClearCase 确实有很多开销，我们使用 SVN 管理得很好。

我投票“降级”（实际上是升级）。;)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-06T17:04:14.983

我学到的主要事情是，比产品更重要的是*过程*。

如果您已经使用 SVN 类型的模型实现了 ClearCase (CC)，那么 SVN 将工作得很好并且便宜*很多。*

另一方面，如果您使用延迟分支、按标签构建和动态视图（或可以），我们使用它们在节省时间和精力以及提高可靠性方面有很大的优势，您将非常后悔失去这些功能。（更不用说构建管理、UCM 等）

我发现大多数人使用第一选择，这就像在高峰时段使用法拉利......

例子？定义标签 GA、SP1、SP2（你可以在 GA 和 SP1 之间有任意多个版本，不相关，记住，CC 标签与 SVN 不同）。GA 是您的基本版本，SP1 是您当前的版本。SP2 是您的下一个版本。当前版本基于 GA 和 SP1。下一个版本基于 GA、SP1 和 SP2（请参阅 CC 配置规范）

开始质量检查。开发正在为“下一个版本”做持续的工作，用户可以参考（而不是更改）GA和SP1，并且可以应用SP2。维护工作是修复 QA 发现的缺陷，可以参考 GA，并应用 SP1。

案例 1：在 ClearCase 中，仅应用 SP1 标签的行为就可以自动将修复程序提供给 Dev SP2 发布团队。没有工作。纳达，零。

在 Subversion 中，您将在 QA 分支上进行更改，然后（希望记住）将更改迁移到 SP2。

案例 2：在您询问之前，当然，如果您添加 SP2 更改，您将不得不分支为 SP1 添加后续更改，就像在大多数系统中一样。

在我的世界中，真实世界的数字：案例 1 在我的上一个 SP 中发生了 122 次（每年 8 个 SP）。如果我使用 Subversion 模型，我不必在 ClearCase 中进行每年超过 800 次更改。

自 2002 年初我们安装 CC 以来，案例 2 已经发生了 6 次。

看*过程*，而不仅仅是*产品*。

（对不起，它没有开始那么长:-)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-05T14:42:39.323

我同意以前的海报。放弃 IBM 产品并转向开源控制产品根本不会是降级。您可能会对这些更轻、更易于使用的工具更满意。在我们的商店中，我们正在从 CVS 迁移到 SVN，并且对结果非常满意。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-05T14:38:18.070

我肯定会考虑从 clearcase 到 subversion 的升级！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-06T17:15:39.547

我们从 ClearCase LT 转到 SVN 并喜欢它。我们节省了大量的维护费用，一切都和以前一样好。

我只是希望我在推荐 SVN 之前调查过 Git 或类似的东西。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-05T17:01:44.007

我对你的“开关”没有任何问题。如果您没有许多使用 UCM 的相互依赖的项目，这将是一个升级。

我同时管理 SCM（ClearCase 和 Subversion），并为中小型*独立*项目推荐 Subversion。

但是，请确保您的开发人员不习惯 ClearCase 的动态视图：它是文件系统的封装，允许用户从网络*访问*文件。据我所知，ClearCase 是唯一拥有这种访问权限的公司。

并考虑范式转换：

*   ClearCase 以文件为中心（您获得的每个文件都是只读的，并且您只签出您正在处理的文件）
*   Subversion 以存储库为中心（您获得的每个文件都是读写的，您在一次原子提交中签入所有修改/添加/删除的文件）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-05T15:29:39.590

第四次推荐你切换。如果您不使用这些功能，那么使用商业定价的解决方案是一个糟糕的商业选择。

现在，“免费”解决方案也有相关成本。SVN 和 Mercurial 都不会为您提供商业级支持。如果这是一个问题，并且在某些情况下肯定会出现，您可能不想这样做。

在您提到的两个中，如果您当前使用的是集中式 VC 存储库，则应该选择 SVN。SVN 的操作模型不仅简单直观，而且 SVN 拥有我在开源项目中见过的最好的文档和开发者社区。用户邮件列表很棒，开发人员对他们的用户反应灵敏且负责，而[红豆书](http://svnbook.red-bean.com/)是最好的开源手册。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-28T19:19:12.763

我喜欢 ClearCase 的一些我在其他 SCM 工具中做不到或根本做不到的事情：

1.  使用开发人员分支很轻松。在 CC (UCM) 中，您在流（又名分支）中工作，并将大量工作“交付”到集成流。同时，其他开发人员也这样做。集成商（可能是开发人员之一）然后对集成流进行一些测试，并确保一切都构建并可能进行冒烟测试，然后推荐一个新的基线，其中包括所有开发人员的工作。同时，您继续在您的分支机构工作。下次您想要交付时（或之前，如果您愿意），您会看到一个新的基线可用，因此您合并到您的流中。事实上，如果有更新的基线可用，您将被迫重新设置基准。我尝试在 Microsoft Team Foundation Server 和 SVN 中执行此操作。首先，我找不到执行诸如 CC 强制变基之类的策略的方法，所以我必须去弄清楚自上次合并以来我做了哪些修订，以及从那时起在主干中做了什么，然后从主干合并到我的分支中。然后当我想将我的新工作合并到主干时，我不得不重新合并我刚刚合并到我的分支中的所有内容，以及我的新工作。
2.  开发人员分支有利于有效的代码审查。当我使用 CC 时，我们审查了所有内容。但实际上，评论需要时间，我们需要继续努力。每件作品都对应于 CC 中的一项活动。只有在审核完成后，我们才将活动交付给集成流。如果审查需要更改，我可以决定在我所做的原始工作的活动中进行更改（只要没有对该活动中更改的文件进行后续更改），创建一个新活动来解决审查更改，或者可能会吹走整个活动并重新开始（再次，只要没有进行后续更改）。在 TFS 和 SVN 中，一旦你提交了一些东西，你就不能轻易地回去而不吹走后续的工作。所以我们必须找到其他方式向其他开发人员展示我们的更改。这最终将差异转换为网页，但是，如果不将其与待审核的工作混合，我们将无法继续进行更多工作。
3.  使用动态视图可以更轻松地进行跨平台开发。我这里只有SVN可以比较，所以也许Mercurial或其他更好。我的目标是在 Linux 和 PowerPC 平台（以及另一个项目的 Windows）上进行更改、构建、测试和调试，并在我满意它适用于所有平台时提交单个变更集。对于 PowerPC 构建，我们有一个用于构建和测试目标的 sun 工作站（访问动态视图）。它很慢，所以我们在 Linux 上进行了大部分编码和调试，然后在 PowerPC 上构建和测试，然后在 (PowerPC) 目标上进行最终测试，最后是签入。解决此问题的一种方法是网络文件共享。我在这里看到的一个问题是 Linux svn 和 Windows 上的 TortoiseSVN 之间的版本不兼容。如果您让 Tortoise 进入 Linux 存储库副本，它会更改 .svn 文件，然后 Linux svn 抱怨版本太新。（由于我们为目标选择的平台，我们无法将我们的 Linux 机器升级到足够新的 svn。）所以我不能在 Linux svn 存储库中使用我的 Windows diff 工具。如果我采用另一种方式，使用 Windows 签出和 Linux 安装 Windows 存储库，则不会保留符号链接（Linux 构建需要这些链接）。

我不反对，维护 ClearCase 是一场噩梦，而且*会*花钱。但是一旦设置好，它就可以提供一个非常好的开发环境。特别是当您开始与 ClearQuest 集成时（缺陷跟踪，我们也用于跟踪代码审查）。

正如另一位响应者所说，您的答案在很大程度上取决于您的流程需求。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-01-26T21:54:21.297

在我以前的公司（CMMi 流程）中，大约 100 名开发人员/测试人员/集成人员与 ClearCase (CC) 一起工作，其中有 3 名全职管理员（添加 2 名自愿兼职）。除非您使用配置管理部分（基线），否则您应该继续使用现代 SCM。基线功能很强大：在传统的 SCM 中，当您更新/变基时，默认情况下您会获得最新的修订。基线是特定“兼容”版本的一组软件组件，以确保构建正常。在某种程度上，它就像依赖构建（即 Maven、Ant Ivy）。当开发人员在基线上变基（更新）时，他们得到了应该是“可构建”的东西。

现在从我的新公司（敏捷商店）回顾过去，我们使用 SVN 和 Mercurial，我认为 CC 是每天的痛苦。使用 CC 处理项目（存储库），您可以创建视图、创建活动，然后签出文件。有些同事害怕做分支:)。使用 SVN 和 Mercurial，我们的 GUI 客户端就没有这样的问题了。开发人员每天提交 10 次。与 CC 相比，人们每天会签到一次。

事实上，CC 有很多开销和缓慢的网络延迟、高昂的许可成本和需要全职管理员。那么除了配置管理还有什么好处呢。

在 Mercurial 上，工作流程更轻松。对于我们当前的项目，提交非源文件搞砸了。汞的历史是不可改变的。我们没有管理员。一位开发人员在半天内重新克隆了一个新项目。在 Clearcase 中，您需要请专家来备份已删除的文件 :)。要创建一个新的 repo，你问你的管理员 :)

离开 ClearCase 之后，现在我对 SVN 尤其是 Mercurial 非常满意。因此，从 ClearCase 迁移到 Mercurial 在流程方面将非常轻量级，而且您会获得更高的生产力。

现在在 SVN 和 Mercurial 之间进行选择？您应该问自己是集中式存储库还是分散式存储库。您可以在 stackoverflow 上进行快速搜索。

我开始不喜欢 IBM Rational 产品，而是喜欢优雅的开源解决方案。

如果您阅读并理解了它，您应该将其**命名为“从 clearcase 升级到 svn-mercurial”**。

**补充：** Clearcase 落后于可推荐性阈值，而 Mercurial、Subversion 和 Git 被明确推荐。 [http://martinfowler.com/bliki/VersionControlTools.html](http://martinfowler.com/bliki/VersionControlTools.html)
您也可以结合 Mercurial 和 Clearcase。阅读“多个 VCS”段落

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-24T13:57:46.073

在过去的几周里，我一直在寻找新工作的 SCM（软件配置管理）和 ALM（应用程序生命周期管理）工具，以取代 CVS 并支持敏捷的采用。

如果您正在寻找能够通过并行开发和分支支持真正的 SCM 的东西，那么可能有比您意识到的更多的选择。

对于简单的 SCM 解决方案，请查看以下内容：

*   **Accurev：**这是一个 SCM 工具，原生支持基于流/并行的开发。它提供了一个非常好的流浏览器，为您提供流的图形视图，并允许您以图形方式将更改作为问题或更改集进行升级（强制对一组源文件进行原子升级）。它有一个内置的问题跟踪器，可为您提供变更管理并让您以基于任务的方式工作。使用 AccuFlow，您可以通过工作流程更好地控制您的更改，而 Accubridge 为您提供 IDE 集成。
*   **Seapine Surround：**这是一款外观漂亮的工具，非常适合分支，但不如 Accurev 先进。Seapine 的优点在于与他们的问题跟踪工具 TestTrack Pro 以及他们的测试用例管理解决方案 TestTrack TCM（结合到 TestTrack Stuido）的集成。最后，他们还有 QA Wizard Pro，这是一个 web 和 winforms 自动化测试工具。
*   **PureCM：**这是另一种非常流行的替代方案，但我没有仔细研究过
*   **Perforce：**这个领域的另一种选择，我对它印象不深，但它确实有一些有趣的小众功能，比如比较和合并图像的能力。
*   **Plastic SCM：**一种不成熟的产品，但看起来非常有趣。

所有这些解决方案都提供了比 ClearCase 更好的分支支持，例如开发人员沙箱（而不是在 ClearCase 中使用那些疯狂的视图）和版本快照等概念。本质上是一个只读分支，有点像基线。

如果您有一个广泛的 Rational 部署，您可能想要研究这些替代方案：

*   **MKS Integrity：**一个很好的组合产品，具有出色的投资组合管理工具和一个很好的内置测试运行视图。它的所有工具都集成在一个 IDE 中，并且非常可定制。
*   **Serena CM：**同样是一个足够好的套件，包含围绕核心 ALM 解决方案的大量工具。非常大的投资组合管理部分，他们的 Mashups 组件有很多业务流程支持，还支持原型设计。
*   **Telelogic：**具有讽刺意味的是，现在是 IBM 的一部分，并且很快就会成为 IBM 的理性人。它的 SCM 解决方案（Telelogic Change and Synergy）很容易成为我见过的最好的解决方案，它能够通过任务明确地将代码更改提升到发布构建分支中。

所有上述解决方案都支持与 Accurev 等相同的 SCM 概念，但显然更多的是端到端产品并且是企业规模的。

在这一点上，我们将选择范围缩小到 MKS 或 Telelogic。

我最大的观点是在 ClearCase 和 CVS/Subversion 之间有很多很多的解决方案，它们是商业的，但相对便宜。

希望这是有用的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-05-19T21:12:42.910

我推荐阅读[HG Init](http://hginit.com/) - Joel Spolsky 撰写的关于如何从 SVN 切换到 Mercurial 的指南。

正如之前的一些答案所提到的，SVN 和 ClearCase 基本上是在相同的范式下工作的，所以当你阅读这篇文章时，你几乎可以用“Subversion”这个词的每个出现来代替“ClearCase”并将其应用于你的情况。

这是最终说服*我*开始在工作中使用 Mercurial 的文章。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-30T20:17:02.073

在我看来，您在 git/mercurial 中会很开心，而在 SVN 中可能不会。OTOH，我所有的 clearcase 经历都是乏味和无爱的，所以我认为任何“逃脱”行动确实是一件非常好的事情。

分布式系统听起来更符合您的工作流程。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-24T13:12:59.440

我很想知道您的分支结构是如何设置的。

为什么用户在你产品的“主干”上工作？（我假设这意味着您的主要分支）。开发分支不会阻止您的开发人员影响主干吗？

为什么不能在 rmview 脚本上引入一个触发器，以防止用户在结帐时删除视图？这是一个非常简单的练习，网上有很多资源（如果你问的话，我相信 StackOverflow 会为你提供答案！）。

另一个建议是，如果您已经将现金投资于 IBM 产品（因此愿意花钱购买商业支持的 SCM 环境），您可能想看看 Team Concert 和 Jazz。

# python - Django UserProfile ...没有密码

> ID：172066
> 
> 赞同：4
> 
> 时间：2008-10-05T14:29:56.730
> 
> 标签：python, database, django, django-authentication, django-users

我想创建一个没有登录名的用户子集......基本上作为一种在照片中添加摄影师字段的方式，而无需与该人关联的完整帐户（因为在许多情况下，他们会从未真正登录到该站点）。需要注意的是，我还希望以后能够为他们启用帐户。

因此，我认为问题变成了设置与 User 表相关联的“People”表而不用 UserProfile 实际扩展 User 表的最佳方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-05T14:53:46.883

用户[配置文件](http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)（由 返回`django.contrib.auth.models.User.get_profile`）不会扩展 User 表 - 您指定为具有`AUTH_PROFILE_MODULE`设置的配置文件模型的模型只是具有`ForeignKey`to的模型`User`。`get_profile`并且设置实际上只是一个方便的 API，用于访问具有特定实例的特定模型`ForeignKey`的`User`实例。

因此，一种选择是创建一个配置文件模型，其中`ForeignKey`可以`User`将`null`您的`Photo`模型与此配置文件模型而不是模型相关联`User`。这将允许您为不存在的用户创建配置文件，并在以后将注册用户附加到配置文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T18:57:26.020

无法登录的用户？只是给了他们一个完全随机的密码。

```
import random
user.set_password( str(random.random()) ) 
```

他们将永远无法登录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T00:40:41.067

提供您自己的身份验证例程，然后您可以检查（或不检查）您喜欢的任何内容。我们这样做是为了如果他们在正常用户名上失败，我们也可以让他们通过电子邮件/密码进入（尽管这不是我在下面展示的内容）。

在 settings.py 中：

```
AUTHENTICATION_BACKENDS = (
    'django.contrib.auth.backends.ModelBackend',
    'userprofile.my_authenticate.MyLoginBackend', # if they fail the normal test
 ) 
```

在 userprofile/my_authenticate.py 中：

```
from django.contrib.auth.backends import ModelBackend
from django.contrib.auth.models import User

class MyLoginBackend(ModelBackend):
    """Return User record if username + (some test) is valid.
       Return None if no match.
    """

    def authenticate(self, username=None, password=None, request=None):
        try:
            user = User.objects.get(username=username)
            # plus any other test of User/UserProfile, etc.
            return user # indicates success
        except User.DoesNotExist:
            return None
    # authenticate
# class MyLoginBackend 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T14:56:24.553

从[django auth](http://docs.djangoproject.com/en/dev/topics/auth/)的文档中，如果您想使用 User 模型，则必须拥有用户名和密码，没有“匿名帐户”。我想您可以使用默认密码创建帐户，然后让人们有机会启用“真实”帐户（通过自己设置密码）。

要设置与 User 表相关联的“People”表，您只需使用 ForeignKey 字段（这实际上是向 User 模型添加附加信息的[推荐方法，而不是继承）](http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T22:31:06.413

使用具有[链接到 User 的 ForeignKey 字段的模型](http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)可能无法正常工作，因为您需要匿名访问。我不确定这是否可行，但你可以尝试如果你让它有一个到[AnonymousUser](http://docs.djangoproject.com/en/dev/topics/auth/#anonymous-users)的 ForeignKey （其 id 始终为 None！）会发生什么。

如果您尝试一下，请在此处发布您的结果，我会很好奇。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T09:23:25.630

django.contrib.auth.models.User 的存在仅用于使用默认身份验证后端（基于数据库）。如果您编写自己的后端，则可以使某些帐户无密码，同时保持*普通*帐户有密码。Django 文档对此有一个[章节](http://docs.djangoproject.com/en/dev/topics/auth/#other-authentication-sources)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T22:09:42.917

另一个对[insin 答案的支持](https://stackoverflow.com/questions/172066/django-userprofile-without-a-password#172097)：通过`UserProfile`. [James Bennett](http://djangopeople.net/ubernostrum/)有一篇关于扩展的[好文章](http://www.b-list.org/weblog/2006/jun/06/django-tips-extending-user-model/)`django.contrib.auth.models.User`。他介绍了几种方法，解释了它们的优缺点，并最终实现了`UserProfile`理想。

# .net - 是否可以从实体数据模型（edmx）文件生成数据库？

> ID：172084
> 
> 赞同：2
> 
> 时间：2008-10-05T14:47:46.273
> 
> 标签：.net, entity-framework

在 Linq to SQL 中，可以从 dbml 文件生成数据库。

是否可以从实体数据模型生成数据库？我希望使用 edmx 文件来完成同样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T15:09:24.107

直到下一个版本，您可以在实体框架设计博客上阅读：

[http://blogs.msdn.com/efdesign/archive/2008/09/10/model-first.aspx](http://blogs.msdn.com/efdesign/archive/2008/09/10/model-first.aspx)

# c# - 慢 SoapHttpClientProtocol 构造函数

> ID：172095
> 
> 赞同：30
> 
> 时间：2008-10-05T14:52:52.597
> 
> 标签：c#, .net, performance, xml-serialization, soaphttpclientprotocol

我正在用 Microsoft Dynamics CRM 做一些实验。您通过 Web 服务与它进行交互，并且我在我的项目中添加了一个 Web 引用。Web 服务接口非常丰富，生成的“Reference.cs”大约有 90k loc。

我在控制台应用程序中使用 Web 引用。我经常改变一些东西，重新编译并运行。编译速度很快，但更新 Web 服务引用非常慢，大约需要 15-20 秒： `CrmService service = new CrmService();` 分析显示所有时间都花在了 SoapHttpClientProtocol 构造函数中。

罪魁祸首显然是 XML 序列化代码（不包括在上面提到的 90k 位置中）是在运行时生成的，在被 JIT 之前。这发生在构造函数调用期间。在玩耍和尝试时，等待是相当令人沮丧的。

我尝试了 sgen.exe、ngen 和 XGenPlus 的各种组合（这需要几个小时并生成 500MB 的附加代码），但无济于事。我考虑过实现一个 Windows 服务，该服务几乎没有准备好在需要时提供的 CrmService 实例，但这似乎太过分了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-08T16:48:37.450

以下内容来自VMWare 论坛上的[此线程：](http://communities.vmware.com/thread/47063)

嗨伙计，

我们发现 sgen.exe 确实有效。只是除了预生成我们在这个线程中遗漏的序列化程序 dll 之外，还有几个额外的步骤。这是详细说明

## 问题

当从 .NET 使用 VIM 2.0 SDK 时，需要很长时间来实例化 VimService 类。（VimService类是运行'wsdl.exe vim.wsdl vimService.wsdl'生成的代理类）

换句话说，以下代码行：

```
_service = new VimService(); 
```

执行可能需要大约 50 秒。

## 原因

显然，.NET`XmlSerializer`使用`System.Xml.Serialization.*`注释代理类的属性在运行时生成序列化代码。当代理类很多且很大时，如 VimService.cs 中的代码，序列化代码的生成可能需要很长时间。

## 解决方案

这是 Microsoft .NET 序列化程序工作方式的一个已知问题。

以下是 MSDN 提供的有关解决此问题的一些参考资料：

[http://msdn2.microsoft.com/en-us/library/bk3w6240.aspx](http://msdn2.microsoft.com/en-us/library/bk3w6240.aspx) [http://msdn2.microsoft.com/en-us/library/system.xml.serialization.xmlserializerassemblyattribute.aspx](http://msdn2.microsoft.com/en-us/library/system.xml.serialization.xmlserializerassemblyattribute.aspx)

不幸的是，以上参考资料都没有描述该问题的完整解决方案。相反，他们专注于如何预先生成 XML 序列化代码。

完整的修复涉及以下步骤：

1.  使用预生成的 XML 序列化程序代码创建程序集（DLL）

2.  从代理代码中删除所有对 System.Xml.Serialization.* 属性的引用（即从 VimService.cs 文件中）

3.  使用 XmlSerializerAssemblyAttribute 注释主代理类，以将其指向 XML 序列化程序程序集所在的位置。

跳过第 2 步只会导致`VimService`类的实例化时间缩短 20%。跳过第 1 步或第 3 步会导致代码不正确。通过所有三个步骤，实现了 98% 的改进。

以下是分步说明：

在开始之前，请确保您使用的是 .NET 版本 2.0 工具。此解决方案不适用于 .NET 1.1 版，因为 sgen 工具和`XmlSerializationAssemblyAttribute`仅在 .NET 2.0 版中可用

1.  使用 wsdl.exe 从 WSDL 生成 VimService.cs 文件：

    `wsdl.exe vim.wsdl vimService.wsdl`

    这将输出当前目录下的 VimService.cs 文件

2.  将 VimService.cs 编译成库

    `csc /t:library /out:VimService.dll VimService.cs`

3.  使用 sgen 工具预生成和编译 XML 序列化程序：

    `sgen /p VimService.dll`

    这将输出当前目录中的 VimService.XmlSerializers.dll

4.  返回到 VimService.cs 文件并删除所有`System.Xml.Serialization.*`属性。因为代码代码很大，最好的方法是使用一些正则表达式替换工具。执行此操作时要小心，因为并非所有属性都单独出现在一行上。有些是作为方法声明的一部分内联的。

    如果您觉得这一步很困难，这里有一个简化的方法：

    假设您正在编写 C#，请对以下字符串进行全局替换：

    `[System.Xml.Serialization.XmlIncludeAttribute`

    并将其替换为：

    `// [System.Xml.Serialization.XmlIncludeAttribute`

    这将通过将`Xml.Serialization`它们注释掉来摆脱那些是导致减速的最大罪魁祸首的属性。如果您使用的是其他 .NET 语言，只需根据该语言的语法将替换的字符串修改为前缀注释即可。这种简化的方法将使您获得最大的加速。删除其余的 Xml.Serialization 属性只能实现额外的 0.2 秒加速。

5.  在 VimService.cs 中的 VimService 类中添加以下属性：

    `[System.Xml.Serialization.XmlSerializerAssemblyAttribute(AssemblyName = "VimService.XmlSerializers")]`

    你应该得到这样的结果：

    `// ... Some code here ... [System.Xml.Serialization.XmlSerializerAssemblyAttribute(AssemblyName = "VimService.XmlSerializers")] public partial class VimService : System.Web.Services.Protocols.SoapHttpClientProtocol { // ... More code here`

6.  通过重新生成 VimSerice.dll 库

    `csc /t:library /out:VimService.dll VimService.cs`

7.  现在，从您的应用程序中，您可以添加对 VimSerice.dll 库的引用。

8.  运行您的应用程序并验证 VimService 对象实例化时间是否减少。

## 补充笔记

sgen 工具有点像一个黑盒子，它的行为会根据您在 Machine.config 文件中的内容而有所不同。例如，默认情况下，它应该输出优化的非调试代码，但并非总是如此。要了解该工具，请在步骤 3 中使用 /k 标志，这将导致它保留所有临时生成的文件，包括它生成的源文件和命令行选项文件。

即使经过上述修复，第一次实例化 VimService 类所需的时间也不是瞬时的（1.5 秒）。根据经验观察，剩余时间的大部分似乎是由于处理`SoapDocumentMethodAttribute`属性。目前尚不清楚如何减少此时间。预生成的 XmlSerializer 程序集不考虑与 SOAP 相关的属性，因此这些属性需要保留在代码中。好消息是该应用程序的 VimService 类的第一次实例化需要很长时间。因此，如果额外的 1.5 秒有问题，可以尝试在应用程序开始时对此类进行虚拟实例化，以改善登录时间的用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T15:03:16.180

您可能希望研究[`Sgen.exe`](http://msdn.microsoft.com/en-us/library/bk3w6240(VS.80).aspx).NET 附带的工具。在 Visual Studio 的 C# 项目属性“构建”页面中还有一个方便的小东西，位于最底部，称为“构建序列化程序集”，它会自动`Sgen`为您运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T04:51:52.027

我相信这不是 SGEN 的问题。我查看了构造函数代码，发现它做了很多反射（基于类上的 XmlIncludeAttribute）。它反映在所有这些上，并且可能需要很长时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T22:07:12.487

CRM 附带了一个预先生成的 XmlSerializer 程序集。检查 GAC 中是否有 SdkTypeProxy.XmlSerializers.dll 和 SdkProxy.XmlSerializers.dll。

如果您不这样做，则意味着当您创建 CrmService 时，.net 将生成 XmlSerializer 程序集，这可能需要一些时间。希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T01:13:50.747

当我试图找出为什么我的初始`SoapHttpClientProtocol`呼叫需要这么长时间时，我遇到了这个线程。

我发现将代理设置为 null/Empty 会阻止代理自动检测的发生 - 这在初始调用中最多需要 7 秒：

```
this.Proxy = GlobalProxySelection.GetEmptyWebProxy(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-08T21:08:37.450

我已使用上述详细答案作为指导，并向前走了几步，制作了一个脚本来自动化流程。脚本由两个文件组成：

生成代理.bat：

```
REM if your path for wsdl, csc or sgen is missing, please add it here (it varies from machine to machine)
set PATH=%PATH%;C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 Tools;C:\Program Files (x86)\MSBuild\14.0\Bin

wsdl http://localhost:57237/VIM_WS.asmx?wsdl REM create source code out of WSDL
PowerShell.exe -ExecutionPolicy Bypass -Command "& '%~dpn0.ps1'" REM proces source code (remove annotations, add other annotation, put class into namespace)
csc /t:library /out:references\VIM_Service.dll VIM_WS.cs REM compile source into dll
sgen /p references\VIM_Service.dll /force REM generate serializtion dll 
```

生成代理.ps1

```
(Get-Content VIM.cs) | 
    ForEach-Object { 
        $_ -replace "(?<attr>\[global::System.Xml.Serialization.[^\]]*\])", "/*${attr}*/" `
            -replace "public partial class VIM", "[System.Xml.Serialization.XmlSerializerAssemblyAttribute(AssemblyName = ""VIM_Service.XmlSerializers"")] `npublic partial class VIM" `
            -replace "using System;", "namespace Classes.WS_VIM {   `n`nusing System;"
    } |
Set-Content VIM.cs
Add-Content VIM.cs "`n}" 
```

我已将这两个文件添加到客户端项目中，并在预构建事件中添加了行

```
cd..\..
generateproxy 
```

因此，在每次构建之前，都会重新生成代理类，开发人员（几乎）不需要考虑它。在构建时，WS 必须启动并运行，并且它的 URL 必须在 bat 文件中。作为预构建的结果，两个 dll 文件将在客户端项目的子文件夹*引用*中重新生成。首次执行脚本后，您应该添加对新 dll 的引用。

# c# - 反序列化 JSON Google AJAX 翻译 API

> ID：172102
> 
> 赞同：3
> 
> 时间：2008-10-05T14:59:20.210
> 
> 标签：c#, ajax, json, google-translate

我有 JSON 像这样回来：

```
{
  "responseData": [{
    "responseData": {
      "translatedText": "elefante"
    },
    "responseDetails": null,
    "responseStatus": 200
  }, {
    "responseData": {
      "translatedText": "Burro"
    },
    "responseDetails": null,
    "responseStatus": 200
  }],
  "responseDetails": null,
  "responseStatus": 200
} 
```

我需要将其解析为我设置的 ResponseData 对象：

```
public class ResponseData 
{
    public string translatedText = string.Empty;
    public object responseDetails = null;
    public HttpStatusCode responseStatus = HttpStatusCode.OK;
    public List <ResponseData> responseData { get;set; }
} 
```

我像这样反序列化它：

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
ResponseData translation =
 serializer.Deserialize<ResponseData>(responseJson); 
```

但无论什么翻译的文本总是空的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T15:22:55.517

您应该考虑该字符串中表示的 JSON 对象图。

您可以使用如下泛型嵌套用于反序列化具有不同属性/字段的对象的类型：

```
class Response < T > {
 public ResponseData < T > [] responseData = new ResponseData < T > [0];
 public HttpStatusCode responseStatus;
 public object responseDetails;
}

public class ResponseData < TInternal > {
 public TInternal responseData;
 public HttpStatusCode responseStatus;
 public object responseDetails;
}

public class TranslatedText {
 public string translatedText;
}

[Test]
public void Sample() {
 var input = @ " {
  ""
  responseData "": [{
    ""
    responseData "": {
     ""
     translatedText "": ""
     elefante ""
    },
    ""
    responseDetails "": null,
    ""
    responseStatus "": 200
   }, {
    ""
    responseData "": {
     ""
     translatedText "": ""
     Burro ""
    },
    ""
    responseDetails "": null,
    ""
    responseStatus "": 200
   }],
   ""
  responseDetails "": null, ""
  responseStatus "": 200
 }
 ";

 var json = new JavaScriptSerializer();
 var response = json.Deserialize < Response < TranslatedText >> (input);
 Assert.AreEqual(response.responseData[0].responseData.translatedText, "elefante");
 Assert.AreEqual(response.responseStatus, HttpStatusCode.OK);
} 
```

# perl - 如何在 Perl 中以 RFC822 格式优雅地打印日期？

> ID：172110
> 
> 赞同：18
> 
> 时间：2008-10-05T15:05:41.417
> 
> 标签：perl, datetime, date, rfc822

如何在 Perl 中以 RFC822 格式优雅地打印日期？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-05T15:12:41.027

```
use POSIX qw(strftime);
print strftime("%a, %d %b %Y %H:%M:%S %z", localtime(time())) . "\n"; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-05T17:40:51.853

DateTime 套件为您提供了多种不同的方式，例如：

```
use DateTime;
print DateTime->now()->strftime("%a, %d %b %Y %H:%M:%S %z");

use DateTime::Format::Mail;
print DateTime::Format::Mail->format_datetime( DateTime->now() );

print DateTime->now( formatter => DateTime::Format::Mail->new() ); 
```

更新：要为某个特定时区提供时间，请将 time_zone 参数添加到 now()：

```
DateTime->now( time_zone => $ENV{'TZ'}, ... ) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-20T08:40:42.300

它可以用 来完成`strftime`，但它的`%a`(day) 和`%b`(month) 用当前语言环境的语言表示。

来自`man strftime`：

> %a 根据当前语言环境的缩写工作日名称。
> %b 根据当前语言环境的缩写月份名称。

邮件中的日期字段**只能**使用这些名称（来自[rfc2822 DATE AND TIME SPECIFICATION](https://www.rfc-editor.org/rfc/rfc2822#page-14)）：

```
day         =  "Mon"  / "Tue" /  "Wed"  / "Thu" /  "Fri"  / "Sat" /  "Sun"

month       =  "Jan"  /  "Feb" /  "Mar"  /  "Apr" /  "May"  /  "Jun" /
               "Jul"  /  "Aug" /  "Sep"  /  "Oct" /  "Nov"  /  "Dec" 
```

因此可移植代码应该切换到`C`语言环境：

```
use POSIX qw(strftime locale_h);

my $old_locale = setlocale(LC_TIME, "C");
my $date_rfc822 = strftime("%a, %d %b %Y %H:%M:%S %z", localtime(time()));
setlocale(LC_TIME, $old_locale);

print "$date_rfc822\n"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-12T21:23:42.760

仅使用`POSIX::strftime()`已在其他答案和评论中指出的问题：

*   它不适用于 MS-DOS aka Windows，它产生像“W. Europe Standard Time”这样的字符串，而不是[RFC822](https://www.rfc-editor.org/rfc/rfc822 "RFC822")`%z`转换规范所要求的“+0200”。
*   它将以当前语言环境而不是英语打印缩写的月份和日期名称，这也是[RFC822](https://www.rfc-editor.org/rfc/rfc822 "RFC822")所要求的。

将语言环境切换为“POSIX”。“C”修复了后一个问题，但可能很昂贵，对于后来切换回以前语言环境的行为良好的代码来说更是如此。

但它也不是完全线程安全的。虽然临时切换语言环境在 Perl 解释器线程中不会出现问题，但当 Perl 解释器本身在内核线程中运行时会出现竞争。当 Perl 解释器嵌入到服务器中时（例如[mod_perl](https://perl.apache.org/ "mod_perl")在线程化的 Apache MPM 中运行），就会出现这种情况。

以下版本不受任何此类限制，因为它不使用任何依赖于语言环境的函数：

```
sub rfc822_local {
    my ($epoch) = @_;

    my @time = localtime $epoch;

    use integer;

    my $tz_offset = (Time::Local::timegm(@time) - $now) / 60;
    my $tz = sprintf('%s%02u%02u',
                     $tz_offset < 0 ? '-' : '+',
                     $tz_offset / 60, $tz_offset % 60);

    my @month_names = qw(Jan Feb Mar Apr May Jun
                         Jul Aug Sep Oct Nov Dec);
    my @day_names = qw(Sun Mon Tue Wed Thu Fri Sat Sun);

    return sprintf('%s, %02u %s %04u %02u:%02u:%02u %s',
                   $day_names[$time[6]], $time[3], $month_names[$time[4]],
                   $time[5] + 1900, $time[2], $time[1], $time[0], $tz);
} 
```

但应该注意的是，从纪元以来的秒数转换为故障时间（反之亦然）是相当复杂和昂贵的操作，在不处理 GMT/UTC 而是处理本地时间时更是如此。后者需要检查包含当前和历史 DST 以及当前时区的时区设置的 zoneinfo 数据。它也容易出错，因为这些参数受制于[未来可能会恢复的](http://europa.eu/rapid/press-release_IP-18-5302_en.htm "将来可能会恢复")政治决策。因此，当系统没有定期更新时，依赖 zoneinfo 数据的代码很脆弱并且可能会中断。

但是，符合 RFC822 的日期和时间规范的目的不是通知其他服务器有关“您的”服务器的时区设置，而是以独立于时区的方式给出当前日期和时间的概念。通过简单地使用 UTC 而不是本地时间，您可以在发送端和接收端节省大量 CPU 周期（它们可以用 CO2 排放量来衡量）：

```
sub rfc822_gm {
    my ($epoch) = @_;

    my @time = gmtime $epoch;

    my @month_names = qw(Jan Feb Mar Apr May Jun
                         Jul Aug Sep Oct Nov Dec);
    my @day_names = qw(Sun Mon Tue Wed Thu Fri Sat Sun);

    return sprintf('%s, %02u %s %04u %02u:%02u:%02u +0000',
                   $day_names[$time[6]], $time[3], $month_names[$time[4]],
                   $time[5] + 1900, $time[2], $time[1], $time[0]);
} 
```

通过对时区进行硬编码，`+0000`您可以避免上述所有问题，同时仍然完全符合标准，更快地离开。当性能可能对您来说是个问题时，请使用该解决方案。当您的用户抱怨软件报告“错误”时区时，请使用第一个解决方案。

# .net - 如何在驱动器号可用时收到通知

> ID：172111
> 
> 赞同：1
> 
> 时间：2008-10-05T15:06:08.467
> 
> 标签：.net, filesystems

当驱动器号可访问时，是否可以获得通知（无需轮询，但通过事件）。例如，如果您有一个始终显示为驱动器 F 的外部硬盘驱动器 - 是否有可能在连接该驱动器并且 F 变得可访问时引发事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T15:23:27.027

好的..找到我要找的东西:)

看看这个 VBScript：（[来源](http://www.microsoft.com/technet/scriptcenter/resources/qanda/feb06/hey0213.mspx)）：

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

Set colEvents = objWMIService.ExecNotificationQuery _
    ("Select * From __InstanceOperationEvent Within 10 Where " _
        & "TargetInstance isa 'Win32_LogicalDisk'")

Do While True
    Set objEvent = colEvents.NextEvent
    If objEvent.TargetInstance.DriveType = 2 Then 
        Select Case objEvent.Path_.Class
            Case "__InstanceCreationEvent"
                Wscript.Echo "Drive " & objEvent.TargetInstance.DeviceId & _
                    " has been added."
            Case "__InstanceDeletionEvent"
                Wscript.Echo "Drive " & objEvent.TargetInstance.DeviceId & _
                    " has been removed."
        End Select
    End If
Loop 
```

我把它留给你的练习来移植到 C#。

您可以使用[WMI 事件接收器](http://msdn.microsoft.com/en-us/library/aa393013(VS.85).aspx)，而不是一直轮询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T15:44:49.480

您可以等待 WM_DEVICECHANGE 消息，所有详细信息都在：

[http://msdn.microsoft.com/en-us/library/aa363215(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363215(VS.85).aspx)

您将必须创建一个窗口来接收此消息，如果需要，可以隐藏该窗口，要在 WinForms 中获取此消息，只需覆盖 Form.WndProc 方法

# objective-c - 避免、发现和消除 Cocoa 中的内存泄漏

> ID：172125
> 
> 赞同：19
> 
> 时间：2008-10-05T15:15:40.333
> 
> 标签：objective-c, cocoa, debugging, macos, memory

发生内存（和资源）泄漏。你如何确保他们没有？

您会建议哪些技巧和技术来帮助避免首先造成内存泄漏？

一旦你有一个泄漏的应用程序，你如何追踪泄漏源？

（哦，请避免“只使用 GC”的答案。在 iPhone 支持 GC 之前，这不是一个有效的答案，即使那样 - 可能会在 GC 上泄漏资源和内存）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-05T16:39:28.153

在 XCode 4.5 中，使用内置的[静态分析器](http://developer.apple.com/library/mac/#recipes/xcode_help-source_editor/Analyze/Analyze.html)。

在 3.3 之前的 XCode 版本中，您可能必须下载静态分析器。这些链接向您展示了如何：

## 使用 LLVM/Clang 静态分析器

为避免一开始就造成内存泄漏，请使用[Clang 静态分析器](http://clang-analyzer.llvm.org/)- 不出所料 - 在 Mac OS X 10.5 上分析您的 C 和 Objective-C 代码（还没有 C++）。安装和使用很简单：

1.  [从此页面](http://clang-analyzer.llvm.org/)下载最新版本。
2.  从命令行，`cd`到您的项目目录。
3.  执行`scan-build -k -V xcodebuild`。

（还有一些额外的限制等，特别是您应该在其“调试”配置中分析一个项目——有关详细信息，请参阅[http://clang.llvm.org/StaticAnalysisUsage.html](http://clang.llvm.org/StaticAnalysisUsage.html) ——但这或多或少它归结为什么。）

然后分析器为您生成一组网页，显示可能的内存管理和编译器无法检测到的其他基本问题。

如果您的项目不针对 Mac OS X 桌面，还有一些其他细节：

1.  将 Base SDK for All Configurations 设置为使用 Mac OS X 桌面框架的 SDK...
2.  将命令行构建设置为使用调试配置。

[（这与这个问题](https://stackoverflow.com/questions/155964/what-are-best-practices-that-you-use-when-writing-objective-c-and-cocoa#169783)的答案基本相同。）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-05T17:16:29.670

## 不要过度考虑内存管理

出于某种原因，许多开发人员（尤其是早期开发人员）使他们自己的内存管理比以往任何时候都更加困难，通常是通过过度思考问题或想象它比实际情况更复杂。

基本[规则](http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/MemoryMgmt/index.html)非常简单。您应该只专注于遵循这些。不要担心其他对象可能会做什么，或者您的对象的保留计数是多少。相信其他人都遵守相同的合同，这一切都会正常工作。

特别是，我将重申不要担心对象的保留计数这一点。由于各种原因，保留计数本身可能会产生误导。如果您发现自己记录了对象的保留计数，则几乎可以肯定您走错了路。退后一步问问自己，你是否遵循基本规则？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-05T16:52:42.247

## 始终使用访问器方法；使用属性声明访问器

`init*`如果您总是使用访问器方法将值分配给实例变量（除了 in和`dealloc`方法），那么您自己的生活就会变得更加简单。除了确保正确触发任何副作用（例如[KVO 更改通知](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)`retain`）之外，与使用s 和`release`s。

声明访问器时，应始终使用[Objective-C 2 的属性](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_5_section_1.html)特性。属性声明使访问器的内存管理语义明确。它们还为您提供了一种简单的方法来交叉检查您的`dealloc`方法，以确保您已释放所有声明为`retain`or的属性`copy`。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-05T15:18:03.997

Instruments Leaks 工具非常擅长发现某种类型的内存泄漏。只需使用“Start with Performance Tool”/“Leaks”菜单项即可通过此工具自动运行您的应用程序。适用于 Mac OS X 和 iPhone（模拟器或设备）。

Leaks 工具可帮助您找到泄漏源，但对跟踪泄漏内存的保留位置没有太大帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-05T15:17:55.430

*   遵循保留和释放规则（或使用垃圾收集）。[他们总结在这里](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)。

*   使用仪器追踪泄漏。您可以使用 Xcode 中的 Build > Start With Performance Tool 在 Instruments 下运行应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-05T16:20:01.953

我记得不久前我使用 Omni 的一个工具，当时我试图追踪一些内存泄漏，这些泄漏会显示一个对象上的所有保留/释放/自动释放调用。我*认为*它显示了分配的堆栈跟踪以及对象上的所有保留和释放。

[http://www.omnigroup.com/developer/omniobjectmeter/](http://www.omnigroup.com/developer/omniobjectmeter/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T17:39:33.740

首先，您对 [ ] 和 { } 括号和大括号的使用符合通用标准非常重要。好吧，开个玩笑。

在查看泄漏时，您可以假设泄漏是由于代码中的问题造成的，但这并不是 100% 的错误。在某些情况下，Apple 的（喘气！）代码中可能发生了错误。而且它可能很难找到，因为它不会显示为被分配的可可对象。我过去曾向 Apple 报告过泄漏错误。

泄漏有时很难找到，因为您发现的线索（例如，数百个字符串泄漏）可能不是因为直接导致字符串泄漏的那些对象正在泄漏，而是因为某些东西正在泄漏*该*对象。通常，您必须挖掘泄漏的“树”的叶子和树枝才能找到问题的“根源”。

预防：我的主要规则之一是真的，真的，真的避免分配一个对象，而不仅仅是在现场自动释放它。任何你分配/初始化一个对象然后在代码块中释放它的地方都是你犯错的机会。要么你忘记释放它，要么你抛出一个异常以使释放永远不会被调用，或者你在方法的某处放置一个'return'语句以提前退出（我也尽量避免）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-25T20:04:39.403

您可以从这里构建 Valgrind 的 beta 端口：[http ://www.sealiesoftware.com/valgrind/](http://www.sealiesoftware.com/valgrind/)

它比任何静态分析都要有用得多，但据我所知，它还没有任何特殊的 Cocoa 支持。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-22T14:32:28.877

显然，您首先需要了解基本的内存管理概念。但在追查泄漏方面，我强烈建议阅读[本教程，了解如何在 Instruments 中使用 Leaks 模式](http://mobileorchard.com/find-iphone-memory-leaks-a-leaks-tool-tutorial/)。

# visual-studio - 如何从 Visual Studio 2008 中的选项卡中删除路径？

> ID：172130
> 
> 赞同：2
> 
> 时间：2008-10-05T15:19:03.930
> 
> 标签：visual-studio, visual-studio-2008, ide, tabs

有没有办法停止在 Visual Studio 2008 的源代码选项卡中显示的路径？

目前在开发 ASP.NET 站点时，我从根目录加上文件名获取路径 - 当它变得太长时被截断。所以像：

> 我的目录/我的页面.aspx

对于短路径和文件名，或者：

> MyDir/MyLong...yPage.aspx

更长的路径和文件名。

我宁愿只看到文件名（即只显示 MyPage.aspx），允许同时显示更多选项卡，并且更容易查看我打开了哪些文件，而无需使用下拉列表或 Crtl-Tab 来显示完整放。

在 VS2005 中，我只得到文件名——不管它有多长，都没有路径。奇怪的是在 VS2003 中我得到了路径和文件名。我已经搜索了选项，但找不到可以让我更改选项卡中显示内容的设置。搜索表明其他人也有类似的问题（尽管它出现在哪个版本中似乎有所不同），但没有人可以确定更改出现内容的选项。

谁能指出我正确的方向以摆脱选项卡中的路径（或确认无法更改以节省我浪费更多时间搜索）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-08T17:14:30.280

在我的 VS 2008 副本中，我只得到文件名，而不是路径。我想知道这是否是“网站”与“网络应用程序”的事情。你在哪一个工作？你能创建一个其他类型的项目，看看它是否仍然发生吗？（我在一个仅获取文件名的 Web 应用程序中工作。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T09:31:04.220

看起来微软不允许使用标准方法来做到这一点。我知道[ReSharper](http://en.wikipedia.org/wiki/ReSharper)允许这样做，但为此安装一个大插件是个坏主意。我想我找到了一个允许显示或隐藏完整路径的小插件。我确信这应该存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T09:32:31.550

[Tabs Studio](http://www.tabsstudio.com)加载项可以从 Visual Studio 2008 中的选项卡中删除路径。

有关示例屏幕截图，请参阅 从选项卡名称 博客文章中[删除路径。](http://tabsstudio.wordpress.com/2009/05/07/removing-path-from-tab-name/)

# string - UTF8 与 UTF16 与 char* 与什么？有人给我解释一下这个烂摊子！

> ID：172133
> 
> 赞同：33
> 
> 时间：2008-10-05T15:22:07.107
> 
> 标签：string, utf-8, character-encoding, utf-16, multibyte

我已经设法几乎忽略了所有这些多字节字符的东西，但现在我需要做一些 UI 工作，我知道我在这方面的无知会赶上我！谁能在几段或更少的段落中解释我需要知道的内容，以便我可以本地化我的应用程序？我应该使用什么类型（我同时使用 .Net 和 C/C++，对于 Unix 和 Windows，我都需要这个答案）。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-05T15:25:30.643

查看 Joel Spolsky 的**[《每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最小值》（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)**

**编辑 20140523**：另外，在 YouTube 上观看 Tom Scott**[的 Characters, Symbols and the Unicode Miracle](https://www.youtube.com/watch?v=MijmeoH9LT4)** - 不到 10 分钟，精彩的解释是 UTF-8 的“hack”

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-05T15:28:22.680

字符编码由一系列代码组成，每个代码都从给定的字符集中查找一个符号。请参阅[Wikipedia 上有关字符编码](http://en.wikipedia.org/wiki/Character_encoding)的这篇好文章。

**[UTF8 (UCS)](http://en.wikipedia.org/wiki/UTF-8)**对每个符号使用 1 到 4 个字节。 [Wikipedia](http://en.wikipedia.org/wiki/UTF-8)很好地概述了多字节列表的工作原理：

> *   单字节字符的最高有效位始终为 0。
> *   多字节序列的第一个字节的最高有效位决定了序列的长度。对于两字节序列，这些最高有效位是 110；1110 用于三字节序列，依此类推。
> *   多字节序列中的剩余字节以 10 作为它们的两个最高有效位。
> *   UTF-8 流既不包含字节 FE 也不包含 FF。这确保 UTF-8 流永远不会看起来像以 U+FEFF（字节顺序标记）开头的 UTF-16 流

该页面还向您展示了每种字符编码类型的优缺点之间的很好比较。

[**UTF16 (UCS2)**](http://en.wikipedia.org/wiki/UTF-16)

每个符号使用 2 个字节到 4 个字节。

[**UTF32 (UCS4)**](http://en.wikipedia.org/wiki/UTF-32)

每个符号总是使用 4 个字节。

**char**仅表示一个字节的数据，而不是实际的编码。它与 UTF8/UTF16/ascii 不同。char* 指针可以引用任何类型的数据和任何编码。

**STL：**

stl 的 std::wstring 和 std::string 都不是为像 UTF-8 和 UTF-16 这样的可变长度字符编码而设计的。

**如何实施：**

看看 iconv 库。 [iconv](http://www.gnu.org/software/libiconv/)是一个功能强大的字符编码转换库，被[libxml](http://xmlsoft.org/index.html)（Gnome 的 XML C 解析器）等项目使用

**有关字符编码的其他重要资源：**

*   [tbray.org 的字符与字节](http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF)
*   [IANA 字符集](http://www.iana.org/assignments/character-sets)
*   [www.cs.tut.fi 的代码问题教程](http://www.cs.tut.fi/~jkorpela/chars.html)
*   [每个软件开发人员绝对、肯定地必须了解 Unicode 和字符集的绝对最低要求（没有任何借口！）](http://www.joelonsoftware.com/articles/Unicode.html)（首先由@Dylan Beattie 提到）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-05T17:07:51.513

[公认的智慧](http://lists.apple.com/archives/Cocoa-dev/2008/Aug/msg00940.html)表明，斯波尔斯基的文章遗漏了几个要点。

建议这篇文章更完整： [Unicode® 标准：技术介绍](http://unicode.org/standard/principles.html)

这篇文章也是很好的介绍：[Unicode Basics](http://icu-project.org/userguide/unicodeBasics.html)

后者特别概述了 Unicode 的字符编码形式和方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-05T15:47:39.740

各种 UTF 标准是编码“代码点”的方法。代码点是 Unicode 字符集的索引。

另一种编码是 UCS2，它总是 16 位，因此不支持完整的 Unicode 范围。

还好知道一个代码点不等于一个字符。例如，像 å 这样的字符既可以表示为一个代码点，也可以表示为两个代码点，一个用于 a，一个用于 ring。

因此，比较两个 unicode 字符串需要标准化以在比较之前获得规范表示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T15:50:45.553

字体也有问题。有两种处理字体的方法。要么为你需要的所有 Unicode 字符使用带有字形的巨大字体（我认为最新版本的 Windows 带有一两个这样的字体）。或者您使用 som 库，该库能够组合来自各种专用于 Unicode 标准子集的字体的字形。

# php - 设置多语言 wordpress

> ID：172138
> 
> 赞同：3
> 
> 时间：2008-10-05T15:25:21.487
> 
> 标签：php, wordpress, web-applications, blogs

我需要使用 wordpress 引擎建立一个博客，但我需要它支持多语言（3 种语言），目前我正在考虑使用自定义字段来识别当前帖子的语言，尽管我知道这不是最佳实践，有没有人有更好的建议?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T07:27:12.743

我测试了 2 个看起来都非常有前途的插件：[qTranslate](http://wordpress.org/extend/plugins/qtranslate/)和[Gengo](http://wordpress.org/extend/plugins/gengo/)

qTranslate 通过为每个帖子添加所有使用的语言的输入来工作，Gengo 使用单独的帖子并以“帖子 Y 是帖子 X 的翻译”的方式链接它们，我更喜欢这种方式（因为它允许我不翻译所有内容）并且它对我来说很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T13:36:18.257

我记得很清楚，wordpress 使用 gettext“自定义”库来翻译自己。我认为您可以根据会话变量做出一些关于您将要阅读的翻译文件的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T15:42:12.637

我已经使用了 xlanguage 插件，对此我很满意。 [xlanguage 网站](http://hellosam.net/project/xlanguage)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T10:19:57.837

尝试使用插件 wordpress WPML。

# java - Java中用于将文本与音频链接的数据结构

> ID：172151
> 
> 赞同：2
> 
> 时间：2008-10-05T15:35:35.193
> 
> 标签：java, audio

我想编写一个程序，在其中播放读取文本的音频文件。我想以绿色突出音频文件播放的当前音节，以红色突出当前单词的其余部分。我应该使用什么样的数据结构来存储音频文件以及告诉程序何时切换到下一个单词/音节的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T12:50:11.527

这是一个稍微偏左的建议，但你看过卡拉OK软件吗？它可能被视为不够“严重”，但听起来与您正在做的事情非常相似。例如，[Aegisub](http://www.aegisub.net/)是一个字幕程序，可让您创建 SSA/ASS 格式的字幕。它具有用于突出显示所选单词或部分的卡拉 OK 工具。

它最常用于动画字幕，但如果您有合适的播放器，它也适用于音频。遗憾的是，这些在 Mac 上非常罕见。

该格式类似于 Yuval A 提出的格式：

```
{\K132}Unmei {\K34}no {\K54}tobira
{\K60}{\K132}yukkuri {\K36}to {\K142}hirakareta 
```

长度是持续时间而不是绝对偏移量。这使得在不重新计算所有偏移量的情况下更容易移动行的开头。双重输入表示暂停。

这是否有充分的理由需要成为您的 Java 程序的一部分，或者是否有现成的解决方案？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-12T14:22:29.693

一个简单的数据结构如何描述下一批字母由下一个音节和切换到该音节的时间戳组成？

只是一个简单的例子：

[0:00] 这个 [0:02] 是 [0:05] 一个 [0:07] 例如- [0:08] am- [0:10] ple

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T12:30:06.810

要突出部分单词的发音，就像您正在进入[语音学](http://en.wikipedia.org/wiki/Phonetics)一样，语音学是构成单词的声音。将声音文件转换为可以“读取”文本的文件将非常困难。最好的办法是使用文本本身来驱动基于语音的引擎，例如基于[Java Speech API](http://java.sun.com/products/java-media/speech/forDevelopers/jsapi-guide/index.html)的 FreeTTS 。

要做到这一点，您将不得不读取要阅读的文本，将其拆分为每个音节并播放。所以“音节”是“syl”“la”“ble”。玩会；突出显示 syl，说出来，然后转到下一个。

这真的是“老派”，它在最初的 Apple II 上以同样的方式完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T15:46:55.543

您可能想熟悉 FreeTTS - 这个开源工具：[http](http://freetts.sourceforge.net/docs/index.php) ://freetts.sourceforge.net/docs/index.php -

您可能只想在给定的时间点向 TTS 引擎提供几个单词——突出显示它们，一旦这些单词被说出，取消突出显示它们并移动到下一批单词。

BR，
~A

# sql - Informix 中的“约束中列的总长度太长”错误是什么意思？

> ID：172156
> 
> 赞同：1
> 
> 时间：2008-10-05T15:42:27.613
> 
> 标签：sql, informix

我得到约束中列的总长度太长。以下错误

```
sql] Failed to execute:   CREATE TABLE GTW_WORKFLOW_MON ( WORKFLOW_NAME VARCHAR(255) NOT
NULL, WORKFLOW_LOADED NUMERIC(20) NOT NULL, ACTIVITY_NAME VARCHAR(255) NOT NULL, FLAGS    
INTEGER NOT NULL, MONITOR_NAME VARCHAR(255) NOT NULL, CLASSNAME VARCHAR(255) NOT NULL, S

TR0 VARCHAR(255), STR1 VARCHAR(255), STR2 VARCHAR(255), NUM0 VARCHAR(255), NUM1 
VARCHAR(255), NUM2 VARCHAR(255), DATE0 VARCHAR(255), DATE1 VARCHAR(255), DATE2 
VARCHAR(255), PRIMARY KEY (WORKFLOW_NAME,WORKFLOW_LOADED,ACTIVITY_NAME,MONITOR_NAME) )

  [sql] java.sql.SQLException: Total length of columns in constraint is too long. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T18:16:16.243

您的主键约束为 785 字节 (255+20+255+255)。如果您将数据库页面大小增加到 4K，它应该可以工作，几乎没有。您还应该重新考虑是否需要将列与定义它们一样宽。

我找到了一个讨论组，工程师 Radhika Gadde[描述](http://www.iiug.org/forums/ids/index.cgi/noframes/read/8100)了最大索引大小与页面大小有关。他说：

创建表时遇到的错误。最大索引键长度可以计算如下：

[(页面大小 -93)/5] -1

就像 2k 它是 [( 2048-93)/5] -1 =[1955/5] -1 =391-1=390

如果 PAGESIZE 为 4K，则为 [(4096-93)/5] -1 =4003/5-1=800-1 =799

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T05:36:48.870

以上回答完毕。但是考虑添加一些有用的链接，以防有人再次遇到这个问题。Informix 上的页面大小取决于操作系统。根据我最近的经验，我发现它在 Win 2008 上是 4K，在 OSX - Lion 上是 2K，在 SUSE EL4 上是 2K。您可以使用“onstat -D”找到页面大小。

我用这个经验写了[http://sumedha.blogspot.com/2013/03/how-to-increase-informix-page-size.html 。](http://sumedha.blogspot.com/2013/03/how-to-increase-informix-page-size.html)以下来自 IBM 的文档链接也很有帮助。

[http://publib.boulder.ibm.com/infocenter/idshelp/v115/index.jsp?topic=%2Fcom.ibm.admin.doc%2Fids_admin_0564.htm](http://publib.boulder.ibm.com/infocenter/idshelp/v115/index.jsp?topic=/com.ibm.admin.doc/ids_admin_0564.htm)

# django - Apache 或 lighttpd

> ID：172164
> 
> 赞同：12
> 
> 时间：2008-10-05T15:46:40.757
> 
> 标签：django, apache, lighttpd

对于开发，我使用本地 LAMP 堆栈，对于生产，我使用[MediaTemple 的 Django Container](http://mediatemple.net/webhosting/gs/django.html)（我喜欢 BTW）。MT 的容器使用 lighthttpd。老实说，我从来没有任何其他经验。我一直使用 Apache。我一直在阅读：

*   [灯管](http://www.onlamp.com/pub/a/onlamp/2007/04/05/the-lighttpd-web-server.html)
*   [文本驱动器](http://weblog.textdrive.com/article/25/should-i-consider-lighttpd)
*   [Linux.com](http://www.linux.com/feature/51673)

以下是问题：

*   一个比另一个有什么优势？
*   在我的开发设置中使用 lighthttpd 对我有好处*吗*？
*   两者都用有什么用？Linux.com 文章讨论了在 Apache 中使用*lighttpd*。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T15:55:05.043

两者的好处：Apache 更强大且可扩展（如果您不需要这种功能，则无用，但无论如何......）并且 lighttpd 在静态内容上更快。这个想法是将您的站点拆分为静态内容（css、js、图像等）和流经 Apache 的动态代码。

我并不是说您不能单独使用 lighttpd 做很多事情。你可以，人们也可以。

如果您只在生产服务器上使用 lighttpd，我会认真考虑将其镜像到您的开发和登台服务器上，以便您在部署之前确切地知道会发生什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T01:10:50.163

对于具有来自不同 IP 地址的 n 个 http 请求的纯静态网页（.gif、.css 等）： 1\. Apache：运行 n 个进程（内存中有 mod_perl、mod_php） 2\. lighttpd：运行 1 个进程和 1 个线程（您可以在启动之前分配 m 个线程）

对于具有来自不同 IP 地址的 n 个 http 请求的纯动态网页（.php、.pl）： 1\. Apache：运行 n 个进程（内存中有 mod_perl、mod_php） 2\. lighttpd：由于异步 I/O 运行 1 个 lighttpd 进程, 并为每种脚本语言运行 m 个 fast-cgi 进程。

Lighttpd 消耗的内存要少得多。在被谷歌收购之前，YouTube 曾经是 lighttpd 的大用户。转到其主页以获取更多信息。

PS 在我以前的公司，我们将两者都与负载均衡器一起使用，以根据其 url 后缀分配 http 流量。为什么不完全lighttpd？出于遗留原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T08:08:48.463

Web 服务器和 Django 之间的接口方式可能比 Web 服务器软件的选择对性能的影响更大。例如，已知 mod_python 占用大量内存。

[此问题](https://stackoverflow.com/questions/26025/cleanest-fastest-server-setup-for-django)及其答案还讨论了其他 Web 服务器选项。

我不会担心与客户端软件的兼容性问题（请参阅[MarkR 的评论](https://stackoverflow.com/questions/172164/apache-or-lighttpd#173225)）。在使用 lighttpd 和 FastCGI 为 Django 提供服务时，我没有遇到这样的问题。我希望看到服务器和客户端软件的多样化生态系统。拥有一个好的标准比来自单一供应商的*事实上的产品要好。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T04:45:25.940

答案取决于您的项目目标。如果它将是一个正常运行时间至关重要且负载很高的大型站点，请使用 lighttpd；它的规模惊人。唯一的缺点是您最初必须更多地动手。大多数主机不支持这一点，知道你在用 lighttpd 做什么真的很值得。

如果它是你妈妈的网站，每月会有几千名访问者，那么 apache 会更好。她将能够更轻松地转移到新的主机，并且更容易找到支持。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-10-05T16:03:39.583

使用标准的 Web 服务器。50% 的网站（[Netcraft](http://news.netcraft.com/archives/2008/09/30/september_2008_web_server_survey.html)）使用 Apache，因此，如果您使用 Apache，人们的网络浏览器、蜘蛛、代理等几乎可以保证与您的网站（无论如何是其网络服务器）一起工作。

Lighthttpd 被 1.5% 的网站 ( [Netcraft](http://news.netcraft.com/archives/2008/09/30/september_2008_web_server_survey.html) ) 使用，因此人们用它来测试他们的应用程序的可能性要小得多。

任何性能差异在生产中都可能无关紧要；在您可能在生产中部署的最慢硬件上，Apache 服务器可能会以比您更高的带宽来处理静态请求。

# asp.net - 如何在 EditItemTemplate 字段的 GridView 中绑定 DropDownList？

> ID：172175
> 
> 赞同：7
> 
> 时间：2008-10-05T15:53:35.703
> 
> 标签：asp.net, data-binding, gridview

这是我在运行时绑定的gridview中的代码：

```
...
<asp:templatefield>
    <edititemtemplate>
        <asp:dropdownlist runat="server" id="ddgvOpp" />
    </edititemtemplate>
    <itemtemplate>
        <%# Eval("opponent.name") %>
    </itemtemplate>
</asp:templatefield>
... 
```

我想绑定下拉列表“ddgvOpp”，但我不知道如何。我应该，但我没有。这是我所拥有的，但我不断收到“对象引用”错误，这是有道理的：

```
protected void gvResults_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow) //skip header row
    {
        DropDownList ddOpp = (DropDownList)e.Row.Cells[5].FindControl("ddgvOpp");
        BindOpponentDD(ddOpp);
    }
} 
```

`BindOpponentDD()`填充 DropDownList 的位置在哪里。我不是在正确的事件中这样做吗？如果没有，我需要把它放在哪个？

提前非常感谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T16:27:52.950

好吧，我想我只是愚蠢。我想到了。

在 RowDataBound 事件中，只需添加以下条件：

```
if (myGridView.EditIndex == e.Row.RowIndex)
{
     //do work
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-02T16:24:21.933

感谢 Saurabh Tripathi，

您提供的解决方案对我有用。在 gridView_RowDataBound() 事件中使用。

```
if(gridView.EditIndex == e.Row.RowIndex && e.Row.RowType == DataControlRowType.DataRow)
{
    // FindControl
    // And populate it
} 
```

如果有人遇到同样的问题，那么试试这个。

干杯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-29T06:19:26.607

```
protected void grdDevelopment_RowDataBound(object sender, GridViewRowEventArgs e)
{
   if (grdDevelopment.EditIndex == e.Row.RowIndex && e.Row.RowType==DataControlRowType.DataRow) 
   {       
       DropDownList drpBuildServers = (DropDownList)e.Row.Cells[0].FindControl("ddlBuildServers"); 
   }
} 
```

试试这个

这将帮助你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-26T17:09:12.090

我遇到了同样的问题，但是这个修复（Jason's，将条件添加到处理程序）对我不起作用；编辑行从未被数据绑定，因此该条件从未评估为真。RowDataBound 根本不会使用与 GridView.EditIndex 相同的 RowIndex 调用。不过，我的设置有点不同，因为我没有以编程方式绑定下拉列表，而是将其绑定到页面上的 ObjectDataSource。但是，下拉列表仍然必须每行单独绑定，因为它的可能值取决于行中的其他信息。所以 ObjectDataSource 有一个 SessionParameter，我确保在需要绑定时设置适当的会话变量。

```
<asp:ObjectDataSource ID="objInfo" runat="server" SelectMethod="GetData" TypeName="MyTypeName">
<SelectParameters>
    <asp:SessionParameter Name="MyID" SessionField="MID" Type="Int32" />
</SelectParameters> 
```

以及相关行中的下拉菜单：

```
<asp:TemplateField HeaderText="My Info" SortExpression="MyInfo">
        <EditItemTemplate>
            <asp:DropDownList ID="ddlEditMyInfo" runat="server" DataSourceID="objInfo" DataTextField="MyInfo" DataValueField="MyInfoID" SelectedValue='<%#Bind("ID") %>' />
        </EditItemTemplate>
        <ItemTemplate>
            <span><%#Eval("MyInfo") %></span>
        </ItemTemplate>
    </asp:TemplateField> 
```

我最终做的不是在 GridView 中使用 CommandField 来生成我的编辑、删除、更新和取消按钮；我使用 TemplateField 自行完成，通过适当设置 CommandNames，我能够触发 GridView 上的内置编辑/删除/更新/取消操作。对于 Edit 按钮，我将 CommandArgument 设置为绑定下拉列表所需的信息，而不是像通常那样使用行的 PK。幸运的是，这并没有阻止 GridView 编辑相应的行。

```
<asp:TemplateField>
        <ItemTemplate>
            <asp:ImageButton ID="ibtnDelete" runat="server" ImageUrl="~/images/delete.gif" AlternateText="Delete" CommandArgument='<%#Eval("UniqueID") %>' CommandName="Delete" />
            <asp:ImageButton ID="ibtnEdit" runat="server" ImageUrl="~/images/edit.gif" AlternateText="Edit" CommandArgument='<%#Eval("MyID") %>' CommandName="Edit" />
        </ItemTemplate>
        <EditItemTemplate>
            <asp:ImageButton ID="ibtnUpdate" runat="server" ImageUrl="~/images/update.gif" AlternateText="Update" CommandArgument='<%#Eval("UniqueID") %>' CommandName="Update" />
            <asp:ImageButton ID="ibtnCancel" runat="server" ImageUrl="~/images/cancel.gif" AlternateText="Cancel" CommandName="Cancel" />
        </EditItemTemplate>
    </asp:TemplateField> 
```

在 RowCommand 处理程序中：

```
void grdOverrides_RowCommand(object sender, GridViewCommandEventArgs e)
        {
            if (e.CommandName == "Edit")
                Session["MID"] = Int32.Parse(e.CommandArgument.ToString());
        } 
```

当然，RowCommand 发生在行进入编辑模式之前，因此在下拉数据绑定之前发生。所以一切正常。这有点像黑客，但我花了足够的时间试图弄清楚为什么编辑行还没有被数据绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-04T07:35:20.007

这段代码将做你想做的事：

```
<asp:TemplateField HeaderText="garantia" SortExpression="garantia">
 <EditItemTemplate>
   <asp:DropDownList ID="ddgvOpp" runat="server" SelectedValue='<%# Bind("opponent.name") %>'>
       <asp:ListItem Text="Si"  Value="True"></asp:ListItem>
       <asp:ListItem Text="No" Value="False"></asp:ListItem>
   </asp:DropDownList>
 </EditItemTemplate>
 <ItemTemplate>
   <asp:Label ID="Label1" runat="server" Text='<%# Bind("opponent.name") %>'></asp:Label>
 </ItemTemplate> 
```

# sql-server - SQL Server 2005 中的索引 URL

> ID：172176
> 
> 赞同：3
> 
> 时间：2008-10-05T15:54:07.200
> 
> 标签：sql-server, performance

在 SQL Server 2005 中处理存储和索引 URL 的最佳方法是什么？

我有一个 WebPage 表，用于存储有关网页的元数据和内容。我还有许多其他与 WebPage 表相关的表。它们都使用 URL 作为键。

问题是 URL 可能非常大，使用它们作为键会使索引变得更大和更慢。多少我不知道，但我已经阅读了很多次使用大字段进行索引是要避免的。假设 URL 是 nvarchar(400)，它们是用作主键的巨大字段。

有哪些替代方案？

使用 URL 作为键而不是较小的字段可能会有多大的痛苦。

我查看了具有标识列的 WebPage 表，然后将其用作 WebPage 的主键。这使所有相关的索引更小更高效，但它使导入数据有点痛苦。关联表的每次导入都必须先查找 url 的 id 是什么，然后再将数据插入表中。

我也尝试过在 URL 上使用哈希来创建一个较小的索引，但我仍然不确定这是否是最好的处理方式。它不会是唯一索引，并且会受到少量冲突。所以我不确定在这种情况下会使用什么外键......

数据库中会存储数百万条关于网页的记录，并且会有大量的批量更新。此外，还会有大量活动读取和汇总数据。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T16:17:15.687

我会使用普通的身份列作为主键。你说：

> 这使所有相关的索引更小更高效，但它使导入数据有点痛苦。关联表的每次导入都必须先查找 url 的 id 是什么，然后再将数据插入表中。

是的，但痛苦可能是值得的，你在这个过程中学到的技术对于未来的项目将是无价的。

在 SQL Server 2005 上，您可以创建一个用户定义的函数 GetUrlId，它看起来像

```
CREATE FUNCTION GetUrlId (@Url nvarchar(400)) 
RETURNS int
AS BEGIN
  DECLARE @UrlId int
  SELECT @UrlId = Id FROM Url WHERE Url = @Url
  RETURN @UrlId
END 
```

这将返回 URL 表中已经存在的 URL 的 ID，对于尚未记录的任何 URL，返回 NULL。然后，您可以在您的导入语句内调用此函数 - 类似于

```
INSERT INTO 
  UrlHistory(UrlId, Visited, RemoteIp) 
VALUES 
  (dbo.GetUrlId('http://www.stackoverflow.com/'), @Visited, @RemoteIp) 
```

这可能比正确的连接语句慢，但对于一次性或偶尔的导入例程，它可能会使事情变得更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T18:15:05.917

根据您关注的位将 URL 分成几列，并使用[RFC](http://www.ietf.org/rfc/rfc1738.txt)作为指南。反转主机和域信息，以便索引可以像域一样分组（谷歌这样做）。

```
stackoverflow.com      -> com.stackoverflow  
blog.stackoverflow.com -> com.stackoverflow.blog 
```

谷歌有一篇论文概述了他们的工作，但我现在找不到。

[http://en.wikipedia.org/wiki/Uniform_Resource_Locator](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T16:00:23.927

我会坚持使用哈希解决方案。这会生成一个具有相当低碰撞机会的唯一密钥。

另一种方法是创建 GUID 并将其用作密钥。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T08:52:21.073

我完全同意迪伦的观点。使用 IDENTITY 列或 GUID 列作为 WebPage 表中的代理键。那是一个干净的解决方案。我认为在导入时查找 id 并没有那么痛苦。

使用大的 varchar 列作为键列会浪费大量空间并影响插入和查询性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T09:14:09.410

没有那么多解决办法。更多的是另一个视角。

存储页面的全部唯一 URI 可能会破坏 URI 构造的部分要点。每个正斜杠都应该指代域内的唯一语义空间（无论该空间是实际的还是逻辑的）。除非您打算存储的 URI 与 www.somedomain.com/p.aspx?id=123456789 类似，否则实际上最好将单个 URI 元表分解为代表您在站点中表示的子域的表.

例如，如果您要在与“评论”URI 相同的表中保存许多“新闻”部分 URI，那么您就错过了一个技巧，即拥有一个“部分”表，其内容包含有关该部分的元信息和其自己的 ID 充当其中所有这些 URI 的父级。

# c# - C#/.NET 词法分析器生成器

> ID：172189
> 
> 赞同：11
> 
> 时间：2008-10-05T16:04:51.407
> 
> 标签：c#, .net, parsing, generator, lexical-analysis

我正在为 C#/.NET 寻找一个不错的词法扫描器生成器——它支持 Unicode 字符类别，并生成一些可读且高效的代码。有人知道吗？

* * *

编辑：我***需要***支持**Unicode 类别**，而不仅仅是 Unicode 字符。目前仅`Lu`(Letter, Uppercase) 类别就有 1421 个字符，我需要非常具体地匹配许多不同的类别，并且宁愿不手写所需的字符集。

此外，实际代码是***必须***的——这排除了生成二进制文件然后与驱动程序一起使用的东西（即 GOLD）

* * *

编辑：ANTLR 还不支持 Unicode 类别。不过，它有一个[未解决](http://www.antlr.org/wiki/display/ANTLR3/define+unicode+aliases+for+character+categories)的问题，所以有一天它可能会满足我的需求。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-05T17:00:46.037

GPLEX 似乎支持您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T16:10:10.427

想到的两个解决方案是[ANTLR](http://www.antlr.org)和[Gold](http://www.devincook.com/goldparser/)。[ANTLR 有一个基于 GUI 的语法设计器，在这里可以找到](http://www.codeproject.com/KB/recipes/sota_expression_evaluator.aspx)一个优秀的 C# 示例项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T17:01:26.517

我同意@David Robbins，ANTLR 可能是你最好的选择。但是，生成的 ANTLR 代码确实需要一个单独的运行时库才能使用生成的代码，因为生成的代码依赖于一些字符串解析和其他库共性。ANTLR 生成一个词法分析器和一个解析器。

附带说明：ANTLR 很棒……我编写了一个 400 多行的语法来生成超过 10k 或 C# 代码来有效地解析一种语言。这包括内置的错误检查，以检查语言解析中可能出错的每一个可能的事情。尝试手动执行此操作，您将永远跟不上错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-10T23:41:32.877

我刚发现这个

[http://www.seclab.tuwien.ac.at/projects/cuplex/lex.htm](http://www.seclab.tuwien.ac.at/projects/cuplex/lex.htm)

它说它的可配置性足以支持 unicode ;-)。

赫伯

# html - 如何将 POST 请求的结果显示为图像？

> ID：172192
> 
> 赞同：0
> 
> 时间：2008-10-05T16:07:15.800
> 
> 标签：html, ajax, image, post, get

我正在开发一个使用动态创建的图像来显示信息的网络应用程序。此数据当前使用 GET 查询字符串发送到图像，但对于更复杂的图像和数据，我担心会遇到 url 字符限制问题。

我可以简单地将记录 ID 传递给图像并让这个查询数据库，但这显然会增加对服务器的需求。有什么方法可以将使用 POST 检索到的图像添加到 HTML 文档中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T16:27:06.027

最后，我认为查询数据库可能会更快。从数据库中获取一个小字符串（比如最多 2000 个字符）非常快，并且可能比让用户一直发布它更快，尤其是当页面上超过 1 个时。

最好的选择是创建一次图像并在它不改变时将其缓存。当再次请求图像时，检查它是否被缓存并使用 readfile() 将其发送到浏览器。我喜欢将缓存的图像存储在文档根目录之外，因此其他人无法访问它，但这可能不是您正在做的事情（缓存和隐私）的一个因素。

SESSION 可能是一个选项，但是当您需要在多个页面上重新生成图像并进行细微更改时，这是最佳选择，因此您不必每次都查询数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T16:38:34.973

不容易 - HTML 不包含任何对发送多个 POST 请求并将结果呈现为内联资源的内在支持，就像 <img /> <script /> 和其他定义 SRC 属性的标签一样。

即使是 AJAX 变通方法也可能对您没有帮助。更改图像的 SRC 属性很容易，但所做的只是使浏览器获取新图像（从缓存或服务器，取决于您的配置）。实际上，将图像的**内容**从 HTTP POST 更改为二进制响应要复杂得多——尽管您可以查看对响应流进行 base64 编码并使用 data: URL 方案在页面中显示结果图像。

当然，您始终可以将“单击以查看图像”作为提交按钮的表单 - 您提交表单，服务器以图像/jpeg 数据响应，您的浏览器将其显示为独立图像。不过，我很确定你不能内联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T16:38:48.747

一种选择是将此数据存储在会话变量中。您应该做一些测试，看看您的服务器以哪种方式更好地处理它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T17:03:54.687

扩展 Darryl Hein 的评论：

> > 有了这个，我建议您在完成后将其从 SESSION 中删除。如果它一直在那里，PHP 将在每次页面调用时加载它，而不仅仅是图像“页面”。——达里尔·海因

是的，我考虑过这一点并同意，您不想用不需要的会话数据堵塞管道，但是如果您不知道何时删除数据怎么办？不能只删除图片创建后的会话数据，如果图片要显示两次怎么办？除非图像本身被缓存了一段时间。

像这样的东西

请求页面

```
<? //index.php
    $_SESSION['imagedata']['header'] = array('name'=>'Simon','backgroundcolor'=>'red');
    echo '<img src="image.php?image=header">';
    // more stuff
    echo '<img src="image.php?image=header">'; // same image
?> 
```

图像脚本

```
<?  //image.php
    switch($_GET['image']){
        case 'header':
            if(isSet($_SESSION['imagedata']['header'])){
                // create image using $_SESSION['imagedata']['header'] data
                // create cached image
                unset($_SESSION['imagedata']['header']);
            else if(cache_file_exists()){
                // display cached file
            }else{
                // no data, use plan B
            }
        break;
    }
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T18:09:02.810

如果图像可以通过 id 识别，请使用它。假设相同的 id 每次都应该生成相同的图像，只需使用一些代理使用标准 HTTP 缓存支持来提供图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T08:35:38.130

在某些情况下并在某些限制下，您可以使用 iframe，您希望您的图像出现并使用指向该 iframe 的目标属性发布。

所以主页有一个iframe。主页有一个发布 I 框架的表单，服务器返回一个显示在 iframe 中的图像。

# c++ - 套接字错误的好资源？

> ID：172199
> 
> 赞同：2
> 
> 时间：2008-10-05T16:12:52.623
> 
> 标签：c++, c, sockets

在哪里可以找到所有类型的 bsd 样式套接字错误的列表？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-05T16:53:48.467

在文档中？例如，对于 connect()，请参见：

```
% man connect
...
  ECONNREFUSED
          No-one listening on the remote address.
  EISCONN
          The socket is already connected.

  ENETUNREACH
          Network is unreachable. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T16:25:41.830

[您还可以在 Open Group 的页面上找到每个功能（例如connect](http://www.opengroup.org/onlinepubs/009695399/functions/connect.html)）的错误代码列表（及其含义的一般描述）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T17:06:19.970

如果您想知道所有可能的 errno 或对它们的一些评论，您可以查看头文件，在 Linux 系统上位于

*   /usr/include/asm-generic/errno-base.h

```
#ifndef _ASM_GENERIC_ERRNO_BASE_H
#define _ASM_GENERIC_ERRNO_BASE_H

#define EPERM 1 /* 不允许操作 */
#define ENOENT 2 /* 没有这样的文件或目录 */
#define ESRCH 3 /* 没有这样的进程 */
#define EINTR 4 /* 中断的系统调用 */
#define EIO 5 /* I/O 错误 */
#define ENXIO 6 /* 没有这样的设备或地址 */
#define E2BIG 7 /* 参数列表太长 */
#define ENOEXEC 8 /* 执行格式错误 */
#define EBADF 9 /* 错误的文件号 */
#define ECHILD 10 /* 没有子进程 */
#define EAGAIN 11 /* 再试一次 */
...

```

*   /usr/include/asm-generic/errno.h

```
#ifndef _ASM_GENERIC_ERRNO_H
#define _ASM_GENERIC_ERRNO_H

＃包括

#define EDEADLK 35 /* 会发生资源死锁 */
#define ENAMETOOLONG 36 /* 文件名太长 */
#define ENOLCK 37 /* 没有可用的记录锁 */
#define ENOSYS 38 /* 功能未实现 */
#define ENOTEMPTY 39 /* 目录不为空 */
#define ELOOP 40 /* 遇到太多符号链接 */
#define EWOULDBLOCK EAGAIN /* 操作会阻塞 */
...

```

如果你想知道什么 errno 调用，例如 socket() 或 connect() 可以返回，安装开发手册页并尝试 man socket 或 man connect

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T08:02:25.933

许多函数会设置`errno`失败，而不是通过`errno.h`你自己并将错误号转换为字符串，你最好调用[`perror`](http://www.rt.com/man/perror.3.html).

`perror`将使用可选前缀打印当前`errno`的相应消息。`stderr`

示例用法：

```
if (connect())
{
    perror("connect() failed in function foo");
    ...
} 
```

`perror`有朋友打电话给他们`strerror`，`strerror_r`如果您想捕获字符串以用于`stderr`.

# .net - 为什么 System.Net.Mail 在 System.Web.Mail 工作的地方失败

> ID：172203
> 
> 赞同：6
> 
> 时间：2008-10-05T16:16:08.763
> 
> 标签：.net, asp.net, email, smtp

我可以让 System.Net.Mail 和 System.Web.Mail 都与 GMail 一起使用，但我无法让它们都与 smtp.att.yahoo.com 一起使用。

我从自己的 Web.config 键中获取 SMTP 设置。这些设置在我使用 System.Web.Mail 发送时有效，但在 System.Net.Mail 中失败。

```
 <add key="SmtpServer" value="smtp.att.yahoo.com"/>
    <add key="SmtpServerAuthenticateUser" value="ctrager@sbcglobal.net"/>
    <add key="SmtpServerPort" value="465"/>
    <add key="SmtpUseSSL" value="1"/>
    <add key="SmtpServerAuthenticatePassword" value="MY PASSWORD"/> 
```

这是获取我的设置并与 GMail 一起使用的代码，但由于 att.yahoo 失败：

```
 SmtpClient smtp;

        if (!string.IsNullOrEmpty(Util.get_setting("SmtpServer", "")))
        {
           smtp = new SmtpClient(Util.get_setting("SmtpServer", ""));
        }
        else
        {
           smtp = new SmtpClient();
        }

        if (!string.IsNullOrEmpty(Util.get_setting("SmtpServerAuthenticatePassword", "")))
           smtp.Credentials = new System.Net.NetworkCredential(
               Util.get_setting("SmtpServerAuthenticateUser", ""), 
               Util.get_setting("SmtpServerAuthenticatePassword", ""));

        if (!string.IsNullOrEmpty(Util.get_setting("SmtpServerPort", "")))
           smtp.Port = int.Parse(Util.get_setting("SmtpServerPort", ""));

        if (Util.get_setting("SmtpUseSSL", "0") == "1")
           smtp.EnableSsl = true;

        smtp.Send(message); 
```

这是我的问题吗？

[http://blogs.msdn.com/webdav_101/archive/2008/06/02/system-net-mail-with-ssl-to-authenticate-against-port-465.aspx](http://blogs.msdn.com/webdav_101/archive/2008/06/02/system-net-mail-with-ssl-to-authenticate-against-port-465.aspx)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T00:43:23.200

我已经学会了答案。答案是：

因为 System.Net.Mail 不支持“隐式”SSL，只支持“显式”SSL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-03T12:39:28.113

先前关于通过 System.Net.Mail 的隐式和显式 SSL 连接的答案是绝对正确的。我能够克服这个障碍并且不必使用现在已经过时的 System.Web.Mail 的方法是使用 CDO（协作数据对象）。

如果好奇，我在另一个堆栈溢出帖子（ [GMail SMTP via C# .Net error on all ports](https://stackoverflow.com/questions/1082216/gmail-smtp-via-c-net-errors-on-all-ports/3845907#3845907) ）上详细并给出了一个示例。否则，您可以直接转到[http://support.microsoft.com/kb/310212](http://support.microsoft.com/kb/310212)上的知识库文章。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-10T07:03:54.410

Gimel 的回答是从头到尾。他说使用新系统。**Net** .Mail 库，但问题是系统。**Net** .Mail 不适用于 465 端口上的 SSL，如 System。**Web** .Mail 确实/确实有效！

我整天都在为此而努力，并且为了相同的设置系统。**Web** .Mail WORKS 和系统。**Net** .Mail 不起作用（至少对于我一直在测试的 SMTP 服务器而言），在这里我想我应该始终升级到 Microsoft 的最新产品，以获得最好的生活。:-(

M$ 博客的链接似乎说明了一切；“System.Net.Mail 仅支持“显式 SSL”。” 我假设我一直在测试的 SMTP 服务器需要隐式 SSL。（顺便说一句，这是一个雅虎服务器）。

由于“升级”到新 API 无疑会破坏具有需要隐式 SSL 的服务器的用户的功能，因此在这种情况下“升级”似乎是一种倒退。如果您仍然可以仅使用警告进行编译，只需禁用这些警告（如果我记得是 0618）并继续卡车运输。哦，您可能需要考虑确保您的应用程序始终通过配置文件在您构建和测试的 .NET 框架版本上运行，这样将来如果 M$ 淘汰旧 API，您的应用程序是安全的。

# java - 是否应该将 Tapestry 5 用于生产版本？

> ID：172208
> 
> 赞同：6
> 
> 时间：2008-10-05T16:19:42.873
> 
> 标签：java, tapestry

我们正在启动一个大型网络项目，主要是绿色领域。我喜欢用于 java/web 解决方案的 Tapestry 框架。我担心启动 Tapestry 5 项目，因为 T5 仍处于测试阶段。但是，如果我正确理解文档，T5 及更高版本将不支持 T4 开发。我的问题：我应该用 T5 为一家大公司开始一个大型项目吗？如果没有，随着即将发布的 T5，我应该完全忽略 T4 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-16T17:14:18.960

This question is moot now; Tapestry 5.0.18 was released on Dec.12 and it's the stable production-ready release, so nobody has to worry about using Tap5 before production anymore... just upgrade from whatever 5.0.x you're using to 5.0.18.

**WARNING:** If you're still using 5.0.15 then maybe you will have to modify some stuff around. I had 2 problems upgrading from 5.0.15 to 5.0.17: one is that any fields marked as `@Property` must not have any accessors; if you have an accessor for a `@Property` field you must remove the @Property tag and implement both accessors if you need them. The other one was that the page classes are no longer packed in their own jar file (this only applies to newly created projects), so if you need your pages to be in their own jar file (for whatever reason), you must modify your pom.xml to add the `archiveClasses` to the maven-war-plugin plugin.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-05T16:41:14.750

T5 处于最后一个 beta 版本，下一个版本是 RC，然后是完整版本。按照霍华德的说法，事情应该在 10 月底之前完成。因此，如果您正在启动该项目，我相信该框架会在发布时吸引您。

另一件事，测试版是非常优质的产品，霍华德在他的框架上做得很好。在我现在以前的公司，有一个基于 Tapestry 5 的项目于 9 月开始，一位同事很快就获得了一个工作示例，看起来还不错。我们在之前的项目中使用了 Tapestry 4，当提出选择哪个版本、T4 将被 T5 取代以及框架概念本身发生很大变化的问题时，得出的结论是对于一个Tapestry 新开发人员立即学习新版本（另外，如果我要留下来，我也有兴趣尽快切换到 T5，因为与我使用的 T4 相比，我看到 T5 概念的质量改进）。

当然，您必须考虑到最后期限和项目限制。如果它是相当灵活或持久的项目，也许可以快速启动 T5 一周，然后根据您的经验决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-23T08:00:33.437

在使用 Tapestry 之前，你应该好好看看 Tapestry 的发展历史。Tapestry 做了很多不兼容的升级，没有继续支持旧版本。在合理的时间范围内不再处理 4.1 的补丁。在我看来，这对于官方稳定版本是不可接受的。

承诺使用 Tapestry 5 意味着：

*   你应该成为一名提交者；
*   你需要跟上所有新的发展，尽快放弃旧版本；
*   自己维护稳定版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T10:38:16.673

Tapestry 5 很糟糕。生产力直线下降，内存泄漏。它对 GC 中的堆大小和较旧的对象代进行了非常糟糕的分析。由于在任何地方都使用会话，因此它不适用于大量用户。它的记录非常糟糕，很少有提交者支持。代码库质量非常低，具有非标准外观代码。我会像避免瘟疫一样避免它。我在一个非常引人注目的项目上使用它工作了 6 个月，该项目最终以数百万英镑的代价被罐装。T5 对此不负任何责任，但可以通过将开发人员的生产力降至零来发挥作用。

有了 wicket 和 grails 以及 Spring MVC 和 Struts2，你到底为什么要在这个同样运行的框架上冒险呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T13:12:01.877

I don't think I can recommend a beta solution to a high profile app like this, but I'm also leaning against T4 because the upgrade path will be slammed shut upon the release of T5\. Do you agree?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T13:25:52.740

我目前在一个即将推出测试版的项目中使用 T5，这与我们的意图不完全一致——我们认为第一个版本现在已经发布了。恕我直言，T5 是稳定和成熟的，除了一些粗糙的边缘和一个相当小的社区。

如果您只是入门，我不会费心使用 T4。我发现 T5 使用起来非常优雅和有趣，所以如果你在计划发布之前还有一些时间，那就去吧！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-05T18:48:35.287

正如 zappan 所说，如果您的项目交付（LIVE/RELEASE）日期提前几个月，您应该考虑 T5。特别是因为 T5 还没有发布 - 这导致期望不会有太多人有过它的经验。

再说一次，如果您的项目不是关键任务并且可能会延迟到 LIVE 日期，它不应该受到伤害。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T00:26:56.323

通读 Tapestry 用户邮件列表，仍然出现许多粗糙的地方。运行演示时，T5 令人印象深刻，但我会等待一段时间再考虑将其用于生产。 [http://www.nabble.com/Tapestry---User-f340.html](http://www.nabble.com/Tapestry---User-f340.html)

# svn - 是否有可能让 perforce 表现得像颠覆一样？

> ID：172209
> 
> 赞同：3
> 
> 时间：2008-10-05T16:19:52.827
> 
> 标签：svn, version-control, perforce

可以调整 perforce 以便我不需要“打开文件进行编辑”吗？有人告诉我这是一个“功能”，他/她猜想它可以被关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T22:26:09.483

尽管这不是对您要求的直接回答，但我可以分享一个小技巧。

在我的编辑器 (SciTE) 中，我可以定义键盘快捷键，将宏扩展到当前编辑文件的路径，运行应用程序。如果您最喜欢的编辑器可以做到这一点，您可以调整这个技巧。

```
command.name.0.*=P4 edit
command.0.*=p4 edit -c default $(FileNameExt)
command.save.before.0.*=2 
```

您也可以将“默认”更改为您当前的更改列表编号。

当然，如果您的编辑器/IDE 支持 Perforce，那就更好了……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T18:40:12.497

请参阅[http://www.perforce.com/perforce/doc.081/manuals/p4guide/02_config.html](http://www.perforce.com/perforce/doc.081/manuals/p4guide/02_config.html)（**配置工作区选项**部分）。您可以设置该`allwrite`选项，但即便如此，您也必须进行离线同步或检查所有文件并执行`p4 revert -a`（还原未更改的文件）以找出您更改了哪些文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T16:29:02.357

您可以使用的一种方法是编辑同步分支上的只读文件。当您准备好提交时，请使用“检查一致性”文件 | 更多选项可根据修改后的文件创建更改列表。可能有一种命令行方式可以做到这一点，但我不知道它是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T17:02:55.703

根据[Perforce 上的 Wikipedia 页面](http://en.wikipedia.org/wiki/Perforce#Concurrency_model)，他们希望您“打开文件进行编辑”，以便服务器可以维护预期会更改的文件列表。如果您想在不这样做的情况下编辑文件，则必须手动将本地副本从只读更改为读写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-19T11:13:35.403

我会拒绝试图与你推理你为什么要这样做。执行此操作的简单方法可能如下。

查看您感兴趣的整个目录树，例如

> //仓库/项目/MyProj/...

您所有的文件现在都是可写的并且处于编辑（或签出）模式。当您选择提交更改时，只需执行以下两项操作之一。右键单击挂起的更改列表并选择还原未更改的文件以在提交之前删除未更改的文件，或者在提交时选择提交时下的“不提交未更改的文件”选项。这具有仅提交您已更改的文件的效果。

如果您还选中“提交后检查提交的文件”旁边的框，它甚至会重新打开这些文件，以便您可以继续工作，直到下次提交。

这基本上就是您要寻找的。

# sqlite - 硬件相关磁盘或内存损坏的可能性？

> ID：172219
> 
> 赞同：3
> 
> 时间：2008-10-05T16:27:12.000
> 
> 标签：sqlite, hardware, corruption

我有几百台计算机运行一个应用程序。在一台计算机上，我看到在我从 SQLite 中提取的某些字符串上错误地设置了单个位的两个实例。如果这是我的开发计算机，我会假设我在某处有错误，但肯定有一些安装，此时我将开始看到罕见的基于硬件的错误。

这当然取决于我做了多少 IO，但是当有机会看到这种事情时，是否有任何经验法则？例如，对于 TCP 数据包，[本文](http://portal.acm.org/citation.cfm?doid=347059.347561)确定“1600 万到 100 亿个数据包中大约有 1 个”会发生无声的、未被检测到的损坏。

不幸的是，不太可能在有问题的机器上运行内存/磁盘检查器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T16:44:24.430

当我注意到奇怪的事情发生时，我的策略是：

1.  **检查代码中**是否存在错误
***   检查使用的库/工具中是否存在错误（SQLite，此处）*   **检查编译器中**是否存在错误***   然后，仅在那时，检查硬件故障****

 ****在我长达 10 年的职业生涯中，99.99% 的错误与软件相关。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T16:48:25.250

会发生位错误。考虑使用 CRC 或其他类型的错误检测/纠正机制来保护您的数据。它发生的几率取决于你拥有什么样的硬件。如果您有带有 ECC 的内存，那么它比没有的可能性要小，但即使是 ECC 内存也会变坏并且可能无法纠正错误。对于数百台计算机，我会说奇怪的硬件错误很可能，很可能每天都会发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-27T00:00:34.673

[“维基百科：ECC 内存”](http://en.wikipedia.org/wiki/ECC_memory) 说“最近的 DRAM 测试给出了差异很大的错误率，差异超过 7 个数量级，范围从 10^-10 到 10^-17 错误/bit·h，大约一个位错误，每小时，每GB 内存到一个位错误，每世纪，每 GB 内存。[7][11][12]"

即使我们使用每千兆字节每世纪一个位错误的最乐观估计，如果您有一个由 100 台计算机组成的集群，每台计算机具有 2 GB 的 RAM，这意味着您每年会看到两次位错误。（这仅包括 RAM 位错误。您提到了 TCP 数据包未检测到损坏，您还可能考虑磁盘驱动器故障、电源线意外拔出、冷却风扇故障等）。更悲观的估计意味着您会更频繁地看到误码——正如史蒂夫贝克所说，误码是不可避免的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T16:47:54.063

有细微的错误，它可能随时发生，并且来自多个来源，即使是[最不可能](http://www.newscientist.com/blog/technology/2008/03/do-we-need-cosmic-ray-alerts-for.html)的。

正如您可以看到在单台机器上发生的错误，您最好的选择是处理损坏，而不是依靠统计数据来告诉您何时可能出现问题。虽然错误可能是由于外部因素造成的，但如果您看到不止一个错误，最好让该 memchecker 在机器上运行以检查其硬件没有故障。另一种选择是相信运气，你不会看到完全失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-10T11:35:11.333

把那台机器关掉。在我目前的职位（约 7 年）中，我曾经见过一次由硬件内存错误引起的蓝屏。如果您在同一台机器上看到两次位错误故障，那么您很有可能找到了罪魁祸首。在同一时间段内，我看到了数十个磁盘控制器故障/磁盘故障/注册表损坏蓝屏。所以它们很少见，但确实会发生。

在网络方面，我们有一个案例，3d 方供应商的 WAN 压缩设备错误地将我们的应用程序 TCP 数据包压缩在一起，然后对其进行了良好的 CRC。至少可以说，这造成了严重破坏。

# cookies - 如何在 Safari 中的 iframe 内设置来自外部域的 cookie？

> ID：172223
> 
> 赞同：22
> 
> 时间：2008-10-05T16:28:52.900
> 
> 标签：cookies, iframe, safari

来自 Apple[开发人员常见问题解答](http://developer.apple.com/internet/safari/faq.html)

> Safari 附带了一个保守的 cookie 策略，该策略将 cookie 写入仅限于用户选择（“导航到”）的页面。

默认情况下，Safari 仅允许来自您直接导航到的站点的 cookie。（即，如果您单击带有该域名 url 的链接）。

这意味着，如果您使用 iFrame 从您自己的站点加载一个页面，该页面来自另一个站点的页面，则另一个站点无法设置 cookie。（例如，售票处）。一旦您直接访问了其他域，其他站点就能够访问和更改其自己的 cookie。

如果无法访问其他站点上的代码，我如何才能使用户体验尽可能不显眼？

是否有（javascript？）方法来检查是否已设置其他站点的 cookie，并相应地，如果需要，首先显示指向其他站点的直接链接？

更新：

HTML5 功能“window.postmessage”似乎是一个不错的解决方案。
有一些 jQuery 库可能会有所帮助，并且与最新的浏览器兼容。
本质上，iFrame 文档使用 Json 通过 window 元素发送消息。

非常好的[Postmessage-plugin](http://postmessage.freebaseapps.com)，由 daepark 提供，我开始工作了。
和另一个[jQuery postMessage](http://benalman.com/projects/jquery-postmessage-plugin/)，我发现了 Ben Alman，但尚未测试。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-03-05T02:07:31.870

safari 和所有现代浏览器都支持 localStorage，即使在加载到 iframe 中的页面上也允许读/写操作。如果您不介意放弃对 ie6 和 ie7 的支持，请尝试在框架站点中使用 localStorage 而不是 cookie。我知道您的问题明确表示您无法访问框架站点上的代码，但对于那些这样做的人来说，localStorage 绝对解决了“safari iframe 中没有 cookie”的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-23T14:00:41.343

这是一个称为同源策略的问题。从本质上讲，它是一种防止制造安全漏洞的安全措施。

当您的 iframe 指向您自己域中的页面时，JavaScript 可以访问您所在的页面和 iframe 中的页面。这是可接受的父母对孩子和孩子对父母的关系。

```
 (parent doc)        (iframe doc)
    HTML --> IFRAME <-- HTML 
      ^--------|---------^ 
```

但是，一旦您有一个指向外部页面的文件，SOP 就会发挥作用，并拖曳在父页面和 iframe 页面之间传递的任何信息。

```
 (parent doc)        (iframe doc)
    HTML --> IFRAME <-- HTML 
               X 
```

查看这篇关于 iframe 通信的帖子，这很有意义！ [Stackoverflow 帖子](https://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content)

这些链接也真的很有帮助！

**1)** [浏览器中的安全跨域通信](http://msdn.microsoft.com/en-us/library/bb735305.aspx)
**2)** [wiki SOP 或同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-12T16:18:48.453

[此页面](http://saizai.livejournal.com/897522.html)建议您在页面中放置一些 javascript，以检测是否缺少始终存在的 cookie。当它发现 cookie 尚未设置时，它会将所需的会话数据发布到设置 cookie 的页面，并将您重定向回原始页面。

显然 POST 足以满足 Safari 的“我是否导航到此域”测试，因此从那时起它接受来自该域的 cookie。

当然，这不是最好的代码，但可以很好地解决您的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-23T01:09:17.723

这是 Safari 中显示的 Facebook 应用程序的常见问题。许多人（包括我自己）处理这个问题的方式是让 iframed 页面 POST 到自己。当页面发布了表单数据时，就可以设置 cookie。最后，它适用于 1 页面刷新，甚至可以是您的用户登录 POST。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-17T13:58:23.973

一种解决方案（有点混乱）可能是让父页面检查 cookie 的存在，如果 cookie 不存在，则对 iframe 页面域上设置 cookie 的脚本运行 AJAX 调用。

# sql - Informix 列的最大长度是多少，可以增加吗？

> ID：172227
> 
> 赞同：3
> 
> 时间：2008-10-05T16:30:11.883
> 
> 标签：sql, database, informix

我正在尝试使用以下内容创建表：

```
CREATE TABLE GTW_WORKFLOW_MON 
(
    WORKFLOW_NAME VARCHAR(255) NOT NULL, 
    WORKFLOW_LOADED NUMERIC(20) NOT NULL, 
    ACTIVITY_NAME VARCHAR(255) NOT NULL,
    FLAGS INTEGER NOT NULL,
    MONITOR_NAME VARCHAR(255) NOT NULL,
    CLASSNAME VARCHAR(255) NOT NULL,
    STR0 VARCHAR(255),
    STR1 VARCHAR(255),
    STR2 VARCHAR(255), 
    NUM0 VARCHAR(255), 
    NUM1 VARCHAR(255), 
    NUM2 VARCHAR(255), 
    DATE0 VARCHAR(255),
    DATE1 VARCHAR(255), 
    DATE2 VARCHAR(255), 
    PRIMARY KEY (WORKFLOW_NAME, WORKFLOW_LOADED, ACTIVITY_NAME, MONITOR_NAME)
) 
```

由于列长度不够大而失败。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T18:26:44.470

如果 SQL 语句在语法上有效并且您提供了确切的错误消息，这将有所帮助。重新格式化并更正语法后，语句如下所示：

```
CREATE TABLE gtw_workflow_mon
(
    workflow_name   VARCHAR(255) NOT NULL,
    workflow_loaded NUMERIC(20) NOT NULL,
    activity_name   VARCHAR(255) NOT NULL,
    flags           INTEGER NOT NULL,
    monitor_name    VARCHAR(255) NOT NULL,
    classname       VARCHAR(255) NOT NULL,
    str0            VARCHAR(255),
    str1            VARCHAR(255),
    str2            VARCHAR(255),
    num0            VARCHAR(255),
    num1            VARCHAR(255),
    num2            VARCHAR(255),
    date0           VARCHAR(255),
    date1           VARCHAR(255),
    date2           VARCHAR(255),
    PRIMARY KEY(workflow_name, workflow_loaded, activity_name, monitor_name)
); 
```

而且，当它在具有 2KB 页面的系统上运行时，错误消息是：

```
SQL -550: Total length of columns in constraint is too long. 
```

获取错误消息简要说明的标准方法是`finderr`；它说：

```
$ finderr -550
-550    Total length of columns in constraint is too long.

The total size of all the columns listed in a UNIQUE, PRIMARY KEY, or
FOREIGN KEY clause is limited. The limit depends on the database server
in use, but all servers support a total of 120 bytes. The limit is the
same as the restriction on the total size of all columns in a composite
index. For additional information, see the CREATE TABLE statement in
the IBM Informix Guide to SQL: Syntax.

$ 
```

“总共120个字节”应该是“总共至少120个字节”；该下限适用于 Informix SE。在 IDS（Informix Dynamic Server）中，下限为 255 字节，但在较新的系统中更大，并且在页面大小更大时也更大。

您有多种选择。

*   你可以考虑一下为什么你的名字每个都需要 255 个字符——这合理吗（比如说，64 个就足够了）？
*   如果您的服务器版本足够新（我相信 10.00 或更高版本），您可以在具有更大页面大小的 dbspace 中创建表。

由于密钥最大为 3*255+(20/2+1) = 776 字节，经验法则是您需要能够存储 5 个最大长度的密钥值 + ROWID/FRAGID 开销（8 字节）每页，您需要 4 KB 的页面大小。（如果您一直在 AIX 上运行，您可能不会注意到这个问题。）

此外，您不应将日期值存储在 VARCHAR(255) 中；你应该使用 DATE 或者可能是 DATETIME YEAR TO DAY（一种奇怪的 DATE 拼写方式 - 尽管底层格式不同，在磁盘上使用 5 个字节而不是 4 个字节来表示普通 DATE），或者可能是 DATETIME YEAR TO SECOND（一种有趣的方式拼写 TIMESTAMP)，或者... 'num0, num1, num2' 字段也很可疑；如果它们旨在存储数字，请使用 NUMERIC 或 DECIMAL -- DECIMAL(20) 在大多数 IDS 数据库中表示 20 位浮点十进制数。

*编辑添加：*

而且，要回答直接问题，VARCHAR 列最多只能有 255 个字节长；LVARCHAR 列最多可达 32 KB；CHAR 列最大为 32 KB；TEXT 列可以达到 2 GB，CLOB 列可以更大。一行的总长度被限制在大约 32 KB（但 BYTE、TEXT、BLOB 和 CLOB 列算作一个固定大小的描述符，总共 32 KB - 实际数据存储在行之外）。有一些版本依赖我没有提出——如果您使用的是 IDS 10.00 或更高版本，这是准确的。

# iphone - 如何以编程方式缩放 UIScrollView？

> ID：172255
> 
> 赞同：28
> 
> 时间：2008-10-05T16:47:04.673
> 
> 标签：iphone, cocoa-touch

我想以基类不支持的方式缩放和取消缩放。

例如，在收到双击时。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-07T14:27:17.217

在玩弄东西并让它工作之后，我正在回答我自己的问题。

Apple 在其关于如何处理双击的文档中提供了一个非常简单的示例。

进行程序化缩放的基本方法是自己做，然后告诉 UIScrollView 你做了。

*   调整内部视图的框架和边界。
*   将内部视图标记为需要显示。
*   告诉 UIScrollView 新的内容大小。
*   计算缩放后应显示的内部视图部分，并将 UIScrollView 平移到该位置。

另一个关键：一旦你告诉 UIScrollView 你的新内容大小，它似乎会重置其当前缩放级别的概念。您现在处于新的 1.0 缩放系数。因此，您几乎肯定会想要重置最小和最大缩放系数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-10-07T14:32:05.043

停止重新发明轮子！看看苹果是怎么做到的！

[ScrollViewSuite -> Apple 文档页面](http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Introduction/Intro.html)

[ScrollViewSuite 直接链接 -> XcodeProject](http://developer.apple.com/library/ios/samplecode/ScrollViewSuite/ScrollViewSuite.zip)

这正是您正在寻找的。

干杯!

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-07T21:16:01.057

注意：这是非常过时的。它大约从 iOS 2.x 时代开始，实际上已经在 iOS 3.x 左右得到修复。

仅出于历史目的将其保留在这里。

* * *

我想我找到了一个干净的解决方案，我制作了一个 UIScrollView 子类来封装它。

说明编程缩放（+双击处理）和照片库样式的分页+缩放+滚动以及 ZoomScrollView 类的示例代码可在[github.com/andreyvit/ScrollingMadness 获得](http://github.com/andreyvit/ScrollingMadness/)。

简而言之，我的解决方案是从 中返回一个新的虚拟视图`viewForZoomingInScrollView:`，暂时将您的内容视图（UIImageView 等）作为其子视图。在`scrollViewDidEndZooming:`我们相反的情况下，处理虚拟视图并将您的内容视图移回滚动视图。

为什么有帮助？这是一种击败我们无法以编程方式更改的持久视图比例的方法。UIScrollView 本身不保留当前视图比例。相反，每个 UIView 都能够保持其当前视图比例（在 _gestureInfo 字段指向的 UIGestureInfo 对象内）。通过为每个缩放操作提供一个新的 UIView，我们总是从缩放比例 1.00 开始。

这有什么*帮助*？我们自己存储当前缩放比例，并手动将其应用于我们的内容视图，例如`contentView.transform = CGAffineTransformMakeScale(zoomScale, zoomScale)`. 然而，这与 UIScrollView 希望在用户捏住视图时重置转换相冲突。通过给 UIScrollView 另一个带有标识变换的视图来缩放，我们不再为变换同一个视图而战。UIScrollView 可以愉快地相信它每次都以缩放 1.00 开始，并以标识变换开始缩放视图，并且它的内部视图应用了与我们当前实际缩放比例相对应的变换。

现在，ZoomScrollView 封装了所有这些东西。为了完整起见，这里是它的代码，但是我真的建议从 GitHub 下载示例项目（你不需要使用 Git，那里有一个下载按钮）。如果你想收到有关示例代码更新的通知（你应该——我计划维护和更新这个类！），要么关注 GitHub 上的项目，要么给我发电子邮件至 andreyvit@gmail.com。

界面：

```
/*
 ZoomScrollView makes UIScrollView easier to use:

 - ZoomScrollView is a drop-in replacement subclass of UIScrollView

 - ZoomScrollView adds programmatic zooming
   (see `setZoomScale:centeredAt:animated:`)

 - ZoomScrollView allows you to get the current zoom scale
   (see `zoomScale` property)

 - ZoomScrollView handles double-tap zooming for you
   (see `zoomInOnDoubleTap`, `zoomOutOnDoubleTap`)

 - ZoomScrollView forwards touch events to its delegate, allowing to handle
   custom gestures easily (triple-tap? two-finger scrolling?)

 Drop-in replacement:

 You can replace `[UIScrollView alloc]` with `[ZoomScrollView alloc]` or change
 class in Interface Builder, and everything should continue to work. The only
 catch is that you should not *read* the 'delegate' property; to get your delegate,
 please use zoomScrollViewDelegate property instead. (You can set the delegate
 via either of these properties, but reading 'delegate' does not work.)

 Zoom scale:

 Reading zoomScale property returns the scale of the last scaling operation.
 If your viewForZoomingInScrollView can return different views over time,
 please keep in mind that any view you return is instantly scaled to zoomScale.

 Delegate:

 The delegate accepted by ZoomScrollView is a regular UIScrollViewDelegate,
 however additional methods from `NSObject(ZoomScrollViewDelegateMethods)` category
 will be called on your delegate if defined.

 Method `scrollViewDidEndZooming:withView:atScale:` is called after any 'bounce'
 animations really finish. UIScrollView often calls it earlier, violating
 the documented contract of UIScrollViewDelegate.

 Instead of reading 'delegate' property (which currently returns the scroll
 view itself), you should read 'zoomScrollViewDelegate' property which
 correctly returns your delegate. Setting works with either of them (so you
 can still set your delegate in the Interface Builder).

 */

@interface ZoomScrollView : UIScrollView {
@private
    BOOL _zoomInOnDoubleTap;
    BOOL _zoomOutOnDoubleTap;
    BOOL _zoomingDidEnd;
    BOOL _ignoreSubsequentTouches;                                // after one of delegate touch methods returns YES, subsequent touch events are not forwarded to UIScrollView
    float _zoomScale;
    float _realMinimumZoomScale, _realMaximumZoomScale;           // as set by the user (UIScrollView's min/maxZoomScale == our min/maxZoomScale divided by _zoomScale)
    id _realDelegate;                       // as set by the user (UIScrollView's delegate is set to self)
    UIView *_realZoomView;                      // the view for zooming returned by the delegate
    UIView *_zoomWrapperView;               // the disposable wrapper view actually used for zooming
}

// if both are enabled, zoom-in takes precedence unless the view is at maximum zoom scale
@property(nonatomic, assign) BOOL zoomInOnDoubleTap;
@property(nonatomic, assign) BOOL zoomOutOnDoubleTap;

@property(nonatomic, assign) id<UIScrollViewDelegate> zoomScrollViewDelegate;

@end

@interface ZoomScrollView (Zooming)

@property(nonatomic, assign) float zoomScale;                     // from minimumZoomScale to maximumZoomScale

- (void)setZoomScale:(float)zoomScale animated:(BOOL)animated;    // centerPoint == center of the scroll view
- (void)setZoomScale:(float)zoomScale centeredAt:(CGPoint)centerPoint animated:(BOOL)animated;

@end

@interface NSObject (ZoomScrollViewDelegateMethods)

// return YES to stop processing, NO to pass the event to UIScrollView (mnemonic: default is to pass, and default return value in Obj-C is NO)
- (BOOL)zoomScrollView:(ZoomScrollView *)zoomScrollView touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event;
- (BOOL)zoomScrollView:(ZoomScrollView *)zoomScrollView touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event;
- (BOOL)zoomScrollView:(ZoomScrollView *)zoomScrollView touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event;
- (BOOL)zoomScrollView:(ZoomScrollView *)zoomScrollView touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event;

@end 
```

执行：

```
@interface ZoomScrollView (DelegateMethods) <UIScrollViewDelegate>
@end

@interface ZoomScrollView (ZoomingPrivate)
- (void)_setZoomScaleAndUpdateVirtualScales:(float)zoomScale;           // set UIScrollView's minimumZoomScale/maximumZoomScale
- (BOOL)_handleDoubleTapWith:(UITouch *)touch;
- (UIView *)_createWrapperViewForZoomingInsteadOfView:(UIView *)view;   // create a disposable wrapper view for zooming
- (void)_zoomDidEndBouncing;
- (void)_programmaticZoomAnimationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(UIView *)context;
- (void)_setTransformOn:(UIView *)view;
@end

@implementation ZoomScrollView

@synthesize zoomInOnDoubleTap=_zoomInOnDoubleTap, zoomOutOnDoubleTap=_zoomOutOnDoubleTap;
@synthesize zoomScrollViewDelegate=_realDelegate;

- (id)initWithFrame:(CGRect)frame {
    if (self = [super initWithFrame:frame]) {
        _zoomScale = 1.0f;
        _realMinimumZoomScale = super.minimumZoomScale;
        _realMaximumZoomScale = super.maximumZoomScale;
        super.delegate = self;
    }
    return self;
}

- (id)initWithCoder:(NSCoder *)aDecoder {
    if (self = [super initWithCoder:aDecoder]) {
        _zoomScale = 1.0f;
        _realMinimumZoomScale = super.minimumZoomScale;
        _realMaximumZoomScale = super.maximumZoomScale;
        super.delegate = self;
    }
    return self;
}

- (id<UIScrollViewDelegate>)realDelegate {
    return _realDelegate;
}
- (void)setDelegate:(id<UIScrollViewDelegate>)delegate {
    _realDelegate = delegate;
}

- (float)minimumZoomScale {
    return _realMinimumZoomScale;
}
- (void)setMinimumZoomScale:(float)value {
    _realMinimumZoomScale = value;
    [self _setZoomScaleAndUpdateVirtualScales:_zoomScale];
}

- (float)maximumZoomScale {
    return _realMaximumZoomScale;
}
- (void)setMaximumZoomScale:(float)value {
    _realMaximumZoomScale = value;
    [self _setZoomScaleAndUpdateVirtualScales:_zoomScale];
}

@end

@implementation ZoomScrollView (Zooming)

- (void)_setZoomScaleAndUpdateVirtualScales:(float)zoomScale {
    _zoomScale = zoomScale;
    // prevent accumulation of error, and prevent a common bug in the user's code (comparing floats with '==')
    if (ABS(_zoomScale - _realMinimumZoomScale) < 1e-5)
        _zoomScale = _realMinimumZoomScale;
    else if (ABS(_zoomScale - _realMaximumZoomScale) < 1e-5)
        _zoomScale = _realMaximumZoomScale;
    super.minimumZoomScale = _realMinimumZoomScale / _zoomScale;
    super.maximumZoomScale = _realMaximumZoomScale / _zoomScale;
}

- (void)_setTransformOn:(UIView *)view {
    if (ABS(_zoomScale - 1.0f) < 1e-5)
        view.transform = CGAffineTransformIdentity;
    else
        view.transform = CGAffineTransformMakeScale(_zoomScale, _zoomScale);
}

- (float)zoomScale {
    return _zoomScale;
}

- (void)setZoomScale:(float)zoomScale {
    [self setZoomScale:zoomScale animated:NO];
}

- (void)setZoomScale:(float)zoomScale animated:(BOOL)animated {
    [self setZoomScale:zoomScale centeredAt:CGPointMake(self.frame.size.width / 2, self.frame.size.height / 2) animated:animated];
}

- (void)setZoomScale:(float)zoomScale centeredAt:(CGPoint)centerPoint animated:(BOOL)animated {
    if (![_realDelegate respondsToSelector:@selector(viewForZoomingInScrollView:)]) {
        NSLog(@"setZoomScale called on ZoomScrollView, however delegate does not implement viewForZoomingInScrollView");
        return;
    }

    // viewForZoomingInScrollView may change contentOffset, and centerPoint is relative to the current one
    CGPoint origin = self.contentOffset;
    centerPoint = CGPointMake(centerPoint.x - origin.x, centerPoint.y - origin.y);

    UIView *viewForZooming = [_realDelegate viewForZoomingInScrollView:self];
    if (viewForZooming == nil)
        return;

    if (animated) {
        [UIView beginAnimations:nil context:viewForZooming];
        [UIView setAnimationDuration: 0.2];
        [UIView setAnimationDelegate: self];
        [UIView setAnimationDidStopSelector: @selector(_programmaticZoomAnimationDidStop:finished:context:)];
    }

    [self _setZoomScaleAndUpdateVirtualScales:zoomScale];
    [self _setTransformOn:viewForZooming];

    CGSize zoomViewSize   = viewForZooming.frame.size;
    CGSize scrollViewSize = self.frame.size;
    viewForZooming.frame = CGRectMake(0, 0, zoomViewSize.width, zoomViewSize.height);
    self.contentSize = zoomViewSize;
    self.contentOffset = CGPointMake(MAX(MIN(zoomViewSize.width*centerPoint.x/scrollViewSize.width - scrollViewSize.width/2, zoomViewSize.width - scrollViewSize.width), 0),
                                     MAX(MIN(zoomViewSize.height*centerPoint.y/scrollViewSize.height - scrollViewSize.height/2, zoomViewSize.height - scrollViewSize.height), 0));

    if (animated) {
        [UIView commitAnimations];
    } else {
        [self _programmaticZoomAnimationDidStop:nil finished:nil context:viewForZooming];
    }
}

- (void)_programmaticZoomAnimationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(UIView *)context {
    if ([_realDelegate respondsToSelector:@selector(scrollViewDidEndZooming:withView:atScale:)])
        [_realDelegate scrollViewDidEndZooming:self withView:context atScale:_zoomScale];
}

- (BOOL)_handleDoubleTapWith:(UITouch *)touch {
    if (!_zoomInOnDoubleTap && !_zoomOutOnDoubleTap)
        return NO;
    if (_zoomInOnDoubleTap && ABS(_zoomScale - _realMaximumZoomScale) > 1e-5)
        [self setZoomScale:_realMaximumZoomScale centeredAt:[touch locationInView:self] animated:YES];
    else if (_zoomOutOnDoubleTap && ABS(_zoomScale - _realMinimumZoomScale) > 1e-5)
        [self setZoomScale:_realMinimumZoomScale animated:YES];
    return YES;
}

// the heart of the zooming technique: zooming starts here
- (UIView *)_createWrapperViewForZoomingInsteadOfView:(UIView *)view {
    if (_zoomWrapperView != nil) // not sure this is really possible
        [self _zoomDidEndBouncing]; // ...but just in case cleanup the previous zoom op

    _realZoomView = [view retain];
    [view removeFromSuperview];
    [self _setTransformOn:_realZoomView]; // should be already set, except if this is a different view
    _realZoomView.frame = CGRectMake(0, 0, _realZoomView.frame.size.width, _realZoomView.frame.size.height);
    _zoomWrapperView = [[UIView alloc] initWithFrame:view.frame];
    [_zoomWrapperView addSubview:view];
    [self addSubview:_zoomWrapperView];

    return _zoomWrapperView;
}

// the heart of the zooming technique: zooming ends here
- (void)_zoomDidEndBouncing {
    _zoomingDidEnd = NO;
    [_realZoomView removeFromSuperview];
    [self _setTransformOn:_realZoomView];
    _realZoomView.frame = _zoomWrapperView.frame;
    [self addSubview:_realZoomView];

    [_zoomWrapperView release];
    _zoomWrapperView = nil;

    if ([_realDelegate respondsToSelector:@selector(scrollViewDidEndZooming:withView:atScale:)])
        [_realDelegate scrollViewDidEndZooming:self withView:_realZoomView atScale:_zoomScale];
    [_realZoomView release];
    _realZoomView = nil;
}

@end

@implementation ZoomScrollView (DelegateMethods)

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewWillBeginDragging:)])
        [_realDelegate scrollViewWillBeginDragging:self];
}

- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {
    if ([_realDelegate respondsToSelector:@selector(scrollViewDidEndDragging:willDecelerate:)])
        [_realDelegate scrollViewDidEndDragging:self willDecelerate:decelerate];
}

- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewWillBeginDecelerating:)])
        [_realDelegate scrollViewWillBeginDecelerating:self];
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewDidEndDecelerating:)])
        [_realDelegate scrollViewDidEndDecelerating:self];
}

- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewDidEndScrollingAnimation:)])
        [_realDelegate scrollViewDidEndScrollingAnimation:self];
}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView {
    UIView *viewForZooming = nil;
    if ([_realDelegate respondsToSelector:@selector(viewForZoomingInScrollView:)])
        viewForZooming = [_realDelegate viewForZoomingInScrollView:self];
    if (viewForZooming != nil)
        viewForZooming = [self _createWrapperViewForZoomingInsteadOfView:viewForZooming];
    return viewForZooming;
}

- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {
    [self _setZoomScaleAndUpdateVirtualScales:_zoomScale * scale];

    // often UIScrollView continues bouncing even after the call to this method, so we have to use delays
    _zoomingDidEnd = YES; // signal scrollViewDidScroll to schedule _zoomDidEndBouncing call
    [self performSelector:@selector(_zoomDidEndBouncing) withObject:nil afterDelay:0.1];
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    if (_zoomWrapperView != nil && _zoomingDidEnd) {
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(_zoomDidEndBouncing) object:nil];
        [self performSelector:@selector(_zoomDidEndBouncing) withObject:nil afterDelay:0.1];
    }

    if ([_realDelegate respondsToSelector:@selector(scrollViewDidScroll:)])
        [_realDelegate scrollViewDidScroll:self];
}

- (BOOL)scrollViewShouldScrollToTop:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewShouldScrollToTop:)])
        return [_realDelegate scrollViewShouldScrollToTop:self];
    else
        return YES;
}

- (void)scrollViewDidScrollToTop:(UIScrollView *)scrollView {
    if ([_realDelegate respondsToSelector:@selector(scrollViewDidScrollToTop:)])
        [_realDelegate scrollViewDidScrollToTop:self];  
}

@end

@implementation ZoomScrollView (EventForwarding)

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    id delegate = self.delegate;
    if ([delegate respondsToSelector:@selector(zoomScrollView:touchesBegan:withEvent:)])
        _ignoreSubsequentTouches = [delegate zoomScrollView:self touchesBegan:touches withEvent:event];
    if (_ignoreSubsequentTouches)
        return;
    if ([touches count] == 1 && [[touches anyObject] tapCount] == 2)
        if ([self _handleDoubleTapWith:[touches anyObject]])
            return;
    [super touchesBegan:touches withEvent:event];
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    id delegate = self.delegate;
    if ([delegate respondsToSelector:@selector(zoomScrollView:touchesMoved:withEvent:)])
        if ([delegate zoomScrollView:self touchesMoved:touches withEvent:event]) {
            _ignoreSubsequentTouches = YES;
            [super touchesCancelled:touches withEvent:event];
        }
    if (_ignoreSubsequentTouches)
        return;
    [super touchesMoved:touches withEvent:event];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    id delegate = self.delegate;
    if ([delegate respondsToSelector:@selector(zoomScrollView:touchesEnded:withEvent:)])
        if ([delegate zoomScrollView:self touchesEnded:touches withEvent:event]) {
            _ignoreSubsequentTouches = YES;
            [super touchesCancelled:touches withEvent:event];
        }
    if (_ignoreSubsequentTouches)
        return;
    [super touchesEnded:touches withEvent:event];
}

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    id delegate = self.delegate;
    if ([delegate respondsToSelector:@selector(zoomScrollView:touchesCancelled:withEvent:)])
        if ([delegate zoomScrollView:self touchesCancelled:touches withEvent:event])
            _ignoreSubsequentTouches = YES;
    [super touchesCancelled:touches withEvent:event];
}

@end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-20T21:58:22.743

我想我知道 Darron 指的是什么文档。在文档“iPhone OS 编程指南”中有一节“处理多点触控事件”。其中包含清单 7-1：

```
- (void) touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event {
 UIScrollView  *scrollView = (UIScrollView*)[self superview];
 UITouch       *touch = [touches anyObject];
 CGSize        size;
 CGPoint       point;

 if([touch tapCount] == 2) {
    if(![_viewController _isZoomed]) {
        point = [touch locationInView:self];
        size = [self bounds].size;
        point.x /= size.width;
        point.y /= size.height;

        [_viewController _setZoomed:YES];

        size = [scrollView contentSize];
        point.x *= size.width;
        point.y *= size.height;
        size = [scrollView bounds].size;
        point.x -= size.width / 2;
        point.y -= size.height / 2;
        [scrollView setContentOffset:point animated:NO];
    }
        else
        [_viewController _setZoomed:NO];
    }
 }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T17:57:30.360

达伦，你能提供一个苹果例子的链接吗？或者标题以便我可以找到它？我看到[http://developer.apple.com/iphone/library/samplecode/Touches/index.html](http://developer.apple.com/iphone/library/samplecode/Touches/index.html)，但这不包括缩放。

我在程序化缩放后看到的问题是手势缩放将缩放捕捉回程序化缩放发生之前的状态。似乎 UIScrollView 在内部保持有关缩放因子/级别的状态，但我没有确凿的证据。

谢谢，-安德鲁

编辑：我刚刚意识到，您正在解决这样一个事实，即您通过调整大小和更改缩放因子 1.0 的含义几乎无法控制 UIScrollView 的内部缩放因子。有点骇人听闻，但似乎所有苹果都留给我们了。也许自定义类可以封装这个技巧......

# javascript - 重置 TiddlyWiki/CheckboxPlugin 清单中的所有项目

> ID：172258
> 
> 赞同：0
> 
> 时间：2008-10-05T16:47:58.167
> 
> 标签：javascript, tiddlywiki

我使用[CheckboxPlugin](http://www.tiddlytools.com/#CheckboxPlugin)在 TiddlyWiki 中为自己编写了一份每周回顾 GTD 清单。每周完成后，我想单击一个链接以取消选中（重置）其上的所有项目，以便为下次使用做好准备。

我将支票信息作为标签存储在单独的提琴手页面上。我应该能够删除该页面上的所有标签并刷新清单页面，但我还没有弄清楚如何做到这一点。

我通常使用 C、C++ 和 Lisp 工作，我只是在学习 Javascript。任何人都可以提供一些有用的指示吗？

（在有人建议之前，我已经查看了同一站点上的 ChecklistScript。它不使用 CheckboxPlugin 的东西，并且与它不兼容。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-07T11:40:08.320

试试这个（改编自 ChecklistScript 的“resetall”代码）：

```
<html><form style="display:inline">
    <input type="button" value="clear all" onclick="
        var tid='SomeTiddler';
        var list='tag1 [[tag 2]] tag3 tag4';
        var tags=list.readBracketedList();
        store.suspendNotifications();
        for (var t=0; t<tags.length; t++)
            store.setTiddlerTag(tid,false,tags[t]);
        store.resumeNotifications();
        story.refreshTiddler(tid,null,true);
"></form></html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T16:03:00.770

花了一段时间，但我想通了（感谢 ELS 对灵感的回答）：

```
<script label="(Reset All)" title="Reset all items" key="X">
        var tid='WeeklyReviewStepsChecklistItems';
        store.getTiddler(tid).tags=[];
        story.refreshTiddler(tid,null,true);

        story.refreshTiddler('Weekly Review Steps',null,true);
</script> 
```

这只有效，因为我将标签存储在一个单独的 tiddler 中，并使用[InlineJavascriptPlugin](http://www.tiddlytools.com/#InlineJavascriptPlugin)。

# c++ - C++#include和#import的区别

> ID：172262
> 
> 赞同：104
> 
> 时间：2008-10-05T16:50:17.273
> 
> 标签：c++, visual-c++, gcc, import, include

`#include`C++和C++有什么区别`#import`？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-05T16:50:55.837

**在 VC++ 中导入：** `#import`用于类型库或 .tlbs（COM 东西）。

类型库的内容被转换为 C++ 类，主要是自动为您描述 COM 接口，然后将其包含到您的文件中。

该`#import`指令由 Microsoft 作为 C++ 语言的扩展引入。[您可以在这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/8etzzkb6(VS.71).aspx)中了解它。

该`#import`指令也用于 .NET / CLI 的东西。

**gcc** 中的导入：gcc 中的导入与 VC++ 中的导入不同。这是一种最多只包含一次标题的简单方法。（在 VC++ 和 GCC 中，您也可以通过`#pragma`一次来执行此操作）

该`#import`指令在 3.4 版中被 gcc 团队正式弃用，并且在所有支持

**包括：** `#include`主要用于头文件，但将内容添加到当前文件中。`#include`是 C++ 标准的一部分。[您可以在这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/36k2cdd4(VS.71).aspx)中了解它。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-10-05T16:54:19.403

`#import`是微软特有的东西，显然只适用于 COM 或 .NET 的东西。

`#include`是标准的 C/C++ 预处理器语句，用于在源代码文件中包含头文件（或偶尔包含其他源代码）文件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-07T02:43:30.023

`#import`总体上是对通常的*解决方案*

```
#ifndef ...
#define ...
#include ...
#endif 
```

变通方法。`#import`仅在以前未包含文件时才包含该文件。

值得注意的是，Apple 的 Objective-C 也使用`#import`语句。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-05T21:14:32.560

*import*也是与[n2073（C++ 中](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2073.pdf#search=%22n2073%20c%2B%2B%22)的模块）相关的关键字之一，由 Daveed Vandevoorde 于 2006 年 9 月向语言委员会提出。我不是一个语言极客，无法知道该提案是否被明确搁置或是否正在等待实施（概念证明）来自作者或其他人......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-22T00:19:08.337

请注意，在 gcc 4.1 中，`#import` *已*弃用。如果你使用它，你会得到警告：

> `#import`是一个弃用的 GCC 扩展

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-02-22T21:24:11.207

这个帖子应该更新吗？

`import`现在，由于 C++20 标准已经不存在，我们可以使用该语句进入范围“模块” 。

[https://en.cppreference.com/w/cpp/language/modules](https://en.cppreference.com/w/cpp/language/modules)

在从代码的不同部分调用多个模块时的编译速度方面，import 语句似乎比旧的`#include`preprocesor 指令更快。

# wcf - 如何控制通用 WCF 返回类型的名称？

> ID：172265
> 
> 赞同：8
> 
> 时间：2008-10-05T16:50:58.223
> 
> 标签：wcf, web-services, generics

我有一个 WCF Web 服务方法，其原型是：

```
[OperationContract]
Response<List<Customer>> GetCustomers(); 
```

当我将服务引用添加到客户端时，Visual Studio (2005) 创建一个名为“ResponseOfArrayOfCustomerrleXg3IC”的类型，它是“Response<List<Customer>>”的包装器。有什么办法可以控制包装名称吗？ResponseOfArrayOfCustomerrleXg3IC 听起来不是很吸引人……

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-05T21:07:01.000

`DataContract`您可以像这样在属性中定义自己的名称：

```
[DataContract(Name = "ResponseOf{0}")]
public class Response<T> 
```

请注意，在您的示例中`{0}`，您的代理引用类型将被替换`ResponseOfArrayOfCustomer`。

更多信息：[WCF：序列化和泛型](http://jeffbarnes.net/blog/post/2007/05/10/WCF-Serialization-and-Generics.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T18:07:04.827

请试试这个：

```
[OperationContract]
[return: MessageParameter(Name="YOURNAME")]
Response<List<Customer>> GetCustomers(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-05T17:50:18.760

是的。OperationContractAttribute 采用一个名为 Name 的参数。您可以像这样指定它：

```
[OperationContract(Name = "NameGoesHere")]
Response<List<Customer>> GetCustomers(); 
```

# oracle - PL/SQL：如何执行执行 DML 并具有返回值的 SP？

> ID：172278
> 
> 赞同：1
> 
> 时间：2008-10-05T16:58:09.223
> 
> 标签：oracle, syntax, plsql

我有一个带有以下标头的存储过程：

```
FUNCTION SaveShipment (p_user_id IN INTEGER, p_transaction_id IN INTEGER, p_vehicle_code IN VARCHAR2 DEFAULT NULL, p_seals IN VARCHAR2 DEFAULT NULL) RETURN INTEGER; 
```

我无法从 TOAD 的编辑器中运行它。我不能将它作为 select from dual 语句的一部分运行，因为它会执行 DML，但是如果我尝试使用我在某些论坛上看到的推荐的以下语法：

```
var c integer;
exec :c := orm_helper.orm_helper.SAVESHIPMENT (9999, 31896, NULL, '');
print c; 
```

我得到：

```
ORA-01008: not all variables bound
Details:
BEGIN :c := orm_helper.orm_helper.saveshipment (9999, 31896, null, ''); END;
Error at line 2
ORA-01008: not all variables bound 
```

手动运行这个 sp 的正确语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T17:10:48.200

您是从另一个 SP 调用存储过程吗？

我认为语法是（如果我没记错的话）：

```
declare
     c integer;
begin

c:=storedProc(...parameters...); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T19:40:52.030

您可能可以从 DUAL 中选择 orm_helper.orm_helper.SAVESHIPMENT (9999, 31896, NULL, '')。

# c# - obj 文件夹是为了什么而生成的？

> ID：172279
> 
> 赞同：92
> 
> 时间：2008-10-05T16:58:21.047
> 
> 标签：c#, .net, visual-studio, build-process

> **可能重复：**
> [obj 和 bin 文件夹（由 Visual Studio 创建）用于什么？](https://stackoverflow.com/questions/5308491/what-are-the-obj-and-bin-folders-created-by-visual-studio-used-for)

任何项目的默认输出路径都是 Visual Studio is **`bin/Debug`**，但我注意到还会生成文件夹，该`obj`文件夹再次包含文件。有人能告诉我为什么会生成这个文件夹吗？`dll``pdb`

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-05T17:03:30.477

“obj”文件夹用于存储临时对象文件和其他用于创建最终二进制文件的文件。

[在这里](http://social.msdn.microsoft.com/Forums/en-US/csharpide/thread/456ebb0e-6fa3-4a77-a723-6984c5208562/)进一步阅读

# git - 浏览复杂版本控制系统历史的最先进的用户界面是什么？

> ID：172300
> 
> 赞同：8
> 
> 时间：2008-10-05T17:06:12.217
> 
> 标签：git, version-control, mercurial, visualization

在使用 Mercurial 时，我有时会发现当有数千个变更集时很难理解变更集之间的关系，有时在任何时候都有十个或更多活动分支。目前，我使用[hgview](http://www.logilab.org/project/hgview/screenshots?selected=4873)还可以，虽然它做出了合理的尝试来表示父关系，但它仍然基本上是一维的。[我想使用GraphViz](http://www.graphviz.org/)之类的图形可视化程序可能会很好地工作，或者可能会更古怪。

目前我正在处理大约 30,000 次修订的项目，我预计这个数字会显着增长；如果 100 位全职开发人员真正了解分布式版本控制并开始定期提交并分享他们的完整开发历史，那么我们最终可能会处理数百万次修订。因此，无需在每次查看时都将整个历史记录加载到 RAM 中的浏览器因此变得很有必要

我也对任何版本控制系统的优秀历史浏览器感兴趣，特别是如果我有机会将它们移植到 Mercurial。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-05T17:57:15.157

git的`gitk(1)`工具是我在工作中使用的。请注意，它需要一个`git rev-list`约束，因此您可以限制您看到的内容。从长远来看，当提交数量增加时，您肯定希望开始进行这种选择性挑选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T18:05:38.977

我在工作中使用 ClearCase VCS，它的版本树浏览器可能适合你。但是，唉，我不知道任何单独的现成工具。

# database - 什么是最有效地编辑“时间表”的好算法？

> ID：172302
> 
> 赞同：2
> 
> 时间：2008-10-05T17:07:21.077
> 
> 标签：database, algorithm, diff

这是一个小型调度应用程序。我需要一种算法来有效地比较两个“时间表”，找出差异，并仅更新已更改的数据行，以及另一个表中具有该表作为外键的条目。这是一个大问题，所以我马上说我正在寻找**一般建议**或**具体解决方案**。

**编辑：**正如建议的那样，我已经大大缩短了这个问题。

在一张表中，我将资源与使用它们的时间跨度相关联。

我还有第二个表（表 B），它使用表 A 中的 ID 作为外键。

对应于表 B 的表 A 中的条目将具有**包含**表 B 中的时间跨度的时间跨度。并非表 A 中的所有条目都将在表 B 中具有条目。

我为用户提供了一个界面来编辑表 A 中的资源计划。他们基本上为表 A 提供了一组新数据，我需要将其视为与数据库中版本的*差异*。

如果他们从表 B 指向的表 A 中完全删除了一个对象，我也想从表 B 中删除该条目。

因此，给定以下 3 组：

*   表 A 中的原始对象（来自数据库）
*   表 B 中的原始对象（来自数据库）
*   表 A 中已编辑的对象集（来自用户，因此没有唯一 ID）

我需要一个算法，它将：

*   如果不需要对这些对象进行更改，则保持表 A 和表 B 中的行不变。
*   根据需要向表 A 添加行。
*   根据需要从表 A 和表 B 中删除行。
*   根据需要修改表 A 和表 B 中的行。

只需将对象排序到我可以应用适当的数据库操作的排列中，就足以解决问题了。

再次，请根据您的喜好**具体**或**一般地**回答，我正在寻找建议，但如果有人有一个完整的算法，那会让我很开心。:)

**编辑：**作为对 lassvek 的回应，我提供了一些额外的细节：

表 B 的项目总是完全包含在表 A 项目中，而不仅仅是重叠。

*重要的是，*表 B 的项目是量化的，因此它们应该完全落在内部或完全外部。如果这没有发生，那么我将遇到必须单独处理的数据完整性错误。

例如（使用简写）：

```
表 A
ID资源开始结束
01 资源 A 10/6 7:00AM 10/6 11:00AM
02 资源 A 10/6 1:00PM 10/6 3:00PM

表 B
ID Table_A_ID 开始 结束
01 02 10/6 下午 1:00 10/6 下午 2:00

```

所以我想要以下行为：

*   如果我从表 A 中删除 ID 02，或者将其缩短到下午 2:00 - 3:00，我应该从表 B 中删除 ID 01。
*   如果我将表 A ID 01 扩展到它在下午 1:00 结束的位置，**这两个条目应该合并到一行**中，表 B ID 01 现在应该指向表 A ID 01。
*   如果我从表 A ID 01 中删除 8:00AM-10:00AM，则该条目应分为两个条目：一个用于 7:00AM-8:00AM，一个新条目 (ID 03) 用于 10:00AM-11： 00AM。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-06T12:12:24.697

我在句号方面进行了广泛的工作，但恐怕我并不完全理解表 A 和 B 是如何协同工作的，也许是我不明白的*包含这个词。*

你能举一些你想要做什么的具体例子吗？

您的意思是，表 A 中记录的时间跨度完全包含表 B 中的时间跨度，像这样吗？

```
|---------------- A -------------------|
    |--- B ----|      |--- B ---| 
```

或重叠？

```
 |---------------- A -------------------|
|--- B ----|                        |--- B ---| 
```

或相反，B 中的时间跨度包含/与 A 重叠？

假设它是第一个，其中 B 中的时间跨度在表 A 中的链接时间跨度内/相同。

这是否意味着：

```
* A removed A-timespan removes all the linked timespans from B
* An added A-timespan, what about this?
* A shortened A-timespan removes all the linked timespans from B that now falls outside A
* A lenghtened A-timespan, will this include all matching B-timespans now inside? 
```

这是一个例子：

```
|-------------- A1 --------------|    |-------- A2 --------------|
  |---- B1 ----|  |----- B2 ---|       |---- B3 ----|  |-- B4 --| 
```

然后你拉长 A1 并缩短和移动 A2，这样：

```
|-------------- A1 ---------------------------------|  |--- A2 --|
  |---- B1 ----|  |----- B2 ---|       |---- B3 ----|  |-- B4 --| 
```

这意味着您要像这样修改数据：

```
1\. Lengthen (update) A1
2\. Shorten and move (update) A2
3\. Re-link (update) B3 from A2 to A1 instead 
```

这个修改怎么样，A1 被加长，但不足以完全包含 B3，A2 以同样的方式移动/缩短：

```
|-------------- A1 -----------------------------|      |--- A2 --|
  |---- B1 ----|  |----- B2 ---|       |---- B3 ----|  |-- B4 --| 
```

由于 B3 现在不完全在 A1 或 A2 中，所以删除它？

我需要一些具体的例子来说明你想要做什么。

* * *

**编辑**更多问题

好的，那么：

```
|------------------ A -----------------------|
  |------- B1 -------|  |------- B2 ------|
                           |---|                   <-- I want to remove this from A 
```

那这个呢？

任何一个：

```
|------------------ A1 ----|   |---- A2 -----|
  |------- B1 -------|  |B3|   |--- B2 ---| 
```

或者：

```
|------------------ A1 ----|   |---- A2 -----|
  |------- B1 -------| 
```

总结一下我的看法，有问题，到目前为止：

*   您希望能够对 A 执行以下操作
    *   缩短
    *   加长
    *   相邻时合并，将两个或多个合并为一个
    *   通过删除句号在其中打孔，然后将其拆分
*   上述更新后仍包含在 A 中的 B，如有必要，请重新链接
*   B 被包含，但现在完全在外面，删除它们
*   B 被包含，但现在部分在外面，**编辑：删除这些，参考数据完整性**
*   对于上述所有操作，做最少的必要工作以使数据与操作一致（而不是仅仅删除所有内容并重新插入）

我将在 C# 中工作，当我下班回家时可能会工作，今晚晚些时候我会回来更多。

* * *

**编辑**这是对算法的尝试。

1.  先优化新列表（即合并相邻时段等）
2.  通过以下方式将此列表与数据库中的主期间“合并”：
    1.  跟踪您在两个列表中的位置（即新的和现有的）
    2.  如果当前新期间完全在当前现有期间之前，则添加它，然后移至下一个新期间
    3.  如果当前新期间完全在当前现有期间之后，则删除现有期间及其所有子期间，然后移至下一个现有期间
    4.  如果两者重叠，则将当前现有期间调整为等于新期间，按以下方式，然后移动到下一个新的和现有期间
        1.  如果新时期在现有时期之前开始，只需移动开始
        2.  如果新周期在现有周期之后开始，检查是否有任何子周期在差异周期中，并记住它们，然后移动开始
        3.  对另一端做同样的事情
3.  对于您“记住”的任何时期，看看它们是否需要重新链接或删除

您应该创建大量的单元测试，并确保涵盖所有修改组合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T12:07:51.243

我建议你将你的问题分解成两个独立的问题：第一个应该是这样的：“当将调度原子表示为具有开始时间和结束时间的资源时，我如何推理资源调度？” 在这里，ADept 使用区间代数的建议似乎很合适。请参阅[Wikipedia 条目“间隔图”](http://en.wikipedia.org/wiki/Interval_graph)和[SUNY 算法存储库条目关于调度](http://www.cs.sunysb.edu/~algorith/files/scheduling.shtml)。第二个问题是数据库问题：“给定一个算法，它调度间隔并指示两个间隔是否重叠或一个包含在另一个中，我如何使用这些信息来管理给定模式中的数据库？” 我相信一旦调度算法到位，数据库问题就会容易解决很多。HTH，尤瓦尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T19:14:15.283

您的帖子几乎属于“太长；未阅读”类别 - 缩短它可能会给您更多反馈。

无论如何，关于主题：您可以尝试研究一个名为[“区间代数”的东西](http://en.wikipedia.org/wiki/Allen's_Interval_Algebra)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T19:42:51.123

据我了解，您的用户只能直接影响表 A。假设您使用 C# 编程，您可以使用简单的 ADO.Net DataSet 来管理对表 A 的修改。 TableAdapter 知道单独保留未触及的行并处理新的，适当地修改和删除行。

此外，您应该定义一个级联删除，以便自动删除表 B 中的相应对象。

唯一没有以这种方式处理的情况是，如果表 A 中的时间跨度被缩短，则它不再包含表 B 中的相应记录。您可以简单地在更新存储过程中检查这种情况，或者在表 A 上定义更新触发器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T19:56:14.170

在我看来，任何算法都将涉及通过 NewA，匹配 ResourceID、StartTime 和 EndTime，并跟踪来自 OldA 的哪些元素被命中。然后你有两组不匹配的数据，UnmatchedNewA 和 UnmatchedOldA。

我能想到的最简单的方法基本上是从这些重新开始：将所有 UnmatchedNewA 写入数据库，将 B 的元素从 UnmatchedOldA 转移到新的 A 键（刚刚生成）中，如果可能，则删除。然后清除所有UnmatchedOldA。

如果有很多变化，这肯定不是一个有效的方法。但是，在数据量不是很大的情况下，我更喜欢简单而不是巧妙的优化。

* * *

如果没有更多背景，就不可能知道这个最终建议是否有意义，但如果你没有这样想的话：

您可以使用事件侦听器或类似的东西来仅在需要更改的地方更新数据模型，而不是来回传递整个 A 集合吗？这样，被更改的对象将能够动态确定需要哪些数据库操作。

# regex - 是否有正则表达式来检测有效的正则表达式？

> ID：172303
> 
> 赞同：1109
> 
> 时间：2008-10-05T17:07:35.227
> 
> 标签：regex

是否可以使用另一个正则表达式检测有效的正则表达式？如果是这样，请在下面给出示例代码。

* * *

## 回答 #1

> 赞同：1045
> 
> 时间：2008-10-05T17:15:56.067

```
/
^                                             # start of string
(                                             # first group start
  (?:
    (?:[^?+*{}()[\]\\|]+                      # literals and ^, $
     | \\.                                    # escaped characters
     | \[ (?: \^?\\. | \^[^\\] | [^\\^] )     # character classes
          (?: [^\]\\]+ | \\. )* \]
     | \( (?:\?[:=!]|\?<[=!]|\?>)? (?1)?? \)  # parenthesis, with recursive content
     | \(\? (?:R|[+-]?\d+) \)                 # recursive matching
     )
    (?: (?:[?+*]|\{\d+(?:,\d*)?\}) [?+]? )?   # quantifiers
  | \|                                        # alternative
  )*                                          # repeat content
)                                             # end first group
$                                             # end of string
/ 
```

这是一个递归正则表达式，许多正则表达式引擎不支持。基于 PCRE 的应该支持它。

没有空格和注释：

```
/^((?:(?:[^?+*{}()[\]\\|]+|\\.|\[(?:\^?\\.|\^[^\\]|[^\\^])(?:[^\]\\]+|\\.)*\]|\((?:\?[:=!]|\?<[=!]|\?>)?(?1)??\)|\(\?(?:R|[+-]?\d+)\))(?:(?:[?+*]|\{\d+(?:,\d*)?\})[?+]?)?|\|)*)$/ 
```

* * *

.NET 不直接支持递归。（`(?1)`and`(?R)`构造。）递归必须转换为计数平衡组：

```
^                                         # start of string
(?:
  (?: [^?+*{}()[\]\\|]+                   # literals and ^, $
   | \\.                                  # escaped characters
   | \[ (?: \^?\\. | \^[^\\] | [^\\^] )   # character classes
        (?: [^\]\\]+ | \\. )* \]
   | \( (?:\?[:=!]
         | \?<[=!]
         | \?>
         | \?<[^\W\d]\w*>
         | \?'[^\W\d]\w*'
         )?                               # opening of group
     (?<N>)                               #   increment counter
   | \)                                   # closing of group
     (?<-N>)                              #   decrement counter
   )
  (?: (?:[?+*]|\{\d+(?:,\d*)?\}) [?+]? )? # quantifiers
| \|                                      # alternative
)*                                        # repeat content
$                                         # end of string
(?(N)(?!))                                # fail if counter is non-zero. 
```

压实：

```
^(?:(?:[^?+*{}()[\]\\|]+|\\.|\[(?:\^?\\.|\^[^\\]|[^\\^])(?:[^\]\\]+|\\.)*\]|\((?:\?[:=!]|\?<[=!]|\?>|\?<[^\W\d]\w*>|\?'[^\W\d]\w*')?(?<N>)|\)(?<-N>))(?:(?:[?+*]|\{\d+(?:,\d*)?\})[?+]?)?|\|)*$(?(N)(?!)) 
```

从评论：

> 这会验证替换和翻译吗？

它将仅验证替换和翻译的正则表达式部分。`s/<this part>/.../`

> 理论上不可能将所有有效的正则表达式语法与正则表达式匹配。

如果正则表达式引擎支持递归是可能的，例如 PCRE，但它不能再被称为正则表达式了。

> 实际上，“递归正则表达式”不是正则表达式。但这是一个经常被接受的正则表达式引擎扩展......具有讽刺意味的是，这个扩展的正则表达式与扩展的正则表达式不匹配。

“理论上，理论和实践是一样的。在实践中，它们不是。” 几乎所有了解正则表达式的人都知道，正则表达式不支持递归。但是 PCRE 和大多数其他实现支持的远不止基本的正则表达式。

> 在 grep 命令中将此与 shell 脚本一起使用，它向我显示了一些错误.. grep: Invalid content of {} 。我正在制作一个可以 grep 代码库以查找所有包含正则表达式的文件的脚本

这种模式利用了一个称为递归正则表达式的扩展。这不受 POSIX 风格的正则表达式支持。您可以尝试使用 -P 开关来启用 PCRE 正则表达式风格。

> 正则表达式本身“不是正则语言，因此不能被正则表达式解析......”

这适用于经典正则表达式。一些现代实现允许递归，这使它成为一种无上下文的语言，尽管它对于这个任务来说有点冗长。

> 我知道你在哪里匹配`[]()/\`。和其他特殊的正则表达式字符。你在哪里允许非特殊字符？看起来这会匹配`^(?:[\.]+)$`，但不是`^abcdefg$`。这是一个有效的正则表达式。

`[^?+*{}()[\]\\|]`将匹配任何单个字符，而不是任何其他构造的一部分。这包括文字 ( `a`- `z`) 和某些特殊字符 ( `^`, `$`, `.`)。

* * *

## 回答 #2

> 赞同：344
> 
> 时间：2008-10-05T17:14:09.910

不太可能。

`try..catch`用您的语言提供的或任何语言对其进行评估。

* * *

## 回答 #3

> 赞同：235
> 
> 时间：2008-10-05T18:02:22.090

不，如果您严格地说正则表达式而不包括一些实际上是上下文无关语法的正则表达式实现。

正则表达式有一个限制，这使得无法编写匹配所有且仅匹配正则表达式的正则表达式。您不能匹配成对的大括号等实现。正则表达式使用许多这样的结构，让我们`[]`举个例子。只要有 ，`[`就必须有一个匹配`]`，这对于正则表达式来说足够简单`"\[.*\]"`。

正则表达式不可能的原因是它们可以嵌套。如何编写匹配嵌套括号的正则表达式？答案是你不能没有无限长的正则表达式。您可以通过蛮力匹配任意数量的嵌套括号，但您永远无法匹配任意长的嵌套括号集。

此功能通常称为计数，因为您正在计算嵌套的深度。根据定义，正则表达式没有计算能力。

* * *

我最终为此写了“[正则表达式限制](https://docs.microsoft.com/archive/blogs/jaredpar/regular-expression-limitations)”。

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2008-10-05T17:38:50.967

好问题。

真正的正则语言不能任意决定深度嵌套的格式良好的括号。如果您的字母表包含`'('`并且`')'`目标是确定其中的字符串是否具有格式正确的匹配括号。由于这是正则表达式的必要要求，因此答案是否定的。

但是，如果您放宽要求并添加递归，您可能可以做到。原因是递归可以充当堆栈，让您通过推入该堆栈来“计算”当前嵌套深度。

Russ Cox 写了“ [Regular Expression Matching Can Be Simple and Fast](http://swtch.com/~rsc/regexp/regexp1.html) ”，这是一篇关于正则表达式引擎实现的精彩论文。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2019-04-08T14:27:33.047

不，如果您使用标准正则表达式。

原因是您不能满足常规语言的[抽水引理](https://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages)。抽水引理指出，如果存在数字“N”，则属于语言“L”的字符串是规则的，这样，在将字符串分成三个子字符串`x`, `y`, `z`, 这样`|x|>=1 && |xy|<=N`之后，您可以重复任意`y`多次，并且整个字符串仍将属于`L`.

抽水引理的一个结果是，您不能在 形式中拥有常规字符串`a^Nb^Mc^N`，即两个具有相同长度的子字符串被另一个字符串分隔。无论如何，如果您将此类字符串拆分为`x`,`y`和`z`，则无法“泵送”`y`而不获得具有不同数量“a”和“c”的字符串，从而离开原始语言。例如，正则表达式中的括号就是这种情况。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-10-06T14:15:26.510

尽管完全可以使用 MizardX 发布的递归正则表达式，但对于这类事情，解析器更有用。正则表达式最初旨在与常规语言一起使用，递归或具有平衡组只是一个补丁。

定义有效正则表达式的语言实际上是一种上下文无关语法，您应该使用适当的解析器来处理它。这是一个用于解析简单正则表达式（没有大多数构造）的大学项目的示例。它使用JavaCC。是的，注释是西班牙语的，尽管方法名称是不言自明的。

```
SKIP :
{
    " "
|   "\r"
|   "\t"
|   "\n"
}
TOKEN : 
{
    < DIGITO: ["0" - "9"] >
|   < MAYUSCULA: ["A" - "Z"] >
|   < MINUSCULA: ["a" - "z"] >
|   < LAMBDA: "LAMBDA" >
|   < VACIO: "VACIO" >
}

IRegularExpression Expression() :
{
    IRegularExpression r; 
}
{
    r=Alternation() { return r; }
}

// Matchea disyunciones: ER | ER
IRegularExpression Alternation() :
{
    IRegularExpression r1 = null, r2 = null; 
}
{
    r1=Concatenation() ( "|" r2=Alternation() )?
    { 
        if (r2 == null) {
            return r1;
        } else {
            return createAlternation(r1,r2);
        } 
    }
}

// Matchea concatenaciones: ER.ER
IRegularExpression Concatenation() :
{
    IRegularExpression r1 = null, r2 = null; 
}
{
    r1=Repetition() ( "." r2=Repetition() { r1 = createConcatenation(r1,r2); } )*
    { return r1; }
}

// Matchea repeticiones: ER*
IRegularExpression Repetition() :
{
    IRegularExpression r; 
}
{
    r=Atom() ( "*" { r = createRepetition(r); } )*
    { return r; }
}

// Matchea regex atomicas: (ER), Terminal, Vacio, Lambda
IRegularExpression Atom() :
{
    String t;
    IRegularExpression r;
}
{
    ( "(" r=Expression() ")" {return r;}) 
    | t=Terminal() { return createTerminal(t); }
    | <LAMBDA> { return createLambda(); }
    | <VACIO> { return createEmpty(); }
}

// Matchea un terminal (digito o minuscula) y devuelve su valor
String Terminal() :
{
    Token t;
}
{
    ( t=<DIGITO> | t=<MINUSCULA> ) { return t.image; }
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2011-08-28T18:09:37.573

`preg_match`如果正则表达式无效，您可以提交将返回 false 的正则表达式。不要忘记使用`@`来抑制错误消息：

```
@preg_match($regexToTest, ''); 
```

*   如果正则表达式是 ，将返回 1 `//`。
*   如果正则表达式没问题，将返回 0。
*   否则将返回 false。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-05-25T12:51:18.360

Paul McGuire 的以下示例最初来自 pyparsing wiki，但现在[只能通过 Wayback Machine 获得，它提供了用于解析](https://web.archive.org/web/20120311031702/http://pyparsing.wikispaces.com/file/view/invRegex.py)*一些*正则表达式的语法，以返回匹配字符串集。因此，它拒绝那些包含无限重复项的 re's，如“+”和“*”。但它应该让您了解如何构建一个可以处理 re 的解析器。

```
# 
# invRegex.py
#
# Copyright 2008, Paul McGuire
#
# pyparsing script to expand a regular expression into all possible matching strings
# Supports:
# - {n} and {m,n} repetition, but not unbounded + or * repetition
# - ? optional elements
# - [] character ranges
# - () grouping
# - | alternation
#
__all__ = ["count","invert"]

from pyparsing import (Literal, oneOf, printables, ParserElement, Combine, 
    SkipTo, operatorPrecedence, ParseFatalException, Word, nums, opAssoc,
    Suppress, ParseResults, srange)

class CharacterRangeEmitter(object):
    def __init__(self,chars):
        # remove duplicate chars in character range, but preserve original order
        seen = set()
        self.charset = "".join( seen.add(c) or c for c in chars if c not in seen )
    def __str__(self):
        return '['+self.charset+']'
    def __repr__(self):
        return '['+self.charset+']'
    def makeGenerator(self):
        def genChars():
            for s in self.charset:
                yield s
        return genChars

class OptionalEmitter(object):
    def __init__(self,expr):
        self.expr = expr
    def makeGenerator(self):
        def optionalGen():
            yield ""
            for s in self.expr.makeGenerator()():
                yield s
        return optionalGen

class DotEmitter(object):
    def makeGenerator(self):
        def dotGen():
            for c in printables:
                yield c
        return dotGen

class GroupEmitter(object):
    def __init__(self,exprs):
        self.exprs = ParseResults(exprs)
    def makeGenerator(self):
        def groupGen():
            def recurseList(elist):
                if len(elist)==1:
                    for s in elist[0].makeGenerator()():
                        yield s
                else:
                    for s in elist[0].makeGenerator()():
                        for s2 in recurseList(elist[1:]):
                            yield s + s2
            if self.exprs:
                for s in recurseList(self.exprs):
                    yield s
        return groupGen

class AlternativeEmitter(object):
    def __init__(self,exprs):
        self.exprs = exprs
    def makeGenerator(self):
        def altGen():
            for e in self.exprs:
                for s in e.makeGenerator()():
                    yield s
        return altGen

class LiteralEmitter(object):
    def __init__(self,lit):
        self.lit = lit
    def __str__(self):
        return "Lit:"+self.lit
    def __repr__(self):
        return "Lit:"+self.lit
    def makeGenerator(self):
        def litGen():
            yield self.lit
        return litGen

def handleRange(toks):
    return CharacterRangeEmitter(srange(toks[0]))

def handleRepetition(toks):
    toks=toks[0]
    if toks[1] in "*+":
        raise ParseFatalException("",0,"unbounded repetition operators not supported")
    if toks[1] == "?":
        return OptionalEmitter(toks[0])
    if "count" in toks:
        return GroupEmitter([toks[0]] * int(toks.count))
    if "minCount" in toks:
        mincount = int(toks.minCount)
        maxcount = int(toks.maxCount)
        optcount = maxcount - mincount
        if optcount:
            opt = OptionalEmitter(toks[0])
            for i in range(1,optcount):
                opt = OptionalEmitter(GroupEmitter([toks[0],opt]))
            return GroupEmitter([toks[0]] * mincount + [opt])
        else:
            return [toks[0]] * mincount

def handleLiteral(toks):
    lit = ""
    for t in toks:
        if t[0] == "\\":
            if t[1] == "t":
                lit += '\t'
            else:
                lit += t[1]
        else:
            lit += t
    return LiteralEmitter(lit)    

def handleMacro(toks):
    macroChar = toks[0][1]
    if macroChar == "d":
        return CharacterRangeEmitter("0123456789")
    elif macroChar == "w":
        return CharacterRangeEmitter(srange("[A-Za-z0-9_]"))
    elif macroChar == "s":
        return LiteralEmitter(" ")
    else:
        raise ParseFatalException("",0,"unsupported macro character (" + macroChar + ")")

def handleSequence(toks):
    return GroupEmitter(toks[0])

def handleDot():
    return CharacterRangeEmitter(printables)

def handleAlternative(toks):
    return AlternativeEmitter(toks[0])

_parser = None
def parser():
    global _parser
    if _parser is None:
        ParserElement.setDefaultWhitespaceChars("")
        lbrack,rbrack,lbrace,rbrace,lparen,rparen = map(Literal,"[]{}()")

        reMacro = Combine("\\" + oneOf(list("dws")))
        escapedChar = ~reMacro + Combine("\\" + oneOf(list(printables)))
        reLiteralChar = "".join(c for c in printables if c not in r"\[]{}().*?+|") + " \t"

        reRange = Combine(lbrack + SkipTo(rbrack,ignore=escapedChar) + rbrack)
        reLiteral = ( escapedChar | oneOf(list(reLiteralChar)) )
        reDot = Literal(".")
        repetition = (
            ( lbrace + Word(nums).setResultsName("count") + rbrace ) |
            ( lbrace + Word(nums).setResultsName("minCount")+","+ Word(nums).setResultsName("maxCount") + rbrace ) |
            oneOf(list("*+?")) 
            )

        reRange.setParseAction(handleRange)
        reLiteral.setParseAction(handleLiteral)
        reMacro.setParseAction(handleMacro)
        reDot.setParseAction(handleDot)

        reTerm = ( reLiteral | reRange | reMacro | reDot )
        reExpr = operatorPrecedence( reTerm,
            [
            (repetition, 1, opAssoc.LEFT, handleRepetition),
            (None, 2, opAssoc.LEFT, handleSequence),
            (Suppress('|'), 2, opAssoc.LEFT, handleAlternative),
            ]
            )
        _parser = reExpr

    return _parser

def count(gen):
    """Simple function to count the number of elements returned by a generator."""
    i = 0
    for s in gen:
        i += 1
    return i

def invert(regex):
    """Call this routine as a generator to return all the strings that
       match the input regular expression.
           for s in invert("[A-Z]{3}\d{3}"):
               print s
    """
    invReGenerator = GroupEmitter(parser().parseString(regex)).makeGenerator()
    return invReGenerator()

def main():
    tests = r"""
    [A-EA]
    [A-D]*
    [A-D]{3}
    X[A-C]{3}Y
    X[A-C]{3}\(
    X\d
    foobar\d\d
    foobar{2}
    foobar{2,9}
    fooba[rz]{2}
    (foobar){2}
    ([01]\d)|(2[0-5])
    ([01]\d\d)|(2[0-4]\d)|(25[0-5])
    [A-C]{1,2}
    [A-C]{0,3}
    [A-C]\s[A-C]\s[A-C]
    [A-C]\s?[A-C][A-C]
    [A-C]\s([A-C][A-C])
    [A-C]\s([A-C][A-C])?
    [A-C]{2}\d{2}
    @|TH[12]
    @(@|TH[12])?
    @(@|TH[12]|AL[12]|SP[123]|TB(1[0-9]?|20?|[3-9]))?
    @(@|TH[12]|AL[12]|SP[123]|TB(1[0-9]?|20?|[3-9])|OH(1[0-9]?|2[0-9]?|30?|[4-9]))?
    (([ECMP]|HA|AK)[SD]|HS)T
    [A-CV]{2}
    A[cglmrstu]|B[aehikr]?|C[adeflmorsu]?|D[bsy]|E[rsu]|F[emr]?|G[ade]|H[efgos]?|I[nr]?|Kr?|L[airu]|M[dgnot]|N[abdeiop]?|Os?|P[abdmortu]?|R[abefghnu]|S[bcegimnr]?|T[abcehilm]|Uu[bhopqst]|U|V|W|Xe|Yb?|Z[nr]
    (a|b)|(x|y)
    (a|b) (x|y)
    """.split('\n')

    for t in tests:
        t = t.strip()
        if not t: continue
        print '-'*50
        print t
        try:
            print count(invert(t))
            for s in invert(t):
                print s
        except ParseFatalException,pfe:
            print pfe.msg
            print
            continue
        print

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-04-09T11:47:14.513

在 Javascript 中：

```
SyntaxError 
```

当一个无效的正则表达式被传递给评估时抛出。

```
// VALID ONE
> /yes[^]*day/
Out: /yes[^]*day/

// INVALID ONE
> /yes[^*day/
Out: VM227:1 Uncaught SyntaxError: Invalid regular expression: missing / 
```

这是检查正则表达式字符串是否有效的函数：

第 1 步：正则表达式解析器

```
var RegexParser = function(input) {

    // Parse input
    var m = input.match(/(\/?)(.+)\1([a-z]*)/i);

    // Invalid flags
    if (m[3] && !/^(?!.*?(.).*?\1)[gmixXsuUAJ]+$/.test(m[3])) {
        return RegExp(input);
    }

    // Create the regular expression
    return new RegExp(m[2], m[3]);
}; 
```

第 2 步：使用解析器

```
var RegexString = "/yes.*day/"

var isRegexValid = input => {
 try {
 const regex = RegexParser(input);
 }
 catch(error) {
   if(error.name === "SyntaxError") 
    {
      return false;
    }
    else 
    {
     throw error;
    }
 }
 return true;
} 
```

# python - 您打算如何处理向 Python 3 的迁移？

> ID：172306
> 
> 赞同：52
> 
> 时间：2008-10-05T17:08:30.467
> 
> 标签：python, migration, python-3.x, python-2to3

考虑到 Python 3 即将问世，我确信这是大多数 Python 开发人员心中的一个主题。一些问题可以让我们朝着正确的方向前进：

1.  您是否将同时维护一个 python 2 和 python 3 版本，或者一旦完成，您将只拥有一个 python 3 版本？

    *   您是否已经开始或计划很快开始？还是你打算等到最终版本出来再全面展开？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-10-18T04:59:57.047

这是 Twisted 的总体计划。我本来打算在博客上写这个，但后来我想：既然我能得到*积分*，为什么还要写博客呢？

1.  **等到有人关心。**

    目前，没有人拥有 Python 3。在至少有一个实际用户站出来说“我需要 Python 3.0 支持”之前，我们不会花费大量精力，并且除了以下事实之外还有充分的理由3.0 看起来很闪亮。

2.  **等到我们的依赖项迁移完毕。**

    像 Twisted 这样的大型系统有许多依赖项。首先，我们的包括：

    *   [Zope界面](http://www.zope.org/Products/%5AopeInterface)
    *   [PyCrypto](http://www.dlitz.net/software/pycrypto/)
    *   [PyOpenSSL](https://launchpad.net/pyopenssl/)
    *   [pywin32](http://sourceforge.net/projects/pywin32/)
    *   [PyGTK](http://www.pygtk.org/)（虽然现在这种依赖关系很轻，但当迁移开始时，我希望 Twisted 会有更多的 GUI 工具）
    *   [pyasn1](http://pyasn1.sourceforge.net/)
    *   [PyPAM](http://www.pangalactic.org/PyPAM/)
    *   [gmpy](http://gmpy.sourceforge.net/)

    其中一些项目有自己的依赖数组，所以我们也必须等待这些。

3.  **等到有人足够关心*来帮助*。**

    慈善地，有 5 个人在 Twisted 上工作——我说“慈善地”是因为我也算在内，而且我已经好几个月没有承诺了。我们现在有[1000 多张开放票](http://twistedmatrix.com/trac/report/1)，如果能真正修复其中的一些——修复错误、添加功能，并通常让 Twisted 本身成为一个更好的产品——然后花时间将其移植到实质性的新版本的语言。

    这可能包括[赞助商](http://twistedmatrix.com/trac/wiki/TwistedSoftwareFoundation)足够关心我们来支付费用，但我希望会有大量关心 3.0 支持并希望帮助推动社区向前发展的志愿者涌入。

4.  **听从圭多的建议。**

    这意味着***[我们不会不兼容地更改我们的 API](http://www.artima.com/weblogs/viewpost.jsp?thread=227041)***，并且我们将遵循Guido 去年发布的[过渡性开发指南。](http://www.artima.com/weblogs/viewpost.jsp?thread=208549)首先是进行单元测试，并在 Twisted 代码库上运行[2to3 转换工具。](http://docs.python.org/library/2to3.html)

5.  **报告针对 2to3 工具的错误和文件补丁**。

    当我们到达实际使用它的地步时，我预计`2to3`将来运行会出现很多问题。现在在 Twisted 上运行它需要很长时间，而且（上次我检查过，那是很久以前的事了）无法解析 Twisted 存储库中的一些文件，因此结果输出不会导入。我认为必须有大量来自小型项目的成功案例，并且在该工具真正为我们工作之前进行大量的锤击。

    但是，Python 开发团队在响应我们的错误报告方面非常有帮助，并且对这些问题的早期响应令人鼓舞，因此我希望所有这些问题都能及时得到修复。

6.  **保持 2.x 兼容性数年。**

    目前，Twisted 支持 python 2.3 到 2.5。目前，我们正在努力支持 2.6（我们显然必须在 3.0 之前完成！）。我们的计划是根据长期支持的[Ubuntu](http://en.wikipedia.org/wiki/Ubuntu)版本修改我们支持的 Python 版本- 包括 Python 2.5 在内的 8.04 版将支持到 2013 年。根据 Guido 的建议，我们需要放弃对 2.5 的支持支持 3.0，但我希望我们能找到解决方法（我们在版本兼容性黑客方面很有创意）。

    因此，我们计划至少在 2013 年之前支持 Python 2.5。两年后，Ubuntu 将发布另一个长期支持的 Ubuntu 版本：如果它们仍然存在并按计划进行，那将是 10.04。我个人猜测这将与 Python 2.x，也许是 python 2.8 一起提供`/usr/bin/python`，因为有大量的 Python 软件与发行版一起打包，并且需要很长时间才能全部更新。*因此，从那时*起五年后，即 2015 年，我们可以开始考虑放弃 2.x 支持。

    在此期间，我们将继续遵循 Guido 关于迁移的建议：在我们的 2.x 代码库上运行 2to3，并修改 2.x 代码库以使其测试在两个版本中都能通过。

    这样做的结果是，直到我 35 岁生日之后，Python 3.x 才会成为 Twisted 的*源*语言——它将成为我的 python 2.x 代码的目标运行时（以及一组准则和限制）。我希望在接下来的十年左右使用 Python 2.x 编写程序。

所以，这就是计划。我希望它在一年左右的时间里看起来保守得可笑。3.x 过渡很容易，每个人都快速升级。其他事情也可能发生：2.x 和 3.x 分支可能会聚，有人最终可能会编写一个`3to2`，或者另一个运行时（想到 PyPy）可能允许同时运行 2.x 和 3.x 代码直接处理，使我们的转换过程更容易。

然而，就目前而言，我们假设，多年来，我们将拥有他们正在维护的大型代码库的人（或者编写新代码的人想要使用尚未迁移的*其他*库）仍然想要Twisted 中的新功能和错误修复。很快我希望我们也会有希望在 python 3 上使用 Twisted 的前沿用户。我想尽可能长时间地为所有这些人提供积极的体验。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-26T22:00:41.660

Django 项目使用该库[`six`](http://packages.python.org/six)来维护可同时在 Python 2*和*Python 3 上运行的代码库（[博客文章](https://www.djangoproject.com/weblog/2012/aug/19/experimental-python-3-support/)）。

`six`通过提供一个兼容层来实现这一点，该层智能地将导入和函数重定向到它们各自的位置（以及统一其他不兼容的更改）。

### 明显优势：

*   Python 2 和 Python 3 不需要单独的分支
*   没有转换工具，例如 2to3。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-05T17:50:42.067

2.6 的主要思想是提供到 3.0 的迁移路径。因此，您可以`from __future__ import X`一次缓慢地迁移一项功能，直到确定所有功能并可以迁移到 3.0。3.0 的许多功能也将流入 2.6，因此您可以逐渐缩小语言差距，而不必一次性迁移所有内容。

在工作中，我们计划先从 2.5 升级到 2.6。然后我们开始慢慢启用 3.0 功能，一次一个模块。在某个时候，系统的整个子部分可能会为 3.x 做好准备。

唯一的问题是图书馆。如果一个库永远不会迁移，我们就会被旧库困住。但我非常有信心，我们会在适当的时候为这部分找到一个很好的替代方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-05T17:14:15.727

作为图书馆作者发言：

我正在等待最终版本的发布。与大多数 Python 社区一样，我的信念是 2.x 将在数周或数月内继续成为主导版本。有足够的时间来发布一个漂亮的、经过优化的 3.x 版本。

我将维护单独的 2.x 和 3.x 分支。2.x 将向后兼容 2.4，所以我不能在 2.6 / 3.0 中使用很多花哨的语法或新功能。相比之下，3.x 分支将使用这些特性中的每一个，从而为用户带来更好的体验。测试套件将被修改，以便 2to3 可以使用它，我将为两个分支维护相同的测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-06-04T21:32:10.560

## **两者都支持**

我想尝试将 BeautifulSoup 库转换为我正在处理的项目的 3x，但我可以看到维护两个不同的代码分支是多么痛苦。

当前处理此问题的模型包括：

1.  更改 2x 分支
2.  运行 2to3
3.  祈祷它第一次正确地进行转换
4.  运行代码
5.  运行单元测试以验证一切正常
6.  将输出复制到 3x 分支

这个模型有效，但恕我直言，它很糟糕。对于每次更改/发布，您都必须完成这些步骤 ::sigh::。此外，它不鼓励开发人员使用只能在 py3k 中支持的新功能扩展 3x 分支，因为您基本上仍然将所有代码定位到 2x。

**解决方案...使用预处理器**

因为我找不到一个像样的带有#define 和#ifdef 指令的python 预处理器，所以我写了一个。

它被称为[pypreprocessor，可以在 PYPI 中找到](http://pypi.python.org/pypi?:action=search&term=pypreprocessor&submit=search)

本质上，您所做的是：

1.  导入pypreprocessor
2.  检测脚本在哪个版本的 python 中运行
3.  在预处理器中为版本设置“定义”（例如“python2”或“python3”）
4.  在代码特定于版本的地方撒上 '#ifdef python2' 和 '#ifdef python3' 指令
5.  运行代码

就是这样。现在它可以在 2x 和 3x 下工作。如果您担心运行预处理器会增加性能损失，那么还有一种模式可以去除所有元数据并将后处理的源输出到文件中。

**最重要的是……您只需进行一次 2to3 转换。**

这是一个工作示例：

```
#!/usr/bin/env python
# py2and3.py

import sys
from pypreprocessor import pypreprocessor

#exclude
if sys.version[:3].split('.')[0] == '2':
    pypreprocessor.defines.append('python2')
if sys.version[:3].split('.')[0] == '3':
    pypreprocessor.defines.append('python3')

pypreprocessor.parse()
#endexclude
#ifdef python2
print('You are using Python 2x')
#ifdef python3
print('You are using python 3x')
#else
print('Python version not supported')
#endif 
```

这些是终端中的结果：

```
python py2and3.py
 >>>你正在使用 Python 2x
 python3 py2and3.py
 >>>你正在使用 python 3x

```

如果要输出到文件并制作没有额外元数据的干净的特定于版本的源文件，请在 pypreprocessor.parse() 语句之前的某处添加这两行：

```
pypreprocessor.output = outputFileName.py
pypreprocessor.removeMeta = True 
```

然后：

```
python py2and3.py

```

将创建一个名为 outputFileName.py 的文件，该文件是特定于 python 2x 的，没有额外的元数据。

```
python3 py2and3.py

```

将创建一个名为 outputFileName.py 的文件，该文件是 python 3x 特定的，没有额外的元数据。

有关文档和更多示例，请参阅[GoogleCode 上的 pypreprocessor](http://code.google.com/p/pypreprocessor/)。

我真诚地希望这会有所帮助。我喜欢用 python 编写代码，我希望尽快看到支持进展到 3x 领域。我讨厌看到语言没有进步。尤其是，由于 3x 版本解决了许多特色 WTF，并使语法看起来对从其他语言迁移的用户更友好。

此时的文档是完整的，但并不广泛。我会尽快为 wiki 提供一些更广泛的信息。

**更新：**

**虽然我专门设计了 pypreprocessor 来解决这个问题，但它不起作用，因为词法分析器在执行任何代码之前会对所有代码进行语法检查。**

**如果 python 有真正的 C 预处理器指令支持，它将允许开发人员在同一个文件中同时编写 python2x 和 python3k 代码，但由于 C 预处理器的坏名声（滥用宏替换来更改语言关键字）我不很快就会看到合法的 C 预处理器支持被添加到 python 中。**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-16T11:22:43.557

Zope Toolkit 对 Python 3 的支持进展缓慢。慢主要是因为许多这些库非常复杂。

对于大多数图书馆，我使用 2to3。一些库不需要它，因为它们很简单，或者大部分代码都在 C 扩展中。zc.buildout 是一个相关的包，将在没有 2to3 的情况下运行相同的代码以支持 Python 2 和 3。

我们将 ZTK 移植到 Python 3 是因为许多其他库和框架都依赖于它，例如 Twisted 和 Pyramid 框架。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T13:32:52.663

我的一些更复杂的 2.x 代码将保持在 2.5 或 2.6。一旦我经常使用的一些第 3 方库更新为 3，我将转向 3.0 进行所有新开发。

# c - C 中的 Solaris 时区（strftime 上缺少 %z）

> ID：172318
> 
> 赞同：1
> 
> 时间：2008-10-05T17:18:05.750
> 
> 标签：c, solaris, strftime

我有一个应用程序写入另一个应用程序，需要提供系统的日期+时区。我一直在使用带有`%z`参数的 strftime 来获取时区，并且它在 Linux 上运行良好。然而，上周我们决定将它合并到 solaris 只是为了发现它`%z`不存在。

有人建议使用`%Z`，它会给出时区名称，但我需要 %z ，它给出具有偏移格式的时区，比如`+0100`or `-0300`。

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T17:25:22.600

%z 不是 POSIX。您必须通过查找 localtime 和 gmtime 之间的差异来自己计算偏移量。

有关 Perl 示例，[请参见此处](http://www.nntp.perl.org/group/perl.beginners/2003/01/msg39201.html)。

# c# - 相同的类，不同的命名空间，一种简化的方法？

> ID：172320
> 
> 赞同：3
> 
> 时间：2008-10-05T17:21:53.373
> 
> 标签：c#, namespaces

我正在使用一个跨两个命名空间提供几乎重复代码的 Web 服务。例如 PigFeet 和 HorseFeet，这两个命名空间都包含一个 Feet 类，而与 Feet 类一起使用的其他代码要求它是同一个命名空间的一部分。

现在在我的代码中，我被迫做这样的事情：

```
if( _animalType == AnimalType.Pig )
{ 
     //namespace is pigfeet
     PigFeet.Feet feet = new Feet();
     feet.WashFeet();
}

if( _animalType == AnimalType.Horse )
{
     //namespace is horsefeet
     HorseFeet.Feet feet = new Feet();
     feet.WashFeet();
 } 
```

这给我留下了很多重复的代码。有没有办法更动态地选择命名空间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T17:25:26.860

在命名空间导入中，您可以为特定命名空间或成员分配[别名。](http://msdn.microsoft.com/en-us/library/aa664765(VS.71).aspx)

```
using PigFeet = PigFeet.Feet;
using HorseFeet = HorseFeet.Feet;

//now your sample code should look something like

if( _animalType == AnimalType.Pig )
{ 
     //namespace is pigfeet
     PigFeet feet = new PigFeet();
     feet.WashFeet();
}

if( _animalType == AnimalType.Horse )
{
     //namespace is horsefeet
     HorseFeet feet = new HorseFeet();
     feet.WashFeet();
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T18:07:00.083

命名空间不是问题——只是这两个类不相关，因此没有可用于多态性的继承链。

您将需要查看诸如[鸭子类型](http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx)或[适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)之类的东西，或者构建您自己的代理类以使自己获得一个通用接口。对于少量的实现，我只是构建了一个适配器类，它委托给它拥有的任何非空实例：

```
interface IFeet {
   void WashFeet();
}

class FeetAdapter : IFeet {
   private PigFeet.Feet _pigFeet;
   private HorseFeet.Feet _horseFeet;

   private FeetAdapter(PigFeet.Feet pigFeet) {
      _pigFeet = pigFeet;
   }

   private FeetAdapter(HorseFeet.Feet horseFeet) {
      _horseFeet = horseFeet;
   }

   public void WashFeet() {
      if (_pigFeet != null) {
         _pigFeet.WashFeet();
      } else {
         _horseFeet.WashFeet();
      }
   }

   public static FeetAdapter Create(AnimalType animalType) {
      switch (animalType) {
         case AnimalType.Pig:
            return new FeetAdapter(new PigFeet.Feet());
         case AnimalType.Horse:
            return new FeetAdapter(new HorseFeet.Feet());
      }
   }
} 
```

对于较大的情况，最好使用一个单独的 PigFeetAdapter 和 HorseFeetAdapter，它们都实现了 IFeet，以及一个 FeetAdapterFactory 来创建它们——但这个概念和我上面展示的一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T17:54:28.157

命名空间只是组织类型的一种方式。在您的情况下，您有 2 个或更多不同的类，它们的方法具有相同的签名但没有通用接口。如果您无法更改类的代码，避免重复的唯一方法是在失去编译时类型安全的同时使用反射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T18:20:22.693

这是我在让事情变得更好之前让事情变得更糟。

您可以将所有 AnimalType 决策逻辑封装在一个类中。

在这两种类型（PigsFeet 和 HorseFeet）之间，有一些类似的方法……因为 WashFeet 有一个共同的签名（没有参数的 void），可以使用 System.Action 来引用该方法。其他具有通用签名（和参数）的方法可能需要 System.Func(T)。其他没有共同签名的方法可能需要强制转换为共同签名。

这是客户端代码：

```
AnimalFeetFacade myFacade = new AnimalFeetFacade(_animalType);
myFacade.WashFeet(); 
```

这是封装类。

```
public class AnimalFeetFacade
{
  public AnimalFeetFacade(AnimalType theType)
  {
    if (theType == AnimalType.Pig)
    {
      _washFeet = WashPigFeet;
      //TODO reference more PigFeet methods here
    }
    else if (theType == AnimalType.Horse)
    {
       _washFeet = WashHorseFeet;
       //TODO reference more HorseFeet methods here
    }
    else
    {
       throw new NotImplementedException("AnimalFeetFacade only works with PigFeet and HorseFeet");
    }
  }

  protected Action _washFeet;

  public void WashFeet()
  {
    _washFeet.Invoke();
  }

  protected void WashPigFeet()
  {
    PigFeet.Feet = new PigFeet.Feet()
    feet.WashFeet()
  } 

  protected void WashHorseFeet()
  {
    HorseFeet.Feet = new HorseFeet.Feet()
    feet.WashFeet()
  }
} 
```

# .net - 你如何在 Mono 中进行 ALSA？

> ID：172321
> 
> 赞同：3
> 
> 时间：2008-10-05T17:24:55.923
> 
> 标签：.net, linux, mono, ffi, alsa

有谁知道如何在 Linux 中使用 Mono 访问 ALSA（低级音频 API）？

注意：我希望使用 PInvoke 访问 ALSA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T17:30:21.157

我相信 Mono 没有任何绑定。您可以查看 Python ALSA 绑定和 Mono D-BUS 绑定并尝试构建自己的绑定。

但是，只使用 GStreamer 可能会更好、更容易。Mono GStreamer 绑定成熟且运行良好。

# linux - Blackbox type data logging

> ID：172343
> 
> 赞同：3
> 
> 时间：2008-10-05T17:43:28.320
> 
> 标签：linux, logging, embedded, filesystems, corruption

In a Linux embedded application I'm developing, there is the need to record some events that happen from time to time. These records are saved on a MTD flash device and once written there is no need to change them or do efficient searches, but read access is required to show the data back to the user. A big problem is that power can go away at any time, without a proper shutdown sequence. The frequency these events occur can be very slow (days/weeks), but several of them will occur at once. The data to be saved for each event is strongly typed: date, time, a couple of short text strings and several integers.

Currently I inherited a solution based on jffs2 and SQLite that is far from optimal because the DB file sometimes get corrupted. When this happens the whole file gets unreadable and there is no way to understand if it was caused by a bug in jffs2, or in SQLite or if the flash sector was bad, or if the power was cut at the wrong time.

Is there a library or a combination of filesystem/library that can better help me solve this kind of problem ? Or should I just use a text file with a CSV-like format ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T17:55:33.897

I'm not expert on embeded systems, but I would think that a CSV would probably be best. It basically can't be corrupted, or if it does, then you can easily see the error and fix it manually (new line or just removing a line). I have been working on receiving the data from an embeded system where they have a lot of corruption problems (partially on the system and partially during the phone line transfer). It would be very helpful if it were in a CSV type format so we could find the errors and remove or fix them instead of corrupting the entire data set.

If you aren't needing to search within the system, then a CSV works perfectly.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T18:50:30.853

There is a number of embedded file systems (not fat compatible) that designed exactly for this purpose. I can't suggest since never used one, but [here](http://www.datalight.com/) something from google. I'm sure you can dig more, and hopefully somebody here can provide more info, may be there is something GPL based. Comparison of different file systems are [here](http://en.wikipedia.org/wiki/Comparison_of_file_systems)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T23:24:25.853

We are using plain old syslogd to a YAFFS2 partition on NAND flash, it appears to work well: when messages are sent to the logger and power is removed immediately after (<100ms) the message is there and the log never appears to corrupt.

This is based on observation rather than my explicitly knowing that everything will always be consistent by design, mind.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T03:59:40.387

Two csv/text files. Start a new pair each time the system restarts. Write each event to the first file, flush the file to store, write the record to the second file, then flush again.

This way, if you crash during the first write all the data in the second copy (up until that write) will still be there.

Make sure the flush is a full file system flush and not just the clib buffer flush.

Maybe also place the files on separate file systems. Reserving space ahead of what you need could also help speed up the process.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T02:20:01.687

What facilities are available to you? The best option is often to **log to an external resource,** for example via syslog, SNMP, raw socket, or serial port. This protects you logs from unpleasantries on the device itself.

If you need to store logs internally, I've found plaintext, human-readable files to be the best option in embedded devices. The "write/flush" cycle is fast, no tools are needed to maintain them, and you can monitor them in real-time. If file size is a problem, you can timestamp with an integer rather than formatted text, and you can use a numeric "Event ID" to abbreviate each log (leave only the instance-specific data as text).

# c# - 如何使用 C# 按下一个键并释放它？

> ID：172353
> 
> 赞同：8
> 
> 时间：2008-10-05T17:52:03.903
> 
> 标签：c#, keyboard

我正在编写一个 C# 程序，它从外部设备捕获信号，并将击键发送到另一个应用程序。我正在使用 SendKeys，它工作正常。

SendKeys 通过立即按住并释放它来“按下”一个键。我想让它按一下键并随意释放它。

我的问题是：“有没有办法向键发送“推”信号，然后在一定时间后发出“释放”信号？

我不确定 SendKeys 是否能够做到这一点。有什么线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T18:11:45.003

我认为不可能直接从.NET 中您可以尝试通过 p/invoking 此处描述的函数来使用 keybd_event 本机调用：http: [//pinvoke.net/default.aspx/user32.keybd_event](http://pinvoke.net/default.aspx/user32.keybd_event)

keybd_event 的 MSDN 在这里：http: [//msdn.microsoft.com/en-us/library/ms646304 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms646304(VS.85).aspx)

希望有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-01T02:01:10.567

接受的答案使用`keybd_event`已弃用。官方 API 现在是[`SendInput`](http://msdn.microsoft.com/en-us/library/ms646310%28VS.85%29.aspx). 在[http://inputsimulator.codeplex.com](http://inputsimulator.codeplex.com)也有一个很好的包装器。

然而，以上都没有完全迎合“钥匙持有”的情况。这是因为持有一个密钥会生成多`WM_KEYDOWN`条消息，然后`WM_KEYUP`在释放时生成一条消息（您可以使用 Spy++ 进行检查）。

消息的频率`WM_KEYDOWN`取决于硬件、BIOS 设置和一些 Windows 设置：[`KeyboardDelay`](http://technet.microsoft.com/en-us/library/cc978658.aspx)和[`KeyboardSpeed`](http://technet.microsoft.com/en-us/library/cc978659.aspx). 后者可从 Windows 窗体 ( [`SystemInformation.KeyboardDelay`](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.keyboarddelay.aspx), [`SystemInformation.KeyboardSpeed`](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.keyboardspeed.aspx)) 访问。

使用前面提到的输入模拟器库，我实现了一个模拟实际行为的键持有方法。它已`await/async`准备就绪，并支持取消。

```
static Task SimulateKeyHold(VirtualKeyCode key, int holdDurationMs, 
                            int repeatDelayMs, int repeatRateMs, CancellationToken token)
{
    var tcs = new TaskCompletionSource<object>();
    var ctr = new CancellationTokenRegistration();
    var startCount = Environment.TickCount;
    Timer timer = null;
    timer = new Timer(s =>         
    {
        lock (timer)
        {
            if (Environment.TickCount - startCount <= holdDurationMs)
                InputSimulator.SimulateKeyDown(key);
            else if (startCount != -1)
            { 
                startCount = -1; 
                timer.Dispose();
                ctr.Dispose();                    
                InputSimulator.SimulateKeyUp(key);
                tcs.TrySetResult(null);
            }
        }
    });
    timer.Change(repeatDelayMs, repeatRateMs);

    if (token.CanBeCanceled)
        ctr = token.Register(() =>
                       {
                           timer.Dispose();
                           tcs.TrySetCanceled();
                       });
    return tcs.Task;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-05T18:22:55.590

您可以使用 SendInput 或 keyb_event，它们都是原生 API 函数。SendInput 比 keybd_event 有一些优势，但 SendInput 仅从 XP 开始可用。

这是 msdn 链接 [http://msdn.microsoft.com/en-us/library/ms646310.aspx](http://msdn.microsoft.com/en-us/library/ms646310.aspx)

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T02:36:58.073

我曾经想在 powerpoint 上做同样的事情，隐藏光标，然后停止幻灯片。但这既困难又棘手，因为 powerpoint 中出现了许多顶级窗口，而且如果它不起作用，也很难确定仿真的哪个部分失败。使用 Spy++ 查看消息队列后，我注意到加速器命令是在按键之后发送的，所以我模拟了加速器命令，它的工作原理就像魅力一样。所以你可能想研究这样的替代方案。

# javascript - 是否可以只打印画布元素？

> ID：172365
> 
> 赞同：2
> 
> 时间：2008-10-05T18:04:24.317
> 
> 标签：javascript, printing, canvas

我创建了一个网页，让您输入一些信息，然后根据该信息在画布元素中绘制图像。除了打印之外，我几乎可以按照我想要的方式工作。

有没有办法打印出画布元素或创建一个新的窗口来绘制，这是唯一的方法吗？

更新：

答案很简单。我在想一个更复杂的解决方案。

我希望我可以选择超过 1 个答案。当我使用 * 禁用显示时，我无法打印画布。最简单的解决方案是关闭我用于输入的表单，在@media print{} 内的 CSS 中使用表单 {display:none;}。感谢您及时的回复。

```
 @media print {
           form {
         display:none;
       }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T18:10:58.233

你可以尝试这样的事情：

```
@media print {
  * {
    display:none;
  }

  #SOME-CANVAS-ID {
    display:block;
  }
} 
```

我不确定画布是否默认是块状的，但你可以尝试一些类似的东西，看看它是否有效。这个想法是它将隐藏打印媒体的所有内容（*），只要规则的优先级更高（这就是我使用 ID 选择器的原因），除了一些其他任意元素。

编辑：如果 CSS3 （特别是[否定伪类](http://www.w3.org/TR/css3-selectors/#negation)）有更多的支持，你的规则可以像这样简单：

```
*:not(canvas) {
  display:none;
} 
```

但是，这可能会导致 <html> 和 <body> 标签被隐藏，从而有效地隐藏您的画布......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T18:10:34.523

我不能 100% 确定是否支持，但您可以使用 CSS 并`<link>`在`media="print"`. 在这个 CSS 文件中，只需隐藏您不想在打印时显示的元素：`display:none;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T15:19:20.423

您可以尝试创建仅用于打印的画布：

```
this.Print = function () {
    var printCanvas = $('#printCanvas');
    printCanvas.attr("width", mainCanvas.width);
    printCanvas.attr("height", mainCanvas.height);
    var printCanvasContext = printCanvas.get(0).getContext('2d');
    window.print();
} 
```

# .net - 跟踪与日志记录以及 log4net 如何适应？

> ID：172372
> 
> 赞同：50
> 
> 时间：2008-10-05T18:07:39.787
> 
> 标签：.net, logging, log4net, trace

我想知道日志记录和跟踪之间的区别是什么。

本质上的区别是跟踪是更详细的日志，为开发人员提供了在运行时调试应用程序的工具吗？

我一直在尝试使用 log4net 并进行日志记录。现在我想知道我是否也应该进行跟踪，以及我是否可以/应该为此目的使用 log4net。我应该使用 log4net 进行跟踪吗？log4net 记录器是否有一些跟踪级别？我应该使用不同的日志级别进行调试和跟踪，还是可以使用相同的日志级别？你能举一个简单的例子来说明我将如何为一个简单的方法进行日志记录和跟踪吗？

编辑：尽管下面有一些有用的答案，但我仍然不确定我应该如何进行跟踪与记录。

我的业务层中有以下方法，我想向它添加日志记录/跟踪。我想知道如何有效地做到这一点。以下方法在日志记录/跟踪方面是否可以接受？日志消息应该是 Info 类型而不是 Debug 类型吗？我正在记录的调试消息是否被视为跟踪？你会如何改变它？

```
 IEnumerable<Car> GetCars()
{
   try
   {
      logger.Debug("Getting cars");
      IEnumerable<Car> cars = CarAccessor.GetCars().ConvertAll(DataAccessToBusinessConverter);
      logger.Debug("Got total of " + cars.Count + " cars"); 
   } catch (Exception e) {
      logger.Error("Error when getting cars", e);
      throw new Exception("Unexpected error when getting cars");
   }
} 

```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-05T19:45:39.807

日志记录是记录信息的通用术语 - 跟踪是用于调试的日志记录的特定形式。

在 .NET 中，System.Diagnostics.Trace 和 System.Diagnostics.Debug 对象允许简单地记录到您可以在 app.config 中配置的许多“事件侦听器”。您还可以使用 TraceSwitches 来配置和过滤（例如，在错误和信息级别之间）。

```
private void TestMethod(string x)
{
    if(x.Length> 10)
    {
        Trace.Write("String was " + x.Length);
        throw new ArgumentException("String too long");
    }
} 
```

在 ASP.NET 中，有一个特殊版本的 Trace (System.Web.TraceContext) 将写入到 ASP 页或 Trace.axd 的底部。在 ASP.NET 2+ 中，还有一个更完整的日志框架，称为 Health Monitoring。

Log4Net 是一种比内置 Trace 甚至 ASP Health Monitoring 更丰富、更灵活的跟踪或日志记录方式。像 Diagnostics.Trace 一样，您可以在 config.Trace 中配置事件侦听器（“appenders”）。对于简单的跟踪，使用就像内置的 Trace 一样简单。使用 Log4Net 的决定是您是否有更复杂的要求。

```
private void TestMethod(string x)
{
    Log.Info("String length is " + x.Length);
    if(x.Length> 10)
    {
        Log.Error("String was " + x.Length);
        throw new ArgumentException("String too long");
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-05T19:33:23.153

IMO...

日志**不**应该设计用于开发调试（但它不可避免地会以这种方式使用）
日志应该设计用于*操作*监控和故障排除——这是它存在的理由。

跟踪应该设计用于开发调试和性能调整。如果在现场可用，它可以用于真正低级别的操作故障排除，但这不是它的主要目的

鉴于此，我过去见过（和设计/实施）的最成功的方法并*没有*结合两者在一起。最好将这两个工具分开，每个工具都尽可能地完成一项工作。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-05T19:18:24.527

log4net 非常适合两者。我们通过使用 DEBUG 日志级别来区分对发布后诊断有用的日志记录和用于开发目的的“跟踪”。具体来说，开发人员使用`Debug()`. 我们的开发配置将 Level 设置为 DEBUG：

```
<root>
        <level value="DEBUG" />
        ...
</root> 
```

在产品发布之前，级别更改为“INFO”：

```
<level value="INFO" /> 
```

这会从发布日志中删除所有 DEBUG 输出，但会保留 INFO/WARN/ERROR。

还有其他 log4net 工具，如过滤器、分层（按命名空间）日志记录、多个目标等，我们发现上述简单方法非常有效。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-07-21T10:58:58.673

[记录不是跟踪](http://geekswithblogs.net/akraus1/archive/2009/06/21/132968.aspx)。这两个应该是具有不同性能特征的不同库。事实上，我自己编写了一个[跟踪库](http://geekswithblogs.net/akraus1/archive/2010/07/04/140761.aspx)，具有独特的属性，当启用跟踪的方法出现异常时，它可以自动跟踪异常。除此之外，还可以[优雅地解决在](http://geekswithblogs.net/akraus1/archive/2010/07/19/141000.aspx)代码中特定位置触发异常的问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-05T18:26:26.330

我会说是的。记录是确定过去发生的事情的唯一方法 - 如果客户打电话说事情没有按预期发生，没有记录，你所能做的就是耸耸肩并尝试重现错误。有时这是不可能的（取决于软件的复杂性和对客户数据的依赖）。

还有一个审计日志的问题，可以编写一个日志文件，其中包含有关用户正在做什么的信息 - 因此您可以使用它来缩小调试问题的可能性，甚至验证用户的声明（如果您得到系统损坏的报告，xyz 没有发生，您可以查看日志以找出操作员未能启动进程，或者没有单击正确的选项使其工作）

然后是用于报告的日志记录，这是大多数人认为日志记录的用途。

如果您可以定制日志输出，则将所有内容放入日志中并减少或增加写入的数据量。如果您可以动态更改输出电平，那就完美了。

您可以使用任何写入日志的方式，但会遇到性能问题。我发现附加到文本文件是最好的、最便携的、最容易查看的，并且（非常重要的是）在需要时最容易检索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-05T18:10:27.610

记录！=调试

有时保留日志文件是解决客户端问题所必需的，它们证明了服务器端发生的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T06:07:40.690

此外，请考虑记录或跟踪哪些信息。对于敏感信息尤其如此。

例如，虽然通常可以记录错误说明

"用户 'X' 试图访问但由于密码错误而被拒绝",

记录错误说明是不行的

“用户‘X’试图访问但被拒绝，因为密码‘secret’不正确。”

将此类敏感信息写入跟踪文件*可能*是可以接受的（并在您要求客户/用户启用跟踪以在生产中进行扩展故障排除之前，通过“某种方式”警告客户/用户该事实）。但是对于日志记录，我始终将此类敏感信息作为**永远不会**写入的策略（即 log4net 中的 INFO 及以上级别）。

当然，这必须通过代码审查来强制执行和检查。

# kernel - 纳米内核和外内核有什么区别？

> ID：172388
> 
> 赞同：15
> 
> 时间：2008-10-05T18:21:28.587
> 
> 标签：kernel

我知道它们都应该很小，但是两者之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-05T18:43:36.890

**Exokernel**是**麻省理工学院的一个操作系统**（以及它的一类变体），它处理相对较少的硬件抽象。**在 exokernel 中，控制硬件（尤其是内存分配**）的低级职责通常留给开发人员。许多开发人员可能更愿意让操作系统承担更多此类低级任务的责任，因为大多数开发人员只是在编写应用程序。

exokernel 只是**将物理硬件资源分配给程序**。这允许程序使用库操作系统，这些操作系统被链接以提供一些 exokernel 没有提供的抽象。然后，开发人员可以在抽象模型之间进行选择，或者自行开发。给定应用程序，这可能具有很大的性能优势。如果你不知道自己在做什么，你也可以编写崩溃时会爆炸的程序。

大多数内核会将**物理硬件**资源抽象为某种**理论模型**。开发人员与此模型交互，该模型处理内部处理硬件的更精细点。

术语**超微**内核用于描述特定**类型的内核**。前缀“pico-”，或“nano-”，“micro-”通常表示内核的“大小”。**更大的内核**构建的功能更多，**处理更多的硬件抽象**。Nanokernels 是相对较小的内核，**提供硬件抽象**，但**缺乏系统服务**。现代微内核也缺乏系统服务，因此术语变得类比。

内核的**名称**通常源于产生一种新型内核的特定批次的研究，例如在卡内基梅隆大学开发的名为“Mach”的内核，它是现代“微内核”的第一个例子。

**旁注：** exokernel 的真正好处是选择。大多数时候，大量抽象意味着更少的灾难性错误。在某些应用程序中，您可能想要使用不同的抽象模型，或者您可能想要自己处理所有事情。如果我们想放弃特定项目的操作系统抽象，我们就必须删掉操作系统并为这项工作投入一块硬件。在 exokernel 的情况下，这不是必需的。我们可以直接“对金属”进行编程，但也可以随时选择在抽象模型中进行链接。这是一个非常强大的概念。

**旁注**：对于大多数应用程序开发人员来说，在如此低的级别上处理内存是不必要的。通常在内核之上构建了几层操作系统，您的应用程序将在操作系统的最高级别上运行。使用 javascript 编写代码时，您仍然处于更高的位置，可以与在操作系统上运行的应用程序中实现的模型交互，等等。寻址内存虽然不应该被忽略，但对开发人员来说可能意味着完全不同的东西谁在写这么高的抽象水平。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T04:14:49.063

我发现一个链接对于区分整体微内核和外内核非常有帮助。链接是--- [http://www.scribd.com/doc/174682128/Difference-between-monolithic-microkernel-and-exokernel](http://www.scribd.com/doc/174682128/Difference-between-monolithic-microkernel-and-exokernel)

# python - 使用什么对称密码来加密消息？

> ID：172392
> 
> 赞同：5
> 
> 时间：2008-10-05T18:23:19.677
> 
> 标签：python, security, encryption

我对加密一无所知。但我需要它。如何？

假设您有一个通过异步消息在网络上相互通信的节点系统。节点不维护有关其他节点的会话信息（这是设计限制）。

假设您想确保只有您的节点可以读取正在发送的消息。我相信加密是解决这个问题的方法。

由于节点不维护会话并且通信必须以无状态、无连接的方式工作，我猜测非对称加密被排除在外。

所以这就是我想做的事情：

*   消息作为 UDP 数据报发送
*   每条消息都包含一个时间戳以使消息不同（反重放攻击）
*   每条消息都使用共享秘密对称密钥加密并通过网络发送
*   另一端可以使用共享秘密对称密钥解密

密钥显然可以通过破坏任何单个节点来破坏。同时，在这种情况下，访问任何一个受感染的节点无论如何都会揭示所有有趣的信息，因此密钥不是最薄弱的环节。

我应该使用什么密码进行此加密？什么密钥长度？

我更喜欢使用[ezPyCrypto](http://www.freenet.org.nz/ezPyCrypto/)支持的东西。

假设，正如大多数人指出的那样，我使用 AES。我应该使用哪些模式？

我不知道如何用 ezPyCrypto 来做，[PyCrypto](http://www.dlitz.net/software/pycrypto/)似乎挂在主持人交换上，谷歌的[keyczar](http://www.keyczar.org/)没有解释如何设置 - 我担心如果我不*明白*，那么我会冒险引入不安全感。所以准系统会更好。[这家伙](http://www.josh-davis.org/pythonAES)声称在 python 中有一个很好的 AES 模块，但他也声称这是他的第一个 python 项目 - 尽管他可能比我更聪明，但也许他被绊倒了？

**编辑：**我将对 python 实现的搜索移至[另一个问题](https://stackoverflow.com/questions/172486/what-pure-python-library-to-use-for-aes-256-encryption)以停止破坏...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T15:24:37.257

> 我对加密一无所知。但我需要它。如何？

**危险！**如果您对密码学不太了解，请不要尝试自己实现它。密码学*很难正确*。除了实际破解密钥（这通常非常困难）之外，还有许多不同的方法可以破坏密码系统的安全性。

如果您只是对您的流数据进行加密，而没有仔细的密钥管理和对密码系统微妙之处的其他理解，您很可能会面临各种漏洞。例如，您描述的方案将容易受到[中间人攻击](http://wikipedia.org/wiki/Man-in-the-middle_attack)，而没有针对节点之间的密钥分配的特定计划，并且可能容易受到[选择明文](http://wikipedia.org/wiki/Chosen-plaintext_attack)和/或[已知明文攻击](http://wikipedia.org/wiki/Known-plaintext_attack)，具体取决于您的分布方式系统与外界通信，以及密码和[操作模式](http://wikipedia.org/wiki/Block_cipher_mode)的准确选择。

所以......在安全使用它之前，你必须阅读一般的加密货币。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-05T18:52:23.160

您首先想到的应该是通道安全性——SSL/TLS 或 IPSec。
诚然，这两者都有一定的设置开销，IPSec 比 SSL/TLS 更多，尤其是在 PKI 等方面 - 但它在开发的简单性、可靠性、安全性等方面为自己付出了更多。只要确保您使用适合协议的强密码套件即可。

如果 SSL/TLS 或 IPSec 都不适合您的场景/环境，那么您的下一个选择应该是[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)（又名 Rijndael）。
如果您愿意，可以使用至少 256 位长的密钥。
密钥应该由加密安全的随机数生成器（而不是简单的 rnd() 调用）随机生成。
将密码模式设置为[CBC](http://en.wikipedia.org/wiki/Cipher_block_chaining)。
使用 PKCS7 填充。
生成一个唯一的、加密随机初始化向量 (IV)。不要忘记正确保护和管理您的密钥，并可能考虑定期密钥轮换。

根据您的数据，您可能还希望实现键控散列，以提供消息完整性 - 使用[SHA-256](http://en.wikipedia.org/wiki/SHA-256)进行散列。

在极少数情况下，您可能想要使用流密码，但这通常更复杂，我建议您在第一次使用时避免使用它。

现在，我不熟悉 ezpycrypto（或者说真的是一般的 python），并且不能真正声明它支持所有这些；但是这里的所有内容都是非常标准的并且推荐的最佳实践，如果您的加密库不支持它，我建议找到一个支持它的;-)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-05T18:46:12.920

假设使用对称加密，那么 AES 应该是您的默认选择，除非您有充分的理由选择其他方式。

选择 AES 进行了一场漫长而激烈的竞争，最终获胜者是经过精心挑选的。甚至加密货币之神 Bruce Schneier 也表示，AES 获胜者是比他提交给比赛的算法（TwoFish）更好的选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-05T18:39:01.547

AES 256 通常是首选，但根据您的位置（或您客户的位置），您可能会受到法律限制，并且将被迫使用更弱的东西。

另请注意，您应该为每次通信使用随机 IV 并将其与消息一起传递（这也将节省对时间戳的需求）。

如果可能，尽量不要依赖算法，并将算法与消息一起传递。然后节点将查看标头，并决定将用于解密的算法。这样，当某个部署需要它时，您可以轻松地切换算法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T18:26:22.680

我可能会选择[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard#Implementations)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-05T18:42:31.040

非对称加密也适用于这种情况。只需让每个节点发布它的公钥。任何想要与该节点通信的节点只需要使用该节点的公钥加密消息。使用非对称密钥的一个优点是更容易更改和分发密钥——因为公钥可以公开分发，每个节点只需要更新它的公钥-私钥对并重新发布。您不需要整个网络（或每个节点对）的某些协议来就新的对称密钥达成一致。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-05T18:49:11.463

为什么不在必须安全通信的节点之间创建一个 VPN？

然后，您不必费心编写自己的安全解决方案，并且您不限于静态的共享密钥（如果泄露，将允许在事后解密所有捕获的流量）。

# linq - 如何使用 LINQ 获取 IQueryable 中每一列的最大数据大小

> ID：172393
> 
> 赞同：0
> 
> 时间：2008-10-05T18:23:21.050
> 
> 标签：linq, linq-to-objects

我有一个采用 IQueryable 的方法。是否有一个 LINQ 查询可以返回 IQueryable 中每一列的大小？

更清楚地说：这是 Linq-to-objects。我想获取每个“列”的 ToString() 的长度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T18:34:24.787

这取决于。如果您的意思是是否有一种完全通用的方法来做出此决定，答案是否定的。所有 IQueryable 将允许访问的是每个表达式的类型。无法将 Type 任意映射到列大小。

另一方面，如果您能够将类型映射到成员并将成员类型映射到列大小，那么是的，有一种方法可以获取大小。

```
 public IEnumerable GetColumnSize(IQueryable source)
{
  var types = MapTypeToMembers(source).Select(x => x.Type);
  return types.Select(x => MapTypeToSize(x));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T18:56:02.403

我猜你说的是LINQ-to-SQL。它完全忽略了列大小。varchar(15)、char(20) 和 nvarchar(max) 只是它的字符串。溢出错误只会出现在 SQL Server 端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T22:42:06.687

您对每个“列”说，这将映射到每个属性。在 Linq to Objects 中，这应该可以工作，尽管过于手动：

```
var lengths = from o in myObjectCollection
              select new 
              {
                 PropertyLength1 = o.Property1.ToString().Length,
                 PropertyLength2 = o.Property2.ToString().Length,
                 ...
              } 
```

如果您的意思是集合中每个项目（“行”）的 ToString() 长度，那么：

```
var lengths = from o in myObjectCollection
              select o.ToString().Length; 
```

# networking - 您在生产中使用什么负载平衡系统？你怎么看呢？

> ID：172394
> 
> 赞同：10
> 
> 时间：2008-10-05T18:23:51.813
> 
> 标签：networking, load-balancing, production

有很多不同的系统可以在生产服务器（不仅仅是 Web 服务器）中平衡负载和实现冗余

*   循环 DNS
*   Linux 虚拟服务器
*   思科本地总监
*   F5 大IP
*   视窗 NLB
*   ETC？

如果您在生产中使用其中一种（或另一种），是哪一种？它对你有多好？你评价过别人吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-26T00:32:14.120

[HAProxy](http://haproxy.1wt.eu/)是一个优秀的软件负载均衡器；易于配置、高度可定制且性能极佳（它可以[使 10Gb NIC 饱和](http://haproxy.1wt.eu/10g.html)）。

使 HAProxy 非常适合我们的主要功能：

*   轻松定义不同的流量类型，并路由到正确的服务器池
*   极高的可靠性：我在 9 个月内没有崩溃过，而且还在不断增加
*   资源使用率低：几乎没有在 CPU 上注册，所有（小）I/O 负载都来自日志记录
*   高度灵活：各种平衡、会话粘性和故障转移算法

HAProxy 唯一令人讨厌的是配置文件。没有方便的方式以编程方式更改服务器的配置，并且有一个学习曲线来理解各种选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-05T18:36:51.083

对于我们使用的 apache 进程（d）：[http](http://www.f5.com/products/big-ip/) ://www.f5.com/products/big-ip/ 这似乎是行业标准。我想这一切都取决于你付出了多少，以及你的负载平衡。

例如 Websphere 可以这样做：

大 IP -> Apache 1 -> WebSphere 1

大 IP -> Apache 2 -> WebSphere 2

或者你可以穿过它：

大 ip -> Apache 1 -> WebSphere 1 & 2（循环）

大 ip -> Apache 2 -> WebSphere 2 & 1（循环）

我们使用了后者，并且效果很好。注意一台主机失败的情况：在大多数情况下，如果它只是超时，您将丢失该请求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-05T20:39:12.960

我用过[LVS](http://www.linuxvirtualserver.org/)，发现它的维护成本很低。在一个附带项目中，我为一个刚刚平衡 3 个网络服务器的站点尝试了[haproxy](http://haproxy.1wt.eu/)。像魅力一样工作，并且非常容易配置 - 强烈推荐。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-18T13:30:58.250

37signals 的 Mark Imbriaco 创建了一个简短的截屏视频，展示了他的公司如何使用 HAproxy 进行 Rails 负载平衡：

[http://www.37signals.com/svn/posts/1073-nuts-bolts-haproxy](http://www.37signals.com/svn/posts/1073-nuts-bolts-haproxy)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-05T18:30:02.127

将[Ultramonkey](http://www.ultramonkey.org/)添加到列表中。

我们只倾向于使用 DB 来实现冗余，Oracle Dataguard 运行良好，但设置起来很复杂。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-29T23:28:10.633

我们正在使用[coyotepoint](http://www.coyotepoint.com/products/e250.php)的[E250si](http://www.coyotepoint.com/)。

我们选择这个特定负载均衡器的原因

*   我们想要一个交钥匙解决方案，这块硬件就是。
*   价格（我们在 eBay 上使用了一年的支持）。
*   基于 Web 的界面 - 非常易于使用（例如设置集群、停顿服务器、故障排除、统计...），即使您不是系统管理员。
*   与公司的半私人关系（或者更确切地说，与当时为他们工作的人）。
*   基于 FreeBSD - 我们几乎完全运行 FreeBSD，我更喜欢不向堆栈添加另一种技术的解决方案。

要添加的一件事是，即使负载均衡器只有四个物理端口，您也可以通过将交换机连接到您的一个物理端口来启用更多端口 - 并由此扩展

这个负载均衡器没什么好说的。这对我们来说很好，并且已经运行了 10 个月左右而没有重新启动和任何问题。每当服务器出现故障时，它就会立即停止轮换。没有那么多我可以抱怨的。

最初有一些东西需要使用，如果我不得不考虑弱点，只会想到两个：

*   当您处理超过 4 mbit/s 的传入时，它可能会有点慢 - 当您启用粘性等功能时，它真的非常慢。我们通常以 5-6 mbit/s 的速度达到峰值，但是因为我们禁用了粘性、服务器代理、探测并使用了非常基本的轮询策略，所以一切都很好。
*   Web 界面使用 JavaScript/ajax 来显示部分内容——这些都是相当多的错误，尽管一个 sales@ 人员告诉我，如果我们进行软件更新，它们就会得到解决。

总而言之，E250si 为我们节省了所有配置和维护另一台服务器等。但是因为我听说了很多关于 HAproxy 和 磅的好东西，我们可能迟早会朝这个方向迁移。如果我走软件路线，我会非常挑剔我放入服务器的组件 - 例如主板，网卡等。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-05T20:31:52.833

我在一个小型网站上使用了一个低端[Coyote Point负载均衡器。](http://www.coyotepoint.com/)我发现设置直观，产品稳定且易于使用。

我相信他们的产品是 BSD 的[relayd](http://www.openbsd.org/cgi-bin/man.cgi?query=relayd&sektion=8&format=html)的一个不错的 Web GUI 界面，以前是 hoststated。

回想起来，我希望我已经购买了中高端产品，这样我就可以将负载均衡器用作 SSL 端点并节省证书费用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-18T13:10:50.037

我们在[LVS](http://www.linuxvirtualserver.se)之上使用[keepalived](http://www.keepalived.org/)。添加服务器很简单，并且支持故障转移负载平衡服务器。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-05T03:27:56.667

我在几个工作中使用过 F5 bigips，除了通常的硬件负载平衡好东西，我特别喜欢 irules，它确实提供了很大的重写灵活性

它基本上是一种事件驱动的脚本语言

[http://devcentral.f5.com/Default.aspx?tabid=75](http://devcentral.f5.com/Default.aspx?tabid=75)

有一个 wiki 但您需要创建一个帐户才能访问

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-06-07T08:04:05.250

HAProxy(loadbalancing) + Pound (SSL termnation) + keepalived (VRRP 有一个实时备份负载均衡器)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-05T18:41:22.527

循环 DNS 将为您提供负载平衡，但不会提供冗余。如果您的其中一台服务器发生故障，它仍然会受到其请求份额的影响。

我们使用 Apache mod_jk 来处理成对的 Java 应用服务器之间的负载平衡和冗余。这非常有效，而且很简单。

我们还有一个冷故障转移 Apache 服务器，以防主服务器出现故障。理想情况下，我们会使用 Linux-HA 来实现 apache 的热故障转移，但我们不确定是否可以证明复杂性是合理的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-05T20:56:03.563

UCLA 的一个部门使用[瞻博网络加速平台](http://www.juniper.net/produamoces/application_acceleration/)，他们对此非常满意。它甚至接管了 SSL 加密的任务，而且基于硬件的 SSL速度*要*快得多！他们目前正在迁移更多服务以使用它。

它有什么好处：

*   将常用数据模式存储在专用硬盘驱动器上
*   基于硬件的算法（说话速度！）
*   支持最常见的协议

它并不便宜，但对于拥有大量流量的公司来说非常有效。[在此处](http://www.juniper.net/products_and_services/application_acceleration/wan_acceleration/wxc_application_acceleration/)查看 UCLA 选择的规范。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-26T02:26:22.737

我们目前使用 Zeuz ZXTM 负载均衡器，到目前为止对它很满意。但是，我们的托管服务提供商最初将其配置在运行防火墙服务的机器之上的虚拟机上。事实证明，这是一个非常愚蠢的错误，因为连接早在流量应该成为问题之前就已经饱和了。一旦移动到它自己的专用盒子，我们就能够处理 100Mb/s 的传出流量而不会出现故障或问题（在 4Gb/s 的可突发互联网管道上）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-26T00:34:50.717

我们使用 HAProxy 取得了巨大成功。即使在高负载平均期间，我也从未见过它超过 2% 的 CPU 使用率。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-26T00:51:48.730

我相信我们使用的是带有粘性会话的循环法。我们必须进行设置，以便保留 ASP/ASP.Net 会话信息，以便用户坚持使用具有会话的一台服务器。

一旦涉及从 http 切换到 SSL，我们确实遇到了一个小问题，我们的网站会将经过身份验证的用户发送到非安全页面，而未经身份验证的用户将被发送到安全登录页面，这看起来有点奇怪，但确实有一些意义除了返回到作为直接解决方案的单个服务器之外，通过 SSL 终止解决的目的是最好的解决方案。

有时可能需要使用更复杂的东西来确定哪个服务器“最不忙”并将下一个请求发送到该机器，但我不确定基础设施人员将如何获得该负载功能平衡器。

# java - 如何在标准 Mac JDK6 上使用 BGGA 闭包原型？

> ID：172397
> 
> 赞同：2
> 
> 时间：2008-10-05T18:25:48.203
> 
> 标签：java, eclipse, maven-2, closures, bgga

我正在尝试将[BGGA 闭包原型](http://www.javac.info/)与现有的 JDK 6（Mac OS X Leopard 上的标准）一起使用。我正在编译的示例代码来自 BGGA 教程：

```
public static void main(String[] args) {
  // function with no arguments; return value is always 42
  int answer = { => 42 }.invoke();
  System.out.println(answer);
} 
```

我尝试了以下方法，但没有任何工作：

1.  将closures.jar 复制到/System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home/lib
2.  使用 -Xbootclasspath/a:/path/to/closures.jar 运行 javac
3.  使用 -J-Xbootclasspath/a:/path/to/closures.jar 运行 javac
4.  通过定义我自己的系统库并使用 BGGA 的代码将其附加到我的项目中，从 eclipse ganymede 中进行了尝试。

在所有四种情况下，我都得到了编译错误，表明编译器没有在引导类路径上选择closures.jar。我真的很想从 eclipse 或至少 maven 中得到这个工作。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T19:47:26.153

TAR 文件分发包括经过修改的 javac.bat 和完整的命令行，包括“-source 7”，这可能是您在这里缺少的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T18:36:57.933

你试过用 -J-Xbootclasspath 代替 javac 吗？这用于将 -X 参数传递给 VM 本身，这对于像这样低级别的更改可能是必要的。

不过，我非常怀疑这是否适用于 Eclipse。系统库用于 API，而不是语言更改。您需要修补 Eclipse 编译器。

# sql-server - 使用什么数据库设计来收集可配置的人口统计数据？

> ID：172408
> 
> 赞同：0
> 
> 时间：2008-10-05T18:31:44.823
> 
> 标签：sql-server, database, database-design

我正在为一个慈善学生组织申请。该应用程序将跟踪（主要）学生参与者在活动中的参与和筹款活动。我们想做的一件事是从我们的企业目录中收集一些有关注册该活动的学生的人口统计信息，以用于评估营销并为管理部门构建按年级、专业、大学等划分的学生参与报告。该项目的目标之一是将应用程序推销给其他大学的类似组织。我正在设计具有用于身份验证和目录访问的插件架构的应用程序，以使其更通用。

到目前为止，我已经提出了几种不同的方法来将人口统计信息存储在数据库中。我可以假设大多数大学都喜欢收集（并拥有信息来源）类似的人口统计信息。在这种情况下，我可以将人口统计信息的适当部分（那些每年变化的东西）保存在注册表的列中，并将其余部分保存在参与者表中（那些对于个人来说是不变的东西）。或者，我考虑保留一个人口统计表，其中包含每个注册和所需属性的注册 ID、属性、值三元组。我认为第一个选项更容易查询报告，而第二个选项更灵活。

我想知道是否还有其他我没有考虑过的替代方案。或者，如果您遇到类似的问题，您是如何处理的（以及您对结果的满意程度）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T23:34:26.117

以下是我的想法：

*   您不应该将人口统计数据与注册联系起来。这在逻辑上没有意义，这总是会导致实际问题。您可以改为创建人口统计历史表，例如 StudentID、StartDate、EndDate、xxxDemographics、yyyDemographics...）
*   不同的学术机构可能有完全不同的人口统计需求。为了减少自定义，您可能希望对配置表中的所有定义进行软编码，例如 Demographics (DemographicsID, DemographicsDesc)，并保留 Student 和 Demographics 之间的关系表，例如 StudentDemographics (StudentID, DemographicsID...)。上述解决方案的唯一技巧是您可能希望在某些报告上使用 PIVOTing。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T18:47:28.113

如果您以添加列不会破坏它（或易于更新）的方式编写代码，例如小心 SELECT * 并在 INSERT 中指定列，那么从您的描述来看，它听起来不像您需要属性值的超灵活性，所以我会坚持选项 1。

# .net - .NET 表适配器：获取与填充？

> ID：172436
> 
> 赞同：12
> 
> 时间：2008-10-05T18:45:14.170
> 
> 标签：.net, database, ado.net, dataset, strong-typing

在处理来自数据库的数据（强类型或其他类型）时，我似乎总是使用 Get，我从来没有真正需要使用 Fill，尽管在提取和更新数据时我可以很容易地使用 Fill 而不是 get。

任何人都可以就每种方法的含义和陷阱提供指导吗？

在什么情况下最好使用其中一种？

任何性能影响？

提前感谢您的回答！我爱这个社区！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T20:48:15.220

使用 Fill 可以很好地调试异常，因为可以查询传递给方法的 DataTable 以获取更多详细信息。Get 不会在相同的情况下返回。

尖端：

*   DataTable.GetErrors() 返回错误的 DataRow 实例数组
*   DataRow.RowError 包含行错误的描述
*   DataRow.GetColumnsInError() 返回错误的 DataColumn 实例数组

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T19:51:43.583

*   当您只需要一个 DataTable 时获取。
*   当您想将其他数据表添加到单个数据集中时填充。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T11:43:36.423

如果表已经包含数据，则 Fill 的一个特殊问题是，例如，当查询返回主键已经在表中的行时，您可能会遇到唯一索引异常。

我使用过很多数据绑定的 Windows 窗体代码，其中编辑控件或窗体上的网格绑定到表，然后使用填充将更多行从数据库加载到表中。这可能会导致一些有趣的事件触发序列和经验中的间歇性错误。

使用 Get 检索具有新结果的新表，然后将表单重新绑定到新表可以避免这种情况。

我怀疑两者之间存在很大的性能差异，除非在具有现有行的表上使用 Fill。在这种情况下，表的 BeginLoadData 方法将被忽略，这通常会延迟事件触发和索引重建直到结束。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T18:53:04.373

唯一的区别是 GetData 为您实例化了一个表，Fill 将填充一个现有的表。

这取决于您是否想要或需要实例化 DataTable。在填充已实例化的 DataSet 的某个表成员时，我经常使用 Fill。

# python - 如何将多行字符串拆分为多行？

> ID：172439
> 
> 赞同：324
> 
> 时间：2008-10-05T18:46:27.430
> 
> 标签：python, string, split

我有一个多行字符串，我想对每一行进行操作，如下所示：

```
inputString = """Line 1
Line 2
Line 3""" 
```

我想在每一行上迭代：

```
for line in inputString:
    doStuff() 
```

* * *

## 回答 #1

> 赞同：491
> 
> 时间：2008-10-05T18:50:59.307

```
inputString.splitlines() 
```

会给你一个包含每个项目的列表，该[`splitlines()`](https://docs.python.org/3/library/stdtypes.html#str.splitlines)方法旨在将每一行拆分为一个列表元素。

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2008-10-05T18:58:44.567

就像其他人说的：

```
inputString.split('\n')  # --> ['Line 1', 'Line 2', 'Line 3'] 
```

这与上述相同，但不推荐使用字符串模块的函数，应避免使用：

```
import string
string.split(inputString, '\n')  # --> ['Line 1', 'Line 2', 'Line 3'] 
```

或者，如果您希望每一行都包含中断序列（CR、LF、CRLF），请使用`splitlines`带有`True`参数的方法：

```
inputString.splitlines(True)  # --> ['Line 1\n', 'Line 2\n', 'Line 3'] 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-03-06T19:13:57.617

**使用`inputString.splitlines()`**.

* * *

## 为什么`splitlines`更好

`splitlines`正确处理换行符，不像`split`.

当使用参数调用时，它还可以选择在拆分结果中返回换行符`True`，这在某些特定场景中很有用。

* * *

## 为什么你不应该使用`split("\n")`

`split`在跨操作系统共享文件时，使用会产生非常混乱的错误。

`\n`在 Python 中表示 Unix 换行符（ASCII 十进制代码 10），与运行它的操作系统无关。但是，[ASCII 换行表示是依赖于操作系统的](https://en.wikipedia.org/wiki/Newline#Representations)。

在 Windows 上，`\n`是两个字符，`CR`和`LF`（ASCII 十进制代码 13 和 10，`\r`和`\n`），而在现代 Unix（Mac OS X、Linux、Android）上，它是单个字符`LF`。

`print`即使您的字符串的行尾与您的平台不匹配，也可以正常工作：

```
>>> print " a \n b \r\n c "
 a 
 b 
 c 
```

但是，在“\n”上显式拆分具有依赖于操作系统的行为：

```
>>> " a \n b \r\n c ".split("\n")
[' a ', ' b \r', ' c '] 
```

即使您使用`os.linesep`，它也只会根据您平台上的换行符分隔，并且如果您正在处理在其他平台上创建的文本，或者使用裸`\n`:

```
>>> " a \n b \r\n c ".split(os.linesep)
[' a \n b ', ' c '] 
```

`splitlines`解决了所有这些问题：

```
>>> " a \n b \r\n c ".splitlines()
[' a ', ' b ', ' c '] 
```

* * *

[以文本模式读取文件](https://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)部分缓解了换行表示问题，因为它将 Python`\n`转换为平台的换行表示。

但是，文本模式仅存在于 Windows 上。在 Unix 系统上，所有文件都以二进制模式打开，因此`split('\n')`在带有 Windows 文件的 UNIX 系统中使用会导致不良行为。在网络中传输文件时也会发生这种情况。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-05-25T17:54:57.957

在这种特殊情况下可能有点矫枉过正，但另一种选择涉及使用`StringIO`创建类似文件的对象

```
for line in StringIO.StringIO(inputString):
    doStuff() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-11T19:10:28.380

原始帖子要求打印一些行（如果它们在某些条件下为真）加上以下行的代码。我的实现是这样的：

```
text = """1 sfasdf
asdfasdf
2 sfasdf
asdfgadfg
1 asfasdf
sdfasdgf
"""

text = text.splitlines()
rows_to_print = {}

for line in range(len(text)):
    if text[line][0] == '1':
        rows_to_print = rows_to_print | {line, line + 1}

rows_to_print = sorted(list(rows_to_print))

for i in rows_to_print:
    print(text[i]) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-16T16:34:00.980

我希望评论有正确的代码文本格式，因为我认为 @1_CR 的答案需要更多的颠簸，我想增加他的答案。无论如何，他带领我采用了以下技巧；如果可用，它将使用 cStringIO（但注意：cStringIO 和 StringIO**不一样**，因为你不能继承 cStringIO ......它是内置的......但对于基本操作，语法将是相同的，所以你可以这样做):

```
try:
    import cStringIO
    StringIO = cStringIO
except ImportError:
    import StringIO

for line in StringIO.StringIO(variable_with_multiline_string):
    pass
print line.strip() 
```

# c# - C# 的 GetOpt 库

> ID：172443
> 
> 赞同：28
> 
> 时间：2008-10-05T18:47:30.047
> 
> 标签：c#, getopt

我正在寻找 c# 的 getopt 库。到目前为止，我发现了一些（[phpguru](http://www.phpguru.org/static/getopt.html)、[XGetOptCS](http://69.10.233.10/KB/cs/XGetoptCS.aspx)、[getoptfordotnet](http://www.codeproject.com/KB/cs/geoptfordotnet.aspx)），但这些看起来更像是未完成的尝试，只支持 C 的部分 getopt。是否有完整的 getopt c# 实现？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-11-12T11:36:40.070

Miguel de Icaza[对 Mono.Options 赞不绝口](http://tirania.org/blog/archive/2008/Oct-14.html)。您可以使用[nuget 包](https://www.nuget.org/packages/Mono.Options/)，或者只是将[单个 C# 源文件](https://github.com/mono/mono/blob/master/mcs/class/Mono.Options/Mono.Options/Options.cs)复制到您的项目中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-05T10:40:42.830

这是 getopt 的 .NET 实现：http: [//www.codeplex.com/getopt](http://www.codeplex.com/getopt)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T19:51:20.077

[这](http://sourceforge.net/p/xacc/code/HEAD/tree/xacc/Utils/GetArgs.cs)是我写的东西，它工作得相当好，并且对于少量的代码具有相当多的功能。然而，它不是 getopts，但它可能适合您的需求。

随意问一些问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-15T09:19:10.107

为后代：

[CommandParser 是另一个](http://www.codeproject.com/KB/cs/CommandParserCSharp.aspx)具有 BSD 许可证的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T19:43:51.683

这不是 getopt，但您可以尝试[NConsoler](http://nconsoler.csharpus.com/)。它使用属性来定义参数和动作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T19:44:07.407

Mono 项目有（或者说有）一个基于属性的项目，但最后我检查了它是否被标记为过时。但是由于它是开源的，您也许可以将代码提取出来并自己使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-30T18:32:39.127

作为记录，[NUnit](http://nunit.org)包含一个简单的单文件命令行解析器`src\ClientUtilities\util\CommandLineOptions.cs`（参见示例用法中`ConsoleRunner.cs`和`Runner.cs`位于下`src\ConsoleRunner\nunit-console`）。该文件本身不包含任何许可信息，并且指向其“上游”的[链接](http://codeblast.com/~gert/dotnet/sells.html)似乎已失效，因此其法律地位不确定。

解析器支持命名标志参数 (like `/verbose`)、带值的命名参数 (like `/filename:bar.txt`) 和未命名参数，也就是说，与[Windows Scripting Host 解释它们](http://msdn.microsoft.com/en-us/library/ie/ss1ysb2a.aspx)的方式非常相似。选项可能以`/`,`-`和为前缀`--`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-29T23:13:41.923

我的一个朋友建议[使用 docopt.net](https://github.com/docopt/docopt.net)，这是一个基于 Node.JS 的[docopt](https://www.npmjs.com/package/docopt)库的命令行参数解析库。它使用起来非常简单，而且非常先进，可以根据您编写的帮助字符串解析参数。

这是一些示例代码：

```
using System;
using DocoptNet;

namespace MyProgram
{
    static class Program
    {
        static void Main(string[] args)
        {
            // Usage string
            string usage = @"This program does this thing.

Usage:
  program set <something>
  program do <something> [-o <optionalthing>]
  program do <something> [somethingelse]";

            try
            {
                var arguments = new Docopt().Apply(usage, args, version: "My program v0.1.0", exit: false);
                foreach(var argument in arguments)
                    Console.WriteLine("{0} = {1}", argument.Key, argument.Value);
            }
            catch(Exception ex)
            {
                //Parser errors are thrown as exceptions.
                Console.WriteLine(ex.Message);
            }
        }
    }
} 
```

[您可以在第一个链接和此处](http://docopt.org/)找到它的文档（包括其帮助消息格式）。

希望它可以帮助某人！

# icons - Palm/Garnet OS 图标格式？

> ID：172448
> 
> 赞同：2
> 
> 时间：2008-10-05T18:49:05.647
> 
> 标签：icons, file-format, palm-os, garnet-os

我用谷歌搜索并没有看到任何信息。应用程序使用什么格式和图标颜色深度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T07:53:24.297

Palm OS 图标格式是其位图格式的变体。Palm OS 支持称为位图系列的概念，其中将不同颜色深度和像素密度的多个位图捆绑在一起，并在运行时选择适当的位图。图标只是作为应用程序的一部分存储在“tAIN”资源中的位图。位图也可以使用 RLE 或 PackBits 压缩，这是原始 Mac OS 中使用的一种算法。

如果您使用 PilRC 之类的工具来编译位图，则应确保包含低密度和高密度位图。这是我在自己的一个程序中使用的示例图标定义：

```
ICON
BEGIN
BITMAP "LargeSXSW06Icon_1bpp_72ppi__22x22.bmp" BPP 1 DENSITY 72
BITMAP "LargeSXSW06Icon_1bpp_144ppi_44x44.bmp" BPP 1 DENSITY 144
BITMAP "LargeSXSWIcon_8bpp_108ppi_33x33.bmp"   BPP 8 COMPRESS TRANSPARENTINDEX 0 DENSITY 108
BITMAP "LargeSXSWIcon_8bpp_144ppi_44x44.bmp"   BPP 8 COMPRESS TRANSPARENTINDEX 0 DENSITY 144
END

SMALLICON
BEGIN
BITMAP "SmallIcon_1bpp_72ppi_15x9.bmp"       BPP 1 DENSITY 72
BITMAP "SmallIcon_8bpp_72ppi_15x9.bmp"       BPP 8 DENSITY 72
BITMAP "SmallSXSWIcon_8bpp_108ppi23x14.bmp"  BPP 8 DENSITY 108
BITMAP "SmallSXSWIcon_8bpp_144ppi_30x18.bmp" BPP 8 DENSITY 144
END 
```

我定义了两个图标——标准的大图标和一个在列表视图模式下的启动器中使用的小图标。主图标的低密度和高密度的尺寸为 22x22/44x44，小图标的尺寸为 15x9/30x18。PilRC 将 BMP 文件作为输入，但它输出每个资源的 .bin 文件或包含所有指定资源的组合 PRC 格式文件。PilRC[源代码](http://sourceforge.net/project/showfiles.php?group_id=7404)是位图实际二进制格式的最佳参考。

# command-line - 我似乎无法使用附加的代码更改驱动器驱动器

> ID：172465
> 
> 赞同：3
> 
> 时间：2008-10-05T18:57:47.703
> 
> 标签：command-line, batch-file

```
y: &pause
cd ptls5.0 &pause
sdp describe Integration.dpk &pause
z: &pause
cd ptls5.0 &pause
dir &pause 
```

我在 1.cmd 文件中有这些命令。前三个执行得很好。其结果是，在执行“sdp describe Integration.dpk &pause”之后，我在按下任意键后都会得到“按任意键继续...”。命令提示符退出。而不是将驱动器更改为 z:>。它有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T19:10:09.300

如果 sdp 是 .cmd 或 .bat 文件，请将其更改为“调用 sdp.....”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T19:02:03.280

“sdp”本身是另一个批处理文件吗？如果是这样，您将需要使用`call`：

```
call sdp describe Integration.dpk &pause 
```

# gcc - 如何忽略外部库头文件中的 GCC 编译器“迂腐”错误？

> ID：172484
> 
> 赞同：16
> 
> 时间：2008-10-05T19:14:04.487
> 
> 标签：gcc, compiler-construction, compiler-errors

我最近在 make GCC 编译选项中添加了[-pedantic](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-pedantic-1)和[-pedantic-errors](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-pedantic-errors-1)以帮助清理我的跨平台代码。一切都很好，直到它在外部包含的头文件中发现错误。有没有办法在外部头文件中关闭这个错误检查，即：

继续检查包含的文件，如下所示：

```
#include "myheader.h" 
```

停止检查包含文件，如下所示：

```
#include <externalheader.h> 
```

以下是我得到的错误：

```
g++ -Wall -Wextra -Wno-long-long -Wno-unused-parameter -pedantic --pedantic-errors
-O3 -D_FILE_OFFSET_BITS=64 -DMINGW -I"freetype/include" -I"jpeg" -I"lpng128" -I"zlib"
-I"mysql/include" -I"ffmpeg/libswscale" -I"ffmpeg/libavformat" -I"ffmpeg/libavcodec"
-I"ffmpeg/libavutil" -o omingwd/kguimovie.o -c kguimovie.cpp

In file included from ffmpeg/libavutil/avutil.h:41,
             from ffmpeg/libavcodec/avcodec.h:30,
             from kguimovie.cpp:44:
ffmpeg/libavutil/mathematics.h:32: error: comma at end of enumerator list
In file included from ffmpeg/libavcodec/avcodec.h:30,
             from kguimovie.cpp:44:
ffmpeg/libavutil/avutil.h:110: error: comma at end of enumerator list
In file included from kguimovie.cpp:44:
ffmpeg/libavcodec/avcodec.h:277: error: comma at end of enumerator list
ffmpeg/libavcodec/avcodec.h:303: error: comma at end of enumerator list
ffmpeg/libavcodec/avcodec.h:334: error: comma at end of enumerator list
ffmpeg/libavcodec/avcodec.h:345: error: comma at end of enumerator list
ffmpeg/libavcodec/avcodec.h:2249: warning: `ImgReSampleContext' is deprecated
(declared at ffmpeg/libavcodec/avcodec.h:2243)
ffmpeg/libavcodec/avcodec.h:2259: warning: `ImgReSampleContext' is deprecated
(declared at ffmpeg/libavcodec/avcodec.h:2243)
In file included from kguimovie.cpp:45:
ffmpeg/libavformat/avformat.h:262: error: comma at end of enumerator list
In file included from ffmpeg/libavformat/rtsp.h:26,
             from ffmpeg/libavformat/avformat.h:465,
             from kguimovie.cpp:45:
ffmpeg/libavformat/rtspcodes.h:38: error: comma at end of enumerator list
In file included from ffmpeg/libavformat/avformat.h:465,
             from kguimovie.cpp:45:
ffmpeg/libavformat/rtsp.h:32: error: comma at end of enumerator list
ffmpeg/libavformat/rtsp.h:69: error: comma at end of enumerator list 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-05T19:49:06.833

使用*[-Wsystem-headers](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Wsystem-headers)*选项，GCC 将打印与系统头相关的警告消息，这些消息通常被抑制。但是，您希望 GCC 基本上将这些文件视为系统头文件，因此您可以尝试传递“-isystem /usr/local/ffmpeg”（或您安装该软件包的任何位置）以使 GCC 忽略包含在这些目录也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:33:35.360

我不知道如何告诉 GCC 停止发出这些警告。`llvm-gcc`但是，您可以使用(或只是 gcc)之类的东西粗暴地删除第三方警告`-pedantic 2>&1|grep -v "/usr/"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T19:40:55.150

我想到的一个想法（我不知道是否有一个“开箱即用”的参数）：

准备一个将获取编译器输出的脚本，并删除所有包含不在特定列表中的标题的行（*您的*标题）。

这样做应该不难。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-17T16:44:56.333

你现在不能告诉 GCC 对某些标题而不是其他标题迂腐。您可能会建议它作为一个功能，尽管我怀疑它会被抵制，因为理想情况下每个人都会迂腐。

您可以自己修复头文件，生成补丁，然后在升级库时将该补丁应用于更高版本的头文件。

也将补丁提交给 FFmpeg，希望他们会采用它，但无论哪种方式，即使他们不接受它，你也会被覆盖。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-10-05T19:53:27.653

您可以修复标题并向[FFmpeg](https://en.wikipedia.org/wiki/FFmpeg)提交补丁；兼容性[`-pedantic`](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-pedantic-1)是一个有价值的目标，所以我相信他们会考虑它，特别是如果它只涉及删除尾随逗号等。

# python - 用于 AES 256 加密的（纯）Python 库是什么？

> ID：172486
> 
> 赞同：32
> 
> 时间：2008-10-05T19:14:49.137
> 
> 标签：python, encryption, aes

我正在寻找一个（最好是纯的）python 库来进行 AES 256 加密和解密。

这个库应该支持 CBC 密码模式，并[根据我之前的问题的答案](https://stackoverflow.com/questions/172392/what-symmetric-cypher-to-use-for-encrypting-messages)使用 PKCS7 填充。

该库至少应该可以在 Mac OS X (10.4) 和 Windows XP 上运行。理想情况下，只需将其放入我项目的源目录即可。我看过[Josh Davis 的这个](http://www.josh-davis.org/pythonAES)，但不确定它有多好，以及它是否符合所需的 CBC 密码模式……扫描源代码表明它没有

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-05T19:25:48.083

~~[PyCrypto](http://www.dlitz.net/software/pycrypto/)应该适合您。~~

编辑 02/10/2020：很遗憾，我无法删除这篇文章，因为它是公认的答案。正如人们在评论中指出的那样，这个库不再受到维护，从安全的角度来看也可能容易受到攻击。因此，请改为查看以下答案。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-01-19T17:38:34.117

[https://github.com/caller9/pythonaes](https://github.com/caller9/pythonaes)

那是带有PKCS7填充的纯python。支持CBC、CFB和OFB模式。

问题是python对于这种类型的东西不是超级快。来自 serprex 的 fork 的代码有点难以理解，但比我的要快得多，因为它使用了各种技巧来从 Python 中挤出最后一点速度。

但实际上，最好的库已经编译并挂接到 SSE/MMX 的东西中。

自 Core(tm) 系列芯片以来，英特尔也在使用 AES 指令。

我编写我的版本是为了获得一个真正的纯 Python 版本，以便能够在任何架构、跨平台以及 3.x 和 2.7 上运行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-06-08T23:19:03.383

因为我在搜索相同的东西时发现了这个问题，所以我想在列表中添加另一个问题：

**SlowAES** – [http://code.google.com/p/slowaes/](http://code.google.com/p/slowaes/)
这是 Josh Davis 的代码的开发，在其他人的帮助下。它似乎工作正常。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-05T22:38:06.010

[ncrypt](http://tachyon.in/ncrypt/)怎么样？它不是纯python，但结果要快得多。它基本上是 OpenSSL 上的一个不错的 python 包装器，所以你知道它背后有高质量的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-05T23:29:42.293

PyCrypto 显然不是 Pythonic，因此在某些平台（AIX、HP-UX 等）上编译它可能会遇到麻烦

# algorithm - 那么 - 您最近“发现”了哪些令人兴奋的算法？

> ID：172504
> 
> 赞同：15
> 
> 时间：2008-10-05T19:33:48.847
> 
> 标签：algorithm, language-agnostic

我喜欢阅读新的和聪明的算法。而且我喜欢开箱即用，因此欢迎来自所有计算领域的各种算法。

我不时阅读研究论文以跟上当前的研究并扩大我的视野。我也喜欢学习新的技巧。不幸的是，我倾向于只专注于我感兴趣的领域，所以我错过了很多有用的东西。

让我们不要发布主流的东西。而是写一些让你觉得特别的东西：“哇——现在*这是*一个聪明的解决方案！”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-05T19:40:07.320

我将从每个人都可以使用的东西开始：内省排序。[http://en.wikipedia.org/wiki/Introsort](http://en.wikipedia.org/wiki/Introsort)

一种新的排序算法，它结合了快速、插入和堆排序的优点。确切地说，它本身并不是一个新算法，而是一个**非常**巧妙的组合。

您可以将快速排序的速度提高到快速排序遇到退化 O(n²) 情况的程度。这几乎可以免费检测到。剩余的分区使用堆排序或合并排序进行排序。这不仅避免了退化的情况，而且还为堆栈使用创建了明确定义的上限。

插入排序 - 像往常一样 - 关心快速排序过程中留下的所有小分区。

对我来说，这是一个新发现，因为我停止对我的应用程序使用快速排序。

我在嵌入式设备上做了很多工作，我必须关心堆栈的使用。使用快速排序总是有点冒险，因为它在堆栈上运行异常的可能性很小。即使您知道使用当前数据一切都会好起来的，您永远不知道是否有人后来将您的代码剪切'n'粘贴到不同的项目中并将其用于从未提及的数据。

多亏了自省排序，我现在可以完全控制堆栈的使用并获得性能提升。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-05T19:50:02.590

这不是全新或令人兴奋的东西，但我喜欢[Levenshtein Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)。

Levenshtein 距离通常被称为两个字符串之间的*编辑距离*，它基本上是一种度量标准，通过计算将一个字符串转换为另一个字符串的最小操作数来衡量两个字符串之间的差异。

我正在使用此算法来建议对多个字符串进行排序以匹配（可能不同）字符串的外部源的顺序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-05T20:24:52.317

我最近重新发现了用于整数平方根的旧 Marchant 计算器算法的二进制变体。没有乘法或除法，只有加法、减法和移位。对不起，我失去了参考：

```
def assert
  raise "Assertion failed !" if $DEBUG and not yield
end

def sqrt(v)
    value = v.abs
    residue = value
    root = 0
    onebit = 1
    onebit <<= 8 while (onebit < residue)
    onebit >>= 2 while (onebit > residue)
    while (onebit > 0)
        x = root + onebit
        if (residue >= x) then
            residue -= x
            root = x + onebit
        end
        root >>= 1
        onebit >>= 2
    end
    assert {value == (root**2+residue)}
    assert {value < ((root+1)**2)}
    return [root,residue]
end

$DEBUG = true

a = sqrt(4141290379431273280)
puts a.inspect 
```

非常抱歉，对于那些不熟悉的人，忘了说这是 Ruby。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-06T02:54:04.793

我一直认为 Quake 中的[魔法平方根](http://www.codemaestro.com/reviews/9)函数非常聪明。它非常快，因为它避免了任何较慢的操作，例如除法等。

```
float SquareRootFloat(float num) {
    long i;
    float x, y;
    const float f = 1.5F;

    x = num * 0.5F;
    y  = num;
    i  = * ( long * ) &y;
    i  = 0x5f3759df - ( i >> 1 );
    y  = * ( float * ) &i;
    y  = y * ( f - ( x * y * y ) );
    y  = y * ( f - ( x * y * y ) );
    return num * y;
} 
```

他还有一个相关的[魔法逆平方根](http://betterexplained.com/articles/understanding-quakes-fast-inverse-square-root/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-05T19:53:15.827

这是我最近“发现”的[维特比算法](http://www.telecom.tuc.gr/~ntsourak/demo_viterbi.htm)的一个实现。这里的目的是决定视频编码中帧类型的最佳分布。维特比本身有时有点难以理解，所以我认为最好的方法是通过实际示例。

在此示例中，最大连续 B 帧为 2。所有路径必须以 P 帧结束。

路径长度为 1 为我们`P`提供了最佳路径，因为所有路径都必须以 P 帧结束，因此别无选择。

路径长度为 2 给我们`BP`和`_P`。`"_"`是长度为 1 的最佳路径。这给了我们`BP`和`PP`。现在，我们计算实际成本。假设为了这个例子，BP 是最好的。

路径长度为 3 给我们`BBP`和`_B`P 和`__P`。`"__"`是长度为 2 的最佳路径。这给了我们`BBP`和`PBP`和`BPP`。现在，我们计算实际成本。假设为了这个例子，BBP 是最好的。

路径长度为 4 给了我们`_BBP`and`__BP`和`___P`。`"___"`是长度为 3 的最佳路径。这给了我们 PBBP 和 BPBP 和 BBPP。现在，我们计算实际成本。假设为了这个例子，BPBP 是最好的。

路径长度为 4 给了我们`__BBP`and`___BP`和`____P`。`"____"`是长度为 4 的最佳路径。这给了我们`BPBBP`和`BBPBP`和`BPBPP`。

现在——等一下——所有路径都同意第一帧是`B`！所以第一帧是`B`.

重复该过程，直到它们就哪个帧是第一个 P 帧达成一致，然后开始编码。

该算法可以适应许多领域的大量问题；[它也是我在这篇文章](https://stackoverflow.com/questions/145676/how-to-approach-something-complex#145691)中提到的相同算法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-06T00:56:46.480

当我了解到用于数据压缩的 Burrows-Wheeler[块排序算法](http://www.faqs.org/faqs/compression-faq/part2/section-9.html)（在[bzip2](http://en.wikipedia.org/wiki/Bzip2)中使用）时，我印象深刻。令人惊讶的是，排序步骤是可逆的！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-08T10:40:46.567

生物信息学充满了以奇怪的形式生成大量数据的实验案例，这些数据需要富有想象力的算法来处理。

[生物信息学算法的介绍](http://books.google.com/books?id=p_qzpkNVcUwC&printsec=frontcover&dq=an+introduction+to+bioinformatics+algorithms&sig=ACfU3U2fVdniMWsaM1WWp1Vp6VvCn42BeA)是这类东西的好读物

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-06-29T11:58:19.817

[Dynamic programming](http://en.wikipedia.org/wiki/Dynamic_programming) takes all its power with [optimal control problems](http://en.wikipedia.org/wiki/Bellman_equation). Very refreshing.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-04T16:20:13.613

它不像其他的那样华而不实，但它派上了用场：

`((m+n) + (m-n)) / 2 === m (for any two real numbers m and n)`

我在 SQL 中使用了一些聚合查询逻辑来计算项目的评分。评级为 +1 和 -1。我需要知道仅给出评分总数及其总和的正面评分数（m）。

使用此逻辑确实加快了查询速度，并允许我返回评分为 0 的项目的结果。

（我没有选择 +1 和 -1；我继承了它。）

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-06T03:14:15.517

我发现这个非常有用的证明 a^n = b^n + c^n 但仅适用于 n=2。
不幸的是，这个评论框太小了，无法容纳它！

# version-control - 如何使用 ClearCase 轻松跟踪第三方来源？

> ID：172510
> 
> 赞同：1
> 
> 时间：2008-10-05T19:37:00.323
> 
> 标签：version-control, clearcase

首先：我不是一个有经验的 ClearCase 用户，但我对其他 VCS 和 *nix 命令行工具有很多经验。对于 ClearCase，我使用在 Unix shell 中工作的命令行工具（“cleartool”）。

问题：我在 ClearCase 中存储了一小组源。偶尔会出现具有相同源的新 .tgz，我必须更新存储库中的源（无法更改流程，以便其他方将使用 ClearCase）。

现在我执行以下操作：

1.  将 tgz 提取到，比如说，“~/new_src”
2.  “ct setview ...”和 cd 到源所在的位置（例如，“/vobs/src”）
3.  我将源与“diff -Naurb .~/new_src”进行比较，检查 diff 的输出并：
    1.  将新文件复制到 /vobs/src 并对其执行“cleartool mkelem”
    2.  签出更改的文件，复制新的源并提交它们
    3.  为新目录执行“cleartool mkdir”并填充它们

这个过程慢慢让我发疯，因为在几乎任何其他版本控制系统中，我都会检查源代码，复制新源代码，检查差异，添加新文件，然后提交全部内容。或者，更好的是，使用标签/分支，尽管在这种情况下确实不需要它们 - 我需要在 repo 中有一个最新版本的源代码，仅此而已。

我尝试检查所有内容（使用“cleartool co -nc `find .`”），复制新源，然后提交更改的文件/添加新文件。但这需要解析“cleartool ls”输出，而且更加混乱。

我可能会错过一些明显的东西，但对谷歌的几次尝试告诉我我没有。但是，我想听听 ClearCase 高级用户的意见 - 像我这样的无知者有希望吗？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T20:01:39.587

我只想确定：

你知道**[clearfsimport](https://stackoverflow.com/questions/138321/how-can-i-use-clearcase-to-add-to-source-control-recursively#144310)**，对吧？

因为在阅读（可能太快）您的问题之后，该命令可能就是您所追求的......

这就是我的想法......如果您需要更多详细信息，请对此答案发表评论。我会监控那些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T20:48:37.323

我将一堆 Perl 模块存储在 clearcase 中。但我只是签入 tar.gz 文件，并有一个脚本去提取并安装它们（到构建树中）作为构建过程的一部分。

我可能也倾向于使用其他语言的相同想法 - 只需在 make 文件中执行一步以在构建的其余部分继续之前提取 tarball。使替换新版本变得非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T12:23:41.727

如果您使用 ClearCase UCM，那么还有另一种处理第三方存储库的方法 - 使用组件（读写或通常是只读的）。

BR、Tamir Gefen CM 和 ALM 顾问 我的博客：[http ://almmmm.wordpress.com](http://almmmm.wordpress.com)

# javascript - 使用 jQuery 使用关联数组中的数据填充表单

> ID：172524
> 
> 赞同：8
> 
> 时间：2008-10-05T19:44:50.870
> 
> 标签：javascript, jquery

上次[我询问了反向过程](https://stackoverflow.com/questions/169506/get-form-input-fields-with-jquery)，并得到了一些非常有效的答案。我的目标是最少的代码行。我有一个字段形式和 {fieldname:data} 格式的关联数组，我想用它填充相应的表单。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-05T19:50:56.597

如果您的表单元素的 ID 设置为字段名：

```
$.each(myAssocArry, function(i,val) { $('#'+i).val(val); }); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T03:59:30.777

当我为一个项目执行此操作时，我发现设置选择字段、单选按钮和复选框的值需要更复杂的代码，类似于：

```
 jQuery.each(data, function (name,value) {
  jQuery("input[name='"+name+"'],select[name='"+name+"']").each(function() {
    switch (this.nodeName.toLowerCase()) {
        case "input":
            switch (this.type) {
                case "radio":
                case "checkbox":
                    if (this.value==value) { jQuery(this).click(); }
                    break;
                default:
                    jQuery(this).val(value);
                    break;
            }
            break;
        case "select":
            jQuery("option",this).each(function(){
                if (this.value==value) { this.selected=true; }
            });
            break;
    }
  });
}); 
```

我没有测试过这段代码，所以我希望没有我应该发现的愚蠢的语法错误。希望这可以帮助。

我不允许在这里评论评论（还），所以....如评论中所述，jQuery .val(val) 方法处理设置单选按钮、复选框和选择。

您仍然需要将 select[name=...] 放入您的 jQuery 选择器模式中，否则选择元素将不会被更新。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-05T20:22:21.260

或类似于使用字段名称而不是 id 的先前建议：

```
$.each(data, function(name,value) {
    $("input[name='" + name + "']").val(value);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-02T19:40:31.313

我还没有看到 jQuery 句柄将单个（非数组）值传递给 val() 用于单选或复选框输入。您必须确保将单个值包装到数组中。

我通常也不想改变按钮式输入的值，所以我将它们过滤掉。

这是一个处理数组换行、按钮过滤以及将输入选择限制为给定表单元素的函数。表单参数是可选的。如果离开/空/未定义，则将选择页面上的所有输入。

```
function populateForm(data, form) {
    $.each( data, function(name, value) {
        var input = $(":input[name='" + name + "']:not(:button,:reset,:submit,:image)", form );
        input.val( ( !$.isArray( value ) && ( input.is(':checkbox') || input.is(':radio') ) ) ? [ value ] : value );
    } );
}; 
```

# sql - SQL 游标...您会捍卫任何用例吗？

> ID：172526
> 
> 赞同：2
> 
> 时间：2008-10-05T19:46:22.067
> 
> 标签：sql, sql-server, tsql, set

我先走。

我是 100% 在集合操作阵营。但是，当整个所需输入域上的设置逻辑导致如此大的检索以致查询显着减慢、爬行或基本上需要无限时间时会发生什么？

在这种情况下，我将使用可能最多数十行的小光标（或 while 循环）（而不是我的目标数百万行）。因此，我仍在（分区子）集中工作，但我的检索运行得更快。

当然，更快的解决方案是从外部并行调用分区输入域，但这会引入外部系统的交互，并且当可以通过串行循环实现“足够好”的速度时，可能不值得它（特别是在开发过程中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T00:34:14.450

在很多情况下，必须读取配置表中的行并生成和执行代码，或者在许多元编程场景中。

在某些情况下，游标只是因为优化器不够聪明而表现出色。在这些情况下，要么你头脑中的元信息根本没有通过表上的索引或统计信息显示给优化器，要么代码太复杂以至于连接（通常是重新连接）可以简单地不要以您可以以基于光标的方式可视化它们的方式进行优化。在 SQL Server 2005 中，我相信 CTE 倾向于使代码看起来更简单，但是很难知道优化器是否也认为它们更简单 - 归结为将执行计划与您认为可以完成的方式进行比较最有效地拨打电话。

一般规则 - 除非必要，否则不要使用游标。但在必要时，不要让自己为此感到难过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T04:36:20.467

有许多不同的[光标行为](http://msdn.microsoft.com/en-us/library/ms180169.aspx)。

*   静态 vs 按键组 vs 动态
*   仅滚动 vs 前进 vs 快进
*   不敏感与否
*   乐观或只读或不
*   本地与全球（至少这很容易）

除非您能**解释所有这些选项以及****默认情况下**哪些选项是打开的，否则您永远不应该**使用光标**。

 ****所以，我从不这样做。

相反，当我想在 T-SQL 中循环某些东西时……我将它加载到一个变量表中，这类似于 LOCAL STATIC SCROLL 游标……除了它可以被索引和连接（编辑：和防止使用并行性的缺点）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T20:19:31.127

在纯 SQL 环境中，我宁愿按照您的建议避免使用游标。但是，一旦您跨入过程语言（如 PL/SQL），就会有很多用途。例如，如果您想检索某些行并想要“做”一些比用它们更新它更复杂的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T23:44:54.410

偶尔你会得到一个需要游标的操作，但在 T-SQL 中这是相当罕见的。Identity(int) 列或序列以集合操作中的方式对事物进行排序。计算可能在某些点发生变化的聚合（例如从地面累积索赔到限制或超出点）本质上是程序性的，因此这些是游标的候选者。

其他候选者将本质上是程序性的，例如遍历配置表并生成和执行一系列查询。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-06T00:04:13.077

当然，在许多地方游标可能比基于集合的操作更好。

一种是如果您要更新表中的大量数据（例如，按计划预先计算数据的 SQL 代理作业），那么您可能会使用游标在多个小集合中执行此操作，而不是在一个大集合中来减少并发锁定的数量，从而减少与访问数据的其他进程发生锁争用和/或死锁的机会。

另一种情况是，如果您想使用`sp_getapplock`存储过程获取应用程序级别的锁，这在您想确保被多个进程轮询的行只检索一次时很有用（[这里的示例](http://gregbeech.com/blogs/tech/archive/2008/06/11/retrieving-a-row-exactly-once-with-multiple-polling-processes-in-sql-server.aspx)）。

不过总的来说，我同意最好尽可能开始使用基于集合的操作，并且仅在出于功能或性能原因需要时才移动到游标（有证据支持后者）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T16:47:13.130

与[David B](https://stackoverflow.com/users/8155/david-b)所说的一样，我也更喜欢循环/表格方法。

除此之外，游标和循环/表方法的一个用例涉及非常大的更新。假设您必须更新 10 亿行。在许多情况下，这可能不需要是事务性的。例如，它可能是一个数据仓库聚合，如果事情不顺利，您有可能从源文件中重建。

在这种情况下，最好以“块”的形式进行更新，一次可能 100 万或 1000 万行。这有助于将资源使用保持在最低限度，并允许在更新数十亿行时最大化机器的并发使用。循环/分块方法在这里可能是最好的。不那么出色的硬件上的十亿行更新往往会导致问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T15:24:14.337

当您想使用不同的输入值多次运行系统过程时，游标也很方便。我无意尝试将系统过程重写为基于集合的，因此我将使用游标。另外，您通常会经过非常有限数量的对象。您可以对一次仅插入一条记录的现有 proc 执行相同的操作，但从性能角度来看，如果您有很多记录要运行，这通常是一件坏事。那些我将重写为基于集合的。

其他人讨论的运行总计可以更快。

如果您是从数据库发送电子邮件（不是最好的主意，但有时这是您遇到的问题），那么当您发送相同的电子邮件时，光标可以确保客户 a 看不到客户 b 的电子邮件地址。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-05T20:02:27.667

一个游标比集合更好的操作是在计算运行总数和类似的东西时。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T19:53:36.577

必须使用游标通常表明您正在数据库中执行应在应用程序中执行的操作。正如其他人所说，当存储过程计算运行总计时，或者当您生成代码和/或元编程时，通常需要游标。

但是你为什么首先在存储过程中做这种工作呢？这真的是数据库服务器的最佳用途吗？T-SQL 真的是生成代码时使用的正确语言吗？

当然，有时答案是“是”，或者更有可能是“否，但这种方式更简单”。在我看来，让事情保持简单胜过一周中的任何一天的过早优化。所以我使用游标。但是当我认为我需要使用光标时，宇宙在问我一个我应该有一个很好的答案的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T20:24:14.097

如果一个表由于某种原因没有被索引，游标将比其他迭代表的方法更快。我去年在这篇关于 SQL Server 游标的 [博客文章中找到了这些信息。](http://www.simple-talk.com/sql/learn-sql-server/robyn-pages-sql-server-cursor-workbench/)

虽然作者赞成“仅作为最后手段使用”的方法（就像这里的每个人一样），但她确实发现了一两个案例，其中光标的性能以及其他可用的替代方案（包括 Robert Rossney 指出的运行总数） . 在她提出的其他有趣的观点中，她指出游标在存储过程中的操作比作为临时查询更有效。作者还出色地指出了我们都与游标相关的性能问题何时开始出现。

博客文章包含实际代码，因此读者可以自己尝试查询并查看结果。

# c# - 当 Directory.GetFiles() 被拒绝访问时忽略文件夹/文件

> ID：172544
> 
> 赞同：78
> 
> 时间：2008-10-05T20:00:45.377
> 
> 标签：c#, getfiles

我正在尝试显示在所选目录（以及可选的任何子目录）中找到的所有文件的列表。我遇到的问题是，当 GetFiles() 方法遇到无法访问的文件夹时，它会引发异常并且进程停止。

如何忽略此异常（并忽略受保护的文件夹/文件）并继续将可访问文件添加到列表中？

```
try
{
    if (cbSubFolders.Checked == false)
    {
        string[] files = Directory.GetFiles(folderBrowserDialog1.SelectedPath);
        foreach (string fileName in files)
            ProcessFile(fileName);
    }
    else
    {
        string[] files = Directory.GetFiles(folderBrowserDialog1.SelectedPath, "*.*", SearchOption.AllDirectories);
        foreach (string fileName in files)
            ProcessFile(fileName);
    }
    lblNumberOfFilesDisplay.Enabled = true;
}
catch (UnauthorizedAccessException) { }
finally {} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-05T20:21:29.983

您将不得不手动进行递归；不要使用 AllDirectories - 一次查看一个文件夹，然后尝试从子目录中获取文件。未经测试，但如下所示（注意使用委托而不是构建数组）：

```
using System;
using System.IO;
static class Program
{
    static void Main()
    {
        string path = ""; // TODO
        ApplyAllFiles(path, ProcessFile);
    }
    static void ProcessFile(string path) {/* ... */}
    static void ApplyAllFiles(string folder, Action<string> fileAction)
    {
        foreach (string file in Directory.GetFiles(folder))
        {
            fileAction(file);
        }
        foreach (string subDir in Directory.GetDirectories(folder))
        {
            try
            {
                ApplyAllFiles(subDir, fileAction);
            }
            catch
            {
                // swallow, log, whatever
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2020-05-18T11:08:33.563

从 .NET Standard 2.1 开始，您现在可以执行以下操作：

```
var filePaths = Directory.EnumerateFiles(@"C:\my\files", "*.xml", new EnumerationOptions
{
    IgnoreInaccessible = true,
    RecurseSubdirectories = true
}); 
```

根据有关**IgnoreInaccessible的**[MSDN 文档](https://docs.microsoft.com/en-us/dotnet/api/system.io.enumerationoptions?view=netstandard-2.1)：

 **> 获取或设置一个值，该值指示在拒绝访问时是否跳过文件或目录（例如，UnauthorizedAccessException 或 SecurityException）。默认值为真。

默认值实际上是 true，但我将其保留在这里只是为了显示属性。

也可以使用相同的过载`DirectoryInfo`。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-06-26T20:58:43.047

这个简单的功能运行良好，满足问题要求。

```
private List<string> GetFiles(string path, string pattern)
{
    var files = new List<string>();
    var directories = new string[] { };

    try
    {
        files.AddRange(Directory.GetFiles(path, pattern, SearchOption.TopDirectoryOnly));
        directories = Directory.GetDirectories(path);
    }
    catch (UnauthorizedAccessException) { }

    foreach (var directory in directories)
        try
        {
            files.AddRange(GetFiles(directory, pattern));
        }
        catch (UnauthorizedAccessException) { }

    return files;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-08-15T16:40:15.707

一种简单的方法是对文件使用列表，对目录使用队列。它可以节省内存。如果您使用递归程序执行相同的任务，则可能会引发 OutOfMemory 异常。输出：添加到列表中的文件，按照从上到下（宽度优先）的目录树进行组织。

```
public static List<string> GetAllFilesFromFolder(string root, bool searchSubfolders) {
    Queue<string> folders = new Queue<string>();
    List<string> files = new List<string>();
    folders.Enqueue(root);
    while (folders.Count != 0) {
        string currentFolder = folders.Dequeue();
        try {
            string[] filesInCurrent = System.IO.Directory.GetFiles(currentFolder, "*.*", System.IO.SearchOption.TopDirectoryOnly);
            files.AddRange(filesInCurrent);
        }
        catch {
            // Do Nothing
        }
        try {
            if (searchSubfolders) {
                string[] foldersInCurrent = System.IO.Directory.GetDirectories(currentFolder, "*.*", System.IO.SearchOption.TopDirectoryOnly);
                foreach (string _current in foldersInCurrent) {
                    folders.Enqueue(_current);
                }
            }
        }
        catch {
            // Do Nothing
        }
    }
    return files;
} 
```

# 脚步：

1.  将根入队到队列中
2.  在一个循环中，将其出列，将该目录中的文件添加到列表中，并将子文件夹添加到队列中。
3.  重复直到队列为空。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-24T13:54:35.160

有关处理 UnauthorisedAccessException 问题的解决方案，请参阅[https://stackoverflow.com/a/10728792/89584](https://stackoverflow.com/a/10728792/89584)。

如果对 GetFiles() 或 GetDirectories() 的任何调用位于具有混合权限的文件夹上，则上述所有解决方案都将丢失文件和/或目录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-05T20:35:20.923

这应该回答这个问题。我忽略了通过子目录的问题，我假设你已经弄清楚了。

当然，您不需要为此设置单独的方法，但您可能会发现它是一个有用的地方，可以验证路径是否有效，并处理调用 GetFiles() 时可能遇到的其他异常。

希望这可以帮助。

```
private string[] GetFiles(string path)
{
    string[] files = null;
    try
    {
       files = Directory.GetFiles(path);
    }
    catch (UnauthorizedAccessException)
    {
       // might be nice to log this, or something ...
    }

    return files;
}

private void Processor(string path, bool recursive)
{
    // leaving the recursive directory navigation out.
    string[] files = this.GetFiles(path);
    if (null != files)
    {
        foreach (string file in files)
        {
           this.Process(file);
        }
    }
    else
    {
       // again, might want to do something when you can't access the path?
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-16T06:04:46.930

### 这是一个功能齐全、兼容 .NET 2.0 的实现。

您甚至可以更改`List`文件的生成以跳过`FileSystemInfo`版本中的目录！

（注意`null`价值观！）

```
public static IEnumerable<KeyValuePair<string, string[]>> GetFileSystemInfosRecursive(string dir, bool depth_first)
{
    foreach (var item in GetFileSystemObjectsRecursive(new DirectoryInfo(dir), depth_first))
    {
        string[] result;
        var children = item.Value;
        if (children != null)
        {
            result = new string[children.Count];
            for (int i = 0; i < result.Length; i++)
            { result[i] = children[i].Name; }
        }
        else { result = null; }
        string fullname;
        try { fullname = item.Key.FullName; }
        catch (IOException) { fullname = null; }
        catch (UnauthorizedAccessException) { fullname = null; }
        yield return new KeyValuePair<string, string[]>(fullname, result);
    }
}

public static IEnumerable<KeyValuePair<DirectoryInfo, List<FileSystemInfo>>> GetFileSystemInfosRecursive(DirectoryInfo dir, bool depth_first)
{
    var stack = depth_first ? new Stack<DirectoryInfo>() : null;
    var queue = depth_first ? null : new Queue<DirectoryInfo>();
    if (depth_first) { stack.Push(dir); }
    else { queue.Enqueue(dir); }
    for (var list = new List<FileSystemInfo>(); (depth_first ? stack.Count : queue.Count) > 0; list.Clear())
    {
        dir = depth_first ? stack.Pop() : queue.Dequeue();
        FileSystemInfo[] children;
        try { children = dir.GetFileSystemInfos(); }
        catch (UnauthorizedAccessException) { children = null; }
        catch (IOException) { children = null; }
        if (children != null) { list.AddRange(children); }
        yield return new KeyValuePair<DirectoryInfo, List<FileSystemInfo>>(dir, children != null ? list : null);
        if (depth_first) { list.Reverse(); }
        foreach (var child in list)
        {
            var asdir = child as DirectoryInfo;
            if (asdir != null)
            {
                if (depth_first) { stack.Push(asdir); }
                else { queue.Enqueue(asdir); }
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-08-04T08:02:19.833

我更喜欢使用c#框架函数，但我需要的函数将包含在.net framework 5.0中，所以我必须编写它。

```
// search file in every subdirectory ignoring access errors
    static List<string> list_files(string path)
    {
        List<string> files = new List<string>();

        // add the files in the current directory
        try
        {
            string[] entries = Directory.GetFiles(path);

            foreach (string entry in entries)
                files.Add(System.IO.Path.Combine(path,entry));
        }
        catch 
        { 
        // an exception in directory.getfiles is not recoverable: the directory is not accessible
        }

        // follow the subdirectories
        try
        {
            string[] entries = Directory.GetDirectories(path);

            foreach (string entry in entries)
            {
                string current_path = System.IO.Path.Combine(path, entry);
                List<string> files_in_subdir = list_files(current_path);

                foreach (string current_file in files_in_subdir)
                    files.Add(current_file);
            }
        }
        catch
        {
            // an exception in directory.getdirectories is not recoverable: the directory is not accessible
        }

        return files;
    } 
```

# mfc - 如何将 CMFCListCtrl 与 CListView 一起使用？

> ID：172546
> 
> 赞同：1
> 
> 时间：2008-10-05T20:02:09.617
> 
> 标签：mfc, mfc-feature-pack

我想在我的**CListView类中使用新的****CMFCListCtrl**功能（当然还有里面的新 CMFCHeaderCtrl）。不幸的是，您不能使用*Attach()*或*SubclassWindow()*，因为 SysListView32 窗口已经与 CListView 对象相关联。

 ****我是否必须覆盖 CListView 的*OnCmdMsg()*并将所有消息路由到我自己的 CMFCListCtrl 实例？（这甚至会起作用吗？）还是有更简单/更清洁的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T20:34:42.407

我会从**CFormView**继承并让**CMFCListCtrl**占据表单视图的完整对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-11T10:26:29.280

如果你想要你自己的 CMFCHeaderCtrl（fe m_myHeaderCtrl 派生自 CMFCHeaderCtrl）你必须在你自己的 CMFCListCtrl 中重写这三个函数

```
CMFCHeaderCtrl& CMyMFCListCtrl::GetHeaderCtrl() 
{ 
   return m_myHeaderCtrl; 
}

void CMyMFCListCtrl::InitHeader()
{
   // Initialize header control:
   m_myHeaderCtrl.SubclassDlgItem(0, this);
}

void CMyMFCListCtrl::OnSize(UINT nType, int cx, int cy)
{
   CListCtrl::OnSize(nType, cx, cy);
   if (myHeaderCtrl.GetSafeHwnd() != NULL)
   {
      myHeaderCtrl.RedrawWindow();
   }
} 
```

现在您在自己的 myHeaderCtrl 中拥有完整的响应，定义了更多功能（标题中的多行）：

```
OnDrawItem(CDC* pDC, int iItem, CRect rect, BOOL bIsPressed, BOOL bIsHighlighted); 
```

或定义自己的布局

```
afx_msg LRESULT OnHeaderLayout(WPARAM wp, LPARAM lp); 
```

示例在 MFC 代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T13:32:10.463

CListView 没有很多功能。就像您在上面的评论中所说，只需从 CView 派生您自己的视图类，处理 WM_SIZE 以调整 CMFCListCtrl 的大小，就可以了。

# command-line - 当访问 /tmp/ 被拒绝时在哪里创建临时文件？

> ID：172552
> 
> 赞同：3
> 
> 时间：2008-10-05T20:04:37.070
> 
> 标签：command-line

我编写了一个简短的 bash 脚本来完成一项任务，该任务涉及创建一个临时目录并在其中存储各种文件并对其执行各种操作。

在我的第一遍中，我刚刚在 /tmp/$$.$script" 处创建了临时目录，但随后我在没有 /tmp/ 写入权限的计算机上测试了该脚本，我想采取考虑到这种情况。所以我的问题是这个临时目录的一个好的辅助位置在哪里？我应该只使用当前目录吗？主目录？~/tmp/？脚本的输出位置？

所有创建的文件都会在脚本退出时被清理。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-05T20:07:37.843

许多系统还具有`/var/tmp`. 如果系统管理员不想让你写信`/tmp`，大概他们已经提供了一些替代方案……`$TMPDIR`环境变量设置了吗？例如，在我的 Mac 上：

```
$ echo $TMPDIR
/var/folders/jf/jfu4pjGtGGGkUuuq8HL7UE+++TI/-Tmp-/ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-05T20:24:54.500

如果没有设置 TMPDIR，我建议使用 ~/.[your script name]/tmp，而不是 ~/tmp/，因为用户可能自己创建了它（并且您可能不想意外覆盖其中的内容）。

就像 bash 中的即兴想法一样——

```
case $TMPDIR in '') tmp_dir=".${0}/tmp";; *) tmp_dir=$TMPDIR;; esac 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-05T20:34:41.703

使用 ${TMPDIR:-/tmp}（如果 $TMPDIR 未设置，则使用 $TMPDIR 或 /tmp）。如果那不可写，则退出并显示错误，或者要求用户输入定义它的输入。我认为询问用户临时文件应该去哪里比假设某个地方并在你的进程被杀死时将它们留在那里更可取。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T20:59:38.580

您可以尝试使用[mktemp](http://unixhelp.ed.ac.uk/CGI/man-cgi?mktemp)（假设它已为系统正确配置）

例如 `MYTMPDIR=$(mktemp -d)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T20:07:11.573

您可以尝试`/var/tmp`，尽管这很可能`/tmp`是一个符号链接（反之亦然）。

# php - 索引返回数组的最有效方法？

> ID：172559
> 
> 赞同：7
> 
> 时间：2008-10-05T20:09:57.370
> 
> 标签：php

```
function returnsAnArray ()
{
  return array ('test');
}

echo returnsAnArray ()[0]; 
```

在 PHP 中生成语法错误。直接从返回的数组中获取元素而不将结果分配给临时变量的最有效方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T20:23:24.893

这是一种方法，使用[列表](http://www.php.net/list)语言结构

```
function returnsAnArray ()
{
  return array ('test');
}

list($foo)=returnsAnArray(); 
```

[您可以通过将其与array_slice](http://www.php.net/array_slice)结合来从偏移量中获取一系列元素

```
list($third,$fourth,$fifth)=array_slice(returnsAnArray(), 2, 3); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T20:26:56.900

定义一个用于从数组返回特定​​索引的新函数。

```
function arr_index($arr, $i) { return $arr[$i]; } 
```

您可能想在此处添加一些错误和类型检查。

然后像这样使用它：

```
echo arr_index(returnsAnArray(), 0); 
```

快乐编码:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T20:19:03.420

如果数组中只有一个成员，这将起作用：

```
 <?php
 echo current(returnsAnArray());
 ?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T21:30:43.243

另外一个选项：

```
<?php
echo reset(functionThatReturnsAnArray());
?> 
```

类似的线程：[PHP：我可以引用函数返回的数组的单个成员吗？](https://stackoverflow.com/questions/68711/php-can-i-reference-a-single-member-of-an-array-that-is-returned-by-a-function)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-04T17:46:40.833

对于常规的数字索引数组，其中 func() 返回这样的数组， $n 是您想要的索引：

`array_pop(array_slice(func(),$n,1));`

对于关联数组（例如字符串或其他作为键的东西），或没有编号且从 0..n 完整的数字数组，它有点复杂。其中 $key 是您想要的密钥：

`array_pop(array_intersect_keys(func(),Array($key => ""));`

这也适用于第一种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-05T20:22:15.583

您可以对未知长度的索引数组执行此操作。

```
foreach (returnAnArray() 作为 $item )
  回声$项目；

```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-05T20:26:40.097

我问自己为什么要避免为返回的数组创建临时变量。为什么不只返回一个值而不是整个数组？也许您将不得不过度考虑您的程序逻辑。

还是性能/内存问题？考虑使用[引用](http://de2.php.net/manual/en/language.references.php)而不是总是创建一个新的数组对象并返回它。

# java - SSH2 有比 JSch 更好的 Java 实现吗？

> ID：172573
> 
> 赞同：7
> 
> 时间：2008-10-05T20:20:14.603
> 
> 标签：java, ssh

我已经使用[JSch](http://www.jcraft.com/jsch/)几个星期了。它似乎*工作*正常，但它的 API 有点麻烦。我也对它完全缺乏文档（甚至没有 javadoc 风格的注释）感到有点失望。有没有人使用过他们推荐的好的 Java SSH2 库。我对 SCP 文件传输和通过 SSH 协议以编程方式向远程 Linux 机器发出命令特别感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T20:32:25.530

我正在使用[J2SSH](http://sourceforge.net/projects/sshtools)，效果很好。我不知道它与 JSch 相比如何。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-27T03:22:42.357

您是否尝试过 Orion SSH (Ganymed SSH-2)，尝试不多但看起来不错 :)

# c++ - g++和gcc有什么区别？

> ID：172587
> 
> 赞同：1044
> 
> 时间：2008-10-05T20:25:13.563
> 
> 标签：c++, gcc, g++

g++和gcc有什么区别？其中哪一个应该用于一般的 c++ 开发？

* * *

## 回答 #1

> 赞同：850
> 
> 时间：2008-10-05T20:26:59.520

`gcc`并且`g++`是 GNU Compiler *Collection*（曾经只是 GNU *C Compiler*）的编译器驱动程序。

即使它们`cc1` `cc1plus`根据文件类型自动确定要调用哪些后端 ( ...)，除非用 覆盖`-x language`，它们还是有一些区别。

它们的默认值可能最重要的区别是它们自动链接到哪些库。

根据 GCC 的在线文档[链接选项](https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)和[g++ 的调用](https://gcc.gnu.org/onlinedocs/gcc/Invoking-G_002b_002b.html)方式，`g++`相当于`gcc -xc++ -lstdc++ -shared-libgcc`（第一个是编译器选项，第二个是链接器选项）。这可以通过运行这两个`-v`选项来检查（它显示正在运行的后端工具链命令）。

* * *

## 回答 #2

> 赞同：518
> 
> 时间：2008-10-06T01:55:00.917

GCC：GNU 编译器集合

*   GNU 编译器支持的所有不同语言的引用。

`gcc`: GNU C 编译器
`g++`: GNU C++ 编译器

主要区别：

1.  `gcc`将编译：`*.c\*.cpp`文件分别为 C 和 C++。
2.  `g++`将编译：`*.c\*.cpp`文件，但它们都将被视为 C++ 文件。
3.  此外，如果您使用`g++`链接目标文件，它会自动链接到标准 C++ 库中（`gcc`不这样做）。
4.  `gcc`编译 C 文件具有较少的预定义宏。
5.  `gcc`编译`*.cpp`和`g++`编译`*.c\*.cpp`文件有一些额外的宏。

`*.cpp`编译文件时的额外宏：

```
#define __GXX_WEAK__ 1
#define __cplusplus 1
#define __DEPRECATED 1
#define __GNUG__ 4
#define __EXCEPTIONS 1
#define __private_extern__ extern 
```

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2008-10-05T20:29:26.973

对于 c++，你应该使用 g++。

它是同一个编译器（例如 GNU 编译器集合）。GCC 或 G++ 只是选择具有不同默认选项的不同前端。

简而言之：如果你使用 g++，前端会告诉链接器你可能想链接 C++ 标准库。gcc 前端不会这样做（如果您传递正确的命令行选项，它也可以与它们链接）。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2016-01-05T10:34:28.750

**`g++`和 和有什么不一样`gcc`？**

`gcc`已从单一语言“GNU C 编译器”发展为多语言“GNU 编译器集合”。在 C 编程的上下文中，该术语`gcc`有时仍指“GNU C 编译器”。

```
man gcc

# GCC(1)                     GNU
# 
# NAME
#        gcc - GNU project C and C++ compiler 
```

但是，`g++` *是*GNU Compiler Collection 的 C++ 编译器。就像`gnat`Ada 编译器一样`gcc`。[请参阅使用 GNU 编译器集合 (GCC)](https://gcc.gnu.org/onlinedocs/gcc-5.3.0/gcc/G_002b_002b-and-GCC.html)

例如，Ubuntu 16.04 和 18.04`man g++`命令返回`GCC(1)`手册页。

Ubuntu 16.04 和 18.04`man gcc`声明...

> `g++`接受与`gcc`

并且默认...

> ... 的使用`gcc`不会添加 C++ 库。 `g++`是一个调用 GCC 并自动指定与 C++ 库的链接的程序。除非使用 -x，否则它将 .c、.h 和 .i 文件视为 C++ 源文件而不是 C 源文件。在预编译扩展名为 .h 的 C 头文件以用于 C++ 编译时，此程序也很有用。

搜索手册页以获取有关和`gcc`之间的选项差异的更多详细信息。`gcc``g++`

**哪一个应该用于一般的 c++ 开发？**

从技术上讲，`gcc`或者`g++`可以用于具有适用选项设置的一般 C++ 开发。但是，`g++`默认行为自然与 C++ 开发相一致。

添加了[Ubuntu 18.04 'gcc' 手册页](http://manpages.ubuntu.com/manpages/bionic/en/man1/gcc.1.html#description)，并且[Ubuntu 20.04](http://manpages.ubuntu.com/manpages/focal/en/man1/gcc.1.html)继续具有以下段落：

> 运行 GCC 的常用方法是运行名为 的可执行文件`gcc`，或者`machine-gcc`在交叉编译时，或者`machine-gcc-version`运行特定版本的 GCC。 ***当你编译 C++ 程序时，你应该调用 GCC `g++`。***

* * *

旁注：对于 Xcode.app 嵌入式工具链，`g++`只需链接到`gcc`. 因此，`g++`调用可能因每个工具链而异。

```
ls -l /Applications/Xcode.app/Contents/Developer/usr/bin
# …
# lrwxr-xr-x  1 root  wheel         3 Apr 27  2021 g++ -> gcc
# -rwxr-xr-x  1 root  wheel    167120 Nov 23 20:51 gcc

### -- versus --
which -a g++
# /usr/bin/g++
ls -l /usr/bin/g++
# -rwxr-xr-x  1 root  wheel  137616 Jan  1  2020 /usr/bin/g++ 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2008-10-05T20:35:31.030

一个显着的区别是，如果您将`.c`文件传递给 gcc，它将编译为 C。

g++ 的默认行为是将`.c`文件视为 C++（除非`-x c`指定）。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-06T00:51:10.733

尽管 gcc 和 g++ 命令做的事情非常相似，但 g++ 被设计为您在编译 C++ 程序时调用的命令。它旨在自动做正确的事情。

在幕后，它们实际上是同一个程序。据我了解，两者都根据文件扩展名决定将程序编译为 C 还是 C++。两者都能够链接到 C++ 标准库，但默认情况下只有 g++ 这样做。因此，如果您有一个用 C++ 编写的程序，并且碰巧不需要链接到标准库，那么 gcc 会碰巧做正确的事情；但是，g++ 也会如此。所以真的没有理由不使用 g++ 进行一般的 C++ 开发。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2015-03-16T16:30:27.857

**我对这个问题产生了兴趣并进行了一些实验**

1.  [我在这里](https://gcc.gnu.org/onlinedocs/gcc-3.3.6/gcc/G_002b_002b-and-GCC.html)找到了该描述，但它很短。

2.  然后我尝试在我的 Windows 机器上尝试 gcc.exe 和 g++.exe：

    ```
    $ g++ --version | head -n1 
    g++.exe (gcc-4.6.3 release with patches [build 20121012 by perlmingw.sf.net]) 4.6.3

    $ gcc --version | head -n1
    gcc.exe (gcc-4.6.3 release with patches [build 20121012 by perlmingw.sf.net]) 4.6.3 
    ```

3.  我试图编译 c89、c99 和 c++1998 简单的测试文件，并且它对我来说很好用，它具有与语言匹配的正确扩展名

    ```
    gcc -std=c99 test_c99.c
    gcc -std=c89 test_c89.c 
    g++ -std=c++98 test_cpp.cpp
    gcc -std=c++98 test_cpp.cpp 
    ```

4.  但是当我尝试以这种方式运行“gnu 编译器集合”工具时：

    ```
    $ gcc -std=c++98 test_cpp.c
    cc1.exe: warning: command line option '-std=c++98' is valid for C++/ObjC++ but not for C [enabled by default] 
    ```

5.  但是这个仍然可以正常工作

    ```
    $ gcc -x c++ -std=c++98 test_cpp.c 
    ```

6.  而这也

    ```
    $ g++ -std=c++0x test_cpp_11.cpp 
    ```

ps 测试文件

```
$ cat test_c89.c test_c99.c test_cpp.cpp

// C89 compatible file
int main()
{
    int x[] = {0, 2};
    return sizeof(x);
}

// C99 compatible file
int main()
{
    int x[] = {[1]=2};
    return sizeof(x);
}

// C++1998,2003 compatible file
class X{};
int main()
{
    X x;
    return sizeof(x);
}

// C++11
#include <vector>
enum class Color : int{red,green,blue}; // scoped enum
int main()
{
    std::vector<int> a {1,2,3}; // bracket initialization
    return 0;
} 
```

**发现：**

1.  如果查看进程树，那么 gcc 和 g++ 似乎是其他工具的后端，在我的环境中是：*cc1plus.exe、cc1.exe、collect2.exe、as.exe、ld.exe*

2.  如果您有正确的扩展名或设置正确的 -std -x 标志，gcc 可以作为元工具正常工作。看到[这个](http://linux.die.net/man/1/gcc)

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2012-10-18T11:37:16.770

“GCC”是 GNU 编译器集合的常用缩写词。这既是编译器的最通用名称，也是强调编译 C 程序时使用的名称（以前的缩写代表“GNU C Compiler”）。

在提到 C++ 编译时，通常将编译器称为“G++”。由于只有一个编译器，因此无论在何种语言环境下，将其称为“GCC”也是准确的；但是，当重点是编译 C++ 程序时，术语“G++”更有用。

[你可以在这里](http://gcc.gnu.org/onlinedocs/gcc-3.3.5/gcc/G_002b_002b-and-GCC.html)阅读更多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-02T20:45:15.293

我在 linux 系统中测试 gcc 和 g++。通过使用 MAKEFILE，我可以定义“GNU make”使用的编译器。我使用“C plus plus”的所谓“动态内存”定位功能进行了测试：

```
int main(){

int * myptr = new int;
* myptr = 1;
printf("myptr[0] is %i\n",*myptr);
return 0;
} 
```

我的电脑上只有g++可以编译成功，而gcc会报错

```
undefined reference to `operator new(unsigned long)' 
```

所以我自己的结论是gcc并不完全支持“C plus plus”。**似乎为 C++ 源文件选择 g++ 是一个更好的选择。**

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-08-12T08:44:41.020

gcc 和 g++ 都是 GNU 编译器。他们都编译c和c++。不同之处在于 *.c 文件 gcc 将其视为 ac 程序，而 g++ 将其视为 ac ++ 程序。*.cpp 文件被认为是 c++ 程序。c++是c的超集，语法比较严格，所以要注意后缀。

# java - 如何发现 DVD/CD 驱动器中插入的媒体类型？（爪哇）

> ID：172588
> 
> 赞同：4
> 
> 时间：2008-10-05T20:25:56.683
> 
> 标签：java, multimedia

当我插入 DVD 或 CD 时，我想以编程方式知道它是什么类型的媒体（DVD 或 CD）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T21:19:21.113

恕我直言，不可能用纯 Java 解决这个问题。您唯一能做的就是通过 FileSystemView 检测某个文件是否是 cd/dvd 驱动器，但如果它包含 CD 或 DVD 作为媒体则不能。尽管可以通过获取总已用空间来进行有根据的猜测。

对于一个有效的解决方案，您至少需要三个“大”操作系统的 JNI 代码。我不知道有任何项目做到了这一点。Linux 只有特定于平台的库/实用程序在后台使用常用的 cdrw/dvdrw 工具。

# objective-c - 在 Objective-C 中为类定义私有方法的最佳方法

> ID：172598
> 
> 赞同：361
> 
> 时间：2008-10-05T20:29:53.803
> 
> 标签：objective-c, cocoa, code-completion

我刚开始编写 Objective-C 并且有 Java 背景，想知道编写 Objective-C 程序的人是如何处理私有方法的。

我知道可能有几种约定和习惯，并将这个问题视为人们在处理 Objective-C 中的私有方法时使用的最佳技术的聚合器。

请在发布时为您的方法提供一个论据。为什么好？它有哪些缺点（你知道）以及你如何处理它们？

* * *

至于我到目前为止的发现。

可以使用在 MyClass.m 文件中定义的[类别](http://www.otierney.net/objective-c.html#categories)[例如 MyClass (Private)] 对私有方法进行分组。

这种方法有两个问题：

1.  Xcode（和编译器？）不会检查您是否在相应的 @implementation 块中定义了私有类别中的所有方法
2.  您必须将 @interface 声明您的私有类别放在 MyClass.m 文件的开头，否则 Xcode 会抱怨“self may not respond to message”privateFoo”之类的消息。

第一个问题可以用[空类别](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_4_section_5.html#//apple_ref/doc/uid/TP30001163-CH20-SW2)来解决[例如 MyClass ()]。
第二个让我很困扰。我希望看到在文件末尾附近实现（和定义）私有方法；我不知道这是否可能。

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2009-03-16T19:37:02.270

正如其他人已经说过的那样，Objective-C 中没有私有方法之类的东西。*但是，从 Objective-C 2.0（意味着 Mac OS X Leopard、iPhone OS 2.0 和更高版本）开始，您可以创建一个名为Class Extension*的具有空名称（即`@interface MyClass ()`）的类别。类扩展的独特之处在于方法实现必须与公共方法相同。所以我像这样构建我的课程：*`@implementation MyClass`*

 *在 .h 文件中：

```
@interface MyClass {
    // My Instance Variables
}

- (void)myPublicMethod;

@end 
```

在 .m 文件中：

```
@interface MyClass()

- (void)myPrivateMethod;

@end

@implementation MyClass

- (void)myPublicMethod {
    // Implementation goes here
}

- (void)myPrivateMethod {
    // Implementation goes here
}

@end 
```

我认为这种方法的最大优点是它允许您按功能对方法实现进行分组，而不是按（有时是任意的）公共/私有区分。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-10-06T05:49:46.810

Objective-C 中并没有真正的“私有方法”，如果运行时可以确定使用哪个实现，它就会做到这一点。但这并不是说没有不属于文档化接口的方法。对于那些方法，我认为一个类别很好。而不是`@interface`像您的第 2 点那样将 .m 文件放在顶部，而是将其放入自己的 .h 文件中。我遵循的一个约定（并且在其他地方看到过，我认为这是一个 Apple 约定，因为 Xcode 现在自动支持它）是在它的类和类别之后用 + 分隔它们来命名这样的文件，所以`@interface GLObject (PrivateMethods)`可以在`GLObject+PrivateMethods.h`. 提供头文件的原因是您可以将其导入单元测试类:-)。

顺便说一句，就 .m 文件末尾附近的实现/定义方法而言，您可以通过实现 .m 文件底部的类别来使用类别：

```
@implementation GLObject(PrivateMethods)
- (void)secretFeature;
@end 
```

或者使用类扩展（你称之为“空类别”的东西），最后定义这些方法。Objective-C 方法可以在实现中以任何顺序定义和使用，因此没有什么可以阻止您将“私有”方法放在文件末尾。

即使使用类扩展，我也会经常创建一个单独的标题 ( `GLObject+Extension.h`)，以便我可以在需要时使用这些方法，模仿“朋友”或“受保护”的可见性。

由于最初编写了这个答案，clang 编译器已经开始对 Objective-C 方法进行两次传递。这意味着您可以完全避免声明您的“私有”方法，无论它们是在调用站点之上还是之下，编译器都会找到它们。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-05T22:03:16.753

虽然我不是 Objective-C 专家，但我个人只是在我的类的实现中定义方法。当然，它必须在调用它的任何方法之前（上面）定义，但它肯定需要最少的工作量。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-05-26T09:45:48.773

在块中定义您的私有方法`@implementation`对于大多数用途来说是理想的。`@implementation`无论声明顺序如何，Clang 都会在 中看到这些。无需在类延续（又名类扩展）或命名类别中声明它们。

在某些情况下，您需要在类延续中声明方法（例如，如果在类延续和 之间使用选择器`@implementation`）。

`static`函数对于特别敏感或速度关键的私有方法非常有用。

命名前缀的约定可以帮助您避免意外覆盖私有方法（我发现类名作为前缀安全）。

命名类别（例如`@interface MONObject (PrivateStuff)`）不是一个特别好的主意，因为加载时可能会发生命名冲突。它们实际上只对朋友或受保护的方法有用（这很少是一个好的选择）。为确保您被警告不完整的类别实现，您应该实际实现它：

```
@implementation MONObject (PrivateStuff)
...HERE...
@end 
```

这是一个带注释的备忘单：

MONObject.h

```
@interface MONObject : NSObject

// public declaration required for clients' visibility/use.
@property (nonatomic, assign, readwrite) bool publicBool;

// public declaration required for clients' visibility/use.
- (void)publicMethod;

@end 
```

MONObject.m

```
@interface MONObject ()
@property (nonatomic, assign, readwrite) bool privateBool;

// you can use a convention where the class name prefix is reserved
// for private methods this can reduce accidental overriding:
- (void)MONObject_privateMethod;

@end

// The potentially good thing about functions is that they are truly
// inaccessible; They may not be overridden, accidentally used,
// looked up via the objc runtime, and will often be eliminated from
// backtraces. Unlike methods, they can also be inlined. If unused
// (e.g. diagnostic omitted in release) or every use is inlined,
// they may be removed from the binary:
static void PrivateMethod(MONObject * pObject) {
    pObject.privateBool = true;
}

@implementation MONObject
{
    bool anIvar;
}

static void AnotherPrivateMethod(MONObject * pObject) {
    if (0 == pObject) {
        assert(0 && "invalid parameter");
        return;
    }

    // if declared in the @implementation scope, you *could* access the
    // private ivars directly (although you should rarely do this):
    pObject->anIvar = true;
}

- (void)publicMethod
{
    // declared below -- but clang can see its declaration in this
    // translation:
    [self privateMethod];
}

// no declaration required.
- (void)privateMethod
{
}

- (void)MONObject_privateMethod
{
}

@end 
```

另一种可能不明显的方法：C++ 类型既可以非常快，又可以提供更高程度的控制，同时最大限度地减少导出和加载的 objc 方法的数量。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-03-16T18:54:15.213

您可以尝试在您的实现下方或上方定义一个静态函数，该函数采用指向您的实例的指针。它将能够访问您的任何实例变量。

```
//.h file
@interface MyClass : Object
{
    int test;
}
- (void) someMethod: anArg;

@end

//.m file    
@implementation MyClass

static void somePrivateMethod (MyClass *myClass, id anArg)
{
    fprintf (stderr, "MyClass (%d) was passed %p", myClass->test, anArg);
}

- (void) someMethod: (id) anArg
{
    somePrivateMethod (self, anArg);
}

@end 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-19T16:21:21.230

Objective C 中的每个对象都符合 NSObject 协议，该协议包含**performSelector:**方法。我之前也在寻找一种方法来创建一些我不需要在公共级别公开的“帮助程序或私有”方法。如果您想创建一个没有开销且不必在头文件中定义它的私有方法，那么请试一试...

使用与以下代码类似的签名定义您的方法...

```
-(void)myHelperMethod: (id) sender{
     // code here...
} 
```

然后当您需要引用该方法时，只需将其作为选择器调用...

```
[self performSelector:@selector(myHelperMethod:)]; 
```

这行代码将调用您创建的方法，并且没有关于没有在头文件中定义它的烦人警告。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-17T04:35:28.227

可以用积木吗？

```
@implementation MyClass

id (^createTheObject)() = ^(){ return [[NSObject alloc] init];};

NSInteger (^addEm)(NSInteger, NSInteger) =
^(NSInteger a, NSInteger b)
{
    return a + b;
};

//public methods, etc.

- (NSObject) thePublicOne
{
    return createTheObject();
}

@end 
```

我知道这是一个老问题，但这是我在寻找这个问题的答案时发现的第一个问题。我还没有在其他任何地方看到过这个解决方案的讨论，所以如果这样做有什么愚蠢的，请告诉我。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-08-03T23:48:02.477

如果您想避免`@interface`顶部的块，您总是可以将私有声明放在另一个`MyClassPrivate.h`不理想的文件中，但它不会使实现混乱。

我的类.h

```
interface MyClass : NSObject {
 @private
  BOOL publicIvar_;
  BOOL privateIvar_;
}

@property (nonatomic, assign) BOOL publicIvar;
//any other public methods. etc
@end 
```

MyClassPrivate.h

```
@interface MyClass ()

@property (nonatomic, assign) BOOL privateIvar;
//any other private methods etc.
@end 
```

我的班级.m

```
#import "MyClass.h"
#import "MyClassPrivate.h"
@implementation MyClass

@synthesize privateIvar = privateIvar_;
@synthesize publicIvar = publicIvar_;

@end 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-02-14T03:08:12.023

我在这里没有看到的另一件事 - Xcode 支持名称中带有“_private”的 .h 文件。假设你有一个 MyClass 类——你有 MyClass.m 和 MyClass.h，现在你也可以有 MyClass_private.h。Xcode 将识别这一点并将其包含在助手编辑器的“对应部分”列表中。

```
//MyClass.m
#import "MyClass.h"
#import "MyClass_private.h" 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-16T18:33:08.430

没有办法绕过问题 #2。这就是 C 编译器（以及因此的 Objective-C 编译器）的工作方式。如果您使用 XCode 编辑器，函数弹出窗口应该可以轻松浏览文件中的`@interface`和`@implementation`块。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-08T07:31:36.810

没有私有方法有一个好处。您可以将您打算隐藏的逻辑移动到单独的类并将其用作委托。在这种情况下，您可以将委托对象标记为私有，并且从外部看不到它。将逻辑移动到单独的类（可能有几个）可以更好地设计您的项目。导致您的类变得更简单，并且您的方法被分组在具有正确名称的类中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-24T23:32:19.940

正如其他人所说，在`@implementation`块中定义私有方法对于大多数用途都是可以的。

关于**代码组织**的主题- 我喜欢将它们放在一起`pragma mark private`以便在 Xcode 中更轻松地导航

```
@implementation MyClass 
// .. public methods

# pragma mark private 
// ...

@end 
```

# sql - 工具：从 ODBC 到 SQL 05 的 ETL？

> ID：172599
> 
> 赞同：0
> 
> 时间：2008-10-05T20:30:49.543
> 
> 标签：sql, database, odbc, etl

我只想要一个简单的工具，它可以帮助我快速编写可以安排运行的脚本/包。我的转换要求非常简单（更改列名、合并/拆分表和日期转换）。我会牺牲灵活性来提高开发速度。

有没有想到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T20:33:39.880

我喜欢 Pentaho 数据集成工具（也称为水壶）——虽然这可能有点“对你来说太大了……但值得一试！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T00:59:40.157

SQL Server 2005？SSIS（但我不会说它简单，但又在你给出的东西列表之外，只有命名真的很简单）

您实际上可以使用 C#（.NET/whatever，甚至可能是 PowerShell）编写包创建脚本。

[这里](http://blogs.conchango.com/jamiethomson/archive/2007/03/28/SSIS_3A00_-Building-Packages-Programatically.aspx)和[这里的](http://msdn.microsoft.com/en-us/library/ms345167.aspx)资源

编辑：（希望你不介意我在这里插话 Cade）检查你的 ODBC 驱动程序是否与 SSIS 配合得很好。某些驱动程序（例如 DB2/400 和某些版本的 Sybase）不能很好地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-07T14:06:42.063

至少在旧版本的 SQL Server 中，它们附带了 DTS。不是最简单的，但它确实适用于 ODBC 和 SQL Server，而且您可能已经拥有它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T21:57:44.697

一些 SQL 开发工具，例如[Advanced Query Tool](http://www.advancedquerytool.com) (AQT)，让您可以使用命令文件进行轻量级 ETL 和调度......我们有 Informatica，但我使用 AQT 从 Oracle 写入文件，用于短期请求......

# c# - 键入泛型值 (C#)

> ID：172600
> 
> 赞同：13
> 
> 时间：2008-10-05T20:31:05.610
> 
> 标签：c#, generics

当我使用 this.value 为 T 的泛型类尝试此操作时：

```
if (this.value.GetType() == typeof(int))
{
    ((int)this.value)++;
}
else
{
    throw new InvalidOperationException
            ("T must be an int to perform this operation");
} 
```

我收到一个编译时错误：“无法将类型 'T' 转换为 'int'”

当 this.value 是 int 时，我应该怎么做才能对 this.value 执行积分运算？

请注意，这只是一个示例。该代码使用泛型进行类型转换，“int”只是 T 的一种类型的示例。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-05T20:51:06.210

不幸的是，很难让编译器相信特定的 T 实现。一种（讨厌的）方法是在中间强制转换为对象（注意这将装箱和拆箱值类型）：

```
int i = (int)(object)this.value;
i++;
this.value = (T)(object)i; 
```

丑陋但有效。在 .NET 3.5 中，我有一些更好的通用算术包装器，[这里](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html). Operator 类是[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)的一部分；在最简单的层面上，我怀疑 AddAlternative 会很好地工作：

```
this.value = Operator.AddAlternative(this.value, 1); 
```

这应该会自动推断出隐含的 <T,int> ，或者您可以自己添加它们：

```
this.value = Operator.AddAlternative<T,int>(this.value, 1); 
```

**好处**：这比原始代码更可取，因为它实际上并不关心原始 T - 它适用于支持“T +（T，int）”的任何类型（甚至是您自己的）。

我认为那里的某个地方还隐藏着一个 ChangeType ......

[编辑] Collin K 和其他人对架构含义发表了有效的评论——但务实的时候，T 确实很重要……但我同意避免这种类型的专业化，除非*真的*有必要。也就是说（根据我对 Collin 帖子的评论），能够在（例如）Matrix<T> [for T in decimal/float/int/double/ 上执行基本算术（增量、Int32 除法等）等等]通常是非常有价值的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-05T21:05:52.563

在我看来，泛型类中特定于类型的代码是一种代码异味。我会重构它以获得这样的东西：

```
public class MyClass<T>
{
 ...
}

public class IntClass : MyClass<int>
{
  public void IncrementMe()
  {
    this.value++;
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-05T20:56:17.370

C# 的静态类型不允许您这样做，但您可以通过强制转换为对象来欺骗它。我不建议这样做，它可能显示架构问题，但无论如何：

```
using System;

class Foo<T>
{
  public T value;

  public void Increment()
  {
   if (value is int) value = (T)(object)(((int)(object)value)+1);
  }
}

static class Program
{
    static void Main()
    {
     Foo<int> x = new Foo<int>();
     x.Increment();
     x.Increment();
      Console.WriteLine(x.value); 
    }     
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T20:58:50.127

我想我不明白你在追求什么。如果您要求某些东西是特定类型，那么您可能不应该使用泛型。你可以，只是看起来很傻。这将满足您的要求，但我不建议这样做。

```
namespace GenericsOne
{
    using System;

class Program
{
    static void Main(string[] args)
    {
        Sample<int> one = new Sample<int>();
        one.AddFive(10);

        // yes, this will fail, it is to show why the approach is generally not a good one.
        Sample<DateTime> two = new Sample<DateTime>();
        two.AddFive(new DateTime());
    }
}

}

namespace GenericsOne
{
    using System;
public class Sample<T>
{
    public int AddFive(T number)
    {
        int junk = 0;

        try
        {
            junk = Convert.ToInt32(number);
        }
        catch (Exception)
        {
            Console.WriteLine("Nope");
        }

        return junk + 5;
    }
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T07:33:06.553

这就是为什么我真的想要[C#4 中的](https://stackoverflow.com/questions/138367#138628)数字或操作约束。

@Marc Gravell 的回答是解决这个问题的最佳方法（+1），但令人沮丧的是，这对泛型来说是个问题。

# objective-c - Objective-C 是编译成原生代码还是字节码？

> ID：172614
> 
> 赞同：10
> 
> 时间：2008-10-05T20:35:40.720
> 
> 标签：objective-c, linux, cocoa, macos

在 OS X 上，Objective-C 是编译为本机代码还是字节码？

可以在 Linux 上编译 Objective-C 程序吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-05T20:40:25.950

Objective-C 由 GCC 或 LLVM[*] 编译为本机代码。您可以在 Linux 上编译 ObjC 程序（通用 GCC 很乐意支持 ObjC，尽管它使用的运行时库与 Apple 的任何一个都不同）。对于类似于 Cocoa（即源自 Cocoa）的跨平台 API，它可以在 Linux 上愉快地工作并让您在 OS X 和 Linux 之间移植一些代码，请查看 GNUstep：[http ://www.gnustep.org](http://www.gnustep.org)

[*]事实上，LLVM 在内部将 Objective-C 编译为内部位码表示，然后为目标机器编码，所以答案可能是“两者”……</p>

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-05T20:45:23.210

是原生的。

[GNUstep](http://www.gnustep.org/information/aboutGNUstep.html)是用 Objective-C 编写的 NeXT OpenStep 规范的开源实现。他们对 Cocoa API 的实现不是直接匹配的，因此无法直接编译而无需移植。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-05T20:40:08.837

是的，Objective-C 编译为机器码。

存在用于 Linux 的 Objective-C 编译器，但 Cocoa 是一种仅适用于 OS X 的技术。我听说过一个名为 GNUstep 的开放式替代品，但对它了解不多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T20:39:56.843

Objective-C 是 C 的变体。它编译为本机代码。

# web-services - 一个轻松创建自定义网站的平台？

> ID：172631
> 
> 赞同：0
> 
> 时间：2008-10-05T20:47:48.620
> 
> 标签：web-services

我从事托管客户网站的小型企业，很多时候他们要求我从头开始创建一个。我不是设计师，但我可以编写 CSS/HTML、AJAX、PHP 代码。但是，我*不愿意*从头开始创建站点，因为我知道涉及多少。

过去，我尝试过使用设计模板，但事实证明它们效率低下——客户会要求更改，而我无法帮助他们，因为我没有编写模板。客户自己将无法进行更改。

所以，问题是：**是否有基于 Web 的软件可以轻松创建带有皮肤/布局/模板的自定义网站？它应该允许非技术人员添加内容并进行基本修改。**我已经看到一些网站为此目的使用[Wordpress](http://codex.wordpress.org/Getting_Started_with_WordPress)，但不知道这是否是一个不错的选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-05T20:51:35.477

如果它必须很容易，那么看看像 Joomla 这样的东西。如果您想要更多控制，请尝试 Drupal。如果我的预感是正确的，我认为两者都比 WordPress 更适合你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T22:15:00.643

不，Joomla 又大又重，不是一个可靠的解决方案。我推荐你[Movable Type](http://www.movabletype.org/)。它是用 PERL 编写的，但原生支持多站点和多域。这有点酷 :) 此外，您可以尝试[Expression Engine](http://expressionengine.com/) ，它还为多域用户提供了一些不错的功能，只需一个设置。无论如何，最好的解决方案是为此构建一个自定义解决方案，但当然，您将不再只是一家托管公司：D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T22:51:08.137

我认为您基本上是在寻找CMS。现在的问题是那里有这么多的CMS，选择一个可能会让人不知所措。多年来我注意到的另一件事是，有大量的 CMS 系统可供选择，其中涉及很多个人品味。要选择最适合您的，您需要尝试一堆。我建议您前往[CMSMatrix](http://www.cmsmatrix.org/)并浏览分类并熟悉其中一些。

（PS：别忘了试试[Drupal](http://www.drupal.org)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T00:22:28.920

我在一个非常简单的网站上使用了 Wordpress，这证明是一个正确的决定。您可以在以下网址查看该网站：[Chhobi.net](http://www.chhobi.net)。如果您没有很多复杂的要求，我认为 Wordpress 不是一个坏主意。如果您以后需要扩展站点并添加不同的功能（如论坛、图库、投票等），您最好选择合适的 CMS 解决方案，如 Joomla、Drupal 等。

# .net - 如何在我的 .NET App.Config 文件中存储 XML 值

> ID：172646
> 
> 赞同：7
> 
> 时间：2008-10-05T20:54:14.490
> 
> 标签：.net, xml, configuration, app-config

我正在尝试在我的 app.config 文件中存储一个 xml 值。app.config 不喜欢这样，我不能使用该`<![CDATA[`构造来忽略我的价值的 XML'ness。

有没有办法做到这一点？

值示例：`<FieldRef Name='LinkfileName' Nullable='True'/><FieldRef Name='Web' Nullable='True'/>`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-05T21:08:05.990

如果对字符实体进行转义，则可以将 XML 文档另存为属性值中的文本：

```
&lt;FieldRef Name=&quot;Linkfilename&quot; ... 
```

然后，您可以使用 XmlDocument.Load() 来解析文本值。

请注意，这不适用于您的示例，因为您的值是 XML 文档片段而不是格式正确的 XML 文档。您要么需要将其包装在封闭的文档元素中（其标记仍将被转义），要么在从配置中检索到该值后使用正确初始化的 XmlReader 来处理该值。

# sql - 是否有公认的理想标记模式

> ID：172648
> 
> 赞同：22
> 
> 时间：2008-10-05T20:54:45.703
> 
> 标签：sql, schema, tagging

我有一个照片网站，我想支持标签，因为我的原始类别分桶开始失败（有些照片是家庭和假期，或学校和朋友）。是否有商定的标记数据库模式？

我仍然想支持将照片作为相册的一部分。

现在我有几张桌子：

**相片**

*   照片ID
*   相册ID
*   标题
*   日期

**相片集**

*   专辑编号
*   专辑名称
*   专辑日期

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-05T20:58:41.827

有多种有效的模式，随着标记项目数量的增加，每种模式对您需要的常见查询都有自己的性能影响：

*   [http://howto.philippkeller.com/2005/04/24/Tags-Database-schemas/](http://howto.philippkeller.com/2005/04/24/Tags-Database-schemas/)
*   [http://howto.philippkeller.com/2005/06/19/Tagsystems-performance-tests/](http://howto.philippkeller.com/2005/06/19/Tagsystems-performance-tests/)

就个人而言，我喜欢有一个标签表和一个将标签与项目相关联的链接表，因为它是非规范化的（没有重复的标签名称），并且我可以在必要时在链接表中存储额外的信息（例如项目被标记的时间）。

如果您感觉活泼并且想要简单的选择，您还可以添加一些非规范化数据，但代价是通过在标签表中存储使用计数或存储在项目表本身中使用的标签名称以避免命中所需的额外数据维护每个项目的链接表和标签表，这对于显示带有所有标签的多个项目以及简单的标签版本控制很有用......如果你喜欢那种东西;）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-05T23:24:25.980

我在一个没有很多用户的小型系统中完成了这项工作，但我之前想知道是否有一种“公认”的方式来管理标签。在阅读了 insin 发布的链接和许多其他关于标记的博客文章之后，似乎可以接受的方式是将其完全标准化存储并在数据集太大时缓存某些内容。

由于它是多对多关系（每个标签可以属于任意数量的照片 - 每张照片可以有很多标签），关系数据库理论让您创建一个照片表、一个标签表和一个交叉引用表来链接它们。

```
photos
  photoid
  caption
  filename
  date

tags
  tagid
  tagname

phototags
  photoid
  tagid 
```

这存在从非常大的数据集中选择的缩放问题，但所有标准化程度较低的模式也是如此（例如，通过文本字段进行排序和过滤可能总是比使用整数慢）。如果你变得和美味一样大，甚至可能是 StackOverflow，你可能不得不对你的标签集做一些缓存。

您必须面对的另一个问题是标签规范化问题。这与数据库规范化没有任何关系——它只是确保（例如）“StackOverflow”、“stackoverflow”和“stackoverflow”标签是相同的。许多地方不允许空格或自动将其删除。有时你会看到相同的标点符号 - 使“StackOverflow”与“Stack-Overflow”相同。自动小写是相当标准的。你甚至会看到特殊情况的规范化——比如让“c#”和“csharp”一样。

快乐标记！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T21:00:02.340

我想到了这样的事情：添加这两个表

**标签**

*   标签ID
*   标签名称
*   标签描述

**照片标签**

*   照片ID
*   标签ID

您也可以将其扩展到相册，在相册和标签之间有一个交叉表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T21:01:52.397

我建议看看成熟的开源软件是如何做到的。例如，[Gallery](http://gallery.menalto.com/)像您一样将其元数据存储在数据库中，并且非常丰富。

不过，我认为您不会找到“标准”模式。我能想到的最接近的东西是 EXIF 元数据格式，它嵌入在图像文件本身（通过相机等）中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-05T21:33:10.573

如果您想要拥有数百万条记录的真正性能，您可以将标签存储在一个字段中，以逗号分隔并使用像 sphinxsearch 这样的全文索引/搜索守护程序检索记录。您只需要添加一个表格，其中列出了带有计数值的所有标签，以了解它们连接到项目的频率。

我知道这不是通常的方式，而且比纯数据库解决方案稍微复杂一些，但搜索标签相关项目确实非常快。

您也可以使用数据库引擎的全文搜索功能，但是当记录很多时，大多数引擎往往很慢。

如果是针对一个小项目，你可以按照自己的方式，接缝好的和正确的方式去做。但我只想与您分享这个其他解决方案。你觉得......怎么样 ？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-06T15:44:08.700

关于如何处理标签的快速说明：

标记系统可以从非常严格定义的标记，其中创建新的标记需要明确的额外工作（想想 gmail 标签）到非常松散的系统，其中鼓励添加尽可能多的标签（想想 flickr，或标记可能应用转录的音频内容直接作为标签）。

一般来说，易于索引的媒体（文本！）应该有一个更严格的系统，因为内容已经是可搜索的。*附加标签更多地仅用于分类，并且分类仅在不同用户将事物广泛分配到相同类别*时才有用。如果你有原始文本，创建一个新标签几乎需要上帝的作为。

另一方面，更难索引的媒体（图像、视频、音频）应该有一个灵活的系统来鼓励使用许多标签，因为它们和其他元数据是您搜索时的唯一希望。

这很重要，因为您想要的数据库架构可能会根据您发现自己的范围而有所改变。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-05T23:37:21.023

在我的应用程序 BugTracker.NET 中，我假设不会有太多错误。也许是几万，但不是几千万。这个假设允许我缓存标签和它们引用的项目的 ID。

在数据库中，标签在输入时与错误一起存储在逗号分隔的文本字段中。

添加或更改标签字段时，会启动一个后台线程，该线程会选择所有 bugid 及其标签，解析文本，构建一个映射，其中键是标签，值是具有该标签的所有 id 的列表. 然后我将该映射缓存在 Asp.Net Application 对象中。

下面是我刚刚描述的代码。

可以对代码进行优化，这样它就不会遍历所有错误，而是逐步修改缓存的地图，但即使未优化，它也能正常工作。

当有人使用标签进行搜索时，我会在地图中查找值，获取 id 列表，然后使用带有“where id in (1, 2, 3...)”子句的 SQL 获取这些错误。

```
 public static void threadproc_tags(object obj)
    {
        System.Web.HttpApplicationState app = (System.Web.HttpApplicationState)obj;

        SortedDictionary<string,List<int>> tags = new SortedDictionary<string,List<int>>();

        // update the cache
        DbUtil dbutil = new DbUtil();
        DataSet ds = dbutil.get_dataset("select bg_id, bg_tags from bugs where isnull(bg_tags,'') <> ''");

        foreach (DataRow dr in ds.Tables[0].Rows)
        {
            string[] labels = btnet.Util.split_string_using_commas((string) dr[1]);

            // for each tag label, build a list of bugids that have that label
            for (int i = 0; i < labels.Length; i++)
            {

                string label = normalize_tag(labels[i]);

                if (label != "")
                {
                    if (!tags.ContainsKey(label))
                    {
                        tags[label] = new List<int>();
                    }

                    tags[label].Add((int)dr[0]);
                }
            }
        }

        app["tags"] = tags;

    } 
```

# c++ - 使用 Visual Studio 2008（无 SP1）设计选项卡控件

> ID：172653
> 
> 赞同：1
> 
> 时间：2008-10-05T20:57:19.833
> 
> 标签：c++, visual-studio-2008

有**没有办法（可能直接编辑资源文件）在****设计时**使用没有 SP1 的 Visual Studio 2008配置选项卡控件（添加/删除选项卡及其标题和内容）（我听说 SP1 有这样的功能）？PS：我用 c++ 和 wtl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-05T22:18:37.923

Windows 窗体应用程序的表单设计器允许您在设计时配置选项卡控件，但本机 C++ 应用程序的资源编辑器不允许这样做。您只能在运行时将选项卡添加到选项卡控件。（我使用的是 VS2008 SP1。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T08:35:46.787

我不认为这是可能的。对话框脚本不直接支持 Tab 控件，而是插入一个通用的“CONTROL”语句，其中插入了控件“SysTabControl32”。您需要在代码中分配页面。

VS 2008 SP1 中的新功能与 WPF 控件有关，但既然您提到您使用 WTL，我假设您使用的是 win32 对话框资源。

戴夫

# c# - 使用 C# 扩展方法的运算符重载

> ID：172658
> 
> 赞同：184
> 
> 时间：2008-10-05T20:59:03.527
> 
> 标签：c#, extension-methods, operator-overloading

我正在尝试使用扩展方法向 C#`StringBuilder`类添加运算符重载。具体来说，给定`StringBuilder` `sb`，我想`sb += "text"`等效于`sb.Append("text")`。

下面是创建扩展方法的语法`StringBuilder`：

```
public static class sbExtensions
{
    public static StringBuilder blah(this StringBuilder sb)
    {
        return sb;
    }
} 
```

它成功地将`blah`扩展方法添加到`StringBuilder`.

不幸的是，运算符重载似乎不起作用：

```
public static class sbExtensions
{
    public static StringBuilder operator +(this StringBuilder sb, string s)
    {
        return sb.Append(s);
    }
} 
```

除其他问题外，`this`此上下文中不允许使用关键字。

是否可以通过扩展方法添加运算符重载？如果是这样，正确的方法是什么？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-10-05T21:04:11.473

目前这是不可能的，因为扩展方法必须在静态类中，而静态类不能有运算符重载。但该[功能正在讨论 C# 的*某些*未来版本](https://github.com/dotnet/csharplang/issues/192)。[Mads在 2017 年的这段视频中](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Preview-of-C-8-with-Mads-Torgersen#time=32m11s)谈到了更多关于实现它的内容。

C# 语言 PM 的 Mads Torgersen 说：

> ...对于 Orcas 版本，我们决定采取谨慎的方法，只添加常规扩展方法，而不是扩展属性、事件、运算符、静态方法等。常规扩展方法是 LINQ 所需要的，它们有一个语法上最小的设计，对于其他一些成员类型来说是不容易模仿的。
> 
> 我们越来越意识到其他类型的扩展成员可能有用，因此我们将在 Orcas 之后回到这个问题。不过没有保证！

下面在同一篇文章中：

> 我很遗憾地报告我们不会在下一个版本中这样做。我们确实在我们的计划中非常重视扩展成员，并且花了很多精力试图让他们正确，但最终我们无法做到足够顺利，并决定让位于其他有趣的功能。
> 
> 这仍然是我们对未来版本的关注。如果我们获得大量可以帮助推动正确设计的引人入胜的场景，将会有所帮助。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2010-02-03T19:08:09.693

如果您控制要使用此“扩展运算符”的位置（无论如何您通常都使用扩展方法），您可以执行以下操作：

```
class Program {

  static void Main(string[] args) {
    StringBuilder sb = new StringBuilder();
    ReceiveImportantMessage(sb);
    Console.WriteLine(sb.ToString());
  }

  // the important thing is to use StringBuilderWrapper!
  private static void ReceiveImportantMessage(StringBuilderWrapper sb) {
    sb += "Hello World!";
  }

}

public class StringBuilderWrapper {

  public StringBuilderWrapper(StringBuilder sb) { StringBuilder = sb; }
  public StringBuilder StringBuilder { get; private set; }

  public static implicit operator StringBuilderWrapper(StringBuilder sb) {
    return new StringBuilderWrapper(sb);
  }

  public static StringBuilderWrapper operator +(StringBuilderWrapper sbw, string s) { 
      sbw.StringBuilder.Append(s);
      return sbw;
  }

} 
```

该类从 a`StringBuilderWrapper`声明一个[隐式转换运算符](http://msdn.microsoft.com/en-us/library/85w54y0a.aspx)`StringBuilder` *并*声明所需的`+`运算符。这样，`StringBuilder`可以将 a 传递给`ReceiveImportantMessage`，它将被静默转换为 a `StringBuilderWrapper`，`+`可以在其中使用运算符。

为了使这一事实对调用者更透明，您可以声明`ReceiveImportantMessage`为采用 a`StringBuilder`并使用如下代码：

```
 private static void ReceiveImportantMessage(StringBuilder sb) {
    StringBuilderWrapper sbw = sb;
    sbw += "Hello World!";
  } 
```

或者，要在您已经使用 a 的地方内联使用它`StringBuilder`，您可以简单地执行以下操作：

```
 StringBuilder sb = new StringBuilder();
 StringBuilderWrapper sbw = sb;
 sbw += "Hello World!";
 Console.WriteLine(sb.ToString()); 
```

我创建[了一篇](http://codecrafter.blogspot.com/2010/04/more-understandable-icomparable.html)关于使用类似方法以使其`IComparable`更易于理解的帖子。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-05T21:05:59.160

看来这目前是不可能的 - 有一个开放的反馈问题要求 Microsoft Connect 上的这个功能：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=168224](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=168224)

暗示它可能会出现在未来的版本中，但未在当前版本中实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-28T18:14:38.717

哈！我正在以完全相同的愿望查找“扩展运算符重载”，对于`sb += (thing)`.

在阅读了此处的答案（并看到答案为“否”）之后，出于我的特殊需要，我采用了一种扩展方法，它结合了`sb.AppendLine`and `sb.AppendFormat`，并且看起来比任何一个都更整洁。

```
public static class SomeExtensions
{
    public static void Line(this StringBuilder sb, string format, params object[] args)
    {
        string s = String.Format(format + "\n", args);
        sb.Append(s);
    }
} 
```

所以，

```
sb.Line("the first thing is {0}", first);
sb.Line("the second thing is {0}", second); 
```

不是一个一般性的答案，但可能会引起未来寻求此类事物的人的兴趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-17T21:18:32.930

虽然不可能使用运算符，但您始终可以创建 Add（或 Concat）、Subtract 和 Compare 方法......

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;    

namespace Whatever.Test
{
    public static class Extensions
    {
        public static int Compare(this MyObject t1, MyObject t2)
        {
            if(t1.SomeValueField < t2.SomeValueField )
                return -1;
            else if (t1.SomeValueField > t2.SomeValueField )
            {
                return 1;
            }
            else
            {
                return 0;
            }
        }

        public static MyObject Add(this MyObject t1, MyObject t2)
        {
            var newObject = new MyObject();
            //do something  
            return newObject;

        }

        public static MyObject Subtract(this MyObject t1, MyObject t2)
        {
            var newObject= new MyObject();
            //do something
            return newObject;    
        }
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-27T23:51:45.837

Its possible to rigg it with a wrapper and extensions but impossible to do it properly. You end with garbage which totally defeats the purpose. I have a post up somewhere on here that does it, but its worthless.

Btw All numeric conversions create garbage in string builder that needs to be fixed. I had to write a wrapper for that which does work and i use it. That is worth perusing.

# javascript - 创建从 RSS 源更新的新闻代码 - Javascript/任何语言

> ID：172663
> 
> 赞同：0
> 
> 时间：2008-10-05T21:00:38.517
> 
> 标签：javascript, rss, news-ticker

我需要创建一个通过 RSS 提要更新的新闻代码。关于如何实现这一点的任何想法？

我更喜欢 Javascript，但任何语言都是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T21:11:08.447

[这个 DynamicDrive 页面](http://www.dynamicdrive.com/dynamicindex17/rsstickerajax/index.htm)上有几个很好的例子，尽管其中一个要求是您可以在您的站点上运行 PHP。这里的 PHP 用于获取实际的提要并允许您的代码通过 AJAX 调用在本地访问它们。

还有其他几个基于 JQuery 的项目，每个项目采用的基本方法是：

*   使用 PHP（或 ASP.net）脚本将提要获取到您的服务器。

*   通过重复的 AJAX 调用访问这个本地文件，使用[setTimeout](http://www.w3schools.com/js/js_timing.asp)

*   使用获取的最新数据更新显示（代码）

由于同源[策略](http://en.wikipedia.org/wiki/Same_origin_policy)，该文件被提取到您的本地服务器以进行 AJAX 调用：

> 它防止从一个“源”加载的文档或脚本从不同的“源”获取或设置文档的属性。

* * *

进一步的例子包括：

*   [Jason 工具箱中的 JTicker](http://www.jasons-toolbox.com/JTicker/)

*   [JQuery feed 插件](http://blogs.atalayasec.org/dev/2008/02/jquery-rss-feed-reader-plugin/)- 需要阅读关于这个的评论，因为最初发布的代码似乎不能开箱即用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T22:55:17.723

如果您确实有一个不错的利基市场，您的新闻自动收报机可能会非常受欢迎，您可能希望“在他们的桌面上”并使用[Adob​​e Air](http://www.adobe.com/products/air/)开发一个小部件。

您可以使用您喜欢的任何 javascript（或 flash/flex，这也受支持）创建一个漂亮的滚动代码

# .net - WCF 数据合同

> ID：172681
> 
> 赞同：13
> 
> 时间：2008-10-05T21:20:16.527
> 
> 标签：.net, wcf, datacontract, serialization

我有一个为内部客户端托管的 WCF 服务——我们可以控制所有客户端。因此，我们将使用数据合约库来消除对代理生成的需求。我想使用一些只读属性并有一些没有默认构造函数的数据契约。谢谢你的帮助...

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-05T21:31:16.583

只要将（非只读）字段标记为 [DataMember]，而不是属性，只读属性就可以了。与 XmlSerializer 不同，IIRC DataContractSerializer 不使用默认 ctor - 它使用单独的反射机制来创建未初始化的实例。除了在 mono 的“ [Olive](http://www.mono-project.com/Olive) ”（WCF 端口）上，它*确实*使用了默认的 ctor（目前，或者在最近的某个时间点）。

例子：

```
using System;
using System.IO;
using System.Runtime.Serialization;
[DataContract]
class Foo
{
    [DataMember(Name="Bar")]
    private string bar;

    public string Bar { get { return bar; } }

    public Foo(string bar) { this.bar = bar; }
}
static class Program
{
    static void Main()
    {
        DataContractSerializer dcs = new DataContractSerializer(typeof(Foo));
        MemoryStream ms = new MemoryStream();
        Foo orig = new Foo("abc");
        dcs.WriteObject(ms, orig);
        ms.Position = 0;
        Foo clone = (Foo)dcs.ReadObject(ms);
        Console.WriteLine(clone.Bar);
    }
} 
```

# asp.net - 让经验丰富的编码人员快速掌握 ASP.NET

> ID：172682
> 
> 赞同：5
> 
> 时间：2008-10-05T21:22:25.320
> 
> 标签：asp.net

我与客户签订了一份合同，用于开发一个用于捕获/操作/显示一组相当复杂的营销数据的 Intranet 应用程序。我以前做过这种事情，所以分析、数据库等对我来说没有问题，但客户很可能更喜欢 ASP.NET，因为他们在这方面有一些（少量）经验。

我当前的 Web 应用程序默认语言是 PHP，尽管我前段时间编写了一些 ASP。我已经编码了 20 年，掌握了一堆语言和技术——包括 Perl、Java、VB、Delphi 和 C——所以学习一个新环境并不让我担心，但我还是想得到以最少的努力和尽可能快的速度达到速度。

您会推荐哪些书籍、网站或其他资源来最有效地实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-05T21:27:02.410

由于您是一位经验丰富的编码员，因此我建议您直接潜入其中，您会随时掌握。从你的技能列表来看，它最像 Delphi（事件驱动编程）。

[http://www.codeproject.com](http://www.codeproject.com)很有帮助，有很多关于 ASP.NET 的文章，包括面向初学者和专家的文章。

我还建议另一种选择：ASP.NET 的另一种实现称为 ASP.NET MVC ( [http://www.asp.net/mvc/](http://www.asp.net/mvc/) )。有了你的背景，我觉得这会更有意义，我个人认为它是一个比 WebForms 更好的平台。我也相信这个网站（stackoverflow）是使用它构建的。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T21:29:25.243

学习 ASP.NET 的事情是，您应该首先了解 .NET 框架及其工作原理，因为与您熟悉的其他解释语言相比，幕后发生的事情要多得多。在此之后，您需要决定您将在 .

一旦你准备好让你的脚湿透，给自己准备一本书（供参考）和所有网站参考资料，你就可以开始了。对于一本书，我会推荐 O'Reily 的 ASP.NET 书或[ASP.Net 2.0 Anthology](http://www.sitepoint.com/books/aspnetant1/)（如果您打算使用 C# 编写 ASP.NET 2.0 和代码）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-05T21:35:35.590

官方 ASP.NET 论坛 ( [http://forums.asp.net/](http://forums.asp.net/) ) 将是一个很大的帮助和快速参考和帮助。然后我总是喜欢去 w3schools 获得快速教程 ( [http://www.w3schools.com/ASPNET/](http://www.w3schools.com/ASPNET/).These) )。这些代码片段将让您快速熟悉 ASP.NET 概念。

C# 2008 中的 Pro ASP.NET 3.5 是一本好书，您应该将其用作参考，并且您应该熟悉 ASP.NET AJAX 组件。为此我建议开始 ASP.NET 2.0 AJAX

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-05T22:19:18.857

如果您必须为 asp.net 使用 Web 表单，那么事件模型将为您带来很多痛苦和痛苦，因为您来自 Web 开发人员的思维模式，认为请求/响应简单（这是一件*好事*）。

首先要深入了解 asp.net 请求的生命周期。了解 IHttpModules、IHttpHandlers，然后是 asp.net Page（只是 IHttpHandler 的一个实现）。

否则，我还建议您研究 MVC 实现。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-05T21:26:33.207

[asp.net](http://www.asp.net/)是一个很棒的网站，有大量的入门资源和[视频。](http://www.asp.net/learn/videos/#howdoi)我会下载 VS Express 并开始浏览视频。

# objective-c - 如何判断用户是否使用 Cocoa 使用 24 小时时间

> ID：172691
> 
> 赞同：2
> 
> 时间：2008-10-05T21:28:30.893
> 
> 标签：objective-c, cocoa, macos

我正在尝试确定用户使用的是 24 小时还是 12 小时时间，除了创建 NSDateFormatter 并搜索句点字段的格式字符串（'a ' 特点）

这就是我现在正在做的事情：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setTimeStyle:NSDateFormatterShortStyle];
NSRange range = [[formatter dateFormat] rangeOfString:@"a"];
BOOL is24HourFormat = range.location == NSNotFound && range.length == 0;
[formatter release]; 
```

哪个有效，但感觉有点脆弱。必须有更好的方法，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T22:16:02.217

此信息在 NSUserDefaults 中提供。也许在 NS ShortTimeDateFormatString 键下？（当然仍然需要解析）。

（采用

```
NSLog(@"%@", [[NSUserDefaults standardUserDefaults] dictionaryRepresentation]); 
```

转储所有预定义的用户默认值）。

不太清楚你为什么要这样做——我敢打赌你有充分的理由——但也许最好只使用 NSDateFormatter 中的默认值来代替？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T02:33:30.933

NSShortTimeDateFormatString 已被弃用，我相信它在 10.5 及更高版本中也不起作用。请参阅 10.4 和 10.5 Foundation 发行说明。转储所有默认值是依赖于接口无法保证的东西的好方法，尽管看看引擎盖下发生了什么可能会很有趣。

你为什么需要这个？正如 schwa 所说，如果您无需了解有关本地化演示的任何信息，一切都会变得更好。

# database - 在一个项目中，是否有数据库系统的选择？

> ID：172706
> 
> 赞同：6
> 
> 时间：2008-10-05T21:36:58.490
> 
> 标签：database

在几乎所有项目中，数据库系统的选择“几乎”是自动的。如果您在“Microsoft 堆栈”中编码，您将使用 SQLServer，在 Linux 世界中默认是 MySQL，而对于企业 in-房子项目大多数商店已经决定使用一些默认值，如 Oracle 或 IBM DB2。

你怎么认为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T21:45:19.830

我尝试了所有三种方法。我仍然将 MySQL 用于网站，但对于内部项目，我宁愿选择[Firebird](http://www.firebirdsql.org)或 Postgres。

原因是它们是免费的（在啤酒和演讲中），不那么臃肿（例如，Firebird 安装程序只有几 MB）并且仍然可以很好地完成工作。

您获得的主要好处是，同样的东西可以从嵌入式扩展到*企业*级，因此没有*“第一次尝试是免费的，但你以后会付出很多”之*类的故事。[我已经看到 200+ GB 的 Firebird 数据库在我制作的嵌入式应用程序](http://www.guacosoft.com/attic)中工作得和 1MB 一样好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T21:39:31.637

我的客户经常规定我们将使用什么数据库引擎。我们定期针对非 SQLServer 数据库编写 .net 应用程序。从长远来看，这对客户更好，因为他们可以维护他们所知道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T22:10:18.873

如果客户或商店没有偏好，这些似乎是合乎逻辑的选择。如果您不能 100% 确定部署环境，最好针对多个数据库测试您的应用程序，以确保您没有使用某个特定数据库的任何特殊功能。如果您确实决定必须使用将您“锁定”到数据库中的特殊功能，那么您最好尽早了解它并做出明智的决定，而不是陷入使用不知情的功能将您锁定在特定数据库中的陷阱.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T22:48:19.547

我不知道我是否同意 Unix 世界中的选择如此简单。Postgres 和 MySQL 一直在针锋相对，选择并不像你想象的那么清晰。也就是说，它们是 Unix 上使用的许多其他数据库（例如，sqlite 为许多嵌入式系统提供动力，甚至在桌面上占有一席之地（例如，在 Fedora 的 YUM 包配置实用程序中））。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T21:45:08.973

我在一份政府合同上工作，当我们在“Microsoft Stack”中编码时，我们不能使用 SQL Server，因为政府免费获得了 Oracle，并希望我们改用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-05T21:51:41.970

我工作过的大多数环境都使用了各种堆栈。我还没有在很大程度上看到任何“堆栈锁定”效应。当没有给出其他规范时，Microsoft 堆栈确实偏爱 SQL Server，而 LAMP 偏爱 MySQL，但我不认为它具有那么强的联系。过去几年我工作的三个主要公司：

医疗软件公司：IIS 上的 ASP.NET C# Stack 和 MySQL 投资银行：*NIX 上的 Java 和 Sybase、Oracle 和 DB2 主要软件供应商（以及这里提到的主要数据库供应商之一！！）：RHEL 上的 Java 和 PostgreSQL

我认为大多数优秀的商店都在逐个项目的基础上评估他们的需求，而不是仅仅根据他们的堆栈集成来选择数据库产品。如果真是这样，甲骨文就不会成为最大的数据库制造商，而 DB2 也将比现在小得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-05T21:52:06.960

也许它是关于舒适的。MS SQL Server Express 版本附带 Visual Studio，因此可以更轻松地设置应用程序以使用 SQL Server。使用 linux 的人习惯于在一秒钟内安装 MySQL、SQLite 或 PostgreSQL，这可能是因为他们不需要 windows 来运行 DBMS。企业项目是另一回事，应该没有舒适和寻找 DBMS 功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-05T22:55:10.627

这将取决于您追求的项目类型，以及使用该技术的企业可以接受哪些平台。

良好的数据库设计——第三范式——将是在大多数情况下评判你的标准。较大的企业可能会迫使您将 Oracle 与 MS 堆栈一起使用。中型企业很可能会使用 SQL Server，但如果他们是来自 Claritas 等来源的人口统计数据的消费者，那么您将获得与应用程序捆绑在一起的 Oracle。

从雇主定位具有技能的人的角度来看，MS SQL 服务器在拥有内部开发部门的企业中更为普遍。

# algorithm - 计算午夜的时间差异

> ID：172711
> 
> 赞同：2
> 
> 时间：2008-10-05T21:39:33.803
> 
> 标签：algorithm, time

这是我永远无法工作的一件事。
我的问题是检测一天的结束和下一天的开始，然后将差异分成每一天。

想象一下，您想计算工资率，但它必须跨越午夜。

它也适用于计算在定时系统上运行的时间，或者它应该运行的时间差异。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-05T21:43:47.743

我更喜欢在 Unix Epoch 中记录所有时间，这样就很简单

```
hoursWorked = ((stopTime - startTime)/60)/60 
```

这是一个完整的解决方案，它使用 PHP，但应该很容易构建到任何语言：

```
<?php
$startTime = "12/31/2008 22:02"; //No AM/PM we'll use 24hour system
$endTime = "01/01/2009 06:27"; //Again no AM/PM and we spaned the midnight time gap.
/*
Use this to test for a normal shift not ocurring durring midnight.
$startTime = "01/01/2008 06:02"; //No AM/PM we'll use 24hour system
$endTime = "01/01/2008 14:27"; //Again no AM/PM and we spaned the midnight time gap.
*/
$startTime = split(' ', $startTime);
$endTime = split(' ', $endTime);
$startTime[1] = split(':', $startTime[1]);
$endTime[1] = split(':', $endTime[1]);
/*
$startTime[0] contains the date
$startTime[1][0] contains the hours
$startTime[1][1] contains the minutes
same is true for endTime
*/
if($startTime[0] != $endTime[0])
 {
    if(date2epoch($endTime[0]) > date2epoch($startTime[0]))
     {
        $minutesWorked1 = (59 - $startTime[1][1]); //Calculate how many minutes have occured from begining of shift to midnight
        $minutesWorked2 = $endTime[1][1]; //Number of minute from midnight to end of shift
        $hoursWorked1 = (23 - $startTime[1][0]);//Number of hours from start of shift to midnight
        $hoursWorked2 = $endTime[1][0];//Number of minutes from midnight to end of shift
        echo 'Before midnight you worked ' . $hoursWorked1 . ':' . $minutesWorked1 . "\nAfter midnight you worked " . $hoursWorked2 . ':' . $minutesWorked2 . '.';
     }
    else 
     {
        //SOMETHING MAJOR BAD HAS HAPPENED WHILE LOGGING THE CLOCKINS AND CLOCKOUTS
     }
 }
else 
 {
    echo 'Today you worked ' . ($endTime[1][0] - $startTime[1][0]) . ':' . ($endTime[1][1] - $startTime[1][1]);
 }
function date2epoch($date, $format='m/d/Y')
 {
    $date = split('/', $date);
    return mktime('0', '0', '0', $date[0], $date[1], $date[2]);
 }
?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-05T22:17:58.843

在开始和结束时间是包含日期和时间的数据结构的系统中，这显然是一个微不足道的问题。但是有很多系统不这样做。计时系统有一个包含日期、开始时间和结束时间的记录是很常见的。在这种情况下，问题就不那么简单了。

我想你要问两个问题：

1.  如何判断时间跨度是否超过午夜？
2.  如果时间跨度超过午夜，第一天发生了多少时间，第二天发生了多少时间？

第一个问题很容易回答：如果结束时间早于开始时间，则时间跨度已超过午夜。

如果是这种情况，那么您需要计算两个金额。日期发生的时间跨度量是开始时间和午夜之间的时间。下一个日期发生的时间跨度量是午夜和结束时间（即结束时间）之间的时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T21:45:39.017

如果您有可用的日期，则应该使用日期+时间的组合，这不会有问题。

如果您知道时间跨度将少于 24 小时：

```
if endtime < starttime then endtime = endtime + 24 hours 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T21:52:31.173

在大多数语言中，日期/日期时间/等。类有这样的方法。使用这些时，最好在执行算术之前将所有日期转换为 UTC。

例如，C#：

```
// In UTC, preferably
DateTime ClockIn;
DateTime ClockOut;

ClockIn = ...;
ClockOut = ...;

TimeSpan TimeWorked = ClockOut.Subtract(ClockIn);
float HoursWorked = TimeWorked.TotalHours(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T00:08:23.457

如果两个时间不在同一个时区，您需要在计算之前将它们转换为 UTC :) 可能不适用于这里，但这是一个常见问题。

# python - 加速 Python

> ID：172720
> 
> 赞同：45
> 
> 时间：2008-10-05T21:46:00.017
> 
> 标签：python, optimization, performance

这确实是两个问题，但它们非常相似，为了简单起见，我想我会把它们放在一起：

*   **首先**：给定一个已建立的 python 项目，除了简单的代码内优化之外，还有哪些不错的方法可以加速它？

*   **第二**：用python从零开始写程序的时候，有什么好办法可以大大提高性能呢？

对于第一个问题，假设您收到了一个写得很体面的项目，并且您需要提高性能，但您似乎无法通过重构/优化获得太多收益。在这种情况下，除了用 C 语言重写它之外，你会怎么做才能加快它的速度？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-05T22:46:37.820

关于《二：用python从零开始写程序的时候，有什么好办法可以大大提高性能？》

记住杰克逊的优化规则：

*   规则1：不要这样做。
*   规则 2（仅适用于专家）：暂时不要这样做。

和 Knuth 规则：

*   “过早的优化是万恶之源。”

更有用的规则在[优化的一般规则中](http://www.cs.cmu.edu/~jch/java/rules.html)。

1.  不要随手优化。先把它弄对。然后快点搞定。优化错误的程序仍然是错误的。

2.  记住 80/20 法则。

3.  始终运行“之前”和“之后”基准。否则，你将不知道你是否找到了 80%。

4.  使用正确的算法和数据结构。这条规则应该是第一位的。没有什么比算法和数据结构更重要了。

**底线**

您无法阻止或避免“优化此程序”的努力。这是工作的一部分。就像设计、代码和测试活动一样，您必须为此做好计划并仔细执行。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-06T02:28:52.957

我建议不要仅仅使用 C，而是：

让你的代码计数。用更少的行执行更多的操作：

*   将算法更改为更快的算法。在许多情况下，不需要花哨的速度更快。
*   使用恰好用 C 语言编写的 python 原语。有些事情会强制解释器调度，而有些事情不会。后者更可取
*   谨防首先构建大数据结构然后对其进行消耗的代码。想想 range 和 xrange 之间的区别。一般来说，通常值得考虑程序的内存使用情况。使用生成器有时可以将 O(n) 内存使用降低到 O(1)。
*   Python 通常是非优化的。在循环中提升不变代码，在紧密循环中尽可能消除常见的子表达式。
*   如果某样东西很贵，那么就预先计算或记忆它。例如，可以编译正则表达式。
*   需要处理数字吗？你可能想检查`numpy`一下。
*   许多 python 程序很慢，因为它们受磁盘 I/O 或数据库访问的限制。确保在等待数据到达时有一些值得做的事情，而不仅仅是阻塞。武器可以是类似于`Twisted`框架的东西。
*   请注意，许多重要的数据处理库都有 C 版本，无论是 XML、JSON 还是诸如此类。它们通常比 Python 解释器快得多。

如果上述所有方法对于分析和测量的代码都失败了，那么请开始考虑 C 重写路径。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-05T22:09:25.583

通常的嫌疑人——分析它，找到最昂贵的线路，弄清楚它在做什么，修复它。如果您之前没有进行过多的分析，可能会有一些大的二次循环或字符串重复隐藏在原本看起来无害的表达式后面。

在 Python 中，我发现导致非明显减速的两个最常见原因是字符串连接和生成器。由于 Python 的字符串是不可变的，因此请执行以下操作：

```
result = u""
for item in my_list:
    result += unicode (item) 
```

每次迭代将复制*整个*字符串两次。这已经很好地涵盖了，解决方案是使用`"".join`：

```
result = "".join (unicode (item) for item in my_list) 
```

发电机是另一个罪魁祸首。它们非常易于使用并且可以极大地简化一些任务，但是应用不佳的生成器将比简单地将项目附加到列表并返回列表要慢得多。

最后，**不要害怕在 C 中重写位！**Python 作为一种动态的高级语言，根本无法达到 C 的速度。如果您无法在 Python 中进一步优化某个函数，请考虑将其提取到扩展模块中。

我最喜欢的技术是同时维护模块的 Python 和 C 版本。Python 版本的编写尽可能清晰明了——任何错误都应该易于诊断和修复。针对这个模块编写你的测试。然后写C版，测试一下。它的行为在所有情况下都应该与 Python 实现的行为相同——如果它们不同，应该很容易找出哪个是错误的并纠正问题。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-05T21:51:10.753

首先想到的是：[psyco](http://psyco.sourceforge.net/)。它暂时只在 x86 上运行。

然后，[不断绑定](http://code.activestate.com/recipes/277940/)。也就是说，使所有全局引用（以及*global.attr*、*global.attr.attr* ...）成为函数和方法内部的局部名称。这并不总是成功的，但总的来说它是有效的。它可以手工完成，但显然很乏味。

您说除了代码内优化之外，因此我不会深入研究，但请保持对`for i in range(10000000)`人们所做的典型错误（想到）保持开放的态度。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-05T22:03:44.940

Cython 和 pyrex 可用于使用类似 python 的语法生成 c 代码。Psyco 也非常适合适合的项目（有时您不会注意到速度提升很多，有时速度会高达 50 倍）。我仍然认为最好的方法是分析您的代码（cProfile 等），然后将瓶颈编码为 python 的 c 函数。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-05T22:54:57.037

我很惊讶没有人提到 ShedSkin：[http](http://code.google.com/p/shedskin/) ://code.google.com/p/shedskin/ ，它会自动将您的 python 程序转换为 C++，并且在某些基准测试中，在速度方面比 psyco 产生了更好的改进。

加上关于简单性的轶事：http: [//pyinsci.blogspot.com/2006/12/trying-out-latest-release-of-shedskin.html](http://pyinsci.blogspot.com/2006/12/trying-out-latest-release-of-shedskin.html)

虽然有限制，请参阅：[http ://tinyurl.com/shedskin-limitations](http://tinyurl.com/shedskin-limitations)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-12T22:27:19.503

我希望你已经阅读：[http ://wiki.python.org/moin/PythonSpeed/PerformanceTips](http://wiki.python.org/moin/PythonSpeed/PerformanceTips)

恢复已经存在的东西通常有 3 个原则：

*   编写可以转换为更好字节码的代码，例如，使用本地变量，避免不必要的查找/调用，使用惯用构造（如果您想要的内容有自然语法，请使用它 - 通常更快。例如：不要这样做：“for key in some_dict.keys()", 做 "for key in some_dict")
*   用 C 编写的任何东西都快得多，滥用你可用的任何 C 函数/模块
*   如有疑问，请导入 timeit、profile

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-29T17:06:02.030

通过使用内置 Python 调用的隐式算法替换用 Python 以手写方式编写的显式算法，通常可以实现接近 C 的速度（对于首先使用 Python 的任何项目来说已经足够接近了！）。这是可行的，因为无论如何大多数 Python 内置程序都是用 C 编写的。好吧，当然是在 CPython 中；-) [https://www.python.org/doc/essays/list2str/](https://www.python.org/doc/essays/list2str/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-05T21:59:06.760

这不一定会加速您的任何代码，但如果您想避免减慢代码速度，则在使用 Python 编程时这是关键知识。“全局解释器锁”（GIL），如果它的行为不被理解，有可能大大降低多线程程序的速度（是的，这让我有点……我有一台不错的 4 处理器机器，它不会一次使用超过 1.2 个处理器）。有一篇介绍性文章，其中包含一些链接，可帮助您开始[使用 SmoothSpan](http://smoothspan.wordpress.com/2007/09/14/guido-is-right-to-leave-the-gil-in-python-not-for-multicore-but-for-utility-computing/)。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-05T22:02:52.557

通过 Python 分析器运行您的应用程序。找到一个严重的瓶颈。在 C 中重写该瓶颈。重复。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-05T22:27:08.543

人们给出了一些很好的建议，但是你必须意识到，当需要高性能时，python 模型是：punt to c。像 psyco 这样的努力在未来可能会有所帮助，但 python 并不是一种快速的语言，而且它的设计初衷也不是。很少有语言能够很好地完成动态工作并且仍然生成非常快的代码；至少在可预见的未来（以及一些反对快速编译的设计作品）会是这样。

因此，如果您真的发现自己处于这种绑定中，最好的选择是隔离系统中在（好）python 中速度不可接受的部分，并围绕您将在 C 中重写这些位的想法进行设计。对不起。好的设计可以帮助减轻这种痛苦。不过，首先在 python 中对其进行原型设计，然后您也可以轻松地对您的 c 进行健全性检查。

毕竟，这对于像 numpy 这样的东西来说已经足够好了。不过，我无法足够强调好的设计对您有多大帮助。如果您只是反复戳您的 python 位并用 C 替换最慢的位，您最终可能会遇到大麻烦。想一想 C 位的确切位置，以及如何合理地最小化和封装它们。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-05T22:45:13.687

关于使用 psyco 的注意事项：在某些情况下，它实际上会产生较慢的运行时间。尤其是在尝试将 psyco 与用 C 编写的代码一起使用时。我不记得我读过的文章了，但是特别提到了 `map()`and`reduce()`函数。幸运的是，您可以告诉 psyco 不要处理指定的函数和/或模块。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-06T01:38:57.377

这是我尝试遵循的程序：

*   进口精神科；psyco.full()
*   如果速度不够快，请通过分析器运行代码，看看瓶颈在哪里。（为此步骤禁用 psyco！）
*   尝试做其他人提到的事情，以尽可能快地获得那些瓶颈的代码。
    *   像 [str(x) for x in l] 或 [x.strip() for x in l] 这样的东西比 map(str, x) 或 map(str.strip, x) 慢得多。
*   在此之后，如果我仍然需要更快的速度，实际上启动 PyRex 并运行起来真的很容易。我先复制一段python代码，直接放到pyrex代码中，看看会发生什么。然后我玩弄它，直到它变得越来越快。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-29T17:16:39.980

关于如何改进 Python 代码的规范参考在这里： [PerformanceTips](http://wiki.python.org/moin/PythonSpeed/PerformanceTips)。我建议不要在 C 中进行优化，除非你真的需要这样做。对于大多数应用程序，您可以通过遵循该链接中发布的规则来获得所需的性能。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-06T17:24:16.003

如果使用 psyco，我建议`psyco.profile()`不要使用`psyco.full()`. 对于一个更大的项目，它会更智能地优化功能并使用更少的内存。

我还建议查看迭代器和生成器。如果您的应用程序使用大型数据集，这将为您节省许多容器副本。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-14T14:32:27.540

除了（伟大的）[psyco](http://psyco.sourceforge.net/)和（漂亮的）[shedskin](http://code.google.com/p/shedskin/)，我建议尝试[cython](http://www.cython.org/)一个伟大的[pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)叉子。

或者，如果您不着急，我建议您等待。更新的 python 虚拟机即将到来，[unladen-swallow](http://code.google.com/p/unladen-swallow/)将成为主流。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-17T12:20:41.167

在提出这个问题后，介绍了几种加速 Python 代码的方法：

*   **Pypy**有一个 JIT 编译器，这使得 CPU 密集型代码的运行速度更快。
*   Pypy 是用 Rpython 编写的，[**Rpython**](https://code.google.com/p/rpython/)是 Python 的一个子集，可以利用 LLVM 工具链编译为本机代码。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-05-01T02:00:31.357

还有 Python → 11l → C++ transpiler，可以从[这里](https://11l-lang.org)下载。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-16T07:33:22.380

对于一个成熟的项目，我觉得主要的性能提升将来自尽可能多地使用 python 内部库。

一些提示在这里：[http ://blog.hackerearth.com/faster-python-code](http://blog.hackerearth.com/faster-python-code)

# c# - 在 System.Data.SQLite 中创建/使用用户定义的函数？

> ID：172735
> 
> 赞同：49
> 
> 时间：2008-10-05T22:00:55.040
> 
> 标签：c#, sqlite, system.data.sqlite

> 用户定义函数和排序序列 完全支持用户定义函数和排序序列意味着在许多情况下，如果 SQLite 没有特性，您可以自己用自己喜欢的 .NET 语言编写它。编写 UDF 和整理序列从未如此简单

我在此处找到的 C# [SQLite ADO.NET](https://web.archive.org/web/20120215000413/http://sqlite.phxsoftware.com/forums/p/348/1457.aspx "SQLite ADO 包装器")提供程序上发现了这一点，并且在理解有关如何实现/使用用户定义函数的文档时遇到了问题。

任何人都可以解释如何为这个迷路的新手提供任何工作示例吗？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-05T23:33:44.073

Robert Simpson 有一个很好的 REGEX 函数示例，您可以在 sqlite 查询中使用：

```
// taken from http://sqlite.phxsoftware.com/forums/p/348/1457.aspx#1457
[SQLiteFunction(Name = "REGEXP", Arguments = 2, FuncType = FunctionType.Scalar)]
class MyRegEx : SQLiteFunction
{
   public override object Invoke(object[] args)
   {
      return System.Text.RegularExpressions.Regex.IsMatch(Convert.ToString(args[1]),Convert.ToString(args[0]));
   }
}

// example SQL:  SELECT * FROM Foo WHERE Foo.Name REGEXP '$bar' 
```

# algorithm - 求DES算法教程

> ID：172739
> 
> 赞同：0
> 
> 时间：2008-10-05T22:03:43.473
> 
> 标签：algorithm, cryptography, des

我正在学习密码学，但不知何故我一直在理解 DES 的工作原理。因为它已经存在了很长时间，所以应该有很好的教程，比如精美的图表、视频等。我搜索但没有运气。有没有人发现大脑“容易消化”的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T22:13:18.977

你查过[维基百科](http://en.wikipedia.org/wiki/Data_Encryption_Standard)吗？它还指向 FIPS 标准。

请注意，现代密码学和“易于大脑”不一定齐头并进......

我敢肯定，如果您感兴趣的话，您可以查看一些开源实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-05T22:21:21.647

Bruce Schneier 的应用密码学可能是你会发现的最有趣的分析，但它肯定不容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-10T02:23:53.350

用java中的字符串模拟des-3des加密解密：

```
public class Filippakoc_Des {
static int[][] sb1={
    {14 , 4 , 13 , 1 , 2 , 15 , 11 , 8 , 3 , 10 , 6 , 12 , 5 , 9 , 0 , 7 },
    {0  , 15,  7 , 4 , 14, 2  ,  13,  1, 10,   6, 12,  11,  9,  5,  3,  8},
    {4  ,  1,  14,  8, 13,   6,   2, 11, 15,  12,  9,   7,  3, 10,  5,  0},
    {15 , 12,   8,  2,  4,   9,   1,  7,  5,  11,  3,  14, 10,  0,  6,  13}
};
 static int[][] sb2={
    {15 , 1 , 8 , 14, 6 ,  11,   3,  4, 9 , 7 ,  2, 13 , 12, 0, 5 ,  10},
    {3  , 13,  4,  7, 15,   2,   8, 14, 12,  0,  1,  10,  6, 9, 11,   5},
    {0  , 14,  7, 11, 10,   4,  13,  1, 5 ,  8, 12,   6,  9, 3,  2,  15},
    {13 , 8 , 10,  1,  3,  15,   4,  2, 11,  6,  7,  12, 0 , 5,  14,  9}
};
 static int[][] sb3={
    {10 , 0 ,  9,14,  6,    3,  15,  5, 1, 13,  12, 7 , 11,  4,   2,   8},
    {13 ,  7,  0, 9,  3,    4,   6, 10, 2,  8,   5, 14, 12, 11,  15,   1},
    {13 ,  6,  4, 9,  8,   15,   3,  0,11,  1,   2, 12,  5, 10,  14,   7},
    {1  , 10 ,13, 0,  6,    9,   8,  7, 4, 15,  14,  3, 11,  5,   2,  12}
};
   static int[][] sb4={
    { 7 , 13, 14, 3,   0,  6,   9, 10, 1, 2,  8,  5, 11, 12,  4,  15},
    {13 ,  8, 11, 5,   6, 15,   0,  3, 4, 7,  2, 12,  1, 10, 14,   9},
    {10 ,  6,  9, 0,  12, 11,   7, 13,15, 1,  3, 14,  5,  2,  8,   4},
    {3  , 15,  0, 6,  10,  1,   13, 8, 9, 4,  5, 11, 12,  7,  2,  14}
};
     static int[][] sb5={
    { 2, 12,  4,  1,  7,  10, 11, 6,  8,  5,   3, 15, 13,  0, 14,  9},
    {14, 11,  2, 12,  4,   7, 13, 1,  5,  0,  15, 10,  3,  9,  8,  6},
    {4 ,  2,  1, 11, 10,  13,  7, 8, 15,  9,  12,  5,  6,  3,  0, 14},
    {11,  8, 12, 7 ,  1,  14,  2, 13, 6, 15,   0,  9, 10,  4,  5,  3}
};
           static int[][] sb6={
    { 12, 1, 10, 15,  9,  2,  6, 8,  0,  13,   3,  4, 14,  7,  5, 11},
    {10, 15,  4,  2,  7, 12,  9, 5,  6,   1,  13, 14,  0,  11, 3,  8},
    {9 , 14, 15,  5,  2,  8, 12, 3,  7,   0,   4, 10,  1,  13,11,  6},
    {4,   3, 12, 12,  9,  5, 15, 10,11,  14,   1,  7,  6,   0, 8, 13}
};
           static int[][] sb7={
    { 4,11,  2, 14,  15, 0,  8, 13,  3,  12,  9,  7,  5, 10, 6, 1},
    {13, 0, 11,  7,  4,  9,  1, 10, 14,   3,  5, 12,  2, 15, 8,  6},
    {1 , 4, 11, 13,  12, 3, 7,  14, 10,  15,  6,  8,  0,  5, 9,  2},
    {6, 11, 13,  8,  1,  4, 10,  7,  9,   5,  0, 15, 14,  2, 3, 12}
};
           static int[][] sb8={
    {13,  2,  8,  4,   6,  15, 11,  1, 10,  9,  3,14,  5, 0, 12,  7},
    { 1, 15, 13,  8,  10,   3,  7,  4, 12,  5,  6,11,  0, 14, 9,  2},
    {7 , 11,  4,  1,   9,  12, 14,  2,  0,  6, 10,13, 15,  3, 5,  8},
    { 2,  1, 14,  7,   4,  10,  8, 13, 15, 12,  9, 0,  3,  5, 6, 11}
};

     public String Filippakoc_Des(String ptxt,String key,boolean encdes){
         //String a=String.format("%64s", Integer.toBinaryString(255)).replace(' ', '0');
         //String b="1011011111001001100001110000101110110000010001110101111101001010";
         String ipa=IPpermutation(ptxt);
         String ipb=IPpermutation(ptxt);
         String[] keys=Keygenerate(key);
         String[] rounds=new String[16];
         String cripttext="";
         if(encdes==true){
              for(int i=0;i<rounds.length;i++){
             if(i<1){
             rounds[i]=round(ipa,keys[i]);
             }else{
                 rounds[i]=round(rounds[i-1],keys[i]);
             }

            }

         cripttext=IPpermutation_(rounds[15]);
         //System.out.println(ptxt);
         //System.out.println(cripttext);
         }else{
              for(int i=rounds.length-1;i>=0;i--){
               if(i>14){
             rounds[i]=dround(ipb,keys[i]);
             }else{
                 rounds[i]=dround(rounds[i+1],keys[i]);
             }

         }
         cripttext=IPpermutation_(rounds[0]);
         //System.out.println(ptxt);
         //System.out.println(cripttext);
         }

        return cripttext;

         //String a=String.format("%32s", Integer.toBinaryString(255)).replace(' ', '0');
         //String b=String.format("%48s", Integer.toBinaryString(21)).replace(' ', '0');
         //System.out.println(functionf(a, b));
         //System.out.println(xor(a,b));
     }
     public String Filippakoc_3des(String ptxt,String key1,String key2,String key3,boolean encdes){
         String En="";
         if(encdes){
           En=Filippakoc_Des(ptxt, key1, true);
         En=En=Filippakoc_Des(En, key2, false);
          En=En=Filippakoc_Des(En, key3, true);
         }else{
             En=Filippakoc_Des(ptxt, key1, false);
         En=En=Filippakoc_Des(En, key2, true);
          En=En=Filippakoc_Des(En, key3, false);
         }

          return En;

     }
     public String round(String plain64,String keyi){

         String li=plain64.substring(0,32);
         String ri=plain64.substring(32);

         String ro=xor(li,functionf(ri,keyi));
         String lo=ri;
         String resultround=lo+ro;
         return resultround;
     }
     public String dround(String plain64,String keyi){
              String li=plain64.substring(0,32);
         String ri=plain64.substring(32);

         String lo=xor(ri,functionf(li,keyi));
         String ro=li;
         String resultround=lo+ro;
         return resultround;
     }
     public String xor(String a,String b){
         String res="";
         for(int i=0;i<a.length();i++){
             if(a.charAt(i)=='0' && b.charAt(i)=='0'){
                 res+='0';
             }else  if(a.charAt(i)=='0' && b.charAt(i)=='1'){
                 res+='1';
             }else  if(a.charAt(i)=='1' && b.charAt(i)=='0'){
                 res+='1';
             }else  if(a.charAt(i)=='1' && b.charAt(i)=='1'){
                 res+='0';
             }
         }
         return res;
     }
     public String sboxesrtn(int ff){
         String sb=Integer.toBinaryString(ff);
         if(ff<2){
             sb="000"+sb;
         }else if(ff<4){
             sb="00"+sb;
         }else if(ff<8){
             sb="0"+sb;
         }
         return sb;
     }
     public String functionf(String r32,String k48){
         String r48=Epermutation(r32);
         String xorout=xor(r48, k48);
         String[] splitto6=new String[8];
         splitto6[0]=xorout.substring(0,6);
         splitto6[1]=xorout.substring(6,12);
         splitto6[2]=xorout.substring(12,18);
         splitto6[3]=xorout.substring(18,24);
         splitto6[4]=xorout.substring(24,30);
         splitto6[5]=xorout.substring(30,36);
         splitto6[6]=xorout.substring(36,42);
         splitto6[7]=xorout.substring(42);
         String rnew32="";
         String row;
         String column="";
         for(int i=0;i<splitto6.length;i++){
            row=""+splitto6[i].charAt(0)+splitto6[i].charAt(5);
            column=splitto6[i].substring(1,5);
            //System.out.println(splitto6[i]+"  "+row+"  "+column);
            int irow=Integer.parseInt(row, 2);
            int icolumn=Integer.parseInt(column, 2);
            if(i==0){
                //rnew32+=Integer.toBinaryString(sb1[irow][icolumn]);
                rnew32+=String.format("%4s", Integer.toBinaryString(sb1[irow][icolumn])).replace(' ', '0');
            }else if(i==1){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb2[irow][icolumn])).replace(' ', '0');
            }else if(i==2){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb3[irow][icolumn])).replace(' ', '0');
            }else if(i==3){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb4[irow][icolumn])).replace(' ', '0');
            }else if(i==4){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb5[irow][icolumn])).replace(' ', '0');
            }else if(i==5){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb6[irow][icolumn])).replace(' ', '0');
            }else if(i==6){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb7[irow][icolumn])).replace(' ', '0');
            }else if(i==7){
                rnew32+=String.format("%4s", Integer.toBinaryString(sb8[irow][icolumn])).replace(' ', '0');
            }
         }

        //System.out.println(rnew32.length());
        //System.out.println(rnew32);
        // System.out.print(splitto6[0]+"  "+splitto6[1]+"  "+splitto6[2]+"  "+splitto6[3]+"  "+splitto6[4]+"  "+splitto6[5]+"  "+splitto6[6]+"  "+splitto6[7]+"\n");
         rnew32=Ppermutation(rnew32);
         return rnew32;

     }
     public String Epermutation(String r32){
         r32=" "+r32;
         String r48=""+r32.charAt(31)+r32.charAt(1)+r32.charAt(2)+r32.charAt(3)+r32.charAt(4)+r32.charAt(5)+r32.charAt(4)+r32.charAt(5)+r32.charAt(6)+r32.charAt(7)+r32.charAt(8)+r32.charAt(9)+r32.charAt(8)+r32.charAt(9)+r32.charAt(10)+r32.charAt(11)+r32.charAt(12)+r32.charAt(13)+r32.charAt(12)+r32.charAt(13)+r32.charAt(14)+r32.charAt(15)+r32.charAt(16)+r32.charAt(17)+r32.charAt(16)+r32.charAt(17)+r32.charAt(18)+r32.charAt(19)+r32.charAt(20)+r32.charAt(21)+r32.charAt(20)+r32.charAt(21)+r32.charAt(22)+r32.charAt(23)+r32.charAt(24)+r32.charAt(25)+r32.charAt(24)+r32.charAt(25)+r32.charAt(26)+r32.charAt(27)+r32.charAt(28)+r32.charAt(29)+r32.charAt(28)+r32.charAt(29)+r32.charAt(30)+r32.charAt(31)+r32.charAt(32)+r32.charAt(1);
         return r48;
     }
     public String Ppermutation(String r32){
         r32=" "+r32;
         String r32p=""+r32.charAt(17)+r32.charAt(7)+r32.charAt(20)+r32.charAt(21)+r32.charAt(29)+r32.charAt(12)+r32.charAt(28)+r32.charAt(17)+r32.charAt(1)+r32.charAt(15)+r32.charAt(23)+r32.charAt(26)+r32.charAt(5)+r32.charAt(18)+r32.charAt(31)+r32.charAt(10)+r32.charAt(2)+r32.charAt(8)+r32.charAt(24)+r32.charAt(14)+r32.charAt(32)+r32.charAt(27)+r32.charAt(3)+r32.charAt(9)+r32.charAt(19)+r32.charAt(13)+r32.charAt(30)+r32.charAt(6)+r32.charAt(22)+r32.charAt(11)+r32.charAt(4)+r32.charAt(25);
         return r32p;
     }
      public String IPpermutation(String r64){
         r64=" "+r64;
         String r64p=""+r64.charAt(58)+r64.charAt(50)+r64.charAt(42)+ r64.charAt(34)+r64.charAt(26)+r64.charAt(18)+r64.charAt(10)+r64.charAt(2)
                 +r64.charAt(60)+r64.charAt(52)+r64.charAt(44)+r64.charAt(36)+r64.charAt(28)+r64.charAt(20)+r64.charAt(12)+r64.charAt(4)+
                 r64.charAt(62)+r64.charAt(54)+r64.charAt(46)+r64.charAt(38)+r64.charAt(30)+r64.charAt(22)+r64.charAt(14)+r64.charAt(6)+
                 r64.charAt(64)+r64.charAt(56)+r64.charAt(48)+r64.charAt(40)+r64.charAt(32)+r64.charAt(24)+r64.charAt(16)+r64.charAt(8)+
                 r64.charAt(57)+r64.charAt(49)+ r64.charAt(41)+r64.charAt(33)+r64.charAt(25)+r64.charAt(17)+r64.charAt(9)+r64.charAt(1)+
                 r64.charAt(59)+r64.charAt(51)+r64.charAt(43)+r64.charAt(35)+r64.charAt(27)+r64.charAt(19)+r64.charAt(11)+r64.charAt(3)+
                 r64.charAt(61)+r64.charAt(53)+r64.charAt(45)+r64.charAt(37)+r64.charAt(29)+r64.charAt(21)+r64.charAt(13)+r64.charAt(5)+
                 r64.charAt(63)+r64.charAt(55)+r64.charAt(47)+r64.charAt(39)+r64.charAt(31)+r64.charAt(23)+r64.charAt(15)+r64.charAt(7);
         return r64p;
     }
       public String IPpermutation_(String r64){
         r64=" "+r64;
         String r64p=""+
                 r64.charAt(40)+r64.charAt(8)+r64.charAt(48)+ r64.charAt(16)+r64.charAt(56)+r64.charAt(24)+r64.charAt(64)+r64.charAt(32)+
                 r64.charAt(39)+r64.charAt(7)+r64.charAt(47)+r64.charAt(15)+r64.charAt(55)+r64.charAt(23)+r64.charAt(63)+r64.charAt(31)+
                 r64.charAt(38)+r64.charAt(6)+r64.charAt(46)+r64.charAt(14)+r64.charAt(54)+r64.charAt(22)+r64.charAt(62)+r64.charAt(30)+
                 r64.charAt(37)+r64.charAt(5)+r64.charAt(45)+r64.charAt(13)+r64.charAt(53)+r64.charAt(21)+r64.charAt(61)+r64.charAt(29)+
                 r64.charAt(36)+r64.charAt(4)+ r64.charAt(44)+r64.charAt(12)+r64.charAt(52)+r64.charAt(20)+r64.charAt(60)+r64.charAt(28)+
                 r64.charAt(35)+r64.charAt(3)+r64.charAt(43)+r64.charAt(11)+r64.charAt(51)+r64.charAt(19)+r64.charAt(59)+r64.charAt(27)+
                 r64.charAt(34)+r64.charAt(2)+r64.charAt(42)+r64.charAt(10)+r64.charAt(50)+r64.charAt(18)+r64.charAt(58)+r64.charAt(26)+
                 r64.charAt(33)+r64.charAt(1)+r64.charAt(41)+r64.charAt(9)+r64.charAt(49)+r64.charAt(17)+r64.charAt(57)+r64.charAt(25);
         return r64p;
     }
     public String[] Keygenerate(String key){
    String[] keys=new String[16];
    String key56=pc_1(key);
    String lkey28=key56.substring(0,28);
    String rkey28=key56.substring(28);
      for(int i=0;i<keys.length;i++){
            if(i==0 || i==1 || i==8 || i==15){
                lkey28=Lbitrotate(lkey28, 1);
                rkey28=Lbitrotate(rkey28, 1);
                keys[i]=pc_2(lkey28+rkey28);
            }else{
                lkey28=Lbitrotate(lkey28, 2);
                rkey28=Lbitrotate(rkey28, 2);
                keys[i]=pc_2(lkey28+rkey28);
            }
        }

    return keys;

}
public String pc_1(String key){
    String key56="";
    key56=""+key.charAt(56)+key.charAt(48)+key.charAt(40)+key.charAt(32)+key.charAt(24)+key.charAt(16)+key.charAt(8)+key.charAt(0)+key.charAt(57)+key.charAt(49)+key.charAt(41)+key.charAt(33)+key.charAt(25)+key.charAt(17)+key.charAt(9)+key.charAt(1)+key.charAt(58)+key.charAt(50)+key.charAt(42)+key.charAt(34)+key.charAt(26)+key.charAt(18)+key.charAt(10)+key.charAt(2)+key.charAt(59)+key.charAt(51)+key.charAt(43)+key.charAt(35)+key.charAt(62)+key.charAt(54)+key.charAt(46)+key.charAt(38)+key.charAt(30)+key.charAt(23)+key.charAt(14)+key.charAt(6)+key.charAt(61)+key.charAt(53)+key.charAt(45)+key.charAt(37)+key.charAt(29)+key.charAt(21)+key.charAt(13)+key.charAt(5)+key.charAt(60)+key.charAt(52)+key.charAt(44)+key.charAt(36)+key.charAt(28)+key.charAt(20)+key.charAt(12)+key.charAt(4)+key.charAt(27)+key.charAt(19)+key.charAt(11)+key.charAt(3);
    return key56;
}
   public String pc_2(String key){
    String key48="";
    key48=""+key.charAt(13)+key.charAt(16)+key.charAt(10)+key.charAt(23)+key.charAt(0)+key.charAt(4)+key.charAt(2)+key.charAt(27)+key.charAt(14)+key.charAt(5)+key.charAt(20)+key.charAt(9)+key.charAt(22)+key.charAt(18)+key.charAt(11)+key.charAt(3)+key.charAt(25)+key.charAt(7)+key.charAt(15)+key.charAt(6)+key.charAt(26)+key.charAt(19)+key.charAt(12)+key.charAt(1)+key.charAt(40)+key.charAt(51)+key.charAt(30)+key.charAt(36)+key.charAt(46)+key.charAt(54)+key.charAt(29)+key.charAt(39)+key.charAt(50)+key.charAt(44)+key.charAt(32)+key.charAt(47)+key.charAt(43)+key.charAt(48)+key.charAt(38)+key.charAt(55)+key.charAt(33)+key.charAt(52)+key.charAt(45)+key.charAt(41)+key.charAt(49)+key.charAt(35)+key.charAt(28)+key.charAt(31);
    return key48;
}

  public String Lbitrotate(String bin,int times){
   String binary=bin;
   String binary2="";
   String binarynew="";
   for(int i=0;i<times;i++){
       if(i<1){
       binary2=binary.substring(1)+binary.charAt(0);
       }else{
           binary2=binarynew.substring(1)+binarynew.charAt(0);
       }
       binarynew=binary2;

   }
   return binary2; 
```

} }

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-10T02:53:40.430

[DES Algorithm Illustrated](http://page.math.tu-berlin.de/~kant/teaching/hess/krypto-ws2006/des.htm)是我见过的最简单的 DES 总结（易于消化）。

至于实际图片，请参阅[DES 工作原理](http://dwm.cc/gallery2/v/UCF/How+DES+Works.png.html)或 DES 工作原理的[镜像](http://web.archive.org/web/20130119234315/http://dwm.cc/gallery2/v/UCF/How+DES+Works.png.html)

对于 AES，有[A Stick Figure Guide to the Advanced Encryption Standard (AES)](http://www.moserware.com/2009/09/stick-figure-guide-to-advanced.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T22:32:56.957

我检查了维基百科，似乎我需要更多。我也认为 Schneier 的书很完美，我把它带回家了，无法将它运送到我学习的地方:-( 耻辱....
没有人说这会很容易，也许我应该读很多遍然后写下来写在纸上，直到它卡在我的大脑上（或已发布应用密码学）。
感谢您的快速回答。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-07T09:12:05.870

我发现我做的重复次数越多越好！还发现了一个艰难的方法，日复一日地做这件事比一次性做更有帮助。至少我可以得到一本 Schneier 的书，这很有帮助。
编写我自己的不是一种选择，因为它是每周的新算法，但它是一个非常有趣、有用（有时也很明显）的想法。
它与 DES 无关，您说服我学习 Python :-)

# midi - 使用 DirectMusic 弹奏单个音符

> ID：172745
> 
> 赞同：5
> 
> 时间：2008-10-05T22:09:27.660
> 
> 标签：midi, xaudio2, directmusic

我正在开发的应用程序中使用 DirectMusic 进行 MIDI 播放。有谁知道是否可以使用 DirectMusic 播放单个音符？目前，我正在将表示整个“歌曲”的内存数据结构转换为 MIDI 缓冲区并通过 DirectMusic 播放。我希望能够播放单个音符，而不必为其生成 MIDI 缓冲区、加载它并播放它。DirectMusic甚至可以实现这种类型的事情吗？

这是我第一次进入 DirectMusic 世界，所以希望我不会太不了解它的功能......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-05T23:20:01.247

我*相信*将您的音符信息塞入 DirectMusicBuffer8 然后播放这确实是最简单的方法。

我假设您知道 DirectMusic 已被弃用，不推荐用于新开发等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T23:35:23.510

嗯，我会看看我是否可以在 MSDN 上挖掘更多信息。

我知道 DirectMusic 已被弃用，但是，我的理解是 XAudio2 对 MIDI 的支持很差。除非我弄错了——如果它支持 MIDI，我会立即切换到 XAudio2，因为我只是处于将 DirectMusic 集成到我的应用程序的早期阶段。

# javascript - 如何在javascript中显示全屏弹出窗口？

> ID：172748
> 
> 赞同：44
> 
> 时间：2008-10-05T22:12:28.777
> 
> 标签：javascript, html, popup

有没有办法让弹出窗口一打开就最大化？如果不是这样，至少让它变成屏幕大小？这：

```
window.open(src, 'newWin', 'fullscreen="yes"') 
```

显然只适用于旧版本的 IE。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-05T22:17:20.530

使用`screen.availWidth`和`screen.availHeight`计算适合的高度和宽度参数的大小`window.open()`

尽管这可能很接近，但它不会最大化，也不会对每个人都准确，尤其是在显示所有工具栏的情况下。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-10T02:35:07.420

那这个呢：

```
var popup = window.open(URL);
if (popup == null)
   alert('Please change your popup settings');
else  {
  popup.moveTo(0, 0);
  popup.resizeTo(screen.width, screen.height);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-06T00:13:34.367

不仅仅是糟糕的设计——这个“功能”是 UI 灾难的根源。有[许多](http://hackademix.net/2007/08/07/java-evil-popups)[恶意](http://www.wilderssecurity.com/archive/index.php/t-11975.html)网站利用JavaScript[中](http://beyondteck.blogspot.com/2007/12/fullscreen-in-firefox-on-mac-os-x.html)的全屏视图功能劫持浏览器窗口并显示与用户桌面无法区分的屏幕。虽然可能仍然有办法做到这一点，但请为了所有体面的事物的爱，不要实施这个。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-06-22T14:06:45.333

这个怎么样，我给了一个很大的宽度和高度值，它可以工作

```
window.open("https://www.w3schools.com", "_blank","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=4000,height=4000"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-27T13:07:08.127

**试试这个。这适用于我以及您想要的任何链接，或弹出窗口中的任何内容**

您选择的任何内容都将在弹出窗口中以全屏大小显示在弹出窗口中。

```
<script language="JavaScript">
function Full_W_P(url) {
 params  = 'width='+screen.width;
 params += ', height='+screen.height;
 params += ', top=0, left=0'
 params += ', fullscreen=yes';
 params += ', directories=no';
 params += ', location=no';
 params += ', menubar=no';
 params += ', resizable=no';
 params += ', scrollbars=no';
 params += ', status=no';
 params += ', toolbar=no';

 newwin=window.open(url,'FullWindowAll', params);
 if (window.focus) {newwin.focus()}
 return false;
}
</script>

<input type="button" value="Open as Full Window PopUp" onclick="javascript:Full_W_P('http://www.YourLink.com');"></input> 
```

# asp.net - XML DOM 与 ADO 数据集

> ID：172751
> 
> 赞同：0
> 
> 时间：2008-10-05T22:15:03.203
> 
> 标签：asp.net, xml, ado.net

我可以选择将数据作为 XML 文档或多表 ADO 数据集存储在内存中。使用此对象的网页将根据键有选择地检索数据项。

这些对象中的任何一个都比另一个具有明显的性能优势吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T02:44:50.880

如果您决定走 XML 路线并且使用 .NET 3.5，请考虑查看 System.Xml.Linq 命名空间中的新 XDocument、XElement（和朋友）类。您可以使用 Linq to XML 来查询您的 XML 文档，它相当不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T22:34:21.773

DataSet 在某种程度上已经是一个 XML 文档。使用数据集获得的额外好处之一是表之间的关系，因此您实际上可以将 DataSet 作为内存数据库进行查询。

XML 确实很好，尤其是在某些情况下，但要搜索大量数据。

如果它是基于与其他表无关的键的项目，则使用 XML，但要小心大型数据子集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T23:05:00.170

按照 Saif 的说法，您对 XML 的最大挑战是将密钥从一个文档关联到另一个文档。您可以为文档中的所有节点创建唯一键，但如果您有另一个结构相似的文档，因为文档是不同的，您可能会遇到不正确的冲突。换句话说，您必须通过临时合并文档或创建另一个将附加标识符连接到动态生成的键的方案来确保没有重叠。

根据您对 XPath 和 XLST 的熟悉程度，您可能希望使用 ADO 创建表和关系，因为这更直接。您可以对键进行分组，在 StackOverflow 上发帖的[Jeni Tennison](http://www.jenitennison.com/xslt/index.html)对这些方法有一个很好的[系列。](http://www.jenitennison.com/xslt/grouping/muenchian.html)

# c# - 将 JavaScript 引擎嵌入 .NET

> ID：172753
> 
> 赞同：221
> 
> 时间：2008-10-05T22:15:44.060
> 
> 标签：c#, javascript, spidermonkey

只是想知道是否有人尝试过将任何 js 引擎嵌入并实际集成到 .net 环境中。我可以找到并实际使用（经过大量的痛苦和努力，因为它已经过时且尚未完成）spidermonkey-dotnet 项目**。**有这方面经验的人吗？SquirrelFish、V8 等发动机。

并不是说我对 Mozilla 的 Spidermonkey 不满意（将它用于类似 Rails 的微型框架，用于核心 ASP.NET 应用程序中的自定义组件），但我仍然希望进一步探索这些选项。命令行解决方案不是我需要的，除了 CLR，我不能依赖任何其他东西，我需要调用 JavaScript/C# 对象的方法。

```
// c# class
public class A
{
    public string Hello(string msg)
    {
        return msg + " whatewer";
    }
}

// js snippet
var a = new A();
console.log(a.Hello('Call me')); // i have a console.log implemented, don't worry, it's not a client-side code :) 
```

只是为了澄清-我并不是要在服务器端javascript中实际**对应用程序本身进行编程。**它仅用于编写自定义用户子应用程序（可以看作是某种 DSL）。让普通人用 js 编程比 C# 更容易（也更安全）。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2010-07-05T22:10:03.777

尝试[Javascript .NET](https://github.com/JavascriptNet/Javascript.Net)。它托管在 GitHub 上它最初托管在 CodePlex 上，[这里](http://javascriptdotnet.codeplex.com)）

项目讨论：http: [//javascriptdotnet.codeplex.com/discussions](http://javascriptdotnet.codeplex.com/discussions)

它实现了谷歌 V8。您可以使用它直接从 .NET 代码编译和运行 JavaScript，并提供 CLI 对象以供 JavaScript 代码使用。它从 JavaScript 生成本机代码。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2009-10-26T12:30:36.957

开源 JavaScript 解释器 Jint ( [http://jint.codeplex.com](http://jint.codeplex.com) ) 完全符合您的要求。

**编辑：**
该项目已经完全重写，现在托管在 Github 上，地址为[https://github.com/sebastienros/jint](https://github.com/sebastienros/jint)

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2013-06-14T14:18:36.207

您可能还对 托管在 GitHub 上并在 Ms-Pl 许可下发布的[Microsoft ClearScript感兴趣。](https://github.com/Microsoft/ClearScript)

我不是微软的粉丝，但我必须承认 V8 支持与 Javascript.Net 具有大致相同的功能，更重要的是，该项目仍在维护中。就我而言，对代表的支持也比 Spidermonkey-dotnet 更好。

ps：它也支持 JScript 和 VBScript 但我们对这些老东西不感兴趣。

ps：兼容.NET 4.0和4.5+

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2012-01-09T22:16:45.713

任何人都只是调整检查侏罗纪以及：

[http://jurassic.codeplex.com/](http://jurassic.codeplex.com/)

编辑：这已移至 github（乍一看似乎很活跃）

[https://github.com/paulbartrum/jurassic](https://github.com/paulbartrum/jurassic)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-01-23T10:40:27.643

你可以试试 IronJS，虽然它正在大力发展，但看起来很有希望。[https://github.com/fholm/IronJS](https://github.com/fholm/IronJS)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-05T23:01:45.353

我想我仍然不清楚您要做什么，但是 JScript.NET 可能值得研究，尽管[**托管 JScript**](http://blogs.msdn.com/jscript/archive/2007/05/07/introducing-managed-jscript.aspx)似乎更适合您的需求（它更像 JavaScript 而不是 JScript.NET） .

就个人而言，我认为以某种方式集成 V8 会很酷，但我没有通过下载源代码；希望我有时间真正用它做点什么。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-07-21T20:24:07.267

我想出了一个更简单的解决方案。

我`.dll`使用 Javascript 构建了一个文件，然后使用 VS2013 开发人员命令提示符中提供的 Javascript 编译器对其进行编译。

一旦我们有了它，`.dll`我们只需将它添加到`\Support`文件夹中，然后在需要评估 Javascript 语句的项目中引用它。

创建一个的详细步骤`.dll`：

1.  在记事本中创建一个仅包含以下内容的文件：

    ```
    class EvalClass { function Evaluate(expression: String) { return eval(expression); } } 
    ```

2.  将文件另存为`C:\MyEval.js`

3.  打开 VS2005 命令提示符（开始、程序、VS2005、VS2005 工具）

4.  键入`Cd\`以到达`C:\`

5.  类型

    ```
    jsc /t:library C:\MyEval.js 
    ```

6.  将创建一个名为 的新文件`MyEval.dll`。

7.  复制`MyEval.dll`到项目并引用它（也引用`Microsoft.Jscript.dll`）。

8.  然后你应该可以这样称呼它：

    ```
    Dim jScriptEvaluator As New EvalClass
    Dim objResult As Object
    objResult = jScriptEvaluator.Evaluate(“1==1 && 2==2”) 
    ```

objResult 是`True`.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-22T14:48:46.157

如果语言不是问题（任何沙盒脚本语言），那么就有[.NET 的 LUA 了](http://www.codeproject.com/KB/mcpp/luanetwrapper.aspx)。.NET 框架的 Silverlight 版本也是沙盒 afaik。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-08-24T20:27:13.123

嘿，看看 0.3.1 版本的 codeplex ( [http://javascriptdotnet.codeplex.com/](http://javascriptdotnet.codeplex.com/) ) 上的 Javascript .NET，有一些很不错的新功能可能会让您感兴趣。

查看示例代码：

```
// Initialize the context
JavascriptContext context = new JavascriptContext();

// Setting the externals parameters of the context
context.SetParameter("console", new SystemConsole());
context.SetParameter("message", "Hello World !");
context.SetParameter("number", 1);

// Running the script
context.Run("var i; for (i = 0; i < 5; i++) console.Print(message + ' (' + i + ')'); number += i;");

// Getting a parameter
Console.WriteLine("number: " + context.GetParameter("number")); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-01-16T16:22:25.707

您可以在 C# 中使用 Chakra 引擎。这是一篇关于 msdn 的文章，展示了如何：

[http://code.msdn.microsoft.com/windowsdesktop/JavaScript-Runtime-Hosting-d3a13880](http://code.msdn.microsoft.com/windowsdesktop/JavaScript-Runtime-Hosting-d3a13880)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-07-05T20:41:02.607

我刚刚尝试**[了 .Net 的 RemObjects 脚本](http://www.remobjects.com/script.aspx)**。

它可以工作，尽管我不得不使用`var a=A.createA();`JavaScript 中的静态工厂 () 而不是`var a=new A()`语法。（ExposeType 函数只公开静态数据！）文档不多，源代码是用 Delphi Prism 编写的，这对我和 RedGate Reflector 来说是相当不寻常的。

所以：**易于使用和设置，但对高级场景帮助不大。**

还必须安装一些东西而不是仅仅将程序集放在目录中对我来说是负面的......

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-02-12T02:09:00.930

还有使用 Internet Explorers Chakra 引擎的[MsieJavaScriptEngine](https://github.com/Taritsyn/MsieJavaScriptEngine)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-09-15T16:10:51.027

Microsoft 记录的向任何事物添加脚本可扩展性的方法是 IActiveScript。您可以在任何 .NET 应用程序中使用 IActiveScript 来调用脚本逻辑。该逻辑可以与您放置在脚本上下文中的 .NET 对象相关联。

这个答案提供了一个执行此操作的应用程序，其中包含代码：

*   [IE10 Chakra JScript 引擎是否可以通过 C# 单独访问？](https://stackoverflow.com/questions/5939002/will-the-ie10-chakra-jscript-engine-available-as-stand-alone-accessible-from-c/7367964#7367964)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-12-02T17:44:56.113

这里有一个用 C# 实现的[ActiveX 脚本](http://en.wikipedia.org/wiki/Active_Scripting)引擎主机：[parse and execute JS by C#](https://stackoverflow.com/questions/4744105/parse-and-execute-js-by-c-sharp)

它允许在原生 32 位或 64 位进程中直接从 C# 使用 Javascript（或 VBScript）。完整的源代码是大约 500 行 C# 代码。它仅对已安装的 JScript（或 VBScript）引擎 DLL 具有隐式依赖关系。

例如，下面的代码：

```
Console.WriteLine(ScriptEngine.Eval("jscript", "1+2/3")); 
```

将显示 1.66666666666667

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-02-12T08:19:23.317

试试[ReoScript](http://www.unvell.com/ReoScript/)，一个用 C# 实现的开源 JavaScript 解释器。

ReoScript 使您的应用程序可以执行 JavaScript。它具有多种扩展方法，例如 SetVariable、Function Extension、使用 CLR 类型、.Net 事件绑定等。

你好世界：

```
ScriptRunningMachine srm = new ScriptRunningMachine();
srm.Run(" alert('hello world!'); "); 
```

这是一个创建winform并显示它的脚本示例。

```
import System.Windows.Forms.*;        // import namespace

var f = new Form();                   // create form
f.click = function() { f.close(); };  // close when user clicked on form

f.show();                             // show 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-06T03:57:52.700

我相信所有主要的开源 JS 引擎（JavaScriptCore、SpiderMonkey、V8 和 KJS）都提供嵌入 API。我真正直接熟悉的唯一一个是 JavaScriptCore（它是 SquirrelFish 所在的 JS 引擎的名称），它提供了一个纯 C API。如果记忆有用（自从我使用 .NET 以来已经有一段时间了）.NET 对 C API 中的链接有相当好的支持。

老实说，我不确定其他引擎的 API 是什么样的，但我知道它们都提供了它们。

也就是说，根据您的目的，JScript.NET 可能是最好的，因为所有这些其他引擎都需要您将它们包含在您的应用程序中，因为 JSC 是唯一实际附带操作系统的引擎，但该操作系统是 MacOS：D

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-07-27T04:38:13.647

我知道我正在打开一个旧线程，但我在 smnet (spidermonkey-dotnet) 上做了很多工作。近年来。它的主要开发重点是将 .net 对象无缝嵌入到 spidermonkey 引擎中。它支持从 js 值到 .net 对象的各种转换。其中一些包括代表和活动。

只是说现在可能值得检查一下，因为它有一些稳定的发展:)。我确实通过错误修复和新功能使 SVN 存储库保持最新。源和项目解决方案文件配置为在下载时成功构建。如果使用它有任何问题，请随时打开讨论。

我确实理解拥有托管 javascript 解决方案的愿望，但是在我使用过的所有托管 javascript 中，它们都非常缺乏一些关键特性，这些特性有助于使它们既健壮又易于使用。我自己正在等待 IronJS 成熟一点。在我等待的时候，我玩得很开心蜘蛛猴-dotnet =)

[spidermonkey-dotnet 项目和下载页面](http://spidermonkeydotnet.codeplex.com/releases/)

编辑：今天下午创建了文档 wiki 页面。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-06T20:25:47.327

使用 JSCRIPT.NET 获取 js 的库（dll）。然后在你的 .NET 应用程序中引用这个 dll，你就在那里。完毕！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-05-29T21:30:47.550

[V8.NET](https://github.com/rjamesnw/v8dotnet)是一个新手（截至 2013 年 4 月），它更紧密地封装了原生 V8 引擎功能。它允许对实施进行更多控制。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-05-10T17:59:38.770

您可以使用 Rhino 一个用 Java 编写的 Mozilla Javascript 引擎，并将其与 IKVM 一起使用，这里有一些说明

说明：[https ://www.codeproject.com/Articles/41792/Embedding-JavaScript-into-C-with-Rhino-and-IKVM](https://www.codeproject.com/Articles/41792/Embedding-JavaScript-into-C-with-Rhino-and-IKVM)

* * *

## 回答 #21

> 赞同：-5
> 
> 时间：2012-08-23T17:51:52.103

现在可以使用`ASP.Net MVC4 Razor`View 引擎。代码将是这样的：

```
// c# class
public class A
{
    public string Hello(string msg)
    {
        return msg + " whatewer";
    }
}

// js snippet
<script type="text/javascript">
var a = new A();
console.log('@a.Hello('Call me')'); // i have a console.log implemented, don't worry, it's not a client-side code :)
</script> 
```

并且`Razor`不仅适用于 MVC4 或其他 Web 应用程序，您还可以在离线桌面应用程序中使用它。

# c++ - 适用于 Windows Mobile 本机代码的 MVC 框架

> ID：172764
> 
> 赞同：2
> 
> 时间：2008-10-05T22:24:06.943
> 
> 标签：c++, model-view-controller, windows-mobile

是否有适用于本机 Windows Mobile 代码的优秀 MVC 框架？

除非有人可以链接到使用 MVC 模式的开源 Windows Mobile 或 CE 项目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T22:46:37.163

也许你可以试试 Qt。它提供了一些用于 mvc 编程的类。这是 Qt 中 MVC 的链接。[http://doc.trolltech.com/4.4/model-view-programming.html](http://doc.trolltech.com/4.4/model-view-programming.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-21T03:02:42.353

受 akam129 的启发，这是来自 Qt Quarterly on MVC 的[链接。](http://doc.trolltech.com/qq/qq10-mvc.html)

概述：Qt中的控件在内部使用MVC，可以通过信号槽机制在应用程序级进行MVC编程

# syntax - 合并后运算符？

> ID：172777
> 
> 赞同：1
> 
> 时间：2008-10-05T22:41:47.673
> 
> 标签：syntax, language-features, language-design

我们都熟悉前置和后置操作符，例如

```
c++;    // c = c + 1
++c;    // ditto 
```

以及扩展此原则的“组合运算符”：

```
c += 5;    // c = c + 5
s .= ", world";    // s = s . ", world"; e.g. PHP 
```

我经常需要一个“后组合运算符”，这将允许：

```
s =. "Hello ";    // s = "Hello " . s 
```

显然，这仅对不可交换运算符真正有用，并且含义从前/后增量改变，即使语法是借用的。

您是否知道提供这种运算符的任何语言，为什么它不更常见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-05T22:54:07.820

对给定示例的基本反对意见是它会产生歧义：

```
a=-5;    //'a = -5' or 'a =- 5'?
b=*p;    //'b = *p' or 'b =* p'?
c=.5;    //'c = .5' or 'c =. 5'? 
```

**编辑：**但是不，我不知道有任何语言使用它们。大概这是因为它们在 C 中被省略了，大多数其他语言都从那里得到了它们的基本运算符。

是的，我很想用我使用的语言看到它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T23:27:26.083

组合的 'op=' 运算符是 的简写`var = var op predicate`，但 op 不必是特别的任何东西。运算符恰好是多种语言中“追加”操作的`'.'`简写，但没有什么能阻止您以任何允许在任何数据类型上重载运算符的语言定义“前置”操作 - 甚至将追加更改为前置您想使用（或在您可能用来包含该数据的任何对象上）。如果你想做`textvar /= newtext`速记，`textobj = textobj->prepend(newtext)`没有什么能阻止你。

也就是说，您可能永远不应该这样做，因为没有办法在不引起大量混乱的情况下更改现有运算符。更改语句顺序要容易得多（也更清晰），这样您就可以从左到右，或者使用特定的功能，例如在`unshift`没有任何歧义的情况下添加内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T22:58:02.540

我不知道，我认为不会有，因为它是一个元元命令。

解释一下，最初的运算符（用于数字）来自 C 语言，它们直接映射到机器代码操作。这允许程序员进行优化，因为早期的编译器没有。
所以，

```
x=x+1; 
```

和

```
x+=1; 
```

和

```
x++; 
```

将生成三个不同的汇编器输出。

现在，为字符串添加 += 是一个元命令。它不映射到操作码，它只是遵循和扩展模式。

# svn - 颠覆大型回购导入/结帐

> ID：172781
> 
> 赞同：7
> 
> 时间：2008-10-05T22:43:59.930
> 
> 标签：svn, repository, commit, svn-checkout

我使用颠覆创建新存储库的正常工作流程是创建一个新存储库，检查存储库根目录，创建我的分支标签和主干文件夹，并将我的初始文件放在主干中。然后我提交这个“初始导入”，从我的硬盘驱动器中删除签出的存储库并签出主干。然后我就可以开始工作了。

但是，在处理大型导入时，请考虑数百个兆，以及场外版本控制托管（基于 http），此初始导入可能需要相当长的时间才能提交。更糟糕的是，在提交之后，我需要重新检查这个巨大的树干。

有没有一种颠覆方式来使用主干的本地副本，而无需重新检查已经存在的数据？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-05T22:51:30.633

有 - 它被称为“就地导入”，它在此处的 Subversion 常见问题解答中有所介绍：

[http://subversion.tigris.org/faq.html#in-place-import](http://subversion.tigris.org/faq.html#in-place-import)

您真正要做的是在存储库中创建一个新的空项目，检查本地文件夹的空项目 - 这会将您的文件夹变成工作副本 - 然后将所有（现有）文件添加到该“空”项目中，因此，当您执行 svn 提交时，它们会被添加到存储库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T00:34:50.580

我同意“就地导入”程序，并且还使用 TTB 结构的脚本（两者都赞成）。

只是一个小提示：

如果您使用 http(s)，则不应在一次提交中导入**大量（数万个）文件，因为显示版本历史记录的时间***取决于添加条目的数量*。这种行为的原因是 apache 必须针对 svnaccess 文件对所有添加的路径进行身份验证（当然，仅当您启用了基于路径的授权时）。这可能会使您的存储库无法使用，因为所有文件都必须在 svn 日志上等待这个大版本。

您应该在目录级别划分大量导入

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T23:12:33.163

我通常在创建存储库后立即使用“svn mkdir”直接在服务器上创建主干/标签/分支。然后我可以检查空主干，将我的初始文件移动到该目录中，添加并提交它们，然后开始工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T11:23:23.640

svn checkout --force 让您可以“通过”现有路径签出工作副本。它保留您的旧文件并添加仅在您的存储库中的文件。

For creating your repository: You can perform multiple mkdir commands to a repository in a single commit using the 'svnmucc' command that is available in most Subversion distributions (e.g. [SlikSVN](http://sliksvn.com/en/download/)).

Type svnmucc without arguments for some help.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T22:47:53.683

如果您已签出单个文件夹，请将文件复制到其中，运行`svn add`并`svn commit`; 您不需要删除文件并重新结帐。

使用适当的文件：一旦按照您的描述提交它们，它们就可以开始工作了。

# c# - .net 推荐的良好动态编程语言

> ID：172793
> 
> 赞同：9
> 
> 时间：2008-10-05T22:54:22.063
> 
> 标签：c#, .net, ironpython, boo

好吧，在用 C# 编写了很长时间的 .net 程序之后，我开始对静态类型语言附带的所有语法垃圾感到愤怒和沮丧。现在我想更改为利用 CLI 的动态类型语言。所以我搜索了一下，我不喜欢我所看到的。我首先寻找 IronPython。但是这个项目感觉杂乱无章，看起来一点也不好看。然后我听说了Boo。我喜欢 boo 的，理想的和所有的，但有点感觉这个项目已经停止了。然后我听说了 IronRuby，但该项目仍处于测试阶段，所以我决定等到它变得更成熟。

因此，由于我找不到与 CLR 兼容的良好动态语言，所以我问你们（你们会）使用什么？

自从人们开始询问不选择 IronPython 的原因是什么。好吧，原因是，就像我之前所说的，它似乎杂乱无章。为什么？

1-主页指向codeplex的另一个页面，主页应该是干净的，只是指出IronPython的优点，以IronRuby页面为例[http://www.ironruby.net/](http://www.ironruby.net/)它隐藏了语言开发的东西用户（即使用户在使用之前必须访问 IronRuby 的 svn）。IPython 在创建时试图解决什么样的问题。是否有包含此类信息的页面？好吧，该页面就在那里，但它隐藏在“更多信息页面”中的一堆无意义的文章链接中。在 Boo 的页面上，它一目了然地命名为 Manifesto [http://boo.codehaus.org/BooManifesto.pdf](http://boo.codehaus.org/BooManifesto.pdf)。

还有更多，但我的感觉是 IPython 只是一个自制的解释器，尽管它实际上可以具有质量。我觉得下载 Boo 并使用 IronPython 更安全（但不用担心微软我也下载了 IPython）。

关于 Duck-Typing 和 Boo 的静态类型，它们对我来说似乎都很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-05T23:13:30.730

我仍然会使用[**Boo**](http://boo.codehaus.org/)。我不确定你为什么认为 Boo 已经停止了。开发有时看起来很慢，但目前有很多人正在修复错误，如[**最近修复的问题（错误）列表**](http://jira.codehaus.org/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?&pid=10671&resolution=1&status=5&status=6&sorter/field=issuekey&sorter/order=DESC&tempMax=1000)所示。

对于不熟悉 Boo 的人来说，它与 Python 非常相似，但包含了 Python 所没有的东西（如[**字符串插值**](http://boo.codehaus.org/String+Interpolation)和[**语法宏**](http://boo.codehaus.org/Syntactic+Macros)）。*您可以通过“Boo Interactive Shell” booish*编译 Boo 程序或使用 Boo 。

顺便说一句，几年前我看到 IronPython 时也不喜欢它。对我来说，它看起来像是 Python 到 CLI 的直接端口，但据我所知，它不包含典型的 .NET 开发所需的新功能。

**编辑**：自从我第一次看到 IronPython 以来，它似乎确实取得了进展（感谢 Curt 指出这一点）。然而，自从我找到 Boo 后，我就再也没有费心去看 IronPython。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-05T23:17:17.413

就实际可用性而言，**[IronPython](http://www.codeplex.com/IronPython)**将是您现在最好的选择。

为什么人们建议Boo？这是一种静态类型的语言，这不是这个问题所要求的。是的，我知道它有可选的鸭子类型，但是如果问题作者可以接受与 Boo 相关的信息，那么问题真的应该被编辑以明确这一点。

关于 IronPython，您说您不喜欢它，但是对于如此含糊的批评性评论，我真的没有任何回应:)

或者，我建议您看一下[cPython](http://python.org)。几点：

*   您可以使用 py2exe 和其他工具构建 .exe 文件。
*   对第 3 方 Python 库和框架的更大访问权限
*   通过 pywin32 访问 Windows API
*   用 C 编写的 Python 扩展是可用的（与 IronPython 不同，尽管正在[努力](http://pythonnet.sourceforge.net/)改善这种情况）

你会发现大多数事情你真的不需要 .NET。当然，这一切都取决于您的应用程序。为了与现有的 .NET 代码集成，显然您必须使用 IronPython。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-06T00:07:57.607

你说你想要“动态”，但如果动机只是为了避免“所有那些语法垃圾”，你应该看看[F#](http://msdn.microsoft.com/en-us/fsharp/default.aspx)。它是静态类型的，但具有动态语言的轻量语法感觉，以及交互模式（REPL 循环）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T22:56:31.230

我同意您的观点，即 IronPython 似乎杂乱无章，但我一直将它用于（小型）项目，到目前为止我对它非常满意。

如果您还没有看过它，您应该查看[IronPython Studio](http://www.codeplex.com/IronPythonStudio)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T03:51:15.690

你也可以看看[范](http://www.fandev.org)语。它不是纯粹的动态，它是静态和动态的混合体。和大多数较新的语言一样，它是纯面向对象，其中混合了功能。它还可以在 JVM 和 CLR 平台上运行。

在语法方面，它更接近 C#，有很多糖语法，所以它看起来有点像 C# 与 Ruby/Python 的融合。

由于语言是新的，只有 3 年的历史，它的性能还不是很出色。

*2014 年 2 月 21 日更新：* Fan 已更名为[Fantom](http://fantom.org)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T22:28:51.723

我也走上了类似的道路。检查了 Boo、dotLISP、IronPython 等。

我推荐 IronPython。但是，如果您还没有任何 Python 经验，那么您可能会通过加载 CPython 并将其用于示例和教程来更快地学习核心 Python。

一旦你了解了 CPython，IronPython 就会更容易理解。当然，您仍然需要了解一些 C# 并可以访问 .Net SDK 文档。没有它，IronPython 很难完成有用的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-15T18:00:28.427

看看[Clojure](http://clojure.org/)。CLR 版本仍处于早期阶段，但您可能可以通过[IKVM让 java 版本在 .Net 中工作](http://www.ikvm.net/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-08T15:37:00.977

> ...静态类型语言附带的语法垃圾...

如果您关心的是语法垃圾，那么您可能还想查看带有类型推断的静态类型语言，尤其是[F#](http://www.ffconsultancy.com/products/fsharp_journal/?so)。

# clojure - 现实世界中的 Lisp

> ID：172798
> 
> 赞同：148
> 
> 时间：2008-10-05T22:56:52.400
> 
> 标签：clojure, lisp, scheme, common-lisp

我已经尝试过 Lisp（实际上是 Scheme），发现它是一种非常漂亮的语言，我有兴趣进一步了解它。然而，Lisp 似乎从未在严肃的项目中使用过，而且我还没有看到它在任何职位发布中被列为所需的技能。我很想听听任何使用过 Lisp 或看到它在“现实世界”中使用的人的意见，或者谁知道它是否被认为是一种纯粹的学术语言。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-06T09:27:30.833

Franz, Inc.在其网站上提供了一份详尽[的成功案例列表。](http://www.franz.com/success/)然而：

> 请不要假设 Lisp 只对动画和图形、人工智能、生物信息学、B2B 和电子商务、数据挖掘、EDA/半导体应用程序、专家系统、金融、智能代理、知识管理、机械 CAD、建模和仿真有用，自然语言、优化、研究、风险分析、调度、电信和 Web 创作只是因为这些是他们碰巧列出的唯一内容。— 肯特·皮特曼

我们可以在这里找到其他成功案例：http:  [//lisp-lang.org/success/](http://lisp-lang.org/success/)

以及当前使用 Common Lisp 的公司列表：[https ://github.com/azzamsa/awesome-lisp-companies](https://github.com/azzamsa/awesome-lisp-companies)

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-05T23:28:21.870

Emacs 的 elisp 算不算？这是我熟悉的最“真实世界”的用法（尽管我也不确定 Emacs 是否算作“真实世界”）。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2008-10-06T01:22:58.033

[ITA Software](http://itasoftware.com)将[Common Lisp](http://itasoftware.com/careers/l_e_t_lisp.html?catid=0)用于其[QPX 低价搜索引擎](http://matrix.itasoftware.com/)，该引擎为[Orbitz](http://orbitz.com)、[Kayak](http://kayak.com)以及[American](http://aa.com) and [United](http://united.com) Airlines 等网站提供支持。它还部分用于加拿大航空公司即将推出的[乘客预订系统](http://itasoftware.com/solutions/res.html)。Paul Graham过去曾在 ITA[写过一些关于 Lisp 的文章。](http://www.paulgraham.com/carl.html)

（免责声明：我在那里工作。）

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-10-05T23:36:16.033

[Lisp 在喷气推进实验室的兴衰故事](http://www.flownet.com/gat/jpl-lisp.html)

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2008-10-06T10:50:35.893

作为一家小型初创公司，我们已经建立了一些人称之为“应用程序服务器”的东西。但实际上它只是一堆用于 sql 连接和 Web 应用程序的集成通用 lisp 库。[cl-dwim 项目页面提供了](http://common-lisp.net/project/cl-dwim)*一些*详细信息

使用它，我们**为匈牙利政府开发和运行了一个网络应用程序，该应用程序**从地方政府收集数据并计算该国预算的相关部分。这是我们现在计划的第二个预算。

它有大约 4000 个用户，并且运行在一组计算机上。

至于“学术语言”：我们正在玩诸如业务流程建模的持久延续之类的东西。它是一些随机的 lisp 代码，带有一些额外的与进程相关的原语和一些约束。它可以在代码中的随机点停止并在等待某些外部事件时进入睡眠状态（被提交到数据库中）。

它是实用的还是学术的？你决定... ：）

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-10-05T23:44:29.997

[Reddit](http://reddit.com)最初是用 Lisp 编写的，后来用 Python 重写。[在Find Lisp](http://www.findinglisp.com/blog/2005/12/reddit-and-lisp-psychosis.html)中有对开关及其对 Lisp 意味着什么的很好的分析。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2008-10-05T22:59:50.303

Paul Graham 使用并写过用 LISP 编写的 ViaWeb

在这里阅读[- 击败平均水平](http://paulgraham.com/avg.html)

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-06T00:31:38.637

ITA 软件使用了大量的 CL。

[http://www.itasoftware.com/careers/l_e_t_lisp.html?catid=8](http://www.itasoftware.com/careers/l_e_t_lisp.html?catid=8)

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2008-10-10T14:31:38.833

[LilyPond](http://lilypond.org/web/)是一个相当近的开放源代码项目，它仍然享有一致且可观的开发活动。

这是一个乐谱程序，它以易于编写的文本文件作为输入，并将其转换为精美的乐谱（pdf 文件）。如果您愿意，可以提供各种方式来处理输出。它甚至可以产生听起来不错的 MIDI 文件。每当我需要制作其他音乐家可以阅读的漂亮乐谱时，我都会使用它。我认为它比 Finale 更好而且它是*免费*的！

在商业类别中，还有[Notehead 的 Igor Engraver](http://www.noteheads.com/default.asp)。不幸的是，该站点不允许我发布指向讨论 Lisp 的页面的直接链接，因此请前往下载并查看底部的“Lisp”链接。

还有 Naughty Dog（一家电脑游戏公司）在他们的游戏中使用 Lisp。[本文](http://grammerjack.spaces.live.com/blog/cns!F2629C772A178A7C!135.entry)讨论了这一点，甚至显示了一些代码。

还有很多其他的已经被提及并与之相关，但这些是与我产生共鸣的主要内容（作为作曲家/程序员/游戏玩家/...类型）。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2013-01-17T04:57:11.380

哈勃太空望远镜是使用 Lisp 规划工具安排的。航天飞机是。韦伯望远镜将是。我为分析数十亿美元的健康保险索赔而编写 Lisp 的公司，即使在经济衰退期间也以每年约 30% 的速度增长。我们被一家大公司收购，我们的一位程序员匹配（实际上改进了）（大公司）用于分析医疗保险索赔的软件的输出，从头开始，他自己在一年内。（大公司）的代码，不是在 Lisp 中，花了 6 年时间和几个程序员。职业方面的麻烦在于，太多人听信关于“许多恼人的愚蠢括号”之类的废话。大多数经理并不“明白”，而是宁愿用一种足够熟悉的语言来进行项目，以便他们可以进行微观管理。他们认为 ”

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2008-10-05T22:59:30.600

> 如果我现在开始我自己的主要软件项目，我会根据上述标准做出我的语言决定。当然，我喜欢 Lisp，CLOS 很棒，真正的词法作用域岩石，Lisp 宏非常酷（当按照指示使用时），而且我个人非常喜欢 Lisp 语法。[…] 但是，如果我负责做出选择，那么要说服我为一个主要的软件项目选择 Lisp 需要很多，或者需要特殊情况。——[丹·温瑞布](http://c2.com/cgi/wiki?DanWeinreb)

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2009-07-10T08:58:47.280

最近的一些：

*   Thanandar，德国浏览器游戏：[http ://www.thanandar.de/](http://www.thanandar.de/)
*   Aula Polska，一个波兰企业家社区：[http ://www.aulapolska.pl/](http://www.aulapolska.pl/)
*   LAMsight，医学调查应用程序：[https ://www.lamsight.org/](https://www.lamsight.org/)
*   Wigflip，一个愚蠢的 gfx 游乐场：[http](http://wigflip.com/) ://wigflip.com/ :)
*   Clutu，多人 AJAX 填字游戏：[http ://www.clutu.com/](http://www.clutu.com/)

其中前三个是使用 CL Web 框架 Weblocks 编写的。Wigflip 和 Clutu 使用纯 Hunchentoot。

现在开始编码！:)

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2008-10-05T23:42:39.110

我相信 Autocad 有使用 Lisp 来扩展产品的扩展。请参阅[AutoLISP](http://en.wikipedia.org/wiki/AutoLISP)。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2008-10-08T15:51:55.830

Peter Christensen 编制了一份（财务上）成功的 lisp 公司名单。

[http://www.pchristensen.com/blog/lisp-companies/](http://www.pchristensen.com/blog/lisp-companies/)

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2008-10-06T01:33:04.160

有很多公司、项目和产品在各种角色中使用 Lisp——我已经为其中几个做过工作。

有两个相关点：

1.  你可能永远不知道你最新的消费电子产品是用 Common Lisp 构建的，甚至是用 Common Lisp 编程的，或者你使用的某些服务是由 Lisp 服务器提供支持的。得出 Lisp“从未使用过”的结论是不正确的。

2.  ……而且，像许多领域一样，这些工作从未出现在 Monster.com 上。仅仅因为你从未见过它的职位发布并不意味着那里没有 Lisp 所需的或适合工作的工具的机会。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2010-08-15T00:15:57.873

我相信 GIMP 的插件系统是基于 Scheme 的。我不知道这是否完全是“现实世界”，但至少它似乎是 Lisp 的实际应用。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2008-10-05T23:02:31.797

查找[ACL2](http://www.cs.utexas.edu/users/moore/acl2/)。它是一个基于 lisp 的形式逻辑引擎，已用于许多“现实世界”项目，例如软件安全中的形式方法和浮点硬件的正确性证明。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2008-10-05T23:35:22.963

[http://www.franz.com/success/all_customer_apps.lhtml](http://www.franz.com/success/all_customer_apps.lhtml)中的列表远非详尽

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2008-10-06T09:29:31.233

如果我的计划成功，我们将在 5 年内使用 Scheme！;p

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2009-07-09T05:43:33.533

当我发现[PRISM](http://www.radonc.washington.edu/medinfo/prism/)（“Prism 项目是一个长期项目，旨在构建用于放射治疗计划的软件工具，包括人工智能工具以及手动模拟系统。”）是用 Common Lisp 编写时，我印象深刻。

在我的工作中，我正在编写使用[DICOM](http://en.wikipedia.org/wiki/DICOM)的软件，我必须说编写好的 DICOM 实现是一项艰巨的任务。在他们的[报告](http://www.radonc.washington.edu/medinfo/prism/iccr13-dicom.pdf)中，他们描述了 Common Lisp 如何让他们以更少的努力构建一个比其他实现更好（至少在某些方面）的良好 DICOM 实现。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2012-03-29T08:46:52.587

我现在才意识到[Maxima](http://maxima.sourceforge.net/)是一个符号代数程序，是用 Common Lisp 编写的。我已经使用了很长一段时间，我认为这也是一个非常好的现实生活示例。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2013-01-13T21:41:03.013

Lisp 与[Common Music](http://commonmusic.sourceforge.net/)库一起用于现实世界的算法音乐创作。Rick Taube's *Notes from the Metalevel*是一个很好的主题介绍性文本，其中有一堆用 Lisp 编写的示例。[请参阅此处](http://lit.gfax.ch/MusicProgrammingUsingLisp.pdf)的示例目录和[此处](http://www.moz.ac.at/sem/lehre/lib/cm/Notes%20from%20the%20Metalevel/00/contents.html)的文本副本。

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2013-12-05T16:06:35.033

Matthew Eric Bassett 在电影业中使用 Racket： [http ://www.youtube.com/watch?v=37owCjWnkK0](http://www.youtube.com/watch?v=37owCjWnkK0)

Daniel Liebgold 谈球拍和 PS3： [http ://www.youtube.com/watch?v=oSmqbnhHp1c](http://www.youtube.com/watch?v=oSmqbnhHp1c)

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2008-10-07T18:14:48.583

好吧，它几乎不是主流，但我尽可能多地使用 lisp 来编写我的研究代码。这是迄今为止我发现的最好的语言，可以平衡动态性和表现力，同时还能为数字等产生不错的性能。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2010-08-14T23:57:48.423

Google App Inventor 是用 Scheme 编写的

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2012-01-23T06:20:39.723

GNU Make 可以通过方案进行扩展。真实世界编程的案例:)

[https://www.gnu.org/software/make/manual/html_node/Guile-Integration.html](https://www.gnu.org/software/make/manual/html_node/Guile-Integration.html)

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-09-13T19:34:03.557

Lisp 在 80 年代初尝试跃升到光速。在 PC 出现之前，有商业生产的“Lisp Machines”，表面上看起来很像现代工作站，但“一直以来”都是 lisp。Lisp 硬件最终输给了英特尔（就像其他一切一样）。Lisp 软件最终输给了 C/C++。有多种理论为什么会这样。 [http://www.andromeda.com/people/ddyer/lisp/](http://www.andromeda.com/people/ddyer/lisp/)

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-10-17T14:47:19.517

方案编程语言被 FLUENT Flow Modeling Software（计算流体动力学，CFD）用作脚本语言。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2009-01-10T18:36:39.490

对于 AutoCAD 应用程序，AutoLISP/Visual LISP 被大量用于实际项目，并且有大量的用户社区。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-11-10T19:17:04.457

我看到一些人已经提到过它，但 lisp 被广泛用于自定义 Autocad 开发。Autocad 包括一个内置的 lisp 解释器。它是扩展产品的最简单方法之一，并提供了快速提高生产力的能力。

在用户端不需要编译，并且可以在命令行上输入 1 个或多个 line lisp 表达式并立即在绘图上执行。对于愿意迈出一小步来学习 lisp 基础知识的设计师和绘图员来说，它可以提供巨大的生产力提升。

Autocad 确实提供了许多其他方式来定制他们的产品。ObjectARX (C++)、VB、C# 等。lisp 接口是迄今为止最容易学习和实现的。大多数其他开发环境都以某种方式使用 lisp。

lisp 解释器在非常早期的 Autocad 版本中可用，称为变量和表达式。它相当有限，但在用户中如此成功，以至于很快添加了额外的功能。后来出现了一个完整的可视化 IDE（我认为是 2000 版）。

我不想猜测 Autocad 有多少行（十亿？）lisp 代码。谷歌搜索“autocad .lsp”返回 230 万次点击。

好的，输入够了，它又可以为我工作了，为我当前的项目写更多的 lisp :)

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2011-04-20T18:54:42.570

Paul Berg 的算法组合工具箱： [http ://www.koncon.nl/downloads/ACToolbox/](http://www.koncon.nl/downloads/ACToolbox/)

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2012-01-23T09:50:36.237

我公司有软件编写方案（PLT）。该软件用于为大公司充当电子邮件防火墙。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2014-02-15T03:57:47.980

[http://echowaves.com](http://echowaves.com)是用 clojure 和 compojure 构建的。该站点是作为一个学习练习而构建的，以了解使用 clojure 构建 Web 应用程序是否实用。答案是——是的！为网络上的 clojure 竖起大拇指。一定要学习clojure——它会改善你的职业生涯。该代码是开源的，如果有人想查看示例，典型的 compojure 应用程序的典型移动部件是什么[https://github.com/echowaves/echowaves](https://github.com/echowaves/echowaves)

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2015-11-08T15:38:28.760

如前所述，计算机代数系统“Maxima”是用 Lisp 编写的，但其他 CAS 也是用 Lisp 编写的，例如 Axiom 及其分支（OpenAxiom 和 Fricas）。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2019-05-15T13:04:33.773

[沃尔玛](https://www.youtube.com/watch?v=av9Xi6CNqq4)使用 clojure 实时处理购买

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2008-12-09T10:08:46.357

只需添加上面所有非常明智的评论：查看 Corman Lisp 工具并了解如何将非常智能的功能嵌入到嵌入式系统中！

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2014-01-02T04:57:50.017

[http://www.gensym.com/](http://www.gensym.com/) - 实时业务规则引擎有许多工业客户。

在内部它是用 Commom Lisp 编写的

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2008-10-05T23:11:01.203

这是一门很棒的语言，但它被削弱了，因为（在我作为软件企业所有者和程序员的观点中）商业 Lisp 包很少，而且少数需要运行时费用（因为合适的 Lisp 包可以最终用户也使用它来编写 Lisp 程序）。

我使用 Steel Bank Common Lisp 在 Windows 和 Linux 下制作代码原型，我喜欢它——但我永远不会考虑发布用它编写的产品。没有简单的方法来设置对程序的单击访问，以便最终用户永远不会遇到 Lisp 提示。没有办法发布编译好的产品，这样用户就无法拆卸它，进行一些更改以删除您的名字，然后将其作为自己的产品出售。我见过提到 Lisp 系统，这两种系统都可以完成，但它们是商业系统，您必须为程序的每个最终用户支付运行时费用，这很荒谬。

Lisp 可能有一天会出现（我热切希望它会出现），但对于大多数商业软件来说它还不可行。唯一的例外是它总是在您可以完全控制的系统上运行，例如 Web 服务器（我只听说有几家公司甚至为此使用它）。

# .net - Is there a way I can tell whether an SMTP server is expecting a client to connect using "implicit" SSL versus "explicit" SSL?

> ID：172811
> 
> 赞同：3
> 
> 时间：2008-10-05T23:10:26.587
> 
> 标签：.net, ssl, smtp, system.net

SSL can either be "explicit" or "implicit" as explained by this link:

[http://help.globalscape.com/help/secureserver2/Explicit_versus_implicit_SS.htm](http://help.globalscape.com/help/secureserver2/Explicit_versus_implicit_SS.htm)

System.Net.Mail only support "explicit" SSL, as explained here:

[http://blogs.msdn.com/webdav_101/archive/2008/06/02/system-net-mail-with-ssl-to-authenticate-against-port-465.aspx](http://blogs.msdn.com/webdav_101/archive/2008/06/02/system-net-mail-with-ssl-to-authenticate-against-port-465.aspx)

So, I'm trying to use System.Net.Mail to connect to an SMTP server that I don't have any control over, and it's failing. How can I know for sure that it's failing because the server wants an "implicit" SSL connection? What test can I do from the client side?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-05T23:44:38.763

Ordinarily this is governed by convention. SMTP running on port 25 (the normal case) uses explicit SSL. SMTPS running on port 465 uses implicit SSL. Mail submission running on port 587 uses explicit SSL.

To tell for sure, telnet to the port, as in "telnet mail.example.com 25". If you see a plain text banner where the server identifies itself, then you are dealing with explicit SSL. If you connect successfully and see nothing, then you are dealing with implicit SSL.

# css - 如何在 CSS 中覆盖表格宽度属性

> ID：172812
> 
> 赞同：10
> 
> 时间：2008-10-05T23:10:29.813
> 
> 标签：css

我在名为 first.css 的外部 CSS 文件中有以下样式

```
table { width: 100%; } 
```

这使得表格填满了它们的容器。如果只有两个小柱子，它们就会显得彼此相距太远。

为了强制列显示得更近，我添加了这种样式

```
table { width: 50%; } 
```

到一个名为 second.css 的新文件并将其链接到 html 文件中。

有什么方法可以覆盖 first.css 中的 width 属性而无需在 second.css 中指定宽度？

我希望 html 的行为就像从来没有宽度属性一样，但我不想修改 first.css

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-05T23:12:41.387

您可以使用：

```
table { width: auto; } 
```

在 second.css 中，严格地使“html 表现得好像从未有过宽度属性”。但我不是 100% 确定这正是您想要的 - 如果不是，请澄清！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T09:12:59.130

您还可以在表格中添加 style="width: auto" 属性 - 这样只会修改页面的 html。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T15:34:05.883

表{宽度：50%；！重要的 }

将 !important 添加到任何样式都会使其覆盖其他样式，无论它是父元素还是子元素

# .net - .NET Firebug 类似 UI 帮助

> ID：172814
> 
> 赞同：0
> 
> 时间：2008-10-05T23:11:53.477
> 
> 标签：.net, firebug

我的任务是一个项目，我需要创建一个像 UI 一样的 Firebug 的缩小版本，用户可以在其中加载 HTML 页面，并且当他们将鼠标悬停在元素上时，它们将被突出显示。该应用程序将允许用户选择要在屏幕上抓取的表格....尚未到达该部分。

有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T01:22:47.800

好吧，我没有使用过 Firebug UI，但我已经完全按照您在 WinForms 应用程序中使用 .NET 2.0 WebBrowser 控件的描述完成了。

基本上我将 WebBrowser 和 Timer 控件添加到表单中，然后在计时器经过事件中，我使用 GetCursorPos 本机函数查询鼠标位置并使用 WebBrowser.Document 的（HtmlDocument 类）GetElementFromPoint 方法（将 x 和 y 位置调整为相对于浏览器控件）。

这将返回鼠标位置下的任何 HtmlElement。这是该方法的主要内容：

```
HtmlElement GetCurrentElement()
{
    if (Browser.ReadyState == WebBrowserReadyState.Complete && Browser.Document != null)
    {
        Win32Point mouseLoc = HtmlScan.Win32.Mouse.GetPosition();
        Point mouseLocation = new Point(mouseLoc.x, mouseLoc.y);
        // modify location to match offset of browser window and control position:
        mouseLocation.X = ((mouseLocation.X - 4) - this.Left) - Browser.Left;
        mouseLocation.Y = ((mouseLocation.Y - 31) - this.Top) - Browser.Top;

        HtmlElement element = Browser.Document.GetElementFromPoint(mouseLocation);

        return element;
    }

    return null;
} 
```

获得 HtmlElement 后，您可以让 InnerHTML 以您认为合适的方式进行解析。

理查德

# javascript - 使用 jQuery 检测 div 的高度何时发生变化

> ID：172821
> 
> 赞同：146
> 
> 时间：2008-10-05T23:16:15.623
> 
> 标签：javascript, jquery

我有一个 div，其中包含一些动态添加和删除的内容，因此它的高度经常变化。我还有一个 div，它绝对位于 javascript 的正下方，所以除非我能检测到 div 的高度何时发生变化，否则我无法重新定位它下面的 div。

那么，如何检测该 div 的高度何时发生变化？我假设我需要使用一些 jQuery 事件，但我不确定要挂接到哪个事件。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2014-10-18T14:30:49.080

使用 css-element-queries 库中的调整大小传感器：

[https://github.com/marcj/css-element-queries](https://github.com/marcj/css-element-queries)

```
new ResizeSensor(jQuery('#myElement'), function() {
    console.log('myelement has been resized');
}); 
```

它使用基于事件的方法，不会浪费您的 CPU 时间。适用于所有浏览器，包括。IE7+。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-08-06T15:17:29.437

我曾经为**[attrchange](http://meetselva.github.io/attrchange/)**监听器写了一个插件，它基本上在属性更改时添加了一个监听器函数。尽管我说它是一个插件，但实际上它是一个编写为 jQuery 插件的简单函数.. 所以如果你想.. 剥离插件特定代码并使用核心功能。

**注意：此代码不使用轮询**

看看这个简单的演示[http://jsfiddle.net/aD49d/](http://jsfiddle.net/aD49d/)

```
$(function () {
    var prevHeight = $('#test').height();
    $('#test').attrchange({
        callback: function (e) {
            var curHeight = $(this).height();            
            if (prevHeight !== curHeight) {
               $('#logger').text('height changed from ' + prevHeight + ' to ' + curHeight);

                prevHeight = curHeight;
            }            
        }
    }).resizable();
}); 
```

**插件页面： http:** [//meetselva.github.io/attrchange/](http://meetselva.github.io/attrchange/)

**缩小版：**（1.68kb）

```
(function(e){function t(){var e=document.createElement("p");var t=false;if(e.addEventListener)e.addEventListener("DOMAttrModified",function(){t=true},false);else if(e.attachEvent)e.attachEvent("onDOMAttrModified",function(){t=true});else return false;e.setAttribute("id","target");return t}function n(t,n){if(t){var r=this.data("attr-old-value");if(n.attributeName.indexOf("style")>=0){if(!r["style"])r["style"]={};var i=n.attributeName.split(".");n.attributeName=i[0];n.oldValue=r["style"][i[1]];n.newValue=i[1]+":"+this.prop("style")[e.camelCase(i[1])];r["style"][i[1]]=n.newValue}else{n.oldValue=r[n.attributeName];n.newValue=this.attr(n.attributeName);r[n.attributeName]=n.newValue}this.data("attr-old-value",r)}}var r=window.MutationObserver||window.WebKitMutationObserver;e.fn.attrchange=function(i){var s={trackValues:false,callback:e.noop};if(typeof i==="function"){s.callback=i}else{e.extend(s,i)}if(s.trackValues){e(this).each(function(t,n){var r={};for(var i,t=0,s=n.attributes,o=s.length;t<o;t++){i=s.item(t);r[i.nodeName]=i.value}e(this).data("attr-old-value",r)})}if(r){var o={subtree:false,attributes:true,attributeOldValue:s.trackValues};var u=new r(function(t){t.forEach(function(t){var n=t.target;if(s.trackValues){t.newValue=e(n).attr(t.attributeName)}s.callback.call(n,t)})});return this.each(function(){u.observe(this,o)})}else if(t()){return this.on("DOMAttrModified",function(e){if(e.originalEvent)e=e.originalEvent;e.attributeName=e.attrName;e.oldValue=e.prevValue;s.callback.call(this,e)})}else if("onpropertychange"in document.body){return this.on("propertychange",function(t){t.attributeName=window.event.propertyName;n.call(e(this),s.trackValues,t);s.callback.call(this,t)})}return this}})(jQuery) 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-06T06:35:12.007

您可以使用 DOMSubtreeModified 事件

```
$(something).bind('DOMSubtreeModified' ... 
```

但是，即使尺寸没有改变，它也会触发，并且在触发时重新分配位置可能会影响性能。根据我使用此方法的经验，检查尺寸是否已更改成本较低，因此您可以考虑将两者结合起来。

或者，如果您直接更改 div（而不是用户输入以不可预知的方式更改 div，例如它是否是 contentEditable），您可以在执行此操作时简单地触发自定义事件。

缺点：IE 和 Opera 没有实现这个事件。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-05-20T16:56:37.973

这就是我最近处理这个问题的方式：

```
$('#your-resizing-div').bind('getheight', function() {
    $('#your-resizing-div').height();
});

function your_function_to_load_content() {
    /*whatever your thing does*/
    $('#your-resizing-div').trigger('getheight');
} 
```

我知道我迟到了几年，只是认为我的回答可能会在未来对某些人有所帮助，而无需下载任何插件。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-10-25T01:11:05.317

你可以使用[`MutationObserver`](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)类。

`MutationObserver`为开发人员提供了一种对 DOM 中的更改做出反应的方法。它旨在替代 DOM3 事件规范中定义的突变事件。

**示例**（[来源](http://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/)）

```
// select the target node
var target = document.querySelector('#some-id');

// create an observer instance
var observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    console.log(mutation.type);
  });    
});

// configuration of the observer:
var config = { attributes: true, childList: true, characterData: true };

// pass in the target node, as well as the observer options
observer.observe(target, config);

// later, you can stop observing
observer.disconnect(); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-08-05T16:28:27.287

**回应 user007：**

如果您的元素的高度由于使用附加到它的项目而发生变化，则`.append()`您不需要检测高度的变化。只需在将新内容附加到第一个元素的同一函数中添加第二个元素的重新定位。

如：

**[工作示例](http://jsfiddle.net/apaul34208/T952A/)**

```
$('.class1').click(function () {
    $('.class1').append("<div class='newClass'><h1>This is some content</h1></div>");
    $('.class2').css('top', $('.class1').offset().top + $('.class1').outerHeight());
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-06-02T13:30:42.180

您可以制作一个简单的 setInterval。

```
function someJsClass()
{
  var _resizeInterval = null;
  var _lastHeight = 0;
  var _lastWidth = 0;

  this.Initialize = function(){
    var _resizeInterval = setInterval(_resizeIntervalTick, 200);
  };

  this.Stop = function(){
    if(_resizeInterval != null)
      clearInterval(_resizeInterval);
  };

  var _resizeIntervalTick = function () {
    if ($(yourDiv).width() != _lastWidth || $(yourDiv).height() != _lastHeight) {
      _lastWidth = $(contentBox).width();
      _lastHeight = $(contentBox).height();
      DoWhatYouWantWhenTheSizeChange();
    }
  };
}

var class = new someJsClass();
class.Initialize();
```

编辑：

这是一个类的例子。但是你可以做一些最简单的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-12-03T19:25:36.713

现在，您还可以使用 Web API [`ResizeObserver`](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver)。

简单的例子：

```
const resizeObserver = new ResizeObserver(() => {
    console.log('size changed');
});

resizeObserver.observe(document.querySelector('#myElement')); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-01T04:01:03.833

你可以使用它，但它只支持 Firefox 和 Chrome。

```
$(element).bind('DOMSubtreeModified', function () {
  var $this = this;
  var updateHeight = function () {
    var Height = $($this).height();
    console.log(Height);
  };
  setTimeout(updateHeight, 2000);
});
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-16T14:56:15.447

非常基本但有效：

```
function dynamicHeight() {
    var height = jQuery('').height();
    jQuery('.edito-wrapper').css('height', editoHeight);
}
editoHeightSize();

jQuery(window).resize(function () {
    editoHeightSize();
}); 
```

# language-agnostic - 您多久担心需要处理多少个案？

> ID：172831
> 
> 赞同：4
> 
> 时间：2008-10-05T23:22:52.067
> 
> 标签：language-agnostic, optimization, performance, if-statement

如果您有以下情况：

```
$var = 3; // we'll say it's set to 3 for this example
if ($var == 4) {
    // do something
} else if ($var == 5) {
    // do something
} else if ($var == 2) {
    // do something
} else if ($var == 3) {
    // do something
} else {
    // do something
} 
```

如果说 80% 的时间`$var`是 3，您是否担心在找到真正的案例之前它会经历 4 个 if 案例？

我在想在一个小站点上这没什么大不了的，但是当那个 if 语句每秒运行 1000 次时呢？

我正在使用 PHP，但我认为语言无关紧要。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-05T23:56:13.000

以下是我过去为雷达系统编写软件时的做法。（速度在雷达中很重要。它是少数几个“实时”实际上意味着“真实”而不是“快速”的地方之一。）

[我将切换到 Python 语法，这对我来说更容易，我相信你可以解释它。]

```
if var <= 3:
    if var == 2:
        # do something
    elif var == 3:
        # do something
    else: 
        raise Exception
else:
    if var == 4:
        # do something
    elif var == 5:
        # do something
    else:
        raise Exception 
```

您的 if 语句形成树而不是平面列表。当您向此列表添加条件时，您会在树的中心周围晃动。*n*次比较的平坦序列平均需要*n* /2 步。该树导致进行 log( *n* ) 比较的一系列比较。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-05T23:26:57.003

好吧，我相信*几乎所有时候*，例如，具有数字排序值的易读性将覆盖您通过减少比较指令的数量可能获得的任何微小好处。

话虽如此，与所有优化一样：

1.  让它起作用
2.  测量它
3.  如果它足够快，别管它
4.  如果它太慢，那么优化它

哦，我可能会从一开始就使用开关/外壳！;-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-05T23:26:01.610

发生这种情况的一个经典案例（在您的帖子中实际上有 5 个选项）是在 ffmpeg 中的 decode_cabac_residual 函数中。这是相当重要的，因为分析（非常重要——不要在分析之前优化！）表明它占 H.264 视频解码所用时间的 10-15% 以上。if 语句控制一组语句，这些语句对要解码的各种残差类型的计算方式不同——不幸的是，如果函数对 5 种类型中的每一种重复 5 次，则会由于代码大小而损失太多速度剩余的。因此，必须使用 if 链。

对许多常见的测试流进行了分析，以根据可能性对它们进行排序；顶部是最常见的，底部是最少的。这给出了小的速度增益。

现在，在 PHP 中，我怀疑您在 C 中获得的低级样式速度增益要少得多，如上例所示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T23:57:52.807

使用 switch/case 语句绝对是这里的方法。

这使编译器（解释器）有机会利用跳转表到达正确的分支，而无需进行 N 次比较。想象一下它创建了一个索引为 0、1、2、.. 的地址数组，然后它可以在一次操作中在数组中查找正确的地址。

另外，由于 case 语句中的语法开销较小，因此它也更容易阅读。

**更新：**如果比较适用于 switch 语句，那么这是配置文件引导优化可以提供帮助的领域。通过运行具有实际测试负载的 PGO 构建，系统可以生成分支使用信息，然后使用它来优化所采用的路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-05T23:36:39.013

如果代码必须进行额外的测试，那么它肯定会运行得更慢。如果在这部分代码中性能很重要，那么您应该将最常见的情况放在首位。

当您不确定性能是否足够快时，我通常同意“测量，然后优化”方法，但是如果代码只需要尽可能快地运行并且修复就像重新安排测试一样简单，那么我现在要快速编写代码，并在您上线后进行一些测量，以确保您的假设（例如 3 将在 80% 的时间发生）实际上是正确的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T02:51:23.550

我不会回答 PHP 问题，而是更笼统地回答一下。它并不直接适用于 PHP，因为它会经过某种解释。

如果需要，许多编译器可以在 if-elif-elif-... 块之间进行转换以切换块，并且 elif 部分中的测试足够简单（并且其余的语义恰好是兼容的）。对于 3-4 次测试，使用跳表不一定能获得任何好处。

原因是 CPU 中的分支预测器非常擅长预测会发生什么。实际上，唯一发生的事情是对指令获取的压力有点高，但它几乎不会是惊天动地的。

但是，在您的示例中，大多数编译器会识别 $var 是常量 3，然后在 if..elif.. 块中将 $var 替换为 3。这反过来又使表达式保持不变，因此它们被折叠为真或假。所有的假分支都被死代码消除器杀死，并且对真的测试也被消除了。剩下的是 $var == 3 的情况。不过你不能依赖 PHP 这么聪明。一般来说，您不能进行 $var 的传播，但它可能来自某些调用站点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T18:37:08.103

您可以尝试调用一组代码块。那么所有代码​​块都有相同的开销。

### Perl 6：

```
our @code_blocks = (
  { 'Code Block 0' },
  { 'Code Block 1' },
  { 'Code Block 2' },
  { 'Code Block 3' },
  { 'Code Block 4' },
  { 'Code Block 5' },
);

if( 0 <= $var < @code_blocks.length ){
  @code_blocks[$var]->();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T02:12:59.150

对于纯粹是平等分析的代码，我会将其移至开关/案例，因为这样可以提供更好的性能。

```
$var = 3; // we'll say it's set to 3 for this example
switch($var)
 {
   case 4:
      //do something
      break;
   case 5:
      //do something
      break;
   case:
      //do something when none of the provided cases match (same as using an else{ after the elseif{
 } 
```

现在，如果您进行更复杂的比较，我会将它们嵌套在开关中，或者只使用 elseif。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T02:16:58.970

在面向对象的语言中，如果一个选项提供了大量的 if，那么这意味着您应该将行为（例如，您的`//do something`块）移动到包含该值的对象。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-06T02:35:35.843

只有您可以判断优化顺序或将其重新排列为实际上是二叉树的性能差异是否会产生显着差异。但我怀疑你必须每秒有数百万次，而不是数千次，才能在 PHP 中思考它（在其他一些语言中更是如此）。

计时。看看你每秒可以运行多少次 if/else if/else 语句而不采取任何行动并且 $var 不是选项之一。

# java - 格式化程序覆盖的选择

> ID：172841
> 
> 赞同：1
> 
> 时间：2008-10-05T23:28:37.343
> 
> 标签：java, swing, caret, formatter

当用户单击我要选择内容的文本字段时，我已将 a 应用于a `Formatter`。`JFormattedTextField``FormatterFactory`

焦点侦听器无法按预期工作，因为调用了格式化程序，最终导致值被重置，最终取消选择字段内容。我认为正在发生的事情是在值更改后，插入符号移动到最右边的位置，这会取消选择该字段。

有谁知道如何解决这个问题并正确选择字段内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T06:07:31.797

快速而肮脏的解决方法是使用您的 focusListener 中的 EventQueue.invokeLater。

```
 EventQueue.invokeLater(new Runnable(){
  public void run() { yourTextField.selectAll();}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T06:34:30.960

您使用的是哪个 jdk - 有没有可能这是其中的一个错误？

# c++ - 您如何使用 Boost.Test 指定应该预期的异常？

> ID：172854
> 
> 赞同：27
> 
> 时间：2008-10-05T23:38:29.057
> 
> 标签：c++, unit-testing, exception, boost-test

我有一个 Boost 单元测试用例，它会导致被测对象抛出异常（这就是测试，导致异常）。我如何在测试中指定预期该特定异常。

我可以通过使用 BOOST_AUTO_TEST_CASE_EXPECTED_FAILURES 指定测试应该有一定数量的失败，但这似乎相当不具体。我希望能够在测试中的特定点说应该抛出异常并且不应将其视为失败。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-06T01:41:56.250

这不行吗？

```
BOOST_CHECK_THROW (expression, an_exception_type); 
```

如果表达式抛出给定的异常类型，那应该会导致测试通过，否则会失败。如果您需要与“CHECK”不同的严重性，您也可以使用`BOOST_WARN_THROW()`or`BOOST_REQUIRE_THROW()`代替。请参阅[文档](http://www.boost.org/doc/libs/1_35_0/libs/test/doc/components/test_tools/reference/BOOST_CHECK_THROW.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-06T07:15:58.040

您还可以使用 BOOST_CHECK_EXCEPTION，它允许您指定验证异常的测试函数。

# c++ - LLVM 最大的好处是什么？

> ID：172863
> 
> 赞同：45
> 
> 时间：2008-10-05T23:48:08.350
> 
> 标签：c++, c, llvm, clang

有人对[**LLVM**](http://llvm.org/)、[**llvm-gcc**](http://dragonegg.llvm.org/)或[**Clang**](http://clang.llvm.org/)有经验吗？

llvm 背后的整个想法对我来说似乎很有趣，我很想看看它的表现如何。如果工具还没有准备好投入生产，我只是不想浪费大量时间来试用这些工具。

如果您有使用这些工具的经验，您如何看待它们？您遇到了哪些主要限制？最大的好处是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-01T01:17:03.860

关于 LLVM，我不能说太多好话。与我看过的其他编译器项目相比，它非常容易使用。我不是编译器专家，但是当我对 LLVM 或 clang 的某些限制感到沮丧时，通常很容易潜入并更改它。

我们（Nate Begeman、我自己和其他一些人）在编译器设计方面没有实际经验的情况下编写了 PPC 后端，但它看起来很简单，非专家也可以接近它。我们对 PPC 组装非常熟悉，但是我们在空闲时间的几周内设法让 LLVM-gcc 输出 PPC 代码仍然令人难以置信。绝对是我编译过的最令人满意的 Hello World 之一。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-22T07:22:34.217

我已经断断续续地玩 LLVM 好几个月了。我写了两篇关于从[OCaml](http://www.ffconsultancy.com/)编程语言中使用 LLVM 的[OCaml Journal文章。](http://www.ffconsultancy.com/)这一点特别有趣，因为 OCaml 语言非常适合编写编译器，并且拥有大量强大且成熟的工具和库用于解析等。

总的来说，我的经历非常积极。LLVM 做到了它在锡上所说的，并且非常易于使用。生成的代码的性能非常好。我编写的程序之一是一个简单的小 Brainf*ck 编译器，它可以生成我测试过的任何编译器（包括 GCC）中最快的可执行文件。

我对 LLVM 只有两个不满。首先，它在出现任何问题时使用 abort() 而不是引发异常。这是其作者的一个深思熟虑的设计决定，他们正在努力从 LLVM 中删除所有异常使用，但是当尝试调试使用 LLVM 的编译器时，它使得不可能从 OCaml 获得回溯：你的程序只是死于来自 LLVM 的文本解释但不知道您的源中发生错误的位置。其次，LLVM 的编译库非常大（20Mb）。我认为这是由于 C++ 引起的膨胀，但它使编译非常缓慢。

编辑：我在 LLVM 上的工作最终导致创建了一个高性能的高级垃圾收集虚拟机。[在此处](http://hlvm.forge.ocamlcore.org/)免费下载并查看相应的[基准测试](http://flyingfrogblog.blogspot.com/2009/03/performance-ocaml-vs-hlvm-beta-04.html)（哇！）。@Alex：我会尽快在某个地方为您准备好那个 BF 编译器。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-06T00:03:41.407

我对 LLVM 进行了初步尝试，完成[本教程](http://llvm.org/docs/tutorial/LangImpl1.html)后，我对它的潜力感到非常兴奋；我可以使用它相对轻松地将 JIT 构建到应用程序中的想法让我很兴奋。

我还没有深入到能够就其局限性、稳定性、性能等提供任何有用的意见。我知道这在所有方面都很好，但这纯粹是道听途说。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-13T08:46:07.497

您询问了工具，我想提一下 Eclipse CDT（适用于 Windows、Linux 和 Mac）的 LLVM 插件。它将 LLVM 很好地集成到 IDE 中，用户不需要了解有关 LLVM 的任何信息。按下构建按钮就足以生成 .bc 和可执行文件（以及用户不可见的后台中间文件）。

最新版本可通过官方 Eclipse 更新站点获得：http: [//download.eclipse.org/releases/mars](http://download.eclipse.org/releases/mars)

它在 Programming Languages 下，被命名为“C/C++ LLVM-Family Compiler Build Support”。

# project-management - 有没有更简单的方法来跟踪 ExtremePlanner 中的范围变化？

> ID：172867
> 
> 赞同：1
> 
> 时间：2008-10-05T23:55:12.907
> 
> 标签：project-management, scheduling

我即将在一个项目的中途加入一个新的软件团队。他们正在使用 ExtremePlanner 来跟踪他们的进度。

虽然他们跟踪已完成的任务，但他们并没有跟踪项目的估计规模如何随时间变化。在很短的时间内，我一直在监控这个项目，这个估计的变化速度超过了任务的完成率。我的直觉告诉我，这不仅仅是一个昙花一现，而是在整个项目生命周期中一直存在的问题。

但我如何证明或反驳这一点？

我还没有发现 ExtremePlanner 指标对此有用。我一直在将数据导出到 MS Excel，但导出的任务和故事信息缺少创建日期等重要数据。解决这个问题需要一些工作。有没有更好的方法来做到这一点？

或者我做太多了吗？我的一些潜在团队成员认为，由于没有添加新功能，因此范围没有改变，这不是问题。但是我认为，由于不断发现功能中的新工作，因此范围正在发生变化，并且在估计发布日期时需要考虑到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T00:36:16.127

如果这是一个敏捷项目（例如，使用 Scrum、XP 等），那么您可能正在迭代（或冲刺）中工作。

所以我的问题是——在一次迭代中，事情是否会发生如此频繁的变化，以至于您需要对其进行测量？通常，敏捷项目通过在单个迭代中冻结功能来引导。是的，您可能会发现新的可能实施细节或技术障碍，但它们都只是 2 周迭代内的细节。

如果您的迭代时间过长，我确实看到了您的担忧，因为如果每次迭代需要一个月或 6 周的时间来纠正课程，您会花费很长时间。

我想我会问——如果你有这些报告，你会怎么做，上面会写什么？

任务估计最初是什么以及现在是什么的基线？ExtremePlanner 确实提供了有关任务的原始估计的信息，因此您可以将它们与迭代的当前状态进行比较（请参阅任务视图 - 您可能需要单击该视图的“自定义”链接以显示原始估计列）。

如果还有更多内容，我会对您在那里发现有用的东西感兴趣（我们也使用 ExtremePlanner 并且没有遇到这种需求，尽管我们使用 2 周的迭代）。

希望这可以帮助。

# java - 如何确定 JNI (jogl) 在运行时是否可用？

> ID：172869
> 
> 赞同：1
> 
> 时间：2008-10-05T23:56:08.567
> 
> 标签：java, java-native-interface, jogl

我正在开发一个使用 Processing 核心库[的源代码可视化项目。](http://github.com/rictic/code_swarm/tree/master/)处理库可以选择使用 jogl OpenGL 库来渲染图形，从而真正提高性能。但是，jogl 使用的 JNI 文件不一定在运行时可用，这取决于谁在使用项目以及在什么平台上。

目前我们只是让用户指定他们是否要使用 OpenGL，但如果我们可以默认使用 OpenGL 并且仅在它不可用时回退到软件渲染，那显然会更好。处理库似乎并没有让这变得简单，你应该只指定一次渲染器，并且更改渲染器会产生……新颖的行为。

知道如何确定 jogl 所需的 JNI 是否可用并在运行时工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T04:06:18.390

很简单，只需尝试使用[loadClass](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#loadClass(java.lang.String))使用 ClassLoader 加载类并捕获 ClassNotFound 异常和 UnsatisfiedLinkError 以执行回退功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-22T13:52:47.503

确保您可以使用 Jogl 的另一种巧妙方法是通过 JNLP 进行部署。您可以将 Jogl 作为远程依赖项包含在内，Java 启动器将自动获取适当的本机版本。

# project-management - 如何管理许多任务/项目的文档

> ID：172871
> 
> 赞同：2
> 
> 时间：2008-10-05T23:56:28.770
> 
> 标签：project-management, task-tracking

我可能在问世界，但是否有任何基于 Windows 的软件可以轻松管理大量任务/项目以及所有可以快速导航/搜索的相关文档（电子表格、Word 文档、其他文件）。

我处理大约 10 到 20 个活跃的项目和任务，有些只持续一天左右，有些持续数周，有些持续数月。我喜欢将任何项目的所有内容都保存在一个文件夹中，但在保存电子表格、SQL 脚本时，或者如果我想将网站快捷方式拖到文件夹中以便在我可以找到它时，我似乎永远都在浏览文件夹树需要它。

我尝试了各种文件夹组织（即顶级项目目录，然后按部门或个人或应用程序细分），但无论我尝试什么，找到我正在寻找的东西仍然太耗时。最接近我正在寻找的东西就像 Lotus 在 DOS 时代在他们的议程程序中所拥有的那样，您可以在其中以多种方式组织和查看数据，我希望能够用一个不错的快速 Windows 做同样的事情将与 Explorer 完全集成的应用程序，因此当询问我在哪里保存某些内容时，它会知道我正在积极从事哪些项目，甚至可能进行一些最小的项目管理，以便当我将事情标记为完成时，它们的目录将不再出现，或者如果某物被标记为高优先级，它将显示在顶部或用颜色编码。

**编辑：** 将用户定义的标签添加到资源管理器，过滤可能会完成 90%；如果我可以定义 10 - 20 个标签，并且在资源管理器中有一个选项来显示单个标签，那么它将只显示任何具有标有该标签的内容的文件夹。如果您可以有一个选项卡式界面，每个标签对应一个选项卡，那就更棒了。Mac 在文件上使用颜色编码的用户标签至少 10 年了。我不想问Vista是否有这个，但如果有的话我会看看它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T09:58:39.397

我有同样的问题。

我相信答案还没有被发明出来（如果我有时间，我会自己写它并赚几百万）。

本质上，我们需要窃取 GMail 的“标签”概念，并用它来完全取代 Windows 资源管理器来管理数字资源。

这个想法很简单，您可以根据需要多次“标记”或“标记”每个资源（例如“Project Albatross”、“Analysis”、“Phase 1”等）。

然后，应用程序将允许您通过标签/标签动态浏览（选择“Project Albatross”将显示“Analysis”和“Phase 1”的子文件夹，选择“Phase 1”将显示“Analysis”，反之亦然），而不是仅限于静态树。

一些网站（比如这个）和 Outlook 已经有了类似的想法。事实上，我认为与 Outlook 和网站标记的集成将大大有助于使该应用程序成为必备品。不幸的是，对于网站集成，我们几乎需要某种用于标记的开放标准，这可能是一项相当大的工作……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T05:14:28.113

[Omea Pro](http://www.jetbrains.com/omea/)
它是免费的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:40:14.287

Vista 确实具有一些可能对文档有所帮助的标记功能：[Windows Vista (LifeHacker) 中的标记文件和保存搜索](http://lifehacker.com/software/vista/geek-to-live--tag-files-and-save-searches-in-windows-vista-232891.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T02:47:57.880

您应该查看[Tele-Support HelpDesk](http://www.resource-dynamics.com)。它有一个已知问题数据库，现在允许您将附件用于您的项目。优先系统允许进行颜色编码，并且具有广泛的过滤系统。您甚至可以将“联系人”附加到每个已知问题，以便您快速联系项目所针对的人员。

虽然没有像您提到的那样与外壳集成，但可以使用简单的拖放过程将链接添加到已知问题或查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T09:26:39.087

问题的根源似乎在于找到正确的文件。

为什么不试试[Windows Search](http://www.microsoft.com/windows/products/winfamily/desktopsearch/default.mspx)（显然它与 Office 产品集成，包括 Outlook）或[Google 桌面](http://desktop.google.com/)？

简单的文件夹结构、标记文件和搜索确实对我的软件开发项目有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T09:42:17.217

我同意 Rinat，Google 桌面或 Windows 桌面搜索将为您提供大约 80% 的路径。您需要的另一件事是某种版本控制 - CVS、RCS、SVN、GIT、Clearcase ......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-09T18:14:12.030

我认为[Directory Opus](http://www.gpsoft.com.au/index.html)会做你想做的（[这里](http://reviewlagoon.com/directory-opus-10-the-power-user-file-manager/)有很好的评论）。它是 Windows 资源管理器的替代品，并且已经存在了至少 20 年，也许更久。它支持非常复杂的过滤，还可以标记和着色文件，如[这个线程](http://resource.dopus.com/viewtopic.php?t=8508)所示。例如，您可以设置过滤文件的颜色，以便以 .jpg 结尾的文件是不同的颜色，或者显示过去 1 小时内修改过的文件，诸如此类。您也可以使用正则表达式。[此处](http://gpsoft.com.au/help/opus10/default.htm#!Documents/Prefs/Labels.htm)显示标签系统的详细信息。您还可以为标签使用自定义图标。

您还可以创建文件的“集合”，即“虚拟文件夹”，将不同的文件和文件夹放在一个文件夹中。更多关于文件集合[的信息](http://gpsoft.com.au/help/opus10/default.htm#!Documents/File_Collections.htm)。

除了这些功能之外，您还可以完全自定义界面（是的，一切，包括双窗格视图等）、搜索、同步、脚本、FTP - 它还在不断地进行，并且仍在积极开发和改进中。多年来，我一直是一个满意的用户。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-06T00:20:50.797

是的，Microsoft Team Foundation Server 可以完成所有这些工作（它与 SharePoint 网站相关联并使用它），当然这会花费您一些成本。:-)

将 Project Server 添加到组合中，您还可以发布 Microsoft Project 功能以共享点可查看站点。

# c# - 如何在 C# 中禁用/启用网络连接

> ID：172875
> 
> 赞同：29
> 
> 时间：2008-10-05T23:59:31.853
> 
> 标签：c#, networking, lan

基本上我正在运行一些性能测试并且不希望外部网络成为拖累因素。我正在研究禁用网络 LAN 的方法。以编程方式执行此操作的有效方法是什么？我对c#很感兴趣。如果有人有一个可以将要点带回家的代码片段，那将是很酷的。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-05-29T21:22:29.040

在搜索相同的东西时发现了这个线程，所以，这是答案:)

我在 C# 中测试的最佳方法是使用 WMI。

[http://www.codeproject.com/KB/cs/EverythingInWmi02.aspx](http://www.codeproject.com/KB/cs/EverythingInWmi02.aspx)

[msdn 上的 Win32_NetworkAdapter](http://msdn.microsoft.com/en-us/library/aa394216)

C# 片段：（必须在解决方案和使用声明中引用 System.Management）

```
SelectQuery wmiQuery = new SelectQuery("SELECT * FROM Win32_NetworkAdapter WHERE NetConnectionId != NULL");
ManagementObjectSearcher searchProcedure = new ManagementObjectSearcher(wmiQuery);
foreach (ManagementObject item in searchProcedure.Get())
{
    if (((string)item["NetConnectionId"]) == "Local Network Connection")
    {
       item.InvokeMethod("Disable", null);
    }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-12T10:01:32.040

使用 netsh 命令，您可以启用和禁用“本地连接”</p>

```
 interfaceName is “Local Area Connection”.

  static void Enable(string interfaceName)
    {
     System.Diagnostics.ProcessStartInfo psi =
            new System.Diagnostics.ProcessStartInfo("netsh", "interface set interface \"" + interfaceName + "\" enable");
        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo = psi;
        p.Start();
    }

    static void Disable(string interfaceName)
    {
        System.Diagnostics.ProcessStartInfo psi =
            new System.Diagnostics.ProcessStartInfo("netsh", "interface set interface \"" + interfaceName + "\" disable");
        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo = psi;
        p.Start();
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-15T14:13:52.047

如果您正在寻找一种非常简单的方法来做到这一点，那么您可以：

```
 System.Diagnostics.Process.Start("ipconfig", "/release"); //For disabling internet
    System.Diagnostics.Process.Start("ipconfig", "/renew"); //For enabling internet 
```

确保以管理员身份运行。我希望你觉得这很有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-12T10:54:44.010

在 VB.Net 中，您还可以使用它来切换本地连接

注意：我自己在 Windows XP 中使用它，它在这里正常工作。但在 Windows 7 中它不能正常工作。

```
 Private Sub ToggleNetworkConnection()

    Try

        Const ssfCONTROLS = 3

        Dim sConnectionName = "Local Area Connection"

        Dim sEnableVerb = "En&able"
        Dim sDisableVerb = "Disa&ble"

        Dim shellApp = CreateObject("shell.application")
        Dim WshShell = CreateObject("Wscript.Shell")
        Dim oControlPanel = shellApp.Namespace(ssfCONTROLS)

        Dim oNetConnections = Nothing
        For Each folderitem In oControlPanel.items
            If folderitem.name = "Network Connections" Then
                oNetConnections = folderitem.getfolder : Exit For
            End If
        Next

        If oNetConnections Is Nothing Then
            MsgBox("Couldn't find 'Network and Dial-up Connections' folder")
            WshShell.quit()
        End If

        Dim oLanConnection = Nothing
        For Each folderitem In oNetConnections.items
            If LCase(folderitem.name) = LCase(sConnectionName) Then
                oLanConnection = folderitem : Exit For
            End If
        Next

        If oLanConnection Is Nothing Then
            MsgBox("Couldn't find '" & sConnectionName & "' item")
            WshShell.quit()
        End If

        Dim bEnabled = True
        Dim oEnableVerb = Nothing
        Dim oDisableVerb = Nothing
        Dim s = "Verbs: " & vbCrLf
        For Each verb In oLanConnection.verbs
            s = s & vbCrLf & verb.name
            If verb.name = sEnableVerb Then
                oEnableVerb = verb
                bEnabled = False
            End If
            If verb.name = sDisableVerb Then
                oDisableVerb = verb
            End If
        Next

        If bEnabled Then
            oDisableVerb.DoIt()
        Else
            oEnableVerb.DoIt()
        End If

    Catch ex As Exception
        MsgBox(ex.Message)
    End Try

End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-07T19:08:28.783

对于 Windows 10 更改：对于 diable ("netsh", "interface set interface name=" + interfaceName + " admin=DISABLE") 和对于启用 ("netsh", "interface set interface name=" + interfaceName +" admin= ENABLE") 并以管理员身份使用该程序

```
 static void Disable(string interfaceName)
    {

        //set interface name="Ethernet" admin=DISABLE
        System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo("netsh", "interface set interface name=" + interfaceName + " admin=DISABLE");
        System.Diagnostics.Process p = new System.Diagnostics.Process();

        p.StartInfo = psi;
        p.Start();
    }

    static void Enable(string interfaceName)
    {
        System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo("netsh", "interface set interface name=" + interfaceName + " admin=ENABLE");
        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo = psi;
        p.Start();
    } 
```

并以管理员身份使用程序！！！！！！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-26T07:38:58.937

最好的解决方案是禁用所有网络适配器，无论接口名称如何，都使用此代码段禁用和启用所有网络适配器（运行需要管理员权限，否则它不会工作）：

```
 static void runCmdCommad(string cmd)
    {
        System.Diagnostics.Process process = new System.Diagnostics.Process();
        System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
        //startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
        startInfo.FileName = "cmd.exe";
        startInfo.Arguments = $"/C {cmd}";
        process.StartInfo = startInfo;
        process.Start();
    }
   static void DisableInternet(bool enable)
    {
        string disableNet = "wmic path win32_networkadapter where PhysicalAdapter=True call disable";
        string enableNet = "wmic path win32_networkadapter where PhysicalAdapter=True call enable";
        runCmdCommad(enable ? enableNet :disableNet);
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-08T09:42:11.320

我将来自[Kamrul Hasan的](https://stackoverflow.com/users/1557156/kamrul-hasan)[最佳投票解决方案](https://stackoverflow.com/a/18761206/5941260)修改为一种方法并添加以等待进程退出，导致我的单元测试代码运行得比进程禁用连接更快。

```
private void Enable_LocalAreaConection(bool isEnable = true)
    {
        var interfaceName = "Local Area Connection";
        string control;
        if (isEnable)
            control = "enable";
        else
            control = "disable";
        System.Diagnostics.ProcessStartInfo psi =
               new System.Diagnostics.ProcessStartInfo("netsh", "interface set interface \"" + interfaceName + "\" " + control);
        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo = psi;
        p.Start();
        p.WaitForExit();
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-25T16:44:27.157

在这里查看其他答案，虽然有些工作，但有些没有。Windows 10 使用与此链中较早使用的不同的 netsh 命令。其他解决方案的问题在于，它们将打开一个用户可见的窗口（尽管只有几分之一秒）。下面的代码将静默启用/禁用网络连接。

下面的代码绝对可以清理，但这是一个不错的开始。

***请注意，它必须以管理员身份运行才能工作***

```
//Disable network interface
static public void Disable(string interfaceName)
{
    System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
    startInfo.FileName = "netsh";
    startInfo.Arguments = $"interface set interface \"{interfaceName}\" disable";
    startInfo.RedirectStandardOutput = true;
    startInfo.RedirectStandardError = true;
    startInfo.UseShellExecute = false;
    startInfo.CreateNoWindow = true;
    System.Diagnostics.Process processTemp = new System.Diagnostics.Process();
    processTemp.StartInfo = startInfo;
    processTemp.EnableRaisingEvents = true;
    try
    {
        processTemp.Start();
    }
    catch (Exception e)
    {
        throw;
    }
}

//Enable network interface
static public void Enable(string interfaceName)
{
    System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
    startInfo.FileName = "netsh";
    startInfo.Arguments = $"interface set interface \"{interfaceName}\" enable";
    startInfo.RedirectStandardOutput = true;
    startInfo.RedirectStandardError = true;
    startInfo.UseShellExecute = false;
    startInfo.CreateNoWindow = true;
    System.Diagnostics.Process processTemp = new System.Diagnostics.Process();
    processTemp.StartInfo = startInfo;
    processTemp.EnableRaisingEvents = true;
    try
    {
        processTemp.Start();
    }
    catch (Exception e)
    {
        throw;
    }
} 
```

# f# - F# 在同一项目的另一个文件中定义/使用类型/模块

> ID：172888
> 
> 赞同：82
> 
> 时间：2008-10-06T00:12:12.780
> 
> 标签：f#

这将是一个容易的。我有一个带有两个文件（Program.fs、Stack.fs）的 F# 项目（最新的 F# CTP）。在 Stack.fs 我有一个简单的命名空间和类型定义

堆栈.fs

```
namespace Col

type Stack= 
 ... 
```

现在我尝试通过声明将名称空间包含在 Program.fs 中

```
open Col 
```

这不起作用并给我错误“未定义命名空间或模块 Col”。然而它是在同一个项目中定义的。我必须遗漏一些明显的东西

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-06T00:20:10.203

项目中文件的顺序是什么？Stack.fs 需要出现在 Program.fs 之前，以便 Program.fs 能够“看到”它。

又见开始

[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!444.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!444.entry)

和结束

[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!347.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!347.entry)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-10-22T22:37:54.807

我有同样的问题，你是对的，编译器会考虑文件的顺序。您可以使用与 .fs 文件关联的上下文菜单中的上移/下移项目，而不是删除和添加模式。（Alt-Up 和 Alt-Down 是大多数标准键绑定中的快捷键）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-06-03T02:59:25.960

以上都是正确的，但是如何在VS2013中做到这一点是另一个问题。我必须手动编辑我的**.fsproj**文件，并在 ItemGroup 节点中按确切顺序设置文件。在这种情况下，它看起来像这样：

```
<ItemGroup>
    <Compile Include="Stack.fs" />
    <Compile Include="Program.fs" />
    <None Include="App.config" />
</ItemGroup> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T14:35:44.173

我有同样的问题，确实是文件的顺序。但是，上面的链接没有描述如何在 Visual Studio 2008 F# 1.9.4.19 中修复它。

如果您打开一个模块，请确保您的源文件位于解决方案资源管理器中的依赖项*之后。*只需右键单击您的源并选择删除。然后重新添加它。这将使它出现在列表的底部。希望你没有循环依赖。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-06T21:20:14.670

我正在使用 Visual Studio for Mac - 8.1.4，我注意到一些 .fs 文件未标记为“编译”。您可以通过查看构建输出来查看这一点，并查看您的所有文件是否都在那里并且顺序正确。

我必须手动确保某些文件标有“编译”，并且必须手动上下移动它们，直到它“占用”。

# sql - Microsoft Access 中的表创建 DDL

> ID：172895
> 
> 赞同：19
> 
> 时间：2008-10-06T00:19:53.700
> 
> 标签：sql, ms-access

有什么简单的方法可以从 Microsoft Access (2007) 中检索表创建 DDL，还是我必须使用 VBA 自己编写代码来读取表结构？

我有大约 30 个要移植到 Oracle 的表，如果我们可以从 Access 定义中创建表，那将会更轻松。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-06T02:12:00.680

感谢其他建议。在等待的时候，我写了一些 VBA 代码来做这件事。它并不完美，但为我完成了这项工作。

```
Option Compare Database
Public Function TableCreateDDL(TableDef As TableDef) As String

         Dim fldDef As Field
         Dim FieldIndex As Integer
         Dim fldName As String, fldDataInfo As String
         Dim DDL As String
         Dim TableName As String

         TableName = TableDef.Name
         TableName = Replace(TableName, " ", "_")
         DDL = "create table " & TableName & "(" & vbCrLf
         With TableDef
            For FieldIndex = 0 To .Fields.Count - 1
               Set fldDef = .Fields(FieldIndex)
               With fldDef
                  fldName = .Name
                  fldName = Replace(fldName, " ", "_")
                  Select Case .Type
                     Case dbBoolean
                        fldDataInfo = "nvarchar2"
                     Case dbByte
                        fldDataInfo = "number"
                     Case dbInteger
                        fldDataInfo = "number"
                     Case dbLong
                        fldDataInfo = "number"
                     Case dbCurrency
                        fldDataInfo = "number"
                     Case dbSingle
                        fldDataInfo = "number"
                     Case dbDouble
                        fldDataInfo = "number"
                     Case dbDate
                        fldDataInfo = "date"
                     Case dbText
                        fldDataInfo = "nvarchar2(" & Format$(.Size) & ")"
                     Case dbLongBinary
                        fldDataInfo = "****"
                     Case dbMemo
                        fldDataInfo = "****"
                     Case dbGUID
                        fldDataInfo = "nvarchar2(16)"
                  End Select
               End With
               If FieldIndex > 0 Then
               DDL = DDL & ", " & vbCrLf
               End If
               DDL = DDL & "  " & fldName & " " & fldDataInfo
               Next FieldIndex
         End With
         DDL = DDL & ");"
         TableCreateDDL = DDL
End Function

Sub ExportAllTableCreateDDL()

    Dim lTbl As Long
    Dim dBase As Database
    Dim Handle As Integer

    Set dBase = CurrentDb

    Handle = FreeFile

    Open "c:\export\TableCreateDDL.txt" For Output Access Write As #Handle

    For lTbl = 0 To dBase.TableDefs.Count - 1
         'If the table name is a temporary or system table then ignore it
        If Left(dBase.TableDefs(lTbl).Name, 1) = "~" Or _
        Left(dBase.TableDefs(lTbl).Name, 4) = "MSYS" Then
             '~ indicates a temporary table
             'MSYS indicates a system level table
        Else
          Print #Handle, TableCreateDDL(dBase.TableDefs(lTbl))
        End If
    Next lTbl
    Close Handle
    Set dBase = Nothing
End Sub 
```

我从未声称自己是 VB 程序员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T00:30:37.640

我已经这样做了：

有一个从 Access 到 SQL Server 的“升迁”工具。这样做，然后使用出色的 SQL Server 工具生成脚本。

[http://support.microsoft.com/kb/237980](http://support.microsoft.com/kb/237980)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T15:08:47.960

使用 Oracle 的 SQL Developer 迁移工作台。

[此处](http://www.oracle.com/technology/products/database/application_express/migrations/tutorial.html)提供了有关将 Access 数据库转换为 Oracle 的完整教程。如果它只是您所追求的结构，那么您可以专注于第 3.0 节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T01:32:38.920

您可以使用 Access 中的导出功能将表导出到 ODBC 数据源。将 ODBC 数据源设置为 Oracle 数据库，然后右键单击 Access“表”选项卡中的表并选择导出。ODBC 是“文件格式”之一——它会弹出通常的 ODBC 对话框。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T02:39:44.917

您可能想查看 ADOX 以获取架构信息。使用 ADOX，您可以获得诸如键、视图、关系等内容。

不幸的是，我不是 VB 程序员，但网络上有很多使用 ADOX 获取表模式的示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-17T15:19:13.307

聚会有点晚了，但我使用 RazorSQL 为 Access 数据库生成 DDL。

# linux - 使用 Linux，如何指定在哪个以太网接口上传输数据

> ID：172905
> 
> 赞同：14
> 
> 时间：2008-10-06T00:28:29.300
> 
> 标签：linux, routing, networking, tcp

我正在开发一个基于 Linux 的服务器系统，其中有两个网络接口，都在同一个子网上（现在，假设它们是`172.17.32.10`& `172.17.32.11`）。当我将数据发送到网络上的主机时，我想指定我的服务器上的哪个接口传输数据。我需要能够在软件中从一个接口切换到另一个接口（或者甚至在两者上传输）（静态路由规则不适用于此应用程序）。

我在 StackOverflow 中发现了一个相关问题，该问题建议使用 netlink 库即时修改路由。这从直觉上看起来应该可以工作，但我想知道是否还有其他选择可以实现同样的结果。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-06T04:23:40.930

无意冒犯，但关于使用 bind() 的答案是完全错误的。bind() 将控制放置在数据包 IP 标头中的源 IP 地址。它不控制将使用哪个接口发送数据包：将查询内核的路由表以确定哪个接口具有最低的到达特定目的地的成本。（*见说明）

相反，您应该使用`SO_BINDTODEVICE`sockopt。这做了两件事：

*   无论内核路由表说什么，数据包总是从您指定的接口传出。
*   只有到达指定接口的数据包才会被交给套接字。到达其他接口的数据包不会。

如果您要在多个接口之间切换，我建议每个接口创建一个套接字。因为您也只会接收到您绑定的接口的数据包，所以您需要将所有这些套接字添加到您的`select()`//`poll()`无论您使用什么。

```
#include <net/if.h>

struct ifreq ifr;

memset(&ifr, 0, sizeof(ifr));
strncpy(ifr.ifr_name, "eth1", sizeof(ifr.ifr_name));
if (setsockopt(s, SOL_SOCKET, SO_BINDTODEVICE,
            (void *)&ifr, sizeof(ifr)) < 0) {
    perror("SO_BINDTODEVICE failed");
} 
```

（*注） `Bind()`到接口 IP 地址可能会导致混乱但仍然正确的行为。例如，如果你`bind()`的 IP 地址为 eth1，但路由表将数据包发送到 eth0，那么 eth0 线路上会出现一个数据包，但带有 eth1 接口的源 IP 地址。这很奇怪，但允许，尽管发送回 eth1 IP 地址的数据包将被路由回 eth1。您可以使用具有两个 iP 接口的 Linux 系统对此进行测试。我有一个，并且确实对其进行了测试，并且`bind()`无法有效地将数据包引导出物理接口。

尽管在技术上是允许的，但根据拓扑结构，这可能仍然不起作用。为了抑制攻击者使用伪造 IP 源地址的分布式拒绝服务攻击，许多路由器现在执行反向路径转发 (RPF) 检查。源 IP 地址位于“错误”路径的数据包可能会被丢弃。

# xml - 使用多行记录解析 XML

> ID：172906
> 
> 赞同：1
> 
> 时间：2008-10-06T00:28:37.300
> 
> 标签：xml, grails, groovy

我想采用以下格式的 XML，并将每个代码记录加载到我的`BootStrap.groovy`. 我想保留每个代码片段的格式。

## XML

```
<records>
    <code>
        <language>Groovy</language>
        <snippet>
            println "This is Groovy"
            println "A very powerful language"
        </snippet>
    </code>
    <code>
        <language>Groovy</language>
        <snippet>
            3.times {
                println "hello"
            }
        </snippet>
    </code>
    <code>
        <language>Perl</language>
        <snippet>
            @foo = split(",");
        </snippet>
    </code>
</records> 
```

## 域对象

```
Code {
    String language
    String snippet
} 
```

## BootStrap.groovy

```
new Code(language l, snippet: x).save() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T01:28:12.890

大致是这样的：

```
def CODE_XML = '''
<records>
    <code>
        <language>Groovy</language>
        <snippet>
            println "This is Groovy"
            println "A very powerful language"
        </snippet>
    </code>
    <code>
        <language>Groovy</language>
        <snippet>
            3.times {
                println "hello"
            }
        </snippet>
    </code>
    <code>
        <language>Perl</language>
        <snippet>
            @foo = split(",");
        </snippet>
    </code>
</records>
  '''
def records = new XmlParser().parseText(CODE_XML)
records.code.each() { code ->
    new Code(language: code.language, snippet: code.snippet).save()
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T01:36:31.877

如果您可以指定 DTD 或类似内容并且您的 XML 解析器遵循它，我认为您可以将片段元素的内容指定为 CDATA 并始终按原样获取它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T21:35:48.260

尝试向元素添加`xml:space="preserve"`属性。`<snippet>`

# .net - 从 Excel 调用 .NET COM Web 服务包装器

> ID：172908
> 
> 赞同：1
> 
> 时间：2008-10-06T00:31:35.203
> 
> 标签：.net, web-services, excel, com

我正在尝试从 Excel 2003 模块调用 Web 服务。我实现它的方式是创建一个 .NET COM 库，其中包含我需要公开的所有类/方法。当我尝试调用从 Excel 查询 Web 服务的方法时，执行只是在该行停止，没有任何错误。可能与参考有关吗？我正在使用 Microsoft.Web.Services2.dll。我试过把它放在 C:\WINDOWS\SYSTEM32 - 不走运

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T18:13:17.760

我不确定我是否了解全部情况，但希望其中一些会有所帮助。我认为您有 Excel vba 通过 COM 接口调用 .NET，然后调用 SOAP Web svc。

您应该已安装正确的[PIA](http://msdn.microsoft.com/en-us/library/aa159923(office.11).aspx)，并由您的 .NET 程序集引用。您的 COM 接口应如下所示：

```
 [Guid("123Fooetc...")]
    [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    public interface IBar
    {
        [DispId(1)]
         void SomeMethod(Excel.Range someRange);
    } 
```

使用类似这样的类实现接口：

```
 [Guid("345Fooetc..")]
    [ClassInterface(ClassInterfaceType.None)]
    [ProgId("MyNameSpace.MyClass")]    
    public class MyClass : IBar
    {
        public void SomeMethod(Excel.Range someRange)
        {...}
    } 
```

我要做的第一件事是在您的 .NET 代码中用一个真正简单的方法替换您的 Web 服务调用，以确保您的接口和互操作包装器工作正常。

一旦您的骨架工作正常，您可能需要考虑使用 HTTP 方法而不是使用 SOAP 来调用您的服务。例如，这是一个使用 HTTP GET 的简单调用：

```
 string resource = yourUrl;
  using (WebClient web = new WebClient())
  {
    web.Credentials = CredentialCache.DefaultCredentials;
    someXml = web.DownloadString(resource);
  }
  return someXml; // or do something interesting with Excel range 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T05:43:57.913

为了解决这个问题，我使用了 Access 而不是 Excel。在 Access 中，它向我显示错误。原来，所有引用程序集的位置都应该是调用者应用程序的位置（在本例中是 C:\Program Files\Microsoft Office\OFFICE11）。其次，我的 Web 服务代理正在从 .config 文件加载端点 URL，在该上下文中是 C:\Program Files\Microsoft Office\OFFICE11\MSACCESS.EXE.config

# xna - 从另一台计算机运行 XNA 代码时出错

> ID：172916
> 
> 赞同：-1
> 
> 时间：2008-10-06T00:39:26.657
> 
> 标签：xna, invalidoperationexception

我已经在计算机 1 上开发了一个 XNA 游戏。当我将它发送到计算机 2 时（并且我拥有能够运行 XNA 代码的一切）。当程序执行 game.run 时，我得到一个 InvalidOperationException。

我没有尝试在计算机一上运行计算机二的代码。但我知道两台机器都可以运行我在它们上面编写的代码。

你有什么主意吗 ？

编辑：哦，我添加了答案，但我无法选择我的帖子作为答案......

* * *

调用堆栈：

> App.exe!App.Program.Main(string[] args = {Dimensions:[0]}) 第 14 行 C#

这是代码

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    static void Main(string[] args)
    {
        using (Game1 game = new Game1())
        {
            game.Run();
        }
    }
} 
```

并且相同的代码在另一台机器上运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T13:12:34.683

我终于找到了问题所在。出于某种原因，硬件加速设置被设置为无。所以项目不会启动。

感谢您的所有回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T00:48:53.080

文档说如果 Game.Run 被多次调用，Game.Run 将抛出该异常。例外的其余部分说明了什么？即消息、StackTrace 等？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T01:00:59.997

我的第一个问题是，其余的错误是什么？没有它就很难诊断。如果我要给出一个有根据的猜测，我不得不说您要么没有安装正确的 XNA 运行时，要么您的视频卡不支持 Shader Model 2.0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T13:11:09.023

是否有任何 .dll 文件需要与其他计算机可能丢失的项目一起打包？[Dependency Walker](http://www.dependencywalker.com/)可能有助于确定这些是哪些（如果有）。

# html - Div 100% 高度适用于 Firefox，但不适用于 IE

> ID：172918
> 
> 赞同：46
> 
> 时间：2008-10-06T00:40:13.347
> 
> 标签：html, css, internet-explorer, firefox

我有一个包含两个内部 div 的容器 div；两者都应在容器内占用 100% 的宽度和 100% 的高度。

我将两个内部 div 设置为 100% 高度。这在 Firefox 中运行良好，但在 IE 中，div 不会拉伸到 100% 高度，而只会拉伸到其中文本的高度。

以下是我的样式表的简化版本。

```
#container
{
   height: auto;
   width: 100%;
}

#container #mainContentsWrapper
{
   float: left;

   height: 100%;
   width: 70%;
   margin: 0;
   padding: 0;
}

#container #sidebarWrapper
{      
   float: right;

   height: 100%;
   width: 29.7%;
   margin: 0;
   padding: 0;
} 
```

有什么我做错了吗？或者我错过的任何 Firefox/IE 怪癖？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-06T22:26:53.287

我认为“在 Firefox 中运行良好”仅在**Quirks 模式下**呈现。在**标准模式**渲染中，这在 Firefox 中也可能无法正常工作。

百分比取决于“包含块”，而不是视口。

[CSS 规范说](http://www.w3.org/TR/CSS21/visudet.html#the-height-property)

> 该百分比是相对于生成框的包含块的高度计算的。如果包含块的高度没有明确指定（即，它取决于内容高度），并且该元素不是绝对定位的，则该值计算为'auto'。

所以

```
#container { height: auto; }
#container #mainContentsWrapper { height: n%; }
#container #sidebarWrapper { height: n%; } 
```

方法

```
#container { height: auto; }
#container #mainContentsWrapper { height: auto; }
#container #sidebarWrapper { height: auto; } 
```

要拉伸到视口的 100% 高度，您需要指定包含块的高度（在本例中为 #container）。此外，您还需要指定 body 和 html 的高度，因为初始 Containing Block 是“UA-dependent”。

所有你需要的是...

```
html, body { height:100%; }
#container { height:100%; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-06T01:36:30.363

如果没有看到您实际使用的 html，很难给您一个好的答案。

您是否正在输出 doctype / 使用标准模式渲染？在实际上无法查看 html repro 的情况下，这将是我对 firefox 和 Internet Explorer 之间的 html 解释差异的第一个猜测。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T01:46:21.467

我不确定您要解决什么问题，但是当我有两个需要相同高度的并排容器时，我在页面加载时运行了一些 javascript 来找到两者的最大高度并明确将另一个设置为相同的高度。在我看来， height: 100% 可能只是意味着“使其成为完全包含内容所需的大小”，而您真正想要的是“同时制作最大内容的大小”。

注意：如果页面上发生任何事情来改变它们的高度，你需要再次调整它们的大小——比如使验证摘要可见或打开可折叠的菜单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-06T14:51:22.677

当我将容器的边距设置为 0 时，我已经成功地让它工作：

```
#container
{
   margin: 0 px;
} 
```

除了你所有的其他风格

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T00:43:30.063

您可能必须放置以下一项或两项：

```
html { height:100%; } 
```

或者

```
body { height:100%; } 
```

编辑：哎呀，没有注意到它们被漂浮了。你只需要漂浮容器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T13:25:04.940

我做了一些与“tvanfosson”所说的非常相似的事情，也就是说，实际上使用 JavaScript 通过诸如 onresize 之类的事件不断监视窗口中的可用高度，并使用该信息相应地更改容器大小（以像素而不是百分比）。

请记住，这**确实**意味着 JavaScript 依赖，它不像 CSS 解决方案那样流畅。您还需要确保 JavaScript 函数能够在所有主要浏览器中*正确返回窗口尺寸。*

让我们知道前面提到的 CSS 解决方案之一是否有效，因为这听起来是解决问题的更好方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T13:10:34.267

我不认为 IE 支持使用 auto 来设置高度/宽度，所以你可以尝试给它一个数值（就像 Jarett 建议的那样）。

此外，您似乎没有正确清除浮动。尝试将此添加到您的#container 的 CSS 中：

```
#container {
    height:100%;
    width:100%;
    overflow:hidden;
    /* for IE */
    zoom:1;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-15T11:08:10.957

试试这个..

```
#container
{
   height: auto;
   min-height:100%;
   width: 100%;
}

#container #mainContentsWrapper
{
   float: left;

   height: auto;
   min-height:100%
   width: 70%;
   margin: 0;
   padding: 0;
}

#container #sidebarWrapper
{      
   float: right;

   height: auto;
   min-height:100%
   width: 29.7%;
   margin: 0;
   padding: 0;
} 
```

# c - Haskell FFI / C MPFR 库包装问题

> ID：172921
> 
> 赞同：4
> 
> 时间：2008-10-06T00:41:17.713
> 
> 标签：c, haskell, floating-point, ffi, mpfr

为了创建任意精度的浮点数/替换 Double，我尝试使用 FFI 包装[MPFR](http://www.mpfr.org/)，但尽管我付出了所有努力，但最简单的代码仍然不起作用。它编译，它运行，但在假装工作一段时间后它会模拟地崩溃。一个简单的 C 版本代码可以愉快地将数字“1”打印到（小数点后 640 位）总共 10,000 次。Haskell 版本，当被要求做同样的事情时，在“1.0000...0000”的 289 次打印输出和 385 次打印输出后默默地破坏（？）数据，它导致断言失败和炸弹。我不知道如何继续调试它，因为它“应该工作”。

该代码可以在[http://hpaste.org/10923阅读并在](http://hpaste.org/10923)[http://www.updike.org/mpfr-broken.tar.gz](http://www.updike.org/mpfr-broken.tar.gz)下载

我在 FreeBSD 6 上使用 GHC 6.83，在 Mac OS X 上使用 GHC 6.8.2。请注意，您需要为库和头文件（以及那些从 GMP) 来成功编译它。

## 问题

*   为什么 C 版本可以工作，而 Haskell 版本却失败了？接近 FFI 时我还缺少什么？我尝试了 StablePtrs 并得到了完全相同的结果。

*   其他人可以通过编译和运行我的代码来验证这是否只是 Mac/BSD 的问题吗？（C 代码“有效”吗？Haskell 代码“无效”有效吗？）Linux 和 Windows 上的任何人都可以尝试编译/运行并查看是否得到相同的结果吗？

C代码：（works.c）

```
#include <stdio.h>  
#include <stdlib.h>  
#include <string.h>  

#include <gmp.h>  
#include <mpfr.h>
#include "mpfr_ffi.c"  

int main()  
{  
  int i;  
  mpfr_ptr one;  

  mpf_set_default_prec_decimal(640);  

  one = mpf_set_signed_int(1);  
  for (i = 0; i < 10000; i++)
    {  
      printf("%d\n", i);
      mpf_show(one);
    }  
} 
```

Haskell 代码：（Main.hs --- 不起作用）

```
module Main where  

import Foreign.Ptr            ( Ptr, FunPtr )  
import Foreign.C.Types        ( CInt, CLong, CULong, CDouble )  
import Foreign.StablePtr      ( StablePtr )  

data MPFR = MPFR  

foreign import ccall "mpf_set_default_prec_decimal"  
    c_set_default_prec_decimal          :: CInt -> IO ()  
setPrecisionDecimal                     :: Integer -> IO ()  
setPrecisionDecimal decimal_digits = do  
    c_set_default_prec_decimal (fromInteger decimal_digits)  

foreign import ccall "mpf_show"  
   c_show                               :: Ptr MPFR -> IO ()  

foreign import ccall "mpf_set_signed_int"  
   c_set_signed_int                     :: CLong -> IO (Ptr MPFR)  

showNums k n = do  
   print n  
   c_show k  

main = do  
   setPrecisionDecimal 640  
   one <- c_set_signed_int (fromInteger 1)  
   mapM_ (showNums one) [1..10000] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T04:13:14.103

Judah Jacobsen 在 Haskell-cafe 邮件列表中回答了这个问题：

这是GHC 的[一个已知问题，](http://hackage.haskell.org/trac/ghc/ticket/311)因为 GHC 在内部使用 GMP（维护整数）的方式。

显然，除了使用 FFI 访问 GMP 的代码或任何依赖 GMP 的 C 库（例如我想使用的 MPFR）*之外*，GHC 基本上在所有情况下都将堆中的 C 数据单独保留。有一些解决方法（痛苦），但“正确”的方法是破解 GHC（困难）或让 Simons 消除 GHC 对 GMP 的依赖（更困难）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-06T05:07:54.397

我也看到了问题，在

```
$ uname -a
Linux burnup 2.6.26-gentoo-r1 #1 SMP PREEMPT Tue Sep 9 00:05:54 EDT 2008 i686 Intel(R) Pentium(R) 4 CPU 2.80GHz GenuineIntel GNU/Linux
$ gcc --version
gcc (GCC) 4.2.4 (Gentoo 4.2.4 p1.0)
$ ghc --version
The Glorious Glasgow Haskell Compilation System, version 6.8.3 
```

我还看到输出从 1.0000...000 变为 1.0000...[垃圾]。

让我们看看，以下确实有效：

```
main = do
    setPrecisionDecimal 640
    mapM_ (const $ c_set_signed_int (fromInteger 1) >>= c_show) [1..10000] 
```

这将问题缩小到`one`在运行时以某种方式被破坏的部分。但是，查看 and 的输出`ghc -C`并`ghc -S`没有给我任何提示。

嗯，`./noworks +RTS -H1G`也有效，并且`./noworks +RTS -k[n]k`，对于不同的值`[n]`，以不同的方式展示失败。

我没有可靠的线索，但我想到了两种可能性：

*   GHC 运行时使用的 GMP 和 MPFR 有一些奇怪的交互
*   在 GHC 运行时中调用的 C 函数的堆栈空间是有限的，并且 MPFR 处理不好

话虽这么说...您是否有理由滚动自己的绑定而不是使用[HMPFR](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hmpfr)？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T18:10:49.530

HMPFR 的维护者 Aleš Bizjak[发布](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hmpfr)到 haskell-cafe 并展示了如何阻止 GHC 控制肢体的分配（因此不理会它们，而不是 GC 并破坏它们）：

```
mpfr_ptr mpf_new_mpfr()  
{  
  mpfr_ptr result = malloc(sizeof(__mpfr_struct));  
  if (result == NULL) return NULL;  
  /// these three lines:  
  mp_limb_t * limb = malloc(mpfr_custom_get_size(mpfr_get_default_prec()));  
  mpfr_custom_init(limb, mpfr_get_default_prec());  
  mpfr_custom_init_set(result, MPFR_NAN_KIND, 0, mpfr_get_default_prec(), limb);  
  return result;  
} 
```

对我来说，这比在 GHC 中编写 GMP 替代品要容易得多，如果我真的想使用任何依赖 GMP 的库，这将是唯一的选择。

# database - 数据库如何在内部工作？

> ID：172925
> 
> 赞同：80
> 
> 时间：2008-10-06T00:47:22.053
> 
> 标签：database, reference, internals

在过去的几年里，我一直在使用数据库，我想我已经相当有能力使用它们了。然而，我最近阅读了乔尔的[泄漏抽象定律，](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)我意识到即使我可以编写一个查询来从数据库中获取几乎任何我想要的东西，但我不知道数据库实际上是如何解释查询的。有谁知道任何解释数据库内部工作原理的好文章或书籍？

我感兴趣的一些具体事情是：

*   数据库实际上做了什么来找出与 select 语句匹配的内容？
*   数据库如何将连接解释为具有多个“其中 key1 = key2”语句的查询？
*   数据库如何存储其所有内存？
*   索引是如何存储的？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-10-06T01:40:23.973

> 数据库实际上做了什么来找出与 select 语句匹配的内容？

坦率地说，这是一个蛮力的问题。简单地说，它会读取数据库中的每个候选记录并将表达式与字段匹配。所以，如果你有“select * from table where name = 'fred'”，它实际上会遍历每条记录，获取“name”字段，并将其与“fred”进行比较。

现在，如果“table.name”字段被索引，那么数据库将（可能但不一定）首先使用索引来定位候选记录以应用实际过滤器。

这减少了将表达式应用到的候选记录的数量，否则它只会执行我们所说的“表扫描”，即读取每一行。

但从根本上说，它定位候选记录的方式与应用实际过滤器表达式的方式是分开的，显然，可以进行一些巧妙的优化。

> 数据库如何将连接解释为具有多个“其中 key1 = key2”语句的查询？

好吧，连接用于创建一个新的“伪表”，在其上应用过滤器。因此，您有过滤条件和连接条件。连接条件用于构建此“伪表”，然后对其应用过滤器。现在，在解释连接时，这又是与过滤器相同的问题——蛮力比较和索引读取以构建“伪表”的子集。

> 数据库如何存储其所有内存？

良好数据库的关键之一是它如何管理其 I/O 缓冲区。但它基本上将 RAM 块与磁盘块匹配。使用现代虚拟内存管理器，更简单的数据库几乎可以依赖 VM 作为其内存缓冲区管理器。高端 DB'S 自己做这一切。

> 索引是如何存储的？

B+Trees 通常，你应该查一下。这是一种已经存在多年的直接技术。它的好处与大多数平衡树共享：对节点的一致访问，加上所有叶节点都是链接的，因此您可以轻松地按键顺序从一个节点遍历到另一个节点。因此，使用索引，可以将行视为针对数据库中的特定字段“排序”，并且数据库可以利用该信息来优化它。这与使用哈希表作为索引不同，后者只能让您快速获取特定记录。在 B-Tree 中，您不仅可以快速获取特定记录，还可以快速获取排序列表中的某个点。

在数据库中存储和索引行的实际机制非常简单易懂。游戏正在管理缓冲区，并将 SQL 转换为有效的查询路径，以利用这些基本的存储习惯。

然后，在存储惯用语之上还有整个多用户、锁定、日志记录和事务复杂性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T00:53:26.860

*   数据库实际上做了什么来找出与 select 语句匹配的内容？

    数据库正在使用索引（见下文）

*   数据库如何将连接解释为具有多个“其中 key1 = key2”语句的查询？连接操作可以通过合并树转换为二叉树操作。

*   数据库如何存储其所有内存？

    **内存映射文件**以更快地访问其数据

*   索引是如何存储的？

    内部数据库正在使用**B 树**进行索引。

这应该在维基百科上更详细地解释..

[http://en.wikipedia.org/wiki/B-tree](http://en.wikipedia.org/wiki/B-tree)

[http://en.wikipedia.org/wiki/Database](http://en.wikipedia.org/wiki/Database)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T02:17:23.977

除了阅读之外，使用 DB 工具检查数据库在查询中使用的执行计划也很有指导意义。除了深入了解它的工作原理之外，您还可以尝试使用更好的反馈循环来优化查询的技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T01:23:25.460

赛义夫，很好的链接。涵盖大多数主题的鸟瞰概览，并提供有关特定供应商实施的详细信息。

我尝试写了三次解释，但这确实是一个太大的话题。查看 Hellerstein 文章（Saif 链接到的伯克利服务器上的文章），然后询问具体情况。

值得注意的是，在任何给定的 DBMS 中都只实现了“已知的好想法”的一个子集。例如，SQLite 甚至不做散列连接，它只做嵌套循环（ack!!）。但是，它是一个易于嵌入的 dbms，并且它的工作非常好，所以对于缺乏复杂性有一些话要说。

了解 DBMS 如何收集统计信息以及它如何使用它们来构建查询计划，以及首先学习如何阅读查询计划，是一项非常宝贵的技能——如果您必须选择一个“数据库内部”主题来学习，学习这个。它将带来不同的世界（并且您将永远不会再次意外地编写笛卡尔积...... ;-)）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-06T02:26:59.870

如果您想了解更多详细信息，我建议您获取 sqlite 资源并查看它是如何做到的。它是完整的，尽管没有更大的开源和商业数据库的规模。如果你想更详细地了解，我推荐[SQLite 权威指南，](http://www.apress.com/book/view/1590596730)它不仅是对 sqlite 的一个很好的解释，也是我所知道的最易读的技术书籍之一。在 MySQL 方面，您可以从[MySQL 性能博客](http://www.mysqlperformanceblog.com/)以及书籍前面的 O'Reilly[高性能 MySQL](https://rads.stackoverflow.com/amzn/click/com/0596101716) (V2) 中学习，该博客是其作者之一。

# c++ - WIN32 上“iPhone”风格动画的最佳 2D 动画库/技术？

> ID：172928
> 
> 赞同：2
> 
> 时间：2008-10-06T00:49:07.650
> 
> 标签：c++, animation, 2d, sdl, allegro

全部，

我已经构建了一个漂亮的演示应用程序，它将有关我们内部系统的数据显示为全屏“广告牌”样式显示。你可以把它想象成一个显示国家赤字的应用程序——快速增加的数字，动画非常快，整天。

问题是演示效果很好，客户希望我构建一个工业级的版本！

我想在 C++ 中执行此操作，但它可能是 Java 或*C* #（尽管我不想使用 C#，因为我在那个环境中并不那么强大）。

我在玩 SDL 或 Allegro，但我都没有这方面的经验，所以我愿意接受最好的（最好是最简单的）工具包。

当我说“iPhone”风格时，我指的是面板之间简单而优雅的过渡。iPhone 出色地使用了幻灯片、淡入淡出和混合。我的应用不需要做任何 3D 风格的动画。在图形方面，我真的只需要简单的东西：90% 的文本、一些图像和简单的图元，如线条、矩形和渐变填充。

当然，我可以在“普通的”DirectDraw 或 OpenGL 中实现这一点，但我真的不想考虑编写计时器类和为动画选择计时方法——那里的一些工具包应该正好适合这个。

谢谢你的帮助！

射频

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-01T00:20:44.800

我认为您正在寻找杂乱工具包。它是免费的、酷炫的、多平台的。通过实现所有那些你自己无法实现的计时器和东西，在 OpenGL 之上工作，并将它们包装在一个非常方便和很棒的 AP​​I 上。

[http://clutter-project.org/](http://clutter-project.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T22:13:36.980

Windows Presentation Foundation（或 WPF）是阅读您的问题时首先想到的。据我所见，这是微软对苹果所有产品都在使用的流畅 UI 的回应。一切都经过 DirectX 加速，可实现非常流畅的过渡和动画。

据我所知，只有 .Net 语言支持 WPF（重点强调 C#），所以这对您来说可能是不利的。如果你发现它不适合你的需求，那么我也推荐 QT 作为一个非常好的 C++ 框架。请务必先检查许可，以确保它满足您的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-06T02:25:03.587

[Qt](http://trolltech.com/products/)支持 SVG 和易于使用的动画。（除了是一个伟大的全能跨平台 GUI 框架）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T23:49:28.623

我会给[处理](http://processing.org/)一个旋转。“易于维护”可以克服 C++ 的要求。我认识许多喜欢修补它的设计师。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T23:42:37.827

SDL 是一个很好的工具包。如果您已经了解“普通旧 DirectDraw 或 OpenGL”的原理，那么您对 ​​SDL 应该没有任何问题。我还没有见过所有的图形框架，但在我见过的那些中，我肯定会推荐 SDL。它是由经验丰富的游戏程序员设计的，他们知道自己在做什么，因为他们去过那里并做过，而且它的界面非常直观。与 WPF 不同的是，它是从一开始就为跨平台兼容性而设计的。

# asp.net - 显示带有嵌套 ListViews 的 IGrouping<>

> ID：172934
> 
> 赞同：10
> 
> 时间：2008-10-06T00:54:22.897
> 
> 标签：asp.net, linq, listview

我需要从我的数据访问层检索一组按 widget.Manufacturer 分组的小部件，以显示在一组嵌套的 ASP.NET ListView 中。

问题是（据我所知）嵌套的 ListView 方法需要我在使用数据之前对其进行整形，而我无法找出最好的方法。到目前为止，我能想到的最好的方法是在我的数据访问层中放置一个 LINQ 查询，如下所示：

```
var result = from widget in GetAllWidgets(int widgetTypeID)
             group widget by widget.Manufacturer into groupedWidgets
             let widgets = from widgetGroup in groupedWidgets
                           select widgetGroup
             select new { Manufacturer = groupedWidgets.Key, Widgets = widgets }; 
```

当然，匿名类型不能被传递，所以这是行不通的。定义一个自定义类来包含数据似乎是错误的方法。有什么方法可以在 ASP.NET 方面执行分组吗？我正在使用 ObjectDataSources 来访问 DAL。

**更新**：好的，我不再创建匿名类型，而是我的 DAL 将一个传递`IEnumerable<IGrouping<Manufacturer, Widget>>`给 ASP.NET 页面，但是如何在我的 ListViews 中使用它？我需要呈现以下 HTML（或类似的东西）

```
<ul>
  <li>Foo Corp.
    <ol>
      <li>Baz</li>
      <li>Quux</li>
    </ol>
  </li>
  <li>Bar Corp.
    <ol>
      <li>Thinger</li>
      <li>Whatsit</li>
    </ol>
  </li>
</ul> 
```

最初，我在 ListView 中有一个 ListView，如下所示：

```
<asp:ListView ID="ManufacturerListView">
    <LayoutTemplate>
        <ul>
            <asp:Placeholder ID="itemPlaceholder" runat="server" />
        </ul>
    </LayoutTemplate>
    <ItemTemplate>
        <li><asp:Label Text='<%# Eval("Manufacturer.Name") %>' />
        <li>
        <asp:ListView ID="WidgetsListView" runat="server" DataSource='<%# Eval("Widgets") %>'>
            <LayoutTemplate>
                <ol>
                    <asp:PlaceHolder runat="server" ID="itemPlaceholder" />
            </ol>
           </LayoutTemplate>
           <ItemTemplate>
               <li><asp:Label Text='<%# Eval("Name") %>'></li>
           </ItemTemplate>
        </asp:ListView>
        </li>
    </ItemTemplate>
</asp:ListView> 
```

请注意`DataSource`WidgetsListView 的属性本身是如何数据绑定的。如何在不重塑数据的情况下复制此功能？

这有点复杂，对不起，如果我应该提出一个单独的问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-07T05:03:09.633

好吧，我要反驳我之前的说法。由于 eval 想要嵌套控件中的某种属性名称，我们可能应该对这些数据进行整形。

```
public class CustomGroup<TKey, TValue>
{
  public TKey Key {get;set;}
  public IEnumerable<TValue> Values {get;set;}
} 
```

// 并因此使用它...

```
IEnumerable<CustomGroup<Manufacturer, Widget>> result =
  GetAllWidgets(widgetTypeId)
  .GroupBy(w => w.Manufacturer)
  .Select(g => new CustomGroup<Manufacturer, Widget>(){Key = g.Key, Values = g}; 
```

/// 甚至更晚...

```
<asp:ListView ID="ManufacturerListView">
<LayoutTemplate>
    <ul>
        <asp:Placeholder ID="itemPlaceholder" runat="server" />
    </ul>
</LayoutTemplate>
<ItemTemplate>
    <li><asp:Label Text='<%# Eval("Key.Name") %>' />
    <li>
    <asp:ListView ID="WidgetsListView" runat="server" DataSource='<%# Eval("Values") %>'>
        <LayoutTemplate>
            <ol>
                <asp:PlaceHolder runat="server" ID="itemPlaceholder" />
            </ol>
       </LayoutTemplate>
       <ItemTemplate>
           <li><asp:Label Text='<%# Eval("Name") %>'></li>
       </ItemTemplate>
    </asp:ListView>
    </li>
</ItemTemplate>
</asp:ListView> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-20T08:35:55.353

我刚刚在这上面花了很长时间。最终找到了解决方案，它是如此简单。

* * *

```
var enumerableData = myData.Tables[0].AsEnumerable();
var groupedData = enumerableData.GroupBy(x => x["GroupingColumn"]);

myParentRepeater.DataSource = groupedData;
myParentRepeater.DataBind(); 
```

* * *

```
<asp:Repeater ID="myParentRepeater" runat="server">
  <ItemTemplate>
    <h3><%#Eval("Key") %></h3>
    <asp:Repeater ID="myChildRepeater" runat="server" DataSource='<%# Container.DataItem %>'>
      <ItemTemplate>
        <%#((DataRow)Container.DataItem)["ChildDataColumn1"] %>
        <%#((DataRow)Container.DataItem)["ChildDataColumn2"] %>
      </ItemTemplate>
      <SeparatorTemplate>
        <br />
      </SeparatorTemplate>
    </asp:Repeater>
  </ItemTemplate>
</asp:Repeater> 
```

* * *

Eval("Key") 返回分组值。检索子信息时，Container.DataItem 的类型为 IGrouping，但您只需将其转换为正确的类型。

希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T04:11:04.530

当您使用 Linq 进行分组时，您可以获得一个没有该整形的强类型对象：

```
List<int> myInts = new List<int>() { 1, 2, 3, 4, 5 };
IEnumerable<IGrouping<int, int>> myGroups = myInts.GroupBy(i => i % 2);
foreach (IGrouping<int, int> g in myGroups)
{
  Console.WriteLine(g.Key);
  foreach (int i in g)
  {
    Console.WriteLine("  {0}", i);
  }
}
Console.ReadLine(); 
```

在您的情况下，您将拥有：

```
 IEnumerable<IGrouping<Manufacturer, Widget>> result =
    GetAllWidgets(widgetTypeId).GroupBy(w => w.Manufacturer); 
```

这将允许您从方法返回结果。

# lisp - 执行存储为列表的代码

> ID：172935
> 
> 赞同：8
> 
> 时间：2008-10-06T00:55:00.663
> 
> 标签：lisp, common-lisp

在理解（引用）之后，我很好奇如何导致语句执行。我的第一个想法是

```
(defvar x '(+ 2 21))
`(,@x) 
```

但这只是评估为`(+ 2 21)`或 的内容`x`。如何运行放在列表中的代码？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-06T00:58:07.367

`(eval '(+ 2 21))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T20:07:12.710

@克里斯蒂安·罗莫：

反引号示例：您可以使用 eval 和反引号来实现应用，因为您可以将参数拼接到表单中。不会是世界上最有效的事情，但是：

```
(eval `(and ,@(loop for x from 1 upto 4 collect `(evenp ,x)))) 
```

相当于

```
(eval '(and (evenp 1) (evenp 2) (evenp 3) (evenp 4))) 
```

顺便说一句，这与（更有效）具有相同的结果

```
(every 'evenp '(1 2 3 4)) 
```

希望能满足你的好奇心！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T12:29:25.300

[在http://lisperati.com/](http://lisperati.com/)上查看有趣的 Lisp 教程。有 Common Lisp 和 Emacs Lisp 的版本，它演示了 quasiquote 和宏的使用。

# com - ISupportErrorInfo 的实现 - 这是什么意思？

> ID：172942
> 
> 赞同：14
> 
> 时间：2008-10-06T01:04:01.567
> 
> 标签：com, error-handling

`ISupportErrorInfo`界面是什么意思？我有点不知所措。来自 MSDN：

> 此接口确保错误信息可以正确地沿调用链向上传播。使用错误处理接口的自动化对象必须实现 ISupportErrorInfo。
> 
> 此方法指示接口是否支持 IErrorInfo 接口。

```
HRESULT InterfaceSupportsErrorInfo(
  REFIID riid
); 
```

在中返回 S_OK 是什么意思`InterfaceSupportsErrorInfo`？您应该为所有接口返回 S_OK 吗？一些？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-06T04:40:21.053

我对它的理解（基于一些相关的 MSDN 页面）是，通过实现`ISupportErrorInfo`，您表明您的类上的一个或多个接口通过调用返回错误信息`SetErrorInfo`，而不是仅仅返回失败`HRESULT`。

为此，您的实现`ISuportErrorInfo::InterfaceSupportsErrorInfo`应该`S_OK`只返回类上实际用于`SetErrorInfo`向调用者返回错误信息的那些接口，并且**只**返回那些接口。

例如，假设您有一个实现您编写的接口的类，该接口`IFoo`具有一个`DoSomething`方法。如果其他人创建了您的类的实例并调用，如果返回失败`IFoo::DoSomething`，他们应该执行以下操作（从各种 MSDN 页面解释，但我从这里开始：http: [//msdn.microsoft.com/en-us/库/ms221510.aspx](http://msdn.microsoft.com/en-us/library/ms221510.aspx)）：`DoSomething``HRESULT`

*   调用指针以获取`QueryInterface`正在实现的对象的接口`IFoo``ISupportErrorInfo``IFoo`

*   如果被调用的对象没有实现`ISupportErrorInfo`，那么调用者将不得不根据 `HRESULT`值来处理错误，或者将它传递到调用堆栈。

*   如果被调用的对象确实实现`ISupportErrorInfo`了，那么调用者应该调用`ISupportErrorInfo::InterfaceSupportsErrorInfo`，并传入一个`REFIID`返回错误的接口。在这种情况下，接口的`DoSomething`方法`IFoo`返回了一个错误，因此您将`REFIID_IFoo`（假设它已定义）传递给`InterfaceSupportsErrorInfo`.

*   如果`InterfaceSupportsErrorInfo` 返回`S_OK`，那么调用者此时知道它可以通过调用来检索有关错误的更详细信息 `GetErrorInfo`。如果`InterfaceSupportsErrorInfo`返回`S_FALSE`，调用者可以假设被调用的接口没有提供详细的错误信息，并且必须依赖返回的 HRESULT 来确定发生了什么。

这个有点令人困惑/令人费解的错误处理 API 的原因似乎是为了灵活性（据我所知，无论如何。这毕竟*是COM ;）。*通过这种设计，一个类可以支持多个接口，但并不是每个接口都必须用于`SetErrorInfo`从其方法返回错误信息。你可以让你的类上的某些，select 接口通过 来返回详细的错误信息`SetErrorInfo`，而其他接口可以继续使用 normal `HRESULT`s 来指示错误。

总之，`ISupportErrorInfo`接口是一种通知调用代码你的类实现的接口中的至少一个可以返回详细错误信息的方法，并且该`InterfaceSupportsErrorInfo`方法告诉调用者给定接口是否是这些接口之一。如果是这样，那么调用者可以通过调用来检索详细的错误信息`GetErrorInfo`。

# visual-c++ - 在 Microsoft Visual Studio 2005 中，是否可以在打开编辑窗口时设置其大小？

> ID：172944
> 
> 赞同：0
> 
> 时间：2008-10-06T01:06:07.820
> 
> 标签：visual-c++

我有一个非常大的显示器。当我在 MSVC 中打开一个文本文件时，该文件的默认宽度约为我屏幕空间的 80%。对于大多数代码位，大约是我需要的大小的两倍。有没有办法设置新打开文件的默认大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T01:22:34.307

在常规的窗格 UI 中，您可以选择水平或垂直拆分代码窗口，试试看。然后你会得到两个代码窗口，每个窗口都有自己的标签栏。

# php - PHP 库：SVN 访问

> ID：172945
> 
> 赞同：2
> 
> 时间：2008-10-06T01:06:37.600
> 
> 标签：php, svn

是否有任何体面的 PHP 库可用于访问 SVN 存储库？现在我只有一些脚本执行命令行命令并解析反馈，我很想找到一些不那么依赖命令行并且更紧密集成的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T01:11:04.983

快速谷歌搜索；

[http://au2.php.net/svn](http://au2.php.net/svn)
[http://php-svn-client.tigris.org](http://php-svn-client.tigris.org)
[http://pecl.php.net/package/svn](http://pecl.php.net/package/svn)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T01:40:44.083

我认为你现在的样子很好。WebSvn，来自 websvn.tigris.org，Subversion 人自己，也是这样做的。我还使用命令行并解析我的应用程序 BugTracker.NET 中的响应。

# winforms - 创建一个允许拖放自定义“小部件”的 winforms 应用程序

> ID：172946
> 
> 赞同：2
> 
> 时间：2008-10-06T01:07:10.483
> 
> 标签：winforms

我想创建一个 winforms 应用程序，这个应用程序将类似于 vs.net winforms 设计器（在某些方面）。

基本上它将是一个空白页面，用户可以在其中将一堆“小部件”拖放到屏幕上。小部件基本上是我将创建的自定义图像，用户可以调整大小，默认情况下它上面有一些文本，用户可以双击它来更改文本。

这在winforms中可行吗？如果是，我必须学习的关键方面是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-06T01:29:53.560

这在 WinForms 中很容易做到。查看[基本的拖放](http://codebetter.com/blogs/peter.van.ooijen/archive/2007/07/07/basic-drag-and-drop-in-winforms.aspx)。它的目标是 2.0。您将使用 DoDragDrop() 方法并在拖放事件中捕获数据。它需要一些冗长，但它可以完成工作。

如果您热衷于使用 WPF，请查看[MSDN 的主题](http://msdn.microsoft.com/en-us/library/ms742859.aspx)。

# oracle - Oracle 光标问题

> ID：172948
> 
> 赞同：1
> 
> 时间：2008-10-06T01:10:51.723
> 
> 标签：oracle

任何人都知道如何执行以下操作？

声明游标打开游标获取游标<<开始在循环中读取游标>>假设游标有10条记录。阅读到第 5 条记录，然后转到第 6 条记录并进行一些检查。

现在，是否有可能从第 6 条记录回到第 5 条记录？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-06T02:16:39.767

取决于要求。

您可以使用 LAG() 和 LEAD() 分析函数来获取下一行和前一行的信息，即

```
SQL> ed
Wrote file afiedt.buf

  1  select ename,
  2         sal,
  3         lead(sal) over (order by ename) next_sal,
  4         lag(sal) over (order by ename) prior_sal
  5    from emp
  6*  order by ename
SQL> /

ENAME             SAL   NEXT_SAL  PRIOR_SAL
---------- ---------- ---------- ----------
ADAMS            1100       1600
ALLEN            1600       2850       1100
BLAKE            2850       2450       1600
CLARK            2450       3000       2850
FORD             3000        950       2450
JAMES             950       2975       3000
JONES            2975       5000        950
KING             5000       1250       2975
MARTIN           1250       1300       5000
MILLER           1300       3000       1250
SCOTT            3000        800       1300

ENAME             SAL   NEXT_SAL  PRIOR_SAL
---------- ---------- ---------- ----------
SMITH             800       1500       3000
TURNER           1500       1250        800
WARD             1250                  1500

14 rows selected. 
```

如果您不想使用分析函数，您可以使用 PL/SQL 集合，将数据 BULK COLLECT 到这些集合中（如果您的数据多于您想要存储在 PGA 中的数据，请使用 LIMIT 子句），然后继续前进向后浏览您的收藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T01:15:38.500

你需要回去多远？如果您只需要前瞻一行，则可以仅缓冲循环中的前一行（应用程序端）。

# hibernate - 向现有的 Hibernate 实体添加（外部）关系（标记）

> ID：172950
> 
> 赞同：0
> 
> 时间：2008-10-06T01:12:26.417
> 
> 标签：hibernate, database-design

我需要向现有的 Hibernate 实体添加新的多对多关系。我不想触及原始的 Hibernate 实体 bean 或其配置。我要添加的是“标记”功能，可以将其视为外部贡献，而不是实体数据本身的一部分。

我想要一个只有两列的简单连接表，即实体主键和标签 ID。

我可以在不引入包含单个标记映射的新（人工）实体类型的情况下使用 Hibernate 来管理此表吗？

还是我被误导了，实际上应该想要拥有这个“关系实体”，以便以后可以添加属性（例如时间戳）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T01:23:25.817

Hibernate 背后的想法是能够从给定的起点遍历 Java 对象树。如果您想定义从原始对象到标记对象的多对多关系，您仍然可以在标记对象上定义它，它将正确地允许您获取具有该标记的原始对象的列表。

缺点是您将无法查询原始对象的标签列表（这将需要一个注释来反转关系和一个返回标签对象集列表的访问器）。但是，您将能够检索标有给定标签的原始对象的列表。

下面是一个例子……假设要标记的对象是一个帖子。如果是这样，下面是向标签添加多对多关系的代码，以便您可以查找具有特定标签的帖子列表：

```
@ManyToMany
@JoinTable(
    name = "TAG-POST",
    joinColumns = {@JoinColumn(name = "TAG-ID")},
    inverseJoinColumns = {@JoinColumn(name = "POST-ID")}
)
private Set<Posts> posts = new HashSet<Post>(); 
```

通常，您还希望能够查找与帖子相关的所有标签，但您可以省略反向映射。如果您确实需要反向映射，则需要将类似这样的内容添加到您的 Post 对象中：

```
@ManyToMany(mappedBy = "tags")
private Set<Tag> tags = new HashSet<Tag>(); 
```

现在您还可以查找与帖子相关的标签。

重读您的帖子（并查看您的评论）后，我意识到您也有兴趣跳过创建标签实体。如果只有标签名称，您可以想象只使用您描述的表格，但您需要稍微转变一下心态。您真正描述的是 Post 与其标签条目之间的一对多关系。在这种情况下，您需要将帖子映射到一系列标签记录，这些记录有两列……一个 POST-ID 和一个 TAG-NAME。在不更改原始对象的情况下，您仍然可以在表中查询具有特定 TAG-NAME 的 Posts 列表或与特定 Post 相关的 TAG-NAME 行列表。

请注意，这实际上并没有消除实体......您不会拥有 Tag 实体，但必须将多对多查找表创建为多对一关系，这使其成为实体本身。然而，这种方法确实少用了一张桌子。

# c# - 散列敏感数据

> ID：172951
> 
> 赞同：0
> 
> 时间：2008-10-06T01:13:20.363
> 
> 标签：c#, encryption, hash

我需要打乱我们拥有的 UAT 数据库中所有用户的名称和登录名。（由于数据保护法）

但是，有一个问题。

测试人员仍然需要能够使用散列登录名登录

因此，如果用户登录名是“Jesse.J.James”，那么哈希应该类似于

Ypois.X.Qasdf

即大致相同的长度，点在同一个地方

因此 MD5、sha1 等将不适合，因为它们会创建非常长的字符串，并且还会添加自己的特殊字符，例如 + 和 =，验证正则表达式不允许使用这些字符。

所以我正在寻找一些关于如何实现这一目标的建议

我想我需要推出自己的哈希算法

有人做过类似的事情吗？

我正在使用 c# 但我想这对算法并不那么重要

多谢

**添加 -**

感谢所有的答案。我认为我有责任在不需要做的时候使用“哈希”这个词来造成混乱

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-06T01:20:00.333

测试人员不应以合法用户身份登录。这显然违反了您正在从事的任何数据保护法案的不可否认性要求。

系统不应允许任何人使用散列值登录。这违背了散列的全部目的！

很抱歉，我没有回答您的具体问题，但我真的认为应该重新评估您的整个测试系统。

**添加：**

JPLemme 下面的评论清楚地说明了你在做什么，恐怕我完全误解了（大概就像那些投票给我的人一样）。

部分混淆是基于这样一个事实，即哈希通常用于加密密码，因此没有人可以发现另一个人的密码是什么，包括那些在系统上工作的人。也就是说，显然是错误的上下文（现在我明白了为什么你要散列用户名而不仅仅是密码）。正如 JPLemme 所指出的，您实际上正在使用一个完全独立的并行系统，其中实时数据已被复制和匿名化，并且使用散列（和加盐！）密码的安全登录过程不会受到干扰。

在这种情况下，WW 在下面的回答更相关，我建议大家将您的投票投给他/​​她。对不起，我误解了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-06T01:25:08.420

您不需要散列数据。您应该将其随机化，使其与原始数据无关。

例如，更新所有登录名，并将每个字母替换为另一个随机字母。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-06T01:17:53.397

我认为您在这里采取了错误的方法。哈希的想法是它是单向的，没有人应该能够使用该哈希来访问系统（如果他们可以，那么您可能仍然违反了数据保护法。此外，测试人员不应该使用真实账户，除非这些账户是他们自己的。

您应该让测试人员在单独的环境中使用模拟帐户。通过在单独的环境中使用模拟账户，向测试人员提供账户信息是没有危险的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T01:20:40.940

一般来说，不建议使用自己的加密/散列算法。现有的算法做他们做的事情是有原因的。

要么给测试人员一个为他们散列用户名的访问路径，要么让他们复制/粘贴 SHA-1 散列，真的会这么糟糕吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T01:29:26.150

根据定义，哈希是单向的。

如果您要保护的只是随意阅读数据（因此加密级别很低），请执行一些简单的操作，例如转置密码（不同字符之间的 1-1 映射——A 变为 J，B 变为'-'， ETC）。或者甚至只是将所有内容移一格（IBM 成为 HAL）。

但请务必认识到，这绝不是隐私或安全的保证。如果这些是您正在寻找的品质，那么根据定义，您不能让测试人员冒充真实用户。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T01:48:32.273

Did this recommendation go through your organization's auditing department? You might want to talk to them if not, it's not at all clear the scheme you're using protects your organization from liability.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-06T01:19:21.363

为什么不对可以识别个人的数据使用测试数据生成器呢？

[在数据库中创建测试数据](https://stackoverflow.com/questions/16317/creating-test-data-in-a-database#16336)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-06T01:22:26.193

为您提供更多信息：

我需要测试一个 DTS 包，它将系统的所有用户从一个文本文件导入我们的数据库。我将获得实时数据。

然而，一旦数据在数据库中，它必须被打乱，这样对普通读者来说没有意义，但允许测试人员登录到系统

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T01:37:16.070

感谢所有的答案。我认为您几乎可以肯定我们的测试策略是错误的是正确的。

我会看看我是否可以改变那些权力的想法

# javascript - 检测 URL 中的后退按钮/哈希更改

> ID：172957
> 
> 赞同：62
> 
> 时间：2008-10-06T01:18:51.617
> 
> 标签：javascript, ajax, navigation, fragment-identifier, hashchange

我刚刚在[http://ritter.vg](http://ritter.vg)建立了我的新主页。我正在使用 jQuery，但非常少。
它使用 AJAX 加载所有页面 - 我将其设置为通过检测 URL 中的哈希来允许添加书签。

```
 //general functions
 function getUrl(u) {
      return u + '.html';
 }
 function loadURL(u)    {
      $.get(getUrl(u), function(r){
                $('#main').html(r);
           }
      );
 }
 //allows bookmarking
 var hash = new String(document.location).indexOf("#");
 if(hash > 0)
 {
      page = new String(document.location).substring(hash + 1);
      if(page.length > 1)
        loadURL(page);
      else
        loadURL('news');
 }
 else
      loadURL('news'); 
```

但我无法让后退和前进按钮工作。

有没有办法在不使用 setInterval 循环的情况下检测何时按下后退按钮（或检测哈希何时更改）？当我尝试使用 0.2 和 1 秒的超时时，它与我的 CPU 挂钩。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-12-06T15:49:55.497

这里的答案都很老了。

在 HTML5 世界中，您应该使用[`onpopstate`](https://developer.mozilla.org/en-US/docs/DOM/window.onpopstate)事件。

```
window.onpopstate = function(event)
{
    alert("location: " + document.location + ", state: " + JSON.stringify(event.state));
}; 
```

或者：

```
window.addEventListener('popstate', function(event)
{
    alert("location: " + document.location + ", state: " + JSON.stringify(event.state));
}); 
```

后一个片段允许存在多个事件处理程序，而前者将替换任何可能导致难以发现的错误的现有处理程序。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-06T02:46:02.530

请改用[jQuery hashchange 事件](https://github.com/cowboy/jquery-hashchange)插件。关于您的完整 ajax 导航，请尝试使用[SEO 友好的 ajax](http://www.chazzuka.com/blog/?p=90)。否则，您的页面在具有 JavaScript 限制的浏览器中不会显示任何内容。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-02-03T16:42:31.847

[**jQuery BBQ**（后退按钮和查询库）](http://benalman.com/projects/jquery-bbq-plugin/)

一个高质量的基于哈希的浏览器历史插件，[在撰写本文时非常最新（2010 年 1 月 26 日）（jQuery 1.4.1）](http://benalman.com/news/2010/01/jquery-bbq-v111-also-bbq-jquer/)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-01-30T14:02:17.840

HTML5 包含一个比使用 hashchange 更好的解决方案，它是 HTML5 状态管理 API - [https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history) - 它们允许您更改页面的 url，而无需使用哈希！

虽然 HTML5 状态功能仅适用于 HTML5 浏览器。所以你可能想要使用类似[History.js](https://github.com/browserstate/History.js)的东西，它为 HTML4 浏览器提供向后兼容的体验（通过哈希，但仍然支持数据和标题以及 replaceState 功能）。

你可以在这里阅读更多关于它的信息： [https ://github.com/browserstate/History.js](https://github.com/browserstate/History.js)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-28T17:47:01.533

另一个很棒的实现是 balupton 的[jQuery History](https://github.com/balupton/jquery-history)，如果浏览器支持它，它将使用本机 onhashchange 事件，如果不支持，它将为浏览器使用适当的 iframe 或间隔，以确保成功模拟所有预期的功能。它还提供了一个很好的接口来绑定到某些状态。

另一个值得注意的项目是[jQuery Ajaxy](https://github.com/balupton/jquery-ajaxy)，它几乎是 jQuery History 的一个扩展，用于添加 ajax。当您开始使用带有哈希的 ajax 时，它变得[非常复杂](https://stackoverflow.com/questions/3205900/how-to-show-ajax-requests-in-url/3276206#3276206)！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-18T19:53:07.387

我执行以下操作，如果您想使用它，然后将其粘贴到某个位置并将处理程序代码设置在 locationHashChanged(qs) 中的注释位置，然后在每次加载 ajax 请求时调用 changeHashValue(hashQuery) 。它不是一个快速修复的答案，也没有，所以你需要考虑它并将合理的 hashQuery 参数（即 a=1&b=2）传递给 changeHashValue(hashQuery)，然后在你的 locationHashChanged 中满足所述参数的每个组合(qs) 回调...

```
// Add code below ...
function locationHashChanged(qs)
{
  var q = parseQs(qs);
  // ADD SOME CODE HERE TO LOAD YOUR PAGE ELEMS AS PER q !!
  // YOU SHOULD CATER FOR EACH hashQuery ATTRS COMBINATION
  //  THAT IS PASSED TO changeHashValue(hashQuery)
}

// CALL THIS FROM YOUR AJAX LOAD CODE EACH LOAD ...
function changeHashValue(hashQuery)
{
  stopHashListener();
  hashValue     = hashQuery;
  location.hash = hashQuery;
  startHashListener();
}

// AND DONT WORRY ABOUT ANYTHING BELOW ...
function checkIfHashChanged()
{
  var hashQuery = getHashQuery();
  if (hashQuery == hashValue)
    return;
  hashValue = hashQuery;
  locationHashChanged(hashQuery);
}

function parseQs(qs)
{
  var q = {};
  var pairs = qs.split('&');
  for (var idx in pairs) {
    var arg = pairs[idx].split('=');
    q[arg[0]] = arg[1];
  }
  return q;
}

function startHashListener()
{
  hashListener = setInterval(checkIfHashChanged, 1000);
}

function stopHashListener()
{
  if (hashListener != null)
    clearInterval(hashListener);
  hashListener = null;
}

function getHashQuery()
{
  return location.hash.replace(/^#/, '');
}

var hashListener = null;
var hashValue    = '';//getHashQuery();
startHashListener(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-19T18:16:31.713

尝试简单轻量[的 PathJS](https://github.com/mtrpcic/pathjs)库。

简单的例子：

```
Path.map("#/page").to(function(){
    alert('page!');
}); 
```***************