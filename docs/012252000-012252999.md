# StackOverflow 问答 12252000-12252999

# php - 无法使用 odbc 和 freetds 从 php 连接到 MSSQL 2008 db

> ID：12252005
> 
> 赞同：1
> 
> 时间：2012-09-03T17:30:25.323
> 
> 标签：php, sql-server, odbc, connect, freetds

我一直在到处寻找解决方案，但越来越困惑。

我正在尝试使用 FreeTDS 从 php 连接到 SQL Server 2008 db。服务器是 MediaTemple DV 4.0，运行 CentOS 5.7。我安装了一个版本的 FreeTDS (v0.91)，我想我可能在几个月前就已经编译过了。当我运行 tsql -C 时，它说我的 freetds.conf 在 /usr/local/etc 和 TDS 5.0 版中。我需要它是 TDS 版本 7.0，但是当我更改该 conf 文件时，它不会更改。而且我找不到它正在使用的conf文件。（问题1）

我可以使用 tsql -H -p -U 连接到我的数据库并运行查询。但是在我的 php 文件中，我收到 IM002 错误，我认为这是与数据库的连接错误。我为此使用 odbc_connect。（问题2，最大的问题）

我什至不知道从哪里开始，因为我已经安装、卸载了大约 2 个月...

我欢迎任何有关如何解决该问题的建议。附带说明一下，在我在 MediaTemple 升级我的 DV 之前，它曾经可以工作。

谢谢！肖恩

这是我的 tsql -C

编译时设置（使用“configure”脚本建立） 版本：freetds v0.91 freetds.conf 目录：/usr/local/etc MS db-lib 源代码兼容性：否 Sybase 二进制兼容性：否 线程安全：是 iconv 库：是 TDS 版本：5.0 iODBC：否 unixodbc：是 SSPI“可信”登录：否 Kerberos：否

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T14:23:34.390

验证是否在您的 odbcinst.ini 中打开了调试，并且错误已发送到定义的日志文件。

尝试使用 iSQL 工具连接并运行查询，并检查调试日志是否有错误。该工具带有 unixODBC 包，并使用您的 DSN 连接到您的数据库。

您可能还想查看此页面：[有时 isql 不连接而 tsql 连接](https://stackoverflow.com/questions/12949799/sometimes-isql-doesnt-connect-and-tsql-does)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T21:12:24.747

[SQL Server 2008 实际上需要 TDS 版本 7.3，而不是对应于 SQL Server 7 的 7.0。](http://wikis.openlinksw.com/UdaWikiWeb/TDSVersionsExplained)

我无法提供有关 FreeTDS 调试的帮助，但您可以尝试使用商业驱动程序来解决问题，例如[我的雇主提供的](http://uda.openlinksw.com/odbc-sqlserver-st/). 可以免费测试 2 周。

我们还在iODBC.org 站点上提供了一些关于[将 PHP 与 ODBC 结合使用的文档。](http://www.iodbc.org/dataspace/iodbc/wiki/iODBC/IODBCPHPHOWTO)

# java - eclipse for循环分配按钮字符串

> ID：12252012
> 
> 赞同：0
> 
> 时间：2012-09-03T17:31:10.637
> 
> 标签：java, android

我一直在尝试开发一个简单的音板的Android应用程序，它将播放几个长声音，一次只能播放一个，而不是同时播放。我的声音部分播放得很好。我想为每个按钮分配文本。

我有一个这样的 strings.xml 设置：

```
<string name="quote01">quote01</string>
<string name="quote02">quote02</string>
<string name="quote03">quote03</string> 
```

在我的 main.xml 中，我的 buttonIds 设置如下：

```
 final int[] buttonIds = { R.id.button01, R.id.button02, R.id.button03, 
        R.id.button04, R.id.button05, R.id.button06, 
        R.id.button07, R.id.button08, R.id.button09, 
        R.id.button10, R.id.button11, R.id.button12, 
        R.id.button13, R.id.button14, R.id.button15, 
        R.id.button16, R.id.button16, R.id.button17, 
        R.id.button18, R.id.button19, R.id.button20, 
        R.id.button21, R.id.button22, R.id.button23, 
        R.id.button24, R.id.button25 }; 
```

我可以像这样分配按钮文本以使其工作：

```
Button s01 = (Button) findViewById(R.id.button01); 
s01.setText(this.getString(R.string.quote01));
Button s02 = (Button) findViewById(R.id.button02); 
s02.setText(this.getString(R.string.quote02));
Button s03 = (Button) findViewById(R.id.button03); 
s03.setText(this.getString(R.string.quote03)); 
```

但我宁愿使用循环来避免重复代码。我有一个非工作循环，如下所示：

> ```
> for(int i = 0; i < buttonIds.length; i++) { 
>     Button soundButton = (Button)findViewById(buttonIds[i]); 
>     soundButton.setText(this.getString(R.string.buttonIds[i]);
> } 
> ```

但在上面的第 3 行中，buttonIds 无法解析为字段。我尝试在 buttonIds[1] 周围放置方括号或括号，但我的语法不正确。我确信这是一个非常简单的问题，但它欺骗了我。有什么建议么？

提前致谢！美泰87

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:38:51.107

看看这是否有帮助：

```
Resources res = getResources();
for(int i = 0; i < buttonIds.length; i++) { 
    Button soundButton = (Button)findViewById(buttonIds[i]); 
    soundButton.setText(res.getIdentifier("quote" + (i < 10 ? "0" + i : i), "string", getPackageName()));
} 
```

此外，您的字符串集从 开始`quote01`，循环从 开始`i = 0`，因此您必须同步这两个值。

# c - 并非所有数组元素都发送

> ID：12252019
> 
> 赞同：1
> 
> 时间：2012-09-03T17:31:51.890
> 
> 标签：c, parallel-processing, mpi

我创建程序以将二维数组从从属发送到主控。像这样的代码：

```
int **hasil;
hasil=(int**)malloc(baris*sizeof(int));
for(t=0;t<baris;t++){
    hasil[t]=(int*)malloc(kolom*sizeof(int));
}

//some code to generate data

MPI_Type_contiguous(kolom, MPI_INT,&rowtype);
MPI_Type_commit(&rowtype);

if(rank==master){
    int **terima;
    int t,m,x;

    terima=(int**)malloc(baris*sizeof(int));
    for(t=0;t<baris;t++){
        terima[t]=(int*)malloc(kolom*sizeof(int));        
        for(m=0;m<kolom;m++){
            terima[t][m]=-1;
        }
    }
    for(x=1;x<numOfProc;x++){       
        MPI_Recv(&(terima[0][0]),baris,rowtype,x,99,MPI_COMM_WORLD,&status);
    }
} else {
    MPI_Send(&(hasil[0][0]),baris,rowtype,master,99,MPI_COMM_WORLD);
} 
```

我不知道为什么不发送所有数组元素。

关于“哈西尔”：

```
1 123 1234 1234 55345
2 123 1234 1234 12345
3 98765 1234 1234 12345
4 123 1234 1234 12345
5 123 1234 1234 12345
6 123 1234 1234 12345
7 123 1234 1234 12345
8 123 1234 1234 12345
9 123 1234 1234 12345
10 123 1234 1234 12345
11 123 1234 1234 12345 
```

但在'terima'上：

```
1 123 1234 1234 55345
2 123 1234 1234 12345
3 98765 1234 1234 12345
4 123 1234 1234 12345
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1
-1 -1 -1 -1 -1 
```

有人知道我的代码有什么问题吗？请告诉我。

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T18:35:24.293

除了关于数组分配的内容外，您还发送/接收错误的字节数。计数应该是 1，而不是 baris：

```
MPI_Send(&(hasil[0][0]),1,rowtype,master,99,MPI_COMM_WORLD); 
```

这是因为在给定的地址 &(hasil[0][0]) （顺便说一下，这与 hasil[0] 相同）您分配了一个大小为 kolom 的数组：

```
hasil[t]=(int*)malloc(kolom*sizeof(int)); 
```

因此，您不能从 hasil[0] 发送超过 kolom 字节。您要么发送 kolom 整数，要么发送 1 个行类型。

另外，我真的不明白你想从每个进程发送什么以及你想把它保存在哪里？您将所有数据保存在 MPI_Recv 中的一个位置 - 在 terima[0] 中。您可以一个接一个地从不同的进程发送/接收 1 行类型的数据到 terima 的不同位置。所以你可以在master上写这个：

```
for(x=1;x<numOfProc;x++){
  MPI_Recv(terima[x],1,rowtype,x,99,MPI_COMM_WORLD,&status);
} 
```

另一方面，如果您想在实现中将整个 hasil 数组从所有线程传输到主线程（请记住，如果您只接收到 terima，这将覆盖数据），您需要循环执行，因为这是你如何分配你的二维数组：

```
for(i=1;i<baris;i++){
  MPI_Send(hasil[i],1,rowtype,master,99,MPI_COMM_WORLD,&status);
} 
```

**编辑**发送整个值矩阵将需要更改分配数据的方式。您分配了一块可以容纳整个矩阵的连续内存，而不是带有指针的二维数组：

```
int *terima;
terima=(int*)malloc(baris*kolom*sizeof(int)); 
```

然后，不用写 terima[t][m]，而是使用线性索引来寻址数组：terima[t*kolom + m]。现在您可以使用发送和接收整个矩阵

```
MPI_Recv(terima,baris,rowtype,x,99,MPI_COMM_WORLD,&status); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T04:05:51.290

我在您的 malloc 语句中看到一个明显的错误：

```
int **hasil;
hasil=(int**)malloc(baris*sizeof(int)); 
```

分配行时，基本上是在分配指针，因此语句应如下所示：

```
int **hasil;
hasil=(int**)malloc(baris*sizeof(int *)); 
```

我在分配`terima`.

不确定这是否会解决您的问题，但这肯定需要纠正。请试试这个，让我知道。

# c# - 将图像文件序列转换为单个视频文件

> ID：12252032
> 
> 赞同：4
> 
> 时间：2012-09-03T17:33:17.810
> 
> 标签：c#, .net

> **可能重复：**
> [位图到 avi 文件 c# .Net](https://stackoverflow.com/questions/5978632/bitmaps-to-avi-file-c-sharp-net)

我对将序列图像文件转换为单个视频文件的想法感到震惊。我正在使用 dotnet 作为平台。我应该如何进行。没有明确的想法......还有更多需要在显示图像序列时添加音频（mp3）语音......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:37:42.853

这里的一般想法是您希望通过编码器传递原始图像并以这种方式对文件进行编码。编码器将负责生成所有关键帧和中间（P 和 B）帧，以及生成任何需要存储的必要解码元数据。除此之外，通过 ffmpeg 等编码工具运行它还将负责将视频文件保存为已知的容器格式并正确构建视频头。所有这些都是复杂而繁琐的手工操作，更不用说容易出错了。

无论您使用 ffmpeg 还是其他编码器，都取决于您。我建议使用 ffmpeg，因为它具有您需要的必要功能。如果您想在代码中完成这一切，ffmpeg 是开源的，您可以将所需的部分包装在 .net shell 中并以这种方式调用。但是，如果您正在开发可分发的应用程序，请记住 ffmpeg 的[许可证。](http://ffmpeg.org/legal.html)

这应该可以帮助您入门：[使用 ffmpeg/mencoder 从图像文件制作电影](http://electron.mit.edu/~gsteele/ffmpeg/)

要添加音频，请检查：[https ://stackoverflow.com/questions/1329333/how-can-i-add-audio-mp3-to-a-flv-just-video-with-ffmpeg](https://stackoverflow.com/questions/1329333/how-can-i-add-audio-mp3-to-a-flv-just-video-with-ffmpeg)

现在，如果您想同步音频和视频（假设图像序列是人们在说话，而音频是他们的语音），您将面临一个更加困难的问题。此时，您需要根据持续时间正确复用音频和视频帧。FFMpeg 可能不会做得很好，因为它会将视频序列中的每个图像设置为以相同的持续时间播放，这通常与音频帧不正确相关。

# windows-server-2008 - 消息过滤器 (0x80010002) 取消了呼叫，Windows Server 2008 中的任务计划程序

> ID：12252033
> 
> 赞同：1
> 
> 时间：2012-09-03T17:33:25.017
> 
> 标签：windows-server-2008, scheduled-tasks

我已经在 Windows Server 2008 的任务计划程序中安排了我的批处理文件。任务在执行之间自动终止。我检查了任务历史并找到了消息：

> 任务计划程序终止了任务的“{69903b02-c15a-4c67-97b8-3e7d15a125f6}”实例。

事件 ID 为 111。

上次运行结果显示以下消息：

> 消息过滤器取消了呼叫 (0x80010002)

请提出原因以及将来如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:24:10.207

您是否尝试过重新输入运行此任务的帐户的密码。另外，权限对吗？您是否尝试过选中“以最高权限运行”框？

# javascript - 无法正确访问 NODE_ENV 环境变量，这是 node.js 的错误吗？

> ID：12252043
> 
> 赞同：7
> 
> 时间：2012-09-03T17:34:31.980
> 
> 标签：javascript, node.js

我正在访问 NODE_ENV 环境变量以打开 node.js 服务器中的一些调试功能。它曾经像一个魅力，但现在我面临着一些非常奇怪的东西。这就是我正在做的事情：

```
// check if the env var is OK
console.log(process.env.NODE_ENV);

// WTF???
if (process.env.NODE_ENV == "development") {
    console.log("ok");
}
else {
    console.log("nope");
}

// sanity check
var str = "development";
if (str == "development") {
    console.log("ok");
}
else {
    console.log("nope");
} 
```

这就是我得到的：

```
development
nope
ok 
```

这怎么可能？我是否面临 node.js 中的错误？如果没有，我做错了什么？

**编辑**

在下面 Pointy 的评论之后，如果我将初始日志更改为`console.log("[" + process.env.NODE_ENV + "]");`：

```
]development
nope
ok 
```

那么，可能是一个已知问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T17:43:39.153

看起来您的环境变量有一些有趣的字符，可能是由于它在 Node.js 之外设置的方式。你可以试试这个：

```
if (process.env.NODE_ENV.replace(/\W/g, '') == 'development') {
  console.log('ok');
} 
```

# sql-server - 数据库设计 Microsoft SQL Server

> ID：12252044
> 
> 赞同：1
> 
> 时间：2012-09-03T17:34:32.487
> 
> 标签：sql-server, database, database-design

正在考虑在 c# 中创建一个小型应用程序，但想听听一些关于使用这种方法处理我的项目的反馈。

```
Basically I will have 2 tables in MSSQL

    These are just examples....

 **TableType
      TableTypeID     
      Type

    TableInfo
      InfoID
      TableTypeID
      Name
      Color
      Size
      TagNumber** 
```

因此，当用户想要创建一个新表时说鸟，该值将进入 tabletype 创建一个 autoid，然后将 Type 设置为鸟。鸟的名称、颜色、大小将进入 TableInfo 表。

但是现在假设他们想创建一个名为 auto 的新表。因此，auto 将再次进入**type**列下的**tabletype**，然后 auto 的颜色、大小、tagnumber 将全部进入下一个表。

 **这是解决这个问题的正确方法吗，还是这会在未来引起很多编程问题

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:50:06.243

这是对表继承的一种奇怪的滥用，这不是一个好主意。

如果您想在关系数据库中存储有关鸟类的信息，您应该有一个名为 Bird(s) 的表，它只存储有关鸟类的信息。并有一个不同的汽车。

您可以考虑对*相关*类型使用表继承，例如[Tits](http://en.wikipedia.org/wiki/Tit_%28bird%29)和[Swallows](http://en.wikipedia.org/wiki/Swallow)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:49:04.827

是的，根据您提供的信息，这可能是一种方法。

我猜你会超时添加不同的表类型，甚至可能是动态的，并且你的代码将根据这些表类型映射到业务逻辑端的不同对象类型。

但是，您的名称令人困惑，而不是使用 TableType，也许更好的名称可能是 RecordType 和 RecordDetails 或 RecordInfo。**

# java - 为什么当我从 .jar 运行时 Java Sound 的行为会有所不同？

> ID：12252053
> 
> 赞同：3
> 
> 时间：2012-09-03T17:35:05.407
> 
> 标签：java, multithreading, javasound

下面的`play`方法来自一个类，该类在实例化时将 .wav 文件读入一个名为 的字节数组`data`，并将声音格式存储在一个`AudioFormat`名为 的对象中`format`。

我有一个`play`从`java.util.Timer`. 当我进入包含所有相关 .class 文件的文件夹并使用命令运行程序时`java MainClass`，一切都按预期工作。但是，当我将所有 .class 文件放入可执行 .jar 并使用 command 运行程序时`java -jar MyProgram.jar`，使用该方法播放的声音会在`play`50 到 150 毫秒后被切断。

```
public void play() throws LineUnavailableException {
    final Clip clip = (Clip)AudioSystem.getLine(new DataLine.Info(Clip.class, format));
    clip.open(format, data, 0, data.length);
    new Thread() {
        public void run() {
            clip.start();
            try {
                Thread.sleep(300); // all sounds are less than 300 ms long
            } catch (InterruptedException ex) { /* i know, i know... */ }
            clip.close();
        }
    }.start();
} 
```

几点评论：

*   我尝试将`play`方法中的睡眠时间增加到 1000 毫秒，而行为没有改变。

*   计时`Thread.sleep`使用`System.nanoTime`确认线程完全按照预期的时间休眠。

*   由于要播放的声音文件已预先加载到内存中，因此我认为从 .jar 中提取声音资源的行为不会导致问题。

*   我尝试使用内存池大小选项`-Xms2m`和`-Xmx64m`（单独）从 jar 内部和外部运行程序，但行为没有变化。

我在 Ubuntu 11.04 上运行 OpenJDK Java 6。知道发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T23:39:54.893

我不知道这是否与问题直接相关，但是每次播放该剪辑时都实例化一个新剪辑有点弄巧成拙。Clip 的重点是能够启动它而无需先加载它。根据您当前的设置，您的 Clip 在完全加载之前甚至不会开始播放。（当您包含实例化步骤时，SourceDataLines 开始播放比 Clips 更快，因为它们不会在开始之前等待所有数据加载。）

因此，作为解决此问题的第一步，我建议在播放调用之前实例化各种剪辑。我相信如果你做对了，并且剪辑开始在它自己的线程中，它可以被允许运行它的过程而不需要弄乱 Thread.sleep。您只需在下一次开始之前将剪辑重新定位回其起始帧。（可以在开始前的播放调用中完成。

一旦您对 Clip 的使用变得更加传统，可能会更容易确定是否还有其他事情发生。

我也不清楚为什么将源 .wav 文件作为中间步骤加载到字节数组中。不妨将它们直接加载到 Clips 中。考虑到 PCM 数据的优势，无论哪种方式，它们都会占用几乎相同数量的空间，并且在您调用它们时准备好使用。

禁用错误消息也是弄巧成拙。Java 可能试图给你一个非常好的诊断，也许不是在这个特定的睡眠调用中（我知道，我知道），但如果你经常这样做，谁知道呢。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T01:11:27.623

放大@Anrew 和@Phil 的答案，下面有一个获取 a`Clip`并异步播放它的大纲。[这里](https://groups.google.com/forum/#!msg/comp.lang.java.help/5IKYbYU8Nto/NWePrfaFRWAJ)有一个完整的例子。

```
AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(...);
Clip clip = AudioSystem.getClip();
clip.open(audioInputStream);
...
// Play the sound in a separate thread.
private void playSound() {
    Runnable soundPlayer = new Runnable() {

        @Override
        public void run() {
            try {
                clip.setMicrosecondPosition(0);
                clip.start();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    };
    new Thread(soundPlayer).start();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-22T23:11:25.247

这很可能`byte[]`是问题的加载。

# android - 在 Droid X 上调试时无法访问网络

> ID：12252054
> 
> 赞同：0
> 
> 时间：2012-09-03T17:35:14.120
> 
> 标签：android

我刚拿起一个用过的 Droid X 进行开发，当我尝试从 Eclipse 调试时，我没有任何网络访问权限。当我运行应用程序非调试时工作正常。我已经安装了适用于 Windows 的 Moto USB 驱动程序，并且我已经尝试了手机上的所有 USB 连接类型，在你问之前，是的，USB 调试已打开。我可以单步执行代码等，只是无法访问网络。

其他人看到这个问题吗？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:59:51.167

啊，我刚刚想通了。如果我将手机置于飞行模式但保持 wifi 开启，它就可以工作。猜猜当我调试它时忽略wifi并寻找由于手机未激活而找不到的3g。

感谢 Sandyiscool 让我想到尝试 :)

# sql-server - asp.net miscelenius 错误提供程序：命名管道提供程序，错误：40

> ID：12252056
> 
> 赞同：-2
> 
> 时间：2012-09-03T17:35:44.227
> 
> 标签：sql-server, asp.net-mvc

启动应用程序时，一切顺利，并且对服务器进行了查询，没有任何问题。

一旦我单击需要另一个连接到 Sql Server 2008 express R2 的链接，我会收到一个错误：

Une erreur lée au réseau ou spécifique à l'instance s'est produite lors de l'établissement d'une connexion à SQL Server。Le serveur est introuvable ou n'est pas 可访问。Vérifiez que le nom de l'instance est correct et que SQL Server est configuré pour autoriser les connexions distancees。（提供者：命名管道提供者，错误：40 - Impossible d'ouvrir une connexion à SQL Server）

服务器上没有发生问题：www.jbusinesses.com

任何人都可以帮忙吗？我几乎尝试了一切，一切似乎都很好，因为第一次连接似乎很好，只有在第二次连接上问题才出现......

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:44:33.880

当您无法访问您的 sql 数据库服务器时，这是一个常见错误。

第二个连接字符串中的服务器名称和实例。

测试您是否可以从 SqlServer 管理工作室连接到该服务器。

还要检查防火墙是否阻止与该特定 sql 服务器的连接。

# java - 我应该如何在java中实现子字符串函数？

> ID：12252057
> 
> 赞同：0
> 
> 时间：2012-09-03T17:35:52.427
> 
> 标签：java, string, substring, complexity-theory, time-complexity

考虑到您被告知要实现一种 java String.substring 方法。
该方法的签名如下：

**公共静态布尔 isSubstring(String i_StringForSearch, String i_SubStringToFind)**

这是我的解决方案，但我觉得它仍然不是我可以拥有的最好的优雅解决方案。（许多规范如果其他）
你怎么看？你会用另一种方式来做吗？

```
public static boolean isSubstring(String i_StringForSearch, String i_SubStringToFind)
    {
        int strForSearchIndex = 0;
        int subStrToFindIndex = 0;
        boolean endOfStringToSearch = false;
        boolean foundSubString = false;
        boolean isThereASequenceOfMatching = false;

        while(!endOfStringToSearch && !foundSubString)
        {
            if(strForSearchIndex == i_StringForSearch.length())
            {
                endOfStringToSearch = true;
            }

            else if(i_StringForSearch.charAt(strForSearchIndex) == i_SubStringToFind.charAt(subStrToFindIndex))
            {
                isThereASequenceOfMatching = true;
                if(subStrToFindIndex == i_SubStringToFind.length() -1 )
                {
                    foundSubString = true;
                }
                subStrToFindIndex++;
                strForSearchIndex++;
            }

            else if(i_StringForSearch.charAt(strForSearchIndex) != i_SubStringToFind.charAt(subStrToFindIndex))
            {
                if(isThereASequenceOfMatching)
                {
                    subStrToFindIndex = 0;
                    isThereASequenceOfMatching = false;
                }
                strForSearchIndex++;
            }
        }

       return foundSubString;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:02:32.110

查看 Boyer-Moore 和 Knuth-Morris-Pratt 算法。在多年前的测试中，我发现 BM 稍微快一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-08T19:02:25.800

```
public static boolean isSubstring(final String i_StringForSearch, final String i_SubStringToFind) {
    int j = 0;
    for (int i = 0; i < i_StringForSearch.length(); i++) {
        if (i_StringForSearch.charAt(i) == i_SubStringToFind.charAt(j)) {
            j++;
            if (j == i_SubStringToFind.length()) {
                return true;
            }
        }
    }
    return false;
} 
```

# php - str_replace 什么都不做

> ID：12252058
> 
> 赞同：0
> 
> 时间：2012-09-03T17:36:04.610
> 
> 标签：php, mysql

我想将所有 £ 替换为其 HTML 代码 £ => £ 因为它显示为 ? 在钻石中。

我正在使用以下代码，但它什么也没做。

```
<?php
    include ("config.php");

    $get_id = mysql_real_escape_string($_GET['id']);
    $page_get = mysql_query("SELECT * FROM contents_page WHERE `id` = '$get_id'");
    while($page_row = mysql_fetch_assoc($page_get)) {
        $page_row["Page_Content"] = str_replace('£','&pound;',$page_row[Page_Content]);
        $smarty->assign('page_title',       $page_row['Page_Title']);
        $smarty->assign('page_content',     $page_row['Page_Content']);     
    }

    $smarty->display('page.tpl');
?> 
```

我正在使用 str_replace() 但没有发生任何事情，就像它看不到 £

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:38:02.563

将此添加到页面的 head 标记中：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:08:19.233

我自己有一个编码问题。去数据库看看数据有没有乱码。如果不是，则在连接到数据库之前设置您的连接属性，如 SET CHAR UTF8。

```
$link1 = mysql_connect('localhost','user1','pass1',TRUE); 

mysql_selectdb('db1',$link1); 

mysql_set_charset('utf8',$link2); 
```

另一种解决方案是在输入进入数据库之前查看输入的编码内容，然后将字符集更改为

mysql_set_charset('latin1',$link2);

例如。

无论如何，我会做什么，我仍然会将我的字符设置为 utf-8 ，将结果输出到页面..看看这个字符是否真的是一个磅音，如果它是一个不同的符号，我会把它放在字符串替换函数而不是井号

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:37:32.283

假设磅符号不在标准 ascii 集中，您可能需要类似自我实现的 mb_str_replace() 之类的东西。

该页面上有多个示例实现：http: [//php.net/manual/en/ref.mbstring.php](http://php.net/manual/en/ref.mbstring.php)

我希望这就是你所需要的，如果你必须完全实现 unicode，它会变得非常复杂。如果使用 mb_str_replace 贡献的代码不起作用，您可能可以避免这种情况，您可能必须在 php ini 中打开 unicode 功能，以便 php 甚至可以识别您要替换的字符是 unicode一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T17:42:16.897

`str_replace`对您不起作用，因为针和干草堆的编码不同，因此字符不匹配。事实上，编码是你唯一需要关心的问题，你不需要替换任何东西。有关编码需要考虑的详细信息，请参阅[http://kunststube.net/frontback 。](http://kunststube.net/frontback)

有关更大的图片背景，另请参阅[每个程序员绝对、肯定需要了解的关于编码和字符集以使用文本](http://kunststube.net/encoding)的知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T18:12:56.373

```
<?php
$link1 = mysql_connect('localhost','user1','pass1',TRUE);

mysql_selectdb('db1',$link1);

mysql_set_charset('utf8',$link1);
?> 
```

# android - 在 3.2 版上编译

> ID：12252060
> 
> 赞同：0
> 
> 时间：2012-09-03T17:36:11.840
> 
> 标签：android, android-3.2-honeycomb

我正在尝试将我的应用程序扩展到所有屏幕尺寸，并且我读到如果我针对 android 3.2 编译应用程序，那么我将能够使用新的限定符等......但我的问题是 - 如果我编译它在这个版本中，是否意味着平台较小的手机将无法下载或运行该应用程序？我会为了包含平板电脑目前包含的一小部分手机而排除大多数手机吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:42:59.510

您可以使用最新的 Android SDK 版本编译您的应用程序，或者在您的情况下为 3.2，并且该应用程序应继续在旧版本的 Android 上运行。这里唯一需要注意的是确保您使用的 API 方法仍然与旧版本兼容。您提到的这些较新的限定符不适用于您的应用程序的旧版本，但您可以在此处找到一些可用于它们的兼容性库：

[http://developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)

为确保您的应用与旧版本的 Android 兼容，您可以安装最新的 ADT 并运行 Android Lint。Lint 会根据您的清单文件指出在不同版本的 Android 上可能不可用的功能。您的清单文件允许您确定可以使用您的应用的最低 Android 版本，以及您的应用所针对的理想 Android 版本。请参阅以下链接，了解有关应用版本控制和一些向后兼容性的更多详细信息：

[http://developer.android.com/guide/topics/manifest/uses-sdk-element.html](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)

# php - 如何为每个标签设置不同的主题？

> ID：12252063
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:36:19.273
> 
> 标签：php, mysql

在我的博客中，我需要为每个标签设置不同的主题（CSS、菜单等）。

例如，标签“iPhone”有一个类似“www.example.com/tag/iphone”的页面，并且有

*   不同的 CSS

*   标题中的不同菜单

*   与该标签相关的其他信息。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:51:12.290

您可以将主题 ID 存储在 cookie 中，当访客访问您的站点时，您可以检查该 cookie 的值。

例如：

*   当您有新客人时，只需显示默认主题
*   当客人单击链接时，例如`<a href="changeTheme.php?theme=black">BLACK THEME</a>` ，您将主题变量中的值存储在 cookie 中，当用户打开页面时，您应该为该主题添加 css，例如`echo '<link rel="stylesheet" type="text/css" href="'.$_GET['theme'].'.css">'`。

但是您需要创建该 .css 文件。

# linux - wget递归文件夹结构，树中有多个index.html文件

> ID：12252068
> 
> 赞同：2
> 
> 时间：2012-09-03T17:37:00.593
> 
> 标签：linux, command-line, wget

默认情况下 wget -r 将目录下载为 directoryname.html。我希望它下载到 directoryname/index.html

所以而不是：

```
index.html
contact.html
support.html 
```

我想要：

```
index.html
contact/index.html
support/index.html 
```

这对 wget 可行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T21:18:31.960

当我想镜像一个网站时，我使用：

```
$ wget -m -E -nH -np --cut-dirs=2 http://site/a/b/ 
```

这样，目录“b”下的所有内容都将被下载。如果您的目标目录处于不同的级别，则需要相应地调整 --cut-dirs。

# c# - 如何通知视图有关命令的成功

> ID：12252072
> 
> 赞同：2
> 
> 时间：2012-09-03T17:37:14.590
> 
> 标签：c#, wpf, mvvm

我正在开发一个遵循 MVVM 模式的小型数据库应用程序。为了修改数据库，我使用对话框（视图），然后调用在视图的视图模型中定义的命令。但是我如何告诉视图这个命令的成功/结果呢？

一个简单的例子：用户想要删除一行，但仍有剩余的关系，所以该行不能被删除。在我对 MVVM 的看法和理解中，通知失败是视图的工作，而通知用户问题的工作也是视图的工作。我认为在操作失败后直接从视图模型创建这个特殊视图是错误的。我考虑了解决这个问题的事件（比如我用于视图模型通信的中介模式）。但是这些事件也应该允许传递参数。在这个例子中，参数应该是一个包含所有剩余关系的字符串，这样用户也能理解操作失败的原因。

有人建议解决这个问题吗？非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:40:04.867

在您的情况下，该行应该在绑定的集合中。视图应该简单地向视图模型发送一个命令，上面写着“删除这一行”，它的兴趣应该停在那里。viewmodel 应该负责实际删除行并将其从集合中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:41:01.950

选项 1.`ObservableCollection`在视图模型类中使用错误集合 ( )。将视图中的任何项目控件绑定到此集合。当命令出错时，将错误添加到错误集合中。

选项 2。当命令出错时，向用户显示带有错误消息的消息框。要关注 MVVM，请通过服务显示它或向任何类似中介的类型发布消息。

这两个选项（在集合中添加新错误或消息框）都必须在视图模型中实现，而不是在视图中。

# c++ - ifstream tellg() 没有返回正确的位置

> ID：12252075
> 
> 赞同：9
> 
> 时间：2012-09-03T17:37:27.947
> 
> 标签：c++, file, fstream

### 读取.cpp

```
#include <iostream>
#include <fstream>

using namespace std;

int main(void)
{
    int id;
    char name[50];
    ifstream myfile("savingaccount.txt");  //open the file
    myfile >> id;
    cout << myfile.tellg(); //return 16? but not 7 or 8
    cout << id ;

    return 0;
} 
```

### 储蓄账户.txt

```
1800567
何瑞张
21
女性
马来西亚人
012-4998192
20 , Lorong 13 , Taman Patani Janam
马六甲
双溪独龙

```

### 问题

我希望`tellg()`返回`7`或者`8`因为第一行`1800567`是 7 位数字，所以流指针应该放在这个数字之后和字符串之前`"Ho Rui Jang"`，但是`tellg()`返回`16`。为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-08-31T13:41:36.180

有同样的问题。尝试读取文件流二进制文件：

```
 ifstream myfile("savingaccount.txt",ios::binary); 
```

它对我有帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T18:10:12.980

This seems more like a compiler bug (probably gcc)

With the following Code:-

```
#include <iostream>
#include <fstream>
using namespace std;
int main(void)
{
    int id;
    char name[50];
    ifstream myfile("savingaccount.txt");  //open the file
    cout << myfile.tellg()<<endl;
    myfile >> id;
    streamoff pos=myfile.tellg();
    cout <<"pos= "<<pos<<'\n';
    cout <<"id= " << id<<'\n' ;
    return 0;
} 
```

Following is the output:-

![Bug](../Images/0bd8cc9fc1592ccc04694db5aa75ace7.png)

In the image `inpstr.exe` was generated from `Visual studio's cl` while `inp.exe` from `g++(gcc version 4.6.1 (tdm-1))`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-31T13:53:48.453

这不是编译器错误。 `tellg()`不保证从文件开头返回偏移量。有一组最小的保证，例如，如果返回值 from`tellg()`被传递给`seekg()`，则文件指针将定位在文件中的对应点。

实际上，在 unix 下，`tellg()`确实返回文件开头的偏移量。在 Windows 下，它返回从文件开头的偏移量，但前提是文件以二进制模式打开。

但唯一真正的保证是返回的不同值`tellg()`将对应文件中的不同位置。

# objective-c - 未找到运行 XC 4.4.1 的 FacebookSDK Mountain Lion 框架

> ID：12252085
> 
> 赞同：5
> 
> 时间：2012-09-03T17:38:32.533
> 
> 标签：objective-c, ios, facebook, sdk

为什么这不起作用？我首先`FacebookSDK-3.0.8.pkg`从链接安装： [https ://developers.facebook.com/ios/downloads/](https://developers.facebook.com/ios/downloads/)

安装后，我注意到该文件夹​​是在`~/Documents/FacebookSDK/...`

我在 XC 4.4.1 和 XC 4.5 B4 中打开示例项目，并得到链接器错误：

```
ld: framework not found FacebookSDK
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我正在运行 Mountain Lion，并且过去能够编译较旧的 facebook SDK（尽管不是在 Mountain Lion 中）。

然后我安装了 FacebookSDK-3.0.0.pkg 包并得到了相同的结果。

**编辑** 这是完整的链接器输出：

```
Ld /Users/kevinw/Library/Developer/Xcode/DerivedData/HelloFacebookSample-amabhzuzewakecehidtetsnstpuu/Build/Products/Debug-iphonesimulator/HelloFacebookSample.app/HelloFacebookSample normal i386
    cd /Users/kevinw/Documents/FacebookSDK/Samples/HelloFacebookSample
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch i386 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -L/Users/kevinw/Library/Developer/Xcode/DerivedData/HelloFacebookSample-amabhzuzewakecehidtetsnstpuu/Build/Products/Debug-iphonesimulator -F/Users/kevinw/Library/Developer/Xcode/DerivedData/HelloFacebookSample-amabhzuzewakecehidtetsnstpuu/Build/Products/Debug-iphonesimulator -F/Users/kevinw/Documents/FacebookSDK -F/Users/kevinw/Documents/FacebookSDK -filelist /Users/kevinw/Library/Developer/Xcode/DerivedData/HelloFacebookSample-amabhzuzewakecehidtetsnstpuu/Build/Intermediates/HelloFacebookSample.build/Debug-iphonesimulator/HelloFacebookSample.build/Objects-normal/i386/HelloFacebookSample.LinkFileList -mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2 -lsqlite3.0 -fobjc-arc -fobjc-link-runtime -Xlinker -no_implicit_dylibs -D__IPHONE_OS_VERSION_MIN_REQUIRED=40000 -weak_framework Accounts -framework UIKit -framework Foundation -framework CoreGraphics -framework FacebookSDK -framework CoreLocation -o /Users/kevinw/Library/Developer/Xcode/DerivedData/HelloFacebookSample-amabhzuzewakecehidtetsnstpuu/Build/Products/Debug-iphonesimulator/HelloFacebookSample.app/HelloFacebookSample 
```

**使固定！** 我解决了我的问题。我已经安装了两个`3.0.8 SDK and then the 3.0.0 SDK`，试图让事情正常工作。我最终决定清理石板并擦拭我的`Documents/FacebookSDK`文件夹和`reinstall just the 3.0.0 version`. 擦拭/重新安装后，事情开始工作了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T03:01:51.917

我解决了我的问题。我已经安装了 3.0.8 SDK 和 3.0.0 SDK，试图让一切正常工作。我最终决定清理石板并擦除我的 Documents/FacebookSDK 文件夹并仅重新安装 3.0.0 版本。擦拭/重新安装后，事情开始工作了！

# objective-c - 在 UITableViewCell 中动态创建时，UIButton 在 UITableView 上显示多次

> ID：12252087
> 
> 赞同：2
> 
> 时间：2012-09-03T17:38:40.757
> 
> 标签：objective-c, uitableview, cocoa-touch, uibutton, ios5.1

在尝试了各种选项并阅读了关于 SO 的众多答案之后，我发布了这个问题，希望有人可以提供一些见解或解决这个问题：

iOS5.1、XCode 4.4.1、故事板、ARC

我有一个“分组”表格视图，每个单元格都包含一堆标签、图像和按钮。标签之一，**描述**标签，它的文本可以大或小，这意味着如果文本很大，我必须相应地增加标签的大小并相应地将按钮放在下面。我能够做到这一切，但问题是当我滚动经过第一个单元格时按钮会出现两次，并在滚动时不断重复。

这是代码，我所做的只是根据文本计算标签的高度，调整标签的大小，然后将 3 个按钮相应地放置在描述标签下方。

下面的代码仅适用于一个按钮，但这应该可以让您了解我在做什么。我曾尝试在自定义单元格类中的“willDisplayCell”中做类似的事情，但当我在表格视图中向下滚动时，3 个按钮仍然重复。请参考截图，前三个按钮甚至不应该显示。

我注意到前 3 个按钮的位置与忽略**sizeIncrement 相同**，即“359.0f + sizeIncrement +20”减去“sizeIncrement”，“sizeIncrement”= 计算后描述标签的高度

我还注意到，如果我这样做

```
float y = 359.0f + 20; 
```

而不是这个

```
float y = 359.0f + sizeIncrement +20; 
```

按钮问题的重复消失了。

PS：我知道这不是最好的代码，但我一直在尝试很多东西来解决这个问题，所以此时并没有考虑最佳实践等。

![屏幕截图上显示 2 个单元格，前 3 个按钮不应显示](../Images/da50227748c9ffd410e7d166604409ea.png)

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

 static NSString *CellIdentifier = @"tipsid";

 TipsCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
 if (cell == nil)
 {
     cell = [[TipsCell alloc]
             initWithStyle:UITableViewCellStyleDefault
             reuseIdentifier:CellIdentifier];
 }

 id tip = [_tips objectAtIndex: [indexPath section]];

 NSDictionary *tipForIndex = [_tips objectAtIndex: [indexPath section]];
 float sizeIncrement = [Utility getLabelHeightForText:[tipForIndex objectForKey:@"tipDescripion"]
                                            withWidth:285.0f
                                             withFont:[UIFont systemFontOfSize:14.0f]];

 // Here I Resize the Label, code below to create a button and position accordingly.

 float y = 359.0f + sizeIncrement +20;

 UIButton *likeButton = [[UIButton alloc] initWithFrame:CGRectMake(10, y, 80, 26)];
 likeButton.tag = [indexPath section];     

 // add targets and actions
 [likeButton addTarget:self action:@selector(likebuttonClicked:) forControlEvents:UIControlEventTouchUpInside];
 [likeButton setBackgroundImage:[UIImage imageNamed:@"likebutton.png"] forState:UIControlStateNormal];

 [likeButton setImage:[UIImage imageNamed:@"likedButton.png"] forState:UIControlStateSelected];

 // add to a view
 [cell.contentView addSubview:likeButton]; 
```

.....类似地创建2个其他按钮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:41:45.150

您应该将按钮创建移动到`if (cell == nil)`运算符中：

```
if (cell == nil)
{
   cell = [[TipsCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

   // like button
   float y = 359.0f + sizeIncrement +20;

   UIButton *likeButton = [[UIButton alloc] initWithFrame:CGRectMake(10, y, 80, 26)];
   likeButton.tag = LIKE_BUTTON_TAG_UNIQUE_IN_CONTENT_VIEW; // <<<<<<<<<<----------------     

   // add targets and actions
   [likeButton addTarget:self action:@selector(likebuttonClicked:) forControlEvents:UIControlEventTouchUpInside];
   [likeButton setBackgroundImage:[UIImage imageNamed:@"likebutton.png"] forState:UIControlStateNormal];

   [likeButton setImage:[UIImage imageNamed:@"likedButton.png"] forState:UIControlStateSelected];

   // add to a view
   [cell.contentView addSubview:likeButton];

   // other buttons
}

// and here you can adjust button positions
UIButton *likeButton = [self.contentView viewWithIndex:LIKE_BUTTON_TAG_UNIQUE_IN_CONTENT_VIEW]; 
```

# spring - 无法在 applicationContext.xml 文件中导入 persistence.xml

> ID：12252088
> 
> 赞同：0
> 
> 时间：2012-09-03T17:38:48.690
> 
> 标签：spring, jpa, persistence, javabeans, applicationcontext

我正在使用 eclipse juno IDE 我有具有 src 文件夹的 Java 应用程序。在我拥有的文件夹中：

1) applicationContext.xml

2) 持久性.xml

我也有 DBInterface，我用 JPA 实现了它。现在在 applicationContext.xml 文件中，我有一个用于 JPA 实现的 bean。

当我尝试注入 bean 时，我得到了一个异常，上面写着“没有找到持久性提供程序”。

所以我尝试在 applicationContext 文件中导入持久性文件，但我遇到了另一个异常。

**应用程序上下文.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:aop="http://www.springframework.org/schema/aop/spring-aop-2.5.xsd"
   xmlns:context="http://www.springframework.org/schema/context/spring-context-2.5.xsd"
   xmlns:flow="http://www.springframework.org/schema/webflow-config/spring-webflow-config-1.0.xsd"
   xmlns:jms="http://www.springframework.org/schema/jms/spring-jms-2.5.xsd"
   xmlns:jee="http://www.springframework.org/schema/jee/spring-jee-2.5.xsd"
   xmlns:lang="http://www.springframework.org/schema/lang/spring-lang-2.5.xsd"
   xmlns:osgi="http://www.springframework.org/schema/osgi/spring-osgi.xsd"
   xmlns:tx="http://www.springframework.org/schema/tx/spring-tx-2.5.xsd"
   xmlns:util="http://www.springframework.org/schema/util/spring-util-2.5.xsd"
   xmlns:p="http://www.springframework.org/schema/p"

   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
      http://www.springframework.org/schema/aop/spring-aop-2.5.xsd http://www.springframework.org/schema/aop/spring-aop-2.5.xsd/spring-spring-aop-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/context/spring-context-2.5.xsd http://www.springframework.org/schema/context/spring-context-2.5.xsd/spring-spring-context-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/webflow-config/spring-webflow-config-1.0.xsd http://www.springframework.org/schema/webflow-config/spring-webflow-config-1.0.xsd/spring-spring-webflow-config-1.0.xsd-2.5.xsd
      http://www.springframework.org/schema/jms/spring-jms-2.5.xsd http://www.springframework.org/schema/jms/spring-jms-2.5.xsd/spring-spring-jms-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/jee/spring-jee-2.5.xsd http://www.springframework.org/schema/jee/spring-jee-2.5.xsd/spring-spring-jee-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/lang/spring-lang-2.5.xsd http://www.springframework.org/schema/lang/spring-lang-2.5.xsd/spring-spring-lang-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/osgi/spring-osgi.xsd http://www.springframework.org/schema/osgi/spring-osgi.xsd/spring-spring-osgi.xsd-2.5.xsd
      http://www.springframework.org/schema/tx/spring-tx-2.5.xsd http://www.springframework.org/schema/tx/spring-tx-2.5.xsd/spring-spring-tx-2.5.xsd-2.5.xsd
      http://www.springframework.org/schema/util/spring-util-2.5.xsd http://www.springframework.org/schema/util/spring-util-2.5.xsd/spring-spring-util-2.5.xsd-2.5.xsd">

    <bean id="JPA"  class="pack.jpa.JPAQueries"/>
    <import resource="persistence.xml"/>
</beans> 
```

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 

http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xmlns="http://java.sun.com/xml/ns/persistence" version="1.0"> 
         <persistence-unit transaction-type="RESOURCE_LOCAL" name="MyJPA"> 
             <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider> 
             <class>pack.bl.Travels</class>
             <class>pack.bl.Example</class> 
             <properties> <property name="hibernate.cache.provider_class" value="org.hibernate.cache.NoCacheProvider"/> 
                 <property name="javax.persistence.jdbc.url" value="jdbc:mysql://localhost:3306/taxis"/> 
                 <property name="javax.persistence.jdbc.password" value=""/> 
                 <property name="javax.persistence.jdbc.driver" value="com.mysql.jdbc.Driver"/> 
                 <property name="javax.persistence.jdbc.user" value="root"/>
             </properties> 
         </persistence-unit> 
```

**主类**

```
public class Program {

/**
 * @param args
 */
public static void main(String[] args) {

  ApplicationContext context = new  
  ClassPathXmlApplicationContext("applicationContext.xml");
  DBInterface dao = (DBInterface)context.getBean("JPA",JPAQueries.class);

  dao.retrieveRecords();
} 
```

**例外**

```
Exception in thread "main"  
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration 
problem: Failed to import bean definitions from relative location [persistence.xml]

Offending resource: class path resource [applicationContext.xml]; nested exception is 
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration 
problem: Unable to locate Spring NamespaceHandler for XML schema namespace 
[http://java.sun.com/xml/ns/persistence]

Offending resource: class path resource [persistence.xml]
at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:76)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:271)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:196)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:181)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180)
at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:243)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:127)
at org.springframework.context.support.AbstractXmlApplicationContext.loadBeanDefinitions(AbstractXmlApplicationContext.java:93)
at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:131)
at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:527)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:441)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
at pack.program.Program.main(Program.java:16)

Caused by: org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHandler for XML schema namespace [http://java.sun.com/xml/ns/persistence]

Offending resource: class path resource [persistence.xml]

at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:80)
at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.error(BeanDefinitionParserDelegate.java:317)
at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1428)
at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1421)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:190)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.doRegisterBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:140)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:111)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:255)
... 20 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T17:55:52.790

您尝试`persistence.xml`用作 Spring 配置绝对没有意义，因为`persistence.xml`它不是 Spring 配置。

如果要在 Spring 中使用 JPA，则需要放入`persistence.xml`源`META-INF`文件夹中的文件夹，并`LocalContainerEntityManagerFactory`在以下位置声明`applicationContext.xml`：

```
<bean id="emf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name = "persistenceUnitName" value = "MyJPA" />
</bean> 
```

然后您可以`EntityManager`使用以下方法注入您的 Spring bean `@PersistenceContext`：

```
@PersistenceContext
private EntityManager em; 
```

**也可以看看：**

*   [13.5 JPA](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/orm.html#orm-jpa)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:13:23.117

好的，我解决了这个..

我所做的是按照 vikdor 和 axtavt 的建议将 persistence.xml 文件放在 META-INF 文件夹中。但是在应用程序上下文中我没有导入任何文件..只是写了这个

```
<bean id="JPA" class="pack.jpa.JPAQueries"/> 
```

和它的工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T17:43:07.600

应按如下方式导入：

```
<import resource="classpath:META-INF/persistence.xml"/> 
```

假设 persistence.xml 存在于 META-INF 目录中，该目录是类路径上的一个 jar 中的顶级目录。

# jquery - 在 jqGrid 上读取 json

> ID：12252091
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:39:11.487
> 
> 标签：jquery, jqgrid

我有json之类的

```
{
    "total": 7,
    "rows": [ 
        {"ID": "1","Code": "Code1" },
        { "ID": "2","Code": "Code2"},
        { "ID": "3", "Code": "Code3" },
        { "ID": "4", "Code": "Code4"},
        {"ID": "5","Code": "Code5"},
        {"ID": "6","Code": "Code6"},        
        {"ID": "7","Code": "Code7" }  
    ]
} 
```

我想在 jqGrid 中阅读这个

我在网格中使用

```
colNames: ['Code'], 
    colModel: [
        { name: 'Code', width: 100 }],

jsonReader: { repeatitems: false, id: "rows", root: function (obj) { return obj; } }. 
```

但它不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:47:59.770

根应该是行，而不是对象。

```
root: "rows" 
```

或者

```
root: function(obj) { return obj.rows; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:28:34.717

您的 json 阅读器将是这样的：

```
jsonReader: { repeatitems: false, id: "ID", root: "rows",cell:"code" } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:56:15.027

一般情况下使用

```
jsonReader: { repeatitems: false, id: "ID"} 
```

如果您另外使用应该足够了`loadonce: true`（参见[演示](http://www.ok-soft-gmbh.com/jqGrid/ahmedosman.htm)）。另一方面，如果您尝试实现*服务器端数据分页*，您应该扩展 JSON 数据。顺便说一下，当前值`total`对应于`records`输入属性。该`total`属性应该具有总*页数*而不是总记录数的值。

您没有发布定义网格的整个代码。因此，您可以在发布时遇到更多错误。无论如何，我建议您使用`loadError`回调。有关更多详细信息，请参阅[答案](https://stackoverflow.com/a/6969114/315935)。

# php - Zend Framework下如何配置MySQL？

> ID：12252093
> 
> 赞同：1
> 
> 时间：2012-09-03T17:39:16.003
> 
> 标签：php, mysql, zend-framework

我配置了 Zend Framework 虚拟主机环境，但现在我的文件无法访问 MySQL 数据库。收到错误：

> SQLSTATE[28000] [1045] 拒绝用户'root'@'localhost'的访问。

我应该在哪里配置我的 MySQL 以使其与我的虚拟主机匹配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T17:59:30.707

您需要确保您正在使用`Zend_Db`并且已将 MySQL 配置为[Zend DB 适配器中的适配器](http://framework.zend.com/manual/1.5/en/zend.db.html)

另外，在`application.ini`文件`configs`夹下的文件中，

你必须写：

```
[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1
resources.db.adapter = "PDO_MYSQL"
resources.db.params.dbname = "<your database name>"
resources.db.params.host = "<your host name>"
resources.db.params.username = "<mysql username>"
resources.db.params.password = "<mysql password>"
resources.db.params.charset  = "UTF8" 
```

享受编码:)

# c++ - 模板元编程 NamedPipe 客户端服务器

> ID：12252094
> 
> 赞同：1
> 
> 时间：2012-09-03T17:39:20.730
> 
> 标签：c++, c++11, typetraits

我正在为 C++11 编写 NamedPipe 提取，并希望拥有以下 API*：

```
template<typename Mode>
class NamedPipe final {
    public:
        void Open();

        std::enable_if<Mode == Receiver>
        void Send();

        std::enable_if<Mode == Receiver>
        void Receive();

        void Close();
} 
```

所以使用看起来像这样：

```
NamedPipe<Sender> pipe_sender("test");
NamedPipe<Reciever> pipe_receiver("test");
pipe_sender.Open();
pipe_receiver.Open();
pipe_sender.Send("Some data");
pipe_receiver.Receive();
pipe_sender.Receive(); <--- compilation error 
```

我一直`type_traits`在 C++11 中使用，但只是真正开始使用它们——我真的很喜欢使用它们，但这确实改变了学习曲线。有没有足够知识的人指出我正确的方向？

* 第一个例子是故意粗略的，因为我一直在用模板的东西绕圈子——我真的只需要走上正确的道路！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:46:13.050

您可以使用静态断言轻松强制编译错误：

```
template<typename Mode>
class NamedPipe final {
    public:
        void Open();    
        void Send();    
        void Receive();    
        void Close();
}        
template<typename Mode>
void NamedPipe<Mode>::Send() {
    static_assert(std::is_same<Mode, Sender>::value, "Cannot send from receivers");
    // blah blah implementation
}        
template<typename Mode>
void NamedPipe<Mode>::Receive() {
    static_assert(std::is_same<Mode, Receiver>::value, "Cannot receive with senders");
    // blah blah implementation
} 
```

这不仅会产生编译错误，还会产生很好的描述性错误。

# joomla - Joomla 编辑器插件开发

> ID：12252097
> 
> 赞同：0
> 
> 时间：2012-09-03T17:39:29.970
> 
> 标签：joomla, joomla2.5, joomla-extensions

我正在尝试为每个管理页面制作一个带有编辑器字段的插件，即在新文章页面或新类别页面上。

我不确定我应该如何安排这个。触发器必须已经存在，即我不想编辑任何模板文件。

所以我必须使用其中之一：

*   系统类型
*   内容类型
*   编辑类型
*   编辑器-xtd 类型

我应该把这个插件放在哪里？系统插件可能会工作，但是插件会在我发现不是最好的每个页面上触发

内容类型根本不会被触发。

Editors 类型也不起作用。

editors-xtd 可以工作，但它想要一个按钮作为返回值，我没有按钮，因为该插件主要是基于 javascript 和自动的

我还能用什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:38:43.537

即使您谈论的是插件，如果您谈论的是编辑器字段，Joomla 已经使用 JForm 内置了它：

XML

```
<field name="test1" 
  label ="Test Field" 
  type="editor" 
  width="300" 
  filter="safehtml" 
/> 
```

（注：编辑器，不是编辑器）查看[此链接](http://docs.joomla.org/Standard_form_field_types)了解更多信息。此外，看起来[这个页面](http://docs.joomla.org/Component_Development)是昨天才发布的——可能还有更多有用的信息，因为听起来组件对您来说可能比插件更有用。

# c - 如何从标准输入读取一行，阻塞直到找到换行符？

> ID：12252103
> 
> 赞同：36
> 
> 时间：2012-09-03T17:40:21.477
> 
> 标签：c, io

我正在尝试从命令行的标准输入一次读取任意长度的一行。我不确定我是否能够包含 GNU readline 并且更喜欢使用库函数。

我读过的文档表明它`getline`应该可以工作，但在我的实验中它不会阻塞。我的示例程序：

```
#include <stdio.h>
int main()
{
    char *line = NULL;
    if (getline(&line, NULL, stdin) == -1) {
        printf("No line\n");
    } else {
        printf("%s\n", line);
    }
    return 0;
} 
```

产生`No line`，这使得它不适合接受用户输入。

我该怎么做呢？我知道这应该是微不足道的，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-09-03T17:49:56.353

试试这个补丁

```
char *line = NULL;
+size_t size;
+if (getline(&line, &size, stdin) == -1) {
-if (getline(&line, 0, stdin) == -1) {
    printf("No line\n");
} else { 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-03T17:51:17.600

我已经能够在以下位置重现“非阻塞”行为`getline`：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
        char    *buffer;
        size_t  n = 1024;
        buffer = malloc(n);
        return getline(&buffer, &n, stdin);
} 
```

`getline(&buffer...`块。如果我分配`NULL`给`buffer`，它再次阻塞（如广告所示），并将该行存储在新分配的缓冲区中。

但如果我写

```
getline(NULL, &n, stdin); 
```

然后`getline`失败了，*似乎*没有阻塞。可能无效`n`或文件指针也可能导致相同的行为。这可能是问题吗？

# java - 所有组件的一个侦听器实例或每个组件的一个实例

> ID：12252106
> 
> 赞同：2
> 
> 时间：2012-09-03T17:40:46.440
> 
> 标签：java, swing

**简短的问题**

我想知道是否有关于为所有组件编写一个侦听器实例或为每个组件编写一个实例的良好实践建议。

**扩展问题**

我正在开发一个 java swing 应用程序。

在相同的形式中，我可以有十几个使用相同侦听器类的组件（它们之间没有关系）。我在他们自己的班级里写给我的每个听众。

侦听器用于对组件上引入的数据进行一些验证。

我应该为每个组件创建一个侦听器类的实例，还是应该为所有组件使用相同的侦听器实例。

除了这个没有指向任何参考的[评论](https://stackoverflow.com/questions/5936261/how-to-add-action-listener-that-listens-to-multiple-buttons#comment6841109_5936261)之外，我找不到任何关于此的良好实践建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:22:00.383

对于 的特殊情况`ActionListener`，使用 . 封装所需的功能[`Action`](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)。这个类在 Swing 中的广泛[使用](http://docs.oracle.com/javase/7/docs/api/javax/swing/class-use/Action.html)表明了它的价值。这个简单的[例子](https://stackoverflow.com/a/8534162/230513)说明了一些内置的文本组件动作；这个更详细的[示例](https://sites.google.com/site/drjohnbmatthews/graphpanel)显示了如何在菜单和工具栏之间共享操作。

`if-then-else`另一种方法是基于事件源的不断增长且难以维护的阶梯。

附录：啊，我看错了你的问题。@Andrew 的[评论](https://stackoverflow.com/questions/5936261/how-to-add-action-listener-that-listens-to-multiple-buttons#comment6841109_5936261)是关于*课程*的；你的问题是关于*实例*的。对于前者，单个侦听器倾向于向[已知的反模式](http://en.wikipedia.org/wiki/God_object)演变；引用的示例的早期版本说明了这个[问题](https://sites.google.com/site/drjohnbmatthews/graphpanel)。对于后者，只使用所需数量的实例；我通常会在探查器中发现最严重的违规行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T17:43:19.430

我认为最好的解决方案是使您的代码尽可能干净的解决方案。

基本上，如果只有一个实例不会使代码过于复杂，那么您可以只创建一个实例并在组件之间共享它。否则，您可以有多个实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:43:16.987

你应该选择一个让你的代码可读和可维护的。

如果创建实例使其更简单，请继续执行，但由于行为保持不变；我相信单个实例应该可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T17:47:41.847

你的想法真的很有趣…………

Moveover 如果它的 Swing ......那么它已经基于`MVC`架构......

`Model` **-**业务逻辑和数据

`View` **-**输出的表示

`Controller` **-**执行操作的位置。

现在我认为它也更好`Business Logic with its data together`，因此我们可以轻松地将逻辑与其相应的数据关联起来。

您始终可以为**common EventSource**使用一个**通用侦听**器，例如...**`JButton`**

 **你可以有 4 个`JButton`，它们**做不同的工作**，现在你可以有一个 `ActionListener`with`switch`语句......很容易处理......**

# c# - 安装 dll 后，类库未创建日志文件

> ID：12252111
> 
> 赞同：0
> 
> 时间：2012-09-03T17:41:33.527
> 
> 标签：c#

我创建了一个具有一些功能的类库并维护一个日志文件来跟踪执行的步骤。如果我在调试模式下运行这个类库，它会成功创建日志文件。

但是，我在创建该类库的 tlb 文件并安装到系统后创建了 cab 文件。现在我正在使用该库，所有功能都正常工作，只有日志文件没有写入。

我使用代码创建日志文件如下 -

```
 public static void LogTrace(string LogMessage)
    {
        try
        {

            string LogError = string.Empty;
            String DirPath = string.Empty;

            DirPath= Convert.ToString(ConfigurationSettings.AppSettings["DirPath"]);
            LogError = Convert.ToString(ConfigurationSettings.AppSettings["LogError"]);

            //if logging is not required
            if (LogError.ToLower() == "true")
            {
                if (DirPath == null || DirPath == string.Empty)
                    DirPath = @"C:\LogAndError";

                if (LogError == null || LogError == string.Empty)
                    LogError = "True";

                //creation of date wise file name

                string LogFileName = DirPath + "\\Log_ " + DateTime.Now.ToString("MM_dd_yyyy") + ".txt";
                createLogAndErrorFile(DirPath);

                    StreamWriter streamWriter = null;
                    streamWriter = new StreamWriter(LogFileName, true);
                    streamWriter.WriteLine("Time :" + DateTime.Now.ToString() + "  ");
                    streamWriter.WriteLine(LogMessage);
                    streamWriter.WriteLine(Environment.NewLine);
                    streamWriter.Flush();
                    streamWriter.Close();

            }
        }
        catch
        {
            //We are not throwing any exception because all the exeption is logged using this method
            //and throwing the exception could lead to recursive call of function.
        }
    }
    public static void createLogAndErrorFile(string DirPath)
    {
        if (!Directory.Exists(DirPath))
            Directory.CreateDirectory(DirPath);
    }
} 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:51:02.563

验证您是否有权访问您的文件

将您的代码放在 try catch 块中并捕获异常我建议您使用 using 块

```
try
{

           var path = Path.Combine(DirPath, string.Concat("\\Log_",DateTime.Now.ToString("MM_dd_yyyy"), ".txt"));

            using (StreamWriter streamWriter = new StreamWriter(path))
            {
                streamWriter.WriteLine("Time :" + DateTime.Now.ToString() + "  ");
                streamWriter.WriteLine(LogMessage);
                streamWriter.WriteLine(Environment.NewLine);

            }

}
catch(Exception ex)
{
   Console.Write(ex.Message);
   throw ex;
} 
```

# javascript - 在 replace() 中调用 ajax 函数

> ID：12252114
> 
> 赞同：7
> 
> 时间：2012-09-03T17:41:47.693
> 
> 标签：javascript, ajax, regex

我有一个包含 ajax 调用的函数：

```
function example(param, callback) {
    $.ajax({
        type: "GET",
        url: param,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        success: function(data) {
            // do something with data
            callback(data);
        }
    });
} 
```

我这样称呼它：

```
example("http://www.example.com", function(result) {
    // do something with result
}) 
```

**但是**，我想`example()`在这种情况下使用：

```
text.replace(/[regex not shown]/g, function(){
    return RegExp.$1 + example(RegExp.$2); // does not work
}); 
```

即，正则表达式找到多个匹配项，然后我将`example([whatever it matched])`. 有没有办法整合

```
example("http://www.example.com", function(result) {
    // do something with result
}) 
```

进入`text.replace()`？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:59:50.283

你不能。那是因为您将 a 传递给 .replace() 方法一个函数文字，因此 replace 方法将把该函数 .toString() 返回的字符串（其源代码）作为参数。

那是因为 .replace() 方法是同步的，并且不期望回调作为第二个参数，而是一个字符串，因此如果不是，它会将任何第二个参数转换为字符串。

如果您实际调用参数中的函数，导致您的函数没有定义的返回值，则会将“未定义”解析为第二个值。

但是您可以编写自己的异步替换方法并将其添加到 String 原型中。我无法在手机中编辑代码，所以当我回到电脑前，如果您还没有弄清楚，我会为您编写代码。

编辑：

其实我错了，你可以在replace方法中使用回调。问题是您在那里使用异步调用的方式。我不知道你到底想做什么，所以我希望这对你有帮助。

```
String.prototype.myReplace=function(re, o, p){
    var v=[];
    var t=this;
    t.toString().replace(re, function(m){
        if(m==RegExp.$1){v[1]=m;};
        if(m==RegExp.$2){v[2]=m;};
    });
    $.ajax({
        type: "GET",
        url: v[2],
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        success: function(data) {
            // do something with data

            o[p]=t.toString().replace(re, function(m){
                if(m==RegExp.$1){return v[1];};
                if(m==RegExp.$2){return data.toString();};
            });
        }
    });
}; 
```

并这样称呼它：

```
text.myReplace(/[regex not shown]/g, this/* or whatever object is */, 'text'}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T23:09:31.507

试试 ConversationJS：

[https://github.com/rhyneandrew/Conversation.JS](https://github.com/rhyneandrew/Conversation.JS)

它允许您以全新的方式进行函数调用，本质上是将调用绑定到事件，而不是进行显式调用。它将允许您以一种更加“解耦”的方式准确地完成您正在尝试做的事情，这意味着它在未来也将很容易更改和维护！请记住，嵌套依赖关系永远不会好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:13:48.047

朋友，我不太清楚你的问题......你可以试试下面的代码......不确定它是否有效......

```
function example(param, callback) {
    $.ajax({
        type: "GET",
        url: param,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        success: function(data) {
            // do something with data
            if(typeof callback!='undefined'){callback(data)}else{return data};
        }
    });
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T18:42:35.320

创建一个函数来进行 ajax 调用并处理正则表达式上匹配项的替换。根据您上面提供的内容，这是最模块化的方法，假设您要多次执行这些类型的替换。

```
function replaceTextAfterAjax(str, regex, matchSendToServer, fn) {
    var matches = regex.exec(str);
    var externUrl = matches[matchSendToServer];
    $.ajax({
        type: "GET",
        url: externUrl,
        contentType: "application/json; charset=utf-8",
        dataType: "jsonp",
        success: function(json) {
            fn(json.serverSideReplaceText, matches);
        },
    })
}

var text = "go to http://www.example.com";
replaceTextAfterAjax(text, /(go to) (.*)$/, 2, function(response, matches) {
    text = matches[1] + ' ' + response;
    // continue to use `text`
}); 
```

请注意，您应该通过调用`exec`正则表达式实例来保持对 RegExp 的本地使用。这使您的代码保持线程安全，并防止其他方法获取另一个调用的 RegExp.$N 值。

# java - 如何在包的子模块上编写 Maven 依赖项

> ID：12252116
> 
> 赞同：2
> 
> 时间：2012-09-03T17:42:37.147
> 
> 标签：java, maven, pom.xml

我刚开始迁移到 Maven，所以目前我没有 pom.xml。我的项目仅依赖于另一个不是我的项目的模块子集。他们在分发的 pom 中列出了模块列表。如何在我的 pom.xml 中声明对特定 jar（可能包含在下载的 jar 中）的依赖关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:53:21.360

如果您的其他项目被组织成带有自己的子 maven-modules `pom.xml`，那么这些子 maven-modules 的`<groupId>`, `<artifactId>`,`<version>`节点将与您的主项目一样包含在您的主项目中。

例如

```
project 1
  |- common
       |- pom.xml
          <groupId>com.project1</groupId>
          <artifactId>common</artifactId>
          <version>1.0</version>
  |- util
       |- pom.xml
          <groupId>com.project1</groupId>
          <artifactId>util</artifactId>
          <version>1.0</version>
  |- domain
       |- pom.xml
          <groupId>com.project1</groupId>
          <artifactId>domain</artifactId>
          <version>1.0</version>
  |- service
       |- pom.xml
          <groupId>com.project1</groupId>
          <artifactId>service</artifactId>
          <version>1.0</version>
  |- webapps
       |- pom.xml
          <groupId>com.project1</groupId>
          <artifactId>webapps</artifactId>
          <version>1.0</version> 
```

在项目 2 中，如果您只需要`common`、`util`和`domain`域模块，则该项目的 pom.xml 将包含以下依赖项：

```
<dependencies>

    ...

    <dependency>
          <groupId>com.project1</groupId>
          <artifactId>common</artifactId>
          <version>1.0</version>
    </dependency>
    <dependency>
          <groupId>com.project1</groupId>
          <artifactId>util</artifactId>
          <version>1.0</version>
    </dependency>
    <dependency>
          <groupId>com.project1</groupId>
          <artifactId>domain</artifactId>
          <version>1.0</version>
    </dependency>

    ...

</dependencies> 
```

希望这可以帮助！

# c++ - 如何检测窗口（gtk、qt 等）应用程序的内存泄漏？

> ID：12252121
> 
> 赞同：3
> 
> 时间：2012-09-03T17:43:07.400
> 
> 标签：c++, valgrind

我曾经使用 valgrind 来查找我的应用程序中的内存泄漏。但是当我使用 gtk/qt/glut 或任何“窗口”应用程序时，valgrind 就像一个邪恶的垃圾邮件。

我发现在这些库中没有真正的内存泄漏 - 但是如何检测真正的内存泄漏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T15:52:14.213

您可以使用[抑制文件](http://wiki.wxwidgets.org/Valgrind_Suppression_File_Howto)来消除您无法控制的第三方库中的警告。

# java - 尝试在 Eclipse 中创建新项目时出现“缺少构建路径条目”错误

> ID：12252123
> 
> 赞同：11
> 
> 时间：2012-09-03T17:43:16.480
> 
> 标签：java, eclipse, ubuntu

> 缺少构建路径条目：org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.7

在 Eclipse 中创建新项目时出现此错误。顺便说一句，我正在使用 Ubuntu。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2017-03-02T01:45:15.460

此错误是由 JRE 系统库引起的。也许您没有为运行 Eclipse 项目提供适当的 JRE。所以请按照以下步骤操作。

1.  右键单击项目并选择属性。
2.  单击左侧菜单中的 Java Build Path 选项。
3.  在 Java Build Path 窗口中，单击 Libraries 选项卡。
4.  确保列出了 JRE 系统库，如果未列出，则可以通过单击右侧菜单中的“添加库”来添加。
5.  因此，如果 JRE System Library 已经列出，那么 **双击JRE System Library 之前在****Java Build Path**窗口**Libraries**选项卡上显示错误。
6.  然后它将打开另一个名为**JRE System Library**的窗口。所以在那个窗口中选择**Alternate JRE**。从该下拉列表中选择您的 JRE。

就我而言，它是 java-8-openjdk-amd64 ，因为我使用的是 ubuntu 16.04。像这样，您也可以选择您的 JRE 系统库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-17T20:58:50.317

这是一个老问题，但我通过修改 JRE 系统库并在我的案例（Mac OSX）JRE 1.6 中选择一个有效的执行环境来解决它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-27T10:21:12.773

这是因为 JRE 不存在于项目的构建路径中。因此尝试从 Windows->Preferences->Installed JREs 添加 JRE 并添加默认 JRE。之后，JRE 默认添加到每个项目的构建路径中。这应该可以解决问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-02T08:44:57.637

我通过配置 .classpath 文件解决了这个问题。我使用 maven，并在下图所示的标记位置删除了带有一些无效设置的行。

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" output="target/classes" path="src">
        <attributes>
            <attribute name="optional" value="true"/>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.8">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.m2e.MAVEN2_CLASSPATH_CONTAINER">
        <attributes>
            <attribute name="maven.pomderived" value="true"/>
            <attribute name="org.eclipse.jst.component.dependency" value="/WEB-INF/lib"/>
        </attributes>
    </classpathentry>

    -----some files which is actually deleted in my project, I delete this line and all works fine------

    <classpathentry kind="output" path="target/classes"/>
</classpath> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-19T07:42:12.370

我已经安装了 JDK，但仍然有错误，所以我打开命令提示符将其定位到我的项目： `c:\project\proj>`. 然后我跑了`mvn clean && mvn install`。这解决了我的问题！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-17T12:11:24.267

尝试从运行正常的现有 java 项目中复制任何过去的两个文件（.classpath 和 .project），它存在于您的工作区中。

# javascript - 在 HTML 中，如果你第二次加载同一个脚本文件，它还会被加载吗？

> ID：12252125
> 
> 赞同：5
> 
> 时间：2012-09-03T17:43:19.290
> 
> 标签：javascript, html

假设您在 HTML 文件中有以下内容：

```
<script type="text/javascript" src="whatever.js"></script>
<script type="text/javascript" src="whatever.js"></script> 
```

将`whatever.js`被第二次加载，还是浏览器会看到它已经加载并跳过重新加载它？

注意：这对我来说是因为我正在使用包含其他代码片段的 HTML 模板，其中一些可能会加载相同的脚本，从而导致可能的重复。我想确保我的页面不会被重复的脚本加载所拖累。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:53:18.783

是的，它会重新加载它。您可以做的是检查当前脚本元素是否已经出现在您跟踪的“加载”列表中：http: [//jsfiddle.net/kvPcU/1/](http://jsfiddle.net/kvPcU/1/)。

在您获取文件之前，位于页面顶部的某处：

```
var loaded = {}; 
```

然后：

```
var elements = document.getElementsByTagName('script');
var currentElement = elements[elements.length - 1];  // element of currently executing script
if(!loaded[currentElement.src]) {
  loaded[currentElement.src] = true;
  // run code
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:57:28.000

这取决于“跳过”加载的含义。

如果您想避免两次访问服务器，那么在服务器上设置适当的缓存控制将避免文件被下载两次。

如果你想避免文件被执行两次，那么答案是否定的：浏览器不会跳过第二次执行文件。您可以通过将文件包装在一个巨大的“if”语句中并检查全局变量或 HTML 元素来测试文件之前是否已加载来解决此问题。

# c# - 如何设置文件权限以防止其他人对我的文件进行独占锁定？

> ID：12252127
> 
> 赞同：2
> 
> 时间：2012-09-03T17:43:23.363
> 
> 标签：c#, .net, file-locking

我想使用 C#/.NET 在 Windows 7 主机上打开文件以进行追加。为此，我想使用通常的文件输出操作。我找到了这样的解决方案：

```
FileStream trace_fd = new FileStream(r"c:\temp\testlog.txt", 
                                     FileMode.Append, 
                                     FileAccess.Write, 
                                     FileShare.ReadWrite) 
```

即使上面的程序启动并运行，我的跟踪文件也是可读的。从这样的正确代码中，我不再有文件被另一个进程使用的例外情况：

```
FileStream good_logreader_fd = new FileStream("c:\temp\testlog.txt", 
                                              FileMode.Read, 
                                              FileAccess.Read,
                                              FileShare.ReadWrite) 
```

然后我有另一个程序（错误日志扫描仪），其中包含这样的行：

```
FileStream bad_logreader_fd = new FileStream("c:\temp\testlog.txt", 
                                             FileMode.Read, 
                                             FileAccess.Read, 
                                             FileShare.None) 
```

这样的行显然是日志扫描器的错误。如果我的程序没有运行，那么错误的 logscaner 将获得排他锁，并且我的程序的后续运行将无法获取跟踪文件的 fd。

我的问题是我能做些什么来防止这种可怕的情况发生。例如，我可以为跟踪文件设置文件权限以防止任何人获得排他锁吗？如果是，那怎么办？还有什么可以保护我的程序免受错误日志扫描程序问题的影响吗？请注意，我必须在程序运行之间保持相同的跟踪文件名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:49:00.133

据我所知，您无法阻止其他人在不修改其代码的情况下尝试以另一种文件访问模式打开文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:35:33.470

您不能设置权限以允许对文件的任何访问，但以某种方式限制 FileShare.None，因为文件共享模式与访问权限无关。

权限使进程（基于它运行的帐户）访问文件/资源​​。如果授予访问权限的进程可以使用它想要的任何共享模式打开文件。如果此共享模式与文件请求成功时的现有共享模式不冲突，则文件将具有此共享模式（与以前的共享模式相结合）。有关详细信息，请参阅[CreateFile-dwShareMode 部分](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)。

在您的情况下，日志阅读器需要具有打开文件的权限，因此如果它是打开文件的第一个进程，它将能够设置 ShareMode.None。正如 devshorts 所说，除了更改违规过程或破解文件访问方法（搜索“hook CreateFile”）之外，您无能为力。

旁注：如果您的日志阅读器在与其他进程相同的帐户下运行，则权限将无济于事，因为 Windows 中没有“每个进程”权限，并且所有进程将共享相同用户的权限。

# objective-c - 在 iphone 上为 sqlite 将 json 转换为 const char

> ID：12252128
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:43:27.240
> 
> 标签：objective-c, ios, json, sqlite, nsdictionary

我在存储我正在下载的一些 json 数据时遇到问题。我认为的问题是从字符串到 json 再到 const char 的转换。也可能有更好的方法来做到这一点。这就是我所拥有的

```
 NSDictionary *jsonAll = [[(NSString *)response uppercaseString] JSONValue];
//Get the objects within the seat number object

NSDictionary *seatInfo = [jsonAll objectForKey:seatMessage];

//Split the objects up accoridng to the track information -- we will have to structure  
//we havethe maeesge with how ever many track

NSMutableString *Track1 = [seatInfo objectForKey:@"TRACK1'];
NSMutableString *Track2 = [seatInfo objectForKey:@"TRACK2"]; 
```

我带来的 json 文件看起来像这样

```
{A1 =     {
    TRACK1 =         (
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527,
        1462527
    );
    TRACK2 =         (
        12800016,
        12800016,
        12800016,
        12800016,
        12800016,
        1462527,
        12800016,
        12800016,
        12800016,
        12800016,
        12800016
    );
}; 
```

}

我认为问题在于新线路。据我所知，当我尝试将数据存储在 sql 中时，我必须将其转换为 const char。

有人知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:05:54.857

```
 NSDictionary *jsonAll = [[(NSString *)response uppercaseString] JSONValue]; 
```

//获取座位号对象内的对象

```
NSDictionary *seatInfo = [jsonAll objectForKey:seatMessage]; 
```

//根据轨道信息拆分对象——我们必须构造
//我们有多少轨道的maeesge

```
NSArray *Track1 = [seatInfo objectForKey:@"TRACK1'];

for(id str in Track1)
{
   //save the strings in database   
} 
```

# windows-phone-7 - WP7 - 多边形文本框

> ID：12252129
> 
> 赞同：0
> 
> 时间：2012-09-03T17:43:35.023
> 
> 标签：windows-phone-7, textbox, custom-controls

如何在 WP7 中创建图像文本框？

我不知道足够的表达式混合。！[类似于图像] 文本框形状，如 imageImage 链接：

![](../Images/6d04c473cbb988304ffcaee3986ffeaa.png)

# unity3d - 在unity3D中旋转塔喷嘴网格

> ID：12252134
> 
> 赞同：0
> 
> 时间：2012-09-03T17:44:26.903
> 
> 标签：unity3d, game-development, 3d-modelling

我正在 Unity 3D 中制作我的第一款游戏，类似于塔防游戏。我已经导入了一个塔的 Fbx 模型并将其附加到一个预制件上。现在我想让塔的喷嘴在敌人经过时旋转并跟随敌人。在我导入的 fbx 模型中，我有两个多边形网格，一个用于固定塔的底部，一个用于将旋转的塔顶部。现在我尝试用这两个网格创建两个不同的游戏对象，但是如果我把它们放在同一个点上，它们就会重叠。所以我必须进行手动对齐，以使喷嘴正确地位于底座上方。我想知道是否还有其他方法可以使整个塔保持为一个游戏对象，并且我可以旋转上部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T01:24:42.527

我确实设法解决了我的问题。不确定是否是最好的方法，但它有效。

为了升级塔并只改造喷嘴部分，我基本上是这样做的。

```
public class tryFbx : MonoBehaviour {
    public GameObject[] ModelPrefab;
    GameObject modelInstance;
    Renderer rn = new Renderer();

    // Attaching the model to prefab at runtime by creating a array of prefabs
    public void AttachModelToPrefab(GameObject modelPrefab) {
       modelInstance = GameObject.Instantiate(modelPrefab) as GameObject;
       modelInstance.transform.position = transform.position;
       modelInstance.transform.rotation = transform.rotation;

       // Attach the model instance to the prefab shell
       modelInstance.transform.parent = gameObject.transform;
   }

    void Start () {

    }

    // Update is called once per frame
    void Update () {
            if (GameManager.upgrade){
            AttachModelToPrefab(ModelPrefab[GameManager.towerUpgradeLevel]);
            foreach ( Renderer r in modelInstance.GetComponentsInChildren<Renderer>()){
                    // "polySurface98" is the name of the mesh I want to rotate. The tower and its upgrade have the same name.
                    if (r.name == "polySurface98") 
                    rn = r; 
             }
        // apply any transformation to the partial fbx
        rn.transform.Translate(1,1,1);
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:00:26.780

您可以创建游戏对象的层次结构；您将有一个代表塔的父 GameObject 和 2 个子对象，即您旋转其中一个。请注意，孩子的坐标将与父母的坐标相关，因此您对孩子所做的任何“混乱”手动校准都将被包含在内。

或者，更复杂的是，您可以只创建一个具有动画的网格并将其应用到一个 GameObject。

# php - 在 INSERT 语句中使用 mysql_fetch_array

> ID：12252140
> 
> 赞同：1
> 
> 时间：2012-09-03T17:44:47.857
> 
> 标签：php, mysql

我试图在另一个 mysql 查询中使用一个 mysql 查询的结果，但我显然做错了什么。这就是我所拥有的：

```
<?php
$result = mysql_query('SELECT panel_product_no 
        FROM panelProduct 
        WHERE length_mm = "' . ($_POST["p_length_mm"]) . '"
        AND width_mm = "' . ($_POST["p_width_mm"]) . '"
        AND veneer_type = "' . ($_POST["p_veneer"]) . '"
        AND lipping = "' . ($_POST["p_lipping"]) . '"');

$panel = mysql_fetch_array($result);
?> 
```

然后我想在这一点上使用它：

```
<?php
if(!empty($_POST[p_length_mm]) && !empty($_POST[p_width_mm]) && !empty($_POST[p_aperture]))
{
$sql3="INSERT INTO estimateDescribesPanelProduct (estimate_no, panel_product_no, quantity)

VALUES ('$_GET[estimate_no]','$panel','$_POST[p_quantity]')";

if (!mysql_query($sql3,$con))
  {
  die('Error: ' . mysql_error());
  }
}
?> 
```

该查询*基本上*是在将发布的estimate_no 和quantity 插入数据库中，但不是正确的panel_product_no（它只是插入'0'）。我怎样才能让它插入 $result 值？

PS 我知道我不应该使用 mysql 函数，而且我将来也不会使用，但是我几乎完成了这个项目，所以此时我没有改变位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:50:59.443

您基本上是将内容从一个表复制到另一个表。

为什么不使用 MySQL [INSERT .. SELECT](http://dev.mysql.com/doc/refman/5.0/en/insert-select.html)语法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:18:26.657

正如@Dmitry Makovetskiyd 所写，mysql_fetch_array() 返回一个资源，而不是可操作的结果。

例如：

```
$result = mysql_query('SELECT panel_product_no 
    FROM panelProduct 
    WHERE length_mm = "' . ($_POST["p_length_mm"]) . '"
    AND width_mm = "' . ($_POST["p_width_mm"]) . '"
    AND veneer_type = "' . ($_POST["p_veneer"]) . '"
    AND lipping = "' . ($_POST["p_lipping"]) . '"');

$resource = mysql_fetch_object($result); 
```

您需要添加：

```
$panel = $resource->'panel_product_no'; 
```

然后您可以继续您的第二个查询。

请注意从 mysql_fetch_array() 到 mysql_fetch_object() 的更改 - 因为您的查询表明您只是从表中检索一个奇异值（假设只有一个具有指定长度、宽度、单板类型和边缘的奇异面板），对象方法会正常工作。

# php - 致命错误：未捕获的异常“异常”，消息“字符串无法解析为 XML”

> ID：12252141
> 
> 赞同：2
> 
> 时间：2012-09-03T17:44:52.770
> 
> 标签：php, xml, curl

我正在使用 PHP 5 并尝试使用 cURL 从网页获取货币汇率。

要检索我调用的内容：

```
$html = curl_exec($ch); 
```

这将正确显示页面。但是，当我尝试使用以下方法将其格式化为 XML 时：

`$xml = new SimpleXMLElement($html);`

显示大量警告以“致命错误：未捕获的异常‘异常’，消息‘字符串无法解析为 XML’”结尾

我已经使用`stripslashes($html)`并关闭`magic_qoutes`...

请帮助我找到解决方案，过去 2 天我一直被这个问题困扰。

另请注意，页面中嵌入了 JavaScript。这是不允许创建 XML 的 JavaScript 吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-28T10:58:22.643

如果您不想读取 xml 数据，请按照以下步骤操作，

$xmlURL = "你的 xml url / 文件名放在这里";

```
try {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $xmlURL);
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(
        'Content-type: text/xml'
    ));
    $content = curl_exec($ch);
    $error   = curl_error($ch);
    curl_close($ch);
    $obj = new SimpleXMLElement($content);
    echo "<pre>";
    var_dump($obj);
    echo "</pre>"; 
}
catch(Exception $e){
    var_dump($e);exit;
} 
```

您将获得整个 XML 文件的数组格式。

谢谢。

# java - IndexOutOfBounds 使用 Javas imageio.write() 创建 png 格式的字节数组

> ID：12252143
> 
> 赞同：2
> 
> 时间：2012-09-03T17:44:56.263
> 
> 标签：java, exception, png, bytearray, javax.imageio

我正在使用`javax.imageio.ImageIO`将 a`BufferedImage b`写入字节数组，最后写入文件。创建字节数组时，10 次中有 1 次`java.lang.IndexOutOfBoundsException`抛出 a。但是，仅使用相同的图像是无法重现的。

```
BufferedImage img = ...
ByteArrayOutputStream baos = new ByteArrayOutputStream();
// the next line will lead to the exception being thrown
ImageIO.write(img, "png", baos);
byte[] byteArray = baos.toByteArray() 
```

结果是：

```
java.lang.IndexOutOfBoundsException
Line | Method
->>  166 | seek                       in
javax.imageio.stream.FileCacheImageOutputStream
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
|    227 | close                      in     ''
|   1570 | write . . . . . . . . . .  in javax.imageio.ImageIO 
```

我发现了一个[错误报告](http://bugs.sun.com/bugdatabase/view_bug.do;jsessionid=dc84943191e06dffffffffdf200f5210dd319?bug_id=6967419)，似乎描述了同样的问题。但是我找不到修复程序，尽管它是从 2010 年开始的。

有任何想法吗？变通？资源链接？

高度赞赏帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:29:33.737

这确实是一个[错误](http://bugs.sun.com/bugdatabase/view_bug.do;jsessionid=dc84943191e06dffffffffdf200f5210dd319?bug_id=6967419)。但是，如果您阅读报告，您会看到...

> 客户提交的解决方法：
> 
> 使用内存缓存。

尝试使用 a[`MemoryCacheImageOutputStream`](http://docs.oracle.com/javase/7/docs/api/javax/imageio/stream/MemoryCacheImageOutputStream.html)代替，直到*最终*消除错误。

```
ImageIO.write(img, "png", new MemoryCacheImageOutputStream(baos)); 
```

# objective-c - 解析类将最后一项写入两次

> ID：12252146
> 
> 赞同：1
> 
> 时间：2012-09-03T17:45:10.833
> 
> 标签：objective-c, ios, arrays, parsing, nsscanner

我很无奈。我解析这段文字...

```
<parse>HELLO</parse>
<parse>World</parse>
<parse>digit</parse>
<parse>wow</parse>
<parse>hellonewitem</parse>
<parse>lastitem</parse> 
```

使用 NSScanner 的实例：

```
 -(NSMutableArray *)parseTest
{

    if (parserTest != NULL)
    {

        NSScanner *scanner = [[NSScanner alloc] initWithString:parserTest];
        NSString *test;
        NSMutableArray *someArray = [NSMutableArray array];

        while ([scanner isAtEnd]!=YES)
        {

            [scanner scanUpToString:@"<parse>" intoString:nil];
            [scanner scanString:@"<parse>" intoString:nil];
            [scanner scanUpToString:@"</parse>" intoString:&test];
            [scanner scanString:@"</parse>" intoString:nil];

            [someArray addObject:test];

            NSLog(@"%@",test);

        }
        return someArray;
    } 
```

无法理解为什么我在返回的数组中两次获取最后一个对象。我错过了什么？是否有问题：

```
[scanner isAtEnd]!=Yes? 
```

谢谢你的帮助！

马蒂亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:26:51.533

检查 someArray 的计数，

```
NSLog(@"%d",[someArray count]); 
```

如果是 6，那么你在打印值时做错了。

否则，如果是 7，那么某个地方出了问题，需要排序

希望第一个条件成立。

# mysql - 如果单元格 MySQL 上存在字符串，则更新单元格内容

> ID：12252149
> 
> 赞同：0
> 
> 时间：2012-09-03T17:45:24.883
> 
> 标签：mysql, sql-update

我有一张有很多行的表（大约 1,500 行）。在 city_name 列中，一些单元格具有城市名称并以 (CD) 结尾。我希望那些带有 (CD) 的单元格在没有 (CD) 的情况下更新。这是我的表的预览：

```
+---------+-----------------------+---------+
| city_id | city_name             | id_dept |
+---------+-----------------------+---------+
|       1 | El Encanto (CD)       |       1 |
|       2 | La Chorrera (CD)      |       1 |
|       3 | La Pedrera (CD)       |       1 |
|       4 | La Victoria (CD)      |       1 |
|       5 | Leticia               |       1 |
|       6 | Miriti Parana (CD)    |       1 |
|       7 | Puerto Alegria (CD)   |       1 |
|       8 | Puerto Arica (CD)     |       1 |
|       9 | Puerto Nariño         |       1 |
|      10 | Puerto Santander (CD) |       1 |
+---------+-----------------------+---------+
10 rows in set (0.00 sec) 
```

这就是我想要的：

```
+---------+-----------------------+---------+
| city_id | city_name             | id_dept |
+---------+-----------------------+---------+
|       1 | El Encanto            |       1 |
|       2 | La Chorrera           |       1 |
|       3 | La Pedrera            |       1 |
|       4 | La Victoria           |       1 |
|       5 | Leticia               |       1 |
|       6 | Miriti Parana         |       1 |
|       7 | Puerto Alegria        |       1 |
|       8 | Puerto Arica          |       1 |
|       9 | Puerto Nariño         |       1 |
|      10 | Puerto Santander      |       1 |
+---------+-----------------------+---------+
10 rows in set (0.00 sec) 
```

好吧，我知道我可以使用 (CD) 选择所有行：

```
SELECT * FROM city WHERE city_name LIKE ( "%(CD)%" ) 
```

但是如何删除（CD）：

```
UPDATE city SET city_name = "" WHERE city_name LIKE( "%(CD)%" ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:50:53.300

您可以使用该`REPLACE()`功能

```
UPDATE city SET city_name = REPLACE(city_name, '(CD)', '') 
WHERE city_name LIKE( "%(CD)%" ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:52:03.480

如果它总是以 " (CD)" 结尾并且你想把它们从末尾砍掉，你可以这样做：

```
UPDATE city
SET city_name = LEFT(city_name, CHAR_LENGTH(city_name) - 5)
WHERE city_name LIKE '% (CD)'; 
```

# java - 链接到 api 源的 Javadoc

> ID：12252151
> 
> 赞同：0
> 
> 时间：2012-09-03T17:45:36.263
> 
> 标签：java, api, javadoc

你知道 javadoc api 库有超链接到每个 api 方法的来源的网站吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T17:53:46.973

Guava [API 文档](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/index.html)链接到源代码。您只需要使用 javadoc 的[-linksource 选项](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/javadoc.html#linksource)即可。我希望更多的开源项目使用这个选项。

# php - imagecreatefromjpeg 显示空白图像

> ID：12252153
> 
> 赞同：1
> 
> 时间：2012-09-03T17:45:45.610
> 
> 标签：php, thumbnails

我在 html 中使用以下代码调用 php 文件来创建缩略图并在此页面上显示 &w=150&h=&00" alt="Image" />

micro.php 的代码如下：

```
 <?php

     function redimensionner_image($chemin_image, $largeur_max, $hauteur_max)
    {
list($src_w, $src_h) = getimagesize($chemin_image);
$dst_w = $largeur_max;
$dst_h = $hauteur_max;

if($src_w < $dst_w)
    $dst_w = $src_w;

// Teste les dimensions tenant dans la zone
$test_h = round(($dst_w / $src_w) * $src_h);
$test_w = round(($dst_h / $src_h) * $src_w);

if(!$dst_h)// Si Height final non précisé (0)
    $dst_h = $test_h;
elseif(!$dst_w) // Sinon si Width final non précisé (0)
    $dst_w = $test_w;
elseif($test_h>$dst_h) // Sinon teste quel redimensionnement tient dans la zone
    $dst_w = $test_w;
else
    $dst_h = $test_h;

$array_ext = explode('.', $chemin_image);
$extension = strtolower($array_ext[count($array_ext)-1]);

if($extension == 'jpg' || $extension == 'jpeg')
   $img_in = imagecreatefromjpeg($chemin_image);
else if($extension == 'png')
   $img_in = imagecreatefrompng($chemin_image);
else if($extension == 'gif')
   $img_in = imagecreatefromgif($chemin_image);
else
    return false;

$img_out = imagecreatetruecolor($dst_w, $dst_h);
imagecopyresampled($img_out, $img_in, 0, 0, 0, 0, $dst_w, $dst_h, imagesx($img_in), imagesy($img_in));

imagejpeg($img_out);
     }

      ?> 
```

但是，Imagecreatefromjpeg 调整大小后返回黑色图像。请提供任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:09:03.087

首先，您不需要分解文件扩展名，因为它`getimagesize`会给您类型：

```
list($width, $height, $type) = getimagesize($source); 
```

接下来我不按照你的尺寸计算，尽量简化它们，fe：

```
$scale = min($maxWidth / $width, $maxHeight / $height, 1); // We only use downsampling, no upsampling! If you need upsampling remove the '1' parameter

$newWidth = min($width * $scale, $maxWidth);
$newHeight = min($height * $scale, $maxHeight); 
```

简单的重新缩放并保留纵横比。

作为参考，这是我在项目中使用的代码：

```
function SaveImageAsJpeg($sourceFilename, $destFilename, $maxWidth = 0, $maxHeight = 0, $jpegQuality = 80) {
    list($width, $height, $type) = getimagesize($sourceFilename);

    $sourceImage = false;

    switch ($type) {
        case IMAGETYPE_GIF:
            $sourceImage = imagecreatefromgif($sourceFilename); 
            break;
        case IMAGETYPE_JPEG:
            $sourceImage = imagecreatefromjpeg($sourceFilename);
            break;
        case IMAGETYPE_PNG:
            $sourceImage = imagecreatefrompng($sourceFilename);
            break;
    }

    if (!$sourceImage)
        return false;

    if (($maxWidth == 0) || ($maxHeight == 0)) {
        // Don't resize
        $destinationImage = imagecreatetruecolor($width, $height);
        imagecopy($destinationImage, $sourceImage, 0, 0, 0, 0, $width, $height);
        imagejpeg($destinationImage, $destFilename, $jpegQuality);
        imagedestroy($destinationImage);
    } else {
        // Resize image
        $scale = min($maxWidth / $width, $maxHeight / $height, 1);  // We only use downsampling, no upsampling! If you need upsampling remove the '1' parameter

        $newWidth = min($width * $scale, $maxWidth);
        $newHeight = min($height * $scale, $maxHeight);

        $destinationImage = imagecreatetruecolor($newWidth, $newHeight);
        imagecopyresampled($destinationImage, $sourceImage, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);
        imagejpeg($destinationImage, $destFilename, $jpegQuality);
        imagedestroy($destinationImage);
    }

    imagedestroy($sourceImage);

    return true;
} 
```

当然，上面的代码不会返回图像数据。它只是将重新缩放的图像保存到服务器上的另一个文件中。但是如果你`NULL`作为`$destFilename`参数传递，它会将图像数据输出到输出流：

```
header('Content-Type: image/jpeg');
SaveImageAsJpeg($sourceFilename, NULL, 200, 200); 
```

如果您仍然得到黑色图像，我建议增加 PHP 内存限制。如果可以修改`PHP.INI`，请调整`memory_limit`设置。否则，使用`.htaccess`带有此行的文件 fe: `php_value memory_limit 64M`。

# php - Wordpress 如何检测纯文本内容？

> ID：12252154
> 
> 赞同：0
> 
> 时间：2012-09-03T17:45:45.890
> 
> 标签：php, wordpress, browser, wordpress-theming

我在下面粘贴的代码来自第二十一主题的*header.php*。我只想知道要查找哪个功能来检测纯文本内容？

```
<nav id="access" role="navigation">
<h3 class="assistive-text"><?php _e( 'Main menu', 'twentyeleven' ); ?></h3>
<?php /* Allow screen readers / text browsers to skip the navigation menu 
         and get right to the good stuff. */ ?>
<div class="skip-link">
  <a class="assistive-text" href="#content" 
     title="<?php esc_attr_e( 'Skip to primary content', 'twentyeleven' ); ?>">
    <?php _e( 'Skip to primary content', 'twentyeleven' ); ?>
  </a>
</div>
<div class="skip-link">
  <a class="assistive-text" href="#secondary" 
     title="<?php esc_attr_e( 'Skip to secondary content', 'twentyeleven' ); ?>">
      <?php _e( 'Skip to secondary content', 'twentyeleven' ); ?>
    </a>
</div>
<?php /* Our navigation menu. If one isn't filled out, wp_nav_menu falls back 
      to wp_page_menu. The menu assigned to the primary location is the one used. 
      If one isn't assigned, the menu with the lowest ID is used. */ ?>
<?php wp_nav_menu( array( 'theme_location' => 'primary' ) ); ?>
</nav><!-- #access --> 
```

我问的原因是我正在使用我正在处理的主题测试此代码，并且它的行为就好像我的主题是纯文本的，即使页面有图像等。此外，它是 Windows 上的 Firefox，所以很明显浏览器没问题（也在 Chrome 中检查过）。所以基本上我试图找出使它看起来好像是“纯文本”或如何执行此代码的标准。
我还查看了各种 .js 文件，但那里什么也没看到。似乎这是用 PHP 完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:04:49.223

我将不得不同意安德烈亚斯的观点。当东西看起来仍然是 1991 年时，我开始的第一个地方是 css。您的所有样式表是否正确链接？Wordpress 在样式表和脚本链接方面可能会变得棘手，因为有很多 php 调用正在进行。

您可以尝试编辑头文件以包含这部分 PHP。后面是您的博客模板目录根目录中的任何文件地址。

```
<?php bloginfo('template_directory'); ?> 
```

我能想到的唯一另一件事是，由于某种原因，您的网站在查看是否通过屏幕阅读器查看该网站时出现故障，这将迫使它只显示文本。您可以尝试删除那段代码，看看是否可行。但这仍然表明您的主题的那部分有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:25:29.287

听起来更像是您的图像 URL 错误？

您可能会在[Wordpress Answers](https://wordpress.stackexchange.com/)获得更多答案。

# windows - mfc 组合框添加字符串

> ID：12252155
> 
> 赞同：0
> 
> 时间：2012-09-03T17:45:59.183
> 
> 标签：windows, mfc, combobox, registry, serial-port

```
HKEY hKey = 0;
DWORD dwType = REG_SZ;
TCHAR buf[255] = {0};
DWORD dwBufSize = sizeof(buf);
DWORD ret;
CComboBox m_portCombo;

if( RegOpenKeyEx( HKEY_LOCAL_MACHINE, TEXT("HARDWARE\\DEVICEMAP\\SERIALCOMM"), 0, KEY_QUERY_VALUE, &hKey ) == ERROR_SUCCESS )
{
    if( RegQueryValueEx( hKey, TEXT("\\Device\\Serial0"), 0, &dwType, (LPBYTE)buf, &dwBufSize ) == ERROR_SUCCESS )
    {
        CString str = buf;
        m_portCombo.AddString(str);
    }

    if( RegQueryValueEx( hKey, TEXT("\\Device\\Serial1"), 0, &dwType, (LPBYTE)buf, &dwBufSize ) == ERROR_SUCCESS )
    {
        CString str = buf;
    }

    if( RegQueryValueEx( hKey, TEXT("\\Device\\Serial2"), 0, &dwType, (LPBYTE)buf, &dwBufSize ) == ERROR_SUCCESS )
    {
        CString str = buf;
    }

    if( RegQueryValueEx( hKey, TEXT("\\Device\\Serial3"), 0, &dwType, (LPBYTE)buf, &dwBufSize ) == ERROR_SUCCESS )
    {
        CString str = buf;
    }
} 
```

**第一个问题**：我想用类似的`TEXT("\\Device\\Serial3")`东西来改变`TEXT("\\Device\\Serial",%i)`，所以我可以将所有的代码行恢复到一个`for`循环中。有没有办法做到这一点？

**第二个问题**：如果我使用`m_portCombo.AddString(str);`我得到一个`Debug Assertion Failed!`错误，当然，组合框没有填充该注册表值。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T05:35:13.307

第一个问题：使用 CString Format() 函数，将 %d 用于整数。

```
for (int i =0 ; i<10; i++)
{
    CString szPath;
    szPath.Format(TEXT("\\Device\\Serial%d"),i);
    // ...
} 
```

第二个问题：失败的原因可能有很多。最有可能的是尚未创建组合框。（它需要一个窗口句柄才能添加字符串）要找出调试断言的原因，请单击“调试断言失败”窗口上的“重试”按钮，然后它应该跳转到导致断言的代码。例如，它可能是这样的：

```
ASSERT(GetSafeHwnd()!=NULL); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T09:05:16.980

在调用第一个 DoDataExchange 之前，您的组合框类不会被“子类化”（并且在此之前使用它的任何尝试都将断言）。要么等到基类运行 OnInitDialog，要么执行以下操作：

```
CComboBox * pcombo = static_cast<CComboBox*>(GetDlgItem( IDC_MYCOMBO ));
pcombo->AddString( szPath ); 
```

请参阅@TheSteve 对字符串问题的回答。

# javascript - 如何使这 2 个 jquery 插件工作？

> ID：12252160
> 
> 赞同：1
> 
> 时间：2012-09-03T17:46:15.500
> 
> 标签：javascript, jquery, image, slider, lightbox

我正在制作一个带有灯箱的图像滑块，但由于我找不到任何具有这两种功能的简单插件，我必须将它与 2 个 jquery 插件混合使用，但它从不工作。我可以在同一页面上使用两个 jquery 插件吗？

这是我的html代码：

```
<script src="js/jquery.min.js"></script>
    <script src="js/jquery.colorbox.js"></script>

    <script>
        $(document).ready(function(){

            $(".slider").colorbox({rel:'slider', slideshow:true});

            $(".callbacks").colorbox({
                onOpen:function(){ alert('onOpen: colorbox is about to open'); },
                onLoad:function(){ alert('onLoad: colorbox has started to load the targeted content'); },
                onComplete:function(){ alert('onComplete: colorbox has displayed the loaded content'); },
                onCleanup:function(){ alert('onCleanup: colorbox has begun the close process'); },
                onClosed:function(){ alert('onClosed: colorbox has completely closed'); }
            });

            //Example of preserving a JavaScript event for inline calls.
            $("#click").click(function(){ 
                $('#click').css({"background-color":"#f00", "color":"#fff", "cursor":"inherit"}).text("Open this window again and this message will still be here.");
                return false;
            });
        });

    </script>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/easySlider1.5.js"></script>
<script type="text/javascript">
    $(document).ready(function(){   
        $("#slider").easySlider({
            auto: true,
            continuous: true 
        });
    }); 

</script>

<div id="container">

<div id="header"></div>

<div id="content">

<div id="slider">
        <ul>                
            <li><a class="slider" href="images/01.jpg"><img src="images/01.jpg" alt="Css Template Preview" /></a></li>
            <li><a class="slider" href="images/02.jpg"><img src="images/02.jpg" alt="Css Template Preview" /></a></li>
            <li><a  class="slider"href="images/03.jpg"><img src="images/03.jpg" alt="Css Template Preview" /></a></li>
            <li><a class="slider" href="images/04.jpg"><img src="images/04.jpg" alt="Css Template Preview" /></a></li>
            <li><a  class="slider"href="images/05.jpg"><img src="images/05.jpg" alt="Css Template Preview" /></a></li>          
        </ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:31:11.020

它不起作用的原因不是因为您包含了两个 jquery 插件。但是因为你已经包含了 jquery 文件两次。删除一个，它会工作

在这里你应该包括

```
<script src="js/jquery.min.js"></script> 
```

并删除这个

```
<script type="text/javascript" src="js/jquery.js"></script> 
```

# jquery - 动态调整 JQuery 插件的大小

> ID：12252161
> 
> 赞同：1
> 
> 时间：2012-09-03T17:46:16.247
> 
> 标签：jquery, plugins, resize, window

我使用这个插件（http://spaceforaname.com/galleryview/）。我可以轻松地设置它并配置一些参数。我无法开始工作的是在 javascript 触发方法上调整此插件的大小。换句话说 ：

```
<script type="text/javascript">
    $(function(){
    $('#myGallery').galleryView({
        panel_width: 850,
        panel_height: 350,
        autoplay : true,
        transition_interval: 2000,
        frame_height:0,
        show_filmstrip:false
    });
    });
</script> 
```

我必须改变的是 panel_width。请帮忙

# vb.net - 如何在 VB 中使用 Directory.GetFiles？

> ID：12252164
> 
> 赞同：3
> 
> 时间：2012-09-03T17:47:16.950
> 
> 标签：vb.net

我基本上遵循一个MS示例。以下是示例。

```
Imports System
Imports System.IO

Public Class Test
Public Shared Sub Main()
    Try 
        ' Only get files that begin with the letter "c." 
        Dim dirs As String() = Directory.GetFiles("c:\", "c*")
        Console.WriteLine("The number of files starting with c is {0}.", dirs.Length)
        Dim dir As String 
        For Each dir In dirs
            Console.WriteLine(dir)
        Next 
    Catch e As Exception
        Console.WriteLine("The process failed: {0}", e.ToString())
    End Try 
End Sub 
End Class 
```

我稍作修改，以便可以将其用作文件搜索功能。但是，“For Each f In Directory.GetFiles(d, FileName)”处有错误。我做错了什么？

```
 Public Sub DirSearch(ByVal sDir As String, ByVal FileName As String)
    Dim d As String
    Dim f As String

    Try
        For Each d In Directory.GetDirectories(sDir)
            For Each f In Directory.GetFiles(d, FileName)
                If f = FileName Then
                    Form1.TextBox4.Text = "1"
                Else
                    Form1.TextBox4.Text = "0"
                End If
            Next
            DirSearch(d, FileName)
        Next
    Catch excpt As System.Exception
        Debug.WriteLine(excpt.Message)
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T03:49:06.917

我找到了，这解决了我的问题

```
Public Sub DirSearch(ByVal sDir As String, ByVal FileName As String)
    For Each foundFile As String In My.Computer.FileSystem.GetFiles(sDir, FileIO.SearchOption.SearchAllSubDirectories, FileName)
       "Do the work here"
    Next
End Sub 
```

# wpf - 无法绑定到我的 ViewModel 的集合

> ID：12252166
> 
> 赞同：1
> 
> 时间：2012-09-03T17:47:25.307
> 
> 标签：wpf, xaml, mvvm

全部 - 尝试做两件事：我有一个简单的应用程序，并试图将我的 Viewmodel 集合绑定到我的视图。有两种方法，但我都陷入了困境：

方法一：使用 Grid 作为容器来绑定 textblock 属性。

方法 2：将对象的属性直接绑定到我视图上的文本块（不使用网格作为容器及其 ​​Datacontext 属性）

**Rule_Model_1.cs**

```
public class Rule_Model_1
{
    public string topMessage { get; set; }
    public List<string> recipients { get; set; }
    public string bottomMessage { get; set; }
    public string hypLink { get; set; }
    public OCCBlock blockType { get; set; }

    public enum OCCBlock
    {
        HardBlock,
        SoftBlock,
        ModifyAndSend
    }
} 
```

**Rule_VM_1.cs**

```
class Rule_VM_1
{
    #region Properties
    public List<Rule_Model_1> rule { get; set; }
    #endregion

    #region Constructor
    public Rule_VM_1()
    {
        #region Initializing a Rule
        rule = new List<Rule_Model_1>();

        rule.Add(new Rule_Model_1()
        {
            topMessage = "Lorem ipsum dolor sit amet.",
            recipients = new List<string> {"pr@hotmail.com", "pra@gmail.com"},
            bottomMessage = "Lorem ipsum dolor sit amet",
            hypLink = "http://www.abc.com",
            blockType = Rule_Model_1.OCCBlock.HardBlock
        });
        #endregion
    }
    #endregion
} 
```

**Rule_UI.xaml.cs**

```
public partial class Rule_UI_1 : UserControl
{
    Rule_VM_1 rulevm1;
    public Rule_UI_1()
    {
        InitializeComponent();
        rulevm1 = new Rule_VM_1();
        DataContext = rulevm1; 
    }
} 
```

**Rule_UI.xaml**

```
 <UserControl x:Class="OCC_WPF_POC.Rule_UI_1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d">
<GroupBox Header="Rule Details">
    <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"></ColumnDefinition>
            <ColumnDefinition Width="*"></ColumnDefinition>
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="1" DataContext="{Binding rule}">
            <Grid.RowDefinitions>
                <RowDefinition Height="50"></RowDefinition>
                <RowDefinition Height="200"></RowDefinition>
                <RowDefinition Height="50"></RowDefinition>
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="{Binding topmessage}" />
        </Grid>
    </Grid>
</GroupBox> 
```

该视图仍然没有显示任何内容。同样如上所述 - 我如何让这两种方法都起作用？非常感谢任何代码示例

附图片![窗口图像](../Images/30f54e6abf361dfdc9256ae034cee164.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:54:18.663

问题是您需要一个列表视图来绑定到集合属性 ( `rule`)。这应该有效：

```
<ListBox Grid.Column="1" ItemsSource="{Binding rule}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding topmessage}" />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

要绑定到网格，您可以`DataContext`使用索引器进行设置`[]`：

```
<Grid Grid.Column="1" DataContext="{Binding rule[0]}">
    <TextBlock Grid.Row="0" Text="{Binding topmessage}" />
</Grid> 
```

没有网格：

```
<TextBlock Text="{Binding rule[0].topmessage}" /> 
```

# asp.net-mvc-4 - Entity Framework Code First - 在自定义表中使用 Memberships/Users 表的 UserId 键作为外键

> ID：12252168
> 
> 赞同：1
> 
> 时间：2012-09-03T17:47:37.717
> 
> 标签：asp.net-mvc-4, entity-framework-5

我正在尝试创建一个`SQL`表以包含其他用户信息。我希望它由 VS2012 中的 Migrations 创建`(package console => update-database)`。

我看到有两个表使用 UserId 列作为键：`Memberships and Users tables.`

我正在尝试定义以下类并通过 Migrator 将其映射到 SQL 表：

```
 [Key]
    [Column(Order = 0)]
    [ForeignKey("User")]
    public Guid **UserId** { get; set; }

    [Key]
    [Column(Order = 1)]
    [ForeignKey("Category")]
    public int CategoryId { get; set; }

    public virtual Category Category { get; set; }
    **public virtual User User { get; set; }** 
```

尽管在用户 SQL 表中很明显 UserId 列是键，但我收到以下错误消息：

```
\tSystem.Data.Entity.Edm.EdmEntityType: : EntityType 'User' has no key defined. Define the key for this EntityType.
\tSystem.Data.Entity.Edm.EdmEntitySet: EntityType: EntitySet 'Users' is based on type 'User' that has no keys defined. 
```

我在这里缺少什么？可能是`Microsoft.VisualBasic.ApplicationServices.User / System.Web.Security.MembershipUser`类不一定以这种方式映射到表，反之亦然，因此`UserId`未声明该属性是 Key dataannotation？

我对这个问题的其他解决方案持开放态度。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:42:26.833

我目前正在将 asp.net mvc4 与 Azure db 一起使用。

当我想在 UserProfile 的其他表中使用 UserId 时。注意 AccountModels 中有类 UserProfile：

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
} 
```

现在，假设您的类别是由某个用户创建的，您可以通过以下方式将类别条目链接到用户。

```
[Table("Category")]
public class Category
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int CategoryId { get; set; }
    public UserProfile CreatorUserId { get; set; }
} 
```

否则，您始终可以使用 UserProfile 作为模型。

# javascript - 使用 JavaScript 的 Ajax 日历日期范围

> ID：12252171
> 
> 赞同：1
> 
> 时间：2012-09-03T17:47:45.050
> 
> 标签：javascript, asp.net, ajax, calendar, nan

我有以下代码来比较两个日期与以下条件

> 设想：

1.  加载时有两个带有 Ajax 日历扩展器的文本框（FromDate、ToDate）。
2.  On load From Date 显示今天的日期。
3.  当在两个文本框（FromDate，ToDate）中选择小于今天的日期时，它会提醒用户说“您不能选择比今天早的一天！”
4.  当 ToDate 的选定日期 < FromDate 的选定日期时，提醒用户说“To Date must be Greater than From date”。并同时清除 ToDate 文本框中选定的日期。

> 代码块：
> 
> ASP.NET , AJAX

```
 <asp:TextBox ID="txtFrom" runat="server"
                    ReadOnly="true"></asp:TextBox>
                <asp:ImageButton ID="imgBtnFrom" runat="server" ImageUrl="~/images/Cal20x20.png" Width="20" Height="20" ImageAlign="TextTop" />
                <asp:CalendarExtender ID="txtFrom_CalendarExtender" PopupButtonID="imgBtnFrom"
                    runat="server" Enabled="True" 
                    OnClientDateSelectionChanged="checkDate"
                    TargetControlID="txtFrom" Format="MMM d, yyyy">
                </asp:CalendarExtender>
                <asp:TextBox ID="txtTo" runat="server" 
                    ReadOnly="true"></asp:TextBox>
                <asp:ImageButton ID="imgBtnTo" runat="server" ImageUrl="~/images/Cal20x20.png" Width="20" Height="20" ImageAlign="TextTop" />
                <asp:CalendarExtender ID="txtTo_CalendarExtender"   
                    OnClientDateSelectionChanged="compareDateRange"
                    PopupButtonID="imgBtnTo"
                    runat="server" 
                    Enabled="True" TargetControlID="txtTo"
                    Format="MMM d, yyyy">
                </asp:CalendarExtender>
<asp:HiddenField ID="hdnFrom" runat="server" />
<asp:HiddenField ID="hdnTo" runat="server" /> 
```

> C# 代码

```
protected void Page_Load(object sender, EventArgs e)
    {
        txtFrom.Text = string.Format("{0: MMM d, yyyy}", DateTime.Today);
        if (Page.IsPostBack)
        {
            if (!String.IsNullOrEmpty(hdnFrom.Value as string))
            {
                txtFrom.Text = hdnFrom.Value;
            }
            if (!String.IsNullOrEmpty(hdnTo.Value as string))
            {
                txtTo.Text = hdnTo.Value;
            }
        }
    } 
```

> JavaScript 代码

```
<script type="text/javascript">
        function checkDate(sender, args) {
            document.getElementById('<%=txtTo.ClientID %>').value = "";
            if (sender._selectedDate < new Date()) {
                alert("You cannot select a day earlier than today!");
                sender._selectedDate = new Date();
                // set the date back to the current date
                sender._textbox.set_Value(sender._selectedDate.format(sender._format));
                //assign the value to the hidden field.
                document.getElementById('<%=hdnFrom.ClientID %>').value = sender._selectedDate.format(sender._format);
                //reset the to date to blank.
                document.getElementById('<%=txtTo.ClientID %>').value = "";
            } else {
                document.getElementById('<%=hdnFrom.ClientID %>').value = sender._selectedDate.format(sender._format);
            }
        }
        function compareDateRange(sender, args) {
            var fromDateString = document.getElementById('<%=txtFrom.ClientID %>').value;
            var fromDate = new Date(fromDateString);
            if (sender._selectedDate < new Date()) {
                alert("You cannot select a Date earlier than today!");
                sender._selectedDate = "";
                sender._textbox.set_Value(sender._selectedDate)
            }
            if (sender._selectedDate <= fromDate) {
                alert("To Date must be Greater than From date.");
                sender._selectedDate = "";
                sender._textbox.set_Value(sender._selectedDate)
            } else {
                document.getElementById('<%=hdnTo.ClientID %>').value = sender._selectedDate.format(sender._format);
            }
        }
    </script> 
```

> 错误屏幕（嗯：X）

现在在 ToDate 中，当您选择日期早于今天或日期小于 FromDate 时，ToDate 日历显示每个日期的 NaN 和年份的 ,0NaN

![在此处输入图像描述](../Images/a27b662817eb65ab29486cd2ebe3c83d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T01:13:55.003

看起来该`format`方法假设一个数字参数，但正在传递一个字符串参数。注释掉两个`else`块以确认这一点。由于以下原因，这些`if`块似乎总是返回：`false`

*   由于这两个日期是字符串，所以比较的是它们的长度，而不是它们的日期
*   在每个日期上使用[Date.parse()进行数字比较](http://msdn.microsoft.com/en-us/library/ie/ff743760)
*   使用硬编码值验证您的[日期格式](http://dygraphs.com/date-formats.html)，例如 Date.parse("May 1, 1999")

# python - openerp 移动应用程序

> ID：12252173
> 
> 赞同：1
> 
> 时间：2012-09-03T17:47:49.237
> 
> 标签：python, mobile, openerp

试用使用 jquery mobile 构建的 openERP 6.1 内置移动应用程序。
我有自己的模块“school.student”，当我点击学生时，我看到学生树，当我点击任何特定学生时，我得到错误

```
File "/opt/openerp/server/openerp/osv/fields.py", line 551, in get
    ids2 = obj.pool.get(self._obj).search(cr, user, 
                           self._domain + [(self._fields_id, 'in', ids)], 
                           limit=self._limit, context=context) 
```

`AttributeError: 'NoneType' object has no attribute 'search'` 好像它没有获取这里有问题的对象是`school.student`

通过 web 或 gtk 客户端没有类似的错误，只有新的移动客户端。
访问任何其他对象（例如 school.course 甚至`school.course.subjects`. 只是那个不打开的 school.student 表单视图。关于为什么会发生这种情况的任何想法？

编辑：追溯

`2012-09-07 13:57:47,199 17516 INFO ? werkzeug: 192.168.100.106 - - [07/Sep/2012 13:57:47] "GET /favicon.ico HTTP/1.1" 404 -`
`> /opt/openerp/server/openerp/osv/fields.py(554)get()`
`-> for r in obj.pool.get(self._obj)._read_flat(cr, user, ids2, [self._fields_id], context=context, load='_classic_write'):`
`(Pdb) ids2`
`[]`
`(Pdb) c`
`> /opt/openerp/server/openerp/osv/fields.py(554)get()`
`-> for r in obj.pool.get(self._obj)._read_flat(cr, user, ids2, [self._fields_id], context=context, load='_classic_write'):`
`(Pdb) ids2`
`[]`
`(Pdb) c`
`> /opt/openerp/server/openerp/osv/fields.py(554)get()`
`-> for r in obj.pool.get(self._obj)._read_flat(cr, user, ids2, [self._fields_id], context=context, load='_classic_write'):`
`(Pdb) ids2`
`[]`
`(Pdb) c`
`2012-09-07 13:58:03,198 17516 ERROR ? openerp.osv.osv: Uncaught exception`
`Traceback (most recent call last):`
`File "/opt/openerp/server/openerp/osv/osv.py", line 121, in wrapper`
`return f(self, dbname, *args, **kwargs)`
`File "/opt/openerp/server/openerp/osv/osv.py", line 176, in execute`
`res = self.execute_cr(cr, uid, obj, method, *args, **kw)`
`File "/opt/openerp/server/openerp/osv/osv.py", line 164, in execute_cr`
`return getattr(object, method)(cr, uid, *args, **kw)`
`File "/opt/openerp/server/openerp/osv/orm.py", line 3381, in read`
`result = self._read_flat(cr, user, select, fields, context, load)`
`File "/opt/openerp/server/openerp/osv/orm.py", line 3504, in _read_flat`
`res2 = self._columns[f].get(cr, self, ids, f, user, context=context, values=res)`
`File "/opt/openerp/server/openerp/osv/fields.py", line 552, in get`
`ids2 = obj.pool.get(self._obj).search(cr, user, self._domain + [(self._fields_id, 'in', ids)], limit=self._limit, context=context)`
`AttributeError: 'NoneType' object has no attribute 'search'`
`2012-09-07 13:58:03,202 17516 ERROR ? openerp.netsvc: 'NoneType' object has no attribute 'search'`
`2012-09-07 13:58:03,208 17516 INFO ? werkzeug: 192.168.100.106 - - [07/Sep/2012 13:58:03] "POST /web/dataset/search_read HTTP/1.1" 200 -`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:59:48.753

问题是`self._obj`返回不存在的值，`pool`因此当您尝试`pool`使用该方法从该对象获取对象时，`get`它会尝试从该方法中找到键，`dict`但由于该键不存在，`pool`因此返回`None`.

如果这不会在 GTK 或 WEB 中出现错误，请尝试`self._obj`在所有客户端中显示。

# calling-convention - 从 DWARF 信息中获取调用约定

> ID：12252176
> 
> 赞同：8
> 
> 时间：2012-09-03T17:48:07.313
> 
> 标签：calling-convention, dwarf

我正在尝试从 DWARF 信息中获取有关调用约定的信息。更具体地说，我想获取哪些寄存器/堆栈位置用于将参数传递给函数。我的问题是，在某些情况下，我从 DWARF 转储中得到了某种错误的信息。我正在使用的示例是以下“C 代码”：

```
int __attribute__ ((fastcall)) __attribute__ ((noinline)) mult (int x, int y) {
return x*y;
} 
```

我使用以下命令编译此示例：

```
gcc -c -g -m32 test.c -o test.o 
```

现在，当我使用以下命令获取 dwarf 转储时：

```
dwarfdump test.o 
```

我收到有关此功能的以下信息：

```
< 2><0x00000042>      DW_TAG_formal_parameter
                        DW_AT_name                  "x"
                        DW_AT_decl_file             0x00000001 /home/khaled/Repo_current/trunk/test.c
                        DW_AT_decl_line             0x00000001
                        DW_AT_type                  <0x0000005b>
                        DW_AT_location              DW_OP_fbreg -12
< 2><0x0000004e>      DW_TAG_formal_parameter
                        DW_AT_name                  "y"
                        DW_AT_decl_file             0x00000001 /home/khaled/Repo_current/trunk/test.c
                        DW_AT_decl_line             0x00000001
                        DW_AT_type                  <0x0000005b>
                        DW_AT_location              DW_OP_fbreg -16 
```

查看 DW_AT_location 条目，它与框架基础有一些偏移。这意味着它们是内存参数，但实际调用约定“fastcall”强制将它们传递到寄存器中。通过查看生成的目标文件的反汇编，我可以看到它们从寄存器复制到函数入口点的堆栈位置。有没有办法从 dwarf 转储中知道 - 或使用任何其他方式 - 最初在调用时传递参数的位置？

谢谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T15:03:55.883

因为你正在使用`gcc -c -g -m32 test.c -o test.o`. 虽然它是一个`fastcall`函数，`GCC`但仍然需要在函数开始时生成代码以将寄存器中的值保存到堆栈帧中。没有它，任何调试器或`gdb`无法调试程序，否则他们会说参数正在优化且未显示。它使调试变得不可能。

在 x86_64 中，编译器还默认使用一些寄存器来传递一些参数，即使没有`fastcall`为函数指定属性。您还可以发现这些寄存器也被复制到堆栈中。

```
// x86_64 assembly code
_mult:
Leh_func_begin1:
      pushq   %rbp
Ltmp0:
      movq    %rsp, %rbp
Ltmp1:
      movl    %edi, -4(%rbp)
      movl    %esi, -8(%rbp)
      movl    -4(%rbp), %eax
      movl    -8(%rbp), %ecx
      imull   %ecx, %eax 
```

如果你打开优化标志`-O`, `-O2`, `-O3`（不管有`-g`没有），你可以反汇编并发现没有任何东西被复制到堆栈帧中。而当你 gdb 优化了可执行文件，并在函数的开头停止显示局部变量时，`gdb`会告诉你那些参数正在被优化掉。

32位程序的`dwarfdump`例子看起来像

```
0x00000083:      TAG_formal_parameter [4]  
                 AT_name( "x" )
                 AT_decl_file( "test.c" )
                 AT_decl_line( 1 )
                 AT_type( {0x0000005f} ( int ) )
                 AT_location( 0x00000000
                    0x00000000 - 0x00000003: ecx
                    0x00000003 - 0x00000018: ecx )

0x00000090:      TAG_formal_parameter [4]  
                 AT_name( "y" )
                 AT_decl_file( "test.c" )
                 AT_decl_line( 1 )
                 AT_type( {0x0000005f} ( int ) )
                 AT_location( 0x0000001e
                    0x00000000 - 0x00000003: edx
                    0x00000003 - 0x00000018: edx ) 
```

而且你会发现生成的汇编代码非常简单干净。

```
_mult:
        pushl   %ebp
        movl    %esp, %ebp
        movl    %ecx, %eax
        imull   %edx, %eax
        popl    %ebp
        ret     $12 
```

# php - 带有 sql 的日历

> ID：12252184
> 
> 赞同：0
> 
> 时间：2012-09-03T17:49:02.110
> 
> 标签：php, mysql

PHP+SQL 问题：

我有作业表，其中一个字段是“progTargetDate”-> linux 时间（例如：1348185600）我还构建了日历，我想检查我打印的每一天是否有任何作业

所以 - 我写了一个查询，给我带来了当月的所有作业

```
$query = mysql_query("SELECT ass.id, ass.title, ass.des, ass.progTargetDate 
                        FROM pro_assignments AS ass, pro_progs2assignments AS pr 
                        WHERE   (ass.progTargetDate >= $ChoosenMonth_start) AND
                                (ass.progTargetDate <= $ChoosenMonth_end) 
                        ORDER BY ass.progTargetDate ASC
                        "); 
```

（我删除了部分 SQL 查询））

我有构建日历单元的循环

```
for ($i = 1 ; $i <= $total_days_in_month ; $i++)
{
} 
```

$i = 一个月中的每一天

我尝试构建 IF 条件但没有成功我想每天检查它是否在数组中找到（我从第一个查询中获得）

（此代码进入 FOR 循环：）

```
echo "<td>$i"; 
        while($index = mysql_fetch_array($query)) 
        {
                $progTargetDate = $index['progTargetDate'];
                if ((mktime(0, 0, 0, date($ChoosenMonth)  , $i, date($ChoosenYear)) == $progTargetDate))
                    echo "<p>found</p>";
                else
                    echo "<p>not</p>";

        }

echo "</td>"; 
```

我做错了什么？

* * *

31 天里，我应该有 31 个单元格，每个单元格都带有“找到”或“未找到”。但由于某种原因，我只在第一个单元格中看到了这个结果

# xml - XML 和 Latin1 问题

> ID：12252192
> 
> 赞同：1
> 
> 时间：2012-09-03T17:49:22.617
> 
> 标签：xml, encoding, character

有没有简单的方法来保存一个 xml 文件以便它显示拉丁字符？出于某种奇怪的原因，我有几年前的原始文件，它工作正常，但如果我将新信息复制到其中，我会得到：

> “无法使用 Latin1 编码保存文档“abc.xml”。您想使用 UTF-8 来保存它吗？”

如果我使用 UTF-8 保存它，拉丁字符就会被溢出。

我的 xml 文件以`<?xml version="1.0" encoding="iso-8859-1"?>`

# objective-c - NSMutableArray 中的 NSNull

> ID：12252193
> 
> 赞同：0
> 
> 时间：2012-09-03T17:49:23.920
> 
> 标签：objective-c, cocoa, nsmutablearray

`allItems`是一个`NSMutableArray`，当用户单击加号按钮时，该方法`createItem`被调用。我试图只`BNRItem`为每个偶数索引添加对象（类），所以我尝试`NSNull`为奇数索引添加一个实例：

```
-(BNRItem *)createItem {
    BNRItem *p = [[BNRItem alloc] init];
    if ([allItems count] == 0)
        [allItems addObject: p];
    else {
        [allItems addObject: [NSNull null]];
        [allItems addObject: p];
    }
    return p;
} 
```

我点击加号按钮 3 次后的输出是这样的：

```
2012-09-03 13:20:13.876 Homepwner[718:f803] Index: 0 item: Laptop (123): Worth $60, recorded on (September)
2012-09-03 13:20:13.876 Homepwner[718:f803] Index: 1 item: <null>
2012-09-03 13:20:13.877 Homepwner[718:f803] Index: 2 item: Brush (234): Worth $14, recorded on (September)
2012-09-03 13:20:13.882 Homepwner[718:f803] Index: 1 item: <null>
2012-09-03 13:20:13.882 Homepwner[718:f803] Index: 4 item: Calculator (345): Worth $19, recorded on (September) 
```

如果我继续单击加号按钮，则`<null>`对象始终保持在索引 1 处，而不是递增到 3、5 等。我想知道为什么会这样以及如何解决它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T17:56:19.357

您没有显示日志记录的代码，但是，根据结果，我会说您正在执行以下操作：

```
for( id obj in arr ){
    NSLog(@"Index: %lu item: %@", [arr indexOfObject:obj], obj);
} 
```

该方法查找与数组中的项目相等`indexOfObject:`的最低索引。`obj`由于`[NSNull null]`总是给你相同的对象（它是一个单例），当`obj`在循环中时`NSNull`，`indexOfObject:`总是会在 1 处停止搜索。

-循环将始终按顺序遍历您的数组`for`，`in`因此您可以保留一个计数器来打印当前索引：

```
NSUInteger idx = 0;
for( id obj in arr ){
    NSLog(@"Index: %lu item: %@", idx++, obj);
} 
```

或使用“常规”`for`循环：

```
NSUInteger count = [arr count];
for( NSUInteger i = 0; i < count; i++ ){
    NSLog(@"Index: %lu item: %@", i, [arr objectAtIndex:i]);
} 
```

最后，如果您只记录它，该数组将自行打印并发`description`送到其包含的每个项目`NSLog(@"%@", arr);`：这将是有序的，因此除非您真的需要附加索引，否则我建议您这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:46:52.307

Josh Caswell 的回答是正确的，但另一种方法是使用[基于块的枚举](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Collections/Articles/Enumerators.html#//apple_ref/doc/uid/20000135-SW3)，因为您将获得当前索引和对象。

```
[array enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSLog(@"Index: %lu item:%@", idx, obj);
}]; 
```

* * *

这段代码

```
NSMutableArray *mArray = [NSMutableArray array];

[mArray addObject:@(1)];
[mArray addObject:@(5)];
[mArray addObject:@(7)];
[mArray addObject:@(1)];
[mArray addObject:[NSNull null]];
[mArray addObject:@(10)];
[mArray addObject:[NSNull null]];

[mArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSLog(@"%lu %@", idx, obj);
}]; 
```

将导致：

```
Index: 0 item:1
Index: 1 item:5
Index: 2 item:7
Index: 3 item:1
Index: 4 item:<null>
Index: 5 item:10
Index: 6 item:<null> 
```

这种方式的好处是，您可以使用突变阻止进行安全快速的枚举，同时您还可以拥有没有另一个（可能是错误的）查找的索引。

从[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Collections/Articles/Enumerators.html#//apple_ref/doc/uid/20000135-SW3)：

> 对于 NSArray 枚举，index 参数对于并发枚举很有用。如果没有此参数，访问索引的唯一方法是使用 indexOfObject：

# mysql - 获取特定时间段的统计信息

> ID：12252194
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:49:53.640
> 
> 标签：mysql

我有表受众：id（int），unixtime（int），国家（int），城市（int），观众（int）。

表格的任命 - 为不同城市和国家的一些抽象受众保留统计数据。每天在不同时间针对不同城市和国家收集数次统计数据。

在撰写查询时需要帮助，该查询应显示每个跨国和城市的受众

1.  第一个和最后一个日期
2.  在特定的日期期间

输出应包含

*   country1, city1, unixtime, 观众 - min(unixtime)
*   country1, city1, unixtime, 观众 - max(unixtime)
*   country1, city2, unixtime, 观众 - min(unixtime)
*   国家 1、城市 2、unixtime、观众 - max(unixtime)
*   ...

或者：

*   country1, city1, begin_unixtime, begin_audience, end_unixtime, end_audience
*   country1、city2、begin_unixtime、begin_audience、end_unixtime、end_audience
*   ...

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:07:42.213

Try this solution:

```
SELECT b.country,
       b.city,
       b.unixtime AS begin_unixtime,
       b.audience AS begin_audience,
       c.unixtime AS end_unixtime,
       c.audience AS end_audience       
FROM   (
       SELECT   MIN(id) AS minid,
                MAX(id) AS maxid
       FROM     audience
       WHERE    unixtime BETWEEN <start> AND <end>
       GROUP BY country,
                city
       ) a
JOIN   audience b ON b.id = a.minid
JOIN   audience c ON c.id = a.maxid 
```

* * *

In this solution, the min/max unixtime and audience are based on the min/max `id` (first and last row inserted between specified dates), assuming it's a unique auto-incrementing int.

Replace `<start>` and `<end>` with your date range.

# python - 运行 Django ./manage.py 时出现错误“没有这样的文件或目录”

> ID：12252198
> 
> 赞同：7
> 
> 时间：2012-09-03T17:50:11.770
> 
> 标签：python, django, bash, virtualenv

在我的`django`项目中，该命令`./manage.py [command]`会导致此错误消息：

```
: No such file or directory 
```

该命令`python manage.py [command]`运行良好。我尝试使用`syncdb`and `runserver`。我试过`chmod a+x manage.py`了，但问题仍然存在。

我的管理.py：

```
#!/usr/bin/env python
import os
import sys

if __name__ == "__main__":
    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "myproject.settings")

    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

我在`virtualenv`. 我该如何解决这个问题`manage.py [command]`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-24T18:58:05.900

可能的原因是因为您在 manage.py 文件中的行结尾是 \n 而不是 \r\n。结果#! hash-bang 被误解了。

当我使用基于 Windows 的文本编辑器进行 linux 连接时，就会发生这种情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T17:54:18.430

`#!`hash-bang 行并不指向您的 virtualenv python ；将第一行替换为：

```
#!/path/to/virtualenv/bin/python 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-03T17:54:47.070

> 在我的 django 项目中，命令 ./manage.py [command] 会导致以下错误消息：
> 
> ： 没有这样的文件或目录
> 
> 命令 python manage.py [command] 运行良好

如果指定解释器使其工作，那么第一行肯定是错误的：

```
#!/usr/bin/env python 
```

尝试：

```
#!/usr/bin/python 
```

（或解释器所在的任何位置。使用： 找到它`which python`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-16T01:14:26.747

就我而言，我错误地更改`sys.path`了`manage.py`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-02T10:16:08.887

就我在 Windows 7 上的情况而言，它似乎是所有其他的，但我不小心在 views.py 文件中添加了一个导入：

```
from Scripts.pilprint import description 
```

我的软件不需要这个导入，可能有一些错误的short-kut，我的Eclipse为我写了它，但是删除了这一行，问题就消失了。

我认为该描述包含一些令人痛苦的字符或 Windows 的编码错误。

# php - 在基于 ID 的 sql 查询中提供链接

> ID：12252199
> 
> 赞同：2
> 
> 时间：2012-09-03T17:50:12.250
> 
> 标签：php, sql

因此，我无法弄清楚如何根据 ID 显示指向新页面的链接。我创建了一个基于员工提交的所有考勤卡的审核页面。它工作正常，但如果员工想要查看个人记录并更改记录中的特定内容，我就会遇到麻烦。下面是我用来显示信息的代码片段。因为时间卡有很多字段，所以我不需要浪费整个页面显示所有信息，直到员工实际提交他想要的特定卡。

```
$result = mysql_query("SELECT ID,employee,date FROM tcardsubmit WHERE employee = '$empname");

 echo "<table border='1'>
 <tr>
 <th>ID</th>
 <th>EMPLOYEE NAME</th>
  <th>DATE</th>
 </tr>";

 while($row = mysql_fetch_array($result))
   {
   echo "<tr>";
   echo "<td>" . $row['ID'] . "</td>";
   echo "<td>" . $row['employee'] . "</td>";
   echo "<td>" . $row['date'] . "</td>";
   echo "</tr>";
   }
 echo "</table>"; 
```

该查询显示了我真正需要员工查看的所有内容。我想要的是将 ID 号转移到名为“review.php”的页面，但 ID 号也随之转移，然后我可以使用 GET ID 并根据评论中的 ID 提取所有数据页。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:53:47.520

在循环中添加另一列并执行

```
echo '<td><a href="review.php?id=' .  $row['ID'] . '">View</a></td>'; 
```

在 review.php

```
$id = (int) $_GET['id']; 
```

和查询..

```
SELECT <fields> FROM tcardsubmit WHERE ID = $id 
```

确保转义 id .. 我通过转换为 int 来做到这一点，但你也可以做 mysql_real_escape_string

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T17:56:00.033

在你的桌子上做一点改变

```
 echo "<table border='1'>
 <tr>
 <th>ID</th>
 <th>EMPLOYEE NAME</th>
 <th>DATE</th>
 <th>ACTION</th>
 </tr>";

 while($row = mysql_fetch_array($result))
   {
   echo "<tr>";
   echo "<td>" . $row['ID'] . "</td>";
   echo "<td>" . $row['employee'] . "</td>";
   echo "<td>" . $row['date'] . "</td>";
   echo "<td><a href=review.php?ID=" . $row['ID'] . ">Review</a></td>";
   echo "</tr>";
   }
 echo "</table>"; 
```

# java - 从命令行运行中小型 java 程序的最佳方法是什么？

> ID：12252201
> 
> 赞同：3
> 
> 时间：2012-09-03T17:50:14.690
> 
> 标签：java, linux, ant

来自 c++/make 背景，我习惯于做这样的事情来构建和运行中小型程序：

```
make
./foobar 
```

但是，对于 java/ant，我发现我必须做这样的事情：

```
ant
java -ea -cp build/ foobar 
```

每次我想测试我的程序时都打字`java -ea -cp build/ foobar`很烦人，我宁愿能够做一些简单的事情，比如`./foobar`.

我想出了两个可能的解决方案来解决这个问题，但似乎都不是很好。首先是让`compile`目标创建一个名为`run`：

```
#!/bin/bash

java -ea -cp build/ foobar 
```

然后就用它`./run`来运行程序，但这似乎违背了 ant 的跨平台特性，而且看起来有点像 hack。

第二个选项是创建一个`run`目标，例如：

```
<target name="run" depends="compile">
   <java classname="foobar" fork="true">
      <classpath>
         <pathelement path="${build}"/>
         <pathelement path="${java.class.path}"/>
      </classpath>
      <assertions>
         <enable/>
      </assertions>
   </java>
</target> 
```

这种方法也有效，看起来更干净一些，但速度非常慢！例如：

```
$ time ant run
Buildfile: /somepath/build.xml

init:

compile:

run:
     [java] /* program output */

BUILD SUCCESSFUL
Total time: 1 second

real    0m2.683s
user    0m2.548s
sys     0m0.136s 
```

以上比这慢了近 20 倍（！）：

```
$ time ./run
/* program output */

real    0m0.143s
user    0m0.124s
sys     0m0.020s 
```

那么是否有更好/更标准的方式从命令行运行中小型 java 程序？还是我应该只使用我在这里发布的一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:57:12.820

在我看来，您想在开发阶段构建/运行。

如果是这样，那就弄个Eclipse，用它来调试/运行，这是java下最有效的开发方式。

通常：

*   Ant用于打包阶段

*   shell 用于运行程序，每个环境（Linux/Windows/Mac OS）编写一个

# performance - 我自己的进程的 Unix 性能监视器

> ID：12252206
> 
> 赞同：0
> 
> 时间：2012-09-03T17:51:00.893
> 
> 标签：performance, bash, shell

我正在尝试编写一个脚本来监视某个进程的 %cpu %mem、cpu 时间等（越多越好）。类似于 Windows 上的性能监视器（perfmon）。
我知道已经有一些工具为此完成了，但我必须使用基本功能和内置功能来完成它，因为它必须在 linux 和 (solaris*/aix/hpux) 上工作。
最好有类似于 perfmon.exe 的输出，这样我就可以更新输出日志，比如说每 5 秒跟踪的进程，格式为：

```
date %mem %cpu cputime private_bytes(?) virtual_bytes(?) 
```

我不知道是从顶部提取数据（实际上在所有将要使用的操作系统上都不相同）还是尝试从“ps”查询中提取数据。

我尝试通过一些 for 循环来做到这一点，例如：

```
for $count; do   
    sleep $delay  
    date >>output.txt  
    ps -A -o pid,%cpu,%mem,time -o comm= | grep -v grep | grep $process >> output.txt  
done 
```

我会很感激任何提示。

BR

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:35:08.447

尝试类似的东西

```
ps -o pid,user,%cpu,%mem,rss,vsize,time,cmd -C NAME 
```

或者

```
ps -o pid,user,%cpu,%mem,rss,vsize,time,cmd -p PID 
```

`-A`如果您只对特定流程感兴趣，请不要使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:15:01.417

如果不同 Unices 之间的可移植性是目标，那么您的方法似乎还可以（`grep -v`虽然不需要），但要小心使用通用`ps`开关

# ios - 从 'const b2Shape*' 到 'b2PolygonShape*' 的动态转换会抛弃限定符？

> ID：12252208
> 
> 赞同：0
> 
> 时间：2012-09-03T17:51:03.420
> 
> 标签：ios, casting, box2d, polygon, shape

我只是想`b2PolygonShape`从 a创建一个，`b2Shape`但我遇到一个错误，上面写着：`Dynamic-cast from 'const b2Shape*' to 'b2PolygonShape*' casts away qualifiers`

这是我的代码：

```
const b2Shape *s = fix2.shape;
b2PolygonShape *p = dynamic_cast<b2PolygonShape*>(s); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:08:25.303

这是`const`编译器抱怨的限定符。解决方案是声明`p`为指向的指针`const b2PolygonShape`：

```
const b2PolygonShape *p = dynamic_cast<const b2PolygonShape*>(s); 
```

# qt - Qt Script 构造函数

> ID：12252215
> 
> 赞同：0
> 
> 时间：2012-09-03T17:51:35.353
> 
> 标签：qt, constructor

我正在阅读 Qt 脚本文档并遇到了这段话。

> 请注意，即使它不被认为是好的做法，也没有什么可以阻止您选择忽略默认构造的 (this) 对象，当您的函数被调用为构造函数并创建自己的对象时；只需让构造函数返回该对象。该对象将“覆盖”引擎构造的默认对象

我对这意味着什么感到困惑。“this”对象和构造函数对象的含义。这是否意味着拥有 this 对象而不是构造函数更受青睐？

可以请一些解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T18:32:14.247

让我们以 Qt 文档中的示例为例：

```
function Book(isbn) {
    this.isbn = isbn;
} 
```

构造函数向对象`Book()`添加一个`isbn`属性，该属性会`this`自动返回（即无需显式`return`声明）。但是，您可以自由地从构造函数返回您自己的对象，例如，您可以这样做

```
function Book(isbn) {
    return {isbn : isbn};
} 
```

在后一种情况下，您忽略该`this`对象，创建一个新对象并将其返回。

# android - 固定滚动布局中的位置

> ID：12252217
> 
> 赞同：0
> 
> 时间：2012-09-03T17:52:01.187
> 
> 标签：android, android-layout

我正在使用带有布局充气器的滚动布局来填充数据库中的数据。一切正常，然后屏幕打开，但是当我向上滚动时，项目滚动到开头设置边距的开头。我这样做是因为我使用的是静态背景图像，我希望始终保持在同一位置。我有办法修复滚动视图吗？

这是主页的 XML。

```
 <?xml version="1.0" encoding="utf-8"?>
<ScrollView android:id="@+id/ScrollView01"
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="fill_parent" android:layout_width="fill_parent"
    android:background="@drawable/backimage"
    >
    <LinearLayout
        android:id="@+id/mylayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="70dp"
        android:orientation="vertical" >

    </LinearLayout>
</ScrollView> 
```

这是我添加到滚动视图中的每个项目的 XML

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout android:orientation="vertical"
    android:layout_width="fill_parent" android:layout_height="wrap_content" xmlns:android="http://schemas.android.com/apk/res/android"><ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:gravity="right"
    android:padding="10dp"
    android:paddingLeft="10dp"
    android:paddingRight="10dp"
    android:paddingTop="10dp"
    android:src="@drawable/nocarpic" />

    <TextView
        android:id="@+id/TextView01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="left"
        android:paddingBottom="10dp"
        android:paddingLeft="20dp"
        android:paddingTop="10dp"
        android:text="@+id/TextView01" >

    </TextView>
    <TextView
        android:id="@+id/TextView02"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="20dp"
        android:paddingBottom="10dp"
         />

    <LinearLayout
    android:id="@+id/horizontalLine"
    android:layout_width="fill_parent"
    android:layout_height="1dip"
    android:background="#8B0000"
    android:paddingRight="2dp"
    />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:54:05.483

如果您的意思是希望滚动内容在 ScrollView 顶部下方剪裁 70dp，请尝试删除 LinearLayout 上的边距，而不是`android:paddingTop="70dp"`在 ScrollView 上进行设置。默认情况下，ViewGroups 将子视图剪辑到填充。

# javascript - 同位素jQuery的多个实例

> ID：12252221
> 
> 赞同：1
> 
> 时间：2012-09-03T17:52:10.417
> 
> 标签：javascript, jquery, jquery-isotope

我有一个非常奇怪的问题

我正在加载两个单独的 div，如下所示，span 元素是为了存储每个同位素实例中每行存在多少个项目

```
<div class='instagram' id='insta12'>
<div class="item">...</div>
<div class="item">...</div>
<div class="item">...</div>
<div class="item">...</div>
<span id="hiddenValue" >5</span>
</div>

<div class='instagram' id='insta101'>
<div class="item">...</div>
<div class="item">...</div>
<div class="item">...</div>
<div class="item">...</div>
<span id="hiddenValue">3</span>
</div> 
```

而我的js文件如下图

```
jQuery(document).ready(function($) {
  var tmpNum="";
  var numberOfImages=3;
  var $container = $('.instagram');
  $container.each(function ()  {

  tmpNum=  $(this).find('span#hiddenValue').text();
  numberOfImages=parseInt(tmpNum);
  var tmpid=$(this).attr("id");
  alert(tmpid);
    $("#"+tmpid).imagesLoaded(function() {
      $("#"+tmpid).isotope({ 
        resizable: false, 
        // disable normal resizing
        // set columnWidth to a percentage of container width
        masonry: { 
        columnWidth:  $("#"+tmpid).width() / numberOfImages 
        } 
      });

    }); //isotope
  });         //each
}); //dom ready 
```

尽管脚本似乎正在运行，但第二个容器每行的项目数与第一个容器一样多。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:05:33.523

**解决了**

```
jQuery(document).ready(function($) {
    var tmpNum = "";
    var $container = $('.instagram');
    $container.each(function() {
        var tmpid = $(this).attr("id");
        tmpNum = $("#" + tmpid + " span#hiddenValue").text();
        var numberOfImages = parseInt(tmpNum, 10);
        $(this).imagesLoaded(function() {
            $(this).isotope({
                resizable: false,
                // disable normal resizing
                // set columnWidth to a percentage of container width
                masonry: {
                    columnWidth: $(this).width() / numberOfImages
                }
            });
        }); //isotope
    }); //each
}); //dom ready 
```

# c# - 使用 Visual Studio 2010 连接到 sql server express

> ID：12252223
> 
> 赞同：0
> 
> 时间：2012-09-03T17:52:16.500
> 
> 标签：c#, visual-studio-2010, connection-string, sql-server-express

我是 .net 和 c# 的新手，想连接 Visual Studio 2010 中可用的 Sql server express。
我进行了很多搜索并阅读了 connectionstrings.com 中的连接字符串，[但](http://connectionstrings.com)仍然不知道如何连接。
我通过添加新项目添加了一个“基于服务的数据库”，现在有一个带有表格的**db.mdf**。

我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.SqlClient;

namespace ConsoleApplication1
{

class First
{
    static void Main()
    {
        SqlConnection con = new SqlConnection("Data Source=(local);Initial Catalog=db2.mdf;Integrated Security=True");
            con.Open();

            Console.WriteLine("ok");
            Console.ReadLine();
    }
}
} 
```

但它没有连接。事实上它执行没有错误，但没有输出*Console.WriteLine("ok");*

在我的情况下，连接字符串应该如何？专门用于“数据源”。我不知道它的价值应该是多少。请告诉我适合我情况的完整连接字符串。

我对.net 真的很陌生，并且为一个简单的连接困惑了很多天。

还尝试了许多其他连接字符串，但不起作用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T17:54:06.833

尝试使用此代码

```
using(var connection = new SqlConnection("Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\db2.mdf;Integrated Security=True;User Instance=True")
{

} 
```

# jquery - 如何让这个ajax在rails中工作？

> ID：12252226
> 
> 赞同：1
> 
> 时间：2012-09-03T17:52:36.093
> 
> 标签：jquery, ruby-on-rails, ajax

我试图让它工作，但我真的无法找到问题所在。这是代码。创建评论后，我尝试在不刷新页面的情况下呈现评论。

**创建.js.erb**

```
$('.post').append("<%= escape_javascript render(@comment) %>"); 
```

**评论控制器.rb**

```
class CommentsController < ApplicationController
def create
    @post = Post.find(params[:post_id])
    @comment = @post.comments.create!(params[:comment])

    respond_to do |format|
        format.html
        format.js
    end
end
end 
```

**index.html.erb**

```
<% @posts.each do |post| %>
    <div class="post">
        <p><strong> <%= post.title %> </strong>, posted <%= post.created_at.to_date %> </p> <br />
        <%= post.content %> <br />

        <%= simple_form_for [post, post.comments.build], :remote => true do |f| %>
            <%= f.input :content %>
            <%= f.button :submit %>
        <% end %>

        <% post.comments.each_with_index do |comment, i| %>
            <p> <%=i + 1%>.<%= comment.content %></p>
        <% end %>

    </div>

<% end %>

<p><%= link_to "New Post", new_post_path %></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:46:23.373

为 firefox安装[firebug](https://getfirebug.com/)，以便您可以调试 ajax 和 js 代码。我通常在将 ajax 添加到我的应用程序时使用它，以确保没有任何错误。

# ruby-on-rails - 在创建新的 Rails 应用程序期间创建时

> ID：12252229
> 
> 赞同：-4
> 
> 时间：2012-09-03T17:52:51.547
> 
> 标签：ruby-on-rails, openssl

[从https://rubygems.org/](https://rubygems.org/)获取 gem 元数据。无法加载 OpenSSL。您必须使用 OpenSSL 支持重新编译 Ruby，或将 Gemfile 中的源代码从“https”更改为“http”。rvm.io/packages/openssl 提供了使用 RVM 使用 OpenSSL 进行编译的说明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:35:36.303

您的答案在错误消息中。**将“ https://rubygems.org** ”更改为“ **http://rubygems.org** ”。那应该让它工作。

此外，如果您将 Ubuntu 用于您的操作系统，我从来没有找到比[http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and更好的安装 ruby​​、rails 和 rvm 的教程-你/](http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/)。只要完全按照它，你不应该有任何问题。

如果您不在 Ubuntu 上并且想要更详细的答案，您需要告诉我们： - 您正在使用什么操作系统**和版本**- 您要安装什么版本的 rails 和 ruby

# django - 用来自相关资源的数据脱水一个美味的馅饼类？

> ID：12252230
> 
> 赞同：0
> 
> 时间：2012-09-03T17:52:54.720
> 
> 标签：django, tastypie

我正在使用 tasstypie 创建一个 API，并且我想在评论资源中检索用户昵称。评论资源发送 user_uri，但我无法将信息脱水以添加用户名。

这些型号是：

```
class User(models.Model):
    nick = models.CharField(max_length = 255)

class Comment(models.Model):
    name = models.CharField(max_length = 511)
    user = models.ForeignKey(User, related_name='comments') 
```

美味的 api 是：

```
class CommentResource(ModelResource):
    user = fields.ToOneField(UserResource, 'user')

class Meta:
    queryset = Comment.objects.all()
    resource_name = 'comment'
    serializer = Serializer(formats=['json'])
    allowed_methods = ['get']
    always_return_data=True

def dehydrate(self, bundle):
    bundle.data['nick_user'] = #here I want to send user nick
    return bundle 
```

这从“用户”变量中的 UserResource 获取 uri。如何从 CommentResource 的脱水方法访问用户昵称？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T12:33:02.697

为什么不使用整个脱水方法而不是使用 dehydrate_user(self, bundle) 并返回 bundle.obj.nick？

# testing - 如何测试计算能力较低的应用程序和网站？

> ID：12252232
> 
> 赞同：0
> 
> 时间：2012-09-03T17:52:59.690
> 
> 标签：testing, emulation

目前我在一台非常强大的机器上开发：Pentium i7、32 GB Ram、SSD、1 Gb 1028 位显卡等。

我想弄清楚的是测试我的应用程序和网页模拟一台功能较弱的计算机的正确方法。有什么方法可以模拟更慢的处理器、更少的内存、更慢的硬盘和更弱的显卡？我不确定我是否错过了其他要模拟的内容...

到目前为止，我唯一想出的就是分辨率，但这就像更改显示器分辨率一样简单。不过，如果有一种方法可以模拟较低的分辨率而无需更改我的实际屏幕分辨率，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:02:50.893

下载[**Windows 虚拟 PC**](http://www.microsoft.com/windows/virtual-pc/)。
并在其中测试您的应用程序。
您可以自定义配置，如磁盘存储、RAM 内存等。
应用程序开发人员在不同环境中测试的好应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T17:56:22.593

我想你可以在你的电脑上创建一个虚拟机。然后，您可以改变它可以访问多少 RAM 和处理能力。如果你想模拟一个速度较慢的驱动器，你可以启动这台 USB 驱动器的机器。

# iphone - 显示的 NSLog 数组计数代码有什么作用？

> ID：12252233
> 
> 赞同：3
> 
> 时间：2012-09-03T17:53:02.983
> 
> 标签：iphone, ios, xcode, nslog

```
NSLog(@"%d",[annotations count]); 
```

上面的代码与一个名为“annotations”的 NSMutableArray 一起使用。

我的问题是......这段代码究竟做了什么？

我知道`NSLog`输出文本，并且它说注释计数..所以我认为它输出注释数组中元素的数量。

我对么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T17:54:29.723

您可以只运行代码来测试它，但是这个命令输出到`NSLog`名为“annotations”的数组的计数。例如，如果数组包含对象和索引 0、1、2、3 和 4，则数组的计数将为 5。

```
NSArray * array = [NSArray arrayWithObjects:@"zero", @"one", @"two", @"three", @"four", nil];
NSLog(@"Number of items in my array is: %d", [array count]);//this will return (5) 
```

有关更多详细信息，请参阅这篇文章：[NSArray 的大小](https://stackoverflow.com/questions/2512040/size-of-an-nsarray)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T17:55:21.307

是的，你完全正确。 `NSLog`将文本打印到控制台窗口，数组的`count`函数输出该数组中元素的数量。

NSLog 以一种特殊的方式打印文本；只要有`%i`, `%d`, `%f`,`%@`等，它就会用传递的变量替换该符号。所以如果我输入：

```
NSLog(@"Hi my name is %@. I am %i years old.", @"Sarah", 12); 
```

控制台将打印：

```
Hi, my name is Sarah.  I am 12 years old. 
```

因此，在您的示例中，如果 annotations 有 10 个元素，`10`则将简单地打印到控制台。如果您只是打印一堆数字，这可能会让人感到困惑！因此，使用 NSLog 的灵活性，如果你这样做会更容易阅读你的日志输出：

```
NSLog(@"Elements in annotations array: %d", [annotations count]); 
```

然后这将打印到您的控制台：

```
Elements in annotations array: 10 
```

在阅读您的日志时，这可能会更有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T17:54:59.657

是的，它只会显示数组中对象的数量

# php - php app/console 学说问题：schema:update --force 命令

> ID：12252243
> 
> 赞同：0
> 
> 时间：2012-09-03T17:53:31.333
> 
> 标签：php, symfony, doctrine, doctrine-orm

当我尝试运行以下命令时，

```
 php app/console doctrine:schema:update --force 
```

它说，

> [PDO异常]
> 
> SQLSTATE [HY000]：一般错误：1005 无法创建表 'mysys_dve.#sql-7fc_4'

我也清除缓存，甚至重新启动机器，但同样的事情一遍又一遍地发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T20:39:23.983

检查你的表结构：你必须确保，当一个字段指向一个*id*时，两者都是`signed`or `unsigned`。

当两个字段没有完全相同的参数时，Mysql 无法生成外键。

# asp.net-mvc - 没有选择一台收音机？

> ID：12252244
> 
> 赞同：0
> 
> 时间：2012-09-03T17:53:31.793
> 
> 标签：asp.net-mvc, knockout.js

我改变了方法，现在，我正确地选择了无线电值。

**问题：初始化时选择了我的一个收音机（首先加载然后用户可以更改选择），但第一次没有选择收音机，如何正确初始化“已选择”？**

```
@model Demo.Web.ViewModels.HomeViewModel
@{
   ViewBag.Title = "Two Page";
}
@using (Html.BeginForm("Index", "Two", FormMethod.Post, new Dictionary<string, object> { { "data-bind", "submit:onSubmit" } }))
{

<table>
    <tr>
        <td>
            <div data-bind="foreach: items">
                <input type="radio" name="items" data-bind="attr: { value: id }, checked: $root.selected" />
                <span data-bind="text: name"></span>
            </div>
            <div data-bind="text: selected">
            </div>
        </td>
    </tr>
</table>

<input type="submit" name="send" value="Send" />
}

<script type="text/javascript">
var viewModel = {
    items: [
    { "id": 1, "name": "one", "selected": false  },
    { "id": 2, "name": "two", "selected": true },
    { "id": 3, "name": "three", "selected": false }
],
selected: ko.observable(),

    onSubmit: function(){                

        var x = this.selected();

        }
    };     

$(function() {                        
        ko.applyBindings(viewModel);
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:59:52.920

当绑定到 type 的输入时，Knockout`radio`中的`checked`绑定会尝试将输入的值写入绑定的任何值。这个想法是你所有的无线电都绑定到同一个可观察对象。

就像是：

```
var viewModel = {
    items: [
        { id: 1, name: "one"  },
        { id: 2, name: "two" },
        { id: 3, name: "three" }
    ],
    selected: ko.observable()
}; 
```

绑定到如下 UI：

```
<div data-bind="foreach: items">
    <input type="radio" name="items" data-bind="attr: { value: id }, checked: $root.selected" />
    <span data-bind="text: name"></span>
</div>

<div data-bind="text: selected"></div> 
```

示例：http: [//jsfiddle.net/rniemeyer/BbX4S/](http://jsfiddle.net/rniemeyer/BbX4S/)

所以，在你的情况下，你应该能够绑定你的收音机`$root.IsSelected`并使用它，而不是循环遍历这些项目。

初始化它时，您可能希望查看是否选中了任何按钮，然后`IsSelected`适当地填充根级别。

# c++ - 在 Qt 中使用 Cuda 编译会出现链接错误

> ID：12252248
> 
> 赞同：2
> 
> 时间：2012-09-03T17:53:47.130
> 
> 标签：c++, qt4, cuda

我正在尝试在 32 位 Windows 7 系统上的 Qt Creator 4.8.0 中编译 Cuda 代码（以 .cu 文件的形式），但我目前失败了。

我整理了以下项目文件：

```
TARGET = TestCUDA
DESTDIR = release
OBJECTS_DIR = release/obj
CUDA_OBJECTS_DIR = release/cuda

SOURCES += main.cpp
CUDA_SOURCES += test.cu

CUDA_SDK = "C:/ProgramData/NVIDIA Corporation/NVIDIA GPU Computing SDK 4.2/C" # Path to cuda SDK install
CUDA_DIR = "C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v4.2" # Path to cuda toolkit install

INCLUDEPATH += $$CUDA_DIR/include \
               $$CUDA_SDK/common/inc/ \
               $$CUDA_SDK/../shared/inc/
QMAKE_LIBDIR += $$CUDA_DIR/lib/Win32 \
                $$CUDA_SDK/common/lib/Win32 \    
                $$CUDA_SDK/../shared/lib/Win32
LIBS += -lcuda -lcudart
CUDA_INC = $$join(INCLUDEPATH,'" -I"','-I"','"')   # this is to put quotes around paths with spaces

cuda.input = CUDA_SOURCES
cuda.output = $$CUDA_OBJECTS_DIR/${QMAKE_FILE_BASE}_cuda.ptx
cuda.commands = $$CUDA_DIR/bin/nvcc.exe $$CUDA_INC $$LIBS --machine 32 -ptx -o ${QMAKE_FILE_OUT} ${QMAKE_FILE_NAME}
cuda.dependency_type = TYPE_C
QMAKE_EXTRA_COMPILERS += cuda 
```

这应该在 release/cuda/ 文件夹中生成一个 test_cuda.ptx 模块。顺便说一句，这正是它的作用，哇！但它也给出了 LNK1107 错误：

```
C:\path\to\release\cuda\test_cuda.ptx:-1: error: LNK1107: invalid or corrupt file: cannot read at 0xFCC 
```

我不知道为什么会发生这种情况，也不知道如何解决。此错误中指示的位置位于文件中间的某个位置`test_cuda.ptx`，但这没有任何帮助。同样奇怪的是，当我将同一个文件导入另一个 Cuda 应用程序时，它可以完美运行，因此文件没有损坏。`main.cpp`完全是空的：

```
int main(int argc, char* argv []) {} 
```

so that's not where the linker could go wrong. It seems like the linker is linking stuff it shouldn't link, but I don't know why, or how to stop this. Anyone an idea?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T00:58:40.063

As mentioned by @asm you are compiling to PTX intermediate files and then trying to link them as object files. But counter to @asm's suggestion, you should not compile to cubin, but to object files. To do so, you want the `-c` option rather than the `-ptx` option:

```
cuda.input = CUDA_SOURCES
cuda.output = $$CUDA_OBJECTS_DIR/${QMAKE_FILE_BASE}_cuda.o
cuda.commands = $$CUDA_DIR/bin/nvcc.exe $$CUDA_INC $$LIBS --machine 32 -c -o ${QMAKE_FILE_OUT} ${QMAKE_FILE_NAME} 
```

Caveat: not a QMAKE user so the above might not be exactly right. I second the recommendation for CMake.

# c - 当还有空间时，字符串结束后是否用零/空初始化字符数组？

> ID：12252250
> 
> 赞同：4
> 
> 时间：2012-09-03T17:54:02.293
> 
> 标签：c, string

考虑以下 char 数组：

```
char str[128] = "abcd"; 
```

`str[4]`数组其余部分（从到）中的所有剩余未初始化字符是否已`str[127]`填充零/空？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-03T17:57:36.457

是的，如果在初始化程序中显式给出的元素少于聚合包含的元素，那么将初始化剩余的元素，就好像聚合具有静态存储持续时间一样。对于整数类型（并且`char`是一），这意味着 0。该标准的相关部分是6.7.9（21）：

> 如果大括号括起来的列表中的初始值设定项少于聚合的元素或成员，或者用于初始化已知大小数组的字符串文字中的字符少于数组中的元素，则聚合的其余部分应隐式初始化与具有静态存储持续时间的对象相同。

在这方面，作为`char`数组初始化器的字符串字面量等同于带大括号的初始化器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T17:59:28.450

是的，字符串文字初始值设定项与以下初始值设定项相同：

```
char str[128] = { 'a', 'b', 'c', 'd', 0 }; 
```

缺少的数组元素被初始化为零，因此数组的其余部分全为零。

# weka - 正确分类的实例 weka 的含义

> ID：12252254
> 
> 赞同：6
> 
> 时间：2012-09-03T17:54:14.513
> 
> 标签：weka

我最近开始使用 weka，并尝试使用朴素贝叶斯将推文分类为正面或负面。所以我有一个训练集，其中包含我为其标记的推文，以及一个测试集，其中包含所有标签为“正面”的推文。当我运行朴素贝叶斯时，我得到以下结果：

正确分类实例：69 92% 错误分类实例：6 8%

然后，如果我将测试集中推文的标签更改为“否定”并再次运行朴素贝叶斯，则结果相反：

正确分类实例：6 8% 错误分类实例：69 92%

我认为正确分类的实例显示了朴素贝叶斯的准确性，并且无论测试集中推文的标签如何，它都应该是相同的。我的数据有问题还是我没有正确理解正确分类实例的含义？

非常感谢您的时间，

南蒂亚

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T18:05:18.750

测试集上的标签应该是实际正确的分类。性能是通过要求分类器对测试集中每个实例的分类给出其最佳猜测来计算的。然后将预测的分类与实际分类进行比较以确定准确性。因此，如果你翻转你给它的“正确”值，结果也会被翻转。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:05:36.180

根据您的训练集，您的实例中有 69.92% 被归类为阳性。如果测试集的标签，即**正确答案**，表明它们都是正面的，那么这使得 69.92% 正确。如果测试集（以及分类）是相同的，但您切换了正确答案，那么当然，正确百分比也将相反。

请记住，为了评估分类器，您需要测试集的真实标签。否则，您无法将分类器的答案与真实答案进行比较。在我看来，您可能误解了这一点。如果这是您想要的，您可以获得看不见的数据的标签，但在这种情况下，您无法评估分类器的准确性。

# php - API 在 Windows 的 php_printer 模块中不匹配

> ID：12252259
> 
> 赞同：0
> 
> 时间：2012-09-03T17:54:32.580
> 
> 标签：php, apache, php-extension

[我从http://downloads.php.net/pierre/](http://downloads.php.net/pierre/)下载了 php_printer 扩展。但是当我尝试配置我的 php.ini 文件时，会弹出一条消息说

```
PHP Startup: printer: Unable to initialize module
Module compiled with module API=20090626
PHP compiled with module API=20100525
These options need to match 
```

我正在为 Windows 使用 EasyPHP。PHP 版本为 5.4.6，Apache 版本为 2.4.2

我经历了其他类似的问题，但我不是服务器管理员或类似的，所以我对命令行 PHP 没有任何想法，并重新编译东西。谁能找到我一个好的和简单的解决方案。

PS：如果解决方案不容易，我真的必须重新编译 PHP 扩展，请提供如何在 Windows 上执行此操作的步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:08:51.633

Basically the extension was compiled to work with php 5.3, and you are trying to use it with 5.4

One solution is to downgrade EasyPHP to php 5.3 to make it work.

# javascript - Date 类型的规范化 javascript 实现？

> ID：12252260
> 
> 赞同：3
> 
> 时间：2012-09-03T17:54:45.997
> 
> 标签：javascript, date

`new Date("2")`是：

*   Chrome 上的“2001 年 2 月 1 日星期四 00:00:00 GMT-0500（东部标准时间）”
*   Firefox 和 IE 9 上的“无效日期”
*   node.js 上的“2001 年 2 月 1 日星期四 05:00:00 GMT”

由于 node.js 使用 google V8 javascript 引擎，而 Chrome 也来自 google，我想这是一个谷歌调整。

这是不好的。有没有一种简单的方法来规范`Date`跨不同平台的类型行为？

谢谢。

**编辑**

当然，“2”不适合约会。但是如果使用 jQuery 验证器插件的“日期”方法，那么“2”是一个完全有效的输入，因为这种特定的验证方法将其逻辑推迟到`Date`javascript 类型以进行实际验证。`Date`如果类型实现是明智的，那么这很有意义。Chrome（和node.js）显然不是这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:00:02.897

不，ECMAScript 规范声明单参数`Date`构造函数（该参数是一个字符串）将遵循`Date.parse`“依赖于实现”的构造函数。来源：[ECMAScript 规范](http://ecma-international.org/ecma-262/5.1/#sec-15.9.4.2)。

因此，如果您希望跨实现具有相同的行为，请避免使用此构造函数。

如果对于您的应用程序，字符串`"2"`作为日期的公认含义，那么您应该实现自己的逻辑来解释它。这没有“标准”含义。如果你有一些更容易被世界识别的东西作为你的字符串，你会发现不同的实现表现得更相似。但是在您的情况下，建议您自己解析字符串并明确地将 的含义提供`2`给`Date`.

# django - 从 MulitpleChoiceField 获取值

> ID：12252263
> 
> 赞同：0
> 
> 时间：2012-09-03T17:55:16.957
> 
> 标签：django, forms, validation

我正在为一些对我来说似乎很简单的事情而苦苦挣扎，所以如果这似乎是一个愚蠢的问题，我提前道歉。我正在努力获取使用 POST 的表单提交的值，该表单的值来自下拉列表。这些值从 django 管理站点显示，即管理员用户可以在管理站点中添加多个值，这些值使用 MulitpleChoiceField 显示在下拉列表中。（这样管理员可以控制可以测试的 IP 地址）

在我的模型中，我配置了以下内容。

```
from django.db import models

class ServerIpAddress(models.Model):
    name                = models.CharField(max_length=200)

    def __unicode__(self):
        return self.name

from platform.models import ServerIpAddress 
```

在我的表单中，我配置了以下内容。

```
serverip = forms.ModelChoiceField(queryset=CloudStackIpAddress.objects.all(), 
           label='server IP to test') 
```

提交表单后，我在 views.py 中收集清理后的数据

```
cd = form.cleaned_data
serverip = cd['serverip'] 
```

但是，当我在提交表单后查看值返回时，我得到以下信息

```
 'serverip': <ServerIpAddress: 10.0.25.14> 
```

我只需要 IP 地址，在本例中为 10.0.25.14（或者它可能是另一个值）。我目前拥有的格式导致了进一步的问题，因为脚本无法确定当前读取的 IP 地址是什么。

请问有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T17:58:35.813

`serverip = cd['serverip'].name`应该解决你的问题。

你知道 django 已经提供了一个[`IPAddressField`](https://docs.djangoproject.com/en/dev/ref/models/fields/#ipaddressfield)?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:01:34.297

您有一个 ServerIpAddress 实例 - 根据您的模型，该值存储在`name`属性中。因此，如果您只需要将值传递给其他函数，您可以使用`serverip.name`.

# .htaccess - 为什么这个 htaccess 工作了一会儿，然后就不行了？

> ID：12252273
> 
> 赞同：0
> 
> 时间：2012-09-03T17:56:12.360
> 
> 标签：.htaccess

我正在尝试将人们重定向到登录页面的新网址，它曾经可以工作，但我做了一些更改，哪种失败，因为我仍在尝试学习如何使用 htaccess，无论如何我带来了非常第一个代码，由于一些尴尬的原因，它不再工作了，

这是代码：

```
# external redirect using R=301 to /login from /index.php?act=Login
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+(index\.php/?|)\?act=Login(&|\s) [NC]
RewriteRule ^/login? [R=301,L] 
```

有没有更好的方法来实现我所需要的？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:28:59.563

检查该`RewriteCond`行中的正则表达式。有`(index\.php/?|)`。管道字符太多并且应该被删除，或者您错过了子模式的第二个选项。

或者，您应该检查一个简单的`Redirect`指令是否足够，而不是对可能简单的任务使用复杂的重写规则。

重定向的基本语法是：

```
Redirect [status] <old-url> <new-url> 
```

出于您的目的，以下内容应该有效：

```
Redirect 301 /index.php?act=Login /login 
```

# asp.net - asp.net资源定制

> ID：12252279
> 
> 赞同：1
> 
> 时间：2012-09-03T17:56:43.843
> 
> 标签：asp.net

我们的网站（ASP.NET 4.0）`meta:ResourceKey`在每个控件中大量使用了您在页面上可以看到的几乎所有内容，并且从客户端到客户端进行了定制。但问题是资源有时需要从客户端到客户端进行定制。例如，如果资源文件中有这个字符串，`Label1ResourceText.Text = 'Welcome to Customer1 site'`那么当我们安装 Customer2 版本时，它需要更改为`Label1ResourceText.Text = 'Welcome to Customer2 site'`应用程序的英文和本地化资源版本。我想知道是否可以通过编程或声明方式在每个客户之间进行最少的定制工作，但不必为每个客户手动编辑或生成不同的资源文件。感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:58:15.007

无论您使用单个文件还是多个文件，如果您使用单个文件方法，您的网站仍然必须确定要使用哪个文件或使用哪个密钥。

除此之外，您将不得不使用两个单独的文件。

另一种方法是将单个资源文件（例如 UIStrings.resx）添加到资源文件夹。然后，您可以将以下字符串存储在资源文件中

WeclomeMessage = "欢迎来到 {0} 站点"

然后你可以使用

```
Label1.Text = String.Format(Resources.UIStrings.WelcomeMessage, CustomerName); 
```

在后面的代码中。

作为代码背后的替代方法是使用

```
<asp:Label Text="<%= String.Format(Resources.UIStrings.WelcomeMessage, CustomerName)%>" /> 
```

[这个链接](http://www.codeproject.com/Articles/38907/ASP-NET-Localization-Quick-Reference#string)有一些关于如何利用资源文件的好信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:03:50.910

查看[http://msdn.microsoft.com/en-us/library/ms227982(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms227982%28v=vs.100%29.aspx)。您可以使用不同的 resx 文件并根据您的业务逻辑以编程方式调用它们。

# objective-c - 嵌套滚动视图出现问题

> ID：12252280
> 
> 赞同：0
> 
> 时间：2012-09-03T17:56:59.027
> 
> 标签：objective-c, ios5, uiscrollview

我的问题是我正在使用嵌套的滚动视图。一个用于水平分页，第二个用于显示垂直滚动的内容（因为内容，即文本，超过了可用空间）。实际上有这个垂直滚动视图的多个副本，例如：

```
MainScrollView (Horizontal)
     VerticalScrollView1
     VerticalScrollView2
     VerticalScrollView3 
```

除了这些，垂直滚动视图还包含可拖动的标签，我使用 touchesBegan: 和moved: 事件实现了拖动。我只使用一个垂直滚动视图开发了整个东西，它工作得很好，我认为，令我沮丧的是，其余部分的工作方式完全相同，但是当我添加更多垂直滚动视图时，只有最后一个允许拖动标签。前两个不允许拖动，此外，它们也不响应垂直滚动事件，这在之前是完美的。我尝试了两个垂直滚动视图，即使这样，也只有最后一个允许拖动。现在不确定垂直滚动，因为只有第一个有足够的内容可以滚动其余不需要。我也可以试试，但是有点晚了，所以，如果有人可以用提供的信息指导我。会很有帮助。否则我明天可以试试，然后把结果发给你。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T01:21:18.860

我在嵌套 UIScrollviews 时遇到了类似的问题。我发现这个来自 WWDC 2010 的视频对于展示如何在分页滚动视图中使用滚动视图非常有帮助，并且我通过按照此视频中的步骤并查看示例代码来修复了我遇到的错误。

[使用滚动视图设计应用程序](https://developer.apple.com/videos/wwdc/2010/)
[示例代码](http://developer.apple.com/library/ios/#samplecode/PhotoScroller/Introduction/Intro.html)

# ruby-on-rails - 如何更改默认的rails错误div“field_with_errors”

> ID：12252286
> 
> 赞同：21
> 
> 时间：2012-09-03T17:57:53.927
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在使用[巫术](https://github.com/NoamB/sorcery)和[twitter bootstrap](http://twitter.github.com/bootstrap/)进行身份验证。

`<div class="field_with_errors">`我想通过更改添加到 DOM的默认导轨，以 twitter 引导程序的样式在我的注册表单上设置错误消息的样式。

做这样的事情的rails约定是什么？

我想你可以添加一些 javascript 来操纵 DOM 来重命名`<div class="field_with_errors">`，但这似乎是一个 hack。似乎应该有一种方法可以在rails中覆盖它，但我不知道在哪里做。

这就是引导程序要求您标记错误以使用其内置表单错误样式的方式：

```
<div class="control-group error">
  <label class="control-label" for="inputError">Input with error</label>
  <div class="controls">
    <input type="text" id="inputError">
    <span class="help-inline">Please correct the error</span>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-19T11:53:08.343

从上面的链接中，如果您将以下内容`class Application < Rails::Application`放入`config/application.rb`

```
config.action_view.field_error_proc = Proc.new { |html_tag, instance| 
  "<div class=\"field_with_errors control-group error\">#{html_tag}</div>".html_safe
} 
```

每当验证失败时，您的输入标签周围都会有一个红色标记

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2020-04-26T09:04:34.683

使用带有 Bootstrap 4 的 Rails 6，您需要添加`is-invalid`类。没有太花哨，我只是做了：

```
ActionView::Base.field_error_proc = proc do |html_tag, instance|
  html_tag.gsub("form-control", "form-control is-invalid").html_safe
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T21:22:00.047

对于 Bootstrap 3.2，您可以使用 sth。像这样（将`nokogiri`gem 添加到您的 Gemfile 中）：

```
ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  html = %(<div class="field_with_errors">#{html_tag}</div>).html_safe
  # add nokogiri gem to Gemfile

  form_fields = [
    'textarea',
    'input',
    'select'
  ]

  elements = Nokogiri::HTML::DocumentFragment.parse(html_tag).css "label, " + form_fields.join(', ')

  elements.each do |e|
    if e.node_name.eql? 'label'
      html = %(<div class="control-group has-error">#{e}</div>).html_safe
    elsif form_fields.include? e.node_name
      if instance.error_message.kind_of?(Array)
        html = %(<div class="control-group has-error">#{html_tag}<span class="help-block">&nbsp;#{instance.error_message.uniq.join(', ')}</span></div>).html_safe
      else
        html = %(<div class="control-group has-error">#{html_tag}<span class="help-block">&nbsp;#{instance.error_message}</span></div>).html_safe
      end
    end
  end
  html
end 
```

将此代码放在`config/initializers/field_error_proc.rb`文件中（如果不存在则创建一个）

这是稍微修改的代码：[Overriding ActionView::Base.field_error_proc in Rails](https://stackoverflow.com/questions/13909393/overriding-actionviewbase-field-error-proc-in-rails#answer-13911207)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-23T16:55:15.097

请注意，如果您使用的是 SimpleForm，则在 application.rb 中使用 Proc 的公认答案将不起作用。相反，您应该编辑 simple_form 初始化程序。例如使用 Bootstrap 3.2：

```
config.wrappers :default, class: :input,
  hint_class: :field_with_hint, error_class: :'has-error' do |b|
  [...]
  b.use :hint,  wrap_with: { tag: :span, class: :'text-warning' }
  b.use :error, wrap_with: { tag: :span, class: :'text-danger' }
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-28T19:53:51.240

Rails 5 上的 Twitter Bootstrap 3.3.6，它包含在一个初始化程序中`customize_error.rb`，对我有用：

```
ActionView::Base.field_error_proc = proc { |html_tag, _instance| "<div class=\"has-error\">#{html_tag}</div>".html_safe } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-21T16:48:44.660

我只想为**checkboxes**关闭错误，所以我这样做了：

```
ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  doc = Nokogiri::HTML::Document.parse(html_tag)
  if doc.xpath("//*[@type='checkbox']").any?
    html_tag
  else
    "<div class=\"field_with_errors\">#{html_tag}</div>".html_safe
  end
end 
```

# java - PrintWriter java.io.IOException: 关闭

> ID：12252288
> 
> 赞同：1
> 
> 时间：2012-09-03T17:58:24.613
> 
> 标签：java, servlets

在 servlet 类的 doPost 方法中执行此操作时，在 PrintWriter 上获取 IOExcepiton：

```
doPost(HttpServletRequest request,
        HttpServletResponse response){
    String replyMessage = "STATUS_ACCEPT";
    response.setStatus(HttpServletResponse.SC_OK);
    response.setContentType("text/plain; charset=utf-8");

    response.setContentLength(replyMessage.length());
    response.setIntHeader("content-length", replyMessage.length());
    response.getWriter().println(replyMessage);//getting IOException closed on calling this method
    response.flushBuffer();} 
```

如果我使用输出流发送数据没有错误：

```
 ServletOutputStream outputStream = response.getOutputStream();
    byte[] result = "STATUS_ACCEPT".getBytes("UTF-8");

    response.setStatus(HttpServletResponse.SC_OK);
    response.setContentType("text/plain; charset=utf-8");

    response.setContentLength(result.length);
    response.setIntHeader("content-length", result.length);

    outputStream.write(httpOutData); 
```

我应该如何使用 printwriter 没有得到 IOException？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:14:07.867

最喜欢的原因是这样的：

```
response.setContentLength(replyMessage.length());
// ...
response.getWriter().println(replyMessage) 
```

这意味着，您的响应内容至少比 宣布的长一个字节`setContentLenght`： 附加的尾随换行符`println()`。也许区别在于两个字节：CR 和 LF。

注意：如果您修复此问题，在一般情况下您仍然会遇到问题：您将内容长度设置为*字符*数，在 UTF-8 编码中并不总是*字节*数。 `setContentLength()`想要字节数。

因此，最好简单地删除所有摆弄内容长度的代码，因为如果您不设置它，它将自动计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:03:37.067

```
PrintWriter pw = response.getWriter();
pw.println("hello");     // flush is not required here.... 
```

# sql - Oracle sql 计数

> ID：12252292
> 
> 赞同：-1
> 
> 时间：2012-09-03T17:58:41.363
> 
> 标签：sql, oracle

我在表中有以下信息，如果两个日期之间的差异> = 1，我想检索计数。

```
Id  testdate  exdate    
1   20120502  20120501  --> This should included, because diff is 1    
2   20120601  20120601  --> This should not included, because diff is 0    
3   20120704  20120703  --> This should included, because diff is 1    
4   20120803  20120802  --> This should included, because diff is 1 
```

根据以上数据，我的选择计数应该返回 3。

我正在尝试以下操作，但没有给出任何结果：

```
select count(to_char(testdate,'YYYYMMDD')-to_char(exdate,'YYYYMMDD')) from test ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:07:45.927

```
select count(*)
  from my_table
 where testdate <> exdate 
```

不过，您确实应该将它们转换为`date`数据类型……从长远来看，它可以节省很多问题。

您的查询将为您提供结果。它将返回 4。它会为您提供结果，因为只要结果`testdate - exdate`不为空，它将返回该行的值。

但是，由于您没有使用日期，Oracle 很可能会将这些日期转换为数字，如果您将来这样做，这将无助于日期比较。

```
20120901 - 20120831 = 70 -- not 1 
```

* * *

好的，根据您的评论：

> 使用，如果我使用 down voteaccept select count(*) from test where to_char((testdate,'YYYYMMDD') - to_char(exdate,'YYYYMMDD')) >= 1; .但是计数是列之一。如何将上面的选择语句检索为列之一

你正在尝试完全不同的东西。

您的日期实际上是日期；发布这个很有帮助。您正在寻找一个[分析函数](http://psoug.org/reference/analytic_functions.html)，特别是`count()`.

```
select a.*, count(*) over ( partition by 1 ) as ct
  from my_table a
 where trunc(exdate) <> trunc(testdate) 
```

请注意该[`trunc`](http://www.techonthenet.com/oracle/functions/trunc_date.php)函数，该函数在没有附加参数的情况下将删除日期的时间部分，这可以进行直接比较，而无需将日期转换为字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:09:50.963

```
select count(*)
   from test
  where to_date(testdate,'YYYYMMDD') - to_date(exdate,'YYYYMMDD') >= 1; 
```

或者

```
select count(*)
   from test
  where to_date(testdate,'YYYYMMDD') <> to_date(exdate,'YYYYMMDD'); 
```

看着`testdate`它`exdate`看起来更像是列`VARCHAR`类型，因此您需要适当的日期转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:06:29.180

在 Oracle 中，如果类型是日期，您可以使用它们进行计算。1 等于 1 天。1/24 等于 1 小时。

您的案例相当简单，因为您甚至可以比较字符串。

```
SELECT count(*)
  FROM test
 WHERE testdate <> exdate 
```

但听起来你希望能够是可变的，所以你宁愿将它们转换为日期然后你可以做

```
SELECT count(*)
  FROM test
 WHERE to_date(testdate,'YYYYMMDD')-to_date(exdate,'YYYYMMDD') >= 1 
```

如果 testdate 减去 exdate 为 -1 或更大，我不确定你想要什么，因为 exdate 在 testdate 之后。然后你可以使用`ABS`

```
SELECT count(*)
  FROM test
 WHERE ABS(to_date(testdate,'YYYYMMDD')-to_date(exdate,'YYYYMMDD')) >= 1 
```

# google-apps-script - 谷歌应用程序脚本中的验证功能无法正常工作

> ID：12252295
> 
> 赞同：0
> 
> 时间：2012-09-03T17:58:59.257
> 
> 标签：google-apps-script

**1.Textbox：** 在使用 .validateNotNumber(TextBox) 时，TextBox 接受字母数字，应该不是这种情况，因为我只想在文本框 n nt 'abc1234' 中有 NAME，它只接受 'abcd'。此外，如果文本框仅使用 keyuphandler 处理 NUMBERS，则它只接受 '1234' n 而不是 'a1234'，这是当前的行为。它接受'a1234'。意思是，第一个字符没有正确验证，如果我们输入'a'，它不会验证，bt如果我们输入'a1234'，它会在第一个数字之后正确验证，即它只在i / p之后抛出err NUMBER 类型的文本框区域中的第二个字符！

```
function doGet()
{
  var app = UiApp.createApplication();
  var panel = app.createVerticalPanel();
  var grid = app.createGrid(11, 10).setId('maingrid');

  var nameLabel = app.createLabel("Name:");
  var nameTextBox = app.createTextBox().setName('name').setId('name');
  var nameRequiredLabel = app.createLabel("*").setId('namerequired').setStyleAttribute("color", "red");

  var requiredFieldLabel = app.createLabel("*-Required Field").setId('requiredfield').setStyleAttribute("color", "red");

  grid.setWidget(0, 0, nameLabel).setWidget(0, 1, nameTextBox).setWidget(0, 2, nameRequiredLabel)
    .setWidget(9, 2,requiredFieldLabel);

  var invalidText=app.createClientHandler().validateNumber(nameTextBox)
      .forTargets(nameTextBox).setStyleAttribute("color", "red")
      .forTargets(nameRequiredLabel).setText('Please Enter a Valid Name.').setStyleAttribute("color", "red").setVisible(true);
  var validText=app.createClientHandler().validateNotNumber(nameTextBox)
      .forTargets(nameTextBox).setStyleAttribute("color","black")
      .forTargets(nameRequiredLabel).setText('*').setStyleAttribute("color", "red").setVisible(true);

  nameTextBox.addKeyUpHandler(invalidText).addKeyUpHandler(validText);

  panel.add(grid);
  app.add(panel);
  return app;
} 
```

注意：我也使用了 .validateInteger(TextBox) 和 .validateNotInteger(TextBox)，但它也给出了与上面相同的 o/p（字母数字）。

**2.DateBox：** 它只接受DATES格式n shld nt可以在选择DATE后输入任何其他字符。例如。如果我选择 DATE '14-08-2012'，它不会接受超出此长度的任何其他字符，例如 '14-08-2012abc123'，实际上应该有一种方法来验证/限制该字段，如果它是任何 REAL DATE 格式 n nt 只是一个 DATE+TEXT。不小心，用户可能会在 DATE 框中输入任何不需要的文本，我们可能需要避免这种情况！我们可能需要一个 '.validateDateLength()' 来处理这个问题！

**3.下拉框：** 在任何给定的下拉框中，选项“SELECT”将成为第一个提示我们从我使用的下拉列表中选择所需选项的选项 .validateMatches("SELECT") 和 .validateNotMatches("SELECT ")，检查用户是否选择了任何选项，这意味着我想确保用户已经从下拉框中选择了一些东西 n NT 刚刚离开选项未选择。顺便说一句，它似乎没有验证匹配。

**4.复选框，单选按钮：** 对于这两个控件，我只想确保用户选择了我的任何收音机或我的任何复选框，如果用户没有选择那些特定的收音机，控件将传递错误，说“请选择收音机/复选框选项以继续下一步”。这样做的正确方法是什么？

例如。脚本

```
var valid = app.createClientHandler()
                 .validateNumber(number)
                .validateNotInteger(text)
                 .validateEmail(email)
                 .validateNotMatches(listbox, 'select')
                 .forTargets(submit).setEnabled(true)
                 .forTargets(number,text,email).setStyleAttribute("color","black")
                 .forTargets(numberrequired,textrequired,emailrequired).setText('*')
                 .setStyleAttribute("color","red").setVisible(true); 
```

我将上面的代码用于“提交”按钮启用和禁用概念，在这本身中，列表框没有正确验证“选择”选项。

所以，基本上，我希望所有这些验证都能正常运行，所以我让我的“提交/保存”启用，直到我上面的所有控件都被检查/验证，这确保用户已经正确输入/选择了所有选项&是进入提交页面所需的格式。

希望我很清楚，请不要犹豫，问我是否在某个地方错了/不清楚！

请指导我，谢谢和问候，乔卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:33:23.573

我怀疑 addKeyPressHandler 是错误类型的处理程序 - 有一个焦点样式处理程序但是是的，代码看起来或多或少是正确的。

# sorting - 查找具有最多重叠 bbox 的形状（多边形）

> ID：12252296
> 
> 赞同：2
> 
> 时间：2012-09-03T17:59:19.713
> 
> 标签：sorting, gis, intersection, cql

我正在尝试构建一个 CQL 查询，以便在我的 spartial 数据库中找到某个形状。

我希望我的查询返回具有最大交叉点的形状。我的想法是设置 LIMIT=1 和 sortBy 交集。

如果您看到附加的屏幕截图，我希望我的查询返回以下内容：

**从左到右的三角形**

*   过滤器1 --> 黄色形状
*   过滤器2 --> 黄色形状
*   过滤器3 --> 绿色形状

有什么办法可以解决我的问题吗？

到目前为止，我正在使用以下代码：

```
 Filter f1 = CQL.toFilter("INTERSECTS(the_geom, POLYGON((10.07051 53.23476, 10.08143 53.23512, 10.07596 53.22838, 10.07051 53.23476)))");
    Filter f2 = CQL.toFilter("INTERSECTS(the_geom, POLYGON((10.06268 53.23756, 10.06889 53.23865, 10.06260 53.24903, 10.06268 53.23756)))");
    Filter f3 = CQL.toFilter("INTERSECTS(the_geom, POLYGON((10.08146 53.24462, 10.09540 53.24761, 10.08247 53.26067, 10.08146 53.24462)))");

    Query query = new Query( typeName, f3);
    query.setMaxFeatures(1);
    source.getFeatures(query);

    SimpleFeatureCollection features = source.getFeatures(query);
    SimpleFeatureIterator it = features.features();
    while (it.hasNext()){
        SimpleFeature sf = it.next();
        System.out.println(sf.getAttributes());
    } 
```

[在此处查看屏幕截图](http://s11.postimage.org/4hfc1pjnz/Bildschirmfoto_2012_09_03_um_19_36_09.jpg)

# c++ - std::vector 和 winapi 窗口

> ID：12252304
> 
> 赞同：0
> 
> 时间：2012-09-03T18:00:11.333
> 
> 标签：c++, windows, winapi

我正在尝试在一个向量中管理我的新窗口，但我遇到了问题。要创建一个工作窗口类，我必须把

```
while( GetMessage( & Komunikat, NULL, 0, 0 ) )
{
    TranslateMessage( & Komunikat );
    DispatchMessage( & Komunikat );
} 
```

因为这个循环窗口在销毁它们后被添加到向量中。如何处理？

* * *

删除该循环后，我在处理子窗口中的消息时遇到问题。当我尝试在编辑框中写东西时程序崩溃（我认为这是编辑它们的原因，因为向它发送文本也会导致程序崩溃）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T00:22:00.753

您的问题是您正在消息循环中运行消息循环。ChatWindow 构造函数创建窗口，然后运行消息循环，直到窗口被销毁才返回。

你不需要这样做。您的程序只需要一个消息循环（MainWindow 中的那个），它将为线程上所有当前打开的窗口检索和发送消息。

（作为参考，示例代码发布在[http://pastebin.com/MzSEvmr0](http://pastebin.com/MzSEvmr0)）。

# c++ - 使用 OnDraw() 的 MFC 并发

> ID：12252305
> 
> 赞同：3
> 
> 时间：2012-09-03T18:00:16.667
> 
> 标签：c++, concurrency, mfc, gdi

我正在 MFC 中构建康威的生活游戏。我在使用 Allegro 之前构建了它，并想使用 MFC 进行尝试。所以我开始迁移算法和东西。它使用一个内核渲染得很好，它的生命游戏算法非常漂亮，就像在 allegro 中一样。康威的人生游戏由使用**pDC->rectangle(x1, y1, x2, y2)**绘制的小矩形组成。

我的问题实际上是两个，一个是每次我调用 pDC->rectangle(...) 时它都会立即绘制它，从而导致这种连锁反应渲染风格。我希望它在完成工作时显示（我知道你可以在 directx 中做到这一点，但我只想使用 MFC 的设备上下文来做到这一点）。

另一个问题是标题，可能是我的主要问题。你如何使用并发的 pDC，我试过了，它做了一些奇怪的事情。我知道我不能在 OnDraw 中并发使用 pDC，因为它是相同的设备上下文，占用相同的内存，但在我的 6 核中使用。就是这样，提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:19:19.857

为避免立即绘制，您可以在内存中绘制位图，然后在完成后在真实 dc 上进行 blit。看看[这里作为起点](http://msdn.microsoft.com/en-us/library/dd145049%28v=vs.85%29.aspx)，或者查看 CodeProject 上的[这篇文章](http://www.codeproject.com/Articles/224754/Guide-to-Win32-Memory-DC)。对于多线程部分，您应该能够在多个线程的内存设备上下文中使用相同的内容，只需确保正确协调该共享 DC 的创建和 blitting/release。

# php - 带有 jquery bgstretcher 的 jquery 轮播

> ID：12252306
> 
> 赞同：0
> 
> 时间：2012-09-03T18:00:19.093
> 
> 标签：php, jquery, carousel

非常感谢您到目前为止的帮助！你真的很棒！但我还有一个问题！我将 jq carousel 与一些名为 bgStretcher 的 3rd 方插件一起使用。（我稍后会插入它的代码）。我的索引文件正在通过 javascript/php 脚本获取带有 href 的图像，其中图像是从正确的路径获取的，并按大小减小并作为 html 传递到正确位置的索引。所以这里有问题：图像被正确读取，缩略图生成，通过的html代码是有效的，轮播显示生成的缩略图，但是bgStretch函数不起作用（为了拉伸从轮播到背景的点击图像）！bgStretch 仅适用于书面纯 html (

*   ） 如下所示。我不明白！请您看一下文件：index.html

    ```
     <li id="page_photo" class="nobg">
                    <a href = "#" id="uploadMore">Polterei Eva</a>
                    <a href = "#" id="uploadMore1">Polterei Paul</a>
                    <a href = "#" id="uploadMore2">Hochzeit</a>
                    <div id="pagin">
                        <ul>
                          <li class="active"><a href="images/bg_pic1.jpg"><img src="images/page3_pic1.jpg" alt></a></li>         
                        <!--   <li><a href="images/bg_pic2.jpg"><img src="images/page3_pic2.jpg" alt></a></li>     -->
                            <li><a href="images/bg_pic3.jpg"><img src="images/page3_pic3.jpg" alt></a></li>        
                        <!--    <li><a href="images/bg_pic4.jpg"><img src="images/page3_pic4.jpg" alt></a></li>         
                            <li><a href="images/bg_pic5.jpg"><img src="images/page3_pic5.jpg" alt></a></li>         
                            <li><a href="images/bg_pic6.jpg"><img src="images/page3_pic6.jpg" alt></a></li>         
                            <li><a href="images/bg_pic7.jpg"><img src="images/page3_pic7.jpg" alt></a></li>         
                            <li><a href="images/bg_pic8.jpg"><img src="images/page3_pic8.jpg" alt></a></li>         
                            <li><a href="images/bg_pic9.jpg"><img src="images/page3_pic9.jpg" alt></a></li>      
                        </ul> -->

                    </div>
                    <div class="navBtns">
                        <a href="#" class="prev"><span></span></a>
                        <a href="#" class="next"><span></span></a>
                    </div>
                </li> 
    ```

    我的脚本文件：

    ```
     function include(url) {
          document.write('<script type="text/javascript" src="' + url + '"></script>');
          }
          var MSIE = false,
          content;
         var request = false;

         // Request senden
         function setRequest(value) {
    // Request erzeugen
    if (window.XMLHttpRequest) {
        request = new XMLHttpRequest(); // Mozilla, Safari, Opera
    } else if (window.ActiveXObject) {
        try {
            request = new ActiveXObject('Msxml2.XMLHTTP'); // IE 5
        } catch (e) {
            try {
                request = new ActiveXObject('Microsoft.XMLHTTP'); // IE 6
            } catch (e) {}
        }
    }
    // überprüfen, ob Request erzeugt wurde
    if (!request) {
        alert("Kann keine XMLHTTP-Instanz erzeugen");
        return false;
    } else {
        var url = "js/getDir.php";
        // Request öffnen
        request.open('post', url, true);
        // Requestheader senden
        request.setRequestHeader('Content-Type', 'application/x-www-form- urlencoded');
        // Request senden
        request.send('name='+value);
        // Request auswerten
        request.onreadystatechange = interpretRequest;
    }
         }

          // Request auswerten
         function interpretRequest() {
    switch (request.readyState) {
        // wenn der readyState 4 und der request.status 200 ist, dann ist         alles              korrekt gelaufen
        case 4:
            if (request.status != 200) {
                alert("Der Request wurde abgeschlossen, ist aber nicht       OK\nFehler:"+request.status);
            } else {
                var content = request.responseText;
                // den Inhalt des Requests in das <div> schreiben
                document.getElementById('pagin').innerHTML  = content;
                updatePagin();
            }
            break;
        default:
            break;
    }
        }
        function updatePagin() {
    $("#pagin").jCarouselLite({
        btnNext: ".next",
        btnPrev: ".prev",
        scroll:1,
        visible: 4,
        easing: 'easeOutExpo',
        speed: 700
    })
    .css({'width':'657px'});
    $('#pagin a').after('<span></span>');
        $('#pagin a').hover(
    function(){
        if (!$(this).parent().hasClass('active'))
        $(this).siblings('span').stop().animate({'width':'100%','height':'100%'},500,'easeOutExpo');            
        },
         function(){
        if (!$(this).parent().hasClass('active'))
        $(this).siblings('span').stop().animate({'width':'0','height':'0'},700,'easeOutExpo');  
    }
    ); 
    ```

    }

    ```
    function addAllListeners() {
        $('footer ul a').hover(
        function(){
            $(this).children('img').stop().animate({'top':'0px'},500,'easeOutExpo');  
        },
        function(){
            $(this).children('img').stop().animate({'top':'7px'},500,'easeOutExpo');  
        }
        );
        var defCol1 = $('.readMore').css('color');
        $('.readMore').hover(
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':'#f75da4','backgroundPosition':'right 2px'},600,'easeOutCubic');
            } else {
                $(this).css({'backgroundPosition':'right top'}).stop().animate({'color':'#f75da4'},600,'easeOutCubic');
            }
        },
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':defCol1,'backgroundPosition':'right 8px'},700,'easeOutCubic');  
            } else {
                $(this).css({'backgroundPosition':'right center'}).stop().animate({'color':defCol1},700,'easeOutCubic'); 
            }
        }
        );
        $('#uploadMore').click(
        function(){
            setRequest('eva');
        });

        $('#uploadMore1').click(
        function(){
            setRequest('paul');
        });
        $('#uploadMore2').click(
        function(){
            setRequest('hochzeit');
        });

        var defCol4 = $('#uploadMore').css('color');
        $('#uploadMore').hover(
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':'#f75da4','backgroundPosition':'right 2px'},600,'easeOutCubic');
            } else {
                $(this).css({'backgroundPosition':'right top'}).stop().animate({'color':'#f75da4'},600,'easeOutCubic');
            }
        },
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':defCol5,'backgroundPosition':'right 8px'},700,'easeOutCubic');  
            } else {
                $(this).css({'backgroundPosition':'right center'}).stop().animate({'color':defCol5},700,'easeOutCubic'); 
            }
        }
        );
        var defCol5 = $('#uploadMore1').css('color');
        $('#uploadMore1').hover(
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':'#f75da4','backgroundPosition':'right 2px'},600,'easeOutCubic');
            } else {
                $(this).css({'backgroundPosition':'right top'}).stop().animate({'color':'#f75da4'},600,'easeOutCubic');
            }
        },
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':defCol5,'backgroundPosition':'right 8px'},700,'easeOutCubic');  
            } else {
                $(this).css({'backgroundPosition':'right center'}).stop().animate({'color':defCol5},700,'easeOutCubic'); 
            }
        }
        );
        $('#uploadMore2').hover(
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':'#f75da4','backgroundPosition':'right 2px'},600,'easeOutCubic');
            } else {
                $(this).css({'backgroundPosition':'right top'}).stop().animate({'color':'#f75da4'},600,'easeOutCubic');
            }
        },
        function(){
            if (!MSIE){
                $(this).stop().animate({'color':defCol5,'backgroundPosition':'right 8px'},700,'easeOutCubic');  
            } else {
                $(this).css({'backgroundPosition':'right center'}).stop().animate({'color':defCol5},700,'easeOutCubic'); 
            }
        }
        );
        $('.list1 a').hover(
        function(){
            if (!MSIE){
                $(this).parent().stop().animate({'backgroundPosition':'left 3px'},500,'easeOutCubic');
            } else {
                $(this).parent().css({'backgroundPosition':'left 3px'});
            }
        },
        function(){
            if (!MSIE){
                $(this).parent().stop().animate({'backgroundPosition':'left 7px'},500,'easeOutCubic');  
            } else {
                $(this).parent().css({'backgroundPosition':'left 7px'});  
            }
        }
        );
        $('.scrollDown').hover(
        function(){
            $(this).children('span').stop().animate({'backgroundPosition':'center top'},500,'easeOutExpo');
        },
        function(){
            $(this).children('span').stop().animate({'backgroundPosition':'center bottom'},500,'easeOutExpo');  
        }
        );
        $('.scrollUp').hover(
        function(){
            $(this).children('span').stop().animate({'backgroundPosition':'center bottom'},500,'easeOutExpo');
        },
        function(){
            $(this).children('span').stop().animate({'backgroundPosition':'center top'},500,'easeOutExpo');  
        }
        );
        $('#pagin a').after('<span></span>');
        $('#pagin a').hover(
        function(){
            if (!$(this).parent().hasClass('active'))
            $(this).siblings('span').stop().animate({'width':'100%','height':'100%'},500,'easeOutExpo');            
        },
        function(){
            if (!$(this).parent().hasClass('active'))
            $(this).siblings('span').stop().animate({'width':'0','height':'0'},700,'easeOutExpo');  
        }
        );
        $('.next,.prev').hover(
        function(){
            if (!MSIE){
                $(this).children('span').css({opacity:'0',display:'block'}).stop().animate({opacity:'1'});  
            } else {
                $(this).children('span').stop().show();
            }  
        },
        function(){
            if (!MSIE){
                $(this).children('span').stop().animate({opacity:'0'},function(){$(this).css({display:'none'});});  
                }else {
                $(this).children('span').stop().hide();
            }
        }
        );  
    }

    function showSplash() {
        $('h1').stop().animate({'marginTop':'0px'},700,'easeOutExpo')
        $('.content_menu').stop().animate({'right':'-1500px'},700,'easeInExpo');
        $('#pagin a').eq(4).trigger('click');
        if (!MSIE) {$('.glow').fadeTo(500,1);} else {$('.glow').css('display','block')};
    }

    function hideSplash() {
        $('h1').stop().animate({'marginTop':'-40px'},700,'easeOutExpo');
        $('.content_menu').stop().animate({'right':'-37px'},700,'easeOutExpo');
        if (!MSIE) {$('.glow').fadeTo(500,0);} else {$('.glow').css('display','none')};
    }

    function hideSplashQ(){
        $('h1').stop().css({'marginTop':'0px'});
        $('.content_menu').css({'right':'-1500px'});
    }

    $(document).ready(function() {
        /*SUPERFISH MENU*/   
        $('.menu #menu').superfish({
            delay: 800,
            animation: {
                height: 'show'
            },
            speed: 'slow',
            autoArrows: false,
            dropShadows: false
        }); 
        $('.content_menu ul').superfish({
            delay: 800,
            animation: {
                height: 'show'
            },
            speed: 'slow',
            autoArrows: false,
            dropShadows: false
        });
    });

    function ON_LOAD(){
        //setRequest();
        MSIE = ($.browser.msie) && ($.browser.version <= 8);
        $('.spinner').fadeOut();

        hideSplashQ();

        $("#pagin").jCarouselLite({
            btnNext: ".next",
            btnPrev: ".prev",
            scroll:1,
            visible: 4,
            easing: 'easeOutExpo',
            speed: 700
        })
        .css({'width':'657px'}) 

        $('.scroll').cScroll({
            duration: 500,
            easing: 'easeOutExpo',
            step:'240px'
        });
        $('.scrollUp').click(function(){
            $(this).parent().siblings('.scroll').cScroll('up');
            return false;
        });
        $('.scrollDown').click(function(){
            $(this).parent().siblings('.scroll').cScroll('down');
            return false;
        });
        //content switch
        content = $('#content');
        content.tabs({
            show:0,
            preFu:function(_){
                _.li.css({'display':'none'});

            },
            actFu:function(_){            
                if(_.curr){
                    if (_.n == 0){
                        showSplash();
                    } else {
                        hideSplash();
                    }
                    _.curr
                    .css({'left':'-2000px'}).stop(true).show().animate({'left':'0px'},{duration:1000,easing:'easeInOutExpo'});
                }   
                if(_.prev){
                    _.prev
                    .show().stop(true).animate({'left':'-2000px'},    duration:600,easing:'easeInOutExpo',complete:function(){
                        if (_.prev){
                            _.prev.css({'display':'none'});
                        }
                        }
                    });
                }            
            }
        });
        var defColor = $('#menu>li>a').eq(0).css('color'); 
        var nav = $('.menu');
        nav.navs({
            useHash:true,
            defHash: '#!/page_splash',
            hoverIn:function(li){
                $('>a', li).stop().animate({color: '#fff','backgroundPosition':'right bottom'},400,'easeOutCubic');
            },
            hoverOut:function(li){
                if ((!li.hasClass('with_ul')) || (!li.hasClass('sfHover'))) {
                    $('> a', li).stop().animate({color: defColor,'backgroundPosition':'left top'},700,'easeOutCubic');
                }
            }
        })
        .navs(function(n){
            $('#content').tabs(n);
        });
        var defCol2 = $('.content_menu a').css('color');
        nav = $('.content_menu');
        nav.navs({
            useHash:true,
            defHash: '#!/page_splash',
            hoverIn:function(li){
                $('>a', li).addClass('menu_shadow').stop().animate({color: '#585959'},600,'easeOutCubic');
            },
            hoverOut:function(li){
                if ((!li.hasClass('with_ul')) || (!li.hasClass('sfHover'))) {
                    $('> a', li).removeClass('menu_shadow').stop().animate({color: defCol2},700,'easeOutCubic');
                }
            }
        })
        .navs(function(n){  
            $('#content').tabs(n);
        });

        setTimeout(function(){
            $('#bgStretch').bgStretch({
                align:'leftTop',
                autoplay: false,
                navs:$('#pagin').navs({})
            })
            .sImg({
                sleep: 1000,
                spinner:$('<div class="spinner"></div>').css({opacity:.5}).stop().hide(3000)
            });
        },0);

        setTimeout(function(){  $('body').css({'overflow':'visible'}); },300);    
        addAllListeners();

        $(window).trigger('resize');
    }

    $(window).resize(function (){
        if (content) content.stop().animate({'top':(windowH()-content.height())*.5},500,'easeOutCubic');
    });

    function listen(evnt, elem, func) {
        if (elem.addEventListener)  // W3C DOM
        elem.addEventListener(evnt,func,false);
        else if (elem.attachEvent) { // IE DOM
            var r = elem.attachEvent("on"+evnt, func);
            return r;
        }
    }
        listen("load", window, ON_LOAD); 
    ```

    和 bgStretch：

    ```
    enter code here
        //0.3.0
        (function($){
    $.fn.bgStretch=function(o){
        this.each(function(){
            var th=$(this),
                data=th.data('bgStretch'),
                _={
                    align:'leftTop',
                    css:{
                        leftTop:{
                            left:0,
                            right:'auto',
                            top:0,
                            bottom:'auto'
                        },
                        rightTop:{
                            left:'auto',
                            right:0,
                            top:0,
                            bottom:'auto'
                        },
                        leftBottom:{
                            left:0,
                            right:'auto',
                            top:'auto',
                            bottom:0
                        },
                        rightBottom:{
                            left:'auto',
                            right:0,
                            top:'auto',
                            bottom:0
                        }
                    },
                    preFu:function(){
                        _.img
                            .load(function(){
                                _.k=_.img.height()/_.img.width()
                                _.img
                                    .css({
                                        width:'100%',
                                        height:'100%',
                                        position:'absolute',
                                        zIndex:-1,
                                        left:0,
                                        top:0
                                    })
                            })
                        _.img[0].complete
                            &&_.img.trigger('load')
                        _.me
                            .css({
                                position:'absolute',
                                zIndex:-1
                            })
                            .css(_.css[_.aalign=_.align])
                        _.wrap
                            .css({
                                width:'100%',
                                height:'100%',
                                position:'fixed',
                                left:0,
                                top:0,
                                overflow:'hidden',
                                zIndex:-1
                            })
                    },
                    resizeFu:function(){
                        var wh=_.win.height(),
                            ww=_.win.width(),
                            k=wh/ww
                        if(_.aalign!=_.align)
                            _.me
                                .css(_.css[_.aalign=_.align])

                        if(k<_.k)
                            _.me
                                .css({
                                    width:ww,
                                    height:ww*_.k
                                })
                        else
                            _.me
                                .css({
                                    width:wh/_.k,
                                    height:wh
                                })

                    },
                    chngFu:function(str){
                        $.fn.sImg
                            ?_.me.sImg(str)
                            :_.img.attr({src:str})
                    },
                    init:function(){
                        _.win=$(window)                     
                        _.img=$('img',_.me)
                        _.me.wrap('<div></div>')
                        _.wrap=_.me.parent()

                        _.preFu()
                        $(window)
                            .resize(function(){
                                _.resizeFu()
                            })
                            .trigger('resize')
                        _.navs&&_.navs.data('navs')
                            &&_.navs.navs(function(n,__){
                                _.chngFu(__.href)
                            })
                    }
                }
            data?_=data:th.data({bgStretch:_})
            typeof o=='object'&&$.extend(_,o)
            _.me||_.init(_.me=th)

            typeof o=='string'&&_.chngFu(o)
        })
        return this     
    }
        })(jQuery) 
    ```

    最后是来自页面 ID 的 php 的输出：

    ```
    <ul><li class='active'><a href='specials/hochzeit/bg_pic3.jpg'><img src='specials/hochzeit/small_bg_pic3.jpg' alt></a></li><span style='width: 100%; height: 100%; overflow: hidden;'></span><li><a href='specials/hochzeit/bg_pic1.jpg'><img src='specials/hochzeit/small_bg_pic1.jpg' alt></a></li><span style='width: 0px; height: 0px;'></span></ul> 
    ```

    非常感谢！！也许有人可以找到它或有线索！干杯!

# iphone - 按钮在锁屏中不起作用

> ID：12252319
> 
> 赞同：0
> 
> 时间：2012-09-03T18:01:50.790
> 
> 标签：iphone, objective-c, jailbreak

我在锁屏上有一个按钮可以在触摸时显示警报，我只是在玩这个东西并尝试这样做，但是当我触摸按钮时它会崩溃并重新进入安全模式。我在我的 iPhone 中使用 theos 运行它。这是我的代码：

```
#import <UIKit/UIKit.h>

@interface SBAwayView : UIView

@end

@interface SBAwayController

UIButton *myButton;
-(void)unlockWithSound : (BOOL)sound;

@end

%hook SBAwayController

-(id)lock{

SBAwayView *v = MSHookIvar<id>(self, "_awayView");

myButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
myButton.frame = CGRectMake(21, 80, 100, 35);
[myButton setTitle:@"My Button" forState:UIControlStateNormal];
[myButton addTarget:self action:@selector(myButtonPressed)     forControlEvents:UIControlEventTouchUpInside];

[v addSubview:myButton];

%orig;
}

-(void)myButtonPressed{

UIAlertView *theAlert = [[UIAlertView alloc] initWithTitle:@"Title of Alert"  message:@"Message of Alert" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK",  nil];
[theAlert show];
[theAlert release];

}

%end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T02:44:48.723

You needed %new(v@:) before your void;

```
%new(v@:)
-(void)myButtonPressed{

UIAlertView *theAlert = [[UIAlertView alloc] initWithTitle:@"Title of Alert"  message:@"Message of Alert" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK",  nil];
[theAlert show];
[theAlert release];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:47:15.223

首先尝试调试并查看函数是否被调用。

然后它也崩溃然后尝试使用自动释放

```
UIAlertView *theAlert = [[[UIAlertView alloc] initWithTitle:@"Title of Alert" message:@"Message of Alert" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK",  nil] autorelease] ;
[theAlert show]; 
```

# c++ - clam-NetworkEditor 无法编译

> ID：12252327
> 
> 赞同：0
> 
> 时间：2012-09-03T18:02:36.903
> 
> 标签：c++, c

当我尝试编译 Clam-NetworkEditor-1.4.0 时，出现以下错误：

在 src/widgets/generated/moc_QFirstPerson.cxx:10:0: src/widgets/generated/../QFirstPerson.hxx:348:15 中包含的文件中：错误：函数定义未声明参数 src/widgets/generated/。 ./QFirstPerson.hxx: 在成员函数'virtual void QFirstPerson::paintScene()': src/widgets/generated/../QFirstPerson.hxx:202:21: error: '((QFirstPerson*)this)->QFirstPerson ::sphere' 不能用作函数 src/widgets/generated/../QFirstPerson.hxx：在成员函数 'void QFirstPerson::drawLight(float*, float*, const char*, const QColor&)': src/小部件/生成/../QFirstPerson.hxx:231:20: 错误: '((QFirstPerson*)this)->QFirstPerson::sphere' 不能用作函数 scons: *** [src/widgets/generated/generated/ moc_QFirstPerson.os] 错误 1 ​​scons：建筑因错误而终止。

这是来自 QFirstPerson.hxx 的代码

```
#ifndef QFirstPerson_hxx
#define QFirstPerson_hxx

#include <QtOpenGL/QGLWidget>
#undef GetClassName
#include <QtGui/QKeyEvent>
#include <iostream>
#include <cmath>
#include <GL/glu.h>
static float * vColor(const QColor & color)
{
        static float vcolor[4];
        vcolor[0]=color.redF();
        vcolor[1]=color.greenF();
        vcolor[2]=color.blueF();
        vcolor[3]=color.alphaF();
        return vcolor;
}
class Light
{
        unsigned _index;
        QColor _ambient;
        QColor _specular;
        QColor _diffuse;
        float _position[4];
        float _direction[4];
        int _cutoff;
        float _exponent;
        bool _enabled;
public:
    Light(unsigned index,
    float * position, float * direction,
    int cutoff,
    float exponent,
    const QColor & diffuse=Qt::white,
    const QColor & specular=Qt::white,
    const QColor & ambient=Qt::black)
    : _index(index)
    , _ambient(ambient)
    , _specular(specular)
    , _diffuse(diffuse)
    , _cutoff(cutoff)
    , _exponent(exponent)
    , _enabled(true)
{
    for (unsigned i=0; i<4; i++) _position[i]=position[i];
    for (unsigned i=0; i<4; i++) _direction[i]=direction[i];
}
void place()
{
    glLightfv(GL_LIGHT0+_index, GL_AMBIENT, vColor(_ambient));
    glLightfv(GL_LIGHT0+_index, GL_DIFFUSE, vColor(_diffuse));
    glLightfv(GL_LIGHT0+_index, GL_SPECULAR, vColor(_specular));
    glLightfv(GL_LIGHT0+_index, GL_SPOT_DIRECTION, _direction);
    glLightfv(GL_LIGHT0+_index, GL_POSITION, _position);
    glLighti (GL_LIGHT0+_index, GL_SPOT_CUTOFF, _cutoff);
    glLightf (GL_LIGHT0+_index, GL_SPOT_EXPONENT, _exponent);
    glLightf (GL_LIGHT0+_index, GL_CONSTANT_ATTENUATION, 1.0f);
    glLightf (GL_LIGHT0+_index, GL_LINEAR_ATTENUATION, 0.2f);
    glLightf (GL_LIGHT0+_index, GL_QUADRATIC_ATTENUATION, 0.0f);
    (*(_enabled? &glEnable:&glDisable) )(GL_LIGHT0+_index);
}
};

class QFirstPerson : public QGLWidget
{
        double _viewX;
        double _viewY;
        double _viewRotation;
        double _viewElevation;
        double _sourceX;
        double _sourceY;
        double _sphere; 
        GLUquadric * sphere;
        Q_OBJECT
public:
QFirstPerson(QWidget * parent=0)
    : QGLWidget(parent)
    , _viewX(0)
    , _viewY(-1)
    , _viewRotation(0)
    , _viewElevation(0)
    , _sourceX(0)
    , _sourceY(0)
    , _sphere(0)
{
}
void initializeGL()
{
    std::cout << "init" << std::endl;
    glEnable(GL_TEXTURE_2D);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glShadeModel(GL_SMOOTH);
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glEnable(GL_DEPTH_TEST);
    glEnable(GL_COLOR_MATERIAL);
    glDepthFunc(GL_LESS);
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
    bool blend = true;
    if (blend) glEnable(GL_BLEND);
    bool ligth = true;
    if (ligth) glEnable(GL_LIGHTING);
}
void resizeGL(int width, int height)
{
    std::cout << "resize" << std::endl;
    glViewport(0, 0, width, height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(90.0f, (GLfloat)width / (GLfloat)height, 0.01f, 1250.0f);
    glMatrixMode(GL_MODELVIEW);
}
void paintGL()
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glPushMatrix();
    glRotatef( -_viewElevation, 1.0f, 0.0f, 0.0f);
    glRotatef(180-_viewRotation, 0.0f, 1.0f, 0.0f);
    glTranslatef(-_viewX, 0, -_viewY); // y is at z
    placeLights();
    paintScene();
    glPopMatrix();
    glDepthFunc(GL_NONE);
    paintDecoration();
}
virtual void placeLights()
{
    glLightModelfv(GL_LIGHT_MODEL_AMBIENT, vColor("#505060"));
    static GLfloat position0[] = { 0.0f, 1.5f, 0.0f, 1.0f };
    static GLfloat direction0[] = { 0.0f, -0.5f, 0.0f, 1.0f };
    Light light0(0, position0, direction0, 90, 2, "#555", "#555", "#555");
    light0.place();
    static GLfloat position1[] = { -5.0f, 1.0f, 5.0f, 1.0f };
    static GLfloat direction1[] = { .5f, -.5f, -.5f, 1.0f };
    Light light1(1, position1, direction1, 90, 2, "#700", "#770", "#700");
    light1.place();
    static GLfloat position2[] = { 5.0f, 1.0f, -5.0f, 1.0f };
    static GLfloat direction2[] = { -1.0f/5, -1.0f/5, 1.0f, 1.0f };
    Light light2(2, position2, direction2, 90, 2, "#077", "#007", "#077");
    light2.place();
    drawLight(position0, direction0, "Light0", "#777");
    drawLight(position1, direction1, "Light1", "#a00");
    drawLight(position2, direction2, "Light2", "#0aa");
}
void roomWall(float bottom, float top)
{
    glBegin(GL_QUAD_STRIP);
    for (unsigned i=0; i<20; i++)
    {
        glVertex3f(10.f-i,top,10.f);
        glVertex3f(10.f-i,bottom,10.f);
    }
    for (unsigned i=0; i<20; i++)
    {
        glVertex3f(-10.f,top,10.f-i);
        glVertex3f(-10.f,bottom,10.f-i);
    }
    for (unsigned i=0; i<20; i++)
    {
        glVertex3f(-10.f+i,top,-10.f);
        glVertex3f(-10.f+i,bottom,-10.f);
    }
    for (unsigned i=0; i<20; i++)
    {
        glVertex3f(10.f,top,-10.f+i);
        glVertex3f(10.f,bottom,-10.f+i);
    }
    glVertex3f(10.f,top,10.f);
    glVertex3f(10.f,bottom,10.f);
    glEnd();
}
virtual void paintScene()
{
    glMaterialfv(GL_FRONT, GL_DIFFUSE, vColor("white"));
    glMaterialfv(GL_FRONT, GL_AMBIENT, vColor("white"));
    glMaterialfv(GL_FRONT, GL_SPECULAR, vColor("#333"));
    glMaterialf(GL_FRONT, GL_SHININESS, 0);
    glColor4fv(vColor(Qt::white));
    roomWall(-1.75, -1);
    roomWall(-1, 0);
    roomWall(0, 1);
    roomWall(1, 1.75);
    qglColor(Qt::yellow);
    drawPlane(-1.75);
    glColor4fv(vColor("#aaa"));
    drawPlane(+1.75);
    qglColor(QColor("#ffa"));
    renderText(0., 1, 10.-1, "North (+Y)");
    renderText(0., 1, -10.+1, "South (-Y)");
    renderText(10.-1, 1, 0., "East (+X)");
    renderText(-10.+1, 1, 0., "West (-X)");
    glPushMatrix();
        glColor4fv(vColor("#b22"));
        glTranslatef(_sourceX,0,_sourceY);
        renderText(0., 1, 0., "Source");
        glBegin(GL_LINES);
            glVertex3f(0.,1.,0.);
            glVertex3f(0.,0.,0.);
        glEnd();
        gluSphere(sphere(), 0.5f, 40, 20);
    glPopMatrix();
}
void drawPlane(float height)
{
    for (unsigned j=0; j<20; j++)
    {
        glBegin(GL_QUAD_STRIP);
        for (unsigned i=0; i<=20; i++)
        {
            glVertex3f(10.f-j,height,10.f-i);
            glVertex3f(10.f-(j+1),height,10.f-i);
        }
        glEnd();
    }
}
void drawLight(float * position, float * direction, const char * label, const QColor & color)
{
    glPushMatrix();
    glColor4fv(vColor(color));
    glTranslatef(position[0],position[1],position[2]);
    renderText(0., 2, 0., label);
    glMaterialfv(GL_FRONT, GL_EMISSION, vColor(color));
    glBegin(GL_LINES);
        glVertex3f(0.,0.,0.);
        glVertex3fv(direction);
        glVertex3f(0.,2.,0.);
        glVertex3f(0.,0.,0.);
    glEnd();
    gluSphere(sphere(), 0.2f, 40, 20);
    glMaterialfv(GL_FRONT, GL_EMISSION, vColor("black"));
    glPopMatrix();
}
virtual void paintDecoration()
{
    glDisable(GL_LIGHTING);
    glDisable(GL_DEPTH_TEST);
    QString emiterString = tr("Emitter: %1, %2")
            .arg(QString::number(_sourceX,'d',2))
            .arg(QString::number(_sourceY,'d',2))
            ;
    QString receiverString = tr("Receiver: %1, %2 angle %3")
            .arg(QString::number(_viewX,'d',2))
            .arg(QString::number(_viewY,'d',2))
            .arg(QString::number(_viewRotation,'d',0))
            ;
    glColor4fv(vColor("black"));
    renderText(10,20, receiverString);
    renderText(10,40, emiterString);
    glBegin(GL_LINES);
    glVertex3f(0,.06,-.1);
    glVertex3f(0,.02,-.1);
    glVertex3f(0,-.06,-.1);
    glVertex3f(0,-.02,-.1);
    glVertex3f(.06,0,-.1);
    glVertex3f(.02,0,-.1);
    glVertex3f(-.06,0,-.1);
    glVertex3f(-.02,0,-.1);
    glEnd();
    glEnable(GL_LIGHTING);
    glEnable(GL_DEPTH_TEST);
}
void keyPressEvent( QKeyEvent * event)
{
    std::cout << "key" << std::endl;
    float cosOrientation = std::cos(_viewRotation*M_PI/180.f);
    float sinOrientation = std::sin(_viewRotation*M_PI/180.f);
    bool strafe = event->modifiers() & Qt::AltModifier;
    bool run = event->modifiers() & Qt::ShiftModifier;
    float step = run ? .4f : .1f;
    switch (event->key())
    {
        case Qt::Key_Left:
            if (strafe)
            {
                _viewX += cosOrientation * step;
                _viewY -= sinOrientation * step;
                emitPositionChange();
            }
            else
            {
                _viewRotation+=10;
                emit orientationChanged(_viewRotation);
            }
        break;
        case Qt::Key_Right:
            if (strafe)
            {
                _viewX -= cosOrientation * step;
                _viewY += sinOrientation * step;
                emitPositionChange();
                emit posChanged(QPointF(_viewX, _viewY));
            }
            else
            {
                _viewRotation-=10;
                emit orientationChanged(_viewRotation);
            }
        break;
        case Qt::Key_PageUp:
            _viewElevation+=10;
        break;
        case Qt::Key_PageDown:
            _viewElevation-=10;
        break;
        case Qt::Key_Up:
            _viewX += sinOrientation * step;
            _viewY += cosOrientation * step;
            emitPositionChange();
        break;
        case Qt::Key_Down:
            _viewX -= sinOrientation * step;
            _viewY -= cosOrientation * step;
            emitPositionChange();
        break;
        case Qt::Key_A:
            _sourceX+=step;
        break;
        case Qt::Key_D:
            _sourceX-=step;
        break;
        case Qt::Key_W:
            _sourceY+=step;
        break;
        case Qt::Key_S:
            _sourceY-=step;
        break;
        case Qt::Key_Escape:
            close();
        break;
        default:
            event->ignore();
            return;
        return;
    }
    while (_viewRotation>=360.f) _viewRotation-=360.f;
    while (_viewRotation<0.f) _viewRotation+=360.f;
    event->accept();
    updateGL();
}
signals:
        double posChanged(QPointF point);
        double xPosChanged(double x);
        double yPosChanged(double y);
        double orientationChanged(double degrees);
private:
    GLUquadric * sphere
    {
    if (!_sphere) _sphere = gluNewQuadric();
    return _sphere;
    }
    void emitPositionChange()
    {
    emit posChanged(QPointF(_viewX, _viewY));
    emit xPosChanged(_viewX);
    emit yPosChanged(_viewY);
    }
};

#endif// QFirstPerson_hxx 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:15:00.083

你有这个声明

```
class QFirstPerson : public QGLWidget
{
        double _viewX;
        double _viewY;
        double _viewRotation;
        double _viewElevation;
        double _sourceX;
        double _sourceY;
        double _sphere; 
        GLUquadric * sphere;   // <-- 
```

但后来这段代码

```
gluSphere(sphere(), 0.5f, 40, 20); 
```

假设这`sphere`是可调用的。编译器不同意。

# ruby-on-rails - Goto Anything of Sublime Text 2 中的这些数字是什么

> ID：12252340
> 
> 赞同：18
> 
> 时间：2012-09-03T18:04:10.533
> 
> 标签：ruby-on-rails, ruby, sublimetext2

`Ctrl+P (Goto Anything)`我用谷歌搜索了很多，但不幸的是，当您在 Sublime Text 2 中时，除了文件名之外，我无法找出这些数字的含义。

想法？

![在此处输入图像描述](../Images/bb02c51aff0bbf352618290a6d9ad8bf.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-01T10:43:45.583

据传闻：

*   指示您的输入用于描述该文件的可能性。
*   随着匹配质量的增加。在屏幕截图中输入“应用程序”应该会产生更高的数字。
*   随着文件的流行而增加。因此，如果有多个匹配项，它将首先显示最繁忙的文件。

# asp.net - 在 _LogonPartial 中显示模型数据

> ID：12252343
> 
> 赞同：2
> 
> 时间：2012-09-03T18:04:25.873
> 
> 标签：asp.net, asp.net-mvc-3

我正在使用新项目模板中的 ASP MVC3，它为我提供了 _Layout.cshtml 和 _LogOnPartial.cshtml。在 _LogOnPartial 中有用户登录时显示的文本。如何从我的模型中显示我自己的附加数据并在所有视图中显示？

这是我尝试过的，但当然它不起作用，因为没有模型数据：

```
@if(Request.IsAuthenticated) {
<text>Hello, <strong>@User.Identity.Name</strong>! - Account Balance: @Model.GetAccountBalance()
[ @Html.ActionLink("Log Off", "LogOff", "Account") ]</text>
}
else {
@:[ @Html.ActionLink("Log On", "LogOn", "Account") ]
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:16:06.203

我们有类似的东西并使用 Html.RenderAction() 来实际显示帐户信息框。基本上，这将是一个非常简单的设置

**布局视图**

```
@{Html.RenderAction("Information", "Account");} 
```

**视图模型**

```
public class AccountInformation(){
    public bool IsAuthenticated {get;set;}
    public string UserName {get;set;}
    public int AccountBalance {get;set;}
} 
```

**帐户控制器**

```
public PartialViewResult Information(){
   var model = new AccountInformation();
   model.IsAutenticated = httpContext.User.Identity.IsAuthenticated;
   if(model.IsAuthenticated){
       model.UserName = httpContext.User.Identity.Name;
       model.AccountBalance = functionToGetAccountBalance();
       //Return the fully populated ViewModel
       return this.PartialView(model);
   }
   //return the model with IsAuthenticated only set since none of the 
   //other properties are needed
   return this.ParitalView(model);
} 
```

**信息视图**

```
@model AccountInformation

@if(Model.IsAuthenticated) {
<text>Hello, <strong>@Model.UserName</strong>! - Account Balance: @Model.AccountBalance
[ @Html.ActionLink("Log Off", "LogOff", "Account") ]</text>
}
else {
@:[ @Html.ActionLink("Log On", "LogOn", "Account") ]
} 
```

这做了一些事情并带来了一些选择

1.  使您的视图不必在 HttpContext 周围嗅探。让控制器来处理。
2.  您现在可以将它与 [OutputCache] 属性结合使用，这样您就不必每次都渲染它。单身的。页。
3.  如果您需要向 Account Information 屏幕添加更多内容，只需更新 ViewModel 并填充数据即可。没有魔法，没有 ViewBag 等。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-03T20:10:44.173

您必须修改此视图上使用的 ViewModel 并向其中添加其他数据。

# mysql - MYSQL 选择特定日期后的行（行类型为 varchar）

> ID：12252345
> 
> 赞同：0
> 
> 时间：2012-09-03T18:04:43.247
> 
> 标签：mysql, date, varchar

我正在尝试选择特定日期之后的所有列，但诀窍是“日期”列是 varchar

我有这个

```
SELECT * FROM `users` WHERE STR_TO_DATE(birthday,'%m/%d/%Y') > '10-10-2000' 
```

例如，我想选择所有生日在 2000 年 10 月 10 日之后的用户，但这只会返回所有行。

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:11:06.320

您正在比较数据和字符串。我会使用`CAST`：

```
WHERE STR_TO_DATE(birthday,'%m/%d/%Y') > CAST('2000-10-10' AS date) 
```

另请注意，我更改了第二个的格式以匹配 mysql 的期望。您也可以在此处使用 STR_TO_DATE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:16:30.857

我们需要知道字符串生日的格式，现在你说它是例如 2001 年 12 月 31 日。那正确吗？

如果您有多个字符串，请考虑使用相同的 STR_TO_DATE 格式：

```
WHERE STR_TO_DATE(birthday, '%m/%/d/%Y') BETWEEN STR_TO_DATE(some_date, '%m/%/d/%Y')
                                                           AND STR_TO_DATE(another_date, '%m/%/d/%Y') 
```

更多信息： [http ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:09:58.550

I think mysql dates are usually yyyy-mm-dd which means you should change the string at the end to 2000-10-10.

Try that and let me know if that works.

# c++ - SFML TCP 数据包被更改

> ID：12252346
> 
> 赞同：0
> 
> 时间：2012-09-03T18:04:44.237
> 
> 标签：c++, tcp, packet, sfml, corruption

在 SFML 论坛中未能获得任何帮助后，我决定看看这里是否有人可以提供帮助。我有一个应用程序，它通过与服务器应用程序的 TCP 连接进行自我更新。这工作得很好，除了一个特定的数据包传输，其中数据包以某种方式改变。服务器发送一个包含数字 1 的数据包：

```
pack << sf::Uint8(1);
ClientSocket.Send(pack); 
```

（其中`pack`sf::Packet`ClientSocket`类型和 sf::SocketTCP 类型）

使用我的调试器单步执行实际上确实确认了这些行已执行，并且我的客户端中的下一个 Receive 调用是接下来的几行：

```
sock.Receive(pack);
sf::Uint8 conf;
pack >> conf; 
```

（这里`pack`又是一个 sf::Packet，`sock`是一个 SocketTCP）

但是，不知何故，在我的客户端中，conf 显示为具有零值（我的调试器确认了这一点）并且它确实如此（下一行根据值切换）。我在同一台机器上运行这两个应用程序，并且它们都将彼此读取为“127.0.0.1”，因此数据包（如果我理解正确的话）不会通过我的路由器，或者真的不会离开我的机器。关于为什么我的数据包被损坏的任何想法？

作为记录，如果有任何帮助，我正在使用 SFML 1.6 和我的应用程序在 Debian Squeeze Linux 机器上运行。

编辑：根据请求，这是我的应用程序中的更多代码。

首先，我的客户与此更新程序特别相关的部分：

```
cout << "Connecting to update server." << endl;
sf::IpAddress server = sf::IpAddress::LocalHost;
sf::TcpSocket sock;
if (sock.connect(server, PORT, sf::seconds(20.0f)) != sf::Socket::Done)
    return false;

cout << "Connected. Searching for updates for updater." << endl;

sf::Packet pack;
std::string lastUpdate = getLastUpdate();

#ifdef __WXGTK__
pack << "uupdate" << lastUpdate << sf::Uint8(1);
#elif defined(__WXMSW__)
pack << "uupdate" << lastUpdate << sf::Uint8(2);
#elif defined(__WXOSX__)
pack << "uupdate" << lastUpdate << sf::Uint8(3);
#endif

sock.send(pack);

pack.clear();

sock.receive(pack); //THIS IS THE PART WHERE IT BREAKS
sf::Int32 conf;
pack >> conf;

if (conf == 1) { //There is an update!
    cout << "Update found!" << endl;

    pack << "begin" << sf::Uint32(512);
    sock.send(pack);

    pack.clear();

    sock.receive(pack);
    pack >> conf;

    if (conf == 0) { //No errors
        wxFileOutputStream* out = new wxFileOutputStream(wxString(UPDATER, StrConv).append(".temp"));

        char* data = new char[512];
        while (data != chara("done") && data != chara("error")) {
            sock.receive(pack);
            sf::Int32 size;
            pack >> size;
            data = const_cast<char*>((const char*)pack.getData());

            out->Write(data, size);
        }
        out->Close();
        if (data == chara("done"))
            wxCopyFile(wxString(UPDATER, StrConv).append(".temp"), wxString(UPDATER, StrConv));
        wxRemoveFile(wxString(UPDATER, StrConv).append(".temp"));
    }
}

cout << "Updater is up-to-date. Executing updater." << endl;

sock.disconnect();

bool success;
if (wxTheApp->argc == 1)
    success = wxExecute(wxT(UPDATER));
else
    success = wxExecute(wxString(UPDATER, StrConv).append(wxTheApp->argv[1]));

return success; 
```

然后是与这些更新相关的服务器部分：

```
 //ClientSocket has already been initalised by way of a TcpListener
cout << "Checking for updater patches for client at " << ClientAddress.toString() << endl;

std::string lastUpdate;
pack >> lastUpdate;
sf::Uint8 os;
pack >> os;

//Check last time updater was changed
struct tm* clock;
struct stat attribs;
if (os == 1)
stat("Linux/Updater", &attribs);
else if (os == 2)
stat("Windows/Updater.exe", &attribs);
else if (os == 3)
stat("Mac/Updater", &attribs);
clock = gmtime(&(attribs.st_mtime));
time_t lastWrite = mktime(clock);

time_t clientUpdate = stringToNumber<time_t>(lastUpdate.c_str());

if (lastWrite > clientUpdate) {
    cout << "Found updater patches for client at " << ClientAddress.toString() << endl;

    pack << sf::Int32(1);
    ClientSocket->send(pack); //THIS IS THE PART WHERE IT BREAKS

    pack.clear();

    ClientSocket->receive(pack);
    std::string mes;
    pack >> mes;

    if (mes != "begin") {
        cerr << "Client at " << ClientAddress.toString() << " sent unrecognised message: " << mes << ". Ending conversation." << endl;
        ClientSocket->disconnect();
        return false;
    }

    sf::Uint32 size;
    pack >> size;

    cout << "Beginning to send updater patch to " << ClientAddress.toString() << endl;

    ifstream in;

    if (os == 1)
        in.open(chara("Linux/Updater"), ios_base::in | ios_base::binary);
    else if (os == 2)
        in.open(chara("Windows/Updater.exe"), ios_base::in | ios_base::binary);
    else if (os == 3)
        in.open(chara("Mac/Updater"), ios_base::in | ios_base::binary);

    if (in.fail()) {
        pack << sf::Uint8(1);
        ClientSocket->send(pack);
        cerr << "Failed to open updater at request of " << ClientAddress.toString() << ". Closing connection." << endl;
        ClientSocket->disconnect();
        return false;
    }

    pack << sf::Uint8(0);
    ClientSocket->send(pack);

    pack.clear();

    //Get length of file
    in.seekg(0, ios::end);
    int length = in.tellg();
    in.seekg(0, ios::end);

    char* buf = new char[size];

    for (unsigned int i = 0; i < length / size; i++) { //Read and send every `size`-sized block we can
        in.read(buf, size);
        pack << sf::Int32(size) << buf;
        ClientSocket->send(pack);
    }

    in.read(buf, length % size);
    pack << sf::Int32(length % size) << buf;
    ClientSocket->send(pack);

    pack.clear();

    pack << "done";
    ClientSocket->send(pack);

    pack.clear();
} else {
    pack << sf::Int8(0);
    ClientSocket->send(pack);
} 
```

编辑：我知道自从这里有任何帖子以来已经快一个月了，但我仍然对此有疑问。我对如何解决这个问题束手无策。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T09:03:02.197

这不是一个真正的答案，但我不能对这个问题添加评论，所以......

SFML 1.6 没有得到维护，如果 SFML 本身存在问题，它可能已经在 2.0 版中得到解决。[您可以在此处](http://www.sfml-dev.org/download.php)下载 RC 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T01:16:44.897

因此，事实证明问题相当简单。你知道我是如何添加很多`pack.clear()`行的吗？结果我忘了在接收原始数据和在服务器上发送原始数据之间添加一个。所以我的数据包仍然有第一次调用留下的数据`sock.receive(pack)`（这是上面发布的服务器代码开头的几行）。我花了这么长时间才看到。打个电话，`pack.clear()`问题就解决了。

# google-drive-api - 在特定文件夹中搜索 Google Drive

> ID：12252347
> 
> 赞同：13
> 
> 时间：2012-09-03T18:04:46.880
> 
> 标签：google-drive-api

我正在尝试将 Google Drive 用作许多不同类型文档的存储库。我将这些文档排列在几个不同的文件夹中。

当我执行搜索时，无论我当前是否位于特定文件夹中，它似乎都会搜索我的整个 Google Drive 帐户以获取匹配的结果。

这给我带来了一个问题，因为我希望能够将我的搜索细化到给定的文档分组内。

例如，如果我正在搜索与我的工作相关的文档，我不希望在我的搜索中或在我的个人目录中显示文档。

有没有办法优化我的搜索以仅显示指定文件夹及其子文件夹中的文档？我知道我可以根据文件类型和所有权优化搜索，但这对我不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T22:26:50.970

使用[Google Drive SDK](https://developers.google.com/drive/)，您可以对[`<folder_id> in parents`](https://developers.google.com/drive/search-parameters).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-15T21:23:57.493

我包含的代码允许我搜索特定文件夹中的文件正文。我正在使用它来搜索扫描的文档，并让它根据我指定的搜索条件将文件移动到另一个文件夹。

这样做的好处是它将搜索文档的正文并返回所有符合您搜索条件的文档。如您所见，我还可以指定日期范围，您可以使用其他运算符来定义您的搜索。[https://developers.google.com/drive/web/search-parameters](https://developers.google.com/drive/web/search-parameters)。

这对我来说是一个很棒的发现，我希望它可以帮助其他人。

```
function searchFolder(){
var parent = DriveApp.getFolderById(‘*******************’); // folder Id
var search = 'modifiedDate >"2014-08-01" and modifiedDate  < "2014-12-31" and fullText contains "PUT   SEARCH TEXT HERE"';
var specificFolder = parent.searchFiles(search);

while (specificFolder.hasNext()) {
  var file = specificFolder.next();
  Logger.log(file.getName());
  Logger.log(file.getId());
  }

 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-19T11:57:30.687

我找到了一种使用**描述**字段的解决方法。

在我的特殊情况下，我要搜索的文件夹中创建的所有文件都是由我自己的脚本以编程方式创建的，但是编写脚本来（重新）将描述字段定义到特定文件夹中的所有文件中非常简单`.setDescription(DESCRIPTION)`。一旦完成...

好消息是，谷歌驱动器中的标准搜索会根据描述字段给出结果，包括在搜索字段中设置的值（以及您想要在这些文件中查找的任何数据），您将获得所需的结果。

当然，您需要删除描述字段（或者，至少，过度拥挤它;-)

因为，我想你们所有人，我仍在等待标准搜索字段中的文件夹关键字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-19T12:18:53.960

我在这个 Chrome 扩展中实现了这个功能。 [https://chrome.google.com/webstore/detail/advanced-drive-search/chomjcpadndbjgkanbaakmjehdoighab](https://chrome.google.com/webstore/detail/advanced-drive-search/chomjcpadndbjgkanbaakmjehdoighab)

您可以在此处查看代码 [https://github.com/kissrobber/advanced_google_drive_search_chrome_extension](https://github.com/kissrobber/advanced_google_drive_search_chrome_extension)

这样做是

*   获取所有文件夹
*   使用 folder_id 和后代 folder_ids 构建查询。像这样 `(<folder_id> in parents or <folder_id> in parents or ....)`

如果您对性能有疑虑，请尝试 Chrome 扩展程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-28T13:08:51.167

据我所知，您必须为每个子文件夹执行此操作，但 API（和我的应用程序）将按文件夹搜索。

我编写了一个使用 API 按文件夹搜索的应用程序。它有点慢，所以在加载时请耐心等待。

[https://script.google.com/macros/s/AKfycby6G32K-vKCiLmoKvMtG64cYPHEREEx1PY5IoYrEYaR6WAfbXs/exec](https://script.google.com/macros/s/AKfycby6G32K-vKCiLmoKvMtG64cYPHEREEx1PY5IoYrEYaR6WAfbXs/exec)

```
// -----------------
var sr = DocsList.getFolder("temp_scripts").find("var");
var i = 0;
for(i=0;i<sr.length;i++)
{
  var r = sr[i];
  Logger.log('name='+r.getName());
  Logger.log('parent=' +r.getParents()[0].getName() );
  Logger.log('---');
}
// ----------------- 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-09T12:30:59.657

还有另一种不需要任何第三方应用程序或扩展的解决方法。

*   删除您的文件夹（您想在其中搜索内容）
*   使用**is:trashed**过滤器搜索。例如：`is:trashed query_string`
*   恢复您的文件夹

# java - 如何克服freemarker树集按字母顺序排序int键？

> ID：12252350
> 
> 赞同：1
> 
> 时间：2012-09-03T18:05:11.020
> 
> 标签：java, spring, hashmap, freemarker, treeset

我有一个树集。

字符串键实际上是一个 int 的字符串值，因为 freemarker 不允许 int 作为映射的键，并且由于这是一个排序的映射，它对它的排序如下：

1
10
11
12
2
3
4
5
6
7
8
9

任何人都知道如何解决这个问题并使其按数字顺序打印？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:07:18.757

Construct the map with an appropriate comparator via the constructor [`TreeMap(Comparator)`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html#TreeMap%28java.util.Comparator%29).

(Or TreeSet, if that's what you actually mean; you mention both sets and maps.)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:08:29.137

`String` internally imposes a [*lexicographic order*](http://en.wikipedia.org/wiki/Lexicographical_order) via [`compareTo`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#compareTo%28java.lang.String%29).

> Compares two strings lexicographically.

If you don't want that, consider specifying a custom [`Comparator`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html) e.g.

```
final Map<String, ...> map = new TreeMap<String, ...>(new Comparator<String>() {

  public int compare(final String a, final String b) {
    return Integer.valueOf(a).compareTo(Integer.valueOf(b));
  }
}); 
```

# qt - Reset page to initial state qml

> ID：12252357
> 
> 赞同：0
> 
> 时间：2012-09-03T18:05:42.357
> 
> 标签：qt, properties, qt4, qml

I'm using this code to load a page

```
 onClicked:
            {
                creationDetailsSheetLoader.source = "CreationDetailsPage.qml"
                creationDetailsSheetLoader.item.reset()
                pageStack.push(creationDetailsSheetLoader.item)
            } 
```

I'd like to have the data

```
property string iconPath: ""
property string iconName: ""
property string appNameString: ""
property string desktop: "" 
```

reset after each exit from the page

I have components properties set this way

```
 text: ( desktop == "" ) ? "No app selected" : desktop 
```

If I do

```
function reset()
{
    iconName = ""
    iconPath = ""
    appNameString = ""
    desktop = ""
} 
```

and call this onLoaded of the loader, the component properties, as the above specified stay the same What am I doing wrong? Or is there any easy way of resetting the page to the initial state

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:20:49.523

问题是我删除了属性绑定，就像那样

```
entryName.text = "somestring" 
```

# c# - Process IsFocused .net C++ or C#

> ID：12252360
> 
> 赞同：-6
> 
> 时间：2012-09-03T18:06:02.247
> 
> 标签：c#, c++, focus

How to check in Process object is Focused? Please reply with c++ od c# code Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:09:24.270

You can use this code based on GetForegroundWindow()

```
var process = GetForegroundWindow();
if (process != IntPtr.Zero) {
    return true;       // he has focus
} 
```

# design-patterns - Does Liskov Substitution Principle also apply to classes implementing interfaces?

> ID：12252363
> 
> 赞同：7
> 
> 时间：2012-09-03T18:06:29.197
> 
> 标签：design-patterns, liskov-substitution-principle

1) Does LSP also apply to interfaces, meaning that we should be able to use a class implementing a specific interface and still get the expected behavior?

2) If that is indeed the case, then why is programming to an interface considered a good thing ( BTW- I know that programming to an interface increases loose coupling ), if one of the main reasons against using inheritance is due to risk of not complying to LSP? Perhaps because:

a) benefits of loose coupling outweight the risks of not complying to LSP

b) compared to inheritance, chances that a class ( implementing an interface ) will not adher to LSP are much smaller

thank you

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-03T18:11:45.727

> LSP 是否也适用于接口，这意味着我们应该能够使用实现特定接口的类并仍然获得预期的行为？

LSP 适用于合同。契约可以是一个类或一个接口。

> 如果情况确实如此，那么为什么对接口进行编程被认为是一件好事（顺便说一句-我知道对接口进行编程会增加松散耦合），如果反对使用继承的主要原因之一是由于不遵守的风险语言服务提供商？也许是因为：

这与接口或类无关。这是关于违反合同的。假设您在( 或)中有一个`Break()`方法。任何打电话给它的人都会认为这辆车会坏掉。想象一下，如果其中一个实现没有中断，会有什么惊喜。这就是 LSP 的全部意义所在。`IVehicle``VehicleBase`

> a) 松耦合的好处超过了不遵守 LSP 的风险

嗯？

> b) 与继承相比，类（实现接口）不遵守 LSP 的机会要小得多

嗯？

您可能想阅读我的 SOLID 文章以更好地理解原理：http: [//blog.gauffin.org/2012/05/solid-principles-with-real-world-examples/](http://blog.gauffin.org/2012/05/solid-principles-with-real-world-examples/)

**更新**

> 详细说明 - 继承虚拟方法可能会消耗私有成员，覆盖这些虚拟方法的子类无权访问。

是的。那挺好的。成员（字段）应始终受到保护（= 声明为私有）。只有定义它们的类才真正知道它们的值应该是什么。

> 此外，派生类从父类继承上下文，因此可能会被未来对父类的更改等破坏。

这违反了开放/封闭原则。即通过改变行为来改变类契约。类应该扩展而不是修改。当然，这不可能一直存在，但更改不应使类的行为有所不同（除了错误修复）。

> 因此，我觉得让子类遵守合同比让实现接口的类遵守合同更难

为什么通过继承进行扩展很难有一个共同的原因。那是因为这种关系不是真正的`is-a`关系，而是开发人员只想利用基类功能。

那是错误的。那么最好使用组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-25T20:47:46.747

我目前正在将我的代码实践与 LSP 进行比较/对比。我认为这必须与期望和决定如何定义应该期望的内容有关。我不相信替换总是意味着同样的事情。例如，如果我定义

```
interface ICalculation 
{ 
    double Calculate(double A, double B); 
} 
```

为了定义`class Add : ICalculation`、和`class Subtract : ICalculation`，我相信这些类应该执行各自的，但是，我不认为它们都应该通过相同的单元测试。我喜欢使用接口来实现可扩展性，每个扩展都有不同的功能。在汽车制动的情况下，我会给类提供接口 IBrakable 并执行以下操作： `class Multiply : ICalculation``class Divide : ICalculation``Calculation(A, B)`

```
var myBrakableCar = MyCar as IBrakable;
if(myBrakableCar != null) 
{
    myBrakableCar.Brake();
} 
```

我相信类的使用应该是可预测的，但也是有用的。有用是最重要的。

我只是要创建一个新概念 - “Respective Substition”：它会按照它在锡上所说的那样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-27T07:37:51.360

广告 1)：是的。但是，很难让接口强制执行合同，而且他们确实应该这样做。

广告 2)：针对接口进行编程是一种权衡。正如您所指出的，接口鼓励所有具有非平凡合同的接口违反 LSP。

我相信这些是您问题的答案，或者至少我认识到这些是挑战鼓励使用界面的未回答的问题。

我一直使用接口（在 C# 中），因为我喜欢做 TDD。然后我只希望我的模拟和相应的实现不会违反 LSP，因为当他们这样做时，我的测试套件不再健全（它声称可以工作，但事实并非如此）。

有时，我会创建一个抽象基类而不是接口。抽象基类只是强制执行契约，并委托给虚拟保护方法，这些方法应该定义实际实现或在单元测试期间被模拟。事实证明，这在某些应用程序中很有用，在这些应用程序中会发现单元测试本身的错误。

但是后来我们遇到了在 C# 中缺少对多重继承的支持，无论如何我们都被接口卡住了（或者只是更多的类，如果你选择这种方法，你可以隐藏在 SRP 后面）

# scala - HList/KList 是否适合作为方法参数？如何参考？类型列表？

> ID：12252366
> 
> 赞同：3
> 
> 时间：2012-09-03T18:07:01.547
> 
> 标签：scala, typelist, hlist, shapeless, klist

我发现了 HList / KList，它们非常酷。我有一个实际用例，其中具有保守类型信息的异构类型和可变长度容器将非常有用（有关更多信息，请参阅下面的背景）。但是，我还没有理解 H/KList 作为方法参数的用法，我被迫对参数进行完全类型注释或松散类型信息。如果完整类型当然是未知的，H/KLists 甚至可以用作参数吗？如何在不丢失类型信息的情况下引用 H/KList？

“类型列表”可以用来指代异构和可变长度类型参数的元组吗？[这里](http://jnordenberg.blogspot.de/2009/09/type-lists-and-heterogeneously-typed.html)它说： `... the types of the elements can be tracked separate from the actual element values. To do this we create an purely abstract type (it has no instances) which models a list of types, let's call it TList.` 我玩过它，但还不明白如何将它用于 HList 的类型注释作为参数。

基本上，我想要这样的东西：

```
implicit def hlistToTypedLink[TL](a: HList[TL]):TypedLink[TL] = new TypedLink[TL](a.map(a:X => new TypedHandle[X])) 
```

其中 TL 指的是类型列表，X 指的是当前元素的类型。所以这里应该将一个 HList 映射到另一个类似 Tuple 的容器 TypedLink，由类型列表 TL 参数化。每个元素都将被包装在另一个参数化容器 TypedHandle 中，使用当前类型 X 进行类型化。

这可能吗？

我看到了 Shapeless 的 HList 及其“统一”方法，但问题仍然存在：除了可变长度之外，我不知道如何在参数列表中引用它。

我的第二个希望是使用 KList。它适用于我的情况，因为 TypedHandle 是具有相同构造函数的通用容器。根据 apocalisp 的说法，使用 KList 似乎更容易键入[注释](http://apocalisp.wordpress.com/2010/11/03/type-level-programming-in-scala-part-8b-klist%C2%A0basics/)：

```
 val m = List(1, 2, 3, 4) :^: List("str1", "str2") :^: KNil 
```

将是类型：

```
 KCons[Int,java.lang.String :: HNil,List] 
```

但是，问题仍然存在：在方法定义中，我不知道它是否会是

```
KCons[String, Int :: HNil, TH] 
```

或一个

```
KCons[Foo, Bar, Baz :: HNil, TH] 
```

所以我也不知道如何键入注释 KList 作为方法参数。

感谢您的任何提示！

**背景**：我正在为优秀的 OO- 和图形数据库 hypergraphdb 编写 scala 便利扩展。Hypergraphdb 的超边 HGLink 基本上是 HGHandle 的元组。HGHandle 指的是本身有类型的原子。因此 HGLink 本身将是异构类型和可变长度的。但是，到目前为止，HGLink 的实现是无类型的，并且是由 HGHandle 的无类型实现构建的。我猜 java 的类型系统的表现力不足以反映 hypergraphdb 的（非常优秀的）类型系统（例如，它也有更高种类的类型）。

基本上，我正在尝试将 scala 与 hypergraphdb 的类型系统连接起来，我学到了很多东西，直到现在这真的很有趣。除了许多其他黑客之外，TypedHandle 已经很好用了。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T19:46:27.857

我并不完全清楚你要什么，但你`hlistToTypedLink`看起来可以使用无形`HList`和多态函数值来处理它，

```
scala> import shapeless._ ; import TypeOperators._
import shapeless._
import TypeOperators._

scala> class TypedHandle[T]
defined class TypedHandle

scala> class TypedLink[L <: HList](l : L)
defined class TypedLink

scala> object MkTypedHandle extends (Id ~> TypedHandle) {
     |   def apply[T](t : T) = new TypedHandle[T]
     | }
defined module MkTypedHandle

scala> def hlistToTypedLink[L <: HList, M <: HList](a: L)
     |   (implicit mapper: MapperAux[MkTypedHandle.type, L, M]) =
     |     new TypedLink[M](a map MkTypedHandle)
hlistToTypedLink: [L <: HList, M <: HList](a: L)
  (implicit mapper: MapperAux[MkTypedHandle.type,L,M])TypedLink[M]

scala> hlistToTypedLink(23 :: "foo" :: true :: HNil)
res0: TypedLink[TypedHandle[Int] :: TypedHandle[String] ::
  TypedHandle[Boolean] :: HNil] = TypedLink@51fb5716 
```

从本质上讲，您似乎想要映射您的参数`HList` `a`，将每个元素包装在 a 中`TypedHandle`，然后将结果包装`HList`在 a 中`TypedLink`。在所有情况下，包装器都将根据其内容的类型精确地参数化。

如上所示，这可以使用 shapeless 的`HList` `map`. 这里有两个关键成分。首先，定义多态类函数值`MkTypedHandle`，它可以映射到`HList` `a`创建一个`HList`-wrapped`TypedLink`元素。`mapper`其次，驱动地图操作的隐式见证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T10:56:05.323

当您参考我的博客文章时，我会更好地回应。TList 只是一个没有值存储的 HList，即只有列表的类型表示，没有运行时表示。一个优点是它促进了不同的、可能更有效的值存储类型，例如数组（Metascala 中的 HArray）。TLists 也可以用于对联合类型（基本上是类型集）进行建模，但是 Scala 的类型系统不足以仅在类型级别上做到这一点（我认为是 Haskell 的类型系统）。

# android - 仍然无法在 Android 中将按钮添加到布局中

> ID：12252374
> 
> 赞同：1
> 
> 时间：2012-09-03T18:07:43.970
> 
> 标签：android, android-layout

我刚开始使用 android，并在此处发布之前尝试了以下问题以获得此答案：

[Android - 在运行时将布局添加到主布局](https://stackoverflow.com/questions/7240939/android-adding-layout-at-runtime-to-main-layout)

[以编程方式将按钮添加到布局](https://stackoverflow.com/questions/4907609/add-button-to-a-layout-programmatically)

[通过获取每个孩子的位置动态地将孩子添加到 LinearLayout](https://stackoverflow.com/questions/6661745/dynamically-adding-a-child-to-linearlayout-with-getting-each-childs-position)

而且我仍然无法向线性布局添加按钮:(

以下是活动代码，请让我知道我错在哪里：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        LinearLayout layout = (LinearLayout) View.inflate(this, R.layout.activity_main, null);

        Button btn = new Button(this);
        btn.setId(123);
        btn.setText("Welcome to WI FI World");
        layout.addView(btn);
    } 
```

xml 如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:15:24.590

尝试为您的布局分配一个 id，然后将按钮添加到布局中。

我很确定这两种布局是不一样的，所以你实际上是在向一个从未显示的布局中添加一个按钮。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    LinearLayout layout = (LinearLayout) findViewById(R.id.lnr_main);

    Button btn = new Button(this);
    btn.setId(123);
    btn.setText("Welcome to WI FI World");
    layout.addView(btn);
} 
```

为 Layout 分配了一个 id

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools"
  android:id="@+id/lnr_main"
  android:layout_width="match_parent"
  android:layout_height="match_parent" >

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:13:23.397

给你的linearLayout一个id。

然后在你的代码中

```
LinearLayout layout = (LinearLayout)findViewById(R.id.given_id); 
```

保持其余相同，应该工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:13:47.830

在 XML 中获取 LinearLayout 的 ID，在 java 代码中使用 XML 中 LinearLayout 的 ID

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/linear" >

</LinearLayout> 
```

在 onCreate() 中：

```
LinearLayout linear=(LinearLayout)findViewById(R.id.linear);

 //Select widgets
 linear.addView() 
```

# javascript - 使用 jquery 和 .submit 捕获表单提交

> ID：12252378
> 
> 赞同：62
> 
> 时间：2012-09-03T18:08:08.620
> 
> 标签：javascript, html, jquery

我正在尝试使用 jQuery 来捕获提交事件，然后将格式为 JSON 的表单元素发送到 PHP 页面。不过，我在捕获提交时遇到问题，我从一个`.click()`事件开始，但`.submit()`改为移动到那个事件。

我现在有以下精简代码。

HTML

```
<form method="POST" id="login_form">
    <label>Username:</label>
    <input type="text" name="username" id="username"/>
    <label>Password:</label>
    <input type="password" name="password" id="password"/>
    <input type="submit" value="Submit" name="submit" class="submit" id="submit" />
</form> 
```

Javascript

```
$('#login_form').submit(function() {
    var data = $("#login_form :input").serializeArray();
    alert('Handler for .submit() called.');
}); 
```

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2012-09-03T18:27:26.660

将代码包装在准备好的文档中并防止默认提交操作：

```
$(function() { //shorthand document.ready function
    $('#login_form').on('submit', function(e) { //use on if jQuery 1.7+
        e.preventDefault();  //prevent form from submitting
        var data = $("#login_form :input").serializeArray();
        console.log(data); //use the console for debugging, F12 in Chrome, not alerts
    });
}); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-03T18:15:16.403

试试这个：

使用“return false”来切断事件的流程：

```
$('#login_form').submit(function() {
    var data = $("#login_form :input").serializeArray();
    alert('Handler for .submit() called.');
    return false;  // <- cancel event
}); 
```

**编辑**

如果表单元素具有 jQuery 的“长度”，则证实：

```
alert($('#login_form').length) // if is == 0, not found form
$('#login_form').submit(function() {
    var data = $("#login_form :input").serializeArray();
    alert('Handler for .submit() called.');
    return false;  // <- cancel event
}); 
```

或者：

它等待 DOM 准备好：

```
jQuery(function() {

    alert($('#login_form').length) // if is == 0, not found form
    $('#login_form').submit(function() {
        var data = $("#login_form :input").serializeArray();
        alert('Handler for .submit() called.');
        return false;  // <- cancel event
    });

}); 
```

你是把你的代码放在文档“准备好”的事件中还是在 DOM 准备好之后？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-24T14:34:00.363

只需将 form.submit 函数替换为您自己的实现即可：

```
var form = document.getElementById('form');
var formSubmit = form.submit; //save reference to original submit function

form.onsubmit = function(e)
{
    formHandler();
    return false;
};

var formHandler = form.submit = function()
{
    alert('hi there');
    formSubmit(); //optionally submit the form
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-04T17:58:50.490

小提示：记得把代码检测放在 document.ready 上，否则可能不起作用。那是我的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-23T15:43:21.753

```
$(document).ready(function () {
  var form = $('#login_form')[0];
  form.onsubmit = function(e){
  var data = $("#login_form :input").serializeArray();
  console.log(data);
  $.ajax({
  url: "the url to post",
  data: data,
  processData: false,
  contentType: false,
  type: 'POST',
  success: function(data){
    alert(data);
  },
  error: function(xhrRequest, status, error) {
    alert(JSON.stringify(xhrRequest));
  }
});
    return false;
  }
});
```

```
<!DOCTYPE html>
<html>
<head>
<title>Capturing sumit action</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
<form method="POST" id="login_form">
    <label>Username:</label>
    <input type="text" name="username" id="username"/>
    <label>Password:</label>
    <input type="password" name="password" id="password"/>
    <input type="submit" value="Submit" name="submit" class="submit" id="submit" />
</form>

</body>

</html>
```

# php - DOM - Uncaught Error: NOT_FOUND_ERR: DOM Exception 8 with RemoveChild

> ID：12252382
> 
> 赞同：2
> 
> 时间：2012-09-03T18:08:21.200
> 
> 标签：php, javascript, html, removechild

I need to remove a child added with PHP. When I try to use removeChild, Chrome throws this:

```
Uncaught Error: NOT_FOUND_ERR: DOM Exception 8 
```

Here is the code I am using to delete the element:

```
<!-- language: lang-js -->
document.getElementsByTagName('table')[0].removeChild(document.getElementById("e"+eid)); 
```

And here is the code that defines the element:

```
<!-- language: lang-html -->
<tr id='e0'>
   <td>
      gs
   </td>
   <td>
     <a href='#' onclick='showpm(0); return false;'>
       Open
     </a>
   </td>
   <td>
     <a href='#' onclick='delpm(7, 0); return false;'>
       Delete
     </a>
   </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:13:00.037

Chrome 会`tbody`在您的表格中添加一个标签，因此您必须删除该元素的子元素，或者

```
var tr = document.getElementById("e"+eid);
tr.parentNode.removeChild(tr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:11:23.853

我认为您应该更好地使用表的 deleteRow() 方法，请参阅[此处的示例](http://www.w3schools.com/jsref/met_table_deleterow.asp)

# java - Different results between nslookup and Java's InetAddress getHostName

> ID：12252387
> 
> 赞同：3
> 
> 时间：2012-09-03T18:08:45.663
> 
> 标签：java, dns, inetaddress, nslookup

I'm trying to write a simple java program that will return the dns names of ip addresses which I do using the following code:

```
InetAddress host = InetAddress.getByName(ip);
String dnsName = host.getHostName(); 
```

When a dns name is registered getHostName() returns this name and when there is no existent dns name the ip address is returned.

For many addresses the above code doesn't return any while the nslookup command returns.

For example, for the address 82.117.193.169 nslookup returns **peer-AS31042.sbb.rs** while getHostName() returns only the address. This doesn't happen for all the addresses but for a large number of cases.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:14:34.263

默认情况下，您的计算机可能未配置为使用 DNS，即使它是按需可用的。

我会尝试

```
ping 82.117.193.169 
```

并查看它是否将 IP 地址解析为主机名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-04T03:57:35.487

It is due to the "A" record check - Java wants that IP number you're looking up, was listed there. They call it "XXX" and I understand why:

```
private static String getHostFromNameService(InetAddress addr, boolean check) {
String host = null;
for (NameService nameService : nameServices) {
    try {
        // first lookup the hostname
        host = nameService.getHostByAddr(addr.getAddress());

        /* check to see if calling code is allowed to know
         * the hostname for this IP address, ie, connect to the host
         */
        if (check) {
            SecurityManager sec = System.getSecurityManager();
            if (sec != null) {
                sec.checkConnect(host, -1);
            }
        }

        /* now get all the IP addresses for this hostname,
         * and make sure one of them matches the original IP
         * address. We do this to try and prevent spoofing.
         */

        InetAddress[] arr = InetAddress.getAllByName0(host, check);
        boolean ok = false;

        if(arr != null) {
            for(int i = 0; !ok && i < arr.length; i++) {
                ok = addr.equals(arr[i]);
            }
        }

        //XXX: if it looks a spoof just return the address?
        if (!ok) {
            host = addr.getHostAddress();
            return host;
        }

        break; 
```

# sql - Cannot implicitly convert type System.Data.Entity.DbSet to System.Data.Objects.ObjectQuery

> ID：12252391
> 
> 赞同：7
> 
> 时间：2012-09-03T18:08:56.710
> 
> 标签：sql, database, visual-studio-2012

I am using Visual Studio 2012 C Sharp (C#) and SQL Server Express. I am trying to go through the MSDN Walkthrough: Display Data from a SQL Server Database in a DataGrid Control. I have added the recommended AdventureWorksLT2008 sample database. Here are the instructions I followed:

1.  Create a new WPF Application project in Visual Basic or C#, and name it DataGridSQLExample.
2.  In Solution Explorer, right-click your project, point to Add, and then select New Item. ( The Add New Item dialog box appears. )
3.  In the Installed Templates pane, select Data and in the list of templates, select ADO.NET Entity Data Model.
4.  Name the file `AdventureWorksModel.edmx` and then click Add. (The Entity Data Model Wizard appears.)
5.  In the Choose Model Contents screen, select Generate from database and then click Next.
6.  In the Choose Your Data Connection screen, provide the connection to your AdventureWorksLT2008 database.
7.  Make sure that the name is AdventureWorksLT2008Entities and that the Save entity connection settings in `App.Config` as check box is selected, and then click Next.
8.  In the Choose Your Database Objects screen, expand the Tables node, and select the Product and ProductCategory tables.
9.  Click Finish.

To retrieve and present the data:

1.  Open the `MainWindow.xaml` file.
2.  Set the Width property on the Window to 450.
3.  In the XAML editor, add the following DataGrid tag between the `<Grid>` and `</Grid>` tags to add a DataGrid named `dataGrid1`.
4.  Select the Window.
5.  Using the Properties window or XAML editor, create an event handler for the Window named `Window_Loaded` for the Loaded event.
6.  Open the code-behind file (`MainWindow.xaml.vb` or `MainWindow.xaml.cs`) for the Window.
7.  Add the following code to retrieve only specific values from the joined tables and set the `ItemsSource` property of the DataGrid to the results of the query:

    ```
    using System;
    using System.Collections.Generic;
    using System.Data.Objects;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;
    using System.Windows;
    using System.Windows.Controls;
    using System.Windows.Data;
    using System.Windows.Documents;
    using System.Windows.Input;
    using System.Windows.Media;
    using System.Windows.Media.Imaging;
    using System.Windows.Navigation;
    using System.Windows.Shapes;

    namespace DataGridSQLExample
    {
        /// <summary> 
        /// Interaction logic for MainWindow.xaml 
        /// </summary> 
        public partial class MainWindow : Window
        {
            AdventureWorksLT2008Entities dataEntities = new AdventureWorksLT2008Entities();

            public MainWindow()
            {
                InitializeComponent();
            }

            private void Window_Loaded(object sender, RoutedEventArgs e)
            {
                ObjectQuery<Product> products = dataEntities.Products;

                var query =
                from product in products
                where product.Color == "Red"
                orderby product.ListPrice
                select new { product.Name, product.Color, CategoryName = product.ProductCategory.Name, product.ListPrice };

                dataGrid1.ItemsSource = query.ToList();
            }
        }
    } 
    ```

8.  Run the example. You should see a DataGrid that displays data.

When I run I get this error:

> **Cannot implicitly convert type 'System.Data.Entity.DbSet' to 'System.Data.Objects.ObjectQuery'** on this line: **ObjectQuery products = dataEntities.Products;**

Nothing I have tried works - any suggestions?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T18:12:21.257

可以直接使用，不需要强制转换

```
 var query =
    from product in dataEntities.Products
    where product.Color == "Red"
    orderby product.ListPrice
    select new { product.Name, product.Color, CategoryName = product.ProductCategory.Name, product.ListPrice }; 
```

注意：

ObjectQuery 表示在给定对象的上下文中在概念模型上执行的典型查询。

dataEntities.Products 表示数据集

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-12T01:46:07.853

我意识到这真的很旧，但您也可以执行以下操作：

**改变：**

```
using System.Data.Objects; 
```

**至：**

```
using System.Data.Entity; 
```

**和改变：**

```
ObjectQuery&lt;Product&gt; products = dataEntities.Products; 
```

**至：**

```
DbSet&lt;Product&gt; products = dataEntities.Products; 
```

# android - 为什么这个简单的 JNI 对象构造会导致 VM 中止和 SIGSEGV？

> ID：12252395
> 
> 赞同：0
> 
> 时间：2012-09-03T18:09:23.963
> 
> 标签：android, android-ndk, java-native-interface

班级：

```
package com.example.foo;

public class Dummy
{
    int value;

    public Dummy(int value)
    {
        this.value = value;
    }   
} 
```

JNI 片段：

```
jclass class = (*jni_env)->FindClass(jni_env, "com/example/foo/Dummy");
jmethodID constructor = (*jni_env)->GetMethodID(jni_env, class, "<init>", "(I)V");
jobject object = (*jni_env)->NewObject(jni_env, constructor, 0); 
```

LogCat 输出：

```
09-03 11:02:02.937: W/dalvikvm(2179): Invalid indirect reference 0x44e9cf80 in decodeIndirectRef
09-03 11:02:02.937: E/dalvikvm(2179): VM aborting
09-03 11:02:02.937: A/libc(2179): Fatal signal 11 (SIGSEGV) at 0xdeadd00d (code=1), thread 2179 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:59:39.557

`NewObject()`期望类对象指针作为第二个参数。构造方法ID是第三个参数。像这样重新制定：

```
jobject object = (*jni_env)->NewObject(jni_env, class, constructor, 17); 
```

其中 17 是构造函数的参数。

# api - Web 音频 API 复音 - 使用 2 个不同的增益节点不起作用？

> ID：12252396
> 
> 赞同：4
> 
> 时间：2012-09-03T18:09:31.460
> 
> 标签：api, audio, web, web-audio-api

我似乎无法创建两个具有独立增益包络的振荡器。

下面的代码创建了两个按钮，每个按钮都以不同的音高播放正弦音。当我单击第一个按钮时，我听到音量按应有的增长。但是，当我单击第二个按钮时，音调的反应就好像它连接到第一个音调的增益一样。例如，如果我在第一个音调的音量为 1 时单击第二个按钮（打开第二个音调），则第二个音调将以音量 1 进入，即使它应该在整个过程中从 0 到 1 到 0 包络10 秒。

每个音频上下文只能有一个增益节点吗？或者是否有其他原因可以连接这些振荡器的增益？另外，我弹了一次之后，就不能再弹了，这让我特别觉得自己做错了什么。:)

谢谢。链接在下面，代码在下面。这是我在这里的第一篇文章，所以如果您需要其他任何内容，请告诉我。此代码必须在支持网络音频 api 的 Chrome 或 Safari 版本中运行。

[http://whitechord.org/just_mod/poly_test.html](http://whitechord.org/just_mod/poly_test.html)

> WAAPI 测试

```
 <button onclick="play()">play one</button>
    <button onclick="play2()">play two</button>

    <script>

        var context;

        window.addEventListener('load', initAudio, false);

        function initAudio() {
            try {
                context = new webkitAudioContext();
            } catch(e) {
                onError(e);
            }
        }

        function play() {

            var oscillator = context.createOscillator(); 
            var gainNode = context.createGainNode();
            gainNode.gain.value = 0.0;
            oscillator.connect(gainNode);
            gainNode.connect(context.destination);
            oscillator.frequency.value = 700;

            gainNode.gain.linearRampToValueAtTime(0.0, 0); // envelope  
            gainNode.gain.linearRampToValueAtTime(0.1, 5); // envelope  
            gainNode.gain.linearRampToValueAtTime(0.0, 10); // envelope 

            oscillator.noteOn(0);
        }

        function play2() {

            var oscillator2 = context.createOscillator(); 
            var gainNode2 = context.createGainNode();
            gainNode2.gain.value = 0.0;
            oscillator2.connect(gainNode2);
            gainNode2.connect(context.destination);
            oscillator2.frequency.value = 400;

            gainNode2.gain.linearRampToValueAtTime(0.0, 0); // envelope 
            gainNode2.gain.linearRampToValueAtTime(0.1, 5); // envelope 
            gainNode2.gain.linearRampToValueAtTime(0.0, 10); // envelope    

            oscillator2.noteOn(0);
        }

        /* error */

        function onError(e) {
            alert(e);   
        }

    </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T03:28:58.357

> 每个音频上下文只能有一个增益节点吗？或者是否有其他原因可以连接这些振荡器的增益？另外，我弹了一次之后，就不能再弹了，这让我特别觉得自己做错了什么。:)

您可以拥有任意数量的增益节点（例如，这就是您可以实现类似总线的混合设置的方式），所以这不是问题。您的问题如下：

请记住，[linearRampToValueAtTime()](http://www.w3.org/TR/webaudio/#dfn-linearRampToValueAtTime)的第二个参数是*与您的 context.currentTime 处于同一时间坐标系中的时间*。

而且你的 context.currentTime**总是**实时向前移动，所以你所有的坡道、曲线等都应该**相对于它**进行计算。

如果您想在 4 秒后发生某些事情，您可以将 context.currentTime + 4 传递给 Web Audio API 函数。

因此，更改代码中的所有调用 linearRampToValueAtTime() ，使它们看起来像：

```
gainNode2.gain.linearRampToValueAtTime(0.0, context.currentTime); // envelope     
gainNode2.gain.linearRampToValueAtTime(0.1, context.currentTime + 5); // envelope     
gainNode2.gain.linearRampToValueAtTime(0.0, context.currentTime + 10); // envelope 
```

这应该可以解决您的问题。

顺便说一句，您的 BODY 开头标记标签中有一个杂散的双引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T19:28:28.093

问威尔康克林

```
gainNode2.gain.linearRampToValueAtTime(0.1, context.currentTime + 5); // envelope 
```

# java - is it possible to block calls to System.exit through ConditionalPermissionAdmin?

> ID：12252397
> 
> 赞同：1
> 
> 时间：2012-09-03T18:09:31.933
> 
> 标签：java, osgi, eclipse-virgo

The documentation is not helping at all, OSGi in Action does not have an example head to toes on how to do things. For example, I want bundle A to deny a package import from Bundle B, etc. Simple examples, from start to end - I can't find them.

But back to my question, I want to block calls to `System.exit` for obvious reasons, besides "do not implement your own Security Manager", I did not get much from the Virgo forum, thus my question here.

**EDIT**

Since I want this to happen in Virgo, here is what I have tried:

```
 public void start(BundleContext context) throws Exception {
     System.out.println("===== Starting Bundle PermissionsTest =====");
     SecurityManager securityManager = System.getSecurityManager();
     if(securityManager == null) throw new IllegalArgumentException("Security Manager is not defined!");

     ServiceReference serviceReference = 
            (ServiceReference) context.getServiceReference(ConditionalPermissionAdmin.class.getName());
     if(serviceReference == null) throw new IllegalArgumentException(ConditionalPermissionAdmin.class.getName() + " IS NULL");
    else System.out.println("===== Good so far 1 =====");

     ConditionalPermissionAdmin conditionalPermissionAdmin = 
            (ConditionalPermissionAdmin)context.getService(serviceReference);
     if(conditionalPermissionAdmin == null) throw new IllegalArgumentException("ConditionalPermissionAdmin can not be found");
    else System.out.println("===== Good so far 2 ====="); 
```

What I did first in Virgo ie enable the Equinox Security Manager (because this is the one Virgo uses). The specification of the OSGi says that each container has to implement it's own Security Manager extended with a bunch of OSGi specific actions.

In case of Virgo this is Equinox Security Manager. Enabling it is pretty easy - just add two lines in bin/dmk.sh and thus you have it.

Ok, so I do have the ConditionalPermissionAdmin - good! Now, I can for example, add a Security Check, like, BundlePermission say for a Bundle. Sure, but that happens for *bundle specific actions*, like start/stop/export, etc etc. I can't seem to figure out how to do it for a LifeCycle action - System.exit in my case.

btw, I use version 4.2.0 of the osgi-core, and nope I can't upgrade to 4.3.0, at least not now.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T06:57:27.877

System.exit 由 RuntimePermission("exitVm", "<>") 管理，因此规范中的示例语法给出

```
DENY {
   ( java.lang.RuntimePermission "exitVm" "*" )
} 
```

在Java代码中（还没有测试过，所以要小心）：

```
ConditionalPermissionInfo info = admin.newConditionalPermissionInfo(
    "name", 
    null, 
    new PermissionInfo[] { new PermissionInfo(
       "java.lang.RuntimePermission", "exitVm", "*") },
    ConditionalPermissionInfo.DENY
);

ConditionalPermissionUpdate update = admin
   .newConditionalPermissionUpdate();
update.getConditionalPermissionInfos().add(0, info);
update.commit(); 
```

[该主题在“OSGi in Action”](http://www.amazon.fr/OSGi-Action-Creating-Modular-Applications/dp/1933988916)一书中得到了很好的处理。请记住，规范的主要受众是规范的实施者，而不是最终用户。成员应该提供教育材料来弥合这一差距。后来的规范试图对最终用户更具教育意义。

# python - udp rate limits in python?

> ID：12252400
> 
> 赞同：8
> 
> 时间：2012-09-03T18:09:44.517
> 
> 标签：python, udp

Update to original post: A colleague pointed out what I was doing wrong. I'll give the explanation at the bottom of the post, as it might be helpful for others.

* * *

I am trying to get a basic understanding of the limits on network performance of python programs and have run into an anomaly. The code fragment

```
while 1:
    sock.sendto("a",target) 
```

sends UDP packets to a target machine, as fast as the host will send. I measure a sending rate of just over 4000 packets per second, or 250 us per packet. This seems slow, even for an interpreted language like python (the program is running on a 2 GHz AMD opteron, Linux, python version 2.6.6). I've seen much better performance in python for TCP, so I find this a bit weird.

If I run this in the background and run top, I find that python is using just 25% of the cpu, suggesting that python may be artificially delaying the transmission of UDP packets.

Has anyone else experienced anything similar? Does anyone know if python does limit the rate of packet transmission, and if there is a way to turn this off?

BTW, a similar C++ program can send well over 200,000 packets per second, so it's not an intrinsic limit of the platform or OS.

* * *

So, it turns out I made a silly newbie mistake. I neglected to call gethostbyname explicitly. Consequently, the target address in the sendto command contained a symbolic name. This was triggering a name resolution every time a packet was sent. After fixing this, I measure a maximum sending rate of about 120,000 p/s. Much better.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:29:36.417

您可能希望发布更完整的代码示例，以便其他人可以重复您的基准测试。*每次*循环迭代 250μs太慢了。根据优化 Python 的日常经验，我预计 Python 的解释器开销在现代机器上远低于 1μs。换句话说，如果 C++ 程序每秒发送 200k 个数据包，我希望 Python 的速度也能达到相同的数量级。

（鉴于上述情况，通常的优化建议，例如将 sock.sendto 的属性查找移出循环，在这里不适用，因为速度慢来自另一个来源。）

一个很好的第一步是`strace`用来检查 Python 实际在做什么。是单线程程序还是多线程应用程序可能会浪费时间等待 GIL？是`sock`普通的 Python 套接字还是更复杂的 API 的一部分？当您直接调用`os.write`套接字时也会发生同样的情况`fileno`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:19:48.113

您是否尝试过先做`connect()`，然后使用`send()`代替`sendto()`？（UDP`connect()`只是建立目标地址，它实际上并没有建立“连接”。）我对此很生疏，但我相信 Python 对地址参数的解释比 C 套接字更多，这可能会增加开销。

# visual-studio - 在 Visual Studio 中分析故障转储

> ID：12252407
> 
> 赞同：15
> 
> 时间：2012-09-03T18:10:17.957
> 
> 标签：visual-studio, crash, crash-dumps

我有一个`*.dmp`崩溃的应用程序的（转储）文件。现在，我想分析另一台机器上的崩溃进程。也就是说，应用程序在一台机器上崩溃了，而我在另一台机器上安装了 Visual Studio。

现在，我需要什么才能看到堆栈跟踪和我的应用程序的所有符号？`*.exe`文件和文件是否`*.dmp`足够？

还是我还需要源代码和 PDB 文件？

如果是这样，源代码和可执行文件是否应该放在与进程运行的机器上相同的目录结构中？

如何在 Visual Studio 中将 PDB 文件附加到故障转储文件？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-03T19:27:26.960

不，您肯定需要 .pdb 文件来获得体面的堆栈跟踪。到目前为止，最简单的方法是在您构建程序的机器上执行此操作，源代码和 .pdb 文件将位于正确的位置。

下一个最好的方法是将完全相同的可执行文件复制到故障机器上安装它的完全相同的文件夹中。将 .pdb 文件复制到同一个目录中，如果在原始构建位置找不到它们，调试器将在该目录中查找它们。一旦调试器到达带有源代码的语句并且 .pdb 没有被剥离，那么它将提示您提供源代码文件的位置。

下一个最好的事情是工具 + 选项、调试、符号并将路径添加到包含 .pdb 文件的目录。

在同一个对话框中，还打开 Microsoft 符号服务器 (http://msdl.microsoft.com/download/symbols)。这将为您获取 Windows DLL 的符号，并让您在 Windows DLL 中发生崩溃时准确地追溯到您自己的代码。

# android - 使用加速度计平滑图像移动

> ID：12252412
> 
> 赞同：0
> 
> 时间：2012-09-03T18:10:53.090
> 
> 标签：android, accelerometer

我正在努力使我的图像移动更顺畅。我知道这个问题已经被问过很多次了，但是有一件事我更感兴趣，并且在其他问题中没有出现。我直接使用传感器加速度值来移动位图。我知道这种方法将我限制在左右之间`-9.8`，`+9.8`但这正是我想要的，我希望我的位图只移动一样多。我读到了低通滤波器，但据我所知，它对于在屏幕上移动位图很有用，在我的情况下它是完全没有必要的。那我说得对吗？如果我直接使用加速度计值移动位图，我不应该获得平滑的移动吗？

这是从我的加速度计获取值的代码。它的类型是`TYPE_ACCELEROMETER`

```
public void onSensorChanged(SensorEvent event) {

        xAcceleration = event.values[0];
        yAcceleration = event.values[1];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:27:20.413

你说的是高通滤波器吗？你真的尝试过低通滤波器吗？

无论如何，加速度计在低于某个阈值时肯定是有噪声的。所以是的，在查看原始数据时，您应该期望看到“粗略”而不是“平滑”的数字。高通滤波器*应该*会有所帮助。我还看到了在可调节样本范围内计算平均值的不错结果。

另一件要尝试的事情：不要在每次获得新的加速度计数据时更新位图的位置。也就是说，将更新位图位置的方法与 onSensorChange 分离。您应该能够比来自 onSensorChange 的传感器数据更频繁地更新位图的位置......这应该更容易计算平滑的位置变化。

这里也有很多好的建议： [Filtering accelerometer data noise](https://stackoverflow.com/questions/1638864/filtering-accelerometer-data-noise)

# mysql - 将 Exchange 2010 邮箱 powershell 脚本转换为 mysql

> ID：12252413
> 
> 赞同：0
> 
> 时间：2012-09-03T18:10:59.360
> 
> 标签：mysql, powershell-2.0, exchange-server-2010

需要创建一个 Powershell v2 脚本来列出来自 Exchange 2010 服务器的邮箱详细信息（邮箱名称、电子邮件地址、邮箱大小）并将它们导入 MySQL 数据库表。

我可以将 Exchange 信息导入 Powershell，但是如何将每条信息插入 MySQL 中的不同列？

如：邮箱名称、邮箱地址、邮箱大小等。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T05:07:09.110

这是一个脚本，您可以编辑以将电子邮件地址和任何其他交换导出的 powershell 内容添加到 mysql

```
[void][System.Reflection.Assembly]::LoadWithPartialName("MySql.Data")
$servers = Get-MailboxServer
foreach($server in $servers)
{   $mailboxes = Get-Mailbox -server $server -ResultSize unlimited
foreach ($m in $mailboxes)
{   $stats = Get-MailboxStatistics $m | Select ItemCount,DeletedItemCount,TotalItemSize,TotalDeletedItemSize
$date = Get-Date -Format "dd MMM yyyy h:mmtt"
$alias = $m.Alias
$items = $stats.ItemCount
$deletedItems = $stats.DeletedItemCount
$size = $stats.TotalItemSize.Value.ToMB()
$deletedSize = $stats.TotalDeletedItemSize.Value.ToMB()

$dbconnect = New-Object MySql.Data.MySqlClient.MySqlConnection
$dbconnect.ConnectionString = "server=<SERVER>;port=3306;uid=<USERNAME>;pwd=<PASSWORD>;database=<DATABASE>;"
$dbconnect.Open()
$sql = New-Object MySql.Data.MySqlClient.MySqlCommand
$sql.Connection = $dbconnect
$sql.CommandText = "INSERT INTO <TABLE> (Timestamp,Alias,ItemCount,TotalItemSize,DeletedItemCount,TotalDeletedItemSize) values ('" + $date + "','" + $alias + "','" + $items + "','" + $size + "','" + $deletedItems + "','" + $deletedSize + "')"
$sql.ExecuteNonQuery()
$dbconnect.Close()
}
} 
```

# jquery - .prependTo() 是否遵循 jQuery 链接？

> ID：12252420
> 
> 赞同：2
> 
> 时间：2012-09-03T18:12:02.700
> 
> 标签：jquery, dom, jquery-chaining, domexception, jquery-append

我正在进行一个项目，在某种程度上，有一个检查按钮，当检查它时将其重新定位到底部。这是它的标记：

```
<div id="tasksWrapper">
    <div class="subTaskWrapper">
        <div class="subTask">
            <div class="subMarker"></div>
            <label class="subTaskLabel"></label>
            <div class="subHolder"></div>
            <div class="subOptions">
                <ul>
                    <li id="subInfo">Details</li>
                    <li id="subEdit">Edit</li>
                    <li id="subDelete">Delete</li>
                </ul>
            </div>
            <div class="checkButton"></div>
            <div class="optTrigger"></div>
        </div>
        // more than one of that subTask divs ...
    </div>
</div> 
```

这是它的代码：

```
$("#tasksWrapper").on("click", ".subTask .checkButton", function(){
    if($(this).parent().data("checked") == true){
        $(this).css("opacity", "0.2")
            .siblings(".optTrigger , .subHolder").show()
            .parent().data("checked",false);
    } else {
        $(this).css("opacity", "1.0")
            .siblings(".optTrigger , .subHolder").hide()
            .parent().data("checked",true).appendTo($(this).parent().parent());
    }

}); 
```

我希望将`.subTask`div 附加到`.subTaskWrapper`div，所以在这种`else`情况下我首先尝试了这个：

```
else {
        $(this).css("opacity", "1.0")
            .siblings(".optTrigger , .subHolder").hide()
            .parent().data("checked",true).appendTo($(this).parent());
    } 
```

我认为`.appendTo`在这种情况下会将 div 附加`.subTask`到`.subTaskWrapper`div，但我收到了这个错误：

> 未捕获的错误：HIERARCHY_REQUEST_ERR：DOM 异常 3

但是当我向 中添加另一个`.parent()`时`.appendTo($(this).parent())`，它起作用了，所以它变成了

`.appendTo($(this).parent().parent())`

我想知道为什么在第一种情况下会生成此异常，以及`.appendTo`当它位于之后如何受到影响，它是`.parent()`附加`.parent()`的还是只是原始的`$(this)`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:19:03.617

看起来您正在向自身附加一个元素；这将解释 DOM 层次结构错误。如果把链条的核心部分去掉，效果是：

```
$(this).parent().appendTo($(this).parent()); 
```

换句话说：

```
$(this).css("opacity", "1.0")                 // $(this) refers to checkButton
    .siblings(".optTrigger , .subHolder")     // context is still checkButton
    .hide()
    .parent()                                 // context is now subTask
    .data("checked",true)                     // still subTask
    .appendTo($(this).parent());              // $(this).parent() is subTask
                               // so, this line says to append subTask to itself 
```

# c - While循环导致程序挂起

> ID：12252421
> 
> 赞同：0
> 
> 时间：2012-09-03T18:12:05.010
> 
> 标签：c, infinite-loop, do-while

我正在做一个班级作业（未评分），但不清楚为什么这段代码会导致我的程序“挂起”而不是通过循环运行。

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    int nbStars = 0;        // User defines the number of stars to display
    int nbLines = 0;        // User defines the number of lines on which to print

    // Obtain the number of Stars to display
    printf("Enter the number of Stars to display (1-3): ");
    scanf("%d", &nbStars);
    getchar();

    //   Limit the values entered to between 1 and 3
    do {
        printf("Enter the number of Stars to display (1-3): ");
        scanf("%d", &nbStars);

        if (nbStars < 1 || nbStars > 3) puts("\tENTRY ERROR:  Please limit responses to between 1 and 3.\n");
    } while (nbStars < 1 || nbStars > 3);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:19:27.463

输出通常是行缓冲的，如果您不打印新行 ( `"\n"`)，您将看不到任何输出。您的程序没有挂起，它只是在等待输入。

注意：如果您使用`do`while 循环，为什么在循环之前要求输入？即使输入良好，您的程序也会进入循环。即使没有`do`as`nbStars`初始化为`0`.

```
while (nbStars < 1 || nbStars > 3) {
    printf("Enter the number of Stars to display (1-3): \n");
    scanf("%d", &nbStars);

    if (nbStars < 1 || nbStars > 3) puts("\tENTRY ERROR:  Please limit responses to between 1 and 3.\n");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T17:34:50.427

一定有其他事情发生，因为您的代码可以在带有 GCC 的 Linux 和带有 GCC 的 Windows 7 cygwin 上运行。您能否提供有关您正在使用的输入和您的环境的更多详细信息？

试试这个代码，看看你是否得到不同的行为：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    int nbStars = 0;        // User defines the number of stars to display
    int nbLines = 0;        // User defines the number of lines on which to print

    // Obtain the number of Stars to display
    do
    {
        printf("Enter the number of Stars to display (1-3): ");
        scanf("%d", &nbStars);

        if (nbStars < 1 || nbStars > 3)
        {
            puts("\tENTRY ERROR:  Please limit responses to between 1 and 3.\n");
        }
    }while (nbStars < 1 || nbStars > 3);

    printf("You entered %d\n", nbStars);
    return( 0 );
} 
```

# java - 如何使渐变背景颜色更平滑

> ID：12252426
> 
> 赞同：1
> 
> 时间：2012-09-03T18:12:31.710
> 
> 标签：java, swing, background, gradient, java-2d

对渐变背景颜色使用 GradientPaint 并不总是令人满意，尤其是在某些尺寸下。例如这段代码：

```
public class TestPanel extends JPanel {

    protected void paintComponent( Graphics g ) {
        Graphics2D g2d = (Graphics2D) g;
        int w = getWidth();
        int h = getHeight();
        Color color1 = Color.BLACK;
        Color color2 = Color.GRAY;
        GradientPaint gp = new GradientPaint(0, 0, color1, 0, h, color2);
        g2d.setPaint(gp);
        g2d.fillRect(0, 0, w, h);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame frame = new JFrame();
                TestPanel panel = new TestPanel();
                frame.add(panel);
                frame.setSize(200,200);
                frame.setLocationRelativeTo(null);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
            }
        });
    }
} 
```

产生以下内容：

![非循环](../Images/6ff5e918fc3aded14932a8165773abf6.png)

循环版本看起来更糟：

![循环的](../Images/8647a05a2103fee35f6152af487f5fe7.png)

如何使渐变看起来更平滑（在这两种情况下）？

编辑：

似乎（至少部分）是监视器问题。渐变色在我的上网本（1024 x 600，真彩色 32 位）上看起来很糟糕，而在我的台式电脑（1280 x 1024，真彩色 32 位）上看起来要好得多。但是即使使用台式机的显示器，结果仍然不是那么顺利。

两者都使用 Java 版本 6 Update 33。

这是否意味着应用程序只能在以更高分辨率查看时使用渐变背景？

编辑2：

无论如何，对于那些面临类似问题或对此感兴趣的人，我认为让渐变颜色看起来更平滑的唯一解决方案就是更高的分辨率（当然假设显示器已经设置为真彩色） - 这并不是真的一个解法。就像我在评论中所说的那样，我认为 1024 x 600 的分辨率对于简单的黑色到灰色渐变色就足够了，但似乎我错了。当在具有支持更高分辨率的显示器的计算机上运行相同的代码时，渐变看起来更好，例如通过我的桌面显示器 1280 x 1024。不幸的是，我没有更好的分辨率选项，但我相信它看起来会更平滑。我还注意到我上传的两张图片（取自我的上网本）当它们通过更好的显示器查看时，这些相同的图片看起来更平滑......

由于没有解决方案，我认为使用始终看起来平滑的特定渐变步骤的唯一方法（如黑色到灰色，即使在较低分辨率下看起来也很糟糕）是让 gui 程序测试分辨率启动并选择显示适当的渐变，但我不确定它是否值得。使用更少的梯度步骤只是一种妥协。

由于缺乏更多/更好的响应，我接受了使用预抖动图像作为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:02:39.177

我能看到它。我认为这是因为面板的尺寸和颜色数量不匹配。使其更平滑的一种方法是将面板的大小设置为渐变中颜色数量的偶数倍。它并不完美，但我不知道更好的方法。

![在此处输入图像描述](../Images/773e0382663795733e1dc5f983bb569f.png)

```
public class TestPanel extends JPanel {

    private static final int scale = 2;
    private static final Color c1 = Color.BLACK;
    private static final Color c2 = Color.GRAY;
    private static final int size = (c2.getRed() - c1.getRed()) * scale;

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(size, size);
    }

    @Override
    protected void paintComponent( Graphics g ) {
        Graphics2D g2d = (Graphics2D) g;
        int w = getWidth();
        int h = getHeight();
        GradientPaint gp = new GradientPaint(0, 0, c1, 0, h, c2);
        g2d.setPaint(gp);
        g2d.fillRect(0, 0, w, h);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestPanel());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:42:23.703

我看到了您的图像，但无法重现条带。你的显示器设置为真彩色吗？您使用的是最新的 Java 版本吗？无论如何，以下行可能会有所帮助：

```
g2d.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE); 
```

编辑：Java 中似乎不支持 TrueColor 渐变的抖动，即使你没有足够的灰色阴影......一些想法：

*   使用一些颜色
*   使用预抖动的图像文件

[http://en.wikipedia.org/wiki/Colour_banding](http://en.wikipedia.org/wiki/Colour_banding)

# c++ - C++： ios::out 是用新文件替换文件还是破坏文件的内容？

> ID：12252430
> 
> 赞同：0
> 
> 时间：2012-09-03T18:13:01.543
> 
> 标签：c++, fstream, ofstream

假设我 `out.txt`包含文本`Hello World`

如果我这样做

`fstream ("out.txt" , ios::out)`

然后，如果我尝试打开文件，它将为空。

我的问题是当我打开文件流到带有`ios::out`标志的文件时

文件是空的。

但它是否进入文件并删除其所有内容

还是它创建了一个新的空文件并覆盖了旧文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:19:31.043

我认为这取决于操作系统。

有些保留每个文件的版本化世代。在这种情况下，您可能每次都会得到一个新的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T18:14:58.533

它是同一个文件，其内容已被删除。为了附加到您必须使用的文件`ios::app`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T18:16:13.883

它应该截断文件，这意味着保持相同的文件条目，并且只清除内容。

# c# - 我可以在没有 VS 的情况下创建自定义 excel 文档级别功能区吗

> ID：12252431
> 
> 赞同：1
> 
> 时间：2012-09-03T18:13:12.137
> 
> 标签：c#, xml, excel, vba, ribbon

我需要创建一个自定义 Excel 2010 功能区（文档级别）。
我没有 Visual Studio，但有 Visual C# 2010 express
如果可以，请给我一些指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T10:49:37.860

You can customize the ribbon in Excel or any Office application without using Visual Studio, instead using a combination of XML and VBA.

A good starting-point for customizing the ribbon: [http://msdn.microsoft.com/en-us/library/office/aa338202%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/office/aa338202%28v=office.12%29.aspx) (The title says Office 2007 but it will work for Office 2010 as well)

There is a free application that helps you design and validate the XML to modify the ribbon called the "Custom UI Editor For Microsoft Office": [http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2006/05/25/customuieditor.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2006/05/25/customuieditor.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:20:52.223

实际上你有 Visual Studio，但是 Express Edition，此时它不应该有任何区别；）

我不明白您对“Excel 2010 功能区”的看法。我认为这是由 Excel 2010 处理的，它是 Office 2010 用户界面的一部分，因此如果您在 2010 版本中打开任何 Excel 文件，您将获得功能区。您可以[自定义 Office 2010 功能区](http://msdn.microsoft.com/en-us/library/aa942866.aspx)，并且可以通过多种不同方式创建 Excel 文件，例如[使用 OpenXML](http://www.microsoft.com/en-us/download/details.aspx?id=5124)、[Microsoft Office Interop](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel%28v=office.11%29)。每个都有优点和缺点。

# java - Java：实现没有 lib 的简单列表

> ID：12252444
> 
> 赞同：1
> 
> 时间：2012-09-03T18:14:30.597
> 
> 标签：java, list

如何在不使用任何 Java 库的情况下在 java 中实现简单的 OOP 列表？

Java列表的典型特征是什么？

如果有人告诉您有关 java 的“列表”，您会怎么想？我不知道它是链接列表还是其他列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:19:27.870

您可以查看 javadocs`java.util.List`并查看它定义了哪些方法来获得 indea。然后，您可以考虑自己的实现。

上面的接口有很多实现：`ArrayList`并且`LinkedList`只是一些最流行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:22:54.100

不使用任何 Java 库？

你可以创建一个对象

```
class myList{
  myList nextitem;
  Info moreInfo
}

myList l = new myList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:21:23.907

Java 列表的典型特征在标准[列表](http://docs.oracle.com/javase/7/docs/api/java/util/List.html)接口中定义。如果你以这样的方式实现这个接口，代码

```
List<Foo> bar = new ArrayList<Foo>();
// Other code that calls methods from the List interface, using bar 
```

和

```
List<Foo> bar = new YourCustomList<Foo>();
// The same other code 
```

行为相同（当然，其他代码练习了您关心的列表功能），那么我认为您已经实现了一个 Java 列表。

我注意到您不必实现java.util.List 中的*所有*`UnsupportedOperationException`方法（您未实现的方法可以 throw ），但您应该倾向于实现所有这些方法，除非您的列表不同于“标准” " ArrayList 呈现的列表界面。例如，只读列表应该`UnsupportedOperationException`尝试添加或删除元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T18:45:05.060

主要功能是提供添加不受限制的可能性 - 通过创建参数 - 元素的数量，所以如果没有任何其他要求（访问时间等），只需在添加和删除期间通过动态调整大小来增强 []手术。

但是.. List 是集合的一部分，所以如果你想满足这个“要求”，你应该实现所需的功能。

# ios - uitableview 自定义透明表头

> ID：12252446
> 
> 赞同：1
> 
> 时间：2012-09-03T18:14:35.497
> 
> 标签：ios, uitableview

我正在使用部分标题在相应部分的单元格旁边显示一个“浮动”的小图像。部分标题是透明的，只包含一个图像视图。此解决方案的最初问题是节标题占用高度，这看起来很奇怪（每个节的开头有不必要的空白区域 + 当 tableview 滚动到开头时，图像应该与第一个单元格的顶部对齐部分）。解决此问题的方法是将部分标题高度设置为 1px。图像仍然存在，但标题没有使用任何高度，一切看起来都很棒。

但是现在我需要在该图像上添加一个 UIButton ，不幸的是，当标题的高度为 1px 时它不起作用。它没有被任何东西隐藏或覆盖，它被正确绘制，但设置选择器不会被调用。如果我设置了一些高度，按钮就会起作用。

简而言之 - 如何在几乎没有高度的节标题中实现工作按钮，或者如何实现具有正常高度但始终与单元格重叠的节标题（当表格视图滚动到顶部时不使用任何空间部分）？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:11:57.610

您可能能够使其工作的一种方法是在表格上添加一个透明视图。你会拦截 touchDown 和 touchUp。您可以计算它们是否在您的某个按钮上，如果是，则将它们直接发送到该按钮，否则只需转发它们。您没有收到触摸事件的原因可能是因为触摸没有落入标题框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:33:41.783

David H 的建议也是我最初的想法，但我希望找到一个更优雅的解决方案。无论如何，这就是我最终实现此功能的方式。

我使代码尽可能简单（我确信它可以以更优化的方式完成，工作速度足够快以满足我的需要） - 添加到一个部分的每个图像（不再需要覆盖按钮）也被添加到以节号为键的字典。当我的蒙版层视图（添加到我的表格视图上的透明视图）被触摸时，我只需检查`CGRectContainsPoint`触摸是否对应于我的字典中的任何视图。

# ruby-on-rails - 搜索忽略某些空白参数

> ID：12252447
> 
> 赞同：0
> 
> 时间：2012-09-03T18:14:52.487
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

我有一个简单的搜索操作，它有 3 个参数和一个搜索模型的 where 方法。如果我搜索并且某些参数为nil，它将不会返回我想要的记录。我希望它仅使用非 nil/blank 的参数来搜索数据库。所以如果只输入一个类别并在参数中发送，我希望我的控制器忽略其他两个参数。但是，如果存在其他参数，我希望它们包含在搜索中。

我尝试了很多方法，但我无法让它正常工作。这是我的代码。

```
hash = []
cat = :category_id => params[:category_id]
col = :color_id => params[:color_id]
brand = :brand_id => params[:brand_id]

if params[:category_id].present?
  hash += cat
end

if params[:color_id].present?
  hash += col
end

if params[:brand_id].present?
  hash += brand
end

@results = Piece.where(hash).preload(:item).preload(:user).group(:item_id).paginate(:page => params[:page], :per_page => 9) 
```

我已将变量放入名为 to_a 的字符串和散列中，并用 (",") 将它们连接起来。没有任何效果。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:15:31.647

试试这个代码。

```
criteria = { :category_id => params[:category_id], :color_id => params[:color_id],
  :brand_id => params[:brand_id] }.select { |key,value| value.present? }

@results = Piece.where(criteria).preload(:item).preload(:user).group(:item_id).
  paginate(:page => params[:page], :per_page => 9) 
```

# sql - 如何从 SQL 中的给定数据创建历史表？请让我一步一步知道可能的方法

> ID：12252449
> 
> 赞同：0
> 
> 时间：2012-09-03T18:14:57.170
> 
> 标签：sql, tsql

为数据库创建历史表

数据库将需要许多历史表。其中一些将跟踪单个数据元素，而另一些将跟踪多个相关字段。所有历史表都将包含 TcId、ProgSolNbr、StartDate、EndDate 和正在跟踪的字段。历史表将基于 TcId 与主表（通常是 Accounts）有外键关系。每个帐户的当前记录将由 EndDate '9991231' 标识。更新历史表过程中发生的任何错误都会在 HistLog 表中自动跟踪。以下是更新历史表所需的历史表列表和存储过程示例。

HistExtStatInd

```
 ExtStatInd 
```

HistIntStatInd

```
 IntStatInd 
```

组织状态

```
 Status 
```

历史周期

```
 Cycle 
```

HistCreditBureauInd

```
 CreditBureauInd 
```

历史电话

```
 Phone   Phone2    Phone3 
```

历史定价策略

```
 PricingStrategy 
```

历史记录

BalAmt BalPrinAmt BalFeeAmt BalTransferAmt BalMiscAmt BalDisputeAmt

组名地址

```
 Name   Name2   Address   Address2   City   State   Zip   Zip4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:25:18.710

如果您使用的是 SQL Server 2008，请使用[更改数据捕获](http://msdn.microsoft.com/en-us/library/bb522489%28SQL.105%29.aspx)

如果您使用的是 SQL Server 2005，请使用触发器：

[SQL Server 历史表 - 通过 SP 或触发器填充？](https://stackoverflow.com/questions/349524/sql-server-history-table-populate-through-sp-or-trigger)

# algorithm - 从边缘查找内部几何图形

> ID：12252456
> 
> 赞同：3
> 
> 时间：2012-09-03T18:15:21.283
> 
> 标签：algorithm, matlab, math, geometry, edge-detection

首先，我不确定要为此使用哪些关键字，我想我可能使用了错误的关键字来搜索它，所以如果有人能给我任何提示，我将不胜感激。

我的问题如下：我需要在房屋平面图中找到“房间”。例如采取这个几何：

![在此处输入图像描述](../Images/df73640ae4fe011a0c6d82f51a3ecd42.png)

所需的算法会告诉我哪些顶点限制了每个房间。所以对于这个例子，它将是：

*   A室：1、2、9、10、3、4、5、8 ,1
*   B室：2、3、10、9、2
*   C室：11、12、14、13、11
*   D室：5、6、7、8、5

我将顶点和边作为输入数据。编辑：边缘数据如下（边缘 8、1、2）：

xy

47 196

47 85

258 85

它是像素坐标的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T11:57:55.763

图论并没有真正帮助我，因为我已经断开了共享信息的循环。例如 [1 2 9 10 3 4 5 8 1] 和 [11 12 14 13 11]。所以最后我最终做了一个图像填充，当扩展填充 1 像素的边界并进行布尔运算以确定填充图像内的顶点时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:35:11.157

一种可能的解决方案是对该区域进行三角测量，以便每个输入边都是某个三角形的边。然后将三角形分割成连接的集合并找到它们的边界。

三角测量有几种算法：剪耳法、德劳内法、...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T11:56:04.310

这是[平面图](http://en.wikipedia.org/wiki/Planar_graph)。它有 V 个顶点、E 个边和 F = E - V + 2 个面（包括外面）。我们必须确定所有面的边缘列表。在这些列表中，每条边都将被使用两次（向前和向后）。

创建主弧列表，添加所有弧（即对于 1-2 无向边添加 1-2 和 2-1 有向弧）

找到最低的顶点。如果有一些这样的点，请选择最左边的一个（这里是第 7 个）。沿逆时针方向移动外表面（轮廓）（在每个顶点处选择最右边的出弧）：7-6-5-4-3-2-1-7。从主列表中删除访问过的弧。

从主列表中获取任何弧线，通过第一个内面，遵循右手法则（即 7-8-5-6-7），删除访问过的弧线。

重复直到主列表为空。

对断开的组件重复所有过程 (11-12-13-14)

# php - 使用 SQL 同时更新两个字段的语法

> ID：12252459
> 
> 赞同：2
> 
> 时间：2012-09-03T18:15:34.707
> 
> 标签：php, mysql, sql, sql-update

下面的代码给出了错误，我可能语法错误，我不知道在哪里。错误是：`near '(``last_online``) VALUE ('now()) WHERE (users.id = 55)' at line 1`。

PHP代码：

```
 <?php 
include 'dbc.php';
session_start();
$user_ip = $_SERVER['REMOTE_ADDR'];

$id = $_SESSION['user_id'];

$sql_insert1 = "UPDATE `users` SET (`last_online`)
            VALUES
            ('now()) WHERE (users.id = $id)";

mysql_query($sql_insert1) or die("Insertion Failed:" . mysql_error());
$sql_insert2 = "UPDATE `users` SET (`users_ip`)
            VALUES
            ('$user_ip') WHERE (users.id = $id)";

mysql_query($sql_insert2) or die("Insertion Failed:" . mysql_error()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:27:13.640

该[`UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/update.html)语句的语法是：

```
UPDATE table
SET col_name1={expr1|DEFAULT} [, col_name2={expr2|DEFAULT}] ...
[WHERE where_condition] 
```

因此，您应该使用以下内容来更新单个语句中的两个字段：

```
UPDATE `users` 
SET `last_online` = now(),
    `users_ip` = '$user_ip'
WHERE (users.id = $id) 
```

`VALUES`关键字在语句中使用[`INSERT`](http://dev.mysql.com/doc/refman/5.0/en/insert.html)。

# sql - 多个自连接替换

> ID：12252461
> 
> 赞同：0
> 
> 时间：2012-09-03T18:15:45.053
> 
> 标签：sql, join, self-join

**想要替换表上的多个自连接。SQL中表上自连接的最大限制是多少**

我有一个表 table_1，其列如下：

```
uid number(10),
a_name nvarchar(20),
aaId number (10), 
```

**uid 和 aaId**的组合存在唯一**约束。**

 **表中存在的数据就像。每个 aaId 大约有 90 个 Uid。

现在我的查询就像

```
select aaId from table_1 
  inner join table_1 t1 on t1.uid=9 and t1.a_name like 'a'  
  inner join table_1 t2 on t2.uid=8 and t2.a_name like 'ab'  
  inner join table_1 t3 on t3.uid=7 and t3.a_name like 'ac' 
```

我的问题是内部联接的数量已增加到 90 。由于表中的行数约为 20 万，因此该查询是否有效。或者，如果我可以做任何其他事情来替换大量的自连接。

请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-12T09:39:25.770

请尝试使用自联接和所需条件的此查询

从 table_1 t1、table_1 t2 中选择 aaId，其中（t1.uid=9 和 t2.a_name 像 'a'）或（t1.uid=8 和 t2.a_name 像 'ab'）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:36:23.097

首先，为什么不使用 OR 语句的 WHERE 部分？

```
select aaId from table_1 
WHERE (table_1.uid=9 and table_1.a_name like 'a') OR 
(table_1.uid=8 and table_1.a_name like 'ab') OR
(table_1.uid=7 and table_1.a_name like 'ac') 
```**

# android - 如何在 Spinner 中获取所选项目

> ID：12252462
> 
> 赞同：2
> 
> 时间：2012-09-03T18:15:56.597
> 
> 标签：android, android-spinner

我一直在这个圈子里转。如果它与数据库中的记录匹配，我已设法将微调器设置为在列表中显示项目，但现在在我保存记录时从微调器获取所选项目时出现问题。相反，我得到了类似'android.database.sqlite.SQLiteCursor@44fa41b0'的东西。

在我的 saveInspection() 方法中，我使用了 inspectedBySpinner.getSelectedItem().toString(); （如本文第二个答案中详述的[如何获得 Spinner 的选定值？](https://stackoverflow.com/questions/2652414/how-do-you-get-the-selected-value-of-a-spinner-android)）没有成功..（如此接近但没有香蕉！）。

我确信这是显而易见的事情，但非常感谢您的帮助：

```
public class InspectionEdit extends Activity {

final Context context = this;

private EditText inspectionReferenceEditText;
private EditText inspectionCompanyEditText;
private Button inspectionDateButton;
private Spinner inspectedBySpinner;
private Button saveButton;
private Button cancelButton;
protected boolean changesMade;
private AlertDialog unsavedChangesDialog;
private Button addInspectorButton;

private int mYear;
private int mMonth;
private int mDay;
private StringBuilder mToday;
private RMDbAdapter rmDbHelper;
private long inspectionId;

private String inspectedBySpinnerData;

//private String inspectors;

static final int DATE_DIALOG_ID = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    rmDbHelper = new RMDbAdapter(this);
    rmDbHelper.open();
    Intent i = getIntent();
    inspectionId = i.getLongExtra("Intent_InspectionID", -1);
    setContentView(R.layout.edit_inspection);
    setUpViews();
    populateFields();
    fillSpinner();
    setTextChangedListeners();

}

private void setUpViews() {
    inspectionReferenceEditText =(EditText)findViewById(R.id.inspection_reference);
    inspectionCompanyEditText =(EditText)findViewById(R.id.inspection_company);
    inspectionDateButton =(Button)findViewById(R.id.inspection_date);
    inspectedBySpinner =(Spinner)findViewById(R.id.inspected_by_spinner);

    addInspectorButton = (Button)findViewById(R.id.add_inspector_button);
    saveButton = (Button)findViewById(R.id.inspection_save_button);
    cancelButton = (Button)findViewById(R.id.inspection_cancel_button);
}

 private void populateFields() {
        if (inspectionId > 0) {
            Cursor inspectionCursor = rmDbHelper.fetchInspection(inspectionId);
            startManagingCursor(inspectionCursor);
            inspectionReferenceEditText.setText(inspectionCursor.getString(
                    inspectionCursor.getColumnIndexOrThrow(RMDbAdapter.INSPECTION_REF)));
            inspectionCompanyEditText.setText(inspectionCursor.getString(
                    inspectionCursor.getColumnIndexOrThrow(RMDbAdapter.INSPECTION_COMPANY)));
            inspectionDateButton.setText(inspectionCursor.getString(
                    inspectionCursor.getColumnIndexOrThrow(RMDbAdapter.INSPECTION_DATE)));
            inspectedBySpinnerData = inspectionCursor.getString(
                    inspectionCursor.getColumnIndexOrThrow(RMDbAdapter.INSPECTION_BY));

            Toast.makeText(getApplicationContext(), inspectedBySpinnerData, 
                 Toast.LENGTH_LONG).show();
        }
    }

private void fillSpinner() {

    Cursor inspectorCursor = rmDbHelper.fetchAllInspectors();
    startManagingCursor(inspectorCursor);

    // create an array to specify which fields we want to display
    String[] from = new String[]{RMDbAdapter.INSPECTOR_NAME};
    //INSPECTOR_NAME = "inspector_name"
    // create an array of the display item we want to bind our data to
    int[] to = new int[]{android.R.id.text1};
    // create simple cursor adapter
    SimpleCursorAdapter spinnerAdapter = new SimpleCursorAdapter(this, android.R.layout.simple_spinner_item, inspectorCursor, from, to );
    spinnerAdapter.setDropDownViewResource( android.R.layout.simple_spinner_dropdown_item );
    // get reference to our spinner
    inspectedBySpinner.setAdapter(spinnerAdapter);
    if (inspectionId > 0) {

        int spinnerPosition = 0; 

        for (int i = 0; i < inspectedBySpinner.getCount(); i++)  
        { 
             Cursor cur = (Cursor)(inspectedBySpinner.getItemAtPosition(i)); 

             //--When your bind you data to the spinner to begin with, whatever columns you 
             //--used you will need to reference it in the cursors getString() method... 

             //--Since "getString()" returns the value of the requested column as a String--  
             //--(In my case) the 4th column of my spinner contained all of my text values  
             //--hence why I set the index of "getString()" method to "getString(3)" 

             String currentSpinnerString = cur.getString(1).toString(); 

             if(currentSpinnerString.equals(inspectedBySpinnerData.toString())) 
             { 
                //--get the spinner position-- 
                spinnerPosition = i; 
                break; 
              } 
         }       
         inspectedBySpinner.setSelection(spinnerPosition); 
    }

}

 private void addInspector() {
    // get prompts.xml view
    LayoutInflater li = LayoutInflater.from(context);
    View promptsView = li.inflate(R.layout.prompt_dialog, null);

    AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
            context);

    // set prompts.xml to alertdialog builder
    alertDialogBuilder.setView(promptsView);

    final EditText userInput = (EditText) promptsView
            .findViewById(R.id.editTextDialogUserInput);

    // set dialog message
    alertDialogBuilder
        .setCancelable(false)
        .setPositiveButton("OK",
          new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
            // get user input and set it to result
            // edit text
            String inspector = userInput.getText().toString();
            rmDbHelper.createInspector(inspector);

            }
          })
        .setNegativeButton("Cancel",
          new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
            dialog.cancel();
            }
          });

    // create alert dialog
    AlertDialog alertDialog = alertDialogBuilder.create();

    // show it
    alertDialog.show();
 }

private void setTextChangedListeners() {
     changesMade = false;

     inspectionReferenceEditText.addTextChangedListener(new TextWatcher(){
         public void afterTextChanged(Editable s) {
         }
         public void beforeTextChanged(CharSequence s, int start, int count, int after) {
         }
         public void onTextChanged(CharSequence s, int start, int before, int count) {
             changesMade = true;
         }  
    });

     inspectionCompanyEditText.addTextChangedListener(new TextWatcher(){
        public void afterTextChanged(Editable s) {
        }
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            changesMade = true;
        }   
    }); 

     inspectionDateButton.addTextChangedListener(new TextWatcher(){
        public void afterTextChanged(Editable s) {
        }
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            changesMade = true;
        }   
    });

    inspectionDateButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            showDialog(DATE_DIALOG_ID);
        }
    });

    addInspectorButton.setOnClickListener(new View.OnClickListener() {                      
        public void onClick(View v) {
            addInspector();
        }
    });

    saveButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            saveInspection();
            finish();
        }
    });

    cancelButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
        cancel();
        }
    });
  }

protected void saveInspection() {
    String reference = inspectionReferenceEditText.getText().toString();
    String companyName = inspectionCompanyEditText.getText().toString();
    String inspectionDate = RMUtilities.compareTwoStringsNullIfSame(inspectionDateButton.getText().toString(), "Click to add");
    String inspectedBy = inspectedBySpinner.getSelectedItem().toString();
    Toast.makeText(getApplicationContext(), inspectedBy, 
            Toast.LENGTH_LONG).show();
    if (inspectionId > 0) {
        rmDbHelper.updateInspection(inspectionId, reference, companyName, inspectionDate, inspectedBy);
        Toast.makeText(getApplicationContext(), "Inspection updated", 
                Toast.LENGTH_LONG).show();
    }
    else {
        rmDbHelper.createInspection(reference, companyName, inspectionDate, inspectedBy);
        Toast.makeText(getApplicationContext(), "Inspection created", 
                Toast.LENGTH_LONG).show();
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T18:33:59.257

当您使用`CursorAdapter`基于字符串列表或数组的适配器而不是适配器时，您必须使用[游标](http://developer.android.com/reference/android/database/Cursor.html)来获取所选项目的值。Spinner将调用将返回对象`getSelectedItem`的 CursorAdapter 。所以代替 using ，首先将返回的对象转换为 a ，然后使用 Cursor 的方法来获取所选项目的所需数据。`getItem(position)``Cursor``toString()``Cursor``get...`

**编辑**

根据您填充微调器的方式，您可能需要以下内容：

```
String inspectedBy = ((Cursor)inspectedBySpinner.getSelectedItem())
                        .getString(1).toString(); 
```

# ruby-on-rails - 在 tagged_with order('random()') 上充当可标记

> ID：12252465
> 
> 赞同：1
> 
> 时间：2012-09-03T18:16:12.267
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, acts-as-taggable-on

我正在尝试将 act-as-taggable-on 的`tagged_with`方法与这样的`random()`订单一起使用，

```
Dvd.tagged_with(@site.tag, wild: true, any: true).order('RANDOM()').limit(20) 
```

但我收到以下错误，

```
ActiveRecord::StatementInvalid: PG::Error: ERROR:  for SELECT DISTINCT, ORDER BY     expressions must appear in select list
LINE 1: ... OR dvds_taggings_c684506.tag_id = 3786) ORDER BY RANDOM() L...
                                                         ^
: SELECT  DISTINCT dvds.* FROM "dvds" JOIN taggings dvds_taggings_c684506  ON     dvds_taggings_c684506.taggable_id = "dvds".id AND dvds_taggings_c684506.taggable_type = 'Dvd' WHERE (dvds_taggings_c684506.tag_id = 72 OR dvds_taggings_c684506.tag_id = 2823 OR dvds_taggings_c684506.tag_id = 3786) ORDER BY RANDOM() LIMIT 20 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:50:17.100

我不使用 Postgres - 但从搜索中 - 看起来从 act_as_taggable-on's 中被踢出的 DISTINCT 子句正在引发`tagged_with`问题（至少根据[这个 pgsql 线程](http://archives.postgresql.org/pgsql-sql/2010-10/msg00004.php)

从那篇文章开始，您可能可以使用 AREL 将其构建为子查询 - 类似（我没有在任何地方的控制台中运行它，但这可能会给您一个追求的方向）

```
class Dvd < ActiveRecord::Base

  def self.random_list(limit = 20)
    with_scope do
      subquery = self.tagged_with(@site.tag, wild: true, any: true).pluck(:id)
      self.where("ID IN(#{subquery.to_sql})").order("RANDOM()").limit(limit)
    end
  end

end 
```

它可能不是那么有效，但我的理解 ORDER BY RANDOM() 也不是（我曾经尝试从中获取随机集的所有数据都太小了，我可以加载所有数据，并使用 Array #shuffle 让 ruby​​ 给我一个随机列表——我怀疑你的 DVD 设备是否足够小——除了相对独特的标签）。

# jquery - ZendFramework Ajax jQuery 帖子

> ID：12252466
> 
> 赞同：1
> 
> 时间：2012-09-03T18:16:13.397
> 
> 标签：jquery, ajax, zend-framework, http-post

您好，我在 ZendFramework 中有一个关于 jQuery ajax 发布请求的问题，这是我的 jquery：

```
$("input[type=image].addToCartButton").click(function() {
    var productId = $(this).attr("id");

    $.ajax({
        type: 'POST',
        dataType: 'html',
        url: "http://localhost/ZendProjects/essence/essenceZP/public/order",
        data: {
            id: productId
        },
        success: function(data){
            alert(data);
        }
    });

}); 
```

这是我在 ZendFramework Order Controller 中的代码：

```
 $request = $this->getRequest();
    if($request->isXmlHttpRequest()) {
        $this->_helper->layout()->disableLayout();
        $test = 'testing ajax content';
        $this->view->test = $test;
    } else {
        $test = 'testing non-ajax content';
        $this->view->test = $test;
    } 
```

在萤火虫控制台中我收到一个错误，但看不到错误在哪里，因为它显示 0.5 秒并隐藏..有什么想法吗？这个想法是当您单击按钮将 productId 发送到订单控制器并将其放入会话数组中时，但现在只测试 ajax 请求..

标记：

```
 <form action="" method="post">
        <label for=".productQuantity" style="float: left;margin-top:7px;margin-left: 5px">Количество</label>
        <input class="productQuantity" name="productQuantity" type="number" value="1" min="1" max="1000" style="width: 50px;float: left;margin-left: 7px" />
        <input type="image" id="<?php echo $product->id; ?>" name="<?php echo $this->url(array('controller' => 'order', 'action' => 'add-to-cart'), 'default', true) ?>" src="<?php echo $this->baseUrl('images/cartPut.png'); ?>" style="margin-left: 13px;" />
    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:13:52.193

发生的事情是，当您单击提交按钮时，会在提交表单的同时触发 ajax 调用。

您可能想知道如果没有`action=""`.

问题是，当 action 属性为空时，它假定它在同一页面上。我的意思是，如果你在`localhost/index.php`比`action=""`=`action="localhost/index.php"`

因此，您必须通过添加禁用表单提交 `action="javascript:void(0)"`。

您也可以为此使用 jQuery：

[在jquery中取消提交？](https://stackoverflow.com/questions/1773852/cancel-a-submit-in-jquery)

甚至是纯 javascript（向提交事件返回 false）

# android - ItemizedOverlay 的 Android Map 性能低下

> ID：12252470
> 
> 赞同：0
> 
> 时间：2012-09-03T18:16:31.240
> 
> 标签：android, performance

我有

```
 public class MyItemsOverlay extends ItemizedOverlay<OverlayItem>{
private List<OverlayItem> items=new ArrayList<OverlayItem>();
private Drawable marker=null;   
private StatusData data;    
private MapView mapView;
 private PopupPanel panel;

public MyItemsOverlay (Drawable defaultMarker, View view, LayoutInflater getLayoutInflater) {       
    super(defaultMarker);
      this.marker=defaultMarker;               
      mapView=(MapView) view.findViewById(R.id.mapview);
      panel=new PopupPanel(R.layout.details_popup,getLayoutInflater, mapView);
      data=new StatusData (mapView.getContext());
      items=  protectedZoneData.GetItems();  

      populate();
}

 @Override
    protected OverlayItem createItem(int i) {
      return(items.get(i));
    }

  @Override
    public int size() {
      return(items.size());
    }

  @Override
    protected boolean onTap(int i) {

      OverlayItem item=getItem(i);
      GeoPoint geo=item.getPoint();       

      View view=panel.getView();

      ((TextView)view.findViewById(R.id.latitude))
        .setText(String.valueOf(geo.getLatitudeE6()/1000000.0));
      ((TextView)view.findViewById(R.id.longitude))
        .setText(String.valueOf(geo.getLongitudeE6()/1000000.0));
      ((TextView)view.findViewById(R.id.Name))
                              .setText(item.getTitle());
      ((TextView)view.findViewById(R.id.Description))
                              .setText(item.getSnippet());

      panel.show();
      hidePopup();
      return(true);
    } 
```

}

我需要加载大约 100 000 个点。

我还有另一个覆盖层可以创建多边形（100 000 个多边形）

```
public class MyPolygonOverlay  extends Overlay{

private StatusData data; 

private Projection projection;
ArrayList<ArrayList<GeoPoint>> geArrayList;

public MyPolygonOverlay(Context context, MapView mapView)
{
    data=new StatusData(context);

    projection=mapView.getProjection();
    geArrayList=data.GetPoyigonGeoPoints();

}

public void draw(Canvas canvas, MapView mapView, boolean shadow){
    super.draw(canvas, mapView, shadow);

    for (int i = 0; i < geArrayList.size(); i++) {
         Path path = new Path();
         ArrayList<GeoPoint> geoPoints=geArrayList.get(i);
         for (int j = 0; j <geoPoints.size(); j++) {

               GeoPoint gP1 =geoPoints.get(j);
               Point currentScreenPoint = new Point();

                Projection projection = mapView.getProjection();
                projection.toPixels(gP1, currentScreenPoint);

                if (j == 0){
                  path.moveTo(currentScreenPoint.x, currentScreenPoint.y);                    

                }                  
                else
                {
                  path.lineTo(currentScreenPoint.x, currentScreenPoint.y);
                }
            }
           canvas.drawPath(path, GetPaint());

}
} 
```

在缩放级别 5 上加载第一个叠加层，然后在缩放 8 上加载第二个叠加层。

如何加快我的申请速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:22:50.820

在一个位图上绘制叠加层并使用该位图而不是重绘每个多边形。

您只需要根据缩放级别计算位图的缩放比例。

# java - （java.util.regex.Pattern 的问题）检查字符串中的数字和字母

> ID：12252473
> 
> 赞同：3
> 
> 时间：2012-09-03T18:16:56.797
> 
> 标签：java, string, design-patterns

我的任务是检查新字符串（登录名）是否符合一些规则这些是规则：

```
1\. It has to be 1-20 symbols length
2\. It may consist of digits, letters (a-z,A-Z), dots and "-"
3\. The first symbol has to be a letter (a-z,A-Z)
4\. It has to end with a letter or a digit 
```

所以我想到了使用java.util.regex.Pattern，但我遇到了一些问题。这就是我所拥有的：

```
 String login = "a.bc-.52";
    Pattern p1 = Pattern.compile("([a-zA-Z]{1}[a-zA-Z\\d.-]{0,18}[a-zA-Z\\d])");
    Matcher m1 = p1.matcher(login);
    boolean b = m1.matches(); 
```

我无法检查字符串是否以字母或数字结尾。我想我可以分割字符串并用不同的模式检查它的部分，但有件事告诉我，它可以更容易地完成。

如果这是一个愚蠢的问题或者我犯了错误，我很抱歉。也许有更简单的方法，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:20:41.990

`^[a-zA-Z]{1}[a-zA-Z\d.-]{0,18}[a-zA-Z\d]$`

`^`<- 确保字符串以字母开头

`$`<- 确保字符串以数字字母结尾

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:21:34.440

您正在寻找的是美元符号。就那么简单：

> t$ --> 以 t 结尾

对面是**^**

> ^a - 以 a 开头

因此，在您的情况下，只需在末尾添加美元符号。

# php - 用 + 图标替换空格

> ID：12252481
> 
> 赞同：0
> 
> 时间：2012-09-03T18:18:05.237
> 
> 标签：php

使用 PHP 用 + 图标替换空格的方法是什么。假设像“I Love PHP”这样的一些文本会像“I+Love+PHP”这样自动转换..假设一个字段在变量 like> 中有这个文本，`$text = I Love PHP`所以这个变量的文本空间将被替换为一个新的 + 符号像这样的变量>`$text_plus=I+Love+PHP`如何用 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:21:20.290

只是一个猜测，但这看起来像您正在尝试对 URL 的字符串进行编码，使用`urlencode()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:20:59.280

使用[Str_Replace](http://php.net/manual/en/function.str-replace.php)函数

在您的情况下，它将是：

```
$text = "I Love PHP";
$output = str_replace(" ", "+", $text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:20:36.733

试试这个

```
str_ireplace(' ','+',$text); 
```

# windows-phone-7 - 应该使用什么系统颜色在强调背景上绘制文本？

> ID：12252486
> 
> 赞同：1
> 
> 时间：2012-09-03T18:18:34.113
> 
> 标签：windows-phone-7

我需要将文本放在带有重音（PhoneAccentBrush）背景的面板中。用于文本的 PhoneForegroundBrush 在深色主题中看起来不错，但在浅色主题中效果不佳。看起来无论主题如何，文本都应该是白色的。

在这种情况下应该使用什么颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T08:21:09.357

白色可能是你最好的选择。（它用于动态磁贴上的文本，以帮助更容易阅读，而不管磁贴颜色如何 - 这通常是强调色。）您也可以考虑黑色。

面板的大小以及文本的重量和大小也会影响颜色选择的适当性。

# html - 输入元素彼此相邻，覆盖整个容器宽度

> ID：12252488
> 
> 赞同：0
> 
> 时间：2012-09-03T18:18:38.483
> 
> 标签：html, css

这不是我写过的最不言自明的标题。

我正在尝试做的（**[见this fiddle](http://jsfiddle.net/jlowgren/ddYmH/)**）是让文本字段和按钮保持在彼此相邻的位置（没有边距），按钮位于*右侧*，文本字段覆盖剩余宽度的100％按钮未占用的容器。即使调整了包含元素的大小，两者之间的关系也应该保持不变。

浏览器要求：IE9+、Firefox、Webkit

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:32:39.290

看看这个小演示：[小链接](http://jsfiddle.net/glee/ddYmH/19/)。该代码非常自我解释，但这是基本思想：

```
<div class = "container">
    <div class = "cell">
        <input type="text" placeholder="Glee's awesome!" />
    </div>
    <div class = "cell" style = "width: 1px"> <!--make sure it's only large enough to fit the button-->
        <button type="submit">Glee</button>
    </div>
</div> 
```

CSS：

```
.container {
    display: table;
    width: 100%;
}
.cell {
    display: table-cell;   
} 
```

希望有帮助！

# asp.net - 在 Entity Framework 5 中重命名导航属性不会更新代码

> ID：12252489
> 
> 赞同：4
> 
> 时间：2012-09-03T18:18:40.167
> 
> 标签：asp.net, entity-framework

我想重命名一个导航属性，并用我给的新名称在代码中访问该对象。我已将我的一个用户属性重命名为更有意义的名称，而不是 1,2,3...等。

在这个例子中，我在模型图中将 OGSMUser5 重命名为 OGSMUserResponsible。

然后我尝试在代码中访问它，但它找不到我重命名的属性 OGSMUserResponsible。

```
@contImprovement.OGSMUserResponsible.FullName 
```

当我查看从实体数据模型生成的模型中的代码时，我看到新重命名的模型的代码没有更改，这解释了为什么我无法访问它。

```
 public virtual OGSMUser OGSMUser { get; set; }
    public virtual OGSMUser OGSMUser1 { get; set; }
    public virtual OGSMUser OGSMUser2 { get; set; }
    public virtual OGSMUser OGSMUser3 { get; set; }
    public virtual OGSMUser OGSMUser4 { get; set; }
    public virtual OGSMUser OGSMUser5 { get; set; } 
```

我已经看到了与此有些相似的问题，但是我所看到的答案我不敢相信是唯一的选择。他们一直在部分类中手动创建一个具有您想要的名称的新属性（我在导航属性中将我的重命名为），并返回带有名称中数字的导航属性以帮助清理它。我不敢相信这是完成我正在寻找的最佳方式。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:30:46.630

您可能没有运行[T4 模板转换](http://msdn.microsoft.com/en-us/data/gg558520.aspx)。

只需右键单击您的**.tt 文件**（它们位于解决方案资源管理器树中的 .edmx 文件下）并**运行**它们。或者，您可以通过单击 Visual Studio 工具栏中的按钮来**运行所有 tt 。**

![T4 模板在 Visual Studio 中运行](../Images/99c0ef5f3c7643f126ff5d266bfee0dc.png)

# c++ - 如果可执行文件在两个或多个节点上运行，为什么不能看到环境变量？

> ID：12252490
> 
> 赞同：2
> 
> 时间：2012-09-03T18:18:44.923
> 
> 标签：c++, environment-variables, mpi, pbs, torque

我正在使用 MPI 在 C++ 中编写一个程序（我将其称为“启动器”），以“生成”第二个可执行文件（“从属”）。根据集群有多少节点可供启动器使用，它将在每个节点上启动从属服务器，从属服务器也将通过 MPI 与启动器进行通信。当从节点完成其数学运算后，它会告诉启动器该节点现在可用，并且启动器将另一个从节点派生到空闲节点。关键是在一组异构机器上运行 1000 次独立计算，这些计算取决于第二个可执行文件。

这是在我自己的计算机上工作的，在那里我创建了一个“假”机器文件（或主机文件），为程序提供了两个节点：localhost 和 localhost。启动器生成两个从站，当其中一个结束时，启动另一个从站。这告诉我产卵过程正常工作。

当我将它移动到我实验室的集群时（使用扭矩/maui 来管理它），如果我要求 1（一个）节点，它也可以工作。如果我要求更多，我会收到一个缺少库的错误（准确地说是 libimf.so。来自英特尔编译器的库）。lib在那里，节点可以看到它，因为如果我只要求一个节点，程序就会运行。

我的 PBS 看起来像这样：

```
#!/bin/bash
#PBS -q small 
#PBS -l nodes=1:ppn=8:xeon
#PBS -l walltime=1:00:00
#PBS -N MyJob
#PBS -V 

export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/mpich2.shared.exec/lib/:/opt/intel/composerxe-2011.3.174/compiler/lib/intel64/:/usr/local/boost/lib/

log_file="output_pbs.txt"

cd $PBS_O_WORKDIR

echo "Beginning PBS script." > $log_file

echo "Executing on hosts ($PBS_NODEFILE): " >> $log_file
cat $PBS_NODEFILE >> $log_file

echo "Running your stuff now!" >> $log_file

# mpiexec is needed in order to let "launcher" call MPI_Comm_spawn.
/usr/local/mpich2.shared.exec/bin/mpiexec -hostfile $PBS_NODEFILE -n 1 /home/user/launhcer --hostfile $PBS_NODEFILE -r 1 >> $log_file 2>&1

echo "Fim do pbs." >> $log_file 
```

当我尝试两个或更多节点时，启动器不会生成任何可执行文件。我得到这样的输出：

```
Beginning PBS script.
Executing on hosts (/var/spool/torque/aux//2742.cluster): 
node3
node3
node3
node3
node3
node3
node3
node3
node2
node2
node2
node2
node2
node2
node2
node2
Running your stuff now!

(Bla bla bla from launcher initialization)

Spawning!
/usr/local/mpich2.shared.exec/bin/hydra_pmi_proxy: error while loading shared libraries: libimf.so: cannot open shared object file: No such file or directory 
```

我在邮件列表中发现了另一个人的问题，例如我的问题，但没有解决方案。（[http://lists.mcs.anl.gov/pipermail/mpich-discuss/2011-July/010442.html](http://lists.mcs.anl.gov/pipermail/mpich-discuss/2011-July/010442.html)）。唯一的答案建议尝试查找节点是否可以看到 lib（如果存储 lib 的目录已安装在节点上），所以我尝试了

`ssh node2 ls /opt/intel/composerxe-2011.3.174/compiler/lib/intel64/libimf.so >> $log_file`

在我的 PBS 脚本中，并且 lib 存在于节点可以看到的文件夹中。

在我看来，torque/maui 似乎没有将环境变量导出到所有节点（即使我不知道为什么它不会），所以当我尝试使用 MPI_Spawn 在另一个节点中运行另一个可执行文件时，它找不到库。这有任何意义吗？如果是这样，你能提出一个解决方案吗？任何人都可以提供任何其他想法吗？在此先感谢，马塞洛

**编辑：**

按照其中一个答案中的建议，我安装了 OpenMPI 以使用 mpiexec 测试选项“-x VARNAME”。在 PBS 脚本中，我将执行行更改为以下内容：

```
/usr/local/openmpi144/bin/mpiexec -x LD_LIBRARY_PATH -hostfile $PBS_NODEFILE -n 1 /var/dipro/melomcr/GSAFold_2/gsafold --hostfile $PBS_NODEFILE -r 1 >> $log_file 2>&1 
```

但收到以下错误消息：

```
[node5:02982] [[3837,1],0] ORTE_ERROR_LOG: A message is attempting to be sent to a process whose contact information is unknown in file rml_oob_send.c at line 105
[node5:02982] [[3837,1],0] could not get route to [[INVALID],INVALID]
[node5:02982] [[3837,1],0] ORTE_ERROR_LOG: A message is attempting to be sent to a process whose contact information is unknown in file base/plm_base_proxy.c at line 86 
```

从互联网上，我可以收集到这个错误通常来自多次执行 mpiexec，比如`/path/to/mpiexec mpiexec -n 2 my_program`我的情况一样。

我相信我应该补充一点，生成的“从属”程序使用端口与“启动器”程序通信。启动器使用 MPI_Open_port 和 MPI_Comm_accept 打开一个端口，然后在从属程序运行 MPI_Comm_connect 时等待从属程序连接。

就像我上面所说的，当我只要求一个节点时，所有这些都有效（使用 MPICH2）。**使用 OpenMPI，即使**我只要求一个节点，我也会收到上述错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:28:35.030

你是对的。远低于集群软件的远程调用不会传输环境变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T13:57:34.563

您可以使用 mpiexec 的 -x 选项将环境变量传递给其他节点。

# python - wxpython 水平 listctrl

> ID：12252492
> 
> 赞同：0
> 
> 时间：2012-09-03T18:18:59.170
> 
> 标签：python, user-interface, wxpython, wxglade

我想在 wxpython 中以水平格式显示图标列表。我正在使用`wxglade`，但找不到如何设置列表的方向。每个项目都有一个图标，在图标下方有一个标题。这样的设计可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:06:25.070

ListCtrl 在报告模式下不支持该功能。我想您也许可以使用其他样式标志之一来做到这一点。然而，Joran 的想法是正确的。但是，我会创建一系列 wx.Image 或 wx.StaticBitmap 小部件并将它们添加到水平 BoxSizer 而不是他所做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:15:55.647

就像是

```
class MyList(wx.ScrollPanel):
   def __init__(self,the_list,parent):
      wx.ScrollPanel.__init__(self,parent,-1)
      self.SetMinSize((parent.GetSize()[0],-1))
      sz = wx.BoxSizer(wx.HORIZONTAL)
      for Item in the_list:
           sz.Add(Item)
      self.SetSizer(sz)
      self.Layout() 
```

the_list 中的每个项目都是一个 wx.Panel，其中包含您的图标和文本...

至少像这样的东西......它未经测试......而且不知道你会如何在wxGlade中做到这一点

# matlab - 实时实现类似于 Matlab filtfilt 的滤波器响应？

> ID：12252494
> 
> 赞同：1
> 
> 时间：2012-09-03T18:19:03.193
> 
> 标签：matlab, filter, filtering, signal-processing

在过去的几个月里，我遇到了一个问题，解决它对我来说似乎是一个梦想！:D

我遵循的工作......最初我使用matlab的filtfilt函数高通某个信号以消除它的直流偏移。结果符合预期。

但是，当我使用 matlab fdatool（具有 order2 的巴特沃斯滤波器）实时实现相同的高通滤波器时，滤波器响应会发生巨大变化。

似乎 filtfilt 函数实现是完美的，可能是由于零相位。注意相位在我的过滤过程中也很重要？

谁能帮我设计一个实时过滤器，它可以提供 matlab filtfilt 性能？

# java - Java if 语句，'Else' 仍然执行

> ID：12252499
> 
> 赞同：2
> 
> 时间：2012-09-03T18:19:28.793
> 
> 标签：java, if-statement, execute

我正在学习Java，希望有一天能擅长它。现在我正在玩 If 语句。我在玩耍时编写了以下代码：

```
import java.util.Scanner;

class programBegin {
public static void main(String args[]) {

    int myNum;

    Scanner sc = new Scanner(System.in); // Creates variable sc as type Scanner
    System.out.println("Enter a number between 1 and 10: ");
    myNum = sc.nextInt(); // Requests input and will store it as type int.

    if (myNum > 5) {
        System.out.println("Your number is greater than 5.");
    }
    if (myNum == 5) {
        System.out.println("your number is equal to 5.");
    } else {
        System.out.println("Your number is less than 5.");
    }
  }
} 
```

例如，如果我输入 6，我得到的输出是：

你的数字大于 5。

您的号码少于 5 个。

我认为 else 不应该执行，除非前面的语句是错误的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-03T18:21:03.160

你`else`在`if (myNum == 5)`.

```
if (myNum > 5) {
    System.out.println("Your number is greater than 5.");
} else if (myNum == 5) {
    System.out.println("your number is equal to 5.");
} else {
    System.out.println("Your number is less than 5.");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:21:14.363

将其更改为 else if

```
if (myNum > 5) {

} else if (myNum == 5) {

} else {

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:21:40.117

如果您在第二个 if 之前添加一个 else，它将按您的预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T18:22:12.800

您的代码相当于“如果数字超过 5，打印这个。如果数字是 5，打印这个。如果数字不是 5，打印这个。”

您的`else`陈述对应于`if (myNum == 5)`而不是`if (myNum > 5)`。

您可能希望在此处使用 if-else 语句。

```
if (myNum > 5) {
    System.out.println("Your number is greater than 5.");
} else if (myNum == 5) {
    System.out.println("your number is equal to 5.");
} else {
    System.out.println("Your number is less than 5.");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T18:22:06.543

在第一个`if`......**它不存在块**之后......它还**检查第二个如果......并且作为它的错误......它进入else......**

试试这个方法......

```
if (myNum > 5) {
        System.out.println("Your number is greater than 5.");
    }
    if (myNum == 5) {
        System.out.println("your number is equal to 5.");
    } 
   else if(myNum < 5) {
        System.out.println("Your number is less than 5.");
    } 
```

**或者**

```
 if (myNum > 5) {
            System.out.println("Your number is greater than 5.");
        }
        else if (myNum == 5) {
            System.out.println("your number is equal to 5.");
        } 
       else (myNum < 5) {
            System.out.println("Your number is less than 5.");
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T18:22:06.793

您需要将第二个 if 放入 else if 语句，因为第二个 if 总是被检查并且它返回 false 因为 6!= 5，这意味着您的 else 将被评估。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-03T18:35:17.230

您可以使用它来提高性能。

这里如果 mynum 大于 5 ，其他两个 if 将被省略：

```
if (myNum > 5) {
    System.out.println("Your number is greater than 5.");
} else{
    if (myNum == 5) {
        System.out.println("your number is equal to 5.");
    } else if(myNum < 5) {
        System.out.println("Your number is less than 5.");
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-03T18:35:36.617

这些是正在执行的两个不同的“if”语句，而不是一个。有很多方法可以解决这个问题......请参阅上面的许多不同方法 :) 有趣的是，不输入一个单词可能会产生不同的输出，或者在这种情况下，会产生多个输出。在这种情况下，“else if”将是修复小错误的好方法。祝您学习过程顺利。

# c# - 有没有一种以编程方式将 NULL 值传递给 Crystal Reports 的方法

> ID：12252501
> 
> 赞同：0
> 
> 时间：2012-09-03T18:19:49.000
> 
> 标签：c#, visual-studio-2010, null, crystal-reports-2010

它是 VS 2010 版本。

CR 能够接受 NULL 值，因为当它提示我输入参数值时，有一个可爱的小复选框，上面写着“设置为 NULL”。这是我需要的行为。

但是，我几乎从不这样调用报告，我是用代码来做的。所以，如果用户没有为参数提供值，我想在它的位置传递 NULL 值，所以我可以在报告本身中做一些不同的事情。

我已经在网上搜索了很长时间，主要是在 CR 论坛上，我有很多解决方案，但没有一个真正有效。

这是其中之一：

```
ParameterDiscreteValue objDiscreteValue = new ParameterDiscreteValue();
objDiscreteValue.Value = null;
rptH.SetParameterValue(parName, new ParameterDiscreteValue(objDiscreteValue)); 
```

CR 说您没有为 ... 参数提供值。

我通过创建双参数来解决它。一个实参，一个卫星参（布尔值，只看实参是否有值）。它有效。但这很乏味，并且使我的泛型（根据报告元数据自动提示参数）非常困难。

我希望有人已经深入挖掘以找到解决此问题的方法。

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:09:53.943

我用 VS.2005 做到了这一点，但我认为这是同样的问题。根据经验，我们对数据类型没有任何问题`VARCHAR`，但是当我们使用`Number`数据类型时，问题就出现了。

对于`VARCHAR`数据类型，您只需将一个空字符串传递给参数。例如，我在 SQL Server 中有参数，其数据类型`VARCHAR`如下：

`MyParamFields.Add(AddParamReport("@TheActiveYear", mTahunAktiv, ParameterValueKind.StringParameter))`

在这种情况下，如果我想传递值，我只需在我的 VB.Net 代码中`NULL`为变量提供空字符串，如下所示。并且 CR 建议将此作为空值并给出正确的结果。`mTahunAktiv``mTahunAktiv=""`

对于一种`Number`数据类型，它有点棘手。我认为这是目前最好的方法，就像你在谷歌上搜索过但还不知道解决方案一样。

例如，在我的情况下，我有一个参数用于传递数据类型*为数字值的月份*`SMALLINT`，但有时用户需要将值作为`NULL`. 为了克服这个问题，我只是向该参数发送了一个值，例如 13，但在此之前，您必须在 SQL QUERY 中处理它，如果您将 13 值赋予该参数，它将变为 NULL。为此，我使用带有动态过滤参数的存储过程。对我来说，这可以解决我的问题。

我不确定你是否会明白我的意思，但我希望这个小小的经验可以帮助你解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:09:21.163

我偶然发现了来自 ADO.NET DataSets 的 DBValue.Null，它促使我尝试将其传递给 Crystal，瞧，它起作用了。像这样：

```
ParameterDiscreteValue objDiscreteValue = new ParameterDiscreteValue();
objDiscreteValue.Value = DBNull.Value;
rptH.SetParameterValue(parName, objDiscreteValue); 
```

我希望这对某人有所帮助，但我认为这应该记录在某个地方。

此致，

# knockout.js - 淘汰赛自定义绑定处理程序

> ID：12252503
> 
> 赞同：2
> 
> 时间：2012-09-03T18:20:06.123
> 
> 标签：knockout.js

我无法让它工作：http: [//jsfiddle.net/2jg2F/1/](http://jsfiddle.net/2jg2F/1/)

我基本上想创建一个链接，当有人单击文本时更改为输入框。我试过淘汰赛 2.0 和 2.1。

HTML

```
<div data-bind="clickToEdit : message"> </div> 
```

Javascript

```
ko.bindingHandlers.clickToEdit = {
    init: function(element, valueAccessor) {
        var observable = valueAccessor(),
            link = document.createElement("a"),
            input = document.createElement("input");

        element.appendChild(link);
        element.appendChild(input);

        observable.editing = ko.observable(false);
        ko.applyBindingsToNode(link, {
            text: observable,
            visible: !observable.editing,
            click: function() {
                observable.editing(true);
            }
        });

        ko.applyBindingsToNode(input, {
            value: observable,
            visible: observable.editing,
            hasfocus: observable.editing
        });
    }
};

function ViewModel() {
    this.message = ko.observable("Click on me to edit");
}
ko.applyBindings(new ViewModel()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:31:01.287

您的问题出在这一行：

```
visible: !observable.editing 
```

这将评估为假，并将保持这种状态。即使你这样做`!observable.editing()`了，那也将是一个静态的真值。

因此，有两种方法可以处理它：

1 - 一个不错的选择是创建一个快速`hidden`绑定处理程序，它只将相反的值传递给可见绑定。有几种写法，但这里有一个简单的方法：

```
ko.bindingHandlers.hidden = {
    update: function(element, valueAccessor) {
        var isVisible = !ko.utils.unwrapObservable(valueAccessor());
        ko.bindingHandlers.visible.update(element, function() { return isVisible; });
    }        
}; 
```

现在，您可以使用：

```
hidden: observable.editing 
```

这是一个示例：http: [//jsfiddle.net/rniemeyer/2jg2F/2/](http://jsfiddle.net/rniemeyer/2jg2F/2/)

2 - 另一种选择是添加一个返回相反的计算 observable。就像是：

```
 observable.editing = ko.observable(false);
    observable.notEditing = ko.computed(function() {
       return !observable.editing(); 
    }); 
```

然后，绑定`notEditing`如下：

[http://jsfiddle.net/rniemeyer/2jg2F/3/](http://jsfiddle.net/rniemeyer/2jg2F/3/)

# android - Android邮件客户端，远程进程与否

> ID：12252504
> 
> 赞同：0
> 
> 时间：2012-09-03T18:20:12.580
> 
> 标签：android, android-service

作为相对较新的 android 平台，我被赋予了实现电子邮件客户端的任务。为此，我想使用始终在后台运行的服务（客户端应始终在服务器收到电子邮件后立即收到电子邮件，这是客户的要求）。

现在我已经查看了 android 中的服务，但似乎找不到关于服务应该是本地还是远程的任何好的答案。

选择其中一个的主要优点/缺点是什么？请记住，服务必须始终运行。我知道我知道。坏的。但它对于应用程序的核心功能至关重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:47:48.920

首先，在 Android 上像这样从远程服务器发出即时通知的正确/有效方法是使用[Google Cloud Messaging](http://developer.android.com/guide/google/gcm/index.html)。GCM 允许您通过向应用程序发送 Intent 来远程唤醒设备，然后您可以将其用作从服务器获取消息、向状态栏发布通知等的信号。

除非您完全正确，否则使用永久运行的服务执行您所描述的操作将对电池寿命产生重大影响。让手机一直处于唤醒状态并不是一个可行的选择。使用 GCM，不要为此推出自己的解决方案。

但是由于您的问题是关于是否在单独的进程中运行服务的问题更为笼统，因此通常越简单越好，在这种情况下，更简单意味着在同一进程中运行。您将可以访问内存中应用程序进程的所有各种元素，并且通常您可能会更轻松。你的事件都将发生在同一个主线程的 Looper 上。一切都会变得简单得多。

如果您还没有充分的理由为您的服务使用单独的进程，则应该在同一进程中运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:26:07.033

一般来说，我不知道你为什么要使用另一个进程的原因。如果你愿意 - 你将不得不处理所有这些 AIDL、包裹等的进程间通信。

如果您将保持相同的过程 - 在组件之间传输数据会容易得多。

我认为创建多个进程的唯一原因是尽量避免 Android 堆预算限制。您可以尝试在进程之间移动重物并尝试将限制加倍。但是我认为你不需要这个，这也是不好的方式。

所以我建议不要玩流程，让事情尽可能简单。

祝你好运

# wpf-controls - 将文本标签添加到 WPF 必应地图

> ID：12252505
> 
> 赞同：2
> 
> 时间：2012-09-03T18:20:16.453
> 
> 标签：wpf-controls, bing-maps

是否可以在 WPF bing 地图中将文本添加到指定位置（纬度/经度）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-06T05:17:29.350

是的，我会假设 c# 代码隐藏？

```
// I just created a Location object from the mouseclick but you can replace labelLocation with anything
Microsoft.Maps.MapControl.WPF.Location labelLocation = myMap.ViewportPointToLocation(mousePosition);

// Create a label
Label customLabel = new Label();
customLabel.Content = "Text here";
// With map layers we can add WPF children to lat long (WPF Location obj) on the map.
MapLayer labelLayer = new MapLayer();
labelLayer.AddChild(customLabel, labelLocation );
myMap.Children.Add(labelLayer); 
```

# memory - JFrame 平滑调整内存泄漏大小

> ID：12252506
> 
> 赞同：2
> 
> 时间：2012-09-03T18:20:20.913
> 
> 标签：memory, resize, jframe, memory-leaks

对于我正在处理的某个 GUI 项目，我有一个 JFrame，其中包含一个带有选项卡等的窗格。对于每个选项卡，它都有不同的大小，所以我想将窗口调整为该大小，但我不想通过调用 setSize 来捕捉到该大小，我希望它更平滑地滑动到该大小。我通过以下基本代码实现了这一点：

```
 private class Resizer implements Runnable {

    private int nw, nh, runs, sizex, sizey;
    private float width, height, wpms, hpms, decay = 0.994f;
    private Future future;

    public Resizer(int newwidth, int newheight){

        Dimension d = Toolkit.getDefaultToolkit().getScreenSize();
        sizex = d.width;
        sizey = d.height;
        width = frame.getWidth();
        height = frame.getHeight();
        wpms = (float)(newwidth - frame.getWidth()) / 1000;
        wpms *= 6;
        hpms = (float)(newheight - frame.getHeight()) / 1000;
        hpms *= 6;
        nw = newwidth;
        nh = newheight;
        runs = 0;

    }

    public void run(){

        runs++;
        if (runs == 1000){

            frame.setSize(nw, nh);
            future.cancel(true);
            canResize = true;
            return;

        }

        width += wpms;
        wpms *= decay;
        height += hpms;
        hpms *= decay;
        if (height + frame.getY() > sizey)
            frame.setLocation(frame.getX(), frame.getY() - (int)(frame.getY() + height - sizey));
        frame.setSize((int) width, (int) height);
        frame.repaint();

    }

    public void setFuture(Future f){

        future = f;

    }

}

public boolean resizeTo(int width, int height){

    if (canResize){

        canResize = false;
        Resizer r = new Resizer(width, height);
        r.setFuture(timer.scheduleAtFixedRate(r, 0, 2, TimeUnit.MILLISECONDS));
        return true;

    }
    return false;

} 
```

但显然有一个问题存在内存泄漏（调整几次后它从 20k 变为 150k），我发现这是在调整大小时使用 setSize 很多次。

有没有办法修复泄漏或其他调整大小的方法？

# c - 根据函数 F( N ) = rank 求十进制数的秩

> ID：12252510
> 
> 赞同：7
> 
> 时间：2012-09-03T18:20:41.413
> 
> 标签：c, performance, algorithm, bit-manipulation, time-complexity

我在[这里](https://stackoverflow.com/questions/7932558/find-rank-of-a-number-on-basis-of-number-of-1s)找到了这个问题，但这不是我正在寻找的答案。因此，再次发布。

形式的一个功能：

```
F( N ) = rank 
```

表示给定一个`N`十进制表示的数字，它的秩为：

```
Starting from 0 to N, how many numbers are there with same number of set bits in its
binary representation. 
```

我将通过一个例子使其更清楚。

```
N = 6 ( 0110 )
Its rank is 3.
1\. 3 ( 0011 )
2\. 5 ( 0101 )
3\. 6 ( 0110 ) 
```

现在，给定一个数字，找出它的等级。

显而易见的方法是从 0 开始并检查每个数字的设置位数，直到`N-1`。

问题是：

有没有 logN 解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T18:34:49.980

是的，有一个`log n`解决方案。

让`n`设置`k`位，最高有效位在位置`p`（从 0 开始计数位置，所以`2^p <= n < 2^(p+1)`）。然后有`pCk`（二项式系数，也`choose(p,k)`）方法将`k`位放置在位置`0, ..., p-1`中，所有这些都给出了精确`k`设置的位小于的数字`n`。如果`k == 1`，就是这样，否则仍然存在具有`k`设置位和`p`第 - 位设置的数字小于`n`要考虑的数字。这些可以通过确定 的排名来计算`n - 2^p`。

代码（不是最优的，做了一些不必要的重新计算，并没有做所有的事情来避免溢出）：

```
unsigned long long binom(unsigned n, unsigned k) {
    if (k == 0 || n == k) return 1;
    if (n < k) return 0;
    if (k > (n >> 1)) k = n-k;
    unsigned long long res = n, j;
    // We're not doing all we can to avoid overflow, as this is a proof of concept,
    // not production code.
    for(j = 2; j <= k; ++j) {
        res *= (n+1-j);
        res /= j;
    }
    return res;
}

unsigned popcount(unsigned long long n) {
    unsigned k = 0;
    while(n) {
        ++k;
        n &= (n-1);
    }
    return k;
}

unsigned long long rank(unsigned long long n) {
    if (n == 0) return 1;
    unsigned p = 0, k = popcount(n);
    unsigned long long mask = 1,h = n >> 1;
    while(h > 0) {
        ++p;
        h >>= 1;
    }
    mask <<= p;
    unsigned long long r = binom(p,k);
    r += rank(n-mask);
    return r;
} 
```

在循环中测试`0 <= n < 10^8`以检查错误，但未发现任何不匹配。

[在此处](http://ideone.com/159HJ)检查输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:12:27.343

它可以通过组合和排列技术来解决。

F(N) = 等级

首先找到表示 N 所需的位数。在二进制表示中，数字可以构造如下：

```
N = cn 2^n + .... + c3 2^2 + c2 2^1 + c1 2^0 
```

现在，为了`n`在上述等式中找到（或数字的二进制表示中的位数），我们可以假设它将是`floor(log2(N)) + 1`。例如，考虑任何数字，假设`118`它可以用 floor(log2(118)) + 1 = 7 位表示。

```
n = floor(log2(118)) + 1; 
```

上式只有`O(1)`. 现在，我们需要找出一个数字的二进制表示中有多少个 1。考虑一个伪代码来完成这项工作：

```
function count1(int N) {
    int c = 0;
    int N' = N;

    while(N' > 0) {
       N' -= 2^(floor(log2(N')));
       c++;
    }
} 
```

上面的伪代码是`O(logN)`. 我在 MATLAB 中编写了小脚本来测试我上面的伪代码，结果如下。

```
count1(6)   = 2
count1(3)   = 2
count1(118) = 5 
```

完美，现在我们有了这些位的位数和 1 的数量。现在，可以应用简单的组合和排列来找到数字的秩。首先让我们假设，`n`是表示数字所需的位数，并且`c`是数字的位表示中的 1 的数量。因此，排名将由以下方式给出：

```
r = n ! / c ! * (n - c) ! 
```

编辑：正如 DSM 所建议的，我已经更正了逻辑以找到正确的 RANK。想法是从排列中删除所有不需要的数字。所以添加了这段代码：

```
for i = N + 1 : 2^n - 1
    if count(i) == c
       r = r - 1;
    end
end 
```

我编写了一个 MATLAb 脚本来使用上述方法查找数字的等级：

```
function r = rankN(N)

n = floor(log2(N)) + 1;
c = count(N);
r = factorial(n) / (factorial(c) * factorial(n - c));
% rejecting all the numbers may have included in the permutations 
% but are unnecessary.
for i = N + 1 : 2^n - 1
    if count(i) == c
       r = r - 1;
    end
end

function c = count(n)

c = 0;
N = n;
while N > 0
    N = N - 2^(floor(log2(N)));
    c = c + 1;
end 
```

上面的算法是`O(1) + O(logN) + O(1) = O(logN)`。输出是：

```
>> rankN(3)

ans =

     1

>> rankN(4)

ans =

     3

>> rankN(7)

ans =

     1

>> rankN(118)

ans =

    18

>> rankN(6)

ans =

     3 
```

注意：排名`0`始终是`1`因为上述方法将失败，`0`因为`log2(0)`未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:39:13.177

这是一个相当高效的 O(logN) 实现，每一步并行执行多个加法：

```
unsigned int countBits( unsigned int bits )
{
    bits = ( bits & 0x55555555 ) + ( ( bits >> 1 ) & 0x55555555 );
    bits = ( bits & 0x33333333 ) + ( ( bits >> 2 ) & 0x33333333 );
    bits = ( bits + ( bits >>  4 ) ) & 0x0f0f0f0f;
    bits += bits >>  8;
    return ( bits + ( bits >> 16 ) ) & 63;
} 
```

它从 16 个 2 位加法开始，然后进行 8 个 4 位加法，依此类推。通过使用更长的掩码和一个额外的步骤，它可以扩展为使用 64 位整数：

```
unsigned int countBits( unsigned long long bits )
{
    bits = ( bits & 0x5555555555555555L ) + ( ( bits >> 1 ) & 0x5555555555555555LL );
    bits = ( bits & 0x3333333333333333L ) + ( ( bits >> 2 ) & 0x3333333333333333LL );
    bits = ( bits + ( bits >>  4 ) ) & 0x0f0f0f0f0f0f0f0fLL;
    bits += bits >>  8;
    bits += bits >> 16;
    return (unsigned int) ( bits + ( bits >> 32 ) ) & 127;
} 
```

# c# - context.Response.Flush() 在 IE8 上不起作用，但在 IE9 上正常工作

> ID：12252513
> 
> 赞同：1
> 
> 时间：2012-09-03T18:20:57.073
> 
> 标签：c#, asp.net, internet-explorer-8, internet-explorer-9, httphandler

我有一个简单的 HTTP 处理程序，它允许我们的用户检索远程存储的 PDF 文件。令人惊讶的是，当从 IE9 调用处理程序但 IE8 卡住时，此代码运行良好。您必须再次调用 url 才能正确显示 pdf。

我在网上查了一下，看看是否有进一步的反应。我最初认为响应没有正确结束，但发现以下文章：http: [//blogs.msdn.com/b/aspnetue/archive/2010/05/25/response-end-response-close-and-how -customer-feedback-helps-us-improve-msdn-documentation.aspx](http://blogs.msdn.com/b/aspnetue/archive/2010/05/25/response-end-response-close-and-how-customer-feedback-helps-us-improve-msdn-documentation.aspx) 显然，不应使用 context.Response.Close() 或 context.Response.End()。

我正在使用的代码：

```
using System.Web;

namespace WebFront.Documents
{
    public class PDFDownloader : IHttpHandler
    {

        public void ProcessRequest(HttpContext context)
        {
            // Makes sure the page does not get cached
            context.Response.Cache.SetCacheability(HttpCacheability.NoCache);

            // Retrieves the PDF
            byte[] PDFContent = BL.PDFGenerator.GetPDF(context.Request.QueryString["DocNumber"]);

            // Send it back to the client
            context.Response.ContentType = "application/pdf";
            context.Response.BinaryWrite(PDFContent);
            context.Response.Flush();
        }

        public bool IsReusable
        {
            get
            {
                return false;
            }
        }
    }
} 
```

有没有人遇到过同样类型的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:42:34.810

在设置内容类型之前清除标题就可以了：

```
public void ProcessRequest(HttpContext context)
{
    // Makes sure the page does not get cached
    context.Response.Cache.SetCacheability(HttpCacheability.NoCache);

    // Retrieves the PDF
    byte[] PDFContent = BL.PDFGenerator.GetPDF(context.Request.QueryString["DocNumber"]);

    // Send it back to the client
    context.Response.ClearHeaders();
    context.Response.ContentType = "application/pdf";
    context.Response.BinaryWrite(PDFContent);
    context.Response.Flush();
    context.Response.End();
} 
```

无论如何感谢@nunespascal 让我走上正轨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:24:52.753

调用一个`Response.End`。

这将结束您的响应，并告诉浏览器已收到所有内容。

```
public void ProcessRequest(HttpContext context)
        {
            // Makes sure the page does not get cached
            context.Response.Cache.SetCacheability(HttpCacheability.NoCache);

            // Retrieves the PDF
            byte[] PDFContent = BL.PDFGenerator.GetPDF(context.Request.QueryString["DocNumber"]);

            // Send it back to the client
            context.Response.ContentType = "application/pdf";
            context.Response.BinaryWrite(PDFContent);
            context.Response.Flush();
            context.Response.End();
        } 
```

# sql-server - 无法使用 VB.NET 表单中的存储过程将日期插入 SQL

> ID：12252522
> 
> 赞同：0
> 
> 时间：2012-09-03T18:21:33.580
> 
> 标签：sql-server, date, stored-procedures

我尝试从文本字段将日期插入 SQL 服务器。我已经尝试过转换它，但我总是收到同样的错误：

> 存储过程 'XYZ' 需要参数 ... 未提供。

在将日期值传递给 SQL Server 之前，我将其转换为日期：

```
upis.parameters.AddWithValue("@datum_start", DateValue(Datum_start.text)) 
```

我使用 Profiler 捕获了 SQL 事件，我看到该表单传递了值：

```
exec sp_executesql N'_osoba_zivotopis_test',N'@guid_kandidata nvarchar(36),@datum_start nvarchar(10),@datum_kraj nvarchar(10),@vodece int,@trenutno int',@guid_kandidata=N'24C40512-7292-403D-8C08-EEEA2C81EC7D',@datum_start=N'15.02.2012',@datum_kraj=N'01.10.2012',@vodece=0,@trenutno=0 
```

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T18:37:39.860

谢谢Sankaras，但问题在另一边。

在编写了 305 行代码后，我错过了在我的 VB.NET 代码隐藏文件中的存储过程定义中添加代码 `upis.CommandType = CommandType.StoredProcedure`

当我定义`CommandType`一切正常。

.NET 知道将日期值传递给 SQL 日期数据。即使我在本地代码环境中以我的形式收集它，.NET 也知道如何传递它，而 SQL 知道如何在没有它的情况下处理它`convert(date,<varchar/nvarchar>,110)`

我在 10 分钟后看到它，但我不得不等待 8 小时才能发布答案......

感谢你们。

# c++ - 似乎我没有正确传递对象的指针，但为什么呢？

> ID：12252524
> 
> 赞同：0
> 
> 时间：2012-09-03T18:21:37.220
> 
> 标签：c++, oop, pointers

我正在使用对象的指针，并能够使用它们的内存地址来传递和检索信息。

我的程序只通过了书名，没有其他信息，我不知道为什么。

如何使该程序正确存储和检索信息？我正在使用指针来传递值，我应该更改主函数以外的内容吗？

这是我的 main.cpp 文件：

```
#include <iostream>
#include <string>
using namespace std;

#include "Book.h"

int main()
{
    system("cls");

    Author *pAuthor = new Author("John", "Doe");
    Publisher *pPublisher = new Publisher("Wrox", "10475 Crosspoint Blvd.", "Indianapolis");
    Book *pBook = new Book("Memory Management", pAuthor, pPublisher, 39.99);

    cout << pBook->getBookInfo() << endl;

    system("pause");

    return 0;
}; 
```

book.cpp 文件：

```
#include <iostream>
#include <sstream>
using namespace std;

#include "Book.h"

Book::Book()
{
}

Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    this->title = title;
    this->price = price;
}

Book::~Book()
{
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:25:12.020

您将 pAuther 和 pPublisher 传递给 Book 构造函数，但没有对它们做任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:26:34.983

```
Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    this->title = title;
    this->price = price;
} 
```

在这里，您正在传递指针但不使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:25:43.273

您的 book() 构造函数需要使用来自 pAuthor 和 pPublisher 的数据调用 setAuthorName 和 setPublisher 函数。

# android - Android 绘制相机预览

> ID：12252530
> 
> 赞同：11
> 
> 时间：2012-09-03T18:22:08.453
> 
> 标签：android, android-camera, glsurfaceview

我正在制作一个虚拟现实应用程序，相机应该检测面部，定位它们并在相机预览中显示它们的位置。

我知道 3 种方法可以做到这一点，我想尽可能快地使用 GLSurfaceView（[根据这篇文章](https://stackoverflow.com/a/5010734/176269)），但目前我正在尝试在相机用于预览的*同一个SurfaceView 上绘图。*我的回调是`onFaceDetection`这样的：

```
public class MyActivity extends Activity implements SurfaceHolder.Callback, Camera.FaceDetectionListener {
    Camera camera;
    SurfaceView svPreview;
    SurfaceHolder previewHolder;
    TextView tvInfo;
    Paint red;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        svPreview = (SurfaceView) findViewById(R.id.svPreview);
        tvInfo = (TextView) findViewById(R.id.tvInfo);

        red = new Paint();
        red.setStyle(Paint.Style.STROKE);
        red.setStrokeWidth(3);

        previewHolder = svPreview.getHolder();
        previewHolder.addCallback(this);
        previewHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    public void surfaceCreated(SurfaceHolder arg0) {
        camera = Camera.open();
        try {
            camera.setDisplayOrientation(90);
            camera.setFaceDetectionListener(this);
            camera.setPreviewDisplay(previewHolder);
        }
        catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        // . . .
        camera.startPreview();
        camera.autoFocus(null);
        camera.startFaceDetection();
    }

    public void surfaceDestroyed(SurfaceHolder arg0) {
        camera.stopFaceDetection();
        camera.cancelAutoFocus();
        camera.stopPreview();
        camera.release();
        camera = null;
    }

    public void onFaceDetection(Face[] faces, Camera camera) {  
        tvInfo.setText("Faces: " + String.valueOf(faces.length));

        Canvas canvas = previewHolder.lockCanvas();
        for(int i=0; i < faces.length; i++) {
            Point leftEye = faces[i].leftEye;
            Point rightEye = faces[i].rightEye;
            // this is not working
            canvas.drawPoint(leftEye.x, leftEye.y, red);
        }
        previewHolder.unlockCanvasAndPost(canvas);
    }
} 
```

使用此代码，我不断收到此错误：

```
09-03 19:35:42.743: E/SurfaceHolder(19394): Exception locking surface
09-03 19:35:42.743: E/SurfaceHolder(19394): java.lang.IllegalArgumentException
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.view.Surface.lockCanvasNative(Native Method)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.view.Surface.lockCanvas(Surface.java:76)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.view.SurfaceView$4.internalLockCanvas(SurfaceView.java:744)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.view.SurfaceView$4.lockCanvas(SurfaceView.java:720)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at com.bluetooth.activities.MyActivity.onFaceDetection(MyActivity.java:90)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.hardware.Camera$EventHandler.handleMessage(Camera.java:729)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.os.Looper.loop(Looper.java:137)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at android.app.ActivityThread.main(ActivityThread.java:4424)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at java.lang.reflect.Method.invokeNative(Native Method)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at java.lang.reflect.Method.invoke(Method.java:511)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-03 19:35:42.743: E/SurfaceHolder(19394):     at dalvik.system.NativeStart.main(Native Method)
09-03 19:35:42.743: W/dalvikvm(19394): threadid=1: thread exiting with uncaught exception (group=0x40a561f8)
09-03 19:35:42.766: E/AndroidRuntime(19394): FATAL EXCEPTION: main
09-03 19:35:42.766: E/AndroidRuntime(19394): java.lang.IllegalArgumentException
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.view.Surface.unlockCanvasAndPost(Native Method)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.view.SurfaceView$4.unlockCanvasAndPost(SurfaceView.java:775)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at com.bluetooth.activities.MyActivity.onFaceDetection(MyActivity.java:99)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.hardware.Camera$EventHandler.handleMessage(Camera.java:729)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.os.Looper.loop(Looper.java:137)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at android.app.ActivityThread.main(ActivityThread.java:4424)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at java.lang.reflect.Method.invokeNative(Native Method)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at java.lang.reflect.Method.invoke(Method.java:511)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-03 19:35:42.766: E/AndroidRuntime(19394):    at dalvik.system.NativeStart.main(Native Method) 
```

相机尝试在同一个 SurfaceView 上绘制其预览的人脸检测回调是否存在问题？如何在不分层 SurfaceView 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-24T12:38:52.030

您无法锁定并在`SurfaceView`which has `Type.PUSH_BUFFERS`, （您要向其显示帧的那个）上绘图。您必须在 Z 方向上在原始视图上方创建另一个视图并在其中`SurfaceView`绘制`View`。

因此，在您`main.xml`的原始视图下方创建一个自定义视图`FrameLayout`。

`SurfaceView`在您的活动视图中创建和处理一个。将此视图添加到相机预览显示。通过`SurfaceHolder`. 在此视图中，您可以锁定并在画布上绘图。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-26T17:23:10.350

正如詹姆斯指出的那样，您需要创建扩展 SurfaceView 的自定义表面（我通常也实现 SurfaceHolder.Callback）：

`public class CameraSurfacePreview extends SurfaceView implements SurfaceHolder.Callback`

构造函数将类似于：

```
public CameraSurfacePreview(Context context) {
     super(context);
     ...
     mHolder = getHolder();
     mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
     ... 
```

您需要在相机打开调用后将相机与您的表面绑定（如果您实现实现 SurfaceHolder.Callback 将其放在覆盖的surfaceCreated中的某个位置）：

```
mCamera = Camera.open();
mCamera.setPreviewDisplay(mHolder); 
```

最后，您需要在活动内容视图中的某处添加自定义表面的实例：

```
CameraSurfacePreview cameraSurfacePreview = new CameraSurfacePreview(this);
//camera surface preview is first child!
((ViewGroup)findViewById(R.id.cameraLayout)).addView(cameraSurfacePreview, 0); 
```

在我的活动布局示例中，类似于（我在主框架布局中显示相机预览）：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android" 
              android:layout_width="fill_parent"        
                      android:layout_height="fill_parent" 
              android:layout_gravity="top|left"
              android:id="@+id/cameraLayout"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T03:25:52.447

我可以说，

这与线程无关。

也不是因为这条线出错。

```
canvas.drawPoint(leftEye.x, leftEye.y, red); 
```

这是因为画布仍在使用而无法锁定

如果你仔细检查，你会看到你得到的这个画布是 == null

```
canvas = canvasHolder.lockCanvas();
    if (canvas == null)  Log.i("Error", "Canvas == null!"); 
```

您可能会有疑问，那么它已经在哪里使用了？

它已经用于显示以显示您正在发生的事情！那是

```
camera.setPreviewDisplay(previewHolder); 
```

所以，我建议，如果你想在你的眼睛上画点，你可能需要在你的 SurfaceView 上有另一个 SurfaceView / SurfaceHolder 用于预览相机：]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T15:49:12.490

lockcanvas/unlockcanvasandpost 方法在使用 openGL 时不合适，因为 openGL 代码正在控制和锁定表面。如果您想使用标准的 2d API，请不要使用 OpenGL。

# ios - CJSONDeserializer IOS 出错

> ID：12252532
> 
> 赞同：2
> 
> 时间：2012-09-03T18:22:13.190
> 
> 标签：ios, xcode, json

我是 XCode 和 iOS 的新手。我想`BD`在远程 Web 服务上创建一个。我的问题是这个错误：

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_CJSONDeserializer", referenced from:
      objc-class-ref in ViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我有一个目标，包含带有 viewController.h 和 .m 的项目组以及带有 JSON 库的其他组。也许，我必须配置一些东西。我不知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:16:40.383

It's very similar:

1.  Select the project in the project navigator.
2.  Select the Target in the detail view.
3.  Select the Build Phase tab.
4.  Expand the Compiled Sources section
5.  Add the file **CJSONDeserializer.m** if it is not present there.

This will hopefully solve your problem

# java - 从休眠乐观锁定异常中恢复

> ID：12252535
> 
> 赞同：3
> 
> 时间：2012-09-03T18:22:35.660
> 
> 标签：java, spring, hibernate, optimistic-locking

我有这样的方法：

```
@Transactional(propagation = Propagation.REQUIRES_NEW)
public void doSomeWork(){
 Entity = entity = dao.loadEntity();
 // do some related work
 ...
 try {
  dao.saveEntity(entity);
 }
 catch(StaleObjectStateException sose){
  dao.flush(entity);
  doSomeWork();
 }
} 
```

我期待通过使用 REQUIRES_NEW 事务传播和显示的递归，StaleObjectStateException 最终会清除，但事实并非如此。

我如何从这个异常中恢复？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T19:29:54.930

原来有一点我忽略的“嘎查”......

来自春季文档

> 在代理模式（默认）下，只有通过代理传入的“外部”方法调用会被拦截。这意味着“自调用”，即目标对象中的方法调用目标对象的其他方法，即使调用的方法标有@Transactional，在运行时也不会导致实际事务！

因为我一直在内部递归，所以没有应用事务分界。

解决方案是通过代理递归，像这样......

```
@Autowired
private ApplicationContext applicationContext;

@Transactional(propagation = Propagation.REQUIRES_NEW)
public void doSomeWork(){
 Entity = entity = dao.loadEntity();
 // do some related work
 ...
 try {
  dao.saveEntity(entity);
 }
 catch(StaleObjectStateException sose){
  dao.flush(entity);
  applicationContext.getBean(this.getClass()).doSomeWork();
 }
} 
```

# c++ - C++ 奇怪的编译器语法错误

> ID：12252536
> 
> 赞同：2
> 
> 时间：2012-09-03T18:22:36.563
> 
> 标签：c++, syntax-error

我得到了以下代码（不要争论它是否有意义，这只是一个最小的例子）：

```
struct X{
    template <typename T>
    T foo(){ return T(); }
};

template <typename T>
struct Z{
    virtual X bar(){
        bar().foo<int>();
        return X();
    }
}; 
```

它不能在我的 g++4.6.3 上编译。该行`bar().foo<int>();`给出以下错误：

```
error: expected primary-expression before ‘int’
error: expected ‘;’ before ‘int’ 
```

当我第一次将 bar() 的结果保存在局部变量中时，它会起作用，即如果我替换`bar().foo<int>()`为

```
 X x = bar();
        x.foo<int>(); 
```

然后它工作。如果我现在声明局部变量`auto`而不是`X`，即：

```
 auto x = bar();
        x.foo<int>(); 
```

然后我收到与以前相同的错误。如果我从类 Z 中删除类型参数（即，使其成为普通类而不是模板类），那么它会再次起作用。

如果我使用类类型`X`而不是`int`foo 的类型参数 ie `foo<X>`，那么我会收到以下错误：

```
expected primary-expression before ‘&gt;’ token
expected primary-expression before ‘)’ token 
```

我真的无法在这里发现错误。请帮忙！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T18:26:06.800

您需要确定所讨论的类型是可模板化的（这是我认为是 GCC 中的错误的解决方法，请参见下面的编辑），即

```
struct X{
    template <typename T>
    T foo(){ return T(); }
};

template <typename T>
struct Z{
    virtual X bar(){
        bar().template foo<int>();
        return X();
    }
}; 
```

基本问题与解析有关，因为可以通过多种方式解析显式模板实例化。有趣的位（我认为）位于 14.2p4，如下所示：

> 当成员模板特化的名称出现在后缀表达式之后或之后，或者在 qualified-id 中的 `.`嵌套名称*说明**符之后，并且后缀**表达式*或 *嵌套*名称说明符的对象或指针表达式出现在*qualified-id*依赖于模板参数 (14.6.2) 但不引用当前实例化的成员 (14.6.2.1)，成员模板名称必须以关键字 为前缀。否则，该名称被假定为命名非模板。`->`*****`template`*****

 ***如果我没记错的话，`Z<T>::bar` *它确实*依赖于模板参数，但同时它确实引用了当前的实例化，因此我倾向于相信该标准不需要像 GCC 那样的资格。当多个编译器的结果相互冲突时，我倾向于支持 Comeau，在这种情况下，它表示`template`qualifier 是*不必要*的。***

# jquery - 使 jquery fullcalendar 打印机友好？

> ID：12252537
> 
> 赞同：7
> 
> 时间：2012-09-03T18:22:36.657
> 
> 标签：jquery, fullcalendar

我希望能够打印出我的 jquery fullcalendar 以及事件；但是，它很难阅读，而且背景颜色显然没有出来。有没有办法让它以更清晰的方式打印，可能使用更大胆的颜色、纯色背景或小时标记中没有贯穿线？

**更新：** 在“议程周”格式（特别需要什么）中，它看起来非常糟糕——事件似乎跨越了一天以上——即使日历（有点）适合页面。这意味着星期三及以后的事件可以说是“超出图表”......

[**样品打印视图**](http://img31.imageshack.us/img31/8441/databasew.jpg)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T18:31:07.973

[检查您从http://arshaw.com/fullcalendar/download/](http://arshaw.com/fullcalendar/download/)下载的 .zip 文件。 它包括一个打印机友好的 css 以及如何使用它的说明。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-13T03:03:43.303

最新的 fullcalendar (3.0) 应该允许您现在打印完整的事件之间的间距。无需使用 fullcalendar.print.css 文件。

# python - django 从服务器导入本地设置

> ID：12252540
> 
> 赞同：0
> 
> 时间：2012-09-03T18:23:22.227
> 
> 标签：python, django

在我的主目录中，我有一个名为`local`. 在其中，有名为`__init__.py`和的文件`local_settings.py`。我的 django 应用程序位于完全不同的目录中。当应用程序未**在**调试模式下运行时，我希望它加载`local_settings.py`文件。如何实现？我阅读了以下内容：

[从相对路径导入模块](https://stackoverflow.com/questions/279237/python-import-a-module-from-a-folder)

[从 Python 中的不同文件夹导入文件](https://stackoverflow.com/questions/4383571/importing-files-from-different-folder-in-python)

[http://docs.python.org/tutorial/modules.html](http://docs.python.org/tutorial/modules.html)

基本上，这些教程允许从另一个目录导入，但是完全不同的工作树呢？我不想继续做 .., .., .. 等。有没有办法转到主目录？

我尝试了以下代码：

```
import os, sys
os.chdir(os.path.join(os.getenv("HOME"), 'local'))
from local_settings import * 
```

但是我一直在我的 apache error.log 中看到错误...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:02:57.913

为了解决您对源代码控制的担忧，您可以将源代码控制设置为忽略该文件，和/或安装一个符号链接作为部署脚本的一部分，以将操作系统上的文件链接到另一个文件。我两者都做，虽然不在 django 中。但这是一项微不足道的任务。

您的部署布局可能如下所示：

```
/current ( symlink to /releases/v3 )
/settings/local_settings.py
/releases/v1
/releases/v2
/releases/v3 
```

并且任务作为部署的一部分运行：

```
cd /current 
ln -s /settings/local_settings.py local_settings.py 
```

如果您使用 fab 或 capistrano 进行部署，则只需几行配置。我相信你也可以用 puppet/chef 做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:48:44.683

`os.chdir`只会影响当前工作目录，这与 Python 从何处导入模块无关。

您需要做的是将`local`目录添加到 Pythonpath。您可以通过修改从 shell 执行此操作，也可以通过修改`PYTHONPATH`从 Python 内部执行此操作`sys.path`：

```
import sys
import os
sys.path.append(os.path.expanduser("~/local"))
import local_settings 
```

# javascript - 如何使用 Canvas 制作 3D 动画

> ID：12252545
> 
> 赞同：0
> 
> 时间：2012-09-03T18:24:33.820
> 
> 标签：javascript, canvas, html5-canvas, three.js

我有 Canvas 2D 上下文的背景，但我想执行像[这样](http://peterned.home.xs4all.nl/3d/)的 3D 动画，Three.js 库是执行此类动画的最佳选择吗？您能否指出一些有用的教程或文档可能会有所帮助。提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:27:40.117

这是最常见的选择之一。

由于 WebGL 无需库即可启用 OpenGL，因此您也可以仅使用[Vanilla JS](http://vanilla-js.com/)来实现，但这会更难，因为 WebGL 并没有提供比原始 OpenGL 更多的改进。

除了 three.js，你也可以尝试[GLGE](http://www.glge.org/)或[PhiloGL](http://www.senchalabs.org/philogl/)，但由于[Three.js](https://github.com/mrdoob/three.js/)是最受欢迎的，如果你没有特定要求，我建议你去尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:40:07.770

看起来您链接到的演示使用了一个名为 Clay.js 的画布库。到目前为止，我还没有亲自听说过。对于画布中的 3d，我所知道的最流行的就是 Three.js，正如你已经提到的。它还具有支持 webGL 的好处（基于浏览器的 openGL 变体）。

Three.js 有有限的[文档](http://mrdoob.github.com/three.js/docs/50/)和[一些](http://stemkoski.github.com/Three.js/) [示例](http://yomotsu.github.com/threejs-examples/)，但除了一些您可能会购买的书籍之外，没有太多的手把手。您基本上需要潜入并开始编码。以下是一些可以帮助您入门的在线资源（不一定都专注于 THREE.js）：

[http://aerotwist.com/tutorials/getting-started-with-three-js/](http://aerotwist.com/tutorials/getting-started-with-three-js/)

[http://learningthreejs.com/](http://learningthreejs.com/)

[http://learningwebgl.com/blog/](http://learningwebgl.com/blog/)

为了更轻松地使用 THREE.js，Jérôme Etienne 创建了一个名为[tQuery](http://jeromeetienne.github.com/tquery/)的项目，您可以认为它有点像 jQuery。一个让你更容易弄脏手的包装纸。这是一个[视频](http://vimeo.com/43336826)，他展示了如何在 10 分钟内创建一个 webGL 游戏。

# c# - 数据网格视图内的组合框项目选择的事件引发

> ID：12252547
> 
> 赞同：0
> 
> 时间：2012-09-03T18:24:44.967
> 
> 标签：c#, events, datagridview

我有一个 datagridcombobox 列，如何引发组合框项目选择事件？

我搜索并尝试了以下代码：

```
// Program.cs  
this.datagrdADDTEMP.SelectionChanged+=new System.EventHandler(datagrdADDTEMP_SelectionChanged);` 

// Form.cs
void datagrdADDTEMP_SelectionChanged(object sender, SelectedGridItemChangedEventArgs e) 
```

我收到以下错误：

```
no overloaded method for 'datagrdADDTEMP_SelectionChanged' matches delegate System.EventHandler' 
```

请帮助我，我是这个事件冒泡概念的新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:33:40.107

你可以试试这个签名

```
private void ComboBox_SelectedIndexChanged(object sender, 
        System.EventArgs e)
{
    .....

} 
```

链接：http: [//msdn.microsoft.com/en-us/library/microsoft.clradmin.datagridcombobox_events%28v=vs.90%29](http://msdn.microsoft.com/en-us/library/microsoft.clradmin.datagridcombobox_events%28v=vs.90%29)

# c# - 自己生成顺序指南

> ID：12252551
> 
> 赞同：1
> 
> 时间：2012-09-03T18:25:13.860
> 
> 标签：c#, ravendb

> **可能重复：**
> [顺序 Guid 生成器 C#](https://stackoverflow.com/questions/1752004/sequential-guid-generator-c-sharp)

我得到了*可能*存储在 raven 中的文件。我想为它们生成一个顺序 GUID（我在 RavenDB.net 上看到 raven 使用它们）。

是否有我可以用来生成 id 的 ravendb API？

***请注意，问题是 RavenDB 特定的***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T09:30:57.643

下面的代码显示了 RavenDB 如何在服务器上为 eTags 实现这一点，您可以在[此处](https://github.com/mattwarren/ravendb/blob/master/Raven.Database/DocumentDatabase.cs#L408)的上下文中看到它。另一段代码在[这里](https://github.com/mattwarren/ravendb/blob/master/Raven.Database/Extensions/GuidExtensions.cs)

```
public Guid CreateSequentialUuid()
{
    var ticksAsBytes = BitConverter.GetBytes(currentEtagBase);
    Array.Reverse(ticksAsBytes);
    var increment = Interlocked.Increment(ref sequentialUuidCounter);
    var currentAsBytes = BitConverter.GetBytes(increment);
    Array.Reverse(currentAsBytes);
    var bytes = new byte[16];
    Array.Copy(ticksAsBytes, 0, bytes, 0, ticksAsBytes.Length);
    Array.Copy(currentAsBytes, 0, bytes, 8, currentAsBytes.Length);
    return bytes.TransfromToGuidWithProperSorting();
} 
```

我认为这不能通过 API 访问，因为它是一个内部细节，但您可以自己实现类似的东西。基本上它依赖于拥有一个全局计数器（`currentEtagBase`和`sequentialUuidCounter`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:28:18.713

通常，如果您使用 GUID 值，则不必担心它们是*连续*的。

[`Guid.NewGuid`](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)将为您提供可以直接使用的独特值。

如果您确实需要顺序值，可以使用接受整数类型的[Guid 构造函数，并构建顺序递增的值。](http://msdn.microsoft.com/en-us/library/ms131157.aspx)然而，这将是非常不寻常的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:30:37.003

这不是通常的要求：根据定义，创建一个*序列* 是唯一的（尽可能），并且一些数学的、*可预测*的序列的存在将在其唯一性支持中引入额外的问题。`GUID``GUID`

 *但是，顺便说一句，像往常一样，*总是有人已经在考虑这个问题*。

似乎这个链接上的那个人有同样的问题：

[生成顺序 GUID](http://developmenttips.blogspot.it/2008/03/generate-sequential-guids-for-sql.html)

注意：提供的代码是针对 的`C# 2005`，但至少在这个问题上没有太大变化。

**编辑**

根据文档，关于顺序 GUID 生成：

> 支持数字或 Guid Id 属性并将无缝工作。在这种情况下，RavenDB 会自动将内部字符串 ID 转换为实体中显示的数字或 Guid 值并返回。
> 
> 使用这种方法，ID 在对象上调用 Store 后立即可用 - RavenDB 会话将在内存中设置一个唯一的 ID，而无需从服务器询问

这意味着即使它是由“服务器”生成的，它也存储在内存中，所以请求它几乎不会花费任何成本，**如果**这是你的谨慎...*

# ruby-on-rails - 简单的 Ajax 效果在 Rails 3 中不起作用

> ID：12252558
> 
> 赞同：0
> 
> 时间：2012-09-03T18:25:39.257
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, jquery, ruby-on-rails-3.2

我想使用 Ajax 进行简单的删除，但这不起作用，我想要让 JQuery 淡出，但这不起作用，我删除并且 tr 不会消失。

我的 application.js 是

```
$('.delete_post').bind('ajax:success', function() {  
$(this).closest("tr").fadeOut();  
}); 
```

我的人员控制器是

```
 def destroy
    @person = Person.find(params[:id])
    @person.destroy

    respond_to do |format|
      format.html { redirect_to people_url }
      format.js   { render :nothing => true }  
    end
  end 
```

我的观点 index.html.erb

```
 <tr>
    <td><%= person.name %></td>
    <td><%= person.birth %></td>
    <td><%= person.email %></td>
    <td><%= link_to 'Show', person %></td>
    <td><%= link_to 'Edit', edit_person_path(person) %></td>
    <td><%= link_to 'Destroy', person ,method: :delete, data: { confirm: 'Are you sure?' },:remote=> true, :class =>'delete_post'  %></td>
  </tr> 
```

我正在学习 Ajax，但这不起作用，删除发生但 ajax 不起作用我在视图中包含此标签

```
<%= javascript_include_tag :defaults %> 
```

但什么都不改变

日志是：

```
Started DELETE "/people/20" for 127.0.0.1 at 2012-09-03 15:23:45 -0300
Processing by PeopleController#destroy as JS
  Parameters: {"id"=>"20"}
  [1m[35mPerson Load (0.0ms)[0m  SELECT `people`.* FROM `people` WHERE `people`.`id` = ? LIMIT 1  [["id", "20"]]
  [1m[36mSQL (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.0ms)[0m  DELETE FROM `people` WHERE `people`.`id` = ?  [["id", 20]]
  [1m[36m (46.9ms)[0m  [1mCOMMIT[0m
  Rendered text template (0.0ms)
Completed 200 OK in 94ms (Views: 46.9ms | ActiveRecord: 46.9ms) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:05:50.140

问题是您的事件处理程序未附加到`document`处理`ajax:success`回调的对象。根据您的日志跟踪，您将获得 200 响应代码，并且该记录正在被删除。

在您的应用程序中尝试以下 JavaScript 代码：

```
$(document).on('ajax:success', '.delete_post', function(e) {
    $(e.currentTarget).closest('tr').fadeOut();
}); 
```

（参考：[https](https://stackoverflow.com/a/12221358/441611) ://stackoverflow.com/a/12221358/441611 ）

# javascript - Html 5 x 5 矩阵，如 controlin 文本框

> ID：12252560
> 
> 赞同：0
> 
> 时间：2012-09-03T18:25:50.247
> 
> 标签：javascript, jquery, asp.net-mvc-3, razor

我想在网格中创建一个简单的 html 表，其值介于 1 到 25 之间，并以矩阵/网格方式排序。我希望该网格以像 jquery ui 日期时间控件这样的方式显示。

```
@for(int i =0;i<5;i++){ for(int j=0;j<5;j++){
<input type="button" id="foo">
if(j==4){
<br/>

}

} 
```

然后使用上面的代码作为编辑器模板并将其附加到文本框。

非常感谢任何帮助指针。

问候

比拉尔

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:57:42.603

像这样的东西：？（手写 - 未经测试）

模型：

```
public class MyModel
{
    [UIHint("MyCustomEditorTemplateType")]
    public int MyField { get; set; }
} 
```

看法：

```
@model MyModel
@Html.EditorFor(m => m.MyField) 
```

编辑器模板：

```
@model string

@Html.TextBoxFor(m => m, new { @class = "forpopupcontrol" })
<div id="@(string.Format("{0}_container", Html.IdFor(m => m)))" style="display:none">
    @* code build table here *@
</div> 
```

JS：

```
<script>
    $(function()
    {
        $('.forpopupcontrol').focus(function()
        {
            $('#' + $(this).attr('id') + '_Container').show();
        }).blur(function()
        {                
            $('#' + $(this).attr('id') + '_Container').hide();
        });
    }        
</script> 
```

# php - Drupal 7自定义块未显示在阻止列表中

> ID：12252561
> 
> 赞同：0
> 
> 时间：2012-09-03T18:25:57.300
> 
> 标签：php, drupal-7, block

这里是 Drupal 7 新手，有以下问题。

***我已启用我的块及其依赖项，但未显示在块列表中***

谁能发现我的代码中可能遗漏的任何内容？

任何帮助我指出正确方向的帮助将不胜感激！

提前致谢！

代码如下。

*.info 文件*

```
name = Bloque para el buscador - INMO
description = Bloque para mostrar el buscador geográfico de InmoAnuncios.
package = Modulos de Inmo Anuncios  
core = 7.x

scripts[] = bloque_buscador.js // exist in folder

dependencies[] = inmo_node_form // enabled 
```

*.module 文件*

```
<?php

/**
 * @file 
 * Modulo para el buscador de inmuebles
 * 
 * Este modulo provee de un bloque donde se despliega un buscador de inmuebles en el sitio
 */

/**
 * Implementa el hook_block_info() 
 * Este hook le dice a DRUPAL que este bloque se puede desplegar tanto en el home page como en el sidebar
 */
function bloque_buscador_block_info() {

    $blocks = array();

    $blocks['bloque_home'] = array(
        'info' => t('Inmo Buscador (home)'),
        'cache' => DRUPAL_NO_CACHE,
    );

    $blocks['bloque_sidebar'] = array(
        'info' => t('Inmo Buscador (sidebar)'),
        'cache' => DRUPAL_NO_CACHE,
    );

    return $blocks;
}

/**
 * 
 * @param type $delta
 * @return type
 * Implementa el hook_block_view()
 * 
 * 
 */
function bloque_buscador_block_view($delta = '') {

    $estados = db_query("SELECT * FROM estados WHERE enabled = 1;");
    $inmuebles = db_query("SELECT * FROM tipo_inmueble WHERE enabled = 1;");

    $optEstados = '';

    foreach ($estados as $estado) {
        $optEstados .= "<option value=\"{$estado->id}\">{$estado->nombre}</option>\n";
    }

    $optInmuebles = '<option value=\"0\">--Todos--</option>';

    foreach ($inmuebles as $inmueble) {
        $optInmuebles.= "<option value=\"{$inmueble->tipo_inmueble}\">{$inmueble->tipo_inmueble}</option>\n";
    }

    $contenido = <<<EOSTR
      <div class="jsrequired {$delta}" id="bloque_buscador">
        <header class="title">
          <h2>Encuentra tu inmueble ideal!</h2>
        </header>
        <div class="filtros">

          <form action="/filtro" method="GET">
            <table  border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td><label for="operacion">Busco inmuebles en:</label></td>
                    <td>
                        <label class="vc">Venta <input type="radio" name="operacion" id="operacion" value="venta"/></label>
                        <label class="vc">Renta <input type="radio" name="operacion" id="operacion" value="renta" /></label> 
                    </td>
                </tr>
                <tr>
                    <td><label for="tipo_inmueble">Tipo de inmueble?</label></td>
                    <td><select name="inmueble" id="inmueble" style="width:150px;"> $optInmuebles </select></td>
                </tr>
                <tr>
                    <td><label for="estado">En donde?</label></td>
                    <td><select name="estado" id="estado" style="width:150px;"> $optEstados </select></td>
                </tr>
                <tr>
                    <td colspan="2"><input type="submit" value="Buscar"></td>
                </tr>
          </table>
            </form>
        </div>
        <div class="mapa"><a href="#" class="mapa_buscador"></a></div>

      </div>
EOSTR;

    $bloque = array(
    "subject" => NULL,
    "content" => $contenido
  );
  return $bloque;
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:59:16.557

您`bloque_buscador_block_view`应该指定要返回的块显示，如文档中的示例所示[`hook_block_view`](http://api.drupal.org/api/drupal/modules!block!block.api.php/function/hook_block_view/7)

所以你应该有类似的东西：

```
 switch ($delta) {
    case 'bloque_home':
      $block['subject'] = NULL;
      $block['content'] = $contenido;
      break;

    case 'bloque_sidebar':
      // Insert appropriate code/logic here to display the sidebar block
      break;
  }
  return $block; 
```

# python - 使用三元运算符的返回语句

> ID：12252564
> 
> 赞同：34
> 
> 时间：2012-09-03T18:26:20.543
> 
> 标签：python, ternary-operator

在`c`我可以做类似的事情：

```
int minn(int n, int m){
 return (n<m)? n:m
} 
```

但是在python中我无法实现相同的目标：

```
def minn(n,m):
    return n if n<m else return m 
```

这给了`Syntax Error`

我知道我可以做类似的事情：

```
def minn(n,m):
    return min(n,m) 
```

我的问题是，我不能在 python 中使用三元运算符。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-09-03T18:27:26.170

您的 C 代码不包含两个`return`语句。你的python代码也不应该......你的三元表达式的翻译是`n if n<m else m`，所以当你返回值时只使用那个表达式：

```
def minn(n,m):
    return n if n<m else m 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-03T18:30:08.113

```
def minn(n,m):
    return n if n<m else m 
```

`expr1 if expr2 else expr3`表达式是表达式，而不是语句。`return`是一个陈述（见[这个](https://stackoverflow.com/questions/4728073/python-what-is-the-difference-between-an-expression-and-a-statement)问题）

因为表达式不能包含语句，所以您的代码会失败。

# javascript - 从我自己的脚本中包含的 Javascript 文件调用函数

> ID：12252566
> 
> 赞同：0
> 
> 时间：2012-09-03T18:26:36.680
> 
> 标签：javascript, jquery, function

我有一个我没有编写的脚本已经在页面上运行。我想，在我编写的脚本*中*，能够从原始脚本执行一个函数。这是我正在尝试做的一个简化示例：

```
(function ($) {
$.fn.myExistingFunction = function (options) {
    function doMyThing(text) {
        alert(text);
    }
}
}(jQuery));

jQuery(document).ready(function($) {
    $.fn.myExistingFunction.doMyThing("alert text");
}); 
```

但是，当我运行它时，我得到控制台输出：

```
Uncaught TypeError: Object function (options) {

    function doMyThing(text) {
       alert(text);
    }

} has no method 'doMyThing' 
```

但它显然有方法！我可以在那里看到它。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:29:38.477

您只能从插件函数的[范围内访问该方法。](http://en.wikipedia.org/wiki/Scope_(computer_science))它没有在全局范围内定义。

所以你不能调用那个函数。您在代码中所能做的就是调用函数，这些函数可通过调用函数的所谓[作用域链](https://stackoverflow.com/questions/1484143/scope-chain-in-javascript)获得。在您的情况下，这是在您的 function($){} 或全局范围内定义的所有内容。但插件中的功能两者都不是。

当您打电话时，`$.fn.myExistingFunction.doMyThing`您将 doMyThing 视为`myExistingFunction`对象中的一个字段。但实际上它是在函数内部定义的。也许这段代码更清楚：

```
$.fn.myExistingFunction = function (options) {
    var doMyThing = function(text) {
        alert(text);
    }
    var hi = "hello";
} 
```

在 hi 和 doMyThing 中是 myExistingFunction 范围内的局部变量。如果插件的设计目的不是将功能公开给外部代码，则您无法访问变量。

一个旨在公开其内部功能的插件示例是[jQuery UI 日期选择器](https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js)（[文档](http://docs.jquery.com/UI/Datepicker)）。它需要像 parseDate 和 formatDate 这样的函数，但是这些实用函数可能对一般开发也很有用，这就是为什么它们被显式地添加到 datepicker 对象中的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:30:25.287

我认为您的代码需要进行重大重写，因为它永远不会工作，实际上您**不是**`function doMyThing`的属性，它只是在其中声明，并且由于范围在 javascript 中的工作方式，您永远不会能够调用它。**`$.fn.myExistingFunction`**

# c# - 调试后台任务

> ID：12252567
> 
> 赞同：7
> 
> 时间：2012-09-03T18:26:47.617
> 
> 标签：c#, windows-runtime, live-tile

**在我看来，我的后台任务没有工作/触发。有什么方法可以调试它们，或者通过集成测试对其进行测试。**

这是一个示例后台任务：

```
 public sealed class MyBackgroundTask : IBackgroundTask
{
 private ITileService _tileService;

 //Tried a parameter-less constructor in case IoC doesn't work
 public MyBackgroundTask() : this(new TileService)  {}

 public MyBackgroundTask(ITileService tileService)
 {
     _tileService = tileservice;
 }

        public async void Run(IBackgroundTaskInstance taskInstance)
        {
            Debug.WriteLine("MyBackgroundTask is running " + taskInstance.Task.Name );
            taskInstance.Canceled += TaskInstanceOnCanceled;
            if (!_cancelRequest && SomeOtherCondition)
            {
                var deferral = taskInstance.GetDeferral(); 
                await _tileService.UpdateLiveTile(null);
                deferral.Complete();
            }
        }
} 
```

后台任务注册：（此代码运行，用调试器检查）

```
 var backgroundTaskBuilder = new BackgroundTaskBuilder
                                                {
                                                    TaskEntryPoint =
                                                        "MyNamespace.MyBackgroundTask",
                                                    Name = "MyBackgroundTask"
                                                };

                backgroundTaskBuilder.SetTrigger(new MaintenanceTrigger(15, false));
                backgroundTaskBuilder.AddCondition(new SystemCondition(SystemConditionType.InternetAvailable));
                backgroundTaskBuilder.Register(); 
```

在应用程序清单中，我定义了一个新`BackgroundTask`的 a`System Event`和以下入口点：`MyNamespace.MyBackgroundTask`

注意：后台任务与app在不同的程序集中（后端/前端分离）

# vba - 用户表单中的可滚动图像

> ID：12252569
> 
> 赞同：3
> 
> 时间：2012-09-03T18:26:57.243
> 
> 标签：vba, excel, ms-word

我有一个带有一堆 ActiveX 控件按钮或其他任何东西的 word doc，每次单击按钮时，都需要在弹出框中显示相应的图像。

我有一个名为 ImageForm 的用户表单，这就是我现在正在做的事情：

```
Sub Button_Clicked()
    ImageForm.Picture = LoadPicture("appropriate_image_path")
    ImageForm.Show
End Sub 
```

这些图像中的每一个都有 8.5 英寸的宽度，但它们的高度可以在 3 到 20 英寸之间变化（它们是 pdf 的片段）。因此，我将用户窗体的宽度设置为略大于 8.5 英寸，看起来还不错。但我需要能够垂直滚动用户表单中的图像，因为某些图像可能比用户的显示器高。

我完全坚持这一点。到目前为止，我尝试的是在表单中添加一个框架，然后在表单内添加一个图像控件，并将框架的“ScrollBars”属性设置为垂直。然后我不使用“ImageForm.Picture = ...”，而是使用“ImageForm.ImageControl.Picture = ...”但它不起作用。

这里的任何见解将不胜感激。希望这个问题足够清楚，我现在才使用 VBA 一个月左右。（我非常想念Java）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:49:26.207

这是基于我的[一篇文章的一个巧妙的小技巧](http://www.vbforums.com/showthread.php?511916-VBA-Working-with-Scroll-Bars-The-most-simplest-way)

这个想法是确保图像控件在框架控件中并且图像控件没有边框。图像控件`PictureSizeMode`也设置为，`fmPictureSizeModeClip`以便我们可以滚动图像

**快照（设计时间）**

![在此处输入图像描述](../Images/230d46bf56e2db8eee5aab56d2977076.png)

**快照（运行时间）**

![在此处输入图像描述](../Images/23339116a720204b7e559c6b57ea8865.png)

**代码**

```
Private Sub UserForm_Initialize()
    With Frame1
        '~~> This will create a vertical scrollbar
        .ScrollBars = fmScrollBarsVertical

        '~~> Change the values of 2 as Per your requirements
        .ScrollHeight = .InsideHeight * 2
        .ScrollWidth = .InsideWidth * 9
    End With

    With Image1
        .Picture = LoadPicture("C:\Users\Public\Pictures\Sample Pictures\Desert.jpg")
        .BorderStyle = fmBorderStyleNone
        .PictureSizeMode = fmPictureSizeModeClip
    End With
End Sub 
```

# c++ - C++ - 使用模板公开返回 const 引用和私下返回非 const 引用

> ID：12252571
> 
> 赞同：1
> 
> 时间：2012-09-03T18:27:14.433
> 
> 标签：c++, templates, private-members, readonly

问题：我怎样才能使一个 const 引用公开返回，一个非 const 引用私下返回？

我正在尝试为我的类中的某些变量创建一个只读模板。这涉及一个模板类，它在公共时返回对数据的 const 引用。但是在课堂上我需要对数据进行操作，所以我试图私下返回一个不是 const 的引用。这是基础知识：

```
private: operator T&() { return data; }
public: operator const T&() const { return data; } 
```

当我添加如上所示的非常量引用时，如果我尝试公开访问变量，我的 Visual Studio 2010 cl.exe 编译器告诉我它无法访问类中的私有成员。像`cout << myobj.x << endl`使用模板声明 x 这样简单的事情将会失败。

```
error C2248: 'proxy<T,C>::operator int &' : cannot access private member declared in class 'proxy<T,C>' 
```

这是另一个可供参考的线程：
[C++ - 如何在 Visual Studio 2010 中制作只读类成员变量 - 代码日志](https://stackoverflow.com/questions/12239229/c-how-to-make-read-only-class-member-variables-in-visual-studio-2010)

编辑：您要求提供代码，所以在这里。

```
template <class T, class C>
class proxy {
    friend C;
private:
    T data;
    T operator=(const T& arg) { data = arg; return data; }
    operator T&() { return data; } // I'd expect this is only returned privately
public:
    operator const T&() const { return data; }
};

class myClass {
public:
    proxy<int,myClass> x;

    void f(int i) {
        x = i;
    }
};

int main(int argc, char **argv)
{
    myClass test;
    test.f(12);
    cout << test.x << endl; // Compiler error trying to access non-const T&
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:18:30.033

实际上，*可见性*和可访问性在 C++ 中是独立的*：*

*   *可见性*规则说在解决重载时会考虑**所有**成员函数。
*   *可访问性*意味着如果所选的重载函数不能从使用的上下文（例如，来自类外部的私有成员）访问，则会发生编译器错误。

有些人认为如果从类外部调用函数，私有成员将不会参与重载决议，但事实并非如此。所有功能，无论访问权限如何，都被考虑在内。

关于您的具体问题，您可以：

```
std::cout << test.x; 
```

这里`test`是非常量，所以也是`test.x`，并且在两个重载转换函数中，选择非常量的一个。但是，唉，这个函数是私有的，因此编译器错误。

快速的解决方案是做一个`const_cast`：

```
std::cout << const_cast<const myClass&>(test).x; 
```

或者，如果您愿意：

```
const myClass &ctest = test;
std::cout << ctest.x; 
```

正确的解决方案是删除非常量私有的。您不需要它，因为从类上下文中您可以`data`直接使用该成员。

坦率地说，您似乎正在尝试使用其他语言的语法在 C++ 中实现属性。属性很好，但这不是 C++ 的方式。

我的建议是：不要与语言抗争，按原样接受语法，只做括号的事情。或者，如果`x`不持有不变量，则将其公开。

最短的方法是这样的：

```
class myClass {
private:
    int _x;
public:
    int x() const {
        return _x;
    }
    //if needed
    void x(int value) {
        _x = value;
    }
}; 
```

将来阅读您的代码的人（请注意，可能是我！）将非常感谢您不尝试重新发明语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:19:10.500

在 C++ 中，访问检查是在重载决议之后完成的。与另一种可能性相比，这既有优点也有缺点——从候选集中删除不可访问的函数。

通常解决方案是为私有函数使用不同的名称。但您似乎正在尝试符合您所熟悉的某些功能所需的特定界面。我不认为有一个简单的解决方法。私有继承在一般情况下无济于事，因为继承的函数不是候选集的一部分，它们被派生类中的函数隐藏。但是转换函数是继承的……经过测试，原来的问题似乎又出现了（甚至发现了私有基类中的私有转换）。

所以我最后建议使用命名函数而不是转换，如：

```
template <typename T, typename C>
class proxy
{
    friend C;
private:
    T data;
    T operator=(const T& arg) { data = arg; return data; }
    T& mutate() { return data; }
public:
    operator const T&() const { return data; }
};

class myClass
{
public:
    proxy<int,myClass> x;

    void f(int i)
    {
        x.mutate() = i;
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:47:51.207

`test`is not const, `test.x`is not const, 所以`myClass::operator int()`更好的匹配是`myClass::operator int() const`.

访问控制（私人/公共）不参与其中。

# python - Python：减少列表但保留细节

> ID：12252577
> 
> 赞同：2
> 
> 时间：2012-09-03T18:27:26.763
> 
> 标签：python, list, reduce

假设我有一个项目列表，其中一些项目在一定程度上相似，但在一个点后相差一个数字

```
['abc.1',
 'abc.2',
 'abc.3',
 'abc.7',
 'xyz.1',
 'xyz.3',
 'xyz.11',
 'ghj.1',
 'thj.1'] 
```

我想从这个列表中产生一个新列表，它折叠倍数但保留它们的一些数据，即数字后缀，所以上面的列表应该产生一个新列表

```
[('abc',('1','2','3','7'))
 ('xyz',('1','3','11'))
 ('ghj',('1'))
 ('thj',('1'))] 
```

我的想法是，第一个列表可以通过点分成对，然后我如何按第一部分对对进行分组而不丢失第二部分

很抱歉，如果这个问题是noobish，并提前感谢

...哇，我没想到这么快就有这么多很棒的答案，谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:32:09.850

```
from collections import defaultdict

d = defaultdict(list)

for el in elements:
    key, nr = el.split(".")
    d[key].append(nr)

#revert dict to list
newlist = d.items() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:39:43.543

使用分隔函数映射列表，使用`itertools.groupby`带有第一个元素的键，并将第二个元素收集到结果中。

```
from itertools import groupby, imap

list1 = ["abc.1", "abc.2", "abc.3", "abc.7", "xyz.1", "xyz.3", "xyz.11", "ghj.1", "thj.1"]

def break_up(s):
    a, b = s.split(".")
    return a, int(b)

def prefix(broken_up): return broken_up[0]
def suffix(broken_up): return broken_up[1]

result = []
for key, sub in groupby(imap(break_up, list1), prefix):
    result.append((key, tuple(imap(suffix, sub))))

print result 
```

输出：

```
[('abc', (1, 2, 3, 7)), ('xyz', (1, 3, 11)), ('ghj', (1,)), ('thj', (1,))] 
```

# model-view-controller - Servlet 到 jsp 通信的最佳实践

> ID：12252579
> 
> 赞同：4
> 
> 时间：2012-09-03T18:27:53.407
> 
> 标签：model-view-controller, jsp, servlets

我正在学习如何在谷歌应用引擎上编写 java servlet 和 jsp 页面。我正在尝试使用 MVC 模型，但我不确定我是否做得对。目前，我有一个在访问页面时调用的 servlet。servlet 完成所有处理并创建一个 HomePageViewModel 对象，该对象被转发到 jsp，如下所示：

```
// Do processing here
// ...
HomePageViewModel viewModel = new HomePageViewModel();
req.setAttribute("viewModel", viewModel);

//Servlet JSP communication
RequestDispatcher reqDispatcher = getServletConfig().getServletContext().getRequestDispatcher("/jsp/home.jsp");
reqDispatcher.forward(req, resp); 
```

在 jsp 方面，我有这样的事情：

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="viewmodels.HomePageViewModel" %>
<%
  HomePageViewModel viewModel = (HomePageViewModel) request.getAttribute("viewModel");
  pageContext.setAttribute("viewModel", viewModel);
%>

<html>
  <body>
  <% out.println(((HomePageViewModel)pageContext.getAttribute("viewModel")).Test); %>
  </body>
</html> 
```

所以我的问题是两个方面。首先，对于小型 Web 应用来说，这是一种合理的处理方式吗？这只是我正在上课的一个小项目。其次，在 jsp 文件中，有没有更好的方法来访问 viewmodel 数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T18:50:51.220

如果您遵守[Javabeans 规范](http://www.oracle.com/technetwork/java/javase/documentation/spec-136004.html)（即使用公共 getter/setter 的私有属性），

```
public class HomePageViewModel {

    private String test;

    public String getTest() { 
        return test;
    }

    public void setTest(String test) {
        this.test = test;
    }

} 
```

那么您可以只使用 EL（表达式语言）来访问数据。

```
<%@ page pageEncoding="UTF-8" %>
<html>
  <body>
  ${viewModel.test}
  </body>
</html> 
```

### 也可以看看：

*   [我们的 Servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)
*   [我们的 JSP 维基页面](https://stackoverflow.com/tags/jsp/info)
*   [我们的 EL 维基页面](https://stackoverflow.com/tags/el/info)
*   [如何避免 JSP 文件中的 Java 代码？](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files)

# css - 使用 IE（所有版本）时，CSS 下拉菜单不会显示在正确区域

> ID：12252585
> 
> 赞同：0
> 
> 时间：2012-09-03T18:28:36.120
> 
> 标签：css, drop-down-menu

我在我正在开发的网站中实现了一个 CSS 下拉菜单。它可以在除 IE 之外的任何浏览器中完美运行。

在 IE 中，下拉菜单将出现在页面的完全不同的区域，使得在悬停消失之前无法单击链接。我在下面包含了我的`.css`和`.html`（将导航结构更改为基本的）文件中的代码。此导航通过 PHP 包含放置到我的网站布局中，因此我的导航栏显示的区域居中，距离主页顶部 230 像素。

当我使用`DOCTYPE`严格模式时，它会按预期工作，但是我还有其他无法更改的问题，所以我宁愿不使用 a `DOCTYPE`（否则我将被迫重新编码整个网站）

我确信必须有某种解决方法...即使它在 IE 中的显示不完全相同，我只需要它可以使用！

任何帮助是极大的赞赏！！我花了好几个星期试图解决这个头痛...

**CSS文件：**

```
#catnav {
    padding: 0;
    clear: both;
    height: 32px;
    width: 980px;
    background: #000;
    position: absolute;
    top: 230px;
    z-index: 100;
}

#nav {
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
    z-index: 100;
}

#nav ul {
    margin: 0;
    padding: 0;
}

#nav li {
    float: left;
    margin: 0;
    padding: 0;
    list-style: none;
    position: relative;
}

#nav a {
    display: block;
    line-height: 32px;
    margin: 0 0px;
    padding: 0;
    font-size: 12px;
    color: #fff;
    font-weight: bold;
}

#nav li a:hover {
    color: #fff;
    text-decoration: underline;
    display: block; 

}

#nav li ul {
    list-style: none;
    position: absolute;
    width: 0px;
    left: -999em;
}

#nav li:hover ul, #nav li.sfhover ul {
left: auto;
}

#nav li li {
    float: left;
    margin: 0;
    padding: 0;
    width: 120px;
}

#nav li li a {
    width: 129px;
    height: 24px;
    line-height: 24px;
    color: #000;
    border-bottom: 1px solid #000;
    background: #c5c5c5;
    margin: 0;
    padding: 5px 20px 5px 15px;
}

#nav li li a:hover {
    border-top: 1px solid #131f27;
    background: #8f7c58;
    padding: 5px 20px 5px 15px;
}

#nav li:hover, #nav li.sfhover { /* prevents IE7 drop-down menu bug (focus on a page element prevents nested menus from disappearing) */
    position: static;
} 
```

**文件：**

```
<script type="text/javascript"><!--//--><![CDATA[//><!--
    sfHover = function() {
        if (!document.getElementsByTagName) return false;
        var sfEls = document.getElementById("nav").getElementsByTagName("li");

        for (var i=0; i<sfEls.length; i++) {
            sfEls[i].onmouseover=function() {
                this.className+=" sfhover";
            }
            sfEls[i].onmouseout=function() {
            this.className=this.className.replace(new RegExp(" sfhover\\b"), "");
        }
    }    
}
if (window.attachEvent) window.attachEvent("onload", sfHover);
//--><!]]></script>

<link rel="stylesheet" href="css.css">

<div id="catnav">
    <div id="nav">    
        <ul>  
            <li><a href="#" title="Title 1">Title Link 1</a></li>
        </ul>
            <li><a href="#" title="Title Link 2"></a>
        <ul>  
            <li><a href="#" title="Title">Title Link2 </a></li>  
        </ul>  
        </li>  
            <li><a href="#" title="Title 3">Title Link 3</a>
        <ul>  
            <li><a href="#" title="Sub Link 1">Sub Link 1</a></li>  
        </ul>  
            </li>  
            <li><a href="#" title="Title 4">Title 4</a>
        <ul>  
            <li><a href="#" title="Title">Sub Link 1</a></li>  
        </ul>           
        </li>  
            <li><a href="#" title="Title 5">Title Link 5</a></li>  
            <li><a href="#" title="Title 6 ">Title Link 6</a></li>  
            <li><a href="#" title="Title 7">Title Link 7</a></li>  
        </ul>  
    </div>
</div> 
```

我怎样才能使 IE 至少将这些下拉菜单显示在其标题下方而不是`230px`下方和右侧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:29:38.333

听起来像是一个盒子模型问题，有很多线程和问题与 IE 如何在页面上呈现元素的实现有关。我简单地使用了您的代码片段并更改了以下 CSS 部分：

```
#nav li:hover ul, #nav li.sfhover ul {
    left: auto;
    _margin-top: -230px;
    _margin-left: -72px;
} 
```

仍然存在子链接未直接显示在父链接下的问题，我没有更多时间回复您的问题，但这应该给您一个起点。

这是2009 年[的类似问题](https://stackoverflow.com/questions/1907365/css-hover-breaks-page-layout-in-ie-why)，回复中进行了很好的讨论。

# dll - 奇怪的钩子行为 32/64 位

> ID：12252586
> 
> 赞同：0
> 
> 时间：2012-09-03T18:28:39.673
> 
> 标签：dll, hook, c++builder, 32bit-64bit, setwindowshookex

我正在使用`(WH_KEYBOARD)`带有 ms word (OpusApp) 的本地挂钩。好吧，据我所知，一个 32 位应用程序`32bit DLL`必须只能与`32bit target applications`. 奇怪的是该程序仅适用于 64 位应用程序！！！就是这样，只有`64bits APPS`！例如，`it works with IE 64 but not with IE 32!` 该应用程序`dll`是 32bit 编译的`radstudio XE2`，我将版本确认为 PE 标头。在 32 位操作系统中，应用程序和 dll 不起作用。

我在网上没有找到解决方案，也没有找到解决这个奇怪问题的起点。

DLL 代码：

```
// Exported functions

extern "C" __declspec(dllexport)bool __stdcall InstallMouseHook(unsigned long, void *);

extern "C" __declspec(dllexport)bool __stdcall RemoveMouseHook();

// Callback Procedure Declaration

LRESULT CALLBACK HookProc(int code, WPARAM wParam, LPARAM lParam);

// Global variables

HHOOK HookHandle;
HINSTANCE DllInstance;
typedef void (__stdcall *CALLIT)(int,WPARAM,LPARAM);
CALLIT callIt = NULL;

int WINAPI DllEntryPoint(HINSTANCE hinst, unsigned long reason, void*)
{
  DllInstance=hinst;
  return 1;
}

bool __stdcall InstallMouseHook(unsigned long pid, void *function)
{

     callIt = ( CALLIT ) function;

     if (function == NULL) {

        ShowMessage("function is null!");

     } else if (callIt == NULL) {

        ShowMessage("callIt is null!");

     }  

     HookHandle=SetWindowsHookEx(WH_KEYBOARD ,reinterpret_cast<HOOKPROC> (HookProc),DllInstance,pid);

    if (HookHandle==NULL)return false;

    else return true;

}

bool __stdcall  RemoveMouseHook()
{
  if(UnhookWindowsHookEx(HookHandle)==0)
  {
    return false;
  }
  else return true;
}

LRESULT CALLBACK HookProc(int code, WPARAM wParam, LPARAM lParam)
{
    if (code<0) {
        return CallNextHookEx(HookHandle,code,wParam,lParam);
    }

    if (callIt != NULL) {
        callIt(code,wParam,lParam);
    } else {
        ShowMessage("HookProc - no function to execute OR 32/64 bits problem!");
    }

  //Call the next hook in the chain
  return CallNextHookEx(HookHandle,code,wParam,lParam);
} 
```

EXE调用代码：

```
void __fastcall TfrmMouseHook::btnHookAppDllClick(TObject *Sender)
{
    HWND hWindow;
    unsigned long pid;

    String s = "MouseHookDLL.dll";
    DllHandle=LoadLibrary(s.w_str());
    MOUSEHOOKFCT_2 InstHook=reinterpret_cast<MOUSEHOOKFCT_2> (GetProcAddress(DllHandle,"InstallMouseHook"));

    hWindow = FindWindow(ComboBox1->Text.w_str(),NULL);

    if (!hWindow) {
        msg("hWindow fail");
        return;
    }

    pid = GetWindowThreadProcessId(hWindow ,0);
    if (!pid) {
       msg("pid fail");
       return;
    }

    if(!InstHook(pid, (void *) callIt )) {
        msg("Unable to install  hook!");
    } else {
        msg(" #### hook INSTALLED! ####");
    }

}

CALLIT callIt(code,wParam,lParam) {
    frmMouseHook->msg("hook callit: code="+IntToStr(code) +" wparam="+IntToStr(wParam)+" lparam="+IntToStr(lParam) );
}

   Call IT is a function pointer to a hooker app function.

    Any ideas will be very wellcome! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T22:51:57.653

32 位应用程序在物理上不可能安装 32 位挂钩 DLL 并让它在 64 位进程中执行。32 位 DLL 根本无法注入 64 位进程。时期。MSDN 在多个地方都这样说，包括在[SetWindowsHookEx() 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990.aspx)中：

> SetWindowsHookEx 可用于将 DLL 注入另一个进程。32位DLL不能注入64位进程，64位DLL不能注入32位进程。如果应用程序需要在其他进程中使用钩子，则需要 32 位应用程序调用 SetWindowsHookEx 将 32 位 DLL 注入 32 位进程，64 位应用程序调用 SetWindowsHookEx 将 64 位DLL 转换为 64 位进程。32 位和 64 位 DLL 必须具有不同的名称。
> 
> **因为钩子在应用程序的上下文中运行，所以它们必须与应用程序的“位数”相匹配。如果 32 位应用程序在 64 位 Windows 上安装全局挂钩，则 32 位挂钩将被注入每个 32 位进程（通常的安全边界适用）。在 64 位进程中，线程仍被标记为“已挂钩”。但是，由于 32 位应用程序必须运行钩子代码，系统会在钩子应用程序的上下文中执行钩子；具体来说，在调用 SetWindowsHookEx 的线程上。这意味着挂钩应用程序必须继续发送消息，否则可能会阻止 64 位进程的正常运行。**
> 
> 如果 64 位应用程序在 64 位 Windows 上安装全局挂钩，则 64 位挂钩将注入到每个 64 位进程中，而所有 32 位进程都使用对挂钩应用程序的回调。

您说您的应用程序和 DLL 不能在 32 位操作系统版本上运行这一事实表明您的挂钩代码一开始就有缺陷。但是您没有显示足够的代码来以一种或另一种方式诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-18T19:16:35.793

发生什么了？除了MSDN或其他人说的，XE6有一些bug，在较新版本的IDE中编译DLL会使这种行为消失，实际上，新的DLL崩溃并没有钩子。

正如 Remy 所指出的，通过测试，我向 DLL 传递了一个函数指针，这是一件错误的事情，但是当添加了 Embarcadero 所做的错误事情时，它就可以正常工作了。

到现在为止，我知道人们会生气，我将这两种方法（错误和正确的钩子）都放在同一个 DLL 和我的应用程序中，然后......变得疯狂......可以只使用 32 位和 64 位应用程序一个DLL。

不相信？安装 XE6 并尝试！

并且适用于 Windows 10 以及 Windows 7。

# awk - awk 多个匹配模式

> ID：12252587
> 
> 赞同：4
> 
> 时间：2012-09-03T18:28:58.363
> 
> 标签：awk

awk 似乎匹配匹配表达式的所有模式并执行相应的操作。是否有可以关联的优先级？

例如。在下面，以#（注释）开头的行被两种模式匹配，并且两个动作都被执行。我希望注释行仅匹配第一个操作。

```
/^#.*/  {
    // Action for lines starting with '#'
}

{
    // Action for other lines
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T18:30:32.410

如果你想保留你已经拥有的大部分代码，你可以使用`awk` [下](http://www.staff.science.uu.nl/~oostr102/docs/nawk/nawk_77.html)一条语句。一旦遇到该`next`语句，`awk`就跳过处理当前记录并转到下一行。

因此，如果您将`next`第一个块放入底部，则不会执行第二个块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T19:04:28.820

为什么不简单地`if,else`：

```
awk '{ if ($0 ~ /^#/) 
           // Action for lines starting with '#'
       else
           // Action for other lines
      }' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T00:07:37.353

如果您的匹配选项是二进制的，您的另一个选择是使用模式否定运算符'！'，用于“其他所有”行：

```
/^#.*/ {
  // Action for lines starting with '#'
}

!/^#.*/ {
  // Action for other lines
} 
```

当然，您的第二个模式也可以简单地匹配不以哈希开头的所有内容，即 /^[^#].*/

但大概，你的例子是一个简化。对于复杂的正则表达式，制作精确的反向匹配可能是不可能的。否定运算符只是使其明确且万无一失。

而且，您可能已经知道，“.*”部分是不必要的。

# silverlight - 我可以绑定到 Silverlight 中的祖先 DataTemplate 吗？

> ID：12252590
> 
> 赞同：0
> 
> 时间：2012-09-03T18:29:18.900
> 
> 标签：silverlight, xaml, binding, datatemplate

我无法完成我认为在 Silverlight 5 中有效的绑定：

```
<Controls:GraphLayout>
  <Controls:GraphLayout.VertexTemplate>
    <DataTemplate>
      <TextBox ... />
    </DataTemplate>
  </Controls:GraphLayout.VertexTemplate>
  <Controls:GraphLayout.SubgraphTemplate>
    <DataTemplate>
      <Controls:GraphLayout VertexTemplate="{Binding VertexTemplate, RelativeSource={RelativeSource AncestorType=Controls:GraphLayout}}"/>
    </DataTemplate>
  </Controls:GraphLayout.SubgraphTemplate>
</Controls:GraphLayout> 
```

这是一个简化的示例，但希望它非常易读。过度我试图将 SubgraphTemplate 的 VertexTemplate 绑定到包含控件（根 GraphLayout 控件）的 VertexTemplate 。不幸的是，在后面的代码中，我可以看到子图控件中的 VertexTemplate 为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T07:18:30.053

可能是您的代码*可以*工作（这很奇怪，您绑定到**没有**的东西，`x:Key`我认为您应该使用`{StaticResource SomethingWithName}`））。

但实际上您要寻找的是[DataTemplateSelector](http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx)。它非常易于使用并且实际上支持您描述的逻辑。

# web-services - 如何创建 ejb-jar 文件以部署在 Glass Fish 服务器 v3 中

> ID：12252592
> 
> 赞同：1
> 
> 时间：2012-09-03T18:29:32.310
> 
> 标签：web-services, deployment, glassfish, ejb, maven-ear-plugin

我想知道如何部署 EJB 应用程序？这也有带有 jax-ws 的 Web 服务...我阅读了这个链接[http://java.sun.com/developer/onlineTraining/Beans/EJBTutorial/step5.html#Create%20the%20ejb-jar%20file](http://java.sun.com/developer/onlineTraining/Beans/EJBTutorial/step5.html#Create%20the%20ejb-jar%20file)但使用 weblogic到生成的部署描述符...如何生成Glass Fish的部署描述符？...如何生成ejb-jar文件？...非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:58:25.210

这是非常好的文章，如何逐步创建企业应用程序（如 Web 服务）。
使用：Eclipce IDE、Java EE 6、GlassFish AS。
[文章](http://programming.manessinger.com/tutorials/an-eclipse-glassfish-java-ee-6-tutorial/)

这是 GLassFish AS
[Oracle DOC的重新部署描述符](http://docs.oracle.com/cd/E18930_01/html/821-2417/giida.html)

我建议您将`maven`其用于您的项目。`Maven`可以产生你需要的一切

```
@see maven-jar-plugin  
@see maven-ear-plugin 
```

# mysql - mysql - 多个字符串的所有实例的计数

> ID：12252595
> 
> 赞同：0
> 
> 时间：2012-09-03T18:29:46.803
> 
> 标签：mysql, where-in

例如，假设有一张扎染 T 恤表……有些衬衫有多种颜色，以字符串形式列出，以逗号分隔。比如`blue,yellow,red,purple`或`green,white,black,red`。

我想做一个查询来计算每种颜色出现的次数。我**会**事先知道列中将存在哪些“颜色”。

我现在正在做的是对每种“颜色”的单独查询：

```
SELECT count(color) WHERE color LIKE '%blue%'
SELECT count(color) WHERE color LIKE '%red%'
SELECT count(color) WHERE color LIKE '%yellow%' 
```

ETC.....

**有没有比 15 个不同的查询更有效的方法呢？**

示例：如果我的表要具有“”列“颜色”的值`blue, red, yellow`，而另一行将是颜色 =“ `red, green, yellow`”等...

我正在寻找将返回的查询：

```
Blue    Red   Yellow  Green
  1      2      2       1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:34:34.027

假设您的断言`I will know beforehand which 'colors' will exist in the column`，您正在寻找的是：

```
SELECT
    SUM(color like '%blue%') as total_blue,
    SUM(color like '%red%') as total_red,
    (...)
    SUM(color like '%yellow%') as total_yellow
FROM
    your_table; 
```

这`SUM(any boolean condition you want)`是一个非常好记住的技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:55:13.723

假设您的颜色字​​典表是 COLORS

```
Select colors.name, count(*) from colors
Join yourtable t on Instr(t.color,colors.name)>0
Group by colors.name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T18:32:48.547

像这样的东西可能是您正在寻找的东西：

```
SELECT
  color.name,
  COUNT(1)
FROM
  foo
LEFT JOIN
  color ON foo.color_id = color.id
GROUP BY
  color.id 
```

如果您能给出某种关于您的数据外观的方案，那将会有所帮助。然而，这是这种情况下的基本解决方案。

如果您只是将颜色作为字符串，那就更简单了：

```
SELECT
  color,
  COUNT(1)
FROM
  foo
GROUP BY
  color 
```

# tsql - 是否可以使用过滤索引作为提示来优化 SELECT COUNT(*) 查询以实现恒定速度？

> ID：12252597
> 
> 赞同：2
> 
> 时间：2012-09-03T18:29:55.340
> 
> 标签：tsql, query-optimization, indexing, sql-server-2012, filtered-index

我想计算所有不紧急且订单状态 = 1（已发货）的订单。

这应该是一个非常简单的优化查询。我想在 Orders 表上放置一个简单的过滤索引来覆盖这个查询，使其成为一个恒定的时间/O(1) 操作。但是，当我查看查询计划时，它似乎使用了没有意义的索引扫描。理想情况下，此查询应该只返回索引中的项目数。

该表如下所示（简化为本质）：

```
CREATE TABLE [dbo].[Orders](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [IsUrgent] [bit] NOT NULL,
    [Status] [tinyint] NOT NULL
 CONSTRAINT [PK_Orders] PRIMARY KEY CLUSTERED ( [Id] ASC ) 
```

我创建了这个过滤索引：

```
CREATE INDEX IX_Orders_ShippedNonUrgent ON Orders(Id) WHERE IsUrgent = 0 AND Status = 1; 
```

现在，当我执行此查询时：

```
SELECT COUNT(*) FROM Orders WHERE IsUrgent = 0 AND Status = 1 
```

我看到查询计划正在使用 IX_Orders_ShippedNonUrgent，但它正在执行索引扫描并在约 150,000 行订单中执行大约 200 次读取。

假设过滤的索引保持最新，是否可以始终让此查询在恒定时间内运行？理想情况下，它应该只执行 1 次读取来获取索引的大小。

如果我切换到这样的非过滤索引：

```
CREATE INDEX IX_Orders_IsUrgentStatus ON Orders(IsUrgent, Status); 
```

查询计划使用 Index Seek，但仍然执行比回答这个简单查询所需的更多的读取。

**更新**

我能够做到这一点

```
SELECT TOP 1 rows FROM sys.partitions p
INNER JOIN sys.indexes i
ON i.name = 'IX_Orders_ShippedNonUrgent'
AND i.object_id = p.object_id
AND i.index_id = p.index_id 
```

并在 9 次读取中获得结果，但似乎应该有一种更简单、更简单的方式来使用简单的 COUNT(*) 查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:44:34.233

我想要的似乎是不可能的。[Nikola Markovinović](https://stackoverflow.com/users/1231866/nikola-markovinovic)在评论中留下了最好的答案，即忘记过滤索引并改用索引视图：

```
CREATE VIEW [dbo].vw_Orders_TotalShippedNonUrgent WITH SCHEMABINDING 
AS 
SELECT COUNT_BIG(*) AS TotalOrders 
  FROM dbo.Orders WHERE IsUrgent = 0 AND Status = 1; 
```

和

```
CREATE UNIQUE CLUSTERED INDEX IX_vw_Orders_TotalShippedNonUrgent ON vw_Orders_TotalShippedNonUrgent(TotalOrders); 
```

这会强制为我想要的每个摘要统计信息创建视图及其索引，并重写查询以询问视图而不是简单的方法，但它在只有 2 次读取时速度很快。

我会把这个问题留一段时间，以防有人有一个同样快的更简单的方法。

# visual-studio-2012 - VS2012 和性能分析器有什么问题？

> ID：12252599
> 
> 赞同：12
> 
> 时间：2012-09-03T18:30:08.097
> 
> 标签：visual-studio-2012

我正在尝试做一些性能。分析一段很慢的代码...我以管理员身份启动 VS2012 Premium，加载我的解决方案并转到“分析 - 启动性能向导”立即我看到一个对话框，上面写着：

```
Could not load file or assembly 'VSPerfReader.DLL' or one of its dependencies. 
```

惊人的！该文件位于此处：

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Team Tools\Performance Tools 
```

顺便说一句，我可以从“开始”启动 Windows 性能分析器（独立）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-19T23:47:16.707

有同样的问题，将以下行添加到我的系统路径变量并重新启动 Visual Studio 就可以了。

> C:\Program Files (x86)\Microsoft Visual Studio 11.0\Team Tools\Performance Tools

在解决方案的评论中感谢 Ade Miller。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-01T17:02:35.563

与上述 Ryan Taylor 相同的说明，但带有视觉效果。我的问题是 Visual Studio 2013（安装 VS2015 SP1 之后）。我输入新路径变量的值如下。

```
C:\Program Files (x86)\Microsoft Visual Studio 12.0\Team Tools\Performance Tools 
```

[![VS2013 路径修复](../Images/e3415cf370e6a5068eb2c9db0257c009.png)](https://i.stack.imgur.com/UEtMq.png)

# javascript - 如何检查 DOM 节点是否继承自构造函数？

> ID：12252600
> 
> 赞同：4
> 
> 时间：2012-09-03T18:30:18.893
> 
> 标签：javascript, html, dom, svg

我有一个随机的 DOM 节点，我想确定它是否是一个`svg`元素，即从`SVGElement`构造函数继承。我知道我可以通过调用`__proto__`节点来遍历原型链，但是是否有内置方法来确定这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:40:02.830

有一个专门的`instanceof`操作符检查一个对象的原型链中是否有构造函数的原型：

```
node instanceof SVGElement 
```

但是，鉴于您实际上不能这样做`new SVGElement()`（与所有节点构造函数一样），这可能无法在所有浏览器中可靠地工作。

# database - PostgreSQL：需要在从文件复制或从标准输入复制之间进行选择

> ID：12252601
> 
> 赞同：1
> 
> 时间：2012-09-03T18:30:23.773
> 
> 标签：database, postgresql, csv, query-optimization

我正在插入数百万条来自 C++ 结构的记录。使用常规插入，我的性能很糟糕，即使在配置优化之后，数据库也占用了 98% 的程序时间。我正在阅读我应该使用 COPY 从 CSV 文件中导入它。

现在我不太确定是否先写入 CSV 文件，然后将其重写到数据库中是否会有很大的改进，因为写入会加倍。我看过管道 STDIN，但乍一看似乎还有很多开销，而且它是有限的

如果我有一个 CSV 格式的字符串，那么将该数据写入我的数据库的最快方法是什么？

先感谢您，

CX

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T23:09:52.943

# jquery - 在表单中实现读取/编辑模式

> ID：12252603
> 
> 赞同：3
> 
> 时间：2012-09-03T18:30:28.753
> 
> 标签：jquery, html, css

我正在实现一个具有两种状态的表单。只读模式，用户可以从标签中读取信息，包括姓名、年龄、地址等信息。除此之外，我想要一个用户可以编辑信息的编辑模式。

标准视图应该是只读模式，当用户单击编辑时，我希望标签更改为文本框并且可以编辑。

使用 html、css 和 jquery 实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:33:33.883

您正在寻找的内容称为[“就地编辑”](http://www.appelsiini.net/projects/jeditable)。不要浪费时间重新发明轮子。:)

* * *

但只是为了一个快速的想法，我会发布一个简短的片段让你开始 -

1.  默认情况下始终以编辑模式渲染
2.  如果需要，请设为只读 - 如下

* * *

```
 <form data-mode="read">
    <input value="Hello" />
 </form>

if($('form').data('mode') == 'read'){   //remove fields and add text
  $('form').find(':input').each(function(){
     $(this).replaceWith($('<span>' + $(this).val() + '</span>');
  });
 } 
```

注意：您可以[禁用它们，而不是](https://stackoverflow.com/questions/1414365/how-to-disable-an-input-with-jquery)使用标签替换`.prop('disabled', true)`。

# soap - Magento API 错误 --- SoapHeaderException: 程序“登录”不存在

> ID：12252607
> 
> 赞同：2
> 
> 时间：2012-09-03T18:30:41.013
> 
> 标签：soap

我搞不清楚了。我什至不知道从哪里开始。这是我得到的错误：

程序“登录”不存在 说明：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.Web.Services.Protocols.SoapHeaderException：过程“登录”不存在

源错误：

第 375 行：service.Url = account.APIURL；第 376 行：第 377 行：字符串 sessionId = service.login(account.APIUser, account.APIPassword); 第 378 行：第 379 行：var orders = service.salesOrderList(sessionId, InitialiseSOAPOrderCriteria(account.TriggerOrderStatus));

源文件：c:\inetpub\wwwroot\UAT.SFSystem\Settings\ChannelHeader.ascx.cs 行：377

堆栈跟踪：

[SoapHeaderException: 程序“登录”不存在] System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse(SoapClientMessage 消息，WebResponse 响应，流 responseStream，布尔 asyncCall) +1772421 System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName , Object[] 参数) +345 Adapters.MagentoSOAP.MagentoSOAP.MagentoService.login(String username, String apiKey) 在 C:\Work\WebCatch\SF\StoreFeeder\Middlewares\SFMWMagento\Adapters.MagentoSOAP\Web References\MagentoSOAP\Reference .cs:663 Settings_ChannelHeader.magentoTestConnection(String channelGuid) in c:\inetpub\wwwroot\UAT.SFSystem\Settings\ChannelHeader.ascx.cs:377 Settings_ChannelHeader.btnTestConnection_Click(Object sender, EventArgs e) in c:\inetpub\wwwroot\ UAT.SFSystem\Settings\ChannelHeader.ascx.cs:154 System.Web.UI。WebControls.Button.RaisePostBackEvent（字符串 eventArgument）+154 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）+3707

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T04:43:46.937

我在使用 v2 magento api 时遇到了同样的错误，但是当我切换回 magento 的 v1 soap api 时问题解决了

# javascript - JSF/PrimeFaces 客户端输入操作

> ID：12252609
> 
> 赞同：0
> 
> 时间：2012-09-03T18:30:49.633
> 
> 标签：javascript, jquery, jsf, primefaces, client-side

我有一个 JSF/PrimeFaces 页面，其中 a`<p:selectOneMenu>`具有从托管 bean 中的值填充的项目。它的项目实际上是用简单语句描述的示例查询，以帮助用户评估系统。

```
<p:selectOneMenu id="sampleQueryInput">
    <f:selectItems value="#{bean.sampleQueries}" var="sampleQuery" itemLabel="#{sampleQuery.title}" itemValue="#{sampleQuery.query}" />
</p:selectOneMenu> 
```

当用户`sampleQuery.query`从. 文本区域包含要发送的实际查询，最终用户应该可以编辑。我没有在 PrimeFaces 用户指南中找到有关客户端 API 的足够信息，而且我不知道我应该使用 PF 客户端 API 还是编写自己的 javascript 来处理它。我怎样才能做到这一点？我正在使用 PrimeFaces 3.3.1。`<p:inputTextarea>``<p:selectOneMenu>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T09:33:20.697

`onchange`在你的中尝试这样的事情`p:selectOneMenu`（写一个简单的js函数并调用它）

```
var selectedVal = jQuery("[id$='sampleQueryInput']").find("select").val();
jQuery("#IdOfInputTextarea").text(selectedVal);//maybe it should be jQuery("#IdOfInputTextarea").val(selectedVal); , not sure 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T08:33:12.863

采用 ：

`<p:selectOneMenu id="sampleQueryInput" onchange="callJavaScriptFunction()">`

在`callJavaScriptFunction`您可以通过它的 ID 获取所选项目，`sampleQueryInput`并将值放入`inputTextarea`.

# javascript - 如何使用javascript解析输入文本中给出的数据？

> ID：12252613
> 
> 赞同：0
> 
> 时间：2012-09-03T18:31:09.577
> 
> 标签：javascript, html, javascript-events

我必须`HTML`从 MS excel 或相同类型的工作表中以以下格式将数据粘贴到输入文本字段中：

```
123456  12  this
234567  3   before blank
111111  3   
222222  3   after blank 
```

我从中复制了`MS Excel`包含单个选项卡的数据`12`，`this`依此类推。我尝试实现它，但对我不起作用。上面的数据将被粘贴到一个文本区域，并保存到另一个 javascript 变量中，格式如下：

```
<row dc= '" + arr[0] + "' al='" + arr[1] + "' msg='" + arr[2] + "' /> 
```

其中`arr[0]`is `123456`, and `arr[1]`is`12`和`arr[3]`is`this`等等通过附加值：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:38:56.560

```
var str=document.getElementById("myTextarea").value
var t=str.split("\n");
for (var i=0;i<t.length;i++)
{
  var arr=t[i].split("\t");
  document.write("'<row dc= '" + arr[0] + "' al='" + arr[1] + "' msg='" + arr[2] + "' />'")
} 
```

**工作样本：-**

```
<!DOCTYPE html>
<html>
<body>
<script>
function submit_a () {
var str=document.getElementById("allocationstatus").value
//str=str.replace('\t','&#09;');
//document.getElementById("allocationstatus").value=str;
var t=str.split("\n");
var s='';
for (var i=0;i<t.length;i++)
{
  var arr=t[i].split("\t");
  s ="'<row dc= '" + arr[0] + "' al='" + arr[1] + "' msg='" + arr[2] + "' />'";
  alert(arr.length);
  for (var j=0;j<arr.length;j++)
{
  //alert(arr[j]);
}
  //document.write(s);
}
}
</script>
<textarea rows = "5" cols = "80"  id = "allocationstatus" >stat&#09;do&#09;one
stat1&#09;do1&#09;one1
stat2&#09;do1&#09;one1</textarea>
<input type = "button" onclick = "submit_a();"/>

</body>
</html> 
```

# c - 函数调用期间的堆栈结构

> ID：12252617
> 
> 赞同：3
> 
> 时间：2012-09-03T18:32:10.497
> 
> 标签：c, gcc, assembly, stack

我的问题与[堆栈分配、填充和对齐](https://stackoverflow.com/questions/1061818/stack-allocation-padding-and-alignment)有关。考虑以下函数：

```
void func(int a,int b)
{
    char buffer[5];
} 
```

在汇编级别，函数如下所示：

```
pushl   %ebp
movl    %esp, %ebp
subl    $24, %esp 
```

我想知道堆栈上的 24 个字节是如何分配的。我知道为 char 缓冲区 [5] 分配了 16 个字节。我不明白为什么额外的 8 个字节用于以及它们是如何分配的。上面链接中的最佳答案说它是用于 ret 和 leave。有人可以扩展吗？

我认为堆栈结构如下所示：

```
[bottom] b , a , return address , frame pointer , buffer1 [top] 
```

但这可能是错误的，因为我正在编写一个简单的缓冲区溢出并尝试更改返回地址。但是由于某种原因，返回地址没有改变。堆栈上还有其他东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T19:07:01.650

额外空间有几个原因。一种是用于变量的对齐。第二个是引入填充以检查堆栈（通常是调试构建而不是发布构建使用空间）。第三是有额外的空间来临时存储寄存器或编译器生成的临时变量。

在 C 调用序列中，通常完成的方式是会有一系列 push 指令将参数压入堆栈，然后使用 call 指令调用函数。call 指令将返回地址压入堆栈。

当函数返回时，调用函数将删除推送的参数。例如，对函数的调用（这是带有 C++ 程序的 Visual Studio 2005）将如下所示：

```
push    OFFSET ?pHead@@3VPerson@@A      ; pHead
call    ?exterminateStartingFrom@@YAXPAVPerson@@@Z ; exterminateStartingFrom
add esp, 4 
```

这是将变量的地址压入堆栈，调用函数（函数名在 C++ 中被修改），然后在被调用函数返回后，它通过将用于堆栈指针的字节数添加到堆栈指针来重新调整堆栈。地址。

以下是被调用函数的入口部分。这样做是在堆栈上为局部变量分配空间。请注意，在设置入口环境后，它会从堆栈中获取函数参数。

```
push    ebp
mov ebp, esp
sub esp, 232                ; 000000e8H
push    ebx
push    esi
push    edi
lea edi, DWORD PTR [ebp-232] 
```

当函数返回时，它基本上将堆栈调整回调用函数时的位置。每个函数负责在返回之前清理它对堆栈所做的任何更改。

```
pop edi
pop esi
pop ebx
add esp, 232                ; 000000e8H
pop ebp
ret 0 
```

您提到您正在尝试更改退货地址。从这些示例中，您可以看到返回地址位于最后一个压入堆栈的参数之后。

这是[关于函数调用约定的简要说明](http://www.unixwiz.net/techtips/win32-callconv-asm.html)。另请查看[有关 Intel 汇编器指令的文档](http://www.cs.virginia.edu/~evans/cs216/guides/x86.html)。

使用 Visual Studio 2005 做一些示例工作，我看到的是，如果我执行以下代码，我可以访问此示例函数的返回。

```
void MyFunct (unsigned short arg) {
    unsigned char  *retAddress = (unsigned char *)&arg;
    retAddress -=4;
    printf ("Return address is 0x%2.2x%2.2x%2.2x%2.2x\n", retAddress[3], retAddress[2], retAddress[1], retAddress[0]);
} 
```

请注意，此 Windows 32 位寻址的调用汇编程序指令似乎将返回地址按字节顺序排列，其中返回地址从低字节到高字节存储。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T18:36:44.877

额外的空间用于堆栈对齐，这通常是为了获得更好的性能。

# c++ - 列表容器上的 std::set_difference

> ID：12252620
> 
> 赞同：10
> 
> 时间：2012-09-03T18:32:40.607
> 
> 标签：c++, list, stl, set-difference

我正在尝试调用 set_difference 函数，并将结果放在 std::list 上。理论上，可以在任何已排序的容器上执行此操作，对吧？

```
list<int> v;         

list<int> l1;  
list<int> l2;                   

list<int>::iterator it;

//l1 and l2 are filled here

l1.sort();
l2.sort();

it=set_difference(
   l1.begin(),
   l1.end(), 
   l2.begin(),
   l2.end(), 
   v.begin()
); 
```

但是， v 将作为空列表返回。是因为我不能在列表容器上使用它吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T18:36:54.417

这是因为`v.begin()`是空序列的开始。元素被复制到几乎任何地方。将其替换为`std::back_inserter(v)`。这将为您提供一个知道如何插入的迭代器`v`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T18:39:58.943

您需要提供一个将*插入*的输出迭代器。尝试使用[`std::inserter`](http://en.cppreference.com/w/cpp/iterator/inserter).

```
std::list<int> a { 
  10, 10, 10, 11, 11, 11, 12, 12, 12, 13
};
std::list<int> b {
  10
};
std::list<int> diff;
std::set_difference(a.begin(), a.end(), b.begin(), b.end(),
    std::inserter(diff, diff.begin())); 
```

# c++ - 如何在 log(n) 时间内或更好地计算该序列的第 n 个元素？

> ID：12252621
> 
> 赞同：1
> 
> 时间：2012-09-03T18:32:42.033
> 
> 标签：c++, c, fibonacci, sequences

```
1 4 10 22 45 88 167 
```

这个序列是斐波那契数与其自身的卷积。复发是

```
a[n] = a[n-1] + a[n-2] + Fibonacci[n+2] 
```

如果您假设斐波那契数列从`0,1,1,2,3,5 ...`( [http://oeis.org/A213587](http://oeis.org/A213587) )

我怎样才能生成它是对数时间或更快？请注意，这不是作业，也不是任何比赛问题。我正在研究斐波那契应用序列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:29:16.620

这是一个封闭的公式，因此几乎可以保证`O(1)`（使用 Mathematica 计算）

**输入**：

```
RSolve[{a[n] == a[n - 2] + a[n - 1] + Fibonacci[n + 2], a[1] == 1, a[2] == 4}, a[n], n] 
```

**输出**（点击[这里](http://latex.codecogs.com/gif.latex?a_n%20=%20%5Cfrac%7B%5Cleft%28-2%20%5Cleft%281%2b%5Csqrt%7B5%7D%5Cright%29%5Cright%29%5E%7B-n%7D%20%5Cleft%284%5En%20%5Cleft%287142%2b3194%20%5Csqrt%7B5%7D-%5Cleft%281885%2b843%20%5Csqrt%7B5%7D%5Cright%29%20n%5Cright%29%2b%28-1%29%5En%20%5Cleft%281%2b%5Csqrt%7B5%7D%5Cright%29%5E%7B2%20n%7D%20%5Cleft%28-7142-3194%20%5Csqrt%7B5%7D%2b%5Cleft%2833825%2b15127%20%5Csqrt%7B5%7D%5Cright%29%20n%5Cright%29%5Cright%29%7D%7B5%20%5Cleft%287985%2b3571%20%5Csqrt%7B5%7D%5Cright%29%7D)查看完整尺寸）：

![关联](../Images/a85a7de3f39ecff9e1753c9388042b8b.png)

您将不得不使用一些浮点运算，但您仍然可以从双精度数据类型中获得更高的精度。如果精度是个问题，请使用 GMP 或其他任意精度库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:16:16.297

我能够通过将递归关系转换为斐波那契卷积在 log n 时间内解决这个问题。最后，递归关系只包含卢卡斯数和斐波那契数。所以我能够在 2*log n 中解决它。我一旦我弄清楚如何在这里写数学符号，就会在这里写下整个证明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:41:54.900

**这不是问题的实际答案，只是一种生成整个序列的方法`O(n)`**

如果您的意思是`O(log(n))`仅计算第 n 个元素的时间复杂度，并非全部取决于`n`它实际上很容易。如果您遍历，您可以轻松地`O(1)`为每个元素进行适当的记忆。

我会假设这个：

```
a[1] = 1, a[2] = 1, fib[1] = 0, fib[2] = 1, fib[3] = 1 
```

然后只是迭代和记忆，`a[n-1]`以及`a[n-2]`一路上：`fib[n-1]``fib[n-2]`

```
long an_1 = 1;  // a[2]
long an_2 = 1;  // a[1]
long fib_1 = 2; // fib[4]
long fib_2 = 1; // fib[3]

// Starts with a[3]
while (true)
{
    long fib = fib_1 + fib_2;
    long an = an_1 + an_2 + fib;

    std::cout << an;

    fib_2 = fib_1;
    fib_1 = fib;
    an_2 = an_1;
    an_1 = an;
} 
```

***编辑***：这称为[摊销复杂性](http://en.wikipedia.org/wiki/Amortized_analysis)。计算到`n`第 - 个元素需要`O(n)`一些步骤，但是当你到达这一点时，所有元素`1`都`n`可用，计算每个元素的成本是`O(1)`. 正式的证明更详细一些，但这就是想法。

# zend-framework - Rob Allen 的 Zend Framework 2 教程：PHP 致命错误：找不到类“Album\AlbumTable”

> ID：12252624
> 
> 赞同：1
> 
> 时间：2012-09-03T18:33:08.727
> 
> 标签：zend-framework, zend-framework2

我希望有人可以帮助我。

我正在阅读[Rob Allen 的 Zend Framework 2 Tutorial](http://zf2.readthedocs.org/en/latest/user-guide/overview.html)。

当我尝试去：

```
http://localhost/album/index 
```

我收到以下错误：

```
[03-Sep-2012 17:48:07 UTC] PHP Fatal error:  Class 'Album\AlbumTable' not found in C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\module\Album\Module.php on line 33
[03-Sep-2012 17:48:07 UTC] PHP Stack trace:
[03-Sep-2012 17:48:07 UTC] PHP   1\. {main}() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\public\index.php:0
[03-Sep-2012 17:48:07 UTC] PHP   2\. Zend\Mvc\Application->run() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\public\index.php:12
[03-Sep-2012 17:48:07 UTC] PHP   3\. Zend\EventManager\EventManager->trigger() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\Mvc\Application.php:298
[03-Sep-2012 17:48:07 UTC] PHP   4\. Zend\EventManager\EventManager->triggerListeners() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:209
[03-Sep-2012 17:48:07 UTC] PHP   5\. call_user_func() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:469
[03-Sep-2012 17:48:07 UTC] PHP   6\. Zend\Mvc\DispatchListener->onDispatch() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:469
[03-Sep-2012 17:48:07 UTC] PHP   7\. Zend\Mvc\Controller\AbstractController->dispatch() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\Mvc\DispatchListener.php:114
[03-Sep-2012 17:48:07 UTC] PHP   8\. Zend\EventManager\EventManager->trigger() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractController.php:108
[03-Sep-2012 17:48:07 UTC] PHP   9\. Zend\EventManager\EventManager->triggerListeners() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:209
[03-Sep-2012 17:48:07 UTC] PHP  10\. call_user_func() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:469
[03-Sep-2012 17:48:07 UTC] PHP  11\. Zend\Mvc\Controller\AbstractActionController->onDispatch() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php:469
[03-Sep-2012 17:48:07 UTC] PHP  12\. Album\Controller\AlbumController->indexAction() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractActionController.php:87
[03-Sep-2012 17:48:07 UTC] PHP  13\. Album\Controller\AlbumController->getAlbumTable() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\module\Album\src\Album\Controller\AlbumController.php:26
[03-Sep-2012 17:48:07 UTC] PHP  14\. Zend\ServiceManager\ServiceManager->get() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\module\Album\src\Album\Controller\AlbumController.php:18
[03-Sep-2012 17:48:07 UTC] PHP  15\. Zend\ServiceManager\ServiceManager->create() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\ServiceManager\ServiceManager.php:412
[03-Sep-2012 17:48:07 UTC] PHP  16\. Zend\ServiceManager\ServiceManager->createFromFactory() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\ServiceManager\ServiceManager.php:455
[03-Sep-2012 17:48:07 UTC] PHP  17\. Zend\ServiceManager\ServiceManager->createServiceViaCallback() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\ServiceManager\ServiceManager.php:801
[03-Sep-2012 17:48:07 UTC] PHP  18\. call_user_func() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\ServiceManager\ServiceManager.php:684
[03-Sep-2012 17:48:07 UTC] PHP  19\. Album\Module->Album\{closure}() C:\Program Files (x86)\Zend\Apache2\htdocs\zf2-tutorial\vendor\zendframework\zendframework\library\Zend\ServiceManager\ServiceManager.php:684 
```

请注意，即使 AlbumTable.php 在 Album\Model 中，也**找不到 Class 'Album\AlbumTable' 。**

模块\相册\Module.php：

```
<?php

// module/Album/Module.php
namespace Album;

class Module
{
    public function getAutoloaderConfig()
    {
        return array(
            'Zend\Loader\ClassMapAutoloader' => array(
                __DIR__ . '/autoload_classmap.php',
            ),
            'Zend\Loader\StandardAutoloader' => array(
                'namespaces' => array(
                    __NAMESPACE__ => __DIR__ . '/src/' . __NAMESPACE__,
                ),
            ),
        );
    }

    public function getConfig()
    {
        return include __DIR__ . '/config/module.config.php';
    }

    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'Album\Model\AlbumTable' =>  function($sm) {
                    $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                    $table     = new AlbumTable($dbAdapter);
                    return $table;
                },
            ),
        );
    }
} 
```

模块\专辑\src\专辑\模型\AlbumTable.php：

```
<?php

// module/Album/src/Album/Model/AlbumTable.php:
namespace Album\Model;

use Zend\Db\Adapter\Adapter;
use Zend\Db\ResultSet\ResultSet;
use Zend\Db\TableGateway\AbstractTableGateway;

class AlbumTable extends AbstractTableGateway
{
    protected $table ='album';

    public function __construct(Adapter $adapter)
    {
        $this->adapter = $adapter;
        $this->resultSetPrototype = new ResultSet();
        $this->resultSetPrototype->setArrayObjectPrototype(new Album());
        $this->initialize();
    }

    public function fetchAll()
    {
        $resultSet = $this->select();
        return $resultSet;
    }

    public function getAlbum($id)
    {
        $id  = (int) $id;
        $rowset = $this->select(array('id' => $id));
        $row = $rowset->current();
        if (!$row) {
            throw new \Exception("Could not find row $id");
        }
        return $row;
    }

    public function saveAlbum(Album $album)
    {
        $data = array(
            'artist' => $album->artist,
            'title'  => $album->title,
        );
        $id = (int)$album->id;
        if ($id == 0) {
            $this->insert($data);
        } else {
            if ($this->getAlbum($id)) {
                $this->update($data, array('id' => $id));
            } else {
                throw new \Exception('Form id does not exist');
            }
        }
    }

    public function deleteAlbum($id)
    {
        $this->delete(array('id' => $id));
    }
} 
```

模块\Album\src\Album\Controller\AlbumController.php：

```
<?php

// module/Album/src/Album/Controller/AlbumController.php:
namespace Album\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;

class AlbumController extends AbstractActionController
{

    protected $albumTable;

    public function getAlbumTable()
    {
        if (!$this->albumTable) {
            $sm = $this->getServiceLocator();
            $this->albumTable = $sm->get('Album\Model\AlbumTable');
        }
        return $this->albumTable;
    }

    public function indexAction()
    {
        return new ViewModel(array(
            'albums' => $this->getAlbumTable()->fetchAll(),
        ));
    }

    public function addAction()
    {
    }

    public function editAction()
    {
    }

    public function deleteAction()
    {
    }
} 
```

我的配置：

*   Windows 7的。
*   Zend Server CE 技术预览版 (PHP 5.4) （注意我尝试使用 Zend Server CE (PHP 5.3) 但得到同样的错误）。
*   Apache 和 MySQL 在其他 PHP 页面上工作得很好，例如，我可以在一个简单的 PHP 脚本中使用 PDO 连接到“专辑”表。

你们中有人知道问题可能是什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T04:30:20.963

类是`Album\Model\AlbumTable`，但在错误消息中它是`Album\AlbumTable`

堆栈跟踪将您引导至 ServiceManager。`Album\Model\AlbumTables`添加到 ServiceManager 的闭包`Album\Module::getServiceConfig()`

在那里你可以看到`$table = new AlbumTable($dbAdapter);`命名空间`Album`解析为`Album\AlbumTable`.
这很容易解决：`use Album\Model\AlbumTable;`在命名空间声明后添加到 module\Album\Module.php

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T00:25:22.323

将您的行替换为

```
$table = new \Album\Model\AblumTable($dbAdapter); 
```

或者在类之前在文件顶部添加一个使用。

```
use Album\Model\AlbumTable; 
```

# c# - 动态创建的表和 DataGridView

> ID：12252627
> 
> 赞同：2
> 
> 时间：2012-09-03T18:33:47.533
> 
> 标签：c#, datagridview, dataset, sqldataadapter

在我的 Windows 窗体中，我必须创建一个由用户名（在文本框中）指定的表（在运行时），然后将此表用作`DataGridView`. 最后，必须将填好的表插入到数据库中。我试图通过两种方式解决这个问题：

1.  我创建了一个 DataTable，指定了它的列等，但我无法将 DataTable 插入数据库，即使使用`SqlDataAdapter.Update()`- 可能我误用了`DataAdapter`. 我正在使用`C#`1 周，但我并不完全理解`DataSet`s、`TableAdapter`s 等的概念。所以我决定使用 SQL 命令。

2.  使用`ExecuteNonQuery()`我在我的数据库中创建的表，然后我认识到，我必须使用魔术 SqlDataAdapter 并且我放弃了。

我想以与添加到使用配置向导`DataGridView`的情况相同的方式管理内容。`DataTable``DataSet`

我知道，我可以跳过`DataGridView`、创建文本框列表、扩展此列表的按钮，以及在确认按钮后将所有字段插入我的表格的功能，但我的主管期望`DataGridView`。

我不能在这里粘贴代码，因为我在公司计算机上只留下了源代码的副本。如果有必要，我明天将在这里粘贴我的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T18:05:26.497

尝试使用`RowValidating`方法`CellValidating``DataGridView`

```
 private void dataGridViewEnterTab1_RowValidating(object sender, DataGridViewCellCancelEventArgs e)
    {
        if (dataGridViewEnterTab1.IsCurrentRowDirty) // Trigger when the row is dirty or has changed
        {
            string userName = dataGridViewEnterTab1["UserNameCol", e.RowIndex].EditedFormattedValue.ToString();

            //...Your SqlDataAdapter or codes
        }
    } 
```

我希望它会帮助这个想法。:)

# sql-server - 如何将 WebService 的 XML 结果存储到 SQL Server 数据库中？

> ID：12252635
> 
> 赞同：0
> 
> 时间：2012-09-03T18:34:12.750
> 
> 标签：sql-server, xml, wcf, web-services

我们有一个调用 Web 服务的 .Net 客户端。我们希望将结果存储在 SQL Server 数据库中。

我认为我们在这里有两种选择如何存储数据，我有点犹豫不决，因为我无法清楚地看到利弊：一种是将结果映射到数据库字段中。这将要求我们拥有与每种可能的结果类型相对应的数据库字段，例如，对于每个“正常”结果类型以及故障结果类型。

另一方面，我们可以存储生成的 XML 并通过 SQL Server 内置的 XML 函数进行查询。

就个人而言，我对处理 SQL 和 XML 都很满意，所以对我来说两者都很好。

在尝试为许多不同的可能的 Web 服务操作存储生成的 XML 时，在数据库设计方面我需要考虑什么？我在考虑每个操作的结果表，我们使用不同的条目来调用不同的可能结果/类型，然后将 XML 存储在正确的字段中，例如错误字段中的错误，适当的“正常”返回类型场等

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T20:19:07.307

我们使用两者的组合。用于参考和详细数据的 XML，以及您可能搜索的字段的文本列。可搜索的列包括订单号、客户参考号、票号。我们只是在需要时添加它们，因为您可以从 XML 列中提取它们。

我不会只推荐 XML。如果您每天存储 10.000 条消息，则查询如下：

```
select * from XmlLogging with (nolock) where Response like '%Order12%' 
```

可能会变慢并干扰其他查询。您也无法在 GUI 中显示日志记录，因为检索速度太慢。

我也不会只推荐文本列。如果 XML 格式发生变化，您将得到一个空列。如果没有 XML 消息，这很难解决。此外，如果您需要“重放”消息流，使用 XML 消息会容易得多。很少有需求需要重播，但在修复生产问题的后果时确实很有帮助。

# android - 如何在测验应用程序中设置评分系统？

> ID：12252636
> 
> 赞同：0
> 
> 时间：2012-09-03T18:34:33.803
> 
> 标签：android, class, inheritance, scoring

我正在尝试设置一个测验，其中每个答案都会在总分中增加一定数量的分数。目前，我关心单选按钮。我已经建立了一个单选组，我希望选择任何单选按钮来添加到总分中。这只是我的程序的一部分，只是要注意。

当我按下 xml 布局文件底部的按钮时，我希望将与单选按钮关联的分数添加到总分中。你明白吗？

这是实际 xml 布局文件的类文件：

```
Public class QuestionOne extends Results {

    RadioButton answer1, answer2, answer3;
    Button oneNext;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.one);

        RadioButton answer1 = (RadioButton) findViewById(R.id.oneradio1);
        RadioButton answer2 = (RadioButton) findViewById(R.id.oneradio2);
        RadioButton answer3 = (RadioButton) findViewById(R.id.oneradio3);

        Button oneNext = (Button) findViewById(R.id.onenext);

    }

} 
```

它扩展了 Results 类，我这样做是为了继承分数整数。这是分数等级：

```
public class Results extends Activity {

    private int score;

    public int getScore() {
        return score;
    }

    public Results(int score) {
        this.score = score;
    }

} 
```

我从谷歌上得到了这个结构，我敢肯定它的有效性值得怀疑，但我认为我有基本的想法。谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:40:46.447

声明一个[RadioGroup](http://developer.android.com/reference/android/widget/RadioGroup.html)而不是声明单个 RadioButtons。

```
answerGroup = (RadioGroup) findViewById(R.id.radioGroupAnswer); 
```

您可以获得在 RadioGroup 中选择的按钮的索引。

```
int index = answerGroup.indexOfChild(findViewById(answerGroup.getCheckedRadioButtonId())); 
```

然后您可以使用此索引值并将分数添加到总分中。

```
switch(index)
{
case 0 : totalScore = totalScore + x; // x is the score of the first answer
break;
case 1 : totalScore = totalScore + y; // y is the score of the second answer
break;
case 2 : totalScore = totalScore + z; // z is the score of the third answer
break;
} 
```

# jquery - 如何使用 jQuery 验证插件规范化有效值？

> ID：12252637
> 
> 赞同：0
> 
> 时间：2012-09-03T18:34:43.853
> 
> 标签：jquery, validation

让我们检查一个简单的场景，其中要求用户输入加拿大邮政编码。以下邮政编码均有效且等效：

*   H0H 0H0
*   h0h 0h0
*   h0h0h0

我希望用户输入其中的任何一个，但是一旦留下该字段以将值标准化为第一个表单。我的`postalCode`验证方法确实允许输入其中任何一个，但是，我想知道标准化值的正确方法是什么。

也许jQuery验证插件中已经有这样的工具，我只是没有看到它。

**编辑**

给定一个函数`normalizeInput`，我想知道如何插入它。也许 jQuery 验证插件中有一个专门用于此的钩子。如果没有，如何做到这一点，以便在成功验证后离开该字段后调用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-10T19:24:43.703

根据 Jquery Validate 网站，您可以为任何给定字段包含一种方法，以在验证值之前对其进行规范化： [https ://jqueryvalidation.org/normalizer/](https://jqueryvalidation.org/normalizer/)

```

```
$( "#myform" ).validate( {
  rules: {
    field: {
      required: true,
      normalizer: function( value ) {
        // Trim the value of the `field` element before
        // validating. this trims only the value passed
        // to the attached validators, not the value of
        // the element itself.
        return $.trim( value );
      }
    }
  }
} ); 
```

```

但从外观上看，这只是逐个领域的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:40:43.093

尝试以下操作：

```
function normalizePostalCode(s) {
  return s.replace(/(.{3}) ?(.{3})/, '$1 $2').toUpperCase();   
}

var s = "h0h0h0";
s = normalizePostalCode(s); // H0H 0H0 
```

它将删除空格 ( `\s`)，并将每个字母转换为大写，使第一种形式保持不变，并将第二种和第三种形式转换为第一种形式。

**编辑**：我不认为 jQuery Validation Plugin 提供某种规范化回调。但是，您可以使用[`.blur()`](http://api.jquery.com/blur/)or[`.focusout()`](http://api.jquery.com/focusout/)事件并检查该字段是否为[`valid()`](http://docs.jquery.com/Plugins/Validation/valid)，如果是，则对其进行规范化：

```
$("#txtPostalCode").blur(function () {
    $this = $(this);
    $this.validate();
    if ($this.valid()) {
      $this.val(normalizePostalCode($this.val()));   
    }
}); 
```

**[演示](http://jsfiddle.net/qKyD7/)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-03T18:17:11.043

我添加了自己的空白方法，

```
 $(document).ready(function($) {
      jQuery.validator.addMethod("whitespace", function(value, element) { 
       return $.trim( value );
     }, 'whitespace is not allowed'); 
    });

// in rules
    rules: {
      street: {
        whitespace: true, 
        email: true
      },
    } 
```

# r - 使用 R 创建“艺术”马赛克图片（*不是*统计马赛克图）

> ID：12252638
> 
> 赞同：7
> 
> 时间：2012-09-03T18:34:45.840
> 
> 标签：r, graphics, color-picker

我想玩弄一下图像，想知道 R 中是否有办法生成这样[的](http://cache2.allpostersimages.com/p/LRG/14/1430/CM4R000Z/posters/bob-marley-mosaic.jpg)**马赛克图片**。

我猜对于背景图像可以使用`readJPEG`（包[jpeg](http://cran.r-project.org/web/packages/jpeg/index.html)）和`rasterImage`来自包`graphics`。

但是我对如何计算和聚类颜色值等以安排前景图片感到迷茫。

## 编辑

我发现这篇[文章](https://stackoverflow.com/questions/6602314/php-mosaic-script)“朝着正确的方向发展”。但我想如果你创建一个“真正的”马赛克，其中实际图片完全由小图片组成（而不是像[本例](http://www.engadget.com/2004/10/19/how-to-make-your-own-photo-mosaics/)那样结合背景和前景图片并找到合适的透明度），你有您需要数百甚至可能数千张图片的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T21:16:31.473

认为这是一个很好的挑战，可以浪费几个小时。这是一个概念验证功能：

```
library(jpeg)
library(png)
library(plyr)

reduceCol <-  function(x,dim=c(1,1))
{
  arr <- array(dim=c(nrow(x),ncol(x),4))
  cols <- col2rgb(c(x),alpha=TRUE)
  arr[,,1] <- matrix(cols[1,],nrow(x),ncol(x),byrow=TRUE)
  arr[,,2] <- matrix(cols[2,],nrow(x),ncol(x),byrow=TRUE)
  arr[,,3] <- matrix(cols[3,],nrow(x),ncol(x),byrow=TRUE)
  arr[,,4] <- matrix(cols[4,],nrow(x),ncol(x),byrow=TRUE)

  Res <- array(dim=c(dim,4))
  if (dim[1]>1) seqRows <- as.numeric(cut(1:nrow(x),dim[1])) else seqRows <- rep(1,nrow(x))
  if (dim[2]>1) seqCols <- as.numeric(cut(1:ncol(x),dim[2])) else seqCols <- rep(1,ncol(x))

  for (i in 1:dim[1])
  {
    for (j in 1:dim[2])
    { 
      for (z in 1:4)
      {
        Res[i,j,z] <- mean(arr[seqRows==i,seqCols==j,z])
      }
    }
  }
  return(Res)
}

rgbarr2colmat <- function(mat) 
{
  Res <- array(dim=dim(mat)[1:2])
  for (i in 1:dim(mat)[1])
  {
    for (j in 1:dim(mat)[2])
    {
      Res[i,j] <- rgb(mat[i,j,1],mat[i,j,2],mat[i,j,3],mat[i,j,4],maxColorValue=255)
    }
  }
  return(Res)
}

artymosaic <- function(BG,pics,res=c(10,10))
{
  BGreduced <- reduceCol(BG,res)
  Picmeancol <- lapply(pics,reduceCol)

  blockPic <- array(dim=res)
  for (i in 1:res[1])
  {
    for (j in 1:res[2])
    {
      blockPic[i,j] <- which.min(sapply(Picmeancol,function(x)sum(abs(BGreduced[i,j,]-x))))
    }
  }
  blockPic <- t(blockPic)
  blockPic <- blockPic[,ncol(blockPic):1]

  # Open empty plot:
  par(mar=c(0,0,0,0))
  plot(1,xlim=c(0,1),ylim=c(0,1),type="n",bty="n",axes=FALSE)

  # plot moasics:
  seqRows <- seq(0,1,length=res[1]+1)
  seqCols <- seq(0,1,length=res[2]+1)
  for (i in 1:res[1])
  {
    for (j in 1:res[2])
    {
      rasterImage(pics[[blockPic[i,j]]],seqRows[i],seqCols[j],seqRows[i+1],seqCols[j+1],interpolate=FALSE)
    }
  }
} 
```

`artymosaic`使用光栅格式的背景作为第一个参数，光栅格式的图片列表作为第二个参数，分辨率 (numeric(2)) 作为第三个参数。

由计算机图片组成的带有 R 标志的示例。我下载了一些 google 的图片并上传到[http://sachaem47.fortyseven.versio.nl/files/pics/mosaic.zip](http://sachaem47.fortyseven.versio.nl/files/pics/mosaic.zip)。如果将这些提取到一个马赛克文件夹中，并且在工作目录中下载了 R 标志 ( [http://cran.r-project.org/Rlogo.jpg](http://cran.r-project.org/Rlogo.jpg) )，我们可以如下制作“艺术马赛克”。

```
bg <- readJPEG("Rlogo.jpg")
BG <- as.raster(bg)

jpgs <- lapply(list.files("mosaic/",pattern="\\.jpg",full.names=TRUE),readJPEG)
pics <- lapply(jpgs,as.raster)

png("test.png")
artymosaic(BG,pics,c(50,50))
dev.off() 
```

![在此处输入图像描述](../Images/612bdf6372b4232abcc52165ad2ee180.png)

看起来很壮观吧？这里的主要缺点是我在适当的地方重复使用相同的图像并且我只使用了很少的图像。这可以改变，但需要更多的图像，这将导致函数运行时间更长。再次，概念证明。

# java - 使用 Java/Android 测量下载速度

> ID：12252639
> 
> 赞同：9
> 
> 时间：2012-09-03T18:34:48.560
> 
> 标签：java, android, networking, 3g

我正在开发一个 Android 应用程序，我需要尽可能准确地测量当前连接的下载速度。这是迄今为止我能找到的最好的方法（基本上我启动一个计时器，开始从快速服务器下载 Linux 发行版，下载大约 200 KB，然后停止计时器并检查经过的时间和下载的总字节数）：

```
try{                
    InputStream is = new URL("http://www.domain.com/ubuntu-linux.iso").openStream();
    byte[] buf = new byte[1024];
    int n = 0;              
    startBytes = TrafficStats.getTotalRxBytes(); /*gets total bytes received so far*/
    startTime = System.nanoTime();
    while(n<200){
        is.read(buf);
        n++;                
    }
    endTime = System.nanoTime();
    endBytes = TrafficStats.getTotalRxBytes(); /*gets total bytes received so far*/
    totalTime = endTime - startTime;
    totalBytes = endBytes - startBytes;
}
catch(Exception e){
    e.printStackTrace();
} 
```

之后，我只需要将传输的字节数除以所花费的时间，它就会给出以 bps 为单位的下载速度。

**问题**： 1\. 这种方法准确吗？2.你知道更好的吗？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T11:40:39.770

这里有几个可能的问题：

1.  如果您希望在任意设备上即时执行此操作（而不是在实验室环境中），则需要遵循 Jeffrey 的建议，因为其他应用程序可能会消耗`getTotalRxBytes()`.

2.  这将测试从该主机下载的速度。如果那是您将要与“真实的东西”交流的主机，那很酷。或者，如果您通常只需要了解下载速度，那也没关系。但是测试站点 A 的下载速度并假设站点 B 的下载速度是不可靠的，因为站点 A 和站点 B 甚至可能不在同一个大陆上。

3.  如果您希望经常这样做，您正在测试的主机的所有者可能会对带宽费用、过多的日志条目等感到轻微的恼火。理想情况下，您只会对您拥有的东西执行此操作。

4.  对于按流量计费的数据计划，200KB 可能会激怒设备所有者。

5.  有关 Internet 访问（例如，服务器可能已关闭）和移动设备（例如，用户可能开始使用 WiFi 并移出范围，从而极大地改变您的下载能力）的所有标准警告都适用。

话虽如此，下载是衡量下载速度的唯一真正方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-23T12:51:19.380

使用下面的代码。我用它来测量下载速度。您不需要为了测量下载速度而保存文件。您也可能不需要使用 OkHttp。我使用它是因为它在我们的项目中使用过。

```
 String downloadURL = "http://test.talia.net/dl/1mb.pak";

    MediaType FILE = MediaType.parse("multipart/form-data;");

    OkHttpClient downloadClient = new OkHttpClient().newBuilder()
            .build();

    Request download = new Request.Builder()
            .url(downloadURL)
            .build();

    downloadClient.newCall(download).enqueue(new Callback() {
        @Override
        public void onFailure(Call call, IOException e) {

        }

        @Override
        public void onResponse(Call call, Response response) throws IOException {
            if(response!=null) {
                long startTime = System.currentTimeMillis();
                InputStream is = response.body().byteStream();
                BufferedInputStream bis = new BufferedInputStream(is);
                long size = 0;
                int red = 0;
                byte[] buf = new byte[1024];
                while ((red = bis.read(buf)) != -1) {
                    size += red;
                }
                long endTime = System.currentTimeMillis();
                double rate = (((size / 1024) / ((endTime - startTime) / 1000)) * 8);
                rate = Math.round( rate * 100.0 ) / 100.0;
                String ratevalue;
                if(rate > 1000)
                    ratevalue = String.valueOf(rate / 1024).concat(" Mbps");
                else
                    ratevalue = String.valueOf(rate).concat(" Kbps");
                if(is!=null) {
                    is.close();
                }
                if(bis!=null) {
                    bis.close();
                }
                Log.d("download", "download speed = " + ratevalue);
            }
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-13T12:19:09.467

采样方法有很多种，没有一种“真正”的速度。您可以查看以下标准，让您更了解推荐的方法：

[https://itu.int/en/ITU-T/CI/Pages/IM/Internet-speed.aspx](https://itu.int/en/ITU-T/C-I/Pages/IM/Internet-speed.aspx)

[https://itu.int/itu-t/recommendations/rec.aspx?rec=q.3960](https://itu.int/itu-t/recommendations/rec.aspx?rec=q.3960)

[https://itu.int/ITU-T/recommendations/rec.aspx?rec=14125](https://itu.int/ITU-T/recommendations/rec.aspx?rec=14125)

[https://tools.ietf.org/pdf/rfc6349.pdf](https://tools.ietf.org/pdf/rfc6349.pdf)

您提出的代码使用 1 个线程测试速度。不推荐这种方式，因为它不会最大化互联网连接的全部容量。大多数标准都推荐多线程测试。

您还可以使用我们的 Android SDK，它应该可以满足您的需求并符合 ITU 标准：

[https://github.com/speedchecker/speedchecker-sdk-android](https://github.com/speedchecker/speedchecker-sdk-android)

# python - Google Calendar API - 通过服务帐户访问自己的日历

> ID：12252644
> 
> 赞同：8
> 
> 时间：2012-09-03T18:35:26.897
> 
> 标签：python, api, authentication, calendar, google-api-python-client

我想访问 Google Calendar API 以使用 Python 插入条目。我在 Google API 控制台上创建了一个**服务帐户**，添加了一个私钥，然后下载了它。

但是当我尝试修改日历的任何内容时，它在同一个帐户上，我收到以下错误消息。阅读作品。

代码是

```
import httplib2

from oauth2client.client import SignedJwtAssertionCredentials 
from apiclient.discovery import build

event = {
         'summary' : 'Appointment',
         'location' : 'Somewhere',
         'start' : {
                    'dateTime' : '2012-09-03T10:00:00.000-07:00'
                    },
         'end' :    {
                 'dateTime' : '2012-09-03T10:25:00.000-07:00'
                    }
}

f = file("key.p12", "rb")
key = f.read()
f.close()

credentials = SignedJwtAssertionCredentials(
                                                service_account_name='423291807109-XXXXXXXXXXXXXXXXxx@developer.gserviceaccount.com',
                                                private_key=key,

                                                scope='https://www.googleapis.com/auth/calendar'                                            
                                            )

http = httplib2.Http()
http = credentials.authorize(http)

service = build('calendar', 'v3', http=http)
request = service.events().insert(calendarId='XXXXXXXXXXXXXXXXXX@group.calendar.google.com', body=event)

response = request.execute()

print(response) 
```

错误信息是：

```
apiclient.errors.HttpError: <HttpError 403 when requesting https://www.googleapis.com/calendar/v3/calendars/XXXXXXXXXXXXXXXXXXX@group.calendar.google.com/events?alt=json returned "Forbidden"> 
```

我原以为我可以使用此服务帐户访问我自己的数据，但似乎并非如此。

谷歌声称

> 创建服务帐户后，您还可以访问与私钥关联的客户端 ID。在编写应用程序时，您将需要两者。- [https://developers.google.com/accounts/docs/OAuth2?hl=de#scenarios](https://developers.google.com/accounts/docs/OAuth2?hl=de#scenarios)

我用谷歌搜索了大约 2 个小时，但似乎记录得很糟糕。有没有一种方法可以通过谷歌日历 API 插入新事件而无需用户交互（又名 3 腿 OAuth），或者有没有办法修复它？

我刚刚发现已弃用的 ClientLoging。为什么谷歌让它变得如此困难？

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T18:50:34.237

我意识到，如果将生成的凭据转储到 JSON 并在每次需要时读取它们，那么 3 步 OAuth 就可以工作。

所以流程是：将您的**client_secrets.json**添加到与此脚本相同的文件夹中，如[Google API](http://bit.ly/NKrI0S)中所述。从提示中给出的 url 中获取密钥。根据提示输入它。派对！11。我希望这些凭据永远存在。

```
from oauth2client.client import flow_from_clientsecrets

flow = flow_from_clientsecrets('client_secrets.json',
                               scope='https://www.googleapis.com/auth/calendar',
                               redirect_uri='urn:ietf:wg:oauth:2.0:oob')

auth_uri = flow.step1_get_authorize_url()
print('Visit this site!')
print(auth_uri)
code = raw_input('Insert the given code!')
credentials = flow.step2_exchange(code)
print(credentials)

with open('credentials', 'wr') as f:
    f.write(credentials.to_json()) 
```

现在，在应用程序本身：

```
def __create_service():
    with open('credentials', 'rw') as f:
        credentials = Credentials.new_from_json(f.read())

    http = httplib2.Http()
    http = credentials.authorize(http)

    return build('calendar', 'v3', http=http) 
```

要获取服务对象，现在可以调用

```
service = __create_service() 
```

并在其上使用 API。

# ruby-on-rails - 在电子邮件客户端中呈现垃圾

> ID：12252650
> 
> 赞同：0
> 
> 时间：2012-09-03T18:35:59.997
> 
> 标签：ruby-on-rails, ruby, encoding, character-encoding, actionmailer

我遇到了葡萄牙语字符的编码问题。它没有正确渲染。

这是用 ���</p> 替换葡萄牙语字符

在我的电子邮件方法中，我有类似的东西：

```
@html_content = html_content
@text_content = text_content

mail(
  :from => "#{from_name} <notifications@email.com>",
  :to => options[:recipients],
  :subject => options[:subject]
) 
```

在我看来，我有这样的事情：

```
<%= @html_content %> 
```

我已经检查了变量内容，一切看起来都很好。所以问题可能发生在方法 mail(...)

我尝试按照此说明操作 [邮件程序编码 - 在电子邮件客户端中呈现垃圾](https://stackoverflow.com/questions/11477739/actionmailer-encoding-rendering-garbage-in-email-client)

并没有工作。任何想法？

我正在使用 Rails 3.2.2 和 Ruby 1.9.3

[更新]

字节值是：

[208、146、209、150、209、130、208、176、208、187、209、150、208、185] [80、111、114、116、117、103、117、195、170、115]

消息内容为：

Віталій 葡萄牙语

# c++ - 右 ALT 发送两个虚拟键码

> ID：12252651
> 
> 赞同：1
> 
> 时间：2012-09-03T18:36:00.943
> 
> 标签：c++, winapi, hook

在我的钩子程序（用于键盘）中，当我单击右 alt 时，它会在按下时向我发送两个代码，在释放时发送两个代码：

编码：

```
LRESULT CALLBACK Recorder::keyboardHookProcedure( int code, WPARAM wParam, LPARAM lParam ) {
    if( code < 0 )
        return CallNextHookEx( m_mouseHook, code, wParam, lParam );   

    DWORD _vkCode = reinterpret_cast<KBDLLHOOKSTRUCT*>( lParam )->vkCode;

    qDebug( "vkCode: %d, wparam: %d, lparam: %d", _vkCode, wParam, lParam );

    return CallNextHookEx( 0, code, wParam, lParam );
} 
```

按下时

```
vkCode: 162, wparam: 260, lparam: 3398032
vkCode: 165, wparam: 260, lparam: 3398032 
```

在发布时

```
vkCode: 162, wparam: 257, lparam: 3398032
vkCode: 165, wparam: 257, lparam: 3398032 
```

此外，请注意，当您按下键时，它会将其发送为**WM_SYSKEYDOWN (260)**，但是当您释放它时， wParam 是**WM_KEYUP (257)**。什么……？为什么它以这种方式工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T18:40:40.300

这是因为右 alt 键 (ALT-GR) 是两个键的快捷方式 - ALT 和 CTRL

你得到 WM_SYSKEYDOWN 但 WM_KEYUP 因为这是定义消息的方式 - 如果你期待 WM_SYSKEYUP，当你释放与 ALT 键一起按下的键时，你会得到 - [http://msdn.microsoft.com/en-我们/图书馆/windows/desktop/ms646287(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646287(v=vs.85).aspx)

# c# - 冷重启后运行另一个应用程序的 Windows 2008R2 服务

> ID：12252652
> 
> 赞同：0
> 
> 时间：2012-09-03T18:36:13.387
> 
> 标签：c#, windows, console-application, autostart

我正在开发适用于 Windows Server 2008 R2 (.NET 3.5.1) 的应用程序，该应用程序即使在冷重启后也能正常工作，而不需要有人登录服务器上的任何帐户。

关于应用程序本身的几句话，它是用c＃编写的应用程序，用于注册员工在公司的工作时间。用户（员工），他们的卡片正在被条形码扫描仪扫描，每次扫描都意味着“工作开始”或“工作停止”，所有内容都被序列化为 xml 文件，该文件稍后被修改并放入 .csv 但那没有没关系。

条形码扫描仪作为键盘工作，因此所有代码都像从键盘一样“输入”到 PC。尽管控制台应用程序不在焦点上或根本不可见，但我还是让应用程序读取了密钥。

我需要做的是使该应用程序即使在冷重启后也能正常工作，它必须是全自动的。

到目前为止，我想出了两种方法来做到这一点，一种是创建一个服务来保持另一个进程处于活动状态（如果它不工作，只需打开它），我对这个没有太多运气，我已经创建了为我启动另一个进程的服务，但该进程的工作方式不同，如果我自己运行它，则与该进程没有通信，所以我什至无法判断它是否正确。

另一种是将我的应用程序放入注册/microsoft/windows/current version/run，并为具有有限权限的用户启用自动登录。这实际上可以工作，但它不是完美的解决方案，因为毕竟我们不希望用户 24/7 全天候登录公司的服务器，对吗？

我知道你们中的大多数人在编程方面比我更有经验，所以我会应用任何解决方案来解决我的问题

利霍涅斯皮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:45:30.467

我将使用第一种方法，创建一个服务，并与正在运行的应用程序通信，我将使用网络套接字或管道。对于该服务，请确保您使用的是现有用户帐户（不是系统）并允许它与桌面交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:53:43.550

您的选择取决于系统的物理安全性（除了扫描条形码，路人是否可以对其做很多事情），但让我们假设它是一个易于访问的桌面。在这种情况下，您可能不需要登录用户。

使用服务方法。您不需要单独的进程来访问键盘。创建一个全局钩子类型`WH_KEYBOARD_LL`。

[像这样](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644984%28v=vs.85%29.aspx)声明你的回调函数并用`SetWindowsHookEx`.

# iphone - mapKit 中是否自动使用“我的地图视图”的标题？

> ID：12252653
> 
> 赞同：0
> 
> 时间：2012-09-03T18:36:18.567
> 
> 标签：iphone, ios, xcode, mapkit

![在此处输入图像描述](../Images/f83e2f42ffac46e5fbf04d812e49cd83.png)

在编写应用程序时，我找到了有关在 iphone 上使用 MapKit 工具的教程，运行应用程序模拟器时，我发现应用程序的标题名为“我的地图视图”。

我对单词进行了搜索，但在代码工作区中什么也没有。这是因为标题在 Mapkit 框架中自动显示为这个吗？我可以改变它吗？我将如何获得代码片段？

另外，我查看了 nib 文件，并且由于该应用程序已在地图中完全以编程方式编码，因此没有导航栏等。所有内容都已硬编码，这对我没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:40:46.587

好的，我发现如果我进入“MainWindow.xib”并双击导航控制器选项，会弹出根视图控制器笔尖，其中包含我正在寻找的内容 - 标题栏！

干杯

# android - Android：如果 AsyncTask 在单独的类中，如何从 AsyncTask 更新 UI？

> ID：12252654
> 
> 赞同：39
> 
> 时间：2012-09-03T18:36:20.773
> 
> 标签：android, android-activity, android-asynctask, updates

我讨厌内部阶级。

我有一个主要活动启动一个“短命”AsyncTask。

AsyncTask**在一个单独的文件**中，不是主要活动的内部类

我需要异步任务从主 Activity 更新 textView。

我知道如果 AsyncTask 是内部类，我可以从 onProgressUpdate 更新 TextView

但是如何从外部的、独立的、异步的任务中获取呢？

更新：这看起来像工作：

在活动中，我称之为任务

```
backgroundTask = new BackgroundTask(this);
backgroundTask.execute(); 
```

在我的构造函数中

```
public BackgroundTask(Activity myContext)
{
    debug = (TextView) myContext.findViewById(R.id.debugText);
} 
```

其中 debug 是 AsyncTask 的私有字段。

所以 onProgressUpdate 我可以

```
debug.append(text); 
```

谢谢大家的建议

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-09-03T18:44:52.010

AsyncTask 总是与 分开的类`Activity`，但我怀疑你的意思是它与你的活动类文件在不同的文件中，所以你不能从活动的内部类中受益。只需将 Activity 上下文作为参数传递给您的异步任务（即传递给它的构造函数）

```
class MyAsyncTask extends AsyncTask<URL, Integer, Long> {

    WeakReference<Activity> mWeakActivity;

    public MyAsyncTask(Activity activity) {
       mWeakActivity = new WeakReference<Activity>(activity);
    }

 ... 
```

并在您需要时使用（记住不要在 during 期间使用`doInBackground()`），即当您通常调用时

```
int id = findViewById(...) 
```

在你调用的 AsyncTask 中，即

```
Activity activity = mWeakActivity.get();
if (activity != null) {
   int id = activity.findViewById(...);
} 
```

请注意，我们`Activity`可以`doInBackground()`在进程中消失（因此返回的引用可以变为`null`），但是通过使用`WeakReference`我们不会阻止 GC 收集它（并泄漏内存），并且随着 Activity 消失，甚至尝试更新它通常是没有意义的状态（仍然，根据您的逻辑，您可能想要执行更改内部状态或更新数据库之类的操作，但必须跳过触摸 UI）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-07-03T11:31:25.427

使用接口 1) 创建一个接口

```
public interface OnDataSendToActivity {
    public void sendData(String str);
} 
```

2）在你的活动中实现它

```
public class MainActivity extends Activity implements OnDataSendToActivity{

     @Override
     protected void onCreate(Bundle savedInstanceState) {
          new AsyncTest(this).execute(new String[]{"AnyData"}); // start your task
     }

     @Override
     public void sendData(String str) {
         // TODO Auto-generated method stub

     }

} 
```

3) 在 AsyncTask(Activity activity){} 中创建构造函数在 AsyncTask 文件中注册您的接口并调用接口方法，如下所示。

```
public class AsyncTest extends AsyncTask<String, Integer, String> {

    OnDataSendToActivity dataSendToActivity;
    public AsyncTest(Activity activity){
        dataSendToActivity = (OnDataSendToActivity)activity;
    }

    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        dataSendToActivity.sendData(result);
    }

} 
```

在这里，您的 OnPostExecute 将在 AsyncTask 完成所有任务后调用，并将获取“结果”作为参数，由 doInBackground(){ return "";} 返回。

而“dataSendToActivity.sendData(result);” 它将调用活动的覆盖方法“public void sendData(String str) {}”。

要记住的一个极端情况：一定要传递`this`，即您当前活动的上下文，`AsyncTask`而不是创建您的活动的另一个实例，否则您`Activity`将被销毁并创建新的实例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-03T18:53:31.707

在您的活动类中创建一个静态函数，在其中传递上下文以更新您的文本视图，然后在您的 AsynkTask 类中调用此函数进行更新。

在 Activity 类中： public static void updateTextView(){

//你的代码在这里}

在 AynckTask 类中调用这个函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-03T18:41:50.503

只需在构造函数中将上下文（活动或其他）传递给您的 AsyncTask，然后在 onSuccess 或 onProgressUpdate 调用上下文中所需的任何内容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-03T18:54:54.853

我为这种场景写了一个 AsyncTask 的小扩展。它允许您将 AsyncTask 保存在单独的类中，但也使您可以方便地访问 Tasks 的完成：

```
public abstract class ListenableAsyncTask<Params, Progress, Result> extends AsyncTask<Params, Progress, Result>{

    @Override
    protected final void onPostExecute(Result result) {
        notifyListenerOnPostExecute(result);
    }

    private AsyncTaskListener<Result> mListener;
    public interface AsyncTaskListener<Result>{
        public void onPostExecute(Result result);
    }
    public void listenWith(AsyncTaskListener<Result> l){
        mListener = l;
    }
    private void notifyListenerOnPostExecute(Result result){
        if(mListener != null)
            mListener.onPostExecute(result);
    }

} 
```

所以首先你扩展 ListenableAsyncTask 而不是 AsyncTask。然后在您的 UI 代码中，创建一个具体实例并设置 listenWith(...)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-15T18:32:04.073

这个问题已经回答了，我还在贴我猜应该怎么做..

**主要活动类**

```
 public class MainActivity extends Activity implements OnClickListener
    {

        TextView Ctemp;

        @Override
        protected void onCreate(Bundle savedInstanceState)
        {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            Ctemp = (TextView) findViewById(R.id.Ctemp);
            doConv = (Button) findViewById(R.id.doConv);
            doConv.setOnClickListener(this);
        }

        @Override
        public void onClick(View arg0) // The conversion to do
        {
            new asyncConvert(this).execute();
        }
    } 
```

**现在在异步类中**

```
public class asyncConvert extends AsyncTask<Void, Void, String>
{
    SoapPrimitive response = null;
    Context context;

    public asyncConvert(Context callerclass)
    {
        contextGUI = callerclass;
    }
.
.
.
.
protected void onPostExecute(String result)
    {
        ((MainActivity) contextGUI).Ctemp.setText(result); // changing TextView
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-03T10:24:20.857

```
 /**
     * Background Async Task to Load all product by making HTTP Request
     * */
     public  static class updateTExtviewAsyncTask extends AsyncTask<String, String, String> {

        Context context;
        ProgressDialog pDialog;
        String id, name;

        String state_id;

        //--- Constructor for getting network id from asking method

        public  updateTExtviewAsyncTask(Context context,String id,String city) 
        {
            context   = context;
            state_id  = id;
            city_name = city;
        }       
        /* *
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() 
        {
            super.onPreExecute();
            pDialog = ProgressDialog.show(context, "","Please wait...", true, true);
            pDialog.show();

        }

        /**
         * getting All products from url
         * */
        protected String doInBackground(String... args) 
        {
            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog
         * **/
            protected void onPostExecute(String file_url)  {

                     YourClass.UpdateTextViewData("Textview data");
        }
    } 
```

// 将此代码放在您的活动类中，并声明更新文本视图静态

```
 public static void  UpdateTextViewData(String tvData) 
{
   tv.setText(tvData);
} 
```

# symfony - 特定国家的配置

> ID：12252656
> 
> 赞同：0
> 
> 时间：2012-09-03T18:36:40.853
> 
> 标签：symfony

我正在准备开发应支持不同国家/地区的应用程序，因此我需要以下支持：

*   货币
*   数字格式（用于价格等）

切换语言环境将基于[http://jmsyst.com/bundles/JMSI18nRoutingBundle](http://jmsyst.com/bundles/JMSI18nRoutingBundle)。

现在我需要存储有关特定于语言环境的信息，例如货币、货币除数、精度等 + 一些其他国家/地区特定的数据。

Symfony 2 中最好的方法是什么？我知道 SF2 表单中有一个 Money 字段类型，但我需要在整个应用程序中显示价格等，所以也许有一个捆绑包或其他可能有帮助的东西？

我不想将这样的信息存储在配置“参数”中，而是存储在数据库表中，然后使用 number_format，但也许有人有更好的想法？

我真的很感激这里的任何意见！:)

**编辑**

我又想到了一件事，每个国家/地区的验证限制可能不同，例如电话号码在德国可能有不同的长度，例如在英国。是否可以根据语言环境定义约束？还是我必须创建自己的约束并在该检查区域设置等内部？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:18:32.400

我最近偶然发现了这个捆绑包，可能就是你要找的东西： [https ://github.com/craue/TwigExtensionsBundle](https://github.com/craue/TwigExtensionsBundle)

# ruby-on-rails - 设置 Omniauth 身份以连接现有用户模型

> ID：12252657
> 
> 赞同：0
> 
> 时间：2012-09-03T18:36:42.833
> 
> 标签：ruby-on-rails, ruby-on-rails-3, omniauth, railscasts

我正在通过[这个 Railscast](http://railscasts.com/episodes/304-omniauth-identity)设置 Omniauth Identity，但我不清楚其中的一部分。他创建了一个名为 Identity 的新模型，该模型保存了电子邮件、姓名和密码字段。但是，我已经有一个包含这些字段的用户模型，所以我可以将 Identity 连接到它吗？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T20:40:48.663

由于目标是将“身份”与“用户”分开，因此不建议使用您的用户模型。创建一个新`identities`表并迁移每个用户的电子邮件、姓名和密码。现在您可以从用户模型中删除密码，并使用 OmniAuth 注册/登录。

如果您*必须*使用您的用户模型，您可以通过指定在配置中覆盖`:model => User`

# android - Android填充listview header

> ID：12252663
> 
> 赞同：0
> 
> 时间：2012-09-03T18:37:09.270
> 
> 标签：android, android-listview, baseadapter

我正在构建一个新闻应用程序。我想用来自 url 的数据在 ListView 中显示新闻。但我需要跳过第一行，而不是将数据放在第一行以显示 ListView 标题。这是用不同的布局膨胀的，但我不能修改这个适配器类。谁能帮我？

```
public class LazyAdapter extends BaseAdapter {

    private Activity activity;
    private ArrayList<HashMap<String, String>> data;
    private static LayoutInflater inflater=null;
    public ImageLoader imageLoader; 

    public LazyAdapter(Activity a, ArrayList<HashMap<String, String>> d) {
        activity = a;
        data=d;
        inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        imageLoader=new ImageLoader(activity.getApplicationContext());
    }

    public int getCount() {
        return data.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        View vi=convertView;
        if(position==0){
            vi = inflater.inflate(R.layout.list_row_main, null);
        }else{
            vi = inflater.inflate(R.layout.list_row, null);
        }

        TextView title = (TextView)vi.findViewById(R.id.title); // title
        TextView big_img = (TextView)vi.findViewById(R.id.einfo3); // artist name
        TextView author = (TextView)vi.findViewById(R.id.einfo1); // duration
        TextView datetimev = (TextView)vi.findViewById(R.id.tVdatetime);
        TextView story = (TextView)vi.findViewById(R.id.einfo2);
        ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

        HashMap<String, String> n = new HashMap<String, String>();
        n = data.get(position);

        // Setting all values in listview
        title.setText(n.get(Home.TAG_TITLE));
        author.setText(n.get(Home.TAG_AUTHOR));
        datetimev.setText(n.get(Home.TAG_DATETIME));
        story.setText(n.get(Home.TAG_STORY));
        thumb_image.setTag(n.get(Home.TAG_BIG_IMG));
        imageLoader.DisplayImage(n.get(Home.TAG_BIG_IMG), thumb_image);
        return vi;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:45:20.300

我建议使用[ListView.addHeaderView()](http://developer.android.com/reference/android/widget/ListView.html#addHeaderView%28android.view.View%29)。

```
listView.addHeaderView(getLayoutInflater().inflate(R.layout.list_row_main, null)); 
```

# ruby-on-rails - 轮胎未找到部分单词（搜索 2 个字段）

> ID：12252668
> 
> 赞同：1
> 
> 时间：2012-09-03T18:38:24.140
> 
> 标签：ruby-on-rails, elasticsearch, tire

我想做的事：

*   我有一个模型“项目”，其中包含我希望弹性搜索搜索的 2 个字段：标题和描述。
*   我希望搜索找到部分单词，例如：bicycl 应该与自行车、自行车等匹配...

现在的情况：

*   搜索只显示完美匹配

这是我现在在我的 Item 模型中拥有的内容：

```
 include Tire::Model::Search
 include Tire::Model::Callbacks

 class << self
   def search_index
     Tire.index(Item.index_name)
   end
 end

 settings :analysis => {
                    :filter => {
                      :my_ngram  => {
                        "type"     => "nGram",
                        "max_gram" => 10,
                        "min_gram" => 3 }
                    },
                    :analyzer => {
                      :my_analyzer => {
                         "type"         => "custom",
                         "tokenizer"    => "standard",
                         "filter"       => ["my_ngram"]
                       }
                    }
                  } do
   mapping do
     indexes :title,       boost: 10, analyzer: 'my_analyzer'
     indexes :description, boost: 5,  analyzer: 'my_analyzer'
   end
end

 def self.search(query_string)
   tire.search(load: true) do
     if query_string.present?
       query do
         string query_string, default_operator: "AND"
       end
     end
   end
 end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:00:38.090

当你这样做...

```
string query_string, default_operator: "AND" 
```

...你实际上是在寻找魔法`_all`领域。

我很确定您需要专门搜索使用 ngram 过滤器分析的字段才能正常工作。

```
should { string "title:#{query_string}", default_operator: "OR" }
should { string "description:#{query_string}", default_operator: "OR" } 
```

例如。

# javascript - 确定其所有者文档的 html 中 DOM 元素的字符索引？

> ID：12252669
> 
> 赞同：0
> 
> 时间：2012-09-03T18:38:41.130
> 
> 标签：javascript, html, dom

首先，我需要将选择范围转换为源 HTML 中的索引。我在想有几种方法可以手动完成，但是有内置的方法吗？

一些想法：

*   克隆文档。删除元素及其后续兄弟，并删除其每个祖先的所有后续兄弟。然后，您只需获取文档 HTML 并获取其长度。o_O

*   自己将标签、文本等渲染为 HTML，沿着 DOM 树向下走。还有o_O

通过缓存结果可以提高性能。然后，如果一个祖先已经知道它的位置，那么计算孩子的速度会更快一些。但是维护缓存是另一回事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:41:06.747

给它添加一个唯一的 ID 或类然后在整个文档字符串中搜索呢？

# jquery - jquery动画切换不起作用

> ID：12252671
> 
> 赞同：0
> 
> 时间：2012-09-03T18:39:23.487
> 
> 标签：jquery

```
<div>
    <a href="#" class="click">Click1</a>
</div>
<div class='classshow'>Toggle Text1</div>
<div>
    <a href="#" class="click">Click2</a>
</div>
<div class='classshow'>Toggle Text1</div> 
```

我的 Javastipt 代码：

```
$(".click").click(function () {
    $(".classshow").slideToggle("slow");
}) 
```

在这个实现中，问题是所有 div 都在切换，我只想在 div 旁边切换。请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:40:43.343

那是因为您正在选择所有具有 class 的元素`.show`。尝试以下操作：

```
$(".click").click(function() { 
   $(this).parent().next('.classshow').slideToggle("slow"); 
}) 
```

[小提琴](http://jsfiddle.net/n8HRr/1/)

您还可以使用`href`锚链接的属性来选择元素。

```
<div>
    <a href="#first" class="click">Click1</a>
</div>
<div class='classshow' id='first'>Toggle Text1</div>
<div>
    <a href="#second" class="click">Click2</a>
</div>
<div class='classshow' id='second'>Toggle Text1</div> 
```

```
$('.click').click(function(e){
  e.preventDefault(); // prevents the default action of the event.
  $(this.href).slideToggle();
}) 
```

# c# - 正确的 Json 反序列化

> ID：12252678
> 
> 赞同：0
> 
> 时间：2012-09-03T18:40:21.407
> 
> 标签：c#, twitter, visual-studio-2005, json.net, deserialization

好的，我会在这里尝试非常具体地解决我的问题。经过一些研究，我终于使我的代码工作（有点，因为它没有返回所需的结果）。我目前正在使用 JSON.net 并尝试反序列化以下 Json 字符串，该字符串是对 twitter API 的响应。

```
[{"created_at":"2012-09-03T18:22:54Z","locations":[{"name":"Globales","woeid":1}],"trends":[{"query":"%2327CosasSobreMi","name":"#27CosasSobreMi","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%2327CosasSobreMi","events":null},{"query":"%23AskTravis","name":"#AskTravis","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%23AskTravis","events":null},{"query":"%23WhyDoPeopleThinkItsOkayTo","name":"#WhyDoPeopleThinkItsOkayTo","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%23WhyDoPeopleThinkItsOkayTo","events":null},{"query":"%22We%20%3C3%20Justin%22","name":"We \u003C3 Justin","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22We%20%3C3%20Justin%22","events":null},{"query":"%22We%20Adore%20One%20Direction%22","name":"We Adore One Direction","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22We%20Adore%20One%20Direction%22","events":null},{"query":"%22Stefan%20Is%20Elena's%20Humanity%22","name":"Stefan Is Elena's Humanity","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22Stefan%20Is%20Elena's%20Humanity%22","events":null},{"query":"%22Eric%20Saade%20Come%20Back%20To%20Poland%22","name":"Eric Saade Come Back To Poland","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22Eric%20Saade%20Come%20Back%20To%20Poland%22","events":null},{"query":"Hlavackova","name":"Hlavackova","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=Hlavackova","events":null},{"query":"%22Serena%20Williams%22","name":"Serena Williams","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22Serena%20Williams%22","events":null},{"query":"%22Kire%C3%A7burnu%20%C3%87akallar%C4%B1%22","name":"Kire\u00e7burnu \u00c7akallar\u0131","promoted_content":null,"url":"http:\/\/twitter.com\/search\/?q=%22Kire%C3%A7burnu%20%C3%87akallar%C4%B1%22","events":null}],"as_of":"2012-09-03T18:25:18Z"}] 
```

包含对象和东西的常规 Json 字符串......除了我不知道开头和结尾的第一个“[，]”是什么之外，一位朋友指出了这一点。现在我为那个 Json 字符串做了一些类：

```
public class Location
{
    private string _name;
    private int _woeid;

    public string name { get { return _name; } set { value = _name; } }
    public int woeid { get { return _woeid; } set { value = _woeid; } }
}

public class Trend
{
    private string _query, _name, _url;
    private object _promoted_content, _events;

    public string query { get { return _query; } set { value = _query; } }           
    public string name { get { return _name; } set { value = _name; } }
    public object promoted_content { get { return _promoted_content; } set { value = _promoted_content; } }
    public string url { get { return _url; } set { value = _url; } }
    public object events { get { return _events; } set { value = _events; } }

}

public class RootObject
{
    private List<Location> _locations;
    private List<Trend> _trends;
    private string created_at_, _as_of;

    public List<Trend> trends { get { return _trends; } set { value = _trends; } }         
    public string created_at { get { return created_at_;} set { value = created_at_; } }
    public string as_of { get { return _as_of ;} set { value = _as_of; } }
    public List<Location> locations { get { return _locations; } set { value = _locations; }}
} 
```

我用来解除现实的方法是这样的：

```
WebClient client = new WebClient();
Stream stream = client.OpenRead(@"https://api.twitter.com/1/trends/1.json");
StreamReader reader = new StreamReader(stream);
string nvm = reader.ReadToEnd();
try
{
  List<RootObject> content = JsonConvert.DeserializeObject<List<RootObject>>(JsonString);
}
catch (System.Exception message)
{
    throw;
} 
```

我只是无法确定我的类是否错误，因为变量内容始终为 Null，并且我无法像使用 Visual Studio 2005 那样更改抽象定义。尝试更改类中的列表但无法使其工作。

我在 StackOverflow 中尝试了所有不同响应的不同方法，但它们似乎都使用了一些我无法使用的方法，或者常规反序列化对它们有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:46:02.353

您不需要任何这些类。只需使用`dynamic`

```
WebClient client = new WebClient();
string json = client.DownloadString("https://api.twitter.com/1/trends/1.json");

dynamic dynObj = JsonConvert.DeserializeObject(json);

foreach (var item in dynObj)
{
    foreach (var trend in item.trends)
    {
        Console.WriteLine("{0} - {1} - {2}",trend.query,trend.name,trend.url);
    }
} 
```

**编辑**

另一个没有的版本`dynamic`

```
var dynObj = (JArray)JsonConvert.DeserializeObject(json);
foreach (var item in dynObj)
{
    foreach (var trend in item["trends"])
    {
        Console.WriteLine("{0} - {1} - {2}",trend["query"],trend["name"],trend["url"]);
    }
} 
```

**编辑2**

```
JArray dynObj = (JArray)JsonConvert.DeserializeObject(json);
foreach (JObject item in dynObj)
{
    foreach (JObject trend in item["trends"])
    {
        Console.WriteLine("{0} - {1} - {2}",trend["query"],trend["name"],trend["url"]);
    }
} 
```

**编辑3**

```
for (int i = 0; i < dynObj.Count;i++)
{
    for (int j = 0; j < ((JArray) dynObj[i]["trends"]).Count;j++ )
    {
        JObject trend = (JObject)((JArray)dynObj[i]["trends"])[j];
        Console.WriteLine("{0} - {1} - {2}", trend["query"], trend["name"], trend["url"]);
    }
} 
```

# satisfiability - SAT求解器可以用来找到所有的解决方案吗？

> ID：12252684
> 
> 赞同：16
> 
> 时间：2012-09-03T18:40:49.613
> 
> 标签：satisfiability

*我写了一个我认为[非常有趣](https://stackoverflow.com/questions/12252203/can-a-sat-smt-solver-be-used-to-find-all-solutions)的问题的答案，但不幸的是，在我发布之前，该问题已被其作者删除。我在这里重新发布问题的摘要和我的答案，以防它可能对其他人有用。*

假设我有一个 SAT 求解器，给定一个联合范式的布尔公式，它返回一个解（满足公式的变量赋值）或问题不可满足的信息。

我可以使用这个求解器找到*所有*的解决方案吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T18:40:49.613

绝对有一种方法可以使用您描述的 SAT 求解器来找到 SAT 问题的所有解决方案，尽管它可能不是最有效的方法。

只需使用求解器找到原始问题的解决方案，添加一个除了排除刚刚找到的解决方案之外什么都不做的子句，使用求解器找到新问题的解决方案，等等。继续前进，直到遇到无法解决的问题。

* * *

例如，假设您想满足`(X or Y) and (X or Z)`. 有五种解决方案：

*   四用`X`真实，`Y`随意`Z`。

*   一有`X`假，一`Y`有`Z`真。

所以你运行你的求解器，假设它为你提供了解决方案`(X, Y, Z) = (T, F, F)`。你可以排除这个解决方案——并且只有这个解决方案——有约束

```
not (X and (not Y) and (not Z)) 
```

这个约束可以重写为子句

```
(not X) or Y or Z 
```

所以现在你可以在新问题上运行你的求解器

```
(X or Y) and (X or Z) and ((not X) or Y or Z) 
```

等等。

* * *

就像我说的，这是一种做你想做的事的方法，但它可能不是最有效的方法。当您的 SAT 求解器正在寻找解决方案时，它会了解很多关于该问题的信息，但它不会将所有这些信息返回给您——它只会为您提供它找到的解决方案。当您再次运行求解器时，它必须重新学习所有被丢弃的信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-09T13:37:41.833

当然可以。当 MiniSat[1] 找到解决方案时

```
s SATISFIABLE
v 1 2 -3 0 
```

（解决方案 1= `True`, 2= `True`, 3= `False`）然后您必须在原始 CNF[2] 中添加一个禁止此解决方案的子句：

```
-1 -2 3 0 
```

（这意味着 1 或 2 必须是`False`或 3 必须是`True`）。那你再解决。你这样做直到求解器返回UNSAT，即没有更多的解决方案。您将为每次迭代插入一个子句，每个子句将具有与解决方案相同的格式，除了它全部倒置并且`0`末尾有一个

使用 MiniSat 的 C++ 接口执行此操作要快得多，因为它可以保存中间数据并且迭代会更快。

[1] [http://minisat.se/](http://minisat.se/)

[2] [http://fairmut3x.wordpress.com/2011/07/29/cnf-conjunctive-normal-form-dimacs-format-explained/](http://fairmut3x.wordpress.com/2011/07/29/cnf-conjunctive-normal-form-dimacs-format-explained/)

# actionscript-3 - 在下一个关键帧 AS3 上显示动态变量

> ID：12252688
> 
> 赞同：0
> 
> 时间：2012-09-03T18:40:57.010
> 
> 标签：actionscript-3, flash, variables

我正在使用 AS3 创建游戏。游戏结束时，我需要在下一个关键帧上显示玩家的最终得分。当玩家与敌人发生碰撞时，玩家得分增加 1。

这是我更新分数的代码。

```
var playerScore:int = 0;

function updateTextFields():void
{
    playerScoreText.text = ("Score: " + playerScore);
}

function caught(enemy:MovieClip):void 
{
    enemy.removeEventListener(Event.ENTER_FRAME,dropEnemy);
    removeChild(enemy);
    playerScore++;
    updateTextFields(); 
} 
```

我需要在游戏结束屏幕上显示玩家的最终分数，但是因为 playerScore 的值是动态的并且递增一我不能只显示

```
playerScoreText.text = ("Score: " + playerScore); 
```

因为变量默认值为 0。

我已经尝试过，但我不知道如何使它工作。

```
var playerScore = playerScore; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:52:39.340

如果你想在每一帧中使用 var ，你必须把它放到一个类中（在 Main 函数之前）。此外，您应该使用公共或私有前缀。如果添加 private，则只能在此类中使用此变量，而 public 将使您能够在与该文件相关的每个类中使用它。使用 uint 而不是 int 也是个好主意。

例如，它应该如下所示：

```
package
{
       //import...
       public class Main extends //(you should write Sprite, MovieClip... there)
       {
            public var playerScore:uint = 0;
            public function Main()
            {
                //constructor
            }
       }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T05:13:32.723

如果你摆脱了`= 0`那么它应该工作。帧脚本将 playerScore 设置为 0。如果您只有声明`var playerScore:int;`，则该变量将默认为零，并且 Flash 不会将该语句添加`playerScore = 0`到帧脚本（每次到达特定帧时都会调用的函数）。

一般来说，最好显式地声明一个类。Flash 从添加到帧的脚本生成类的方式可能相当混乱，因为单个语句可能会出现在两个地方。例如，您上面的代码实际上将变为以下内容：

```
package filename_fla 
{
  public dynamic class MainTimeLine extends MovieClip
  {
    public var playerScore:int;

    internal function frame1:* 
    {
      playerScore = 0;
    }

    public function updateTextFields():void 
    {
      playerScoreText.text = ("Score: " + playerScore);
    }

    public function caught(enemy:MovieClip):void 
    {
      enemy.removeEventListener(Event.ENTER_FRAME,dropEnemy);
      removeChild(enemy);
      playerScore++;
      updateTextFields(); 
    }
  }
} 
```

# c# - VS2010 没有智能感知

> ID：12252691
> 
> 赞同：2
> 
> 时间：2012-09-03T18:41:15.117
> 
> 标签：c#, visual-studio-2010, visual-studio

在我的 VS2010 安装中，我根本没有智能感知。

我在这里查看了答案，选择了 Tools->Options 中的相关框，并且我尝试了也提到的“Ctrl-alt-space”快捷方式，但没有。

当我右键单击变量或将新行自动切换到正确的位置时，它甚至没有显示“转到定义”。

有什么提示吗？

我已经尝试修复我的安装 - 我不确定我尝试在我的第二个驱动器上安装它（然后我放弃了）是否导致了一些问题，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T19:46:00.257

作为记录，如果以后有人发现这个我不得不使用：

[http://archive.msdn.microsoft.com/vs2010uninstall](http://archive.msdn.microsoft.com/vs2010uninstall)

卸载然后重新安装VS2010。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:52:08.587

你有没有尝试过：

工具->导入和导出设置->选择“重置所有设置”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:49:34.390

我在vs2008中遇到了完全相同的问题。我的所有设置在工具 -> 选项 -> 文本编辑器 -> 所有语言 -> 语句完成中也是正确的。

经过大量搜索，我决定尝试**关闭每个开源文件，关闭解决方案并重新打开它。然后重新打开受影响的源文件。**这解决了我的问题，并且智能感知/转到定义恢复了全部功能。不幸的是，我无法用硬科学/任何逻辑来支持这一点，但它对我有用。很抱歉这个轶事回答，但我想我会分享。

这篇文章也可能有帮助： http: [//msdn.microsoft.com/en-us/library/ks1ka3t6 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/ks1ka3t6%28v=vs.71%29.aspx)

# c++ - 在 C 和 C++ 中包含和链接文件

> ID：12252693
> 
> 赞同：0
> 
> 时间：2012-09-03T18:41:33.873
> 
> 标签：c++, c, linker

> **可能重复：**
> [如何将目录添加到 C 标头包含路径？](https://stackoverflow.com/questions/4825652/how-do-i-add-a-directory-to-c-header-include-path)

我已经多次遇到这个问题，我认为最好从有经验的 C 或 C++ 程序员那里得到解释。在下面的示例中，我使用了示例库名称，但实际名称可以是任何名称。

假设我想运行以下 MWE：

```
#include <stdio.h>
#include <mylib/mylib.h> /* Also try mylib2/mylib/mylib.h */

int main (int argc, char **argv) {
    printf ("Hello, World!\n");
    return 0;
} 
```

此外，假设我有一个 Linux 发行版，而不是放在`mylib.h`中，而是`/usr/include/mylib/`选择目录`/usr/include/mylib2/mylib/`。所以简单的命令：

```
$ gcc test.c 
```

会因错误而失败：

```
fatal error: mylib.h: No such file or directory 
```

但我可能会尝试通过编写以下内容来修复包含语句：

```
#include <mylib2/mylib.h> 
```

这让我克服了第一个错误。但在内部，`mylib.h`以“通常”的方式引用其他头文件： `#include <mylib/anotherheader.h>`. 所以现在，即使我已经修复了 MWE 中的原始包含语句，`#include <mylib2/mylib/mylib.h>`因为构建中断，因为`mylib.h`它试图包含`#include <mylib/anotherheader.h>`而不是`#include <mylib2/mylib/anotherheader.h>`.

解决这个问题的标准方法是什么？必须有一个我缺少的简单编译标志。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:47:23.963

您设置包含路径，使其包含`/usr/include/mylib2`，通常与编译器类似的命令行选项`-I/usr/include/mylib2`。

请注意，通常标头包含来自同一包的相关文件，使用

```
#include "another.h" 
```

语法，以便首先在相对于它的安装位置进行搜索。如果您的图书馆已经这样做了，那么就没有问题了

```
#include <mylib2/mylib/mylib.h> 
```

但即使是这种情况，您也不希望您的代码依赖于您使用的库的安装位置。这种依赖关系应该保留在构建系统中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:46:28.373

我会推荐以下模式：

/usr/libs/lib15 - 是您的库所在的目录。

在代码中：

```
#include <stdio.h>
#include <mylib1.h>            // Header from your lib.
#include <mylib2.h>            // Other header from your lib.
#include <mygraphs/defines.h>  // Headers in your lib have even subdirectories. 
```

在命令行中：

```
cl -I /usr/libs/lib15 ..... 
```

您指定标题的搜索路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:47:18.040

请参阅 gcc 和 g++ 上的 -I 编译器标志，它允许您指定其他包含路径：

[http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)

在这种情况下，您可以指定： -I /usr/include/mylib2

和 #include "mylib/mylib.h" 无处不在

另外，这不是您的问题的一部分，但我想我还是会把它扔在那里，但是带引号的包含语句和尖括号之间存在细微差别：http: [//msdn.microsoft.com/en-us/库/36k2cdd4(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/36k2cdd4(v=vs.80).aspx)

# java - 要求以特定顺序实现 Java 函数

> ID：12252694
> 
> 赞同：0
> 
> 时间：2012-09-03T18:41:37.900
> 
> 标签：java

我在 Java 类中创建了未实现函数的层次结构，并且我想跟踪可以实现的函数，给定已经实现的函数。

例如，这里有一长串未实现的函数依赖关系，我想以编程方式对其进行分析，以确定哪些函数可以实现（给定已经实现的函数）。

```
//requires the functions b and c
public static void a(){

}

//does not require any functions to be implemented before being implemented
public static void b(){

}

//requires the function b
public static void c(){

}

public static void d(){ //requires the function a

}

public static void e(){ //requires the function a and c

}

public static void f(){ //requires the function a and c

}

//requires the functions a and f
public static void g(){

} 
```

有什么方法可以确定上面哪些功能可以在这里实现（给定一个已经实现的功能列表）？在 Javascript 中，解决这个问题很简单（因为可以在函数的原型中设置每个函数的属性），但是在 Java 中，我还没有找到简单明了的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:54:27.077

在您的示例中，您的所有方法都有实现，即使是空体。要检测到没有实现的方法，您需要将它们标记为抽象（您的类也将是抽象的），并且您需要编写一些反身代码。如果你想反省每个方法内部的代码，你可以处理它的堆栈跟踪。看看这里：[如何使用堆栈跟踪或反射找到方法的调用者？](https://stackoverflow.com/questions/421280/in-java-how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:03:11.323

接口的想法似乎非常适合您正在做的事情。`a`这是一个通过以下方式跟踪功能的接口层次结构`d`：

```
interface HasA extends HasB, HasC {
    public static void a();
}

interface HasB {
    public static void b();
}

interface HasC extends HasB {
    public static void c();
}

interface HasD extends HasA {
    public static void d();
} 
```

实现`HasA`（例如）的类不会编译，除非它定义了方法`a`、`b`和`c`.

# php - Quantlib 作为 SWIG 的 PHP 扩展

> ID：12252696
> 
> 赞同：0
> 
> 时间：2012-09-03T18:41:52.873
> 
> 标签：php, swig, quantlib

我想让一些 quantlib 功能可以从 Web 应用程序中使用，并且我已经开始开发 PHP 扩展来做到这一点。显然，这个想法不是让所有 quantlib api 都可以从 PHP 中获得，而是开发一些具有具体功能的模块。

因为我从未使用过 SWIG，所以我想知道通过 SWIG 进行操作的主要优点/缺点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T07:29:58.603

主要优点是已经通过 SWIG 向其他语言公开了大量功能，因此您可以在 PHP 模式下在现有接口上运行 SWIG，并且您可能会立即获得一些工作（您可能需要修补它们地方，但我预计不会有大问题）。请注意，暴露的类的数量也可能是一个缺点：生成的包装器可能会很大，因此您可能需要编辑接口并注释掉不需要的东西。

另一个缺点是，由于 SWIG 与语言无关，因此生成的包装器可能不是惯用的 PHP。不过，我不熟悉这种语言，所以我无法对此发表评论。

无论哪种方式，如果您想让扩展程序可用，请在邮件列表中给我们留言。如果您通过 SWIG，我们可以将您的补丁（如果有）添加到上游发行版。如果您以任何其他方式开发 QuantLib PHP 扩展，我们至少可以从 QuantLib 站点链接到它。

# javascript - 如何使用 Greasemonkey 单击此按钮？

> ID：12252701
> 
> 赞同：4
> 
> 时间：2012-09-03T18:42:34.617
> 
> 标签：javascript, click, greasemonkey

我是 JS 的新手，我正在尝试单击此按钮：

```
<a class="simplebutton" href="javascript:void(0);">find</a> 
```

这个按钮的 XPath 是： ，在[**这个 Fiddle**](http://jsfiddle.net/yd9TX/)`/html/body/div[5]/div/span[2]/a`可以看到目标页面的快照。[](http://jsfiddle.net/yd9TX/)

 **这是我尝试过的，但它不起作用。（我正在使用`getElementsByClassName`从[http://code.google.com/p/getelementsbyclassname/](http://code.google.com/p/getelementsbyclassname/)获得的功能）：

```
document.getElementsByClassName('simplebutton').submit(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T04:32:06.053

这是一个**完整的脚本**。它使用 jQuery 作为[:contains() 选择器](http://www.jqapi.com/#p=contains-selector)。

**更新：**修改脚本以说明报告的 AJAX。

```
// ==UserScript==
// @name     _Click on a specific link
// @include  http://YOUR_SERVER.COM/YOUR_PATH/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require  https://gist.github.com/raw/2625891/waitForKeyElements.js
// @grant    GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a major design change
    introduced in GM 1.0.
    It restores the sandbox.
*/

//--- Note that contains() is CASE-SENSITIVE.
waitForKeyElements ("a.simplebutton:contains('follow')", clickOnFollowButton);

function clickOnFollowButton (jNode) {
    var clickEvent  = document.createEvent ('MouseEvents');
    clickEvent.initEvent ('click', true, true);
    jNode[0].dispatchEvent (clickEvent);
} 
```

* * *

注意：在某些情况下，该`contains()`术语可能会错误地触发。例如，如果有一个`<a class="simplebutton">unfollow</a>`按钮。
这是防止错误点击的一种方法。像这样修改`clickOnFollowButton`函数：

```
function clickOnFollowButton (jNode) {
    if ( ! /^\s*follow\s*$/i.test (jNode.text() ) ) {
        /*--- If the node contains anything but "follow" (surrounded by 
            optional whitespace), don't click it.
        */
        return false;
    }
    var clickEvent  = document.createEvent ('MouseEvents');
    clickEvent.initEvent ('click', true, true);
    jNode[0].dispatchEvent (clickEvent);
} 
```

* * *

几件事：

1.  [`getElementsByClassName()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)返回元素的列表或“集合”。你不能只是`.submit()`这样的结果。`.submit()`用于单个元素。

2.  由于这是一个链接`.submit()`不起作用。`.click()`通常会起作用，但通常不会 - 当链接由事件侦听器授权时（这个问题必须是这种情况）。

    上面给出的`clickEvent`代码几乎适用于所有情况。

3.  [您提供的页面代码](http://jsfiddle.net/yd9TX/)没有任何链接，`class="simplebutton"`并且文本包含`find`！

4.  你使用的是什么浏览器？哪个 Greasemonkey 版本？什么操作系统？

5.  查找并使用适当的 javascript 参考和适当的 DOM 参考。问题中列出的参考适用于非标准*库*且未包含在您的脚本中（很可能）。

    *   [MDN JavaScript 参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference)是最新的，最适用于 Greasemonkey（Firefox*扩展*）应用程序。
    *   同样，[MDN 文档对象模型 (DOM) 参考](https://developer.mozilla.org/en-US/docs/DOM)。

6.  对于这种事情，使用 CSS 路径，它比 XPATH 容易得多。Firebug 将显示给定元素的 CSS 路径。
    jQuery 使用 CSS 选择器/路径，就像`document.querySelector()`（非 jQuery 方法）一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:47:24.240

您需要使用方法[`click`](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-2651361)而不是`submit`. 您可以[`submit`](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-40002357)在要提交表单时使用。

`getElementsByClassName`还返回一个元素数组，您需要检索您想要的元素然后调用`click`它。

```
document.getElementsByClassName('simplebutton')[0].click();​ 
```

[http://jsfiddle.net/kLDde/](http://jsfiddle.net/kLDde/)**

# java - 置换一个字符串

> ID：12252704
> 
> 赞同：2
> 
> 时间：2012-09-03T18:42:45.087
> 
> 标签：java, string, algorithm, permutation

给定字符串，打印它的所有排列。为此，我想出了以下程序。

```
public static char[] swap(char[] input, int i, int j) {
        char temp;
        temp = input[i];
        input[i] = input[j];
        input[j] = temp;

        return input;

    }

    /**
     * 
     * @param args
     */

    public static void permuteStrings(char[] inputString, int start, int finish ) {
        //Base case: When there is only single element, print the string
        if(start == finish) 
            System.out.println(inputString);
        else {
            //Recursive case: Swap first element with all the elements and permute on the 
                           // rest of string.
            for(int i = start; i <= finish; i++) {
                inputString = swap(inputString, start, i);
                permuteStrings(inputString, i + 1, finish);
                inputString = swap(inputString,start, i); //restoring the original string
            }
        }
    } 
```

但是，对于给定的输入 ABC，它打印的所有内容都是

```
ABC
BAC 
```

我似乎无法弄清楚问题是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:52:13.377

想通了问题。问题出在函数调用中：

`permuteStrings(inputString, i + 1, finish);`.

正确的方法是：

```
permuteStrings(inputString, start + 1, finish); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-18T18:13:02.107

使用递归

```
public static void permutation(String str) 
{ 
permutation("", str); 
}
private static void permutation(String prefix, String str) {
int n = str.length();
if (n == 0) 
 System.out.println(prefix);
else 
{
    for (int i = 0; i < n; i++)
     permutation(prefix + str.charAt(i), str.substring(0, i) + str.substring(i+1, n));
}
} 
```

# c# - 我在 HttpWebRequest.GetResponse() 上立即收到 WebException：“操作已超时”

> ID：12252707
> 
> 赞同：3
> 
> 时间：2012-09-03T18:42:56.823
> 
> 标签：c#, multithreading, exception-handling, httpwebrequest, timeout

我在多线程环境中大量抓取网页的内容。我需要一个可靠的下载器组件，它可以容忍临时服务器故障、连接断开等。下面是我的代码的样子。

现在，我一遍又一遍地遇到一个奇怪的情况：一切都开始得很完美。10 个线程同时拉取数据大约 10 分钟。**在那之后，我在调用我的请求对象的 GetResponse 方法后**立即开始收到带有超时的 WebException 。休息一下（让线程入睡）没有帮助。只有当我停止应用程序并重新启动它直到接下来的 10 分钟过去并且问题再次出现时，它才会有所帮助。

我已经尝试过但没有任何帮助：

*   通过“使用”语句显式关闭/处理响应对象
*   调用 request.Abort 它可以帮助的任何地方
*   在 ServicePointManager/ServicePoint 和 WebRequest 级别操作超时（延长/缩短超时间隔）
*   操作 KeepAlive 属性
*   调用 CloseConnectionGroup
*   操纵同时运行的线程数

没有什么帮助！因此，这似乎是一个错误，或者至少是记录非常差的行为。我在 Google 和 Stackoverflow 上看到了很多关于此的问题，但没有一个得到完全回答。基本上人们会从上面的列表中提出其中一项建议。我都试过了。

```
 public TResource DownloadResource(Uri uri)
    {
        for (var resourceReadingAttempt = 0; resourceReadingAttempt <= MaxTries; resourceReadingAttempt++)
        {
            var request = (HttpWebRequest)WebRequest.Create(uri);
            HttpWebResponse response = null;
            for (var downloadAttempt = 0; downloadAttempt <= MaxTries; downloadAttempt++)
            {
                if (downloadAttempt > 0)
                {
                    var sleepFor = TimeSpan.FromSeconds(4 << downloadAttempt) + TimeSpan.FromMilliseconds(new Random(DateTime.Now.Millisecond).Next(1000));
                    Trace.WriteLine("Retry #" + downloadAttempt + " in " + sleepFor + ".");
                    Thread.Sleep(sleepFor);
                }
                Trace.WriteLine("Trying to get a resource by URL: " + uri);

                var watch = Stopwatch.StartNew();
                try
                {
                    response = (HttpWebResponse)request.GetResponse();
                    break;
                }
                catch (WebException exception)
                {
                    request.Abort();
                    Trace.WriteLine("Failed to get a resource by the URL: " + uri + " after " + watch.Elapsed + ". " + exception.Message);
                    if (exception.Status == WebExceptionStatus.Timeout)
                    {
                        //Trace.WriteLine("Closing " + request.ServicePoint.CurrentConnections + " current connections.");
                        //request.ServicePoint.CloseConnectionGroup(request.ConnectionGroupName);
                        //request.Abort();
                        continue;
                    }
                    else
                    {
                        using (var failure = exception.Response as HttpWebResponse)
                        {

                            Int32 code;
                            try { code = failure != null ? (Int32)failure.StatusCode : 500; }
                            catch { code = 500; }

                            if (code >= 500 && code < 600)
                            {
                                if (failure != null) failure.Close();
                                continue;
                            }
                            else
                            {
                                Trace.TraceError(exception.ToString());
                                throw;
                            }
                        }
                    }
                }
            }

            if (response == null) throw new ApplicationException("Unable to get a resource from URL \"" + uri + "\".");
            try
            {
                // response disposal is required to eliminate problems with timeouts
                // more about the problem: http://stackoverflow.com/questions/5827030/httpwebrequest-times-out-on-second-call
                // http://social.msdn.microsoft.com/Forums/en/netfxnetcom/thread/a2014f3d-122b-4cd6-a886-d619d7e3140e

                TResource resource;
                using (var stream = response.GetResponseStream())
                {
                    try
                    {
                        resource = this.reader.ReadFromStream(stream);
                    }
                    catch (IOException exception)
                    {
                        Trace.TraceError("Unable to read the resource stream: " + exception.ToString());
                        continue;
                    }
                }
                return resource;
            }
            finally
            {
                // recycle as much as you can
                if (response != null)
                {
                    response.Close();
                    (response as IDisposable).Dispose();
                    response = null;
                }
                if (request != null)
                {
                    //Trace.WriteLine("closing connection group: " + request.ConnectionGroupName);
                    //request.ServicePoint.CloseConnectionGroup(request.ConnectionGroupName);
                    request.Abort();
                    request = null;
                }
            }
        }
        throw new ApplicationException("Resource was not able to be acquired after several attempts.");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T10:47:09.047

我有同样的问题我在互联网上搜索了很多，我得到了 1 个解决方案，一次固定线程数。你必须一次控制线程数，我已经开始一次使用 2-3 个线程. 也使用这个`ServicePointManager.DefaultConnectionLimit = 200;` 这将真正帮助你。

# java - 可以在 Windows 环境变量中对修改进行单元测试吗？

> ID：12252708
> 
> 赞同：0
> 
> 时间：2012-09-03T18:43:02.940
> 
> 标签：java, unit-testing, environment-variables

我的过程只是简单地向系统变量添加一些内容`PATH`。实际上，我正在`Process`使用以下方法执行此操作`setx.exe`：

```
public void changePath(String newPath ) {
  String path = System.getenv("PATH") + ";";
  String[] cmd = new String[]{"C:\\Windows\\System32\\setx.exe", "PATH", 
      path+newPath, "-m"};
  ProcessBuilder builder = new ProcessBuilder(cmd);
  ...
} 
```

所以我试着给它写一个测试用例。

```
Class UpdatePathTest {

  @Test
  public void testUpdatePath() {
    //call the method that update the path
    changePath("C:\\somebin");
    assertTrue(System.getenv("PATH").contains("C:\\somebin")); //fails
    // ProcessBuilder with command String[]{"cmd", "/C", "echo", "%PATH%"}; will fail too.
    //and the above in a new Thread will fail too.
  }

} 
```

那么，有没有办法获得新的 PATH 值？编写新路径是唯一的选择，因为我正在开发一个将安装桌面应用程序的 jar。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:48:00.377

我不确定在单元测试中更改路径是否是个好主意。如果测试失败怎么办？您必须确保完成所有相关的整理工作。

考虑反转你的依赖并使用依赖注入。

[我认为这篇](http://www.codeproject.com/Articles/35881/Simplified-Mocking-with-Dependency-Injection-for-U "这个")文章解释得很好。

因此，而不是有一个方法：

```
public void method() {
    String path = System.getenv("PATH") + ";";
    //do stuff on path
} 
```

考虑做：

```
public void method(String path) {
    //do stuff on path
} 
```

这允许您存根路径。如果您无法更改方法的签名，请考虑使用工厂模式并使用测试工厂来获取路径。

## 编辑：更新问题后

您在这里必须考虑的是您正在测试的内容。当您调用 C:\Windows\System32\setx.exe 时，您已阅读 API 文档并使用正确的参数调用它。这很像在 java API 上调用另一个方法。例如，如果您正在操作一个您“知道”的列表，它是从零开始的。您无需对此进行测试，您只需阅读 API，社区就会支持您。对于测试 changePath，我认为您可能需要测试 ProcessBuilder 中的内容。同样，您已经阅读了 API 文档，并且您必须假设您正在传递正确的变量。（参见底部的//1）并且您必须再次假设 ProcessBuilder 工作正常，并且 Oracle（或很可能是 Sun）人员已将其实现到 API 文档中。

因此，您要做的是检查您是否将变量传递给 ProcessBuilder，这些变量与您理解的规范相匹配。为此，您可以模拟 ProcessBuilder，然后验证您是否传递了正确的参数并在此类上调用了正确的方法。

一般来说，它很难测试，因为您不想测试 windows 功能，但想测试 java 与它们的交互。

//1 我在调用这个外部命令时遇到的主要问题是正确理解 API 文档或设置命令。通常你必须拿出命令行并检查你是否正确使用了方法（尤其是 cmd 函数）。这可能意味着您要弄清楚如何使用 cmd 函数，将其编码到 ProcessBuilder 中，然后在 ProcessBuilder/test 上编写测试（反之亦然） 这不是理想的方式，但有时文档很难理解。

# jquery - $.Callbacks().disable() 与 $.Callbacks().lock()

> ID：12252709
> 
> 赞同：6
> 
> 时间：2012-09-03T18:43:05.090
> 
> 标签：jquery

两者的 jQuery 文档基本上都说明了相同的事情，所以我想知道两者之间是否有任何重大差异（如果有的话）。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-03T19:05:33.643

这方面的文档实际上非常糟糕，所以这是我通过[研究源代码](https://github.com/jquery/jquery/blob/master/src/callbacks.js)发现的：

**[`lock`](http://api.jquery.com/callbacks.lock/)只阻止未来的[`fire`](http://api.jquery.com/callbacks.fire/)调用，但不阻止函数被[`add`](http://api.jquery.com/callbacks.add/)编辑。**

* * *

以下是这些方法的简要介绍：

*   [**`empty`**](https://github.com/jquery/jquery/blob/master/src/callbacks.js#L142-146)- 删除迄今为止注册的所有回调。
*   [**`lock`**](https://github.com/jquery/jquery/blob/master/src/callbacks.js#L156-163)- 阻止对 的进一步调用`fire`，但允许`add`编辑更多回调。
*   [**`disable`**](https://github.com/jquery/jquery/blob/master/src/callbacks.js#L147-151)- 防止对`fire`&的进一步调用`add`。

* * *

为了理解这一切，让我们从[对`memory`标志](http://api.jquery.com/jQuery.Callbacks/#supported-flags)的解释开始：

如果回调对象是用`memory`标志构造的，它会跟踪最后一次`fire`调用，以后添加的任何回调都会立即被调用。这是[一个例子](http://jsfiddle.net/GyxwA/)：

```
var callbacks = $.Callbacks('memory');

callbacks.add(function(){
    console.log('first');
});

callbacks.fire();

callbacks.add(function(){
    console.log('second');
}); 
```

这也会记录***second***，即使它是在`fire`调用之后添加的。

* * *

但是，如果您`disable`这样做，它将完全擦除内存。这是[另一个例子](http://jsfiddle.net/GyxwA/3/)：

```
var callbacks = $.Callbacks('memory');

callbacks.add(function(){
    console.log('first');
});

callbacks.fire();
callbacks.disable();

callbacks.add(function(){
    console.log('second');
});

callbacks.fire(); 
```

这只会记录***first***，因为`callbacks`在添加第二个功能之前已被禁用。

* * *

但是，如果您改用它，*则将*`lock`调用稍后添加的函数。这是[另一个例子](http://jsfiddle.net/GyxwA/4/)：

 *```
var callbacks = $.Callbacks('memory');

callbacks.add(function(){
    console.log('first');
});

callbacks.fire();
callbacks.lock();

callbacks.add(function(){
    console.log('second');
});

callbacks.fire(); 
```

这也会记录***second***，但只有一次；由于对象被`lock`编辑，任何进一步的调用都`fire`将被忽略。*

# c# - 从局部变量中移除事件监听器

> ID：12252711
> 
> 赞同：0
> 
> 时间：2012-09-03T18:43:27.300
> 
> 标签：c#, events, event-handling, event-listener

我是否必须担心删除分配给局部变量的事件侦听器？

考虑以下示例：

```
var zipUtil = new ZipUtil();
zipUtil.ProgressChanged += ZipUtil_ProgressChanged; 
```

我正在创建一个`ZipUtil`类的实例，该实例存储为方法中的局部变量。我是否必须`zipUtil.ProgressChanged -= ZipUtil_ProgressChanged;`在方法终止之前删除侦听器 ( ) 还是可以跳过该步骤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:46:46.803

不，您不必删除该事件处理方法。

将事件处理程序添加到事件时，会创建从（包含该事件的对象）事件到事件处理程序的引用，而不是相反。一旦`zipUtil`超出范围，事件处理程序将不会对`zipUtil`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:55:18.200

两行代码永远不足以准确地进行调用。但是您不太可能需要明确取消订阅。有两种可能的问题场景：

*   例如，在您的对象被释放后，该类可能会在不合时宜的时间触发其事件。在这种情况下，这不太可能发生，当您停止调用其方法时，ZipUtil 类肯定会停止引发 ProgressChanged 事件。并非*完全*不可能，例如，它可以在后台线程上工作。从您的代码段中看不到。

*   由于事件，您可能会遇到垃圾收集问题。事件委托保留对您的类对象的隐式引用，这是必要的，因此它可以调用 ZipUtil_ProgressChanged() 方法。如果它是实例方法，则从您的代码段中不清楚。该参考将使您的外部班级保持活力。但不是反过来。鉴于 ZipUtil 对象的生命周期仅限于方法，并且您肯定希望外部类至少能存活到方法结束，这绝不是问题。

ZipUtil 实现 IDisposable btw 的可能性很高。如果确实如此，请确保使用*using语句。*

# javascript - Facebook Like 按钮创建对于我的网站来说是“错误的”？

> ID：12252713
> 
> 赞同：-1
> 
> 时间：2012-09-03T18:44:28.283
> 
> 标签：javascript, facebook, facebook-like

好吧，奇怪的问题。我的网站（DealsMatrix.net）上有一个类似 Facebook 的按钮。我失去了我的主机，不得不移动我所有的文件等等。

我得到了新的主机，并且使用相同的代码，Facebook 的“喜欢”按钮不起作用。我去了 Facebook 开发网站 ( [http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/) ) 创建一个新网站。

**然而，当我在我的网站（[http://dealsmatrix.net/](http://dealsmatrix.net/)）中加入 www. 与否，它显示一个空白框。其他所有网站都适合我。**

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T21:12:01.867

您已将 appId 包含在您的网页中：

`js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=102588413138554";`

这意味着您当前的主机名必须与[https://developers.facebook.com/apps](https://developers.facebook.com/apps)
上的信息相匹配， 这是您首次注册网站信息的地方

但是通常一个like按钮可以在任何地方，所以src可以简单地`js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";`检查它以查看它是否解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T06:37:33.417

尝试将其包含在您的标题中：

```
<script src="//connect.facebook.net/en_US/all.js"></script> 
```

# ios - 从 UIManagedDocument 到传统的核心数据堆栈

> ID：12252715
> 
> 赞同：1
> 
> 时间：2012-09-03T18:44:34.437
> 
> 标签：ios, core-data

我使用 UIManagedDocument 创建了一个新应用程序。虽然在我的设备上一切都很好，但我得到了很多差评，因为在其他设备上存在问题 :( 经过大量阅读和测试，我决定回到传统的 Core Data 堆栈。但是什么是最好的使用应用程序执行此操作的方法，该应用程序已在应用程序商店中？如何构建此更新？我应该注意什么？

谢谢，斯特凡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T00:04:02.463

我认为您最好确定 UIManagedDocument 的问题并解决它们。

但是，如果你想去普通的 MOC，你只需要担心几件事。最大的问题是 UIMD 将内容存储在文件包中，根据您的选择，您可能不得不担心更改日志。

最后，如果你想要一个单独的 sqlite 文件，并且你想减少混淆的可能性，你有一个类可以简单地打开你的 UIManagedDocument，并获取每个对象，然后将它复制到你的新 MOC 的单个 sqlite 文件中。

现在，您应该不需要不同的对象模型，因此您不应该有任何迁移问题。

然后，只需删除包含 UIManagedDocument 的文件包，并仅使用您的单个文件 sqlite 存储。

基本上，在启动时，您尝试打开 UIManagedDocument。如果它打开，加载每个对象并将其复制到新数据库中。然后删除它。

从那时起，你应该很高兴。

但是请注意，您现在可能会遇到一些 UI 延迟，因为所有数据库 IO 都发生在主 UI 线程上。要解决此问题，您可能需要使用单独的 MOC，并通过正常的 COreData 通知机制来协调更改。有大量的文档、示例和教程。

**编辑**

> 感谢您的回答。我对这些问题的问题是，我无法重现它们。我所有的设备都工作正常。但是我收到了很多邮件，关于这样的问题： - 重复条目 - 停止并重新启动应用程序后没有数据 - 有人说，应用程序可以正常工作几天并停止工作（没有新数据）。这些都是奇怪的事情，不会发生在我的设备上。所以对我来说，最好的方法是回到普通的 MOC。我的数据库没有保存很多用户生成的数据，所有数据都是从 web 服务加载的，所以删除数据并开始使用新数据库是没有问题的。– 乌克曼

重复条目。这听起来像是与临时/永久 ID 相关的错误。有很多关于那个的帖子。这是一个：[Core Data could not fullfil fault for object after gettingPermanantIDs](https://stackoverflow.com/questions/11321717/core-data-could-not-fullfil-fault-for-object-after-obtainpermanantids/11996211#11996211)

不保存。听起来您没有为 UIManagedDocument 使用正确的 API。您需要确保不直接保存 MOC，并使用撤消管理器或调用`updateChangeCount:`通知 UIManagedDocument 它有您要保存的脏数据。同样，也有很多关于此的帖子。搜索`updateChangeCount`。

但是，您最了解您的应用程序，使用纯 Core Data 可能会更好、更容易。

请记住，如果您从 Web 进行大量导入，请使用单独的 MOC，并让您的主 MOC 监视 DidSave 通知，以使用新导入的数据进行自我更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:14:41.253

UIManagedDocument 是一种特殊的文档，它是 UIDocument 的子类，它使用 Core Data Framework 存储其数据。因此，它结合了文档架构和核心数据能力的强大功能。

你可以从 Document Based App Programming Guide for iOS 中了解更多关于基于文档的架构，我推荐 WWDC2011 Storing Documents in iCloud using iOS5 session video。我还推荐斯坦福 CS193P：iPad 和 iPhone 应用程序开发（2011 年秋季）第 13 讲。

当您调用 saveToURL:forSaveOperation:completionHandler: 时创建的是 UIManagedDocument 和 UIDocument 的实现细节，您不应该真正担心或依赖它。然而，在当前实现中，正在创建一个包含 sqlite 数据库文件的文件夹。

不会。所有实体都将包含在一个数据库文件中，通常也称为：持久存储。可以使用多个持久存储，但这些是更高级的用例，UIManagedDocument 当前使用一个。

UIManagedDocument 的上下文是指来自底层核心数据框架的 NSManagedObjectContext。UIManagedDocument 实际上并行操作其中两个以将 IO 操作分拆到后台线程。当谈到上下文本身的性质时，这里引用核心数据编程指南：

您可以将托管对象上下文视为智能便签本。当您从持久存储中获取对象时，您将临时副本带到便笺簿上，它们在此处形成对象图（或对象图的集合）。然后，您可以随意修改这些对象。但是，除非您实际保存这些更改，否则持久存储将保持不变。

但是，看看我在上面发布的讲座和其他材料，以大致了解所使用的技术以及它们在不同情况下对开发人员的潜在价值，确实是一个好主意。

# android - android的sqlite日期格式

> ID：12252718
> 
> 赞同：0
> 
> 时间：2012-09-03T18:45:00.020
> 
> 标签：android, sqlite, simpledateformat

我在**SQLITE**中有一个带有`DATETIME`列的表。我做了一个 SQL 语句，用 now() 填充它

我想检索它并将其解析为 Java 中的 Date 对象，代码如下：

```
SimpleDateFormat simpleDateFormat = new SimpleDateFormat
("yyyy-MM-ddHH:mm:ss",Locale.ENGLISH);
simpleDateFormat.setTimeZone(TimeZone.getTimeZone("UTC")); 
```

然后我通过以下方式获取日期：

```
Date d = simpleDateFormat.parse
(recordset.getString(recordset.getColumnIndex("storedate"))); 
```

我得到 parse exception: unparceable date （我猜它与格式有关。任何人都可以告诉我它应该是哪种格式或错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:00:14.063

尝试这个 ：

```
simpleDateFormat.format(
  new Date(
    recordset.getString(
      recordset.getColumnIndex("storedate")
))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:14:06.727

我发现它是什么。我不得不将格式更改为此：

```
"EEE MMM dd HH:mm:ss Z yyyy" 
```

现在它可以工作了。猜猜 SQLite 默认以这种格式存储日期时间对象。

# php - PHP数组合并：不是数组吗？

> ID：12252723
> 
> 赞同：0
> 
> 时间：2012-09-03T18:45:21.783
> 
> 标签：php, arrays, function, multidimensional-array, merge

我正在尝试合并通过函数创建时拥有的数组

我有一个函数，它返回一个数组。

```
class myarray
{
 public function getAr($id)
   {
      // mysql query
      while($dd= $database->fetch(PDO::FETCH_ASSOC))
           {
               $data[] = $dd; //there's values in the array when its being populated through the function of the while loop
           }
               return $data;
   }
 public function get3($id)
   {
      // mysl query
      while($dd= $database->fetch(PDO::FETCH_ASSOC))
           {
               $data[] = $dd; //there's values in the array when its being populated through the function of the while loop
           }
               return $data;
   }    
} 
```

为什么我试图将数组合并在一起：

```
$get = new myarray();

while($row = $fet->fetch(PDO::FETCH_ASSOC))
{
    $arrayAr = $get->getAr($id);
    $array3 = $get->get3($id);
    $new_array = array_merge($arrayAr ,$array3); //this gives me the error
    print_r($arrayAr); //displays array
}
    print_r($arrayAr); //displays nothing, why is that? 
```

它说它不是一个数组？

```
array_merge() [function.array-merge]: Argument #1 is not an array 
```

但我可以`print_r($arrayAr);`，它就像一个while循环内的数组，但它不显示它之外的任何东西？

当我尝试这个...

```
$new_array = array_merge((array)$arrayAr ,(array)$array3); 
```

它不会显示错误，但也不会合并。

帮助？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:48:52.957

你`$arrayAr`是局部变量，第二个`print_r()`超出了他的变量范围。如果您需要更广泛地使用它`foreach`，请在 ie之前“声明”它`$arrayAr = array();`（或您想要的任何值 - 在这种情况下它并不重要，但`array()`会使代码清晰）。

# objective-c - 在 iOS 类扩展中定义属性

> ID：12252725
> 
> 赞同：12
> 
> 时间：2012-09-03T18:45:24.603
> 
> 标签：objective-c, automatic-ref-counting, ios5.1

我想在类扩展中向 UITableView 添加一个属性：

```
@interface UITableViewController ()

@property NSString *entityString;

@end 
```

然后我导入扩展，然后在 UITableViewController 的子类中使用 entityString 属性：

```
@implementation CustomerTableViewController

- (void)viewDidLoad {
    self.entityString = @"Customer";
    ...
    [super viewDidLoad];
}
... 
```

[苹果文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html#//apple_ref/doc/uid/TP40011210-CH6-SW1)说：

> 编译器将在主类实现中自动合成相关的访问器方法（...）。

但是当我尝试执行它时，我得到了这个错误：

> -[CustomerTableViewController setEntityString:]：无法识别的选择器发送到实例 0x737b670

我究竟做错了什么？也许子类无法访问该属性？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-03T18:57:57.957

尝试使用具有关联引用的类别。它更干净，适用于 UIButton 的所有实例。

```
UIButton+Property.h

#import <Foundation/Foundation.h>

@interface UIButton(Property)

@property (nonatomic, retain) NSObject *property;

@end

UIButton+Property.m

#import "UIButton+Property.h"
#import <objc/runtime.h>

@implementation UIButton(Property)

static char UIB_PROPERTY_KEY;

@dynamic property;

-(void)setProperty:(NSObject *)property
{
  objc_setAssociatedObject(self, &UIB_PROPERTY_KEY, property, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
}

-(NSObject*)property
{
   return (NSObject*)objc_getAssociatedObject(self, &UIB_PROPERTY_KEY);
}

@end 
```

//示例用法

```
#import "UIButton+Property.h"

UIButton *button1 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
button1.property = @"HELLO";
NSLog(@"Property %@", button1.property);
button1.property = nil;
NSLog(@"Property %@", button1.property); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-03T19:42:04.670

类*扩展*用于声明额外的接口——方法和属性——其实现契约将在类的 primary 中得到满足`@implementation`。

这正是您不能通过类扩展添加存储——添加 ivars 的原因。类扩展是一个接口，不多也不少。 `@synthesize`是为`@property`声明创建存储的原因，但`@synthesize`an`@property`只能出现在`@implementation`类中（无论是显式的还是作为编译器的默认行为）。

由于您无法重新编译框架类，因此无法向其中添加 ivars。

@prashat 的答案是向现有类添加存储的一种方法。然而，走这条路通常是不可取的。随意挂起框架类的状态是设计不佳的标志，并且随着时间的推移会使您的应用程序变得更加难以维护。

更好地重新审视您的设计，了解为什么您目前需要将状态附加到不能直接包含它的对象，然后重构该要求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-03T18:55:30.503

文档状态：

> 类扩展类似于匿名类别，只是它们声明的方法必须在相应类的主 @implementation 块中实现。

使用`@property`时，大致相当于*声明*访问器方法。所以这意味着你只能做这样的事情，如果你也是`@implementation`类的“主”块的作者，而 UITableViewController，你不是。

您在这里唯一的选择是类别，它不能添加实例变量。

[文档链接](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)，并注意该页面的最后一行：

> setValue: 方法的实现必须出现在该类的主 @implementation 块中（您不能在类别中实现它）。如果不是这种情况，编译器会发出一条警告，指出它找不到 setValue: 的方法定义。

# javascript - Trigger.io 协作

> ID：12252726
> 
> 赞同：9
> 
> 时间：2012-09-03T18:45:34.087
> 
> 标签：javascript, git, github, trigger.io

嘿，我正在与 Trigger.io 项目合作，我很好奇是否有关于如何最好地做到这一点的文档？我有其他人正在使用 TriggerToolkit 将我的项目加载到他们的环境中（通过 github），他们无法运行这些项目，因为与 identity.json 存在冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T00:10:45.393

我们正在研究一种更简单的团队协作方式，但目前导入和现有 Trigger.io 的过程将类似于我们的一个演示应用程序的说明： [https ://github.com/amirnathoo/Sales-正方形](https://github.com/amirnathoo/Sales-Square)

基本上，您创建的每个应用程序都有一个独特的`src/identity.json`文件，该文件也特定于您的帐户。`src`您应该避免签入您的 src/identity.json 文件，并且协作者应该通过创建一个新应用程序然后将您的代码复制到目录中来创建自己的文件。

**更新**：我们现在与上周宣布的项目发布实现了更好的协作：http: [//trigger.io/cross-platform-application-development-blog/2013/01/15/introducing-projects/](http://trigger.io/cross-platform-application-development-blog/2013/01/15/introducing-projects/)

这应该消除手动创建/覆盖`src/identity.json`文件以共享 Trigger.io 应用程序代码的需要

# c++ - ifstream::eof 在 if 语句中抛出类型错误

> ID：12252727
> 
> 赞同：1
> 
> 时间：2012-09-03T18:45:43.773
> 
> 标签：c++, ifstream

我有一个具有 std::ifstream filestr 成员的 A 类。在其中一个类函数中，我测试了流是否已达到 eof。

```
class A
{
private:
   std::ifstream filestr;

public:
   int CalcA(unsigned int *top);  
} 
```

然后在我的cpp文件中

```
int CalcA(unsigned int *top)
{
   int error;
   while(true)
   {
      (this->filestr).read(buffer, bufLength);

      if((this->filestr).eof);
      {
         error = 1;
         break;
      }
   }
   return error;
} 
```

我得到一个编译错误

```
error: argument of type ‘bool (std::basic_ios<char>::)()const’ does not match ‘bool’ 
```

谁能告诉我如何正确使用eof？或者我收到此错误的任何其他原因？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T18:46:54.817

[`eof`是一个函数](http://en.cppreference.com/w/cpp/io/basic_ios/eof)，所以它需要像其他函数一样调用`eof()`：

也就是说，可以*更正确地*编写给定的读取循环（考虑到文件结尾以外的其他失败可能性），而无需调用`eof()`，而是将读取操作转换为循环条件：

```
while(filestr.read(buffer, bufLength)) {
    // I hope there's more to this :)
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:47:22.860

尝试

```
if(this->filestr).eof()) 
```

`(this->filestr).eof`单独是一个指向成员方法的指针。`if`语句需要类型的表达式`bool`。所以你需要调用该方法。这将成功，因为它返回一个`bool`值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:49:12.220

`(this->filestr).eof`没有调用该函数。`(this->filestr).eof()`是。:-) 这解释了你的错误。

# asp.net-web-api - ASP.New Web API - 模型绑定和继承？

> ID：12252728
> 
> 赞同：9
> 
> 时间：2012-09-03T18:45:58.507
> 
> 标签：asp.net-web-api

控制器方法是否可以处理派生自特定基类的所有已发布项目？这个想法是能够通过将命令发布到端点来分派命令。当我尝试以下操作时，Post 方法中的“cmd”参数始终为空。

例子

```
//the model:
public abstract class Command{
    public int CommandId{get; set;}
}
public class CommandA:Command{
    public string StringParam{get; set;}
}
public class CommandB:Command{
    public DateTime DateParam{get; set;}
}

//and in the controller:
    public HttpResponseMessage Post([FromBody]Command cmd)
    {
        //cmd parameter is always null when I Post a CommandA or CommandB
        //it works if I have separate Post methods for each Command type
        if (ModelState.IsValid)
        {
            if (cmd is CommandA)
            {
                var cmdA = (CommandA)cmd; 
                // do whatever
            }
            if (cmd is CommandB)
            {
                var cmdB = (CommandB)cmd;
                //do whatever
            }

            //placeholder return stuff
            var response = Request.CreateResponse(HttpStatusCode.Created);
            var relativePath = "/api/ToDo/" + cmd.TestId.ToString();
            response.Headers.Location = new Uri(Request.RequestUri, relativePath);
            return response;
        }
        throw new HttpResponseException(HttpStatusCode.BadRequest);
    } 
```

同样，当我尝试这种方法时，会调用 Post 方法，但框架中的参数始终为 null。但是，如果我用具有特定 CommandA 参数类型的 Post 方法替换它，它就可以工作。

我正在尝试的可能吗？还是每种消息类型都需要控制器中的单独处理程序方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:13:23.233

如果您以 Json 格式发送数据，那么以下博客将详细介绍如何在 json.net 中实现层次结构反序列化：

[http://dotnetbyexample.blogspot.com/2012/02/json-deserialization-with-jsonnet-class.html](http://dotnetbyexample.blogspot.com/2012/02/json-deserialization-with-jsonnet-class.html)

# php - 使用 PHP 有效地调整图像大小

> ID：12252731
> 
> 赞同：0
> 
> 时间：2012-09-03T18:46:45.223
> 
> 标签：php, image, file-upload, amazon-s3

我没有学习如何使用 9Lessons[教程](http://www.9lessons.info/2009/03/upload-and-resize-image-with-php.html)在 PHP 中调整图像大小。我不想将这些调整大小的文件存储在带宽昂贵的 Web 服务器上，而是使用 S3 类将它们上传到我的 CDN，即 S3 上的存储桶。

这是我的代码（我已经删除了所有错误检查和文件处理，请不要评论它只能处理 JPEG 并且文件可以是任何给定大小等）：

```
<?php

if($_FILES["file"]["name"]) {

    $filename = stripslashes($_FILES['file']['name']);
    $uploadedfile = $_FILES['file']['tmp_name'];
    $src = imagecreatefromjpeg($uploadedfile);

    list($width,$height)=getimagesize($uploadedfile);
    $newwidth=200;
    $newheight=($height/$width)*$newwidth;
    $tmp=imagecreatetruecolor($newwidth,$newheight);

    imagecopyresampled($tmp,$src,0,0,0,0,$newwidth,$newheight,$width,$height);

    $filename = "small/".time().'.'.trim($_FILES['file']['name']);

    if(imagejpeg($tmp,$filename,100)) {
        imagedestroy($src);
        imagedestroy($tmp);
    }

    require('/path/to/S3.php');  

    if (!defined('awsAccessKey')) define('awsAccessKey', '');  
    if (!defined('awsSecretKey')) define('awsSecretKey', '');  

    $s3 = new S3(awsAccessKey, awsSecretKey);

    $put = S3::putObject(
        S3::inputFile($tmp),
        "bucket",
        $uploadFilename,
        S3::ACL_PUBLIC_READ,
        array(),
        array(
            "Cache-Control" => "max-age=315360000",
            "Expires" => gmdate("D, d M Y H:i:s T", strtotime("+5 years"))
        )
    );
    var_dump($put);
}

?> 
```

当我运行这个脚本时，S3 类会拉出一个错误，指出它`$tmp`是资源而不是文件。我知道`imagejpeg()`创建文件是必需的，但此时我如何将其上传到 S3？我需要创建图像，将其存储在本地，将其上传到 S3 然后删除吗？或者我的问题有更好的解决方案吗？我会以完全错误的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:06:02.830

```
$put = S3::putObject(
    S3::inputFile($filename), //<- Here changes $tmp for $filename
    "bucket",
    $uploadFilename,
    S3::ACL_PUBLIC_READ,
    array(),
    array(
        "Cache-Control" => "max-age=315360000",
        "Expires" => gmdate("D, d M Y H:i:s T", strtotime("+5 years"))
    ) 
```

# php - Insert_id 无法返回值

> ID：12252740
> 
> 赞同：0
> 
> 时间：2012-09-03T18:47:20.453
> 
> 标签：php, insert, mysqli

任何人都可以看到下面的代码有什么问题吗？出于某种原因，我可以让它返回受影响行的 id..实际上它不返回任何内容，但查询运行正常并且记录是在数据库中创建的......

```
 $stmt = $this->db->stmt_init();
        if($stmt->prepare('INSERT INTO Assets(id,assetName,type, username, password, mail) VALUES (?,?,?,?,?,?)'))
        {           
            $stmt->bind_param("isssss", $id, $assetName, $type, $username, $password, $mail);
            $stmt->execute();
            $stmt->close();
            return $stmt->insert_id;
        }
        else
        {
            $stmt->close();            
            return "";
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T18:49:33.933

在尝试获取插入 ID 之前，您正在关闭语句：

```
$stmt->close();
return $stmt->insert_id; 
```

# trigger.io - trigger.io - 寻找数据存储的可能性

> ID：12252746
> 
> 赞同：0
> 
> 时间：2012-09-03T18:47:35.560
> 
> 标签：trigger.io

我知道这不是一个技术问题，但我不知道在哪里可以问其他地方。

我使用名为 trigger.io 的非常酷的工具包来开发适用于 android 和 ios 的应用程序。现在我想使用数据库之类的东西在我的应用程序中显示数据。

首先，我找到了一个名为 firebase 的实时后端：[http](http://www.firebase.com/) ://www.firebase.com/ 不错，但由于它仍处于测试阶段，因此需要一段时间才能访问它。

然后我发现了一个叫Kinvey的云服务：[http](http://www.kinvey.com/) ://www.kinvey.com/也很有意思，不过只要200个用户下载这个app就免费了。

那么您知道存储数据并将其用于我的应用程序的任何替代方法吗？

那会很有帮助

谢谢安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:28:33.870

当然。 [解析](https://www.parse.com/)是一个简单的选择。开始的基本计划是每月 0 美元。

此外，没有什么可以阻止您捆绑（或下载、保存和缓存）用于 trigger.io 应用程序的 json 文件。

# r - 仅更改构面之间的水平间距（ggplot2）

> ID：12252750
> 
> 赞同：31
> 
> 时间：2012-09-03T18:48:12.840
> 
> 标签：r, ggplot2

`ggplot2`能够使用 中的参数更改多面图之间的`panel.margin`边距`opts`。这似乎改变了水平和垂直间距。有没有办法改变水平或垂直的间距而不改变另一个？

**结果和期望结果的示例：**

```
mtcars[, c("cyl", "am", "gear")] <- lapply(mtcars[, c("cyl", "am", "gear")], as.factor)

p <- ggplot(mtcars, aes(mpg, wt, group = cyl)) + 
    geom_line(aes(color=cyl)) +
    geom_point(aes(shape=cyl)) + 
    facet_grid(gear ~ am) +
    theme_bw()        

p + opts(panel.margin = unit(1, "lines")) 
```

所以它目前看起来像：![在此处输入图像描述](../Images/5faf536ae4a1ea28c9316d78986ac679.png)

我们怎样才能让它看起来更像：![在此处输入图像描述](../Images/a7893662dfb2c0f5857aa5f696ed3ca0.png)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2015-07-09T14:33:23.857

截至 2015 年 7 月 9 日，`panel.margin.x`和`panel.margin.y`似乎已经实施

```
p <- p + theme(panel.margin.x=unit(0.5, "lines") , panel.margin.y=unit(1,"lines")) 
```

截至 2016 年 12 月 15 日，'panel.spacing' 和 'panel.spacing.x' 在 r 3.3.2 和 ggplot2 2.2.0 中实现

```
p <- p + theme(panel.spacing.x=unit(0.5, "lines"),panel.spacing.y=unit(1, "lines")) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-27T17:33:00.393

在此功能可用之前的手动解决方案：

```
library(grid)
height <- 0.5 # Vertical spacing
aux <- 1e-5 # Auxiliary number to identify 'height' among other heights
width <- 0.1 # Desirable horizontal spacing

p <- p + theme(panel.margin = unit(height + aux, "lines"))

gtable <- ggplot_gtable(ggplot_build(p))
gtable$widths[sapply(gtable$widths, '[[', 1) == height + aux][[1]][[1]] <- width
grid.draw(gtable) 
```

![在此处输入图像描述](../Images/b1f1a0fef71bcd27b2ca18a28051119f.png)

# redirect - 将目录重定向到具有相同结构的子文件夹

> ID：12252751
> 
> 赞同：0
> 
> 时间：2012-09-03T18:48:39.740
> 
> 标签：redirect

我想将 [http://www.example.com/banners](http://www.example.com/banners)重定向 到 [http://resources.example.com/banners](http://resources.example.com/banners)

我希望目录/横幅中的所有文件都使用 /banners 和相同的文件结构重定向到子域。

问候，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:36:34.790

```
RewriteCond %{THE_REQUEST} ^/banners
RewriteCond %{HTTP_HOST} !^resources.example.com
RewriteRule ^banners http://resources.example.com/banners [R=301,L] 
```

# oauth - Google GData Java 2-legged OAuth 签名验证失败

> ID：12252760
> 
> 赞同：0
> 
> 时间：2012-09-03T18:49:28.257
> 
> 标签：oauth, gdata, oauth-provider, 2-legged

我的消费者代码如下，

GoogleOAuthParameters oauthParameters = new GoogleOAuthParameters();

```
 oauthParameters.setOAuthConsumerKey(CONSUMER_KEY);
    oauthParameters.setOAuthConsumerSecret(CONSUMER_SECRET);
    oauthParameters.setOAuthType(OAuthType.TWO_LEGGED_OAUTH);

    OAuthHmacSha1Signer signer = new OAuthHmacSha1Signer();
    GoogleService service = new GoogleService("oauthclient", "sampleapp");
    service.setOAuthCredentials(oauthParameters, signer);

    String param = "Hellow World";
    String baseString = APP_SERVER + "services/OAuthTest/greet"+"?xoauth_requestor_id="+USER_NAME+"&name="+ param;

    URL feedUrl = new URL(baseString);
    request = service.createFeedRequest(feedUrl);
    request.execute();
    convertStreamToString(request.getResponseStream()); 
```

而我的 OAuth 服务器端代码如下，

```
 GoogleOAuthParameters oauthParameters = new GoogleOAuthParameters();
        oauthParameters.setOAuthConsumerKey(consumerKey);
        oauthParameters.setOAuthConsumerSecret(secretKey);
        oauthParameters.setOAuthNonce(nonce);
        oauthParameters.setOAuthTimestamp(timestamp);
        oauthParameters.setOAuthSignatureMethod(signatureMethod);

        validateTimestampAndNonce(otimestamp, nonce);

        OAuthHmacSha1Signer signer = new OAuthHmacSha1Signer();
        String baseString = OAuthUtil.getSignatureBaseString(baseUrl,httpMethod, baseParameters);
        String signature = signer.getSignature(baseString, oauthParameters);

        return signature.equals(oauthParams.getOauthSignature()) 
```

以上签名验证失败，我不知道出了什么问题。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T04:59:20.950

我找到了这个原因。OAuth 1.0a 规范第 9.1.2 节定义 Signature Base String 包括请求绝对 URL。因此，如果服务器端与消费者端不同，则签名验证失败。所以就我而言，在消费者端我使用的是

> 127.0.0.1

对于请求 URL 的主机名和我正在使用的服务器端

> 本地主机

作为错误的主机名。将消费者更改为使用**localhost**作为主机名后，我可以成功验证签名。

# java - 将名为 EMPLOYEE 的枚举映射到 VARCHAR 鉴别器值“M”

> ID：12252763
> 
> 赞同：1
> 
> 时间：2012-09-03T18:49:46.917
> 
> 标签：java, jpa, enums, jpa-2.0, eclipselink

这基本上是一个后续问题或重新发布问题[How to use enums with JPA](https://stackoverflow.com/questions/352586/how-to-use-enums-with-jpa)似乎已以专有方式解决。这是基本相同的 2012 **JPA**问题，这里使用**EclipseLink 2.3.2**。

问题是如何将 Java 枚举映射到具有不同名称的数据库字符串。有一个带有 VARCHAR 值`'M'`、`'C'`、`'N'`和的 DB 列`'F'`。它们很神秘，混合了英语和德语。为了改进业务层，我想将 Java 枚举映射到上述数据库字符串：

```
public enum TradingSector
{
    EMPLOYEE( "M" ), // Mitarbeiter
    CUSTOMER( "C" ),
    NOSTRO( "N" ),
    FUND( "F" );

// this works:
//    M( "M" ),
//    C( "C" ),
//    N( "N" ),
//    F( "F" );

    private final String ch;

    private TradingSector( String ch )
    {
        this.ch = ch;
    }

    @Override
    public String toString()
    {
        return this.ch;
    }
} 
```

这是实体：

```
@Entity
@Table( name = "TRADES" )
@Inheritance( strategy = InheritanceType.SINGLE_TABLE )
@DiscriminatorColumn( name = "NOSTRO_FLAG", discriminatorType = DiscriminatorType.STRING, length = 1 )
public class Trade implements Serializable
{
    @Enumerated( EnumType.STRING )
    @Column( name = "NOSTRO_FLAG", insertable = false, updatable = false )
    private TradingSector discriminator;

    ...
} 
```

这有点特殊，**将枚举映射到已经是继承鉴别器的内容**。但是，这应该可以工作，因为命名为 DB 字符串的枚举显示。

该`TRADES`表是目前整个上下文中最单一的表，将实体拆分为子类是非常理想的。

我曾期望简单地覆盖`toString`我所读到的内容，但这会导致：

```
Caused by: Exception [EclipseLink-116] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DescriptorException
Exception Description: No conversion value provided for the value [M] in field [TRADES.TRADING_SECTOR].
Mapping: org.eclipse.persistence.mappings.DirectToFieldMapping[discriminator-->TRADES.TRADING_SECTOR]
Descriptor: RelationalDescriptor(com.company.project.model.Trade --> [DatabaseTable(TRADES)])
    at org.eclipse.persistence.exceptions.DescriptorException.noFieldValueConversionToAttributeValueProvided(DescriptorException.java:1052)
    at org.eclipse.persistence.mappings.converters.ObjectTypeConverter.convertDataValueToObjectValue(ObjectTypeConverter.java:140)
    at org.eclipse.persistence.mappings.converters.EnumTypeConverter.convertDataValueToObjectValue(EnumTypeConverter.java:137)
    at org.eclipse.persistence.mappings.foundation.AbstractDirectMapping.getAttributeValue(AbstractDirectMapping.java:699)
    at org.eclipse.persistence.mappings.foundation.AbstractDirectMapping.valueFromRow(AbstractDirectMapping.java:1299)
    at org.eclipse.persistence.mappings.DatabaseMapping.readFromRowIntoObject(DatabaseMapping.java:1326) 
```

这是[http://wiki.eclipse.org/EclipseLink_Exception_Error_Reference_%28ELUG%29](http://wiki.eclipse.org/EclipseLink_Exception_Error_Reference_%28ELUG%29)上的 EclipseLink 错误文档所说的：

```
 ECLIPSELINK-00116: No conversion value provided for the value [{0}] in field [{1}].
    Cause: The attribute conversion value for the fieldValue was not given in the object type mapping. 
    Action: Verify the field value, and provide a corresponding attribute value in the mapping. 
```

是啊。：-/

**问**：解决这个问题的*非专有*(JPA 2) 方法是什么（如果可能的话，不要深入黑客战壕）？

PS：无法更改 DB 值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:53:02.730

该死的，我在这里错过了 Pascal Thivent 的**精彩**回答：[https ://stackoverflow.com/a/2751896/396732](https://stackoverflow.com/a/2751896/396732)

这是最终的解决方案：

枚举：

```
public enum TradingSector
{
    EMPLOYEE( "M" ),
    CUSTOMER( "C" ),
    NOSTRO( "N" ),
    FUND( "F" );

    private final String ch;

    private TradingSector( String ch )
    {
        this.ch = ch;
    }

    public String getCharacter()
    {
        return this.ch;
    }

    public static TradingSector translate( String ch )
    {
        for ( TradingSector ts : TradingSector.values() )
        {
            if ( ch.equals( ts.getCharacter() ) )
            {
                return ts;
            }
        }

        return null;
    }
} 
```

实体：

```
@Entity
@Table( name = "TRADES" )
@Inheritance( strategy = InheritanceType.SINGLE_TABLE )
@DiscriminatorColumn( name = "NOSTRO_FLAG", discriminatorType = DiscriminatorType.STRING, length = 1 )
public abstract class Trade implements Serializable
{
    @Column( name = "NOSTRO_FLAG", insertable = false, updatable = false )
    protected String discriminator;

    @Id
    @Column( name = "TRADE_ID" )
    protected Long id;

    ...

    protected Trade()
    {
    }

    public String getDiscriminator()
    {
        return this.discriminator;
    }

    public TradingSector getTradingSector()
    {
        return TradingSector.translate( this.discriminator );
    }

    ...
} 
```

一定程度上还是有用的。

# java - 如何通过 Servlet 进行无缝身份验证

> ID：12252765
> 
> 赞同：1
> 
> 时间：2012-09-03T18:49:49.360
> 
> 标签：java, seam, jsf-1.2, jboss-4.2.x

我知道这不是它的本意，而且完全错误，但是命令就是命令，我需要执行以下操作：用户使用参数上的 accesskey 访问 servlet，如下所示：

```
http://myhost/my_app/servlet?accesskey=XXXXX 
```

然后 servlet 获取密钥并使用它在 seam 上对用户进行身份验证，这可能吗？到目前为止我无法做到

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:43:01.700

您的 servlet 中的此代码应该使您能够访问您的接缝组件。

```
Lifecycle.beginCall();

Authenticator authenticator = (Authenticator)Component.getInstance("authenticator");

LifeCycle.endCall(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T15:21:42.930

从您的问题中不清楚您是否需要创建自定义 servlet 或者您只需要根据请求参数进行登录。主要区别在于自定义 servlet 不会被 Seam 拦截，除非您手动启动 Seam 生命周期，否则您无法使用组件（正如 Trind 所指出的，当从外部调用时，您需要使用`LifeCycle.beginCall()`并且`LifeCycle.endCall()`能够使用 Seam 组件`SeamFilter`）。除此之外，这两种解决方案的工作方式相似。

创建一个将处理身份验证的组件：

```
@Name("myAuthenticator")
public class MyAuthenticator implements Serializable {

    // Seam's identity component
    @In private transient Identity identity;

    // When logged in, the user needs to have some roles, usually
    // you assign these dynamically based on user name, type, etc., here
    // I just initialize it to a fixed list of roles
    ArrayList<String> roles = new ArrayList<String>(Arrays.toList(
            new String[] { "base", "admin" }));

    // Access key (getters and setters omitted but are necessary)
    private String accessKey;

    public String doAuth() {
        // Check accessKey validity (against an SSO service or 
        // in your DB or whatever), here we do a trivial check.
        boolean userCanAccess = "ADMINKEY".equals(accessKey);

        if (userCanAccess) {
            identity.acceptExternallyAuthenticatedPrincipal(
                    new SimplePrincipal("username"));

            // Assign user roles
            for (String role : roles) {
                identity.addRole(role);
            }
            return "ok";
        }
        return "ko";
    }
} 
```

现在创建一个登录页面描述符，它将通过参数处理登录（例如`externalLogin.page.xml`，您不需要为此创建`.xhtml`页面）：

```
<page>
    <!-- this sets the accessKey variable with the query parameter -->
    <param name="accessKey" value="#{myAuthenticator.accessKey}" />

    <!-- this invokes our authentication action -->
    <action execute="#{myAuthenticator.doAuth}" />

    <!-- navigation rules, these determine what to do if auth is ok or fails -->
    <navigation from-action="#{myAuthenticator.doAuth}">
        <rule if-outcome="ko">
            <redirect view-id="/error.xhtml">
                <message severity="ERROR">Invalid Authentication Key</message>
            </redirect>
        </rule>
        <rule if-outcome="ok">
            <redirect view-id="/home.xhtml">
                <message severity="INFO">Welcome!</message>
            </redirect>
        </rule>
    </navigation>
</page> 
```

现在要执行登录，您可以使用该页面，如下所示：

```
http://localhost:8080/yourapp/externalLogin.seam?accessKey=XXXXXXXX 
```

如果您需要使用自定义 servlet（不太可能，但尽管如此），上述组件不会更改，只需从 servlet 中调用它，如下所示：

```
public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
    // Start Seam lifecycle
    LifeCycle.beginCall();
    // Get an instance of the authenticator component from Seam
    MyAuthenticator auth = Component.getInstance("myAuthenticator");
    // Set access key in component and perform auth
    auth.setAccessKey(req.getParameter("accessKey"));
    String result = auth.doAuth();
    // End Seam lifecycle, no more component calls are needed.
    LifeCycle.endCall();

    // Do something here with the result
    if ("ok".equals(result)) {
        resp.sendRedirect(...);
    }
} 
```

# jquery-mobile - 两个 jQuery Mobile 滑块一起工作

> ID：12252766
> 
> 赞同：0
> 
> 时间：2012-09-03T18:49:59.570
> 
> 标签：jquery-mobile

我想在 JQM 站点中有 2 个相互影响的滑块。

滑块 1 将改变月数 滑块 2 将改变成本

在幕后，会有一个金额，比如 3600 美元

默认情况下，月数滑块为 36，因此成本滑块为 10 美元

如果用户将月份滑块更改为 18，则成本滑块应自动更改为 20 美元（因为 20 * 18 = 3600 英镑）

同样，如果用户将成本滑块更改为 20 美元，则月份滑块应移动到 18 个月。

我向两个滑块添加了一个 bind("onchange") ，但最终出现了“超出最大调用大小堆栈”错误。

我曾尝试使用 event.originalEvent 和 event.preventDefault 但无济于事。

我将如何让这 2 个相互协作，以便如果 1 更新，另一个也重新计算，反之亦然？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:09:52.283

刷新似乎是触发更改事件的事情，所以现在我在调用刷新之前 die() 事件，然后再次创建它

```
$("#Months").val(42);
// remove binding
$("#Months").die("change");
$("#Months").slider("refresh");
$("#Months").live("change", ChangeMonths); 
```

似乎工作，也许不漂亮，但哦，好

# objective-c - 在 CLGeocoder 具有反向地理编码数据后“返回”

> ID：12252767
> 
> 赞同：0
> 
> 时间：2012-09-03T18:50:14.437
> 
> 标签：objective-c, reverse-geocoding, clgeocoder

完成反向地理编码数据后，如何仅返回自定义 init 方法？

有没有办法做到这一点？我以为我应该在completionHandler的末尾添加'return self'，但这只是返回到init方法，而不是返回init方法。

感谢所有帮助，并提前感谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T00:14:59.867

您可以将方法选择器视为数据

```
SEL    theSelector = @selector(initWithStuff:); 
```

*theSelector*现在可以像任何其他原始数据类型一样被传递。

使用 ARC 调用带有*performSelector:*的 init 方法选择器，如

```
id result = [target performSelector:theSelector]; 
```

有点棘手，因为编译器不知道需要释放返回值。如果您可以改用类方法，那么您可以忍受编译器给您的警告，或者用

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Warc-performSelector-leaks"
id result = [[Target class] performSelector:theSelector];
#pragma clang diagnostic pop 
```

# linux - 在 Xvfb 服务器中获取窗口列表

> ID：12252774
> 
> 赞同：5
> 
> 时间：2012-09-03T18:51:04.883
> 
> 标签：linux, debian, x11, xvfb

我正在尝试在 debian 挤压机的 Xvfb 服务器中获取窗口列表。我正在做的是：

```
$ Xvfb :2&
$ DISPLAY=:2; wmctrl -l 
```

但我收到了这个错误：

```
Cannot get client list properties. (_NET_CLIENT_LIST or _WIN_CLIENT_LIST) 
```

这是正常的还是我错过了什么？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-15T11:48:05.987

我有类似的问题。我的情况是 xfce-panel 没有配置。最后我执行了：

```
sudo chmod -x /usr/bin/xfce4-panel 
```

这解决了问题（我不需要这个面板）。这是一个肮脏的黑客。正确的方法是配置面板。

# java - 一种在java中访问jar位于资源的多平台方法

> ID：12252775
> 
> 赞同：2
> 
> 时间：2012-09-03T18:51:24.817
> 
> 标签：java, file, embedded-resource

我需要一些代码，可以`InputStream`从存储在某个路径中的资源中获取一个 jar 文件，这是测试代码：

```
 String res =File.separatorChar+ "folder"+File.separatorChar+"file.txt";
  InputStream is = ReadRes.class.getResourceAsStream(res);
  System.out.println(is); 
```

在我的 jar 中，我有目录文件夹/file.txt，在 linux 中它可以工作，但在 Windows 上我得到一个空值`is` 。我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T01:41:46.290

`/`获取资源时 始终使用。

资源不是 a `File`，路径由`URL`始终带有正斜杠的 a 表示。

# c++ - 如何从传递的一个对象的指针中读取变量？

> ID：12252776
> 
> 赞同：0
> 
> 时间：2012-09-03T18:51:27.167
> 
> 标签：c++, oop, pointers

我将对象作为指针传递，然后我想使用传递的对象值将它们分配给其他方法。

这就是我传递对象的方式：

```
Author *pAuthor = new Author("John", "Doe");
Publisher *pPublisher = new Publisher("Wrox", "10475 Crosspoint Blvd.", "Indianapolis");
Book *pBook = new Book("Memory Management", pAuthor, pPublisher, 39.99);

cout << pBook->getBookInfo() << endl; 
```

现在，在其他类中，我必须从对象中读取那些传递的变量并将它们分配到其他地方。在这段代码中，我只使用传递的值而不使用对象，因为我不确定如何处理它们。

```
Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    this->title = title;
    this->price = price;
} 
```

如何从传递的对象中读取传递的值？

编辑，我的问题可能有些混乱。下面的代码必须访问变量并插入到稍后将使用它们的方法中。

我尝试插入的每个变量看起来像这样。我不想访问作者的私有变量，因为当它们被设置为私有时我无法访问，但它们仍然是空的。

我现在的代码是：

```
Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    this->title = title;
    this->price = price;

    author.setFirstName();
    author.setLastName();

    publisher.setName();
    publisher.setAddress();
    publisher.setCity();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:53:49.247

使用此语法，假设您有这些变量并且它们是公共的。

```
pAuthor->first_name ;
pAuthor->last_name ; 
```

而对于其他类。

```
pPublisher->author ;
pPublisher->name ;
pPublisher->place ; 
```

运算符取消引用指向对象的`'->'`指针，或者换句话说，将您带到所需的变量。

最好将这些数据成员用作私有成员。如果这样做，您将无法直接访问它们。您必须使用 getter 和 setter 函数来读取和写入它们的值。

他们看起来像这样。

```
pAuthor->getfirst_name() ;
pAuthor->getlast_name() ;

pPublisher->getauthor() ;
pPublisher->getname() ;
pPublisher->getplace() ; 
```

最后，最好不要按值传递这些对象。通过引用传递它们并`const`在它们之前使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T18:53:54.717

理想情况下，您在对象定义中提供“getter”和“setter”函数并使用它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T18:54:24.350

您传入一个指向对象的指针，通过该指针您可以调用该类的任何公共方法。像这样

```
 pAuthor->public_member_function(); 
```

您将需要实现类的功能`Author`以允许其他类访问您希望能够检索的数据

# java - Java formatting, negative values, zero padding

> ID：12252780
> 
> 赞同：5
> 
> 时间：2012-09-03T18:51:42.307
> 
> 标签：java, string, format

Here's a quote from: [http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html)

> 'd' '\u0054' Formats the argument as a decimal integer. The localization algorithm is applied.
> 
> If the '0' flag is given and the value is negative, then the zero padding will occur after the sign.

I feel frustrated, trying to learn this formatting thing but that tutorial is just so cluttered and messy.

```
String.format("%03d", int); 
```

I am trying to understand where exactly this whole \u0054 should go but I have just no idea, I must be missing something very obvious or something...

Edit:

**What I want to achieve: Positive 10: 010 Negative 10: -10 Negative result I want to achieve: -010**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T18:54:05.370

`\u0054` is `d`

You can do

```
((i < 0) ? "-" : "") + String.format("%03d", Math.abs(i)); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-03T19:12:23.397

Try `String.format("% 4d", i)` then (with a space between % and 4); it's using 4 positions, zero-padded and it leaves an extra space for positive values, so you get " 010" and "-010". You can `trim()` the string afterwards to get rid of the initial space (or do something like `if (i>0) s=s.substring(1)` or something).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-10T03:01:16.527

The following works

```
public class MyProgram
{
    public static void main(String[] args)
    {
        int n = -13754;
        int p = 2234;
        String buffer = String.format("%08d", n);
        System.out.println(buffer);
        buffer = String.format("%08d", p);
        System.out.println(buffer);
    }
} 
```

output

```
-0013754
00002234 
```

For your example "%03d" is what you would use.

# asp.net - AuthenticationForm - 跨站点 Cookie

> ID：12252783
> 
> 赞同：0
> 
> 时间：2012-09-03T18:52:18.920
> 
> 标签：asp.net, forms-authentication, httpcookie

我有 2 个网站，第一个是`myFirst.domain.com`，第二个是`mySecondSite.domain.com`.

它们位于两个不同的 Web 服务器上，我的目标是允许跨站点身份验证（我真正需要的是共享`FormsAuthentication`Cookie）。

我已经正确设置了我的`web.config`文件（机器密钥节点、表单节点）。唯一的区别是关于 loginUrl 在 myFirstSite 上的显示位置`~/login.aspx`，而在 mySecondSite 上的显示位置`http://myFirstSite.com/login.aspx`。

请注意，我没有虚拟目录，我只有 2 个不同的网络应用程序。

问题：当我从 mySecondSite 到达 myFirstSite 登录页面时，我从未从登录页面重定向，似乎没有写入 cookie。

以下是有关该问题的一些片段：

我的第一站：

```
 <machineKey validationKey="..." decryptionKey="..." validation="SHA1" decryption="AES" />
        <authentication mode="Forms">
            <forms loginUrl="login.aspx" name="authCookie" enableCrossAppRedirects="true"></forms>
        </authentication>
        <authorization>
            <deny users="?" />
            <allow users="*"/>
        </authorization> 
```

MyFirstSite 后面的代码：

```
 FormsAuthenticationTicket fat = new FormsAuthenticationTicket(1, "userName..", DateTime.Now, DateTime.Now.AddMinutes(30), true, "roles..");

        string ticket = FormsAuthentication.Encrypt(fat);

        HttpCookie authCookie = new HttpCookie(FormsAuthentication.FormsCookieName, ticket);
        authCookie.Expires = fat.Expiration;
        authCookie.Domain = "myDomain.com";
        Response.Cookies.Add(authCookie);

//Here is other stuff about querystring checking in order to execute exact redirect, however it's not working, I always return to the login page. 
```

我的第二站点：

```
<machineKey validationKey="..." decryptionKey="..." validation="SHA1" decryption="AES"/>
        <authentication mode="Forms">
            <forms loginUrl="http://myFirstSite.domain.com/login.aspx?queryStringToIndicateUrlPage" enableCrossAppRedirects="true"></forms>
        </authentication>
        <authorization> 
```

嗯，就是这样。不幸的是，它不起作用。

请不要注意`queryStringToIndicateUrlPage`，这只是一个简单的解决方法，以便知道我是否必须在同一个应用程序或另一个应用程序上重定向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:48:11.847

当您使用在两个域之间共享的基于 cookie 的身份验证时，您需要在`<forms>`元素中指出这一点：

```
<machineKey validationKey="..." decryptionKey="..." validation="SHA1" decryption="AES"/>
    <authentication mode="Forms">
        <forms domain=".domain.com" ... />
    </authentication> 
```

注意开头的“.” 在域名前面，这样可以在子域之间共享 cookie。

# matlab - 加载 .mat 文件 - 内存不足

> ID：12252784
> 
> 赞同：0
> 
> 时间：2012-09-03T18:52:22.323
> 
> 标签：matlab, matrix

我有一个矩阵立方体，我将其加载到我的程序中以从中读取数据。此 .mat 文件的大小为 2.8 GB。我无法加载它并出现“内存不足”的错误。有没有办法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:03:18.910

您可以使用`matfile`该类来处理 MatLab 文件中变量内的范围。看

*   [在 MAT 文件中加载和保存部分变量](http://www.mathworks.com/help/techdoc/ref/matfile.html)

[这是一些额外的讨论](http://www.mathworks.com/matlabcentral/answers/9208)，揭示了此功能是 R2011b 的新功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:00:01.287

如果数据的大小超过了您机器上的可用内存，那么您就有麻烦了——这是不可避免的。但是，如果您只需要 .mat 文件中的某些变量，您可以尝试使用

```
 load(filename, variables) 
```

加载函数的版本。这实际上取决于您的 .mat 文件的内容。如果文件是 2.8GB，并且您需要文件中的所有变量并且您的计算机没有足够的内存来处理，那么您唯一的选择是购买更多的 RAM。

**编辑**显然，如果您运行 R2011b 及更高版本，则此答案不正确，如**Ben Voight的回答中所述**

# android - android使首选项（CheckBoxPreference）在XML中可滚动

> ID：12252787
> 
> 赞同：0
> 
> 时间：2012-09-03T18:52:57.313
> 
> 标签：android, android-preferences

嗨，我正试图让我的偏好区域具有可滚动的文本，因为大多数标题都太长了。这有可能吗？我看过有关 的帖子`TextViews`，即使是那些需要一点鼓励才能开始的帖子……感谢您的帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:55:18.397

不是标准`PreferenceActivity`，你很可能在那里使用。缩短您的标签并使用提交的“描述”来澄清。或者只是为您的应用创建帮助或手册

# signal-processing - 了解远程 I/O AudioStreamBasicDescription (ASBD)

> ID：12252791
> 
> 赞同：7
> 
> 时间：2012-09-03T18:53:35.247
> 
> 标签：signal-processing, core-audio, audio-streaming, audio-recording, audiounit

我需要帮助理解以下 ASBD。它是分配给新实例的默认 ASBD `RemoteIO`（我通过`AudioUnitGetProperty(..., kAudioUnitProperty_StreamFormat, ...)`在`RemoteIO`音频单元上执行得到它，就在分配和初始化它之后）。

```
Float64 mSampleRate        44100
UInt32  mFormatID          1819304813
UInt32  mFormatFlags       41
UInt32  mBytesPerPacket    4
UInt32  mFramesPerPacket   1
UInt32  mBytesPerFrame     4
UInt32  mChannelsPerFrame  2
UInt32  mBitsPerChannel    32
UInt32  mReserved          0 
```

问题是，不`mBytesPerFrame`应该`8`吗？如果我每个通道有 32 位（4 个字节），每帧有 2 个通道，那么每个帧不应该是 8 个字节长（而不是 4 个）吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T23:37:27.673

的值`mBytesPerFrame`取决于`mFormatFlags`。来自 CoreAudioTypes.h：

```
Typically, when an ASBD is being used, the fields describe the complete layout
of the sample data in the buffers that are represented by this description -
where typically those buffers are represented by an AudioBuffer that is
contained in an AudioBufferList.

However, when an ASBD has the kAudioFormatFlagIsNonInterleaved flag, the
AudioBufferList has a different structure and semantic. In this case, the ASBD
fields will describe the format of ONE of the AudioBuffers that are contained in
the list, AND each AudioBuffer in the list is determined to have a single (mono)
channel of audio data. Then, the ASBD's mChannelsPerFrame will indicate the
total number of AudioBuffers that are contained within the AudioBufferList -
where each buffer contains one channel. This is used primarily with the
AudioUnit (and AudioConverter) representation of this list - and won't be found
in the AudioHardware usage of this structure. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:29:55.113

我相信，因为格式标志指定`kAudioFormatFlagIsNonInterleaved`它遵循任何缓冲区中帧的大小只能是 1 通道帧的大小。如果这是正确`mChannelsPerFrame`的，那肯定是一个令人困惑的名字。

我希望其他人能确认/澄清这一点。

# oracle - 为什么我收到 ORA-01003: no statement parsed 错误？

> ID：12252792
> 
> 赞同：1
> 
> 时间：2012-09-03T18:53:40.290
> 
> 标签：oracle, stored-procedures, plsql

为什么我会收到此错误以及未解析语句是什么意思。

```
 ORA-01003: no statement parsed 
```

这是代码：

```
PROCEDURE ORIGINAL_TABLE.UPDATE_GROUPS   IS
-- cursor loaded with the swam groups
CURSOR cursor1 IS
    SELECT ID, NEW_DESCRIPTION
    FROM NEW_TABLE.NEW_GROUP_TABLE@DB_LINK.X;

BEGIN
    FOR C1_REC IN cursor1 LOOP
        UPDATE
            ORIGINAL_TABLE."GROUPS"
        SET
            GROUP_ID = C1_REC.ID
        WHERE
            ORIGINAL_TABLE."GROUPS".DESCRIPTION = C1_REC.NEW_DESCRIPTION;

        IF (SQL%ROWCOUNT = 0) THEN
           INSERT INTO
                  ORIGINAL_TABLE.GROUPS("GROUP_ID", "DESCRIPTION")
           VALUES (C1_REC.ID, C1_REC.NEW_DESCRIPTION);
        END IF;

    END LOOP;

    EXCEPTION
    WHEN OTHERS THEN
         dbms_output.put_line(SQLERRM);
END; 
```

我尝试用上面的代码做的是用新表中的值更新旧表，如果新组不存在，请插入它。

更新：将 %ROWCOUNT > 0 更改为 %ROWCOUNT = 0

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T19:18:21.333

Use MERGE statement, it does update/insert stuff more efficiently and pay attention your plsql doesn't provide it is intended for. It tries to make an update statement and if a record found it inserts another record. In order to fix it use IF (SQL%ROWCOUNT = 0) I presume the reason of the issue is the . in DBLINK name.

Moreover I would suggest to get rid of quotes for tables/fields just in case as well as schema name.

Another words delete all ORIGINAL_TABLE.

```
merge into groups g
using (
SELECT ID, NEW_DESCRIPTION
FROM NEW_TABLE.NEW_GROUP_TABLE@DB_LINK.X
) nt
on (nt.NEW_DESCRIPTION = g.description  )
when matched then update set g.group_id = nt.id
when non matched then insert(GROUP_ID, DESCRIPTION)
                      values(nt.id, nt.NEW_DESCRIPTION) 
```

# c++ - 返回字符串向量

> ID：12252795
> 
> 赞同：0
> 
> 时间：2012-09-03T18:53:51.193
> 
> 标签：c++, string, vector

我对向量的所有命名空间以及如何在我的类中正确返回字符串向量感到有点困惑。这是代码：

主文件

```
#include <fstream>
#include <iostream>
#include <stdlib.h>
#include <vector>
#include <string>
#include "lab1.h"

using namespace std;
readwords wordsinfile;
words wordslist;

int main ( int argc, char *argv[] )
{
    if ( argc != 2 ) {
            // Looks like we have no arguments and need do something about it
            // Lets tell the user
            cout << "Usage: " << argv[0] <<" <filename>\n";
            exit(1);
    } else {
            // Yeah we have arguements so lets make sure the file exists and it is readable
            ifstream ourfile(argv[1]);
            if (!ourfile.is_open()) {
                    // Then we have a problem opening the file
                    // Lets tell the user and exit
                    cout << "Error: " << argv[0] << " could not open the file. Exiting\n";
                    exit (1);
            }

            // Do we have a ASCII file?
            if (isasciifile(ourfile)) {
                    cout << "Error: " << argv[0] << " only can handle ASCII or non empty files. Exiting\n";
                    exit(1);
            }

            // Let ensure we are at the start of the file
            ourfile.seekg (0, ios::beg);
            // Now lets close it up
            ourfile.close();
    }

    // Ok looks like we have past our tests
    // Time to go to work on the file
    ifstream ourfile2(argv[1]);
    wordsinfile.getwords(ourfile2); 
```

实验室1.h

```
#ifndef LAB1_H
#define LAB1_H

bool isasciifile(std::istream& file);

class readwords {
    public:
             int countwords(std::istream& file);
             std::vector<std::string> getwords(std::istream& file);
};

class words {
    public:
            void countall( void );
            void print( void );
};

#endif 
```

实验室1.cpp

```
#include <fstream>
#include <iostream>
#include <map>
#include "lab1.h"
#include <vector>
using std::vector;
#include <string>

using namespace std;

vector<string> readwords::getwords(std::istream& file) {
    char c;
    string aword;
    vector<string> sv;
    int i = 0;

                    while(file.good()) {
                            c = file.get();
                            if (isalnum(c)) {
                                    if(isupper(c)) {
                                            c = (tolower(c));
                                    }
                                    if(isspace(c)) { continue; }
                                    aword.insert(aword.end(),c);
                            } else {
                                    if (aword != "") {sv.push_back(aword);}
                                    aword = "";
                                    i++;
                                    continue;
                            }
                    }
    return sv;
} 
```

这是编译的错误。

```
g++ -g -o lab1 -Wall -pedantic main.cpp lab1.cpp
In file included from lab1.cpp:4:0:
lab1.h:9:4: error: ‘vector’ in namespace ‘std’ does not name a type
lab1.cpp:48:54: error: no ‘std::vector<std::basic_string<char> > readwords::getwords(std::istream&)’ member function declared in class ‘readwords’
make: *** [lab1] Error 1 
```

为什么我会收到此错误以及如何修复它。感谢您提供任何帮助。

瑞安

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T18:55:05.210

您还必须`#include <vector>`在头文件中。实际上，将其包含在标头中就足够了，因为包含该标头的所有文件都将隐式包含`<vector>`.

问题是您的包含订单是：

```
#include "lab1.h"
#include <vector> 
```

并且由于您`std::vector`在标题中使用（在包含它之前），您会收到错误消息。反转包含顺序将修复编译错误，但不能解决底层错误 -`lab1`使用尚未定义的符号。正确的解决方法是包含`<vector>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T18:58:18.517

编译器按照编写的顺序查看代码。这也适用于#include 指令：文件的内容被视为已写入#include 的文件中。正如@LuchianGrigore 所提到的，最好的解决方案是添加

```
#include <vector> 
```

到“lab1.h”。但是你可以通过移动`#include <vector>`“lab1.cpp”来隐藏问题，以便它在`#include "lab1.h". That would make the error go away, because the compiler would have already read`开始读取“lab1.h”之前出现在`之前。这不是你应该做的，但它可能会意外发生并隐藏实际问题。

# bash - 在 ascii 中重命名 linux 目录的每个 unicode 文件

> ID：12252802
> 
> 赞同：2
> 
> 时间：2012-09-03T18:54:25.283
> 
> 标签：bash, unix

我正在尝试以 ASCII 重命名所有 unicode 文件名。

我想做这样的事情：

```
for file in `ls | egrep -v ^[a-z0-9\._-]+$`; do mv "$file" $(echo "$file" | slugify); done 
```

但它还没有工作。

*   首先，正则表达式`^[a-z0-9\._-]+$`似乎还不够。
*   其次，slugify 还转换了文件的扩展名，所以我必须先剪切扩展名，然后再将其放回去。

有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T19:08:33.350

首先，不要解析`ls`. 这通常是一个坏主意，特别是如果您期望文件名称中包含任何类型的奇怪字符。

假设`slugify`您对文件名的一般要求是什么，请尝试：

```
for file in * ; do
  if [ -f "$file" ] ; then
    ext=${file##*.}
    name=${file%.*}
    new_name=$(echo "$name"|slugify)
    if [[ $name != $new_name ]] ; then
      echo mv -v "$name.$ext" "$new_name.$ext"
    fi
  fi
done 
```

警告：如果您的文件没有扩展名，这将失败（它会使文件名加倍）。如果您需要处理这个问题，请参阅[J 医生的](https://stackoverflow.com/users/171236/doctor-j)[另一个答案。](https://stackoverflow.com/a/1403489/635608)

# android - JSON响应没有从android中的.asmx webservice返回

> ID：12252804
> 
> 赞同：1
> 
> 时间：2012-09-03T18:54:28.333
> 
> 标签：android, web-services, asmx

我正在创建一个从 Web 服务获取 Json 响应的应用程序。该应用程序位于 2 个文件中，一个 webclient 和一个 webserviceActivity。客户端回来了，我认为 logcat 正在打印 HTTP/1.1 200 OK。之后似乎有一个 JSONException。它可能与 url 中传递的第二个参数的格式有关，因为它是一个日期。我尝试传入一个字符串，但无济于事。我在这里完成的方法是从 sql.Date(yyyy mm dd) 创建一个日期对象并将其传递进去。这样我在 JSONException 之前从服务器得到了一点回报

这是文件。提前致谢。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.content.ContentValues;
import android.util.Log;

public class WebClient {

    private static final String TAG = WebClient.class.getSimpleName();

    private static String convertStreamToString(InputStream is) {
        /*
         * To convert the InputStream to String we use the
         * BufferedReader.readLine() method. We iterate until the BufferedReader
         * return null which means there's no more data to read. Each line will
         * appended to a StringBuilder and returned as String.
         */
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();

        String line = null;
        try {
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    }

    /*
     * This is a test function which will connects to a given rest service and
     * prints it's response to Android Log with labels "Praeda".
     */
    public JSONObject connect(String url) {

        JSONObject json = null;
        HttpClient httpclient = new DefaultHttpClient();

        // Prepare a request object
        HttpGet httpget = new HttpGet(url);

        // Execute the request
        HttpResponse response;
        try {
            response = httpclient.execute(httpget);
            // Examine the response status
            Log.i(TAG, response.getStatusLine().toString());

            // Get hold of the response entity
            HttpEntity entity = response.getEntity();
            // If the response does not enclose an entity, there is no need
            // to worry about connection release

            if (entity != null) {

                // A Simple JSON Response Read
                InputStream instream = entity.getContent();
                String result = convertStreamToString(instream);
                Log.i(TAG, result);

                // A Simple JSONObject Creation
                json = new JSONObject(result);

                // Closing the input stream will trigger connection release
                instream.close();

            }

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
         return json;

    }
} 
```

.

```
import java.sql.Date;

import org.json.JSONObject;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class WebserviceActivity extends Activity {

    private static final String TAG = WebserviceActivity.class.getSimpleName();
    TextView tv = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        tv = (TextView) findViewById(R.id.textviewwebserviceresponse);

        WebClient rc = new WebClient();

        @SuppressWarnings("deprecation")
         Date d = new Date(2012, 9, 3);
        JSONObject jObj = rc
                .connect("http://212.169.27.217:84/rotaservice.asmx/GetRota?CarerID=36&RotaDate="+d);
         Log.e(TAG, "json obj = " + jObj.toString());
        tv.setText(jObj.toString());

    }// end of onCreate

}// end of class 
```

.

```
09-03 19:52:00.490: I/global(21931): In close() at SocketHttpClientConnection
09-03 19:52:00.490: I/global(21931): call createSocket() return a new socket.
09-03 19:52:03.610: I/WebClient(21931): HTTP/1.1 200 OK
09-03 19:52:03.610: I/WebClient(21931): <?xml version="1.0" encoding="utf-8"?>
09-03 19:52:03.610: I/WebClient(21931): <string xmlns="http://tempuri.org/">{"0":{"StartDate":"","EndDate":"","Duration":"0","CallStatusID":"0","CallStatusName":"","ClientSurname":"","ClientForename":"","NeedName":"Out of range","CarerAwayReason":"","CallID":"","DoubleUpCallID":""}}</string>
09-03 19:52:03.620: W/System.err(21931): org.json.JSONException: Value <?xml of type java.lang.String cannot be converted to JSONObject
09-03 19:52:03.620: W/System.err(21931):    at org.json.JSON.typeMismatch(JSON.java:111)
09-03 19:52:03.620: W/System.err(21931):    at org.json.JSONObject.<init>(JSONObject.java:158)
09-03 19:52:03.620: W/System.err(21931):    at org.json.JSONObject.<init>(JSONObject.java:171)
09-03 19:52:03.620: W/System.err(21931):    at com.carefreegroup.WebClient.connect(WebClient.java:87)
09-03 19:52:03.620: W/System.err(21931):    at com.carefreegroup.WebserviceActivity.onCreate(WebserviceActivity.java:31)
09-03 19:52:03.620: W/System.err(21931):    at android.app.Activity.performCreate(Activity.java:4543)
09-03 19:52:03.620: W/System.err(21931):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)
09-03 19:52:03.620: W/System.err(21931):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2181)
09-03 19:52:03.620: W/System.err(21931):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2260)
09-03 19:52:03.620: W/System.err(21931):    at android.app.ActivityThread.access$600(ActivityThread.java:139)
09-03 19:52:03.620: W/System.err(21931):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1277)
09-03 19:52:03.620: W/System.err(21931):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-03 19:52:03.620: W/System.err(21931):    at android.os.Looper.loop(Looper.java:156)
09-03 19:52:03.620: W/System.err(21931):    at android.app.ActivityThread.main(ActivityThread.java:5045)
09-03 19:52:03.620: W/System.err(21931):    at java.lang.reflect.Method.invokeNative(Native Method)
09-03 19:52:03.630: W/System.err(21931):    at java.lang.reflect.Method.invoke(Method.java:511)
09-03 19:52:03.630: W/System.err(21931):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-03 19:52:03.630: W/System.err(21931):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-03 19:52:03.630: W/System.err(21931):    at dalvik.system.NativeStart.main(Native Method)
09-03 19:52:03.630: D/AndroidRuntime(21931): Shutting down VM 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:07:43.830

该服务在字符串中返回带有 JSON 的 XML `tag`，您必须解析 XML 以获取它包含的 JSON。

# c# - 属性：私有方法还是私有获取/设置？

> ID：12252805
> 
> 赞同：5
> 
> 时间：2012-09-03T18:54:42.757
> 
> 标签：c#, .net, properties

如果我想将我的属性设置在一个私有类中，那么应该只能在这个类中使用和设置这个属性，更好的方法是什么？这个

```
public string Name { private get; private set } 
```

或者

```
private string Name { get; set } 
```

嗯，还有

```
private string Name { private get; private set } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-03T19:38:43.267

值得注意的是，最初，C# 不允许您在 getter 或 setter 上设置不同的访问权限，因此唯一可能的选择是：

```
public string Name { get; set; }
protected internal string Name { get; set; }
internal string Name { get; set; }
protected string Name { get; set; }
private string Name { get; set; } 
```

（就此而言，您不能拥有自动属性，并且总是必须自己写入和写入支持字段，但我们将忽略这一点，因为这样我们会有更短的示例）。

对两者进行不同的访问通常很有用，通常是比 getter 更具限制性的 setter，等等

```
public string Name { get; private set; } 
```

被介绍了。

现在，通过扩展，这似乎是合乎逻辑的，可以允许：

```
public string Name { private get; private set; }
private string Name { private get; private set; } 
```

然而，这两个表达的是什么？

第二个还不错，只是不必要的重复。尽管如此，很可能是一些混乱的想法让我们到达了那里（很可能是不完整的重构）。好的代码就像让计算机做某事一样表达你正在做的事情（如果有的话，更是如此），最好让它清楚地表达出来。

因此，如果您最终得到类似的结果，`{ private get; private set; }`那么可能值得再次查看并考虑您在这里真正想说的内容。万岁，因为它是一个编译器错误。

第一种情况更糟。它说“这个属性是公共的，除了 setter 是私有的，getter 是私有的”。这也不例外，“就是这件事，除了一直”不是任何事情的真实表达。加倍欢呼编译器不让我们这样做。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-03T19:02:10.943

你试过编译你的例子吗？只有中间的会翻译。

如果要指定额外的可访问性级别关键字，则只能在其中一个访问器（getter/setter）上执行，并且访问器的该级别必须比整个属性的可访问性更具限制性。

在这里您可以看到规则：[限制访问器可访问性](http://msdn.microsoft.com/en-us/library/75e8y5dd.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T18:58:31.150

```
public string Name { get; private set; } 
```

这就是我认为你想要做的。

除非您只想让您的班级看到它，否则在财产公开时尝试将其设为私有是没有意义的。在这种情况下，您应该使用：

```
private string Name { get; set; } 
```

更新：在第二次阅读时，您肯定想要第二个示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-05T14:58:10.503

对于私有成员，您不需要定义访问器。只需这样做：

```
private string _name; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T18:57:56.420

更好的方法取决于你想要什么：

`public string Name { private get; private set }`该属性是，`public`但除了类本身之外，**没有**人可以读取或写入它。那是完全没用的，所以使用 just `private string Name { get; set }`。

一般来说，如果您将属性视为几种方法（实际上是）

```
private string get_Name() {  }

private string set_Name(value) {  } 
```

我希望，有可能将该标识符应用于属性的原因`get/set`变得显而易见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-06T23:28:58.403

好像你想要

```
private string name;

public string Name

{

    get { return name; }

    set { name = value; }

} 
```

这将允许您访问`private string Name`.

# php - 如何将本地 MySQL 数据库导入 Web 服务器

> ID：12252808
> 
> 赞同：1
> 
> 时间：2012-09-03T18:55:03.973
> 
> 标签：php, mysql, import

我有一个包含两个表的数据库，我已将它们导出到我计算机中的“dump.sql”文件中。

我正在使用免费的网络托管服务 (000webhost.com)，我有一个名为“username_newdb”的数据库，我希望将这两个表导入该数据库。

我从 phpmyadmin 页面尝试了“导入”，但它给出了拒绝用户访问的错误，我不知道为什么。此外，我更喜欢将表导入新数据库，而不是导入（和创建）整个数据库。我可以这样做吗？也许使用 PHP 代码？

如果没有，也可以接受创建新数据库。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:58:45.443

如果您可以直接从您的计算机连接到该数据库，则可以使用任何 mysql 管理器进行导入，假设您的登录名/密码正确，因为备份 sql 只是带有一堆`INSERT`s 和`CREATE TABLE`s 的文本文件（所以基本上 phpmyadmin 甚至不应该投诉）。

# ios - ARC 的内存问题

> ID：12252812
> 
> 赞同：3
> 
> 时间：2012-09-03T18:55:13.600
> 
> 标签：ios, memory-leaks, automatic-ref-counting, avfoundation, avaudioplayer

我使用 ARC 构建了一个相当简单的应用程序。但是，我遇到了内存不足，但我不知道是什么原因造成的。由于我无法澄清是什么原因造成的，因此我有一些具体的细节和问题。

当我尝试加载新的视图控制器时，问题就出现了。`AVAudioPlayer`这个视图控制器承载了许多图像，并且在加载时会在我拥有的单例类中添加一个 3-4 分钟的音频文件。

当视图控制器被推送和弹出 8-10 次时会出现问题。当视图控制器弹出时，我调用`stop`并将`AVAudioPlayer`所有相关对象（包括`AVAudioPlayer`实例）返回为零。

我真的不明白是什么导致了内存泄漏，或者还有什么可能会破坏设备内存，但我确实有一些具体的问题。

停止时`AVAudioPlayer`，是否仍允许在内存中适当释放？

`AVAudioPlayer`调用后将指针设置为 nil 会`stop`阻止系统从设备内存中释放某些数据吗？

在 ARC 中，当所有者被释放时不应该释放任何东西（我问的是我的所有视图和数据`UIViewController`都从堆栈中弹出）吗？

我应该知道 ARC`AVFoundation`或ARC 中有什么问题吗？`AVAudioPlayer`

是否`stop`以错误的方式结束音频会话/是否已将其释放？

编辑：我已经开始使用工具工具来跟踪我的分配和泄漏。没有任何内存泄漏，或者工具说，但应用程序会崩溃，几乎不管活动字节。当使用的总 RAM 超过 200MB（210-230MB - 我的设备有 256MB 的 RAM）时，应用程序将崩溃。我的新问题是分配的总字节数（即使它们不存在）会影响内存崩溃吗？如果是这样，我该如何防止这种情况？

[这](http://i.imgur.com/W5hyh.png)是崩溃的运行图像。你可以在最后看到一堆内存警告。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T20:01:36.423

Q) 当视图控制器被推送和弹出 8-10 次时会出现问题。当视图控制器弹出时，我在 AVAudioPlayer 上调用 stop 并将所有相关对象（包括 AVAudioPlayer 实例）返回为零。A）添加一个dealloc方法并记录dealloc，所以你知道没有保留那些，然后在控制台中查找这些：

```
- (void)dealloc
{
  NSLog(@"MySpecialViewController getting dealloced!");
} 
```

如果你没有看到这些东西正在保留这个对象 - 可能是一个委托。

问）我真的不明白是什么导致了内存泄漏，或者还有什么可能会破坏设备内存，但我确实有一些具体的问题。A）您应该在 Instruments（和 Leaks）中使用 ObjectAlloc。这些非常易于使用 - 在模拟器中使用它们运行项目，只需使用默认值，您就会立即获得很多有用的信息。您可以看到 WHAT 正在泄漏，这应该会有所帮助。

Q) 停止 AVAudioPlayer 时，是否仍允许在内存中正确释放？A）不。你必须将你的强 ivar/属性设置为 nil （你说你正在这样做）。我刚刚检查过，AVAudioPlayer 没有保留委托。也就是说，作为一般规则，当我关闭任何东西时：

```
[something stop/cancel/etc]; 
something.delegate = nil; 
something = nil; 
```

调用 stop 后将 AVAudioPlayer 指针设置为 nil 会阻止系统从设备内存中释放某些数据吗？

Q) 在 ARC 中，当所有者被释放时不应该释放任何东西（我问的是我的 UIViewController 中的所有视图和数据从堆栈中弹出）吗？A）如果唯一保留 ViewController 的东西，例如 navigationController 的 viewControllers 数组，那么是的，你的 viewController 子类应该被释放，所有强属性和 ivars 也将被释放。

Q) 我应该知道 ARC 中的 AVFoundation 或 AVAudioPlayer 有什么问题吗？A）我不知道，因为这是一个受欢迎的课程，所以您的问题出在您的代码中。

Q) 调用 stop 是否是结束音频会话的错误方式/是否已将其释放？A）如果是我：

```
[avPlayer stop];
avPlayer.delegate = nil;
avPlayer = nil; 
```

编辑：如果您在应用程序运行时收到内存警告，则说明您正在泄漏或消耗大量内存。在收到此警告的位置设置断点，停止应用程序并查看分配情况。我从来没有真正收到过内存警告（我只使用 ARC）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:17:29.267

使用 ARC 时很容易遇到内存问题的一个领域是，您正在与需要来自后台线程的主线程的 Cocoa Touch API 进行交互。

听起来您并不反对这一点，但是如果您开始看到不一致的行为（例如，似乎是随机崩溃、对象过早超出范围等），那么值得投入一些精力来查看您是否正在交互来自后台线程的 Cocoa Touch。

有时来自 Cocoa Touch 的回调（可能会假设在主线程上）不是（我们在一些 Game Center API 中看到了这一点）。

# css - 如何在控制行内使用标签

> ID：12252815
> 
> 赞同：4
> 
> 时间：2012-09-03T18:55:27.320
> 
> 标签：css, twitter-bootstrap

我正在尝试使用 Boostrap 来布局具有水平行输入的表单（a la“控制行”），但标签位于表单输入*上方。*有关示例，请参见下面的布局。

Boostrap可以做到这一点吗？我试图避免诉诸一百万行/跨度# div，但如果没有大量自定义 CSS，就找不到另一种实现方式。我目前的计划是使用表格进行测试：/ 请让我摆脱这种命运！

```
标签1 标签2
| 输入 | | 输入 |

标签 3
| 长输入 |

标签 4 标签 5
| 输入 | | 输入 |

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T13:21:27.593

我能够在不使用表格的情况下完成这项工作，使用控制行和控制组类的组合。

```
<div class="container">
<form>
    <div class="controls-row">
        <div class="control-group">
            <label for="first-name" class="control-label">First Name:</label>
            <div class="controls">
                <input type="text" id="first-name" name="FirstName" />
            </div>                
        </div>
        <div class="control-group">
            <label for="middle-initial" class="control-label">M.I.:</label>
            <div class="controls">
                <input type="text" id="middle-initial" name="MiddleInitial" class="input-mini" />
            </div>                
        </div>
        <div class="control-group">
            <label for="last-name" class="control-label">Last Name:</label>
            <div class="controls">
                <input type="text" id="last-name" name="LastName" />
            </div>                
        </div>
    </div>
    <div class="control-row">
         <div class="control-group">
            <label for="ssn" class="control-label">Social Security Number:</label>
            <div class="controls">
                <input type="text" id="ssn" name="SocialSecurityNumber" />
            </div>                
        </div>
        <div class="control-group">
            <label for="dob" class="control-label">Date of Birth:</label>
            <div class="controls input-append">
                <input type="text" id="dob" name="DateOfBirth" />
                <a href="#" class="btn btn-small"><i class="icon-calendar"></i></a>
            </div>
        </div>           
    </div>
</form> 
```

​​​​​​​​​​​​​​​​​</p>

不过，为了让它正常工作（因为控制组 div 是`display: block;`，我必须重写该类并添加`vertical-align: top;`以下内容）：

```
.control-group {
    display: inline-block;
    vertical-align: top;
} 
```

结果是这样的：http: [//jsfiddle.net/bhGyz/](http://jsfiddle.net/bhGyz/)

# javascript - chrome.storage.local.get 如何设置值？

> ID：12252817
> 
> 赞同：6
> 
> 时间：2012-09-03T18:55:36.113
> 
> 标签：javascript, google-chrome-extension, local-storage

```
var storage = chrome.storage.local;
var css = "old";
storage.set({'css': 'new'});
storage.get('css', function(items) {
    if (items.css) {
        css = items.css;
        console.log(css);
    }
});
console.log(css); 
```

我正在尝试升级我的 chrome 扩展以适应清单版本 2。
当我运行上面的代码时，我得到第一个 console.log 返回“新”，第二个返回“旧”。如果我想将 css 设置为新值，如何获得两个“新”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-08T20:58:44.090

I will explain why you are getting that behavior and how to fix.

This is your code:

```
var storage = chrome.storage.local;
var css = "old";
storage.set({'css': 'new'});
storage.get('css', function(items) {
  if (items.css) {
    css = items.css;
    console.log(css);
  }
});
console.log(css); 
```

First of all you should know that by design, most of javascript API (at least from browser) accesing I/O is asynchronic , this include the chrome.storage API because it access a DB/filesystem or something implying I/O operations

Second, the Javascript code combine both, synchronous and asynchronous code running, hence the confusion

Asynchronous code runs on JS EventLoop , always **after** your synchronous code (there is no threads on JS), so, in your code, 5 always will run **before** 6:

```
var storage = chrome.storage.local; // 1
var css = "old"; // 2
storage.set({'css': 'new'}); // 3
storage.get('css', function(items) {
  // 6\. this only will run AFTER this synchronous code returns
  if (items.css) {
    css = items.css;
    console.log(css);
  }
}); // 4
console.log(css); // 5\. this always run before ANY callback 
```

In fact there is chance of things running **before** 6 and **after** 5 (depending on how fast the I/O operation completes and invoke your callback)

**Now, the solution**

You need to do in the callback whatever you want to do with the retrieved info, this style of programming you can like it or not, but it is the JS way (soon as the code turns more complex and consume more I/O api you will be worried about callback hells and it can be addressed using Promises/Deferred, but that's another matter)

```
var storage = chrome.storage.local; // 1
// var css = "old"; // 2
storage.set({'css': 'new'}); // 3
storage.get('css', function(items) {
  // 5\. this only will run AFTER this synchronous code returns
  if (items.css) {
    var css = items.css; // this variable belongs to this scope
    // do here whatever you need with the retrieved info
    // since it is CSS, maybe you want to create a new stylesheet of that (is only an example)
    var style = document.createElement("style");
    style.innerText = css;
    document.head.appendChild(style);
  }
}); // 4
// console.log(css); // can't access css here, is synchronous and it runs before the callback 
```

# c# - 使用 ASP.NET 限制对页面的访问

> ID：12252818
> 
> 赞同：0
> 
> 时间：2012-09-03T18:55:46.063
> 
> 标签：c#, asp.net-mvc-2, tempdata, aspwizard

我正在使用 ASP.net MVC 2.0 开发一个站点。有一个页面序列应该表现得像一个简单的向导，没有返回。数据应该在页面之间共享。我想只允许从当前页面重定向到向导的下一页。当前页面的视图模型应该被传递到将用于实现一些逻辑的下一页。任何用户都不应访问直接在浏览器中键入 URL 的中间页面之一。

我尝试使用带有指定键的 TempData 来保存当前页面的模型视图，并将其传递到下一个页面并检查它是否为 NULL 以呈现页面。如果 TempData 中模型视图的值为 NULL，则意味着用户重定向到此页面而不是从前一个页面。但是在某些情况下，用户可以重定向到向导的下一页，然后从站点的其他地方离开（例如，转到 FAQ 页面）。在此之后，用户可以键入已离开的向导页面的直接链接，该页面将被显示，但从逻辑上讲，它应该被重定向到错误页面。

**问题**：我怎样才能允许仅从前一个页面重定向到向导的某个页面，而不再重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T21:49:52.000

您可以将您的操作方法限制为 HttpPost：

```
[HttpPost]
public ActionResult SecondPageAction(SomeType dataFromFirstPage)
{
     ....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:14:13.200

我不完全明白。我想你想限制引用网址？如果是这样，那么你可以这样做：

```
// Action code

if(Request.UrlReferrer != "Valid url")
{
  return View("Error");
}
else
{
  // render the next page of your wizard
} 
```

您所需要的只是一些逻辑来确定每个阶段的有效 url referrer 是什么。

考虑使用 Session 来存储您的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:45:07.750

我想我会将页面值存储在会话变量中。在每个页面的控制器上检查会话变量以查看前面的步骤是否已被访问。如果不是，则将 RedirectToAction 返回到上一步。

每一步结束，验证成功后，设置会话变量显示已经完成，然后重定向到下一步。

您也可以使用会话在页面之间共享数据，尽管我知道一些开发人员对此感到畏缩......但我不太确定为什么......我喜欢会话。

# css - 嵌套CSS规则是否有效？

> ID：12252819
> 
> 赞同：0
> 
> 时间：2012-09-03T18:56:25.670
> 
> 标签：css, syntax, stylesheet

这是有效的 CSS 语法吗？

```
li:hover{
  css rules ...
  span {
    css rules ...
  }
} 
```

它有效，但我不确定它是否有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:00:24.883

你不能嵌套这样的 CSS 规则。如果要在悬停的 li 元素中选择 span 元素，则需要编写两个单独的规则：

```
li:hover{
  /* CSS */
}
li:hover span{
  /* CSS */
} 
```

除非您使用[less](http://lesscss.org)可以嵌套规则，否则它将编译为常规 CSS。

# objective-c - Objective-C 的可重复随机数生成器是 java.util.Random

> ID：12252820
> 
> 赞同：1
> 
> 时间：2012-09-03T18:56:26.497
> 
> 标签：objective-c, random

出于测试和其他目的，能够生成多个可重复随机数流通常很有用。在 Java 中，有 java.util.Random。您可以创建多个 Random 对象，每个对象都有自己的种子，以便每次运行程序时对任何特定 Random 实例的后续调用都将返回相同的伪随机数序列。我看过 arc4random 的文档，它看起来像一个很棒的生成器。但是，我看不到任何提供种子或无论如何支持多个独立实例的方法。看起来 BSD 库函数的 random() 系列是最好的方法。类似于以下摘录...

```
@interface Random : NSObject {
    @private
    char _state[256];
}

+ (Random *)getDefaultInstance;
+ (Random *)getRepeatableInstance;
- (Random *)init;
- (Random *)initWithSeed:(unsigned)seed;
- (long)nextLong;
@end

@implementation Random

- (void)setup:(unsigned)seed
{
    initstate(seed, _state, sizeof(_state));
}

- (Random *)init
{
    self = [super init];
    unsigned seed = (unsigned)arc4random();
    [self setup:seed];
    return self;
}

- (Random *)initWithSeed:(unsigned int)seed
{
    self = [super init];
    [self setup:seed];
    return self;
}

- (long)nextLong
{
    char *oldState = setstate(_state);
    long result = random();
    setstate(oldState);
    return result;
}
@end 
```

是否已经有其他东西可以做到这一点？我不关心线程安全。我不会跨线程使用生成器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:22:04.960

“是否已经有其他东西可以做到这一点？”

总是很难用“不”来回答，因为很难说我知道一切，因为我当然不知道，但是不——我从来没有遇到过这样的事情（作为 Cocoa 类，也就是说。用例本身是很常见）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:32:19.673

您想要的称为伪随机数生成。一些算法在这里[https://mathoverflow.net/questions/29494/pseudo-random-number-generation-algorithms](https://mathoverflow.net/questions/29494/pseudo-random-number-generation-algorithms)或更多信息在这里[http://en.wikipedia.org/wiki/Random_number_generators](http://en.wikipedia.org/wiki/Random_number_generators)。

使用系统函数（、 、 和`rand()`）`srand()`通常`random()`足以满足每个人的需求。`srandom()``arc4random()`

另请注意，在 obj-c 中与在 Java`long`中非常不同。`long`

# c# - 基于文本框选择搜索 Access 数据库

> ID：12252821
> 
> 赞同：0
> 
> 时间：2012-09-03T18:56:26.403
> 
> 标签：c#

```
private void btnSearchDB_Click(object sender, EventArgs e)
    {
        OleDbConnection accessConnect = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\ECM\ECM\ECM\ECM.mdb");
        DataTable dt = new DataTable();
        OleDbDataAdapter da = new OleDbDataAdapter("SELECT * FROM ECMeasurements WHERE [Job Number] LIKE " + txtJobNumber.Text, accessConnect);

        da.Fill(dt); 
        dataGridView1.DataSource = dt;

    } 
```

还有一些选项可以通过 Date.....(txtDate.Text) 和一个组合框 (cbAlloyyTemper.Text) 进行搜索。我是写三个不同的查询还是可以将所有搜索条件放在一起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T07:28:55.987

这根本不是我会这样做的方式。

如果您每次生成每个查询时都在查看同一个表，那么您不希望每次都查询数据库。相反，您应该将数据加载到数据表中，然后每次查询内存中的数据表而不是数据库。

您需要创建一个绑定源，然后将此对象的数据源设置为您的数据表对象。

对于您的gridView，您将此对象的数据源设置为您的绑定源。

像这样：-

```
OleDbConnection accessConnect = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;       Data Source=C:\ECM\ECM\ECM\ECM.mdb");
DataTable dt = new DataTable();
OleDbDataAdapter da = new OleDbDataAdapter("SELECT * FROM ECMeasurements", accessConnect);

da.Fill(dt); 
BindingSource bs = new BindingSource();
bs.DataSource = dt;
dataGridView1.DataSource = bs; 
```

现在，数据表状态的任何变化都会自动反映到您的网格视图中。

要查询 DataTable，您可以使用 DataView。DataView 允许您使用 SQL 语句等参数搜索 Datatable。语法不在我的脑海中，但它是您需要查看的方法。

查看使用 DataViews 查询 DataTables。网上有很多例子。

在您的情况下，它最适合。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:02:33.520

第一：**不要**在查询中使用字符串，而是使用[参数](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.parameters.aspx)。

第二：我会创建 3 个不同的查询，以便之后进行调试。但这一切都取决于您可以查询多少，以及您自己的舒适感。

# c++ - 使用相同的 udp 套接字进行异步接收/发送

> ID：12252822
> 
> 赞同：7
> 
> 时间：2012-09-03T18:56:49.027
> 
> 标签：c++, networking, boost, boost-asio

我在我的 udp 服务器中使用相同的套接字，以便在某个端口上从客户端接收数据，然后在处理请求后使用 ip::ud::socket ::async_send_to 响应客户端

接收也与 async_receive_from 异步完成。套接字使用相同的 ioService（毕竟它是相同的套接字）文档没有明确说明是否可以让相同的 udp 套接字从客户端 A 接收数据报（以异步方式）并可能向客户端 B 发送另一个数据报（异步发送）同时我怀疑这可能会导致问题。我最终使用相同的套接字进行回复，因为在回复另一个客户端时我无法将另一个套接字绑定到同一个服务器端口。

如何将另一个套接字绑定到同一个服务器端口？

**编辑**。我尝试将第二个 udp 套接字绑定到同一个 UDP 端口：

```
socket(ioService, boost::asio::ip::udp::endpoint(boost::asio::ip::udp::v4(), port)) 
```

当我第一次这样做时（为服务器“接收”套接字绑定）没关系，但是第二次尝试创建另一个套接字，就像它在绑定时报告错误一样（asio 抛出异常）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-04T22:13:19.300

可以有一个 UDP 套接字同时从一个远程端点接收并发送到另一个远程端点。但是，根据 Boost.Asio [Threads 和 Boost.Asio](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/overview/core/threads.html)文档，对单个对象进行并发调用通常是不安全的。

因此，这是安全的：

```
线程_1 | 线程_2
--------------------------------------------------+------------ ----------------------------
socket.async_receive_from( ... ); |
socket.async_send_to( ... ); |
```

这是安全的：

```
线程_1 | 线程_2
--------------------------------------------------+------------ ----------------------------
socket.async_receive_from( ... ); |
                                      | socket.async_send_to( ... );
```

但这被指定为不安全：

```
线程_1 | 线程_2
--------------------------------------------------+------------ ----------------------------
socket.async_receive_from( ... ); | socket.async_send_to( ... );
                                      |
```

请注意，某些函数（例如[`boost::asio::async_read`](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/async_read/overload1.html)）是*组合操作*，并且具有额外的线程安全限制。

* * *

如果满足以下任一条件，则不需要进行额外的同步，因为流将是隐式同步的：

*   所有套接字调用都发生在处理程序中，并且`io_service::run()`仅从单个线程调用。
*   `async_receive_from`并且`async_send_to`仅在同一异步操作链中调用。例如，`ReadHandler`传递给`async_receive_from`调用`async_send_to`和`WriteHandler`传递给`async_send_to`调用`async_receive_from`。

    ```
    void read()
    {
      socket.async_receive_from( ..., handle_read );  --.
    }                                                   |
        .-----------------------------------------------'
        |      .----------------------------------------.
        V      V                                        |
    void handle_read( ... )                             |
    {                                                   |
      socket.async_send_to( ..., handle_write );  --.   |
    }                                               |   |
        .-------------------------------------------'   |
        |                                               |
        V                                               |
    void handle_write( ... )                            |
    {                                                   |
      socket.async_receive_from( ..., handle_read );  --'
    } 
    ```

另一方面，如果有多个线程可能对套接字进行并发调用，则需要进行同步。考虑通过[boost::asio::io_service::strand](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/io_service__strand.html)调用函数和处理程序来执行同步，或者使用其他同步机制，例如 Boost.Thread 的[mutex](http://www.boost.org/doc/libs/1_51_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.mutex)。

* * *

除了线程安全之外，还必须考虑对象生命周期的管理。如果服务器需要同时处理多个请求，那么要注意`buffer`每个`endpoint`请求- *>处理->响应*链的所有权。Per[`async_receive_from`](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/basic_datagram_socket/async_receive_from/overload1.html)的文档中，调用者保留了*缓冲区*和*端点*的所有权。因此，通过[boost::shared_ptr](http://www.boost.org/doc/libs/1_51_0/libs/smart_ptr/smart_ptr.htm)管理对象的生命周期可能更容易。否则，如果链足够快以至于不需要并发链，那么它会简化管理，允许每个请求使用相同的*缓冲区*和*端点。*

* * *

最后，[`socket_base::reuse_address`](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/socket_base/reuse_address.html)该类允许将套接字绑定到已在使用的地址。但是，我认为这不是一个适用的解决方案，因为它通常被使用：

*   让 TCP 允许进程重新启动并侦听同一个端口，即使该端口处于某种`TIME_WAIT`状态。
*   对于UDP，允许多个进程绑定到同一个端口，允许每个进程通过多播进行接收和广播。

# php - PHPUnit - 数据库测试，如何管理它

> ID：12252823
> 
> 赞同：1
> 
> 时间：2012-09-03T18:56:54.930
> 
> 标签：php, database, unit-testing, phpunit

好吧，如标题所示，我可以想到三种管理测试数据库输出的方法（我在我的应用程序中使用 ORM，在单元测试中使用 PDO）。哪个是最好的？你如何处理这个？：

1.  使用我想要专门用于测试的数据创建数据集，并更改代码以使其读取 xml 而不是 ORM 数组（在测试类中）。

2.  创建 setUp() 方法，设置包含 ORM 数组的属性，然后处理它。

3.  与第二点相同，但使用另一个数据库，专门为测试而创建

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-03T19:09:21.907

您可能想阅读[PHPUnit 关于数据库测试的章节](https://phpunit.de/manual/current/en/database.html)。

我通过自己的瘦包装器使用 PDO，该包装器通过保存点支持嵌套事务。在引导程序中，我创建了一个测试数据库，其中包含整个生产结构以及非常基本的种子数据。在每个 setUp() 和 tearDown() 期间，我开始一个事务，然后回滚。

每个测试从原始 SQL 文件中导入它需要的数据子集。从那里，ORM 使用真正的插入等进行测试。但这仅适用于我的数据库驱动程序支持嵌套事务。如果测试开始/提交并检查成功/失败，一切仍然有效。

如果您没有嵌套事务支持，您可以在每次测试时设置和拆除整个数据库，但这会更慢。请注意，您不必总是针对真实数据库进行测试……这取决于您要测试的内容类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:04:11.767

在我的测试中，我使用了一个测试数据库。

MySQL 在其站点上有一些测试数据库。我觉得[Sakila](http://dev.mysql.com/doc/sakila/en/index.html)相当困难，所以我使用[World](http://dev.mysql.com/doc/index-other.html)数据库。

# javascript - 使用 javascript 将 onclick 事件与参数绑定

> ID：12252824
> 
> 赞同：0
> 
> 时间：2012-09-03T18:56:58.310
> 
> 标签：javascript, jquery, javascript-events

我正在使用 javascript 创建一个按钮元素并将 onclick 事件绑定到它。我正在使用下面的代码

```
function getElement (rowObject )
       {
          var element ='<div id="deptNmBtn"><button onClick=getDepartMentNm("' +   rowObject.empName+'")> <span>Add</span></button></div>';
          return element;
       } 
```

但在这里我传递了一个参数员工姓名。如果员工姓名作为没有任何空格的单个字符串传递，但当使用空格传递时，它会引发 javascript 错误，则该代码有效。

```
 SyntaxError: unterminated string literal 
```

有没有人遇到过这个错误？任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:14:15.747

您需要使用以下内容包装内联点击处理程序`'`：

```
function getElement (rowObject) {
  var element = '<div id="deptNmBtn"><button onClick=\'getDepartMentNm("' +   rowObject.empName + '")\' ><span>Add</span></button></div>';
  return element;
} 
```

**[演示](http://jsfiddle.net/pRdsS/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:18:48.077

您的代码中存在引用问题。尝试这个：

```
var element = '<div id="deptNmBtn"><button onClick="getDepartMentNm(\'' + rowObject.empName + '\')" ><span>Add</span></button></div>'; 
```

如您所见， for 的值 未加`onClick`引号。浏览器可以解析不带引号的属性，但它们最终会以空格结尾。实际上，您解析的代码如下所示：

```
<button onClick=getDepartMentNm("Employer Name")> 
```

HTML 解析器从第一个空格中剪切函数调用，并被`Name")`忽略，因为它不能被识别为有效的 HTML。JavaScript 是从“右到左”执行的，JS 尝试做的第一件事就是为函数参数获取一个有效的字符串。现在 HTML 解析器已经切掉了这个函数，JS 找不到右引号，所以它抛出了一个错误。

# javascript - 如何为多个 div 设置一个间隔？

> ID：12252825
> 
> 赞同：-1
> 
> 时间：2012-09-03T18:57:06.053
> 
> 标签：javascript

有一个 DIV 的示例。但现在我需要更多的蝙蝠。如何为所有 bats=getElementsByClassName("bat") 设置 1 个 setInterval？

```
var bat = document.getElementByID("bat");
function batAnimation(bat) {
  var frame = Math.floor(Math.random() * 4) + 1;
  switch (frame) {
    case 1:
      bat.style.backgroundPositionX=0;
      break;
    case 2:
      bat.style.backgroundPositionX=10;
      break;
    case 3:
      bat.style.backgroundPositionX=20;
      break;
    case 4:
      bat.style.backgroundPositionX=30;
      break;
  }
}
setInterval(batAnimation, 50); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:03:26.303

尝试这个：

```
 var bats = document.getElementsByClassName("bat");
    function batAnimation(bat) {
      var frame = Math.floor(Math.random() * 4) + 1;
      for(var i=0; i< bats.length;i++){
        bats[i].style.backgroundPositionX=(frame-1)*10;
      }
    }
    setInterval(batAnimation, 50); 
```

*说明：*这里 bats 是所有 div 元素的数组，我使用 for 循环遍历它并将 backgroundPositionX 分配给每个元素。

由于 getElementsByClassName 不适用于所有浏览器，因此如果不可用，请添加该功能

```
if(!document.getElementsByClassName){
 document.getElementsByClassName(clasName){
  var parent = document;
  var elements = parent.getElementsByTagName('*');
  var matching = [];
  for(var i = 0, elementsLength = elements.length; i < elementsLength; i++){
    if ((' ' + elements[i].className + ' ').indexOf(findClass) > -1) {
      matching.push(elements[i]);
    }
  }
  return matching;
 }
} 
```

# cuda - gpu上的模运算

> ID：12252826
> 
> 赞同：14
> 
> 时间：2012-09-03T18:57:19.367
> 
> 标签：cuda, gpgpu

我正在研究应该进行大量模块化计算的 GPU 算法。特别是，对有限域中的矩阵进行的各种运算，从长远来看，它们会简化为原始运算，例如： (a*b - c*d) mod m 或 (a*b + c) mod m 其中 a,b,c 和 d是模 m 的余数，m 是 32 位素数。

通过实验，我了解到该算法的性能主要受到慢模运算的限制，因为硬件 GPU 不支持整数模 (%) 和除法运算。

如果有人能告诉我如何使用 CUDA 实现高效的模块化计算，我将不胜感激？

为了了解这在 CUDA 上是如何实现的，我使用以下代码片段：

```
__global__ void mod_kernel(unsigned *gout, const unsigned *gin) {

unsigned tid = threadIdx.x;
unsigned a = gin[tid], b = gin[tid * 2], m = gin[tid * 3];

typedef unsigned long long u64;

__syncthreads();
unsigned r = (unsigned)(((u64)a * (u64)b) % m);
__syncthreads();
gout[tid] = r;
} 
```

这段代码不应该工作，我只是想看看如何在 CUDA 上实现模块化缩减。

当我用 cuobjdump --dump-sass 反汇编它时（感谢 njuffa 的建议！），我看到以下内容：

```
/*0098*/     /*0xffffdc0450ee0000*/     BAR.RED.POPC RZ, RZ;
/*00a0*/     /*0x1c315c4350000000*/     IMUL.U32.U32.HI R5, R3, R7;
/*00a8*/     /*0x1c311c0350000000*/     IMUL.U32.U32 R4, R3, R7;
/*00b0*/     /*0xfc01dde428000000*/     MOV R7, RZ;
/*00b8*/     /*0xe001000750000000*/     CAL 0xf8;
/*00c0*/     /*0x00000007d0000000*/     BPT.DRAIN 0x0;
/*00c8*/     /*0xffffdc0450ee0000*/     BAR.RED.POPC RZ, RZ; 
```

请注意，在对 bar.red.popc 的两次调用之间，有一个对 0xf8 过程的调用，该过程实现了一些复杂的算法（大约 50 条指令甚至更多）。毫不奇怪 mod (%) 操作很慢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-04T12:40:59.717

前段时间，我在 GPU 上对模运算进行了很多实验。在 Fermi GPU 上，您可以使用双精度算法来避免昂贵的 div 和 mod 操作。例如，模乘可以按如下方式完成：

```
// fast truncation of double-precision to integers
#define CUMP_D2I_TRUNC (double)(3ll << 51)
// computes r = a + b subop c unsigned using extended precision
#define VADDx(r, a, b, c, subop) \
    asm volatile("vadd.u32.u32.u32." subop " %0, %1, %2, %3;" :  \
            "=r"(r) : "r"(a) , "r"(b), "r"(c));

// computes a * b mod m; invk = (double)(1<<30) / m
__device__ __forceinline__ 
unsigned mul_m(unsigned a, unsigned b, volatile unsigned m,
    volatile double invk) { 

   unsigned hi = __umulhi(a*2, b*2); // 3 flops
   // 2 double instructions
   double rf = __uint2double_rn(hi) * invk + CUMP_D2I_TRUNC;
   unsigned r = (unsigned)__double2loint(rf);
   r = a * b - r * m; // 2 flops

   // can also be replaced by: VADDx(r, r, m, r, "min") // == umin(r, r + m);
   if((int)r < 0) 
      r += m;
   return r;
} 
```

但是，这仅适用于 31 位整数模（如果 1 位对您来说不重要），您还需要预先计算“invk”。这给出了我可以实现的绝对最少的指令，即：

```
SHL.W R2, R4, 0x1;
SHL.W R8, R6, 0x1;
IMUL.U32.U32 R4, R4, R6;
IMUL.U32.U32.HI R8, R2, R8;
I2F.F64.U32 R8, R8;
DFMA R2, R2, R8, R10;
IMAD.U32.U32 R4, -R12, R2, R4;
ISETP.GE.AND P0, pt, R4, RZ, pt;
@!P0 IADD R4, R12, R4; 
```

有关算法的描述，您可以查看我的论文： [gpu_resultants](http://domino.mpi-inf.mpg.de/intranet/ag1/ag1publ.nsf/e127ff338913b2a3c12565f4005ef860/4464641e944f3087c1257a60004f3a65/$FILE/gpu_res_2012.pdf)。其他操作，如 (x *y - z* w) mod m 也在那里解释。

出于好奇，我使用您的模乘法比较了结果算法的性能：

```
unsigned r = (unsigned)(((u64)a * (u64)b) % m); 
```

针对 mul_m 的优化版本。

具有默认 % 操作的模运算：

```
low_deg: 11; high_deg: 2481; bits: 10227
nmods: 330; n_real_pts: 2482; npts: 2495

res time: 5755.357910 ms; mod_inv time: 0.907008 ms; interp time: 856.015015 ms; CRA time: 44.065857 ms
GPU time elapsed: 6659.405273 ms; 
```

带 mul_m 的模运算：

```
low_deg: 11; high_deg: 2481; bits: 10227
nmods: 330; n_real_pts: 2482; npts: 2495

res time: 1100.124756 ms; mod_inv time: 0.192608 ms; interp time: 220.615143 ms; CRA time: 10.376352 ms
GPU time elapsed: 1334.742310 ms; 
```

因此，平均而言，它的速度大约快 5 倍。另请注意，如果您只是使用具有一堆 mul_mod 操作的内核（如*saxpy*示例）来评估*原始算术性能，您可能看不到加速。*但在具有控制逻辑、同步屏障等的实际应用中，加速非常明显。

 ** * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-04T01:13:00.747

高端的 Fermi GPU（例如 GTX 580）可能会为您提供最好的性能。您可能希望所有 32 位操作数都是“无符号整数”类型以获得最佳性能，因为处理有符号除法和模数会产生一些额外的开销。

编译器为具有固定除数的除法和模数生成非常有效的代码我记得在 Fermi 和 Kepler 上通常大约有三到五个机器指令指令。您可以使用 cuobjdump --dump-sass 检查生成的 SASS（机器代码）。如果您只使用几个不同的除数，您也许可以使用带有常量除数的模板函数。

您应该看到在 Fermi 和 Kepler 中为具有变量除数的无符号 32 位操作生成了大约 16 个内联 SASS 指令。代码受到整数乘法吞吐量的限制，对于 Fermi 级 GPU 而言，与硬件解决方案相比具有竞争力。由于整数乘法吞吐量降低，目前出货的 Kepler 级 GPU 的性能有所降低。

[在澄清问题后添加：]

另一方面，无符号 64 位除法和带变量除数的模被称为 Fermi 和 Kepler 上大约 65 条指令的子程序。它们看起来接近最佳状态。在 Fermi 上，这仍然与硬件实现相当有竞争力（请注意，64 位整数除法在提供此作为内置指令的 CPU 上并不是非常快）。下面是我在 NVIDIA 论坛上发布的一些代码，用于说明中描述的那种任务。它避免了昂贵的除法，但确实假设相当大批量的操作数共享相同的除数。它使用双精度算术，这在特斯拉级 GPU 上尤其快（与消费卡相反）。我只是对代码进行了粗略的测试，您可能希望在部署之前更仔细地测试它。

```
// Let b, p, and A[i] be integers < 2^51
// Let N be a integer on the order of 10000
// for i from 1 to N
// A[i] <-- A[i] * b mod p

/*---- kernel arguments ----*/
unsigned long long *A;
double b, p; /* convert from unsigned long long to double before passing to kernel */
double oop;  /* pass precomputed 1.0/p to kernel */

/*---- code inside kernel -----*/
double a, q, h, l, rem;
const double int_cvt_magic = 6755399441055744.0; /* 2^52+2^51 */

a = (double)A[i];

/* approximate quotient and round it to the nearest integer */
q = __fma_rn (a * b, oop, int_cvt_magic);
q = q - int_cvt_magic;

/* back-multiply, representing p*q as a double-double h:l exactly */
h = p * q;
l = __fma_rn (p, q, -h);

/* remainder is double-width product a*b minus double-double h:l */
rem = __fma_rn (a, b, -h);
rem = rem - l;

/* remainder may be negative as quotient rounded; fix if necessary */
if (rem < 0.0) rem += p;

A[i] = (unsigned long long)rem; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T03:00:05.293

有一些技巧可以有效地执行 mod 操作，但如果只有 m 是基数 2。

例如，x mod y == x & (y-1)，其中 y 是 2^n。执行按位运算是最快的。

否则，可能是一个查找表？下面是关于高效模实现讨论的链接。您可能需要自己实现它才能充分利用它。

[mod的高效计算](https://stackoverflow.com/questions/980702/efficient-cycles-wise-algorithm-to-compute-modulo-25)*

# jquery - JQuery 和 Google Maps JS api 不能一起工作

> ID：12252828
> 
> 赞同：0
> 
> 时间：2012-09-03T18:57:38.137
> 
> 标签：jquery, google-maps-api-3, spring-roo, google-fusion-tables

我真的很难在同一个块中同时使用 Google Maps API 和 JQuery API。我的页面是 jspx (Spring)，我需要 JQuery 以便我可以获取和解析 google 融合表数据。

但是，当我将两个库一起声明时，地图 div 将不会加载（如果我单独加载谷歌地图，所有映射都可以正常工作）。

以下是相关代码：

```
<script src="http://code.jquery.com/jquery-latest.pack.js" type="text/javascript"/>
                    <script src="http://maps.googleapis.com/maps/api/js?v=3key=MYKEY&amp;sensor=false" type="text/javascript">
                        <jsp:text/>
                    </script>
                    <script type="text/javascript">
        //<![CDATA[ 
            var map;

function initialize() {
         var mapDiv = document.getElementById('map_canvas');
         var geocoder = new google.maps.Geocoder();
         retrieveDeprivationFigure();
          if (geocoder) {
             geocoder.geocode({ 'address': '${property.postcode}' }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {

                var latlng = new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng())
                var mapOptions = {
                    zoom: 15,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                  };

                map = new google.maps.Map(document.getElementById('map_canvas'),
                        mapOptions); 
}

        function retrieveDeprivationFigure(){
                var postcode = '${property.postcode}'.split(' ').join('');
                var url = "https://www.googleapis.com/fusiontables/v1/query?sql=SELECT LSOA FROM XXXXXXXX WHERE Postcode='"+ postcode +"'&key=AIzaSyBQaHw1aSWtIjQzAiriBPC3hvm7Bs1R35U&jsonCallback=?";
                var localIMDS;
                console.log("this far");
                $.getJSON(url,
                        function retrieveIMDS(){
                    console.log(url);

                });
         };

  google.maps.event.addDomListener(window, 'load', initialize);   
         // ]]>
</script> 
```

任何指针或想法都会对我有很大帮助，我什至尝试在单独的 JS 块中通过 JQuery 检索剥夺统计信息，但是尽管我努力了，但在页面加载时并未调用该函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:45:38.607

您缺少第一个脚本的结束标记，包括：

```
<script src="http://code.jquery.com/jquery-latest.pack.js" type="text/javascript"/>
<script src="http://maps.googleapis.com/maps/api/js?v=3key=MYKEY&amp;sensor=false" type="text/javascript">
                    <jsp:text/>
                </script> 
```

应该：

```
<script src="http://code.jquery.com/jquery-latest.pack.js" type="text/javascript" ></script>
<script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script> 
```

（任何一个命令都应该可以工作，并且应该在没有版本规范和 &key=MYKEY 的情况下也可以工作，只是注意到您在 key=MYKEY 之前也缺少 &）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T10:14:11.927

感谢您的指导，但我设法通过创建一个头并在头文件中声明 jQuery 并将 google src 留在原处来解决冲突和问题。

```
 <head>
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.1.js"></script>
 <script type="text/javascript">

 </script>
 </head> 
```

再次感谢！

# php - 在页面刷新或注销时保持表格单元格突出显示

> ID：12252830
> 
> 赞同：0
> 
> 时间：2012-09-03T18:57:53.670
> 
> 标签：php, jquery, html

我有一个包含数据的 6 列表。我想特别关注由三个选项组成的下拉菜单。选择选项后，该行上的表单元格更改颜色。使用 jQuery 可以完美地工作，但是我希望在刷新页面或用户注销时颜色保持不变。这可以通过使用数据库来实现吗？由于多人将使用该表格，因此 cookie 可能不是一个选项。这是我当前代码的细分：

jQuery：突出显示表格单元格

```
<script type="text/javascript">
    $(document).ready(function() 
    {
        var color = ['none', '#DEF3CA', '#EECFA1', '#FFCCCC'];
        $('table').on('change','select', function() {
            $(this).parents('tr').css('background', color[$(':selected', this).index()]); 
        });
    });
</script> 
```

选择框：

```
echo ' <select name="status">
<option></option>
<option>Approved</option>
<option>Pending</option>
<option>Dissaproved</option>
</select>';
echo "</td><td>"; 
```

谢谢你

# php - 首字母大写并去掉 html 代码

> ID：12252832
> 
> 赞同：0
> 
> 时间：2012-09-03T18:57:56.763
> 
> 标签：php, javascript

我有以下 html 页面：我想要做的是大写第一个字母（它可以正常工作）并删除任何 html 代码或任何具有“<”“/>”组合的代码的文本框>" 所以用户不能插入恶意代码在服务器端执行。

我找到了一个剥离代码：

```
var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig,""); 
```

如何将上面的代码添加到下面的页面，以便两者兼顾？

```
<?php
/**
 * ****************************************************************************
 * Micro Protector
 * 
 * Version: 1.0
 * Release date: 2007-09-10
 * 
 * USAGE:
 *   Define your requested password below and inset the following code
 *   at the beginning of your page:
 *   <?php require_once("microProtector.php"); ?>
 * 
 *  
 * 
 ******************************************************************************/

$Password = 'TESTPASS'; // Set your password here

/******************************************************************************/
   if (isset($_POST['submit_pwd'])){
      $pass = isset($_POST['passwd']) ? $_POST['passwd'] : '';

      if ($pass != $Password) {
         showForm("Wrong password");
         exit();     
      }
   } else {
      showForm();
      exit();
   }

function showForm($error="LOGIN"){
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html>
<head>
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
   <title>IMC - Authentication</title>
   <link href="style/style.css" rel="stylesheet" type="text/css" />
<Script>
<!--
function capitalize(form) {
    value = form.value;
    newValue = '';
    value = value.split(' ');
    for(var i = 0; i < value.length; i++) {
        newValue += value[i].substring(0,1).toUpperCase() +
        value[i].substring(1,value[i].length) + '';
    }
form.value = newValue;
}
-->
</Script>
</head>
<body>
<center><a href="http://www.test.com"><img src="test.png" border=0 /></a></center>
<br><br><br>
    <div id="main">
      <div class="caption"><?php echo $error; ?></div>
      <div id="icon">&nbsp;</div>
      <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post" name="pwd">
    Your Name:
        <table>
          <tr><td><input class="text" name="name" onBlur="capitalize(this);" maxlength=12 type="text" /></td></tr>
        </table> 
        Password:
        <table>
          <tr><td><input class="text" name="passwd" maxlength=8 type="password" /></td></tr>
          <tr><td align="center"><br/>
             <input class="text" type="submit" name="submit_pwd" value="Login" />
          </td></tr>
        </table>  
      </form>
   </div>
</body>
</html>

<?php   
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:00:28.470

`newValue = newValue.replace(/(<([^>]+)>)/ig,"");`之前添加`form.value = newValue;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:01:39.527

我希望您意识到任何恶意用户都可以完全绕过您的功能。我所要做的就是把它放在`capitalize=function(){}`我的控制台中，突然之间我就可以写出我想要的东西了……或者我可以禁用 JavaScript。无论哪种方式，我都可以将我喜欢的任何内容发送到您的服务器。

在服务器端，您应该使用 PHP 之类的函数[`htmlspecialchars`](http://php.net/htmlspecialchars)来防止 HTML 被注入到用户的浏览器中，并且当您使用它时，您可以使用[`ucfirst`](http://php.net/ucfirst)大写首字母（或[`ucwords`](http://php.net/ucwords)每个单词的首字母）。

# objective-c - Xcode [objective-c] cocos2d CCScrollLayer 中的无响应按钮

> ID：12252834
> 
> 赞同：0
> 
> 时间：2012-09-03T18:58:00.210
> 
> 标签：objective-c, xcode, button, cocos2d-iphone

我有一个用于更改游戏场景的按钮，我把它放在 CCSCrollLayer 中，它停止工作，这是我的代码：

```
 // create a blank layer for page 1
    CCLayer *pageOne = [[CCLayer alloc] init];

    // create a button for page 1
    CCMenuItem *level1 = [CCMenuItemImage
                          itemFromNormalImage:@"level_skatepark_icon.png" selectedImage:nil
                          target:self selector:@selector(level1Tapped:)];
    level1.position = ccp(winSize.width/2, winSize.height/2 - 28);

    // add button to page 1 layer
    [pageOne addChild:level1];

    // now create the scroller and pass-in the pages (set widthOffset to 0 for fullscreen pages)
    CCScrollLayer *scroller = [[CCScrollLayer alloc] initWithLayers:[NSMutableArray arrayWithObjects: pageOne,pageTwo,pageThree,pageFour,nil] widthOffset: 150];

    // finally add the scroller to your scene
    [self addChild:scroller]; 
```

听者：

```
- (void)level1Tapped:(id)sender {
    //Goto level SkatePark!
    [[CCDirector sharedDirector] replaceScene:[HelloWorldLayer scene]];
} 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T05:26:15.760

不要将 CCMenuItems 直接添加到图层。将它们添加到 CCMenu 对象并将此菜单添加到图层。

# html-parsing - 简单的 HTML Dom 解析器：如何插入元素

> ID：12252843
> 
> 赞同：5
> 
> 时间：2012-09-03T18:58:54.563
> 
> 标签：html-parsing, simple-html-dom

我正在尝试将（附加）插入到元素中……特别是“主体”。

我现在可以这样做：

```
$var = "some JS stuff";
$e = $htmlDOM->find("body", 0);
$e->outertext = '<body>' . $e->innertext . $var . '</body>'; 
```

我的问题是这个修复`<body>`，但实际的 html 可能附加了 js 或 id 等`<body>`，如果是这样，我想保持这种情况。

文档似乎没有为此提供方法。

是否可以？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-05T16:30:46.757

查看源代码后，我发现它的方法是使用

```
$var = "some JS stuff";
$e = $htmlDOM->find("body", 0);
$e->outertext = $e->makeup() . $e->innertext . $var . '</body>'; 
```

也就是说，未记录的`makeup()`函数将构建标签和任何相关的文本/代码。

# php - 如何要求 PHP Mailparse 进入脚本

> ID：12252845
> 
> 赞同：-1
> 
> 时间：2012-09-03T18:59:04.043
> 
> 标签：php, parsing, email, include, require

我在我的 VPS 上安装了 PHP 的 Mailparse 扩展 (PECL)。现在我想用它制作一个脚本，但不知道如何将它包含到我的脚本中。

`dl()`在我的服务器上不起作用，所以我需要`require()`或`require_once()`

PHP 的路径是 /usr/bin/php

据我所知，这可能是类似的`require_once("Mail/[something here]")`，但我找不到任何关于它的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:02:24.080

不需要在脚本中启用二进制扩展。他们只是用新的函数和方法扩展了 PHP，所以你可以像使用它一样使用它，就像它是 PHP 本身的一部分一样。但是，如果您依赖 3rd 方扩展，最好检查它是否已安装，否则您的脚本将因语法错误而失败。使用[get_loaded_extensions()](http://php.net/manual/en/function.get-loaded-extensions.php)并检查结果是否存在您需要的任何扩展。

# html - HTML + CSS Thumbnail help - 仅定位缩略图

> ID：12252847
> 
> 赞同：1
> 
> 时间：2012-09-03T18:59:42.937
> 
> 标签：html, css, positioning, thumbnails

所以基本上我正在尝试在我的网站上添加自定义缩略图。我`<ol>`在css中使用它并对其进行样式设置，例如..

```
ol {
    counter-reset: none;         
    margin: 0px;         
    padding: 0px;       
    list-style-image: url('{image:thumbNail}');      
    position: relative;     
    right: 20px;     
} 
```

但我想在不影响我在`<ol>`. 我怎样才能做到这一点，所以我不影响文本，而只是定位缩略图？帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:17:37.130

这是一个小提琴：http: [//jsfiddle.net/enn5r/](http://jsfiddle.net/enn5r/)

```
<ol class="thumnails">
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
</ol> 
```

* * *

```
ol.thumbnails li{
  padding:5px 0px 5px 25px;
  border-bottom:1px solid #DDD;
  background:transparent url(/icons/clock.png) no-repeat 5px 7px;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:20:19.090

您应该删除`position:relative;`以`ol`列出并给出它并使用和CSS 属性`position:absolute;`对齐它。但是如果应用了父标签，这一切都会正常工作。您也可以使用它来工作，但这不是正确的方法，因为它会在不同的屏幕分辨率上移动元素。`left``top``ol``position:relative;``position:relative;`

# jquery - jQuery 脚本不会在点击时打开 iframe

> ID：12252851
> 
> 赞同：0
> 
> 时间：2012-09-03T19:00:12.447
> 
> 标签：jquery, wordpress

我正在开发一个用于 WordPress 小部件的 jQuery 脚本。当用户点击“上传”按钮时，一个 iframe 应该会弹出一个图像上传器。现在，那个按钮不起作用。iframe 打不开。这是我的脚本：

```
jQuery(document).ready(function() {

jQuery('#upload_image_button').click(function() {
 formfield = jQuery('#upload_image').attr('name');
 tb_show('', 'media-upload.php?type=image&TB_iframe=true');
 return false;
});

window.send_to_editor = function(html) {
 imgurl = jQuery('img',html).attr('src');
 jQuery('#upload_image').val(imgurl);
 tb_remove();
}

}); 
```

这是输入字段和按钮：

```
<input id="upload_image" class="widefat" type="text" size="36" name="upload_image" value="<?php echo esc_url( $image ); ?>" />
<input id="upload_image_button" type="button" value="Upload Image" /> 
```

# ios - 视图控制器的内存管理

> ID：12252855
> 
> 赞同：0
> 
> 时间：2012-09-03T19:00:24.687
> 
> 标签：ios, memory-management

我正在创建视图控制器，其中包含一些要显示的信息（图像、按钮、手势、文本等）并将它们添加到滚动中。

```
productsVCs = [[NSMutableArray alloc] init];

for (int i = 1; i <= [self.products count]; i++) {
    productsSingle *single = [[productosSingle alloc] init];
    single.view.frame = CGRectMake(x, y, 200, 148);
    single.delegate = self;
    [single setInfo:[self.products objectAtIndex:i-1]];
    [scroll addSubview:single.view];
    [productsVCs addObject:single];
} 
```

正如你所看到的，我正在使用我分配的这些视图控制器做三件重要的事情，我写了我认为让 ARC 释放这些对象所需的内容。

1）设置代表。- 我必须将代表设置为零吗？

2）将视图添加为子视图。- 从超级视图中删除？

3) 将控制器添加到数组中。- 从阵列中移除？

我的问题是，这些视图控制器何时被释放？使用弧。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:19:36.050

当您的 ViewController（具有滚动视图）将被释放时，该对象`productsSingle`将被释放。

ARC 在编译时工作，因此 ARC 会为您插入对`release`对象的方法调用。当您将编译项目时，ARC 插入对`release`方法的调用，如下所示：

```
[single setInfo:[self.products objectAtIndex:i-1]];
[scroll addSubview:single.view];
[single release]; //ARC inserts this line 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:20:15.793

如果您使用 ARC，则不必担心释放对象，因为 ARC 会为您完成。您仍然可以在控制器中设置强持有的实例变量，以便在您的`viewDidUnload`方法中释放。

现在，当任何持有对它们的引用被释放时，您的视图控制器将被释放，在这种情况下，它将是应用程序本身或创建控制器的另一个控制器。如果您不持有对它的引用，那么只要您退出代码块，它就会被释放。

[这是使用 ARC 的小指南](http://blog.teamtreehouse.com/ios-5-automatic-reference-counting-arc)

# json - Kendo UI 循环遍历 ListView 模板中 Json 中的集合

> ID：12252859
> 
> 赞同：14
> 
> 时间：2012-09-03T19:00:34.213
> 
> 标签：json, listview, templates, razor, kendo-ui

我试图在列表视图的 Kendo UI 模板中找出如何循环遍历每个对象中的集合以在页面上呈现信息。这是我正在使用的 json 示例：

```
{"Data":[{"Title":"Malicious Acts","KeyPairs":{"Key1":"12","Key2":"24"}},            {"Title":"Enrollments","KeyPairs":{"Key1":"12","Key2":"24"}},{"Title":"Customer Feedback","KeyPairs":{"Key1":"12","Key2":"24"}},{"Title":"Questionable Accounts","KeyPairs":{"Key1":"12","Key2":"24"}}],"Total":4,"AggregateResults":null,"Errors":null} 
```

我想在模板中呈现 KeyPairs 项目，只是在理解如何做时遇到了一些麻烦。

这是来源：

```
<div id="subscriberFunctions">

    <script type="text/x-kendo-tmpl" id="template">
        <div class="subscriberFunction">
            <h3>${Title}</h3>
           <!-- Display KeyPairs -->
        </div>
    </script>

    @(Html.Kendo().ListView<SubscriberMenuFunction>()
        .Name("listView")
        .TagName("div")
        .ClientTemplateId("template")
        .DataSource(dataSource =>
        {
            dataSource.Read(read => read.Action("SubscriberMenu", "ListView"));
        })
        .Selectable(selectable => selectable.Mode(ListViewSelectionMode.Single))

    )
</div> 
```

我确定我只是想多了，这很简单，但不确定如何在模板中实现 foreach 循环以便 Kendo UI 识别它。

提前致谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-21T12:58:28.007

您可以使用 for 循环中的计数器来执行此操作。这应该可以解决您的问题：

```
<script type="text/x-kendo-tmpl" id="template">
    <div class="subscriberFunction">
        <h3>${Title}</h3>
        <!-- Display KeyPairs -->
        <ul>
            #for (var i=0,len=KeyPairs.length; i<len; i++){#
                <li>${ KeyPairs[i] }</li>
            # } #
        </ul>
    </div>
</script> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-04T05:56:01.423

您可以在模板中包含任意 JavaScript 代码：

```
<script type="text/x-kendo-tmpl" id="template">
    <div class="subscriberFunction">
        <h3>${Title}</h3>
       <!-- Display KeyPairs -->
         <ul>
         # for (var key in KeyPairs) { #
              <li>${ KeyPairs[key] }</li>
         # } #
         </ul>
    </div>
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-23T15:39:42.637

一旦您知道语法，就可以遍历集合。这基本上是斯坦斯用更清晰的语法回答。如果您使用的是列表，则只需添加它们即可访问属性，例如，`<li>#=KeyPairs[i].FooBar#</li>`

```
<script type="text/x-kendo-tmpl" id="template">
    <div class="subscriberFunction">
    <h3>#=Title#</h3>
    <ul>
        # for (var i = 0; i < KeyPairs.length; i++) { #
            <li>#=KeyPairs[i]#</li>
        # } #
    </ul>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-23T21:31:36.033

这是在客户端模板中循环集合的另一种优雅方式

```
<script type="text/x-kendo-tmpl" id="template">
    <div class="subscriberFunction">
        <h3>${Title}</h3>
          # var t=KeyPairs.join('<br>'); # 
          #=t #
    </div>
</script> 
```

# java - java：从实现的接口类调用一个类中变量的值

> ID：12252860
> 
> 赞同：1
> 
> 时间：2012-09-03T19:00:40.767
> 
> 标签：java, class, interface

我在 java 中有一个 A 类，它在变量 alpha 中设置一个值。类 A 调用接口“MessageListener”的函数，如下所示：

```
private List<MessageListener> mListeners;

for (MessageListener ml : this.mListeners) 
{
ml.messageTransferred(aMessage, from, this.host, isFirstDelivery);
} 
```

我想将 alpha 传递给实现上述接口的 MessageStatsReport.java 类的 messageTransferred 函数。

如果我修改 messageTransferred 函数的参数，这会影响来自同一接口 (MessageListener) 的 12 个其他类。那么什么是简单的出路呢？如何调用在 A 类中设置的（非静态）变量值。请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:24:52.683

接下来制作方法

```
messageTransferred(aMessage, from, this.host, isFirstDelivery, alpha)  
{   
   if (alpha != null)  
   {
   // ...  
} 
```

现在，当您想将 alpha 传递给方法时，请使用

```
messageTransferred(aMessage, from, this.host, isFirstDelivery, alpha); 
```

当你不想使用 alpha 时，传递`null`而不是 alpha

```
messageTransferred(aMessage, from, this.host, isFirstDelivery, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:16:21.433

If the array of messageListeners is called by A then how is any MessageListener supposed to 'know' about alpha? A called method can not access properties or methods of the callee inside of it since the type of the callee may change. You have to pass alpha around if you want A to be aware of it.

Notice that you are changing the **contract** that MessageListener defines by having it deal with another parameter, if it were possible to breach the interface's contract without anyone knowing about it, well that wouldn't make any sense (in java's perspective, some languages do allow this).

You are passing a message, shouldn't alpha be a part of that message? in what format is aMessage?

One solution is to define an interface that defines that what an actual message transfered looks like. In a simplified way, you can have a `message` interface and have a `SimpleMessage` and `ComplicatedMessage` that implement it. aMessage can be of that type and you can handle the contents based on what the interface defined.

# .net - 异步文件保存

> ID：12252861
> 
> 赞同：0
> 
> 时间：2012-09-03T19:00:43.797
> 
> 标签：.net, file-io, asynchronous, task-parallel-library

在我的程序（.net framework 4）中，我想发布异步文件保存。我必须使用什么？**Task**类还是**BeginWrite**方法？有什么不同？什么是更好的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:04:44.480

您可以使用[Task.Factory.FromAsync](http://msdn.microsoft.com/en-us/library/dd321543)将`BeginWrite`/`EndWrite`方法对包装到`Task<T>`. 这将允许您使用 TPL 编写异步代码，同时仍使用底层异步 IO 方法。

# amazon-ec2 - 将 Spot 实例添加到 RDS 实例的安全组

> ID：12252862
> 
> 赞同：1
> 
> 时间：2012-09-03T19:00:47.973
> 
> 标签：amazon-ec2, amazon-web-services, amazon-rds

我有一个 RDS MySQL 持久实例，我正在尝试运行每 8 小时创建一次然后销毁的 Spot 实例。

我遇到的问题是我不明白如何将那些具有动态 IP 的 Spot 实例添加到我的 RDS 实例的安全组中，以便让它们执行查询等。

我是否应该在创建 Spot 实例后立即获取 IP，并在每次创建新的 Spot 实例时将其添加到 RDS 实例的安全组中？每次终止现场实例时也要销毁它吗？

任何关于采取何种方法的提示将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T06:03:49.350

Assuming that both your spot instances and RDS are in the same region: when setting up an RDS security group, you can also allow machines in EC2 security groups to connect to your RDS machine. Simply add all your spot instances to a EC2 security group and grant access to RDS for this security group.

If your RDS and spot instances are in different regions, you could use the AWS API or an AWS API client like [boto for Python](https://github.com/boto/boto) to add the IPs automatically.

# build - 如何使用 Sencha SDK for ExtJS？

> ID：12252863
> 
> 赞同：7
> 
> 时间：2012-09-03T19:00:48.243
> 
> 标签：build, extjs4, extjs, extjs4.1

我正在使用 ExtJS 4.1，我正在 GlassFish V3.1 上部署我的简单 HelloExt 程序。

我正在尝试从 Sencha SDK 创建一个构建。

我使用了以下两个命令...

```
C:\>sencha create jsb -a http://localhost:8080/HelloExt/index.jsp -p appname.jsb
3 -v

C:\>sencha build -p appname.jsb3 -v -d . 
```

根据文档，它将创建 app-all.js 文件。但是它在哪里创建文件？

我如何知道 IF 构建是否成功创建？

生成的 JS 文件在哪里？

我进行了搜索，但找不到 app-all.js 之类的东西。

了解更多信息：

我正在使用 JDK 1.6.0_12 和 GlassFish V3.1 应用服务器。

**这是问题的编辑内容....**

当我尝试使用 sencha SDK 时，它会在类路径中生成一个 .dpf 文件。.dpf 文件的内容如下...

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE glassfish-web-app PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Servlet 3.0//EN" "http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd">
<glassfish-web-app error-url="">
  <context-root>/HelloExt</context-root>
  <class-loader delegate="true"/>
  <jsp-config>
    <property name="keepgenerated" value="true">
      <description>Keep a copy of the generated servlet class' java code.</description>
    </property>
  </jsp-config>
</glassfish-web-app> 
```

谁能告诉我为什么在这里生成 .DPF 文件？为什么它不生成 app-all.js 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T16:03:32.647

尝试从应用程序根目录中运行命令，然后使用相对路径：

**0) 打开cmd窗口**

**1）在cmd窗口中运行：“cd C:\[webserver_webapp_root]\[app_name]”**

换句话说，将 cmd 目录更改为应用程序根目录。用正确的路径填写上面括号中的文本。

**2）在cmd窗口中运行：“sencha create jsb -a index.html -p app.jsb3 -v”**

app.jsb3 应该在您的应用程序的根目录 (C:\[webserver_webapp_root]\[app_name]) 中创建。打开它并确保它包含您所有的应用程序类，它应该看起来像这样：

```
{
    "projectName": "Project Name",
    "licenseText": "Copyright(c) 2012 Company Name",
    "builds": [
        {
            "name": "All Classes",
            "target": "all-classes.js",
            "options": {
                "debug": true
            },
            "files": [
                {
                    "clsName": "YourApp.view.Viewport",
                    "name": "Viewport.js",
                    "path": "app/view/"
                },
                // plus ALOT more classes...
            ]
        },
        {
            "name": "Application - Production",
            "target": "app-all.js",
            "compress": true,
            "files": [
                {
                    "path": "",
                    "name": "all-classes.js"
                },
                {
                    "path": "",
                    "name": "app.js"
                }
            ]
        }
    ],
    "resources": []
} 
```

如果一切正常，那么您可以进行下一步，如果不是，那么您的应用程序目录结构有问题，您需要按照[Sencha 推荐的 ExtJS 应用程序架构](http://docs.sencha.com/ext-js/4-0/#!/guide/application_architecture)来修复它。

您还可以使用任何错误消息来帮助识别问题。

**3) 更新 app.jsb3 顶部的占位符（“项目名称”等）**

**4）在cmd窗口中运行：“sencha build -p app.jsb3 -d . -v”**

该`app-all.js`文件还应该在应用程序的根目录中创建。如果 cmd 窗口在显示“Done Building！”之前没有给出任何错误。那么你就完成了。您现在可以将`index.html`脚本链接更改为指向`app-all.js`而不是`app.js`.

如果有错误，那么您必须修复这些错误并再次运行它。

**您可以尝试的其他事情：**

作为对您最后评论的回应，您的 -p 开关参数应该是一个`jsb3`文件 not `jsb`。

在尝试使用 SDK 工具之前，请确保 Web 服务器正在运行并且您的应用程序运行时没有任何错误。

然后试试这些：

```
C:\Projects\HelloExt\build\web>sencha create jsb -a index.jsp -p HelloExt.jsb3 -v

C:\Projects\HelloExt>sencha create jsb -a index.jsp -p HelloExt.jsb3 -v

C:\>sencha create jsb -a [actual IP address]:8080/HelloExt/index.jsp -p HelloExt.jsb3 -v 
```

在括号（不是`localhost`）的位置填写您的实际 IP 地址。

这应该会生成上面 #2 中显示的 jsb3 文件，然后您可以继续执行上面的步骤 #3。

# c++ - winapi - 带有 LWA_COLORKEY 的 SetLayeredWindowAttributes 仅将像素设置为完全不透明或完全透明？

> ID：12252864
> 
> 赞同：1
> 
> 时间：2012-09-03T19:00:51.500
> 
> 标签：c++, windows, winapi

我的框架的边框是白色的（0xffffffffe）。我的框架内部是黑色的（0xff000000）。我想让边框半透明（alpha 值为 100），内部不透明。显然，我曾经`SetLayeredWindowAttributes`这样做过，但它不起作用。

这种变化：`SetLayeredWindowAttributes(RGB(0xxff, 0xff, 0xfe), 100, LWA_COLORKEY)`将边框设置为 100 的 alpha，但内部完全透明。

这种变化：`SetLayeredWindowAttributes(RGB(0xxff, 0xff, 0xfe), 100, LWA_COLORKEY | LWA_ALPHA)`将内部设置为 100 的 alpha，但将边框设置为完全透明。

如何使内部不透明而边框透明？在这种情况下，我无法使用多个顶级窗口来实现效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:10:52.100

而不是`SetLayeredWindowAttributes`，使用[`UpdateLayeredWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633556%28v=vs.85%29.aspx). 您可以将包括任何透明度在内的整个帧预渲染到 32 位位图上，将其选择到 DC 中并将其传递给`UpdateLayeredWindow`.

# google-tv - 访问 Revue 的 IR-Blaster？

> ID：12252865
> 
> 赞同：2
> 
> 时间：2012-09-03T19:00:53.593
> 
> 标签：google-tv, logitech

有人知道是否可以以编程方式访问 Revue 的 IR-Blaster？我需要更改电视的输入源，但我找不到任何相关信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T00:35:01.773

Google TV 上没有 API 可以做到这一点。使用 Anymote 更改电视输入源。

# c# - EF5 Code First：强制多对多递归关系

> ID：12252868
> 
> 赞同：1
> 
> 时间：2012-09-03T19:01:43.627
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有一个简单的 Entry 类模型

```
public class Entry
{
    public int Id { get; set; }
    public DateTime Modified { get; set; }
    public DateTime Created { get; set; }

    // Related entries
    public virtual ICollection<Entry> RelatedEntries { get; set; }

    // The nodes this entry contains
    public virtual ICollection<Node> Nodes { get; set; }

    // The category this entry is located in
    public virtual Category Category { get; set; }
} 
```

我希望我的条目能够有一个相关条目的列表，问题是它只是将一个 FK Entry_id 添加到 Entries 表中，我想创建一个新表，它包含多对多关系，例如

```
Entry_Id | Related_Entry_Id
      01 | 02
      01 | 03
      01 | 06
      02 | 04 
```

因此，条目 01 与 02、03 和 06 相关，条目 02 与 04 相关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:07:54.160

您可以使用 Fluent API 指定关系是多对多类型（而不是 EF 默认假定的一对多关系）：

```
public class MyContext : DbContext
{
    //...
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Entry>()
            .HasMany(e => e.RelatedEntries)
            .WithMany()
            .Map(m =>
            {
                m.MapLeftKey("Entry_Id");
                m.MapRightKey("Related_Entry_Id");
                m.ToTable("EntryRelations");
            });
    }
} 
```

# c# - 用另一个数据表中的值替换数据表中的所有匹配项

> ID：12252870
> 
> 赞同：0
> 
> 时间：2012-09-03T19:02:13.383
> 
> 标签：c#, datatable

有没有办法用另一个数据表中的另一个值替换数据表中所有出现的值。例如，我有两个数据表，一个有 Itemid，另一个有 itemid 和项目名称。我需要先替换项目 ID带有第二个数据表中项目名称的数据表。有没有办法一次性替换所有出现的事件，或者我应该使用通常的循环方法并使用 Datatable.Select 方法。请帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:36:46.337

那这个呢？（我意识到这是一个循环 - 但非常紧凑，任何内置方法都会循环，只是在幕后）

```
 //Build first Test DT
        DataTable dt1 = new DataTable();
        dt1.Columns.Add("itemID", typeof(string));

        //Build Second Test DT
        DataTable dt2 = new DataTable();
        dt2.Columns.Add("itemID", typeof(string));
        dt2.Columns.Add("itemName", typeof(string));

        //aad 3 DataRows to first DT - ID only
        DataRow dt1_1 = dt1.NewRow();
        dt1_1["itemID"] = "1";

        DataRow dt1_2 = dt1.NewRow();
        dt1_2["itemID"] = "2";

        DataRow dt1_3 = dt1.NewRow();
        dt1_3["itemID"] = "3";

        dt1.Rows.Add(dt1_1);
        dt1.Rows.Add(dt1_2);
        dt1.Rows.Add(dt1_3);

        //aad 3 DataRows to first DT - ID & Name
        DataRow dt2_1 = dt2.NewRow();
        dt2_1["itemID"] = "1";
        dt2_1["itemName"] = "ItemOne";

        DataRow dt2_2 = dt2.NewRow();
        dt2_2["itemID"] = "2";
        dt2_2["itemName"] = "ItemTwo";

        DataRow dt2_3 = dt2.NewRow();
        dt2_3["itemID"] = "3";
        dt2_3["itemName"] = "ItemThree";

        dt2.Rows.Add(dt2_1);
        dt2.Rows.Add(dt2_2);
        dt2.Rows.Add(dt2_3);

        ////////////////////////////////////////////////////////
        //replacing code - quite comact - assumed itemId is PK//
        ////////////////////////////////////////////////////////
        foreach (DataRow dr in dt1.Rows)
        {
                string strSelect = "[itemID] = '"+ dr["itemID"] +"'";
                DataRow[] myRow = dt2.Select(strSelect);
                if (myRow.Length == 1)
                {
                    dr["itemID"] = myRow[0]["itemName"];
                }
        }
        /////////////////////////////////////////////////////////////////
        //dt1 now has itemOne, itemTwo and itemThree instead of 1, 2, 3//
        ///////////////////////////////////////////////////////////////// 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:13:29.913

使用 MySQL 我会尝试：

```
UPDATE table1 t1, table2 t2
SET t1.itemid = t2.itemname
WHERE t1.itemid = t2.itemid 
```

使用 MS-SQL 我会尝试

```
UPDATE t1
SET t1.itemid = t2.itemname
FROM table1 t1 INNER JOIN table2 t2
ON t1.itemid = t2.itemid 
```

# scala - 将调用转发到 Scala 中的底层对象

> ID：12252873
> 
> 赞同：3
> 
> 时间：2012-09-03T19:02:38.590
> 
> 标签：scala, scala-2.8, scala-collections

我有以下类定义：

```
class Foo[T](iteratorThunk: () => Iterator[T]) {
  def values = iteratorThunk()
} 
```

而且我想`Foo`拥有所有`Iterator`公开的方法，同时仍然返回 type 的对象`Foo`。例如，我希望能够做到：

```
val a = new Foo({ () => List(1, 2, 3).toIterator })
val b = new Foo({ () => List(4, 5, 6).toIterator })
val c = a ++ b 
```

并`c`等于：

```
new Foo({ () => a.values ++ b.values }) 
```

我查看了转发器 ( [`IterableForwarder`](http://www.scala-lang.org/api/current/scala/collection/generic/IterableForwarder.html), [`TraversableForwarder`](http://www.scala-lang.org/api/current/scala/collection/generic/TraversableForwarder.html), ...)，但似乎没有一个适合将方法转发到`Iterator`，并且我仍然希望将其保留`Foo`为静态和动态结果类型。

在不定义每种转发方法的情况下，实现此行为的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T01:01:05.270

> 我需要 Foo 类，而不仅仅是作为一个迭代器，因为我需要能够通过它的值进行多次传递。

然后你想要一个`Traverable`或一个`Iterable`。要让它们按您的意愿工作，您需要扩展它们和`TraversableLike`or `IterableLike`，您将通过它指定返回类型。您还需要同时提供 a`Builder`和 a `CanBuildFrom`。

这是一个简单的实现：

```
import scala.collection.IterableLike
import scala.collection.mutable.LazyBuilder
class Foo[T](iteratorThunk: () => Iterator[T]) extends Iterable[T] with IterableLike[T, Foo[T]] {
  def iterator = iteratorThunk()
  override protected def newBuilder = new Foo.FooBuilder[T]
}

object Foo {
  class FooBuilder[T] extends LazyBuilder[T, Foo[T]] {
    def result(): Foo[T] = {
      val coll = parts.toList.flatten
      new Foo(() => coll.iterator)
    }
  }
} 
```

# android - 在接收相同的广播时完成两个活动

> ID：12252874
> 
> 赞同：2
> 
> 时间：2012-09-03T19:02:46.260
> 
> 标签：android, broadcastreceiver, android-activity

我有一个`BroadcastReceiver`处理系统广播，如 AC 连接和断开连接。`BroadcastReceiver`接收并启动一个活动“MainActivity”，该`POWER_CONNECTED`活动解锁`KeyGuard`并获取`WakeLock`. 在`onCreate`和`onResume`我动态注册一个`BroadcastReceiver`听`POWER_DISCONNECTED`。

“MainActivity”启动了第二个“VideoPlayer Activity”，它也注册了一个`BroadcastReceiver`监听`POWER_DISCONNECTED`。

当我发送`ACTION_POWER_DISCONNECT`over adb 时，我通过 LogCat 看到“MainActivity”首先停止。为什么？

我该如何处理“VideoPlayerActivity”首先完成？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:24:26.143

看这里（[http://developer.android.com/reference/android/content/BroadcastReceiver.html](http://developer.android.com/reference/android/content/BroadcastReceiver.html)）：

> 普通广播（使用 Context.sendBroadcast 发送）是完全异步的。**广播的所有接收器都以未定义的顺序运行**，通常同时运行。这更有效，但意味着接收者不能使用结果或中止此处包含的 API。

您不能保证 VideoPlayerActivity 会收到。

我建议创建一个单独的 BroadcastReceiver （它不是活动的一部分）。在这个广播接收器中做这样的事情：

```
videoPlayerActivity.finish();
mainActivity.finish(); 
```

当然，您需要在活动的 onCreate 或 onResume 中初始化这两个变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T20:14:50.703

实际上，您在主要活动中注册了广播接收器，因此它在广播接收器中传递主要活动的上下文，因此我只能完成该活动。

因此，让我们把你需要做的事情搞砸，只需在**Power Disconnected**动作接收器的**onReceive()**中编写这些代码行：

 **```
public void onReceive(Context context, Intent intent) {
 Intent startMain = new Intent(Intent.ACTION_MAIN);
            startMain.addCategory(Intent.CATEGORY_HOME);
            startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(startMain);
} 
```

享受**

# c - 在 Windows 中运行程序时，该程序的允许内存是什么？

> ID：12252880
> 
> 赞同：2
> 
> 时间：2012-09-03T19:03:18.740
> 
> 标签：c, windows

如果我用 C 编写一个程序并在 Windows 中运行它，Win API 中是否有一些东西可以指示程序是否可以访问某个内存块？如果我希望能够让程序访问我想要的任何内存块，有什么我必须禁用的吗？我意识到这是有风险的，可能会损坏操作系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:47:18.443

是的，这可以通过分配虚拟内存页面的低级函数 VirtualAlloc() 实现。flProtect 参数指定进程如何访问内存，指定 PAGE_NOACCESS 是可能的，尽管它并不经常使用。

如果您实际上是在谈论*RAM*，那么不，用户模式程序永远无法直接访问受保护模式操作系统（如 Windows）上的物理内存。它只能寻址虚拟内存，到 RAM 的映射由操作系统内核执行。只有在 ring 0 中运行的代码才有这个能力。拒绝访问某些物理地址只对内存映射 I/O 设备有意义。它已经有一个保留地址空间的驱动程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:05:12.577

在现代 Windows（带有 NT 内核的 Windows）中，操作系统控制访问内存的方式。所以，答案是：**不**。您对此无能为力。您将无法让您的进程访问您想要的**任何**内存块。

你本可以在 Win 3.0、Win 3.11、Win 95、Win 98、Win ME 中做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:04:34.463

您不能/不会/不得访问内核内存。现代操作系统（内核模式除外）不允许从这些内存区域进行分配。

# android - android是否支持像iOS一样的消息通知图标气泡（徽章）

> ID：12252885
> 
> 赞同：0
> 
> 时间：2012-09-03T19:03:30.627
> 
> 标签：android

Android 是否具有类似于 iOS 的功能，在有新通知时会显示红色徽章气泡图标。[我在Google Cloud Messaging for Android](http://developer.android.com/guide/google/gcm/index.html)上查看了 Google 消息传递文档，并没有提到任何关于此的内容，但是，我记得我在一些 Android 应用程序中看到了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:09:42.013

> Android 是否具有类似于 iOS 的功能，在有新通知时会显示红色徽章气泡图标。

A`Notification`可以有一个`number`，但在`Notification`UI 上显示的时间和位置取决于 Android 版本。

如果您的意思是主屏幕启动器中的图标应该有一个徽章，不，不支持。

# c# - 显示驱动程序在第二次运行应用程序时崩溃

> ID：12252886
> 
> 赞同：0
> 
> 时间：2012-09-03T19:03:39.567
> 
> 标签：c#, windows-8, microsoft-metro, windows-runtime, webcam

基本上，我目前正在开发一个超级简单的地铁应用程序。目前它所做的只是显示一个网络摄像头视频流。当前所有相关代码如下（capture 是 XAML 中定义的 CaptureElement，mediaCapture 是 MediaCapture 类型）。当我第一次在 VS 2012 的调试本地系统模式下运行程序时，代码运行良好。然后我通过从顶部拖动它来关闭应用程序。但是，下次我运行该程序时，我的显示驱动程序崩溃了 - 从 Windows 事件查看器：“显示驱动程序 igfx 停止响应并已成功恢复。”。我是使用 C# 进行任何开发的新手，所以我不确定从哪里开始寻找导致这种情况的原因。任何帮助将不胜感激，谢谢。

```
 private async void init()
    {
        mediaCapture = new MediaCapture();
        MediaCaptureInitializationSettings mc = new MediaCaptureInitializationSettings();
        mc.StreamingCaptureMode = StreamingCaptureMode.Video;
        await mediaCapture.InitializeAsync(mc);
        capture.Source = mediaCapture;
        await mediaCapture.StartPreviewAsync();
    } 
```

注意：init() 是从 MainPage 的构造函数中调用的，它是当前唯一的页面。

注意 2：当我在模拟器中运行它时，会弹出一个错误（这个错误来自我的常规桌面环境（抱歉质量差）。我使用的是我最近升级到 Windows 8 RTM 的 Windows 7 机器：![显示驱动程序崩溃](../Images/80d8c07f3267f99ee869a005441ad4c2.png)

注意 3：Windows 内置的相机应用程序可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:35:47.190

根据我猜的消息，问题出在您的显卡驱动程序中，如果您使用的是默认/包含的驱动程序，请尝试使用更具体的驱动程序（例如您可以在 Nvidia 或 ATI 网站上获得的驱动程序）由您的卡制造商提供的驱动程序，然后尝试使用默认/通用驱动程序。一个不错的选择是在模拟器而不是真机中调试您的应用程序，或者（如果可以的话）使用虚拟机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T23:31:16.827

所以，事实证明这是我自己犯的一个愚蠢的错误。希望如果其他人也在做同样的事情，尽管他们能找到这个。显然发生的事情是，当我关闭应用程序时，VS 2012 继续调试。当我重新打开应用程序（从开始菜单）时，VS 仍在调试最后一次运行。这不知何故导致显示驱动程序崩溃。如果有人想更深入地解释为什么会发生这种情况，我会很高兴。在确定这是导致所有显示驱动程序崩溃后，我会将其标记为正确答案。

# css - 用背景图像替换 li 项目符号，IE 8 和 7

> ID：12252887
> 
> 赞同：0
> 
> 时间：2012-09-03T19:03:54.573
> 
> 标签：css

我正在添加一个类似于 li 的子弹的图像：

```
.top_right li {
float: left;
width: 7em;
line-height: 100%;
background: url(images/thumbs.png) no-repeat top 4px left;
border-bottom: solid 1px #222;
margin-right: 1em;
padding: 5px 0 5px 1.3em
} 
```

任何想法为什么 thumbs.png 不在 IE 8 和 7 中显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:14:30.960

这是一个工作[演示](http://jsfiddle.net/L5aQy/1/)。我必须删除属性`top 4px left`中`bakcground`的图像才能显示。

您必须指定`top left`或`Xpx Ypx`，不能将它们混淆:)。

# playframework - 编写 Play! 的资源 Scala 中的模型

> ID：12252888
> 
> 赞同：1
> 
> 时间：2012-09-03T19:04:02.717
> 
> 标签：playframework, playframework-2.0

*Play!*中的模型几乎没有可用的文档！框架，特别是对于 Scala。Java 可用的东西很少或已经过时。

是否有任何资源解释如何在 Scala for *Play 中编写模型！*?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T11:10:35.773

我相信 Anorm[文档](http://www.playframework.org/documentation/2.0.3/ScalaAnorm)非常清楚。用 Play Framework 的 Samples 文件夹中的代码和 Stack Overflow 中的所有 Anrom 相关问题对其进行补充。

# android - 在构建时重命名“R”类

> ID：12252890
> 
> 赞同：0
> 
> 时间：2012-09-03T19:04:14.040
> 
> 标签：android, build

一个 Android 应用项目使用两个库项目作为依赖项，每个库项目都有一些布局资源并自动生成“R”类。但是，IDE 与两个继承的“R”类混淆了。是否可以通过覆盖某些 ANT 属性来更改输出“R”类的名称？

我已经更改了依赖顺序，所以 IDE 先查找主源，然后查找库项目，但没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:08:30.850

> 是否可以通过覆盖某些 ANT 属性来更改输出“R”类的名称？

不是我知道的。只需完全限定一个（或两个）`R`引用（例如`com.wingman.libraryone.R`，，因此您不依赖于`import`陈述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:17:25.113

你不能。该类`R`由 生成`aapt`，并且没有使用其他名称的选项。如果您在同一个文件中使用来自不同项目的资源，则必须使用完全限定的资源名称，如 CommonsWare 所说。

# php - 如何在 CodeIgniter 中 ajaxify 购物车

> ID：12252900
> 
> 赞同：0
> 
> 时间：2012-09-03T19:05:28.783
> 
> 标签：php, jquery, ajax, codeigniter, shopping

我在[Ajaxifying内置](http://en.wikipedia.org/wiki/Ajax_%28programming%29)[CodeIgniter](http://en.wikipedia.org/wiki/Codeigniter#CodeIgniter)的购物车时遇到问题。当用户单击项目下拉菜单上的添加按钮时，该项目将通过 Ajax 回调函数添加到名为#cart 的 div 中。但是，我的问题是购物车 div 中通过 Ajax 生成的内容不是永久性的（因为这是在客户端完成的）。有没有办法在仍然使用 Ajax 的同时使购物车[HTML输出永久化？](http://en.wikipedia.org/wiki/HTML)

虽然我的 Ajax 调用正在从我的控制器输出内容，但我检查了视图源，实际上上面没有 html 元素。这是我的 ajax 调用：

```
$(document).ready(function() {
    $('.add').click(function(){
        var button =$(this).val();
        var button = button.split(',');
        var url=<?php echo '"' . base_url() . 'index.php/order_form/add/"' ?>+button[0]+'/'+button[1];
        var quantity=$('#quantity-'+button[0]).val();

        $.ajax({
            url: url,
            data:'quantity='+quantity,
            dataType: 'html',
            success: function(output_string){
                $('#cart').empty().append(output_string);
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T22:47:52.633

你有两种可能：

*   将来自 Ajax 的响应存储在 CodeIgniter 会话中。这意味着您将能够在刷新时验证会话并重新填充购物车。
*   将来自 Ajax 的响应存储在一个临时数据库表中……然后再次刷新，从数据库中重新填充购物车。

一般事实：您将永远无法通过查看源代码看到 Ajax 的响应。您必须使用浏览器检查器查看响应（例如， [Google Chrome](http://en.wikipedia.org/wiki/Google_Chrome)中网络选项卡上的[XHR响应）。](http://en.wikipedia.org/wiki/XMLHttpRequest)在那里，您将看到通过 Ajax 为您输出的 URL。

# c# - 构建后更改输出路径

> ID：12252906
> 
> 赞同：0
> 
> 时间：2012-09-03T19:06:10.537
> 
> 标签：c#, post-build-event

`OutputPath`我有一个场景，我必须在构建后更改*.csproj文件。*
我想知道在构建后事件中是否有任何方法可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:59:54.467

您可以有一个后期构建事件来修改 .csproj 本身以使用 python 脚本或其他方式更改（或所有）配置中的*OutputPath*值，但是修改 .csproj 会使当前构建无效，这意味着如果您按下再次 F5 或 F7，它将再次构建项目，因为 VS 认为项目本身已经改变，一次又一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:50:27.893

如果我理解正确，您只想将构建产品放在另一个目录中，

所以有两个快速选择： 1\. 在构建后事件中，只需复制您的文件：

```
 xcopy $(TargetDir) <destination> 
```

1.  一起更改项目构建路径：在项目属性->构建->“输出路径”中

希望这可以帮助

# c++ - c ++链接器错误：未定义的引用仅在优化构建

> ID：12252907
> 
> 赞同：4
> 
> 时间：2012-09-03T19:06:16.943
> 
> 标签：c++, linker, build-process, linker-errors, undefined-reference

*仅*在链接优化的对象文件时出现未定义的引用链接器错误，*而不是*在链接未优化的对象文件时。我不明白问题是什么或可能是什么。

这是我未优化的构建：

```
构建文件：../COMPASS.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"COMPASS.d" -MT"COMPASS.d" -o"COMPASS.o" “../COMPASS.cpp”
完成的建筑：../COMPASS.cpp

构建文件：../PSA.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"PSA.d" -MT"PSA.d" -o"PSA.o" “../PSA.cpp”
完成的建筑：../PSA.cpp

构建文件：../SAR.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"SAR.d" -MT"SAR.d" -o"SAR.o" “../SAR.cpp”
完成的建筑：../SAR.cpp

构建文件：../constraints.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"constraints.d" -MT"constraints.d" -o"constraints.o" “../约束.cpp”
完成的建筑：../constraints.cpp

构建文件：../genetic.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"genetic.d" -MT"genetic.d" -o"genetic.o" “../遗传.cpp”
完成的建筑：../genetic.cpp

构建文件：../globals.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"globals.d" -MT"globals.d" -o"globals.o" “../globals.cpp”
完成的建筑：../globals.cpp

构建文件：../logging.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"logging.d" -MT"logging.d" -o"logging.o" “../日志记录.cpp”
完成的建筑：../logging.cpp

构建文件：../main.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"main.d" -MT"main.d" -o"main.o" “../main.cpp”
完成的建筑：../main.cpp

构建文件：../sampling.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"sampling.d" -MT"sampling.d" -o"sampling.o" “../采样.cpp”
完成的建筑：../sampling.cpp

构建文件：../simulation1.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"simulation1.d" -MT"simulation1.d" -o"simulation1.o" “../simulation1.cpp”
../globals.h：在全球范围内：
../globals.h:43: 警告：使用内联函数'double showDecimals(const double&, const int&)' 但从未定义
完成的建筑：../simulation1.cpp

构建文件：../test_function.cpp
调用：GCC C++ 编译器
g++ -O0 -g3 -pg -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"test_function.d" -MT"test_function.d" -o"test_function.o" “../test_function.cpp”
完成构建：../test_function.cpp

构建目标：pc2
调用：GCC C++ 链接器
g++ -pg -fopenmp -pg -o"pc2" ./COMPASS.o ./PSA.o ./SAR.o ./constraints.o ./genetic.o ./globals.o ./logging.o ./main .o ./sampling.o ./simulation1.o ./test_function.o   
完成的建筑目标：pc2

```

这是我优化的构建：

```
构建文件：../COMPASS.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"COMPASS.d" -MT"COMPASS.d" -o"COMPASS.o" "../指南针.cpp"
完成的建筑：../COMPASS.cpp

构建文件：../PSA.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"PSA.d" -MT"PSA.d" -o"PSA.o" "../ PSA.cpp"
完成的建筑：../PSA.cpp

构建文件：../SAR.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"SAR.d" -MT"SAR.d" -o"SAR.o" "../ SAR.cpp"
完成的建筑：../SAR.cpp

构建文件：../constraints.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"constraints.d" -MT"constraints.d" -o"constraints.o" "../约束.cpp"
完成的建筑：../constraints.cpp

构建文件：../genetic.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"genetic.d" -MT"genetic.d" -o"genetic.o" "../遗传.cpp"
完成的建筑：../genetic.cpp

构建文件：../globals.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"globals.d" -MT"globals.d" -o"globals.o" "../全局变量.cpp"
完成的建筑：../globals.cpp

构建文件：../logging.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"logging.d" -MT"logging.d" -o"logging.o" "../日志记录.cpp"
完成的建筑：../logging.cpp

构建文件：../main.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"main.d" -MT"main.d" -o"main.o" "../主.cpp"
完成的建筑：../main.cpp

构建文件：../sampling.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"sampling.d" -MT"sampling.d" -o"sampling.o" "../采样.cpp"
完成的建筑：../sampling.cpp

构建文件：../simulation1.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"simulation1.d" -MT"simulation1.d" -o"simulation1.o" "../模拟1.cpp"
../globals.h：在全球范围内：
../globals.h:43: 警告：使用内联函数'double showDecimals(const double&, const int&)' 但从未定义
完成的建筑：../simulation1.cpp

构建文件：../test_function.cpp
调用：GCC C++ 编译器
g++ -O3 -Wall -c -fmessage-length=0 -Wno-sign-compare -fopenmp -MMD -MP -MF"test_function.d" -MT"test_function.d" -o"test_function.o" "../ test_function.cpp"
完成构建：../test_function.cpp

构建目标：pc2
调用：GCC C++ 链接器
g++ -fopenmp -o"pc2" ./COMPASS.o ./PSA.o ./SAR.o ./constraints.o ./genetic.o ./globals.o ./logging.o ./main.o ./采样.o ./simulation1.o ./test_function.o   
./logging.o：在函数“LOG_COMPASS_display_points_MATLAB(int const&, VisitedSet&)”中：
logging.cpp:(.text+0x686): 未定义对“VisitedSet::getSize()”的引用
collect2: ld 返回 1 个退出状态
制作：*** [pc2] 错误 1
make: 离开目录`/home/djunderw/ncsu/workspace/pc2/release'

```

有任何想法吗？

**[修复了 showDecimals() 函数的问题]**

文件 COMPASS.h 包含此类模板：

```
template<class T> class VisitedSet {
public:
    VisitedSet(const T& soln); 
    int getSize();
    void addSolution(const T& soln);
    void evaluate();
    void sample(const int& numNewSolutions, Constraints& space);
    void CSBiased_generateDistribution();
    void constructMPA(Constraints& space);
    vector<T> vec;
    double bestValue;
    int bestIndex;

    /* used to implement biased coordinate sampling */
    double CSBiased_coefficient;
    vector< vector<double> > lastSampledPoints;
    vector<int> lastSampledPointsIndex;
    vector< vector<double> > newSampledPoints;
    vector<int> newSampledPointsIndex;
    vector<double> CSBiased_distribution;

private:
    int iteration;
    int dimension; 
    int SAR(); // simulation allocation rule
}; 
```

COMPASS.cpp 包含以下代码：

```
template<class T>
int VisitedSet<T>::getSize() {
    return vec.size();
} 
```

logging.cpp 文件包含以下代码：

```
#include "COMPASS.h"
void LOG_COMPASS_display_points_MATLAB(const int& iteration, VisitedSet<Policy>& visited) {
    cout << "points{"<<iteration+1<<"} = [\n"
         << visited.vec[visited.bestIndex].x[0] << "\t" <<     visited.vec[visited.bestIndex].x[1] << "\t" << visited.vec[visited.bestIndex].meanQALY() << ";" << endl;
for(int i=0; i<visited.getSize(); i++) {
    if(i != visited.bestIndex)
        cout << visited.vec[i].x[0] << "\t" << visited.vec[i].x[1] << "\t" << visited.vec[i].meanQALY() << ";" << endl;
}
cout << "];\n";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T19:27:53.500

`int VisitedSet<T>::getSize()`是一个模板函数，所以它的定义应该在像 COMPASS.h 这样的头文件中，而不是在 COMPASS.cpp 中。

原因如下：http: [//www.parashift.com/c++-faq/templates-defn-vs-decl.html](http://www.parashift.com/c++-faq/templates-defn-vs-decl.html)

# redirect - 使用 Hook BeforePageRedirect 实现 301 重定向

> ID：12252908
> 
> 赞同：-1
> 
> 时间：2012-09-03T19:06:26.887
> 
> 标签：redirect, mediawiki

出于 SEO 的目的，我想在我的 wiki 中引入 301 重定向而不是正常的重定向。我发现一些页面描述了如何通过手动编辑 mediawiki 文件来做到这一点 - 但是为了维护可更新的环境，我更喜欢其他方法。

我确实找到了一个我相信可以使这成为可能的钩子，但是我不确定如何使用[Manual:Hooks/BeforePageRedirect](http://www.mediawiki.org/wiki/Manual%3aHooks/BeforePageRedirect)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T18:50:18.637

试试这个扩展，将 302 改为 301：[http](http://svn.wikimedia.org/svnroot/mediawiki/trunk/extensions/HTTPRedirect/HTTPRedirect.php) ://svn.wikimedia.org/svnroot/mediawiki/trunk/extensions/HTTPRedirect/HTTPRedirect.php ？

# mysql - mysql 最大查询然后加入？

> ID：12252910
> 
> 赞同：0
> 
> 时间：2012-09-03T19:06:36.553
> 
> 标签：mysql, join, max

我已经按照 tizag 的 MAX() mysql 函数的教程进行了操作，并编写了下面的查询，这正是我所需要的。唯一的麻烦是我需要将它加入另外两个表，这样我就可以处理我需要的所有行。

```
 $query = "SELECT idproducts, MAX(date) FROM results GROUP BY idproducts ORDER BY MAX(date) DESC"; 
```

我在下面有这个查询，它有我需要和工作的 JOIN：

```
 $query =     ("SELECT * 
                    FROM operators
                    JOIN products
                    ON operators.idoperators = products.idoperator JOIN results
                    ON products.idProducts = results.idproducts 
                    ORDER BY drawndate  DESC
                    LIMIT 20"); 
```

有人可以告诉我如何将顶部查询与我的第二个查询中的 JOIN 元素合并吗？我是 php 和 mysql 的新手，这是我对计算机语言的第一次冒险，我已经阅读并努力尝试让这两个查询正常工作，但我遇到了障碍。我不知道如何将 JOIN 元素添加到第一个查询:(

有好心人能同情一个新手并帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:19:03.077

试试这个查询。

```
SELECT 
    * 
FROM 
    operators
    JOIN products
        ON operators.idoperators = products.idoperator 
    JOIN 
    (
        SELECT 
            idproducts, 
            MAX(date) 
        FROM results 
        GROUP BY idproducts 
    ) AS t
    ON products.idproducts = t.idproducts
ORDER BY drawndate  DESC
LIMIT 20 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:20:01.220

JOIN 的功能在某种程度上独立于聚合函数，它们只是更改聚合函数操作的中间结果集。我喜欢指出 MySQL 文档的编写方式，它提示在[SELECT 语法](http://dev.mysql.com/doc/refman/5.0/en/select.html)中使用术语“table_reference” ，并扩展了它在[JOIN 语法](http://dev.mysql.com/doc/refman/5.0/en/join.html)中的含义。基本上，任何具有指定表的简单查询都可以简单地将该表扩展为完整的 JOIN 子句，并且查询将以相同的基本方式运行，只是使用修改后的中间结果集。

我说“中间结果集”是为了暗示帮助我理解 JOINS 和聚合的心态。了解 MySQL 构建最终结果的顺序对于了解如何可靠地获得所需结果至关重要。通常，它首先查看您在“FROM”之后指定的第一个表的第一行，并通过查看“WHERE”子句来决定它是否匹配。如果它不能立即丢弃，它会尝试将该行加入指定的第一个 JOIN，并重复“这将被 WHERE 丢弃吗？”。对所有 JOIN 重复此操作，根据您的 JOIN、WHERE 和数据的需要，将行添加到结果集中，或删除它们，或者只留下一个。当我说“中间结果集”时，这个过程构建了我所指的内容。在开始和完成完整查询之间的某个地方，MySQL 在它的内存中有一个潜在的海量表状数据结构，它使用我刚刚描述的过程构建。只有这样，它才会开始根据您的标准聚合 (GROUP) 结果。

因此，对于您的查询，这取决于您的具体目标（在 OP 中并不完全清楚）。如果您只是想要第二个查询中的 MAX(date)，您可以简单地将该表达式添加到 SELECT 子句，然后在末尾添加一个聚合规范：

```
SELECT *, MAX(date)
FROM operators
 ...
GROUP BY idproducts
ORDER BY ... 
```

或者，您可以将第二个查询的 JOIN 部分添加到第一个查询中。

# sorting - 如何覆盖 dgrid (gridFromHtml) 中任何列的排序方法？

> ID：12252911
> 
> 赞同：2
> 
> 时间：2012-09-03T19:06:36.947
> 
> 标签：sorting, dojo, dgrid

有没有办法覆盖排序方法并编写我们自己的方法来对 dgrid(gridFromHtml) 中的特定列进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:13:02.743

排序是在[List.js](https://github.com/SitePen/dgrid/blob/master/List.js#L675)`_setSort()`中完成的。可以覆盖，但下划线是一种约定，表示“私有方法”。

有一个更好（虽然更复杂）的方法：将您的 GridFromHTML 附加到从`dojo/store/Memory`. 覆盖内存存储的[`query()`方法](http://dojotoolkit.org/api/1.8/dojo/store/api/Store#query)，它接受[排序参数](http://dojotoolkit.org/api/1.8/dojo/store/api/Store.QueryOptions)作为第二个参数。dGrid 将在需要列出/排序数据时自动调用此方法。

无论如何，我通常发现支持数组的 Grid 过于受限，因此会自动使用支持存储的 OnDemandGrid。

# asp.net-mvc - 使用敲除时设置值时如何运行函数

> ID：12252912
> 
> 赞同：0
> 
> 时间：2012-09-03T19:06:39.703
> 
> 标签：asp.net-mvc, knockout.js, knockout-mvc

页面加载完成后，我需要从数据库中获取一个值，并运行一个函数，该函数将根据已检索的值填充多个下拉列表。就像表单控件的更改事件。

如何使用 Knockout.js 做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:16:19.447

[http://knockoutjs.com/examples/controlTypes.html](http://knockoutjs.com/examples/controlTypes.html) 只需将绑定替换为 ko.observableArray 即可，如下所示[http://knockoutjs.com/documentation/options-binding.html](http://knockoutjs.com/documentation/options-binding.html)。然后用加载的数据填充这个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:16:39.473

这是一个快速而肮脏的例子。这个想法是：

1.  设置一个可观察的数组来保存你的下拉数据。最初，数组将为空，您的下拉列表将没有内容。
2.  用于`getJSON`从您的服务器检索数据。
3.  填写回调的下拉列表`getJSON`。如果我对您的理解正确，您将不会检索下拉列表的实际内容，而是会帮助您决定将显示哪些选项的其他一些信息。我将这个想法融入到示例中。

顺便说一句，国家不一定是字符串数组。它可以是一组复杂的 JS 对象。但是，您必须扩展您的`data-bind="options: ..."`绑定`optionsText`并`optionsValue`指明您的对象的哪个属性是标签和值。[在这里查看更多详细信息。](http://knockoutjs.com/documentation/options-binding.html)

```
var CompanyViewModel = function()
{
    var self = this;

    self.Countries = ko.observableArray();

    $.getJSON('api/countries', function(data) {
        if(data == 1)
        {
            self.Countries(['France', 'Germany', 'Spain'])
        } else if(data == 2)
        {
            self.Countries(['Holland', 'Belgium', 'Luxemburg']);
        }
    });
 } 
```

# html - 为什么 nth-child 应用于所有按钮？

> ID：12252916
> 
> 赞同：3
> 
> 时间：2012-09-03T19:07:39.650
> 
> 标签：html, css, css-selectors

这是[我的 HTML 和 CSS 的示例](http://jsfiddle.net/fCFEn/)。对于我的一生，我无法弄清楚为什么第二条规则适用于所有按钮，而不仅仅是前三个。

HTML

```
<div id="test">
<ul>
<li><button>1</button></li>
<li><button>2</button></li>
<li><button>3</button></li>
<li><button>4</button></li>
<li><button>5</button></li>
<li><button>6</button></li>
    </ul>
</div> 
```

CSS

```
#test button
{
    background-color: blue;
}

#test button:nth-child(-n + 3) 
{
    background-color: red;
}

#test button:hover {
    background-color: green;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T19:10:26.017

您申请`nth-child`了错误的元素：每个`button`. 你的意思是定位`li`元素：

```
#test ul li:nth-child(-n + 3) button
{
    background-color: red;
} 
```

[http://jsfiddle.net/fCFEn/3/](http://jsfiddle.net/fCFEn/3/)

# javascript - AJAX 调用运行 C 代码的最佳实践？

> ID：12252921
> 
> 赞同：3
> 
> 时间：2012-09-03T19:07:59.890
> 
> 标签：javascript, c, ajax, node.js

我有一个底层 C 应用程序驱动一些非常密集的硬件。我目前正在为设备设计一个 Web 界面，它的大部分功能是向用户呈现状态信息。所以每隔一秒左右，用相关信息（温度，帧率，yada yada ...）更新网页上的字段。该设备运行linux并具有apache。当前设置：

1.  Web 状态页面中的 Javascript 进行 AJAX 调用（来自 setInterval）
2.  PHP 文件运行，写入[FIFO](http://en.wikipedia.org/wiki/Named_pipe)
3.  C 应用程序读取[FIFO](http://en.wikipedia.org/wiki/Named_pipe)，根据输入做一些工作（可能是空白，意味着只给我统计信息），写回[FIFO](http://en.wikipedia.org/wiki/Named_pipe)
4.  [PHP 文件从FIFO](http://en.wikipedia.org/wiki/Named_pipe)读取，解析，json_encode，echo
5.  Javascript 解析 JSON 并更新页面

这就是你进来的地方......目标是取出 PHP 中间人。对 C 程序的 AJAX 调用有哪些约定（假设它们存在）？最佳实践？

选项（据我所知）：

*   [插座](http://www.linuxhowtos.org/C_C++/socket.htm)。让 C 程序侦听特定端口[。](https://stackoverflow.com/questions/5487297/send-http-response-using-c-socket) [这里有类似的东西。](https://stackoverflow.com/questions/3831255/odd-jquery-problem-ajax-request-to-a-c-program-not-quite-working)
*   节点.js。这个我不熟悉，没用过。但是我短暂的曝光让我觉得这可能是一个很好的用途呢？据我了解......它是“服务器端的javascript”，但它实际上是C代码？这里只需要一些见解。
*   [电脑动画](http://en.wikipedia.org/wiki/Common_Gateway_Interface)。cgi 可以与不断运行的 C 程序一起工作吗？还是在调用时从头开始加载 C 程序？
*   [HTML5 网络套接字](http://www.html5rocks.com/en/tutorials/websockets/basics/)？

任何见解表示赞赏。当然，最好的答案很可能甚至没有在上面列出。这只是我在这方面的知识范围。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-01T16:30:06.880

我们使用 C 库 libwebsockets ( [http://libwebsockets.org/](http://libwebsockets.org/) ) 在 JavaScript 和 C++ 应用程序之间进行通信。在我们的例子中，我们通过 websockets 将 JSON 发送到 C++ 后端和从 C++ 后端发送。

在您的情况下，您可以获取当前通过 Ajax 发送的相同数据，并通过 websocket 将其发送到 C 程序。然后，C 程序可以生成与 PHP 程序生成的 JSON 相同的 JSON，并将其再次通过 websocket 发送回 JavaScript。

# html - 如何将文本标签居中放在div上？

> ID：12252924
> 
> 赞同：0
> 
> 时间：2012-09-03T19:08:34.417
> 
> 标签：html, css

我想在`.nav-tab`我添加的 div 类中居中文本链接，`padding:0 auto;`但它无济于事，所以我添加`text-align:center;`了它仍然不起作用。谢谢你的帮助。

[jsFiddle 演示](http://jsfiddle.net/centerwow/zCXMv/2/)

```
<nav id="main-nav-wrap">
<ul id="main-nav">
    <li class="">
        <div class="inner">
          <div class="nav-tab">

           <a href="/"> Home </a>
          </div>
             <div class="tooltip">
             </div>
        </div>
    </li>
            <li class="">
        <div class="inner">
            <div class="nav-tab">
            <a href="/"> abput</a>
            </div>
             <div class="tooltip">
             </div>
             </div>
    </li>
             <li class="">
        <div class="inner">
            <div class="nav-tab">
            <a href="/"> contact</a>
            </div>
             <div class="tooltip">
             </div> </div>
    </li>
        </ul> 
```

​</p>

```
 #main-nav-wrap {
    width:200px;
    height:60px;

    margin:50px 0 0 10px;
    padding:0;
    border:1px solid red;
}
#main-nav{
    width:196px;
    height:60px;
    top:50px;
    margin:0 ;
    padding:0;
    border:1px solid blue;
}
.inner{
    width:63px;
    height:58px;
      border:1px solid green;
    float:left;
}

.nav-tab{
     width:50px;
    height:58px;
    background-color: #BF87D1;
    margin:0 auto;
   }
.nav-tab a{
    vertical-align:-18px;

}
​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T19:10:54.597

只需添加：

```
.nav-tab {
    text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T19:11:47.573

首先，了解定义`padding: 0 auto;`-`auto`是无效的，这不是`padding`. 添加`text-align: center;`到`.nav-tab`似乎真的解决了这个问题：[little link](http://jsfiddle.net/glee/zCXMv/6/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T19:12:26.663

我刚试过这个：

```
.nav-tab {
    background-color: #BF87D1;
    height: 58px;
    margin: 0 auto;
    text-align: center; /* HERE */
    width: 50px;
} 
```

它奏效了。

# android - Android MediaRecorder 制作旋转视频

> ID：12252927
> 
> 赞同：3
> 
> 时间：2012-09-03T19:09:14.100
> 
> 标签：android, android-mediarecorder

我一直在尝试让 MediaRecorder 按照官方示例工作，虽然我能够制作一个文件，但它顺时针旋转了 90 度......

现在我正在纵向模式下尝试此操作，并且确实将预览表面旋转了 90 度并将其锁定为纵向模式......

我不知道如何解决这个问题并获得一个面向肖像的视频，并且尝试了与这个主题相关的无数解决方案，但都无济于事......

代码：

```
public class CameraRecorder {

private Camera cam;
private MediaRecorder mMediaRecorder;
private CameraPreview mPreview;
private static Context mContext;

public CameraRecorder(CameraPreview preview, Context context){

    mPreview = preview;
    cam = mPreview.getCamera();
    //cam.getParameters().setRotation(0);
    mContext = context;

}

public boolean prep(){

    mMediaRecorder = new MediaRecorder();
    //mMediaRecorder.setOrientationHint(90);

    // Step 1: Unlock and set camera to MediaRecorder
    cam.unlock();
    mMediaRecorder.setCamera(cam);

    // Step 2: Set sources
    //mMediaRecorder.setAudioSource(mContext.openFileInput());
    mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

    // Step 3: Set a CamcorderProfile (requires API Level 8 or higher)
    mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    //mMediaRecorder.setVideoSize(mPreview.getMeasuredWidth(), mPreview.getMeasuredHeight());
    mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.MPEG_4_SP);

    //mMediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_LOW));

    // Step 4: Set output file
    mMediaRecorder.setOutputFile(getOutputMediaFile().toString());

    // Step 5: Set the preview output
    mMediaRecorder.setPreviewDisplay(mPreview.getHolder().getSurface());

    // Step 6: Prepare configured MediaRecorder
    try {
        mMediaRecorder.prepare();
    } catch (IllegalStateException e) {
        Log.d("Exception", "IllegalStateException preparing MediaRecorder: " + e.getMessage());
        releaseMediaRecorder();
        return false;
    } catch (IOException e) {
        Log.d("Exception", "IOException preparing MediaRecorder: " + e.getMessage());
        releaseMediaRecorder();
        return false;
    } catch (Exception e) {
        Log.d("Exception", "Exception preparing MediaRecorder: " + e.getMessage());
        return false;
    }
    return true;

}

public static File getOutputMediaFile(){

    File mediaFile;

    mediaFile = new File(mContext.getCacheDir() + File.separator + "vid.mp4");

    return mediaFile;

}

public void releaseMediaRecorder(){

    if (mMediaRecorder != null) {
        mMediaRecorder.reset();   // clear recorder configuration
        mMediaRecorder.release(); // release the recorder object
        mMediaRecorder = null;
        cam.lock();           // lock camera for later use
    }

}

public void startRecording(){

    mMediaRecorder.start();

}

public void stopRecording(){

    try {
        mMediaRecorder.stop();  // stop the recording
        releaseMediaRecorder(); // release the MediaRecorder object
        cam.lock();
    } catch (Exception e) {
        Log.d("Exception","Exiting with exception: " + e.getMessage());
    }

}

} 
```

我已经尝试了各种注释方法的组合，但没有结果（设置特定的视频大小会导致“尝试删除损坏的文件”错误”，所以我已经不管它了）......我故意忽略了音频源方式因为我只需要视频（我需要稍后拼接音频，实际上也不知道从哪里开始）

非常感谢任何提示、想法或指示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:19:40.097

您无法旋转视频。只是预览表面或静止图像。但不是视频流。

# android - 即使索引在范围内，getPointerId 也会引发异常

> ID：12252928
> 
> 赞同：0
> 
> 时间：2012-09-03T19:09:16.650
> 
> 标签：android, multi-touch

这段代码

```
android.view.MotionEvent event = ...;

for(int i = 0, n = event.getPointerCount(); i < n; i++)
{
    handleTouch(event.getPointerId(i), event.getX(i), event.getY(i));
} 
```

偶尔抛出一个`IllegalArgumentException`：

```
09-03 19:43:21.996 E/AndroidRuntime( 9484): FATAL EXCEPTION: GLThread 732
09-03 19:43:21.996 E/AndroidRuntime( 9484): java.lang.IllegalArgumentException: pointerIndex out of range
09-03 19:43:21.996 E/AndroidRuntime( 9484):     at android.view.MotionEvent.nativeGetPointerId(Native Method)
09-03 19:43:21.996 E/AndroidRuntime( 9484):     at android.view.MotionEvent.getPointerId(MotionEvent.java:1927) 
```

这似乎是不可能的，因为`getPointerId`有记录从 0 获取索引`getPointerCount()-1`（请参阅[文档](http://developer.android.com/reference/android/view/MotionEvent.html#getPointerId%28int%29)）。

我知道做的唯一奇怪的事情是我`GLSurfaceView.queueEvent`用来传递`MotionEvent`到 GL 表面的渲染线程进行处理：

```
public boolean onTouchEvent(final MotionEvent event)
{
    queueEvent(new Runnable() {
        public void run() {
            worker.handleTouchEvent(event);
        }
    });
    return true;
} 
```

我正在获得对我认为应该是不可变的对象的引用，并且我认为我正在安全地将其传递给另一个线程进行处理，在那里我只进行只读访问。

因此，我将访问实际 MotionEvent 对象的代码移至 UI 线程，但由于该问题很少发生，因此在应用程序发布之前我不知道我是否真正解决了该问题。

**问题**：这里真正出了什么问题？

**后续问题**：假设这与我使用多线程有关，我如何*安全*地将 MotionEvent 发送到另一个线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T16:56:47.103

根据您提到[的文档](http://developer.android.com/reference/android/view/MotionEvent.html)，您需要在 getX()、getY() 的调用中使用从 findPointerIndex() 获得的索引：

```
for (int i = 0, n = event.getPointerCount(); i < n; i++)
{
    int pid = event.getPointerId(i);
    int index = event.findPointerIndex(pid);
    if (index != -1)
    {
        handleTouch(pid, event.getX(index), event.getY(index));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T18:41:49.693

经过进一步测试，我现在确信 Android 框架确实在 onTouchEvent 返回后重用了 MotionEvent 对象。

因此，事件对象不能被视为不可变对象；特别是，不应将其保留在事件处理函数的末尾之外，或传递给另一个线程。

# ios - 如何以编程方式访问 nib 上的导航按钮控件

> ID：12252934
> 
> 赞同：0
> 
> 时间：2012-09-03T19:09:55.923
> 
> 标签：ios, xcode, nib

我的笔尖上有一个按钮，我想告诉它一旦被选中就转到另一个笔尖页面。

下面是它的外观：

2个笔尖。

nib1 在导航栏中有一个名为`'btnHome'`.

选择它后，我希望它转到 nib2。

我将如何访问按钮控件来告诉它这样做？

在笔尖设计视图中，我无法正常右键单击并拖动`'btnHome'`到另一个笔尖 - 因此需要以编程方式执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:50:04.893

您需要在您的第一个视图控制器上创建一个 IBAction 方法，其目的是呈现您的第二个视图控制器（其 UI 在 nib2 中定义）。然后，您需要指示导航栏按钮向您的第一个视图控制器发送消息，以便在按下按钮时执行该方法。

您的 IBAction 可能如下所示：

```
- (IBAction)didClickButton:(id)sender
{
    MyViewController2 *myVC2 = [[MyViewController2 alloc] initWithNibName:@"MyNib2Name" bundle:nil];    
    [self presentViewController:myVC2 animated:NO completion:nil];
} 
```

然后，完成此操作后，转到您的 nib1 并按住 Control 键从导航按钮拖动到您的第一个视图控制器，然后从弹出的 Sent Actions 菜单中选择您的 IBAction 方法 (didClickButton:)。

使用故事板使这个过程更容易。

# c# - 打印没有“打印”对话框的页面？

> ID：12252936
> 
> 赞同：1
> 
> 时间：2012-09-03T19:10:24.693
> 
> 标签：c#, asp.net, printing

我有这个想要打印的 ASP.NET 页面。我现在正在做的是使用`OnClientClick`并从那里调用一个函数`PrintThePage()`，该函数除了调用`Window.Print()`. 当我这样做时，用户会看到“打印”对话框，她可以在其中选择打印机（并设置其属性以及不设置的属性），然后打印页面。

问题是我想使用默认打印机打印页面而不显示打印对话框。这是我尝试过的：

```
protected void Page_Load(object sender, EventArgs e)
{
    System.Drawing.Printing.PrinterSettings ps =
        new System.Drawing.Printing.PrinterSettings();

    ps.PrintFileName = Path.GetFileName(Request.Url.LocalPath);

    System.Drawing.Printing.PrintDocument pd =
        new System.Drawing.Printing.PrintDocument();

    pd.PrinterSettings = ps;
    pd.Print();
} 
```

我的默认打印机是`OneNote`（Microsoft 发送到 One Note）。**问题：**在打印页面时，只生成了一个空白页面。

我首先尝试将我的默认打印机设置为`doPdf`. 当这不起作用时，我尝试使用我真正的 HP 打印机。但我仍然收到相同的结果。该页面未显示打印对话框...该问题消失了。但问题是为什么页面不打印？为什么我得到一个空白/null/nada 页面？我的代码有问题吗？还是我打印机的问题？再一次，一个问题消失了。我不再得到`Print Dialog Box`. 我只是没有得到打印页，只是一个空白页。

谁能告诉我发生了什么？我能做些什么来实现我的目标？（我希望我已经说得够清楚了！）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:12:13.190

我认为您将客户端打印与服务器上的打印混淆了。

您可以使用 Java 在客户端进行打印，了解一些优惠券打印机的工作原理。然而，这是不受欢迎的。客户应该始终可以选择他们希望如何打印。

调用`Page_Load`将在服务器端打印机上完成。

# php - 如何使用单个 MySQL 查询更改 mysql 中的多个表？

> ID：12252940
> 
> 赞同：1
> 
> 时间：2012-09-03T19:11:08.537
> 
> 标签：php, mysql, alter-table

我可以通过在 MySQL 中为每个表编写一个查询来更改表。

```
ALTER TABLE `nom_table` ADD `images` VARCHAR(255) NULL AFTER `link` 
```

但是当我在单行中编写许多更改语句时，Mysql 显示语法错误。

```
ALTER TABLE `nom_table` ADD `data1` VARCHAR(255) NULL AFTER `link`
ALTER TABLE `nom_table` ADD `data2` VARCHAR(255) NULL AFTER `link` 
```

我必须在 PHP 中多次执行此操作，因此如果我对许多 alter 语句运行单个查询，那么服务器的负载将非常少。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:21:04.870

你可以写：

```
ALTER TABLE `nom_table`
    ADD `data1` VARCHAR(255) NULL AFTER `link`,
    ADD `data2` VARCHAR(255) NULL AFTER `link`; 
```

请参阅[此处的完整语法](http://dev.mysql.com/doc/refman/5.5/en/alter-table.html)。

但是，您**不能**在单个查询中更改不同的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T14:50:10.870

这对我有用......

```
$ContentTables

Array
(
    [11] => Array
        (
            [db_table] => Content_Tips
            [label2] => Tip
        )

/* .... same for 11 more tables... */

    foreach ($ContentTables as $table => $values ) {

    $thisTable = $values['db_table'];

    $addColumns = mysql_query("
        ALTER TABLE $thisTable
        ADD `ranking` INT(3) AFTER `edit_date`,
        ADD `frequency` INT(3) AFTER `ranking` ")

    or die( 'Opps...something wrong in the backroom....'.$thisTable.'...1'.mysql_error());

    if ($addColumns) { echo $thisTable.' has been altered...<br/>'; }
} 
```

# jquery - 为什么我的 jQuery 小部件过大？

> ID：12252941
> 
> 赞同：3
> 
> 时间：2012-09-03T19:11:39.807
> 
> 标签：jquery, jquery-ui, widget

正如您在这个[小提琴](http://jsfiddle.net/755nK/ "小提琴")中看到的那样，与相同主题的[Themeroller 页面](http://jqueryui.com/themeroller/#ffDefault=Segoe+UI,+Arial,+sans-serif&fwDefault=bold&fsDefault=1.1em&cornerRadius=6px&bgColorHeader=333333&bgTextureHeader=12_gloss_wave.png&bgImgOpacityHeader=25&borderColorHeader=333333&fcHeader=ffffff&iconColorHeader=ffffff&bgColorContent=000000&bgTextureContent=05_inset_soft.png&bgImgOpacityContent=25&borderColorContent=666666&fcContent=ffffff&iconColorContent=cccccc&bgColorDefault=555555&bgTextureDefault=02_glass.png&bgImgOpacityDefault=20&borderColorDefault=666666&fcDefault=eeeeee&iconColorDefault=cccccc&bgColorHover=0078a3&bgTextureHover=02_glass.png&bgImgOpacityHover=40&borderColorHover=59b4d4&fcHover=ffffff&iconColorHover=ffffff&bgColorActive=f58400&bgTextureActive=05_inset_soft.png&bgImgOpacityActive=30&borderColorActive=ffaf0f&fcActive=ffffff&iconColorActive=222222&bgColorHighlight=eeeeee&bgTextureHighlight=03_highlight_soft.png&bgImgOpacityHighlight=80&borderColorHighlight=cccccc&fcHighlight=2e7db2&iconColorHighlight=4b8e0b&bgColorError=ffc73d&bgTextureError=02_glass.png&bgImgOpacityError=40&borderColorError=ffb73d&fcError=111111&iconColorError=a83300&bgColorOverlay=5c5c5c&bgTextureOverlay=01_flat.png&bgImgOpacityOverlay=50&opacityOverlay=80&bgColorShadow=cccccc&bgTextureShadow=01_flat.png&bgImgOpacityShadow=30&opacityShadow=60&thicknessShadow=7px&offsetTopShadow=-7px&offsetLeftShadow=-7px&cornerRadiusShadow=8px "Themeroller 页面")上的弹出窗口相比，日期选择器弹出窗口非常大。这发生在对话框等其他小部件上。

如果您查看资源面板，您会看到我已链接到未经修改的 Google 托管的 css 和 js 文件，所以我没有对文件做任何事情.. 我怎样才能让我的小部件像那些一样显示得很好在 Themeroller 页面上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:16:41.527

Try this :

```
.ui-widget {
    font-size: 12px;
} 
```

The default `font-size` of the jquery-ui themeroller is **10px**, the `.ui-widget` CSS property comes with `font-size:1.1em`, and `.ui-datepicker` table comes after with `font-size:0.9em`.

To conclude, the font-size of your jquery-ui widgets depends on your default CSS font-size.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:16:07.570

# ajax - Google 索引：_escaped_fragment_ 不适用于主页

> ID：12252943
> 
> 赞同：2
> 
> 时间：2012-09-03T19:11:49.003
> 
> 标签：ajax, gwt

我确实将我的网站 (GWT) 设置为可被 Google 抓取。在 Google webmastertool 上使用“fetch as google”页面时，我看到以下模式：

*   访问“http://www.mysite.com/#!AJAX_URL”被正确重定向到快照
*   但谷歌并没有请求“http://www.mysite.com”的快照，尽管我确实在 web.xml 中设置了

==> 与此相关的两个问题：

*   是不是因为谷歌站长工具不够聪明，但真正的机器人会正确请求快照
*   我应该在 web.xml 或其他任何地方添加一些东西吗？

谢谢，

雨果

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T10:05:17.810

经过大量搜索，我找到了答案。它只是 Fetch as Googlebot 功能，它不检查元标记，而只是返回原始内容。当谷歌抓取和索引页面时，他们会注意到元标记并采取相应的行动。

答案的链接在这里（见[JohnMu](http://productforums.google.com/forum/#!category-topic/webmasters/crawling-indexing--ranking/bZgWCJTnl08)的评论）：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T00:18:54.143

确保您的“robots.txt”允许爬虫访问：

```
User-agent: *
Allow: / 
```

此外，您可能需要向[网站管理员工具提交站点地图](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=183669)。

听起来快照服务正确。以防万一，我发布了工作“index.php”的相关部分。静态页面位于 'static/${TOKEN}.html'

```
<!doctype html>
<?php

function static_url ($token) { return 'static/' . $token . '.html'; }

$escaped_fragment = $_GET['_escaped_fragment_'];

if (isset($escaped_fragment)) {
  $fragment = preg_replace('/\//', '', $escaped_fragment);
  $file = static_url($fragment);

  if($escaped_fragment == '' || $escaped_fragment == '/'
      || (! file_exists($file))) {
    $fragment = '${DEFAULT_PLACE}:${DEFAULT_STATE}'; // your default place
    $file = static_url($fragment);
  }
  $re = '/(^<[^>]*>)|(\n|\r\n|\t|\s{2,4})*/';

  $handle = fopen($file, 'r');
  if ($handle != false) {
    $content = preg_replace($re, '', fread($handle, filesize($file)));
    fclose($handle);
  }
  else {
    $content = 'Page not found!';
    header(php_sapi_name() == 'cgi' ? 'Status: 404' : 'HTTP/1.1 404');
  }
  echo $content;
} else { ?>

<html> ... Your GWT host page ... </html>

<? } ?> 
```

# java - 如何在我的班级上创建一个从零自动递增到 255 的字段

> ID：12252945
> 
> 赞同：0
> 
> 时间：2012-09-03T19:12:00.757
> 
> 标签：java, hibernate, jpa

在 JPA 上创建序列我通常使用这个 @GeneratedValue(strategy=GenerationType.AUTO) @SequenceGenerator(name="example_sequence", sequenceName="example_sequence")

但我想创建一个也自动生成的序列，但它从 0 增加到 255，当达到这个值时，它从零重新开始

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:25:09.287

您将需要创建自己的序列生成器

[http://www.objectdb.com/api/java/jpa/SequenceGenerator](http://www.objectdb.com/api/java/jpa/SequenceGenerator)

[http://openjpa.apache.org/builds/1.1.0/docs/jpa_overview_mapping_sequence.html](http://openjpa.apache.org/builds/1.1.0/docs/jpa_overview_mapping_sequence.html)

[http://blog.cyclopsgroup.org/2007/04/custom-idgenerator-for-jpa-gap-between.html](http://blog.cyclopsgroup.org/2007/04/custom-idgenerator-for-jpa-gap-between.html)

# actionscript-3 - 如何在 AS3 中的函数内杀死 EnterFrame

> ID：12252954
> 
> 赞同：1
> 
> 时间：2012-09-03T19:12:33.097
> 
> 标签：actionscript-3

如何像这样用我的 actionscript 3 删除我的 EventListener，我尝试了任何代码，但我仍然无法杀死我的 EventListener，请帮助新手....

```
Multitouch.inputMode = MultitouchInputMode.GESTURE;

stage.addEventListener(TransformGestureEvent.GESTURE_SWIPE, fl_SwipeToGoToNextPreviousFrame);

function fl_SwipeToGoToNextPreviousFrame(event:TransformGestureEvent):void
{
    if (event.offsetX == -1)
    {
        // swiped left
        nextFrame,play();
    }

    else if (event.offsetX == 1)
    {
        addEventListener(Event.ENTER_FRAME, fl_EnterFrameHandler_2);

        function fl_EnterFrameHandler_2(event:Event):void
        {
            prevFrame();

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T20:40:05.520

您可以随时放入功能行：

```
function eventHandler (event:Event):void {
    event.currentTarget.removeEventListener(event.type , arguments.callee);
} 
```

这将从内部处理函数中删除事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:21:13.703

```
removeEventListener(Event.ENTER_FRAME, fl_EnterFrameHandler_2); 
```

应该`removeEventListener`这样做

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T06:27:35.940

您似乎无法`fl_EnterFrameHandler_2`从外部某处解析函数名称。将其代码放在分隔滑动侦听器函数的括号之外：

```
function fl_SwipeToGoToNextPreviousFrame(event:TransformGestureEvent):void
{
    if (event.offsetX == -1)
    {
        // swiped left
        nextFrame,play();
    }

    else if (event.offsetX == 1)
    {
        addEventListener(Event.ENTER_FRAME, fl_EnterFrameHandler_2);
    }
}

function fl_EnterFrameHandler_2(event:Event):void
{
    prevFrame();
} 
```

像这样。有了这个，您就可以`removeEventListener(Event.ENTER_FRAME, fl_EnterFrameHandler_2);`从其他地方调用。

# c# - 使用多线程比较 4 片字节数组

> ID：12252955
> 
> 赞同：1
> 
> 时间：2012-09-03T19:12:35.373
> 
> 标签：c#, multithreading, arraylist, parallel-processing, bytearray

我坚持项目的第二阶段：将一个字节 [] 拆分为 4 个切片（以加载 QuadCore I5 CPU），然后在每个切片上，在每个内核上启动一个线程（比较任务）。

原因是试图加速两个相同大小的字节数组之间的比较我如何处理这个？

```
 [DllImport("msvcrt.dll", CallingConvention = CallingConvention.Cdecl)]
    static extern int memcmp(byte[] b1, byte[] b2, long count);

class ArrayView<T> : IEnumerable<T> 
    {
        private readonly T[] array;
        private readonly int offset, count;
        public ArrayView(T[] array, int offset, int count)
        {
            this.array = array; this.offset = offset; this.count = count;
        }
        public int Length { get { return count; } }
        public T this[int index] {
            get { if (index < 0 || index >= this.count)
                throw new IndexOutOfRangeException();
            else
                return this.array[offset + index]; }
            set { if (index < 0 || index >= this.count)
                throw new IndexOutOfRangeException();
            else
                this.array[offset + index] = value; }
        }
        public IEnumerator<T> GetEnumerator()
        {
            for (int i = offset; i < offset + count; i++)
                yield return array[i];
        } 
        IEnumerator IEnumerable.GetEnumerator()
        {
            IEnumerator<T> enumerator = this.GetEnumerator();
            while (enumerator.MoveNext())
            {
                yield return enumerator.Current;
            }
        }
    } 

    public void CopmarArrSlice()
    {

    byte[] LoadedArr = File.ReadAllBytes("testFileCompare2Scr.bmp");

    int LoddArLn = OrgArr.Length;
    int range =  (LoddArLn / 4) - LoddAremainder;
    int divisionremain = LoddArLn - (range * 4);

    ArrayView<byte> LddP1 = new ArrayView<byte>(OrgArr, 0, range);
    ArrayView<byte> LddP2 = new ArrayView<byte>(OrgArr, p1.Length, range);
    ArrayView<byte> LddP3 = new ArrayView<byte>(OrgArr, (p1.Length + p2.Length), range);
    ArrayView<byte> LddP4 = new ArrayView<byte>(OrgArr, (p1.Length + p2.Length + p3.Length), range + divisionremain);

        if (AreEqual(LddP1, CapturedP1)) ....Do Somthing

    }

    public bool AreEqual(byte[] a, byte[] b)
    {
        if (a == b)
           return true;
        if (a == null || b == null)
            return false;
        if (a.Length != b.Length)
            return false;
        return memcmp(a, b, a.Length) == 0;
    }

    CopmarArrSlice(); 
```

在这种情况下，如何使用 AreEqual(using memcmp) 将其与使用 4 个线程/Parallelism 进行比较，以在每个 CpuCore 上进行计算

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T20:11:26.253

我编写了一个函数，尽可能利用多个内核，但它似乎受到 p/invoke 调用的严重性能影响。我认为这个版本只有在测试非常大的数组时才有意义。

```
static unsafe class NativeParallel
{
    [DllImport("msvcrt.dll", CallingConvention = CallingConvention.Cdecl)]
    static extern int memcmp(byte* b1, byte* b2, int count);

    public static bool AreEqual(byte[] a, byte[] b)
    {
        // The obvious optimizations
        if (a == b)
            return true;
        if (a == null || b == null)
            return false;
        if (a.Length != b.Length)
            return false;

        int quarter = a.Length / 4;
        int r0 = 0, r1 = 0, r2 = 0, r3 = 0;
        Parallel.Invoke(
            () =>  {
                fixed (byte* ap = &a[0])
                fixed (byte* bp = &b[0])
                    r0 = memcmp(ap, bp, quarter);                        
            },
            () => {
                fixed (byte* ap = &a[quarter])
                fixed (byte* bp = &b[quarter])
                    r1 = memcmp(ap, bp, quarter);
            },
            () => {
                fixed (byte* ap = &a[quarter * 2])
                fixed (byte* bp = &b[quarter * 2])
                    r2 = memcmp(ap, bp, quarter);
            },
            () => {
                fixed (byte* ap = &a[quarter * 3])
                fixed (byte* bp = &b[quarter * 3])
                    r3 = memcmp(ap, bp, a.Length - (quarter * 3));
            }
        );
        return r0 + r1 + r2 + r3 == 0;
    }
} 
```

在大多数情况下，它实际上比优化的安全版本慢。

```
static class SafeParallel
{
    public static bool AreEqual(byte[] a, byte[] b)
    {
        if (a == b)
            return true;
        if (a == null || b == null)
            return false;
        if (a.Length != b.Length)
            return false;

        bool b1 = false;
        bool b2 = false;
        bool b3 = false;
        bool b4 = false;
        int quarter = a.Length / 4;
        Parallel.Invoke(
            () => b1 = AreEqual(a, b, 0, quarter),
            () => b2 = AreEqual(a, b, quarter, quarter),
            () => b3 = AreEqual(a, b, quarter * 2, quarter),
            () => b4 = AreEqual(a, b, quarter * 3, a.Length)
        );
        return b1 && b2 && b3 && b4;
    }

    static bool AreEqual(byte[] a, byte[] b, int start, int length)
    {
        var len = length / 8;
        if (len > 0)
        {
            for (int i = start; i < len; i += 8)
            {
                if (BitConverter.ToInt64(a, i) != BitConverter.ToInt64(b, i))
                    return false;
            }
        }
        var remainder = length % 8;
        if (remainder > 0)
        {
            for (int i = length - remainder; i < length; i++)
            {
                if (a[i] != b[i])
                    return false;
            }
        }
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:07:30.457

我认为您不必以单线程和经典 c# 方式拆分字节，您将使用

```
foreach(byte currentArr in LoadedArr)
{
    if (AreEqyal(currentArr, CapturedP1))
           ....Do Somthing
} 
```

但是要通过将工作负载分配给多个线程来处理每个字节，您必须使用以下语法；

```
// max your threads count in my case 16,
int[] sums = new int[16];// optional, just to know the workload
public void ProcessMyByte(byte current)
{
    if (AreEqyal(current, CapturedP1))
           ....Do Somthing

       // optional just to know what thread is in
        sums[Thread.CurrentThread.ManagedThreadId]++;// increment the number of iterations done by the thread who did this elementary process
}

.... Main()...
{
....

byte[] LoadedArr = File.ReadAllBytes("testFileCompare2Scr.bmp");
Parallel.ForEach(LoadedArr, ProcessMyByte);

...
} 
```

所以并行性将代表您进行管理，甚至更好，因为当一个线程空闲时，它会获得下一个任务，而不是好像您将它分成 4 个，每个线程都必须处理 Length/4。

# c - c代码输出混乱

> ID：12252957
> 
> 赞同：0
> 
> 时间：2012-09-03T19:12:59.923
> 
> 标签：c

有人可以给我下面代码的解释。输出如代码后所述。

```
char s[] = "char s[] = %c%s%c; main(){ printf(s,43,s,43); }";

void main(){
    printf(s,34,s,34);
} 
```

**输出-**

```
char s[] = "char s[] = %c%s%c; main(){ printf(s,43,s,43); }"; main(){ printf(s,43,s,43); }

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:17:19.427

您正在使用该字符串`char s[] = %c%s%c; main(){ printf(s,43,s,43); }`作为格式化字符串。

第一个 arg 使用`%c`. 论据是`34`。所以它打印出值为 的 ASCII 字符`34`，即`"`（一个字符；双引号）。

第二个 arg 使用`%s`. 参数是相同的格式字符串，`char s[] = %c%s%c; main(){ printf(s,43,s,43); }`. 所以它打印出相同的字符串。

第三个 arg`%c`也是`34`, 所以它打印另一个引号。

这里的所有都是它的。部分：

```
lit --> char s[] = 
%c  --> "
%s  --> char s[] = %c%s%c; main(){ printf(s,43,s,43); }
%c  --> "
lit --> ; main(){ printf(s,43,s,43); } 
```

其中，当放在一起时，是：

```
char s[] = "char s[] = %c%s%c; main(){ printf(s,43,s,43); }"; main(){ printf(s,43,s,43); } 
```

# javascript - 如何在闭包中冻结函数的变量？

> ID：12252959
> 
> 赞同：1
> 
> 时间：2012-09-03T19:13:05.217
> 
> 标签：javascript, html, google-chrome, closures

我正在开发一个支持重复事件的日历，因此预期的行为是，当有人在某一天检查一项活动的“完成”复选框时，它会隐藏当天的活动实例，而其他活动则保持不变。

实际看到的行为是，当有人选中任何复选框时，它会删除该活动的最后一天的实例，我很确定这是因为函数正在访问闭包中循环的最新变量，而不是这些变量在运行时所持有的值。相关的代码片段是：

```
for(var index = 0; index < elements.length; ++index)
    {
    var split_id = elements[index].id.split('_');
    var id = Number(split_id[1]);
    var day = split_id[2];
    var date = split_id[3];
    var month = split_id[4];
    var year = split_id[5];
    elements[index].onclick = function()
        {
        alert(id + '_' + day + '_' + date + '_' + month + '_' + year);
        if (calendar[id][2].indexOf(id + '_' + day + '_' + date + '_' + month + '_' + year) === -1)
            {
            calendar[id][2][calendar[id][2].length] = id + '_' + day + '_' + date + '_' + month + '_' + year;
            }
        save_all();
        update_calendar_display();
        }
    } 
```

让 onclick 函数访问它在创建时而不是在循环退出时具有的变量的最佳选择是什么？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:30:24.700

你没有在你的代码中使用任何闭包。for 循环没有定义范围。试试这个

```
function clickFunction(id, date, day, month, year) {  
        return function() {
          alert(id + '_' + day + '_' + date + '_' + month + '_' + year);
          if (calendar[id][2].indexOf(id + '_' + day + '_' + date + '_' + month + '_' + year) === -1) {
              calendar[id][2][calendar[id][2].length] = id + '_' + day + '_' + date + '_' + month + '_' + year;
            }
          save_all();
          update_calendar_display();  
        }  
} 
```

然后

```
elements[index].onclick = clickFunction(id, date, day, mo) 
```

# sql - 为您的客户从 Azure 试用版过渡到完整生产模式是否容易？

> ID：12252960
> 
> 赞同：0
> 
> 时间：2012-09-03T19:13:06.180
> 
> 标签：sql, azure, licensing, bizspark

我计划使用 Azure 向我的客户提供服务。以下是可能/最好的方法吗？

*   使用试用版通过我的 Bizspark 会员资格开始使用 Azure
*   使用他们提供的工具（Visual Studio、SQL Azure 等）在 Azure 服务器上开发和测试我的应用程序
*   一旦我的服务准备好在现实世界中交付，从试用版切换到完整版

与交付我的服务相关的唯一成本是基于使用情况吗？我是否需要购买完整的 Azure 许可证，或者我需要的所有东西都已由 Bizspark 提供？在我的机器上下载 Visual Studio 有什么好处，还是应该在 Azure 上全部开发？

很抱歉有很多问题......我非常感谢您在这个平台上入门的任何帮助。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:42:14.513

您的 BizSpark 帐户有 3 年的窗口期，应该可以让您开始使用。最初它设置为 0 美元的支出上限，因此如果您超出每月资源分配（例如 1500 计算小时、35GB 出站带宽等），您的帐户将被禁用到下个月。*或者...*您可以禁用支出上限，任何超额费用都会从您的信用卡中扣除。因此，您不必担心继续使用您的 BizSpark 帐户。

请注意，与 MSDN 订阅绑定的 BizSpark*不是*试用订阅 - 它的功能与任何其他 Windows Azure 订阅一样，只是向您授予某些资源而无需付费。在 3 年期结束时，您需要查看服务条款以查看是否需要将您的应用程序 + 数据迁移到新订阅（我怀疑您可能需要）。客户服务可以提供帮助。

关于下载 Visual Studio 与“在 Azure 上全部开发” - 不知道你的意思。使用虚拟机或代码的 web/worker 角色，您仍然需要开发部署到虚拟机的应用程序（无论这些 vm 是由 Windows Azure 还是您管理）。您需要在本地安装 Visual Studio（或 Eclipse，或您开发的任何环境）来构建您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:40:11.110

Windows Azure 本身没有试用版，也没有“Azure 许可证”——它都是“生产”。BizSpark 提供每月福利，本质上是服务补贴，但没有功能差异。如果您使用 BizSpark，您将部署到与全额付费客户相同的数据中心。也就是说，Azure 中有暂存和生产插槽，允许您在通过公共 URL“实时”公开您的应用程序之前在云中进行测试，但这与您所暗示的上下文略有不同。

但是，您要考虑的是谁拥有订阅以及谁是服务管理员和共同管理员。如果*您*拥有 BizSpark 下的订阅和帐户，则不能只是将订阅的所有权转移给您的客户。他们必须创建一个新订阅，您必须在他们的订阅下重新创建存储帐户、服务等，同时移动您可能在您的帐户下启动的所有资产。这不是不可能的，而是需要计划的。

此列表中还有其他人可以提供有关此类转换的更多“现实世界”建议，但我建议使用您的 BizSpark 帐户进行自己的开发。当客户参与时，鼓励他们自己订阅 - 90 天试用帐户很好，并且可以轻松转换为完全付费帐户。他们将拥有订阅，但可以让您成为服务管理员或共同管理员。然后，当项目完成后，他们只需将您作为管理员删除即可，您就完成了！

至于*需要*BizSpark 以外的帐户 - 您可能不取决于项目的大小。您可以设置帐户，以便如果您确实需要超过每月配额，超额将按现收现付费率计费。请注意，BizSpark 是一个为期 3 年的计划。

至于“在 Azure 中开发它”与“下载 Visual Studio”……Azure 是一个部署平台，你必须在某些东西上开发你的代码。对于 .NET，绝对是 Visual Studio，但对于其他环境 Java、PHP、node.js 等，您可以使用任何您想要的。 [有适用](http://www.windowsazure.com/en-us/develop/overview/)于各种平台的 SDK。

# jquery - jquery .not() 没有从 jquery 对象中删除元素

> ID：12252961
> 
> 赞同：1
> 
> 时间：2012-09-03T19:13:07.620
> 
> 标签：jquery

我在 html 中有一个冗长的表单，其中一些`<input>`有一个名为`dependancy`. 我有一个使用 jQuery 选择`<form>`元素的函数。像这样：

```
form = module.find('#formContainer').find('form'); 
```

`form`现在包含一个 HTML ，我通过输出`form`到控制台确保它包含它。现在，我想删除其中包含的一些元素属于`form`class `dependancy`。我想我可以像这样使用 jQuery 的 .not() ：

```
disabledFormElements = form.find('.dependency');
cleanForm = form.not(disabledFormElements); 
```

当我输出`disabledFormElements`到控制台时，它只显示我想要删除的元素。唉， class 的元素`dependancy`并没有从`form`. 根据 jQuery 文档，您可以将各种类型传递给 .not() 方法，它应该可以工作。为什么 .not() 函数不能从 jQuery 中删除元素`form`？

我正在添加表单的 HTML 以使其更清晰：

```
<div id="formContainer">

<form id="customText" accept-charset="UTF-8">
  <div class="row equal-field-heights">
    <div class="four columns">
      <fieldset>
        <legend>Is this for a Bar or Bat Mitzvah?</legend>
    <div class="four columns">
      <label for="radio1">
        <input class="dependency" name="gender" type="radio" id="radio1" value="m" checked onclick="changeGender('m')">Bar
      </label>

  </div>

  <div class="four columns">
    <label for="radio2">
  <input class="dependency" name="gender" type="radio" id="radio2" value="f" onclick="changeGender('f')">Female
    </label>
  </div>

  <input type="hidden" name="as_he_she_steps" id="as_he_she_steps" value="he steps" />
  .
  .
  .
  .
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:46:34.570

你的误解是这样的：

```
form = module.find('#formContainer').find('form'); 
```

创建一个只包含实际`form`元素的 jQuery 对象，而不是它们的后代/子元素。如果 formContainer 中只有一个表单对象，那么这个 jQuery 对象只包含一个 DOM 元素。

因此，当您尝试使用 从中删除项目时，`.not()`jQuery 对象中的任何内容都不会匹配，因此不会删除任何内容。

如果你想要一个包含表单中所有对象的 jQuery 对象，你可以这样做：

```
form = module.find("#formContainer form *"); 
```

而且，如果您想删除与您的班级匹配的所有项目，您可以这样做：

```
form = module.find("#formContainer form *").not(".dependancy"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:19:08.213

您应该使用它来选择除`.dependancy`类元素之外的元素。

```
cleanForm = form.not(".dependancy"); 
```

如果上面的代码不起作用试试这个：

```
cleanForm = $(form).not(".dependancy"); 
```

或者交替使用这个：

```
cleanForm = $(form).find(":not(.dependancy)"); 
```

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:23:32.947

[not()](http://api.jquery.com/not/)过滤掉与其参数匹配的元素，并从剩余的元素中构建一个*新的 jQuery 对象。*它不会就地修改原始 jQuery 对象。

我最初的答案被误导了，因为传递`find()`to的结果`not()`总是会返回一个与原始内容相同的 jQuery 对象，因为[find()](http://api.jquery.com/find/)返回的后代元素在我们的例子中不属于原始集合的一部分。

我建议您使用[:not()](http://api.jquery.com/not-selector/)选择器一次性匹配`<form>`您要查找的元素：

```
var form = module.find("#formContainer form:not(.dependency)"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T19:38:00.137

那这个呢 ？

```
module.find('#formContainer').find('form').each(function(i, f){
    form = $(f);
    form.html(form.children().not(".dependancy"));
}); 
```

# entity-framework-4 - 如何避免数据类和服务代理之间的对象类冲突

> ID：12252962
> 
> 赞同：1
> 
> 时间：2012-09-03T19:13:12.893
> 
> 标签：entity-framework-4, wcf-data-services

我见过类似的问题，但没有直接解决我面临的挑战......

首先，我通常手动创建我的 WCF 客户端代理，因为从长远来看，我发现它们更容易处理。但是，在处理 WCF 数据服务和 EF 时，这并不是一个真正的选择，因为“幕后”做了很多事情......

在我的场景中，我有一个调用 WCF 数据服务的 WCF 服务。调用服务从客户端接收数据，该客户端传递由 EF 生成的实体对象。这些实体对象也在数据服务引用的程序集中。

当我在 VS2010 中生成客户端代理时，对象被放置在不同的命名空间中，因此我可以从客户端接收到的数据对象直接转换为代理类。为了解决这个问题，我修改了代理的 reference.cs 文件并更改了命名空间......这似乎可行，但会产生大量冲突警告......

有没有人有更清洁的方法来做到这一点？我不介意在一些指导下手动生成代理，因为它看起来很复杂。

谢谢，KBW

附加信息... 下面是我在 WCF 数据服务客户端代理中更改命名空间后从包装服务收到的警告消息。

C:\Azure\Tutorials\MyFirstAzureProject\awEntityData\awEntityData\Service References\AWEntityModel\Reference.cs 中的类型 'AW.Data.Demo.Contact' 与导入的类型 'Maevva.iSvr.Data.Demo.Contact' 冲突在“c:\Assemblies\AWDataModelLib.dll”中。使用“C:\Azure\Tutorials\MyFirstAzureProject\awEntityData\awEntityData\Service References\AWEntityModel\Reference.cs”中定义的类型。C:\Azure\Tutorials\MyFirstAzureProject\awEntityData\awEntityData\Custom Data\awEntityData.cs

# php - 退出后是否清除了函数范围内声明的变量占用的内存？

> ID：12252965
> 
> 赞同：0
> 
> 时间：2012-09-03T19:13:25.807
> 
> 标签：php, performance, memory

离开函数作用域后，函数作用域中声明的变量占用的内存是否被清除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:18:20.127

Yes of course the memory is cleared upon running the function

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:20:41.260

是的，当它们失去作用域时，它们被标记为垃圾收集。然后垃圾收集会在必要时启动，这可能不会立即启动。但是，由[create_function](http://www.php.net/manual/en/function.create-function.php)创建的函数不受此限制，可能会导致内存泄漏。从 5.3 开始，甚至还有一些针对较长脚本的真正[垃圾收集。](http://php.net/manual/en/features.gc.php)[在这里](http://phpmaster.com/better-understanding-phps-garbage-collection/)阅读更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:23:12.763

不是马上。大多数 GC 语言会在突发情况下进行“收集”——要么是由于堆空间限制而被认为有必要，要么是在执行过程中没有其他事情可做，这取决于策略。

# java - 如何使 java.util.Date 线程安全

> ID：12252967
> 
> 赞同：19
> 
> 时间：2012-09-03T19:13:30.413
> 
> 标签：java, multithreading, concurrency

据我所知，这`java.util.Date`是可变的，所以如果多个线程试图访问和修改它，它就不是线程安全的。我们如何使用客户端锁定或组合（包装器）使其成为线程安全的？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-03T19:17:03.693

按照这个顺序，从最好到最差：

0.  根本不使用它，请查看 Java 8 的[新 Date and Time API](http://www.oracle.com/technetwork/articles/java/jf14-date-time-2125367.html)。

1.  根本不用，看看[jodatime](/questions/tagged/jodatime "显示标记为“jodatime”的问题")

2.  根本不使用它，使用`AtomicLong`或不可变原语`long`来`volatile`表示*纪元时间*

3.  封装它。总是返回防御性的副本`Date`，而不是对内部对象的引用

4.  `Date`在实例上同步。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T19:18:16.357

您可以使用 long 值（自 Epoch 以来的毫秒数）而不是 Date 实例。分配它将是一个原子操作，并且始终是连贯的。

但是您的问题可能不在于 Date 值本身，而在于整个算法，这意味着真正的答案将基于您的实际问题。

这是多线程上下文中错误操作的示例：

```
long time;
void add(long duration) {
   time += duration; 
} 
```

这里的问题是你可能有两个并行添加导致只有一个有效的添加，因为`time += duration`它不是原子的（它真的是`time=time+duration`）。

使用 long 而不是可变对象是不够的。在这种情况下，您可以通过将函数设置为同步来解决问题，但其他情况可能会更加棘手。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-03T19:17:58.723

最简单的解决方案是永远不要修改 Date 并且永远不要共享它。即只对局部变量使用日期。

您可以使用 JodaTime，因为它具有不可变的日期对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-03T19:16:57.853

没有简单的解决方案来创建`Date`类的线程安全包装器。`synchronized`最好的方法是通过使用块来同步它的对象的所有用法。

# c# - 正则表达式按特定字符拆分，该字符可能在 c# 的字符串中的其他位置找到

> ID：12252968
> 
> 赞同：0
> 
> 时间：2012-09-03T19:13:38.640
> 
> 标签：c#, regex, string, split, string-matching

```
([0-9\*\+-/]+?)([\+-\*/])\?\{((?:(\?\{.*?\}))|(.*?))\} 
```

我正在使用上述模式来检测表单的模式：

```
5+(6/2)+?{5>2,?{2=4|5<6,5,5+6*2},10}}
       ^ 
```

或者

```
?{5>2,?{2=4|5<6,5,5+6*2},10}}*5+(6/2)
                             ^ 
```

我想用 ^ 标记的字符分割这个表达式

关于如何实现这一点的任何想法，我仍然是正则表达式的菜鸟。

提前致谢

注意：这部分：`([0-9\*\+-/]+?)([\+-\*/])`正则表达式尚未测试。但是，如果不是，我可以让它工作。但是我真正想知道的是如何拆分字符串。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:29:33.983

您应该使用[Regex.Split 方法](http://msdn.microsoft.com/en-us/library/8yttk7sy.aspx)：

```
string input = "?{5>2,?{2=4|5<6,5,5+6*2},10}}*5+(6/2)";
string[] str;
string pattern = @"(\?{.*})";
str = Regex.Split(input, pattern);
richTextBox1.Text = "";
foreach (string s in str)
{
    richTextBox1.Text += s +"\n"; 
} 
```

# windows - Visual Studio 2012 远程操作花费的时间比预期的要长

> ID：12252969
> 
> 赞同：40
> 
> 时间：2012-09-03T19:13:42.820
> 
> 标签：windows, visual-studio, 64-bit

我在 Windows 8 64 位上运行 Visual Studio 2012。我有一个源代码控制中的 64 位项目，我正试图在我的 Windows 8 电脑上在家中运行它。应用程序构建成功，但是远程调试器根本不起作用。

它说“远程操作花费的时间比预期的要长”。我理解为什么它是远程的，因为 32 位 Visual Studio 需要访问 msvsmon.exe 以通过 64 位应用程序进行调试，但我从未见过在已签出源代码的本地计算机上发生这种情况。

我尝试重新安装 Visual Studio 2012，使用端口（4016）以及以管理员身份运行。通过卸载客户端检查 VPN 不是问题。

我现在没有主意了。我尝试创建一个全新的本地项目进行测试并将其设置为 64 位，但操作仍然不成功。

有什么想法或建议吗？这是 Windows 8 上的 Visual Studio 2012 的已知问题吗？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-06-02T16:55:11.557

我认为你应该试试这个：

*   以管理员身份运行 cmd.exe。
*   输入并运行以下两行命令：

> netsh winsock 重置目录
> 
> netsh int ip reset reset.log 命中

*   可能会说需要重新启动，但实际上这不是必需的。
*   再次尝试调试您的应用程序，问题应该得到解决。

编辑：很抱歉之前没有对此提供解释。答案其实来自一个中文论坛，原作者没有过多解释。但他确实说过这是因为Visual Studio是一个32位程序，在64位Windows 7下可能无法访问网络，上述解决方案重置网络连接因此解决了问题。希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T13:19:17.937

我正在使用 VS2012（Windows7，64 位 PC）。当我选择 DEBUG - Attach to Process... 时，我确实看到了一个消息框，上面写着“64 位调试操作花费的时间比预期的要长”。我下载了 VS2010 的免费试用版，发现在 VS2010 中它运行良好。所以，我从 VS2010 (C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\Remote Debugger\x64 和 C:\ ... \x86) 复制了文件 msvsmon.exe 和 msvsmon.exe.config在VS2012中进入相同的地图。现在它正在运行VS2012。希望这对你也有帮助。祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-08T22:43:37.550

我使用 VS2012 的唯一答案是进入项目属性 > 编译 > 目标 CPU 并将选项设置为“x86”。

这似乎也与这个问题有关：[Can't start debugger in VS2012 RC](https://stackoverflow.com/questions/11179030/cant-start-debugger-in-vs2012-rc) 他们也将此提交给 Microsoft Connect。似乎是Visual Studio的问题...

祝你好运。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-01T12:35:19.097

只是我的两分钱，

我现在已经遇到过两次这个问题，在我尝试了所有建议之后，我的本地机器上的 BitDefender 正在这样做。所以我对这个问题的解决方法是尝试将**本地安全软件****的例外添加**到**防火墙**和它的**AV**部分。告诉它完全忽略**msvsmon** .exe 和**devenv** .exe，看看有什么不同。

 ******否则，请尝试完全撕掉它，看看它是否可以让您调试您的解决方案。

您可以在此处查看更多信息： http: [//forum.bitdefender.com/index.php?showtopic=37028](http://forum.bitdefender.com/index.php?showtopic=37028)

我安装了最新的 BitDefender 版本，一切都很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-22T17:48:19.050

在 VS 2015 中为我提供的解决方案。我有一个公共 dns 条目映射到我的本地 iis 和项目的 web/debug 选项卡：

```
<app>.<domain>.co.uk 
```

只需将其作为本地主机添加到主机文件中：

```
127.0.0.1 <app>.<domain>.co.uk 
```

因此 VS 不再认为主机是远程机器。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-06-20T17:41:20.637

这个问题的解决方法是：

导航到 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Remote Debugger 打开 x64 文件夹并将 msvsmon.exe 文件重命名为 msvsmon_old.exe 现在，导航到 x86 文件夹并复制 msvsmon.exe 并粘贴它进入 x64 文件夹。重新启动 Visusl Studio 2012 IDE，现在尝试在调试期间附加到进程

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-04-10T13:31:14.227

对我有用的是卸载一个名为“sendori”的程序******

# javascript - 无法解释的 JavaScript 行为 - 错误？

> ID：12252974
> 
> 赞同：0
> 
> 时间：2012-09-03T19:14:17.723
> 
> 标签：javascript, jquery, asp.net, razor, asp.net-mvc-4

如果我将其复制并粘贴到我的网页中：

```
<script>
    $(function(){
        $("#startDate").datepicker();
    });​​​
</script> 
```

我在浏览器中收到此错误：

`Uncaught SyntaxError: Unexpected token ILLEGAL`

但是，**使用完全相同的代码**，如果我只是删除最后的分号并再次添加，代码会在 VS 2012 中格式化，然后就可以工作了。为什么？我认为间距与 JavaScript 无关吗？

如果我粘贴相同的代码并自己添加间距，它仍然不起作用。我必须手动输入，或者删除并再次添加分号。这可能是一个错误吗？我错过了一些基本的东西吗？

这是页面中的完整代码：

```
@{
    Layout = null;
}

    <!DOCTYPE html>

    <html>
    <head>
        <meta name="viewport" content="width=device-width" />
        <title>Index</title>
        <script src="~/Scripts/jquery-1.7.1.min.js"></script>
        <script src="~/Scripts/jquery-ui-1.8.20.min.js"></script>
        <script>
            $(function(){
                $("#startDate").datepicker();
            });​​​
        </script>
    </head>
    <body>
        <div>
            <h2>Home View</h2>
            <input type="text" id="startDate">
        </div>
    </body>
    </html> 
```

为了完整起见，这是有效的代码：

```
<script>
    $(function () {
        $("#startDate").datepicker();
    });
</script> 
```

除了间距，我看不出有什么区别。就像我说的那样，我可以拥有带有空格的*确切*代码，除非我删除并添加分号，否则它会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:18:23.783

Look at the code in your browser - hit view source - and double check that your IDE is not adding some extra codes that are breaking the javascript.

Ctrl-U in chrome to view source.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:21:02.157

分号后面有一些垃圾字符需要清理。

如果我将您在 SO 中的确切文本粘贴到 Wordpad++ 中，则会显示以下内容：

```
<script>
    $(function(){
        $("#startDate").datepicker();
    });???
</script> 
```

其中显示了一些非法字符。

# php - 我是否正确使用 OOP？

> ID：12252975
> 
> 赞同：2
> 
> 时间：2012-09-03T19:14:17.730
> 
> 标签：php, oop, singleton

7 个月以来，我一直在开发一个用 PHP 和 MySQL 编写的 PBBG（游戏）。该项目即将完成，可能很快就会发布，但我担心一些问题。

这是我第一次编写真正的项目，也是我第一次使用 OOP。我的代码现在有大约 25k 行，这是我的问题：

我是否正确使用 OOP？我相信我过度调用类构造。我有大约 20 个不同的班级，有时他们需要彼此。这是我如何使用 OOP 的示例代码：（只是一个草图，可能不起作用）

```
class A {

    public $b;
    public $c;

    public function __construct(){
        $b = new B();
        $c = new C();
    }

    public function sampleA(){
        //some stuff that depends $c->sampleC
    }

}

class B { 

    public $c;

    public function __construct(){
        $c = new C();
    }

    public function sampleB($id){
        return $this->c->sampleC($id);
    }

}

class C {

    public function sampleC(){

    }

} 
```

然后我会使用：

```
$a = new A();
$b = new B();
$c = new C();

$whatIWant = $a->sampleA($b->sampleB($c->sampleC())); 
```

虽然我可以

```
$a = new A();
$whatIWant = $a->sampleA($a->b->sampleB($a->c->sampleC())); 
```

在这个简单的示例中，这看起来没有必要，但我的脚本中有 200 多个不同的构造函数调用，我想这会减慢并超载我的服务器。

也许我的例子不是很清楚，所以我打印了我的 xdebug 分析器结果：

[![打印](../Images/ff63e63fadcf2ae91e9833459865cb6e.png)](https://i.stack.imgur.com/rLWjl.jpg)

我需要单身吗？我尝试在单例中使用这样的简单示例，但我得到了相同的结果（每个类超过 1 个构造）。
也许我需要扩展这些类并使用父类的构造函数？但是 20 个不同的类，有时是独立的，有时是相互依赖的，这怎么可能呢？
或者也许我以正确的方式使用它（我不这么认为）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:23:24.973

我不会那样做的。我会这样做的方式是使用依赖注入。我已将类中的实例设置为`protected`（或将它们设置为`private`）。无需将它们设为公开。如果你认为你需要你几乎肯定违反了一些规则，你需要重新考虑你的设计。

我改变的另一件事是你做了`$b = new B()`。这有两个问题：

1.  我想你打算这样做`$this->b = new B()`
2.  您正在将该`B`类与另一个类紧密耦合。

这使得无法进行任何单元测试，因为您不能`B`用模拟类替换该类。因此，不是测试单元（类），而是测试多个类。

我做的另一件事是类型提示构造函数参数。当您有类的接口时，这将更加有用。这也使得测试类变得更加容易。另请参阅[此相关答案](https://stackoverflow.com/questions/11923272/use-global-variables-in-a-class/11923384#11923384)。

您可能感兴趣的一些视频：[依赖注入](http://misko.hevery.com/2008/11/11/clean-code-talks-dependency-injection/)、[单元测试](http://www.youtube.com/watch?v=wEhu57pih5w)、[继承、多态性和测试](http://www.youtube.com/watch?v=4F72VULWFvc)。您可能还想阅读一些关于[SOLID 编程](http://en.wikipedia.org/wiki/SOLID_(object-oriented_design))的内容。您的代码似乎也违反了[LoD](http://en.wikipedia.org/wiki/Law_of_Demeter)，这意味着您正试图通过其他对象访问内容。

这样的事情是我会做的：

```
class A
{
    protected $b;
    protected $c;

    public function __construct(B $b, C $c)
    {
        $this->b = $b;
        $this->c = $c;
    }

    public function sampleA()
    {
        $this->c->sampleC();
    }
}

class B
{     
    protected $c;

    public function __construct(C $c)
    {
        $this->c = $c;
    }

    public function sampleB($id)
    {
        return $this->c->sampleC($id);
    }
}

class C
{    
    public function sampleC() { }
}

$b = new B();
$c = new C($b);
$a = new A($b, $c);

$whatIWant = $a->sampleA(); 
```

如果你想编写正确的 OOP 代码，你永远不应该（恕我直言）使用 signleton 反模式。基本上它只是另一个名称（具有相同的特征）作为`global`.

> 也许我需要扩展这些类并使用父类的构造函数？但是 20 个不同的类，有时是独立的，有时是相互依赖的，这怎么可能呢？

只有当子类可以替代父类时，您才应该扩展类。这在 SOLID中称为[Liskov 替换原则。](http://en.wikipedia.org/wiki/Liskov_substitution_principle)换句话说，您必须能够说`class child`is a `class parent`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:21:42.480

您需要的是结合依赖注入的控制反转模式。

使用这些模式，您可以使您的类保持松散耦合，并强制每个类都使用正确的类和参数构造。

大多数优秀的 PHP 框架都有 IoC 和 DI 实现。查看 Symphony 的本[教程](http://fabien.potencier.org/article/12/do-you-need-a-dependency-injection-container)。

# magento - 安装 Magento 模块时无法解决主机“magento-community”错误

> ID：12252980
> 
> 赞同：8
> 
> 时间：2012-09-03T19:14:46.487
> 
> 标签：magento

我尝试使用安装 Module Creator`magento-community/Netz98_ModuleCreator`并收到`Couldn't resolve host 'magento-community'`错误消息。

然后我使用一个[网站](http://freegento.com/ddl-magento-extension.php)下载扩展并以这种方式安装它，我得到这个文件的这个错误`Netz98_ModuleCreator-1.0.0.tgz`。

> CONNECT ERROR: Package file is invalid
> Invalid version, should be like: xxx
> Invalid stability Invalid channel URL
> Empty authors section Empty package contents section

请帮忙！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-03T20:45:54.393

从 Magento 1.5.0 开始，您应该使用 Magento Connect 2.0 扩展密钥。

这个扩展的开发者创建了它只与 Magento 1.3 兼容。您可以下载扩展包（*.tgz 存档*），将其解压缩并手动将文件放入您的 Magento 实例中。用于`package.xml`确定文件位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T07:16:27.523

Magento 模块创建者安装说明：

1）登录到magento的管理面板

2）转到系统-> Magento Connect-> Magento Connect Mmanager

3）转到设置->首选状态：->将稳定版更改为测试版

4）转到扩展->安装新扩展->使用此密钥： -http: [//connect20.magentocommerce.com/community/Netz98_ModuleCreator-](http://connect20.magentocommerce.com/community/Netz98_ModuleCreator-) >单击安装->单击准备安装

5）成功安装后，转到您喜欢的文件管理器转到路径：app/code/core/mage/captcha/model/observer.php

和改变

```
public function checkUserLoginBackend($observer)
{
$formId = 'backend_login';
        $captchaModel = Mage::helper('captcha')->getCaptcha($formId);
        $loginParams = Mage::app()->getRequest()->getPost('login');
        $login = array_key_exists('username', $loginParams) ? $loginParams['username'] : null;
        if ($captchaModel->isRequired($login)) {
            if (!$captchaModel->isCorrect($this->_getCaptchaString(Mage::app()->getRequest(), $formId))) {
                $captchaModel->logAttempt($login);
                Mage::throwException(Mage::helper('captcha')->__('Incorrect CAPTCHA.'));
            }
        }
        $captchaModel->logAttempt($login);
        return $this;
    } 
```

到

```
public function checkUserLoginBackend($observer)
    {
        $formId = 'backend_login';
        $captchaModel = Mage::helper('captcha')->getCaptcha($formId);

        $login = Mage::app()->getRequest()->getPost('username');
        if ($captchaModel->isRequired($login)) {
            if (!$captchaModel->isCorrect($this->_getCaptchaString(Mage::app()->getRequest(), $formId))) {
                $captchaModel->logAttempt($login);
                Mage::throwException(Mage::helper('captcha')->__('Incorrect CAPTCHA.'));
            }
        }
        $captchaModel->logAttempt($login);
        return $this;
    } 
```

6) 如果您使用的是 linux/unix

转到终端->转到magento项目文件夹->输入chmod 777 -R /var/www/your-project-folder/

7）在浏览器中打开您的网址并在其后添加/moduleCreator

8) 完成。您现在应该可以创建模块了。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-20T11:52:14.993

解决这个问题非常简单，但有时需要时间。这就是为什么我在这里提供一个简单的解决方案，以便它可以为社区工作。

如果您想使用连接管理器安装扩展程序，例如`"community/Test_Extension"`.

你必须这样写：`http://connect20.magentocommerce.com/community/Test_Extension`

但是，当您尝试使用此密钥进行安装时`community/Test_Extension`，它会让您无法解决主机名问题。

# javascript - 使用 js 将动态内容添加到选择选项列表

> ID：12252982
> 
> 赞同：1
> 
> 时间：2012-09-03T19:15:29.383
> 
> 标签：javascript, html, internet-explorer, appendchild

我在 html 页面上有两种下拉`select`输入类型。

第一个选择下拉菜单的内容如图所示。第二个选择最初是空的。

```
<select id="box1" name="box1">
    <option selected="selected" value="">--Select-One--</option>
    <option value="Apple"> Apple </option>
    <option value="Orange"> Orange </option>
</select> 
```

我添加了一个 js 函数，它被称为`onchange`第一个`select`盒子并更新了第二个`select`（即 box2）

```
var select1 = document.getElementById("box1");
select1.onchange = function() {
    var select2 = document.getElementById("box");
    while (select2.firstChild) {
        select2.removeChild(select2.firstChild);
    }
    for ( var i = 1; i < select1.options.length; i++) {
        if (select1.selectedIndex == i)
            continue;
        var o = document.createElement("option");
        o.value = select1.options[i].value;
        // o.selected = "selected";
        o.text = select1.options[i].text;
        select2.appendChild(o);
        alert("Here " + i);
    }
} 
```

这在 chrome 和 firefox 中运行良好，但在 IE 中不行。我想这可能是`appendChild`导致 IE 出现问题的原因。

请任何提示来解决这个可能针对不同版本的 IE？

### 笔记：

1.  在 IE 9 上测试。
2.  已经检查了有关相同错误的其他问题，但其中大多数都与表格行有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T19:34:45.553

如果跨浏览器功能是必须的，我建议您使用 jQuery 之类的 Javascript 库，在 jQuery 中您可以执行以下操作：

```
jQuery("#selectId").append('<option value="' + text + '">' + text + '</option>'); 
```

# python - 过滤 django-reversion 返回的结果

> ID：12252984
> 
> 赞同：1
> 
> 时间：2012-09-03T19:15:42.597
> 
> 标签：python, django, django-reversion

刚开始使用[django-reversion和](https://github.com/etianen/django-reversion)[django 教程](https://docs.djangoproject.com/en/dev/intro/tutorial01/)中的 Polls 应用程序。为了让它工作，我所做的就是`mysite/polls/admin.py`使用以下代码创建：

```
from django.contrib import admin
from polls.models import Poll
import reversion
#admin.site.register(Poll)
class PollAdmin(reversion.VersionAdmin):
    pass
admin.site.register(Poll, PollAdmin) 
```

换句话说，我只完成了管理员集成。在 Poll 模型中，我添加了一个名为`approved`.

`one_object = Poll.objects.all()[1]`
`version_list = reversion.get_unique_for_object(one_object)`

以上`version_list`包含所有版本的`one_object`. 我只想获得所有具有`approved==True`. 然后，我希望查看结果，以便仅显示已批准的民意调查。我该如何过滤这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:35:16.940

每个版本对象都有一个`field_dict`包含该版本对象字段值的属性。因此，您可以按如下方式过滤列表：

```
filtered_versions = [v for v in version_list if v.field_dict["approved"] ==  True] 
```

# c++ - 让主程序知道资源在哪里（图像、数据……）

> ID：12252985
> 
> 赞同：1
> 
> 时间：2012-09-03T19:15:49.510
> 
> 标签：c++, installation, cross-platform, c-preprocessor

我目前正在构建一个 C++ 跨平台游戏。

经过一堆谷歌搜索和阅读各种开源程序的代码，我仍然无法弄清楚如何在编译时将绝对路径传递给安装目录。

我的想法是为资源设置一个“根”路径，允许我访问子目录，例如保存/加载数据、图像等......

我目前有一个典型的开源项目组织：

*   bin/（二进制文件）
*   包含/（头文件）
*   src/（来源）
*   供应商/（外部库）
*   资源/（图像、数据等...）
*   测试/（测试程序）

但是我怎样才能实现这个呢？使用预处理器传递宏（安装路径）可能吗？

这是一个好习惯还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T19:20:16.690

> 我仍然不知道如何在编译时将绝对路径传递给安装目录

您不可能在编译期间事先知道它。你不需要。使用相对路径，我看不出你为什么不使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T19:34:14.480

您需要以平台相关的方式找出安装路径。没有便携的方式。

基本上：

*   在 Windows 上，使用 GetModuleFileNameW()
*   在 MacOS 上；使用 [[NSBundle mainBundle] bundlePath] （IIRC，CFBundle 最终要复杂得多。
*   在 Linux 上， readlink() 你的 /proc/<pid>/exe 链接，希望你没有通过硬链接启动。或者只是硬编码路径，如果你是通过包管理器安装的话。

# c# - 将 Web 服务身份验证信息放入 SOAP 标头和将其作为参数传递之间有区别吗？

> ID：12252989
> 
> 赞同：1
> 
> 时间：2012-09-03T19:15:59.740
> 
> 标签：c#, visual-studio-2010, web-services

我有一个客户端-服务器程序，它使用套接字以有状态的方式传输信息。我的意思是，连接是持久的，并且使用嵌入软件本身的公钥和私钥进行身份验证。它运行良好且非常高效，但我建立的整体框架使添加任何新内容成为一个漫长的过程，因此我想转向 Web 服务。在某个时候，我将获得证书并使用 SSL，但现在我只是担心确保用户经过身份验证以执行他们想做的事情。

原始模式让用户在开始时输入他们的用户名和密码，服务器只记住他们在连接期间的身份。现在我正在转向无状态 Web 服务，我可能不得不在每次请求时都交出这些信息。我对网络服务相当陌生，在网上做了一些搜索，发现了两个关于如何做到这一点的建议。一种只是在每个函数调用中发送一个身份验证对象，另一种是将用户名和密码信息粘贴在 SOAP 标头中。我有点困惑哪种方法会更好，因为无论哪种方式，您仍然只是在服务器端进行字符串比较（好吧，在密码的情况下，哈希然后比较）。

此外，虽然它的客户端是一个 WPF 应用程序，但将来我想制作一个支持浏览器的版本。我对如何做到这一点的决定会影响未来的网络工作吗？想法！

编辑：我应该提到有几个级别的访问权限。较低级别只能访问某些功能，而最高级别可以访问所有功能。我认为这是我必须在函数本身中验证的东西，但如果有内置的方法可以更轻松地处理这个问题，我会全力以赴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T19:22:01.517

您应该选择来自 WS-Security 的标准实现，这意味着在消息正文之外传递身份验证数据。这是合理的，因为安全和消息内容代表了两个不应该混为一谈的独立问题。您应该能够简单地将一个安全选项换成另一个，而无需更改消息结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:23:32.153

SOAP Header 身份验证是与 Web 服务一起使用的适当方法，而不是使用它提供的标准化方法的功能。

# objective-c - What happens when application:openFile returns NO instead of YES in my NSApplicationDelegate?

> ID：12252991
> 
> 赞同：4
> 
> 时间：2012-09-03T19:16:17.353
> 
> 标签：objective-c, macos, cocoa, nsapplication-delegate

I'm learning some Objective-C/Cocoa and started to read up on handling `open document` events. Seems like the standard way is just via implementing `application:openFile` or `application:openFiles` in your NSApplicationDelegate.

So here's my little handler:

```
- (BOOL)application:(NSApplication *)sender openFile:(NSString *)filename {
    NSLog(@"Got open file! filename: %@", filename);
    return NO;
} 
```

My question is: what does the boolean return value affect? This is not a document-based app, if that matters. I can see no discernible difference between returning `YES` or `NO`. [Apple's docs](http://developer.apple.com/library/mac/documentation/cocoa/reference/NSApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40008592-CH1-SW37) aren't any help--obviously you return YES or NO to signal whether you successfully handled the open file event or not, but what are the actual consequences of these two outcomes?

I'm also not familiar enough with the framework to glean any knowledge from stepping through the call stack with the debugger.

To test my app I'm running it from Xcode (not handling cold start yet) then running it `$ open -a MyApp somefile.txt` commands in terminal as well as doing a File > Open With in Finder and choosing my app.

Related question, but about a different problem (unanswered): [Very slow to open a file with application:openFile: after returning](https://stackoverflow.com/questions/12225060/very-slow-to-open-a-file-with-applicationopenfile-after-returning)