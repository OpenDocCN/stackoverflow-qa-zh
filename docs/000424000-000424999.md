# StackOverflow 问答 000424000-000424999

# c# - StringDictionary 不保存为用户设置

> ID：424010
> 
> 赞同：8
> 
> 时间：2009-01-08T11:54:40.950
> 
> 标签：c#, .net

我创建了一个类型为“System.Collections.Specialized.StringDictionary”的用户范围设置。每当我打开本地设置时，我都可以在配置中看到它，但它是空的。

我有其他正确保存的用户设置，但是这本字典似乎根本没有保存。

为了保存字典，我需要做些什么吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T12:02:27.047

问题是它`Dictionary`不会序列化为 XML（即使它确实应该）。你有两个选择。您可以为字典指定自己的序列化方法，也可以作弊。

如果您不关心能够读取/编辑 XML 中的值，则可以将`[SettingSerializeAs(SettingsSerializeAs.Binary)]`属性添加到设置中。完成工作，但这是一种快速而肮脏的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T12:52:49.210

我不知道`StringDictionary`在设置中使用的任何特定问题或解决方法，但也许可以回避问题并只使用字符串？您可以将数据序列化为 xml，或者（也许更简单）只是一个键/值分隔的字符串？请注意，它`DbConnectionStringBuilder`提供了一种简单的方法（如下所示）。

标记化的字符串是“abc=def;ghi=jkl”，但对于更复杂的数据，它会自动处理转义规则等。值得一试？

```
using System;
using System.Collections.Specialized;
using System.Data.Common;
public static class Program
{
    static void Main()
    {
        StringDictionary lookup = new StringDictionary();
        lookup.Add("abc", "def");
        lookup.Add("ghi", "jkl");

        string foo = Serialize(lookup);
        Console.WriteLine(foo);

        StringDictionary bar = Deserialize(foo);
        foreach (string key in bar.Keys)
        {
            Console.WriteLine("{0}={1}", key, bar[key]);
        }
    }
    public static string Serialize(StringDictionary data)
    {
        if(data == null) return null; // GIGO
        DbConnectionStringBuilder db = new DbConnectionStringBuilder();
        foreach (string key in data.Keys)
        {
            db[key] = data[key];
        }
        return db.ConnectionString;
    }
    public static StringDictionary Deserialize(string data)
    {
        if (data == null) return null; // GIGO
        DbConnectionStringBuilder db = new DbConnectionStringBuilder();
        StringDictionary lookup = new StringDictionary();
        db.ConnectionString = data;
        foreach (string key in db.Keys)
        {
            lookup[key] = Convert.ToString(db[key]);
        }
        return lookup;
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T13:54:38.523

字典没有保存，因为没有实现 XmlSerializable。我不确定，但在我看来。

# gcc - LLVM vs GCC MIPS 代码生成，有什么基准吗？

> ID：424013
> 
> 赞同：7
> 
> 时间：2009-01-08T11:55:21.290
> 
> 标签：gcc, assembly, benchmarking, mips, llvm

我很想知道 MIPS 代码、GCC 或 LLVM 的“最佳”免费/OSS 编译器是什么，或者有什么比这些更好的吗？

我有兴趣了解更多关于快速和内存受限生成的汇编代码而不是代码大小的信息。

换句话说，llvm-opt 是否比 gcc -O3 做得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-26T20:11:51.917

[http://www.phoronix.com/scan.php?page=news_item&px=OTI1MA](http://www.phoronix.com/scan.php?page=news_item&px=OTI1MA) “LLVM 2.9 Release Candidate 2 在这里

Michael Larabel 于 2011 年 3 月 25 日发表，由于缺乏硬件，没有 LLVM ARM 基准测试......”

也许具有快速双臂/四臂皮质和 LLVM ARM 等的人可以在周一之前运行[http://openbenchmarking.org/](http://openbenchmarking.org/) bench，Michael 可以将这些添加到他的其他结果中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T19:29:32.780

我不知道 mips，我尝试了 ARM，llvm 代码比当前的 gcc 慢了大约 10-20%。有问题的测试是基于 zlib 的。自身解压，压缩后解压。同时使用了 clang 和 llvm-gcc。我更喜欢 clang，因为 -m32 实际上适用于 64 位主机。对于有问题的测试，我发现不使用 -O2（或 -O3）产生最快的代码。将字节码模块链接到一个大模块中，并使用标准优化执行一次选择，以获得最快的代码。llc 默认为 -O2，这确实有助于提高性能。

编辑：

gcc 和 llvm/clang 之间对 mips 的有趣测试。

```
void dummy ( unsigned int );
void dowait ( void )
{
    unsigned int ra;
    for(ra=0x80000;ra;ra--) dummy(ra);
} 
```

gcc 制作：

```
9d006034 <dowait>:
9d006034:   27bdffe8    addiu   sp,sp,-24
9d006038:   afb00010    sw  s0,16(sp)
9d00603c:   afbf0014    sw  ra,20(sp)
9d006040:   3c100008    lui s0,0x8
9d006044:   02002021    move    a0,s0
9d006048:   0f40180a    jal 9d006028 <dummy>
9d00604c:   2610ffff    addiu   s0,s0,-1
9d006050:   1600fffd    bnez    s0,9d006048 <dowait+0x14>
9d006054:   02002021    move    a0,s0
9d006058:   8fbf0014    lw  ra,20(sp)
9d00605c:   8fb00010    lw  s0,16(sp)
9d006060:   03e00008    jr  ra
9d006064:   27bd0018    addiu   sp,sp,24 
```

和 llvm 组装后

```
9d006034 <dowait>:
9d006034:   27bdffe8    addiu   sp,sp,-24
9d006038:   afbf0014    sw  ra,20(sp)
9d00603c:   afb00010    sw  s0,16(sp)
9d006040:   3c020008    lui v0,0x8
9d006044:   34440000    ori a0,v0,0x0
9d006048:   2490ffff    addiu   s0,a0,-1
9d00604c:   0f40180a    jal 9d006028 <dummy>
9d006050:   00000000    nop
9d006054:   00102021    addu    a0,zero,s0
9d006058:   1600fffb    bnez    s0,9d006048 <dowait+0x14>
9d00605c:   00000000    nop
9d006060:   8fb00010    lw  s0,16(sp)
9d006064:   8fbf0014    lw  ra,20(sp)
9d006068:   27bd0018    addiu   sp,sp,24
9d00606c:   03e00008    jr  ra
9d006070:   00000000    nop 
```

我在组装后说是因为我看到了 gnu-as do things like this

```
.globl PUT32
PUT32:
    sw $a1,0($a0)
    jr $ra
    nop 
```

并为我重新安排组装：

```
9d00601c <PUT32>:
9d00601c:   03e00008    jr  ra
9d006020:   ac850000    sw  a1,0(a0)
9d006024:   00000000    nop 
```

llvm 和 gcc 生成的代码之间的区别在于将指令放置在分支延迟槽中。我使用 clang 和 llc 生成程序集输出，然后使用 binutils、gnu as 创建二进制文件。因此，对于我的手工组装代码来说，这是一种好奇心：

```
ori $sp,$sp,0x2000
jal notmain
nop 
```

它为我优化：

```
9d006004:   0f401820    jal 9d006080 <notmain>
9d006008:   37bd2000    ori sp,sp,0x2000
9d00600c:   00000000    nop 
```

但是 llc 生成的代码

```
addiu   $16, $4, -1
jal dummy
nop 
```

不是

```
9d006048:   2490ffff    addiu   s0,a0,-1
9d00604c:   0f40180a    jal 9d006028 <dummy>
9d006050:   00000000    nop 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T15:06:22.343

LLVM 在 x86 上通常比 GCC 好，但我还没有找到任何 MIPS 基准。因为您在问这个问题，所以我假设您可以访问 MIPS 机器，那么您为什么不使用 GCC 和 LLVM 编译[计算机语言基准游戏 C 代码](http://shootout.alioth.debian.org/u32q/c.php)，看看哪个更快。我猜 GCC 会是，因为 MIPS 后端相对较新，但代码更干净，我希望 LLVM 最终获胜。

# wpf - 为什么我的 WPF Treeview 绑定到 LinqToSql 类会占用内存？

> ID：424016
> 
> 赞同：0
> 
> 时间：2009-01-08T11:57:08.963
> 
> 标签：wpf, linq-to-sql, treeview, profiling

我有一个 WPF 应用程序，它在内存不足后停止运行......
它基本上是一个显示节点的 TreeView，它们是 Linq To Sql 或生成的类 ICTemplates.Segment 的实例。在 OR 设计器中，大约有 20 个表通过关联间接链接到该类。

```
<TreeView Grid.Column="0" x:Name="tvwSegments" 
                      ItemsSource="{Binding}" 
                      SelectedItemChanged="OnNewSegmentSelected"/>
<HierarchicalDataTemplate DataType="{x:Type local:Segment}" ItemsSource="{Binding Path=Children}"> 
...

// code behind, set the data context based on user-input (Site, Id)
KeeperOfControls.DataContext = from segment in tblSegments
   where segment.site == iTemplateSite && segment.id == iTemplateSid
   select segment; 
```

我在段类中添加了一个名为 Children 的显式属性，该类使用父子记录查找另一个表。

```
public IEnumerable<Segment> Children
{
  get
  {
    System1ConfigDataContext dc = new System1ConfigDataContext();
    return from link in this.ChildLinks
      join segment in dc.Segments on new { Site = link.ChildSite, ID = link.ChildSID } equals new { Site = segment.site, ID = segment.id }
      select segment;
  }
} 
```

其余部分是数据绑定和数据模板，以将每个 Segment 显示为一组 UI 控件。

我很确定孩子正在按响应时间按需加载（当我扩展父级时）。当我扩展一个包含大约**70**个子节点的节点时，加载子节点需要一段时间（任务管理器显示 Mem Usage 为 1000000K！）。如果我用大约 50 个子节点扩展下一个节点，BOOM！内存不足异常

我运行 VS Profiler 进行更深入的挖掘，结果如下

[摘要页面](http://picasaweb.google.com/lh/photo/mfh-GTeeAcOAJOqOfHQ9eg?feat=directlink) [对象生命周期](http://picasaweb.google.com/lh/photo/YRT7jirnf7LRP1OLG1y3uA?feat=directlink) [分配](http://picasaweb.google.com/lh/photo/s20N3uYqwV6Qmp6oLFUccA?feat=directlink)

前 3 名是 Action、DeferredSourceFactory.DeferredSource 和 EntitySet（所有 .Net/LINQ 类）。唯一的用户类是 Segment[] 和 Segment 在 #9 和 #10。

我想不出要追求的线索.. 可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T07:40:42.363

也许是围绕那个 DataContext 的使用？

```
using(System1ConfigDataContext dc = new System1ConfigDataContext()){
  .... ?
} 
```

另外，您是否尝试过使用[sql profiler](http://sqlprofiler.googlepages.com/)？可能会对此事有所启发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T21:37:19.557

您是否尝试过为每个元素使用全局 DataContext 而不是一个？

使用自己的查询和结果创建所有 DataContext 可能是导致内存膨胀的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T07:34:42.750

我不知道确切的解决方案，但 join 中的新语句可能会导致这种情况。因为对于每个关系都可以创建一个新对象（但正如我所提到的，我不知道它是否正确）。

你能试试这个吗？

```
public IEnumerable<Segment> Children
{
  get
  {
    System1ConfigDataContext dc = new System1ConfigDataContext();
    return from link in this.ChildLinks
      join segment in dc.Segments on link.ChildSite == segment.site && link.ChildSID == segment.id
      select segment;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T10:51:48.657

**问题似乎是 Sirocco 提到的多个 S1DataContext 对象**的**创建**。我尝试了 using 语句来强制 Dispose 并使其符合收集条件。但是，它导致了我无法理解的 ObjectDisposedException。

1.  该控件来自设置 DockPanel KeeperOfAllControls 的数据上下文的行。
2.  [外部代码]（显示在调用堆栈中）
3.  Segment.Children.get（有一个带 dc 的 using 块）
4.  回到步骤 1 中的行... ![ObjectDisposedException](https://lh5.ggpht.com/_nxgDpneh8yk/SWcoD-KGmWI/AAAAAAAAAis/gs6kgdWuvIA/s800/Using_ObjectDisposedException.jpg)Linq 查询使用从 S1DataContext 的本地实例检索的 tblSegments

无论如何，所以我假设有一些东西阻止创建和处置多个 DataContexts。所以**我尝试了 Singleton DataContext**。
它有效！

*   TreeView 控件的响应速度明显更快，我尝试的每个节点最多在 3-4 秒内加载。
*   我在每次获取/搜索之前放入了一个 GC.Collect（用于验证），现在内存使用量保持在 200,000-300,000K 之间。

OR 生成的 System.Data.Linq.DataContext 似乎不会消失，除非它被显式处理（吃内存）。尝试在我的情况下处理它，并没有成功..即使两个函数都有自己的 using 块（没有 DataContext 的共享实例）。虽然我不喜欢 Singletons，但我正在为开发人员制作一个小型内部工具，因此现在不介意它。我在网上看到的 LinqToSql 示例都没有强制要求 Dispose 调用。

所以我想问题已经解决了。感谢所有充当更多眼球以使这个错误变浅的人。

# .net - 在 log4net 中使用 uniqueidentifiers/guids 作为自定义属性

> ID：424018
> 
> 赞同：9
> 
> 时间：2009-01-08T11:57:20.867
> 
> 标签：.net, log4net, uniqueidentifier

我正在尝试添加一个自定义属性，它是一个 guid，但它给了我这个错误：

> System.InvalidCastException：无法将参数值从字符串转换为 Guid。---> System.InvalidCastException：从“System.String”到“System.Guid”的无效转换。

我在配置中指定：

```
<parameter>
<parameterName value="@id" />
<dbType value="Guid" />
<layout type="log4net.Layout.PatternLayout">
<conversionPattern value="%X{id}" />
</layout>
</parameter> 
```

我使用的实际代码（片段）是这样的：

```
 Guid guid = Guid.NewGuid();
        if (defaultLogger.IsEnabledFor(level))
        {
            var loggingEvent = new LoggingEvent(ThisDeclaringType,
 defaultLogger.Repository, defaultLogger.Name, level, message, exception);
            loggingEvent.Properties["Id"] = guid; 
```

请问有什么帮助吗？:) 数据库中的 id 字段被定义为唯一标识符 NOT NULL，但它没有主键约束。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-08T13:12:52.913

对于您的示例，以下内容应该有效：

```
<parameter>
<parameterName value="@Oid" />
<dbType value="Guid" />
<layout type="log4net.Layout.RawPropertyLayout">
<key value="Id" />
</layout>
</parameter> 
```

重要的是您将@id 重命名为其他名称，否则即使您尝试插入字符串，您也会在数据库中获得 Null 值，

然后使用 RawPropertyLayout 来存储，因为你不需要做转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T09:16:02.983

**1.**下载log4.net源代码

**2.**`FormatValue`像这样改变文件里面的函数`log4net.Appender.AdoNetAppender.cs`：

```
virtual public void FormatValue(IDbCommand command, LoggingEvent loggingEvent)
        {
            // Lookup the parameter
            IDbDataParameter param = (IDbDataParameter)command.Parameters[m_parameterName];

            // Format the value
            object formattedValue = Layout.Format(loggingEvent);

            // If the value is null then convert to a DBNull
            if (formattedValue == null)
            {
                formattedValue = DBNull.Value;
            }

            if (param.DbType == System.Data.DbType.Guid)
            {
                param.Value = new Guid(formattedValue.ToString());
            }
            else
            {
                param.Value = formattedValue;
            }
        } 
```

那么它的工作原理！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-06T18:23:38.453

如果要获取通用 GUID 属性，可以执行以下操作：

```
 private void ConfigureLog4Net()
    {
        // adds a global custom log4net property
        log4net.GlobalContext.Properties[nameof(Guid.NewGuid)] = new NewGuidWrapper();

        // configures log4net by XML configurations from a .config file
        log4net.Config.XmlConfigurator.Configure();
    }

    private class NewGuidWrapper
    {
        // will return new GUID every time it's called
        public override string ToString() => Guid.NewGuid().ToString();
    } 
```

然后您可以通过以下方式调用该属性：

```
<layout type="log4net.Layout.PatternLayout">
  <!-- if you want to format the layout as a GUID followed by a message  -->
  <conversionPattern value="%property{NewGuid} %m%n" />
</layout> 
```

您还可以将这种类型的布局用于自定义 DB 参数，如此[处](https://stackoverflow.com/a/12140226/9093605)所述。

# javascript - 分组正则表达式反向引用

> ID：424020
> 
> 赞同：0
> 
> 时间：2009-01-08T11:57:40.490
> 
> 标签：javascript, html, regex

我有以下正则表达式

```
id=(.*?) | id="(.*?)" 
```

这样做的原因是我正在尝试使用 JavaScript 从浏览器 DOM 中替换 Id。IE，但是从元素属性中去除引号，因为它似乎在 DOM 中不需要它们

我遇到的问题是每个备用语句的反向引用都在不同的组（$1 和 $2）中，因为匹配只有一个或另一个我可以将两个反向引用作为单个反向引用返回吗？

编辑：

```
<div id="test1" /><div id=test2 /> 
```

将匹配如下

```
 match         |  $1   |   $2
--------------------------------
    id="test1"    | test1 |
    id=test2      |       |  test2 
```

我只想将两个反向引用都添加到 $1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T12:01:52.197

关于什么：

```
id="?(.*?)"? 
```

*（可能 . 应该是 [^"] - 我没有测试它）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T12:10:12.057

```
id="?([\w-]*)"? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T13:58:11.473

我会用

```
id\s*=\s*("[^"]*"|'[^']*'|[^\s>]*) 
```

这将匹配

```
id="foo"
id='bar'
id=baz 
```

但是要仅检索属性值，如果它被引号包围，则必须在开头/结尾处去掉`"`or 。`'`

# c - 对于小型设备，Hans Boehm GC 有哪些替代品？

> ID：424022
> 
> 赞同：12
> 
> 时间：2009-01-08T11:59:10.737
> 
> 标签：c, garbage-collection, neko

我想在小型设备中使用像 NekoVM 这样的虚拟机，但要构建它，它需要 Boehm GC，但是该小型设备没有该 GC 的端口，所以我想知道是否有任何替代方案可以只用 C 代码完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T08:24:39.320

我会说您最好的选择是将 GC 移植到您的平台，其中有说明（[libgc 移植说明](http://www.hboehm.info/gc/porting.html)）。

此外，应该可以换出 GC 实现（[NekoVM FAQ](http://nekovm.org/faq)），请参阅 vm/alloc.c 文件。

**编辑**：

希望有用的附加链接：（未经测试）

*   [Smieciuch 垃圾收集器](http://smieciuch.sourceforge.net/)
*   [libgcroots](http://freshmeat.net/projects/libgcroots/)（基于 libgc 7，抽象架构相关位）
*   [松鼠编程语言](http://squirrel-lang.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:34:31.913

也许你最好使用[Lua](http://www.lua.org/)，它有一个非常小但功能强大的虚拟机，内置了自己的垃圾收集器，并且可以在任何支持 ANSI 标准 C 的平台上运行。只需一点点努力，你甚至可以在其上构建 Lua缺少标准输入和标准输出的机器。我见过 Lua 在嵌入式设备上运行，该设备是一个[小型 LCD 触摸屏，背面有一个嵌入式 CPU](http://www.ezlcd.com/)。Neko 是好作品，但我认为你会发现 Lua 一样令人满意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-20T16:59:25.420

我可以建议 TinyGC (tinygc.sf.net) - 针对小型设备的 BoehmGC 的独立轻量级实现。它与 BoehmGC v7+ 完全 API 兼容（甚至更多，二进制兼容），但只实现了 API 的一小部分（但足以用于类似 Java/GCJ 的内存管理），并且没有自动线程和静态数据根注册。然而，后者可能需要一些努力才能使 NekoVM 与它一起工作（即调用 GC_register_my_thread() 和 GC_add_roots()）。

# struts2 - Dojo Struts 2.0.12

> ID：424025
> 
> 赞同：0
> 
> 时间：2009-01-08T11:59:39.957
> 
> 标签：struts2, dojo

在我的 struts 2.0.12 应用程序中，我正在尝试使用 s:datetimepicker 但它不会呈现。

Firebug 错误：dojo 未在 dojo.require("dojo.widget.DatePicker") 上定义；

我的jsp页面

```
 <%@taglib prefix="s" uri="/struts-tags" %>
 .
 .
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
   <s:head theme="ajax" debug="true"/>
 .
 .
 </head>
 <body>
 .
 .
 <s:datetimepicker name="dataInizioRicerca" label="data inizio ricerca (yyyy-MM-dd)" displayFormat="yyyy-MM-dd"/>
 .
.
</body> 
```

怎么了？我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T14:21:04.227

是的，您错过了 Ajax 标头（Ajax struts 主题）标签。

这会在页面的开头加载 Dojo Javascript 文件。

将以下内容放入您的 HTML 头部：

`<head> [..other stuff] <s:head/> <!-- Struts 2 Ajax/Dojo needed for calendar --> </head>`

顺便说一句 - 上面的帖子谈论的是 struts 2.1.x 而不是 struts 2.0.12（你正在使用的那个）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T20:18:16.227

要使用 datetimepicker，你需要使用 struts-dojo-tags，这进入了 struts 库的 de struts-dojo-plugin.jar，现在你有了标签，加载了 whit

并放入头部标签

可视化日期时间选择器....

...也许这可以帮助你....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T14:58:46.610

我知道这个帖子更新已经有一段时间了，但如果有人遇到上述问题并进行搜索，他们可能会在这里结束，以下观察可能会有用。

在将 Dojo 与 Struts 2.1 一起使用时，我遇到了类似的问题，但这归结于 struts 2 如何与 Dojo 一起使用的主要变化。可以在此处找到解决这些问题的有用资源： [从 Struts 2.0.x 迁移到 Struts 2.1.x 的故障排除指南](http://cwiki.apache.org/S2WIKI/troubleshooting-guide-migrating-from-struts-20x-to-21x.html)

如果让 Dojo 工作仍然导致问题，您可以尝试使用 Struts 2 jquery 插件，（进行搜索，因为我不允许发布 2 个超链接）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-30T18:02:59.667

需要停止使用struts dojo 标签，独立使用dojo。不再支持 struts -dojo。

# xslt - 删除重复的 xml 标头

> ID：424029
> 
> 赞同：2
> 
> 时间：2009-01-08T12:02:00.823
> 
> 标签：xslt, htmltidy

html Tidy 出于某种原因将此作为输出：

```
<?xml version="1.0" encoding="utf-16"?>
<?xml version="1.0" encoding="utf-16"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 11 February 2007), see www.w3.org" />
<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />

...rest of document 
```

所以有 2 个 xml 标头，并且类型错误（不是 UTF-8）。有没有办法删除第二个标头，将其更改为 UTF-8，并使用 XSL 删除 DOCTYPE？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T12:37:39.927

我认为解决原始问题会更好。你使用 HTML Tidy 库吗？

尝试将[output-encoding](http://tidy.sourceforge.net/docs/quickref.html#output-encoding)设置为 utf8 并将[add-xml-decl](http://tidy.sourceforge.net/docs/quickref.html#add-xml-decl)设置为 false。[可以通过将doctype](http://tidy.sourceforge.net/docs/quickref.html#doctype)属性设置为省略来抑制 DOCTYPE 节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T12:11:26.750

是的。创建一个与您要接受的第一个子元素匹配的模板，然后让它输出该元素的内容。

# c++ - Symbian C++ - 在您的应用程序中使用 TTF 字体？

> ID：424031
> 
> 赞同：2
> 
> 时间：2009-01-08T12:03:01.400
> 
> 标签：c++, fonts, symbian, truetype

是否可以在您的应用程序中打包一个 .TTF 文件并在运行时使用它来呈现文本，并让应用程序在使用后释放字体？

我在论坛上发现了一些分散的信息，但没有任何结论。

任何人都可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T14:22:17.550

上面接受的答案是错误的。您可以在 symbian 中使用 TTF*而无需*将其转换为 GRD。两年前我在旧版本的 Symbian（可能是 8 版）上做到了这一点。较新的版本可能已内置支持。无论如何，请在网上搜索 symbian (a .dll) 文件的 truetype 字体文件驱动程序。安装它，您只需将其复制到字体文件夹即可使用任何 TTF。

Symbian 对字体有很好的支持，即使是您自己构建的专有格式。只需编写一个驱动程序并安装它。Symbian 将扫描字体目录并使用每个字体文件调用每个驱动程序。哪个驱动程序可以处理字体文件扩展名响应并加载字体。

# c++ - 如何静态链接.DLL？

> ID：424032
> 
> 赞同：27
> 
> 时间：2009-01-08T12:03:21.913
> 
> 标签：c++, dll, linker, static-linking

我们有一个由 VS 构建的（纯原生 C++）.DLL。作为客户端，我们有一些本地 C++ 应用程序和一个围绕这个用 C++/CLI 编写的 DLL 的 .Net-Wrapper。最后，还有一些用 C# 编写的 .Net-Wrapper 客户端应用程序。

我的问题是 native.dll 必须以不同于 .Net 世界的方式分发，并且 VS 不会跟踪该 DLL。因此，为了让我的所有 C# 应用程序正常工作，我必须将其复制到每个可执行目录或将其放在 %PATH% 中的某个位置（我会避免在开发人员计算机上这样做，因为他们可能希望使用不同版本的 DLL 启动不同的应用程序）。如果有引用 Wrapper-DLL 的 UserControl 会出现更大的问题：您必须将 DLL 复制到 VS 的目录或再次复制到 %PATH%。但最坏的情况发生在我们的翻译工具上。该工具跟踪 .Net-Assemblies 并将它们打包到可以发送给外部翻译器的翻译器包中。据我所知，没有办法将本机 .DLL 放入该包中！

因此，我计划将本机 DLL 静态链接到 .Net-Wrapper 中，这将解决我的问题。但是对于我们的本机应用程序，这个本机 DLL 必须仍然是一个 DLL。

所以我有两个选择：

*   制作两个项目（一个生成静态库；一个创建动态库=>我尽量避免这种情况）
*   找到静态链接 DLL 的解决方案
*   找到一种方法让 VS 从一个项目中生成两个输出

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-04T20:13:56.823

在 dll 的 C++ 项目文件中，创建两个配置，一个生成 DLL，一个生成 .lib。两个项目不是必需的，因为任何 .NET/C++ 项目都可以支持多个构建配置（这就是 Release 和 Debug 版本构建不同的方式）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-10T23:16:38.503

Another option is to have two projects, one project will output a .lib which can be statically linked, and a second project which will output a .dll and will have your .lib as dependency, you should add .def to your .dll with the symbols that you are planning to export, or else it will be empty.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T12:11:48.700

拿起一份[DLL 到 Lib](http://www.binary-soft.com/dll2lib/dll2lib.htm)的副本（编辑：如果你找不到更便宜的选择）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-14T18:07:52.993

您可以使用 生成一个 dll 并将入口点导出到一个库`dllexport`，这里对此进行了解释

[http://msdn.microsoft.com/en-us/library/3y1sfaz2.aspx](http://msdn.microsoft.com/en-us/library/3y1sfaz2.aspx)

# .htaccess - .htaccess rewritecond rewrite case level 2 folder=info

> ID：424037
> 
> 赞同：1
> 
> 时间：2009-01-08T12:05:01.833
> 
> 标签：.htaccess, mod-rewrite

我想设置`.htaccess`重写：

```
example.com/bla/info/ 
```

到

```
example.com/info/index.php?q=bla

example.com/bla/info/txt/ 
```

到

```
example.com/info/index.php?q=bla&t=txt 
```

我希望浏览器仍然显示：

```
example.com/bla/info/txt/ 
```

我不想在 2 级重写中重写，例如：

```
example.com/bla/xxx/ 
```

或者

```
example.com/ccc/zzz/aaa/ 
```

但

```
example.com/silly/info/ 
```

会很好用

```
example.com/strange/info/mytxt/ 
```

这有意义吗？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T21:19:54.823

如果您的模式以 ^ 开头并以 $ 结尾，则该规则仅在整个字符串匹配时才适用。

```
RewriteRule   ^/bla/info/$      /info/index.php?q=bla
RewriteRule   ^/bla/info/txt/$  /info/index.php?q=bla&t=txt 
```

如果您使用不使用 [R] 选项，则浏览器中显示的 URL 将是用户输入的任何内容。

您是否试图使这个通用？如果是这样，您可以使用正则表达式类型匹配和变量替换。要使 'bla' 匹配直到下一个斜杠 (/) 的任何字符串，请使用

```
([^/]+) 
```

在您的模式中并在您的替换中用 $1 引用它。

```
RewriteRule ^/([^/]+)/info/$          /info/index.php?q=$1
RewriteRule ^/([^/]+)/info/([^/]+)/$  /info/index.php?q=$1&t=$2 
```

我推荐[有关 mod_rewrite 的 Apache 网页](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)以获取更多信息。

[编辑。修复了规则，不包括模式中的主机名，正如原始海报所发现的那样。]

--
bmb

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T16:01:22.190

你让我走上了正轨。

我最终得到了这样的结果：

```
RewriteRule ^([^/\.]+)/info/?$ example/info/index.php?q=$1 [L] 
```

多谢

# c# - 生产服务器上的 SQL Server 2000 间歇性连接异常 - 特定环境问题？

> ID：424040
> 
> 赞同：2
> 
> 时间：2009-01-08T12:07:13.980
> 
> 标签：c#, asp.net, sql-server-2000, windows-server-2003

我们一直遇到间歇性问题，导致用户被强制退出应用程序。

我们的设置是 Windows Server 2003 Standard Edition 上的 ASP.Net/C# Web 应用程序，后端使用 SQL Server 2000。我们最近在客户的 VMWare 服务器上进行了一次重大的产品升级（我们有一个专用于我们的来宾实例），虽然我们在之前的版本中没有遇到这些问题，但新升级给产品带来的额外复杂性导致了很多问题。我们还在同一个机器上运行 SQL Server 2000（内部版本 8.00.2039，或 SP4）和 IIS/ASP.NET (.Net v2.0.50727) 应用程序，并通过 TCP/IP 连接相互连接。

* * *

首先，抛出的异常是：

> System.IndexOutOfRangeException：找不到表 0。
> 
> System.ArgumentException：列“密码”不属于表 Table。

[这个异常出现在登录脚本中，虽然明明有密码栏可用]

> System.InvalidOperationException：已经有一个打开的 DataReader 与此命令关联，必须先关闭。

[这个经常发生]

> System.InvalidOperationException：此 SqlTransaction 已完成；它不再可用。
> 
> System.ApplicationException：ExecuteReader 需要一个打开且可用的连接。连接的当前状态是正在连接。
> 
> System.Data.SqlClient.SqlException：超时已过期。在操作完成之前超时时间已过或服务器没有响应。

就在今天，第一次：

> System.Web.UI.ViewStateException：无效的视图状态。

* * *

我们已经使用与生产服务器相同数量的并发用户对应用程序进行了负载测试，并且无法重现这些错误。它们非常断断续续，即使只有 8/9/10 个用户连接也会发生。我的直觉告诉我它的 ASP.NET - SQL Server 2000 连接问题..

在这个阶段，我们几乎排除了代码级数据访问层错误（我们有一个由 15 名经验丰富的开发人员组成的开发团队致力于此），因此我们认为这是一个特定的生产服务器环境问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T08:26:09.423

Invalid Viewstate 错误在高流量网站中非常常见。不过，如果您最近移动到多个 Web 服务器，请确保您共享相同的机器密钥，以便在所有服务器上使用相同的密钥对 Viewstate 进行签名。[http://www.codinghorror.com/blog/archives/000132.html](http://www.codinghorror.com/blog/archives/000132.html)

根据其他错误，我猜您正在跨多个线程使用共享连接。您的连接是否存储在静态变量、应用程序状态、会话状态或跨多个请求使用的其他对象中？也许某处有一个包含连接、命令或事务的哈希表。ADO.Net 对象都不是线程安全的。因此，请确保仅以单线程方式使用它们。

另一种可能性是您正在传递 ADO.NET 对象，而不是始终如一地处理它们并管理它们的范围。也许它们被缓存在请求上下文或类似的地方？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T12:44:07.400

我知道你不想听到这个，但是比我说的更聪明的人（如果你不相信我，请查看 McConnell 的[Code Complete ）：](http://cc2e.com/)

这可能是您的代码，您的直觉可能是正确的：

> 我的直觉告诉我它的 ASP.NET - SQL Server 2000 连接问题..

抛出的错误非常具体，从上下文来看，它们看起来只是在尝试连接并且遇到困难——如果它只发生在客户端的环境中，则可能表明虚拟机设置不正确访问主机上的 TCP 连接（在不同的实例下）。

* * *

**您确定**在迁移之前您的代码都**没有**更改，并且您之前的环境启用了这样的日志记录吗？它以前可能已经发生过（程度较轻），但是您的环境没有捕捉到它，因为您没有启用日志记录。

如果这不是问题，并且我正在正确阅读您的帖子：您正在客户端在其管道和带宽上提供的来宾实例上运行服务器？如果是这种情况，那么很可能（大约在升级的同时）更改了某些路由配置，或者进行了防火墙更改，或者实例所在的任何框都进行了一些更改，因为它以不同的方式处理您的东西。

如果您无法在您的环境中重现它，并且您**100%**确定它不是您的代码；那么从逻辑上讲，问题只能是他们的环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T12:21:03.407

小伙子们，正如更新一样，事实证明问题与 VMWare 在大量使用下有关 - 多么有趣的一周！我们正在更改代码以适应 VMWare 环境，并且我们已经看到了一些改进。

感谢您的建议，我很感激。

# iphone - 如何在 iPhone 上记录 SQLite 查询

> ID：424042
> 
> 赞同：2
> 
> 时间：2009-01-08T12:09:32.150
> 
> 标签：iphone, cocoa-touch, sqlite

我正在做一个 iPhone 应用程序，并且我正在使用 SQLite。

问题是我的查询有一些问题（我做了不好的绑定）所以，这是我的问题：

如何使用 SQLite 接收的绑定登录我的 iPhone 应用程序有效的 SQL 查询/语句？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T19:58:31.830

最简单的方法是为您对 sql 函数的调用创建一个包装器并向其添加日志功能。

我不确定 PRAGMA journal_mode 写入的文件是否可读，但我不能使用这个 pragma。

您还可以查看 Gus Mueller 提供的一个出色的现有包装器：[fmdb](http://code.google.com/p/flycode/source/browse/trunk/fmdb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T16:43:32.753

我不认为这是可能的。

据我所知，准备好的语句在进入数据库引擎之前并没有内置到“完整的 SQL”字符串中。参数值不会被转义、引用和插入到 SQL 字符串中，只是为了在下一步中解析和解码：这些值完全绕过查询解析并直接进入数据引擎。

# java - 如何将一个xml的名称、文件类型和文件扩展名输出到另一个xml

> ID：424051
> 
> 赞同：1
> 
> 时间：2009-01-08T12:12:05.017
> 
> 标签：java, xml

我有一个 java 类，它将 xslt 应用于目录中的所有 xml 文件，并对它找到的每个 xml 执行转换并打印出完整的文件名。

我的问题是如何创建一个具有以下格式的 xml (Files.xml)，然后将文件名、文件类型和文件扩展名输出到 Files.xml？

```
<files>
  <file>
    <name> ThisFile </name>
    <type> xml </type>
    <extension> .xml </extension>
  </file>

  <file>
    <name> AnotherFile </name>
    <type> xml </type>
    <extension> .xml </extension>
  </file>

  etc....
</files> 
```

再次感谢我得到的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T12:45:31.393

我建议使用像[JAXB](http://jaxb.java.net/)或[XStream](http://xstream.codehaus.org/)这样的序列化实用程序来直接序列化文件模型，但我在这里留给你一个从头开始构建文档的小示例。

```
public void serializeXmlFiles(ArrayList<File> files) throws ParserConfigurationException, TransformerException {
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    DocumentBuilder db = dbf.newDocumentBuilder();
    Document doc = db.newDocument();

    Element filesElement = doc.createElement("files");
    doc.appendChild(filesElement);

    for (File file : files) {
        Element fileElement = doc.createElement("file");
        Element nameElement = doc.createElement("name");
        nameElement.setTextContent(file.getName());
        Element typeElement = doc.createElement("type");
        typeElement.setTextContent("xml");
        Element extElement = doc.createElement("extension");
        extElement.setTextContent(".xml");

        fileElement.appendChild(nameElement);
        fileElement.appendChild(typeElement);
        fileElement.appendChild(extElement);
        filesElement.appendChild(fileElement);
    }

    saveXMLDocument("files.xml", doc);
}

public boolean saveXMLDocument(String fileName, Document doc) throws TransformerException {
    File xmlOutputFile = new File(fileName);
    FileOutputStream fos;
    Transformer transformer;
    try {
        fos = new FileOutputStream(xmlOutputFile);
    } catch (FileNotFoundException e) {
        return false;
    }
    TransformerFactory transformerFactory = TransformerFactory.newInstance();

    transformer = transformerFactory.newTransformer();

    DOMSource source = new DOMSource(doc);
    StreamResult result = new StreamResult(fos);

    transformer.transform(source, result);
    return true;
} 
```

希望能帮助到你。

# jakarta-ee - 您将如何锁定在线表格？

> ID：424066
> 
> 赞同：6
> 
> 时间：2009-01-08T12:24:52.667
> 
> 标签：jakarta-ee

我们有一个基于传递表单的 Web 应用程序。不幸的是，当人们看到它时，它是可编辑的。所以两个人可以同时编辑它并覆盖他们的更改。您将如何锁定表单（以及同一表单的任何多个部分，因为它被分解为多个页面）以便一次只有一个人可以编辑它？

我们只希望他们能够一次编辑半个小时的表格（他们可以节省并继续添加更多时间）。

* * *

我有一个解决方案，但我想看看其他人的想法。

在我的解决方案中，当用户第一次查看表单（或表单的任何部分，因为有多个部分都需要锁定）时，在点击编辑按钮之前，所有字段都不可编辑。一旦他们点击编辑按钮，就会输入一个带有他们的用户 ID 和开始时间的标志。然后它们被重定向到可编辑的相同表单。页面底部会有一个javascript计时器，让他们知道他们还剩下多少时间。当他们完成后，他们点击“保存并退出”按钮来保存他们的更改，为其他用户解锁表单，并返回到不可编辑的表单。为避免使用后退按钮返回可编辑表单，我认为将使用包含 javascript 重定向的中间页面。

如果他们想编辑其中一个子表单（有一些按钮可以将它们从主表单重定向到子表单），他们只需在编辑模式下单击其中一个按钮，它将保存大表单，将时间更新为再给他们半个小时，然后将他们重定向到可编辑的子表单。

当用户试图查看当前正在由另一个用户编辑的表单时，编辑按钮将灰显，并显示当前用户的信息以及*应该*打开它的时间，但这个时间可以由用户在保存和编辑子表单时更改。

* * *

这听起来像是一个可行的解决方案吗？如果必须做同样的事情，请让我知道您对问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T12:45:43.327

有多种方法可以处理这种情况。一种是锁定表单并一次只允许进行一次编辑。另一种是在保存时检测碰撞并警告用户。

锁定对高争用的资源最有用。如果预计会有很多冲突，那么让用户单击编辑按钮效果最好。这应该将记录标记为已锁定在您的数据存储中，并且应该只允许一个用户对其进行编辑。当用户保存记录或用户取消记录时，需要解锁记录。在网页断开连接的情况下，一段时间后也应该自动解锁。

Collision detection is done by recording a revision number or last edited datetime and passing this to the client when they view the page. The client then passes this back to the server when they hit save and it is checked against the value in the database. If the value has changed then someone else has edited the record and the user can be warned of this. This system works much better for small edits, and when the resource is unlikely to be edited elsewhere (this is usally the case when there are many small records in comparison to the number of active users).

I find detecting the collisions works better and is less frustrating for the user in web applications. Provided that the text they are entering is sufficiently small. This is because locking resources can hold on to them far longer than is neccesary, which is very frustrating

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T12:41:23.757

这是一个可行的解决方案，对可见的管理开销有点沉重，但可能是最合适的解决方案，具体取决于您预期的工作流程。

其他方法包括：

一种。允许任何人编辑和提交表单，但如果其他人在最初打开表单后也提交了更改，则以“冲突”错误响应。如有必要，要改进这一点，请显示两组不同的更改并允许用户选择要应用的更改，或尝试合并更改。

湾。将表单用作即时效果编辑器，无需保存按钮。使用与服务器的 XMLHttpConnection 使表单上所有打开的视图保持最新，这样当一个用户对任何字段进行更改时，它或多或少会在其他任何人的表单副本上立即更新。

# java - 对 iPhone 和 Java 应用程序的可嵌入脚本语言的建议？

> ID：424067
> 
> 赞同：5
> 
> 时间：2009-01-08T12:24:57.080
> 
> 标签：java, cocoa-touch

我正在为 iPhone 开发一个应用程序，它带有一个通过网络同步的 Java 桌面伴侣。我想将脚本语言嵌入到这两个应用程序中，以便最终用户可以编写添加新行为并与对象模型交互的脚本，以便我可以更快地开发一些功能。

对此有什么建议，或者任何人以前做过这个并有经验可以分享？我正在考虑我过去使用过的 tcl 之类的东西，但不是 tcl 本身，因为我不是该语言的忠实粉丝。

主要标准是它应该是

*   轻量级 as poss（内存使用）
*   易于使用 java 和 Objective-c 进行接口和扩展
*   （很高兴）对于编程经验有限的人来说是可读的/平易近人的

我最初的预感是我应该使用 python、ruby 或 lua 之一。我的偏好是红宝石，因为我已经有一些经验，对其他的不太了解。然而，我主要的未知数是其中哪一个最容易与 iPhone 和 Java 集成。

*编辑 2：根据 Jason Coco 的评论，SDK 条款禁止嵌入式脚本语言。检查它似乎确实如此，但我阅读它只是为了排除动态安装和扩展。我仍然会对这里的答案感兴趣，因为该协议似乎并不排除在应用程序包本身中包含预打包的脚本——Apple 仍然会审查该代码。*

*该协议似乎还允许使用苹果的“口译员”……这些是什么？Javascript 和其他什么？有什么路线可以在这里使用它们吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T14:23:00.010

JavaScript

据我了解 iPhone SDK 许可证，没有什么可以阻止您在应用程序中使用脚本语言 - 只是您不能安装任何自己的解释器或运行时。您只能使用 Apple 在 SDK 中为其提供解释器的脚本语言。

假设您想在 iPhone 应用程序和 Java 应用程序中运行相同的脚本，那么显而易见的选择是 JavaScript。您可以在 iPhone 应用程序中使用 Apple 的 API，在 Java 应用程序中使用 Rhino ( [http://www.mozilla.org/rhino/ ) 之类的东西。](http://www.mozilla.org/rhino/)

您必须注意，在语法或对象模型的更模糊区域中，两个解释器之间可能存在细微差别。

PS 我假设用户将编写自己的脚本以在自己的设备/桌面上运行。这些将是应用程序数据的一部分，并且在 Apple 的许可下应该没问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T13:44:09.527

我见过的唯一允许非目标 c/c/c++ 应用程序在 iPhone 上运行的是 Unity3d ( [http://unity3d.com/unity/features/iphone-publishing](http://unity3d.com/unity/features/iphone-publishing) ) - 但是，它使用 C#通过 Mono 并执行完整的静态编译 ( [http://tirania.org/blog/archive/2008/Nov-05.html](http://tirania.org/blog/archive/2008/Nov-05.html) ) 到本机代码以便执行此操作。因此，当应用程序出现在手机上时，它不再是 C#，因此 Apple 允许使用它（并且一些应用程序已经进入 App Store - 所以这似乎是可以接受的）。

我认为即使您可以为 Java/Ruby/Lua/Python/other 做同样的事情，您也无法实现您正在谈论的想法（因此让您的桌面应用程序预编译并仅上传本机代码到设备）。据我所知，您无法在应用程序包之外执行代码......如果您修改应用程序包，那么您会使 Apple 所做的代码签名无效，它首先允许应用程序在您的手机上运行。因此，即使您可以在手机上获取可执行代码，如果它一开始没有与应用程序一起提供，我不确定您是否能够运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T04:23:06.097

我也在研究这个，*似乎*可以预编译 Lua 脚本（通过使用 Lua 将其转换为 C，然后编译 C 文件）。因为您的所有代码都可以成为应用程序包的一部分（包括嵌入式 Lua 解释器），所以它*应该*可以作为 iPhone 应用程序接受。

有关讨论和示例脚本，请参见此处：http: [//lua-users.org/lists/lua-l/2008-11/msg00453.html](http://lua-users.org/lists/lua-l/2008-11/msg00453.html)

*请注意，我还没有尝试过这个（还）

# git - 如何列出提交中的所有文件？

> ID：424071
> 
> 赞同：3231
> 
> 时间：2009-01-08T12:26:32.570
> 
> 标签：git, git-show

我正在寻找一个简单的 Git 命令，它提供了一个格式良好的所有文件列表，这些文件是由哈希 (SHA-1) 给出的提交的一部分，没有多余的信息。

我试过了：

```
git show a303aa90779efdd2f6b9d90693e2cbbbe4613c1d 
```

尽管它列出了文件，但它还包含每个文件的不需要的差异信息。

是否有另一个`git`命令只提供我想要的列表，这样我就可以避免从`git show`输出中解析它？

* * *

## 回答 #1

> 赞同：4361
> 
> 时间：2009-01-08T13:02:22.590

**首选方式**（因为它是一个*管道*命令；意味着程序化）：

```
$ git diff-tree --no-commit-id --name-only -r bd61ad98
index.html
javascript/application.js
javascript/ie6.js 
```

**另一种方式**（不太喜欢脚本，因为它是一个*瓷器*命令；意味着面向用户）

```
$ git show --pretty="" --name-only bd61ad98    
index.html
javascript/application.js
javascript/ie6.js 
```

* * *

*   `--no-commit-id`抑制提交 ID 输出。
*   该`--pretty`参数指定一个空的格式字符串以避免开头的杂乱无章。
*   该`--name-only`参数仅显示受影响的文件名（感谢 Hank）。`--name-status`如果您想查看每个文件发生了什么，请改用（**删除**、**修改**、**添加**）
*   `-r`参数是递归到子树

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2009-01-14T19:22:41.737

如果要获取已更改文件的列表：

```
git diff-tree --no-commit-id --name-only -r <commit-ish> 
```

如果要获取提交中所有文件的列表，可以使用

```
git ls-tree --name-only -r <commit-ish> 
```

* * *

## 回答 #3

> 赞同：267
> 
> 时间：2009-01-08T12:34:49.527

我只是假设这[`gitk`](https://git-scm.com/docs/gitk)是不需要的。在这种情况下，请尝试`git show --name-only <sha>`.

* * *

## 回答 #4

> 赞同：241
> 
> 时间：2012-07-11T23:21:49.803

我个人将**--stat**和**--oneline**与**show**命令结合使用：

```
git show --stat --oneline HEAD
git show --stat --oneline b24f5fb
git show --stat --oneline HEAD^^..HEAD 
```

如果您不喜欢/想要添加/删除统计信息，可以将**--stat**替换为**--name-only**

```
git show --name-only --oneline HEAD
git show --name-only --oneline b24f5fb
git show --name-only --oneline HEAD^^..HEAD 
```

* * *

## 回答 #5

> 赞同：112
> 
> 时间：2014-05-27T01:20:34.363

你也可以做

```
git log --name-only 
```

您可以浏览各种提交、提交消息和更改的文件。

键入 q 以获取您的提示。

* * *

## 回答 #6

> 赞同：74
> 
> 时间：2010-04-26T12:23:55.553

最近我需要列出两次提交之间的所有更改文件。所以我使用了这个（也是 *nix 特定的）命令

```
git show --pretty="format:" --name-only START_COMMIT..END_COMMIT | sort | uniq 
```

或者正如[Ethan 指出的那样](https://stackoverflow.com/questions/424071/how-to-list-all-the-files-in-a-commit#comment27828076_2713363)：

```
git diff --name-only START_COMMIT..END_COMMIT 
```

使用`--name-status`还将包括每个文件旁边的更改（添加、修改、删除等）：

```
git diff --name-status START_COMMIT..END_COMMIT 
```

* * *

## 回答 #7

> 赞同：67
> 
> 时间：2016-07-16T00:06:05.673

最简单的形式：

`git show --stat (hash)`

这更容易记住，它将为您提供所需的所有信息。

如果您真的只想要文件的名称，您可以添加该`--name-only`选项。

`git show --stat --name-only (hash)`

* * *

## 回答 #8

> 赞同：50
> 
> 时间：2013-04-29T13:13:22.017

我经常使用**更改后的** [别名。](https://git-scm.com/book/en/v2/Git-Basics-Git-Aliases)要设置它：

```
git config --global alias.changed 'show --pretty="format:" --name-only' 
```

然后：

```
git changed (lists files modified in last commit)
git changed bAda55 (lists files modified in this commit)
git changed bAda55..ff0021 (lists files modified between those commits) 
```

可能有用的类似命令：

```
git log --name-status --oneline (very similar, but shows what actually happened M/C/D)
git show --name-only 
```

* * *

## 回答 #9

> 赞同：46
> 
> 时间：2018-05-15T16:42:35.587

采用

```
git log --name-status 
```

这将向您显示提交 ID、消息、更改的文件以及是否已修改、创建、添加或删除。有点像一个多合一的命令。

* * *

## 回答 #10

> 赞同：42
> 
> 时间：2011-04-29T14:53:08.463

**使用标准`git diff`命令**（也适用于脚本）：

```
git diff --name-only <sha>^ <sha> 
```

**如果您还想要更改文件的状态：**

```
git diff --name-status <sha>^ <sha> 
```

这适用于合并提交。

* * *

## 回答 #11

> 赞同：40
> 
> 时间：2018-10-06T13:20:15.323

尝试使用此命令获取名称并更改行数

```
git show --stat <commit-hash> 
```

只显示文件名

```
git show --stat --name-only  <commit-hash> 
```

要获取最后一次提交哈希，请尝试以下命令：

```
git log -1 
```

带有显示文件名和文件状态的上次提交修改、创建或删除：

```
 git log -1 --oneline --name-status <commit-hash> 
```

或为所有人

```
git log 
```

有关更高级的 git 日志信息，请阅读以下文章：

*   *[Git 日志格式字符串备忘单](https://devhints.io/git-log-format)*

*   *[git log 备忘单](https://devhints.io/git-log)*

* * *

## 回答 #12

> 赞同：27
> 
> 时间：2009-01-08T14:11:28.833

```
$ git log 88ee8^..88ee8 --name-only --pretty="format:"

```

* * *

## 回答 #13

> 赞同：21
> 
> 时间：2017-07-06T13:32:24.600

好的，有几种方法可以显示特定提交中的所有文件......

要减少信息并**仅显示**已提交文件的名称，您只需添加`--name-only`或`--name-status`标记...这些标记仅向您显示与之前提交的文件名不同的文件名...

因此，您可以在 .`git diff`之后`--name-only`执行两个提交哈希`<sha0> <sha1>`。如下所示：

```
git diff --name-only 5f12f15 kag9f02 
```

我还创建了下图来显示在这些情况下要执行的所有步骤：

[![git diff --name-only 5f12f15 kag9f02](https://i.stack.imgur.com/dxHRm.png)](https://i.stack.imgur.com/dxHRm.png)

* * *

## 回答 #14

> 赞同：18
> 
> 时间：2021-06-15T15:40:04.237

列出在**特定提交**上更改的文件：

```
git show --pretty=%gd --stat <commit_id> 
```

要列出**最近提交**时更改的文件：

```
git show --pretty=%gd --stat 
```

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2015-10-14T11:05:59.730

还有`git whatchanged`, 比`git log`

```
NAME
       git-whatchanged - Show logs with difference each commit introduces 
```

它输出提交摘要及其下的文件列表及其模式，以及它们是否被添加（`A`）、删除（`D`）或修改（`M`）；

```
$ git whatchanged f31a441398fb7834fde24c5b0c2974182a431363 
```

会给出类似的东西：

```
commit f31a441398fb7834fde24c5b0c2974182a431363
Author: xx <xx@xx.nl>
Date:   Tue Sep 29 17:23:22 2015 +0200

    added fb skd and XLForm

:000000 100644 0000000... 90a20d7... A  Pods/Bolts/Bolts/Common/BFCancellationToken.h
:000000 100644 0000000... b5006d0... A  Pods/Bolts/Bolts/Common/BFCancellationToken.m
:000000 100644 0000000... 3e7b711... A  Pods/Bolts/Bolts/Common/BFCancellationTokenRegistration.h
:000000 100644 0000000... 9c8a7ae... A  Pods/Bolts/Bolts/Common/BFCancellationTokenRegistration.m
:000000 100644 0000000... bd6e7a1... A  Pods/Bolts/Bolts/Common/BFCancellationTokenSource.h
:000000 100644 0000000... 947f725... A  Pods/Bolts/Bolts/Common/BFCancellationTokenSource.m
:000000 100644 0000000... cf7dcdf... A  Pods/Bolts/Bolts/Common/BFDefines.h
:000000 100644 0000000... 02af9ba... A  Pods/Bolts/Bolts/Common/BFExecutor.h
:000000 100644 0000000... 292e27c... A  Pods/Bolts/Bolts/Common/BFExecutor.m
:000000 100644 0000000... 827071d... A  Pods/Bolts/Bolts/Common/BFTask.h
... 
```

我知道这个答案并不真正匹配“没有无关信息。”，但我仍然认为这个列表比文件名更有用。

* * *

## 回答 #16

> 赞同：15
> 
> 时间：2010-03-28T07:37:53.370

我用它来获取两个变更集之间的修改文件列表：

```
git diff --name-status <SHA1> <SHA2> | cut -f2 
```

* * *

## 回答 #17

> 赞同：14
> 
> 时间：2010-11-03T08:12:26.757

我喜欢用

```
git show --stat <SHA1>^..<SHA2> 
```

* * *

## 回答 #18

> 赞同：14
> 
> 时间：2013-11-28T15:36:39.463

如果您只想在上次提交中更改文件列表，请使用简单的单行命令：

```
git diff HEAD~1 --name-only 
```

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2009-04-22T16:10:22.770

我喜欢这个：

```
git diff --name-status <SHA1> <SHA1>^ 
```

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2019-05-22T13:36:34.640

我使用它来获取合并提交中已更改文件的列表

```
λ git log -m -1 --name-only --pretty="format:"
configs/anotherconfig.xml
configs/configsInRepo.xml 
```

或者

```
λ git log -m -1 --name-status --pretty="format:"
A       configs/anotherconfig.xml
M       configs/configsInRepo.xml 
```

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2017-09-01T21:51:00.033

我找到了一个完美的答案：

```
git show --name-status --oneline <commit-hash> 
```

这样我就可以知道

*   哪些文件刚刚被修改（M）

*   新增了哪些文件（A）

*   删除了哪些文件 (D)

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2011-08-25T12:34:37.220

显示日志。

`COMMIT`可以是空白 ("")、[SHA-1](https://en.wikipedia.org/wiki/SHA-1)哈希或 SHA-1 哈希的缩短版本。

```
git log COMMIT -1 --name-only 
```

这将仅列出文件，对于进一步处理非常有用。

```
git log COMMIT -1 --name-only --pretty=format:"" | grep "[^\s]" 
```

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2012-07-28T00:55:26.270

列出提交中更改的文件：

```
git diff --name-only SHA1^ SHA1 
```

这不会显示日志消息、额外的换行符或任何其他混乱。这适用于任何提交，而不仅仅是当前提交。

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2020-05-08T11:29:25.803

*只有*文件列表（甚至没有提交消息）：

```
git show --name-only --pretty=format: 
```

例如，在您的编辑器中打开所有更改的文件：

```
git show --name-only --pretty=format: | xargs "$EDITOR" 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2009-01-08T13:59:58.653

“ `git show --stat`”（感谢 Ryan）和几个 sed 命令的组合应该为您修剪数据：

```
git show --stat <SHA1> | sed -n "/ [\w]\*|/p" | sed "s/|.\*$//" 
```

这将只生成已修改文件的列表。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2015-08-26T11:59:32.483

有一个简单的技巧可以将其视为文件列表。只需`:`在哈希后添加：

```
git show 9d3a52c474: 
```

然后你可以钻进去，

```
git show 9d3a52c474:someDir/someOtherDir 
```

如果您点击文件，您将获得该文件的原始版本；如果您只是在寻找一个很好的参考或关键代码片段（差异会使一切变得一团糟），这有时就是您想要的，

```
git show 9d3a52c474:someDir/someOtherDir/somefile 
```

这种方法的唯一缺点是它不容易显示文件树。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2020-08-01T22:13:08.527

列出提交树中的所有文件：

```
git ls-tree --name-only --full-tree a21e610 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2012-06-12T09:31:16.580

```
git show HEAD@{0} 
```

对我来说很好

# javascript - 如何确定其他 html 文件是否已加载 javascript

> ID：424073
> 
> 赞同：2
> 
> 时间：2009-01-08T12:27:18.997
> 
> 标签：javascript

如何确定 javascript 是否已被其他 html 文件加载？我想减少 javascript 文件的冗余加载以减少网页的加载时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T12:30:58.427

如果您的 Web 服务器提供了正确的缓存标头，则这不是必需的，浏览器将跨多个请求缓存 javascript 文件。

您可能想查看 YDN 页面加速网站的[最佳实践](http://developer.yahoo.com/performance/rules.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T12:34:47.857

如果您想防止文件被下载两次，那么这将是自动的，前提是它们被设置为可缓存（大多数网络服务器默认情况下应该明智地设置这些标头）。

如果您想确保在以动态语言包含文件时包含标记只发生一次，那么您将需要某种管理器。ASP.NET 提供了一个执行此操作的脚本管理器类（除其他外）。我不能代表其他语言和框架

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T12:36:17.883

正如 Rory 所说，第二个请求可能会被缓存，并指出如果发生这种情况，这有点设计失败，您可以理解缓存的文件仍然会以负面影响执行。

这太可怕了，但你可以像这样包装你的 JS 脚本：

```
if (!document.foo)
{
  //your script here

  document.foo = true;
} 
```

# mysql - 为什么这个 LEFT JOIN 会消除另一个表中没有任何内容的记录？

> ID：424092
> 
> 赞同：3
> 
> 时间：2009-01-08T12:39:39.593
> 
> 标签：mysql, sql, join, left-join

我有一个 MySQL 左连接问题。

我有三个要加入的表。

人表：

```
创建表人（
    id INT NOT NULL AUTO_INCREMENT,
    键入 ENUM('student', 'staff', 'guardian') NOT NULL,
    first_name CHAR(30) NOT NULL,
    姓氏 CHAR(30) 非空，
    性别 ENUM('m', 'f') NOT NULL,
    dob VARCHAR(30) 非空，
    主键（id）
);
```

学生表：

```
创建表学生（
    id INT NOT NULL AUTO_INCREMENT,
    person_id INT NOT NULL，
    primary_guardian INT NOT NULL，
    secondary_guardian INT，
    join_date VARCHAR(30) 非空，  
    status ENUM('current', 'graduated', 'expelled', 'other') NOT NULL,
    导师组 VARCHAR(30) 非空，
    year_group VARCHAR(30) 非空，
    主键（id），
    FOREIGN KEY (person_id) REFERENCES person(id) ON DELETE CASCADE,
    外键（primary_guardian）参考监护人（id），
    FOREIGN KEY (secondary_guardian) REFERENCES Guardian(id),
    外键（导师组）参考导师组（名称），
    FOREIGN KEY (year_group) REFERENCES year_group(name)
);
```

还有一个事件表：

```
CREATE TABLE 事件 (
    id INT NOT NULL AUTO_INCREMENT,
    学生 INT NOT NULL，
    员工 INT NOT NULL，
    监护人 INT NOT NULL，
    sent_home BOOLEAN NOT NULL,
    疾病类型 VARCHAR(255) 非空，
    action_taken VARCHAR(255) 非空，
    event_date DATETIME NOT NULL,
    主键（id），
    外键（学生）参考学生（id），
    外键（员工）参考员工（id），
    外键（监护人）参考监护人（id）
);
```

我要选择的是第 9 年每个学生的名字、姓氏和事件数量。

这是我对查询的最佳尝试：

```
选择 p.first_name, p.last_name, COUNT(i.student)
FROM person p, student s LEFT JOIN event i ON s.id = i.student
WHERE p.id = s.person_id AND s.year_group LIKE "%Year 9%";
```

但是，它会忽略任何没有发生事件的学生，这不是我想要的 - 他们应该显示但计数为 0。如果我删除左连接和计数，那么我会得到所有学生，如我所料。

我可能误解了 left join 但我认为它应该做的，基本上是我想要做的？

谢谢你的帮助，

亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T13:10:15.540

你在做什么很好，你只是错过了 group by 条款

```
SELECT p.first_name, p.last_name, COUNT(i.student)
FROM person p, student s  LEFT JOIN incident i ON s.id = i.student 
WHERE p.id = s.person_id AND s.year_group LIKE "%Year 9%"
GROUP BY p.first_name, p.last_name; 
```

这是一些测试数据

```
insert into person values(1, 'student', 'Alice', 'Foo', 'f','1970-01-01');
insert into person values(2, 'student', 'Bob', 'Bar', 'm','1970-01-01');

insert into student values(1,1,0,0,'', 'current','','Year 9');
insert into student values(2,2,0,0,'', 'current','','Year 9');

insert into incident values(1,1,0,0,0,'flu','chicken soup', '2008-01-08'); 
```

以下是添加了 group by 的查询的输出：

```
+------------+-----------+------------------+
| first_name | last_name | COUNT(i.student) |
+------------+-----------+------------------+
| Alice      | Foo       |                1 |
| Bob        | Bar       |                0 |
+------------+-----------+------------------+ 
```

您可以通过从 where 子句创建连接子句并根据人员 ID 分组来进一步清理查询：

```
SELECT p.first_name, p.last_name, COUNT(i.student)
FROM person p
INNER JOIN student s ON(p.id = s.person_id)
LEFT JOIN incident i ON(s.id = i.student)
WHERE s.year_group LIKE "%Year 9%"
GROUP BY p.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T12:51:44.437

那不是您正在寻找的左外连接吗？我可能混淆了我的术语？不会是第一次。但阿伦的回答会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T12:56:43.117

`LEFT JOIN`或者，您可以通过使用[相关子查询](http://en.wikipedia.org/wiki/Correlated_subquery "相关子查询的维基百科")来避免：

```
SELECT
  p.first_name
  , p.last_name
  , (SELECT COUNT(*) FROM incident i WHERE i.student = s.id) 
FROM
  person p JOIN student s on s.person_id = p.id
WHERE
  s.year_group LIKE "%Year 9%" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T13:14:22.097

您开始使用不带 group by 的 count，并且您正在混合使用“where”和“on”语法进行连接。试试这个：

```
SELECT p.first_name, p.last_name, COUNT(i.student)
FROM person p
JOIN student s on p.id = s.person
LEFT JOIN incident i ON s.id = i.student 
WHERE s.year_group LIKE "%Year 9%"
GROUP BY P.id; 
```

# c# - 使用 nhibernate 持久化三个相关表

> ID：424096
> 
> 赞同：0
> 
> 时间：2009-01-08T12:41:57.000
> 
> 标签：c#, .net, nhibernate

我们有三个表 A、B、C。

**列**

A => id, x

B => id, y

C => A.id, B.id

对于 A 中的每一行，B 中都会有一行。为了关联 A 和 B，我们使用 C（我们无法更改表格设计）。我们必须在一个事务中持久化信息。有没有办法使用 NHibernate 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-28T06:23:08.923

What you are describing here is a many-to-many table mapping. there is a many-to-many mapping property. this means that you will not need a mapping for table C.

To borrow the Mapping from Mark G's Answer.

```
<class name="ClassA" table="A">
   <id name="Id" column="ID">
      <generator class="native"/>
   </id>
   <property name="x" column="X" />
   <bag name="List_Of_B" table="C" cascade="all">
      <key column="AId"/>
      <many-to-many column="BId"
         class="B"/>
   </bag>
</class>

<class name="ClassB" table="B">
   <id name="Id" column="ID">
      <generator class="native"/>
   </id>
   <property name="y" column="Y" />
   <bag name="List_Of_A" table="C" cascade="all">
      <key column="BId"/>
      <many-to-many column="AId"
         class="A"/>
   </bag>
</class> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T19:54:26.800

这取决于您的类结构是什么或您在类结构中寻找什么。如果这些确实是表中唯一的列，那么这种方式似乎有点矫枉过正，并且会导致访问 X 和 Y（classC.AX 和 classC.BX）的一些不太理想的方式，但它会起作用。也许您可以在 ClassC 上拥有一些未保存的属性，从而以更简洁的方式对您进行调用。

```
<class name="ClassA" table="A">
   <id name="Id" column="ID">
      <generator class="native"/>
   </id>
   <property name="x" column="X" />
</class>

<class name="ClassB" table="B">
   <id name="Id" column="ID">
      <generator class="native"/>
   </id>
   <property name="y" column="Y" />
</class>

<class name="ClassC" table="C">
   <id name="Id" column="ID">
      <generator class="native"/>
   </id>
   <many-to-one name="A" class="ClassA" column="A_ID"/>
   <many-to-one name="B" class="ClassB" column="B_ID"/>
</class> 
```

如果 C 只有这些列，您可以将其更改为使用复合 id（查看[文档](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/)）。然后，也取决于您的需要，您可以设置级联，这样就 CRUD 而言，您只会与 ClassC 混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T12:45:53.263

我自己从来不需要这样做，但你可能想看看使用一些`joined-table`映射。

对于事务性操作，只需：

```
using(var session = TheSessionFactory.OpenSession()) {
    using(var txn = session.BeginTransaction()) {
        //transactional work
        txn.Commit();
    }
} 
```

# c++ - 我可以在不使用朋友的情况下从课堂外访问私人成员吗？

> ID：424104
> 
> 赞同：76
> 
> 时间：2009-01-08T12:45:56.430
> 
> 标签：c++, encapsulation, private-members

### 免责声明

是的，我完全清楚我所问的完全是愚蠢的，任何想在生产代码中尝试这种事情的人都应该被解雇和/或枪杀。我主要看*能*不能做。

既然已经不碍事了，有没有办法从类外部访问 C++ 中的私有类成员？例如，有没有办法用指针偏移量来做到这一点？

（欢迎幼稚和其他非生产就绪技术）

### 更新

正如评论中所指出的，我问这个问题是因为我想写一篇关于过度封装（以及它如何影响 TDD）的博客文章。我想看看是否有办法说“即使在 C++ 中，使用私有变量也不是 100% 可靠的强制封装方式”。最后，我决定更多地关注如何解决这个问题，而不是为什么它是一个问题，所以我没有像我计划的那样突出这里提出的一些东西，但我仍然留下了一个链接。

无论如何，如果有人对它是如何产生的感兴趣，这里是： [测试驱动开发的敌人第一部分：封装](http://jasonmbaker.wordpress.com/2009/01/08/enemies-of-test-driven-development-part-i-encapsulation/)（我建议在你认为我疯了之前阅读它）。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-08T16:43:42.970

如果该类包含任何模板成员函数，您可以专门化该成员函数以满足您的需要。即使最初的开发者没有想到。

安全.h

```
class safe
{
    int money;

public:
    safe()
     : money(1000000)
    {
    }

    template <typename T>
    void backdoor()
    {
        // Do some stuff.
    }
}; 
```

主.cpp：

```
#include <safe.h>
#include <iostream>

class key;

template <>
void safe::backdoor<key>()
{
    // My specialization.
    money -= 100000;
    std::cout << money << "\n";
}

int main()
{
    safe s;
    s.backdoor<key>();
    s.backdoor<key>();
} 
```

输出：

```
900000
800000 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2010-07-03T22:38:43.413

我在[我的博客中添加了一个条目](http://bloglitb.blogspot.de/2011/12/access-to-private-members-safer.html)（见下文），展示了它是如何完成的。这是有关如何将其用于以下课程的示例

```
struct A {
private:
  int member;
}; 
```

只需在你描述它的地方为它声明一个结构并实例化用于抢劫的实现类

```
// tag used to access A::member
struct A_member { 
  typedef int A::*type;
  friend type get(A_member);
};

template struct Rob<A_member, &A::member>;

int main() {
  A a;
  a.*get(A_member()) = 42; // write 42 to it
  std::cout << "proof: " << a.*get(A_member()) << std::endl;
} 
```

类模板是这样定义的`Rob`，只需要定义一次，不管你打算访问多少个私有成员

```
template<typename Tag, typename Tag::type M>
struct Rob { 
  friend typename Tag::type get(Tag) {
    return M;
  }
}; 
```

但是，这并不表明 c++ 的访问规则不可靠。语言规则旨在防止意外错误 - 如果您试图窃取对象的数据，语言*设计*不会花很长时间来阻止您。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-01-08T12:53:43.700

以下是偷偷摸摸的、非法的、依赖于编译器的，并且可能无法工作，具体取决于各种实现细节。

```
#define private public
#define class struct 
```

但这是对您的 OP 的回答，您在其中明确邀请了一种技术，我引用该技术是“完全愚蠢的，任何希望在生产代码中尝试这种事情的人都应该被解雇和/或枪杀”。

* * *

另一种技术是访问私有成员数据，方法是使用从对象开头的硬编码/手动编码的偏移量构造指针。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-01-08T13:04:52.930

嗯，不知道这是否可行，但可能值得一试。创建另一个具有与具有私有成员但私有更改为公共的对象相同布局的类。创建一个指向此类的指针变量。使用简单的强制转换将其指向具有私有成员的对象并尝试调用私有函数。

期待火花，也许会崩溃；）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-09T03:41:22.097

```
class A 
{ 
   int a; 
}
class B
{
   public: 
   int b;
}

union 
{ 
    A a; 
    B b; 
}; 
```

那应该这样做。

ETA：它适用于这种琐碎的课程，但一般来说它不会。

> TC++PL 第 C.8.3 节：“具有构造函数、析构函数或复制操作的类不能是联合成员的类型……因为编译器不知道要销毁哪个成员。”

所以我们最好的选择是声明`class B`匹配`A`的布局并破解查看一个类的私人信息。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-08T19:13:56.570

如果您可以获得指向类成员的指针，则无论访问说明符是什么（甚至是方法），您都可以使用该指针。

```
class X;
typedef void (X::*METHOD)(int);

class X
{
    private:
       void test(int) {}
    public:
       METHOD getMethod() { return &X::test;}
};

int main()
{
     X      x;
     METHOD m = x.getMethod();

     X     y;
     (y.*m)(5);
} 
```

当然我最喜欢的小技巧是朋友模板后门。

```
class Z
{
    public:
        template<typename X>
        void backDoor(X const& p);
    private:
        int x;
        int y;
}; 
```

假设上面的创建者已经为他的正常使用定义了 backDoor。但是您想访问该对象并查看私有成员变量。即使上面的类已经被编译成一个静态库，你也可以为 backDoor 添加你自己的模板特化，从而访问成员。

```
namespace
{
    // Make this inside an anonymous namespace so
    // that it does not clash with any real types.
    class Y{};
}
// Now do a template specialization for the method.
template<>
void Z::backDoor<Y>(Y const& p)
{
     // I now have access to the private members of Z
}

int main()
{
    Z  z;   // Your object Z

    // Use the Y object to carry the payload into the method.
    z.backDoor(Y());
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-01-08T15:34:39.383

在 C++ 中使用指针偏移量访问私有成员绝对是可能的。假设我有以下想要访问的类型定义。

```
class Bar {
  SomeOtherType _m1;
  int _m2;
}; 
```

假设 Bar 中没有虚方法，最简单的情况是 _m1。C++ 中的成员存储为对象内存位置的偏移量。第一个对象在偏移量 0 处，第二个对象在 sizeof(first member) 的偏移量处，等等...

所以这里有一种访问_m1的方法。

```
SomeOtherType& GetM1(Bar* pBar) {
  return*(reinterpret_cast<SomeOtherType*>(pBar)); 
} 
```

现在 _m2 有点困难。我们需要从原始指针 sizeof(SomeOtherType) 字节中移动原始指针。转换为 char 是为了确保我在字节偏移量中递增

```
int& GetM2(Bar* pBar) {
  char* p = reinterpret_cast<char*>(pBar);
  p += sizeof(SomeOtherType);
  return *(reinterpret_cast<int*>(p));
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-01-01T15:25:43.290

该答案基于[@Johannes 的 answer/blog](https://stackoverflow.com/a/3173080/514235)所展示的确切概念，因为这似乎是唯一“合法”的方式。我已经将该示例代码转换为一个方便的实用程序。它很容易与 C++03 兼容（通过实现`std::remove_reference`和替换`nullptr`）。

## 图书馆

```
#define CONCATE_(X, Y) X##Y
#define CONCATE(X, Y) CONCATE_(X, Y)

#define ALLOW_ACCESS(CLASS, MEMBER, ...) \
  template<typename Only, __VA_ARGS__ CLASS::*Member> \
  struct CONCATE(MEMBER, __LINE__) { friend __VA_ARGS__ CLASS::*Access(Only*) { return Member; } }; \
  template<typename> struct Only_##MEMBER; \
  template<> struct Only_##MEMBER<CLASS> { friend __VA_ARGS__ CLASS::*Access(Only_##MEMBER<CLASS>*); }; \
  template struct CONCATE(MEMBER, __LINE__)<Only_##MEMBER<CLASS>, &CLASS::MEMBER>

#define ACCESS(OBJECT, MEMBER) \     
 (OBJECT).*Access((Only_##MEMBER<std::remove_reference<decltype(OBJECT)>::type>*)nullptr) 
```

## API

```
ALLOW_ACCESS(<class>, <member>, <type>); 
```

## 用法

```
ACCESS(<object>, <member>) = <value>;   // 1
auto& ref = ACCESS(<object>, <member>); // 2 
```

## [演示](http://coliru.stacked-crooked.com/a/22bd4a6b05aeded9)

```
struct X {
  int get_member () const { return member; };
private:
  int member = 0;
};

ALLOW_ACCESS(X, member, int);

int main() {
  X x;
  ACCESS(x, member) = 42;
  std::cout << "proof: " << x.get_member() << std::endl;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-08T12:50:19.213

如果您知道您的 C++ 编译器如何破坏名称，是的。

除非，我想，它是一个虚函数。但是，如果您知道您的 C++ 编译器如何构建 VTABLE ...

编辑：查看其他回复，我意识到我误读了这个问题，并认为它与成员函数有关，而不是成员数据。但是，重点仍然存在：如果您知道编译器如何布置数据，那么您就可以访问该数据。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-03-29T09:03:22.457

很酷的问题顺便说一句......这是我的作品：

```
using namespace std;

class Test
{

private:

  int accessInt;
  string accessString;

public:

  Test(int accessInt,string accessString)
  {
    Test::accessInt=accessInt;
    Test::accessString=accessString;
  }
};

int main(int argnum,char **args)
{
  int x;
  string xyz;
  Test obj(1,"Shit... This works!");

  x=((int *)(&obj))[0];
  xyz=((string *)(&obj))[1];

  cout<<x<<endl<<xyz<<endl;
  return 0;
} 
```

希望这可以帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-08T16:22:48.847

其实很简单：

```
class jail {
    int inmate;
public:
    int& escape() { return inmate; }
}; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-08T11:57:52.070

作为模板后门方法的替代方法，您可以使用模板后门类。不同的是你不需要把这个后门类放到你要测试的类的公共区域。我使用的事实是，许多编译器允许嵌套类访问封闭类的私有区域（这不完全是 1998 年的标准，但被认为是“正确的”行为）。当然，在 C++11 中，这成为了合法行为。

看这个例子：

```
#include <vector>
#include <cassert>
#include <iostream>
using std::cout;
using std::endl;

///////// SystemUnderTest.hpp
class SystemUnderTest
{
   //...put this 'Tested' declaration into private area of a class that you are going to test
   template<typename T> class Tested;
public:
   SystemUnderTest(int a): a_(a) {}
private:
   friend std::ostream& operator<<(std::ostream& os, const SystemUnderTest& sut)
   {
      return os << sut.a_;
   }
   int a_;
};

/////////TestFramework.hpp
class BaseTest
{
public:
   virtual void run() = 0;
   const char* name() const { return name_; }
protected:
   BaseTest(const char* name): name_(name) {}
   virtual ~BaseTest() {}
private:
   BaseTest(const BaseTest&);
   BaseTest& operator=(const BaseTest&);
   const char* name_;
};

class TestSuite
{
   typedef std::vector<BaseTest*> Tests;
   typedef Tests::iterator TIter;
public:
   static TestSuite& instance()
   {
      static TestSuite TestSuite;
      return TestSuite;
   }
   void run()
   {
      for(TIter iter = tests_.begin(); tests_.end() != iter; ++iter)
      {
         BaseTest* test = *iter;
         cout << "Run test: " << test->name() << endl;
         test->run();
      }
   }
   void addTest(BaseTest* test)
   {
      assert(test);
      cout << "Add test: " << test->name() << endl;
      tests_.push_back(test);
   }
private:
   std::vector<BaseTest*> tests_;
};

#define TEST_CASE(SYSTEM_UNDER_TEST, TEST_NAME) \
class TEST_NAME {}; \
template<> \
class SYSTEM_UNDER_TEST::Tested<TEST_NAME>: public BaseTest \
{ \
   Tested(): BaseTest(#SYSTEM_UNDER_TEST "::" #TEST_NAME) \
   { \
      TestSuite::instance().addTest(this); \
   } \
   void run(); \
   static Tested instance_; \
}; \
SYSTEM_UNDER_TEST::Tested<TEST_NAME> SYSTEM_UNDER_TEST::Tested<TEST_NAME>::instance_; \
void SYSTEM_UNDER_TEST::Tested<TEST_NAME>::run()

//...TestSuiteForSystemUnderTest.hpp
TEST_CASE(SystemUnderTest, AccessPrivateValueTest)
{
   SystemUnderTest sut(23);
   cout << "Changed private data member from " << sut << " to ";
   sut.a_ = 12;
   cout << sut << endl;
}

//...TestRunner.cpp
int main()
{
   TestSuite::instance().run();
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-08T13:01:40.533

除了**#define private public**之外，您还可以**#define private protected**然后将一些 foo 类定义为想要的类的后代，以便通过类型转换访问它的（现在受保护的）方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-08T13:30:34.827

只需创建自己的访问成员函数来扩展类。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-08T16:16:12.917

对于所有建议“ **#define private public** ”的人：

这种事情是**违法**的。该标准禁止定义/取消定义在词法上等同于保留语言关键字的宏。虽然您的编译器可能不会抱怨（我还没有看到有这样的编译器），但这并不是一件“好事”。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-06-30T09:56:53.113

因为你有一个必需类的对象，我猜你有类的声明。现在您可以做的是声明另一个具有相同成员的类，但将所有访问说明符保持为公共。

例如上一课是：

```
class Iamcompprivate
{
private:
    Type1 privateelement1;
    Typ2 privateelement2;
    ...

public:
    somefunctions
} 
```

你可以将一个类声明为

```
class NowIampublic
{
**public:**
    Type1 privateelement1;
    Type2 privateelement2;
    ...

    somefunctions
}; 
```

现在您需要做的就是将类指针`Iamcompprivate`转换为类指针`NowIampublic`并按照 U 的意愿使用它们。

例子：

```
NowIampublic * changetopublic(Iamcompprivate *A)
{
    NowIampublic * B = (NowIampublic *)A;
    return B;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-12-22T21:55:26.667

*“即使在 C++ 中，使用私有变量也不是 100% 可靠的强制封装方式。”* 真的吗？你可以反汇编你需要的库，找到所有需要的偏移量并使用它们。这将使您能够更改您喜欢的任何私人成员......但是！如果没有一些肮脏的黑客攻击，您将无法访问私人成员。让我们说写**const**不会让你的常量真正保持不变，因为你可以转换**const**离开或只是使用它的地址使其无效。如果您使用的是 MSVC++ 并且您将“-merge:.rdata=.data”指定给链接器，则该技巧将有效，不会出现任何内存访问错误。我们甚至可以说，用 C++ 编写应用程序并不是编写程序的可靠方式，因为当你的应用程序运行时，可能会从外部的某个地方修补生成的低级代码。那么执行封装的可靠记录方法是什么？我们能否将数据隐藏在 RAM 中的某个位置，并阻止除我们的代码之外的任何东西访问它们？我唯一的想法是加密私人成员并备份它们，因为某些东西可能会破坏这些成员。对不起，如果我的回答太粗鲁，我并没有冒犯任何人的意思，但我真的不认为这种说法是明智的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-07-03T19:32:51.533

通过引用 * *this*，您可以为对象内的所有私有数据启用后门。

```
class DumbClass
{
private:
    int my_private_int;
public:
    DumbClass& backdoor()
    {
        return *this;
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-07-16T10:14:59.493

一个类经常为私有数据（getter 和 setter）提供 mutator 方法。

如果一个类确实提供了一个返回 const 引用（但没有 setter）的 getter，那么您可以只 const_cast getter 的返回值，并将其用作左值：

```
class A {
  private:
    double _money;
  public:
    A(money) :
      _money(money)
    {}

    const double &getMoney() const
    {
      return _money;
    }
};

A a(1000.0);
const_cast<double &>(a.getMoney()) = 2000.0; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-04-08T15:31:07.930

我使用了另一种有用的方法（和解决方案）来访问 c++ 私有/受保护成员。
唯一的条件是您能够从要访问的类继承。
然后所有功劳归于**reinterpret_cast<>()**。

*一个可能的问题是，如果您插入一个虚拟函数，它将无法工作，这将修改虚拟表，因此，对象大小/对齐。*

```
class QObject
{
    Q_OBJECT
    Q_DECLARE_PRIVATE(QObject)
    void dumpObjectInfo();
    void dumpObjectTree();
...
protected:
    QScopedPointer<QObjectData> d_ptr;
...
}

class QObjectWrapper : public QObject
{
public:
    void dumpObjectInfo2();
    void dumpObjectTree2();
}; 
```

然后，您只需要按如下方式使用该类：

```
QObject* origin;
QObjectWrapper * testAccesor = reinterpret_cast<QObjectWrapper *>(origin);
testAccesor->dumpObjectInfo2();
testAccesor->dumpObjectTree2(); 
```

我最初的问题如下：我需要一个不意味着重新编译 QT 库的解决方案。*QObject*
中有 2 个方法，*dumpObjectInfo* () 和*dumpObjectTree* ()，如果 QT 库在调试模式下编译，它们就可以工作，它们当然需要访问 d_ptr 受保护的成员（以及其他内部结构）。 我所做的是使用建议的解决方案在我自己的类（*QObjectWrapper ）中重新实现（复制和粘贴）* *dumpObjectInfo2* () 和*dumpObjectTree2* () 中的那些方法，删除那些调试预处理器保护。

 **** * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-08-10T12:58:58.537

以下代码使用指向该类的指针访问和修改该类的私有成员。

```
#include <iostream>
using namespace std;
class A
{
    int private_var;
    public:
    A(){private_var = 0;}//initialized to zero.
    void print(){cout<<private_var<<endl;}
};

int main()
{
    A ob;
    int *ptr = (int*)&ob; // the pointer to the class is typecast to a integer pointer.  
    (*ptr)++; //private variable now changed to 1.
    ob.print();
    return 0;
}
/*prints 1\. subsequent members can also be accessed by incrementing the pointer (and
  type casting if necessary).*/ 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-09-18T18:11:30.710

仅用于学习目的....试试这个....可能会有所帮助我猜.....这个程序可以通过知道值来访问私人数据......

```
//GEEK MODE....;)
#include<iostream.h>
#include<conio.h>

    class A
    {
    private :int iData,x;
    public: void get()             //enter the values
        {cout<<"Enter iData : ";
            cin>>iData;cout<<"Enter x : ";cin>>x;}

        void put()                               //displaying values
    {cout<<endl<<"sum = "<<iData+x;}
};

void hack();        //hacking function

void main()
{A obj;clrscr();
obj.get();obj.put();hack();obj.put();getch();
}

void hack()         //hack begins
{int hck,*ptr=&hck;
cout<<endl<<"Enter value of private data (iData or x) : ";
cin>>hck;     //enter the value assigned for iData or x
for(int i=0;i<5;i++)
{ptr++;
if(*ptr==hck)
{cout<<"Private data hacked...!!!\nChange the value : ";
cin>>*ptr;cout<<hck<<" Is chaged to : "<<*ptr;
return;}
}cout<<"Sorry value not found.....";
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-07-22T21:36:46.490

受@Johannes Schaub - litb 的启发，以下代码可能更容易理解。

```
 struct A {
    A(): member(10){}
    private:
    int get_member() { return member;}
    int member;
   };

   typedef int (A::*A_fm_ptr)();
   A_fm_ptr  get_fm();

  template<   A_fm_ptr p> 
  struct Rob{ 
     friend A_fm_ptr  get_fm() {
   return p;
  }
};

 template struct Rob<  &A::get_member>;

 int main() {
   A a;
  A_fm_ptr p = get_fm();

    std::cout << (a.*p)() << std::endl;

  } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-04-20T02:53:02.570

好吧，有了指针偏移，这很容易。困难的部分是找到偏移量：

### 其他.hpp

```
class Foo
{
  public:
    int pub = 35;

  private:
    int foo = 5;
    const char * secret = "private :)";
}; 
```

### 主文件

```
#include <iostream>
#include <fstream>
#include <string>
#include <regex>

#include "other.hpp"

unsigned long long getPrivOffset(
  const char * klass,
  const char * priv,
  const char * srcfile
){

  std::ifstream read(srcfile);
  std::ofstream write("fork.hpp");
  std::regex r ("private:");
  std::string line;
  while(getline(read, line))
    // make all of the members public
    write << std::regex_replace(line, r, "public:") << '\n';
  write.close();
  read.close();
  // find the offset, using the clone object
  std::ofstream phony("phony.cpp");
  phony << 
  "#include <iostream>\n"
  "#include <fstream>\n"
  "#include \"fork.hpp\"\n"
  "int main() {\n";
  phony << klass << " obj;\n";
  // subtract to find the offset, the write it to a file
  phony << 
  "std::ofstream out(\"out.txt\");\n out <<   (((unsigned char *) &(obj." 
<< priv << ")) -((unsigned char *)   &obj)) << '\\n';\nout.close();";
  phony << "return 0;\n}";
  phony.close();
  system(
    "clang++-7 -o phony phony.cpp\n"
    "./phony\n"
    "rm phony phony.cpp fork.hpp");
  std::ifstream out("out.txt");
  // read the file containing the offset
  getline(out, line);
  out.close();
  system("rm out.txt");
  unsigned long long offset = strtoull(line.c_str(), NULL, 10);
  return offset;
}

template <typename OutputType, typename Object>
OutputType hack(
  Object obj, 
  const char * objectname,
  const char * priv_method_name,
  const char * srcfile
  ) {
  unsigned long long o = getPrivOffset(
    objectname, 
    priv_method_name, 
    srcfile
  );
  return *(OutputType *)(((unsigned char *) (&obj)+o));
}
#define HACK($output, $object, $inst, $priv, $src)\
hack <$output, $object> (\
  $inst,\
  #$object,\
  $priv,\
  $src)

int main() {
  Foo bar;
  std::cout << HACK(
    // output type
    const char *, 
    // type of the object to be "hacked"
    Foo,
    // the object being hacked
    bar,
    // the desired private member name
    "secret",
    // the source file of the object's type's definition
    "other.hpp"
    ) << '\n';
  return 0;
} 
```

```
clang++ -o main main.cpp
./main 
```

输出：

```
private :) 
```

你也可以使用`reinterpret_cast`.

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-10-05T11:20:54.703

也许一些指针算术可以做到这一点

```
#pragma pack(1)
class A
{
    int x{0};
    char c{0};
    char s[8]{0};

    public:
    void display()
    {
        print(x);
        print(c);
        print(s);
    }; 
};

int main(void)
{
    A a;

    int *ptr2x = (int *)&a;
    *ptr2x = 10;

    char *ptr2c = (char *)ptr2x+4;
    *ptr2c = 'A';

    char *ptr2s = (char *)ptr2c+1;
    strcpy(ptr2s ,"Foo");

    a.display();
} 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2014-09-11T02:25:31.173

```
class Test{
    int a;
    alignas(16) int b;
    int c;
};

Test t; 
```

**方法A：侵入性情绪。** 由于我们可以访问源代码并重新编译它，我们可以使用许多其他方式，如朋友类来访问私有成员，它们都是合法的后门。

**方法B：粗暴的心情。**

```
int* ptr_of_member_c = reinterpret_cast<int*>(reinterpret_cast<char*>(&t) + 20); 
```

我们使用一个幻数 (20) ，它并不总是正确的。当 Test 类的布局发生变化时，幻数是一个很大的 bug 来源。

**方法C：超级黑客的心情。** 有没有非侵入性和非暴力的情绪？由于Test类的布局信息被编译器隐藏，我们无法从编译器口中获取偏移信息。前任。

```
offsetof(Test,c); //complie error. they said can not access private member. 
```

我们也无法从类 Test 中获取成员指针。前任。

```
&Test::c ;  //complie error. they said can not access private member. 
```

@Johannes Schaub - litb 有一个博客，他找到了一种窃取私有成员指针的方法。但我认为这应该是编译器的错误或语言陷阱。我可以在 gcc4.8 上编译它，但不能在 vc8 编译器上编译。

**所以结论可能是：** 楼主都建了后门。小偷总是有蛮横的闯入方式。黑客意外地以优雅而自动化的方式闯入。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2021-04-24T11:50:25.533

我让[约翰内斯的回答](https://stackoverflow.com/a/3173080/8176989)更笼统。您可以在此处获取源代码：[https](https://github.com/lackhole/Lupin)
://github.com/lackhole/Lupin 您所需要知道的只是类的名称和成员。

你可以使用喜欢，

```
#include <iostream>

#include "access/access.hpp"

struct foo {
 private:
  std::string name = "hello";
  int age = 27;
  void print() {}
};

using tag_foo_name = access::Tag<class foo_name>;
template struct access::Accessor<tag_foo_name, foo, decltype(&foo::name), &foo::name>;

int main() {
  foo f;

  // peek hidden data
  std::cout << access::get<tag_foo_name>(f) << '\n'; // "hello"

  // steal hidden data
  access::get<tag_foo_name>(f) = "lupin";
  std::cout << access::get<tag_foo_name>(f) << '\n'; // "lupin"
} 
```

调用私有函数，获取私有成员的类型也可以只使用标签。

# c++ - 我应该为分发构建什么样的代码库？

> ID：424105
> 
> 赞同：1
> 
> 时间：2009-01-08T12:46:40.237
> 
> 标签：c++, com, dll, vb6, ocx

我需要构建一个 C++ 库来分发给我们的客户。该库必须能够从多种语言访问，包括 VB6、C++、VB.net 和 C#。

到目前为止，我一直在使用 ActiveX 控件（ocx 文件）。但我想知道是否有更好的库（dll 等）可以构建。你有什么建议吗？

我仅限于 C++ 作为库语言，但您可以提及其他语言以供其他开发人员参考。

PS对不起，如果这个问题已经被问到了。我很难找到合适的标题。随时纠正我的英语。

**编辑：**似乎最好的选择是 DLL 或 OCX（即 COM），但我仍然对我将选择哪一个存有疑问。哪一种更适合现代语言（例如 .NET）？从最终开发人员的角度来看，哪一个更容易使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T12:58:27.560

几乎每种语言都有一种加载动态库和从它们访问导出的 C 函数的方法。

没有什么可以阻止您在 dll 中使用 C++，但为了获得最大的可移植性，请仅导出 C 函数。[我在这篇文章](https://stackoverflow.com/questions/62398/middleware-api-best-practices-what-are-they#71496)中有更多关于这个的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:06:38.450

如果您正在考虑同时支持 VB6 和 .NET，那么您几乎无法通过 COM 公开接口，但至少这将使您不必基于您的语言/运行时系统创建多个包装器'正在尝试与之互动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T11:19:35.017

如果有任何可能需要将其移植到非 Windows 平台，那么 DLL / 共享库是您的最佳选择，因为 COM 对象实际上根本无法移植。

此外，您几乎可以从任何平台调用 DLL，即使它需要您编写某种包装器。将 dll 包装在 com 对象中非常容易，但如果您制作本机 com 对象，则添加 C 风格的 DLL API 会困难得多。另外，您可能想从 java 中调用它，并且编写 JNI 包装器来调用您的 DLL 比让它以任何类型的跨平台方式与 COM 一起工作要容易得多。

真的，这取决于您真正需要从哪些平台调用它，以及您能确定您将来不会得到不寻常的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T12:50:11.977

要从所有这些语言中调用，您唯一真正的选择是 COM，而不必在需要的地方编写包装器（这会破坏这一点）

# java - 如何从 Java 生成 RTF？

> ID：424119
> 
> 赞同：9
> 
> 时间：2009-01-08T12:52:26.870
> 
> 标签：java, xml, xslt, rtf

我在一个基于网络的工具上工作，我们提供定制的打印。

目前我们使用 Java 构建 XML 结构，将其与定制的 XSL-FO 一起提供给[XMLmind XSL-FO 转换器](http://www.xmlmind.com/foconverter/)，然后生成一个 RTF 文档。

这适用于简单的布局，但在一些问题区域我想要更好的控制，或者我根本无法做我想做的事情。F.ex：页眉、页脚（例如页码）、列中的表格，在第一页上有单独的列设置或不同的页码信息等。

你们有谁知道更好的替代方案，无论是XMLmind 还是我们从数据到RTF 的方式，即Java-> XML、XML+XSL-> RTF？（对我们来说唯一的实际限制是 JVM。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-07-10T06:26:15.547

您可以查看一个名为[jRTF](http://code.google.com/p/jrtf/)的新库。它允许您创建新的 RTF 文档并填充 RTF 模板。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T13:06:14.063

你看过[iText](http://www.lowagie.com/iText/)库吗？它主要被吹捧为 PDF 生成器，尽管它也[可以生成 RTF](http://itextdocs.lowagie.com/tutorial/rtf/index.php)。我没有理由亲自使用它，但我得到的总体感觉是它很好，界面看起来很全面，很容易抽象。它是否适合您现有的数据模型是另一个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T14:00:35.717

如果您有能力花一些钱，您可以使用[Aspose.Words](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)，这是一个用于为 Java 和 .NET 创建 Word 和 RTF 文档的专业库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T13:03:11.013

[iText](http://www.lowagie.com/iText/)支持 RTF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T21:48:14.627

```
import com.lowagie.text.*;
import com.lowagie.text.html.simpleparser.HTMLWorker;
import com.lowagie.text.html.simpleparser.StyleSheet;
import com.lowagie.text.rtf.*;

import java.io.*;
import java.util.ArrayList;

public class HTMLtoRTF {
    public static void main(String[] args) throws DocumentException {
        Document document = new Document();

        try {
            Reader htmlreader = new BufferedReader((new InputStreamReader((new FileInputStream("C:\\Users\\asrikantan\\Desktop\\sample.htm")))));

            RtfWriter2 rtfWriter = RtfWriter2.getInstance(document, new FileOutputStream(("C:\\Users\\asrikantan\\Desktop\\sample12.rtf")));
            document.open();
            document.add(new Paragraph("Testing simple paragraph addition."));
            //ByteArrayOutputStream out = new ByteArrayOutputStream();

            StyleSheet styles = new StyleSheet();
            styles.loadTagStyle("body", "font", "Bitstream Vera Sans");
            ArrayList htmlParser = HTMLWorker.parseToList(htmlreader, styles);
            //fetch HTML line by line

            for (int htmlDatacntr = 0; htmlDatacntr < htmlParser.size(); htmlDatacntr++) {
                Element htmlDataElement = (Element) htmlParser.get(htmlDatacntr);
                document.add((htmlDataElement));
            }
            htmlreader.close();
            document.close();

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (Exception e) {
            System.out.println(e);
        }
    }
} 
```

# c - Windows API 和 C 运行时库有什么关系？

> ID：424123
> 
> 赞同：5
> 
> 时间：2009-01-08T12:53:13.840
> 
> 标签：c, winapi

Windows API 和 C 运行时库有什么关系？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T13:00:34.560

如果您指的是标准 C 库（我假设为 msvcrt.dll）。然后一点也不多。大多数 Windows API 是在单独的 dll 中实现的（大部分都在 user32.dll 或 kernel32.dll 中）。事实上，Windows API 中的一些函数只是围绕系统调用的瘦包装器，实际工作在内核本身中完成。

此外，正如[ocdecio](https://stackoverflow.com/questions/424123/what-is-the-relationship-between-the-windows-api-and-the-c-run-time-library#424138)所说，假设 C 标准库的某些部分是使用 Windows API 实现的，这是完全合理的。对于某些情况，例如字符串操作，反之亦然。

编辑：由于哪些 dll 是根据其他人实现的，因此受到质疑，我检查了依赖 walker，这是我的发现：

```
kernel32.dll depends on:
  ntdll.dll

user32.dll depends on:
  gdi32.dll
  kernel32
  ntdll.dll
  advapi.dll
  msimg32.dll
  powerprof.dll (this dll references msvcrt.dll for some string functions)
  winsta.dll

msvcrt.dll depends on:
  kernel32.dll (yes it does have imports for CreateFileA)
  ntdll.dll 
```

基于此，我相信 msvcrt 是建立在 win32 API 之上的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T13:02:26.693

简而言之：Windows API 包含专门为 Windows 定义的所有函数。C 运行时库包含标准 C 所需的所有函数。

实现这些功能的物理库可能是单个文件（库），拆分为两个独立的库或拆分为多个库，具体取决于操作系统和您使用的实际 API/服务。

例如，在创建文件时，C 标准包含以下函数：

`fopen`

打开和创建文件等，而 Win32 API（例如）定义了如下函数：

`CreateFile`

创建和操作文件。第一个将在标准 C 运行时库可用的地方可用，而第二个将仅在支持 Win32 API 的 Windows 机器上可用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T13:02:48.690

Win32 与 CRT 完全不同。

当您使用 C 或 C++ 函数/特性（例如 printf 或 cout）时，需要将 CRT 链接到您的项目中。

Win32 是一组库，当您使用 Windows 功能（如 GetWindowText）时，需要将其链接到您的项目中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T13:05:41.023

它们是什么：

*   Windows API 是 Microsoft Windows[TM] 操作系统导出的 API
*   C 运行时库是由编译器供应商随 C 编译器一起提供的“标准库”，可在编译器所针对的任何/任何操作系统（例如 Unix）上使用

他们的关系是什么：

*   它们是不同的，但都同样可用于在 Windows 上运行的 C++ 应用程序
*   在 Windows 上，C 标准库是通过调用底层 Windows API（分配内存、打开文件等）来实现的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:42:14.780

C run time library is based on the Windows API

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-08T13:12:17.283

Unix System calls are analogy with Windows API.

# asp.net - 使用 JQuery 作为 ASP.NET 嵌入式网络资源

> ID：424124
> 
> 赞同：9
> 
> 时间：2009-01-08T12:53:26.400
> 
> 标签：asp.net, jquery, embedded-resource, webresource

我有一个 ASP.NET 服务器控件，它依赖于 JQuery 来实现某些功能。我试图添加为网络资源。

我的问题是我包含 jquery 文件的方法将其添加到正文，或者确切地说是表单：

```
this.Page.ClientScript.RegisterClientScriptInclude(...) 
```

对此的替代方法是将其作为文字添加到 head 标签中：

```
LiteralControl include = new LiteralControl(jslink);
this.Page.Header.Controls.Add(include); 
```

然而，这个问题是头部中任何使用 JQuery 的现有代码 src 都失败，因为 JQuery 是在之后加载的（ASP.NET 在控制树的底部添加了文字）。

有没有一种实用的方法让 JQuery 成为嵌入式资源，但首先加载到头部？还是我现在应该放弃。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T14:37:49.480

如果您想打包 jQuery 并将其嵌入到您自己的服务器控件中，您应该使用 ScriptManager 将其提供给客户端。从我的头上，你必须：

1.  将 jQuery.js 添加到您的项目中
2.  在其“构建操作”属性下，使其成为嵌入式资源
3.  在您的控件的 AssemblyInfo.cs 中添加

    ```
    [assembly: WebResource("<Your Server Control namespace>.jQuery.js", "application/x-javascript")] 
    ```

4.  使您的控件继承自 [System.Web.UI.ScriptControl](http://msdn.microsoft.com/en-us/library/system.web.ui.iscriptcontrol.aspx)（或至少实现[IScriptControl](http://msdn.microsoft.com/en-us/library/system.web.ui.iscriptcontrol.aspx)）

5.  覆盖 GetScriptReferences：

    ```
    protected override IEnumerable<ScriptReference>
    GetScriptReferences()
    {
    return new ScriptReference[] { 
        new ScriptReference("<Your Server Control namespace>.jQuery.js", this.GetType().Assembly.FullName),
    };
    } 
    ```

您自己的所有客户端脚本都应该在里面设置：

```
protected override IEnumerable<ScriptDescriptor> GetScriptDescriptors() 
```

这将确保依赖关系的正确顺序（即 jQuery 将可用于您自己的客户端脚本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T00:03:18.337

**更新：**

一个更简单的方法是简单地在脚本中动态添加脚本标签并指向谷歌代码托管。例如

```
function include_dom(script_filename) {
    var html_doc = document.getElementsByTagName('head').item(0);
    var js = document.createElement('script');
    js.setAttribute('language', 'javascript');
    js.setAttribute('type', 'text/javascript');
    js.setAttribute('src', script_filename);
    html_doc.appendChild(js);
    return false;
}

include_dom("http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"); 
```

函数取自[这篇文章](http://www.phpied.com/javascript-include/)

* * *

Crecentfresh 把我推向了正确的方向，我也发现

[http://en.csharp-online.net/Creating_Custom_ASP.NET_AJAX_Client_Controls—IScriptControl.GetScriptReferences_Method](http://en.csharp-online.net/Creating_Custom_ASP.NET_AJAX_Client_Controls%E2%80%94IScriptControl.GetScriptReferences_Method)。

My problem still remains though, the ScriptManager adds the references after the script in the head but I think this is an issue that can't be resolved. I've opted to answer myself but also upvoted crescentfresh.

# xml - 创建 xmlns:xsi 命名空间和属性

> ID：424148
> 
> 赞同：10
> 
> 时间：2009-01-08T13:03:41.137
> 
> 标签：xml, xslt, xml-namespaces

我想创建以下元素：

```
<exercises xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mySchema.xsd"> 
```

如果我使用这样的东西：

```
<xsl:element name="excercises">
<xsl:attribute name="xmlns:xsi" namespace="http://www.w3.org/2001/XMLSchema-instance"/> 
```

然后它会创建这样的东西：

```
<excercises xp_0:xsi="" xmlns:xp_0="http://www.w3.org/2001/XMLSchema-instance"> 
```

这看起来不像我想要的......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T14:14:23.817

请尝试以下操作：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:apply-templates select="xml"></xsl:apply-templates>
    </xsl:template>

    <xsl:template match="xml">
        <xsl:element name="exercises">
            <xsl:attribute name="xsi:noNamespaceSchemaLocation">mySchema.xsd</xsl:attribute>
            some value
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

关键问题是在声明中声明 xsi 命名空间。

我只是为了测试而制作了模板匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:16:41.520

**这是如何做到的**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 exclude-result-prefixes="xsi">
    <xsl:output omit-xml-declaration="yes"/>
    <!--                                   -->
    <xsl:template match="/">
      <exercises  xsi:noNamespaceSchemaLocation="mySchema.xsd"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于**任何源 XML 文档（未使用）时，将产生所需的结果：

```
<exercises xsi:noNamespaceSchemaLocation="mySchema.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" /> 
```

**`<xsl:attribute>`在您的情况下没有必要使用它**，但是如果有必要，它可以毫无问题地使用：

```
 <xsl:attribute name="xsi:noNamespaceSchemaLocation">
      <xsl:value-of select="'mySchema.xsd'"/>
    </xsl:attribute> 
```

**请注意，在`<xsl:stylesheet>`元素**上简单地定义必要的命名空间是一种很好的做法，这样它们就可以在需要的任何地方轻松（重）使用。如果在多个生成的元素或属性上需要给定的命名空间，这将特别有用。

**[`exclude-result-prefixes`](http://www.w3.org/TR/xslt#literal-result-element)在这种情况下，最好在属性值中指定所有此类前缀，**这样命名空间不会自动传播到所有文字结果元素上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T14:21:50.713

你可以简单地使用： -

```
<exercises xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mySchema.xsd"> 
```

直接在您的 XSL 中，这会起作用，如果不能硬编码标签名称，您只需要 xsl:element。与属性类似，您可以直接添加它们，除非您需要设置条件。

# asp.net - ViewState 或 HiddenField

> ID：424151
> 
> 赞同：7
> 
> 时间：2009-01-08T13:05:30.400
> 
> 标签：asp.net, viewstate, hidden-field

如果我有一段简单的数据要存储（例如整数或字符串），我可能会选择将其存储在 ViewState 中，或者使用 HiddenField 控件。

为什么我会选择一个而不是另一个？

视图状态

*   用户难以解码（认为并非不可能），这可能是可取的

隐藏场

*   值可以在 JavaScript 中使用

还有其他优点和缺点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T13:27:59.810

并非如此，ViewState 实际上存储在隐藏字段中，因此唯一真正的区别是编码。

除非您需要使用 JavaScript 操作该值，或者您希望完全关闭此页面上的 ViewState，否则我会使用 ViewState。主要是因为有第三方工具（[比如这个](http://www.strangeloopnetworks.com/products/AS1000/)）可以理解 ViewState 并且不会理解您的自定义隐藏字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T13:56:25.290

从可维护性的角度来看，我会使用 ViewState。您编写的代码更少，这归结为软件中的故障点更少。这也意味着任何追随您的开发人员都可以更轻松地维护您的解决方案。

如果您对此并不完全满意，请在页面上编写一个属性访问器，作为外观来从 ViewState 中检索值。稍后，如果您觉得有必要将其转换为隐藏字段，则访问器可以在其余代码中无缝地处理该开关。请务必记录您这样做的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-17T20:39:27.927

Viewstate 仅适用于您所在的页面或发回的页面。使用隐藏字段，您可以使用 Page 对象的 PreviousPage 方法访问您导航到的下一页上的数据（以及其他数据），如下所示：

```
string term = ((TextBox)Page.PreviousPage.FindControl("txtSearchTerm")).Text; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T13:41:45.007

ViewState 存储在页面本身中，因此会增加页面大小并可能导致[性能问题](http://msdn.microsoft.com/en-us/magazine/cc163854.aspx)。

我们还可以将应用程序配置为[将视图状态保存在服务器上](http://msdn.microsoft.com/en-us/magazine/cc188774.aspx)而不是页面本身上，这可能会避免一些安全问题。

约米特

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T06:46:46.863

隐藏字段在页面上是不可见的，它们的值可以在视图源中查看，但视图状态的值已编码并且不可读。

隐藏字段值发布在下一页。（注意：使用 server.transfer 获取隐藏字段的值）。

# .net - 带有确认电子邮件的 ASP.NET 成员资格提供程序

> ID：424154
> 
> 赞同：17
> 
> 时间：2009-01-08T13:06:20.150
> 
> 标签：.net, asp.net, authentication, asp.net-membership

是否有任何框架/库用于使用带有确认电子邮件的 ASP.NET 成员资格提供程序，可以使用的东西？

几乎所有公共网站上使用的标准功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T14:44:02.923

找到了很好的例子：

[来自 Rolla 的 4Guys：检查 ASP.NET 2.0 的成员资格、角色和配置文件](http://aspnet.4guysfromrolla.com/articles/062508-1.aspx)

# apache - 如何通过 Apache 将结构化数据传递给我的 (F)CGI？

> ID：424175
> 
> 赞同：0
> 
> 时间：2009-01-08T13:14:38.137
> 
> 标签：apache, cgi, fastcgi

我们有一个用于身份验证的 apache 模块。如果用户能够进行身份验证，则`REMOTE_USER`环境变量将设置为他们的用户名，他们访问的任何 CGI 都可以使用该用户名。

我想添加一个功能/模块，以便我们可以从 LDAP 数据源获取有关用户的其他信息，并使其可用于 CGI 和 FCGI 应用程序。

既然我知道我们可以将信息放入环境中，那么在环境变量中存储更复杂的数据结构（例如 JSON）是否合适？这对我来说似乎很笨拙。有更好的方法吗？

如果它是语言相关的，那么我对 Perl 最感兴趣，但如果我能将这些数据提供给任何类型的 CGI 或 FCGI 应用程序，那将是最好的。我们在 RHEL 5.0（启用 SELinux）上使用 Apache 2.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T13:34:38.143

如果您需要使用 CGI，环境变量似乎是唯一的选择（使用 mod_perl，您可以访问 Apache 的内部数据结构）。

如果数据对于环境来说太大，您可以创建一个临时文件并仅传递文件名。您也可以将此信息存储在数据库中。在这两种情况下，您可能需要担心清理临时数据以及并发访问的竞争条件。

如果您已经拥有持久的服务器端会话数据（会话文件或目录或共享内存段），您可能希望将其放置在其中。

# cocoa - com.finder.desktopservices 在复制文件时要求输入管理员密码

> ID：424176
> 
> 赞同：0
> 
> 时间：2009-01-08T13:14:55.013
> 
> 标签：cocoa, macos, copying

我正在尝试将文件从我的 mac 复制到网络驱动器。复制文件时，会在目标位置创建一个空文件，并提示我可能需要输入管理员密码才能更改名为“无论我的文件名是什么”的文件。当我按继续时，密码对话框显示它是 com.apple.desktopservices 要求输入密码。

从我看到的情况来看，首先创建了一个空文件，然后提示我输入密码。输入密码后，将删除空文件并创建另一个文件。将内容写入此文件。

任何想法为什么会发生这种情况？

谢谢。

PS 文件具有完全读写权限

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T18:45:18.160

该文件是实际创建的，还是 Finder 只是为其显示一个图标？网络驱动器是哪种机器（另一台 Mac、Windows 机器、NAS？），您使用什么协议连接它？（中小企业，CIFS）？

# jsp - \\\\$在jsp模板数据中转换为\$

> ID：424180
> 
> 赞同：2
> 
> 时间：2009-01-08T13:15:30.380
> 
> 标签：jsp, escaping, quoting

我只是在我的 JSP 代码中偶然发现了一个奇怪的地方。似乎双反斜杠后跟美元或百分比符号被转换为单个反斜杠（加号）。

也就是下面的JSP：

```
<%@ page contentType="text/html;charset=UTF-8" pageEncoding="UTF-8" %>
\\#
\\$
\\%
\\^ 
```

呈现为：

```
\\#
\$
\%
\\^ 
```

我正在使用 JDK 1.6.0_02 和 Apache Tomcat 5.5.23 和 6.0.16（两台机器）。

这是Tomcat中的错误吗？JDK？或者它是否符合 JSP 规范中一些晦涩的选项？我尝试查看规范，但找不到任何有用的东西。

解决方法相当简单，我只是想我会提交一个错误以防万一。

**编辑**：嘿，stackoverflow 也破坏了反斜杠

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:14:14.137

\$ 在[规范](http://jcp.org/aboutJava/communityprocess/final/jsr152/index.html)中（第 JSP.1.6 节）。“只有当页面启用了 EL 时......，文字​​ $ 才能被 \$ 引用。

\% 可能是因为“<\% 引用了文字 <%”。我怀疑解析器没有在 \% 之前检查 <。

# .net - .NET 部署（ClickOnce 或 MSI）客户端设置/参数

> ID：424182
> 
> 赞同：2
> 
> 时间：2009-01-08T13:15:57.150
> 
> 标签：.net, deployment, clickonce

我创建了一个 Windows 窗体应用程序。我需要存储一些信息（在注册表、隔离存储或其他序列化方法中），例如 ClientID，它是从注册表生成的 GUID，然后用户可以下载当前部署 ClickOnce 的安装包。该应用程序是离线运行的，因此根据我读过的一些文章，添加查询字符串参数不是一个选项。我想在客户端下载设置之前创建一个模块来修改 config.deploy 文件，但是当多个用户同时下载应用程序时可能会导致一些问题。我还在考虑让用户在应用程序首次运行时输入电子邮件地址或任何登录信息，因此可以从 Web 服务器下载必要的信息并将其存储在客户端的计算机中，但我

我希望我已经写得足够清楚，以便我能尽快得到一些答案。任何意见/建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:37:22.733

我开发了一个纯 ClickOnce 应用程序，该应用程序有一个注册过程才能真正使用它。您无需注册即可启动应用程序，但要进入应用程序的核心，您必须使用存储在我们数据库中的数据填写一个小表格。该应用程序将注册数据（减去密码）存储在独立存储中。

随时在评论中发布问题，我会尽力跟进。

# c# - 将分钟添加到日期不会更改日期 C# .NET

> ID：424183
> 
> 赞同：2
> 
> 时间：2009-01-08T13:16:08.523
> 
> 标签：c#, datetime

双 TotalMinute=300.0 双 TotalMinutesAdded=1378.0

```
 double TotalMinute=300.0
double TotalMinutesAdded=1378.0

foreach(DataRow dr in ds.Tables[0].Rows)
                {

                    //Add The above Timings to each Row's 2nd Column
                    DateTime correctDate=Convert.ToDateTime(dr[2]);

                    correctDate.AddMinutes(TotalMinute);
                    correctDate.AddMinutes(TotalMinutesAdded);

                    dr[2]=correctDate;

                }
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-08T13:19:00.887

DateTiem Add* 函数不应更改当前的 DateTime 值。他们返回新值。

如果您希望更改您的值，请输入以下内容：

```
correctDate = correctDate.AddMinutes(TotalMinute); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T13:20:17.047

DateTime 是不可变的；AddMinutes 等函数返回一个**新**的DateTime；所以你需要捕获返回的值：

```
DateTime foo = ...
DateTime bar = foo.AddMinutes(5); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T13:24:04.217

如前所述，由于`DateTime`对象是不可变的，您必须重新分配变量。

但是，需要注意的一点是，您可以这样链接操作：

```
correctDate = correctDate.AddMinutes(TotalMinute)
                         .AddMinutes(TotalMinutesAdded); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T13:19:12.883

您必须将正确的日期变量设置为从 AddMinutes 调用返回的实例：

```
correctDate = correctDate.AddMinutes(TotalMinute); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T13:20:28.047

DateTime 是一种不可变类型，就像 String 一样。你可以像写 str = str.Replace("hello", "") 一样写 date = date.AddDays(1)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T13:20:12.553

AddMinutes() 不会更改原始 DateTime 的值。它返回一个新的 DateTime，其中包含您必须分配给变量的新值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T13:22:45.513

问题在于

```
correctDate.AddMinutes(TotalMinute); 
correctDate.AddMinutes(TotalMinutesAdded); 
```

它应该是

```
correctDate = correctDate.AddMinutes(TotalMinute); 
correctDate = correctDate.AddMinutes(TotalMinutesAdded); 
```

AddMinutes 方法返回结果，而不是将分钟添加到 correctDate

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-03T11:34:14.903

...并将当前时间添加 5 分钟到 datetime 变量：

```
dim dateFive_Minute_Time as datetime

dateFive_Minute_Time = Now.AddMinutes(5) 
```

# html - HTML Textarea 水平滚动

> ID：424192
> 
> 赞同：86
> 
> 时间：2009-01-08T13:19:28.547
> 
> 标签：html, textarea, word-wrap

我想为我的 HTML 页面中的文本区域提供水平滚动。如果我键入没有换行符的长行，则滚动应该出现而不换行。一些朋友建议使用overflow-y CSS属性，这对我不起作用。我使用的浏览器是 IE 6+ 和 Mozilla 3+。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-01-09T07:21:56.460

我想以一种不符合 W3c 的方式来做这件事，它在 IE 和 Firefox 中都可以使用，顺便说一下在 Chrome 中也可以使用。

`wrap`我添加了value属性`off`，这就是`<textarea cols=80 rows=12 wrap='off'>`我所做的。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2011-02-24T12:15:01.523

要设置不换行，您将使用：

```
white-space: nowrap; 
```

对于其他值：[https ://developer.mozilla.org/en-US/docs/Web/CSS/white-space](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)

注意：但是折旧`wrap="off"`似乎是旧版浏览器支持的唯一方法。虽然它不符合 HTML 5，但如果您针对所有浏览器，它仍然是我的首选。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2015-03-18T15:07:08.300

如果您有包含 LF 的预格式化文本，则应将其添加`white-space: pre;`到 css。这将保留文本中已经存在的新行，并且不会换行。

这适用于所有版本的 Firefox、所有基于 Webkit 的浏览器和 IE6+。

来源：[https ://developer.mozilla.org/en-US/docs/Web/CSS/white-space](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-08T13:26:04.493

试试这些：

```
overflow: scroll; 
overflow-y: scroll; 
overflow-x: scroll; 
overflow:-moz-scrollbars-vertical; 
```

还应该有一个 -moz-scrollbars-horizo​​ntal

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-06T15:42:13.197

用作`white-space: pre;`CSS 属性。

[https://developer.mozilla.org/en-US/docs/Web/CSS/white-space](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)

# security - 防止网站上的暴力登录

> ID：424210
> 
> 赞同：53
> 
> 时间：2009-01-08T13:25:38.753
> 
> 标签：security, login, brute-force

作为对最近[Twitter 劫持](http://blog.wired.com/27bstroke6/2009/01/professed-twitt.html)和[Jeff 在 Dictionary Attacks 上的帖子](http://www.codinghorror.com/blog/archives/001206.html)的回应，保护您的网站免受暴力登录攻击的最佳方法是什么？

Jeff 的帖子建议为每次尝试登录增加延迟，评论中的建议是在第二次失败尝试后添加验证码。

这两个似乎都是好主意，但你怎么知道它是什么“尝试次数”？您不能依赖会话 ID（因为攻击者每次都可以更改它）或 IP 地址（更好，但容易受到僵尸网络的攻击）。使用延迟方法简单地将其登录到用户名可以锁定合法用户（或至少使登录过程对他们来说非常慢）。

想法？建议？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-08T13:31:19.677

我认为给定帐户（1-5 分钟）的数据库持续短暂锁定期是处理此问题的唯一方法。数据库中的每个都`userid`包含一个`timeOfLastFailedLogin`和`numberOfFailedAttempts`。当`numbeOfFailedAttempts > X`你锁定几分钟。

这意味着您将有问题的`userid`问题锁定一段时间，但不是永久锁定。这也意味着您正在为每次登录尝试更新数据库（当然，除非它被锁定），这可能会导致其他问题。

亚洲至少有一个国家被 NAT'ed，所以 IP 不能用于任何事情。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-08T13:48:41.857

在我看来，有几种可能性，每种都有优缺点：

## 强制使用安全密码

*   **Pro**：将防止字典攻击
*   **缺点**：也会阻止流行，因为大多数用户无法记住复杂的密码，即使您向他们解释如何轻松记住它们。例如，通过记住句子：“我在商场里以 5 美分的价格买了 1 个苹果”会导致“Ib1Af5CitM”。

## 多次尝试后锁定

*   **Pro** : 会减慢自动化测试
*   **缺点**：很容易为第三方锁定用户
*   **缺点**：让它们在数据库中持久化可能会导致 Twitter 或类似服务等大型服务中的大量写入过程。

## 验证码

*   **优点**：它们阻止了自动化测试
*   **缺点**：他们正在消耗计算时间
*   **缺点**：会“减慢”用户体验
*   **巨大的骗局**：它们不是无障碍的

## 简单的知识检查

*   **Pro** : 会阻止自动化测试
*   **缺点**：旁观者眼中的“简单”。
*   **缺点**：会“减慢”用户体验

## 不同的登录名和用户名

*   **优点**：这是一种技术，几乎看不到，但在我看来，这是防止暴力攻击的一个很好的开始。
*   **缺点**：取决于用户对这两个名称的选择。

## 使用整个句子作为密码

*   **临**：增加可能性的可搜索空间的大小。
*   **Pro**：对于大多数用户来说更容易记住。
*   **缺点**：取决于用户的选择。

如您所见，“好的”解决方案都取决于用户的选择，这再次表明用户是链条中最薄弱的元素。

还有其他建议吗？

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-08T14:48:42.737

你可以做谷歌所做的事情。经过一定次数的尝试后，他们会显示验证码。比使用验证码几次后，您将它们锁定几分钟。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-08T14:18:43.263

我倾向于同意大多数其他评论：

*   X 次密码尝试失败后锁定
*   对用户名的失败尝试计数
*   可选择使用 CAPTCHA（例如，尝试 1-2 是正常的，尝试 3-5 是 CAPTCHA'd，进一步的尝试被阻止 15 分钟）。
*   （可选）向帐户所有者发送电子邮件以删除阻止

我确实想指出的是，您应该非常小心地强制使用“强”密码，因为这通常意味着它们只会写在桌子上的便利贴上/连接到显示器上。此外，一些密码策略会导致**更**可预测的密码。例如：

如果密码不能是任何以前使用过的密码并且必须包含一个数字，那么它很可能是任何普通密码，后面有一个序列号。如果您必须每 6 个月更改一次密码，并且一个人已经在那里工作了两年，那么他们的密码很可能类似于*password4*。

假设您对其进行了更多限制：必须至少有 8 个字符，不能有任何连续字母，必须有字母、数字和特殊字符（这是许多人认为安全的真正密码策略）。试图闯入约翰昆西史密斯的账户？知道他是 3 月 6 日出生的吗？他的密码很有可能是*jqs0306 之类的！*（或者可能*是 jqs0306~*）。

现在，我并不是说让您的用户拥有密码*密码*也是一个好主意，只是不要自欺欺人地认为您的强制“安全”密码是安全的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-26T08:08:51.383

## 详细说明最佳实践：

krosenvold 说的：在用户表中记录 num_failed_logins 和 last_failed_time（用户被挂起时除外），一旦登录失败的次数达到阈值，你就将用户挂起 30 秒或一分钟。这是最佳实践。

该方法有效地消除了单帐户暴力破解和字典攻击。但是，它并不能阻止攻击者在用户名之间切换 - 即。保持密码固定并尝试使用大量用户名。如果您的网站有足够的用户，那么这种攻击可以持续很长时间，然后才会用完未暂停的帐户来攻击。希望他会从单个 IP 运行此攻击（虽然不太可能，因为这些天僵尸网络确实成为交易工具），因此您可以检测到并阻止 IP，但**如果他正在分发攻击......好吧，那是另一个问题（我刚刚在这里发布，所以如果您没有请检查一下）**。

关于最初的想法要记住的另一件事是，即使帐户受到攻击和暂停，您当然仍然应该尝试让合法用户通过 - 也就是说，如果您可以区分真实用户和机器人。

你可以，至少有两种方式。

1.  如果用户有一个持久登录（“记住我”）cookie，就让他通过。

2.  当您显示“对不起，由于大量登录尝试失败，您的帐户已被暂停”消息时，请包含一个链接，上面写着“***安全备份登录 - 仅限人类（机器人：不撒谎）*** ”。开个玩笑，当他们点击该链接时，给他们一个 reCAPTCHA 身份验证的登录表单，**绕过**帐户的暂停状态。这样，如果他们是人类并且知道正确的登录名和密码（并且能够读取验证码），他们将永远不会受到延迟的困扰，并且您的网站将不会受到快速攻击。

唯一的缺点：有些人（例如视力受损的人）无法阅读验证码，*如果*他们不使用自动登录功能，他们*可能*仍会受到恼人的机器人产生的延迟的影响。

 *什么不是缺点：自动登录 cookie 没有内置类似的安全措施。你问，为什么这不是一个缺点？因为只要您明智地实现了它，登录 cookie 中的安全令牌（等效密码）就是您的密码的两倍（哎呀，让它多十倍！），所以暴力破解它是实际上是一个*非问题*。但是，如果您真的很偏执，也可以在自动登录功能上设置一秒钟的延迟，以防万一。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-08T13:48:41.250

为此，您应该在与后端数据库无关*的*应用程序中实现缓存。

首先，仅延迟合法的用户名会导致您“放弃”您的有效客户群，即使用户名不是一个严密保护的秘密，这本身也可能是一个问题。

其次，根据您的应用程序，您可以使用特定于应用程序的延迟对策比将数据存储在数据库中更聪明一些。

它可以抵抗将 DOS 条件泄漏到后端数据库的高速尝试。

最后，根据 IP 做出一些决定是可以接受的……如果您看到一个 IP 的单次尝试，那么它可能是一个诚实的错误，而多个 IP 天知道您可能想要采取其他预防措施或通知最终用户有多少系统阴暗的活动。

其真正的大型代理联盟可以保留大量 IP 地址供其使用，但由于某些站点习惯于将 cookie 数据与 IP 绑定，因此大多数代理联盟确实会尽合理努力将源地址维护一段时间以用于遗留目的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-08T13:38:58.867

像大多数银行一样，在 X 次登录失败后锁定用户名/帐户。但我不会像银行那样严格，因为你必须打电话来解锁你的账户。我只会在 1-5 分钟内临时锁定。当然，除非 Web 应用程序像银行一样对数据敏感。:)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-08T13:32:05.260

我认为您应该再次登录用户名。这是唯一的常数（其他任何东西都可以被欺骗）。是的，它可以将合法用户锁定一天。但是，如果我必须在被黑帐户和关闭帐户（一天）之间进行选择，我肯定会选择锁定。

顺便说一句，在第三次尝试失败后（在一定时间内），您可以锁定帐户并向所有者发送释放邮件。该邮件包含解锁帐户的链接。这对用户来说是一个轻微的负担，但破解器被阻止了。而且，即使邮件帐户被黑客入侵，您也可以设置每天解锁次数的限制。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-05-21T22:11:07.523

这是一个旧帖子。但是，我想把我的发现放在这里，以便它可以帮助任何未来的开发人员。

我们需要防止暴力攻击，使攻击者无法获取网站登录的用户名和密码。在许多系统中，它们有一些开放式 url，不需要身份验证令牌或 API 密钥进行授权。这些 API 中的大多数都很关键。例如; 注册、登录和忘记密码 API 通常是开放的（即不需要验证身份验证令牌）。我们需要确保服务不被滥用。如前所述，我只是将我的发现放在这里，同时研究如何有效地防止暴力攻击。

这篇文章已经讨论了大多数常见的预防技术。我想补充一下我对帐户锁定和 IP 地址锁定的担忧。我认为锁定帐户作为一种预防技术是个坏主意。我在这里提出一些观点来支持我的事业。

**帐户锁定不好**

*   攻击者可以通过锁定大量帐户来导致拒绝服务 (DoS)。
*   因为您无法锁定不存在的帐户，所以只有有效的帐户名称才会锁定。攻击者可以利用这一事实从站点中获取用户名，具体取决于错误响应。
*   攻击者可以通过锁定许多帐户并用支持电话淹没帮助台来引起转移。
*   攻击者可以连续锁定同一个帐户，甚至在管理员解锁它几秒钟后，有效地禁用该帐户。
*   帐户锁定对每小时只尝试几个密码的慢速攻击无效。
*   帐户锁定对于针对大量用户名尝试使用一个密码的攻击无效。
*   如果攻击者使用用户名/密码组合列表并在前几次尝试中正确猜测，则帐户锁定无效。
*   管理员帐户等功能强大的帐户通常会绕过锁定策略，但这些帐户是最容易受到攻击的帐户。某些系统仅在基于网络的登录时锁定管理员帐户。
*   即使您锁定了一个帐户，攻击仍可能继续，消耗宝贵的人力和计算机资源。
*   例如，考虑一个拍卖网站，在该网站上，有几个竞标者为同一件物品而战。如果拍卖网站强制执行帐户锁定，一个投标人可以简单地在拍卖的最后一分钟锁定其他人的帐户，阻止他们提交任何中标的投标。攻击者可以使用相同的技术来阻止关键的金融交易或电子邮件通信。

**帐户的 IP 地址锁定也是一个坏主意**

另一种解决方案是锁定多次登录失败的 IP 地址。此解决方案的问题在于，您可能会通过阻止 ISP 或大公司使用的代理服务器来无意中阻止大量用户。另一个问题是，许多工具使用代理列表，并且只从每个 IP 地址发送几个请求，然后再继续下一个。[在http://tools.rosinstrument.com/proxy/](http://tools.rosinstrument.com/proxy/)等网站上使用广泛可用的开放代理列表，攻击者可以轻松绕过任何 IP 阻止机制。由于大多数网站在密码失败后不会阻止，因此攻击者可以对每个代理进行两次或三次尝试。拥有 1,000 个代理列表的攻击者可以尝试 2,000 或 3,000 个密码而不会被阻止。尽管如此，尽管这种方法存在弱点，但遭受大量攻击的网站，尤其是成人网站，确实会选择阻止代理 IP 地址。

**我的提议**

*   不锁定帐户。相反，我们可能会考虑在登录/注册尝试中为连续的错误尝试添加来自服务器端的故意延迟。
*   在登录尝试中基于 IP 地址跟踪用户位置，这是 Google 和 Facebook 使用的常用技术。Google 发送 OTP，而 Facebook 提供其他安全挑战，例如从照片中检测用户的朋友。
*   Google re-captcha 用于 Web 应用程序，SafetyNet 用于 Android 和适当的 iOS 移动应用程序证明技术 - 在登录或注册请求中。
*   设备 cookie
*   构建 API 调用监控系统以检测对某个 API 端点的异常调用。

**命题解释**

**故意延迟响应**

密码验证延迟显着减慢了攻击者的速度，因为攻击的成功取决于时间。一个简单的解决方案是在检查密码时注入随机暂停。在大多数合法用户登录其帐户时，即使添加几秒钟的暂停也不会打扰他们。

请注意，虽然添加延迟可能会减慢单线程攻击，但如果攻击者同时发送多个身份验证请求，则效果会降低。

**安全挑战**

这种技术可以被描述为基于用户在早期使用系统时执行的操作的自适应安全挑战。如果是新用户，此技术可能会引发默认的安全挑战。

我们可能会考虑在何时提出安全挑战？有几点我们可以做到。

*   当用户尝试从他以前不在附近的位置登录时。
*   错误的登录尝试。

用户可能面临什么样的安全挑战？

*   如果用户设置了安全问题，我们可能会考虑询问用户这些问题的答案。
*   对于 Whatsapp、Viber 等应用程序，我们可能会考虑从电话簿中获取一些随机联系人姓名，并要求输入他们的号码，反之亦然。
*   对于交易系统，我们可能会考虑向用户询问最新的交易和付款。

**API监控面板**

为 API 调用构建监控面板。

*   在 API 监控面板中查找可能表明暴力攻击或其他帐户滥用的情况。
*   从同一 IP 地址多次登录失败。
*   使用来自同一 IP 地址的多个用户名登录。
*   来自许多不同 IP 地址的单个帐户的登录。
*   一次使用造成的过度使用和带宽消耗。
*   使用按字母顺序排列的用户名或密码登录尝试失败。
*   使用黑客常用的可疑密码登录，如 ownsyou (ownzyou)、washere (wazhere)、zealots、hacksyou 等。

对于内部系统帐户，我们可能会考虑只允许从某些 IP 地址登录。如果需要锁定帐户，而不是完全锁定帐户，请将其置于功能有限的锁定模式。

这里有一些不错的读物。

*   [https://en.wikipedia.org/wiki/Brute-force_attack#Reverse_brute-force_attack](https://en.wikipedia.org/wiki/Brute-force_attack#Reverse_brute-force_attack)
*   [https://www.owasp.org/index.php/Blocking_Brute_Force_Attacks](https://www.owasp.org/index.php/Blocking_Brute_Force_Attacks)
*   [http://www.computerweekly.com/answer/Techniques-for-preventing-a-brute-force-login-attack](http://www.computerweekly.com/answer/Techniques-for-preventing-a-brute-force-login-attack)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-08T13:42:31.667

您可以添加某种形式的验证码测试。但请注意，它们中的大多数会使眼睛或听力受损的人更难接触。一种有趣的验证码形式是问一个问题，

> 2和2之和是多少？

如果你记录了最后一次登录失败，如果验证码足够老，你可以跳过验证码。如果最后一次失败是在最后 10 分钟内，则仅进行 CAPTCHA 测试。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-08T13:43:25.957

我在线登录的许多在线留言板都让我尝试登录帐户 5 次，在这 5 次尝试之后，帐户被锁定一小时或十五分钟。它可能不漂亮，但这肯定会减慢对一个帐户的字典攻击。现在没有什么可以阻止同时针对多个帐户的字典攻击。即尝试5次，切换到另一个帐户，再尝试5次，然后圈回来。但它确实会减慢攻击速度。

对字典攻击的最佳防御是确保密码不在字典中！！！基本上设置某种密码策略，根据字母检查字典并要求密码中包含数字或符号。这可能是对字典攻击的最佳防御。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-22T19:32:53.300

对于 .NET 环境

## [动态 IP 限制](http://www.iis.net/download/DynamicIPRestrictions)

IIS 的动态 IP 限制扩展为 IT 专业人员和主机提供了一个可配置的模块，该模块通过临时阻止遵循以下模式的 HTTP 客户端的 Internet 协议 (IP) 地址来帮助减轻或阻止拒绝服务攻击或通过暴力破解密码有利于其中一种攻击。可以配置此模块，以便可以在 Web 服务器或网站级别进行分析和阻止。

## 通过动态阻止来自恶意 IP 地址的请求来减少拒绝服务攻击的机会

IIS 的动态 IP 限制允许您通过检查请求的源 IP 并识别可能发出攻击信号的模式来降低 Web 服务器遭受拒绝服务攻击的可能性。当检测到攻击模式时，模块会将有问题的 IP 放入临时拒绝列表中，并在预定时间内避免响应请求。

## 将暴力破解您的 Web 服务器密码的可能性降至最低

IIS 的动态 IP 限制能够检测指示尝试解码 Web 服务器密码的请求模式。该模块会将有问题的 IP 放置在预定时间内被拒绝访问的服务器列表中。在针对 Active Directory 服务 (ADS) 进行身份验证的情况下，该模块能够通过避免向 ADS 发出身份验证质询来维持 Web 服务器的可用性。

## 特征

*   无缝集成到 IIS 7.0 管理器中。

*   根据以下任一条件动态阻止来自 IP 地址的请求：

    *   并发请求数。

    *   一段时间内的请求数。

*   支持允许绕过动态 IP 限制过滤的 IP 列表。

*   请求的阻止可以在网站或 Web 服务器级别进行配置。

*   可配置的拒绝操作允许 IT 管理员指定将返回给客户端的响应。模块支持返回状态码 403、404 或关闭连接。

*   支持 IPv6 地址。

*   支持可能修改客户端 IP 地址的代理或防火墙后面的 Web 服务器。

[http://www.iis.net/download/DynamicIPRestrictions](http://www.iis.net/download/DynamicIPRestrictions)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-12-22T06:25:37.147

旧帖子，但让我在 2016 年底发布我所拥有的内容。希望它仍然可以提供帮助。

这是一种简单的方法，但我认为防止登录攻击很强大。至少我总是在我的每个网站上使用它。我们不需要 CAPTCHA 或任何其他第三方插件。

当用户第一次登录时。我们创建一个像

```
$_SESSION['loginFail'] = 10; // any number you prefer 
```

如果登录成功，那么我们将销毁它并让用户登录。

```
unset($_SESSION['loginFail']); // put it after create login session 
```

但是如果用户失败，我们通常会向他们发送错误消息，同时我们将会话减少 1 ：

```
$_SESSION['loginFail']-- ; // reduce 1 for every error 
```

如果用户失败 10 次，那么我们会将他们引导到其他网站或任何网页。

```
if (!isset($_SESSION['loginFail'])) { 

     if ($_SESSION['login_fail'] < 1 ) {

     header('Location:https://google.com/'); // or any web page

     exit();

}
} 
```

通过这种方式，用户无法再打开或进入我们的登录页面，因为它已重定向到其他网站。

用户必须关闭浏览器（以销毁我们创建的会话 loginFail），“再次”打开它以“再次”看到我们的登录页面。

有帮助吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-07-26T11:50:26.837

有几个方面需要考虑以防止暴力破解。考虑给定的方面。

1.  密码强度

    强制用户创建密码以满足特定条件

    *   密码应至少包含一个大写、小写、数字和符号（特殊字符）。
    *   密码应具有根据您的标准定义的最小长度。
    *   密码不应包含用户名或公共用户 ID。

    通过创建最小密码强度策略，暴力破解将花费时间来猜测密码。同时，您的应用程序可以识别并迁移它。

2.  重新验证码

    您可以使用 reCaptcha 来防止机器人脚本具有暴力破解功能。在 Web 应用程序中实现 reCaptcha 相当容易。您可以使用[Google reCaptcha](https://www.google.com/recaptcha/intro/v3.html)。它有多种 reCaptcha 风格，例如 Invisible reCaptcha 和 reCaptcha v3。

3.  动态 IP 过滤策略

    如果该模式与攻击向量标准匹配，您可以动态识别请求模式并阻止 IP。过滤登录尝试的最流行的技术之一是`Throttling`. 阅读[使用 php 的节流技术](http://codedevelopr.com/articles/throttle-user-login-attempts-in-php/)以了解更多信息。良好的动态 IP 过滤策略还可以保护您免受`DoS`和`DDos`. 但是，这无助于预防`DRDos`。

4.  CSRF 预防机制

    被`csrf`称为`cross-site request forgery`。表示其他站点正在您的 PHP 脚本/控制器上提交表单。`Laravel`有一个非常明确的方法来防止`csrf`. 但是，如果您不使用这样的框架，则必须设计自己的`JWT`基于 csrf 的预防机制。如果您的网站受 CSRF 保护，则没有机会对您网站上的任何表单进行暴力破解。就像你关闭的大门一样。

# sql - SQL“EXISTS”使用变体的性能

> ID：424212
> 
> 赞同：25
> 
> 时间：2009-01-08T13:27:50.307
> 
> 标签：sql, sql-execution-plan

下面三个 SQL 语句的性能有什么区别吗？

```
SELECT * FROM tableA WHERE EXISTS (SELECT * FROM tableB WHERE tableA.x = tableB.y)

SELECT * FROM tableA WHERE EXISTS (SELECT y FROM tableB WHERE tableA.x = tableB.y)

SELECT * FROM tableA WHERE EXISTS (SELECT 1 FROM tableB WHERE tableA.x = tableB.y) 
```

它们都应该工作并返回相同的结果集。但是，如果内部 SELECT 选择 tableB 的所有字段、一个字段或只是一个常量，这有关系吗？

当所有语句表现相同时，是否有任何最佳实践？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-11-06T21:51:57.343

关于 EXISTS 子句的事实是 SELECT 子句不在 EXISTS 子句中评估 - 您可以尝试：

```
SELECT * 
  FROM tableA 
 WHERE EXISTS (SELECT 1/0 
                 FROM tableB 
                WHERE tableA.x = tableB.y) 
```

...并且应该期望除以零错误，但您不会因为它没有被评估。这就是为什么我的习惯是在 EXISTS 中指定 NULL 以证明 SELECT 可以被忽略：

```
SELECT * 
  FROM tableA 
 WHERE EXISTS (SELECT NULL
                 FROM tableB 
                WHERE tableA.x = tableB.y) 
```

EXISTS 子句中最重要的是 FROM 和 Beyond 子句 - WHERE、GROUP BY、HAVING 等。

这个问题没有考虑到数据库，这应该是因为供应商处理事情的方式不同 - 所以测试并检查解释/执行计划以确认。版本之间的行为可能会发生变化......

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-08T14:46:14.207

绝对是#1。它“看起来”很吓人，但要意识到优化器会做正确的事情并且表达意图。如果一个人意外地认为 EXISTS 但输入 IN，还有一个轻微的错字奖励。#2 是可以接受的，但没有表现力。在我不那么谦虚的意见中，第三个选项很臭。这太接近于说“如果'不存在'价值'”以获得舒适感。

一般来说，重要的是不要害怕编写看起来效率低下的代码，如果它提供其他好处并且实际上不会影响性能。

也就是说，优化器几乎总是会执行复杂的连接/选择/分组向导，以同样的方式保存一个简单的 EXISTS/子查询。

在为巧妙地从联接中重写讨厌的 OR 获得[荣誉](http://en.wiktionary.org/wiki/kudos)之后，您最终会意识到优化器仍然使用相同的糟糕执行计划来解决更容易理解的嵌入式 OR 查询。

故事的寓意是了解您的平台优化器。尝试不同的事情，看看实际做了什么，因为关于“装饰性”查询优化的猖獗的膝跳假设几乎总是不正确的，并且与我的经验无关。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-14T07:15:24.810

我意识到这是一篇旧文章，但我认为重要的是要清楚说明*为什么*人们可能会选择一种格式而不是另一种格式。

首先，正如其他人指出的那样，数据库引擎***应该***忽略 Select 子句。每个版本的 SQL Server 都有/有，Oracle 有，MySQL 有，等等。在数据库开发的许多月中，我只遇到过一个没有正确忽略 Select 子句的 DBMS：Microsoft Access。具体来说，旧版本的 MS Access（我不能说当前版本）。

在我发现这个“功能”之前，我曾经使用`Exists( Select *...`. 但是，我发现 MS Access 会流过子查询中的每一列，然后丢弃它们（`Select 1/0`也不起作用）。这说服了我切换到`Select 1`. 如果甚至一个 DBMS 是愚蠢的，那么另一个可能存在。

写作`Exists( Select 1...`在传达意图方面同样非常清晰（坦率地说，“为了安慰而说“如果'不存在'价值'太接近了”是很愚蠢的。”）并且使得 DBMS 几乎不可能用 Select 语句做一些愚蠢的事情. `Select Null`将达到相同的目的，但只是要写更多的字符。

我切换到`Exists( Select 1`绝对确保 DBMS 不会是愚蠢的。然而，那是很久以前的事了，今天我希望大多数开发人员会期望看到`Exists( Select *`哪个会完全一样。

也就是说，`Exists(Select *`即使您的 DBMS 正确评估它，我也可以提供一个很好的理由来避免它。`Select *`如果您不必在 Exists 子句中跳过其使用的每个实例，则更容易找到并击败所有使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T14:03:47.240

至少在 SQL Server 中，

可以从磁盘读取的最小数据量是磁盘空间的单个“页面”。一旦处理器读取满足子查询谓词的一条记录，它就可以停止。子查询不会像独立执行一样执行，然后包含在外部查询中，它是作为整个查询计划的一部分执行的。因此，当用作子查询时，Select 子句中的内容实际上并不重要，无论如何都不会向外部查询返回任何内容，除了表示是否找到单个记录的布尔值......

这三个都使用完全相同的执行计划

我总是使用 [Select * From ... ] 因为我认为它读起来更好，而不是暗示我想要从子查询中特别返回一些东西。

编辑：来自 dave costa 评论... Oracle 还对所有三个选项使用相同的执行计划

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T13:44:35.687

`EXISTS`返回一个*布尔值*而不是实际数据，最好的做法是使用#3。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T13:53:52.113

这是即将引发某种圣战的问题之一。

[这里](http://www.sqlservercentral.com/Forums/Topic453737-338-1.aspx)有一个相当好的讨论。

我认为答案可能是使用第三个选项，但速度提升是如此的无限小，真的不值得担心。它很容易成为 SQL Server 无论如何都可以在内部优化的查询类型，因此您可能会发现所有选项都是等效的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T14:52:16.753

[执行计划](http://www.sql-server-performance.com/tips/query_execution_plan_analysis_p1.aspx)。学习它，使用它，爱它

没有办法猜测，真的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-16T00:09:27.397

除了其他人所说的，使用的做法`SELECT 1`起源于旧的 Microsoft SQL Server（2005 年之前）——它的查询优化器不够聪明，无法避免从表中物理获取`SELECT *`. 据我所知，没有其他 DBMS 存在这种缺陷。

EXISTS 测试行的存在，而不是行中的内容，所以除了一些类似于上面的优化器怪癖之外，SELECT 列表中的内容并不重要。

这`SELECT *`似乎是最常见的，但其他人也可以接受。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-01-08T13:38:34.623

#3 应该是最好的，因为无论如何您都不需要返回的数据。带上这些字段只会增加额外的开销

# visual-c++ - 您推荐哪些标志用于 MSVC 项目中的发布配置

> ID：424218
> 
> 赞同：2
> 
> 时间：2009-01-08T13:29:49.663
> 
> 标签：visual-c++, flags, visual-studio

我正在审查我们的 MSVC 项目的标志，但我无法获得有关以下功能的足够文档：

*   使用链接时间码生成 (/ltcg)
*   启用功能级链接 (/Gy)
*   消除未引用的数据 (/OPT:REF)
*   删除冗余 COMDAT (/OPT:ICF)
*   优化 windows98 否 (/OPT:NOWIN98)
*   启用字符串池 (/GF)

我们确实使用单独的调试/发布版本，所以我主要对发布标志感兴趣。非常欢迎对这些标志以及它们如何相互关联以及您在自己的项目中使用的标志进行解释！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T14:01:11.363

在很大程度上，这取决于您从构建中寻找什么，例如，您是否有单独的发布和调试构建，如此[处](https://stackoverflow.com/questions/420343/separate-debug-and-release-builds)所述。如果您有一个组合的调试/发布版本，您将需要函数级链接才能在调试器中使用编辑和继续，这是大多数开发人员想要的。

其中，它们主要是减小可执行文件的大小。例如，如果您有两个相同的字符串字面量 char *a = "happy holiday", *b = "happy holiday"，当启用字符串池时，它们将驻留在同一块内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:35:45.693

开启 PDB

# algorithm - 确定由多个用户编辑的文本的“所有者”

> ID：424220
> 
> 赞同：21
> 
> 时间：2009-01-08T13:31:06.323
> 
> 标签：algorithm, language-agnostic, text, diff

您可能已经注意到，我们现在在社区 Wiki 帖子上显示编辑摘要：

> 社区 wiki
> 220 次修订，48 位用户

我还想向“最拥有”页面上显示的最终内容的用户显示剩余文本的百分比：

> 社区 wiki
> 220 次修订，48 位用户
> **kronoz** 87%

是的，可能有前 (n) 个“所有者”，但现在我想要前 1 个。

假设你有这个数据结构，一个用户/文本对列表，按发布时间顺序排列：

```
用户 ID 后文本
-------- ---------
12 敏捷的棕色狐狸跳过了懒惰的狗。
27 敏捷的棕色狐狸有时会跳跃。
30 我总是看到一只敏捷的棕色狐狸跳过懒惰的狗。

```

**这些用户中谁最“拥有”最终文本？**

我正在寻找一种合理的算法——它可以是一个近似值，它不必是完美的——来确定所有者。理想情况下以百分比分数表示。

请注意，我们需要考虑编辑、删除和插入，因此最终结果感觉合理且正确。您可以使用任何具有良好修订历史的 stackoverflow 帖子（不仅仅是重新标记，而是频繁的帖子正文更改）作为测试语料库。这是一个很好的版本，有来自 14 位不同作者的 15 次修订。谁是“主人”？

[https://stackoverflow.com/revisions/327973/list](https://stackoverflow.com/revisions/327973/list)

单击“查看源代码”以获取每个修订的原始文本。

我应该警告您，纯算法解决方案可能最终成为[最长公共子串问题](http://en.wikipedia.org/wiki/Longest_common_substring_problem)的一种形式。但正如我所提到的，如果它们运行良好，近似值和估计值也很好。

**欢迎使用任何语言的解决方案**，但我更喜欢以下解决方案

1.  相当容易翻译成c#。
2.  免于依赖。
3.  将简单置于效率之前。

在 SO 上发表超过 25 次修订的帖子非常罕见。但它应该“感觉”准确，所以如果你仔细观察编辑，你会同意最终决定。我鼓励您**在带有修订历史的堆栈溢出帖子上测试您的算法**，看看您是否同意最终输出。

* * *

我现在已经部署了以下近似值，您可以在 Community Wiki 帖子上的每个*新*保存的修订版本中看到它的实际效果

*   对正文更改的每个修订版进行基于[行的差异](http://www.mathertel.de/Diff/)
*   将每个修订的插入和删除行相加为“editcount”
*   每个用户 ID 都会得到他们贡献的“editcount”的总和
*   第一次修订作者获得 2x * "editcount" 作为初始分数，作为主要作者奖金
*   确定最终所有权百分比：每个用户的编辑行总数除以所有修订中的编辑行总数

（对于常见的简单条件，例如 1 个修订版、只有 1 个作者等，还有一些保护条款。基于行的差异使得重新计算所有修订版的速度相当快；在 10 个修订版的典型情况下，它约为 50 毫秒。）

这在我的测试中效果很好。当你有几个人编辑的小 1 或 2 行帖子时，它确实会有点崩溃，但我认为这是不可避免的。接受乔尔·尼利（Joel Neely）的回答在精神上与我的想法最接近，并赞成其他所有似乎可行的事情。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-08T14:41:22.577

我认为这个想法从根本上是有缺陷的。

如果有人用糟糕的拼写和不清楚的例子写了一篇精彩的分析，而我大量复制编辑它，我创造了 60% 的工作吗？显然不是；结果是一个衍生品，其中大部分价值来自初始海报。基于字符或字数的有用度量是不可能的，但需要强大的 AI 级语义分析。

除此之外，根据文章的“所有权”来寻求信用可能完全没有帮助并且是反维基的。例如，在维基百科上，假装自己拥有文章的人是最具破坏性的影响之一。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-08T13:47:07.040

之前看过你的推文。从 327973 链接的显示来看，您似乎已经有了一个单步差异。基于此，我将专注于多编辑组合：

1.  A、原发帖人拥有帖子100%的所有权。

2.  当第二张贴者B进行编辑使得例如90％的文本没有改变时，所有权是A：90％，B：10％。

3.  现在，第三方 C 更改了 50% 的文本。(A:45%, B:5%, C:50%)

    换句话说，当发布者进行编辑以使 x% 发生更改且 y = (100-x)% 未更改时，则该发布者现在拥有 x% 的文本，并且所有先前的所有权乘以 y%。

    为了让它变得有趣，现在假设......

4.  A 进行 20% 的编辑。然后 A 拥有“新”的 20%，剩余所有权现在乘以 80%，剩下（A：36%，B：4%，C：40%）。因此，“净”所有权为 (A:56%, B:4%, C:40%)。

将此应用于您的样本 (327973)，并将所有内容四舍五入到最接近的百分比：

版本 0：原始帖子。

*   保罗牡蛎：100%

版本 1：您当前的差异工具显示纯文本添加，因此所有这些字符都属于第二张海报。

*   保罗牡蛎：91%
*   一个人：9%

版本 2：差异显示替换了一个单词。新词属于第三张海报，其余文字属于之前的海报。

*   保罗牡蛎：90%
*   一个人：9%
*   博客胡子：1%

版本 3：仅标记编辑。由于您的问题是关于文本的，因此我忽略了标签。

*   保罗牡蛎：90%
*   一个人：9%
*   博客胡子：1%

版本 4：添加文本。

*   保罗牡蛎：45%
*   一个人：4%
*   博客胡子：1%
*   马克哈里森：50%

我希望这足以说明这个提议的意义。它确实有一些限制，但我将这些限制在您的声明中，即近似值是可以接受的。;-)

1.  它强行将更改的影响分配给所有先前的所有者。如果 A 发帖，B 进行纯添加，C 编辑 B 添加的一半，这种简单的方法只是将 C 的所有权应用于整个帖子，而不试图解析出哪个先前的所有权发生了最大的变化。

2.  它考虑了添加或更改，但不为删除提供任何所有权信用，因为删除器将 0% 添加到剩余文本中。您可以将其视为错误或功能。我选择了 2 号门。

**更新：**关于上面的问题 #1 的更多信息。我相信完全跟踪已编辑帖子部分的所有权需要两件事之一（网页的边距不足以提供正式证明;-)：

*   更改文本的存储方式以反映文本各个部分的所有权（例如，A 拥有单词 1-47，B 拥有单词 48-59，A 拥有单词 60-94，...），应用“剩余多少”在我的建议中对每个部分进行处理，并更新部分所有权数据。

*   考虑从第一个版本到当前版本的所有版本（实际上是动态重新计算部分所有权数据）。

所以这是一个很好的例子，在快速和肮脏的近似（以精度为代价）、对整个数据库的更改（以空间为代价）或每次计算都必须查看整个数据库之间进行权衡历史（以时间为代价）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-08T15:48:20.087

以下是我如何查看示例帖子的所有权（注意，我根本忘记在文本中添加标签，所以这里的示例中不计算简单的标签更改，但可以轻松添加）：

**打额头**：伙计，我用的是修订号而不是用户号。结果重做如下：

```
User 38193 owns 42% (922 / 2171) of the final post
User 2635 owns 28% (625 / 2171) of the final post
User 116 owns 24% (529 / 2171) of the final post
User 745 owns 3% (76 / 2171) of the final post
User 13005 owns 0% (11 / 2171) of the final post
User 18941 owns 0% (5 / 2171) of the final post
User 8562 owns 0% (3 / 2171) of the final post

53 ms 
```

所以根据我的算法，用户 38193（@Paul [Oyster](https://stackoverflow.com/users/38193/Paul%20Oyster)）拥有 42% 的帖子，而帖子 2635（[@Simucal](https://stackoverflow.com/users/2635/Simucal)）拥有 28%，用户 116（ @Mark [Harrison](https://stackoverflow.com/users/116/Mark%20Harrison)）拥有 24%，其余的可以忽略不计。

从[修订版](https://stackoverflow.com/revisions/327973/list)中，我们可以看到原作者 Paul 仍然拥有大部分问题，而 Simucal 和 Mark 获得了良好的 nr。2 和 3。这些对应于修订版 nr。1（原帖），天然橡胶。14，这是 Simucal 的一个大型编辑，看起来它很好地显示了我的算法中的缺陷（见下文），并且 nr. 5 Mark 添加了 bash 脚本的地方。

那么我是如何得出这个答案的呢？好吧，该算法有一个缺陷，但我会回到它，但它是这样的：

基本上，原始帖子中的每个字节都被分配了编写它的用户的用户 ID。然后我使用一个可以处理乱序副本的 diff 算法，然后它会带来新作者复制的字节的用户 ID。新作者添加的任何内容都被分配了新作者的用户 ID。

例如，如果原作者写了两个句子，这些将被标记为他的用户 ID。然后另一位作者对其进行了修改，并在原两句之间添加了第三句。对于 diff 算法，这看起来像是新作者复制了第一句话，添加了新数据，然后复制了第二句话。因此，这些句子将正确地归因于它们的作者。

由于 diff 算法适用于字节，因此添加缺失标点符号或字母等微小的文本更改对所有权的影响可以忽略不计，并且几乎所有原始文本仍应归属于原作者。但是，在某些情况下，由于内部优化，即使只添加了一个字节，它也会使用“添加数据”操作。该算法及其实现最初是为处理文件差异而创建的，并在文件版本之间生成尽可能小的补丁，并且有时会优化小步骤，以便将其组合成兄弟操作，如果它会减小文件大小。

算法中的*缺陷*来自回滚。我注意到 Jeff 在评论中写道不会考虑回滚，但是如果用户编辑帖子而不是将其回滚，并且只是粘贴旧内容，实际上是撤销前作者的更改，那么所有文本归因于“回滚”的人，而不是提出信息的原作者。

此实现的源代码可在[此处](http://www.vkarlsen.no/files/OwnershipTest.zip)找到，适用于 Visual Studio 2008。请注意，该解决方案不执行任何操作，例如屏幕截图或其他任何操作，并且帖子内容被硬编码到 TestData 类中的源代码中，正确转义为引号等. 要替换文本，您需要更改该文件，或者实现一种从程序外部读取内容的方法。

无论如何，这里的算法更详细一点。

* * *

1.  创建一个整数数组，只要原来的修改（其实我是通过UTF8编码成字节的，这就是我使用的长度）。*用他现在拥有 100% 修订版*的原作者的用户 ID 填充这个数组，每个字符/字节都是他的
**   将第一个修订版与下一个修订版进行比较。这种比较将产生一个操作列表。这些操作可用于获取原始修订版，对其应用操作，您将获得下一个修订版（更多内容见下文）。*   假设原始帖子是您准备的用户 id 数组（当前仅包含一堆等于第一作者 id 的值），并将操作应用于此。这将产生一个新的 id 列表，其中一些是原作者，一些是第二作者。*   保留第二个修订版和这个新的用户 id 列表，并在这个数据、下一个修订版和下一个修订版等之间运行步骤 2+3，直到你到达底部*

 *此时，您有一个用户 ID 列表，它告诉您哪个用户添加了每个字符。

比较中的操作是以下两种操作之一：

*   插入新字节
*   复制一些字节

比较结果是如何使用的，你取旧的内容（第一篇文章），并对其进行操作，然后生成下一个修订版。它基本上是一个差异。

当我将操作应用于我的用户 id 列表时，当我复制时，我只是复制，当我插入时，我总是插入一些 id 等于存储在操作中的长度。

让我举个例子吧：

原帖：

```
This is the first post 
```

下一篇：

```
This is the next post, it is based on the first post. 
```

因此，操作列表将是：

1.  复制 12 个字符 'This is the '
2.  插入“下一个”
3.  复制 5 个字符的“帖子”
4.  插入17个字符'，它基于'
5.  复制14个字符'第一篇文章'
6.  插入 1 个字符 '.'

如果我改为使用用户 ID，我将首先拥有这个数组：

```
0000000000000000000000
This is the first post 
```

现在我应用这些操作，并且对于每个插入，我插入一个 1 代替：

```
00000000000011110000011111111111111111000000000000001
This is the next post, it is based on the first post. 
```

现在我只计算我有多少个 0 和 1：

1.  0 的：31
2.  1 个：22

用户 0 拥有 31/(31+22) 个帖子，用户 1 拥有 22/(31+22) 个帖子。

换算成百分比：用户 0 拥有 58%，用户 1 拥有 42%。

现在，这个算法的问题在于回滚，以及添加丢失/删除的内容。

例如，如果您有用户 A、B 和 C，并且用户 A 发布的内容确实让用户 B 不屑一顾，那么用户 B 会进入并删除所有内容，并仅添加“这就是垃圾”。当用户 C 看到这一点时，他编辑了帖子，并添加了 A 发布的所有内容，可能还有修复。用户 C 现在拥有 100% 的帖子。

我不知道如何解决上述问题。

如果有趣的话，我将在今晚晚些时候发布执行此操作的代码。

* * *

应用于“quick brown fox”示例，将用户重新编号为 1-3，我得到以下信息：

```
User 3 owns 75% (45 / 60) of the final post
User 1 owns 25% (15 / 60) of the final post 
```

请注意，仅添加了“有时”部分（随后被删除）的用户 2 已从列表中删除。

帖子的ID如下：

```
The quick brown fox jumps over the lazy dog.
11111111111111111111111111111111111111111111 (44 = 100%)

The quick brown fox jumps, sometimes.
1111111111111111111111111222222222222 (25 / 12 ~ 68% / 32%)

I always see the speedy brown fox jumping over the lazy dog.
333333333333333333333331111111111111113333333333333333333333 (45 / 15 = 75% / 25%) 
```

* * *

算法将处理的事情：

如果我在发布新帖子时复制了某些内容，即使我现在复制了我还添加的部分，算法也会正确地归因于复制的元素。例子：

```
This is the first post, which is cool
1111111111111111111111111111111111111

This is the second post, which is the second post.
11111111111122222211111111111111112222222222111111
                               ^-- copied ------^ 
```

这个算法的唯一问题，以及这篇文章的全部内容是，我不完全确定它会产生我称之为直观公平的结果。可能是，我只是将程序组合在一起，但是可能需要对大量边缘情况进行更多测试，以确定它是否真的产生了人们会接受的东西。

另外，如果我只是从最初的帖子中转移东西，那么只有很小的部分，比如百分之几，将是我的。由于该算法本质上是一种差异算法，有时仅输出 1 或几个字节的复制操作的成本超过了仅将其原始插入的成本，因此有时它会将短字节序列视为已插入，尽管它们可能是从原始帖子中复制的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T14:39:37.777

如果我正确理解了您的问题，那么您似乎正在尝试做 IBM 不久前通过 Wikipedia 研究项目所做的事情。即，查看谁对其他用户最接受的文本的修订以及整体文本如何随时间变化。该项目的名称是[历史流](http://www.research.ibm.com/visual/projects/history_flow/index.htm)和[历史流 - 它的工作原理](http://www.research.ibm.com/visual/projects/history_flow/explanation.htm)很好地概述了他们的算法是如何工作的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T14:47:30.257

简单地计算每个人的编辑到以前版本的[Levenshtein 距离怎么样。](http://en.wikipedia.org/wiki/Levenshtein_distance)然后将每个用户的距离得分相加，计算出该用户占所有用户距离得分总和的百分比。

[这是一些计算距离的 C# 代码。](http://dotnetperls.com/Content/Levenshtein-Implementation.aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-08T13:46:56.370

在我的脑海中，我会做这样的事情：

*   我认为计算单词而不是行或字符是有道理的
*   将原始修订标记为单词，并将作者附加到每个
*   逐步浏览修订历史，并在添加单词时将作者附加到它们。
*   如果单词被删除，就忘记它们。
*   如果单词被更改，您可以将它们视为删除/插入，或者具有某种基于字符的阈值，以便拼写更正不会归因于新作者。
*   你最终会得到一个单词列表，反对最初写它们的人

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-08T13:49:23.807

如果您想实现/利用 Python 的 diff 算法，这将起作用`difflib`——在任何情况下，您都可能需要做某种 diff。此代码段将文本流失最多的用户称为获胜者。

请原谅我的硬编码。

```
#!/usr/bin/env python

import collections
import difflib
import logging
import pprint
import urllib2
import re

class OwnageDeterminer(object):

    add_coefficient = 1
    remove_coefficient = .5

    def __init__(self, edits):
        self.edits = edits
        self.counts_by_username = {}

    def __call__(self):
        edits, counts_by_username = self.edits, self.counts_by_username
        for i, edit in enumerate(edits):
            username = edit['username']
            unique_counts = {'added': 0, 'removed': 0}
            existing_text = edits[i-1]['text'] if i > 0 else ''
            new_text = edits[i]['text']
            for char_diff in difflib.ndiff(existing_text, new_text):
                if char_diff.startswith('+'):
                    unique_counts['added'] += 1
                elif char_diff.startswith('-'):
                    unique_counts['removed'] += 1
            user_counts = counts_by_username.get(username, collections.defaultdict(int))
            user_counts['removed'] += self.remove_coefficient * unique_counts['removed']
            user_counts['added'] += self.add_coefficient * unique_counts['added']
            counts_by_username[username] = user_counts
        winner = None
        winning_score = 0
        score_by_username = {}
        for username, counts in counts_by_username.iteritems():
            score = counts['removed'] + counts['added']
            if score > winning_score:
                winner = username
                winning_score = score
            score_by_username[username] = score
        logging.debug('Scores: %s', pprint.pformat(score_by_username))
        return winner

if __name__ == '__main__':
    logging.basicConfig(level=logging.DEBUG)
    site = urllib2.urlopen('http://stackoverflow.com/revisions/327973/list')
    contents = site.read()
    regex = re.compile(r'(/revisions/viewmarkup/\d+).*?/users/\d+/([\w-]+)',
                       re.MULTILINE|re.DOTALL)
    revisions = regex.findall(contents)
    print revisions
    edits = []
    for reluri, username in sorted(revisions, key=lambda t: t[0]):
        text = urllib2.urlopen('http://stackoverflow.com{0}'.format(reluri)).read()
        edit = {'username': username, 'text': text}
        edits.append(edit)
    od = OwnageDeterminer(edits)
    print od() 
```

输出：

```
DEBUG:root:Scores: {'blorgbeard': 0.5,
 'dave-markle': 0.5,
 'dbr': 1172.0,
 'gatekiller': 69.5,
 'joseph-ferris': 0.0,
 'lkessler': 0.0,
 'mark-harrison': 592.0,
 'mdb': 3.0,
 'onebyone-livejournal-com': 0.0,
 'paul-oyster': 482.0,
 'rob-wells': 0.0,
 'simucal': 1070.5,
 'skiphoppy': 0.0,
 'thesoftwarejedi': 701.0}
dbr 
```

关于复杂性的[Difflib 文档：](http://docs.python.org/library/difflib.html#module-difflib)

> 时序：基本的 Ratcliff-Obershelp 算法在最坏情况下是三次时间，在预期情况下是二次时间。SequenceMatcher 是最坏情况的二次时间，其预期情况的行为以复杂的方式取决于序列有多少共同元素；最佳情况时间是线性的。

另一个好处是这个获胜者计算是线性的，因此您可以缓存原始结果并对新编辑进行增量更新，尽管初始化负载很大。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-08T15:24:29.560

没有人拥有它。授予所有权违反了“社区维基”的精神，并可能导致适得其反的编辑战。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-08T13:58:55.393

一个问题是删除字符是否与添加字符一样有效。使用 Diff 可能效果很好，但并不总是意味着添加最多的人就是最有效的编辑器（有些人可以用 10 个字符写出其他人花一页写的内容）。

所以我认为你有两个因素：

*   变化量
*   变化的质量

因此，我很想写一些简单地将添加/删除的单词映射到分数的东西。再加上某种质量因子（这必须是一个外部参数），然后可以将组合值用于排序。

您可以根据在项目被编辑之前所花费的距离生成某种原始的“质量因子”。因此，如果我写的东西在第 12 次编辑之前没有改变，那么它就不会**太**错误（相对于质量较低的东西，一旦添加就改变了）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-09T06:03:45.523

这是一个 wiki——为什么不让每个编辑选择他或她的变化的意义呢？提供一个下拉菜单，例如...

请限定您的编辑：

1.  一些小的编辑（拼写、语法等）
    *   许多小的编辑
    *   一些重要的编辑（对特定事实、数据等的更改）
    *   许多重要的编辑
    *   一些主要的编辑（对论文、结论等的修改）
    *   许多重大修改

然后使用组合的响应来估计所有权。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-09T22:29:45.153

这个想法怎么样？

*   显示原始发布者的名称，直到帖子与原始文本的更改超过 x%
*   这个百分比显示为“x 个用户，y 个编辑，z% of original”
*   当前存在的最后一个编辑内容也可能有差异 - 例如，它清楚地表明对您的问题的第一次编辑是一个小的添加

关键是，经过一定程度的更改后，谁拥有它并不重要。我同意用户的说法，试图将“所有者”分配给 wiki 内容会适得其反。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-08T13:59:20.697

我认为字符数很棘手。

怎么样：

```
Break latest revision into a set of sentences. 
//Sentence is any text fragment surrounded by punctuation

For each Sentence
    Find which user created that sentence. 
    Add 1 to the user who created the sentence 
    Add 1 to the number of sentences

For Each user 
    % ownership = Count for that user / Number of sentences. 
```

**查找哪个用户创建了该句子。**
如果您想要完全匹配，将句子与修订版匹配很容易，但部分匹配我会更满意。

要进行此部分匹配...

从句子片段中去除常用词，并在每个修订的去除版本中搜索去除的片段。最早命中的是车主写的那句话。

**选项：（而不是常见的单词剥离）**

*   对于句子中的每个单词，将每个单词压缩为第一个和最后一个字符。这将解释拼写错误等。
*   只使用句子片段中的第一个和最后两个单词。
*   匹配 80% 的单词可能足以证明所有权。（这对计算机来说是一件困难的事情——而且它不能被缓存）

**剥离常用词**

您已经为搜索执行此操作，因此库等已经存在。即使您使用其他人的公式，您也应该在开始之前进行 CommonWordStrip 每次修订。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-08T16:26:04.597

对这个问题有一个好的解决方案的关键是获得关于编辑的额外信息。该媒体中可用的额外信息是投票和对问题的响应率。因此，如果有人进行的编辑导致问题获得大量支持、评论和回复，那么他们的编辑就非常有价值。一个全新的未回答问题可能存在特殊情况，该问题在网站上存在很长时间之前就已被编辑。

您应该使用 Levenshtein 距离算法查看帖子的更改量，然后根据投票数、评论数和编辑后问题收到的答案来衡量他们的编辑。

```
Let n = total revisions
Let m = the revision number of a poster
Let post[it] = array with text of post at revision 'it'
Let votes[it] = votes that revision 'it' received (also add bonus for comments/answers)
value = 0
for (it = m; it < n; ++it) {
  value += (Levenshtein(post[it-1], post[m]) / average_length_post) * (votes[it])
} 
```

如果您计算每个帖子的价值，则帖子的所有权是该用户所有编辑的总价值除以该帖子的所有编辑值的总和。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-08T13:38:39.973

不确定是否可能，但您可以计算添加的字符数。

例子：

*   用户 1 提交了一个 400 个字符的问题（用户 1 有 400 个字符，共 400 个字符）
*   用户 2 删除 40 并添加 60（用户 1 有 360，用户 2 有 60）

如果您恢复，您还应该恢复到以前的用户/字符数。

**但是……**也许给原海报起个名字更简单、更公平……

再想一想，我编辑了很多，但我从不认为自己是 tekst 的“所有者”，因为我只是更改了演示文稿（格式和语法）而不是内容。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-08T15:44:38.333

最初的概念必须被赋予权重。拼写更正必须具有权重。语法/结构必须被赋予权重。措辞必须有分量。简洁必须被重视。ETC...

权重是唯一公平的方法，但也无法确定。

# asp.net - 有没有办法摆脱 ASP.NET Web 部署项目中的 aspx 占位符文件？

> ID：424230
> 
> 赞同：7
> 
> 时间：2009-01-08T13:32:45.493
> 
> 标签：asp.net, deployment, web-deployment-project

我正在使用**Web 部署项目**来预编译我的**ASP.NET 3.5 Web 项目**。它为 aspx 和 ascx 文件中的代码创建一个额外的 DLL。而且，对于每个 aspx 文件，都有一个占位符 aspx 文件（空），需要将其复制到服务器。

我想简化部署过程。有没有办法（配置 IIS 站点并添加某种 http 处理程序等）来**摆脱这些 aspx 占位符**？

另外，我想知道是否有办法摆脱 bin 文件夹中的**.compiled 文件**。这将使部署过程更加顺畅。

*谢谢！*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T15:39:48.827

我自己发现的。这比我想象的要容易得多（IIS 6.0）：

在 Internet 信息管理器中转到站点的属性页，然后选择选项卡“主目录”并单击按钮“配置...”。

单击 .aspx ISAPI 扩展名的“编辑...”并**取消选中“验证该文件是否存在”**。此时，不再需要 aspx 文件。

![替代文字](https://i.stack.imgur.com/7Rzne.png)

**更新**

一件重要的事情：我必须在应用程序的根目录中创建一个空的“default.aspx”文件，以便允许像“ [http://www.example.com/](http://www.example.com/) ”这样的请求使用默认文档（不调用 aspx） .

**更新 2**

另一件非常重要的事情：如果您使用的是 ASP.NET Ajax PageMethods，那么您必须保留该页面的 aspx 占位符。如果您省略该文件，浏览器上将抛出一个 javascript *'PageMethods is undefined'错误。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T14:13:28.687

如果可能，那么它至少需要在 IIS 中将所有可能的请求映射到 asp.net 引擎。不是很困难。然后，一个 HttpHandler 应该可以拦截所有传入的请求。然后该处理程序应该能够动态加载已编译的页面类并呈现它们。您基本上将拥有一个提供页面内容的引擎 DLL。

但正如您可能已经从所有*应该*注意到的那样，这不是一件容易完成的事情，我怀疑它是否真的值得麻烦。这些占位符文件到底有什么问题？

# php - 用户认证

> ID：424232
> 
> 赞同：4
> 
> 时间：2009-01-08T13:33:27.053
> 
> 标签：php, authentication, acl

如果我要遵循开发人员在[构建公共网站](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)[*之前*](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)[应该知道什么？](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)*关于身份验证，我有什么选择？*

 *我从来没有用过 PEAR，我也不打算开始。我已经阅读了有关[phpGALC](http://phpgacl.sourceforge.net/)的信息，但还没有尝试过。

身份验证后，权限/访问级别启动。我不喜欢使用单个 tinyint 值来决定用户可以做什么和不能做什么，除了它不是很灵活。我最近编写了一个分区系统，在其中我指定了每种用户类型可以访问的访问权限，但是有更好的方法吗？

如果你想要一种语言，那么 PHP5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T13:48:41.233

ACL 和 Auth 是我目前正在做的事情。我目前正在使用[CakePHP](http://cakephp.org)，它为 ACL 提供了一个广泛的（尽管不简单）模块，以及一种简单的身份验证方法。我也对答案感兴趣。

我收集到的：

*   学习验证输入，尤其是黑名单和白名单之间的区别
*   仔细考虑您的电子邮件验证模式
*   考虑您必须支持哪些语言（讨厌的小口音、波浪号等会妨碍名称，例如 Añagaza 或 Alérta）。
*   自己滚还是预建？
*   ACL：保持简单，否则它会吞噬你。
*   小心[CSRF 和 XSRF](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T19:13:57.303

身份验证相当简单。通过 ACL 或其他方式进行的授权可能很复杂。

身份验证通常只是将用户名和密码与存储的凭据进行匹配。只需使用 SSL 和使用盐的哈希密码。

授权可能是野兽，解决方案取决于您的要求。您可以尝试 PhpGALC 和 Zend Framework ACL 组件。这两个选项都有角色、资源和可选权限，尽管它们的名称都不同。Zend ACL 更简单、更通用（规则可以简单地在您的代码中定义，并且不需要数据库）。如果您的角色、资源和权限不是静态的，那么使用 Zend ACL，您将不得不编写代码来从您的数据存储中填充 ACL。phpGALC 的一大优点是它有一个 Web GUI。我发现 GUI 很笨拙，但除非您真正了解 ACL，否则考虑到角色和资源继承等 ACL 的复杂性，直接在数据库中进行更改可能很危险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T13:56:40.780

> *我不喜欢使用单个 tinyint 值来决定用户可以做什么和不可以做什么，除了它不是很灵活。*

这取决于...您是指将值用作整数还是位域？

如果您只是将它用作一个数字（5 级用户具有 1-4 级用户的所有能力，再加上一点），那么，是的，这不是很灵活。

如果您将它用作位域，它会为您提供 8 个（组）功能，可以为任何用户以任意组合打开或关闭这些功能。我称之为灵活。而且，如果 8 个功能对您来说还不够，将 tinyint（8 位）更改为 smallint（16 位/功能）、int（32 位）或 bigint（64 位）也很简单，应该超过足以满足我们大多数人可能编写的任何应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T14:03:31.750

大多数框架都内置了身份验证模块。因此，您可能需要查看 Zend、CakePHP、Code Ignighter 等。

还有一件容易混淆的事情是转义和编码数据之间的区别。**当数据被编码然后**转义时，事情会变得更加灵活。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-20T17:32:03.480

用户身份验证确保如果用户尝试访问应用程序拒绝免费访问的页面，它会将用户重定向到日志记录页面，并在成功登录后返回到请求的页面。在以下 wrt 陷阱、方法和方式中解释了 cake 的默认 Auth 的一种这样的实现。

[http://enbake.com/cakephp-user-authentication-auth-component](http://enbake.com/cakephp-user-authentication-auth-component)

框架不会让你受到限制。而是通过现有模块和更有条理的代码为您提供开发速度。如果有兴趣，可以向您展示比较黑白框架。

# asp.net - App_Data 文件夹中的用户身份验证数据库 - 这不是很危险吗？

> ID：424254
> 
> 赞同：1
> 
> 时间：2009-01-08T13:39:59.020
> 
> 标签：asp.net, authentication

我们计划对我们的应用程序使用标准的 ASP.NET 用户身份验证。但是，默认情况下，这要求我们在 Web 服务器上的 App_Data 文件夹中拥有我们的用户数据库。

这对我们来说通常是一个**很大**的禁忌——我们的数据库都在防火墙后面，所有访问都是通过 WCF 服务层完成的。

如果数据库在不同的服务器上，但可以从 Web 服务器直接访问，那么这仍然违反了我们通常的架构规则。

我们应该担心我们的用户数据库存在于我们的网络服务器上吗？ASP.NET 是否提供开箱即用的替代方案？

注意：我们使用的是 .NET 3.5 和 SQL Server 2005

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T14:03:10.190

您可以在任何 SQL Server 数据库中安装必要的数据库表等。

使用 C:\WINDOWS\Microsoft.NET\Framework....... 中的 aspnet_regsql.exe 向导设置目标数据库。

然后只需更新 web.config 中提供程序配置中的连接字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:11:50.640

是的，是的。

1.  如果您需要移动到多个 Web 服务器，则不应将用户数据放在其中一台服务器上。

2.  有多种方法可以做到这一点，但请查看此链接以获取有关[MSDN How To: Use Forms Authentication with SQL Server in ASP.NET 2.0的详细信息](http://msdn.microsoft.com/en-us/library/ms998317.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T19:08:37.373

您可以通过覆盖以下抽象类的方法和属性来创建自己的自定义成员资格提供程序：公共抽象类 MembershipProvider。覆盖它们后，您可以使用任何有效的数据源对用户进行身份验证。例如，您可以使用 MYSQL、SQL 服务器甚至 XML 文件来验证您的用户。这些提供者模型真的很酷。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T14:48:34.840

是的，你应该担心。不，没有开箱即用的解决方案。ASP.NET 仅附带一个 SQL 成员资格提供程序和一个 Active Directory 成员资格提供程序[（参考）](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)。您将不得不使用自定义会员提供程序来提供您的功能。

# java - 如何将字符串转换为 TimeSeriesDataItem

> ID：424264
> 
> 赞同：0
> 
> 时间：2009-01-08T13:42:37.830
> 
> 标签：java, jfreechart

我正在使用 Jfreechart。我有以下代码：

```
TimeSeries t1 = new TimeSeries("EUR/GBP");
t1.add(new TimeSeriesDataItem....); 
```

但我的 SQL 查询以`String`格式和值给出日期`Double`。我想用`TimeSeriesDataItem`. 请让我知道如何将我的字符串转换为`TimeSeriesDataItem`. 请让我知道如何将我的`Double`价值添加到`TimeSeriesDataItem`.

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T17:40:30.863

1) 将您的日期从 String 转换为 java.util.Date

2) 使用扩展 RegularTimePeriod 的类之一包装此 Date 实例。例如。RegularTimePeriod p = 新的一天 (myDate)

3) TimeSeriesDataItem t = new TimeSeriesDataItem (p, a_numeric_value)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-15T04:42:04.950

日期字符串的格式是什么？假设格式为 DD-MM-YY。

首先将字符串转换为`Date`对象。

```
String date_S = "04-06-16"; //your date from SQL
Date date;
SimpleDateFormat sdf2 = new SimpleDateFormat("dd-MM-yy");
try {
   date = sdf2.parse(dateS);
} catch (ParseException e) {
    e.printStackTrace();
} 
```

TimeSeries 将`RegularTimePeriod`和`Double`作为参数添加 所以创建一个`RegularTimePeriod`对象并将其添加到系列中。

```
RegularTimePeriod rtp = new Date(date);
TimeSeries t1 = new TimeSeries("EUR/GBP");
TimeSeriesDataItem tsdi = new TimeSeriesDataItem(rtp , Double);
t1.add(tsdi); 
```

# javascript - 可播种的 JavaScript 随机数生成器

> ID：424292
> 
> 赞同：175
> 
> 时间：2009-01-08T13:51:24.940
> 
> 标签：javascript, random, seed

JavaScript[`Math.random()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random)函数返回一个介于 0 和 1 之间的随机值，根据当前时间自动播种（我相信类似于 Java）。但是，我认为没有任何方法可以为您设置种子。

如何制作一个可以提供自己的种子值的随机数生成器，以便我可以让它产生可重复的（伪）随机数序列？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2010-02-03T14:18:24.393

一种选择是[http://davidbau.com/seedrandom](http://davidbau.com/seedrandom)，它是基于 RC4 的可种子 Math.random() 替代品，具有很好的特性。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-08T14:37:10.980

如果您不需要播种功能，只需使用`Math.random()`并围绕它构建辅助函数（例如`randRange(start, end)`）。

我不确定您使用的是什么 RNG，但最好了解并记录它，以便了解它的特性和局限性。

就像 Starkii 说的，Mersenne Twister 是一个很好的 PRNG，但实现起来并不容易。如果您想自己做，请尝试实现[LCG](http://en.wikipedia.org/wiki/Linear_congruential_generator) - 它非常简单，具有不错的随机性（不如 Mersenne Twister 好），并且您可以使用一些流行的常量。

编辑：考虑[这个答案](https://stackoverflow.com/a/47593316/37020)中用于短种子 RNG 实现的最佳选择，包括 LCG 选项。

```
function RNG(seed) {
  // LCG using GCC's constants
  this.m = 0x80000000; // 2**31;
  this.a = 1103515245;
  this.c = 12345;

  this.state = seed ? seed : Math.floor(Math.random() * (this.m - 1));
}
RNG.prototype.nextInt = function() {
  this.state = (this.a * this.state + this.c) % this.m;
  return this.state;
}
RNG.prototype.nextFloat = function() {
  // returns in range [0,1]
  return this.nextInt() / (this.m - 1);
}
RNG.prototype.nextRange = function(start, end) {
  // returns in range [start, end): including start, excluding end
  // can't modulu nextInt because of weak randomness in lower bits
  var rangeSize = end - start;
  var randomUnder1 = this.nextInt() / this.m;
  return start + Math.floor(randomUnder1 * rangeSize);
}
RNG.prototype.choice = function(array) {
  return array[this.nextRange(0, array.length)];
}

var rng = new RNG(20);
for (var i = 0; i < 10; i++)
  console.log(rng.nextRange(10, 50));

var digits = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
for (var i = 0; i < 10; i++)
  console.log(rng.choice(digits));
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-08T14:21:04.240

如果您希望能够指定种子，您只需替换对`getSeconds()`and的调用`getMinutes()`。你可以传入一个 int 并使用它的一半 mod 60 作为秒值，另一半 modulo 60 给你另一部分。

话虽如此，这种方法看起来像垃圾。进行适当的随机数生成非常困难。一个明显的问题是随机数种子是基于秒和分钟的。要猜测种子并重新创建随机数流，只需要尝试 3600 种不同的秒和分钟组合。这也意味着只有 3600 种不同的可能种子。这是可以纠正的，但我从一开始就怀疑这个 RNG。

如果您想使用更好的 RNG，请尝试[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_Twister)。这是一个经过良好测试且相当强大的 RNG，具有巨大的轨道和出色的性能。

编辑：我真的应该是正确的，并将其称为伪随机数生成器或 PRNG。

> “任何使用算术方法产生随机数的人都处于犯罪状态。”
>                                                                                                                                                           ——约翰·冯·诺依曼

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-03-08T23:25:34.250

我使用 Mersenne Twister 的 JavaScript 端口： [https](https://gist.github.com/300494) ://gist.github.com/300494 它允许您手动设置种子。此外，正如其他答案中提到的，Mersenne Twister 是一个非常好的 PRNG。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-08T15:24:08.420

您列出的代码有点像[Lehmer RNG](http://www.cs.odu.edu/~cmo/classes/old/cs475sp05/leemisText/07_c21.pdf)。如果是这种情况，则`2147483647`是最大的 32 位有符号整数，`2147483647`是最大的 32 位素数，并且`48271`是用于生成数字的全周期乘数。

如果这是真的，您可以修改`RandomNumberGenerator`以接收一个额外的参数`seed`，然后设置`this.seed`为`seed`; 但是您必须小心确保种子会产生良好的随机数分布（Lehmer 可能会像那样奇怪） - 但大多数种子会很好。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-03-10T23:39:29.923

下面是一个 PRNG，它可以喂一个自定义种子。调用`SeedRandom`将返回一个随机生成器函数。`SeedRandom`可以不带参数调用，以便为返回的随机函数播种当前时间，或者可以使用 1 或 2 个非负 inters 作为参数调用它，以便使用这些整数播种。由于只有 1 个值的浮点精度播种将仅允许生成器启动到 2^53 个不同状态之一。

返回的随机生成器函数接受 1 个名为`limit`的整数参数，limit 必须在 1 到 4294965886 的范围内，该函数将返回一个在 0 到 limit-1 范围内的数字。

```
function SeedRandom(state1,state2){
    var mod1=4294967087
    var mul1=65539
    var mod2=4294965887
    var mul2=65537
    if(typeof state1!="number"){
        state1=+new Date()
    }
    if(typeof state2!="number"){
        state2=state1
    }
    state1=state1%(mod1-1)+1
    state2=state2%(mod2-1)+1
    function random(limit){
        state1=(state1*mul1)%mod1
        state2=(state2*mul2)%mod2
        if(state1<limit && state2<limit && state1<mod1%limit && state2<mod2%limit){
            return random(limit)
        }
        return (state1+state2)%limit
    }
    return random
} 
```

示例使用：

```
var generator1=SeedRandom() //Seed with current time
var randomVariable=generator1(7) //Generate one of the numbers [0,1,2,3,4,5,6]
var generator2=SeedRandom(42) //Seed with a specific seed
var fixedVariable=generator2(7) //First value of this generator will always be
                                //1 because of the specific seed. 
```

该生成器具有以下特性：

*   它有大约 2^64 种不同的可能内部状态。
*   它的周期约为 2^63，比任何人在 JavaScript 程序中实际需要的周期都要多得多。
*   由于`mod`值是素数，因此无论选择何种限制，输出中都没有简单的模式。这与一些简单的 PRNG 不同，它们表现出一些非常系统的模式。
*   它丢弃一些结果以获得完美的分布，无论限制如何。
*   它相对较慢，在我的机器上每秒运行大约 10 000 000 次。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-09-12T10:49:16.747

如果您使用 Typescript 编程，我将 Christoph Henkelmann 对该线程的回答中引入的 Mersenne Twister 实现改编为 typescript 类：

```
/**
 * copied almost directly from Mersenne Twister implementation found in https://gist.github.com/banksean/300494
 * all rights reserved to him.
 */
export class Random {
    static N = 624;
    static M = 397;
    static MATRIX_A = 0x9908b0df;
    /* constant vector a */
    static UPPER_MASK = 0x80000000;
    /* most significant w-r bits */
    static LOWER_MASK = 0x7fffffff;
    /* least significant r bits */

    mt = new Array(Random.N);
    /* the array for the state vector */
    mti = Random.N + 1;
    /* mti==N+1 means mt[N] is not initialized */

    constructor(seed:number = null) {
        if (seed == null) {
            seed = new Date().getTime();
        }

        this.init_genrand(seed);
    }

    private init_genrand(s:number) {
        this.mt[0] = s >>> 0;
        for (this.mti = 1; this.mti < Random.N; this.mti++) {
            var s = this.mt[this.mti - 1] ^ (this.mt[this.mti - 1] >>> 30);
            this.mt[this.mti] = (((((s & 0xffff0000) >>> 16) * 1812433253) << 16) + (s & 0x0000ffff) * 1812433253)
                + this.mti;
            /* See Knuth TAOCP Vol2\. 3rd Ed. P.106 for multiplier. */
            /* In the previous versions, MSBs of the seed affect   */
            /* only MSBs of the array mt[].                        */
            /* 2002/01/09 modified by Makoto Matsumoto             */
            this.mt[this.mti] >>>= 0;
            /* for >32 bit machines */
        }
    }

    /**
     * generates a random number on [0,0xffffffff]-interval
     * @private
     */
    private _nextInt32():number {
        var y:number;
        var mag01 = new Array(0x0, Random.MATRIX_A);
        /* mag01[x] = x * MATRIX_A  for x=0,1 */

        if (this.mti >= Random.N) { /* generate N words at one time */
            var kk:number;

            if (this.mti == Random.N + 1)   /* if init_genrand() has not been called, */
                this.init_genrand(5489);
            /* a default initial seed is used */

            for (kk = 0; kk < Random.N - Random.M; kk++) {
                y = (this.mt[kk] & Random.UPPER_MASK) | (this.mt[kk + 1] & Random.LOWER_MASK);
                this.mt[kk] = this.mt[kk + Random.M] ^ (y >>> 1) ^ mag01[y & 0x1];
            }
            for (; kk < Random.N - 1; kk++) {
                y = (this.mt[kk] & Random.UPPER_MASK) | (this.mt[kk + 1] & Random.LOWER_MASK);
                this.mt[kk] = this.mt[kk + (Random.M - Random.N)] ^ (y >>> 1) ^ mag01[y & 0x1];
            }
            y = (this.mt[Random.N - 1] & Random.UPPER_MASK) | (this.mt[0] & Random.LOWER_MASK);
            this.mt[Random.N - 1] = this.mt[Random.M - 1] ^ (y >>> 1) ^ mag01[y & 0x1];

            this.mti = 0;
        }

        y = this.mt[this.mti++];

        /* Tempering */
        y ^= (y >>> 11);
        y ^= (y << 7) & 0x9d2c5680;
        y ^= (y << 15) & 0xefc60000;
        y ^= (y >>> 18);

        return y >>> 0;
    }

    /**
     * generates an int32 pseudo random number
     * @param range: an optional [from, to] range, if not specified the result will be in range [0,0xffffffff]
     * @return {number}
     */
    nextInt32(range:[number, number] = null):number {
        var result = this._nextInt32();
        if (range == null) {
            return result;
        }

        return (result % (range[1] - range[0])) + range[0];
    }

    /**
     * generates a random number on [0,0x7fffffff]-interval
     */
    nextInt31():number {
        return (this._nextInt32() >>> 1);
    }

    /**
     * generates a random number on [0,1]-real-interval
     */
    nextNumber():number {
        return this._nextInt32() * (1.0 / 4294967295.0);
    }

    /**
     * generates a random number on [0,1) with 53-bit resolution
     */
    nextNumber53():number {
        var a = this._nextInt32() >>> 5, b = this._nextInt32() >>> 6;
        return (a * 67108864.0 + b) * (1.0 / 9007199254740992.0);
    }
} 
```

您可以按如下方式使用它：

```
var random = new Random(132);
random.nextInt32(); //return a pseudo random int32 number
random.nextInt32([10,20]); //return a pseudo random int in range [10,20]
random.nextNumber(); //return a a pseudo random number in range [0,1] 
```

检查源以获取更多方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-02-07T12:45:34.670

这是我喜欢使用的一个非常有效但简单的 javascript PRNG 函数：

```
// The seed is the base number that the function works off
// The modulo is the highest number that the function can return

function PRNG(seed, modulo) {
    str = `${(2**31-1&Math.imul(48271,seed))/2**31}`
    .split('')
    .slice(-10)
    .join('') % modulo

    return str
} 
```

我希望这就是你要找的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-10T21:46:12.013

> ***注意：**此代码最初包含在上述问题中。为了使问题简短而集中，我已将其移至此社区 Wiki 答案。*

我发现这段代码在乱跑，它似乎可以很好地获取一个随机数，然后使用种子，但我不太确定逻辑是如何工作的（例如，2345678901、48271 和 2147483647 数字的来源）。

```
function nextRandomNumber(){
  var hi = this.seed / this.Q;
  var lo = this.seed % this.Q;
  var test = this.A * lo - this.R * hi;
  if(test > 0){
    this.seed = test;
  } else {
    this.seed = test + this.M;
  }
  return (this.seed * this.oneOverM);
}

function RandomNumberGenerator(){
  var d = new Date();
  this.seed = 2345678901 + (d.getSeconds() * 0xFFFFFF) + (d.getMinutes() * 0xFFFF);
  this.A = 48271;
  this.M = 2147483647;
  this.Q = this.M / this.A;
  this.R = this.M % this.A;
  this.oneOverM = 1.0 / this.M;
  this.next = nextRandomNumber;
  return this;
}

function createRandomNumber(Min, Max){
  var rand = new RandomNumberGenerator();
  return Math.round((Max-Min) * rand.next() + Min);
}

//Thus I can now do:
var letters = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];
var numbers = ['1','2','3','4','5','6','7','8','9','10'];
var colors = ['red','orange','yellow','green','blue','indigo','violet'];
var first = letters[createRandomNumber(0, letters.length)];
var second = numbers[createRandomNumber(0, numbers.length)];
var third = colors[createRandomNumber(0, colors.length)];

alert("Today's show was brought to you by the letter: " + first + ", the number " + second + ", and the color " + third + "!");

/*
  If I could pass my own seed into the createRandomNumber(min, max, seed);
  function then I could reproduce a random output later if desired.
*/ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-14T15:46:17.907

谢谢你，@aaaaaaaaaaaa（已接受答案）

我真的需要一个好的非库解决方案（更容易嵌入）

所以...我创建了这个类来存储种子并允许Unity-esque“Next”...但保留了最初的基于整数的结果

```
class randS {
    constructor(seed=null) {
        if(seed!=null) {
            this.seed = seed;
        } else {
            this.seed = Date.now()%4645455524863;
        }
        this.next = this.SeedRandom(this.seed);
        this.last = 0;
    }
    Init(seed=this.seed) {
        if (seed = this.seed) {
            this.next = this.SeedRandom(this.seed);
        } else {
            this.seed=seed;
            this.next = this.SeedRandom(this.seed);
        }
    }
    SeedRandom(state1,state2){
        var mod1=4294967087;
        var mod2=4294965887;
        var mul1=65539;
        var mul2=65537;
        if(typeof state1!="number"){
            state1=+new Date();
        }
        if(typeof state2!="number"){
            state2=state1;
        }
        state1=state1%(mod1-1)+1;
        state2=state2%(mod2-1)+1;
        function random(limit){
            state1=(state1*mul1)%mod1;
            state2=(state2*mul2)%mod2;
            if(state1<limit && state2<limit && state1<mod1%limit && state2<mod2%limit){
                this.last = random;
                return random(limit);
            }
            this.last = (state1+state2)%limit;
            return (state1+state2)%limit;
        }
        this.last = random;
        return random;

    }
} 
```

然后用这些检查它......似乎可以很好地处理随机（但可查询）的种子值（a la Minecraft），甚至存储返回的最后一个值（如果需要）

```
var rng = new randS(9005646549);
console.log(rng.next(20)+' '+rng.next(20)+' '+rng.next(20)+' '+rng.next(20)+' '+rng.next(20)+' '+rng.next(20)+' '+rng.next(20));
console.log(rng.next(20) + ' ' + rng.next(20) + ' ' + rng.last); 
```

应该输出（对于每个人）

```
6 7 8 14 1 12 6
9 1 1 
```

编辑：如果您需要重新设置种子或测试值，我会让 init() 工作（这在我的上下文中也是必要的）

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2010-12-23T04:53:08.187

好的，这是我确定的解决方案。

首先，您使用“newseed()”函数创建一个种子值。然后将种子值传递给“srandom()”函数。最后，“srandom()”函数返回一个介于 0 和 1 之间的伪随机值。

关键是种子值存储在数组中。如果它只是一个整数或浮点数，则每次调用函数时都会覆盖该值，因为整数、浮点数、字符串等的值直接存储在堆栈中，而不是像数组和指针那样仅存储在堆栈中其他物体。因此，种子的价值有可能保持不变。

最后，可以定义“srandom()”函数，使其成为“Math”对象的一个​​方法，但我会让你自己弄清楚。;)

祝你好运！

JavaScript：

```
// Global variables used for the seeded random functions, below.
var seedobja = 1103515245
var seedobjc = 12345
var seedobjm = 4294967295 //0x100000000

// Creates a new seed for seeded functions such as srandom().
function newseed(seednum)
{
    return [seednum]
}

// Works like Math.random(), except you provide your own seed as the first argument.
function srandom(seedobj)
{
    seedobj[0] = (seedobj[0] * seedobja + seedobjc) % seedobjm
    return seedobj[0] / (seedobjm - 1)
}

// Store some test values in variables.
var my_seed_value = newseed(230951)
var my_random_value_1 = srandom(my_seed_value)
var my_random_value_2 = srandom(my_seed_value)
var my_random_value_3 = srandom(my_seed_value)

// Print the values to console. Replace "WScript.Echo()" with "alert()" if inside a Web browser.
WScript.Echo(my_random_value_1)
WScript.Echo(my_random_value_2)
WScript.Echo(my_random_value_3) 
```

Lua 4（我个人的目标环境）：

```
-- Global variables used for the seeded random functions, below.
seedobja = 1103515.245
seedobjc = 12345
seedobjm = 4294967.295 --0x100000000

-- Creates a new seed for seeded functions such as srandom().
function newseed(seednum)
    return {seednum}
end

-- Works like random(), except you provide your own seed as the first argument.
function srandom(seedobj)
    seedobj[1] = mod(seedobj[1] * seedobja + seedobjc, seedobjm)
    return seedobj[1] / (seedobjm - 1)
end

-- Store some test values in variables.
my_seed_value = newseed(230951)
my_random_value_1 = srandom(my_seed_value)
my_random_value_2 = srandom(my_seed_value)
my_random_value_3 = srandom(my_seed_value)

-- Print the values to console.
print(my_random_value_1)
print(my_random_value_2)
print(my_random_value_3) 
```

# javascript - 如何确定点击是否发生在元素的滚动条或其内容上

> ID：424293
> 
> 赞同：2
> 
> 时间：2009-01-08T13:51:43.863
> 
> 标签：javascript, dom

确实有方法元素。[Internet Explorer 中的componentFromPoint](http://msdn.microsoft.com/en-us/library/ms536375(VS.85).aspx) (iCoordX, iCoordY)，但是如何区分在元素的内容区域中发生的鼠标单击与在其他浏览器中其滚动条上发生的单击？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T14:10:33.437

在基于**Gecko**的浏览器中，可以检查[`event.originalTarget`](https://developer.mozilla.org/en/DOM/event.originalTarget). 如果在元素的滚动条上发生单击，则此属性将`XULElement`返回一个对象。

**WebKit**和**Presto**去...

# jenkins - Hudson 的经验 - 构建矩阵项目

> ID：424295
> 
> 赞同：23
> 
> 时间：2009-01-08T13:52:33.440
> 
> 标签：jenkins, continuous-integration, hudson

有没有人尝试过这个功能并有一些反馈？或者有谁知道一些有用的样本可以查找？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-08T14:07:56.217

几个月前我尝试过这个功能，但我不再使用它（只是因为我不需要它，而不是因为它不是一个好功能）。

基本上，您定义 n 轴，每个轴是具有多个值的属性。

让我们举个例子：定义轴“JDK”，可能值为“1.4”、“1.5”、“1.6”，并定义另一个属性“database”，其中可能值为“oracle”、“mysql”。

因此，Hudson 将启动您的构建 6 次：

*   使用 JDK 1.4，属性 database=oracle（即 JVM 使用 -Ddatabase=oracle 启动）
*   使用 JDK 1.5，使用属性 database=oracle
*   使用 JDK 1.6，使用属性 database=oracle
*   使用 JDK 1.4，属性 database=mysql
*   使用 JDK 1.5，属性 database=mysql
*   使用 JDK 1.6，属性 database=mysql

然后，一旦一切都完成，您将能够看到每次迭代的结果。

当您需要在多个环境中测试您的应用程序时（在我的示例中，使用不同版本的 JDK 或数据库），此功能可能非常有用。

请注意，除了 JDK 轴之外，您必须自己管理 Hudson 作为条目给出的属性。在我的示例中，应用程序必须考虑“数据库”属性本身。最后，一个好主意是使用这个属性来启用 Maven2 配置中的特定配置文件，如果您的项目是 mavenized （有关详细信息，请参阅[此处）。](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)

我希望我的解释足够清楚:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-06-02T16:47:32.043

矩阵构建有许多问题：

*   与插件广泛不兼容 - 它们正在变得更好，但您需要保持最新状态。
*   人工制品 - 更难摆脱 - 网址有点尴尬，在 FS 上找到它们（无论如何你应该避免）现在是一场噩梦。

这是一个耻辱，因为这个概念非常好并且在它工作的地方非常方便。

* * *

编辑

*   无法开始单点。

我们通常的解决方法是将参数化构建设置为同时运行——这有其自身的问题，但可以避免我们有许多具有相同代码和不同常量的作业。

# qt - 在纯 QT4 应用程序中使用 KDE4 本地化机制

> ID：424307
> 
> 赞同：3
> 
> 时间：2009-01-08T13:56:21.500
> 
> 标签：qt, localization, internationalization, qt4, kde

我正在编写一个当前是纯 QT4 应用程序的应用程序。它旨在在 Linux 和 Windows 上干净地运行。

但是我计划在未来将它集成到 KDE 中，这会出现本地化/翻译的问题。

QT4 使用自己的 tr()/tr().arg().arg() 机制和 .ts/.qm 文件。KDE4 使用 gettext 和 i18n/i18np 机制和 .po 文件。

如何轻松地在我的 QT4 应用程序中使用 KDE4 的机制，而无需现在将其与 KDE 紧密集成（显然使其无法在 Windows 上运行）？

有可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T14:53:34.130

从 4.5 版开始，Qt 将同时支持 .po 和 .xliff；

[http://doc.trolltech.com/4.5/qt4-5-intro.html#qt-linguist-improvements](http://doc.trolltech.com/4.5/qt4-5-intro.html#qt-linguist-improvements)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T14:05:28.533

我想你只需要选择一个并使用它，如果它是一个跨平台的应用程序，我会使用 QT 的方法。原因是 KDE 用 i18*() 宏包装它的国际化字符串，而 QT 使用 tr() 宏，因为一个宏不能产生另一个宏，除非你的代码中到处都是#ifdef，否则没有办法。巨大的弦桌......两者都很糟糕。

# ide - 您希望在 IDE 中看到哪些 AI 驱动的功能？

> ID：424311
> 
> 赞同：3
> 
> 时间：2009-01-08T13:57:39.077
> 
> 标签：ide, artificial-intelligence

我们已经有了静态分析之类的东西，它可以告诉我们代码出了什么问题以及哪里出了问题，那么我们是否应该赋予我们的 IDE 更多的 AI 功能，如果是的话，哪些是？我正在寻找想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T13:59:21.430

检测重复代码是我的首要愿望；-)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T14:34:15.400

嗯......除了代码本身，如果机器可以“教授”一些 UI 标准，就元素布局而言，并且如果它与“人类友好”不匹配，则建议或更改布局，这可能会很有用。

我正在考虑诸如间距、文本大小、元素布局等。不知道这是否需要“真正的”人工智能来完成。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T14:04:14.307

人工智能？就像在 Office 2000 中的那些“智能”菜单中一样？零！也许在 2700 年左右，人工智能已经超越了人类的智能。

更多静态/上下文分析？绝对地。这里还有很大的进步空间，老实说，我几乎欢迎任何事情。对人类的依赖太多了，计算机辅助分析是改变它的最好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T14:09:20.553

我有点喜欢桑德尔。我遇到的每一个应用程序试图变得聪明的实例，或者猜测我想要什么，它都是自动失败的。不要对我隐瞒任何事情，除非我确认，否则不要以为你知道我想要什么。Word 中的自动更正和自动替换之类的东西尤其令人沮丧。Intellisense 之类的很好，因为它们实际上并不猜测您想要什么，它们只是为您提供所有可能性的快速列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T14:43:32.760

对于我们真的不知道如何在任意强大的计算机上完成的计算机项目来说，人工智能是万能的。因此，人工智能技术复杂、古怪且完全不可靠。（一旦人工智能技术变得可重复和可靠，它就不再是人工智能了。）你想要在你的 IDE 中有多少片状是另一个问题。

我不介意将一些人工智能作为分析选项，也许是为了注意到我没有注意到的不良代码气味。我不想让它一直开着，我当然也不想让它自己做任何事情。我认为它就像 Microsoft Word 语法检查器，它可以捕获大约两倍于我制作的语法不规则和不恰当之处 - 有用，但远非确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T14:03:39.300

交互式代码覆盖测试会很棒。

```
 m = 1;
 if (m > 0) {
       // do something
  } else {
      // do something else <- Never gonna happen.
  } 
```

像这样的事情会引发红旗。但是代码覆盖率测试必须是可选的或不引人注目的。由于有些人使用预处理器，并且 DEBUG = 1;

# java - Spring和Hibernate，延迟启动问题

> ID：424312
> 
> 赞同：3
> 
> 时间：2009-01-08T13:57:43.977
> 
> 标签：java, hibernate, spring, lazy-loading

嘿，我正在使用 Spring 和 Hibernate 开发一个桌面应用程序，但我遇到了延迟启动的问题。我在网上查看，每个解决方案都与视图模式中的打开会话有关，但我不能使用这种模式。我也尝试`sessionfactory`从中获取`HibernateTemplate`，但它返回给我一个断开连接的会话。

有谁知道其他解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T17:01:25.533

我建议您基本上有两种解决方案：

1.  当您访问延迟初始化的对象或集合时，请安排保持 Hibernate 会话打开。这意味着您必须在代码中仔细标记事务边界，类似于“视图中的打开会话”模式。Spring 使这成为可能，但在桌面应用程序中，它不会像事务边界更明显的 Web 应用程序那样简单。

2.  关闭 Hibernate 中持久对象的所有延迟初始化。

选项 2 可能会导致大量不必要的数据库访问，而选项 1 意味着您必须认真研究您的工作流程和用例。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T19:04:10.760

一种选择是在实体或集合上调用 Hibernate.initialize() 以强制初始化它们。您希望在将数据返回到视图之前执行此操作。我会仔细考虑这一点，因为它会生成大量的 SQL 语句返回数据库。

您可能想考虑在 HQL 查询中使用“fetch”或在映射中将 fetch 模式配置为“eager”（我相信它是 JPA 中的 FetchMode.EAGER 或 hbm.xml 中的lazy="false"）。

@Jose：不要在您自己的 ThreadLocal 中管理会话。使用 SessionFactory.getCurrentSession() 并将 Hibernate 配置为使用“线程”SessionContext。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-10T16:06:26.490

我有一个非常相似的问题，因为我找不到任何真正合适的解决方案。我想出了自己的一个，结合了网上找到的许多不同的方法，并将它们发布到我的博客上。

抱歉，我没有把它全部放在这里，但是在所有论坛中一遍又一遍地做这件事我发现有人有这个或类似的问题

[使用 Hibernate 和 Spring 进行远程延迟加载](http://hons82.blogspot.com/2010/12/remote-lazy-loading-with-hibernate-and.html)

# c# - .Net开源集群产品？... 像兵马俑

> ID：424322
> 
> 赞同：16
> 
> 时间：2009-01-08T14:01:11.457
> 
> 标签：c#, .net, load-balancing, cluster-computing

.Net 是否有任何开源集群产品，例如 terracotta ( [http://www.terracotta.org/](http://www.terracotta.org/) )？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T02:41:38.467

I don't think they have anything exactly like Terracotta... but there is [velocity](http://blogs.msdn.com/velocity/) on the cards from MS(who knows when) as well as [MEMCache](http://code.jellycan.com/memcached/)(heard bad things) has a port to .NET now and also [indeXus.Net](http://www.sharedcache.com/cms/)

# vbscript - 获取VBScript中的当前临时目录路径？

> ID：424331
> 
> 赞同：23
> 
> 时间：2009-01-08T14:04:15.290
> 
> 标签：vbscript

VB获取当前临时目录路径的技巧：

```
Private Declare Function GetTempPath Lib "kernel32" Alias "GetTempPathA" (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long 
```

在 VBScript 中失败。所以？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-08T14:05:00.500

```
WScript.CreateObject("Scripting.FileSystemObject").GetSpecialFolder(2) 
```

我花了一段时间才在谷歌上找到它。所以对于下一个寻找和我一样的人......

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-08T14:09:44.000

```
Const WindowsFolder = 0

Const SystemFolder = 1

Const TemporaryFolder = 2

Dim fso: Set fso = CreateObject("Scripting.FileSystemObject")

Dim tempFolder: tempFolder = fso.GetSpecialFolder(TemporaryFolder) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-08T14:30:11.947

另一种可能：

```
CreateObject("WScript.Shell").ExpandEnvironmentStrings("%Temp%") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T01:06:01.150

您也可以继续使用`GetTempPath`API。不过，从 vbscript 调用 API 有点棘手。以下是有关如何从 vbscript 进行 Win32 API 调用的一些提示：

[参考1](http://social.msdn.microsoft.com/Forums/en-US/48f022dd-f62d-437e-be0e-b502c8f4cd94/accessing-win32-api-in-vb-scriptvbs-files)

[参考文献 2](http://msdn.microsoft.com/en-us/library/x2f73269%28VS.80%29.aspx)

[参考文献 3](https://groups.google.com/forum/#!topic/microsoft.public.scripting.vbscript/I3pjKPSyAR4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-15T01:01:55.210

完全基于[AnthonyWJones 的回答](https://stackoverflow.com/a/424349/7311767)，这是我的解决方案：

```
Public Enum SpecialFolder
    WindowsFolder = 0
    SystemFolder = 1
    TempFolder = 2
End Enum

Public Function GetFolder(folder As Integer) As String
    Dim objFSO  As Object

    Set objFSO = CreateObject("Scripting.FileSystemObject")

    GetFolder = objFSO.GetSpecialFolder(folder)
End Function 
```

因此，例如，您将`GetFolder(TempFolder)`用于获取用户临时文件夹的路径名。

# java - 是否有任何 Java VM 可以将其状态保存到文件然后重新加载该状态？

> ID：424341
> 
> 赞同：17
> 
> 时间：2009-01-08T14:06:55.143
> 
> 标签：java, persistence, virtual-machine

是否有任何 Java VM 可以将其状态保存到文件然后重新加载该状态？

如果有，有哪些？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T16:56:23.227

另一个可能与您的情况相关或不相关的选项是在虚拟机中运行 JVM（任何 JVM）。大多数虚拟机都提供存储和恢复状态的选项，因此您*应该*能够重新启动您的 PC，在虚拟机恢复时启动它，并让 Java 进程从原来的位置恢复。

我在工作中使用 VMWare Player 在 IE 上进行测试，当我关闭并稍后重新打开它时，它的工作原理如上所述。当应用程序在虚拟机中做任何值得注意的事情时，我通常不会这样做，但只要它们不访问任何外部资源（例如网络套接字），我希望它能够像虚拟机从未关闭一样工作.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-10T10:51:37.343

[延续](http://en.wikipedia.org/wiki/Continuation)可能是您正在寻找的：

> [...] 第一类延续，这些结构使编程语言能够在任何时候保存执行状态，并在程序的稍后点返回到该点。

Java 至少有两个延续库：[RIFE 延续](https://svn.rifers.org/rife-continuations/trunk/)和[javaflow](http://jakarta.apache.org/commons/sandbox/javaflow/)。我知道 javaflow 至少允许将状态序列化到磁盘：

> 如果A`Continuation`捕获的所有对象也是可序列化的，则它可以被序列化。换句话说，所有的局部变量（包括所有的`this` 对象）都需要标记为 `Serializable`. 在此示例中，您需要将 MyRunnable 类标记为 Serializable 。序列化的延续可以发送到另一台机器或稍后使用。- [Javaflow 教程](http://commons.apache.org/sandbox/javaflow/tutorial.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T15:50:40.253

您应该序列化相关的特定于域的对象，这些对象可以被另一个 JVM 运行时反序列化。

我不知道有任何工具可以持久化整个 JVM。我最接近的方法是使用 gcore 从正在运行的 JVM 进程创建核心转储[，](http://www.gsp.com/cgi-bin/man.cgi?section=1&topic=gcore)然后使用[jsadebugd](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jsadebugd.html)、[jmap](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jmap.html)或[jstack](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstack.html)对其进行调试。

例如：

```
$ jps # get JVM process ID XXX
$ gcore -o core XXX
$ jsadebugd $JAVA_HOME/bin/java core.XXX 
```

**更新**

我不认为你会找到一个可以在架构之间移植的解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-06T21:18:11.663

值得注意的是，许多对象无法序列化，因为它们在 java 上下文之外具有状态。例如套接字、线程、打开文件、数据库连接。因此，很难以通用方式保存有用应用程序的状态。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-09T14:50:22.070

我不知道可以存储状态的JVM。根据您的具体需求，您可以考虑使用 Terracotta。Terracotta 本质上能够在 JVM 之间共享堆状态，并将此状态存储到磁盘。

这可用于集群应用程序，和/或使堆状态持久化。实际上，您可以使用它来启动 JVM 并从中断处继续。欲了解更多信息，请查看： http: [//www.infoq.com/articles/open-terracotta-intro](http://www.infoq.com/articles/open-terracotta-intro)

希望这可以帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-08T16:30:04.293

我从事过[一个嵌入式 Java 项目](http://java.sun.com/developer/technicalArticles/J2ME/TLA.html)，该项目使用这种方法快速启动。JVM 来自 Wind River，运行在 VxWorks 之上。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-07T19:56:15.657

Sun 对“正交持久性”进行了一些研究，它为“Java 语言规范定义的完整计算模型提供了持久性”：

[http://research.sun.com/forest/COM.Sun.Labs.Forest.doc.opjspec.abs.html](http://research.sun.com/forest/COM.Sun.Labs.Forest.doc.opjspec.abs.html)

PJama 是一个原型实现：

[http://research.sun.com/forest/opj.main.html](http://research.sun.com/forest/opj.main.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-06T21:05:59.647

据我所知，没有什么可以捕获 JVM 状态并恢复它，但是人们正在尝试序列化/反序列化 Thread 类以实现类似的功能。我发现的最接近工作实现的是[刹车](http://www.cs.kuleuven.ac.be/~eddy/BRAKES/brakes.html)，但是当你用谷歌搜索“线程序列化”时，你可能会发现更多。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-11T11:38:02.887

我认为您希望能够从存储快照的位置恢复，就好像此后没有发生任何事情一样。

我想知道这样的功能会破坏多少框架组件和库。突然，您正在从存储中恢复 JVM 状态；与此同时，时钟神秘地向前跳了 23 小时，网络连接不再有效，GUI 对象不再有任何底层的 O/S 句柄......我想说这是不平凡的，在一般情况下，如果没有广泛修改框架。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-09T00:44:20.277

如果您可以摆脱只存储内存中对象的状态，那么像[Prevaylor](http://www.prevayler.org)这样的东西可能对您有用。它使用对业务对象的日志更改与序列化快照的组合来记录对象的状态，然后您可以稍后重新加载这些状态。

但是，它不存储完整的 JVM 状态（调用堆栈、GC 状态等）。如果您真的需要这种详细程度，那么可能需要专门的 JVM。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-11T19:47:46.750

目前的答案是**否定**的，没有 JVM 可以像您的操作系统或 VMWare 等那样“休眠”。

根据应用程序的复杂性，您*可以*通过仅在程序关闭时将状态序列化并将其重新序列化来实现中途，但这不会像在您关闭然后继续时暂停执行某些业务逻辑这样的事情当你再次打开它时。

# rest - 通过 REST 访问 Erlang 业务层

> ID：424346
> 
> 赞同：4
> 
> 时间：2009-01-08T14:09:07.683
> 
> 标签：rest, erlang, erlang-otp

对于一个大学项目，我正在考虑在 Erlang 中实现业务层，然后使用 REST 通过多个前端访问它。我想利用分布式应用程序等 OTP 功能。

我的问题是如何将 gen_server 调用/强制转换暴露给其他应用程序？显然，我可以通过特定于语言的“桥”（如 OTP.net 或 JInterface）进行 RPC 调用，但我想要一种一致的方式来访问它，如 REST。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-09T04:03:18.217

正如已经提到的，Yaws 或 Mochiweb 是一个很好的方法，但是如果您想要一种简单的方法来快速正确地完成 RESTful API，那么请使用[Webmachine](http://code.google.com/p/webmachine/)。它是 Mochiweb 之上的一个层，它基于 Alan Dean 令人惊叹的[HTTP 流程图](http://thoughtpad.net/alan-dean/http-headers-status.html)实现正确的 HTTP 行为，并使正确完成 REST 变得容易。

我现在使用它来公开一个 REST API 以及处理一个 COMET 应用程序，这很容易做到，即使对于像我这样的 Erlang 新手也是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-09T02:26:46.523

我为我的工作做了类似的事情，发现最好使用 REST 来公开业务层，因为即使是 SoftwareAG 的 Natural 等传统语言也能够访问它。我在 Erlang 中找到的最佳机制是使用[Mochiweb](http://code.google.com/p/mochiweb/)。

您可以从位于 [Erlang In Practice Screencast](http://pragprog.com/screencasts/v-kserl/erlang-in-practice)的截屏视频中找到有关使用它的更多信息。第 6 集特别有用，但都非常出色。

指导您完成安装的资源是[如何快速设置加载了 Erlang、Mochiweb 和 Nginx 的 Ubuntu 8.04](http://beebole.com/blog/erlang/how-to-quickly-set-up-ubuntu-804-loaded-with-erlang-mochiweb-and-nginx/)以及[将本机 Erlang 接口迁移到 RESTful Mochiweb（带有一点 TDD）](http://21ccw.blogspot.com/2008/06/migrating-native-erlang-interface-to.html)如果您没有找到截屏视频，则提供了一个良好的开始随心所欲。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-11T09:52:29.483

HTTP 流程图链接已失效。Alan Dean 和 Justin Sheehy 合作创建的原始版本和更新版本也托管在 Webmachine 项目中：[链接到最新版本的 HTTP Diagramm](http://bitbucket.org/justin/webmachine/wiki/BigHTTPGraph)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T16:47:41.107

如果可能的话，有一种有价值的方法来设计 gen_server 调用/转换以 REST 风格。您可以将消息用作

```
{get, Resource}
{set, Resource, Value} % aka PUT
{delete, Resource}
{add, Resource, Value} % aka POST (possible another names are append, modify or similar) 
```

然后它的映射很容易。您可以进行一些转换 URI->RESOURCE 或使用身份。对于您的大多数应用程序，这应该是麦芽汁方法，特殊情况您应该特别处理。你可以认为会有很大的余量，你不能使用这种方法，但这应该主要是过早的优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-09T11:02:05.890

您真的是指 RESTful 接口或 RPC over HTTP 吗？在现有层之上构建一个 RESTful 接口不仅仅是通过 HTTP 公开现有方法。

我建议使用 mochiweb 或 yaws 来实现（通用）rpc 层。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-11T09:16:18.753

只是一个更新，Webmachine 已移至 bitbucket：[Webmachine 的新链接](http://bitbucket.org/justin/webmachine/wiki/Home)

# xslt - 使用 XSLT 进行数据透视

> ID：424348
> 
> 赞同：5
> 
> 时间：2009-01-08T14:09:38.430
> 
> 标签：xslt, pivot

我有一个这样的xml文件：

```
<root>
    <item>
        <name>one</name>
        <status>good</status>
    </item>
    <item>
        <name>two</name>
        <status>good</status>
    </item>
    <item>
        <name>three</name>
        <status>bad</status>
    </item>
    <item>
        <name>four</name>
        <status>ugly</status>
    </item>
    <item>
        <name>five</name>
        <status>bad</status>
    </item>
</root> 
```

我想使用 XSLT 对其进行转换以获得类似：

```
<root>
    <items><status>good</status>
        <name>one</name>
        <name>two</name>
    </items>
    <items><status>bad</status>
        <name>three</name>
        <name>five</name>
    </items>
    <items><status>ugly</status>
        <name>four</name>
    </items>
</root> 
```

换句话说，我得到一个项目列表，每个项目都有一个状态，我想把它变成一个状态列表，每个状态都有一个项目列表。

我最初的想法是依次应用匹配每个状态类型的模板，但这意味着我必须知道完整的状态列表。有更好的方法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T14:37:33.787

孟奇来救场！

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" indent="yes" encoding="UTF-8"/>

    <xsl:key name="muench" match="/root/item/status" use="."/>

    <xsl:template match="/">
        <root>
        <xsl:for-each select="/root/item/status[generate-id() = generate-id(key('muench',.)[1])]">
            <xsl:call-template name="pivot">
                <xsl:with-param name="status" select="."/>
            </xsl:call-template>
        </xsl:for-each>
        </root>
    </xsl:template>

    <xsl:template name="pivot">
        <xsl:param name="status"/>
        <items>
            <status><xsl:value-of select="$status"/></status>
            <xsl:for-each select="/root/item[status=$status]">
                <name><xsl:value-of select="name"/></name>
            </xsl:for-each>
        </items>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T14:52:22.167

**是的，这可以在 XSLT 1.0 中完成**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 >
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <!--                                   -->
    <xsl:key name="kStatByVal" 
         match="status" use="."/>
    <!--                                   -->
    <xsl:key name="kItemByStat" 
         match="item" use="status"/>
    <!--                                   -->
    <xsl:variable name="vDoc" select="/"/>

    <xsl:template match="/">
      <top>
        <xsl:for-each select=
        "/*/*/status[generate-id()
                    =
                     generate-id(key('kStatByVal',.)[1])
                    ]">
          <items>
            <status><xsl:value-of select="."/></status>
          <xsl:for-each select="key('kItemByStat', .)">
            <xsl:copy-of select="name"/>
          </xsl:for-each>
          </items>
        </xsl:for-each>
      </top>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于原始 XML 文档时**：

```
<root>
    <item>
        <name>one</name>
        <status>good</status>
    </item>
    <item>
        <name>two</name>
        <status>good</status>
    </item>
    <item>
        <name>three</name>
        <status>bad</status>
    </item>
    <item>
        <name>four</name>
        <status>ugly</status>
    </item>
    <item>
        <name>five</name>
        <status>bad</status>
    </item>
</root> 
```

**产生了想要的结果**：

```
<top>
    <items>
        <status>good</status>
        <name>one</name>
        <name>two</name>
    </items>
    <items>
        <status>bad</status>
        <name>three</name>
        <name>five</name>
    </items>
    <items>
        <status>ugly</status>
        <name>four</name>
    </items>
</top> 
```

**请注意使用**：

1.  Muenchian[**分组方法**](http://dpawson.co.uk/xsl/sect2/N4486.html#d6060e40)

2.  用途[**`<xsl:key>`**](http://www.w3.org/TR/xslt#key)及**[`key()`](http://www.w3.org/TR/xslt#function-key)**作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T14:20:44.913

这取决于您的 xslt 引擎。如果您使用没有任何扩展的 xslt 1.0，那么您的方法肯定是最好的。

另一方面，如果您被允许使用 exslt（尤其是节点集扩展）或 xslt 2.0，那么您可以以更通用的方式进行操作：

1.  收集所有可用状态
2.  根据获得的结果创建一个节点集
3.  在此节点集上迭代，通过根据迭代中的当前元素过滤您的状态来创建您的枢轴。

但在此之前，请考虑如果您只有几组状态并且添加另一个状态非常罕见，这可能是矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-18T10:04:16.570

在 XSLT 2.0 中，您可以通过其标准分组机制来替换 muenchian 分组。应用于给定的答案，xslt 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" indent="yes" encoding="UTF-8"/>

    <xsl:key name="muench" match="/root/item/status" use="."/>

    <xsl:template match="/">
        <root>
        <xsl:for-each-group select="/root/item/status" group-by="key('muench', .)">
            <xsl:call-template name="pivot">
                <xsl:with-param name="status" select="."/>
            </xsl:call-template>
        </xsl:for-each-group>
        </root>
    </xsl:template>

    <xsl:template name="pivot">
        <xsl:param name="status"/>
        <items>
            <status><xsl:value-of select="$status"/></status>
            <xsl:for-each select="/root/item[status=$status]">
                <name><xsl:value-of select="name"/></name>
            </xsl:for-each>
        </items>
    </xsl:template>

</xsl:stylesheet> 
```

# apache-flex - 在 Flex/MXML 中使用 HTML 格式输出变量

> ID：424354
> 
> 赞同：2
> 
> 时间：2009-01-08T14:11:29.767
> 
> 标签：apache-flex, mxml

我正在尝试输出一个包含 4 个变量的句子，它们的值使用以下代码加粗：

```
<mx:Text width="100%" y="307">
    <mx:htmlText>
        <![CDATA[Showing data from <b>{labelStartTime.text} {labelStartDate.text}</b> to <b>{labelEndTime.text} {labelEndDate.text}</b>]]>
    </mx:htmlText>
</mx:Text> 
```

但是，这只是输出变量名称，而不是它们的值。我确定我缺少一些简单的东西，但我会很感激任何指示。

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T15:24:02.523

我知道一种解决方法：

动作脚本：

```
private var variable:String = "Variable String";
private var str:String = "<i><b>" + Variable + "</b></i>"; 
```

xml:

```
<Text htmlText="{str}" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T15:29:27.083

我认为不可能像这样直接在 CDATA 部分中添加绑定，但您确实有几个选择：

1.  使用一个函数，利用 BindingUtils.bindSetter ：

    ```
    import mx.binding.utils.BindingUtils;
    //called on creationComplete
    private function init():void
    {
        BindingUtils.bindSetter(setHtmlText, labelStartTime, "text");
        BindingUtils.bindSetter(setHtmlText, labelStartDate, "text");
        BindingUtils.bindSetter(setHtmlText, labelEndTime, "text");
        BindingUtils.bindSetter(setHtmlText, labelEndDate, "text");
    }

    private function setHtmlText(val:String):void
    {
        myText.htmlText = "Showing data from <b>" + 
                            labelStartTime.text + " " + 
                            labelStartDate.text + "</b> to <b>" + 
                            labelEndTime.text + " " +
                            labelEndDate.text + "</b>";
    }
    ```

2.  或者简单地对标签进行编码并将它们直接插入到属性中：

    ```
    <mx:Text id="myText" width="100%" y="307" 
             htmlText="Showing data from &lt;b&gt;{labelStartTime.text} {labelStartDate.text}&lt;/b&gt; to &lt;b&gt;{labelEndTime.text} {labelEndDate.text}&lt;/b&gt;"/>
    ```

    这不是真的推荐，因为它使标记非常难以阅读，但你可能会因为这样的小事而侥幸逃脱。

# visual-studio-2008 - 在 32 位和 64 位调试环境中使用相同的调试设置启动外部程序

> ID：424356
> 
> 赞同：5
> 
> 时间：2009-01-08T14:11:49.643
> 
> 标签：visual-studio-2008, debugging

我们混合使用 32 位和 64 位开发环境。我们的一些类库是使用 32 位应用程序调试的，因此我们有“启动外部程序”和“工作目录”的调试设置。问题是设置需要不同，因为 32 位应用程序安装到

C:\Program Files\xxx（在 32 位开发环境上）或 C:\Program Files (x86)\xxx（在 64 位开发环境上）

有没有办法使用某种标记，如 %PROGRAMFILES% 或 $(ProgramFiles) 以便 Visual Studio 2008 知道在哪里寻找外部程序？

除了将解决方案文件（保存调试信息的位置）签入源代码控制之外，这不会是一个主要问题......所以从我们的源存储库获取最新版本的解决方案可以保持两者之间的调试设置程序文件位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-19T04:07:07.520

正如 BQ 所指出的，启动外部程序和工作目录存储在 .user 文件中。但是，您可以在 .csproj 和 .user 文件中使用 $(Program Files) 来进行与目录名称相关的任何设置...唯一的技巧是您必须手动编辑文本中的相关 .user 或 .csproj 文件编辑。

如果用户不在 Visual Studio 中编辑该值，它会保持它的值 $(ProgramFiles) 并在 32 位和 64 位环境中正确扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-20T21:37:25.397

这些调试设置“启动外部程序”和“工作目录”存储在 ProjectName.csproj.user 文件中，而不是解决方案 (.sln) 文件或项目 (.csproj) 文件中。通常，.user 文件不包含在源代码管理中，因为它们特定于进行调试的用户环境。

您可以维护两个单独的 .csproj.user 文件（每个环境一个）并在打开解决方案之前交换到正确的版本。不理想，但总比没有好。

# wcf - 增加 WCF 服务中的超时值

> ID：424358
> 
> 赞同：138
> 
> 时间：2009-01-08T14:12:39.983
> 
> 标签：wcf

如何将 WCF 服务的默认超时时间增加到大于 1 分钟？

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2009-01-08T14:20:43.027

你是指服务器端还是客户端？

对于客户端，您可能希望调整绑定元素的**sendTimeout**属性。对于服务，您可能需要调整绑定元素的**receiveTimeout**属性。

```
<system.serviceModel>
  <bindings>
    <netTcpBinding>
      <binding name="longTimeoutBinding"
        receiveTimeout="00:10:00" sendTimeout="00:10:00">
        <security mode="None"/>
      </binding>
    </netTcpBinding>
  </bindings>

  <services>
    <service name="longTimeoutService"
      behaviorConfiguration="longTimeoutBehavior">
      <endpoint address="net.tcp://localhost/longtimeout/"
        binding="netTcpBinding" bindingConfiguration="longTimeoutBinding" />
    </service>
.... 
```

当然，您必须将所需的端点映射到该特定绑定。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-01-08T14:21:52.850

在 Visual Studio 2008（或 2005，如果您安装了正确的 WCF 东西）的工具菜单下，有一个名为“WCF 服务配置编辑器”的选项。

从那里您可以更改客户端和服务的绑定选项，其中一个选项将用于超时。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-18T14:48:30.817

您可以选择两种方式：

1）通过客户端中的代码

```
public static void Main()
{
    Uri baseAddress = new Uri("http://localhost/MyServer/MyService");

    try
    {
        ServiceHost serviceHost = new ServiceHost(typeof(CalculatorService));

        WSHttpBinding binding = new WSHttpBinding();
        binding.OpenTimeout = new TimeSpan(0, 10, 0);
        binding.CloseTimeout = new TimeSpan(0, 10, 0);
        binding.SendTimeout = new TimeSpan(0, 10, 0);
        binding.ReceiveTimeout = new TimeSpan(0, 10, 0);

        serviceHost.AddServiceEndpoint("ICalculator", binding, baseAddress);
        serviceHost.Open();

        // The service can now be accessed.
        Console.WriteLine("The service is ready.");
        Console.WriteLine("Press <ENTER> to terminate service.");
        Console.WriteLine();
        Console.ReadLine();

    }
    catch (CommunicationException ex)
    {
        // Handle exception ...
    }
} 
```

2）通过Web服务器中的WebConfig

```
<configuration>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding openTimeout="00:10:00" 
                 closeTimeout="00:10:00" 
                 sendTimeout="00:10:00" 
                 receiveTimeout="00:10:00">
        </binding>
      </wsHttpBinding>
    </bindings>
  </system.serviceModel> 
```

更多细节请查看官方文档

[在绑定上配置超时值](https://msdn.microsoft.com/it-it/library/hh924831(v=vs.110).aspx)

[WSHttpBinding 类](https://msdn.microsoft.com/it-it/library/system.servicemodel.wshttpbinding(v=vs.110).aspx)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-08-05T18:14:05.503

不同的超时意味着不同的事情。当您在客户端上工作时..您可能主要查看 SendTimeout - 检查此参考 - 精彩且相关的解释： [http ://social.msdn.microsoft.com/Forums/en-US/wcf/thread /84551e45-19a2-4d0d-bcc0-516a4041943d/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/84551e45-19a2-4d0d-bcc0-516a4041943d/)

它说：

```
Brief summary of binding timeout knobs...

Client side:

SendTimeout is used to initialize the OperationTimeout, which governs the whole interaction for sending a message (including receiving a reply message in a request-reply case).  This timeout also applies when sending reply messages from a CallbackContract method.
OpenTimeout and CloseTimeout are used when opening and closing channels (when no explicit timeout value is passed).
ReceiveTimeout is not used.

Server side:

Send, Open, and Close Timeout same as on client (for Callbacks).
ReceiveTimeout is used by ServiceFramework layer to initialize the session-idle timeout. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-04T18:43:28.773

除了绑定超时（在`Timespan`s 中）之外，您可能还需要这个。这以秒为单位。

```
<system.web>
    <httpRuntime executionTimeout="600"/><!-- = 10 minutes --> 
```

# asp.net - 如何在 asp.net 中获取服务器/网站 IP 地址？

> ID：424361
> 
> 赞同：9
> 
> 时间：2009-01-08T14:13:44.927
> 
> 标签：asp.net

当用户请求进来时，我可以使用 Context.Request.UserHostAddress 来获取用户的 IP 地址。如何在运行时获取网站/服务器的 IP 地址？我有一些报告代码可供同一服务器上的多个网站使用，每个网站使用不同的 IP 地址。所以我需要能够在运行时检测网站的 IP 地址。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-08T14:16:10.023

System.Net.Dns.GetHostAddresses

顺便说一句，您必须将主机名作为参数传入，所以不妨试试这个：

```
System.Net.Dns.GetHostByAddress(System.Net.IPAddress.Parse(System.Web.HttpContext.Current.Request.UserHostName)).HostName; 
```

如果一切都失败了，那就按照老派的方式去做：

```
Response.Write(Request.ServerVariables["LOCAL_ADDR"]); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T14:55:16.607

谢谢亚历克斯，你的回答让我走上了正确的道路。这是执行我正在寻找的代码：

VB.NET：

```
System.Net.Dns.GetHostAddresses(Request.Url.Host)(0).ToString() 
```

或者

```
System.Net.Dns.GetHostEntry(Request.Url.Host).AddressList(0).ToString() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-19T06:55:59.330

```
 string siteName = "Your Site URL";
     string tempUrl = siteName.Replace("http://", "").Replace("https://", "").Trim();
     string[] SiteURLArr = tempUrl.Split('/');
     string SiteURL = SiteURLArr[0];
      System.Net.IPAddress[] ip = System.Net.Dns.GetHostAddresses(SiteURL);
     Response.Write(ip[0]); 
```

# c# - 枚举的字符串表示

> ID：424366
> 
> 赞同：945
> 
> 时间：2009-01-08T14:15:55.720
> 
> 标签：c#, enums

我有以下枚举：

```
public enum AuthenticationMethod
{
    FORMS = 1,
    WINDOWSAUTHENTICATION = 2,
    SINGLESIGNON = 3
} 
```

然而问题是，当我要求 AuthenticationMethod.FORMS 而不是 id 1 时，我需要“FORMS”这个词。

我为这个问题找到了以下解决方案（[链接](http://www.codeproject.com/Articles/11130/String-Enumerations-in-C)）：

首先，我需要创建一个名为“StringValue”的自定义属性：

```
public class StringValue : System.Attribute
{
    private readonly string _value;

    public StringValue(string value)
    {
        _value = value;
    }

    public string Value
    {
        get { return _value; }
    }

} 
```

然后我可以将此属性添加到我的枚举器中：

```
public enum AuthenticationMethod
{
    [StringValue("FORMS")]
    FORMS = 1,
    [StringValue("WINDOWS")]
    WINDOWSAUTHENTICATION = 2,
    [StringValue("SSO")]
    SINGLESIGNON = 3
} 
```

当然，我需要一些东西来检索那个 StringValue：

```
public static class StringEnum
{
    public static string GetStringValue(Enum value)
    {
        string output = null;
        Type type = value.GetType();

        //Check first in our cached results...

        //Look for our 'StringValueAttribute' 

        //in the field's custom attributes

        FieldInfo fi = type.GetField(value.ToString());
        StringValue[] attrs =
           fi.GetCustomAttributes(typeof(StringValue),
                                   false) as StringValue[];
        if (attrs.Length > 0)
        {
            output = attrs[0].Value;
        }

        return output;
    }
} 
```

现在很好，我已经有了获取枚举器字符串值的工具。然后我可以像这样使用它：

```
string valueOfAuthenticationMethod = StringEnum.GetStringValue(AuthenticationMethod.FORMS); 
```

好吧，现在所有这些工作都像一个魅力，但我发现它有很多工作。我想知道是否有更好的解决方案。

我还尝试了一些带有字典和静态属性的东西，但这也不是更好。

* * *

## 回答 #1

> 赞同：884
> 
> 时间：2009-01-08T14:29:12.947

尝试[类型安全枚举](http://www.javacamp.org/designPattern/enum.html)模式。

```
public sealed class AuthenticationMethod {

    private readonly String name;
    private readonly int value;

    public static readonly AuthenticationMethod FORMS = new AuthenticationMethod (1, "FORMS");
    public static readonly AuthenticationMethod WINDOWSAUTHENTICATION = new AuthenticationMethod (2, "WINDOWS");
    public static readonly AuthenticationMethod SINGLESIGNON = new AuthenticationMethod (3, "SSN");        

    private AuthenticationMethod(int value, String name){
        this.name = name;
        this.value = value;
    }

    public override String ToString(){
        return name;
    }

} 
```

* * *

**更新** 显式（或隐式）类型转换可以通过

*   使用映射添加静态字段

    ```
    private static readonly Dictionary<string, AuthenticationMethod> instance = new Dictionary<string,AuthenticationMethod>(); 
    ```

    *   nb 为了使“枚举成员”字段的初始化在调用实例构造函数时不会引发 NullReferenceException，请务必将 Dictionary 字段放在类中的“枚举成员”字段之前。这是因为静态字段初始化器是按声明顺序调用的，并且在静态构造函数之前，造成了奇怪且必要但令人困惑的情况，即可以在所有静态字段初始化之前和调用静态构造函数之前调用实例构造函数。
*   在实例构造函数中填充此映射

    ```
    instance[name] = this; 
    ```

*   并添加[用户定义的类型转换运算符](http://msdn.microsoft.com/en-us/library/09479473.aspx)

    ```
    public static explicit operator AuthenticationMethod(string str)
    {
        AuthenticationMethod result;
        if (instance.TryGetValue(str, out result))
            return result;
        else
            throw new InvalidCastException();
    } 
    ```

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2009-01-08T14:19:49.220

使用方法

```
Enum.GetName(Type MyEnumType,  object enumvariable) 
```

如（假设`Shipper`是一个定义的枚举）

```
Shipper x = Shipper.FederalExpress;
string s = Enum.GetName(typeof(Shipper), x); 
```

Enum 类上还有许多其他静态方法也值得研究......

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2009-01-08T14:20:37.097

您可以使用 ToString() 引用名称而不是值

```
Console.WriteLine("Auth method: {0}", AuthenticationMethod.Forms.ToString()); 
```

文档在这里：

[http://msdn.microsoft.com/en-us/library/16c1xs4z.aspx](http://msdn.microsoft.com/en-us/library/16c1xs4z.aspx)

...并且如果您以 Pascal Case 命名您的枚举（就像我所做的那样 - 例如 ThisIsMyEnumValue = 1 等），那么您可以使用一个非常简单的正则表达式来打印友好的形式：

```
static string ToFriendlyCase(this string EnumString)
{
    return Regex.Replace(EnumString, "(?!^)([A-Z])", " $1");
} 
```

可以很容易地从任何字符串调用：

```
Console.WriteLine("ConvertMyCrazyPascalCaseSentenceToFriendlyCase".ToFriendlyCase()); 
```

输出：

> 将我的疯狂帕斯卡案例句子转换为友好案例

这样可以节省在房子周围跑来跑去创建自定义属性并将它们附加到您的枚举或使用查找表将枚举值与友好字符串结合起来，最重要的是它是自我管理的，并且可以用于任何无限的 Pascal Case 字符串更可重复使用。当然，它不允许您使用与您的解决方案提供的枚举*不同的友好名称。*

不过，对于更复杂的场景，我确实喜欢您的原始解决方案。您可以将您的解决方案更进一步，让您的 GetStringValue 成为您的枚举的扩展方法，然后您就不需要像 StringEnum.GetStringValue 那样引用它...

```
public static string GetStringValue(this AuthenticationMethod value)
{
  string output = null;
  Type type = value.GetType();
  FieldInfo fi = type.GetField(value.ToString());
  StringValue[] attrs = fi.GetCustomAttributes(typeof(StringValue), false) as StringValue[];
  if (attrs.Length > 0)
    output = attrs[0].Value;
  return output;
} 
```

然后，您可以直接从您的枚举实例轻松访问它：

```
Console.WriteLine(AuthenticationMethod.SSO.GetStringValue()); 
```

* * *

## 回答 #4

> 赞同：74
> 
> 时间：2009-01-08T14:20:28.207

不幸的是，在枚举上获取属性的反射非常慢：

看到这个问题：[任何人都知道快速获取枚举值的自定义属性的方法吗？](https://stackoverflow.com/questions/17772)

`.ToString()`枚举也很慢。

您可以为枚举编写扩展方法：

```
public static string GetName( this MyEnum input ) {
    switch ( input ) {
        case MyEnum.WINDOWSAUTHENTICATION:
            return "Windows";
        //and so on
    }
} 
```

这不是很好，但会很快并且不需要属性或字段名称的反射。

* * *

**C#6 更新**

如果您可以使用 C#6，则 new`nameof`运算符适用于枚举，因此`nameof(MyEnum.WINDOWSAUTHENTICATION)`将`"WINDOWSAUTHENTICATION"`在*编译时*转换为，使其成为获取枚举名称的最快方法。

请注意，这会将显式枚举转换为内联常量，因此它不适用于变量中的枚举。所以：

```
nameof(AuthenticationMethod.FORMS) == "FORMS" 
```

但...

```
var myMethod = AuthenticationMethod.FORMS;
nameof(myMethod) == "myMethod" 
```

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2012-02-11T00:15:17.287

我使用扩展方法：

```
public static class AttributesHelperExtension
    {
        public static string ToDescription(this Enum value)
        {
            var da = (DescriptionAttribute[])(value.GetType().GetField(value.ToString())).GetCustomAttributes(typeof(DescriptionAttribute), false);
            return da.Length > 0 ? da[0].Description : value.ToString();
        }
} 
```

现在装饰`enum`：

```
public enum AuthenticationMethod
{
    [Description("FORMS")]
    FORMS = 1,
    [Description("WINDOWSAUTHENTICATION")]
    WINDOWSAUTHENTICATION = 2,
    [Description("SINGLESIGNON ")]
    SINGLESIGNON = 3
} 
```

你打电话时

`AuthenticationMethod.FORMS.ToDescription()`你会得到`"FORMS"`。

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2012-09-06T15:50:14.430

只需使用`ToString()`方法

```
public enum any{Tomato=0,Melon,Watermelon} 
```

要引用字符串`Tomato`，只需使用

```
any.Tomato.ToString(); 
```

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2015-09-22T20:46:21.773

使用 .Net 4.0 及更高版本可以非常简单地解决此问题。不需要其他代码。

```
public enum MyStatus
{
    Active = 1,
    Archived = 2
} 
```

要获取有关的字符串，只需使用：

```
MyStatus.Active.ToString("f"); 
```

或者

```
MyStatus.Archived.ToString("f");` 
```

该值将是“活动”或“存档”。

要在调用时查看不同的字符串格式（上面的“f”），`Enum.ToString`请参阅此[枚举格式字符串](https://docs.microsoft.com/en-us/dotnet/standard/base-types/enumeration-format-strings)页面

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2009-01-08T14:30:11.757

我使用 System.ComponentModel 命名空间中的 Description 属性。只需装饰枚举，然后使用此代码检索它：

```
public static string GetDescription<T>(this object enumerationValue)
            where T : struct
        {
            Type type = enumerationValue.GetType();
            if (!type.IsEnum)
            {
                throw new ArgumentException("EnumerationValue must be of Enum type", "enumerationValue");
            }

            //Tries to find a DescriptionAttribute for a potential friendly name
            //for the enum
            MemberInfo[] memberInfo = type.GetMember(enumerationValue.ToString());
            if (memberInfo != null && memberInfo.Length > 0)
            {
                object[] attrs = memberInfo[0].GetCustomAttributes(typeof(DescriptionAttribute), false);

                if (attrs != null && attrs.Length > 0)
                {
                    //Pull out the description value
                    return ((DescriptionAttribute)attrs[0]).Description;
                }
            }
            //If we have no description attribute, just return the ToString of the enum
            return enumerationValue.ToString();

        } 
```

举个例子：

```
public enum Cycle : int
{        
   [Description("Daily Cycle")]
   Daily = 1,
   Weekly,
   Monthly
} 
```

这段代码很好地迎合了不需要“友好名称”的枚举，并且将只返回枚举的 .ToString() 。

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2014-01-20T21:13:47.033

我真的很喜欢 Jakub Šturc 的回答，但缺点是您不能将它与 switch-case 语句一起使用。这是他的答案的略微修改版本，可以与 switch 语句一起使用：

```
public sealed class AuthenticationMethod
{
    #region This code never needs to change.
    private readonly string _name;
    public readonly Values Value;

    private AuthenticationMethod(Values value, String name){
        this._name = name;
        this.Value = value;
    }

    public override String ToString(){
        return _name;
    }
    #endregion

    public enum Values
    {
        Forms = 1,
        Windows = 2,
        SSN = 3
    }

    public static readonly AuthenticationMethod FORMS = new AuthenticationMethod (Values.Forms, "FORMS");
    public static readonly AuthenticationMethod WINDOWSAUTHENTICATION = new AuthenticationMethod (Values.Windows, "WINDOWS");
    public static readonly AuthenticationMethod SINGLESIGNON = new AuthenticationMethod (Values.SSN, "SSN");
} 
```

因此，您可以获得 Jakub Šturc 答案的所有好处，此外，我们可以将它与 switch 语句一起使用，如下所示：

```
var authenticationMethodVariable = AuthenticationMethod.FORMS;  // Set the "enum" value we want to use.
var methodName = authenticationMethodVariable.ToString();       // Get the user-friendly "name" of the "enum" value.

// Perform logic based on which "enum" value was chosen.
switch (authenticationMethodVariable.Value)
{
    case authenticationMethodVariable.Values.Forms: // Do something
        break;
    case authenticationMethodVariable.Values.Windows: // Do something
        break;
    case authenticationMethodVariable.Values.SSN: // Do something
        break;      
} 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2009-01-08T15:52:42.933

我结合了上面的几个建议，并结合了一些缓存。现在，我从网上某处找到的一些代码中得到了这个想法，但我既不记得我从哪里得到它，也记不起它。因此，如果有人发现类似的东西，请在出处发表评论。

无论如何，使用涉及类型转换器，因此如果您绑定到 UI，它“正常工作”。您可以通过从类型转换器初始化为静态方法来扩展 Jakub 的模式以快速查找代码。

基本用法如下所示

```
[TypeConverter(typeof(CustomEnumTypeConverter<MyEnum>))]
public enum MyEnum
{
    // The custom type converter will use the description attribute
    [Description("A custom description")]
    ValueWithCustomDescription,

   // This will be exposed exactly.
   Exact
} 
```

自定义枚举类型转换器的代码如下：

```
public class CustomEnumTypeConverter<T> : EnumConverter
    where T : struct
{
    private static readonly Dictionary<T,string> s_toString = 
      new Dictionary<T, string>();

    private static readonly Dictionary<string, T> s_toValue = 
      new Dictionary<string, T>();

    private static bool s_isInitialized;

    static CustomEnumTypeConverter()
    {
        System.Diagnostics.Debug.Assert(typeof(T).IsEnum,
          "The custom enum class must be used with an enum type.");
    }

    public CustomEnumTypeConverter() : base(typeof(T))
    {
        if (!s_isInitialized)
        {
            Initialize();
            s_isInitialized = true;
        }
    }

    protected void Initialize()
    {
        foreach (T item in Enum.GetValues(typeof(T)))
        {
            string description = GetDescription(item);
            s_toString[item] = description;
            s_toValue[description] = item;
        }
    }

    private static string GetDescription(T optionValue)
    {
        var optionDescription = optionValue.ToString();
        var optionInfo = typeof(T).GetField(optionDescription);
        if (Attribute.IsDefined(optionInfo, typeof(DescriptionAttribute)))
        {
            var attribute = 
              (DescriptionAttribute)Attribute.
                 GetCustomAttribute(optionInfo, typeof(DescriptionAttribute));
            return attribute.Description;
        }
        return optionDescription;
    }

    public override object ConvertTo(ITypeDescriptorContext context, 
       System.Globalization.CultureInfo culture, 
       object value, Type destinationType)
    {
        var optionValue = (T)value;

        if (destinationType == typeof(string) && 
            s_toString.ContainsKey(optionValue))
        {
            return s_toString[optionValue];
        }

        return base.ConvertTo(context, culture, value, destinationType);
    }

    public override object ConvertFrom(ITypeDescriptorContext context, 
       System.Globalization.CultureInfo culture, object value)
    {
        var stringValue = value as string;

        if (!string.IsNullOrEmpty(stringValue) && s_toValue.ContainsKey(stringValue))
        {
            return s_toValue[stringValue];
        }

        return base.ConvertFrom(context, culture, value);
    }
} 
```

}

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2011-12-02T07:43:50.720

**更新：** 8 年后访问此页面，在很长一段时间没有接触 C# 之后，看起来我的答案不再是最佳解决方案。我真的很喜欢与属性函数绑定的转换器解决方案。

如果您正在阅读本文，请确保您还查看了其他答案。
（提示：他们在这个之上）

* * *

和你们中的大多数人一样，我真的很喜欢[Jakub Šturc 选择的答案](https://stackoverflow.com/questions/424366/c-sharp-string-enums/424414#424414)，但我也很讨厌复制粘贴代码，并尽量少做。

所以我决定我想要一个 EnumBase 类，它的大部分功能都是继承/内置的，让我专注于内容而不是行为。

这种方法的主要问题是基于这样一个事实，即尽管 Enum 值是类型安全的实例，但交互是与 Enum Class 类型的静态实现。所以在泛型魔法的帮助下，我想我终于得到了正确的组合。希望有人发现这和我一样有用。

我将从 Jakub 的示例开始，但使用继承和泛型：

```
public sealed class AuthenticationMethod : EnumBase<AuthenticationMethod, int>
{
    public static readonly AuthenticationMethod FORMS =
        new AuthenticationMethod(1, "FORMS");
    public static readonly AuthenticationMethod WINDOWSAUTHENTICATION =
        new AuthenticationMethod(2, "WINDOWS");
    public static readonly AuthenticationMethod SINGLESIGNON =
        new AuthenticationMethod(3, "SSN");

    private AuthenticationMethod(int Value, String Name)
        : base( Value, Name ) { }
    public new static IEnumerable<AuthenticationMethod> All
    { get { return EnumBase<AuthenticationMethod, int>.All; } }
    public static explicit operator AuthenticationMethod(string str)
    { return Parse(str); }
} 
```

这是基类：

```
using System;
using System.Collections.Generic;
using System.Linq; // for the .AsEnumerable() method call

// E is the derived type-safe-enum class
// - this allows all static members to be truly unique to the specific
//   derived class
public class EnumBase<E, T> where E: EnumBase<E, T>
{
    #region Instance code
    public T Value { get; private set; }
    public string Name { get; private set; }

    protected EnumBase(T EnumValue, string Name)
    {
        Value = EnumValue;
        this.Name = Name;
        mapping.Add(Name, this);
    }

    public override string ToString() { return Name; }
    #endregion

    #region Static tools
    static private readonly Dictionary<string, EnumBase<E, T>> mapping;
    static EnumBase() { mapping = new Dictionary<string, EnumBase<E, T>>(); }
    protected static E Parse(string name)
    {
        EnumBase<E, T> result;
        if (mapping.TryGetValue(name, out result))
        {
            return (E)result;
        }

        throw new InvalidCastException();
    }
    // This is protected to force the child class to expose it's own static
    // method.
    // By recreating this static method at the derived class, static
    // initialization will be explicit, promising the mapping dictionary
    // will never be empty when this method is called.
    protected static IEnumerable<E> All
    { get { return mapping.Values.AsEnumerable().Cast<E>(); } }
    #endregion
} 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2015-04-17T21:50:01.767

在您的问题中，您从未说过您实际上在任何地方都需要枚举的数值。

如果你不需要并且只需要一个字符串类型的枚举（它不是一个整数类型，所以不能是枚举的基础），这是一种方法：

```
 static class AuthenticationMethod
    {
        public static readonly string
            FORMS = "Forms",
            WINDOWSAUTHENTICATION = "WindowsAuthentication";
    } 
```

您可以使用与 enum 相同的语法来引用它

```
if (bla == AuthenticationMethod.FORMS) 
```

它会比使用数值（比较字符串而不是数字）慢一点，但从好的方面来说，它不使用反射（慢）来访问字符串。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2012-03-22T13:12:24.007

如果您来这里是为了实现一个简单的“枚举”，但其值是字符串而不是整数，那么这是最简单的解决方案：

```
 public sealed class MetricValueList
    {
        public static readonly string Brand = "A4082457-D467-E111-98DC-0026B9010912";
        public static readonly string Name = "B5B5E167-D467-E111-98DC-0026B9010912";
    } 
```

执行：

```
var someStringVariable = MetricValueList.Brand; 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2012-04-17T01:29:27.290

我如何将其作为扩展方法解决：

```
using System.ComponentModel;
public static string GetDescription(this Enum value)
{
    var descriptionAttribute = (DescriptionAttribute)value.GetType()
        .GetField(value.ToString())
        .GetCustomAttributes(false)
        .Where(a => a is DescriptionAttribute)
        .FirstOrDefault();

    return descriptionAttribute != null ? descriptionAttribute.Description : value.ToString();
} 
```

枚举：

```
public enum OrderType
{
    None = 0,
    [Description("New Card")]
    NewCard = 1,
    [Description("Reload")]
    Refill = 2
} 
```

用法（其中 o.OrderType 是与枚举同名的属性）：

```
o.OrderType.GetDescription() 
```

这给了我一串“新卡”或“重新加载”，而不是实际的枚举值 NewCard 和 Refill。

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2009-01-08T15:18:18.480

**我同意基思的观点，但我（还）不能投票。**

我使用静态方法和 swith 语句来准确返回我想要的。在我存储 tinyint 的数据库中，我的代码只使用实际的枚举，所以字符串是针对 UI 要求的。经过多次测试，这导致了最佳性能和对输出的最大控制。

```
public static string ToSimpleString(this enum)
{
     switch (enum)
     {
         case ComplexForms:
             return "ComplexForms";
             break;
     }
}

public static string ToFormattedString(this enum)
{
     switch (enum)
     {
         case ComplexForms:
             return "Complex Forms";
             break;
     }
} 
```

然而，根据某些说法，这可能会导致维护噩梦和一些代码异味。我试图留意那些很长且有很多枚举的枚举，或者那些经常更改的枚举。否则，这对我来说是一个很好的解决方案。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2009-01-08T21:14:17.887

当我遇到这个问题时，我首先尝试找到几个问题的答案：

*   我的枚举值的名称是否足够友好，或者我需要提供更友好的名称？
*   我需要往返吗？也就是说，我需要获取文本值并将它们解析为枚举值吗？
*   这是我需要为我的项目中的许多枚举做的事情，还是只是一个？
*   我将在哪种 UI 元素中呈现此信息 - 特别是，我将绑定到 UI 还是使用属性表？
*   这需要本地化吗？

最简单的方法是使用`Enum.GetValue`（并支持使用 往返`Enum.Parse`）。`TypeConverter`正如 Steve Mitcham 建议的那样，通常还值得构建一个. 来支持 UI 绑定。`TypeConverter`（当你使用属性表时没有必要建立一个，这是关于属性表的好处之一。虽然上帝知道他们有自己的问题。）

一般来说，如果上述问题的答案表明这不起作用，我的下一步是创建并填充一个 static `Dictionary<MyEnum, string>`，或者可能是一个`Dictionary<Type, Dictionary<int, string>>`. 我倾向于跳过中间的 decorate-the-code-with-attributes 步骤，因为接下来通常需要在部署后更改友好值（通常，但并非总是如此，因为本地化）。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2010-12-13T02:57:35.730

我想将此作为对下面引用的帖子的评论发布，但因为我没有足够的代表而无法发布 - 所以请不要投反对票。该代码包含一个错误，我想向尝试使用此解决方案的个人指出这一点：

> ```
> [TypeConverter(typeof(CustomEnumTypeConverter(typeof(MyEnum))]
> public enum MyEnum
> {
>   // The custom type converter will use the description attribute
>   [Description("A custom description")]
>   ValueWithCustomDescription,
>   // This will be exposed exactly.
>   Exact
> } 
> ```

应该

```
[TypeConverter(typeof(CustomEnumTypeConverter<MyEnum>))]
public enum MyEnum
{
  // The custom type converter will use the description attribute
  [Description("A custom description")]
  ValueWithCustomDescription,

  // This will be exposed exactly.
  Exact
} 
```

辉煌！

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2019-10-24T04:01:43.890

我创建了一个基类，用于在 .NET 中创建字符串值枚举。它只是一个 C# 文件，您可以将其复制并粘贴到您的项目中，或者通过名为[StringEnum](https://www.nuget.org/packages/StringEnum/)的 NuGet 包安装。 [GitHub 回购](https://github.com/gerardog/StringEnum)

*   如果类使用 xml 注释进行注释，Intellisense 将建议枚举名称`<completitionlist>`。（适用于 C# 和 VB）

![智能感知演示](https://raw.githubusercontent.com/gerardog/StringEnum/master/images/intellisense.gif)

*   用法类似于常规枚举：

```
///<completionlist cref="HexColor"/> 
class HexColor : StringEnum<HexColor>
{
    public static readonly HexColor Blue = Create("#FF0000");
    public static readonly HexColor Green = Create("#00FF00");
    public static readonly HexColor Red = Create("#000FF");
} 
```

```
 // Static Parse Method
    HexColor.Parse("#FF0000") // => HexColor.Red
    HexColor.Parse("#ff0000", caseSensitive: false) // => HexColor.Red
    HexColor.Parse("invalid") // => throws InvalidOperationException

    // Static TryParse method.
    HexColor.TryParse("#FF0000") // => HexColor.Red
    HexColor.TryParse("#ff0000", caseSensitive: false) // => HexColor.Red
    HexColor.TryParse("invalid") // => null

    // Parse and TryParse returns the preexistent instances
    object.ReferenceEquals(HexColor.Parse("#FF0000"), HexColor.Red) // => true

    // Conversion from your `StringEnum` to `string`
    string myString1 = HexColor.Red.ToString(); // => "#FF0000"
    string myString2 = HexColor.Red; // => "#FF0000" (implicit cast) 
```

## 安装：

*   将以下 StringEnum 基类粘贴到您的项目中。（[最新版本](https://github.com/gerardog/StringEnum/blob/master/StringEnum/StringEnum.cs)）
*   或者安装[**StringEnum**](https://www.nuget.org/packages/StringEnum/) NuGet 包，它基于`.Net Standard 1.0`所以它在`.Net Core`>= 1.0、`.Net Framework`>= 4.5、`Mono`>= 4.6 等上运行。

```
 /// <summary>
    /// Base class for creating string-valued enums in .NET.<br/>
    /// Provides static Parse() and TryParse() methods and implicit cast to string.
    /// </summary>
    /// <example> 
    /// <code>
    /// class Color : StringEnum &lt;Color&gt;
    /// {
    ///     public static readonly Color Blue = Create("Blue");
    ///     public static readonly Color Red = Create("Red");
    ///     public static readonly Color Green = Create("Green");
    /// }
    /// </code>
    /// </example>
    /// <typeparam name="T">The string-valued enum type. (i.e. class Color : StringEnum&lt;Color&gt;)</typeparam>
    public abstract class StringEnum<T> : IEquatable<T> where T : StringEnum<T>, new()
    {
        protected string Value;
        private static Dictionary<string, T> valueDict = new Dictionary<string, T>();
        protected static T Create(string value)
        {
            if (value == null)
                return null; // the null-valued instance is null.

            var result = new T() { Value = value };
            valueDict.Add(value, result);
            return result;
        }

        public static implicit operator string(StringEnum<T> enumValue) => enumValue.Value;
        public override string ToString() => Value;

        public static bool operator !=(StringEnum<T> o1, StringEnum<T> o2) => o1?.Value != o2?.Value;
        public static bool operator ==(StringEnum<T> o1, StringEnum<T> o2) => o1?.Value == o2?.Value;

        public override bool Equals(object other) => this.Value.Equals((other as T)?.Value ?? (other as string));
        bool IEquatable<T>.Equals(T other) => this.Value.Equals(other.Value);
        public override int GetHashCode() => Value.GetHashCode();

        /// <summary>
        /// Parse the <paramref name="value"/> specified and returns a valid <typeparamref name="T"/> or else throws InvalidOperationException.
        /// </summary>
        /// <param name="value">The string value representad by an instance of <typeparamref name="T"/>. Matches by string value, not by the member name.</param>
        /// <param name="caseSensitive">If true, the strings must match case and takes O(log n). False allows different case but is little bit slower (O(n))</param>
        public static T Parse(string value, bool caseSensitive = true)
        {
            var result = TryParse(value, caseSensitive);
            if (result == null)
                throw new InvalidOperationException((value == null ? "null" : $"'{value}'") + $" is not a valid {typeof(T).Name}");

            return result;
        }

        /// <summary>
        /// Parse the <paramref name="value"/> specified and returns a valid <typeparamref name="T"/> or else returns null.
        /// </summary>
        /// <param name="value">The string value representad by an instance of <typeparamref name="T"/>. Matches by string value, not by the member name.</param>
        /// <param name="caseSensitive">If true, the strings must match case. False allows different case but is slower: O(n)</param>
        public static T TryParse(string value, bool caseSensitive = true)
        {
            if (value == null) return null;
            if (valueDict.Count == 0) System.Runtime.CompilerServices.RuntimeHelpers.RunClassConstructor(typeof(T).TypeHandle); // force static fields initialization
            if (caseSensitive)
            {
                if (valueDict.TryGetValue(value, out T item))
                    return item;
                else
                    return null;
            }
            else
            {
                // slower O(n) case insensitive search
                return valueDict.FirstOrDefault(f => f.Key.Equals(value, StringComparison.OrdinalIgnoreCase)).Value;
                // Why Ordinal? => https://esmithy.net/2007/10/15/why-stringcomparisonordinal-is-usually-the-right-choice/
            }
        }
    } 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2012-02-01T16:00:37.340

我的变种

```
public struct Colors
{
    private String current;

    private static string red = "#ff0000";
    private static string green = "#00ff00";
    private static string blue = "#0000ff";

    private static IList<String> possibleColors; 

    public static Colors Red { get { return (Colors) red; } }
    public static Colors Green { get { return (Colors) green; } }
    public static Colors Blue { get { return (Colors) blue; } }

    static Colors()
    {
        possibleColors = new List<string>() {red, green, blue};
    }

    public static explicit operator String(Colors value)
    {
        return value.current;
    }

    public static explicit operator Colors(String value)
    {
        if (!possibleColors.Contains(value))
        {
            throw new InvalidCastException();
        }

        Colors color = new Colors();
        color.current = value;
        return color;
    }

    public static bool operator ==(Colors left, Colors right)
    {
        return left.current == right.current;
    }

    public static bool operator !=(Colors left, Colors right)
    {
        return left.current != right.current;
    }

    public bool Equals(Colors other)
    {
        return Equals(other.current, current);
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj)) return false;
        if (obj.GetType() != typeof(Colors)) return false;
        return Equals((Colors)obj);
    }

    public override int GetHashCode()
    {
        return (current != null ? current.GetHashCode() : 0);
    }

    public override string ToString()
    {
        return current;
    }
} 
```

代码看起来有点难看，但是这个结构的用法很有代表性。

```
Colors color1 = Colors.Red;
Console.WriteLine(color1); // #ff0000

Colors color2 = (Colors) "#00ff00";
Console.WriteLine(color2); // #00ff00

// Colors color3 = "#0000ff"; // Compilation error
// String color4 = Colors.Red; // Compilation error

Colors color5 = (Colors)"#ff0000";
Console.WriteLine(color1 == color5); // True

Colors color6 = (Colors)"#00ff00";
Console.WriteLine(color1 == color6); // False 
```

另外，我认为，如果需要大量此类枚举，则可能会使用代码生成（例如 T4）。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2009-01-08T15:41:08.933

选项1：

```
public sealed class FormsAuth
{
     public override string ToString{return "Forms Authtentication";}
}
public sealed class WindowsAuth
{
     public override string ToString{return "Windows Authtentication";}
}

public sealed class SsoAuth
{
     public override string ToString{return "SSO";}
} 
```

进而

```
object auth = new SsoAuth(); //or whatever

//...
//...
// blablabla

DoSomethingWithTheAuth(auth.ToString()); 
```

选项 2：

```
public enum AuthenticationMethod
{
        FORMS = 1,
        WINDOWSAUTHENTICATION = 2,
        SINGLESIGNON = 3
}

public class MyClass
{
    private Dictionary<AuthenticationMethod, String> map = new Dictionary<AuthenticationMethod, String>();
    public MyClass()
    {
         map.Add(AuthenticationMethod.FORMS,"Forms Authentication");
         map.Add(AuthenticationMethod.WINDOWSAUTHENTICATION ,"Windows Authentication");
         map.Add(AuthenticationMethod.SINGLESIGNON ,"SSo Authentication");
    }
} 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2009-11-20T20:55:36.727

如果您考虑一下我们要解决的问题，那根本就不是我们需要的枚举。我们需要一个允许一定数量的值相互关联的对象；换句话说，定义一个类。

Jakub Šturc 的类型安全枚举模式是我在这里看到的最佳选择。

看它：

*   它有一个私有构造函数，所以只有类本身可以定义允许的值。
*   它是一个密封类，因此不能通过继承修改值。
*   它是类型安全的，允许您的方法只需要该类型。
*   访问这些值不会影响反射性能。
*   最后，它可以修改为将两个以上的字段关联在一起，例如名称、描述和数值。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2013-02-06T13:46:33.660

对我来说，务实的方法是类内类，示例：

```
public class MSEModel
{
    class WITS
    {
        public const string DATE = "5005";
        public const string TIME = "5006";
        public const string MD = "5008";
        public const string ROP = "5075";
        public const string WOB = "5073";
        public const string RPM = "7001";
... 
    } 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2013-02-21T14:59:50.780

这是完成将字符串与枚举关联的任务的另一种方法：

```
struct DATABASE {
    public enum enums {NOTCONNECTED, CONNECTED, ERROR}
    static List<string> strings =
        new List<string>() {"Not Connected", "Connected", "Error"};

    public string GetString(DATABASE.enums value) {
        return strings[(int)value];
    }
} 
```

这个方法是这样调用的：

```
public FormMain() {
    DATABASE dbEnum;

    string enumName = dbEnum.GetString(DATABASE.enums.NOTCONNECTED);
} 
```

您可以将相关的枚举分组到自己的结构中。由于此方法使用 enum 类型，因此您可以在`GetString()`调用时使用 Intellisense 显示枚举列表。

您可以选择在`DATABASE`结构上使用 new 运算符。不使用它意味着在第一次调用`List`之前不会分配字符串。`GetString()`

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2014-12-10T10:30:15.380

这里有很多很好的答案，但在我的情况下并没有解决我想要的“字符串枚举”，它是：

1.  可用于 switch 语句，例如 switch(myEnum)
2.  可以在函数参数中使用，例如 foo(myEnum type)
3.  可以引用例如 myEnum.FirstElement
4.  我可以使用字符串，例如 foo("FirstElement") == foo(myEnum.FirstElement)

1,2 & 4 实际上可以用字符串的 C# Typedef 来解决（因为字符串在 c# 中是可切换的）

3 可以通过静态常量字符串来解决。因此，如果您有相同的需求，这是最简单的方法：

```
public sealed class Types
{

    private readonly String name;

    private Types(String name)
    {
        this.name = name;

    }

    public override String ToString()
    {
        return name;
    }

    public static implicit operator Types(string str)
    {
        return new Types(str);

    }
    public static implicit operator string(Types str)
    {
        return str.ToString();
    }

    #region enum

    public const string DataType = "Data";
    public const string ImageType = "Image";
    public const string Folder = "Folder";
    #endregion

} 
```

这允许例如：

```
 public TypeArgs(Types SelectedType)
    {
        Types SelectedType = SelectedType
    } 
```

和

```
public TypeObject CreateType(Types type)
    {
        switch (type)
        {

            case Types.ImageType:
              //
                break;

            case Types.DataType:
             //
                break;

        }
    } 
```

其中 CreateType 可以用字符串或类型调用。**然而，缺点是任何字符串都会自动成为有效的 enum**，这可以被修改，但它需要某种 init 函数......或者可能使它们显式地转换为内部？

现在，如果 int 值对您很重要（也许是为了比较速度），您*可以*使用 Jakub Šturc 的一些想法并做一些疯狂的事情*，*这是我的尝试：

```
 public sealed class Types
{
    private static readonly Dictionary<string, Types> strInstance = new Dictionary<string, Types>();
    private static readonly Dictionary<int, Types> intInstance = new Dictionary<int, Types>();

    private readonly String name;
    private static int layerTypeCount = 0;
    private int value;
    private Types(String name)
    {
        this.name = name;
        value = layerTypeCount++;
        strInstance[name] = this;
        intInstance[value] = this;
    }

    public override String ToString()
    {
        return name;
    }

    public static implicit operator Types(int val)
    {
        Types result;
        if (intInstance.TryGetValue(val, out result))
            return result;
        else
            throw new InvalidCastException();
    }

    public static implicit operator Types(string str)
    {
        Types result;
        if (strInstance.TryGetValue(str, out result))
        {
            return result;
        }
        else
        {
            result = new Types(str);
            return result;
        }

    }
    public static implicit operator string(Types str)
    {
        return str.ToString();
    }

    public static bool operator ==(Types a, Types b)
    {
        return a.value == b.value;
    }
    public static bool operator !=(Types a, Types b)
    {
        return a.value != b.value;
    }

    #region enum

    public const string DataType = "Data";
    public const string ImageType = "Image";

    #endregion

} 
```

但当然“类型 bob = 4;” 除非您首先初始化它们，否则将毫无意义，这会有点失败...

但理论上 TypeA == TypeB 会更快......

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2015-09-28T09:33:15.713

如果我对您的理解正确，您可以简单地使用 .ToString() 从值中检索枚举的名称（假设它已经被转换为枚举）；如果您有裸 int （可以说来自数据库或其他东西），您可以先将其转换为枚举。以下两种方法都会为您提供枚举名称。

```
AuthenticationMethod myCurrentSetting = AuthenticationMethod.FORMS;
Console.WriteLine(myCurrentSetting); // Prints: FORMS
string name = Enum.GetNames(typeof(AuthenticationMethod))[(int)myCurrentSetting-1];
Console.WriteLine(name); // Prints: FORMS 
```

但请记住，第二种技术假设您使用的是整数并且您的索引是基于 1 的（而不是基于 0）。相比之下，函数 GetNames 也很重，每次调用它时都会生成一个完整的数组。正如您在第一种技术中看到的那样， .ToString() 实际上是隐式调用的。当然，答案中已经提到了这两者，我只是想澄清它们之间的区别。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2016-10-03T07:33:49.657

*旧帖子但是...*

这个问题的答案实际上可能非常简单。使用[Enum.ToString()](https://msdn.microsoft.com/en-us/library/a0h36syw(v=vs.110).aspx)函数

该函数有 6 个重载，可以使用 Enum.Tostring("F") 或 Enum.ToString() 返回字符串值。无需为其他事情烦恼。这是一个[工作演示](http://rextester.com/DEDS77322)

请注意，此解决方案可能不适用于所有编译器（[此演示无法按预期工作](http://csharppad.com/gist/65ccdb98d721facd2cb97c2333688a82)），但至少适用于最新的编译器。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2010-06-20T12:33:50.887

基于 MSDN：http: [//msdn.microsoft.com/en-us/library/cc138362.aspx](http://msdn.microsoft.com/en-us/library/cc138362.aspx)

```
foreach (string str in Enum.GetNames(typeof(enumHeaderField)))
{
    Debug.WriteLine(str);
} 
```

str 将是字段的名称

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2013-02-15T19:21:19.177

好吧，在阅读了以上所有内容之后，我觉得这些家伙将枚举数转换为字符串的问题过于复杂了。我喜欢在枚举字段上拥有属性的想法，但我认为属性主要用于元数据，但在你的情况下，我认为你所需要的只是某种本地化。

```
public enum Color 
{ Red = 1, Green = 2, Blue = 3}

public static EnumUtils 
{
   public static string GetEnumResourceString(object enumValue)
    {
        Type enumType = enumValue.GetType();
        string value = Enum.GetName(enumValue.GetType(), enumValue);
        string resourceKey = String.Format("{0}_{1}", enumType.Name, value);
        string result = Resources.Enums.ResourceManager.GetString(resourceKey);
        if (string.IsNullOrEmpty(result))
        {
            result = String.Format("{0}", value);
        }
        return result;
    }
} 
```

现在，如果我们尝试调用上述方法，我们可以这样调用它

```
public void Foo()
{
  var col = Color.Red;
  Console.WriteLine (EnumUtils.GetEnumResourceString (col));
} 
```

您需要做的只是创建一个包含所有枚举器值和相应字符串的资源文件

```
资源名称 资源值
Color_Red 我的字符串颜色为红色
颜色_Blue Blueeey
颜色_绿巨人颜色

```

实际上非常好的一点是，如果您需要本地化您的应用程序，这将非常有帮助，因为您需要做的只是用您的新语言创建另一个资源文件！和沃拉！

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2014-11-03T22:03:02.127

当我处于这种情况时，我会提出以下解决方案。

作为一个消费阶层，你可以拥有

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace MyApp.Dictionaries
{
    class Greek
    {

        public static readonly string Alpha = "Alpha";
        public static readonly string Beta = "Beta";
        public static readonly string Gamma = "Gamma";
        public static readonly string Delta = "Delta";

        private static readonly BiDictionary<int, string> Dictionary = new BiDictionary<int, string>();

        static Greek() {
            Dictionary.Add(1, Alpha);
            Dictionary.Add(2, Beta);
            Dictionary.Add(3, Gamma);
            Dictionary.Add(4, Delta);
        }

        public static string getById(int id){
            return Dictionary.GetByFirst(id);
        }

        public static int getByValue(string value)
        {
            return Dictionary.GetBySecond(value);
        }

    }
} 
```

并使用双向字典：基于此（[https://stackoverflow.com/a/255638/986160](https://stackoverflow.com/a/255638/986160)）假设键将与字典中的单个值相关联并且类似于（[https://stackoverflow.com/a /255630/986160](https://stackoverflow.com/a/255630/986160)）但更优雅一点。这本字典也是可枚举的，你可以从整数到字符串来回切换。此外，除了此类之外，您的代码库中不必有任何字符串。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace MyApp.Dictionaries
{

    class BiDictionary<TFirst, TSecond> : IEnumerable
    {
        IDictionary<TFirst, TSecond> firstToSecond = new Dictionary<TFirst, TSecond>();
        IDictionary<TSecond, TFirst> secondToFirst = new Dictionary<TSecond, TFirst>();

        public void Add(TFirst first, TSecond second)
        {
            firstToSecond.Add(first, second);
            secondToFirst.Add(second, first);
        }

        public TSecond this[TFirst first]
        {
            get { return GetByFirst(first); }
        }

        public TFirst this[TSecond second]
        {
            get { return GetBySecond(second); }
        }

        public TSecond GetByFirst(TFirst first)
        {
            return firstToSecond[first];
        }

        public TFirst GetBySecond(TSecond second)
        {
            return secondToFirst[second];
        }

        public IEnumerator GetEnumerator()
        {
            return GetFirstEnumerator();
        }

        public IEnumerator GetFirstEnumerator()
        {
            return firstToSecond.GetEnumerator();
        }

        public IEnumerator GetSecondEnumerator()
        {
            return secondToFirst.GetEnumerator();
        }
    }
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-09-06T17:35:42.313

对于较大的字符串枚举集，列出的示例可能会变得令人厌烦。如果你想要一个状态码列表，或者其他基于字符串的枚举列表，属性系统使用起来很烦人，而带有自身实例的静态类配置起来很烦人。对于我自己的解决方案，我使用 T4 模板来简化字符串支持的枚举。结果类似于 HttpMethod 类的工作方式。

你可以像这样使用它：

```
 string statusCode = ResponseStatusCode.SUCCESS; // Automatically converts to string when needed
    ResponseStatusCode codeByValueOf = ResponseStatusCode.ValueOf(statusCode); // Returns null if not found

    // Implements TypeConverter so you can use it with string conversion methods.
    var converter = System.ComponentModel.TypeDescriptor.GetConverter(typeof(ResponseStatusCode));
    ResponseStatusCode code = (ResponseStatusCode) converter.ConvertFromInvariantString(statusCode);

    // You can get a full list of the values
    bool canIterateOverValues = ResponseStatusCode.Values.Any(); 

    // Comparisons are by value of the "Name" property. Not by memory pointer location.
    bool implementsByValueEqualsEqualsOperator = "SUCCESS" == ResponseStatusCode.SUCCESS; 
```

您从 Enum.tt 文件开始。

```
<#@ include file="StringEnum.ttinclude" #>

<#+
public static class Configuration
{
    public static readonly string Namespace = "YourName.Space";
    public static readonly string EnumName = "ResponseStatusCode";
    public static readonly bool IncludeComments = true;

    public static readonly object Nodes = new
    {
        SUCCESS = "The response was successful.",
        NON_SUCCESS = "The request was not successful.",
        RESOURCE_IS_DISCONTINUED = "The resource requested has been discontinued and can no longer be accessed."
    };
}
#> 
```

然后，添加 StringEnum.ttinclude 文件。

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Reflection" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cs" #>
<#@ CleanupBehavior processor="T4VSHost" CleanupAfterProcessingtemplate="true" #>

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Linq;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;

namespace <#= Configuration.Namespace #>
{
    /// <summary>
    /// TypeConverter implementations allow you to use features like string.ToNullable(T).
    /// </summary>
    public class <#= Configuration.EnumName #>TypeConverter : TypeConverter
    {
        public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)
        {
            return sourceType == typeof(string) || base.CanConvertFrom(context, sourceType);
        }

        public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)
        {
            var casted = value as string;

            if (casted != null)
            {
                var result = <#= Configuration.EnumName #>.ValueOf(casted);
                if (result != null)
                {
                    return result;
                }
            }

            return base.ConvertFrom(context, culture, value);
        }

        public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
        {
            var casted = value as <#= Configuration.EnumName #>;
            if (casted != null && destinationType == typeof(string))
            {
                return casted.ToString();
            }

            return base.ConvertTo(context, culture, value, destinationType);
        }
    }

    [TypeConverter(typeof(<#= Configuration.EnumName #>TypeConverter))]
    public class <#= Configuration.EnumName #> : IEquatable<<#= Configuration.EnumName #>>
    {
//---------------------------------------------------------------------------------------------------
// V A L U E S _ L I S T
//---------------------------------------------------------------------------------------------------
<# Write(Helpers.PrintEnumProperties(Configuration.Nodes)); #>

        private static List<<#= Configuration.EnumName #>> _list { get; set; } = null;
        public static List<<#= Configuration.EnumName #>> ToList()
        {
            if (_list == null)
            {
                _list = typeof(<#= Configuration.EnumName #>).GetFields().Where(x => x.IsStatic && x.IsPublic && x.FieldType == typeof(<#= Configuration.EnumName #>))
                    .Select(x => x.GetValue(null)).OfType<<#= Configuration.EnumName #>>().ToList();
            }

            return _list;
        }

        public static List<<#= Configuration.EnumName #>> Values()
        {
            return ToList();
        }

        /// <summary>
        /// Returns the enum value based on the matching Name of the enum. Case-insensitive search.
        /// </summary>
        /// <param name="key"></param>
        /// <returns></returns>
        public static <#= Configuration.EnumName #> ValueOf(string key)
        {
            return ToList().FirstOrDefault(x => string.Compare(x.Name, key, true) == 0);
        }

//---------------------------------------------------------------------------------------------------
// I N S T A N C E _ D E F I N I T I O N
//---------------------------------------------------------------------------------------------------      
        public string Name { get; private set; }
        public string Description { get; private set; }
        public override string ToString() { return this.Name; }

        /// <summary>
        /// Implcitly converts to string.
        /// </summary>
        /// <param name="d"></param>
        public static implicit operator string(<#= Configuration.EnumName #> d)
        {
            return d.ToString();
        }

        /// <summary>
        /// Compares based on the == method. Handles nulls gracefully.
        /// </summary>
        /// <param name="a"></param>
        /// <param name="b"></param>
        /// <returns></returns>
        public static bool operator !=(<#= Configuration.EnumName #> a, <#= Configuration.EnumName #> b)
        {
            return !(a == b);
        }

        /// <summary>
        /// Compares based on the .Equals method. Handles nulls gracefully.
        /// </summary>
        /// <param name="a"></param>
        /// <param name="b"></param>
        /// <returns></returns>
        public static bool operator ==(<#= Configuration.EnumName #> a, <#= Configuration.EnumName #> b)
        {
            return a?.ToString() == b?.ToString();
        }

        /// <summary>
        /// Compares based on the .ToString() method
        /// </summary>
        /// <param name="o"></param>
        /// <returns></returns>
        public override bool Equals(object o)
        {
            return this.ToString() == o?.ToString();
        }

        /// <summary>
        /// Compares based on the .ToString() method
        /// </summary>
        /// <param name="other"></param>
        /// <returns></returns>
        public bool Equals(<#= Configuration.EnumName #> other)
        {
            return this.ToString() == other?.ToString();
        }

        /// <summary>
        /// Compares based on the .Name property
        /// </summary>
        /// <returns></returns>
        public override int GetHashCode()
        {
            return this.Name.GetHashCode();
        }
    }
}

<#+

public static class Helpers
{
        public static string PrintEnumProperties(object nodes)
        {
            string o = "";
            Type nodesTp = Configuration.Nodes.GetType();
            PropertyInfo[] props = nodesTp.GetProperties().OrderBy(p => p.Name).ToArray();

            for(int i = 0; i < props.Length; i++)
            {
                var prop = props[i];
                if (Configuration.IncludeComments)
                {
                    o += "\r\n\r\n";
                    o += "\r\n        ///<summary>";
                    o += "\r\n        /// "+Helpers.PrintPropertyValue(prop, Configuration.Nodes);
                    o += "\r\n        ///</summary>";
                }

                o += "\r\n        public static readonly "+Configuration.EnumName+" "+prop.Name+ " = new "+Configuration.EnumName+"(){ Name = \""+prop.Name+"\", Description = "+Helpers.PrintPropertyValue(prop, Configuration.Nodes)+ "};";
            }

            o += "\r\n\r\n";

            return o;
        }

        private static Dictionary<string, string> GetValuesMap()
        {
            Type nodesTp = Configuration.Nodes.GetType();
            PropertyInfo[] props= nodesTp.GetProperties();
            var dic = new Dictionary<string,string>();
            for(int i = 0; i < props.Length; i++)
            {
                var prop = nodesTp.GetProperties()[i];
                dic[prop.Name] = prop.GetValue(Configuration.Nodes).ToString();
            }
            return dic;
        }

        public static string PrintMasterValuesMap(object nodes)
        {
            Type nodesTp = Configuration.Nodes.GetType();
            PropertyInfo[] props= nodesTp.GetProperties();
            string o = "        private static readonly Dictionary<string, string> ValuesMap = new Dictionary<string, string>()\r\n        {";
            for(int i = 0; i < props.Length; i++)
            {
                var prop = nodesTp.GetProperties()[i];
                o += "\r\n            { \""+prop.Name+"\", "+(Helpers.PrintPropertyValue(prop,Configuration.Nodes)+" },");
            }
            o += ("\r\n        };\r\n");

            return o;
        }

        public static string PrintPropertyValue(PropertyInfo prop, object objInstance)
        {
            switch(prop.PropertyType.ToString()){
                case "System.Double":
                    return prop.GetValue(objInstance).ToString()+"D";
                case "System.Float":
                    return prop.GetValue(objInstance).ToString()+"F";
                case "System.Decimal":
                    return prop.GetValue(objInstance).ToString()+"M";
                case "System.Long":
                    return prop.GetValue(objInstance).ToString()+"L";
                case "System.Boolean":
                case "System.Int16":
                case "System.Int32":
                    return prop.GetValue(objInstance).ToString().ToLowerInvariant();
                case "System.String":
                    return "\""+prop.GetValue(objInstance)+"\"";
            }

            return prop.GetValue(objInstance).ToString();
        }

        public static string _ (int numSpaces)
        {
            string o = "";
            for(int i = 0; i < numSpaces; i++){
                o += " ";
            }

            return o;
        }
}
#> 
```

最后，重新编译 Enum.tt 文件，输出如下所示：

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Linq;
using System.Collections.Generic;

namespace YourName.Space
{
    public class ResponseStatusCode
    {
//---------------------------------------------------------------------------------------------------
// V A L U E S _ L I S T 
//---------------------------------------------------------------------------------------------------

        ///<summary>
        /// "The response was successful."
        ///</summary>
        public static readonly ResponseStatusCode SUCCESS = new ResponseStatusCode(){ Name = "SUCCESS", Description = "The response was successful."};

        ///<summary>
        /// "The request was not successful."
        ///</summary>
        public static readonly ResponseStatusCode NON_SUCCESS = new ResponseStatusCode(){ Name = "NON_SUCCESS", Description = "The request was not successful."};

        ///<summary>
        /// "The resource requested has been discontinued and can no longer be accessed."
        ///</summary>
        public static readonly ResponseStatusCode RESOURCE_IS_DISCONTINUED = new ResponseStatusCode(){ Name = "RESOURCE_IS_DISCONTINUED", Description = "The resource requested has been discontinued and can no longer be accessed."};

        private static List<ResponseStatusCode> _list { get; set; } = null;
        public static List<ResponseStatusCode> ToList()
        {
            if (_list == null)
            {
                _list = typeof(ResponseStatusCode).GetFields().Where(x => x.IsStatic && x.IsPublic && x.FieldType == typeof(ResponseStatusCode))
                    .Select(x => x.GetValue(null)).OfType<ResponseStatusCode>().ToList();
            }

            return _list;
        }

        public static List<ResponseStatusCode> Values()
        {
            return ToList();
        }

        /// <summary>
        /// Returns the enum value based on the matching Name of the enum. Case-insensitive search.
        /// </summary>
        /// <param name="key"></param>
        /// <returns></returns>
        public static ResponseStatusCode ValueOf(string key)
        {
            return ToList().FirstOrDefault(x => string.Compare(x.Name, key, true) == 0);
        }

//---------------------------------------------------------------------------------------------------
// I N S T A N C E _ D E F I N I T I O N 
//---------------------------------------------------------------------------------------------------       
        public string Name { get; set; }
        public string Description { get; set; }
        public override string ToString() { return this.Name; }

        /// <summary>
        /// Implcitly converts to string.
        /// </summary>
        /// <param name="d"></param>
        public static implicit operator string(ResponseStatusCode d)
        {
            return d.ToString();
        }

        /// <summary>
        /// Compares based on the == method. Handles nulls gracefully.
        /// </summary>
        /// <param name="a"></param>
        /// <param name="b"></param>
        /// <returns></returns>
        public static bool operator !=(ResponseStatusCode a, ResponseStatusCode b)
        {
            return !(a == b);
        }

        /// <summary>
        /// Compares based on the .Equals method. Handles nulls gracefully.
        /// </summary>
        /// <param name="a"></param>
        /// <param name="b"></param>
        /// <returns></returns>
        public static bool operator ==(ResponseStatusCode a, ResponseStatusCode b)
        {
            return a?.ToString() == b?.ToString();
        }

        /// <summary>
        /// Compares based on the .ToString() method
        /// </summary>
        /// <param name="o"></param>
        /// <returns></returns>
        public override bool Equals(object o)
        {
            return this.ToString() == o?.ToString();
        }

        /// <summary>
        /// Compares based on the .Name property
        /// </summary>
        /// <returns></returns>
        public override int GetHashCode()
        {
            return this.Name.GetHashCode();
        }
    }
} 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2019-04-10T09:14:24.540

```
Enum.GetName(typeof(MyEnum), (int)MyEnum.FORMS)
Enum.GetName(typeof(MyEnum), (int)MyEnum.WINDOWSAUTHENTICATION)
Enum.GetName(typeof(MyEnum), (int)MyEnum.SINGLESIGNON) 
```

输出是：

“形式”

“WINDOWS认证”

“单点”

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-08-18T19:29:54.247

使用**对象 Enum.Parse(System.Type enumType, string value, bool ignoreCase);** 从[http://blogs.msdn.com/b/tims/archive/2004/04/02/106310.aspx得到它](http://blogs.msdn.com/b/tims/archive/2004/04/02/106310.aspx)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2011-09-27T10:19:49.797

我发现用于枚举的国际化或从各个资源文件获取枚举文本的方法是通过继承 DescriptionAttribute 类来创建属性类

```
public class EnumResourceAttribute : DescriptionAttribute
{

    public Type ResourceType { get; private set; }
    public string ResourceName { get; private set; }
    public int SortOrder { get; private set; }
    public EnumResourceAttribute(Type ResourceType,
                         string ResourceName,
                         int SortOrder)
    {

        this.ResourceType = ResourceType;
        this.ResourceName = ResourceName;
        this.SortOrder = SortOrder;
    }
} 
```

创建另一个静态类，该类将为 GetString 和 GetStrings 提供扩展方法。

```
public static class EnumHelper
{
    public static string GetString(this Enum value)
    {
        EnumResourceAttribute ea =
       (EnumResourceAttribute)value.GetType().GetField(value.ToString())
        .GetCustomAttributes(typeof(EnumResourceAttribute), false)
         .FirstOrDefault();
        if (ea != null)
        {
            PropertyInfo pi = ea.ResourceType
             .GetProperty(CommonConstants.ResourceManager);
            if (pi != null)
            {
                ResourceManager rm = (ResourceManager)pi
                .GetValue(null, null);
                return rm.GetString(ea.ResourceName);
            }

        }
        return string.Empty;
    }

    public static IList GetStrings(this Type enumType)
    {
        List<string> stringList = new List<string>();
        FieldInfo[] fiArray = enumType.GetFields();
        foreach (FieldInfo fi in fiArray)
        {
            EnumResourceAttribute ea =
                (EnumResourceAttribute)fi
                     .GetCustomAttributes(typeof(EnumResourceAttribute), false)
                     .FirstOrDefault();
            if (ea != null)
            {
                PropertyInfo pi = ea.ResourceType
                                    .GetProperty(CommonConstants.ResourceManager);
                if (pi != null)
                {
                    ResourceManager rm = (ResourceManager)pi
                                          .GetValue(null, null);
                    stringList.Add(rm.GetString(ea.ResourceName));
                }
            }
        }
        return stringList.ToList();
    }
} 
```

在 Enum 的元素上，您可以编写：

```
public enum Priority
{
     [EnumResourceAttribute(typeof(Resources.AdviceModule), Resources.ResourceNames.AdviceCreateAdviceExternaPriorityMemberHigh, 1)]
    High,
     [EnumResourceAttribute(typeof(Resources.AdviceModule), Resources.ResourceNames.AdviceCreateAdviceExternaPriorityMemberRoutine, 2)]
    Routine
} 
```

其中 Resources.ResourceNames.AdviceCreateAdviceExternaPriorityMemberHigh & Resources.ResourceNames.AdviceCreateAdviceExternaPriorityMemberRoutine 是资源文件中的常量，或者您可以说出其值在不同文化中可用的字符串。

如果您在 MVC 架构中实现 Web 应用程序，则创建一个属性

```
private IList result;
public IList Result
{
    get
    {
        result = typeof(Priority).GetStrings();
        return result;
    }
} 
```

在您的 .cshtml 文件中，您可以将枚举绑定到您的下拉列表，例如：

```
@Html.DropDownListFor(model => Model.vwClinicalInfo.Priority, new SelectList(Model.Result)) 
```

谢谢拉特内什

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2012-05-07T15:01:01.363

我的回答是，处理@user29964 的答案（这是迄今为止最简单和最接近枚举的）是

```
 public class StringValue : System.Attribute
    {
        private string _value;

        public StringValue(string value)
        {
            _value = value;
        }

        public string Value
        {
            get { return _value; }
        }

        public static string GetStringValue(Enum Flagvalue)
        {
            Type type = Flagvalue.GetType();
            string[] flags = Flagvalue.ToString().Split(',').Select(x => x.Trim()).ToArray();
            List<string> values = new List<string>();

            for (int i = 0; i < flags.Length; i++)
            {

                FieldInfo fi = type.GetField(flags[i].ToString());

                StringValue[] attrs =
                   fi.GetCustomAttributes(typeof(StringValue),
                                           false) as StringValue[];
                if (attrs.Length > 0)
                {
                    values.Add(attrs[0].Value);
                }
            }
            return String.Join(",", values);

        } 
```

用法

```
[Flags]
    public enum CompeteMetric
    {

        /// <summary>
        /// u
        /// </summary>
        [StringValue("u")]//Json mapping
        Basic_UniqueVisitors = 1 //Basic
             ,
        /// <summary>
        /// vi
        /// </summary>
        [StringValue("vi")]//json mapping
        Basic_Visits = 2// Basic
            ,
        /// <summary>
        /// rank
        /// </summary>
        [StringValue("rank")]//json mapping
        Basic_Rank = 4//Basic
 } 
```

例子

```
 CompeteMetric metrics = CompeteMetric.Basic_Visits | CompeteMetric.Basic_Rank;
        string strmetrics = StringValue.GetStringValue(metrics); 
```

这将返回“vi,rank”

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-01-24T15:57:25.997

我和 Harvey 在一起，但不要使用 const。我可以混合和匹配字符串、int 等。

```
public class xlsLayout
{
    public int xlHeaderRow = 1;
    public int xlFirstDataRow = 2;
    public int xlSkipLinesBetweenFiles = 1; //so 0 would mean don't skip
    public string xlFileColumn = "A";
    public string xlFieldColumn = "B";
    public string xlFreindlyNameColumn = "C";
    public string xlHelpTextColumn = "D";
} 
```

然后后来...

```
public partial class Form1 : Form
{
    xlsLayout xlLayout = new xlsLayout();

    xl.SetCell(xlLayout.xlFileColumn, xlLayout.xlHeaderRow, "File Name");
    xl.SetCell(xlLayout.xlFieldColumn, xlLayout.xlHeaderRow, "Code field name");
    xl.SetCell(xlLayout.xlFreindlyNameColumn, xlLayout.xlHeaderRow, "Freindly name");
    xl.SetCell(xlLayout.xlHelpTextColumn, xlLayout.xlHeaderRow, "Inline Help Text");
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2018-03-29T06:44:02.400

我很清楚这个问题已经得到解答，并且 OP 已经对接受的答案感到满意。但我发现大多数答案，包括接受的答案，都有点复杂。

我有一个项目给了我这样的情况，我能够以这种方式实现它。

首先，您必须考虑枚举名称的大小写：

```
public enum AuthenticationMethod
{
    Forms = 1,
    WindowsAuthentication = 2,
    SingleSignOn = 3
} 
```

然后，有这个扩展：

```
using System.Text.RegularExpression;

public static class AnExtension
{
    public static string Name(this Enum value)
    {
        string strVal = value.ToString();
        try
        {
            return Regex.Replace(strVal, "([a-z])([A-Z])", "$1 $2");
        }
        catch
        {
        }
        return strVal;
    }
} 
```

通过这个，您可以将每个枚举名称转换为其字符串表示形式，每个单词用空格分隔。前任：

```
AuthenticationMethod am = AuthenticationMethod.WindowsAuthentication;
MessageBox.Show(am.Name()); 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2019-07-04T12:22:33.247

您可以声明枚举和字典，其中键将是枚举的值。以后可以参考字典来获取值。因此，可以将参数作为枚举类型传递给函数，但要从字典中获取实际值：

```
using System;
using System.Collections.Generic;

namespace console_test
{
    class Program
    {
        #region SaveFormat
        internal enum SaveFormat
        {
            DOCX,
            PDF
        }

        internal static Dictionary<SaveFormat,string> DictSaveFormat = new Dictionary<SaveFormat, string>
        {
            { SaveFormat.DOCX,"This is value for DOCX enum item" },
            { SaveFormat.PDF,"This is value for PDF enum item" }
        };

        internal static void enum_value_test(SaveFormat save_format)
        {
            Console.WriteLine(DictSaveFormat[save_format]);
        }
        #endregion

        internal static void Main(string[] args)
        {
            enum_value_test(SaveFormat.DOCX);//Output: This is value for DOCX enum item
            Console.Write("Press any key to continue . . . ");
            Console.ReadKey(true);
        }
    }
} 
```

# c# - 在自定义应用程序的运行实例中打开“已知文件类型” - .NET

> ID：424368
> 
> 赞同：8
> 
> 时间：2009-01-08T14:16:19.010
> 
> 标签：c#, .net, winforms

您如何将文件（在注册表中具有已知的文件/应用程序关联）打开到它应该打开的应用程序的“运行实例”中？一个例子是，我打开了 Excel，然后单击了一个 XLS 文件.....该文件在当前 Excel 实例中打开。我想为自定义应用程序执行此操作......事件/消息传递如何“告诉”当前实例它需要打开文件？是否有一个“文件观察者”来寻找这样做的请求等？谢谢..

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-08T14:33:09.927

您要做的是从[WindowsFormsApplicationBase](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.aspx)继承一个类，将受保护的[IsSingleInstance](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.issingleinstance.aspx)属性设置为 true：

```
// This should all be refactored to make it less tightly-coupled, obviously.
class MyWindowsApplicationBase : WindowsFormsApplicationBase
{
  internal MyWindowsApplicationBase() : base()
  {
    // This is a single instance application.
    this.IsSingleInstance = true;

    // Set to the instance of your form to run.
    this.MainForm = new MyForm();
  }
} 
```

您的应用程序的 Main 方法如下所示：

```
// This should all be refactored to make it less tightly-coupled, obviously.
public static void Main(string args[])
{
  // Process the args.
  <process args here>

  // Create the application base.
  MyWindowsApplicationBase appBase = new MyWindowsApplicationBase();

  // <1> Set the StartupNextInstance event handler.
  appBase.StartupNextInstance = <event handler code>;

  // Show the main form of the app.
  appBase.Run(args);
} 
```

请注意标记为 <1> 的部分。[您使用StartupNextInstanceEvent](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.startupnextinstance.aspx)的事件处理程序进行设置。当您有一个单实例应用程序（您在 MyWindowsApplicationBase 的构造函数中指定）时，当您的应用程序的*下一个*实例被触发时，将触发此事件。事件处理程序将传递一个 EventArgs 派生类，该类将具有命令行参数，然后您可以在应用程序的运行实例中处理这些参数。

然后，您所要做的就是为您希望您的应用程序处理的文件类型正常设置文件关联，然后您就设置好了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:34:26.697

看起来您正在寻找的是创建单实例应用程序。这可以通过使用位于 Microsoft.VisualBasic.dll 中的 WindowsFormsApplicationBase 在 C# 中完成

详情请看： [http](http://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx) ://www.hanselman.com/blog/TheWeeklySourceCode31SingleInstanceWinFormsAndMicrosoftVisualBasicdll.aspx 或搜索`WindowsFormsApplicationBase`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T14:21:04.973

我这样做的方式是这样的：

1.  在 main 方法中，首先检查进程列表中是否存在应用程序的现有实例。
2.  [如果找到，请使用您最喜欢的进程间通信方法（发送 windows 消息](http://ryanfarley.com/blog/archive/2004/05/10/605.aspx)、远程处理、wcf 等）将文件名/路径发送到已经运行的实例
3.  关闭windows试图启动的新进程（因为现有实例已经处理了文件打开操作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T22:54:01.970

使用 TCP 套接字的示例： [http ://pieterjan.pro/?a=Projecten_csharp_DrawIt.php](http://pieterjan.pro/?a=Projecten_csharp_DrawIt.php)

1.  在表单上启动 TCPListener
2.  在第二个实例的主连接 TCPClient
3.  通过 TCP 连接将 ActivationArguments 发送到表单

一次也适用于多个文件，甚至第一次适用于多个文件（当应用程序尚未启动时）

最重要的代码块是：

1.  启动服务器并将端口号写入文件的 MainForm (Hoofdscherm) 的构造函数。第一个文件也被打开。
2.  第二个，第三个，...实例连接到第一个实例中的 TcpListener 并通过套接字发送文件名的 Main-function (Program.cs)

源代码在“Broncode”按钮上可用

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-08T16:16:36.177

Windows为此目的使用[DDE 。](http://en.wikipedia.org/wiki/Dynamic_Data_Exchange)

> 动态数据交换 (DDE) 是一种在 Microsoft Windows 或 OS/2 下的多个应用程序之间进行通信的技术。

word 或 office 文件的注册表关联通常具有除了通常的文件关联之外的 DDE 命令（如果应用程序已经在运行则执行）。

因此，您可以在 C# 应用程序中托管 DDE 服务器来实现此功能。

# .net - SqlRoleProvider 和 aspnet_regsql 的稳定性/可用性如何？

> ID：424373
> 
> 赞同：0
> 
> 时间：2009-01-08T14:18:26.227
> 
> 标签：.net, asp.net, security, roles

这不是特定于asp.net 的，其中一些应用程序是WinForms，将来还会添加一些Wpf 和可能的一些silverlight 应用程序。

我需要将基于角色和权限的访问安全性放入我们在这里开发的新应用程序中。

一般来说，.net RoleProviders，特别是 SqlRoleProvider 似乎拥有我们需要的一切，但是我对 aspnet_regsql 需要的 Db Schema 更改有一些担忧。

我试过用谷歌搜索这些，但我不确定要问什么。

IE

1.  在 .net 版本之间升级它有多简单（或不简单）？
2.  .Net 2.0 和 .net 3.5 应用程序会愉快地使用相同的模式吗？即我们可以让 .net 2.0 和 3.5 应用程序在同一个 Db 中使用相同的权限吗？
3.  Sql Security 提供程序有多稳定，是否有人愤怒地使用它们？它们值得使用吗？

我是否最好咬紧牙关并实现我自己的 - 有限的 - 角色功能（这将做我需要的一切）和我自己的自定义角色提供者？

正如你所看到的，我陷入了“不想重新发明轮子”和“不被一些未知的 3rd 方代码所困扰”之间（无论如何我都不知道，这就是我问你的原因）

提前感谢您的建议和推荐，

体重

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T15:41:30.537

我多年来一直在使用内置提供程序（在不同的项目上），没有任何问题。自从 2.0 推出以来，一切都没有改变。

如果 sql 提供程序可以满足您的所有需求，请使用它，除非您需要其他功能，否则几乎没有理由推出您自己的。

您可以密切关注的一件事——这适用于个人资料、成员资格和角色——是存储过程的效率。如果您查看存储过程，您会发现在每次执行时都会从各种表中获取数据。例如，几乎每个查询（我记得看过），查询当前请求的 appid。如果您只有一个应用程序在数据库上运行，这可能是矫枉过正并且可以更改。Omar Al Zabir的这篇[文章（代码项目）讨论了配置文件的改进。](http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T19:35:18.093

我相信 SqlRoleProvider 是要走的路。它具有高度可扩展性且易于设置。除非您已经推出了自己经过验证的解决方案（那么您为什么要发布这个问题），那么这很简单。

我同意 webchanix，该系统确实允许多个应用程序并进行大量表扫描，但最后，我认为我们谈论的是基于它的好处的非常小的性能命中。

# asp.net - RegisterClientScriptBlock方法调用中Type参数的意义是什么？

> ID：424375
> 
> 赞同：2
> 
> 时间：2009-01-08T14:18:55.010
> 
> 标签：asp.net, javascript

这是 RegisterClientScriptBlock 的示例

```
 Page.ClientScript.RegisterClientScriptBlock(Me.GetType, "key","scriptblock", True) 
```

为什么方法需要类型作为第一个参数？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T14:33:14.530

来自 MSDN 文档：“客户端脚本由其键和类型唯一标识。具有相同键和类型的脚本被认为是重复的。”

基本上，它为您提供了另一种唯一标识脚本的方法。您可以在不同类型的控件中拥有相同的键值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:34:42.467

我自己也想过这个问题。据我在 Reflector 中看到的，RegisterClientScriptBlock() 没有直接使用它，它只被 ScriptKey 类的 GetHashCode() 方法使用。在那里，它可能用于唯一标识脚本块，而不仅仅是用户提供的密钥，因为它链接到指定的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T15:10:58.540

有[一篇关于为什么这会导致麻烦的帖子](http://blogs.ipona.com/james/archive/2006/10/03/6710.aspx)，但我从未真正遇到过。归结为：当您从具有这段代码的控件继承时，`GetType`将返回其他内容。这样，如果您的页面上有两个控件，则密钥会有所不同，并且脚本将再次添加。这可能会导致 javascript 问题。

解决方案是不使用`GetType`，而是使用`typeof()`。在 VB.Net 中：

```
Page.ClientScript.RegisterClientScriptBlock(GetType(MyClass), "key","scriptblock", True) 
```

但同样，这是一个例外情况。

# windows - 无法在 Eclipse 中运行 junit 测试

> ID：424392
> 
> 赞同：5
> 
> 时间：2009-01-08T14:21:10.043
> 
> 标签：windows, eclipse, sockets, junit

我和我的同事在 Eclipse 中运行 junit 测试或 tomcat 时遇到间歇性问题。

有时测试会运行。有时他们不会。似乎没有模式，我们不同步。IE 我的可能会运行，而其他的会失败。

停止/启动 Eclipse 可以解决问题（有时）。拔出网络电缆总是可以解决问题（当它拔出时）。

当它失败时，会发生以下情况。在尝试运行该类时，控制台屏幕会出现红色框。控制台屏幕保持空白约 30 秒，然后出现以下内容：

> 无法连接到: : 2083
> java.net.ConnectException: 连接被拒绝: 在 java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java: 195) 在 java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182) 在 java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366) 在 java.net.Socket.connect(Socket.java:520) 在 java. net.Socket.connect(Socket.java:470) 在 java.net.Socket.(Socket.java:367) 在 java.net.Socket.(Socket.java:180) 在 org.eclipse.jdt.internal.junit .runner.RemoteTestRunner.connect(RemoteTestRunner.java:560) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:377) 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner .主要（RemoteTestRunner.java:196）

端口号不同。我发现一个论坛帖子告诉我关注这个[http://support.microsoft.com/kb/135982](http://support.microsoft.com/kb/135982) 但这不起作用。

我们都在通过 ISA 服务器/代理连接到 Internet 的基于 Microsoft XP 的机器上。我正在运行 Eclipse 3.3.3 和 MyEclipse 6.0.1

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T10:40:11.993

我专注于 junit 而不是 tomcat，因为它更快更容易重现。是的，我看到 McQueeney 链接没有运气。

当您从 Eclipse 运行 junit 时，我们做了更多的挖掘和有趣的工作，Eclipse 决定去检查更新，是的，这是正确的 - 每次您运行 junit（我猜是 tomcat 和其他人）。

我们取消了同事通过 ISA 服务器访问 WWW 的限制，结果问题消失了。

我们仍在监视这是否是解决方案。关注此空间。

我尝试过浏览 Eclipse 设置，看看是否可以阻止它每次访问 WWW，但还没有看到合适的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T16:51:11.927

一些建议...：

你看过tomcat日志吗？

你在他们身上看到一些`ClientAbortException: java.net.SocketException: Broken pipe.`吗？

看起来服务器认为客户端有时正在关闭连接。就像客户端正在让服务器重置连接（连接重置），而服务器有时没有监听（连接被拒绝）。

如果您在防火墙/代理服务器后面进行测试，您可能需要向 TomCat 提供防火墙/代理服务器主机名和端口号。

[重启eclipse就足够了](http://mcqueeney.com/roller/page/tom?entry=eclipse_3_2_junit_runner)：

> 显然，Eclipse 中的 JUnit 运行器线程附加到 Eclipse 服务器线程以运行测试。似乎客户端线程试图连接到错误的端口 (3393)，或者一直在端口 3393 上侦听运行时请求的服务器线程失败。

McQueeney 找到的解决方案[在这里](http://web.archive.org/web/20060510211249/eclipseplugincentral.com/PNphpBB2+file-viewtopic-t-2195-start-0.html)（感谢 Archive.org！）

我觉得有趣的一个建议是：

> **我必须更改我的 Eclipse 项目使用的 jre，以确保 JUnit 和我的项目使用相同的 jre。重新启动 Eclipse 后，错误消失了。**

我希望你能找到一个明确的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:03:54.913

当我的网络驱动程序损坏时，我遇到了同样的问题。

JUnit 和 Eclipse 通过 ICP（InterProcess Communication）进行通信，更好的说法是：通过 TCP。要成功运行它，您必须修复网络驱动程序。

尝试重新安装 TCP/IP 协议或将其转回系统还原点。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T12:31:18.713

所以你的 JUnit 只有在连接到互联网的情况下才有效？或者它是一次性的动作，现在它在没有互联网连接的情况下工作？

奇怪的世界……日志文件中是否有任何提示？

# asp.net - ASP.Net 2.0 VB 网站项目“未定义类型‘异常’”

> ID：424396
> 
> 赞同：4
> 
> 时间：2009-01-08T14:21:59.327
> 
> 标签：asp.net, vb.net

突然间，我们的 VB ASP.Net 2.0 网站项目开始抱怨没有定义异常。

我发现如果我将“导入系统”添加到标题中，或者显式使用 System.Exception 它可以工作，但是这个错误会渗透到许多其他系统后代，如 Data 命名空间和 DateTime 对象。我们有成百上千的页面，因此将导入系统添加到所有页面不仅会耗费时间，而且似乎是解决问题的创可贴。

我检查了 Project->Property Pages->References 和 web.config 文件，并且程序集被导入到项目中，只是没有像通常那样“自动导入”到类文件中。请注意，这不仅会影响 CodeBehind，还会影响所有 className.vb 文件。

我想解决这个问题，但更重要的是想了解是什么导致系统命名空间突然停止自动导入。显然有一些文件更改导致了这种情况，因为我的同事今天早上在对项目进行了 Full-Get 后开始看到这个问题。

更多：位于 Windows\Microsoft.Net...\Config\Web.Config 文件中的 Web.Config 文件确实有 ，并且添加了 System 。添加标签并将 System 添加到 LOCAL web.config 并没有缓解问题。

任何帮助，将不胜感激。第一个 SO 问题，所以我希望我的描述性足够。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T14:25:50.223

更改 Web.config 文件并在`<pages>`标签下添加所需的命名空间`<system.web>`：

```
<pages>
    <namespaces>
        <add namespace="System"/>
        <add namespace="System.Data"/>
        <add namespace="System.Web"/>
        <add namespace="System.Web.UI"/>
        <add namespace="System.Xml"/>
        <add namespace="System.Data.SqlClient"/>
        <add namespace="System.Collections.Generic"/>
    </namespaces>
</pages> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:29:40.323

检查您的 web.config 中的部分，它是否包含？

如果是这样，如果不存在，则不应该存在，请检查 windows 文件夹中 Microsoft.NET 下的 Framework/CONFIG 文件夹。在该文件夹中的 web.config 部分中，应该有：-

```
<add namespace="System"> 
```

我无法想象为什么有人会删除它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T14:41:25.200

您可以检查项目构建设置中是否忽略了 mscorlib。

项目 -> YourProject 属性 -> 构建 -> 高级，然后确保未选中“不引用 mscorlib.dll”。

# html - 不可能的？HTML鼠标悬停边框颜色随边框折叠而变化？

> ID：424405
> 
> 赞同：2
> 
> 时间：2009-01-08T14:25:37.510
> 
> 标签：html, css

我希望有一个表格，其中所有边框（内部/外部）的宽度都是单个像素，我通过`border-collapse`在表格上设置样式来实现这一点。

然后我希望`onmouseover`每个 TD 单元格，将其更改`border-color`为不同的颜色。如果表格边框没有折叠，这可以正常工作。但是如果你折叠边界，那么它就无法工作。

但是，如果我不折叠边框，那么我将无法获得单个像素宽度的边框！

那么这是不可能的吗？

编辑：为了澄清，当使用边框折叠并设置 TD 边框颜色时，只设置了右边框和下边框。

编辑编辑：我最终实现了这个改变鼠标悬停的背景。背景 GIF 是一个带边框的白色框。呜呜呜！虽然在所有浏览器中都能完美运行......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-15T18:01:14.180

我意识到这是一个非常古老的帖子，但我想无论如何我都会做出贡献，以防万一它有帮助。

除非您对所有表格单元格使用像素精确的宽度和高度，否则不知道如何获得带边框的背景图像？

但另一种选择是在悬停时使用“轮廓”而不是边框​​。前任。：

```
table { border-collapse: collapse; }
table td { border: solid 1px gray; }
table td:hover { border: none; outline: solid 1px red; } 
```

适用于除 IE6 以外的所有浏览器。

根据您使用的颜色，外观可能不理想，但效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T14:53:28.717

有什么方法可以完全放弃使用表格而使用 div 代替？就初始设置而言，这有点痛苦，但最终我认为您可能会发现从长远来看它更容易操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T05:48:43.290

是的，我也知道这是一篇旧帖子。我这样做的方式适用于所有浏览器！只需创建一个元素，让它成为#cellsel。不要忘记将定位设置为绝对或相对，并相应地设置左侧和顶部属性以及 z-index，显示为无（起初不可见）。现在的策略是当鼠标悬停时使用jquery将#cellsel附加到td上......，最糟糕的部分是使用mouseenter/mouseleave/mousemove的事件和一个标志变量来验证鼠标何时离开特定的td ...

```
 $('***td selector***').mouseenter(
  function(e){
  var $this= $(this);

  if(!ins){//global variable ins -- this is our flag!
    var off= $this.offset();
    var w= $this.width()-1;
    var h= $this.height()-1;
    //#cellsel is the element i created to draw over a td when the mouse hovers a particular td..
    $('#cellsel').css({'top':off.top+'px', 'left':off.left+'px', 'width':w+'px', 'height':h+'px', 'display':'block'});
    ins=true;

    $this.bind('mouseleave',function(){
      $(this).unbind('mouseleave');
      ins=false;
    });
  }//#grid is the table!
  }).parents('#grid').mousemove(
      function(e){
        if(ins){
          var $this= $(this).find('#cellsel');
          var off= $this.offset();
          var w= $this.width();
          var h= $this.height();

          if( (e.pageX < off.left) || (e.pageY < off.top) || (e.pageX > (off.left + w)) || (e.pageY > (off.top + h)) )
            ins=false;                    
        }
    }); 
```

如果其他人对此提出更正或更好的答案，我将不胜感激......谢谢！此外，没有必要使用表格，您可以使用嵌套的 div 和 css 向左浮动来完成同样的事情！为确保边框折叠应用一些 jquery，如下所示：

```
$('***selector to all divs except the ones with the css clear propiety set***').css({'float': 'left', 'width': '100px', 'border': '1px solid #CCC','margin-bottom':'-1px','margin-right':'-1px'}); 
```

# javascript - 使用 JavaScript 和 jQuery，跨浏览器处理按键事件 (F1-F12)

> ID：424407
> 
> 赞同：83
> 
> 时间：2009-01-08T14:26:23.327
> 
> 标签：javascript, jquery, events, keyboard, keyboard-events

我想使用 JavaScript 和 jQuery 处理 F1-F12 键。

我不确定要避免哪些陷阱，而且我目前无法在 Internet Explorer 8、Google Chrome 和 Mozilla FireFox 3 之外的任何其他浏览器中测试实现。

对完整的跨浏览器解决方案有什么建议吗？类似于经过良好测试的 jQuery 库，或者只是普通的 jQuery/JavaScript？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-01-10T12:08:08.297

我同意威廉的观点，一般来说劫持功能键是个坏主意。也就是说，我以一种非常巧妙的方式找到了添加此功能的[快捷方式](http://www.openjs.com/scripts/events/keyboard_shortcuts/)库，以及其他键盘快捷方式和组合。

单次击键：

```
shortcut.add("F1", function() {
    alert("F1 pressed");
}); 
```

按键组合：

```
shortcut.add("Ctrl+Shift+A", function() {
    alert("Ctrl Shift A pressed");
}); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-08T14:35:48.893

我不确定是否可以拦截功能键，但我会避免一起使用功能键。浏览器使用功能键来执行各种任务，其中一些非常常见。例如，在 Linux 上的 Firefox 中，至少有六个或七个功能键保留给浏览器使用：

*   F1（帮助），
*   F3（搜索），
*   F5（刷新），
*   F6（焦点地址栏），
*   F7（插入符号浏览模式），
*   F11（全屏模式），以及
*   F12（由多个附加组件使用，包括 Firebug）

最糟糕的是，不同操作系统上的不同浏览器对不同的事情使用不同的密钥。这需要解释很多差异。你应该坚持使用更安全、不常用的组合键。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-12T18:36:40.550

我对这类问题的最佳来源是这个页面：[http ://www.quirksmode.org/js/keys.html](http://www.quirksmode.org/js/keys.html)

他们说的是 Safari 上的键码很奇怪，并且在其他任何地方都是一致的（除了 IE 上没有按键事件，但我相信 keydown 有效）。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2016-11-18T10:48:17.870

这很简单。

```
$(function(){
    //Yes! use keydown because some keys are fired only in this trigger,
    //such arrows keys
    $("body").keydown(function(e){
         //well so you need keep on mind that your browser use some keys 
         //to call some function, so we'll prevent this
         e.preventDefault();

         //now we caught the key code.
         var keyCode = e.keyCode || e.which;

         //your keyCode contains the key code, F1 to F12 
         //is among 112 and 123\. Just it.
         console.log(keyCode);       
    });
}); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-04-03T23:46:00.880

没有其他外部类，您只需使用即可创建您的个人黑客代码

```
event.keyCode 
```

对所有人的另一个帮助，我认为这个测试页面用于拦截 keyCode（只需复制并粘贴到新的 file.html 中以测试您的事件）。

```
 <html>
 <head>
 <title>Untitled</title>
 <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
 <style type="text/css">
 td,th{border:2px solid #aaa;}
 </style>
 <script type="text/javascript">
 var t_cel,tc_ln;
 if(document.addEventListener){ //code for Moz
   document.addEventListener("keydown",keyCapt,false); 
   document.addEventListener("keyup",keyCapt,false);
   document.addEventListener("keypress",keyCapt,false);
 }else{
   document.attachEvent("onkeydown",keyCapt); //code for IE
   document.attachEvent("onkeyup",keyCapt); 
   document.attachEvent("onkeypress",keyCapt); 
 }
 function keyCapt(e){
   if(typeof window.event!="undefined"){
    e=window.event;//code for IE
   }
   if(e.type=="keydown"){
    t_cel[0].innerHTML=e.keyCode;
    t_cel[3].innerHTML=e.charCode;
   }else if(e.type=="keyup"){
    t_cel[1].innerHTML=e.keyCode;
    t_cel[4].innerHTML=e.charCode;
   }else if(e.type=="keypress"){
    t_cel[2].innerHTML=e.keyCode;
    t_cel[5].innerHTML=e.charCode;
   }
 }
 window.onload=function(){
   t_cel=document.getElementById("tblOne").getElementsByTagName("td");
   tc_ln=t_cel.length;
 }
 </script>
 </head>
 <body>
 <table id="tblOne">
 <tr>
 <th style="border:none;"></th><th>onkeydown</th><th>onkeyup</th><th>onkeypress</td>
 </tr>
 <tr>
 <th>keyCode</th><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
 </tr>
 <tr>
 <th>charCode</th><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
 </tr>
 </table>
 <button onclick="for(i=0;i<tc_ln;i++){t_cel[i].innerHTML='&nbsp;'};">CLEAR</button>
 </body>
 </html> 
```

这是一个工作演示，因此您可以在这里尝试：

```
var t_cel, tc_ln;
if (document.addEventListener) { //code for Moz
  document.addEventListener("keydown", keyCapt, false);
  document.addEventListener("keyup", keyCapt, false);
  document.addEventListener("keypress", keyCapt, false);
} else {
  document.attachEvent("onkeydown", keyCapt); //code for IE
  document.attachEvent("onkeyup", keyCapt);
  document.attachEvent("onkeypress", keyCapt);
}

function keyCapt(e) {
  if (typeof window.event != "undefined") {
    e = window.event; //code for IE
  }
  if (e.type == "keydown") {
    t_cel[0].innerHTML = e.keyCode;
    t_cel[3].innerHTML = e.charCode;
  } else if (e.type == "keyup") {
    t_cel[1].innerHTML = e.keyCode;
    t_cel[4].innerHTML = e.charCode;
  } else if (e.type == "keypress") {
    t_cel[2].innerHTML = e.keyCode;
    t_cel[5].innerHTML = e.charCode;
  }
}
window.onload = function() {
  t_cel = document.getElementById("tblOne").getElementsByTagName("td");
  tc_ln = t_cel.length;
}
```

```
td,
th {
  border: 2px solid #aaa;
}
```

```
<html>

<head>
  <title>Untitled</title>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
</head>

<body>
  <table id="tblOne">
    <tr>
      <th style="border:none;"></th>
      <th>onkeydown</th>
      <th>onkeyup</th>
      <th>onkeypress</td>
    </tr>
    <tr>
      <th>keyCode</th>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <th>charCode</th>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
  </table>
  <button onclick="for(i=0;i<tc_ln;i++){t_cel[i].innerHTML='&nbsp;'};">CLEAR</button>
</body>

</html>
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-10-26T11:17:34.170

ES6 中针对**现代浏览器和 IE11**的解决方案（转译为 ES5）：

```
//Disable default IE help popup
window.onhelp = function() {
    return false;
};
window.onkeydown = evt => {
    switch (evt.keyCode) {
        //ESC
        case 27:
            this.onEsc();
            break;
        //F1
        case 112:
            this.onF1();
            break;
        //Fallback to default browser behaviour
        default:
            return true;
    }
    //Returning false overrides default browser event
    return false;
}; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-13T07:32:20.897

这对我有用。

`if(code ==112) { alert("F1 was pressed!!"); return false; }`

F2 - 113、F3 - 114、F4 - 115 等堡垒。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-22T22:02:19.003

捕获 F1-F12 键的问题之一是*还必须覆盖默认功能*。以下是**F1 'Help' 键**的实现示例，其覆盖可防止默认帮助弹出窗口。此解决方案*可以扩展为 F2-F12 键*。此外，此示例*故意不捕获组合键*，但这也可以更改。

```
<html>
<head>
<!-- Note:  reference your JQuery library here -->
<script type="text/javascript" src="jquery-1.6.2.min.js"></script>
</head>
<body>
    <h1>F-key trap example</h1>
    <div><h2>Example:  Press the 'F1' key to open help</h2></div>
    <script type="text/javascript">
        //uncomment to prevent on startup
        //removeDefaultFunction();          
        /** Prevents the default function such as the help pop-up **/
        function removeDefaultFunction()
        {
            window.onhelp = function () { return false; }
        }
        /** use keydown event and trap only the F-key, 
            but not combinations with SHIFT/CTRL/ALT **/
        $(window).bind('keydown', function(e) {
            //This is the F1 key code, but NOT with SHIFT/CTRL/ALT
            var keyCode = e.keyCode || e.which;
            if((keyCode == 112 || e.key == 'F1') && 
                    !(event.altKey ||event.ctrlKey || event.shiftKey || event.metaKey))
             {
                // prevent code starts here:
                removeDefaultFunction();
                e.cancelable = true;
                e.stopPropagation();
                e.preventDefault();
                e.returnValue = false;
                // Open help window here instead of alert
                alert('F1 Help key opened, ' + keyCode);
                }
            // Add other F-keys here:
            else if((keyCode == 113 || e.key == 'F2') && 
                    !(event.altKey ||event.ctrlKey || event.shiftKey || event.metaKey))
             {
                // prevent code starts here:
                removeDefaultFunction();
                e.cancelable = true;
                e.stopPropagation();
                e.preventDefault();
                e.returnValue = false;
                // Do something else for F2
                alert('F2 key opened, ' + keyCode);
                }
        });
    </script>
</body>
</html> 
```

我从相关的 SO 文章中借用了一个[类似的解决方案来开发这个。](https://stackoverflow.com/questions/29278660/prevent-default-f1-event-in-ie11/%22Prevent%20default%20'F1'%20event%20in%20iE11%22)让我知道这是否也适用于您。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-12T08:58:35.550

您可以使用 Vanilla Javascript和[KeyboardEvents](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent) `keydown`或.`keypress``keyup`

使用 event.key （最好）或 event.code 并将它们与键名进行比较，例如`event.key === "F1"`.

使用功能键时，您可能希望抑制默认行为（在 Windows 上，[浏览器](https://support.microsoft.com/en-us/microsoft-edge/keyboard-shortcuts-in-microsoft-edge-50d3edab-30d9-c7e4-21ce-37fe2713cfad)使用了许多功能键）。这可以通过调用`preventDefault()`事件来实现`keydown`。即使您想监听`keyup`事件也需要调用`preventDefault()`该`keydown`事件，因为浏览器快捷方式已绑定到该事件。请记住，调用`preventDefault()`也会`keydown` **抑制按键事件。**

```
document
  .addEventListener("keydown", e => {
    if(e.key === "F1") {
      // Suppress default behaviour 
      // e.g. F1 in Microsoft Edge on Windows usually opens Windows help
      e.preventDefault()
    }
  })

document
  .addEventListener("keyup", e => {
    if(e.key === "F1") {
      // Handle the keyup event
      doSomething()
    }
  }) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-02-25T20:55:01.737

**添加快捷方式：**

```
$.Shortcuts.add({
    type: 'down',
    mask: 'Ctrl+A',
    handler: function() {
        debug('Ctrl+A');
    }
}); 
```

**开始对快捷方式做出反应：**

```
$.Shortcuts.start(); 
```

**将快捷方式添加到“另一个”列表：**

```
$.Shortcuts.add({
    type: 'hold',
    mask: 'Shift+Up',
    handler: function() {
        debug('Shift+Up');
    },
    list: 'another'
}); 
```

**激活“另一个”列表：**

```
$.Shortcuts.start('another');
Remove a shortcut:
$.Shortcuts.remove({
    type: 'hold',
    mask: 'Shift+Up',
    list: 'another'
}); 
```

**停止（解除绑定事件处理程序）：**

```
$.Shortcuts.stop(); 
```

**教程： http:**
[//www.stepanreznikov.com/js-shortcuts/](http://www.stepanreznikov.com/js-shortcuts/)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-06-09T11:20:13.753

如果可行，请尝试此解决方案。

```
window.onkeypress = function(e) {
    if ((e.which || e.keyCode) == 116) {
        alert("fresh");
    }
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-03-27T12:39:37.990

我对这个问题的解决方案是：

```
document.onkeypress = function (event) {
    event = (event || window.event);
    if (event.keyCode == 123) { 
         return false;
    }
} 
```

神奇的数字`123`是键 F12。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2018-12-24T11:41:33.453

您可以像这样使用 jquery 执行此操作：

```
 $("#elemenId").keydown(function (e) {
            if(e.key == "F12"){
                console.log(e.key);
            }

        }); 
```

# c# - 从数据表导出到 excel 时，如何阻止前导 0 被剥离？

> ID：424412
> 
> 赞同：1
> 
> 时间：2009-01-08T14:28:53.180
> 
> 标签：c#, asp.net, excel

我遇到了与这个问题相同的问题：

[使用c#导入excel文档时如何防止前导零被剥离](https://stackoverflow.com/questions/22879/how-do-you-prevent-leading-zeros-from-being-stripped-when-importing-an-excel-doc)

但我不确定这是否是我的方案的最佳解决方案。这是我用来进行导出的代码。有谁知道我可以改变什么来防止前导 0 被剥离？

```
private static void Export_with_XSLT_Web(DataSet dsExport, 
                                         string[] sHeaders, 
                                         string[] sFileds, 
                                         ExportFormat FormatType, 
                                         string FileName)
{

        HttpContext.Current.Response.Clear();
        HttpContext.Current.Response.Buffer = true;

        HttpContext.Current.Response.ContentType = "application/vnd.ms-excel";
        HttpContext.Current.Response.AppendHeader("content-disposition", 
                                                  "attachment; 
                                                  filename=" + FileName);
        }

        // XSLT to use for transforming this dataset.                       
        MemoryStream stream = new MemoryStream();
        XmlTextWriter writer = new XmlTextWriter(stream, Encoding.UTF8);

        CreateStylesheet(writer, sHeaders, sFileds, FormatType);
        writer.Flush();
        stream.Seek(0, SeekOrigin.Begin);

        XmlDataDocument xmlDoc = new XmlDataDocument(dsExport);
        XslTransform xslTran = new XslTransform();
        xslTran.Load(new XmlTextReader(stream), null, null);

        using(StringWriter sw = new StringWriter())
        {
            xslTran.Transform(xmlDoc, null, sw, null);

            HttpContext.Current.Response.Write(sw.ToString());                
            writer.Close();
            stream.Close();
            HttpContext.Current.Response.End();
        }
    }
} 
```

这是创建样式表的方法，这里有什么可以更改以将部分或所有字段作为文本引入。

```
private static void CreateStylesheet(XmlTextWriter writer, 
                                     string[] sHeaders, 
                                     string[] sFileds, 
                                     ExportFormat FormatType)
{
    try
    {
        // xsl:stylesheet
        string ns = "http://www.w3.org/1999/XSL/Transform";
        writer.Formatting = Formatting.Indented;
        writer.WriteStartDocument();
        writer.WriteStartElement("xsl", "stylesheet", ns);
        writer.WriteAttributeString("version", "1.0");
        writer.WriteStartElement("xsl:output");
        writer.WriteAttributeString("method", "text");
        writer.WriteAttributeString("version", "4.0");
        writer.WriteEndElement();

        // xsl-template
        writer.WriteStartElement("xsl:template");
        writer.WriteAttributeString("match", "/");

        // xsl:value-of for headers
        for(int i = 0; i < sHeaders.Length; i++)
        {
            writer.WriteString("\"");
            writer.WriteStartElement("xsl:value-of");
            writer.WriteAttributeString("select", "'" + sHeaders[i] + "'");
            writer.WriteEndElement(); // xsl:value-of
            writer.WriteString("\"");
        }

        // xsl:for-each
        writer.WriteStartElement("xsl:for-each");
        writer.WriteAttributeString("select", "Export/Values");
        writer.WriteString("\r\n");

        // xsl:value-of for data fields
        for(int i = 0; i < sFileds.Length; i++)
        {
            writer.WriteString("\"");
            writer.WriteStartElement("xsl:value-of");
            writer.WriteAttributeString("select", sFileds[i]);
            writer.WriteEndElement(); // xsl:value-of
            writer.WriteString("\"");
        }

        writer.WriteEndElement(); // xsl:for-each
        writer.WriteEndElement(); // xsl-template
        writer.WriteEndElement(); // xsl:stylesheet
        writer.WriteEndDocument();
    }
    catch(Exception Ex)
    {
        throw Ex;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T14:47:25.997

我不知道您的 XSL 转换的输出：我假设它是 Excel 的 xml 格式。试图扭转这个过程，我在 Excel 工作表中写了三个数字 (007)：一次作为数字，一次作为文本，一次作为数字，但格式化为显示用零填充的 3 位数字。然后我将它保存为xml并查看它。这是片段：

```
<Row>
    <Cell><Data ss:Type="Number">7</Data></Cell>
</Row>
<Row>
    <Cell><Data ss:Type="String" x:Ticked="1">007</Data></Cell>
</Row>
<Row>
    <Cell ss:StyleID="s22"><Data ss:Type="Number">7</Data></Cell>
</Row> 
```

我不是在复制这种风格，但你可以轻松做到。

编辑：一如既往，谷歌是你的朋友（也是我的朋友；-)）：[http](http://www.creativyst.com/Doc/Articles/CSV/CSV01.htm#CSVAndExcel) ://www.creativyst.com/Doc/Articles/CSV/CSV01.htm#CSVAndExcel 。

编辑（2）：我认为链接就足够了。文章说（如果您确定目标**只是**Excel）您可以使用 Excel 特定的 CSV 语法。因此，在您的情况下并查看您的代码，我认为您应该*插入缺少的逗号*并更改开头

```
writer.WriteString("\""); 
```

进入

```
writer.WriteString("=\""); 
```

请注意我没有尝试。

出于好奇，只有一个问题：仅输出您需要在 DataSet 上处理的内容而不是更简单吗？

*   将其转换为 XML
*   生成临时 XSL
*   执行 XSL 转换
*   将结果复制到响应流

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:34:16.680

在字符串前面添加一个 '（单引号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T14:34:27.133

~~如果您知道一个字段应该是一个 5 位数的邮政编码（或 SSN 的某个部分或其他），您可能必须通过 sprintf() 或任何 c# 等效项手动修复它。如果它是一个不确定的字段，那么您将完全受制于正在读取数据的任何内容。~~

抱歉，我将问题误读为从 Excel 读取到 HTML。

您是否考虑过导出为 CSV 而不是 Excel？

# .net - 建立新的 .NET 项目的最佳方法是什么？

> ID：424422
> 
> 赞同：7
> 
> 时间：2009-01-08T14:32:25.530
> 
> 标签：.net, msbuild, installation, project

所以我新负责我公司的项目（我们仍然只有 2 个人，但我们正在成长）并且我想以正确的方式设置我的项目。

我所有的项目都已经在 SVN 存储库中，我已经设置了错误跟踪软件，但我正在寻找的是使用测试、SVN 和构建服务器来布局新项目的最佳方式。我想为 CI 设置我们所有的新项目，但我不确定如何布置所有内容以使其尽可能顺利。

我知道我需要：

*   构建服务器
*   SVN 存储库中的所有构建/测试材料（包括 DB 模式）
*   有利于CI的项目布局

你们是如何设置项目的？我想为我的构建服务器使用 MSBuild，因为由于 VS，一切都已经以这种方式设置，但我也在寻找有关如何布置文件、如何在解决方案中布置项目等的提示。就目前而言，我的解决方案中有大约 5 个项目，其中一个是测试项目，其中包含我其余项目的所有测试。这是首选方法吗？

您的存储库内的布局如何？你把你的数据库相关的东西放在哪里？规格和文件？

您是否使用任何特定的 CI 软件，或者只是遵循“持续集成更像是一种心态”的口头禅？

总的来说，我正在寻找有关以正确方式启动新项目的技巧，以便以后一切顺利进行，并且便于新开发人员熟悉。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T18:28:47.050

树外科医生 - [http://www.codeplex.com/treesurgeon](http://www.codeplex.com/treesurgeon)

“Tree Surgeon 是一个 .NET 开发树生成器。只需给它您的项目名称，它就会在几秒钟内为您建立一个开发树。不仅如此，您的新树还拥有多年积累的构建工程经验，构建正确在。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T14:41:55.167

亚历克斯，

我建议你从这里开始：http: [//msdn.microsoft.com/en-us/library/ms998208.aspx](http://msdn.microsoft.com/en-us/library/ms998208.aspx)

这涵盖了微软自己的项目结构建议。听上去，您确实应该坚持使用单一解决方案架构。

对于特定的 CI 平台，显然有几个选项可用。其中一些归结为口味和功能。在网上搜索应该会给你大部分你需要的正面和反面的答案！

缺口。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T14:37:02.790

[Cruise Control](http://cruisecontrol.sourceforge.net/)是一款出色的持续集成产品。另一个“更容易”设置的选项是 Jet Brains 的[TeamCity](http://www.jetbrains.com/teamcity/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T15:53:14.663

我将投票支持 Cruise Control 作为 CI，并注意[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)与 MSBuild 完美且轻松地集成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T21:24:13.237

所以我在学习时改变了我的结构，但目前：

```
(SVN REPO)
/trunk
  MyProject  <-- solution & .build file (i use nant or msbuild)
    conf <-- IIS Settings etc go here
    docs <-- that documentation i never do
    lib <-- 3rd Party libraries eg ApplicationBlock,ASPNet MVC
    src
      Web
      Data
      Business
    test
      Web.Test
      Data.Test
      Business.Test  
    tools
      nant
      nunit
      moq
  Project2
    conf
    lib
    src
    test
    tools
/branches
/tags 
```

希望你应该看到我上面的结构

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T14:38:03.303

TeamCity 是一款非常优秀的 CI 产品，它对一定数量的项目是免费的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-04T22:37:51.007

Jenkins 是一个很棒的产品。有非常多的插件和活跃的社区。

与 .NET 完全兼容。支持机器从机。

# linux - Bash Shell - 什么相当于 DOS shell F8？

> ID：424443
> 
> 赞同：11
> 
> 时间：2009-01-08T14:36:49.747
> 
> 标签：linux, bash

在进行交互式 bash 会话时，我想念的 Windows shell 的一个方面是`F8`您开始输入命令的键，点击`F8`后，shell 会找到历史中输入的最新命令，该命令与您迄今为止输入的内容相匹配。例如

```
me@Ubntu07:~>cd /home/jb<F8 Key Here> 
```

调出我之前的命令：

```
me@Ubntu07:~>cd /home/jboss/server/default/log 
```

有没有办法在 bash 中做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-08T14:39:12.817

点击`Ctrl`-`R`在您开始输入之前。

（很可能还有另一个版本可以根据已经输入的内容查找命令 - 我不知道，因为`Ctrl`-`R`对我来说一直足够好 :)

按`Ctrl`-`R`再次显示下一场比赛等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T14:52:02.243

我的 Gentoo 的配置方式是，我可以按 PgUp 和 PgDn 滚动浏览命令历史记录中的那些命令，这些命令以我当前命令行中的内容开头。

```
# cd<PgUp> 
```

结果是：

```
# cd hydrogen 
```

这几乎是相同的功能。它在 my`/etc/inputrc`中用以下几行定义：

```
# mappings for "page up" and "page down" to step to the beginning/end 
# of the history
"\e[5~": history-search-backward
"\e[6~": history-search-forward 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T14:40:05.967

在您的情况下`!jb`，将打印*然后运行*该命令。

例如，

```
$ nano logconfig.properties
$ !n
nano logconfig.properties
$ 
```

当然，如果您想安全起见，请先使用 ctrl-r 调出交互式命令历史记录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T14:40:20.380

`Ctrl`+`R`进行历史搜索。有点不同，*首先你点击 + 然后**输入*你`Ctrl`要找`R`的东西。

 ** * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T15:51:04.560

我的 .inputrc 文件中有这些行：

```
"\e[A": history-search-backward
"\e[B": history-search-forward 
```

这将历史搜索绑定到向上和向下箭头键。所以你可以开始输入一个命令，`kextload`比如说，然后每次点击向上箭头都会完成上一个以 开头的命令的行`kextload`。

我所有的配置文件都在 github 上公开。

[http://github.com/jonshea/config-files/tree/master](http://github.com/jonshea/config-files/tree/master)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T14:45:15.237

如果您只是在谈论一个命令，您可以使用`!<cmd>`来执行最后一个命令。例如，假设您`python runscript.py`之前输入过；你可以输入：

```
!py 
```

或类似的东西再次运行该命令。

要重复命令的参数，您可以执行以下操作：

```
echo !py:1 
```

在本例中，这将`runscript.py`回显到终端。冒号后面的数字是指您想在给定命令中使用的参数。

[这里](http://www.catonmat.net/blog/the-definitive-guide-to-bash-command-line-history/?)还有很多其他关于 bash 历史的重要信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T18:59:30.997

如果您使用 vi 输入模式（在 bash 中设置 -o vi 或通过在 .inputrc 中设置编辑模式 vi），您可以使用普通 vi 命令来搜索历史记录 (/)。这也为您提供了完整的正则表达式，这有助于查找复杂的命令。

# asp.net - 在哪里可以找到有关代码块的信息？

> ID：424450
> 
> 赞同：2
> 
> 时间：2009-01-08T14:38:17.857
> 
> 标签：asp.net

有谁知道一个很好的网站，它总结了您可以在 ASP.Net 中使用代码块（即 <% <%= <%# 等）做什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T14:48:59.457

这是一个 MSDN 页面：[MSDN Embedded Code Blocks](http://msdn.microsoft.com/en-us/library/ms178135.aspx)

```
<%    -  any code

<%=   -  shortcut for Response.Write()    

<%#   -  is for binding

<%--  -  is for comments 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T14:53:05.207

这个问题应该会有所帮助：
[我什么时候应该在 ASP.NET 控件中使用 # 和 =？](https://stackoverflow.com/questions/115159/when-should-i-use-and-in-aspnet-controls)

# php - PHP 在一个字符串中多次出现单词

> ID：424454
> 
> 赞同：2
> 
> 时间：2009-01-08T14:39:18.260
> 
> 标签：php, algorithm, string, substring

我需要检查一个字符串以查看其中是否有任何单词多次出现。所以基本上我会接受：

“谷歌做爱”

但我不接受：

“谷歌让谷歌爱”或“谷歌让谷歌爱谷歌”等。

有任何想法吗？真的不知道有什么方法可以解决这个问题，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T14:58:52.887

基于 Wicked Flea 代码：

```
function single_use_of_words($str) {  
   $words = explode(' ', trim($str));  //Trim to prevent any extra blank
   if (count(array_unique($words)) == count($words)) {
      return true; //Same amount of words
   }   
   return false;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T14:48:07.480

试试这个：

```
function single_use_of_words($str) {
  $words = explode(' ', $str);
  $words = array_unique($words);
  return implode(' ', $words);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T15:35:48.817

不需要循环或数组：

```
<?php

$needle = 'cat';
$haystack = 'cat in the cat hat';

if ( occursMoreThanOnce($haystack, $needle) ) {
    echo 'Success'; 
} 

function occursMoreThanOnce($haystack, $needle) {
    return strpos($haystack, $needle) !== strrpos($haystack, $needle);
}

?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T14:55:50.567

```
<?php
$words = preg_split('\b', $string, PREG_SPLIT_NO_EMPTY);
$wordsUnique = array_unique($words);
if (count($words) != count($wordsUnique)) {
    echo 'Duplicate word found!';
}
?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T23:10:43.003

正则表达式方式肯定是我的选择。

我用 Veynom 的函数和正则表达式对 320 个单词的字符串做了一个小测试

```
function preg( $txt ) {
    return !preg_match( '/\b(\w+)\b.*?\1/', $txt );
} 
```

这是测试

```
$time['preg'] = microtime( true );

for( $i = 0; $i < 1000; $i++ ) {
    preg( $txt );
}

$time['preg'] = microtime( true ) - $time['preg'];

$time['veynom-thewickedflea'] = microtime( true );

for( $i = 0; $i < 1000; $i++ ) {
    single_use_of_words( $txt );
}

$time['veynom-thewickedflea'] = microtime( true ) - $time['veynom-thewickedflea'];

print_r( $time ); 
```

这是我得到的结果

```
Array
(
    [preg] => 0.197616815567
    [veynom-thewickedflea] => 0.487532138824
) 
```

这表明 RegExp 解决方案以及更简洁的解决方案速度是其两倍以上。（对于 320 个单词和 1000 次迭代的字符串）

当我运行测试超过 10 000 次迭代时，我得到

```
Array
(
    [preg] => 1.51235699654
    [veynom-thewickedflea] => 4.99487900734
) 
```

非 RegExp 解决方案也使用更多的内存。

所以.. 对我来说正则表达式，因为他们有满满一罐油

**编辑**
我测试的文本有重复的单词，如果没有，结果可能会有所不同。我将发布另一组结果。

**更新**
删除重复项（现在 186 个单词），1000 次迭代的结果是：

```
Array
(
    [preg] => 0.235826015472
    [veynom-thewickedflea] => 0.2528860569
) 
```

关于偶数

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T14:43:18.970

```
function Accept($str)
{
    $words = explode(" ", trim($str));
    $len = count($words);
    for ($i = 0; $i < $len; $i++)
    {
        for ($p = 0; $p < $len; $p++)
        {
            if ($p != $i && $words[$i] == $words[$p])
            {
                return false;
            }
        }
    }
    return true;
} 
```

**编辑**

整个测试脚本。请注意，当打印“false”时，php 什么都不打印，但 true 打印为“1”。

```
<?php

    function Accept($str)
    {
            $words = explode(" ", trim($str));
            $len = count($words);
            for ($i = 0; $i < $len; $i++)
            {
                    for ($p = 0; $p < $len; $p++)
                    {
                            if ($p != $i && $words[$i] == $words[$p])
                            {
                                    return false;
                            }
                    }
            }
            return true;
    }

echo Accept("google makes love"), ", ", Accept("google makes google love"), ", ",
    Accept("google makes love love google"), ", ", Accept("babe health insurance babe");

?> 
```

打印正确的输出：

```
1, , , 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T15:01:53.660

这似乎相当快。有趣的是（对于所有答案）随着输入字符串的长度增加，内存使用量和所用时间如何增加。

```
function check($str) {
    //remove double spaces
    $c = 1;
    while ($c) $str = str_replace('  ', ' ', $str, $c);

    //split into array of words
    $words = explode(' ', $str);
    foreach ($words as $key => $word) {
        //remove current word from array
        unset($words[$key]);
        //if it still exists in the array it must be duplicated
        if (in_array($word, $words)) {
            return false;
        }
    }
    return true;
} 
```

**编辑**

修复了多个空格的问题。我不确定是否最好在开始时删除这些（就像我一样）或检查每个单词在 foreach 中是否为非空。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T14:44:06.800

最简单的方法是遍历每个单词并检查所有之前的单词是否有重复。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-08T14:44:54.177

带有反向引用的正则表达式

[http://www.regular-expressions.info/php.html](http://www.regular-expressions.info/php.html)

[http://www.regular-expressions.info/named.html](http://www.regular-expressions.info/named.html)

# c++ - C++ 和 gnuplot

> ID：424455
> 
> 赞同：9
> 
> 时间：2009-01-08T14:39:36.217
> 
> 标签：c++, gnuplot

这是我的第一篇文章，我在 C++ 和一般编译方面是个新手。

我正在编译一个需要绘制一些图表的程序。该程序创建一个*.dat 文件，然后我应该打开 gnuplot 并编写绘图“* .dat”。没关系。

有没有办法让 gnuplot 自动打开并显示我需要的情节？我应该在代码中使用一些 system() 函数来调用 gnuplot 但我怎样才能让他绘制我需要的东西？

对不起我不完美的英语：s

无论如何感谢您的关注！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T20:00:55.287

根据您的操作系统，您可能可以使用[popen()。](http://www.opengroup.org/onlinepubs/007908799/xsh/popen.html) 这将让您生成一个 gnuplot 进程，然后像任何其他 FILE* 一样写入它。

如果您有要绘制的数据点，您可以将它们与*plot "-" ...*选项内联传递。同样，您可能想要探索*设置数据样式点/线/线点/等*选项。

* * *

如果没有暂停或持续，gnuplot 将在输入流结束时终止。在您的示例情况下，那将是到达文件末尾的时候。

* * *

要生成（写入）输出文件（图形），请使用：

```
set terminal png small
set output "filename.png" 
```

有很多选项可以*设置终端*。Png通常在那里。如果没有，也许是 gif、tiff 或 jpeg？

注意覆盖文件！

您可能希望使用*set size 2,2*来制作更大的图表。一些*设置终端*变体还允许您指定大小。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-19T21:49:47.840

我今天也在学习这个。这是我做的一个小例子。

```
#include <iostream>
#include <fstream> 
using namespace std;
int main(int argc, char **argv) {
    ofstream file("data.dat");
    file << "#x y" << endl;
    for(int i=0; i<10; i++){
        file << i << ' ' << i*i << endl;
    }
    file.close();
    return 0;
} 
```

将其保存为 plot.cpp 并使用 g++ 编译：

```
g++ plot.cpp -o plot 
```

运行程序以创建 .dat 文件：

```
./plot 
```

将以下 gnuplot 脚本另存为 plot.plt：

```
set terminal svg enhanced size 1000 1000 fname "Times" fsize 36
set output "plot.svg"
set title "A simple plot of x^2 vs. x"
set xlabel "x"
set ylabel "y"
plot "./data.dat" using 1:2 title "" 
```

使用 gnuplot 运行脚本以生成 .svg 文件：

```
gnuplot plot.plt 
```

结果图将在 plot.svg 中。如果您省略指定输出的前几行，它将在窗口中呈现。玩得开心！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T14:45:35.627

有时它就像人们想象的那样简单

```
 gnuplot file 
```

其中 file 既不是您的数据也不是您的结果文件，而是一个包含您将在命令行中键入的命令的文件。只需在此处输入您需要的命令（您拥有的常量文件或生成它）。执行该文件中的所有命令后，gnuplot 退出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T14:42:27.897

是的你可以。您可以创建一个文件，其中包含您要输入的命令来设置绘图并打开从该文件运行的 gnuplot。 [这个链接](http://t16web.lanl.gov/Kawano/gnuplot/datafile2-e.html)有一篇文章解释了如何做到这一点。您还可以输出到 EPS 或其他图形输出格式，并使用读取文件的另一个小部件显示绘图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T15:38:50.903

您可能需要在命令中使用“-persist”标志。我知道在 *nix 系统上，如果您希望在 gnuplot 进程完成并退出后保留绘图窗口，则需要此标志。

gnuplot -persist commands.gp

此外，您可以在文件中添加任意数量的 gnuplot 命令。在这方面，该文件的行为有点像批处理脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T15:11:40.660

您可能需要设置终端类型。阅读有关此的 gnuplot 文档。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T15:40:01.023

您可能需要添加一行

```
pause -1 
```

这将显示绘图，直到按下返回。
您可能看到的是 gnuplot 在绘图有时间显示之前运行并退出。

# dependency-injection - 有没有人对依赖注入有一个很好的类比？

> ID：424457
> 
> 赞同：25
> 
> 时间：2009-01-08T14:39:47.853
> 
> 标签：dependency-injection

我已经阅读了很多关于依赖注入的文章以及观看了很多视频，但我仍然无法理解它。有没有人有一个很好的类比来解释它？

我看了敏捷之秋截屏的第一部分，仍然有点困惑。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-01-08T14:43:18.923

***类比***？我会试一试...如果没有带有音乐的 CD，您的 CD 播放器立体声将毫无用处...（这取决于 CD）。如果他们用已经在里面的 CD 制作 CD 播放器，那会很快变得无聊……

因此他们构建了它们，以便您可以将 CD（它所依赖的）“注入”到播放器中。这样，您每次都可以注入不同的行为，并根据您注入的行为获得“不同”的行为（音乐）。

唯一的要求是 CD 必须与播放器定义的***接口******兼容。***（您不能在 1992 年的 CD 播放器中播放蓝光光盘。）

 ** * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T14:45:48.607

我能想到的最好的比喻是雇佣一名机械师。

*在没有*依赖注入的情况下，你雇佣了一名技工，而技工带来了他自己的工具。他可能有糟糕的工具，他可能有很棒的工具，当他应该使用套筒时，他可能正在使用管子扳手。你不知道，也可能不在乎，只要他完成工作。

*通过*依赖注入，你雇佣了一名技工，你为他提供了你希望他使用的工具。您可以选择您认为最适合或最适合您雇用他的工作的工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T15:19:31.410

将其视为“控制反转”模式的实现。我想，你的问题是，你太习惯了，你没有意识到它这么简单。

让我们从头开始。

在早期，程序在代码中遵循给定的路径。调用函数的顺序由程序员给出。

在交互式程序中，例如大多数是 ANY 程序，你不能说什么时候调用哪个函数。只需查看 GUI 或网站即可。你不能说，什么时候点击了什么按钮或链接。因此，对正在发生的事情的“控制”不再是在程序中，而是在外部来源。“控制”已经倒转。该功能不再是“表演”，而是“聆听”。想想好莱坞的原则：“不要叫我们，我们叫你”。监听器是实现这种模式的一个很好的例子。

在当今“面向对象的世界”中，IoC 是通过函数或“方法”来实现的。

“依赖注入”现在的意思是一样的，但不是针对**做某事**的“方法” ，而是针对**保存数据**的“对象” 。

数据不再是持有它的对象的一部分。它在运行时被“注入”到对象中。留在好莱坞，想想一个电影明星，打高尔夫球来谈论生意，但为了保持身材，她渴望自己，尽量减少她的肌肉重量，因此她一次只能携带一个球杆。

因此，在高尔夫球场上，她的比赛很大程度上取决于她所携带的一根球杆。

对她来说幸运的是，有球童，一次携带一大堆球杆，并且知道什么时候使用什么球杆。现在，她摆脱了携带高尔夫球杆的有限可能性。“不要想着要穿一个具体的俱乐部，我们都知道，并在正确的时间为您提供正确的俱乐部”。

电影明星是客体，高尔夫球杆是客体的成员。这就是依赖注入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T14:45:37.313

也许专注于“注入”部分？当我看到这个词时，我想到了注射器。将组件的依赖推送到组件的过程可以认为是注入到组件中。

就像身体一样，当它需要某种药物（它需要的成分）时，您可以将其注入体内。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T14:54:53.003

在 2003 年的 JavaPolis 演示文稿（[幻灯片](http://docs.huihoo.com/picocontainer/JavaPolis2003.pdf)）中，Jon Tirsén 和 Aslak Hellesøy 用一个需要亲吻的`Girl`物体进行了有趣的类比。`Boy`我似乎记得`BoyFactory`有时被称为“夜总会”，但幻灯片中没有。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T14:58:36.163

另一个类比：假设您是一名开发人员，只要您愿意，您就可以直接从市场上订购计算机科学书籍——您知道卖家和他们的价格。事实上，您的公司可能有首选卖家，您可以直接与他们联系。所有这一切都很好，但可能是一个新卖家现在提供了更好的价格，而您的公司想要改变“首选”卖家。

此时您必须进行以下更改 - 更新联系方式（和其他内容）以使用新卖家。您仍然直接下订单。

现在考虑我们在两者之间引入一个新步骤，公司中有一个“图书馆”官员，你必须通过他才能拿到书。虽然存在新的依赖关系，但您现在不受卖方任何更改的影响：无论是卖方更改付款方式还是卖方本人已更改，您现在只需向图书管理员下订单，他就会为您取书。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T17:06:06.513

从*Head First 设计模式*：

> 请记住，代码应该像晚上的莲花一样关闭（改变），而像早上的莲花一样开放（扩展）

可以通过注入其他类中定义的行为来配置启用 DI 的对象。原始对象结构没有更改以创建许多变化。注入可以通过在其构造函数中让类请求其他工作类来显式地进行，或者在 Python 等动态语言中使用猴子补丁时可能不太明显。

使用 Person 类的类比，您可以采用一个基本的人体框架，将一组器官传递给它，然后观察它的演变。Person 并不直接知道器官是如何工作的，但它们的行为符合预期的界面并影响所有者的身心表现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T17:14:57.527

魔术师的[绝招](http://en.wikipedia.org/wiki/Sleight_of_hand)！你可能认为你看到的东西可能会被秘密操纵或替换。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T17:30:06.233

生活中充满了依赖注入的类比：

*   打印机墨盒
*   数码设备 - 电池
*   信-邮票
*   音乐家 - 乐器
*   公车司机
*   病痛丸

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-15T08:52:24.767

控制反转（依赖注入是其中的一种实现）的本质是将对象的使用与对象的管理分离。

我使用的类比/示例是引擎。发动机需要燃料才能运行，即它依赖于燃料。但是，发动机不能为其所需的燃料负责。它只是“要求”燃料，并提供燃料（通常由汽车中的燃料泵提供）。

当你看得太深时，这个类比就会开始崩溃，因为发动机不需要燃料，它是由某种管理元素提供的，比如 ECU。也许可以将 ECU 与容器进行比较，但我不确定这是否有效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-08T14:47:09.617

您的项目经理要求您编写一个应用程序。

你可以根据你目前的职业经验编写一些代码，但这不太可能是你的 PM 想要的。

*如果您的 PM 依赖项为您*注入了应用程序的规范，那就更好了。现在您的代码将与他给您的规范相关。

如果您被告知源存储库在哪里，那就更好了。

如果您被告知技术平台是什么，那就更好了。

如果您被告知何时需要这样做，那就更好了。

ETC..

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-12-30T04:08:07.157

我认为一个很好的类比是一个六岁的孩子带着一套乐高积木。

您希望您的对象像乐高积木一样。每一个都独立于所有其他的，但提供了一个清晰的界面来将它们连接到其他的。将它们连接在一起时，只要它们具有匹配的接口，您将哪两块砖连接在一起并不重要。

你的依赖注入框架就像六岁的孩子。他按照说明（即您的配置文件、注释等）以特定方式将特定积木连接在一起以制作特定模型。

当然，由于积木的界面非常通用，它们可以以许多不同的方式组合在一起，所以很容易想出新的指令集，六岁的孩子可以用它们来制作一个完全不同的模型同样的砖。

# jasper-reports - PAGE_COUNT 在 JasperReports 中未正确呈现...？

> ID：424468
> 
> 赞同：9
> 
> 时间：2009-01-08T14:41:35.683
> 
> 标签：jasper-reports

我已将页脚***Page x of y***添加到报告中，但 PAGE_COUNT 似乎不起作用。

也许是因为我有很多子报表而出现问题？

我得到：

```
Page 1 of 1

Page 2 of 0

Page 3 of 0

Page 4 of 0 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T14:34:00.130

好吧，不知道旧版本，但在 JasperReports 4.5.1 中；您可以定义两个都包含`$V{PAGE_NUMBER}`变量的文本字段。有`EvaluationTime: now`显示当前页码的；另一个`EvaluationTime: report`显示总页数。一个简单但有效的技巧:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-10-15T09:04:13.977

改变`evaluationTime="Report"`解决了问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T16:53:58.893

我找到了解决方案。

[http://jasperforge.org/tracker/index.php?func=detail&aid=2873&group_id=102&atid=612](http://jasperforge.org/tracker/index.php?func=detail&aid=2873&group_id=102&atid=612)

但是 JasperReports for Java Developers 一书（第 146 页）说 PAGE_COUNT 是报告中的总页数。我猜这个错误在书中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T17:04:56.393

我们的报告看起来像：

[http://pastebin.com/m401fa41](http://pastebin.com/m401fa41)

第一部分，在页面生成期间解释，给出当前页面的 # ( `evaluationTime="Now"`)

第二部分，在报告末尾解释，给出总页数 ( `evaluationTime="Report"`)

高温高压

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-26T20:35:25.300

其实这是一个BUG！并得到开发商的确认。

见链接： [jasper community bug tracker link](http://community.jaspersoft.com/jasperreports-library/issues/3788)

在 BAND 上使用属性时，PAGE_COUNT 计算不正确：“Split Prevent”

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-11T16:00:51.833

解决方法如下：我们不能将 $ { V PAGE_NUMBER }+ "/" + $ { V } PAGE_NUMBER 放在同一个字段中。

正确的方法是将 $ { V PAGE_NUMBER } 放在单独的字段中，并将 "/ " + $ { V } PAGE_NUMBER 放在另一个字段中

它对我有用

对不起我的英语不好

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-25T14:00:57.220

摘要：在TextField中拥有页码和页码。

第 1 步：创建一个表示当前页数的变量。设置：* 名称：CURRENT_PAGE_NUMBER

*   变量类：Java.lang.Integer

*   计算：无

*   重置类型：无

*   增量类型：页面

*   变量表达式：$ V {CURRENT_PAGE_NUMBER} == null？$ V {PAGE_NUMBER}：$ V {PAGE_NUMBER} +1

第 2 步：文本字段设置

*   文本字段表达式："PAGE:" + $ V {CURRENT_PAGE_NUMBER} + "/" + $ V {PAGE_NUMBER}

*   表达式类：Java.lang.String

*   评估时间：自动

就这样。无需添加任何内容即可获得如下结果：第 1/3 页 | 第 2/3 页 | 第 3/3 页。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-13T19:59:57.927

我无法访问 jaspercommunity（查看共享的链接），但我做了一个很好的解决方法：D

使用 4 个文本，如下所示：

```
txtStatic1(Page) txtField1($V{PAGE_NUMBER})  txtStatic2(of) txtField2($V{PAGE_NUMBER}) 
```

在哪里：

```
txtField1($V{PAGE_NUMBER}) -> AVAILABLE TIME = PAGE
txtField2($V{PAGE_NUMBER}) -> AVAILABLE TIME = REPORT 
```

这对我有用。

# javascript - YUI Compressor 中 JQuery 文件的压缩问题

> ID：424469
> 
> 赞同：24
> 
> 时间：2009-01-08T14:41:48.943
> 
> 标签：javascript, jquery, compression, yui

我正在尝试使用 YUI 压缩器缩小一些文件。但是，我似乎在 2 行代码上遇到错误，这会阻止压缩。[jcarouselLite](http://www.gmarwaha.com/jquery/jcarousellite/)的 .js 文件包含 1 个错误，而我自己的代码包含另一个错误。

我已经缩小了范围，在这两种情况下，看起来 jQuery 中使用的 float 属性都会导致这种情况。该行是：

```
li.css({overflow: "hidden", float: o.vertical ? "none" : "left"}); (jcarousellite)

$("#now-playing .js-kit-rating div:first").css({width: "80px", float: "right"}).addClass("clearing"); (own code) 
```

[通过 YUI 压缩器运行jCarouselLite 代码](http://www.gmarwaha.com/jquery/jcarousellite/js/jcarousellite_1.0.1.js)可以看到错误的工作示例，但基本上返回的错误是无效的属性 id。

有人用 YUI 压缩器遇到过类似的问题吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-01-08T14:46:15.627

它本身不是 YUI，而是 jcarouselLite js。“float”是保留字。它需要放在引号中。例如：

```
li.css({overflow: "hidden", "float": o.vertical ? "none" : "left"}); 
```

与您自己的代码类似的问题。YUI 正在尽最大努力编译该 js，但会拒绝/警告您发现的代码与您找到的代码类似。IMO 它正在做正确的事情。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-14T16:27:18.450

我用“类”这个词遇到过几次这个问题。如果您在服务器端使用 YUI，它应该吐出它抱怨的行号。

这是一个看起来相当全面的保留字列表。

[http://mattsnider.com/languages/javascript/reserved-words-in-javascript/](http://mattsnider.com/languages/javascript/reserved-words-in-javascript/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-25T20:47:06.900

这里的其他答案回答了实际问题（保留词）。但是我通过[BundleTransformer](http://bundletransformer.codeplex.com/)使用 YUI ，它没有输出行号，所以我有点迷失在哪里看。

为了加快查找关键字的过程，我去寻找另一个工具。

**[这个在线 YUI 压缩器](http://refresh-sf.com/)帮助我找到了有问题的属性名称。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-12T23:22:02.323

在我的情况下，当 YUI 无法压缩我的文件时，这是因为我在 js 文件中有“调试器”。希望这可以节省其他人几个小时的调试时间！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-19T12:10:08.787

我已经为更新 yui 压缩器准备了一个自定义版本

[https://github.com/MrD0llaro/yuicompressor](https://github.com/MrD0llaro/yuicompressor) 和 [https://github.com/MrD0llaro/yui-compressor-ant-task/](https://github.com/MrD0llaro/yui-compressor-ant-task/) 用于新的 Jquery 3.5.1

# c++ - 如何在不打开应用程序的新实例的情况下在正在运行的应用程序中打开新文档？

> ID：424503
> 
> 赞同：1
> 
> 时间：2009-01-08T14:52:05.210
> 
> 标签：c++, windows

我的情况已被 SO 的其他答案部分覆盖，但我找不到完整的答案。简而言之，我们正在尝试将 URL 用于我们特定的数据类型，当双击时将打开我们的应用程序并将这些数据集加载到该应用程序中。我们有这部分工作。

（例如，一个 URL 可能如下所示：resource://shaders/basic_shader.hlsl）

我们想要做的是防止在双击新 URL 时打开应用程序的新实例。例如，假设我们有一个在着色器编辑器中打开着色器的 URL。单击此资源 URL 时，它将打开我们的着色器编辑器。单击新着色器 URL 时，我们希望能够在当前运行的应用程序中打开着色器，并让它在我们编辑器的新选项卡中打开新着色器。

我们可以很容易地检测到我们的应用程序的另一个实例是否正在运行。我们不知道如何轻松解决的问题是如何告诉当前正在运行的应用程序打开这个新文件进行编辑。这种行为与 Apple Finder 非常相似。

在 unix 中，您可以通过让应用程序打开一些命名管道来模拟这种行为，然后新应用程序可以检查该管道是否处于活动状态，然后将文档数据发送到管道中。是否有更标准的 Windows 方式来实现此行为？

我们需要一个 C/C++ 解决方案。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T15:00:35.393

命名管道是最好的方法。您的应用程序的第一个实例打开管道并监听它（使用 PIPE_ACCESS_INBOUND 作为 dwOpenMode 并且相同的代码也将允许您检测正在运行的实例）。所有后续实例检查它们是否单独，将命令行参数发送到管道并关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:22:03.417

正如大卫格兰特所说，在应用程序启动时创建一个命名互斥锁，然后在显示第二个 URL 的 UI 之前，检查这个互斥锁，如果它已经创建，那么只需将新 URL 传递给第一个启动的应用程序即可退出（在应用程序设置 URL 并告诉以编程方式重定向）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T14:58:59.627

您无法避免与要执行的 url 关联的程序。

“windows”解决方案是向先前运行的应用程序发送一条消息（过去通过 DDE，但现在可能有更“现代”的东西），然后退出......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T15:14:20.953

您可以在启动时获取一个命名互斥体并以这种方式执行它。

*   [http://www.google.com/search?hl=en&q=named+mutex+single+instance](http://www.google.com/search?hl=en&q=named+mutex+single+instance)
*   [MSDN 上的 CreateMutex](http://msdn.microsoft.com/en-us/library/ms682411(VS.85).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:50:56.677

I got this working pretty well for my C++ MFC application by following Joseph Newcomer's tutorial [here](http://www.flounder.com/nomultiples.htm). He uses a named mutex that is checked on startup and a message sent to the already-running application with the new resource to be opened.

# java - 在 Java 中单元测试线程安全的任何令人满意的方法？

> ID：424516
> 
> 赞同：46
> 
> 时间：2009-01-08T14:54:47.573
> 
> 标签：java, multithreading, thread-safety

我正在考虑改进一个包，当它的输入在多个工作线程之间共享时，我认为它不是线程安全的。根据 TDD 原则，我应该编写一些一开始就失败的测试，这些测试肯定对评估问题很有用。

我意识到这不是一件容易实现的事情，而且天真地，多线程测试将是不确定的，因为操作系统将确定调度和各种操作交错的确切顺序。我过去看过并使用过[MultithreadedTC](http://www.cs.umd.edu/projects/PL/multithreadedtc/overview.html)，这很有用。然而，在那种情况下，我提前知道现有实现在哪里失败，因此能够编写一组很好的测试来覆盖它。

但是，如果您还没有确切地知道问题出在哪里，是否有一种很好的方法可以编写一个很有可能引发任何潜在问题的测试？是否有其他人发现有帮助的库？我认为从纯粹主义者的角度来看，多线程测试用例应该与通常的单线程测试相同的调用和断言是正确的吗，只在适当的情况下使用多个工作线程运行？

任何关于工具/最佳实践/哲学的提议都将受到欢迎。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-08T17:45:14.017

[Java Concurrency in Practice](http://jcip.net/)提供了一些关于如何为并发问题编写测试的重要信息。但是，它们不是真正的单元测试。几乎不可能为并发问题编写真正的单元测试。

基本上可以归结为这一点。创建一堆测试线程并启动它们。每个线程应该

*   等待倒计时锁存器
*   重复调用一些修改相关可变状态的方法
*   倒计时第二个锁存器并退出

junit 线程创建所有线程并启动它们，然后在第一个锁存器上倒计时一次以让它们全部离开，然后等待第二个锁存器，然后对可变状态进行一些断言。

甚至比其他类型的错误更重要的是，在找到错误*之后为并发错误编写失败的单元测试更容易。*

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-08T15:52:38.347

忘记通过测试并发问题来获得好的结果。尝试减少同步并使问题更小。然后使用尽可能高的库支持来做同步。只有当你真的有然后尝试自己处理并发。当您知道每个工作人员都正确地完成了工作并且您的所有想法都告诉您已经解决了并发问题时，就会产生一些有趣的负载。单元测试框架及其扩展可以完成这项工作，但要知道您不再测试任何单元。（请记住，您已经涵盖了该部分）

如果您的并发模型变得复杂，请查看适合[SPIN](http://spinroot.com/spin/whatispin.html)之类的工具。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-08T21:14:21.877

您必须解决两个基本问题。首先是：如何产生线程冲突？其次，你如何验证你的测试？

第一个很简单。使用大锤子。编写一些能够检测一个线程踩到另一个线程的代码，并在 50 个连续线程上运行该代码 50 次左右。您可以使用倒计时锁存器执行此操作：

```
public void testForThreadClash() {
  final CountDownLatch latch = new CountDownLatch(1);
  for (int i=0; i<50; ++i) {
    Runnable runner = new Runnable() {
      public void run() {
        try {
          latch.await();
          testMethod();
        } catch (InterruptedException ie) { }
      }
    }
    new Thread(runner, "TestThread"+i).start();
  }
  // all threads are waiting on the latch.
  latch.countDown(); // release the latch
  // all threads are now running concurrently.
} 
```

您的 testMethod() 必须生成一种情况，在这种情况下，如果没有同步块，某个线程将踩到另一个线程的数据。它应该能够检测到这种情况并抛出异常。（上面的代码没有这样做。异常很可能会在其中一个测试线程上生成，您需要放入一种机制来在主线程上检测它，但这是一个单独的问题。我留下了它为简单起见，但您可以使用第二个锁存器来执行此操作，测试可以在异常时过早清除它。）

第二个问题比较棘手，但有一个简单的解决方案。问题是：你怎么知道你的锤子会产生碰撞？当然，你的代码有同步块来防止冲突，所以你不能回答这个问题。但是你可以。*只需删除同步的关键字。*由于使您的类线程安全的是 synchronized 关键字，因此您可以删除它们并重新运行测试。如果测试有效，它现在将失败。

当我第一次编写上面的代码时，结果证明它是无效的。我从没见过冲突。所以它（还）不是一个有效的测试。但是现在我们知道如何得到第二个问题的明确答案了。我们得到了错误的答案，但我们现在可以修改测试以生成我们正在寻找的失败。这就是我所做的：我只是连续运行了 100 次测试。

```
for (int j=0; j<100; ++j) {
  testForThreadClash();
} 
```

现在我的测试在大约第 20 次迭代时可靠地失败了。这证实了我的测试是有效的。我现在可以恢复 synchronized 关键字并重新运行测试，确信它会告诉我我的类是否是线程安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:59:57.910

在某些情况下，我发现我可以通过使用彼此同步的多个线程（可能使用 CountDownLatch 或某种此类并发机制）来强制对潜在的非线程安全类的调用进行特定的有问题的交错。然而，有时这只是行不通，例如，如果您试图测试如果两个线程同时在同一个方法中会发生什么。

这是一篇有趣的文章（虽然对该工具了解不多）：[http ://today.java.net/pub/a/today/2003/08/06/multithreadedTests.html](http://today.java.net/pub/a/today/2003/08/06/multithreadedTests.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-20T18:20:49.570

如果线程是您正在测试的代码的重点（想想并发数据结构），那么对多线程代码进行单元测试就没有错。一般的方法是阻塞主测试线程，在单独的线程中执行断言，在主线程中捕获并重新抛出任何失败的断言，否则解除阻塞主测试线程以便测试可以完成。[使用ConcurrentUnit](https://github.com/jhalterman/concurrentunit)非常简单：

```
@Test
public void shouldDeliverMessage() throws Throwable {
  final Waiter waiter = new Waiter();

  messageBus.registerHandler(message -> {
    // Called on separate thread
    waiter.assertEquals(message, "foo");

    // Unblocks the waiter.await call
    waiter.resume();
  };

  messageBus.send("foo");

  // Wait for resume() to be called
  waiter.await(1000);
} 
```

这里的关键是，任何线程中的任何失败断言都将由 重新抛出到主线程中`waiter`，从而允许测试通过或失败。

# c# - 单元测试和验证逻辑

> ID：424517
> 
> 赞同：13
> 
> 时间：2009-01-08T14:54:52.910
> 
> 标签：c#, .net, unit-testing, validation, tdd

我目前正在为包含验证例程的业务逻辑类编写一些单元测试。例如：

```
public User CreateUser(string username, string password, UserDetails details)
{
    ValidateUserDetails(details);
    ValidateUsername(username);
    ValidatePassword(password);

    // create and return user
} 
```

我的测试夹具是否应该包含针对 Validate* 方法中可能发生的每个可能的验证错误的测试，还是将其留给单独的一组测试更好？或者也许应该以某种方式重构验证逻辑？

我的理由是，如果我决定测试 CreateUser 中可能发生的所有验证错误，那么测试夹具将变得非常臃肿。而且大多数验证方法都在不止一个地方使用...

在这种情况下有什么好的模式或建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T14:58:46.100

每个测试应该只因为一个原因而失败，并且只有一个测试应该因为那个原因而失败。

这对编写一组可维护的单元测试有很大帮助。

我会为 ValidateUserDetails、ValidateUsername 和 ValidateUserPassword 分别编写几个测试。然后您只需要测试 CreateUser 是否调用了这些函数。

* * *

重新阅读您的问题；似乎我误解了一些事情。

您可能会对 JP Boodhoo 所写的关于他的行为驱动设计风格的内容感兴趣。 [http://blog.developwithpassion.com/2008/12/22/how-im-currently-writing-my-bdd-style-tests-part-2/](http://blog.developwithpassion.com/2008/12/22/how-im-currently-writing-my-bdd-style-tests-part-2/)

BDD 正在成为一个非常超载的术语，每个人都有不同的定义和不同的工具来做到这一点。据我所知，JP Boodhoo 正在做的是根据关注点而不是类来拆分测试夹具。

例如，您可以创建单独的夹具来测试用户详细信息的验证、用户名的验证、密码的验证和创建用户。BDD 的想法是，通过以正确的方式命名测试装置和测试，您可以通过打印出测试装置名称和测试名称来创建几乎读起来像文档的东西。按关注点而不是按类对测试进行分组的另一个优点是，您可能只需要为每个夹具设置一个设置和拆卸例程。

不过，我自己对此并没有太多经验。

如果您有兴趣阅读更多内容，JP Boodhoo 在他的博客上发布了很多关于此的内容（请参见上面的链接），或者您也可以收听 Scott Bellware 的 dot net Rocks 插曲，其中他谈到了类似的分组和命名方式测试[http://www.dotnetrocks.com/default.aspx?showNum=406](http://www.dotnetrocks.com/default.aspx?showNum=406)

我希望这是您正在寻找的更多内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T15:28:35.260

你肯定需要测试*验证*方法。

无需为所有可能的参数组合测试其他方法，以确保执行验证。

您似乎在混合验证和合同设计。

**通常执行**验证以友好地通知用户他的输入不正确。**跟业务逻辑有很大关系（密码不够强，邮件格式不对等）。**

 ****契约式设计**确保您的代码可以在以后不抛出异常的情况下执行（即使没有它们，您也会得到异常，但要晚得多，而且可能更晦涩难懂）。

关于应该包含验证逻辑的应用程序层，最好的可能是[服务层（由 Fowler 提供）](http://martinfowler.com/eaaCatalog/serviceLayer.html)，它定义了应用程序边界并且是清理应用程序输入的好地方。并且在这个边界内不应该有任何验证逻辑，只有按合同设计才能更早地检测到错误。

所以最后，当你想友好地通知用户他错了时，编写验证逻辑测试。否则使用按合同设计并继续抛出异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T15:06:52.853

*   让针对 Validate 方法的单元测试（复数）确认它们的正确功能。
*   让针对 CreateUser 方法的单元测试（复数）确认其正确运行。

如果只需要 CreateUser 调用 validate 方法，但不需要自己做出验证决定，那么针对 CreateUser 的测试应该确认该要求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T17:02:45.820

您的业​​务逻辑类的职责是什么，除了验证之外它还做些什么？我想我很想根据您的上下文将验证例程移动到它自己的一个类（UserValidator）或多个类（UserDetailsValidator + UserCredentialsValidator）中，然后为测试提供模拟。所以你的班级现在看起来像：

```
public User CreateUser(string username, string password, UserDetails details)
{
    if (Validator.isValid(details, username, password)) {
       // what happens when not valid
    }

    // create and return user
} 
```

*然后，您可以纯粹*为验证提供单独的单元测试，并且您对业务逻辑类的测试可以专注于验证何时通过和验证失败，以及所有其他测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:54:16.673

我会为每个 ValidateXXX 方法添加一堆测试。然后在 CreateUser 中创建 3 个测试用例来检查当 ValidateUserDetails、ValidateUsername 和 ValidatePassword 中的每一个失败但另一个成功时会发生什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T16:00:58.767

我正在使用[Lokad 共享库](http://rabdullin.com/shared-libraries/)来定义业务验证规则。这是我测试极端案例的方法（来自开源的示例）：

```
[Test]
public void Test()
{
  ShouldPass("rinat.abdullin@lokad.com", "pwd", "http://ws.lokad.com/TimeSerieS2.asmx");
  ShouldPass("some@nowhere.net", "pwd", "http://127.0.0.1/TimeSerieS2.asmx");
  ShouldPass("rinat.abdullin@lokad.com", "pwd", "http://sandbox-ws.lokad.com/TimeSerieS2.asmx");

  ShouldFail("invalid", "pwd", "http://ws.lokad.com/TimeSerieS.asmx");
  ShouldFail("rinat.abdullin@lokad.com", "pwd", "http://identity-theift.com/TimeSerieS2.asmx");
}

static void ShouldFail(string username, string pwd, string url)
{
  try
  {
    ShouldPass(username, pwd, url);
    Assert.Fail("Expected {0}", typeof (RuleException).Name);
  }
  catch (RuleException)
  {
  }
}

static void ShouldPass(string username, string pwd, string url)
{
  var connection = new ServiceConnection(username, pwd, new Uri(url));
  Enforce.That(connection, ApiRules.ValidConnection);
} 
```

其中 ValidConnection 规则定义为：

```
public static void ValidConnection(ServiceConnection connection, IScope scope)
{
  scope.Validate(connection.Username, "UserName", StringIs.Limited(6, 256), StringIs.ValidEmail);
  scope.Validate(connection.Password, "Password", StringIs.Limited(1, 256));
  scope.Validate(connection.Endpoint, "Endpoint", Endpoint);
}

static void Endpoint(Uri obj, IScope scope)
{
  var local = obj.LocalPath.ToLowerInvariant();
  if (local == "/timeseries.asmx")
  {
    scope.Error("Please, use TimeSeries2.asmx");
  }
  else if (local != "/timeseries2.asmx")
  {
    scope.Error("Unsupported local address '{0}'", local);
  }

  if (!obj.IsLoopback)
  {
    var host = obj.Host.ToLowerInvariant();
    if ((host != "ws.lokad.com") && (host != "sandbox-ws.lokad.com"))
      scope.Error("Unknown host '{0}'", host);
  } 
```

如果发现了一些失败案例（即：添加了新的有效连接 url），则规则和测试将被更新。

更多关于这种模式的信息可以在[这篇文章](http://rabdullin.com/journal/2008/11/23/net-application-block-for-validation-and-business-rules.html)中找到。一切都是开源的，所以请随意重用或提问。

PS：请注意，此示例复合规则中使用的**原始规则**（即 StringIs.ValidEmail 或 StringIs.Limited）已自行彻底测试，因此**不需要过多的单元测试**。

# java - 如何识别 Java DateUtils.parseDate 中的祖鲁时区？

> ID：424522
> 
> 赞同：17
> 
> 时间：2009-01-08T14:55:19.743
> 
> 标签：java, date, parsing, timezone

我有格式的日期`2008-12-23T00:00:00Z`。这看起来很像带有 Zulu (UTC) 时区的[ISO 8601 格式。](http://en.wikipedia.org/wiki/ISO_8601)我虽然下面的代码会解析它（使用[commons-lang](http://commons.apache.org/lang/api-release/org/apache/commons/lang/time/DateFormatUtils.html#ISO_DATETIME_TIME_ZONE_FORMAT)）：

```
String pattern = DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.getPattern();
Date d = DateUtils.parseDate(dateToParse, new String[] { pattern }); 
```

如果我采用相同的模式 ( `yyyy-MM-dd'T'HH:mm:ssZZ`) 但删除时区，它会起作用。

你知道我怎么能认出祖鲁时区吗？我只能访问 Java 1.4 和 Jakarta commons-lang。我还没有[乔达时间](http://www.joda.org/joda-time/)......

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-08T15:31:50.043

我认为 commons-lang 正在使用 java 的内置 DateFormat 或 SimpleDateFormat ，它会为您的日期抛出 ParseException 。如果所有输入字符串都以尾随 Z 结尾，则可以使用以下命令：

```
 java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
// explicitly set timezone of input if needed
df.setTimeZone(java.util.TimeZone.getTimeZone("Zulu"));
java.util.Date date = df.parse("2008-12-23T00:00:00Z"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T15:06:39.923

看起来像 commons-lang's 中的错误`FastDateFormat`。告诉他们，你最终应该得到修复。在此之前，您可以尝试预处理日期并将“Z”替换为“+00”

# javascript - 不允许从地址栏调用 javascript 函数

> ID：424524
> 
> 赞同：3
> 
> 时间：2009-01-08T14:56:11.720
> 
> 标签：javascript, web-applications, web

我正在与一个在线游戏网站合作。有一些事件调用了 javascript 函数，并且该函数有一些带有回调的操作。

像这样的东西，

```
 <input type="button" onclick="changeSomething"/>

 function changeSomething() {
         /// some call back, which changes something 
 } 
```

现在任何知道这一点的人都可以从浏览器的地址栏中调用这个 changeSomething，这是我不想要的。

不太可能有人会这样做，但我想允许它。

有没有办法防止这种情况发生？

谢谢。

PS我试过了，但仍然不确定我是否解释得很好。如果您没有得到任何东西，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T15:14:54.070

您将永远无法获得 100% 的保护，不受您尝试的任何技术的影响。这是一场失败的比赛。

话虽如此，接近目标的一种方法是完全删除 onclick 属性，并通过 javascript 绑定您的点击处理程序（即“changeSomething”）：

html:

```
<input id="foo" type="button" /> 
```

js：

```
addEvent(document.getElementById("foo"), 'click', function() {
    /// some call back, which changes something
}) 
```

然后回调变得匿名（例如，不再有“changeSomething”函数）。这些邪恶的用户不知道它的名字是不能直接调用它的！

这种技术也有一些方法，但我们不会提及那些，以免我们给坏人提供想法:)

（顺便说一句，addEvent 只是一个用于添加事件处理程序的示例库函数。我相信你可以访问一个。如果没有[，你可以去](http://ejohn.org/projects/flexible-javascript-events/)。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T15:05:57.553

我认为您对此无能为力。客户端可以在自己的浏览器中运行任何他们想要的东西。唯一要做的就是验证服务器端的所有内容。这是所有 Web 编程中的一个重要概念。客户端代码可以自由修改，应该被视为一种额外的检查以加快速度，而不是一种安全方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:12:55.703

您必须在接受请求的任何后端处理此问题。假设您仅`doSomething()`在某些条件下为用户提供选项，您可能在数据库（或其他任何内容）中有此信息。

不要担心 JavaScript 会被调用（无法绕过它），并在后端执行与前端相同的检查。通过这种方式，您可以简单地忘记保护您的前端，因为无论如何您都做不到......但是您仍然可以防止恶意用户`doSomething`在不应该这样做时进行攻击。

如果您需要进一步澄清我的意思，请告诉我，但我需要更多关于您的应用架构的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T15:47:23.960

任何“解决方案”都将与禁用网页中的右键单击一样有效......对于后一个问题，我发现至少有十几个解决方法，包括在 Opera 中查看页面！

如果您禁用此功能，则可以使用 Firebug、Greasemonkey 甚至是一些动态修改 HTML 的代理来解决，更不用说使用页面的本地副本等了。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-08T15:01:59.633

您可以通过传递 ID 来检查点击的来源：

```
<input id="good' type="button" onclick="changeSomething(this.id)"/>

 function changeSomething(myId) {
   if(myId!='good') {
    return;
  }

 //......code
} 
```

修改为：

```
<input id="good' type="button" onclick="changeSomething(this)"/>

     function changeSomething(myId) {
       if(myId.id!='good') {
        return;
      }

     //......code
    } 
```

# tortoisesvn - 将分支与主干合并

> ID：424525
> 
> 赞同：120
> 
> 时间：2009-01-08T14:56:17.447
> 
> 标签：tortoisesvn, branch, trunk

使用 TortoiseSVN，我需要在分支中进行更改，然后将它们与主干合并。

我是这个项目的唯一开发者，所以我知道主干没有改变。我正在学习 SVN，以便最终我的团队可以使用它。

基本上，我希望我的树干看起来和树枝一模一样。

在 pre-svn 世界中，我只需复制分支文件夹中的文件，删除主干文件夹中的文件，然后将分支复制到主干。

在 TortoiseSVN 中，我尝试过`Reintegrate a branch`,`Merge a range of revisions`和`Merge two different trees`. 似乎什么都没有真正改变主干。我也试过在树干上分支。这给了我一个错误，说主干已经存在。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-01-08T15:20:31.143

在你的情况下：

1.  将工作副本切换到主干（SVN 切换）
2.  将分支合并到工作副本中（SVN Merge）
3.  确保一切仍然可以编译和工作
4.  提交工作副本（主干）
5.  考虑杀死分支

在**团队环境中**，我建议您首先在分支中合并来自主干的最新修改，确保一切都编译并正常工作，然后执行上述步骤（这将是微不足道的，因为您已经测试了更改）。

* * *

**更新**

在第 5 步中，我提到了杀死分支。这是因为一旦功能的分支位于主干中，它就应该被视为主干的一部分。在这种情况下，应该杀死分支，以便没有人继续处理它。如果该功能需要进行重大修改，您应该为此创建一个新分支。

我不会杀死的唯一分支是维护和发布分支，除非不再支持特定版本。

无论如何，您始终可以访问每个修订版，因此终止分支仅用于防止其他开发人员在死分支上进行开发。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-05-20T18:16:58.257

我认为在 TortoiseSVN 1.8.5 中，合并 | 合并两棵不同的树应该可以工作。当您将分支/标签合并回主干时，诀窍是 From URL 是主干，而 To 是标签/分支。奇怪但真实。

来源：[合并](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html)

对于不在工作副本中但在标签/分支中的目录，您可能会遇到冲突错误。只需接受冲突并重做合并。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-08T15:04:22.580

首先将您的工作副本切换到主干。然后做一个合并范围的修订，从分支到主干。此对话框完成后，差异将是您的主干工作副本中的待定更改。您需要提交它们，就像您在工作副本上手动进行更改一样。

在我的使用中，更典型的做法是在构建时保持主干运行并分拆分支。因此，我需要做的唯一合并就是从主干中修复错误并将其放在最新的构建分支上并重新发布该分支。对我来说最简单的方法是，因为你发现合并充其量是笨拙的。是保持最新的分支和主干检出到我的机器，并将文件从主干复制到分支并签入。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-11-13T12:26:54.937

我正在使用 TortoiseSVN 1.9.3，内部版本 27038。

按照以下步骤将分支合并到主干。

1）右键单击主干工作副本并选择以​​下选项。

[![在此处输入图像描述](https://i.stack.imgur.com/msZUx.png)](https://i.stack.imgur.com/msZUx.png)

2）在分支合并到主干的情况下，选择第二个选项，如下所示，然后单击下一步

[![在此处输入图像描述](https://i.stack.imgur.com/u4bTY.png)](https://i.stack.imgur.com/u4bTY.png)

3) 在 From: 字段中输入主干的完整文件夹 URL。这听起来可能不对，但请记住，主干是您要添加分支更改的起点。在 To: 字段中输入功能分支的完整文件夹 URL。

[![在此处输入图像描述](https://i.stack.imgur.com/AQMMN.png)](https://i.stack.imgur.com/AQMMN.png)

4）单击下一步并进行测试合并

[![在此处输入图像描述](https://i.stack.imgur.com/a9muh.png)](https://i.stack.imgur.com/a9muh.png)

5) 如果测试合并成功，则单击合并按钮。

6）一旦合并成功，然后在主干上提交更改。

# testing - CruiseControl（原始）和 CruiseControl.NET 之间的差异

> ID：424527
> 
> 赞同：6
> 
> 时间：2009-01-08T14:57:26.947
> 
> 标签：testing, continuous-integration, cruisecontrol.net, cruisecontrol

原始 CruiseControl 和 .NET 端口之间有什么区别吗？我已经比较了这 2 个，但除了开发它的语言之外找不到任何大的差异。我想使用其中任何一个来（自动）测试 Web 应用程序，使用 Selenium 和 Subversion，甚至可能是 Groovy，但是不知道该选哪个。

[编辑] 在看了 CC 和 Hudson 之后，我选择了 Hudson，因为它很简单，它已经有插件来运行 Groovy 脚本和 Selenium

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T16:12:02.130

选择我，选择我！（我在原来的 CruiseControl 上工作。）

我从未使用过 CC.NET，但据我所知，我同意它们具有可比性。可能最重要的区别是跨平台与仅 Windows。

现在我想知道多久有人过来说他们的废话，你应该试试[哈德森](http://hudson-ci.org/)？;)

（当然还有[很多其他的选择](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T05:16:35.783

CruiseControl.NET（此后的 cc.net）具有构建队列（[http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block](http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block)），它允许您序列化依赖于特定构建顺序的构建。我正在 java 版本的 Cruisecontrol 中模拟这种行为，但功能并没有一对一地映射。然而，我完全从 .net 迁移到 java 版本的原因是 .net 版本的核心转储为 mono（截至两个月前，cc.net nightly build 和 mono nightly build）。错误在于单声道线程处理，但没有尝试让 cc.net 启动和运行。

如果您没有注意到配置示例/文档所遵循的版本号（confluence.public.thoughtworks.org 有更新的配置文档，而 ccnet.sourceforge.net 没有。我知道 ccnet 很可能是一个死站，但是如果您没有仔细阅读您正在访问的每个页面上的日期戳，这可能会咬到您）。

此外，cc.net 中用于 cvs 和 svn 的源代码控制块比它们在 java 版本中的对应部分更加精细和功能丰富，但这在我的工作中不是问题。java 版本也很容易扩展/修改 re: 插件的行为，但你真的很想看到这种工作在上游而不是分叉。

我对 java 版本和 .net 中的分支（模单运行时行为）印象深刻，但您真的不想尝试任何其他的 Cruisecontrol 分支。我在哈德逊有过外围体验，但这些功能不足以让我从巡航控制中转向。[Hudson 在http://hudson.gotdns.com/wiki/display/HUDSON/Home](http://hudson.gotdns.com/wiki/display/HUDSON/Home)上有一张 Hudson 和 CruiseControl (java) 的比较图（有点颜色）

一个可行的替代方案是 python 实现的 buildbot ( [http://buildbot.net/trac](http://buildbot.net/trac) )。它没有花哨的 gui 仪表板，而且设置更受命令行限制，但如果您正在执行分布式构建，则设置和运行非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:11:37.150

我想对你来说这将归结为操作系统，原始版本可以在 nix 上运行，.net 版本在 windows 上运行。

还有其他自动构建实用程序也可以执行此操作，例如 windows 空间中的 TeamCity 和 ruby​​ 世界中的 Cruisecontrol.rb。

还有一个名为 pSake 的基于 PowerShell 的构建实用程序，可以轮询颠覆和执行任务。

# vb.net - SqlClient 调用导致“线程在 SNINativeMethodWrapper.SNIPacketGetConnection（IntPtr 数据包）处被中止”

> ID：424531
> 
> 赞同：6
> 
> 时间：2009-01-08T14:57:45.993
> 
> 标签：vb.net, ado.net, iis-6, thread-abort

我真的很感激任何建议，无论多么简单或复杂，以帮助我隔离和解决这个问题。

我有一些生成小报告文件的代码。对于集合中的每个文件，执行存储过程以通过 XML 阅读器获取数据（它是一个非常大的结果集）。当我创造了这一切并逐步完成它时，一切都很好。文件生成，没有错误。

该库通过远程调用，并通过 IIS 托管。当我部署编译库并调用它时，它能够生成一些报告，但随后会引发线程中止异常。如果我将调试器附加到 asp 工作进程，并逐步执行代码，我就没有问题。

看到这个失败是相当一致的，我寻找相似之处，发现失败发生在不同的报告上，但似乎发生在大约相同的时间点。

这让我认为这是调试器覆盖的超时设置，我对整个过程进行了一些粗略的计时（不是单个失败的代码），它似乎在大约 200 秒后就失败了。web.config executionTimeout 设置为 600 分钟（足够高）。此服务器应用程序的其他部分需要 COM+ 事务（2 分钟超时），但这不是其中之一。我不知道它可能会达到什么超时（大约 200 秒大关）。

SQL 连接超时默认保留（连接打开成功），命令超时为 300 秒（执行命令仅需 12-15 秒）。

*   还有其他我可能会错过的超时吗？

我运行了 SQL 探查器，它显示正确返回了结果（所有语句和 RPC 都已完成 - 没有错误）。通过 SSMS 执行代码提供了完美的结果。

使用反射器，我深入研究了 SNINativeMethodWrapper，它是非托管代码的包装器，但我看不出它实际上在做什么。我只能假设（可能是错误的）代码已经从 SQL 服务器接收到 TDS，并且包装器正在尝试获取与数据包关联的连接，但它不能。

*   有谁知道这个包装器应该做什么？
*   有没有办法跟踪/调试此代码以找出导致失败的原因？

我尝试使用不同的方法（ExecScalar、DataAdapter），但它们都在内部使用 ExecuteReader。

我尝试禁用连接池并强制客户端使用与服务器相同的数据包大小。

*   是否有人对导致此问题的原因有任何想法，或者我可以做些什么来隔离并尝试纠正问题？

## 这是生成异常的调用代码。

```
Private Function GetDataAsXmlDoc(ByVal cmd As SqlClient.SqlCommand) As XmlDocument

    Dim _xmlDoc As XmlDocument

    Using _connection As New SqlClient.SqlConnection(GetConnectionString())

        Logging.DebugEvent.Raise(Me.GetType.Namespace, Reflection.MethodBase.GetCurrentMethod().Name, _
                                 "No cached data found or used. Getting data for report from the database using SQL connection.")

        Dim _xmlReader As XmlReader
        'DataAdapter,ExecuteScalar, ExecuteXmlReader all use ExecuteReader internally and suffer the same problem.'
        'If you dont believe me, reflect it or look at one of the blowed up stack traces. '

        '_connection.ConnectionString += ";Pooling=false;"' 'This has no effect on the ThreadAbort.'
        cmd.Connection = _connection
        cmd.CommandTimeout = 300
        _connection.Open()

        Logging.DebugEvent.Log(String.Format("Connection opened, using packet size of {0}.", _connection.PacketSize))

        _xmlReader = cmd.ExecuteXmlReader() 'Thread aborts in here'

        Logging.DebugEvent.Raise(Me.GetType.Namespace, Reflection.MethodBase.GetCurrentMethod().Name, _
                                 "Report data recieved from database")

        _xmlDoc = New XmlDocument()
        _xmlDoc.Load(_xmlReader)

        _xmlReader.Close()

    End Using

  Return _xmlDoc

End Function 
```

## 堆

```
Exception String - System.Threading.ThreadAbortException: Thread was being aborted.
   at SNINativeMethodWrapper.SNIPacketGetConnection(IntPtr packet)
   at System.Data.SqlClient.TdsParserStateObject.ProcessSniPacket(IntPtr packet, UInt32 error)
   at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParserStateObject.ReadNetworkPacket()
   at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
   at System.Data.SqlClient.TdsParserStateObject.ReadByte()
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteXmlReader()... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T14:26:19.290

我相信我已经解决了这个问题。上面示例中的违规代码行是语句...

```
 Logging.DebugEvent.Raise(Me.GetType.Namespace, Reflection.MethodBase.GetCurrentMethod().Name, _
                                 "Report data recieved from database") 
```

这是对应用程序块（MS 企业库）的调用，用于将事件记录到平面文件（在这种情况下）或事件日志。

This one, in between the ExecuteXMLReader() and the actual usage of the reader in the XML document, was sometimes failing harshly, causing the whole thread to abort. I moved the line to after the `_xmlReader.Close()` and it took care of the problem.

# sharepoint - Excel 服务中的受保护工作表

> ID：424534
> 
> 赞同：0
> 
> 时间：2009-01-08T14:58:46.710
> 
> 标签：sharepoint

Sharepoint Excel Services 似乎不支持受保护的表格。有没有其他方法可以使某些工作表只读并使其在 Excel Services 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-11T13:46:06.707

在另一张表中公开您需要的值作为参考。发布另一张表来代替受保护的表。

# sql-server - 何时应在 SQL Server 2005 中启用 RowGuid 列属性？

> ID：424544
> 
> 赞同：6
> 
> 时间：2009-01-08T15:03:45.670
> 
> 标签：sql-server

MSDN 文档状态：指示 SQL Server 是否将该列用作 ROWGUID。您可以仅为唯一标识列将此值设置为 Yes。

这并没有告诉我为什么要启用或禁用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T15:15:45.940

将列设置为 ROWGUID 会告诉 SQL Server 该行将用作 GUID。默认情况下，SQL Server 会将行的默认值设置为 NewID()，这将生成一个 GUID。

因此，当您想要使用全局唯一的 GUID 时，您可以使用它。这使得它们对于复制和合并数据库很有用，因为您知道没有两行（理论上）将具有相同的 id。

# sql-server-2005 - 将 SQL Server 列强制为特定值

> ID：424545
> 
> 赞同：2
> 
> 时间：2009-01-08T15:03:50.753
> 
> 标签：sql-server-2005

是否可以将 SQL Server 2005 表中的列强制为某个值，而不管插入或更新语句中使用的值是什么？基本上，我无权访问的应用程序中存在一个错误，它试图将 1/1/0001 的日期插入到日期时间列中。这会产生 SqlDateTime 溢出异常。由于此列甚至不用于任何内容，我想以某种方式更新列或数据库中的某些内容的约束以避免错误。这显然只是避免问题的临时紧急补丁......欢迎提出想法......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T15:06:36.367

值是如何插入的？如果是通过存储过程...您可以修改 Sproc 以忽略该输入参数。

如果它是通过客户端生成的 SQL 或 ORM 工具，otoh，然后是 afaik，唯一的选择是“之前”触发器，它将值“替换”为可接受的值......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T15:15:24.803

如果您使用的是 SQL 2005，您可以创建一个 INSTEAD OF 触发器。此触发器中的代码将代替原始插入/更新运行

-Edoode

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T15:10:38.010

我会创建一个[触发器](http://zulfiqar.typepad.com/zulfiqars_web/2005/05/tsql_instead_of.html)来检查和更改值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:21:40.017

如果它是第三方应用程序，那么我将假设您无权访问存储过程，或用于生成和插入该值的逻辑（但仍然值得检查应用程序数据库的 SP，看看您是否可以修改它们）。

正如查尔斯建议的那样，如果您*无权*访问源，那么您需要在插入时触发。

[此处](http://msdn.microsoft.com/en-us/library/aa258254(SQL.80).aspx)的 Microsoft 文章将为您提供有关创建触发器的一些深入信息。

但是，SQL Server 没有真正的“插入前”触发器（据我所知），因此您需要尝试 INSTEAD OF。在[这里](http://www.microsoft.com/technet/prodtechnol/sql/2000/reskit/part10/c3761.mspx?mfr=true)查看更多信息。在该文章中，请特别注意第 37.7 节和以下示例（再次来自该文章）：

```
CREATE TRIGGER T_InsertInventory ON CurrentInventory
INSTEAD OF INSERT AS
BEGIN
INSERT INTO Inventory (PartNumber, Description, QtyOnOrder, QtyInStock)
SELECT PartNumber, Description, QtyOnOrder, QtyInStock
FROM inserted
END 
```

缺口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:07:16.847

最简单的技巧是将其设为 varchar，然后将其作为字符串插入列中。

更复杂的答案是，您可以使用触发器来处理数据，但首先它仍然必须是有效的。例如，我可以在更新/插入触发器中重置字段值，但它仍然必须先通过插入。

# c++ - C/C++ 运行时库和 C/C++ 标准库的区别

> ID：424549
> 
> 赞同：55
> 
> 时间：2009-01-08T15:05:17.273
> 
> 标签：c++, c

大佬能说说他们的区别吗？

顺便问一下，有什么叫做 C++ 库或 C 库的东西吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-08T15:27:20.083

`C++ Standard Library`和`C Standard Library`是 C++ 和 C 标准定义的库，提供给 C++ 和 C 程序使用。这是这些词的共同含义，我从未见过它的另一个定义，而 C++ 本身将其定义为：

> *C++ 标准库*提供了一个可扩展的框架，并包含以下组件：语言支持、诊断、通用实用程序、字符串、语言环境、容器、迭代器、算法、数字和输入/输出。C++ 语言的某些部分需要语言支持组件，例如内存分配（5.3.4、5.3.5）和异常处理（第 15 条）。

`C++ Runtime Library`并且`C Runtime Library`没有那么平等地使用。有人说运行时库是程序在*运行时*使用的部分（例如，实现`std::type_info`的代码或支持信号处理程序的代码），而不是它们仅在编译时使用的东西（例如宏定义）。其他人说运行时库是在加载时动态链接到程序的库，而不是在编译时静态链接，尽管这种使用很少。共享库或动态链接库是更好的术语。

`C++ Library`并且`C Library`是非常广泛的术语。它们只是意味着库是用 C++ 和/或 C 编写的。

以上不仅限于 C++ 和/或 C。有 python 库，也有一个 python[标准库](http://docs.python.org/library/)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-09-21T17:17:20.900

根据[https://en.wikibooks.org/wiki/C_Programming/Standard_libraries#Common_support_libraries](https://en.wikibooks.org/wiki/C_Programming/Standard_libraries#Common_support_libraries)，标准库和运行时库之间有一个非常重要的区别。虽然标准库定义了（总是）可供程序员使用的函数（但不是编程语言的（初始）规范的一部分，至少在 C 中），但运行时库包含实际运行程序所必需的函数给定的平台（并且是特定于平台/特定于供应商的）。

例如，printf() 是 C 标准库的一部分，而程序启动（在许多情况下对程序员来说是不可见的）是在运行时库中实现的。例如，您可以编写一个不使用标准库的 C 程序，但您总是需要运行时库，否则您的程序将无法执行。但老实说，这没什么用，因为没有标准库的 C 程序无法进行输入/输出，因此它无法告诉您有关其令人印象深刻的结果的一些信息。

导致混淆这两者之间差异的原因是：

1.  在每种情况下，都需要/使用运行时库，并且在（几乎）所有情况下，都使用标准库。此外，标准库可能依赖于运行时库，并且很可能是由同一供应商开发的。因此，这种区别并不明确，在大多数情况下也没有必要。
2.  Microsoft 将 C 标准库和 C 运行时库放在一起，并称之为 C 运行时库。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-08T15:10:50.007

C++ 标准库是一个术语，用于定义符合最低要求的编译器/工具集应具有的标准库。C++ 运行时库是工具集附带的库，用于提供标准库功能，并且可能是编译器可能需要的一些内部东西。事实上，这些术语通常可以互换。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-06-30T11:57:57.217

## 介绍

**C/C++ 标准库**是实现 ISO C/C++ 标准所需的所有必需功能集的任何实现。（[C++ 标准库](https://en.wikipedia.org/wiki/C%2B%2B_Standard_Library)的维基百科定义）

**运行时库**是一组功能的任何实现，这些功能通常以 SDK 的形式提供，需要安装或静态链接才能让使用该 SDK 的程序运行具有使用该 SDK 所需的一切。由于这些原因，运行时库通常与使用的 SDK 和使用的编译器版本严格相关。（通用[运行时库](https://en.wikipedia.org/wiki/Runtime_library)的维基百科定义）

## **C/C++ 运行时库**

因此，AC/C++ 运行时库必须包含执行标准库所需的所有功能（可以排除特定标准库实现的仅标头功能，因为它们在程序本身内解决）加上一组提供的功能由特定实现的 SDK 提供（同样可以排除仅作为标头提供的功能）。

## 微软案例

**在 MSVC140 之前：**最近的 Microsoft VC++ 运行时曾经有一个 C/C++ 运行时 (VCRedist) 的可安装版本，该版本对于所有操作系统都是相同的。

**从 MSVC140 开始：**从下一个 MSVC140 编译器开始，运行时库已拆分为两部分：

*   UCRT（通用 C 运行时）：随操作系统提供并与之相关，通过更新或操作系统映像分发
*   VCRedist：预计会随着所使用的编译器而改变的部分，并且在不同的操作系统版本中很常见（像 MSVC140 之前一样管理）。

这是[MS C 运行时参考文档的链接](https://docs.microsoft.com/en-us/cpp/c-runtime-library/c-run-time-library-reference)。这是[MS C 运行时下载页面和安装说明的链接](https://support.microsoft.com/en-us/kb/2977003)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-19T17:54:30.843

C++ 标准库由两个主要部分组成，即标准模板库（STL）和运行时库。STL 仅在头文件中实现，而运行时库的实现包含头文件和二进制文件（即 Windows 平台上的 .lib 和 .dll 文件）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-28T02:16:51.617

另一方面，可能不完全是 C/C++ 的情况，但根据维基百科：[运行时库](https://en.wikipedia.org/wiki/Runtime_library)

> 在计算机编程中，运行时库 (RTL) 是编译器使用的一组低级例程，通过将对运行时库的调用插入到已编译的可执行二进制文件中来调用运行时环境的某些行为。

简而言之：
**运行时库是供编译器使用的，标准库是供程序员使用的。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T15:18:35.373

C++ 运行时库包含 C++ 提供的函数和对象，例如 cout、fstream 等。

C 运行时库包含诸如 printf、scanf、fopen 等 C 函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-02T04:38:20.143

标准库是 C++ 标准文档中定义的一组特定的已定义名称和标头，运行时库是一组二进制文件，用作已编译程序的一部分，但不包含在程序可执行文件中，因为它是如此普遍需要。

相反，这些功能包含在主机上（尽管您可能需要让您的客户安装更新的运行时，如果他们有旧的服务包），因此它们仅在“运行时”包含在您的程序中。

参考。链接：

[http://msdn2.microsoft.com/en-us/library/cscc687y(VS.80).aspx](http://msdn2.microsoft.com/en-us/library/cscc687y(VS.80).aspx)

[http://msdn2.microsoft.com/en-us/library/59ey50w6(VS.80).aspx](http://msdn2.microsoft.com/en-us/library/59ey50w6(VS.80).aspx)

# javascript - 在 Javascript 中将字母转换为等效的希腊语

> ID：424560
> 
> 赞同：0
> 
> 时间：2009-01-08T15:07:41.387
> 
> 标签：javascript, character-encoding

我有一些来自 Web 服务的 JSON 数据，它为我提供如下数据

```
blah blah <greek>a</greek> 
```

我需要能够使用 javascript 将希腊标签内的内容转换为等效的符号。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:11:52.880

没有明显的通用方法可以做到这一点，因为没有明显的关系。另一方面，有一组有限的希腊字符。通过扩展，这意味着有一组有限的映射。找到您的 JSON 提供程序为每个希腊字符发送的 ASCII 字符应该很简单。每个标签的前/后缀。然后，这是一个简单的搜索和替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:38:26.457

这不是一个完整的解决方案，但我认为这是基本思想......

```
// The difference between standard ascii and greek
var diff = 913-65;
var originalString = "A";
var charCode = x.charCodeAt(0)+diff;
var output = String.fromCharCode(charCode); 
```

有趣的问题，希望这会有所帮助。

[希腊代码](http://ancienthistory.about.com/od/greeklanguage/a/ASCIIGreek.htm)

[ASCII码](http://www.web-source.net/symbols.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:48:11.413

如果这是偶尔的希腊字母而不是希腊文本，那么 W3C 可以使用以下代码（[http://www.w3.org/TR/html4/sgml/entities.html#h-24.3](http://www.w3.org/TR/html4/sgml/entities.html#h-24.3)）

```
function greekSymbol(str) {
  if(str.length == 0) {
    return "";
  } 

  return String.fromCharCode(str.charCodeAt(0) + (913 - 65)) + greekSymbol(str.substring(1)); 
} 
```

# java - 如何获取 Java.exe/jvm.dll 的符号文件以分析崩溃核心转储文件？

> ID：424561
> 
> 赞同：5
> 
> 时间：2009-01-08T15:09:01.400
> 
> 标签：java, websphere, coredump

我有一个在 Websphere 应用服务器上运行的 Java 应用程序。当我分析系统崩溃核心转储文件时，我得到如下信息：

```
ERROR: Symbol file could not be found.  Defaulted to export symbols for J9THR23.dll 
```

如何获取 Java 的符号文件？

提前致谢。

更多细节在这里：

```
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** ERROR: Symbol file could not be found.  Defaulted to export symbols for J9THR23.dll - 
*************************************************************************
***                                                                   ***
***                                                                   ***
***    Your debugger is not using the correct symbols                 ***
***                                                                   ***
***    In order for this command to work properly, your symbol path   ***
***    must point to .pdb files that have full type information.      ***
***                                                                   ***
***    Certain .pdb files (such as the public OS symbols) do not      ***
***    contain the required information.  Contact the group that      ***
***    provided you with these symbols if you need this command to    ***
***    work.                                                          ***
***                                                                   ***
***    Type referenced: ntdll!_PEB                                    ***
***                                                                   ***
*************************************************************************
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for j9jit23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for java.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for j9gc23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for jvm.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for jclscar_23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for j9ute23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for J9PRT23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for j9vm23.dll - 
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for DBGHELP.DLL - 
```

爱丽丝·龚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T10:14:16.457

您可以在此站点上获得 JDK 的调试版本。

http://download.java.net/jdk6/

查找 jdk-6u12-ea-bin-b03-windows-i586-debug-22 *dec* 2008.jar，91.47 MB

它包括 .pdb 文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T16:56:59.840

看起来调试器正在寻找 PDB 文件，据我所知，Java 应用程序的调试信息不​​是 PDB 文件。PDB 文件是由 VisualStudio 在创建 Windows 本机应用程序时生成的，因此调试器似乎正在寻找应用程序服务器的调试符号。不知道 WebSphere 是否带有自己的调试版本。另一方面，如果您想要调试 Java 应用程序的符号，您只需要使用该`-g`选项重新编译它。

# wpf - 如何根据源数据用另一个控件替换 WPF 网格中的图像？

> ID：424562
> 
> 赞同：1
> 
> 时间：2009-01-08T15:09:09.247
> 
> 标签：wpf, data-binding, datatrigger

我有一个像这样布置的网格；

```
+---------+---------+
|  Image  | Details |
|    is   |  pane   |
|  here   | for data|
|         |  entry  |
+---------+---------+
| ListView here to  |
| select data item  |
| for top two panes |
+---------+---------+ 
```

这一切都很好，但是当列表视图中的选定项目没有图像时，我现在想将图像更改为另一组控件说“抱歉，没有可用的图像”

我尝试将图像包装在 DockPanel 中并在那里设置 DataTemplate（这样我就可以使用 DataTriggers），但 IntelliSense 说不！

ListView 使用 DataTriggers 来做类似的事情，但正如我所说，对于似乎无法访问 DataTemplate 的单个图像，我无法理解如何做到这一点。

简化的 XAML 如下；

```
<Grid DataContext="{Binding Source={StaticResource MyData}}">
   <!-- row 0 col 0 -->
   <Image x:Name="imgPhoto" Source="{Binding ElementName=MyListViewOfData, Path=SelectedItem.PathToImageOnDisk}" />

   <!-- row 0 col 1 -->
   <StackPanel DataContext="{Binding ElementName=MyListViewOfData, Path=SelectedItem}">
      <TextBox Name="NameTextBox" Text="{Binding Name}" />
      <TextBlock Name="DateCreatedTextBlock" Text="{Binding DateCreated}" />
   </StackPanel>

   <!-- row 1 cols 0,1 -->
   <ListView ItemsSource="{Binding}" ItemTemplate="{StaticResource MyListViewTemplate}" 
IsSynchronizedWithCurrentItem="True" Name="MyListViewOfData" />

</Grid> 
```

在此先感谢 WPF 大师。

瑞安

更新：下面的两个答案（Abe 和 Jobi）都是正确的，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T17:50:41.417

为了使用 DataTemplate，您必须拥有一个使用模板呈现对象的控件。如果您使用 ContentPresenter，您可以将其 ContentTemplate 设置为您喜欢的任何数据模板。

这是我将如何做到这一点：

```
<Grid DataContext="...">
    <ContentPresenter Content="{Binding SelectedItem, ElementName=MyListViewOfData}">
        <ContentPresenter.ContentTemplate>
            <DataTemplate>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />      
                    </Grid.ColumnDefinitions>
                    <Image x:Name="imgPhoto" Source="{Binding PathToImageOnDisk}" />
                    <TextBlock x:Name="error" Visibility="Collapsed" Text="Sorry, no image available" />
                    <StackPanel Grid.Column="1">
                        <TextBox Name="NameTextBox" Text="{Binding Name}" />
                        <TextBlock Name="DateCreatedTextBlock" Text="{Binding DateCreated}" />
                    </StackPanel>
                </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding PathToImageOnDisk}" Value="{x:Null}">
                    <Setter TargetName="imgPhoto" Property="Visibility" Value="Collapsed" />
                    <Setter TargetName="error" Property="Visibility" Value="Visible" />
                </DataTrigger>
            </DataTemplate.Triggers>
            </DataTemplate>
        </ContentPresenter.ContentTemplate>
    </ContentPresenter>
    <ListView ItemsSource="{Binding}" ItemTemplate="{StaticResource MyListViewTemplate}" IsSynchronizedWithCurrentItem="True" Name="MyListViewOfData" />

</Grid> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:59:31.163

如果您不关心在 WPF 视觉树中创建的视觉效果，您可以在这里做一个简单的技巧。只需将图像控件放在“不可用”控件的顶部，以便在图像加载失败的任何时候，您都可以看到以下消息。如果图像控制成功，则图像会覆盖“不可用”消息。

# sql - sql 查询 - 在 12 小时内选择重复项

> ID：424564
> 
> 赞同：2
> 
> 时间：2009-01-08T15:10:03.503
> 
> 标签：sql, oracle

如果我有如下数据

一个 | 01/01/2008 00:00:00

乙| 01/01/2008 01:00:00

一个 | 2008 年 1 月 1 日 11:59:00

C | 02/01/2008 00:00:00

D | 02/01/2008 01:00:00

D | 2008 年 2 月 1 日 20:00:00

我只想选择其标识符（A、B、C 或 D）在 12 小时内出现两次的记录。在上面的这个例子中，这只会是“A”

任何人都可以帮忙（这是一个Oracle数据库）

谢谢

米

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-08T15:14:37.910

```
 Select Distinct A.Identifer  
  From Table A
    Join Table B --  EDIT to eliminate self Joins (to same row)
        On A.PrimKey <> B.PrimaryKey
           And A.Identifer = B.Identifer               
           -- EDIT to fix case where 2 at same time
           And A.OccurTime >=  B.OccurTime 
           And A.OccurTime < B.OccurTime + .5 
```

并实施评论中提出的问题，（忽略不同日期的记录）

-- 对于 SQL Server，

```
 Select Distinct A.Identifer  
    From Table A
      Join Table B 
        On A.PrimKey <> B.PrimaryKey
           And A.Identifer = B.Identifer
           -- EDIT to fix case where 2 at same time
           And A.OccurTime >= B.OccurTime  
           And A.OccurTime < B.OccurTime + .5
    Where DateDiff(day, A.OccurTime, B.OccurTime) = 0 
```

- 或者对于甲骨文...

```
 Select Distinct A.Identifer  
    From Table A
      Join Table B 
        On A.PrimKey <> B.PrimaryKey
           And A.Identifer = B.Identifer
           -- EDIT to fix case where 2 at same time
           And A.OccurTime >= B.OccurTime  
           And A.OccurTime < B.OccurTime + .5
 Where Trunc(A.OccurTime) = Trunc(B.OccurTime) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T15:43:42.047

```
Select    
  A.Id
From    
  YourTable A 
Where    
  A.YourDateTime Between :StartDateTime and :EndDateTime 
Group By    
  A.Id
Having    
  COUNT(A.Id) = 2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T19:23:38.250

我没有检查威廉的查询，但我会认真考虑使用他所拥有的一切。分析是炸弹。每当您发现自己将表连接回自身时，几乎可以保证有机会使用分析，并且每次都会使用一个表引用两次来执行查询。

您会**惊讶**于分析解决方案的速度有多快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:18:01.413

```
SELECT identifier
  FROM table_name outer
 WHERE EXISTS( SELECT 1
                 FROM table_name inner
                WHERE inner.identifier  = outer.identifier
                  AND inner.date_column BETWEEN outer.date_column AND outer.date_column + interval '12' hour
                  AND inner.rowid != outer.rowid ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T15:26:27.323

我不能 100% 确定您的要求，但是这可能会给您一些关于如何做您需要的想法的想法。例如，您说的正好是 2；如果有 3 次出现怎么办？等等

```
create table t (ident varchar2(16), occurance timestamp);

insert into t (ident, occurance) values ('a', to_date('20080101000000', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('b', to_date('20080101010000', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('a', to_date('20080101115900', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('c', to_date('20080102000000', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('d', to_date('20080102010000', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('d', to_date('20080102200000', 'yyyymmddhh24miss'));

insert into t (ident, occurance) values ('d', to_date('20080103020000', 'yyyymmddhh24miss'));

select ident, occurance
from
(
select ident, occurance,
    lag(occurance) over (partition by ident order by occurance) previous, 
    lead(occurance) over (partition by ident order by occurance) next 
from t
)
where 
    ((occurance-previous<interval'12:00' hour to minute and extract(day from occurance) = extract(day from previous))
    or (next-occurance<interval'12:00' hour to minute and extract(day from occurance) = extract(day from next)))
/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T15:17:57.310

```
SELECT namecol FROM tbl A
WHERE EXISTS (
  SELECT 1 from tbl B
  WHERE b.namecol = a.namecol
  AND b.timestamp > a.timestamp
  AND b.timestamp - 0.5 <= a.timestamp ) 
```

# compiler-construction - 程序员学习如何构建编译器是否有益？

> ID：424567
> 
> 赞同：23
> 
> 时间：2009-01-08T15:10:52.487
> 
> 标签：compiler-construction

当涉及到不同类型的程序员时，有很多变化。一般来说，学习如何构建编译器对程序员有益吗？在什么情况下需要或不需要编译器编程？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-08T15:17:57.933

编译器编程是一个有趣的话题，它有很大的价值。在我上的大学是一门选修课，语言设计和实现。我个人很感激能接受它。我们学习了实现词法分析器、解析器和字节码发射器的各种方法。

我看到的真正价值在于它照亮了我赖以启动和运行程序的黑匣子。它让我更好地了解编译器的工作原理，并帮助我更好地理解编译器错误。

将源代码编译为代码的过程实际上是大多数程序所做的一般方式，接受一些输入，执行一些过程，然后输出结果。编译器对如何最好地完成这一点有一些非常明确的想法。

我认为这对我来说是有益的，目前我从事基于 Java 的 Web 应用程序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-08T15:25:05.203

我正在阅读 The Dragon Book（编译器），在本书的开头，您会看到以下内容：

> 尽管很少有人可能为主要编程语言构建甚至维护编译器，但读者可以将本书中讨论的思想和技术用于一般软件设计，从而获得收益。例如，用于构建词法分析器的字符串匹配技术也已用于文本编辑器、信息检索系统和模式识别程序。上下文无关语法和语法导向定义已被用于构建许多小语言，例如产生本书的排版和图形绘制系统。代码优化技术已用于程序验证程序，以及从非结构化代码生成“结构化”程序的程序中。

简而言之，您将不仅仅是学习如何构建编译器。在此过程中，您将学习许多不同的低级技术，以帮助您进行日常编程。尽管有人说这是一本过时的书，但我仍然喜欢它并且我会推荐它，即使阅读可能会有点沉重。如果您确实得到它，请留出大量时间阅读并理解它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-08T15:26:57.697

我在大学学习了两门编译器课程，发现它们很有用，因为：

*   编写编译器需要了解许多计算机科学领域的知识——正则表达式、上下文无关语法、语法树、图形等。它可以帮助您了解如何将计算机科学理论应用于实际问题。
*   通过了解编译器如何生成和优化代码，您将浪费更少的时间自己进行愚蠢的“优化”。
*   扫描/词法分析文件并从中构建语法树的过程适用于更大的问题集，而不仅仅是构建编译器。
*   帮助“概括”编程语言——一旦你看到每种编程语言最终都成为机器代码，学习新语言就会变得更容易，因为你会发现每种语言只是表达相同基本思想的不同方式。

有些人会反驳说，你可以利用你的时间做更多有用的事情，比如学习一种流行的编程语言或可以帮助你找到工作的库（这个论点经常被用作不学习汇编语言的理由）。然而，了解编译器的工作方式可能会使学习新的编程语言变得更容易（参见第 4 点）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-08T15:17:19.963

虽然很少有程序员最终不得不实现编译器，但编译器构建的早期阶段，即词法分析和解析可能会更频繁地出现：谁不必为某些奇怪的文件格式编写解析器？通常，在没有编译器构建经验的情况下，它们很容易管理，但并非总是如此。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-08T15:29:44.977

我学到了很多。

[PUGS](http://www.pugscode.org/)的开发人员[Audrey Tang](http://en.wikipedia.org/wiki/Audrey_Tang)推荐使用[类型和编程语言](http://www.cis.upenn.edu/~bcpierce/tapl/index.html)。

就个人而言，我喜欢[从 NAND 到俄罗斯方块](https://www.nand2tetris.org/)——这可能是我上过的最好的课程，也是高等教育*应有*的光辉榜样。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-08T15:19:46.150

编译器编程是多方面的，因为它包括将代码解析为逻辑树，然后将代码转换为另一种形式的代码。并可能在输入树中分析输入以进行优化。

因此，总的来说，它将帮助每个程序员，因为您知道如何更快地解释语句，或者如何编写预编译器来为您选择的语言制作宏。甚至只是如何比您的同事更好地解析该平面文件。

对于大多数没有编译器的基于脚本的语言，您将无法通过学习如何制作编译器来优化您的日常工作流程。但是你仍然会理解解析。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-08T15:15:32.680

我认为，最好从知识的角度来学习。至少您可以查看现有的编译器源代码并了解编译的每个阶段所涉及的典型编译步骤和复杂性。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-08T15:17:45.860

我认为我在大学的编译器和语言理论课程确实对我对计算机语言的理解产生了巨大的影响，即使是在十年之后。但我不确定我是否需要为此实现一个编译器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-08T15:48:14.940

我对这些答案中的大部分都投了赞成票。

我认为编译器的工作为您提供了思考一般编程的重要方法。

每当您编写任何程序时，从某种意义上说，您就是在定义一种语言，而每个程序在某种程度上都是一个语言处理器。

它让你思考表示信息的最佳方式，并理解信息可以以多种不同的方式编码，而不仅仅是数据结构和许多类。

一旦您知道每个问题都有多个有效的解决方案，各有利弊，您通常可以选择比旧的以数据为中心的一刀切范例更好的解决方案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-08T15:21:30.813

理解编译过程是理解计算机如何工作的一般方法，因此提供了广泛的理解范围。许多现代程序员在几乎不需要这种理解的复杂环境中工作，至少在基本层面上是这样。一个例子是java，它对开发者隐藏了编译的链接步骤。

知识就是知识，它几乎总是有用的。就我而言，我发现在进行性能增强时理解编译过程非常有用，这是我的工作。（我在超低延迟环境中工作）

如果您在 PHP mySql 中完成所有工作，那就太好了。请记住，所有技术都会过时，您需要了解下一个伟大的事物。拥有像理解编译这样的“一般知识”可以在你和那些无法适应的笨蛋之间提供一个概念缓冲。

学习如何学习。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-08T15:26:24.127

这就像在问“程序员拥有更多的编程知识是否有益？”。很简单，是的，它是有益的。很难猜测它对日常非编译器构建的编程事务有多大好处。但它肯定会告诉你你正在做的事情的内部是如何工作的，如何操纵字符串来指示逻辑，并且无论你使用什么，它都可能帮助你更好地调试。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-08T15:32:32.630

我正在构建一个编译器作为一个项目的一部分，我必须说这是一项非常令人满意的任务，因为你会学到很多关于编程语言如何工作以及如何优化代码的知识。

了解代码如何在本机和字节码中编译和执行也是 C++ vs Java/C# vs C++/C# vs Java 线程和火焰战争的一个很好的工具；）

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-08T16:36:25.093

在某些方面，这个问题很像“我应该学习 C 吗？”

正如其他人所指出的，编译器的某些元素——词法分析、解析——可以用于许多其他应用程序。即使您不必实现编译器，您也会学到一些有用的技术。

此外，代码生成阶段将使您更好地了解计算机的工作原理。您将看到来自高级语言的算法和数据结构在到达 CPU（或虚拟机，视情况而定）时如何实际得到处理。这应该可以帮助您在日常编程中编写更好的算法。

如果您也在设计自己的语言，那么您将通过思考它应该如何工作的细节、您需要哪些控制流元素、应该如何解析表达式、应该是哪些顺序函数参数等细节来学习很多东西阅读等。这应该让您对一般语言有更好的理解，这应该使您成为无论您使用哪种语言的更好的程序员。

最后，您总有可能会发现自己被不再支持的旧语言的遗留应用程序困住了，而添加新功能的最简单方法是[构建您自己的编译器](http://www.onlamp.com/pub/a/onlamp/2004/04/15/parrot_compiler_construction.html)来扩展该语言。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-08T20:31:26.600

我最近对我们所谓的语言处理进行了一项独立研究（我的最终项目与其说是一个编译器，不如说是一个具有类似编译器功能的 c++ 文件解析器/解释器）。我被要求使用上面提到的“龙”书。我认为作为一名软件开发人员，这是我在大学生涯中所做的最重要的事情之一。我发现它不仅对我个人的利益很有趣和有益，而且还让我能够更深入地了解这门语言。最重要的是，因为 Dragon 的书不是特定语言的，它帮助我理解了相似之处，更重要的是理解了不同语言差异背后的原因。然而，我同意并非所有程序员都认为有必要的事实。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-08T15:14:40.640

我是一名网络开发人员；我大部分时间都花在 PHP 和 MySQL 上。我认为学习构建编译器对我没有多大好处。

不同类型的程序员将获得不同数量的收益。

有点不回答，我知道...

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-08T15:20:54.993

是的，这是个好主意。了解所有这些东西是如何工作的只会使程序员受益。我在 SX ASM 中编写了一个 BASIC 编译器，并从中学到了很多东西。

正如其他人提到的那样，程序员和知识有很多程度。主要从事标记和脚本语言的 Web 开发人员可能不会像编写嵌入式系统软件的核心 C 或 ASM 程序员那样从中受益——但这并不是说它不是有用的知识。

重新发明轮子对于教育价值总是有用的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-11-17T17:03:15.823

在当今的行业中，如果您会做一个编译器，那么您就像一个 3 岁的孩子那样正在学习如何计数（就我的智力上限而言，就该领域而言，我的智商约为 18 ); 它也同样重要：正如龙书所引用的，每个具有用户界面的应用程序都定义了一种编程语言。

此外，新的编程语言，例如[zonnon](http://www.zonnon.ethz.ch)和[composita](http://www.composita.net/Composita.html)，使用语法指导协议在活动对象之间进行通信。它们定义了将服务器线程接口指定为 EBNF 语法的协议类型。如果您还没有编写编译器，那么就无法编写消息处理程序！

语法定向协议是处理诸如使用基于文本的协议的 Web 服务器之类的事物的最佳方式；所以这很有可能成为选择的方法。然而，两种语言都将协议限制为 LL(1) 语法（原因很明显），这可能被证明过于严格。

虽然 zonnon 的当前实现仍然有点小问题；而且语言定义似乎也不完整；尽管如此，我还是会大胆冒险，zonnon（或类似的东西）将把 C# 放在它所属的垃圾箱里，如果他们能解决这些问题的话。

Composita 是一种有趣的语言。但在现实世界中，要求每个对象都成为活动线程并且每个函数调用都成为消息是非常不可取的，因为 composita 的设计者必须覆盖操作系统以使其运行得足够快。

话虽如此，我还是要重复一遍：如果编程服务器应用程序确实遵循 EBNF 协议类型，那么您最好学习如何编写编译器。

# c# - Winforms WPF 互操作性能

> ID：424573
> 
> 赞同：3
> 
> 时间：2009-01-08T15:13:48.923
> 
> 标签：c#, .net, wpf, winforms, interop

我的项目需要一个后台线程来启动在 Winform 中托管的 WPF 控件的创建。所述控件的创建必须在前台线程上执行，成本非常高，会导致 UI 挂起 1 到 2.5 秒（取决于是否是第一次创建控件）。

是否有任何可以从后台线程完成的预创建优化以减少 UI 线程完成的工作量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T15:32:34.113

我假设您使用 ElementHost 控件在 winforms 应用程序中托管 Wpf 控件？我认为您看到的开销确实是必要的，因为呈现 wpf 元素的设备上下文已编组到 winforms 应用程序，并且不在正常的 wpf 应用程序中。我的经验是，当你打开一个带有 ElementHost 的表单时，第二次会快得多，但当然这取决于你在打开它时在做什么。

# vb6 - 如何通过Vista中的安全问题？

> ID：424579
> 
> 赞同：0
> 
> 时间：2009-01-08T15:14:42.027
> 
> 标签：vb6, windows-vista

我有一个 vb6 应用程序。我无法在 Windows Vista 机器上执行以下操作：

1.  从*用户*目录注册一个 .DLL
2.  启动另一个 .EXE
3.  写入*用户*目录中的文件。

我该如何克服这些问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T15:22:53.883

1.  这是设计使然。软件应该需要管理员权限才能安装（包括更新/升级）。你在 XP 中侥幸逃脱，因为很多人以管理员身份运行。如果您在安装后注册 dll，那么您做错了什么。
2.  您应该能够毫无问题地执行此操作，但只能使用与当前应用程序正在运行的用户相同的权限。这个 exe 试图做什么，标准用户通常会拥有这些权限吗？
3.  用户目录中的具体文件夹是什么？再说一遍：用户应该对他们自己的大部分个人资料有写访问权，但不一定像你想象的那样多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:23:34.710

您有权写入 c:\users\ 目录。转到另一个用户目录是一个您不会解决的安全问题。

至于从用户目录注册程序集... c:\users\\AppData\Local\assembly 下有一个目录，您应该有权访问临时程序集

启动另一个 exe 是微不足道的......只要它安装在正常的 \program files.. 路径中。

听起来你可能需要重新评估你的应用程序是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T18:44:30.730

一些建议：

1.  转移到它可以处理事情的无注册 COM（即不适用于 ActiveX EXE、DCOM）。

2.  我们需要更多信息。除非存在权限问题，否则这应该没有问题。

3.  用户不应该在他们自己的配置文件、CommonAppData 和应用程序定义的位置（通常在非系统驱动器上）之外创建文件。需要更多信息才能给出任何真正有用的答案。

# .net - 你将如何创建一个安全的 int sum IList 扩展？

> ID：424586
> 
> 赞同：0
> 
> 时间：2009-01-08T15:15:59.530
> 
> 标签：.net

我想创建一个与普通 Sum 具有相同语法的安全求和扩展方法。

这将是我想使用的语法：

```
result = Allocations.SumIntSafe(all => all.Cost); 
```

我在我的操作中使用`Int.Maxvalue`作为惩罚值，两个`Int.MaxValue`相加返回 a `Int.Maxvalue`。

这是我的添加功能：

```
public static int PenaltySum(int a, int b)
{
    return (int.MaxValue - a < b) ? int.MaxValue : a + b;
} 
```

有任何想法吗 ？

**编辑：**

我想在具有要在不同属性中求和的值的对象的通用集合上使用此函数：

IE

```
all.SumInt32Safe(all => all.cost);

days.SumInt32Safe(day => day.penalty); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T15:19:22.440

已经有一种扩展方法可以帮助您：聚合

```
all.Aggregate(PenaltySum); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:20:04.763

最简单的做法：

```
public static int SumInt32Safe(this IList<int> source)
{
    long sum = source.Sum(x => (long) x);
    return (int) Math.Max(sum, (long) int.MaxValue);
} 
```

顺便说一句，PenaltySum 失败 IMO：PenaltySum(-1, 0) 返回 int.MaxValue。

编辑：随着要求的改变，你只想要：

```
public static int SumInt32Safe<T>(this IList<T> source, Func<T, int> selector)
{
    long sum = source.Sum(x => (long) selector(x));
    return (int) Math.Max(sum, (long) int.MaxValue);
} 
```

还是`source.Select(x => x.Cost).SumInt32Safe();`先打电话...

# web-services - 什么是通过查询组成组的宁静方法

> ID：424587
> 
> 赞同：9
> 
> 时间：2009-01-08T15:16:14.707
> 
> 标签：web-services, rest

考虑以下http请求：

```
GET /defects?group-by=priority 
```

我希望按优先级对返回的缺陷集合（提要）进行分组。即返回的提要由缺陷（资源）和组信息组成。

我想到了一些可以在返回集合之前返回组的标题和计数的方法，例如：

```
<content>
<Group val="High" count="567"/>
<Group val="Medium" count="437"/> 
<Group val="Low" count="19"/> 
<Defect ,,,,>
<Defect ,,,,>
<Defect ,,,,>
</content> 
```

这种表示的问题在于查询的资源 (URL) 是缺陷，因此客户端期望收集缺陷而不是 Group 元素。

我想解决这个问题的一个选择是为缺陷定义一个单独的组资源，即：

```
 defects/groups?group1=priority 
```

这将返回组的集合及其计数，然后客户端可以查询数据本身的缺陷资源。但是这种设计很麻烦，需要额外的往返，更不用说在对组资源的调用和缺陷资源之间添加\删除缺陷时可能出现的一致性问题。

底线，返回按属性分组的元素集合的宁静方式是什么？

**编辑**我首先想到这个问题应该由 ATOM 发布标准来解决。但是即使 ATOM 已经解决了这个问题，我仍然需要支持其他表示（XML、JSON），所以我正在寻找 RESTful 方法中更固有的模式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-09T15:24:49.877

我不认为你所要求的是可能的。

如果客户期望有一系列缺陷，那么您可以按优先级排序，但是

```
a group of defects != a defect 
```

所以你不能返回一组组。

您可以添加一个讨厌的 hack 来为缺陷资源添加优先级和优先级组大小的属性，但这对我来说似乎很糟糕。

我认为正确的 Restful 方法是：

*   设计服务以返回缺陷组

或者

*   按优先级排序返回缺陷，并让客户端对每个组中的资源进行分组和计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T11:26:59.357

根据对此[答案](https://stackoverflow.com/questions/424587/what-is-the-restful-approach-for-returning-a-group-by-query#428467)的评论，这似乎需要支持分页。在这种情况下，我建议您查看[AtomPub](http://bitworking.org/projects/atom/rfc5023.html "AtomPub，a/k/a Atom 发布协议 RFC")，特别是它如何[处理分页](http://bitworking.org/projects/atom/rfc5023.html#partial-lists "AtomPub 世界中的部分列表")。也许相同的通用方法对您有用；如果你真的很幸运，你可以利用整个标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-01T05:44:35.630

我设计了一个这样的网址：

`GET /grouped-posts/category`返回一个分组的帖子，如：

```
{
    "data": {
        "science": [{"title": "post 1"}, {"title": "post 2"}],
        "art": [{"title": "post 3"}, {"title": "post 4"}]
    }
} 
```

如果你想按*任何*对象分组，你可以返回一个列表而不是 map/dict：

```
{
    "data": [{
        "category": {"id": 9202, "name": "science"},
        "posts": [{"title": "post 1"}, {"title": "post 2"}]
    }, {
        "category": {"id": 3924, "name": "art"},
        "posts": [{"title": "post 3"}, {"title": "post 4"}]
    }]
} 
```

# asp.net - 您如何为 Web 项目构建 css 文件？

> ID：424588
> 
> 赞同：2
> 
> 时间：2009-01-08T15:16:29.077
> 
> 标签：asp.net, css

在我的项目中，我将所有的 CSS 类都放在了样式表中。

我遵循的结构是

有一个 global.css 文件，其中包含所有全局样式。然后为每个 .aspx 页面提供一个样式表，该样式表将专门用于该文件。

虽然我说的是 asp.net，但我想这对任何其他 Web 开发环境都没有任何影响。

这种构造css文件的方式可以吗？其他人如何安排他们的 css 文件，为什么？

谢谢。

*相关问题*

[组织 CSS 规则的最佳方式是什么](https://stackoverflow.com/questions/72911/whats-the-best-way-to-organize-css-rules)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T15:18:47.293

每个 .aspx 页面的 css 文件似乎违背了它的目的，即可重用性等。我想如果从样式的角度来看，每个页面真的那么独特，也许这是必要的，但我会努力摆脱这种格式。

我通常有一个主 css 文件，然后可能是我网站其他主要部分的附加文件（例如私人管理部分等）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T15:22:45.863

从纯文件结构中，我将为每个母版页创建 CSS 文件，因为每个母版页通常与网站的特定部分相关。有些甚至只有一个。

如果有非常特殊的需要，我只会添加额外的 CSS 文件。如果单个页面包含该页面所需的元素。我通常将它们添加到嵌入该页面的样式块中。避免需要额外的 HTTP 请求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T15:28:57.710

两件事情：

首先，您需要*一个*项目的 CSS 文件。CSS 的全部意义在于允许您在整个站点中创建 UI 标准化，并将这些 UI 规范与页面本身*分开。*例如，通过这种方式，您可以更改整个站点中“警告”（或其他）标签的字体。如果您正在考虑调整特定页面，您的第一个冲动应该是避免这种诱惑并坚持现有的样式（按 ID 或类）。如果您*必须*创建一个新样式，我仍然会将它放在通用 CSS 文件中 - 只需给它一个唯一的名称。很可能，您稍后会在另一个文件中找到它的用途。请注意，这不会影响性能；事实上，一个文件*改进了*性能，因为它只会下载一次然后缓存。每个页面的单独 CSS 文件将导致更多的下载和臃肿的配置文件。

其次，如果您在 ASP.NET 中工作，请花时间研究“主题”。例如，这将允许您为一个整体网站外观（例如“蓝色”主题）创建一个 CSS 类，然后将整个外观换成另一种（例如“绿色”主题）。它还使您能够以我认为您喜欢的方式组织您的 CSS 和它们所引用的图像（您可以提供多个备用 CSS 文件和图像目录来自定义您的站点的外观）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:24:37.030

对于每个布局，我使用一个 css 文件。

如果子页面有一些独特的布局或没有其他页面的子部分，我会检查 CSS 声明是否足够大以影响主 CSS 文件的大小。如果是这样，我将其分隔到另一个文件中，并仅将其包含在该页面上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T16:19:28.013

我会推荐一个用于屏幕的全局样式表和一个用于打印 css 的全局样式表——将它们分开总是一个好主意。它还取决于您的站点上是否使用了多种设计，即，如果您的站点有广泛不同的布局，那么每个设计的样式表都是合适的。一个例子是前端设计和管理区域的设计。我还建议查看使用母版页来简化构建。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-09T02:28:41.230

我想对[**Yahoo Exceptional Performance**网站](http://developer.yahoo.com/performance/)大喊一声，该网站包含一大堆关于前端工程问题的好建议，这些问题会对页面加载时间产生巨大影响。它讨论了诸如减少每个视图的 HTTP 请求、CSS 和 JavaScript 的有效加载、最大化可缓存性等问题。

严格来说，这不是您问题的答案，但是当您决定如何在新项目中处理 CSS 等时，请牢记这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T18:02:32.000

这实际上取决于项目的需求，以及您未来维护 CSS 的计划是什么。我在一个大型项目中工作，在该项目中我并不总是可以更改模板中的 HTML，因此我需要对 CSS 进行非常细粒度的控制。

我使用一个全局样式表和一个定义基本布局区域的模板级样式表 - 列、可重复使用的部分等。最后，我将应用一个仅适用于特定部分的页面特定表到那个页面。

这样做的主要好处是，由于一切都是向下级联的，我可以在全局和模板级别的工作表中定义我的大部分样式，但仍然能够在页面级别覆盖单个规则。本质上，我可以对我的 CSS 进行子类化，只更改我需要更改的部分。这样，我也不必处理大量独特的名称。两个页面可能都有一个`#left-column`区域，但实现方式不同。将其视为 CSS 多态性。

这种方法的缺点是它确实迫使我维护相当数量的样式表。但是通过适当的文档和命名约定，它运行得非常好。

通常，我发现如果所有 CSS 都存储在一个文件中（在一个大型项目中），它会膨胀并很快变得难以管理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-09T01:55:26.617

由于您在问题中提到了 ASP.NET，我会回应另一个用户的建议来查看主题。我的站点中的每个 ASP.NET 主题都有一组“.css”文件。我在功能上将我的 CSS 选择器划分为文件；例如，我为以下内容创建单独的 .css 文件：

*   顶级页面布局样式（几乎只在我的母版页中使用）
*   内置 HTML 元素的样式（p、a、h1-h6 等）
*   自定义块级样式（用于 div）
*   自定义内联样式（用于跨度）
*   表格样式

我还将为站点使用的每个第三方组件或控件创建一个单独的 .css 文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-09T02:24:44.250

这可能不是您问题的答案——但它是一篇涉及样式表组织的方便文章。特别是，它提到了一些针对不同平台的样式表。

一般来说，我有一个用于布局和设计的全局样式表，然后如果绝对需要，可以单独使用样式表。我想不出每页都需要一个 css 文件的用例。

[Progressive Enhancement With CSS - A List Apart](http://www.alistapart.com/articles/progressiveenhancementwithcss)
我鼓励所有 Web 开发人员阅读这篇文章。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-11T14:57:31.100

我们使用适用于整个网站的单个样式表和适用于某些页面的附加样式表。例如，在我们的一些页面上我们有网格，所以我们有一个 grids.css。有时不需要时将所有这些 css 添加到单个样式表中是没有意义的。

# usability - 你会如何向你的经理推销可用性？

> ID：424589
> 
> 赞同：1
> 
> 时间：2009-01-08T15:16:37.373
> 
> 标签：usability

对于一点背景，我在一家开发基于网络的企业社交媒体平台的公司工作。我们拥有多元化的客户，我们的口号是让客户更接近他们的客户。基本上，可用性应该是我们在整个产品生命周期中非常非常重要的考虑因素。

然而，我的公司没有雇佣任何 IA（虽然我们确实有知识渊博的产品经理和设计师）或内部可用性分析师。我们还没有发送任何产品进行适当的用户体验测试或可用性分析。由于我在 IA/可用性方面有一点背景，我决定自己去改变这一点，因为我认为可用性可以在很多方面为我们节省资金：减少 QA 迭代，为未来的产品开发建立业务知识，增加销售额信心等

然而，问题是似乎没有人对此很感兴趣。管理层担心改变我们的开发方法所产生的开销；无论如何，许多开发人员并不真正关心可用性，因为这对他们来说不会有太大变化；销售只是一开始就不太了解它。

我应该如何接近我的经理/领导并说服他们开始将可用性视为我们开发和销售过程的重要组成部分？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T15:42:13.050

经理和销售人员，尤其是在这种环境下，他们心中只有一件事：如何用最少的努力赚最多的钱。

您将需要硬销售或财务数据来向您的高管展示真正的投资回报率。否则，世界上所有的谈话都不会打动他们。

一旦你有了管理层，这本身就是一个巨大的障碍，那么发展就会随之而来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:33:27.387

我想你可以直接指出苹果——可用性和设计实际上是他们的商业模式，而且它肯定是高效的！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:16:14.707

多年来，我一直是 UX/Usability/IA（无论你怎么称呼它）从业者。关于这个主题的一篇更好的文章就在这里（[Selling UX By Daniel Szuc on UXMatters](http://www.uxmatters.com/mt/archives/2008/10/selling-ux.php)) 它涵盖了大部分障碍，并为销售人们不知道他们真正需要的东西这一古老的问题提供了深刻的见解。我认为的要点是：您的公司、组织、团体等必须准备好将客户的声音整合到设计过程中。有时这是一个巨大的转变，有些人无法理解。其他人在不知不觉中已经做了多年。请记住：几乎不可能向那些因为抱怨他们的产品而忽视甚至诋毁用户的公司出售可用性或用户体验。营销人员通常最清楚客户声音的力量。你可能会先让他们站在你这边。起初，甚至不提方法或过程。提及潜在的、可衡量的业务成果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-08T18:13:26.380

一家名为 Macadamian 的公司提供了一些很好的白皮书来回答这个问题。我建议你谷歌他们并浏览他们的白皮书。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:33:59.037

克里斯是对的，你需要证明投资回报率。Human Factors International 有一些[投资回报率计算器](http://www.humanfactors.com/downloads/roi.asp)可能会有所帮助。

另外，请查看“可用性的制度化”一书。你可以[在这里预览](http://books.google.com/books?id=Jc5VyXbkymwC&printsec=frontcover&source=gbs_summary_r&cad=0)。

# .net - 在 .NET DataTable 中存储数据的内存开销是多少？

> ID：424598
> 
> 赞同：23
> 
> 时间：2009-01-08T15:18:16.497
> 
> 标签：.net, datatable, memory-management

我正在尝试处理与 .NET DataTable 以及表中的各个 DataRows 相关的内存开销量。
换句话说，数据表占用的内存比简单地存储每列数据的正确类型数组所需的内存多多少？
我想会有一些基本的表格开销，加上每列的一些数量，然后每行再增加一些。

那么任何人都可以对这三种开销中的每一种/任何一种进行估计（并且，我猜是解释！）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-08T15:25:35.187

好吧，别忘了a `DataTable`store 2？3? 数据的版本——原始版本和更新版本（可能是另一个版本？）。它也有很多参考，因为它是基于单元格的~~，并且对任何值类型都进行了装箱~~。很难量化确切的记忆......

就个人而言，我很少使用`DataTable`- 在我看来，类型化的 POCO 类是一个更明智的选择。不过，我不会（直接）使用数组 -`List<T>`或`BindingList<T>`类似的东西会更常见。

作为粗略的衡量标准，您可以创建很多表等并查看内存使用情况；例如，下面显示了一个 ~4.3 的因素 - 即 4 倍以上的成本，但显然这在很大程度上取决于列数、行数和表数等：

```
 // takes **roughly** 112Mb  (taskman)
    List<DataTable> tables = new List<DataTable>();
    for (int j = 0; j < 5000; j++)
    {
        DataTable table = new DataTable("foo");
        for (int i = 0; i < 10; i++)
        {
            table.Columns.Add("Col " + i, i % 2 == 0 ? typeof(int)
                                : typeof(string));
        }
        for (int i = 0; i < 100; i++)
        {
            table.Rows.Add(i, "a", i, "b", i, "c", i, "d", i, "e");
        }
        tables.Add(table);
    }
    Console.WriteLine("done");
    Console.ReadLine(); 
```

对比

```
 // takes **roughly** 26Mb (taskman)
    List<List<Foo>> lists = new List<List<Foo>>(5000);
    for (int j = 0; j < 5000; j++)
    {
        List<Foo> list = new List<Foo>(100);
        for (int i = 0; i < 100; i++)
        {
            Foo foo = new Foo { Prop1 = "a", Prop3 = "b",
                 Prop5 = "c", Prop7 = "d", Prop9 = "e"};
            foo.Prop0 = foo.Prop2 = foo.Prop4 = foo.Prop6 = foo.Prop8 = i;
            list.Add(foo);
        }
        lists.Add(list);
    }
    Console.WriteLine("done");
    Console.ReadLine(); 
```

（基于）

```
class Foo
{
    public int Prop0 { get; set; }
    public string Prop1 { get; set; }
    public int Prop2 { get; set; }
    public string Prop3 { get; set; }
    public int Prop4 { get; set; }
    public string Prop5 { get; set; }
    public int Prop6 { get; set; }
    public string Prop7 { get; set; }
    public int Prop8 { get; set; }
    public string Prop9 { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-08T15:29:31.157

如果您不在列上定义索引，则开销非常低。如果您使用字符串缓存，您可以获得相当低的内存占用：使用 HashSet 或 Dictionary 仅使用每个字符串值的 1 个字符串实例。这听起来很奇怪，但是如果您从数据库中获取数据，并且您有多个具有相同字符串值的行（例如“ALFKI”），则字符串值相等，但字符串实例不相等：字符串多次存储在记忆。如果您首先使用 HashSet 过滤掉重复的实例，那么您可以有效地将相同的字符串实例用于数据表中任何地方的 1 个字符串值。这可以大大减少内存占用。当然，如果字符串值已经在某处静态定义（因此不从外部源读取），则不值得努力。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T15:31:03.710

这取决于您存储的数据量和数据类型。显然，数据越多，内存就越多。有一些与数据表相关的开销，这使得它有点贵。您还需要了解大对象堆。如果您存储的对象超过 85 kb，则该对象将存储在 LOH 中。这可能会对您的垃圾收集造成严重破坏，因为它需要完整的收集。如果您准备对其进行测试，请查看内存分析器以查看数据表的内存占用情况。

# accessibility - 验证码可以访问吗？

> ID：424599
> 
> 赞同：11
> 
> 时间：2009-01-08T15:18:18.090
> 
> 标签：accessibility, captcha

我在业余时间为一个教育机构写了一个网站，从我读到的关于这个地方的统计数据来看，他们似乎有很多残疾学生在那里学习。简单地说，我正在建立一个帐户系统，学生可以在其中登录并接收有关他们课程的基本信息，允许他们评论他们的课程以及他们认为课程代表他们的方式。

我不太确定这会产生什么法律影响，但我很确定，如果您为教育机构工作，那么您的网站必须可供残障人士访问，这是一项法律要求。代码非常好，除了一个问题；验证码。

据我所知，大多数验证码都是基于图像的，这会让那些使用屏幕阅读器的人感到困惑。最重要的是，支持声音读数的那些可能效果不太好，因为在许多建筑物中没有扬声器供用户收听录音。我总是可以使用一个小字段要求用户将两个数字放在一起，但这些数字通常太容易被机器人攻击。

我可能会从一个小山丘上造一座山，但对于那些对可访问性感兴趣的人来说，这仍然是一个有趣的问题。有谁知道在这种环境中阻止垃圾邮件发送者和用户进入的好方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T15:29:04.243

首先，是的，您 100% 正确认为这是一个问题。屏幕阅读器无法访问任何提供带有乱码文本的图像的验证码，如果您所在的组织必须支持它，则不能只使用验证码。

其次，我个人也 100% 同意音频验证码的局限性。

就我个人而言，我会实现一个标准的验证码，例如 ReCaptcha 或类似的东西，然后有一个“看不到图像”的链接，如果你真的需要一个，这会将它们带到一个不太安全的验证码。这实际上取决于您网站的目的。简单的数学可以工作，但做起来有点困难。

但是考虑到您的系统，我几乎会说您将系统限制为经过身份验证的用户进行输入，然后不需要验证码进行评论或其他提交，因为这样可以避免问题。

[该站点](http://www.purple-dogfish.co.uk/free-stuff/accessible-captcha)显示了其他基于文本的验证码项目的示例，但取决于受众，它们可能会也可能不会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T15:25:42.363

考虑滚动您自己的基于文本的验证码。

*   一周有多少天？
*   地球有多少颗卫星？
*   白雪公主和______小矮人

机器人可访问且未预料到。见鬼，混入只有这些学生才会知道的东西，比如关于学校的琐事。至少在他们完成填写表格之前，验证码有一些吸引力，而不仅仅是一个烦人的、非个人的步骤。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T15:53:31.963

我是一个完全失明的大学生，想知道你为什么需要captia？在我的学校，任何在线调查在参加之前都会使用学生的电子邮件和密码登录。其次，我发现一些音频字幕无法访问，而且通常不值得花时间，除非它是我真正关心的网站。即使您为您正在开发的网站提供了音频版本的 captia，如果我是盲人学生，我可能不会打扰该网站。第三，如果学生使用的是 firefox，那么几乎所有的 image captia 都可以访问，请参阅 [http://www.webvisum.com/上的 Webvisum 扩展](http://www.webvisum.com/) 编辑：如果这是一个大学赞助的网站，请向大学的残疾部门询问输入。如果它是一个迎合特定大学学生的个人网站，那么你可以做任何你有时间做的事情，因为你不会满足由实际教育机构运营的网站的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:25:34.393

毫无疑问，盲人（或任何需要屏幕阅读器的人）无法访问图像验证码；它们被设计为机器不可读/难以阅读。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T15:27:16.057

[官方 CAPTCHA 网站](http://www.captcha.net/)说“任何 CAPTCHA的实施都应该允许盲人用户绕过障碍，例如，允许用户选择音频或声音 CAPTCHA。”

我不是律师，但在我看来，如果您提供音频选项，那么您就是在为视力受损的用户提供服务——确保他们有扬声器不是您的责任。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T15:34:51.783

从您的个人资料中，我可以看到您在英国，因此我假设您需要遵守包括[DDA](http://www.direct.gov.uk/en/DisabledPeople/RightsAndObligations/DisabilityRights/DG_4001068)在内的英国法律。值得一读，而且在很多情况下你只能尽最大努力，很多网站并不是绝对可以访问的。您应该咨询您的同行以了解该机构的政策。

简短的回答是，不是每个人都可以访问 CAPTCHA。也就是说，从纯图像验证码到可以用 HTML 表示的逻辑谜题，似乎存在一定程度的可访问性。有些人和你自己也经历过类似的[旅程。](http://www.standards-schmandards.com/2005/captcha/)

我认为最好退后一步，考虑一下你需要验证码的原因以及你想阻止谁。您是否考虑过对您的站点使用基于 IP 的限制，以便只有校园网络中的人才能访问该站点，或者您的应用程序是否需要在 Internet 上。

另一种选择是限制登录尝试的次数，并在一段时间内阻止尝试，或者锁定帐户，直到电子邮件中的链接受到限制。与往常一样，您的里程可能会有所不同，但如果您提供更多背景信息，也许这里的人可以提供帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-29T19:46:39.160

是的，显然盲人无法访问基于图像的验证码。音频验证码并不是一个很好的选择——除了扬声器问题之外，它们通常包含大量背景噪音，使某些人无法访问它们。如果您必须使用 CAPTCHA，而不是其他一些限制用户的方法（您是仅在创建帐户时使用 CAPTCHA？还是在他们登录时使用？），文本 CAPTCHA 可能是要走的路。

# java - 如何使用 Jfreechart 绘制每日图表

> ID：424603
> 
> 赞同：1
> 
> 时间：2009-01-08T15:18:39.400
> 
> 标签：java, jfreechart

我每 15 分钟有一次数据。我想绘制一个图表来显示从“date1”到“date2”的值。该图应显示每 15 分钟的值。但是 X 轴上的显示应该只显示日期。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T07:24:07.577

如何以 15 分钟的间隔创建示例 XYPlot（显示为日期）

1) 创建您的数据。

```
 XYSeries dataSeries = new XYSeries("SMS Sent"); 
```

2）添加你的轴。如果您希望 x 轴显示日期，请使用 DateAxis 作为 x 轴。将您的日期数据输入为 long（以毫秒为单位）。jfreecharts 将为您处理格式。

```
 DateAxis dateAxis = new DateAxis(timeAxisTitle);

    DateTickUnit unit = null;
    unit = new DateTickUnit(DateTickUnit.MINUTE,15);

    DateFormat chartFormatter = new SimpleDateFormat("yyyy/MM/dd HH:mm");
    dateAxis.setDateFormatOverride(chartFormatter);

    dateAxis.setTickUnit(unit);

    NumberAxis valueAxis = new NumberAxis(valueAxisTitle); 
```

3) 使用 DateTickUnit 对象设置刻度大小（例如 15 分钟）。这将每 15 分钟绘制一个点。

4）使用工具提示生成器生成工具提示（可选）

```
 XYSeriesCollection xyDataset = new XYSeriesCollection(dataSeries);

    StandardXYToolTipGenerator ttg = new StandardXYToolTipGenerator(
            "{0}: {2}", chartFormatter, NumberFormat.getInstance());

    StandardXYItemRenderer renderer = new StandardXYItemRenderer(
            StandardXYItemRenderer.SHAPES_AND_LINES, ttg, null);

    renderer.setShapesFilled(true);

    XYPlot plot = new XYPlot(xyDataset, dateAxis, valueAxis, renderer);

    JFreeChart chart = new JFreeChart(chartTitle, JFreeChart.DEFAULT_TITLE_FONT, plot, false);
    chart.setBackgroundPaint(java.awt.Color.WHITE); 
```

5) 通过实例化一个新的 JFreeChart 对象来创建图表。然后您可以保存它或在屏幕上显示它。有关如何执行此操作，请参阅 Java 文档。

# javascript - jQuery 是否具有返回 rootURL 的内置函数？

> ID：424606
> 
> 赞同：8
> 
> 时间：2009-01-08T15:19:00.600
> 
> 标签：javascript, jquery

如果我需要这个，我通常使用下面的函数来返回根 URL，但是想问一下 jQuery 是否有一个“单线”的方式来做到这一点......

```
function getRootURL()
        {
            var baseURL = location.href;
            var rootURL = baseURL.substring(0, baseURL.indexOf('/', 7));

            // if the root url is localhost, don't add the directory as cassani doesn't use it
            if (baseURL.indexOf('localhost') == -1)
            {
                return rootURL + "/AppName/";
            } else {
                return rootURL + "/";
            }
        } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-08T15:25:54.407

关于什么

```
document.location.hostname 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-08T15:26:52.363

你可以这样做：

`alert(location.host)`

使用**location.hostname**，您不会获得端口（如果有像：8080 这样的特殊端口）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-09T13:54:29.170

要获取主机，您将执行以下操作：

```
window.location.hostname 
```

获取上下文路径：

```
window.location.pathname 
```

您可以使用查询字符串重定向用户，如下所示 - 保留主机名和端口

```
window.location.href = window.location.pathname + "?variable=" + theValue; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-12T11:57:05.237

我认为只有当 webapp 位于网站的根目录时，主机名才会给出根目录。如果它在虚拟目录或 Web 文件夹中，则结果不正确。 [请参阅此处](https://stackoverflow.com/a/23426025/1161069)以获取正确答案。我在[这里](https://stackoverflow.com/a/38917223/1161069)提到了如何轻松实现它。

# sql - .NET 数据表到 SQL Server 存储过程的 XML

> ID：424626
> 
> 赞同：0
> 
> 时间：2009-01-08T15:23:11.307
> 
> 标签：sql, sql-server, xml, datatable

行。所以我很新。我有一个数据表，我想将其传递给存储过程以进行进一步操作。我在网上阅读了一些东西，看起来我应该能够将数据表转换为 XML，然后将其传递给存储过程。我做错了什么？我有 SQL Server 2005。数据永远不会传递给存储过程。

```
Sub Test()
    Dim dt As New DataTable

    Fill datatable code omitted. there are 150 rows in the datatable after this

    Dim ds As New DataSet
    ds.Tables.Add(dt)
    Dim x As XmlDocument
    x.LoadXml(dt.DataSet.GetXml)
    Dim ta As New dsTestTableAdapters.TESTRxTableAdapter
    ta.ProcessFile(x)
End Sub 
```

存储过程看起来像这样......

```
ALTER PROCEDURE [dbo].[ProcessFile]

    (
         @x XML

    )
AS
BEGIN

'DO STUFF HERE

END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T17:22:49.680

过去我用 SQL 2000 做过类似的事情。在 SQL 2000 中没有 XML 数据类型，所以我必须通过 ntext 参数将 DataSet.GetXML 的输出接收到存储过程中，然后使用 sp_xml_preparedocument 和 sp_xml_removedocument 处理它，所以该过程应该适合您。

您可能不需要加载带有文本的 XmlDocument，只需将 xml 文本按原样传递给存储过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T21:43:36.603

好的。这就是我去上班的地方。我不知道这是否是最好的方法，但这对我有用。

```
Sub Test
    Dim ds as new DataSet ("Testds")
    Dim dt as New DataTable("Testdt")
    'Fill Datatable code omitted

Dim ta as new dsTest.TestTableAdapter
    'TableAdapter returns a datatable to ensure that the stored procedure worked
    ta.AddDataToDB(dt,ds.GetXML)

    Me.DataGridView1.DataSource=dt
    End Sub 
```

存储过程看起来像这样。

```
CREATE PROCEDURE [dbo].[AddDataToDB]

    (
         @x XML

    )
AS
    BEGIN
        DECLARE @data TABLE (
                            TestCol1 VARCHAR(50),
                            [TestCol2] VARCHAR(50), 
                            [TestCol3] VARCHAR(50), 
                            )

        INSERT INTO @data (
                           [TestCol1],
                           [TestCol2],
                           [TestCol3]
                          )
        SELECT 
            xmlVals.rowvals.query('TestCol1').value('.','VARCHAR(50)'),
            xmlVals.rowvals.query('TestCol2').value('.','VARCHAR(50)'),
            xmlVals.rowvals.query('TestCol3').value('.','VARCHAR(50)')
        FROM 
            @x.nodes('/Testds/Testdt') as xmlVals(rowvals)

        SELECT * FROM @data     

    END 
```

# .net - Visual Studio 设计器中的可折叠成员事件

> ID：424645
> 
> 赞同：0
> 
> 时间：2009-01-08T15:26:22.160
> 
> 标签：.net, visual-studio, designer, windows-forms-designer

如何让我的控制成员在 Visual Studio 事件网格上显示他们的事件？Visual Studio 通过将“（DataBindings）”成员放在可折叠部分中来执行此操作，如下所示：

[Visual Studio 中的可折叠事件 http://tseqkw.bay.livefilestore.com/y1pD-vBYTm53aShasVJk9nh0JY_8bHkp9jH5cfGaSDKZwDXmlF4WJzPqO8GuH2jhY2A6cy2wDGv5Pr42Z-KOG96YA/collapse-events.png](http://tseqkw.bay.livefilestore.com/y1pD-vBYTm53aShasVJk9nh0JY_8bHkp9jH5cfGaSDKZwDXmlF4WJzPqO8GuH2jhY2A6cy2wDGv5Pr42Z-KOG96YA/collapse-events.png)

我想对我自己的一些组件执行此操作，因为它们的事件通常在表单上处理，并且必须手动创建处理程序很烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T15:51:00.440

我认为你必须实现一个 TypeConverter。[http://msdn.microsoft.com/en-us/library/ayybcxe5.aspx](http://msdn.microsoft.com/en-us/library/ayybcxe5.aspx)

# linux - 在 Linux 中走哪条路（Qt 或 KDevelop）

> ID：424666
> 
> 赞同：10
> 
> 时间：2009-01-08T15:30:32.353
> 
> 标签：linux, qt, kdevelop

在对调试、实现和可用性的支持方面，哪一个 IDE 好。Qt 还是 KDevelop？

* * *

各种重复：

*   [适用于 Linux 的 C++ IDE？](https://stackoverflow.com/questions/24109/c-ide-for-linux)

*   [https://stackoverflow.com/questions/86676/is-there-a-good-and-free-ide-for-cc-in-linux](https://stackoverflow.com/questions/86676/is-there-a-good-and-free-ide-for-cc-in-linux)

*   [带有gui和linux下的c ++最好的稳定编辑器和编译器是什么？](https://stackoverflow.com/questions/164693/whats-the-best-stable-editor-compiler-for-c-plus-plus-with-gui-work-under-linux)

*   [https://stackoverflow.com/questions/211924/best-development-ide-for-linux-closed](https://stackoverflow.com/questions/211924/best-development-ide-for-linux-closed)

其中一些已经关闭。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-08T16:05:50.927

你似乎很困惑。[Qt](http://trolltech.com/products)是一个 C++ 工具包。[KDevelop](http://www.kdevelop.org/)是一个 IDE。

从您的评论中，我看到您的意思是 Qt Designer。Designer 不是 IDE；它只是一个以图形方式创建用户界面的应用程序。它不能编译代码、调试或执行 IDE 所做的任何其他事情。

KDevelop IDE 实际上将 Designer 嵌入到自身中，因此这显然不是“一种或另一种”类型的情况。

当然，第三种可能性是您在谈论[Qt Creator](http://trolltech.com/developer/qt-creator)，这是 Qt Software 最近作为测试版发布的 IDE。如果是这样的话，那么我只是鼓励你尝试一下，看看你更喜欢哪一个。他们采取不同的方法，更好的选择几乎完全基于个人喜好。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-14T22:34:49.903

开头的帖子可能意味着 Qt Creator，它绝对是一个完整的 IDE。

Qt creator 有两种风格：一种是简单的开源软件，仅被许可用于创建开源软件，另一种是付费软件，被许可用于创建 OSS 和闭源项目。Qt Creator 与 Qt 本身一样可在平台之间移植，并使用 MS Windows 下的 MingW 编译器和 Linux 下的 GCC 编译器。

一般来说，我发现 Open Source Qt 是一款精致的软件，它提供了比 KDevelop 更流畅、更愉快的用户体验（它如此拼命地尝试实现各种花里胡哨，以至于忽略了让简单的事情变得简单可靠），而且它的功能很少，界面也比 Kdevelop 简单得多（也许付费版也有更复杂的界面）。

仅使用 Qt 框架，您只需重新编译即可轻松制作在 Linux*和*MS Windows 下运行的应用程序，并且在两个平台上看起来都一样。另一方面，KDE 仅适用于 Linux。

我特别喜欢的是从命令行应用程序（最初在 MSVC 下开发）导入大约 35 个文件，让 qmake 设置生成文件，然后编译它就像一个魅力，而 KDevelop 则很麻烦。让 Qt Creator 设置命令行应用程序也很容易。现在命令行版本编译好了，我可以轻松地制作一个 Qt GUI 来准备选项参数、设置参数、选择并单击所有输入文件，并设置输出目录。我唯一需要改变的就是把我以前的“主”函数改成别的东西，让Qt为我生成一个主应用程序，然后调用它来响应按钮按下。大约一年前，我曾在 KDE 和 Kdevelop 上尝试过如此美妙的时光，以至于我完全放弃并回到了 MSVC。

除非你真的真的只想为 KDE 开发并且决心使用超越 Qt 的 KDE 功能，否则我会选择 Qt Creator。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-03T06:42:15.063

如果你真的想使用 KATE，你也可以使用 KDevelop。KDevelop 嵌入了 KATE 和 Konsole，增加了一些使其成为真正的 IDE 的能力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T15:25:41.757

我认为你的意思是 KDE 和 KDevelop，这取决于你的应用程序的范围，如果它独立于桌面，我会去 Qt，如果你想制作一个使用所有 KDE 功能的应用程序，我会去 KDE。

对于 Windows 和嵌入式开发，请转到 Qt。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-15T13:58:59.300

我个人认为，为了在 QT 中开发 kde 应用程序，最好使用 KATE。它通过提供一个终端来提供足够的便利，您可以在其中编译调试和运行您的应用程序。

# c# - 如何在 C# 中重载 [] 运算符

> ID：424669
> 
> 赞同：318
> 
> 时间：2009-01-08T15:32:02.990
> 
> 标签：c#, operator-overloading, indexer

我想在一个类中添加一个运算符。我目前有一种`GetValue()`方法，我想用`[]`运算符替换。

```
class A
{
    private List<int> values = new List<int>();

    public int GetValue(int index) => values[index];
} 
```

* * *

## 回答 #1

> 赞同：822
> 
> 时间：2009-01-08T15:34:19.460

```
public int this[int key]
{
    get => GetValue(key);
    set => SetValue(key, value);
} 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-01-08T15:35:01.830

我相信这就是您正在寻找的：

**[索引器（C# 编程指南）](http://msdn.microsoft.com/en-us/library/6x16t2tx(v=VS.100).aspx)**

```
class SampleCollection<T>
{
    private T[] arr = new T[100];
    public T this[int i]
    {
        get => arr[i];
        set => arr[i] = value;
    }
}

// This class shows how client code uses the indexer
class Program
{
    static void Main(string[] args)
    {
        SampleCollection<string> stringCollection = 
            new SampleCollection<string>();
        stringCollection[0] = "Hello, World";
        System.Console.WriteLine(stringCollection[0]);
    }
} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-01-08T15:39:38.233

[] 运算符称为索引器。您可以提供采用整数、字符串或您想用作键的任何其他类型的索引器。语法很简单，遵循与属性访问器相同的原则。

例如，在您的情况下 an`int`是键或索引：

```
public int this[int index]
{
    get => GetValue(index);
} 
```

您还可以添加一个 set 访问器，以便索引器成为可读写的，而不仅仅是只读的。

```
public int this[int index]
{
    get => GetValue(index);
    set => SetValue(index, value);
} 
```

如果要使用不同的类型进行索引，只需更改索引器的签名。

```
public int this[string index]
... 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-08T15:35:03.657

```
public int this[int index]
{
    get => values[index];
} 
```

# winapi - 应用程序不再工作 - 任何想法

> ID：424673
> 
> 赞同：0
> 
> 时间：2009-01-08T15:33:12.800
> 
> 标签：winapi, access-violation

我不知道为什么我的应用程序突然停止工作 - 也许 SO 社区的集体思想可以提供帮助...
背景：
我有一个大型应用程序直到最近才开始工作。现在，当我尝试运行它时，我收到错误“应用程序无法正确初始化（0xc0000005）”
这发生*在*应用程序到达`_tmain()`. 它发生在发布和调试版本中。我尝试清理和重建项目并重新启动我的电脑。

调用堆栈仅显示 kernel32.dll 和 ntdll.dll
的条目输出窗口显示：

```
a.exe 中 0x00532c13 处的第一次机会异常：0xC0000005：访问冲突读取位置 0xabababdb。
a.exe 中 0x7c964ed1 处的第一次机会异常：0xC0000005：访问冲突。
a.exe 中 0x7c964ed1 处的未处理异常：0xC0000005：访问冲突。

```

有任何想法吗？

编辑：
好的 - 发现问题 - 它*与*dll 有关
我的应用程序使用共享 dll a.dll 和 b.dll（和其他）
a.dll 几乎所有更改（*并使用 b.dll*）
b.dll 被另一个开发人员更改早上和 a.dll 没有重建。

Depends.exe 没有显示任何丢失的 dll，但是由于对 b.dll 的更改，a.dll 不再起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T15:42:28.273

该链接似乎将三个问题描述为可能的原因：

*   数据执行保护
*   驱动程序或系统更新
*   有故障的公羊

详情在这里：[http ://www.updatexp.com/0xC0000005.html](http://www.updatexp.com/0xC0000005.html)

如果您找到原因，请告诉我们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:34:41.347

检查权限？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T15:36:06.930

可能是 Windows 更新弄乱了系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T15:39:37.127

应用程序可能需要一些 .dll 文件，但没有找到，或者不允许访问它。

您是否使用了一些 dll，或者任何类型的运行时库？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T15:55:34.037

您是否使用过 SysInternals 套件来检查正在发生的事情？这将帮助您查明任何故障，例如，如果它正在访问文件、DLL 或注册表项并且访问被拒绝。

如果您将其安装在其他地方，您的程序是否可以正常工作？（另一台计算机）这可能有助于隔离问题。

--您可以检查事件日志（应用程序、系统等）以查看是否记录了有关该问题的任何内容。

--另一件事...自从您更新了 Tortoise，也许它使用了您的应用程序也使用的 DLL。您应该检查是否有任何 DLL 版本已更改。您可以卸载较新版本的 Tortoise。或者更激烈，尝试注册表还原。( [http://support.microsoft.com/kb/322756](http://support.microsoft.com/kb/322756) ) 或者，如果您使用 Ghost/Acronis 还原到操作系统的早期映像。

最后，我建议您尝试非常具体地找出问题所在。我提到了一些解决问题的严厉措施，但希望你能具体地（即 DLL ver x 导致问题）缩小范围。否则，您的应用程序的客户端或用户遇到同样的事情会很糟糕。

# user-interface - UI层抽象

> ID：424675
> 
> 赞同：5
> 
> 时间：2009-01-08T15:33:56.387
> 
> 标签：user-interface, layer

我已经成功地处理了抽象数据层和业务层。但是最近一位同事提到了在 UI 和业务层之间抽象 UI 层。但是我无法理解它。我无法想象这个 UI 层与业务层有何不同。我已经看够了文章，似乎没有找到太多帮助。有人可以告诉我一个简单的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T15:58:18.163

这里有多种选择。

1.  MVC

    您需要将视图与模型和控制器分开。想像为什么要这样做的最简单方法是，如果你有相同的模型和控制器，你想呈现不同的视图——网站视图、独立应用程序视图、网络服务视图、手机视图，您的单元测试视图等。因此，您的视图代码中不需要任何逻辑。即，在Java 中，您的ActionListeners 和其他GUI 代码中没有模型操作——相反，您将其移到控制器类中，视图处理程序只进行输入验证、输出格式化和与控制器类对话。

    许多视图是从以视图为中心的方法编写的。你有你的图形用户界面。发生了一些事情，你对此做出反应并做一些事情，并根据需要更新 GUI。因此，很容易将您的业务逻辑和模型紧密地绑定到视图中。

    基本上，您在业务逻辑中创建（一个）接口，任何东西都可以调用，因此添加新视图很简单。这些接口提供了您需要调用的所有功能。然后，您可以将内部业务逻辑设为私有。

2.  数据收集网络表单（或一系列网络表单）

    您不太可能希望以与业务层中的数据模型相同的顺序收集信息。此外，您将需要在多页表单中的页面之间保持不变。当您在第 3 页收集这些非空约束时，您会很快发现它们是一个 PITA（因为它们在第 1 页上让客户望而却步）。因为表单在重新排列时可能会发生变化，因此您最终会很早就将业务逻辑与视图分离，并概括您如何填充模型。还有很多其他的东西。

3.  从模型生成的接口

    您有一个可以更改的模型，或者确实可以显式或隐式地描述接口。因此，您可以从模型生成界面，而不是使用预先设计的表单和窗口等。这样，您必须非常通用地对视图代码进行编程，因为您将只能使用模型。从模型到 UI 的大量地图，反之亦然。然后你添加一些观察者，因为模型值在其他地方发生了变化，这很有趣...... :)

4.  别的...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T16:27:10.757

我发现 Jeremy Miller 的[Build Your Own CAB](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)系列文章过去提供了非常丰富的信息。他描述了模型-视图-控制器系列模式的许多变体。这是一本极好的读物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T20:12:55.123

这是我的原则：如果您必须重新编写任何逻辑（除了操作表单控件），那么您还没有将 UI 层与其他层完全分开。就个人而言，我喜欢有一个服务层来保存我的业务规则，操作域和数据映射对象，并且只与 UI 交换域对象。UI 那时对数据映射或业务规则一无所知。

这并没有回答关于 UI 和我的服务层之间单独的“UI 层”。也许这是为了将 HTML 和代码分开（即 ASP.Net 的代码背后可能被视为 UI 层）。当标记在上千个不同的函数中零散构建时，没有什么比更改全局 HTML 设置更糟糕的了（在更改/调试 Web 应用程序时）。HTML 应该只是在 HTML 文件中，并且将它们与类相关联所需的脚本数量最少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T15:49:00.633

简而言之，您的 UI 层只关注 UI 并与下一层（可能是您的业务层）协作。您的业​​务层和数据层（以及您拥有的任何其他层）中不应包含任何 UI 代码，因为这是 UI 层的工作。

想想 Web 浏览器的工作方式，浏览器就是 UI 层，它只关心渲染你的页面，而不是别的。当需要发生某些事情时，它会调用 Web 服务器（下一层）来执行此操作，然后呈现结果。

尝试在谷歌上搜索一些众所周知的 UI 模式：

*   MVC*   MVP*   谦虚的对话框

# command-line - 试图找到一种简单的方法来通过 FTP 只上传修改过的文件

> ID：424680
> 
> 赞同：6
> 
> 时间：2009-01-08T15:34:50.550
> 
> 标签：command-line, ftp

需要找到一种通过 FTP 将文件上传到我的服务器的方法。但只有那些已经修改过的。有没有一种简单的方法可以做到这一点？命令行 ftp 客户端或脚本是首选。谢谢，乔纳斯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T16:10:25.050

最可靠的方法是对您关心的所有本地文件进行 md5 哈希并将其存储在一个文件中。因此该文件将包含文件名列表及其 md5 哈希值。将该文件存储在您的 ftp 服务器上。当您想更新 ftp 服务器上的文件时，请下载包含该列表的文件，将其与您的所有本地文件进行比较，然后上传已更改（或新的）的文件。这样，您就不必担心存档位、修改日期或查看文件大小，这些文件的使用永远不会 100% 可靠。

由于显而易见的原因，使用文件大小不可靠 - 文件可能会更改但大小相同。我不喜欢使用存档位或修改日期，因为如果您使用另一个备份程序备份或恢复本地目录，这两者都可能会混淆。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T16:37:35.683

你是真的坚持`ftp`，还是可以`rsync`改用？

* * *

如果**需要，**[mhenry1384 的想法](https://stackoverflow.com/questions/424680/trying-to-find-a-simple-way-to-do-upload-only-modified-files-through-ftp#424848)大致是什么`ftp`（无论如何，它的一半，还查看不同文件的修改时间......）。 **`rsync``rsync`**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T15:43:41.250

（等待主要问题的评论得到回答再展开）

该策略将是：

1.  使用日期、时间、存档位或哈希查找更改的文件（取决于操作系统）
2.  使用此列表，生成一个 FTP 脚本 PUTing 这些文件
3.  运行 FTP 脚本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-07T14:40:36.023

git-ftp 非常好用：

```
apt-get install git-ftp 
```

在应用程序文件夹中：

```
git config git.ftp.xxxx.url ftpservice.server.com/root/dir/for/ftp
git config git.ftp.xxxx.user myUsername
git config git.ftp.xxxx.password myPassword 
```

仅在目标由其他 ftp 客户端更新时才遵循（它将 ftpservice.server.com/root/dir/for/ftp/git-ftp.log 更改为当前提交）

```
git ftp catchup --scope xxxx 
```

//编辑源//

```
git commit -m "new version"
git ftp push --scope xxxx 
```

你可以看到发生了什么：

```
git ftp show --scope xxxx
git ftp log --scope xxxx 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:41:58.307

乔纳斯，

文件可能多久更改一次？

如果它们在可预测的时间范围内发生变化，您可以考虑在文件中使用修改后的日期属性和其他日期属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-03T04:18:32.383

通过使用[git-ftp](https://github.com/git-ftp/git-ftp)相对容易。但只有当您的计算机是唯一修改 ftp 服务器上文件夹的计算机时，它才有效...

我听说 rsync 也可以工作，但我不确定，我从未使用过 rsync ......而且它不是 ftp ......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-05T16:25:56.917

Netbeans 有一个不错的 ftp。支持选择性上传、下载

# asp.net - 如何将 Microsoft AJAX 自动完成文本框添加到现有 ASP.NET 3.5 SP1 Web 应用程序项目？

> ID：424692
> 
> 赞同：0
> 
> 时间：2009-01-08T15:36:50.673
> 
> 标签：asp.net, ajax, textbox, autocomplete, ajax.net

几年前我玩过这个，当时它是“地图集”。现在我想使用它，我认为它会在 VS 工具箱中。现在我在网上只能找到完全混乱的信息！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T15:41:17.620

你下载了 AJAX 控制工具包吗？它在 CodePlex 上可用。一旦你这样做了，并将工具包 dll 放在你的 bin 文件夹中，你就可以开始使用它了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:39:31.400

我不知道如何使用 Ajax.Net。但是，我喜欢尽可能多地将 jQuery 用于 Ajax/JavaScript 的东西。它干净、简单、快速。

那么我可以推荐 jQuery Autocomplete 插件吗？ [http://www.pengoworks.com/workshop/jquery/autocomplete.htm](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)

编辑：所以有一个[Ajax.net 版本](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)这里有一个教程：[http ://www.asp.net/learn/AJAX-videos/video-122.aspx](http://www.asp.net/learn/AJAX-videos/video-122.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:42:36.667

我同意[Damien](https://stackoverflow.com/questions/424692/how-do-i-add-an-microsoft-ajax-auto-complete-textbox-to-an-existing-asp-net-3-5-s#424701)的观点，现在 jQuery 在任何 .NET 开发工具集中几乎（或将成为）无处不在，我建议使用 jQuery 自动完成插件。我在 30 分钟内启动并运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T16:06:47.227

这是[AJAX Control toolkit 的自动完成示例](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)的链接。设置起来有点困难，因为您必须设置并附带 Web 服务。如果我从头开始，我可能会使用 Damien 提到的 jQuery 方法。如果自从 ScottGu 的团队在去年 10 月认可它之后，下一个版本的 AJAX 控制工具包是使用 jQuery 重写的，我不会感到惊讶。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:15:34.447

如果在将 AjaxControlToolkit 集成到现有站点后遇到奇怪的脚本错误，请检查以确保正确设置了 web.config（包括参考程序集的版本号）。您可能希望使用 AJAX 模板在 Visual Studio 中创建一个新的“虚拟”AJAX 网站，以查看 web.config 中的所有内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T14:59:58.570

我发现 AJAX Control Toolkit 解决方案非常慢。当然，我愿意承认这是我的错。我们已经购买了 Telerik 控件套件并使用了他们的，性能相当不错。

# java - 如何在 LifeRay ShoppingItem 描述中使用 HTML？

> ID：424696
> 
> 赞同：0
> 
> 时间：2009-01-08T15:38:29.670
> 
> 标签：java, html, database, liferay

如何将 HTML 嵌入到 ShoppingItem 数据库表“描述”字段中，使其显示在屏幕上？它曾经在旧版本中工作，但在当前版本中，它会破坏/保护它以显示 HTML 标记，而不是传递它们以进行处理。

有没有其他方法可以达到预期的效果？

我确信对 LifeRay 的更改是出于安全目的，但最终用户无法在我们的应用程序中编辑此表，我们需要将链接、粗体等嵌入到购物项目描述中......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T21:28:44.050

最终用一个快速而肮脏的“替换”破解了适当的 .jsp 文件来解码 lt 和 gt 字符。不漂亮，但 LifeRay 竭尽全力阻止您注入任何类型的 HTML。

# nhibernate - NHibernate：通过示例查询主键会产生“WHERE (1=1)”

> ID：424699
> 
> 赞同：4
> 
> 时间：2009-01-08T15:39:30.497
> 
> 标签：nhibernate

我有一个实体客户

```
public class Customer
{
    public virtual int ID { get; set; }
    public virtual string Firstname { get; set; }
    public virtual string Lastname { get; set; }
} 
```

我的 DAL 方法是：

```
 public IList<Customer> GetCustomers(Customer example)
    {
        var customers = default(IList<Customer>);

        using (var sessiong = GetSession())
        {
            customers = sessiong.CreateCriteria(typeof(Customer))
                .Add(Example.Create(example))
                .List<Customer>();
        }

        return customers;
    } 
```

但问题是当我这样调用我的方法时

```
 var exemple = new Customer() { ID = 2 };
    var customers = provider.GetCustomers(exemple); 
```

我在数据库中有我所有客户的集合，因为 NHibernate 生成以下 SQL 查询

```
NHibernate: SELECT this_.CustomerId as CustomerId0_0_, this_.Firstname as Firstname0_0_, this_.Lastname as Lastname0_0_ FROM Customers this_ WHERE (1=1) 
```

NHibernate 在主键上支持 QBE 吗？我究竟做错了什么 ？

PS 我忘了提及我正在使用的 NHibernate 版本。它是 2.0.1.GA。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-15T09:48:42.490

“使用示例查询时忽略 ID。这样做是因为设置了 id 的示例对象无论如何都只会返回一个对象。” - [http://forum.hibernate.org/viewtopic.php?t=927063](http://forum.hibernate.org/viewtopic.php?t=927063)和[http://forum.hibernate.org/viewtopic.php?p=2351666&sid=c22d2c37f8d67e268b6ffe547f57ad9e](http://forum.hibernate.org/viewtopic.php?p=2351666&sid=c22d2c37f8d67e268b6ffe547f57ad9e)
这是针对休眠的。NHibernate 是从它移植过来的。所以我确信这也是 NHibernate 的设计。所以在 id 上使用 Get 而不是 QBE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-12T16:54:09.993

如果您通过示例条件对象在查询上使用 EnableLike() 来查询主键的一部分 + 一些其他属性，那么您的查询将返回超过 1 条记录。例如：用户的用户名是主键。您的对象的属性（包括主键）设置为应该由 like 运算符查询的值。在这种情况下，NHibernate 除了编写自己的查询方法外别无选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-12T00:59:27.533

我知道这是一篇旧帖子，但我今天遇到了这个问题，这里的答案都没有帮助。我们有一个名为**CountByExample** () 的方法，只要示例中未指定 ID 列，该方法就可以正常工作。

对于我们的场景，仅当具有指定 ID 的对象具有一组特定参数时，计数才有效。该对象是一个相当大的对象，因此加载它会不必要地浪费资源和带宽。因为 NHibernate 从示例中去除了 ID，所以计数总是不正确的。

**我通过以下对我来说很好的调整解决了这个问题。**

```
 criteria.Add(example);
            //HACK: Check for ID query and force NHibernate to take it
            var prop = searchParameters.GetType().GetProperty("ID");
            if (prop != null)
            {
                criteria.Add(Restrictions.Eq("ID", prop.GetValue(exampleT)));
            } 
```

其中“searchParameters”是一个对象，如：

```
var searchParameters= new { ID = 48, isEnabledForAds = true, hasOptedOut = false}; 
```

# asp.net - 如何让 ASP.NET DataPager 控件在 UpdatePanel 中工作？

> ID：424705
> 
> 赞同：3
> 
> 时间：2009-01-08T15:39:55.737
> 
> 标签：asp.net, updatepanel

我有一个顶部带有参数的搜索页面和底部带有结果的搜索按钮。整个内容都包含在母版页内的更新面板中。单击搜索按钮后，它会显示第一页。但是，如果您单击 DataPager 上的下一步按钮，它不会显示第二页。它没有显示第二页的结果。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T17:59:19.457

我认为尼克的想法是正确的。听起来您正在执行搜索并在搜索按钮的 OnClick 方法中填充 ListView。您需要执行搜索（或者最好是第一次缓存数据）并将其绑定到使用 DataPager 请求的每个新页面的 ListView。

您可以通过为 ListView 的 OnPagePropertiesChanged 事件创建一个方法来相当容易地做到这一点。执行搜索（或从缓存中提取）并将 ListView 绑定到该 OnPagePropertiesChanged 事件中，您的数据应该会填充。您的 C# 代码可能如下所示：

```
protected void SearchButton_OnClick(object sender, EventArgs e)
{
    PerformSearch();
}

protected void PerformSearch()
{
    // ...Get your data.... //

    ListView1.DataSource = data;
    ListView1.DataBind();
}

protected void ListView1_OnPagePropertiesChanged(object sender, EventArgs e)
{
    PerformSearch();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T16:41:32.853

听起来您的控件在回发中没有绑定，您在哪个事件中执行 DataBind()，它是否在

`if(!IsPostBack) { }`

某种包装？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:45:14.727

请确保您的页面更改事件已在脚本管理器中注册，因为它不受更新面板的控制。ScriptManager.RegisterAsyncPostBackControl(DatePager 控件);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T23:28:16.270

在更新面板的底部执行以下操作：

```
 <Triggers>
                                <asp:PostBackTrigger ControlID="DataPager1" />
                            </Triggers>
                    </asp:UpdatePanel> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-02T15:01:00.520

`DataPager`在数据控件 where 上使用 a 时，我遇到了类似的问题`EnableViewState=false`。

# asp.net - ASP.NET 服务器映射路径

> ID：424707
> 
> 赞同：0
> 
> 时间：2009-01-08T15:40:04.427
> 
> 标签：asp.net

我有一个名为 A 的文件夹，在 A 内，我有 2 个文件夹 B 和 C，B 有一个名为 child B 的子文件夹，现在我在 C 中有一个程序。从 CI 需要获取 childB 的物理路径当我给Server.MapPath("../B/childB/") 它正在显示。错误。谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T15:44:46.600

出于安全原因，`MapPath`不会解析当前应用程序之外的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:50:47.697

既然您知道实际结构，为什么不获取 childB 的当前路径，而不仅仅是使用 Path.Combine 其余的？
使用相对路径是否有您想要一次性使用它的实际原因？
另一点 - B 文件夹可能没有在 IIS 中定义，因此相对论可能不起作用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:58:57.727

看起来你对实际功能没有做错任何事情。支持相对路径，如下面的阅读中所述。很难说没有更多信息，但是您的文件夹是否存在于您的解决方案中？

如前所述，您还可以使用绝对路径 (/B/childB)。

MSDN [http://msdn.microsoft.com/en-us/library/ms524632.aspx](http://msdn.microsoft.com/en-us/library/ms524632.aspx)

4GuyFromRolla [http://www.4guysfromrolla.com/webtech/121799-1.shtml](http://www.4guysfromrolla.com/webtech/121799-1.shtml)

# java - 使用连接点调用(* *.*(..))，如果可用，我可以将参数公开给建议吗？

> ID：424709
> 
> 赞同：0
> 
> 时间：2009-01-08T15:40:27.810
> 
> 标签：java, refactoring, aspectj, pointcut

`java.util.Set`就我而言，我通过建议对 的实例（尤其是`add(Object)`和）的某些方法调用来跟踪某些集合的更改`remove(Object)`。由于更改未反映在集合本身中，因此调用`Set.contains(Object)`或`Set.size()`返回错误结果。

因此，我想拦截对 Set 实例的所有方法调用（除了`add`and `remove`），并将调用转发到我的最新集合。

当然，我可以使用不同的切入点定义两个建议，如下所示：

```
// matches Collection.size(), Collection.isEmpty(), ...
* around(Collection c) : call(* Collection.*()) && target(c)
            && !remove(/*...*/) && !add(/*...*/) {
    if (notApplicable())
        return proceed(c);

    return proceed(getUpToDateCollection());
}

// matches Collection.contains(Object), ...
* around(Collection c, Object arg) : call(* Collection.*(*)) && target(c) && args(arg) 
            && !remove(/*...*/) && !add(/*...*/) {
    if (notApplicable())
        return proceed(c, arg);

    return proceed(getUpToDateCollection(), arg);
} 
```

它有效，但它非常丑陋，我的建议的主体非常相似。所以我想“组合”它们；有效地为两个切入点编织了一个建议，就像这样：

```
* around(Object[] args): call(* Collection.*(..)) && args(arr) {...}` 
```

这可能吗？我感觉不是，因为在其中一个切入点中我公开了参数（随后在建议中使用它），而在另一个切入点中没有参数，因此似乎不可能在封闭建议中绑定“潜在标识符” ......但我希望我忽略了一些事情，你也许能指出我正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-12T01:04:31.980

只是为了记录。
可以*编写*一个暴露参数的切入点，然后在不访问这些参数参数的建议中使用这个切入点。与其将切入点表达式立即写入通知定义，我总是更喜欢显式定义切入点，仅通过切入点的名称（和参数）从建议中引用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-29T03:48:16.263

我不知道为什么这么多年后这个问题在我的提要中以“新”的形式出现，但仍然没有答案，所以我将回答：

*   您的假设是正确的，您不能使用`args()`它来绑定不存在的参数。
*   如果你绝对想要一个通知体，你可以使用`JoinPoint.getArgs(..)`，但它会很丑陋（如涉及循环和强制转换）并且可能比拥有两个切入点慢。如果做错了，太宽的切入点也可能匹配太多的连接点。
*   我的建议——没有双关语的意思——实际上是将重复的代码分解为辅助方法，并从两个 AspectJ 建议中调用它们。如果您还想排除该部分，那么这些辅助方法可能还需要一个`ProceedingJoinPoint`参数才能调用它。`proceed()`但也要考虑可读性。它总是取决于你的具体情况。

如果您的代码实际上是一个[小 SSCCE](http://sscce.org/) ，我可以以更具体的方式（使用方面代码）回答。

# c - 分析多进程程序

> ID：424716
> 
> 赞同：4
> 
> 时间：2009-01-08T15:41:32.270
> 
> 标签：c, linux, profiling, fork

我想分析一个分叉和产生几个子进程的程序。我想看看在某些功能上花费了多少时间。什么分析器可以处理这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T16:29:39.693

[Oprofile](http://oprofile.sourceforge.net/news/)很适合这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T15:55:26.390

我认为您可以使用[SystemTap](http://sourceware.org/systemtap/)来实现- Linux 上的[DTrace想法实现](http://www.sun.com/bigadmin/content/dtrace/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-21T20:15:42.867

尝试从 RotateRight[缩放。](http://rotateright.com)默认情况下，它会进行系统范围的分析。如果您有更高版本的 (2.6.32+) 内核，您还可以获得调度程序行为和系统调用的时间线视图。

# c# - 从 C# 中以编程方式访问 SharePoint 样式库

> ID：424739
> 
> 赞同：1
> 
> 时间：2009-01-08T15:45:45.163
> 
> 标签：c#, sharepoint, spsite, spweb

首先，我是 C# 和 SharePoint 的新手（不到一个月的经验），如果这是一个明显或简单的问题，我深表歉意，但我已经在网上拖网几天了，但绝对没有成功。

我有一个 xslt 文件，已存储在新网站的“样式库”子目录中，但是如何从 c# 中访问它？

我看过 SPSite 和 SPWeb，但似乎都不能完全满足我的要求。

任何和所有的帮助将不胜感激。

非常感谢

c#新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T15:52:26.943

下面是一些从列表中检索列表项的代码：

```
SPList list = web.Lists["MyLibrary"];
            if (list != null)
            {
                var results = from SPListItem listItem in list.Items
                              select new 
                              {
                                  xxx = (string)listItem["FieldName"]),
                                  yyy  = (string)listItem["AnotherField"],
                                  zzz = (string)listItem["Field"]
                              };
            } 
```

要检索文件，您还可以在 SPWeb 上使用此方法：[GetFileAsString](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.getfileasstring.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:56:39.603

帕特里克，

我希望你喜欢 C# 和 SharePoint！

[在这里](http://www.scribd.com/doc/8634090/Accessing-SharePoint-Data-Using-C-Without-Running-Code-On-the-SharePoint-Server-Part-1)查看文章。

通读一遍，它应该会为您提供所需的所有帮助。

缺口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T14:04:21.913

没有 linq：

```
int itemId = getItemId();
SPWeb currentWeb = SPContext.Current.Web;
SPList list =  currentWeb.Lists["MyList"];
if ( list != null )
{
     SPListItem theItem = list.Items.GetItemById(itemId);
     doWork(theItem);
} 
```

可以通过多种方式检索 SPWeb，如果从 SharePoint 调用代码，则使用 SPContext 将起作用。要从 URL 获取 SPWeb 对象，您可以使用 SPSite 对象，即

```
using ( SPSite site = new SPSite(urlToWeb) )
{
   using (SPWeb web = site.OpenWeb())
   {
     doWork(web);
   }
} 
```

“using”语句通过在相关对象上调用“Dispose()”来确保及时回收非托管资源。

HTH, jt

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T16:10:44.060

非常感谢您对此提供的帮助。我已经从每个中使用了一点，并做了一些额外的阅读，并提出了以下内容：

```
private static string getXsl()
{
    string xslString = null;
    using (StreamReader streamReader = new StreamReader(
        File.Open(HttpContext.Current.Server.MapPath(@"~_layouts\theXSL.xslt"), FileMode.Open)))
    {
        xslString = streamReader.ReadToEnd();
    }
    return xslString;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T19:46:19.777

尽管这可能很有效，但您应该*真正*研究最佳实践，因为它们与将文档存储在 12 个配置单元中而不是内容数据库中有关。

有更多可扩展的答案，在选择旅鼠路线之前应该考虑这些答案。

# c# - Lambda 闭包或类级别变量？

> ID：424743
> 
> 赞同：2
> 
> 时间：2009-01-08T15:46:30.467
> 
> 标签：c#, lambda, closures, variable-declaration

只是关于最佳实践是什么的一般问题：

```
public void Foo()
{
    int x = 5;
    myControl.Click += (o, e) =>
    {
        x = 6;
    };
} 
```

请注意，我`x`在我的 lambda 事件处理程序中使用该变量。

或者：

```
public class Bar
{
    private int x = 5;
    public void Foo()
    {
        Control myControl = new Control();
        myControl.Click += new EventHandler(myControl_Click);
    }

    private void myControl_Click(object sender, EventArgs e)
    {
        x = 6;
    }
} 
```

这里，`x`是类的私有成员，因此我可以在我的事件处理程序中访问它。

现在假设我不需要`x`代码中的其他任何地方（无论出于何种原因），哪种方法更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T15:55:21.867

这取决于您的需要。在第一个示例中，事件处理程序的副作用仅限于方法范围，而在第二个示例中，副作用仅限于实例范围。我认为在您的第一个示例中使用闭包没有任何意义，因为 X 没有在任何地方使用，因此很难根据您的示例来确定。

话虽如此，通常最好将事件处理程序（您在代码中创建）视为变量。尽可能缩小它们的范围，并根据需要将它们重构为更广泛的范围。

一个更好的例子可以突出何时*应该*使用闭包，如下所示：

```
public void Subscribe(Action<string> messageCallBack)
{
    myButton.Click += () => messageCallBack("Button was clicked.");
} 
```

这允许多个订阅者，并且比替代方案简单得多：

```
private readonly List<Action<string>> callBacks;
public MyClass()
{
    callBacks = new List<Action<string>>();
    myButton.Click += myButton_Click;
}

private myButton_Click(object sender, EventArgs e)
{
    foreach (Action<string> callBack in callBacks)
    {
        callBack("Button was clicked");
    }
}

public void Subscribe(Action<string> messageCallBack)
{
    callBacks.Add(messageCallBack);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T15:52:44.447

如果您在代码中的其他任何地方都不需要 x，则您的处理程序是无操作的 - 所以这肯定是一种无意义的情况。

一旦你*确实*需要 x，你需要决定它的范围是 Bar 实例还是委托实例（或者可能是一些委托的集合），这将决定你做什么。

# wcf - 在我的 WCF app.config 中设置 SendTimeout

> ID：424747
> 
> 赞同：4
> 
> 时间：2009-01-08T15:47:40.260
> 
> 标签：wcf, configuration, app-config

看着我的 app.config 有点困惑，它看起来像这样：

```
<system.serviceModel>

<servcies>

    <service>

        <endpoint address="" binding="basicHttpBinding">
            <identity>
                           <dns value="localhost"
            </identity>
        <endpoint>

    </service>

</services>
<behaviors>
    <serviceBehaviors>

        <behavior>
            ...
        </behavior>

    </serviceBehaviors>
</beharviors>

</system.serviceModel> 
```

我将在哪里添加绑定标签以将 SendTimeout 值设置为大于 1 分钟？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-08T19:58:17.697

您在服务器的 .config 文件中设置了一个绑定部分，如上一个问题中显示的 IceLava：

```
 <bindings>
    <netTcpBinding>
    <binding name="longTimeoutBinding"
        receiveTimeout="00:10:00" sendTimeout="00:10:00">
      <security mode="None"/>
    </binding>
    </netTcpBinding>
   </bindings> 
```

在你上面的例子中，你可以把它放在你的行为之下。

然后，在您的端点配置中，使用属性 bindingConfiguration = "longTimeoutBinding" 添加对该绑定的引用。

像这样的东西：

```
<endpoint address="" bindingConfiguration="longTimeoutBinding" binding="basicHttpBinding">
        <identity>
                   <dns value="localhost" />
        </identity>
<endpoint> 
```

如果您有 Juval Lowy 编写的 Programming WCF Services 一书，您可以在第 28-29 页（第 2 版）中查看更多信息。

# .net - .Net Framework 的生命周期是多久？

> ID：424760
> 
> 赞同：2
> 
> 时间：2009-01-08T15:50:55.527
> 
> 标签：.net

它会过时吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-08T15:54:19.170

是的，我确信它会在某个时候过时。我认为可以肯定地假设我们的后代在 1000 年内不会使用它。现在，更有趣的问题是它*何时*会过时。

*   5年？不太可能国际海事组织。
*   10年？几乎可以肯定仍在使用，但*可能*不会用于新开发；MS处于“支持但没有新版本模式”？我*怀疑*到那时它仍然非常活跃，但如果它被其他东西所掩盖，我不会*完全感到惊讶。*我怀疑，这部分取决于 Windows 本身作为一个平台的表现。
*   20年？我希望到那时我们已经有了更好的工具，但在那时看到使用最新版本的 .NET 进行重大维护开发（包括现有产品的新版本）也不会感到惊讶。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T15:58:40.347

鉴于遗留 COBOL 和其他代码的数量，我想说没有什么会真正过时，尽管显然工具和技术在发展，语言、框架和方法变得过时且使用较少。

Microsoft 已对 .NET 进行了大量投资并正在积极开发它，所以我想说它将会存在相当长的一段时间。我怀疑我们是否会在 20 到 30 年后以任何当前可识别的形式使用 .NET，但它不会在下周一夜之间消失。

你可以提出一个类似的问题，例如 Java 平台——该语言仍然很流行，考虑到现在移植到它上的语言数量，JVM 更是如此；诸如 JRuby 和 Jython 之类的东西。

强大的架构经久耐用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-08T16:18:05.660

.NET 长期存在的最佳防御是，即使是新的理论编码方法（不再是理论）也已在 .NET 中实现，从 lambda 到函数式编码。事实上，每当研究人员想出一种新的编码思维方式时，它都会在 .NET 中作为 C# 的补充或作为一种新语言（例如：F#）来实现。左侧开发的唯一概念是纯基于 GUI 的开发 (drag'n'drop)，Visual Studio 在每个新版本中都越来越慢地提供这一点。

由于 .NET 非常灵活，您可以自由地添加现有或新的语言，我认为可以肯定地说社区将在 10 年后使用 .NET。您无法将 .NET 的生命与 VB 相提并论，因为 VB 是一种语言，但 .NET 是一个可扩展的平台。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T16:41:34.037

MS 比我想象的更热衷于 .NET，这是一件好事！人们甚至跟不上这些东西。我仍然没有使用 .NET Framework 3.5 开发工具

这意味着就像他们不断发布新的 Windows 一样，他们将维护 .NET 并不断添加/修复/改进内容。

我期待 .NET 在未来提供更好的跨平台支持，不仅是非官方的 Mono，而且像 Java 一样，将支持如此多的平台。

但最终（大约 15 年）它可能会消失。既然是 IT，可能会有突破，但至少 15 年 .NET 就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T18:22:16.110

几个世纪以来，微软一直喜欢支持某些东西——win32 作为核心原则具有向后兼容性，您可以保证您的代码几乎不需要重新编译就可以在更高版本的 Windows 上运行。

但是，MS 现在具有“抓住它并重写它”的心态，因此，虽然 .NET 作为一个整体将存在很长时间，但不要指望您的代码能够存活多年。您必须定期升级。MS 喜欢升级——它销售更多的软件。

但是，您遇到的最大问题不是 .NET 是否会以这种方式过时，而是是否会出现更好的东西。看看 MS 放弃对 VB6 的支持有多快，现在对 MFC 的支持有多少，Java 的就业市场是如何萎缩的。一些同样时髦的东西会在某个时候出现，然后 .NET 将被视为陈旧且无用，其中编写的代码将被视为陈旧且粗鲁（尤其是人们学习的早期内容），每个人都想迁移到很酷的新技术。

诀窍是学习一些不同的技术，或者真正经受住时间考验的技术（C？）。如果你是一匹小马，你最终会过时。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-08T15:54:26.097

你为什么要问？我认为它在不久的将来不会有任何进展。也许微软会对其进行重命名或重新命名等，但基本面应该保持不变。

什么时候会过时？人们仍在使用 COBOL。

这是其中一个问题……比如，“你死后会发生什么？” 谁他妈知道。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-08T15:58:42.017

它会过时吗？肯定是的。没有什么可以天长地久。（*）

那会很快吗？当然不。Windows 仍然是主要的平台，而 .Net 是它最有趣的框架之一。在接下来的 5-10 年里，它将继续存在。可能更长，因为它也在进化。

(*) `for (;;)`当然除了...

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-08T18:02:26.930

如果您想知道您的 .NET 代码要过时多久，那么答案是 1 或 2 年！

MS 在 .NET 的每个版本之间打破了一些东西，差不多。所以，总会有一些事情需要“修复”。希望他们不会出现太多更大规模的平台更改，例如 WinForms -> WPF ......应用程序的大部分需要完全重做（或者您只是接受过时）。

当然，其他平台也有同样的问题。

.NET*平台*将像其他人所说的那样继续发展和增长 10 年。你现在写的代码会更早被淘汰。

# vb.net - 使用 BindingSource 对 ReportViewer 中的报表数据进行排序

> ID：424764
> 
> 赞同：0
> 
> 时间：2009-01-08T15:51:53.623
> 
> 标签：vb.net, ado.net, reportviewer, bindingsource

我试图让 ReportViewer 显示来自 BindingSource (VB.Net Winforms) 的数据。

我在基础数据集上构建了报告。然后我将数据源实例配置为 BindingSource。我认为这将应用排序、过滤等。但看起来数据来自数据集而不是 BindingSource。

我怀疑我错过了一些简单的东西。

更新：或者也许它不是那么简单 - 我几天前发布了这个，但仍然没有人知道答案！也许我正在尝试做一些无法完成的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T14:19:29.227

您需要在报告中指定排序（在 RDL 中），因为它应用了自己的排序逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T17:09:06.867

这是我使用的解决方案。您将 Bi​​ndingSource 中的数据放入 DataTable 中，然后让 Report 使用 DataTable。

```
 ReportViewer1.Reset()
    Dim dt As DataTable
    dt = DirectCast(Form1.ProgActnBindingSource.Current, DataRowView).DataView.ToTable

    Dim rs = New ReportDataSource
    rs.Name = "name"
    rs.Value = dt

    ReportViewer1.ProcessingMode = ProcessingMode.Local
    ReportViewer1.LocalReport.DataSources.Clear()
    ReportViewer1.LocalReport.DataSources.Add(rs)
    ReportViewer1.LocalReport.ReportEmbeddedResource = "projectname.Report1.rdlc"

    Me.ReportViewer1.RefreshReport() 
```

# crystal-reports - Crystal Reports：公式字段中的总和错误

> ID：424768
> 
> 赞同：1
> 
> 时间：2009-01-08T15:52:25.413
> 
> 标签：crystal-reports

**简介：** 我有一份非常复杂的报告。为了使它更容易一点，我以这种方式构建我的报告：在 VS.net 中，我有一个类。在报告中，我制作了一个“仅字段定义”文件（ttx），它与类完全相同。在后面的代码中，我将类设置为（子）报告的数据源。

**问题：** 一个类（以及 ttx 文件）具有以下字段：PriceTraditional、PriceCommercial。并且有 2 个公式字段，即 SumPriceTraditional、SumPriceCommercial。

当类为空时，数据源也为空。这是发生错误的时候。可能是因为我取了一个为 NULL 的字段的总和。

**我尝试过的解决方案（但不起作用）：**

1.  我尝试使用 formulaField 更改 PriceTraditional （例如：PriceTraditionalDummy; 使用公式：*if isnull({DamageForReport.PriceTraditional}) then 0 else {DamageForReport.PriceTraditional}*。但后来我得到一个错误：*这里需要一个数字。（这是由结构的 else 部分引起。*
2.  我尝试打开和关闭默认值替换（没有结果）

**问题：**我只想有一个报告，如果 sum 中使用的字段为空，我可以在其中使用 Sum-FormulaField 而不会炸毁报告。

任何关于如何解决这个问题的建议都会很棒！！

亲切的问候，

维姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-29T14:09:13.753

您可以尝试的一些方法是使用 CCur 将 0 转换为货币，或者使用 CDbl 或 ToNumber 将 {DamageForReport.PriceTraditional} 转换为数字。

似乎出于某种原因，它认为第一部分中的 0 和第二部分中的 {DamageForReport.PriceTraditional} 属于不同类型，因此您可以强制转换一个以匹配另一个。

我没有尝试过其中任何一个，但它可能就像使用 $0 或 0.0 而不是 0 一样简单。

只是抛出一些想法。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-28T17:50:32.697

只需按照本文中描述的步骤

邮政

[http://crystalrepterrinfo.blogspot.com/2009/11/error-on-sum-in-formula-field-crystal.html](http://crystalrepterrinfo.blogspot.com/2009/11/error-on-sum-in-formula-field-crystal.html)

# c# - 在 Windows 窗体应用程序中显示地图

> ID：424770
> 
> 赞同：6
> 
> 时间：2009-01-08T15:52:38.190
> 
> 标签：c#, winforms, maps

几个月前，我构建了一个 Winform 应用程序，用于安排维修技术人员的预约。我想通过在客户表单上添加客户地址的地图来更新应用程序，然后将该地图打印在技术人员离开办公室时的报告上。

我一直在环顾四周，但我还没有找到一个好的解决方案。

我目前有客户的地址。我想做的是将地址提交到流行的在线地图站点之一，并获取该地区的小地图。我*几乎*可以使用谷歌地图使用他们的嵌入式链接功能来做到这一点。将地址添加到他们的网站后，我可以获得以下 HTML：

```
<iframe width="300" height="300" frameborder="0" scrolling="no" 
   marginheight="0" marginwidth="0" 
   src="http://maps.google.com/maps?hl=en&amp;ie=UTF8&amp;t=h&amp;g=1193+Presque+Isle+Dr,+Port+Charlotte,+FL+33952&amp;s=AARTsJqsWtjYwJ7ucpVS6UU2EInkRk6JLA&amp;ll=27.012108,-82.087955&amp;spn=0.005735,0.006437&amp;z=16&amp;output=embed">
</iframe> 
```

我的第一个计划是简单地解析这个 HTML 并在这个地址中插入需要的客户地址，然后在表单上的浏览器对象中显示结果。但是，如果我更改上述 iframe 中的地址，Google 会给我一条“您的客户无权获取 URL ...”的消息。

我对最终使用的地图服务没有偏好，重要的是该解决方案不能有相关的费用，并且可以从 Windows 表单中使用。

有人对如何解决这个问题有想法/建议/资源吗？

**结果**：

我最终使用了[此处](http://www.codeplex.com/VEarthControl)找到的控件。我发现它是一个“好的”解决方案......由于代码无法按原样工作，因此开始工作很乏味。我很惊讶地发现没有一个流行的地图 API 支持 winforms。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:34:30.337

有[一些用于开发地图查看器控件的示例代码](http://www.koushikdutta.com/2008/07/virtual-earth-and-google-maps-tiled-map.html)（注意：我怀疑这完全在他们的许可范围内）

否则，根据您的预算，您可以使用[MapPoint ActiveX 控件](http://msdn.microsoft.com/en-us/cc905749.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-08T19:25:46.570

直接使用 src="" 中的值作为 WebBrowser 控件的位置，无需 IFRAME。

或者

构建一个包装 IFRAME 的最小 html 文档，将其写入 MemoryStream，重新搜索到开始处，然后使用 MemoryStream 设置 WebBrowser 控件的 DocumentStream 属性。

私服

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:00:04.587

Google Maps 和 Live Maps 都有一个公共 api。

由于您正在使用 winforms，因此我可能会使用实时地图。

[http://dev.live.com/VirtualEarth/](http://dev.live.com/VirtualEarth/)

CodePlex 上有几个例子。

[http://codeplex.com/Project/ProjectDirectory.aspx?TagName=Virtual%20Earth](http://codeplex.com/Project/ProjectDirectory.aspx?TagName=Virtual%20Earth)

# c# - 有没有比 () => 更好的方法来表达无参数的 lambda？

> ID：424775
> 
> 赞同：40
> 
> 时间：2009-01-08T15:53:01.013
> 
> 标签：c#, lambda

`()`看起来很傻。有没有更好的办法？

例如：

`ExternalId.IfNotNullDo(() => ExternalId = ExternalId.Trim());`

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-25T08:30:16.060

有点！镇上有一个新的成语，很好，在某些情况下可能对您有所帮助。这并不完全是你想要的，但有时我认为你会喜欢它。

由于下划线（“_”）是一个有效的 C# 标识符，因此在您打算忽略该参数的情况下，将其用作 lambda 的参数名称已成为一种常见的习惯用法。如果其他编码人员知道该惯用语，他们将立即知道该参数无关紧要。

例如：

```
ExternalId.IfNotNullDo( _ => ExternalId=ExternalId.Trim()); 
```

易于打字，传达您的意图，也更容易在眼睛上。

当然，如果您将 lambda 传递给需要表达式树的东西，这可能不起作用，因为现在您传递的是单参数 lambda 而不是无参数 lambda。

但在很多情况下，这是一个不错的解决方案。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-08T15:56:00.260

对于 lambda，不：你需要`() =>`

是代表还是表达？对于代表，另一种选择是`delegate {...}`. 这可能是可取的，也可能不是可取的，具体取决于场景。它是更多的键，当然......

在某些情况下（不是这个），您可以直接使用目标方法 - 即

```
ExternalId.IfNotNullDo(SomeMethod); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-08T15:55:34.613

不，没有。Lambda 表达式针对单参数情况进行了优化（在语法方面）。

我知道 C# 团队会感受到你的痛苦，并试图找到替代方案。是否会有一个是另一回事。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-08T16:13:16.963

本质上，您正在寻找的是`??`null 合并运算符的逆运算符（在幕后调用`Nullable<T>.GetValueOrDefault()`） - 问题是 C# 没有提供简洁的 OOTB 答案。

不知道你在做什么，但你在做什么：

```
ExternalId.IfNotNullDo(()=>ExternalId=ExternalId.Trim()); 
```

您可能还会发现以下用途：

```
class NullExtensions
{
    public T DefaultOr<T>( this T that, Func<T> transform)
    {
        return that!=default(T) ? transform(that) : default(T);
    }
} 
```

这将启用：

```
var result = input.DefaultOr( _ => _.Trim()); 
```

（一般来说，我会尽量避免重用/改变变量，就像你正在做的那样，而是采用引入解释变量/拆分临时变量的方向，即使用新变量而不是`value = value.DefaultOr( _ => _.Trim());`）

# asp.net-mvc - ASP.NET MVC - 从单个控制器操作返回不同的视图是一个坏主意吗？

> ID：424781
> 
> 赞同：8
> 
> 时间：2009-01-08T15:54:05.363
> 
> 标签：asp.net-mvc

我正在开发一个 ASP.NET MVC 项目，我正在使用路由来生成友好的 URL，并且遇到了一个我不确定如何最好地解决的问题。

我设置的路由如下所示

{类别}

{类别}/{制造商}

{类别}/{制造商}/{产品}

我遇到的问题是我想以不同的方式显示对同一路线的匹配。例如

类别 1 显示器

*   描述后跟
*   一个图像后跟一个
*   产品清单

Category2 显示器

*   一个图像后跟
*   促销活动后跟
*   描述

我通过将枚举 ViewTemplate 与类别关联然后返回具有相同名称的视图来解决这个问题，但这感觉不对，首先因为我不确定我应该在控制器操作中采用这样的逻辑和此外，我仍在进行相同的数据库调用，这对于某些东西来说很好，但如果一个类别有 500 个产品，我仍然会将它们从数据库中提取出来，即使是 Category2，当它们不会被使用时也是如此。现在说重点：

1.  从同一个控制器操作返回不同的视图是否错误？
2.  您将如何处理为每个视图加载不同的数据？
3.  如果我错了（我认为我错了）我应该怎么做这样的事情？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T16:10:23.087

我不是这里的专家，但在其他 MVC 框架中，我做过（并看到过）类似的事情。控制器的工作是根据谁在询问、询问什么等来确定返回哪个 View。如何确定 View 名称实际上是最适合您的应用程序和/或其可修改性/可测试性的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T17:37:50.880

在 MVC 中，控制器负责决定返回哪个视图，因此拥有一个返回多个不同视图的控制器是完全正常的。控制器应该相对简单。他们应该接受客户的指示。访问模型以启动任何需要进行的更改。从模型中获取一些数据。并使用这些数据来决定向客户端显示哪个视图。

在您的情况下，我认为控制器要做的适当的事情是：

1.  获取有关产品的一些一般信息。
2.  使用此一般信息来决定使用哪个视图。
3.  获取该特定视图的数据。
4.  返回视图。

我认为，如果您担心自己做错了，则需要确保模型仅包含在域上下文中有意义的方法。它们不应该与特定视图过于紧密地联系在一起。例如 Product.GetDataForMiniProductView(int id) 错误，这应该是控制器逻辑。另一方面 Product.GetStockCount 绝对应该在模型中而不是控制器中。

# vb.net - 无法加载 因为它不在Appbase下

> ID：424798
> 
> 赞同：8
> 
> 时间：2009-01-08T15:56:58.323
> 
> 标签：vb.net, nunit, watin

我通过在目录中选择我的测试项目创建了一个[NUnit](http://en.wikipedia.org/wiki/NUnit)项目 (NunitLoginTest.nunit)，`nunit\bin`现在我正在尝试加载该项目，但它给了我以下错误。

> 无法加载 因为它不在 Appbase 下，所以无法加载文件或程序集“nunitLogintest”或其依赖项之一。系统找不到指定路径

它与什么有关？我还检查了我的配置文件。我从控制台运行它。

### 更新：

我想启动 NUnit，然后它应该加载我在某个目录中的 Visual Studio 项目，然后运行所有测试（如果我没有在任何 NUnit 项目中定义它）。

实际上我想创建一个批处理文件来运行所有这些。当我这样做时，它不会加载项目。我在环境变量中定义了 c:\Program Files\nunit\bin 路径。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-04-01T03:06:31.437

在某些情况下，您必须自己填写 ApplicationBase。主菜单，Project，Edit，填写DLL文件所在的ApplicationBase。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-08T16:18:30.480

当我运行我的 NUnit 测试时，我没有创建 XXX.nunit 项目文件。在控制台我输入：

```
nunit-console.exe c:\myproject\bin\myproject.test.dll 
```

在您的情况下，您有一个 .nunit 文件，其中列出了要测试的程序集。确保文件中的路径从执行 nunit-console.exe 的位置正确解析。我的示例具有程序集的完整路径，因此我可以从任何地方运行 nunit-console.exe。

nunit 文件如下所示：

```
<NUnitProject>
  <Settings activeconfig="Debug" appbase="C:\dev\Community\src\" />
  <Config name="Debug" appbase="C:\dev\Community\src" binpathtype="Auto">
    <assembly path="Profile.Test\bin\Debug\Profile.Test.dll" />
    <assembly path="Roster.Test\bin\Debug\Roster.Test.dll" />
  </Config>
  <Config name="Release" binpathtype="Auto" />
</NUnitProject> 
```

appbase 设置指示在何处对要测试的程序集进行微调。所以程序集的完整路径是 appbase + 程序集路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T04:11:29.290

如果在 VISTA 下运行，您必须是管理员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T12:45:10.987

我在 Vista 上遇到了相同的“无法加载，因为它不在 Appbase 下”消息。

原因是我试图将 nunit 项目保存在 nunit 程序目录中。

我将保存的位置更改为文档中的某个位置，并且效果很好。我认为如果我按照 reddy 的建议以管理员身份登录，它也会起作用。

# user-interface - 如何在 yui TreeView 中获取当前聚焦的节点

> ID：424799
> 
> 赞同：1
> 
> 时间：2009-01-08T15:57:01.350
> 
> 标签：user-interface, treeview, yui

我需要将当前具有焦点的节点存储在 yui TreeView 组件中。我认为会有一种方法可以随时找到哪个节点有焦点，但似乎找不到。

有谁知道这种方法是否存在或建议一种方法来做到这一点？

提前致谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T07:36:19.423

TreeView 的下一个 (2.7) 版本将具有 TreeView.currentFocus 属性，该属性将指向具有焦点的节点。

在 2.6 中，一种替代方法是使用 Dom getElementsByClassName 并在 HTML 中搜索具有类名“ygtvfocus”的任何元素的树，然后使用 TreeView 方法 getNodeByElement，它应该告诉您它是哪个节点。

将至少返回两个带有焦点 className 的元素，一个是切换图标，另一个是标签。他们中的任何一个都可以，只要记住它是你那里的一个数组。

# algorithm - 从数字数组中获取最小值或最大值的最佳方法是什么？

> ID：424800
> 
> 赞同：40
> 
> 时间：2009-01-08T15:57:19.570
> 
> 标签：algorithm, actionscript-3, apache-flex, actionscript, complexity-theory

假设我有一个数字数组：`[2,3,3,4,2,2,5,6,7,2]`

在该数组中找到最小值或最大值的最佳方法是什么？

现在，为了获得最大值，我正在遍历数组，如果变量大于现有值，则将其重置为该值：

```
var myArray:Array /* of Number */ = [2,3,3,4,2,2,5,6,7,2];

var maxValue:Number = 0;

for each (var num:Number in myArray)
{
    if (num > maxValue)
        maxValue = num;
} 
```

这似乎不是执行此操作的最佳执行方式（我尽量避免循环）。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-01-08T23:51:41.577

其他人的理论答案都很简洁，但让我们务实。ActionScript 提供了您需要的工具，因此在这种情况下您甚至不必编写循环！

首先，请注意`Math.min()`and`Math.max()`可以接受任意数量的参数。此外，了解对象`apply()`可用的方法也很重要`Function`。它允许您使用`Array`. 让我们利用两者：

```
var myArray:Array = [2,3,3,4,2,2,5,6,7,2];
var maxValue:Number = Math.max.apply(null, myArray);
var minValue:Number = Math.min.apply(null, myArray); 
```

这是最好的部分：“循环”实际上是使用本机代码（在 Flash Player 中）运行的，因此它比使用纯 ActionScript 循环搜索最小值或最大值要快。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-08T16:00:53.620

没有任何可靠的方法可以在不测试每个值的情况下获得最小值/最大值。您不想尝试排序或类似的事情，遍历数组是 O(n)，这比任何排序算法在一般情况下都可以做的更好。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-07-26T07:41:50.860

如果

1.  数组未排序
2.  找到最小值和最大值是同时完成的

然后有一种算法可以在 3n/2 次比较中找到最小值和最大值。需要做的是成对处理数组的元素。该对中的较大者应与当前最大值进行比较，而该对中的较小者应与当前最小值进行比较。此外，如果数组包含奇数个元素，则需要特别小心。

在 c++ 代码中（从 Mehrdad 借用一些代码）。

```
struct MinMax{
   int Min,Max;
}

MinMax FindMinMax(int[] array, int start, int end) {
   MinMax  min_max;
   int index;
   int n = end - start + 1;//n: the number of elements to be sorted, assuming n>0
   if ( n%2 != 0 ){// if n is odd

     min_max.Min = array[start];
     min_max.Max = array[start];

     index = start + 1;
   }
   else{// n is even
     if ( array[start] < array[start+1] ){
       min_max.Min = array[start];
       min_max.Max = array[start+1];
     }
     else{
       min_max.Min = array[start+1];
       min_max.Max = array[start];
     }
     index = start + 2;
   }

   int big, small;
   for ( int i = index; i < n-1; i = i+2 ){
      if ( array[i] < array[i+1] ){ //one comparison
        small = array[i];
        big = array[i+1];
      }
      else{
        small = array[i+1];
        big = array[i];
      }
      if ( min_max.Min > small ){ //one comparison
        min_max.Min = small;
      }
      if ( min_max.Max < big ){ //one comparison
        min_max.Max = big;
      }
   }

   return min_max;
} 
```

很容易看出它需要的比较次数是 3n/2。循环运行 n/2 次，并且在每次迭代中执行 3 次比较。这可能是可以达到的最佳状态。目前，我无法指出确切的来源。（但是，我想我已经在某处看到了证明。）

上面 Mehrdad 给出的递归解决方案可能也实现了这个最少的比较次数（最后一行需要更改）。但是，由于他提到的函数调用的开销，在相同数量的比较下，迭代解决方案总是会击败递归解决方案。但是，如果一个人只关心找到几个数字的最小值和最大值（就像 Eric Belair 所做的那样），那么没有人会注意到今天的计算机与上述任何一种方法有什么不同。对于大型阵列，差异可能很大。

尽管这个解决方案和 Matthew Brubaker 给出的解决方案具有 O(n) 复杂度，但在实践中应该仔细评估所涉及的隐藏常数。他的解决方案中的比较次数是 2n。与 2n 比较相比，使用 3n/2 比较的解决方案获得的加速是显而易见的。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-01-08T16:10:07.360

除非对数组进行排序，否则这是您将获得的最好结果。如果是排序的，只取第一个和最后一个元素。

当然，如果它没有排序，那么首先排序并抓住第一个和最后一个保证比只循环一次效率低。即使是最好的排序算法也必须多次查看每个元素（每个元素平均 O(log N) 次。总共 O(N*Log N)。简单的一次扫描只需 O(N)。

如果您想快速访问数据结构中的最大元素，请查看堆，以找到一种将对象保持在某种顺序中的有效方法。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-08T16:03:57.170

您必须遍历数组，没有其他方法可以检查所有元素。只需对代码进行一次更正 - 如果所有元素均为负数，则 maxValue 最后将为 0。您应该使用整数的最小可能值对其进行初始化。
如果您要多次搜索数组，最好先对其进行排序，而不是搜索更快（二分搜索），并且最小和最大元素只是第一个和最后一个。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-08T16:06:56.587

取决于你所说的“最佳”。从理论的角度来看，解决问题的时间比`O(n)`确定性图灵机少。

天真的算法太循环和更新最小值，最大值。但是，如果您想同时获得 min，max，递归解决方案将需要比朴素算法更少的比较（由于函数调用开销，它不一定更快）。

```
struct MinMax{
   public int Min,Max;
}

MinMax FindMinMax(int[] array, int start, int end) {
   if (start == end)
      return new MinMax { Min = array[start], Max = array[start] };

   if (start == end - 1)
      return new MinMax { Min = Math.Min(array[start], array[end]), Max = Math.Max(array[start], array[end]) } ;

   MinMax res1 = FindMinMax(array, start, (start + end)/2);
   MinMax res2 = FindMinMax(array, (start+end)/2+1, end);
   return new MinMax { Min = Math.Min(res1.Min, res2.Min), Max = Math.Max(res1.Max, res2.Max) } ;
} 
```

最简单的解决方案是排序并获取第一个和最后一个项目，尽管它显然不是最快的；）

在性能方面，找到最小值**或**最大值的最佳解决方案是您编写的简单算法（使用单个循环）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-08-27T13:47:18.380

Math.max() 实际上是编译为 AVM2 操作码的 as3 代码，因此并不比任何其他 as3 代码更“原生”。因此，它不一定是最快的实现。

实际上，鉴于它适用于 Array 类型，它比精心编写的代码 usign Vector 慢：

我使用 gskinner 的 PerformanceTest（向量和数组填充了相同的随机数）对 Math.max 的几个简单的向量和数组实现进行了快速基准比较。使用最新的 AIR SDK/发布播放器（闪存播放器 WIN 14,0,0,122 RELEASE，使用 AIR SDK 14 编译），最快的 Vector 实现似乎比 Math.max 快 3 倍以上：

1,000,000 个值的平均时间为 3.5 毫秒，而 Math.max() 的平均值为 11 毫秒：

```
function max(values:Vector.<Number>):Number
{
    var max:Number = Number.MIN_VALUE;
    var length:uint = values.length;
    for (var i:uint = 0; i < length ; ++i)
        if (values[i] > max)
            max = values[i];
    return max;
} 
```

结论是，如果你关心性能，你应该首先在任何地方使用 Vector over Array，而不是总是依赖默认实现，尤其是当它们强制使用 Array 时

PS：使用 for each() 循环的相同实现要慢 12 倍......！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-08T16:12:27.573

如果您只构建*一次*数组并且只想找到最大值一次，那么迭代是您能做的最好的事情。

当您想修改数组并且偶尔想知道最大元素时，您应该使用[Priority Queue](http://en.wikipedia.org/wiki/Priority_queue)。最好的数据结构之一是[Fibonacci Heap](http://en.wikipedia.org/wiki/Fibonacci_heap)，如果这太复杂，请使用较慢但仍然不错的[Binary Heap 。](http://en.wikipedia.org/wiki/Binary_heap)

要找到最小值和最大值，只需构建两个堆并更改其中一个中的数字的符号。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-08T16:18:50.043

这取决于现实世界的应用需求。

如果您的问题只是假设性的，那么基础知识已经解释过了。这是一个典型的搜索与排序问题。已经提到，在这种情况下，在算法上你不会比 O(n) 更好。

但是，如果您正在研究实际用途，事情会变得更加有趣。然后，您需要考虑数组有多大，以及从数据集中添加和删除所涉及的过程。在这些情况下，最好通过动态排序在插入/删除时进行计算“命中”。插入预先排序的数组并不昂贵。

对 Min Max 请求的最快查询响应将始终来自排序数组，因为正如其他人所提到的，您只需获取第一个或最后一个元素 - 给您 O(1) 成本。

有关所涉及的计算成本和大 O 表示法的更多技术解释，请在[此处](http://en.wikipedia.org/wiki/Big_O_notation)查看 Wikipedia 文章。

缺口。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-28T21:21:30.250

请考虑到对数组进行排序只会比循环到特定大小的数组更快。如果您的阵列很小（并且任何时候都会如此），那么您的解决方案非常好。但是如果它可能变得太大，您应该在数组较小时使用条件使用排序方法，而在数组太大时使用正常迭代

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-08T16:29:50.520

如果你想同时找到最小值和最大值，循环可以修改如下：

```
int min = int.maxValue;
int max = int.minValue;

foreach num in someArray {
  if(num < min)
    min = num;
  if(num > max)
    max = num;
} 
```

这应该可以实现 O(n) 时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-02-06T03:39:29.497

最短的方式：

Math.min.apply(null,array); //这将从数组中返回最小值
Math.max.apply(null,array); //这将从数组中返回最大值

从数组中获取最小值和最大值的其他方式

```
 function maxVal(givenArray):Number
    {
    var max = givenArray[0];
    for (var ma:int = 0; ma<givenArray.length; ma++)
    {
    if (givenArray[ma] > max)
    {
    max = givenArray[ma];
    }
    }
    return max;
    }

    function minVal(givenArray):Number
    {
    var min = givenArray[0];
    for (var mi:int = 0; mi<givenArray.length; mi++)
    {
    if (givenArray[mi] < min)
    {
    min = givenArray[mi];
    }
    }
    return min;
    } 
```

如您所见，这两个函数中的代码非常相似。该函数设置一个变量 - 最大值（或最小值），然后使用循环遍历数组，检查每个下一个元素。如果下一个元素高于当前元素，则将其设置为最大值（或最小值）。最后，返回数字。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-11-12T20:07:13.320

有多种方法可以做到这一点。

1.  蛮力。分别线性搜索最小值和最大值。**（2N 个比较和 2N 个步骤）**
2.  线性迭代并检查每个数字的最小值和最大值。**（2N 个比较）**
3.  使用分而治之。**（在 2N 和 3N/2 比较之间）**
4.  下面解释的成对比较**（3N/2 比较）**

[如何找到最大值。和分钟。在数组中使用最小比较？](https://stackoverflow.com/questions/13544476/how-to-find-max-and-min-in-array-using-minimum-comparisons)

* * *

如果您真的对速度、运行时间和比较次数感到偏执，请参阅 [http://www.geeksforgeeks.org/maximum-and-minimum-in-an-array/](http://www.geeksforgeeks.org/maximum-and-minimum-in-an-array/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-06-17T18:06:27.143

以下是 o(n) 的解决方案：-

```
public static void findMaxAndMinValue(int A[]){
    int min =0, max = 0;
    if(A[0] > A[1] ){
        min = A[1];
        max = A[0];
    }else{
        max = A[1];
        min = A[0];
    }
    for(int i = 2;i<A.length ;i++){
        if(A[i] > max){
            max = A[i];
        }
        if(min > A[i]){
            min = A[i];
        }
    }
    System.out.println("Maxinum Value is  "+min+" & Minimum Value is  "+max);
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-03-21T09:26:51.003

很惊讶没有人在这里提到并行性。

如果你真的有一个巨大的数组，你可以在子范围上使用 parallel-for。最后比较所有子范围。但是并行性也会带来一些损失，因此这不会在小型阵列上进行优化。但是，如果您拥有庞大的数据集，它就开始变得有意义了，并且您会获得接近执行测试的线程数量的时间划分减少。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2018-10-24T16:00:32.117

**从数组中查找最大值** 让我们看看如何使用单个函数获取最小值、最大值

```
public void findMaxValue(){
   int[] my_array = {1,2,,6,5,8,3,9,0,23};
   int max = my_array[0];
   for(int i=1; i<my_array.length; i++)
   {
      if(my_array[i] > max)
         max = my_array[i];
   }
   return max; 
} 
```

查找最小值也可以做同样的事情

* * *

## 回答 #17

> 赞同：-5
> 
> 时间：2009-01-23T22:34:00.820

看了大家的评论（感谢大家的关注），我发现“最好”的方式（代码量最少，性能最好）就是简单地对Array进行排序，然后抓取Array中的第一个值：

```
var myArray:Array /* of Number */ = [2,3,3,4,2,2,5,6,7,2];

myArray.sort(Array.NUMERIC);

var minValue:int = myArray[0]; 
```

这也适用于对象数组 - 您只需使用 Array.sortOn() 函数并指定一个属性：

```
// Sample data
var myArray:Array /* of XML */ = 
    [
    <item level="2" name="a" />
    <item level="3" name="b" />
    <item level="3" name="c" />
    <item level="2" name="d" />
    <item level="5" name="e" />
    ]

// Perform a descending sort on the specified attribute in Array to get the maximum value
myArray.sortOn("@level", Array.DESCENDING | Array.NUMERIC);

var lowestLevel:int = myArray[0].@level; 
```

我希望有一天这对其他人有所帮助！

# asp.net - WF 中具有多个 SendActivity 活动的同一会话

> ID：424806
> 
> 赞同：1
> 
> 时间：2009-01-08T15:58:36.103
> 
> 标签：asp.net, cookies, workflow, workflow-foundation

我们在**Workflow Foundation**中的工作流曾经使用**InvokeWebService**活动调用 ASMX Web 服务，该活动有一个属性**SessionId**来关联同一会话中的多个活动（通过**在每个请求上发送 ASP.NET 会话 cookie**）。有效。

现在我们已经切换到**WCF** Web 服务界面，并且我们已经更改了我们的工作流以使用**SendActivity**活动。但是，我们还没有找到任何解决方案来关联 Web 服务调用，即在每个请求上发送会话 cookie。

是否有可能在 WF 中实现这一点，还是我们需要自定义解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T13:17:32.957

**我不知道在任何WF/WCF 集成**活动（**SendActivity**和**ReceiveActivity**）中处理 cookie 的任何内置工具。这是有道理的，因为 WCF 与传输无关，因此在较高级别上，API 不能耦合到任何 HTTP 特定功能，例如**ASMX Web 服务**。

您的解决方案可能是通过使用**basicHttpBinding**的端点公开 WCF 服务，该端点与 ASMX Web 服务支持的协议兼容，然后恢复使用**InvokeWebServiceActivity**来调用它们。

此外，由于可以通过**任意数量的端点**公开 WCF 服务，因此您可以简单地将使用 basicHttpBinding 的端点添加到已经存在的端点中。这是一个例子：

```
<configuration>
    <system.serviceModel>
        <services>
            <service name="MyNamespace.MyServiceImpl">
                <endpoint binding="wsHttpBinding" name="WsHttp"
                    contract="MyNamespace.IMyService" />
                <endpoint address="basic" binding="basicHttpBinding" name="BasicHttp"
                    contract="MyNamespace.IMyService" />
                <host>
                    <baseAddresses>
                        <add baseAddress="http://localhost/myservice" />
                    </baseAddresses>
                </host>
            </service>
        </services>
    </system.serviceModel>
</configuration> 
```

然后使用**InvokeWebServiceActivity**的工作流将使用以下 URL 调用服务：

> [http://localhost/myservice/basic](http://localhost/myservice/basic)

# javascript - 字符串.替换；替换为函数结果问题

> ID：424826
> 
> 赞同：0
> 
> 时间：2009-01-08T16:04:06.670
> 
> 标签：javascript

我有这段代码：

```
var myObj = function () {
   this.complex = function (text) { /* long piece of code */ }
   this.parse(text) {
     return text.replace(/valid_pattern/gi, function ($1) { return this.complex($1); } );
   }
} 
```

当然调用**this.complex($1)**不会成功，因为我在匿名函数的范围内。**我也无法使用.call(this)**语句重新定义匿名函数的范围，因为在这种情况下，我会丢失通过*String.replace*传递给函数的参数。

到目前为止，我正在使用对象的具体实例。这是我的解决方案：

```
var instance = new myObj;
var myObj = function () {
   this.complex = function (text) { /* long piece of code */ }
   this.parse(text) {
     return text.replace(/valid_pattern/gi, function ($1) { return instance.complex($1); } );
   }
} 
```

到目前为止，它足以满足我的需求，但**我想知道是否有任何通用的解决方案**可以解决这个问题。到目前为止，唯一对我有用的想法是：

```
function ($1) { return (new myObj).complex($1); } 
```

......存在严重的性能问题。任何想法将不胜感激。

——D。

PS对不起我的英语，这不是我的第一语言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T16:08:31.450

也许尝试：

```
var myObj = function () {
   this.complex = function (text) { /* long piece of code */ }
   this.parse(text) {
     var that = this;
     return text.replace(/valid_pattern/gi, function ($1) { return that.complex($1); } );
   }
} 
```

这是最有用的技巧之一 :-)

**更新：诀窍不是我的，我是从**[Douglas Crockford](http://javascript.crockford.com/)那里学到的（就像我对 Javascript 的大部分了解一样）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:17:01.547

这就是原型和其他人所做的

```
// Monkey Patching, not everyone likes it
Function.prototype.bind = function( obj ) {
    var _this = this;
    return function() {
        return _this.apply( obj, arguments )
    }
} 
```

现在你可以这样做

```
var myObj = function () {
   this.complex = function (text) { /* long piece of code */ }
   this.parse = function(text) {
     return text.replace(/valid_pattern/gi, function ($1) { return this.complex($1); }.bind( this ) );
   }
}

O = new myObj();
alert( O.parse( 'some text' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:07:35.650

为此声明一个变量。

```
var myObj = function () {
  var foo = this.complex = function (text) { /* long piece of code */ }
  this.parse(text) {
    return text.replace(/valid_pattern/gi, foo );
  }
} 
```

# c# - 检测文件是否被另一个进程（或者实际上是同一个进程）锁定

> ID：424830
> 
> 赞同：20
> 
> 时间：2009-01-08T16:05:34.217
> 
> 标签：c#, .net

这就是我目前的做法。我尝试在 FileShare 设置为 none 的情况下打开文件。所以我想要对文件的独占访问权。如果我不能得到它，那么它是一个很好的赌注其他人已锁定文件。

必须有更好更快的方法。有任何想法吗？

```
 try
            {
                using (FileStream fs = File.Open(GetLockFilename(), FileMode.Open, FileAccess.ReadWrite, FileShare.None))
                {
                    fs.Close();
                }
                // The file is not locked
            }
            catch (Exception)
            {
                // The file is locked
            } 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-08T16:08:46.630

没有必要先检查文件是否被锁定然后访问它，因为在检查和访问之间，一些其他进程可能仍然会锁定文件。所以，你做的是正确的，如果你成功了，就用文件做你的工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T16:10:46.250

事实是，即使您确实找到了一种方法来检查文件是否在您打开文件的下一行时被“锁定”，操作系统中的其他东西可能会尝试获取该文件，并且您打开它的代码无论如何都会失败。无论如何，你必须在那里尝试/捕捉。因此，我说不。真的没有更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T16:09:21.043

不，我知道，没有调用来检查文件是否正在使用 - 你必须尝试打开它并像你一样处理异常。另一个问题是很难区分正在使用和不允许访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-08T16:21:36.797

要回答您的问题，为 FileInfo 类编写以下扩展方法会更有效：

```
 public static bool IsLocked(this FileInfo f)
    {
            try 
            {
                string fpath = f.FullName;
                FileStream fs = File.OpenWrite(fpath);
                fs.Close();        
                return false;
            }

            catch (Exception) { return true; }      
    } 
```

创建方法后，您可以像这样进行快速检查：

```
 FileInfo fi = new FileInfo(@"C:\4067918.TIF");
  if (!fi.IsLocked()) { //DO SOMETHING HERE; } 
```

# html - 基于 CGI-BIN 的 Web 开发的主要缺点是什么？

> ID：424839
> 
> 赞同：5
> 
> 时间：2009-01-08T16:08:49.080
> 
> 标签：html, cgi, cognos, cgi-bin

我很幸运没有进行任何基于 cgi-bin .cgi 的 Web 开发。但一般来说，那些拥有的人似乎并没有“怀念”那些日子。

我最近加入的一个项目在处理需要与具有基于 CGI-BIN 的 API 的遗留系统通信的页面时存在性能问题。该系统是 COGNOS 7。

迄今为止我收到的反馈是“COGNOS 很慢”，但其他人报告说 COGNOS 取得了巨大的成功，我认为这更多地与通过 CGI-BIN 的访问有关，而不是与 COGNOS 本身的性能有关。

所有这一切都说明了导致基于 CGI-BIN 的 Web 开发性能不佳、困难等的主要问题是什么……

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T16:16:32.823

基于 CGI-BIN 的系统的基本架构问题是每个 HTTP 请求都需要服务器启动一个新进程。这会以多种方式影响性能：

*   启动进程的成本很高，因为程序中的操作系统页面会设置进程等。
*   资源不能跨请求共享，因此每个请求都必须设置任何数据库连接等
*   用户会话状态不能保存在内存中，因此必须与每个请求一起持久化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T15:49:52.247

对我来说，CGI 最大的痛苦是我的 CGI 程序每次启动时都必须“学习”所有内容。如果他们一直在运行，那当然不会是这样……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:14:09.537

恕我直言，主要缺点与所有较低级别的编码具有相同的缺点-您必须在实现域中进行编程，而不是在问题域中进行编程。最终结果本质上是相同的——基于 HTTP 请求将 HTTP 响应发送到客户端。然而，从编程的角度来看，要*做到*这一点要困难得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-23T09:10:41.493

Apache 为各种语言（例如[mod_perl](http://perl.apache.org/)）提供了几种解决方案，因此脚本只被调用一次，然后保存在内存中以便快速检索。仍然有很多 GCI 协议驱动的站点，如果编码和设置良好，其中许多都以相当低的延迟运行。

# c# - 检查null，哪个更好？“空==”或“==空”

> ID：424842
> 
> 赞同：2
> 
> 时间：2009-01-08T16:09:31.947
> 
> 标签：c#, .net, null

**欺骗：[空差](https://stackoverflow.com/questions/302701/null-difference)**

一生前，我看到一篇文章解释了以下不相等（在 c# 中）：

```
if (o == null) {}
if (null == o) {} 
```

该文章解释说，后者是首选，因为它导致更准确的测试。从那以后我就一直这样编码。现在我明白了很多，我一直在寻找这篇文章或其他类似的文章，看看确切的发现是什么，但我找不到关于这个主题的任何东西。

想法？有区别吗？第一眼会说不。但是谁知道在 IL 和 C# 编译的内部会发生什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T16:11:29.947

阻止你打字是一个老习惯`if (o = null)`。if (null = o) 是语法错误。在 C# 中有点毫无意义，因为空值永远不会被强制转换为布尔值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T16:13:07.307

后者是 C/C++ 时代的遗留物，可能会意外地分配一个值而不是比较。C# 不允许你这样做，所以要么/要么是可以接受的（但我发现前者更具可读性）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T16:12:30.273

在 c# 中没有区别。C/C++ 开发人员的一个旧习惯是避免出现以下语法正确的常见错误：

```
if(o = null) 
```

在 C# 中它不会编译，但在 C 和 C++ 中它会，给你留下一个非常讨厌的错误。所以很多人习惯了

```
if(null == o) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T16:11:57.917

与 C# 无关，这是来自 C。请参阅[此问题](https://stackoverflow.com/questions/399792/inadvertent-use-of-instead-of)进行讨论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T16:18:17.953

我使用 Java ..我确实有在 LHS 上使用常量进行所有交换比较的习惯。

```
"name".equals(name)

 null == obj

"55".compareTo(numString) 
```

等等...只是避免不必要的 NullPointerExceptions...

# architecture - 框架与 SDK

> ID：424846
> 
> 赞同：40
> 
> 时间：2009-01-08T16:10:22.960
> 
> 标签：architecture, frameworks, sdk, semantics

框架和 SDK 有什么区别？以 MS 平台 SDK 和 .NET 框架为例。两者都有 API，都隐藏了它们的内部工作，并且都提供了可能无法快速/轻松访问的功能（换句话说，它们服务于现实世界的目的）。

那么有什么区别呢？它主要是一种语义营销游戏，还是期望开发人员与软件交互的方式存在实际差异（相反，开发人员期望软件的行为方式）？预计一个比另一个更高或更低，等等？

谢谢！

编辑：这个问题一般适用于 SDK 和框架，而不仅仅是上面提到的两个。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-01-08T19:13:32.670

我只是从维基百科复制：

图书馆：

> 库是用于开发软件的子程序或类的集合。库包含为独立程序提供服务的代码和数据。这允许以模块化方式共享和更改代码和数据。

框架：

> 在计算机编程中，软件框架是一种抽象，其中提供通用功能的通用代码可以被提供特定功能的用户代码选择性地覆盖或专门化。框架类似于软件库，因为它们是包装在定义良好的 API 中的可重用代码抽象。然而，与库不同的是，整个程序的控制流不是由调用者决定的，而是由框架决定的。这种控制反转是软件框架的显着特征。

开发工具包：

> 软件开发工具包（SDK 或“devkit”）通常是一组开发工具，允许软件工程师为特定软件包、软件框架、硬件平台、计算机系统、视频游戏控制台、操作系统或类似物创建应用程序平台。它可能是一些简单的应用程序编程接口，以某些文件的形式与特定的编程语言接口，或者包括复杂的硬件来与某个嵌入式系统进行通信。常用工具包括 IDE 中经常出现的调试辅助工具和其他实用程序。SDK 还经常包含示例代码和支持技术说明或其他支持文档，以帮助阐明主要参考材料中的要点。

所以：

*   库是您的应用程序调用的代码。
*   框架是几乎现成的应用程序或库。您只需使用框架调用的您自己的代码填充一些空白点。
*   SDK 是一个更大的概念，因为它可以包括库、框架、文档、工具等。
*   .NET 更像是一个平台，而不是一个软件框架。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-08T16:15:07.723

SDK 应提供针对特定系统资源或功能进行编程的工具。不一定是框架（尽管 .NET 提供了一整套工具，例如编译器等 - 但无论如何这些工具都是必需的）。

因此，您可以开发一个仅由库组成的框架，但如果您将其称为 SDK，您将有望提供一些支持开发的东西。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-08T16:20:08.603

简而言之，区别在于：

*   您调用 SDK 函数。
*   框架调用您的函数。

SDK 就像一个包含许多工具的工具箱，您可以选择使用哪些工具以及如何使用。你有控制权，但也有很多决定要做。那是相当低的水平。

一个框架为你做了很多决定，所以你不必重新发明轮子；这更像是一种“填空”的方法。更少的自由，但你可以节省很多时间，并且可能避免一些错误。

在 .NET 框架的特定情况下，它还指使用它运行应用程序所需的运行时文件，但这不是在编程上下文中使用这个词的方式......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-08T16:15:42.293

开发人员可以使用 Microsoft SDK 来创建他们的程序。最终用户通常不需要它。

如果您想在机器上运行 .NET 应用程序，Microsoft Framework 是必需的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T16:17:13.897

这是一个灰色地带，但框架往往是您编写代码的库，SDK 通常有额外的工具来帮助您从框架中获得更多收益。一个很好的例子是您单独安装的 .NET Framework SDK，该 SDK 具有额外的工具，例如 ildasm、cordb，它们并不是框架的真正组成部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T18:28:29.937

我是[Zend Framework](http://framework.zend.com) 1.0 版本的负责人。我们经常收到评论说它不是开发人员期望的“框架”——他们说它更像是一个类库。

他们希望一个框架更像是一组*必须*一起使用才能工作的类。框架还可能包含一组编码约定，指导您以某种方式组织代码。此外，框架可能会为您的类和数据库实体强加命名约定。最后，代码生成工具。

Zend Framework 被设计为松耦合，因此如果您愿意，您可以独立使用任何类。它对您的代码或数据库强加了一些约定。我们本来打算开发代码生成器，但还没有实现它们。

但我仍然觉得 Zend Framework 有资格作为一个框架，而不是一个 SDK，以另一种方式：一个框架是**可扩展**的。它被设计为一组面向对象的基类，预期用途是开发人员可以使用`extend`这些类或编写简单的插件类来添加功能。

传统的 SDK**不可扩展**。您只需在提供的类中调用 API 方法，它们会做它们所做的事情，然后您处理结果。任何定制都取决于您对 API 的使用以及您如何使用结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-08T18:58:25.883

类库提供的类通常共享相同的粗略应用领域（数学、渲染），但主要是相互独立地使用。

框架提供的类共同构成了应用程序的基础，您只需扩展和充实即可。

SDK 包含使用 SDK 提供的技术所需的一切。它通常包含文档、示例和工具以及实际的核心内容，这些内容可能是框架或类库，甚至是完全不同的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-29T07:53:02.363

在一个比较中，您可以说：
库 -> 框架 -> SDK
框架由几个库和一些工具（编译器等）组成，并且不针对特定平台。对于一个平台，可能会开发几个框架，每个框架都有不同的用途。SDK 为您提供框架以及为特定平台开发软件所需的一切。

# java - 在 Applet 中绘制画布

> ID：424849
> 
> 赞同：1
> 
> 时间：2009-01-08T16:10:25.223
> 
> 标签：java, graphics, applet, canvas

我目前有一个小型Java 程序，我想在桌面（即在JFrame 中）和applet 中运行它。目前所有的绘图和逻辑都由一个扩展 Canvas 的类处理。这为桌面应用程序提供了一个非常好的主要方法：

```
public static void main(String[] args) {
    MyCanvas canvas = new MyCanvas();
    JFrame frame = MyCanvas.frameCanvas(canvas);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    canvas.loop();
} 
```

我可以为小程序做类似的事情吗？理想情况下，MyCanvas 对于这两种情况都将保持不变。

不确定它是否重要，但我正在使用 BufferStrategy 和`setIgnoreRepaint(true)`.

**编辑**：澄清一下，我的问题似乎是画布——因为所有的画都是通过`canvas.loop()`电话完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T16:15:57.787

[Applet](http://java.sun.com/j2se/1.5.0/docs/api/java/applet/Applet.html)是一个[Container](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Container.html)，只需在其中[添加](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Container.html#add(java.awt.Component))您的 Canvas 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T16:32:35.210

通常，您拥有一个也是 applet 的应用程序的方式是让您的入口点类扩展 Applet，并让其设置将 Canvas 添加到自身，等等。

然后，在主方法版本中，您只需实例化您的 Applet 类并将其添加到新的 Frame（或 JApplet / JFrame 等）。

有关该技术的示例，请参见[此处](http://www.heatonresearch.com/articles/18/page6.html)和[此处](http://www.devx.com/tips/Tip/16650)，这基本上可以归结为（从第一个示例开始）：

```
 public static void main(String args[])
  {
    Applet applet = new AppletApplication();
    Frame frame = new Frame();
    frame.addWindowListener(new WindowAdapter()
    {
      public void windowClosing(WindowEvent e)
      {
        System.exit(0);
      }
    });

    frame.add(applet);
    frame.setSize(IDEAL_WIDTH,IDEAL_HEIGHT);
    frame.show();
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:05:30.913

`Canvas`不适合添加到 Swing 组件。改用`JComponent`（和`setOpaque(true)`）。

Swing 组件应始终在 AWT 事件调度线程 (EDT) 上进行操作。使用`java.awt.EventQueue.invokeLater`（`invokeAndWait`对于小程序）。您不应该从 EDT 执行任何阻塞操作，因此为此启动您自己的线程。默认情况下，您在主线程（或小程序的小程序线程）中运行，这与 EDT 完全分开。

我建议删除您`MyCanvas`对 to的任何依赖`JFrame`。我还建议将使用框架的应用程序代码与使用小程序的代码分开。将组件添加到 a`JApplet`与 for 相同`JFrame`（在这两种情况下都存在恶作剧，实际上发生的是`add`实际调用`getContentPane().add`，这可能会导致一些不必要的混淆）。主要区别在于您不能`pack`使用小程序。

# c# - 如何不使用来自 C# DataSet 的漂亮打印来编写 XML

> ID：424866
> 
> 赞同：8
> 
> 时间：2009-01-08T16:13:45.667
> 
> 标签：c#, xml

在 C# 中，如何将 DataSet 写入文件而不使用漂亮的打印？

使用 C# 和 .NET 2.0，我一直在使用 dataSet.WriteXml(fileName, XmlWriteMode.IgnoreSchema)，它默认使用漂亮的打印来编写 Xml 文件。使用我编写的 Xml 文件的公司建议，没有漂亮的打印不会影响它们，并且会显着减小文件的大小。在 System.Xml 命名空间中进行了一些尝试，我确实找到了解决方案。但是，在我的搜索中，我没有在任何地方找到答案，所以我认为如果我发布这个问题，将来可能会对其他人有所帮助。此外，如果有更好或至少不同的方式来实现这一点，我一点也不感到惊讶。

对于那些不知道的人（直到今天我才知道），Xml“漂亮的打印”是：

```
<?xml version="1.0" standalone="yes"?>
<NewDataSet>
  <Foo>
    <Bar>abc</Bar>
  </Foo>
</NewDataSet> 
```

没有漂亮的打印，它看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?><NewDataSet><Foo><Bar>abc</Bar></Foo></NewDataSet> 
```

此外，大小节省非常显着，70mb 的文件变成了大约 40mb。如果没有其他人，我将在今天晚些时候发布我的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T16:28:07.073

这很简单，你只需要创建一个`XmlWriter`using属性设置为 false`XmlWriterSettings`的对象：`Indent`

```
// The memory stream for the backing.
using (MemoryStream ms = new MemoryStream())
{
  // The settings for the XmlWriter.
  XmlWriterSettings settings = new XmlWriterSettings();

  // Do not indent.
  settings.Indent = false;

  // Create the XmlWriter.
  using (XmlWriter xmlWriter = XmlWriter.Create(ms, settings))
  {
     // Write the data set to the writer.
     dataSet.WriteXml(xmlWriter);
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-08T16:32:43.727

甚至比使用 XmlWriterSettings 更容易：

```
XmlTextWriter xml = new XmlTextWriter(fileName, Encoding.UTF8) 
    { Formatting = Formatting.None };
dataSet.WriteXml(xml); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-08T16:25:39.577

这就是我会尝试的......：

编辑：（不编译，需要在 XmlWriter.Create 构造函数中添加设置 - 但理论就在那里。）

```
DataSet ds = new DataSet();
System.Xml.XmlTextWriter xmlW = new System.Xml.XmlTextWriter("C:\\temp\\dataset.xml");
System.Xml.XmlWriterSettings settings = new System.Xml.XmlWriterSettings();
settings.Indent = false;
settings.NewLineChars = String.Empty;
xmlW.Settings = settings;
ds.WriteXml(xmlW); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T16:23:45.163

如果无法影响数据集 xml 的格式，我只需将 xml 加载到新的 XMLDocument 中并发送格式免费的 XMLDocument.OuterXml。

# c# - 本机类是否可以使用 .NET 事件？

> ID：424880
> 
> 赞同：4
> 
> 时间：2009-01-08T16:16:45.037
> 
> 标签：c#, .net, c++-cli

知道如何初始化指向“混合”类实例中的方法的 .NET 委托吗？

我有这样的“混合”C++ 类：

```
class CppMixClass
{
public:
    CppMixClass(void){
        dotNETclass->StateChanged += gcnew DotNetClass::ServiceStateEventHandler(&UpdateHealthState);
    }
   ~CppMixClass(void);
   void UpdateState(System::Object^ sender, DotNetClass::StateEventArgs^ e){
       //doSmth
   }
} 
```

DotNetClass 是用 C# 实现的，方法声明可以使用委托。此行生成错误：

```
dotNETclass->StateChanged += gcnew DotNetClass::ServiceStateEventHandler(&UpdateHealthState);
error C2276: '&' : illegal operation on bound member function expression 
```

有人对问题有线索吗？也许因为 CppMixClass 类不是纯 .NET (ref) 类？

当 UpdateHealthState 是静态方法时，我让它工作，但我需要指向实例方法的指针。

我尝试过：

```
dotNETclass->StateChanged += gcnew DotNetClass::ServiceStateEventHandler(this, &UpdateHealthState); 
```

但这显然不起作用，因为这不是指向 .NET (ref) 类 (System::Object) 的指针（句柄）。

ServiceStateEventHandler 在 C# 中定义为：

```
public delegate void ServiceStateEventHandler(object sender, ServiceStateEventArgs e); 
```

感谢您阅读本文:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T21:05:46.453

我刚刚找到了答案（当然是 N​​ishant Sivakumar，man 似乎对我所有的 C++/CLI 互操作相关问题都有答案）：

[http://www.codeproject.com/KB/mcpp/CppCliSupportLib.aspx?display=Print](http://www.codeproject.com/KB/mcpp/CppCliSupportLib.aspx?display=Print)

答案位于“msclr/event.h”标题中，其中定义了本机类中代表的宏。

Nish 的代码如下：

```
class Demo5
{
msclr::auto_gcroot<FileSystemWatcher^> m_fsw;
public:
// Step (1)
// Declare the delegate map where you map
// native method to specific event handlers

BEGIN_DELEGATE_MAP(Demo5)
    EVENT_DELEGATE_ENTRY(OnRenamed, Object^, RenamedEventArgs^)
END_DELEGATE_MAP()

Demo5()
{
    m_fsw = gcnew  FileSystemWatcher("d:\\tmp");
    // Step (2)
    // Setup event handlers using MAKE_DELEGATE
    m_fsw->Renamed += MAKE_DELEGATE(RenamedEventHandler, OnRenamed);
    m_fsw->EnableRaisingEvents = true;
}
// Step (3)
// Implement the event handler method

void OnRenamed(Object^, RenamedEventArgs^ e)
{
    Console::WriteLine("{0} -> {1}",e->OldName, e->Name);
}
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:54:47.147

只有 .NET 类型可以使用事件。我建议创建一个新的托管类来处理事件，并在 CppMixClass 中编写该类，并在构造期间将指针传递给 CppMixClass。然后，您的托管事件处理类可以在处理事件时调用 CppMixClass 上的函数。

# javascript - 返回的 AJAX html 中断 IE 点击事件

> ID：424886
> 
> 赞同：2
> 
> 时间：2009-01-08T16:18:20.167
> 
> 标签：javascript, html, ajax, internet-explorer

我有一个分页数据表，以及一个动态创建的寻呼机（服务器端 AJAX 调用，将返回的 HTML 应用于 div 的 innerHTML）。当我在寻呼机上单击下一页时，将向服务器发送一个 AJAX 调用以检索下一组数据，该数据作为 HTML 字符串返回。我解析 HTML 并呈现新的表格行。我还检索寻呼机 HTML 并将其加载到其父 DIV innerHTML 中。到目前为止没有问题。

在 Firefox 中，我可以单击寻呼机，我的所有 javascript 函数都将正常执行。在 IE 中，我的第一次单击现在不会注册，但第二次单击将执行预期的操作。

**什么是 IE 禁用了我返回的 HTML 的第一次点击？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:45:21.720

我不确定您的问题是否与我在回发时遇到的问题有关，但我使用的一些 AJAX 库在页面中插入了额外的控件，导致我的链接中生成的 ID 不再匹配ID 回发事件预期的服务器。

事件正在触发，但是当事件被连接时，单击的链接和侦听器期望的链接对象之间的 ID 不匹配。

但是，在第一次单击后，回发将导致 ID 重新同步，然后第二次单击将能够匹配 ID。

我发现这一点的方法是在第一次点击之前和之后检查链接中的 ID。

同样，我不确定这是发生在你身上的事情。症状相似，但在我的情况下，Firefox 和 IE 都失败了。希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T21:38:45.277

原来我有一个比赛条件。在我从服务器获得响应之前，库（内部编码）正在调用我的回调函数。结果，我的回调函数都没有做任何事情，因为我没有传递有效的值。我设置了一个循环，每十毫秒检查一次值，否则请等待。我从这里修改了教程：

[http://wonko.com/post/how-to-prevent-yui-get-race-conditions](http://wonko.com/post/how-to-prevent-yui-get-race-conditions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:31:07.493

您的寻呼机超链接是否有“#”作为`href`并且您的 JavaScript onclick 事件处理程序是否返回`false`？

我之前在 IE 中看到过这个问题，如果您不`false`从事件处理程序返回，那么第一次单击将跟随超链接（返回到同一页面），但随后的单击将起作用，因为该页面已经被访问过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T07:53:33.727

如果你有竞争条件，你可能想认真地重新考虑你的方法，而不是设置一个计时器。

分页数据是一系列格式相似的项目吗？您可能需要考虑退回到 DOM 级别，删除容器的子元素并在 DOM 中重建它们。在我的分页脚本中，我请求一个 JSON 字符串，然后由请求页面解析。结果是一个对象数组，我可以循环并添加到容器中。它还有助于减少脚本注入的可能性（在处理任何类型的用户提供的内容时，innerHTML 是出了名的危险）。

# java - GWT vs Flex vs？

> ID：424895
> 
> 赞同：37
> 
> 时间：2009-01-08T16:20:40.757
> 
> 标签：java, ajax, apache-flex, gwt

我的公司正试图从**.NET**应用程序迁移到纯粹**基于 Web**且非常“ajaxy”的应用程序。最初的 .NET 应用程序具有相当的交互性，就用户交互而言，大致相当于 Google 地图（缩放、平移、在矢量图上标注特征）。

我们的 .NET 开发人员非常喜欢**Flex2**。我承认我对 Java 有很强的偏见。我也有大约一年的**GWT**经验，并且可以用它很快完成工作。我们的代码库主要是**J2EE**，所以 GWT 似乎很适合我。我对 Flex 的经验为零，所以我真的无法推荐或反对它

我们选择框架的主要兴趣如下：

*   面向未来
*   适用于所有主要浏览器
*   快速响应的用户体验
*   代码应该是可单元测试的
*   代码必须是可维护的
*   开发速度和易用性
*   支持某种矢量图形（SVG 加分）

是否愿意权衡这两种技术的优缺点，甚至推荐第三种选择？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-08T23:21:05.947

我对 Flex 只是稍微熟悉，但与 GWT 合作多年。几年前，我们不得不做出非常相似的决定（Flash 与 GWT），但原因不同。最后，我们看到了 GWT 相对于 Flash 的许多优势（其中很多都适用于 Flex）：

*   并非我们所有的客户都有 Flash，Adobe 的渗透率数字毫无用处，您需要自己的（我们拥有）来查看您的客户实际拥有什么。在企业和教育市场，渗透率实际上远低于 Adob​​e 引用的 90 年代高位。

*   GWT 是真正的跨浏览器和平台兼容（Linux、Mac、Windows、Android、iPhone 等），而 flash 永远不会。你可能不在乎，但我们做到了。

*   Flex 是专有的 Adob​​e 技术，而 GWT 是完全开源和可定制的

*   GWT 与 DOM 集成，页面上的所有其他内容都比 flash 和 Flex 容易得多。

*   GWT 是用 Java 编写的，我们都非常了解 Java

要解决您的具体问题：

```
*  futureproof 
```

没有什么是真正的未来证明，但我认为 GWT 和 Flex 都将是相当未来的证明。也许 GWT 更是如此，因为它是开源的。

```
* works on all major browsers 
```

GWT 适用于 Firefox（和所有 gecko 浏览器）、Safari（和所有 Webkit 浏览器）、IE 和 Opera。Flex 适用于所有浏览器，但前提是支持 Flash，所以我会说 GWT 是最重要的。

```
* fast & responsive user experience 
```

在支持它的平台上，Flex 会为了用户体验而扼杀 GWT。在平滑度和光滑度方面，您无法与闪光灯竞争。

```
* code should be unit testable 
```

两者都易于单元测试

```
* code must be maintainable 
```

当编码良好时，两者都是可维护的

```
* speed & ease of development 
```

只要您熟悉它们，我会说这很重要。

```
* supports vector graphics of some sort (SVG a plus) 
```

我不能代表 Flex，但 GWT 通过 SVG 和第三方库支持矢量图形。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-08T17:16:25.743

我不熟悉 GWT，但我对 Flex 非常熟悉。尽管 GWT 是基于 Java 的（听起来您主要是一家 Java 商店），但我还是会根据您列出的兴趣推荐 Flex：

*   面向未来 - Flash 为 YouTube 和网络上的大量多媒体提供支持……他们已将其内置到视频游戏机中，而英特尔正在将其内置到机顶盒中。它将在这里存在很长时间，并且 Adob​​e 始终保持 100% 向后兼容其 Flash 播放器。

*   适用于所有主要浏览器 - 是的。Flash Player 10 也包括 Linux 系统。并且管理的麻烦非常小（在我看来，比 Java 少得多）。

*   快速且响应迅速的用户体验 - 是的，尽管 Java 在某些情况下可能更快。Flash 针对矢量渲染进行了优化，因此既然这是您的目标，它可能会为您提供比 Java 更好的性能。

*   代码应该是可单元测试的——是的，请参阅 FlexUnit。

*   代码必须是可维护的——绝对是。AS3 是一种严肃的语言，而不是玩具脚本语言。C# 或 Java 的用户会非常熟悉它。

*   速度和易于开发 - 对于您正在做的事情，您将能够找到数十个与您所描述的完全一致的示例：缩放和平移类似 Google 地图的矢量图像。运行时的核心是精心设计的图形引擎，因此构建交互式图形应用程序是其自然的苦差事。

*   支持某种矢量图形（SVG 是一个优势）——显然，Flash 本身就是这样做的。在编译阶段支持 SVG（您可以在 SVG 中编译，但不能在运行时解析 SVG）。有一些工具链可以在运行时为您将 SVG 转换为 SWF。

我看到使用 GWT的*唯一*原因是将您的商店 Java 保留在服务器和客户端上……但话又说回来，您正在寻找最适合这项工作的技术，对吧？在这种情况下，我会说 Flash（尤其是 Flex 框架）最适合您想要完成的任务。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T01:28:24.410

需要注意的另一点是 iPhone 和 Android 目前都不支持 Flash。越来越多的人希望在手机上访问网络应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-15T14:25:10.103

我参与了一个使用 GWT 的项目，我很喜欢它，特别是因为 Java 是我选择的主要编程语言。我没有使用过 Flex，所以我只向您提供有关我使用 GWT 的经验的信息。评论您的一些要求

> *面向未来 - GWT 已经存在了几年，并且一直受到 Google 的支持。
> 
> *适用于所有主要浏览器 - 如果您使用过 GWT，跨浏览器编程从未如此简单。GWT 为您做到这一点！
> 
> *代码应该是可单元测试的——是的，你可以对 GWT 进行单元测试，它也很容易调试 GWT。
> 
> *速度和易于开发 - 多亏了 GWT，Ajax 变得不那么复杂。仅此一项就可以加快您的 RIA 开发。

除了这些，我只想说，我喜欢他们的 Google Group！它非常活跃，您可以在那里找到很多可以帮助您的人，以防您遇到问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T17:58:51.853

Sun 最近为这类 RIA 推出了一种称为 JavaFX 的新技术。您可能想检查一下 (javafx.com)。假设它可以在 Java 5 或更高版本上运行，但绝对不会像 Flash 那样具有客户端渗透性。但是，我认为鉴于您对测试的要求，该技术目前可能不合适。

另外，我认为特洛伊吉尔伯特在他的帖子中犯了一个错误。具体来说，他似乎表明 GWT 应用程序将（由客户端）在 java 中运行。我几乎可以肯定 GWT 应用程序首先是用 Java 编写的，然后 GWT 会将其编译成客户端运行的 javascript 库。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T17:25:09.643

自 2000 年以来我一直在进行 Flash/Flex 开发，因此我偏向于 Flex。不过，我认为要回答您的问题，这实际上归结为您想要实现的交互性和复杂性水平。

Flex 将让您完成在 JavaScript 环境（ASP.NET AJAX、jQuery、GWT）中几乎不可能的事情，例如简单的 3d 图形。在 Flex 中构建复杂的交互性真的很简单。它也非常快，一次可以处理很多动画对象。Flex 可以使用 Web 服务与 .NET 或 Java 无缝通信。使用 Flex 的缺点是它感觉就像是网站上的嵌入式应用程序，而不是紧密集成的东西。

如果您要坚持使用 JavaScript 方法，通常我会建议使用与语言无关的东西，例如 jQuery。但是由于您已经拥有 GWT 经验，这可能对您的项目很有效。缺点是 GWT 最终仍然是 JavaScript，因此您将受到浏览器中可能实现的速度和交互性的限制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-01-14T21:42:22.603

我已经使用这两种技术有一段时间了。

面向未来 - 我想它们都会成功，但在不同的情况下，每种技术都会受到青睐。例如，在具有所需桌面（如 ui）的大型（主要是 Intranet）企业中使用 flex（Flex 可以在任何服务器平台（jvm、.Net、php、ruby、coldfusion）的顶部使用）。否则 GWT 将在具有传统 jvm 后端（tomcat+spring 等）的中小型应用程序中占主导地位

适用于所有主要浏览器 - 以这种方式都没有问题。Flex 绝对出色，安装 flash 插件后无需解决任何跨浏览器兼容性问题（当然……浏览器是被动的，当 flash 应用程序运行时：）。我记得我们在使用 GWT 和传统的麻烦制造者 IE6 时遇到了一些小问题，但没有什么可怕的......

快速且响应迅速的用户体验——两者都是同类产品中的佼佼者。Flex 我认为绝对是所有 RIA 解决方案中的佼佼者（也许 silverlight，java fx 可能是最丰富的竞争对手），特别与 LCDS 集成，具有数据管理、真实服务器端数据推送等酷炫功能。GWT 是顶级之一在 ajax 框架类中。您需要的 ui 越丰富和复杂，您使用 flex 的理由就越多。在任何情况下，解释的 javascript 都不能比编译的 actionscript/swf 更快和响应更快。

代码应该是可单元测试的——是的，它们是非常可测试的。

代码必须是可维护的 - 两者都很好，维护 actionscript 与 java(gwt) 相当，如果您使用一个好的 IDE，例如 Flex Builder。

速度和易于开发 - 如果您了解您的员工，两者都是完美的。一切都取决于你的背景。对于典型的 java 开发人员来说，学习曲线可能会更困难一些（你需要学习一个新的编译器/运行时，可能还有新的 IDE，或者至少是新的 eclipse IDE 插件：）。Flash 的一些知识是 +，但不是必需的，通常只用于特定任务，例如构建自己的组件等。

支持某种矢量图形（SVG 加分）——我记得没有问题，我对此没有太多经验，但我会在未来 FXG 最终确定时看看它。

开发和部署成本——赢家在这里很清楚。总重量。开发 Flex 是为了盈利。虽然 self 是开源的，但最好的工具（Flex Builder、新的 Flash Builder/Catalyst）和框架（LCDS）都是商业化的，而且一点也不便宜。查看每个 CPU 价格表的 LCDS，您就会知道我在说什么。使用 GWT，大多数质量工具/框架至少是开源的或免费的。除了一些高级组件，如 ext gwt 和 smartgwt EE。显然你可以没有他们生活。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-11T17:45:12.253

面向未来的更多是关于架构，而不是关于特定技术。使用正确的架构，您可以很容易地更换演示技术。我喜欢 Silverlight/MVVM，尽管该模式确实需要一些计划来支持 HTML5。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-04T09:09:26.120

这真的是一个苹果/橘子的问题。使用 GWT，您可以获得用 Java 编写所有内容的纯粹性。具有讽刺意味的是，最终结果永远不会像网站以外的任何东西。

使用 Flex，您可以编写一些感觉像应用程序的东西。而且，也许最重要的是，使用 Flex，没有什么是您不能以编程方式完成的——无论是功能性的还是图形化的。

如果您正在为特定的用户群开发应用程序，那么 Flex 绝对是赢家。如果你正在构建一个基于任何东西的大众社交网络，GWT 绝对是一个更好的选择。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-16T19:36:40.727

大约一年前，我的公司面临同样的决定。你听说过 GXT [http://extjs.com/products/gxt/](http://extjs.com/products/gxt/)吗？我们最终选择了 GXT。作为 .NET 开发人员，从 .NET 过渡到 GXT 非常棒。我们使用 GXT/GWT 开发了一个公司范围的管理程序。缺点是与 Flex 相比，GXT 是由一个小得多的团队开发的，而且社区也没有那么大。但是，它提供了令人印象深刻的浏览器内体验。一探究竟。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T03:48:54.863

虽然 iPhone 和 Android 不支持 flash YET，但您还应该注意 Google 会创建针对手机的应用程序。他们这样做是因为移动设备上的屏幕比典型的笔记本电脑/台式机小得多。因此，缺少 Flash 支持不是问题，因为目标应用程序提供了更好的用户体验。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2009-03-16T20:38:08.067

我知道你问过 GWT 与 Flex，但如果你对最终决定有发言权，你应该认真考虑是否要远离 AJAX 和 ASP.NET。尽管 Adob​​e、Microsoft 和 Sun 这么说，RIA（富 Internet 应用程序）还没有为黄金时段的浏览器体验做好准备，除非是有限的形式（如视频播放器）。

**使用原生浏览器技术**为浏览器编写的成熟应用程序将为用户提供最佳体验，并拥有最多的开发资源来维护它。

ASP.NET 不会去任何地方。Java 或 Flex 都不是。但是对于纯粹的覆盖范围、最佳的整体用户体验和可维护性（由于可用的编程资源要多得多），您无法击败基于浏览器的原生应用程序。

[ASP.NET MVC](http://www.asp.net/mvc/)完全基于 Web 并且非常 Ajaxy。你可能会检查一下。它类似于 Ruby on Rails（没有 Rails），开发人员（甚至是 ASP.NET 的新开发人员）都非常喜欢它。

# objective-c - 如何禁用前向类编译器警告（未记录的类）

> ID：424899
> 
> 赞同：2
> 
> 时间：2009-01-08T16:21:44.093
> 
> 标签：objective-c, xcode, compiler-construction

我目前正在编写一个 iPhone 应用程序，该应用程序使用具有 5 个以上选项卡栏项的 UITabBarController。因此，会自动生成一个“更多”标签（就像在 YouTube 应用程序中一样）。我发现对应的视图控制器类是[UIMoreListController](http://ericasadun.com/iPhoneDocs220/interface_u_i_more_list_controller.html)，但我没有任何对应的 .h 文件。所以，我的代码如下所示：

```
@class UIMoreListController; // can't use #import since .h file is missing

@implementation SomeUINavigationControllerDelegate

- (void)navigationController:(UINavigationController *)navigationController
        willShowViewController:(UIViewController *)viewController
        animated:(BOOL)animated
{
     if ([viewController isKindOfClass:[UIMoreListController class]])
         ... // do something if "more" view is active 
```

这就像一个魅力。但是，编译器一直给我

> 警告：接收器“UIMoreListController”是一个转发类，对应的@interface 可能不存在

是否有一种巧妙的方法可以消除此警告（仅此特定警告）？同样，我不能使用[#import](https://stackoverflow.com/questions/322597)，因为没有 .h 文件可用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-08T19:23:08.967

如果您只是想检查`UIMoreListController`类，您可以使用 objc-api 访问类变量。

```
if ([viewController isKindOfClass:NSClassFromString(@"UIMoreListController")]) 
```

那么你就不需要`#import`or`@class`声明了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T16:45:52.577

您不必声明或 #import 任何标准 Cocoa Touch 类。UIMoreListController 看起来不像是您此时应该使用的公共类，如果是的话，它会在文档中列出。您链接到的页面是一个 SDK 转储，如果您计划在 App Store 中发布您的应用程序，则并非其中的所有内容都可以安全使用。

尽管如此，您可以将其声明为类型 id，并在必要时使用您需要调用的任何 UIMoreListController 特定方法在 NSObject 上声明一个类别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T18:50:10.313

> 将其声明为类型 id，并在必要时使用您需要调用的任何 UIMoreListController 特定方法在 NSObject 上声明一个类别。

这不会成功。我只需要

```
if ([viewController isKindOfClass:[UIMoreListController class]]) 
```

无论如何，通过 App Store 发布肮脏的黑客是正确的。不幸的是，参考对那些[*moreNavigationController*](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITabBarController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006931-CH3-SW12)[有点保密。](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITabBarController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006931-CH3-SW12)*他们告诉您它只是一个 UINavigationController（确实如此）。*

 *也许我应该尝试一种不同的方法来确定 viewController 是否是一些 UIMoreListController。就像是

```
if ([viewController isEqual:[navigationController topViewController]]) 
```

应该可以工作，因为 UIMoreListController 始终是 topViewController。（我可能错了，但我要试试）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T12:48:57.757

你为什么要这样做？您不应该使用任何私有 API。不能保证这个类在下一个操作系统版本中仍然存在，如果你认为它是，那么这条路会导致错误甚至崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-03T17:13:57.317

只要您在`moreNavigationController`'s 代表中，这应该可以解决问题：

```
[viewController isEqual:[navigationController.viewControllers objectAtIndex:0]] 
```

相比之下，`topViewController`会给你的反面是你想要的。使用`objectAtIndex:0`应该有助于避免任何私人恶作剧。

# apache-flex - 我的 Flex 应用程序中的“int main()”在哪里？

> ID：424915
> 
> 赞同：3
> 
> 时间：2009-01-08T16:28:31.380
> 
> 标签：apache-flex

好吧，当然不是字面意思，而是：

我是 Flex 的新手，我正试图找出在我的应用程序启动时将要运行的代码放在哪里。在我的示例中，我在标记中定义了一个树控件，并且我有可以从本地文件或 Web 服务填充它的 AS 代码。如何将一个绑定到另一个，以便在创建控件时运行代码？

我在文档中找到的示例都使用事件处理程序，即它们将'creationComplete="myInitFunction(evt)"' 放在控件的开始标记中。这意味着我编写了一个小胶水函数来初始化事物。

现在，据我了解，标记实际上在内部转换为 AS 类。那么我可以不只是定义一个由引擎实例化的类并将我的启动代码放在构造函数中吗？甚至可能喜欢扩展 Tree 类？

**编辑**：

几个月后，我聪明了很多。在尝试滥用扩展组件类的构造函数之后，我不得不了解到 Flex 并不期望构造函数做太多事情——当然不会从网络加载数据。

“Programming Flex 3”中的组件生命周期解释非常有帮助。现在，我的构造函数都是空的，我正在重写生命周期方法，例如`createChildren`很多事情，并将事件用于涉及延迟或依赖外部性的任何事情，尤其是网络内容。

例如，我`creationComplete`用来发起一个异步网络请求（使用`HTTPService`），当返回有 ResultEvent 和 FaultEvent 处理程序时，ResultEvent 会更新一个数据模型，我将控件数据绑定到该数据模型。这看起来非常灵活，效果很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-08T17:06:21.037

当 Application 组件创建完成时，将调度 creationComplete 事件（在 Application 对象上）。一旦整个应用程序完成（布局等）并且对用户可见（加载屏幕完成），就会调度 applicationComplete 事件。

对于您提到的情况-您在启动时填充控件-我建议使用*包含*要填充的控件的组件的 creationComplete 事件（在您的情况下为 Tree），这听起来像是成为您的应用程序组件。这通常是一种很好的做法，因为此代码通常取决于您正在填充的同级组件（​​例如，HTTPService 组件）。

没错，所有 MXML 都在 AS3 中转换，然后再编译。有一个编译器标志将保留生成的 AS3（不过它将是只读的）。你不想惹这个。并且由于 UIComponent 实例化序列（构造函数、样式、布局等）的（有些）复杂性，在creationComplete 事件（或类似事件）中填充控件绝对是最佳实践。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T23:29:52.737

从技术上讲，int main() 类似于 actionscript 3 中应用程序类的构造函数。这对 Flex 意味着，无论应用程序 mxml 文件（通常是 mx:Application）的根节点是什么，该类的构造函数都是你的 int main()。

但就像其他海报提到的那样，您要做的是收听 mx:Application 广播的事件之一。Initialize 是放置初始化逻辑、加载配置文件或执行您需要执行的任何其他操作的好地方，这些操作不依赖于任何 UI 对象或尚未创建的任何内容。否则，即使您想听，creationComplete 也是下一个最有可能的。

您真的不需要使用 applicationComplete 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:56:14.787

您应该寻求处理启动事件。

我在 Flex 上并不是真正的“向上”，但根据[http://www.wietseveenstra.nl/blog/2007/02/understanding-the-flex-application-startup-event-order](http://www.wietseveenstra.nl/blog/2007/02/understanding-the-flex-application-startup-event-order)：

> applicationComplete() 在 Application 初始化、由 LayoutManager 处理并添加到显示列表后调度事件。这是应用程序启动期间调度的最后一个事件。它晚于应用程序的 creationComplete() 事件，该事件在预加载器被删除并且应用程序已附加到显示列表之前被调度。

# http - 为什么浏览器不能发送 gzip 请求？

> ID：424917
> 
> 赞同：69
> 
> 时间：2009-01-08T16:28:38.697
> 
> 标签：http, browser, gzip, request

如果网络服务器可以发送 gzip 响应，为什么浏览器不能发送 gzip 请求？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-08T16:34:48.573

客户端和服务器必须就如何通信达成一致；部分原因是通信是否可以压缩。HTTP 被设计为请求/响应模型，最初的创建几乎可以肯定地设想总是有小请求和潜在的大响应。*实现 HTTP不需要*压缩，有服务器和客户端都不支持它。

HTTP 压缩是由客户端实现的，说它可以支持压缩，如果服务器在请求中看到它并且它支持压缩，它可以压缩响应。为了压缩请求，客户端必须有一个“预请求”，实际上协商请求将被压缩，或者它必须要求压缩作为所有请求的支持编码。

*** 2017 年 2 月更新 *** 已经 8 年了，但正如 @Phil_1984_ 所指出的，第三种可能的解决方案是客户端和服务器协商压缩支持，然后将其用于后续请求。事实上，像 HSTS 这样的东西就是这样与客户端缓存一起工作的，服务器期望只使用 TLS 并忽略任何未加密的链接。HTTP 被明确设计为无状态，但我们现在已经超越了这一点。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-08T16:33:19.170

客户端无法提前知道服务器会理解压缩后的请求，但服务器可以知道客户端会接受请求。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-10T07:36:20.987

它可以，只要它可以保证服务器会接受它。这可能意味着使用 OPTIONS 请求。

Web 浏览器可以做很多他们不做的事情（例如，流水线）。Web 浏览器开发人员考虑更改的兼容性影响。

在异构环境中，有许多不同的 Web 服务器和配置。改变客户的工作方式可能会破坏其中的一些。

也许只有 1% 的服务器可能会接受 gzip 压缩请求，但也许其中一些服务器宣传他们接受，但无法正确接受 - 因此用户将被拒绝将文件上传到这些站点。

从历史上看，有很多损坏的客户端/服务器实现 - 很长一段时间以来，主要 Web 浏览器中的 gzip 响应都被破坏了（谢天谢地，这些现在大部分都消失了）。

因此，您最终会得到自动关闭这些选项的用户代理或服务器（或域名）的黑名单，这很讨厌。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T16:34:38.590

因为它不知道服务器可以接受它。HTTP 事务具有由客户端发送的单个请求，然后是响应。客户端发送的其中一件事是它可以支持什么编码/压缩。然后服务器可以决定如何压缩响应。客户没有这种奢侈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-14T05:29:34.090

如果您正在编写一个 Web 应用程序，我假设您可以控制发送给客户端的内容以及从客户端发送回的内容。

用 javascript 编写一个 gzip 实现会很容易，它可以压缩发送到服务器的发布数据。服务器可以有一个过滤器（j2ee 术语），它知道客户端数据是压缩发送的，这个过滤器解压缩数据，然后将数据传递给 servlet（或 Struts 中的操作类），它可以正常读取数据，例如 request.getParameter( ...）。

如果您可以控制，这似乎完全合乎逻辑且可行。正如其他帖子所提到的，您不能依靠浏览器自动执行此操作，但是由于您正在编写网页，因此您可以让浏览器进行您所追求的压缩（只需做一些工作）。

安迪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-02T21:43:14.737

HTTP 是这样设计的：

*   客户以纯文本形式表示其请求（包括是否可以理解压缩答案）
*   服务器使用适当的编码响应（压缩与否）

但是在这个设计中，客户端不能发送压缩请求，因为它不知道服务器是否会提前理解它。

# sql - 如何在 SQL 表中最好地执行单级递归？

> ID：424919
> 
> 赞同：1
> 
> 时间：2009-01-08T16:29:06.120
> 
> 标签：sql, recursion, constraints

假设您的组织中有一个分支表。其中一些是“主要”分支机构，而另一些则是延伸到主要分支机构的卫星办公室。除了这种只影响系统中一些事情的区别之外，分支都是对等的并且具有相同的属性（地址等）。对此建模的一种方法是在如下表中：

```
CREATE TABLE Branch (
    branch_id INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    branch_name VARCHAR(80) NOT NULL,
    street VARCHAR(80) NULL,
    city VARCHAR(30) NULL,
    state CHAR(2) NULL,
    zip CHAR(5) NULL,
    is_satellite_office BIT NOT NULL DEFAULT(0),
    satellite_to_branch_id INT NULL REFERENCES Branch(branch_id)
) 
```

Where `is_satellite_office`= 1 如果这条记录是另一个分支的附属，并且`satellite_to_branch_id`指的是你是哪个分支的附属，如果有的话。

对表施加约束很容易，以便这两列在任何给定记录上达成一致：

```
CONSTRAINT [CK_Branch] CHECK 
  (
    (is_satellite_office = 0 AND satellite_to_branch_id IS NULL) 
    OR (is_satellite_office = 1 AND satellite_to_branch_id IS NOT NULL)
  ) 
```

但是，我真正想要的是一种方法来保证这种递归只深入**一层**......也就是说，如果我指向一个分支作为我的父级，它本身一定没有父级，并且它的值`is_satellite_office`必须是0\. 换句话说，我并不真正想要一个完全递归的树结构，我只是想将其限制为单个父/子关系。这就是我要编写代码的方式，如果有一种方法可以在数据库中强制执行它不会像完全废话一样执行，我愿意。

有任何想法吗？我正在研究 MSSQL 2005，但首选通用（非供应商特定）解决方案。并且不需要应用触发器，除非真的没有其他方法可以做到这一点。

编辑：要清楚，`satellite_to_branch_id`是指向同一分支表中另一条记录的递归指针。我知道我可以删除`is_satellite_office BIT`并依赖`IsNull(satellite_to_branch_id)`给我相同的信息，但我发现明确一点更清楚，除此之外，这不是问题的要点。我真的在寻找一种纯 SQL 约束方式来防止递归深度大于 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:35:27.467

在我看来，这就像一个业务约束，难以在数据定义级别执行。我不相信关系代数有任何支持来确定自我引用深度的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T17:01:26.680

不允许在约束中引用存储过程吗？你可以在 PostgreSQL 中，所以如果 2005 年不允许这样做，我会感到惊讶。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T17:33:01.453

您可以将检查约束绑定到 UDF 的返回值。创建一个将涉及的列作为输入参数的 UDF，然后使用 UDF 中的选择检查所需的状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T16:37:34.933

这种略有不同的结构呢？

```
CREATE TABLE Branch (
    branch_id INT NOT NULL PRIMARY KEY IDENTITY(1,1),
    branch_name VARCHAR(80) NOT NULL,
    street VARCHAR(80) NULL,
    city VARCHAR(30) NULL,
    state CHAR(2) NULL,
    zip CHAR(5) NULL,
    parent_id int NULL
) 
```

PARENT_ID 将简单地指向同一张表中另一条记录的 BRANCH_ID。如果它是空的，那么你知道它没有父母。

然后，要获得一级递归，您只需将表连接到自身一次，如下所示：

```
SELECT
  PARENT.BRANCH_NAME AS PARENT_BRANCH
 ,CHILD.BRANCH_NAME AS CHILD_BRANCH
FROM
  BRANCH PARENT
 ,BRANCH CHILD
WHERE CHILD.PARENT_ID PARENT.BRANCH_ID 
```

如果您想在树中强制执行一层深度，请创建一个插入/更新触发器，如果​​此查询返回任何内容，它将引发异常。

```
SELECT *
FROM
  BRANCH B1
 ,BRANCH B2
 ,BRANCH B3
WHERE B1.PARENT_ID = :NEW.NEW_PARENT_ID
  AND B2.PARENT_ID = B1.BRANCH_ID
  AND B2.PARENT_ID = B3.BRANCH_ID; 
```

# c# - 有没有办法让“破坏性”字符串方法 a-la Ruby？

> ID：424920
> 
> 赞同：0
> 
> 时间：2009-01-08T16:29:10.550
> 
> 标签：c#, string, extension-methods

在 Ruby 中，改变对象的方法最后会有一个爆炸：`string.downcase!`

在 c# 中，你必须这样做：`foo = foo.ToLower()`

有没有办法制作一个扩展方法，如：

`foo.ConvertToLower()`

那会操纵`foo`吗？

（我认为答案是否定的，因为字符串是不可变的，你不能`ref this`在扩展方法中做 a。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T16:32:21.090

有两种方法可以改变字符串实例：

*   反射
*   不安全的代码

我不建议使用它们中的任何一个。你的开发人员会永远恨你 - 特别是如果该方法曾经用于更改恰好是文字的字符串......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T16:59:12.050

不，您不能在扩展方法中执行此操作。要重新分配作为参数传入的变量的值，您必须使用`ref`参数修饰符通过引用传递它，扩展方法不允许这样做。即使这是可能的，也可能没有要重新分配的变量，例如在`"foo".ConvertToLower()`.

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-01-08T16:40:53.553

您当然可以编写一个扩展方法来重新分配正在操作的字符串。例如：

```
public static void ConvertToLower(this string s)
{
   s = s.ToLower();
} 
```

这与字符串的不变性无关。

# wpf - MV-VM - 在 ViewModel 中使用命令的任何示例？

> ID：424927
> 
> 赞同：16
> 
> 时间：2009-01-08T16:30:11.580
> 
> 标签：wpf, mvvm

我一直在使用我称之为 MV-MC (Model-View-ModelController) 的 MV-VM 风格开发一个非常大的 LOB 应用程序，它是 MVC 和 MV-VM 的一种组合。我已经发布了[这个](https://stackoverflow.com/questions/322612/what-are-the-most-common-mistakes-made-in-wpf-development#322679)关于视图如何在 MV-VM 中实例化到问题“ [what-are-the-most-common-mistakes-made-in-wpf-development](https://stackoverflow.com/questions/322612/what-are-the-most-common-mistakes-made-in-wpf-development) ”的答案。

[Sam](https://stackoverflow.com/users/7021/sam)对我的回答发表了以下评论：

> 这就产生了一个后续问题：您如何创建视图？我使用 RelayCommands 将视图中的动作绑定到 ViewModel，因此视图甚至不知道动作已经触发，也不知道他应该打开一个新视图。解决方案：在VM中创建一个事件供View订阅？

当我最初开始 MV-VM 开发时，我认为一切都应该存在于 ViewModel 中，并且研究了[Josh Smith](http://joshsmithonwpf.wordpress.com/)和[Karl Shifflett](http://karlshifflett.wordpress.com/)等人的大量示例。但是，我还没有想出一个很好的例子来说明命令何时需要存在于 ViewModel 中。

例如，假设我有一个显示客户的 ListView，以及一个单击以允许我编辑当前选择的客户的按钮。ListView (View) 绑定到 CustomerVM (ViewModel)。单击该按钮会触发 EditCustomerCommand，它会打开一个弹出窗口，允许我编辑 CustomerVM 的所有属性。这个 EditCustomerCommand 在哪里？如果它涉及打开一个窗口（UI 功能），它不应该在视图的代码隐藏中定义吗？ ![替代文字](https://codingcontext.files.wordpress.com/2009/01/commandflow.png)

有没有人有任何我应该在 View 和 ViewModel 中定义命令的示例？

[马修赖特](https://stackoverflow.com/users/47006/matthew-wright)在下面陈述：

> 从列表中新建和删除将是很好的例子。在这些情况下，ViewModel 会添加一条空白记录或删除当前记录。视图采取的任何行动都应响应发生的这些事件。

所以如果我点击新按钮，会发生什么？CustomerVM 的新实例由 Parent ViewModel 创建并添加到它的集合中，对吗？那么如何打开我的编辑屏幕呢？视图应该创建 Customer ViewModel 的新实例，并将其传递给 ParentVM.Add(newlyCreatedVM) 方法，对吗？

假设我通过虚拟机上的 DeleteCommand 删除客户记录。VM 调用业务层并尝试删除记录。它不能，所以它会向虚拟机返回一条消息。我想在对话框中显示此消息。视图如何从命令操作中获取消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T11:47:47.687

从来没有想过我会看到自己在一个问题中被引用。

我自己思考了一段时间这个问题，并为我的代码库做出了一个相当务实的决定：

在我的代码库中，ViewModel 在动作发生时被调用，我希望它保持这种状态。此外，我不希望 ViewModel 控制视图。

**我做了什么？**
我添加了一个导航控制器：

```
public interface INavigation
{
  void NewContent(ViewModel viewmodel);
  void NewWindow(ViewModel viewmodel);
} 
```

这个控制器确实包含两个动作：NewContent() 确实在当前窗口中显示新内容，NewWindow() 创建一个新窗口，用内容填充它并显示它。
当然，我的视图模型不知道要显示哪个视图。但是他们确实知道要显示哪个视图模型，因此根据您的示例，当执行 DeleteCommand 时，它将调用导航服务函数*NewWindow(new ValidateCustomerDeletedViewModel())*以显示一个窗口，说明“客户已被删除”（对于这个简单的消息框，但很容易为简单的消息框提供一个特殊的导航器功能）。

**viewmodel如何获取导航服务？**

我的 viewmodel 类有一个导航控制器的属性：

```
public class ViewModel
{
  public INavigation Navigator { get; set; }
  [...]
} 
```

当视图模型附加到窗口（或任何显示视图）时，窗口将设置 Navigator 属性，因此视图模型可以调用它。

**导航器如何创建视图模型的视图？**

您可以有一个简单的列表来为哪个视图模型创建哪个视图，在我的情况下，我可以使用简单的反射，因为名称是匹配的：

```
public static FrameworkElement CreateView(ViewModel viewmodel)
{
  Type vmt = viewmodel.GetType();
  // big bad dirty hack to get the name of the view, but it works *cough*
  Type vt = Type.GetType(vmt.AssemblyQualifiedName.Replace("ViewModel, ", "View, ")); 
  return (FrameworkElement)Activator.CreateInstance(vt, viewmodel);
} 
```

当然，视图需要一个接受视图模型作为参数的构造函数：

```
public partial class ValidateCustomerDeletedView : UserControl
{
  public ValidateCustomerDeletedView(ValidateCustomerDeletedViewModel dac)
  {
    InitializeComponent();
    this.DataContext = dac;
  }
} 
```

**我的窗户看起来怎么样？**

很简单：我的主窗口确实实现了 INavigation 界面，并在创建时显示了一个起始页。你自己看：

```
public partial class MainWindow : Window, INavigation
{
  public MainWindow()
  {
    InitializeComponent();
    NewContent(new StartPageViewModel());
  }

  public MainWindow(ViewModel newcontrol)
  {
    InitializeComponent();
    NewContent(newcontrol);
  }

  #region INavigation Member
  public void NewContent(ViewModel newviewmodel)
  {
    newviewmodel.Navigator = this;
    FrameworkElement ui = App.CreateView(newviewmodel);
    this.Content = ui;
    this.DataContext = ui.DataContext;
  }

  public void NewWindow(ViewModel viewModel)
  {
    MainWindow newwindow = new MainWindow(viewModel);
    newwindow.Show();
  }
  #endregion
} 
```

（这同样适用于 NavigationWindow 并将视图包装到页面中）

当然这是可测试的，因为导航控制器可以很容易地模拟。

我不确定这是否是一个完美的解决方案，但它现在对我来说效果很好。欢迎任何想法和意见！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T20:03:20.377

对于您的删除消息框案例，我通过接口抽象出消息框。与此类似。我还为我的 WPF 应用程序注入了这些接口。

构造函数

```
 public MyViewModel(IMessage msg)
    {
      _msg = msg;
    } 
```

然后，在 ViewModel 上的方法 delete 方法中......类似于

```
 public void Delete()
    {
      if(CanDelete)
      {
        //do the delete 
      }
      else
      {
        _msg.Show("You can't delete this record");
      }
    } 
```

这将使其可测试，您可以插入实际上不显示消息框的不同 IMessage 实现。出于测试目的，这些可能只是打印到控制台。显然，您的 WPF 应用程序可能具有类似的实现

```
public class MessageBoxQuestion : IMessage
{
   public void Show(string message)
   {
     MessageBox.Show(message);
   }
} 
```

这样做使测试不同的路线（想想是/否对话框）变得非常容易和直接。你可以想象一个删除确认。您可以使用 IMessage 的具体实例返回 true/false 以进行确认，也可以在测试期间模拟容器。

```
[Test]
public void Can_Cancel_Delete()
{
  var vm = new ProductViewModel(_cancel);
  ...

}
[Test]
public void Can_Confirm_Delete()
{
  var vm = new ProductViewModel(_yes);
  ...

} 
```

对于您关于何时使用命令的其他问题，我从相关视图中实例化添加新视图或详细信息视图。就像你在你的例子中一样。 **视图仅由**我们应用程序中的其他视图实例化。在这些情况下，我不使用命令。但是，我确实将父视图的 ViewModel 属性用于子视图。

```
public void Object_DoubleClick(object sender, EventArgs e)
{
  var detailView = new DetailView(ViewModel.Product);
  detailView.Show();
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:00:09.990

从列表中新建和删除将是很好的例子。在这些情况下，ViewModel 会添加一条空白记录或删除当前记录。视图采取的任何行动都应响应发生的这些事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T14:15:07.880

一种方法是使用业务层可以修改的命令参数对象，并且您的 VM 可以在执行命令后处理。

# jquery - 使用 jQuery 循环遍历输入项 onchange

> ID：424932
> 
> 赞同：3
> 
> 时间：2009-01-08T16:31:56.800
> 
> 标签：jquery

更改SELECT字段时，我想循环其属于使用jQuery的表单中的所有输入值。这在下面不起作用，但我无法确切知道如何做到这一点。

```
$("select.mod").change(function(){
    $(this).parent().get(0).$(":input").each(function(i){
    alert(this.name + " = " + i);
  });
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-08T16:47:21.670

这可能是导致问题的“父表单”的选择。

该函数仅返回直接父级，如果您嵌套在 a或其他内容中`.parent()`，则不会让您获取表单元素。`select.mod``<p>`

该`.parents()`函数返回元素的*所有*父元素；但第一个可能不是表单标签。我会试试这个：

```
$("select.mod").change(function(){
    $(this).parents('form') // For each element, pick the ancestor that's a form tag.
           .find(':input') // Find all the input elements under those.
           .each(function(i) {
        alert(this.name + " = " + i);
    });
}); 
```

如果表单元素相互嵌套，这仍然可能对您没有帮助，但如果是这种情况，您可能会遇到比 jQuery 选择器更大的问题......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T17:00:03.733

您的问题几乎可以肯定是：

```
.$(":input") 
```

那没有意义。你试图`$(":input")`在任何`.get(0)`返回时调用该方法......当然没有这样的方法！

您正在寻找的可能更像是：

```
$(this).parent().find(":input").each( ... ) 
```

可以提供更多详细信息的帮助。收到错误？DOM 结构是什么？等等。

就个人而言，我的表格上通常有`id`'s。所以我会让事情变得清晰（r | n），比如：

```
$('#my_awesome_form :input').each( ... ) 
```

# .net - 正则表达式布尔值不

> ID：424938
> 
> 赞同：6
> 
> 时间：2009-01-08T16:32:47.283
> 
> 标签：.net, regex

如何编写一个 .net 正则表达式，它将匹配一个不以“Seat”开头的字符串

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-08T16:37:04.077

您正在寻找的是：

```
^(?!Seat).+ 
```

[这篇文章](http://timstall.dotnetdevelopersjournal.com/regular_expressions_does_not_start_with.htm)有更多关于前瞻的信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-08T16:35:31.413

为“不以开头”编写正则表达式可能有点棘手。编写正则表达式来检测字符串以子字符串而不是匹配项开头通常更容易。

例如：

```
return !Regex.IsMatch("^Seat.*", input); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T16:37:16.587

我建议不要这样做。您应该能够获取每个不匹配的字符串。

```
!Regex.IsMatch("^Seat.*", string); 
```

# java - MATLAB Java 引用问题

> ID：424949
> 
> 赞同：2
> 
> 时间：2009-01-08T16:34:49.353
> 
> 标签：java, matlab, reference, garbage-collection

我有一个 MATLAB 类，其中包含对 java 对象的引用

```
classdef MyClass
  properties
    j = myJavaClass
  end
  methods
...
  end
end 
```

在我使用它之后（使用 clear、scope exit 或显式设置 myClass = 0; ），java 对象仍然存在——即使在调用 Runtime.gc 之后也是如此。

我在转储中看到该对象仍在 MATLAB 进程的 JVM 堆中（使用 jmap -histo pID），因此我假设 MATLAB 本身仍在引用该对象——尽管调用了 clear、clear JAVA、clear classes 等。 - 没有任何帮助

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T18:02:28.740

MATLAB 最新的面向对象编程格式仍然是我尚未涉足的领域，但我可以尝试给你一些想法......

我猜您正在创建一个“值类”而不是“句柄类”（您可以[在此处](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_oop/brfylwk-1.html)查看有关这些的更多信息）。制作值类的副本时，会复制所有内容。如果您有一个对象的错误副本在某处浮动，那么仍然存在 Java 对象的句柄。

如果您要从句柄类构建您的类，则可以在类析构函数中显式销毁 Java 对象（即重载的 DELETE 方法）。

只是一些随机的想法。希望他们有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T16:25:11.253

建议的解决方法 gnovice 似乎有效 - 将行添加到析构函数

```
function delete( obj )
  ...
  jObject = 0;
end 
```

导致对象不存在于 MATLAB 的 JVM 堆中。

它看起来像 MATLAB 中的一个错误，导致在未引用的 MCOS 类中引用 JAVA 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T17:16:53.920

我不确定这是否会解决它，但请尝试在构造函数中进行分配，而不是在属性块中。此外，提及您正在使用的确切 Matlab 版本可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T22:51:15.100

尝试查看 OOP 的 onCleanup 方面。我认为 Loren 大约在 3 个月前写了一篇关于它的博客。

HTH。担

# multithreading - 单线程应用程序是一种死技术吗？

> ID：424952
> 
> 赞同：10
> 
> 时间：2009-01-08T16:35:49.320
> 
> 标签：multithreading, concurrency

我刚买了一台售价低于 1,000 美元的新笔记本电脑，它的目标客户是非开发者市场，查看规格后，我惊讶地发现它标配双核处理器。

这让我想到了一个问题：随着多核机器成为常态，编写单线程应用程序*是否正确？*

除了可以合理预期完全适合将在其上运行的最弱系统的单个处理器的单个内核中的琐碎应用程序之外，在所有一个线程中运行的应用程序是否会因现代操作系统传播其执行的方式而严重降级当应用程序没有提供关于如何优化这种拆分的指导时，跨核心？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-08T16:42:22.303

由于线程总是给应用程序增加额外的复杂性，**我相信单线程应用程序总是会占有一席之地。**

即使单核处理器完全过时，单线程编程也不会消失。

双核，尤其是在消费市场，非常适合多任务处理。如果每个应用程序都占用每个处理器内核，那么我们可能会遇到与单核处理器相同的问题。

我说不要发疯，开始多线程处理一切。 **除非有充分的理由，否则请将其放在一个线程中。**

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-01-08T16:41:05.770

*除非应用程序需要*多线程，否则您不应该使用多线程。

仅仅因为你*可以*多线程并不意味着你*应该*。多核/处理器并没有真正改变这一事实。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T16:44:55.997

Multi-threaded applications are significantly more difficult to write, and maintain. I think you will start seeing more applications which leverage multi-threading thanks to advances in both hardware, but also in advances in the technology stack.

Microsoft has a set of extensions that I believe are being added into the runtime called ??Parallels?? I know they call the LINQ enabled version PLINQ. Essentially it tries to remove a lot of the error prone plumbing from multi-threaded algorithims.

Only time tell however, and I would wager there were still be plenty of single threaded applications out there because they won't algorithims that justify the performance cost of spinning up threads.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-08T16:45:17.227

> ... will an application which runs in all one thread be seriously degraded by the way modern OSs spread their execution across cores when no guidance is given by the application as to how to optimize such a split?

No, it will still run just as well as it used run to on a single-core CPU.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-08T17:03:33.977

Hardware doesn't really change the fact that any task in a particular application is going to block or not block, and that's really what's going to determine if you should use multithreading or not.

However, modern programming languages are adding new features to make it easier and safer for the programmer to implement threaded applications. Cocoa for example has NSOperationQueue which abstracts the worker thread model, and there are more improvements coming in the next release of OS X. In addition to making it easier to implement a simple threading model, NSOperationQueue also manages threads in a way that the total number of threads is appropriate for the number of processors and cores, so if your application uses a lot of threads there can be some pretty significant speed gains, without too much extra work.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-08T16:43:11.537

毫无疑问，并行编程在未来将会有很大的进步，因为 CPU 不会变得更快，我们只会有很多。拥有双核或四核只是开始，在不久的将来会有更多处理器数量的系统（目前有 256 核的 CPU，Windows 7 将支持此类处理器）。

但是，我认为并行性不适合解决任何问题，它需要不同的编程风格。使用当前技术，多线程为应用程序增加了相当高的复杂性。因此，诸如函数式编程以及支持并行化的库/编译器等范例将在未来变得越来越重要。

David Callahan 在 MSDN 杂志上发表了一篇关于并行编程的设计考虑转变的有趣文章：[Paradigm Shift: Design Considerations For Parallel Programming](http://msdn.microsoft.com/en-us/magazine/cc872852.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-08T16:56:36.643

Multiple cores are advertised for the users benefit, not the programmer. A user will be told that having multiple cores means they can run a number of complex applications at the same time, e.g. updating a large spreadsheet in Excel and viewing a Powerpoint presentation etc.

Obviously as a developer you CAN make good use of the extra cores; most video editing packages run far faster on multi-core machines.

If you are writing an application that would seriously benefit from using more cores, then it may well be worth investing the additional development time, as most new machines now have more than one core, but as always, think about the ROI.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-08T17:29:13.520

Programming for multiple threads is currently somewhat difficult, error-prone, and difficult to test (testing for race conditions is not easy). Therefore, it should be reserved for when the advantages overcome the disadvantages.

Lots of programs run fast enough for almost all purposes, and don't need any performance improvement. Some take a while, but for reasons that don't really involve the CPU and aren't going to be improved by multiple threads. For these, using more than one thread makes them harder to develop while not helping the end user.

In the meantime, multiple cores can be useful without multithreading. Most operating systems have multiple processes going (monitoring, background housekeeping, viruses, spyware, spambots, whatever) and allowing these to run on another core can free up one for user code.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-08T16:43:33.860

像往常一样进行性能优化；您不能就任意应用程序是否“足够性能”做出一般性陈述。问题是，对于应用程序 X，它是否“足够好”。

However, perhaps more to your point to continue to see the benefits of Moore's law which is no longer making processors faster but making them smaller (and hence more cores on a chip) applications will have to become multi-threaded.

However, the cost of building a multi-threaded application (engineering, testing, support) are still significant so you really shouldn't do it unless you need the performance. I think coming down the pike are some easier ways to do multi-threaded programming with some various libraries as well as things like functional programming and optimized compilers so I think this will get easier as we continue the transition into a multi-core world.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-08T16:58:36.420

The answer to your question is tricky, because it asks us to speculate on future developement. The simple answer to your question is this:

No, single threads are the basis for multiple threads, you can't have one without the other. Thus, the capacity for single threaded applications will always exist, and they will doubtlessly be written for years to come.

The complex answer is as follows: The reason for computers having dual core processors standard is because its the next step in processor developement. while many applications will not take immediate advantage of the dual core, some will. As such, a company like intel must accomodate, or be squashed by the competition.

Beyond this, there are immediate advantages. Larger addressable memory space. Operating Systems themselves already being optomized for the dual also reaps immediate benefits.

Also: If you have a library that is optimized for the dual core processors all subsequent developement will benefit. An example is searching and sorting algorithms (a nartural choice for "thread split" due to the divisibility of the data) which can be optimized for the dual core, and then be perpectually used with the advantage.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-02T16:38:46.303

Lets face it most applications are written for business, they access a database and allow data in it to be viewed, edited and appended. Then maybe some data analysis reports and so on.

Other than a separate UI thread if the database queries are going to take a while there is very little reason for threading it since the gains will be fractional and largely un-noticed by the end user. There are maybe a few cases where a parallel loop would benefit applications maybe.

I believe the real benefit of multiple cores at the moment is muliple applications accessing different cores at the same time. Just think how many processes windows runs in the background, these can be run concurrently across any number of cores.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-22T10:17:38.747

Maybe the question should be reformulated to: "is running a program on one only core a dead technology". That would make it a lot more general. If you look at the recent added web workers added to firefox 3.5 and other major browsers, then they do support multiple cores, but using processes and message passing. A much saner approach than threading. In the end it all depends on the problem at hand. Using multiple cores really only makes a difference if the problem at hand is CPU bound.

I would also like to add that your application might not be the only running process on the machine (*hint*).

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-22T10:43:21.037

A good way to use multiple processors without multithreading:

```
cat data.txt | sed 's/,/ /g' | awk '{print $4}' | gzip > foo.txt.gz 
```

Does that answer your question on weather dual core means all applications should be multithreaded? The above can in theory saturate 3 CPUs. (excluding cat, only using it because that makes the line more readable)

# objective-c - 使用原始类型的属性

> ID：424962
> 
> 赞同：17
> 
> 时间：2009-01-08T16:38:11.517
> 
> 标签：objective-c

我无法理解何时在 Objective C 2.0 中使用属性。似乎您不需要原始类型的属性，例如：int、bool、float。这是真的？我已经看到显示这些类型的属性的示例以及其他将它们排除在外的示例。例如，在 Apple 的示例代码中，它们具有：

```
...
@interface Book : NSObject {
    // Primary key in the database.
    NSInteger primaryKey;
    // Attributes.
    NSString *title;
    NSDate *copyright;
    NSString *author;

    BOOL hydrated;
    BOOL dirty;
    NSData *data;
}

@property (assign, nonatomic, readonly) NSInteger primaryKey;
// The remaining attributes are copied rather than retained because they are value objects.
@property (copy, nonatomic) NSString *title;
@property (copy, nonatomic) NSDate *copyright;
@property (copy, nonatomic) NSString *author;
... 
```

[Apple SQLite 图书列表示例代码](http://developer.apple.com/iphone/library/samplecode/SQLiteBooks/index.html)

所以你可以看到他们没有为 BOOL 使用属性，但他们认为它在整个实现文件中都有一个实例变量，读取值并设置值。在线搜索我发现确实使用这些类型的属性的教程，例如：（@property BOOL 标志）。有人可以为我解释一下这个话题吗？谢谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-08T16:52:04.810

是的，您应该为原始类型声明一个属性。唯一真正的区别是您应该使用分配（这是默认设置，因此您也可以将其省略）而不是复制或保留。我不能说这个例子的其余部分，但它可能是直接访问内部实例变量，或者如果它是从另一个类访问的，键值编码正在生成一个访问器（这真的很糟糕）。我猜是前者；如果我不需要特殊的访问器并且实例变量不在类外部使用，我将直接引用它而不是声明属性。我想有些人可能会反对，但这对我来说似乎有点过分。

# wpf - WPF 数据绑定更复杂的 XML 结构

> ID：424967
> 
> 赞同：0
> 
> 时间：2009-01-08T16:39:00.937
> 
> 标签：wpf, xml, hierarchicaldatatemplate

我已经在微软论坛上问过这个问题，但直到现在都没有答案。我被困在这里。我有一个非常嵌套的 xml 片段，我喜欢通过分层数据模板进行绑定。

这是xml片段：

```
<project>
<products>    
<product name="Product2" foldername="string" dbkey="-2405" dbtable="string">   
          <inifiles>  
            <inifile name="string" dbkey="-3083" dbtable="string">   
              <sections>  
                <section name="string" dbkey="-3025" dbtable="string">   
                  <inientries>  
                    <inikey name="string" value="string" dbkey="9739" dbtable="string" />  
                  </inientries>  
                </section>  
              </sections>  
            </inifile>  
          </inifiles>  
          <subproducts>  
            <subproduct dbkey="1644" dbtable="string" name="Subproduct1">   
              <inifiles>  
                <inifile name="string" dbkey="-6544" dbtable="string">   
                  <sections>  
                    <section name="string" dbkey="2436" dbtable="string">   
                      <inientries>  
                        <inikey name="string" value="string" dbkey="-2122" dbtable="string" />  
                      </inientries>  
                    </section>  
                  </sections>  
                </inifile>  
              </inifiles>  
            </subproduct>  
            <subproduct dbkey="-4746" dbtable="string" name="Subproduct2">   
              <subinifiles>  
                <subinifile name="string" dbkey="7519" dbtable="string">   
                  <subsections>  
                    <subsection name="string" dbkey="1680" dbtable="string">   
                      <subinientries>  
                        <subinikey name="string" value="string" dbkey="3682" dbtable="string" />  
                      </subinientries>  
                    </subsection>  
                  </subsections>  
                </subinifile>  
              </subinifiles>  
            </subproduct>  
          </subproducts>  
        </product>  
    `</products>
</project> 
```

我的分层数据模板如下所示：

```
<HierarchicalDataTemplate 
            DataType="product"
             ItemsSource="{Binding XPath=inifiles/inifile}"

            >
            <StackPanel Orientation="Horizontal">
                <Image Width="16" Height="16"
                       Source="Images/gnome-applications.png"/>
                <TextBlock Text="{Binding XPath=@name}" FontWeight="bold"/>

            </StackPanel>

        </HierarchicalDataTemplate>

        <!-- ######################### Ini-Files #########################################
        -->
        <HierarchicalDataTemplate 
            DataType="inifile"
             ItemsSource="{Binding XPath=sections/section}"
            x:Name="inifile"
            >
            <StackPanel Orientation="Horizontal">
                <Image Width="16" Height="16"
                       Source="Images/advanced.png"/>
                <TextBlock Text="{Binding XPath=@name}">
                     <TextBlock.ContextMenu>
                         <ContextMenu>

                        <Menu BorderThickness="3">

                            <MenuItem Header="{Binding XPath=@name}">

                                <MenuItem Header="_Find in Database"/>
                                <MenuItem Header="_Edit"  Tag="{Binding XPath=@value}"/>
                            </MenuItem>

                        </Menu>
                    </ContextMenu>
                    </TextBlock.ContextMenu>
                </TextBlock>
                <TextBlock Text="{Binding XPath=@key}"/>

            </StackPanel>
        </HierarchicalDataTemplate>

        <!-- ######################### Sections #########################################
        -->
        <HierarchicalDataTemplate
            DataType="section"
            ItemsSource="{Binding XPath=inientries/inikey}">
            <StackPanel Orientation="Horizontal">
                <Image Width="16" Height="16"
                       Source="Images/indent.png"/>
                <TextBlock Text="{Binding XPath=@name}">
                       <TextBlock.ContextMenu>
                         <ContextMenu>
                        <Menu>

                            <MenuItem  HorizontalAlignment="Stretch" 
                                       VerticalAlignment="Stretch" 
                                       Height="Auto"
                                       Width="Auto"
                                       Header="{Binding XPath=@name}">

                                <MenuItem Header="_Find in Database"/>
                                <MenuItem Header="_Edit"  
                                          Tag="{Binding XPath=@value}"/>
                            </MenuItem>

                        </Menu>
                    </ContextMenu>
                    </TextBlock.ContextMenu>
                </TextBlock>
                <TextBlock Text="{Binding XPath=@key}"/>
            </StackPanel>
        </HierarchicalDataTemplate>

        <!-- ######################### Ini-Keys #########################################
        -->
        <HierarchicalDataTemplate
            DataType="inikey">
            <StackPanel Orientation="Horizontal">
                <Image Width="16" Height="16"
                       Source="Images/keyring.png"/>
                <TextBlock Text="{Binding XPath=@name}">
                    <TextBlock.ContextMenu>
                         <ContextMenu>
                        <Menu>

                            <MenuItem  HorizontalAlignment="Stretch" 
                                       VerticalAlignment="Stretch" 
                                       Height="Auto"
                                       Width="Auto"
                                       Header="{Binding XPath=@name}">

                                <MenuItem Header="_Find in Database"/>
                                <MenuItem Header="_Edit"  
                                          Tag="{Binding XPath=@value}"  
                                          />
                            </MenuItem>

                        </Menu>
                    </ContextMenu>
                    </TextBlock.ContextMenu>
                </TextBlock>
                <TextBlock Text="{Binding XPath=@value}"/>
            </StackPanel>
        </HierarchicalDataTemplate> 
```

我可以绑定到除标签之外的所有`<subproducts>`标签。我可以通过 XmlDocument 读取结构，但我会失去模板的所有优点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T22:01:54.447

我将反序列化您的 xml，然后使用以下项目的自定义树结构：

[http://www.codeproject.com/KB/WPF/versatile_treeview.aspx](http://www.codeproject.com/KB/WPF/versatile_treeview.aspx)

我有一个类似的问题（如何将自定义 XML 转换为树视图），我发现这个解决方案效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-03T13:42:19.243

在您的“产品”模板中，您只需要将 inifile 作为子级调用：

```
ItemsSource="{Binding XPath=inifiles/inifile}" 
```

您需要更改此设置，以便您还需要子产品。就像是：

```
ItemsSource="{Binding XPath=inifiles/inifile|subproducts}" 
```

您需要检查确切的 XPath 语法——我没有对此进行测试。

# visual-studio-2005 - Vista 上的 VSS 错误？

> ID：424978
> 
> 赞同：-1
> 
> 时间：2009-01-08T16:41:38.827
> 
> 标签：visual-studio-2005, windows-vista, visual-sourcesafe

我有一个使用 Visual SourceSafe 6.0 源代码控制的 VS2005 解决方案。我正在使用 Vista Ultimate 32 位。

当我关闭一个文件时，我不断收到此错误，并且在文件实际上不受源代码控制（例如 afxwin.h 或类似的东西）时似乎更频繁。但不会发生 100% 的时间。任何解决方法？还没有引起任何问题，但是很烦人。

```
--------------------------
微软视觉工作室
--------------------------
遇到意外错误。建议您重新启动
尽快申请。

错误：未指定的错误
文件：vsee\lib\path\cvapipath.cpp
行号：2459
--------------------------
好的   
--------------------------

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T16:52:18.587

您最好的选择（如果可以的话）是远离 VSS6.0。它的旧技术，特别是考虑到它使用文件系统，可能会给你在 Vista 下新的安全性带来一些严重的问题。

有很多免费的选择，但如果你想买东西，TFS 工作得很好，虽然你还需要一个 SQL 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T18:28:02.323

听起来像是 VStudio 中的一个真正的错误，您可以在产品反馈网站上向 MS 报告它。网址在[此链接](http://blogs.msdn.com/astebner/articles/451329.aspx)中，其中还包含有关如何编写好的报告的信息。

顺便说一句，我认为您可以升级到 VSS 2005，它实际上是相同的，但有一些更新，我认为它应该与 VS2005 一起工作得更好，而 IIRC 与 VS2005 一起是免费的。如果没有，请升级到 Subversion :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:05:09.760

删除 .suo 文件

# apache-flex - 在 Flex 中扩展 MX 类时，如何在 MXML 中引用它？

> ID：424982
> 
> 赞同：2
> 
> 时间：2009-01-08T16:42:46.217
> 
> 标签：apache-flex, oop

意思是，如果我有：

```
<mx:Tree>
    <!-- ... -->
</mx:Tree> 
```

我想通过（在 AS 中）更改某些控件的行为或添加功能：

```
class ChristmasTree extends mx.controls.Tree {
    // ...
} 
```

如何更改 MXML 以便使用我的类？

在[手册中，它说明了如何通过 MXML 扩展组件](http://livedocs.adobe.com/flex/3/html/components_11.html#195546)，但是如何使用 AS 来扩展组件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-08T16:46:27.927

好的，这是最好的lazyweb。当然它也在[TFM](http://livedocs.adobe.com/flex/3/html/ascomponents_3.html#170709)中，而且实际上非常整洁。在 AS 中，您可以：

```
package myComponents
{
    // as/myComponents/TextAreaFontControl.as    
    import mx.controls.TextArea;

    public class TextAreaFontControl extends TextArea 
    {

        // add / change behaviour, properties etc. ...

    }

} 
```

然后在 MXML 中，您可以：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
   xmlns:MyComp="myComponents.*">

<!-- ... -->

<MyComp:TextAreaFontControl /> 
```

凉爽的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-20T09:35:38.497

我觉得不是真的一样...

您的第二个示例仅在主应用程序中导入了自定义 TextArea 组件，您已经在 TextAreaFontControl mxml 文件中扩展了该组件。TextAreaFontControl 是一个组件，你的情况是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:TextArea xmlns:mx="http://www.adobe.com/2006/mxml">
    <!-- her comes the Script block and other suff -->
</mx:TextArea> 
```

U 通过从现有组件创建组件来扩展组件 多么废话：-P

# ms-word - 仅适用于 Word 的 VSTO 插件

> ID：424991
> 
> 赞同：1
> 
> 时间：2009-01-08T16:44:05.717
> 
> 标签：ms-word, vsto

我为 Word 2003 编写了一个 VSTO 插件，它工作正常。唯一的问题是插件会显示一个命令栏，当我在 Outlook 中创建新电子邮件时也会出现该命令栏。如何防止命令栏插件在 Outlook 上下文中仅在 Word 中显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:06:17.897

您的问题是 Outlook 使用 Word 作为电子邮件的编辑器。

您可以在 Outlook 中的工具选项邮件格式中将其关闭，或者您可能需要进行检测，例如 Document.Kind 属性，如果是电子邮件，则其值为 wdDocumentEmail (=2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:26:35.387

我还没有尝试过，但是您可以使用 Word 实例的 Parent 属性来确定其父级是否是 Outlook，并且在这种情况下不显示命令栏吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:10:28.693

父属性只是不断循环回 Microsoft Word，而不是 Outlook。我最终导入了 User32.dll 并获得了 Windows 名称，然后检查它是否包含 Microsoft Word。

我仍然遇到的唯一问题是，如果用户打开 Outlook，创建一条新消息，然后打开 Word，则 WINWORD.exe 进程仍然具有我假设为默认模板的内容，因此不会显示新的复制词我的插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-11T19:31:33.493

Word 中有几个属性可以让您检测它是否作为邮件编辑器运行。

App.MailEnvelope App.Envelope App.Email

所有返回电子邮件相关信息。如果没有将 word 用作电子邮件编辑器，我相信其中至少有一个不会返回任何内容，但我不再有权访问该代码，因此如果不尝试，我无法确定。

也就是说，我知道即使是 MS 也不建议使用 Word 作为电子邮件编辑器。在 Office 2007 和 2010 中，我认为这不再是一种选择。

# asp.net-mvc - 如何在 iis6 上为 ASP.NET MVC 中的单个路由设置 Windows 身份验证？

> ID：424992
> 
> 赞同：2
> 
> 时间：2009-01-08T16:44:49.910
> 
> 标签：asp.net-mvc, iis-6, windows-authentication

我正在开发一个 Web 应用程序，我需要将 Forms 和 Windows 身份验证混合在一起。

我选择的方法是：所有网站上的身份验证方法都必须是表单身份验证。有一个表单页面 ( `~/home/Login`) 可以通过表单身份验证登录。神奇（和麻烦）是只有一页（比如说`~/Home/WinLogin`）必须将身份验证方法设置为 Windows 身份验证。该页面用于读取`HttpContext.User.Identity.Name`获取windows用户名。

***我不知道如何在 iis6 上为一条特定路线设置 win auth？***

路线看起来像`~/Home.ashx/WinLogin`。好的，但是然后呢？我试图在虚拟目录和子目录 WinLogin 中创建目录 Home.ashx。但随后`~/Home.ashx/Login`（使用登录表单）停止工作。

因为在 iis6 上我们必须使用 ashx 处理程序，似乎没有其他方法可以做到这一点，而不是创建一个`~/WinLogin.aspx`可以完成工作的普通网页。但是我想避免这种情况并仅使用 MVC。

仅供参考如何设置 iis7：[IIS 7.0 服务器端博客](http://mvolo.com/blogs/serverside/archive/2008/02/11/IIS-7.0-Two_2D00_Level-Authentication-with-Forms-Authentication-and-Windows-Authentication.aspx) 它并不完美（Mike Volodarsky 必须创建自定义表单身份验证模块），但它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T16:58:16.530

您不能像在 IIS7 中那样在 IIS6 中选择性地设置 Windows 身份验证。但是，您可以将 home.ashx 设置为支持匿名和 Windows 身份验证；替换/Login案例中的HttpContext.User属性，在/WinLogin案例中使用windows原理。但是，您需要注意您的代码路径允许您希望他们使用表单身份验证但他们向您提供 Windows 原则身份并忽略它的情况。

# eclipse - 有没有办法从 Eclipse 的 Content Assist 中删除私有成员

> ID：424997
> 
> 赞同：1
> 
> 时间：2009-01-08T16:45:48.943
> 
> 标签：eclipse, intellisense, content-assist

我在 Eclipse 中编写 Java。我来自 Visual Studio，使用 Resharper 编写 C#。

当 Content Assist 出现时，我看到了一个班级的所有私人成员，即使我没有编辑那个班级。有没有办法可以关闭它？

这真的很让人分心。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T17:02:25.337

窗口 -> 首选项 -> Java -> 编辑器 -> 内容辅助 -> 隐藏在调用上下文中不可见的提议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T17:17:55.777

如果您没有明确编写方法的访问级别（public、protected 或 private），那么它将默认为 package-private，并且这些方法可能会显示在 Content Assist 中。*************