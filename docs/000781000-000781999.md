# StackOverflow 问答 000781000-000781999

# c++ - boost any library 的典型用法是什么？

> ID：781001
> 
> 赞同：21
> 
> 时间：2009-04-23T09:41:37.750
> 
> 标签：c++, boost

使用 boost.any 库有什么好处？你能给我一些现实生活中的例子吗？为什么不能通过在对象层次结构的根中使用一些泛型类型并使用该基本类型创建容器来实现相同的功能？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T09:49:10.353

boost::any 将愉快地存储整数和浮点数，这些类型显然没有基类。您可以使用它的真实示例是高级解释语言的虚拟机。您的“函数”对象将需要一组参数。这可以很容易地`std::list<boost::any>`在幕后实现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T11:53:41.520

我认为 Boost.Variant 应该始终是首选，因为它是非侵入性的，并且仍然需要非常结构化的编程。

但我猜 boost.any 背后的主要思想是提供 java 和 c# 对象类型的等价物。这是一种说“是的，我们可以”的方式！:-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T17:41:21.360

我们在属性映射 ( `std::map<std::string, boost::any>`) 中使用了它，以便在一个简单、扁平的数据空间中动态存储很多东西。

大多数情况下，我们要么存储 smart-ptr-to-scriptable-objects 或字符串，但有些条目存储其他类型（浮点数、vec3f、矩阵和其他非标准对象）。

它非常适用于向 c++ 添加更多动态功能，或者在任何您想要进行类型擦除的任何地方都可以将任何类型的数据添加到对象中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T09:53:17.333

> 为什么不能通过在对象层次结构的根中使用一些泛型类型并使用该基本类型创建容器来实现相同的功能？

这称为对象层次结构——一种你为解决外围问题而人为地注入设计的结构。此外，这样的构造很容易出错，错误的实现会造成严重破坏。`Boost.Any` *是*经过社区审查的安全、经过充分测试的替代方案。

> 你能给我一些现实生活中的例子吗？

[TinyJSON](http://blog.beef.de/projects/tinyjson/)使用`boost.Any`.

> 使用 boost.any 库有什么好处？

我参考[介绍性](http://www.boost.org/doc/libs/1_38_0/doc/html/any.html)文档。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T14:12:06.400

我们使用 boost.any 作为类型安全标记的可变参数容器的载体类型。这是什么意思：

我们有一个“筏”对象，它通过一组过滤器。当过滤器想要将数据添加到 raft 时，它可以执行以下操作：

```
raft.addTaggedData<ETag1>(3.0);
raft.addTaggedData<ETag2>("a string")`;
std::string str = raft.getTaggedData<ETag2>();
int a = raft.getTaggedData<ETag1>(); // <-- Compile error 
```

where`ETag1`和`ETag2`是枚举的成员，我们使用特征模板将标签映射到类型。

raft 类使用`list`of`pair<ETagType, boost::any>`作为后备存储。Boost.any 为我们节省了管理各种类型的原始缓冲区的痛苦。

# c# - 将项目添加到列表 / 防御性编程

> ID：781018
> 
> 赞同：2
> 
> 时间：2009-04-23T09:45:53.717
> 
> 标签：c#, defensive-programming

在添加到 C# 列表时明确检查/处理您没有达到 2^31 - 1 (?) 的最大条目数是疯狂的，是真是假？

（假设这是一个平均列表大小小于 100 的应用程序。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T09:56:41.553

**1.内存限制**

嗯，没有任何属性的 System.Object 的大小是 8 个字节（2x32 位指针），或 64 位系统中的 16 个字节。**[编辑：]**实际上，我刚刚签入 WinDbg，在 x86（32 位）上大小为 12 字节。

因此，在 32 位系统中，您将需要 24Gb 内存（在 32 位系统上无法拥有）。

**2\. 程序设计**

我坚信如此大的列表不应该保存在内存中，而应该保存在其他一些存储介质中。但在这种情况下，您将始终可以选择创建一个包装 List 的**缓存**类，该类将在后台处理实际存储。因此，在添加之前测试大小是错误的测试位置，如果有一天你发现有必要，你的 List 实现应该自己做。

**3\. 为了安全起见**

为什么不在每个方法中添加一个重入计数器来防止堆栈溢出？:)

所以，是的，测试它是疯狂的。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:50:35.950

显得过分了。根据列表中对象的大小，您不会先达到机器的内存限制吗？（我假设这个检查是由 List 类的用户执行的，在实现中没有任何检查吗？）

或许同事们都在提前考虑，这让人放心？（讽刺！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T09:51:55.323

看起来是这样，我可能不会包括支票，但我对此很矛盾。程序员曾经认为 2 位数字足以在日期字段中表示年份，理由是这对于他们的代码的预期寿命来说是可以的，但是我们发现这个假设是不正确的。

查看风险，查看努力并做出判断（也称为有根据的猜测！:-)）。我不会说对此有任何硬性或快速规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T09:52:12.500

正如上面的答案一样，我怀疑会出现更多问题而不是担心。但是，是的，如果你有时间和倾向，你可以打磨代码直到它发光！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T09:55:51.787

真的

（好吧，你问的是真还是假..）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T09:58:28.380

刚试过这段代码：

```
List<int> list = new List<int>();
while (true) list.Add(1); 
```

我得到了 System.OutOfMemoryException。那么你会怎么做来检查/处理这个？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T10:06:14.617

如果您继续向列表中添加项目，那么在达到该限制之前很久就会耗尽内存。我所说的“长”实际上是指“比你想象的要快得多”。

请参阅有关大对象堆 (LOB) 的[讨论。](http://blogs.msdn.com/maoni/archive/2006/04/18/large-object-heap.aspx)一旦你达到大约 21500 个元素（在 64 位系统上是一半）（假设你正在存储对象引用），你的列表将开始成为一个大对象。由于 LOB 的压缩方式与普通 .NET 堆不同，因此您最终会将其碎片化到无法分配足够大的连续内存区域的程度。

所以你根本不需要检查那个限制，这不是一个真正的限制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T10:07:08.407

是的，这就是疯狂。

考虑当您开始达到这些数字时其余代码会发生什么。如果列表中有数百万个项目，该应用程序是否可用？

如果应用程序甚至有可能达到这样的数据量，那么也许您应该采取措施来防止列表变得那么大。也许您甚至不应该一次将所有数据保存在内存中。我真的无法想象任何代码都可以实际使用这么多数据的场景。

# asp.net-mvc - asp.net mvc 数据注释验证

> ID：781033
> 
> 赞同：1
> 
> 时间：2009-04-23T09:51:39.007
> 
> 标签：asp.net-mvc, validation

我将在我的应用程序中为自定义对象创建一些验证。但是在尝试创建 CustomValidation 规则时我遇到了一些麻烦。我的对象有字段 - BirthDay - 这不是必需的，但如果用户输入它，我需要通过简单的验证来验证它，例如用户 DataType 验证 - DataType.DateTime。当我尝试这样做时，我遇到了验证错误 - 需要生日。当我创建自定义验证并始终返回 true 时，我有同样的错误。下面几行代码：

```
[MetadataType(typeof(User.Metadata))]
public class User
{
    #region Metadata        
    private class Metadata
    {
        [Required(ErrorMessage="Name is required")]
        [StringLength(5, ErrorMessage="Max Length is 5")]
        public string Name { get; set; }
        [CustomValidation(typeof(User), "ValidateBirthDay", ErrorMessage="We have trouble.")]
        public DateTime BirthDay { get; set; }

    }
    #endregion

    public static bool ValidateBirthDay(object value)
    {           
        return true;
    }

    public int? ID { get; set; }
    public string Name { get; set; }        
    public DateTime BirthDay { get; set; }
} 
```

ps对不起我的英语=）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T13:01:54.773

您需要使您的财产可以为空，即

```
public DateTime? BirthDay { get; set; }
```

所以它可以有一个空值并且不需要设置。

此外，您使用该`CustomValidation`属性的方式似乎也不正确。我相信您需要创建一个派生自`ValidationAttribute`基类的类，并将其类型传递给`CustomValidation`属性的第一个参数。

# php - Zend 框架 Gdata 的类图或对象图

> ID：781038
> 
> 赞同：0
> 
> 时间：2009-04-23T09:53:06.850
> 
> 标签：php, zend-framework, gdata, class-diagram, object-diagram

我正在寻找 Zend Gdata 的类图。[Zend_Gdata_Spreadsheets_SpreadsheetEntry 对象](http://framework.zend.com/manual/en/zend.gdata.spreadsheets.html)

我想知道是否有类图或者它是否称为对象图，因为这是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T15:35:31.243

由于找不到图表，您可以尝试使用以下工具之一生成图表：

*   [奥托迪亚](http://www.aarontrevena.co.uk/opensource/autodia/)
*   [php2xmi](http://tech.motion-twin.com/php_php2xmi.html)

# asp.net - 多语言：asp:label aganist html:label with asp:Literal

> ID：781042
> 
> 赞同：0
> 
> 时间：2009-04-23T09:53:55.740
> 
> 标签：asp.net, html

我正在向原型网站添加多语言支持。该站点是使用 html 标签开发的，我可以使用 asp:literal 进行多语言，或者我可以将它们全部更改为 asp:labels，如下所示。

```
<asp:label ID="lblAddress1" runat="server" Text='<%$ Resources:lblAddress1 %>' /></br> 

<label><asp:Literal ID="Literal1" runat="server" Text="<%$ Resources:lblAddress1 %>"></asp:Literal></label> 
```

网络东西不是我的专业领域，这里的人不认为有任何优势。你会选择什么，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:05:12.910

```
<asp:Literal> 
```

将此控件用作您希望在页面中插入的任何文本的占位符。输出不会包含在任何 html 标记标签中（最简单）。

```
<asp:Label> 
```

以与 相同的方式使用此控件，但是，此控件会将文本包装在 html 标记中。这些 span 标签允许控件具有可以利用的附加属性（css 样式等）。

```
<label> 
```

此 html 标记在页面中具有语义值，用于将表单元素与其描述相关联。

```
<label for="SaveLoginName">Remember Me:</label>
<input type="checkbox" id="SaveLoginName" /> 
```

浏览器可以使用此信息来提供其他辅助功能，例如启用单击文本来切换复选框值。

其中每一个都有适当的使用场景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T10:19:00.187

似乎是口味问题。虽然我认为第二个选项可能会给页面增加一点重量，因为文字通常被包裹在`<span`>

# mysql - MySQL：选择 X 最小值

> ID：781044
> 
> 赞同：0
> 
> 时间：2009-04-23T09:54:30.153
> 
> 标签：mysql, optimization, select, conditional-statements

让我们成为这样的表：

```
CREATE TABLE `amoreAgentTST01` (
  `moname` char(64) NOT NULL DEFAULT '',
  `updatetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `data` longblob,
  PRIMARY KEY (`moname`,`updatetime`) 
```

我有一个查询来查找每个不同的“moname”的最旧记录，但前提是这个“moname”有多个记录：

```
SELECT moname, updatetime FROM amoreAgentTST01 a 
WHERE (SELECT count(*) FROM amoreAgentTST01 x WHERE x.moname = a.moname) > 1 
  AND a.updatetime = (SELECT min(updatetime) FROM amoreAgentTST01 y WHERE y.moname = a.moname) ; 
```

我的问题是：如何做同样的事情，但选择 X 最旧的值？我现在简单地运行它，删除最旧的值并重新运行它......这不是很好。

秒的问题是：你觉得上面的查询怎么样？可以改进吗？有什么明显的坏习惯吗？

提前感谢您的建议和帮助。

巴特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:58:46.820

像这样的工作（未经测试）：

```
SELECT moname, MIN(updatetime) FROM amoreAgentTST01 
GROUP BY moname HAVING COUNT(moname)>1 
```

编辑 - 以上只是作为您现有代码的替代品，因此它不能直接回答您的问题。

我认为这样的事情应该适用于您的主要问题：

```
SELECT moname, updatetime FROM amoreAgentTST01 
GROUP BY moname, updatetime 
HAVING COUNT(moname)>1 
ORDER BY updatetime LIMIT 0, 10 
```

编辑 - 抱歉，上述方法不起作用，因为它只返回所有单名的 10 条记录 - 而不是每个最旧的 10 条。让我想一想。

再来一个（诚然，这个看起来有点复杂）：

```
SELECT a.moname, a.updatetime FROM amoreAgentTST01 a
WHERE EXISTS 
(SELECT * FROM amoreAgentTST01 b 
WHERE a.moname = b.moname AND a.updatetime = b.updatetime  
ORDER BY b.updatetime LIMIT 0, 10)
AND (SELECT COUNT(*) FROM amoreAgentTST01 x WHERE x.moname = a.moname) > 1 
```

我应该补充一点，如果有一个 ID 列——通常是主键——那么它应该用于子查询连接以提高性能。

# c# - 为什么在 VS 中切换到 release 不将 web.config 中的 debug 参数设置为 false

> ID：781046
> 
> 赞同：7
> 
> 时间：2009-04-23T09:55:28.357
> 
> 标签：c#, .net, asp.net-mvc, visual-studio

在 VS2008 中（如果我没记错的话，更早的版本）我有下拉菜单让我在调试和发布模式之间进行选择。一切安好。
当我将 VS 切换到 Release 时，我的 web.config 文件中的调试属性根本没有设置为 false。
这是应该的方式吗？我一定会忘记在部署时将其设置为正确的值。我应该采取什么措施来确保它正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:58:59.190

这是解决此问题的一种方法：

[http://blog.aggregatedintelligence.com/2009/04/aspnet-never-again-fear-publishing-your.html](http://blog.aggregatedintelligence.com/2009/04/aspnet-never-again-fear-publishing-your.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:57:50.957

那么您的 web.config 对于调试和发布（连接字符串、密码等）可能会有所不同，但如果不是，请查看将复制到不同文件的 postbuild 事件。

另请查看Scott Guthrie[的这篇博文。](http://weblogs.asp.net/scottgu/archive/2007/09/21/tip-trick-automating-dev-qa-staging-and-production-web-config-settings-with-vs-2005.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T10:00:50.623

更改发布模式不会更改 web.config，但是当您构建 Web 应用程序时，它将仅在发布模式下为 C# 文件构建 dll，而 IIS 使用 web.config 的调试打开/关闭来构建调试/发布版本ASPX 标记文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T10:00:13.120

构建风格只会影响代码的编译方式，不会影响您的配置文件。所以是的，回答你的问题，这就是它应该是的样子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T11:39:04.537

如果您有权访问仅托管生产应用程序的服务器的 machine.config，则该元素是一个很好的解决方案。

作为自动构建过程的一部分，我通常会在生成部署文件时修改 web.config 文件。例如，Web 部署项目可以执行 web.config 部分替换。我不喜欢 Web 部署项目的原因有很多，我倾向于使用简单的 VBS 文件来实现，该文件使用 MSXML 修改文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T11:50:58.393

您从 Bobby 中选择的答案不正确。当您在 VStudio 中时，Visual Studio 会在发布时为您构建文件。

IIS 在您部署时使用该设置在启动时编译代码。不是 bin 目录，而是 App_Code 和文件背后的代码。

您应该在部署之前预编译您的应用程序，这会将您的代码后面和 App_Code 目录编译到 bin 目录中的 dll 中。

如果您将部署工具设置为发布，部署工具会自动切换该设置

I use web deployment projects. [http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)

# javascript - 使用 iframe 监控点击次数/目标 Google Analytics？

> ID：781050
> 
> 赞同：2
> 
> 时间：2009-04-23T09:56:11.990
> 
> 标签：javascript, iframe, google-analytics, tracking, statistics

我们有一个网站，显示从其他域加载的 iframe 中的一些内容。我想做的是设置一些目标来跟踪这些东西是否被点击，这可以跟踪这些点击吗？

我知道这个内容在我们的域之外，但它仍然在域中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T11:22:58.880

有可能的。由于目标跟踪是基于配置文件的，因此关键是将所有域跟踪到一个配置文件中。请参阅*[如果我的网站跨多个域，如何安装跟踪代码？](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55503)*在 Google Analytics 帮助中输入以获取更多说明。之后，您的 iframe 内容将像通常的 PageViews 一样出现在报告中。（例如，如果您使用`<iframe src="http://otherdomain.com/stuff"></iframe>`，您会发现 '/stuff' 的 PageViews。）

否则，我真的不知道你在“东西被点击”下的意思。如果它是您要跟踪的 iframe 中的对象，您可以在访问者点击它时生成一个虚拟 PageView：

```
pageTracker._trackPageview("/Stuff_clicked"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-12T13:49:59.227

如果您无法在 iFrame 中加载的所谓的另一个域上安装 GATC（Google Analytics 跟踪代码），很遗憾，您将无法跟踪这些域的任何点击或虚拟页面浏览量。任何域上发生的任何点击或事件都可以追溯到您的帐户，只要您的 GATC 包括您的 Google Analytics ProfileID，例如 UA-XXXX-X 安装在该页面上。

# silverlight - 如何将默认样式应用于自定义控件中的控件

> ID：781052
> 
> 赞同：1
> 
> 时间：2009-04-23T09:56:52.597
> 
> 标签：silverlight, xaml

我有一个自定义控件，它动态添加了许多复选框。我不知道如何从自定义控件中的代码（来自 generic.xaml 文件）中为它们应用默认样式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T11:01:08.803

我在这里摸不着头脑，但是您是否有一个默认的“主题”文件，您想将其应用于某些自定义 UserControl 中动态添加的 UI 元素？

如果是这样，

尝试类似：

```
public Page()
        {
            InitializeComponent();
            Uri uri = new Uri(@"QuoteInterface;component/Theme/WhistlerBlue.xaml", UriKind.Relative);
            ImplicitStyleManager.SetResourceDictionaryUri(LayoutRoot, uri);
            ImplicitStyleManager.SetApplyMode(LayoutRoot, ImplicitStylesApplyMode.Auto);
            ImplicitStyleManager.Apply(LayoutRoot);
        } 
```

这似乎对我有用，即使我添加了动态生成的用户控件

# ruby - 将整数数组转换为Ruby中的字符串数组？

> ID：781054
> 
> 赞同：66
> 
> 时间：2009-04-23T09:57:36.840
> 
> 标签：ruby

我有一个数组：

```
int_array = [11,12] 
```

我需要将其转换为

```
str_array = ['11','12'] 
```

我是这项技术的新手

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-04-23T09:58:41.563

```
str_array = int_array.map(&:to_s) 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-04-23T10:09:33.987

```
str_array = int_array.collect{|i| i.to_s} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-04-14T09:08:22.767

**array.map(&:to_s)** => 整数数组转换成字符串数组

**array.map(&:to_i)** => 字符串数组转换为整数数组

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-07-09T12:13:00.507

map 和 collect 函数在这里的工作方式相同。

```
int_array = [1, 2, 3]

str_array = int_array.map { |i| i.to_s }
=> str_array = ['1', '2', '3'] 
```

您可以通过一行来实现：

```
array = [1, 2, 3]
array.map! { |i| i.to_s } 
```

你可以使用一个非常酷的 proc 快捷方式：（[https://stackoverflow.com/a/1961118/2257912](https://stackoverflow.com/a/1961118/2257912)）

```
array = [1, 2, 3]
array.map!(&:to_s) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-23T11:14:10.413

启动irb

```
irb(main):001:0> int_array = [11,12]
=> [11, 12]
irb(main):002:0> str_array = int_array.collect{|i| i.to_s}
=> ["11", "12"] 
```

您的问题可能在其他地方。也许是范围混乱？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-15T07:17:15.680

最短的选择：

```
int_array.map!(&:to_s) 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2011-02-16T08:40:57.350

# 返回整数

```
x = [1,2,3,4,5,6,7,8,9,10] # => [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

# 返回字符串

```
y = 1,2,3,4,5 # => ["1", "2", "3", "4", "5"] 
```

# java - 使用 HTTP OPTIONS 检索有关 REST 资源的信息

> ID：781056
> 
> 赞同：2
> 
> 时间：2009-04-23T09:58:04.387
> 
> 标签：java, http, rest, restlet

这个问题与 Restlet 框架和 Java 有关

当客户端想要发现服务器上可用的资源时 - 他们必须发送一个带有 OPTIONS 作为请求类型的 HTTP 请求。我猜这对于非人类可读的客户端来说很好 - 即在代码中而不是在浏览器中。

我在这里看到的问题是 - 使用 GET 的浏览器（人类可读）将无法快速发现它们可用的资源并找到一些额外的帮助文档等 - 因为它们不使用 OPTIONS 作为请求类型。

有没有办法让浏览器发送一个 OPTIONS/GET 请求，以便服务器可以将格式化的 XML 回火给客户端（因为这就是在 Restlet 中发生的事情 - 即服务器响应是将所有信息作为 XML 发送回），并显示这在浏览器中？或者我的想法全错了——即 OPTIONS 的重点是在客户端代码中使用，而不是通过浏览器读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T10:12:18.817

使用[`TunnelService`](http://www.restlet.org/documentation/1.1/api/org/restlet/service/TunnelService.html)（默认情况下已启用）并将`method=OPTIONS`查询参数添加到您的 URL。

（[Restlet FAQ Q19](http://www.restlet.org/documentation/1.1/faq#19)是一个类似的问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T10:14:39.077

我认为 OPTIONS 并非设计为“用户可见”。

你将如何从浏览器发送一个 OPTIONS 请求？（请注意，表单元素只[允许](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.1)GET 和 POST）。

您可以使用[XmlHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest)发送它，然后在您的 Javascript 回调中取回 XML 并适当地呈现它。但我不相信这是您的用户应该真正了解的事情！

# sql - 在多个表中报告层次结构

> ID：781068
> 
> 赞同：0
> 
> 时间：2009-04-23T10:00:26.333
> 
> 标签：sql, database-design

我正在研究一个使用多个表来表示报告层次结构的应用程序的怪物，但这些表中的每个表都是相同的。层次结构底部的表具有最多的记录，每条记录都有其上方汇总表的 ParentID，最终在顶部汇总表中全部加起来只有一个总数。

我被带有硬编码连接和表名的庞大“if”代码块困扰到精神错乱，我正在努力识别不使用单个表的一些理智原因，每行都有一个 levelID，而不是一个表对于每个级别，所有这些级别，或同一张表上的至少几个视图。后者是因为数据库被设计用于 MSAccess，它不允许别名子查询 AFAIK。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:47:49.020

这些表的语义是否都相同或只是形式相同？如果表格在形式和语义上都相同，那么单个表格解决方案可能要优越得多，但我对您的案例的了解还不够，无法确定。

在 SQL 表中表示层次结构可能是一个很大的挑战。幸运的是，报告层次结构通常足够小且足够稳定，因此可以使用各种技术。

最简单的技术称为“邻接表”模型。在此模型中，有两列，其中一列引用另一列。我会称它们为 MyTable(ID, ParentID)。在实际情况下，Mytable 会有其他列。ParentID 引用同一表的不同行中的 ID。这很容易实现，也很容易更新。进行汇总可能会很痛苦。

另一种技术称为“嵌套集”。称它为 MyTable（ID、lft、rgt、Level）。（级别是多余的，经常被省略）。这里我们有两列（lft 和 rgt）显示行适合层次结构的位置，因为 lgt 和 rgt 嵌套在所讨论节点的所有祖先的 lft 和 rgt 内。这种技术很难更新。进行汇总、查找子树、祖先路径以及许多其他类型的查询很容易。

“扁平化层次结构”的第三种方法。在这种技术中，层次结构的每个级别都有自己的命名列，并且每一行都显示其整个祖先，一直到层次结构的顶点。这里我们有 MyTable（ID、Division、Department、Group、Team）。Division，Department，Group和Team是层次结构的所有级别。这对于通过点击向下钻取界面访问数据的用户来说最终很容易，因为如果列名选择得当，他们就没有什么可学习的了。每个级别都需要一个名称。它不能很好地适应不确定的层次结构。它有很多冗余。一般来说，扁平的层次结构是从以邻接列表形式或嵌套集合形式存储层次结构的表中自动生成的。

这些中的任何一个都是为层次结构中的每个级别单独表的一个很好的替代方法。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2010-08-31T13:44:16.863

这里已经提出了很好的解决方案。我会添加一个以使用分层数据库，例如超图。

# javascript - 使日期对象考虑时区

> ID：781069
> 
> 赞同：1
> 
> 时间：2009-04-23T10:00:40.543
> 
> 标签：javascript, date, timezone

我正在使用以下代码：

```
$.log('Ending time: ' + ending_time);
$.log('Now: ' + new Date());
$.log('Difference: ' + new Date(ending_time - new Date())); 
```

输出如下：

```
Ending time: Thu Apr 23 2009 14:31:29 GMT+0200
Now: Thu Apr 23 2009 11:56:02 GMT+0200
Difference: Thu Jan 01 1970 03:35:26 GMT+0100 
```

我正在使用“差异”来显示还有多少小时和分钟`ending_time`，但是由于时区差异，我得到了错误的时间（偏移一小时。）所以有没有什么巧妙的方法来计算差异时区考虑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T10:04:01.177

您应该能够使用 getTimezoneOffset 函数。

[在这里](http://www.w3schools.com/jsref/jsref_getTimezoneOffset.asp)查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T10:07:33.617

您可以使用以下内容：

```
(new Date()).getTimezoneOffset() 
```

这将以分钟为单位为您提供客户端浏览器的时区偏移量。当然你还需要知道结束时间的时区偏移量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T17:35:44.447

您不再处理日期，因此不要将其转换为日期。您有时差，例如没有时区。结果应该以毫秒为单位，因此请根据需要执行适当的数学运算以获取分钟、小时、天或以上所有信息。

# asp.net - ASP.NET Webpart 静态连接

> ID：781072
> 
> 赞同：0
> 
> 时间：2009-04-23T10:01:17.517
> 
> 标签：asp.net, web-parts, connection

我在两个不同的 webpart 区域中有两个 webpart。他们使用网格视图提供主/详细方案。它们是使用静态连接定义的。最初这很好用。

一旦我关闭其中一个 Web 部件，我就会收到消息“您即将关闭 Web 部件。它当前正在向其他 Web 部件提供数据，如果关闭此 Web 部件，这些连接将被删除。单击“确定”继续。

这本身很好，所以我单击关闭并关闭我的部分。但是，当我打开目录区域并重新添加 web 部件（添加得很好）时，部件之间的连接被破坏（如消息所述）。

但是，我的 HTML 中的 webpart 连接仍然可见。我只能假设它使用 ASPNET 成员资格或其他来记住连接的 ID 而不是启用它。

我的问题是如何以代码或其他方式重新启用连接！？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T10:40:55.580

好的，我已经解决了我的问题。我将以下内容添加到 WebpartManager.WebpartAdded()

```
 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    Dim wp1 As WebPart = zoneDiaryTopLeft.WebParts("Ucl_Diary_Summary1")
    Dim wp2 As WebPart = zoneDiaryTopRight.WebParts("Ucl_DiaryAwaitingReview1")

    Dim providerConnectionPoint As ProviderConnectionPoint = _
    WebPartManager1.GetProviderConnectionPoints(wp1)("IMessageProvider")

    Dim consumerConnectionPoint As ConsumerConnectionPoint = _
    WebPartManager1.GetConsumerConnectionPoints(wp2)("IMessageConsumer")

    Dim returnValue As WebPartConnection
    returnValue = WebPartManager1.ConnectWebParts(wp1, providerConnectionPoint, wp2, consumerConnectionPoint)
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' 
```

总而言之，它如何知道/存储已删除的连接并记住不允许它处于活动状态！？如果我可以停止连接被删除或重新启用它会容易得多。我知道动态连接是一种选择，但我不希望用户拥有这种能力，因为他们很难理解您可以在屏幕上拖动 web 部件这一事实。联系对他们来说是火箭科学。

# sql - LinQ to SQL 和 CLR 用户定义类型

> ID：781081
> 
> 赞同：2
> 
> 时间：2009-04-23T10:05:40.203
> 
> 标签：sql, clr, user-defined-types

根据我的博客条目，我在 .Net 3.5 中创建了一个用户定义类型：

[http://jwsadlerdesign.blogspot.com/2009/04/this-is-how-you-register.html](http://jwsadlerdesign.blogspot.com/2009/04/this-is-how-you-register.html)

这在将 SQL 与 nHibernate 等技术结合使用时效果很好。

但是，当我尝试将 LinQ 映射到 SQL 类以使用此 UDT（属性定义不是 XML）时，我将属性设置为枚举。我无法让 LinQ 映射到这种类型。我尝试过 Image、Binary、varchar 和 integer，所有这些似乎都会发出 Invalid Cast 错误。

特别是我收到错误'无法将'ISTD.InstallManager.Common.Classes.SQLUDTTargetType'类型的对象转换为'System.Byte []'任何想法或帮助将不胜感激。

詹姆士。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-27T21:56:30.930

**更新：**我最近自己遇到了这个问题，发现以前的解决方案并不完整。尽管所有文档都说了什么，但**可以**做到这一点，但有些痛苦。

第一步，为了您自己的方便，是实现一些转换运算符：

```
public class MyUDT : INullable, IBinarySerialize
{
    // Class implementation would go here
    // ...

    public static explicit operator MyUDT(byte[] data)
    {
        using (MemoryStream stream = new MemoryStream(data))
        {
            using (BinaryReader reader = new BinaryReader(stream))
            {
                MyUDT result = new MyUDT();
                result.Read(reader);
                return result;
            }
        }
    }

    public static explicit operator byte[](MyUDT x)
    {
        using (MemoryStream ms = new MemoryStream())
        {
            using (BinaryWriter writer = new BinaryWriter(ms))
            {
                x.Write(writer);
            }
            return ms.ToArray();
        }
    }
} 
```

无论您如何声明该属性，Linq to SQL 仍将完全拒绝为您提供 UDT 字段。所以你必须给它一个二进制字段。为此，您不需要存储过程或任何自定义 SQL，只需在表中添加一个计算列：

```
ALTER TABLE MyTable
ADD UDTField_Data AS CAST(UDTField AS varbinary(len)) 
```

其中*len*是您的 UDT 在**MaxByteSize**属性中定义的任何内容。

现在您终于可以访问列数据了。您可能想使用 UDT 作为新属性的返回类型，认为 Linq to SQL 会找到您的转换运算符并自动从字节数组转换；不要打扰。Linq to SQL 将确定它实际上是一个序列化的 .NET 对象，并吐出一条消息，大意是“输入流不是有效的二进制格式”。相反，您需要另一层间接：

```
private MyUDT udtField;

[Column(Name = "UDTField_Data", DbType = "varbinary(len)")]
private byte[] UdtFieldData
{
    get { return (byte[])udtField; }
    set { udtField = (MyUDT)value; }
}

public MyUDT UdtProperty
{
    get { return udtField; }
    set { udtField = value; }
} 
```

一些注释可以清楚地说明这里发生了什么：

*   实际的字段数据 ( **udtField** ) 被声明为 UDT 本身，而不是字节数组。这样做的原因是我们只希望在从数据库加载或保存到数据库时发生转换。如果每次访问时都必须将字节数组转换为 UDT，这不仅会损害性能，而且如果 UDT 声明了任何可变字段，则会导致不一致。
*   原始 byte[] 属性 ( **UdtFieldData** ) 被声明为私有，因此消费者只能看到 UDT 本身。只要具有 [Column] 属性，Linq to SQL 仍会读取它。
*   UdtFieldData**属性****不声明存储**属性。这很关键；如果您尝试使用 UDT 字段作为存储属性，您将得到相同的类型转换错误。
*   最后，**UdtProperty**属性是消费者实际访问数据的方式。对他们来说，它看起来像任何其他财产。

不幸的是，你必须跳过这么多圈才能让它工作，但它确实有效。您可能很难通过 Linq 表面设计器进行这种按摩，这只是我不使用它的几个原因之一；最好自己编写类并在必要时使用 SqlMetal 来帮助您。

# wpf - 如何在 MVVM 模式中验证 ViewModel 中的数据？

> ID：781083
> 
> 赞同：1
> 
> 时间：2009-04-23T10:06:03.090
> 
> 标签：wpf, validation, mvvm

[我昨天在 MVC、MVP、MVVM 上](http://herdingcode.com/?p=177)收听了这个从众代码播客，并被将整个 ViewModel 对象发送到验证器的想法所震惊，该验证器除了验证其中的所有字段并将其发回之外什么都不做。

*   **有没有人实施过这种类型的验证模式？**
*   它在技术上看起来如何？

我正在考虑通过还有一个“FormPreparer”来扩展这个想法，它在将模型数据、字段元数据和其他用户和上下文数据输入其中之后接收整个 ViewModel，然后这个“FormPreparer”准备表单上的所有字段这将在视图上，例如

*   日期字段由 DatePicker 控件表示
*   电子邮件字段由带有电子邮件验证的文本框表示
*   例如，客户字段是客户的下拉列表

元数据定义了每个字段的这些内容：

*   类型（文本、日期、日期/时间、持续时间、电子邮件、网址、客户）
*   控件（文本框、多行文本框、下拉菜单、单选按钮、复选框、点击按钮）
*   标签（例如“名字”）
*   帮助文本（例如“这是您在表格 4A 顶部找到的数字”）
*   示例（“#123ABCD”）
*   显示选项卡（例如，对于由多个选项卡区域组成的表单）
*   显示区域（例如，用于将字段分组为区域的表单）
*   显示顺序（例如组中字段的顺序）
*   值（例如“吉姆”）
*   自动建议数据（用户开始输入时需要显示的名称数组）
*   字段状态（只读、编辑、隐藏）

“FormPreparer”将结合所有这些信息，然后将数据呈现给视图，其中：

*   在适当的控件中显示所有表单数据（日期选择器，多行文本框中的描述等）
*   自动处理所有验证
*   只会显示当前用户可以查看的字段，并且只会让他编辑允许编辑的数据
*   等等

**有没有人按照这些思路编写了 WPF/MVVM 应用程序？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-24T19:21:30.390

不。我正在开发一个 WPF/MVVM 项目，但我们还没有采用这种通用的验证方法。我们正在每个视图模型中创建一个自定义验证方法，其中包含特定于每个视图模型的验证逻辑。

可用于所有视图模型的通用验证例程会很棒。

# objective-c - QTKit PAL 模式

> ID：781087
> 
> 赞同：2
> 
> 时间：2009-04-23T10:06:38.190
> 
> 标签：objective-c, macos, quicktime, qtkit

我使用 QTKit 的 MyRecorder 示例，它记录了所有内容，但我的相机是 PAL 并且 PAL 和 NTSC 的 H264 编码的分辨率不同。PAL 为 724x568，NTSC 为 724x480。

当我为 H264High 选择 QT 配置文件时，默认情况下它只需要 724x480 NTSC 分辨率输出文件，但我的相机是 724x568，因此最终输出在移动对象之间有很多不需要的水平线。

我知道问题只是分辨率设置，但 QTKit 编码如此紧密，没有设置可以更改任何编码器参数。

然而，Apple 建议仅使用 QTKit 而不是早期的序列采集器方法，但我们的庞大客户群将只有 PAL 相机，我们需要一些解决方案来启用 PAL 分辨率。谁能指导我们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T18:00:20.443

到目前为止，他们看起来并不是使用 QTKit 做到这一点的简单方法。

仅使用 QTKit 你有几个选择：

1.  您可以做的是使用 将相机中的数据简单地流式传输到 Quicktime 电影中`QTCompressionOptionsLosslessAnimationVideo`，然后使用 QTMovie 类将文件转换为您想要的分辨率的 H.264。此选项会占用大量磁盘空间，但相当简单。

2.  使用[QTCaptureDecompressedVideoOutput](http://developer.apple.com/documentation/QuickTime/Reference/QTCaptureDecompressedVideoOutput_Ref/Introduction/Introduction.html)而不是`QTCaptureMovieFileOutput`，当您调用[outputVideoFrame:withSampleBuffer:fromConnection:](http://developer.apple.com/documentation/QuickTime/Reference/QTCaptureDecompressedVideoOutput_Ref/Introduction/Introduction.html#//apple_ref/occ/instm/QTCaptureDecompressedVideoOutput/outputVideoFrame:withSampleBuffer:fromConnection:)时，将视频帧缓冲在线程安全队列中。然后在辅助线程中，从该队列中拉出帧并将帧添加到您已设置为使用 PAL 分辨率进行 H.264 编码的 QTMovie。

方法 2 将为您节省磁盘空间，但工作量更大，您将不得不担心线程问题，但在 QTCaptureMovieFileOutput 类中有更多可供我们使用的选项之前，这是您能做的最好的。

# unit-testing - 在单元测试中使用随机性和/或迭代？

> ID：781092
> 
> 赞同：8
> 
> 时间：2009-04-23T10:08:24.927
> 
> 标签：unit-testing

在单元测试中，我已经习惯于测试应用一些常规值的方法，一些违反方法契约的值，以及我能想到的所有边界情况。

但是这是非常糟糕的做法吗

*   对随机值进行测试，这是您认为永远不会有任何麻烦的范围内的值，因此每次测试运行时，都会传入另一个值？作为对常规值的一种广泛测试？
*   使用迭代测试整个范围？

我感觉这两种方法都不好。通过范围测试，我可以想象这样做是不切实际的，因为它需要时间，但是随机性？

更新 ：

我自己没有使用这种技术，只是想知道它。随机性可以是一个很好的工具，我现在知道，如果你可以在需要时让它可复制。
最有趣的回复是来自 Lieven 的“模糊”提示：

[http://en.wikipedia.org/wiki/Fuzz_testing](http://en.wikipedia.org/wiki/Fuzz_testing)

发送

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T11:06:35.940

1.  随机输入 - 测试将不可**重复**（每次运行时都会产生一致的结果，因此不被认为是好的单元测试。测试不应该改变主意。
2.  范围测试 / RowTests - 只要它们不减慢测试套件的运行速度就很好。每个测试都应该尽可能**快**地运行。（在 30 秒内完成的测试套件比 10 分钟更频繁地运行） - 最好是 100 毫秒或更短。也就是说，每个输入（测试数据）都应该是“代表性”输入。如果所有输入值都相同，则测试每一个都不会增加任何值，而只是例行的数字运算。您只需要该组值中的一个代表。您还需要边界条件和“特殊”值的代表。

有关指南或拇指规则的更多信息 - 请参阅[“什么是好的单元测试？”](https://stackoverflow.com/questions/61400/what-makes-a-good-unit-test)

就是说...您提到的技术可以很好地**找到**具有代表性的输入。因此，使用它们来查找代码失败或错误成功的场景X-然后为此编写一个可重复的，快速的，仅测试一件事的单元测试场景X 并将其添加到您的测试套件中。如果您发现这些工具继续帮助您找到更多好的测试用例.. 坚持使用它们。

*回应OP的澄清：*

*   如果您在每次测试运行时对随机无生成器使用相同的种子值（测试输入），则您的测试不是随机的 - 可以预先确定值。然而，理想情况下，单元测试不应该需要任何输入/输出——这就是 xUnit 测试用例具有 void TC() 签名的原因。
*   如果您在每次运行时使用不同的种子值，那么现在您的测试是随机的且不可重复。当然，您可以在日志文件中查找特殊的种子值以了解失败的原因（并重现错误），但我喜欢我的测试立即让我知道失败的原因 - 例如红色的 TestConversionForEnums() 让我知道枚举转换代码在没有任何检查的情况下被破坏。

可重复 - 意味着每次在 SUT 上运行测试时，它都会产生相同的结果（通过/失败）......而不是“我可以再次重现测试失败吗？” （**可重复！= 可重现**）。重申一下.. 这种**探索性测试**可能有助于识别更多测试用例，但我不会将其添加到我在白天每次更改代码时运行的测试套件中。我建议手动进行探索性测试，找到一些好的（有些可能使用虐待狂的）测试人员，他们会对你的代码进行锤击和钳子......会找到比随机输入生成器更多的测试用例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T10:13:44.443

单元测试需要快速。如果不是，人们就不会定期运行它们。有时我会编写代码来检查整个范围，但@Ignore 最后将其注释掉，因为它使测试太慢了。如果我要使用随机值，我会选择带有固定种子的 PRNG，这样每次运行实际上都会检查相同的数字。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T16:44:10.600

我一直在我的测试用例中使用随机性。它在 SUT 中发现了一些错误，并在我的测试用例中给了我一些错误。

请注意，使用随机数会使测试用例变得更加复杂。

*   您需要一种方法来使用失败的随机值运行测试用例
*   您需要记录用于每个测试的随机值。
*   ...

总而言之，我正在重新使用随机性，但没有彻底放弃它。与每一种技术一样，它也有其价值。

为了更好地解释您所追求的，请查看术语[fuzzing](http://en.wikipedia.org/wiki/Fuzz_testing)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T11:07:56.060

您所描述的通常称为基于规范的测试，并且已由[QuickCheck](http://www.cs.chalmers.se/~rjmh/QuickCheck/) (Haskell)、[scalacheck](http://code.google.com/p/scalacheck/) (Scala) 和[Quviq QuickCheck](http://www.cs.chalmers.se/~rjmh/ErlangQC/) (Erlang) 等框架实现。

基于数据的测试工具（例如`DataProvider`在[TestNG](http://testng.org/doc/documentation-main.html#parameters-dataproviders)中）可以达到类似的结果。

基本原则是根据某种规范为被测对象生成输入数据，这远非“坏习惯”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T10:11:26.400

你在测试什么？随机数发生器？还是你的代码？

如果您的代码，如果代码中存在产生随机数的错误怎么办？

如果您需要重现问题，您是否会不断重新启动测试，希望它最终会使用与您发现问题时相同的顺序？

如果您决定使用随机数生成器来生成数据，请至少使用一个已知的常数值对其进行种子化，这样很容易重现。

换句话说，您的“随机数”只是“我真的不太关心的数字序列”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T13:58:25.590

我使用随机性来调试状态机泄漏资源的现场问题。我们检查了代码，运行了单元测试并且无法重现泄漏。

我们将来自整个可能事件空间的随机事件馈送到状态机单元测试环境中。我们在每个事件之后查看不变量，并在它们被违反时停止。

随机事件最终暴露了一系列导致泄漏的事件。当从第一个错误恢复时发生第二个错误时，状态机泄漏了资源。

然后，我们能够在现场重现泄漏。

所以随机性发现了一个其他方式很难发现的问题。有点蛮力，但电脑不介意周末工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T11:09:31.673

单元测试的目标是让您对代码充满信心。因此，如果您*觉得*使用随机值可以帮助您找到更多的错误，那么您显然需要更多的测试来提高您的信心水平。

在这种情况下，您可以依靠基于迭代的测试来识别这些问题。我建议为循环测试发现的案例创建新的特定测试，然后删除基于迭代的测试；这样他们就不会减慢您的测试速度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T10:14:17.627

只要它会以某种方式告诉您它失败的随机值，我认为它不会那么糟糕。但是，您几乎要靠运气才能在您的应用程序中发现问题。

测试整个范围将确保您涵盖了所有途径，但是当您涵盖边缘并且我假设一些中间立场可接受的值时，这似乎有点过分了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T16:35:42.970

这里的“关键”点是单元测试。如果种子是恒定的，则在回归测试中，大量随机值在预期范围内以及好的情况下的边缘和坏情况下的外部范围/边界中是有价值的。

如果可以始终在前后保存输入/输出（如果有），则单元测试可以使用预期范围内的随机值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-25T00:00:49.443

请参阅 David Saff 关于[基于理论的测试](http://dspace.mit.edu/handle/1721.1/40090)的工作。

一般来说，我会避免单元测试中的随机性，但理论的东西很有趣。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-23T11:07:34.220

我不会提倡完全随机的值，因为它会给你一种错误的安全感。如果您不能遍历整个范围（通常是这种情况），那么手动选择一个子集会更有效。这样，您还必须考虑可能的“奇数”值，这些值会导致代码以不同方式运行（并且不在边缘附近）。

您可以使用随机生成器生成测试值，检查它们是否代表一个好的样本，然后使用它们。这是一个好主意，特别是如果手动选择太耗时的话。

当我编写信号量驱动程序以用于来自两个不同芯片的硬件块时，我确实使用了随机测试值。在这种情况下，我无法弄清楚如何为时间选择有意义的值，所以我随机化了芯片（独立地）尝试访问块的频率。回想起来，手动选择它们仍然会更好，因为让测试环境以两种芯片不对齐的方式工作并不像我想象的那么简单。这实际上是一个很好的例子，说明随机值不会创建随机样本。

问题是由于当另一个芯片保留了块时，另一个芯片等待并且真正的信号量在另一个释放它后立即获得访问权。当我绘制芯片必须等待访问多长时间时，这些值实际上远非随机。最糟糕的是，当我对两个随机值具有相同的值范围时，在我将它们更改为具有不同范围后它会稍微好一些，但它仍然不是很随机。只有在我随机化了访问之间的等待时间和块的保留时间并仔细选择了四个集合之后，我才开始进行随机*测试*。

最后，我可能最终花费了更多的时间来编写代码来使用“随机”值，而不是我一开始用来手动选择有意义的值。

# asp.net - ASP.NET 事务

> ID：781093
> 
> 赞同：1
> 
> 时间：2009-04-23T10:08:43.147
> 
> 标签：asp.net

我的网站中有一些代码将详细信息添加到表格中。现在我希望如果发生一些错误，应该删除以前输入的数据。如何在交易的帮助下实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T10:13:25.287

我们需要更多详细信息，例如您使用的数据库等等。基本上你这样做：

创建交易

在该事务的上下文中做一些工作

在该事务的上下文中做更多的工作

...

如果发生异常，则回滚事务，否则提交。

# bazaar - 如何告诉 Bazaar 文件是二进制文件

> ID：781095
> 
> 赞同：2
> 
> 时间：2009-04-23T10:09:23.940
> 
> 标签：bazaar

这是为了避免在存在冲突时在该文件中包含一些**<<<**或一些**>>> 。**

如果有冲突，我只想要一条消息告诉我有冲突，并且 bazaar 不应该弄乱文件。

使用 subversion，您可以修改**svn:mime-type**属性。但是不知道Bazaar有没有这个功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T10:19:26.660

该[参考资料](http://doc.bazaar-vcs.org/bzr.dev/en/user-reference/bzr_man.html#end-of-line-conversion)说，到目前为止还没有明确的说法：

> Bazaar 目前依靠 [原文如此] 内容分析来检测二进制文件中的 diff 等命令。将来`binary = true`可能会添加规则，但尚不支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T11:25:19.203

这很烦人，但您仍然拥有未更改的 .BASE、.OTHER 和 .THIS 文件，您只需将更改后的文件替换为您需要的文件即可。
可以写脚本，我想。

# delphi - 对象的引用计数

> ID：781100
> 
> 赞同：8
> 
> 时间：2009-04-23T10:10:09.727
> 
> 标签：delphi, interface, reference-counting, tinterfacedobject

在我的代码中，我使用了一个在不同位置创建的小型数据存储类。为了避免内存泄漏和简化事情，我想使用引用计数，所以我做了

```
type TFileInfo = class (TInterfacedObject, IInterface) 
```

并删除了我对 TFileInfo.Free 的所有手动调用。不幸的是，Delphi 报告了很多内存泄漏。搜索 SO 我发现以下问题解释了为什么这不起作用：

[为什么不收集 TInterfacedObject 的后代垃圾？](https://stackoverflow.com/questions/484937/why-arent-descendants-of-tinterfacedobject-garbage-collected)

那里提供了一种解决方法，但它需要我（至少如果我做对了）编写自定义接口 IFileInfo 并为其提供很多我想避免的 getter 和 setter。

**编辑**我应该补充一点，我将创建的 FileInfo 对象插入到两种不同类型的哈希表中：一种从 TBucketList 下降，另一种是来自 Codegear 论坛的哈希映射实现。在内部，它们都是用户指针，所以情况就像另一个问题一样。

是否有任何其他可能使 Delphi 中的对象使用引用计数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T17:03:51.013

Delphi 中的引用计数仅在您仅通过接口引用您的实例时才有效。一旦你混合了接口引用和类引用，那么你就有麻烦了。

本质上，您需要引用计数，而无需创建包含其中定义的所有方法和属性的接口。有三种方法可以做到这一点，这些方法大致按照我推荐的顺序排列。

1.  Barry Kelly 写了一篇关于[智能指针](http://barrkel.blogspot.com/2008/09/smart-pointers-in-delphi.html)的文章。它使用 Delphi 2009 中的泛型，但我敢肯定，如果您尚未使用 2009，您可以将其硬编码为您正在使用的特定类型的版本（顺便说一句，这是一个很棒的版本）。

2.  另一种适用于更多版本的 Delphi 和更少修改的方法是Janez Atmapuri Makovsek的[值类型包装器。](http://cc.embarcadero.com/Item/25670)这是为 TStringList 实现的示例，但您可以将其调整为任何类型。

3.  第三种方法是创建一个接口指针（类似于巴里的智能指针，但不是那么智能）。我相信JCL中有一个，但我不记得具体的细节了。基本上，这是一个在构造时接受 TObject 引用的接口。然后，当它的引用计数达到零时，它会在您传递给它的对象上调用 free 。此方法实际上仅适用于您没有作为参数传递的短期实例，因为您将引用计数引用与实际使用的引用分开。我会推荐其他两种方法中的一种，但如果您更喜欢这种方法并想了解更多信息，请告诉我。

这就是关于德尔福的事情，有一种自由的方式来完成事情。选项 #1 在我看来是最好的选择 - 获取 Delphi 2009 并尽可能使用该方法。

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T10:42:10.977

不幸的是，只有在您使用接口（在您的情况下为自定义接口 IFileInfo）时，Delphi 编译器才会生成必要的代码来增加/减少引用计数。此外，如果接口被强制转换为指针（或 TObject），那么引用计数也是不可能的。例如，假设全局变量列表：TList：

```
var ifi : IFileInfo;
begin
  ifi := TFileInfo.Create;
  list.Add(TFileInfo(ifi));
end; 
```

方法返回后 list[list.Count - 1] 将包含悬空指针。

因此接口不能在将它们转换为指针的哈希映射中使用，哈希映射实现必须将它们保留为 IInterface。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T14:37:16.277

不要混合对象引用和接口引用。

```
var
  Intf: IInterface;
  Obj: TFileInfo;

begin
  // Interface Reference
  Intf := TFileInfo.Create; // Intf is freed by reference counting, 
                            // because it's an interface reference
  // Object Reference
  Obj := TFileInfo.Create;
  Obj.Free; // Free is necessary

  // Dangerous: Mixing
  Obj := TFileInfo.Create;
  Intf := Obj; // Intf takes over ownership and destroys Obj when nil!
  Intf := nil; // reference is destroyed here, and Obj now points to garbage
  Obj.Free; // this will crash (AV) as Obj is not nil, but the underlying object
            // is already destroyed
end; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T18:38:34.610

如果您想消除对 TObject 实例的 free 调用，那么您可能需要查看本机 Delphi 的垃圾收集器。我知道 2 种不同的垃圾收集器和一种垃圾收集技术，每种都有优缺点。

*   Henrick Hellström 的本 [机精确跟踪垃圾收集器](http://cc.embarcadero.com/Item/26716)

*   Barry Kelly[的 Boehm 垃圾收集器 DLL API](http://cc.embarcadero.com/Item/21646)

*   [罗森·阿塞诺夫（Rossen Assenov）的 Delphi 对象和组件](http://cc.embarcadero.com/Item/17286)的垃圾收集器（不是真正的垃圾收集器，更像是一个内存袋。）

其中之一可能对你有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T10:36:13.907

此功能是为接口提供的，但不是为对象提供的。

你可以创建类似的东西，但是你需要重写一些 TObject 的结构：

```
TRefCountObject = class (TObject)
private
  FRefCount : Integer;
public
  constructor Create;

  procedure Free; reintroduce;

  function RefCountedCopy: TRefCountObject;
end;

constructor TRefCountObject.Create;
begin
  inherited;
  FRefCount := 1;
end;

procedure TRefCountObject.Free;
begin
  if self=nil then Exit;
  Dec(FRefCount);
  if FRefCount<=0 then
    Destroy;
end;

function TRefCountObject.RefCountedCopy: TRefCountObject;
begin
  Inc(FRefCount);
  Result := self;
end; 
```

您需要 RefCountedCopy 将对象分配给另一个变量。但是你有一个 refcounted 对象。

如何使用这个：

```
var1 := TRefCountObject.Create;   // rc = 1
var2 := var1.RefCountedCopy;      // rc = 2
var3 := var1.RefCountedCopy;      // rc = 3
var2.Free;                        // rc = 2
var1.Free;                        // rc = 1
var4 := var3.RefCountedCopy;      // rc = 2
var3.Free;                        // rc = 1
var4.Free;                        // rc = 0 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T17:14:17.010

为了补充已经说过的内容，如果要存储对接口的引用，而不是使用 TList，请使用**TInterfaceList**。参考计数将始终如一地工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T11:04:36.413

对此有很长的解释，但简而言之：从 TInterfacedObject 继承（而不是自己调用 Free）是不够的，您需要使用 object-factory-dynamic 为您创建对象，并使用接口指针指向无处不在的对象，而不仅仅是对象引用变量。（是的，这意味着您不能不查看就切换“旧代码”）

# .net - 如何在组策略中指定 .NET 程序集信任？

> ID：781101
> 
> 赞同：1
> 
> 时间：2009-04-23T10:10:14.483
> 
> 标签：.net, permissions, group-policy

我在网络共享上有一些 .NET 程序集，我需要将 FullTrust 访问权限授予我的所有用户。使用组策略执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T04:36:52.010

如果你想通过组策略来做到这一点：

1.  查找[caspol.exe](http://msdn.microsoft.com/en-us/library/cb6t8dtz(VS.80).aspx)以通过命令行创建安全组。它有助于浏览 .NET 安全向导并密切注意所选的窗口名称和选项，因为一些 caspol 命令非常神秘。

2.  创建一个运行此命令的[脚本。](http://msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx)

3.  通过组策略的配置 > Windows 设置 > 脚本部分进行部署。

# php - 打开 ID XRDS 发现

> ID：781102
> 
> 赞同：3
> 
> 时间：2009-04-23T10:10:31.190
> 
> 标签：php, openid, openid2

我正在使用 Open Id，只是在我的网站上制作一个类来交互/验证 Open Id（在 PHP 中）。我知道还有一些其他的库（比如 RPX），但我想使用我自己的（它有助于更​​好地理解协议以及它是否适合我）。

我的问题与 Open Id 发现序列有关。基本上我已经达到了我正在考虑使用 XRDS 文档从声称的身份 (openid.claimed_id) 获取本地身份 (openid.identity) 的地步。

*我的问题是，我是否必须发出 cURL 请求才能获取 XRDS 位置（X-XRDS-location），然后再发出另一个 cURL 请求才能获得实际的 XRDS 文档？*

似乎对于一个 DUMB 请求，我只发出一个 cURL 请求并获得 Open Id 服务器，但必须发出两个才能使用 XRDS Smart 方法。好像不太对，谁能给我一些信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T15:24:49.497

要完整，是的，您的 RP 必须在用户给您的 URL 上进行 HTTP GET，然后搜索 XRDS 文档参考，如果找到，则从那里执行另一个 HTTP GET。请记住，XRDS 可能托管在不同的服务器上，因此不要编写任何需要两个请求之间的连接相同的内容，因为它可能不是同一个连接。

如果在您的初始 HTTP GET 请求中包含 HTTP 标头：

```
Accept: application/xrds+xml 
```

然后页面可以立即响应 XRDS 文档，而不是您必须为 XRDS 链接解析的 HTML 文档。您将能够通过检查其 Content-Type 标头中 application/xrds+xml 的 HTTP 响应标头来检测是否发生了这种情况。这是一种优化，因此 RP 通常不必进行第二次 HTTP GET 调用——但您不能依赖它发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:18:00.410

我能给你的最好的建议是，试着抽象一点你的 HTTP 请求，然后完成两次 HTTP 请求的整个过程。

如果您想使用持久连接加快速度，您可以保留 curl 实例，但这可能是您想要的，也可能不是您想要的。

我希望这会有所帮助，祝你好运。OpenID 是自 WebDAV 以来我遇到的最庞大、最复杂的 Web 标准之一 =)

翻转

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-03T00:41:15.747

我知道我在这里玩游戏迟到了，但我认为您还应该检查一下[webfinger 协议](http://code.google.com/p/webfinger/wiki/WebFingerProtocol)。它采用标准的“电子邮件作为用户 ID”模式，让您从那里进行查找以发现 openid 等。

# wpf - 如何禁用应用程序的默认 TextInputPanel？

> ID：781103
> 
> 赞同：0
> 
> 时间：2009-04-23T10:10:41.003
> 
> 标签：wpf, tablet-pc

我有一个用于平板电脑的 wpf 应用程序（我使用 CAL）。我创建了一个自定义文本输入面板。

现在是我的问题：如何禁用默认的 TextInputPanel？

这只是通过我的应用程序关闭，因为我仍然希望在我的 winxp 和平板电脑上的其他应用程序中使用该实用程序。

问题是，当我将鼠标悬停在文本框附近时，总是会出现打开 TextInputPanel 的小工具提示，我想抑制它！

亲切的问候，维姆

已经在 WPF 论坛上发布但没有结果：s [http://social.msdn.microsoft.com/Forums/en-US/tabletandtouch/thread/835b910d-e357-4bd8-b26a-f99e7d549b3f](http://social.msdn.microsoft.com/Forums/en-US/tabletandtouch/thread/835b910d-e357-4bd8-b26a-f99e7d549b3f) [http://social.msdn。 microsoft.com/Forums/en-US/wpf/thread/c5bd3b90-c731-4e5b-a812-ee29490800e3](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c5bd3b90-c731-4e5b-a812-ee29490800e3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T13:14:22.063

禁用输入面板 UI

将 DisableInPlace 注册表项设置为零可防止输入面板用户界面 (UI) 出现在应用程序中。您必须将 DisableInPlace 注册表项放在 HKLM\Software\Microsoft\TabletTip。然后，使用要禁用输入面板的应用程序的完整路径添加新的注册表值。以下示例注册表项在名为 MyApp 的应用程序中禁用输入面板：

```
[HKEY_LOCAL_MACHINE 
\SOFTWARE\Microsoft\TabletTIP\DisableInPlace]
"C:\Progam Files\My App\MyApp.exe"="1" 
```

（最后）在这里找到这个信息：http: [//msdn.microsoft.com/en-us/library/ms812266.aspx](http://msdn.microsoft.com/en-us/library/ms812266.aspx)

我不太喜欢它（注册编辑），但至少这是一个解决方案；）

亲切的问候，

维姆

# java - 怎么可能没有。以编程方式获取 OpenOffice.org 电子表格中的页数？

> ID：781105
> 
> 赞同：1
> 
> 时间：2009-04-23T10:11:15.213
> 
> 标签：java, api, openoffice.org, spreadsheet

如果我打印出 OpenOffice.org 文档，我想计算将产生的页数。我已经可以使用以下代码对 ODT 文件执行此操作：

```
public short getPageCount() {
        XModel model = (XModel) UnoRuntime.queryInterface(XModel.class,
                        getDocument());

        XTextViewCursorSupplier supplier = (XTextViewCursorSupplier) UnoRuntime
                        .queryInterface(XTextViewCursorSupplier.class, model
                                        .getCurrentController());

        XTextViewCursor viewCursor = supplier.getViewCursor();

        XPageCursor pageCursor = (XPageCursor) UnoRuntime.queryInterface(
                        XPageCursor.class, viewCursor);

        pageCursor.jumpToLastPage();

        return pageCursor.getPage();
}

public Object getDocument() {
        XComponentContext context = Bootstrap.bootstrap();

        XMultiComponentFactory factory = context.getServiceManager();

        Object desktop = factory.createInstanceWithContext(
                        "com.sun.star.frame.Desktop", context);

        XComponentLoader loader = (XComponentLoader) UnoRuntime.queryInterface(
                        XComponentLoader.class, desktop);

        XComponent component = loader.loadComponentFromURL("file:///path/to/file.odt",
                        "_blank", 0, new PropertyValue[0]);

        return UnoRuntime.queryInterface(XTextDocument.class,
                        component);
} 
```

我想知道我是否可以对 ODS 文件做类似的事情。也许数一下。工作表中的分页符？类中有一个`ShowPageBreaks`属性，`SpreadsheetViewSettings`但没有`PageBreakCount`or `getPageBreaks()`。:P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T10:25:13.950

```
// get the sheet document using UnoRuntime
XSpreadsheetDocument sheetDoc = ...;
// get an object containing all sheets
XSpreadsheets sheets = sheetDoc.getSheets();
// get the sheets names
String[] sheetnames = sheets.getElementNames(); 
```

在那里你有一些你可以计算或迭代的东西。

编辑：
工作表本身可能没有打印页面的概念。
所以我猜你要么需要使用 XPrintPreview 之类的东西，但我不知道如何从那里确定页面，或者查看 [打印电子表格文档](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Spreadsheets/Printing_Spreadsheet_Documents#Printer_and_Print_Job_Settings)并尝试使用 PrintAreas 和一些数学。

# .net - 将多个数组聚合为一个数组（Linq）

> ID：781116
> 
> 赞同：10
> 
> 时间：2009-04-23T10:18:21.187
> 
> 标签：.net, linq, c#-3.0

我无法将多个数组聚合成一个“大数组”，我认为这在 Linq 中应该是可能的，但我无法理解它:(

考虑一些返回一些 dummyObjects 数组的方法

```
public class DummyObjectReceiver 
{
  public DummyObject[] GetDummyObjects  { -snip- }
} 
```

现在某处我有这个：

```
public class Temp
{
  public List<DummyObjectReceiver> { get; set; }

  public DummyObject[] GetAllDummyObjects ()
  {
    //here's where I'm struggling (in linq) - no problem doing it using foreach'es... ;)
  }
} 
```

希望它有点清楚我想要实现的目标（因为我想通过 DummyObject 具有的 int 值对这个数组进行排序...... - 但 orderby 应该没问题，......我希望;）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T11:08:36.263

您使用该`SelectMany`方法将数组返回对象的列表展平为一个数组。

```
public class DummyObject {
    public string Name;
    public int Value;
}

public class DummyObjectReceiver  {

    public DummyObject[] GetDummyObjects()  {
        return new DummyObject[] {
            new DummyObject() { Name = "a", Value = 1 },
            new DummyObject() { Name = "b", Value = 2 }
        };
    }

}

public class Temp {

    public List<DummyObjectReceiver> Receivers { get; set; }

    public DummyObject[] GetAllDummyObjects() {
        return Receivers.SelectMany(r => r.GetDummyObjects()).OrderBy(d => d.Value).ToArray();
    }

} 
```

例子：

```
Temp temp = new Temp();
temp.Receivers = new List<DummyObjectReceiver>();
temp.Receivers.Add(new DummyObjectReceiver());
temp.Receivers.Add(new DummyObjectReceiver());
temp.Receivers.Add(new DummyObjectReceiver());

DummyObject[] result = temp.GetAllDummyObjects(); 
```

# c - 每线程内存分配

> ID：781118
> 
> 赞同：4
> 
> 时间：2009-04-23T10:18:26.850
> 
> 标签：c, memory-management, pthreads

我正在开发用于多线程应用程序的跟踪工具，尤其是关于内存分配的跟踪工具。

我想要一个每个线程的内存分配。我知道当一个线程做 malloc 时，使用的内存是全局堆。我想跟踪哪个线程分配了多少内存。

我对 malloc 做了一个包装，每次有 malloc 时递增值：

```
void *mymalloc(size_t size) {
    mem_used[thread_id] += size;
    return malloc(size);
} 
```

它运作良好。问题在于`free`方法，它不返回释放了多少内存。

不要考虑我的解决方案，这只是为了展示我的尝试。

编辑：

如上所述，保留自己的桌子是一种过于繁重的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T10:28:17.263

如何将 mymalloc 更改为：

```
int* mymem = malloc(size + sizeof(int)*2);
mymem[0] = thread_id;
mymem[1] = size;
mem_used[thread_id] += size;
return &mymem[2]. 
```

然后，在 myfree(void* mem) 中，您：

```
void myfree(void* mem)
{
    int* imem = (int*)(mem - sizeof(int)*2);
    int thread_id = imem[0];
    int size = imem[1];
    mem_used[thread_id] -= size;
    free(imem);
} 
```

这可以优化，但我希望你明白......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T10:29:20.537

我能想到的唯一想法（尽管您可能考虑过这一点）是在这些列中保留一个分配表：

*   ThreadID（当然）
*   指针
*   分配大小

然后，您将不得不使用自己的**malloc**和**free**函数来执行实际的 malloc 和 free 操作，同时还要保持分配表的更新。

这是为了调试目的吗？因为否则，维护此表的开销可能很大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T10:27:29.280

这有点复杂。在我的头顶上：

*   使用为该指针分配的指针值和内存大小创建一个映射。
*   在您的`my_malloc`中，使用参数更新地图`size`。
*   编写您自己的包装器来`free`减去该`size`线程的（您通过查找指针值来检索）。

# php - 我如何通过 phpmyadmin 将带有部分数据的文件（csv/excel）导入数据库中的表？

> ID：781127
> 
> 赞同：3
> 
> 时间：2009-04-23T10:20:42.867
> 
> 标签：php, mysql, phpmyadmin

我需要我的客户更新信息来填写客户表。

我将我想要的表格导出到一个 excel 文件中，并要求他们填写新信息（这只是我需要更新的一列），他们已将文件发回给我。

现在我想将该信息导入回我的表格列。
多次试错，转换成csv的excel文件，通过phpmyadmin导入。

但它没有更新任何列。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:08:44.510

如果您只需要从 CSV 数据生成 UPDATE 语句，您可能想看看我的 FOSS CSV 工具[CSVFix](http://code.google.com/p/csvfix/)，它可以做到这一点以及更多，而无需编写任何代码、PHP 或其他方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T10:35:43.597

如果你有一个 .csv 文件并且你知道一些 PHP，你可以编写一个循环遍历文件并插入/更新数据库中的记录的脚本。

例如，假设您的 csv 中的每一行的结构如下：

```
id,name,address,email,date 
```

例如：

```
1,bob smith,344 abc street,test@example.com,2009-04-01 
```

你可以这样循环遍历它：

```
<?php
$data=file_get_contents('your-file.csv');
//Split the file and get an array representing the lines/rows in the .csv
$rows=explode("\n",$data); 

foreach ($rows as $row)
{

   //Remove any excess whitespace from start and end of the row:
   $row=trim($row);
   $id=$row[0];
   $name=$row[1];
   $address=$row[2];
   $email=$row[3];
   $date=$row[4];
   mysql_query("UPDATE TABLE SET name='$name',....);
}
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T12:05:39.853

PHP 有一个名为[fgetcsv()](http://is.php.net/manual/en/function.fgetcsv.php)的函数来解析 CSV 文件。

您可以使用它来遍历您的 CSV 文件并创建 MySQL 更新字符串。您可以通过 mysql_query() 执行，或者只是复制并粘贴到 PHPMyAdmin 的查询窗口中。

# svn - svn 变更列表：如何将操作限制为“默认”变更列表？

> ID：781129
> 
> 赞同：17
> 
> 时间：2009-04-23T10:23:01.007
> 
> 标签：svn

Subversion 1.5 引入了更改列表，我想使用此功能将更改分组以供以后使用，并继续处理其他文件。问题是颠覆命令喜欢`svn diff`并`svn commit`适用于所有修改过的文件。如果我使用该`--changelist`选项指定更改列表，我可以限制他们操作的文件。但是如何将操作限制在根本没有更改列表中的文件？

例如：`file1`和`file2`都被修改。`file1`在更改列表中`A`并且`file2`不在更改列表中。

如果我这样做，`svn diff --changelist A`我会看到`file1`.

但如果我这样做，我会看到and`svn diff`的差异。`file1``file2`

我如何设法查看 just 的差异`file2`，即所有不属于更改列表的文件？

我正在使用 Subversion 1.6（以防万一这有所作为）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T10:37:17.930

抱歉，subversion 还没有语法来表达它。

有一些想法允许 --changelist "" 语法，但尚未实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:00:31.743

如果您有兴趣在图形环境中执行此操作，[SmartSVN](https://www.smartsvn.com/)（跨平台）可以为您执行此操作。他们的免费版本也功能齐全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-23T18:19:35.217

正如 rlovtang 不久前提到的，[Subversion 现在确实支持更多的变更列表选项](http://svnbook.red-bean.com/en/1.6/svn.ref.svn.c.changelist.html)

特别是，可以发出以下命令以仅提交与更改列表关联的文件：

```
svn changelist issue1729 foo.c bar.c baz.c
svn commit --changelist issue1729 -m "Fixing Issue 1729." 
```

# asp.net - ASP.Net 数据驱动的网站效率

> ID：781136
> 
> 赞同：1
> 
> 时间：2009-04-23T10:25:39.407
> 
> 标签：asp.net, performance, datatable

我正在创建一个显示大量数据的 ASP.Net 网站。数据通过数据访问层提供给我。根据我得到的数据，我正在构建大型数据表，然后使用 gridview 或动态创建的 Web 控件显示这些数据表。

我发现的问题是当大量数据传递给网站时网站速度很慢。我读过数据读取器是要走的路，但由于需要使用数据访问层，我不能直接从 SQL 表中使用数据读取器。

我也没有部分填充数据表的选项，因为我需要对数据应用很多排序方法来显示我需要的内容。

有什么建议可以加快数据表的速度吗？或者也许使用其他更有效的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:03:45.927

由于您“.. 构建大型数据表，然后使用 gridview 或动态创建的 Web 控件显示这些表”，因此网络可能成为瓶颈。请参阅可能有帮助的类似 SO[问题的答案。](https://stackoverflow.com/questions/730657/why-do-my-asp-net-pages-render-slowly-when-placed-on-the-server/748019#748019)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T10:34:23.163

将“大量”数据拉入 Web 应用程序并在那里进行排序/过滤总是会很慢，具体取决于您对“大”的定义。如果您可以在将数据拉到 Web 应用程序之前在数据库服务器上应用任何排序/过滤，这应该会加快速度。你说你没有这个选项，但是排序是数据库服务器的功能，你确定你不能做这个吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T10:35:45.297

您可以使用分布式缓存来缓存您的数据。Memcache ( [http://www.danga.com/memcached/](http://www.danga.com/memcached/) ) 或 Velocity Microsoft 分布式缓存 ( [http://www.microsoft.com/downloads/details.aspx?FamilyId=B24C3708-EEFF-4055-A867-19B5851E7CD2&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=B24C3708-EEFF-4055-A867-19B5851E7CD2&displaylang=en)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T10:37:20.957

您要做的第一件事是准确指出进程的哪个部分是缓慢的。它可能不是你想的那样。对不同部分进行代码分析或计时，以准确确定每段代码在请求期间消耗的时间。在我们的案例中，我们发现数据层（执行读取器、填充对象模型）非常快（有几个例外由数据库中的索引处理），而客户端上有一些非常慢的 javascript .

因此，从测量开始，然后决定在哪里进行优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T20:51:20.490

您确定瓶颈在 Web 应用程序中吗？

我要做的第一件事是猜测您在慢速页面上执行的最长 SQL 查询是什么，然后看看它在查询浏览器中是如何运行的。

如果它很慢，请努力优化它。

# soa - 是否需要中间件应用程序来执行业务逻辑？

> ID：781139
> 
> 赞同：6
> 
> 时间：2009-04-23T10:26:05.320
> 
> 标签：soa, business-logic, middleware, eai

假设我有一个大型中间件基础设施，用于调解多个业务组件（客户应用程序、网络、支付等）之间的请求。中间件堆栈负责编排、路由、转换和其他东西（类似于 Gregor Hohpe 的企业集成模式一书）。

我的问题是：把一些**业务逻辑**放在中间件上是不是很好的设计？

假设我的应用 A 从中间件请求一些客户数据。但为了获取这些数据，我必须提供*客户 ID*和*其他一些参数*。这个参数的获取应该由请求的应用程序完成，还是中间件负责“促进”并提供一个接收*客户 ID*并在内部获取*其他参数*的接口？

我意识到这不是一个简单的问题（因为业务逻辑的定义），但我想知道这是一种通用方法还是一些指导方针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T08:12:20.670

除了路由、转换和编排之外，在加载具有功能需求的中间件时还应牢记性能。中间件应该占用整个端到端事务生命周期的一小部分。这只能通过专注于中间件核心功能而不是试图补充主机系统功能来实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T10:32:57.270

这就是“复合应用”模式；面向服务架构的核心。这就是 ESB 供应商所销售的东西：一种将*额外*的业务逻辑放在某个地方的方法，该方法可以在现有应用程序之外创建一个复合应用程序。

这并不简单，因为您的复合应用程序不仅仅是路由。这是一个在路由之上分层的适当的新复合事务。

暗示。在走得太远之前先看看获得一个好的 ESB。这很快就会失控，获得一些额外的支持会很有帮助。即使您不购买 Sun 的[JCAPS](http://www.sun.com/software/javaenterprisesystem/javacaps/)或[Open ESB](https://open-esb.dev.java.net/)之类的东西，您也会很高兴您了解了它的作用以及它们如何组织复杂的复合应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T10:39:07.333

编排、路由和转换。

您不会出于技术原因随机执行这些操作，或者只是为了好玩，您这样做是因为您有一些业务需求——因此涉及到业务逻辑。

对于完整的业务系统，您唯一缺少的就是计算和报告（让我们假设您已经有了安全性！）。

除了非常低级别的网络，操作系统和存储问题几乎所有构成计算机系统的东西都在那里，因为企业/政府/最终用户希望它在那里。

选择“业务逻辑”作为术语非常糟糕，并导致设计和架构的无休止扭曲。

大多数优秀的设计师/架构师所说的业务逻辑是计算和分析。

如果您使用“%s/Business Logic/Calculation/g”，则大多数架构法令都更有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T10:32:28.860

中间件应用程序应该这样做。系统 A 应该不知道其他参数的存在，当然也不知道如何获取它。

# c# - Silverlight 母版页

> ID：781143
> 
> 赞同：1
> 
> 时间：2009-04-23T10:28:16.093
> 
> 标签：c#, asp.net, silverlight, master-pages

我是 Silverlight 的新手，并决定试一试。我不知道如何使用 Silverlight 创建母版页 (page.xaml) ...

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T18:23:53.803

从 SL 2.0 开始，Silverlight 中没有“MasterPage”控件。但是，您可以通过使用 ContentControl 进行一些简单的内容交换来重现该效果。

最简单的实现将首先创建一个包含主内容的 UserControl，然后使用 ContentControl 作为内容占位符（即类似于 ASP.NET）。然后您可以将内容设置为其他用户控件。

在 Silverlight 3.0 中，您可以嵌入“框架”控件来做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T01:49:02.327

您可能会发现我的 TemplatePanel 实现对于母版页场景很有趣...（只需将 TemplatePanel 作为您的页面中的根元素，并在资源中定义 TemplatePanel 的模板，以便可以定义一次）

[http://www.nikhilk.net/Silverlight-TemplatePanel.aspx](http://www.nikhilk.net/Silverlight-TemplatePanel.aspx)

希望有帮助！

# asp.net - ASP.NET：将所有页面的控件作为 IEnumerable

> ID：781148
> 
> 赞同：1
> 
> 时间：2009-04-23T10:29:25.827
> 
> 标签：asp.net, vb.net, linq

我正在尝试将页面控件的集合与 LINQ 一起使用。而这有效：

```
dim l = Me.Controls.OfType(Of TextBox).AsQueryable() 
```

以下返回 ArgumentExceptionError：

```
dim l = Me.Controls.AsQueryable() 
```

我需要*所有*的控制。有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T10:37:24.340

你有没有尝试过：

```
Me.Controls.Cast(Of Control) 
```

出于兴趣，您为什么需要它作为`IQueryable`? 你还`IEnumerable<T>`不够吗？（这是 的结果`Cast`。）

只调用 AsQueryable 的问题是控件集合没有实现`IEnumerable<T>`，只是`IEnumerable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T11:20:55.297

另外，不要忘记控件是可以嵌套的，并且仅仅向页面询问它的控件只会告诉您直接子项，但不会告诉您这些控件中的控件：

> [通过遍历控件集合在页面上找到 Web 表单控件](http://msdn.microsoft.com/en-us/library/yt340bh4.aspx)
> 
> 此示例仅查找 Page 对象中包含的控件以及作为页面的直接子级的控件。它不会找到作为控件子级的文本框，而该控件又是页面的子级。例如，如果您将 Panel 控件添加到页面，则 Panel 控件将是 Page 包含的 HtmlForm 控件的子控件，并且可以在此示例中找到。但是，如果您随后将 TextBox 控件添加到 Panel 控件中，则该示例将不会显示 TextBox 控件文本，因为它不是页面的子级或作为页面子级的控件的子级。以这种方式遍历控件的一个更实际的应用是创建一个递归方法，可以调用该方法来遍历遇到的每个控件的 Controls 集合。但是，为了清楚起见，

# vb6 - 无权访问私有 MSMQ

> ID：781154
> 
> 赞同：26
> 
> 时间：2009-04-23T10:33:18.157
> 
> 标签：vb6, msmq

在 XP 机器上，有一个由 .net 服务创建的私有消息队列。当我想在 VB6 应用程序中访问这个私有队列时，我不断收到“访问被拒绝”错误。所以这似乎是一个安全问题，只是我不明白为什么即使我以管理员身份登录，我仍然无法访问在同一台机器上创建的队列。还有什么我必须考虑的。

关于我如何在 VB6 中使用队列的示例

```
Public msgQueue As MSMQQueue

Private Sub OpenQueue()

    Dim MQ As New MSMQQueueInfo
        MQ .PathName = ".\Private$\incommingQueue"

    Set msgQueue = MQ.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)

End Sub 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-24T04:49:45.840

如果 .NET 服务从私有队列的权限中删除了“所有人”组，则可能会发生这种情况。以下是您可以采取的一些步骤来解决此问题：

1.  停止 MSMQ 服务

2.  打开文件夹`C:\WINDOWS\system32\msmq\storage\lqs`

3.  在此文件夹中找到描述您的队列的文件 -- (incommingQueue)

4.  使用记事本打开其他具有良好安全权限的私有队列的 lqs 文件。（如果您没有任何其他私人队列，请创建一个）

5.  在文件中找到开始的行`Security=....`

6.  将整行复制到剪贴板（注意自动换行，这一行会很长）

7.  在文本编辑器中打开问题队列的 lqs 文件

8.  `Security=...`用剪贴板的内容覆盖此文件中的行

9.  保存修改后的lqs文件

10.  启动 MSMQ 服务

您应该会发现问题队列现在具有与您在上面的步骤 6 中复制其安全设置的队列相同的权限。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-06-29T06:48:16.683

此处发布的解决方案似乎有点骇人听闻。也许这对于 Windows XP 是必要的。我在使用 Windows 7 时遇到过类似的情况，并使用了不同的方法来解决这个问题。

情况：

*   程序由创建私有事务队列的 C# 代码组成
*   程序作为 Windows 服务运行，在本地系统帐户上运行。
*   运行服务时，将使用本地系统帐户作为所有者创建专用队列。
*   即使我是管理员，我也无法检查队列中的消息。

解决方案（适用于 Windows 7）：

1.  运行 compmgmt.msc
2.  打开“服务和应用程序”
3.  打开“消息队列”
4.  打开“私人队列”
5.  右键单击新创建的队列
6.  点击“属性”
7.  选择“安全”选项卡
8.  点击“高级”
9.  选择“所有者”选项卡
10.  选择“管理员”
11.  选择“权限”选项卡
12.  点击“添加”
13.  输入您的帐户名称（例如“管理员”）
14.  点击“检查姓名”
15.  点击“确定”
16.  点击“确定”
17.  点击“确定”

现在您可以访问队列中的消息，也可以根据需要清除队列。

# .net - 用于生成边界条件的单元测试工具

> ID：781163
> 
> 赞同：2
> 
> 时间：2009-04-23T10:36:31.707
> 
> 标签：.net, unit-testing, testing

我只是想知道是否有任何替代工具，如[Pex](http://research.microsoft.com/en-us/projects/pex/)用于自动生成单元测试的边界条件（应该与 NUnit 一起使用）？我个人更喜欢使用 Pex，但 Microsoft Research Labs 的许可条件不允许在 Visuals Studio 2008 Professional 下进行商业使用（这对我来说没有任何意义）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T10:42:08.183

如果您追求类似 Pex 的功能，那么可能没有类似的功能。是的，Pex 许可确实令人困惑，我的意思是，不允许商业使用甚至没有发布给客户的东西——至少可以说让我觉得很奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T20:23:29.677

表达您的许可问题的最佳地点是 Pex 论坛本身，特别是在这篇文章中： [Pex for VS Pro](http://social.msdn.microsoft.com/Forums/en-US/pex/thread/52763686-3eb6-47cf-950d-21b2baa07423)。

Pex 开发人员 Peli。

# visual-studio-2008 - 我可以从 Visual Studio 中的构建后事件调用的控制台应用程序发送错误吗？

> ID：781168
> 
> 赞同：3
> 
> 时间：2009-04-23T10:38:01.423
> 
> 标签：visual-studio-2008, build-process

因为我在 ASP.net Web 应用程序项目中设置了构建后事件来运行以下命令行。

start $(SolutionDir) *[PathToMyApplicationInSameSolution]* *[一些参数]*

所以我需要从控制台应用程序向 Visual Studio 发送一些错误以显示构建错误（如 Visual Studio 构建错误）

**谢谢**

* * *

所以我将构建后事件命令更改为以下命令。

**$(SolutionDir)[PathToMyApplicationInSameSolution] [一些参数]**

然后，我编辑我的主要功能以显示错误。我在 Visual Studio 的错误列表中看不到任何内容。我只在输出中看到。你知道如何显示由 Visual Studio 生成的构建错误之类的错误吗？

```
[STAThread]
static void Main(string[] args)
{
    Console.Error.WriteLine("Test Error");
    Console.WriteLine("test error");
} 
```

**谢谢**

附言。因为我刚开始使用命令应用程序，所以我忘记了为控制台应用程序创建新线程之类的开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T08:32:16.430

您需要从应用程序返回错误结果。将 Main 的返回类型更改为 int。您不能使用“开始”，因为这会丢弃结果。

如果您想在错误列表窗口中显示错误消息，只需以正确的格式输出一个字符串...

```
using System;

namespace FailBuild
{
    static class Program
    {
        static int Main(string[] args)
        {
            string fileName =
                @"D:\Source\Roger\IsServiceStarted\IsServiceStarted.cpp";
            int lineNumber = 4;
            string errorCode = "X1234";
            string errorMessage = "I don't like the colour";

            Console.WriteLine("{0}({1}): error {2}: {3}",
                fileName, lineNumber, errorCode, errorMessage);
            return 1;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T09:40:21.260

我找到了解决这个问题的方法。Visual Studio 将检测到某些输出模式以报告为错误。所以，我不需要更改默认的 main 方法接口来返回 int（但是您可以使用返回值来公开识别错误）。

更多信息：[MSBuild/Visual Studio 感知错误消息和消息格式](http://blogs.msdn.com/msbuild/archive/2006/11/03/msbuild-visual-studio-aware-error-messages-and-message-formats.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T11:42:16.103

如果不使用“开始”，应用程序的输出将出现在 Visual Studio 的输出窗口中。

# actionscript-3 - 向左走：不受限制/环绕鼠标跟踪？在闪存？

> ID：781172
> 
> 赞同：1
> 
> 时间：2009-04-23T10:40:28.280
> 
> 标签：actionscript-3, mouse

所以，我在 [3D Game] 中射击帅哥，我可以一直拖动鼠标左转转。

这在 Flash 中可能吗？或者我是否误解了鼠标在 [操作系统] 中的处理方式，然后传递给 Flash Player？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T07:38:05.123

据我所知，出于安全原因，您不能将鼠标锁定到 Flash 窗口 - 如果可以的话，想象一下 Flash 广告的噩梦！

但是，如果 Flash 确实移动到窗口框架之外，它会跟踪鼠标位置。您只需要注意点击 - 您可能需要将火重新映射到 CTRL 键或其他东西。

# sharepoint - SharePoint 2007 日志查看器

> ID：781179
> 
> 赞同：18
> 
> 时间：2009-04-23T10:44:16.850
> 
> 标签：sharepoint, logging, sharepoint-2007

SharePoint 2007（WSS 或 MOSS）日志即使在大屏幕上也不容易阅读，是否有人遇到过能够：

*   实时和历史显示 SharePoint 日志
*   按各种参数过滤事件
*   应对 SharePoint 的日志轮换

上述功能的一个子集是可以接受的，WinForms 或 SharePoint 功能的一系列工具也是如此。

除了它们引起我注意的顺序之外，下面的列表没有任何特定的顺序。如果您对以下答案中的产品支持/评论有任何经验，我已经发布了我发现的日志查看器。

**到目前为止发现**：

*   **[SPLogViewer](http://www.codeplex.com/SPLogViewer)** - 支持加载和过滤一个文件，不跟随/尾日志在DataGrid中显示数据。
*   **[SharePoint ULS Log Parser](http://shrptninjatoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=15669)** - 一键访问日志文件，支持按进程名称、级别、区域和类别进行过滤。
*   **[日志查看器功能](http://features.codeplex.com/)**- 从管理中心访问，选择单个日志基本过滤类别、事件和跟踪严重性，在管理中心输出为 HTML。
*   **[WSS / MOSS 日志文件阅读器](http://www.codeplex.com/wssmosslogfilereader)**- 从管理中心、标准 DataGrid 过滤和排序选项访问单个日志文件。
*   **[Stefan Gordon 的 ULS 查看器](http://ulsviewer.codeplex.com/)**- 打开单个日志，不跟随/尾随日志，在 ListView 详细信息中显示数据。按安全性、流程类别和自由格式文本过滤。
*   **[SQL 集成服务](http://www.keirgordon.com/2008/04/load-sharepoint-2007-usage-log-data.html)**- MSSQL 提供的所有报告、排序和过滤选项（带有 ETL 包下载的博客文章），设置起来非常耗时。
*   **[LogParser](http://blogs.msdn.com/jimmiet/archive/2008/03/15/uls-log-file-data-mining.aspx)** - IIS 管理员熟悉的界面，丰富的选项。对于小型安装，安装时间太长。
*   **[SharePoint 日志查看器](http://sharepointlogviewer.codeplex.com/)**- WPF，尚未经过测试。
*   **[Stonebond SharePoint 日志查看器](http://www.stonebond.com/Products/OpenSource/SharePointLogViewer/tabid/326/Default.aspx)**- 看起来很棒，但尚未经过测试。
*   **[ULS Deobfuscator](http://ulsdeobfuscator.codeplex.com/)** - 另一个 WPF 阅读器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T11:22:17.867

我自己没有测试过，但试试这个：http: [//www.codeplex.com/SPLogViewer](http://www.codeplex.com/SPLogViewer)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T12:11:24.583

[Sharepoint 功能](http://www.codeplex.com/features)也有一个*日志查看器*。（至少不是*“附加到调试器”*功能。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T23:07:48.893

这取决于您要在哪里调查日志。如前所述，SharePoint 功能允许您从管理中心检查日志。但是，当您无权访问该框并且只有可用的日志时，我建议您使用[http://www.codeplex.com/ULSViewer](http://www.codeplex.com/ULSViewer)桌面查看器。真正优秀的 WPF 桌面应用程序，具有强大的日志排序和过滤功能

ULSViewer 的作者真的很好，很负责。我已经就一些改进与他联系了几次，他在合理的时间内发布了新版本

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T01:42:03.850

老实说，我认为你最好的选择是使用 logparser（它已经存在了很长时间，通常用于 IIS 日志和事件日志，但也可以做共享点日志）

查看这篇文章以获取一些示例

[http://blogs.msdn.com/scaravajal/archive/2008/03/15/logparser-processes-uls-logs.aspx](http://blogs.msdn.com/scaravajal/archive/2008/03/15/logparser-processes-uls-logs.aspx)

如果您有多个服务器场，我认为最好的办法是将所有日志文件放到共享驱动器上。然后使用 LogParser 对该目录运行查询，这样您就可以轻松地一次查询所有日志文件以及过滤器等。

另一种选择是使用 SSIS 将日志转储到 SQL：[http ://www.keirgordon.com/2008/04/load-sharepoint-2007-usage-log-data.html](http://www.keirgordon.com/2008/04/load-sharepoint-2007-usage-log-data.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-25T08:51:32.090

[http://sharepointlogviewer.codeplex.com/](http://sharepointlogviewer.codeplex.com/) Overroot Inc. 的 SharePoint 日志查看器。

*   它允许您一次查看多个日志文件。
*   您可以按任何字段进行搜索。
*   您可以按任何字段进行过滤。
*   拖放支持。
*   您可以导出过滤后的日志条目。
*   您可以实时监控日志。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-28T18:59:44.053

[SharePoint 日志查看器](http://sharepointlogviewer.codeplex.com/)是 CodePlex 最近的一个项目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-05-23T09:41:32.850

预防胜于治疗。我会推荐使用 SPTRACEVIEW。它可以立即从底层告诉您所有错误和问题。[链接到 SPTraceView 下载](http://sptraceview.codeplex.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T09:33:23.560

Sharepoint NinjaToolkit 有一个[SharePoint ULS Log Parser](http://shrptninjatoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=15669)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T09:38:23.733

Starznet的[WSS / MOSS 日志文件阅读器](http://www.codeplex.com/wssmosslogfilereader)在管理中心添加了一个链接。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T03:56:40.243

SPSDev.com 有一个很棒的工具——我使用的 ULS 日志阅读器。它是免费的，并提供了一些不错的功能。 [ULS 日志阅读器](http://www.spsdev.com/ulsreader.aspx)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-02-26T17:05:34.050

这个真的很酷... [http://www.stonebond.com/Products/OpenSource/SharePointLogViewer/tabid/326/Default.aspx](http://www.stonebond.com/Products/OpenSource/SharePointLogViewer/tabid/326/Default.aspx)

# c# - C#、ASP.NET 3.5 - 在运行时加载代码

> ID：781180
> 
> 赞同：2
> 
> 时间：2009-04-23T10:44:16.867
> 
> 标签：c#, asp.net

我的一个朋友正在用 PHP 构建一个内容管理系统。

PHP 是一种在运行时评估代码的脚本语言，因此在运行时添加代码非常简单（想想：论坛、联系表格等）

在 ASP.NET（已编译）中做同样的事情......不是那么简单。

你们对如何动态加载代码并在实时 Web 应用程序中使用它有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T10:49:55.887

我认为您可以为此使用 App Code 文件夹。我听说过一个解决方案，不允许开发人员上传 dll，所以他们使用了及时编译的应用程序代码文件夹。因此，您可以向其中添加类，它们将根据需要进行编译。

[看这里](http://msdn.microsoft.com/en-us/library/t990ks23.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:54:08.703

如果您使用的是 Visual Studio 2008，则默认的网站模型不使用已编译的 dll，我相信它只会即时编译代码隐藏。如前所述，您还可以使用 App Code 文件夹。如前所述，检查 BlogEngine.NET 可能是一个很好的起点，并且它们有一个很好的动态编译的扩展架构。

您也可以没有代码隐藏文件并将代码放在`<script language="C#" runat="server"></script>`我相信 Visual Studio Express 版本默认执行的代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:11:52.470

我一直这样做是为了配置提供程序。

```
try 
{
    string assembly  = ConfigurationSettings.AppSettings["DataProvider"].Split(',')[0];
    string classname = ConfigurationSettings.AppSettings["DataProvider"].Split(',')[1];
    m_Instance = (SqlDataProvider)Activator.CreateInstance(assembly,classname).Unwrap();
}
catch(Exception ex) 
{
    Common.Error.Write("Getting Data Provider From Config");
} 
```

配置设置如下所示：

```
<add key="DataProvider"   value="MyDll,MyDll.Data.SqlDataProvider"/> 
```

但由于它是一种强类型语言，您的代码必须引用类型或接口。你不能引入它不知道如何处理的代码。除非你想整天在反思中编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T10:51:16.833

你要做的是制作一个基于插件的结构

基于插件的编程不是我可以在此处的答案中向您解释的东西，但是您创建了一个接口，您想用作模块（插件）的程序集必须实现该接口。然后在运行时加载插件文件夹中的所有 dll 并使用 C# 反射，更具体地说是 Activator 类。

祝你好运，这与 Windows 编程的原理相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T03:18:33.563

试试这些文章：

[C# 中的插件](http://www.codeproject.com/KB/cs/pluginsincsharp.aspx)

[在 C# 中实现插件架构](http://www.ddj.com/cpp/184403942)

[C# 2.0：使用后期绑定在运行时加载插件](http://blogs.msdn.com/abhinaba/archive/2005/11/14/492458.aspx)

[您如何实现 ProductModule？](http://www.devexpress.com/Support/Center/p/Q202166.aspx)

[使用 C# 构建插件架构简介](http://www.c-sharpcorner.com/UploadFile/rmcochran/plug_in_architecture09092007111353AM/plug_in_architecture.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T10:51:01.593

开源[BlogEngine.NET](http://www.dotnetblogengine.net/)中包含一些代码，允许开发人员编写您可能会发现有用的扩展。扩展通过 Global.asax 在应用程序启动时加载。

# sharepoint - 如何使用团队定义更改 Sharepoint 中网站的默认页面？

> ID：781182
> 
> 赞同：0
> 
> 时间：2009-04-23T10:46:44.567
> 
> 标签：sharepoint, sharepoint-2007

我正在使用 Visual Studio 2005 的 SharePoint 扩展 1.1 在 SharePoint 2007 中部署我的网站。当您创建新网站时，会出现一个新的默认页面，其中包含 ContenType：Welcomelinks.... 我想更改它以包含我的在onet.xml 中拥有自己的ContentType 和PageLayout。我正在使用团队定义进行部署。

有人可以给我一些建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T19:54:43.570

您是否尝试将您的模块应用到**onet.xml**文件？

在

```
<Project...>
  <Configurations...>
    <configuration...>
      <Modules> 
```

创建一个模块元素：

```
<Module Name="Default"/> 
```

然后在

```
<Project..>
  <Modules> 
```

有这样的定义：

```
<Module Name="Default" Url="" Path="">
    <File Url="default.aspx" NavBarHome="True">
    </File>
</Module> 
```

我认为这至少会让你走上正轨。我希望。

# wpf - wpf中刷新页面

> ID：781183
> 
> 赞同：0
> 
> 时间：2009-04-23T10:47:07.110
> 
> 标签：wpf, window, refresh

1.  如何关闭或取消按钮单击中的弹出窗口。？

2.  当我在弹出窗口中更新数据时，同时如何刷新主页中的数据网格。？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T13:02:27.097

1.  弹出窗口的 IsOpen 属性应设置为 false。
2.  使用绑定。

# subsonic - 亚音速 - 简单查询

> ID：781186
> 
> 赞同：0
> 
> 时间：2009-04-23T10:47:58.107
> 
> 标签：subsonic

我有一张桌子有 2 列

Val1 整数

Val2 整数

我的查询很简单。

我想收集有条件的记录 (val1=Val2) ，

相当于（从 Val1=Val2 的表中选择 *）

我试试

IDataReader rdr = new Query("Table").WHERE("Val1=Val2").ExecuteReader(); tableColl.LoadAndCloseReader(rdr); rdr.Close();

和

```
 ..WHERE (" 'Val1=Val2' ")
  ..WHERE (Table.Columns.Val1,IsEqualTo,Table.Columns.Val2) //This not reguler I know
  ..WHERE ("Val"+'='+"Val2") 
  ..... 
```

任何帮助都会得到更多帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T11:07:25.797

不幸的是，据我所知，您需要将其作为内联查询执行：

```
TableCollection tableCollection = new InlineQuery()  
  .ExecuteAsCollection<TableCollection>(
    "SELECT * FROM " + Table.Schema.TableName " WHERE " + Table.Columns.Val1 + " = " + Table.Columns.Val2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:17:19.807

```
private void CreateDynamicControls()
{

    panGvHolder.Controls.Clear();

    Query qry = Northwind.Product.CreateQuery();
    qry.Columns.AddRange(Northwind.Product.Schema.Columns);
    qry.WHERE("UnitPrice > 15").AND("UnitsInStock < 20 ");
    //WHERE("UnitPrice > 15").AND("UnitsInStock < 30 ");

    using (IDataReader rdr = qry.ExecuteReader())
    {
        Response.Write("<table>");
        while (rdr.Read())
        {
            Response.Write("<tr>");
            for (int i = 0; i < rdr.FieldCount; i++)
            {
                Response.Write("<td>");
                Response.Write(rdr[i].ToString() + " ");
                Response.Write("<td>");
            } //eof for 
            Response.Write("</br>");
            Response.Write("</tr>");
        }
        Response.Write("<table>");
    }
} //eof method 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T10:19:53.723

最近处于同样的情况并想出了这个：

```
TableCollection tablecollection = new TableCollection;
Comparison comp = Comparison.Equals;
tablecollection.Where(Table.Columns.Val1, comp, Table.Columns.Val2);
tablecollection.Load(); 
```

我发现这更好，因为我不喜欢内联查询。如果您希望允许在您的应用程序中进行临时查询，它会提供更大的灵活性。

# visual-studio-2008 - “将网站/解决方案添加到源代码管理...”之间的区别

> ID：781188
> 
> 赞同：0
> 
> 时间：2009-04-23T10:48:29.603
> 
> 标签：visual-studio-2008, version-control, visual-sourcesafe

我在 Visual Studio 2008 中的工作站上打开了一个托管网站，并将其保存为解决方案。我现在想将此添加到源代码控制中，并且可以选择“将解决方案添加到源代码控制...”或“将网站添加到源代码控制...”。

这个解决方案需要由其他几个开发人员在本地访问、工作和运行，所以我想知道每个选项之间的主要区别是什么，哪个是最好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T11:03:53.527

解决方案是项目聚合器。

*   如果您的解决方案有多个项目，并且您希望您的同事以与您相同的方式工作，那么您必须添加解决方案。

*   如果您的解决方案有多个项目，并且您**不**希望您的同事以与您相同的方式工作，那么您不得**添加**解决方案。

*   如果您只有一个项目，它实际上是相同的，但我会添加解决方案，因此如果稍后有人向其中添加项目，我将可以立即访问它。

# c# - 如何在 C# 中锁定整数？

> ID：781189
> 
> 赞同：23
> 
> 时间：2009-04-23T10:48:52.067
> 
> 标签：c#, .net, locking

有没有办法在 C# 中锁定整数？整数不能与 lock 一起使用，因为它们是装箱的（并且 lock 仅锁定在引用上）。

场景如下：我有一个基于论坛的网站，具有审核功能。我想要做的是确保在任何给定时间最多只有一个版主可以审核帖子。为此，我想锁定帖子的 ID。

到目前为止，我已经有了一些想法（例如，使用字典<int, object>），但我正在寻找一种更好、更清洁的方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-23T11:34:04.703

我喜欢这样做

```
public class Synchronizer {
    private Dictionary<int, object> locks;
    private object myLock;

    public Synchronizer() {
        locks = new Dictionary<int, object>();
        myLock = new object();
    }

    public object this[int index] {
        get {
            lock (myLock) {
                object result;
                if (locks.TryGetValue(index, out result))
                    return result;

                result = new object();
                locks[index] = result;
                return result;
            }
        }
    }
} 
```

然后，简单地锁定一个 int （每次使用相同的同步器）

```
lock (sync[15]) { ... } 
```

当给定相同的索引两次时，此类返回相同的锁定对象。当新索引到来时，它会创建一个对象，将其返回，并将其存储在字典中以备下次使用。

它可以很容易地更改为与任何`struct`类型或值类型通用，或者`static`不必传递同步器对象。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T11:00:32.350

如果它是一个网站，那么使用进程内锁定可能不是最好的方法，就像您需要将站点扩展到多个服务器上，或者添加另一个托管 API 的站点（或任何其他需要另一个进程访问相同的数据存在）那么您所有的锁定策略都会立即失效。

我倾向于为此研究基于数据库的锁定。最简单的方法是使用乐观锁定，例如帖子上次更新时间的时间戳，并拒绝对帖子所做的更新，除非时间戳匹配。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-13T00:42:11.863

我读过很多评论提到锁定对 Web 应用程序不安全，但是，除了 Web 农场，我还没有看到任何解释原因。我很想听听反对它的论点。

我有类似的需求，尽管我正在硬盘驱动器上缓存调整大小的图像（这显然是本地操作，因此网络农场场景不是问题）。

这是@Configurator 发布的重做版本。它包含@Configurator 未包含的几个功能：

1.  解锁：确保列表不会过大（我们有数百万张照片，每张照片可以有许多不同的尺寸）。
2.  Generic：允许基于不同的数据类型（例如 int 或 string）进行锁定。

这是代码...

```
/// <summary>
/// Provides a way to lock a resource based on a value (such as an ID or path).
/// </summary>
public class Synchronizer<T>
{

    private Dictionary<T, SyncLock> mLocks = new Dictionary<T, SyncLock>();
    private object mLock = new object();

    /// <summary>
    /// Returns an object that can be used in a lock statement. Ex: lock(MySync.Lock(MyValue)) { ... }
    /// </summary>
    /// <param name="value"></param>
    /// <returns></returns>
    public SyncLock Lock(T value)
    {
        lock (mLock)
        {
            SyncLock theLock;
            if (mLocks.TryGetValue(value, out theLock))
                return theLock;

            theLock = new SyncLock(value, this);
            mLocks.Add(value, theLock);
            return theLock;
        }
    }

    /// <summary>
    /// Unlocks the object. Called from Lock.Dispose.
    /// </summary>
    /// <param name="theLock"></param>
    public void Unlock(SyncLock theLock)
    {
        mLocks.Remove(theLock.Value);
    }

    /// <summary>
    /// Represents a lock for the Synchronizer class.
    /// </summary>
    public class SyncLock
        : IDisposable
    {

        /// <summary>
        /// This class should only be instantiated from the Synchronizer class.
        /// </summary>
        /// <param name="value"></param>
        /// <param name="sync"></param>
        internal SyncLock(T value, Synchronizer<T> sync)
        {
            Value = value;
            Sync = sync;
        }

        /// <summary>
        /// Makes sure the lock is removed.
        /// </summary>
        public void Dispose()
        {
            Sync.Unlock(this);
        }

        /// <summary>
        /// Gets the value that this lock is based on.
        /// </summary>
        public T Value { get; private set; }

        /// <summary>
        /// Gets the synchronizer this lock was created from.
        /// </summary>
        private Synchronizer<T> Sync { get; set; }

    }

} 
```

这是您如何使用它...

```
public static readonly Synchronizer<int> sPostSync = new Synchronizer<int>();
....
using(var theLock = sPostSync.Lock(myID))
lock (theLock)
{
    ...
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-19T04:21:38.860

此选项建立在配置器提供的良好答案的基础上，并进行了以下修改：

1.  防止字典的大小不受控制地增长。因为，新帖子会得到新的 id，你的锁字典会无限增长。解决方案是根据最大字典大小修改 id。这确实意味着某些 id 将具有相同的锁（并且必须等待，否则它们不必等待），但这对于某些字典大小是可以接受的。
2.  使用 ConcurrentDictionary，因此不需要单独的字典锁。

编码：

```
internal class IdLock
{
    internal int LockDictionarySize
    {
        get { return m_lockDictionarySize; }
    }
    const int m_lockDictionarySize = 1000;
    ConcurrentDictionary<int, object> m_locks = new ConcurrentDictionary<int, object>();
    internal object this[ int id ]
    {
        get
        {
            object lockObject = new object();
            int mapValue = id % m_lockDictionarySize;
            lockObject = m_locks.GetOrAdd( mapValue, lockObject );
            return lockObject;
        }
    }
} 
```

此外，为了完整起见，还有字符串实习的替代方法：-

1.  根据您允许的最大实习 ID 字符串数修改 id。
2.  将此修改后的值转换为字符串。
3.  将修改后的字符串与 GUID 或命名空间名称连接，以确保名称冲突安全。
4.  实习生这个字符串。
5.  锁定在实习的字符串。有关一些信息，请参阅[此答案：](https://stackoverflow.com/a/7915915/746754)

字符串实习方法的唯一好处是您不需要管理字典。我更喜欢锁字典方法，因为实习生方法对字符串实习的工作方式做了很多假设，并且它将继续以这种方式工作。它还将实习用于从未打算/旨在做的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T11:11:36.490

我个人会选择[Greg](https://stackoverflow.com/questions/781189/how-to-lock-on-an-integer-in-c/781227#781227)或[Konrad 的](https://stackoverflow.com/questions/781189/how-to-lock-on-an-integer-in-c/781197#781197)方法。

如果您确实想`lock`反对帖子 ID 本身（并假设您的代码只会在单个进程中运行），那么这样的事情并不*太脏*：

```
public class ModeratorUtils
{
    private static readonly HashSet<int> _LockedPosts = new HashSet<int>();

    public void ModeratePost(int postId)
    {
        bool lockedByMe = false;
        try
        {
            lock (_LockedPosts)
            {
                lockedByMe = _LockedPosts.Add(postId);
            }

            if (lockedByMe)
            {
                // do your editing
            }
            else
            {
                // sorry, can't edit at this time
            }
        }
        finally
        {
            if (lockedByMe)
            {
                lock (_LockedPosts)
                {
                    _LockedPosts.Remove(postId);
                }
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T10:50:26.820

为什么不锁定整个帖子，而只锁定其 ID？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-16T04:46:29.207

[codeplex 的Coresystem](http://coresystem.codeplex.com)有两个基于值类型的线程同步类，详细信息请参见[http://codestand.feedbook.org/2012/06/lock-on-integer-in-c.html](http://codestand.feedbook.org/2012/06/lock-on-integer-in-c.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T11:01:11.973

我怀疑您是否应该使用数据库或 O/S 级别的功能（例如锁定）来进行业务级别的决策。长时间持有锁会产生巨大的开销（在这种情况下，任何超过几百毫秒的时间都是永恒的）。

在帖子中添加状态字段。如果你直接处理几个therads，那么你可以使用O/S级别的锁——来设置标志。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-23T11:54:58.007

恰好具有相同值的两个装箱整数是完全独立的对象。因此，如果您想这样做，那么您对 ​​Dictionary 的想法可能就是要走的路。您需要同步对字典的访问，以确保您始终获得相同的实例。你会遇到字典变大的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-23T12:01:52.360

C# 锁定是为了线程安全，不能按照您希望的方式为 Web 应用程序工作。

最简单的解决方案是在要锁定的表中添加一列，当 somone 锁定时，它会写入该列已锁定的数据库。

如果列被锁定以进行编辑，请不要让任何人在编辑模式下打开帖子。

否则，维护一个锁定条目 ID 的静态列表，并在允许编辑之前与该列表进行比较。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-23T11:37:53.557

你需要一种完全不同的方法来解决这个问题。

请记住，对于网站，您实际上并没有在另一端实时运行的应用程序来响应用户的操作。

你基本上启动了一个小应用程序，它返回网页，然后服务器就完成了。用户最终会发回一些数据是副产品，而不是保证。

因此，您需要在应用程序将审核页面返回给版主后锁定以保持，然后在版主完成后释放它。

而且您需要处理某种超时，如果版主在取回版主页面后关闭了他的浏览器，因此永远不会与服务器通信他/她已完成该帖子的版主过程。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-23T11:46:53.720

理想情况下，您可以避免所有复杂而脆弱的 C# 锁定并将其替换为数据库锁定，如果您的事务设计正确，那么您应该能够仅使用数据库事务。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-22T08:20:17.563

您想确保删除不会发生两次？

```
CREATE PROCEDURE RemovePost( @postID int )
AS
    if exists(select postID from Posts where postID = @postID)
    BEGIN
        DELETE FROM Posts where postID = @postID
        -- Do other stuff
    END 
```

这几乎是 SQL 服务器语法，我不熟悉 MyISAM。但它允许存储过程。我猜你可以模拟一个类似的过程。

无论如何，这将适用于大多数情况。唯一会失败的情况是两个主持人几乎同时提交，并且exists() 函数在另一个请求上执行DELETE 语句之前传递一个请求。我很乐意将其用于小型站点。您可以更进一步，检查删除是否实际删除了一行，然后再继续其余的，这将保证这一切的原子性。

尝试在代码中创建锁定，对于这个用例，我认为非常不切实际。让两个版主尝试删除帖子，一个成功，另一个无效，你不会失去任何东西。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-23T11:00:35.470

您应该使用这样的同步对象：

```
public class YourForm
{
    private static object syncObject = new object();

    public void Moderate()
    {
        lock(syncObject)
        {
            // do your business
        }
    }
} 
```

但是这种方法不应该在 Web 应用场景中使用。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-06-24T12:07:24.590

```
public static class ConexoesDeTeste
{
    private static int NumeroDeConexoes = 0;

    public static void Incrementar()
    {
         Interlocked.Increment(ref NumeroDeConexoes);
    }
    public static void Decrementar()
    {
        Interlocked.Decrement(ref NumeroDeConexoes);
    }

    public static int Obter() => NumeroDeConexoes;
} 
```

# java - 不使用 Java Web 框架让生活更美好？

> ID：781191
> 
> 赞同：48
> 
> 时间：2009-04-23T10:49:16.090
> 
> 标签：java, web-applications, web-frameworks

我厌倦了不得不每隔一天学习另一个 Java Web 框架。
JSP、Struts、Wicket、JSF、JBoss Seam、Spring MVC 等等——所有这些无数的框架都试图解决同样的问题。然而，它们都没有真正解决根本问题——这就是为什么总是会出现越来越多的新问题。

大多数在第一印象中看起来非常明亮和闪亮，因为它们简化了简单的事情。
但是，一旦涉及到现实世界用例的实施，就会遇到问题。
框架通常不提供任何帮助，而是通过强制根据框架自己的逻辑和环境来实现事物来阻碍和限制选项。

简而言之，我在使用框架时看到了以下缺点：

1.  大多数情况下学习曲线很陡峭，您首先需要了解有时相当学术的概念，并知道一堆配置文件的含义和位置，然后才能开始。
2.  文档通常或多或少很糟糕，要么缺少可公开访问的在线参考，要么已经过时，要么混淆了不同的不兼容版本，要么将所有这些混为一谈，而且通常没有提供任何有用的示例。
3.  该框架由数以万计的类组成，这使得仅通过浏览源代码几乎不可能理解其预期用途。
4.  因此，您需要购买一些“XYZ in action for dummy in 21 days”之类的书籍，它们的用户界面很糟糕，因为它们缺少全文搜索并且携带很重。
5.  要真正使用其中一个框架，您需要牢记如何按照框架要求的方式完成工作，方法是记住足够的类和方法名称，直到您的脑海中充满愚蠢和无用的信息，您无法将其用于其他任何事情.
6.  开销很大，会减慢应用程序的性能，并在尝试了解真正发生的事情时让您的大脑感到麻木。
7.  在现实世界中，由于工作效率的压力，通常没有时间熟悉新事物。由于这种边做边学的方法，人们总是只寻找完成下一项任务的最快方法，而不是真正了解新工具及其可能性。
8.  在我看来，遵循标准将使刚接触项目的人能够快速开始的论点是无效的，因为即使在同一家公司内，每个项目都使用不同的框架（至少在我的情况下）。

在我看来，阿尔伯特爱因斯坦的以下引用非常适合这里：

> “我们无法通过使用我们在创建问题时使用的相同思维来解决问题。”

回到我过去的 PHP 编码时代，那时编码仍然很有趣且富有成效，我曾经为大多数事情编写自己的框架，然后只是复制粘贴并将它们从一个项目应用到下一个项目。
这种方法效果很好，导致快速开发，完全没有开销，而且框架实际上比大多数 Java 框架更强大，但单个文件中只有几百行代码加上一些简单的 mod_rewrite 规则。
这当然不能解决 Web 开发的所有问题，但它简单、快速且直截了当。
虽然完美地适应了当前项目的要求，但它也易于扩展，并且由于零开销而具有非常高的性能。

那么，为什么使用这个框架会遇到这么多麻烦，为什么不把它们全部扔掉并回到根源呢？
当我们明天再次开始下一个带有新框架的项目时，我应该对我的老板说什么？
还是有可能真正有所作为的框架？
还是我忽略的一些隐藏优势？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-23T11:18:51.340

> 回到我过去的 PHP 编码时代，那时编码仍然很有趣且富有成效，我曾经为大多数事情编写自己的框架，然后只是复制粘贴并将它们从一个项目应用到下一个项目。这种方法效果很好，可以实现快速开发，完全没有开销，而且框架实际上比大多数 Java 框架更强大

原谅我一秒钟都不相信。

> 但在一个文件中只有几百行代码加上一些简单的 mod_rewrite 规则。这当然不能解决 Web 开发的所有问题，但它简单、快速且直截了当。

所以基本上你在几个月或几年的时间里开发了自己的框架，根据你自己的需求量身定制，并且可以很快地使用它，因为你非常了解它。

然而你无法理解为什么其他人也这样做，然后试图将结果变成每个人都可以使用的东西？

你开发的这个伟大的框架在哪里？如果它如此强大且易于使用，那么使用它开发的专用社区、成千上万的用户和数百个网站在哪里？

> 即使在同一家公司内，每个项目都使用不同的框架（至少在我的情况下）

嗯，这就是你的问题。为什么你会在每个项目之后丢弃从每个框架获得的专业知识？

我们的想法是选择一个框架并在多个项目中坚持使用它，以便您精通它。您必须花一些时间来学习该框架，然后通过允许您在更高级别上工作来节省您的时间。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-23T11:23:32.263

提出自己的框架的问题在于，您将犯所有已建立的框架已经偶然发现并解决的所有相同错误。在安全方面尤其如此。

只需询问 Jeff 和他们在堆栈溢出中实施 WMD 时必须考虑的事项。我宁愿使用他们在项目中产生的东西，也不愿从头开始实施。这只是一个例子。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-24T09:17:16.103

这是[Kev](https://stackoverflow.com/users/16777/kev)的引言，[您最有争议的编程观点是什么？](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion/)非常适合这里：

> 我认为整个“企业”框架都是雾里看花。J2EE、.NET、大多数 Apache 框架和管理此类事物的大多数抽象都产生了远比它们解决的复杂性。
> 
> 采用任何常规的 Java 或 .NET OMR，或任何所谓的现代 MVC 框架，它们都可以“神奇”地解决繁琐、简单的任务。您最终会编写大量难以验证和快速编写的难看的 XML 样板。您拥有大量 API，其中一半只是为了集成其他 API 的工作、无法回收的接口以及仅用于克服 Java 和 C# 的不灵活的抽象类。我们根本不需要大部分。
> 
> 所有不同的应用程序服务器都有自己的描述符语法，过于复杂的数据库和群件产品呢？
> 
> 重点不是复杂性==坏，而是不必要的复杂性==坏。我曾在大型企业安装中工作过，其中一些是必要的，但即使在大多数情况下，解决大多数用例也只需要一些本地脚本和一个简单的 Web 前端。
> 
> 我会尝试用简单的 Web 框架、开源数据库和琐碎的编程结构来替换所有这些企业级应用程序。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-23T11:24:28.113

问题当然不仅仅在于 Java 框架。我已经数不清有多少 C++ MFC 项目陷入困境，试图将他们的要求硬塞到文档/视图模型中（这实际上只适用于文本和图形编辑器 - 数据库应用程序特别难以硬塞） .

成功使用框架的秘诀是改变你的应用程序以匹配框架，而不是相反。如果你不能做到这一点，甚至不要考虑使用框架——它最终会比你在一些好的、可靠的和有据可查的实用程序库的帮助下从头开始编写应用程序更多的工作。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-23T12:18:15.253

所以你是说我们每次想要构建一个 Web 应用程序时都应该处理套接字和 HTTP！

servlet 容器本身可以被认为是一个框架，因为它处理所有这些混乱的细节，并让您编写更简单的 Servlets/Filters/Listeners（即：特定于您的应用程序的框架的“扩展”）。

任何框架都试图做的就是将平凡的、可重复的、容易出错的、跑腿的代码与有趣的特定于应用程序的代码分开。

但是，对于小型应用程序，您可以简单地使用仅使用 JSP 和 Servlet 的[Model 2 MVC](http://www.java-samples.com/showtutorial.php?tutorialid=350)方法。

例子：

```
class MyController extends HttpServlet {
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ... {
        MyBean model = // do something
        request.setAttribute("model", model);
        request.getRequestDispatcher("/view.jsp").forward(request, response);
    }
} 
```

然后随着您的应用程序变得更加复杂，您可以考虑使用 Spring MVC 来提供控制器、视图解析器等的更松散耦合（因此更灵活）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-23T14:24:25.807

当遇到另一个不能解决问题的框架时，我和你一样痛苦。

在经历了十年的 jsp、struts、EJB、EJB2、struts2、jsf 以及最近所有新的 Web 服务框架、xslt 的恐怖和 wsdl-first 的噩梦之后，我绝对受够了。

框架存在许多问题。它们[泄漏](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)了，所以你必须学习更多——而不是更少，内部框架有巨大的成本，使用外部框架的成本也很高（但要少得多），因为它们很少交付，然后你最终编写了大量的 xml 配置并花费数天时间进行纠正您在最喜欢的内容帮助代码编辑器中立即看到的大小写和拼写错误。

也许答案是找到不那么浮夸的*工具包*，试图解决问题但不重新定义世界，但这也很难，因为基本的应用程序模型（html over http）很尴尬 - 充其量是。

再加上周围似乎有很多[复杂因素](http://thedailywtf.com/Articles/Classic-WTF-The-Complicators-Gloves.aspx)，人们似乎痴迷于将无聊的简单问题转换为复杂（但很难）有趣的问题（可能是上面提到的 Eric Sink 的软件开发公理的变体。）

加上开发人员的狂妄自大，他们知道这一切，并毫不犹豫地编写一个新框架来为您解决所有难题，只是他们做不到，剩下 10%，只是现在更难修复。

我没有 .NET 经验，但 .NET 世界似乎不太挤满理论家和复杂化者，也许 VB 挥之不去的臭味吓跑了他们，但每次我听到有人告诉我他们已经在他们的 maven 上花费了 1500*小时*config（你好？），我正在认真考虑从我的简历中删除“java”。

……又是什么问题？是否有任何框架有所作为？

编辑 - 添加了 Stripes 和 QueryDSL。

我会尝试使用带有 QueryDSL + Hibernate 或 OpenJPA（带有注释）的 Stripes 或 GWT，只是因为您实际上是用 Java 开发的，并尝试限制使用 wsdl-first web 服务、以 xml 为中心的框架、EJB 和 ESB（不是啤酒）尽可能。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-23T11:33:30.650

我曾经做过一个项目，试图在 JSF 中实现它。这是一场噩梦。

大部分工作时间都花在了编译上。不少于一半的编译内容不起作用的事实是另一回事。几乎没有教程。文档基本上是一个没有人工注释的自动源代码导出。怎么能指望这样工作呢？

在我们见过的几个框架中，只有 Sun 能够创建一个完全可编译的新项目！另一个只能生产一堆需要很多天才能进入可编译状态的东西。

网络几乎是静悄悄的。对于任何搜索我们不超过 20 页的搜索结果，有用的前 1-3。在发现的相关内容中，一半的人在呼救，另一半声称他们在呼救，没有人来，他们失去了时间和兴趣，放弃了这项技术。

所以我们花了很多时间，只做了一些简单的事情，比如用 ASP.NET 可以在几周内完成。

然后我们查看了替代的 JSF 框架。令我们惊讶的是，我们发现它们都非常不相容。

毫不奇怪，我们也加入了放弃 JSF 的行列。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-23T15:47:18.547

考虑反点。我现在在一家不使用任何超出 JSP 标准的框架的商店工作。每个人都有不同的做事方式，我们对解耦等概念和验证等安全问题非常松懈。

虽然我不认为使用框架会自动使您成为更好的编码员，但我确实认为通过使用大多数框架实现的标准设计模式并轻松访问验证等实用功能，我认为您很有可能成为被迫编码达到一定的标准。

**在 Web 应用程序设计中，您并非每次都在发明轮子，因此您最终要么为常见任务推出自己的解决方案，要么使用框架。**我假设通过使用常用框架而不是自行开发，您将获得经过良好测试且灵活的底层代码。

将自己的解决方案作为一种学术追求并没有错，但我承认**有些人会花更多的时间在一个强大的解决方案上，然后我可能会花更多的时间。**以 log4j 为例，很容易滚动您的记录器，但是 log4j 经过良好的测试和维护，他们花时间将灵活性和性能提高到大多数滚动您自己的记录器无法触及的程度。最终结果是一个健壮但足够简单的框架，即使在最基本的应用程序中也可以使用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-23T11:15:27.527

对我有用的是：你不应该只学习你听说过的任何 Web 框架，看看它，看看它是否能让你轻松编写代码，在 stackoverflow 或论坛上询问它的优缺点，然后学习它并学习它很好，坚持下去，直到你觉得它坏了或完全过时了。你写的任何网络框架本身都很好，如果你“真的”知道它的作用，那么使用它会很有趣。如果你不这样做，你只是在没有指南针的沙漠中徘徊！我还发现 21 天书是您不掌握框架或技术的可靠方法。在采用 af/w 时，Docs 肯定是要考虑的事情，如果您自己查看代码，它也会有所帮助（实际上，当我遇到一些我觉得奇怪的行为时，这对我有最大的帮助。

1-那么为什么使用这个框架会很麻烦，为什么不把它们全部扔掉并回到根源呢？

如果你回到根源，你会一次又一次地重写做同样事情的代码 + 这些 f/ws 中的大多数都是开源的，这意味着它们在维护方面可能比你单独对自己的 f/w 做的更好。

2-明天我们又要开始下一个带有新框架的项目时，我应该对我的老板说什么？

这是我第一次使用这个 f/w 我不明白为什么要使用这个 f/w 我已经知道 X 并且我真的很擅长它。记住我学习这个 f/w 的成本，由于我对这种 f/w 的无知而必须完成的返工成本。我认为我们最好使用 X，如果这是一个特定的要求，我们应该争取它，并且只有在我们真的必须说明以前的注释时才这样做。

还是有可能真正有所作为的框架？

只有那些以您的思维方式而不是您编写代码的方式来解决问题的人（想想在其黄金时代执行 MVC 模式的 struts）。

还是我忽略的一些隐藏优势？

想不出任何tbh。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-23T11:18:25.787

你在 PHP 中也有同样的问题：框架比你指望的要多，每个都是最好的和最伟大的（尽管你有一些提示：纯 PHP5 设计与 PHP4 兼容性，Rails 哲学（不灵活的文件夹层次结构，自动生成代码）与库方法...）并且您花费更多时间搜索和探索可能性而不是编写代码！
但在 PHP 中，它允许预先解决常见问题，如 I18N 支持、插件集成、会话和身份验证管理、数据库抽象、模板、Ajax 支持等。避免在每个项目上重新发明轮子，避免失败新手常见的陷阱。

当然，Java 框架也有一些提示：大还是小？有据可查吗？广泛使用还是保密？是否适合 XML 粉丝？等等
。我想大多数框架都针对大型项目，学习时间不是一个大问题，可扩展性和易于部署很重要，等等。它们对于小型项目来说可能是矫枉过正的。

在此类框架中还有一种趋势，即旨在做一组一致的松散耦合库，而不是一个单一的框架。在 PHP 世界中，Zend 框架就是这种情况（有些人甚至否认使用“框架”一词......）。
因此，它解决了“解决常见问题”的问题，而不会妨碍您。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-23T11:22:23.953

然而，我不同意你提到的一些观点，但我同意你关于无聊工作的看法。

是的，所有 Web 应用程序都是关于页面显示表单、收集数据、进行验证、发送数据以存储在数据库中、通过搜索表单过滤存储的数据并在表格中显示结果并选择一个或多个记录进行操作（CRUD 或所有关于更改数据库状态的业务操作）。

但是我只工作了 4 年，当然还有我 4 年的学术研究。我觉得这种类型的开发很无聊，因为你没有发明算法，当然当你发现新框架时你会很开心，如果你将其中一个 AI 引擎集成到你的应用程序中会更开心，但最后我觉得这项工作是虚拟工作，或者说机器工作，所以为什么我们不自动化所有这些东西。

是的另一个框架；) MDA 模型驱动架构，简而言之，是关于从 PIM（平台独立模型）到 PSM（平台特定模型）的转换，例如从 UML 到代码。

这可能会解决您的学习曲线和技术变化问题，因为您只需要擅长建模，因为有一些**框架**可以实现 MDA 规范，例如**AndroMDA**，因为它具有采用类图、用例、序列的墨盒图表和活动图表并生成数据库创建脚本、POJO、休眠映射、Spring/EJB、JSF/Struts、.NET 代码。

当然，这样的框架不会生成 100% 的代码，但会生成很大比例的代码，当然你会问这个框架将在哪里解决复杂和棘手的需求场景？今天我会说不，明天是。

那么为什么你和我不投资开发这个伟大的框架。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-23T14:53:38.063

所以你认为如果我们在每个项目中都发明轮子会更好吗？

您可能会将过多的框架视为一个问题，这确实使选择自己的框架变得更加困难。但另一方面，您不必逐个尝试；即使你这样做了，你最终也会更喜欢其中的一些。您将拥有一个最喜欢的 ORM 框架，另一个用于 Web 开发、IoC 等。

在一些论坛上阅读以了解哪些是最受欢迎的确实有帮助；它们之所以受欢迎，一定是有原因的，即使这不是正确的原因（比如技术出类拔萃，也许它只是在经理中流行，因为流行语超载等等），了解上述框架会很有帮助，因为你将能够参与多个使用它的项目。

另外，使用框架而不是编写自己的框架将为您节省很多问题。作者并不总是发现并解决错误；这通常由框架的用户完成。您说您最终在 PHP 中拥有了自己的私有框架；我敢打赌它不是没有错误的，但也许你不知道它，因为你是唯一的用户和唯一的编码器。

# flash - 通过在 AS2 应用程序中单击外部来关闭下拉列表？

> ID：781196
> 
> 赞同：0
> 
> 时间：2009-04-23T10:49:58.757
> 
> 标签：flash, actionscript, actionscript-2

我正在维护一个 ActionScript 2 应用程序，它使用 createEmptyMovieClip 创建下拉列表（列表项作为影片剪辑附加）。显然，我可以通过 removeMovieClip 等直接关闭下拉菜单。

我的问题是：下拉菜单不仅应该在单击某个项目或再次触发创建它的按钮时关闭，而且还应该在用户单击下拉列表之外的任何位置时关闭（例如 onReleaseOutside，除了单击也在外部开始）。

到目前为止，我能看到的唯一解决方案是通过为其提供 onRelease 将 _root （或不可见层）变成一个按钮，但这很骇人听闻，因为它使 _root 被 Flash 视为按钮（指针鼠标光标等等） . 不要！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T11:18:09.483

我正要建议你做你不想做的事情，因为它*是*hackish。设置鼠标监听器可能是一种选择......（我很快就画了[mc]......）

```
MouseListener = new Object()
Mouse.addListener(MouseListener)
MouseListener.onMouseDown=function(){
    trace ("heard:'DOWN'")
    // do your call to close the button here, perhaps?
}

another.onPress=function(){
    trace ("pressed!")
} 
```

暂时还想不到更好的办法...

上面的代码并没有解决太多问题，但它表明您可以监听点击以及做一些与您点击的内容相关的事情，并且它们是两个单独的操作。

# .net - 从 .NET 中的 Form 类派生

> ID：781201
> 
> 赞同：3
> 
> 时间：2009-04-23T10:51:16.133
> 
> 标签：.net, winforms, derived-class

理论上你可以从表单派生，但这是你不应该做的事情吗？我直觉上是这么认为的，但我从来没有听说过这样的规则。

我的意思是一些已经从 Form 派生的具体类。例如，如果我有`class MyForm : Form`，问题是：我可以从`MyForm`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T10:57:06.837

创建新的 Windows 窗体时，您**应该**从 Form 派生。在 Visual Studio 中创建新表单时，您获得的源文件已经派生自 Form.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T10:53:26.610

没有硬性规定可以阻止您派生 windows 窗体。如果您有充分的理由这样做（例如，在您的项目中的所有表单中加入一些共同的功能），那么请继续。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T11:42:02.627

从通用基类 Form 派生类派生表单是完全合理的，并且对于为您的应用程序提供标准外观很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T12:12:44.017

我们已经成功地从表单派生了一个类，然后从它派生了项目中的所有表单。它使我们能够轻松地应用项目范围的策略。我们所有的表格都有一致的外观和感觉。它还使每个表单都可以轻松记住其大小和位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T12:19:54.017

我强烈建议从 BaseForm 继承。这很容易让所有的 EditForm 看起来都像，因为您可以在基础上设置通用控件（如按钮），给它们一个背景色/图像等。所有可以分组的表单也是如此。我通常有 1 个 BaseForm，然后根据它的“组”（编辑、列表、对话框......）再有一个 BaseForm

它让你的 winapp 看起来更加一致。

代码也是如此，通常编辑表单具有相似的代码库：验证，保存逻辑，......您可以将所有这些逻辑放在基本表单上，然后有一些可以在子表单上实现的抽象方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T11:00:33.363

这个问题真的取决于你的派生类做了什么。

表单和许多此类最终类旨在执行许多复杂的任务，以使您充分利用与表单相关的活动，而无需编写太多代码。

规则是这样的，“如果你打算做一个简单的窗口操作，并且如果它不会干扰常规行为，那么最好不要从形式派生。

或者由于表单负载很重，您可以通过从基类而不是表单派生它来节省内存和 CPU 时间。

# jquery - ASP.NET MVC - jQuery 可排序

> ID：781203
> 
> 赞同：0
> 
> 时间：2009-04-23T10:51:40.157
> 
> 标签：jquery, asp.net-mvc

我有一个可以排序的菜单项列表。我有基于此[链接](http://blog.codeville.net/2009/01/01/drag-and-drop-sorting-for-our-aspnet-mvc-list-editor-in-one-line-of-code/)的排序工作。

但是，我不确定如何将菜单项的顺序保存到数据库中？我正在使用休眠。

查看代码

```
<h3>Sort Main Menus</h3>
<% using(Html.BeginForm()) { %>
    <p>You can drag the items into a different order</p>
    <p></p>
    <div id="items">
        <% foreach (var mainMenusList in ViewData.Model) 
           {%>
             <%Html.RenderPartial("MainMenuEditor", mainMenusList, new ViewDataDictionary(ViewData) { { "mainMenuName", "mainMenu" } });%>     
           <%} 
        %>
    </div>
    <input type="submit" value="Save changes" />
 <% } %>

 <script type="text/javascript">
    $(function() 
    {
        $("#items").sortable({ axis: "y" });
    });
</script> 
```

MainMenuEditor 代码

```
<div>
 <input type="hidden" name="<%= ViewData["mainMenuName"] + ".index" %>" value="<%= ViewData.Model.Id %>" />
 <% var fieldPrefix = string.Format("{0}[{1}].", ViewData["mainMenuName"], ViewData.Model.Id); %>
 <%= Html.Hidden(fieldPrefix + "MainMenuID", ViewData.Model.Id) %>
 <%= Html.TextBox(fieldPrefix + "Name", ViewData.Model.MainMenuName, new { size = "30"})%></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T12:09:15.977

我认为您需要一个`<form>`-tag，然后将该表单提交给您的控制器。控制器需要将数据传递给模型，模型会将数据保存在数据库中。

# .net - View 和 ViewModel 之间的 MVVM 依赖关系

> ID：781204
> 
> 赞同：3
> 
> 时间：2009-04-23T10:51:41.780
> 
> 标签：.net, wpf, design-patterns, mvvm

目前，MVVM 设计模式有很多变体，但据我了解，允许视图依赖于视图模型。我的一位同事不同意，但他无法提供令人满意的解释。

例如，我的视图包含对其视图模型的引用。这不是所有视图都需要的，但它有助于将某些事件传达给无法使用 ICommand 完成的视图模型。

有这种依赖关系可以吗？有什么缺点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T13:10:09.247

主要指标是：**你能测试它**吗？

视图*绝对*需要对视图模型的引用。否则它将如何获得显示自身所需的信息？通常只在视图中拥有视图模型`DataContext`就足够了，但这仍然构成依赖关系。如果没有虚拟机`DataContext`，视图将毫无用处。

有时您需要将视图回调到 VM。通常我只是在后面的代码中执行此操作：

```
public MyViewModel ViewModel
{
    get { return DataContext as MyViewModel; }
}

private void _someEventHandler(object sender, EventArgs )
{
    ViewModel.SomeMethod();
} 
```

从视图模型中保存对视图的引用是您需要小心的地方。如果 VM 依赖于特定的视图实现，它与视图紧密耦合，因此难以测试。

如果 VM 需要以某种方式与视图交互，您可以将需求抽象为一个接口并让视图实现该接口。然后，当视图加载时，它可以为 VM 提供对自身的引用，VM 可以与之交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T12:06:04.940

仅通过数据绑定进行耦合非常好，但有时视图需要的不仅仅是来自视图模型的命令和属性。我有一个视图需要响应视图模型中的事件，而这些事件不能被路由事件。所以这个视图需要一个对其视图模型的引用。

我认为视图尝试将其 DataContext（通常在 DataContextChanged 事件内部）转换为正确的接口类型是一个好主意。这样，视图仍然可以通过数据模板和其他 XAML 进行初始化。如果您强制在构造函数中传递接口，则必须在代码中创建视图。

# c# - 使用 url 编码的斜杠获取 URL

> ID：781205
> 
> 赞同：39
> 
> 时间：2009-04-23T10:51:46.850
> 
> 标签：c#, .net, http, base64, url-encoding

我想发送一个 HTTP GET 到`http://example.com/%2F`. 我的第一个猜测是这样的：

```
using (WebClient webClient = new WebClient())
{
  webClient.DownloadData("http://example.com/%2F");
} 
```

不幸的是，我可以看到实际通过网络发送的内容是：

```
GET // HTTP/1.1
Host: example.com
Connection: Keep-Alive 
```

所以[http://example.com/%2F](http://example.com/%2F)在传输之前被翻译成[http://example.com// 。](http://example.com//)

有没有办法实际发送这个 GET 请求？

OCSP 协议要求在通过 HTTP/GET 使用 OCSP 时发送 base-64 编码的 url 编码，因此需要发送实际的 %2F 而不是“/”以符合要求。

**编辑：**

以下是 OCSP 协议标准（[RFC 2560](http://www.ietf.org/rfc/rfc2560.txt)附录 A.1.1）的相关部分：

> 使用 GET 方法的 OCSP 请求构造如下：
> 
> > GET {url}/{url-encoding of base-64 encoding of the DER encoding of the OCSPRequest}

我对其他的解读持开放态度，但我看不出还有什么意思。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-24T08:15:24.507

这是一个可怕的 hack，必然与框架的未来版本不兼容等等。

但它有效！

（在我的机器上......）

```
Uri uri = new Uri("http://example.com/%2F");
ForceCanonicalPathAndQuery(uri);
using (WebClient webClient = new WebClient())
{
  webClient.DownloadData(uri);
}

void ForceCanonicalPathAndQuery(Uri uri){
  string paq = uri.PathAndQuery; // need to access PathAndQuery
  FieldInfo flagsFieldInfo = typeof(Uri).GetField("m_Flags", BindingFlags.Instance | BindingFlags.NonPublic);
  ulong flags = (ulong) flagsFieldInfo.GetValue(uri);
  flags &= ~((ulong) 0x30); // Flags.PathNotCanonical|Flags.QueryNotCanonical
  flagsFieldInfo.SetValue(uri, flags);
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-08-29T02:32:44.077

默认情况下，`Uri`该类不允许在 URI 中使用转义`/`字符 ( `%2f`)（即使在我阅读[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)时这似乎是合法的）。

```
Uri uri = new Uri("http://example.com/%2F");
Console.WriteLine(uri.AbsoluteUri); // prints: http://example.com// 
```

（注意：[不要使用 Uri.ToString](https://faithlife.codes/blog/2010/08/uritostring_must_die/)来打印 URI。）

根据Microsoft Connect 上[此问题的错误报告](https://connect.microsoft.com/VisualStudio/feedback/details/511010/erroneous-uri-parsing-for-encoded-reserved-characters-according-to-rfc-3986)，此行为是设计使然，但您可以通过将以下内容添加到 app.config 或 web.config 文件来解决此问题：

```
<uri>
  <schemeSettings>
    <add name="http" genericUriParserOptions="DontUnescapePathDotsAndSlashes" />
  </schemeSettings>
</uri> 
```

（从[https://stackoverflow.com/a/10415482](https://stackoverflow.com/a/10415482)转发，因为这是在不使用反射修改私有字段的情况下避免此错误的“官方”方式。）

**编辑：**连接错误报告不再可见，但[文档`<schemeSettings>`](http://msdn.microsoft.com/en-us/library/ee656539.aspx)推荐这种方法允许`/`URI 中的转义字符。请注意（根据那篇文章），对于未正确处理转义斜杠的组件可能存在安全隐患。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-12-22T20:15:40.727

对此的更新：看起来 Uri 类的默认行为实际上在 .NET 4.5 中发生了[变化](http://msdn.microsoft.com/en-us/library/hh367887(v=vs.110).aspx#core)，您现在可以使用转义的斜杠并且它们不会被触及。

我在 .NET 3.5、.NET 4.0、.NET 4.5/4.5.1 中运行了以下代码

```
static void Main(string[] args)
{
    var uri = new Uri("http://www.yahooo.com/%2F");
    var client = new WebClient();
    client.DownloadString(uri);
} 
```

在 .NET 3.5/4.0 中，跟踪显示 %2F 实际上未按预期进行转义。

![提琴手踪迹](https://i.stack.imgur.com/tSBg5.png)

但是，在 .NET 4.5/4.5.1 中，您可以看到 %2F 未转义（注意 GET /%2F）

![提琴手踪迹](https://i.stack.imgur.com/9L7Kb.png)

您现在甚至可以在 Uri 上使用 ToString()，您将获得相同的结果。

因此，总而言之，如果您使用的是 .NET >= .NET 4.5，那么事情的表现将与 RFC 内联。

我只是尝试在 Mono 上使用相同的方法进行探索。我在这里发布了关于方法的问题：[Get a Uri with escaped slashes on mono](https://stackoverflow.com/questions/20769150/getting-a-uri-with-escaped-slashes-on-mono)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-13T05:18:59.890

正如我在对 Ramus 发布的答案的评论中提到的那样，.Net Standard（以及可能的 .Net Framework 的更高版本）需要以下内容才能使这个 hack 工作：

```
Uri uri = new Uri("http://example.com/%2F");
ForceCanonicalPathAndQuery(uri);
using (WebClient webClient = new WebClient())
{
  webClient.DownloadData(uri);
}

void ForceCanonicalPathAndQuery(Uri uri){
  string paq = uri.PathAndQuery; // need to access PathAndQuery
  FieldInfo flagsFieldInfo = typeof(Uri).GetField("_flags", BindingFlags.Instance | BindingFlags.NonPublic);
  ulong flags = (ulong) flagsFieldInfo.GetValue(uri);
  flags &= ~((ulong) 0xC30); // Flags.PathNotCanonical|Flags.QueryNotCanonical
  flagsFieldInfo.SetValue(uri, flags);
} 
```

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2009-04-23T10:55:52.830

双重编码：**%252F**

但是，如果您使用 HttpWebRequest，您实际上可以告诉不要对 URL 进行编码，无论哪种方式它都应该工作。

此外，如果 WebClient 接受 URI，那么您可以创建一个新的 URI，并且可以将其设置为不编码。

# crystal-reports - Crystal Reports - 格式不一致

> ID：781206
> 
> 赞同：1
> 
> 时间：2009-04-23T10:52:17.130
> 
> 标签：crystal-reports

我们有 ac# windows 服务从 Crystal 11 RPT 文件生成报告。

今天早上，服务正常重新启动，正确生成了几个报告，然后似乎在一个特定报告中更改了表格标题中的行距，因此标题不正确。文本的宽度也发生了变化，一些单词在通常不会换行的地方换行。

大约 20 份报告生成错误，大约半小时后，报告恢复正常。

其他 RPT 文件不受影响。

前几天没有出现这个问题，所以和时间没有简单的关系。

一些报告在表格中没有行被搞砸了，所以这不仅仅是数据不适合表格的问题。

任何人都可以帮助提出一个解释，或者这只是人们对像水晶一样绝望的产品所期望的那种疯狂？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T11:02:19.397

您是否更改了报表使用的打印机的默认打印机或其他打印机设置？如果未找到在报告中选择打印的打印机，则报告将打印到默认打印机。这可能会导致页面设置根据打印机支持的尺寸和字体而改变。

# python - 如何为不同分支中的 Django ROOT_URLCONF 设置设置正确的值

> ID：781211
> 
> 赞同：7
> 
> 时间：2009-04-23T10:54:32.317
> 
> 标签：python, django, mercurial

我已将由`django-admin startproject`版本控制（Mercurial）创建的站点目录。假设该站点名为`frobnicator`.

现在我想做一些认真的重构，所以我使用命令克隆了站点

```
hg clone frobnicator frobnicator-refactoring` 
```

但`ROOT_URLCONF`在`settings.py`仍然说`frobnicator.urls`。

有没有更好的方法来克服这个问题，而不是将站点移动到包装目录中并将该目录存储在版本控制下（以在分支后保持相同的站点名称）或使用本地分支？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T12:01:26.323

只需从`ROOT_URLCONF`定义中删除项目名称 - 它是可选的。然后，您可以拥有不同名称的项目文件夹。

# c# - 如何在 WPF 中调用 windows 主题？

> ID：781217
> 
> 赞同：2
> 
> 时间：2009-04-23T10:57:15.667
> 
> 标签：c#, wpf, themes

大家好，我正在尝试为 WPF 3.5 中的元素调用当前的 windows 主题。

当用户更改窗口主题时，我的应用程序也应该根据主题进行更改。

我正在使用样式。

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:15:59.483

您可以通过将资源字典添加到 Themes 文件夹来根据桌面主题定义不同的外观。桌面主题确定使用哪个资源字典。以下是资源字典文件名和桌面主题的列表：

1.  Classic.xaml – Windows XP 上的“经典”Windows 9x/2000 外观。
2.  Luna.NormalColor.xaml – Windows XP 上的默认蓝色主题。
3.  Luna.Homestead.xaml – Windows XP 上的橄榄色主题。
4.  Luna.Metallic.xaml – Windows XP 上的银色主题。
5.  Royale.NormalColor.xaml – Windows XP Media Center Edition 上的默认主题。
6.  Zune.NormalColor.xaml – Windows XP Zune 上的默认主题。
7.  Aero.NormalColor.xaml – Windows Vista 上的默认主题 ...

您可以在那里阅读详细信息（[http://blogs.msdn.com/wpfsdk/archive/2007/07/31/using-themes-with-custom-controls.aspx](http://blogs.msdn.com/wpfsdk/archive/2007/07/31/using-themes-with-custom-controls.aspx)）

# sql - 在预订系统中查找空闲时段

> ID：781221
> 
> 赞同：1
> 
> 时间：2009-04-23T10:57:48.613
> 
> 标签：sql, mysql, django, date

在[我关于搜索日期范围](https://stackoverflow.com/questions/778353/comparing-two-date-ranges-when-one-range-has-a-range-of-starting-dates)的问题中，我尝试简化问题并无意中提出了一个不同且更简单的问题。

我不会通过编辑使这个问题复杂化，而是要问我真正想要的问题。

我有两张桌子属性和预订。预订具有属性的外键以及开始和结束日期。

用户正在搜索空闲时段并提供所需的天数。他们还提供了一系列他们感兴趣的开始日期。因此，搜索将按照以下方式进行：“找到我想要的所有属性，我想要一个 3 天的时段，从 5 月的任何时候开始。”

现在我可以通过以下方式做到这一点： 1\. 为每个可能的开始日期运行 31 个查询 2\. 查找 5 月份的所有预订，将它们压缩成一个代表天数的 31 个布尔值数组，然后循环查找插槽。

我假设（2）在大多数情况下更有效。有没有更好的算法？是否有纯 SQL 解决方案。

我将使用 Django，我的数据集很小，所以我可能会接受一个“愚蠢”的方法，但我很想知道最好的算法是什么样的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T11:39:40.370

可能对您的应用程序来说有点矫枉过正 - 但是：

以使“写入”过程更加复杂为代价来改进搜索的一种相对简单的方法是更改​​ Booking 表以使其成为“可用性”表。

添加一个布尔列以指示插槽是空闲的还是预订的（或者最好还是输入预订它的客户的 ID，如果插槽是空闲的则使用 0）。

从 2009 年 1 月 1 日 -> 20 年 12 月 31 日的一个免费时段开始？

当您获得预订时，将免费插槽分为 3 个（两个插入和一个更新）、预订插槽和两个可用插槽。

继续这样做，随着时间框架变得更加分散，预订过程将包括以下内容之一：

*   将整个“可用插槽”分配给某人（一次更新）
*   将“可用插槽”拆分为两个（一个更新和一个插入）
*   如果有人从可用插槽中预订了中间部分，则将插槽分成 3 个（如上所述）。

管理起来并不复杂，搜索过程变成了一个简单的查询：在所需的时间范围内找到任何可用的时间段（booked=false 或 customerid=0，无论您采用哪种方式）其中 enddate - startdate >= 数字你想要的天数。

它将预订/可用性表的大小增加了一倍，并使预订变得不那么简单，但权衡是搜索过程几乎是尽可能简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T13:27:03.857

表定义会有所帮助，但这里有。这应该适用于 MS SQL Server，但是一旦你理解了它背后的想法，将它转换为 MySQL 应该是一项微不足道的任务。

日历表只是一个标准实用程序表，其中包含对数据库有用的所有日期。如果您还没有，我建议您创建一个并填充它。

```
CREATE TABLE Calendar
(
     date        DATETIME     NOT NULL,
     is_holiday  BIT          NOT NULL,
     -- any other columns that might be relevant for your business
     CONSTRAINT PK_Calendar PRIMARY KEY CLUSTERED (date)
) 
```

然后，您需要使用可能对您的业务有意义的任何日期填充表格。即使您回到 100 年并向前 100 年，表中的行数仍然少于 75K，并且它在日期上聚集，因此它应该快速且易于使用。它使许多基于日期的查询变得更加简单。

```
SELECT
     P.property_id,
     C.date
FROM
     Calendar C
JOIN Properties P ON 1=1
WHERE
     C.date BETWEEN @search_start_date AND @search_end_date AND
     NOT EXISTS
     (
          SELECT
               *
          FROM
               Bookings B
          WHERE
               B.property_id = P.property_id AND
               B.start_date <= DATEADD(dy, @slot_length, C.date) AND  -- You would use MySQLs date function
               B.end_date   >= C.date
     ) 
```

或者：

```
SELECT
     P.property_id,
     C.date
FROM
     Calendar C
JOIN Properties P ON 1=1
LEFT OUTER JOIN Bookings B ON
               B.property_id = P.property_id AND
               B.start_date <= DATEADD(dy, @slot_length, C.date) AND  -- You would use MySQLs date function
               B.end_date   >= C.date
WHERE
     C.date BETWEEN @search_start_date AND @search_end_date AND
     B.booking_id IS NULL 
```

# oracle - 为什么 Oracle 同义词会向基础表返回不同数量的行？

> ID：781224
> 
> 赞同：5
> 
> 时间：2009-04-23T10:58:45.897
> 
> 标签：oracle, synonym

我有一个非常不寻常的情况，我希望有人能够对此有所了解。我对 oracle 同义词的理解是，它基本上是另一个模式中表的别名。

当我从同义词中计数时，它返回零行。当我从基础表中执行相同操作时，它会返回 12000 行。

我无法解释这种差异。任何人都可以帮忙吗？

```
select * from dba_synonyms
where synonym_name = 'CS_INCIDENTS_B_SEC';

OWNER  SYNONYM_NAME        TABLE_OWNER  TABLE_NAME          DB_LINK
------ ------------------- ------------ ------------------- -------
APPS   CS_INCIDENTS_B_SEC  CS           CS_INCIDENTS_ALL_B         

select count(*) from CS.CS_INCIDENTS_ALL_B;

COUNT(*)               
---------------------- 
12549                  

select count(*) from APPS.CS_INCIDENTS_B_SEC;

COUNT(*)               
---------------------- 
0 
```

解释计划：

直接上桌...

```
EXPLAIN PLAN FOR
SELECT  *
FROM    CS.CS_INCIDENTS_ALL_B

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------
| Id  | Operation         | Name               | Rows | Bytes| Cost(%CPU)|
--------------------------------------------------------------------------
|   0 | SELECT STATEMENT  |                    | 6056 | 1549K|  122   (3)|
|   1 |  TABLE ACCESS FULL| CS_INCIDENTS_ALL_B | 6056 | 1549K|  122   (3)|
-------------------------------------------------------------------------- 
```

通过同义词...

```
EXPLAIN PLAN FOR
SELECT  *
FROM    APPS.CS_INCIDENTS_B_SEC

PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
| Id  | Operation          | Name               | Rows | Bytes| Cost(%CPU)|
---------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |                    |    1 |  262 |    0   (0)|
|*  1 |  FILTER            |                    |      |      |           |
|   2 |   TABLE ACCESS FULL| CS_INCIDENTS_ALL_B | 6056 | 1549K|  122   (3)|
---------------------------------------------------------------------------

1 - filter(NULL IS NOT NULL) 
```

同义词链...

```
SQL> SELECT  *
  2  FROM    dba_synonyms
  3  START WITH
  4          owner = 'CS'
  5          AND synonym_name = 'CS_INCIDENTS_ALL_B'
  6  CONNECT BY
  7          owner = PRIOR table_owner
  8          AND synonym_name = PRIOR table_name
  9  /

no rows selected

SQL> SELECT  *
  2  FROM    dba_synonyms
  3  START WITH
  4          owner = 'APPS'
  5          AND synonym_name = 'CS_INCIDENTS_B_SEC'
  6  CONNECT BY
  7          owner = PRIOR table_owner
  8          AND synonym_name = PRIOR table_name
  9  / 
```

正在检查数据库上的策略...

```
SQL> SELECT *
  2  FROM dba_policies
  3  WHERE OBJECT_NAME = 'CS_INCIDENTS_B_SEC'
  4  /

OBJECT_OWNER  OBJECT_NAME         POLICY_GROUP  POLICY_NAME          
------------- ------------------- ------------- -------------------- 
APPS          CS_INCIDENTS_B_SEC  SYS_DEFAULT   CS_SR_SEC_SR_ACCESS  

PF_OWNER  PACKAGE            FUNCTION       SEL INS UPD DEL IDX CHK 
--------- ------------------ -------------- --- --- --- --- --- --- 
APPS      FND_GENERIC_POLICY GET_PREDICATE  YES NO  NO  NO  NO  NO  

ENABLE STATIC_POLICY POLICY_TYPE  LONG_PREDICATE
------ ------------- ------------ --------------
YES    NO            DYNAMIC      YES 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T11:11:32.510

**更新：**

您已[`ROW LEVEL SECURITY`](http://download.oracle.com/docs/cd/B19306_01/network.102/b14266/apdvcntx.htm#i1007410)启用。

`FND_GENERIC_POLICY.GET_PREDICATE`每次访问表时都会调用user 函数并限制对某些行的访问。

它会根据您如何访问表返回不同的结果：直接或通过`SYNONYM`.

您需要查看函数并查看发生了什么（或在此处发布函数文本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T11:10:33.840

您是否 100% 确定这`CS.CS_INCIDENTS_ALL_B`实际上是一个表格而不是一个视图？如果它是一个视图，也许它在 WHERE 子句中做了一些不寻常的事情。

```
select object_type from dba_objects where owner = 'CS' and object_name = 'CS_INCIDENTS_ALL_B' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:40:28.833

检查以确保没有其他与您的同义词同名的 APPS 拥有的对象（视图或表）。

```
select object_type,object_name
from   dba_objects
where  object_name='CS_INCIDENTS_B_SEC'
and    owner='APPS'
and    object_type!='SYNONYM' 
```

# multithreading - 解释 BEA weblogic 线程转储 - 有用的文档和/或工具？

> ID：781234
> 
> 赞同：3
> 
> 时间：2009-04-23T11:02:03.843
> 
> 标签：multithreading, weblogic, thread-dump

我是 Weblogic 故障排除的新手。

我们的生产环境有问题。我无法直接访问环境（我们的托管人员会这样做，但要等几个小时才能问他们问题）。

从问题在生产中很明显的那一刻起，我就有了一个线程转储。我可以查看转储并推断出一些东西，但鉴于它非常结构化并且人们一直在做一些事情，我假设那里有工具可以帮助解释它们。在那里？

如果做不到这一点，是否有一些有用的文档或网站可以帮助我学习解释它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T14:34:52.040

回答我自己的问题：

[这是一个总结线程转储的简洁工具](https://tda.dev.java.net/)。

[这](http://thread.dumps.googlepages.com/java-thread-dumps)和[这](http://thread.dumps.googlepages.com/java-thread-dumps-2)形成了一篇关于解释线程转储的两部分文章。

不过，我仍然没有找到我们的问题，所以仍在寻找更多。

# c# - 我需要 SQL Server 中的 yyyy-mm-dd hh:mm:ss 在 C# 中变为 yyyy-mm-dd

> ID：781237
> 
> 赞同：2
> 
> 时间：2009-04-23T11:02:20.460
> 
> 标签：c#, sql-server-2005, datetime

你好，

这可能是一个常见的问题。

我在 SQL Server 2005 数据库中有一个日期列 (InvDate)，其值类似于 2009-04-23 00:00:00.000。我正在将其提取到数据集中。现在我只需要将 2009-04-23 存储到一些输出 Excel 表中（我正在使用 OleDB）。我不想要时间，即使它只是 00:00:00.000。

我已经尝试过 CONVERT(varchar(11),InvDate,101) 和 Parse.ToDateExact 和 Convert.ToDate 。

我无法得到正确的步骤。

有任何想法吗 ？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T11:18:04.663

如果您将日期写入 Excel：

```
Excel.Worksheet worksheet;
...
worksheet.Cells(row, column).Value = dateVar.Date; // returns the date part of dateVar
worksheet.Cells(row, column).NumberFormat = @"yyyy-mm-dd"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T11:07:40.790

如果您将数据作为字符串：

DateTime.Parse(yourDataAsAString).ToString("yyyy-MM-dd")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T11:05:23.027

DateTime.Date 是您的答案，这将检索对象的日期部分，即 time = 00:00:00.000

```
 DateTime date = DateTime.Now;
        Console.WriteLine("Date is " + date.Date); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T11:05:31.107

如果您有 DateTime 成员实例，那么您可以调用方法“ToShortDate()”函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T11:06:31.773

如果您的数据集有一个 DateTime，它也将包含 2009-04-23 00:00:00.000。您可以在输出代码中格式化此对象：

date.ToString("yyyy-MM-dd");

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T11:52:49.557

使用 String.Format 根据需要设置日期格式，或使用 DateTime.ToString。

在 SQL 中处理这个比必要的更麻烦。在将 DateTime 值的字符串表示形式转换为 Excel 之前，先在 C# 代码中进行转换。

或者，如果您喜欢冒险，您可以为 Excel 提供 DateTime 值，然后在 Excel 电子表格单元格上添加格式以正确显示该值。这将是最正确的方法，因为该值仍然是日期，对于 Excel 也是如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T11:31:57.063

在您的 SQL 查询中，您可以使用以下语法指定您不想要时间/日期值的时间部分：

```
 SELECT DATE(timedatecolumn) WHERE whatever = whatever 
```

如果您想变得非常花哨，可以使用 DATE_FORMAT 并让它以您喜欢的任何方式输出。例如：

```
SELECT DATE_FORMAT(timedatecolumn, '%W, %M %D, %Y') WHERE blah = blah 
```

将输出（如果日期是今天）：

```
 Thursday, April 23rd, 2009 
```

日期格式的各种选项（在 MySQL 中）位于：

[http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date-format)

此外，请记住 Excel 中的日期值（如果将其格式化为实际日期，而不仅仅是字符串）实际上并不是您在单元格中看到的。它是 Microsoft 日期值（基本上是一些与 Microsoft 逻辑中的日期和时间相关的整数），因此如果您希望 Excel 识别该值并将其视为日期（例如，如果您想运行基于较旧或特定月份的值等）您只需要格式化列以不显示值的时间部分。

如果您想减少时间，因为您不希望标记为在一小时后发生的事件被区别对待，您只需要使用 FLOOR 函数向下舍入该值：

```
FLOOR(somedatecell, 1) 
```

由于值的时间部分始终是值的日期部分之后的小数，这会将其从例如 39926.2725925926（今天上午 6:32:32）向下舍入到仅 39926（今天午夜）。

您仍然必须格式化单元格以摆脱时间部分，但现在所有相等的日期实际上都是相等的，并且不会相差任何小时或分钟。

但是，如果您只想将日期作为字符串，则必须使用 TEXT 函数将日期值转换为文本：

```
 TEXT(somedatecell,"mm/dd/yyyy") 
```

如果您想成为超级肛门（像我一样，但这不是必需的），您可以先将日期值四舍五入到午夜，然后使用以下公式将其转换为文本：

```
 TEXT(FLOOR(somedatecell, 1), "mm/dd/yyyy") 
```

当您说要使用日期格式格式化文本时，Excel 基本上会为您执行此操作，但如果您喜欢更整洁的内容，您可以先向下舍入。

# nhibernate - 休眠标准 API

> ID：781242
> 
> 赞同：1
> 
> 时间：2009-04-23T11:05:11.793
> 
> 标签：nhibernate, criteria

```
SELECT O.*, P.* FROM ORDERS O, PRODUCT P WHERE O.ORDER_ID=P.ORDER_ID; 
```

上述查询的 Criteria 表示形式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T11:12:59.137

如果你有这样的事情：

```
public class Order
{
   public virtual ISet<Product> Products {get;set}
} 
```

你需要做

```
session.CreateCriteria(typeof(Order))    
    .SetFetchMode("Products", FetchMode.Eager)    
    .List(); 
```

而已。

# c++ - 包装第 3 方 DLL

> ID：781246
> 
> 赞同：1
> 
> 时间：2009-04-23T11:06:12.930
> 
> 标签：c++, windows, com, atl

我有一个需要使用 LoadLibrary() 动态加载并使用 __cdecl 调用约定的第 3 方 DLL。我需要能够使用 VB6 中的 dll，所以我创建了自己的包装 DLL，它使用 __stdcall 调用约定并导出所需的函数。

现在已经有一个额外的要求，我正在努力寻找如何管理；包装的 DLL 为另一个应用程序提供了一个 API，我需要同时连接到应用程序的两个实例。这是一个问题，因为 DLL 没有会话的概念，典型的交互如下所示：

```
tpc_connect("service1")
// Do some stuff
tpc_disconnect() 
```

我需要做的是

```
session1 = tpc_connect("service1")
session2 = tpc_connect("service2")
// Do some stuff with session1
// Do some stuff with session2
tpc_disconnect(session1)
tpc_disconnect(session2) 
```

我看到的主要问题是单个进程只能连接到一个服务，所以我尝试的第一个解决方案是通过使用 ATL 创建一个进程外 COM 服务器来将 DLL 包装器移到一个单独的进程中。我现在遇到的问题是我只获得了一个 COM 服务器实例。

所以我的问题（最后）是否有办法强制创建 ATL COM 服务器的新实例？这是解决问题的最佳方法还是有人能想到更好的方法来解决这个问题。

谢谢杰克逊

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T13:12:30.613

我建议您放弃 COM 服务器的想法并使用原始 DLL 的副本。我自己使用这种方法来获取不是线程安全且不支持多个实例的库的多个实例。

由于文件不同，Windows 会将它们全部加载到单独的地址空间中，从而为您将它们分开。

这就是我所做的：

*   向包装器添加函数以创建和销毁库的实例。

*   更改所有其他函数以获取指向它正在使用的库实例的指针。

*   在创建实例函数中，首先尝试使用随机文件名创建到原始 DLL 的硬链接（即使用[CreateHardLink](http://msdn.microsoft.com/en-us/library/aa363860%28VS.85%29.aspx)）。如果失败，则使用随机名称制作 DLL 的真实副本。如果您不想，则不需要使用 DLL 扩展。动态加载 DLL 和函数指针的副本，并返回指向内部结构的指针。

*   在destroy函数中，只需卸载DLL并删除即可。

*   最好在临时目录中创建副本，以便在发生崩溃时很明显可以将其删除，尽管我不确定 Vista 中是否存在限制以及稍后从临时目录加载 DLL。

这一切对我来说都很完美。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T12:17:33.477

如果您只需要 2 个会话，您可以制作原始 dll 的副本并将其命名为其他名称。它们在您的包装器 dll 中导出两个单独的调用（每个 dll 一个）。所以你会有：

```
session1 = tcp_connect("whatever")      'this points to dll1.dll
session2 = tcp_connect2("whatever")     'this points to a copy of dll1 called dll2.dll 
```

这可能取决于其他应用程序的具体情况。无论如何都值得一试。

-大学教师

# asp.net - 我可以在*没有*网络服务的情况下使用 AJAX 自动完成扩展器吗？

> ID：781247
> 
> 赞同：1
> 
> 时间：2009-04-23T11:06:23.507
> 
> 标签：asp.net, vb.net, ajax, autocompleteextender

使用带有 VB 代码隐藏的 ASP.NET 3.5。

我不想使用网络服务在文本框上填充自动完成扩展器。在这种情况下，这是用户输入电子邮件地址的地方，我不想每次都访问数据库。我更愿意将集合保持在会话状态并将自动完成“绑定”到该状态。

是否可以将 ServicePath 和/或 ServiceMethod 设置为代码隐藏中的内容，而不是 web 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-19T23:07:17.953

Yes, ServiceMethod can name a page method. See the documentation for [AutoCompleteExtender](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/autocomplete/autocomplete.aspx). ServicePath as optional, and if ommitted, ServiceMethod is taken to reference a static method of the current ASP.NET page (which must be decorated with 2 specific attributes).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T02:58:41.243

是的。方法如下：[创建简单的自动完成文本框 - ASP.NET Ajax 库](http://www.asp.net/ajaxlibrary/act_AutoComplete_simple.ashx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T11:18:49.077

该特定的自动完成功能需要网络服务。您可能需要考虑使用 jQuery 之类的东西来完成自动完成。我在谷歌上找到[了这个](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)支持本地数组的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T11:33:51.147

您不必使用网络服务本身。（.asmx 或 .svc）

但是您需要某种服务器脚本，.aspx、.ashx 等

您将需要某种数据库。如果需要，您可以在应用程序或会话中保留一些内容。如果是相同的数据，则将其放入应用程序中。

服务器脚本（无论它可能是什么）必须根据他们输入的内容过滤结果。

不过，使用 Web 服务要容易得多，尤其是使用内置的 JSON 序列化程序。

重新阅读您的问题后...

你真的在问缓存。

您可以添加正在运行的任何查询的数据并将其添加到 asp.net 缓存中。

WebService 可以访问与 .aspx 相同的 Cache 对象。

所以缓存它并将它作为 JSON 推出一个 asmx

# wpf - WPF 页面刷新

> ID：781250
> 
> 赞同：1
> 
> 时间：2009-04-23T11:07:08.543
> 
> 标签：wpf, window, refresh

1.如何关闭或取消Button点击中的弹窗？

2.  当我在弹出窗口中更新数据时，同时如何刷新主页中的数据网格。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T11:17:34.103

通过可选地将 DialogResult 设置为 true/false，然后调用 Close() 来关闭弹出窗口。您可以在按钮上设置 IsDefault 或 IsCancel 属性以自动设置结果并关闭。

您需要为您的数据网格问题提供更多信息。

# c++ - 在 MFC 中实现缩放控件

> ID：781256
> 
> 赞同：0
> 
> 时间：2009-04-23T11:08:50.677
> 
> 标签：c++, mfc, scroll, zooming, pixel

我正在开发一个“打印预览”工具，以显示一张幻灯片的概览，上面有矩形阵列的样本点。

载玻片的尺寸通常为 25 x 75 毫米，点样的直径通常为 0.1 毫米。载玻片周边通常有 2 毫米的间隙，没有打印任何点。

点（间距）之间的距离精确到0.01mm。例如，0.20 和 0.29 毫米的间距需要在像素中进行区分。代表斑点本身，100% 的准确性在这个阶段可能并不重要，只要斑点是可见的并且不重叠。

我将不胜感激有关使用哪些技术来创建幻灯片/点的位图表示并使用任意放大倍率查看幻灯片布局的建议。

这不必很复杂 - 1:1 的表示加上越来越大的放大倍率开始。我可能不能缩小太多，因为这些点会变得太小而无法表示。

对于更大的放大倍率，我可能还需要了解如何实现水平/垂直滚动控件，但我稍后会解决这个问题。

我想了解我应该了解的任何编程和缩放技术，以便正确实现缩放工具。我最近一直在使用 StretchBlt 函数来更改图像大小，看起来还可以，但是任何其他相关信息都会很有用。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T11:49:57.897

让我们从头开始：

*   为什么不使用 ::AFXPrintPreview() 和 MFC 的其他打印预览工具？

*   我认为“幻灯片”和“点”特定于您的行业 - 它们与问题相关还是仅用于说明？

*   StretchBlt() 不会对您有多大好处，因为它只会让您进行像素级“缩放”，您需要以更高的精度绘制控件的某个部分。即使你不打算使用 MFC 打印预览的东西，看看它，看看它是如何完成的。

*   Windows 控件具有滚动和缩放所需的所有功能。它们位于设备上下文中：SetWindowExt()、SetViewportExt()、SetViewportOrg() 等。在 MSDN 的“CDC Members”页面的“Coordinate Functions”下查看。话虽如此，我曾经通过跟踪滚动条的位置、控件的缩放命令等方式实现了“手动”缩放和滚动。回首往事，我应该使用 Windows 设施。不过，它们也不容易使用，这就是为什么我认为我自己一开始可以做得更好——结果证明我错了:)

*   最后，虽然我不能从你的问题中确定你是否真的在那条船上，但不要考虑物理距离（毫米等）。您想要做的第一件事是在屏幕上绘制形状，元素之间的比例正确。然后你想放大/缩小。最后，只有当您到达打印部分时，物理测量才会发挥作用。您唯一需要弄清楚的（这里稍微简化一下）是“获得所需输出所需的正确缩放比是多少”。这有点棘手，但与问题的第一部分（如何将组件绘制到屏幕上）几乎没有关系。

如果您遇到问题，请不要犹豫，发布更具体的问题。我在这里有打印预览和打印代码作为打印过程的“通用”部分的示例，尽管每个应用程序的细节明显不同。

# java - 意外的 java SimpleDateFormat 解析异常

> ID：781257
> 
> 赞同：8
> 
> 时间：2009-04-23T11:09:16.497
> 
> 标签：java, datetime, formatting

我不明白为什么这几行

```
 Date submissionT;
    SimpleDateFormat tempDate = new SimpleDateFormat("EEE MMM d HH:mm:ss z yyyy");

    public time_print(String time) {
        try {
          submissionT=tempDate.parse(time);
        }
        catch (Exception e) {     
          System.out.println(e.toString() + ", " + time);
        }

    } 
```

导致异常并打印出来

```
 java.text.ParseException: Unparseable date: "Tue Mar 31 06:09:00 CEST 2009", Tue Mar 31 06:09:00 CEST 2009 
```

...虽然“不可解析”时间符合我传递给 SimpleDateFormat() 的格式字符串。有什么想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T11:33:50.163

这是一个语言环境问题。采用：

```
sdf = SimpleDateFormat("EEE MMM d HH:mm:ss z yyyy", Locale.US); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-23T11:13:56.517

**为我工作。**

```
public class Main {

public static void main(String[] args)
{
    time_print("Tue Mar 31 06:09:00 CEST 2009");
}

static Date submissionT;
static SimpleDateFormat tempDate = new SimpleDateFormat("EEE MMM d HH:mm:ss z yyyy");

public static void time_print(String time) {
    try {
      submissionT=tempDate.parse(time);
      System.out.println(submissionT);
    }
    catch (Exception e) {
      System.out.println(e.toString() + ", " + time);
    }

} 
```

}

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-23T12:05:51.867

您格式中的“z”代表时区，Java 仅识别某些时区 ID。您可以从 TimeZone 类中获取列表作为字符串数组。CEST 没有出现在我刚刚从 JDK 1.5 生成的列表中

```
String[] aZones = TimeZone.getAvailableIDs();
    for (int i = 0; i < aZones.length; i++) {
        String string = aZones[i];
        System.out.println(string);
    } 
```

希望这可以帮助。

# java - 如何在索尼立信中隐藏 midlet 图标

> ID：781268
> 
> 赞同：1
> 
> 时间：2009-04-23T11:14:01.740
> 
> 标签：java, java-me, midp

帮助我解决您在[此处所述的问题](https://stackoverflow.com/questions/481723/is-there-a-method-to-change-a-midlet-icon-once-its-downloaded)

“一些较新的索尼爱立信手机（从 JP8.3 平台开始）具有专有的 Java 应用程序管理 API，只有在您的 MIDlet 由索尼爱立信签名时才能访问该 API，以及允许您隐藏 MIDlet 图标的 jad 属性来自用户。”

我在 j2me 中开发了一个应用程序，我想检查是否可以隐藏它的图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T09:51:39.627

要对用户隐藏您的应用程序，请将以下应用程序属性添加到您的 .jad 文件中：

SEMC-MIDlet-Hidden: Y
SEMC-ShowInActivityMenu: false
SEMC-SuppressJavaIcon: Y

如果您的 MIDlet 没有由 Sony-Ericsson 信任的证书签名，这可能不起作用。

这些应用程序属性是您隐藏已安装应用程序所需的全部。

索尼爱立信应用管理系统API不公开。您需要让 SonyEricson 向您发送您想要定位的手机的 JavaDoc 和二进制库。

据我所知，它不允许您在安装后隐藏应用程序。但是您可以使用它来卸载或启动应用程序或隐藏安装过程（静默安装）。

# sql-server - 有人用过 CozyRoc SSIS+ 吗？

> ID：781272
> 
> 赞同：1
> 
> 时间：2009-04-23T11:15:18.213
> 
> 标签：sql-server, ssis, etl

我为一家大型加拿大零售商工作，我们目前正在考虑将 CozyRoc 用于我们的大型 ETL 项目。我想知道是否有人可以推荐该软件，最好是通过电子邮件链或电话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:05:57.807

我们在生产平台上使用 CozyRoc，已经使用了大约 18 个月。

您可能会发现直接联系 CozyRoc 是有益的。他们拥有相当广泛的客户群，并且能够让您与使用您感兴趣的特定功能的企业取得联系。

# java - 如何实现 JSR 规范

> ID：781274
> 
> 赞同：8
> 
> 时间：2009-04-23T11:15:38.197
> 
> 标签：java, specifications, portlet, jsr168, jsr

我正在考虑实现一两个 JSR API。我还没有阅读整个规范（计划是在编写实现代码时阅读它们）但我对它们非常熟悉。我读过 JSR 过程包括实现一个测试兼容性工具包 (TCK) 来测试所述 JSR 实现。

在我开始编写一堆单元测试来验证我的实现的正确性/完整性之前，我真的很想使用这个 TCK，但我不知道它是否可供我使用。下载所有文件并四处搜索后，我找不到任何可以定义为给定 JSR 的 TCK 的内容。

所以我的问题基本上是：为了生成我自己的 JSR 规范实现，我需要执行哪些步骤，以及如何验证我确实已经这样做了。

对于它的价值，我正在考虑实施 JSR-168 和 JSR-286，但我认为这与这个问题无关。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T11:28:26.853

您可能需要做的是联系给定 JSR 的规范负责人。他们可以为您提供有关获得 TCK 的更多信息。

您可能需要支付许可证才能访问 TCK。当然，对于 Java SE 规范，Sun 确实对 TCK 收取许可费，除非您有资格作为非营利组织免费接收它。

也就是说，我相信它因 JSR 而异，所以正如我上面所说，最好的办法是联系 JSR 规范负责人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T11:40:37.137

哇，这是一个非常雄心勃勃的项目，通常由公司或大型开源团队接管。如果你有足够的决心去做，我建议你看看一些开源实现。提到的 JSR 由[Pluto](http://portals.apache.org/pluto/)实现。可能值得看看源代码分发。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-06T14:35:42.883

对于我将要介绍的最坏情况，我深表歉意。

由于之前已经这样做了好几次，我强烈建议在您不仅阅读规范而且阅读 JSR 专家组的任何类型的电子邮件存档之前不要编写任何代码。

JSR 规范通常充满歧义，可以用多种不同的方式来解释。以一种非常有条理的方式浏览它会让您在专家组解散并变得没有反应之前尽快向专家组提出相关问题，希望如此。

TCK 通常是一组测试，不能确保您的实现即使在远程也能正常工作，它只是说您是规范的合法实现。

TCK 通常对一个人来说太贵了，无法购买。

显然，实现 JSR 的方式将取决于您所针对的操作系统和虚拟机。更好的 JSR 通常是可以用纯 Java 实现的。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T11:22:51.423

如果已经有一个有效的实现，你为什么要实现一个规范？似乎做了很多不必要的工作而没有什么好处......

# windows - Windows 页面错误监视器

> ID：781285
> 
> 赞同：1
> 
> 时间：2009-04-23T11:20:55.250
> 
> 标签：windows, profiling

是否有任何工具在运行时显示每个线程的页面错误增量？基本上我有一个导致大量页面错误的应用程序，我想确定导致最大值的线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T11:31:57.190

我真的怀疑您是否可以确定页面错误以线程处理页面错误而不是线程。当然，尽管它将成为 CPU 方面最繁忙的线程，或者可能是您想要查看的上下文切换。

我使用[进程资源](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)管理器进行这种诊断。打开应用程序的属性并选择线程选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T11:47:52.190

使用[Xperf](http://msdn.microsoft.com/en-us/library/cc305210.aspx)。它聚合 ETW 事件并让您深入了解哪个进程/线程/函数负责大多数 cpu/memalloc/diskops/faults 等。

# java - 实时解析大型文本文件 (Java)

> ID：781293
> 
> 赞同：7
> 
> 时间：2009-04-23T11:23:26.850
> 
> 标签：java, regex, parsing

我有兴趣在 Java (1.6.x) 中解析一个相当大的文本文件，并且想知道哪种方法被认为是最佳实践？

该文件的大小可能约为 1Mb，并且将包含数千个条目：

```
Entry
{
    property1=value1
    property2=value2
    ...
} 
```

等等

我的第一直觉是使用正则表达式，但我之前没有在生产环境中使用 Java 的经验，因此不确定 java.util.regex 类的功能有多强大。

澄清一下，我的应用程序将是一个 Web 应用程序 (JSP)，它解析有问题的文件并显示它检索到的各种值。只有一个文件被解析（它位于主机上的第 3 方目录中）。

该应用程序的使用率将相当低（可能只有少数用户每天使用几次），但至关重要的是，当他们使用它时，尽快检索信息。

此外，每次解析文件时是否有任何预防措施可以将文件加载到内存中？

谁能推荐一种在这里采取的方法？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T12:59:06.747

如果它大约为 1MB，并且按照您所说的格式，那么听起来您正在过度设计事物。

除非您的服务器是 ZX Spectrum 之类的，否则只需使用正则表达式对其进行解析，将数据放入哈希映射中（并将其保留在那里），不用担心。它会占用几兆字节的内存，但那又怎样......？

**更新：**只是为了让您对性能有一个具体的了解，我[对 String.split()](http://www.javamex.com/tutorials/regular_expressions/splitting_tokenisation_performance.shtml)（使用正则表达式）的性能进行的一些测量表明，在 2GHz 机器上，**拆分 10,000 个 100 个字符的字符串需要几毫秒**（在换句话说，大约 1 兆字节的数据——实际上接近 2MB 的纯字节量，因为字符串是每个字符 2 个字节）。显然，这不是你正在执行的操作，但你明白我的意思：事情并没有那么糟糕......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T11:26:33.333

如果它是正确的语法，请使用解析器构建器，例如[GOLD Parsing System](http://www.devincook.com/)。这允许您指定格式并使用高效的解析器来获取您需要的令牌，几乎免费获得错误处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T11:26:46.377

我想知道为什么这不在 XML 中，然后您可以利用可用的 XML 工具。我特别想到了 SAX，在这种情况下，您可以轻松地解析/处理它，而无需将其全部保存在内存中。

那么你能把它转换成 XML 吗？

如果你不能，并且你需要一个解析器，那么看看[JavaCC](https://javacc.dev.java.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T11:33:28.340

使用 Scanner 类并一次处理一行文件。我不确定你为什么提到正则表达式。正则表达式几乎从来都不是任何解析问题的正确答案，因为对于在什么上下文中发生的事情存在歧义和缺乏语义控制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T11:47:26.187

您可以使用[Antlr](http://www.antlr.org/)解析器生成器来构建能够解析文件的解析器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T12:03:27.630

没有回答有关解析的问题……但是您可以解析文件并在新文件到达后立即生成静态页面。所以你不会有性能问题......（我认为1Mb不是一个大文件，所以你可以将它加载到内存中，只要你不同时加载太多文件......）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T12:25:51.867

这似乎是一种足够简单的文件格式，因此您可以考虑使用[Recursive Descent Parser](http://en.wikipedia.org/wiki/Recursive_descent_parser)。与 JavaCC 和 Antlr 相比，它的优点是您可以编写一些简单的方法，获取您需要的数据，并且您无需学习解析器生成器形式主义。它的缺点 - 它可能效率较低。递归下降解析器原则上比正则表达式更强。如果您能为这种文件类型想出一个语法，它将为您提供任何您选择的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T13:23:17.843

如果这是您想知道的 Java 正则表达式的限制，请不要担心。假设您在制作正则表达式方面相当有能力，那么性能应该不是问题。功能集也非常丰富——包括我最喜欢的[所有格量词](http://www.regular-expressions.info/possessive.html)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-23T14:26:20.407

另一种解决方案是进行某种形式的预处理（离线完成，或作为 cron 作业），这会产生非常优化的数据结构，然后用于服务许多 Web 请求（无需重新解析文件）。

但是，看看有问题的场景，似乎不需要。

# asp.net - 在 asp.net 中需要作业调度程序

> ID：781300
> 
> 赞同：6
> 
> 时间：2009-04-23T11:25:49.450
> 
> 标签：asp.net, sql-server, job-scheduling

我们有一个网站，我们需要一个调度程序在特定时间接收通知（电子邮件）。例如。一个人在下午 5 点设置提醒以在下午 4:45 参加会议，将在下午 4:45 收到大致相同的电子邮件。

由于该站点托管在共享服务器上，因此我们无法控制服务器来运行任何 SQL 作业或调度程序应用程序。

asp.net 中有什么可以在这种情况下提供帮助的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T11:41:46.743

怎么样：[使用 ASP.NET 模拟 Windows 服务以运行计划作业](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx)。

有一次，这种技术被[用在 Stack Overflow 上](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet)，尽管我认为它不再是了。

老实说，这对我来说似乎是一个令人讨厌的、容易出错的 hack，但是如果您无法在服务器上运行除您的网站之外的任何东西，那么这样的东西可能是您唯一的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T11:47:29.570

您需要在服务器上完成一项工作，但是您没有从 ASP.NET 触发它的好方法？

如何创建一个网页来启动您的工作，并在请求该页面的其他地方（即在另一台计算机上）运行计时器。（只需点击页面即可触发您的工作）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T11:52:27.343

我遇到了和你一样的问题，最后我编写了一个使用 Quartz.NET 的服务：http://quartznet.sourceforge.net/[并](http://quartznet.sourceforge.net/)连接到与网站相同的数据库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T11:32:28.110

使用 ASP.NET，您不能保证您的应用程序始终处于活动状态，因此 Web 应用程序作为调度解决方案的主机进程在 IMO 中是不可行的。

在这种情况下，您需要一个 Windows 服务。您可以完全控制启动和停止进程以及监控应用程序的方式。

你能在不同的机器上托管这样的服务吗？即使 Web 应用程序在托管服务器上运行并不意味着您必须在同一台服务器上运行调度程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T11:36:15.603

如果您真的无法控制服务器（也就是说，您不能使用 sql 作业、计划任务或安装 Windows 服务器），那么您可以使用您在 Global.asax 中初始化的[System.Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx) （例如，在应用程序启动时）每 x 分钟调用一次应用程序中的某个方法。然后，此方法将查询您的数据库并查看需要发送哪些通知。

不过，这确实不是一种理想的方法，因为据我所知，定时器不能保证总是调用，因为就像 Peter 所说的那样，不能保证您的 Web 应用程序始终处于活动状态。

但是，根据您的要求，如果您没有其他选择，它仍然是一种“足够好”的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T11:36:49.737

但是，如果您真的完全陷入困境并且别无选择，只能将其托管在您的 WebApp 中，

您可以查看在`System.Timers.Timer`Global.asax.cs 文件中创建一个实例。像往常一样连接一个 Elapsed 事件，并给它一些代码来做一些事情

```
protected void myTimer_Elapsed(object sender, EventArgs e)
{
    if(System.DateTime.Now Falls in Some Configured Time-Window)
        //Do Stuff
} 
```

但正如有人指出的那样，它不能保证，因为 IIS 可能会在此期间重置，在这种情况下你会错过它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T11:42:31.267

这确实是不可取的，但你可以按照 Razzie 的建议去做。我已经看过很多次了。虽然丑陋，但有时你只需要做丑陋的黑客。

但是，使用这种方法，您必须确保您的应用程序没有被卸载。所以你需要某种方式来维持生命。我建议设置一个 Web 监控工具，该工具将不断拉动页面 (aspx) 以保持应用程序处于活动状态。这些家伙是免费的[http://mon.itor.us/](http://mon.itor.us/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-20T00:02:05.600

> 我不相信你，因为 Quartz.Net（1.0 和 1.0.1）的源代码不能在 Visual Studio.Net 2005 和 2008 下编译。获得 Quartz.Net 的唯一方法是使用整个 Spring.Net 包，在 VS.Net 2005 和 2008 下编译得很好
> 
> 除非你能分享一些技巧，否则如何在 asp.net 项目中编译和使用quartz.dll！（Quartz.Net 和 readme.txt 的网页没有提供任何关于源代码编译的信息） 欢迎大家提出建议！

一开始我也遇到了麻烦，但这是因为必要的 AsemblyInfo.cs 包含在父文件夹中。此外，您需要添加包含的三个 DLL。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-07-16T13:23:24.637

我不相信你，因为 Quartz.Net（1.0 和 1.0.1）的源代码不能在 Visual Studio.Net 2005 和 2008 下编译。获得 Quartz.Net 的唯一方法是使用整个 Spring.Net 包，在 VS.Net 2005 和 2008 下编译得很好

除非你能分享一些技巧，否则如何在 asp.net 项目中编译和使用quartz.dll！（Quartz.Net 和 readme.txt 的网页没有提供任何关于源代码编译的信息） 欢迎大家提出建议！

# ruby-on-rails - 使用 find_by_sql 删除记录

> ID：781308
> 
> 赞同：1
> 
> 时间：2009-04-23T11:28:30.677
> 
> 标签：ruby-on-rails

我正在尝试从表“abc”中删除几条记录，其中 id 是从“xyz”表中获取的

SQL：

```
delete from abc where id in (select ids from xyz where i= 10) 
```

我想使用 find_by_sql 执行此查询，以避免多次命中数据库。

它给出错误。请帮助我在对 DB 的一次点击中完成此删除操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:59:59.793

我不认为`find_by_sql`是你想要的方法。

如果你有

```
class Abc < ActiveRecord::Base
end 
```

（所以 abc.rb 是你的模型）那么我认为你应该能够做这样的事情：

```
Abc.connection.execute('delete from abc where id in (select ids from xyz where i= 10)') 
```

# asp.net-mvc - ASP.NET MVC 函数调用

> ID：781309
> 
> 赞同：0
> 
> 时间：2009-04-23T11:28:36.993
> 
> 标签：asp.net-mvc

我有一个母版页，其中有一个名为 的函数`GetSiteMap()`，该函数用于根据当前位置自定义呈现站点地图。我的问题是，在 MVC 中你没有模型背后的代码，因此没有公开那种功能。

正确的方法是什么？我是否应该拥有某种类型的母版页控制器，其中定义了该功能？

```
Public Function GetSitemap() As String
    Dim s As New SiteNavigation
    Dim siteMapNodeCollection As SiteMapNodeCollection

    If Not SiteMap.CurrentNode.Equals(SiteMap.RootNode) Then
      If Not SiteMap.CurrentNode.HasChildNodes Then
        ' otherwise it'll go to the pseudo-current directory, which is wrong
        Dim parentNode As SiteMapNode = SiteMap.CurrentNode.ParentNode.ParentNode
        s.AddBackLink(parentNode.Url, parentNode.Title)
      Else
        Dim parentNode As SiteMapNode = SiteMap.CurrentNode.ParentNode
        s.AddBackLink(parentNode.Url, parentNode.Title)
      End If
    End If

    If Not SiteMap.CurrentNode.HasChildNodes Then
      siteMapNodeCollection = SiteMap.CurrentNode.ParentNode.ChildNodes
    Else
      siteMapNodeCollection = SiteMap.CurrentNode.ChildNodes
    End If

    For Each siteMapNode As SiteMapNode In siteMapNodeCollection
      GenerateLinks(siteMapNode, s)
    Next

    Return s.GetSiteNavigation()
  End Function

  Private Sub GenerateLinks(ByRef siteMapNode As SiteMapNode, ByRef siteNavigation As SiteNavigation)
    If siteMapNode.Url.Length = 0 And siteMapNode.Description = "separator" Then
      siteNavigation.AddSeparator()
    ElseIf siteMapNode.Url.Length = 0 And siteMapNode.Description = "heading" Then
      siteNavigation.AddHeading(siteMapNode.Title)
    Else
      siteNavigation.AddLink(siteMapNode.Url, siteMapNode.Description, siteMapNode.Title, siteMapNode.HasChildNodes)
    End If
  End Sub 
```

对不起，这就是我的意思。前几天我写得很快，所以它并不完美，但现在它可以完成这项工作。我正在使用站点地图并为某些元素不提供 URL，而是提供诸如“分隔符”之类的描述，以指示该`<li>`元素以不同的方式呈现（将不同的类应用于此 HTML 元素）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T12:01:57.180

由于站点地图可以根据用户的位置进行定制，我将假设您正在讨论生成用户界面元素，而不是搜索引擎映射。为搜索引擎消费生成站点地图可能最好离线完成并定期更新。

要生成用户界面，我会考虑使用 ViewUserControl 并将其呈现为您需要的任何页面的一部分。ViewUserControl 将使创建和维护与其关联的标记变得更加容易。它也可用于需要它的任何视图（并且可以包含在您的 MasterPage 中）。正如@Marc Gravell 建议的那样，它的数据可以使用 ActionFilter 生成。但是，如果控件无处不在，那么创建一个基本控制器可能是最简单的，您的控制器可以从中派生和覆盖基本控制器中的 OnActionExecuted。您可以检测何时生成了 ViewResult，然后创建并分配给 ViewData 站点地图控件的数据。

基本控制器：

```
public override OnActionExecuted( ActionExecutedContext filterContext )
{
     if (filterContext != null && filterContext.Result is ViewResult)
     {
         ViewData["siteMap"] = this.GetSiteMap();
     }
} 
```

母版页/视图

```
<% Html.RenderPartial( "SiteMap", ViewData["siteMap"], ViewData ) %> 
```

查看用户控件

```
 foreach (var elem in Model)
 {
    .... render your HTML
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T11:40:37.980

这取决于它的作用；如果它只是检查请求，那么您可以编写（例如）扩展方法`HtmlHelper`并从视图中编写它；

```
<%=Html.GetSiteMap()%> 
```

另一种选择是将其推送到母版页中。如果您需要进行数据库查询等，您可能会考虑使用“操作过滤器”来完成一半的工作（准备数据），然后（如上）`HtmlHelper`在视图中调用以显示它。有什么用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:29:18.903

> My problem is that in MVC you don't have the code behind model thus not exposing that kind of functionality

That's not true. aspx + code behind was the default implementation until few releases ago. Currently the **default template** make no use of code behind but is builtin in the runtime.

In MVC the Controller should create the Model of your sitemap and the View (maybe an usercontrol) has the only responsibility to render it.

Maybe this can help [http://mvcsitemap.codeplex.com/](http://mvcsitemap.codeplex.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T12:01:20.380

MVC 确实有强类型视图。从您的标记中，您可以访问您的模型以确定基本上替换代码隐藏逻辑的位置：

```
<%= Html.Encode(ViewData.Model.GetSiteMap()) %> 
```

这将呈现适当的站点地图。您的模型可以是一个“主演示”类，它公开页面常用的不同方法。

我想这类似于 Marc 提出的解决方案。

# vb.net - VB.net 引发事件...混乱！MVC

> ID：781311
> 
> 赞同：1
> 
> 时间：2009-04-23T11:29:18.897
> 
> 标签：vb.net, model-view-controller, events

我是 MVC 和 Business Objects 的新手，但我很难理解如何在我的业务逻辑中发生更新时触发表单的刷新。

对于我 95% 的表单来说，这不是问题，因为他们从需要更新的表单中调用更新。

但是，在某些情况下，内部形式会进行更新，并且需要外部形式来反映这一点。我已经阅读了有关 Handles、Delegates、AddressOf 等的信息，但我正沉浸在选项中。

简单来说，我需要发生三件事 1\. Form2（内部表单）有更新的信息，所以用户点击 Save 2\. Save 调用我的数据访问层并更新数据库 3\. Form1（外部表单）有一个 DataGrid 需要收到通知，以便它可以通过 Sub LoadGrid 更新

这是第3阶段，我做不到。如何触发 Form2 (LoadGrid) 中的 Sub 从外部类进行刷新。如果我能让这个工作，我相信我会在其他场景中学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T11:39:00.137

我不是 100% 确定 MVC 这样做的方式，但我已经取得了类似的成就。

在我的业务层类

```
Class BL
public event doneUpdate(o as object, e as eventArgs)

sub method doDBUpdate()

'do your stuff

RaiseEvent doneUpdate(o,e) 
end sub

End Class

Class Form
dim withEvents bl as BL

sub g handles bl.doneUpdate(o as object , e as eventargs)
  'rebind
end sub 

End Class 
```

现在，在表单的代码隐藏中，您可以使用重新绑定数据网格的 Sub 来处理此事件。

顺便说一句，我将事件冒泡到 UI 作用于的控制器，而不是直接发送到业务层。

希望这可以帮助

编辑：

嗨米奇

从事件传递给处理程序的参数可以是任何参数，尽管 Microsoft 编码约定说您应该将对象和事件参数传回。

如果您这样声明您的活动

```
Public Event myEvent(dim updated as Boolean) 
```

然后让手柄子具有相同的签名

```
Public Sub handler(byval updated as Boolean) handles myClass.myEvent 
```

然后你应该能够更新的值（这只是一个例子）

您可能要检查的唯一一件事是您正在实例化您的 Business Class，就像使用事件一样

```
Dim WithEvents myBL as new BusinessLayer 
```

如果这仍然无法工作（如果这在 WinForms 而不是 asp.net 中）你可能需要说类似

```
AddHandler myBl.myEvent AddressOf handler 
```

希望这可以帮助

# c# - 反射权限异常

> ID：781312
> 
> 赞同：2
> 
> 时间：2009-04-23T11:30:13.840
> 
> 标签：c#, wpf, security, reflection, mvvm

我目前正在开发一个使用 WPF 和 MVVM 的应用程序。现在，如果我转到另一个用户的机器并尝试启动我的应用程序，由于 `BindToMethodInfo(Object, RuntimeMethodHandle, RuntimeTypeHandle, DelegateBindingFlags)`mscorlib 中缺少 ReflectionPermission，我会收到一个异常。

现在我的问题是，除了访问私有/受保护的属性之外，究竟需要 ReflectionPermission 是什么？我绑定的属性都是公共的，并且 ViewModel 以及它使用的类与绑定到它的窗口在同一个程序集中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T11:39:31.087

通过完全信任尝试使用 ClickOnce 部署应用程序。

微软之所以提出 DependencyProperties 和其他此类概念是为了避免使用反射，因为它需要此权限。但是，您可以创建一个需要管理权限才能运行程序的清单，或者使用 clickonce 进行部署应该会有所帮助。

# cocoa - 在可可中将 NSTimeInterval 添加到 NSDate

> ID：781313
> 
> 赞同：21
> 
> 时间：2009-04-23T11:30:28.097
> 
> 标签：cocoa, time, sum, nsdate

我有一个`NSDate`代表特定时间的。该日期的格式是 hhmmss。我想`NSInterval`为该时间值添加一个值（以秒为单位）。

例子：

```
NSDate =         123000
NSTimeInterval = 3600

Added together = 133000 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-23T11:58:43.617

你看过[Cocoa 的 Dates and Times Programming Topics](http://developer.apple.com/documentation/Cocoa/Conceptual/DatesAndTimes/Articles/dtDates.html#//apple_ref/doc/uid/20000183)手册吗？

基本上你需要将你的时间转换成一个 NSDate。要将字符串转换为日期，请使用`NSDateFormatter`该类，或者`NSDateComponents`如果您已经知道小时、分钟和秒。

你`NSTimeInterval`只是一个双倍（即3600.0）。

然后你使用`dateByAddingTimeInterval`NSDate 的方法将秒数加到时间上。

```
NSDate* newDate = [oldDate dateByAddingTimeInterval:3600.0]; 
```

然后，您可以使用`NSDateFormatter`或`NSDateComponents`重新获得新的时间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-01-07T14:25:02.730

addTimeInterval 现在已弃用。尝试改用[dateByAddingTimeInterval](http://developer.apple.com/library/mac/#documentation/cocoa/reference/foundation/Classes/NSDate_Class/Reference/Reference.html%23//apple_ref/occ/instm/NSDate/dateByAddingTimeInterval%3a)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-26T07:52:34.257

```
// This will set the time when your view appears it will also
// set the time if you want to retrieve from it.
-(void)viewDidAppear:(BOOL)animated
{
     //Create todays date
     NSDate *duedate = [NSDate date];
     //Add how ever many days you could write 86400*numbe_of_days days 86400/24 for an hour
     //Then simply reassign the variable or use a different one.
     duedate = [duedate dateByAddingTimeInterval:86400];  //I add one day
     [datePicker setDate:duedate animated:YES]; //Animate yes will show your pickers moving
     [datePicker setMinimumDate:duedate]; //Set minimum date.
} 
```

# sql - sql查询有问题。我应该使用工会吗？

> ID：781318
> 
> 赞同：2
> 
> 时间：2009-04-23T11:32:28.780
> 
> 标签：sql, mysql

有一个在纸上看起来很容易的问题，但我在弄清楚如何最好地编写单个查询时遇到了一个大问题。

我有一张桌子

```
创建表`profile_values`（  
  `fid` int(10) unsigned NOT NULL default '0',  
  `uid` int(10) unsigned NOT NULL default '0',  
  `值`文本，  
  主键（`uid`，`fid`），  
  键`fid`（`fid`）  
)

```

该表的重点是存储用户的个人资料信息。
例如，通常的行看起来像这样..

```
确定 | uid | 价值  
__________________
1 | 77 | 玛丽  
11 | 77 | 波平斯  
1 | 123 | 史蒂夫  
11 | 123 | 戴维斯  

```

笔记：

```
'1' 的 'fid' 代表名字  
'11' 的 'fid' 代表姓氏  
“uid”是站点内的用户 ID。  

```

我想要实现的是带回所有满足“S％”等名字和“D％”等姓氏条件的uid。
我需要这个的原因是因为我有一个用于网站用户的自动完成搜索框。
因此，如果我在搜索框中输入“S”，我将看到以字母“S”开头的所有用户列表，如果我现在输入空格和“D”，我现在应该能够看到匹配的用户列表两种条件。

有谁知道如何做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T11:36:56.507

```
select firstname.uid, fistname.value, lastname.value
from 
  profile_values firstname
  inner join profile_values lastname 
    on firstname.uid = lastname.uid
WHERE
  firstname.fid = 1
  AND lastname.fid = 11
  AND fistname.value like 'S%'
  AND lastname.value like 'D%' 
```

或者，使用用户表

```
select users.uid, fistname.value, lastname.value
from 
  users
  inner join profile_values firstname
    on firstname.uid = users.uid
    AND firstname.fid = 1   
  inner join profile_values lastname 
    on lastname.uid = users.uid
    AND lastname.fid = 11
WHERE
  fistname.value like 'S%'
  AND lastname.value like 'D%' 
```

编辑：

忘了提一下：联合在许多 dbms 上表现不佳。如果您需要联合，那么您的数据库模型大多有问题。在使用 union 之前使用任何其他替代方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T11:49:02.983

您展示的表格看起来像是[内部平台效应](http://en.wikipedia.org/wiki/Inner-Platform_Effect)反模式的经典示例。

因此，与其在短期内回答您的问题（已经完成），我会回答，从长远来看，您的目标可能应该是更改数据库，以便将名字和姓氏存储在各自的列中。然后可以将它们编入索引，因此这种类型的搜索会更快，并且它们会更容易使用，因为您可以直接使用列名。

您使用数字来指代存储在列中的数据类型这一事实表明实际使用的数据类型有限，这意味着它们可以分成单独的列（如果空间是一个问题并且很多值为空，那么您可以使用稀疏列）。

那么您的查询将类似于：

```
select * from users where first_name like 's%' and last_name like 'd%' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T11:39:01.963

```
SELECT  *
FROM    profile_values pv1
WHERE   pv1.fid = 1
        AND pv1.value LIKE 'M%'
JOIN    profile_values pv11
ON      pv11.fid = 11
        AND pv11.value LIKE 'D%'
        AND pv11.uid = pv1.id 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T11:40:21.023

像这样加入 profile_values*两次*：

```
SELECT p1.uid
FROM profile_values p1, profile_values p2
WHERE p1.uid=p2.uid AND p1.fid=1 AND p2.fid=11
  AND p1.value LIKE 'S%'
  AND p2.value LIKE 'D%' 
```

# iphone - UITransitionView 和 UILayoutContainerView

> ID：781342
> 
> 赞同：30
> 
> 时间：2009-04-23T11:40:01.943
> 
> 标签：iphone

1.  是什么`UITransitionView`？
2.  是什么`UILayoutContainerView`？
3.  我会因为向它们添加子视图而遇到麻烦吗？

它们是 a `UITableView`which is inside a `UINavigationController`which is inside a 的超级视图`UITabBarController`。

`UITransitionView`我是通过询问表格视图的超级视图来获得的。 `UILayoutContainerView`我是通过询问`UITransitionView`.

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-23T13:49:16.190

它们都是 Apple 使用的内部视图，并未在 SDK 中发布。

很难确切地说 Apple 会做什么或不会做什么，但是，将视图添加到您从 superView 消息中检索到的未记录视图中并不存在争议。你不应该做的（或者如果你这样做要小心）是对你正在添加的视图做出假设。特别是它的类，甚至是基本的东西，比如它甚至存在的事实。

你想做什么？可能有一种更简单的方法——比如将您的视图直接添加到应用程序的 UIWindow。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T17:07:15.873

直接对这些视图执行任何操作都违反了不使用未记录 API 的 SDK 准则。所以，可悲的是，他们做什么并不重要。

# ruby-on-rails - 无法修改冻结的字符串

> ID：781350
> 
> 赞同：2
> 
> 时间：2009-04-23T11:42:11.220
> 
> 标签：ruby-on-rails

我在从中获得的视图中使用以下代码

[http://www.igvita.com/2006/10/20/adding-social-bookmarks-in-rails/](http://www.igvita.com/2006/10/20/adding-social-bookmarks-in-rails/)

[这是粘贴代码](http://pastie.org/455683)

但我收到以下错误：

```
TypeError in Pages#show
Showing app/views/pages/show.html.erb where line #26 raised:
can’t modify frozen string
Extracted source (around line #26):
23: Twitter
24: Facebook
25:
26: <% current_uri = u(request.protocol << request.host_with_port << request.request_uri)
27: title = u(@title)
28:
29: bookmarklets = {
============ 
```

当我用这个替换

```
current_uri = u(request.protocol << request.host_with_port << request.request_uri) 
```

冻结的字符串错误消失了，但未解析链接。即链接呈现如下：

```
http://digg.com/submit?phase=2&url={{url}}&title={{url_encoded_title}} 
```

好吧，我在文章的评论中问了，但没有得到任何答复。所以，我在这里问。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T20:56:18.070

在您的评论中，您说您有一个名为 title 的辅助方法。这可能会导致与 title 变量的名称冲突。

将您的标题变量重命名为`page_title`. 在顶部、站点列表之前和底部（生成链接的位置）更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-06T13:43:38.213

或者......为什么你需要使用“<<”为什么不只是“+”。可能是 << 正在尝试将 host_with_port 添加到保存协议字符串的数组中（即，它正在修改名为“protocol”的冻结字符串，而不是将两者加在一起）并且与 request_uri 字符串相同host_with_port。

只需使用 + 进行连接，他们将停止尝试修改字符串，并在通过 u() 之前将它们添加在一起，例如：

```
current_uri = u(request.protocol + request.host_with_port + request.request_uri) 
```

# flash - Flash Pdf 查看器就像 scribd

> ID：781352
> 
> 赞同：13
> 
> 时间：2009-04-23T11:42:27.180
> 
> 标签：flash

是否有任何免费的 Flash pdf 查看器，以便我可以将其嵌入到我的 asp 页面中，我尝试搜索谷歌，但一切都是徒劳的。[嵌入式 PDF 查看器也可以工作]

提前致谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-01-09T21:12:36.113

**柔性纸**——http: [//flexpaper.devaldi.com/](http://flexpaper.devaldi.com/)

截至 2011 年 6 月 29 日，有一个带有徽标的 GPLv3 版本和一个商业版本。它可以独立运行，也可以作为 SWC 库下载以嵌入到您自己的 Flex 应用程序中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T12:28:11.953

**Scribd**有自己的专有 Flash PDF 查看器，称为**iPaper**。Adobe 的商业产品称为[FlashPaper](http://www.adobe.com/products/flashpaper/)。没有免费的替代品。因此嵌入是您最接近的选择。

嵌入标签非常简单：

```
<embed src="MyPdfDocument.pdf" width="500" height="375" /> 
```

这是一个外观[示例](http://blogs.adobe.com/pdfdevjunkie/2007/08/using_the_html_embed_tag_to_di.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-25T19:55:15.153

www.embedit.in 呢？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-08T08:36:46.973

我知道这有点晚了，但这对通过搜索来到这里的人很有用。ZViewer是一个基于swftools的pdf文件查看器：http: [//swfviewer.blogspot.com/](http://swfviewer.blogspot.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-24T13:34:57.283

我有[http://issuu.com/](http://issuu.com/)看起来只是你所追求的门票

最好的功能（对于我的项目）是它一次加载 5 页 PDF，因此让 Flash 阅读器尝试显示 30Mb 200 页 PDF 并不意味着带宽负载

# iis-7 - 如何设置我的 IIS 以使我的应用程序保持活动状态？

> ID：781357
> 
> 赞同：23
> 
> 时间：2009-04-23T11:44:56.597
> 
> 标签：iis-7

我认为我的 Web 应用程序会在一段时间后关闭。

如果我在 5 分钟内没有使用该应用程序，它会返回一个新会话。会话超时设置为 720 分钟，因此这不是问题。

它可能是应用程序池中的设置还是类似的设置？我认为这是某种资源管理。我使用 IIS 7.0

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-09-05T18:42:35.703

IIS 在属性中有一项功能，您可以在其中停止定期回收 IIS

1.  转到您的“IIS 管理器”
2.  选择您要管理的实例的“应用程序池”。
3.  选择“高级设置”操作
4.  在“Recycling”下，将“Regular Time Interval”设置为0，表示应用程序池不回收。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-01-19T08:21:15.420

1.  打开“IIS管理器”
2.  选择“应用程序池”您要管理的实例
3.  选择“高级设置”
4.  在“（常规）”下，将“启动模式”设置为“始终运行”，这意味着应用程序池保持 ASP.NET 应用程序始终运行

PS。如果您希望自动加载 ASP.NET 应用程序，您可以按照以下步骤操作：

1.  打开“IIS管理器”
2.  选择您要管理的应用程序
3.  选择“高级设置”
4.  在“(General)”下，将“Preload Enabled”设置为“true”，这意味着应用程序将在部署后自动加载。

有关更多信息，请访问：[使用 IIS 应用程序初始化来保持 ASP.NET 应用程序活动](https://weblog.west-wind.com/posts/2013/oct/02/use-iis-application-initialization-for-keeping-aspnet-apps-alive)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-23T12:13:48.617

我们遇到了同样的问题，Web 服务必须以这样一种方式保持在线，以至于如果它过时，我们无法承受启动它所涉及的延迟。

我们编写了一个非常简单的 Windows 服务，它每 3 分钟唤醒一次，并按照@Wayne 的建议请求一个页面。像魅力一样工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T11:54:18.663

最简单的方法是使用脚本打开与网站的连接并请求您的页面。有关更多信息，请参阅[Joel Oleson 的博客](http://blogs.msdn.com/joelo/archive/2006/08/13/697044.aspx)。

您可以使用 Windows 调度程序每 x 分钟运行一次。

这可能特定于 Sharepoint，但您可以适应您的要求。

更新：试试这个版本：[WarmUpServer.zip](http://www.sharepointforum.com/Documents/Useful%20Files/WarmUpServer.zip)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T11:56:15.273

应用程序池确实会回收，并且它们会在达到可以在 IIS 上设置的执行时间或请求数量等方面的一些限制后重新启动。

IIS 7 实际上是在管道模式下运行的，所以它是一些新的东西，我们还不确定，但你可以做的就是让你的应用程序活着，就是从其他机器上设置一个触发器，它会每隔 5 或 10 或 60 次连接你的服务器分钟并尝试获取一个 html 页面。

也可以有各种用于 http 的服务器监视器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-27T01:49:13.037

在配置 IIS 池失败后。我推出了这个简单的 Windows 服务。 [github代码](https://github.com/ChinhPLQ/Windows-Service)

它可以为您节省几分钟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-27T06:28:13.923

将“启用预加载”设置为“真”将仅在启用匿名身份验证的情况下起作用。

# audio - 低频声音采样

> ID：781358
> 
> 赞同：3
> 
> 时间：2009-04-23T11:44:58.937
> 
> 标签：audio, filtering, signal-processing, sampling, audio-aliasing

这个问题其实我之前也发过，但是没有人回答。可能我说的不够清楚，我换个说法：

如您所知，当您以特定采样率对信号进行采样时，任何高于采样率一半的频率都会出现混叠。为了避免这种情况，您需要将信号（以模拟形式，或以更高速率采样的数字形式）通过适当的低通滤波器。

现在，就我而言，我正在使用 Windows 的 waveIn 函数以一定的速率收集麦克风输入。由于 waveIn 函数似乎在我提供给它的任何采样率下工作，而不是在任意预定义的速率下工作，我真的不知道声卡是否实际上以该速率采样，或者它是否以预定义的速率采样并且系统“转换“按照我要求的价格。我也不在乎，其实...

我关心的是，当我以 8kHz 采样时，声卡或系统是否执行低通滤波（声卡上的模拟滤波器或数字滤波器，然后限制在某个最大采样率支持声卡），所以我的输入不会出现混叠频率。

或者，我应该以尽可能高的采样率进行采样并自己过滤掉频率？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T12:05:59.480

如果在对信号进行采样之前不使用 LPF，我认为您将使用非常差的声卡。我不会担心这个！您始终可以通过传入 10kHz 音调来检查它是否通过混叠出现。

编辑：即使您的声卡以 44.1 或 48 或其他格式提供它，waveIn 在重新采样时仍会执行 LPF。这只是抽样的一部分。在某些应用程序中可以打开抗混叠滤波器以获得时髦的频率环回效果，但默认情况下我认为它会一直打开。

# iphone - UINavigationController 自动旋转到横向不更新 UIView 框架

> ID：781361
> 
> 赞同：3
> 
> 时间：2009-04-23T11:46:27.637
> 
> 标签：iphone, cocoa, cocoa-touch, user-interface

我正在开发一个完全在横向模式下运行的应用程序（UIStatusBarHidden=YES 和 UIInterfaceOrientation=UIInterfaceOrientationLandscapeRight）。我正在使用 NavigationController，我的 rootViewController (MainViewController) 设置如下：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
  return (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

在我的 MainViewController 中，我正在加载这样的视图：

```
- (void)loadView {
  CGRect frame = [[UIScreen mainScreen] applicationFrame]; // This returns a portrait frame
  MainView *view = [[MainView alloc] initWithFrame:frame];
  self.view = view;
  [view release];
} 
```

然后在 MainView 中，我正在加载这样的子视图：

```
- (id)initWithFrame:(CGRect)frame {
  if (self = [super initWithFrame:frame]) {
    self.pdfView = [[PDFView alloc] initWithFrame:frame];
    [self addSubview:pdfView];
  }
   returnself;
} 
```

我的问题是 MainView 在横向模式下正确呈现（尽管传递给 [MainView initWithFrame:] 的框架是纵向的），而子 PDFView 呈现为纵向框架。我还尝试在我的 [UIView initWithFrame:] 实现中应用转换，如下所示：

```
view.center = CGPointMake(view.frame.size.height/2.0, view.frame.size.width/2.0);
view.transform = CGAffineTransformRotate(view.transform, (M_PI/2.0)); 
```

但这似乎不起作用，因为帧值不正确。在某些情况下，像这样忽略框架并手动创建一个似乎可行：

```
CGRectMake(0.0, 0.0, 480.0, 320.0) 
```

但显然进行这样的手动调整并不理想。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T17:11:46.150

我不知道这对您的情况是否有帮助，但请确保您的所有视图和控件都支持自动旋转。UINavigationController 没有，UITabBarController 也没有。如果它的任何子视图不支持自动旋转，Tab Bar 控制器将停止支持它。我必须创建自己的 UINavigationController 并使其从 UINavigationController 继承，然后实现自动旋转。由于您完全在横向上执行您的应用程序，我不知道这是否有帮助，但它可能会让您开始找到解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-23T19:31:19.727

因为 MainScreen 始终是**Portrait**。请参阅[iPhone (/iPad) 上的高度和宽度](https://stackoverflow.com/questions/3972001/height-and-width-on-iphone-ipad/3996155#3996155)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-23T10:47:24.620

我遇到了与 MapView 类似的问题。基本上，您必须确保所有子视图都实现：

view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

# c# - dotNet（或 C#）中是否考虑了闰秒？

> ID：781370
> 
> 赞同：5
> 
> 时间：2009-04-23T11:47:59.367
> 
> 标签：c#, .net, datetime, time

DateTime 结构会处理这个问题吗？还有其他类/结构吗？

更新 ：

我现在读到闰秒只是提前 6 个月宣布，因为地球的自转不是那么可预测的......

由于不可能在未来的日期实施，我可以想象他们只是省略了它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T11:55:26.807

据我所知，.NET 的 DateTime 结构不会自动处理闰秒。我认为您甚至不能在 .NET 的 DateTime 中设置高于 59 的秒数。但是，在 Java 中，您可以将秒设置为 0 - 61，因为它的 ISO 标准允许每年有 2 个闰秒。

**编辑**：我试了一下：

在 .NET 中尝试`Dim dt As New DateTime(2008, 12, 2, 12, 34, 61)`会引发此消息（61 是秒数）：

> “小时、分钟和秒参数描述了无法表示的日期时间。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T12:04:38.797

我认为您的两个问题的答案都是否。参考：[http ://silverlight.net/forums/t/12114.aspx](http://silverlight.net/forums/t/12114.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-06T21:53:13.467

不，不是 DateTime，因为源代码似乎没有它。

[http://referencesource.microsoft.com/#mscorlib/system/datetime.cs](http://referencesource.microsoft.com/#mscorlib/system/datetime.cs)

# javascript - 如何检测 IE 是否阻止了 JAVA（安全）

> ID：781371
> 
> 赞同：1
> 
> 时间：2009-04-23T11:48:30.253
> 
> 标签：javascript, internet-explorer, applet

如何检测 IE 是否以最高安全性运行并且不会出现 JAVA APPLET。在这种情况下，IE 似乎没有显示 java 对象的替代内容。

*如果*java 被禁用，我想向最终用户显示一些说明如何调整他们的安全设置。

与 INTERNET 区域相比，INTRANET 区域的工作方式有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T11:59:28.653

您是否尝试过[navigator.javaEnabled](http://msdn.microsoft.com/en-us/library/ms536610(VS.85).aspx)方法？

还有一个[clientCaps.isComponentInstalled](http://msdn.microsoft.com/en-us/library/ms531357(VS.85).aspx)方法，但从未使用过。

# php - Zend Framework：尝试使用 Zend Mail Transport 发送多封带附件的电子邮件时出现致命错误

> ID：781374
> 
> 赞同：1
> 
> 时间：2009-04-23T11:49:13.497
> 
> 标签：php, email, zend-framework, smtp, attachment

我不完全理解这一切是如何工作的，但我收到了这个错误：

致命错误：第 213 行 /Users/andrew/Sites/myApp/library/Zend/Mail/Transport/Smtp.php 中允许的 8388608 字节内存大小已用尽（试图分配 261858 字节）

我在运行 MAMP 的 Mac 上本地运行此代码。不确定这是否与它有关。这是我的代码，基本上：

```
$config = array('ssl' => 'tls', 'port' => 587, 'auth' => 'login', 'username' => 'username', 'password' => 'password');
    $smtpConnection = new Zend_Mail_Transport_Smtp('smtp.gmail.com', $config);

    foreach ($subscribers as $subscriber) {
        $message = new Zend_Mail('utf-8');
        $message->setFrom('my@mailinglist.com', 'Mailing List')
                ->addTo($subscriber->email)
                ->setSubject($subject)
                ->setBodyText($body);
        $attachment = $message->createAttachment(file_get_contents($filepath));
        $attachment->type = 'application/pdf';
        $attachment->filename = $filename;
        $message->send($smtpConnection);
    } 
```

但是，订阅者越多，这个数字就越高，这个修复只能帮助这么久：

```
ini_set("memory_limit","12M"); 
```

我需要弄清楚如何向数百人发送带有附件的电子邮件。这是我想出的其他东西，但只设置密件抄送而不是收件人地址似乎有点笨拙：

```
$message = new Zend_Mail('utf-8');
    $message->setFrom('my@mailinglist.com', 'Mailing list')
            ->setSubject($subject)
            ->setBodyText($body);
    $attachment = $message->createAttachment(file_get_contents($filepath));
    $attachment->type = 'application/pdf';
    $attachment->filename = $filename;

    foreach ($subscribers as $subscriber) {
        $message->addBcc($subscriber->email);
    }
    $message->send($smtpConnection); 
```

但是，即使这样做，我也需要指定“memory_limit”。你能指出我正确的方向吗？有什么我没有做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:52:12.673

无需为每条消息创建新附件。只需创建一次，然后在每次发送时附加。

```
$config = array('ssl' => 'tls', 'port' => 587, 'auth' => 'login', 'username' => 'username', 'password' => 'password');
$smtpConnection = new Zend_Mail_Transport_Smtp('smtp.gmail.com', $config);

$attachment = new Zend_Mime_Part(file_get_contents($filepath));
$attachment->type = 'application/pdf';
$attachment->disposition = Zend_Mime::DISPOSITION_ATTACHMENT;
$attachment->filename = $filename;

foreach ($subscribers as $subscriber) {
    $message = new Zend_Mail('utf-8');
    $message->setFrom('my@mailinglist.com', 'Mailing List')
            ->addTo($subscriber->email)
            ->setSubject($subject)
            ->setBodyText($body);
    $message->addAttachment($attachment);
    $message->send($smtpConnection);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T12:31:01.463

我猜你的pdf大约是250Kbytes？您发送的每封电子邮件都会将其读入内存一次。不。读一遍。:) 它也可能是 Zend 框架中的一种编码方式。

*   *在*循环之前调用 file_get_contents()
*   只要您的服务器可以处理它，就将内存限制设置得更高（我会说是 32-128 MB）
*   unset() 你的变量 - 应该强制 php 对它进行 GC（理论上）
*   您可以重用 $message 对象（丑陋的 hack，但如果 Zend 进行某种文件编码并且它使用大量内存，则可以节省字节）

我还会做一个 cron-job 来发送电子邮件，并确保每封电子邮件（或对它的引用）与状态一起存储在数据库中。这样，如果您达到另一个内存限制或错误，您将不会发送重复的邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T12:00:02.147

我在内存限制和通过一个 SMTP 连接发送大量消息时遇到了类似的问题。*Zend_Mail_Protocol_Abstract*将其内部日志保存在内存中。日志中记录了所有邮件请求。日志随着每条发送的消息而增长。您有时必须调用 $protocol->resetLog() 。（这取决于每条消息的数据量。您可以通过 memory_get_usage() PHP 函数检查您的内存使用情况。）尝试这样的事情：

```
 $transport = new Zend_Mail_Transport_Smtp();
  $protocol = new Zend_Mail_Protocol_Smtp('localhost');
  $protocol->connect();
  $protocol->helo('localhost');
  $transport->setConnection($protocol);
  foreach(){
    $mail = new Zend_Mail('utf-8');
    ...
    $protocol->rset();
    $mail->send($transport);
    $protocol->resetLog();  // you don't need to resetLog for each message
  } 
```

这也可能有帮助： http: [//framework.zend.com/manual/en/zend.mail.multiple-emails.html](http://framework.zend.com/manual/en/zend.mail.multiple-emails.html)

# c# - 如何命名纯虚拟受保护属性

> ID：781381
> 
> 赞同：0
> 
> 时间：2009-04-23T11:53:05.970
> 
> 标签：c#, .net, properties, naming-conventions

**前言：**

我有一个组件，我们称之为 IView。该组件由 BaseView 类实现，该类拥有它的大部分功能。我们使用模板模式将逻辑委托给继承类。

**问题：**

我们有一个名为 IView.Visible 的属性，它指示组件是否应该可见。这个属性**不是虚拟**的，因为它涉及我们 BaseView 中的一些逻辑。

我们创建了一个虚拟受保护方法**IsVisible**，它从 BaseView.Visible 调用以确定 IView.Visible 的最终值。

我们觉得这个属性名称 IsVisible 对于派生类的实现者来说描述性和清晰性不够。

有人建议将其重命名为 ShouldBeVisible，但我们仍然填写有一个更好的名称。

你怎么看 ？你有更好的名字吗？是否有涵盖模板方法这一主题的良好命名约定？

* * *

**更新：**为了澄清一点，Visible 和 IsVisible 属性对组件没有副作用， Visible 属性使用 IsVisible 中的值来决定 Visible 的值是否应该为真，但这不是唯一的考虑和耦合组件的其他内部状态以给出最终判断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T12:51:01.603

我从来没有特别热衷于这种命名约定，但《[框架设计指南》](http://www.amazon.co.uk/Framework-Design-Guidelines-Conventions-Development/dp/0321545613/ref=sr_1_1?ie=UTF8&s=books&qid=1240489957&sr=8-1)一书建议使用“核心”作为这种模式的后缀。此代码取自 Microsoft System.Windows.Forms.Control 类

```
public bool CanSelect
{
    get
    {
        return this.CanSelectCore();
    }
}

internal virtual bool CanSelectCore()
{
    ...
} 
```

我对这个解决方案的担忧是，您公开了一种未知复杂性的方法，并可能会产生副作用作为属性，但是由于您可以翻阅 .NET 框架代码并发现如果您正在寻找标准，则经常使用此约定这可能与您将得到的一样接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T11:59:40.773

这个问题没有“对”或“错”，只有“更好”或“更差”。

就我个人而言，我会将“涉及一些逻辑”的属性设为 GetVisible() 方法，以明确存在一些逻辑（即使它也可以是属性那么简单）。

持有信息的属性可能只是可见的。

这就像理解不同的成员：属性是数据（或数据的幻觉），方法是逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:00:03.330

基类是实现属性还是打算由继承类实现，即它是抽象的？我的第一个想法是它应该像在继承类中一样命名。如果它控制类输出是否可见，那么 Visible 似乎是正确的名称。至少在我看来，这个名字不应该反映实现而不是目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T12:02:35.277

我认为“虚拟保护”确实足以达到目的，它已经指定它可以并且将在某个时候被覆盖并由子类访问。

命名不应该太大以便一次又一次地编码，并且 IsVisible 是标准的命名方式。它也应该属于正确的英语。ShouldBeVisible 听起来像是某种条件/验证，而不是属性。

成员的名字应该只描述目的而不是逻辑或过于技术性的细节，这只会让名字越来越大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T12:21:03.890

由于所考虑的方法是继承类的 Visible 实现，如果必须的话，我会使用可怕的丑陋但非常具有描述性的名称 VisibleImplementation 或 VisibleImpl。这让开发人员非常清楚，这是他要实现使组件可见或不可见的逻辑的地方。

```
 protected bool VisibleImplementation()  { ... } 
```

或者，您可以给它同名 Visible 并要求它采用布尔参数，指示它是否从基本实现中调用。就个人而言，我不喜欢仅仅为了区分方法而引入参数，但有时你必须做出妥协。

```
 protected bool Visible( boolean fromBase ) { ... } 
```

# python - CSS 解析器 + XHTML 生成器，需要建议

> ID：781382
> 
> 赞同：5
> 
> 时间：2009-04-23T11:53:09.930
> 
> 标签：python, css, parsing, xhtml

伙计们，我需要开发一个满足以下要求的工具：

1.  输入：节内带有 CSS 规则的 XHTML 文档`head`。
2.  输出：带有在标签属性中计算的 CSS 规则的 XHTML 文档

说明我想要的行为的最佳方法如下。

示例输入：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <style type="text/css" media="screen">
    .a { color: red; }
        p { font-size: 12px; }
  </style>
</head>
<body>
    <p class="a">Lorem Ipsum</p>
    <div class="a">
         <p>Oh hai</p>
    </div>
</body>
</html> 
```

示例输出：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<body>
    <p style="color: red; font-size: 12px;">Lorem Ipsum</p>
    <div style="color: red;">
         <p style="font-size: 12px;">Oh hai</p>
    </div>
</body>
</html> 
```

哪些工具/库最适合此类任务？我不确定 BeautifulSoup 和 cssutils 是否能够做到这一点。

Python 不是必需的。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T14:48:14.800

尝试预邮件

[code.dunae.ca/premailer.web](http://code.dunae.ca/premailer.web/)

更多信息： [campaignmonitor.com](http://www.campaignmonitor.com/blog/post/2455/automatically-generate-inline/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:17:44.810

虽然我不知道任何特定的工具可以做到这一点，但这是我将采取的基本方法：

加载为xml文档
从文档中提取css类和样式
对于每对css类和样式
  从css类构造xpath查询
  对于每个匹配的节点
    设置该类的样式属性从文档中
删除样式节点将文档转换为字符串

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-07T18:17:01.630

Pypi 上有一个[premailer python 包](http://pypi.python.org/pypi/premailer)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T14:38:25.463

取决于你的 CSS 有多复杂。如果是元素（“p {}”、“a {}”）、ID/类（#test {}）的简单问题，那么可能最容易使用正则表达式。您必须找到所有样式定义，然后解析它们，然后使用更多正则表达式来查找匹配的标签实例。

例如，如果您发现您有 A 标签的样式，您可以使用如下正则表达式：

```
<a\b[^>]*>(.*?)</a> 
```

要获得它们，您必须进行替换以添加样式。当然，您希望正则表达式接受标签作为参数（在本例中为 A 标签）。

如果您进入子选择或不仅仅是根元素和 ID/类，这可能会很快变得混乱。

考虑只定义内联样式开始？

# apache-flex - 限制 Flex 中模态弹出窗口的大小？

> ID：781385
> 
> 赞同：1
> 
> 时间：2009-04-23T11:53:50.320
> 
> 标签：apache-flex, actionscript-3, actionscript, canvas, actionscript-2

```
private function tileList_itemClick2(evt:ListEvent):void {
                img = new Image();
                    img.maintainAspectRatio = true;
                    img.addEventListener(Event.COMPLETE, image_complete);
                    img.addEventListener(ResizeEvent.RESIZE, image_resize);
                    img.addEventListener(MouseEvent.CLICK, image_click);           

                    img.source = "products/images/" + evt.itemRenderer.data.imgH;
                    img.setStyle("addedEffect", image_addedEffect);
                    img.setStyle("removedEffect", image_removedEffect);
                    PopUpManager.addPopUp(img, myCanvas, true); 
             } 
```

是否可以限制模态弹出窗口（“模态透明度颜色”）的大小，使其包含在画布内？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T23:51:35.380

Flex 中的 PopUpManager 旨在在整个应用程序中显示模式弹出窗口。您不能将其限制在较小的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T06:36:24.103

尝试设置`maxWidth`和`maxHeight`属性。

# java - 运行 servlet 的问题

> ID：781386
> 
> 赞同：0
> 
> 时间：2009-04-23T11:54:08.370
> 
> 标签：java, tomcat, servlets

我在 Eclipse (Ganymede) 下尝试运行 java servlet 时遇到问题，我正在运行 Java 1.6 和 Apache Tomcat 6.0。

这是我正在做的事情：

1.  停止 Tomcat。
2.  新的动态网络项目。
3.  调用项目TestProject
4.  使用默认选项：Context = "TestProject", Context Directory = "WebContent", Java Source Directory = "src"
5.  右键单击项目并选择新的servlet
6.  使用默认包并调用类“HelloTest”所有其他选项都是默认的
7.  将 URL 映射更改为 /hello

servlet 的代码如下（我只编辑了 doGet 和 doPost 方法，其他的都是生成的）：

```
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class HelloTest
 */
public class HelloTest extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public HelloTest() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        PrintWriter writer = response.getWriter();
        writer.write("Hello World");
        writer.flush();
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        doGet(request,response);
    }

} 
```

以下是我尝试运行项目的方法： 1\. 保存项目 2\. 右键单击​​项目并选择在服务器上运行。3\. 选择现有的 Tomcat 服务器 4\. 单击完成。

当我尝试浏览到[http://localhost:8080/TestProject/hello](http://localhost:8080/TestProject/hello) 时，我收到一个异常，提示找不到该类。

```
javax.servlet.ServletException: Wrapper cannot find servlet class HelloTest or a class it depends on
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
java.lang.Thread.run(Thread.java:619) 
```

根本原因

```
java.lang.ClassNotFoundException: HelloTest
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1387)
    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1233)
    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447) 
```

难道我做错了什么？

如果我添加一个名为 test.jsp 的 .jsp 页面，它会完美显示，因此我知道 Tomcat 正在运行并提供页面，并且我有正确的路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T12:08:04.123

首先检查类是否正确部署。另请参阅[此问题](https://stackoverflow.com/questions/706140/eclipse-keeps-running-my-old-web-application/706165#706165)。

# asp.net - asp：如何显式重新加载页面

> ID：781391
> 
> 赞同：0
> 
> 时间：2009-04-23T11:56:19.393
> 
> 标签：asp.net, themes, refresh, postback

我提供了一个按钮来更改网站的主题。在按钮的 onclick 事件处理程序中。我正在更改 web confif 文件页面部分的主题属性。但是回发主题不会改变，直到我再做一次回发。所以我想在按钮的事件处理程序中显式回发 pa。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T12:02:35.650

也许这不是最好的解决方案，但我知道可以执行以下操作：

```
Server.Transfer(Page.Request.RawUrl) 
```

您需要将该代码放入您的点击事件中。这样，它将“重新加载”页面。

但是，如果您更改主题，您可以执行以下操作将其直接应用于页面：

```
Page.Theme = "BlueTheme"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T12:15:44.183

```
Response.Redirect(Request.Url.ToString()) 
```

这将再次刷新页面。确保在此代码之前测试回发，否则您将进入其中一个非常有趣的无限循环。

# sharepoint - Sharepoint 开发 - Microsoft VPC 与 VMWare

> ID：781392
> 
> 赞同：1
> 
> 时间：2009-04-23T11:56:29.703
> 
> 标签：sharepoint, vmware, vpc

我在*Microsoft Virtual PC*上开发了一些小的 Sharepoint 应用程序，但现在我们在 Sharepoint 上开始了一个新的更大的项目。

你怎么看？我们应该从*VPC*切换到*VMWare*（服务器？）还是没有显着的性能差异？

（开发者硬件：带外置硬盘的笔记本，2GB内存，Core 2 Duo）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T12:07:41.223

我认为作为拉撒路，你应该坚持你所知道的。但是对于您搜索新内容的情况：还有一个[VirtualBox](http://www.virtualbox.org/)，我使用了半年以来的开发机器。

原因：它作为 VPC 运行速度更快，并且有一些不错的功能。我也可以在 Windows 下使用这个软件，就像在 Linux/Unix 下一样

* * *

**编辑**

我认为对于 SharePoint 开发来说，唯一真正重要的是远程调试器。其他一切都只是“很高兴拥有”。

*   VPC 与 VMWare 工作站：VMWare 胜出。它有很多非常好的功能，但对 Sharepoint 来说并不重要。
*   VPC 与 VirtualBox：VirtualBox 胜出。也因为很好有功能。
*   VMWare Workstation 与 VMWare Server：VMWare Workstation 胜出。你可以使用免费的服务器版，但我不明白改变的意义？！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T12:23:22.527

我使用了数十台虚拟机进行 SharePoint 开发，同时使用了 VMWare 和 VPC（尽管大多数是 VPC），但我没有注意到任何显着差异。

对于您的开发人员笔记本，我将 RAM 提高到 4G。实际上，如果您有机会真的想使用带有两个内部驱动器的 64 位 Windows Server 2008 和 Hyper-V，其中一个应该是固态驱动器。下一版本的 SharePoint 将需要 64 位。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T12:05:06.517

我认为你应该坚持你目前已经实现的，除非 VMWare 实现了 VPC 没有实现的特定功能。您是将生产实施构建为 VM 还是仅仅是您的开发环境？如果是后者，那么肯定坚持使用VPC，无需更改。如果它是生产，那么您可能会从 VMWare 中受益，它的存在时间更长，并且与 VPC 相比有轻微的性能改进（或者至少在我上次查看时是这样，一年或更长时间）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T22:37:02.880

我在我们的 VMWare ESX 服务器中的一个虚拟机上完成我所有的 SharePoint 工作，它就像一个魅力。当我弄乱我的开发机器时，我只是恢复到原始快照或基于“已批准”图像创建新图像或“借用”我的一位同事的克隆。如果你在一个相当大的商店里，ESX 服务器可能是你要走的路。

我在笔记本电脑上同时运行 VMware 播放器和新的 VirtualBox 软件，但这只是为了好玩，因为性能低于我在白天工作中所能接受的水平。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T11:59:43.050

我在 Virtual PC 中为 SHarepoint 开发从来没有遇到过任何问题。当然，我只是一个样本量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-24T14:34:36.530

在我的特殊情况下，我在 MacBook Pro 上进行开发（哈哈，对吗？），因为它是唯一一台功能强大到值得我使用的机器（我的公司工作站没有），而且我能够使用Microsoft 提供的免费 VPC 映像，[使用 VMWARE 的转换器进行转换，并在](http://www.vmware.com/products/converter/)[VMWARE Fusion 2.0 for Mac](http://www.vmware.com/products/fusion/)上成功运行。

它们在 97% 时“失败”，但实际上，您启动了 VMWARE 映像，一切顺利。

希望对某人有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T23:02:06.927

我建议在 VPC 上使用 vmWare，因为它有一个无与伦比的功能——快照。您可以在任何阶段创建系统快照并返回那里，如果出现问题

例如，您从头开始安装 Windows 并在那里安装 SharePoint。您创建快照并开始配置您的 SharePoint。如果出现问题，您可以在 1 分钟内返回到之前的状态。这是非常酷和有用的东西。我从 2000 年开始使用 VPC，并在 2 年前将我的所有服务器都切换到了 vmWare。对 vmWare 非常满意

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T22:47:53.323

由于速度/性能（它很便宜，但不是免费的），我推荐 VMware Workstation 作为开发的最佳选择。

我在我的桌面上使用 Workstation，我们有一个运行 ESXi 的专用服务器和 20 多台机器进行测试，其他支持技术人员也可以使用免费的 VMware Player 运行我创建但未上传到测试服务器的图像。

# installation - MSI 安装错误：将不会安装此广告应用程序，因为它可能不安全

> ID：781402
> 
> 赞同：28
> 
> 时间：2009-04-23T12:00:55.777
> 
> 标签：installation, windows-installer

我创建了一个 msi 来安装我的 Windows 窗体应用程序，当我尝试运行 msi 时出现以下错误：

```
"This advertised application will not be installed because it might be unsafe. Contact your administrator to change the installation user interface option of the package to basic" 
```

我知道这是一个权限问题，您实际上需要成为管理员，而不仅仅是拥有管理员权限。

有没有办法解决？将包更改为基本？

谢谢

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-23T12:03:56.130

这可能是因为您使用组策略来安装它（在这种情况下更改`UI`下`Advanced Deployment`），但可能与您的域策略冲突。您可以尝试使用：

```
msiexec /i product.msi /qb 
```

我假设您以本地管理员身份运行，而不是域管理员。您还应该确保尚未安装该软件包。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-08-14T06:22:01.227

在花费了很多小时的错误消息之后：

**不会安装此广告应用程序，因为它可能不安全**

和卸载问题，例如：

**安装的产品与安装源不匹配**

这可以强制安装：

```
msiexec.exe /i [product.msi] /qb 
```

如果该过程不允许我卸载它（通常来自其他用户的帐户（我在安装时使用了“所有用户”选项），这可以卸载应用程序：

```
MsiExec.exe /I foo.msi REINSTALLMODE=voums REINSTALL=ALL 
```

然而...

我的最终结论是我的`.msi`文件被埋在我的文件夹里太深了。因此，当我登录其他用户（我使用“所有用户选项”安装）进行安装或卸载时，单击桌面图标，或尝试从“添加删除程序”卸载，安装程序在那个再次，点无法找到原始`.msi`文件，因为我将它埋在我的文件夹中太深了。

移近`product.msi`根文件夹可以解决所有问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-01T14:27:58.400

我在 MS Visual Studio 中创建的安装程序遇到了同样的问题。当我用记事本打开vs解决方案.suo文件时，发现与解决方案项目无关的文件路径！！安装程序是通过修改旧项目匆忙创建的，尽管我从 Visual Studio gui 中检查了所有属性和引用等，但 .suo 中不相关的文件路径导致了问题。

此 msi 在某些平台上成功运行，但在其他平台上出现“此广告应用程序将不会安装，因为它可能不安全”错误。

修复是从 scatch 重新创建安装程序解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-01T16:49:37.593

Windows Installer 清理工具运行奇迹并删除了程序（即使该程序已使用添加删除程序卸载它仍然存在）然后重新运行安装程序，现在一切都很好

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-17T16:48:07.457

我遇到过同样的问题。安装 .Net 是我的安装程序的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-22T09:19:52.857

我面临同样的问题。

问题是，我第一次运行安装程序，它运行成功。我卸载它并再次尝试运行，现在问题开始了。

第二次运行安装程序时，它显示了该消息。

“此广告应用程序将不会安装，因为它可能不安全。请联系您的管理员将软件包的安装用户界面选项更改为基本。”

我从注册表中删除安装程序条目并再次运行。它工作正常。

# matlab - 将向量附加到空的 MATLAB 矩阵

> ID：781410
> 
> 赞同：18
> 
> 时间：2009-04-23T12:03:22.293
> 
> 标签：matlab, matrix

我有将 n 维点 (n >1) 插入矩阵 ( `myPointMatrix`) 的 MATLAB 代码，并且正在考虑如何插入第一个点。

现在程序`myPointMatrix`在插入点之前检查大小。如果是1x1，`myPointMatrix`则设置为等于当前点。否则附加当前点。这个`if`-statement 只成立一次，但每次我插入一个点时都会被评估，这很常见。

删除`if`并尝试附加到`myPointMatrix`使 MATLAB 抱怨矩阵尺寸不一致是可以理解的。删除`if`- 语句和初始化`myPointMatrix = 0`会导致 MATLAB 发现`myPointMatrix`未定义。也可以理解。

如何初始化`myPointMatrix`以便可以删除`if`-statement？还是有其他智能解决方案？

```
myPointMatrix = 0;
for x=0:limit
    for y=0:limit
        for z=0:limit
            tempPoint = [x y z];
            if (length(myPointMatrix) == 1)
                myPointMatrix = tempPoint;
            else
                myPointMatrix = [myPointMatrix; tempPoint];
            end
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-23T19:12:24.497

有几种方法可以将矩阵或向量附加到任何矩阵，无论是否为空。很大程度上取决于矩阵的大小，以及添加的频率。（请注意，稀疏矩阵是完全不同的动物。它们需要单独处理。）

简单的方案将使用串联。例如，我将创建一个随机数组。虽然我知道在这里调用 rand 是正确的解决方案，但我这样做只是为了比较。

```
n = 10000;
tic
A = [];
for i = 1:n
  Ai = rand(1,3);
  A = [A;Ai];
end
toc

Elapsed time is 9.537194 seconds. 
```

看到所需的时间相当长，远远超过我直接调用 rand 的时间。

```
tic,rand(n,3);toc
Elapsed time is 0.008036 seconds. 
```

其他追加方式在时间上类似。例如，您也可以通过索引追加。

```
A = [];
A(end+1,:) = rand(1,3);
A
A =
      0.91338      0.63236      0.09754 
```

这在时间上与通过串联追加相似。要理解的一个有趣的事实是，将新行附加到数组与附加新列有细微的不同。追加一行比追加一列需要更多的时间。这是因为元素在 MATLAB 中的存储方式。添加新行意味着元素实际上必须在内存中进行洗牌。

```
A = zeros(10000,3);
B = zeros(3,10000);

tic,for i = 1:100,A(end+1,:) = rand(1,3);end,toc
Elapsed time is 0.124814 seconds.

tic,for i = 1:100,B(:,end+1) = rand(3,1);end,toc
Elapsed time is 0.116209 seconds. 
```

任何附加操作的问题在于 MATLAB 必须重新分配 A 所需的内存，并且每次矩阵增大时都这样做。由于 A 的大小呈线性增长，因此所需的总时间随 n 呈二次方增长。因此，如果我们将 n 的大小加倍，动态增长的 A 将花费四倍的时间来构建。这种二次行为是人们告诉您在动态增长时预先分配 MATLAB 数组的原因。事实上，如果您查看编辑器中的 mlint 标志，MATLAB 会在看到这种情况时向您发出警告。

如果您知道 A 的最终大小，更好的解决方案是将 A 预分配到其最终大小。然后只需索引。

```
tic
A = zeros(n,3);
for i = 1:n
  A(i,:) = rand(1,3);
end
toc

Elapsed time is 0.156826 seconds. 
```

虽然这比动态增长的数组要好得多，但它仍然比 rand 的矢量化使用差得多。因此，尽可能使用像这样的函数的矢量化形式。

问题是，有时您根本不知道最终会得到多少元素。仍然有一些技巧可以用来避免讨厌的二次增长。

一个技巧是猜测 A 的最终大小。现在，使用索引将新值插入到 A 中，但要仔细观察新条目何时会溢出 A 的边界。当这即将发生时，DOUBLE A的大小，在末尾附加一大块零。现在返回将新元素索引到 A 中。单独计算“附加”了多少元素。在此过程的最后，删除未使用的元素。这避免了许多讨厌的二次行为，因为只需要执行几个附加步骤。（请记住，当您必须进行追加时，您将 A 的大小增加一倍。）

第二个技巧是使用指针。虽然 MATLAB 在指针方面并没有真正提供太多功能，但元胞数组是朝这个方向迈出的一步。

```
tic
C = {};
for i = 1:n
  C{end+1} = rand(1,3);
end
A = cat(1,C{:});
toc

Elapsed time is 3.042742 seconds. 
```

与增长的阵列相比，这需要更少的时间来完成。为什么？我们只是构建了一个指向单元格的指针数组。这样做的好处是，如果每个附加步骤都有可变数量的行，它仍然可以很好地工作。

元胞数组的一个问题是，当有数百万个元素要附加时，它的效率不是很高。毕竟它仍然是一个二次运算，因为我们在每一步都在增加指针数组。

解决该问题的方法是使用上面显示的两种样式的混合物。因此，将元胞数组的每个元胞定义为大小适中。现在使用索引将 A 的新行填充到单元格中。当当前单元格必须通过下一个附加步骤变得更大时，只需将一个新单元格添加到单元格数组中。

几年前，这个讨论出现在 MATLAB 新闻组上，并且提出了几个沿着这些思路的解决方案。我将解决方案[growdata 和 growdata2](http://www.mathworks.com/matlabcentral/fileexchange/8334 "增长数据和增长数据2")作为文件发布在 MATLAB Central File Exchange 上。Growdata2 使用函数句柄来解决问题：

```
tic
Ahandle = growdata2;
for i = 1:n
  Ahandle(rand(1,3))
end
% unpack the object into a normal array
A = Ahandle();
toc

Elapsed time is 1.572798 seconds. 
```

当时，使用持久变量是一种更快的方法。

```
tic
growdata
for i = 1:n
  growdata(rand(1,3))
end
A = growdata;
toc

Elapsed time is 2.048584 seconds. 
```

从那时起，函数句柄的实现在 MATLAB 中得到了明显改进，因此函数句柄现在更快了。

这些方案的优点是它们不会有二次性能损失，同时允许数百万个附加步骤。

哦，好吧，这肯定比提出问题时最初要求的信息更多。也许有人会从中得到一些东西。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-23T12:49:45.490

用于`myPointMatrix = [];`初始化矩阵。

越大`myPointMatrix`，附加越慢。它变得越来越慢，因为每次附加一个点时，matlab 都会分配一个新大小的新矩阵，并将旧矩阵 + 新点中的信息复制到新矩阵中。

然后最好`MyPointMatrix`使用其最终大小进行初始化，并将点插入矩阵中的给定位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T12:49:38.767

您最好的选择是预先分配矩阵并使用循环变量。这应该明显更快。

```
limit = 9;
myPointMatrix = nan((limit+1)^3,3);

loopVar = 1;
for x=0:limit
    for y=0:limit
        for z=0:limit
            myPointMatrix(loopVar,:) = [x y z];
            loopVar = loopVar + 1;
        end
    end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:04:02.850

我相信您正在寻找的解决方案是将 myPointMatrix 初始化为具有 0 行和 3 列的矩阵，即

```
myPointMatrix = zeros(0, 3); 
```

然后第一个任务

```
myPointMatrix = [myPointMatrix; tempPoint]; 
```

将正常工作，以及后续工作。编写作业的等效方法是

```
myPointMatrix(end+1,:) = tempPoint; 
```

但是请记住，比增长这样的矩阵效率不高，正如 AnnaR 所说，`myPointMatrix`使用 ifs 最终大小（如果已知）进行初始化是一个更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T18:12:14.343

```
%appending to matlab array "f":

lfg=[697 770 852 941];
hfg=[1209 1336 1477];
f=[];
for i=1:4,
    for j=1:3,
        %f = [ f [lfg(i);hfg(j)] ];
        append( f , [lfg(i);hfg(j)] );
    end
end
f 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-02T16:44:13.000

这就是你需要的

```
myPointMatrix=[];
for x=0:limit
for y=0:limit
for x=0:limit
  myPointMatrix(:,end+1)=[x y z];
end
end
end 
```

但仅在您使用 [ xyz ] 进行一些非线性操作的情况下，在分配它之前。如果没有，那么您可以按如下方式编写上述行：

```
myPointMatrix=[];
myPointMatrix(1,:)=kron([1:limit],ones(1,limit^2));
myPointMatrix(2,:)=kron([1:limit^2],ones(1,limit));
myPointMatrix(3,:)=kron(ones(1,limit^2),[1:limit]); 
```

以上是完全矢量化的，虽然有人可能想用......`edit kron.m`替换一些，但我想你可以自己做......：D`find``logical`

# svn - 哪里可以下载没有 svn 客户端的 Subsonic 2.2 源代码？

> ID：781416
> 
> 赞同：-3
> 
> 时间：2009-04-23T12:05:11.180
> 
> 标签：svn, subsonic, tortoisesvn

使用 svn 结帐在我的环境中不起作用。例如，我正在寻找 Subsonic 2.2 的源代码作为 zip 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T15:03:57.303

我使用 HTTP 隧道客户端 ( [http://www.http-tunnel.com](http://www.http-tunnel.com) ) 并将 tortoise/svn 代理设置为 127.0.0.1:1080 慢，但它可以工作。

# c - socket:client waiting even after recieving last byte

> ID：781422
> 
> 赞同：2
> 
> 时间：2009-04-23T12:07:37.040
> 
> 标签：c, networking, client-server, posix

I have client/server program in C, through which I am transferring files to the client from server.

But the client is waiting for recv even after receiving the last byte of the file. Client is terminating only if I kill it or server is killed by me. But server has to be in a loop as it to has to entertain the request of other clients.

I am using `fork()` in the server to entertain the request of each client. I'm exiting from the child process after the request of the client has been entertained, but the client is terminating only when the whole server program is killed.

Why doesn't the client terminate when the server's child exits?

You can see server code [here](http://pastebin.com/m31451f56) and client code [here](http://pastebin.com/m71a01916).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:41:57.717

You should make sure that you call `shutdown(s, SHUT_WR`) followed by `close(s)` in the server process once all of the data has been sent.

The call to `shutdown()` tells the TCP layer that there's no more data to be sent.

TBH, I'm not quite sure why calling `close()` on its own doesn't also achieve that.

EDIT - I've figured that out now - it's because at that point in your code the parent also still has the socket open so it doesn't get torn down by the kernel. If after the `fork()` you add some extra logic:

```
if (p > 0) {
    close(connected);
} 
```

then your code works without a call to `shutdown()`.

If you're using the code I sent in [my answer](https://stackoverflow.com/questions/778544/client-server-programme/778815#778815) to your question from yesterday then the client will get a `bytes_received` count of zero and then terminate its loop.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:12:41.880

You should be calling something like: shutdown(s, SD_SEND); closesocket(s);

on the server after sending the file to close the socket.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:13:53.533

This is a bit hard, more detail would be nice. Are you using TCP/IP? Since you talk about file transfers, I'll assume it's TCP.

If you're terminating the process on the server side that owns the socket connected to the client, that should lead to the connection terminating. The client's `recv()` call should then finish and return -1 (or 0, not 100% sure). Failing that, look into explicitly closing the socket in the main server process (not sure how you've set up your socket ownership).

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-23T12:30:17.283

There are two ways of reading sockets...

1.  receiving byte by byte with recv(), but problem is if your content contains -1 in middle of your data then it will indicate end of file.

2.  Another way is to read buffer from stream, and this method will return the number of bytes read from stream, and if that returns 0 that means its end of stream.

# sharepoint - 将 Web 部件导入 SharePoint 中的页面布局

> ID：781424
> 
> 赞同：1
> 
> 时间：2009-04-23T12:07:46.120
> 
> 标签：sharepoint, web-parts

如何将我自己的自定义 Web 部件添加到 SharePoint 中的页面布局？我已经导出了 webpart 并有一个 .webpart 文件。我尝试将它们导入 SharePoint 设计器，但没有成功。我在 AllUsersWebPart 上读过一点……但我不太确定它是如何工作的。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T22:06:05.563

尝试将 .webpart 中的代码直接添加到布局中。（例如，在记事本中打开复制粘贴到 SharePoint 设计器中）。

注意：您应该在一些布局页面中查找示例，因为 webpart 格式需要进行一些小的更改（我模糊地记得）。

请务必对您的布局页面进行版本控制，因为 SharePoint 设计器有时会随意使用您的代码并将页面填满（并拒绝再次加载/保存它）。如果发生这种情况，请使用网站将页面恢复到以前的（工作）版本。

# sifr - 在 sIFR3 上制作动画

> ID：781428
> 
> 赞同：0
> 
> 时间：2009-04-23T12:09:01.110
> 
> 标签：sifr

现在我正在使用 sIFR3。它工作得很好。此外，我想对 sIFR 施加影响。我的想法是，当页面加载时，sIFR(ed) 文本会改变颜色。例如，列表项中的 sIFR 会一一改变颜色。目的是强调 sIFR(ed) 文本。看了文档，我觉得Flash滤镜不适合这种动画。您认为可以在 sIFR 上制作动画吗？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T20:48:57.057

您可以使用 JavaScript 来做到这一点。请参阅此答案以获取灵感：[Sifr and Javascript changes stylesheets (without a page refresh)](https://stackoverflow.com/questions/754690/sifr-and-javascript-changing-stylesheets-without-a-page-refresh/758217#758217)

# c# - C# 中的重载运算符 =。我如何接受其他类型？

> ID：781434
> 
> 赞同：2
> 
> 时间：2009-04-23T12:11:12.790
> 
> 标签：c#, operator-overloading

所以一位朋友告诉我游戏是如何被黑的以及该技术是如何工作的。然后他问什么是防止这种攻击的最佳方法。我知道的最直接的方法是 A) 洗牌重要值的位 B) 对值进行散列并每次比较它们（保存分数或金钱的 int 可能很少被检查）。

然后我尝试了 C# 中的实现，我无法重载 = 运算符。我怎样才能做到这一点？

前代码。

```
class EncryptVal <T>
{
    T v;
    public T operator = (T v2)
    {
        //shuffle bits
    }
    public T operator ()()
    {
        //return unshuffle bits
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T12:15:11.487

您正在寻找`implicit`and`explicit`运算符，而不是说`=`. 这允许您定义在隐式（即，只是一个赋值）和显式（即，有一个强制转换运算符）强制转换时事情将如何工作。

```
public static implicit operator Type1(Type2 p) {}
public static explicit operator Type1(Type2 p) {} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T12:26:49.773

您可以将值封装在类中并重载与类之间的隐式转换：

```
public class EncryptVal<T> {

    private T _value;

    private EncryptVal(T value) {
        _value = value;
    }

    public static implicit operator EncryptVal<T>(T value) {
        //shuffle bits
        return new EncryptVal<T>(value);
    }

    public static implicit operator T(EncryptVal<T> value) {
        //unshuffle bits
        return value._value;
    }

} 
```

用法：

```
// implicit conversion from int
EncryptVal<int> e = 42;

// implicit conversion to int
int i = e; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T12:14:44.747

不允许在 C# 中重载赋值运算符。[这是关于它的 MSDN 文档](http://msdn.microsoft.com/en-us/library/sbkb459w(VS.71).aspx)。

您必须为此行为创建自己的函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T12:15:45.757

我假设你来自 C++，在那里编写像原始数据类型一样使用的类是很常见的。在 C# 中，您可以更明确地做事。

我会把它写成一个属性或两个方法，例如：

```
class EncryptVal <T>
{
    T v;
    public T Value
    {
      get
      {
        //return unshuffle bits
      }
      set
      {
        //shuffle bits
      }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T12:25:10.713

不要使用 = 来设置值。你不能超载分配。

您可以做的就是将其隐藏在属性后面。

```
int _encyptedValue;
Public int myInt
{
    get
    {
        return Decrypt(_encryptedValue);
    }
    set
    {
         _encryptedValue = Encrypt(value);
    }
} 
```

你可以选择你的解密/加密

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T12:25:41.990

我会为实现部分进行隐式/显式运算符重载。

可能是显式的，因为您的转换会进行繁重的处理，并且最终可能会失败。

我只想补充一点，洗牌似乎只是一种混淆技术，如果你有对你的游戏感兴趣的黑客，它肯定不会持续很长时间。您可能需要更强大的加密技术来保护您的数据，但需要更多的上下文。

# c# - 将对象序列化为 XmlDocument

> ID：781442
> 
> 赞同：18
> 
> 时间：2009-04-23T12:12:56.263
> 
> 标签：c#, xml-serialization, xmldocument

为了`SoapException.Detail`为 asmx Web 服务返回有用的信息，我从 WCF 中获得了一个想法，并创建了一个错误类来包含所述有用信息。然后将该故障对象序列化为所需`XmlNode`的 throwed `SoapException`。

我想知道我是否有最好的代码来创建`XmlDocument`- 这是我的看法：

```
var xmlDocument = new XmlDocument();
var serializer = new XmlSerializer(typeof(T));
using (var stream = new MemoryStream())
{
    serializer.Serialize(stream, theObjectContainingUsefulInformation);
    stream.Flush();
    stream.Seek(0, SeekOrigin.Begin);

    xmlDocument.Load(stream);
} 
```

有没有更好的方法来做到这一点？

**更新：**我实际上最终做了以下事情，因为除非你将 XML 包装在一个`<detail>`xml 元素中，否则你会`SoapHeaderException`在客户端得到一个：

```
var serialiseToDocument = new XmlDocument();
var serializer = new XmlSerializer(typeof(T));
using (var stream = new MemoryStream())
{
    serializer.Serialize(stream, e.ExceptionContext);
    stream.Flush();
    stream.Seek(0, SeekOrigin.Begin);

    serialiseToDocument.Load(stream);
}

// Remove the xml declaration
serialiseToDocument.RemoveChild(serialiseToDocument.FirstChild);

// Memorise the node we want
var serialisedNode = serialiseToDocument.FirstChild;

// and wrap it in a <detail> element
var rootNode = serialiseToDocument.CreateNode(XmlNodeType.Element, "detail", "");
rootNode.AppendChild(serialisedNode); 
```

**更新 2：**鉴于 John Saunders 的出色回答，我现在开始使用以下内容：

```
private static void SerialiseFaultDetail()
{
    var fault = new ServiceFault
                    {
                        Message = "Exception occurred",
                        ErrorCode = 1010
                    };

    // Serialise to the XML document
    var detailDocument = new XmlDocument();
    var nav = detailDocument.CreateNavigator();

    if (nav != null)
    {
        using (XmlWriter writer = nav.AppendChild())
        {
            var ser = new XmlSerializer(fault.GetType());
            ser.Serialize(writer, fault);
        }
    }

    // Memorise and remove the element we want
    XmlNode infoNode = detailDocument.FirstChild;
    detailDocument.RemoveChild(infoNode);

    // Move into a root <detail> element
    var rootNode = detailDocument.AppendChild(detailDocument.CreateNode(XmlNodeType.Element, "detail", ""));
    rootNode.AppendChild(infoNode);

    Console.WriteLine(detailDocument.OuterXml);
    Console.ReadKey();
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T14:27:38.670

**编辑：在详细信息元素内创建输出**

```
public class MyFault
{
    public int ErrorCode { get; set; }
    public string ErrorMessage { get; set; }
}

public static XmlDocument SerializeFault()
{
    var fault = new MyFault
                    {
                        ErrorCode = 1,
                        ErrorMessage = "This is an error"
                    };

    var faultDocument = new XmlDocument();
    var nav = faultDocument.CreateNavigator();
    using (var writer = nav.AppendChild())
    {
        var ser = new XmlSerializer(fault.GetType());
        ser.Serialize(writer, fault);
    }

    var detailDocument = new XmlDocument();
    var detailElement = detailDocument.CreateElement(
        "exc", 
        SoapException.DetailElementName.Name,
        SoapException.DetailElementName.Namespace);
    detailDocument.AppendChild(detailElement);
    detailElement.AppendChild(
        detailDocument.ImportNode(
            faultDocument.DocumentElement, true));
    return detailDocument;
} 
```

# fluent-nhibernate - 流畅的 nhibernate 中的私有集合映射

> ID：781443
> 
> 赞同：7
> 
> 时间：2009-04-23T12:13:00.587
> 
> 标签：fluent-nhibernate

我怎样才能映射这个：

```
public class Customer
{
   private IList<Order> _orders;
   public IEnumerable<Order> 
   GetAllOrders()
   {
      return _orders;     
   }
} 
```

在项目页面上有一些示例，但没有一个是关于这种情况的。有这个样本：

```
// model   
public class Account   
{   
  private IList<Customer> customers = new List<Customer>();   

  public IList<Customer> Customers   
  {   
    get { return customers; }   
  }   
}

// mapping   
HasMany(x => x.Customers)   
  .Access.AsCamelCaseField(); 
```

但它假设 Account 具有公共字段 Customers 并且该场景与我的不同。我尝试了一些可能的选项，但没有一个可行：

```
HasMany(x => Reveal.Propertie("_orders")) 
```

私有字段在简单的属性映射中工作正常，但集合映射则完全不同。任何想法？谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-23T12:31:14.660

最简单的解决方案是将您的集合公开为公共属性 Orders 而不是 GetAllOrders() 方法。那么你的映射是

```
HasMany(x => x.Orders)
    .Access.AsCamelCaseField(Prefix.Underscore); 
```

你的课是

```
public class Customer
{
    private IList<Order> _orders = new List<Order>();

    public IEnumerable<Order> Orders 
    { 
        get { return _orders; }
    }
} 
```

如果这对您不起作用，可以使用 Fluent NHibernate 的 Reveal 映射来[映射私有属性。](http://wiki.fluentnhibernate.org/show/StandardMappingPrivateProperties)

编辑添加：刚刚完成此操作，正确答案是：

```
HasMany<Order>(Reveal.Property<Customer>("_orders")) etc. 
```

集合必须作为受保护的虚拟属性公开以允许代理：

```
protected virtual IList<Order> _orders { get; set; } 
```

[这个答案](https://stackoverflow.com/questions/1129343/how-do-i-map-a-protected-collection-in-fluent-nhibernate)让我走上了正确的轨道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T19:31:37.087

您可以使用 映射完全私有的集合`Reveal.Member()`，但它有一个特定且不明显的限制：`Expression`接受`HasMany()`的 必须返回`IEnumerable<TReferenced>`或`object`。

对于您的班级：

```
public class Customer
{
    private IList<Order> _orders;
    public IEnumerable<Order> GetAllOrders()
    {
        return _orders;     
    }
} 
```

以下行将填充`_orders`集合：

```
HasMany(Reveal.Member<Customer, IEnumerable<Order>>("_orders"));
    //additional mapping behaviors 
```

为了完整起见 - 以下行给出了编译器错误：

```
HasMany(Reveal.Member<Customer, IList<Order>>("_orders")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:14:02.187

谢谢。你的解决方案很好。但是，当您不想透露您的私人收藏时，可能会有一些情况（假设性）。您的链接帖子中未解释此映射方案，因为在该帖子中描述的映射简单属性与集合映射之间存在差异。由于引发异常，我尝试使用 HasMany(x => Reveal.Propertie("_orders")) 失败。

# objective-c - 如何在从 NSMutableData 读取的 NSInputStream 上发出 NSStreamEventEndEncountered 信号

> ID：781448
> 
> 赞同：0
> 
> 时间：2009-04-23T12:15:35.417
> 
> 标签：objective-c, cocoa, producer-consumer, nsinputstream

在 Cocoa 中，我设置了两个 NSThread，一个生产者和一个消费者。生产者将数据附加到 NSMutableData，接收者从该数据中打开一个 NSInputStream 并以块的形式读取。

生产者线程的写入速度比消费者进程快很多，这没关系。但是生产者只生产有限数量的工作，然后退出。我想让消费者线程处理 NSStreamEventEndEncountered 事件。当 NSInputStream 来自 NSMutableData 时，我该如何发出信号？

我是否应该让生产者发送一系列带有表示流结束的神奇数字的字节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:06:47.773

> 生产者将数据附加到 NSMutableData，接收者从该数据中打开一个 NSInputStream 并以块的形式读取。

那是行不通的。从[文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSInputStream_Class/Reference/Reference.html#//apple_ref/occ/instm/NSInputStream/initWithData:)[中`-initWithData:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSInputStream_Class/Reference/Reference.html#//apple_ref/occ/instm/NSInputStream/initWithData:)：

> 的内容`data`被复制。

意思是，它将复制出当时数据对象中的任何内容，而不是在您向其添加更多数据时遵循数据对象的内容。

（同样适用于[`+inputStreamWithData:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSInputStream_Class/Reference/Reference.html#//apple_ref/occ/clm/NSInputStream/inputStreamWithData:)。）

尝试使用[管道](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSPipe_Class/)。

# java - 将 Java GUI Builder .form 文件转换为源代码？

> ID：781458
> 
> 赞同：8
> 
> 时间：2009-04-23T12:16:46.677
> 
> 标签：java, netbeans, gui-designer, matisse

我创建了一个相当大的 Java GUI 应用程序，其中包含许多表单窗口，其中的设置被锁定在 .form 文件中。我想知道是否有任何方法可以将这些 .form 文件转换或重构为我可以修改的真实 Java 源代码？

GUI 是使用 Netbeans 6.5 创建的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T19:55:32.757

我的理解是“.form”文件仅由 Netbeans GUI 构建器用于跟踪 GUI 组件的位置。当您在设计视图中添加组件时，Netbeans 会自动更新实际的源 (.java) 文件。实际上，您*可以*直接修改这些 .java 文件，例如更改按钮上的标签，但如果您在 Netbeans 中执行此操作，它将使用 .form 文件自动重新生成源文件，从而破坏您的手动更改。

根据我的经验，一旦您决定手动修改 .java 文件，.form 文件就会变得不同步，您将无法再正确使用 Netbeans GUI 构建器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T20:03:17.760

kazanaki 是对的，生成的 java 文件可以修改，但生成的 .java 文件是出了名的混乱、庞大且难以解释。此外，如果不渲染 matisse 无用，您无法更改某些内容（如生成的 .java 文件中的注释中所述），因为它希望文件以某种方式包含内容。话虽这么说，如果您小心不要踩到马蒂斯的脚趾，您可以编写代码并且它不会触及您的代码，这很好。

Outlaw 也是对的，如果你改变任何已经在马蒂斯看来的东西，它就会被覆盖。您在 matisse 之外所做的任何更改都必须在 matisse 用于生成代码的 xml 所涵盖的任何元素之外。

我以前尝试过这种事情，但成功有限，最终只是重写了界面以避免这些令人发狂的头痛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T09:00:48.063

我可以编辑源代码，我发现了解决方案。问题是我在 GUI 构建器中使用了“AbsoluteLayout”。Netbeans 在 .form 文件中创建了一些隐藏的 AbsoluteLayout 类。如果我删除了 .form 文件，项目将不再构建。解决方案是将表单更改为“FreeForm”布局，然后我可以删除 .form 文件并删除 GUI 构建器注释。

谢谢你们的帮助，我给你们两个+1。

# c# - 如何在代码隐藏中创建日历？

> ID：781459
> 
> 赞同：2
> 
> 时间：2009-04-23T12:17:28.530
> 
> 标签：c#, asp.net, ajaxcontroltoolkit

我想创建一个这样的 asp.net ajax 日历[，](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/Calendar/Calendar.aspx)但完全在代码隐藏中。我该怎么做？

**编辑：**我只想在代码隐藏中将 js 代码添加到页面中（例如：不在标记中）

**Edit_2：**我需要这个，因为我在模板类中创建了一个文本框控件并想在那里创建日历（用于文本框）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T12:36:08.487

您引用的 ASP.NET ajax 日历是一个扩展器，因此理论上您可以在运行时在代码隐藏中将其添加到您的文本框中。请参见下面的示例，占位符至关重要！

我不确定您为什么要这样做，您能否让我们更好地了解需求，因为可能有更好的解决方案。

**简单页面**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication2._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>

<body>
    <form id="form1" runat="server"><asp:scriptmanager runat="server"></asp:scriptmanager>
    <div>
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    <asp:PlaceHolder ID="Place1" runat="server"></asp:PlaceHolder>
    </div>
    </form>
</body>
</html> 
```

**背后的代码**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using AjaxControlToolkit;

namespace WebApplication2
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            CalendarExtender myCalExt = new CalendarExtender();
            myCalExt.TargetControlID = "TextBox1";
            Place1.Controls.Add(myCalExt);
        }
    }
} 
```

# python - Python3 Http Web 服务器：虚拟主机

> ID：781466
> 
> 赞同：3
> 
> 时间：2009-04-23T12:20:12.113
> 
> 标签：python, http, python-3.x, virtualhost

我正在 python3 中编写一个相当简单的 http web 服务器。Web 服务器需要简单 - 仅从配置文件等中进行基本读取。我只使用标准库，现在它工作得相当好。

这个项目只有一个需求，我自己无法实现——虚拟主机。我需要至少有两个虚拟主机，在配置文件中定义。问题是，我找不到如何在 python 中实现它们的方法。有没有人有任何指南，文章，也许是一些简单的实现如何做到这一点？

如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T12:22:59.330

虚拟主机通过遵守 HTTP 请求中的 Host: 标头来工作。

只需读取请求的标头，并根据 Host: 标头的值采取行动

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-07T09:36:36.377

对于一个简单的 HTTP Web 服务器，您可以从[WSGI 参考实现](http://docs.python.org/3.0/library/wsgiref.html#module-wsgiref)开始：

> wsgiref 是 WSGI 规范的参考实现，可用于将 WSGI 支持添加到 Web 服务器或框架。它提供了用于操作 WSGI 环境变量和响应标头的实用程序、用于实现 WSGI 服务器的基类**、服务于 WSGI 应用程序的演示 HTTP 服务器**，...

修改示例服务器以检查`HTTP_HOST`标头，这是一个简单的应用程序，它根据虚拟主机使用不同的文本进行响应。（扩展示例以使用配置文件留作练习）。

```
import wsgiref
from wsgiref.simple_server import make_server

def my_app(environ,start_response):
    from io import StringIO
    stdout = StringIO()
    host = environ["HTTP_HOST"].split(":")[0]
    if host == "127.0.0.1":
        print("This is virtual host 1", file=stdout)
    elif host == "localhost":
        print("This is virtual host 2", file=stdout)
    else:
        print("Unknown virtual host", file=stdout)

    print("Hello world!", file=stdout)
    print(file=stdout)
    start_response(b"200 OK", [(b'Content-Type',b'text/plain; charset=utf-8')])
    return [stdout.getvalue().encode("utf-8")]

def test1():
    httpd = make_server('', 8000, my_app)
    print("Serving HTTP on port 8000...")

    # Respond to requests until process is killed
    httpd.serve_forever() 
```

# jquery - jQuery“长>”

> ID：781467
> 
> 赞同：0
> 
> 时间：2009-04-23T12:20:27.587
> 
> 标签：jquery, jquery-selectors

如何查询子容器，而不是容器内部（这与属性无关）

```
<div class="container">
   <div>
      <div class="container" child>
           <div>
              <div class="container" inside>
   <div>
      <div class="container" child>
           <div>
              <div class="container" inside>
</div> 
```

编辑：也许我可以使用 not() 之类的东西？

.container 不是（.container）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T12:47:19.630

我可能错过了重点，但我认为是这样的：

```
$(".container .container:not(.container .container .container)") 
```

即，所有元素都是“容器中的容器”，但不是“容器中的容器”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:24:48.060

```
$("div.container > div").find("div.container:first"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:25:47.467

您需要有一些东西来将类选择锚定到特定的 div。我建议给外面的一个名字。`children`然后，您可以使用带有类过滤器的方法通过名称找到外部的子项和子项。

```
$('#outerDiv').children('.container'); 
```

# hibernate - 休眠 DAO 实现

> ID：781468
> 
> 赞同：0
> 
> 时间：2009-04-23T12:20:28.883
> 
> 标签：hibernate, dao

任何人都可以建议 Web 应用程序的 DAO 实现吗？

如果我为基本操作（例如`findByID()`, `findALL()`, `createObject()`,`deleteObject()`等）创建事务会出现什么问题？

请建议一个支持惰性操作的 DAO 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T12:40:35.497

如果您使用[Hibernate Tools](http://tools.hibernate.org/)生成代码，则会自动为您生成基本的 DAO。你可以建立在它们之上。

无论如何，我用于交易的一些代码片段：

```
public void executeTransaction(Object[] parameters, Transact transact) throws ApplicationException
{
    Transaction tx = null;
    try
    {
        tx = HibernateSessionFactory.getSession().beginTransaction();
        transact.execute(parameters, tx);
        tx.commit();
        LOG.trace("executeTransaction() success");
    }
    catch (Exception e)
    {
        rollback(tx);
        throw new ApplicationException(e);
    }
}

private void rollback(Transaction tx) throws ApplicationException
{
    LOG.warn("rollback()");
    if (tx != null)
    {
        try
        {
            tx.rollback();
        }
        catch (Exception ex)
        {
            LOG.error("rollback() failure",ex);                
        }
    }
}

public interface Transact
{
    public void execute(Object[] parameters, Transaction tx) throws Exception;
}

void updateDistrictImpl(final Distretto district) throws ApplicationException, ApplicationValidationException
{    
try
{
    LOG.trace("updateDistrict[" + distrettoToString(district) + "]");

    executeTransaction(new Transact() {
        public void execute(Object[] parameters, Transaction tx) throws ApplicationException
        {
            DistrettoHome DistrettoDAO = new DistrettoHome();
            DistrettoDAO.attachDirty(district);
        }
        });
    LOG.info("updateDistrict[" + distrettoToString(district) + "] success!");
}
catch (ApplicationException e)
{
    LOG.error("updateDistrict() exception: " + e.getLocalizedMessage(), e);
    throw e;
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:59:15.187

有 3 个主要选项：

1) 在映射和查询中正确配置延迟加载：这并不总是最简单的方法，因为当您开发 DAO 时，您并不总是知道您的对象将如何在表示层中使用。

2) 使用 OpenSessionInView 模式：这样，您将能够在表示层中延迟加载相关对象。这可能是最简单的方法，因为它只需要一点点配置。但是要小心，因为延迟加载可能会非常昂贵，如果您在表示层中做了一些可疑的事情，您可能会遇到性能问题。您还可以从演示文稿中修改您的对象，这意味着更容易出现预编程错误。

3) 添加一个服务层，将您的 Hibernate 对象转换为值对象：这是最细粒度的选项，因为您还可以限制 wchi 属性暴露给演示文稿。您在服务调用周围保持事务边界，因此您可以确定在服务之外不会修改任何内容。

在所有情况下，您至少应该尝试正确配置延迟加载。否则你可能会遇到性能问题！

# powershell - 如何获取传递给函数的所有参数（与仅可选的 $args 相比）

> ID：781472
> 
> 赞同：29
> 
> 时间：2009-04-23T12:22:00.470
> 
> 标签：powershell, arguments

$args 只返回可选参数。如何获取所有函数参数？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-03T22:01:35.520

$PSBoundParameters 为您获取所有“绑定”的参数以及哈希表中的绑定值，它不会为您提供可选/额外参数。这就是 $args 的用途。AFAICT 获得您想要的东西的唯一方法是将两者结合起来：

```
$allArgs = $PsBoundParameters.Values + $args 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-23T18:00:31.160

$args 返回任何*未声明*的参数，而不是可选参数。所以不要声明参数。

在 PowerShell v2 中，您可以使用 $PSBoundParameters 以结构化方式获取所有参数。

# html - 如何在内部创建标签元素？

> ID：781473
> 
> 赞同：50
> 
> 时间：2009-04-23T12:22:14.230
> 
> 标签：html, forms, label, placeholder

我想在用户点击它时消失的输入元素中插入一个描述性文本。

我知道这是一个非常常见的技巧，但我不知道该怎么做..

什么是最简单/更好的解决方案？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2010-03-18T21:43:56.100

如果您使用的是 HTML5，则可以使用该`placeholder`属性。

```
<input type="text" name="user" placeholder="Username"> 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-23T12:25:18.107

```
<input name="searchbox" onfocus="if (this.value=='search') this.value = ''" type="text" value="search"> 
```

一个更好的例子是 SO 搜索按钮！我就是从那里得到这个代码的。查看页面源代码是一个有价值的工具。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2010-01-05T09:19:00.280

在我看来，最好的解决方案既不涉及图像也不涉及使用输入的默认值。相反，它看起来有点像 David Dorward 的解决方案。

对于没有 javascript 的屏幕阅读器和用户来说，它很容易实现和降级。

看看这里的两个例子：http: [//attardi.org/labels/](http://attardi.org/labels/)

我通常在我的表单上使用第二种方法（labels2）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-23T12:37:38.920

常见的做法是使用默认值作为标签，然后在字段获得焦点时将其移除。

我真的不喜欢这种方法，因为它具有可访问性和可用性影响。

相反，我会从使用字段旁边的标准元素开始。

然后，如果 JavaScript 处于活动状态，则在祖先元素上设置一个类，这会导致应用一些新样式：

*   相对定位包含输入和标签的 div
*   绝对定位标签
*   将输入绝对定位在标签顶部
*   删除输入的边框并将其背景颜色设置为透明

然后，每当输入失去焦点时，我都会测试输入是否有值。如果是，确保祖先元素有一个类（例如“隐藏标签”），否则确保它没有那个类。

每当输入获得焦点时，设置该类。

样式表将在选择器中使用该类名来隐藏标签（通常使用文本缩进：-9999px）。

这种方法为所有用户提供了良好的体验，包括禁用 JS 的用户和使用屏幕阅读器的用户。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-09-14T12:06:10.887

我已经将@Cory Walker 提出的解决方案与@Rafael 的扩展组合在一起，@Tex 女巫的一种形式对我来说有点复杂，并提出了一个有希望的解决方案

在禁用 javascript 和 CSS 的情况下防错。

它使用表单域的背景颜色来显示/隐藏标签。

```
<head>

<style type="text/css">
<!--
    input {position:relative;background:transparent;} 
-->
</style>

<script>
    function labelPosition() {
        document.getElementById("name").style.position="absolute"; 
            // label is moved behind the textfield using the script, 
            // so it doesnt apply when javascript disabled
    }
</script>

</head>
<body onload="labelPosition()">

<form>
        <label id="name">Your name</label>
        <input type="text" onblur="if(this.value==''){this.style.background='transparent';}" onfocus="this.style.background='white'">
</form>

</body> 
```

查看正在运行的脚本：http: [//mattr.co.uk/work/form_label.html](http://mattr.co.uk/work/form_label.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-12T06:40:10.060

请在所有浏览器中使用 PlaceHolder.JS 它的作品，对于非 html5 兼容的浏览器非常容易 [http://jamesallardice.github.io/Placeholders.js/](http://jamesallardice.github.io/Placeholders.js/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-04T18:38:00.327

```
<input name="searchbox" onfocus="if (this.value=='search') this.value = ''" onblur="if (this.value=='') this.value = 'search'" type="text" value="search"> 
```

也添加一个 onblur 事件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-05T09:31:54.150

当您开始输入时，它会消失。如果为空，它将再次出现。

```
 <%= f.text_field :user_email,:value=>"",:placeholder => "Eg:abc@gmail.com"%> 
```

最简单的方法...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-27T11:41:52.110

关于 HTML 属性*占位符*和标签*textarea*的一个提示，请确保`<textarea>`and之间没有任何空格`</textarea>`，否则*占位符*不起作用，例如：

```
<textarea id="inputJSON" spellcheck="false" placeholder="JSON response string" style="flex: 1;"> </textarea> 
```

这行不通，因为...之间有空格

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-18T21:33:36.297

用这个

风格：

```
<style type="text/css">
    .defaultLabel_on { color:#0F0; }
    .defaultLabel_off { color:#CCC; }
</style> 
```

html:

javascript:

```
function defaultLabelClean() {
    inputs = document.getElementsByTagName("input");
    for (var i = 0; i < inputs.length; i++)  {
        if (inputs[i].value == inputs[i].getAttribute("innerLabel")) {
            inputs[i].value = '';
        }
    }
}

function defaultLabelAttachEvents(element, label) {
    element.setAttribute("innerLabel", label);
    element.onfocus = function(e) {
        if (this.value==label) {
            this.className = 'defaultLabel_on';
            this.value = '';
        }
    }
    element.onblur = function(e) {
        if (this.value=='') {
            this.className = 'defaultLabel_off';
            this.value = element.getAttribute("innerLabel");
        }
    }

    if (element.value=='') {
        element.className = 'defaultLabel_off';
        element.value = element.getAttribute("innerLabel");
    }
}

defaultLabelAttachEvents(document.getElementById('MYID'), "MYLABEL"); 
```

请记住在提交表单之前调用 defaultLabelClean() 函数。

干得好

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-31T22:10:15.753

我认为保留标签而不使用上面提到的占位符是很好的。它对 UX 有好处，如下所述： [https ://www.smashingmagazine.com/2018/03/ux-contact-forms-essentials-conversions/](https://www.smashingmagazine.com/2018/03/ux-contact-forms-essentials-conversions/)

这里输入字段中带有标签的示例：codepen.io/jdax/pen/mEBJNa

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-10T02:07:29.880

你不需要一个Javascript代码......
我认为你的意思是占位符属性。这是代码：

```
<input type="text" placeholder="Your descriptive text goes here..."> 
```

默认文本将是灰色的，单击时它将消失！

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-04-23T14:10:48.167

这是一个简单的示例，它所做的只是覆盖图像（使用您想要的任何措辞）。我在某处看到了这种技术。我正在使用原型库，因此如果使用其他内容，您需要进行修改。在 window.load 之后加载图像，如果禁用 javascript，它会优雅地失败。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1;" />
    <meta http-equiv="Expires" content="Fri, Jan 1 1981 08:00:00 GMT" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <style type="text/css" >

        input.searcher
        {
            background-image: url(/images/search_back.png);
            background-repeat: no-repeat;
            background-attachment: scroll;
            background-x-position: left;
            background-y-position: center;
        }

    </style>

    <script type="text/javascript" src="/logist/include/scripts/js/prototype.js" ></script>
</head>
<body>
    <input type="text" id="q" name="q" value="" />

    <script type="text/javascript" language="JavaScript" >
    //  <![CDATA[
        function f(e){
            $('q').removeClassName('searcher');
        }

        function b(e){
            if ( $F('q') == '' )
            {
                $('q').addClassName('searcher');
            }
        }

        Event.observe( 'q', 'focus', f);
        Event.observe( 'q', 'blur', b);
        Event.observe( window, 'load', b);

    //  ]]>
    </script>
</body>
</html> 
```

# c++ - 如何在 Qt 中为 qmake 指定库文件依赖项？

> ID：781494
> 
> 赞同：9
> 
> 时间：2009-04-23T12:31:00.840
> 
> 标签：c++, qt, dependencies, qmake

有一个 SomeLib.pro 文件，其中包含：

```
CONFIG  += debug
TEMPLATE = lib
TARGET = SomeLib
.. 
```

然后在依赖的 SomeApp.pro 中：

```
..
debug:LIBS += -lSomeLib_debug
.. 
```

如果我在 qmake 中触摸 SomeLib，如何强制构建 SomeApp？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T22:07:36.853

这很难看，因为您需要提供确切的库文件名，但这应该可以：

TARGETDEPS += libfoo.a

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-20T08:19:43.407

如果您在应包含该库的项目的上下文菜单中单击“添加库...”，QT Creator 将完成这项工作。

这些变量会自动为您配置：

*   图书馆
*   包含路径
*   依赖路径
*   PRE_TARGETDEPS

另请参阅[http://doc.qt.digia.com/qtcreator-2.1/creator-project-qmake-libraries.html](http://doc.qt.digia.com/qtcreator-2.1/creator-project-qmake-libraries.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T13:53:37.367

在回复 Zahir 的评论时，可能值得指出的是，如果使用 DLL，则在 qmake 文件中说明这种依赖关系是不必要的，但如果您的 exe 依赖于静态库，则这是*必不可少的。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T12:58:20.930

`qmake`不提供这种能力。

相反，将您的应用程序和 lib 放在子目录中，然后在其父目录中创建一个 Makefile，如下所示：

```
all: FRC
    cd Somelib && qmake && $(MAKE) 
    cd SomeApp && qmake && $(MAKE)

FRC: 
```

然后总是`make`从这个目录运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-15T15:31:53.820

我用了：

```
POST_TARGETDEPS += c:/open-en/lib/win32mingw/libosal_based.a 
```

它可以工作，但是很笨拙，因为必须指定库的完整路径，这对于每个操作系统/编译器都不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T12:47:26.027

这肯定是不可能的，你说的是使用 qmake 进行反向依赖查找？那么在您对库 A 进行更改后，您想要它构建应用程序 B（以及任何其他依赖于库 A 的应用程序）？

这有点像说如果更新了 vbrun300.dll，则重新编译所有 Visual Basic 应用程序？

# jquery - jQuery 表单处理

> ID：781502
> 
> 赞同：1
> 
> 时间：2009-04-23T12:34:35.213
> 
> 标签：jquery, forms, object

我有一个产品选择页面，您可以在其中选择电话和使用单选按钮的计划，我需要 jQuery 来显示“当前选择”。例如，我有 2 部手机有两个计划：

诺基亚 N95 和诺基亚 N96，35 美元/月和 50 美元/月

这些“选项”中的每一个都有自己的单选按钮。选择N95和50美元/月计划计划时，我需要在DIV中显示此信息：

> 您当前的订单
> 电话：诺基亚 N95
> 计划：50 美元/月

任何帮助将不胜感激！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T12:52:04.750

```
$(document).ready(function() {
  $("div.plan").hide();

  $("input[type=radio]").click(function() {
    $("div.plan").hide();
    $("div[planid=" + $(this).val() + "]").show();
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<input type="radio" name="plan" value="1" /> Plan 1 <br />
<input type="radio" name="plan" value="2" /> Plan 2 <br />
<input type="radio" name="plan" value="3" /> Plan 3 <br />

<div class="plan" planid="1">Plan 1 details</div>
<div class="plan" planid="2">Plan 2 details</div>
<div class="plan" planid="3">Plan 3 details</div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:26:04.700

这应该非常灵活。它将使您不必提前定义所有组合，它将适应您在单选框中放置的任何选项。选择任一选项（计划/电话）后，它将立即显示摘要。您需要稍微清理一下，也许不使用单选项的值来获取要显示的字符串（推荐一个标签），但可以理解：

```
$(document).ready(function() {
  $("input[name=plan]").click(function() {
    $("#plan_details").html($(this).val());
    $("#summary").show();
  });
  $("input[name=phone]").click(function() {
    $("#phone_details").html($(this).val());
    $("#summary").show();
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div id="summary" style="display: none;">
  <strong>Phone:</strong><span id="phone_details">None Selected</span><br />
  <strong>Plan:</strong><span id="plan_details">None Selected</span>
</div>

<strong>Select Your Plan:</strong><br />
<input type="radio" name="plan" value="$35/month" />$35/month<br />
<input type="radio" name="plan" value="$50/month" />$50/month<br />

<strong>Select Your Phone:</strong><br />
<input type="radio" name="phone" value="Nokia N95" />Nokia N95<br />
<input type="radio" name="phone" value="Nokia N96" />Nokia N96<br />
```

# c# - ASP.NET C#：我应该使用哪种设计模式，为什么？

> ID：781510
> 
> 赞同：3
> 
> 时间：2009-04-23T12:40:29.927
> 
> 标签：c#, asp.net, design-patterns

我正在用 ASP.NET C# 开发一个应用程序并遇到以下场景：

1.  我将不得不为不同的实体（表格）创建一些维护屏幕
2.  这些实体在 UI 中基本上具有相同的行为：Search、GetById、Save、Create 和 GetAll
3.  实体可能具有不同的结构，即不同的属性（字段）

当我谈论 20 多个管理屏幕时，我可以利用哪种设计模式来最大程度地减少我必须编写的代码量？

我虽然想到了[桥接模式](http://en.wikipedia.org/wiki/Bridge_pattern)，但我对如何实现它有点困惑......

我正在使用的一些技术背景：

1.  ASP.NET 经典（n 层）
2.  LINQ to SQL 和 DAO 对象
3.  SQL 服务器 2005

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:44:46.517

对于一组只执行 CRUD（创建、读取、更新、删除）操作并且几乎没有业务逻辑方式的管理屏幕，我很想或多或少地避开设计模式并看看[asp .net 动态数据](http://www.asp.net/dynamicdata/)。如果您想尽量减少要编写的代码量，则尤其如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T12:44:58.263

这不是设计模式......但我强烈建议使用动态数据。Jonathan Carter 有一些很棒的文章：[http ://lostintangent.com/index.php?s=dynamic+data](http://lostintangent.com/index.php?s=dynamic+data)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T12:58:11.413

如果你真的只是在做一些像这样的基本操作：Search、GetById、Save、Create 和 GetAll，我建议你使用存储库。如果做错了存储库可能会变得非常糟糕和讨厌，但是如果您真的主要限于这组操作，那么您基本上已经描述了具有该组操作的存储库。

你会想看看你可以提取额外逻辑的方法，例如搜索，这样你就不会创建重复的逻辑。

只要您确保不让它们失控，存储库就很好且可测试。我给你这个警告只是因为我看到太多人从存储库中创建怪物类。

存储库与您的对象一起使用。它们基本上是处理数据持久性的中介。这种抽象允许您从其余代码中隐藏您如何持久化数据。在这种情况下，您的存储库的实现将使用 LinqToSql，因为我相信这就是您所说的。

有很多资源可以[解释存储库模式](http://weblogs.asp.net/fredriknormen/archive/2008/04/24/what-purpose-does-the-repository-pattern-have.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:10:05.580

你想要的不是设计模式。您正在寻找带有脚手架的 ORM。我使用并强烈推荐 SubSonic - [http://subsonicproject.com](http://subsonicproject.com)。您可以在此处阅读有关其脚手架功能的信息：http: [//subsonicproject.com/web-forms-controls/the-scaffold/](http://subsonicproject.com/web-forms-controls/the-scaffold/)

# jquery - 检测链接何时被激活 - 通过单击或选项卡并输入

> ID：781514
> 
> 赞同：6
> 
> 时间：2009-04-23T12:41:11.390
> 
> 标签：jquery, click, href, enter

只是想知道是否有人知道当用户单击链接或链接的选项卡并按回车时连接 jquery 以运行函数的方法。

我想拦截链接的激活并在页面更改之前执行一个操作，但我想在任何一种情况下都这样做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T13:16:03.990

'click' 事件将在这两种情况下触发，这将为您提供您想要的：

```
$('a').click(function(){
    alert('perform action here');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T13:17:55.470

实际上很简单......当在一个元素上按下回车键时，它就像在浏览器中的点击一样。不需要做任何特别的事情。

```
$('a.links_to_bind').bind('click', function() { 
    /* do your stuff... */
    return false;
}); 
```

**编辑：** 如果您希望在您的操作完成后更改页面，您可能需要向该页面添加一个条件语句`return false`。就像是：

```
if(everythings_good) {
    return true;
} else {
    return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:01:15.853

以下两个链接提供了有关您要处理的 jQuery 事件的信息。

jQuery 事件/按键：[http](http://docs.jquery.com/Events/keypress)
://docs.jquery.com/Events/keypress jQuery 事件/点击：[http ://docs.jquery.com/Events/click](http://docs.jquery.com/Events/click)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-27T20:03:10.237

```
$('a').keydown(function() {

return false;  // Prevent default action

}); 

$('a').keyup(function(event){

     if(event.keyCode == '13'){

             $(this).find('button.mychoice').click();

     }

}); 

// This does the trick for both IE and FF. 
```

# sql - SQL中转义字符串的标准函数

> ID：781515
> 
> 赞同：1
> 
> 时间：2009-04-23T12:42:37.847
> 
> 标签：sql, .net-2.0, escaping

我正在.NET2.0 中编写一个程序，我需要在使用它们之前对输入进行转义。不幸的是，标准参数方法系统在我使用的系统中不能完全工作。使用 ODBCCommand 类我不能放置一个？语句的选择部分中的参数（这是我正在做的一点点技巧所必需的）而不会出错，因此我需要手动转义可能包含或不包含单引号（'）的字符串。有什么建议么？

编辑 - 示例 SQL：

正如我所愿：

```
INSERT INTO TABLE_A (COLUMN_A, COLUMN_B)
SELECT (?, COLUMN_C)
FROM TABLE_B
WHERE COLUMN_D = ? 
```

因为它是：

```
INSERT INTO TABLE_A (COLUMN_A, COLUMN_B)
SELECT ('INPUT_VALUE_HERE', COLUMN_C)
FROM TABLE_B
WHERE COLUMN_D = ? 
```

编辑：Sybase ASE 是 DB 驱动程序，通过 ODBC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T12:54:21.080

您可以使用此扩展函数解析字符串参数

```
public static string SqlEncode(string str)
{
    if (str == null) return String.Empty;
    return str.Replace("'","''");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T12:46:32.127

```
Dim s As String = "Michael O'Flatley"
Dim escapedString as String = s.Replace("'", "''") 
```

# hibernate-validator - 为什么 Hibernate Validator @NotEmpty 会产生重复的消息？

> ID：781516
> 
> 赞同：1
> 
> 时间：2009-04-23T12:42:46.333
> 
> 标签：hibernate-validator

在使用 Hibernate Validator时，我注意到`@NotEmpty`和`@NotNull`注释在.`InvalidValue``getInvalidValues(...)`

如果我指定一条类似 的消息`@NotEmpty(message = "My error message.")`，那么我将得到一个“我的错误消息”的 InvalidValue。和第二个“可能不为空或为空”

如果我不包含消息（例如单独包含消息`@NotEmpty`），那么我会得到两个 InvalidValue 副本，其中包含“可能不是 null 或空”的消息字段。

为什么 Hibernate Validator 会这样做？我不应该收到一条消息，要么是我使用参数覆盖的值，要么是默认消息，但不能同时收到两者？

* * *

*有关更多上下文：*

我正在扩展`ClassValidator<T>`我自己的`ClassValidator<MyClass>`实现。我这样做是为了添加一些**无法通过 annotation 完成的**自定义验证。我需要查看类的多个属性的运行时值以确定验证。

当我调用我覆盖的 myClassValidator.getInvalidValues() 时，我得到了验证。在我的实现中，`getInvalidValues()`我调用`super.getInvalidValues()`以创建初始错误列表，然后将自定义错误添加到该列表中。在任何情况下，调用都`super.getInvalidValues()`包含重复的消息，一个与传递到注释的消息属性匹配，另一个与注释消息的库存值匹配。

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T15:02:39.863

贾斯汀，

在过去的几个月里，我一直在使用 Hibernate Validator。虽然我没有遇到您描述的相同问题，但我也没有扩展`ClassValidator`. 对于自定义验证，[Hibernate 参考指南](http://docs.jboss.org/hibernate/stable/validator/reference/en/html/validator-defineconstraints.html#validator-defineconstraints-own)指出编写自定义约束是要走的路。

我已经能够几乎完全在我当前的项目中使用内置约束。在一种情况下，我需要对整数字段进行一些非常具体的计算，我编写了参考指南中描述的自定义约束；轻而易举。

谈到你的具体问题，我写了一个简单的测试应用程序作为我的一种健全性检查：

```
import org.hibernate.validator.*;

public class HibernateValidatorTest {
    @NotEmpty
    @NotNull
    private String validateMe;

    public static void main ( String[] args ) {
        ClassValidator<HibernateValidatorTest> validator = 
            new ClassValidator<HibernateValidatorTest>( HibernateValidatorTest.class ); 

        InvalidValue[] inVals = 
            validator.getInvalidValues( new HibernateValidatorTest() );

        for ( InvalidValue inVal : inVals ) {
            System.out.println( inVal.getMessage() );
        }
    }
} 
```

使用该字段上的两个 Hibernate 约束`validateMe`，控制台输出为：

```
may not be null or empty
may not be null 
```

删除一个或另一个具有仅将一条消息打印到控制台的预期效果。

我希望这是有帮助的。

布赖恩·T·格兰特

# c# - 这是在 linq 中插入关系的正确方法吗

> ID：781517
> 
> 赞同：2
> 
> 时间：2009-04-23T12:44:28.763
> 
> 标签：c#, linq-to-entities

我是 linq 的新手，我正在尝试编写更新语句。

我有两个表，tblProject 和 tblPage。两者通过 tblPage 中的外键链接。

因此，当尝试在 tblPage 中创建一行时，我有这个查询

```
 public void CreatePage(int projectId, string pageName, DateTime createdDate, int createdBy, DateTime updatedDate, int updatedBy)
    {
        using (EverythingEngineEntities db = new EverythingEngineEntities())
        {
            Page page = new Page();
            page.Project = db.ProjectSet.Single(p => p.ProjectId == projectId);
            page.LastUpdatedBy = updatedBy;
            page.LastUpdatedDate = updatedDate;
            page.CreatedBy = createdBy;
            page.CreatedDate = createdDate;
            page.PageName = pageName;
        }
    } 
```

我想知道的是这是通过 linq to Entities 插入行的正确方法。

对不起，如果这些都没有意义:)

编辑：

如果这条线是正确的方式，我特别感兴趣

```
page.Project = db.ProjectSet.Single(p => p.ProjectId == projectId); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T12:48:08.863

你几乎完成了......你必须实际插入它......（你已经创建了它，这是第 1 步）。

代码类似于：

```
db.Pages.InsertOnSubmit(page);
db.SubmitChanges(); 
```

我意识到那里是 LINQ to SQL 语法......但 EF 非常接近。

编辑：我很接近......对于 EF 它是

```
db.Pages.Add(page); 
```

EDIT2：顺便说一句，我忘了提到，如果你做的事情和上面一样简单，你不必点击服务器**。**我很确定你可以在 EF 中做这样的事情：

```
page.Project.ProjectID = projectID; 
```

所以你不必下载“db.ProjectSet.Single”来重新插入它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-28T13:59:08.963

我认为您的方式是正确的，但您的方式会产生额外的呼叫。

你可以更换

```
page.Project = db.ProjectSet.Single(p => p.ProjectId == projectId); 
```

和

```
 page.ProjectReference.EntityKey = new EntityKey("EverythingEngineEntities.Project", "ProjectID", projectId); 
```

[读这个](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/05/15/setting-an-entityreference-using-an-entitykey-in-entity-framework.aspx)

# localization - 本地化 InstallShield 注册表项的最简单方法

> ID：781521
> 
> 赞同：0
> 
> 时间：2009-04-23T12:45:53.407
> 
> 标签：localization, vbscript, registry, installshield

根据 InstallShield 设置的所选语言本地化注册表项的最简单方法是什么？

我正在考虑编写一个基于所选语言设置一些属性的 VBS。这些属性可以在 InstallShield 的注册表项对话框中使用。但是没有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T09:11:34.497

自己找到了办法。

您可以添加两个组件，而不是编写 vbscript。第一个组件添加了英文注册表项，第二个组件添加了德文注册表项。为了在安装过程中只使用正确的组件，您可以将德语组件的条件设置为“ProductLanguage=1031”，将英语组件的条件设置为“ProductLanguage=1033”。

就这样 ：）

当然，使用多个组件或更改仅由一个组件使用的属性的脚本是否更有意义是有争议的，但是通过使用多个组件，您可以通过设计器创建注册表项。使用更改属性的脚本肯定会导致更多错误，因为脚本必须工作并且必须正确设置每个属性。在我看来，使用组件方式更简单。

# c# - 条件方法调用条件方法在 C# 中不起作用

> ID：781524
> 
> 赞同：1
> 
> 时间：2009-04-23T12:46:32.563
> 
> 标签：c#, .net, debugging, logging, conditional

我正在尝试使用一些条件来增强我的 Logger 类，以控制要记录的内容和记录的位置。我有两种日志记录功能：

```
public static class Logger
{
    [Conditional("Logging"), Conditional("VerboseLogging")]
    public static void Log(string msg, string filename)
    {
        // log to file
    }

    [Conditional("VerboseLogging")]
    public static void VerboseLog(string msg, string filename)
    {
        Log(msg, filename); // just defer call to Log(string msg)
    }
} 
```

但是，运行以下程序

```
#define Logging
#define VerboseLogging

static void Main(string[] args)
{
    Logger.Log("Logging", "");
    Logger.VerboseLog("VerboseLogging", "");
} 
```

仅产生输出“Logging”，缺少“VerboseLogging”。

调试应用程序显示 VerboseLogging 确实被调用，但它没有调用`Log(msg, filename)`. 调试器只是直接跳过函数调用到函数的末尾`VerboseLog()`。

当我从`Log(string msg)`方法中删除条件时，它就起作用了。

有没有人知道为什么会发生这种情况或该怎么做才会被调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:24:59.617

Note that you need to define `Logging` and `VerboseLogging` in your `Logger` file also, because `VerboseLog` will not call `Log` if `Logging` is not defined there.

To add a project-wide conditional define, right click on your Project, and select Project Properties. Then go to the Build tab and enter "Logging, VerboseLogging" to the "Conditional compilation symbols" text box.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:49:51.730

条件不是颠倒了吗？IE

```
[Conditional("Logging")]
public static void Log(string msg, string filename) { }

[Conditional("Logging"), Conditional("VerboseLogging")]
public static void VerboseLog(string msg, string filename) {
    Log(msg, filename); // just defers call to Log()
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:13:06.447

没有真正的帮助，但是您发布的代码在这里对我来说很好（.NET 3.5 SP1 控制台应用程序）。当然，我需要删除文件名参数，因为您在 main 中的调用不提供它，但除此之外，两个定义都给了我日志并删除了详细定义，只记录了“日志记录”。

将奥卡姆剃刀应用于问题：由于您发布的代码显然不是直接来自您的源（没有日志方法的主体和缺少的参数），您*确定*您在原始源中正确拼写了定义吗？除此之外，我不知道为什么它不适合你......

# authentication - Maven 服务器身份验证作为配置文件属性

> ID：781527
> 
> 赞同：3
> 
> 时间：2009-04-23T12:47:28.413
> 
> 标签：authentication, maven-2, settings, profiles

我正在尝试在构建服务器上设置共享身份验证系统。我们有几个 maven 项目，它们声明了应该如何针对我们拥有的不同团队进行部署（每个团队都有自己的身份验证用户/密码）：

```
<profile>
  <id>release-profile</id>
  <distributionManagement>
    <repository>
        <id>rep-releases</id>
        <name>rep-releases</name>
        <url>http://somewhere-releases</url>
    </repository>
    <snapshotRepository>
        <id>rep-snapshots</id>
        <name>rep-snapshots</name>
        <url>http://somewhere-snapshots</url>
    </snapshotRepository>
  </distributionManagement>
</profile> 
```

然后我在 settings.xml 中声明对声明的服务器的身份验证如下：

```
<servers>
  <server>
    <id>rep-releases</id>
    <username>${release.user.name}</username>
    <password>${release.user.password}</password>
  </server>     
  <server>
    <id>rep-snapshots</id>
    <username>${release.user.name}</username>
    <password>${release.user.password}</password>
  </server>      
</servers> 
```

最后，根据我要部署的项目，我在构建服务器的 settings.xml 中定义了几个配置文件：

```
<profile>
  <id>dep-team1</id>
  <activation>
    <activeByDefault>false</activeByDefault>
  </activation>
  <properties>
    <release.user.name>team1-user</release.user.name>
    <release.user.password>team1-password</release.user.password>
  </properties>
</profile> 
```

问题是，在部署项目时，我遇到了如下的身份验证错误（HTTP 401）：

```
Error deploying artifact: Failed to transfer file: http://......./my-project-0.2-20090423.123247-3.pom. Return code is: 401 
```

如果我通过将属性替换为团队的用户/密码来修改服务器身份验证，则一切正常。

标签 <servers><server> 不接受值作为属性吗？

其他人如何设置他们的构建系统以实现相同的目标？

谢谢你的帮助。

**编辑：**我正在使用 hudson，我的解决方案可以是安装多次 maven2 并为每个团队设置重复的设置（用户/密码除外），并将每个项目与良好的 maven 安装联系起来。我必须承认这个解决方案不会让我着迷......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T21:14:06.217

如果您有多个团队并因此有多个身份验证方案，那么最简单和最直接的方法就是在 distributionManagement 中使用不同的 id。因此，您可以使用 team1-repo / team2-repo 而不是 rep-releases/rep-snapshots（将发布和快照之间的身份验证分开通常没有价值……特别是如果您使用具有良好安全控制的[repo 管理器）](http://nexus.sonatype.org)

然后在您的构建机器的设置中，只需为构建服务器的每个团队定义一个用户和密码。

这种方法确实有一个缺点，如果您在单个公司 pom 中定义 repos，它会弄乱继承......但如果您有一个团队级别的 pom，那就很容易了。

另一个想法是为什么同一台构建机器在构建时需要以不同的人身份登录？那台构建机器不应该具有完全访问权限吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:37:28.193

首先，我看不到 dep-team1 配置文件如何连接到 distributionManagement 标签 - 它似乎需要 release-profile 才能激活。

其次，我的配置文件元素的结构有点不同（请参阅，其中没有 distributionManagement 标记）。不确定它是否有所作为。：

```
<profile>
  <id>release-profile</id>
  <repositories>
    <repository>
      <id>central</id>
      <url>http://central</url>
      <releases><enabled>true</enabled></releases>
      <snapshots><enabled>true</enabled></snapshots>
    </repository>
  </repositories>
</profile> 
```

这是分发管理：

```
<project>
   <distributionManagement>

    <repository>
      <id>releases</id>
      <url>http://myurl/releases</url>
    </repository>

    <snapshotRepository>
      <id>snapshots</id>
      <url>http://myurl/snapshots</url>
    </snapshotRepository>

  </distributionManagement>
</project> 
```

# java - Java 的动态代理实际上是如何工作的？

> ID：781528
> 
> 赞同：11
> 
> 时间：2009-04-23T12:47:42.513
> 
> 标签：java, proxy

我了解如何在 Java 中使用动态代理，但我不明白虚拟机实际上是如何创建动态代理的。它会生成字节码并加载它吗？或者是其他东西？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T12:55:27.147

至少对于 Sun 的实现，如果您查看源代码，`java.lang.reflect.Proxy`您会发现是的，它会即时生成字节码（使用 class `sun.misc.ProxyGenerator`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T12:50:29.777

我建议您阅读[动态代理类](http://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html)：

> Proxy.getProxyClass 方法返回给定类加载器和接口数组的代理类的 java.lang.Class 对象。代理类将在指定的类加载器中定义，并将实现所有提供的接口。如果在类加载器中已经定义了相同的接口排列的代理类，则返回现有的代理类；***否则，这些接口的代理类将动态生成并在类加载器中定义。***[强调我的]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-12T08:38:12.917

代理类是动态生成**的**（因此是动态代理）**并由**类加载器加载。这就是为什么如果您调试依赖于 JDK 代理的应用程序，您会看到一堆名为“ **com.sun.proxy.$Proxy0** ”的类。

要测试我的理论，您可以使用[动态代理类](https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html)中的示例以及 VM 参数**-verbose:class**，它将告诉您类加载器加载的类，您会注意到加载的类中**com.sun.proxy.$Proxy0**。

# c# - 您在 Web 应用程序中使用锁定吗？

> ID：781532
> 
> 赞同：1
> 
> 时间：2009-04-23T12:48:33.090
> 
> 标签：c#, asp.net

发布此问题后：

[如何在 C# 中锁定整数？](https://stackoverflow.com/questions/781189/how-to-lock-on-an-integer-in-c)

许多答案让我觉得我是在我的网络应用程序中使用锁定的“罪人”。我从没想过这是个问题（如果使用得当），你呢？你曾经在你的网络应用程序中使用过它吗？

我看不出如何在没有锁定的情况下编写 Web 应用程序，例如，如果您想从数据库中加载一些数据并且您想确保没有其他线程会加载它（也适用于单例），通常您使用锁定， 例如：

```
private _locker =  new object();
private YourClass[] _data;
public YourClass[] Data
{
    get
    {
        if(_data == null)
        {
            lock( _locker)
            {
                // get your data
               _data = GetYourData();
            }
        }
        return _data;
    }
} 
```

这有问题吗？！

编辑：

请注意，我在这里指的是单个服务器场景，对于服务器场，您需要一些分布式锁定机制，但您不会期望您创建的每个站点在几周内获得数百万次点击，是吗？如果您需要锁定，是否应该使用分布式锁定创建您的站点，对于您不知道是否需要扩展的应用程序来说，这不是太多了吗？除了这些天计算机变得非常快之外，一台服务器可以处理大量的流量，这已经被证明了很多次，一些例子是很多的网站和你现在正在使用的这个网站，做一些谷歌搜索，我敢肯定你会遇到很多其他人。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T12:51:35.813

如果您使用锁来尝试控制对*远程*资源（例如数据库中的某些内容）的访问，那么当您尝试扩展到更多服务器时就会遇到问题。

如果您只想拥有一个`AppDomain`特定的锁（例如用于缓存），那么它非常有意义。

我不同意您暗示的断言，即如果没有锁定（在 Web 服务器级别）就无法编写 Web 应用程序。这实际上取决于应用程序 - 通常数据库争用是在数据库而不是 Web 服务器上处理的，因此您可以在 Web 层中拥有多台机器。

对于单例来说，它有一定的意义，但无论如何我很少使用单例......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T13:00:25.307

是的，您需要再次检查数据。被称为双重检查锁。[http://en.wikipedia.org/wiki/Double_checked_locking_pattern](http://en.wikipedia.org/wiki/Double_checked_locking_pattern)

从理论上讲，第二个线程可以在创建锁之前通过您的第一次空检查。

```
 if(_data == null)
    {
        lock( _locker)
        {
            if (_data == null) {
              // get your data
              _data = GetYourData();
           }
        }
    } 
```

在网络应用程序中执行此操作是个坏主意，除非您真的、真的知道自己在做什么。

我会研究可升级[锁](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.enterupgradeablereadlock.aspx)[http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.enterupgradeablereadlock.aspx](http://msdn.microsoft.com/en-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T12:57:21.463

我不知道你是如何进行数据访问的，但我从来没有发现它只需要为一个请求锁定数据库。我不确定，但我可以想象您会尝试使用 Microsoft Access 数据库解决某些问题，但这只是因为它不是用于网站（或任何离开本地桌面的东西）的好数据库系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T12:52:30.880

在请求中的某个时间点锁定本地有争议的资源是可以的（尽管很少见）。锁定一个请求并尝试在多个请求之间保持锁定实际上并不能很好地工作。即使您可以让它在单个服务器环境中工作，如果您必须扩展到多服务器环境，那么它也不会按照您期望的方式工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T12:56:41.463

您尝试访问的远程资源应该负责锁定。正如有人已经指出的那样，锁是进程范围的，一旦你扩大你的锁将无法工作。

数据库还应该完成您需要的所有锁定。这是 DBMS 的主要要求之一：数据完整性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T13:17:10.307

我从来不需要在我的任何 web 应用程序上使用任何同步机制。除非您正在处理多个会话正在更改的原始 XML 文件，否则我看不出需要它。就像这里的大多数人所说的那样 - 您的数据库会为您处理这些问题。更新、查询、您拥有什么、数据库系统（至少是您可能与 ASP.NET 一起使用的系统）为您处理同步。

# c++ - Borland C++ Builder 6 上的奇怪链接器错误

> ID：781533
> 
> 赞同：0
> 
> 时间：2009-04-23T12:48:43.760
> 
> 标签：c++, linker-errors, c++builder

我一直在尝试编译 Borland C++ Builder 6 项目，但链接器因以下错误而死：

```
[Linker Fatal Error] Fatal: Unable to open file '.OBJ' 
```

奇怪的是它除了扩展名之外没有给出任何文件名。它看起来像一个内部错误，尽管谷歌搜索它没有给出任何结果。有没有人遇到过这个错误？

== 已解决 ==

它实际上是导致链接器命令行损坏的源文件之一中的无效编译器指令。感谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T13:22:58.903

检查链接器命令行中的非法空白字符。

如果您没有找到，请在此处发布您的链接器命令行（在项目 -> 选项 -> 链接器 -> 命令行中找到我的头顶）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:00:57.257

我从未使用过 Borland C++ Builder，但这听起来像是一个损坏的项目或损坏的目标文件——我猜你没有任何编译错误。您可能需要采取一些步骤：
- 重建项目
- 检查用于调用链接器的确切命令行，并在自定义项目设置中寻找奇怪的东西（存在这样的东西）。

如果您确实在命令行中发现了一些奇怪的东西，那么在构建新项目之前，手动编辑项目文件（孩子们，不要在家里这样做）以删除有问题的部分可能是最后的手段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:29:47.687

我以前在visual studio中看到过这个，通常如果我在链接过程中停止编译器构建，不确定borland是否在链接过程中生成obj文件？在您的项目目录中搜索，并删除可能在名为“intermediate”的文件夹中的 obj 文件，然后重试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T23:12:25.357

我怀疑命令行中有空格或其他字符，例如 - 或 +。

# selenium - bsd 中的 selenium-rc

> ID：781538
> 
> 赞同：0
> 
> 时间：2009-04-23T12:50:19.340
> 
> 标签：selenium, selenium-rc, bsd

我试图在 bsd 中运行 selenium-rc 并得到以下错误

```
12:45:40.740 WARN - POST /selenium-server/driver/ HTTP/1.1
java.lang.RuntimeException: Firefox couldn't be found in the path!
Please add the directory containing 'firefox-bin' to your PATH environment
variable, or explicitly specify a path to Firefox like this:
*firefox /blah/blah/firefox-bin 
```

将 firefox-bin 添加到我的路径没有帮助。第二个选项是什么？（“或像这样明确指定 Firefox 的路径”）

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-26T18:14:13.457

尝试通过将“*firefox”替换为“*firefox /path/to/firefox-bin”来指定路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T01:52:12.450

在我的 ubuntu 9.04 设置中，我将“/usr/lib/firefox-3.0.11”添加到我的 $PATH

# sql - LINQ To SQL 分页

> ID：781545
> 
> 赞同：9
> 
> 时间：2009-04-23T12:52:28.417
> 
> 标签：sql, linq-to-sql, paging

我已经在 LINQ To SQL 中使用 .Skip() 和 .Take() 扩展方法有一段时间了，没有任何问题，但在我使用它们的所有情况下，它始终用于单个表 - 例如：

```
database.Users.Select(c => c).Skip(10).Take(10); 
```

我的问题是我现在正在从多个表中投影一组结果，并且我想在整个集合上进行分页（并且仍然可以在数据库中获得分页的好处）。

我的实体模型如下所示：

**一个活动[有很多]组，一个组[有很多]联系人**

这是通过数据库中的关系建模的，例如

**活动 -> CampaignToGroupMapping -> 组 -> GroupToContactMapping -> 联系人**

我需要生成一个包含活动详细信息的数据结构，以及通过 CampaignToGroupMapping 与活动关联的每个联系人的列表，即

```
Campaign
   CampaignName
   CampaignFrom
   CampaignDate
   Recipients
      Recipient 1
      Recipient 2
      Recipient n... 
```

我曾尝试使用 .SelectMany 编写一个 LINQ 查询，将每个组中的一组联系人投影到一个线性数据集中，希望我可以从中 .Skip() .Take() 。

我的尝试是：

```
 var schedule = (from c in database.Campaigns
                 where c.ID == highestPriority.CampaignID
                 select new PieceOfCampaignSchedule
                 {
                     ID = c.ID,
                     UserID = c.UserID,
                     Name = c.Name,
                     Recipients = c.CampaignGroupsMappings.SelectMany(d => d.ContactGroup.ContactGroupMappings.Select(e => new ContactData() { /*Contact Data*/ }).Skip(c.TotalSent).Take(totalRequired)).ToList()

                 }).SingleOrDefault(); 
```

问题是分页（关于 Skip() 和 Take()）发生在每个组，而不是整个数据集。

*这意味着，如果我为参数totalRequired* （传递给 .Take()）使用值 200，并且我有 3 个与此活动相关联的组，则每组将需要 200 - 而不是从与活动。

在 SQL 中，我可以通过如下查询来实现：

```
select * from
(
    select [t1].EmailAddress, ROW_NUMBER() over(order by CampaignID desc) as [RowNumber] from contacts as [t1]
    inner join contactgroupmapping as [t2] on [t1].ID = [t2].ContactID
    inner join campaigngroupsmapping as [t3] on [t3].ContactGroupID = [t2].GroupID
    where [t3].CampaignID = @HighestPriorityCampaignID

) as [Results] where [Results].[RowNumber] between 500 and 3000 
```

使用此查询，我正在对与特定活动相关联的每个组的联系人组合集进行分页。所以我的问题是，如何使用 LINQ To SQL 语法来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T16:23:31.453

要模仿您提供的 SQL 查询，您可以这样做：

```
var schedule = (from t1 in contacts
                join t2 in contactgroupmapping on t1.ID equals t2.GroupID
                join t3 in campaigngroupsmapping on t3.ContactGroupID = t2.GroupID
                where t3.CampaignID = highestPriority.CampaignID
                select new PieceOfCampaignSchedule
                {
                  Email = t1.EmailAddress
                }).Skip(500).Take(2500).ToList() 
```

您是否正在尝试翻阅活动、收件人或两者？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:55:31.623

使用视图聚合来自多个表的结果，然后在视图上使用 LINQ

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:23:25.297

我认为您的尝试非常接近；也许我错过了一些东西，但我认为你只需要在 Skip/Take 之前关闭你的 SelectMany() ：

```
Recipients = c.CampaignGroupsMappings.SelectMany(d => d.ContactGroup.ContactGroupMappings.Select(e => new ContactData() { /*Contact Data*/ })).Skip(c.TotalSent).Take(totalRequired).ToList() 
```

注意：在“/* Contact Data */ })”之后添加“)”并从“.Take(totalRequired)”之后删除“)”

# javascript - TinyMCE：使用 CSS 类属性和 formatselect-dropdown 格式

> ID：781549
> 
> 赞同：3
> 
> 时间：2009-04-23T12:53:33.140
> 
> 标签：javascript, richtextbox, tinymce, richtextediting

我想自定义TinyMCE格式[选择下拉列表中](http://wiki.moxiecode.com/index.php/TinyMCE:Control_reference)[的格式](http://wiki.moxiecode.com/index.php/TinyMCE:Configuration/theme_advanced_blockformats)以支持 css 类属性。

示例：如果希望能够在 formatselect 下拉列表中进行选择`<h2 class='foo'>`，而不是仅选择`<h2>`格式。

这里有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T16:49:03.233

[根据其主要开发人员](http://tinymce.moxiecode.com/punbb/viewtopic.php?id=15914)的说法，在当前的 TinyMCE 版本中没有聪明的方法可以做到这一点：

> 我们有一个高级样式格式插件的计划。这样您就可以在 JSON 样式结构中指定格式、样式、容器、包装器等。
> 
> 最好的祝福，
> 
> Spocke - TinyMCE 的主要开发者

...虽然有一种“不聪明”的方式来实现这一点：

`h2.foo`TinyMCE 中定义的 CSS 类`content_css`将在[styleselect 下拉列表](http://wiki.moxiecode.com/index.php/TinyMCE:Control%5Freference)中显示为*foo*。

您现在可以选择-text 并从 styleselect 下拉列表中`<h2>`选择样式*foo 。*这导致`<h2 class='foo'>`.

# c# - DataBinding DataGridview 行 BackColor

> ID：781550
> 
> 赞同：1
> 
> 时间：2009-04-23T12:54:02.233
> 
> 标签：c#, winforms, data-binding, datagridview

我有一个使用数据绑定的 DataGridView，带有手动创建的列，这很好用。

但是，我希望行的 BackColor 也可以数据绑定，到目前为止，我的尝试遇到了错误。

这是我最近的尝试：

```
dataGridFileTransfer.RowHeadersVisible = false;
dataGridFileTransfer.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill;
dataGridFileTransfer.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
dataGridFileTransfer.MultiSelect = false;
dataGridFileTransfer.ReadOnly = true;
var files = GetReceivedFiles(false).Union(FileDetails.Select(FileStatus.FailedVerification)).ToList();
dataGridFileTransfer.AutoGenerateColumns = false;

string[] displayHeaders = new string[] { COL_NAME, COL_TYPE, COL_CREATED, COL_SIZE, COL_STATUS };
string[] displayProps = new string[] { "Filename", "FileTypeDisplayName", "Created", "Size", "FileStatus" };

for (int i = 0; i < displayHeaders.Length; i++)
{
  DataGridViewTextBoxColumn col = new DataGridViewTextBoxColumn();
  col.HeaderText = displayHeaders[i];
  col.DataPropertyName = displayProps[i];

  if (displayHeaders[i] == COL_CREATED)
    col.DefaultCellStyle.Format = Constants.DDMMYYYHHMMSS;

  dataGridFileTransfer.Columns.Add(col);
}

Binding bi = new Binding("DefaultCellStyle.BackColor", files, "DisplayColor");
dataGridFileTransfer.DataBindings.Add(bi);

dataGridFileTransfer.DataSource = files; 
```

正在生成 ArguementException：

> “无法绑定到目标控件上的属性“DefaultCellStyle.BackColor”。参数名称：PropertyName"

是 PropertyName 的值错误，还是应该绑定到 DataGridView 以外的对象？（即一列？）还是PropertyName 不能采用XY 形式的问题？我以为我以前见过/使用过这种语法，但也许它只适用于 DataMember？

任何帮助深表感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:21:44.400

I think the problem is `files.DisplayColor`. `files` is a collection an has no property `DisplayColor` but each item of the collection has. So you are trying to bind a not existing property. Further binding collection `DataGridView.DataBindings` allows you to data bind properties of the control, not of its rows. There is only one `DataGridView.DefaultCellStyle.BackColor` for all rows. So I believe you end up needing to bind the `DefaultCellStyle` of each row to the coresponding item from `files` and I am not sure if this is possible. It might be that the `DataGridView` creates and deletes rows as required - for example if you perform filtering - and this will destroy the data binding, too.

So, I am not sure if row coloring can be done with data binding, but I personaly doubt it. This would require some really smart logic recognicing 'bind the property `DisplayColor` of the object data bound to this row to the property `DefaultCellStyle.BackColor` of this row.'

You could surly implement such an smart data binding. While it would be a great thing, it will be quite complex, too. As a simple solution you could just use the `RowPrepaint` event to set the correct color for the row.

# mbunit - MbUnit 3.0 单独下载

> ID：781552
> 
> 赞同：1
> 
> 时间：2009-04-23T12:55:04.167
> 
> 标签：mbunit

我想获得 MBUnit 3.0，但没有 Gallio 捆绑.. 不确定这样的包是否可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:08:34.913

如果您想以其他方式运行 MbUnit 程序集而不是使用 Gallio，则可以下载该捆绑包，然后只需提取 MbUnit 程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T20:30:28.217

Gallio 有一个插件架构。因此，虽然 MbUnit 基于 Gallio，但您不需要安装所有额外的插件，除非您需要它们。所需组件的最小集相当小。

正如罗德里戈所说，有一个 ZIP 文件分发可用，不需要安装即可使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:11:58.040

[从此处](http://code.google.com/p/mb-unit/downloads/list)获取 zip (GallioBundle-3.0.6.763.zip) 文件并仅获取 MBUnit 程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:03:11.637

不幸的是，MbUnit 基于 Gallio，因此无法单独获取它们。

# c# - Java中的接口

> ID：781558
> 
> 赞同：-1
> 
> 时间：2009-04-23T12:56:36.410
> 
> 标签：c#, java, interface

在 C# 中，通常有这样的方法：

```
public IPerson GetPerson()
{
  // do stuff
  return new Person(..);
} 
```

其中 " `IPerson`" 是 , 等使用的接口`Person`。`SpecialPerson`换句话说，尽管上面的方法返回 a `Person`，但可以实现一种策略模式，以便`SpecialPerson`返回 a 代替 a `Person`，前提是它们都使用该`IPerson`接口。

这种事情在Java中可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T12:57:56.297

是的。Java也有接口。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T14:57:17.273

是的，它几乎是一样的......例如：

```
// Interface
public interface IPerson {
    public String getName();
}

// Implementation of interface - NB "implements" keyword
public class Person implements IPerson {
    private final String myName;

    public Person(String name) {
        myName = name;
    }

    public String getName() {
        return myName;
    }
}

// Method returning interface
public IPerson getPerson(String name) {
    return new Person(name);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T12:58:55.827

我相信这几乎是一样的，除了 Java 使用接口的“implements”关键字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T12:58:57.043

是的，Java 和 C# 一样有接口：

```
public interface IPerson {
   ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T13:25:38.743

Java 等价物是：

```
public Person getPerson()
{
  // do stuff
  return new SpecialPerson(..);
} 
```

Java 接口在哪里`Person`（接口名称前加字母“I”是 COM 编程的约定，因此不适用于 Java）。

# vmware - 哪个 vmware 服务器是更好的选择，哪个主机操作系统（用于 QE）

> ID：781580
> 
> 赞同：0
> 
> 时间：2009-04-23T13:01:52.997
> 
> 标签：vmware

我们正在建立新的 QE 测试服务器。我猜主机操作系统是win2008

选择哪个 vmware 服务器 - 1.x 或 2.x？

一年前，我用 Win2008 尝试了 vmware 1 服务器，但它根本不起作用。

但是，Vmware server 2 似乎没有方便的 vmware 控制台 VMware Server Console\vmware.exe（新的 vmware server2 仍然只是基于 Web 的吗？）

我们有很多 vmware 1 映像，这些适用于 v2 吗？

还是使用 HyperV 更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:11:40.460

Hyper-V 服务器或 ESXi 可能是性能最佳且最无故障的选项 - 即虚拟化并不真正依赖于主机操作系统（但仍然免费）。

您可以使用[Vmdk2Vhd](http://vmtoolkit.com/blogs/announcements/archive/2006/11/20/vmdk-to-vhd-converter-available.aspx)等工具来转换图像文件。请注意，您应该先以旧格式启动映像，并在转换之前卸载 vmware 工具和某些驱动程序，例如特定的磁盘控制器驱动程序（根据工具的说明）。

走企业路线，System Center Virtual Machine Manager 可以自动执行此操作，但它不再是免费的解决方案 :) 该平台当然也可以为您进行物理到虚拟的迁移......

...但是唉，您可以像转换 vmware 映像之前一样准备物理机，然后使用普通的映像工具将其克隆到虚拟机中。或者您可以使用 Vmware 的[免费转换器工具](http://www.vmware.com/products/converter/)，然后将生成的 vmdk 映像转换为 vhd :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T13:08:29.797

Vmware Server v2 可以使用 v1 映像。Windows Server 2008 仅在 v2 中受支持。v2 还包括虚拟基础架构客户端，您可以使用它来代替 Web 访问（客户端替换了 v1 中的旧控制台）。这是与 ESX 一起使用的同一客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:13:03.983

vmware 2.0 在我拥有的一台服务器上经常崩溃 - 但是，自最近的 2.0.1 更新以来（但只有一周），它还没有崩溃。

我在 vmware 1.0.9 下运行 w2K8 - 通过选择 Vista（实验性）作为操作系统设置。但是，它还没有承受任何负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T22:43:42.337

纯粹出于性能原因，我建议使用 ESXi 而不是 VMware Server（您可以迁移图像）。根据我的经验，Server 2008 和 Vista 都在 VMware Server 下运行*。*有了 ESXi 和一个不错的硬件 RAID 设置，事情可能会更容易忍受。

# c# - c#使用memorystream而不是textwriter创建文件

> ID：781583
> 
> 赞同：32
> 
> 时间：2009-04-23T13:02:28.860
> 
> 标签：c#, memorystream

我有一个应用程序当前正在创建要导入到会计应用程序中的文本文件。它使用以下代码创建文件并向其中写入行：

```
 TextWriter tw = new StreamWriter(ExtractFileName);

    tw.WriteLine("ref\tACCOUNT\tbatch\tDEBIT\tCREDIT\tDesc"); 
```

我现在需要创建多个提取文件并计划使用 SharpZipLib (#ziplib) 将它们压缩为单个 .zip 文件，并希望更改我的代码以“在内存中”创建文本文件并使用它来创建我的 zip 文件。我想我应该创建/使用 MemoryStream 但不知道如何移植我现有的代码。

谢谢。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-04-23T13:05:56.277

你可以这样做：

```
MemoryStream  memoryStream = new MemoryStream();
TextWriter tw = new StreamWriter(memoryStream);

tw.WriteLine("ref\tACCOUNT\tbatch\tDEBIT\tCREDIT\tDesc"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-26T14:00:14.387

**不要创建不必要的抽象。**虽然导出器类很酷，但它仅在您拥有多个导出策略时才增加价值。否则，混乱会分散您代码的核心目的。

如果您想添加导出器来*练习*一种好的抽象技术，那很好，但是在编写任何大量代码时都有**无限的抽象机会。****只有**当特定流程或数据集有多个实现时，抽象才会创建模块化并减少代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-23T13:19:20.240

我还建议这是尝试解耦应用程序部分的好时机，以便您将来可以更改部分应用程序。因此，a`TextWriter`是可写流的一个很好的抽象，但也要考虑抽象您的导出类。

例如，现在你想这样做：

```
MemoryStream  memoryStream = new MemoryStream();
TextWriter tw = new StreamWriter(memoryStream);

// tab-delimited export
IExporter exporter = new DelimiterExport(data, tw, "\t"); 
exporter.Export(); 
```

这样您就可以轻松地将其更改为：

```
// csv file (stands for "comma separated value", but you should actually
// use a culture-specific list separator instead)
var separator = Thread.CurrentThread.CurrentCulture.TextInfo.ListSeparator;
IExporter exporter = new DelimiterExport(data, tw, separator); 
```

或任何其他实现：

```
// excel export
IExporter exporter = new ExcelExport(data, tw); 
```

通过现在提供独立于协议的接口，您以后的生活会更轻松。

# jquery - 如何在 jQuery 中禁用字段集中的所有元素？

> ID：781584
> 
> 赞同：19
> 
> 时间：2009-04-23T13:02:29.810
> 
> 标签：jquery, fieldset

我的页面上有 2 个`<fieldset>`，但其中一个应该根据某些用户的选择禁用所有它的元素。

字段集包含文本输入、选择和链接。有没有办法禁用所有这些而不是一个一个禁用它们？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-23T13:07:35.290

使用儿童选择器怎么样？

```
$("#myfieldeset").children().attr("disabled", "disabled"); 
```

您还可以过滤子项选择：

```
$("#myfieldeset").children("a,input"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-05T18:50:53.297

**您可以设置的`disabled`属性`fieldset`。**

来自[MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/fieldset)：

> 如果设置了此布尔属性，则作为其后代的表单控件（其第一个可选元素的后代除外）将被禁用，即不可编辑。他们不会收到任何浏览事件，例如鼠标点击或与焦点相关的事件。浏览器通常会将此类控件显示为灰色。

* * *

**HTML**：`<fieldset disabled> ... </fieldset>`

**查询**：`$('#myfieldset').prop('disabled', true);`

**JS**：`document.getElementById('#myFieldset').disabled = true;`

* * *

**IE 注意**：

**由于一些错误，这在 Internet Explorer 上不能正常工作**，但在其他任何地方（包括*Edge*）都可以正常工作。

简而言之，文本和文件输入没有正确禁用，用户仍然可以与它们交互。

如果这是一个交易破坏者，您需要进入 并将`disabled`属性放在`<fieldset>`的后代表单控件上，如此处其他答案中所述。

* * *

**浏览器支持信息**：[http ://caniuse.com/#feat=fieldset-disabled](http://caniuse.com/#feat=fieldset-disabled)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T13:08:06.880

假设您在要禁用任何输入元素的字段集上设置了 class="disableMe"，​​那么以下代码应该可以满足您的需要：

```
$('fieldset.disableMe :input').attr('disabled', true) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-05T14:45:39.313

你为什么不直接使用：

`$("#myfieldeset").attr("disabled", "disabled");`

它对我有用。它很好地禁用了所有儿童输入。

**编辑：**请注意， disabled 属性只能应用于 HTML5 中的 fieldset 元素（请参阅 merryprankster 评论）。奇怪的是，它确实可以与 Firefox 和 Opera 以外的其他浏览器一起使用，例如 Chrome 和 Internet Explorer（经过测试的 IE7 和 IE8）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-29T10:18:00.457

除了其他人发布的内容：

使用`.prop()`代替`.attr()`：

```
$('#myfieldset').prop('disabled',true) 
```

关于 DOM 更正确。

而且它似乎不适用于验证。Firefox 和 chrome 都不允许我在禁用的字段集中提交带有未填充的“必填”输入的表单，但也不提供有关如何完成表单的任何说明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T13:15:24.197

如果由于某种原因您无法将 ID 添加到字段集（通常是首选），您始终可以这样做来隐藏它的所有子元素：

```
$('fieldset:first > *').attr('disabled','disabled'); 
```

# asp.net - Visual Studio的解决方案探索者

> ID：781591
> 
> 赞同：0
> 
> 时间：2009-04-23T13:05:43.983
> 
> 标签：asp.net, visual-studio

在 asp.net 应用程序的解决方案资源管理器中，我们在参考部分添加了一些内容，例如：在我们的项目中有 sample.Dal、sample.exeption、system.core 等

什么是实际引用意味着，，，我们可以通过“使用”语句添加

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:11:09.883

Using 用于命名空间解析。例如：

```
using System.Data; 
```

让您无需输入完全限定名称即可访问 DataSet 类；系统.数据.数据集。

然而，这并没有告诉编译器 DataSet 类所在的程序集 (DLL)。所以你需要告诉它。因此，您可以通过将 System.Data.dll 添加到解决方案资源管理器的引用部分来引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T13:10:58.277

是的，一旦您引用了另一个项目或程序集，它的命名空间和类型就可以在引用它们的项目中使用（您必须先引用该项目或程序集，然后才能使用其中的类型）。

您可以使用[`using`](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)声明或完全限定的类型声明来访问类型，如下所示：

```
// Example1: The using keyword.
using System;

void Example1()
{
   Int32 myExample;
   // etc.
}

// Example2: Fully-qualified type.
void Example2()
{
   System.Int32 myExample;
   // etc.
} 
```

**注意：**我在这里使用了 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:11:54.187

A`reference`引用当前项目所需的程序集。Where`using`语句引用当前文件的命名空间。

是的，一个被引用的命名空间必须存在于一个被引用的程序集中。

# python - 与 Python 服务通信

> ID：781594
> 
> 赞同：0
> 
> 时间：2009-04-23T13:06:03.080
> 
> 标签：python, winapi, command-line, service

**问题：**

我有一个作为服务运行的 python 脚本。它是 win32 类 win32serviceutil.ServiceFramework 的子类。我想要一种通过命令行向它发送任意命令的简单直接的方法。

**我看过的：**

看起来控制服务启动后的标准方法是使用另一个程序并向其发送命令信号，但我需要能够向它发送一个短字符串以及一个参数。看起来使用 NamedPipe 可能是一个好主意，但是对于我想做的事情来说它真的太复杂了，还有其他更简单的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:45:33.623

并不真地。

你有很多很多方法可以在 Python 中进行“进程间通信”（IPC）。

*   [插座](http://docs.python.org/library/socket.html)

*   命名管道（请参阅[http://developers.sun.com/solaris/articles/named_pipes.html](http://developers.sun.com/solaris/articles/named_pipes.html)）——创建它涉及到一点操作系统魔法，但它只是一个您可以读写的文件。

*   共享内存（参见[http://en.wikipedia.org/wiki/Shared_memory](http://en.wikipedia.org/wiki/Shared_memory)）——这也涉及到相当多的操作系统级别的魔法。

*   信号和锁；[带锁的文件](http://docs.python.org/library/posixfile.html)可以很好地用于 IPC。

*   建立在套接字上的高级协议...

    *   HTTP；这就是 WSGI 的全部意义所在。

    *   FTP

    *   等等

一个常见的解决方案是使用 HTTP 并定义“RESTful”命令。您的服务在端口 80 上侦听包含参数和参数的 HTTP 请求。查看[wsgiref](http://docs.python.org/library/wsgiref.html)以获取更多信息。

# asp.net - ASP.NET：获取 *real* 原始 URL

> ID：781596
> 
> 赞同：8
> 
> 时间：2009-04-23T13:07:01.517
> 
> 标签：asp.net, url, url-encoding, rawurl

在 ASP.NET 中，有没有办法获得*真正的*原始 URL？

例如，如果用户浏览到“ [http://example.com/mypage.aspx/%2F](http://example.com/mypage.aspx/%2F) ”，我希望能够获得“ [http://example.com/mypage.aspx/%2F](http://example.com/mypage.aspx/%2F) ”而不是比“ [http://example.com/mypage.aspx//](http://example.com/mypage.aspx//) ”。

我当然想要一种干净的方法来做到这一点，但我可以使用反射或访问晦涩的属性的hacky方法。

目前，我尝试在 Authorization-header 中使用 uri（有效），但我不能依赖它始终存在。

**编辑：**

我真正想做的是能够区分“ [http://example.com/mypage.aspx/%2F](http://example.com/mypage.aspx/%2F) ”和“ [http://example.com/mypage.aspx/%2F%2F](http://example.com/mypage.aspx/%2F%2F) ”。

看起来 ASP.NET 首先将“%2F%2F”转换为“//”，然后将斜杠转换为单个斜杠。

所以只是重新编码它是行不通的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T14:26:40.827

我无法对此进行测试，因为它仅适用于 IIS，而不适用于 Visual Studio 中的 ASP.NET 开发服务器，但请尝试：

Request.ServerVariables[ "HTTP_URL" ]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T18:55:40.450

以下代码适用于我：

```
IServiceProvider serviceProvider = (IServiceProvider)HttpContext.Current;
HttpWorkerRequest workerRequest = (HttpWorkerRequest)serviceProvider.GetService(typeof(HttpWorkerRequest));
string realUrl = workerRequest.GetServerVariable("HTTP_URL"); 
```

请注意，这只适用于在 IIS 上运行而不是在 fx ASP.NET 开发服务器下运行！

感谢[Lucero](https://stackoverflow.com/questions/757806/get-the-exact-url-the-user-typed-into-the-browser/757813#757813)在另一个线程中的回答和[Zhaph](https://stackoverflow.com/questions/781596/asp-net-get-real-raw-url/782165#782165)将我指向线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T15:09:03.563

也可以看看：

> [获取用户在浏览器中输入的确切 url](https://stackoverflow.com/questions/757806/get-the-exact-url-the-user-typed-into-the-browser)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:18:28.963

`Request.RawUrl` will return the application relative path(including querystring info) while `Request.Url` will return the complete path(including querystring info).

For more information, see "[Making sense of ASP.NET paths](http://www.west-wind.com/weblog/posts/2009/Dec/21/Making-Sense-of-ASPNET-Paths)".

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T13:13:44.480

```
 Server.HtmlEncode(Request.RawUrl); 
```

原始 URL 定义为 URL 中域信息之后的部分。在 URL 字符串[http://www.contoso.com/articles/recent.aspx](http://www.contoso.com/articles/recent.aspx)中，原始 URL 是 /articles/recent.aspx。原始 URL 包括查询字符串（如果存在）。

另见：[链接文本](http://msdn.microsoft.com/en-us/library/system.web.httprequest.rawurl.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T13:15:53.150

我不能在这里测试，但这可能是你需要的：

```
Request.Url.AbsoluteUri 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T13:15:04.617

好吧，您可以将其编码回 url 编码的版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T13:15:55.597

从请求中获取 url 并仅对查询字符串部分进行 urlencode，然后将它们连接起来

# c# - 带有 WebDialogWindow 作为可编辑弹出窗口的 Infragisitcs Grid

> ID：781614
> 
> 赞同：1
> 
> 时间：2009-04-23T13:12:22.410
> 
> 标签：c#, infragistics

我正在寻找一些示例代码或指向一个好的站点的链接。

有没有人有使用基础设施 WebDialogWindow 作为带有基础设施网格的可编辑弹出窗口的示例。我最好使用 c# 来定位 CLR 2.0。我将更新数据集中的标准 ADO.Net 数据表

我不喜欢编辑行模板技术。

提前致谢！

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T15:42:24.313

真的很简单。

1.  创建一个带有超网格和网络对话框的网络表单。必须包括脚本管理器控件。
2.  在 Web 对话框中将模式设置为 true，将窗口状态设置为隐藏。
3.  将编辑控件连同确定和取消按钮一起拖放到对话框中。
4.  连接网格的双击以将窗口状态设置为正常，并将对话框上的控件设置为单击行中的值。
5.  在 Ok 后面粘贴代码并取消以处理保存并将窗口状态设置回隐藏。
6.  运行。

最后的小指针。将对话框包裹在标准更新面板（不是扭曲面板）中，以改善显示效果（如果您将其居中）。

# asp.net-ajax - 如何知道 ASP.NET AJAX 中回调的大小？

> ID：781626
> 
> 赞同：3
> 
> 时间：2009-04-23T13:15:06.350
> 
> 标签：asp.net-ajax, ajaxcontroltoolkit

我想知道 ASP.NET AJAX 正在执行的回调的大小。我也在使用 ASP.NET 控制工具包。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:17:54.393

我为此使用了 firefox 和[firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)（查看 firebug 中的“net”面板）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:46:41.063

[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829) (Firefox) 或[Fiddler 2](http://www.fiddler2.com/fiddler2/) (IE) 可能有用 - 它们都显示所有标题，包括内容大小。

# oracle - Oracle Pro*C ORA-12547

> ID：781634
> 
> 赞同：0
> 
> 时间：2009-04-23T13:16:23.383
> 
> 标签：oracle, tns, oracle-pro-c

我正在重新编译一些我公司目前没有人编译过的 Pro*C 代码。它编译正常，但是当我将它复制到生产服务器并运行它时，我收到 Oracle 错误 ORA-12547（TNS：失去联系）

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:31:53.890

哦，想通了。:-)

C 可执行文件不直接在服务器上运行，而是通过设置连接环境的脚本启动。即是这样的：

```
export SHLIB_PATH=/oracleDatabaseSidHere/oracle/10.2/lib:/usr/lib:/oracleDatabaseSidHere/oracle/10.2/odg/lib
export ORACLE_BASE=/oracleDatabaseSidHere/oracle
export ORACLE_SID=oracleDatabaseSidHere
export ORACLE_HOME=/oracleDatabaseSidHere/oracle/10.2

# Set up the path and executable to run
PATH=.\:$PATH:$ORACLE_HOME/bin:/usrlocal/bin
PATH=$PATH:/path_to_application_logs

cd /path_to_application
application 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T09:07:39.823

与此相关，我刚刚发现当我尝试使用 PL/SQL 连接到 Oracle 数据库并且同时打开 VPN 连接时，我在我的 Windows 机器上收到相同的错误 ORA-12547 TNS 失去联系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T00:31:04.910

我在 Linux，Oracle 11gR2 上遇到了类似的问题。Oracle 所有者可以运行 SQL*Plus 并通过 TNS 或本地连接进入。非 oracle 用户可以通过 TNS 登录，但不能作为本地连接。

原来答案是 ORACLE_HOME 文件系统被挂载为“nosuid”。删除该挂载选项解决了我的问题。

# sql-server - 如何授予开发者权限给用户授予权限？

> ID：781636
> 
> 赞同：1
> 
> 时间：2009-04-23T13:16:44.037
> 
> 标签：sql-server, sql-server-2005, permissions, grant

有没有一种方法可以让开发人员在不给他们创建用户或函数的选项的情况下授予用户对对象的权限？

我正在尝试限制开发人员的权限，我最近发现开发人员`db_owner`在开发和生产环境中拥有权限！所以我正在尽我所能阻止这种疯狂。

关于这个问题的任何好文章？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:23:05.427

您可以让他们成为“db_securityadmin”数据库角色的成员

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T13:24:11.040

如前所述，如果有人可以分发权限，他们可以将权限分发给自己（或虚拟帐户）。我不确定 SQL Server 中是否有提供“给用户权限比我少”的技巧。

我会这样做的方式是使用存储过程。

创建一个存储过程，为指定用户提供*特定*权限或一组权限（这些权限是允许普通用户拥有的权限）。然后给开发人员执行访问这个存储过程的权限。实际上，您使用存储过程来创建有限版本的 GRANT，同时将完整的 GRANT 命令留给自己。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:19:43.500

如果有人可以给别人权限，他也可以给自己权限做他想做的事。那么这有什么好处呢？可能我不明白你的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:24:58.527

对象的所有者可以授予对这些对象的权限。如果您的开发人员不需要授予诸如 CREATE TABLE 权限之类的东西，您也许可以向他们授予您希望他们授予权限的对象的所有权。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T13:23:25.830

正如 Stefan 所说，授予他们授予权限将有效地授予他们所有权限，因为如果他们想做某事，他们所要做的就是授予自己执行此操作的权限。

不过，与其将开发人员视为敌人，不如考虑为开发人员提供第二个用于管理数据库的用户帐户。至少在他们的开发帐户上，不给开发人员任何生产权限是很常见的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T23:36:26.177

可以使用“GRANT EXECUTE ON . to ;”来完成对存储过程等对象的设置权限。

但是，您可能还想在登录和用户级别授予安全权限。您将只想确定和授予需要访问（例如执行）的对象的必要权限。考虑使用“EXECUTE AS”功能，它可以模拟另一个用户来验证执行代码所需的权限，而不必授予所有底层对象（例如表）的所有必要权限。EXECUTE AS 可以添加到存储的过程、函数、触发器等。

在存储过程中添加如下代码：CREATE PROCEDURE dbo.MyProcedure WITH EXECUTE AS OWNER

在这种情况下，您将冒充被调用模块的所有者。您还可以冒充 SELF，或者创建或更改模块的用户，或者...冒充 CALLER，这将使模块能够获得当前用户的权限，或者...冒充 OWNER，这将获得被调用的过程的所有者 OR... 模拟 'user_name'，它将模拟特定用户 OR... 模拟 'login_name' with 将模拟特定登录。

大多数时候，您只需要授予存储过程的执行权限，然后将权限授予存储过程中引用的所有对象。

通过这种方式，您无需授予隐式权限（例如：更新数据或调用其他 procs）。所有权链为您处理这个问题。这对于动态 sql 或您需要创建提升的安全任务（例如 CREATE TABLE）特别有用。EXECUTE AS 是一个方便的工具来考虑这些。

这个例子可能有助于澄清所有这些：

创建一个名为 NoPrivUser 的用户，该用户具有对数据库的公共访问权限（例如 dbadb）

USE [master] GO CREATE LOGIN [NoPrivUser] WITH PASSWORD=N'ABC5%', DEFAULT_DATABASE=[dbadb], CHECK_EXPIRATION=ON, CHECK_POLICY=ON GO USE [DBAdb] GO CREATE USER [NoPrivUser] FOR LOGIN [NoPrivUser] GO

注意：此过程的创建者或所有者将需要在目标数据库中创建表权限。

使用 DBAdb go CREATE PROCEDURE dbo.MyProcedure WITH EXECUTE AS OWNER AS IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].MyTable') 并输入 (N'U')) 创建表 MyTable (PKid int, column1 char(10)) INSERT INTO MyTable VALUES (1,'ABCDEF')

去

将 dbo.MyProcedure 上的 EXEC 授予 NoPrivUser；去

-- 现在以 NoPrivUser 身份登录到您的数据库服务器并运行以下命令。

使用 dbadb 去

执行 dbo.MyProcedure

（1 行受影响）

现在尝试在以 NoPrivuser 身份登录时从新表中进行选择。

您将获得以下信息：

从 MyTable 中选择 *

消息 229，级别 14，状态 5，第 1 行对象“MyTable”、数据库“DBAdb”、模式“dbo”的 SELECT 权限被拒绝。

这是意料之中的，因为您仅在以 NoPrivUser 身份登录时在 Owner 的安全上下文中运行了该过程。NoPrivUser 没有实际读取表的权限。只是为了执行创建和插入行的过程。

使用 EXECUTE AS 子句，存储过程在对象所有者的上下文中运行。此代码成功创建 dbo.MyTable 并成功插入行。在此示例中，用户“NoPrivUser”绝对没有授予修改表或读取或修改此表中的任何数据的权限。它仅具有完成此过程上下文中编码的特定任务所需的权限。

这种创建存储过程的方法非常有用，该存储过程可以执行需要提升的安全权限而无需永久分配这些权限的任务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-01T21:59:39.970

我发现 db_owner 角色最危险的方面是，如果您对某个权限发出拒绝，那么该角色的成员可以将其授予他们自己。我刚刚开始阅读这个，我正在测试这个

```
Create role db_ControlDatabase

grant control to db_ControlDatabase

deny backup database to db_ControleDatabase

alter role db_ControlDatabase add member TestUser 
```

到目前为止，我发现该主题`TestUser`具有权限，但无法添加或删除固定数据库角色的成员。此时您应该能够拒绝您需要的任何内容，例如备份证书、备份主密钥等。

[以下](https://www.mssqltips.com/sqlservertip/1718/database-level-permissions-for-sql-server-2005-and-2008/)是可以拒绝或授予的权限列表：

# silverlight - ask for easy to use Silverlight player sample

> ID：781647
> 
> 赞同：0
> 
> 时间：2009-04-23T13:21:48.517
> 
> 标签：silverlight, video, multimedia

My purpose is simple, to find a sample which is just enough for my usage other than reading a long page sample. :-)

My requirement is very simple, just embed a Silverlight player into web browser to play some specific videos, the videos are hosted on an IIS server, some are wmv format and some others are flash format.

Any quick to reference samples? :-)

thanks in advance, George

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T04:16:47.240

下载 Expression Encoder 并从那里获取您想要的各种模板（它还能够自动发布到 silverlight.live.com 以进行流式传输，因此我们也可以处理视频托管的负担 - 免费！:)

在“输出”选项卡下，您可以从那里的一堆模板中进行选择（选择您喜欢的模板，然后抓取该代码并将其剪切并粘贴到您所说的页面中）

**Scott Barnes / Rich Platforms 产品经理 / Microsoft。**

# c# - C#：为方法嵌套返回“this”？

> ID：781648
> 
> 赞同：16
> 
> 时间：2009-04-23T13:22:52.773
> 
> 标签：c#, methods, return-value, fluent-interface

我有一门课，我必须多次调用一两个方法。当前返回的方法`void`。我在想，最好让它 return `this`，以便方法可以嵌套？或者这被认为是非常非常非常糟糕？或者如果不好，如果它返回一个相同类型的新对象会更好吗？或者你怎么看？例如，我创建了三个版本的加法器类：

```
// Regular
class Adder
{
    public Adder() { Number = 0; }

    public int Number { get; private set; }

    public void Add(int i) { Number += i; }
    public void Remove(int i) { Number -= i; }
}

// Returning this
class Adder
{
    public Adder() { Number = 0; }

    public int Number { get; private set; }

    public Adder Add(int i) { Number += i; return this; }
    public Adder Remove(int i) { Number -= i; return this; }
}

// Returning new
class Adder
{
    public Adder() : this(0) { }
    private Adder(int i) { Number = i; }

    public int Number { get; private set; }

    public Adder Add(int i) { return new Adder(Number + i); }
    public Adder Remove(int i) { return new Adder(Number - i); }
} 
```

第一个可以这样使用：

```
 var a = new Adder();
    a.Add(4);
    a.Remove(1);
    a.Add(7);
    a.Remove(3); 
```

其他两个可以这样使用：

```
 var a = new Adder()
        .Add(4)
        .Remove(1)
        .Add(7)
        .Remove(3); 
```

唯一的区别是，`a`在第一种情况下是`new Adder()`后者，而在后一种情况下，它是最后一种方法的结果。

第一个我发现它很快就变得......一遍又一遍地写很烦人。所以我想使用其他版本之一。

第三种工作方式与许多其他方法类似，例如许多 String 方法和 IEnumerable 扩展方法。我想这有其积极的一面，你可以做类似的事情`var a = new Adder(); var b = a.Add(5);`，然后一个是 0，一个是 5。但与此同时，一直创建新对象不是有点贵吗？第一个物体什么时候会死？第一种方法什么时候返回？或者？

无论如何，我喜欢返回`this`并认为我会使用它的那个，但我很想知道其他人对此案的看法。什么被认为是最佳实践。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T13:25:27.057

'return this' 风格有时被称为[流畅的界面](http://en.wikipedia.org/wiki/Fluent_interface)，是一种常见的做法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T13:26:50.173

我喜欢“流利的语法”，并会选择第二个。毕竟，对于那些对流利语法感到不舒服的人来说，你仍然可以将它用作第一个。

使像加法器这样的界面更易于使用的另一个想法：

```
public Adder Add(params int[] i) { /* ... */ }
public Adder Remove(params int[] i) { /* ... */ }

Adder adder = new Adder()
  .Add(1, 2, 3)
  .Remove(3, 4); 
```

我总是尝试制作简短易读的界面，但很多人喜欢编写尽可能复杂的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T13:36:15.660

链接是一件好事，并且是某些框架的核心（例如 Linq 扩展和 jQuery 都大量使用它）。

是创建新对象还是`return this`取决于您期望初始对象的行为方式：

```
var a = new Adder();

var b = a.Add(4)
         .Remove(1)
         .Add(7)
         .Remove(3);

//now - should a==b ? 
```

jQuery 中的链接将更改您的原始对象 - 它已返回 this。这是预期的行为 - 否则基本上会克隆 UI 元素。

Linq 中的链接将保持您的原始集合不变。这也是预期的行为 - 每个链接的函数都是一个过滤器或转换，并且原始集合通常是不可变的。

哪种模式更适合您的工作？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:36:05.720

我认为对于简单的接口，“流利”接口非常有用，特别是因为它实现起来非常简单。流畅界面的价值在于，它消除了许多妨碍理解的多余绒毛。开发这样的界面可能需要很多时间，尤其是在开始涉及界面时。您应该担心接口的使用如何“读取”；在我看来，这种界面最引人注目的用途是它如何传达程序员的意图，而不是它节省的字符数量。

为了回答你的具体问题，我喜欢“return this”的风格。我对 fluent 接口的典型使用是定义一组选项。也就是说，我创建了一个类的实例，然后在实例上使用流利的方法来定义对象的期望行为。如果我有一个是/否选项（比如日志记录），我尽量不使用“setLogging(bool state)”方法，而是使用“WithLogging”和“WithoutLogging”两种方法。这需要更多的工作，但最终结果的清晰度非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T13:25:12.987

考虑一下：如果你在 5 年后回到这个代码，这对你有意义吗？如果是这样，那么我想你可以继续。

但是，对于这个特定的示例，重载`+`and`-`运算符似乎会使事情变得更清晰并完成相同的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T13:31:00.587

1.  对于您的具体情况，重载算术运算符可能是最好的解决方案。

2.  返回`this`（Fluent 接口）是创建表达式的常见做法——单元测试和模拟框架经常使用它。Fluent Hibernate 是另一个例子。

3.  返回一个新实例也可能是一个不错的选择。它允许您使您的类不可变——通常是一件好事，在多线程的情况下非常方便。但是，如果不变性对您没有用处，请考虑对象创建开销。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T13:31:18.073

如果你称它为加法器，我会返回这个。但是，Adder 类包含答案有点奇怪。

您可能会考虑将其设为 MyNumber 并创建一个 Add() 方法。

理想情况下（恕我直言），这不会更改存储在您的实例中的数字，而是使用您返回的新值创建一个新实例：

```
class MyNumber
{
    ...

    MyNumber Add( int i )
    {
        return new MyNumber( this.Value + i );
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T18:51:27.573

第二种和第三种解决方案之间的主要区别在于，通过返回一个新实例而不是这个实例，您可以“捕获”处于某种状态的对象并从该状态继续。

> var a = new Adder() .Add(4);
> 
> var b = a.Remove(1);
> 
> var c = a.Add(7).Remove(3);

在这种情况下，b 和 c 都将在 a 中捕获的状态作为起点。[我在阅读Steve Freeman 的 Tests Guided by Tests 的“Growing Object-Oriented Software](http://my.safaribooksonline.com/9780321574442?tocview=true) ”中构建测试域对象的模式时遇到了这个习语；[纳特普莱斯](http://my.safaribooksonline.com/9780321574442?tocview=true)。

关于您关于实例生命周期的问题：一旦调用 Remove 或 Add 返回，我希望它们有资格进行垃圾收集。

# javascript - 网站上的页面转换？

> ID：781654
> 
> 赞同：1
> 
> 时间：2009-04-23T13:23:29.807
> 
> 标签：javascript, jquery, html

我只是想知道在页面之间导航时是否有任何方法可以创建漂亮、平滑的过渡效果？诸如盲目效果、滑动效果等之类的东西。我想我正在寻找 jQuery 可以对图像执行的操作——但对于实际的网页。我知道有淡化效果等等，但我只是想知道那里是否有更“现代”的东西。虽然我意识到 Flash 非常适合这个，但它不是一个选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T14:25:01.487

如果你使用 jQuery UI，你可以做一些很酷的效果。如果您使用 AJAX 加载所有内容，它们会变得更加流畅......但是，这里有一个示例，可以让它与整页加载一起工作。

首先，您需要另外包含 jQuery UI（我刚刚[构建了自己的](http://jqueryui.com/download)并且只获取了我需要的效果）：

```
<script type="text/javascript" src="jquery-ui-1.7.1.custom.min.js"></script> 
```

这是你需要让它工作的javascript。

```
$(function() {
    $('body').hide();
    $('a').bind('click', function() { 
        var newPage = $(this).attr('href');
        $('body').hide('blind',{},500, function() {
            newPageParts =  newPage.split('?');
            newPageURL = newPageParts[0];
            newPageParams = newPageParts[1];
            newPage = newPageURL+"?transition=true"+(newPageParams != undefined ? "&"+newPageParams : '');
            window.location=newPage;
        });
        return false;
    });
    if(getURLParam('transition') != '') {
        $('body').show('blind',{},500,null);
    }
});

function getURLParam(strParamName){
    var strReturn = "";
    var strHref = window.location.href;
    if ( strHref.indexOf("?") > -1 ){
        var strQueryString = strHref.substr(strHref.indexOf("?")).toLowerCase();
        var aQueryString = strQueryString.split("&");
        for ( var iParam = 0; iParam < aQueryString.length; iParam++ ){
            if (aQueryString[iParam].indexOf(strParamName + "=") > -1 ){
                var aParam = aQueryString[iParam].split("=");
                strReturn = aParam[1];
                break;
            }
        }
    }
    return strReturn;
} 
```

当然，淡入仅适用于带有此脚本的页面...

**请注意：**我只是在几分钟内完成了这个，所以它可能真的是贫民区。但是，它确实有效......所以......是的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:42:25.890

IE 有一个非常简单的[页面过渡效果](http://www.permadi.com/tutorial/iePageTransition/index.html)实现，但我认为它们不会在 Mozilla 和 Safari 等其他浏览器上工作。

# asp.net - Web.Config encryption using RsaProtectedConfigurationProvider - "Bad Data" error

> ID：781658
> 
> 赞同：15
> 
> 时间：2009-04-23T13:24:28.433
> 
> 标签：asp.net, encryption, rsa

I am attempting to encrypt connection string values in the Web.Config file for an ASP.NET 2.0 web application, following the [procedure described on MSDN](http://msdn.microsoft.com/en-us/library/yxw286t2(VS.80).aspx). Using the RsaProtectedConfigurationProvider, I created and exported a machine-level key on my development machine (using the -pri flag), and imported the key and granted access on the web server. Prior to testing automatic decryption by ASP.NET, I wanted to try manually decrypting the Web.Config.

I am able to manually encrypt and decrypt the Web.Config on the same machine using the -pef and -pdf parameters respectively, but manually decrypting on the web server fails with a `Bad Data` error message.

The oddest thing is that the keyContainerName attribute in my Web.Config file seems to be ignored. If I try replacing the correct value with gibberish (no longer corresponding to any key container I have created) the encryption and decryption still work on my development machine. Any ideas?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-30T09:43:24.587

根据您的描述，您遇到了一些关于通过可导出 RSA 提供程序加密 web.config 的问题，对吗？

根据 RSA 加密参考，我进行了一些本地测试，通过 RSA 提供程序加密 web.config 部分并移动到其他机器的正常过程如下：

======================= 步骤1

创建机器级 RSA 密钥容器：aspnet_regiis -pc "MyTestKeys" -exp

第2步

授予对 RSA 加密密钥的读取访问权限：

aspnet_regiis -pa "MyTestKeys" "NT AUTHORITY\NETWORK SERVICE"

第 3 步

加密配置文件：aspnet_regiis -pef "connectionStrings" "网站文件夹的物理路径" -prov MyRSAProvider

使用以下步骤导出容器并将其导入回其他机器

第4步

导出机器级 RSA 密钥容器：aspnet_regiis -px "MyTestKeys" "c:\Config-Key.xml" -pri

第 5 步

将 Config-Key.xml 复制到第二台服务器上的 c:\

第 6 步

在第二台服务器上导入机器级 RSA 密钥容器：aspnet_regiis -pi "MyTestKeys" "c:\Config-Key.xml"

第 7 步

授予对 RSA 加密密钥的读取访问权限：aspnet_regiis -pa "MyTestKeys" "NT AUTHORITY\NETWORK SERVICE"

第 8 步

将加密的 web.config 复制到第二台服务器

=========================

根据您提到的步骤，我认为您遵循的大部分过程应该是正确的。到目前为止，我建议您检查以下内容：

1.  检查您的自定义 RSA 提供程序设置以查看它是否也正确复制到目标机器并设置为使用机器容器

========加密配置部分=======

type="System.Configuration.RsaProtectedConfigurationProvider,System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />

2.  如在上述步骤中，创建 RSA 密钥容器后，您需要使用“aspnet_regiis -pa”确保特定帐户（将运行您的 ASP.NET 应用程序）对密钥容器具有足够的访问权限。通常，当您使用 VS 2008/VS 2005 测试服务器运行 ASP.NET 应用程序时，您使用的是登录用户（可能是管理员），但是，如果您在 IIS 中运行 ASP.NET（或移至其他使用另一个不同进程帐户的服务器），您需要确保某个进程帐户已被授予权限。

您可以检查它们以查看问题是否是由于其中一些引起的。

此致 桑杰·曼朱·苏曼

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T16:14:03.037

`Bad Data`当我在手动解密时出错时，我遵循了下面列出的方法。

1.  在. `Remove`_ `Clear`_`configProtectedData`
2.  `–pri`导出密钥时使用了验证
3.  还要确保 keyContainerName 与用于注册的相同

> keyContainerName="MyKeys"

**配置**

```
<configProtectedData>
  <providers>

    <clear/>

<remove name="RSAProtectedConfigurationProvider" />

     <add name="RSAProtectedConfigurationProvider" keyContainerName="MyKeys" 
    type="System.Configuration.RsaProtectedConfigurationProvider, System.Configuration, Version=2.0.0.0,&#xD;&#xA;                
Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,&#xD;&#xA; processorArchitecture=MSIL"
          useMachineContainer="true" />

  </providers>
</configProtectedData> 
```

**参考**

1.  [连接字符串加密](http://entlib.codeplex.com/discussions/244936)
2.  [RAS 密钥在哪里...](http://entlib.codeplex.com/discussions/230782)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-01T09:37:08.523

请注意，要加密的元素的名称区分大小写。所以你应该使用“connectionStrings”而不是“connectionstrings”或“ConnectionStrings”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-02T17:41:53.580

正如 mahdi 所说，加密对大小写非常敏感。我在我的电脑上使用过并将它带到服务器上我遇到了问题，问题来自存储在我的电脑文件夹或目录中的 RSA 机器密钥容器。如果您想知道在进行任何更改之前可以从哪里开始更正，请从

```
\Documents and Settings\All Users\Application Data\Microsoft\Crypto\RSA\MachineKeys. 
```

有关信息，请参考此链接，这可能会有所帮助....

[http://msdn.microsoft.com/en-us/library/ms998283.aspx](http://msdn.microsoft.com/en-us/library/ms998283.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-30T09:37:27.550

RsaProtectedConfigurationProvider 使用机器帐户或用户帐户对密钥进行加密并将其保存在一个名为“密钥容器”的文件中，该文件通常保存在 C:\Documents and Settings\All Users\Application Data\Microsoft\Crypto\RSA 中。并且 ASP.NET 工作进程标识（XP/2000 中的 ASPNET 用户或 2003 中的网络服务）应该有权访问这些文件以便能够对其进行解密，否则您将收到此错误消息。

请检查此链接以获取更多信息

[http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx](http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-28T08:44:20.707

实际上，您可以使用 Microsoft 的 EL 来加密您的连接字符串。你可以在这里下载：http: [//www.codeplex.com/entlib](http://www.codeplex.com/entlib)

hth

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-08T11:25:36.000

这是加密和解密连接字符串的另一种方法，如果您使用的是 vs2010，请检查它，然后以管理员身份运行打开 vs2010

```
string provider = "RSAProtectedConfigurationProvider";

string section = "connectionStrings"; 

protected void btnEncrypt_Click(object sender, EventArgs e) 

{

   Configuration confg =
   WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);

   ConfigurationSection configSect = confg.GetSection(section);

   if (configSect != null)

   {
      configSect.SectionInformation.ProtectSection(provider);
      confg.Save();

   }

}
protected void btnDecrypt_Click(object sender, EventArgs e)
{
    Configuration config =
        WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
    ConfigurationSection configSect = config.GetSection(section);
    if (configSect.SectionInformation.IsProtected)
    {
        configSect.SectionInformation.UnprotectSection();
        config.Save();
    }
} 
```

# python - 如何在python中隐藏__methods__？

> ID：781667
> 
> 赞同：5
> 
> 时间：2009-04-23T13:25:29.740
> 
> 标签：python, hide, magic-methods, facade

我只是想知道，如何隐藏特殊

```
__.*__ 
```

python *中的方法？特别是我正在使用带有制表符完成功能的交互式 python 解释器，我只想显示我的模块公开的方法......

谢谢，

/我的/

*（至少来自使用 python shell 的用户）

* * *

现在看起来像这样：

```
h[2] >>> Q.
Q.ALL(                       Q.__delattr__(               Q.__getattribute__(                
Q.__package__                Q.__sizeof__(                Q.find_values(                         
Q.json
Q.DEFAULT_CONDITION(         Q.__dict__                   Q.__hash__(                  
Q.__reduce__(                Q.__str__(                   Q.get_loops_total_platform(  
Q.jsonlib
Q.SUCCESSFUL(                Q.__doc__                    Q.__init__(                  
Q.__reduce_ex__(             Q.__subclasshook__(          Q.get_platforms(             
Q.memoize(
Q.__all__                    Q.__file__                   Q.__name__                     
Q.__repr__(                  Q.cached_open(               Q.get_snippets(              
Q.__class__(                 Q.__format__(                Q.__new__(                      
Q.__setattr__(               Q.find_results(              Q.get_subjects(              
h[2] >>> Q. 
```

我希望它看起来像：

```
h[2] >>> Q.
Q.ALL(                       Q.find_values(               Q.json
Q.DEFAULT_CONDITION(         Q.get_loops_total_platform(  
Q.jsonlib                    Q.SUCCESSFUL(                Q.get_platforms(             
Q.memoize(                   Q.cached_open(               Q.get_snippets(              
Q.find_results(              Q.get_subjects(              
h[2] >>> Q. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:49:04.863

我认为您应该寻找一种方法来让该特定环境/解释器在您按 TAB 时停止显示“私有”方法。我认为没有办法从 Python 本身“隐藏”方法，那会很奇怪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T17:06:45.220

好吧，您可以创建一个子类`rlcompleter.Completer`，覆盖有问题的方法，然后将其安装到`readline`.

```
import rlcompleter
import readline
class MyCompleter(rlcompleter.Completer):
    def global_matches(self, text):
        ....
    def attr_matches(self, text):
        ....

import readline
readline.set_completer(MyCompleter().complete) 
```

这些代码片段允许不区分大小写的制表符完成：

[http://www.nabble.com/Re%3A-Tab-completion-question-p22905952.html](http://www.nabble.com/Re%3A-Tab-completion-question-p22905952.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T15:21:24.957

我会看看ipython。也许您可以在没有子进程的情况下将 ipythons 交互式 shell 挂接到您的应用程序中，并从那里应用私有方法过滤。

# c - C中的char到int转换

> ID：781668
> 
> 赞同：37
> 
> 时间：2009-04-23T13:25:29.833
> 
> 标签：c, char

如果我想将单个数字转换`char`为它的数值，例如，如果：

```
char c = '5'; 
```

我想`c`持有`5`而不是`'5'`，它是 100% 便携的吗？

```
c = c - '0'; 
```

我听说所有字符集都按连续顺序存储数字，所以我假设是这样，但我想知道是否有组织的库函数来进行这种转换，以及它是如何按常规完成的。我是一个真正的初学者:)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-23T13:30:24.503

是的，这是一个安全的转换。C 要求它工作。该保证在最新 ISO C 标准的第 5.2.1 节第 2 段中，最近的草案是[N1570](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)：

> 基本源字符集和基本执行字符集都应具有以下成员：
> [...]
> 10 位十进制*数字*
> `0 1 2 3 4 5 6 7 8 9`
> [...]
> 在源基本字符集和执行基本字符集中，上述列表中 0 之后的每个字符的值小数位数应比前一个值大一。

ASCII 和 EBCDIC 以及从它们派生的字符集都满足这个要求，这就是 C 标准能够强加它的原因。请注意，字母在EBCDIC中是*不连续的，而 C 并不要求它们是连续的。*

没有库函数可以为单个 执行此操作`char`，您需要先构建一个字符串：

```
int digit_to_int(char d)
{
 char str[2];

 str[0] = d;
 str[1] = '\0';
 return (int) strtol(str, NULL, 10);
} 
```

一旦你有一个字符串，你也可以使用该`[atoi()](http://www.manpagez.com/man/3/atoi/)`函数进行转换，但`[strtol()](http://linux.die.net/man/3/strtol)`更好更安全。

正如评论者指出的那样，调用一个函数来进行这种转换是非常过分的。您最初减去“0”的方法是正确的方法。我只是想在这里展示如何使用推荐的将数字作为字符串转换为“真实”数字的标准方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-23T13:30:13.363

试试这个 ：

```
char c = '5' - '0'; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-23T13:29:40.153

您可以使用[`atoi`](http://www.cppreference.com/wiki/c/string/atoi)，它是标准库的一部分。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-24T14:12:02.777

```
int i = c - '0'; 
```

您应该知道，这不会对字符执行任何验证 - 例如，如果字符是“a”，那么您将得到 91 - 48 = 49。尤其是在处理用户或网络输入时，您可能应该执行验证以避免程序中的不良行为。只需检查范围：

```
if ('0' <= c &&  c <= '9') {
    i = c - '0';
} else {
    /* handle error */
} 
```

请注意，如果您希望您的转换处理十六进制数字，您可以检查范围并执行适当的计算。

```
if ('0' <= c && c <= '9') {
    i = c - '0';
} else if ('a' <= c && c <= 'f') {
    i = 10 + c - 'a';
} else if ('A' <= c && c <= 'F') {
    i = 10 + c - 'A';
} else {
    /* handle error */
} 
```

这会将单个十六进制字符（大写或小写独立）转换为整数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T13:50:33.957

由于您只转换一个字符，因此 atoi() 函数太过分了。atoi() 在转换数字的字符串表示时很有用。其他帖子已经给出了这方面的例子。如果我正确阅读了您的帖子，则您只转换了一个数字字符。因此，您只需要转换 0 到 9 范围内的字符。在只转换一个数字字符的情况下，减去“0”的建议将为您提供所需的结果。这样做的原因是因为 ASCII 值是连续的（就像你说的那样）。因此，减去 0 的 ASCII 值（ASCII 值 48 - 请参阅[ASCII 表](http://www.cppreference.com/wiki/ascii)对于值）来自数字字符将给出数字的值。因此，您的 c = c - '0' 示例，其中 c = '5'，实际发生的是 53（5 的 ASCII 值）- 48（0 的 ASCII 值）= 5。

当我第一次发布这个答案时，我没有考虑你关于在不同字符集之间 100% 可移植的评论。我做了一些进一步的环顾四周，看起来你的答案仍然大部分是正确的。问题是您使用的是 8 位数据类型的 char。这不适用于所有字符类型。阅读[Joel Spolsky 撰写的关于 Unicode的这篇文章](http://www.joelonsoftware.com/articles/Unicode.html)有关 Unicode 的更多信息。在这篇文章中，他说他使用 wchar_t 来表示字符。这对他来说效果很好，他用 29 种语言发布了他的网站。因此，您需要将 char 更改为 wchar_t。除此之外，他说127以下的角色基本相同。这将包括代表数字的字符。这意味着您提出的基本数学应该适用于您想要实现的目标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T13:28:27.923

是的。只要您使用标准的 ascii 字符，这就是安全的，就像您在本例中一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T15:33:23.687

通常，如果不能保证您的输入在 '0'..'9' 范围内，则必须执行如下检查：

```
if (c >= '0' && c <= '9') {
    int v = c - '0';
    // safely use v
} 
```

另一种方法是使用查找表。您可以使用更少（可能更快）的代码进行简单的范围检查**和转换：**

```
// one-time setup of an array of 256 integers;
// all slots set to -1 except for ones corresponding
// to the numeric characters
static const int CHAR_TO_NUMBER[] = {
    -1, -1, -1, ...,
    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, // '0'..'9'
    -1, -1, -1, ...
};

// Now, all you need is:

int v = CHAR_TO_NUMBER[c];

if (v != -1) {
    // safely use v
} 
```

PS我*知道*这是一个*矫枉过正*。我只是想把它作为一种可能不会立即显现出来的替代解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-10T22:19:08.793

正如其他人所建议的那样，但包装在一个函数中：

```
int char_to_digit(char c) {
    return c - '0';
} 
```

现在只需使用该功能。如果您决定使用不同的方法，您只需要更改实现（性能、字符集差异等），您不需要更改调用者。

此版本假定 c 包含一个表示数字的字符。您可以在调用函数之前使用 ctype.h 的 isdigit 函数进行检查。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-21T15:46:44.120

由于 '0','1','2'.... 的 ASCII 代码从 48 到 57 放置，它们基本上是连续的。现在算术运算需要将 char 数据类型转换为 int 数据类型。因此您基本上要做的是：53-48，因此它存储值 5，您可以使用它进行任何整数运算。请注意，从 int 转换回 char 时编译器没有给出错误，只是执行模 256 运算以将值置于可接受的范围内

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-03T00:24:08.167

您可以简单地使用该`atol()`功能：

```
#include <stdio.h>
#include <stdlib.h>

int main() 
{
    const char *c = "5";
    int d = atol(c);
    printf("%d\n", d);

} 
```

# asp.net-mvc - 使用 ASP.NET MVC 的大型数据输入页面

> ID：781673
> 
> 赞同：2
> 
> 时间：2009-04-23T13:25:40.410
> 
> 标签：asp.net-mvc

我正在使用默认的 ASP.NET MVC 主题处理大型数据输入页面。由于页面上有大量控件，最好使用两列字段集，这样用户就不需要滚动。我在 MVC 设计库中看不到任何使用两列数据输入页面的模板，它们都面向标准网站设计。有人见过吗？拥有用于不同数据输入场景的模板会很棒。

谢谢

丹尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:41:35.660

您可以做的是创建自己的 T4（文本模板转换工具包）文件。[您可以在此处](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)了解更多信息。这将在“添加视图”对话框中为您提供额外的视图内容选项，生成您指定的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T09:40:40.167

如果您的问题是在单个窗口上显示所有控件而不滚动并且可能使用两列，对！

我有另一个解决方案给你。那就是巫师。查看此[链接](https://stackoverflow.com/questions/771788/how-do-i-create-a-mvc-wizard-similar-in-functionality-to-webforms-wizards)和此[链接](https://stackoverflow.com/questions/297148/how-to-make-a-wizard-with-asp-net-mvc)。

你的表格会很好看！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T06:36:44.347

如果您的问题是布局，您可以先在设计视图（或 Dreamweaver 或您选择的设计器）中进行布局，然后添加 MVC 特定代码。

# voip - VoIP 服务如何连接到固定电话？

> ID：781674
> 
> 赞同：5
> 
> 时间：2009-04-23T13:25:41.503
> 
> 标签：voip, infrastructure

Skype 和 Yahoo 等 VoIP 服务如何连接到固定电话？

我们有一台使用星号连接到固定电话的服务器，所以我认为该服务器将桥接我们的 VoIP 对话并将其连接到固定电话。

但如果是这样的话，难道 Skype 不需要在全世界放置大量服务器来连接固定电话吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:28:38.487

是的。这就是电话的工作原理。Skype 自己运行一堆服务器的可能性不大——他们可能会通过主干运营商（只是推测）许可使用商业电话服务的权利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T13:28:38.750

是的，要使用带有 VoIP 的固定电话呼叫某人，您需要在某处连接到固定电话的服务器。

# jquery - JQuery - UI 和动画错误

> ID：781676
> 
> 赞同：0
> 
> 时间：2009-04-23T13:26:24.153
> 
> 标签：jquery, jquery-ui

我在使用 jquery ui datepicker 时遇到了这个特定错误，并且在使用 toggle("slow") 时也遇到了同样的错误

错误

jQuery.speed 不是一个函数

任何人都知道为什么会发生这种情况

FF3 / 萤火虫

谢谢肖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:30:34.673

我会检查以确保您包含的 jQuery 版本与您也在使用的 datepicker/jQuery UI 的版本兼容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T15:10:12.313

版本正常似乎是插件冲突。

# php - PHP Get the last insert id from ODBC connection

> ID：781677
> 
> 赞同：7
> 
> 时间：2009-04-23T13:26:45.090
> 
> 标签：php, database

How do I get the last insert id from a database using a ODBC connection?

I'm looking for a solution similar to the mysql_insert_id() function.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-25T14:19:53.580

选择 @@IDENTITY 作为 ID

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T13:37:20.850

If you're using databases with PHP I strongly recommend using PDO (simple database wrapper for a lot of common database engines, more and more supported all the time, part of PHP canon), and hence use [PDO::lastInsertId](http://php.oregonstate.edu/manual/en/pdo.lastinsertid.php) if your database supports the equivalent of mysql_insert_id.

Don't use "SELECT max(id) FROM table;" as it can result in seriously freaky and hard-to-find bugs later on.

*** **UPDATE** : Ok, you're using ODBC, and I suspect you're after [odbc_cursor](http://au2.php.net/manual/en/function.odbc-cursor.php). I still stand by the strong recomendation to use PDO, as it has an ODBC driver. (ODBC in my eyes is an grumpy bitter old man who mumbles under his breath driving his truck that's falling apart, as the hip and effective PDO guys race past in their sexy VOLVO S90's)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:41:59.827

It depends on the database type, but look into the SEQUENCE syntax for your rdbm.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-02T12:40:05.307

如果您在 ODBC 下有 MySQL - 您可以使用下一个查询：

```
"SELECT LAST_INSERT_ID( );" 
```

它必须在执行 INSERT 查询后立即执行。

对于其他数据库 - 使用其他特定查询...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-07T08:30:45.797

在使用 PHP/MSSQL 时，我通过 ODBC 使用了“SELECT @@IDENTITY AS LastID”。这在 SQL 2005 服务器（或者是 2000？）下带来了一些问题。无论哪种方式，如果你这样做：

`SET NOCOUNT ON
[NOW INSERT YOUR INSERT SQL QUERY]
SELECT @@IDENTITY AS LastID`

您应该在任何 MSSQL 服务器版本中都可以。

“SET NOCOUNT ON”将阻止 sql server 发送诸如“插入 1 行”之类的消息，这将使您的脚本正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-21T18:17:55.373

在 MySQL 中使用

```
SELECT *
FROM table_name
ORDER BY Id Desc
LIMIT 1 
```

在 SQL Server 中使用

```
SELECT top 1 *
FROM table_name
ORDER BY Id Desc 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-23T13:52:46.103

您是否通过 PHP 向数据库中插入行？如果是这样，也许您可​​以使用 uniqid() 生成唯一的主键 - 然后您将知道 ID 而无需查询数据库。

如果无法更新密钥类型，也许您仍然可以在插入时插入唯一 id，因此您可以执行如下查询：

```
SELECT id FROM mytable WHERE rowid = '$myuniqueid' 
```

这样您就可以确保从数据库中提取正确的 ID - 比 MAX(id) 更好的解决方案。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-04-24T09:22:15.437

使用

```
SELECT max(id) FROM table; 
```

从事务内部应该没问题，还是 ODBC 不支持事务？

# database - 数据库设计：将博客条目拆分为多个页面

> ID：781685
> 
> 赞同：0
> 
> 时间：2009-04-23T13:28:03.243
> 
> 标签：database, pagination

对博客条目或页面内容进行分页的最佳数据库策略是什么，其中一些条目可能是单个页面，而一些可能跨越多个页面？注意：内容将类似于文章，而不是项目列表。

我目前正在考虑的方法是将所有内容存储在单个文本字段中并使用像*{pagebreak}*这样的页面分隔符。检索时，内容将通过页面分隔符拆分为一个数组，然后页面将显示适当的索引。这是最好的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:31:58.213

我认为你目前的想法将是最好的选择。如果您愿意，可以更轻松地移动分页符，或者在您最初撰写文章时将其放入。还允许您有一个打印页面选项，其中整篇文章在 1 个字段中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T14:09:37.013

最简单的方法（现在，但您稍后会付费）是将整篇文章存储在一个文本字段中，但是您放弃了一些显示控制，因为您可能需要在该文本中放置一些 html。如果您将 html 放入文本中，如果您更改网页的外观/感觉，您将需要修复大量数据。这可能不是问题

**作为一项规则，我尽量不要将 html 放入数据库。** 您最好使用 XML 来定义您的文章，并将其存储在一个文本字段中，这样您的应用程序就可以正确地以动态方式呈现内容。您可以在 XML 中存储分页符，或者让应用程序读取整篇文章并根据您当前的外观动态拆分它。

如果您不想使用 XML，可以使用我的“穷人的 CMS”模式（如下）。与“一个字段中的所有文本”方法相比，它可以让您更好地控制格式。

这些只是根据您的问题的疯狂猜测

表：

```
Articles
--------
ArticleID        int  --primary key
ArticleStatus    char(1) --"A"ctive, "P"ending review, "D"eleted, etc..
ArticleAuthor    varchar(100)  --or int FK to a "people" table
DateWritten      datetime
DateToDisplay    datetime
etc...

ArticleContent
--------------
ArticleID     int  --primary key
Location      int  --primary key, will be the order to display the article content, 1,2,3,4
ContentType   char(1)  --"T"ext, "I"mage, "L"ink, "P"age break

ArticleContentText
------------------
ArticleID      int  --primary key
Location       int  --primary key
FormatStyle    char(1)  --"X"extra large, "N"ormal, "C"ode fragment
ArticleText    text

ArticleContentImage
-------------------
ArticleID      int  --primary key
Location       int  --primary key
AtricleImagePath  varchar(200)
AtricleImageName  varchar(200) 
```

您仍然可以将整篇文章放在一个字段中，但如果它包含不同类型的“事物”，您可以将其拆分。

如果您有一篇关于带有示例的 PHP 代码的文章，“单字段方法”将迫使您将 html 放入文本中以格式化代码示例。使用此模型，您可以存储什么是什么，并让应用程序正确显示它。您可以添加和扩展不同的类型，放入分页符，删除它们。您可以将内容存储在多个“ArticleContentText”行中，每个行代表一个分页符，或者包含指定分页符的“ArticleContent”行。您可以让应用阅读整篇文章，然后只显示它想要的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:32:45.807

我认为正确的方法是您提到的：条目应该作为单个条目存储在数据库中，然后您可以使用标记/UI 层来确定应该在哪里发生分页符或其他格式。

数据库设计不应受到 UI 概念的影响——因为您可能会决定更改它们的显示方式，并且您需要数据库保持一致。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:32:06.463

你最好把这样的格式留在客户端。让数据库保存您的数据，您的应用程序以正确的格式将其呈现给用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T13:32:36.370

在我看来，这是一个很好的解决方案。这样您就可以将您的文章作为一个整体，并且可以在必要时对其进行分页。

# svn - Word/Openoffice 文档当前 SVN 版本的自动字段更新

> ID：781686
> 
> 赞同：4
> 
> 时间：2009-04-23T13:28:09.577
> 
> 标签：svn, ms-word, openoffice.org

Subversion 的“关键字”功能非常适合用修订号自动标记文本文件。我真的很想为 Word 和/或 OpenOffice 文档做类似的事情。

我通过在“注释”文档属性字段中插入“固定宽度”关键字替换，对 Word 文档进行了尝试。但它似乎仍然以某种方式破坏了文档（另外我不知道在多字节字符的情况下“固定宽度”可能意味着什么）。我也不喜欢这个想法，因为它不利于在文档本身的可打印部分插入数字。

我现在想象的是一个在文档打开时自动运行并更新自定义文档属性的宏。该文档可能包含 doc 属性引用字段，这些字段使用存储在 doc 属性中的值进行更新。

有没有人这样做，或做任何其他事情来实现这个目标？对于 Word 或 OpenOffice？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:53:57.847

第一：[嵌入式版本号——好还是坏？](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know/645424#645424): 我觉得他们很邪恶。

您不应使用技术内部修订号来表示文档的版本。

“这是我的word文档的2.2版本”和“这是我的word文档的1567版本”是不一样的。

*   从最终客户的角度来看，前者是一个“适用的”修订号。
*   从工具的角度来看，后者是“技术”修订号。

另外，如果它使用当前修订号修改文档，它仍然需要提交，这意味着存储的版本将在一个*不同于*您的宏更新的修订号中。
如果没有提交，那么被这样标记的文档总是有可能不*完全*是最初从 Subversion 查询的那个。

* * *

话虽这么说......关于更新 Office 文档属性的更普遍的问题：

该线程[更新 word 2003 字段自动](http://forums.asp.net/t/1232865.aspx)建议使用 Office API。[Microsoft.Office.Interop](http://www.codeproject.com/KB/aspnet/wordapplication.aspx)不允许修改属性，但 VBA API 允许您访问要为给定[SmartTag](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.smarttag(VS.80).aspx)设置的任何 CustomProperty 。

本文“[将带有自定义识别器的智能标记添加到 Word 文档](http://msdn.microsoft.com/en-us/library/ms268751(VS.80).aspx)”为您提供了 SmartTag 自定义行为的示例。

智能标签是附有类型信息的文本字符串；当与标准匹配的文本字符串出现在文档中时，它会被识别并且用户能够执行适合该类型字符串的操作。

因此可以想象一个 SmartTag 能够识别字符串“revision for this document”，自定义行为是“我将向 SVN 查询正确的修订号并显示它”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:08:08.030

你可以试试 Tobi 的小脚本：http: [//insights.oetiker.ch/windows/SvnProperties4MSOffice/](http://insights.oetiker.ch/windows/SvnProperties4MSOffice/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T11:21:15.377

我们实际上正在使用一个有点相似的“系统”（由一位前同事创建），它解决了一些这些问题。

**愿望...**

*   我们希望能够看到两个打印输出实际上是相同的版本。
*   我们希望能够找到打印输出（包括修订）的来源。
*   我们希望消除由于作者忘记更新修订号而引起的问题。

**解决方案**

我们没有使用 svn 修订号，而是为我们的文档使用“人工”修订号。为了确保我们没有多个版本具有相同的修订号浮动在文档被修改时会自动更新，即会有几个永远不会发布的“修订”......猜测它并不完美......

**半技术细节...**

*   “人工”修订号存储在文档的自定义属性中。
*   我们已将所有 word 文档设置为 requre lock (svn:needs-lock)
*   在 Lock 上，一个加号被添加到修订字符串的末尾以表示一个“脏”版本。
*   提交时，加号被删除，数字增加

**结果**

一个系统，我们在打印文档中有一个修订号：

*   除非文档更改，否则不要更改
*   表示脏版本，即从修改后的工作副本中打印出来
*   如果文档不同（即作者忘记更新修订版没有问题）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T22:32:33.470

如果您将 Word 文档保存为 .xml（所谓的平面 OPC 格式）会怎样？

那么它只是一个文本文档，svn 关键字应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T04:32:49.580

VonC 的回答使我确信 doc-open 不是更新文档属性的正确时间。例如，如果文件通过电子邮件发送给其他人，或者复制了一张 CD，或者“导出”，那么它在打开时无法更新其 SVN 版本。很难确保文件永远不会包含错误的过时修订号。因此，要“正确”执行此操作，文件的修订号应在 SVN 签出/更新时更新。

我相信对于文本文件中的 SVN 关键字，客户端会对文件进行“摆弄”，在结帐时对其进行更新，并在提交前返回“规范”表单。所以对于 Word，使用客户端钩子来做同样的事情会很棒。[TortoiseSVN 有客户端钩子，](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html#tsvn-dug-settings-hooks)但我认为其他 SVN 客户端没有。在我的工作中，我们几乎总是使用 TortoiseSVN，这样它就可以很好地工作。

所以我想做的是写两个 TortoiseSVN 客户端钩子：

1) 更新后挂钩插入包含文件相关提交 SVN 修订的“SvnRevision”文档属性。

2) 预提交挂钩以删除“SvnRevision”文档属性。如果非 TortoiseSVN 客户端将其检出，这会使存储在存储库中的文件“干净”。（它还可以防止合并冲突？）

* * *

**更新：** Arrr 我刚刚意识到另一个问题：如果我执行上述操作，那么 SVN 会认为文件已更改。嗯，这似乎很难。为了使该功能正常工作，它确实需要与客户端进行相当紧密的集成。

# security - Secure captive portal?

> ID：781690
> 
> 赞同：0
> 
> 时间：2009-04-23T13:28:45.553
> 
> 标签：security, wireless, portal, public

We would like to run a wireless access point for public use. However, in case of misbehavior, we would like some personal information to be able to pass on to law enforcement.

The proposed solution involves a captive portal where users enter their email addresses, and are then given ten minutes to check their email and verify, after which they are given unrestricted access.

The problem, as I see it, is that once a user is authenticated, anyone can come along, spoof the MAC or IP, and then have access. If they commit a crime or copyright infringement, the user who entered the email address is now blamed.

Now, we could solve that by using WPA and requiring users to preregister. But as I said, we would like to allow anyone to just drive up and use it, and we don't want to provide any technical support.

The other alternative is not collecting email addresses, but then in case of an investigation or lawsuit, we wouldn't have anything to hand over, and thus risk the possibility of being shut down.

Is there any way out of this dilemma?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T11:56:06.470

收集电子邮件也是徒劳的，因为您无法在不提供受损访问权限的情况下确认它。您应该简单地记录用户生成的流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T14:15:31.583

让最终用户接受法律免责声明，即您（提供者）不负责，他们（最终用户）负责，他们不应该做非法的事情通常就足够了。只需记录他们当时点击了“我同意”以及他们的 IP 和 MAC。他们每次连接时都应该这样做。

索要电子邮件基本上毫无价值；许多人会使用编造的电子邮件，或输入拼写错误，然后抱怨他们从未收到过 - 许多人会使用一次性电子邮件 - 许多人会使用他们在免费网络邮件提供商之一创建的垃圾帐户。

向他们的手机发送带有唯一（随机）代码的 TXT 消息并在强制门户页面上输入以获得访问权限的系统是一个更好的系统恕我直言。我以前做过这个，它工作正常，除了那些有妈妈的 iPad 或其他平板电脑但没有手机的孩子。您将所有这些数据保存 90 多天，或者您的律师告诉您的时间。

意识到实施任何这些都会显着减少热点的实际使用，用户没有耐心并且会感到沮丧并放弃该过程。

大多数强制门户产品可以记录每个客户获得的 MAC 和 IP 租约，以及他们在 Internet 上的去向（至少我是这样做的），因此如果出现法律请求，您可以向执法部门提供您拥有的数据。然后由执法部门使用该 MAC 偷取或追踪设备，这取决于他们的能力水平，这对他们来说是可能的还是不可能的，无论哪种方式，为他们做他们的工作都不是你的工作。

我还提倡过滤明显的色情和恶意软件域，不仅是为了节省带宽，而且是为了限制您的责任。任何好的强制门户产品都可以做到这一点。

您的公共无线网络至少应该被 NAT 到一个单独的静态 IP，因此您可以区分引用该 IP 的法律请求，而不是说您的私人办公网络。您可以使用单独的防火墙或支持多个 LAN 接口的防火墙来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-25T21:21:21.193

答案是不要关心执法部门对用户个人信息的无法满足的要求。如果这不是一个可接受的答案，那么答案就是停止尝试提供公共访问点。如果这也不是一个可接受的答案，那么答案就是您已经拥有的建议解决方案。之后你如何与自己生活在一起，从守法的人那里收集个人信息，这些信息只会被犯罪分子用来掩盖他们的踪迹，这是个人问题，超出了本网站的范围。祝你好运。

# ajax - Ajax更新面板问题

> ID：781691
> 
> 赞同：0
> 
> 时间：2009-04-23T13:29:02.040
> 
> 标签：ajax

我在更新的面板中有一个下拉列表和 2 个列表框，在页面上有一个保存按钮。当页面加载时，我会加载一个列表框，其中包含与所选下拉项相关的数据。当用户在下拉列表中选择不同的项目时，我会进行回发并使用与所选项目相关的数据重新加载列表框。当用户单击页面上的保存时，listbox.Items 是在第一个页面加载时加载的原始项目以及页面上显示的项目。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T13:30:32.957

确保不要在每次回发时绑定数据。使用 Page.IsPostback 来检查这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T19:00:17.920

为了解决这个问题，我必须从客户端更新视图状态。下面是我在更新面板的回发完成后调用的 javascript 函数：

函数更新状态列表（列表）{

```
var i;
var state = "1";
for(i = 0; i < list.options.length; i++){
    state += "|" + list.options[i].text + "|" + list.options[i].value;
}
eval("document.forms[0]." + list.id + "_State.value = state"); 
```

}

# amazon-web-services - Amazon S3 中的 HeadBucket 操作是什么

> ID：781692
> 
> 赞同：6
> 
> 时间：2009-04-23T13:29:02.807
> 
> 标签：amazon-web-services, amazon-s3

我一直在查看 Amazons S3 服务的使用报告，并注意到 GetObject 操作需要支付 DataTransfer-out-bytes 费用（我明白这一点），而 HeadBucket 操作需要支付 DataTransfer-out-bytes 费用。

什么是 HeadBucket，这个请求是什么时候发出的？

干杯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T13:43:52.303

这是对存储桶的 HEAD 请求：

```
HEAD /my-s3-bucket 
```

这基本上只会告诉您存储桶存在（200 OK）或不存在（404 Not Found）。

例如：

```
# curl -v -X HEAD http://s3.amazonaws.com/fooXXXX

* About to connect() to s3.amazonaws.com port 80 (#0)
*   Trying 72.21.211.144... connected
* Connected to s3.amazonaws.com (72.21.211.144) port 80 (#0)
> HEAD /fooXXXX HTTP/1.1
> User-Agent: curl/7.18.2 (i486-pc-linux-gnu) libcurl/7.18.2 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.10
> Host: s3.amazonaws.com
> Accept: */*
> 
< HTTP/1.1 404 Not Found
< x-amz-request-id: A21BF750F080A267
< x-amz-id-2: SPQ7yX6Ln0Zgp0YULT/64ag9077nNnN25jH8PMLGMm/SbXPZ+FF3qFuiOyBfiktP
< Content-Type: application/xml
< Transfer-Encoding: chunked
< Date: Thu, 23 Apr 2009 13:39:50 GMT
< Server: AmazonS3 
```

比。

```
# curl -v -X HEAD http://s3.amazonaws.com/s3hub

* About to connect() to s3.amazonaws.com port 80 (#0)
*   Trying 72.21.207.135... connected
* Connected to s3.amazonaws.com (72.21.207.135) port 80 (#0)
> HEAD /s3hub HTTP/1.1
> User-Agent: curl/7.18.2 (i486-pc-linux-gnu) libcurl/7.18.2 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.10
> Host: s3.amazonaws.com
> Accept: */*
> 
< HTTP/1.1 200 OK
< x-amz-id-2: E6OvrEMD35HpJjlBg0kB90H/uaQDX8qk0oXb+baOtDKIoMXmNwgIRSX2rDE5Urlb
< x-amz-request-id: DAAAA11524A4A557
< Date: Thu, 23 Apr 2009 13:43:01 GMT
< Content-Type: application/xml
< Transfer-Encoding: chunked
< Server: AmazonS3
< 
```

# winforms - ReportViewer 条件格式

> ID：781695
> 
> 赞同：1
> 
> 时间：2009-04-23T13:29:32.883
> 
> 标签：winforms, conditional, reportviewer

我正在尝试在 ReportViewer 控件中应用某些表格单元格的条件格式。我了解如何通过比较位于同一行中的数据来应用条件，例如，如果成本高于收入，则以下内容会将单元格着色为红色：

```
=IIf(Fields!Cost.Value > Fields!Revenue.Value, "Red", "Black") 
```

我的问题是我需要将数据与上一行进行比较。我的要求是标记从上一个条目更改的表格单元格。例如：

```
TableRow 1:    Fred,   23,  Boat
TableRow 2:    Fred,   67,  Boat     ** 67 needs to be flagged 
```

如何使用条件语句来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T13:37:42.240

如果有人对答案感兴趣，我找到了解决方案。我刚刚发现，reportviewer 中内置了一个 Previous 函数。

上一个（字段！LineTotal.Value）

它返回前一行数据。这将做我需要的。

# svn - TFS 和 SVN

> ID：781700
> 
> 赞同：4
> 
> 时间：2009-04-23T13:30:10.400
> 
> 标签：svn, tfs

我即将开始与另一家供应商合作。供应商拥有源代码和 SVN 存储库，而我们拥有 TFS。我对使用 TFS 中可用的工作项跟踪很感兴趣，但使用 SVN 作为源代码控制。有谁知道这是否可能？

我认为另一种选择是使用某种轮询机制，以便我可以将 SVN 源下载到 TFS 源中，然后像往常一样使用 TFS 源控制。我认为主要问题是将我的更改返回到 SVN 存储库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:35:45.783

我想这是可能的，但是您无法将工作项与变更集或搁置集相关联，这对我来说是我最喜欢 TFS 的事情之一。

我认为无论哪种方式，您都会遇到一些棘手的合并/同步操作。在我看来，最好的办法是就两个团队的单一源代码控制解决方案达成一致。

如果您*只想*使用 TFS 的工作项跟踪而不使用它的源代码控制功能，您应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:21:21.573

我想我只是想到了一个解决方法。我应该能够将源代码下载到 vendor-src 目录...也将其复制到我们的主干然后检查到 tfs...

要进行合并，请从供应商 svn 获取最新信息...使用 Beyond Compare 合并我们的主干和供应商-src，并且通过 Beyond compare 我可以将两个文件夹与各自的版本控制存储库相关联。

有点笨拙并且有些脱节，因为双方都会缺少签入评论，而且不是真正的最佳选择，但我相信这是我目前可用的最佳选择。

# c# - C#：在另一个进程的内存中搜索 byte[] 数组

> ID：781716
> 
> 赞同：6
> 
> 时间：2009-04-23T13:31:37.027
> 
> 标签：c#, memory, process

怎么可能在另一个进程的内存中搜索一个byte[]数组，然后得到byte[]数组所在位置的地址呢？

我想将一个字节数组写入另一个进程的内存（WriteProcessMemory()）。该调用的参数之一是 uint Address。我想通过在进程中搜索字节数组来获取地址。

例如我搜索 {0xEB ,0x20,0x68,0x21,0x27,0x65, ??, 0x21,0x64,0xA1}

我们假设该数组仅放置在我要写入内存的进程的内存中的一个位置。

为了得到那个地址，我必须搜索那个字节数组。

是否可以在 C# 中完成？

**编辑：** **这适用于本机应用程序，而不是 .NET。无需对我的问题投反对票，有 C++ 的组件可以做到这一点，我只想在 C# 中做到这一点。**

感谢您的理解！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-09-24T18:33:10.757

是否可以在 C# 中完成？在c#（或任何其他语言）中一切皆有可能，您只需要找到方法；

这里的硬编码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace ConsoleApplication1
{
    class Program
    {
        [DllImport("kernel32.dll", SetLastError = true)]
          static extern bool ReadProcessMemory(
          IntPtr hProcess,
          IntPtr lpBaseAddress,
          [Out] byte[] lpBuffer,
          int dwSize,
          out int lpNumberOfBytesRead
        );

    [DllImport("kernel32.dll")]
    public static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);

    [DllImport("kernel32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool CloseHandle(IntPtr hObject);
    static void Main(string[] args)
    {
        Process[] procs = Process.GetProcessesByName("explorer");
        if (procs.Length <= 0)  //proces not found
            return; //can replace with exit nag(message)+exit;
        IntPtr p = OpenProcess(0x10 | 0x20, true, procs[0].Id); //0x10-read 0x20-write

        uint PTR = 0x0; //begin of memory
        byte[] bit2search1 = {0xEB ,0x20,0x68,0x21,0x27,0x65}; //your bit array until ??
        int k = 1;  //numer of missing array (??)
        byte[] bit2search2 = {0x21,0x64,0xA1};//your bit array after ??
        byte[] buff = new byte[bit2search1.Length+1+bit2search2.Length];    //your array lenght;
        int bytesReaded;
        bool finded = false;

        while (PTR != 0xFF000000)   //end of memory // u can specify to read less if u know he does not fill it all
        {
            ReadProcessMemory(p, (IntPtr)PTR, buff, buff.Length, out bytesReaded);
            if (SpecialByteCompare(buff, bit2search1,bit2search2,k))
            {
                //do your stuff
                finded = true;
                break;
            }
            PTR += 0x1;
        }
        if (!finded)
            Console.WriteLine("sry no byte array found");
    }

    private static bool SpecialByteCompare(byte[] b1, byte[] b2, byte[] b3, int k)  //readed memory, first byte array, second byte array, number of missing byte's
    {
        if (b1.Length != (b2.Length + k + b3.Length))
            return false;
        for (int i = 0; i < b2.Length; i++)
        {
            if (b1[i] != b2[i])
                return false;
        }

        for (int i = 0; i < b3.Length; i++)
        {
            if (b1[b2.Length + k + i] != b3[i])
                return false;
        }
        return true;
    }
} 
```

}

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T13:47:31.497

我猜你可以使用[ReadProcessMemory](http://msdn.microsoft.com/en-us/library/ms680553(VS.85).aspx) Windows API 调用。甚至还有一个[预制的 P/Invoke 签名](http://www.pinvoke.net/default.aspx/kernel32/ReadProcessMemory.html)，因此您无需费心手动制作它。你翻阅过程的记忆，搜索你的模式，你就完成了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-20T22:35:59.780

您将需要使用这些 API：

```
 [DllImport("Kernel32.Dll")]
    public static extern uint VirtualQueryEx(IntPtr ProcessHandle, uint Address, ref MEMORY_BASIC_INFORMATION MemInfo, int MemInfoLength);
    [DllImport("Kernel32.Dll")]
    public static extern bool ReadProcessMemory(IntPtr ProcessHandle, uint Address, byte[] Buffer, uint Size, ref uint BytesRead);
    [DllImport("Kernel32.Dll")]
    public static extern bool WriteProcessMemory(IntPtr ProcessHandle, uint Address, byte[] Buffer, uint Size, ref uint BytesRead); 
```

[pinvoke.net](http://www.pinvoke.net/default.aspx/kernel32/VirtualQueryEx.html)是一个很好的 Windows API 调用资源。如果您想查看sourceforge 上的[代码，我为 GTA：Vice City 编写了一个培训师，它会使用这些调用。](https://sourceforge.net/projects/vicecheat/files/vicecheat/ViceCheat%200.9/)代码不是很漂亮，那是很久以前的事了，我只是把它放在一起，但是有一些帮助类用于枚举进程的内存区域并搜索某些字节或字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-21T22:32:16.470

这可能会帮助您找到正确的方法：

```
private static int GetMemoryAddressOfString(byte[] searchedBytes, Process p)
{
    //List<int> addrList = new List<int>();
    int addr = 0;
    int speed = 1024*64;
    for (int j = 0x400000; j < 0x7FFFFFFF; j+= speed)
    {
        ManagedWinapi.ProcessMemoryChunk mem = new ProcessMemoryChunk(p, (IntPtr)j, speed + searchedBytes.Length);

        byte[] bigMem = mem.Read();

        for (int k = 0; k < bigMem.Length - searchedBytes.Length; k++)
        {
            bool found = true;
            for (int l = 0; l < searchedBytes.Length; l++)
            {
                if(bigMem[k+l] != searchedBytes[l])
                {
                    found = false;
                    break;
                }
            }
            if(found)
            {
                addr = k+j;
                break;
            }
        }
        if (addr != 0)
        {
            //addrList.Add(addr);
            //addr = 0;
            break;
        }
    }
    //return addrList;
    return addr;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-23T14:08:44.253

> 是否可以在 C# 中完成？

是的。但是非常难。在本地应用程序中很难做到与您需要使用的进程的非托管视图及其内存映射不匹配的阻抗。

注意事项：

*   您需要获得权限才能打开进程以获取句柄。
*   虽然 32 位进程的虚拟内存空间大小为 2 到 4 GB（取决于主机操作系统和 /3GB 开关），但该地址范围的大部分不会被分配，读取它会导致页面错误。您确实需要找出分配了哪些页面以及如何避免大量无效页面访问。

建议：

*   你真的需要这样做吗？说真的，这将很难。
*   考虑做一个本机应用程序，这将避免跨本机/托管栅栏工作（这可能包括带有托管驱动程序应用程序的本机库）。
*   你真的需要这样做吗？
*   考虑在目标进程内进行工作。这将需要一些聪明才智（已记录）来注入线程，但应该会更快。
*   首先阅读 Windows 上的进程内存是如何工作的（从 Windows Internals 和（在最新版本中记不起它的名字）Jeffrey Richter 的关于 Win32 应用程序开发的书开始。
*   你真的需要这样做吗？一定有一些更简单的东西......你能自动化调试器吗？

# unix - Thompson 的木马编译器

> ID：781718
> 
> 赞同：11
> 
> 时间：2009-04-23T13:31:52.377
> 
> 标签：unix, compiler-construction

我试图更好地理解 Thompson 的 Trojan Compiler（在他的 1984 ACM 图灵奖演讲“ [Reflections On Trusting Trust](http://cm.bell-labs.com/who/ken/trust.html) ”中讨论），到目前为止，我是这样理解的：

“最初的 Unix 登录程序将接受 root 指示的任何登录名和密码。它只接受某个密码，只有编写系统的人知道。这可以让他以 root 身份登录系统。”

这是正确的概念吗？我不是 100% 确定我是否理解整个概念。

如果有人能让它更清楚，那将有所帮助。

（另见 Bruce Schneier[反对“信任信任”](http://www.schneier.com/blog/archives/2006/01/countering_trus.html)）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-23T17:07:10.070

原始登录程序从文件中接受匹配的名称和密码对。

修改是添加一个超级强大的密码，编译到登录程序中，允许root访问。为了确保在阅读登录程序时这段代码不可见，对编译器进行了更改，以识别登录程序的这一部分，即其原始形式并将其编译为超级强大的密码二进制文件。然后，为了在编译器中隐藏此代码的存在，需要对编译器进行另一次更改，以识别添加了第一次更改的编译器部分并输出修改后的形式。

一旦更改的编译器代码存在，您可以编译编译器并将其安装在标准位置，然后将登录程序和编译器的源代码恢复为未修改的形式。然后安装的编译编译器将采用未更改的登录程序并输出不安全的形式。同样，已安装的编译器会将未修改的编译器源代码编译成不正当的变体。任何检查源代码的人都会同意它们没有什么不寻常的地方。

Of course, it only works until the source code for either program evolves far enough that the modified compiler no longer recognizes it. Since the modified compiler's source code is no longer present, it can't be maintained, and (assuming that the compiler and login continue to evolve) it will eventually stop producing the insecure output.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T13:59:06.353

我以前从未遇到过这个概念，但这很有趣——我在[http://scienceblogs.com/goodmath/2007/04/strange_loops_dennis_ritchie_a.php找到了一篇简洁的文章](http://scienceblogs.com/goodmath/2007/04/strange_loops_dennis_ritchie_a.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:50:26.560

是的，这是正确的概念。还有更多；修改后的编译器还必须将未修改的编译器源编译为自身的类似修改副本。这包括该源代码的微小变化，这基本上意味着修改后的编译器必须能够解决例如停机问题。

# c# - 关于 C# 和静态类和函数的问题

> ID：781732
> 
> 赞同：5
> 
> 时间：2009-04-23T13:33:35.883
> 
> 标签：c#, static, database-connection

我在这里看到了很多关于这个主题的讨论。

如果我有一个带有静态方法的静态类连接到数据库或服务器，那么在多用户环境（如网页）中使用它是不是一个坏主意？这会使新用户的线程在接受新用户之前等待以前用户的线程完成他们的调用吗？

这对多线程又有什么影响呢？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T13:38:05.733

如果每个静态方法完全负责获取其资源，然后在方法调用的范围内处置其资源（无共享状态），那么您应该不会遇到使用实例类不会遇到的线程问题。然而，我认为更大的问题是依赖公共静态方法（在静态或非静态类中）会在未来产生许多其他设计问题。

*   首先，您与实现的绑定非常紧密，这总是很糟糕。
*   其次，测试所有依赖于静态方法的类变得非常困难，因为您被锁定在一个实现中。
*   第三，创建非线程安全方法确实变得非常容易，因为静态方法只能具有静态状态（在所有方法调用中共享）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T13:39:39.940

静态方法在多线程方面没有任何特殊行为。也就是说，您可以期望同时运行该方法的多个“副本”。静态变量也是如此——不同的线程可以同时访问它们，无需等待。除非你小心，否则这会造成混乱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:40:24.807

是的，这是个坏主意。

当您为所有用户使用一个连接时，如果有人执行需要（比如说 15 秒）仅用于数据库访问的操作，则所有其他用户都必须等待才能连接到数据库

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:38:04.063

这个问题有点奇怪。至于为什么你有这么多的静态。

但我认为您是在询问线程问题，所以我会说去查看一些关于线程的文档 h [ttp://msdn.microsoft.com/en-us/library/c5kehkcz(VS.80).aspx](http://msdn.microsoft.com/en-us/library/c5kehkcz(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T13:38:54.483

静态只是定义方法定义的范围，以及它是如何绑定/调用的。它与多线程无关。

您需要小心使用静态字段。它们由所有线程共享。线程不会相互等待，但您需要锁才能使其工作。

但是，如果您的应用程序比 Hello World 复杂一点，您应该考虑让您的方法不是静态的，而是使用面向对象的模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T13:41:27.440

如果您使用一个静态连接来访问数据库，您将不得不同步方法调用。多个线程通过单个连接向数据库询问数据将... ehhmmm ... 搞砸了。因此，您正在序列化所有线程的数据访问，这将对性能产生很大影响。

如果每个调用都打开自己的连接，则不需要序列化所有线程，因为没有共享连接。为每个请求创建一个连接仍然是一个昂贵的设计。

如果您使用静态连接池，您将减少这种性能影响，因为您只需要序列化对连接池的访问。

此外，静态通常不是一个好的设计决策——它们使单元测试变得非常复杂。您应该考虑使用 Singleton 或 Monostate 模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T13:41:46.347

如果你做*对*了，那将不是问题。如果你*做错了*，它可能会强制顺序访问资源。

有时对与错之间的区别可能非常微妙且难以发现，但主要的是，任何方法都不应该依赖或锁定类的任何“状态”（成员）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T14:33:16.567

我使用静态方法查找对象。我可以在一个地方为 asp.net 应用程序管理所有查找对象（使用缓存），并且所有方法都使用静态方法调用它。

通过这种方式，我不需要在每次需要时都实例化查找对象，并且减少了调用 DB 以提高性能的需要。

# c# - How do I make this ASP.NET MVC Route for a twitter-style URL work?

> ID：781736
> 
> 赞同：1
> 
> 时间：2009-04-23T13:33:48.847
> 
> 标签：c#, asp.net, asp.net-mvc, routing

trying to map the following style of route: [http://site.com/username](http://site.com/username) in the same way that you can do [http://www.twitter.com/user](http://www.twitter.com/user)

My initial solution was to have these routes:

```
//site.com/rathboma - maps to user details for rathboma
            routes.MapRoute("Users", "{id}", new { controller = "Users", action = "Details" });

            routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "oneday" }  // Parameter defaults
            ); 
```

And that was working fine, until I tried to do the following in my 'Links' controller:

```
public ActionResult Details(string id)
        {
            int newId;
            if (!int.TryParse(id, out newId))
                return RedirectToAction("Index");

            WebLink results = Service.GetWebLink(newId, 5);

            if (results == null)
                return RedirectToAction("Index");

            return View(results);
        } 
```

These RedirectToAction methods try and return the browser to [http://site.com/Users](http://site.com/Users) (I do have a users controller) instead of directing to [http://site.com/Links/index](http://site.com/Links/index)

**Why is this is happening?**

**How should I be organizing my routes to make this work properly?**

I'm happy sacrificing [http://site.com/links](http://site.com/links) and moving to [http://site.com/links/index](http://site.com/links/index) if I have to. But how would I enforce that?

Thanks to all for any help

**EDIT:**

I know what's causing this, it's trying to redirect to [http://site.com/links](http://site.com/links) (the index page), but links is being picked up as a username and redirecting to /users/details, when it can't find the user 'links' it tries to redirect to the UsersController Index action which maps to /users, and the cycle continues ('users' is not a user it can find so redirects infinately).

**So I guess My sub-question is: how to I make mvc always use /links/index instead of just using /links for the index page?**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:38:51.143

Try adding this route before your Users route:

```
routes.MapRoute("Links", 
                "{controller}/{id}", 
                 new { controller = "Links", action = "Details" }); 
```

This should then work for

[http://mysite.com/Links/id](http://mysite.com/Links/id)

&

[http://mysite.com/username](http://mysite.com/username)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:19:20.657

我相信在您的 Links 控制器中更改`RedirectToAction("Index");`to`RedirectToAction("Index", "Links");`应该可以解决问题，而无需更改您的路线。

问题是你有两条非常贪婪的路线。我要做的是将默认路由分解为不那么贪婪的路由，如下所示：

```
routes.MapRoute("Links", 
                "Links/{id}", 
                 new { controller = "Links", action = "Index" });

routes.MapRoute("Users", 
                "{id}", 
                 new { controller = "Users", action = "Details" });

routes.MapRoute("Default", 
                "", 
                 new { controller = "Home", action = "Index" }); 
```

导致网址如下所示：

```
site.com/links/5 - 点击链接控制器
site.com/name - 点击用户控制器
site.com/ - 点击家庭控制器

```

# .htaccess - Making a rewriterule remove .php extension?

> ID：781738
> 
> 赞同：1
> 
> 时间：2009-04-23T13:34:09.500
> 
> 标签：.htaccess, mod-rewrite

I have come up with a rewriterule to to go to any page on my website without typing in the .php extension because it is automatically added to the url.

The rule is: RewriteRule ^(\w+)/?$ /$1.php

It takes anything you type in my index and adds .php to it, so you can put in [http://sampardee.com/index](http://sampardee.com/index) and it pulls up index.php

Now my question is how to detect when a user enters [http://sampardee.com/index.php](http://sampardee.com/index.php) and change it to [http://sampardee.com/index](http://sampardee.com/index)

How could I do so with a rewriterule?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:40:19.003

You need to force a redirect on the user *without* matching the internal redirect:

```
RewriteCond %{ENV:REDIRECT_STATUS} !200
RewriteRule ^(\w+)\.php$ /$1 [R=301]

RewriteRule ^(\w+)/?$ /$1.php 
```

This redirects the user with a `301 Moved Permanently` redirection to the modified URL.

# asp.net-mvc - 对 ASP.NET MVC DefaultControllerFactory.cs 实现感到困惑

> ID：781743
> 
> 赞同：4
> 
> 时间：2009-04-23T13:35:44.333
> 
> 标签：asp.net-mvc, model-view-controller

在研究我自己的实现时，`IControllerFactory`我查看了默认实现`DefaultControllerFactory`，并惊讶地发现该`RequestContext`属性在`CreateController(...)`方法中设置，然后在`GetControllerInstance(...)`and`GetControllerType(...)`方法中被引用。

令我惊讶的原因是，由于工厂是在应用程序启动时实例化的，因此所有请求都使用相同的实例，因此如果同时收到多个请求，则无法保证`RequestContext`在您设置属性时已将哪些请求设置为来使用它。

MVC 框架中是否保证注册者一次只能处理一个请求`IControllerFactory`？

如果我在这里遗漏了什么，请赐教，因为如果我在请求生命周期中的方法调用之间有状态，我的控制器的实现会更简单。

谢谢。

编辑：

给出的答案如我所料，但错过了问题的要点。事实上，作为 MVC 框架的一部分提供的 DefautlControllerFactory 正在存储 RequestContext，就好像它有状态一样 - 查看源代码。

我认为这是错误的，并且正在寻求澄清（我认为我已经看到这两个答案都与我的想法一致）。我已经交叉发布到 ASP.NET MVC 论坛。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T09:32:53.493

交叉发布到 ASP.NET MVC 论坛表明这是 DefaultControllerFactory 实现的一个错误。

有关信息，请参见此处：

[http://forums.asp.net/t/1414677.aspx](http://forums.asp.net/t/1414677.aspx)

[http://forums.asp.net/t/1404189.aspx](http://forums.asp.net/t/1404189.aspx)

然而，后一篇文章揭示了您可以在每个请求上建立一个控制器工厂，在这种情况下您可以拥有状态。

从帖子...

> ```
> ControllerBuilder.Current.SetControllerFactory(typeof(DefaultControllerFactory)); 
> ```
> 
> 这会将控制器构建器的模式从基于实例切换到基于类型，并且会在每个请求上创建控制器工厂的新实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T20:01:10.120

您的问题：MVC 框架中是否保证注册的 IControllerFactory 一次只能处理一个请求？

答：不，您必须使用锁来存储状态。

我的问题：为什么要在控制器工厂中存储状态？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T22:54:24.837

没有为每个请求执行控制器工厂的 CreateController 方法。在应用程序启动中，您只需要设置默认控制器，创建新的控制器工厂只需三行代码：

```
public class CommonServiceLocatorControllerFactory : DefaultControllerFactory  
{  
  protected override IController GetControllerInstance(Type controllerType)  
  {  
    return (controllerType == null) ? base.GetControllerInstance(controllerType) 
     : ServiceLocator.Current.GetInstance(controllerType) as IController;  
  }
} 
```

# java - hibernate 延迟初始化问题：LazyInitializationException: failed to lazily initialize a collection of role

> ID：781751
> 
> 赞同：1
> 
> 时间：2009-04-23T13:37:22.503
> 
> 标签：java, hibernate, lazy-initialization

我想在我的持久层中管理一个事务，但是当我尝试懒惰地获取结果时，我得到了这个错误：

> org.hibernate.LazyInitializationException：未能延迟初始化角色集合

我可以使用 LockMode 或任何其他方式来解决这个问题吗？可以在没有任何事务的情况下通过其 id 找到对象吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:58:39.410

您的问题是当您尝试访问内容时，休眠会话已经关闭。Hibernate 无法在没有会话的情况下加载内容。通常有两种方法可以缓解这个问题：

1.  在完成页面之前不要关闭会话。这种模式称为“视图中的会话”，例如可以使用 servlet 过滤器来实现。

2.  在关闭会话之前初始化您需要的所有内容。如果要初始化整个对象，可以使用 Hibernate.initialize(object)。

编辑：您不能在 Hibernate 中的事务之外执行任何操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T17:06:14.753

您还可以在 [http://www.hibernate.org/43.html 查看hibernate 的官方解决方案](http://www.hibernate.org/43.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:20:57.050

通常问题是对象的属性之一是延迟加载的。您可以做的一件事是将其预加载到您的查询中：

从 Sale sale where sale.date > :startDate left join fetch sale.product

这将预取 sale.product 对象。

该站点有更多信息：[http](http://www.javalobby.org/articles/hibernate-query-101/) ://www.javalobby.org/articles/hibernate-query-101/ 。

-戴夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:39:30.427

有很多方法可以预取属性，所以它们在会话关闭后就在那里：

1.  只需调用适当的吸气剂。将字段提取到 bean 后，会话关闭后它就在那里。
2.  在您将使用的 JPA 中的 bean 描述符中使用适当的属性`@OneToMany(fetch = FetchType.EAGER)`，但是有类似的休眠方式可以做到这一点。
3.  您可以在 HQL 查询中初始化字段（我不确定它是否适用于 HQL，但我认为可以），查找`FETCH INTO`关键字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-11T11:04:53.247

或者只是使用另一个 ORM ...比如 Ebean ORM，延迟加载可以工作:)

# c# - Problem converting very small doubles to SQL floats

> ID：781757
> 
> 赞同：2
> 
> 时间：2009-04-23T13:38:33.610
> 
> 标签：c#, sql, sql-server, types, floating-point

I'm trying to store a C# double in MS SQL 2005 as a float. However, there seem to be a range of small numbers which are valid doubles but which aren't valid floats. For example, when I try to store the value 1e-320 I get the error "the supplied value is not a valid instance of type float".

This is consistent with the documentation for SQL floats, which have a smallest value of 2.23e-308 [http://msdn.microsoft.com/en-us/library/ms173773.aspx](http://msdn.microsoft.com/en-us/library/ms173773.aspx)

and with the documentation for C# doubles, which have a smallest value of 5.0e-324 [http://msdn.microsoft.com/en-us/library/678hzkk9(VS.71).aspx](http://msdn.microsoft.com/en-us/library/678hzkk9(VS.71).aspx)

So my question is what is the best way of handling this - can I cast the double as something which is a valid as a SQL float?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T13:59:33.277

选项：

*   将其存储为字符串并依靠 c# 来验证/理解它
*   分别存储尾数和指数：1和-320并在数据库外重构

你不能做什么：

*   更改为小数将不起作用，因为您最多有 38 个小数位

编辑：

SQL Sever 只是不理解这个数字：无论使用什么客户端库或 c# 数据类型或技巧，它都不能作为数字存储在 SQL Server 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T14:03:55.493

如果您想保持 double 的全部价值，您可能需要使用[@gbn](https://stackoverflow.com/questions/781757/problem-converting-very-small-doubles-to-sql-floats/781850#781850)的解决方案之一。

如果您只是更喜欢使用 SQL 浮点数的范围，如果超出该范围则舍入为零，那么创建一个辅助方法应该相当简单，如果该值超出 SQL 浮点数的范围，则舍入为零。

```
private static SqlParameter CreateDoubleParameter(string parameterName, double value)
{
    const double SqlFloatEpsilon = 2.23e-308;
    SqlParameter parameter = new SqlParameter(parameterName, SqlDbType.Float);
    parameter.Value = value > -SqlFloatEpsilon && value < SqlFloatEpsilon ? 0d : value;
    return parameter;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T13:48:10.437

您可以将数据类型更改为`decimal`，或添加第二列来保存存储值应移动的小数位数以产生原始值。也就是说，使用这种方案存储 0.000456 将导致存储 4.56 和 5，而 34567.89 可以表示为 3.456789 和 -4（减号表示向左移动）。

但是，第二种选择可能会导致精度逐渐下降。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-23T14:38:14.200

从根本上说，尝试将 64 位值存储在 32 位值中会导致精度损失，编译器警告您该问题是正确的。你真正要问的是“我真的需要这么精确吗？”

如果您不需要精度，则“float output = Convert.ToSingle(inputAsDouble);” 可以解决问题 - 它只会四舍五入到最接近的可表示单精度值。

如果您确实需要精度，但仍需要适合 32 位的值，那么您必须以某种方式限制范围。例如，如果您知道您的值总是在 -1e-319 到 1e-319 的范围内，那么您可以使用定点数学在存储的 32 位值和您需要用于的双精度值之间进行转换计算。这样返回的双精度值将无法表示您范围内所有可能的数值，但您将在该有限范围内具有 32 位粒度，这确实是一个相当不错的精度。

例如，您可以创建一个辅助类，如：

```
struct FixedDouble
{
    int storage;

    public FixedDouble(double input)
    {
        storage = DoubleToStorage(input);
    }

    public double AsDouble
    {
        get
        {
            return StorageToDouble(storage);
        }
    }

    const double RANGE = 1e-319;

    public static int DoubleToStorage(double input)
    {
        Debug.Assert(input <= RANGE);
        Debug.Assert(input >= -RANGE);

        double rescaledValue = (input / RANGE) * int.MaxValue;

        return (int)rescaledValue;
    }

    public static double StorageToDouble(int input)
    {
        double rescaledValue = ((double)input / (double)int.MaxValue) * RANGE;

        return rescaledValue;
    }
} 
```

这段代码可能无法按原样工作，因为我刚刚很快就把它敲掉了，但想法就在那里 - 基本上你牺牲了 double 为你提供的全部范围，而是选择两个数字之间的固定粒度，以及 32 -bit 值允许您在这两个数字之间的数字线上定义一个点。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-23T14:14:19.997

~~您可以使用[SqlDouble](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqldouble.aspx)类型。~~ 这是来自[System.Data.SqlTypes](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.aspx)命名空间，其中

> 为 SQL Server 中的本机数据类型提供类。这些类为 .NET Framework 公共语言运行时 (CLR) 提供的数据类型提供了一种更安全、更快的替代方案。使用此命名空间中的类有助于防止由于精度损失导致的类型转换错误。由于其他数据类型在后台与**SqlType**相互转换，因此在此命名空间内显式创建和使用对象也会产生更快的代码。

**编辑：**显然 SqlDouble 的范围为 -1.79E +308 到 1.79E +308，这与事物的正指数方面的双精度相同，并且不考虑负指数差异。从范围检查的角度来看，它似乎永远不会有用。附带说明一下，该命名空间中的其他类型，如 SqlDateTime，看起来它们实际上可能对范围检查有用，但不是 SqlDouble。

# c++ - 使用指针复制构造函数

> ID：781760
> 
> 赞同：21
> 
> 时间：2009-04-23T13:39:08.163
> 
> 标签：c++, pointers, copy-constructor

我最近发现，当我在一个类中有指针时，我需要指定一个 Copy 构造函数。

为了了解这一点，我编写了以下简单的代码。它可以编译，但在执行复制构造函数时会出现运行时错误。

我试图从复制对象的指针中复制值，但避免分配相同的地址。

那么，这里有什么问题？

```
 class TRY{
        public:
        TRY();
    ~TRY();
        TRY(TRY const &);

        int *pointer;

        void setPointer(int);
    };

    void TRY::setPointer(int a){
        *pointer = a;

        return;
    }

    TRY::TRY(){}

    TRY::~TRY(){}

    TRY::TRY(TRY const & copyTRY){
        int a = *copyTRY.pointer;
        *pointer = a;
    }

    int main(){

        TRY a;
        a.setPointer(5);

        TRY b = a;

        b.setPointer(8);

        cout << "Address of object a = " << &a << endl;
        cout << "Address of object b = " << &b << endl;

        cout << "Address of a.pointer = " << a.pointer << endl;
        cout << "Address of b.pointer = " << b.pointer << endl;

        cout << "Value in a.pointer = " << *a.pointer << endl;
        cout << "Value in b.pointer = " << *b.pointer << endl;

        return 0;
    } 
```

我将把这个概念用于其他有很多指针的类，我需要将所有值从一个对象复制到另一个。此代码最初需要复制，因此我想保留复制的可能性（我不会将复制构造函数隐藏为私有）。

此外，我需要实现的真正类有 10 个指针，而且它可能会随着时间而变化。在 C++ 中有没有更聪明的方法来拥有一个深拷贝构造函数？...

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T13:47:38.300

使用该语句`int* pointer`，您刚刚定义了一个指针，但尚未分配任何内存。首先，您应该通过像这样分配一些内存来使其指向正确的内存位置`int* pointer = new int`：然后再次在复制构造函数中，您必须为复制的对象分配内存。另外，不要忘记在析构函数中使用 delete 释放内存。

我希望这个例子有帮助：

```
class B
{

public:
    B();
    B(const B& b);
    ~B();
    void setVal(int val);

private:
    int* m_p;
};

B::B() 
{
    //Allocate the memory to hold an int
    m_p = new int;

    *m_p = 0;
}

B::B(const B& b)
{
    //Allocate the memory first
    m_p = new int;

    //Then copy the value from the passed object
    *m_p = *b.m_p;
}

B::~B()
{

    //Release the memory allocated
    delete m_p;
    m_p = NULL;
}

void B::setVal(int val)
{
    *m_p = val;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T14:07:46.380

> 我最近发现，当我在一个类中有指针时，我需要指定一个 Copy 构造函数。

这并不完全正确。当您的类中有指针并使用分配内存时，`new`您必须担心复制构造函数。另外，不要忘记赋值运算符和析构函数。您必须删除使用分配的内存`delete`。

它被称为[三巨头法则](http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming))。

例子：

```
 ~Matrix();  //Destructor
  Matrix(const Matrix& m); //Copy constructor
  Matrix& operator= (const Matrix& m); //Assignment operator 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T13:48:08.033

如果你想做一个深拷贝，你当然还必须分配新的内存来保存这些值。如果原始有一个指向 int 的指针，并且您不希望副本使用相同的指针值，则必须分配新内存来保存 int，然后将值复制到那里。

您的示例不是很清楚，它没有显示复制构造函数的实现，或者`pointer`成员如何初始化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T13:46:37.943

如果它有一个指向常规类型的指针，那么

```
A::A(const A& a):
  pointer_( new int( *a.pointer_ ) )
{
} 
```

如果它有一个指向某个基类的指针，那么

```
A::A(const &a ):
  pointer_( a.pointer_->clone() )
{
} 
```

克隆是[原型模式的实现](http://en.wikipedia.org/wiki/Prototype_pattern)

不要忘记删除析构函数中的指针

```
A::~A()
{
    delete pointer_;
} 
```

修复你的例子

```
TRY::TRY(TRY const & copyTRY){
    int a = *copyTRY.pointer;
    pointer = new int(a);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T14:08:10.090

> 我最近发现，当我在一个类中有指针时，我需要指定一个 Copy 构造函数

通常情况下，通过将它（和赋值运算符）声明为私有而不实现它来简单地禁用它是一个好主意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T13:52:16.087

您的问题就在这一行：

```
 *pointer = a; 
```

默认构造函数中通常发生的所有事情都还没有发生，包括为`*pointer`.

解决方法是为整数分配内存。您可以使用`malloc`and Friends 或`new`for this，但请确保它与您在默认构造函数中使用的方法相同，因为您只会获得一个析构函数，并且调用必须匹配。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T13:54:54.710

如果成员明智的（浅）副本是可以的，那么您不必做任何事情。如果你想要一个深拷贝，你必须为所有成员的拷贝分配新的存储空间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T14:05:27.773

编写复制构造函数时，应为所有成员分配内存。在你的情况下：

```
TRY::TRY(TRY const & copyTRY){
    pointer = new int(*(copyTry.pointer));
} 
```

Operator= 有点相似，但没有内存分配。

```
TRY& operator=(TRY const& otherTRY){
      this->a  = *(otherTry.pointer)
      return *this
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-06-26T04:06:09.133

这是复制构造函数的示例

```
class Test
{​​​​​​​
private:
    int *s;
    int size;
public:
    Test(int a, int b);
    Test(const Test&t);
    ~Test();
    void setValue(int l);
    void getValues();
}​​​​​​​;

Test::Test(int a, int b)
{​​​​​​​
    s = new int;
    *s = a;
    this->size = b;
}​​​​​​​
Test::Test(const Test&t) {​​​​​​​
    s = new int;
    *s = *(t.s);
    this->size = t.size;
}​​​​​​​
void Test::setValue(int l) {​​​​​​​
    *s = l;
}​​​​​​​
void Test::getValues() {​​​​​​​
    cout << "value of s: " << *s << endl;
    cout << "value of size: " << this->size << endl;
}​​​​​​​

Test::~Test() {​​​​​​​
    cout << "memory de allocated!!!" << endl;
    delete s;
}​​​​​​​ 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-04-23T17:17:29.093

通常情况下，如果您需要编写一个复制构造函数或赋值运算符，那么您就做错了。将复制构造函数和赋值运算符留给标准库的实现者。编写已经可复制和可分配元素的类，而不必编写自己的。

例如，也许那个 int * 成员应该是一个 std::vector 。

如果您不能使类默认可复制/可分配，也许您可​​以通过声明但不实现私有复制构造函数和赋值运算符来使其不可复制/可分配。

只有当以上都不可行时，您才应该实现自己的复制构造函数或赋值运算符。

# tdd - TDD 的限制是什么？

> ID：781763
> 
> 赞同：8
> 
> 时间：2009-04-23T13:40:02.310
> 
> 标签：tdd

我最近才发现我非常喜欢以 TDD 方式开发代码：我觉得我对开发的方向有了更多的控制权。之前我花了很多时间预先设计数据结构和算法，现在我从小处着手，有机地“增长”我的代码。在每个红/绿/重构周期之后，我都有代码可以做*一些事情*。感觉就像我的代码是有生命的东西，我正在指导它应该增长的地方。我不知道当每个人进入 TDD 时是否是这样的，但这是我的经验。令我震惊的是，这与成功的自由软件项目是如何成长而不是设计的如此相似。

然而，现在我已经掌握了测试驱动开发，我开始想知道它的限制是什么。它似乎对开发函数式代码非常有用：将此输入提供给该函数，然后您会得到此结果。但这只是软件开发的一小部分。GUI 开发、网络、数据库开发、Web 应用程序呢？你的经验是什么？您是否曾经尝试过使用 TDD 进行这些类型的开发？你知道任何工具或框架吗？能推荐一些文章或书籍吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T13:58:39.397

“GUI 开发、网络、数据库开发、Web 应用程序呢？”

为什么它不起作用？

**图形用户界面**。TDD 唯一不能做好的就是评估界面的“外观”。但它可以评估行为。如果您的设计做得很好（分离模型、视图和控件），您可以像 TDD 一样轻松地测试控件和模型。然而，视图更难编写测试。（“断言按钮位于字段下方”是不明智的。）

**联网**。不知道这意味着什么。但是，通过 TDD 定义 RESTful Web 服务的效果非常好。定义 URI，编写测试用例，然后构建提供预期响应的服务。

**网络应用程序**。Django Web 框架直接支持 TDD 进行开发。他们对 Web 数据模型和控制层进行了单元测试。另外，他们对 HTML 页面的呈现和行为进行了单元测试。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-23T14:08:17.580

如果您还没有遇到困难的最明显部分，我想知道您在 TDD 中使用什么框架/语言：

*   **GUI** - 某些环境和平台，特别是 Windows 窗体和 ASP.NET Web 窗体，存在实际的不可测试性，因为没有简单的方法来隔离或模拟它们的行为。就此而言，这是 ASP.NET MVC 的主要驱动力之一。

*   **持久性**- 任何类型的持久性，无论是磁盘存储、数据库连接、网络还是其他形式的外部系统都将是一个限制，因为它们都是持久性测试，过于依赖于外部组件成功。这些集成测试然后被认为是*脆弱的测试*。模拟用于减轻此类外部系统的影响。

*   **采用**——即使你精通 TDD，试图让其他开发人员——更不用说整个开发商店——使用它也是一场艰苦的战斗。许多人只是没有看到好处。它们很容易被最初陡峭的学习和生产力曲线关闭。您会遇到这样的情况：您是项目中唯一实践 TDD 的人，即使您强制执行它，其他开发人员也会引入低质量、毫无意义的测试。这个非技术原因是我在现实生产系统中使用 TDD 时遇到的最大障碍，当您充分意识到其好处时，这是一个痛苦的认识。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T13:55:53.053

做 TDD 有一些成本：

*   当您更新代码时，您必须维护您的单元测试以检查新的正确行为。
    *   一旦你有大量的单元测试，当你重构时，你需要重写单元测试

我喜欢 TDD 做很多事情。请记住，保持工作单元测试的上述维护成本可能意味着尽管您的代码变得更加模块化，但选择的模块化组织更难更改。如果没有重写所有单元测试的额外成本，就无法重新组织代码。这确实是我在 TDD 中发现的最大限制。后来，当您意识到自己犯了一个错误时，现在您必须通过所有这些开销来重构事物，而在这些更改可能会更加流畅地发生之前。因此，要很好地使用 TDD，我会说您在首次开发模块时需要做出正确的决定。在我们生活的瞬息万变的敏捷世界中并不总是那么容易；）。

还要考虑：

*   并非所有东西都可以通过类方法进行纯粹的黑盒测试。IE 方法的结果取决于自上次调用以来经过了多少微秒。你需要添加钩子来控制已经过去了多少时间，看看你是否得到了正确的响应。
*   单元测试实际上并不适合所有事情。看一个 GUI 是否可供人类使用，真的永远无法通过单元测试来证明。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T14:06:28.627

就限制而言，重要的是要记住 TDD 是关于稳定性和管理变更的 - 可以说它并不能特别帮助您*更好地*设计，它只是强制实施您的设计*。实际上，提出良好的系统架构仍然需要与任何其他开发方法一样多的思考。

存在各种限制，其中大部分是因为软件仍然需要人类：

*   TDD 对 GUI 布局和一般用户体验等无形资产没有任何帮助
*   TDD 不能解决设计中的garbage-ingarbage-out
*   TDD 不能解决环境问题（即网络、I18N 和时间相关的错误往往会从裂缝中溜走）
*   单元测试本身需要设计（根据框架或多或少地解决）
*   单元测试可以增加重构时所需的工作量（但希望这已被您的精美设计最小化）。
*   经典：单例很难->无法进行单元测试（这里的一般解决方案是避免单例）

* 即使我已经写了，我也不确定如何正确表达。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-23T13:52:00.660

在 grails 上尝试 groovy。您将获得自动生成的测试。

每次自动创建控制器类时，都会生成一个单元测试类。

摘自《Grails 权威指南》一书：

*Grails 将测试分为“单元”和“集成”测试。集成测试引导包括数据库在内的整个环境，因此往往运行得更慢。此外，集成测试通常旨在测试多个类之间的交互，因此需要更完整的应用程序才能运行它们。另一方面，单元测试是快速运行的测试，但它们要求您广泛使用模拟和存根。存根是用于测试的类，通过返回任意硬编码值来模拟方法的真实行为。模拟基本上做同样的事情，但通过“期望”表现出更多的智慧。例如，一个模拟可以指定它“期望”一个给定的方法至少被调用一次，如果需要，甚至十次。*

# asp.net - 我可以通过将 ASP.NET FormsAuthentication cookie 与会话 ID 相关联来使其更安全吗？

> ID：781766
> 
> 赞同：6
> 
> 时间：2009-04-23T13:40:28.923
> 
> 标签：asp.net, security, cookies, forms-authentication

我们注意到可以在另一台机器上重新创建 ASP.NET FormsAuthentication cookie 的副本，从而允许第二台机器无需登录即可进行身份验证。

对此建议的一种解决方案是将会话 ID 存储在其中`FormsAuthenticationTicket.UserData`并检查两个值是否在内部匹配`Application_AuthenticateRequest()`。

我们正在使用：

```
FormsAuthenticationTicket.IsPersistent = false; 
```

这种将 FormsAuthentication cookie 与会话 ID 相关联的方法是个好主意吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-23T17:26:49.040

我认为你想多了这个问题。复制 cookie 的能力只是 cookie 的固有问题 - 任何人都可以拦截任何 cookie 并通过在另一台机器上设置来模拟其中的任何数据。

身份验证 cookie 的“安全性”来自这样一个事实，即没有人可以（据说）手工制作 cookie 来伪造经过身份验证的用户。但是，一旦创建了 cookie，它当然可以用于身份验证。这意味着，为了让您的“问题”发生，您仍然需要先有一个有效的用户登录。如果该用户滥用系统，将他的 cookie 复制到其他机器以授予每个人访问权限，这与用户只是告诉每个人她的用户名和密码完全相同，只是更加迟钝。因此，问题不在于 cookie 的复制——而是用户自己。

另一个攻击媒介是如果网络受到威胁，并且有人可以拦截流量以通过嗅探器或其他方式将 cookie 拼凑起来 - 但同样，这是 cookie 本身固有的。这称为会话劫持，防止这种情况的唯一方法是为您的站点使用 SSL。

如果您真的很担心，我只需将您的身份验证和会话超时设置为相同，然后在您的 global.asax 文件中，只要用户的会话到期，只需调用 FormsAuthentication.Signout() 即可。每当用户完成会话时，这会使身份验证无效，迫使他们稍后再次登录。当然，这可能会给您的用户带来极大的烦恼……

我也强烈推荐[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms998310.aspx)。它可能比我能更好地回答你的问题。

# javascript - Can the parent window be notified when a child window closes? (on a diff domain)

> ID：781770
> 
> 赞同：12
> 
> 时间：2009-04-23T13:41:44.397
> 
> 标签：javascript, events, browser

Can the parent window be notified when a child window closes? (on a different domain?)

Trying to get around the window.opener not working when on different domains.

Can I at least be notified somehow when the child window closes?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T09:25:34.187

您无法直接收到关闭窗口的通知，但您可以通过检查[`closed`](https://developer.mozilla.org/En/DOM/Window.closed)返回的窗口对象引用上的属性来确定子窗口何时关闭[`window.open()`](https://developer.mozilla.org/En/DOM/Window.open)。

`closed`这是一个示例，它将在通过轮询属性关闭子窗口的 5 秒内显示警报：

```
var win = open('http://www.google.com');
var intervalId = setInterval(function() {
        if (win.closed) {
            clearInterval(intervalId);
            alert('Window closed! Hoorah!');
        }
    }, 5000); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-29T16:29:27.270

在弹出窗口中有两条代码 1/ 的更好解决方案：

```
$(window).bind('unload',
  function(){
    window.opener.PopupUnload(window)
  }) 
```

2/ 在父级（主窗口）中：

```
function PopupUnload(wnd){
 setTimeout(function(){ // setTimeout is for IE
   if(wnd.closed)
     alert('You just killed me...')
  },10)
} 
```

使用此代码，不会永远调用任何函数（使用 setInterval()），并且您可以区分关闭和刷新弹出窗口（发布/获取）

（在 IE8 和 FF3 中测试）

# wpf - 带有用户控件的画布中的 MVVM

> ID：781774
> 
> 赞同：0
> 
> 时间：2009-04-23T13:44:03.033
> 
> 标签：wpf, mvvm, canvas

我有一个 MVVM WPF 应用程序，它基本上想成为配电网络的单线图设计器。

我有一个必须包含变压器、断路器、线路和电缆的画布。

我的大问题是设计......我该如何开始？

我想到了一个 DesignerView，DesignerViewModel 包含一个 IDesignerItemViewModel 的 ObservableCollection，它是我所有元素的基类。但在这种情况下，我必须使用 ItemsControl 将画布的内容绑定到我的集合，但优点是我不必为每个元素创建用户控件，但我会用 DataTemplate 解决大部分问题（我想） . 每个元素视图模型都包含一个指向模型的链接，该模型保存在我维护我的逻辑树的存储库中。

关于如何进行的任何提示，我查看了许多 DiagramCanvas 示例，但所有这些都使用简单的项目，最像简单的矩形......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T18:51:19.307

毛罗

一个不错的方法是使 ItemsControl 的 ItemsPanel 成为 Canvas 并将 DataTemplate 中的 UI 元素坐标绑定到 ViewModel 的属性。

尽管在我看来这可能行不通，因为 DataTemplate 的内容不会放在 Canvas 上，而是放在 ItemPresenter 中。因此，也许您可​​以通过基于定义元素类型的某些属性切换触发器中的模板来创建一个可以可视化任何元素的控件。

然后，您可以将 Canvas 的 Children 绑定到这些控件的集合，或者在代码隐藏中以程序方式填充 Canvas.Children 集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-29T11:08:48.517

我即将做类似的事情。我有 Itemscontrol，它的布局为 CANVAS。我的项目是 ShapeItemViewModels，它具有来自 Type Usercontrol 的属性 PayLoad。我的视图有一个边框和一个绑定到我的属性有效负载的 ContentPresenter。然后我根据我的需要注入我的有效载荷。这让我可以随心所欲地组装我的物品......不过我有一个问题......那就是连接/关系，请参见我的线程：

[Silverlight MVVM 中的图表 - 连接形状](https://stackoverflow.com/questions/2529596/diagramming-in-silverlight-mvvm-connecting-shapes)

# cocoa - Cocoa：学习当前选择的键盘布局/输入语言

> ID：781777
> 
> 赞同：5
> 
> 时间：2009-04-23T13:44:56.167
> 
> 标签：cocoa, layout, input

如何学习当前选择的键盘布局/输入语言？

我在玩 NSInputManager 但什么也没做。

```
[NSInputManager currentInputManager] 
```

返回 (null) （如 %@ 报告的那样），因此

```
[[NSInputManager currentInputManager] localizedInputManagerName] 
```

最好只取回所用语言的两个字母缩写，如 EN 或 FR，但菜单栏中显示的键盘布局名称也可以使用。

有任何想法吗？谢谢。

**编辑：**我还发现 AppleSelectedInputSourcesChangedNotification 被发布到

```
[NSDistributedNotificationCenter defaultCenter] 
```

当用户更改布局时，没有关于新选择的布局的信息“附加”到此通知。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T19:32:03.200

语言组合的键盘布局通常是一对多的，因此虽然您可以获得当前选择的键盘布局（或更一般地说，输入源）的本地化名称，但该源可用于以多种语言键入文本。你为什么要这样做？

[也就是说，您可以使用Text Input Source Services](http://developer.apple.com/documentation/TextFonts/Reference/TextInputSourcesReference/Reference/reference.html)获取有关当前文本输入源的信息。例如：

```
 TISInputSourceRef source = TISCopyCurrentKeyboardInputSource();
  NSLog(@"languages: %@",
        TISGetInputSourceProperty(source, kTISPropertyInputSourceLanguages));
  NSLog(@"localized name: %@",
        TISGetInputSourceProperty(source, kTISPropertyLocalizedName)); 
```

给我：

```
2009-04-23 14:30:17.581 sample[30688:10b] languages: (
    en,
    ca,
    da,
    de,
    es,
    eu,
    fr,
    ga,
    gl,
    gv,
    id,
    it,
    kw,
    ms,
    nb,
    nl,
    nn,
    om,
    pt,
    so,
    sq,
    sv,
    sw
)
2009-04-23 14:30:17.584 sample[30688:10b] localized name: U.S. 
```

# time-complexity - 除法算法 - 时间复杂度

> ID：781788
> 
> 赞同：3
> 
> 时间：2009-04-23T13:48:13.867
> 
> 标签：time-complexity

任何人都可以帮助解决这个算法的时间复杂度，以及为什么它是 O(n^2)。一步一步的解释会很有帮助，谢谢！

```
function divide(x,y)
    Input: Two n-bit integers x and y, where y >= 1
    Output: The quotient and remainder of x divided by y

    if x = 0:
        return (q,r) = (0,0)

    (q,r) = divide(x/2, y)
    q = 2q
    r = 2r

    if x is odd:
        r = r + 1

    if r >= y:
        r = r - y
        q = q + 1

    return (q,r) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:22:03.753

由于递归，divide() 最多被调用 n 次。

假设对 n 位整数的简单算术需要 O(n) 时间。（这在我所知道的所有大整数实现中都是正确的——例如，在 Python 中，将 1 加到大整数会复制整个事物。）

然后我们有有限数量的 O(n) 操作最多发生 n 次。这需要 O(n^n) 时间。

```
def divide(x, y):
    assert y >= 1
    if x == 0:
        return 0, 0
    q, r = divide(x // 2, y)
    q *= 2
    r *= 2
    if x & 1:
        r += 1
    if r >= y:
        r -= y
        q += 1
    return q, r 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T16:38:54.273

最坏的情况，x 中的每一位都是 1（例如 0xffff），是 O(n)。诀窍是将递归转换为迭代。

# asp.net - ASP.NET 异步方法问题

> ID：781789
> 
> 赞同：5
> 
> 时间：2009-04-23T13:48:53.663
> 
> 标签：asp.net, database, asynchronous

最近有一位开发人员告诉我，您应该始终异步执行数据库调用。（使用 ThreadPool.QueueUserWorkItem 或 IAsyncResult 和委托）

他的理由是这样的：IIS 只有 24 个（左右）可以用于请求的线程。当用户提出请求时，他们会获得其中一个线程。但是，当您使用异步方法时，您将访问 IIS 范围之外的 Windows 线程。他说，当您以这种方式使用异步方法时，您将初始线程释放给其他用户的请求，并将其转移到 Windows 线程（对于该线程的生命周期）。

你怎么看？所有数据库调用都应该是异步的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:55:05.770

你有理由相信你会遇到这样的瓶颈吗？这种编程风格很难，您必须有充分的理由采用这种方法。

默认情况下限制为 20 个工作线程，但请记住这是每个 CPU 内核的限制。如果这个限制成为一个问题，因为 ASP.NET 变得空闲等待数据库查询完成，为什么不只是增加一点线程限制（我实际上并不是建议你这样做，因为我实际上不认为这是必要的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T14:02:03.553

工作线程数量有限。这些与 ASP.NET 有关，而不是 IIS（在 IIS7 中除外，它们是相同的）。确实，数据库调用或任何其他调用都使用了这些线程之一。在 ADO.NET 调用的情况下，可以将页面编写为异步页面，其中在数据库操作进行时不使用线程。

除非您确实遇到问题，否则您不应该为此烦恼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:36:19.320

如果您的站点非常成功，以至于您最终缺少服务请求的线程，那么购买另一个 Web 服务器会更便宜、更简单且不易出错。

您可能会提醒该开发人员线程切换不是免费操作，并且在*某些*情况下可能需要比 db 调用更长的时间。

# c++ - 如何在 Visual Studio 中调试单个 .cpp 文件？

> ID：781792
> 
> 赞同：3
> 
> 时间：2009-04-23T13:49:11.073
> 
> 标签：c++, visual-studio-2008, debugging

有没有办法在 Visual Studio.NET 中调试单个文件？我仍然是 C++ 的菜鸟，但我想开始学习如何熟悉调试器，并且现在我正在编写非常小的文件。

似乎只有一个源文件，它不会让我调试，但是当我添加另一个时，我可以。我正在使用 VS.net 2008。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T14:00:00.407

它不想要另一个源文件，它想要一个项目文件。

Visual Studio 需要大量信息来了解如何编译和调试源代码。诸如要使用哪些优化设置、在哪里查找`boost`标头之类的事情。

试试这个：去`File->New->Project...`选择一个 win32 控制台应用程序。在下一个向导中，转到`Application Settings`并选中“Empty Project”，然后点击 OK。

现在您有空的项目和解决方案文件，您可以将它们复制/粘贴到任何您想要的地方；要调试，只需打开`.sln`文件，拖入您的单个`.cpp`文件，然后按 F5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:50:44.733

您是否在尝试调试的这个 cpp 中定义了一个主例程？您添加的使其正常工作的 cpp 是否具有主程序？

您总是可以编译一个 cpp 文件，但该语言将您的应用程序的入口点定义为

```
int main()
{
} 
```

（或带有 argv/argc 命令行参数的签名，但这在这里并不重要）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:05:50.503

每当我想快速调试控制台程序时，我发现控制台是最好的起点。所以我采用了一个 C++ 程序（blah.cpp）：

```
int main ()
{
    for (int i = 0; i < 100; i++)
        printf ("Hello World ... etc \n");
} 
```

然后在控制台上设置我的环境（来自 cmd.exe）：

```
vcvars32 
```

然后编译我的程序（Zi 是为了让我得到一个 blah.pdp 来调试）：

```
cl /Zi blah.cpp 
```

瞧，我有一个可以运行的 blah.exe。如果我想调试 blah.exe，我只需从 VS2008 打开一个项目并选择 blah.exe 而不是项目文件。我可以在 IDE 中打开 blah.cpp 并运行 (F5)、设置断点 (F9) 并根据我的内心内容进行调试 (F10,F11)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:54:52.540

在 VS.net 2008 中创建一个 Visaul C++ 控制台应用程序，然后将要调试的 cpp 文件添加到项目中。

从主例程调用该 cpp 文件中定义的函数，该函数将在您创建控制台项目时由 VS.Net 2008 为您创建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T13:57:37.463

我通过以下方式调试：

*   在我想要的地方放一个断点。
*   在 Visual Studio 中构建应用程序。
*   按 F5 使用调试器启动应用程序（如果它是您正在调试的 dll，您需要在项目属性中设置调用该 dll 的 exe）。
*   利润！:)

如果断点从通常的红点变为黄色三角形，则意味着您没有调试您认为的代码 - 通常在您的 dll 未加载时发生这种情况。如果你正在调试一个 exe，那么你不会看到这个。

此外，请确保您已构建（并具有项目类型）为 Debug。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T14:00:03.650

您需要创建一个解决方案才能进行调试。之后，您拥有多少源文件并不重要。您可以使用 File->New 菜单创建解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-16T13:45:03.363

该线程很旧，但我的回答可能会帮助其他人，因为我面临同样的问题。我使用[Bloodshed DevC++](http://www.bloodshed.net/devcpp.html)编译单个 C++ 文件。无需使用 Visual Studio 创建整个项目。

# svn - 遗留代码的版本控制帮助

> ID：781801
> 
> 赞同：0
> 
> 时间：2009-04-23T13:51:32.487
> 
> 标签：svn, version-control, solaris, legacy-code

我正在为遗留系统寻找某种备份/版本控制方法：

*   系统是在 BASIC 版本中开发的。这是一个解释版本。程序保存在一些伪代码中；不是纯文本。
*   所有制作程序都存储在同一个文件夹树中，根据类别分为文件夹。
*   没有颠覆策略，除了将要修改的程序的先前版本存储到名为**old_versions**的子文件夹中。每个类别文件夹中都有一个**old_versions子文件夹。**示例：**/programs/accounts_payable/old_versions/**
*   程序**在生产环境**中即时修改。
*   系统在 Solaris 服务器上运行

**我想要一些实时备份的方法，每个修改的程序，存储在一个单独的位置。** 没有什么花哨。它不需要进行回滚或更改比较。它只需要**保存程序的最新版本**。

谢谢。

PS：是的，我真的很生气，很绝望。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:12:19.957

在不改变你的开发过程的情况下，也许一种方法是在 shell 脚本中使用 rsync 或类似的东西，每 xx 分钟拍摄一次快照，并将它们发送到另一个位置。

我认为最好的解决方案是迁移到 VCS，我个人建议使用 git 或 svn，并停止在生产中编辑代码。如果需要，你总是`svn export`可以得到一棵干净的树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:13:50.483

IBM Tivoli 可能适合您。

我过去以大约 50 美元的价格购买了它。它监视您设置的文件/文件夹的更改，并将副本（或增量，我不知道）写入您指定的位置。

我希望我能给你一个程序的链接，但是在与 IBM 网站（再次）打了 5 分钟之后，我沮丧地放弃了。他们的产品是可靠的，他们的网站或购买方法是，嗯，不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T21:55:01.470

如果在生产环境中即时修改软件，我会谦虚地建议实时备份不是解决问题的方法。它可能会解决错误的结果，同时完全忽略根本原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T20:45:43.973

你可以看看rsnapshot；见[http://www.rsnapshot.org/](http://www.rsnapshot.org/)。它可以制作目录树的多个快照，使用硬链接文件来节省文件未更改的空间。

# java - 在 Java 应用程序运行时定义一个类

> ID：781805
> 
> 赞同：17
> 
> 时间：2009-04-23T13:52:14.293
> 
> 标签：java, on-the-fly, runtime-compilation

在 Java 中，是否可以在应用程序运行时动态创建类定义，然后创建该类的对象？

例如，一个正在运行的应用程序将读入一个文本文件，该文件包含要包含在新类中的类成员列表。然后，应用程序将根据成员列表定义一个类定义，然后实例化它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T13:56:42.910

是的，理论上可以这样做，您的类文件是字节码，最后是字节数组！然后，您可以使用方法 defineClass(String, byte[], int, int) 来获取可用于通过反射实例化对象的 Class 实例。

在实践中，您可以使用[CGLib](http://cglib.sourceforge.net/)或[javaassist 之](http://www.csg.is.titech.ac.jp/~chiba/javassist/)类的东西。

您还可以使用长方法在文件中生成 java 代码，调用编译器，然后加载文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T13:59:07.383

[您可以使用ASM](http://asm.ow2.org/)动态生成类

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:54:21.200

为此，您可以将新类的代码写入文件，然后在该文件上调用 Java 编译器并使用类加载器将该类动态加载到正在运行的应用程序中。Apache Tomcat 为其 JSP 页面执行此操作；它获取代码，对其进行一些更改，将其包装在类中间的 try/catch 块中，然后将其写入文件系统，编译它，并使用类加载器获取并起诉它以服务请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T13:57:07.747

当然有可能。例如见这篇[文章](http://www.javaworld.com/javaworld/jw-06-2006/jw-0612-dynamic.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T14:22:44.190

[我想ASM](http://asm.ow2.org/)是 Java 的最低级字节码库。这使得它非常困难，但也非常强大。我建议阅读 ASM 的文档 ( [PDF](http://download.forge.objectweb.org/asm/asm-guide.pdf) ) 以真正了解 Java 中字节码生成的工作原理。该文档还解释了如何在类加载器中加载字节码（另一个很难做到的话题）。

之后，您可以使用更高级别的库之一，如果它使您的生活更轻松，并了解它们的作用。对于许多情况，例如生成代理，[CGLIB](http://cglib.sourceforge.net/)非常有用且易于使用。为了获得更多功能，许多人提到了[Javassist](http://www.csg.is.titech.ac.jp/~chiba/javassist/)（我没有使用它 - CGLIB 和 ASM 对我有好处）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T15:03:05.763

也许*最简单*的解决方案（就不需要额外的库而言）是使用 Java 6 附带的[Java 编译器 API](http://java.sun.com/javase/6/docs/api/javax/tools/JavaCompiler.html)。您只需能够生成 .java，编译然后执行 Class.forName()。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T14:00:51.183

也许有点矫枉过正，[Apache BCEL](http://jakarta.apache.org/bcel/)（字节码工程库）可用于`class`在运行时创建文件。

虽然我自己没有尝试过，但可以想象，可以创建一个类，加载它，并在运行时实例化它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T14:00:54.553

是的，这是可能的。

您可以通过定义类的主体并使 javassist 编译您的新类，在运行时使用[Javassist创建类。](http://www.csg.is.titech.ac.jp/~chiba/javassist/)

Javassist 有一个自定义编译器，可以根据您的类的定义创建字节码。它有一些特殊的方法来处理事情，但是使用这个库非常容易和直观。

Javassist 用于 JBoss，我认为这是一个很好的参考 :)

[使用BCEL](http://jakarta.apache.org/bcel/)也可以实现相同的目的，但是要困难得多（但是通过这种方式，您可以更好地控制正在生成的内容）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-23T14:03:33.987

如果必须的话，您可以使用 JRuby、JPython 或 Groovy 来做类似的事情。

如果你感觉特别受虐，你可以看看[BCEL](http://jakarta.apache.org/bcel/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-23T14:09:28.323

如果您想要 Java 和元编程，请使用[Groovy](http://groovy.codehaus.org/)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-23T16:34:50.867

最近有一个关于[内存编译](https://stackoverflow.com/questions/616532/on-the-fly-in-memory-java-code-compilation-for-java-5-and-java-6)的问题，它应该会给你一些提示，告诉你在你设法生成源代码后该做什么。

# asp.net - ASP.NET SqlServer 会话复制

> ID：781809
> 
> 赞同：3
> 
> 时间：2009-04-23T13:53:02.157
> 
> 标签：asp.net, sql-server, session

好奇人们是否在 ASP.NET 用于 SqlServer 存储会话状态（ASPStateTempSessions 和 ASPStateTempApplications）的表和用于成员资格、角色和个性化的表上设置了 2 路事务复制？效果如何？有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-01T14:26:33.290

显然你可以做到这一点，只需要编辑一个存储过程，它有一个小错误，你最终会出错

> 列名或提供的值的数量与表定义不匹配。

为了避免这种情况，只需更改存储过程**TempGetAppID**

由此

```
INSERT [YOURDBNAME].dbo.ASPStateTempApplications
            VALUES
            (@appId, @appName) 
```

到

```
INSERT [YOURDBNAME].dbo.ASPStateTempApplications
            (AppId,AppName)
            VALUES
            (@appId, @appName) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T21:16:43.620

对于会员资格，您可能对复制没问题，尽管集群可能更适合扩展。对于状态，我更倾向于使用集群。

我想说的例外是当您拥有一组地理上分开的服务器时，但很少有网站，除了一些最大的、地理上分开的网站。

我曾经在状态表或成员表上进行过复制吗？不。

# c# - 需要帮助从 .NET JITted 代码中破译一行汇编代码

> ID：781811
> 
> 赞同：4
> 
> 时间：2009-04-23T13:53:49.453
> 
> 标签：c#, assembly, jit, access-violation

在 C# 构造函数中，最终调用`this(...)`，实际调用被转换为：

```
0000003d  call        dword ptr ds:[199B88E8h] 
```

这里的 DS 寄存器内容是什么？我知道这是数据段，但是这个调用是通过 VMT 表还是类似的？不过我对此表示怀疑，因为`this(...)`不会调用虚拟方法，而只是调用另一个构造函数。

我问是因为该位置的值在某种程度上似乎很糟糕，如果我按 F11，跟踪到（Visual Studio 2008），在该调用指令上，程序会因访问冲突而崩溃。

该代码位于第 3 方控件库的深处，虽然我有源代码，但我没有使用足够的调试信息编译的程序集，我可以通过 C# 代码跟踪它，只能通过反汇编程序，然后我有将其与实际代码相匹配。

有问题的 C# 代码是这样的：

```
public AxisRangeData(AxisRange range) : this(range, range.Axis) {
} 
```

Reflector 向我展示了这个 IL 代码：

```
.maxstack 8
L_0000: ldarg.0 
L_0001: ldarg.1 
L_0002: ldarg.1 
L_0003: callvirt instance class DevExpress.XtraCharts.AxisBase DevExpress.XtraCharts.AxisRange::get_Axis()
L_0008: call instance void DevExpress.XtraCharts.Native.AxisRangeData::.ctor(class DevExpress.XtraCharts.ChartElement, class DevExpress.XtraCharts.AxisBase)
L_000d: ret 
```

正是最后一次调用同一类的另一个构造函数失败了。调试器永远不会出现在其他方法中，它只会崩溃。

JITting之后的方法反汇编是这样的：

```
00000000  push        ebp  
00000001  mov         ebp,esp 
00000003  sub         esp,14h 
00000006  mov         dword ptr [ebp-4],ecx 
00000009  mov         dword ptr [ebp-8],edx 
0000000c  cmp         dword ptr ds:[18890E24h],0 
00000013  je          0000001A 
00000015  call        61843511 
0000001a  mov         eax,dword ptr [ebp-4] 
0000001d  mov         dword ptr [ebp-0Ch],eax 
00000020  mov         eax,dword ptr [ebp-8] 
00000023  mov         dword ptr [ebp-10h],eax 
00000026  mov         ecx,dword ptr [ebp-8] 
00000029  cmp         dword ptr [ecx],ecx 
0000002b  call        dword ptr ds:[1889D0DCh]   // range.Axis
00000031  mov         dword ptr [ebp-14h],eax 
00000034  push        dword ptr [ebp-14h] 
00000037  mov         edx,dword ptr [ebp-10h] 
0000003a  mov         ecx,dword ptr [ebp-0Ch] 
0000003d  call        dword ptr ds:[199B88E8h]   // this(range, range.Axis)?
00000043  nop              
00000044  mov         esp,ebp 
00000046  pop         ebp  
00000047  ret 
```

基本上我要问的是：

*   `ds:[ADDR]`这里间接的目的是什么？VMT-table 仅用于虚拟不是吗？这是构造函数
*   构造函数是否还没有被 JITted，这可能意味着调用实际上会通过 JIT shim 调用？恐怕我在这里深陷困境，所以任何事情都可能而且可能会有所帮助。

* * *

**编辑**：嗯，问题只是变得更糟，或者更好，或者其他什么。

我们正在 Visual Studio 2008 解决方案中的 C# 项目中开发 .NET 功能，并通过 Visual Studio 进行调试和开发。

但是，最终，此代码将加载到由 Win32 Delphi 应用程序托管的 .NET 运行时中。

为了方便对这些功能进行实验，我们还可以配置Visual Studio项目/解决方案/调试器，将生成的dll复制到Delphi应用程序的目录，然后通过Visual Studio调试器执行Delphi应用程序。

事实证明，如果我在调试器之外运行程序，问题就会消失，但在调试期间，它每次都会出现。

不确定这是否有帮助，但由于代码不会在另外 6 个月左右的时间内用于生产发布，因此我们很快就会为测试发布减轻一些压力。

稍后我将深入研究内存部分，但可能要到周末，然后发布后续内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T14:31:49.830

数据段是编译器通常放置全局变量的地方，也是导入地址表所在的地方。

```
00000029  cmp         dword ptr [ecx],ecx 
0000002b  call        dword ptr ds:[1889D0DCh] 
```

第一行实际上是一个空检查，`NullReferenceException`如果位于 ECX 寄存器中的指针无效，它最终会引发 a。

MSIL 指令必须在`callvirt`调用实际方法之前进行空值检查。话虽如此，我们可以放心地假设这两行汇编代码具有以下 MSIL 代码表示：

```
class DevExpress.XtraCharts.AxisBase DevExpress.XtraCharts.AxisRange::get_Axis() 
```

和注释的汇编代码：

```
00000026  mov         ecx,dword ptr [ebp-8]      // store the pointer to the 'range' in ECX
00000029  cmp         dword ptr [ecx],ecx        // null-check
0000002b  call        dword ptr ds:[1889D0DCh]   // range.get_Axis()
00000031  mov         dword ptr [ebp-14h],eax    // store the result in a local variable
00000034  push        dword ptr [ebp-14h]        // push the result onto a stack
00000037  mov         edx,dword ptr [ebp-10h]    // this variable was previously loaded with the 'range' pointer
0000003a  mov         ecx,dword ptr [ebp-0Ch]    // here seems to be stored the actual 'this' pointer
0000003d  call        dword ptr ds:[199B88E8h]   // call the this(...) ctor 
```

我不清楚它为什么会崩溃，您是否尝试过查找内存位置（`DS:[199B88E8h]`）的内容？

# c# - WCF 教程出现错误 400（错误请求）？

> ID：781815
> 
> 赞同：2
> 
> 时间：2009-04-23T13:54:18.487
> 
> 标签：c#, wcf, web-services

我昨晚开始使用 WCF 来设置一个简单的客户端服务器，它允许我在会话开始时向客户端发送游戏信息。

我遵循了关于 WCF 的 microsoft 教程并使用 VS2008“WcfSerivce”模板开始并添加了我的方法。然后，我将它给我的地址复制并粘贴到我的客户端项目的服务引用对话框中，并添加了从服务器获取数据的代码。但是现在的问题是，无论如何，当我请求数据时它总是返回错误 400。

我用谷歌搜索了这个错误，发现很多人都遇到了超出某个消息大小限制的问题，但即使该方法只返回一个字符，我也会收到这个错误。

我唯一能想到的是URI或命名空间地址是错误的，它们应该是什么值呢？谢谢

编辑：这是我在服务和客户端中使用的代码，我不确定发布大量文本的规则是什么，所以我把它放在 Pastebin 上，但如果这里允许，我将再次编辑

[http://pastebin.ca/1401443](http://pastebin.ca/1401443)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T13:58:05.683

您应该能够在服务项目上点击“播放”，它将导航到显示可用方法等的屏幕。这是您需要在客户端中使用的 url。

这是你已经在做的吗？或者您是否使用示例中的网址？特别是，如果您使用的是集成开发 Web 服务器（而不是 IIS），端口号很可能是随机的。

一个工作的 WCF 服务项目将生成一个类似的页面：

> {YourService} 服务
> 
> 您已经创建了一个服务。
> 
> 要测试此服务，您需要创建一个客户端并使用它来调用该服务。您 > 可以使用命令行中的 svcutil.exe 工具执行此操作，语法如下：
> 
> ...

如果您可以*使其*正常工作，请尝试添加客户端参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-11T16:45:14.920

如果其他人遇到/遇到此问题，则这是 Windows 7 兼容性问题。我在 RTM 上试过，它可以工作。

# java - 如何在jboss中收集与单个请求相关的日志？

> ID：781817
> 
> 赞同：3
> 
> 时间：2009-04-23T13:54:28.237
> 
> 标签：java, logging, jboss, log4j

我正在开发一个在 JBoss 下运行的 Java EE Web 应用程序。

我想做以下事情：当用户发送 http 请求（通过打开页面或通过 AJAX）时，与该请求相关的所有日志都会被收集，然后保存到数据库中。相关是指在处理当前请求的过程中记录它们。最难的部分是收集与单个请求相关的日志。

我正在研究这个解决方案：

JBoss 使用 log4j 进行日志记录。当应用程序启动时，启动监听器注册一个 log4j appender，它将所有日志收集到一个 ThreadLocal 字段中。在请求处理结束时，从现场获取日志并保存到数据库中。

但是，现在看来，log4j 附加程序在其他线程中工作。这使得这个解决方案是不可能的。

你有什么想法，这是怎么做到的？

谢谢，Artem B.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T14:39:51.293

您可以使用 log4j [MDC 类](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html)（映射诊断上下文）将某些数据与当前线程相关联。

我经常使用它来将会话 ID 添加到日志输出中，以用于该会话的任何日志记录：

```
public class AddSessionIdToLogFilter implements Filter {

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException,
            ServletException {

            if (request instanceof HttpServletRequest) {
                HttpServletRequest httpRequest = (HttpServletRequest) request;
                String sessionID = httpRequest.getSession().getId();

                MDC.put("SessionID", sessionID);
            }   

            ... 
```

然后，您只需在 PatternLayout 中按键引用 MDC。不确定 DB appender 是如何工作的，但我认为它也可以记录 MDC 字段......

```
log4j.appender.LOGFILE.layout.ConversionPattern= ... [SessionID=%X{SessionID}] ... 
```

# visual-c++ - 调试 Visual C++ 内存分配问题

> ID：781821
> 
> 赞同：0
> 
> 时间：2009-04-23T13:55:13.147
> 
> 标签：visual-c++, heap-memory, pageheap

我正在调试一个最终崩溃并显示以下消息之一的软件：

```
1\. DAMAGE: after normal block (#24729280) at 0x00D710E0
2\. Debug Assertion Failed
   Program: D:\Soft\Test.exe
   File: dbgheap.c
   Line: 1017

   Expression: _BLOCK_TYPE_IS_VALID(phead->nBlockUse) 
```

该软件确实很旧，但现在更改它不是一种选择。它是在 Visual C++ 6.0 上编写的。我们猜测这是某种缓冲区溢出，因此我们正在尝试寻找方法来检测它发生的位置。

我找到了有关[PageHeap](http://www.debuginfo.com/tips/userbpntdll.html)（似乎能够告诉我我想要什么）和[GFlags](http://support.microsoft.com/?scid=kb;en-us;286470&x=10&y=7)的信息，但似乎我无法使其工作。

我创建了一个测试程序：

```
char* test;
test = new char[5];
test[5] = 'a';
delete[] test; 
```

这引发了一个错误：

```
DAMAGE: after normal block (#55) at 0x1671920 
```

然后，我尝试通过运行将 PageHeap 附加到它：

```
gflags.exe /p /enable MemoryTest.exe /full 
```

然后重新运行它（通过 Visual C++ 6.0 界面和 Windows 资源管理器），导致相同的错误。

然后我尝试编译发布版本，并通过Visual C++ 6.0界面运行，得到错误：

```
User breakpoint called from code at 0x7c90120e 
```

从 Windows 资源管理器中，我刚刚得到了 Windows 对话框，要求我发送错误报告。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:44:51.627

您可以通过附加到[Windbg](http://en.wikipedia.org/wiki/WinDbg)在发布模式下运行您的应用程序。

*   启用 `gflags`（如您所述）
*   以发布模式启动应用程序。
*   `Attach to process`使用 Windbg 中的选项将其附加到Windbg。
*   为发布 PDB 配置正确的路径。
*   `.reload /f`如果自动加载失败，请手动重新加载 PDB 。
*   执行用例。

只要发生异常，WinDbg 就会停止执行。对于每一个第一次机会异常，分析原因。这可能是崩溃的错误之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:17:14.127

在使用 gFlags/PageHeap 之前，我建议您检查访问冲突异常。首先使用 Build->Start Debug->Attach to process 选项附加进程。附加后，通过转到 Debug->Exceptions 选择 Access Violation 并选中复选框 Stop Always 来启用访问冲突异常。然后检查您的调试器是否捕获任何访问冲突异常。

# c# - 如何将提升权限的代码从 C# 转换为 VB.Net 以用于 SharePoint？

> ID：781824
> 
> 赞同：1
> 
> 时间：2009-04-23T13:56:00.977
> 
> 标签：c#, vb.net, sharepoint

我已经构建了一种从 SharePoint 中提取一些 UserProfile 信息的方法。它在 C# 中工作得很好，但我不知道如何将它的一部分转换为 VB.NET。我在 VB 方面不是很好，但通常在线的基本代码转换器可以解决我遇到的任何问题。问题与下面的 SPSecurity.RunWithEleveatedPrivilages 部分有关。有谁知道如何在VB中实现委托代码？

```
 public List<MyData> GetData(string id)
 {
     List<MyData> mylinks = new List<MyData>();
     SPSecurity.RunWithElevatedPrivileges(delegate
     {    
         var mgr = new UserProfileManager(ServerContext.GetContext("MySSP"));
         UserProfile profile = null;
         try
         {
             profile = mgr.GetUserProfile(id);
         }
         catch { }

         QuickLinkManager qlmgr = new QuickLinkManager(profile);
         QuickLink[] ql = qlmgr.GetItems();

         for (int i = 0; i < ql.Length; i++)
         {
              mylinks.Add(new MyData(ql[i].Url, ql[i].Title));
         }
     });
     return mylinks;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:58:35.480

使用该函数创建一个新委托。（不是匿名的）

然后使用`SPSecurity.RunWithElevatedPrivileges(New DelegateName(Addressof yourfunction))`

*也许.NET 3.0+ 有更好的方法我不确定*

# matlab - 在 MATLAB GUI 中显示结果

> ID：781825
> 
> 赞同：2
> 
> 时间：2009-04-23T13:56:08.683
> 
> 标签：matlab, user-interface, matlab-guide

我正在使用 MATLAB GUIDE 创建一个简单的 GUI。我想知道`uicontrol`我应该使用哪个来显示一些结果：可编辑文本或静态文本。另外，我不希望新结果取代旧结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T15:26:56.100

我会使用静态文本框，因为我怀疑您是否希望用户修改任何文本。

如果要将结果附加到静态文本框，则应首先获取文本框中包含的旧文本（如果尚未将其存储在另一个变量中）。然后将新文本附加到该文本并更新静态文本框。例如：

```
hText = uicontrol('Style','text','String','This is my text string.');
newString = 'Add this line!';
set(hText,'String',strvcat(get(hText,'String'),newString)); 
```

我认为这通常会起作用。但是，如果您已将字符串设置为元胞数组，*则可能*必须使用以下内容而不是上面的最后一行：

```
set(hText,'String',[get(hText,'String') {newString}]); 
```

要了解有关“字符串”属性的更多信息，您可以[在此处查看](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/uicontrol_props.html)有关 uicontrol 属性的 MATLAB 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:04:18.447

[static](http://blinkdagger.com/matlab/matlab-gui-graphical-user-interface-tutorial-for-beginners)，因为您不希望用户能够编辑它（我猜）。

# wpf - 如何实现一个多平台的多媒体应用？

> ID：781826
> 
> 赞同：2
> 
> 时间：2009-04-23T13:56:14.393
> 
> 标签：wpf, windows, cocoa, macos, mono

您将在何种技术基础上实现多媒体应用程序，该应用程序必须满足以下要求：

*   平台：Windows XP/Vista、Mac OS X、Linux（很高兴拥有）
*   应该从本地磁盘播放音频（mp3）和视频（H.264 会很棒）

我研究了[Cocotron 之](http://www.cocotron.org)类的东西，它是一个类似于 Cocoa 的跨平台 Objective-C API，但我不太确定它是否是正确的选择。

为每个操作系统（Windows 上的 WPF，Mac OS X 上的 Cocoa）拥有一个单独的代码库会更简单吗？

我还尝试了基于浏览器的应用程序（Flash-Player，通过 VLC 提供的流媒体服务器访问本地文件），但得出的结论是，这将是一个非常脆弱的解决方案。

单声道怎么样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T14:11:23.140

我会考虑的一件事是可能以某种多平台方式编写您的核心引擎，可能在 python 中，但可能在 C 中，使用在所有平台上都可用二进制文件的库。然后，每个平台都有多个前端，即用于 OSX 的 Cocoa、Windows 特定代码和用于 linux 的 GTK。

但是，从维护的角度来看，更简单的解决方案可能是仅用作[QT之类的跨平台工具包](http://www.qtsoftware.com/products/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T13:59:09.410

我会建议：

*   [QT](http://www.qtsoftware.com/products)或[GTK+](http://www.gtk.org/)用于用户界面，
*   C 或 C++ 用于控制逻辑，
*   用于播放器/转换器的[ffmpeg](http://www.ffmpeg.org/)或[Quicktime](http://developer.apple.com/quicktime/download/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:25:48.817

为什么不看看 VLC 是如何做到的呢？ [http://www.videolan.org/vlc/](http://www.videolan.org/vlc/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T20:21:13.880

Adobe Air (Flex/Actionscript) 可能是您最好的选择，MONO (.NET) 紧随其后。

他们都在推动跨平台、多媒体，而不是看起来像的浏览器体验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T13:51:20.787

是的，我现在不推荐 Cocotron，不支持音频/视频。

您可以看看使用 QuickTime，因为它适用于 OSX，并且有一个适用于 Windows 的 SDK。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T14:30:04.297

我不得不承认，我认为 Flash（甚至是过去的爆炸，导演）将远没有 Mono 脆弱。它们也不需要大型运行时安装。

我说的不是在浏览器中运行的 Flash，而是在本地计算机上作为应用程序运行的 Flash。诚然，Linux 支持是粗略的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T03:20:45.330

如果您只是编写需要播放 H.264 和 Mp3 文件的应用程序，我会推荐 Adob​​e AIR。您将获得开箱即用的 H.264 和 AAC 音频支持，并且能够非常轻松地在 Windows/Mac/Linux 上进行部署。

如果您想要更传统的方法，我建议使用[QT](http://qt.nokia.com/)作为跨平台 UI 框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T22:48:39.420

我们将 WinForms 用于[塑料](http://www.plasticscm.com)

# sql-server - 有没有办法从 SQL Server 数据库自动创建属性？

> ID：781827
> 
> 赞同：1
> 
> 时间：2009-04-23T13:56:23.973
> 
> 标签：sql-server, vb.net, visual-studio-2008, visual-studio-2005

使用 Visual Studio .NET 2008 或 2005，有没有办法为 SQL Server 数据库表中的每一列自动生成属性？

我假设存在其他可以执行此操作的代码生成软件。我知道使用 Visio 我可以连接到我的数据库，它会按表生成图表，这与此类似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T13:58:42.470

.NET 3.5 (VS2008) 中的 Linq2SQL 是您正在寻找的。

将 Linq2SQL DBML 文件添加到您的解决方案/项目

使用 SErver Explorer 创建到数据库的连接

拖放表/视图/Sprocs

代码生成已为您完成......（而且它非常酷:)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T06:02:19.457

mygeneration 真的很酷，还可以让你创建自己的模板，让你有强大的能力来生成用于数据访问、实体类等的“常用”类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-13T19:12:01.440

代码史密斯：

```
<%-- 
Name: Database Table Properties
Authors: Paul Welter , Yordan Georgiev
Description: Create a list of properties from a database table with a region for each prop
--%>
<%@ CodeTemplate Language="C#" TargetLanguage="C#" Debug="False" Description="Create a list of properties from database table." %>
<%@ Property Name="SourceTable" Type="SchemaExplorer.TableSchema" Category="Context" Description="Table that the object is based on." %>
<%@ Map Name="CSharpAlias" Src="System-CSharpAlias" Description="System to C# Type Map" %>
<%@ Assembly Name="SchemaExplorer" %>
<%@ Import Namespace="SchemaExplorer" %>

<% foreach (ColumnSchema column in this.SourceTable.Columns) {  %>

#region <%= StringUtil.ToPascalCase(column.Name) %>
private <%= CSharpAlias[column.SystemType.FullName] %> _<%= StringUtil.ToPascalCase(column.Name) %>;

public <%= CSharpAlias[column.SystemType.FullName] %> <%= StringUtil.ToPascalCase(column.Name) %>
{
    get { return _<%= StringUtil.ToPascalCase(column.Name) %>; }
    set { _<%= StringUtil.ToPascalCase(column.Name) %> = value; }
}
#endregion <%= StringUtil.ToPascalCase(column.Name) %>
<% } %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T13:58:41.750

查看我的[世代](http://www.mygenerationsoftware.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-13T19:30:07.560

SubSonic/Rob Connery 发表了关于使用 T4 作为生成[存储库](http://blog.wekeroad.com/tag/t4/)的工具的博客。T4 在 VS 2005 SDK 中并且是 VS 2008 的原生。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-13T19:58:59.517

Visual Studio 数据集设计器也可以为您完成此操作。它可以很容易地生成环绕您的数据库对象的类。只需将一个新的 DataSet 添加到您的应用程序。

# software-design - 如何处理软件中荒谬功能的请求？

> ID：781828
> 
> 赞同：12
> 
> 时间：2009-04-23T13:56:31.460
> 
> 标签：software-design

当然，大多数时候这种类型的请求来自管理层，他们既不知道用户真正想要什么，也不知道构建特定软件项目或一般软件的技术方面。有关更多详细信息，请参见[呆伯特的尖头 Boss](http://en.wikipedia.org/wiki/Pointy-Haired_Boss)。

然而，这只是一方面。对您知道会损害您正在构建的系统的整体性能的项目的请求怎么办？或者，那些愚蠢地被赋予了权力，但他们所做的几乎所有事情都变成了傻瓜的技术白痴呢？（见[这篇文章](https://stackoverflow.com/questions/780092/on-being-a-contractor-at-a-shop-where-they-dont-use-database-indexes)一个很棒的例子）

最终，你如何雄辩地、专业地、温和地处理对你正在构建的东西的要求或法令，你知道这些最终会损害项目？

* * *

**欺骗**：[当客户要求一些可笑的事情并坚持](https://stackoverflow.com/questions/416779/when-the-client-asks-for-something-ludicrous-and-insists)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T14:02:41.227

始终将任何请求与金钱联系起来。提出这些要求的人通常更关心金钱，因此请确保他们知道这会花费更多，因为：

*   需要更长的时间
*   它可能会引入更多错误
*   可能会减慢维护速度
*   它将减缓与之相关的新功能的开发

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-23T14:09:09.980

我找到了“我们应该在第二阶段这样做吗？”这句话。创造奇迹，可能支持“我认为我们可以在没有它的情况下进行管理 - 让我们先把东西拿出来”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-23T14:17:10.177

你选择的武器应该是**估计**。荒谬的功能，通常伴随着荒谬的估计。当*must have feature X*得到一个 3 人年的估计时，它神奇地变成了，*很高兴有 feature X*。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T14:08:12.290

如果它是客户并且在技术上可以做到，并且您可以做到，请获得工作说明 - 并做到这一点。

如果这是你的工作，你做的和其他任何事情一样。你说：“是的，先生（或女士），我很乐意这样做。而且我根本不介意这样做。我只是想你可能想知道这将如何影响我们的其他系统或预算。不是说你错了，只是说也许我们应该考虑一下。可以吗？

如果他们说不，好吧，他们同意了，你就去做。如果您真的担心，请记录您的建议未被听取的谈话。 *请记住，如果您不记录它，它就不会发生。* 如果他们听，那么你赢得了一个朋友。

这对于任何工作都是一样的——电脑、建筑工人等等。

编辑：

我从下面的评论中得到了这个：

没人再看星际迷航 TNG 或 TOS 了吗？请记住，一号船长会让皮卡德船长知道任何错误，有时让-卢克会同意，有时他不会。这就是我要说的

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-23T14:22:36.903

如果有不止一个请求，我会花时间礼貌地倾听，请他们优先考虑并以书面形式提出请求，最好是“签字”或您拥有的任何程序。然后告诉您的经理/客户，您将审查这些请求，并回复他们的估计以及它将对您的日程安排产生的影响。解释说，为了生成这些数据，您需要花费 X 小时（或天），因此您的其他工作将被延迟......

然后回来估计 - 如果请求是荒谬的，那么你的估计可能会反映:-)

如果您的经理/客户想要继续并浪费大量时间和金钱，那么至少您已经事先说明并且您已经尽您所能来帮助他们。

如果可能的话，您应该要求他们将此类请求推迟到未来阶段，建议您在下一个版本中查看它（我认为其他几个回复已经提到了这个想法）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-23T15:12:37.970

这些都是很好的答案。你需要硬数据（如果可以生成的话）、“难以置信的荒谬”估计，最重要的是，尊重。

约翰尼的回答本质上是正确的，如果不是准确的话（如果我建立了足够的代表，我会发表评论）。但是，在某些情况下，使用这些确切的词可能会造成足够的不和谐，让请求者重新审视你的反对内容。是的，这适用于*任何*基于项目的努力：软件、广告设计，甚至（喘气！）建筑。并不是说携带迫击炮的咕哝者有理由或影响力反对有缺陷的设计，但施工负责人确实有义务告诉建筑师他的计划是否无法建造。

如果所有其他方法都失败了，请记录讨论并无论如何构建它。这不再是你的责任。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-23T15:25:21.580

在响应它们时，可笑的功能请求对我来说分为两个阵营。

1.  功能将导致应用程序停止按预期运行，即破坏它，减慢它的速度，使其无法运行
2.  不会导致应用程序按预期停止运行的功能，但我不明白您为什么需要这样的功能

对于类型 1，我将分析请求并以确凿的事实或专业意见作出回应。如果分析表明可以对现有代码进行额外的努力，那么估计和估计高！

对于类型 2，首先我会要求请求者更详细地解释该功能，毕竟他们可能在超出原始应用程序规范的问题空间之外我没有清楚了解的业务领域工作。如果我仍然不明白并且我真的看不到该功能的目的，那么我估计很高以阻止他们。

如果他们接受估计，或者我接受，最后，得到它，然后我就去做。

归根结底，他们是客户，如果客户走进裁缝店，要求提供 4 条腿的裤子，裁缝师可能会争论一段时间，但最终这是一项定制工作，而且价格要贵得多。因此，如果他们在他们愿意支付的功能中看到足够的价值，就愿意接受他们的钱；仅仅因为你看不到价值并不意味着它们是错误的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-24T10:09:15.450

一个好的软件设计师会克制不要把一个特性请求称为可笑的。你必须相信你的直觉，但这只是一个很好的迹象，表明你想仔细考虑这个问题。

我建议一个简单的模型：

1.  尝试了解实际问题是什么，而不是用户要求的解决方案。黄金设计法则“[不要与客户讨论解决方案，而是讨论需求](https://stackoverflow.com/questions/416779/when-the-client-asks-for-something-ludicrous-and-insists/423932#423932)”。

2.  能够解释您认为所提议功能的问题所在。保罗格雷厄姆有一篇很棒的文章，叫做“[如何不同意](http://www.paulgraham.com/disagree.html)”。

这两个简单的步骤将帮助您和用户加深对实际问题的理解。没有用户，软件毫无意义，我们大多数人都依赖用户付费。与用户合作，而不是以一种可能显得侮辱的态度疏远他们。

一些“荒谬”的功能请求源于非常有趣且难以解决的问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-23T14:05:19.800

我认为您唯一能做的就是非常简洁地描述变更请求将给相关人员带来的主要问题。在我工作的地方，我们遇到了和你一样的问题。

一些变更请求迫使开发人员为了完成它而跳过箍，最终导致楼上认为是一个很好的功能的功能的可维护性降低。

根据我的经验，你真的无法阻止这种情况，最终管理层会开始抱怨开发需要多长时间等等。这是一个可怕的糟糕循环，要么以重建网站而告终，要么你的团队在代码地狱。

祝你好运。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-23T14:06:20.173

有不同种类的“荒谬”。

*   **太贵了**：我认为客户的需求必须物有所值
*   **这只是不必要的东西**：我试图解释客户不能使用它。如果他们仍然想要它，他们可以拥有它。
*   **这与现有概念背道而驰**：这实际上是“负担不起”的“太贵”。他们不会得到它。

我喜欢讨论需求:-)

编辑：

**典型的讨论**

*   营销人员：在此表旁边，我们需要一个按钮来为选择提供功能 X。
*   开发人员：但我们需要为函数 X 附加参数 P
*   M：参数P明显是很多情况
*   D：但我们必须涵盖*所有*情况。我们需要提示 P
*   男：不！用户不喜欢被提示输入明显的值！他们只想“点击并走”。
*   D：在这种情况下是不可能的。我们需要提示。
*   M：（随和）你不能猜到，只有在真的有必要的时候才提示？
*   D：很难可靠地猜测。实际上需要数周甚至数月才能实施，而且风险很高。如果我们猜错了怎么办？为此，我们需要人工智能。
*   M：但这很简单：总是以防万一，我们知道 P
*   D：是的，当然，但我们不知道用户知道什么。
*   男：嗯。你们开发人员总是那么复杂。
*   丁：...
*   M：那么，你能做到吗？
*   D：没有。
*   男：为什么？
*   D：（恼怒）我刚刚解释过了。毕竟，如果用户真的想决定，你认为用户喜欢系统猜测 P 吗？
*   M：你只需要猜测用户的决定。
*   D：但我从哪里知道？
*   M: 就是这种情况 blahblah ...
*   D：我知道，但没那么简单。
*   M：好的，我去找项目负责人，他会给你一个任务。
*   丁：...

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-23T16:47:07.670

我发现大多数时候人们要求不可能的事情并没有意识到为什么他们要求的是这样一个问题。

一般来说，我只是要求越来越多的需求澄清和越来越多的细节，直到：

*   一个灯泡出现在我的脑海中，我意识到他们在尝试什么，我可以说“啊，你真正想要的是 X，而不是 Y”。在这一点上，他们通常会说“是的，这就是我一直在说的”。

*   他们意识到他们是多么不切实际，他们撤回了请求

*   你们共同意识到这将是非常好的，但这是不可能的。通常，根据我的经验，发生这种情况是因为您需要对大型闭源应用程序进行更改 - 在这种情况下，您只需向供应商提出功能请求，这对于非技术人员来说更令人满意对于技术人员；Microsoft 不会因为一家小公司的要求而对 Excel 进行更改！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-23T16:49:14.777

客户创建的需求可能是导致此问题的主要原因。问题是客户有时会尝试做软件开发人员的工作。

他们有一个问题，然后找出他们将解决该问题的功能。不幸的是，这些可怜的人中的一些（大多数）并不擅长软件设计，因此在它的最后你会得到一个非常奇怪的特性。

删除某些此类延迟特征的一种方法是通过递归 .Why() 函数。一直问为什么，直到你找到他们的问题，然后自己设计这个功能。在很多情况下，您可以以简单、廉价且满足各方的方式重新设计它。

* * *

有时，看似荒谬的功​​能请求实际上却是一个好的请求。有时候，软件开发人员（我过去也发现自己这样做过）对一个相当复杂但非常有用的功能说不，这*将使*公司赚到很多钱。因此，当您遇到“荒谬”功能时，请务必在立即将其排除之前计算其对业务的潜在价值。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-23T14:12:37.710

我们有时会收到来自产品经理的此类要求。

在一个案例中，我解释说会出现性能问题，而资深人士证实了这一点，所以我们赢了。

下一次提出了类似的问题，但高级人员不在，所以我只是做了他们想做的事，因为没有人真正关心。我也决定不这样做。

您可能的意思是向数据库发送多标准请求，显示结果，同时显示所有这些标准中的哪一个受到了打击。猜到了吗？

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-23T15:33:00.703

*   有时您可以解释为什么功能很荒谬，并且功能被丢弃了。

*   有时你可以让更资深的人为你说“不”。

*   有时，您的资深（或有影响力）足以为自己说“不”。

*   有时您可以说“是”，但给任务低优先级（永远不要这样做）。

*   有时你只需要继续下去。

在后一种情况下，您应该确保确实非常非常好地完成任务。为什么？你会发光，当你这样做时，荒谬的阴影将被聚焦。

# winforms - 带图像的透明 Winform

> ID：781830
> 
> 赞同：1
> 
> 时间：2009-04-23T13:57:03.300
> 
> 标签：winforms, transparency

我有一个 alpha 通道设置为 50% 不透明的图像（PNG 文件）。当我尝试在 TransparencyKey 设置为白色且背景色设置为白色的表单上绘制图像时，我希望图像绘制为 50% 透明。但是，它首先与表单背景色混合，因此它是完全不透明的。有没有办法解决？我不想设置表单的 Opaque 属性，因为表单上的某些图像需要是半透明的，而有些则需要是不透明的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-02T18:09:50.987

我最终使用了分层窗口，使用了 WS_EX_LAYERED 扩展窗口样式。

[http://msdn.microsoft.com/en-us/library/ms997507.aspx](http://msdn.microsoft.com/en-us/library/ms997507.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T18:56:50.733

我不认为你可以。我们有一个启动屏幕，我们在其中做了类似的事情，但我们最终捕获了屏幕并将其设置为表单的背景图像。显然，这似乎只是工作，如果屏幕发生变化，表单的背景不会，事情看起来很奇怪。如果您找到更好的方法，我很想知道。

这是捕获屏幕的代码，只需将 ScreenRect 设置为表单屏幕坐标并调用 Process()：

```
using System;
using System.Drawing;
using System.Runtime.InteropServices;

namespace TourFactory.Core.Drawing
{
    public class CaptureScreenCommand
    {

        #region Initialization and Destruction

        public CaptureScreenCommand()
        {
        }

        #endregion

        #region Fields and Properties

        // BitBlt is a multipurpose function that takes a ROP (Raster OPeration) code
        // that controls exactly what it does. 0xCC0020 is the ROP code SRCCOPY, i.e.
        // do a simple copy from the source to the destination.
        private const int cRasterOp_SrcCopy = 0xCC0020; // 13369376;

        private Rectangle mScreenRect;
        /// <summary>
        /// Gets or sets the screen coordinates to capture.
        /// </summary>
        public Rectangle ScreenRect
        {
            get { return mScreenRect; }
            set { mScreenRect = value; }
        }

        #endregion

        #region Methods

        public Image Process()
        {
            // use the GDI call and create a DC to the whole display
            var dc1 = CreateDC("DISPLAY", null, 0, 0);
            var g1 = Graphics.FromHdc(dc1);

            // create a compatible bitmap the size of the form
            var bmp = new Bitmap(mScreenRect.Width, mScreenRect.Height, g1);
            var g2 = Graphics.FromImage(bmp);

            // Now go retrace our steps and get the device contexts for both the bitmap and the screen
            // Note: Apparently you have to do this, and can't go directly from the aquired dc or exceptions are thrown
            // when you try to release the dcs
            dc1 = g1.GetHdc();
            var dc2 = g2.GetHdc();

            // Bit Blast the screen into the Bitmap
            BitBlt(dc2, 0, 0, mScreenRect.Width, mScreenRect.Height, dc1, mScreenRect.Left, mScreenRect.Top, cRasterOp_SrcCopy);

            // Remember to release the dc's, otherwise problems down the road
            g1.ReleaseHdc(dc1);
            g2.ReleaseHdc(dc2);

            // return bitmap
            return bmp;
        }

        #endregion

        #region gdi32.dll

        [DllImport("gdi32")]
        private static extern IntPtr CreateDC(string lpDriverName, string lpDeviceName, int lpOutput, int lpInitData);

        [DllImport("gdi32")]
        private static extern bool BitBlt(IntPtr hdcDest, int xDest, int yDest, int width, int height, IntPtr hdcSrc, int xSrc, int ySrc, int dwRop);

        #endregion

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-02T18:20:15.523

好的。不要忘记 Vista 有桌面窗口管理器来创建半透明窗口（又名 Areo） [http://msdn.microsoft.com/en-us/magazine/cc163435.aspx](http://msdn.microsoft.com/en-us/magazine/cc163435.aspx)

# c# - 逻辑表达式中的所有方法都会被执行吗？

> ID：781832
> 
> 赞同：0
> 
> 时间：2009-04-23T13:57:12.753
> 
> 标签：c#, optimization

在 C# 中，给定两种方法

```
 bool Action1(object Data);
bool Action2(object Data); 
```

`if`在这样的语句中使用：

```
if ( Action1(Data) || (Action2(Data) )
{
    PerformOtherAction();
} 
```

如果返回 true，仍然会`Action2()`调用`Action1()`，或者编译器优化会阻止这种情况，因为已经知道表达式将评估为`true`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T14:00:02.577

不，C# 支持逻辑短路，所以如果`Action1`返回`true`它永远不会计算`Action2`.

这个简单的例子展示了 C# 如何处理逻辑短路：

```
using System;

class Program
{
    static void Main()
    {
        if (True() || False()) { }  // outputs just "true"
        if (False() || True()) { }  // outputs "false" and "true"
        if (False() && True()) { }  // outputs just "false"
        if (True() && False()) { }  // outputs "true" and "false"
    }

    static bool True()
    {
        Console.WriteLine("true");
        return true;
    }

    static bool False()
    {
        Console.WriteLine("false");
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T13:59:26.587

仅当 Action1() 返回 false 时才会调用 Action2()

这在概念上类似于

```
if (Action1(Data))
{
    PerformOtherAction();
} 
else if (Action2(Data))
{
    PerformOtherAction();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T14:38:37.427

您可以使用单个 | 或 & 让这两种方法都执行。这是 Brainbench C# 考试希望您知道的技巧之一。在现实世界中可能没有任何用处，但仍然很高兴知道。此外，它还可以让您以创造性和狡猾的方式迷惑您的同事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T14:00:25.443

由于短路评估的规则，如果 Action1 返回 true，则不会调用 Action2。请注意，这是运行时优化，而不是编译时优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T14:00:35.960

如果 Action1() 返回 true，则不会评估 Action2()。C#（如 C 和 C++）使用短路评估。[MSDN 链接](http://msdn.microsoft.com/en-us/library/6373h346(VS.71).aspx)在这里验证它。

# asp.net - asp.net 验证间距被文本框上的 2 个验证控件弄乱了

> ID：781833
> 
> 赞同：0
> 
> 时间：2009-04-23T13:57:13.207
> 
> 标签：asp.net, validation

asp.net 验证间距被文本框上的 2 个验证控件弄乱了。

我尝试使用显示静态/动态，但没有奏效。

想法？

**更新** 发生的情况是，如果第二个验证控件显示其消息，则第一个验证正在使用一些空白作为其消息的占位符。所以控件和错误信息之间存在巨大的差距。如果显示第一个验证控件消息，它看起来就很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:08:00.340

应将这两个控件的显示设置为动态。从它的声音来看，第一个验证控件将此属性设置为静态。

# java - log4j 打印所有级别

> ID：781834
> 
> 赞同：2
> 
> 时间：2009-04-23T13:57:23.440
> 
> 标签：java, log4j

我已经在我的 Java 项目中配置了 log4j，其中包含以下 log4j.properties：

```
log4j.rootLogger=WARNING, X

log4j.appender.X=org.apache.log4j.ConsoleAppender
log4j.appender.X.layout=org.apache.log4j.PatternLayout
log4j.appender.X.layout.ConversionPattern=%p %m %n

log4j.logger.org.hibernate.SQL=WARNING
log4j.logger.com.****.services.clarity.dao.impl=WARNING
log4j.logger.com.****.services.clarity.controller=WARNING
log4j.logger.com.****.services.clarity.services.impl=WARNING
log4j.logger.com.****.services.clarity.feeds.impl=WARNING 
```

按照配置，它应该只打印 WARNING 消息，但是它将所有级别打印到 DEBUG。

这可以从哪里来的任何想法？

谢谢 ！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T14:06:31.997

严重级别不是称为“WARN”吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T14:23:43.640

日志级别应该是“WARN”而不是“WARNING”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-13T11:09:04.567

日志级别确实应该是`WARN`，但这仍然不会阻止根记录器显示`DEBUG`消息。

我已经学会了两种方法来抑制这些`DEBUG`信息。请参阅我对一个几乎相同的[问题的](https://stackoverflow.com/questions/3023690/why-is-log4j-rootlogger-not-filtering-log-events-according-to-event-level/3024279)[解决方案](https://stackoverflow.com/questions/3023690/why-is-log4j-rootlogger-not-filtering-log-events-according-to-event-level/3024279#3024279)，该问题是我从对类似问题的两个不同答案中得出的。

# javascript - 如何将参数传递给内联 javascript 函数

> ID：781835
> 
> 赞同：2
> 
> 时间：2009-04-23T13:57:26.623
> 
> 标签：javascript, prototypejs

我正在尝试将 story_id 传递给最里面的内联函数，但它始终为 0，即使它在外部函数中不是 0。我如何传递这个值？

```
function activateSearch(){
  if($('story_filter')) Event.observe('story_filter', 'keyup',
    function(event) {
      $('stories_table').select(".story").each(
        function(story) {
          story_id = story.id.split('_')[1];
          story.select('.tableCell', '.indexCardContent').each(
            function(task, story_id) {
              hideStoryRow(story_id);
              task_filter = new RegExp($F('story_filter'), "i");
              if (task.innerHTML.match( task_filter ))
              {
                  showStoryRow(story_id);
                  throw $break;
              }
            }
          );
        }
      );
    }
  );
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T14:39:24.027

要完成这项工作，您所要做的就是更改这一行：

```
 function(task, story_id) { 
```

对此：

```
 function(task) { 
```

您不必在任何地方传递 story_id - 它已经在内部函数的范围内！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:02:05.580

你没有。each 方法接受函数定义，然后为数组中的每个元素调用该函数。如果您想使用内联函数定义，您需要编写自己的自定义每个方法。

为了可读性和功能性，我会分解最里面的内联函数，然后对于列表中的每个元素，调用你的函数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-23T14:01:24.787

你有一个范围问题。

快速修复：将 story_id 定义为全局。

```
var story_id;

function activateSearch() { .... 
```

# c# - IN 语句中的 Datacontext ExecuteCommand 参数

> ID：781839
> 
> 赞同：5
> 
> 时间：2009-04-23T13:58:28.197
> 
> 标签：c#, linq, command, datacontext, execute

使用从 C# LinQ 到 sql数据上下文运行自定义`sql`语句的最佳方法是什么？`IN`我努力了：

```
db.ExecuteCommand(
   "UPDATE tblCard SET used = 1 WHERE id IN ({0}) AND customer_id = {1}",
   Request.Form["ids"], customer_id
); 
```

这对于通过表单传递的 1 项很好，但如果我通过例如“2,1”发布，那么我会得到一个`sqlclient`异常：

> 将 nvarchar 值“2,1”转换为数据类型 int 时转换失败。

相反，如果我使用 string.format 插入参数，它可以正常工作，但显然这对 sql 注入是开放的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T14:10:01.710

LINQ-to-SQL 不使用连接；这将是以下形式的 TSQL 查询：

```
WHERE id IN (@p0) 
```

设置`@p0`为`'123,456,789'`.

使用常规 LINQ，您可以使用`Contains`. 有`ExecuteQuery`几个选项；例如，您可以“按原样”传递 CSV，并使用 UDF 在数据库中拆分它，然后加入它：

```
UPDATE c SET c.used = 1
FROM dbo.SplitCsv({0}) udf
INNER JOIN tblCard c
        ON c.Id = udf.Value
       AND c.Customer_ID = {1} 
```

`dbo.SplitCsv`互联网上提供的众多此类“拆分”udf 之一在哪里。

# email - 发送电子邮件 - 使用 DB 或 Web 应用程序

> ID：781841
> 
> 赞同：0
> 
> 时间：2009-04-23T13:58:37.663
> 
> 标签：email

我目前正在指定一个软件，生成的电子邮件将成为系统的很大一部分。

在调查中，我可以从数据库中提取我需要的所有信息，并创建带有附件的电子邮件，然后使用数据库的内置邮件功能（Oracle 和 SQL Server）发送它们。

我的另一个选择是在我的应用程序代码中生成电子邮件。

由于我不需要任何精美的电子邮件格式，因此最好的方法是什么？在实现我的目标方面似乎没有区别；使用数据库的唯一好处是我可以将电子邮件设置为在更新行的触发器上发送。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T14:07:01.060

我会在应用程序代码中做到这一点。把数据存储留给数据库，把应用逻辑留给应用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T17:23:44.883

我们在为我们公司开发的应用程序中以两种方式发送电子邮件。从长远来看，应用方法的效果要好得多。错误处理在应用程序中是理所当然的，但数据库引擎可能会因为地址格式错误等原因而死掉，也可能不会死掉，而且以后很难追踪故障。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T17:36:10.110

如果将其放入应用程序代码中，则将过程分解为可测试的小块会更容易。

将尽可能多的逻辑放入生成消息而不发送出去，这样您就可以在不实际发送和接收电子邮件的情况下测试大部分代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T17:45:10.430

我认为真正的答案取决于电子邮件发送一次的重要性以及您想要进行多少错误检查。让我解释：

我们有一个事件报告系统，当输入事件时会发送电子邮件。没有意识到我们最初一次只发送一批 100 封电子邮件（SMTP 限制），如果超过这个数量，我们就会通过群组进行循环——在一些销售之后，我们发现发送了超过 1000 封电子邮件在每个条目上，将它们全部发送可能需要将近一分钟 - 创建一个邮件线程并不是一个真正的好匹配，所以我们创建了一个邮件队列，并且每 5 分钟有一个工作循环，并发送任何未发送的内容- 错误 - 如果队列被阻止，或者队列中有太多电子邮件以至于运行时间超过 5 分钟，它将重新开始，并且我们有一些电子邮件被发送 2、3、4 甚至 10 次 - 可能有设计不好，但无论如何

我们最后只是将整个事情移到了 SQL Server 邮件队列，它一直像冠军一样运行 - 真正的教训（在我看来是）是做所有的处理，但是你需要进入你的程序，但是一旦你知道电子邮件是发送给谁，并将其传递给专门处理电子邮件发送的东西（CDO、Sql Server 邮件、Oracle 等等）

你仍然可以在你的应用程序中测试你想要的所有逻辑，但让电子邮件由专为处理电子邮件而构建的东西来处理。

# asp.net - 设置 redirectMode="ResponseRewrite" 时，CustomErrors 不起作用

> ID：781861
> 
> 赞同：75
> 
> 时间：2009-04-23T14:01:51.167
> 
> 标签：asp.net, iis-6, custom-errors, redirectmode

`redirectMode="ResponseRewrite"`在一个旧站点中，我通过添加（3.5 SP1 中的新功能）来改变 CustomErrors 的工作方式：

```
<customErrors mode="RemoteOnly" defaultRedirect="Error.aspx" redirectMode="ResponseRewrite">
    <error statusCode="404" redirect="404.aspx" />
</customErrors> 
```

问题是：它向我显示了通用错误页面（当您未设置时获得的页面`customErrors`。如果我删除该`redirectMode="ResponseRewrite"`部分，它工作正常。

我确定服务器中安装了 3.5 SP1，因为我在同一服务器中托管的其他站点上使用相同的设置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2010-09-22T14:28:44.460

对于试图在幕后`ResponseRewrite`使用的 MVC 应用程序中执行此操作的任何人，请务必注意。`Server.Transfer`因此，`defaultRedirect`必须对应文件系统上的合法文件。显然，`Server.Transfer`与 MVC 路由不兼容，因此，如果您的错误页面由控制器操作提供服务，则将`Server.Transfer`查找 /Error/Whatever，而不是在文件系统上找到它，并返回通用 404 错误页面！

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-03-11T17:37:42.380

对我来说完美的唯一方法是关闭自定义错误并通过 web.config 替换 iis 的错误页面。它使用响应发送正确的状态代码，并且具有不通过 mvc 的好处。

这是代码

1.  关闭自定义错误

    ```
    <customErrors mode="Off" /> 
    ```

2.  替换错误页面

    ```
    <httpErrors errorMode="Custom" existingResponse="Replace">
      <remove statusCode="404" subStatusCode="-1" />
      <remove statusCode="500" subStatusCode="-1" />
      <error statusCode="404" path="Error404.html" responseMode="File" />
      <error statusCode="500" path="Error.html" responseMode="File" />
    </httpErrors> 
    ```

笔记。如果`responsemode="file"`url 是文件的直接链接，则使用

信息：[http ://tipila.com/tips/use-custom-error-pages-aspnet-mvc](http://tipila.com/tips/use-custom-error-pages-aspnet-mvc)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-02-16T09:26:07.130

发生的事情是 IIS 正在查看错误状态代码并显示它自己的错误页面而不是您的错误页面。要解决此问题，您需要在错误页面的代码隐藏页面中进行设置，以防止 IIS 执行此操作：

```
Response.TrySkipIisCustomErrors = true; 
```

这仅适用于 IIS7 或更高版本，对于早期版本的 IIS，您需要使用错误页面设置。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-03-31T09:18:37.707

由于依赖`Server.Transfer`它的内部实现似乎`ResponseRewrite`与 MVC 不兼容。

这对我来说似乎是一个明显的功能漏洞，所以我决定使用 HTTP 模块重新实现此功能，以便**它正常工作**。下面的解决方案允许您像往常一样通过重定向到任何有效的 MVC 路由（包括物理文件）来处理错误。

```
<customErrors mode="RemoteOnly" redirectMode="ResponseRewrite">
    <error statusCode="404" redirect="404.aspx" />
    <error statusCode="500" redirect="~/MVCErrorPage" />
</customErrors> 
```

这已经在以下平台上进行了测试；

*   集成管道模式下的 MVC4 (IIS Express 8)
*   经典模式下的 MVC4（VS 开发服务器，Cassini）
*   经典模式下的 MVC4 (IIS6)

* * *

```
namespace Foo.Bar.Modules {

    /// <summary>
    /// Enables support for CustomErrors ResponseRewrite mode in MVC.
    /// </summary>
    public class ErrorHandler : IHttpModule {

        private HttpContext HttpContext { get { return HttpContext.Current; } }
        private CustomErrorsSection CustomErrors { get; set; }

        public void Init(HttpApplication application) {
            System.Configuration.Configuration configuration = WebConfigurationManager.OpenWebConfiguration("~");
            CustomErrors = (CustomErrorsSection)configuration.GetSection("system.web/customErrors");

            application.EndRequest += Application_EndRequest;
        }

        protected void Application_EndRequest(object sender, EventArgs e) {

            // only handle rewrite mode, ignore redirect configuration (if it ain't broke don't re-implement it)
            if (CustomErrors.RedirectMode == CustomErrorsRedirectMode.ResponseRewrite && HttpContext.IsCustomErrorEnabled) {

                int statusCode = HttpContext.Response.StatusCode;

                // if this request has thrown an exception then find the real status code
                Exception exception = HttpContext.Error;
                if (exception != null) {
                    // set default error status code for application exceptions
                    statusCode = (int)HttpStatusCode.InternalServerError;
                }

                HttpException httpException = exception as HttpException;
                if (httpException != null) {
                    statusCode = httpException.GetHttpCode();
                }

                if ((HttpStatusCode)statusCode != HttpStatusCode.OK) {

                    Dictionary<int, string> errorPaths = new Dictionary<int, string>();

                    foreach (CustomError error in CustomErrors.Errors) {
                        errorPaths.Add(error.StatusCode, error.Redirect);
                    }

                    // find a custom error path for this status code
                    if (errorPaths.Keys.Contains(statusCode)) {
                        string url = errorPaths[statusCode];

                        // avoid circular redirects
                        if (!HttpContext.Request.Url.AbsolutePath.Equals(VirtualPathUtility.ToAbsolute(url))) {

                            HttpContext.Response.Clear();
                            HttpContext.Response.TrySkipIisCustomErrors = true;

                            HttpContext.Server.ClearError();

                            // do the redirect here
                            if (HttpRuntime.UsingIntegratedPipeline) {
                                HttpContext.Server.TransferRequest(url, true);
                            }
                            else {
                                HttpContext.RewritePath(url, false);

                                IHttpHandler httpHandler = new MvcHttpHandler();
                                httpHandler.ProcessRequest(HttpContext);
                            }

                            // return the original status code to the client
                            // (this won't work in integrated pipleline mode)
                            HttpContext.Response.StatusCode = statusCode;

                        }
                    }

                }

            }

        }

        public void Dispose() {

        }

    }

} 
```

**用法**

将此作为最终 HTTP 模块包含在您的 web.config 中

```
 <system.web>
    <httpModules>
      <add name="ErrorHandler" type="Foo.Bar.Modules.ErrorHandler" />
    </httpModules>
  </system.web>

  <!-- IIS7+ -->
  <system.webServer>
    <modules>
      <add name="ErrorHandler" type="Foo.Bar.Modules.ErrorHandler" />
    </modules>
  </system.webServer> 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-08-06T00:43:21.013

我知道这个问题有点老了，但我想我应该指出它不需要是一个静态文件来让它工作。

我遇到了类似的事情，这只是在您的 Error.aspx 中找到该错误的问题，在我们的例子中，这是因为使用的母版页依赖于一段会话数据，并且当设置了 ResponseRewrite 时会话不可用我们的 Error.aspx 页面。

我还没有弄清楚会话不可用是由于我们的特定应用程序配置还是 ASP.net 的“设计”部分造成的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T17:09:27.880

我发现问题出在 Error.aspx 中。仍然无法找到导致问题的 error.aspx 中的实际错误。

将页面更改为静态 html 文件解决了该问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-08T08:42:09.463

我在 aspx 中构建了一个错误页面，将查询传输到 ASP.NET MVC 控制器。您可以将查询重写到此 aspx 页面，它会将查询传输到您的自定义控制器。

```
protected void Page_Load(object sender, EventArgs e)
{
  //Get status code
  var queryStatusCode = Request.QueryString.Get("code");
  int statusCode;
  if (!int.TryParse(queryStatusCode, out statusCode))
  {
    var lastError = Server.GetLastError();
    HttpException ex = lastError as HttpException;
    statusCode = ex == null ? 500 : ex.GetHttpCode();
  }
  Response.StatusCode = statusCode;

  // Execute a route
  RouteData routeData = new RouteData();
  string controllerName = Request.QueryString.Get("controller") ?? "Errors";
  routeData.Values.Add("controller", controllerName);
  routeData.Values.Add("action", Request.QueryString.Get("action") ?? "Index");

  var requestContext = new RequestContext(new HttpContextWrapper(Context), routeData);
  IController controller = ControllerBuilder.Current.GetControllerFactory().CreateController(requestContext, controllerName);
  controller.Execute(requestContext);
} 
```

在此处查找更多详细信息：[https ://stackoverflow.com/a/27354140/143503](https://stackoverflow.com/a/27354140/143503)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-14T17:10:15.973

根据@Amila的帖子以及该帖子的确认和完成，我有同样的问题，我在谷歌上挖了很多，但没有机会找到正确的答案。问题是当您使用. 时`ASP.Net Web Application`，无论是否`MVC`使用旧方式都无法实现自定义错误`Webform project`。
如果您使用的是选项`ASP.Net Web Application`（无论是否`MVC`）：

> *在我的场景中，我只想为特定的 404 错误定义一个自定义错误，另一个错误定义与 404 错误相同：*

**Senario1：**您的自定义页面是一个简单的`HTML`文件，并放置在`root`：

```
<configuration>
   <system.web>
      <customErrors mode="Off" />
   </system.web>
   <system.webServer>
       <httpErrors errorMode="Custom" existingResponse="Replace">
           <remove statusCode="404" subStatusCode="-1" />
           <error statusCode="404" path="ErrorPage.html" responseMode="File" />
       </httpErrors>
   </system.webServer>
</configuration> 
```

* * *

**Senario2：**您的自定义页面是一个`aspx`页面并放置在`root`：

```
<configuration>
   <system.web>
      <customErrors mode="Off" />
   </system.web>
   <system.webServer>
       <httpErrors errorMode="Custom" existingResponse="Replace">
           <remove statusCode="404" subStatusCode="-1" />
           <error statusCode="404" path="ErrorPage" responseMode="Redirect" />
       </httpErrors>
   </system.webServer>
</configuration> 
```

**注意：**由于`RouteConfig.cs`in ，我删除了 aspx 扩展名`ASP.net application`，您可以根据需要使用`ErrorPage.aspx`它，它是可选的。

* * *

**Senario3：**您的自定义页面是一个`aspx`页面并放置在`[ex: Page folder in The root (~/Page/ErrorPage.aspx)]`：
我注意到这里的提示是**您不应该使用`~/`**根地址；所以我只是在没有`~/`标记的情况下解决：

```
<configuration>
   <system.web>
      <customErrors mode="Off" />
   </system.web>
   <system.webServer>
       <httpErrors errorMode="Custom" existingResponse="Replace">
           <remove statusCode="404" subStatusCode="-1" />
           <error statusCode="404" path="Page/ErrorPage" responseMode="Redirect" />
       </httpErrors>
   </system.webServer>
</configuration> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-13T19:04:31.273

在我的特定情况下，我的错误页面有一个母版页，其中有一个尝试使用 Session 的用户控件。如果 Session 不可用，您会收到 HttpException：“只有在 enableSessionState 设置为 true 时才能使用会话状态，无论是在配置文件中还是在 Page 指令中。” 最简单的解决方法是切换到静态 html，第二简单的解决方法是使用更简单的错误页面，最难的解决方法是确保您的错误页面在任何地方都没有做出任何假设（例如 Session 不会抛出异常）和不可能出错。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-03-22T12:06:40.597

我发现如果您使用 redirectMode="ResponseRewrite" 那么您需要在 web.config 文件的重写区域中添加一些内容。问题是当你的网站坏了！您无法 URL 重写，因为您的站点无法调用处理您的重写的“virtual.aspx”！

# asp.net-mvc - 厚盒模态表单相关

> ID：781862
> 
> 赞同：0
> 
> 时间：2009-04-23T14:01:57.983
> 
> 标签：asp.net-mvc, thickbox

我正在使用 asp.net MVC。

我打开我的登录页面作为模态页面这样 - >[登录演示](http://jquery.com/demo/thickbox-3/)

问题是当用户提供不正确的信息时，我丢失了父页面。

发生这种情况是因为错误来自另一个页面并且它删除了父页面。

那么如何更新模态页面呢？

我知道 ajax 更新是可能的，所以不要给我那个解决方案。

我的严格要求是在模态窗口中显示另一个页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T14:04:54.903

Thickbox 有内联模式和 iframe 模式。

内联模式，将没有父级。它只是在一个`<div>`

IFrame，iframe 中的 html 将是文档的子级。

所以在 iFrame 中，如果你想在父文档中引用 javascript，你必须说 parent.doSomething();

# asp.net - aspnet 会员登录控制

> ID：781871
> 
> 赞同：1
> 
> 时间：2009-04-23T14:04:49.567
> 
> 标签：asp.net, asp.net-membership

我正在建立一个使用 aspnet 会员课程的网站。当用户成功登录时，我将他们重定向到 myaccount 页面。在此页面中，我想加载配置文件，但我需要知道登录的用户是什么。我将如何使用 aspnet 成员资格堆栈来执行此操作？

谢谢

吉姆·里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T14:08:57.920

HttpContext.Current.User.Identity.Name

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:09:29.587

一旦用户登录到经过 ASP.NET Forms 身份验证的页面，您就可以使用[Page.User](http://msdn.microsoft.com/en-us/library/system.web.ui.page.user(VS.80).aspx)属性来确定他们是谁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T03:35:30.397

`Context.User.Identity.Name`或者`Membership.GetUser();`

# mysql - 如何计算 MySQL 中索引的大小

> ID：781873
> 
> 赞同：97
> 
> 时间：2009-04-23T14:05:17.897
> 
> 标签：mysql

我想确定我的索引的大小，它们是主键索引。这恰好在 mysql 集群上，但我认为这并不重要。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-09-22T17:06:57.453

我想这就是你要找的。

```
show table status from [dbname] 
```

[http://dev.mysql.com/doc/refman/5.1/en/show-table-status.html](http://dev.mysql.com/doc/refman/5.1/en/show-table-status.html)

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2016-04-12T12:49:00.363

扩展 Vajk Hermecz 的答案。
这就是如何获取所有索引大小（以兆字节为单位）的方法，而无需按大小排序的 PRIMARY（即表本身）。

```
SELECT database_name, table_name, index_name,
ROUND(stat_value * @@innodb_page_size / 1024 / 1024, 2) size_in_mb
FROM mysql.innodb_index_stats
WHERE stat_name = 'size' AND index_name != 'PRIMARY'
ORDER BY size_in_mb DESC; 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2015-10-23T00:06:56.930

如果您使用 InnoDB 表，您可以从`mysql.innodb_index_stats`. 'size' stat 包含答案，以页面为单位，因此您必须将其乘以页面大小，[默认情况下为 16K](http://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html#sysvar_innodb_page_size)。

```
select database_name, table_name, index_name, stat_value*@@innodb_page_size
from mysql.innodb_index_stats where stat_name='size'; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-05-22T13:02:21.010

这是对上述某些内容的改编，还可以为您提供每个索引已使用的表的总索引百分比，希望这对某人有用

```
select 
    database_name, 
    table_name, 
    index_name, 
    round((stat_value*@@innodb_page_size)/1024/1024, 2) SizeMB, 
    round(((100/(SELECT INDEX_LENGTH FROM INFORMATION_SCHEMA.TABLES t WHERE t.TABLE_NAME = iis.table_name and t.TABLE_SCHEMA = iis.database_name))*(stat_value*@@innodb_page_size)), 2) `Percentage`
from mysql.innodb_index_stats iis 
where stat_name='size' 
and table_name = 'TargetTable'
and database_name = 'targetDB' 
```

示例输出

```
database_name   table_name  index_name  SizeMB  Percentage
targetDB        TargetTable id          10      55.55
targetDB        TargetTable idLookup    5       27.77
targetDB        TargetTable idTest      3       16.66 
```

问候利亚姆

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-23T14:21:43.320

在 上`MyISAM`，每个索引块都被索引记录`4 KB`填满`fill_factor`，每个索引记录都是`key length + 4`字节长。

`Fill factor`通常是`2/3`

至于`InnoDB`，表总是聚集在上面`PRIMARY KEY`，没有单独的`PRIMARY KEY`索引

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T14:22:31.633

使用 phpMyAdmin，查看表结构时，底部某处有一个详细信息链接。单击它后，它将显示您在标记为 Space Usage 的表上拥有的索引的总大小。

我认为它不会单独显示每个索引。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-04T06:08:17.500

在本文中确定如何计算索引大小。 [http://aadant.com/blog/2014/02/04/how-to-calculate-a-specific-innodb-index-size/](http://aadant.com/blog/2014/02/04/how-to-calculate-a-specific-innodb-index-size/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-09-28T23:00:14.947

[来自 MySQL 5.6 参考](https://dev.mysql.com/doc/refman/5.6/en/innodb-persistent-stats.html)

```
SELECT SUM(stat_value) pages, index_name,
SUM(stat_value)*@@innodb_page_size size
FROM mysql.innodb_index_stats WHERE table_name='t1'
AND stat_name = 'size' GROUP BY index_name; 
```

# .net - 如何：使用不计算记录的数据阅读器

> ID：781877
> 
> 赞同：0
> 
> 时间：2009-04-23T14:06:03.420
> 
> 标签：.net, datareader

人们似乎已经失去了使用现代语言生成旧式 COBOL/RPG 报告的能力。

我经常看到使用依赖于记录计数的 DataReaders 的代码。因此，在不需要时会出现一个额外的聚合查询。

在大多数情况下，此代码需要知道是否有另一条记录可用。换句话说，告诉我是否在最后一条记录，以便我可以显示记录分隔符。

一个简单的算法如下：

```
 Dim available As Boolean = rdr.Read()
While available
  DisplaySearchRecord(rdr)
  available = rdr.Read()
  If available Then DisplaySeparator()
End While 
```

当算法的简单更改就足够时，请不要使用 COUNT(*) 或数据表/数据集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T14:15:33.847

为什么不显示后的分隔符`while`？

```
 While rdr.Read()
       DisplaySearchRecord(rdr)
   End While
   DisplaySeparator() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:18:28.537

你可以试试这样的

```
Dim IsFirst As Boolean = True

While rdr.Read()
  If Not IsFirst
    DisplaySeparator()
  Else
    IsFirst = False
  End If

  DisplaySearchRecord(rdr)
End While 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:19:12.933

您必须继续调用 reader.Read() ，当没有更多记录时它将返回 false 。

所以我要做的是将数据库中的数据转储到 a 中`List<YourRecord>`，然后在我填充了列表之后......用 for( i++ ) 循环遍历它并根据 list.Count 检查 i

# c# - 悬停时跳转菜单

> ID：781878
> 
> 赞同：1
> 
> 时间：2009-04-23T14:06:05.587
> 
> 标签：c#, asp.net, css, menu, border

我有一个网络应用程序（ASP.NET 2.0 C#）。在我的 Masterpage 上，我有一个菜单控件，并且我使用 css 样式表来设置菜单不同部分的样式。出于某种原因，当我将鼠标悬停在菜单上时，它会跳动一点。我认为当我将鼠标悬停在它上面时，边界会变得更大。

这是整个菜单的样式：

```
.menu
{
    width:110%;
    height:25px;
    border: 1px solid gray;
    text-align:center;
} 
```

这是我对 StaticHoverStyle 的风格：

```
.staticMenuHover
{
    background-color:#CCCCCC;
    border-style:solid;
    border-color:#888888;  
    text-decoration: underline;
    border-width:thin;
} 
```

我不知道为什么会这样，有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:19:34.697

悬停类上的边框宽度设置为细，在我的测试中呈现为 2 像素边框。将其设置为 1 像素。

```
border-width:1px; 
```

您还可以将第二类的边框规则折叠为一行，以使其与您的第一类保持一致，如下所示：

```
border:1px solid #888888; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:16:27.293

它正在发生，因为你在你的文本下划线。尝试不使用文本装饰，我敢打赌它会解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T16:43:29.567

您始终可以在链接中添加下划线（不是文本装饰）并调整填充。工作示例：

```
#menu ul li a {
    display: block;
    width: 95%;
    padding: 0px 2px 2px 4px;
    text-decoration: none;
    color: rgb(30%,30%,60%); background: transparent;
}
#menu ul li a:visited {
    color: rgb(50%,10%,100%); 
}
#menu ul li a:hover {
    color: #000;
    border-bottom: 2px solid #c63; 
    background: #fcf;
    padding-bottom: 0px; } 
```

使这项工作起作用的是将 2px 底部填充更改为 0 px 并在**同一规则**中添加 2px 边框底部。颜色变化与手头的问题无关。

# sql - 检查时间范围重叠，守望者问题 [SQL]

> ID：781895
> 
> 赞同：8
> 
> 时间：2009-04-23T14:08:21.493
> 
> 标签：sql, sql-server-2005, algorithm, linq-to-sql, tsql

我在一个更大的问题上遇到了障碍。

作为大型查询的一部分，我需要解决“守夜人”问题。我有一张这样的时间表变化表：

```
ID | Start          | End
1  | 2009-1-1 06:00 | 2009-1-1 14:00
2  | 2009-1-1 10:00 | 2009-1-1 18:00
3  | 2009-2-1 20:00 | 2009-2-2 04:00
4  | 2009-2-2 06:00 | 2009-2-2 14:00 
```

作为查询的一部分，我需要确定在给定时间范围内，房间内是否始终至少有 1 名守望者。

因此，如果我将范围指定`2009-1-1 06:00`为`2009-1-1 12:00`，则结果为真，因为班次 1 和班次 2 合并以覆盖此时间段 - 事实上，任何数量的班次都可以链接起来以保持监视。但是，如果我检查`2009-2-1 22:00`到`2009-1-2 10:00`，结果是错误的，因为第二天早上 4 点到 6 点之间有休息时间。

我想在 LINQ 中或作为 SQL Server (2005) 中的用户定义函数来实现这一点*，*因为在这两种情况下，这只是必须运行以识别需要注意的元素的更大查询的逻辑的一部分。真实的数据集涉及大约一百个与任何给定时间段相交的班次记录，但并不总是涵盖整个范围。

我发现的最接近的是 [How to group ranged values using SQL Server](https://stackoverflow.com/questions/472732/how-to-group-ranged-values-using-sql-server) for number range ，但是它取决于在下一个范围开始之前结束的每个范围。如果我可以构建相同的手表统一视图，只考虑重叠的手表，那么检查是否覆盖了特定时间将是微不足道的。统一视图如下所示：

```
Start          | End
2009-1-1 06:00 | 2009-1-1 18:00
2009-2-1 20:00 | 2009-2-2 04:00
2009-2-2 06:00 | 2009-2-2 14:00 
```

注意：只需提取所有数据并在其上运行一些手动循环，这整个事情就相对容易实现，但这是当前系统，由于班次数量和必须的时间范围数量，它相当慢被检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T16:04:20.953

这是一种像这样展平日期范围的方法

```
Start          | End
2009-1-1 06:00 | 2009-1-1 18:00
2009-2-1 20:00 | 2009-2-2 04:00
2009-2-2 06:00 | 2009-2-2 14:00 
```

您必须比较每一行中的*上一个* **和** *下一个日期，看看是否*

*   当前行的**开始**日期介于上一行的日期范围之间。
*   当前行的**结束**日期介于下一行的日期范围之间。

![替代文字](https://farm4.static.flickr.com/3501/3468942647_172669e3a6_o.png)

使用上面的代码，实现 UDF 很简单，如下所示。

```
create function fnThereIsWatchmenBetween(@from datetime, @to datetime)
returns bit
as
begin
    declare @_Result bit

    declare @FlattenedDateRange table (
        Start   datetime,
        [End]   datetime
    )

    insert  @FlattenedDateRange(Start, [End])
    select  distinct 
            Start = 
                case 
                    when Pv.Start is null then Curr.Start 
                    when Curr.Start between Pv.Start and Pv.[End] then Pv.Start
                    else Curr.Start 
                end,
            [End] = 
                case 
                    when Curr.[End] between Nx.Start and Nx.[End] then Nx.[End] 
                    else Curr.[End] 
                end
    from    shift Curr
            left join shift Pv on Pv.ID = Curr.ID - 1 --; prev
            left join shift Nx on Nx.ID = Curr.ID + 1 --; next

    if exists(  select  1
                from    FlattenedDateRange R
                where   @from between R.Start and R.[End]
                        and @to between R.Start and R.[End]) begin
        set @_Result = 1    --; There is/are watchman/men during specified date range
    end
    else begin
        set @_Result = 0    --; There is NO watchman
    end

    return @_Result
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:15:19.587

一个无人看守的间隔显然开始于观察周期的结束或您正在检查的整个时间范围的开始。因此，您需要一个查询来从该集合中选择没有重叠移位的所有元素。查询如下所示：

```
select 1 
from shifts s1 where not exists
    (select 1 from shifts s2
     where s2.start<=s1.end and s2.end > s1.end
    )
    and s1.end>=start_of_range and s1.end<  end_of_range
union
select 1 
where not exists
    (select 1 from shifts s2 
      where s2.start<=start_of_range and s2.end > start_of_range
    ) 
```

如果这是非空的，那么你有一个无人看守的间隔。我怀疑它会在二次时间内运行，所以它可能比“排序、获取和循环”慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T00:26:44.773

一种方法是创建一个临时表，其中包含需要检查的每个时间值的一行（这是轮班分辨率的函数）。

如果是分钟，那么一天会有 60 * 24 = 1440 行；一周大约 10K 行。

那么SQL就比较简单了：

> SELECT COUNT(1)
> FROM #minutes m
> LEFT JOIN 在 m.checktime s.start_time 和 s.end_time 之间转移 s 有
> COUNT(1) = 0

这样做的好处是还能够显示同时覆盖了多少班次。

鉴于您描述的比例，执行时间应该可以忽略不计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-03T16:50:26.793

我正在查看日期范围，并认为我会重新访问这个问题。我可能会在这里摔倒，但似乎这两个条件就足够了

```
(1) Shift is not at beginning of range and has no left neighbour

OR

(2) Shift is not at end of range and has no right neighbour. 
```

欣赏这可能不是最有效的。

```
CREATE TABLE times
(
TimeID int,
StartTime Time,
EndTime Time
)

INSERT INTO times
VALUES
(1,'10:00:00','11:00:00'),
(2,'11:00:00','12:00:00'),
(3,'13:00:00','14:00:00'),
(4,'14:30:00','15:00:00'),
(5,'15:00:00','16:00:00'),
(6,'16:00:00','17:00:00')

declare @start_of_range time ='09:30:00'
declare @end_of_range time = '17:30:00'

select timeID,StartTime,EndTime 
from times s1 where
-- No left neighbour and not at beginning of range
   not exists
    (select 1 from times s2
     where s2.startTime < s1.startTime and s2.endTime >= s1.startTime
    )
    and s1.StartTime>@start_of_range
  or
-- No right neighbour and not at end of range
   not exists
    (select 1 from times s2
     where s2.startTime <= s1.endTime and s2.endTime > s1.endTime
    )
    and s1.EndTime<@end_of_range 
```

结果集

```
timeID  StartTime   EndTime
1   10:00:00.0000000    11:00:00.0000000
2   11:00:00.0000000    12:00:00.0000000
3   13:00:00.0000000    14:00:00.0000000
4   14:30:00.0000000    15:00:00.0000000
6   16:00:00.0000000    17:00:00.0000000 
```

实际上只需要检查右邻居或左邻居，只要您确保检查范围的开始和结束，因此您可以将范围的开始引入为虚拟间隔，只需检查右邻居为如下：-

```
select * from
(
select timeID,StartTime,EndTime 
from times union select 0,@start_of_range,@start_of_range) s1
where
    not exists
    (select 1 from times s2
     where s2.startTime<=s1.endTime and s2.endTime > s1.endTime
    )
    and s1.EndTime<@end_of_range 
```

结果集

```
timeID  StartTime   EndTime
0   09:30:00.0000000    09:30:00.0000000
2   11:00:00.0000000    12:00:00.0000000
3   13:00:00.0000000    14:00:00.0000000
6   16:00:00.0000000    17:00:00.0000000 
```

# python - 脚本的惩罚在后台不断循环

> ID：781896
> 
> 赞同：0
> 
> 时间：2009-04-23T14:08:25.270
> 
> 标签：python, resources, performance, queue

[我知道这个话题过去](https://stackoverflow.com/questions/379231)已经[讨论](https://stackoverflow.com/questions/680921#681336)过，但我对资源使用有点偏执。

我正在考虑编写一个用于排队作业的守护程序，以将文件归档为我正在开发的 Web 应用程序的 zip 文件。它的行为是这样的：

```
while True:
    while morejobs():
        zipfile()
    sleep(15seconds) 
```

一个在后台不断循环的进程会消耗什么样的资源（假设没有要压缩的东西）？有什么我应该注意或小心的吗？

## 编辑：

看起来大多数答案都与睡眠时间有关。我一次盲目地将其设置为睡眠（在代码示例中）15 毫秒。我实际上打算将其设置为 15 秒，并且我已经“更新”了代码以反映这一点。

## 再次编辑：

脚本休眠的最低合理时间是多少？5秒低吗？我不知道这个应用程序的负载是多少，也不知道新作业多久会添加到队列中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T14:22:10.417

睡眠不涉及开销。Linux 操作系统使用一个非常简单的信号来唤醒一个睡眠进程。

您所展示的是“忙于等待”的设计模式。

为了消除开销，您只想在有工作要做时才被唤醒。

方法来做到这一点。

1.  等着读。

2.  等待选择函数调用。请参阅[http://docs.python.org/library/select.html](http://docs.python.org/library/select.html)

3.  等待一个锁被释放。请参阅[http://docs.python.org/library/posixfile.html](http://docs.python.org/library/posixfile.html)。

其中，等待读取可能是最简单的。从管道或套接字读取是您想要做的。

我猜你有一个“多作者单读者”的设计模式。在这种情况下，有两个候选解决方案。

1.  每个套接字多个请求。这是一个类似 FTP 的解决方案，您可以编写一个简单的服务器来侦听一个套接字上的连接并为每个客户端打开一个专用连接。然后您使用 select 来确定哪个客户端正在发送文件。

2.  每个套接字单个请求。这是类似 HTTP 的解决方案，您在某个套接字中接收请求，并且请求是大量数据。当请求全部完成时，套接字将关闭，以便另一个客户端可以获取它。

在这两种情况下，您不是在睡觉——您是在等待 I/O 完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:11:03.500

与其睡 15 秒，不如有一个回调来在新文件到达时重新开始你的工作。

*   处理可用文件
*   每 60 秒或您选择的任何间隔检查一次新文件
*   当一个新文件到达时，处理它以及自上次间隔以来可能到达的任何其他文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T02:30:45.393

作为替代方案，您可以降低进程的优先级。（我只熟悉windows方法）

在 Windows 上：

```
def setpriority(pid=None,priority=1):
    """ Set The Priority of a Windows Process.  Priority is a value between 0-5 where
        2 is normal priority.  Default sets the priority of the current
        python process but can take any valid process ID. """

    import win32api,win32process,win32con

    priorityclasses = [win32process.IDLE_PRIORITY_CLASS,
                       win32process.BELOW_NORMAL_PRIORITY_CLASS,
                       win32process.NORMAL_PRIORITY_CLASS,
                       win32process.ABOVE_NORMAL_PRIORITY_CLASS,
                       win32process.HIGH_PRIORITY_CLASS,
                       win32process.REALTIME_PRIORITY_CLASS]
    if pid == None:
        pid = win32api.GetCurrentProcessId()
    handle = win32api.OpenProcess(win32con.PROCESS_ALL_ACCESS, True, pid)
    win32process.SetPriorityClass(handle, priorityclasses[priority]) 
```

来自： [http ://code.activestate.com/recipes/496767/](http://code.activestate.com/recipes/496767/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T14:12:58.177

为什么不使用 cron 作业每分钟左右运行一次脚本呢？至少您不依赖自己的循环在后台连续运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T14:16:01.477

如果文件到达需要 20 秒（这些数字是示例），而您需要 5 秒来处理它，那么您的进程在检测到文件之前平均再等待 7.5 秒有什么危害？那里？

休眠进程应该对 CPU 的影响尽可能接近于零。

所以不，我根本不会关心这个方面。

您应该关心的一件事是如果进程失败，如何自动重新启动进程。我会每 5 分钟运行一次 cron 作业（您选择的实际频率）以杀死旧副本（礼貌地，并且仅在它正在运行时），然后启动一个新副本。这样，如果出现问题，最多只有 5 分钟的停机时间。

我礼貌地说，因为旧的可能正在处理文件，除非它是可恢复的，否则你不应该中断它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T14:10:24.720

即使没有要处理的内容，这也可能会影响您的 CPU。

**编辑：**实际上[`sleep()`](http://docs.python.org/library/time.html#time.sleep)将参数作为秒数，而不是毫秒，所以我认为 CPU 不会成为问题。不过，也许您可​​以使用 cron 作业来安排这样的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T14:13:41.870

除了敲打 CPU 的成本外，还有*morejobs()*调用的成本。您可以通过使用更高的*sleep()*值来缓解，或者您可以使用某种接收请求然后触发*zipfile()*操作的邮箱。

对于某些操作来说，安排一个后台线程来临时检查某些东西是正常的。在这种情况下，最好的方法是对*sleep()*使用合理的值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T22:50:54.783

“一千个有道理的意见值得一次衡量”。

去尝试一下。

# html - 正则表达式 - 仅匹配一个标签

> ID：781897
> 
> 赞同：3
> 
> 时间：2009-04-23T14:08:33.710
> 
> 标签：html, regex

我有一个正则表达式来从 HTML 字体标签中提取文本：

```
<FONT FACE=\"Excelsior LT Std Bold\"(.*)>(.*)</FONT> 
```

在我有一些嵌套的字体标签之前，它工作得很好。而不是匹配

```
<FONT FACE="Excelsior LT Std Bold">Fett</FONT> 
```

字符串的结果

```
<FONT FACE="Excelsior LT Std Bold">Fett</FONT> + <U>Unterstrichen</U> + <FONT FACE="Excelsior LT Std Italic">Kursiv</FONT> und Normal 
```

是

```
<FONT FACE="Excelsior LT Std Bold">Fett</FONT> + <U>Unterstrichen</U> + <FONT FACE="Excelsior LT Std Italic" 
```

我如何只获得第一个标签？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T14:11:47.163

`.*?`您需要使用而不是禁用贪婪匹配`.*`。

```
<FONT FACE=\"Excelsior LT Std Bold\"([^>]*)>(.*?)</FONT> 
```

请注意，如果在标签的属性`BadAttribute="<FooBar>"`后面有类似的属性，这将失败。这将混合两个匹配组，如果属性包含. 没有办法解决这个问题，因为正则表达式无法计算匹配的标签或引号。所以我绝对同意 Tomalak 的观点——尽量避免使用正则表达式来处理 XML、HTML 和其他类似的标记语言。`FACE``<FONT>``</FONT>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T14:10:53.343

您必须使用非贪婪星：

```
<FONT FACE=\"Excelsior LT Std Bold\"[^>]*>(.*?)</FONT>
                                    ^^^^^  ^^^
                                      |     |
     match any character except ">" --+     +--------+
                                                     |
   match anything, but only up to the next </FONT> --+ 
```

关于使用正则表达式处理 HTML 的常见警告适用：你不应该。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T14:12:08.613

您需要使用由“？”表示的非贪婪捕获

```
 <FONT FACE=\"Excelsior LT Std Bold\"(.*?)>(.*?)</FONT> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T15:54:27.623

```
<FONT[^>]*Excelsior LT Std Bold[^>]*></FONT> 
```

[在此处](http://haacked.com/archive/2004/10/25/usingregularexpressionstomatchhtml.aspx/)查看 Phil Haack 的帖子。

这是我对这个表达式的 C# 用法。这用于从 HTTP 响应中删除特定的 CSS 和 JS 文件。

```
const string CSSFormat = "<link[^>]*{0}[^>]*css[^>]*>";
const string JSFormat = "<script[^>]*{0}[^>]*js[^>]*></script>";

static readonly Regex OverrideCss = new Regex(string.Format(CSSFormat, "override-"), RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Singleline);
static readonly Regex OverrideIconsJs = new Regex(string.Format(JSFormat, "overrideicons"), RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Singleline); 
```

# c# - 获取逻辑驱动器列表

> ID：781905
> 
> 赞同：52
> 
> 时间：2009-04-23T14:09:50.977
> 
> 标签：c#, hard-drive

如何获取系统上的逻辑驱动器 (C#) 列表及其容量和可用空间？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-23T14:13:02.467

[`System.IO.DriveInfo.GetDrives()`](http://msdn.microsoft.com/library/system.io.driveinfo.getdrives)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-23T14:16:24.377

```
foreach (var drive in DriveInfo.GetDrives())
{
    double freeSpace = drive.TotalFreeSpace;
    double totalSpace = drive.TotalSize;
    double percentFree = (freeSpace / totalSpace) * 100;
    float num = (float)percentFree;

    Console.WriteLine("Drive:{0} With {1} % free", drive.Name, num);
    Console.WriteLine("Space Remaining:{0}", drive.AvailableFreeSpace);
    Console.WriteLine("Percent Free Space:{0}", percentFree);
    Console.WriteLine("Space used:{0}", drive.TotalSize);
    Console.WriteLine("Type: {0}", drive.DriveType);
} 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-23T14:14:40.793

[Directory.GetLogicalDrives](http://msdn.microsoft.com/en-us/library/system.io.directory.getlogicaldrives.aspx)

他们的例子更健壮，但这就是它的症结所在

```
string[] drives = System.IO.Directory.GetLogicalDrives();

foreach (string str in drives) 
{
    System.Console.WriteLine(str);
} 
```

您还可以[P/Invoke](http://www.webtropy.com/articles/art9-1.asp?f=GetLogicalDriveStrings)并调用 win32 函数（如果您在非托管代码中，则使用它）。

**但是，这只会获取驱动器列表，**有关每个驱动器的信息，您可能希望使用[GetDrives](http://msdn.microsoft.com/en-us/library/system.io.driveinfo.getdrives.aspx)，如 Chris Ballance 演示的那样。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-12-13T19:31:36.790

也许这就是你想要的：

```
listBox1.Items.Clear();

foreach (DriveInfo f in DriveInfo.GetDrives())    
    listBox1.Items.Add(f); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T14:14:09.373

您可以使用 Windows Management Instrumentation (WMI) 检索此信息

```
 using System.Management;

    ManagementObjectSearcher mosDisks = new ManagementObjectSearcher("SELECT * FROM Win32_DiskDrive");
    // Loop through each object (disk) retrieved by WMI
    foreach (ManagementObject moDisk in mosDisks.Get())
    {
        // Add the HDD to the list (use the Model field as the item's caption)
        Console.WriteLine(moDisk["Model"].ToString());
    } 
```

这里有更多关于你可以轮询的属性的信息

[http://www.geekpedia.com/tutorial233_Getting-Disk-Drive-Information-using-WMI-and-Csharp.html](http://www.geekpedia.com/tutorial233_Getting-Disk-Drive-Information-using-WMI-and-Csharp.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-22T18:07:09.450

这是一段很棒的代码。

```
ObjectQuery query =
    new ObjectQuery("SELECT * FROM Win32_LogicalDisk WHERE DriveType=3"); // Create query to select all the hdd's

ManagementObjectSearcher searcher =
  new ManagementObjectSearcher(scope, query); // run the query

ManagementObjectCollection queryCollection = searcher.Get(); // get the results
string sVolumeLabel = "";
string[,] saReturn = new string[queryCollection.Count, 7];
int i = 0; // counter for foreach

foreach (ManagementObject m in queryCollection)
{
  if (string.IsNullOrEmpty(Convert.ToString(m["VolumeName"]))) { sVolumeLabel = "Local Disk"; } else { sVolumeLabel = Convert.ToString(m["VolumeName"]); } // Disk Label
  string sSystemName = Convert.ToString(m["SystemName"]); // Name of computer
  string sDriveLetter = Convert.ToString(m["Name"]); // Drive Letter

  decimal dSize = Math.Round((Convert.ToDecimal(m["Size"]) / 1073741824), 2); //HDD Size in Gb
  decimal dFree = Math.Round((Convert.ToDecimal(m["FreeSpace"]) / 1073741824), 2); // Free Space in Gb
  decimal dUsed = dSize - dFree; // Used HDD Space in Gb

  int iPercent = Convert.ToInt32((dFree / dSize) * 100); // Percentage of free space

  saReturn[i,0] = sSystemName;
  saReturn[i,1] = sDriveLetter;
  saReturn[i,2] = sVolumeLabel;
  saReturn[i,3] = Convert.ToString(dSize);
  saReturn[i,4] = Convert.ToString(dUsed);
  saReturn[i,5] = Convert.ToString(dFree);
  saReturn[i,6] = Convert.ToString(iPercent);

  i++; // increase counter. This will add the above details for the next drive.
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-04T21:57:52.467

我部署了一个 SSIS 包并得到一个错误只是因为在 Ballance 示例中我们正在读取驱动器而不等待它们准备好：

```
string EmailMessage = "";
foreach (var drive in System.IO.DriveInfo.GetDrives())
{
    if (drive.IsReady == true) /*Make sure we can read*/
    {
        double freeSpace = drive.TotalFreeSpace;
        double totalSpace = drive.TotalSize;
        double percentFree = (freeSpace / totalSpace) * 100;
        float num = (float)percentFree;
        //MessageBox.Show("Drive:" + drive.Name + " With " + num + "% free.");
        if (num < 5)
        {
            EmailMessage = "Drive:" + drive.Name + " With " + num + "% free.";
        }
    }

} 
```

# c++ - 使用 g++ 编译器生成目标文件到单独的目录 - C++

> ID：781907
> 
> 赞同：6
> 
> 时间：2009-04-23T14:10:05.233
> 
> 标签：c++, g++

我使用以下代码将 cpp 文件编译为目标文件。

```
g++ -c main.cpp 
```

上面的代码在 main.cpp 所在的同一目录中生成 .o 文件。

1.  假设我有一个名为 obj 的文件夹，需要在那里生成目标文件，我该怎么写呢？
2.  如何查看 g++ 支持的编译器开关及其用法？

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T14:12:36.320

> 假设我有一个名为 obj 的文件夹，需要在那里生成目标文件，我该怎么写？

采用：

```
g++ -c main.cpp -o obj/main.o 
```

> 如何查看 g++ 支持的编译器开关及其用法？

如果您在 *nix 系统上，请使用：

```
man g++ 
```

或使用`info g++`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T14:12:48.643

如果你输入

```
$man g++ 
```

这是[联机手册页](http://linux.die.net/man/1/g++)您可能会在那里获得大量好信息。你也可以试试

```
$g++ --help 
```

对你的问题。如果您使用了 -o 开关，则可以指定要使用的输出文件。所以你可能会做类似的事情

```
$g++ -c main.cpp -o obj/main.obj 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T15:35:21.990

问题 2 的另一个答案：有关编译器开关的更多信息可以在[在线手册](http://gcc.gnu.org/onlinedocs/gcc-4.4.0/gcc/Option-Summary.html#Option-Summary)中找到。

# c# - WPF 中的 ItemsSource 以编程方式以声明方式转换为 C#

> ID：781926
> 
> 赞同：3
> 
> 时间：2009-04-23T14:12:42.950
> 
> 标签：c#, xaml

快速提问，如何将其转换为后端代码？即c#

ItemsSource="{Binding Source={StaticResource List1}, XPath=Entry}"

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T14:36:21.067

```
Binding items = new Binding();
items.Source = FindResource("List1");
items.XPath = "Entry";
myItemsControl.SetBinding(ItemsControl.ItemsSourceProperty, items); 
```

`myItemsControl`要设置的控件在哪里`ItemsSource`。

# .net - 如何在共享虚拟主机环境中创建文件观察器

> ID：781927
> 
> 赞同：0
> 
> 时间：2009-04-23T14:12:44.947
> 
> 标签：.net, asp.net, web-hosting

我有一个 Windows 共享网络托管，我想在那里创建一个文件观察器，它将监视我的图像文件夹并调整新图像的大小。
我想把它做成一个单独的组件，因为我以后可能会卖给其他人。
有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:36:37.293

您将很难在共享环境中实现文件观察器。通常实现类似的最简单方法是将其编写为 Windows 服务并使用内置的 .NET 文件/目录监视类。

除非您有能力在共享服务器上安装应用程序/服务，否则我认为您会发现自己运气不好。

# c# - 使用 C# 对 WCF 进行异步调用？

> ID：781932
> 
> 赞同：4
> 
> 时间：2009-04-23T14:13:18.860
> 
> 标签：c#, wcf, asynchronous

在 C# 中，如何对 WCF Web 服务进行异步调用？我设置了一个服务参考来生成异步。我还修改了调用以使用 { WebServiceObject.Begin* () }，但最后有两个参数，“AsyncCallback”和“object asyncState”。这些是什么以及如何使用它们？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T14:22:36.217

您可能还想看看[Async without the Pain](http://marcgravell.blogspot.com/2009/02/async-without-pain.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T14:18:42.920

请参阅此处的 MSDN；[http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx](http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx)

这里; [http://msdn.microsoft.com/en-us/library/ms228969.aspx](http://msdn.microsoft.com/en-us/library/ms228969.aspx)

这里; [http://msdn.microsoft.com/en-us/library/ms228975.aspx](http://msdn.microsoft.com/en-us/library/ms228975.aspx)

和这里; [http://msdn.microsoft.com/en-us/library/86wf6409.aspx](http://msdn.microsoft.com/en-us/library/86wf6409.aspx)

基本上在 Begin* 中设置一个回调，当操作完成时调用该回调。在那里你调用 End* 来检索适当的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T14:21:19.497

操作完成时调用回调，因此您可以调用 End* 并获取返回值或异常（如果有）。如果您在多个地方使用相同的回调方法，asyncState 只是回调中匹配的值。这是异步设计模式的描述 - [http://msdn.microsoft.com/en-us/library/aa719595(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa719595(VS.71).aspx)

如果您正在创建 GUI 应用程序，请考虑使用另一个版本 - *Async 方法，该方法也会为每个操作生成。它提供线程同步。

# web-services - 在 WSS 功能 OnActivated 事件中调用长时间运行的操作

> ID：781944
> 
> 赞同：0
> 
> 时间：2009-04-23T14:15:06.283
> 
> 标签：web-services, sharepoint, wss, wss-3.0

更具体地说 - 如何使用**[SoapDocumentMethod(OneWay=true)]**在 Web 服务中引用 SPContext ？

我们正在创建一个在创建站点时需要运行作业的功能。该作业大约需要 4 分钟才能完成。因此，我们创建了一个 Web 服务，我们可以在激活该功能时调用它。这可行，但我们希望它现在异步运行。我们找到了 SoapDocumentMethod 的 OneWay 属性，它可以很好地工作，但 SPContext 现在为 NULL。

我们的 Web 服务位于 _vti_bin 虚拟目录中，因此它在每个 Windows Sharepoint 服务站点中都可用。我正在使用 SPContext.Current.Web 来获取站点并执行长时间运行的操作。我想通过立即返回一个肥皂响应并让该过程运行来触发并忘记它。

如何获取当前的 SPContext？我曾经能够在我的网络服务中做到这一点：

```
SPWeb mySite = SPContext.Current.Web; 
```

当我将**[SoapDocumentMethod(OneWay=true)]**属性应用于我的 Web 服务时，我可以获得相同的上下文吗？

或者我必须从 url 重新创建 SPWeb？

这类似于此线程：[webservice oneway 和 new SPSite(myUrl)](https://stackoverflow.com/questions/340192/webservice-oneway-and-new-spsitemyurl)

* * *

更新：我尝试了这两种方法，但没有奏效：

```
SPWeb targetSite = SPControl.GetContextWeb(this.Context);

SPWeb targetSite2 = SPContext.GetContext(this.Context).Web; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T09:42:20.857

> 单向方法不能有返回值或任何输出参数

但是它们确实有参数，不是吗？

当你调用webservice方法时，你不能从featurereceiver传入当前站点的url，然后 在web service方法中**使用(SPSite site = new SPSite(urlPassedAsParameter))** 吗？

FeatureActivated 覆盖中的 SPFeatureReceiverProperties 将当前 SPWeb 或 SPSite 作为 SPFeatureReceiverProperties.Parent。

# c# - 将对象从表单传递到表单

> ID：781945
> 
> 赞同：0
> 
> 时间：2009-04-23T14:15:12.383
> 
> 标签：c#, .net, winforms, oop

我有一个相当大的 CRUD winform 应用程序，它设置为显示嵌入在 tabcontrols 中的表单。我想为 Person,(has a) Enrollment,(has a) Plan 提供对象，这些对象在与表单交互时保存和跟踪信息。我该如何做到这一点？我发现了一个在我的***Program.cs***中声明 Person 对象的建议，就像这样 -->

```
internal static class Program
{
    public static CurrentPerson _CurrentPerson;

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    private static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new FrmWWCShell());
    }
} 
```

然后在***Search.cs*** -->

```
 Program._CurrentPerson = new CurrentPerson
                                     {
                                         PersonID = Convert.ToInt32(pID),
                                         LastName = lName,
                                         FirstName = fName,
                                         SocialSn = sSN,
                                         MiddleName = mName,
                                         BirthDate = Convert.ToDateTime(bDate)
                                     }; 
```

这是最好的方法吗？一旦他们在“搜索”页面上进行了选择，仍然需要从数据库中*填写大量数据。*在每个表单上声明对象并以某种方式传递它怎么样？随着它们的进展，该对象被缓慢地“构建”。首先，他们按姓名**搜索**某人并选择他们将与谁一起工作。然后他们可以在那里注册。选择注册后，他们将能够与那里的计划进行交互。

我将不胜感激这里的任何指导，因为这件事的范围让我没有经验的头晕目眩……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:20:31.823

您将需要分离您的数据、逻辑和 GUI。

查看[模型-视图-控制器模式](http://en.wikipedia.org/wiki/Model-view-controller)。

如果您认为在您的情况下它太复杂，您可能只需创建一个中央控制器类来保存中央数据。在每个表单构造函数中传递这个对象，你就完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T14:21:31.540

**a) 单身人士**

从代码重用的角度来看，全局静态属性并不是一个好主意。如果您计划从整个代码中访问全局静态属性，那么您的代码就与这个特定的应用程序非常相关。

如果您的代码中始终只有一个实例`Person`，那么您可以将此 Singleton 放在`Person`类中，但肯定不能放在您的`Program`类中。但是请注意，Singleton 类的使用通常仅限于日志服务或其他非常普遍的东西，以至于它肯定永远不会改变。

**b) 相同的对象引用**

在这种情况下，您不需要单例实例，而是将**相同的引用**传递给您的数据对象（Person 或其他任何东西）**到访问它的每个表单**。如果您的表单是您数据的一部分的表示，那么您可以只将这部分数据传递给表单，最好通过最简单的接口。

更改一种形式的数据可能需要更新其他形式。这就是 Model-View-Controller 和类似模式可以帮助您完成的工作 -**通知视图数据已在其他地方更改**。

例如，通过在您的`Person`类中实现 IPropertyNameChanged 接口，您可以在属性发生更改时通知任何感兴趣的人（任何表单）。检查此示例：http: [//msdn.microsoft.com/en-us/library/ms229614.aspx](http://msdn.microsoft.com/en-us/library/ms229614.aspx)。通过在每个表单中将事件处理程序附加到该事件，您将通知所有这些事件它们需要失效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:34:27.360

看一下[中介者](http://en.wikipedia.org/wiki/Mediator_pattern)设计模式。

# php - 我怎样才能找出约会前一天的日期？

> ID：781949
> 
> 赞同：5
> 
> 时间：2009-04-23T14:16:05.390
> 
> 标签：php, php4

我有一个系统，可以将截至当前日期的财政年度与前一年的同一日期范围进行比较。您可以调整要查看的年份和月份，并且它始终将相同的日期范围与前一年进行比较。我设置了它，所以如果今天是闰日，它与去年的 28 日相比，如果去年是闰年，今天是 2 月 28 日，它与去年的 29 日相比。如果您查看当前月份以外的月份，则它会显示到该月的最后一天，否则会显示到当前日期。

好的，现在工作正常，但现在我的雇主不希望它达到当前日期，他们希望它达到昨天的日期。我该怎么做呢，我主要关心的是如果今天是本月的第一天，或者今天是财政年度的第一天怎么办。

这是我现在拥有的代码：

```
function create_YTD_XML()
{
    global $month;
    global $year;

    $last_year = $year - 1;

    if($year == date('Y') && $month == date('m'))
    {
        $this_day = date('d');
    }
    else
    {
        $this_day = date('t', mktime(0, 0, 0, $month, 1, $year)); // LAST DAY OF MONTH
    }

    if(is_leap_year($year) && $this_day == 29)
    {
        $last_day = 28;
    }
    else if(is_leap_year($last_year) && $this_day == 28)
    {
        $last_day = 29;
    }
    else
    {
        $last_day = $this_day;
    }

    if($month >= 2)
    {
        $this_year_start = $year;
        $last_year_start = $last_year;
    }
    else
    {
        $this_year_start = $year - 1;
        $last_year_start = $last_year - 1;
    }

    $this_ytd_start = $this_year_start.'-02-01';
    $last_ytd_start = $last_year_start.'-02-01';

    $this_ytd_end = $year.'-'.str_pad($month, 2, "0", STR_PAD_LEFT).'-'.$this_day;
    $last_ytd_end = $last_year.'-'.str_pad($month, 2, "0", STR_PAD_LEFT).'-'.$last_day;

} 
```

最好的解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-23T14:18:40.533

[strtotime()](http://us2.php.net/manual/en/function.strtotime.php)可以解决问题。[使用mktime()](http://us2.php.net/manual/en/function.mktime.php)将您之前的日期转换为 Unix 时间戳，然后像这样使用它：

```
$from_unix_time = mktime(0, 0, 0, $month, $day, $year);
$day_before = strtotime("yesterday", $from_unix_time);
$formatted = date('Y-m-d', $day_before); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-11-08T13:43:15.407

您还可以使用[strtotime](http://php.net/manual/en/function.strtotime.php)函数使用以下*单词*：

```
$date = '2012-11-08';
$day_before = date( 'Y-m-d', strtotime( $date . ' -1 day' ) ); 
```

的输出`$day_before`：

```
2012-11-07 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-23T14:28:47.903

您可以依靠 mktime() 处理“不正确”值的能力。假设 $year、$month 和 $day 是当天。

```
$yesterday = mktime (0, 0, 0, $month, $day - 1, $year);
echo date ('Y-m-d', $yesterday); 
```

别担心，它只会做正确的事：尝试不同的价值观。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-20T21:47:46.763

我确实会以这种方式使用 strtotime：

```
$date="2014-02-20";
echo date("Y-m-d",strtotime($date." -1 day")); 
```

将输出：

```
2014-02-19 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-08T13:56:35.257

```
$date = date('Y-m-d',strtotime('yesterday')); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-23T18:42:34.587

**注意：**以下答案未考虑夏令时；在一年中的某些时候，它会返回一个不准确的结果。有关更多信息，请参阅评论。

* * *

由于一天的长度是恒定的（86,400 秒），您可以使用算术来确定给定日期前一天的时间戳：

```
$yesterday = date('Y-m-d', strtotime($current_date) - 86400); 
```

`$current_date`是您要查找前一天的日期。如果它已经是一个[unix timestamp](http://en.wikipedia.org/wiki/Unix_timestamp)，你可以`strtotime()`完全省去：

```
$yesterday = date('Y-m-d', $current_date_as_unix_timestamp - 86400); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T14:26:49.297

我认为这取决于您的雇主想要的行为。没有“正确”的答案——如果今天是一个财政年度的开始，他们是否希望比较过去两个财政年度（如果您使用昨天作为“最新”日期会发生这种情况）还是他们想要与上一财年的第一天相比，查看本财年的第一天？您需要坐下来找出潜在的边缘情况，然后与您的雇主讨论他们想要什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-13T13:53:16.397

您还可以使用以下代码来工作：

```
$current_date = strtotime('25-11-2012');
echo $yesterday = date('Y-m-d', strtotime('-1 day', $current_date)); 
```

代码输出如下：

```
2012-11-24 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-25T05:27:26.813

固定时间前一天 07:59:59

```
$demo = date("Y-m-d H:i:s", mktime(7, 59, 59, date("m"),date("d")-1,date("Y"))); 
```

# firefox - 取消转义 ® 时的 Firefox 和神奇出现的字符 (Â)

> ID：781966
> 
> 赞同：0
> 
> 时间：2009-04-23T14:19:27.600
> 
> 标签：firefox, forms, pdf, character, illegal-characters

我`®`在 Firefox 中将一个（注册字符）转义为以表单形式提交，因为实际上将该字符输入 Javascript 会导致脚本行为异常。

但是，我必须使用字符的未转义（..）版本，因为它被提交到后端（我无法控制）并且输出是一个 pdf 文件，它使用未转义`®`的 pdf 格式显示。

我像这样对角色进行转义`®`：

`unescape("%AE")`

但是......当我`®`在 pdf 文件中查看它时，它显示为`Â®`，这只发生在 Firefox 中，而不是 Internet Explorer。

有没有办法让它在 Firefox 2/3 中工作？

谢谢，
   安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T15:30:51.457

AFAIK，在取消转义后，Mozilla 返回 Unicode 表示`®`，但 IE 不返回。（十六进制的“%C2%AE”，`%C2`表示`Â`PDF 中出现的奇怪字符。） Internet Explorer 和 Mozilla 以不同的方式对字符串进行转义。您应该设置明确的字符编码，主要是 UTF-8。

[MDC：转义和取消转义功能](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide:Predefined_Functions:escape_and_unescape_Functions)：

> escape 和 unescape 函数不适用于非 ASCII 字符，已被弃用。在 JavaScript 1.5 及更高版本中，使用 encodeURI、decodeURI、encodeURIComponent 和 decodeURIComponent。

[MSDN](http://msdn.microsoft.com/en-us/library/dz4x90hk(VS.85).aspx)：

> unescape 方法返回一个包含 charstring 内容的字符串值。以 %xx 十六进制形式编码的所有字符都将替换为其 ASCII 字符集等效项。
> 
> 以 %uxxxx 格式编码的字符（Unicode 字符）被替换为具有十六进制编码 xxxx 的 Unicode 字符。

# html - 用标题和表格排列 css 层的问题

> ID：781970
> 
> 赞同：0
> 
> 时间：2009-04-23T14:19:35.023
> 
> 标签：html, css

我在使用下面的 css 安排项目时遇到问题。

我遇到的一个更明显的问题是表格列标题的强文本是黑色的，并且与表格上方信息中的强文本不匹配。

我的主要问题是Layer3不会到Layer2的底部。我希望它位于信息列的下方，但是此时来自 layer3 的 h1 出现在 rightlayer 的图片旁边。

如何强制 layer3 停留在 Layer2 的底部？

与我目前的 le​​ftlayer、leftlayer2 和 rightlayer 方法相比，将信息组织成列的更好方法是什么？

```
<html><head><title>Auctions</title>

<link rel="stylesheet" href="stylesheet.css" type="text/css">
</head>
<body>
<div id="Layer0">
<div id="Layer2">
<h1>Org."EdHardy"Herren"Hoodie"Gelb"Gr."XL"</h1>
<div id="leftlayer" class="leftlayer">
<p><strong>Username: </strong>trend-mode-2008
</p>
<p><strong>Article Number: </strong>250405322811
</p>
<p><strong>Subtitle: </strong>Original Neu Kollekt
</p>
<p><strong>Auction Start: </strong>11.4.2009
16:46:29 </p>
<p><strong>Auction End: </strong>21.4.2009 16:46:29
</p>
<p><strong>Auction Type: </strong>Buy Now
</p>
<p><strong>Category: </strong>Jacken
</p>
</div>
<div class="leftlayer2">
<p><strong>Condition: </strong> New
</p>
<p><strong>Total Items: </strong> 6
</p>
<p><strong>Total Sales: </strong> 1
</p>
<p><strong>Start Price: &#8364;</strong> 0.00
</p>
<p><strong>Buyitnow Price: &#8364;</strong> 89.00
</p>
<p><strong>Bids: </strong> 1 </p>
<p><strong>Revised: </strong> No
</p>
</div>
<div class="leftlayer2">
<p><strong>Private: </strong> No
</p>
<p><strong>Finished: </strong> No
</p>
<p><strong>Cancelled: </strong> No
</p>
<p><strong>Paypal: </strong> No
</p>
<p><strong>Country: </strong> Germany
</p>
<p><strong>Location: </strong> Herne
</p>
<p><strong>Shipping to: </strong> Germany</p>
<form name="categoryForm">
<p><input name="radiobutton" value="fakeapproved" type="radio">Fake (Approved)</p>
<p><input name="radiobutton" value="fakesuspected" type="radio">Fake (Suspected)</p>
<p><input name="radiobutton" value="keyword" type="radio">Forbidden Keywords</p>
<p><input name="radiobutton" value="parallelimport" type="radio">Parallel Imports
<input name="Submit" value="Update" onclick="handleClick('250405322811', 'Hardy', '1', '250405325721', 'trend-mode-2008');return false" type="submit"></p>
</form>
</div>
<div id="rightlayer"><a href="#" onclick="makewindows(&amp;amp;quot;&lt;img src='..\/images\/250405322811.jpg' &gt;&amp;amp;quot;); return false;">
<img src="../images/250405322811.jpg" height="100" width="100"></a>
<p><a href="#" onclick="makewindows(&amp&lt;quot;); return false;">Click
for full description </a></p>
<p><a href="#" onclick="deleteRec('250405322811', 'Hardy', '1', '250405325721')">DELETE</a>
</p>
</div>
<div id="Layer3">
<h1>Hardy Auctions</h1>
<table border="0" width="85%">
<tbody>
<tr>
<td width="15%"><strong>Seller ID</strong></td>
<td width="10%"><strong>Start Date</strong></td>
<td width="65%"><strong>&gt;Description</strong></td>
<td width="10%"><strong>Category</strong></td>
</tr>
<tr id="article_250405322811">
<td><a href="#" onclick="updateByUser('trend-mode-2008','')">trend-mode-2008</a></td>
<td><a href="#" onclick="updateByPk('Layer2', '250405322811', 'Hardy', '1')">11
04 2009</a></td>
<td><a href="#" onclick="updateByPk('Layer2', '250405322811', 'Hardy', '1')">Org."EdHardy"Herren"Hoodie"Gelb"Gr."XL"</a></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="tablefooter" class="tablefooter">
<div id="tablefooterleft" class="tablefooterleft"><a href="#" onclick="updateByPage('Layer3', 'Hardy', '1')">&lt;&lt;-First
</a><a href="#" onclick="updateByPage('Layer3', 'Hardy', '1')">&lt;-Previous</a>-----------------------------------------------------------------<a href="#" onclick="updateByPage('Layer3', 'Hardy', '2')">
Next -&gt; </a><a href="#" onclick="updateByPage('Layer3', 'Hardy', '7')"> Last
-&gt;&gt;</a></div>
</div>
</div>
</div>
</body></html> 
```

和CSS：

```
#Layer0 {
  width: 100%;
  height: 100%;
}

body{
margin:10px 10px 0px 10px;
padding:0px;
color:#999999;
font-family:"Trebuchet MS",arial,sans-serif;
font-size:70.5%;

}

#Layer2 {
background:#fff;
color:#000;
voice-family: "\"}\"";
voice-family: inherit;
padding:20px;

}

#Layer2 p {color:#888;}

#Layer2 a, a:link { color:#006633; text-decoration: none;}

#Layer2 a:hover, a:active{ color:#FF6666; text-decoration: none;}

html>body #Layer2 {
}

p,h1,pre {
margin:0px 10px 10px 10px;
font:Arial, Helvetica, sans-serif;
font-size:12px;
line-height: 1.6em;
text-align:justify;
text-decoration:none;
}

h1 {
font-size:2.5em;
text-align: center;
color:#ccc;
padding-top:15px;

}

h3 {
font-size:14px;
color:#999;

}

.leftlayer {
  float: left;
  left: 20%;
  width: 20%;
  height: 100%;
  margin-right: 10%;
}
.leftlayer strong {
  text-align: left;
}
.leftlayer2 {
  float: left;
  width: 20%;
  height: 100%;
  margin-left: 2%;
}
#rightlayer {
  float: left;
}
#Layer3 {
  float: bottom;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T14:26:48.643

规则浮动：底部；无效。浮点数有[三个有效值](http://www.w3schools.com/css/pr_class_float.asp)。他们是左，右，没有。如果您希望该 div 结束，那么您应该通过更改 float:bottom; 将其设置为清除前一个 div 的浮动。清除：两者；或清除：左；

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T15:08:57.870

这是我必须阅读的大量代码。让我从两句话开始：

*   首先，编码风格有点老派：
    *   从长远来看，使用非语义 id，比如“leftsomething”并不是最优的
    *   没有正确目标的链接也是非语义的
    *   onclick 属性应替换为 javascript 生成的事件处理程序
*   正如[Dave 已经指出](https://stackoverflow.com/questions/781970/problems-arranging-css-layers-with-heading-and-table/782003#782003)的那样，CSS 'float' 属性不能设置为 'bottom'，你必须使用 'clear' 来代替
*   不要在 HTML 代码中定义样式属性，例如表格边框和单元格宽度

要创建页面布局，您可以参考 htmldog，有一个[不错的教程](http://htmldog.com/guides/cssadvanced/layout/)。将您的图层名称更改为更有意义的名称，例如#article、#price、#status，这样您在重新设计时就不会感到困惑。

您还应该将[Eric Meyer 的 CSS 重置](http://meyerweb.com/eric/tools/css/reset/)放在样式表的顶部，这样您在设置边距、填充和字体时就不会受到您选择的浏览器的偏见。

并且不要忘记在单选按钮旁边放置标签，这样用户会更容易找到目标：单击相关标签就像单击按钮本身一样。这有点棘手，因为您需要 choiches 的唯一 id，而您需要使用相同的名称，因为名称在服务器端使用，而标签标签使用的 id 作为钩子。例如，您可以通过组合给定输入的名称和值来创建唯一名称，例如：

`<p><input name="radiobutton" value="fakeapproved" type="radio" id="radiobutton_fakeapproved"><label for="radiobutton_fakeapproved">Fake (Approved)</label></p>`

`<p><input name="radiobutton" value="fakesuspected" type="radio" id="radiobutton_fakesuspected"><label for="radiobutton_fakesuspected">Fake (Suspected)</label></p>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T14:27:11.997

您有多个[css 验证](http://jigsaw.w3.org/css-validator/validator)问题：

```
15   #Layer2     Value Error : voice-family Parse Error :"\"
18   \"  Parse Error \""; voice-family:inherit;
21       Parse Error :20px; } #Layer2 p
36   p, h1, pre  Value Error : font Arial is not a font-size value : Arial,Helvetica,sans-serif
72   #Layer3     Value Error : float bottom is not a float value : bottom 
```

在您修复它之前，无法判断这是否会导致您的特定问题。我还建议在寻求帮助之前尽可能多地摆脱无关的 css 以将您的问题简化为最简单的形式。否则像我这样的人必须阅读一堆与定位无关的无用字体和语音相关的css。

# filemaker - 在 Filemaker Pro IWP 中，如何强制文本字段禁止回车？

> ID：781971
> 
> 赞同：0
> 
> 时间：2009-04-23T14:20:09.907
> 
> 标签：filemaker

我正在使用 Filemaker Pro 的即时网络发布功能。我在布局中添加了一个简单的文本字段和按钮，设置了选项卡顺序以及当用户按下“Enter”或“Return”键时使字段移动到选项卡顺序中的下一站的选项。这在客户端模式下工作正常，但是当我通过 Web 界面尝试时，我遇到了两个问题。

首先，在 web 模式下，tab 排序被破坏了。更重要的是，我添加的文本字段在 web 模式下接受回车。我搜索了 fmforums.com 和文档，但我找不到在使用 IWP 时禁止回车的方法。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T03:29:25.287

当前版本改进了对 Tab 键顺序的支持，因此您的第一个问题可能仅通过更新即可解决。

不幸的是，回车行为与浏览器的行为相关联，所以你被你所拥有的东西困住了。

（当然，除非你去定制网络编程！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-03T10:21:29.623

如果您验证该字段以不允许存在回车，我相信提交表单会为用户产生错误。验证将是：

不是 PatternCount(MyField; "¶" )

# asp.net - Endeca 的 ASP.NET RADKit

> ID：781973
> 
> 赞同：4
> 
> 时间：2009-04-23T14:20:39.530
> 
> 标签：asp.net, rad, endeca

Endeca 的 ASP.NET RADKit 可以从哪里下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T06:30:05.083

1.  转到[https://edelivery.oracle.com](https://edelivery.oracle.com)并使用您的用户帐户登录
2.  选择“Oracle Endeca”作为产品包
3.  选择“Microsoft Windows ...”作为平台
4.  点击“前往”进行搜索
5.  在结果中，选择“Oracle Endeca Guided Search (6.x) Media Pack for Microsoft Windows x64 (64-bit)”
6.  在这里您可以找到许多组件的下载，包括“Oracle Endeca RAD Toolkit for ASP.NET 2.1.3 for Microsoft Windows x64 (64-bit)”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-16T17:38:13.597

在 2012 年 3 月 15 日之前，客户可以从[EDeN（Endeca 开发者网络）](http://eden.endeca.com)下载。自甲骨文于 2011 年 12 月收购 Endeca 以来，下载页面现在显示为：

> “自 2012 年 3 月 15 日起，无法再通过 EDeN 访问 Endeca 支持技术说明和以前的产品版本。Endeca 支持技术说明已迁移到 My Oracle Support，应该可以在那里访问。”

但是，如果您要实现任何类型的网站，我不建议您使用 RAD 工具包！我已经对其进行了评估，但我还没有找到任何方法来构建具有完全自定义的 HTML 布局的站点。使用普通的演示 API，而不是与 RAD 工具包一起提供的 API，并围绕它编写自己的包装器。

不过，对于内部网络应用程序，RAD 控件可能还不错……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T06:25:50.157

您需要成为客户才能访问他们的资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-06T14:16:45.340

由于我发现很难在 EDeN 站点上找到内容，因此拥有指向[Endeca RAD Toolkit for ASP.NET API Reference的实际链接可能会很有用](http://eden.endeca.com/DocBrowser/rad21/210RADNET-API/Index.html)

# visual-studio-2008 - Visual Studio 2008 sp1 经典 asp Intellisense 和大纲不起作用

> ID：781985
> 
> 赞同：5
> 
> 时间：2009-04-23T14:22:47.310
> 
> 标签：visual-studio-2008, ide, asp-classic, intellisense

正如主题所暗示的那样，我已经安装了带有 sp1 的 VS 2008，并且在编辑经典 asp 页面时没有收到完整的 Intellisense 或任何大纲功能。我的同事也在使用 VS2008sp1 并且大纲工作正常（但他不知道为什么）

我做了一个屏幕，你可以在这里找到[经典的 asp 概述问题屏幕截图 1](http://edeneight.com/_temp/stupidasp.gif)

有没有其他人有这个问题？我错过了一些简单的东西吗？

感谢您的帮助-Birk

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T14:30:25.827

您可以通过转到工具 -> 导入/导出设置 -> 重置所有设置来重置设置。我建议您备份当前设置以防万一。

您也可以从命令行运行`devenv /setup`，它将重置您的 Intellisense 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:27:07.080

在 Visual Studio 中，转到工具 -> 选项 -> 文本编辑器 -> 基本 -> VB 特定

并选中“启用大纲模式”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-28T20:47:20.793

*   工具/选项/文本编辑器/文件扩展名
*   扩展 = asp
*   editor = "Web 表单编辑器"
*   点击“添加”
*   享受

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T14:30:18.027

我在 VS2005 和 VS2008 中都遇到过这个问题——它来来去去没有真正的模式，而且我从来没有找到一个好的解决方案。有时关闭项目并重新启动 VS 会解决一段时间......但并非总是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T16:40:21.723

我发现工作的最佳解决方案是这个。对于以 .asp 扩展名结尾的页面上的经典 asp 代码，您可以通过在 asp 脚本块中放置不同的函数或片段来管理代码的大纲`<% %>`。

然后概述这些部分的预期工作。但是，我仍然想找到比这更好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-04T16:42:00.653

@ Language="VBScript" 似乎对我有用。太糟糕了，我现在必须更新我的所有代码以包含它......

# c# - 如何让这个 ASP.NET MVC SelectList 工作？

> ID：781987
> 
> 赞同：127
> 
> 时间：2009-04-23T14:23:20.477
> 
> 标签：c#, asp.net-mvc, selectlist

我在控制器中创建了一个 selectList，以显示在视图中。

我正在尝试动态创建它，有点像这样......

```
myViewData.PageOptionsDropDown = 
   new SelectList(new [] {"10", "15", "25", "50", "100", "1000"}, "15"); 
```

它可以编译，但输出很糟糕......

```
<select id="PageOptionsDropDown" name="PageOptionsDropDown">
    <option>10</option>
    <option>15</option>
    <option>25</option>
    <option>50</option>
    <option>100</option>
    <option>1000</option>
</select> 
```

**请注意如何没有选择任何项目？**

我怎样才能解决这个问题？？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-04-23T14:33:06.210

我就是这样做的

```
IList<Customer> customers = repository.GetAll<Customer>();
IEnumerable<SelectListItem> selectList = 
    from c in customers
    select new SelectListItem
    {
        Selected = (c.CustomerID == invoice.CustomerID),
        Text = c.Name,
        Value = c.CustomerID.ToString()
    }; 
```

乍一看，我不确定我知道你在追求什么……

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-05-18T13:49:12.880

我使用扩展方法：

*用法*

```
var departmentItems = departments.ToSelectList(d => d.Code + 
                                               " - " + d.Description,
                                               d => d.Id.ToString(),
                                               " - ");

var functionItems = customerFunctions.ToSelectList(f => f.Description, 
                                                   f => f.Id.ToString(), 
                                                   " - "); 
```

*和*

```
public static class MCVExtentions
{
    public static List<SelectListItem> ToSelectList<T>(
        this IEnumerable<T> enumerable, 
        Func<T, string> text, 
        Func<T, string> value, 
        string defaultOption)
    {
        var items = enumerable.Select(f => new SelectListItem()
                                     {
                                         Text = text(f), 
                                         Value = value(f) 
                                     }).ToList();
        items.Insert(0, new SelectListItem()
                    {
                        Text = defaultOption, 
                        Value = "-1" 
                    });
        return items;
    }
} 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-04-23T14:35:34.923

使用接受`items, dataValueField, dataTextField, selectedValue`作为参数的构造函数：

```
ViewData["myList"] = 
                new SelectList(new[] { "10", "15", "25", "50", "100", "1000" }
                .Select(x => new {value = x, text = x}), 
                "value", "text", "15"); 
```

然后在你看来：

```
<%=Html.DropDownList("myList") %> 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-03-04T02:33:09.843

根据 Thomas Stock 的回答，我创建了这些重载`ToSelectList`方法：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web.Mvc;

public static partial class Helpers
{
    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, bool selectAll = false)
    {
        return enumerable.ToSelectList(value, value, selectAll);
    }

    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, object selectedValue)
    {
        return enumerable.ToSelectList(value, value, new List<object>() { selectedValue });
    }

    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, IEnumerable<object> selectedValues)
    {
        return enumerable.ToSelectList(value, value, selectedValues);
    }

    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, Func<T, object> text, bool selectAll = false)
    {
        foreach (var f in enumerable.Where(x => x != null))
        {
            yield return new SelectListItem()
            {
                Value = value(f).ToString(),
                Text = text(f).ToString(),
                Selected = selectAll
            };
        }
    }

    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, Func<T, object> text, object selectedValue)
    {
        return enumerable.ToSelectList(value, text, new List<object>() { selectedValue });
    }

    public static IEnumerable<SelectListItem> ToSelectList<T>(this IEnumerable<T> enumerable, Func<T, object> value, Func<T, object> text, IEnumerable<object> selectedValues)
    {
        var sel = selectedValues != null
            ? selectedValues.Where(x => x != null).ToList().ConvertAll<string>(x => x.ToString())
            : new List<string>();

        foreach (var f in enumerable.Where(x => x != null))
        {
            yield return new SelectListItem()
            {
                Value = value(f).ToString(),
                Text = text(f).ToString(),
                Selected = sel.Contains(value(f).ToString())
            };
        }
    }
} 
```

在您的控制器中，您可以执行以下操作：

```
var pageOptions = new[] { "10", "15", "25", "50", "100", "1000" };
ViewBag.PageOptions = pageOptions.ToSelectList(o => o, "15" /*selectedValue*/); 
```

最后在您的视图中，输入：

```
@Html.DropDownList("PageOptionsDropDown", ViewBag.PageOptions as IEnumerable<SelectListItem>, "(Select one)") 
```

它将产生所需的输出——当然，`"(Select one)"`如果您不想要第一个空项目，您可以省略上面的 optionLabel：

```
<select id="PageOptionsDropDown" name="PageOptionsDropDown">
<option value="">(Select one)</option>
<option value="10">10</option>
<option selected="selected" value="15">15</option>
<option value="25">25</option>
<option value="50">50</option>
<option value="100">100</option>
<option value="1000">1000</option>
</select> 
```

**更新：**可以[在此处找到](https://gist.github.com/JustinStolle/1e897f55fa93eaf1a25f8980f4185eef)带有 XML 注释的修改后的代码清单。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-08-06T18:15:41.907

问题是，SelectList 按设计工作。错误在设计中。您可以在 SelectedItem 中设置 Selected 属性，但是如果您使用 GetEnumerator() 遍历列表（或者如果 Mvc 为您这样做），这将完全被忽略。Mvc 将改为创建新的 SelectListItems。

您必须将 SelectList ctor 与 SelectListItem[]、Text-Name、Value-Name 和 SelectedValue 一起使用。请注意，将要选择的 SelectListItem 的 VALUE 作为 SelectedValue 传递，而不是 SelectListItem 本身！例子：

```
SelectList sl = new SelectList( new[]{
  new SelectListItem{ Text="one", Value="1"},
  new SelectListItem{ Text="two", Value="2"},
  new SelectListItem{ Text="three", Value="3"}
}, "Text", "Value", "2" ); 
```

（没有测试过，但我遇到了同样的问题）

然后第二个选项将获得 selected="selected" 属性。这看起来像很好的旧数据集;-)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-06-24T16:50:18.023

这是一个选项：

```
myViewData.PageOptionsDropDown = new[] 
{
 new SelectListItem { Text = "10", Value = "10" },
 new SelectListItem { Text = "15", Value = "15", Selected = true }
 new SelectListItem { Text = "25", Value = "25" },
 new SelectListItem { Text = "50", Value = "50" },
 new SelectListItem { Text = "100", Value = "100" },
 new SelectListItem { Text = "1000", Value = "1000" },
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-01-15T18:02:30.473

如果这就是您想要做的所有事情，那么只需将数组声明为字符串即可修复所选项目问题：

```
myViewData.PageOptionsDropDown = 
   new SelectList(new string[] {"10", "15", "25", "50", "100", "1000"}, "15"); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-07-28T23:08:30.703

It's very simple to get SelectList and SelectedValue working together, even if your property isn't a simple object like a Int, String or a Double value.

Example:

Assuming our Region object is something like this:

```
public class Region {
     public Guid ID { get; set; }
     public Guid Name { get; set; }
} 
```

And your view model is something like:

```
public class ContactViewModel {
     public DateTime Date { get; set; }
     public Region Region { get; set; }
     public List<Region> Regions { get; set; }
} 
```

You can have the code below:

```
@Html.DropDownListFor(x => x.Region, new SelectList(Model.Regions, "ID", "Name")) 
```

Only if you override the ToString method of Region object to something like:

```
public class Region {
     public Guid ID { get; set; }
     public Guid Name { get; set; }

     public override string ToString()
     {
         return ID.ToString();
     }
} 
```

This have 100% garantee to work.

But I really believe the best way to get SelectList 100% working in all circustances is by using the Equals method to test DropDownList or ListBox property value against each item on items collection.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-07-28T11:23:43.420

如果您有一个强类型视图，您似乎需要更改下拉列表的 ID，以便它不是继承类上的属性名称。然后，您需要在您的编辑 (POST) 方法中添加一些逻辑，以便在提交更改之前从 FORMCollection 中提取所选值并将其放到您的实例中。

这当然有点奇怪，但我尝试过它并且它有效。

因此，如果您的班级有一个名为 CountryId 的字段，并且您正在显示国家/地区名称列表，请使下拉列表的 ID 为 CountryName 而不是 CountryId，然后在帖子中，您可以使用 Collection["CountryName"] .

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-09-05T18:01:45.407

我有同样的问题。解决方案很简单。只需将传递给 DropDownList 助手的“名称”参数更改为与 ViewModel 中存在的任何属性都不匹配的内容。在这里阅读更多：http: [//www.dotnetguy.co.uk/post/2009/06/25/net-mvc-selectlists-selected-value-does-not-get-set-in-the-view](http://www.dotnetguy.co.uk/post/2009/06/25/net-mvc-selectlists-selected-value-does-not-get-set-in-the-view)

我引用丹·沃森的话：

> 在 MVC 中，如果视图是强类型的，则选择列表的 selected 选项将被覆盖，并且在构造函数上设置的 selected 选项属性将永远不会到达视图，而是会选择下拉列表中的第一个选项（为什么仍然有点神秘） .

干杯！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-01-26T19:38:10.697

所有这些答案看起来都很棒，但似乎控制器正在以众所周知的结构化格式为视图准备数据，而不是让视图简单地迭代通过模型传递的 IEnumerable<> 并构建标准选择列表，然后让 DefaultModelBinder通过操作参数将所选项目返回给您。是的，不，为什么不呢？关注点分离，是吗？让控制器构建特定于 UI 和 View 的东西似乎很奇怪。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-08-17T23:44:13.997

简单的：

```
string[] someName = new string[] {"10", "15", "25", "50", "100", "1000"};
myViewData.PageOptionsDropDown = new SelectList(someName, "15"); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-07-21T13:21:42.540

我只是这样运行它，没有任何问题，

```
public class myViewDataObj
    {
        public SelectList PageOptionsDropDown { get; set; }
    }

public ActionResult About()
        {
            myViewDataObj myViewData = new myViewDataObj();
            myViewData.PageOptionsDropDown =
                  new SelectList(new[] { "10", "15", "25", "50", "100", "1000" }, "15");

            ViewData["myList"] = myViewData.PageOptionsDropDown;
            return View();
        } 
```

和

```
<%=Html.DropDownList("myList") %> 
```

如果你这样做，它也有效，

```
public ActionResult About()
        {
            myViewDataObj myViewData = new myViewDataObj();
            myViewData.PageOptionsDropDown =
                  new SelectList(new[] { "10", "15", "25", "50", "100", "1000" });

            ViewData["myListValues"] = myViewData.PageOptionsDropDown;
            ViewData["myList"] = "15";
            return View();
        } 
```

和

```
<%=Html.DropDownList("myList",(IEnumerable<SelectListItem>)ViewData["myListValues"]) %> 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-03-16T12:35:10.923

```
MonthRepository monthRepository = new MonthRepository();
IQueryable<MonthEntity> entities = monthRepository.GetAllMonth();
List<MonthEntity> monthEntities = new List<MonthEntity>();

foreach(var r in entities)
{
    monthEntities.Add(r);
}

ViewData["Month"] = new SelectList(monthEntities, "MonthID", "Month", "Mars"); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-26T17:26:24.463

使用您的示例，这对我有用：

**控制器：**

```
ViewData["PageOptionsDropDown"] = new SelectList(new[] { "10", "15", "25", "50", "100", "1000" }, "15"); 
```

**看法：**

```
<%= Html.DropDownList("PageOptionsDropDown")%> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-09-30T07:55:25.153

我这样做：

```
List<SelectListItem> list = new List<SelectListItem>{
new SelectListItem {Selected = true, Text = "Select", Value = "0"},
new SelectListItem {Selected = true, Text = "1", Value = "1"},
new SelectListItem {Selected = true, Text = "2", Value = "2"}
};
return list.ToArray(); 
```

ToArray() 负责处理这些问题。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-01-04T17:50:58.837

如果您想将一些随机文本传递给您的 DropDownList，例如**--Select--**您可以使用以下代码轻松完成此操作：

```
@Html.DropDownListFor(x => x.CategoryId, new SelectList(Model.Categories, "Id", "Name"), "--Select--", new { @class = "form-control" }) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-04-14T04:43:51.237

我不记得 mvc 1 是如何设置的，但似乎它希望选择列表的名称与其所属的字段相同......

正如上面所说的那样，我发现我的选择列表在 mvc2 中不起作用，因为它们被发送的 ViewData 被命名为与字段相同。

例如：

`<%= Html.DropDownListFor((model => model.ForID), (SelectList)ViewData["ForName"]) %>`

什么时候工作

`<%= Html.DropDownListFor((model => model.ForID), (SelectList)ViewData["ForID"]) %>`

不起作用，因为 ViewData 名称“ForID”的名称与其工作的字段相同

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-04-23T14:42:05.953

您的 ViewData 中可能存在一些歧义：

看看[这里](https://stackoverflow.com/questions/222531/ienumerablestring-to-selectlist-no-value-is-selected/566492#566492)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-03-28T16:33:43.037

模型中选择的值会利用而不是默认项。（我同意我没有阅读所有帖子）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-01-03T15:39:17.957

如果您在 Html.DropDownList 扩展方法中查看 MVC 2 的源代码，它从不检查 SelectList 类的 SelectedValue 属性。它只会尝试与您的模型匹配。

以上所有内容都是主题的变体，即如何将一堆数据发送到视图以获取下拉列表，并且它们彼此都一样好（或多或少）。

问题出在视图中。要么创建你自己的 DropDownList 扩展方法，它尊重你设置的选择值，要么手动迭代。哪个最适合您。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-09-30T17:17:16.147

如果你的模型中有一个集合并且你的视图是强类型的，那么它的一些变体将起作用：

```
@Html.DropDownListFor(x => x.RegionID, 
    new SelectList(Model.Regions,"RegionID", "RegionName", Model.RegionID)) 
```

-或者-

```
@Html.DropDownList("RegionID", 
    new SelectList(Model.Regions, "RegionID", "RegionName", Model.RegionID)) 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-12-13T03:58:00.413

一个可能的解释是您绑定到的选择列表值不是字符串。

那么在该示例中，参数“PageOptionsDropDown”是模型中的字符串吗？因为如果不是，则不会显示列表中的选定值。

# xslt - XSLT：合并节点，然后排序

> ID：781989
> 
> 赞同：1
> 
> 时间：2009-04-23T14:23:35.280
> 
> 标签：xslt

我有一个这样的 XML：

```
<node id="1">
    <data alias="Show">ShowName1</data>
    <data alias="Dates">21/04/2009,23/04/2009,27/04/2009,</data>
</node>

<node id="2">
    <data alias="Show">ShowName2</data>
    <data alias="Dates">22/04/2009,25/04/2009,29/04/2009,</data>
</node> 
```

它有 X 个节点，每个节点都有一个节目名称和一串逗号分隔的节目日期。我可以标记演出日期，但我想制作一个排序列表，其中包含所有演出的所有演出日期，按日期排序。像这样：

```
<shows>
    <show>
        <name>ShowName1</name>
        <date>21/04/2009</date>
    </show>
    <show>
        <name>ShowName2</name>
        <date>22/04/2009</date>
    </show>
    <show>
        <name>ShowName1</name>
        <date>23/04/2009</date>
    </show>
    <show>
        <name>ShowName2</name>
        <date>25/04/2009</date>
    </show>
    <show>
        <name>ShowName1</name>
        <date>27/04/2009</date>
    </show>
    <show>
        <name>ShowName2</name>
        <date>29/04/2009</date>
    </show>
</shows> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T15:21:17.813

要做到这一点，只使用**一个**转换过程将需要将新创建的显示元素视为一个**节点集**，以便模板可以使用内部**xsl:sort**机制。[XSL 转换 (XSLT) 版本 1.0 规范](http://www.w3.org/TR/xslt)没有将自行创建的元素转换为节点集的方法。但是，[MSXML 解析器](http://msdn.microsoft.com/en-us/library/hz88kef0(VS.71).aspx)（3.0 或更高版本）确实具有提供该功能的扩展。此外，还有一个[exslt 扩展](http://www.exslt.org/exsl/functions/node-set/index.html)，我认为一些较新版本的 Firefox 支持将允许将变量动态交换到节点集。但无论如何，这是一个使用 MSXML 解析器正常工作的样式表。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
                xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
  <xsl:output method="xml"/>

  <xsl:template match="/">
    <xsl:variable name="shows">
      <xsl:apply-templates select="//data[@alias='Dates']"/>
    </xsl:variable>
    <shows>
      <xsl:apply-templates select="msxsl:node-set($shows)//show">
        <xsl:sort select="substring(date, 7, 4)"/><!-- year -->
        <xsl:sort select="substring(date, 4, 2)"/><!-- month -->
        <xsl:sort select="substring(date, 1, 2)"/><!-- day -->
      </xsl:apply-templates>
    </shows>
  </xsl:template>

  <xsl:template match="show">
    <xsl:copy-of select="."/>
  </xsl:template>

  <xsl:template match="data[@alias='Dates']">
    <xsl:call-template name="eachDate">
      <xsl:with-param name="node" select=".."/>
      <xsl:with-param name="dates" select="."/>
    </xsl:call-template>
  </xsl:template>

  <xsl:template name="eachDate">
    <xsl:param name="node" select="."/>
    <xsl:param name="dates" select="''"/>
    <xsl:if test="string-length($dates)">
      <show>
        <name><xsl:value-of select="$node/data[@alias='Show']/text()"/></name>
        <date><xsl:value-of select="substring-before($dates, ',')"/></date>
      </show>
      <xsl:call-template name="eachDate">
        <xsl:with-param name="node" select="$node"/>
        <xsl:with-param name="dates" select="substring-after($dates, ',')"/>
      </xsl:call-template>
    </xsl:if>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T16:18:13.027

由于输入 XML 的形状相当糟糕，我们必须跳过一些障碍才能得到您想要的。

正如 Lucky 先生在他的回答中已经概述的那样，我们必须首先将文档转换为更有用的临时形式。然后，更有用的临时形式将通过扩展函数转回节点集，并再次处理以产生所需的结果。

在我的回答中，我将使用修改后的身份转换来实现以下临时形式：

```
<root>
  <node id="1">
    <data alias="Show">ShowName1</data>
    <data alias="Dates">
      <date sort="20090421">21/04/2009</date>
      <date sort="20090423">23/04/2009</date>
      <date sort="20090427">27/04/2009</date>
    </data>
  </node>
  <node id="2">
    <data alias="Show">ShowName2</data>
    <data alias="Dates">
      <date sort="20090422">22/04/2009</date>
      <date sort="20090425">25/04/2009</date>
      <date sort="20090429">29/04/2009</date>
    </data>
  </node>
</root> 
```

有了这个输入，排序就很简单了，使用元素的`@sort`属性。`<date>`

```
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:msxsl="urn:schemas-microsoft-com:xslt"
  exclude-result-prefixes="msxsl "
>
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />

  <xsl:template match="/">
    <!-- prepare our temporary form (a "result tree fragment") -->
    <xsl:variable name="rtf">
      <xsl:apply-templates mode="rtf" />
    </xsl:variable>

    <!-- transform the result tree fragment back to a node-set -->
    <xsl:variable name="doc" select="msxsl:node-set($rtf)" />

    <!-- transform the temporary node-set, sorted by date -->
    <shows>
      <xsl:apply-templates select="$doc//date">
        <xsl:sort select="@sort" />
      </xsl:apply-templates>
    </shows>
  </xsl:template>

  <xsl:template match="date">
    <show show_id="{ancestor::node/@id}">
      <name><xsl:value-of select="../../data[@alias='Show'][1]/text()" /></name>
      <date><xsl:value-of select="." /></date>
    </show>
  </xsl:template>

  <!-- all following templates are for producing the temporary form only -->

  <xsl:template match="@*|node()" mode="rtf">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" mode="rtf" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="data[@alias='Dates']" mode="rtf">
    <xsl:copy>
      <!-- copy all attributes -->
      <xsl:apply-templates select="@*" mode="rtf" />
      <!-- this produces the <date> elements -->
      <xsl:call-template name="tokenize-datelist" />
    </xsl:copy>
  </xsl:template>

  <xsl:template name="tokenize-datelist">
    <xsl:param name="input" select="." />
    <xsl:param name="delim" select="','" />

    <xsl:variable name="temp" select="concat($input, $delim)" />
    <xsl:variable name="head" select="substring-before($temp, $delim)" />
    <xsl:variable name="tail" select="substring-after($input, $delim)" />

    <xsl:if test="$head != ''">
      <date>
        <!-- this produces the @sort attribute -->
        <xsl:call-template name="tokenize-date">
          <xsl:with-param name="input" select="$head" />
        </xsl:call-template>
        <xsl:value-of select="$head" />
      </date>
      <xsl:if test="$tail != ''" >
        <xsl:call-template name="tokenize-datelist">
          <xsl:with-param name="input" select="$tail" />
          <xsl:with-param name="delim" select="$delim" />
        </xsl:call-template>
      </xsl:if>
    </xsl:if>
  </xsl:template>

  <xsl:template name="tokenize-date">
    <xsl:param name="input" select="''" />
    <xsl:param name="delim" select="'/'" />

    <xsl:variable name="dd" select="substring-before($input, $delim)" />
    <xsl:variable name="my" select="substring-after($input, $delim)" />
    <xsl:variable name="mm" select="substring-before($my, $delim)" />
    <xsl:variable name="yy" select="substring-after($my, $delim)" />

    <xsl:attribute name="sort">
      <xsl:value-of select="concat($yy, $mm, $dd)" />
    </xsl:attribute>
  </xsl:template>

</xsl:stylesheet> 
```

当它通过 msxsl.exe（一个 XSLT 1.0 处理器）运行时，会产生以下输出：

```
<shows>
  <show show_id="1">
    <name>ShowName1</name>
    <date>21/04/2009</date>
  </show>
  <show show_id="2">
    <name>ShowName2</name>
    <date>22/04/2009</date>
  </show>
  <show show_id="1">
    <name>ShowName1</name>
    <date>23/04/2009</date>
  </show>
  <show show_id="2">
    <name>ShowName2</name>
    <date>25/04/2009</date>
  </show>
  <show show_id="1">
    <name>ShowName1</name>
    <date>27/04/2009</date>
  </show>
  <show show_id="2">
    <name>ShowName2</name>
    <date>29/04/2009</date>
  </show>
</shows> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T17:08:53.047

**I. 使用 FXSL 1.x 的 XSLT 1.0 解决方案**

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
 exclude-result-prefixes="ext"
>
   <xsl:import href="strSplit-to-Words.xsl"/>

   <xsl:output indent="yes" omit-xml-declaration="yes"/>

    <xsl:template match="/*">
      <xsl:variable name="vDates">
        <xsl:for-each select="node">
            <nodeData name="{data[@alias = 'Show']}">
                 <xsl:call-template name="str-split-to-words">
                  <xsl:with-param name="pStr" select="data[@alias = 'Dates']"/>
                  <xsl:with-param name="pDelimiters"
                                  select="','"/>
                </xsl:call-template>
            </nodeData>
        </xsl:for-each>
        </xsl:variable>

      <xsl:apply-templates select="ext:node-set($vDates)/*/*[text()]">
        <xsl:sort data-type="number" select="substring(.,7)"/>
        <xsl:sort data-type="number" select="substring(.,4,2)"/>
        <xsl:sort data-type="number" select="substring(.,1,2)"/>
      </xsl:apply-templates>
    </xsl:template>

    <xsl:template match="word">
      <show>
        <name>
          <xsl:value-of select="../@name"/>
        </name>
          <date>
            <xsl:value-of select="."/>
          </date>
      </show>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的“XML 文档”时，更正为格式正确**（人们，你们什么时候学会提供格式正确的 XML 文档？有那么*难*吗？）：

```
<t>
    <node id="1">
        <data alias="Show">ShowName1</data>
        <data alias="Dates">21/04/2009,23/04/2009,27/04/2009,</data>
    </node>
    <node id="2">
        <data alias="Show">ShowName2</data>
        <data alias="Dates">22/04/2009,25/04/2009,29/04/2009,</data>
    </node>
</t> 
```

**产生想要的结果**：

```
<show>
   <name>ShowName1</name>
   <date>21/04/2009</date>
</show>
<show>
   <name>ShowName2</name>
   <date>22/04/2009</date>
</show>
<show>
   <name>ShowName1</name>
   <date>23/04/2009</date>
</show>
<show>
   <name>ShowName2</name>
   <date>25/04/2009</date>
</show>
<show>
   <name>ShowName1</name>
   <date>27/04/2009</date>
</show>
<show>
   <name>ShowName2</name>
   <date>29/04/2009</date>
</show> 
```

**二、一种可能的 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    exclude-result-prefixes="xs">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/*">

     <xsl:variable name="vAllData" as="xs:string+">
          <xsl:for-each select="node">
            <xsl:variable name="vName" select="data[@alias='Show']"/>

              <xsl:for-each select=
                "tokenize(data[@alias='Dates'], ',')[.]">

                <xsl:value-of select="concat($vName, '+',.)"/>
            </xsl:for-each>
          </xsl:for-each>
     </xsl:variable>

         <xsl:for-each select="$vAllData">
           <xsl:sort data-type="number" select=
            "substring(substring-after(.,'+'),7)"/>
           <xsl:sort data-type="number" select=
            "substring(substring-after(.,'+'),4,2)"/>
           <xsl:sort data-type="number" select=
            "substring(substring-after(.,'+'),1,2)"/>

           <show>
             <name>
               <xsl:value-of select="substring-before(.,'+')"/>
             </name>
             <date>
               <xsl:value-of select="substring-after(.,'+')"/>
             </date>
           </show>
       </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**当对同一个文档应用上述 XSLT 2.0 转换时，会产生相同的正确结果**。

# tfs - TFS：频繁合并到开发分支中

> ID：781991
> 
> 赞同：2
> 
> 时间：2009-04-23T14:24:08.507
> 
> 标签：tfs, merge, branch

我还没有找到对这个问题的任何好的解释，所以我希望有人能解释一下。我的想法是这“就是这样”，但无论如何我想更好地理解。

这是我的情况：我有一个主分支和一个开发分支（dev）。大多数开发人员都在 Main 中工作，但对于我的特定项目，我在 Dev 中工作。我想让 Dev 中的代码与 Main 保持同步，所以我经常合并到 Dev。

我第一次合并 Main->Dev 时，它会复制文件 F1，该文件在 Main 中更改但在 Dev 中未更改。这很棒。下次我合并 Main->Dev 时，F1 又在 Main 中改变了，所以它应该复制它（在 Dev 中没有改变）。

但是，TFS 告诉我目标和源都有变化，即使目标的变化与 Main 的变化*完全相同。*当很多文件发生这种情况时，仅通过这些文件并自动合并是非常麻烦的。

有谁知道为什么 TFS 在这种情况下不能做得更好。有谁知道如何在我的情况下使合并更容易？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T14:50:08.070

这绝对是“不是这样的”。我从来没有见过像你描述的那样发生这种情况。似乎您的环境或工作方式一定有问题。

这不能回答你的问题，但我会质疑为什么“大多数”开发人员都在 Main 工作。Main 应该是为了稳定，因此很少有人会直接在其中工作；只有那些做中断/修复的人。新的编码总是在 Dev 中完成并合并到 Main。

也许您可以布局您的项目结构，这可能会提供更多提示问题可能是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T12:48:35.560

经过一些测试和更多合并后，我得出结论，这“不是这样的”。我无法可靠地重现我最初观察到的行为。在随后的合并中，我没有遇到同样的困难，但仍然有一些我无法完全解释的奇怪行为（不知道为什么在某些文件中没有冲突时我必须手动解决冲突）。

所以我不能说 TFS 合并在任何方面都有缺陷，但它有一些奇怪的地方。

谢谢。