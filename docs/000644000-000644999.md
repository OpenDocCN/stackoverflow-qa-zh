# StackOverflow 问答 000644000-000644999

# c# - Visual Studio 警告级别的含义？

> ID：644011
> 
> 赞同：99
> 
> 时间：2009-03-13T18:27:57.443
> 
> 标签：c#, visual-studio, warnings, compiler-warnings

在 Web 应用程序项目的构建选项卡上，我有一个名为“警告级别”的设置。我可以设置一个从 0 到 4 的值。这些值是什么意思？值 0 是否会更严格并产生更多警告，反之亦然？我还没有找到任何关于它的文档，但也许我找错了地方。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-03-13T18:30:22.773

[此链接](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/warn-compiler-option)向您显示警告级别的定义（我假设您在 Web 项目中使用 C# 代码）。4级是最严格的。

* * *

*   0：关闭所有警告信息的发射。
*   1：显示严重警告信息。
*   2：显示 1 级警告以及某些不太严重的警告，例如关于隐藏班级成员的警告。
*   3：显示 2 级警告以及某些不太严重的警告，例如有关始终评估为**true**或**false**的表达式的警告。
*   4：显示所有 3 级警告和信息性警告。这是命令行的默认警告级别。
*   5：显示 4 级警告以及来自 C# 9.0 附带的编译器的其他警告。

任何大于 5 的都被视为 5。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-13T18:31:01.150

越高越严格。看到所有对您的应用程序可能意义重大或意义不大的警告可能会很烦人，但花时间清除它们可以教给您很多东西。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-13T18:30:50.353

0 完全关闭警告，而 4 是最详细的级别。请参阅此处具有相同警告级别的[文档。](http://msdn.microsoft.com/en-us/library/13b90fz7(VS.71).aspx)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-13T18:31:28.513

您可以[在此处查看 Microsoft 的级别](http://msdn.microsoft.com/en-us/library/13b90fz7.aspx)。0 级基本上没有，而 4 级将是最严格的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-14T03:14:38.183

此外，F# 达到警告级别 5：

> --warn:警告级别
> 
> 设置警告级别（0 到 5）。默认级别为 3。每个警告都根据其严重性赋予一个级别。5 级给出的警告比 1 级多，但不那么严重。
> 
> 5 级警告是：21（在运行时检查递归使用）、22（让 rec 评估乱序）、45（完全抽象）和 52（防御性副本）

[https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/compiler-options](https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/compiler-options)

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-03-13T18:31:08.437

例如将警告级别设置为 4 或`/W4`意味着编译器会将所有警告视为错误。这主要是编译器在看到它感觉不好的东西时的反应。而且，顺便说一句，所有警告的级别为0。

# javascript - JavaScript for PDF: What is the token beteween words used by getPageNthWord()?

> ID：644013
> 
> 赞同：3
> 
> 时间：2009-03-13T18:28:23.777
> 
> 标签：javascript, pdf

In JavaScript for PDF there is a method used to get the Nth word on a page.

So, what is the token used by getPageNthWord() that separate words?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T18:52:09.413

空格、标点符号、换行符和常见的东西。

# .net - .NET Format a string with fixed spaces

> ID：644017
> 
> 赞同：225
> 
> 时间：2009-03-13T18:29:13.837
> 
> 标签：.net, string

Does the .NET String.Format method allow placement of a string at a fixed position within a fixed length string.

```
"           String Goes Here"
"     String Goes Here      "
"String Goes Here           "

```

How is this done using .NET?

**Edit** - I have tried Format/PadLeft/PadRight to death. They do not work. I don't know why. I ended up writing my own function to do this.

**Edit** - I made a mistake and used a colon instead of a comma in the format specifier. Should be "{0,20}".

Thanks for all of the excellent and correct answers.

* * *

## 回答 #1

> 赞同：522
> 
> 时间：2009-03-13T19:09:51.477

这将为您提供您要求的字符串：

```
string s = "String goes here";
string lineAlignedRight  = String.Format("{0,27}", s);
string lineAlignedCenter = String.Format("{0,-27}",
    String.Format("{0," + ((27 + s.Length) / 2).ToString() +  "}", s));
string lineAlignedLeft   = String.Format("{0,-27}", s); 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2016-11-30T12:52:10.850

从 Visual Studio 2015 开始，您还可以使用[Interpolated Strings](https://msdn.microsoft.com/en-us/library/dn961160(v=vs.140).aspx)执行此操作（它是一种编译器技巧，因此您所针对的 .net 框架的版本并不重要）。

```
string value = "String goes here";
string txt1 = $"{value,20}";
string txt2 = $"{value,-20}"; 
```

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2009-03-13T18:30:55.487

至少，第一个和最后一个可以使用以下语法：

```
String.Format("{0,20}", "String goes here");
String.Format("{0,-20}", "String goes here"); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-13T18:55:24.507

你已经被显示`PadLeft`和`PadRight`。这将填补缺失的`PadCenter`.

```
public static class StringUtils
{
    public static string PadCenter(this string s, int width, char c)
    {
        if (s == null || width <= s.Length) return s;

        int padding = width - s.Length;
        return s.PadLeft(s.Length + padding / 2, c).PadRight(width, c);
    }
} 
```

自我提醒：不要忘记更新自己的简历：“有一天，我什至修复了 Joel Coehoorn 的代码！” ;-D -塞尔吉

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-13T18:38:08.760

尝试这个：

```
"String goes here".PadLeft(20,' ');
"String goes here".PadRight(20,' '); 
```

对于中心，获取字符串的长度并使用必要的字符执行 padleft 和 padright

```
int len = "String goes here".Length;
int whites = len /2;
"String goes here".PadRight(len + whites,' ').PadLeft(len + whites,' '); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-09-19T22:45:13.243

感谢您的讨论，此方法也适用（VB）：

```
Public Function StringCentering(ByVal s As String, ByVal desiredLength As Integer) As String
    If s.Length >= desiredLength Then Return s
    Dim firstpad As Integer = (s.Length + desiredLength) / 2
    Return s.PadLeft(firstpad).PadRight(desiredLength)
End Function 
```

1.  **StringCentering()**接受两个输入值并返回一个格式化的字符串。
2.  当**s 的**长度大于或等于**deisredLength**时，函数返回原始字符串。
3.  当**s 的**长度小于**desiredLength**时，两端将被填充。
4.  由于字符间距是整数并且没有半空格，我们可以有不均匀的空格分割。在这个实现中，更大的分裂进入前端。
5.  由于PadLeft( **)**和**PadRight()** ，该函数需要 .NET Framework 。
6.  在函数的最后一行，绑定是从左到右的，所以先应用**firstpad ，然后是所需****长度**pad。

这是 C# 版本：

```
public string StringCentering(string s, int desiredLength)
{
    if (s.Length >= desiredLength) return s;
    int firstpad = (s.Length + desiredLength) / 2;
    return s.PadLeft(firstpad).PadRight(desiredLength);
} 
```

为了帮助理解，使用了整数变量**firstpad**。**s.PadLeft(firstpad)**应用（正确数量的）前导空格。最右边的**PadRight(desiredLength)**通过应用尾随空格来完成较低的绑定。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-24T16:40:39.723

这是我创建的 VB.NET 版本，灵感来自 Joel Coehoorn 的回答、Oliver 的编辑和 shaunmartin 的评论：

```
 <Extension()>
Public Function PadCenter(ByVal [string] As String, ByVal width As Integer, ByVal c As Char) As String

    If [string] Is Nothing Then [string] = String.Empty
    If (width <= [string].Length) Then Return [string]

    Dim padding = width - [string].Length
    Return [string].PadLeft([string].Length + (padding \ 2), c).PadRight(width, c)

End Function

<Extension()>
Public Function PadCenter(ByVal [string] As String, ByVal width As Integer) As String

    If [string] Is Nothing Then [string] = String.Empty
    If (width <= [string].Length) Then Return [string]

    Dim padding = width - [string].Length
    Return [string].PadLeft([string].Length + (padding \ 2)).PadRight(width)

End Function 
```

这是在公共模块内设置为字符串扩展（在 VB.NET 中进行扩展的方式，与 C# 有点不同）。我的细微变化是它将空字符串视为空字符串，并用宽度值填充空字符串（满足我的特殊需求）。希望这将为需要它的任何人轻松转换为 C#。如果有更好的方法来引用我上面提到的答案、编辑和评论，这激发了我的帖子，请告诉我，我会做的 - 我对发帖比较陌生，我想不通发表评论（可能还没有足够的代表）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-14T15:56:40.007

我发布了一篇可能是您想要的 CodeProject 文章。

请参阅：[用于间接宽度和样式格式的 AC# 方式。](http://www.codeproject.com/Articles/403499/A-Csharp-way-for-indirect-width-and-style-formatti)

基本上，它是一种方法 FormatEx，其作用类似于 String.Format，但它允许居中对齐修饰符。

```
FormatEx("{0,c10}", value); 
```

表示 varArgs[0] 的值在 10 个字符宽的字段中居中，如果需要额外的填充空间，则向右倾斜。

```
FormatEx("{0,c-10}", value); 
```

表示 varArgs[0] 的值在 10 个字符宽的字段中居中，如果需要额外的填充空间，则向左倾斜。

编辑：在内部，它是 Joel 的 PadCenter 与一些解析以重构格式和 varArgs 的组合，用于调用 String.Format 来满足您的需求。

-杰西

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-13T18:45:08.230

看起来你想要这样的东西，它将把你的字符串放在一个固定长度的字符串中：

```
Dim totallength As Integer = 100
Dim leftbuffer as Integer = 5
Dim mystring As String = "string goes here"
Dim Formatted_String as String = mystring.PadLeft(leftbuffer + mystring.Length, "-") + String.Empty.PadRight(totallength - (mystring.Length + leftbuffer), "-") 
```

请注意，如果 mystring.length + leftbuffer 超过总长度，这将出现问题

* * *

## 回答 #10

> 赞同：-9
> 
> 时间：2013-11-26T09:57:34.120

```
/// <summary>
/// Returns a string With count chars Left or Right value
/// </summary>
/// <param name="val"></param>
/// <param name="count"></param>
/// <param name="space"></param>
/// <param name="right"></param>
/// <returns></returns>
 public static string Formating(object val, int count, char space = ' ', bool right = false)
{
    var value = val.ToString();
    for (int i = 0; i < count - value.Length; i++) value = right ? value + space : space + value;
    return value;
} 
```

# c# - 具有常见基类/命名空间问题的 C# 多类库

> ID：644022
> 
> 赞同：1
> 
> 时间：2009-03-13T18:29:46.940
> 
> 标签：c#, namespaces

我是 c# 的新手，我想弄清楚是否可以创建多个派生类库，每个派生类库都代表一个特定的项目。我将调用这两个类库 ClassA 和 ClassB。每个类将共享一个 BaseClass（命名空间 BaseNS）。

然后我创建了引用 ClassA 和 ClassB 的 ac# 应用程序。这会产生错误，因为它们都具有相同的 BaseClass。没问题，我在参考上使用了“别名”。这工作得很好。所以我有：

外部别名 Class1Alias; 外部别名 Class2Alias；...

这是我遇到问题的地方。

我想做一个以 BaseClass 作为参数的函数。
public void SetData(BaseClass bc) { } 不能这样做，因为 BaseClass 由于别名而没有定义。所以它必须是： public void SetData(Class1Alias.BaseNameSpace.BaseClass bc) {}

这行得通，但现在我想做以下事情：......

```
Class1Alias.Class1Space.Class1 c1 = new Class1Alias.Class1Space.Class1();
Class2Alias.Class2Space.Class2 c2 = new Class2Alias.Class2Space.Class2(); 
```

这行得通

```
Class1Alias.BaseNameSpace.BaseClass bc = (Class1Alias.BaseNameSpace.BaseClass)c1;
SetData(bc); 
```

这不

```
Class1Alias.BaseNameSpace.BaseClass bc = (Class1Alias.BaseNameSpace.BaseClass)c2;
SetData(bc); 
```

我尝试将它转换为 Class2Alias，它可以工作，但是我无法调用我的 SetData 函数，因为它需要 Class1Alias。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:49:31.947

您的术语有些混乱。你提到“类库”的方式让我觉得你的意思只是“类”，但我不确定。例如，“类库”不能从基类“派生”。

你说你是 C# 的新手。还有其他你更熟悉的语言吗？也许如果你可以用那种语言表达你想做的事情，也许有人可以将它翻译成 C#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:33:37.227

我不确定我是否正确理解了这个问题。基类是存在于单个程序集中还是复制并粘贴在两个程序集中？如果它被复制和粘贴，则您无能为力，因为编译器将它们视为两个不同的类。

在特定引用组件的属性窗口中设置组件引用别名。分配给它以外的东西`global`。然后，您可以使用以下内容引用该程序集中的类型：

```
assemblyAlias::RootNamespace.OtherNamespace.Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:37:42.093

想到的选项：

1.  合并两个类库
2.  将基类（和任何其他共享接口/类）移动到它们都可以引用的第三个通用类库中
3.  更改命名空间以避免基类名称冲突（如果它们确实不是同一个类）

# asp.net-mvc - 会员提供者和型号代码的适当分离

> ID：644041
> 
> 赞同：0
> 
> 时间：2009-03-13T18:31:56.310
> 
> 标签：asp.net-mvc

我有一个用户管理应用程序，其中包括一个成员资格提供程序和一个从 MembershipUser 继承的关联用户模型。事情有效，但我不确定我是否正确地利用了事情。关注点的分离应该在于模型中实现的代码（如加载对象）与来自成员资格提供者的 GetUser 的区别在哪里？

我对架构的想法是，我应该将尽可能多的特定于提供者（在本例中为 LDAP 后端）放在模型中，并将业务规则和诸如此类的东西留在模型中。从理论上讲，这将允许我通过更改提供者来切换到 AD。

不过，这种方法似乎有点支离破碎。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-14T18:13:32.083

您不应该将加载逻辑放入模型中。我建议您查看存储库模式。

[http://martinfowler.com/eaaCatalog/repository.html](http://martinfowler.com/eaaCatalog/repository.html)

这里有一个关于它的视频： [http ://www.asp.net/learn/mvc-videos/video-351.aspx](http://www.asp.net/learn/mvc-videos/video-351.aspx)

# python - EAFP/LBYL 的并发影响

> ID：644052
> 
> 赞同：4
> 
> 时间：2009-03-13T18:33:59.753
> 
> 标签：python, multithreading

在 Python 中编写并发/多线程代码时，遵循“比许可更容易请求宽恕”（EAFP）习语，而不是“在你跳跃之前”（LBYL）是否特别重要？Python 异常动态的特性意味着几乎任何事情（例如，属性删除）都可能在查看和跳跃之间发生——如果是这样，那有什么意义呢？例如，考虑

```
# LBYL
if hasattr(foo, 'bar'):
    baz = foo.bar 
```

相对

```
# EAFP
try:
    baz = foo.bar
except AttributeError:
    pass 
```

在 LBYL 示例中，该`bar`属性可能会`foo`在实际调用之前消失`foo.bar`，所以您从检查中获得了什么？如果存在该属性可能会消失的风险，那么无论如何您都需要锁定和/或 try/except 子句。

这里的一个可能的论点是，这个例子做出了一个极其悲观的假设，即“对抗代码”正在运行，它可能随时从你下面拉扯地毯。在大多数用例中，这是极不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:07:45.083

你的想法是正确的。一些额外的点：

如果属性大部分时间都存在，try:except: 可能比 LBYL 习惯用法快得多。

如果你不喜欢 try: except: 语法，你也可以这样写：

```
item = getattr(foo, 'bar', None)
if item is None:
    ....
else:
    .... 
```

# .net - ASP.NET 应用程序 - 提取、测试、编译和部署

> ID：644056
> 
> 赞同：1
> 
> 时间：2009-03-13T18:34:26.413
> 
> 标签：.net, svn, deployment, tfs, continuous-integration

假设：我对持续集成领域非常陌生。

我应该使用什么方法来提取、测试、编译、部署 ASP.NET (.NET 3.5) 应用程序。

第 1 步）有时我想从 TFS 中提取最新的源代码，有时也想从 Subversion 中提取。

步骤 2) 运行所有测试。（我目前正在使用 MbUnit）

步骤 3) 如果所有测试都通过，则构建发布版本。

第 4 步）通过 FTP 部署代码 - 在特定 URL 处替换当前应用程序

我正在寻找易于学习和设置、低成本或免费/开源的解决方案。

MSBuild 是第 3 步最容易做的事情吗？因为我真的不想做任何特别的事情......只需提供一个解决方案名称并编译它。我主要关心的是找到一些东西来抽象出由需求/步骤#1引起的任何主要问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T18:41:30.127

我们使用 CruiseControl.net，但是您的第一个要求可能有点问题。您能否解释一下您如何选择从哪个存储库中提取源代码。CC.NET 可以使用其中任何一个，或者如果您对 ccnet.config 设置有点聪明，也可以同时使用两者，但这更多取决于您如何知道从哪个中提取。

剩下的很简单，我使用 NAnt 来做真正的工作，而且很容易做到这一点。

编辑：

NAnt 已经有一段时间没有更新了，MSBuild 发布时开发停止了。如果您在 stackoverflow 上进行搜索，您会发现很多“我应该切换到 MSBuild”类型的问题，就个人而言，我们对 NAnt 有相当多的知识，它可以满足我们的需求，并且我们会做一些事情在 MSBuild 中非常难，所以我们会再坚持一段时间。

CruiseControl.NET 有可以直接调用 MSBuild 的任务，我们仍然直接调用 DevEnv，因为我们构建了很多部署项目，这是 MSBuild 很难做的事情。

我们的 NAnt 脚本将带我们从 ClearCase 中提取正确的源代码一直到包装好的产品准备好运输。

但是，NAnt 只是一种选择，如果您对另一种脚本语言（例如 PowerShell）感到满意，那么没有理由不使用它。CruiseControl.NET 可以使用标签将任何可执行文件作为任务调用，并通过使用环境变量传递大量信息。此页面：[http](http://confluence.public.thoughtworks.org/display/CCNET/Executable+Task) ://confluence.public.thoughtworks.org/display/CCNET/Executable+Task详细说明了传递的内容。

就使用相同的步骤而言，两种设置之间的唯一区别是 ccnet.config 文件中的源代码控制块，当我们更改正在使用的视图时，我们的 NAnt 脚本根本不会改变，因为一切都是相对的为我们的视图有一个标准的布局，这意味着我们知道所有的时间都在哪里。

希望对您有所帮助。

艾伦。

# python - 我应该如何根据字典键的存在有条件地分配？

> ID：644062
> 
> 赞同：1
> 
> 时间：2009-03-13T18:35:33.433
> 
> 标签：python

我有一些这样的 Perl 代码：

```
my $match = $matches{$key}
            ? "$matches{$key} was a match!"
            : "There was no match." 
```

如何用 Python 最好地重写它？我试图避免出现 KeyError。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:40:39.643

这。

```
message = "%s was a match"%(matches[key],) if key in matches else "There was no match." 
```

# c# - C#如何禁用一个键

> ID：644071
> 
> 赞同：5
> 
> 时间：2009-03-13T18:39:31.147
> 
> 标签：c#, events, key

当按下“ENTER”键时，如何防止插入符号转到文本框中的下一行？换句话说，如何禁用文本框中的“ENTER”或“RETURN”键？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T18:41:07.460

您可以编写`OnKeyDown`事件。您可以使用`e.SuppressKeyPress`告诉 .NET 您处理密钥。像这样的东西：

```
if (e.KeyCode == Keys.Enter) {
    e.SuppressKeyPress = true;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T18:41:25.447

看看`TextBox.AcceptsReturn`。

# python - Windows [Python] 中的 signal.alarm 替换

> ID：644073
> 
> 赞同：20
> 
> 时间：2009-03-13T18:40:41.377
> 
> 标签：python, alarm

我有一个偶尔挂起的功能。

通常我会设置警报，但我在 Windows 中并且它不可用。

有没有一种简单的方法可以解决这个问题，还是我应该创建一个调用的线程`time.sleep()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:26:04.390

最强大的解决方案是使用子进程，然后终止该子进程。Python2.6 将 .kill() 添加到 subprocess.Popen()。

我不认为您的线程方法按您的预期工作。删除对 Thread 对象的引用不会终止线程。相反，您需要设置线程唤醒后检查的属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-28T08:29:22.127

以下是原始海报如何解决他自己的问题：

结束了一个线程。唯一的技巧是使用`os._exit`而不是`sys.exit`

```
import os
import time
import threading

class Alarm (threading.Thread):
    def __init__ (self, timeout):
        threading.Thread.__init__ (self)
        self.timeout = timeout
        self.setDaemon (True)
    def run (self):
        time.sleep (self.timeout)
        os._exit (1)

alarm = Alarm (4)
alarm.start ()
time.sleep (2)
del alarm
print 'yup'

alarm = Alarm (4)
alarm.start ()
time.sleep (8)
del alarm
print 'nope'  # we don't make it this far 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T19:27:50.467

您可以 - 正如您所提到的 - 只需启动一个休眠该秒数的新线程。

或者，您可以使用 Windows 的多媒体计时器之一（在 Python 中，在 windll.winmm 中）。我相信`timeSetEvent`这就是你要找的。[顺便说一句，我在这里](http://osdir.com/ml/python.ctypes/2007-11/msg00024.html)找到了一段使用它的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-18T02:11:37.173

我意识到这个线程已经有一段时间没有活动了，但是我遇到了类似的问题，希望其他人也能发现这很有用。

正如@jfs 在有用的评论中提到的那样，标准`threading`模块提供了`Timer`一种非常有效的方法（[docs](https://docs.python.org/2/library/threading.html#timer-objects)）。它只是 的一个子类`threading.Thread`，但它使这变得非常简单和干净。也可以使用继承的`cancel`方法取消。

```
import threading
delay_time = 3   # delay time in seconds
def watchdog():
  print('Watchdog expired. Exiting...')
  os._exit(1)

alarm = threading.Timer(delay_time, watchdog)
alarm.start()
my_potentially_never_ending_call()
alarm.cancel() 
```

# php - 什么 PHP/MySQL 书可以作为教科书？

> ID：644077
> 
> 赞同：4
> 
> 时间：2009-03-13T18:41:49.563
> 
> 标签：php, mysql

我可能在秋季教授**本科 PHP/MySQL 课程**，想知道是否有人对好的教科书有任何建议。

这些书必须面向**初学者/中级水平**（我假设/希望我的学生在我之前有 C++ 和 MsSQL 课程）。

**我想在PHP**中涵盖的主题：

 ***   变量/常数
*   条件句
*   循环/循环控制
*   职能
    *   字符串
    *   数组
    *   日期
    *   风俗
*   表格数据
*   会话/Cookie/服务器变量
*   MySQL 集成
    *   查询/错误
    *   准备好的报表
    *   MySQLi 类

在**MySQL 中：**

*   架构/用户/表/列/行
*   主要/外国/约束
*   数据类型
*   查询
    *   选择/更新/插入/删除/截断
    *   限价/排序依据/分组依据

可能处理：

*   存储过程/触发器
*   图像处理/自定义类

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-14T01:39:55.457

Welling & Thomson 的*PHP 和 MySQL Web 开发*是黄金标准：

[http://www.amazon.com/PHP-MySQL-Development-Developers-Library/dp/0672329166/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1236994701&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0672329166)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T18:53:57.630

我不认识任何人从一本书中学习 PHP，只是在线教程或 PHP 手册。我会说在亚马逊上找到一本涵盖了你在课程中想要的主题的书。

也许像这样。[http://www.amazon.com/Beginning-PHP-MySQL-Novice-Professional/dp/1590598628/ref=pd_bbs_3?ie=UTF8&s=books&qid=1236970221&sr=8-3](https://rads.stackoverflow.com/amzn/click/com/1590598628)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T18:55:49.703

[编程 PHP](http://oreilly.com/catalog/9780596006815/)涵盖了所有的 PHP 主题，然后是除了 MySQL 集成之外的一些主题。它有一个关于数据库的章节，但它相当基础。我会用另一本 MySQL 特定的书来补充这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T19:19:43.530

我建议来自 Wrox 的东西（即开始 PHP5）。他们的作者使用了非常通俗易懂的语言，示例也非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-14T00:32:39.220

我将 PHP 和 MySQL 用于动态网站，来自 Larry Ullman 和 Peachpit。不是最先进的书，但对两者都有很好的介绍。这本书有过多次修订，几年前我使用的是第二版。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-08T20:24:17.860

我正在学习使用 Head First 的 PHP 和 MySQL，并且发现它听起来很实用。

# python - 帮助在 Django ORM 中进行复杂的连接

> ID：644081
> 
> 赞同：3
> 
> 时间：2009-03-13T18:44:08.653
> 
> 标签：python, django, django-models

```
class Domains(models.Model):
    name = models.CharField(max_length=30)
    description = models.CharField(max_length= 60)
    user = models.ManyToManyField("Users", blank=True, null=True)
    def __unicode__(self):
        return self.name

class Groups(models.Model):
    domain = models.ForeignKey(Domains)
    name = models.CharField(max_length=30)
    description = models.CharField(max_length= 60)
    def __unicode__(self):
        return self.name

class Users(models.Model):
    login = models.CharField(max_length=30, unique=True)
    group = models.ManyToManyField(Groups, blank=True, null=True)
    def __unicode__(self):
        return self.login 
```

我有上面的模型。在使用 Django ORM 时需要一些帮助。我将如何构建查询以返回仅属于用户所属的那些域的所有组名称

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:32:04.887

我赞同 elo80ka 关于为模型使用单数名称的评论。要按域和用户过滤组，请尝试：

```
Groups.objects.filter(domain__user=u) 
```

这将在多对多中执行适当的连接。如所写，查询将返回组对象。如果您只需要 name 属性，`.values_list('name', flat=True)`请按照 elo80ka 的建议将 附加到查询中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T19:26:45.477

您可能应该为模型类使用单数名称。例如，我将模型重写为：

```
class Domain(models.Model):
    name = models.CharField(max_length=30)
    description = models.CharField(max_length= 60)
    user = models.ManyToManyField('User', blank=True, null=True)

    def __unicode__(self):
            return self.name

class Group(models.Model):
    domain = models.ForeignKey(Domain, related_name='groups')
    name = models.CharField(max_length=30)
    description = models.CharField(max_length= 60)

    def __unicode__(self):
            return self.name

class User(models.Model):
    login = models.CharField(max_length=30, unique=True)
    group = models.ManyToManyField(Group, related_name='users', blank=True, null=True)

    def __unicode__(self):
            return self.login 
```

由于您的用户与组直接相关，因此您根本不需要涉及域。要获取特定用户的所有组名，您可以：

```
Group.objects.filter(users__pk=...).values_list('name', flat=True) 
```

将“...”替换为您感兴趣的用户的 ID。

# asp.net-mvc - 模型绑定类型转换验证

> ID：644083
> 
> 赞同：1
> 
> 时间：2009-03-13T18:44:44.737
> 
> 标签：asp.net-mvc, validation

目前，我看到 DefaultModelBinder 何时出现错误，因为输入对于类型无效（int 中的字符、无效日期等）。我收到 UI 默认错误摘要“出现问题……”但没有具体的错误消息，关于转换失败的特定属性。

例如，模型属性可能是未来需要发生的日期时间。它可能使用 Validator 属性进行修饰，该属性会给出错误“{Property} 是一个需要在未来发生的日期。示例 2009 年 4 月 15 日”。该消息仍可能与类型转换错误相关。

当模型绑定期间类型转换失败时，如何给出描述性错误消息？自定义模型绑定器、过滤器、任何示例将不胜感激。

旁注：我一直在测试 NHib Val、Castle Val、xVal Lib 和其他更多手动方法的实现，所有这些对我来说都很好，但我不认为这些可以帮助我解决类型转换问题…

更新：我在 MVC Codeplex 问题列表中发现了这个涉及 S. Sanderson（xVal 的创建者）的交流。它更详细地讨论了我看到的问题... [http://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=3230](http://aspnet.codeplex.com/WorkItem/View.aspx?WorkItemId=3230)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T19:58:10.020

我个人喜欢在具有属性和 c# 代码的实体中进行验证，所以我认为以下方法至少值得一看：

[http://codebetter.com/blogs/david.hayden/archive/2009/01/31/asp-net-mvc-and-validation-using-idataerrorinfo-and-validation-application-block.aspx](http://codebetter.com/blogs/david.hayden/archive/2009/01/31/asp-net-mvc-and-validation-using-idataerrorinfo-and-validation-application-block.aspx)

它使实体实现[IDataErrorInfo](http://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo.aspx)。除了检查每个属性的验证属性之外，您还可以检查空值或无效转换或任何其他自定义逻辑，如下所示：

当它这样做时：

```
public string this[string columnName]
    {
        get 
        {
            return DoValidation(columnName);
        }
    } 
```

您可以执行以下操作：

```
public string this[string columnName]
    {
        get 
        {
            if(columnName=="myDatePropertyName")
            {
               //Add custom logic (invalid casts or whatever)
            }
            return DoValidation(columnName);
        }
    } 
```

例如，我不喜欢这个模型必须将验证错误消息放在每个属性中，但这是一个很好的开始。

无论如何，这是一个将您的自定义错误绑定到相关属性的模型示例，因此稍后将显示在您的 ValidationSummary 中。

希望这有帮助！

# asp.net - 超时调用 web 服务但数据传输仍然完成

> ID：644084
> 
> 赞同：2
> 
> 时间：2009-03-13T18:44:48.637
> 
> 标签：asp.net, web-services, timeout

尽管在我的 web.config 文件中设置了非常高的值，但我正在从网页调用我的 web 服务并获得超时。当文件通常非常大但***文件仍在完全上传***时（好像没有发生超时），这种情况会间歇性地发生。这是我的 .aspx 文件中的一个函数，它调用我的 ASMX 代理类：

```
 private void UploadFile(HttpPostedFile postedFile, string fileNameOnly)
{
    // create an instance of the proxy class to talk to our service; calling it client:
    string strURI = string.Empty;
    WSproxyProject.ASMXProxy.FileService client = new WSproxyProject.ASMXProxy.FileService();
    try
    {
        BinaryReader b = new BinaryReader(postedFile.InputStream);
        byte[] binData = b.ReadBytes(numBytes);
        strURI = client.UploadFile(binData, fileNameOnly, binData.Length);
        txtURI.Text = strURI;
        LogText("SUCCESS: " + fileNameOnly + " has been uploaded. URI=" + strURI);
    }
    catch (Exception ex)
    {
    LogText("UPLOAD ERROR: " + ex.Message.ToString());

    }
} 
```

请注意，我在 localhost 上的 Web 服务调用了另一个实际存储最终数据的 Web 服务。我在以下所有位置的 web.config 中都有以下 executionTimeout 设置：

1.  我的 Web 客户端项目上的 web.config（myWebService 的调用者）
2.  myWebService 上的 web.config（vendorWebService 的调用者）
3.  vendorWebService 上的 web.config（驻留在我 LAN 中的另一台服务器上）

上面的代码块捕获的异常显示 ex.Source 为 System.Web.Services 和 ex.Message 为：

操作已超时

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T16:37:25.143

如果在方法中设置 Web 服务超时长度会发生什么？

```
...
WSproxyProject.ASMXProxy.FileService client = new WSproxyProject.ASMXProxy.FileService();
    client.Timeout = 9999999;
    try
    ... 
```

也许您还需要为 FileService 使用的其他 Web 服务设置类似的超时属性。

我必须为使用动力不足的开发数据库的 Web 服务调用执行此操作。我宁愿让 Web 服务准备好执行比需要更长的时间，也不愿抛出异常。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T01:34:55.203

一些头脑风暴：

*   您是否考虑过哪个 Web 服务或客户端超时？堆栈跟踪显示什么？
*   每个人都会在稍微不同的时间开始这个过程。他们有相同的超时吗？
*   文件是否完整？它可能是正确的大小，但已损坏。
*   我知道这听起来很傻，但是否有一个永无止境的循环或循环持续的时间比你想象的要长？

希望里面有帮助。

# c# - .Net UserControl - 对接 2 个控件

> ID：644089
> 
> 赞同：0
> 
> 时间：2009-03-13T18:47:26.260
> 
> 标签：c#, .net, user-controls, docking

假设我在 usercontrol 中有 2 个控件：

一个（controlA）具有固定高度，需要停靠在底部，另一个（controlB）在顶部，必须填充剩余空间。

如果我为 controlA 使用底部底座并为 controlB 填充底座，则它不起作用，因为 controlA 超过了 controlB ...

我怎样才能正确地做到这一点，我对对接的东西很陌生......

我使用.Net 3.5 c#

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:50:07.813

这取决于您添加控件的顺序。无论您当前添加它们的顺序，反转它:) 右键单击​​被遮盖的控件并在设计器中选择“置于前面”。

[本文](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6165908.html)更详细地介绍了这个问题。

# sql - 一次在多个数据库上运行相同 .sql 脚本的简单方法？

> ID：644098
> 
> 赞同：5
> 
> 时间：2009-03-13T18:50:54.143
> 
> 标签：sql

有没有一种简单的方法，比如 Microsoft SQL Server Management Studio 在数据库列表上运行保存的 .sql 脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T23:55:48.467

Yout 没有指定哪个版本，但在 SQL 2008 Management Studio 中也支持此功能，方法是右键单击“已注册服务器”窗口中的服务器组并选择“新建查询”。这也适用于 SQL 的先前版本和混合组（例如 SQL 2000、2005 和 2008 一次）。

Red-Gate 还有一个您可以购买的工具，称为 SQL Multi Script：[http](http://www.red-gate.com/products/SQL_Multi_Script/index.htm) ://www.red-gate.com/products/SQL_Multi_Script/index.htm 。不过我从来没用过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T18:57:59.150

您可以使用批处理文件对多个数据库执行脚本，以使用[SQLCMD执行脚本](http://msdn.microsoft.com/en-us/library/ms180944.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-30T01:41:06.690

跨多个数据库运行相同查询的免费软件应用程序： [http ://www.geniusconnect.com/articles/Otherproducts/2/4/9/](http://www.geniusconnect.com/articles/Otherproducts/2/4/9/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-28T14:25:19.597

可以在这里找到一个很好的解决方案：

[在一组 SQL Server 数据库上执行一组 SQL 脚本文件 (*.sql)](http://pradeep1210.wordpress.com/2012/03/15/executing-a-set-of-sql-script-files-sql-on-a-group-of-sql-server-databases/ "在一组 SQL Server 数据库上执行一组 SQL 脚本文件 (*.sql)")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T05:31:33.653

这对我们来说一直是个大麻烦。我们一直在寻找一种工具来做到这一点。我们尝试了 www.redgate.com 和 www.queryblaster.com。我们决定使用 queryblaster，它是两者中最容易使用的。这两个软件应用程序都允许您一次在多个数据库上运行脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-29T16:40:03.433

SSMS 工具包是一个不错的选择，特别是对于 2012 年之前的数据库服务器，因为它是免费的。

[http://www.ssmstoolspack.com/](http://www.ssmstoolspack.com/)

# php - 国际化的设计注意事项

> ID：644100
> 
> 赞同：44
> 
> 时间：2009-03-13T18:51:35.517
> 
> 标签：php, internationalization, locale

我读过 Joel 关于[Unicode](http://www.joelonsoftware.com/articles/Unicode.html)的文章，我觉得我至少从字符集的角度对国际化有了基本的了解。除了阅读[这个问题](https://stackoverflow.com/questions/898/internationalization-in-your-projects)之外，我还对设计考虑方面的国际化进行了一些自己的研究，但我不禁怀疑还有很多我不知道或不知道的地方不知道问。

**我学到的一些东西：**

*   有些语言从右到左而不是从左到右阅读。
*   日历、日期、时间、货币和数字的显示因语言而异。
*   设计应该足够灵活以容纳更多文本，因为某些语言比其他语言冗长得多。
*   当涉及到它们的语义含义时，不要将图标或颜色视为理所当然，因为这可能因文化而异。
*   地理名称因语言而异。

**我在哪里：**

*   我的设计足够灵活，可以容纳更多的文本。
*   我会自动翻译每个字符串，包括错误消息和帮助对话框。
*   我还没有到需要显示时间单位、货币或数字的地步，但我很快就会到那里，需要开发一个解决方案。
*   我正在全面使用 UTF-8 字符集。
*   我的菜单和应用程序中的各种列表按每种语言的字母顺序排序，以便于阅读。
*   我有一个标签解析器，它通过过滤掉停用词来提取标签。停用词列表是特定于语言的，可以换掉。

**我想了解更多：**

*   我正在开发一个可下载的 PHP Web 应用程序，因此任何有关 PHP 的具体建议将不胜感激。我已经开发了自己的框架，目前对使用其他框架不感兴趣。
*   我对非西方语言知之甚少。有没有我上面没有提到的需要考虑的具体因素？另外，PHP 的数组排序函数如何处理非西方字符？
*   您在实践中是否遇到过任何具体的问题？我正在查看 GUI 和应用程序代码本身。
*   关于使用日期和时间显示的任何具体建议？是否按地区或语言分类？
*   我见过很多项目和网站让他们的社区为他们的应用程序和内容提供翻译。你推荐这个吗？有什么好的策略来确保你有一个好的翻译？
*   这个问题基本上是我对国际化的了解程度。什么我不知道我不知道我应该进一步研究？

**编辑**：我添加了赏金，因为我想从经验中获得更多真实世界的例子。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-13T19:19:51.563

我们的游戏[Gemsweeper](http://www.lobstersoft.com/gemsweeper/index.php)已被翻译成 8 种不同的语言。在这个过程中我学到了一些东西：

*   **如果给译者一个句子来翻译，请确保他知道每个句子的上下文。**否则他可能会提供一种可能的翻译，但不是你想要的那个。[Babelfish](http://babelfish.yahoo.com/)等工具在不了解上下文的情况下进行翻译，这就是为什么结果通常如此糟糕的原因。只需尝试将任何重要的文本从英语翻译成德语并返回，您就会明白我的意思。

*   **应该翻译的句子不能因为相同的原因分成不同的部分。**那是因为您需要维护上下文（请参阅前一点），并且因为某些语言可能在句子的开头或结尾有变量。使用占位符而不是拆分句子。例如，而不是

> “这是我们 15 步教程中的一步”

写一些类似的东西：

> “这是我们 15 步教程的第 %1 步”

并以编程方式替换占位符。

*   **不要期望翻译者很有趣或有创意。**除非您为特定的文本段落命名并支付额外费用，否则他通常没有足够的动力去做。例如，如果您的语言资产中有笑话，请在旁注中告诉翻译人员不要尝试翻译它们，而是将它们排除在外或用更阴沉的句子替换它们。否则翻译者可能会逐字翻译笑话，这通常会导致完全胡说八道。在我们的案例中，我们有一名翻译和一名笑话作者负责最关键的翻译（英语）。

*   **尝试找到一位翻译人员，他的第一语言是他要将您的软件翻译成的语言，而不是相反。**否则，他可能会写出可能是正确的文本，但对母语人士来说听起来很奇怪或过时。此外，他应该居住在您翻译目标的国家/地区。例如，来自瑞士的说德语的人不是德语翻译的好选择。

*   **如果可能，请让您的一位了解特定翻译的公共 beta 测试用户验证翻译的资产和完成的软件。**我们有一些非常好的和非常差的翻译，这取决于提供它的人。根据我们的一些用户的说法，瑞典语翻译完全是胡言乱语，但已经为时已晚。

*   **请注意，对于每个具有新功能的更新版本，您都必须翻译您的语言资产。**这会产生一些严重的开销。

*   **请注意，如果您的软件被翻译，最终用户会期望技术支持会说他们的语言。**再一次，Babelfish 很可能不会这样做。

**编辑 - 更多点**

*   **使本地化之间的切换尽可能容易。**在 Gemsweeper 中，我们有一个在不同语言之间切换的热键。它使测试变得更加容易。

*   **如果您要使用异国字体，请确保这些字体包含特殊字符。**我们为 Gemsweeper 选择的字体非常适合英文文本，但我们不得不手动添加相当多的字符，这些字符仅存在于德语、法语、葡萄牙语、瑞典语……

*   **不要编写自己的本地化框架。**[使用像Gettext](http://www.gnu.org/software/gettext/)这样的开源框架可能会好得多。Gettext 支持句子中的变量或复数形式等功能，并且坚如磐石。本地化资源被编译，所以没有人可以篡改它们。另外，您可以使用[Poedit](http://www.poedit.net/)之类的工具来翻译您的文件/检查其他人的翻译，并确保所有字符串都已正确翻译并且在您更改底层源代码时仍然是最新的。我已经尝试过自己滚动和使用 Gettext，我不得不说 Gettext 加 PoEdit 非常出色。

**编辑 - 更多点**

*   **了解不同的文化有不同风格的数字和日期格式。**编号方案不仅因文化而异，而且在该文化中也因目的而异。在 EN-US 中，您可以格式化数字“-1234”；'-1,234' 或 (1,234) 取决于数字的用途。了解其他文化也会做同样的事情。

*   **了解您从哪里获得全球化信息。**例如，Windows 具有 CurrentCulture、UICulture 和 InvariantCulture 的设置。了解每一个的含义以及它如何与您的系统交互（它们并不像您想象的那么明显）。

*   **如果你要做东亚翻译，真的要做好功课。**东亚语言与这里的语言有很多不同。除了同时使用多个字母之外，它们还可以使用不同的布局系统（自上而下）或基于网格。东亚语言中的数字也可能非常不同。在 en-US 中，您只能在有限的条件下更改系统（例如 1 与 1st），除了逗号和句点之外，还有其他数字注意事项。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-13T19:11:20.243

> *   我的菜单和应用程序中的各种列表按每种语言的字母顺序排序，以便于阅读。

列表应该排序，菜单不应该。请记住，给定的用户可能希望以一种以上的语言使用您的应用程序，他仍然应该在同一个地方找到任何地方。

与快捷方式相同，如果有的话：*不要翻译它们*。

另外，请记住，国际化和翻译是两个非常不同的事情，分别管理它们。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-21T19:48:21.003

当我们处理 Dreamfall 和柯南时代的 i18n/l10n 问题时，我们遇到了一些值得牢记的问题。其中一些是我们解决的，一些是为我们解决的，还有一些是我们解决的。有些我们从未解决...

*   确保您的所有工具和所有代码都支持您要使用的所有字符集，并在项目过程中仔细检查该假设两次，并再次确认。

*   确保您使用的字体支持您要使用的所有语言。大多数声称是 unicode 的字体只是 unicode，因为它具有的字符位于正确的代码点。这并不意味着它对所有代码点都有可用的字符。

*   文本换行不仅在空格处完成，因为某些语言不*使用*空格来分隔单词（想到中文）。确保您的文本换行例程处理文本时完全没有任何空格。

*   在简单的情况下正确处理复数是很棘手的，而在困难的情况下则非常困难。确保您对将使用的语言有足够的了解，以便能够编写代码来正确处理复数问题。请记住，英语（以及其他“西方”语言是简单的语言之一。

*   永远不要打断句子并用它们构建字符串以适应变量，因为变量可能以不同的语言放置在句子的其他地方。使用占位符。

*   请记住，对于某些语言，占位符的值可能会改变句子的书写方式。语法很难。确保你有一个处理它的计划。（具体来说，确保您有办法根据性别、时间等对占位符中使用的值进行分类）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-20T03:57:30.797

我想发表以下评论 - 这些来自一些公司指南，其中 1 类产品在*31*个不同的语言环境中进行了翻译。遵循这些指导方针为我们（我们的开发团队而不是整个公司）提供了最高的翻译生产力。

*   不要尝试重复使用错误消息片段。例如，不要以为因为你有两个错误`"You selected the wrong menu item"`和`"That menu item is not yet available"`，你可以提取`"menu item"`到一个单独的项目中，并在两个地方都使用它。*所有*消息都应该是自包含的，因为它们的翻译可能会根据上下文而变化。

*   使用熟悉技术的*专业翻译人员。*如果你靠近像 BabelFish 这样的服务，你会得到你应得的一切。例如，在地球`"Microsoft Windows"`上`"Microsoft Windows"`无处不在，它不会`"Microsoft Fenster"`在德国。

*   尽量不要*在*您的消息中嵌入变量（例如动态变化的`"The %1 has failed"`位置`%1`），因为位置，实际上，性别可能会改变：`"La table est rubbish"`vs.`"L'Homme est drunk"`或`"The red table"`vs. `"La table rouge"`最好使用带有附加参数的通用名词：`"The item has failed [%1]"`.

*   只翻译用户期望*看到的东西。*日志文件中的日志消息（只有您会使用）应该是英语（或您的母语），而不是翻译成您无论如何都无法阅读的斯瓦希里语。

*   菜单应按功能排序，而不是排序顺序。

*   可翻译单元应存储在代码*外部*并在运行时加载。这使得翻译成为仅将外部文件发送出去的问​​题，而不是试图将更改硬塞到代码中间。它还使将来添加其他语言变得更加容易。

现在就足够了。最好在你们都睡着之前停下来:-)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-13T20:21:00.700

关于数字的事情：据我所知，在英语中，您只需将单数与 1 一起使用，将复数与 2 或更多一起使用。比如：“你有 1 条消息”；“2 条消息”；“3...消息”。在俄语中，这些事情变得更加复杂。您对 1、21、31、41... 101、121 使用单数（因此，对于以 1 结尾的所有内容，除非以 11 结尾）。然后你对 2, 3, 4 使用*单数属格*；22、23、24；32、33、34……102、103、104；122、123、124。在所有其他情况下，您使用*复数属格*。

实施起来并不难。*然而，困难的是*实现一些知道如何处理任何先验未知语言及其所有怪异的东西:-)

这只是数字:-)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-26T21:15:55.667

到目前为止，我没有太多要补充的好答案，但这里有一些事情需要考虑和检查。

*   **不要做假设。** 这是包罗万象的规则。很容易假设特定于地区或语言的事物，并且很难注意到这些假设。
*   **字符串比较要非常小心。** 有一些语言，例如土耳其语，它们的字母在视觉上与其他语言相似，但又有所不同。
*   **使用伪翻译作为冒烟测试。** 如果您从资源文件中读取已翻译的字符串，请创建一个您仍然可以理解的文件的伪翻译版本，但它强调应用程序中每个可翻译字符串的容量和能力。例如，用“CancelXXXX！”之类的内容填充“Cancel”之类的字符串。因此它与您对翻译字符串的允许范围一样宽。然后您可以测试以验证每个字符串都将完全显示。额外的功劳还在于坚持可能呈现的最复杂的字符，以验证它在所有地方都正确显示。
*   **不要对键盘布局做出假设。** “ASDW”可能是用于 QWERTY 键盘的一组很好的方向键控制集，但硬编码使得使用其他键盘布局的人不友好，如果不是不可能的话。
*   **测试各种日期设置，然后再次测试它们。** 由于区域设置中“AM/PM”的不同格式，我已经看到了一些问题。mm/dd/yyyy vs. dd/mm/yyyy 也经常出现，但这里的每个设置都很重要。
*   **测试各种数字格式，然后再次测试。** 例如，您不想依赖小数或千位分隔符。
*   **在有和没有用户登录到服务器的情况下进行测试。** 这可能更特定于 Windows，但很容易在服务器上配置一个组件，以便在用户登录时使用登录用户的区域设置，在用户未登录时使用默认区域设置。这个可能会导致奇怪的间歇性行为。
*   **使用各种区域和语言设置进行测试。** 例如，Windows 不仅有区域和语言设置，IE 也有自己的语言设置。例如，将 en-us 列在首位的 IE 客户端的行为可能并不总是与 en-nz 列在首位的 IE 客户端的行为相同。
*   **确保您的翻译人员了解业务和语言，然后与其他人交叉核对。** 任何时候使用特定于应用程序的术语时都要非常小心。如果您的程序使用特定词来表示应用程序中的特殊内容，请确保它们在每个实例中都以相似的方式进行翻译，包括在帮助文本中。如果您有特定的语言目标，您甚至可以提前翻译这些词，并确保它们不会在目标语言中翻译得不好。这更像是一个产品研究的事情，但它可以改变界面中使用的单词，如果这些单词从一开始就到位，那么每个人都会更容易。您还想避免可能翻译不好的成语。

好吧，我想说的比我想象的要多……

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-13T22:27:44.030

我学到了一件事：如果您有多个文件需要翻译，请在名称中包含一个额外的标签，以便稍后您可以在整个文件夹中搜索该标签。

例如，不要将文件命名为“sample-database.txt”，而是将英文版命名为“sample-database-loc-en.txt”，将意大利文版命名为“sample-database-loc-it.txt”

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-21T20:51:19.180

我在 StackOverflow 中的第一个答案，如果有人说愚蠢，请原谅。

根据我的经验：

*   **PHP**：gettext 非常有用；

*   **非西方语言**：UTF-8 无处不在（代码、数据库），到目前为止我们做得很好；

*   **您在实践中是否遇到过任何具体的问题？**将 i18n 的长段落拆分成不同的句子可以降低翻译成本，如果字符串在网站中重复多次，您只需翻译一次。但是，要小心，如果你对文本进行过多的分割，翻译者会失去上下文；

*   **我见过很多项目和网站让他们的社区为他们的应用程序和内容提供翻译。你推荐这个吗？有什么好的策略来确保你有一个好的翻译？**如果你有大量的志愿者，那就去吧，但根据你有多少文字，你可能真的需要大量的志愿者。还要始终确保您有一个您信任的人作为语言项目的领导者来担任控制翻译准确性的校对员。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-05T21:14:58.703

*   不同语言之间的排序规则/排序规则可能大相径庭：ä 在德语中的排序方式与在瑞典语中的排序方式不同。因此，排序需要针对特定​​文化。
*   大写/小写可以带来惊喜：德语“sharp S”字符 ß 没有大写版本，要么转换为“SS”，要么在准确性很重要的情况下保持小写。土耳其语有一个无点的小写 i 和一个带点的大写 I。
*   对于多语言 Web 应用程序，请仔细考虑如何确定要显示的版本以及如何将其用于 URL。用户应该始终能够手动选择语言，并且您希望搜索引擎在不同的 URL 下找到不同的语言版本。
*   一些东亚语言（即日语和汉语，也许还有其他语言）在单词之间没有空格
*   日语（也许还有其他人）有阿拉伯数字和空格的单独版本（“全角”），甚至有一些自己的字符的两个版本（半角和全角片假名）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-20T01:18:11.210

是的，这是一个**庞大的**主题。把它做好是一项非常艰巨的工作。

在我的程序中，我对每段文本都使用一个整数键，并根据需要在文件中查找它，具体取决于语言。代码中的任何地方都没有文字字符串，只有键。我用 C++ 中的“枚举”定义它们，所以我实际上并没有输入数字。当我添加更多枚举并且翻译者填写空白时，我编写了一个实用程序来同步各种语言文件。

每个键还具有关联的工具提示、图像、键盘快捷键等。

至于时间和日期……再一次，这比您想象的要复杂得多，但是 PHP 不为您处理这个问题吗？（我不知道，我是一个 C++ 人......）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-23T21:57:30.020

PHP 在内部将字符串表示为字节流，并在编码很重要的情况下假定为 iso-8859-1。在大多数情况下，您可以在所有地方使用 UTF-8，就可以了。一个问题是，如果您的网站从用户那里获取输入，那么您永远无法 100% 确定他们以正确的编码提交内容。您可能想要使用[`mb_detect_encoding`](http://php.net/mb_detect_encoding)来验证输入，或使用带有“外来”字符的隐藏字段来验证。

请注意，PHP 中所有基于字符的字符串相关函数都假定字符 = 字节。这意味着您通常不能信任字符串函数。请查看[此页面](http://www.phpwact.org/php/i18n/utf-8)以获取更多详细信息。

PHP 的另一个好资源是[Nick Nettleton 的备忘单](http://www.nicknettleton.com/zine/php/php-utf-8-cheatsheet)。

与字符集/编码密切相关的主题是 collat [​​ion](http://en.wikipedia.org/wiki/Collation)。您需要您的排序规则来匹配您正在使用的语言/文化。至少在 MySql 中（可能在其他 RDBMS 中也是如此），您可以指定不同级别的排序规则，例如每个数据库、每个表、每个列，甚至在查询本身中。

# .net - 在 32 位 windows xp pro 上开发的服务，无法在 windows server 2003 64 位上运行

> ID：644103
> 
> 赞同：0
> 
> 时间：2009-03-13T18:52:18.180
> 
> 标签：.net, web-services, windows-services, windows-server-2003

开发了一个 Windows 服务并在 32 位机器上运行。它与 Project Web Access Web 服务通信。现在，该服务已移动到与 Project Web Access Web 服务相同的计算机上。代码失败，我收到此错误：

> System.Net.WebException：请求失败，HTTP 状态为 401：未经授权。在 System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse(SoapClientMessage message, WebResponse response, Stream responseStream, Boolean asyncCall)
> 在 System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters) 在 ProjToolService.ProjectWebSvc .Project.ReadProject(Guid projectUid, DataStoreEnum dataStore)
> at ProjToolService.Queue.AssignResource(Guid queueId, Guid projectId, Guid taskId, Guid resourceId, Guid assignmentId)

它可能不是 32 位与 64 位，但我没有其他想法。

目标平台是 x86，但使用 AnyCPU 也失败了。我也尝试过使用`DefaultCredentials`和`System.net.CredentialCache.DefaultNetworkCredential`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:55:36.473

401 是一种 HTTP 状态，因此它应该与 32 位和 64 位无关。我会检查并确保使用正确的凭据设置 Web 服务（特别是如果您计划使用匿名访问）。

如果我没记错的话，DefaultNetworkCredential 会提取运行服务的帐户，所以我会检查以确保您使用的服务的帐户具有访问 Web 服务的适当权限。检查这一点的简单方法是为运行服务的帐户授予对机器的管理访问权限（然后在完成后将其取走）。如果它有效，那么这是一个权限问题。如果不是，那么你知道这是另一回事。

要授予帐户权限，请转到管理工具-> 计算机管理-> 本地用户和组-> 组。将网络用户添加到适当的组（就像我说的那样，我将从 admin 开始并逐步向下工作。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:56:16.237

您的服务以什么用户身份运行？请记住，本地用户等在未登录该框时不会运行，而服务器通常不会。网络用户可能工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T23:05:27.597

Win2003的安全设置比WinXP要保守得多，尤其是在网络访问方面。您可能会更好地在您的网络服务和系统日志中查找“访问被拒绝”错误，并确保您的服务（使用其确切名称，直到`?`URL 中的名称）被允许访问服务请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T14:03:25.277

感谢所有的帮助和关注，但我终于发现了问题。问题是 win 服务与 web 服务在本地运行的问题。此问题特定于 Windows server 2003 操作系统。为了解决这个问题，我必须在名为 DisableLoopbackCheck 的注册表编辑器中创建一个新值，并将其设置为 1。

# c# - 用户控件可以有母版页吗？

> ID：644105
> 
> 赞同：2
> 
> 时间：2009-03-13T18:52:33.017
> 
> 标签：c#, asp.net, master-pages

我正在创建一个具有多个用户控件的页面（类似于 WebParts）。每个小部件都有一个通用的 UI 部分和内容部分。

我使用具有公共元素的 ParentUserControl 和具有内容的 ChildUserControl 实现了这一点。到目前为止效果很好。

我很想知道我是否应该使用一个具有通用 UI 元素的 MasterPage 的单个控件，并将此 MasterPage 包含在所有其他子控件中？（当然假设 MasterPage 可以在 UC 中使用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T19:05:20.880

不幸的是，MasterPages 旨在使用该`Page`类型。该`Page`类型旨在使用其`OnPreInit`方法来初始化和设置 MasterPage。由于这个和其他几个原因，MasterPages 不能与 UserControls 一起使用。

您现在设置的内容听起来不错 - 您是否有理由要更改它？

# java - 捕获 JSP 输出，保存到文件

> ID：644106
> 
> 赞同：5
> 
> 时间：2009-03-13T18:53:04.123
> 
> 标签：java, jsp

我的任务是尝试创建一个将创建自定义 HTML 模板的站点。定制是基于用户输入定制的。我目前在前端的其余部分使用 tomcat / JSP。我想要做的是在 JSP 中创建 HTML 模板以输出条件 HTML 代码，但我不想将此 HTML 输出显示给用户，而是将此代码保存到几个文件中（然后将其压缩并交付到用户，以及图像、css 文件、js 文件）。我需要知道如何创建一个将执行 JSP 文件的假容器（过程包括和评估变量）。

我阅读了有关使用服务器过滤器拦截 JSP 代码输出的信息，但我不确定这是否有效，因为 a）我需要创建几个 HTML 文件，b）我需要向用户显示不同的内容（即这里是你的 zip 文件, 下载它）不是正在处理的 JSP 的输出。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:23:50.710

这是一个想法。创建一个 servlet 以接受来自用户的输入，从 servlet 使用 java.net.HttpURLConnection 将输入传递给 JSP 页面并获取结果。

```
URL urlPage = new URL(url);
HttpURLConnection conn = (HttpURLConnection)urlPage.openConnection();
conn.connect();
BufferedReader br = new BufferedReader(new InputStreamReader(conn.getInputStream()));

//then loop through lines of webpage with br.readLine(); 
```

然后在您的 servlet 中，您可以压缩所有拉取的文件并将其返回给用户

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:20:36.773

您可以有一个 servlet，它通过打开 URLConnection 然后将输出读入临时文件或缓冲区来调用 JSP。然后它会压缩它并写出拉链。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:00:23.120

我真的不确定我是否理解你的问题，但我会尝试一下。为什么不创建一个 servlet 并让它使用以下命令调用您的 jsp 文件：

```
 RequestDispatcher d = getServletContext().getRequestDispatcher(jspName);
    d.forward(request, response); 
```

让 jsp 显示带有表单/用户输入值的前端。表格完成后，提交表格。此时，jsp 会将上下文返回给 servlet，您可以在其中解析值，确定要创建哪些文件并将其返回给用户。一旦确定了要向用户显示的内容，就将其放入另一个 jsp 并将上下文传递给该 jsp。

您可以通过 2 种方式做到这一点。您可以为希望返回的不同文件类型创建不同的 jsp，然后调用正确的 jsp。或者您可以通过将它们嵌入到请求中然后将它们获取到您的 jsp 中来将您想要的任何结构/值传递到您的 jsp 中。您可以使用这个事实来创建一个基于传入参数（嵌入在请求中）的单个 jsp 将显示正确的信息。

如果我完全错过了您的问题的重点，请随时删除此回复。

编辑：无论哪种方式，您都必须在请求中嵌入您的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:56:29.967

为什么不使用 wget？您可以将页面加载到真实容器中，然后使用 wget 从容器中检索生成的页面。

```
--input-file=FILE read URLs from file. 
```

在 wget 中使用此选项将从文件中获取 URL 列表并为您下载它们，就像文本将显示在浏览器的 view-src 中一样。

wget 也可用于[Windows](http://gnuwin32.sourceforge.net/packages/wget.htm)和 Linux。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-14T00:43:07.510

您还可以尝试使用专为此类工作设计的许多轻量级模板引擎中的一些。当我有类似的任务并且从不回头时，这就是我所做的。以[速度](http://velocity.apache.org/)为例。

# c# - 这是静态类和线程安全的坏习惯吗？

> ID：644116
> 
> 赞同：3
> 
> 时间：2009-03-13T18:55:25.070
> 
> 标签：c#, thread-safety

假设我没有使用 lock 语句，这是一种不好的做法吗？

```
public static class Foo
{
  public static string Bar()
  {
    bool working;

    while (working)
    {
      // Loop until ready to run.
    }

    working = true;

    // Do stuff here.

    working = false;
    return "done."
  }
} 
```

编辑 -

在尝试了这样的事情之后，我意识到这有几个原因是不可行的。我只是好奇..我发布的示例甚至不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T18:58:59.617

循环是一个消耗 CPU 的过程。

我的意思是，如果你所做的一切都只是等待。这不是一件好事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T18:59:29.693

首先，工作对方法来说是私有的，所以它不会有任何效果。调用它的 2 个线程每个都有自己的“工作”。您需要将其设为静态字段才能产生效果。

即使那样，您也可以获得比赛条件。2个线程可以同时命中这个，通过while(working)条件，然后设置working = true；并同时做事。

使用锁或信号量将有助于解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T18:59:34.310

假设你的意思是`working`从另一个线程修改，有两个问题：

1.  你应该把工作变成`volatile static`会员。Volatile 会告诉编译器不要在优化中尝试任何“聪明”的东西。

2.  您已经编写了所谓的“自旋锁”。在某些特殊情况下，这是最好的方法。但通常这是一个糟糕的主意，因为在`working`设置变量之前，您的线程会消耗 CPU。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T19:00:15.073

是的，这是不好的做法。

为什么不使用 lock 语句？看看[Monitor](http://msdn.microsoft.com/en-us/library/system.threading.monitor(VS.71).aspx)类，我可以提供互斥和同步。

不应使用旋转循环和非线程安全变量工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T19:04:39.463

还有一个问题是，如果工作对多个线程可见（正如另一张海报提到的那样，它是一个局部变量），正如现在所写的那样，不能保证系统中的其他内核会看到以正确顺序工作的更新。需要一个内存屏障，例如 System.Threading.Thread.MemoryBarrier，以保证 CPU 不会在“Do stuff here”之后重新排序对工作的写入。

但是您应该考虑改用锁。无锁编程很难做到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T19:44:43.873

使用锁定是防止并发问题的唯一方法（除了不这样做）。

```
public static class Foo
{
  private static object barLock = new object();

  public static string Bar()
  {
    lock (barLock)
    {
      // Do work
      return "Done";
    }
  }
} 
```

# javascript - 如何选择第一个子表单元素（使用原型）？

> ID：644128
> 
> 赞同：2
> 
> 时间：2009-03-13T18:58:05.797
> 
> 标签：javascript, prototypejs

我想将焦点放在 div 中的第一个表单元素上，或者使用 Prototype 给我的东西，或者使用普通的 javascript。我有一个包含表单元素的 div 的引用。我不知道第一个表单元素是`<input>`、`<select>`还是`<textarea>`节点。

我想做这样的事情：

```
$('parentDiv').down('textarea, select, input').focus(); 
```

但是，[Element.down](http://prototypejs.org/api/element/down)方法似乎选择了第一个 textarea 节点，即使在 textarea 之前有一个输入节点。

有没有一种优雅的方式来解决这个问题？我想我可以得到父 div 的所有后代，然后遍历每一个寻找这些节点之一，但我怀疑在原型中可能有一种很酷的方法来做到这一点。

我不能使用 Form 对象的方法，因为这个父 div 只是表单的一部分。它是通过 AJAX 调用添加到页面中的，因此当 div 已添加到 DOM 时，我想将焦点设置在新添加的集合中的第一个字段上（很可能不是整个表单中的第一个字段） .

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:01:07.507

当我使用原型时，我确信我做了这样的事情。

```
var firstElement = Form.findFirstElement(document.forms[0]);
if(firstElement !=null)
    firstElement.activate(); 
```

我会用你的表格代替`document.forms[0]`

Prototype 也有`focusFirstElement`on`Form`类的方法，但我不能使用它，因为我要加载的某些页面没有表单。您可能可以只调用`Form.focusFirstElement($(form));`或类似的变体。

编辑：
我认为您可以在不同类型的元素上使用表单扩展，但它似乎不起作用，但是您可以从表单中获取一些内容并直接应用它。以下代码应该可以按您的意愿工作。

```
var firstElement = Form.getElements($("parentDiv")).find(function(element) {
    return element.type != 'hidden' && !element.disabled &&
    ['input', 'select', 'textarea'].include(element.tagName.toLowerCase());
});
if(firstElement != null)
    firstElement.activate(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-24T13:07:06.123

有与 pkeading**完全相同**的问题 - 可以确认 Quintin Robinson 的编辑答案适用于 pkeading 想要的

2个注意事项：

1.  `$("parentDiv")`需要引用包含表单元素的div

2.  如果您使用 scriptaculous 效果来打开带有“子表单”的 div，那么您需要在效果中的 afterFinish 函数中运行代码：

    ```
    Effect.BlindDown(*YourDiv*,{
        duration:0.5,
        afterFinish: function() {
            var ff1=Form.getElements($(*YourDiv*)).find(
                    function(element){
                       return element.type != 'hidden' && !element.disabled && ['input', 'select', 'textarea'].include(element.tagName.toLowerCase())
                    }
            );
            if(ff1 != null) ff1.activate();
        }
    }); 
    ```

# asp.net - ASPNETDB 管理工具

> ID：644137
> 
> 赞同：4
> 
> 时间：2009-03-13T18:59:49.800
> 
> 标签：asp.net, membership, aspnetdb

是否有任何工具可以管理已部署的 ASP.NET 应用程序的 aspnetdb.mdf 文件，类似于 Visual Studio 的 WSAT（“hummer-globe”按钮）？

无法在服务器上安装 Visual Studio 和 SQL 管理工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T21:52:47.250

从[在 Visual Studio 外部启用 ASP.NETWebAdminFiles](http://www.jedatu.com/techblog/archives/2005_12_01_index.html)

...

1.  创建一个指向 Web 管理文件的虚拟目录。

    这就是我所做的： VirtualDirectory: ASP.NetWebAdminFiles MappedTo: C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\ASP.NETWebAdminFiles

2.  修改虚拟目录的属性，使其在 ASP.NET 2.0 下运行。（属性 > ASP.NET）

    注意：如果您在同一服务器或站点上运行 1.1 和 2.0 应用程序，您可能必须为 2.0 站点设置单独的应用程序池。如果您收到“应用程序不可用”通知，那就是原因。

3.  当您在那里时，删除对该虚拟目录的匿名访问。

4.  之后，您将能够使用以下 url 语法连接到 Web 管理工具

    [http://localhost/ASP.NETWebAdminFiles/default.aspx?applicationPhysicalPath=XXX&applicationUrl=/YYY](http://localhost/ASP.NETWebAdminFiles/default.aspx?applicationPhysicalPath=XXX&applicationUrl=/YYY)

...

# asp.net - 如何始终访问 ASP.NET 客户端 API？

> ID：644139
> 
> 赞同：3
> 
> 时间：2009-03-13T19:00:56.040
> 
> 标签：asp.net, javascript, ajax

一些背景。该项目是一个使用 ASP.NET AJAX Extensions 1.0 的 VS 2005 Web 应用程序。

问题，如何在不使用 ScriptManager 控件的情况下引用 Scriptmanager 控件使用的 JavaScript 文件，或者如何更早地加载 ScriptManager JS 文件（我认为这是不可能的，因为 ScriptManager 必须在服务器中-side 表单标签）？

我在母版页中有一个 ScriptManager 控件，但是很多时候，有些页面只是很好的非异步回发，我在脚本管理器加载之前创建了客户端对象。现在我知道在开始时在标记和 CSS 的末尾附近加载脚本是一种很好的做法，但在我的情况下，我创建的一些脚本需要在之前，通常在 head 标签中，因为例如我会有一个实例化客户端对象的转发器。

所以这就是我想要的：

// 我的脚本

现在这就是我为解决这个问题所做的事情：

```
(function() {
   var myInterval;

   myInterval = setInterval(function() {
      if (!Type) {
         return;
      }

      clearInterval(myInterval);

      Type.registerNamespace("Awesome");

      Awesome.Widget = function() {
         var _this = this;

         this.myProperty = 'This is awesome';
      }
   }, 40);
})(); 
```

或者我这样做：

```
var Awesome = {};

Awesome.Widget = function {
   /// Awesome code.
} 
```

同样最好不要加载这些脚本两次，因为 ScriptManager 控件将在某个时候呈现，因为它位于我的 MasterPage 中。

也许问题是我正在以错误的方式解决这个问题。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T20:33:30.677

当您使用 MS AJAX 控件时，您可以利用自动连接的**pageLoad**函数名称，并将代码放在那里。

您的**pageLoad**函数在文档准备就绪、所有内容都加载完毕并且您可以随心所欲地处理 DOM 时调用您的 pageLoad 函数（它有点像 jQuery 的 document.ready 函数，但实际上会稍晚一些）。

可以在[AJAX 客户端生命周期事件](http://msdn.microsoft.com/en-gb/library/bb386417.aspx)页面上找到更多详细信息。

```
function pageLoad(sender, args){
  Type.registerNamespace("Awesome");

  Awesome.Widget = function() {
     var _this = this;

     this.myProperty = 'This is awesome';
  }
} 
```

如果您不关心文档是否准备就绪，但可以满足所有正在加载和解析的脚本，则可以改为挂钩[init 事件](http://msdn.microsoft.com/en-gb/library/bb397532.aspx)。

```
// Attach a handler to the init event.
Sys.Application.add_init(applicationInitHandler);

function applicationInitHandler() {
  Type.registerNamespace("Awesome");

  Awesome.Widget = function() {
     var _this = this;

     this.myProperty = 'This is awesome';
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:40:50.213

我不确定我是否遵循您的问题，但希望这会有所帮助。确保您可以访问 ASP.NET AJAX 客户端库的标准方法是将 ScriptManager 控件添加到您的母版页，然后在需要时在内容页、用户控件和 Web 部件中使用 ScriptManagerProxy 控件。

ScriptManagerProxy 控件的设置与母版页中 ScriptManager 的设置相结合，以确保页面可以使用正确的 JavaScript 代码。

# sql - 如何在更新查询中动态设置表名和字段名？

> ID：644145
> 
> 赞同：1
> 
> 时间：2009-03-13T19:02:18.050
> 
> 标签：sql, sql-server

我想遍历一个表列表。对于每个表，我想运行一个更新查询。

伪代码：

```
ArrayOfTablesObjects = {['tablename1','fieldname1'],['tablename2','fieldname2']......}

foreach @tablename in ArrayOfTablesObjects 

UPDATE @tablename
SET  @fieldname = 'xyz'
WHERE @fieldname = '123'

end foreach 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T19:06:30.970

为此，您需要使用动态 SQL。EXEC 函数将执行作为字符串传入的临时 sql 语句。

```
DECLARE @UpdateSql AS varchar(2000)

foreach @tablename in ArrayOfTablesObjects 

SET @UpdateSql = 'UPDATE ' + @tablename + ' SET ' + @fieldname ' + = ''xyz'' WHERE ' + @fieldname + ' = ''123'''
EXEC (@UpdateSql)

end foreach 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:46:58.343

这只能使用动态 SQL 来完成。这是一种非常危险的技术，如果不仔细考虑它会如何损害数据库以及如何更仔细地编写它以保护数据库，则永远不要这样做。在考虑编写动态 SQL 之前，请阅读本文。 [http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T16:25:57.177

感谢 Harpo 的回答。我已经使用这个想法来构建以下 sql 语句。我们有许多 50+ 表，它们都具有相同类型的数据（员工 ID），但该字段名称可能不同。因此，根据表名，要更新的字段会有所不同。我的实际 WHERE 和 SET 语句比这个例子更复杂，但这对这个问题并不重要。

我首先创建一个临时表来存储我要更新的表/字段。

然后我遍历这些记录，并生成 SQL。对于那些不喜欢动态 sql 的人，您可以只使用打印语句，然后将其复制粘贴到另一个查询窗口并执行它。或者您可以调用 EXEC 语句。

我想接受你的回答，但没有完全回答我的问题，部分原因是我没有充分解释自己。不管怎样，谢谢你的帮助。

```
DECLARE @TableFieldDictionary TABLE
(
    tablename VARCHAR(100),
    fieldname varchar(100)
)

insert into @TableFieldDictionary(tablename,fieldname) values ('table1','field1');
insert into @TableFieldDictionary(tablename,fieldname) values ('table2','field2');
--put more insert statements here.  In my case, I have 50 inserts

declare cursor_dictionary cursor
for select tablename, fieldname from @TableFieldDictionary

open cursor_dictionary

declare @looptablename VARCHAR(100)
declare @loopfieldname varchar(100)

fetch next from cursor_dictionary
into @looptablename,@loopfieldname

DECLARE @UpdateSql AS varchar(max)
WHILE @@FETCH_STATUS = 0
BEGIN   
    SET @UpdateSql = 'UPDATE ' + @looptablename + 
                     ' SET ' + @loopfieldname + ' = 123' +
             ' WHERE ' + @loopfieldname + ' = 456'

    print @updatesql
    --EXEC(@updatesql)

    fetch next from cursor_dictionary
    into @looptablename,@loopfieldname
END 

CLOSE cursor_dictionary
DEALLOCATE cursor_dictionary 
```

# javascript - 用 jQuery 控制 JW FLV 播放器

> ID：644146
> 
> 赞同：2
> 
> 时间：2009-03-13T19:02:21.777
> 
> 标签：javascript, jquery, jwplayer

我正在尝试使用 jquery控制[JW FLV 播放器的实例。](http://www.longtailvideo.com/players/jw-flv-player/)

我想要做的是有一系列链接，单击这些链接会将 XML 播放列表加载到播放器中。

通过遵循[这里](http://home5.inet.tele.dk/nyboe/flash/mediaplayer4/JW_API_xmpl_5-2-3-0.html)的教程，我已经让事情在功能方面基本上按照我想要的方式工作，但即使我也可以看到它像罪恶一样丑陋，因为目前我的锚看起来像这样：

```
<a class="media" href="#"
onclick="player.sendEvent('STOP');
player.sendEvent('LOAD',
'path/to/playlist.xml');
return false;">load playlist</a> 
```

虽然这得到了玩家的参考

```
var player = null;
function playerReady(obj)
{
  player = gid(obj.id);
};

function gid(name)
{
  return document.getElementById(name);
}; 
```

我想做的是让我的锚看起来像这样：

```
<a class="media" href="#" rel="path/to/playlist.xml">load playlist</a> 
```

然后使用 jquery 找到 class="media" 的锚点，读取元素的 rel 属性的值，然后将点击事件绑定到它，触发相应的功能。唉，这超出了我极其微薄的能力。

到目前为止，我有：

```
$('a.media').click(function()
  {
    playlist = $(this).attr("rel");
    player.sendEvent('LOAD', playlist
  }
); 
```

这显然是行不通的。有人愿意帮助一个白痴/n00b 吗？

我应该说，我真正想做的是*学习*，而不是让别人去做，所以如果你能解释一下，那就太棒了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:18:25.060

您所做的对我来说似乎是正确的，尽管我不确定变量“玩家”是否在那里定义；这取决于上下文。

你可以做的是类似

```
$('a.media').click(function () {
  var player = $("#player-id");
  if(player.length == 1){
    player = player[0];
    var playlist = $(this).attr("rel");
    player.sendEvent('LOAD', playlist);
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:22:49.573

```
player.sendEvent('LOAD', playlist
}
); 
```

检查您的支架嵌套。

否则，应该工作。但是 'rel' 不是放置 URL 的好地方，因为它只应该包含[已知的标记](http://www.w3.org/TR/html4/struct/links.html#adef-rel)。为什么不把它放在你期望的'href'中呢？你只需要'return false' 或'preventDefault' 来停止在舔之后被跟踪的链接。

```
function playerReady(obj)
{
    player = gid(obj.id);
};
function gid(name)
{
    return document.getElementById(name);
}; 
```

呃，这里的gid不是完全多余的吗？为什么不只是'player = obj'？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-15T02:26:49.123

我在这里遇到和你一样的问题。我意识到你第一次调用创建播放器使用

```
var newplayer = SWFobject(width,height,playerid,version,background-color);
newplayer.addVarible(...);
newplayer.write(htmltaghold place for this player); 
```

我记错了，但它就像上面的代码一样，之后您可以在 jQuery 中的函数 playerReady(thePlayer){} 中使用 var player = window.document[thePlayer.id]

```
jQuery("div#id").click(function(){
   your code
   player.sendEvent("NEXT");
}); 
```

player.sendEvent("PLAY"); ..ETC。希望我们可以讨论这个问题并改进 jQuery

# sql-server - 向电子邮件字段添加非空约束

> ID：644148
> 
> 赞同：1
> 
> 时间：2009-03-13T19:02:43.850
> 
> 标签：sql-server

我的表中有一个 varchar 电子邮件字段。我无法弄清楚添加确保不能插入非空值的约束的语法。我不是在说 not null，我说的是 not empty。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:04:39.913

添加一个`not null`和一个`check`约束。

```
create table MyTable (
   email varchar(100) not null,
   constraint email_not_empty check (rtrim(ltrim(email)) != '')
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:04:57.230

len(ltrim(rtrim(email))) <> 0

# sharepoint - 如何定向到自定义错误页面？

> ID：644149
> 
> 赞同：3
> 
> 时间：2009-03-13T19:02:51.713
> 
> 标签：sharepoint, error-handling

在 SharePoint 中，

如果达到 404，我希望能够定向到自定义错误页面。

但是，在以下之后：

[如何指向 Windows SharePoint Services 3.0 或 Microsoft Office SharePoint Server 2007 中的自定义 404 错误网页](http://support.microsoft.com/kb/941329/en-us)

尝试输入以下条目时，我无法访问我的自定义错误页面：

[http://localhost/adsdasad](http://localhost/adsdasad)或错误的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T19:08:15.553

在 IIS 中为此类 url 添加通配符处理程序。

![IIS 配置](https://farm4.static.flickr.com/3426/3359516365_328415a697_o.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T01:33:43.513

您的 SharePoint 配置未处理这些 URL，因为 IIS 认为不应由 SharePoint 处理。正如[Chris 指出的那样，](https://stackoverflow.com/questions/644149/how-to-direct-to-a-custom-error-page/644165#644165)您也应该在 IIS 级别添加自定义 404 处理。

# apache-flex - AS3：从 Loader() 获取图像的最佳实践

> ID：644156
> 
> 赞同：1
> 
> 时间：2009-03-13T19:06:31.063
> 
> 标签：apache-flex, flash, actionscript-3

使用 Loader 加载图像时，将图像添加到显示列表的首选方式是什么？在像 new Bitmap( Bitmap(LoaderInfo(e.target).content).bitmapData ) 这样的 Event.COMPLETE 处理程序中获取数据，或者添加 Loader 实例本身？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:52:57.850

如果您只想显示 Loader 的内容，请随意将 Loader 添加到显示列表中，而不是提取其内容。当您需要重新设置 Loader 的内容时，这种情况并不常见。

此外，值得注意的是，加载程序的内容并不总是可访问的。例如，Flash Player 对从其他域加载的内容设置了安全限制。强制执行这些更强大的安全规则后，如果您尝试访问加载程序的内容，Flash Player 会在运行时引发安全错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:09:12.230

最好等待`Loader`完成并`Image`在结果处理程序中设置数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-12T14:18:23.350

您不能将子项添加到 Loader 类，因为......来自 livedocs 的引用“Loader 类覆盖了它继承的以下方法，因为 Loader 对象只能有一个子显示对象”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T00:20:35.060

位图在调整大小时支持图像平滑，有时这很方便。另一方面，Loader 是 DisplayObjectContainer 并允许在其中添加其他子项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T11:38:21.967

Loader 很方便，因为它使数据处理非常整洁（加载/卸载）。就我个人而言，我需要有充分的理由从加载器对象中提取数据。

在图像的情况下，一个很好的理由是无论您对数据做什么都需要 BitmapData 类。

如果您只是显示图像，那么您不一定需要 BitmapData 类。在这种情况下，使用 BitmapData 是不需要的代码！

# wpf - 使用 UI 自动化和 WPF 的经验

> ID：644158
> 
> 赞同：16
> 
> 时间：2009-03-13T19:06:40.270
> 
> 标签：wpf, ui-automation

我们正在开发一个相当大的基于 WPF 的应用程序，并希望在我们的测试套件中包含一些自动化 UI 测试（其中已经包含许多单元测试）。

Microsoft的[UI 自动化框架](http://msdn.microsoft.com/en-us/library/ms747327.aspx "UI自动化框架")在一定程度上听起来非常适合在测试设置中以编程方式启动应用程序并与之交互。但是，我一直在努力寻找可靠的示例和技术经验参考，MSDN 上提供的文章和小示例不足以让我相信这是一个可靠的选择。

那么，有没有人有在他们的测试套件中使用 UI 自动化框架的实际经验？有哪些注意事项和陷阱？编写测试脚本时的任何最佳实践，您是否可以“记录并重播”为可编写脚本的格式，您应该在多大程度上促进应用程序的测试，您是如何将其合并到自动构建中的？我们是否应该转向 UI 自动化框架以外的其他方向？

随时在这里发布您的经验或链接到我可能错过的一些好的参考资料

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-18T11:42:41.937

在我工作的地方，我们刚刚开始为我们的系统评估一些测试工具。我们遇到了一个名为[white](http://www.codeplex.com/white)的工具，它使用 UI 自动化框架。请注意，白色也有记录功能，尽管我认为它看起来有问题并且仍在开发中。

我们尝试做的是将它们设置为看起来像单元测试`[TestFixture] [Test]`等。然后我们能够在单元测试的同时通过 nunit 运行它们。

我们发现访问窗口中的某些组件可能很困难，但没有太多机会调查原因。

如果您不介意为软件付费，那么我会推荐[TestComplete](http://smartbear.com/products/qa-tools/automated-testing-tools)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-17T23:19:32.267

我正在工作中进行 WPF 应用程序的 UI 自动化。我正在使用 White 和 IronRuby，效果很好。我在这里写了我是如何做到的：http: [//www.natontesting.com/2010/02/17/how-to-test-a-wpf-app-using-ironruby-and-white/](http://www.natontesting.com/2010/02/17/how-to-test-a-wpf-app-using-ironruby-and-white/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-08T22:36:52.290

我们最初选择白色，然后远离它。它试图对 Win32 API、Winforms、Java 应用程序和 MS UI 自动化 API 进行通用和抽象。MS UI 自动化 API 还试图在 win32 api 和 winforms 和 WPF 之上实现通用和抽象，因此您最终会陷入“最低公分母的最低公分母”场景。

这样做的结果是，White 元素搜索 API 根本不够灵活，无法找到我们需要查找的各种 UI 元素，并且它没有公开足够的底层 UI 自动化框架元素以供我们使用它来做任何有用的事情.

我们最终采用了一种本土的框架。我们直接使用 MS UIAutomation 框架，但有扩展方法和辅助类来处理它没有解决的场景。（主要是键盘和鼠标输入）。

注意：我们的测试脚本和自制框架都使用 IronRuby。Ruby 向现有类添加方法的能力和灵活的语法（与 method_missing 结合）对于这类事情来说非常棒。

# java - 是否可以让 Castor 编组/解组 EnumMap？

> ID：644160
> 
> 赞同：2
> 
> 时间：2009-03-13T19:07:03.777
> 
> 标签：java, castor

我正在使用 Castor 编组/解组我的 Java 对象，其中一个包含 EnumMap。Castor 可以编组/解组 EnumMaps 吗？我有一个包含一些嵌套 HashMap 的映射文件，但我从未通过 Castor 推送 EnumMap。如果可以，如何通过映射文件完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T12:28:01.493

最大的问题之一是 Enums 不能真正被序列化和恢复，至少在 Java 1.5 中不能。而且我认为在 Java 1.6 中也没有。

由于枚举不能 - 默认情况下 - 被序列化或 XMLEncoded 我非常怀疑 EnumMap 可以被序列化。从[脚轮网页](https://castor-data-binding.github.io/castor/reference-guide/reference/xml/xml-mapping.html)：

> 虽然您始终可以使用自己的自定义 FieldHandler 来处理类型安全的枚举类，但 Castor 确实具有处理这些类型的类的内置方法。如果类型安全枚举类具有公共静态 valueOf(String) 方法，Castor 将调用该方法，以便返回正确的枚举实例。注意：您还需要禁用映射文件中的默认构造函数检查（请参阅上面的第 7.4 节以了解更多信息）。

如果这不起作用，您必须编写自己的[字段处理程序](https://castor-data-binding.github.io/castor/reference-guide/reference/xml/xml-fieldhandlers.html)。

我希望这个能有一点帮助。

# sharpziplib - 从 zip 文件中添加/删除找不到临时文件

> ID：644161
> 
> 赞同：1
> 
> 时间：2009-03-13T19:07:05.883
> 
> 标签：sharpziplib

我的程序允许用户将文件添加到 zip 文件中，一次上传一个。第一次上传会创建一个 zip 文件，随后的上传会添加到创建的文件中。它还显示 zip 文件中所有文件的列表，并允许用户删除单个文件。

我使用 SharpZipLib，这在我的本地计算机上运行良好，但是一旦我将它上传到服务器，它就开始在 CommitUpdate()

创建 zip 文件的原始上传很好，但添加到 zip 文件或从中删除会给出：

找不到文件“W:\MyZipFile.zip.151.tmp”。

如果我将窗口单独放置一段时间，我可以在错误再次出现之前删除一个文件或添加一个文件。

我的添加文件方法：

```
ZipFile z = null;
if (System.IO.File.Exists(filePath + zipFilename))
     z = new ZipFile(File.OpenRead(filePath + zipFilename));
else
     z = ZipFile.Create(filePath + zipFilename);
z.BeginUpdate();
z.Add(filePath + filename, filename);
z.CommitUpdate();
z.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:50:22.983

我想到了。在显示 zip 文件中的文件列表后，我忘记关闭 ZipFile。那锁定了拉链，直到超时才让我编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:11:06.420

您需要确保运行应用程序的任何用户都具有 NTFS 权限，可以在 filepath 指定的文件夹中创建和修改文件

# collections - 什么是链表的一个实际的、真实的例子？

> ID：644167
> 
> 赞同：62
> 
> 时间：2009-03-13T19:09:09.373
> 
> 标签：collections, linked-list, car-analogy

我了解链表的定义，但它如何表示并与一个共同的概念或项目相关联？

例如，OOP 中的组合（编辑：最初说“继承”）可能与汽车有关。现实生活中的所有（大多数）汽车本质上都是一样的。汽车有一个引擎，你可以启动（）它，你可以让汽车去（），停止（）等等。汽车通常具有最大载客量，但在公共汽车和跑车之间会有所不同，这两种汽车都是汽车。

是否有一些真实的、直观的简单的 ole' 单链表示例，就像我们在继承中所拥有的那样？典型的教科书链接列表示例显示了一个带有整数的节点和指向下一个的指针，它似乎并不是很有用。

感谢您的意见。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-13T19:25:02.487

链表就像[康加舞线](http://en.wikipedia.org/wiki/Conga_line)。每个人都握着前面人的臀部，臀部依次由人向后握着，只有前面和后面的人除外。将人员添加到线路中的唯一方法是找到正确的位置并解耦该连接，然后插入新的人员或人员。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-13T19:27:42.170

我假设您想要一个比书籍定义更具隐喻性的解释，而不是如何使用链接列表的示例。

链表有点像寻宝游戏。你有一条线索，这条线索有一个指向位置的指针，可以找到下一条线索。所以你去下一个地方，得到另一条数据，和另一个指针。要在中间或最后得到一些东西，唯一的方法是从头开始遵循这个列表（或作弊;））

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-03-13T19:37:30.880

**什么是链表的一个实际的、真实的例子？**

最简单最直接的就是火车。

火车车厢按特定顺序连接，以便以最有效的方式装载、卸载、转移、下车和取车。

例如，Jiffy Mix 工厂需要糖、面粉、玉米粉等。拐弯处可能是需要氯、硫酸和氢气的造纸厂。

现在，我们可以停下火车，卸下每节车厢的货物，然后让火车继续行驶，但是火车上的其他所有东西都必须坐好，同时将面粉从沉箱中吸出，然后是糖等。

取而代之的是，这些车厢是按顺序装载在火车上的，以便可以将整个车厢拆下，而火车的其余部分则继续行驶。

火车的末端比中间的部分更容易分离，并且比在一个地方分离几节车厢，在另一个地方分离几节车厢要容易得多。

但是，如果需要，您可以在火车的任何位置插入和移除物品。

很像一个链表。

-亚当

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-13T19:31:42.300

首先要了解的是，链表在概念上与数组相同。

唯一的区别在于各种操作的*效率。*最重要的是：

*   中间插入：列表 O(1)，数组 O(n)。
*   直接访问中间的元素：O(n) 用于列表，O(1) 用于数组。

因此，任何可用于数组的类比（飞机的所有引擎，购物清单上的所有物品......）也适用于链表，但考虑到效率可能适合进行另一个类比：

数组将是**书柜中的盒子**。当你从第 n 行移除盒子时，所有从 n+1 向上的盒子都需要向下移动一个架子（这样你就没有麻烦的空架子了）。

相反，链表将是**一条项链**。当你发现你不再喜欢那颗蓝色宝石时，将它从序列中取出，并将结果的两端绑在一起。*无需循环*穿过每颗珍珠并将其移开，这样您就可以修复您的项链。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-03-13T19:11:23.393

在柜员/收银员等处排队等候...

必须按顺序执行的一系列订单。

任何[FIFO](http://en.wikipedia.org/wiki/FIFO)结构都可以实现为链表。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-03-13T19:15:14.587

我记得，很多年前，在我的第一堂大学课程中，我想知道我会在哪里使用链表。今天，我认为没有一个项目是我没有使用过的，而且在很多地方都是如此。这是一个非常基础的数据结构，相信我，它在现实世界中被大量使用。

例如：

*   在医学成像应用程序中需要刻录到 CD 的图像列表
*   需要通过电子邮件发送通知的网站用户列表
*   3D 游戏中需要渲染到屏幕的对象列表

它现在对你来说似乎有点无用，但几年后，问自己同样的问题，你会发现自己惊讶于你曾经想知道它会在哪里使用。

**编辑：** 我在您的一条评论中注意到您询问指针为何重要。有人正确地回答说，指针对链表的用户并不重要。用户只想要一个包含事物列表的列表。该列表如何“包含”该列表对用户来说并不重要。指针是“如何”的一部分。想象一条线，画在地板上，通向出纳员。人们需要站在那条线上才能找到出纳员。那条线是（我承认，这有点牵强）链表使用的指针的类比。排队的第一个人，在出纳员处，是名单的负责人。排在他们后面的人是列表中的下一个。最后，队列中的最后一个人是列表的尾部。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2016-09-14T06:30:38.870

现实生活中的例子：

**1) 单链表**

1.  一个孩子的人脑（为了记住一些东西，例如。诗他必须把它链接起来，如果你问他最后一行，他必须从第一行开始阅读）
2.  网络上的消息传递（消息被分成数据包，每个数据包都有下一个数据包的密钥，因此在接收者端，很容易将它们组合在一起）

**2）双向链表**

1.  脱氧核糖核酸分子
2.  允许使用 BACK 按钮的浏览器缓存。
3.  火车教练与下一个和以前的教练相连。
4.  自行车滚子链（双向链表）

**3) 循环链表**

1.  自动扶梯
2.  调度程序在操作系统中的进程调度过程中使用的时间共享问题。
3.  多人棋盘游戏

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2010-03-12T09:14:41.913

Blame 的方式围绕着一群软件工程师在一个项目中的不同模块上工作。

首先，图形用户界面的人因产品不工作而受到指责。他检查了他的代码，发现这不是他的错：API 搞砸了。API 人员检查他的代码：不是他的错，这是记录器模块的问题。记录器模块的人现在责备数据库的人，谁责怪安装人员，谁责备......

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2010-03-12T09:01:25.180

你的 DNA 分子是双链表。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2010-03-12T09:21:28.747

**链条：**

[![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Broad_chain_closeup.jpg/120px-Broad_chain_closeup.jpg)](http://en.wikipedia.org/wiki/File:Broad_chain_closeup.jpg)

特别是滚子链：

[![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Kettenvergleich.jpg/120px-Kettenvergleich.jpg)](http://commons.wikimedia.org/wiki/File:Kettenvergleich.jpg)

链的每个元素都连接到它的后继者和前任者。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-03-13T19:13:20.563

如果您考虑一下，“链接”只是一种识别数据*实例之间“下一个”、“上一个”、“子”或“父”关系的方法。* 因此，在现实世界的应用程序中，您会发现各种各样的应用程序。为基本链接列表考虑一个简单的列表（例如杂货店列表）。但是也要考虑一下我们可以放置图表（在地图上绘制城市之间的距离，生物学中物种之间的相互作用）或树（组织中的层次结构或数据库索引中的数据，用于两个非常不同的示例）的用途。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-03-13T20:29:11.600

在一般情况下，链表是您将遇到的最有用的东西之一。

现实世界的例子：

*   一群人排队等候某事或其他 - 一种特殊的 LL，称为“队列”。

*   你的瓷器柜里的一堆盘子——一种特殊的 LL，称为“堆栈”。

*   “取一个数字”行（数字必须在某个点从“1”重新开始） - 一种特殊的 LL，称为“循环队列”。

一般来说，我喜欢用于几乎所有链接数据结构的比喻是**一副纸牌**。几乎任何你可以用链表做的事情，你都可以用一副卡片来可视化。这对于向自己展示一些更深奥的排序算法中发生了什么特别方便。

我个人最喜欢的：[Bogosort](http://en.wikipedia.org/wiki/Bogosort) = 玩 52 张牌，直到你的牌组被分类。:-)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2014-07-06T12:35:06.607

**人脑**可以是**单**链表的一个很好的例子。在背诵某些东西的初始阶段**，**自然的过程是将一个项目链接到下一个项目。这是一种潜意识的行为。**让我们以抢劫**8 行 Wordsworth's *Solitary Reaper*为例：

```
Behold her, single in the field,
Yon solitary Highland Lass!
Reaping and singing by herself;
Stop here, or gently pass!
Alone she cuts and binds the grain,
And sings a melancholy strain;
O listen! for the Vale profound
Is overflowing with the sound. 
```

我们的思维不像便于随机访问的数组那样工作得很好。如果你问那个人***最后一行是什么***，他会很难说。他必须从一号线到达那里。如果你问他***第五行是什么，那就更难了***。

同时，如果你给他一个指示，他就会前进。***好的，从`Reaping and singing by herself;`***?开始。现在变得更容易了。如果你可以给他两条线，那就更容易了，`Alone she cuts and binds the grain, And sings a melancholy strain;`因为他的流程更好。***同样，*如果你什么都不给他，他将不得不从头开始获得台词**。这是经典的链表。

类比中应该有一些异常可能不太适合，但这在一定程度上解释了链表的工作原理。一旦你变得有点精通或完全了解这首诗，链表就会（大脑）滚动到一个哈希表或数组中，这有助于 O(1) 查找，您可以在其中从任何地方挑选行。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-03-13T19:17:49.540

链表可用于实现[队列](http://en.wikipedia.org/wiki/Queue_(data_structure))。典型的现实生活示例将是收银员的一条线。

链表也可用于实现[堆栈](http://en.wikipedia.org/wiki/Stack_(data_structure))。锥形真实 ife 示例将是自助餐厅中的盘子分配器之一，其中将顶盘从堆叠顶部拉出。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2016-09-02T22:35:07.340

单链表的一些例子。

1.  Microsoft Word、Paint 等任何应用程序的撤消按钮：状态链接列表。
2.  GPS 导航：地图数据的链接列表。从起点到终点的旅行是遍历所有节点的示例。GPS 重新路由是地图数据的添加和删除操作的一个示例。

双链表的一些例子。

1.  浏览器的下一个和上一个按钮：URL 的链接列表
2.  Microsoft Image Viewer 的下一个和上一个按钮：图像的链接列表
3.  Photoshop 的撤消和重做按钮，状态链接列表。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-13T19:49:49.230

我对这个问题的第一反应是“环顾四周！这种东西无处不在！” 但是想了一会儿，我想不出任何不做作的例子。

链表的概念是一个复合概念，一个二元。你有一个列表的概念，这没问题。例如，杂货清单。然后你进入链接部分。一个杂货项目不知道下一个杂货项目，因此模型崩溃了。

我认为您在寻找真实世界示例时遇到困难的原因是链接部分是一个编程工件，一个实现细节。以编程方式实现列表的方法有很多，一种好的方法是让每个列表项都知道它的邻居。另一种方法是使用一个 List 对象来跟踪项目及其顺序。这就是大多数列表在现实生活中的工作方式。在上面的示例中，杂货清单的 List 对象将是它所写的纸（或其他任何东西）。

考虑一般的列表并将链接列表视为列表的特定实现也许更有用。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-10-23T13:54:13.293

双向链表的最佳和直接示例是**Train！**

![在此处输入图像描述](https://i.stack.imgur.com/H0ws9.jpg)

这里每个教练都连接到它的上一个和下一个教练（除了第一个和最后一个）

在编程方面，将教练体视为数据（值）节点，将连接器视为参考节点。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-13T19:25:07.760

在`make`程序内部，您经常会发现需要构建的特定文件的依赖关系列表被定义为指向也需要构建的其他文件的指针的链表，而这些文件又在链表中具有依赖关系。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-13T19:25:33.937

给出行进方向：方向上的每一步都是一个节点，每个节点之间的行进指令就是你的链接。

例子：

节点 1：从家里开始

链接：向南步行 3 个街区到鲍勃的家

节点 2：鲍勃的房子

链接：向北步行 2 个街区到爱丽丝之家。

节点 3：爱丽丝的房子

如果你想从一个地方到另一个地方，你必须遵循每个中间地方（节点）的链接（指令），你不能只是从家里跳到爱丽丝的。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-03-13T19:19:46.807

在 .NET BCL 中，该类`System.Exception`有一个名为 的属性`InnerException`，它指向另一个异常，否则就是`null`. 这形成了一个链表。

在`System.Type`中，该`BaseType`属性以相同的方式指向另一个类型。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-03-13T20:00:04.603

看一个链表：

[A]=> [B]=> [C]=> [D]=>

这是...火车！每个火车车厢都包含一些东西并连接到另一辆火车车厢（或者最后一个没有）。您只能在最后添加一辆有轨电车，如果您想摆脱一辆，您必须将前一辆与下一辆连接起来。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-03-13T20:06:02.093

电话链直接实现为链表。以下是它的工作原理：

1.  组组织者收集所有成员的电话号码。

2.  组织者为每个成员分配一个要呼叫的其他成员的号码。（有时他们会分配自己的号码，以便他们知道消息已通过，但这是可选的。）

3.  当需要发送消息时，组织者呼叫列表的头部并传递消息。

4.  负责人拨打他们分配的号码并传递信息。

5.  重复第 4 步，直到每个人都听到了该消息。

显然，必须注意在步骤 2 中设置列​​表，以便每个人都被链接。此外，该列表通常是公开的，因此如果有人接到电话答录机或忙音，他们可以拨打下一个号码并保持链条运转。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-03-13T20:42:57.370

链表非常类似于一摞纸，每张纸上都有一个项目。（与类似钉板的数组相反。）它通常用于解决具有以下特征的问题：

*   有未知或可变数量的项目
*   项目按顺序排列，如列表
*   项目可能会被重新排列，添加到中间列表中，在中间列表中删除，等等。

重新排列一个普通的数组很痛苦，在中间的某个地方添加一个元素同时确保数组有足够的内存等等是很痛苦的。使用链表，这些操作很简单。假设您想将项目#10 移动到项目#2 和项目#3 之间。有了文件，你可以拿起它并移动它。使用数组，您必须将项目 3 到 9 移动到一个插槽上，然后将其放入。使用链表，您可以这样做：告诉 9 后面的一个是 11，告诉 2 它后面的一个是 10，告诉 10 后面的那个是 3。

我现在正在使用其中的几个，因为添加项目非常容易，并且以编程方式说“对列表中的每个项目执行此操作”。其中之一是条目列表，就像在电子表格中一样。另一个，我通过查看第一个列表并添加对具有特定值的每个项目的引用，以便我可以对它们进行批处理操作。能够从中间取出项目，或者将它们添加到中间，而不必担心数组长度。根据我的经验，这些是主要优势。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-10-05T02:14:44.767

他确实要求举一个实际的例子。所以我会试一试：

假设您正在编写防火墙；在此防火墙中，您有一个 IP 白名单和一个 IP 黑名单。

您知道您的 IP、您的工作 IP 和一些测试 IP 需要被列入白名单。因此，您将所有 IP 添加到白名单中。

现在，您还有一个应该被阻止的已知 IP 列表。因此，您将这些 IP 添加到黑名单中。

为什么要为此使用 LinkedList？

1.  从列表中添加/删除项目的操作速度很快。
2.  您不知道有多少 IP 将被阻止/列入白名单。因此，揭示了 LinkedList 的主要优势之一（它是可调整大小的）。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-09-19T20:13:55.470

好吧，如果一个老师带他的学生去看卡通电影，但她找不到座位，她会让学生记住下一个学生的地址（座位号）等等……这样她就不会回去的时候遇到麻烦！！！

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2010-03-12T09:11:31.317

在操作系统中...人们可以使用链表来跟踪正在运行的进程以及正在休眠的进程...正在运行并想要休眠的进程...从跟踪运行的 LinkedList 中删除进程，一旦睡眠时间结束，将其添加回活动进程 LinkedList

也许较新的操作系统正在使用一些时髦的数据结构......可以在那里使用链表

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-12-04T22:25:24.940

我认为没有一个很好的类比可以突出与数组相反的两个重要特征：1\. 在当前项目之后插入效率高，2\. 通过索引查找特定项目效率低。

没有这样的事情，因为通常人们不会处理需要插入或定位特定项目的大量项目。例如，如果您有一袋沙子，那将是数亿粒沙子，但您不需要定位特定的沙粒，沙粒的顺序并不重要。

当您处理较小的馆藏时，您可以直观地找到所需的项目，或者，对于图书馆中的书籍，您将拥有一个类似字典的组织。

最接近的类比是有一个盲人检查链接的项目，如链节、项链上的珠子、火车车厢等。他可能正在寻找特定项目或需要在当前项目之后插入一个项目。最好补充一下，盲人可以很快地穿过它们，例如每秒一百万颗珠子，但一次只能感觉到一个链接，而看不到整个链条或其中的一部分。

请注意，这个类比类似于双链表，我想不出与单链表类似的类比，因为具有物理连接意味着能够回溯。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-08-18T08:40:27.720

考虑 2 个或更多具有 2 个或更多隔间的盒子。（在本例中，每个盒子将有 2 个隔间）第一个隔间将包含一些信息。一个数字或一个词。第二个隔间将包含一个指向下一个框的箭头，依此类推。

请注意，每个盒子可以包含多个隔间，其中包含箭头（指针）和信息（数据）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-03-13T19:31:26.123

将链表视为一种数据结构。这是OOD中表示自聚合的机制。你可能会认为它是现实世界的对象（对某些人来说它是现实）

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-03-13T19:13:57.443

我喜欢把循环链表想象成一条珍珠项链，每颗珍珠都包含一些数据。您只需跟随字符串到下一个数据珍珠，最终您会再次回到开头。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-05-07T07:29:55.793

链表的一个很好的例子是你的文本消息，其中某个包一条消息可能被分成几个包。每个数据包都包含一个密钥，该密钥连接到下一个密钥和第 n 个密钥，以生成包含密钥和数据的整个文本消息。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-05-24T16:19:39.287

他们一直在儿童学前班这样做。当他们在户外的路上或类似的地方时，每个孩子都被要求握住其他几个孩子的手。每个孩子都知道他或她应该握住谁的手。他们就这样过马路。我认为这是一个典型的双向链表示例。

# python - Python 如何对元组列表进行排序？

> ID：644170
> 
> 赞同：62
> 
> 时间：2009-03-13T19:09:17.423
> 
> 标签：python

根据经验，似乎 Python 的默认列表排序器在传递元组列表时，将按每个元组中的第一个元素进行排序。那是对的吗？如果不是，那么按元组的第一个元素对元组列表进行排序的正确方法是什么？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-03-13T19:13:49.673

它会自动按元组中的第一个元素对元组列表进行排序，然后按第二个元素排序，以此类推 tuple([1,2,3]) 将排在 tuple([1,2,4]) 之前。如果要覆盖此行为，请将可调用对象作为第二个参数传递给 sort 方法。此可调用对象应返回 1、-1、0。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T19:12:54.327

是的，这是默认设置。事实上，这就是 Python 中经典的“DSU”（装饰-排序-不装饰）习语的基础。请参阅[像 Pythonista 一样的代码](https://david.goodger.org/projects/pycon/2007/idiomatic/handout.html)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-13T19:13:52.217

不，元组是[序列类型](http://www.python.org/doc/2.5.2/lib/typesseq.html)，就像字符串一样。通过依次比较每个元素，它们的排序相同：

```
>>> import random
>>> sorted([(0,0,0,int(random.getrandbits(4))) for x in xrange(10)])
[(0, 0, 0, 0), (0, 0, 0, 4), (0, 0, 0, 5), (0, 0, 0, 7), (0, 0, 0, 8),
(0, 0, 0, 9), (0, 0, 0, 12), (0, 0, 0, 12), (0, 0, 0, 12), (0, 0, 0, 14)] 
```

三个零仅用于表明必须检查除第一个元素之外的其他内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T19:14:36.613

尝试使用内部列表排序方法并传递一个 lambda。如果您的元组第一个元素是整数，则应该可以。

```
# l is the list of tuples
l.sort(lambda x,y: x-y) 
```

您可以使用任何可调用的比较函数，不一定是 lambda。但是它需要返回 -1（小于）、0（等于）或 1（大于）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:44:55.680

查看“Devin Jeanpierre”对这个问题[sort-a-dictionary-in-python-by-the-value 的](https://stackoverflow.com/questions/613183/sort-a-dictionary-in-python-by-the-value)回答，他说要使用元组并展示如何按第二个值排序

# python - 如何重新映射 python dict 键

> ID：644178
> 
> 赞同：33
> 
> 时间：2009-03-13T19:11:21.850
> 
> 标签：python, dictionary, iterator

我正在开发一个程序，该程序（除其他外）读取一个 CSV 文件（它被存储为表单中的字典数组`[{col1:data1a,col2:data2a},{col1:data1b,col2:data2b}]`）。对于每一行，作为其他处理的一部分，我需要将这些键重新映射到用户输入的值，这些值在另一个 dict 中提供，因此它们可以用作 API 调用中的参数。映射数组的格式为： `{badname1:goodname1, badname2:goodname2,...}`。

所以我想从：

```
{badname1:data1, badname2:data2,...}` to `{goodname1:data1, goodname2:data2,...} 
```

我想使用类似的东西`zip()`（尽管`zip()`产量`{badname1:badname1,...}`）。

似乎应该有一个明显的解决方案在暗示我。

如果数据在`a`并且映射在`b`：

```
dict(zip(b,a.itervalues())) 
```

我接近了，但它只适用于已知字段与我认为的顺序相同的情况。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-13T19:43:15.517

```
name_map = {'oldcol1': 'newcol1', 'oldcol2': 'newcol2', 'oldcol3': 'newcol3'...}

for row in rows:
    # Each row is a dict of the form: {'oldcol1': '...', 'oldcol2': '...'}
    row = dict((name_map[name], val) for name, val in row.iteritems())
    ... 
```

或者在 Python2.7+ 中使用[Dict Comprehensions](http://www.python.org/dev/peps/pep-0274/)：

```
for row in rows:
    row = {name_map[name]: val for name, val in row.items()} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T20:12:39.830

```
rows = [{"col1":"data1a","col2":"data2a"},{"col1":"data1b","col2":"data2b"}]
name_map = {"col1":"newcol1","col2":"newcol2"}

new_rows = [dict(zip(map(lambda x: name_map[x], r.keys()), r.values())) for r in rows] 
```

这就是你所追求的吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-23T21:12:41.537

如果您使用的是 Python 2.7 或 Python 3.x，则可以使用[字典推导](http://en.wikipedia.org/wiki/List_comprehension#Dict_comprehension)。这等效于 elo80ka 的答案（它使用了列表理解），但产生的代码可读性更高。

```
name_map = {'oldcol1': 'newcol1', 'oldcol2': 'newcol2', 'oldcol3': 'newcol3'...}

for row in rows:
    # Each row is a dict of the form: {'oldcol1': '...', 'oldcol2': '...'}
    row = {name_map[name]: val for name, val in row.iteritems()}
    ... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-11-24T00:52:48.640

此功能将让您仅重新映射需要更改的键。

```
def key_remapper(dictionary: dict):
    return {remap_dictionary.get(k, v): v for k, v in dictionary.items()} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-17T16:40:38.080

蟒蛇 3.7

```
d = {'badname1': 'data1', 'badname2': 'data2'}
m = {'badname1': 'goodname1', 'badname2': 'goodname2'}

{ m[k]:d[k] for k in d } 
```

输出

```
{'goodname1': 'data1', 'goodname2': 'data2'} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-24T12:40:27.613

基于此[示例](https://www.mybluelinux.com/helpful-python-snippets-that-you-can-learn-in-60-seconds-or-less/#remap-python-dict-keys)：

```
edited_dict = {'oldname1': 'data1', 'oldname2': 'data2', 'goodname3': 'data3'}
remaped_key = {'oldname1': 'key_1', 'oldname2': 'key_2'}

{ remaped_key[key]:edited_dict[key] for key in edited_dict if key in remaped_key }
# output
{'key_1': 'data1', 'key_2': 'data2'}

# same result:
dict((remaped_key[key], edited_dict[key]) for key, value in edited_dict.items() if key in remaped_key)
# output
{'key_1': 'data1', 'key_2': 'data2'} 
```

或重新映射只想要的键：

```
edited_dict = {'oldname1': 'data1', 'oldname2': 'data2', 'goodname3': 'data3'}
remaped_key = {'oldname1': 'key_1', 'oldname2': 'key_2'}

dict((remaped_key[key], edited_dict[key]) if key in remaped_key else (key, value) for key, value in edited_dict.items())
# output
{'key_1': 'data1', 'key_2': 'data2', 'goodname3': 'data3'} 
```

# dotnetnuke - DotNetNuke 模块间通信

> ID：644198
> 
> 赞同：2
> 
> 时间：2009-03-13T19:16:01.650
> 
> 标签：dotnetnuke, dotnetnuke-module, dotnetnuke-imc

我正在考虑使用 DotNetNuke 4.8.4 进行模块间通信 - 并且想知道是否有人有任何这样做的好例子。

我知道您在发送者上实现了 IModuleCommunicator，在接收者上实现了 IModuleListener - 但除了将它们放在同一页面上之外，没有看到将它们联系在一起的方法。

给定页面上的所有监听器都监听给定页面上的所有发件人吗？如果是这样，过滤掉噪音的最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-14T16:23:37.993

昨晚我刚刚在[Mitchel Sellers](http://www.mitchelsellers.com/default.aspx) [DotNetNuke Module Programming](https://rads.stackoverflow.com/amzn/click/com/0470171162)一书中阅读 IMC。

以下是一些主要内容：

1.  仅适用于同一页面上的模块之间。
2.  AJAX 注意事项 - 可能不适用于部分回发
3.  引发的事件被发送到任何实现 IModuleListner 的模块，因此您必须确保您使用的是正确的东西。

以下是发送信息的示例：

```
if (ModuleCommunication != null)
{
 var args = new ModuleCommunicationEventArgs();
 args.Sender = "Something";
 args.Target = "Something Else";
 args.Text = "Something";
 args.Type = "Something";
 args.Value = new Object();
 ModuleCommunication(this, args);
} 
```

要过滤掉噪音，您需要确保包含一些非常具体的识别信息。尽管在设置要使用的 EventArgs 时，您似乎有很多机会这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:51:30.037

我个人没有使用过 IMC，但据我所知，所有的听众*都会*听所有的发件人。发送到侦听器的 ModuleCommunicationEventArgs 包括一个 Target 属性，我认为这应该是您首先要检查的内容，即检查此消息是否发给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-14T16:40:47.390

我使用[Open Web Studio](http://www.openwebstudio.com/)。这是一个有趣的工具，尽管它缺乏强大的文档。它使我能够在同一页面中通信两个 DotNetNuke 模块，并根据第一个单击的内容自动重新加载第二个模块的信息。我不知道这是否是你要找的。如果是这样，我可以给你一些更多的提示和一些关于如何让这个东西工作的教程的链接。

OWS 是免费的（有付费支持），但正如我所说，它缺乏深入的文档，尽管你可以通过一些耐心和大惊小怪来过去。

# c# - 如何向属性添加方法？

> ID：644201
> 
> 赞同：7
> 
> 时间：2009-03-13T19:16:42.537
> 
> 标签：c#, .net

假设我创建了一个具有属性的类：

```
public class User
{
   private string _userID;

   public string UserID
   {
      get { return _userID; }
      set { _userID = value; }
   }
} 
```

我与类和属性有什么关系才能将方法附加到 UserID 属性，例如使用“点”语法在用户 ID 周围生成 Xml 的方法：

```
User u = new User();
u.UserID = "Mike";
string xml = u.UserID.ToXml(); 
```

我可以弄清楚如何编写一个方法来将 Xml 标记放在 UserID 的值周围，我想知道的部分是如何使用“点”语法使该方法与属性一起工作。

* * *

所有这些答案都很有用，感谢大家的贡献。事实上，我标记为“接受”的答案正是我所寻找的。我很欣赏关于扩展方法的警告remakrs（在此之前我从未听说过），当然在某些情况下将扩展方法应用于所有字符串可能是一个问题，但在这种情况下，我绝对想应用该方法ToXml() 到类中的所有字符串属性。正是医生吩咐的。我对 XmlSerialization 非常熟悉，但在这种情况下，出于各种原因需要避免它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-13T19:19:32.703

有两种方法：

您正在操作的对象/值必须具有该方法（例如当您可以控制对象定义时。）

```
public class UserIDObject
{
   public string ToXML() {}
}

public class User
{
   private UserIDObject _userID;

   public UserIDObject UserID
   {
      get { return _userID; }
      set { _userID = value; }
   }
}

User u = new User();
u.UserID = = new UserIDObject("Mike");
string xml = u.UserID.ToXml(); 
```

或者，您可以为对象实现[扩展方法 (MSDN)](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。[Geeks with blogs 有一个很好的扩展方法](http://geekswithblogs.net/robp/archive/2007/12/20/using-extension-methods-in-.net-2.0-with-visual-studio-2008.aspx)教程，如果你运行的是 VS2008，它们可以应用于 .NET 2.0。

```
public static class MyMethods
{
    public static string ToXML(this string s) { }
} 
```

扩展方法是您想要重视的东西，因为扩展方法适用于该类类型的**所有对象。**（即，我是否希望所有字符串都能够调用 .ToXML()？）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T19:20:58.393

您可以：

1.  将 _userID 更改为自定义类，包装字符串并添加所需的方法。
2.  为字符串类做一个[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)（不推荐）。这将影响*所有*字符串对象

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T19:21:06.537

您必须将该方法添加到属性的**类型**中。在这种情况下，UserID 是一个字符串，因此这意味着将其添加到字符串类型并使其可以从*所有*字符串中访问。我不确定这是一个好主意，但如果你真的想要这样做：

```
public static class StringUtils
{
    public string ToXmlElement(this string s, string elementName)
    {
       return string.Format("<{0}>{1}</{0}>", elementName, s);
    }
} 
```

这与您的函数签名不完全匹配，但附加到更大的字符串类更有意义。唯一的其他选择是使用不同的基础类型来保存您的 UserID，也许是一个隐式转换为字符串的自定义类。

最后，如果您只是想以通用方式将用户类写入 Xml，请查看`System.Xml.Serialization`命名空间。然后你可以像这样标记你的类并使用`XmlSerializer`实例来读取或写入类。

```
[Serializable]
public class User
{
   private string _userID;

   [XmlElement()]
   public string UserID
   {
      get { return _userID; }
      set { _userID = value; }
   }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T19:21:08.363

好吧，简短的回答是，即使通过扩展方法可以实现，您也不想这样做。这是不好的形式，不一定是你想要的。

更好的技术将涉及利用 .NET XML 序列化并将其交给您的对象。它可以为您做 XML 魔术。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T19:29:23.600

在 C# 3.0 中，您基本上有几种完成此任务的方法，有些更直接且类似于您希望它的工作方式，有些则更少。首先，让我澄清一下为什么您可能不会立即明白如何完成这样的事情：

因为该`UserID`属性是类型`string`（如您所指定），所以它的所有成员都已定义，因此仅限于`String`（至少在传统的面向对象编程 [OOP] 中）的成员。这当然包括方法。您似乎想添加一个方法，如果没有访问属性的类型（在这种情况下）`ToXml`，这是不可能的。`System.String`

所以你的选择如下：

1.  将属性的类型更改为自定义类（即`UserIdentification`类）并将`ToXml`方法添加到此。老实说，在大多数情况下，这不是一个很好的解决方案，因为它增加了不必要的复杂性。仅当您需要添加与`UserID`.

2.  只需将该`ToXml`方法添加到您的 User 类中（并将其命名为`GetIdXmlString`）。一个不错的解决方案，可能是我在 C# 3.0 之前会选择的解决方案（可能仍然存在，具体取决于具体情况）。

3.  [扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。这是最新版本的 C# 中添加的一项很棒的功能，它允许您通过向现有类和接口添加使用特殊语法定义的方法来“扩展”现有类和接口。有关更多信息，请参阅链接文章，但您的扩展方法基本上如下所示：

    ```
    public static string ToXml(this string str)
    {
        // Code for function goes here.
    } 
    ```

    然后，您可以简单地调用此方法，就好像它实际上属于`string`该类一样。但是要小心，因为最后一种方法可能并不总是合适的（因为它可以应用于代码中*所有*字符串类型的对象）。如果您想编写一个通用的 ToXml 函数（带有重载？），将各种对象转换为您自己的自定义 XML 格式，那么公平，否则您可能会更好地使用第二个建议。辅助类是另一种选择，尽管语法稍差一些，但至少意味着 ToXml 方法不会出现在所有字符串中。

无论如何，希望这会有所帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T19:20:08.770

好吧，您不会使用*String*类型来执行此操作。您将创建一个新类，该类具有所有必要的字符串处理方法，但也实现了您的“ToXml()”方法。不幸的是，您不能从字符串类本身派生，因此您必须实现包装器方法或其他方式来提供您也想要的字符串处理功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T19:20:33.403

而不是一个字符串，你需要有一个真正支持 ToXml() 的类

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T20:05:09.817

我想你可能真的很狡猾，通过 AOP 删除属性，用具有正确方法的代理类替换属性。但即使你这样做了，你可能不得不将你的新属性转换为某个接口 - 实际上是双重转换，即

```
IXmlable x = (IXmlable)(object)this.UserId;
x.ToXml(); 
```

这可能会首先破坏这样做的意义。但是，嘿 - 至少你会得到关注点分离，对吧？

说真的，我会选择上面提到的其他更简单的选择。除非你想成为 AOP 大师，否则就是这样。:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T20:33:06.833

您可以创建一个`struct UserID`值类型，将方法添加到它并在您的类中使用它而不是`string`.

# open-source - 参与开源项目时最重要的一点是什么？

> ID：644202
> 
> 赞同：2
> 
> 时间：2009-03-13T19:16:47.467
> 
> 标签：open-source

免责声明：我**确实**检查了其他似乎相关的问题，但这个问题更广泛，更不具体，它的目标也完全不同（所以，请在删除之前先阅读！）：

现在，虽然有“[如何以聪明的方式提出问题](http://www.catb.org/~esr/faqs/smart-questions.html)”和“[如何有效地报告错误](http://www.chiark.greenend.org.uk/~sgtatham/bugs.html)”（两者在与用户交互时都非常有用），但似乎还没有一个类似的全面指南关于“如何成功参与开源项目”，专为有抱负的新贡献者编写。

那么，**您**认为在这样的指南中需要指出的最重要的因素、项目和挑战是什么？

我们的目标是提出一份关于为开源项目做出贡献的一般指南的综合指南列表，这些指南是为渴望参与其中的新用户/贡献者编写的。

理想情况下，开源项目可以简单地将新贡献者指向此问题的 stackoverflow 链接。

初学者的一些事情：

*   确定您的贡献的性质（源代码、文档、支持/帮助）
*   确定项目的需求
*   确定贡献时的技术要求（即构建环境）
*   确定正确贡献补丁的过程
*   指出社会挑战，限制因素 - 需要耐心......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:28:38.063

看看生产开源软件（[http://produceoss.com/](http://producingoss.com/)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T19:34:31.310

1.  了解版本控制
2.  文档可能是开始的好方法。它至少可以帮助您从可用性方面了解现有的东西
3.  了解项目周围的社区。他们会给新手开发新功能吗？如果没有，那么您将不得不考虑修复一些或更多现有的错误

我没有提到项目的技术要求，因为你想为项目做出贡献意味着，如果你已经阅读并理解了它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T19:25:43.373

我认为指南可以很容易地完成，甚至不会太长。事实上，我现在就试一试：

> 所以你已经决定要参与一个开源项目，但不知道从哪里开始。你并不孤单！你就是所谓的崇拜者。真的。代码可用。免费。使用该程序。阅读代码。修理东西。编写新代码。自己挠痒痒。如果您还没有这样做，那么诚实地默默地回答自己为什么不这样做。如果您使用了该程序，但没有任何东西跳起来并尖叫着要修复，那么您要么不合群，要么根本不是编码员。结束。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T19:59:40.593

1.  确保你喜欢这个主题、使用的技术等。
2.  确保你可以破解它。加入一个特定领域或技术上具有挑战性的项目可能会令人沮丧。
3.  确保您有时间实际做出贡献。当活动非常少时，我会习惯性地启动（并被启动）开源项目。

# java - Web应用程序JBoss 5中的资源注入

> ID：644205
> 
> 赞同：2
> 
> 时间：2009-03-13T19:18:24.610
> 
> 标签：java, jakarta-ee, jboss

是否可以在 JBoss 5 中运行的 Web 应用程序中使用 @Resource 注释注入资源（如消息队列、EJB）？webapp 是 .ear 文件的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T11:39:47.733

你遇到了什么特别的问题？我不认为“是”或“否”是你想要回答的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-15T02:10:28.253

为什么不尝试并找出答案？

（ps：答案是“是”）

# iphone - Hackintosh 上的 iPhone 开发

> ID：644225
> 
> 赞同：62
> 
> 时间：2009-03-13T19:22:06.410
> 
> 标签：iphone

我的问题是关于为 iPhone / iTouch 开发代码的。

随着 Apple 向英特尔平台的芯片过渡，现在显然可以在 PC 上运行他们的操作系统。

所以，有了这个，再加上我天生便宜的天性，我想知道是否可以通过在 Hackintosh 上运行 iPhone SDK 来绕过购买翻新的 Mac？

由于我现在更像是一个业余爱好者而不是一个认真的开发人员，所以我基本上想在完全致力于这项工作之前先弄湿自己的脚。从长远来看，我知道购买 Mac 会更好......

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-13T19:38:30.847

是的，这完全有可能。我在运行 iATKOS OSX 补丁的戴尔上开发了我的第一个应用程序。

是否值得真正归结为在您的 PC 上运行 hackintosh 安装 (Kalyway / iATKOS) 有多么困难。对于某些 PC，这很简单，一切正常。对于其他人来说，这是一场噩梦，您的网络/音频/图形将永远无法完全正常工作。如果您需要运行一个打补丁的内核（例如，您没有 Intel Core 2 Duo 芯片组），事情就会变得非常尴尬。

最好的办法是记下 PC 中的硬件，并在各种 OSX86 论坛上进行一些研究。

假设你让一切正常，未来唯一关心的是软件更新。iPhone SDK 通常需要最新的 OSX 更新（例如 10.5.6），但在带有补丁内核的 hackintoshes 上安装更新是一场噩梦。

如果你喜欢修补这种类型的东西，并且对你的硬盘分区和使用启动标志感到舒服，那么我会说去吧。如果没有，请考虑在 eBay/craigslist 或其他地方购买二手 Mac-Mini。如果您发现 iPhone 开发确实不适合您，那么您可以转售它，几乎不会有任何损失。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-13T19:30:11.693

是的，你可以，但要为自己节省一些时间和痛苦。

拿起 Mac mini 或 iMac。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-13T19:27:54.943

这是可能的。但是您只能选择 hackintosh 的硬件。即使你做对了，也没有人能保证一切都会正常工作（声音、局域网等）。如果您可以运行操作系统，则可以使用 SDK 运行 xcode。但我认为你不会对最终结果 100% 满意。

正如我所看到的，如果您想运行 os x，最好投资 mac mini，而不是购买 hackintosh 的硬件。假设您将购买 hackintosh 的所有组件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T19:37:16.153

我最近陷入了这种困境，在听了我朋友（专门为 iPhone 开发而做）的故事后，我决定使用真正的 Mac 而不是 Hackintosh。他能够让 iPhone 开发工作，但他的 hackintosh 总是有一个或另一个问题；最近的一个是不断的启动循环，其中机器将在加载操作系统后立即重新启动。

往好的方面看：Apple 产品很受欢迎且易于销售。如果你在下一代产品问世之前得到一个并卖掉它，你可以拿回大部分钱——这些钱本来会花在一个新的硬盘驱动器上（以隔离你的 hackintosh，呵呵）或 OSX（假设你打算得到该软件至少以远程合法的方式）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-11T11:19:26.480

是的你可以。我有。但是这值得吗？

如果你这样做是为了好玩，那是值得的。

如果你是为一台真正可用的 Mac 做这件事，那是不值得的。

现在你会有十亿人反对我说因为有些人已经建造了一些真正令人印象深刻的装备，但他们错过了 Mac 的意义。Mac 运行良好，使用起来很愉快，而 PC 只是完成任务，你可能暗地里讨厌它。

我这样做只是为了好玩，但我最终在 Hackintosh 上的花费比我刚购买 Mac Mini 时要多。当然，我的电脑速度快 4 倍，但它与真正的 Mac 不一样。在 Mac 上一切正常……真的很棒。但是在我的 Hackintosh 上，如果没有我的直接干预，什么都不会起作用……不是很好。

无论如何，我一直计划使用那台计算机进行 Windows 开发，因此这不是浪费，否则将是巨大的浪费。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-05-30T12:38:50.313

你能行的。我有 3 个我们开发的 hackintoshes，但归根结底，你需要一台真正的 mac 才能成为苹果开发人员。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-13T19:57:30.710

我看到的 Hackintosh 方法的一个问题是，如果你现在让它工作，那么当未来 Mac OS 的更新出现时，你不能保证同一台机器工作，如果 iPhone SDK 和/或您要使用的开发人员工具仅托管在下一代系统软件上。

从长远来看，我认为最好使用某种便宜的（甚至是二手的）Mac，比如 mini 或 MacBook。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-05-30T12:49:49.043

你可以做到，我开始使用虚拟机和 OSX 映像学习 iPhone/Objective-C/Cocoa 开发（虽然设置起来很痛苦，我想我只能使用 OSX 10.5.2）

不值得这么麻烦，最后我花了 365 英镑左右在 eBay 上买了一台 2007 年的二手 MacBook，从那以后它一直很顺利。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-09T06:57:53.043

在 10 美元的 P4 2.4GHz、1GB RAM 上，hackintosh 可以正常工作，xcode/iphone sdk 也可以。它有点慢，但稳定，对于那些只想测试 iphone 开发的水而无需投入现金的人来说，这是一个非常可行的选择。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-01-28T00:34:25.503

是的，就是你。现在我正在学习在 Hackintosh (iATKOS S3 version2) 中开发 iphone 应用程序。

有关安装 hackintosh 的任何问题，请参阅[http://wiki.osx86project.org/](http://wiki.osx86project.org/)和[http://insanelymac.com/](http://insanelymac.com/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-04-29T21:50:25.383

Hackintoshes 非常有价值。您可以花 400 美元到 4000 美元的任何价格购买一台功能强大的机器。

您想使用 Gigabyte 品牌的 Z87 主板、Intel Core i CPU、Nvidia 显卡和 SSD。避免预算硬件，它通常不兼容。或者你可以走英特尔 NUC 路线并获得一个 NUC、一个小型 PCIe SSD（32GB 或 64GB 应该可以解决问题）和一些笔记本电脑内存。

做你的研究，你很好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-22T11:12:11.497

当前版本的 Visual Studio (2019) 和 Xamarin Forms 将能够通过利用 Xamarin 热重启（预览版）功能来开发 iPhone 应用程序，而无需 Mac。

就我而言，我有一部 iPhone，并且想开发一个 iPhone 应用程序，但是我被迫（直到今天）购买一台 Mac（或至少选择 Hackintosh 方式）开发一个 iPhone 应用程序。现在我可以直接在我的 iPhone 上编写和调试我的应用程序（这很公平！）。

详细信息： [https ://nicksnettravels.builttoroam.com/ios-dev-no-mac](https://nicksnettravels.builttoroam.com/ios-dev-no-mac)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-03-13T19:49:23.410

如果您对自己的信心如此之低，以至于您觉得有必要通过一起破解伪 Mac 来节省几百美元，那么一开始就不要费心去尝试。

此外，您肯定会失败（或者花费大量时间试图成功，您浪费的时间比节省的成本要多得多）。两个敲门砖是

1.  您**必须**在 iPhone 或 touch 上运行代码，因为模拟器**并不**完美，甚至会在您不知道的情况下误导您 - 我有在模拟器上运行但在硬件上不如预期的代码

2.  Apple 的密钥签名很难使用真实的东西，我花了几个小时，而且我并不孤单 - 开发论坛上有很多帖子来自难以管理它的人。让它在被黑的机器上运行——你可能很幸运，但你准备好赌博了吗？

# ruby-on-rails - 夹具和 Selenium 和 Rails（哦，我的？）

> ID：644227
> 
> 赞同：10
> 
> 时间：2009-03-13T19:22:33.087
> 
> 标签：ruby-on-rails, ruby, selenium, fixtures

**你在 Rails 应用程序上的 Selenium 测试中使用了哪些数据？**你从固定装置加载吗？使用现有的开发数据库？使用单独的（非夹具）数据库？

我在这里考虑我的选择。我有一个带有大型 Selenium 测试套件的 Rails 应用程序，该套件在 Selenium Grid 的修改版本上运行。现在，该过程的一部分是在测试套件运行之前加载大量的固定装置。这是很多数据。其中大部分是报告从我们的生产数据库导出的信息。当我最初设置它时，我将数据从 Oracle 导出到 yaml。

现在一些报告表中的模式发生了变化，所以我当然必须重新生成夹具数据。它太多了，不值得手动编辑文件。但是对于每个小的模式更改都必须重新生成似乎效率低下 - 更不用说这是另一个需要记住的步骤。有没有更好的办法？

**编辑：**我最初打算在每次测试之前加载固定装置并在每次测试之后卸载它们，就像常规的 Rails 测试一样。但由于此报告数据，加载灯具大约需要 15 分钟。有 200 多个测试，套件每 12 小时运行一次。我不能弯曲时空队长！

**编辑2：**我也同意拥有这么多固定装置是一种难闻的气味。不过，我不确定如何减少它，因为报告汇总了大量数据，而硒测试的大部分价值在于它们测试了报告。

即使它是一小组数据，但是……它仍然是另一个与架构更改保持协调的数据集。（我们为单元、功能和 [Rails] 集成测试提供了一个单独的、较小的集合。）

这让我回到了我最初的问题——除了手工操作或记住每次都重新生成它们之外，还有其他选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T21:03:17.697

如果可以的话，最好的办法是拥有一个系统，在该系统中，每个 Selenium 测试都获得它自己的数据状态（即：删除并重新创建数据库表，重新插入引导数据，并清除缓存）。这说起来容易做起来难，通常只有在项目从一开始就计划好的情况下才有可能。

下一个最好的事情是为每个测试套件/运行提供一致的数据库状态。这不是那么好，因为现在很有可能某些测试将取决于先前运行的测试的成功，这使得识别真正的失败与假阴性变得更加困难。

IMO 最坏的情况是使用静态数据库，其中每次测试运行都会改变日期。这几乎总是会导致问题，并且通常是“项目气味”。以“正确方式”（同样，IMO）执行此操作的关键是对任何状态/模式更改保持警惕，并将其作为自动化测试/构建过程的一部分进行捕获。

Rails 已经在 Migrations 中做得很好，所以好好利用它们吧！在不了解您的情况的情况下，我通常会质疑是否需要针对完整数据库的快照运行 Selenium 测试。大多数数据库可以（或应该）被精简到小于 1MB 以进行自动化测试，从而使自动化模式迁移和数据重置更加高效。

我唯一一次看到为 Selenium 测试使用大量数据库的“有效”原因是当数据库本身包含大量“逻辑数据”时，其中的数据会影响应用程序流（想想：数据驱动的 UI）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T03:38:02.693

我想你在这里问了两个相互交织的问题，所以如果我要分解它：

*   您希望快速将测试数据输入和输出您的数据库，而夹具并没有为您做这件事。
*   您已经被架构更改所困扰，并且您希望确保无论您做什么都不需要以“摆弄测试数据......仍然”为主题的八次迭代:)

您在这里有几个替代方案，我在下面进行了讨论。因为您提到了 Oracle，所以我在这里使用 Oracle 技术，但对于其他数据库平台（例如 Postgresql）也是如此：

1.  调用 PL/SQL 脚本来生成数据的 Rake 测试，讨厌的可怕的邪恶想法，除非没有其他选择，否则不要这样做。我在一个需要加载数十亿行以进行某些基础架构架构测试的项目上做到了这一点。我仍然为它生闷气。
2.  将您的数据库转换为转储格式。对于快速二进制转储，请查看 exp/imp 和数据泵实用程序。这将允许您快速设置和拆卸数据库。当然，在我从事的一个 Rails 项目中，我们使用 rake 任务来 exp/imp 一个数据库，该数据库在一分钟内拥有大约 30 万条记录。还要检查 SQL *Loader，它是逻辑转储实用程序，因为它的逻辑速度较慢，并且需要您拥有控制脚本来帮助 SQL* Loader 理解转储。但是，逻辑转储的好处是您可以在它们上运行转换脚本以将数据转换为最新格式。遗憾的是，所有这些工具都像固定装置一样对模式的变化非常敏感。
3.  使用诸如[机械师](http://github.com/notahat/machinist/tree/master)或[工厂女孩](http://github.com/thoughtbot/factory_girl/tree/master)之类的插件来更好地生成数据。您仍然会受到使用 ActiveRecord 设置数据库的惩罚，但这些假对象生成器将帮助您与迁移保持密切联系，并且比固定装置更容易维护。
4.  结合方法 2 和 3。这里发生的情况是您使用 Machinst 生成一些测试数据。您将该测试数据导出到转储，然后在每次测试运行期间重新加载转储。当架构更改时，更新机械师配置并重新导出。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T19:38:23.890

我目前在一个项目中使用了一个巨大的 Selenium 测试套件——实际上，它就是为 Selenium Grid 编写的——我们的测试使用少量的参考数据（尽管我们不使用 Rails YAML 固定装置）和对象工厂用于特定测试所需的一次性数据。

或者，在我参与的许多 ThoughtWorks Rails 项目中，我们编写了包含许多预提交挂钩的签入脚本——例如，在允许提交之前运行测试。您可能会考虑尝试的一件事是编写（或定制）一个类似的签入脚本，该脚本将检查架构更改并根据需要重新加载参考数据。

参见例如 Paul Gross在 Github 上的[rake commit tasks 。](http://github.com/pgr0ss/rake_commit_tasks/tree/master)

# c - 将 pthread 程序转换为 MPI？

> ID：644230
> 
> 赞同：0
> 
> 时间：2009-03-13T19:23:18.357
> 
> 标签：c, refactoring, pthreads, cluster-computing

我了解多线程程序和依赖机器间通信的程序之间的区别。我的问题是我有一个很好的用“C”编写的多线程程序，它在 8 核机器上运行良好。现在有机会将此程序移植到集群以访问更多内核。是否值得努力撕掉 pthread 的东西并改造 MPI（我从未使用过），或者我们最好从头开始重新编码整个东西（或大部分）？假设我们被 C “卡住”了，所以不能选择大规模改变语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T19:31:31.690

根据您的软件的编写方式，使用 MPI 可能比保留 pthread 实现更有优势，也可能没有优势。

不幸的是（或幸运的是），消息传递与 pthreading 完全不同——基本假设完全不同。我喜欢[Maestro 团队的 Joshua Phillips 的这句话](http://blogs.msdn.com/maestroteam/archive/2009/02/27/we-haven-t-forgotten-about-other-models-honest.aspx)：“消息传递和共享状态通信之间的区别等同于向同事发送电子邮件要求她完成任务和打开她的组织者来写的区别将任务直接放在她的待办事项列表中。不只是粗鲁，后者可能会让她感到困惑——她可能会抹去它，没有注意到它，或者不小心把它的优先顺序放错了。”

不幸的是，您共享数据的方式非常不同。无法直接访问其他线程中的数据（因为它可以在其他机器上），因此从 pthread 迁移到 MPI 可能是一项非常艰巨的任务。另一方面，如果代码是这样编写的，每个线程都是隔离的，这可能是一件容易的事，而且绝对值得。

为了确定这将有多大用处，您需要了解代码，以及您希望通过切换实现什么。作为一种学习体验可能是值得的（通过在 MPI 中工作，您学到了很多关于同步和线程的知识），但如果收获很小，则可能不实用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:48:55.767

关于。您对 Reed 的评论——这听起来像是一个简单、低开销的 MPI 转换。请注意：并非所有 MPI API 都支持动态创建进程，即，您使用 N 个进程（在启动时指定）启动程序，并且在程序的整个生命周期中都被 N 个进程困住。

# python - 您如何为非技术客户提供 Django [或 Ruby on Rails] 的案例

> ID：644237
> 
> 赞同：14
> 
> 时间：2009-03-13T19:25:13.610
> 
> 标签：python, ruby-on-rails, ruby, django

商人通常希望开发一个 Web 应用程序。他们知道 .net 或 J2EE 的名称，但对两者都不太了解。

Altho' Rails 和 Django 提供了更好更快的开发堆栈，说服商人使用这些平台是一项艰巨的任务。

任务从介绍 Django（或 Rails）开始，引用一些博客/研究。然后为具体项目使用框架做一个案例。

很多任务都是重复的。您用来为 django（或 Rails）提供案例的来源/博客/白皮书和其他材料是什么

你不认为应该有一个共同的小册子，许多开发机构可以用它来制作同样的案例，一遍又一遍。现在有这样的吗？

关于 Django vs Rails 似乎有足够的讨论。虽然需要（Django 和 Rails）与（.net 和 J2EE），但至少在制作业务案例时是这样。两者都代表了动态语言中更快的实用 Web 开发。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-13T19:43:53.907

请求宽恕比请求许可更容易。

首先，在 Django 中构建初始版本。迅速地。很好地构建模型（真的很好！）。但尽可能多地使用默认管理功能。

只花时间报告和显示 HTML 可能对演示实际上很重要的页面。

展示这一点，他们只会想要更多。一旦他们沉迷于快速周转和正确的开箱即用操作，您就可以与他们讨论技术。到时候就无所谓了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-13T19:40:58.860

你需要说商业语言：钱。

**“如果我们使用 Rails，它的成本将比 Java 中的相同功能低 50%。”**

您的百​​分比可能会有所不同，您可能还需要包括托管和维护成本，以显示它是如何平衡的。

当你说服其他程序员时，当然要谈论开发速度和重复性任务的自动化。但是要和商务人士谈谈底线成本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T20:04:37.493

在开始为 Django 或 Rails 做案例之前，您必须首先确信它是满足业务人员需求的正确堆栈。如果业务人员是企业家，他可能还有其他因素超出了解决方案的开发速度。例如：

1.  如果它是一个正在开发的企业游戏（例如 SalesForce.com、SugarCRM 等），用 Java 编写它可能是有意义的，因为这使得潜在的基于 Java 的追求者的收购和合并更容易。
2.  如果它是大型公司定制解决方案的内部 IT 游戏，他们可能已经拥有大量的 MS 基础架构。让您的客户端安装 SQLServer 或使用 Rails/Django 友好的堆栈进一步复杂化他们的堆栈可能没有意义。

如果您已经跨越了这个鸿沟，并且确信您的客户的最大利益是最重要的，那么我会在 Internet 上寻找使用 Java 和 Rails/Django 编写相同应用程序的示例。这是在 Rails 中实现的 Pet Store 示例。

[http://www.anassina.com/projects/railspetstore/](http://www.anassina.com/projects/railspetstore/)

您可以下载源代码并向您的客户展示实现相同结果所需的代码少了多少。

向客户解释为什么更少的代码是有价值的：你写的代码越少，你的错误就越少。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T19:35:42.493

我脑海中的前两个论点：

1.  更容易和更快的开发 = 更便宜的产品，更短的上市时间。

2.  开箱即用的 SO 优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-14T16:15:27.670

虽然你们中的许多人提出了一些很好的建议，WRT 使用这些框架的谈话/资源，你也可能注意到看看[关于重新设计 ROR 中的黄页](http://www.infoq.com/presentations/straw-yellowpages)的谈话：

网站总结：

> 本演讲解释了美国流量最高的网站之一 YELLOWPAGES.COM 如何使用 Ruby on Rails 编写，如何扩展以处理流量以及软件架构如何演变。另外：选择 Ruby on Rails 的原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T19:33:08.037

这些框架中的任何一个的最佳案例是它们能够自动执行重复且耗时的任务。这使开发人员能够更快、更高效，这反过来意味着项目可以更快地交付。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T19:42:25.237

“小册子”方法的问题在于它不能满足客户的需求。将选择的语言/平台放入解决客户目标的演示文稿中更有可能出售它们 - 无论是在您想要使用的工具上，还是在您作为供应商的情况下。只要你能证明你的方法能解决问题（最好用最少的费用），你就会有更少的反对意见和更少的“但我听说 xxx 是最好的”。

# java - 如何使用 Java 通过 USB 端口与设备通信？

> ID：644241
> 
> 赞同：9
> 
> 时间：2009-03-13T19:25:56.510
> 
> 标签：java, usb, mobile-devices

我最近才学习 Java，并尝试通过 USB 端口连接与设备通信。我已经将 C# 与 OpenNETCF 一起使用，它允许我通过 USB 端口在设备上发送文件和检索文件；我怎样才能用java实现这一点？

我在 stackoverflow 线程上搜索，[如何在 Windows 和 Java 下与 USB 设备通信？](https://stackoverflow.com/questions/544507/how-to-communicate-with-a-usb-device-under-windows-and-java)，christoffer 的评论是要破解本机代码，但我不太清楚他指的是哪个本机代码 api。RAPI，也许吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:54:37.953

我能找到的唯一适用于 Windows 的 USB API[在这里](http://www.steelbrothers.ch/jusb/)。似乎它的功能有限，但它可能适合您的需求。还提供了更完整的[UNIX API](http://jusb.sourceforge.net/)。

**ETA**：找到官方[Java USB 实现](http://javax-usb.org/)的链接，但看起来 windows 版本仍处于 alpha 阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T16:38:05.497

快速思考一下，您可以使用 JNI，即 Java 原生接口。不过我自己从来没有用过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-26T15:18:32.663

我发现这个页面解释了如何在微控制器和 java 应用程序之间执行通信：http: [//javausbapi.blogspot.com/](http://javausbapi.blogspot.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T21:25:15.253

我提到的本机代码 API 是 Windows DDK，即驱动程序开发工具包。现代版本似乎被称为 Windows Driver Kit，所以 google for Windows WDK :) 应该有一些关于如何与 USB 设备通信的 C 示例，并且从这些示例中编写 JNI 包装器应该非常简单。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-24T18:11:22.080

我发现与 USB 通信的最佳方式是通过 RxTx 库。

您可以在此处找到使用示例： [http ://www.snip2code.com/Snippet/1044/Java--read-from-USB-using-RXTX-library](http://www.snip2code.com/Snippet/1044/Java--read-from-USB-using-RXTX-library)

# javascript - 为什么我的日期解析不正确？

> ID：644243
> 
> 赞同：3
> 
> 时间：2009-03-13T19:26:23.810
> 
> 标签：javascript

我在解析 2000 年 1 月 1 日之后的日期时遇到问题。结果返回不正确。1999 被解析为 1999 年，当它到达 2000 时，它被解析为 0100，然后 2001 被解析为 0101，等等。下面是说明这个问题的测试代码：

```
<script type="text/javascript" language="javascript">

// functions incorrect  changes year from 2010 to 0101
var d = (new Date("12/01/2009"));
if (d.getMonth() < 11) 
 { d = new Date(d.getYear(), d.getMonth() + 1, 1); } 
 else
 { d = new Date(d.getYear() + 1, 0, 1); } 
document.write(d);
//  Result:  Sat Jan 01 0101 00:00:00 GMT-0500 (Eastern Standard Time) 

document.write('<br />');

document.write(Date.parse(Date()) < Date.parse(d));
// 
// Result: false  today should definitely be < 01/01/2010

document.write('<br />');

// Functions correctly if year is before 2000

var d = (new Date("12/01/1998"));

if (d.getMonth() < 11) 
 { d = new Date(d.getYear(), d.getMonth() + 1, 1); } 
 else
 { d = new Date(d.getYear() + 1, 0, 1); } 

document.write(d);
//  Result:  Fri Jan 01 1999 00:00:00 GMT-0500 (Eastern Standard Time)  
document.write('<br />');

document.write(Date.parse(Date()) < Date.parse(d));
// false

</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T19:29:30.447

您需要使用 d.getFullYear() 而不是 d.getYear()

getYear() 显然只给出自 1900 年以来的年数；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T19:33:19.207

你应该使用`Date.parse()`. 您看到奇怪结果的部分原因是因为您`new Date("12/01/2009")`在顶部用尽并将其他所有内容与此进行比较。请注意，它`Date.parse()`返回一个数字，而不是日期对象。因此，为您的第一个任务执行此操作：

```
var d = new Date(Date.parse("12/01/2009")); 
```

下一部分是您需要该`getFullYear()`函数而不仅仅是`getYear()`，尽管您的问题仅在于您的验证码，而不在于您实际解析日期的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T19:32:58.287

getYear() 返回的内容取决于浏览器。尝试 d.getFullYear() 代替。

合理的 Javascript 日期参考：[http ://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp)

# dotnetnuke - DNN 5 - 角色已过期，但用户仍可查看页面

> ID：644254
> 
> 赞同：1
> 
> 时间：2009-03-13T19:28:31.370
> 
> 标签：dotnetnuke, subscription, security-roles, dotnetnuke-5

我正在 DNN 5 中测试定期费用订阅。我已将自定义角色的续订期设置为 1 天。

1 天后，订阅显示为 EXPIRED，但用户仍可以查看该角色可访问的所有页面。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:34:46.300

显然，DNN 检查 WEB-SERVER 上的订阅到期时间，以及 DB-SERVER 上的“查看权限”。

我更改了我的网络服务器上的日期，因此我不必等待 1 天角色到期。一旦我更改了数据库服务器上的日期，我就无法再查看这些页面了。

# c# - 如何获取特定的套接字并关闭它

> ID：644256
> 
> 赞同：1
> 
> 时间：2009-03-13T19:28:33.353
> 
> 标签：c#, .net-3.5, sockets

我想关闭一个套接字，这样我就可以在同一个端口上重新打开一个，但我没有那个套接字的句柄。

如何让正在监听 localhost:873 的套接字关闭它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T19:31:47.527

如果没有内核驱动程序，这是不可能的。在 Windows 中，在另一个进程中获取套接字句柄并主动关闭它是不合法的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:46:23.637

只有拥有套接字的进程才能关闭它，所以你所能尝试的就是结束拥有套接字的进程。

`-o`在命令行中，您可以使用to 选项找到使用特定套接字的进程的进程 ID `netstat`。例如：

```
netstat -noa | findstr LISTENING 
```

不过，我不知道您如何在 .NET 中以编程方式执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T19:45:29.020

您可以调查[SO_REUSEADDR](http://blogs.msdn.com/wndp/archive/2005/08/03/Anthony-Jones.aspx)。

# java - Eclipse 中针对已弃用成员的 F2 焦点

> ID：644262
> 
> 赞同：4
> 
> 时间：2009-03-13T19:29:47.780
> 
> 标签：java, eclipse

在 Eclipse 中，F2/焦点或悬停在成员上会为您提供一个带有 javadocs 的弹出窗口。但是，如果该成员已弃用，您只会收到类似“该字段 blahblah 已弃用”的消息。

有谁知道这是否是一个已知的错误/功能？如果是，是否有一个方便的快捷方式来为已弃用的成员获取 javadoc 弹出窗口？

通常，不推荐使用的成员的替代用途是在 @deprecated javadoc 标记中。因此产生了兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:55:49.450

即使在最新的 3.5 版本中，您也确实会观察到这种行为。

一种解决方案是单击该函数并打开 javadoc 视图。
即使该方法已被弃用，javadoc 也会显示在 javadoc 视图中。

[替代文本 http://help.eclipse.org/help32/topic/org.eclipse.jdt.doc.user/tips/images/JavadocView.png](http://help.eclipse.org/help32/topic/org.eclipse.jdt.doc.user/tips/images/JavadocView.png)

* * *

另一种解决方案：

`Preferences > General > Editors > Text Editors >`**`Annotations`**：

**单击警告，取消选择“文本为”**。

下划线消失，您可以将鼠标悬停在 F2/focus 视图中查看 javadoc。

# terminal-services - 什么是 X 服务器和远程终端服务器？

> ID：644264
> 
> 赞同：6
> 
> 时间：2009-03-13T19:30:07.530
> 
> 标签：terminal-services, xserver

有人可以简单地解释 X 服务器和远程终端服务器之间的区别吗？

例如，Hummingbird Exceed 是 X 服务器，Citrix 是远程终端服务器。这些服务器是如何工作的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T19:53:44.960

当您使用远程桌面客户端查看另一台机器的屏幕时，终端服务器在“另一台”机器上运行。

AX 服务器（X11 窗口系统）在您的机器上运行，而另一台机器（或多台）将它们的输出发送到您的计算机。

对最终用户来说最重要的区别可能是“文化”：使用 X Window 系统，您通常使用在多个主机上运行的窗口。（你经常坐在一个非常精简的工作站前，从一台计算机上获取一个应用程序，从另一台计算机上获取另一个应用程序。）使用 X 时，感觉非常异构 - 一个特殊的应用程序只在 HP 工作站上运行，而你的公司却很忙用 suns 还是 linux 盒子？没问题，只需购买一台 HP，任何人都可以像在本地一样通过网络使用该应用程序。）

远程终端服务更像是另一台计算机将其完整的屏幕发送给您，更像是您有一个 100 英里长的显示器和 USB 电缆（内置有一点延迟）。您通常使用向您发送完整桌面的远程桌面客户端。

然而最近这两种技术接近于另一种——windows远程桌面（基于citrix）只能将应用程序窗口发送到您的桌面，而许多基于X11的程序理论上是网络透明的，但实际上需要在本地运行机器。（抱歉，网络上没有 3D 射击游戏 - 一个极端的例子）。

哪一个更好？我不敢说。White X11 更加灵活（它的设计考虑了网络透明性 - 应用程序在本地或远程运行绝对没有区别 - 它在许多方面更加复杂。只要没有远程桌面共享，就有一个明显的优势，但差距正在逐渐缩小，例如终端服务现在允许您执行许多仅在早期 X11 可用的事情。）

顺便说一句，许多 X11 应用程序在网络上仍然比 Windows 同行感觉更“敏捷”的主要原因是许多 Windows 应用程序程序员仍然认为他们总是在本地运行并在屏幕上转储大量位图图形 - 比如ZIP 工具中的自定义工具栏。X11 应用程序很久没有这样做了，选择了“丑陋但快速”，因为 X11 迫使您考虑网络。但是随着 X11 应用程序变得更漂亮和 Windows 程序员对终端服务更加了解，这种差异将会缩小。

哦，还有一点很重要：X11 在 Unix 中根深蒂固，Citrix 主要用于 Windows（以 Microsoft 的 Windows 终端服务的形式——起源于 Citrix 代码）。因此，将终端服务管理员和 X11 操作员锁在笼子里，当他们弄清楚他们被关在谁身边时，退后一步观看流血事件……

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T19:36:54.080

X 服务器很可能是指 X11 窗口系统，这是大多数 unix 风格（包括 linux）使用的 GUI。这是一个客户端/服务器设置，并且已经存在了很长时间

Citrix 的远程终端服务器是一个远程 Windows 实例，可以通过特殊的 Citrix 客户端连接。我熟悉的 Citrix 环境都是 MS Windows 解决方案，即它们的工作方式类似于 X，但仅适用于 Windows 服务器

它们都以类似的方式运行，为远程客户端提供窗口解决方案。IE，它们都让服务器运行实际应用程序，而该应用程序的*显示*通过网络发送回客户端 PC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:29:14.033

所谓的“终端服务器”基本上允许您远程连接到 Windows 会话。他们使用了一些魔法来使体验在具有延迟的连接上变得敏捷。Windows GUI 系统不像 X 那样是网络透明的，因此获得此功能需要更长的时间。与传统的终端服务器不同，Windows Server 2008 和 Citrix 产品能够让您使用单个应用程序。

X 是 Unix/Linux 的 GUI 协议。X 服务器接受连接并显示它们的窗口。客户实际上就是程序本身。这些客户端可以是本地的或远程的，这对 X 无关紧要。X 只是根据请求在本地屏幕上或通过 TCP 连接显示它们。这是比终端服务器低级的东西，它允许图形程序在一台机器上运行并在另一台机器上显示。X11 不像 RDP 那样压缩或加密流量（尽管 SSH 可以帮助你）。

RDP 的 linux 等效项是[NX](http://www.nomachine.com/)。他们提供免费软件来运行 NX 服务器/客户端。我已经使用它并且效果很好。

# silverlight - 如何获得价值 我对 Silverlight 很陌生，现在才意识到 Silverlight 2 中有一个密码框控件。但是关于如何从这个控件中获取值的文章并不多。是不是类似于TextBox控件。我可以使用 .text 属性来获取值（但智能感知不显示此属性）吗？

> ID：644267
> 
> 赞同：3
> 
> 时间：2009-03-13T19:31:16.327
> 
> 标签：silverlight, passwordbox

我对 Silverlight 很陌生，现在才意识到 Silverlight 2 中有一个密码框控件。但是关于如何从这个控件中获取值的文章并不多。是不是类似于TextBox控件。我可以使用 .text 属性来获取值（但智能感知不显示此属性）吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T19:34:33.633

我怀疑你想要[Password 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.passwordbox.password(VS.95).aspx)。

# asp.net - 冻结母版页顶部的 div

> ID：644282
> 
> 赞同：1
> 
> 时间：2009-03-13T19:33:25.807
> 
> 标签：asp.net, css, master-pages

如何冻结 MasterPage 的顶部以使菜单不会滚动到屏幕外？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T19:38:22.877

[CSS 固定标题布局](http://limpid.nl/lab/css/fixed/header)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:38:22.470

您可以使用 position:fixed css 样式，但这仅适用于现代浏览器（FF3、IE7）。如果您想支持较旧的浏览器，则必须使用 Javascript 等获得更多创意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T19:40:56.210

如果你想支持更多的浏览器，你还可以看看 免费的 ASP.NET Ajax Toolkit 附带的[AlwaysVisibleControl](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AlwaysVisibleControl/AlwaysVisibleControl.aspx)

# asp.net - 针对 WPF 和 Web 应用程序的最佳方式是什么？

> ID：644313
> 
> 赞同：1
> 
> 时间：2009-03-13T19:42:53.100
> 
> 标签：asp.net, wpf, design-patterns

我们目前正在设计一个业务应用程序，它的 UI 有两个主要要求：

1）在**桌面上运行（WPF）**为企业用户提供丰富的用户界面，与其他应用程序互操作，访问文件系统，离线工作，与特殊的本地硬件一起工作等。

2) 在**ASP.NET/Ajax**上运行以向客户（互联网）提供此应用程序的几个组件。不幸的是，Silverlight（还）不是一个选项。

尽管我们不必在 Web 上提供完整的应用程序，但其中一些组件相当复杂，我们希望与 WPF 实现*共享尽可能多的 UI 代码。*

为了达到这个目标，我们有哪些选择？是否有一种模式适用于这两种技术？

更新：

感谢您的答案，即使它们不包括我正在寻找的答案！:)

我不认为**UI 生成器**是一个好的选择。就像 Eduardo 指出的那样，您最终可能会在两个世界中遇到问题。不过我会看看雕塑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:52:38.287

我一直在沿着这些思路思考一段时间，但我还没有想出一个*很好的*答案。话虽如此，以下是我的一些想法：

如果您使用了各种 MVP/MVC/MVVM UI 方法的一些变体，并且您在这种方法中非常自律（即不将演示内容与行为内容混为一谈），那么您可能会走得更远。

您可能会考虑研究已经出现的各种 DSL 工具包，其想法是创建一种简单的“语言”来在较高级别描述您的 UI，并在 WPF/ASPX 中生成该 UI 的表示。

另外，我最近遇到了[这个。](http://sculpture.codeplex.com/)我不知道它有多好。我打算一有机会就仔细看看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T04:11:27.557

祝你好运！

不幸的事实是，Asp.net/ajax（一般的网络）和 WPF（见鬼，让我们把 WinForms 扔在那里作为一个很好的衡量标准）有非常不同的用户界面模型，并且对一个人有效的不一定是为他人工作。这并不是说您不能在为任何一种技术编写的应用程序之间共享逻辑，但是，我会在这里延伸一下，您的 UI 逻辑不会属于该类别。

我最近一直在为 WPF 和 ASP.Net MVC 使用 MVVM 的变体，我想说它们非常适合手头的技术。然而，虽然它们非常相似，但它们也有区别，我不确定您是否可以编写一个抽象层（在任何相当长的时间内）来利用这两种技术的强大功能。

最后，我想说，最好的办法是遵循一些 SOA 模式，并将尽可能多的业务和数据访问逻辑提取到公共库中。然后，在 WPF 和 Asp.net 中编写单独的用户界面以利用这些公共库。这就是我的公司目前正在采取的方法，而且它的工作方式很有魅力。

编写两次 UI 逻辑似乎令人生畏（一次用于 asp.net，一次用于 wpf），但我认为这是值得的，这样您的代码才能适合最适合这些技术的模式和实践。

顺便说一句，即使 Silverlight 不是一个选项，您是否考虑过 XBAP？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T11:59:11.577

如果以前的工作我们做了类似的事情。正如 Daniel Pratt 所说，我们用 XML 描述我们的接口，然后渲染将创建表单、报告或我们决定创建的任何内容。

我们必须提供一个 Javascript 函数来在 HTML 渲染中进行一些 UI 验证，并在 Swing 渲染中调用一个 java 函数。

请注意，您可能会在两个世界中都以不完美的应用程序告终。

# xml - 我可以在 RSS 项目中添加自己的标签吗？

> ID：644315
> 
> 赞同：1
> 
> 时间：2009-03-13T19:43:53.423
> 
> 标签：xml, rss

在 rss xml 文件中，我有我的频道和几个项目。通常，该项目有一个标题、链接、描述，也许还有时间或其他东西。我可以把我自己的标签和我想发送的其他数据一起放在那里吗？

示例：假设正在做一个包含天气/温度信息的 RSS 提要，我可能有几个项目标签，每个城市都有一个。然后在描述中我会有我的字符串描述。但是，如果我也想为温度、风速、高、低、inchesOfRain 等放置单独的标签，我可以在其他客户端上进行不同的解析。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T20:17:03.720

是的，您可以 - 为您的标签创建一个新的命名空间（它是标准 XML）。

一个例子：

```
<?xml version="1.0"?>
<rss version="2.0" xmlns:w="http://tempuri.org">
    <channel>
        ...
        <item>
            <title>Item title</title>
            <description>...</description>
            <w:temperature>...</w:temperature>
            <w:windspeed>...</w:windspeed>
        </item>
    </channel>
</rss> 
```

也就是说，也许您应该先进行一些搜索，看看是否存在满足您需求的现有格式。标准 == 好 :)

请参阅[http://www.feedforall.com/namespaces.htm](http://www.feedforall.com/namespaces.htm)、 [http://base.google.co.uk/support/bin/answer.py ?answer=58085&hl=en_GB](http://base.google.co.uk/support/bin/answer.py?answer=58085&hl=en_GB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:55:54.487

这是你要找的吗？

[http://cyber.law.harvard.edu/rss/rss.html#extendingRss](http://cyber.law.harvard.edu/rss/rss.html#extendingRss)

我认为 Atom 也有类似的东西。您可以在此处查看 Atom 的规范：

[http://tools.ietf.org/rfc/rfc4287.txt](http://tools.ietf.org/rfc/rfc4287.txt)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T19:46:21.593

如果您想要天气 RSS 提要的示例，您绝对应该查看由[http://www.weather.com上的天气频道生成的 RSS 提要](http://www.weather.com)

我记得几年前使用这些为我帮助制作的一个小城市网站生成天气小部件。我们将解析 RSS 提要以获取我们特定邮政编码天气的温度和云覆盖率。

# c# - 我可以集成到我的 asp.net 项目中的 asp.net c# 论坛软件？

> ID：644317
> 
> 赞同：4
> 
> 时间：2009-03-13T19:44:29.803
> 
> 标签：c#, asp.net

我正在为 asp.net 寻找免费/开放或封闭的论坛软件。我发现的大多数都需要 PHP 和 MySql。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T19:49:52.787

[http://www.yetanotherforum.net/](http://www.yetanotherforum.net/) - Yet Another Forum 是一个非常流行的基于 ASP.NET 的论坛包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T08:04:15.827

您可能想尝试“Jitbit AspNetForum” [http://www.jitbit.com/asp-net-forum/](http://www.jitbit.com/asp-net-forum/)我们使用它多年，他们有一个免费的评估版（功能齐全）。它还收到了 Scott Hanselman 的好评[http://www.hanselman.com/blog/HanselmanForumsAspNetForumFromJitBit.aspx](http://www.hanselman.com/blog/HanselmanForumsAspNetForumFromJitBit.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:41:46.157

Codeplex 有几个：[这里](http://www.codeplex.com/site/search?projectSearchText=forum&sortBy=Relevance&licenses=|)

Chad Moran 提到了一个很好的，但我将链接到我找到它的 c# 开源论坛（只是因为该网站是一个很好的了解）

[又一个论坛网](http://www.csharpopensource.com/csharpforumcode.aspx)

# java - 哪些设置会影响已编译的 java .class 文件的布局？你怎么知道两个编译的类是否相等？

> ID：644320
> 
> 赞同：4
> 
> 时间：2009-03-13T19:45:00.910
> 
> 标签：java, compiler-construction, comparison, bytecode, javac

我有一个使用内置 Eclipse“编译”任务编译的应用程序。然后我决定将构建过程移到 Ant 中`javac`，结果文件变小了。

后来我发现将调试级别调整为`"vars,lines,source"`可以嵌入与 Eclipse 相同的调试信息，并且在很多情况下，文件的大小完全相同，但内部布局不同。因此，我无法使用 md5sum 签名来确定它们是否完全相同。

除了调试信息之外，两个据称相等的文件获得不同的内部布局或大小的原因可能是什么？

以及如何比较已编译的 .class 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:41:54.423

诸如常量池条目的顺序（基本上是所有符号信息）以及每个字段/方法/类的属性之类的东西没有必需的顺序。不同的编译器可以按照他们想要的任何顺序自由地写出来。

您可以比较已编译的类，但您需要深入研究类文件结构并对其进行解析。有一些图书馆可以做到这一点，比如[BCEL](http://jakarta.apache.org/bcel/)或[ASM](http://asm.objectweb.org/)，但我不能 100% 确定它们会帮助你完成你想做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T22:02:20.610

ASM Eclipse[插件](http://andrei.gmxhome.de/bytecode/index.html)中有一个字节码比较器。您选择两个类，单击鼠标右键，然后进行比较/彼此字节码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T22:19:43.783

需要注意的重要一点是 Eclipse 不使用 javac。Eclipse 有自己的编译器[JDT](http://www.eclipse.org/jdt/core/index.php)，因此生成的 .class 文件中的差异并不让我感到惊讶。我希望它们不是逐字记录，因为它们是不同的编译器。

由于它们的差异，存在使用 javac 而不是 JDT 编译的代码，反之亦然。通常，在大量使用泛型的情况下，我已经看到两者的差异变得明显

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T20:08:47.407

最重要的是，在不改变代码语义的情况下，局部变量的栈槽可以任意排列。所以基本上，如果不解析和规范化它们，你就无法比较编译的类文件 - 相当多的努力。

你为什么要这样做呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T20:45:59.377

正如 Michale B 所说，它可以是任意的。

我在使用文件大小作为安全性的系统上工作。如果 .class 文件的大小发生变化，则不会授予该类某些权限。

通常这很容易解决，但我们可以完全控制环境，所以它实际上非常实用。

无论如何，每当重新编译所监视的类时，我们似乎都必须重新计算大小。

另一件事——编译文件时会生成一个特殊的密钥编号。我对此了解不多，但它经常阻止类一起工作。我相信程序是，编译A类并保存它（称之为a1）。再次编译 a 类（a2）。针对类 a2 编译类 b。尝试对 a1 运行 b。我相信在这种情况下它会在运行时失败。

如果您可以了解有关该密钥号码的更多信息，它可能会为您提供所需的信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T20:56:43.717

对于比较，您可以反编译您的类文件并使用生成的源代码。看到[这个](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T20:10:12.503

Eclipse 是否在做一些检测来帮助在调试器中运行？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T20:12:00.987

最终，所使用的配置可能会有所不同。假设他们使用相同版本的 Java，则有许多选项可用于编译配置（JDK 合规性、类文件兼容性和大量调试信息选项）。

# mercurial - 如何让 Mercurial 的 hgwebdir 在 Windows 上运行？

> ID：644322
> 
> 赞同：8
> 
> 时间：2009-03-13T19:45:38.320
> 
> 标签：mercurial, tortoisehg

这些是我采取的步骤：

*   安装 Apache 2.2.x
*   安装 TortoiseHg 0.7
*   将 hgwebdir.cgi、hgweb.config 复制到 cgi-bin
*   根据需要编辑 hgweb.config
*   解压缩 $blah\TortoiseHg\library.zip 以解压缩 $blah\TortoiseHg\library
*   hgwebdir.cgi 开头的 sys.path.append("$blah\TortoiseHg\library")
*   移动 $blah\TortoiseHg\templates 到 $blah\TortoiseHg\library\templates

[（编辑：我忘了补充所有这些步骤都在这里](http://www.selenic.com/mercurial/wiki/index.cgi/HgWebDirStepByStep)列出。）

当我运行[http://localhost/cgi-bin/hgwebdir.cgi/](http://localhost/cgi-bin/hgwebdir.cgi/)时，我可以看到我的存储库。如果我尝试浏览该存储库，我会被告知“DLL 加载失败：找不到指定的模块。”。回溯的最后一行显示“c:\program files\apache group\apache\cgi-bin\mercurial\osutil.pyc in __load()”。

我读过关于 pywintypes25.dll 有问题的人；它位于“c:\program files\tortoisehg”中，并且已经在我的 PATH 中。

找不到什么DLL？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-14T20:29:32.910

你错过了 mercurial 的 c 库

有 3 种方法可以摆脱这种情况

1.  最近的 mercurial 版本附带纯 python 实现，您可以在 mercurial/pure 中找到
2.  自己编译（我不确定步骤，在任何 unix 上都可以）
3.  [从网站上](http://www.selenic.com/mercurial/wiki/index.cgi/BinaryPackages)获取 win32 安装程序
    请注意，我还没有查看它们是如何构建的
    （您需要基于 distutils 的安装，而不是基于 py2exe 的安装）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T14:45:34.157

第一件事：不要为此使用 TortoiseHg。请改用 Mercurial 安装程序。

（TortoiseHg 尝试尽可能独立于您的 Python 安装，并且由于这个 Python 新手不清楚的原因，事情不工作。关于 py2exe 的一些东西。）

否则，只需按照 HgWebDirStepByStep 中的步骤操作即可。我确实必须安装 pywintypes，但是 YMMV。最后，该页面上提到的解压缩实用程序可能会对文件权限做一些奇怪的事情：我必须向 Templates 目录及其文件/子目录添加读取权限。

顺便说一句，如果您想知道如何设置样式，请将其添加到 hgweb.config：

```
[web]
style = foo 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-16T20:11:51.957

我的设置涉及 apache 2.2.17、mod_wsgi 3.3、python 2.7.2、trac 0.12.2、mercurial 1.8.4。两个问题浮出水面：

1.  mercurial demandimport 初始化顺序
2.  mercurial 无法在站点包中加载 DLL。

我解决了如下问题：

1.  更改 hgwebdir.wsgi 以禁用需求导入：

`from mercurial import demandimport; demandimport.disable()`

2.  创建一个纯的（仅 .py，没有编译的 .pyd）mercurial 包并安装。另请参阅[https://www.mercurial-scm.org/wiki/WindowsInstall](https://www.mercurial-scm.org/wiki/WindowsInstall "这里")

`E:\Dist\mercurial-1.8.4>setup.py --pure build
E:\Dist\mercurial-1.8.4>setup.py --pure install`

编译后的版本（使用 Microsoft Visual Studio 2008）无法加载 DLL：

```
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24] mod_wsgi (pid=6092): Exception occurred processing WSGI script 'D:/Home/web/apache/cgi-bin/hgwebdir.wsgi'.
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24] Traceback (most recent call last):
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "D:/Home/web/apache/cgi-bin/hgwebdir.wsgi", line 9, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     from mercurial.hgweb.hgwebdir_mod import hgwebdir
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "C:\\Apps\\Python27\\lib\\site-packages\\mercurial\\hgweb\\__init__.py", line 10, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     import hgweb_mod, hgwebdir_mod
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "C:\\Apps\\Python27\\lib\\site-packages\\mercurial\\hgweb\\hgweb_mod.py", line 10, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     from mercurial import ui, hg, hook, error, encoding, templater
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "C:\\Apps\\Python27\\lib\\site-packages\\mercurial\\ui.py", line 10, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     import config, util, error
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "C:\\Apps\\Python27\\lib\\site-packages\\mercurial\\config.py", line 9, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     import error, util
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]   File "C:\\Apps\\Python27\\lib\\site-packages\\mercurial\\util.py", line 17, in <module>
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24]     import error, osutil, encoding
[Thu Jun 16 21:46:28 2011] [error] [client 192.168.178.24] ImportError: DLL load failed: The specified module could not be found. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-20T05:43:39.653

我知道这个问题已经得到解答，但我遇到了一个稍微不同的问题并找到了解决方法——

我确定我在 Python 配置 (2.5.4) 中遗漏了一些明显的东西，但我遇到了 .pyd 与 .dll 的问题。（我在使用 Python 颠覆库时遇到了同样的问题。）我在 Mercurial\library.zip 中看到了 osutil.pyd，但它无法加载它。因此，我解压缩了 library.zip，然后将 *.pyd 复制到 *.dll，例如：

```
REM Ugly DOS... Recursively renames all .pyd files to .dll
for /f "tokens=*" %%a in ('dir /s /b *.pyd') do copy "%%a" "%%~da%%~pa%%~na.dll" 
```

确保解压缩的库目录在 PYTHONPATH 中，但在此之后我可以成功执行：from mercurial import osutil. 还要记住将 Templates 目录复制或移动到新解压缩的库目录中。

[其余部分按照HgWebDirStepByStep](http://mercurial.selenic.com/wiki/HgWebDirStepByStep)的第 5 节中的步骤进行。不过，我没有遇到第 5.3 节中的“陷阱”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-12T05:18:31.463

对于任何寻找在 Windows 上使用 TortoiseHg 和 Apache 的分步教程的人，我在这里写了一个：http: [//makinggames.ca/dev/version-control-mercurial-apache-tortoisehg/](http://makinggames.ca/dev/version-control-mercurial-apache-tortoisehg/)

# c# - 使用 C# 打开 Excel 2003 电子表格。找不到可安装的 ISAM。例外

> ID：644331
> 
> 赞同：8
> 
> 时间：2009-03-13T19:49:09.263
> 
> 标签：c#, excel, xls, isam

我需要从 xls 中提取数据，我还需要让用户能够更改文件的位置。所以 OleDbConnection 似乎是一个好的开始，直到第一个合并的单元格。

这适用于除合并单元格之外的所有单元格：

```
OleDbCommand cmd = new OleDbCommand();
cmd.Connection = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data 
Source=F:\test.xls;Extended Properties=Excel 8.0;");
cmd.CommandText = "SELECT * FROM [Sheet$]";
cmd.Connection.Open(); 
```

我发现这应该允许访问合并的单元格：

```
OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=F:\test.xls;Extended Properties=Excel 8.0;HDR=Yes;IMEX=1;"); 
```

但后来我在 cmd.conn.open(); 上得到一个找不到可安装的 ISAM 异常；

我在这里遵循了建议：http: [//support.microsoft.com/kb/209805](http://support.microsoft.com/kb/209805)

在这里： [错误：“找不到可安装的 ISAM”](https://stackoverflow.com/questions/512143/error-could-not-find-installable-isam)

没运气。

我对从 xls 中提取数据的其他方式持开放态度。或者即使有一个命令我可以在 xls 上运行以删除可能工作的 mirged 单元格。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-13T19:58:10.347

我认为这只是因为如果您有多个扩展属性，则必须将扩展属性括在引号中

```
OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=F:\test.xls;
Extended Properties='Excel 8.0;HDR=Yes;IMEX=1';"); 
```

或者如果单引号不起作用（你明白了）

```
OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=F:\test.xls;
Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1;"";"); 
```

虽然您的示例没有显示，但此错误也可能是由文件路径中的空格引起的。在这种情况下，您还需要将文件路径用引号括起来。

```
OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=""F:\test.xls"";... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:01:03.353

假设您的系统要求包括安装 Excel，您可以使用 Excel 对象库

```
Excel.Sheets sheets = m_Excel.Worksheets;
Excel.Worksheet worksheet = (Excel.Worksheet)sheets.get_Item(1);
Excel.Range range = worksheet.get_Range("A1", "E1".ToString()); 
```

等等

另请参阅[VSTO](http://msdn.microsoft.com/en-us/library/d2tx7z6d.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-14T12:07:24.767

试试这个

我有这个问题。只是因为引号

```
string sConnection = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + sFilePath + ";" + "Extended Properties='Excel 8.0;HDR=YES;'"; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-02-02T17:45:28.980

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)是一个免版税的 .NET 电子表格组件，应该可以为 32 位和 64 位 .NET 做所有你想做的事情，而不依赖于 Excel（或除 .NET 2.0+ 之外的任何其他东西）。

如果您想亲自试用，可以在[此处](https://www.spreadsheetgear.com/downloads/register.aspx)查看实时 ASP.NET 示例并[在此处](http://www.spreadsheetgear.com/support/samples/)下载免费试用版。

免责声明：我拥有 SpreadsheetGear LLC

# asp.net - 在使用 ASP.Net 3.5 / SQL Server 2005 的网站上使用 TimeZones

> ID：644342
> 
> 赞同：1
> 
> 时间：2009-03-13T19:53:18.020
> 
> 标签：asp.net, sql-server, .net-3.5, timezone, utc

我正在尝试确定我应该如何在网络应用程序中实现本地时间。所有用户都已登录，没有匿名用户。他们需要查看本地时间的所有时间值。

这是应该怎么做的吗？

1.  所有 DateTime 值都在数据库中保存为 UTC 时间
2.  每个用户的个人资料中都存储了一个 UTC-Offset 值
3.  显示日期时间值时，我从数据库中获取值，并应用用户偏移量。

这是要走的路吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T19:58:19.193

不要为用户存储 UTC 偏移量 - 这不足以了解完整的时区信息。您应该存储他们的[Olson 时区 ID](http://en.wikipedia.org/wiki/Zoneinfo)，例如“Europe/London”。然后您可以在本地时间显示任何 UTC 时间，同时考虑历史变化、夏令时等。

编辑：看起来`TimeZoneInfo`ID 实际上不是正常的 Olson 格式 - 但只要有一些明智的东西可以显示给用户（作为选择），并且您可以稍后检索区域的 ID，这可能是好吧...如果您以后需要与其他系统进行互操作，您可能会遇到困难。

您应该*向*用户询问他们的时区（可能首先尝试通过 JavaScript 猜测它）——他们将拥有比您更多的信息。

您应该调查[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)类以了解更多信息 - 我不能说我自己使用过很多，但这是 .NET 3.5 的方式。特别是[FindSystemTimeZoneById](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.findsystemtimezonebyid.aspx)和[GetSystemTimeZones](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.getsystemtimezones.aspx)将很重要。

时区一般来说是一种痛苦，但至少比旧类型`TimeZoneInfo`提供了更多的支持。`TimeZone`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:58:51.813

这听起来对我来说是最直接的方法。我可以看到发生的唯一失误是某些地区（例如印第安纳州的部分地区，我认为整个亚利桑那州）不配合夏令时，因此您必须采取额外的预防措施，为他们显示正确的时间。

# xml - 是使用 XML 数据结构还是可以转换为 XML 的自定义数据结构更好？

> ID：644347
> 
> 赞同：2
> 
> 时间：2009-03-13T19:55:03.647
> 
> 标签：xml, web-services, language-agnostic

我将编写一个程序，其中包含一些使用 XML 来回传递数据的 Web 服务。XML 的格式是预定义的——我无法更改它以满足我的需要——但在代码中我可以以任何我想要的方式处理数据。

我的问题：将代码中的数据结构作为 XML 树处理，还是将等效的数据结构编写为语言中的对象以及一些用于与 XML 之间转换的实用函数，对我来说更好吗？

我自己对这个问题有一些想法，但我不想无意中偏向任何人的答案。这是一个与语言无关的问题，但如果您有任何语言方面的考虑，我想听听。

编辑：为了澄清，XML 格式本身是按逻辑方式设置的。语言中的对象与它没有太大区别。例如，它可能看起来像这样（这是一个糟糕的例子，但你得到了我希望的要点）：

```
<car>
    <make>DATA</make>
    <model>DATA</model>
    <ownershipDates>
        <startDate>DATA</startDate>
        <endDate>DATA</endDate>
    </ownershipDates>
</car> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T19:59:10.720

我会创建一个对象来处理 XML。如果你在处理数据结构时犯了错误，它可能会被编译器拾取。使用 XML，您无法做到这一点。这样，如果 xml 曾经发生变化（不是在编程中发生这种情况 :)），您在 XML 结构和您的代码接口之间就有了一个抽象层。在对象中更改它比在其余代码中到处更改更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:03:09.040

没有上下文，很难说。但我猜你会更轻松地使用本机数据结构。如果 XML 模式发生了变化，或者您需要使用不同的格式，那么您可以将这些更改与程序的其余部分分离。

所以可能会选择后一种选择：“将等效的数据结构编写为语言中的对象以及一些用于与 XML 进行转换的实用函数。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:04:53.890

通常，XML 旨在实现数据互操作性和人类可读性。不是处理速度或处理难易程度。为了处理您的数据，您可能会发现最好将其作为内部数据结构来处理。例如，在 Python 中，[流行的](http://codespeak.net/lxml/) [解析器](http://effbot.org/zone/element-index.htm)是将 XML 文档转换为内部 Python 结构的解析器，以便于处理和丰富数据，然后又可以将其转换回 XML。

如果您正在接受 XML 并且您的程序正在输出 XML，那么您可能需要检查 XSLT。一旦您理解了这种语言，[XML 翻译](http://www.w3schools.com/xsl/)对于常见任务来说就简单得多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T19:59:40.563

这取决于数据。例如，如果在父/子关系中表示数据是有意义的，但为了报告/传输它已被展平，我很有可能重建数据结构（如果处理速度不是主要问题我没有最后期限）。

我通常更喜欢为这样的事情编写类；我相信代码更容易理解。不过，这确实取决于您正在处理的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:04:21.130

这也取决于您使用的语言。在许多（但不是所有）语言中，都支持在 XML 和数据结构之间轻松转换的语言，因此您无需编写大量转换代码。

例如，当我在 C# 中工作时，我尝试以内置 XML 序列化程序可以处理的方式设计我的 XML 和数据结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T20:11:31.673

尽管使用 XML（例如 DOM 对象）作为您的数据模型很诱人，但请记住，“真实”对象（即实际上使用类对数据进行建模）允许您拥有方法和复杂的属性（对其他对象的引用）等。 - 而 XML 基本上只是 POD。

如果您使用的语言能够很好地进行 XML 绑定，那么您可以享受这两个世界。您可以拥有一个具有丰富的、面向对象的类的真实对象模型，这些类也从 XML 序列化到 XML 序列化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T20:16:46.950

编写一个序列化自身的数据对象

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-14T19:53:31.373

后者：等效类加上读/写 XML 的代码。

这主要是因为您可以使用 JAXB 从 XML Schema 自动生成类和代码（假设 Java - 所以这个答案是语言党派的）。您无需处理 XML，而是处理 JAXB 的对象。

OTOH，您的 XML 很好且规则，因此 DOM 对象与您自己编写的对象非常相似。缺点是 DOM API 不使用任何特定语言的惯用数据结构，因此编写起来不太直观，维护起来也不太可读。幸运的是，对于大多数语言，还有其他类似 DOM 的工具具有该语言的更自然 API。

# javascript - Html/Javascript：向 HTML 控件添加属性

> ID：644358
> 
> 赞同：2
> 
> 时间：2009-03-13T19:57:13.360
> 
> 标签：javascript, jquery, dynamic

需要：找到一种方法将有效的标签/属性/属性添加到普通的 html 控件。

我所拥有的是一些 javascript/jquery 将点击事件添加到将显示或隐藏 div 的链接。这个想法是使用 $(document).ready 和一个匿名方法来创建 onClick 在页面加载时调用的方法。单击时，将显示带有一些文本的 div。这一切都很好，除了我不知道如何设置文本以便可以在页面加载时完成。我想要的是这样的：

```
<a href="..." class="showItLink" textToShow="This is the text to show">HI</a> 
```

这样我就可以做到这一点：

```
$(document).ready
(
  function()
  {
    $("..showItLink").click
    (
      function(event) 
      {
        var containerPosition;
        var createdDiv;

        //see if the div already exists
        createdDiv = $(this).children(".postComment");

        if (createdDiv.length == 0) 
        {
          //This is where the attribute is used so that the CreateDiv
          //method can take the textToShow and fill the div's innerText
          //with it                  V V V V V V
          createdDiv = CreateDiv(this.textToShow, "postComment"); 
          $(this).append(createdDiv);
          $(this).children(".postComment").hide();
        }

        $(createdDiv).toggle();
        event.preventDefault();
      }
    );
  }
); 
```

现在除了不是 xhtml 有效（meh）之外，这仅适用于 IE。Firefox 只是说它不存在。(this.textToShow) 我可以使用 rel 或 rev 之类的东西，但这看起来很老套。我想知道是否有一种有效的方法可以做到这一点。

**以下答案的解决方案**

```
comment = $(".showItLink").attr("comment");
...
createdDiv = CreateDiv(comment, "postComment"); 
```

搭配：

```
<a href="http://www.theironical.com" class="showItLink" comment="hihihi" >HI</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:13:12.590

如果您使用的是 JQuery，只需使用 .attr() 获取和设置属性。

获取：this.attr("textToShow")

设置：this.attr("textToShow", value)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:03:07.030

将属性添加到 html 控件的方式是使用 element.setAttribute("attributeName", "attributeValue") 其中“element”是要添加属性的元素。

要获取属性，请使用 getAttribute("attributeName");

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-14T01:32:14.930

您无法在仍然有效的情况下向 HTML 元素添加自定义属性。它通常可以在当前的浏览器中工作，但它有点脆弱，因为如果你碰巧选择了一个正在使用（现在或将来）的名称作为任何浏览器的 HTML 或 JavaScript 属性，冲突将阻止它工作.

HTML5 提出了名称以“data-​”开头的属性作为有效的扩展机制。您还可以考虑 XHTML 中的命名空间元素；这在技术上仍然不是 DTD 的“有效 XHTML”，但至少它不会发生冲突。

> <a href="..." class="showItLink" textToShow="这是要显示的文本">HI

我建议为此特定目的使用“title”属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:02:42.287

做这种事情的最好方法是将文本隐藏在另一个元素中，然后切换该元素。尝试这样的事情：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>clear test</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $("#show-it").click(function() {
                    $("#message").toggle();
                });
            });
        </script>
    </head>
    <body>
        <div>
            <a id="show-it" href="javascript:void(0);">show it</a>
            <div id="message" style="display:none;"> hidden message</div>
            hello world
        </div>
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-14T02:37:32.090

如果你的 textToShow 属性是一个 expando 属性，那么 this.textToShow 不会返回 undefined，但由于它是一个自定义属性，你需要使用 jQuery 的 this.attr("textToShow") 或标准 DOM this.getAttribute("textToShow" ）。

# user-interface - 是否应该使用下拉列表来输入您的州缩写？

> ID：644359
> 
> 赞同：1
> 
> 时间：2009-03-13T19:57:24.703
> 
> 标签：user-interface

非常简单的问题：是否应该使用下拉列表来填充州缩写？根据我的经验，我认为大多数电子商务网站都这样做，所以我认为这是可以接受的。然而，[雅各布尼尔森对此有话要说。](http://www.useit.com/alertbox/annoyances.html)

我认为我不同意；我使用 tab 键，然后输入我的状态的第一个字母。哎呀，即使这不是第一个条目，我已经这样做了足够多次，我会反复点击字母并得到我需要的东西。我从不需要滚轮或鼠标。

关于这个特定问题是否有任何额外的具体指导？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T20:04:09.773

我认为这将不再是一个问题，因为大多数现代浏览器会根据您键入的每个连续字母滚动下拉列表，而不仅仅是像以前那样阅读第一个字母。因此，如果您键入 NY，下拉列表将直接滚动到 NY，您不必多次点击 N。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:02:04.987

我不知道具体的指导，但我会考虑的一种替代方法是使用自动完成文本框，强制您从可用选项之一中进行选择。我同意包含 50 项的下拉列表太长，并且使用带有强制选择的自动完成功能可以实现相同的目的——一致的数据——并且具有用户更容易导航的优点。如果您不想将选择限制在美国各州，您可以放弃强制选择，并让自动完成功能作为建议工作，用户可以输入自由格式的输入。

**编辑**：正如@Martin 建议的那样，我可能会让自动完成显示完整的州名，即使它只输入了缩写。这也将解决人们弄错缩写的问题，尽管您可以在下拉列表中做同样的事情——显示带有缩写的名称作为值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:05:27.680

由于状态是两个字母的缩写，所以我不会放置下拉列表，我会放置一个文本框，但我会使用 AJAX 或 Javascript 验证它，以在用户输入错误后立即警告用户出现错误。

当要输入的数据更长/更容易出错时，下拉/自动完成（在我看来）很有用。

如果您坚持使用自动完成或下拉菜单，您应该输入长状态名称，而不仅仅是缩写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T20:10:35.623

我打算发布 NYSystemsAnalyst 的答案，但他打败了我。我将添加一个警告......如果您使用下拉列表，它必须是完整的。不要忘记明显的 DC，或者不太常见但合理的 PR 或 AE/AA/AP，或者不太可能但仍然有效的 AS、FM、MH、MP、PW 和 VI。

[官方名单](http://www.usps.com/ncsc/lookups/usps_abbreviations.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T20:21:49.277

我认为这取决于您是要求用户输入他们自己的地址还是其他人的地址（送货地址）。每个人都知道自己的州缩写，但可能知道所有的州缩写。

因此，对于输入您自己的地址，文本框是最快和最简单的方法，但如果您要求用户可能输入其他人的地址，那么下拉菜单可能是最好的。

当然，如果您的站点同时具有这两种类型的地址，则您希望您的 UI 保持一致并为两者使用下拉菜单。此外，如果您使用下拉菜单，我建议在展开下拉菜单时使用州缩写和名称（AZ - Arizona）（但在折叠时只显示缩写）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T20:03:56.497

我敢打赌，在线电子商务网站的一半用户不知道各州的缩写。想一想您是否要向某人运送礼物，而您却不记得是 MS、MO 还是 MI。下拉菜单很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T20:05:24.263

我从来没有遇到过州下拉框的问题（这通常来自西弗吉尼亚州底部的某个人）。我已经养成了按 Tab 键并按 W 的习惯，然后它会识别“E”并给我正确的状态，或者它不会识别“E”然后我必须按一次向下键或两次（取决于排序顺序）以获得正确的状态。

所以总而言之，我正在查看最多 5 次按键来达到我的状态。我不认为这很糟糕。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T20:09:06.233

如果状态缩写无效，带有验证的文本框和下拉列表怎么样？

# c - 查询选择系统调用

> ID：644370
> 
> 赞同：6
> 
> 时间：2009-03-13T19:59:18.223
> 
> 标签：c, sockets

select() 定义为：

```
int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *errorfds, struct timeval *timeout); 
```

*nfds*表示所有给定集合中的最高文件描述符加一。我想知道为什么当 fd_set 信息可用时 select() 需要这些数据。

如果集合中的 FD 是 4、8、9，则*nfds*的值为10。 select() 会监控 fds 9,8,7,6,5,4 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T20:14:42.697

问题是 fd_set 并不是您所想的真正的“集合”。幕后细节是 fd_set 的实现只是一个用作位域的整数。换句话说，执行

```
fd_set foo;
FD_CLEAR(&foo);
FD_SET(&foo, 3); 
```

将 foo 设置为十进制值 8 - 它将第四个最低有效位设置为 1（请记住，0 是一个有效的描述符）。

```
FD_SET(&foo, 3); 
```

相当于

```
foo |= (1 << 3); 
```

因此，为了使 select 正常工作，它需要知道 fd_set 的哪些位是您关心的位。否则，它将无法告诉“在”集合中的零位，但从“不在”集合中的零位设置为假。

在您的示例中，具有 4、8 和 9 集且 n = 10 的 fd_set 被解释为“具有 10 个条目的集合 (fds 0-9)。条目 4、8 和 9 为真（监视它们）。条目 1 ,2,3,5,6,7 为假（不要监视它们）。任何大于 9 的 fd 值根本不在设定的时间段内。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:08:08.920

Select 监视您使用 FD_SET 宏启用的那些 FD。如果您没有启用任何 FD 进行监控，则 select() 不会监控任何内容。

"nfds" 肯定是多余的，但它是 select() 接口的一部分，所以你需要使用它:)

无论如何，如果集合中有 {4, 8, 9}，则将 nfds 设置为 10（如您所述），并且 select() 将仅监视三个 FD 4、8 和 9。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:13:38.983

这可能是一种优化，因此`select`不必遍历整个`fd_set`以找出实际使用的描述符。如果没有该参数，`select`则总是需要查看整个集合以查找调用中实际使用了哪些描述符，使用该参数，可以省略一些工作。

# math - 绘制一个旋转的矩形

> ID：644378
> 
> 赞同：11
> 
> 时间：2009-03-13T20:02:02.740
> 
> 标签：math, graphics

我意识到这可能更像是一个数学问题。

要为我的矩形画线，我需要求解它们的角。我在 (x,y) 有一个矩形中心，具有定义的宽度和高度。

![](https://i31.photobucket.com/albums/c399/Bolt986/Rectangle-Drawing.jpg)

在顶部的未旋转矩形上找到蓝点（角度= 0）它是

`UL = (x-Width/2),(y+height/2)`
`UR = (x+Width/2),(y+height/2)`
`LR = (x+Width/2),(y-height/2)`
`LL = (x-Width/2),(y-height/2)`

如果角度不为0，我如何找到点？

提前致谢。

* * *

更新：虽然我的图片中有 (0,0) 作为中心点，但中心点很可能不在那个位置。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-16T04:56:21.530

首先将中心点转换为 0,0

X' =​​ Xx

Y' = Yy

然后旋转A角

X'' = (Xx) * cos A - (Yy) * sin A

Y'' = (Yy) * cos A + (Xx) * sin A

再次将中心点转换回 x,y

X''' = (Xx) * cos A - (Yy) * sin A + x

Y''' = (Yy) * cos A + (Xx) * sin A + y

因此，通过以下变换计算 (X,Y) 的所有 4 个点

X''' = (Xx) * cos A - (Yy) * sin A + x

Y''' = (Yy) * cos A + (Xx) * sin A + y

其中 x, y 是矩形的中心点，X,Y 是角点 正如我在评论中给出的，当 Angle 为 0 时，即使角点也没有正确定义。

替换后会得到

```
UL  =  x + ( Width / 2 ) * cos A - ( Height / 2 ) * sin A ,  y + ( Height / 2 ) * cos A  + ( Width / 2 ) * sin A
UR  =  x - ( Width / 2 ) * cos A - ( Height / 2 ) * sin A ,  y + ( Height / 2 ) * cos A  - ( Width / 2 ) * sin A
BL =   x + ( Width / 2 ) * cos A + ( Height / 2 ) * sin A ,  y - ( Height / 2 ) * cos A  + ( Width / 2 ) * sin A
BR  =  x - ( Width / 2 ) * cos A + ( Height / 2 ) * sin A ,  y - ( Height / 2 ) * cos A  - ( Width / 2 ) * sin A 
```

我认为这适合您的解决方案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T20:06:26.350

如果 'theta' 是逆时针旋转角度，则旋转矩阵为：

```
| cos(theta)  -sin(theta) |
| sin(theta)   cos(theta) | 
```

IE

```
x' = x.cos(theta) - y.sin(theta)
y' = x.sin(theta) + y.cos(theta) 
```

如果旋转点不在原点，请从原始坐标中减去旋转中心，执行如上所示的旋转，然后再次添加旋转中心。

[在http://en.wikipedia.org/wiki/Transformation_matrix](http://en.wikipedia.org/wiki/Transformation_matrix)有其他转换的例子

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T05:35:37.100

[旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix) （这正在成为一个常见问题解答）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T20:10:55.247

请参见[2D 旋转](http://www.siggraph.org/education/materials/HyperGraph/modeling/mod_tran/2drota.htm)。

> ```
> q = initial angle, f = angle of rotation.
> 
> x = r cos q 
> y = r sin q
> 
> x' = r cos ( q + f ) = r cos q cos f - r sin q sin f 
> y' = r sin ( q + w ) = r sin q cos f + r cos q sin f
> 
> hence:
> x' = x cos f - y sin f
> y' = y cos f + x sin f 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T20:08:31.103

最简单的方法之一是在旋转之前获取点的位置，然后应用坐标变换。因为它以 (0,0) 为中心，所以这只是一个使用的例子：

x' = x cos(theta) - y sin(theta)

y' = y cos(theta) + x sin(theta)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-13T07:16:38.370

用这个……我成功了……

```
 ctx.moveTo(defaults.x1, defaults.y1);

    // Rotation formula
    var x2 = (defaults.x1) + defaults.lineWidth * Math.cos(defaults.rotation * (Math.PI / 180));
    var y2 = (defaults.y1) + defaults.lineWidth * Math.sin(defaults.rotation * (Math.PI / 180));

    ctx.lineTo(x2, y2);

    x2 = (x2) + defaults.lineHeight * Math.cos((defaults.rotation + 90) * (Math.PI / 180));
    y2 = (y2) + defaults.lineHeight * Math.sin((defaults.rotation + 90) * (Math.PI / 180));
    ctx.lineTo(x2, y2);

    x2 = (x2) + defaults.lineWidth * Math.cos((defaults.rotation + 180) * (Math.PI / 180));
    y2 = (y2) + defaults.lineWidth * Math.sin((defaults.rotation + 180) * (Math.PI / 180));
    ctx.lineTo(x2, y2);

    x2 = (x2) + defaults.lineHeight * Math.cos((defaults.rotation + 270) * (Math.PI / 180));
    y2 = (y2) + defaults.lineHeight * Math.sin((defaults.rotation + 270) * (Math.PI / 180)); 
```

# duplicates - 如何删除 XQuery 中的重复节点？

> ID：644384
> 
> 赞同：16
> 
> 时间：2009-03-13T20:03:08.450
> 
> 标签：duplicates, xquery

我有一个即时生成的 XML 文档，我需要一个函数来消除其中的任何重复节点。

我的功能如下：

```
declare function local:start2() {
    let $data := local:scan_books()
    return <books>{$data}</books>
}; 
```

示例输出为：

```
<books>
  <book>
    <title>XML in 24 hours</title>
    <author>Some Guy</author>  
  </book>
  <book>
    <title>XML in 24 hours</title>
    <author>Some Guy</author>  
  </book>
</books> 
```

我只想要我的书籍根标签中的一个条目，还有其他标签，比如那里的小册子也需要删除重复项。有任何想法吗？

* * *

更新了以下评论。通过唯一节点，我的意思是删除具有完全相同内容和结构的节点的多次出现。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-20T14:01:46.397

**一种更简单、更直接的单行 XPath 解决方案**：

*只需使用以下 XPath 表达式*：

```
 /*/book
        [index-of(/*/book/title, 
                  title
                 )
                  [1]
        ] 
```

**例如，当应用于以下 XML 文档时**：

```
<books>
    <book>
        <title>XML in 24 hours</title>
        <author>Some Guy</author>
    </book>
    <book>
        <title>Food in Seattle</title>
        <author>Some Guy2</author>
    </book>
    <book>
        <title>XML in 24 hours</title>
        <author>Some Guy</author>
    </book>
    <book>
        <title>Food in Seattle</title>
        <author>Some Guy2</author>
    </book>
    <book>
        <title>How to solve XPAth Problems</title>
        <author>Me</author>
    </book>
</books> 
```

**上面的 XPath 表达式正确选择了以下节点**：

```
<book>
    <title>XML in 24 hours</title>
    <author>Some Guy</author>
</book>
<book>
    <title>Food in Seattle</title>
    <author>Some Guy2</author>
</book>
<book>
    <title>How to solve XPAth Problems</title>
    <author>Me</author>
</book> 
```

**解释**很简单：对于every `book`，只选择它出现的一个——这样它在*all-books*`title`中的索引与它在*all-titles*中的第一个索引相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-11T05:44:51.533

您可以使用内置`distinct-values()`功能...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-01T09:31:42.217

受函数式编程启发的解决方案。此解决方案是可扩展的，因为您可以用**自定义构建的**布尔函数替换**“=”**比较。该函数在列表长度上具有**最坏情况的**二次复杂度。您可以通过**事先对列表进行**排序并仅与直接后继者进行比较来获得复杂性。**`local:compare($element1, $element2)`**`n(log n)`****

 ******据我所知，`fn:distinct-values`（或`fn:distinct-elements`）函数不允许使用**定制的**比较函数。

```
declare function local:deduplicate($list) {
  if (fn:empty($list)) then ()
  else 
    let $head := $list[1],
      $tail := $list[position() > 1]
    return
      if (fn:exists($tail[ . = $head ])) then local:deduplicate($tail)
      else ($head, local:deduplicate($tail))
};

let $list := (1,2,3,4,1,2,1) return local:deduplicate($list) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T22:50:38.077

我通过实现递归唯一性搜索功能解决了我的问题，该功能仅基于文档的文本内容进行唯一性匹配。

```
declare function ssd:unique-elements($list, $rules, $unique) {
    let $element := subsequence($rules, 1, 1)
    let $return :=
    if ($element) then
        if (index-of($list, $element) >= 1) then
            ssd:unique-elements(insert-before($element, 1, $list), subsequence($rules, 2), $unique)
        else <test>
            <unique>{$element}</unique>
            {ssd:unique-elements(insert-before($element, 1, $list), subsequence($rules, 2), insert-before($element, 1, $unique))/*}
            </test>
    else ()
    return $return
}; 
```

调用如下：

```
declare function ssd:start2() {
    let $data := ()
    let $sift-this := 
       <test>
           <data>123</data>
           <data>456</data>
           <data>123</data>
           <data>456</data>
           <more-data>456</more-data>
       </test>
    return ssd:unique-elements($data, $sift-this/*, ())/*/*
};

ssd:start2() 
```

输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<data>123</data>
<data>456</data> 
```

我想如果您需要稍微不同的等价匹配，您可以相应地更改算法中的匹配。无论如何应该让你开始。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-29T19:02:42.727

fn:distinct-values 呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-27T03:08:06.367

你可以使用这个functx函数：functx:distinct-deep

无需重新发明轮子

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-13T09:56:07.177

要删除重复项，我通常使用辅助函数。在你的情况下，它看起来像这样：

```
declare function local:remove-duplicates($items as item()*) 
as item()*
{
  for $i in $items
  group by $i
    return $items[index-of($items, $i)[1]]
};

declare function local:start2() {
    let $data := local:scan_books()
    return <books>{local:remove-duplicates($data)}</books>
}; 
```

# javascript - Opera 没有触发 Wand 保存密码

> ID：644387
> 
> 赞同：1
> 
> 时间：2009-03-13T20:03:51.630
> 
> 标签：javascript, forms

我对此一无所知：在[http://wurzelimperium.de](http://wurzelimperium.de)上， Opera 停止通过 Wand 保存密码。只是不再触发而已。我尝试通过提供一个应该通过 javascript 激活的真正的“提交”输入字段来更改表单。这没有帮助，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T20:14:11.400

你里面有一个很奇怪的标记：

```
<td class="brownbold">Passwort</td>
<td><input type="Password" class="text loginput" style="width:100%;" id="login_pass" maxlength="100" size="15" tabindex="3">
<input type="hidden" name="pass" value="" id="b64_pass"></td> 
```

为什么需要第二个隐藏字段？为什么第一个没有`name`？

从小写单词“password”（in `type`）开始，并`name`在第一个输入中添加 a。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-12T22:25:45.020

至少现在你真的可以关闭它……因为魔杖被触发（我突然成为了一个似乎是关于德国花园侏儒游戏的注册用户；-）

# c++ - 带有模板的c ++类找不到它的构造函数

> ID：644397
> 
> 赞同：15
> 
> 时间：2009-03-13T20:05:13.483
> 
> 标签：c++, templates

我有一个我不太明白的问题。我有一个类节点。

```
template<class T>
class node {
protected:
    T _data;
public:
    node(T data);   
}; 
```

这是在“node.h”文件中。在“node.cpp”文件中，有这个构造函数：

```
#include "node.h"

template<class T>
node<T>::node (T data) {
    _data = data;
} 
```

虽然编译器没有发现错误，但链接器 (ld) 告诉我：

> > /usr/bin/ld：未定义的符号：
> > 
> > 节点<int>::node(int)

奇怪的部分......如果我将构造函数从 .cpp 移动到 .h 文件，一切正常。哪里有问题？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-13T20:10:05.513

问题是模板不是类——您通常不会将它们写在两个单独的文件中。模板类是编译器用来*生成*类的代码。因此，您的实现代码需要有效地内联，即在您发现的标头中。

有关*为什么*必须这样的更完整解释，请参阅[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.12)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-13T20:08:47.217

作为一般规则，您必须将所有模板成员放在头文件中。模板是按使用的基础编译的，因此无论在哪里使用，都需要提供整个定义。将代码放在头文件中将解决该问题。

唯一可以将模板定义放入 CPP 文件的情况是该模板仅在该 CPP 文件中使用。原因是它符合整个定义可用于编译的标准。

将 node.cpp 的内容移动到 node.h 将解决问题。

**奇怪的场景**

再说一次，您还可以将所有内容放在 CPP 文件中并包含 CPP 文件。C++ 在这方面很灵活。我只提到这一点是因为我以前见过。当它撞到我的桌子顶部时，我真的擦伤了我的下巴。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:09:38.293

当您**使用** `node<int>`时，您很可能没有包含 node.cpp。因此编译器无法实例化`node<int>::node<int>`构造函数。通常你把所有的模板代码，包括方法的所有实现，放在头文件中，或者包含在头文件中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T20:26:26.350

普遍接受的做法是将所有实现放在 .h 文件中，以便可以根据需要从模板生成类。

如果您提前知道您的模板将使用哪些类型进行实例化，您可能会作弊。只需确保您的 .cpp 包含您需要的每种类型和方法的用例。用例位于模板代码之后，这一点很重要。例如对于“node.cpp”，使用

```
#include "node.h"

template<class T>
node<T>::node (T data) {
    _data = data;
}

void dummy(void)
{
    node<int> intnode(0);
    node<double> doublenode(0.0);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T15:01:30.287

```
// You can put templates declaration in header and definition in source  
// node.h or wherever you include file gets included
extern template class node<int>;

// node.cpp or where ever source file you want to use it
// But use it only once for each type of generated class
template class node<int>; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T20:09:50.443

除非调用该函数，否则编译器不会输出任何代码，链接器也不会找到它。

您应该将函数放在它所属的标题中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T20:13:25.850

隐式实例化已关闭，您需要

```
template class node<int>; 
```

在您的代码中的某处（可能是 node.cpp）

编辑：不好的答案，可能并非如此。

# .net - .NET 应用程序在 Windows 2008 64 位上的什么模式

> ID：644415
> 
> 赞同：0
> 
> 时间：2009-03-13T20:09:00.993
> 
> 标签：.net, x86, 64-bit

我的 .NET 应用程序将如何在 Windows 2008 x64 下运行？作为 32 位应用程序还是 64 位应用程序？这有什么区别吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T20:11:16.043

如果它针对 64 位架构，或者设置为在任何平台上运行，它将运行 64 位。

如果它针对 32 位架构，它将运行 32 位。如果您需要使用本机 DLL，您需要确保它的目标正确。

这将与 64 位 Vista 相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:10:59.397

如果您使用“在任何机器上运行”选项编译它，它将作为 64 位应用程序运行。

如果强制它编译为“以 32 位运行”，那么它将在 x64 机器上作为 32 位应用程序运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:11:59.083

取决于您如何构建它，以及您应该如何构建它。:-) 如果您没有指定特定型号，那么您的应用程序将在 x86 上以 32 位运行，在 x64 上以 64 位运行。这通常是您想要的。当您在 64 位系统上与 32 位代码进行互操作时，会出现例外情况。例如，如果您调用一个期望“int”为 32 位的 DLL，而您将其传递为 64 位，那么事情很快就会出错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:15:23.957

编译到目标“任何”平台的.net 代码（查看项目构建配置）将从 IL 编译成 64 位机器代码指令。如果你指定 32bit 那么它会被编译成 32bit 然后转换成 32bit 机器码在 64bit OS 上运行！

编译成 64 位代码时，某些库存在一些兼容性问题。

编辑：XNA 是您希望专门针对 32 的示例，请查看： [http ://www.brianpeek.com/blog/archive/2007/11/13/x64-development-with-net.aspx](http://www.brianpeek.com/blog/archive/2007/11/13/x64-development-with-net.aspx)

注意：无论在什么平台上运行，Int 都是 int？不是吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T21:13:40.277

在我的问题[和](https://stackoverflow.com/questions/632831/why-are-public-fields-faster-than-properties)答案之后，我会三思而后行是否允许应用程序以 64 位运行。与更成熟的 32 位 JIT 相比，64 位 JIT 似乎真的很有限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-16T21:59:33.593

如果它是一个 ASP.Net 应用程序，您可以将 IIS 配置为在我们的 webapp 的应用程序池上“启用 32 位应用程序”，这样它将模拟 32 位。

所以，最后一个问题是“取决于”

# profiling - 测量执行时间和使用的内存

> ID：644419
> 
> 赞同：2
> 
> 时间：2009-03-13T20:09:19.900
> 
> 标签：profiling

大多数在线评委都有某种系统来测量执行时间和内存消耗。[此处](http://acm.timus.ru/status.aspx)显示了一个示例。它是如何完成的？是否有一个简单的 UNIX 实用程序可以用来在我自己的程序上运行类似的测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:35:19.823

Valgrind 及其所有工具将为您提供一些信息：

*   `cachegrind`- 缓存模拟器
*   `callgrind`- 调用图跟踪 - 允许获取调用成本并显示程序中发生的情况
*   `massif`- 有关堆内存使用情况的信息
*   `memcheck`- 内存泄漏检查

此外，您还可以使用更复杂的软件，例如[Intel VTune](http://www.intel.com/cd/software/products/asmo-na/eng/239144.htm)。

如果你对底层细节和真正的硬件计数器感兴趣，那么看看[perfmon2](http://perfmon2.sourceforge.net/)，它有可能在未来某个时候进入主流内核。

并搜索旧问题 - 关于这个主题有很多帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:16:57.807

UNIX [time](http://en.wikipedia.org/wiki/Time_(Unix))命令将输出用户时间量、系统时间和一些内存统计信息。Linux 版本可在[此处](http://www.kernel.org/doc/man-pages/online/pages/man1/time.1.html)找到，其中包含一些允许您指定确切输出的格式字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T21:20:19.917

上次我需要分析 Unix 程序时，我使用了 gcc 和 gprof。它为我提供了我需要的信息。

# memory - 什么是 Excel 2007 工作簿名称大小限制？为什么？

> ID：644429
> 
> 赞同：3
> 
> 时间：2009-03-13T20:10:14.750
> 
> 标签：memory, excel, vba

Excel 2007 中的工作簿名称应该仅受内存大小的限制，但情况似乎并非如此。最终，保存为名称的数组将变得足够大，以至于当您尝试保存时会得到（解释）：“此工作簿中的一个或多个公式大于 8192 个字符的限制，请另存为二进制文件”。

好的，然后将其保存为二进制文件格式……但即使在这里，数组也可能变得足够大，以至于无法保存文件。

是什么赋予了？发生这种情况时，名称是如何存储在 Excel 中的？这是安装特有的吗？有办法解决吗？

使用下面的代码自己尝试一下。它将完美运行并且名称将被正确填充，但保存会给您带来一些令人讨厌的错误。3351 元素太多但 3350 保存就好了：

```
Public Sub TestNameLimits()
    Dim v As Variant
    ReDim v(1)

    Dim index As Integer

    For index = 1 To 3351
        ReDim Preserve v(index)
        v(index) = "AAAA"
    Next

    Call Application.Names.Add("NameLimit", v)

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T13:46:34.330

名称集合是 Excel 的一项功能，已经存在了很长时间。Excel 2003 中的公式长度限制为 1,024 (2^10)，但在 Excel 2007 中扩展为 8,192 (2^13)。

这两篇文章介绍了 Excel 2003 和 Excel 2007 的主要大小限制：

[Excel 2003 规范和限制](http://office.microsoft.com/en-us/excel/HP051992911033.aspx)

[Excel 2007 规范和限制](http://office.microsoft.com/en-us/excel/HP100738491033.aspx)

为了解决这个问题，我将查看[Excel.Worksheet.CustomProperties](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.customproperties(VS.80).aspx)集合。我相信 Worksheet.CustomProperties 项目大小仅受内存限制。您将不得不在您的系统上进行测试，可能还需要在各种版本的 Excel 中进行测试，但我认为您应该能够轻松保存超过 10,000,000 个字符。

但是，在使用 Worksheet.CustomProperties 集合时，您将自己负责将数组与字符串相互转换，这与 Names 集合不同，后者可以自动将数组转换为字符串。

# subsonic - 亚音速预载对象和子对象

> ID：644441
> 
> 赞同：0
> 
> 时间：2009-03-13T20:12:28.957
> 
> 标签：subsonic, prefetch

我正在寻找以亚音速加载带有子图的对象列表。我知道如何使用 linq to sql 和 dataloadoptions

我有这张图

产品-位置-价格

新的 Select().From().Where(Product.Columns.Id).IsEqualTo(productId).ExecuteSingle();

我想让我的产品对象预加载位置和价格，这样它们就不会延迟加载导致很多查询。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T10:30:55.637

我在 SubSonic 中使用 RepositoryRecord，它“主要是”poco。然后，我为那些在选择属性时加载另一个类的类制作部分内容。此外，从数据库中加载一条记录比一次加载所有记录更快、更容易。

```
Partial Public Class Book

    Private _Author as Database.Author 
    Property Author() as Database.Author
      Get
         If _Author is nothing then
           ' Load the author class here.
         End if
         return _Author
      End get
      Set
         '....
      End Set
    End Property

End Class 
```

# url - 谷歌看到了它不应该看到的东西。为什么？

> ID：644443
> 
> 赞同：7
> 
> 时间：2009-03-13T20:12:57.007
> 
> 标签：url, seo, friendly-url

出于某种神秘的原因，Google 已将这两个地址都编入索引，它们指向同一页面：

**/something/some-text-1055.html**

和

**/index.php?pg=something&id=1055**

（临时通知 - 该网站自推出以来就有友好的网址，我不知道谷歌如何找到“index.php？”网址 - 只有在内容管理系统中有“不友好”的网址，这是受密码限制的）

我能做些什么来解决这种情况？（我有大约 1000 个双索引页面。）有人告诉我使用“disallow: index.php?” 在 robots.txt 文件中。对还是错？还有其他建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T20:55:39.087

您会惊讶于谷歌机器人在索引网站内容方面的普遍性和速度。再加上许多 CMS 系统创建了非预期的页面/链接，因此很可能在某些时候这些链接被暴露是最有可能的罪魁祸首。您的管理区域也可能没有您想象的那么安全，谷歌机器人就是这样通过的。

乖巧的，和[google推荐](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=66359)的，这里要做的事情是

1.  如果可能，创建从查询字符串样式 URL 到规范样式 URL 的 301 重定向。那就是你说“嘿，网络机器人/浏览器，以前在这个 URL 上的内容现在在这个另一个 URL 上”

2.  阻止 robots.txt 中的查询字符串内容。这就像**问**蜘蛛或其他**自动程序**“嘿，请不要看这些东西。这些不是您要查找的 URL”

3.  Google 显然[允许您](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)现在通过页面顶部的 <link /> 标记指定规范 URL。考虑添加这些。

至于行为端正的事情是否是“正确”的事情：谷歌排名……谁知道呢。只有“谷歌”知道他们的算法现在如何工作，以及将来如何工作，而谷歌，我的意思是一群工程师和高管，他们在搜索应该如何工作方面有着相互冲突的目标。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T22:56:10.153

Google 现在提供了一种指定页面规范 URL 的方法。您可以在 HTML 中使用以下代码告诉 Google 您的规范网址：

```
<link rel="canonical" href="http://www.example.com/product.php?item=swedish-fish" /> 
```

您可以在他们关于该主题的博客文章中阅读更多关于 Google 上的规范 URL 的信息：http: [//googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html) 根据博客文章 Ask.com， Microsoft Live Search 和 Yahoo! 都支持规范标签。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T20:15:34.910

如果您使用[站点地图生成器提交给搜索引擎](http://www.google.com/support/webmasters/bin/answer.py?answer=40318&hl=en)，您也需要禁止它们。它们很可能是 Google 通过抓取您的文件夹和检查您的日志获得您的链接的地方。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T20:15:46.827

最好检查已请求的 URI ( `$_SERVER['REQUEST_URI']`)，如果是则重定向`/index.php`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T21:27:31.583

更改 robots.txt 将无济于事，因为该页面已编入索引。

最好是使用永久重定向 (301)。

如果您想删除曾经被 Google 索引的页面，唯一的方法或多或少是让它返回 404 not found 消息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T23:06:18.367

您是否有可能将表单发布到类似的网址，而谷歌只是从源头获取它？

# sql - 与 FROM 中的其他一些表进行外部联接

> ID：644447
> 
> 赞同：0
> 
> 时间：2009-03-13T20:13:14.320
> 
> 标签：sql, join, left-join

```
FROM [TABELA DE PRODUTOS/ESTOQUE] AS T1
, [TABELA DE PRODUTOS] AS T2
, [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] AS T3
, [TABELA DE FORNECEDORES] AS T4
, [TABELA DE PRODUTOS/ESTOQUE] AS T5
WHERE (((T1.Produto)=[T2].[ID]) 
ETC 
```

那么，如何在这些表之间添加 JOIN 呢？我需要一个左连接，比如：

```
FROM [TABELA DE PRODUTOS/ESTOQUE] <- TABLE1
LEFT JOIN [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] <- TABLE2
ON TABLE1.ID=TABLE2.ID 
```

Obs: Table1 和 Table2 我刚刚添加解释

谢谢。

* * *

我必须使用 UNION 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:22:34.207

不，您不必使用工会。如果我正确理解你的问题，它就像结合这样的事情一样简单：

```
FROM      [TABELA DE PRODUTOS/ESTOQUE]            AS T1,
          [TABELA DE PRODUTOS]                    AS T2,
          [TABELA DE MOVIMENTAÇÃO DE ESTOQUE]     AS T3A,
          [TABELA DE FORNECEDORES]                AS T4,
          [TABELA DE PRODUTOS/ESTOQUE]            AS T5,
LEFT JOIN 
          [TABELA DE MOVIMENTAÇÃO DE ESTOQUE]     AS T3B ON T1.ID=T3B.ID
WHERE (((T1.Produto)=[T2].[ID]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:23:45.497

```
FROM [TABELA DE PRODUTOS/ESTOQUE] AS TABLE1
LEFT JOIN [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] AS TABLE2
ON TABLE1.ID=TABLE2.ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:24:02.203

我了解您想在不使用 'JOIN 语法' 的情况下 OUTER JOIN 一个表？

您使用的是什么 DBMS？可以在 from 子句中执行此操作，但语法因 DBMS 而异。

例如，在 SQL Server 中，语法如下：

```
SELECT * 
FROM Table1, Table2
WHERE Table1.Id *= Table2.Id 
```

另一方面，据我所知，在 Oracle 中，您不使用星号，而是使用 (+)。

无论如何，我认为使用 JOIN 语法 (LEFT JOIN ... ) 更清晰

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:24:17.680

也许：

```
FROM [TABELA DE PRODUTOS/ESTOQUE] AS T1
, [TABELA DE PRODUTOS] AS T2
, [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] AS T3
, [TABELA DE FORNECEDORES] AS T4
, [TABELA DE PRODUTOS/ESTOQUE] AS T5
WHERE (T1.Produto=T2.ID OR T2.ID IS NULL)
ETC 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:26:02.200

如果你想离开你会做的所有表：

```
SELECT *
FROM [TABELA DE PRODUTOS/ESTOQUE] AS T1 
LEFT OUTER JOIN [TABELA DE PRODUTOS] AS T2 ON T1.Key = T2.Key
LEFT OUTER JOIN [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] AS T3 ON T2.Key = T3.Key
LEFT OUTER JOIN [TABELA DE FORNECEDORES] AS T4 ON T3.Key = T4.Key
LEFT OUTER JOIN [TABELA DE PRODUTOS/ESTOQUE] AS T5 ON T4.Key = T5.Key 
```

I think you have to clarify your question in order to stop our guessing.

# c# - 如何在没有冲突的情况下处理实体框架中的促销代码分配？

> ID：644455
> 
> 赞同：0
> 
> 时间：2009-03-13T20:14:20.747
> 
> 标签：c#, database, entity-framework, database-design, locking

假设我有一张促销代码表和一张联系人表。每个联系人可以有 1 个促销代码，每个促销代码只能分配给 1 个联系人。我将如何使用一个分配程序，从表中选择一个促销代码，并将其分配给一个联系人，而不会出现并发问题/冲突。

最坏的情况：

1.  联系人 A 请求代码。
2.  找到第一个可用的促销代码，并从 DB 中选择促销代码 A。
3.  联系人 B 请求代码。从数据库中找到并选择第一个可用的促销代码，促销代码 A。
4.  对联系人 A 的更改已保存。
5.  对联系人 B 的更改已保存。

现在，根据促销代码分配的存储方式，将发生 2 件事中的 1 件事：

1.  2 个联系人将分配相同的促销代码。
2.  在抛出重复键异常的情况下，联系人 B 将收到错误。

仅供参考，我正在使用 HTTPContext 中保存的 DataContext，以便每个 HTTP 请求都可以使用它。不确定这是否重要。

那么，使用 C# 和实体框架，我怎样才能在不遇到这些类型的冲突的情况下完成此促销代码分配？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T21:53:36.577

我会在促销代码表中添加一列，以便能够将代码标记为已使用。

读取促销代码将在可重复读取事务中完成，这也将促销代码标记为已使用。

这保证了促销代码只能使用一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:48:07.323

我不能做这样的事情：

```
UPDATE PromoCodes
SET Assigned = 1
ContactID = x
LIMIT 1 
```

这样，我就不需要事先阅读代码，只需将它分配过来，然后我可以得到它：

```
SELECT * FROM PromoCodes
Where ContactID = x 
```

对此方法有何评论？

# c++ - C++ - 构造函数重载 - 私有和公共

> ID：644461
> 
> 赞同：8
> 
> 时间：2009-03-13T20:15:56.810
> 
> 标签：c++, compiler-construction, constructor, overloading, private

你能告诉我为什么下面的代码给了我以下错误 -*重载“C（int）”的调用是模棱两可的*

我认为由于 C(char x) 是私有的，因此只有 C(float) ctor 从外部可见，应该通过将 int 转换为 float 来调用它。

但事实并非如此。

```
class C
{
    C(char  x)
    {
    }
public:
    C(float t)
    {
    }
};

int main()
{
    C p(0);
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-13T20:18:38.457

Scott Meyer 在“Effective C++”中对此进行了讨论。这是模棱两可的原因是他们想确保仅仅改变成员的可见性不会改变其他地方已经存在的代码的含义。

否则，假设您的 C 类位于某个标题中。如果您有一个私有的 C(int) 成员，那么您提供的代码将调用 C(float)。如果由于某种原因 C(int) 成员被公开，旧代码会突然调用该成员，即使*旧代码和它调用的函数都没有改变*。

编辑：更多原因：

更糟糕的是，假设您有以下 2 个功能：

```
C A::foo() 
{
    return C(1.0);
}

C B::bar() 
{
    return C(1.0);
} 
```

这两个函数可以调用不同的函数，具体取决于 foo 或 bar 是否被声明为 C 的友元，或者 A 或 B 是否继承自 C。相同的代码调用*不同*的函数是可怕的。

（这可能不如 Scott Meyer 的讨论那么好，但这就是想法。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T20:18:41.720

0 是一种`int`类型。因为它可以同等地隐式转换为 float 或 char，所以调用是不明确的。**可见性与这些目的无关。**

要么 put `0.0`, `0.`, or `0.0f`, 要么完全摆脱`C(char)`构造函数。

编辑：标准的相关部分，第 13.3 节：

> 3) [...] 但是，一旦确定了候选函数和参数列表，最佳函数的选择在所有情况下都是相同的：
> 
> *   首先，候选函数的一个子集——那些具有适当数量的参数并满足某些其他条件的函数——被选择来形成一组可行的函数（13.3.2）。
> *   然后根据将每个参数与每个可行函数的相应参数匹配所需的隐式转换序列 (13.3.3.1) 选择最佳可行函数。
> 
> 4) 如果存在最佳可行函数并且是唯一的，则重载决议成功并产生它作为结果。否则重载解析失败并且调用格式错误。当重载决议成功，并且最佳可行函数在使用它的上下文中不可访问（第 11 条）时，程序是非良构的。

请注意，可见性不是选择过程的一部分。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-13T20:19:39.533

我不这么认为：

```
C p(0); 
```

正在转换为：

```
C(float t) 
```

你可能需要做：

```
C p(0.0f); 
```

# asp.net - ODBC 驱动程序一般错误：尝试了两个活动数据库请求

> ID：644463
> 
> 赞同：1
> 
> 时间：2009-03-13T20:16:22.207
> 
> 标签：asp.net, odbc, sqlanywhere

我正在使用 ASP.NET 2.0 连接到 Sybase SQL Anywhere 5 服务器。我偶尔会收到这个错误。它只是有时会发生。错误信息是：

> 错误 [HY000] [Sybase][ODBC 驱动程序]一般错误：尝试了两个活动数据库请求
> 
> 异常详细信息：System.Data.Odbc.OdbcException：错误 [HY000] [Sybase][ODBC 驱动程序]
> 
> 一般错误：尝试了两个活动数据库请求

任何人都有这个问题的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T20:36:48.773

该错误消息意味着您尝试使用相同的数据库连接同时运行两个查询。

您是否尝试对所有请求使用相同的数据库连接？请求由多个线程处理，因此每个请求都需要有自己的数据库连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:36:53.670

听起来您正在为多个命令重用相同的连接。检查您是否在每个命令/命令批次之后正确处理连接，并且所有新命令都获得新连接。

# android - 无法调试 Android 应用程序

> ID：644469
> 
> 赞同：8
> 
> 时间：2009-03-13T20:17:11.427
> 
> 标签：android, debugging

我尝试在模拟器上调试 android 应用程序，而不是在设备上调试，但我一直收到消息“等待调试器 - 等待调试器附加到进程”。

我真的不知道如何设置环境和应用程序以运行调试。

如果你们中的任何人能提供任何有用的提示，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T10:23:19.703

问题出在主机配置文件中（C:\Windows\System32\drivers\etc\hosts）

换线后

```
::1         localhost 
```

和

```
127.0.0.1   localhost 
```

一切正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T17:15:38.897

您可能想尝试等待更长的时间。很多个月前我第一次在我的机器上启动它时，我遇到了同样的问题。花了大约 20 或 30 分钟，但它终于出现了。

# django - 如何确定用户何时在 Django 中有空闲超时？

> ID：644471
> 
> 赞同：5
> 
> 时间：2009-03-13T20:17:12.813
> 
> 标签：django, session-timeout

当用户在我的 Django 应用程序中遇到空闲超时时，我想进行审核。换句话说，如果用户的会话 cookie 的过期日期超过了 settings.py 中的 SESSION_COOKIE_AGE，用户将被重定向到登录页面。当这种情况发生时，也应该进行审计。通过“审计”，我的意思是应该将记录写入我的 person.audit 表。

目前，我已经配置了一些中间件来捕获这些事件。不幸的是，当用户被重定向到登录页面时，Django 会生成一个新的 cookie，因此我无法确定用户是否通过空闲超时或其他事件被带到登录页面。

据我所知，我需要使用“django_session”表。但是，此表中的记录无法与该用户关联，因为 cookie 中的 sessionid 值在重定向发生时被重置。

我猜我不是第一个遇到这种困境的人。有没有人知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T23:31:38.633

## 更新：

经过一番测试，我意识到下面的代码不能回答你的问题。尽管它有效，并且信号处理程序被调用，`prev_session_data`但如果它存在，则不会包含任何有用的信息。

首先，深入了解会话框架：

1.  当新访问者请求应用程序 URL 时，会为他们生成一个新会话 - 此时，他们仍然是匿名的（`request.user`是 AnonymousUser 的一个实例）。
2.  如果他们请求需要身份验证的视图，他们将被重定向到登录视图。
3.  当请求登录视图时，它会在用户的会话中设置一个测试值（`SessionStore._session`）；这会自动设置当前会话的`accessed`and`modified`标志。
4.  在上述请求的响应阶段，`SessionMiddleware`保存当前会话，有效地`Session`在表中创建一个新实例`django_session`（如果您使用由 提供的默认数据库支持的会话`django.contrib.sessions.backends.db`）。新会话的 id 保存在`settings.SESSION_COOKIE_NAME`cookie 中。
5.  当用户输入他们的用户名和密码并提交表单时，他们就通过了身份验证。如果认证成功，则调用`login`from 方法。检查当前会话是否包含用户 ID；如果是，并且 ID 与登录用户的 ID 相同，则调用以创建新的会话密钥，同时保留会话数据。否则，调用，以删除所有数据并生成新会话。这两种方法都应该删除前一个会话（对于匿名用户），并调用创建一个新会话。`django.contrib.auth``login``SessionStore.cycle_key``SessionStore.flush``SessionStore.create`
6.  此时，用户已通过身份验证，并且他们有一个新会话。他们的 ID 与用于验证他们的后端一起保存在会话中。会话中间件将此数据保存到数据库中，并将它们的新会话 ID 保存在`settings.SESSION_COOKIE_NAME`.

所以你看，前一个解决方案的最大问题是在`create`被调用时（第 5 步），前一个会话的 ID 早已不复存在。正如[其他人指出的那样](http://groups.google.co.in/group/django-users/browse_thread/thread/7ada69977dcc13f0)，发生这种情况是因为一旦会话 cookie 过期，它就会被浏览器静默删除。

基于[Alex Gaynor 的建议](http://groups.google.co.in/group/django-users/browse_thread/thread/7ada69977dcc13f0#msg_10175bb52e35b113)，我想我想出了另一种方法，这似乎可以满足您的要求，尽管边缘仍然有些粗糙。基本上，我使用第二个长期存在的“审计”cookie 来镜像会话 ID，并使用一些中间件来检查该 cookie 的存在。对于任何请求：

*   如果审计 cookie 和会话 cookie 都不存在，这可能是一个新用户
*   如果审计 cookie 存在，但会话 cookie 不存在，这可能是会话刚刚过期的用户
*   如果两个 cookie 都存在并且具有相同的值，则这是一个活动会话

这是到目前为止的代码：

*sessionaudit.middleware.py*：

```
from django.conf import settings
from django.db.models import signals
from django.utils.http import cookie_date
import time

session_expired = signals.Signal(providing_args=['previous_session_key'])

AUDIT_COOKIE_NAME = 'sessionaudit'

class SessionAuditMiddleware(object):
    def process_request(self, request):
        # The 'print' statements are helpful if you're using the development server
        session_key = request.COOKIES.get(settings.SESSION_COOKIE_NAME, None)
        audit_cookie = request.COOKIES.get(AUDIT_COOKIE_NAME, None)
        if audit_cookie is None and session_key is None:
            print "** Got new user **"
        elif audit_cookie and session_key is None:
            print "** User session expired, Session ID: %s **" % audit_cookie
            session_expired.send(self.__class__, previous_session_key=audit_cookie)
        elif audit_cookie == session_key:
            print "** User session active, Session ID: %s **" % audit_cookie

    def process_response(self, request, response):
        if request.session.session_key:
            audit_cookie = request.COOKIES.get(AUDIT_COOKIE_NAME, None)
            if audit_cookie != request.session.session_key:
                # New Session ID - update audit cookie:
                max_age = 60 * 60 * 24 * 365  # 1 year
                expires_time = time.time() + max_age
                expires = cookie_date(expires_time)
                response.set_cookie(
                    AUDIT_COOKIE_NAME,
                    request.session.session_key,
                    max_age=max_age,
                    expires=expires,
                    domain=settings.SESSION_COOKIE_DOMAIN,
                    path=settings.SESSION_COOKIE_PATH,
                    secure=settings.SESSION_COOKIE_SECURE or None
                )
        return response 
```

*审计模型.py*：

```
from django.contrib.sessions.models import Session
from sessionaudit.middleware import session_expired

def audit_session_expire(sender, **kwargs):
    try:
        prev_session = Session.objects.get(session_key=kwargs['previous_session_key'])
        prev_session_data = prev_session.get_decoded()
        user_id = prev_session_data.get('_auth_user_id')
    except Session.DoesNotExist:
        pass

session_expired.connect(audit_session_expire) 
```

*设置.py*：

```
MIDDLEWARE_CLASSES = (
    ...
    'django.contrib.sessions.middleware.SessionMiddleware',
    'sessionaudit.middleware.SessionAuditMiddleware',
    ...
)

INSTALLED_APPS = (
    ...
    'django.contrib.sessions',
    'audit',
    ...
) 
```

如果你正在使用它，你应该实现一个自定义的注销视图，当用户注销时，它会显式地删除审计 cookie。另外，我建议使用 django signed-cookies 中间件（但您可能已经这样做了，不是吗？）

## 老的：

我认为您应该能够使用自定义会话后端来做到这一点。这是一些（未经测试的）示例代码：

```
from django.contrib.sessions.backends.db import SessionStore as DBStore
from django.db.models import signals

session_created = signals.Signal(providing_args=['previous_session_key', 'new_session_key'])

class SessionStore(DBStore):
    """
    Override the default database session store.

    The `create` method is called by the framework to:
    * Create a new session, if we have a new user
    * Generate a new session, if the current user's session has expired

    What we want to do is override this method, so we can send a signal
    whenever it is called.
    """

    def create(self):
        # Save the current session ID:
        prev_session_id = self.session_key
        # Call the superclass 'create' to create a new session:
        super(SessionStore, self).create()
        # We should have a new session - raise 'session_created' signal:
        session_created.send(self.__class__, previous_session_key=prev_session_id, new_session_key=self.session_key) 
```

将上面的代码保存为“customdb.py”并将其添加到您的 django 项目中。在您的 settings.py 中，将“SESSION_ENGINE”设置或替换为上述文件的路径，例如：

```
SESSION_ENGINE = 'yourproject.customdb' 
```

然后在您的~~中间件或~~models.py 中，为“session_created”信号提供一个处理程序，如下所示：

```
from django.contrib.sessions.models import Session
from yourproject.customdb import session_created

def audit_session_expire(sender, **kwargs):
    # remember that 'previous_session_key' can be None if we have a new user
    try:
        prev_session = Session.objects.get(kwargs['previous_session_key'])
        prev_session_data = prev_session.get_decoded()
        user_id = prev_session_data['_auth_user_id']
        # do something with the user_id
    except Session.DoesNotExist:
        # new user; do something else...

session_created.connect(audit_session_expire) 
```

不要忘记包含包含`models.py`in的应用程序`INSTALLED_APPS`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-26T17:55:10.940

SESSION_COOKIE_AGE = 1500 # 25 分钟

将其放入您的设置中，这应该会解决这个问题并使会话到期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T22:56:01.950

我不了解 Django，但是您可以简单地创建一个非持久性 cookie，它存储对您网站上页面的最后访问时间（您在每个页面加载时更新 cookie）

然后，在您的登录页面上，您可以检查您的用户是否有您的 cookie，但没有会话，那么，您知道用户的会话可能已经超时。由于您有最后一次访问网站页面的时间，因此您还可以根据会话的持续时间计算它是否已超时。

# jquery - 在 jcarousel 中使用 'offset' - 通过类名

> ID：644472
> 
> 赞同：0
> 
> 时间：2009-03-13T20:17:20.957
> 
> 标签：jquery, jcarousel

我正在尝试设置 jcarousel，以便缩略图通过类名进行*偏移。*示例：十二个缩略图的列表，其中 class="active" 的一个缩略图显示为 jcarousel 容器中的第一个可见缩略图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T22:43:29.427

I stumbled across a few links asking for this same thing. In fact, they may all be posts from you. Anyhow, I know this is a couple months old at this point, but just in case someone else still needs the info, there appears to be a solution [here](http://cssbeauty.com/skillshare/discussion/3098/tricky-jcarousel-question/).

Good luck!

# nhibernate - 流畅的休眠模式生成

> ID：644496
> 
> 赞同：4
> 
> 时间：2009-03-13T20:24:00.880
> 
> 标签：nhibernate, fluent-nhibernate, ddl, s#arp-architecture

作为 S#arp 架构的一部分，我一直在使用 FluentNhibernate。下面是一个示例映射。

```
public class EventBaseMap : ClassMap<EventBase>
{
    public EventBaseMap()
    {
        WithTable("Event_Header");
        //NotLazyLoaded(); 

        Id(x => x.Id).WithUnsavedValue(-1).GeneratedBy.Native();

        Map(x => x.Name).WithLengthOf(50).Not.Nullable();
        Map(x => x.Description).WithLengthOf(255);
        Map(x => x.Rating);
        Map(x => x.Price);
        Map(x => x.PhoneNumber).WithLengthOf(20).Not.Nullable();
        Map(x => x.EmailAddress);
        Map(x => x.Website);
        Map(x => x.State).Not.Nullable().CustomSqlTypeIs("INT");

        Component(x => x.Ages, m =>
         {
             m.Map(x => x.From).TheColumnNameIs("AgeFrom");
             m.Map(x => x.To).TheColumnNameIs("AgeTo");
         });

        HasMany(x => x.Calendar).AsBag();

        HasManyToMany(x => x.Tags)
            .WithTableName("Event_Tags")
            .WithParentKeyColumn("EventId")
            .WithChildKeyColumn("TagId").AsBag();
    }
} 
```

然后我使用 Nhibernate 模式生成将我的 ddl 输出到文件。

```
FileInfo t = new FileInfo(Server.MapPath("~/bin/MyDDL.sql"));
        StreamWriter writer = t.CreateText();

        new SchemaExport(cfg).Execute(true, false, false, true, NHibernateSession.Current.Connection, writer); 
```

到现在为止还挺好。但是，为该表生成的 ddl 不匹配，实际上包含错误。

```
create table Event_Header (
   Id INT IDENTITY NOT NULL,
   EmailAddress NVARCHAR(255) null,
   PhoneNumber NVARCHAR(255) null,
   State string null,
   Website NVARCHAR(255) null,
   Description NVARCHAR(255) null,
   Name NVARCHAR(255) null,
   Price DECIMAL(19,5) null,
   Rating INT null,
   AgeTo INT null,
   AgeFrom INT null,
   primary key (Id)
) 
```

*   即使我试图强制它使用 INT，枚举状态也表示为字符串
*   电话号码长度与映射不匹配。

我想知道如何进行调试。这是 FluentNH 中的映射问题还是模式生成器的问题。如果我可以输出生成的 xml，那么我可以验证。有谁知道如何做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T22:35:51.357

[Fluent Configuration](http://wiki.fluentnhibernate.org/show/FluentConfiguration)允许您导出 XML。

您的#arch 副本有多新，更具体地说，您知道它使用的是哪个 Fluent NHibernate 版本吗？

enum is type 被一个约定覆盖，该约定指定枚举应该映射为字符串，而不是使用`CustomSqlType`try 只是 using `CustomTypeIs<int>()`。

至于列的长度，这听起来像是一个错误，但它是否仍然是一个问题将取决于您正在运行的版本。

# inversion-of-control - Unity Framework：如何从同一个接口实例化两个类？

> ID：644501
> 
> 赞同：2
> 
> 时间：2009-03-13T20:25:18.550
> 
> 标签：inversion-of-control, unity-container

我有一个接口和 2 个实现它的类，我需要加载每个类，但统一有：

m_unityContainer.Resolve() //接口IGeneric在哪里

我的配置看起来像：

```
 <type type="IGeneric" mapTo="ClassA">
      </type>
      <type type="IGeneric" mapTo="ClassB">
      </type> 
```

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T00:42:27.093

您还可以使用如下通用接口：

```
public interface IGeneric{}

public interface IGeneric<T> : IGeneric{} 
```

然后对接口进行**类型安全**解析：

```
container.RegisterType<IGeneric<ClassA>, ClassA>();
container.RegisterType<IGeneric<ClassB>, ClassB>();

ClassA classA = container.Resolve<IGeneric<ClassA>>();
ClassB classB = container.Resolve<IGeneric<ClassB>>(); 
```

当你走这条路时，一些有趣的事情开始发生......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T21:03:24.030

这将为您提供所有实现 IGeneric 的注册类。

```
IEnumerable<IGeneric> objects = container.ResolveAll<IGeneric>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T22:04:15.743

沙尔克 - 看起来不错。在 Unity.config 中指定的符号是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T15:11:24.297

我找到了解决方案，必须在每个条目中使用 name 属性：

并且代码看起来像 obj= container.ResolveAll("ClassA");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T14:17:16.613

这是一种稍微不同的方式。我正在使用 Unity.2.1.505.2（以防万一）。

```
 <configSections>
    <section name="unity" type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection, Microsoft.Practices.Unity.Configuration"/>
  </configSections>

      <unity>
        <container>
          <register type="IVehicle" mapTo="Car" name="myCarKey" />
          <register type="IVehicle" mapTo="Truck" name="myTruckKey" />
        </container>
      </unity> 
```

这是 DotNet 代码。

```
 UnityContainer container = new UnityContainer();

        UnityConfigurationSection section = (UnityConfigurationSection)ConfigurationManager.GetSection("unity");
        section.Configure(container);

IVehicle v1 = container.Resolve<IVehicle>("myCarKey"); 

IVehicle v2 = container.Resolve<IVehicle>("myTruckKey"); 
```

看：

[http://msdn.microsoft.com/en-us/library/ff664762(v=pandp.50).aspx](http://msdn.microsoft.com/en-us/library/ff664762(v=pandp.50).aspx)

# .net - 如何在某些文本中找到所有指南？

> ID：644504
> 
> 赞同：4
> 
> 时间：2009-03-13T20:25:50.110
> 
> 标签：.net, vb.net, regex, guid

我的数据库中有一堆网页内容，链接如下：

```
<a href="/11ecfdc5-d28d-4121-b1c9-1f898ac0b72e">Link</a> 
```

该 Guid 唯一标识符是同一数据库中*另一个页面的 ID。*

我想抓取这些页面并检查是否有损坏的链接。

为此，我需要一个可以返回页面上所有 Guid 列表的函数：

```
函数 FindGuids(ByVal Text As String) As Collections.Generic.List(Of Guid)
    ...
结束功能

```

我认为这是正则表达式的工作。但是，我不知道语法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T20:30:53.513

> [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f ]{12}

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T20:39:28.830

```
函数 FindGuids(ByVal Text As String) As List(Of Guid)
    Dim Guids 作为新列表（Guid）
    暗模式作为字符串 = "[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}"
    对于每个 m 作为 Regex.Matches(Text, Pattern) 中的匹配项
        Guids.Add(新的 Guid(m.Value))
    下一个
    返回指南
结束功能

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T20:33:36.673

建议您获取一份免费的[expresso](http://www.ultrapico.com/Expresso.htm)并学习构建它们！

这是一个没有优化的 10 秒尝试，检查大小写并创建一个编号的捕获组：

```
([a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}) 
```

然后你只需要遍历匹配的组......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T20:29:01.990

有更简单的方法来检查损坏的链接....例如，我认为[http://www.totalvalidator.com/](http://www.totalvalidator.com/)会这样做：D

这也可以帮助

```
static Regex isGuid = 
    new Regex(@"^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$", RegexOptions.Compiled); 
```

进而

```
static bool IsGuid(string candidate, out Guid output)
{
bool isValid = false;
output=Guid.Empty;
if(candidate!=null)
{

 if (isGuid.IsMatch(candidate))
 {
  output=new Guid(candidate);
  isValid = true;
 }
}
return isValid; 
```

}

# timer - CPU时钟频率和QueryPerformanceCounter错了吗？

> ID：644510
> 
> 赞同：9
> 
> 时间：2009-03-13T20:28:27.123
> 
> 标签：timer

我正在使用 QueryPerformanceCounter 来计时一些代码。当代码开始报告明显错误的时间时，我感到震惊。要将 QPC 的结果转换为“实时”时间，您需要除以从 QueryPerformanceFrequency 返回的频率，因此经过的时间为：

时间 = (QPC.end - QPC.start)/QPF

重启后，QPF 频率从 2.7 GHz 变为 4.1 GHz。我不认为实际的硬件频率改变了，因为运行程序的挂钟时间没有改变，尽管使用 QPC 报告的时间确实发生了变化（下降了 2.7/4.1）。

MyComputer->Properties 显示：

英特尔(R) 奔腾(R) 4 CPU 2.80 GHz；4.11GHz；1.99 GB 内存；物理地址扩展

除此之外，该系统似乎运行良好。

我将尝试重新启动以查看问题是否解决，但我担心这些关键性能计数器可能会在没有警告的情况下失效。

更新：

虽然我很欣赏答案，尤其是链接，但我没有受影响的芯片组之一，也没有会自行变化的 CPU 时钟。根据我的阅读，QPC 和 QPF 基于 PCI 总线中的计时器，不受 CPU 时钟变化的影响。在我的情况下，奇怪的是 QPF 报告的 FREQUENCY 更改为不正确的值，并且此更改的频率也在 MyComputer -> Properties 中报告，我当然没有写。

重新启动解决了我的问题（QPF 现在报告了正确的频率），但我假设如果您打算使用 QPC/QPF，您应该在信任它之前针对另一个计时器对其进行验证。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T20:59:43.150

显然，某些芯片组上的 QPC 存在已知[问题](http://support.microsoft.com/kb/274323)，因此您可能需要确保您没有这些芯片组。此外，一些双核 AMD 也可能导致[问题](http://forum.beyond3d.com/showthread.php?t=47951)。请参阅 sebbbi 的第二篇文章，他在其中指出：

> QueryPerformanceCounter() 和 QueryPerformanceFrequency() 提供了更好的分辨率，但有不同的问题。例如，在 Windows XP 中，所有 AMD Athlon X2 双核 CPU “随机”返回任一内核的 PC（PC 有时会向后跳一点），除非您专门安装 AMD 双核驱动程序包来解决此问题。我们没有注意到任何其他双核 CPU 有类似问题（p4 dual、p4 ht、core2 dual、core2 quad、phenom quad）。

从这个[答案](https://stackoverflow.com/questions/275004/c-timer-function-to-provide-time-in-nano-seconds/275231#275231)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T06:09:15.060

您应该**始终**期望任何支持[SpeedStep](http://en.wikipedia.org/wiki/SpeedStep)或[Cool'n'Quiet](http://en.wikipedia.org/wiki/Cool'n'Quiet)等技术的 CPU 的核心频率都会发生变化。挂墙时间不受影响，它使用[RTC](http://en.wikipedia.org/wiki/Real-time_clock)。您可能应该停止使用性能计数器，除非您可以容忍几（5-50）毫秒的偶尔相位调整，并且愿意执行一些数学运算以便通过连续或定期重新规范化您的基于报告的性能计数器频率和 RTC 低分辨率时间的性能计数器值（您可以按需执行此操作，也可以从高分辨率计时器异步执行此操作，具体取决于您的应用程序的最终需求。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T20:28:50.663

您可以尝试使用 .NET 中的[Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)类，它可以帮助您解决问题，因为它从所有这些低级的东西中抽象出来。

使用 IsHighResolution 属性查看计时器是否基于高分辨率性能计数器。

> 注意：在多处理器计算机上，线程运行在哪个处理器上并不重要。但是，由于 BIOS 或硬件抽象层 (HAL) 中的错误，您可以在不同的处理器上获得不同的计时结果。要为线程指定处理器关联，请使用 ProcessThread..::.ProcessorAffinity 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T22:58:22.803

只是在黑暗中开枪。

在我的家用电脑上，我曾经在 BIOS 中启用了“AI NOS”或类似的东西。我怀疑这搞砸了 QueryPerformanceCounter/QueryPerformanceFrequency API，因为尽管系统时钟以正常速率运行，并且正常应用程序运行完美，但所有全屏 3D 游戏的运行速度都太快了大约 10-15%，例如，导致相邻的对话行在游戏中互相绊倒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T16:07:17.320

恐怕您在使用 QueryPerformance* 时不能说“我不应该有这个问题” - 虽然文档指出 QueryPerformanceFrequency 返回的值是恒定的，但实际实验表明它确实不是。

但是，您也不希望每次调用 QPC 时都调用 QPF。在实践中，我们发现周期性地（在我们的例子中是每秒一次）调用 QPF 来获得一个新的值可以使定时器保持足够好的同步，以进行可靠的分析。

正如已经指出的那样，您需要将所有 QPC 调用保留在单个处理器上以获得一致的结果。虽然这对于分析目的可能无关紧要（因为您可以只使用 ProcessorAffinity 将线程锁定到单个 CPU 上），但您不想为作为适当多线程应用程序的一部分运行的计时执行此操作（因为那时您冒着将辛苦工作的线程锁定到繁忙的 CPU 的风险）。

特别是不要随意锁定到 CPU 0，因为您可以保证其他一些编码错误的应用程序也这样做了，然后两个应用程序将在 CPU 1（或 2 或 3）空闲时在 CPU 0 上争夺 CPU 时间。从一组可用的 CPU 中随机选择，您至少有机会避免被锁定到过载的 CPU。

# java - 从 Java Web 服务启动外部进程的最佳方式？

> ID：644511
> 
> 赞同：2
> 
> 时间：2009-03-13T20:28:37.060
> 
> 标签：java, web-services, weblogic

我继承了 Java Web 服务代码库（BEA/Oracle Weblogic），需要从 Web 服务启动/启动外部后台应用程序。

我已经尝试过：

```
ProcessBuilder pb = new ProcessBuilder(arg);
pb.start(); 
```

也：

```
Runtime.exec(cmdString); 
```

但是在以这种方式启动应用程序时遇到了奇怪的行为（即，即使进程仍然处于活动状态，启动的应用程序也会停止工作。——从普通命令行手动运行时应用程序工作正常）。

有没有更好的方法来启动外部进程？

**编辑： - - - - - - - - - - -**

我有一些额外的信息可能有助于阐明这个问题。

*   我们尝试开始的过程需要几个小时才能完成，因此在 web 服务中等待完成（使用`waitfor()`）将不是一个理想的场景。
*   是的，我们试图从 web 服务开始的过程是由团队成员创建的 [提示：你的眼睛滚动......现在]

*当我使用进程构建器启动 bash 脚本时，我取得了成功*，其中外部应用程序作为*后台进程*启动（使用“&”）。

```
#!/bin/bash
java -jar myApp.jar & 
```

这显然会创建一个孤立的进程，但至少应用程序确实会继续执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T03:56:15.940

首先，这是发生在 Windows 上还是 Linux 上？另外，启动的应用程序或多或少应该做什么？（它是一个脚本吗？它是一个二进制文件吗？它是*你的*二进制文件吗？）

**编辑**

好的，所以启动一个`bash`脚本（使用`ProcessBuilder`），然后生成一个新的 JVM（`java -jar myApp.jar`）可以工作。

当您尝试*直接*使用生成新的 JVM 时会发生什么`ProcessBuilder`？你原来说：

> 启动的应用程序停止工作

1.  启动的应用程序是指“java -jar myApp.jar”，当直接调用时，*而不是*通过中间`bash`脚本？
2.  `ProcessBuilder`当您尝试直接启动 Java 并且这个新的 JVM 停止工作时，您传递给各种方法（以及以何种顺序）的确切和完整参数（及其值）是什么？（例如提供带注释的代码）
3.  如果您安装`lsof`在 *nix 机器上，运行时显示与文件描述符 2 相关联的文件（查看`FD`列）：（“挂起”JVM 的进程 ID 在`lsof -p 1234`哪里？）附加此处命令`1234`的完整输出。`lsof`
4.  您在上面的步骤 3 中标识的文件（对于文件描述符 2）附加了什么，在您发出命令后最多几秒钟：（“挂起”JVM 的进程 ID 在`kill -QUIT 1234`哪里？）`1234`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T20:17:37.370

通过“即使进程仍然处于活动状态也停止工作”我假设您可能期望从您启动的应用程序中获得一些输出而没有得到任何东西。

尝试使用以下内容：

```
ProcessBuilder pb = new ProcessBuilder(arg);
Process p = pb.start();
p.waitFor(); 
```

如有必要，waitFor() 使当前线程等待，直到此 Process 对象表示的进程终止。

[http://java.sun.com/javase/6/docs/api/java/lang/Process.html#waitFor()](http://java.sun.com/javase/6/docs/api/java/lang/Process.html#waitFor())

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-17T21:57:48.393

简单地说：如果启动的应用程序写入 SDTOUT/STDIN 并且您不经常刷新它们（请参阅 Process.getErrorStream/Process.getInputStream），那么当缓冲区已满时进程将阻塞（非常小，4KB 或更少） .

我建议您在开始流程之前调用 ProcessBuilder.redirectErrorStream() 。然后，之后，使用 run() 方法创建一个线程，如下所示：

```
public void run() {
    BufferedReader reader = 
        new BufferedReader(new InputStreamReader(process.getInputStream()));
    String line;
    while ((line = reader.readLine()) != null) {
        System.out.println(line);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T02:44:06.457

您是否正确处理流程的标准输入和输出？如果您的应用程序正在处理标准输入或输出并且您没有正确处理它，那么您执行的进程将挂起等待 I/O。

一种测试方法是编写一个运行程序的脚本，将标准输入、输出和错误重定向到文件。然后让您的 Web 服务应用程序运行脚本而不是程序。如果程序以这种方式运行完成，那么问题在于处理过程的输出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:39:18.970

我猜问题可能是启动进程的线程被终止或请求结束后的任何事情。尝试在应用程序中有一个您确定始终保持活动状态的单个线程，您可以通过从其他线程调用它来使用它来启动进程。

# open-source - 如何在商业上利用开源项目？

> ID：644516
> 
> 赞同：3
> 
> 时间：2009-03-13T20:32:02.263
> 
> 标签：open-source

假设您参与了一个已经存在了 5 到 10 年之久的开源项目 (GPL'ed)，在此期间它已经相当成功 - 尽管有很多商业/专有替代方案。

现在，您已经意识到长期贡献者希望在商业上利用该项目，甚至可能是为了谋生或以此为基础创办公司。这样他们就可以专门从事这项工作，而不依赖于其他不相关的工作。

那么，将开源/GPL 项目转变为商业“成功”（在自给自足的意义上）的一些可行和推荐的步骤是什么，以便长期贡献者可以最好地为项目工作而获得报酬，**不**影响项目本身的开源性质？

换句话说，开源软件的一些更常见的创收机制通常是什么，以及如何成功引入/实施这些机制 - 还有哪些先决条件/条件适用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:34:14.787

几年前我看到一家公司采用了一些 OSS 垃圾邮件和病毒过滤器，构建了一个 Web 界面来一次性管理它们，将其放在 1U 服务器上，并将其作为网络安全设备出售。

对于希望为所有垃圾邮件和病毒过滤提供单一解决方案、自动更新且易于管理的中型公司来说，这是一款不错的产品。

从技术上讲，他们只是在销售服务器和 Web 管理工具，所有 OSS 组件都是免费提供的，如果您想花时间单独设置它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:43:17.917

You should think in terms of the "product halo," which refers to all of the related items and services surrounding a product that are not the product itself. For example, [MySQL](http://www.mysql.com/) is open source and freely downloadable, but its product halo could include [services](http://www.mysql.com/services/) like installation, customization, consulting, training, etc. Or Zend [contributes heavily](http://www.zend.com/en/company/) to PHP and offers [Zend framework](http://framework.zend.com/), but they also have a number of [commercial products](http://www.zend.com/en/products/) surrounding those offerings. [Active State](http://www.activestate.com/) creates the Komodo IDE and has an [open source version](http://www.activestate.com/komodo_edit/) and then a [commercial version](http://www.activestate.com/komodo/) that extends the open source version. Or take [Linux](http://www.businessweek.com/magazine/content/05_05/b3918001_mz001.htm)...or any other number of examples. A book that you might find interesting on the topic is [Wikinomics](http://wikinomics.com/book/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T20:39:39.297

我认为主要问题是项目所有者采用的商业模式以及想要将其转化为收入的人。这将取决于它是什么类型的项目，例如最终用户产品或软件 API。在最终用户项目的情况下，软件即服务作为一种商业模式似乎是一个非常好的选择。

寻找成功项目的示例和案例研究，例如 apache、firefox、sugarCRM...

专注于特定的利基市场也是一件非常重要的事情。

# c# - 生成带有一些透明部分的图像

> ID：644519
> 
> 赞同：2
> 
> 时间：2009-03-13T20:33:15.710
> 
> 标签：c#, image, bitmap

我试图生成一个 32 x 32 像素的小正方形，中间有一个 10 x 10 的方形透明间隙。

这是我到目前为止所拥有的：

```
private Image CreatePicture(){
    // Create a new Bitmap object, 32 x 32 pixels in size
    Bitmap canvas = new Bitmap(32,32,System.Drawing.Imaging.PixelFormat.Format16bppRgb555);
    for(int i=10;i<21;i++){
        for(int p=10;p<21;p++){
            canvas.SetPixel(i,p,Color.Lime);
        }
    }
    canvas.MakeTransparent(Color.Lime);
    // return the picture
    return canvas;
} 
```

它很粗糙，不会成为最终的“优化版本”，它只是一个粗糙的演示脚本。问题是返回的图像不透明，而只是一个灰色框:(。

任何帮助表示赞赏。

迈克尔

更新：我已将脚本更新为 PixelFormat 设置为 Alpha RGB 格式，它实际上可以接受而不会在运行时出错。现在，如果我删除“canvas.MakeTransparent(Color.Lime);” 行它在中间显示一个石灰框，它只显示一个与灰色背景颜色相同的灰色框；所以似乎透明度被认可只是不暗示透明度！

```
private Bitmap CreatePicture(){
    // Create a new Bitmap object, 50 x 50 pixels in size
    Bitmap canvas = new Bitmap(82,82,System.Drawing.Imaging.PixelFormat.Format32bppArgb);

    for(int i=10;i<71;i++){
        for(int p=10;p<71;p++){
            canvas.SetPixel(i,p,Color.Lime);
        }
    }
    canvas.MakeTransparent(Color.Lime);
    // return the picture
    return canvas;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T20:38:13.497

```
[...]Format16bppRgb555 
```

尝试在此处使用带有 Alpha 通道 (...Rgba) 的某种格式。此外，如果稍后输出图像，请确保使用支持 Alpha 通道的图像格式，例如 PNG。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:38:24.260

这取决于您将如何使用或显示图像。PNG 和 Gif 是支持透明度的两种文件格式。

对于透明度的位图设置，我使用：

Graphics.FromImage(bitmap).FillRectangle(Brushes.Transparent, ...) 将我想要的区域设置为透明，然后我将文件保存为 PNG 以获得具有透明度的图像。

我还尝试了 MakeTransparent 方法并遇到了问题，而 Brushes.Transparent 是适合我情况的解决方案。

希望这能给你一个研究方向。

最后一点，我只创建了具有宽度和高度的位图对象，我没有指定像素格式或所谓的任何内容，即 bitmap = New Bitmap(width, height);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:38:14.933

您可能需要将图像格式更改为 Format16bppArgb1555。

现在，您使用的是 Format32bppArgb 或 Format16bppRgb555，它是每像素 16 位，没有 alpha 信息。透明度要求存在 Alpha 通道或 Alpha 位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T00:59:29.640

我不只是`SetPixel()`为了[Color.Transparent](http://msdn.microsoft.com/en-us/library/system.drawing.color.transparent.aspx)吗？而不是 Color.Lime`MakeTransparent`呢？正如其他人所指出的那样；您需要带有 Alpha 通道的像素格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T00:26:04.887

MakeTransparent 函数确实有效。您有“灰色补丁”，因为您的 TransparencyKey 不正确。您会发现，如果您将 TransparencyKey 属性设置为灰色补丁的任何颜色，当您的图像显示时，灰色补丁确实会变得透明。我得到的默认灰色补丁在颜色上被标记为“控制”，或者基本上是默认的 Windows 窗体背景颜色。将您的 TransparencyKey 更改为您的灰色补丁（在我的情况下为 Control），您的问题将得到解决，无需将文件保存到硬盘驱动器。队友的欢呼声。

# vb.net - 我可以在我的作业中获得一些帮助，以计算所呈现服务的提示吗？

> ID：644522
> 
> 赞同：0
> 
> 时间：2009-03-13T20:33:42.713
> 
> 标签：vb.net

程序应请求此人的职业、账单金额和小费百分比作为输入，并将此信息传递给子程序以显示此人和小费。标题是小费，第一行人的职业，账单金额：，百分比小费：计算小费，并显示小费。我不确定如何正确处理它。任何帮助是极大的赞赏。

```
Public Class Form1

Private Sub btnCompute_Click(ByVal sender As System.Object, ByVal e As _
    System.EventArgs) Handles btnCompute.Click

    Dim Occupation As String = CStr(txtOccupation.Text)
    Dim Bill As Double = CDbl(txtBill.Text)
    Dim Tip As Double = CDbl(txtTip.Text)

    lstOuput.Text = 'hmmmmm.....'

End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:36:12.660

```
lstOutput.Text = Bill * (1 + If(Tip<1,Tip,Tip/100)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:36:52.347

由于您已将 Bill 和 Tip 分配给 double 变量，您可以将小费金额分配给另一个变量，或直接输出。

```
Dim Gratuity as Double = Bill * Tip

lstOutput.text = "Total Bill + Gratuity = " & string.format(Bill + Gratuity, "c") 
```

# wpf - WPF 应用程序中的图像显示小于在外部查看器中查看时的图像

> ID：644526
> 
> 赞同：8
> 
> 时间：2009-03-13T20:34:37.280
> 
> 标签：wpf, image, sizing

当我在我的 WPF 应用程序中显示 JPEG 时（使用以下代码），它显示的内容比我在 Windows 图片查看器中以实际大小打开 JPEG 时显示的要小得多。

我在运行时深入研究了 ImageSource 的属性，并且我的图像具有：

*   DPI 为 219
*   高度为 238.02739726027397
*   宽度为 312.54794520547944
*   像素高度为 543
*   和 713 的 PixelWidth

当我使用屏幕标尺测量图像的 WPF 显示时，我得到大约。313x240 像素（如果我可以完美地定位标尺，它可能等于 ImageSource 报告的宽度和高度。）。

我的直觉告诉我这与 WPF 使用与设备无关的单位（而不是像素）有关，但我无法理解，我仍然需要知道如何以 543x713 的“实际”尺寸显示图像在我的应用程序中。

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Height="300" Width="300">
    <StackPanel>
        <Image Source="Image15.jpg" Stretch="None" />
    </StackPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T21:01:03.457

谢谢马克！我根据你的信息做了一些谷歌搜索，发现[这篇文章](http://genesisconduit.wordpress.com/2008/07/05/wpf-images-and-dpi-independence/)提供了一个解决方案来获得我想要的结果。这现在开始有意义了……

**编辑：链接。将文章中的关键文本粘贴到此处以供参考....**

```
<Image Source=”{Binding …}”
       Stretch=”Uniform”
       Width=”{Binding Source.PixelWidth,RelativeSource={RelativeSource Self}}”
       Height=”{Binding Source.PixelHeight,RelativeSource={RelativeSource Self}}” /> 
```

> 在这里，我们将 Stretch 设置为 Uniform，并将 Width 和 Height 绑定到 Source 的 PixelWidth 和 >PixelHeight，从而有效地忽略了 DPI。然而，即使使用 SnapToDevicePixels（它只是捕捉边界，而不是图像内的像素），图像也不会是像素 > 完美的。但是，3.5 SP1 中的 WPF 将支持 NearestNeighbor >BitmapScalingMode，这应该可以纠正这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T20:47:34.737

使用 96 的 DPI。WPF 正在根据以英寸为单位的大小缩放图像，而图像查看器显示像素。在大多数 Windows 系统上，假定屏幕分辨率为 96 DPI，因此在您的图像中使用它会导致一对一的转换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-21T06:29:51.617

或者，您可以扩展 Image 并实现 MeasureOverride 和 ArrangeOverride 以更改图像 DPI 的效果：

```
class DpiAgnosticImage : Image
{
    protected override Size MeasureOverride(Size constraint)
    {
        var bitmapImage = Source as BitmapImage;

        var desiredSize = bitmapImage == null 
            ? base.MeasureOverride(constraint) 
            : new Size(bitmapImage.PixelWidth, bitmapImage.PixelHeight);

        var dpiScale = MiscUtil.GetDpiScale(this);
        desiredSize = new Size(desiredSize.Width / dpiScale.Width, desiredSize.Height / dpiScale.Height);

        desiredSize = ImageUtilities.ConstrainWithoutDistorting(desiredSize, constraint);

        if (UseLayoutRounding)
        {
            desiredSize.Width = Math.Round(desiredSize.Width);
            desiredSize.Height= Math.Round(desiredSize.Height);
        }

        return desiredSize;
    }

    protected override Size ArrangeOverride(Size finalSize)
    {
        return new Size(Math.Round(DesiredSize.Width), Math.Round(DesiredSize.Height));
    }
} 
```

在 xaml 中使用它，就好像它是一个图像：

```
<Grid>
  <local:DpiAgnosticImage
    Stretch="None"
    Source="{Binding ViewImage}">
    <Image.RenderTransform>
      <ScaleTransform
        x:Name="SomeName"/>
    </Image.RenderTransform>
  </local:DpiAgnosticImage>
</Grid> 
```

上述代码的缺陷（据我所知）：

*   忽略拉伸
*   假设 Source 是 BitmapImage

=== 编辑 - Will 的评论表明他想知道 GetDpiScale() 中的内容

```
 public static Size GetDpiScale(Visual visual)
    {
        var source = PresentationSource.FromVisual(visual);

        var dpiScale = new Size(
            source.CompositionTarget.TransformToDevice.M11,
            source.CompositionTarget.TransformToDevice.M22);

        return dpiScale;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T20:50:12.050

这是 .jpg 文件本身指定 DPI 的结果 - WPF 只是服从。 [这是一个论坛帖子](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/db40ff3e-e30b-4cb4-8ed3-12041178abf5/)，详细说明了一些解决方案的问题：

# java - 使用 Java 验证 CSV 文件

> ID：644539
> 
> 赞同：8
> 
> 时间：2009-03-13T20:38:09.923
> 
> 标签：java, validation, csv

我正在逐行读取文件，如下所示：

```
 FileReader myFile = new FileReader(File file);
 BufferedReader InputFile = new BufferedReader(myFile);
 // Read the first line
 String currentRecord = InputFile.readLine();

 while(currentRecord != null) {
      currentRecord = InputFile.readLine();
 } 
```

但是如果上传其他类型的文件，它仍然会读取它们的内容。比如上传的文件是图片，读取文件时会输出垃圾字符。所以我的问题是：如何在阅读文件之前检查文件是否为 CSV？

检查文件的扩展名有点蹩脚，因为有人可以上传不是 CSV 但具有 .csv 扩展名的文件。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T21:24:15.460

确定文件的 MIME 类型并不容易，尤其是当 ASCII 部分可以与二进制部分混合时。

实际上，当您查看 java 邮件系统如何确定电子邮件的 MIME 类型时，它确实涉及读取其中的所有字节，并应用一些“规则”。
查看[**MimeUtility.java**](http://www.koders.com/java/fid774CF829BA2AAE26A665A81A801000FB0AB8F9B4.aspx?s=isBinary+isascii#L73)

> *   如果此数据源的主要类型是“文本”并且如果其输入流中的所有字节都是 US-ASCII，那么编码是“7 位”。
> *   如果超过一半的字节是非 US-ASCII，则编码为“base64”。
> *   如果少于一半的字节是非 US-ASCII，则编码是“引用打印的”。
> *   如果此数据源的主要类型不是“文本”，则如果其输入流的所有字节都是 US-ASCII，则编码为“7bit”。
> *   如果甚至有一个非 US-ASCII 字符，则编码为“base64”。 `@return`"7bit"、"quoted-printable" 或 "base64"

正如[mmyers](https://stackoverflow.com/users/13531/mmyers)在已删除的评论中提到的，[**JavaMimeType**](http://jmimemagic.sourceforge.net/index.html)应该做同样的事情，但是：

*   自 2006 年以来它就死了
*   它确实涉及阅读所有内容！

：

```
File file = new File("/home/bibi/monfichieratester");
InputStream inputStream = new FileInputStream(file);
ByteArrayOutputStream byteArrayStream = new ByteArrayOutputStream();
int readByte;
while ((readByte = inputStream.read()) != -1) {
    byteArrayStream.write(readByte);
}
String mimetype = "";
byte[] bytes = byteArrayStream.toByteArray();

MagicMatch m = Magic.getMagicMatch(bytes);
mimetype = m.getMimeType(); 
```

所以...既然您正在阅读文件的所有内容，您可以利用它来根据该内容和您自己的规则确定类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T19:39:22.343

[Java Mime Magic](http://jmimemagic.sourceforge.net/index.html) may be of use. It'll analyse mime-types from files and inputstreams. I can't vouch for it's functionality, however.

[This link](http://www.rgagnon.com/javadetails/java-0487.html) may provide further info. It provides several different means of determining how to do what you want (or at least something similar).

I would perhaps be tempted to write something specific to your problem domain. e.g. determining the number of comma-separated values per line and rejecting if it's not within certain limits. Then split on the commas and parse each entry according to requirements (e.g. are they doubles/floats/valid Strings - and if strings, what encoding). I think you may have to do this anyway, given that someone *may* upload a file that starts like a CSV but is corrupted half-way through.

# .net - 合并浏览器选项卡的脚本/实用程序？

> ID：644542
> 
> 赞同：0
> 
> 时间：2009-03-13T20:38:22.437
> 
> 标签：.net, windows, internet-explorer, firefox

我经常发现我有 10 个浏览器窗口（一些 firefox，一些 ie）正在运行，每个都有多个选项卡。我希望能够：1）将所有 URL 合并到一个列表中，适合发送电子邮件 2）将所有选项卡合并到 FF 或 IE 的一个实例中

任何人都遇到过这样的实用程序，如果没有，知道一个人会如何做类似的事情：

```
for each browser as WebBrowser in allRunningApps  
   for each tab as browserTab in browser.Tabs  
      'do something with tab.url  
   next  
next 
```

编辑：是的，我知道你可以获得插件以及不使用标签做一些额外的东西，但它只比手动复制/粘贴链接好一点。我正在寻找一种一举完成所有事情的脚本/代码/实用程序解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T20:46:55.583

用于 IE 的 IEPro 或无数 FireFox 扩展之一应该能够为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T05:25:28.597

我发现自己最近使用的是 Google Chrome，您可以在实例之间拖动标签。它非常方便。我猜可能会有一个 Firefox 扩展来添加这个方便的功能。我认为在这方面你不会在 IE 上走得太远。如果你找到了一个 Firefox 扩展来为你处理这个问题并且仍然需要使用 IE，你也可以获取[IETab](https://addons.mozilla.org/en-US/firefox/addon/1419)扩展，这样你就可以在 Firefox 中使用 IE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T19:28:22.353

截至 2012 年 6 月，我仍然知道没有任何实用程序可以做到这一点。

我找到了一个 Firefox 插件，它可以将所有打开的标签页 url 复制到剪贴板（反之亦然），但没有任何东西可以在所有浏览器窗口中使用，而且绝对没有任何东西可以在多个不同的浏览器中使用（即 firefox，铬等）。

# language-agnostic - 您的意见 - GPRS 上网 - 手机

> ID：644551
> 
> 赞同：1
> 
> 时间：2009-03-13T20:40:33.383
> 
> 标签：language-agnostic, gprs

1.  如果每天通过GPRS传输，8兆是不是很大的负载？

2.  获取请求 + 响应的大小（字节/千字节）有多大？（例如 200OK）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:52:31.153

1.  等于我的货币每天 R16。
2.  15
3.  请提出一个具体问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T21:08:35.857

这取决于，最快的 GPRS 大约是 296 kbits/sec。那是 29.5 KB/秒。这样，传输将需要 4.5 分钟。因此，假设您可以达到 MAXIMUM 速度，并且如果您每天只做一次，那也不会那么糟糕。

**编辑**

请注意，速度是考虑到最佳情况和 EGPRS (EDGE/2G)。根据 GPRS 规范，最高的实际 GPRS 速度为 80 kbits/sec 或 10 kbytes/sec。假设这些速度需要 13.33~ 分钟才能传输。

# c# - 一个对象上的垃圾收集，C#

> ID：644552
> 
> 赞同：4
> 
> 时间：2009-03-13T20:40:48.403
> 
> 标签：c#, .net-3.5, garbage-collection

我需要处理一个对象，以便它可以释放它拥有的所有东西，但它没有实现 IDisposable 所以我不能在 using 块中使用它。我怎样才能让垃圾收集器收集它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T20:43:58.367

您可以使用 GC.Collect() 强制收集。使用它时要非常小心，因为完整的集合可能需要一些时间。最佳实践是让 GC 确定最佳收集时间。

对象是否包含非托管资源但未实现 IDisposable？如果是这样，这是一个错误。

如果没有，它是否被立即释放并不重要，垃圾收集器应该做正确的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:44:15.667

如果它“拥有”内存以外的任何东西，则需要修复对象以使用 IDisposable。如果它不是您控制的对象，则值得选择不同的供应商，因为它说明了您的供应商对 .Net 的真正理解程度的核心。

如果它只拥有内存，即使是很多内存，您所要做的就是确保对象超出范围。 *不要*打电话`GC.Collect()`——这是如果你不得不问的事情之一，你不应该这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T20:52:54.490

您不能对单个对象执行垃圾回收。您可以通过调用 GC.Collect() 来请求垃圾回收，但这会影响所有需要清理的对象。也非常不鼓励这样做，因为它会对以后收集的性能产生负面影响。

此外，对对象调用 Dispose 不会清理它的内存。它只允许对象删除对非托管资源的引用。例如，在 StreamWriter 上调用 Dispose 会关闭流并释放 Windows 文件句柄。托管堆上的对象的内存在随后的垃圾回收之前不会被回收。

Chris Sells 也在 .NET Rocks 上讨论了这个问题。我想那是在他第一次露面时，但在后来的采访中可能会重新讨论这个话题。

[http://www.dotnetrocks.com/default.aspx?showNum=10](http://www.dotnetrocks.com/default.aspx?showNum=10)

Francesco Balena 的这篇文章也是一个很好的参考：

**何时以及如何在 C# 中使用 Dispose 和 Finalize** [http://www.devx.com/dotnet/Article/33167/0/page/1](http://www.devx.com/dotnet/Article/33167/0/page/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:42:57.150

如果对象超出范围并且没有外部引用，它将很快被收集（可能在下一次收集时）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T21:04:14.463

.NET 中的垃圾收集是不确定的，这意味着您无法真正控制它何时发生。你可以建议，但这并不意味着它会听。

告诉我们更多关于该对象的信息以及您为什么要这样做。我们可以据此提出一些建议。代码总是有帮助的。根据对象的不同，可能会有 Close 方法或类似的方法。也许用途就是这样称呼。如果没有 Close 或 Dispose 类型的方法，您可能不想依赖该对象，因为如果实际上它确实包含需要释放的资源，您可能会遇到内存泄漏。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-10-03T10:56:35.117

**注意：**在许多情况下，碎片化，GC.Collect **(** *)*或一些*IDisposal*不是**很有帮助**，特别是对于大型对象（*LOH*适用于**~80kb+**的对象，不执行**压缩**，并且对于许多人来说会受到**高度**碎片化的影响常见用例），这将导致**内存不足 (OOM)**问题，即使可能有*数百*MB 可用。随着时间的推移，事情变得越来越大，虽然对于 LOH 降级对象来说可能不是这个大小（80 kb），但高度**并行性会激怒**这个问题仅仅是由于在更短的时间内实例化/释放了更多的对象（并且可能在大小上有所不同）。

**数组**是这个问题的*常见嫌疑人（***由于运行时的非特定异常**和断言，它通常也很难识别，比如“大对象堆碎片的高百分比”会膨胀），代码的**预后**会受到这个影响问题是**实施积极的重用策略。**

来自[并行扩展 beta1 示例的](http://code.msdn.microsoft.com/ParExtSamples/Release/ProjectReleases.aspx?ReleaseId=2704)*Systems.Collections.Concurrent.ObjectPool*中的一个类有帮助（不幸的是，我没有看到一个简单的普遍存在的模式，比如一些附加的属性/扩展方法？），它很简单，可以插入或对于大多数项目的重新实现，您分配一个生成器 Func<> 并使用 Get/Put 辅助方法来重用您以前的对象并放弃通常的垃圾收集。通常只**关注数组**而不是单个数组元素就足够了。

 **如果 .NET 4 更新所有 .ToArray() 方法以包含 .ToArray(T 目标)，那就太好了。

掌握使用**SOS** /windbg *（CLRv4 的.loadby sos mscoreei*）分析此类问题的窍门会有所帮助。想一想，现在的垃圾回收系统更像是垃圾回收（再次使用相同的物理内存），ObjectPool 类似于垃圾回收。如果有人记得 3 R，那么出于性能考虑，减少内存使用也是一个好主意；）

# asp.net - 为什么 asp.net css 链接路径在 head 标签之外不起作用？

> ID：644554
> 
> 赞同：0
> 
> 时间：2009-03-13T20:41:19.090
> 
> 标签：asp.net

为什么 asp.net css 链接路径在 head 标签之外不起作用？

我在母版页中有这段代码：

```
<head runat="server">
    <title>Untitled Page</title>
    <link href="../CSS/default.css" rel="stylesheet" type="text/css" runat="server" />
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head> 
```

无论页面位于什么文件夹深度，这似乎都可以解决 CSS 链接。

我注意到，如果您使用 css 链接，如果它在头部，它只会解析为正确的路径（如果在身体中使用它不起作用）。

我知道如何通过使用 ResolveUrl 来解决它，但我想知道这是否就是它的工作原理，或者我是否遗漏了一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T20:43:42.983

当您在母版页的 head 元素上指定 runat="server" 时，ASP.NET 会对链接和脚本标记中的 url 进行一些神奇的变基。

[这里](http://aspnetresources.com/blog/more_on_url_rebasing_in_master_pages.aspx)有这种奇怪行为的一些细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:49:53.483

服务器控件将处理相对 URL，并将适当的 URL 输出到客户端。`<head runat='server'>`是执行此操作的服务器控件。如果您删除该`runat='server'`属性，您将看到此地址转换将不再发生。

# logic - 哥德尔、埃舍尔、巴赫印刷数论 (TNT) 谜题和解决方案

> ID：644569
> 
> 赞同：13
> 
> 时间：2009-03-13T20:43:29.723
> 
> 标签：logic, numbers, puzzle

在 Douglas Hofstader 的 Godel, Escher, Bach 的第 8 章中，读者面临着将这两个陈述翻译成 TNT 的挑战：

“b 是 2 的幂”

和

“b 是 10 的幂”

以下答案是否正确？：

（假设 '∃' 表示'存在一个数字'）：

∃x:(xx = b)

即“存在一个数字'x'使得x乘以x等于b”

如果这是正确的，那么下一个同样微不足道：

∃x:(xxxxxxxxxx = b)

我很困惑，因为作者指出它们很棘手，第二个需要几个小时才能解决；我一定在这里错过了一些明显的东西，但我看不到它！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T22:55:40.297

一般来说，我会说“b 是 2 的幂”等价于“b 的除 1 之外的每个除数都是 2 的倍数”。那是：

∀x((∃y(y*x=b & ¬(x=S0))) → ∃z(SS0*z=x))

编辑：这对 10 不起作用（感谢您的评论）。但至少它适用于所有素数。对不起。我认为你毕竟必须使用某种编码序列。我建议 Raymond Smullyan 的“Gödel's Incompleteness Theorems”，如果你想要一个详细和更一般的方法来解决这个问题。

或者您可以使用中国剩余定理对数字序列进行编码，然后对递归定义进行编码，这样您就可以定义指数。事实上，这基本上就是证明 Peano Arithmetic 是图灵完备的方法。

试试这个：

```
D(x,y)=∃a(a*x=y)
Prime(x)=¬x=1&∀yD(y,x)→y=x|y=1
a=b mod c = ∃k a=c*k+b 
```

然后

```
∃y ∃k(
 ∀x(D(x,y)&Prime(x)→¬D(x*x,y)) &
 ∀x(D(x,y)&Prime(x)&∀z(Prime(z)&z<x→¬D(z,y))→(k=1 mod x)) &
 ∀x∀z(D(x,y)&Prime(x)&D(z,y)&Prime(z)&z<x&∀t(z<t<x→¬(Prime(t)&D(t,y)))→
  ∀a<x ∀c<z ((k=a mod x)&(k=c mod z)-> a=c*10))&
 ∀x(D(x,y)&Prime(x)&∀z(Prime(z)&z>x→¬D(z,y))→(b<x & (k=b mod x)))) 
```

应该说“b 是 10 的幂”，实际上是说“有一个数字 y 和一个数字 k，使得 y 是不同素数的乘积，并且通过这些素数由 k 编码的序列以 1 开头，具有以下性质a的元素c是10*a，以b结尾"

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-13T20:45:53.807

您的表达式分别相当于“b 是平方数”和“b 是数字的 10 次方”的陈述。将“power of”语句转换为 TNT 相当棘手。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T05:06:35.890

在怀疑科学家的帖子中，扰流板按钮后面的“b 是 10 的幂”问题有一个解决[方案](http://echochamber.me/viewtopic.php?f=17&t=13203#p312945)。它依赖于数论中的中国余数定理，以及任意长的素数等差数列的存在。正如 Hofstadter 所指出的，即使您知道适当的定理，也不容易提出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-07T19:02:47.250

在表达“b 是 10 的幂”时，您实际上不需要中国剩余定理和/或有限序列的编码。您也可以按如下方式工作（我们使用常用符号 |、>、cd 作为具有明显含义的公式/术语的快捷方式）：

1.  对于素数 p，让我们用 EXP(p,a) 表示 TNT 中的某个公式，即“p 是素数，a 是 p 的幂”。我们已经知道，如何构建一个。（出于技术原因，我们不认为 S0 是 p 的幂，所以 ~EXP(p,S0)。）

2.  如果 p 是素数，我们定义 EXP [p] (c,a) ≖ ⟨EXP(p,a) ∧ (c-1)|(a-1)⟩。在这里，符号 | 是“除数”的一种快捷方式，可以在 TNT 中使用一个存在量词和乘法轻松定义；c-1 (a-1, resp.) 也是如此，这意味着“d 使得 Sd=c”（Sd=a, resp.）。
    如果 EXP(p,c) 成立（即 c 是 p 的幂），则公式 EXP [p] (c,a) 说“a 是 c 的幂”，因为 a ≡ 1 (mod c-1) 然后。

3.  具有数字的属性 P（即非负整数），有一种方法可以在 TNT 中引用具有此属性的最小数字：⟨P(a) ∧ ∀c:⟨a>c → ~P(a) ⟩⟩。

4.  我们可以陈述表达“b 是 10 的幂”的公式（为了更好的可读性，我们省略了符号 ⟨ 和 ⟩，我们用 2 和 5 代替 SS0 和 SSSSS0）：
    ∃a:∃c:∃d: ( EXP(2,a) ∧ EXP(5,c) ∧ EXP(5,d) ∧ d > b ∧ a⋅c=b ∧ ∀e:(e>5 ∧ e|c ∧ EXP [5] (e,c) → ~EXP [5] (e,d)) ∧ ∀e:("e 是最小的，使得 EXP [5] (c,e) ∧ EXP [5] (d,e)" → (d-2)|(ea))) .

**解释：**我们写 b = a⋅c = 2 ^x ⋅5 ^y (x,y>0) 并选择 d=5 ^z >b 使得 z 和 y 互质（例如 z 可能是素数）。那么“最小的 e...”等于 (5 ^z ) ^y = d ^y ≡ 2 ^y (mod d-2)，并且 (d-2)|(ea) 意味着 a = 2 ^x = e mod (d -2) = 2 ^y（我们也有 'd-2 > 2 ^y ' 和 'd-2 > a'），所以 x = y。

*备注：*这种方法可以很容易地适用于定义“b 是 n 的幂”对于具有固定分解 a [1] a [2] ...a [k]的任何数字 n ，其中每个 a [i]是素数 p [i]和 p的幂[i] = p [j] → i = j。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T21:57:46.193

怎么样：

∀x: ∀y: (SSx∙y = b → ∃z: z∙SS0 = SSx)

（英文：b 的任何因子 ≥ 2 本身必须能被 2 整除；字面意思是：对于所有自然数 x 和 y，如果 (2+x) * y = b 那么这意味着存在一个自然数 z 使得z * 2 = (2+x)。)

我不是 100% 确定这在[TNT](http://en.wikipedia.org/wiki/Typographical_Number_Theory)和[命题演算](http://en.wikipedia.org/wiki/Propositional_calculus)的语法中是允许的，自从我仔细阅读 GEB 已经有一段时间了。

（编辑：至少对于 b = 2 ^(n问题；我可以看到为什么 10) ^n会更困难，因为 10 不是素数。但是 11 ^n将是同一件事，除了用“SSSSSSSSSS0”替换一个术语“SS0” .)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-03T04:33:53.213

这是我想出的：

∀c:∃d:<(c*d=b)→<(c=SO)v∃e:(d=e*SSO)>>

翻译为：

对于所有数 c，存在一个数 d，如果 c 乘 d 等于 b，则 c 为 1，或者存在一个数 e，使得 d 等于 e 乘以 2。

或者

对于所有数 c，存在一个数 d，这样如果 b 是 c 的因数且 d 则 c 是 1 或 d 是 2 的因数

或者

如果两个数的乘积是 b 则其中一个为 1 或其中一个可被 2 整除

或者

b 的所有除数要么是 1，要么能被 2 整除

或者

b 是 2 的幂

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-27T05:59:07.233

对于表示 b 是 2 的幂的开放表达式，我有`∀a:~∃c:(S(Sa ∙ SS0) ∙ Sc) = b`

这有效地说明对于所有 a，S(Sa ∙ SS0) 不是 b 的因数。但在正常情况下，S(Sa ∙ SS0) 是`1 + ((a + 1) * 2)`或`3 + 2a`。我们现在可以将语句改写为“没有至少为 3 的奇数是 b 的因数”。当且仅当 b 是 2 的幂时，这是正确的。

我仍在研究 b 是 10 的幂的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T18:25:22.647

我认为上面的大部分内容只表明 b 必须是 4 的倍数。这个怎么样：∃b:∀c:<<∀e:(c∙e) = b & ~∃c':∃c' ':(ssc'∙ssc'') = c> → c = 2>

我不认为格式是完美的，但它写道：

存在 b，使得对于所有 c，如果 c 是 b 的因数且 c 是素数，则 c 等于 2。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-03-04T04:06:26.837

以下是我对“b 是 2 的幂”这一说法的看法

∃b: ∀a: ~∃c: ((a * ss0) + sss0) * c = b

我认为这表示“存在一个数字 b，因此对于所有数字 a，不存在一个数字 c 使得 (a * 2) + 3（换句话说，大于 2 的奇数）乘以 c，给你b。” 因此，如果 b 存在，并且不能为零，并且它没有大于 2 的奇数除数，那么 b 不一定是 1、2 或 2 的另一个幂吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-28T21:23:08.097

我对 b 的解决方案是 2 的幂是：∀x: ∃y xy=b (isprime(x) => x = SS0)

isprime() 应该不难写。

# .net - 带有多个 DataLoadOptions 的 Linq2SQl 急切加载

> ID：644576
> 
> 赞同：12
> 
> 时间：2009-03-13T20:45:23.840
> 
> 标签：.net, linq, linq-to-sql

我喜欢使用 Linq2SQL 通过预先加载来获取数据。代码类似于：

```
 DataLoadOptions options = new DataLoadOptions();

       options.LoadWith<Product>(c => c.ProductCompanies);

       options.LoadWith<Product>(c => c.OrderDetails);

       db.LoadOptions = options;

       IEnumerable<Product> products = db.Products.ToList<Product>(); 
```

我检查它是否按预期生成了超过 1 个 SQL 查询。实际上它只是对 Product 和 OrderDetails 进行预加载，并且对 ProductCompany 进行一一查询。我在这里做错了吗？或者它是一个 Linq2SQL 问题？我们有任何解决方法吗？

非常感谢！

**更新：** 我从 SQL Profiler 检查 sql。我发现 Leppie 和 Ian 都是正确的。它们被限制在一个事务中。但是当我将它设置为延迟加载时，它打开了多个连接。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-09-08T15:33:40.447

我也在一些代码中遇到了这个问题，经过大量试验和谷歌搜索，看起来 LINQ 只能连接每个表中的一个一对多关系：如果你尝试指定多个来预加载它（随机？）选择哪个要预加载，哪个要延迟（只需忽略那些 LoadWith 提示）

其他人也发布了这个，例如

[http://codebetter.com/blogs/david.hayden/archive/2007/08/06/linq-to-sql-query-tuning-appears-to-break-down-in-more-advanced-scenarios.aspx](http://codebetter.com/blogs/david.hayden/archive/2007/08/06/linq-to-sql-query-tuning-appears-to-break-down-in-more-advanced-scenarios.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T20:50:51.157

不，您没有做错任何事情，Linq2SQL 在单个事务中对所有内容进行批处理，但可能会针对所需结果执行无限数量的查询。`DataLoadOptions`通常仅在`DataContext`不能用于结果使用的整个上下文时使用。如果您可以`DataContext`在执行期间保持活动状态，则最好依赖延迟执行（这是默认设置）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T22:19:17.967

根据文档：

> 当您查询一个对象时，您实际上只检索您请求的对象。相关对象不会同时自动获取。
> 
> DataLoadOptions 类提供了两种方法来实现指定相关数据的即时加载。LoadWith 方法允许立即加载与主要目标相关的数据。AssociateWith 方法允许过滤相关对象。

拥有多个 sql 语句并不让我感到惊讶。我认为这里的区别在于所有语句都是预先加载的，而不是按需延迟加载。

# java - JPA 是否支持映射到 sql 视图？

> ID：644577
> 
> 赞同：40
> 
> 时间：2009-03-13T20:45:31.170
> 
> 标签：java, sql, orm, jpa, view

我目前正在使用 Eclipselink，但我知道现在大多数 JPA 实现已经非常标准化。是否有将 JPA 实体映射到视图的本地方法？我不打算插入/更新，但问题实际上是如何处理 @Id 注释。JPA 世界中的每个实体都必须有一个 ID 字段，但是我创建的许多视图并不符合这一点。JPA 中是否有对此的本机支持，或者我是否需要使用 hack 来使其工作？我进行了很多搜索，但发现有关执行此操作的信息很少。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T22:02:00.707

虽然将`@Id`注释与直接支持的类型的字段一起使用并不是指定实体身份的唯一方法（参见`@IdClass`with multiple `@Id`annotations 或`@EmbeddedId`with `@Embedded`），但 JPA 规范要求每个实体都有一个主键。

也就是说，您不需要实体将 JPA 与数据库视图一起使用。由于从 SQL 角度映射到视图与映射到表没有什么不同，因此您仍然可以使用本机查询 ( `createNativeQuery`on `EntityManager`) 来检索标量值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-04T22:57:52.093

我自己一直在研究这个，我发现了一个我不是 100% 确定的作品，但看起来很有希望。

在我的例子中，我在视图中有一个 FK 列，它可以有效地充当 PK - 该外来对象的任何给定实例只能在视图中出现一次。我从一个字段中定义了两个对象：一个被指定为 ID，代表字段的原始值，另一个被指定为只读，代表被引用的对象。

```
 @Id
@Column(name = "foreignid", unique = true, nullable = false)
public Long getForeignId() {
...

@OneToOne
@JoinColumn(name = "foreignid", insertable=false, updatable=false)
public ForeignObject getForeignObject() {
... 
```

就像我说的那样，我不能 100% 确定这个答案（如果结果不起作用，我会删除这个答案），但它让我的代码超过了一个特定的崩溃点。

不过，不知道它是否适用于您的具体情况。而且很有可能在 11 个月后，您不再关心。:-) 什么鬼，“死灵法师”徽章不只是靠自己挣来的……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-07T13:56:31.967

在我看来，我有一个“唯一”的 id，所以我将它映射为实体 id。它工作得很好：

```
@Entity
@Table(name="table")
@NamedQuery(name="Table.findAll", query="SELECT n FROM Table n")
public class Table implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name="column_a")
    private int columnA; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-14T09:00:00.813

JPA - 2.5.4

```
 CREATE MATERIALIZED VIEW IF NOT EXISTS needed_article as select  product_id, count(product_id) as count from product_article group by product_id;
    CREATE MATERIALIZED VIEW IF NOT EXISTS available_article as select product_id, count(product_id) as count from article a inner join  product_article p
                                on  a.id = p.article_id and a.stock >= p.amount_of group by product_id;

    CREATE UNIQUE INDEX productId_available_article ON available_article (product_Id);
    CREATE UNIQUE INDEX productId_needed_article ON needed_article (product_Id); 
```

实体.java

```
@Entity
@Immutable // hibernate import
@Getter
@Setter
public class NeededArticle {
    @Id
    Integer productId;
    Integer count;
} 
```

存储库.java

```
@Repository
public interface AvailableProductRepository extends CrudRepository<AvailableArticle, Integer> {

    @Query("select available.productId from AvailableArticle available, NeededArticle needed where available.productId = needed.productId and available.count = needed.count")
    List<Integer> availableProduct(); 
```

# outlook - Outlook 2007 DASL 查询任务

> ID：644581
> 
> 赞同：0
> 
> 时间：2009-03-13T20:46:10.933
> 
> 标签：outlook, vsto, outlook-addin, task

我要疯了。基本上我想根据这个任务的 EntryID 来检索一个任务。所以我要做的是：

Outlook.MAPIFolder outlookTasksFolder = Application.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderTasks); string filter = String.Format("@SQL=\"urn:schemas:tasks:entryid\" like '%{0}%'", myEntryID); Outlook.Items outlookTasksDataItems = outlookTasksFolder.Restrict(filter);

但我不工作。我不知道如何格式化我的查询以获取相应的项目（应该只有一个）。

谁能帮帮我吗？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T03:49:46.273

Outlook.MAPIFolder outlookTasksFolder = Application.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderTasks);

Outlook.TaskItem myOutlookTask = (Outlook.TaskItem)Application.Session.GetItemFromID(myEntryID, outlookTasksFolder.EntryId);

那应该这样做。

# sql - 在 VB6 应用程序中包含 sql 脚本

> ID：644608
> 
> 赞同：0
> 
> 时间：2009-03-13T20:54:36.080
> 
> 标签：sql, vb6

我正在维护一个旧的 VB6 应用程序，并希望将 SQL 脚本直接包含在项目的一部分中。VB6 应用程序应提取此脚本的文本并在服务器上执行它。

这种方法的原因是多方面的——除其他外，我们只想提供一个更新的可执行文件，而不是一个完整的更新/安装包。因此，SQL 脚本需要像资源文件一样编译到应用程序中。而且，显然，必须能够从代码中获取内容，才能将其发送到数据库服务器。

有没有人有这样做的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T22:02:09.253

最简单的解决方案是创建一个带有脚本作为字符串的 VB 模块。

如果您想改用资源文件，您也可以这样做。您可以将 resfile 与 VB 项目相关联（我不记得如何直接在 VB IDE 中执行此操作，但 VBP 文件支持[ResFile32 参数](http://www.vbrezq.com/perform.php)）。

编辑：这里的问题似乎主要是关于格式化——你不想将 SQL 查询存储为一个长字符串，但是在 VB 中很好地格式化查询是乏味的，因为你必须添加引号，添加字符串连接运算符来加入线在一起，等等。

我建议将 SQL 放在一个文本文件中，并以您喜欢的任何方式对其进行格式化。编写一个脚本，将文本转换为 VB 模块。构建过程将被修改为始终在编译应用程序之前首先应用此脚本。

对于脚本，使用你最喜欢的脚本语言；如果您没有最喜欢的脚本语言，这是一项非常简单的任务，您可以使用 VB、C# 或任何其他语言来完成。如果是我，我可能会使用 awk (gawk) 或 Python。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T03:24:10.463

如果要使用资源 (.RES) 来存储 SQL，请转到菜单：

加载项 > 加载项管理器...

并选择*VB 6 Resource Editor*。配置加载项并在启动时加载。

从编辑器加载项，VB 提供了一个简单的界面来添加资源字符串。您将使用提供的常量值来引用这些。要在运行时加载字符串，请使用*LoadResString*函数：

```
Public Const SQL_INSERT As Integer = 101
Dim strSQL As String 
strSQL = LoadResString(SQL_INSERT) 
```

（将“101”替换为您要加载的字符串的常量值）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T17:28:19.327

只是对你的方法的另一个想法。因为我发现自己正在为客户调整程序的行为或 UI，所以我可能正处于一个尚未准备好或尚未经过测试和批准的更改之中。因此，如果我有不时更改的属性，但我想保持控制，例如到我们的 ftp 服务器的连接设置，我将创建一个仅资源 dll 公开我的属性并使用 dll 中的资源文件来提供价值观。当我的网络管理器更改 ftp 服务器上的某些内容时，我更改了资源管理器中的字符串，重新编译 dll 并仅发布更新的 dll。我敢肯定还有更多的解决方案，但我就是这样做的。如果您认为您可能不必在更改 exe 的同时更改 SQL 脚本，这可能只会使您的工作复杂化。

# unix - 确定文本文件中唯一性和重复性的最佳方法

> ID：644609
> 
> 赞同：3
> 
> 时间：2009-03-13T20:55:07.030
> 
> 标签：unix, command-line, shell

我有一个大约 2000 万行的文本文件。每行长度为 25 个字符。我估计可能有大约 200k-300k 独特的行。我想知道到底有多少条独特的线，以及每条线有多少次出现（我希望结果是幂律式的）。

我可以这样做：

```
sort bigfile|uniq -c |sort -nr > uniqcounts
wc -l uniqcounts 
```

但这是非常低效的记忆和时间。

解决此问题的最佳命令行解决方案是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T21:03:52.983

当我遇到这样的文本处理问题时，我倾向于倾向于 Perl，特别是因为 Perl 安装在大多数 Unix 系统上。（您可能可以使用 awk 做同样的事情，这可能更可用。）

这样的事情应该可以解决问题：

```
#!/usr/bin/perl

while(<>) {
    chomp;
    $lines{$_}++;
}

print "Total unique lines: ", scalar(keys %lines), "\n";
foreach my $line (sort {$lines{$b} <=> $lines{$a}} keys %lines) {
    printf "%6d  %s\n", $lines{$line}, $line;
} 
```

（您可以将其作为单行来执行，但拆分后更易于阅读。）

这需要 O(n) 内存用于散列键，其中*n*是唯一行数。运行时效率取决于哈希查找，但会介于 O(n)（如果没有哈希冲突）和 O(n*log n)（平衡树）之间。在最坏的情况下，最终的可选排序可能需要 O(n^2)，并且如果唯一行数很高，则可能会主导运行时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T22:56:16.567

我假设有被认为是题外话和被否决的风险，但我必须对此大发雷霆。

2000 万 * 25 个字符 = 500000000 个字节（假设您不是指 Unicode）

这不到 500 MB 的 RAM。对于现代计算机来说，这并不是一个巨大的数字。

请不要抱怨这是非常低效的记忆和时间。将冗余数据存储在平面文本文件中的决定是低效且错误的。

使用数据库（例如 sqlite）而不是平面文件。

使用类似的表格

```
CREATE TABLE lines (line VARCHAR(25), occurences INTEGER) 
```

存储独特的线条及其出现。

如果生成此文本文件的不是您的应用程序，请向开发人员投诉！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T22:20:48.040

确保在测试您的解决方案之前执行此`sort`操作`uniq`：

```
export LC_ALL=C 
```

如果您至少可以在时间上比较这个和 perl 解决方案，那就太好了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T10:17:49.627

使用*awk* （在*Solaris*上使用*nawk*或*/usr/xpg4/bin/awk*：

 *```
awk 'END {
  for (k in _)
    print k, _[k]
    }
{ _[$0]++ }
' infile 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:59:42.230

我不确定是否有比您发布的更好的解决方案：O(n log(n) + n)。考虑到问题陈述，您提到的精细“sort -nr”并不是绝对必要的，但可以使输出更容易被人类理解。

如果有人能提出比这更快的解决方案（复杂性），我会非常感兴趣。当然，编写一个特殊用途的程序来做同样的事情可能比使用 sort 和 uniq 更快。

# java - Swing 中使用 AbstractListModel 的大型虚拟列表——限制为 119,000,000 个项目？

> ID：644612
> 
> 赞同：1
> 
> 时间：2009-03-13T20:55:47.463
> 
> 标签：java, swing

我的“虚拟列表”在摇摆中运行良好，但是当我超过某些特定数量的项目时，它似乎失败了。“失败”是指当项目数> Nmax时滚动条神奇地消失，当项目数<= Nmax时它又回来了；在我的系统上，Nmax 似乎在 119,304,000 左右。

我在对抗什么？！？！

（这是一个测试程序：在我的电脑上，如果我输入 119,304 它可以正常工作，但我单击向上箭头并且滚动条消失）

```
package com.example.test;

import java.awt.BorderLayout;
import java.awt.Dimension;
import javax.swing.AbstractListModel;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSpinner;
import javax.swing.SpinnerModel;
import javax.swing.SpinnerNumberModel;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

// based on:
// http://www.java2s.com/Tutorial/Java/0240__Swing/extendsAbstractListModel.htm
// http://www.java2s.com/Tutorial/Java/0240__Swing/SpinnerNumberModel.htm
// http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/SpinnerNumberModel.html
// http://www.java2s.com/Tutorial/Java/0240__Swing/ListeningforJSpinnerEventswithaChangeListener.htm
// http://java.sun.com/products/jfc/tsc/tech_topics/jlist_1/jlist.html

public class BigVirtualList extends JFrame {

    public static void main(String[] args) {
        new BigVirtualList();
    }

    static final int initialLength = 1;
    final private JList list1 = new JList();
    final private BVLData bvldata = new BVLData(initialLength*1000);

    public BigVirtualList() {
        this.setTitle("Big virtual list");
        this.getContentPane().setLayout(new BorderLayout());
        this.setSize(new Dimension(400, 300));
        list1.setModel(bvldata);

        list1.setPrototypeCellValue(list1.getModel().getElementAt(0));

        SpinnerModel model1 = new SpinnerNumberModel(initialLength,1,1000000,1);
        final JSpinner spinner1 = new JSpinner(model1);

        this.getContentPane().add(new JScrollPane(list1), BorderLayout.CENTER);
        JLabel label1 = new JLabel("Length (1000s of items):");
        JPanel panel1 = new JPanel(new BorderLayout());
        panel1.add(label1, BorderLayout.WEST);
        panel1.add(spinner1, BorderLayout.CENTER);
        this.getContentPane().add(panel1, BorderLayout.SOUTH);      

        ChangeListener listener = new ChangeListener() {
            public void stateChanged(ChangeEvent e) {
                Integer newLength = (Integer)spinner1.getValue();
                bvldata.setLength(newLength*1000);
            }
        };

        spinner1.addChangeListener(listener);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
    }
}

class BVLData extends AbstractListModel {
    public BVLData(int length) { this.length = length; }

    private int length;

    public int getLength() { return length; }
    public void setLength(int length) {
        int oldLength = getLength();
        this.length = length;
        int newLength = getLength();

        if (newLength > oldLength)
            fireIntervalAdded(this, oldLength+1, newLength);
        else if (newLength < oldLength)
            fireIntervalRemoved(this, newLength+1, oldLength);      
    }   

    @Override
    public Object getElementAt(int index) {
        return "Item "+index+" mod 107 = "+(index%107);
    }

    @Override
    public int getSize() { return getLength(); }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T21:22:42.050

好吧，我看不到目的，但无论如何...

我猜你在滚动窗格的某个地方打破了整数最大值：

```
System.out.println("CellHeight:"+list1.getFixedCellHeight());
System.out.println("CellHeight*119304000:"+NumberFormat.getNumberInstance().format(list1.getFixedCellHeight()*119304000.0));
System.out.println("MAXINT:"+Integer.MAX_VALUE); 
```

给你数字：

```
单元高度：18
单元格高度*119304000:2.147.472.000
MAXINT:2.147.483.647

```

如您所见，再增加 18000 像素的高度将超出 MAXINT ......这会给您带来麻烦。

# asp.net - 使用 ASP.Net 上传 Content-Range 文件

> ID：644615
> 
> 赞同：0
> 
> 时间：2009-03-13T20:58:27.253
> 
> 标签：asp.net, file-upload

我有一个 ASP.Net 网站，它需要接受来自 Flex 应用程序的大文件上传。它使用 Content-Range 发送文件以分块它发送的文件。ASP.Net 的 HttpFileCollection 和 HttpPostedFile 中是否有任何有助于处理以这种方式发布的文件的内容？每个块是否作为新帖子发送到页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-10T21:11:59.303

您也许可以使用方法`IHttpModule`内部来解析请求`BeginRequest`。

# c# - 串口通信：轮询串口 vs 使用串口 DataReceived 事件

> ID：644623
> 
> 赞同：16
> 
> 时间：2009-03-13T20:59:59.683
> 
> 标签：c#, multithreading, serial-port

我只是在查看我编写的一些代码，用于与 CF2.0 上的 C# 中的串行端口进行通信。我没有使用 DataReceived 事件，因为它不可靠。[MSDN 指出：](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx)

> DataReceived 事件不保证为接收到的每个字节引发。使用 BytesToRead 属性来确定缓冲区中还有多少数据要读取。

我使用 read() 轮询端口，并有一个在读取数据时处理数据的委托。我还在某处读到“轮询很糟糕”（没有给出解释）。

任何想法为什么民意调查可能不好？除了通常的线程注意事项 - 我有一个单独的线程（后台线程）来轮询端口，在读取数据后退出线程，所有测试都运行良好。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-13T21:06:27.080

按照我的阅读方式，您可能会为多个字节获得一个事件，而不是每个字节一个事件。我仍然希望在数据准备好时得到一个事件，而不是让它完全“跳过”一些字节。

我一直使用这个事件，并且没有遇到任何问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T21:08:20.133

传统观点认为“轮询很糟糕”，因为它通常最终成为受 CPU 限制的进程。如果改为使用阻塞 I/O，则 CPU 可用于其他进程，直到事件发生。

也就是说，通常可以进行设置，以便轮询等待（短）超时，然后在没有可用字符时返回。如果选择了合适的超时，那么您的简单轮询循环使用的 CPU 时间会显着减少，并且其他进程也可以运行。

我根本没有使用 C# 的串行端口，但我会冒险猜测文档的含义

> 不保证每个接收到的字节都会引发 DataReceived 事件。使用 BytesToRead 属性来确定缓冲区中还有多少数据要读取。

是您不能期望每个角色获得一个事件。在某些情况下，它可能会提供多个可用字符的事件。只需在事件处理程序中检索所有可用字符，一切都会好起来的。

**编辑：**在阅读器线程上进行阻塞调用可能是总体上最好的答案。它本身不是轮询，因为线程在字符到达之前被阻塞。如果您需要在数据到达时处理数据而不是固定大小的块，您可能需要调整缓冲区大小和一些串行端口设置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-25T18:50:32.237

我很确定底层串行端口驱动程序代码是中断驱动的，即使在使用阻塞读取调用时也是如此。

# c# - 检测字典中包含的值是否已更改

> ID：644624
> 
> 赞同：2
> 
> 时间：2009-03-13T21:00:10.840
> 
> 标签：c#, .net

如果我从 IDictionary 派生一个类，我如何确定任何给定的 V 在添加到基础集合后没有更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T21:17:15.230

有很多方法，但这取决于...

如果添加到字典的值类型包含“已更改”类型的事件，请订阅它。

如果值类型不包含这样的事件，但您控制源代码，添加事件并订阅它。

如果值类型不包含这样的事件，并且您不控制源代码，请考虑使用克隆值或其他东西维护值的卷影副本，并进行比较。

恐怕在最后一种情况下，您不控制类型并且它不包含事件，您别无选择，只能以某种方式记录每个值的当前状态，然后与该状态进行比较以查看它是否已更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T00:54:45.410

如果它是引用类型，我将在您打算包含在 IDictionary 中的类上实现[INotifyPropertyChanged 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)在项目的“添加”上订阅 PropertyChanged 事件，确保在删除项目时取消订阅；否则，您将“泄漏”对包含对象实例的引用（不会被收集）。像这样的东西：

```
public event EventHandler<CollectionItemPropertyChangedEventArgs> CollectionItemPropertyChanged; 

public void Add(object key, object item)
{
    INotifyPropertyChanged notify = item as INotifyPropertyChanged; 
    if(notify != null)
    {
        notify.PropertyChanged += OnCollectionItemPropertyChanged; 
    }
}

private void OnCollectionItemPropertyChanged(object sender, PropertyChangedEventArgs e)
{
    if(this.CollectionItemPropertyChanged != null)
    {
        CollectionItemPropertyChanged eventArgs = new CollectionItemPropertyChanged();
        eventArgs.Item = sender;
        eventArgs.Property = e.PropertyName; 
        this.this.CollectionItemPropertyChanged(this, eventArgs);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T21:03:20.097

如果你在一个类上实现 IDictionary，你可以在你的对象的 setter(s) 中添加一个 isdirty 或其他一些事件或跟踪。但是，如果对象很复杂并且对象的子属性发生了变化，这会使事情变得更加棘手。这取决于您使用的上下文 - 您是否希望在对象更改时它是事件驱动的，还是您只需要知道？如果它在 getter 上，您始终可以从上次获取或添加对象时检查对象的哈希值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T21:07:48.853

使用该值存储更改计数，并在执行修改时增加它。然后您可以检查更改计数以查看对象是否已更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T22:48:18.333

所以我的理解是，真的没有简单的方法来处理知道存储的值是否已经改变。这意味着如果我真的需要这些信息（我确实需要），那么我必须偶尔遍历值列表并检查它们是否已更改。

我需要描述这样做的影响。希望我可以实现它，以便它发生在一个单独的线程上，并且在比较时非常有效。这也意味着我必须将 V 限制为 IComparable。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-08-17T10:25:23.057

重新定义派生类中的默认*Item()*属性设置器。像这样，在 VB 中使用 T 的字典，布尔示例：

```
Private Dict As New Dictionary (Of T, Boolean)
Public Event ValueChanged (key as T, value as Boolean)

Default Public Property Item(key as T) as Boolean Implements IDictionary(Of T, Boolean).Item
    Get
        Return Dict(key)
    End Get
    Set(value as Boolean)
        Dict(key) = value
        RaiseEvent ValueChanged(key, value) 'this is it!
    End Set
End Property 
```

# c++ - 基枚举类继承

> ID：644629
> 
> 赞同：90
> 
> 时间：2009-03-13T21:03:03.390
> 
> 标签：c++, enums

有没有一种模式可以让我从 C++ 中的另一个枚举继承枚举？

像这样的东西：

```
enum eBase 
{
   one=1, two, three
};

enum eDerived: public eBase
{
   four=4, five, six
}; 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-03-13T21:11:44.367

```
#include <iostream>
#include <ostream>

class Enum
{
public:
    enum
    {
        One = 1,
        Two,
        Last
    };
};

class EnumDeriv : public Enum
{
public:
    enum
    {
        Three = Enum::Last,
        Four,
        Five
    };
};

int main()
{
    std::cout << EnumDeriv::One << std::endl;
    std::cout << EnumDeriv::Four << std::endl;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-03-13T21:05:28.097

不可能。枚举没有继承。

您可以改为使用具有命名 const int 的类。

例子：

```
class Colors
{
public:
  static const int RED = 1;
  static const int GREEN = 2;
};

class RGB : public Colors
{
  static const int BLUE = 10;
};

class FourColors : public Colors
{
public:
  static const int ORANGE = 100;
  static const int PURPLE = 101;
}; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-04-08T04:01:01.907

您不能直接这样做，但您可以尝试使用本文中的解决[方案](http://www.codeproject.com/KB/cpp/InheritEnum.aspx)。

主要思想是使用保存枚举值并具有类型转换运算符的辅助模板类。考虑到枚举的基础类型是`int`您可以在代码中无缝地使用这个持有者类而不是枚举。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-09-18T21:49:46.807

不幸的是，这在 C++14 中是不可能的。我希望我们在 C++17 中会有这样的语言特性。由于您已经为您的问题找到了一些解决方法，因此我不会提供解决方案。

我想指出，措辞应该是“扩展”而不是“继承”。扩展允许更多值（因为您在示例中从 3 个值跳到 6 个值），而继承意味着对给定的基类施加更多约束，因此可能性集会缩小。因此，潜在的强制转换将与继承完全相反。您可以将派生类转换为基类，而不是与类继承相反。但是当有扩展时，你“应该”能够将基类转换为它的扩展，而不是反之。我说“应该”是因为，正如我所说，这样的语言功能仍然不存在。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-26T16:47:38.587

这个怎么样？好的，为每个可能的值创建一个实例，但除此之外它非常灵活。有什么缺点吗？

**。H：**

```
class BaseEnum
{
public:
  static const BaseEnum ONE;
  static const BaseEnum TWO;

  bool operator==(const BaseEnum& other);

protected:
  BaseEnum() : i(maxI++) {}
  const int i;
  static int maxI;
};

class DerivedEnum : public BaseEnum
{
public:
  static const DerivedEnum THREE;
}; 
```

**.cpp：**

```
int BaseEnum::maxI = 0;

bool BaseEnum::operator==(const BaseEnum& other) {
  return i == other.i;
}

const BaseEnum BaseEnum::ONE;
const BaseEnum BaseEnum::TWO;
const DerivedEnum DerivedEnum::THREE; 
```

**用法：**

```
BaseEnum e = DerivedEnum::THREE;

if (e == DerivedEnum::THREE) {
    std::cerr << "equal" << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-29T05:03:54.253

好吧，如果您`enum`在派生类中使用相同的名称定义并从`enum`基类中对应的最后一项开始，您将收到几乎您想要的 - 继承的枚举。看看这段代码：

```
class Base
{
public:
    enum ErrorType
    {
        GeneralError,
        NoMemory,
        FileNotFound,
        LastItem,
    };
};

class Inherited: public Base
{
public:
    enum ErrorType
    {
        SocketError = Base::LastItem,
        NotEnoughBandwidth,
    };
}; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-06T01:46:45.503

如前所述`bayda`，枚举不（和/或不应该）具有功能，因此我通过调整`Mykola Golubyev`响应采取了以下方法来解决您的难题：

```
typedef struct
{
    enum
    {
        ONE = 1,
        TWO,
        LAST
    };
}BaseEnum;

typedef struct : public BaseEnum
{
    enum
    {
        THREE = BaseEnum::LAST,
        FOUR,
        FIVE
    };
}DerivedEnum; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-01-05T11:56:19.717

您可以使用项目[SuperEnum](https://github.com/bravikov/super_enum)创建可扩展的枚举。

```
/*** my_enum.h ***/
class MyEnum: public SuperEnum<MyEnum>
{
public:
    MyEnum() {}
    explicit MyEnum(const int &value): SuperEnum(value) {}

    static const MyEnum element1;
    static const MyEnum element2;
    static const MyEnum element3;
};

/*** my_enum.cpp ***/
const MyEnum MyEnum::element1(1);
const MyEnum MyEnum::element2;
const MyEnum MyEnum::element3;

/*** my_enum2.h ***/
class MyEnum2: public MyEnum
{
public:
    MyEnum2() {}
    explicit MyEnum2(const int &value): MyEnum(value) {}

    static const MyEnum2 element4;
    static const MyEnum2 element5;
};

/*** my_enum2.cpp ***/
const MyEnum2 MyEnum2::element4;
const MyEnum2 MyEnum2::element5;

/*** main.cpp ***/
std::cout << MyEnum2::element3;
// Output: 3 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-02-08T20:24:14.090

有点骇人听闻，但这是我在处理范围枚举时想出的：

```
enum class OriginalType {
   FOO,  // 0
   BAR   // 1
   END   // 2
};

enum class ExtendOriginalType : std::underlying_type_t<OriginalType> {
   EXTENDED_FOO = static_cast<std::underlying_type_t<OriginalType>>
                                           (OriginalType::END), // 2
   EXTENDED_BAR  // 3
}; 
```

然后像这样使用：

```
OriginalType myOriginalType = (OriginalType)ExtendOriginalType::EXTENDED_BAR; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-12-13T09:34:58.303

这个答案是 Brian R. Bondy 答案的变体。由于已在评论中提出要求，因此我将其添加为答案。我不是在指出它是否真的值得。

```
#include <iostream>

class Colors
{
public:
    static Colors RED;
    static Colors GREEN;

    operator int(){ return value; }
    operator int() const{ return value; }

protected:
    Colors(int v) : value{v}{} 

private:
    int value;
};

Colors Colors::RED{1};
Colors Colors::GREEN{2};

class RGB : public Colors
{
public:
    static RGB BLUE;

private:
    RGB(int v) : Colors(v){}
};

RGB RGB::BLUE{10};

int main ()
{
  std::cout << Colors::RED << " " << RGB::RED << std::endl;
} 
```

[住在科利鲁](http://coliru.stacked-crooked.com/a/5a0dc4b98a9b3238)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T21:18:50.233

不可能的。
但是您可以在类中匿名定义枚举，然后在派生类中添加额外的枚举常量。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2019-01-10T22:30:37.287

```
enum xx {
   ONE = 1,
   TWO,
   xx_Done
};

enum yy {
   THREE = xx_Done,
   FOUR,
};

typedef int myenum;

static map<myenum,string>& mymap() {
   static map<myenum,string> statmap;
   statmap[ONE] = "One";
   statmap[TWO] = "Two";
   statmap[THREE] = "Three";
   statmap[FOUR] = "Four";
   return statmap;
} 
```

用法：

```
std::string s1 = mymap()[ONE];
std::string s4 = mymap()[FOUR]; 
```

# .net - 如何通过 .NET Compact Framework 上的代码最小化表单

> ID：644632
> 
> 赞同：5
> 
> 时间：2009-03-13T21:03:20.723
> 
> 标签：.net, compact-framework

在 .NET Compact Framework 下，没有 FormWindowState.Minimize 值。如何最小化我的应用程序，使其保持活动和可用，但将焦点返回到以前的应用程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T00:04:03.627

这是你的答案。

[http://christian-helle.blogspot.com/2007/06/programmatically-minimize-application.html](http://christian-helle.blogspot.com/2007/06/programmatically-minimize-application.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T21:20:08.623

自从我使用 Windows Mobile 已经有一段时间了——当时它仍然被称为 Pocketpc 2002，所以这可能已经*过时*了——但当时这是单击`X`应用程序右上角的默认行为。该应用程序不会关闭，而是发送到后台。我认为它已经改变了？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-14T00:01:42.307

在您的活动表单上调用 Hide()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-05T09:02:53.963

我正在开发通用 WinCE（4.2 和 5.0），所以我不确定我的解决方案是否适用于您的 Windows Mobile 问题。

在我们的场景中，我们的表单需要占据整个屏幕（包括隐藏任务栏），没有标题栏，能够通过代码最小化，并且在最小化时会在任务栏中显示应用程序图标（因此可以恢复）专注于应用程序堆栈上的前一个程序。听起来还不错，但实际上我无法同时满足所有要求，这需要一些技巧。

正如其他人所发布的那样，紧凑框架上没有 Form.Minimize() 。

*   `Form.Hide()`让我无法恢复应用程序。P/Invoking `ShowWindow(Form.Handle, 6)`，其中 6=SW_MINIMIZE，会将应用程序最小化到任务栏，但仅在`Form.FormBorderStyle = Normal`（而不是无）时才会显示应用程序标题栏。
*   我需要设置`Form.WindowState = Normal`而不是最大化，否则当应用程序最小化时它会立即恢复。

最后，我将以下内容放在一起以获得我想要的。它涉及通过填充屏幕和一些额外的高度来手动设置应用程序大小，这样我就可以向上倾斜应用程序并将标题栏移出可视屏幕。

```
public class MyForm 
{
  public MyForm()
  {
     InitializeComponent();

     NativeMethods.HideTaskbar();
     FormBorderStyle = FormBorderStyle.FixedSingle;
     WindowState = FormWindowState.Normal;
     Rectangle screenBounds = Screen.PrimaryScreen.Bounds;
     int taskBarHeight = SystemInformation.MenuHeight;
     NativeMethods.MoveWindow(Handle, 
                              0, -taskBarHeight, 
                              screenBounds.Width, screenBounds.Height + taskBarHeight);
  }

  public void HandleMinimize()
  {
    NativeMethods.ShowTaskBar();
    NativeMethods.ShowWindow(Handle, WindowShowStyle.Minimize);
  } 
```

拦截应用程序恢复事件以隐藏任务栏要复杂得多，由于原作者没有提到任务栏，我不会深入探讨。

所有静态 NativeMethods 类方法都是 P/Invoke 语句的包装器。有关实现这些的更多信息，请参阅[http://www.pinvoke.net](http://www.pinvoke.net)中的coredll 部分。

# unit-testing - 用所有者标记单元测试被认为是个好主意？

> ID：644638
> 
> 赞同：3
> 
> 时间：2009-03-13T21:04:23.323
> 
> 标签：unit-testing

我想知道您对让开发人员将他们的姓名或签名放在他们编写的每个测试之上是否是一个好主意以及为什么（不）的看法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-13T21:07:04.583

我会说不。如果你真的需要知道谁编写了测试，你应该能够回顾一下你的版本控制，看看谁应该受到责备。当人们开始将自己的名字放在事物上时，您就会失去集体所有权/责备感，人们开始更加关注“他们的”代码而不是整个系统。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T21:17:53.213

我赞成安迪的，但我还要补充一点，把名字放在代码中也是必须维护的其他东西。例如。Joe 创建了测试，但 Jane 更改了它，是 Joe 的测试还是 Jane 的测试？如果 Jane 不更改注释，那么您现在就去和 Joe 谈谈 Jane 编写的代码……太混乱了。使用责备并完成它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T21:20:58.403

你会如何处理这些信息？

没有作者姓名的用例。

通常，信息具有两种含义之一。

1.  这个人走了（离开了公司，离开了项目，或者承包商和永远不会再被发现的人。）

2.  人还在。

在第二种情况下，你已经知道了。将他们的名字放在源代码文件中并不能说明他们从事此代码工作、仍在公司和项目中的事实。

所以，作者的名字没有用例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T13:02:44.013

I favour **self-explanatory test cases** rather than signed tests.

Even if you know who wrote the test, and he's still working here, and he's available, you cannot be certain he remembers the reasons why he wrote this test.

Make sure the names of the test case are explicit enough. Add comments if necessary, reference bug ID, User Story, Customer ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T21:20:49.120

我认为这取决于已经存在的态度。如果有很多冲突，那么删除所有名称很有用，因为代码代表自己。但是，如果将名称放在测试中（与代码一样），则开发人员将获得所有权。

拥有所有权始终是一件好事，因为它鼓励开发人员使其尽可能完美。当您需要询问有关测试的问题，或者如果测试失败并且您无法弄清楚原因时，它也会有所帮助，您可以就该主题询问专家。

然而，如果有一种更黑暗的气氛，更多的是关于防守的开发人员，并且试图互相破坏，那么这些名称将导致他们关注“谁让这个代码出错”或“这个测试失败了，因为 X 编码很糟糕' 而不是专注于测试可能检测到的错误。

因此，当显式地将名称附加到这样的测试时，总会有一个平衡。正如安迪所提到的，如果你真的需要知道是谁写的东西，总会有源代码控制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-14T19:57:05.313

我认为这真的取决于你的其他文化是围绕代码所有权的。如果您的团队文化是所有代码都归某个人所有，并且只有那个人可以接触该代码，那么标记谁的代码可能是有意义的。

However, I prefer to work on teams where there's collective ownership of code. Sometimes it's nice to have an original author on a file, just to see whose original design it was, but beyond that, I don't think tagging specific tests is useful.

As other people mentioned, if you really need to figure out who made a particular change, you can figure that out from version control. In general though, I think tests should be owned and maintained by the whole team.

# amazon-s3 - Amazon Simple Storage Service (S3) 的可负担性

> ID：644649
> 
> 赞同：6
> 
> 时间：2009-03-13T21:11:11.123
> 
> 标签：amazon-s3

我有一个每月吸引大约 30,000 名访问者的网站。它有很多照片和 PDF 文件，会占用大量带宽。它由 site5.com 托管，提供无限带宽和存储，每月约 5 美元。根据site5 的统计，我的网站每天有大约20 GB 的下载量，但我看到它高达116 GB。上传范围为每天 5-15 GB。（不过，我并不是真的每天都上传东西，所以我不知道他们从哪里得到这些数字。）

为了进一步扩大我的网站，也许通过托管视频、高分辨率照片等，我正在寻找其他存储选项，尽管 site5 已经相当不错了。具体来说，amazon.com 的[简单存储服务](http://aws.amazon.com/s3/)(S3) 看起来相当不错，应该是“高度可扩展、可靠、快速、**廉价的**数据存储基础设施”。

使用 Amazon 的[Simple Monthly Calculator](http://calculator.s3.amazonaws.com/calc5.html)，我将最坏情况的数字相乘：

```
Storage: 2 GB
Data Transfer-in: 15 GB/day * 31 days = 465 GB/month
Data Transfer-out: 116 GB/day * 31 days = 3596 GB/month 
```

仅凭这些数字，计算器估计我每月的账单就高达 658.27 美元！！！这太疯狂了！有人在这里使用 S3 吗？你的账单离谱吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T21:39:52.333

哇，你确定这些数据吗？我想这是可能的，但你很幸运，你的主人没有给你启动。租用一台专用服务器通常可以让您获得大约 1.5TB/月的流量，至少是您现在支付的费用的 20 倍。如果您以每月 5 美元的价格购买 3.5TB 并且您的主机没有抱怨，那就不要考虑搬家了。

（注意：大多数无限计划确实受到公司服务条款的限制，这通常允许他们让任何人使用“太多”资源。）

在您继续之前，我会尝试找到一些方法来验证您的统计数据。

5/3500GB 是每演出 0.0014 美元。这太疯狂了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T21:26:36.440

3.6TB/月有点多。就像一个健全的检查一样，如果我幸运的话，我的互联网连接似乎可以提供大约 100kB/秒的接收速度（我假设发送/接收老鼠大致相同）。在那个带宽限制下，我的计算机需要 417 天连续发送才能传送这么多数据。

每 GB 10c 对我来说似乎很合理。[NearlyFreeSpeech.net](https://www.nearlyfreespeech.net/services/hosting.php#pricing)收取 1 美元/GB 的交付费用，但在大批量交付时会降至 20c/GB。[Mosso](http://www.mosso.com/pricingfiles.jsp)收取 22c/GB 交付费用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T21:38:59.170

如果您为无限制的传输和存储支付 5 美元，我会坚持使用您当前的提供商，因为他们提供的东西是其他人无法以这个价格为您提供的。

S3 也是一个内容分发网络，它有一定的正常运行时间保证、数据存储保证，你的主机可能没有。当亚马逊说他们可以每天为您提供 116 GB 的流量时，他们是认真的，而您的主机可能超卖了他们的容量，并希望人们不要真正使用他们的无限传输。

就你使用的东西而言，你正在偷窃。祝你在别处找到它。

# asp.net-mvc - 未使用 WebFormViewEngine 中的 MasterLocationFormats？

> ID：644655
> 
> 赞同：1
> 
> 时间：2009-03-13T21:12:52.383
> 
> 标签：asp.net-mvc, viewengine

我试图让 ViewEngine 使用额外的路径：

```
base.MasterLocationFormats = new string[] {
    "~/Views/AddedMaster.Master"
}; 
```

在 ViewEngine 的构造函数中。它适用于 aspx 和 ascx（PartialViewLocationFormats，ViewLocationFormats）。

我仍然需要在 web.config 或页面声明中提供 MasterPage。但如果我这样做了，则使用此声明，而不是 ViewEngine 中的声明。如果我使用空 MasterLocationFormats，则不会引发错误。这不是在 RC1 中实现的吗？

编辑：

使用：

```
return View("Index", "AddedMaster"); 
```

代替

```
return View("Index"); 
```

在控制器工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T14:23:30.940

您的示例并不完整，但我猜测您的代码块存在于类级别而不是构造函数方法内部。问题在于基类 ( `WebFormViewEngine`) 在构造函数中初始化了“位置格式”属性，因此覆盖了您的声明；

```
public CustomViewEngine()
{
    MasterLocationFormats = new string[] {
        "~/Views/AddedMaster.Master"
    };
} 
```

如果您希望硬编码的 master 仅作为最后努力的默认值启动，您可以执行以下操作：

```
public CustomViewEngine()
{
    MasterLocationFormats = new List<string>(MasterLocationFormats) {
        "~/Views/AddedMaster.Master"
    }.ToArray();
} 
```

# vb.net - 我是初学者，不明白为什么我的代码会抛出“预期表达式”

> ID：644668
> 
> 赞同：5
> 
> 时间：2009-03-13T21:21:05.937
> 
> 标签：vb.net

我是开发新手，当我尝试编译下面的代码时收到错误“预期表达式”。我究竟做错了什么？

```
Public Class Form1

    Private Sub btnCompute_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCompute.Click

        Dim Occupation As String = CStr(txtOccupation.Text)
        Dim Bill As Double = CDbl(txtBill.Text)
        Dim Tip As Double = CDbl(txtTip.Text)

        lstOutput.Text = Bill * (1 + if (Tip<1,Tip,Tip/100))

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T21:26:02.617

我猜最后一行抛出了异常

```
lstOutput.Text = Bill * (1 + if (Tip<1,Tip,Tip/100)) 
```

您使用了 if...then 语句中使用的“if”，但我敢打赌您的意思是 iif，它是一个函数

```
lstOutput.Text = Bill * (1 + IIf (Tip<1,Tip,Tip/100)) 
```

只需添加一个额外的“i”就可以了

[解释“IF”和“IIF()”区别的文章](http://secretgeek.net/iif_function.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T16:59:24.687

如果你用的是2008？或者以后如果没问题

```
 Dim tipT As New TextBox
    Dim Bill As Decimal = 9D
    Dim tip As Decimal = 20
    tipT.Text = Convert.ToString(Bill * If(tip >= 1, tip / 100, tip)) 
```

# .net - 具有命令行支持的 Win64 下 .NET 3.5 的可靠 CPU 分析器？

> ID：644672
> 
> 赞同：2
> 
> 时间：2009-03-13T21:22:47.180
> 
> 标签：.net, command-line, 64-bit, profiling, cpu

我正在寻找一个支持 .NET 的 CPU 分析器

*   大量线程的应用程序。
*   （双）四核 CPU。
*   抽样分析。
*   64 位操作系统。
*   命令行 API。

目前，我在使用大多数 .NET 分析器时遇到了麻烦，特别是，

*   YourKit 似乎不支持命令行。
*   dotTrace 3.1 因 64 位操作系统而崩溃。

到目前为止，我还没有尝试过 Intel VTune。有什么开明的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T15:37:00.403

线程往往会使大多数分析器感到困惑，因为他们不确定如何计算一个线程被阻塞等待另一个线程的时间以及线程等待工作的时间（如果您不使用线程池）。

根据我们的经验，您应该检查两个分析器： 1\. [Eqatech](http://www.eqatec.com/tools/profiler)有一个免费的分析器，可以为分析执行代码注入。它只适用于方法级别，但确实适用于 64 位，并且可以让您了解您的时间在哪里。2\. Red-Gate ANT 分析器是我们用于深入研究行级时序的最佳工具，如果您遇到线程在其执行时间的很大一部分中相互阻塞等待的情况，这一点至关重要。

也就是说，如果您可以在没有用户界面的情况下运行测试，我强烈建议您设置一些 NUnit 性能测试，以便您可以快速轻松地每次都以完全相同的方式重复它们。这样做你可以看到你的时间在哪里，即使使用方法级别分析器，建议和检查单个优化等。你会惊讶于如何从一个地方花费时间只是将它添加到另一个地方，因为线程最终会相互等待，因此进行完全可重复的测试非常有用。

Eqatech 分析器会修改您编译的 IL，因此每当您重新运行该 IL 时，您都会获得一个新的性能跟踪文件，因此它应该适合您的命令行场景。我相信 ANT 可以类似地工作。

最后，如果您的应用程序要在多个环境中使用，我绝对建议在单个处理器或仅超线程处理器上运行一些性能测试。当您对多核调优变得非常积极时，您最终可能会增加足够的开销，从而导致死锁或只是在少量处理器上变慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T21:29:11.503

[Redgate](http://www.red-gate.com/products/ants_profiler/index.htm)有一个分析器，如果我没记错的话不能告诉你它是否有你需要的一切，但试试看？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T21:31:44.367

-- 编辑 2 --- 另一种可能的选择（但需要更多努力）是使用[NProf](http://sourceforge.net/projects/nprof)并只是调整源以去除 GUI？

[AQTime](http://www.automatedqa.com/products/aqtime/)很好地支持 64 位操作系统上的命令行应用程序。

- - 编辑 - -

AQTime 也支持命令行 API。它具有启动项目、配置文件和自动退出的选项。我相信它会满足您的所有标准，并支持托管 + 本机代码库。

从命令行上的 AQTime 帮助：

“如您所见，使用命令行参数，您可以启动 AQtime，在其中加载项目，开始分析并在分析完成后关闭 AQtime。所有这些都使您能够将 AQtime 集成到应用程序的自动化测试中。运行例如，在每个应用程序构建后进行这些测试，您可以轻松查看应用程序代码的更改是否导致性能瓶颈或内存使用效率低下。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T00:57:52.803

你的目标是什么？

如果您想*测量例程的执行时间和计数*，我想您需要一个分析器。

如果你想*找到性能问题*，那么你可以修复它们，那是一个不同的问题。

我只是问，因为不知何故，这个想法很流行，他们是一样的。

对于后一个目标，尝试过的人都明白，研究线程调用堆栈的一些随机时间样本是发现性能问题的一种非常有效的方法。

我知道 Java 允许您同时停止所有线程并转储它们的调用堆栈。我认为.net 开发环境会允许同样的事情。

如果没有，只需在 IDE 下运行它并一次停止一个线程，看看它是否在浪费任何周期。如果是，您只需修复它。重复直到找不到任何东西。

如果你对所有线程都这样做，那么至少你知道任何慢都不是由于任何给定线程的慢。您仍然可能遇到不必要的消息流量问题。诊断起来有点棘手。

# c++ - 通过保留和复制，还是通过创建和交换来复制向量更有效？

> ID：644673
> 
> 赞同：165
> 
> 时间：2009-03-13T21:23:28.600
> 
> 标签：c++, algorithm, vector, stl

我正在尝试有效地制作矢量的副本。我看到两种可能的方法：

```
std::vector<int> copyVecFast1(const std::vector<int>& original)
{
  std::vector<int> newVec;
  newVec.reserve(original.size());
  std::copy(original.begin(), original.end(), std::back_inserter(newVec));
  return newVec;
}

std::vector<int> copyVecFast2(std::vector<int>& original)
{
  std::vector<int> newVec;
  newVec.swap(original);
  return newVec;
} 
```

其中哪一个是首选，为什么？我正在寻找最有效的解决方案，以避免不必要的复制。

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2009-03-13T21:25:10.840

然而，它们并不相同，不是吗？*一个是副本，另一个是交换*。因此函数名称。

我最喜欢的是：

```
a = b; 
```

哪里`a`和`b`是向量。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2009-03-13T21:30:36.630

如果您通过引用发送参数，则第二个示例不起作用。你的意思是

```
void copyVecFast(vec<int> original) // no reference
{

  vector<int> new_;
  new_.swap(original); 
} 
```

这会奏效，但更简单的方法是

```
vector<int> new_(original); 
```

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2009-03-13T21:28:00.943

这是制作向量副本的另一种有效方法，只需使用其构造函数：

```
std::vector<int> newvector(oldvector); 
```

这甚至比使用`std::copy`从头到尾将整个向量遍历`std::back_insert`到新向量更简单。

话虽如此，您`.swap()`的不是副本，而是交换了两个向量。您将修改原始文件以不再包含任何内容！这不是副本。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2017-12-28T02:02:52.670

# 直接回答：

*   使用`=`运算符

`std::vector::operator=`我们可以使用容器的公共成员函数`std::vector`将值从一个向量分配给另一个。

*   使用构造函数

此外，构造函数也很有意义。以另一个向量作为参数（例如`x`）的构造函数构造一个容器，其中包含 中每个元素的副本，`x`顺序相同。

# 警告：

*   不使用`std::vector::swap`

`std::vector::swap`不是将一个向量***复制***到另一个向量，它实际上是交换两个向量的元素，正如它的名字所暗示的那样。换句话说，要复制的源向量在`std::vector::swap`调用之后被修改，这可能不是您所期望的。

*   深拷贝还是浅拷贝？

如果源向量中的元素是指向其他数据的指针，那么有时需要深拷贝。

根据维基百科：

> 深拷贝，意味着字段被取消引用：不是对被复制对象的引用，而是为任何被引用的对象创建新的复制对象，并将对这些对象的引用放在 B 中。

实际上，目前 C++ 中没有内置的方法来进行深度复制。上面提到的所有方法都是肤浅的。如果需要深拷贝，您可以遍历向量并手动复制引用。或者，可以考虑使用迭代器进行遍历。关于迭代器的讨论超出了这个问题。

# 参考

[`std::vector`cplusplus.com上的页面](http://www.cplusplus.com/reference/vector/vector/)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-08-31T19:27:28.837

```
new_vector.assign(old_vector.begin(),old_vector.end()); // Method 1
new_vector = old_vector; // Method 2 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-03-13T21:27:05.533

你不应该使用交换来复制向量，它会改变“原始”向量。

将原来的作为参数传递给新的。

# c - 截断时的浮点舍入

> ID：644678
> 
> 赞同：3
> 
> 时间：2009-03-13T21:25:31.357
> 
> 标签：c, floating-point, x86, fpu

这可能是 x86 FPU 专家的问题：

我正在尝试编写一个在 [min,max] 范围内生成随机浮点值的函数。问题是我的生成器算法（浮点 Mersenne Twister，如果你好奇的话）只返回 [1,2) 范围内的值 - 即，我想要一个包容性的上限，但我的“源”生成值是从一个排他的上限。这里的问题是底层生成器返回一个 8 字节的双精度，但我只想要一个 4 字节的浮点数，而且我使用的是默认的 FPU 舍入模式 Nearest。

我想知道的是，在这种情况下，截断本身是否会导致我的返回值在 FPU 内部 80 位值足够接近时包含最大值，或者我是否应该在将最大值乘以之前增加最大值的有效位[1,2) 中的中间随机数，或者我是否应该更改 FPU 模式。当然，或者任何其他想法。

这是我目前使用的代码，我确实验证了 1.0f 解析为 0x3f800000：

```
float MersenneFloat( float min, float max )
{
    //genrand returns a double in [1,2)
    const float random = (float)genrand_close1_open2(); 
    //return in desired range
    return min + ( random - 1.0f ) * (max - min);
} 
```

如果它有所作为，这需要在 Win32 MSVC++ 和 Linux gcc 上工作。另外，使用任何版本的 SSE 优化会改变这个问题的答案吗？

**编辑：**答案是肯定的，在这种情况下，从 double 到 float 的截断足以导致结果包含 max。有关更多信息，请参阅 Crashworks 的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T22:03:39.127

SSE 操作将巧妙地改变该算法的行为，因为它们没有中间的 80 位表示——数学实际上是在 32 位或 64 位中完成的。好消息是，您可以轻松地对其进行测试，并通过简单地将 /ARCH:SSE2 命令行选项指定给 MSVC 来查看它是否会更改您的结果，这将导致它使用 SSE 标量操作而不是 x87 FPU 指令来处理普通浮点数学。

我不确定整数边界周围的确切舍入行为是什么，但你可以测试看看当 1.999.. 从 64 位舍入到 32 位时会发生什么，*例如*

```
static uint64 OnePointNineRepeating = 0x3FF FFFFF FFFF FFFF // exponent 0 (biased to 1023), all 1 bits in mantissa
double asDouble = *(double *)(&OnePointNineRepeating);
float asFloat = asDouble;
return asFloat; 
```

**编辑，结果：**原始发帖人运行了这个测试，发现在截断的情况下，1.99999 在有和没有 /arch:SSE2 的情况下都将四舍五入为 2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T21:35:29.553

如果您确实调整了舍入以使范围的两端都包括在内，那么这些极端值的可能性不只是任何非极端值的一半吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T21:44:02.637

使用截断，您将永远不会包含最大值。

你确定你真的需要最大值吗？从字面上看，您将完全达到最大值的可能性几乎为 0。

也就是说，您可以利用您放弃精度的事实并执行以下操作：

```
float MersenneFloat( float min, float max )
{
    double random = 100000.0; // just a dummy value
    while ((float)random > 65535.0)
    {
        //genrand returns a double in [1,2)
        double random = genrand_close1_open2() - 1.0; // now it's [0,1)
        random *= 65536.0; // now it's [0,65536). We try again if it's > 65535.0
    }
    //return in desired range
    return min + float(random/65535.0) * (max - min);
} 
```

请注意，现在，每次调用 MersenneFloat 时，它都有可能多次调用 genrand。因此，您已经放弃了封闭区间的可能性能。由于您正在从 double 向下转换为 float，因此您最终不会牺牲任何精度。

编辑：改进算法

# command-line - 将图像序列转换为具有透明度的视频

> ID：644684
> 
> 赞同：44
> 
> 时间：2009-03-13T21:27:12.910
> 
> 标签：command-line, video, transparency, ffmpeg, codec

我有一个看起来应该是一个非常简单的问题，但事实证明它比我预期的要困难得多。这是问题：

我有一个相当大的图像序列，由编号的帧组成（从 Maya 输出，值得一提）。这些图像目前是 Targa (.tga) 格式，但如果这很重要，我可以将它们转换为 PNG 或其他任意格式。重要的是，他们有一个 Alpha 通道。

我想做的是以编程方式将它们变成视频剪辑。格式并不重要，但它必须是无损的并且具有 Alpha 通道。Quicktime 容器中的未压缩视频可能是理想的。

我最初的想法是 ffmpeg，但是在浪费了一天的大部分时间之后，它似乎根本不支持 alpha 通道。要么我遗漏了一些东西，要么底层的 libavcodec 没有做到这一点。

那么，这里的正确方法是什么？像 ffmpeg 这样的命令行工具会很好，但是任何在 Windows 上运行并且可以从脚本调用的解决方案都可以。

注意：在您的视频中包含一个 alpha 通道实际上并不少见，如果您想将它合成到另一个视频剪辑或静止图像的顶部，它非常有用。据我所知，未压缩视频、Quicktime Animation 编解码器和 Sorenson Video 3 编解码器都支持透明，而且我听说 H.264 也支持。我们真正谈论的是 32 位色深，它得到了相当广泛的支持；Quicktime .mov 文件和 Windowss .avi 文件都可以处理它，而且可能更多。

Quicktime Pro 非常乐意将图像序列转换为 32 位 .mov 文件。点击导出，将颜色深度更改为“Millions of Colors+”，选择动画编解码器，将质量提高到 100，就可以了 - 无损压缩视频，带有 alpha 通道，它几乎可以在编解码器后的任何地方播放自 1.0 版以来一直是 Quicktime 的一部分。问题是，Quicktime Pro 没有任何类型的命令行界面（至少在 Windows 上）。ffmpeg 支持使用 Quicktime Animation 编解码器（它称为 qtrle）进行编码，但它仅支持 24 位的位深度。

问题在于找不到支持 Alpha 通道的视频格式。Quicktime Animation 将是理想的，但即使是未压缩的视频也应该可以工作。问题是找到一个支持它的工具。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-12-07T00:02:01.507

是的，ffmpeg 确实支持视频文件中的 alpha 通道。并非 ffmpeg 中的所有编解码器似乎都支持 alpha。.MOV 文件中的 Motion PNG 是 alpha 的一种很好的组合。

要将带有 alpha 的图像编码/导入到带有 alpha 的视频中，请尝试：`ffmpeg -i %d.png -vcodec png z.mov`

Quicktime 将播放它。

要将带有 alpha 的视频解码/导出为带有 alpha 的图像，请尝试：`ffmpeg -i z.mov -f image2 export2\%d.png`

请注意，我将它们导出到名为“export2”的目录中。请务必将 %d 部分留在其中。这些命令将按原样在 Windows 系统上运行。Linux/Mac 用户可能需要像往常一样添加引号并将一些 \ 换成 /。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-18T09:17:21.930

我知道这个话题有点老了，但我还是在发帖。

带有 Quicktime Animation (RLE) 或 FFVHUFF/HUFFYUV 的 FFMPEG 可以。

*   ffmpeg -i yoursequence%d.png -vcodec qtrle movie_with_alpha.mov
*   ffmpeg -i yoursequence%d.png -vcodec ffvhuff movie_with_alpha.avi
*   ffmpeg -i yoursequence%d.png -vcodec huffyuv movie_with_alpha.avi

您将获得保留透明度（Alpha 通道）的视频文件。

我还听说 On2-VP6 变体（还不是 WebM-VP8）可以处理 alpha，但我手头没有他们的编解码器。

这也有效。- ffmpeg -i yoursequence%d.png -vcodec png movie_with_alpha.mov

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-29T18:13:19.497

对于遇到这个问题并沮丧地撞到墙上的 Web 开发人员来说……创建一个[透明的 WebM 视频](http://updates.html5rocks.com/2013/07/Alpha-transparency-in-Chrome-video)是可能的，但目前您可能需要从源代码编译 ffmpeg 和所需的库。

我想在网站上显示渲染的 Blender 视频，但要保持透明度。第一步是将 Blender 输出渲染为单独的 PNG 文件。在那之后，我花了很长时间试图强制 ffmpeg 将这些 PNG 文件转换为单个视频。基本命令很简单：

```
ffmpeg -i input%04d.png output.webm 
```

此命令`input0000.png`通过文件名加载所有 PNG，`input9999.png`并将它们转换为视频。透明度很快就消失了。梳理输出我意识到 ffmpeg 有助于选择非透明格式：

`Incompatible pixel format 'yuva420p' for codec 'flv', auto-selecting format 'yuv420p'`

在这一点上，我意识到我可能必须从头开始重新编译 ffmpeg。我在其他一些工具上苦苦挣扎，但最终还是回到了 ffmpeg。从最新的源代码编译 libvbx 和 ffmpeg 之后，事情变得很有吸引力。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-07-05T11:50:08.310

检查您的 ffmpeg 版本

```
ffmpeg -version 
```

ffmpeg 版本 n4.1.4 版权所有 (c) 2000-2019 FFmpeg 开发人员使用 gcc 7 (Ubuntu 7.4.0-1ubuntu1~18.04.1) 构建

您需要更新到 v4 才能使用 alpha 支持

```
sudo snap install ffmpeg 
```

注意，您需要从系统中丢弃旧的 ffmpeg。

```
sudo apt-get remove ffmpeg  
ffmpeg -version

ffmpeg version n4.1.4 Copyright (c) 2000-2019 the FFmpeg developers
  built with gcc 7 (Ubuntu 7.4.0-1ubuntu1~18.04.1)
  configuration: --prefix= --prefix=/usr --disable-debug --disable-doc --disable-static --enable-avisynth --enable-cuda --enable-cuvid --enable-libdrm --enable-ffplay --enable-gnutls --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfontconfig --enable-libfreetype --enable-libmp3lame --enable-libopencore_amrnb --enable-libopencore_amrwb --enable-libopus --enable-libpulse --enable-sdl2 --enable-libspeex --enable-libtheora --enable-libtwolame --enable-libv4l2 --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265 --enable-libxcb --enable-libxvid --enable-nonfree --enable-nvenc --enable-omx --enable-openal --enable-opencl --enable-runtime-cpudetect --enable-shared --enable-vaapi --enable-vdpau --enable-version3 --enable-xlib
  libavutil      56\. 22.100 / 56\. 22.100
  libavcodec     58\. 35.100 / 58\. 35.100
  libavformat    58\. 20.100 / 58\. 20.100
  libavdevice    58\.  5.100 / 58\.  5.100
  libavfilter     7\. 40.101 /  7\. 40.101
  libswscale      5\.  3.100 /  5\.  3.100
  libswresample   3\.  3.100 /  3\.  3.100
  libpostproc    55\.  3.100 / 55\.  3.100 
```

注意 - 您可以通过传递来隐藏上述内容，以免每次运行 ffmpeg 时不断出现

-hide_banner

# ruby-on-rails - ActiveRecord::StatementInvalid: 找不到表 'tablename'

> ID：644691
> 
> 赞同：6
> 
> 时间：2009-03-13T21:29:20.690
> 
> 标签：ruby-on-rails, sqlite

```
cis.statbib.org: script/console 
Loading development environment (Rails 2.2.2)
Article.founc>> Article.count()
ActiveRecord::StatementInvalid: Could not find table 'article'
    from /home/hadley/web/cis.statbib.org/vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb:29:in `table_structure'
    from /home/hadley/web/cis.statbib.org/vendor/rails/activesupport/lib/active_support/core_ext/object/misc.rb:39:in `returning'
... 
```

但它确实似乎在数据库中：

```
db: sqlite3 development.sqlite3 
SQLite version 3.2.8
sqlite> select count(*) from author;
168600 
```

我刚刚更新了我所有的宝石等。出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T19:41:14.477

这似乎是由 ActiveRecord 中的错误引起的，[http:](http://rails.lighthouseapp.com/projects/8994/tickets/99-sqlite-connection-failing) //rails.lighthouseapp.com/projects/8994/tickets/99-sqlite-connection-failing 。如该链接中所述，猴子修补文件解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T22:12:58.417

正如 Sarah Mei 在评论中已经指出的那样，您正在手动检查“作者”而不是“文章”。

但是，这里也可能存在其他问题。您是否有意在模型中将表名设置为“article”？默认情况下，这应该是寻找“文章”（复数）表，所以我怀疑还有更多我们没有看到的代码可能会导致问题。

# c# - 最佳实践 - 从 C# 中的通用集合中删除项目

> ID：644692
> 
> 赞同：3
> 
> 时间：2009-03-13T21:30:06.337
> 
> 标签：c#, generics, .net-3.5

我在带有 .NET 3.5 的 Visual Studio 2008 中使用 C#。

我有一个通用字典，将事件类型映射到通用订阅者列表。一个订阅者可以订阅多个事件。

```
private static Dictionary<EventType, List<ISubscriber>> _subscriptions; 
```

要从订阅列表中删除订阅者，我可以使用这两个选项中的任何一个。

选项1：

```
ISubscriber subscriber;  // defined elsewhere
foreach (EventType event in _subscriptions.Keys) {
    if (_subscriptions[event].Contains(subscriber)) {
        _subscriptions[event].Remove(subscriber);
    }
} 
```

选项 2：

```
ISubscriber subscriber;  // defined elsewhere
foreach (EventType event in _subscriptions.Keys) {
    _subscriptions[event].Remove(subscriber);
} 
```

我有两个问题。

首先，请注意选项 1 在删除项目之前检查是否存在，而选项 2 使用暴力删除，因为 Remove() 不会引发异常。在这两种方法中，哪一种是首选的“最佳实践”方法？

其次，是否有另一种“更干净”的更优雅的方式来做到这一点，也许使用 lambda 表达式或使用 LINQ 扩展？我还在适应这两个功能。

谢谢。

## 编辑

澄清一下，我意识到选项 1 和 2 之间的选择是速度（选项 2）与可维护性（选项 1）的选择。在这种特殊情况下，我不一定要尝试优化代码，尽管这当然是值得考虑的。我想了解的是，是否有一个普遍成熟的做法来做到这一点。如果不是，您会在自己的代码中使用哪个选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T21:33:19.637

选项 1 会比选项 2 慢。Lambda 表达式和 LINQ 会更慢。我会使用`HashSet<>`而不是`List<>`.

如果您需要确认项目移除，则`Contains`必须使用。

已编辑：由于在语句中使用代码的可能性很高`lock`，最佳实践是减少内部执行时间`lock`，因此应用选项 2 可能很有用。看起来没有使用或不使用`Contains`的最佳实践`Remove`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T21:38:21.183

Remove() 方法“接近 O(1)”并且当键不存在时是可以的。

但除此之外：如有疑问，请测量。获得一些时间并不难...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T06:04:53.463

当您只关心值时，为什么要枚举键？

```
foreach (List<ISubscriber> list in _subscriptions.Values)
{
    list.Remove(subscriber);
} 
```

也就是说，Eric P 建议的 LINQ 解决方案肯定更简洁。不过，性能可能是个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T21:33:57.387

我会选择第二个选项。Contains() 和 Remove() 都是 O(n) 方法，没有理由同时调用这两个方法，因为 Remove 不会抛出。至少对于方法 2，您只调用了一个昂贵的操作而不是两个。

我不知道有更快的方法来处理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T21:48:10.397

如果您想使用 Linq 来执行此操作，我认为这会起作用（未经测试）：

```
_subscriptions.Values.All(x => x.Remove(subscriber)); 
```

不过可能想检查一下性能。

# database - CouchDB 与 RDBMS 相比有哪些优势

> ID：644695
> 
> 赞同：9
> 
> 时间：2009-03-13T21:31:57.690
> 
> 标签：database, couchdb

我最近听到了很多关于[couchdb](http://couchdb.apache.org/)的消息，并且对它提供的功能感到困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-14T21:20:46.550

很难以严格的优势/劣势形式解释所有差异。

我建议你自己玩一下 CouchDB。您会注意到的第一件事是初始使用期间的学习曲线与 RDBMS 完全相反。

使用 RDBMS，您需要花费大量时间对现实世界的数据进行建模，以将其输入数据库。处理完建模后，您可以进行各种查询。

使用 CouchDB，您只需几分钟即可获得 JSON 格式的所有数据并存储在数据库中。你不需要做任何规范化或类似的事情，而且传输是 HTTP，所以你有很多客户端选项。

然后，在编写地图函数并学习密钥排序规则的工作原理以及针对您编写的视图的查询时，您会注意到一个很大的学习曲线。学习它们后，您将开始了解视图如何允许您规范化索引，​​同时使数据保持非规范化和“自然”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T23:30:29.537

*   快速敏捷的架构更新/更改
*   使用您选择的图灵完备语言 Map Reduce 查询。（没有更多的sql）
*   灵活的架构设计
*   自由形式对象存储
*   真的很容易复制
*   非常简单的负载平衡（很快）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T21:53:47.653

CouchDB 是一个[面向文档的数据库](http://en.wikipedia.org/wiki/Document-oriented_database)。

维基百科：

> 与关系数据库相反，基于文档的数据库不会将数据存储在每个记录具有统一大小字段的表中。相反，每条记录都存储为具有某些特征的文档。可以将任意数量的任意长度的字段添加到文档中。字段还可以包含多条数据。

优点：

*   在文档中留下空白字段不会浪费空间（因为它们不是必需的）
*   通过提供简单的编辑前端，可以快速设置应用程序来维护数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T17:41:57.643

看看[这里](http://www.davispj.com/posts/10)。我认为更好的答案是：

> 正如 CouchDB 并不总是适合这项工作的工具一样，RDBMS 也不总是正确的答案。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-09-12T03:58:12.730

CouchDB 是一个磁盘占用者，因为它不更新文档——每次更新时它都会创建一个新的修订版，因此不浪费空间部分因为您没有空字段而被修订版压倒了。

# sharepoint - Sharepoint BDC 错误：实体 tblStaff 的标题属性设置为无效值

> ID：644697
> 
> 赞同：1
> 
> 时间：2009-03-13T21:32:55.767
> 
> 标签：sharepoint, sharepoint-2007, moss, business-intelligence, bdc

我刚刚开始为我们的实践管理系统创建我们的业务数据目录，我遇到了一个与我们的员工表有关的问题。

背景：

1.  我正在使用业务数据目录定义编辑器来创建我的 ADF。
2.  我正在使用 RevertToSelf 身份验证模式。
3.  我试过其他几张桌子，到目前为止它们似乎工作得很好。唯一的问题是员工桌子。
4.  如果我删除了人员实体的所有列，除了 ID 和它实际工作的名称的几列。所以我在 tblStaff 中的一个专栏有问题。
5.  即使我设置了一个仅包含这一个实体的 ADF，我也会收到此错误。所以没有关联..

尝试查看记录时：[http://servername/ssp/admin/Content/tblstaff.aspx?StaffID=](http://servername/ssp/admin/Content/tblstaff.aspx?StaffID=) {0} w/ {0} 替换为实际员工 ID 我收到以下错误：

实体 tblStaff 的 title 属性设置为无效值。

我尝试过的事情：

1.  我注意到我的员工表中有一个名为“Title”的列，并从 ADF 中删除了它，但没有运气......同样的错误..
2.  我试图使用 bdc meta man 创建我的 ADF，但我得到了同样的错误......

有任何想法吗？

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T20:48:42.423

克里斯，试试这个[http://www.anthonypounder.com/blog/cns!400938DCD454D501!728.entry](http://www.anthonypounder.com/blog/cns!400938DCD454D501!728.entry)。

希望能帮助到你。

托尼

# jsp - 浏览器要求保存 JSP

> ID：644707
> 
> 赞同：1
> 
> 时间：2009-03-13T21:36:24.293
> 
> 标签：jsp, oc4j

我以前使用过 JBoss 和 WebLogic，但在我目前的工作中，我们使用的是 OC4J，这对我来说是第一次。我*认为*我的问题可能与此有关。我正在创建一个 EAR 文件，其中包含一个 WAR 文件。顶级 JSP 似乎可以正确显示，但是当我尝试在子目录中显示 JSP（如 secure/index.do 或 secure/header.jsp）时，浏览器会询问我是否要保存文件。如果我保存它，它是一个 0 字节大小的文件。实际上，我也尝试了secure/index.xyz，我知道它不存在，它做了同样的事情。我*知道*那些其他文件/servlet 存在。关于可能导致这种情况的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T21:53:01.883

我相信浏览器会提示您为它无法识别的内容类型保存文件。在这种情况下，服务器响应可能包含乱码或不正确的内容类型。

从您对问题的其余描述来看，这听起来像是一般的服务器配置问题。您要做的一件事是检查服务器是否提供了任何示例项目（或 EAR），并查看您是否可以重现相同的问题。如果您看到相同的行为，这指向配置，如果没有，它可能不喜欢您的部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T02:44:35.533

我同意理智的达纳。可能您的 Web 服务器或 JBoss 在响应中返回了错误的内容类型。如果您有 Wireshark，请在客户端上运行 Wireshark，然后查看响应中的 HTTP 标头。我希望内容类型标头是您的浏览器不知道如何处理或显示的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-14T02:50:44.180

如果您使用的是 firefox 安装 LiveHTTPHeaders，请查看当您访问给您带来麻烦的 url 时服务器返回给浏览器的内容。如果它是一个奇怪的 content-type 值或者有一个 content-disposition 标头，那就是问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T03:26:44.967

埃迪是对的！

否则，如果服务器上的负载太高，可能会导致渲染错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T23:00:08.747

找到了。你们在内容类型问题上基本上是正确的，但是我的代码中有一个潜在的错误导致了这个问题。我创建了一个过滤器，称为 SecureActionFilter，只要有 /secure/* URL 就会调用它。问题是我打破了链条。我忘记将“chain.doFilter(req, res)”添加到我的“doFilter”方法的末尾。因此，该请求从未转发到 JSP，因此没有任何内容返回给浏览器，包括任何 MIME 类型，然后浏览器尝试将长度为 0 的内容保存到我的文件系统中。

# c# - 为什么在移位 32 位值时只使用移位操作数的低五位？（例如（UInt32）1 << 33 == 2）

> ID：644708
> 
> 赞同：14
> 
> 时间：2009-03-13T21:37:04.697
> 
> 标签：c#, bit-shift

考虑以下代码：

```
UInt32 val = 1;
UInt32 shift31 = val << 31;                    // shift31  == 0x80000000
UInt32 shift32 = val << 32;                    // shift32  == 0x00000001
UInt32 shift33 = val << 33;                    // shift33  == 0x00000002
UInt32 shift33a = (UInt32)((UInt64)val << 33); // shift33a == 0x00000000 
```

它不会产生警告（关于使用大于 32 的移位），因此它必须是预期的行为。

实际输出到生成程序集的代码（或至少 Reflector 对代码的解释）是

```
 uint val = 1;
 uint shift31 = val << 0x1f;
 uint shift32 = val;
 uint shift33 = val << 1;
 uint shift33a = val << 0x21; 
```

IL（再次，使用反射器）是

```
L_0000: nop 
L_0001: ldc.i4.1 
L_0002: stloc.0 
L_0003: ldloc.0 
L_0004: ldc.i4.s 0x1f
L_0006: shl 
L_0007: stloc.1 
L_0008: ldloc.0 
L_0009: stloc.2 
L_000a: ldloc.0 
L_000b: ldc.i4.1 
L_000c: shl 
L_000d: stloc.3 
L_000e: ldloc.0 
L_000f: conv.u8 
L_0010: ldc.i4.s 0x21
L_0012: shl 
L_0013: conv.u4 
L_0014: stloc.s shift33a 
```

我了解**发生了什么**（在[MSDN](http://msdn.microsoft.com/en-us/library/aa691377.aspx)中有描述）；编译代码时，移位 32 位值时仅使用低 5 位...我很好奇**为什么**会发生这种情况。

（出现的方式`shift33a`也让我认为 Reflector 不太对劲，因为他们对 IL 的 c# 表示会编译成不同的东西）

**问题：**

*   **为什么**只使用“要移位的值”的低 5 位？
*   如果“移动超过 31 位没有意义”，为什么没有警告？
*   这是向后兼容的事情吗（即这是程序员“期望”发生的事情）？
*   我是否正确，底层 IL 可以进行超过 31 位的移位（如`L_0010: ldc.i4.s 0x21`），但编译器正在修整这些值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T21:44:41.137

它基本上归结为 x86 处理算术移位操作码的方式：它只使用移位计数的低 5 位。例如，参见[80386 编程指南](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SAL.htm)。在 C/C++ 中，将位移位超过 31 位（对于 32 位整数）在技术上是未定义的行为，这符合 C 哲学“你不需要为不需要的东西付费”。从 C99 标准的第 6.5.7 节第 3 段：

> 对每个操作数执行整数提升。结果的类型是提升的左操作数的类型。如果右操作数的值为负数或大于或等于提升的左操作数的宽度，则行为未定义。

这允许编译器在 x86 上为移位省略单个移位指令。64 位移位不能在 x86 上的一条指令中完成。他们使用[SHLD](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SHLD.htm) / [SHRD](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SHRD.htm)指令加上一些额外的逻辑。在 x86_64 上，可以在一条指令中完成 64 位移位。

例如，gcc 3.4.4 发出以下程序集，用于 64 位左移任意量（用 编译`-O3 -fomit-frame-pointer`）：

```
uint64_t lshift(uint64_t x, int r)
{
  return x << r;
}

_lshift:
    movl    12(%esp), %ecx
    movl    4(%esp), %eax
    movl    8(%esp), %edx
    shldl   %cl,%eax, %edx
    sall    %cl, %eax
    testb   $32, %cl
    je      L5
    movl    %eax, %edx
    xorl    %eax, %eax
L5:
    ret 
```

现在，我对 C# 不是很熟悉，但我猜它有类似的理念——设计语言以使其尽可能高效地实现。通过指定移位操作仅使用移位计数的底部 5/6 位，它允许 JIT 编译器尽可能优化地编译移位。32 位移位以及 64 位系统上的 64 位移位可以将 JIT 编译为单个操作码。

如果将 C# 移植到其本机移位操作码具有不同行为的平台，那么这实际上会导致额外的性能损失——JIT 编译器必须确保遵守标准，因此它必须添加额外的逻辑确保只使用了移位计数的低 5/6 位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T22:32:21.053

Unit32 在规范中定义的 32 位溢出。你在期待什么？

CLR 没有使用溢出检测运算符 (1) 定义左移。如果您需要这种设施，您需要自己检查。

(1) C# 编译器可能会将其转换为 long，但我不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T22:04:13.947

我用 C (gcc, linux) 编写了这个简单的测试，并得到了类似的结果。有趣的是，过度移位的常量定义变成了零，而不是环绕。它确实对这些发出了警告，所以至少有人认识到这是一件“不正确的”事情。

```
#include <stdio.h>

unsigned int is0 = 1 << 31;
unsigned int is1 = 1 << 32;
unsigned int is2 = 1 << 33;

int main()
{
   unsigned int loopy = 0;
   int x = 0;
   printf("0x%08X\n", is0);
   printf("0x%08X\n", is1);
   printf("0x%08X\n", is2);

   for (x = 0; x < 35; ++x)
   {
      loopy = 1 << x;
      printf("%02d 0x%08X\n", x,loopy);
   }

   return 0;
} 
```

结果如下：

```
0x80000000
0x00000000
0x00000000
00 0x00000001
01 0x00000002
02 0x00000004
03 0x00000008
04 0x00000010
05 0x00000020
06 0x00000040
07 0x00000080
08 0x00000100
09 0x00000200
10 0x00000400
11 0x00000800
12 0x00001000
13 0x00002000
14 0x00004000
15 0x00008000
16 0x00010000
17 0x00020000
18 0x00040000
19 0x00080000
20 0x00100000
21 0x00200000
22 0x00400000
23 0x00800000
24 0x01000000
25 0x02000000
26 0x04000000
27 0x08000000
28 0x10000000
29 0x20000000
30 0x40000000
31 0x80000000
32 0x00000001
33 0x00000002
34 0x00000004 
```

# regex - 什么正则表达式可以匹配相同字符的序列？

> ID：644714
> 
> 赞同：62
> 
> 时间：2009-03-13T21:39:14.473
> 
> 标签：regex, perl

一个朋友问我这个问题，我被难住了：有没有办法制作一个匹配相同字符序列的正则表达式？例如，匹配“aaa”、“bbb”，但不匹配“abc”？

```
m|\w{2,3}| 
```

不会做的伎俩，因为它会匹配'abc'。

```
m|a{2,3}| 
```

不会成功，因为它与“bbb”、“ccc”等不匹配。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-03-13T21:43:03.920

确定的事！分组和参考是你的朋友：

```
(.)\1+ 
```

将匹配 2 个或多个相同字符的出现。仅对于单词组成字符，使用`\w`代替`.`，即：

```
(\w)\1+ 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-14T00:51:19.677

请注意，在 Perl 5.10 中，我们也为反向引用提供了替代符号。

```
foreach (qw(aaa bbb abc)) {
  say;
  say ' original' if /(\w)\1+/;
  say ' new way'  if /(\w)\g{1}+/;
  say ' relative' if /(\w)\g{-1}+/;
  say ' named'    if /(?'char'\w)\g{char}+/;
  say ' named'    if /(?<char>\w)\k<char>+/;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-14T00:42:49.993

这将比**\w**匹配更多，例如@@@：

```
/(.)\1+/ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T21:42:53.140

回答我自己的问题，但明白了：

```
m|(\w)\1+| 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T21:44:24.960

这就是反向引用的用途。

```
m/(\w)\1\1/ 
```

会成功的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T04:07:39.150

这也可以使用纯正则表达式（即那些描述正则语言的表达式——*而不是*Perl 正则表达式）。不幸的是，这意味着一个正则表达式，其长度与字母的大小成正比，例如：

```
(a* + b* + ... + z*) 
```

其中 a...z 是有限字母表中的符号。

因此，Perl 正则表达式虽然是纯正则表达式的超集，但即使您只想将它​​们用于纯正则表达式，也绝对有其优势！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-04T10:04:04.443

对于相同的 3 个字符：

*   `/(.)/1/1/`
*   `/(.)/1{2}/`

对于 2 个字符：

*   `/(.)/1/`

对于未知数量的相同字符：

*   `/(.)/1*/`

PS：我使用javascript

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-04-07T03:23:15.057

如果您使用的是 Java，并且在给定的字符串中找到重复的字符，这里是代码，

```
public class Test {
public static void main(String args[]) {
    String s = "abbc";
    if (s.matches(".*([a-zA-Z])\\1+.*")) {
        System.out.println("Duplicate found!");
    } else {
        System.out.println("Duplicate not found!");
    }
} 
```

}

# c# - C# 代码简化查询：Null 容器和 Foreach 循环

> ID：644715
> 
> 赞同：12
> 
> 时间：2009-03-13T21:39:39.107
> 
> 标签：c#

我经常有看起来像这样的代码：

```
if (itm != null)
{
    foreach (type x in itm.subItems())
    {
        //dostuff
    }
}
//do more stuff 
```

在省略的情况下`//do more stuff`，很容易避免额外的 foreach 循环。通过使用适当的命令退出作用域（取决于发生了什么，这通常意味着一个`return`语句或一个`continue statement`）。

这种类型的事情往往会导致箭头代码。我目前有几种方法可以解决这个问题：

*   使用类似的代码`itm = itm == null ? itm.subItems() : emptyArray`
*   允许箭头代码
*   采用`goto`
*   使用邪恶的作用域黑客（将整个事情，如果声明，在一个范围内，然后打破它）。在我看来，邪恶的作用域黑客基本上等同于`goto`丑陋和难以阅读，所以我不认为这是一个有效的解决方案。
*   将一些块重构为新方法。事实上，在少数情况下这可能**是**一个很好的解决方案，但大多数情况下它是不合适的，因为空引用主要是来自 MS 函数的错误条件。

有人愿意就哪些方法被认为更可取做出回应吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-13T21:53:42.083

如果你使用 C# 3，你总是可以写一个扩展方法：

```
public static IEnumerable<SubItem> SafeSubItems(this ItemType item)
{
     return item == null ? Enumerable.Empty<SubItem> : source.SubItems();
} 
```

然后只写：

```
foreach (SubItem x in itm.SafeSubItems())
{
    // do stuff
}
// do more stuff 
```

关键是甚至可以在“on”空引用上调用扩展方法。

一个“空安全解引用”操作符会更好，所以我们可以这样写：

```
// Not valid C# code!
foreach (SubItem x in itm?.SubItems() ?? Enumerable.Empty<SubItem>())
{
} 
```

或者只是定义一个`EmptyIfNull`扩展方法`IEnumerable<T>`并使用

```
// Not valid C# code!
foreach (SubItem x in (itm?.SubItems()).EmptyIfNull())
{
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T21:53:48.777

您可以使用[Coalesce](http://msdn.microsoft.com/en-us/library/ms173224.aspx "合并")运算符（编码为双问号，??，.net 2 向上）。这将返回值列表中的第一个非空值，所以在这个片段中......

```
MyClass o1 = null;
MyClass o2 = new MyClass ();
MyClass o3 = null;
return o1 ?? o2 ?? o3; 
```

...o2 将被返回。

因此，您可以将原始代码示例重新编码为

```
foreach (type x in (itm ?? emptyArray).subItems())
{
    //dostuff
}

//do more stuff 
```

但是，我个人不介意嵌套。立即清楚发生了什么。我发现 Coalesce 运算符有点难以阅读，而且为了清晰起见，这个小巢是一个很小的代价。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T21:43:23.823

我喜欢少嵌套，对我来说它读起来更好。请不要转到:)

我保持方法简短，因此通常是该场景的回报。

```
if (itm == null) return;
foreach (type x in itm.subItems())
{
   //dostuff
} 
```

如果需要更多的东西，是简单的语句并且可以在 foreach 之前完成，您可以：

```
if (itm == null)
{
   //do more stuff 
   return;
}
foreach (type x in itm.subItems())
{
   //dostuff
} 
```

如果不是上述情况，则很可能该方法太长，并且无论如何都会将其中一些移走。大概：

```
if( itm != null ) SomeActionOnSubItems(itm.subItems);
// do more stuff (can be some method calls depending on level of abstraction). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T21:49:45.960

就个人而言，我可能会按照您的方式保留结构。

第一个选项 (itm = itm == null ? itm.subItems() : emptyArray) 似乎没有其他选项那么讨厌，但我仍然更喜欢你的原版。

问题是，从另一个开发人员的角度来看，其他任何事情都会使您的代码不那么明显。如果有一个 foreach 贯穿一个集合，我希望该集合（至少通常）包含其中的项目。如果集合可能是空的，那么对于没有评论的其他人来说这不会是显而易见的（这比 if 检查需要更长的时间来编写）。

做任何技巧来避免 if 检查似乎你正试图太聪明。

# ruby-on-rails - 在运行时查找 ActiveRecord 类的关联？

> ID：644718
> 
> 赞同：8
> 
> 时间：2009-03-13T21:40:22.507
> 
> 标签：ruby-on-rails, ruby, activerecord, associations

我想在运行时找到 ActiveRecord 类的关联...

假设我有以下内容：

```
class Person < ActiveRecord::Base
  has_many :chairs
  has_many :pens
end

class Chair < ActiveRecord::Base
  belongs_to :person
end

class Pen < ActiveRecord::Base
  belongs_to :person
end 
```

我如何在运行时发现 Person “有很多”椅子和钢笔，反之亦然？我正在寻找一种可以返回字符串数组的方法（如果存在这样的方法）。IE

```
Person.has_many_assocations 
```

会返回：

```
["chairs", "pens"] 
```

和

```
Pen.belongs_to_associations 
```

会返回：

```
["person"] 
```

我错过了这样的方法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-13T21:49:33.933

我认为[ActiveRecord::Reflection](http://rails.rubyonrails.org/classes/ActiveRecord/Reflection/ClassMethods.html)类可能是您正在寻找的。从文档中：

```
 Account.reflect_on_all_associations             # returns an array of all associations
  Account.reflect_on_all_associations(:has_many)  # returns an array of all has_many associations 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T22:07:11.380

听起来在运行时做一件很愚蠢的事情。你到底想达到什么目的？我认为无论您的问题是什么，都有一个简单且更常用的解决方案。

如果必须，我会使用`TheModel.read_inheritable_attribute(:reflections)`.

# java - 是否有任何用于二进制文件解析的 Java 框架？

> ID：644737
> 
> 赞同：17
> 
> 时间：2009-03-13T21:45:43.630
> 
> 标签：java, parsing, file-io, binary-data

我的问题是，我想用一个用 JAVA 实现的通用解析器来解析不同类型的二进制文件。可能使用解析器读取的配置文件来描述文件格式，或者创建根据某种解析规则解析文件的 Java 类。

我在互联网上搜索了很多，但几乎没有找到关于这个主题的任何内容。

我发现的只是处理编译器生成器（Jay、Cojen 等）的东西，但我认为我不能用它们来生成解析二进制文件的东西。但在这个假设上我可能是错的。

是否有任何框架可以特别处理二进制文件的简单解析，或者任何人都可以给我一个提示，我可以如何使用解析器/编译器生成器来做到这一点？

**更新**：我正在寻找可以编写配置文件的东西

```
file:
  header: FIXED("MAGIC")
  body: content(10)

content:
  value1: BYTE
  value2: LONG
  value3: STRING(10) 
```

它会自动生成解析以“MAGIC”开头的文件，然后是十倍的内容包（它本身由一个字节、一个长字符串和一个 10 字节字符串组成）。

**Update2**：我找到了类似的东西，我正在寻找“[构造](http://construct.wikispaces.com/)”，但遗憾的是这是一个 Python 框架。也许这可以帮助某人了解我正在寻找的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-07-10T19:05:06.617

使用[Preon](https://github.com/wspringer/preon)：

```
public class File {

  @BoundString(match="MAGIC")
  private String header;

  @BoundList(size="10", type=Body.class)
  private List<Body> body;

  private static class Body {

    @Bound
    byte value1;

    @Bound
    long value2;

    @BoundString(size="10")
    String value3;

  }

} 
```

解码数据：

```
Codec<File> codec = Codecs.create(File.class);
File file = codecs.decode(codec, buffer); 
```

如果您遇到问题，请告诉我。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-12T09:01:39.247

试一试[_](http://preon.sourceforge.net/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T21:52:59.823

我使用 DataInputStream 读取二进制文件，并用 Java 编写规则。;) 二进制文件几乎可以有任何格式，因此对于如何读取它们没有一般规则。

框架并不总是让事情变得更简单。在您的情况下，描述文件比使用 DataInputStream 读取数据的代码长。

```
public static void parse(DataInput in) throws IOException {
//        file:
//          header: FIXED("MAGIC")
    String header = readAsString(in, 5);
    assert header.equals("MAGIC");
//          body: content(10)
// ?? not sure what this means
//        content:
    for(int i=0;i<10;i++) {
//          value1: BYTE
        byte value1 = in.readByte();
//          value2: LONG
        long value2 = in.readLong();
//          value3: STRING(10)
        String value3 = readAsString(in, 10);
    }
}

public static String readAsString(DataInput in, int len) throws IOException {
    byte[] bytes = new byte[len];
    in.readFully(bytes);
    return new String(bytes);
} 
```

如果你想要一个配置文件，你可以使用 Java 配置文件。[http://www.google.co.uk/search?q=java+configuration+file](http://www.google.co.uk/search?q=java+configuration+file)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T20:02:50.407

Google 的[协议缓冲区](http://code.google.com/apis/protocolbuffers/docs/overview.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-14T21:51:40.233

解析器组合库是一个选项。[JParsec](http://jparsec.codehaus.org/)工作正常，但它可能很慢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-11T09:59:15.907

我一直在为 Java 开发一个框架，它允许解析二进制数据[https://github.com/raydac/java-binary-block-parser](https://github.com/raydac/java-binary-block-parser) 在这种情况下你应该只用伪语言描述你的二进制文件的结构

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-14T09:19:23.137

您可以使用[JavaCC](https://javacc.dev.java.net/)等解析器解析二进制文件。[在这里](http://tomcopeland.blogs.com/juniordeveloper/2007/04/parsing_binary_.html)你可以找到一个简单的例子。可能它比解析文本文件要困难一些。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-14T03:14:20.940

您是否正在研究解析器的世界。一个好的解析器是[yacc](http://en.wikipedia.org/wiki/Yacc)，它可能有一个用于 java 的端口。

# php - 你能强制 symfony 解析到特定的路由吗？

> ID：644740
> 
> 赞同：2
> 
> 时间：2009-03-13T21:48:18.977
> 
> 标签：php, routing, symfony1

假设我必须按此顺序遵循 2 条路线：

```
Zip:
  url: home/:zip
  param: { module: home, action: results }

State:
  url: home/:state
  param: { module: home, action: results } 
```

我使用如下路线：

```
'@State?state=CA' 
```

为什么它会解析为 Zip 路由？我认为当您明确指定路由名称时：'@State' 它没有解析整个路由文件，而只是使用了您要求的特定路由。

我希望能够使用相同的操作来显示基于变量名称（zip 或 state）的数据我不想为了传入不同的参数而创建两次相同的操作（结果）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T22:01:06.170

您需要添加要求，以便它能够识别不同的格式

```
Zip:
  url: home/:zip
  param: { module: home, action: results }
  requirements: { zip: \d{5} } # assuming only 5 digit zips

State:
  url: home/:state
  param: { module: home, action: results }
  requirements: { state: [a-zA-Z]{2} } 
```

这应该可以解决它，尽管我同意你的观点，当你在帮助程序中使用路由名称时，它应该使用命名路由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T10:56:56.990

这里的问题是两个路由规则都解析为相同的 url (/home/)，并且在生成链接时，它使用正确的命名路由来生成 url。

当您单击生成的 url（例如 /home/CA）而不添加任何要求时，它将匹配 routing.yml 文件中匹配的第一个规则，即您的“Zip”路由。

只是为了解释正在发生的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T02:27:39.353

它**确实**使用了命名路由。问题是您的 URL 是相同的（参数名称无关紧要），因此当您在浏览器中加载 URL 时，第一个匹配的路由将始终是 Zip，因为 Symfony 无法知道您想要哪个。

添加`requirements:`是要走的路。

# .net - 防止浏览器在刷新时显示查询重新提交对话框

> ID：644742
> 
> 赞同：3
> 
> 时间：2009-03-13T21:48:32.673
> 
> 标签：.net, asp.net, design-patterns

当用户从下拉列表中选择一个项目并按下按钮时，我的应用程序会显示一个根据所选值手动绑定和过滤的数据列表。如果用户按下浏览器的刷新按钮，它会要求确认用户是否确定要再次提交查询。

我不希望浏览器问这个。我怎样才能避免这种行为？

据我了解，这可以通过实现 post/redirect/get 模式来完成，但我不知道如何在 ASP.NET 3.5 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T21:55:57.600

浏览器重新提交的所有 POST 请求都会与用户确认重新提交。您无法在浏览器中更改此行为。

PRG 模式对 asp.net 的意义在于您测试回发、执行处理并将用户重定向到不同的页面（或具有不同查询字符串的同一页面以更改该页面的行为）。

这种模式的问题是您失去了 asp.net 的所有回发功能，例如视图状态和自动表单处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T23:47:51.857

是的，在您的页面加载事件中，这样的事情会为您完成这项工作，例如：

```
// Check to see if the user submitted the form:
if (Page.IsPostBack){
  // Get the Params collection - query and forms
  NameValueCollection params = Request.Params;
  StringBuilder query = new StringBuilder();

  // Iterate over the params collection to build a complete
  // query string - you can skip this and just build it
  // manually if you don't have many elements to worry about
  for(int i = 0; i <= params.Count - 1; i++)
  {
    // If we're not on the first parameter, add an & seperator
    if (i > 0){
      query.Append("&");
    }

    // Start the query string 
    query.AppendFormat("{0}=", params.GetKey(i));

    // Create a string array that contains
    // the values associated with each key,
    // join them together with commas.
    query.Append(String.Join(",", pColl.GetValues(i));
  }

  Response.Redirect(String.Format("{0}?{1}", 
                      Request.Url.AbsolutePath, query.ToString()))
} 
```

这种模式的另一个问题是，您最终会在历史记录中得到这个额外的重定向，这可能导致用户必须点击两次才能返回您的搜索表单。

从好的方面来说，他们现在可以非常高兴地为结果页面添加书签并返回他们的结果，而无需重新提交表单。

# entity-framework - 使用 ObjectQuery Include 并使用嵌套的 where 子句

> ID：644743
> 
> 赞同：2
> 
> 时间：2009-03-13T21:48:52.390
> 
> 标签：entity-framework, nested

使用实体框架，我试图用订单详细信息找回客户，但我想过滤掉那些处于活动状态的订单。

Customer 是我们的 EntityObject，它有一个 Order EntityObjects 的集合。CustomerDetails 是我们的 ObjectContext。

下面的代码将附加所有订单，但我想过滤并仅附加那些处于活动状态的订单。（Order.active == true）。我怎样才能做到这一点？

我知道 Include 构建了一个嵌套查询语句（我可以通过使用 .ToTraceString() 来观察。）我希望将 Where 子句附加到这个嵌套的 select 语句或 Include 中。

```
 Customer cust;
        CustomerDetails custTable = new CustomerDetails();

        cust = custTable.Customer
            .Where("it.cust_id = " + id)
            .Include("Order")  // But we only want Order.active == true!!!
            .ToList().First(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T12:25:06.233

未经测试，但可能有效？

```
var temp = custTable.Customer.Where("it.cust_id = " + id).Include("Order");
cust = (from t in temp 
        where t.Order.active == true 
        select t).ToList().First(); 
```

# asp.net - Web应用程序中的Autofac，我应该将容器存储在哪里以便于访问？

> ID：644747
> 
> 赞同：14
> 
> 时间：2009-03-13T21:50:07.740
> 
> 标签：asp.net, dependency-injection, inversion-of-control, autofac

我对使用 Autofac 还是很陌生，我在文档和示例中错过的一件事是如何轻松地从 Web 应用程序的不同位置访问配置的容器。

我知道我可以使用 Autofac 控制器工厂来自动解析控制器的构造函数注入依赖项，但是您可能需要解决尚未注入的其他内容呢？

有没有我不知道的明显模式？

谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-07-20T16:16:41.007

Autofac“方式”是有一个`IContext`构造函数参数。Autofac 将注入一个可用于解析类型的对象。

上下文通常是幕后的容器，`IContainer`实现`IContext`接口，但`IContext`仅限于解析。

我知道容器不应该被“过度使用”，但是作为 OP，我有需要解析提前不知道的类型的类（因此不能用作构造函数参数）。我发现在这些情况下很有用，将容器视为可用于解析其他服务的另一个服务，并像任何其他服务一样注入它。

如果您觉得使用 IContext 会将您绑定到 Autofac，并且您需要使用自己的接口对其进行抽象，那么这只是在`IContext`您的容器中注册一个包装类的问题。

**更新：**在 Autofac 2 中，`IContext`被称为`IComponentContext`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-13T21:59:28.293

首先尽量不要过度使用 IoC 容器。它非常适合“连接”控制器、视图和服务，但是需要在运行时创建的对象应该由工厂对象而不是容器创建。否则，您将通过您的代码获得 Container.Resolve 调用，并将其绑定到您的容器。这些额外的依赖破坏了使用 IoC 的目的。在大多数情况下，我只需在应用程序的顶层解决一两个依赖项即可。然后 IoC 容器将递归地解决大多数依赖项。

当我在程序的其他地方需要容器时，这是我经常使用的一个技巧。

```
public class Container : IContainer
{
    readonly IWindsorContainer container;

    public Container()
    {
        // Initialize container
        container = new WindsorContainer(new XmlInterpreter(new FileResource("castle.xml")));

        // Register yourself
        container.Kernel.AddComponentInstance<IContainer>(this);
    }

    public T Resolve<T>()
    {
        return container.Resolve<T>();
    }
} 
```

我将容器包装在这样的 Container 类中。它将自己添加到构造函数中的包装容器中。现在，需要容器的类可以注入 IContainer。（该示例适用于温莎城堡，但它可能适用于 AutoFac）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-11-10T06:51:44.787

让 IOC 容器在全球范围内可用并不是最佳实践。甚至[不鼓励通过容器](http://code.google.com/p/autofac/wiki/BestPractices)。

如果无法使用依赖注入（您需要在创建组件后创建\请求对象），那么您可以：

1.  使用手工编码的工厂（工厂被注入到组件中，组件使用工厂创建其他对象）
2.  在 Autofac 2 中使用 Autofac[委托工厂](http://code.google.com/p/autofac/wiki/DelegateFactories)或[新的自动生成工厂](http://code.google.com/p/autofac/wiki/NewInV2)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-01T20:18:10.277

Peter Lillevold 上面的回答是正确的——您可以通过依赖 IContext 接口从任何组件访问容器。

如果您**确实**需要实际的容器引用，请参阅 Autofac.Integration.Web.IContainerProviderAccessor。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T21:52:29.107

执行此操作的常用方法是将容器存储在全局应用程序类的静态变量中。

# user-controls - DNN 5 - 无法从自定义模块中的嵌套用户控件中获取当前 ModuleId

> ID：644748
> 
> 赞同：7
> 
> 时间：2009-03-13T21:50:11.437
> 
> 标签：user-controls, dotnetnuke, dotnetnuke-module, dotnetnuke-5

我正在为 DNN 5 编写一个自定义模块，并且我需要在模块中的每个控件上都有一个“管理”链接。我创建了一个继承自 PortalModuleBase 的新用户控件（“ManagerLink”），将我的链接放入该控件，然后将该控件放在我的所有主要控件上。

问题是 ModuleId 和 TabId 在“ManagerLink”嵌套控件中始终为 -1。PortalId 工作得很好，我可以通过 PortalSettings.ActiveTab.TabID 得到一个 TabId。

1.  为什么我不能从“ManagerLink”控件中获取 ModuleId 和 TabId，即使它继承自 PortalModuleBase？

2.  是否有获取 ModuleId 的替代方法（等效于 PortalSettings.ActiveTab.TabID）

**2014 年更新：**

刚刚看到另一个比原来更好的答案（并接受了它）。

如果您使用的是 DNN 6 及更早版本，请替换`ModuleBase`为`PortalModuleBase`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T09:58:26.903

[DNN 论坛](http://www.dotnetnuke.com/Community/Forums/tabid/795/forumid/160/postid/294832/scope/posts/Default.aspx)的William Severance为我回答了这个问题，我也会在这里发布答案。

> **由于子控件继承自 PortalModuleBase，我将在父控件的 Page_Load 处理程序中执行以下操作**
> 
> 注意：ManagerLink 被假定为对子控件的引用
> 
> ### VB.NET：

```
With ManagerLink
    .ModuleConfiguration = Me.ModuleConfiguration
    .LocalResourceFile = Me.LocalResourceFile
End With 
```

C＃：

```
protected void Page_Load(System.Object sender, System.EventArgs e)
{
    ManagerLink.ModuleConfiguration = this.ModuleConfiguration;
    ManagerLink.LocalResourceFile = this.LocalResourceFile
} 
```

> 以上内容允许子控件使用父控件的 ModuleConfiguration（将包括 ModuleId）和 LocalResourceFile 进行任何本地化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-27T01:26:49.440

我只是想在这里添加我的 2 美分，使用@roman-m 的答案并对其进行扩展，

我能够像这样在嵌套控件本身中做到这一点：

```
//fires first in the sequence, calling initialise components
override protected void OnInit(EventArgs e)
{
    InitializeComponent();
    base.OnInit(e);
}

private void InitializeComponent()
{
    this.Load += new System.EventHandler(this.Page_Load);
    //this binds a handler to the parent's init event
    this.Parent.Init += new EventHandler(this.Parent_Init);
}
//the handler gets called, at this point we can cast the parent as a module base
//and load the configuration and resource file into the nested control
private void Parent_Init(object sender, System.EventArgs e)
{
    this.ModuleConfiguration = ((ModuleBase)this.Parent).ModuleConfiguration;
    this.LocalResourceFile = ((ModuleBase)this.Parent).LocalResourceFile;
} 
```

这意味着在`Page_Load`嵌套控件的情况下，它已经拥有配置和本地资源文件。

这也意味着您不必在每个使用子控件的父控件上加载配置和本地资源文件。

**当然，这仅在父级为 ModuleBase 类型时才有效**

更具体地说，这适用于版本 7.00.06

# apache-flex - AS3：扩展加载器，如何在其内容上绘制边框

> ID：644751
> 
> 赞同：1
> 
> 时间：2009-03-13T21:52:00.340
> 
> 标签：apache-flex, flash, actionscript-3

我正在扩展`Loader()`，是否可以在不使用一些技巧的情况下在内容周围绘制边框？我知道 Loader 不能有任何额外的孩子，否则我只会为内容大小创建一个形状并添加它。但是有没有办法强制或强制转换内容对象以便在其上使用绘图 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-14T01:37:45.803

通常，您只需在加载时将内容添加到显示对象并根据需要对其进行操作：

```
var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, eventCompleteHandler);
loader.load(new URLRequest(URL));

function eventCompleteHandler(event:Event):void
{
    addChild(createElementWithBorder(event.target.content));
}

function createElementWithBorder(content:DisplayObject):DisplayObject
{
    var container:Sprite = new Sprite();

    container.addChild(content);

    var border:Shape = container.addChild(new Shape()) as Shape;
    border.graphics.lineStyle(2,0x000000);
    border.graphics.drawRect(0, 0, content.width,content.height);

   return container;
} 
```

...但是如果您仍然对不能将 Loader 用作 DisplayObjectContainer 感到恼火，那么使用合成可能是线索（以下只是一个简单的示例，当然需要适应）：

```
public class LoaderBorder extends Sprite
{

    private var loader:Loader;

    public function LoaderBorder()
    {
        loader = new Loader()
    }

    public function load(url:String):void
    {
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, eventCompleteHandler);
        loader.load(new URLRequest(url));
    }

    private function eventCompleteHandler(event:Event):void
    {
        loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, eventCompleteHandler);

        var content:DisplayObject = event.target.content;

        var border:Shape = new Shape();
        border.graphics.lineStyle(2,0x000000);
        border.graphics.drawRect(0, 0, content.width,content.height);

        addChild(content);
        addChild(border);

    }
} 
```

像 Loader 一样使用：

```
var test:LoaderBorder = new LoaderBorder()
addChild(test);
test.load(URL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T23:12:56.947

是的，您可以 CAST 加载程序的内容。当您加载图像时，您可以这样做（在图像完全加载后）：

```
Bitmap(yourLoader.content); 
```

使用 SWF，我假设您可以做到这一点（尚未测试）：

```
Sprite(yourLoader.content); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-28T08:54:53.150

您可以将过滤器添加到包含加载器的movieClip。

我认为“发光”或“阴影”可能是一个很好的效果。如果你设置正确。

# vb.net - 使网站/项目可移植

> ID：644765
> 
> 赞同：0
> 
> 时间：2009-03-13T21:55:24.357
> 
> 标签：vb.net, asp.net-ajax, portability, custom-server-controls, portable-database

晚上好/早上/之后/中午。

我有一个 ASP.net 3.5 网站，我在 VWD 2008 Express 中使用 vb.net，我也在使用 MS SQL Server 2008 Express，我使用了 ajax 选项卡和由[http://www.4guysfromrolla 开发的文本框字符计数器控件。 com/](http://www.4guysfromrolla.com/) 数据库与 MS SQL Server Management Studio Express 相连，文件存储在 SQL 默认的“Data”文件夹中。

整个项目的代码和表格都存放在我E盘的一个文件夹中。我需要将整个项目交给另一个必须完成的同事，请按步骤描述我如何使我的网站可移植（就像我可以把它全部放在一个文件夹中，他可以在他的闪存盘中随身携带）。

**PS**：我在尝试将项目从一台服务器移动到另一台服务器时遇到问题，pproject 似乎在寻找 AJAX 控件的 dll 和我最初解压缩它们所在的文件夹的文本框计数器，我认为在我的桌面上，虽然当我将这些控件添加到工具选项卡时，我创建了一个新选项卡，然后我从解压缩控件源代码的地方选择 dll，这还不够吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T23:44:34.157

创建结构时，为源树中的引用文件创建一个文件夹。然后，您可以从那里参考。如果你这样做，整个树是可移植的。从 environ 到 environ 的唯一变化是配置元素。而且，如果在本地系统上，你使用 SQL Express 并放入 App_Data 文件夹，它可以连接到你的同事系统，只要他也有 SQL Express。

# python - 从 mod_python 转换为 mod_wsgi

> ID：644767
> 
> 赞同：11
> 
> 时间：2009-03-13T21:56:15.277
> 
> 标签：python, mod-wsgi, mod-python

我的网站是用 Python 编写的，目前在带有 Apache 的 mod_python 下运行。最近我不得不进行一些丑陋的黑客攻击，这让我认为将站点转换为 mod_wsgi 可能是值得的。但是我已经习惯了使用 mod_python 的一些实用程序类，尤其是`FieldStorage`and `Session`（有时是`Cookie`），并且从[PEP 333](http://www.python.org/dev/peps/pep-0333/)的扫描中，我看不到这些的任何等价物。（不足为奇，因为我知道这些实用程序不属于 WSGI 规范）

问题是，我可以在 WSGI 中使用这些 mod_python 实用程序类的“标准”（即普遍接受的）替代品，或者我可以/应该自己编写吗？

（仅供参考：目前使用 Python 2.5）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T22:00:40.117

看看[Werkzeug](http://werkzeug.pocoo.org/)。您可能需要进行一些重写。您可能会对将 WSGI 世界观强加于您的应用程序的结果感到满意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-24T11:54:13.400

您可以在“cgi”模块和“Cookie”模块中使用 FieldStorage。Python 标准库中没有与 Session 等价的东西。对于 WSGI 应用程序，您可以使用[Beaker](http://beaker.groovie.org/)进行会话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T02:29:55.463

请看一下 [whiff——](http://aaron.oirt.rutgers.edu/myapp/docs/W.intro)它提供了内置功能，用于将字段数据和会话等操作到基于 wsgi 的应用程序中。

# powershell - Powershell 2 中的结构或对象

> ID：644772
> 
> 赞同：9
> 
> 时间：2009-03-13T21:59:57.200
> 
> 标签：powershell, powershell-2.0, tuples

最新版本的 Powershell 是否有能力做类似 JavaScript 的事情：

```
var point = new Object();
point.x = 12;
point.y = 50; 
```

如果不是，等效或解决方法是什么？

**更新**
阅读所有评论

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T22:20:56.213

通过 add-member cmdlet 的功能不直接支持语法。不久前，我将此功能包装在一个通用的元组函数中。

这将使您能够在一行中创建这些对象。

```
$point = New-Tuple "x",12,"y",50 
```

这是新元组的代码

```
function New-Tuple()
{
    param ( [object[]]$list= $(throw "Please specify the list of names and values") )

    $tuple = new-object psobject
    for ( $i= 0 ; $i -lt $list.Length; $i = $i+2)
    {
        $name = [string]($list[$i])
        $value = $list[$i+1]
        $tuple | add-member NoteProperty $name $value
    }

    return $tuple
} 
```

关于该主题的博客文章：http: [//blogs.msdn.com/jaredpar/archive/2007/11/29/tuples-in-powershell.aspx#comments](http://blogs.msdn.com/jaredpar/archive/2007/11/29/tuples-in-powershell.aspx#comments)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-12T04:31:14.980

对于简单的方法，首先是一个哈希表（在 V1 中可用）

```
$obj = @{}
$obj.x = 1
$obj.y = 2 
```

其次，是一个 PSObject（在 V2 中更容易）

```
$obj = new-object psobject -property @{x = 1; y =2} 
```

它为您提供大致相同的对象，但如果您想对它们进行排序/分组/格式化/导出，psobjects 会更好

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T13:50:02.200

抱歉，即使选择的答案很好，我也无法抗拒 hacky 的一行答案：

```
New-Object PsObject | Select-Object x,y | %{$_.x = 12; $_.y = 50; $foo = $_; } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-14T02:12:30.370

你可以这样做：

```
$point = New-Object Object |
    Add-Member NoteProperty x ([int] 12) -passThru |
    Add-Member NoteProperty y ([int] 15) -passThru 
```

关于您在其他地方的评论之一，自定义对象可能比哈希表更有用，因为它们与期望对象具有命名属性的 cmdlet 一起工作得更好。例如：

```
$mypoints | Sort-Object y   # mypoints sorted by y-value 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-14T20:21:31.993

如何在 PowerShell 中创建对象
[http://blogs.msdn.com/powershell/archive/2009/03/11/how-to-create-an-object-in-powershell.aspx](http://blogs.msdn.com/powershell/archive/2009/03/11/how-to-create-an-object-in-powershell.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-13T11:37:05.747

```
$point = "" | Select @{Name='x'; Expression={12}} ,@{Name='y'; Expression={15}} 
```

或更直观地

```
$point = "" | Select x,y
$point.x=12; $point.y=15 
```

# iphone - 这会导致 EXC_BAD_ACCESS 吗？

> ID：644780
> 
> 赞同：0
> 
> 时间：2009-03-13T22:02:29.317
> 
> 标签：iphone, cocoa-touch, uiwebview

离开下面的方法后，我得到了 EXC_BAD _ACCESS。此时 htmlDocument 变得无效，因为它超出了范围，所以应该这样做。但这就是我收到错误的原因吗？当 contentView (UIWebView) 加载时，htmlDocument 已经消失了。但是 contentView 不是已经从 loadHTMLString 获得了它需要的东西吗？

```
- (void)viewDidLoad {
[super viewDidLoad];
//something other processing here

NSString *htmlDocument = [NSString stringWithFormat:@"<html> \n"
"<body>%@</body> \n"
"</html>", aboutContent];
[contentView loadHTMLString:htmlDocument baseURL:[NSURL URLWithString:@"http://www.abc.com"]]; 
```

}

有没有更好的方法来遵循这一点直到失败？离开这个方法是我的代码行的结尾。SDK的东西从那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T09:51:07.477

从您的第二篇文章中，您注释掉的行（[按钮释放]）释放了一个已标记为自动释放的对象。

删除您正在为按钮执行分配的“自动释放”或删除 [按钮释放] 语句以使代码编译没有错误和异常。

如果一个对象被标记为自动释放，则在其上调用释放将与在已释放实例上调用释放相同，因此会出现错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T23:20:13.187

乍一看，我会说这段代码没有任何问题，假设“aboutContent”是一个指向对象的有效指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T01:28:28.243

您可以尝试在模拟器上使用 Guard Malloc 运行您的应用程序，但这并不能保证会出现任何结果。我建议您开始注释语句，直到找到导致错误的语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T05:32:20.717

在没有更多上下文的情况下，尚不清楚您刚刚提供的代码片段发生了什么。也就是说，看起来您想要做的只是在设备中本地加载一些 HTML。为什么不这样做呢？

```
- (void)viewDidLoad {
    [webView loadRequest:[NSURLRequest 
                          requestWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] 
                                                pathForResource:@"help/about.html"
                                                ofType:@"html"]isDirectory:NO]]];
} 
```

使用这种技术，您可以直接在手机中编写基于 HTML 的文档，而无需用户意识到他们实际上正在查看 Web 视图这一事实：这包括 Javascript、CSS 和整个蜡球。我已经看到人们实际上将他们的 iPhone 应用程序放到 Internet 上只是为了在 Internet 上呈现一个静态页面，这实际上是没有必要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-14T07:20:33.517

从您在第二篇文章中的示例代码中，您发布的按钮`UIBarButtonItem *button`不会被您注释掉的发布后的任何内容保留 - 因此它被解除分配。

您需要将按钮添加到另一个视图（使用`adSubview`）以使其显示，*然后*您可以释放它。父视图将保留该按钮。

当然，如果您要再次引用该按钮，您的视图控制器应该在其 dealloc 中保留并释放该按钮。

# bluetooth - 我如何知道我的手机中安装了哪些蓝牙堆栈以及它们如何工作？

> ID：644781
> 
> 赞同：0
> 
> 时间：2009-03-13T22:03:26.910
> 
> 标签：bluetooth

我想通过蓝牙向任何手机发送几乎 4k 大小的数据。

首先要做到这一点，我需要找到我的手机中有哪些堆栈，以及当我发送数据时哪些堆栈在起作用。

我真的很难找到路；但是，这真的很难。

如果您知道如何找到它，请给我一些信息！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T12:24:15.153

如果您正在谈论 Windows Mobile，请参阅[http://32feet.NET 。](http://32feet.NET)它是蓝牙、OBEX 和 IrDA 的托管库。我们既支持 Microsoft 堆栈，也支持 Widcomm。现在还有 Bluesoleil 和 Stonestreet One Bluetopia。

您可以通过 OBEX 消息或通过简单的蓝牙连接发送和接收数据。[请参阅http://www.alanjmcf.me.uk/comms/bluetooth/32feet.NET%20](http://www.alanjmcf.me.uk/comms/bluetooth/32feet.NET%20) —%20User's%20Guide.html上的用户指南副本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T18:30:16.173

转到“ [https://www.bluetooth.org/tpg/listings.cfm](https://www.bluetooth.org/tpg/listings.cfm) ”输入您的手机名称。这将为您提供有关内部蓝牙堆栈和支持的配置文件的信息。

# c# - 是否可以在 C# 控制台应用程序中获得版权符号？

> ID：644785
> 
> 赞同：21
> 
> 时间：2009-03-13T22:04:15.817
> 
> 标签：c#, console

是否可以在 C# 控制台应用程序中以任何方式添加版权符号或其他“特殊”符号？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-13T22:08:25.027

```
namespace test {
  class test {
    public static void Main() {
      System.Console.WriteLine("©");
    }
  }
} 
```

完美地为我工作。无论控制台窗口设置为光栅字体还是 Unicode。

如果要输出 Unicode，应将控制台输出编码设置为 UTF-8 或 Unicode。

```
System.Console.OutputEncoding = System.Text.Encoding.UTF8; 
```

或者

```
System.Console.OutputEncoding = System.Text.Encoding.Unicode; 
```

如果您想清楚源代码编码问题，您应该直接指定字符代码点：

```
System.Console.WriteLine("\u00a9"); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-13T22:08:25.060

如果您愿意，可以从这里复制：

©

（您可以按住 ALT，然后键入 0169，然后松开 ALT 键）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T22:10:53.977

按住 ALT 并输入 0169 以获得版权符号怎么样。

```
 static void Main(string[] args)
    {
        Console.Write("©");
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-13T15:55:27.113

您可以获得的最佳版权符号：

```
Console.WriteLine("(c)"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T22:10:42.480

```
Console.WriteLine("©"); 
```

为我工作...

或者它不是你想要的输出？

# tfs - 获取应用于 TFS 源代码控制中项目的特定版本的标签

> ID：644786
> 
> 赞同：2
> 
> 时间：2009-03-13T22:04:48.063
> 
> 标签：tfs, labels

我正在尝试获取适用于 TFS 源代码控制中特定文件的特定版本的标签列表。到目前为止，我已经获得了一组适用于特定文件的任何版本的标签。有没有人有为特定项目获取标签的经验？

例如，我有 $/Project/Folder/Item.cs，它在变更集 301、401 和 601 中进行了修改。该项目存在标签 Build1 - Build 99。Build1 - Build10 在变更集 301 之前应用（即在创建 Item.cs 之前）。Build96 - Build99 应用于 Item.cs 的 v601。如果我跑

```
vcServer.QueryLabels(null, "$/Project", null, false, "$/Project/Folder/Item.cs", new ChangesetVersionSpec(6)) 
```

我得到 Build11 - Build99 作为结果。我还没有弄清楚如何让查询返回少于这么多标签。理想情况下，我运行的查询将返回 4 个标签（Build96 - Build 99）。

这个问题的上下文是一个 TFS 项目，使用 CCNET 作为构建服务器。我正在尝试将工作项与构建相关联，从工作项编号开始。

有小费吗？或者 QueryLabels 的例子？或者 QueryLabels 的文档比[MSDN 文档](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.versioncontrolserver.querylabels(VS.80).aspx)更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-30T22:19:09.740

这是可能的，请参见此处：[http ://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/9f41f37e-4fda-4b56-91a3-f2b7e0c0e22d](http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/9f41f37e-4fda-4b56-91a3-f2b7e0c0e22d)

基本上，一旦您取回标签列表，您就必须查看每个标签并查看您感兴趣的项目的哪些变更集适用于它。请务必将“includeItems = false”标志传递给 QueryLabels，否则您将不得不查看标签上的每个项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T10:32:55.997

使用 API 绝对可以实现您想要做的事情。我对另一个问题给出的答案是关于在 UI 中查看与历史记录一致的标签。

有关做我认为您想做的事情的更多信息，请查看：

*   [Buck Hodges：在 TFS 版本控制中查找两个标签之间的变化](http://blogs.msdn.com/b/buckh/archive/2006/08/28/diff-between-labels.aspx)

并且

*   [Manish Agarwal：什么是 GenCheckinNotesUpdateWorkitem 任务？](http://blogs.msdn.com/manishagarwal/archive/2006/01/25/517282.aspx)

希望有帮助。

马丁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T23:26:02.360

当前的 TFS 版本似乎[不可能](https://stackoverflow.com/questions/153928/can-i-see-tfs-file-history-with-labels)，但下一个版本可能会。

# tsql - 内部事务范围错误：“与底层事务管理器的通信失败”

> ID：644787
> 
> 赞同：0
> 
> 时间：2009-03-13T22:05:04.333
> 
> 标签：tsql, .net-3.5, transactionscope

我不确定我是否正确地执行了这些操作。是因为我打开了两个连接吗？无论错误如何，我都会关闭它们。我确实尝试放入一些内部事务范围并将第二个设置为`RequiresNew`. 这两种方法彼此独立，但是，如果一种方法失败，我需要它们都回滚。我觉得我可能需要修改创建和关闭连接的方式。有什么想法吗？这是我正在做的一些示例代码：

```
Public Sub TransMethod()
    Using sTran As New Transactions.TransactionScope
        factory1.UpdateMethod(someObject1)
        facotry2.insert(someobject2)
        sTran.Complete()
    End Using
End Sub

Public Class factory1
    Public Shared Sub UpdateMethod(obj)
        dim someSQLParams....
        DataAcces.ExecuteNonQuery(command,someSQLParams)
    End Sub
End Class

Public Class factory2
    Public Shared Sub Insert(obj)
        dim someSQLParams....
        DataAcces.ExecuteNonQuery(command,someSQLParams)
    End Sub
End Class

Public Function ExecuteNonQuery(ByVal spname As String, _
        ByVal ParamArray parameterValues() As Object) As Object
    Dim connection As SqlConnection = Nothing            
    Dim command As SqlCommand = Nothing
    Dim res As Object = Nothing
    Try
        connection = New SqlConnection(_connectionString)
        command = New SqlCommand(spname, connection)
        command.CommandType = CommandType.StoredProcedure
        command.Parameters.AddRange(parameterValues)
        connection.Open()
        command.ExecuteNonQuery()
        res = command.Parameters(command.Parameters.Count - 1).Value
    Catch ex As Exception
        CreateDataEntry(ex, WriteType.ToFile, spname)
        If Not (transaction Is Nothing) Then
            transaction.Rollback()
        End If
    Finally
        If Not (connection Is Nothing) AndAlso _
            (connection.State = ConnectionState.Open) Then _
                connection.Close()
        If Not (command Is Nothing) Then command.Dispose()
    End Try
    Return res
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T22:13:35.717

每当您使用 TransactionScope 打开多个连接时，它都会从针对 sql server 的普通事务变为分布式事务，这需要设置 MSDTC。

即使连接具有相同的连接字符串也会发生这种情况，这是“设计”问题之一。如果在 .net 3.5+ 上保持不变，我还没有跟进

# wpf - System.Windows.Forms.Integration 命名空间在哪里？

> ID：644789
> 
> 赞同：34
> 
> 时间：2009-03-13T22:05:41.103
> 
> 标签：wpf, winforms, interop

我似乎找不到它，试图以从 winforms 表单生成的 wpf 表单进行键盘输入。发现这个：[http](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/442782b1-00a1-4e2e-9cc6-ae99b6699126/) ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/442782b1-00a1-4e2e-9cc6-ae99b6699126/但是当我尝试使用它时，VS2008 抱怨无法使用找到 System.Windows.Forms.Integration 命名空间。我在添加引用中找不到引用。

我唯一能想到的可能是因为它是一个移植到 VS2008 的 VS2005 项目？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-03-13T22:10:33.913

您需要添加对 WindowsFormsIntegration 的引用。如果您在 Visual Studio 中添加引用，它将位于 .Net 选项卡中最后一个可用的 DLL 附近

在我的机器上，它位于

> %ProgramFiles%\Reference Assemblies\Microsoft\Framework\v3.0\WindowsFormsIntegration.dll

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-28T18:24:44.843

Visual Studio 根据您选择的项目类型筛选可用的命名空间。如果您需要未列出的命名空间，请单击项目属性的引用选项卡上的 [添加...] 按钮。这将弹出参考管理器窗口。从左侧面板的程序集列表中选择“框架”。这将显示 Microsoft 提供的所有命名空间。您将在那里找到 WindowsFormsIntegration。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-11T13:38:04.163

刚遇到同样的问题。

虽然添加对的引用`WindowsFormsIntegration.dll`不起作用，因为其中没有 WF 控件，但我确实发现添加对的引用`System.Windows.Forms`工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-19T20:16:59.760

# 使用较新的：

```
%ProgramFiles(x86)%\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\WindowsFormsIntegration.dll 
```

# apache-flex - 如何向 adobe air 安装程序添加其他文件？

> ID：644799
> 
> 赞同：1
> 
> 时间：2009-03-13T22:10:58.547
> 
> 标签：apache-flex, installation, air, flexbuilder

我创建了一个 AIR 应用程序，但它使用外部 SWF 来提供额外的功能。我希望该 SWF 包含在安装中，但目前还没有。无论如何，我可以让 FlexBuilder 或任何其他工具在安装程序中包含这个额外的文件吗？我尝试手动添加文件（因为 .air 文件只是伪装的 zip 文件），但文件内必须有哈希检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T22:18:42.833

如果您将 SWF 文件放在应用程序的**src**目录中，它将为您提供包含在安装程序中的选项（之前我尝试将其放在应用程序的根文件夹中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-04T18:34:54.967

如果您在 Flash 中工作，请转至文件>Adobe AIR 2.0 设置。对话框底部是包含文件的列表。将您的 SWF 添加到该列表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-28T11:33:19.720

如果您想使用 Flex Builder 将文本文件添加到安装程序中怎么办？我尝试使用导出发布构建向导添加它，但我没有看到应用程序目录中生成的文本文件......有什么想法吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-09T12:51:35.370

我会在项目 -> 属性 -> 构建器下添加一个自定义构建器

我对我想要打包一些 mxml 并作为文件的项目之一使用以下类似的东西，以便编译器不会尝试在导出时编译它们。将下面的 xml 保存为类似 copy_files.xml 的内容，并将新的 Ant Builder 添加到您的项目中。在构建器的目标选项卡下，我将我的设置为在每次清理时运行复制文件目标。

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="SampleProject">
    <target name="copy-files" description="Copy Source Files">
            <copy todir="bin-debug/sources">
                <fileset dir="sources" >
                    <include name="**/*.*" />
                </fileset>
            </copy>
            <copy todir="bin-release/sources">
                <fileset dir="sources" >
                    <include name="**/*.*" />
                </fileset>
            </copy>
    </target>
</project> 
```

# django - 使用 ModelForm 并传递参数

> ID：644802
> 
> 赞同：0
> 
> 时间：2009-03-13T22:13:22.207
> 
> 标签：django, django-models, django-forms

```
class MyUserAdminForm(forms.ModelForm):
class Meta:
    model = Users

group = forms.ModelMultipleChoiceField(
    queryset=Groups.objects.filter(domain__user=3),
    widget=forms.CheckboxSelectMultiple,
)

class UserAdmin(admin.ModelAdmin):

list_display = ('login', 'company', 'userType')
form = MyUserAdminForm
filter_horizontal = ('group',)

admin.site.register(Users, UserAdmin) 
```

我正在使用 MyUserAdminForm 来自定义管理界面。我必须将 User 表的 pk 作为参数传递给过滤器

```
queryset=Groups.objects.filter(domain__user=3) 
```

我应该传递用户表的 pk 而不是硬编码的“3”。想知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T14:46:16.777

正在编辑的对象在参数中提供给表单的构造`instance`函数。您应该能够使用它来过滤组选择：

```
class MyUserAdminForm(forms.ModelForm):
    class Meta:
        model = Users

    group = forms.ModelMultipleChoiceField(
            queryset=Groups.objects.all(),
            widget=forms.CheckboxSelectMultiple,
    )

    def __init__(self, *args, **kwargs):
        super(MyUserAdminForm, self).__init__(*args, **kwargs)
        if kwargs.has_key('instance'):
            qs = Group.objects.filter(domain__user=kwargs['instance'].pk)
            self.fields['group'].queryset = qs 
```

# javascript - 在滚动时停止 Effect.ScrollTo()？

> ID：644805
> 
> 赞同：1
> 
> 时间：2009-03-13T22:14:13.017
> 
> 标签：javascript, prototypejs, scriptaculous

是的，基本上我有这个：

```
Effect.ScrollTo("bottom", { duration: 5.0 }); 
```

所以我想要的是在我想滚动的时候停止这种效果。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:24:23.617

```
var scrollEffect = Effect.ScrollTo("bottom", { duration: 5.0 });

...

scrollEffect.cancel(); 
```

下面的代码非常适合我：

```
<html>
<head>
    <script src="js/prototype.js" type="text/javascript"></script>
    <script src="js/scriptaculous.js" type="text/javascript"></script>

    <style type="text/css" media="screen">
        body { font-size: 30px; }
        #destination { margin-top: 1400px; }
        #start { position: fixed; top: 10px; left: 20px;}
        #stop { position: fixed; top: 50px; left: 20px;}
    </style>

    <script type="text/javascript" charset="utf-8">
        function startEffect() {
            scrollEffect = Effect.ScrollTo("destination", { duration: 8.0 }); return false;
        }

        function stopEffect() {
            scrollEffect.cancel(); return false;
        }
    </script>
</head>
<body>
    <a id="start" href="#" onclick="return startEffect();">Start Effect</a>
    <a id="stop" href="#" onclick="return stopEffect();">Stop Effect</a>
    <p id="destination">Scroll Destination</p>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T04:47:45.177

我目前正在工作的是有一个 div 如下：

```
<div id="pausepos" style="position:absolute;"></div> 
```

然后让 JavaScript 取消滚动并将其移回原始位置：

```
 fallingPosTempArr = $("thetop").viewportOffset();
    fallingPosTemp = -1*fallingPosTempArr[1];

    $("pausepos").setStyle({
        "top" : fallingPosTemp + 'px'
    });

    scrollEffect.cancel();

    setTimeout(function () { Effect.ScrollTo("pausepos", { duration: 0.0 }); }, 10); 
```

它可以工作，但在速度较慢的浏览器上，您可以看到页面如何跳回顶部然后再返回。

# python - Matplotlib 的 GUI 不允许在保存框中输入？

> ID：644812
> 
> 赞同：4
> 
> 时间：2009-03-13T22:18:35.207
> 
> 标签：python, matplotlib

我在 python 中使用 matplotlib 已经有一段时间了，我终于开始就我的 mac 上的一个问题提出这个问题。当一个图出现时（在`plot()`命令、`draw()`或之后`show()`），我拥有了我想要的所有功能；我可以移动、缩放等我在代码中没有做的事情。

当我根据需要保存带有视图的图形时，将打开另存为框并提示输入文件名。我输入的任何内容都会出现在我用来执行命令的终端中！选择 X11，然后键入具有相同的结果。似乎没有任何东西可以将键盘输出放入该框中，但是我可以使用鼠标->粘贴操作将其粘贴到该框中，并且可以在菜单中选择要覆盖的文件，并且效果很好。

这是怎么回事？

## 更新：

这个问题被很好地概述了，现在[在这篇文章中发布了一些解决方案：为什么保存按钮在 matplotlib 图上不起作用？](https://stackoverflow.com/questions/3692928/why-doesnt-the-save-button-work-on-a-matplotlib-plot)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-08T00:47:12.850

刚刚在 Snow Leopard 上的 Python 2.6.2 上安装了 matplotlib 0.99.1 并运行了以下代码：

```
from pylab import *
plot([1,2,3])
show() 
```

然后，我摆弄了一会儿情节，然后单击了保存按钮。保存对话框正常弹出并允许我保存（和输入）正常。这是使用 TkAgg 后端。但是，我确实收到了这个错误：

```
2009-12-08 00:40:18.772 Python[728:60f] -deltaZ is deprecated for NSEventTypeMagnify.  Please use -magnification. 
```

这似乎与 Snow Leopard 更改了一些 API 有关。

很抱歉将其用作帖子而不是评论，但评论中不允许使用代码标签:(

# java - Hibernate EntityManager 是否包含核心？

> ID：644814
> 
> 赞同：2
> 
> 时间：2009-03-13T22:18:53.257
> 
> 标签：java, hibernate

我正在使用 Hibernate 的 JPA 实现。我的 Maven`pom.xml`参考资料`hibernate-entitymanager`。我的问题是，Hibernate EntityManager（在 Hibernate 的主页上称为“Java SE 和 Java EE 的标准 Java Persistence API”）是否依赖或使用 Hibernate Core 代码？

我[发现了一个](https://stackoverflow.com/questions/467282/jpa-hibernate-maximum-number-of-joins)在 Hibernate Core中[记录和修复的 Hibernate 错误。](http://opensource.atlassian.com/projects/hibernate/browse/HHH-3636)我想知道 EntityManager 是否使用 Core 并因此有此修复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T22:51:17.420

它不包括，但取决于 Hibernate Core。查看 MVN Repository 的[详细信息页面](http://www.mvnrepository.com/artifact/org.hibernate/hibernate-entitymanager/3.4.0.GA)以查看 Hibernate EntityManager 的依赖项列表。

请注意，您可以使用[Maven 依赖项插件](http://maven.apache.org/plugins/maven-dependency-plugin/)来显示为您的 POM 解析的依赖项的详细分析。

# constructor - 定义 StructureMap 配置文件时如何配置构造函数参数

> ID：644817
> 
> 赞同：4
> 
> 时间：2009-03-13T22:19:42.287
> 
> 标签：constructor, structuremap, profile

在为默认实例需要 ctor 参数的类型定义绑定时，如何做到这一点非常清楚。但是，当我想创建替代配置文件时，它会变得更加困难。

这是为默认实例完成的方式：

```
ForRequestedType(typeof (IRepository<>))
    .TheDefaultIsConcreteType(typeof (SpRepository<>))
    .CtorDependency<Uri>("sourceWeb")
    .Is(new Uri("http://localhost")); 
```

这是我坚持个人资料的地方：

```
CreateProfile("wss")
    .For(typeof(IRepository<>))
    .UseConcreteType(typeof(SpRepository<>))
    // I'd expect to be able to insert this here...
    //.CtorDependency<Uri>("sourceWeb")
    .Is(new Uri("http://localhost"))) 
```

如何设置此配置文件的类型映射？

我是否被迫使用实例绑定（我可以将默认值传递给 ctor 参数）？

# python - Python：如何为子目录中的所有源文件运行 unittest.main()？

> ID：644821
> 
> 赞同：66
> 
> 时间：2009-03-13T22:20:31.050
> 
> 标签：python, unit-testing

我正在开发一个带有多个源文件的 Python 模块，每个源文件都有自己的测试类，这些测试类是从源代码中的[unittest](http://docs.python.org/library/unittest.html)派生的。考虑目录结构：

```
dirFoo\
    test.py
    dirBar\
        __init__.py
        Foo.py
        Bar.py 
```

要测试 Foo.py 或 Bar.py，我将在 Foo.py 和 Bar.py 源文件的末尾添加：

```
if __name__ == "__main__":
    unittest.main() 
```

并在任一源上运行 Python，即

```
$ python Foo.py
...........
----------------------------------------------------------------------
Ran 11 tests in 2.314s

OK 
```

理想情况下，我会让“test.py”自动在 dirBar 中搜索任何 unittest 派生类，然后调用“unittest.main()”。在实践中做到这一点的最佳方法是什么？

我尝试使用 Python 为 dirBar 中的每个 *.py 文件调用[execfile](http://docs.python.org/library/functions.html#execfile)，该文件为找到的第一个 .py 文件运行一次并退出调用 test.py，然后我必须通过添加 unittest.main() 来复制我的代码每个源文件——这违反了 DRY 原则。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-02-23T05:12:03.910

从 Python 2.7 开始，测试发现在 unittest 包中是自动化的。从[文档](http://docs.python.org/library/unittest.html)：

> Unittest 支持简单的测试发现。为了与测试发现兼容，所有测试文件必须是可从项目顶级目录导入的模块或包（这意味着它们的文件名必须是有效的标识符）。
> 
> 测试发现在 中实现`TestLoader.discover()`，但也可以从命令行使用。基本的命令行用法是：
> 
> ```
> cd project_directory
> python -m unittest discover 
> ```

默认情况下，它会查找名为 的包`test*.py`，但这可以更改，因此您可以使用类似

```
python -m unittest discover --pattern=*.py 
```

代替您的 test.py 脚本。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-11-23T17:02:19.047

这是我的测试发现代码，似乎可以完成这项工作。我想确保我可以轻松地扩展测试，而不必在任何涉及的文件中列出它们，但也避免将所有测试都写在一个 Übertest 文件中。

所以结构是

```
myTests.py
testDir\
    __init__.py
    testA.py
    testB.py 
```

myTest.py 看起来像这样：

```
import unittest

if __name__ == '__main__':
    testsuite = unittest.TestLoader().discover('.')
    unittest.TextTestRunner(verbosity=1).run(testsuite) 
```

我相信这是在一个目录中编写多个测试用例的最简单的解决方案。该解决方案需要 Python 2.7 或 Python 3。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-03-13T22:29:58.347

我知道有一个明显的解决方案：

```
dirFoo\
    __init__.py
    test.py
    dirBar\
        __init__.py
        Foo.py
        Bar.py 
```

dirFoo/test.py 的内容

```
from dirBar import *
import unittest

if __name__ == "__main__":

    unittest.main() 
```

运行测试：

```
$ python test.py
...........
----------------------------------------------------------------------
Ran 11 tests in 2.305s

OK 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-13T23:35:04.477

你应该试试[鼻子](http://nose.readthedocs.io/en/latest/)。它是一个帮助创建测试的库，它与`unittest`or集成`doctest`。您需要做的就是运行`nosetests`，它会为您找到所有单元测试。

```
% nosetests # finds all tests in all subdirectories
% nosetests tests/ # find all tests in the tests directory 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-12-24T01:36:41.940

如果它碰巧可以帮助任何人，这是我解决这个问题的方法。我有一个用例，我有以下目录结构：

```
mypackage/
    tests/
        test_category_1/
            tests_1a.py
            tests_1b.py
            ...
        test_category_2/
            tests_2a.py
            tests_2b.py
            ...
        ... 
```

我希望以下所有内容都能以明显的方式工作，并且能够提供与 unittest 接受的相同的命令行参数：

```
python -m mypackage.tests
python -m mypackage.tests.test_category_1
python -m mypackage.tests.test_category_1.tests_1a 
```

解决方案是这样设置`mypackage/tests/__init__.py`：

```
import unittest

def prepare_load_tests_function (the__path__):
    test_suite = unittest.TestLoader().discover(the__path__[0])
    def load_tests (_a, _b, _c):
        return test_suite
    return load_tests 
```

并`mypackage/tests/__main__.py`像这样设置：

```
import unittest
from . import prepare_load_tests_function, __path__

load_tests = prepare_load_tests_function(__path__)
unittest.main() 
```

并在每个中复制并粘贴一个空白`__init__.py`和以下内容：`__main__.py``mypackage/tests/test_category_n/`

```
import unittest
from .. import prepare_load_tests_function
from . import __path__

load_tests = prepare_load_tests_function(__path__)
unittest.main() 
```

并`if __name__ == '__main__': unittest.main()`在每个实际测试文件中添加标准。

（适用于 Windows 上的 Python 3.3，ymmv。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-14T06:01:05.953

我想出了一个片段，可以做你想要的。它沿着您提供的路径寻找 Python 包/模块，并从这些模块中积累一组测试套件，然后一次执行所有测试套件。

这样做的好处是它将适用于嵌套在您指定的目录下的所有包，并且您不必在添加新组件时手动更改导入。

```
import logging
import os
import unittest

MODULE_EXTENSIONS = set('.py .pyc .pyo'.split())

def unit_test_extractor(tup, path, filenames):
    """Pull ``unittest.TestSuite``s from modules in path
    if the path represents a valid Python package. Accumulate
    results in `tup[1]`.
    """
    package_path, suites = tup
    logging.debug('Path: %s', path)
    logging.debug('Filenames: %s', filenames)
    relpath = os.path.relpath(path, package_path)
    relpath_pieces = relpath.split(os.sep)

    if relpath_pieces[0] == '.': # Base directory.
        relpath_pieces.pop(0) # Otherwise, screws up module name.
    elif not any(os.path.exists(os.path.join(path, '__init__' + ext))
            for ext in MODULE_EXTENSIONS):
        return # Not a package directory and not the base directory, reject.

    logging.info('Base: %s', '.'.join(relpath_pieces))
    for filename in filenames:
        base, ext = os.path.splitext(filename)
        if ext not in MODULE_EXTENSIONS: # Not a Python module.
            continue
        logging.info('Module: %s', base)
        module_name = '.'.join(relpath_pieces + [base])
        logging.info('Importing from %s', module_name)
        module = __import__(module_name)
        module_suites = unittest.defaultTestLoader.loadTestsFromModule(module)
        logging.info('Got suites: %s', module_suites)
        suites += module_suites

def get_test_suites(path):
    """:return: Iterable of suites for the packages/modules
    present under :param:`path`.
    """
    logging.info('Base path: %s', package_path)
    suites = []
    os.path.walk(package_path, unit_test_extractor, (package_path, suites))
    logging.info('Got suites: %s', suites)
    return suites

if __name__ == '__main__':
    logging.basicConfig(level=logging.WARN)
    package_path = os.path.dirname(os.path.abspath(__file__))
    suites = get_test_suites(package_path)
    for suite in suites:
        unittest.TextTestRunner(verbosity=2).run(suite) 
```

# .net - Excel 互操作： Range.FormatConditions.Add 抛出 MissingMethodException

> ID：644822
> 
> 赞同：2
> 
> 时间：2009-03-13T22:20:33.983
> 
> 标签：.net, excel, com-interop, conditional-formatting

我正在编写一个应用程序，它使用 Microsoft.Office.Interop.Excel 程序集从 Excel 电子表格导出/导入数据。一切都很好（除了基于 1 的索引和所有这些可选参数！），直到我尝试使用条件格式。当我调用 Range.FormatConditions.Add 时，我得到一个 MissingMethodException 告诉我不存在这样的方法。这在 Vista 和 XP 中都会发生。

以下是生成异常的代码示例：

```
//1\. Add a reference to Microsoft.Office.Interop.Excel (version 11.0.0.0)
//2\. Compile and run the following code:

using Microsoft.Office.Interop.Excel;

class Program
{
    static void Main(string[] args)
    {
        Application app = new Application();
        Workbook workbook = app.Workbooks[1];
        Worksheet worksheet = (Worksheet)workbook.Worksheets[1];
        Range range = worksheet.get_Range("A1", "A5");
        FormatCondition condition = range.FormatConditions.Add(
            XlFormatConditionType.xlCellValue, 
            XlFormatConditionOperator.xlBetween, 
            100, 
            200);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:26:09.370

这对您来说可能是一个很好的链接：[http ://social.msdn.microsoft.com/Forums/en-US/vsto/thread/8a91d154-f766-427a-963c-16dfa39e154a/](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/8a91d154-f766-427a-963c-16dfa39e154a/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-01T23:59:58.110

FormatConditions 接口的 Add() 方法有 8 个参数，而不是 4 个。AFAIK 在 Excel.Extensions 命名空间中没有此类型的扩展方法。您在上面的示例中使用了扩展方法还是...？

# cruisecontrol.net - Cruisecontrol.net 执行任务

> ID：644826
> 
> 赞同：1
> 
> 时间：2009-03-13T22:21:27.977
> 
> 标签：cruisecontrol.net

我正在使用 Cruisecontrol.net 中的 <'exec> 任务。我正在执行一个 .bat 文件并使用 <'buildArgs> 传递参数。我需要传递多个参数，但我不确定正确的语法是什么。我正在尝试执行类似 <'buildArgs>Arg1 Arg2<'/buildArgs> 的操作，但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T22:29:56.973

试试这个：

```
 <exec>
    <executable>YourBatFile.cmd</executable>
    <buildArgs>Arg1 Arg2</buildArgs>
  </exec> 
```

然后使用 %1 和 %2 读取 bat 文件中的值

# entity-framework - 复合主键也是实体框架中的外键

> ID：644827
> 
> 赞同：1
> 
> 时间：2009-03-13T22:22:58.597
> 
> 标签：entity-framework

如果我有 2 个表 1 具有复合主键，其中一个键也是另一个表中的外键：

表格1：

*   A (PK, FK - 映射到表 2 中的 X)
*   乙（PK）
*   C

表 2：

*   X (PK)
*   是

因为 A 是表 1 中的 PK 和表 2 中的 FK，所以当我使用 EF 生成实体模型时，我在表 1 中同时拥有 A 的**标量**和**导航**属性。我似乎无法将 A 作为标量删除（我认为因为它是主键）。

我遇到的问题是，如果我创建一个 table1Entity 并将 A 的标量属性设置为一个新值，A 的导航属性将不会自动更改（反之亦然）。

理想情况下，我只希望 A 公开导航属性 - 如果 A 不是复合主键的一部分，这就是它的行为方式。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-26T16:18:14.813

嗯，不是真的。使用模式绑定创建视图并在视图上创建聚集索引（SQL Server 2008 或更高版本，我不确定是否可以这样做的早期版本）。聚集索引将被识别为主键，从而诱使 EF(VS) 相信视图是一个真实的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T12:20:56.117

我是否正确假设 Table1 来自 Table2？如果是这样，我会这样做：

（我还将两个表的 PK 更改为相同的名称，因为它们可能具有相同的含义 - 对于这个实例，我将使用示例 ID）

*   首先，创建具有默认关系的模型（我通常只是从数据库中导入这两个表）
*   在设计器中，右键单击基本类型，添加继承，选择派生类型。
*   删除一对零或一关联
*   然后，由于基类型已经具有列 ID，因此将其从派生类型中删除。
*   转到派生类型的表映射，并将 ID 属性映射到表的 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-15T13:53:59.350

您是否明确设置了复合键的 ID 并在配置中引用了这些 ID？

IE

```
public class Table1
{
public Table2 A{get;set}
public int AId {get;set;}

public int BId {get;set;}
} 
```

我假设你需要类似的东西：

```
HasKey(pc => new { pc.AId, pc.BId});
HasRequired(x => x.A).WithMany().HasForeignKey(x => x.AId); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-19T14:40:03.613

不要直接映射到表 1，而是向您的数据库添加一个视图，该视图包含表 1 的所有字段，以及 A (A2) 的额外副本。然后，将标量键映射到 A2，将导航键映射到 A。

（如果使用视图，您会遇到问题，Visual Studio 找不到主键；通过手动编辑 edmx 文件的 XML 并添加 <Key><PropertyRef ... />< /Key> 到表 A) 的 <EntityType>

我知道 - 这很骇人听闻......但是嘿 - 它有效！

# asp.net - 使用 jquery 验证 windows 用户

> ID：644829
> 
> 赞同：1
> 
> 时间：2009-03-13T22:23:33.150
> 
> 标签：asp.net, jquery, web-services

MyMasterPage.master

```
<head runat="server">
    <script type="text/javascript">

    $(document).ready(function() {

        var userName = '<%# System.Web.HttpContext.Current.Request.ServerVariables["AUTH_USER"].ToString() %>';
        alert(userName);
        $.ajax({ type: "POST",
            url: "DemoWebService.asmx/GetFulName",
            contentType: "application/json; charset=utf-8",
            dataType: "xml",
            dataType: "json",
            data: "{'networkId':'" + userName + "'}",
            processData: false,
            error: function(XMLHttpRequest, textStatus, errorThrown) { ajaxError(XMLHttpRequest, textStatus, errorThrown); },
            success: function(xml) { ajaxFinish(xml); }
        });

    });
  </script>
</head> 
```

即使 userName 变量是空白的，我还是从我的 WebMethod 中获取了登录用户：

```
[WebMethod]
public string GetFulName(string networkId)
{
    //return networkId + " Full Name";
    return networkId + " From Server: " + System.Web.HttpContext.Current.Request.ServerVariables["AUTH_USER"].ToString();
} 
```

由于我正在检查母版页，存储身份验证结果的最佳做法是什么，这样我就不必检查每个页面。在使用 jquery 之前，我存储在 Session 中。

谢谢

网络配置

```
<authentication mode="Windows"/>
<webServices>
<protocols>
  <add name="HttpPost"/>
  <add name="HttpGet"/>
</protocols>
</webServices> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T22:33:39.367

您可以将结果存储在 cookie 中，然后在后续页面上检查该 cookie 以获取登录用户的名称。如果用户注销或他们的身份验证会话过期，您需要确保并删除 cookie。

有一个[可用于 jQuery 的插件](http://plugins.jquery.com/project/Cookie)来支持读取/写入/删除 cookie。

# windows - 从 FireFox 或命令行安装 CAB 文件

> ID：644831
> 
> 赞同：2
> 
> 时间：2009-03-13T22:23:46.800
> 
> 标签：windows, activex, cross-browser, cab

我有一个 CAB 文件，其中包含一些 DLL、一个 OCX ActiveX 控件、一个描述内容的 OSD 以及一个用于安装 DLL 和 ActiveX 控件的 INF。这些来自第 3 方，所以除了如何将它们分发给客户端之外，我无法控制任何东西。

它们在 Java 小程序中使用，并且可以跨浏览器工作，但似乎只有 IE 支持实际安装 CAB 文件。

安装通过以下方式完成：

```
<OBJECT classid="clsid:actual-class-id-here" NAME="name"
        width="0" height="0" codebase="xxxx.cab#Version=w,x,y,z">
  <param name="useslibrary" value="xxxx">
  <param name="useslibrarycodebase" value="xxxx.cab">
  <param name="useslibraryversion" value="w,x,y,z">
</OBJECT> 
```

所以，我需要一种方法来安装这个可以跨浏览器工作的 CAB 文件。由于以上只能通过 IE 工作，我需要一个替代方法，或者我需要一种从命令行安装它的方法，这将是一个合理的解决方法（然后我可以设置一个安装程序来处理它）。这需要通过 Vista 在 XP 上工作。

任何帮助将不胜感激！

编辑：**从命令行安装将是首选**，因为这样我就可以做一个不特定于 IE、FireFox 或任何其他浏览器的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T23:11:31.867

好的，所以我终于找到了一个提供有用信息的网站：

[http://www.msfn.org/board/install-inf-file-c-t104891.html](http://www.msfn.org/board/install-inf-file-c-t104891.html)

我可能会使用的结果命令：

```
rundll32.exe advpack.dll,LaunchINFSectionEx .\xxxx.inf,,C:\path\to\xxxx.cab,4 
```

我认为这正是我想要的。现在我只需要创建一个简单的安装程序，它应该很好地结合在一起！

# user-interface - 用于实验协议设计和开发的工具？

> ID：644834
> 
> 赞同：8
> 
> 时间：2009-03-13T22:26:07.903
> 
> 标签：user-interface, protocols, state, network-protocols, custom-protocol

是否有任何开源的高级工具可以促进和简化使用 GUI 的实验性网络协议 (TCP/UDP) 的开发？

基本上，类似于动态状态机编辑器，它允许您定义“数据包”、“消息”、“状态”、“验证器”、“处理程序”等。

优选地，这样的工具将足够全面以处理协议的所有相关方面（即客户端和服务器），以便可以将高级协议描述序列化为 XML/RDF 文件，在其中它可以用于动态创建实现协议的应用程序代码（即在 Python 中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T23:31:04.487

放弃文本编辑器的 GUI，进入协议规范语言的世界。这些工具中的大多数都对某些协议进行了描述，试图证明它没有被破坏，并生成一个实现和测试。这里有一些可以帮助您入门，但还有更多：

*   [拉格尔](http://www.complang.org/ragel/)
*   [装甲运兵车](http://www.crsr.net/Software/APC.html)
*   [旋转](http://spinroot.com/spin/whatispin.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T22:42:49.220

如果你无论如何都要瞄准一个最终的 Python 目标，谁不从一开始就推出你自己的测试平台（在 Python 中）？

状态机在代码中构建起来并不难，而且它们比 GUI 中的图片更容易明确地阅读和验证，尤其是当它们变得复杂时。

在我看来，使用嵌入式 DSL 比使用基于 GUI 的设计器做得更好。

编辑：如果，正如您在评论中所说，您只是将 python 作为示例，我建议您使用 timday 的答案。如果您实际上并不担心嵌入 python，请按照他的建议使用预先存在的 DSL。

# c# - 您可以将泛型类型的实例传递给其他强类型方法吗？

> ID：644841
> 
> 赞同：2
> 
> 时间：2009-03-13T22:29:03.433
> 
> 标签：c#, generics

我有一种情况，我有一个需要几个重载的方法。我有一个相当常见的场景，如果某些条件为真，我调用其中一个重载，否则我调用其他内容。我决定尝试聪明一点，将公共代码重构为一个通用方法，该方法将接受一个对象和一个条件，并调用重载方法或以其他方式调用公共代码。

一个非常简化的代码示例：

```
/// <summary>
/// Dummy interface
/// </summary>
public interface ITest1
{ }
/// <summary>
/// Dummy interface
/// </summary>
public interface ITest2
{ }
/// <summary>
/// Generic Class
/// </summary>
public class GenericClass
{
    /// <summary>
    /// First overload
    /// </summary>
    /// <param name="test1"></param>
    public void TestMethod(ITest1 test1)
    { }
    /// <summary>
    /// Second overload
    /// </summary>
    /// <param name="test2"></param>
    public void TestMethod(ITest2 test2)
    { }

    /// <summary>
    /// method with common logic
    /// </summary>
    /// <typeparam name="TInterfaceType">
    /// Type of the test object
    /// </typeparam>
    /// <param name="test">
    /// Test object to pass to the method.
    /// </param>
    public void ConditionallyCallTest<TInterfaceType>(
          TInterfaceType test, bool someLogic)
    {
        if (someLogic)
        {
            this.TestMethod(test);
        }
        else
        {
            // .. Perform Common operations here
        }
    }
} 
```

忽略这个不做任何事情的事实，如果你编译这个代码段，你会得到一个编译器错误，它不能将 TInterfaceType 转换为 ITest1。

我希望编译器等到我指定类型来进行类型检查，所以：

```
GenericClass g = new GenericClass();
// We have an overload, so this is OK:
g.ConditionallyCallTest<ITest1>(test1);
// We have an overload, so this is OK:
g.ConditionallyCallTest<ITest2>(test2);
// Compiler error, no overload available:
g.ConditionallyCallTest<UnknownType>(obj); 
```

是否可以使用 C# 做这样的事情？

我还尝试使用 where 子句来指定允许的类型，但我不知道如何让 where 子句指定指定类型之间的非此即彼关系，只有 AND 关系。

编辑

正如我[在下面的评论中提到的](https://stackoverflow.com/questions/644841/can-you-pass-an-instance-of-a-generic-type-to-other-strongly-typed-methods/644883#644883)，我试图避免创建匹配的重载方法，那么还有其他解决这个问题的建议，还是我受这里的语言限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:46:06.717

您甚至需要通用方法吗？只需使用普通重载。

```
/// <summary>
/// Dummy interface
/// </summary>
public interface ITest1
{ }
/// <summary>
/// Dummy interface
/// </summary>
public interface ITest2
{ }
/// <summary>
/// Generic Class
/// </summary>
public class GenericClass
{
    /// <summary>
    /// First overload
    /// </summary>
    /// <param name="test1"></param>
    public void TestMethod(ITest1 test1)
    { }
    /// <summary>
    /// Second overload
    /// </summary>
    /// <param name="test2"></param>
    public void TestMethod(ITest2 test2)
    { }

    public void ConditionallyCallTest(ITest1 test, bool someLogic)
    {
        if(Common(someLogic))
            return;

        TestMethod(test);
    }

    public void ConditionallyCallTest(ITest2 test, bool someLogic)
    {
        if(Common(someLogic))
            return;

        TestMethod(test);
    }

    private bool Common(bool someLogic)
    {
        if (someLogic)
        {
            return false;
        }

        // .. Perform Common operations here
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T22:57:44.393

为所有类型抽象出一个通用接口，并为此使用多态性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T22:35:50.000

编译器必须能够在不知道您要传递什么的情况下编译您的代码。对于这种情况，“您的代码”是指包含方法的类。

换句话说，它必须知道调用`TestMethod`是合法的，基于它在编译执行调用的方法时所知道的事情。

在这种情况下，它什么都不知道，`TInterfaceType`所以它不能保证这是好的，因此它会抱怨。

你可以告诉编译器泛型类型必须实现一个或多个接口，尽管它根本不会解决任何问题`TInterfaceType`，但你不能告诉它该类型必须实现一个或另一个接口。

换句话说，不，如果没有强制转换，你就无法做到这一点。

* * *

一种方法是创建多个重载，为您想要支持的每种接口类型创建一个。

泛型类型基本上适用于“任何可能的类型”，其中允许的类型有限。

使用泛型，如果不显式检查类型是否实现一个或另一个接口、强制转换并因此直接调用显式方法，则无法执行此操作。

您也不能重载该方法，并通过泛型约束对其进行区分，因为方法签名不能仅因泛型约束而有所不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T00:18:48.600

我不确定 IType1 和 IType2 是什么，但你显然需要一个接口 IHasTestMethod ，它们继承自

```
 interface IType0 { void Foo(); }
    interface IType1 : IType0 { }
    interface IType2 : IType0 { }

    void ConditionalCall(IType0 type, bool cond) 
    {
        if (Conditional(cond))
            type.Foo();
        return;
    } 
```

# c# - 串行端口。BytesToRead() 函数

> ID：644842
> 
> 赞同：2
> 
> 时间：2009-03-13T22:29:54.367
> 
> 标签：c#, serial-port

我正在使用串行端口 c#、CF 2.0

当没有可读取的内容时，是否可以信任此函数返回 0？

```
while (_sp.BytesToRead > 0)
{
    char[] buffer = new char[255];
    int bytes_read = _sp.Read(buffer, 0, buffer.Length);

    for (int i = 0; i < bytes_read; i++)
    {
        value += buffer[i];
    }

}
ProcessValue(value); 
```

我想做的是读取数据，直到没有更多字节要读取。_sp 是 SerialPort 类的一个实例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T22:52:03.923

是的。但是，它可能会引发异常 - 所以一定要处理它。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.bytestoread.aspx)。

# eclipse - 在 Eclipse 插件的 plugin.xml 中外部化字符串

> ID：644848
> 
> 赞同：10
> 
> 时间：2009-03-13T22:32:05.110
> 
> 标签：eclipse, eclipse-plugin

如何在我的 Eclipse 插件的 plugin.xml 中外部化字符串？

右键单击插件项目 > PDE 工具 > 外部化字符串不会显示我的插件。

我现在正在尝试手动执行此操作。我在 plugin.properties 中添加了条目，并将 plugin.xml 中的等效字符串替换为 % 符号，后跟字符串键。但这似乎不起作用。我在这里想念什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-13T23:24:21.710

我终于想出了如何手动外部化插件。

事实证明，Eclipse 以这种方式将 plugin.xml 外部化：

*   在插件清单 (META-INF/MANIFEST.MF) 中，添加以下行

    ```
    Bundle-Localization: plugin 
    ```

    您打算将外部化字符串存储在一个名为“plugin.properties”的文件中（原来这是缺少的部分）。

*   在 plugin.properties 中添加外部化字符串键值对。

*   将 plugin.xml 中的实际字符串替换为 plugin.properties 中的键（以 % 为前缀）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T23:06:54.123

如果您的工作集中有插件项目，则应该可以使用[**Externalize Strings**向导](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.pde.doc.user/guide/tools/pde_actions/externalize_strings.htm)来帮助外部化 Manifest 和 plugin.xml 文件中的字符串。
外部化清单文件提取可翻译的字符串并将它们存储在属性文件中以支持多语言。

该向导**位于 PDE 项目的 MANIFEST.MF 或 plugin.xml 文件的上下文菜单中的 PDE 工具菜单下**。

[![替代文字](https://i.stack.imgur.com/98tkn.png)](https://i.stack.imgur.com/98tkn.png)
[（来源：[eclipse.org](http://help.eclipse.org/stable/topic/org.eclipse.pde.doc.user/guide/images/pde_actions/externalize_strings_selection.png)）]

请注意，存在一些与检测[and](https://bugs.eclipse.org/bugs/show_bug.cgi?id=246788)[元素](https://bugs.eclipse.org/bugs/show_bug.cgi?id=246788)[的所有非外部化属性/值`<extension-point>``<extension>`](https://bugs.eclipse.org/bugs/show_bug.cgi?id=246788)或[显示 extension(-point) 的非外部化名称相关的](https://bugs.eclipse.org/bugs/show_bug.cgi?id=252329)错误，这些错误仅在 3.4 或最近的 3.5M4 中解决。

但是，如果“Externalize Strings”菜单根本没有出现在您的插件项目上，可能是它的“**[项目性质](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resAdv_natures.htm)**”以某种方式损坏，可能是您以前的 Java 项目[没有正确转换为 PDE 项目](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resAdv_natures.htm)？

所以有两个建议：

*   尝试全新安装 eclipse3.5M4
*   导入您的插件项目并检查其性质

然后告诉我们该菜单是否仍然不可用。

* * *

[正如您在自己的答案中](https://stackoverflow.com/questions/644848/externalizing-strings-in-plugin-xml-for-eclipse-plugin/644963#644963)提到的，外部化过程由字符串声明

```
Bundle-Localization: plugin 
```

在 MANIFEST.MF 文件中，[如此消息](http://dev.eclipse.org/newslists/news.eclipse.platform.swt/msg44094.html)中所述。

[已创建错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=198866)，但是：

*   本地化不是特定于 PDE 的东西，而是 OSGI 规范
*   该行并不总是在清单中：

    > 在 3.3 之前，我们通过创建 plugin.xml 然后转换它来创建所有清单。转换器总是将“Bundle-Localization:plugin”添加到 Manifest，因为如果插件没有 Manifest，这是默认位置。
    > 如果插件没有翻译文件，则此标头是不必要的膨胀。
    > 在 3.3 中，我们通过直接创建 Manifest 来创建插件项目，这意味着我们决定只创建项目创建所需的头文件。

*   对于那些创建了外部化 < 3.2 的捆绑包，然后在 3.3 中运行时无法看到它们的人来说，这可能是一个问题。

# nhibernate - 在 nHibernate 中仅获取基本类型对象

> ID：644849
> 
> 赞同：1
> 
> 时间：2009-03-13T22:32:14.673
> 
> 标签：nhibernate

我目前正在尝试解决一个问题。我有一个类表继承，又名 table-er-subclass（一个主表 + 其他几个带有附加数据的表）。在我的应用程序中，基础对象实例和扩展对象都可以存在。现在我希望能够有时只获取那些基础对象，有时同时获取两种类型。一个简单的例子（两个类都映射了它们的所有属性）

```
public class Base 
{
  public in ID {get; set;}
  public string Something {get; set;}
}

public class Extended : Base 
{
  public bool NewProp{get; set;}
} 
```

现在运行“来自 Base”的 hql 查询将同时获取 Base 和 Extedned 对象。有没有办法限制这种行为只获取 Base 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T18:32:38.463

使用 HQL，您应该能够使用“类”特殊属性：

```
from Base b where b.class=Base 
```

另一种方法可能是使用普通 SQL，您可以更好地控制检索的内容。

无论如何检查（N）Hibernate docs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T16:52:49.203

这就是上面示例的映射（如果有任何错误，请原谅我，它一定是一个错字导致示例运行）

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping auto-import="true"
                   default-lazy="false"
                   xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="urn:nhibernate-mapping-2.2">
  <class name="Base, Test"
         table="base">
    <id name="ID"
        access="property"
        column="ID"
        type="Int64"
        unsaved-value="0">
      <generator class="sequence">
        <param name="sequence">base_id_seq</param>
      </generator>
    </id>
    <property name="Something"
              access="property"
              type="String">
      <column name="somethin"/>
      <joined-subclass name="Extended, Test"
                       table="extended"
                       schema="extended">
        <key column="id" />
        <property name="NewProp"
                  access="property"
                  type="Boolean">
          <column name="newProp"/>
        </property>
      </joined-subclass>
    </class>
</hibernate-mapping> 
```

# c# - C# 模拟覆盖赋值运算符 (=)

> ID：644854
> 
> 赞同：6
> 
> 时间：2009-03-13T22:34:41.830
> 
> 标签：c#, operator-overloading, variable-assignment

我有一个有点简单的包装类有一点问题。

它看起来像这样：

```
public class Wrapper<T>
{
  private T _value;

  public Wrapper<T>(T value)
  {
    _value = value;
  }

  public static implicit operator Wrapper<T>(T value)
  {
    return new Wrapper<T>(value);
  }

  public static implicit operator T(Wrapper<T> value)
  {
    return value._value;
  }
} 
```

我已经覆盖了从和到 T 的隐式转换器，所以它的行为几乎就像 T 本身的一个实例。

例如

```
Wrapper<int> foo = 42; 
```

但是，在将 Wrapper 的一个实例分配给另一个时，我遇到了一个小问题，因为我只想分配第二个 Wrapper 类的值。

所以现在，我必须这样做：

```
Wrapper<int> foo = 42;
Wrapper<int> bar = (int)foo; 
```

或者通过属性公开 _value。

但是，由于这是在库中，并且我不希望用户依赖于记住这一点，你们知道我如何模仿覆盖赋值运算符吗？

仅更改指针的问题（就像将类实例分配给另一个时所做的那样）是我有一个指向这些 Wrapper 对象的指针字典，因此我不能一直更改它们，因为字典会停止然后匹配。

我可以看看这是否有点令人困惑，所以如果我遗漏了任何重要的内容，请随时询问:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-14T05:45:23.243

由于赋值运算符不能重载，因此没有真正好的解决方案。正如其他人指出的那样，使用结构将为您提供所需的赋值语义，但随后您将面临值语义——通常不是一件好事。

一种选择是重载构造函数：

```
public Wrapper(Wrapper<T> w)
{
    _value = w._value;
} 
```

这将导致以下语法：

```
Wrapper<int> foo = 42;
Wrapper<int> bar = new Wrapper<int>(foo); 
```

虽然比你所拥有的更冗长，但它读起来更好。

或者您可以添加一个`Clone`方法（而不是`ICloneable`接口），以便您可以编写：

```
Wrapper<int> bar = foo.Clone(); 
```

你可以变得非常有创意并重载一些运算符，使其基本上什么都不做。不过，我不建议这样做。对这类事情使用运算符重载通常会使代码变得晦涩难懂并且经常中断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-14T02:46:28.103

您可以将 Wrapper<T> 设为 a `struct`。但是我不确定这是否适合您的应用程序设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T13:19:13.583

不要以两种方式隐式地投射你的包装器。

```
public class DBValue<T>
{
    public static implicit operator DBValue <T>(T value)
    {
         return new DBValue<T>(value);
    }

    public static explicit operator T(DBValue <T> dbValue)
    {
         return dbValue.Value;
    }

    private readonly T _value;
    public T Value { get { this._value; } }

    public DBValue(T value)
    {
         this._value = value;
    }
} 
```

转换 from `DBValue<T>`to`T`是一种有损转换（至少，您失去了它是来自数据库的值的事实），并且最佳实践应该是明确的。`DBValue<T>`如果你通过转换 from to没有丢失任何东西`T`，你还不如只使用返回的属性`T`。

基本上，您已经明白了为什么不应该尝试这样做：如果可以用 DBValue 代替 T，反之亦然，编译器（或开发人员）如何知道选择哪一个？

要求下游开发者编写：

```
string value = MyProperty.Value 
```

或者

```
string value = (string)MyProperty 
```

代替

```
string value = MyProperty 
```

...不是那么繁琐，并确保每个人都知道到底发生了什么。

**编辑：**

要真正回答这个问题，您不能覆盖参考分配 - 或让它看起来像你有 - 但你不应该真的需要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T22:37:23.600

如果您查看 Nullable<T>... 它与您在此处所做的事情非常相似，它会使用 .Value 属性公开内部值。

> 仅更改指针的问题（就像将类实例分配给另一个时所做的那样）是我有一个指向这些 Wrapper 对象的指针字典，因此我不能一直更改它们，因为字典会停止然后匹配。

我不确定我是否遵循这一点，您在字典中究竟存储了什么？因为如果您要存储引用，CLR 将根据需要更新它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-09T18:44:52.120

这个旧帖子剧照需要额外的信息才能完成。很明显，由于 = 运算符无法重载，因此无法实现原始所需的行为，同样，C# 也不能被“欺骗”将对象转换为自己的类型……它总是归结为类引用分配。但 Steffen 的进一步帖子显示 Wrapper 类不仅用于局部变量，还用作*类字段类型*。 **可以使用所需的语义，并通过使用类属性而不是公共字段来维护内部字典的完整性。**

* * *

即使保留原始给定`Wrapper<T>`类及其隐式运算符，这里的代码也可以工作：

```
public class CustomerTable
{
    private Wrapper<string> _Name;
    public Wrapper<string> Name {
        get { return _Name; }
        set { _Name = (string)value; }
    }
}

public class UserTable
{
    private Wrapper<string> _Name;
    public Wrapper<string> Name {
        get { return _Name; }
        set { _Name = (string)value; }
    }
} 
```

如果进行此更改，它不会破坏现有代码，因为它仍然允许设置属性的各种模式：

```
CustomerTable customer = new CustomerTable();
UserTable user = new UserTable();

user.Name = customer.Name; //*** No longer breaks internal data structures

user.Name = "string literal";  // Works as expected with implicit cast operator
user.Name = (string)customer.Name; // Still allowed with explicit/implicit cast operator
user.Name = customer.Name.Value; // Also works if Value property is still defined 
```

因为这仍然不能回答最初的问题，所以如果在类属性上下文之外使用 Wrapper 类，即在对象之间传递等，使用 Wrapper 类仍然可能存在问题。也许通过适当的类设计可以消除整个 Wrapper 类，包括使用属性设置/获取访问器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-14T14:09:08.300

AJ Lane 我明白你的意思，我想你是对的——我只是想让图书馆的使用尽可能简单。

从 DbValue 到 T 的隐式转换的原因是简单地期望 T 的函数。

例如

```
literalSomething.Text = Server.HtmlEncode(SomeTable.SomeStringColumn); 
```

而不是

```
literalSomething.Text = Server.HtmlEncode((string)SomeTable.SomeStringColumn); 
```

这要求强制转换是隐式的。

话虽这么说，我只是在输入此内容时阅读了您的评论，我可以看到这确实是个问题。

我想我会回到通过属性来公开价值，它只需要开发人员输入更多，而且我认为代码有点难看。

想象一下 DbValue：

```
if (someValue.Value.HasValue) // someValue is DbValue<int?> 
```

但是话又说回来，“丑陋”的代码可能比仅仅阅读它的行为与你所期望的不同的代码更好。

我想这个问题最终会成为一个“最佳实践”问题。

总而言之，我将创建一个 Value 属性并使用它而不是隐式强制转换，使用该库的开发人员将不得不忍受它。

感谢您的投入:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-14T10:15:58.867

这就是属性的用途。它们允许您定义分配的含义。您不能为类或结构本身定义它，因为它们已经由语言定义来做必要的事情。只需在类中添加一个`Value`属性。

或者，编辑您的问题以更广泛地描述您的设计以及此 Wrapper 如何适应它，因为有人可能会建议一种更简单的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-14T12:30:56.353

我只是研究了一下，将类设为结构确实不是一种选择，因为它在无参数构造函数中有一些逻辑，而且它继承了一个抽象类，其中包含内部抽象函数。

我不能使用接口，因为这会使这些功能公开，这会完全破坏逻辑。

如果这会有所帮助，我可以发布整个课程，但它有点长（130 行）或者我可以在单独的服务器上折腾，如果这样会更好？（虽然它损害了这个问题的完整性，因为我最终可能会从该服务器中删除它）

还要解释这门课真的很难，没有写一篇完整的论文：-/

无论如何，我会尝试说明我遇到的问题。

假设 2 个表类：CustomerTable 和 UserTable：

```
public class CustomerTable
{
  Wrapper<string> Name;
}

public class UserTable
{
  Wrapper<string> Name;
} 
```

现在的问题是其他一些开发人员可能会使用上面的代码如下：

```
CustomerTable customer = new CustomerTable();
UserTable user = new UserTable();
user.Name = customer.Name; // This breaks my internal dictionary 
```

为了让它工作，开发人员应该做的是：

```
user.Name = (string)customer.Name; 
```

然而，问题是，在编写代码时，有谁会在他们的头脑中想到这一点？

即使我使用了 Value 属性，开发人员仍然必须记住要写

```
user.Name = customer.Name.Value; // or user.Name.Value = .... 
```

再一次，开发人员可能会忘记这一点，突然间他会遇到异常，或者更糟：没有持久化到数据库中的数据。

所以我的问题实际上是，我希望包装器完全透明（它应该可以使用，就好像它实际上是它正在包装的类/基元一样）。但是，当从一个包装器分配到另一个包装器时，我的内部逻辑会中断。

大量的写作和大量的代码 - 如果我过度写作，请告诉我。

# java - 如何在 Java 中测试 Internet 的可用性？

> ID：644856
> 
> 赞同：8
> 
> 时间：2009-03-13T22:35:35.587
> 
> 标签：java

当我从 url.openStream() 捕获异常时，我不想说互联网不可用。

有没有一种简单的方法来判断计算机是否在 Java 中连接到互联网？在这种情况下，“连接到互联网”意味着能够从特定 url 下载数据。

如果我尝试从中下载但它不可用，则程序会挂起一段时间。我不想这样挂。因此，我需要一种快速查询网站是否可用的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T23:15:40.153

您要避免的问题是等待您的 http 连接来确定您尝试访问的 URL 确实不可用。为了实现这一点，您需要停止使用 url.openStream() ，它是 openConnection().getInputStream() 的快捷方式，并更好地控制您的连接。

```
URLConnection conn = url.openConnection();  
conn.setConnectTimeout(timeoutMs);  
conn.setReadTimeout(timeoutMs);  
in = conn.getInputStream(); 
```

如果连接或读取超过您在 timeoutMs 参数中提供的时间，此代码将允许您使连接尝试超时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-13T04:09:49.310

采用

```
Process p1 = java.lang.Runtime.getRuntime().exec("ping www.google.com");
System.out.println(p1.waitFor());
// return code for p1 will be 0 if internet is connected, else it will be 1 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T22:39:43.627

没有“互联网可用性”之类的东西。想象一下，您的 HTTP 请求通过一个透明的 HTTP 代理，您正试图访问一个列入黑名单的站点，并且您从代理服务器收到一个 HTTP 响应，告诉您访问被拒绝。在这种情况下是否可以使用 Internet？

我认为您应该更具体地说明您的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T22:37:30.357

您可能能够判断计算机是否已连接到网络，但即使是，也不能保证网络正常工作或已连接到 Internet。

这是那些“接受并看到”问题之一。

尝试连接有什么问题？你为什么担心他们是否连接到互联网？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T23:05:21.367

如果标准是您是否可以访问给定的 Web 服务器，那么找出答案的唯一方法就是访问该 Web 服务器。

但是，您可以在启动时在后台线程中执行此操作，这样应用程序就不会被它延迟。然后，当需要实际下载时，可以使用“是/否”的答案。在状态行中放置一条消息，以便用户知道发生了什么，并且如果在您的程序启动时她/他没有连接，则不会对未启动的“连接到网络”感到惊讶。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T22:50:54.660

我对 Java 中可用的低级 HTTP 管道了解不多，但您总是可以提前发出对 url 的 http HEAD 请求。这会导致服务器只发回标头而不发回数据。通过 1-3 秒的超时，您应该能够避免任何长时间的延迟。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-14T06:50:03.370

如果您的程序在等待下载时挂起，那么您可能正在使用 GUI 线程进行下载。如果您使用后台线程，即使超时/下载需要很长时间，您的程序也不会挂起。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T22:39:51.397

您可以向一个非常知名的主机发送 ICMP 消息...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T22:50:18.733

如果您的防火墙不禁止，您可以检查[NTP 服务器。](http://support.ntp.org/bin/view/Servers/WebHome)

我认为最好的选择是尝试避免打开 URL，因为这是最常打开的服务。

您可以检查一个或两个不断变化的动态 URL。例如，一些显示时间的网络。例如[这个](http://www.whattimeisit.com/)我发现谷歌。不止一个，因为网站可能会关闭；-)

# .net - 如何正确复制/克隆结构？我应该改用一个类吗？

> ID：644861
> 
> 赞同：2
> 
> 时间：2009-03-13T22:37:25.223
> 
> 标签：.net

假设我有那个

```
Structure myStruct
    Public myPoint As Point
    Public myBool As Boolean
End Structure 
```

如何制作该结构的副本/克隆？

我现在解决了这个问题，我使用的代码示例：

```
 Dim myStruct(1) As myStruct 
    myStruct(0).myPoint = New Point(10, 10)
    myStruct(0).myBool = True

    Dim myCopy(1) As myStruct
    myCopy = myStruct
    myCopy(0).myBool = False
    myCopy(0).myPoint = New Point(11, 11) 
```

这样，两个变量都被改变了

我必须做

```
 myCopy = CType(myStruct.Clone, myStruct()) 
```

还有一个问题，如果使用该结构，比如说 10,000 次，我应该创建一个类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T22:47:01.737

您正在查看每个结构 12 个字节，因此将其作为结构传递比在堆上创建对它的字大小的引用便宜（换句话说，使用类）

如果您需要一次访问所有 10,000 个，那么即使它们是结构，也会在堆上创建它们的数组。

复制该结构就像创建声明另一个相同类型的结构并将第一个分配给第二个一样简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T00:17:31.347

您必须使用 Clone 方法的原因是您正在复制 Array 对象，而不是结构。这适用于复制结构值：

```
Dim myStructArray(0) As MyStruct
myStructArray(0).MyPoint = New Point(10, 10)
myStructArray(0).MyBool = True

Dim myCopyArray(0) As MyStruct
myCopyArray(0) = myStructArray(0) 'copy structure instead of array
myCopyArray(0).MyBool = False
myCopyArray(0).MyPoint = New Point(11, 11) 
```

在这种情况下，在替换所有值时复制结构当然是完全没有意义的，但是复制确实有效，给您留下了两个单独的数组，而不是对同一个数组的两个引用。

结构通常应该是不可变的，即它的属性是只读的，这可以保护您免受以下情况的影响：

```
Dim myStructList(Of MyStruct) As New myStructList(Of MyStruct)()
myStructList.Add(New MyStruct())
myStructList(0).MyPoint = New Point(10, 10) 'doesn't work 
```

这不起作用的原因是 myStructList(0) 返回结构的副本。副本的 MyPoint 成员已更改，但结构的副本永远不会写回列表。

这是不可变的结构：

```
Structure MyStruct

   Private _myPoint As Point
   Private _myBool As Boolean

   Public Readonly Property MyPoint As Point
      Get
         Return _myPoint
      End Get
   End Property

   Public Readonly Property MyBool As Boolean
      Get
         Return _myBoolean
      End Get
   End Property

   Public Sub New(ByVal myPoint As Point, ByVal myBool As Boolean)
      _myPoint = myPoint
      _myBool = myBool
   End Sub

End Structure 
```

您使用构造函数创建一个新值：

```
Dim myStructList(Of MyStruct) As New myStructList(Of MyStruct)()
myStructList.Add(New MyStruct(New Point(10, 10), True)) 
```

您仍然可以复制整个结构值：

```
Dim myStructArray(0) As MyStruct
myStructArray(0) = New MyStruct(New Point(10, 10), True)

Dim myCopyArray(0) As MyStruct
myCopyArray(0) = myStructArray(0) 'copy structure value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T06:55:29.677

要制作结构的副本，您**必须声明**它的新实例。我通常通过在结构中实现我自己的 Clone() 方法来做到这一点。例如：

```
Friend Structure SomeStructure
  Dim ValueA As Integer
  Dim ValueB As Integer
  Dim Values() As Integer
  Public Function Clone() As SomeStructure
    Dim theClone As SomeStructure
    theClone.ValueA = Me.ValueA
    theClone.ValueB = Me.ValueB
    ReDim theClone.Values(Me.Values.GetUpperBound(0))
    Array.Copy(Me.Values, theClone.Values, Me.Values.Length)
    Return theClone
  End Function
End Structure 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-16T15:26:56.160

Visual Basic 2013 的注意事项：使用 estructure2=estructure1 复制结构不会将 estructure1 的副本创建到结构 2；相反，它会将结构 1 的引用分配给结构 2。在这种情况下，访问结构 2 将给出与结构 1 相同的字段值。如果结构 1 中的任何一个字段发生变化，使用结构 2 访问的值也会发生变化，因为它们指向的是相同的数据。从这个意义上说，根本不是副本。

# xaml - Ag UserControl 可以公开为 XAML 绑定的属性吗？

> ID：644866
> 
> 赞同：0
> 
> 时间：2009-03-13T22:39:19.913
> 
> 标签：xaml, silverlight-2.0

我有一个新的 UserControl 支持，`UserControl01.cs`它公开了两个属性。一个是普通的旧 CLR 属性，另一个是较新的 DP 属性格式。例如：

```
string PropertyOne {get;set;} 
```

第二个属性是公共 DP（构造太长，无法在此处列出）。

从 XAML 方面，我希望公开这些值。我怎样才能做到这一点？

在这两个属性（旧的 CLR 以及第二个 DP 包装器格式）上，我尝试了如下语法：

```
 <TextBlock Text={Binding Prop1}/>
 <TextBlock Text={Binding Source=., Path=Prop1}/> 
```

我已经尝试在 Resource 字典中放置类类型的引用并引用它

```
 <TextBlock Text={Binding Source={StaticReference myType}, Path=Prop1}/> 
```

但这显然最终是堆栈溢出，因为字典实例化了控件的第二个副本。

我在某处读过一篇文章，在 WPF 中可以`x:Name`控制本身，然后

```
 <TextBlock Text="{Binding {ElementName=theName, Path=Prop1}"/> 
```

但是我们在 Ag 中没有 ElementName 绑定，所以不是这样。

1.  如何绑定到 UserControl 的属性？任何财产！
2.  如果这是不可能的，并且您只能绑定到 DTO 或其他 BO，那么关于我们应该如何设计想要公开其值的 UserControl 的指导逻辑/解释是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T22:27:29.057

Silverlight 3 具有控制绑定的控件。 [http://silverlight.net/learn/learnvideo.aspx?video=187309](http://silverlight.net/learn/learnvideo.aspx?video=187309)

# c# - 为什么我通过 C# 创建的这个 javascript 变量只更新一次？

> ID：644874
> 
> 赞同：0
> 
> 时间：2009-03-13T22:42:11.170
> 
> 标签：c#, .net, javascript

在我的 ASP.Net 应用程序的 C# 代码隐藏中，我设置了一个变量，然后我想设置一个等于它的 Javascript 变量，以便我可以在客户端使用它做一些工作。这个 C# 变量是在事件处理程序中设置的，它的变化相当频繁。

所以，我的事件处理程序只做这个......

```
int scale = (int)myObject.Scale;
Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "JSVariables", "scale=" + scale, true); 
```

然后我在我的 JS 中有事件处理程序，它只是提醒值。

```
alert(scale); 
```

问题是比例值仅在第一次触发事件时设置。每次引发事件时，我都可以单步执行我的 C# 代码，并看到调用了 RegisterClientScriptBlock 并且该比例实际上得到了不同的值。

如何让这个值不恒定？每次达到 RegisterClientScriptBlock 行时，都应该将一个新值加载到我的 JS 比例变量中，但它只是保持最初的状态。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:45:07.000

`this.GetType()`RegisterClientScriptBlock 通过类型 ( ) 和键 ( )注册您的脚本`"JSVariables"`。下一次在同一个执行堆栈中调用 RegisterClientScriptBlock 时，它将检查该类型和键的脚本是否已经注册，如果是，它将不做任何事情。

这样做的目的是消除重复的共享脚本。如果您的五个控件都依赖于一个共享的 JavaScript 包含，那么您只想在页面上包含一次。因此所有控件都可以调用相同的包含函数和键，并确保它不会被多次包含。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T22:50:33.443

除了 Rex 所说的，如果您使用的是 ASP.NET Ajax，如果您想在部分回发之间更新这些值，您将需要使用 ScriptManager 上的 RegisterClientScript 方法，听起来确实像您正在做的那样。

# .net - 为什么我需要将控制台输入转换为特定的数据类型？

> ID：644876
> 
> 赞同：0
> 
> 时间：2009-03-13T22:43:03.493
> 
> 标签：.net, console, type-conversion

在进行计算时寻找更多关于转换为双精度、整数和小数格式的帮助。

例如：...Console.Write("输入总销售额：");

...userInput = Console.ReadLine();

...totalSales = Convert.ToDouble(userInput);

我不完全理解为什么我需要将其转换为双精度，为什么不能只是 Console.ReadLine();

TY 对不起，如果这太业余了。哈哈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:44:32.180

真的，哈哈。

所以你需要转换为 double 的原因是因为 Console.ReadLine 读入了一个字符串。

我建议你阅读：

[http://msdn.microsoft.com/en-us/library/cs7y5x0x.aspx](http://msdn.microsoft.com/en-us/library/cs7y5x0x.aspx)这样您就可以掌握不同的数据类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T22:51:16.110

用户输入是一个字符串，而不是一个双精度数（或您希望它以这种方式出现的任何数字）。所以这里有两种不同的数据类型。

如果您出于某种原因想要进行诸如 userInput + 5 之类的计算，如果 userInput 是一个字符串，它会根据编译器/语言而翻转或给您意想不到的结果。

也许这样想会有所帮助。如果您没有先转换为双精度，那就像尝试这样做...

“2.33”+ 5

你也可以这样做...

“嘿！” + 5

一旦它被转换，虽然它更像这样......

2.33 + 5

请注意，不再有暗示 2.33 现在是数字而不是字符串的引号。

# asp.net - 需要 UserVoice 反馈页面功能

> ID：644878
> 
> 赞同：0
> 
> 时间：2009-03-13T22:44:24.130
> 
> 标签：asp.net, javascript

我喜欢页面滚动时静态的反馈链接，我想添加与我的网站类似的内容。例如，参见 www.bind.pt，右侧。但是我不想使用 UserVoice。我想使用具有表单到电子邮件功能的弹出窗口。

是否有类似的示例 asp.net 组件或 Javascript 可供像我这样的懒惰开发人员重复使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T23:08:31.887

这里有一个很好的解决这个问题的方法[——](https://stackoverflow.com/questions/56630/how-can-i-get-a-fixed-position-menu-like-slashdots-comment-filtration-menu)发帖者自己的答案。

享受！

# c# - WCF 和子类

> ID：644888
> 
> 赞同：3
> 
> 时间：2009-03-13T22:49:06.270
> 
> 标签：c#, .net, wcf

我有这个 ServiceContract

```
[OperationContract(IsOneWay=true)]
void ProcessMessage(Message message); 
```

和这些物体

```
[DataContract]
public class Message
{
    [DataMember]
    public long Id { get; set; }

    [DataMember]
    public string Body { get; set; }
}

[DataContract]
public class ExtendedMessage : Message
{       
    [DataMember]
    public NameValueCollection AdditionalData { get; set; }
} 
```

如果我将子类传递给服务方法，WCF 是否能够处理？还是会丢弃所有不在基类上的额外属性？

```
ExtendedMessage msg = new ExtendedMessage();
...
ProcessMessage(msg); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T23:56:00.590

我想如果你没有通过 KnownType 属性指定 ExtendedMessage，你会得到一个错误。一旦您通过 KnownType 将 ExtendedMessage 告知 WCF，它将工作而不会丢失数据。

顺便说一句，您不需要在编译时知道可能的类型集，因为 KnownType 属性可以引用一个方法，该方法将在运行时返回可能的类型集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-26T11:53:01.987

您还可以使用 ServiceKnownType 属性来缩小 KnownType 属性的范围。您可以将 ServiceKnownType 属性应用于特定操作或服务合同。

# c++ - 学习嵌入式 C/C++ 开发的最佳评估套件是什么？

> ID：644889
> 
> 赞同：12
> 
> 时间：2009-03-13T22:50:18.733
> 
> 标签：c++, c, embedded, arm

我正在尝试改进我在 ARM 架构上的嵌入式 C/C++ 开发。我最近从 68K 开发转到 ARM，想利用我的一些空闲时间深入研究该平台并学习最佳实践，尤其是针对移动平台的开发。

最好 32 位架构将有助于支持开发工具。学习过程中的一点乐趣可能会增强我对平台的理解

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T23:28:50.373

似乎有很多有趣的事情正在使用[Arduino](http://blog.makezine.com/archive/arduino/)平台完成。

基本的答案实际上是“任何你能负担得起的东西都可以让你创造有趣的东西”，而 Arduino 似乎符合要求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-14T00:42:03.597

[ST Micro](http://www.st.com/)为其基于 ARM Cortex-M3 的 STM32 产品线提供了一个价格非常有吸引力（并且也封装了）的套件。[STM32-PRIMER](http://www.stm32circle.com/hom/index.php)的建议零售价约为 35 美元，配备 128x128 彩色 LCD、MEMS 加速度计、按钮、LED、USB 和一些备用 GPIO，所有这些都在一个包含电池和 USB 到 JTAG 调试连接的封装中。GCC 工具链和商业调试器也应该附带。我有一个订单，并会尽量记住在下周某个时间到达后编辑此答案以包括快速审查。

他们有一个基于 STM32 的新型号，芯片上有更多的 FLASH 和 RAM，还有一个 micro-SD 卡连接器，以及一个更大的 LCD，包括一个电阻式触摸屏，如果你能在库存中找到它，它的价格刚刚超过 100 美元。

[Luminary Micro](http://www.luminarymicro.com/)也有许多便宜的演示/评估板套件。[eLua 项目](http://www.eluaproject.net/)（运行在 SoC 和 MCU 规模设备中的完整 Lua 编程环境）背后的人似乎喜欢 Luminary Micro 产品线，但我对他们没有亲身经历。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-14T07:03:23.743

由于您想为移动平台开发，[Beagle Board](http://beagleboard.org/)可能适合您。

另一张海报提到的 STM32/Cortex M3 嵌入更深，更适合中等复杂的控制应用。

Arduino 使用 AVR 控制器，而不是 ARM，并且在低端附近嵌入更深（低端是 PIC）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T16:28:05.970

我认为在开始进行嵌入式工作之前，您需要有一个特定的目的。我的意思是嵌入式工作往往具有专门的硬件，试图实现通用计算机目前无法填补（或使用起来太贵）的利基市场。

如果您要购买一些嵌入式硬件，您最终会在某种控制台环境（telnet 或某种 UART 或通过 JTAG 或 USB）中运行“hello world”应用程序，但那又如何呢？为什么要自杀来启动启动/驱动程序等运行“hello world”？

* * *

我正在研究的一个特定目的是软件定义无线电。你可能想尝试在嵌入式设备上用代码实现一个简单的 FM 或 AM 收音机，因为这会给你一个特定的目标，并且让它工作起来真的很有趣（并且有一个很好的理由自杀来让嵌入式系统活跃起来！）

没有什么比让某种以前死气沉沉的空白硬件活跃起来并看到它从您的 main() 函数一直打开到有用的东西（如 FM 或 AM 收音机）更有趣的了。

*   [http://www.wired.com/science/discoveries/news/2006/06/70933?currentPage=all](http://www.wired.com/science/discoveries/news/2006/06/70933?currentPage=all)
*   [http://en.wikipedia.org/wiki/Universal_Software_Radio_Peripheral](http://en.wikipedia.org/wiki/Universal_Software_Radio_Peripheral)
*   [http://www.ettus.com/orderpage.html](http://www.ettus.com/orderpage.html)，好像有点贵

请注意，软件定义无线电硬件的成本将比预期的要高一点……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T13:59:00.960

[Gumstix 平台](http://gumstix.com/index.html)一直给我留下深刻印象。这是一个运行 Linux 的“强大”平台，但他们有各种软件包[，起价 150 美元](http://gumstix.com/store/catalog/product_info.php?products_id=211)，但也有大量已发布[的操作指南/用户项目](http://gumstix.net/wiki/index.php?title=Main_Page)。我使用的那个使用了 uCLinux 的风格，因此对于新用户来说，这将是一个稍微容易一些的过渡路径。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T14:50:28.320

假设您对嵌入式开发感兴趣：

我喜欢通过 sparkfun.com 出售的 olimex 板和非 olimex 板。sam7、lpc 等。 Stellaris
板也非常好。
仅仅获得一个旧的gameboy Advance 和一个supercard sd，或者将一个nds 与一个r4ds 或cyclods 一起使用，您可以获得很多满足感和乐趣。nds对于初学者来说有点痛苦，入门成本是gba的三到四倍。gba mini 或 sp 具有背光，您几乎可以立即欣赏到与未点亮的原始 gba 相比。使用 gba（或 nds），您可以使用 vba 之类的仿真器弄湿您的脚，而无需购买任何东西。发光的微型显示器是一个很好的开始，它有一个漂亮的显示器和一些其他的车载小工具可以玩。小心 811 板，因为它很容易变砖，因为端口上有一个 jtag 引脚，您希望将其用作通用 I/O。另一方面，他们对车载外围设备的驱动程序越来越吝啬，

如果您只想在操作系统上编写应用程序：beagleboard、embeddedarm 或 qemu-arm，这与为任何其他基于 linux 的机器编写应用程序实际上没有什么不同，因此 arm 因素真的不存在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T02:19:54.473

www.embeddedarm.com - TS-7800

这是一个提供 pc/104 堆栈的好平台。只需大约 200 美元，您就可以做很多事情并了解他们的硬件（UART、ADC 等），并且可以通过 104 堆栈来增加您的学习经验。

# html - 如何缩放嵌入的顽固 SVG tag? I have some SVG files that specifies width and height as well as viewbox like this: <svg width="576pt" height="432pt" viewBox="0 0 576 432" > ... 问问题 Zitrax 问问题 2009-03-13T22:51:16.173 97618 次 This question shows research effort; it is useful and clear 121 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have some SVG files that specifies width and height as well as viewbox like this: <svg width="576pt" height="432pt" viewBox="0 0 576 432" > ... but how to display them in the browser at a size I decide? I want them smaller and have tried: <object width="400" data="image.svg"></object> but then I get visible scrollbars. It works if I change the SVG files to set width and height to 100% instead, but I want to decide the size in the HTML regardless of what sizes are used in the SVG file. Is this possible ? Let see. I had to refresh my memory on SVG, I haven't used it much these years. From what I found today, it seems that if you specify dimension of objects without units, they have a fixed size (in pixels, I think). Apparently, then, there is no way to resize them when you resize the SVG (it only change the viewport/canvas size). Unless, as pointed out, you specify the size of the SVG in percentage OR specify a viewBox (eg. viewBox="0 0 600 500"). Now, if you have no way to change the exported SVG, you are out of luck, I fear. What library do you use? htmlsvg 4 9 回答 9 This answer is useful 166 You can add "preserveAspectRatio" and "viewBox" attributes to the <svg> tag to accomplish this. Open the .svg file in an editor and find the <svg> tag. in that tag, add the following attributes: preserveAspectRatio="xMinYMin meet" viewBox="0 0 {width} {height}" Replace {width} and {height} with some defaults for the viewBox. I used the values from the "width" and "height" attributes of the SVG tag and it seemed to work. Save the SVG and it should now scale as expected. I found this information here: https://blueprints.launchpad.net/inkscape/+spec/allow-browser-resizing 于 2010-08-14T19:41:21.487 回答 This answer is useful 35 None of the answers given here worked for me when I asked this back in 2009\. As I now had the same issue again I noticed that using the <img> tag and width together with an svg works fine. <img width="400" src="image.svg"> 于 2011-11-15T13:49:33.443 回答 This answer is useful 11 <body> <div> <object type="image/svg+xml" data="img/logo.svg"> <img src="img/logo.svg" alt="Browser fail" /> </object> </div> img/logo.svg ... <svg width="100%" height="100%" viewBox="0 0 640 80" xmlns="http://www.w3.org/2000/svg" version="1.1" /> This setup worked for me. 于 2012-10-18T22:39:49.580 回答 This answer is useful 10 You can reach into the embedded svg using JavaScript: var svg = document.getElementsByTagName('object')[0].\ contentDocument.getElementsByTagName('svg')[0]; svg.removeAttribute('width'); svg.removeAttribute('height'); Since your svg already has a viewBox, Firefox should scale the 576 pixel width in the viewBox to the 400 pixel width in your document. Other svgs might benefit from a new viewBox derived from the advertised width and height (these are often the same numbers). Other browsers might benefit from different svg tweaks. 于 2009-08-08T04:43:31.827 回答 This answer is useful 9 I encountered a problem where iOS on an iPad would not correctly resize SVG images in a <object> tag. The CSS style would increase or decrease size of the <object> container, but the image inside of it would not be modified (on iPad, iOS 7). The SVG images were exported from Adobe Illustrator, and the solution turned out to be replacing the width and height in this: <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="481.89px" height="294.843px" viewBox="0 0 481.89 294.843" enable-background="new 0 0 481.89 294.843" xml:space="preserve"> with: width="100%" height="100%" I needed to use the <object> tag because the <img> tag does not currently support embedding bitmapped images in SVG's. 于 2014-07-29T15:59:07.700 回答 This answer is useful 5 Set the missing viewbox and fill in the height and width values of the set height and height attributes in the svg tag Then scale the picture simply by setting the height and width to the desired percent values. Good luck. You can set a fixed aspect ratio with preserveAspectRatio="x200Y200 meet, but it's not necessary e.g. <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="10%" height="10%" preserveAspectRatio="x200Y200 meet" viewBox="0 0 350 350" id="svg2" version="1.1" inkscape:version="0.48.0 r9654" sodipodi:docname="namesvg.svg"> 于 2011-09-16T19:30:06.830 回答 This answer is useful 4 Just use CSS to make the browser resize the SVG! Like so: <object style="width:30%"> See http://www.vlado-do.de/svg_test/ for more details. I just also tried it locally with an SVG that has its width and height given in "pt". It works well in Firefox. 于 2012-04-11T16:04:56.113 回答 This answer is useful 1 Here is a PHP solution using QueryPath based on Jim Keller's answer. Once QueryPath is loaded just pass your svg script to the function. function scaleableSVG($svg){ $qp = qp($svg, 'svg'); $width = $qp->attr('width'); $height = $qp->attr('height'); $qp->removeAttr('width')->removeAttr('height'); $qp->attr('preserveAspectRatio', "xMinYMin meet"); $qp->attr('viewBox', "0 0 $width $height"); return $qp->html(); } 于 2014-05-04T13:48:24.200 回答 This answer is useful 1 让我们看看。我不得不刷新我对 SVG 的记忆，这些年来我没有用太多。 从我今天发现的情况来看，如果您指定没有单位的对象的尺寸，它们的尺寸是固定的（我认为以像素为单位）。显然，当您调整 SVG 大小时，无法调整它们的大小（它只会更改视口/画布大小）。 除非，正如所指出的，您以百分比指定 SVG 的大小或指定 viewBox（例如 viewBox="0 0 600 500"）。 现在，如果您无法更改导出的 SVG，恐怕您就不走运了。你用什么图书馆？ 于 2009-03-14T10:07:38.230 回答 Related 3 c# - 在设定的时间行动不起作用 1 views - PhalconPHP 中的 *.volt 和 *.phtml 文件有什么区别？ 1 android-intent - Android：尝试从主要活动到新活动获取计算的int 2 javascript - FabricJS: Always Center Object on Canvas 1 c++ - 适合中级程序员成为专家级程序员的 C++ 书籍？ 1 php - 关于 MySQL 中日期的迭代 INSERT 1 c# - CallerMemberNameAttribute and Roslyn 1 javascript - 通过检查页面 URL 使用 if-else 1 scala - aspectj 是否可以访问 Scala 中方法的隐式参数？ 1 c# - 如何为子组件克隆 Windsor Container Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：644896
> 
> 赞同：121
> 
> 时间：
> 
> 标签：html, svg

I have some SVG files that specifies `width` and `height` as well as `viewbox` like this:

```
<svg width="576pt" height="432pt" viewBox="0 0 576 432" > ... 
```

but how to display them in the browser at a size I decide? I want them smaller and have tried:

```
<object width="400" data="image.svg"></object> 
```

but then I get visible scrollbars.

It works if I change the SVG files to set `width` and `height` to `100%` instead, but I want to decide the size in the HTML regardless of what sizes are used in the SVG file. Is this possible ?

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2010-08-14T19:41:21.487

You can add "preserveAspectRatio" and "viewBox" attributes to the `<svg>` tag to accomplish this.

Open the .svg file in an editor and find the `<svg>` tag. in that tag, add the following attributes:

```
preserveAspectRatio="xMinYMin meet"
viewBox="0 0 {width} {height}" 
```

Replace {width} and {height} with some defaults for the viewBox. I used the values from the "width" and "height" attributes of the SVG tag and it seemed to work.

Save the SVG and it should now scale as expected.

I found this information here:

[https://blueprints.launchpad.net/inkscape/+spec/allow-browser-resizing](https://blueprints.launchpad.net/inkscape/+spec/allow-browser-resizing)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-11-15T13:49:33.443

None of the answers given here worked for me when I asked this back in 2009\. As I now had the same issue again I noticed that using the `<img>` tag and width together with an svg works fine.

```
<img width="400" src="image.svg"> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-10-18T22:39:49.580

```
<body>

<div>
<object type="image/svg+xml" data="img/logo.svg">
   <img src="img/logo.svg" alt="Browser fail" />
</object>
</div> 
```

img/logo.svg ...

```
<svg
   width="100%" 
   height="100%"
   viewBox="0 0 640 80"
   xmlns="http://www.w3.org/2000/svg"
   version="1.1" /> 
```

This setup worked for me.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-08-08T04:43:31.827

You can reach into the embedded svg using JavaScript:

```
var svg = document.getElementsByTagName('object')[0].\
  contentDocument.getElementsByTagName('svg')[0];
svg.removeAttribute('width');
svg.removeAttribute('height'); 
```

Since your svg already has a viewBox, Firefox should scale the 576 pixel width in the viewBox to the 400 pixel width in your document. Other svgs might benefit from a new viewBox derived from the advertised width and height (these are often the same numbers). Other browsers might benefit from different svg tweaks.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-07-29T15:59:07.700

I encountered a problem where iOS on an iPad would not correctly resize SVG images in a `<object>` tag.

The CSS style would increase or decrease size of the `<object>` container, but the image inside of it would not be modified (on iPad, iOS 7).

The SVG images were exported from Adobe Illustrator, and the solution turned out to be replacing the width and height in this:

```
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
width="481.89px" height="294.843px" viewBox="0 0 481.89 294.843" 
enable-background="new 0 0 481.89 294.843"
xml:space="preserve"> 
```

with:

```
width="100%" height="100%" 
```

I needed to use the `<object>` tag because the `<img>` tag does not currently support embedding bitmapped images in SVG's.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-09-16T19:30:06.830

1.  Set the **missing viewbox** and fill in the height and width values of the set height and height attributes in the svg tag

2.  Then scale the picture simply by **setting the height and width** to the **desired percent** values. Good luck.

3.  You can set a fixed aspect ratio with preserveAspectRatio="x200Y200 meet, but it's not necessary

e.g.

```
 <svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="10%" 
   height="10%"
   preserveAspectRatio="x200Y200 meet"
   viewBox="0 0 350 350"
   id="svg2"
   version="1.1"
   inkscape:version="0.48.0 r9654"
   sodipodi:docname="namesvg.svg"> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-04-11T16:04:56.113

Just use CSS to make the browser resize the SVG! Like so: `<object style="width:30%">` See [http://www.vlado-do.de/svg_test/](http://www.vlado-do.de/svg_test/) for more details. I just also tried it locally with an SVG that has its width and height given in "pt". It works well in Firefox.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-05-04T13:48:24.200

Here is a PHP solution using [QueryPath](http://querypath.org/) based on Jim Keller's answer.

Once QueryPath is loaded just pass your svg script to the function.

```
function scaleableSVG($svg){
    $qp = qp($svg, 'svg');
    $width = $qp->attr('width');
    $height = $qp->attr('height');
    $qp->removeAttr('width')->removeAttr('height');                       
    $qp->attr('preserveAspectRatio', "xMinYMin meet");
    $qp->attr('viewBox', "0 0 $width $height");
    return $qp->html();
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-14T10:07:38.230

让我们看看。我不得不刷新我对 SVG 的记忆，这些年来我没有用太多。

从我今天发现的情况来看，如果您指定没有单位的对象的尺寸，它们的尺寸是固定的（我认为以像素为单位）。显然，当您调整 SVG 大小时，无法调整它们的大小（它只会更改视口/画布大小）。

除非，正如所指出的，您以百分比指定 SVG 的大小或指定 viewBox（例如 viewBox="0 0 600 500"）。

现在，如果您无法更改导出的 SVG，恐怕您就不走运了。你用什么图书馆？

# jquery - 将文本附加到属性而不是替换它？

> ID：644898
> 
> 赞同：24
> 
> 时间：2009-03-13T22:51:18.153
> 
> 标签：jquery

我想将一些文本附加到某个类的所有元素的标题属性中。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2016-07-04T04:23:18.547

我知道这个问题已经 7 岁了。以防万一有人遇到这个问题，这是不使用 .each 的解决方案：

```
$('.theclass').attr("title", function() { return $(this).attr("title") + "Appended text." }); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-13T22:53:45.463

在这种情况下，`$(this)`不是 的元素`$('.theclass')`。也许你想使用[`each`](http://docs.jquery.com/Core/each)：

```
$('.theclass').each(function() {
    $(this).attr("title", $(this).attr("title") + "Appended text.");
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-25T17:16:48.440

JQuery 已经来了。有一个版本的[.attr()](https://api.jquery.com/attr/#attr-attributeName-function)将函数作为值参数：

```
$('.theclass').attr('title', (i, value) => `${value || ""}appended text`); 
```

`i`是属性的索引，是属性`value`的当前值......可能没有设置，因此`value || ""`表达式，以避免转换`undefined`为丑陋的字符串`'Undefined'`。

# c# - 如何在 ASP.NET 中发送亚洲字符集纯文本电子邮件？

> ID：644900
> 
> 赞同：1
> 
> 时间：2009-03-13T22:51:55.190
> 
> 标签：c#, asp.net, email, unicode

我有一个需要用韩语发送电子邮件的 ASP.NET 应用程序。这些电子邮件以明文形式发送。

但是当收到电子邮件时，它们看起来像这样：

> ? 名？??: ?????。
> 
> ?? ？？？？？？?? ？？？？？？?? ？？？？？？？？？？？？????。？？？？？？？？？？？？？？？？？？??1-888-123-4567 ? ？？？？？？?? info@example.com ?? ？？？？？？？？？？？？？？？

目前我没有设置编码。只是使用默认值。理想情况下，我希望编码适用于各种电子邮件。希望我不必为每封电子邮件设置编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-14T04:26:51.250

您基本上有 2 种方法来编码电子邮件部分：

1.  为您的电子邮件使用韩语代码页面，以便不使用 Unicode 的人仍然可以查看它（像`ISO-2022-KR`和的字符集`x-windows-949`，我不知道这 3 个中哪个是最常见的）：

    ```
    Content-Type: text/plain;
    charset="EUC-KR"
    Content-Transfer-Encoding: quoted-printable 
    ```

2.  使用 UTF8 编码，这是当今的首选方式。
    在任何情况下，收件人必须[在他们的机器上安装对亚洲语言](http://www.microsoft.com/globaldev/handson/user/xpintlsupp.mspx)的适当支持，才能正确显示消息。

    ```
    Content-Type: text/plain; charset=UTF-8;
    Content-Transfer-Encoding: 8bit 
    ```

这里有几篇很好的文章解释了如何正确实现这一点：

*   [System.Web.Mail 常见问题解答](http://www.systemwebmail.com/faq/3.1.aspx)
*   [MIME 概述第一部分：MIME 规范的简要概述](http://www.aspnetmime.com/help/welcome/overviewmimei.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T03:22:01.000

尝试将电子邮件的编码设置为 UTF-8。

我认为这将是您在电子邮件标题中需要的行：

```
Content-Type: text/plain; charset=UTF-8 
```

希望这可以帮助

亚当

# iphone - 我的项目中的额外文件是否编译到我的程序中？

> ID：644902
> 
> 赞同：1
> 
> 时间：2009-03-13T22:52:09.027
> 
> 标签：iphone

假设我有一堆 PSD 和其他未在我的 xCode 项目中使用的大文件......当我编译时，它们会被添加到应用程序中吗？我需要将它们存放在其他地方吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T22:54:11.423

如果您不希望它们出现在您的 .app 文件中，我认为您可以将它们从目标的“复制捆绑资源”中删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-14T01:31:48.033

默认情况下，它们将被包括在内。如果您不希望这样，请执行以下操作：

1.  在 Xcode 项目窗口中，选择您不想包含的所有资源。
2.  点击工具栏上的蓝色大*i*按钮。
3.  转到目标选项卡。
4.  取消选中您应用的目标。

顺便说一句，如果您有一个不想编译的代码文件，这也有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T00:22:44.980

如果您想确定，请转到您的构建目录并打开 .app 包并查看文件是否在其中。在 Finder 中右键单击它并选择“显示包内容”

# javascript - 使用 jQuery 检测 Opera 的正确方法是什么？

> ID：644903
> 
> 赞同：15
> 
> 时间：2009-03-13T22:53:29.023
> 
> 标签：javascript, jquery, opera, browser-detection

Amazon.com 最近更新了他们的 javascript，这导致一些 Opera 浏览器出现问题。

他们的浏览器检测代码看起来像这样，但它是错误的：

```
 function sitbReaderIsCompatibleBrowser() {
        if (typeof(jQuery) == 'undefined') {
            return false;
        } else {
            var version = jQuery.browser.version || "0";
            var splitVersion = version.split('.');
            return (
                   (jQuery.browser.msie && splitVersion[0] >= 6)  // IE 6 and higher
                || (jQuery.browser.mozilla && (
                       (splitVersion[0] == 1 && splitVersion[1] >= 8) // Firefox 2 and higher
                    || (splitVersion[0] >= 2)
                   ))
                || (jQuery.browser.safari && splitVersion[0] >= 500) // Safari 5 and higher
                || (jQuery.browser.opera && splitVersion[0] >= 9) // Opera 5 and higher
            );
        }
} 
```

这段代码对我来说没有什么*明显*的错误，但我以前从未使用过 jQuery，所以我不知道。

尽管这段代码看起来像是试图让 Opera 用户通过，但当我使用 Opera 9.64 访问该页面时，我会收到“不支持的浏览器”消息。如果我更改 Opera 的设置以报告自己为 Firefox，则该页面可以完美运行！考虑到这一点，我很确定这是脚本而不是浏览器的问题。

任何 jQuery 专家有建议吗？

您可以通过访问亚马逊上的任何书籍并单击“查看本书内部”链接来复制该行为。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-13T23:46:13.297

在 jQuery 1.3 之前，您可以使用[jQuery.browser](http://docs.jquery.com/Utilities/jQuery.browser)：

```
if( $.browser.opera ){
  alert( "You're using Opera version "+$.browser.version+"!" );
} 
```

从 1.3 版开始，您应该改用[jQuery.support](http://docs.jquery.com/Utilities/jQuery.support)。

这样做的主要原因是应该避免检查浏览器，因为功能可能会因版本而异，从而使您的代码立即过时。

您应该始终尝试使用[特征检测](http://peter.michaux.ca/articles/feature-detection-state-of-the-art-browser-scripting)。这将允许您查看当前浏览器是否支持您尝试使用的功能，无论浏览器品牌、版本等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-09-28T08:10:45.797

所有 Opera 5+ 浏览器中都有一个特殊的**window.opera**对象。所以一些简单的事情：

```
if (window.opera && window.opera.buildNumber) { 
    // we are in Opera 
} 
```

就足够了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T23:08:04.027

我像这样检查 Opera：

```
if (/Opera/.test (navigator.userAgent)) // do something 
```

为什么要使用 jQuery？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T23:26:20.690

检测 javascript 功能比检测浏览器 userAgent 要好得多。

即 DOM、XmlHttpRequest、事件模型（event.target vs event.srcElement）、ActiveX、Java 等

通过专注于您将需要的 API 函数，而不是目标浏览器，您将创建一组更强大的脚本，并且不可避免地不那么特殊的大小写。

[歌剧](http://dev.opera.com/articles/view/using-capability-detection/)的这个链接可能会告诉你更多

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-23T05:51:11.413

Opera 自己的一个非常简单的方法：

```
if (window.opera) {
    //this browser is Opera
} 
```

来源： http: [//my.opera.com/community/openweb/idopera/](http://my.opera.com/community/openweb/idopera/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-20T19:46:26.587

亚马逊在 Opera 上失败的主要原因是因为已经从服务器端发送了不同的代码......如果您使用 Firefox 访问同一页面，然后保存该页面并在 Opera 中重新打开它，它工作正常......

但他们承诺在一月份的某个时候解决这个问题......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-30T09:07:12.690

我认为这种方式是最好的
if ( window.opera.version() == 12) { }
这个例子检查 Opera 版本是否为 12。当我在 Opera 中遇到字体问题时非常有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T23:14:15.697

我不确定（我从来没有真正检查过歌剧），但如果内置的 jQuery 功能没有检测到歌剧，则可能是 jQuery 的一个错误，需要修复。我怀疑如果是这样的话，它应该会很快得到解决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-28T08:28:21.147

在当前的 HTML5 时代，您也可以经常检查浏览器功能。

```
if (!window.FormData) { alert("xmlhttprequest L2 FormData interface not available"); } 
```

# visual-studio-2008 - 如何通过 Resharper 启动加速 VS2008？

> ID：644904
> 
> 赞同：0
> 
> 时间：2009-03-13T22:53:43.657
> 
> 标签：visual-studio-2008, resharper

毫无疑问，安装了 Resharper 后 VS2008 的启动时间增加了一倍以上。

有没有人找到任何方法来减轻 Resharper 的惩罚至少一点点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T22:56:27.423

我认为最好的方法是使用 SSD 驱动器或非常快的磁盘驱动器。不过我没有:-(

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T23:39:33.343

尝试[ReSharper 4.5 Nightly Builds](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds)，因为它们应该在性能和内存消耗方面更出色

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T23:04:55.283

我使用带有 8GB RAM 的 Vista Ultimate 64 位英特尔四核机器来加速它。:-)

可能更多的RAM会提高速度。你现在有多少？

我已经在具有 2GB RAM 的双核上使用了 Resharper，我可以肯定地说速度变慢了。

不过，我目前的机器上没有明显的性能影响。

# programming-languages - 第五代语言？

> ID：644915
> 
> 赞同：3
> 
> 时间：2009-03-13T22:57:23.007
> 
> 标签：programming-languages

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T23:05:33.550

“[第五代编程语言](http://en.wikipedia.org/wiki/Fifth-generation_programming_language)”是推动逻辑编程、约束编程和基于满足/统一的编程（如 Prolog）的尝试。天哪，那一定是80年代的事了。当我们认为日本正在接管并购买一切时，日本就有了一项重大举措。

通常的世代列表是：

1.  直接机器语言，戈尔茨坦和冯诺依曼
2.  汇编语言
3.  “高级”语言，从 FORTRAN、LISP 和 COBOL 开始。
4.  报告生成器语言（如 RPG）或 OO 编程
5.  第五代

我认为，今天的术语已经很不受欢迎了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T23:04:12.727

对于您的“离题”问题。我当然不是这个领域的专家，但根据我的经验，C# 拥有丰富的开发辅助资源，如视觉开发等，与 VB 非常相似，我很确定那里有一些很棒的免费资源。就 Java 而言，我无法胜任该语言，但我不记得它非常直观，但肯定更类似于 flash，然后是 PHP。

# emacs - 以交互方式更改 Emacs 中的帧宽度

> ID：644917
> 
> 赞同：13
> 
> 时间：2009-03-13T22:58:12.210
> 
> 标签：emacs

我知道您可以使用`set-frame-width`or更改 .emacs 文件中的框架大小，`(add-to-list 'default-frame-alist '(width . 80))`但是在 Emacs 启动后如何更改宽度（除了拖动框架的边缘）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-13T23:16:49.857

好吧，去`*scratch*`缓冲区并使用`set-frame-width`.

```
(set-frame-width (selected-frame) 100)  ;; ^J to execute. 
```

`set-frame-width`不是交互式的，所以你不能运行它，`M-x`但你可以简单地写一个 set-frame-width-interactive，比如

```
(defun set-frame-width-interactive (arg)
   (interactive "p")
   (set-frame-width (selected-frame) arg)) 
```

现在`C-u 8 0 M-x set-frame-width-interactive`将宽度设置为 80。

这是你想要做的吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T23:37:52.707

除了查理马丁的建议，你可以做

```
M-: (set-frame-width (selected-frame) N) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-14T03:43:07.780

这个库有一堆交互式命令供您使用： [http ://www.emacswiki.org/emacs/frame-cmds.el](http://www.emacswiki.org/emacs/frame-cmds.el)

以下是一些相关的：

```
enlarge-frame
enlarge-frame-horizontally
hide-frame
mouse-show-hide-mark-unmark
move-frame-down
move-frame-left
move-frame-right
move-frame-up
show-a-frame-on
show-frame
shrink-frame
shrink-frame-horizontally
tile-frames 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-16T12:02:41.820

要轻松地在两种帧大小之间切换，您可以定义类似的内容（例如，将其添加到“.emacs”文件中）（使大小适应您的屏幕和字体）

```
 (defvar myfullscreen '()
       "non-nil if current frame is in fullscreen mode. See myfullscreen-on, myfullscreen-off, myfullscreen-toggle")

     (defun myfullscreen-on ()
       "Sets fullscreen on (based on ???display??? with font ???)"
       (interactive)
       (set-frame-width (selected-frame) 177); adapt size
       (set-frame-height (selected-frame) 58); adapt size
       (setq myfullscreen t)
       )

     (defun myfullscreen-off ()
       "Sets fullscreen off (based on ???display??? with font ???)"  
       (interactive)
       (set-frame-width (selected-frame) 110); adapt size
       (set-frame-height (selected-frame) 58); adapt size
       (setq myfullscreen nil)
       )

     (defun myfullscreen-toggle ()
       "Toggles fullscreen on/off (based on ???Display??? with font ???)"    
       (interactive)
       (if (eq myfullscreen 'nil)
           (myfullscreen-on)
                                    ;else
         (myfullscreen-off)
         )
       ) 
```

然后，您可以使用

Mx myfullscreen-on

Mx myfullscreen-off

Mx myfullscreen-toggle

和/或将它们绑定到您最喜欢的键绑定

# java - 如何在 Java 中将图像叠加在一起？

> ID：644919
> 
> 赞同：2
> 
> 时间：2009-03-13T22:59:41.707
> 
> 标签：java, awt, overlay, drawimage

所以我一直在发帖，但还没有得到一个可靠的答案：

我创建了一个带有裁剪方法的图像大小调整类。种植效果很好。我遇到的问题是我在`drawImage`函数中指定的背景颜色`Graphics`无法正常工作。无论我提供什么（在这种情况下`Color.WHITE`），它默认为黑色作为背景。

此外，覆盖图像或最上面的图像（来自文件）正在反转（我认为是）或以其他方式变色。只是为了让您可以更好地概念化这一点，我正在拍摄一个 jpeg 并将其覆盖在一个新`BufferedImage`的顶部，新的缓冲图像的背景没有被设置。这是我正在使用的以下代码：

```
public void Crop(int Height, int Width, int SourceX, int SourceY) throws Exception {
    //output height and width
    int OutputWidth = this.OutputImage.getWidth();
    int OutputHeight = this.OutputImage.getHeight();

    //create output streams
    ByteArrayOutputStream MyByteArrayOutputStream = new ByteArrayOutputStream();
    MemoryCacheImageOutputStream MyMemoryCacheImageOutputStream = new MemoryCacheImageOutputStream(MyByteArrayOutputStream);

    //Create a new  BufferedImage
    BufferedImage NewImage = new BufferedImage(Width, Height, BufferedImage.TYPE_INT_RGB);
    Graphics MyGraphics = NewImage.createGraphics();

    MyGraphics.drawImage(this.OutputImage, -SourceX, -SourceY, OutputWidth, OutputHeight, Color.WHITE, null);

    // Get Writer and set compression
    Iterator MyIterator = ImageIO.getImageWritersByFormatName("png");
    if (MyIterator.hasNext()) {
        //get image writer
        ImageWriter MyImageWriter = (ImageWriter)MyIterator.next();

        //get params
        ImageWriteParam MyImageWriteParam = MyImageWriter.getDefaultWriteParam();

        //set outputstream
        MyImageWriter.setOutput(MyMemoryCacheImageOutputStream);

        //create new ioimage
        IIOImage MyIIOImage = new IIOImage(NewImage, null, null);

        //write new image
        MyImageWriter.write(null, MyIIOImage, MyImageWriteParam);
    }

    //convert output stream back to inputstream
    ByteArrayInputStream MyByteArrayInputStream = new ByteArrayInputStream(MyByteArrayOutputStream.toByteArray());
    MemoryCacheImageInputStream MyMemoryCacheImageInputStream = new MemoryCacheImageInputStream(MyByteArrayInputStream);

    //resassign as a buffered image
    this.OutputImage = ImageIO.read(MyMemoryCacheImageInputStream);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T00:43:46.120

您能否区分是 Graphics 方法还是 ImageIO 方法破坏了您的图像？看起来您可以通过短路整个 ImageIO 进程并简单地分配来测试这一点

```
this.OutputImage = NewImage; 
```

就此而言，我认为 ImageIO 操作会有所收获？在编写示例时，它似乎（理想情况下）是无操作的。

此外，您不要在开始 ImageIO 过程之前处置您的 Graphics2D。它通常没有什么区别，但你不想假设。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T21:26:51.040

关于叠加颜色失真问题，请确保您的图形上下文处于绘制模式而不是异或模式。(Graphics.setPaintMode())。否则，颜色位会被异或在一起。

# php - 允许 php 会话转移到子域

> ID：644920
> 
> 赞同：77
> 
> 时间：2009-03-13T23:00:00.253
> 
> 标签：php, apache, session, cookies

我对所有用户数据使用 php 会话（不是 cookie，会话 id cookie 除外），当用户访问他们的个人资料 user.mydomain.com 时，他们会立即“注销”，直到删除子域。

有没有办法接受来自所有域的会话，只要它的 *.mydomain.com

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-03-13T23:06:48.163

这里有 4 个选项。

把它放在你的 php.ini 中：

```
session.cookie_domain = ".example.com" 
```

或在您的 .htaccess 中：

```
php_value session.cookie_domain .example.com 
```

或者作为脚本中的第一件事：

```
ini_set('session.cookie_domain', '.example.com' ); 
```

或者在您站点的 php-fpm 池配置中：

```
php_value[session.cookie_domain] = .example.com 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-02-24T16:16:23.410

```
 if(isset($_COOKIE['session_id']))
            session_id($_COOKIE['session_id']);
        Zend_Session::start(); //or session_start();
        if(!isset($_COOKIE['session_id']))
            setcookie('session_id', session_id(), 0, '/', '.yourdomain.com'); 
```

该死的安全，如果你和我一样对不完整或错误的答案感到沮丧，这是你的救星。它只是工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-01-18T13:23:51.973

更改核心函数文件顶部的会话名称，例如

```
 session_name('mysession'); 
```

然后使用下面的代码进入php页面

```
 session_set_cookie_params(0,"/",".example.com",FALSE,FALSE);
  setcookie(session_name(), session_id(),0,"/","example.com");
  session_start(); 
```

最后更改子域的默认会话名称并删除子域核心函数文件中的默认 cookie，如：

```
 /*default session name*/
 session_name("mysession");
 /*remove the PHPSESSID and default session name from subdomain's cookie*/
 setcookie( "mysession", "",1,"/" );
 setcookie( "PHPSESSID", "",1,"/" ); 
```

如果您继续使用您的 cookie 名称作为 PHPSESSID ，只需删除所有函数

```
 "mysession" string like session_name('mysession'), setcookie( "mysession", "",1,"/" ); 
```

然后检查浏览器已有的cookies，把域和子域的cookies全部删除，重复上述过程。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-10T22:36:27.100

我知道这已经很老了——但为了进一步扩展@CTT 的建议——我需要在我的子域的每个子目录（将执行 php 代码并需要会话）中添加一个 php.ini 文件，其中包含以下文本：

```
suhosin.session.cryptdocroot=Off
suhosin.cookie.cryptdocroot=Off 
```

我希望这会有所帮助（我花了很长时间才弄清楚这一点）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-13T09:35:24.223

另一个对我有用的选项：强制会话名称：

```
session_name("myWebsite");
session_start(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-24T00:12:48.573

是的。`ini_set`正在工作中。但请记住销毁浏览器的所有缓存和 cookie 以查看它是否有效。

1.  销毁浏览器的所有缓存和 cookie
2.  在你的`xxx.example.com`and`yyy.example.com`中，你的 php 文件应该像这样开始。

    ```
    ini_set('session.cookie_domain', '.example.com' ); session_start(); 
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-03T18:57:57.710

我刚遇到这个问题，结果发现我为两个不同的子域使用了不同的 php.ini 文件。这些 ini 文件指定了不同的[session.save_path](http://php.net/manual/en/session.configuration.php#ini.session.save-path)变量。出于显而易见的原因，这对于需要共享会话的所有子域都必须相同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-13T02:12:31.193

在`session_start()`使用您的域`session_set_cookie_params()`替换*.domain.com*之前，如下例所示：

```
session_set_cookie_params(0, '/', '.domain.com');
session_start(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-06T12:25:18.007

尝试这个：

```
session_start(); 

$sessionId =  session_id(); 
```

记录了用户。当用户切换到其他子域时，会像这样在 URL 中发送会话 ID`user.mydomain.com/?id=$sessionId`

```
$sessionId =  $_GET['id'];

session_start($sessionId); 
```

现在用户将获得所有会话值并保持登录状态。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2013-01-10T09:08:17.407

```
if(isset($_COOKIE['session_id']))
    session_id($_COOKIE['session_id']);
    Zend_Session::start(); //or session_start();

    if(!isset($_COOKIE['session_id']))
        setcookie('session_id', session_id(), 0, '/', '.yourdomain.com'); 
```

这是一个很好的解决方案，但您不能在所有情况下都使用它。例如，当您不能依赖非会话 cookie 时，它​​将不起作用。

如果您正确使用它，这实际上必须有效。

```
ini_set('session.cookie_domain', '.example.com' ); 
```

例如，您需要将它放在之前`session_start()`以及所有调用的文件中`session_start()`

# version-control - 寻找可以生成差异报告的文档比较器

> ID：644929
> 
> 赞同：0
> 
> 时间：2009-03-13T23:04:56.997
> 
> 标签：version-control, documentation-generation, merge-tracking

我最近一直在使用名为“WinMerge”的应用程序进行文档比较，但我的团队脚本文件的一个要求（用于审计目的）是，当我们发布脚本的修订版时，我们会以红色突出显示更改（RTF 格式我相信，它是通过 Lotus Notes）为此，是否有任何软件可以自动为我突出显示更改，或者是最好的我将获得差异列表并期望手动突出显示所有更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T23:22:41.497

如果 HTML 报告是可接受的，Beyond Compare 可以生成突出差异的比较报告。您可以使用内置样式表或自定义的内部样式表将差异设置为红色（默认已经是浅红色）。

好像不能生成RTF，但也许html/css和rtf之间有简单的转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T00:59:54.477

假设 HTML+CSS 解决方案满足您的需求， Linux Journal 上的[这篇文章](http://www.linuxjournal.com/content/convert-diff-output-colorized-html)展示了一个 shell 脚本，该脚本读取差异输出并编写一个 HTML 文档，其中带有突出显示差异的彩色文本。

在 Windows 上，它可能会在 bash 下按原样工作，如[MinGW](http://www.mingw.org/)民间的[MSYS](http://www.mingw.org/wiki/msys)环境或[Cygwin](http://www.cygwin.com/)的 bash 中提供的那样。脚本本身并不太大，我想它可以通过适度的努力移植到 Perl。

由于将 HTML 转换为 RTF 并没有我发现的简单解决方案，因此将脚本移植到直接输出 RTF 可能会更好。

# c# - 数据访问层到业务对象的最佳“模式”

> ID：644941
> 
> 赞同：16
> 
> 时间：2009-03-13T23:11:42.427
> 
> 标签：c#, asp.net, design-patterns, data-access-layer

我试图找出最干净的方法来做到这一点。

目前我有一个客户对象：

```
public class Customer
{
    public int Id {get;set;}
    public string name {get;set;}
    public List<Email> emailCollection {get;set}
    public Customer(int id)
    {
        this.emailCollection = getEmails(id);
    }
} 
```

然后我的电子邮件对象也很基本。

```
public class Email
{
    private int index;
    public string emailAddress{get;set;}
    public int emailType{get;set;}
    public Email(...){...}
    public static List<Email> getEmails(int id)
    {
        return DataAccessLayer.getCustomerEmailsByID(id);
    }
} 
```

DataAccessLayer 当前连接到数据库，并使用 SqlDataReader 遍历结果集并创建新的 Email 对象并将它们添加到完成后返回的 List 中。

那么我在哪里以及如何改进呢？

我是否应该让我的 DataAccessLayer 返回一个 DataTable 并将其留给 Email 对象来解析并将 List 返回给客户？

我猜“Factory”可能是错误的词，但我应该有另一种类型的 EmailFactory，它从 DataAccessLayer 获取一个 DataTable 并将一个 List 返回给 Email 对象？我想那种听起来是多余的......

将我的 Email.getEmails(id) 作为静态方法是否是正确的做法？

我可能只是试图找到最好的“模式”并将其应用到通常是一项简单的任务中。

谢谢。

* * *

跟进

我创建了一个工作示例，其中我的域/业务对象通过 id 从现有数据库中提取客户记录。nhibernate 中的 xml 映射文件非常整洁。在我按照教程设置会话和存储库工厂之后，提取数据库记录非常简单。

但是，我注意到性能受到巨大影响。

我的原始方法包括数据库上的存储过程，由 DAL 对象调用，它将结果集解析为我的域/业务对象。

我用 30 毫秒的时间记录了我最初的方法来获取一条客户记录。然后，我将 nhibernate 方法计时为 3000 毫秒以获取相同的记录。

我错过了什么吗？或者使用这条休眠路由是否有很多开销？

否则我喜欢代码的简洁性：

```
protected void Page_Load(object sender, EventArgs e)
{
    ICustomerRepository repository = new CustomerRepository();
    Customer customer = repository.GetById(id);
}

public class CustomerRepository : ICustomerRepository
        {
            public Customer GetById(string Id)
            {
                using (ISession session = NHibernateHelper.OpenSession())
                {
                    Customer customer = session
                                        .CreateCriteria(typeof(Customer))
                                        .Add(Restrictions.Eq("ID", Id))
                                        .UniqueResult<Customer>();
                    return customer;
                }
            }
        } 
```

[我遵循](http://web.archive.org/web/20090805054123/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/01/your-first-nhibernate-based-application.aspx)的示例让我创建了一个帮助类来帮助管理会话，也许这就是我得到这个开销的原因？

```
public class NHibernateHelper
    {
        private static ISessionFactory _sessionFactory;
        private static ISessionFactory SessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
                    Configuration cfg = new Configuration();
                    cfg.Configure();
                    cfg.AddAssembly(typeof(Customer).Assembly);
                    _sessionFactory = cfg.BuildSessionFactory();
                }
                return _sessionFactory;
            }

        }

        public static ISession OpenSession()
        {
            return SessionFactory.OpenSession();
        }
    } 
```

对于我正在开发的应用程序，速度至关重要。最终，大量数据将在网络应用程序和数据库之间传递。如果代理需要 1/3 秒来提取客户记录而不是 3 秒，那将是一个巨大的打击。但是，如果我正在做一些奇怪的事情并且这是一次性的初始设置成本，那么如果性能与在数据库上执行存储过程一样好，那么它可能是值得的。

仍然愿意接受建议！

* * *

更新。

我正在废弃我的 ORM/NHibernate 路线。我发现性能太慢了，无法证明使用它是合理的。对于我们的环境来说，基本的客户查询需要的时间太长了。与亚秒级响应相比，3 秒太多了。

如果我们想要慢速查询，我们只需保留当前的实现。重写它的想法是大幅增加时间。

然而，在上周玩过 NHibernate 之后，它是一个很棒的工具！它只是不太适合我对这个项目的需求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T23:17:38.513

如果您的配置现在可以工作，为什么要搞砸呢？听起来您并没有确定代码的任何特定需求或问题。

我敢肯定，一堆 OO 类型可能会挤在一起，并在这里提出各种重构建议，以便尊重正确的职责和角色，甚至有人可能会试图硬塞一两个设计模式。但是您现在拥有的代码很简单，听起来没有任何问题 - 我会说离开它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T23:34:53.103

我通过基本上做 NHibernate 所做的但手动实现了一个 DAL 层。NHibernate 所做的是创建一个继承自域对象的代理类（它的所有字段都应标记为虚拟）。所有数据访问代码都进入属性覆盖，实际上它非常优雅。

我通过让我的存储库自己填写简单属性并仅使用延迟加载代理来简化这一点。我最终得到的是一组这样的类：

```
public class Product {
  public int Id {get; set;}
  public int CustomerId { get; set;}
  public virtual Customer Customer { get; set;}
}
public class ProductLazyLoadProxy {
  ICustomerRepository _customerRepository;
  public ProductLazyLoadProxy(ICustomerRepository customerRepository) {
    _customerRepository = customerRepository;
  }
  public override Customer {
    get {
      if(base.Customer == null)
        Customer = _customerRepository.Get(CustomerId);
      return base.Customer
    }
    set { base.Customer = value; }
  }
}
public class ProductRepository : IProductRepository {
  public Product Get(int id) {
    var dr = GetDataReaderForId(id);
    return new ProductLazyLoadProxy() {
      Id = Convert.ToInt(dr["id"]),
      CustomerId = Convert.ToInt(dr["customer_id"]),
    }
  }
} 
```

但是在写了大约 20 篇之后，我就放弃并学习了 NHibernate，现在使用 Linq2NHibernate 进行查询，使用 FluentNHibernate 进行配置，现在的障碍比以往任何时候都低。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T23:40:31.250

这对您来说可能过于激进，并不能真正解决问题，但是完全废弃您的数据层并选择 ORM 怎么样？您将节省大量代码冗余，而在 DAL 上花费一周左右会带来。

除此之外，您使用的模式有点类似于存储库模式。我会说你的选择是

*   您的 Email 类中的服务对象 - 例如 EmailService - 在构造函数或属性中实例化。通过 email.Service.GetById(id) 等实例访问
*   电子邮件上的静态方法，例如 Email.GetById(id) ，这是一种类似的方法
*   一个完全独立的静态类，基本上是一个外观类，例如 EmailManager，具有像 EmailManager.GetById(int) 这样的静态方法
*   处理实例的 ActiveRecord 模式，例如 email.Save() 和 email.GetById()

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T23:43:53.677

[您的应用程序很可能在事务脚本](http://martinfowler.com/eaaCatalog/transactionScript.html)中设置了域逻辑。对于使用事务脚本的 .NET 实现，Martin Fowler 建议使用[表数据网关](http://martinfowler.com/eaaCatalog/tableDataGateway.html)模式。.NET 为这种模式提供了很好的支持，因为表数据网关模式非常适合[记录集](http://martinfowler.com/eaaCatalog/recordSet.html)，Microsoft 使用其 DataSet 类型的类来实现记录集。

Visual Studio 环境中的各种工具应该可以提高您的工作效率。DataSet 可以轻松地与各种控件（如 DataGridView）进行数据绑定，这一事实使其成为数据驱动应用程序的理想选择。

如果您的业务逻辑比一些验证更复杂，那么[域模型](http://martinfowler.com/eaaCatalog/domainModel.html)将成为一个不错的选择。请注意，域模型带有一组完全不同的数据访问要求！

# visual-studio-2008 - 为什么财产在ankhsvn中不起作用？

> ID：644944
> 
> 赞同：1
> 
> 时间：2009-03-13T23:12:42.423
> 
> 标签：visual-studio-2008, version-control, ankhsvn

我在 VS.NET 2008 中使用 Ankhsvn v2.0.6347.433。一切正常。我从 TotioseSVN 导入了一个 .svnprops 文件。这是在 Windows 资源管理器中通过右键单击根 svn 文件夹，选择 Subversion 选项卡、属性和导入来完成的。导入文件过滤器从 svnprops 开始。导入后，提交对话框现在可以输入错误 ID。通过 Tortoise 提交时，它工作正常。查看日志历史记录会显示带有值的错误 ID 列。

AnkhSVN 也显示错误 ID 框。但是，即使输入了一个值，在查看历史记录时也不会转换为 Bug ID 列。AnkhSVN 忽略错误 ID 值。

这是我在 AnkhSVN 添加/编辑属性窗口中输入的属性，后跟值：

```
 bugtraq:label    Bug ID:
   bugtraq:message    Bug ID: %BUGID%
   bugtraq:url      http//bugserver/view.php?id=%BUGID%
   bugtraq:warnifnoissue    true 
```

该 URL 使错误 ID 可从评论中单击。在 TortioseSVN 中一切正常。关于如何让 AnkhSVN 做同样的事情的任何建议？有没有办法通过 AnkhSVN 导入 .svnprops？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T16:42:35.273

AnkhSVN 还没有问题专栏。我们正在努力，但我们一次只能实现有限数量的功能。

实现此功能后，我将更新此答案。

随意打开关于此主题的[AnkhSVN UserVoice建议。](http://ankhsvn.uservoice.com)

# wpf - Local Database vs Service-based database when building a WPF Client application

> ID：644947
> 
> 赞同：1
> 
> 时间：2009-03-13T23:15:01.920
> 
> 标签：wpf, database

I'm building a simple WPF client application that is going to store data locally. My question is Local Database enough? I don't know the amount but there could be a few lines in the future when I'm tracking time.

Except some performances issues like stored procedures what else do I lose when choosing the local version? I'm boxing myself in a corner?

Pros with local: Easy deployment, don't need a SQL express installed

Cons: Has limitations. But how limited am I?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-14T03:42:02.590

The question you need to ask yourself is:

> "What is the purpose of my application?"

If you answer includes one of the following:

*   The application collects and stores data from users that will be consumed by one or more other users.
*   The data I collect will have a lifespan longer than any single installation of my application
*   A user of my application needs to be able to access their data from any machine on which they install the application.

you're going to need a remote centralized service for storing your data. If not, then storing your data locally is probably okay.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T11:30:19.827

To store data locally you can use the [SQL Server 2008 Compact](http://www.microsoft.com/Sqlserver/2008/en/us/compact.aspx) database engine that is is simple to deploy because you just need to copy a couple of files. It does not have all the capabilities of the full SQL Server but then it has the major benefit of being free!

# c# - 从 C# 中的串行端口读取

> ID：644954
> 
> 赞同：12
> 
> 时间：2009-03-13T23:19:22.500
> 
> 标签：c#, compact-framework, serial-port

我尝试使用 Readline() 并且数据被丢弃，我尝试使用 Read() 但我不确定如何使用防错方法，因为我可能会一个接一个地收到几个数据包，而我无法知道会有另一个数据包进来。在数据包之间 BytesToRead 是 0，所以我不能使用它。当向缓冲区读取数据时，您有一个计时器还是让线程进入睡眠状态以允许所有数据包到达？

我搞不清楚了。不知道下一步该尝试什么。

我应该提一下，我不能保证从串行端口出来的字符串将以 \n 或 \r 或 \r\n 结尾。当用户按下 PRINT 时，我只需要一种简单的方法来读取来自秤的所有数据包。

有人在这里回答了我喜欢的想法 - 为所有数据包等待一定的时间，但他们删除了他们的答案。你有机会重新发布吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-13T23:28:38.143

你试过听课堂上的[`DataRecieved`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx)活动[`SerialPort`](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)吗？

```
public class MySerialReader : IDisposable
{
    private SerialPort serialPort;
    private Queue<byte> recievedData = new Queue<byte>();

    public MySerialReader()
    {
        serialPort = new SerialPort();
        serialPort.Open();

        serialPort.DataReceived += serialPort_DataReceived;
    }

    void serialPort_DataReceived(object s, SerialDataReceivedEventArgs e)
    {
        byte[] data = new byte[serialPort.BytesToRead];
        serialPort.Read(data, 0, data.Length);

        data.ToList().ForEach(b => recievedData.Enqueue(b));

        processData();
    }

    void processData()
    {
        // Determine if we have a "packet" in the queue
        if (recievedData.Count > 50)
        {
            var packet = Enumerable.Range(0, 50).Select(i => recievedData.Dequeue());
        }
    }

    public void Dispose()
    {
        if (serialPort != null)
            serialPort.Dispose();
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-14T00:00:55.583

我们不久前经历了同样的过程。

读取“数据包”的唯一方法是了解它们在流中的开始和结束位置。

来自[msdn](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.readexisting(VS.80).aspx)：

> 因为 SerialPort 类缓冲数据，而 BaseStream 属性中包含的流不缓冲，所以两者可能会在有多少字节可供读取方面发生冲突。BytesToRead 属性可以指示有要读取的字节，但 BaseStream 属性中包含的流可能无法访问这些字节，因为它们已缓冲到 SerialPort 类。

我们使用后台线程（您可以使用 BackgroundWorker）将数据读入缓冲区。如果您无法使用 SerialPort.Newline 属性可靠地设置终止字符（因为它会有所不同！）那么您将需要实现自己的数据包检测系统，因为您将无法使用阻塞 SerialPort.Readline()方法。

您可以使用 SerialPort.Read() （或使用 SerialPort.ReadExisting() 方法的字符串）读取字节缓冲区，并在检测到数据中的有效数据包时生成事件。请注意， Read() （我假设 ReadExisting() ）清空 SerialPort 的缓冲区，因此您需要将数据保存在其他地方。

如果您设置 SerialPort.ReadTimeout，您可以处理 TimeoutException 并有一种简单的方法来处理您的设备不传输的情况。如果您使用固定数量的字节或其他一些非终止方案，这是重置数据包检测的好方法。（如果您不需要部分数据包，请在超时时使用 SerialPort.DiscardInBuffer()）。

祝你好运

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-29T11:37:14.503

由于字节可能随时进入，缓冲传入数据至关重要。所以你应该

1.  缓冲传入的数据
2.  扫描缓冲区以查找完整数据
3.  从缓冲区中删除使用的数据

我只是想知道您是否仍然遇到串行端口问题。如果是这样，我用 C# 开发了一种串行端口编程语言，我相信它几乎可以解决每个人遇到的所有问题。

请您看一下并尝试一下好吗？例如; 您可以像下面这样缓冲来自串行端口的传入数据并轻松执行字符串操作。

```
state Init
  // define a global variable
  our $BUFFER = "";
  jump(Receive);
end state

state Receive
  recv();
  $len = length($DATA_PACKET);
  if("$len > 0") {
    $BUFFER += $DATA_PACKET;
    call(Parser);
  }
end state

state Parser
  // check if buffer matchs regular expression pattern
  if(match($BUFFER, "(?<WILLDELETE>.*?<STX>(?<DATA>.*?)<ETX>(?<CHECKSUM>[0-9A-F]{2}))")) {
    // Received complete data
    $lenData = length($WILLDELETE);
    $BUFFER = remove($BUFFER, 0, $lenData);

    // Do operations with the other parsed fields. $DATA and $CHECKSUM in this example.
  }
end state 
```

该项目在 sourceforge 上免费提供，如果您有任何问题，请随时提问。

[项目主页](http://sourceforge.net/projects/anyserialport/)

[下载链接](http://sourceforge.net/projects/anyserialport/)

# c# - 从sql server返回奇怪的结果

> ID：644962
> 
> 赞同：1
> 
> 时间：2009-03-13T23:24:03.880
> 
> 标签：c#, .net, asp.net, sql-server, ado.net

我正在处理我的项目，并且使用 asp.net C# 和返回标量变量的存储过程产生了奇怪的结果。简而言之，我试图返回用户名，但是我只得到名称的第一个字母，这很奇怪。

我经历了几十次代码；但是我仍然找不到错误。如果有人能找到我的赌注，我将不胜感激

这是我的存储过程：

```
set ANSI_NULLS ON
GO
set QUOTED_IDENTIFIER ON
go

ALTER PROCEDURE [one_two].[team5GetLostPassword]
(
    @user_password varchar(50),
    @email varchar(50),
    @user_name varchar(50) out,
    @user_exist int out
)
AS
BEGIN
    declare @user_fname varchar(50);
    declare @user_lname varchar(50);
    declare @user_id int;

    set @user_exist = 0;
    SET NOCOUNT ON;

    IF EXISTS(select user_email from team5_user_detail where user_email LIKE @email)
    begin
        set @user_id = (select userid from team5_user_detail where user_email Like @email);
        update team5_user Set user_password = @user_password where userid = @user_id;
        set @user_name = (select user_lname from team5_user_detail where userid = @user_id);
        set @user_exist = 1;
    end
END 
```

和我的 C# 代码

```
protected bool IsValidUser()
{
    myConn = new SqlConnection(myConStr);
    myCommand = new System.Data.SqlClient.SqlCommand("team5GetLostPassword", myConn);
    myCommand.CommandType = CommandType.StoredProcedure;
    myCommand.Parameters.AddWithValue("@user_password", userPasswordEncrypted);
    myCommand.Parameters.AddWithValue("@email", userEmailString);

    myCommand.Parameters.AddWithValue("@user_name", "").Direction = ParameterDirection.Output;
    myCommand.Parameters.AddWithValue("@user_exist", 0).Direction = ParameterDirection.Output;

    try
    {
        myConn.Open();
        myCommand.ExecuteScalar();
        userExist = myCommand.Parameters["@user_exist"].Value.ToString();
        userName = myCommand.Parameters["@user_name"].Value.ToString();
    }
    catch (Exception exep)
    {
    }
    finally
    {
        myConn.Close();
    }

    if (userExist.Contains("1"))
        return true;
    else
        return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T23:29:23.070

您需要将 SqlParameter 的 Size 属性设置为要返回的数据长度。

在这种情况下，我认为您不想使用 ExecuteScalar() 。当您想要返回结果集中第一行的第一列时，使用 ExecuteScalar()。由于您正在尝试从输出参数中获取值，因此您希望使用 ExecuteNonQuery()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T23:32:50.580

尝试将用户名参数的 Length 属性设置为 50。

# c# - 实现 IXmlSerializable 时，如何仅覆盖 ReadXml 或 WriteXml 而不是两者？

> ID：644964
> 
> 赞同：11
> 
> 时间：2009-03-13T23:25:37.587
> 
> 标签：c#, .net, xml, serialization

我想在一个类上实现 IXmlSerializable 并且只覆盖 ReadXml 或 WriteXml，但不能同时覆盖两者。如果我没有在这个类上实现 IXMLSerializable，XMLSerializer 会自动序列化所有成员。我希望该默认行为适用于未覆盖的情况。但是，由于 IXmlSerializable 是一个接口，而不是一个基类，我不知道该怎么做。

此外，在一种情况下，我需要执行默认行为，并在完成后添加一些额外的代码。所以，我想覆盖并回调“基”类行为。同样，如果有一个基类，这将是微不足道的，但不是那么微不足道，因为这是一个接口。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-14T14:27:50.237

属性提供了在序列化/反序列化之前/之后执行操作的能力。[使用OnDeserializedAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ondeserializedattribute.aspx)标记一个方法，以便在反序列化实例后调用它，只需确保该方法具有正确的签名：

```
[OnDeserializedAttribute()]
private void RunThisMethod(StreamingContext context) { 
  // ...
} 
```

注意。此属性适用于 Binary、SOAP 和 DataAttribute 格式化程序，但*不适*用于 XmlSerializer。除了实现 IXmlSerializable 之外，没有其他属性或机制。

另外不要忘记您可以直接读取 XML 文档并编写代码来（反）序列化。

* * *

原始答案：如果您需要完全覆盖序列化或反序列化之一（并因此实现，`IXmlSerializable`那么您必须自己做这两件事。

可以使用属性和其他机制来避免使用`IXmlSerializable`，您能否详细说明*为什么*只需要实现`ReadXml`or之一的问题`WriteXml`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T23:29:34.880

您将需要实现这两种方法，但这是您的全部责任（就编译器而言）。您可以在将不使用的方法中返回 null 或引发异常。

**编辑**

```
我希望默认行为适用于非覆盖案例。
```

你指的是什么默认行为？由于您正在实现一个接口，因此没有默认行为。

# .net - 发布 clickonce 应用程序时失败

> ID：644967
> 
> 赞同：1
> 
> 时间：2009-03-13T23:26:46.867
> 
> 标签：.net, wpf, clickonce

尝试发布 wpf clickonce 应用程序时出现以下错误。

错误 1 ​​发布失败，出现以下错误：无法将类型为“EnvDTE.DTEClass”的 COM 对象转换为接口类型“Microsoft.VisualStudio.OLE.Interop.IServiceProvider”。此操作失败，因为 IID 为“{6D5140C1-7436-11CE-8034-00AA006009FA}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（HRESULT 异常：0x80004002 (E_NOINTERFACE)） .

如果我尝试发布到 FTP 站点以及尝试发布到本地文件系统，则会发生错误。

有任何想法吗？谷歌搜索似乎没有产生任何有用的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T10:01:16.220

EnvDTE.DTEClass 是一些应该由 Visual Studio 提供的功能。我有几个建议：

1.  创建一个新的 WinForms 项目（只是一个空表单）并尝试发布它。
2.  尝试修复或重新安装 VS
3.  查看从命令行[构建 ClickOnce 应用程序](http://msdn.microsoft.com/en-us/library/ms165431(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-18T18:02:05.417

在我的情况下，只需运行以下命令即可解决此 EXACT 错误：

```
regsvr32  "C:\Program Files (x86)\Internet Explorer\ieproxy.dll" 
```

或对于 32 位窗口：

```
regsvr32 "C:\Program Files\Internet Explorer\ieproxy.dll" 
```

更多信息：问题原来是 IServiceProvider 的注册失败。代理存根 CLSID 错误（它指的是 actxprxy.dll 而不是 Windows 7 x64 上的 ieproxy.dll）。

摘自：http: [//blogs.msdn.com/b/smondal/archive/2012/10/02/unable-to-cast-com-object-of-type-system-comobject-to-interface-type-microsoft -visualstudio-ole-interop-iserviceprovider.aspx](http://blogs.msdn.com/b/smondal/archive/2012/10/02/unable-to-cast-com-object-of-type-system-comobject-to-interface-type-microsoft-visualstudio-ole-interop-iserviceprovider.aspx)

# sql - 在 Oracle 中删除大量数据

> ID：644975
> 
> 赞同：15
> 
> 时间：2009-03-13T23:31:02.240
> 
> 标签：sql, oracle, plsql

确切地说，我不是数据库人，而且我的大部分数据库工作都是使用 MySQL 的，所以如果这个问题中的某些内容非常幼稚，请原谅我。

我需要从一个大约有 1 亿行的 Oracle 表中删除 550 万行。我有我需要在临时表中删除的行的所有 ID。如果它只有几千行，我会这样做：

```
DELETE FROM table_name WHERE id IN (SELECT id FROM temp_table);
COMMIT; 
```

有什么我需要注意和/或做不同的事情，因为它有 550 万行吗？我想过做一个循环，像这样：

```
DECLARE
  vCT NUMBER(38) := 0;

BEGIN
  FOR t IN (SELECT id FROM temp_table) LOOP
    DELETE FROM table_name WHERE id = t.id;
    vCT := vCT + 1;
    IF MOD(vCT,200000) = 0 THEN
      COMMIT;
    END IF;
  END LOOP;
  COMMIT;
END; 
```

首先 - 这是在做我认为的 - 一次批处理 200,000 个提交吗？假设是这样，我仍然不确定是生成 550 万条 SQL 语句并分批提交 200,000 条，还是有一条 SQL 语句并一次提交所有更好。

想法？最佳实践？

**编辑**：我运行了第一个选项，即单个删除语句，在开发中只花了 2 个小时就完成了。基于此，它排队等待在生产中运行。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-13T23:56:43.333

第一种方法更好，因为您可以让查询优化器清楚地了解您正在尝试做什么，而不是试图隐藏它。数据库引擎可能会采用不同的方法在内部删除 5.5m（或表的 5.5%）而不是删除 200k（或 0.2%）。

这里还有[一篇](http://www.devx.com/dbzone/10MinuteSolution/22191)关于 Oracle 中大量删除的文章，您可能想阅读。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T23:33:44.120

最快的方法是`CREATE TABLE AS SELECT`使用`NOLOGGING`选项创建一个新的。我是说：

```
ALTER TABLE table_to_delete RENAME TO tmp;
CREATE TABLE table_to_delete NOLOGGING AS SELECT .... ; 
```

当然，您必须重新创建不带验证的约束、不带日志记录的索引、授权……但速度非常快。

如果您在生产中遇到问题，您可以执行以下操作：

```
ALTER TABLE table_to_delete RENAME to tmp;
CREATE VIEW table_to_delete AS SELECT * FROM tmp;
-- Until there can be instantly
CREATE TABLE new_table NOLOGGING AS SELECT .... FROM tmp WHERE ...;
<create indexes with nologging>
<create constraints with novalidate>
<create other things...>
-- From here ...
DROP VIEW table_to_delete;
ALTER TABLE new_table RENAME TO table_to_delete;
-- To here, also instantly 
```

你已经照顾：

*   存储过程可以失效，但它们会在第二次被调用时重新编译。你必须测试它。
*   `NOLOGGING`意味着生成**最少的**重做。如果您具有 DBA 角色，请运行 a`ALTER SYSTEM CHECKPOINT`以确保在实例崩溃时不会丢失数据。
*   对于`NOLOGGING`表空间也必须在`NOLOGGING`.

另一个比创建数百万个插入更好的选择是：

```
-- Create table with ids
DELETE FROM table_to_delete
 WHERE ID in (SELECT ID FROM table_with_ids WHERE ROWNUM < 100000);
DELETE FROM table_with_ids WHERE ROWNUM < 100000;
COMMIT;
-- Run this 50 times ;-) 
```

不建议选择 PLSQL，因为可能会创建*Snapshot too old*消息，因为您正在使用打开的游标（循环游标）提交（并关闭事务），您希望继续使用它。Oracle 允许这样做，但这不是一个好的做法。

更新：为什么我可以确保最后一个 PLSQL 块能够工作？因为我认为：

*   没有其他人出于任何原因使用这个临时表（dba 或收集统计信息的作业、移动、插入记录等 dab 任务）。这是可以确保的，因为这是一个仅用于此的辅助表。
*   然后，使用最后一个断言，查询将*完全*按照相同的计划执行，并将返回具有相同顺序的行。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-16T11:22:27.640

在 中执行大量删除时`Oracle`，请确保您没有用完`UNDO SEGMENTS`.

执行时`DML`，`Oracle`首先将所有更改写入`REDO`日志（旧数据连同新数据）。

当`REDO`日志被填满或发生超时时，`Oracle`执行`log synchronization`：它将数据写入`new`数据文件（在您的情况下，将数据文件块标记为空闲），并将旧数据写入`UNDO`表空间（以便它对并发事务保持可见，直到您`commit`您的更改）。

当您提交更改时，您的`UNDO`事务占用的段中的空间被释放。

这意味着，如果您删除`5M`数据行，您需要`all`在段中为这些行留出空间，`UNDO`以便数据可以先移到那里 ( `all at once`) 并仅在提交后删除。

这也意味着并发查询（如果有）在执行表扫描时需要从`REDO`日志或段中读取。`UNDO`这不是访问数据的最快方式。

这也意味着如果优化器将为`HASH JOIN`您的删除查询选择（它很可能会这样做），并且临时表不适合`HASH_AREA_SIZE`（很可能是这种情况），那么查询将需要`several`扫描大表，并且表的某些部分将已经移入`REDO`or `UNDO`。

**鉴于上述所有内容，您可能最好分`200,000`块删除数据并提交其间的更改。**

因此，首先，您将摆脱上述问题，其次，优化您的`HASH_JOIN`，因为您将拥有相同数量的读取，但读取本身将更有效率。

但是，在您的情况下，我会尝试强制优化器使用`NESTED LOOPS`，因为我希望在您的情况下它会更快。

为此，请确保您的临时表有一个主键 on `ID`，并重写您的查询如下：

```
DELETE  
FROM   (
       SELECT  /*+ USE_NL(tt, tn) */
               tn.id
       FROM    temp_table tt, table_name tn
       WHERE   tn.id = tt.id
       ) 
```

您需要打开主键`temp_table`才能使此查询起作用。

将其与以下内容进行比较：

```
DELETE  
FROM   (
       SELECT  /*+ USE_HASH(tn tt) */
               tn.id
       FROM    temp_table tt, table_name tn
       WHERE   tn.id = tt.id
       ) 
```

，看看什么更快并坚持下去。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-13T23:38:13.160

最好像第一个示例一样一次完成所有操作。但是我肯定会先与您的 DBA 一起讨论它，因为他们可能想要回收您在清除后不再使用的块。此外，可能存在从用户角度来看通常不可见的调度问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-14T06:04:21.310

如果您的原始 SQL 需要很长时间，一些并发 SQL 可能会运行缓慢，因为它们必须使用 UNDO 来重建数据的一个版本，而无需您未提交的更改。

妥协可能是这样的

```
FOR i in 1..100 LOOP
  DELETE FROM table_name WHERE id IN (SELECT id FROM temp_table) AND ROWNUM < 100000;
  EXIT WHEN SQL%ROWCOUNT = 0;
  COMMIT;
END LOOP; 
```

您可以根据需要调整 ROWNUM。较小的 ROWNUM 意味着更频繁的提交，并且（可能）在需要应用撤消方面减少对其他会话的影响。但是，根据执行计划，可能会有其他影响，总体上可能需要更多时间。从技术上讲，循环的“FOR”部分是不必要的，因为 EXIT 将结束循环。但是我对无限循环很偏执，因为如果它们确实卡住了，终止会话会很痛苦。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-14T21:17:35.197

我建议将其作为单个删除运行。

您要从中删除的表是否有任何子表？如果是这样，请确保这些表中的外键已编入索引。否则，您可能会为删除的每一行对子表进行全面扫描，这可能会使事情变得非常缓慢。

您可能需要一些方法来检查删除运行时的进度。请参阅[如何检查 oracle 数据库以进行长时间运行的查询？](https://stackoverflow.com/questions/622289/how-to-check-oracle-database-for-long-running-queries)

正如其他人所建议的，如果你想试水，你可以在查询的末尾加上：rownum < 10000。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T03:04:06.417

过去我用 Oracle 7 做过类似的事情，我不得不从数千个表中删除数百万行。对于全面的性能，尤其是大删除（百万行加上一个表），这个脚本运行良好。

您必须稍微修改它（即：检查用户/密码，加上正确的回滚段）。此外，您确实需要与您的 DBA 讨论这个问题，并首先在 TEST 环境中运行它。说了这么多，其实很简单。函数**delete_sql()**在您指定的表中查找一批 rowid，然后逐批删除它们。例如;

```
exec delete_sql('MSF710', 'select rowid from msf710 s where  (s.equip_no, s.eq_tran_date, s.comp_data, s.rec_710_type, s.seq_710_no) not in  (select c.equip_no, c.eq_tran_date, c.comp_data, c.rec_710_type, c.seq_710_no  from  msf710_sched_comm c)', 500); 
```

上面的例子是基于一条 sql 语句从表 MSF170 中一次删除 500 条记录。

如果您需要从多个表中删除数据，只需`exec delete_sql(...)`在文件 delete-tables.sql 中包含其他行

哦，记得把你的回滚段重新上线，它不在脚本中。

```
spool delete-tables.log;
connect system/SYSTEM_PASSWORD
alter rollback segment r01 offline;
alter rollback segment r02 offline;
alter rollback segment r03 offline;
alter rollback segment r04 offline;

connect mims_3015/USER_PASSWORD

CREATE OR REPLACE PROCEDURE delete_sql (myTable in VARCHAR2, mySql in VARCHAR2, commit_size in number) is
  i           INTEGER;
  sel_id      INTEGER;
  del_id      INTEGER;
  exec_sel    INTEGER;
  exec_del    INTEGER;
  del_rowid   ROWID;

  start_date  DATE;
  end_date    DATE;
  s_date      VARCHAR2(1000);
  e_date      VARCHAR2(1000);
  tt          FLOAT;
  lrc         integer;

BEGIN
  --dbms_output.put_line('SQL is ' || mySql);
  i := 0;
  start_date:= SYSDATE;
  s_date:=TO_CHAR(start_date,'DD/MM/YY HH24:MI:SS');

  --dbms_output.put_line('Deleting ' || myTable);
  sel_id := DBMS_SQL.OPEN_CURSOR;
  DBMS_SQL.PARSE(sel_id,mySql,dbms_sql.v7);
  DBMS_SQL.DEFINE_COLUMN_ROWID(sel_id,1,del_rowid);
  exec_sel := DBMS_SQL.EXECUTE(sel_id);
  del_id := DBMS_SQL.OPEN_CURSOR;
  DBMS_SQL.PARSE(del_id,'delete from ' || myTable || ' where rowid = :del_rowid',dbms_sql.v7);
 LOOP
   IF DBMS_SQL.FETCH_ROWS(sel_id) >0 THEN
      DBMS_SQL.COLUMN_VALUE(sel_id,1,del_rowid);
      lrc := dbms_sql.last_row_count;
      DBMS_SQL.BIND_VARIABLE(del_id,'del_rowid',del_rowid);
      exec_del := DBMS_SQL.EXECUTE(del_id);

      -- you need to get the last_row_count earlier as it changes.
      if mod(lrc,commit_size) = 0 then
        i := i + 1;
        --dbms_output.put_line(myTable || ' Commiting Delete no ' || i || ', Rowcount : ' || lrc);
        COMMIT;
      end if;
   ELSE 
       exit;
   END IF;
 END LOOP;
  i := i + 1;
  --dbms_output.put_line(myTable || ' Final Commiting Delete no ' || i || ', Rowcount : ' || dbms_sql.last_row_count);
  COMMIT;
  DBMS_SQL.CLOSE_CURSOR(sel_id);
  DBMS_SQL.CLOSE_CURSOR(del_id);

  end_date := SYSDATE;
  e_date := TO_CHAR(end_date,'DD/MM/YY HH24:MI:SS');
  tt:= trunc((end_date - start_date) * 24 * 60 * 60,2);
  dbms_output.put_line('Deleted ' || myTable || ' Time taken is ' || tt || 's from ' || s_date || ' to ' || e_date || ' in ' || i || ' deletes and Rows = ' || dbms_sql.last_row_count);

END;
/

CREATE OR REPLACE PROCEDURE delete_test (myTable in VARCHAR2, mySql in VARCHAR2, commit_size in number) is
  i integer;
  start_date DATE;
  end_date DATE;
  s_date VARCHAR2(1000);
  e_date VARCHAR2(1000);
  tt FLOAT;
BEGIN
  start_date:= SYSDATE;
  s_date:=TO_CHAR(start_date,'DD/MM/YY HH24:MI:SS');
  i := 0;
  i := i + 1;
  dbms_output.put_line(i || ' SQL is ' || mySql);
  end_date := SYSDATE;
  e_date := TO_CHAR(end_date,'DD/MM/YY HH24:MI:SS');
  tt:= round((end_date - start_date) * 24 * 60 * 60,2);
  dbms_output.put_line(i || ' Time taken is ' || tt || 's from ' || s_date || ' to ' || e_date);
END;
/

show errors procedure delete_sql
show errors procedure delete_test

SET SERVEROUTPUT ON FORMAT WRAP SIZE 200000; 

exec delete_sql('MSF710', 'select rowid from msf710 s where  (s.equip_no, s.eq_tran_date, s.comp_data, s.rec_710_type, s.seq_710_no) not in  (select c.equip_no, c.eq_tran_date, c.comp_data, c.rec_710_type, c.seq_710_no  from  msf710_sched_comm c)', 500);

spool off; 
```

哦，最后一个提示。它会很慢，并且取决于表可能需要一些停机时间。测试、计时和调优是您最好的朋友。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-17T21:54:00.447

这里的所有答案都很好，只需添加一件事：如果您想删除表中的**所有**记录，并且**确定**不需要回滚，那么您想使用**truncate table**命令。

（在您的情况下，您只想删除一个子集，但对于潜伏着类似问题的任何人，我想我会添加这个）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-07-11T22:26:04.977

对我来说最简单的方法是：-

```
DECLARE
L_exit_flag VARCHAR2(2):='N';
L_row_count NUMBER:= 0;

BEGIN
   :exit_code        :=0;
   LOOP
      DELETE table_name
       WHERE condition(s) AND ROWNUM <= 200000;
       L_row_count := L_row_count + SQL%ROWCOUNT;
       IF SQL%ROWCOUNT = 0 THEN
          COMMIT;
          :exit_code :=0;
          L_exit_flag := 'Y';
       END IF;
      COMMIT;
      IF L_exit_flag = 'Y'
      THEN
         DBMS_OUTPUT.PUT_LINE ('Finally Number of Records Deleted : '||L_row_count);
         EXIT;
      END IF;
   END LOOP;
   --DBMS_OUTPUT.PUT_LINE ('Finally Number of Records Deleted : '||L_row_count);
EXCEPTION
   WHEN OTHERS THEN
      ROLLBACK;
      DBMS_OUTPUT.PUT_LINE ('Error Code: '||SQLCODE);
      DBMS_OUTPUT.PUT_LINE ('Error Message: '||SUBSTR (SQLERRM, 1, 240));
      :exit_code := 255;
END; 
```

# c++ - C++中的**是什么？

> ID：644981
> 
> 赞同：51
> 
> 时间：2009-03-13T23:32:55.747
> 
> 标签：c++, pointers

我已经看到了一些代码，以及从我的编译器生成的一些错误，这些错误`**`在变量之前有一个 ' ' 标记（例如 **variablename unreferenced-- 或其他东西，我不记得完全不记得了）。我相当肯定这与指针有关，如果我不得不猜测它看起来像是试图取消引用两次。' `**`' 是相当难以用谷歌搜索的。有人可以给我指出一个好的网站/文档，或者有人愿意在这里解释吗？

谢谢。

很好的反应。如果我可以添加，在哪些情况下使用指向指针的指针很有用？您不应该只使用原始指针而不是创建另一个指向原始指针的指针吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-13T23:36:12.337

`**`实际上不仅是指向指针的指针（如在声明中），而且还是解引用的解引用（在语句中）。

它经常在没有 & 引用的 C 中使用，例如更新指针类型的返回值：

```
int alloc_foo(struct foo **foo_ret)
{
    *foo_ret = malloc(sizeof(struct foo));
    return 1; /* to indicate success; return value in foo_ret */
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-14T00:57:16.510

您可能会认出 main() 的签名：

```
int main(int argc, char* argv[]) 
```

以下是等价的：

```
int main(int argc, char** argv) 
```

在这种情况下，argv 是指向 char* 数组的指针。

在 C 中，索引运算符 [] 只是执行指针运算的另一种方式。例如，

```
foo[i] 
```

产生相同的代码

```
*(foo + i) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-13T23:35:18.127

它不是`**`令牌。它只是一个`*`令牌，后面跟着另一个`*`令牌。在您的情况下，您有一个指向指针的指针，并且它被取消引用两次以获取真正指向的内容。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-13T23:34:00.283

`**`是指向指针的指针。

它可能是矩阵（数组数组）或字符串数​​组（`char`数组）等。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-13T23:44:10.680

这是双重取消引用。

```
int i = 3;
int* ptr_to_i = &i;
int** ptr_to_ptr_to_i = &ptr_to_i;

std::cout << **ptr_to_ptr_to_i << std::endl; 
```

打印 3。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-14T00:38:08.910

我只是想强调指向指针的一些用途。其中大部分**都**被其他帖子所触及，但我认为重申可能会有所帮助。

*   它允许被调用者*修改*调用者拥有的指针。例如，可以传递一个指向字符串开头的指针的指针，而被调用者可以修改指向的指针，使其现在指向字符串中出现特定字符的位置。

*   因为数组降级为指针（并且指针可以被视为数组），如果您有以下情况，您通常会看到指向指针的指针：

    *   指向数组的指针。这是上述情况的概括，因为“字符串”（无论如何是 C 风格的字符串）实际上只是一个`char`s 数组。

    *   一个指针数组。例如，您可能有一个指向对象的指针数组，允许多态性，或者一个指针数组来选择存储在另一个集合中的对象。

    *   数组数组。同样，数组降级为指针，因此这是上述情况的特定情况。这通常用于所谓的“锯齿状”阵列（与矩形相反）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-13T23:34:21.467

你可以从字面上解释它——[指向指针的指针](http://www.cs.cf.ac.uk/Dave/C/node12.html)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-14T01:47:50.693

*   `int **var`声明一个指向指针的指针
*   `**var`引用指针的内容，该指针本身指向一个指针

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-13T23:43:51.460

一个常见的用途是它允许函数将指针设置为空。
所以 free(pointer) 释放分配给指针的内存，但让指针危险地指向空闲内存。
而是声明一个 my_free(**pointer) 并调用 my_free(&pointer) 以便 my_free() 可以在释放指针后将指针设置为空。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-13T23:44:30.023

见[http://www.c2.com/cgi/wiki?ThreeStarProgrammer](http://www.c2.com/cgi/wiki?ThreeStarProgrammer)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-02T20:30:41.357

这是 C++ Sigils 的魅力之一。根据我自己的个人经验，我可以在 STL 的 Arrays & Vectors 上使用取消引用运算符来保证更快、更高效的读取访问性能。如果你好奇的话，我也采用了习惯性的共享指针方法。:)***********