# StackOverflow 问答 000315000-000315999

# design-patterns - 如何学习设计模式？

> ID：315000
> 
> 赞同：351
> 
> 时间：2008-11-24T18:36:43.433
> 
> 标签：design-patterns

我已经阅读了大约 4 到 5 本书关于设计模式的书籍，但我仍然觉得我没有接近设计模式的中级水平？

我应该如何去学习设计模式？

有没有关于设计模式的好书？

我知道这只能通过经验来实现，但必须有一些方法来掌握这些？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2008-11-24T18:45:56.787

我读了三本书，但直到我读了 OReilly 的[Head First Design Patterns](http://oreilly.com/catalog/9780596007126/)之前，我仍然不太了解模式。这本书让我大开眼界，解释得很好。

![替代文字](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR9ohzNKE8bWdqrgYAeEwkdvJp1AKc8OpX3WazG-jDQ6bdbC9i_)

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2008-11-24T18:41:45.860

最好的方法是开始使用它们进行编码。设计模式是一个伟大的概念，仅仅阅读它们就很难应用。采取一些您在网上找到的示例实现并围绕它们进行构建。

一个很好的资源是[数据和对象工厂](http://web.archive.org/web/20110216121401/http://www.dofactory.com/Patterns/Patterns.aspx)页面。他们回顾了模式，并为您提供了概念和现实世界的示例。他们的参考资料也很棒。

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2013-04-19T16:34:58.047

对于这样的老问题，我的两分钱

有些人已经提到，实践和重构。我相信学习模式的正确顺序是这样的：

1.  学习测试驱动开发 (TDD)
2.  学习重构
3.  学习模式

大多数人忽略 1，许多人认为他们可以做到 2，几乎每个人都直接选择 3。

对我来说，提高我的软件技能的关键是学习 TDD。这可能是一段痛苦而缓慢的编码时间，但首先编写测试肯定​​会让你对代码思考很多。如果课程需要太多样板或容易中断，您会很快注意到难闻的气味

TDD 的主要好处是您不再担心重构代码并迫使您编写高度独立和内聚的类。如果没有一套好的测试，触摸没有损坏的东西实在是太痛苦了。使用安全网，您将真正冒险对代码进行重大更改。那是你可以真正开始从实践中学习的时刻。

现在到了必须阅读有关模式的书籍的地步，在我看来，过于努力完全是浪费时间。在注意到我做了类似的事情之后，我才真正理解了模式，或者我可以将其应用于现有代码。如果没有安全测试或重构习惯，我会等到一个新项目。在新项目中使用模式的问题是您看不到它们如何影响或更改工作代码。只有在我将代码重构为其中一种时，我才理解一种软件模式，而当我在我的代码中引入一个新的模式时，我从来没有理解过。

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2013-06-02T14:26:43.460

Derek Banas 为我非常喜欢的设计模式制作了 youtube 教程：

[http://www.youtube.com/playlist?list=PLF206E906175C7E07](http://www.youtube.com/playlist?list=PLF206E906175C7E07)

他们的时间可能有点短，但他的时间安排和演讲让他们学习起来非常愉快。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-11-24T18:55:02.367

练习，练习，练习。

您可以阅读有关演奏大提琴多年的文章，但仍然无法为乐器演奏弓并制作任何听起来像音乐的东西。

设计模式最好被认为是一个高级问题；只有当你有必要的经验来识别它们是有用的时，它才是相关的。认识到它们很有用是件好事，但除非你见过它们会应用或已经应用的情况，否则几乎不可能理解它们的真正价值。

当您在其他人的代码中识别设计模式，或者在设计阶段识别出与模式非常吻合的问题时，它们变得有用；然后检查形式模式，检查问题，确定它们之间的增量是什么，以及关于模式和问题的说明。

这真的和编码一样；K&R 可能是 C 语言的“圣经”，但从头到尾多次阅读并不能提供一种实践经验；经验是无可替代的。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2008-11-24T18:51:03.500

练习练习练习。如果没有大量的练习，我认为 4 到 5 本书甚至是一种过度的阅读练习。我相信，最好的方法是开始使用这些模式**重构你当前的项目。**或者，如果您没有任何正在积极从事的项目，那么**就按照自己的方式去做，然后尝试重构为模式**。

如果您没有经历过他们解决的问题，您将无法完全欣赏他们。请记住，它们不是灵丹妙药——你不需要记住它们，也不需要努力去申请。我的两分钱..

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2011-12-08T04:25:16.383

问自己这些问题：

他们在做什么？

他们解耦/耦合什么？

你应该什么时候使用它们？

什么时候不应该使用它们？

哪些缺少的语言功能会让它们消失？

使用它会产生什么技术债务？

有没有更简单的方法来完成工作？

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-11-24T18:54:31.310

我发现在理解它们解决的问题以及解决问题的其他（更糟糕的）方式之前，要理解或理解某些模式的好处有点困难。

除了 GOF 和 POSA 书籍之外，我还没有真正阅读过任何书籍，所以我无法给你其他建议。实际上，您只需要了解问题领域，我认为许多经验不足的开发人员可能无法欣赏模式的好处。这对他们来说不是轻视。当一个人必须首先与糟糕的替代方案作斗争时，接受、理解和欣赏好的解决方案要容易得多。

祝你好运

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-11-24T18:56:00.370

已经给出了很多很好的例子。我想补充一个：

误用它们。您不需要故意这样做，当您尝试将它们应用到您的初始设计模式匹配中时就会发生这种情况。在此期间，您将看到的每一个问题似乎都恰好适合一种设计模式。通常，出于某种原因，这些问题似乎都适合相同的设计模式（Singelton 是该设计模式的主要候选者）。

你会应用这个模式，它会很好。几个月后，您将需要更改代码中的某些内容，并发现使用该特定模式并不那么聪明，因为您将自己编码到了一个角落，您需要再次重构。

诚然，这并不是一个真正的“21 天后就能学会”的答案，但根据我的经验，它最有可能让你对这个问题有一个很好的了解。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-12-03T03:45:38.287

你读过 Allan Shalloway 的“Design Patterns Explained”吗？

这本书与其他设计模式书籍非常不同，因为它不是模式目录，而是主要介绍了一种分解问题空间的方法，可以轻松映射到模式。

问题可以分解为两部分：共同的事物和变化的事物。完成此操作后，我们将常见的事物映射到接口，并将变化的事物映射到实现。本质上，很多模式都属于这种“模式”。

例如在策略模式中，共同的事物被表达为策略的上下文，可变的部分被表达为具体的策略。

我发现这本书与其他模式书相比非常发人深省，对我来说，这些书对我来说就像阅读电话簿一样令人兴奋。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-11-24T18:44:26.790

你试过四人帮的书吗？

[设计模式：可重用的面向对象软件的要素](https://rads.stackoverflow.com/amzn/click/com/0201633612 "设计模式：可重用的面向对象软件的要素")

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-11-24T19:00:40.283

对于书籍，我会推荐[Design Patterns Explained](http://books.google.com/books?id=JPOaP7cyk6wC)和[Head First Design patterns](http://books.google.com/books?id=LjJcCnNf92kC)。要真正学习这些模式，您应该查看现有代码。寻找你已经在使用的模式。查看[代码异味](http://en.wikipedia.org/wiki/Code_smell)以及哪些模式可以解决它们。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-11-24T19:00:55.257

我领导了一些设计模式讨论组（[我们的网站](http://www.patternsgroup.com/wiki/)），并阅读了 5 或 6 本模式书籍。我建议从 Head First Design Patterns 这本书开始，然后参加或开始一个讨论组。Head First 这本书一开始可能看起来有点像孩之宝，但大多数人在读完一两章后就会喜欢它。

使用出色的资源 - [Joshua Kereivisky 的 A Learning Guide to Design Patterns](http://www.industriallogic.com/papers/learning.html)进行模式排序并帮助您的讨论组。根据经验，我建议对排序进行的一个更改是将策略放在首位。今天的大多数开发人员都经历过工厂化身的好坏经历，因此从工厂开始可能会导致很多关于模式的对话和混淆。这往往会分散如何学习和学习模式的注意力，而这在这方面非常重要首次见面。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-12-15T13:38:16.693

我推荐 HeadFirst DesignPattern。读这本书是不够的，在吸收了你需要找到的许多问题的答案之后，你需要找出这些模式在现实生活中的应用。我也在做同样的事情并开始提问，即使这些问题看起来很傻。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-11-24T18:48:59.137

我的建议是结合实现其中一些并分析它们的一些实现。例如，在 .Net 中，如果您查看数据适配器，就会使用适配器模式，如果您稍微深入研究一下框架，还会使用其他一些模式。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-11-24T18:54:54.273

我不知道最好的书，但纯粹主义者可能会说[设计模式：可重用的面向对象软件的元素](http://en.wikipedia.org/wiki/Design_Patterns)

就我个人而言，我喜欢O'Reilly 出版的[Head First Design Patterns 。](http://oreilly.com/catalog/9780596007126/)它是用一种吸引我的对话声音写的。当我阅读它时，我同时查看了我的源代码，看看它是否适用于我正在阅读的内容。如果是这样，我重构了。这就是我学习责任链的方式。

实践-实践-实践。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-11-24T19:04:06.733

设计模式只是工具——有点像库函数。如果您知道它们的存在以及它们的大致功能，您可以在需要时从书中挖掘它们。

设计模式并没有什么神奇之处，任何优秀的程序员在任何书籍出版之前就已经为自己找到了 90% 的设计模式。在大多数情况下，我认为这些书在简单地为各种模式定义名称方面最有用，因此我们可以更轻松地讨论它们。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-24T19:13:22.643

我学习设计模式的方式是编写大量非常糟糕的软件。当我大约 12 岁时，我不知道什么是好或坏。我只是写了一堆意大利面条代码。在接下来的 10 年左右，我从错误中吸取了教训。我发现了什么有效，什么无效。大多数常见的设计模式都是我独立发明的，所以当我第一次听到什么是设计模式时，我非常兴奋地了解它们，然后非常失望的是它只是我直觉知道的事物的名称集合。（关于在 10 年内自学 C++ 的笑话实际上并不是一个笑话）

故事的寓意：编写大量代码。正如其他人所说，练习，练习，练习。我认为，除非您了解当前设计为何不好并寻找更好的方法，否则您将无法很好地了解在何处应用各种设计模式。设计模式书籍应该为你提供一个精炼的解决方案和一个通用的术语来与其他开发人员讨论它，而不是一个你不理解的问题的粘贴解决方案。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-24T19:56:41.527

阅读设计模式，练习编码的概念并不能真正帮助 IMO。当您阅读这些书籍时 1\. 寻找特定设计模式解决的基本问题，从创建模式开始是您的最佳选择。2\. 我确定你以前写过代码，分析一下你是否遇到过设计模式旨在提供解决方案的相同问题。3\. 尝试重新设计/重构代码，或者重新开始。

关于资源，您可以查看这些

1.  www.dofactory.com
2.  设计模式：可重用的面向对象软件的元素（Addison-Wesley 专业计算系列）作者 Erich Gamma、Richard Helm、Ralph Johnson 和 John M. Vlissides
3.  Martin Fowler 的企业应用架构模式

1 是快速入门，2 将是深入学习..3 将解释或应该让您认为您在 2 中学到的内容适合企业软件。

我的2美分...

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-11-27T04:39:36.087

我认为学习设计模式也很困难。您必须更多地了解 OOP 以及一些大中型应用程序开发的经验。对我来说，我作为一组开发人员进行研究以进行讨论。我们遵循[设计模式学习指南](http://www.industriallogic.com/papers/learning.html)，他们已经完成了模式研究。有 C# 和 JavaScript 开发人员联合在一起。对我来说，奇特的是 C# 开发人员用 JavaScript 编写代码，而 JavaScript 开发人员为 C# 代码做同样的事情。离开会议后，我还在家里研究并阅读了几本书以进行复习。[更好地理解和记住我的想法是在http://tech.wowkhmer.com/category/Design-Patterns.aspx](http://tech.wowkhmer.com/category/Design-Patterns.aspx)中用 C# 和 JavaScript 编写博客。

我建议在了解每个设计模式之前先了解模式的名称。此外，如果有人知道这个概念，请解释并举一个例子，不仅是编程，而且是在阅读世界中。

例如：

工厂方法：

阅读世界：我只给钱 5 美元、10 美元或 20 美元，它会在不知道它是如何生产的情况下生产披萨，我只是根据资金投入得到一个小型、中型或大型披萨，这样我就可以吃东西或做任何事情。

编程：客户端只需将参数值 $5、$10 或 $20 传递给工厂方法，它就会返回 Pizza 对象。因此，客户端可以在不知道它如何处理的情况下使用该对象。

我不确定这对你有帮助。这取决于参加会议的人的知识水平。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-12-04T02:18:05.217

我认为您需要检查您作为开发人员遇到的一些问题，因为又一次设计更改，您不得不第 10 次修改您的代码。你可能有一个项目清单，你觉得有很多返工和痛苦。

从该列表中，您可以得出设计模式打算解决的场景。是否曾经需要对不同的数据集执行相同的一系列操作？您是否需要能够为应用程序提供未来功能，但又想避免为现有类重新设计所有逻辑？从这些场景开始，然后返回到模式目录以及它们应该解决的各自问题。您可能会在 GoF 和您的项目库之间看到一些匹配项。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-02-23T08:51:14.447

对于初学者来说，Head First Design 模式可以做到，一旦我们熟悉了所有模式，然后尝试将实时对象可视化为这些模式。

本书将帮助您理解基本概念，除非您在现实世界中实施之前，您不能成为设计模式的大师

# timezone - 在不同时区工作时面临的挑战

> ID：315002
> 
> 赞同：4
> 
> 时间：2008-11-24T18:37:26.553
> 
> 标签：timezone

我相信这里有很多开发人员的团队分布在不同的时区。人们面临哪些挑战以及解决这些挑战的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T19:14:22.610

我目前在与团队其他成员不同的时区工作。最大的挑战是清晨和下午晚些时候，我们中的一些人当天还没有开始工作，或者有些人已经离开了一天。

这只是工作的一部分，我们都尊重彼此的宝贵时间。如果它很重要（这是一个相对术语），那么我们只需调用团队成员或页面/文本整个团队。如果发生这种情况，那么我们都会根据需要做出回应。没什么大不了。由于尊重因素，我们知道仅在必要时使用它。

在正常工作日，我们只使用电子邮件、电话和 IM 等标准内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T19:06:28.587

老实说，任何跨时区拆分项目开发的公司都与工程现实脱节。MBA 们为了节省一两块钱，强加给他们的工程师一个令人羡慕的职位，即改变他们的生活时间表——导致压力大、工作时间延长、士气低落和营业额增加。质量受损，发货日期受损，功能列表受损。您将在项目中看到的唯一增加是错误数量。

如果您不需要项目单元之间的低延迟通信，您可以像这样拆分工程项目。换句话说 - 如果他们在系统的几乎完全独立的部分上工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T19:08:40.483

我们有一个分布在或必须跨 3 或 4 个不同时区工作的团队。在此过程中，我们面临着主要与沟通有关的几个挑战。

很难在方便的时间安排所有团队成员参加的会议，因此有时可能需要召开团队会议的子集，或者放弃团队会议的方法，转而采用由一名主要团队成员负责的个人更新方法对于特定的海外团队。

另一个问题是工作交接和沟通。例如，我们在印度有一个资源，如果他们遇到了导致他们停止工作的问题，如果我们没有足够快的响应，可能会导致他们的计划延迟 2 或 3 天，这都是由于时差造成的。因此，当务之急是我们不仅要安排各种工作来填补这些延误，还要及时回应他们的询问。我们经常将测试任务分配给这个特定时区的资源，因为这通常是一个没有终点的异步任务。

此外，您需要有一个良好的变更管理系统和代码存储库。您可以使通信渠道越异步越好，这也适用于信息交换（例如源和问题跟踪）。

没有理由不能让分布式团队工作，尤其是在当今时代，只要我们有互联网链接，我们几乎可以在任何地方工作。但是，重要的是要知道项目中的瓶颈在哪里，并确保相应地分配工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T19:18:15.957

如果您没有专门针对这种场景进行调整的出色流程，那么不同的时区将会扼杀您的项目截止日期。至少一方应该非常灵活地调整他们的会议时间。但当然，这最终会在团队成员之间造成挫败感。

查看这个关于外包及其实际问题的 SO 线程，我想你也会从那里得到一些观点[https://stackoverflow.com/questions/111948/outsourcing](https://stackoverflow.com/questions/111948/outsourcing)

或外包标签 - [https://stackoverflow.com/questions/tagged/outsourcing](https://stackoverflow.com/questions/tagged/outsourcing)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T20:25:16.303

计划，计划和计划更多。其他一些需要注意的事项：

1) 如果团队在其他地区，请注意当地的假期，例如不同的国家可能有不同的假期。例如，一些教派比大多数基督徒晚 2 周庆祝一些基督教节日，例如我在想的一些正统教派。

2) 计划在可能超出正常工作时间的特定时间召开会议。当团队其他成员和我之间有 13 小时的时差时尤其如此。

3）注意“核心时间”随着时间的变化，例如，如果我在太平洋时间并且想在东部时间更新新泽西的某些内容，我在太平洋时间下午 5 点进行，即东部时间晚上 8 点在那里可能没有人在第二天早上之前注意到变化或对其进行测试，这可能意味着一些支持人员在太平洋时间凌晨 4:30 起床，因为在东部，有些人已经开始出现工作并走了，“嗯？为什么这不像昨天那样工作吗？”

如果涉及各种字母，例如拉丁文、西里尔文、阿拉伯文等，还有其他显而易见的事情需要注意，这可能会影响计算机解释某些输入文本的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T19:52:46.697

我们在支持方面遇到了这类问题 - 我们使用 3 个商业 SDK，支持团队位于遥远的时区（时差 8-10 小时）。此外，并非所有工作日都重叠。

这个事实对我的逆向工程能力产生了很大影响:)

# java - java - 确定文件是否为链接

> ID：315004
> 
> 赞同：4
> 
> 时间：2008-11-24T18:37:45.303
> 
> 标签：java, file, symlink

你是怎么做到的，或者有可能吗？

我想您可以摆弄 getCanonicalWhatever 和原始路径，但这很混乱，我不喜欢它。如果您提出建议，请提供明确的理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T18:42:13.050

请参阅文章[How to deal with filesystem softlinks/symbolic links in Java](http://www.onyxbits.de/content/blog/patrick/how-deal-filesystem-softlinkssymbolic-links-java)

总之，等到Java 7或者做一点JNI方法

# com+ - 如何以编程方式回收 COM+ 中的 dllhost.exe 进程？

> ID：315006
> 
> 赞同：2
> 
> 时间：2008-11-24T18:38:04.213
> 
> 标签：com+

如何以编程方式回收 COM+ 中的 dllhost.exe 进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T19:08:50.670

看看这个。这是一个 com 库，可让您管理 com+ 应用程序。 [Com+ 管理员参考](http://msdn.microsoft.com/en-us/library/ms681189(VS.85).aspx)

# html - Mechanical Turk：在 API 中使用 HTML

> ID：315009
> 
> 赞同：2
> 
> 时间：2008-11-24T18:39:14.897
> 
> 标签：html, mechanicalturk

任何使用过 Mechanical Turk 的人的问题：是否可以获取在 Mechanical Turk 网站上创建的 HTML 模板，然后从命令行工具或 API 基于该模板创建更多 HIT？

* * *

根据 API 文档，不可能从 API 创建新的 HTML 并添加它。但是，我在这里要做的是使用我已经创建的 HIT 模板。似乎应该有一种方法可以使用该模板（并在 API 中加载新数据），因为亚马逊已经批准了它，而我已经将它用于 HIT。但我还没有在文档中看到这样做的方法。

* * *

我想要 HTML 的主要原因是我可以应用无法通过问题文件应用的样式。如果有某种“丰富”的问题文件，那可能会解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T01:48:57.667

您可以在 Mechanical Turk 上发布一份工作，让某人获取您的模板并将您的数据插入到您想要创建的每个 HIT 中。

（是的，这至少是半讽刺）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T01:54:41.927

据我所知，我还没有看到使用 API 手动创建的问题的方法。

如果您打算进行编程访问，那么完整使用 API 可能会更容易（即，通过 XML 指定您的问题并从该问题创建 HIT）：

[http://www.codeplex.com/MTurkDotNet](http://www.codeplex.com/MTurkDotNet) (.NET SDK)

该 API 非常易于使用，并且有几个代码示例。

或者，您可以使用可能更适合的“外部问题”问题类型——您可以自己主持整个问题表格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-08T09:54:57.133

我知道这是一个老问题，但 API 已更新为允许使用`HITLayout`：[http](http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_HITLayoutArticle.html) ://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_HITLayoutArticle.html 。

# sql-server - 查找 SQL Server 服务器数据类型的依赖项

> ID：315011
> 
> 赞同：1
> 
> 时间：2008-11-24T18:39:17.097
> 
> 标签：sql-server, sql-server-2005

是否有一个命令或一组表我可以查看以确定 SQL Server server 2005 中的哪些表、存储过程和视图具有某种用户定义的数据类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T18:53:14.353

对于表和视图：

```
Select * 
From   Information_Schema.Columns 
Where  DOMAIN_NAME = 'YourUserDefinedTypeName' 
```

对于过程和功能：

```
Select * 
From   Information_Schema.PARAMETERS 
Where  USER_DEFINED_TYPE_NAME = 'YourUserDefinedTypeName' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T18:52:15.713

表相对容易，sys.columns 和 sys.types 允许您将列链接到类型。下面的查询将解决这个问题。

```
select s.name
      ,o.name
      ,c.name
      ,t.name
  from sys.schemas s
  join sys.objects o
    on o.schema_id = s.schema_id
  join sys.columns c
    on c.object_id = o.object_id
  join sys.types t
    on c.user_type_id = t.user_type_id
 where t.name = 'Foo' 
```

编辑：正如 G Mastros 上面所示，您可以使用类似的查询获取参数。

```
select s.name
      ,o.name
      ,p.name
      ,t.name
  from sys.schemas s
  join sys.objects o
    on o.schema_id = s.schema_id
  join sys.parameters p
    on p.object_id = o.object_id
  join sys.types t
    on p.user_type_id = t.user_type_id
 where t.name = 'Foo' 
```

# asp.net - 如何使用 Asp.Net 从 Sql 数据库中获取最后创建的条目的 ID

> ID：315017
> 
> 赞同：2
> 
> 时间：2008-11-24T18:40:28.683
> 
> 标签：asp.net, sql-server, transactions

我将用一个例子来解释问题：

我的数据库中有两个表，命名条目，标签

两个表中都有一个名为 ID_ENTRY 的列。当我将记录添加到表条目时，我必须获取最后添加记录的 ID_ENTRY 并将其添加到表标签中。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T18:59:01.127

做到这一点的唯一方法是使用多个语句。使用动态 sql，您可以通过用分号分隔查询字符串中的每个语句来做到这一点：

```
"DECLARE @ID int;INSERT INTO [Entry] (...) VALUES ...; SELECT @ID = scope_identity();INSERT INTO [TAGS] (ID_ENTRY) VALUES (@ID);" 
```

确保将其放入事务中以防止并发问题并使其保持原子性。如果需要，您还可以将其分解为两个单独的查询以在中间返回新的 ID 值；只要确保两个查询都在同一个事务中。

另外：您正在对动态 sql 使用参数化查询，对吗？如果你不是，我会亲自到那里用湿面条打你一万次，直到你悔改不安全的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T18:43:24.560

如果您有所有需要推送到可用标签表的数据，我可能会在命名条目表上使用 INSERT 触发器来执行此操作。如果没有，那么您可能需要考虑使用在事务中创建两者的存储过程。

如果您想在代码中执行此操作，则需要更具体地了解如何管理数据。你在使用 DataAdapter、DataTables、LINQ、NHibernate 吗？本质上，您需要将两个插入都包装在某种事务中，以便插入执行或不执行，但执行此操作的方法取决于您用于与数据库交互的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T18:59:09.240

在第一个表上执行插入语句后，您应该立即查询 @@IDENTITY 执行“SELECT @@identity”。这将检索最后一个自动生成的 ID ...然后将其插入到第二个表中。

如果您使用触发器或插入行的东西......这可能不起作用。使用 Scope_Identity() 而不是 @@IDENTITY

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T19:25:37.050

如果您使用动态 sql，为什么不使用 Linq to Entity Framework，现在 EF 是 Microsoft 推荐的数据访问技术（请参阅这篇文章[Clarifying the message on L2S Futures](http://blogs.msdn.com/adonet/archive/2008/10/31/clarifying-the-message-on-l2s-futures.aspx) from ADO.NET 团队博客），如果您使用 EF 进行插入最后一个身份 ID 将自动为您提供，我一直使用它很容易。

希望这可以帮助！

射线。

# windows - SIO_FLUSH 的行为

> ID：315045
> 
> 赞同：2
> 
> 时间：2008-11-24T18:47:46.843
> 
> 标签：windows, sockets, tcp, ioctl

在 Windows 环境（在用户空间）中使用 SIO_FLUSH 套接字 ioctl 时，我对会发生什么感到困惑。这是：(1) 将 TCP/IP 发送队列中的数据完全丢弃到黑洞中，或者 (2) 通过连接推送排队的发送数据，直到缓冲区为空，或者 (3) 其他什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T16:14:33.930

使用 Windows，您永远无法确定。但是，[这](http://winapi.freetechsecrets.com/sock2/SOCK2WSAIoctl.htm)（搜索 SIOFLUSH）表示它丢弃了与套接字关联的发送队列。这也是我在使用 SIO_FLUSH 时所期望的

# c# - 在 c# 代码中使用在 c++ dll 中定义的类

> ID：315051
> 
> 赞同：75
> 
> 时间：2008-11-24T18:49:25.953
> 
> 标签：c#, c++, dll, pinvoke

我有一个用 c++ 编写的 dll，我需要在我的 c# 代码中使用这个 dll。搜索后我发现使用 P/Invoke 可以让我访问我需要的函数，但是这些函数是在一个类中定义的，并且使用非静态私有成员变量。所以我需要能够创建这个类的一个实例来正确使用这些函数。如何获得对此类的访问权限以便创建实例？我一直无法找到一种方法来做到这一点。

我想我应该注意 c++ dll 不是我的代码。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-11-24T18:54:54.817

无法在 C# 代码中直接使用 C++ 类。您可以间接使用 PInvoke 来访问您的类型。

基本模式是为类 Foo 中的每个成员函数创建一个关联的非成员函数，该函数调用该成员函数。

```
class Foo {
public:
  int Bar();
};
extern "C" Foo* Foo_Create() { return new Foo(); }
extern "C" int Foo_Bar(Foo* pFoo) { return pFoo->Bar(); }
extern "C" void Foo_Delete(Foo* pFoo) { delete pFoo; } 
```

现在只需将这些方法调用到您的 C# 代码中即可

```
[DllImport("Foo.dll")]
public static extern IntPtr Foo_Create();

[DllImport("Foo.dll")]
public static extern int Foo_Bar(IntPtr value);

[DllImport("Foo.dll")]
public static extern void Foo_Delete(IntPtr value); 
```

缺点是您将有一个笨拙的 IntPtr 传递，但是围绕该指针创建一个 C# 包装类以创建一个更可用的模型是一件有点简单的事情。

即使您不拥有此代码，您也可以创建另一个 DLL 来包装原始 DLL 并提供一个小的 PInvoke 层。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-04-12T12:59:49.077

## Marshal C++ 类并使用 PInvoke

C++ 代码，类名.h

```
class __declspec(dllexport) CClassName
{
 public:
    CClassName();
    ~CClassName();
    void function();

}; 
```

C++ 代码，类名.cpp

```
CClassName::CClassName()
{
}

CClassName::~CClassName()
{
}

void CClassName::function()
{
    std::cout << "Bla bla bla" << std::endl;

} 
```

C++ 代码，调用函数的 ClassNameCaller.h 文件

```
#include "ClassName.h"      

#ifdef __cplusplus
extern "C" {
#endif

extern __declspec(dllexport) CClassName* CreateClassName();

extern __declspec(dllexport) void DisposeClassName(CClassName* a_pObject);

extern __declspec(dllexport) void function(CClassName* a_pObject);

#ifdef __cplusplus
}
#endif 
```

C++ 代码，调用函数的 ClassNameCaller.cpp 文件

```
#include "ClassNameCaller.h"

CClassName* CreateClassName()
{
    return new CClassName();
}

void DisposeClassName(CClassName* a_pObject)
{
    if(a_pObject!= NULL)
    {
        delete a_pObject;
        a_pObject= NULL;
    }
}

void function(CClassName* a_pObject)
{
    if(a_pObject!= NULL)
    {
        a_pObject->function();
    }
} 
```

C# 代码

```
[DllImport("ClassNameDll.dll")]
static public extern IntPtr CreateClassName();

[DllImport("ClassNameDll.dll")]
static public extern void DisposeClassName(IntPtr pClassNameObject);

[DllImport("ClassNameDll.dll")]
static public extern void CallFunction(IntPtr pClassNameObject);

//use the functions
IntPtr pClassName = CreateClassName();

CallFunction(pClassName);

DisposeClassName(pClassName);

pClassName = IntPtr.Zero; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T19:05:53.813

[这](http://www.codeproject.com/KB/DLL/XDllPt3.aspx)是一个如何从 VB 调用 C++ 类方法的示例 - 对于 C#，您只需在步骤 4 中重写示例程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T18:56:28.933

您可能需要编写一个中间 DLL（也许用 C++）来为您处理这个问题并公开您需要的接口。您的 DLL 将负责加载第 3 方 DLL，创建此 C++ 对象的实例，并根据需要通过您设计的任何 API 公开其成员函数。然后，您将使用 P/Invoke 获取您的 API 并干净地操作该对象。

注意：对于您的 DLL 的 API，请尝试将数据类型限制为基元（long、int、char* 等）以防止模块边界问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T09:30:14.363

我这样做的方法是在我的非托管 C++ DLL 周围创建一个瘦托管 C++ 包装器。托管包装器包含“代理”类，这些类包装非托管代码，公开 .NET 应用程序所需的接口。这是一项双重工作，但它允许在正常环境中进行非常无缝的操作。在某些情况下（例如 ASP.NET），依赖关系确实会变得更棘手，但您可能不会遇到这种情况。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T18:58:05.717

我同意 JaredPar。在托管代码中创建非托管类的实例应该是不可能的。

另一件事是 - 如果您可以在托管 C++ 中重新编译 DLL 或用它制作 COM 组件，那会容易得多/

# winforms - 在 Windows Moblie 上关闭窗口 [X] 按钮而不是最小化

> ID：315053
> 
> 赞同：5
> 
> 时间：2008-11-24T18:50:43.640
> 
> 标签：winforms, windows-mobile, compact-framework

在标准 Windows 中通常关闭窗口的窗口顶部栏中的 [x] 按钮似乎在 Windows Compact 上执行最小化操作。

它如何使它关闭呢？当发生这种情况时，我还需要能够引发一个事件，因为我想在关闭窗口时执行一些逻辑。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T19:20:07.917

将 Form.MinimizeBox 属性设置为 false。这会将 [X] 更改为 [ok]，并在单击时关闭表单而不是最小化它。

编辑：您想要的事件是关闭或关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T02:55:49.980

我不确定这与 .NET 论坛支持有何关系，但您需要使用 Native API [SHDoneButton](http://msdn.microsoft.com/en-us/library/aa458082.aspx)。

默认情况下，它设置为“ `SHDB_HIDE`”，然后显示“Windows Mobile”“X”按钮（或任何覆盖 X 按钮的应用程序，如 LGE 的“X”按钮应用程序或 HTC 应用程序）。

如果您将其设置为“ `SHDB_SHOW`”，它将显示一个“确定”按钮，如果按下该按钮，则会向窗口发送 IDOK。如果您将其设置为“ `SHDB_SHOWCANCEL`”，它将显示一个“x”按钮，如果按下该按钮会向窗口发送 IDCANCEL。 `SHDB_SHOWCANCEL`MSDN 没有记录，但它在头文件 (aygshell.h) 中。

# java - JSF 在上下文初始化时初始化应用程序范围的 bean

> ID：315073
> 
> 赞同：16
> 
> 时间：2008-11-24T18:57:33.113
> 
> 标签：java, jsf

我正在构建一个 JSF+Facelets Web 应用程序，其中一个方法是每隔一段时间扫描一个目录并索引任何更改。此方法是应用程序范围内的 bean 的一部分。我建立了 TimerTask 的子类，每 X 毫秒调用一次该方法。我的问题是初始化 bean。我可以在页面上引用 bean，当我转到页面时，bean 被初始化，并按指示工作；相反，我想要的是在初始化 Web 上下文时初始化 bean，这样它就不需要页面访问来启动索引方法。谷歌已经展示了一些想要这个功能的人，但是除了与 Spring 集成之外没有真正的解决方案，我真的不想仅仅为了获得这个功能而做。

我已经尝试使用设置了“启动时加载”的 servlet 和 ServletContextListener 来让事情顺利进行，但由于没有 FacesContext，因此无法正确设置可用，或者因为我无法从 JSF 环境中引用 bean。

有什么方法可以在 Web 应用程序启动时初始化 JSF bean？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-27T00:29:30.493

如果您的代码调用[FacesContext](http://java.sun.com/javaee/javaserverfaces/1.1_01/docs/api/javax/faces/context/FacesContext.html)，它将无法在与 JSF 请求生命周期关联的线程之外工作。为每个请求创建一个 FacesContext 对象，并在请求结束时处理。您可以通过[静态调用](http://java.sun.com/javaee/javaserverfaces/1.1_01/docs/api/javax/faces/context/FacesContext.html#getCurrentInstance())获取它的原因是因为它在请求开始时设置为[ThreadLocal](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ThreadLocal.html)。FacesContext 的生命周期与 ServletContext 的生命周期无关。

也许这还不够（听起来你已经走这条路了），但你应该能够使用 ServletContextListener 来做你想做的事。只要确保对 FacesContext 的任何调用都保存在 JSP 的请求线程中。

网页.xml：

```
<listener>
    <listener-class>appobj.MyApplicationContextListener</listener-class>
</listener> 
```

执行：

```
public class MyApplicationContextListener implements ServletContextListener {

    private static final String FOO = "foo";

    public void contextInitialized(ServletContextEvent event) {
        MyObject myObject = new MyObject();
        event.getServletContext().setAttribute(FOO, myObject);
    }

    public void contextDestroyed(ServletContextEvent event) {
        MyObject myObject = (MyObject) event.getServletContext().getAttribute(
                FOO);
        try {
            event.getServletContext().removeAttribute(FOO);
        } finally {
            myObject.dispose();
        }
    }

} 
```

您可以通过 JSF 应用程序范围来处理此对象（或者如果不存在具有相同名称的其他变量，则直接处理）：

```
<f:view>
    <h:outputText value="#{applicationScope.foo.value}" />
    <h:outputText value="#{foo.value}" />
</f:view> 
```

如果您希望在 JSF 托管 bean 中检索对象，您可以从[ExternalContext](http://java.sun.com/javaee/javaserverfaces/1.1_01/docs/api/index.html)获取它：

```
FacesContext.getCurrentInstance()
            .getExternalContext().getApplicationMap().get("foo"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T19:35:40.710

使用监听器或加载启动，试试这个：[http ://www.thoughtsabout.net/blog/archives/000033.html](http://www.thoughtsabout.net/blog/archives/000033.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T19:10:10.977

在 JSF 2+ 中，您可以使用 a`SystemEventListener`来处理它。您可以将其设置为对 执行操作以对其`PostConstructApplicationEvent`进行初始化。

```
<system-event-listener>
    <system-event-listener-class>
     listeners.SystemEventListenerImpl
    </system-event-listener-class>
    <system-event-class>
     javax.faces.event.PostConstructApplicationEvent
    </system-event-class>                       
</system-event-listener> 
```

实现看起来像：

```
public class SystemEventListenerImpl implements SystemEventListener {

  @Override
  public void processEvent(SystemEvent event) throws AbortProcessingException {
    Application application = (Application) event.getSource();
   //TODO
  }

  @Override
  public boolean isListenerForSource(Object source) {
    return (source instanceof Application);
  }
} 
```

这将允许您做更多的事情，而不仅仅是简单地传递一个值。

# c# - 使用类似 XSLT 的技术将平面文件转换为 XML

> ID：315074
> 
> 赞同：1
> 
> 时间：2008-11-24T18:57:42.660
> 
> 标签：c#, .net, xml, xslt, flat-file

我正在设计一个系统，它以 CSV 文件的形式从多个合作伙伴那里接收数据。这些文件的列数和顺序可能不同。在大多数情况下，我会想要选择列的一个子集，也许对它们重新排序，然后将它们交给解析器。我显然更希望能够将传入的数据转换为某种规范格式，以使解析器尽可能简单。

理想情况下，我希望能够使用一些图形工具为每种传入的数据格式生成转换，并将转换作为文档存储在数据库或磁盘上。收到数据后，我将应用正确的转换（不管我如何确定正确的转换）来获得规范格式的 XML 文档。如果传入的文件包含 XML，我会为每种格式创建一个 XSLT 文档，然后就可以了。

我过去曾使用过 BizTalk 的平面文件 XSLT 扩展（或它们所称的任何东西）来处理类似的事情，但我不想在这个项目上遇到 BizTalk 的麻烦（我也买不起）。

有谁知道是否有替代技术和/或 XSLT 扩展可以让我以优雅的方式实现我的目标？

我正在.NET 3.5 SP1 上用 C# 开发我的应用程序（因此更喜欢.NET 支持的技术）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T00:02:36.023

XSLT 提供了一些新功能，可以更轻松地解析非 XML 文件。

Andrew Welch 发布了一个[将 CSV 转换为 XML 的 XSLT 2.0 示例](http://ajwelch.blogspot.com/2007/02/csv-to-xml-converter-in-xslt-20.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T19:09:59.653

我认为您需要这样的东西（对不起，.NET 不支持，但代码非常简单）

[http://csv2xml.sourceforge.net](http://csv2xml.sourceforge.net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T14:30:32.623

IIRC 有人创建了一个“LINQ to CSV”库，该库可能是创建中间 XML（在内存中）作为转换输入的起点。

[在这里](http://www.codeproject.com/KB/linq/LINQtoCSV.aspx)找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-05T19:47:49.687

在研究类似的问题空间时，我发现了 2 个潜在的解决方案。

Progress Software 有一套工具和 API (.Net)，当与在其 Stylus Studio 工具中创建的 .conv（平面到 XML 转换器）文件结合使用时，允许在运行时将任何预定义的平面文件格式转换为 XML时间。更多信息在这里：[http ://www.datadirect.com/developer/data-integration/tutorials/converter-sample-code/index.ssp](http://www.datadirect.com/developer/data-integration/tutorials/converter-sample-code/index.ssp)

此外，还有一种称为 XFLAT 的 XML 格式，它允许以各种格式、分隔、固定宽度等描述平面文件......转换为 XML，以便您可以继续进行标准 XML 到 XML XSLT 的转换。更多细节可以在这里找到：[http ://www.unidex.com/overview.htm](http://www.unidex.com/overview.htm)

我从未真正使用过这些工具中的任何一个，但在研究类似问题时发现了它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-06T03:31:54.097

你可以试试 LINQ to CSV。Microsoft 的[Eric White提供了一种产品，](http://blogs.msdn.com/ericwhite/archive/2008/09/30/linq-to-text-and-linq-to-csv.aspx) [Matt Perdeck](http://www.codeproject.com/KB/linq/LINQtoCSV.aspx)提供了另一种产品。其他人在外面...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-07T17:32:37.983

查看[这篇](http://msdn.microsoft.com/en-us/library/ms973822.aspx)关于实现`XmlReader`处理非 XML 输入的文章。这不是一个非常困难的任务，一旦你让它工作，你就不需要使用类似 XSLT 的技术，你可以使用 XSLT。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-29T20:27:06.760

这将解析 linux ip route list 命令的输出。这正是我躺在身边的东西。

您必须将命令的输出包装在一个名为“输出”的元素中，样式表将从那里获取它。这里真正的关键是 xpath 2.0 规范中的 tokenize 命令。我不知道在那之前你怎么能做到这一点。此外，这不会产生单个根元素，因为这不是我需要的。在你的情况下，而不是分割空间，Id spli on a ','

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<xsl:output method="xml" indent="yes" />

<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()" />
    </xsl:copy>
</xsl:template>

<xsl:template match="//output">
    <!-- split things up for each new line -->
    <xsl:variable name="line" select="tokenize(.,'\n')"/>
    <xsl:for-each select="$line">                        
        <!-- split each line into peices based on space -->
        <xsl:variable name="split" select="tokenize(.,' +')"/>
        <xsl:if test="count($split) &gt; 1">
            <xsl:element name="route">                                        
                <xsl:for-each select="$split">
                    <xsl:choose>
                        <xsl:when test="position() = 1">
                            <xsl:attribute name="address" select="."/>
                        </xsl:when>
                        <xsl:otherwise>
                            <xsl:variable name="index" select="position()"/>
                            <xsl:variable name="fieldName" select="."/>
                            <xsl:if test="$fieldName and position() mod 2 = 0">
                                <xsl:attribute name="{$fieldName}" select="$split[$index + 1]"/>
                            </xsl:if>
                        </xsl:otherwise>
                    </xsl:choose>
                </xsl:for-each>
            </xsl:element>
        </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-24T20:10:56.863

你也可以看看[altova 的 MapForce](http://www.altova.com/products/mapforce/data_mapping.html)

# javascript - 如何处理 setTimeout() 的多个实例？

> ID：315078
> 
> 赞同：24
> 
> 时间：2008-11-24T18:58:41.720
> 
> 标签：javascript

阻止创建 setTimeout 函数的多个实例（在 javascript 中）的最推荐/最佳方法是什么？

一个例子（伪代码）：

```
function mouseClick()
{
   moveDiv("div_0001", mouseX, mouseY);
}

function moveDiv(objID, destX, destY)
{
   //some code that moves the div closer to destination
   ...
   ...
   ...

   setTimeout("moveDiv(objID, destX, destY)", 1000);
   ...
   ...
   ...
} 
```

我的问题是，如果用户多次单击鼠标，我会调用多个 moveDiv() 实例。

我看到的选项是创建一个标志，它只允许在没有其他实例可用的情况下调用超时......这是最好的方法吗？

我希望这能说清楚......

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-24T19:17:30.497

当您调用 settimeout 时，它会返回一个变量“句柄”（我认为是一个数字）

如果你第二次调用 settimeout，你应该首先

```
clearTimeout( handle ) 
```

然后：

```
handle = setTimeout( ... ) 
```

为了帮助自动执行此操作，您可以使用将超时调用与字符串（即 div 的 id 或您想要的任何内容）相关联的包装器，这样如果之前的 settimeout 具有相同的“字符串”，它会在之前自动为您清除它重新设置，

您将使用一个数组（即字典/哈希图）将字符串与句柄相关联。

```
var timeout_handles = []    
function set_time_out( id, code, time ) /// wrapper
{
    if( id in timeout_handles )
    {
        clearTimeout( timeout_handles[id] )
    }

    timeout_handles[id] = setTimeout( code, time )
} 
```

当然还有其他方法可以做到这一点..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T19:31:51.217

我会这样做：

```
// declare an array for all the timeOuts
var timeOuts = new Array();  

// then instead of a normal timeOut call do this
timeOuts["uniqueId"] = setTimeout('whateverYouDo("fooValue")', 1000);  

// to clear them all, just call this
function clearTimeouts() {  
  for (key in timeOuts) {  
    clearTimeout(timeOuts[key]);  
  }  
}  

// clear just one of the timeOuts this way
clearTimeout(timeOuts["uniqueId"]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T19:09:53.850

```
var timeout1 = window.setTimeout('doSomething();', 1000);
var timeout2 = window.setTimeout('doSomething();', 1000);
var timeout3 = window.setTimeout('doSomething();', 1000);

// to cancel:
window.clearTimeout(timeout1);
window.clearTimeout(timeout2);
window.clearTimeout(timeout3); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T07:37:17.697

我还没有测试过这些，只是在这里的编辑器中把它剪掉了。可能有效，也可能无效，但希望能成为深思熟虑的食物。

```
var Timeout = { 
   _timeouts: {}, 
   set: function(name, func, time){ 
     this.clear(name); 
     this._timeouts[name] = {pending: true, func: func}; 
     var tobj = this._timeouts[name];
     tobj.timeout = setTimeout(function()
     { 
/* setTimeout normally passes an accuracy report on some browsers, this just forwards that. */
       tobj.func.call(arguments); 
       tobj.pending = false;
     }, time); 
   },
   hasRun: function(name)
   { 
       if( this._timeouts[name] ) 
       {
          return !this._timeouts[name].pending; 
       }
       return -1; /* Whut? */ 
   },
   runNow: function(name)
   {
      if( this._timeouts[name] && this.hasRun(name)===false )
      {
         this._timeouts[name].func(-1); /* fake time. *shrug* */
         this.clear(name);
      }
   } 
   clear: function(name)
   {
     if( this._timeouts[name] && this._timeouts[name].pending ) 
     {
       clearTimeout(this._timeouts[name].timeout); 
       this._timeouts[name].pending = false; 
     }
   }
};

Timeout.set("doom1", function(){ 
  if(  Timeout.hasRun("doom2") === true )
  {
     alert("OMG, it has teh run");  
  }
}, 2000 ); 
Timeout.set("doom2", function(){ 
   /* NooP! */
}, 1000 ); 
```

具有相同标识符的连续调用将取消先前的调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T19:13:59.100

`objID`您可以使用作为键将多个标志存储在查找表（散列）中。

```
var moving = {};

function mouseClick()
{
  var objID = "div_0001";
  if (!moving[objID])
  {
    moving[objID] = true;
    moveDiv("div_0001", mouseX, mouseY);
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-10T19:03:06.893

您可以通过在函数中使用属性来避免全局或较小的变量。如果该函数仅用于此特定上下文，则此方法效果很好。

```
function set_time_out( id, code, time ) /// wrapper
{
  if(typeof this.timeout_handles == 'undefined') this.timeout_handles = [];

        if( id in this.timeout_handles )
        {
                clearTimeout( this.timeout_handles[id] )
        }

        this.timeout_handles[id] = setTimeout( code, time )
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T19:14:40.923

您始终可以覆盖按钮 onclick 以返回 false。例子：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="UTF-8">
<head>
    <title>Javascript example</title>
    <script type="text/javascript">         
        var count = 0;
        function annoy() {
            document.getElementById('testa').onclick = function() { return false; };

            setTimeout(function() {
                alert('isn\'t this annoying? ' + count++);
                document.getElementById('testa').onclick = window.annoy;
            }, 1000);

        }
    </script>
</head>
<body>
    <h2>Javascript example</h2>
    <a href="#" onClick="annoy()" id="testa">Should Only Fire Once</a><br />
</body>
</html> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T19:20:36.013

您可以在某处设置一个全局标志（例如 var mouseMoveActive = false;），它会告诉您是否已经在通话中，如果是，则不开始下一个通话。在检查它是否已经设置之后，您在进入 setTimeout 调用之前设置了标志。然后在 setTimeout() 中调用的例程结束时，您可以重置标志。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-19T21:49:33.547

我正在使用它来强制对所有过时的超时引用进行垃圾收集，这些引用确实不落后于我的脚本性能：

```
var TopObjList = new Array();
function ColorCycle( theId, theIndex, RefPoint ) {
    ...
    ...
    ...
    TopObjList.push(setTimeout( function() { ColorCycle( theId, theIndex ,CCr ); },CC_speed));
    TO_l = TopObjList.length;
    if (TO_l > 8888) {
        for (CCl=4777; CCl<TO_l; CCl++) {
            clearTimeout(TopObjList.shift());
            }
        }
    } 
```

我最初的草率代码在很短的时间内生成了一个 100,000+ 深的大型数组，但这确实起到了作用！

# asp.net - .Net Web 应用程序的最佳性能比较网站或资源？

> ID：315084
> 
> 赞同：0
> 
> 时间：2008-11-24T19:00:26.227
> 
> 标签：asp.net, performance, web-applications, architecture

我是一家咨询公司的 .Net 专家，有许多不同风格的开发人员使用许多不同的语言和框架。因为每个人都在尝试与我们的不同客户在提出什么技术方面推动他们自己的议程，所以我经常发现自己在与他们的经典争论中都是关于“为什么”.Net 可能是一个更好的技术解决方案给定客户要求。

经常在这里，辩论归结为性能问题。通常，这里争论的领域包括成本、可维护性和性能。我很难争论成本，因为总的来说，开源技术通常更便宜，尽管并且通常可以在总拥有成本方面为 .Net 加上一个好词（似乎很容易让人们相信如果应用程序架构经过精心设计，.Net 应用程序的可维护性成本相对较低），如果客户了解并且对与 Microsoft 许可相关的成本无动于衷，我们真的只会在此处推送 .Net。在可维护性方面，就像我之前提到的，这里的其他开发人员意识到，如果一个应用程序经过深思熟虑的设计，它可以带来多大的不同。

再说一次，它通常归结为关于性能的争论。到目前为止，我曾为已经使用 Microsoft 开发技术来开发其应用程序的公司工作，所以当我过去与其他人*讨论过*性能时，我从来没有做过必须*说服*性能的职位。我的其他同事总是吹嘘他们访问的这些不同的网站显示开源 Web 应用程序的性能有所提高。说了这么多，我想从这里的每个人那里知道的是，您通常去哪里获取有关某些 .Net Web 应用程序如何超越其他技术的信息？

提前感谢您的建议，

-马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T19:38:52.920

我很欣赏细节，但我必须说我最后忘记了你的问题。=)

无论如何，这是我过去一直在想的事情。关于什么技术是最好的，总是存在冲突。我们都知道在每一方你都会发现狂热者，所以很难剔除事实。从专业上讲，我在围栏两边都看到了成功/灾难。

对你来说，因为你对 .NET 有既得利益。我会展示成功案例，例如...（插入您想要的任何大牌网站）Facebook、SO 等。我还会找到 .NET 方面出现问题的案例并查明原因。就像你说的，这通常是糟糕的实施。我不知道我在 ASP.NET 网站上看到了多少 DailyWTF 故事表现不佳，但可以追溯到 1) 糟糕的设计 2) 实施 3) 编码。

一旦你有一个坚实的展示案例来证明这项技术的合理性，你当然可以谈论你自己过去的经历。你需要证明自己能够避免你的故事所暴露的同样的陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T19:58:16.140

.NET 在性能上与 C/C++ 相比有所下降。一般来说，它将在基准性能方面胜过 Python、Ruby 和 PHP。静态类型往往会转化为更快的本机代码。（也有例外，例如 Python 的手动调整 set() 性能比 .NET 中的 HashSets 更快）

差异可能归结为 apache 与 IIS（以及它们各自的缓存配置）、数据库架构等。可能会被误用或误解的功能（例如，ViewStates 和大型 GridViews，或使用大量隐藏的 WebControls）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T01:31:13.833

根据您正在构建的应用程序类型，我发现性能很少成为问题。那里的所有技术都可以表现得足够好。

在讨论 .net 与 java/ruby/python 等时，我通常会尝试指出 .net 的其他好处。

有一次我的老板问我为什么用 .net 而不是其他的？他想知道，因为他可以很便宜地得到一个 PHP 程序员。作为报告的一部分，我们用 4 种不同的语言编写了一个简单的 Web 应用程序，而 .net 应用程序是迄今为止运行速度最快的。在那之后，我们巩固了.net。这是 .net 新出现的时候，所以我们都没有真正了解它。我们来自 ASP、PHP、Coldfusion 和 Java 背景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-27T15:40:18.253

如果您正在寻找 .Net 性能故事，您可以收听[这个 dot net Rocks 节目](http://www.dotnetrocks.com/default.aspx?showNum=666)

# asp.net - 在 GridView 中交错行/列颜色

> ID：315091
> 
> 赞同：3
> 
> 时间：2008-11-24T19:05:28.057
> 
> 标签：asp.net, css, gridview

假设您有一个 GridView，其中包含几列，例如：

| 福 | 酒吧 | 总计 |

并且您使用样式表使交替的行具有不同的颜色，例如浅蓝色和白色。

有没有一种好方法可以让特定的列以不同的颜色交替出现？例如，我可能希望 Total 列以中红色和浅红色交替显示，以在大网格中引起注意。

顺便说一句，我知道您可以以编程方式更改单元格的颜色。但是，如果可能的话，我想坚持使用 CSS，所以我所有的样式都在一个地方。当我在事件处理程序中时，我也看不到一种简单的方法来判断我是否处于交替行中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T19:14:34.513

如果你使用 jQuery，你可以很容易地做到这一点。

```
$("table#myTable col:odd").css("background-color:#ffe"); 
```

选择`:odd`器在大多数当前浏览器中不可用，但 jQuery 今天为我们提供了它。

对于行，您可以使用内置的 AlternatingRowStyle 元素来完成。

编辑：为一些不同的方法找到了一个很好的资源：[http ://css-discuss.incutio.com/?page=StylingColumns](http://css-discuss.incutio.com/?page=StylingColumns)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-10T09:03:18.517

我在搜索有关 WPF 的相同问题时发现了这`ListView`一点`GridView`。在那里，答案是使用Bea Costa 描述的[`StyleSelector`这样一个：](http://www.beacosta.com/blog/?cat=9)

```
public class ListViewItemStyleSelector : StyleSelector
{
    private int i = 0;
    public override Style SelectStyle(object item, DependencyObject container)
    {
        // makes sure the first item always gets the first style, even when restyling
        ItemsControl ic = ItemsControl.ItemsControlFromItemContainer(container);
        if (item == ic.Items[0])
        {
            i = 0;
        }
        string styleKey;
        if (i % 2 == 0)
        {
            styleKey = “ListViewItemStyle1″;
        }
        else
        {
            styleKey = “ListViewItemStyle2″;
        }
        i++;
        return (Style)(ic.FindResource(styleKey));
    }
} 
```

有一些 nits 可以让这个工作非常好，所有这些都在她的博客文章中进行了描述。

无法帮助的一件事是，这仅适用于行。列似乎总是必须使用`CellTemplate`/ `Style`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T19:33:58.857

除了[Ben 的建议](https://stackoverflow.com/questions/315091/interleave-rowcolumn-colors-in-a-gridview#315123)之外，Matt Berseth 也有一个很好的演示，演示如何使用 GridViewControlExtender 对列进行翻转突出显示，这非常好：

[http://mattberseth2.com/demo/Default.aspx?Name=GridViewControlExtender+II+-+Header+Cell+MouseOver+Styles+and+a+Few+More+Live+Examples&Filter=All](http://mattberseth2.com/demo/Default.aspx?Name=GridViewControlExtender+II+-+Header+Cell+MouseOver+Styles+and+a+Few+More+Live+Examples&Filter=All)

还有很多其他关于如何在他的网站上增强 GridView 的内容：

[http://mattberseth.com/blog/gridview/](http://mattberseth.com/blog/gridview/)

相当多的示例使用 ASP.NET Ajax 和 Ajax Control Toolkit 位，但它们并不难移植到轻量级 jQuery 等效项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T19:39:38.487

在这里走两条切线...

PS“当我在事件处理程序中时，也没有一种简单的方法来判断我是否处于交替行中。”

```
Row.RowState == RowState.Alternating 
```

此外，您始终可以在 ASP.NET 中的适当单元格上设置 CssClass，然后在您的 css 中定义该类。

# configuration - 在 Tomcat 中为单个目录配置符号链接

> ID：315093
> 
> 赞同：29
> 
> 时间：2008-11-24T19:05:38.667
> 
> 标签：configuration, tomcat, symlink

我有一个目录，一个进程将一些`.pdf`文件上传到该目录。这个过程是我无法控制的。

我需要使用 Tomcat 通过网站提供这些文件。

我有一个`/var/lib/tomcat5/webapps/test1`可用于网络的目录，我可以使用浏览器查看其中的文件。

因此，我创建了一个指向包含`.pdf`files: 的目录的符号链接`/var/lib/tomcat5/webapps/test1/files/`，但我在该目录中看不到任何内容。

如何`test1`仅在目录中启用符号链接？我不想在任何地方启用符号链接，只是为了让包含`.pdf`文件的目录对网络可用。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-27T01:32:32.237

`META-INF/context.xml`创建包含的解决方案存在一些问题`<Context path="/myapp" allowLinking="true">`

最大的问题是，如果 a`conf/context.xml`存在，则`allowLinking`in the `<Context>`there**优先于**a `<Context>`in a `META-INF/context.xml`。而如果 in 中的`conf/context.xml`没有明确定义`allowLinking`，那就同说`allowLinking="false"`。（请参阅[我](https://stackoverflow.com/questions/322260/which-tomcat-5-context-file-takes-precedence#322535)对上下文优先级问题的回答）

为确保您的应用允许链接，您必须说`<Context override="true" allowLinking="true" ...>`.

另一个问题`path="/myapp"`是`META-INF/context.xml`. 为防止混淆，最好将其排除在外。`path`在 a中唯一`<Context>`有任何影响的时间是在 中`server.xml`，并且[官方 Tomcat 文档建议不要](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)将`<Context>`s 放在 a 中`server.xml`。

最后，`myapp/META-INF/context.xml`我建议使用文件而不是`conf/Catalina/localhost/myapp.xml`文件。这种技术意味着你可以保持你的内容`META-INF`干净，这是你的 webapp 的胆量——我不喜欢冒险在我的 webapp 的胆量里乱七八糟。:-)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-24T19:21:44.343

`META-INF`在 Web 应用程序的目录中创建一个 context.xml 文件，其中包含：

```
<?xml version="1.0" encoding="UTF-8"?>

<Context path="/myapp" allowLinking="true">

</Context> 
```

更多信息：[http ://www.isocra.com/2008/01/following-symbolic-links-in-tomcat/](http://www.isocra.com/2008/01/following-symbolic-links-in-tomcat/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-02-24T12:15:03.560

这在 Tomcat 8+ 中的工作方式不同

[http://tomcat.apache.org/migration-8.html](http://tomcat.apache.org/migration-8.html)

```
<Resources allowLinking="true" /> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-06-08T14:50:58.453

是的，我知道这是一个老问题，但我找到了一个新的解决方案，使用 mount 和 --bind 选项而不是符号链接，并且 tomcat 不需要任何重新配置​​：

cd /var/lib/tomcat5/webapps/test1/

mkdir 文件

mount --bind /path/to/actual/upload/directory/files 文件

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-28T06:30:15.153

Context可以存在的地方有4个。

1.  tomcatdir/conf/server.xml
2.  tomcatdir/conf/context.xml
3.  tomcatdir/conf/Catalina/localhost/appname.xml
4.  tomcatdir/webapps/appname/META-INF/context.xml

在 tomcat 8 的情况下，allowlinking 属性不应在 Context 中指定，而应在 Resources 标签中指定。我的 tomcatdir/conf/context.xml 看起来像这样

```
<Context>
<WatchedResource>WEB-INF/web.xml</WatchedResource>
<WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>
 <Resources allowLinking="true" cachingAllowed="true" cacheMaxSize="100000" />
</Context> 
```

这个解决方案现在对我来说很好。但我也想分享我在提出这个解决方案之前犯的错误。

我在 tomcatdir/conf/server.xml 和 tomcatdir/conf/context.xml 中都定义了资源。并且仅在 tomcatdir/conf/server.xml 中设置了 allowLinking="true"。

我发现如果您不指定allowLinking，则等于将其设置为false。所以我从 server.xml 中删除了 Resources 标签，只留下了 tomcatdir/conf/context.xml，其中包含 allowLinking="true" 属性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-21T08:00:09.670

我以另一种方式做到了。我编辑这个其他配置文件：apache-tomcat-7.0.33/conf/ **server.xml** 在我添加的*主机*标签中：

```
<Context path="/data" docBase="C:\datos" debug="0" reloadable="true" crossContext="false"/> 
```

因此，您可以通过以下方式访问：[http://localhost/data](http://localhost/data)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-27T17:34:46.280

将以下行添加到 conf/context.xml 为我在 apache tomcat 8.5+ 上启用软链接

<**资源allowLinking="true" cachingAllowed="true" cacheMaxSize="100000"** >

# client - 当客户对交货的反应是否定的时，如何反应？

> ID：315097
> 
> 赞同：15
> 
> 时间：2008-11-24T19:06:32.923
> 
> 标签：client, project-management, feedback

我是一名初级程序员。由于我的主管告诉我与客户坐在一起，我加入了。尽管项目成功（从我的程序员的角度）交付，但我看到了客户不满意的表情！

**客户：**你可以包括这个！
**我们：**不在规范中！
**客户：**常识！

作为程序员，遇到这种情况你会如何应对？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-24T19:08:19.313

**你应该做些什么来避免这种情况：**

明确说明将包含哪些内容和不包含哪些内容。

问题可能归结为规范的未指定部分：

*   客户认为应该包含未指定的内容，即暗示。
*   开发人员认为不应该包含未指定的内容。

对于您拥有的未来规范，您应该有一个 catch all 声明，明确指出如果本文档中未指定某些内容，则可以在原始规范完成后完成，但需额外付费。

**在当前情况下你应该做什么：**

除了从您的经验中学习之外，您还应该与客户达成一些妥协。

示例：我会做这个你认为是常识的功能，但是对于所有未来的添加/更改，它必须明确指定。

即，您将不得不做更多的工作，但这是值得的，以换取您的客户将签订的所有明确规定的协议。

**规格不好？**

它一定是一个糟糕的规格吗？不。

不可能提及您的客户可能期望的所有内容，因此在您的规范/合同中清楚明确地说明上述所有声明至关重要。

**减少问题的其他方法：**

*   尽早让客户参与，向他们展示早期的原型。即使他们不要求。
*   尽量不要向客户出售最终产品，而更多的是为他的产品提供服务。
*   考虑一个敏捷开发模型或类似的东西，以便任务定义明确、规模小、有偿且无可争议。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-24T19:12:54.580

[这将是我转向敏捷开发](http://agilemanifesto.org/)理念的众多原因之一。在我看来，成功避免这种情况的唯一方法是要么无所不知，要么让客户大量参与，并经常提前发布/发布以尽快获得反馈。这样您就可以开发客户真正想要的软件，而不是客户告诉您他们想要的软件。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-24T19:24:50.420

**客户：**你可以包括这个！

**我们：**不在规范中！

**客户：**常识！！

**我们：**我们不会试图超出客户指定的范围——我们遵循规范。不实现未指定的特性与实现指定的特性同样重要。我们永远不会猜测我们的客户，他们非常重视这样一个事实，即他们可以完全依靠我们在预算内按时正确、完全地实施规范。

* * *

正如其他人非常正确地指出的那样，情况几乎总是比我上面描述的简单交换更复杂。

但是，如果实施者有一个带有客户签名的规范，该规范基本上实施了一项协议，即“一旦软件可证明地实现了规范中的所有功能，那么它就被认为是完整的”，并且任何额外的东西都在规范，因此在合同之外。

合同本身在这里也可能有一些输入 - 如果您没有签署合同，那么规范中的内容无关紧要 - 到目前为止，一切都是通过握手完成的，整个交易（包括付款）可以根据双方的任何不满下厕所。

但是，如果您有合同和规范，并且客户已经看到并签署了两者，那么他们就没有回旋余地来要求您走得更远。

现在，关于您是否应该实施它的问题：

***惊人的！*** 你交付了一个产品，他们只有*一个*投诉。实施该功能，称其为“免费赠品”（确保他们了解您在规范和合同之外工作，并明确向他们发送以美元显示的折扣的工作账单）并让他们在整个项目上签字.

它将明确表明该项目已结束，您超出了职责范围，并且任何进一步的“惊喜”都超出了合同/规范，这为您提供了一个很好的保护层，超出了您已经（表面上）有。

* * *

如果这是一个 UI 问题，那么你就陷入了困境。

规范是否充分描述了 UI？它有模型吗？如果规范没有非常详细地描述布局、使用和包含模型，我不会因为这个关于 UI 的投诉而责怪客户。

不管怎样，我认为你可以理解客户的立场——如果他们没有玩过 UI 模型，那么无论如何他们都会对结果感到失望——从心理上讲，你和你的客户不可能有脑子里有同样的想法（更不用说常识不是这样的事实！）。

坦率地说，如果这是客户第一次考虑在工作完成之前检查 UI，那么你没有向他们解释好的 UI 设计过程至少部分是你的错。这是他们的应用程序的一个关键特性，它与他们的想象非常紧密地耦合在一起——除非他们随着时间的推移“增长”了他们的内部表示以匹配现实，否则没有人会在这种情况下感到满意。

这种脱节只能通过频繁的用户和客户测试来解决，这显然是缺失的。这是关于客户教育和沟通的问题，而不是是否满足规范。

-亚当

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-24T19:58:24.830

*   期待最后一刻的范围变化——它们总是会发生，所以要做好准备。

*   经常与客户一起审查进度 - 以尽量减少意外。

*   合同：功能规格，加上带有初始上限的时间和材料（因此客户感到控制）。然后，当发生变化时，如有必要，请重新协商上限。

*   **永远不要**说他们不能拥有他们想要的东西。他们可以免费获得答案！

*   **总是**给他们比他们要求的多一点，所以他们知道你有一个积极的态度。

*   将客户视为与他们在同一个团队中。不要接受在法律上被描绘成对手。

*   与员工相比，他们可能认为承包商不忠诚。向他们展示你和他们的员工一样致力于他们的成功，你会加倍努力。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T19:16:39.360

经典案例...

这个问题没有明确的答案，但一切都围绕着沟通展开。应该采取预防措施（例如每周审查或类似的东西）。

当然，你不能免费重做整个事情。

两种方法：或者告诉他们把**关掉或者你处理它。

如果您选择交易：

*   首先，同情、尊重客户。
*   看看可以轻松更改的内容。
*   看看合同。
*   也许创建一个新的协议。
*   不要做太多。
*   让他们看到进展和所需的工作。
*   查找缺失功能的解决方法（可能使用其他出色的功能或可用工具。）

用你的常识，它是如此普遍，它甚至不好笑。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-24T19:26:32.303

这是固定投标安排的众多缺点之一。任何时候业务需求或优先级发生变化，或者甚至是一个简单的误解，都会导致从这种尴尬的情况到打电话给律师。改变并为做出改变所花费的任何时间获得报酬。此外，按小时安排并不排除制定计划或进行估算。

但是，一旦您处于固定出价的泡菜中，您的选择是：1）额外付费。2）免费做。3）不要这样做。

选项 3 是最差的，选项 1 是最好的。如果您与客户有良好的信任关系和良好的沟通，通常很容易得出选项 1。如果关系不好，那么您的问题就会更大。在这一点上，尽量避免laywers。

最后一点 - 任何具有“交付日期”的项目都不可避免地会遇到所描述的问题。具有上述日期的项目通常涉及撤退到洞穴几个月以隐藏开发，然后在利益相关者面前一次性释放产品。这是突然的，并为客户的期望和实际产品留下了充足的时间。相反，如果您展示产品的中间版本并每隔几周收集一次反馈，则会发生两件事。首先，您可以获得更好的反馈，最大限度地减少误解，并做出更好的产品。其次，没有一个时间点可以寄予厚望。客户的想象与实际存在的潜在差异要小得多。没有惊喜。

祝你好运。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T19:29:24.513

好吧，它没有成功交付。沿线的某个地方存在沟通不畅。在不知道具体细节的情况下，我认为这不是开发人员注入的问题，这可能不应该归咎于客户——需求收集任务是不够的。这是一个典型的例子，说明当软件方面没有领域专家或需求发现过程没有尽其所能时会发生什么......

如果是我，我会纠正这个问题并弄清楚如何在未来避免类似的问题。

你如何处理这个问题可以很好地决定与客户签订的合同/业务的未来。承担责任并纠正问题对您的公司来说是一个巨大的机会。

编辑：这是评估这种情况如何发生以帮助纠正它的好时机。有些公司选择彻底改造他们所做的一切，我认为这是一个错误。忽略它也是如此。把问题归咎于人也是错误的。

现在是了解这件事是如何发生的、过程是什么以及可能如何被抓住的好时机。我不会对规则或流程做出巨大的改变——但为未来的工作提出指导方针是一件好事。贵公司对缺点有一个明确的教训。失去纠正这个问题和纠正你的过程的机会将是浪费一个很好的机会。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-24T19:40:49.327

“你有什么反应？”

问题 1 - 您想继续与该客户的这种关系吗？严重地。如果他们要声称未指定的功能是“常识”，那么这可能不是维持或增强的良好关系。

如果你想脱离，那很容易。要求他们突出显示您未能遵守并玩该游戏的规范的每个部分。获取每个缺失功能​​的特定测试标准。拔牙。在确定缺少什么时保持对抗。不要问为什么。只需提前询问所有细节。这是缓慢和不愉快的。但无论如何你都不想要它们。

如果你想参与，那么，你将不得不改变这种关系。目前，您有一个被动进取的客户。他们不会说他们想要什么，但他们会说他们不想要什么。

这可能是他们的习惯；这可能是他们赢得让步的方式。或者这可能只是他们的草率规范。

如果你想要这种关系，你的反应有两个部分。

1.  短期。得到他们满意的东西。他们必须确定具体的变化。您必须用“成本”和“符合规范”对每个更改进行评分。

    *   有些东西很便宜，而且很合身。做那些。
    *   有些事情做起来很便宜，但不符合规范。三思而后行，让错误的规范导致返工。从某种意义上说，您从他们那里购买了规范；您可能还需要提高标准。
    *   （可悲地）符合规范的昂贵的东西是一个问题。你在这些方面遇到了麻烦，而且几乎必须这样做。
    *   不符合规范的昂贵的东西是每个人的经验教训。详细说明这些计划，包括规范重写和批准。
2.  长期。确保他们没有再次被 PA。尽早并经常回顾，使用敏捷技术。多沟通，多原型，多发布。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T19:57:11.883

ZiG，在我目前的工作地点，我不得不多次处理这个问题。我的团队（3 名开发人员）试图以敏捷的方式处理事情。我们习惯于获取中游甚至最后一秒的请求（然后我们会根据具体情况进行处理）。

但是，我们明确表示资源（尤其是时间）是有限的，如果不在规范中，我们将无法做出承诺。如果它被认为很重要并且不适合当前版本，我们通常会计划后续版本。如果它不重要，它会列在一个列表中。

我发现的一件事是，您可以让用户在时间 T 同意 Spec S。但是在时间 T + N，让他们记住他们同意 Spec S，或者让他们承认他们这样做了（使用我希望你一直保留的文档！）可能比它应该的更棘手。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-24T21:57:41.190

谈到OP的主题和问题：

如果您是受雇的程序员，那么我希望其他资源与您会面。可能是组织中的“高层”。

如果是这种情况，那么你的工作就是回答直接的问题，并控制你的情绪。是的，你可能会因为他们不喜欢你的代码而感到受伤，但是在老板面前表现出任何情绪并不是一件好事。相反，试着保持中立，让其他人处理会议。

现在，如果他们“把你晾在外面”，那么我会推荐以下问题：

a) “好的。我明白了。为什么您认为包含此功能是常识？我想知道为什么我们没有包含它。” （强迫他们解释他们的思维过程。一个人的常识对其他人来说很少是常识。）

b) “嗯，我相信我们可以在下一个版本中包含它。我会留给 XXX（老板）来达成双方同意的方法”（即不要与在场的老板谈论成本或免费赠品。 曾经。）

同样，这假设您是为交付产品的公司工作的程序员。现在，如果不止于此——即您是高层之一，那么这里的许多建议都非常好。

但是，如果您是高层或顾问程序员，那么首先

a) 为未满足此要求的流程道歉。承诺与客户合作以防止这种情况再次发生。

然后是其他策略。您是否为修复收费并不重要 - 道歉是对客户最重要的行动。再次，它值得重复 - 你不会为错过的功能道歉。你正在为让它滑倒的错误设计过程道歉。当您以这种方式开始然后寻求解决方案时，客户通常会非常乐于助人。

干杯，

-理查德

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-24T19:15:54.353

使用类似 SCRUM 的方法来避免这种死亡陷阱：让客户及早、频繁、非正式、受限制的委员会参与到开发过程中 -> 降低风险并提高敏捷性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-24T19:42:08.747

就你的字面问题而言，如何反应，最好的方法是忽略你的自我（“什么？！在我努力工作并达到规范之后？！”），而是专注于积极倾听并努力达成共识.

**客户：你可以包括这个！**

**我们：不在规范中！**

**客户：常识！！**

我们：我知道您对我们没有超出规范的范围感到不高兴。看到你对此的感受，我们怎样才能让你快乐？让我们看看是否有一个我们可以共同创建的流程来帮助每个人。

本质上，你不想把它变成“你说/我说”的死亡竞赛。解决这些问题的唯一方法涉及律师，然后没有人会赢。如果您同意规范或流程有问题，请共同努力解决这些问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-24T19:43:20.663

这种方法实际上对我很有效： **等待不喜欢你的软件的人离开并被喜欢它的人取代**。

显然你不能真正依赖它，但如果你确定你做得很好并且你的软件真的会满足雇用你的人的业务需求，那么等待它确实是值得的。有时客户的最初反应不会是他们的最终反应，特别是如果你能迅速融入他们的担忧。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-24T20:01:55.650

不要试图让客户觉得这是他们的错。这可能是他们的错，但让他们有这种感觉不会产生建设性的结果，只会惹恼他们。

相反，您应该意识到客户只会抱怨他们使用的软件，在大多数情况下是因为他们喜欢它。没有人抱怨没有人使用的软件。客户不可避免地会抱怨您交付的软件，即使您交付的正是他们要求的软件。所以不要出汗。软件永远不会完成。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-24T19:12:51.303

毫无疑问，需求收集负责人完全失败了。项目管理的额外失败没有迭代可交付成果并与客户进行签到会议。

但是，您有一个已签署的规范，并且您交付的内容与规范相匹配。因此，您的公司有两种选择：以业务发展的名义核销成本并免费进行更改，或者向他们收取更改请求的费用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-24T19:14:48.023

如果它不在规范中，它不在规范中。作为没有特定领域知识的开发人员，“常识”是一个无关紧要的概念。不同的行业以不同的方式工作，一种方法可能非常适合特定领域，但在另一种方法中完全不可接受。

编写好的规范是一种艺术形式。IMO，您可以采用敏捷的“分析师/程序员”方法进行小迭代，也可以编写和维护[详细、明确的规范](http://www.joelonsoftware.com/articles/fog0000000036.html)。两者都是高技能的任务，并且仍然是迭代的。您仍然需要改进规范。

无论哪种方式都不像听起来那么容易，并且都需要能够与客户建立良好的工作关系。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-24T19:16:46.757

您无法知道客户的想法。这种情况经常发生在没有任何编程项目经验的客户身上。我向您建议的是简单地向他展示“常识”在工程（或编程，如果您愿意）中的答案不是很准确。

向他展示生活中的其他例子，这将向他展示你无法构建非书面的东西。示例：盖新房子，盖房子的人需要一个详细的计划……他不会放可选的电插头，因为在客厅里，有一些额外的东西更“常识”……

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-24T19:18:30.603

我曾经有过这个。幸运的是，不是我创造了这个设计，因为这被证明是问题所在。

至关重要的是，您的公司与客户之间的沟通尽可能完美。确保你们互相理解。提出问题，让他们提出问题。不要让任何东西在设计中打开。这将是交货时的问题点。并在项目期间定期举行会议（最好有预发布）。

不幸的是，很多开发人员不善于沟通，很多客户没有意识到自己的需求。但是，如果您可以将差距最小化，您就会发现自己是一个快乐的（并且是回头客）的客户。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-24T19:50:18.543

这就是为什么我/与我一起工作的团队总是使用[原型风格的](http://en.wikipedia.org/wiki/Software_prototyping)方法，这意味着：

1.  收集需求后，您向客户展示软件的早期和基本版本
2.  客户说“**你可以包括这个**”/“**这是常识**”
3.  你改变你的设计以反映客户的需求
4.  从第 1 点迭代到正式发布

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-24T20:25:13.903

你必须尽早开始；尽早并经常告诉客户，规范/用例/用户故事是定义将交付什么的合同。在敏捷环境中，客户有很多机会观察到他们想要的一些“常识”特性并提出要求，这是敏捷方法的优势之一，但如果您开始接受“常识”添加最后，您正在为无限扩展做准备，可能会为此付出代价。

一些客户*期望*这一点；你告诉他们他们不能做的越多越好，最终的争论就越容易。

作为一名初级人员，我意识到你不能这样做——但是——但是一个艰难但必要的教训是，有时你必须解雇一个客户。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-24T20:39:30.817

你**学习**——一切都在学习，没有什么是个人的。
我们是我们所在领域的专家，我们比客户更了解他的需求。下次为下一位客户我们会提前建议所有有用的功能，让他开心，让他付出更多的钱，因为我们是专家，我们更了解。

# nhibernate - NHibernate：使用 Fluent NHibernate 处理中间表的最佳方式？

> ID：315106
> 
> 赞同：0
> 
> 时间：2008-11-24T19:09:03.027
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, fluent

您将如何在 Fluent NHibernate 中映射以下内容？

请参阅“18.3\. 客户/订单/产品”

[http://www.hibernate.org/hib_docs/nhibernate/html/example-mappings.html](http://www.hibernate.org/hib_docs/nhibernate/html/example-mappings.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T08:58:30.060

以下解决方案使用与示例中的解决方案相同的方法，生成的 XML 也一样。为简洁起见，我省略了指定列名等内容。

**领域：**

```
public class Customer
{
    private ISet<Order> orders = new HashedSet<Order>();

    public long Id { get; set; }
    public string Name { get; set; }
    public ISet<Order> Orders
    {
        get { return orders; }
        private set { orders = value; }
    }
}

public class Order
{
    public long Id { get; set; }
    public DateTime Date { get; set; }
    public Customer Customer { get; set; }
    public IList<LineItem> LineItems { get; private set; }
}

public class LineItem
{
    public int Quantity { get; set; }
    public Product Product { get; set; }
}

public class Product
{
    public long Id { get; set; }
    public string SerialNumber { get; set; }
} 
```

**映射：**

```
public class CustomerMap : ClassMap<Customer>
{
    public CustomerMap()
    {
        Id(x => x.Id)
            .GeneratedBy.Native();

        Map(x => x.Name);

        HasMany<Order>(x => x.Orders)
            .IsInverse()
            .AsSet();
    }
}

public class OrderMap : ClassMap<Order>
{
    public OrderMap()
    {
        Id(x => x.Id)
            .GeneratedBy.Native();

        Map(x => x.Date);

        References<Customer>(x => x.Customer);
        HasMany<LineItem>(x => x.LineItems)
            .Component(c =>
                {
                    c.Map(x => x.Quantity);
                    c.References<Product>(x => x.Product);
                }).AsList();
    }
}

public class ProductMap : ClassMap<Product>
{
    public ProductMap()
    {
        Id(x => x.Id)
            .GeneratedBy.Native();

        Map(x => x.SerialNumber);
    }
} 
```

要查看生成的 XML 映射，可以使用以下代码：

```
 Configuration config = new Configuration().Configure();
        PersistenceModel model = new PersistenceModel();

        model.addMappingsFromAssembly(typeof(CustomerMap).Assembly);
        model.Configure(config);

        model.WriteMappingsTo("your folder name here"); 
```

我希望它有所帮助。

/埃里克

# c++ - stdin/stdout/stderr 上的跨平台 (linux/Win32) 非阻塞 C++ IO

> ID：315111
> 
> 赞同：10
> 
> 时间：2008-11-24T19:11:27.607
> 
> 标签：c++, pipe, stdin, iostream, nonblocking

我正在尝试通过具有以下特征的标准输入/标准输出找到非阻塞 IO 的最佳解决方案：

*   只要有足够的数据，就读入*n 个*大小的块。
*   如果没有足够的数据，则读入部分块。
*   如果没有可用数据，则阻塞直到有一些数据（即使它可能小于*n*）。

目标是在立即处理“控制”代码的同时允许有效传输大型数据集（而不是让它们停留在某个部分填充的缓冲区中）。

我知道我可以通过使用线程和 istream::get() 循环来实现这一点，或者通过编写一堆特定于平台的代码（因为你不能 select() 在 Windows 中的文件句柄上）......（（那里也是 istream::readsome() ，这似乎很有希望，但我在谷歌上能找到的唯一结果是人们说它实际上效果不佳。））

由于我没有对这些 API 进行太多编码，也许有更好的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T19:14:08.837

也许[boost::asio](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)对你有用？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-14T23:37:45.373

我使用了线程和平台特定的代码。请参阅[我对另一个问题的回答](https://stackoverflow.com/questions/717572/c-nonblocking-io-on-linux/1280659#1280659)。我能够将特定于操作系统的东西放在 inputAvailable() 中（Linux 使用 select，Windows 只返回 true）。然后我可以在 Windows 上使用带有超时的 WaitForSingleObject() 来尝试让线程完成，然后使用 TerminateThread() 来杀死它。非常难看，但团队不想使用这种提升。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-14T23:46:39.007

我做了一些类似于 jwhitlock 的事情......我最终得到了一个 StdinDataIO 类，它包含了适当的特定于操作系统的实现（*），这样我的程序的其余部分就可以在 StdinDataIO 提供的文件描述符上选择（），保持幸福地无知Windows 对标准输入的限制。[如果您愿意，可以在这里](https://public.msli.com/lcs/muscle/muscle/dataio/StdinDataIO.h)和[这里](https://public.msli.com/lcs/muscle/muscle/dataio/StdinDataIO.cpp)看看，代码都是开源/BSD 许可的。

(*) 该实现是 Linux/MacOSX 的简单传递，而在 Windows 中，这是一个相当复杂的过程，即设置子线程以从标准输入读取数据并将其通过套接字接收的数据发送回主线程。 . 不是很优雅，但它有效。

# java - JPA 事务中的 java.lang.UnsupportedOperationException

> ID：315115
> 
> 赞同：0
> 
> 时间：2008-11-24T19:11:40.230
> 
> 标签：java, orm, jpa, persistence, openjpa

我很确定我对 JPA 不了解（我正在使用 OpenJPA）并且它导致了这个问题。我想复制一个 Job 实体。

```
@Entity
@Table(name="Job")
public class Job implements Serializable {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;

    @ManyToOne
    private Job job;

    @OneToMany(fetch = FetchType.EAGER)
    private Set<Job> jobCollection;
    ...

    public Job getJob() {
         return this.job;
    }

    public void setJob(Job job) {
         this.job = job;
    }

    public Set<Job> getCopies() {
         return this.jobCollection;
    }

    public void setCopies(Set<Job> jobCollection) {
         this.jobCollection = jobCollection;
    }
} 
```

在创建第一个副本时，运行以下代码可以正常工作。

```
public void testCopyJob(){
    Job job = jobManager.findJobById(100);
    Job jobWithCopies = null;
    try {
        jobWithCopies = jobManager.copyJob(job, "test copy");
    } catch (Exception e) {
        fail(e.getMessage());
    }
    Set<Job> copies = jobWithCopies.getCopies();
    assertEquals("num copies", 1, copies.size());

    //make a second copy
    Job jobWithCopies2 = null;
    try {
        jobWithCopies2 = jobManager.copyJob(jobWithCopies, "test copy");
        assertEquals("multiple copies", 2, jobWithCopies2.getCopies().size());
    } catch (Exception e) {
        e.printStackTrace();
        fail(e.getMessage());
    }
} 
```

尝试创建第二个副本失败并...

```
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R <openjpa-1.2.1-SNAPSHOT-r422266:686069 fatal general error> org.apache.openjpa.persistence.PersistenceException: null
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:1688)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.StateManagerImpl.assignObjectId(StateManagerImpl.java:523)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.StateManagerImpl.assignField(StateManagerImpl.java:608)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.StateManagerImpl.beforeAccessField(StateManagerImpl.java:1494)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.StateManagerImpl.accessingField(StateManagerImpl.java:1477)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at entities.Job.pcGetid(Job.java)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at entities.Job.hashCode(Job.java:402)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at java.util.HashMap.putImpl(Unknown Source)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at java.util.HashMap.put(Unknown Source)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at java.util.HashSet.add(Unknown Source)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.util.java$util$HashSet$proxy.add(Unknown Source)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at entities.controller.JobManager.copyJob(JobManager.java:140)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at entities.controller.JobManagerTest.testCopyJob(JobManagerTest.java:55)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:45)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at java.lang.reflect.Method.invoke(Method.java:599)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestCase.runTest(TestCase.java:154)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestCase.runBare(TestCase.java:127)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestResult$1.protect(TestResult.java:106)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestResult.runProtected(TestResult.java:124)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestResult.run(TestResult.java:109)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestCase.run(TestCase.java:118)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestSuite.runTest(TestSuite.java:208)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at junit.framework.TestSuite.run(TestSuite.java:203)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.cactus.server.runner.ServletTestRunner.run(ServletTestRunner.java:309)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.cactus.server.runner.ServletTestRunner.doGet_aroundBody0(ServletTestRunner.java:187)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.cactus.server.runner.ServletTestRunner.doGet_aroundBody1$advice(ServletTestRunner.java:225)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.cactus.server.runner.ServletTestRunner.doGet(ServletTestRunner.java:1)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at javax.servlet.http.HttpServlet.service(HttpServlet.java:718)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at javax.servlet.http.HttpServlet.service(HttpServlet.java:831)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1449)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:790)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:443)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:175)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3610)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:274)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:926)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1557)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:173)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:455)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:384)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:272)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:202)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:766)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:896)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1527)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R Caused by: java.lang.UnsupportedOperationException
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.DetachedStateManager.getMetaData(DetachedStateManager.java:696)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.strats.UntypedPCValueHandler.toRelationDataStoreValue(UntypedPCValueHandler.java:121)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.sql.RowImpl.setRelationId(RowImpl.java:327)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.sql.SecondaryRow.setRelationId(SecondaryRow.java:106)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.strats.HandlerStrategies.set(HandlerStrategies.java:150)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.strats.HandlerStrategies.set(HandlerStrategies.java:104)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.strats.HandlerCollectionTableFieldStrategy.insert(HandlerCollectionTableFieldStrategy.java:154)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.strats.HandlerCollectionTableFieldStrategy.insert(HandlerCollectionTableFieldStrategy.java:130)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.meta.FieldMapping.insert(FieldMapping.java:579)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.insert(AbstractUpdateManager.java:197)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.populateRowManager(AbstractUpdateManager.java:139)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.persistence.jdbc.kernel.ConstraintUpdateManager.flush(ConstraintUpdateManager.java:73)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at com.ibm.ws.persistence.jdbc.kernel.ConstraintUpdateManager.flush(ConstraintUpdateManager.java:60)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:655)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:130)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:2010)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:1908)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     at org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:1679)
[11/25/08 8:46:56:546 EST] 00000018 SystemErr     R     ... 52 more 
```

在 JobManager.copyJob() 方法中抛出此异常（在行：attachJob.getCopies().add(newJob);）...

```
@JPAManager(targetEntity=entities.Job.class)
public class JobManager {

      private EntityManager getEntityManager() {
              EntityManagerFactory emf = Persistence
                      .createEntityManagerFactory("import");
              return emf.createEntityManager();
      }

    @Action(Action.ACTION_TYPE.FIND)
    public Job findJobById(int id) {
            EntityManager em = getEntityManager();
            Job job = null;
            try {
               job = (Job) em.find(Job.class, id);
            } finally {
               em.close();
            }
            return job;
    }

    public Job copyJob(Job job, String newJobName) throws Exception {
            EntityManager em = getEntityManager();
            Job attachedJob = null;
            try {
                    em.getTransaction().begin();
                   //merge any changes made to job
                            attachedJob = em.merge(job);
                  //copy the job and establish bi-directional relationship
                            Job newJob = new Job(job);
                            newJob.setName(newJobName);
                            newJob.setJob(attachedJob);
                            em.persist(newJob);
                            attachedJob.getCopies().add(newJob);    
                  em.getTransaction().commit(); //commit changes to original job
             } catch (Exception ex) {
                    try {
                            if (em.getTransaction().isActive()) {
                                  em.getTransaction().rollback();
            }
                    } catch (Exception e) {
                            ex.printStackTrace();
                            throw e;
        }
                    throw ex;
             } finally {
                    em.close();
             }
            return attachedJob;
     }
} 
```

这是我正在使用的生成的数据库模式......

```
CREATE TABLE Job (id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY, JOB_ID INTEGER, PRIMARY KEY (id));
CREATE TABLE Job_jobCollection (JOB_ID INTEGER, element VARCHAR(254));
ALTER TABLE Job ADD FOREIGN KEY (JOB_ID) REFERENCES Job (id);
ALTER TABLE Job_jobCollection ADD FOREIGN KEY (JOB_ID) REFERENCES Job (id); 
```

查看 OpenJPA 1.2 源代码显示未实现 DetachedStateManager.getMetaData() 方法，所以我想知道为什么要调用它。有小费吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T22:25:06.350

您没有显示 Job 的复制构造函数的实现是什么，但是如果您从一个 Job 复制 id 作为该 Job 副本的 id，那么尝试保存复制作业将失败，因为 JPA 会知道具有该 ID 的 Job 实例存在于另一个对象中，并且应该保留该原始对象。

不过，看起来您的问题实际上出在 hashCode 中，并且您的示例显示您没有 hashCode 实现。看起来 openjpa 为您提供了基于 Id 值的 hashCode 实现。当您将某些内容添加到 Set 时，Set 将在您的对象上调用 hashCode() 作为确定对象是否已在 Set 中的过程的一部分。

我会尝试将 id 从 int 更改为 Integer（openjpa 似乎试图从一个可能只是盒装整数的对象进行分配）。或者实现你自己的 hashCode，它只返回 Id 的值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-24T23:37:53.513

我不熟悉 JPA，因此我不知道您的 JobManager 是否做错了事。

真正有用的是，如果您可以提供更长的堆栈跟踪，以便我们可以告诉您是什么导致您到达`DetachedStateManager.getMetaData()`并从那里开始。

yc

# cocoa - 在使用 Core Data 和推出自定义模型之间有哪些决定因素？

> ID：315126
> 
> 赞同：3
> 
> 时间：2008-11-24T19:14:49.007
> 
> 标签：cocoa, macos, core-data

可能有一些应用程序不适合 Core Data - 例如 Photoshop 或 Gimp 等图像处理程序。但是对于适合 Core Data 的应用程序，比如 Address Book 或 iCal，选择 Core Data 而不是自定义模型的标准是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T21:45:30.527

我最近开始了一个项目，我决定第一次在现实世界的应用程序中使用 Core Data。我的应用程序实际上是一个使用自定义数据模型的旧应用程序的 2.0 版，所以我花了很多时间讨论这个问题。以下是我问自己的一些事情。

*   是时候了解 Core Data 如何在一个重要的应用程序中工作，并修复在学习新技术时出现的小错误和特性。这可能包括一个或两个原型，因为您不想跳入使用诸如 Core Data 之类的东西，这些东西将负责您的应用程序的大块。

*   Core Data 是否会解决使用自定义数据模型时难以解决的问题，例如在内存中存储和保存非常大的数据集。

*   您是否想与 Core Data 不可用的平台共享代码，例如 Cocoa Touch。同样，如果您希望生成的数据文件兼容，而无需构建单独的导出器。

*   如果学习 Core Data 将有助于提高自己作为一名程序员的能力，无论是让你对 Mac 开发商店更具吸引力，还是仅供你自己使用。

*   如果您的数据模型足够简单以至于您真的不需要撤消管理器支持或关系之类的东西，那么核心数据真正闪耀的领域。

*   如果您正在使用外部库或其他技术（例如分布式对象），您可能不想使用 NSManagedObject。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T07:02:19.607

1.  无论出于何种原因，您是否将 10.4 之前的 Mac OS X 版本作为您的最低要求？如果是这样，则没有适合您的核心数据。
2.  您是否要允许用户手动订购列表中的东西？如果是这样，则没有适合您的核心数据——它不允许有序关系。（假设您可以创建一个可以排序的数字“序列”属性，但保持一致听起来很麻烦。）
3.  您是否将使用特定的文件格式作为您的本机格式？（例如，TextEdit 的原生格式是 RTF。）如果不是，您将不会使用 Core Data 进行磁盘存储，因此您可能根本不想使用它。（你*可以*，但我不确定还有足够的其他原因。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T14:12:19.723

踢:)

对我来说，您需要问自己的最大问题是：您是要在其中存储关键数据（用户创建的内容）还是可以轻松复制的数据（从互联网下载的内容）。如果你有第一个（用户创建的数据），我会尽快远离 Core Data，或者确保你的应用中有备份计划。

一旦错误开始出现（相信我，确实存在），例如，当您尝试将数据迁移到对象模型的新版本时，您就会卡住，完全卡住！告诉您的客户“我很抱歉我无法构建您的应用程序的新版本，我正在等待 Apple 提出修复”并不会在现实世界中削减它。没有访问或理解底层结构的官方方法，所以一旦它开始繁荣，你就只能靠自己了。

去过那里，不再去那里！

我的 2 美分

# php - 如何跨两个不同的域使用 cookie？

> ID：315132
> 
> 赞同：24
> 
> 时间：2008-11-24T19:17:05.117
> 
> 标签：php, cookies

我需要使用 cookie 在两个不同的域之间共享 SSO 信息，这可以在 PHP 中完成吗？如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T19:19:38.823

在这两个域上，放置从另一个域中提取的图像或其他 Web 元素。使用 URL 通知其他域用户 X 在域 A 上，并让域 B 将该用户 ID 与其系统上的该用户相关联。

正确执行有点复杂，但是如果您认为它会很好地工作。

Vinko 在评论中指出（谢谢！），我不应该理所当然地认为您了解所涉及的安全风险。如果此信息对任何人都具有任何价值，那么您应确保使用适当的加密、身份验证等来避免泄露敏感信息并避免各种攻击（重放、中间人等）。这应该不会太繁琐，因为您可以控制两个网站，并且可以为这两个网站选择一个安全的密钥，因为通信仅通过这个特殊的 URL 在两个服务器之间进行。不过请记住。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T19:26:16.190

你不知道，cookie 绑定到一个域。对此有限制，它被称为跨站点脚本。

现在，为您的问题提供一些帮助。您可以做的是创建一个脚本来帮助它们连接。

您可以全局重写所有指向您的第二个站点的链接，这些链接将需要来自第一个站点的 cookie 信息。

您可以将站点 a 中的所有 cookie 保存到他们都可以读取的数据库中，然后以编程方式将 cookie id 查询字符串附加到站点 b 的所有链接上，然后查找该 cookie id 并在下重新设置 cookie新域。

有一个非常好的 PHP 数据库抽象库 ( [PHP ADODB](http://adodb.sourceforge.net/) )，它有一个会话共享插件，使这一切变得更加容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T19:28:55.250

好吧，如果您的域只是不同的子域，您可以通过创建`.yourdomain.com`cookie 以简单的方式做到这一点。然后 cookie 与所有子域中的所有请求一起传递。

如果您想在不同的域之间共享 cookie，这并不是那么简单，因为浏览器将其视为安全风险。

确切的例子是什么？

对于某些软件，例如[Google Analytics](http://en.wikipedia.org/wiki/Google_Analytics)和其他跟踪图像等，您可能会被迫使用[P3P](http://en.wikipedia.org/wiki/P3P)标头让浏览器知道您在发送 cookie 时不关心安全性。然后，请求图像的浏览器获取 cookie 作为响应的一部分，并检查 P3P。如果一切正常，它会将 cookie 保存在硬盘上，并且下次您请求位于您网站上的图像（但属于其他域页面的一部分）时，浏览器将发送 cookie。但我想这无济于事;-)

我从来没有直接使用跨域的 cookie 值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T20:02:20.687

我不确定安全隐患，但有一个 Apache 设置允许您更改 cookie 的域。

```
# in httpd.conf (or equivalent)
php_value session.cookie_domain mydomain.com 
```

我已经成功地将这种方法用于子域，但从未尝试过不同的域。

在[http://us.php.net/manual/en/function.session-set-cookie-params.php](http://us.php.net/manual/en/function.session-set-cookie-params.php)中还描述了一种在 PHP 中设置变量方向的方法。该文档没有提及在不同域上设置 cookie 的能力或不能力。

在同一主题上有一个不同的[Stack Overflow 线程](https://stackoverflow.com/questions/244008/how-do-i-maintain-php-sessions-across-multiple-domains-on-the-same-server#244111)，但我认为它没有得到充分的回答。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T08:41:39.733

如果您有两个使用同一个域的站点并希望在它们之间共享 cookie，请在您的`settings.php`文件中为每个域设置如下内容：

```
ini_set('session.cookie_domain', '.EXAMPLE.com'); 
```

确保包含前导的“。” 在域名之前，否则将无法正常工作。

这允许用户在为域范围的 cookie 配置的任何站点之间维护登录状态。

这也可能产生负面影响，因此除非您熟悉要在其之间共享 cookie 的站点所涉及的所有 cookie，否则不要这样做。

# visual-studio - 如何开始在我的 Visual Studio 项目中使用 Nunit？

> ID：315139
> 
> 赞同：6
> 
> 时间：2008-11-24T19:18:42.197
> 
> 标签：visual-studio, nunit

我想开始使用 Nunit（最后），我正在使用 Visual Studio 2008。

是否像将 Nunit 导入我的测试项目一样简单？

我记得看到过一个 NUnit 的 GUI，它是否与单独的测试项目完全相同，除了直观地显示通过/失败？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T19:55:48.267

我喜欢在我的外部工具中添加指向 NUnit 的链接。

在 Tools->External Tools 下添加 NUnit

```
Title: &NUnit
Command: <path to nunit>
Arguments $(ProjectFileName) /run
Initial directory: $(ProjectDir) 
```

之后，您可以通过编译然后按 alt-t + n 来快速运行它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T19:23:36.163

是的，基本上就是这样。[就我个人而言，我发现ReSharper](http://jetbrains.com/resharper)附带的单元测试运行器非常出色——而且该工具本身非常值得获得许可的感觉。或者有[TestDriven.NET](http://testdriven.net/)。

拥有一个单独运行 nunit-gui 或 nunit-console 的测试项目非常好，但您确实希望整个单元测试体验尽可能无缝。编写和运行测试越容易，您就越有可能这样做——这是一件非常好的事情。不要低估由于用户体验*稍差*、在窗口之间切换等而逐渐累积的挫败感。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T19:24:07.363

NUnit 是 Visual Studio 2008 中没有的东西。它确实有一个控制台或一个图形用户界面 (gui)，可以在 VS2008 之外运行，或者可以附加到 VS2008 的进程进行调试。

如果您确实想要 VS2008 中的某些内容，则需要使用 ReSharper 之类的第三方插件。

编辑：过去已经[回答了这个问题](https://stackoverflow.com/questions/247900/is-there-a-free-visual-studio-addin-for-nunit#247920)（不是专门针对 VS2008，但仍然相关）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T19:27:36.937

我在 VS2005 中使用了[TestDriven.NET](http://testdriven.net/)，它改变了我开发和测试代码的方式。

您可以在任何类、模块、项目或解决方案上运行所有测试。您还可以在调试器中运行测试，这对于在出现问题时诊断和修复问题非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T19:25:04.897

GUI 很好，但如果您经常运行测试，您可能会放弃它，转而使用更快/集成的运行器。

在任何情况下，您都有一些关于如何运行测试的选项：

*   NUnit.Gui.Exe——你可以运行它并选择你的测试项目 dll 来运行测试。当它打开时，它会在你构建时刷新，所以你可以 ALT-TAB 到它并重新运行你的 tets。我见过的另一种技术是将此应用程序设置为您的测试项目的启动程序。然后将你的测试项目设置为启动项目并按F5。
*   下载并使用[TestDriven.net](http://testdriven.net)。这速度很快，可以让您在坐在测试或解决方案资源管理器中的节点上时从右键菜单运行*测试*。这是我主要使用的。我已将其映射到 CTRL+T 以便快速访问。
*   [Resharper](http://jetbrains.com/resharper)也有一个测试运行器。这为您提供了 Visual Studio 内带有红/绿灯的 GUI。它还在每个测试旁边为您提供了一个小图标，以快速运行它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-26T17:15:03.333

您可以使用此处提供的插件 NUnitForVS：http: [//www.codeplex.com/NUnitForVS](http://www.codeplex.com/NUnitForVS)

这将测试运行和结果集成到您的 VS 2008 IDE 中。我们已经使用它几个月了，它对我们来说效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-04T07:53:40.220

您还应该记住，使用 VS 2008 专业版，您可以使用以前仅在团队版本中可用的 MS 单元测试工具。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-08T20:43:16.203

您可以将它作为外部程序运行，但对我来说它不是很好。我喜欢在 VS 中开始测试时。因此，如果您有 ReSharpe，您可以转到工具 -> 选项 -> 环境 -> 键盘并为 ReSharper_UnitTest_ContextRun 设置热键。我将它设置为 Ctrl + t。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-23T10:57:43.807

我将我的 nunit 控制台程序附加到 Post-build 事件，所以每次我构建我的项目时，测试都会运行而不需要第三方工具（除了 NUnit）。我正在使用 Visual Studio 2010，但我很确定您可以在 Visual Studio 2008 中实现相同的行为。

去做这个：

1.  打开项目的属性窗口（包含测试的项目）
2.  在生成后事件命令行中添加以下行：“C:\Program Files (x86)\NUnit 2.5.10\bin\net-2.0\nunit-console-x86.exe”

构建项目，输出应写入输出窗口（构建）。选择 x86 版本的控制台运行器很重要。

# java - Java Beans：我错过了什么？

> ID：315142
> 
> 赞同：18
> 
> 时间：2008-11-24T19:20:05.330
> 
> 标签：java, javabeans

我想知道我是否遗漏了有关 Java Beans 的内容。我喜欢我的对象在构造函数中尽可能多地进行初始化，并且具有最少数量的突变体。Beans 似乎直接反对这一点，并且通常感觉很笨重。由于不将对象构建为 Bean，我错过了哪些功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T19:59:22.753

听起来你在正确的轨道上。不是你错过了 Java Beans 的要点，而是其他程序员在滥用它们。

Java Beans 规范旨在与可视化工具一起使用。这个想法是应用程序设计人员能够以交互方式配置对象的实例，然后序列化（或为配置的 bean 生成代码），以便可以在运行时重构它；目的是它不会在运行时发生突变。

不幸的是，许多开发人员不了解[访问器违反封装](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)。他们使用结构而不是对象。他们没有看到其他类，甚至是其他包，依赖于类的数据成员有什么问题。

当然，您通常需要配置对象的实例。只是这应该通过某种配置功能来完成。这可能是一个依赖注入容器、一个“BeanBox”风格的可视化工具，或者只是读取您手动编写的 JSON、XML 或属性文件。关键是在运行时这些对象实际上是不可变的；客户端只是调用他们的操作，他们不访问他们的属性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T19:33:17.843

> 我喜欢我的对象在构造函数中尽可能多地进行初始化，并且具有最少数量的突变体。

偏爱不可变对象是明智的选择。然而，bean 的好处是框架/工具/库可以在运行时确定类的属性，而无需您实现特定的接口。

例如，假设您有一个 Person bean 的集合，并且每个 bean 都有名称、年龄、身高等属性。

您可以使用以下代码按名称（例如）对这个 bean 集合进行排序：

```
Collection<Person> myCollection = // initialise and populate the collection
Comparator nameCompare = new BeanComparator("name");
Collections.sort(myCollection, nameCompare); 
```

BeanComparator类知道如何从每个对象中提取“名称”属性，因为遵循 Java Beans 约定，即您可以避免实现接口的“开销”，例如[：](http://commons.apache.org/beanutils/commons-beanutils-1.6.1/docs/api/org/apache/commons/beanutils/BeanComparator.html)

```
interface Nameable {
    public String getName();
    public void setName(String name);
} 
```

Spring MVC 的另一个示例是存储请求 URL 参数的 bean。这可以在 web 控制器中定义（在 Struts 中称为“Action”），如下所示：

```
public ModelAndView searchUsers(UserSearchCriteria criteria) {
    // implementation omitted
} 
```

因为 UserSearchCriteria 应该是一个 JavaBean，如果请求 URL 包含一个参数，例如`maxItems=6`，Spring 框架“知道”它应该调用一个带有签名的方法

```
void setMaxItems(int maxItems); 
```

本质上，JavaBeans 只是一个简单的约定，它允许在运行时（通常通过工具或框架）动态地发现类的属性，当不方便/不可能先验地知道可能提供的属性时。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T17:32:56.930

我同意最小化可变性是一件好事的想法。正如已经指出的，JavaBeans 的优点是它们很容易被框架处理。

为了充分利用“两全其美”，我认为一个不错的选择是使用[Builder 模式](http://rwhansen.blogspot.com/2007/07/theres-builder-pattern-that-joshua.html)，稍微修改 Builder 以符合 JavaBeans 标准。因此，如果您需要一个要求您的类符合 JavaBeans 标准的框架功能，您可以使用 Builder 代替实际的类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T20:59:48.873

当你听到“bean”这个词时，期望看到的是某种“容器”。任何类型的 JavaBean 的想法是为可以在运行时添加和操作的组件提供统一的接口约定。普通 JavaBean 只是其中最简单的示例：它提供了所有接口可能性并且是可序列化的，这意味着您可以创建 bean 的实例、修改它们、保存它们并重新加载它们。

很久很久以前，我编写了一个 Java 编辑器，它包含一个表示文本字符串的简单“数据库”，并有一个使用 bean 的“插件架构”。您可以通过将 bean 从 bean 存储箱中拖出并将其放在编辑器上来向编辑器添加行为；一旦你这样做了，行为（例如，Cntl-T 在光标处转置字符）在编辑器中自动可用。bean 有一个已知的接口——它们知道如何向容器询问其数据结构和一个 doSomething() 方法——并且容器知道动态加载类文件、实例化对象并将其访问权限设置为数据库。

顺便说一句，访问器违反封装并不一定是真的。然而，确实，仅仅因为你有一个成员，你就*不需要*为它提供 get 和 set 方法。JavaBean 规范对此有点不清楚；关键是为那些需要在对象“合同”中的东西提供getter和setter。

在将内省和反思添加到语言中并真正理解之后，对这些约定的需求有所减少；在早期的 Java 中，您需要有一个约定来查找方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T19:22:54.107

Bean 是这样配置的，因此自动化工具可以创建和修改 Bean。它们并不一定是伟大的设计模式。

这些工具的示例：

[休眠](http://www.hibernate.org/)
[JMX](http://java.sun.com/javase/technologies/core/mntr-mgmt/javamanagement/)

# c# - 匿名类型 - 是否有任何区别特征？

> ID：315146
> 
> 赞同：28
> 
> 时间：2008-11-24T19:21:48.227
> 
> 标签：c#, .net, generics, extension-methods, anonymous-types

有什么东西可以用来确定一个类型是否真的是匿名类型？例如接口等？

目标是创建类似以下内容...

```
//defined like...
public static T Get<T>(this IAnonymous obj, string prop) {
    return (T)obj.GetType().GetProperty(prop).GetValue(obj, null);
}
//...

//And then used like...
var something = new { name = "John", age = 25 };
int age = something.Get<int>("age"); 
```

或者这只是匿名类型的美丽？没有什么可以自我识别，因为它采用了新的形状？

**注意**- 我意识到您可以为**对象**类编写扩展方法，但在我看来，这似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-24T19:38:13.950

编辑：下面的列表适用于 C# 匿名类型。VB.NET 有不同的规则——特别是，它可以生成可变的匿名类型（默认情况下会生成）。Jared 在评论中指出，命名风格也不同。基本上这一切都很脆弱......

您无法在通用约束中识别它，但是：

*   它将是一个类（而不是接口、枚举、结构等）
*   它将应用[CompilerGeneratedAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.compilergeneratedattribute.aspx)
*   它将覆盖 Equals、GetHashCode 和 ToString
*   它将在全局命名空间中
*   它不会嵌套在其他类型中
*   它将是内部的
*   会被封
*   它将直接来自`object`
*   它将是具有与属性一样多的类型参数的泛型。（你*可以*有一个非泛型匿名类型，没有属性。不过这有点毫无意义。）
*   每个属性都有一个类型参数，其名称包括属性名称，并且属于该类型参数，例如 Name 属性变成 <>_Name 类型的属性
*   每个属性都是公开的和只读的
*   对于每个属性，都会有一个对应的只读私有字段
*   不会有其他属性或字段
*   每个类型参数都会有一个构造函数取一个参数，其顺序与类型参数相同
*   每个方法和属性都将应用[DebuggerHiddenAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerhiddenattribute.aspx)。
*   类型名称将以“<>”开头并包含“AnonymousType”

然而，规范很少保证这一点 - 因此它可能会在下一版本的编译器中发生变化，或者如果您使用 Mono 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T19:23:52.093

我记得，有一个[`[CompilerGenerated]`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.compilergeneratedattribute.aspx)标记... 2 secs

再加上名字会很奇怪，它会是一个通用类型；-p

实际上，对于“get”等，我可能只会使用静态（非扩展）方法。

如果您只是想要一种从匿名类型的实例中获取值的方法（在以后的某个时间点），那么 lambda 可能是最好的选择 - 请注意，您需要一些技巧来实现这一点：

```
 static void Main()
    {
        var foo = new { name = "John", age = 25 };
        var func = Get(foo, x => x.age);
        var bar = new { name = "Marc", age = 30 };
        int age = func(bar);
    }
    // template here is just for type inference...
    static Func<TSource, TValue> Get<TSource, TValue>(
        TSource template, Func<TSource, TValue> lambda)
    {
        return lambda;
    } 
```

（编辑评论）肯定*有*这个属性：

```
 var foo = new { A = "B" };
        Type type = foo.GetType();

        CompilerGeneratedAttribute attrib = (CompilerGeneratedAttribute) Attribute.GetCustomAttribute(
            type, typeof(CompilerGeneratedAttribute)); // non-null, therefore is compiler-generated 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T19:24:24.650

出于扩展方法的目的，无法区分匿名类型。扩展方法通过为编译时可命名类型指定方法来工作。匿名类型是不可命名的，因此在编译时不可见。这使得它们与扩展方法不兼容。

# vb.net - 是否可以在多列上使用 BindingSource.find？

> ID：315160
> 
> 赞同：0
> 
> 时间：2008-11-24T19:26:14.303
> 
> 标签：vb.net, bindingsource

是否可以在多列上使用 BindingSource.find？

我有一个树视图和一个组合框。组合框提供用于构建树视图的 ID。当我在树视图中选择一个节点时，我想显示来自组合框的 ID 的详细信息/子信息以及来自树节点的标签/ID 值。

做这个的最好方式是什么？我试图使用绑定到绑定源的控件。我想更改绑定源的位置，但是我需要在绑定源中搜索组合中的值以及我刚刚选择的树节点？？？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T21:55:33.893

我不知道这是否是完成我想要完成的工作的最佳方式，但 BindingSource.Filter 方法非常适合我的场景。

# wpf - 如何在 WPF 应用程序中使用 FolderBrowserDialog

> ID：315164
> 
> 赞同：56
> 
> 时间：2008-11-24T19:26:52.133
> 
> 标签：wpf, winapi

我正在尝试使用我的 WPF 应用程序中的 FolderBrowserDialog - 没什么特别的。我不太关心它是否具有 Windows 窗体的外观。

但是，当我调用 ShowDialog 时，我想传递属于 IWin32Window 的所有者窗口。如何从我的 WPF 控件中获取此信息？

其实，有关系吗？如果我运行此代码并使用不带参数的 ShowDialog 重载，它可以正常工作。什么情况下需要通过所有者窗口？

谢谢，

克雷格

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-24T20:53:24.500

这是我的最终版本。

```
public static class MyWpfExtensions
{
    public static System.Windows.Forms.IWin32Window GetIWin32Window(this System.Windows.Media.Visual visual)
    {
        var source = System.Windows.PresentationSource.FromVisual(visual) as System.Windows.Interop.HwndSource;
        System.Windows.Forms.IWin32Window win = new OldWindow(source.Handle);
        return win;
    }

    private class OldWindow : System.Windows.Forms.IWin32Window
    {
        private readonly System.IntPtr _handle;
        public OldWindow(System.IntPtr handle)
        {
            _handle = handle;
        }

        #region IWin32Window Members
        System.IntPtr System.Windows.Forms.IWin32Window.Handle
        {
            get { return _handle; }
        }
        #endregion
    }
} 
```

并实际使用它：

```
var dlg = new FolderBrowserDialog();
System.Windows.Forms.DialogResult result = dlg.ShowDialog(this.GetIWin32Window()); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-24T19:30:33.887

如果您指定所有者，您将在指定的 WPF 窗口上获得一个模态对话框。

要获得与 WinForms 兼容的 Win32 窗口，请创建一个像这样实现 IWin32Window 的类

```
 public class OldWindow : System.Windows.Forms.IWin32Window
{
    IntPtr _handle;

    public OldWindow(IntPtr handle)
    {
        _handle = handle;
    }

    #region IWin32Window Members

    IntPtr System.Windows.Forms.IWin32Window.Handle
    {
        get { return _handle; }
    }

    #endregion
} 
```

并在您的 WinForms 中使用此类的实例

```
 IntPtr mainWindowPtr = new WindowInteropHelper(this).Handle; // 'this' means WPF Window
        folderBrowserDialog.ShowDialog(new OldWindow(mainWindowPtr)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-09T08:38:48.737

我意识到这是一个老问题，但这是一种可能稍微优雅一点的方法（以前可能有也可能没有）......

```
using System;
using System.Windows;
using System.Windows.Forms;

// ...

/// <summary>
///     Utilities for easier integration with WinForms.
/// </summary>
public static class WinFormsCompatibility {

    /// <summary>
    ///     Gets a handle of the given <paramref name="window"/> and wraps it into <see cref="IWin32Window"/>,
    ///     so it can be consumed by WinForms code, such as <see cref="FolderBrowserDialog"/>.
    /// </summary>
    /// <param name="window">
    ///     The WPF window whose handle to get.
    /// </param>
    /// <returns>
    ///     The handle of <paramref name="window"/> is returned as <see cref="IWin32Window.Handle"/>.
    /// </returns>
    public static IWin32Window GetIWin32Window(this Window window) {
        return new Win32Window(new System.Windows.Interop.WindowInteropHelper(window).Handle);
    }

    /// <summary>
    ///     Implementation detail of <see cref="GetIWin32Window"/>.
    /// </summary>
    class Win32Window : IWin32Window { // NOTE: This is System.Windows.Forms.IWin32Window, not System.Windows.Interop.IWin32Window!

        public Win32Window(IntPtr handle) {
            Handle = handle; // C# 6 "read-only" automatic property.
        }

        public IntPtr Handle { get; }

    }

} 
```

然后，从您的 WPF 窗口中，您可以简单地...

```
public partial class MainWindow : Window {

    void Button_Click(object sender, RoutedEventArgs e) {
        using (var dialog = new FolderBrowserDialog()) {
            if (dialog.ShowDialog(this.GetIWin32Window()) == System.Windows.Forms.DialogResult.OK) {
                // Use dialog.SelectedPath.
            }
        }
    }

} 
```

* * *

> 其实，有关系吗？

我不确定*在这种情况下*是否重要，但通常，您应该告诉 Windows 您的窗口层次结构是什么，因此如果在子窗口处于模态时单击父窗口，Windows 可以提供视觉（可能是听觉）线索用户。

此外，当有多个模态窗口时，它确保“正确”窗口位于顶部（不是我提倡这样的 UI 设计）。我见过由某家价值数十亿美元的公司设计的 UI（其外壳仍未命名），只是因为一个模态对话框“卡”在另一个模态对话框下面，而用户甚至不知道它在那里，更不用说如何关闭了它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T20:27:41.603

好的，现在想通了 - 感谢 Jobi 的回答很接近，但并不完全。

在 WPF 应用程序中，这是我的有效代码：

首先是一个助手类：

```
private class OldWindow : System.Windows.Forms.IWin32Window
{    
    IntPtr _handle;    
    public OldWindow(IntPtr handle)
    {
        _handle = handle;
    }   

    #region IWin32Window Members    
    IntPtr System.Windows.Forms.IWin32Window.Handle
    {
        get { return _handle; }
    }    
    #endregion
} 
```

然后，使用这个：

```
 System.Windows.Forms.FolderBrowserDialog dlg = new FolderBrowserDialog();
    HwndSource source = PresentationSource.FromVisual(this) as HwndSource;
    System.Windows.Forms.IWin32Window win = new OldWindow(source.Handle);
    System.Windows.Forms.DialogResult result = dlg.ShowDialog(win); 
```

我确信我可以更好地总结这个，但基本上它可以工作。耶！:-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-27T16:04:23.887

```
//add a reference to System.Windows.Forms.dll

public partial class MainWindow : Window, System.Windows.Forms.IWin32Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void button_Click(object sender, RoutedEventArgs e)
    {
        var fbd = new FolderBrowserDialog();
        fbd.ShowDialog(this);
    }

    IntPtr System.Windows.Forms.IWin32Window.Handle
    {
        get
        {
            return ((HwndSource)PresentationSource.FromVisual(this)).Handle;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-10T08:56:27.100

VB.net翻译

```
Module MyWpfExtensions

Public Function GetIWin32Window(this As Object, visual As System.Windows.Media.Visual) As System.Windows.Forms.IWin32Window

    Dim source As System.Windows.Interop.HwndSource = System.Windows.PresentationSource.FromVisual(Visual)
    Dim win As System.Windows.Forms.IWin32Window = New OldWindow(source.Handle)
    Return win
End Function

Private Class OldWindow
    Implements System.Windows.Forms.IWin32Window

    Public Sub New(handle As System.IntPtr)
        _handle = handle
    End Sub

    Dim _handle As System.IntPtr
    Public ReadOnly Property Handle As IntPtr Implements Forms.IWin32Window.Handle
        Get

        End Get
    End Property

End Class

End Module 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-04-09T21:47:57.643

这是一个简单的方法。

```
 System.Windows.Forms.NativeWindow winForm; 
public MainWindow()
{
    winForm = new System.Windows.Forms.NativeWindow();
    winForm.AssignHandle(new WindowInteropHelper(this).Handle);
    ...
}
public showDialog()
{
   dlgFolderBrowser.ShowDialog(winForm);
} 

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T19:38:26.820

传递所有者句柄的优点是 FolderBrowserDialog 不会成为该窗口的模式。这可以防止用户在对话框处于活动状态时与您的主应用程序窗口进行交互。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T19:42:48.183

您应该能够通过使用 PresentationSource.FromVisual 并将结果转换为实现 IWin32Window 的 HwndSource 来获得 IWin32Window。

同样在[这里](http://www.codeproject.com/KB/WPF/MessageBox.aspx)的评论中：

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-08T14:00:46.297

为什么不使用内置的 WindowInteropHelper 类（请参阅命名空间 System.Windows.Interop）。这个类已经包含了 IWin32Window ;)

所以你可以忘记“OldWindow 类”......用法保持不变

# python - 如何调试 Web2py 应用程序？

> ID：315165
> 
> 赞同：19
> 
> 时间：2008-11-24T19:27:05.423
> 
> 标签：python, debugging, web2py

是否可以？调试是指设置断点、检查值并逐步推进。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T19:03:51.727

[您可以使用winpdb](http://winpdb.org/)通过 TCP/IP 对 python Web 应用程序进行远程调试。

（截至 2019 年 6 月，链接显示已关闭。试试[PyPI winpdb](https://pypi.org/project/winpdb/)）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T20:22:22.053

我没有使用过 web2py，但如果它在终端窗口中运行，你可以使用标准的 pdb 东西。在代码中的某处添加这一行：

```
import pdb; pdb.set_trace() 
```

这将调用调试器并中断。然后您可以使用[PDB](http://docs.python.org/lib/module-pdb.html)命令：n 跳到下一行，l 列出代码，s 跳入函数，p 打印值等。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-30T10:04:10.870

可以使用以下设置调试基于 Web2py 构建的应用程序：

1.  Eclipse IDE
2.  将 Pydev 安装到 Eclipse
3.  根据需要在代码上设置断点
4.  在 Eclipse 中，右键单击文件 web2py.py 并选择 Debug As -> Python Run
5.  当断点被击中时，Eclipse 将跳转到断点，您可以在其中检查变量并单步执行代码

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-03-08T15:45:57.873

您还可以使用 Visual Studio 2010。方法如下：

*   下载并安装[适用于 Visual Studio 的 Python 工具](http://pytools.codeplex.com/ "适用于 Visual Studio 的 Python 工具")。
*   从现有代码创建一个新项目（*File > New > Project From Existing Code...*）
*   指定您的 web2py 文件夹并使用默认值。
*   右键单击 web2py.py 并选择*Set as Startup File*。
*   设置断点并按 F5（运行）或右键单击 web2py.py 并选择*Start with Debugging*。

如果您已经使用 Visual Studio，这是一个不错的设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-10T04:29:57.460

是的，有可能，由于“跨度预防”，我仍然不允许发布屏幕截图，但这是我网站上托管的完整屏幕截图：

[http://static.techfuel.net/debug_web2py.png](http://static.techfuel.net/debug_web2py.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-26T15:27:53.640

我正在使用 Eclipse 和 PyDev 调试 web2py 应用程序。这是一篇文章： [http ://www.web2pyslices.com/main/slices/take_slice/2](http://www.web2pyslices.com/main/slices/take_slice/2)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-06T14:42:37.923

正如卡尔所说，这很简单：

1.  在 Eclipse 中安装 PyDev
2.  右键单击您的 Web2Py 项目，选择 Debug As > Python Run
3.  选择 web2py.py 作为要运行的文件

不需要其他插件或下载。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-29T05:29:31.623

这是一篇关于使用 pdb 调试 python 的文章，它将与 web2py 一起使用。[http://sontek.net/debugging-python-with-pdb](http://sontek.net/debugging-python-with-pdb)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-01T02:30:08.350

@Ned Batchelder 几乎是正确的，但在 web2py 中执行此操作的标准方式略有不同。

而不是`import pdb; pdb.set_trace()，你使用代码：

```
from gluon.debug import dbg
dbg.set_trace() 
```

执行 Web 应用程序时，应用程序将在到达这部分代码时冻结。然后，您转到[http://127.0.0.1:8000/admin/debug/interact](http://127.0.0.1:8000/admin/debug/interact)（使用应用程序的根 URL），它将显示一个完全交互式的、基于 Web 的调试器：

[![在此处输入图像描述](https://i.stack.imgur.com/NNkzf.png)](https://i.stack.imgur.com/NNkzf.png)

请参阅[文档](http://www.web2py.com/books/default/chapter/29/03/overview#Integrated-web-based-debugger)。

# .net - Windows 2000 和 Windows 2003 RC2 使用 Windows Crypto API 加密/解密？

> ID：315171
> 
> 赞同：1
> 
> 时间：2008-11-24T19:29:45.760
> 
> 标签：.net, c++, windows, encryption

我们的应用程序在 C++ 代码中使用 RC2 加密一个值，我在 .NET 中编写了一个解密例程

问题是它在我们的开发服务器上运行良好，它是 Windows 2003，但在 Windows 2000 上却失败了。它运行相同的代码，我检查了其他所有内容，似乎 2 加密方式存在差异。

有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T20:02:57.207

1.  确保 Windows 2000 具有 SP3，否则加密工作的可能性要小得多，尤其是在使用 Capicom（或其包装的 api）时。
2.  如果使用 Capicom（或它封装的 api），Windows 2000 并不支持所有的加密算法和密钥长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T06:25:35.720

win2000/winxp 加密/解密有一个[不为人知的问题。](http://support.microsoft.com/kb/841715)win2000 上的 Cryptography Service Provider 的有效密钥长度为 40，即使您使用 128 位密钥也是默认使用的。因此，要解决这个问题，您必须在 2000 上手动重置有效密钥长度，或者您可以在 winxp（或在我的情况下为 win2003）上解密之前将其设置为 40。

如果您使用[C# 进行解密](http://www.eggheadcafe.com/forumarchives/platformsdksecurity/Jul2005/post23356686.asp)，则无法将有效密钥大小设置为与使用 RC2CryptoServiceProvider 类的密钥大小不同的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T06:56:01.353

我在使用加密服务提供商的 XP SP1 和 XP SP2 之间遇到了同样的问题，对于 1 个我目前不记得的特定加密，加密值是不同的。

# asp.net - 具有 .NET 网格视图的动态列和数据源

> ID：315176
> 
> 赞同：1
> 
> 时间：2008-11-24T19:32:04.290
> 
> 标签：asp.net, gridview, page-init

我正在处理一个多用途页面，而不是向同一页面添加多个网格，我们希望在页面中使用单个 GridView，并在 Page_Init 添加所需的列，并设置相应的 DataSourceID。

为此，我们在 aspx 中有如下内容，Page_Init 中的代码隐藏非常简单，添加几列然后设置 GridView 的 DataSourceID 属性。

ASPX：

```
<asp:GridView ID="gvDisplay" runat="server" AutoGenerateColumns="false" CellPadding="5"
    width="100%" AllowPaging="true" PageSize="200" DataSourceID="wuProcessLogDataSource">
    <RowStyle CssClass="RowStyle" />
    <AlternatingRowStyle CssClass="AlternatingRowStyle" />
    <HeaderStyle CssClass="HeaderStyle" />  
</asp:GridView>
<asp:ObjectDataSource id="wuProcessLogDataSource" runat="server" EnablePaging="True" 
    SelectMethod="GetWUProcessLog" TypeName="Project.Objects.WUProcessLogDal"
    SelectCountMethod="GetWUProcessLogTotalRecords">
   <SelectParameters>
    <asp:QueryStringParameter QueryStringField="w" DefaultValue="0" Name="workunitId" />
   </SelectParameters>    
</asp:ObjectDataSource> 
```

对象数据源就在那里，并且作为第一页加载触发器工作，完全没有任何问题。但是，一旦您单击页面按钮，网格就会从页面中消失？有任何想法吗？

我只会使用 DataGrid，但它没有 HyperLinkColumn 所需的动态显示能力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T19:41:01.417

尝试页面加载事件而不是页面初始化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T15:12:54.173

听起来你正在做类似的事情

```
If (!Page.IsPostBack)
{
   //create + add columns - set datasource etc
} 
```

如果是这种情况 - 那么您需要删除检查并始终生成列（我还建议禁用数据网格的视图状态）

# javascript - 在多个 div 元素中随机播放内容的任何方式

> ID：315177
> 
> 赞同：7
> 
> 时间：2008-11-24T19:32:49.717
> 
> 标签：javascript, dom, dhtml

我对 Javascript 比较陌生，想知道是否有一种快速的方法来随机播放包含在多个`<div>`标签中的内容。例如

```
<div id='d1'>
  <span>alpha</span>
  <img src='alpha.jpg'>
</div>
<div id='d2'>
  <span>beta</span>
  <img src='beta.jpg'>
</div>
<div id='d3'>
  <span>gamma</span>
  <img src='gamma.jpg'>
</div>

<button onclick='shuffle_content();'>Shuffle</button> 
```

单击按钮后，我希望 d1、d2、d3 中的内容更改位置（例如，可能首先是 d3，然后是 d1，然后是 d2）。

一种快速移动的方法是复制第一个 div 元素 (d1)，然后将其放在最后（d3 之后），然后删除原始 d1。但这并没有真正随机化事情。它只是让事情进入循环（这可能没问题）。

任何建议，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-24T20:29:58.823

你可以使用像[jQuery](http://jquery.com)这样的 javascript 库吗？这是一个快速的 jQuery 示例来完成你所追求的。对 HTML 的唯一修改是按照建议添加容器元素：

```
<div id="shuffle">
    <div id='d1'>...</div>
    <div id='d2'>...</div>
    <div id='d3'>...</div>
</div> 
```

和 javascript：

```
function shuffle(e) {               // pass the divs to the function
    var replace = $('<div>');
    var size = e.size();

    while (size >= 1) {
       var rand = Math.floor(Math.random() * size);
       var temp = e.get(rand);      // grab a random div from our set
       replace.append(temp);        // add the selected div to our new set
       e = e.not(temp); // remove our selected div from the main set
       size--;
    }
    $('#shuffle').html(replace.html() );     // update our container div with the
                                             // new, randomized divs
}

shuffle( $('#shuffle div') ); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-03-09T21:58:33.137

最近的一个问题刚刚作为此问题的副本关闭，但我觉得我得到的答案比这里的任何问题都好。这个方法很直接。复制 HTML 并不麻烦，因此保留了对 DOM、样式、事件处理程序等的更改。

要打乱某个父元素的所有子元素，请选择一个随机子元素并将其一次附加回父元素，直到重新附加所有子元素。

使用 jQuery：

```
var parent = $("#shuffle");
var divs = parent.children();
while (divs.length) {
    parent.append(divs.splice(Math.floor(Math.random() * divs.length), 1)[0]);
} 
```

**演示：http:** [//jsfiddle.net/C6LPY/2](http://jsfiddle.net/C6LPY/2)

如果没有 jQuery，它是相似的，同样简单：

```
var parent = document.getElementById("shuffle");
var divs = parent.children;
var frag = document.createDocumentFragment();
while (divs.length) {
    frag.appendChild(divs[Math.floor(Math.random() * divs.length)]);
}
parent.appendChild(frag); 
```

**演示：http:** [//jsfiddle.net/C6LPY/5/](http://jsfiddle.net/C6LPY/5/)

* * *

**编辑：** 这是代码的细分：

```
// Create a document fragment to hold the shuffled elements
var frag = document.createDocumentFragment();

// Loop until every element is moved out of the parent and into the document fragment
while (divs.length) {

    // select one random child element and move it into the document fragment
    frag.appendChild(divs[Math.floor(Math.random() * divs.length)]);
}

// appending the document fragment appends all the elements, in the shuffled order
parent.appendChild(frag); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T20:35:15.303

你可以抓取每个div的内容

```
c1 = document.getElementById('div1').innerHTML
c2 = document.getElementById('div2').innerHTML
c3 = document.getElementById('div3').innerHTML 
```

然后随机为它们确定一个新的顺序..然后将每个内容放入新的目的地

例如，随机性给出：

```
c1_div = 'div2'
c2_div = 'div1'
c3_div = 'div3' 
```

那么你只需：

```
document.getElementById(c1_div).innerHTML = c1
document.getElementById(c2_div).innerHTML = c2
document.getElementById(c3_div).innerHTML = c3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-07T17:12:35.237

扩展@gilly3 的[好答案](/a/9641564)，使用 jQuery 实际上可以避免`divs`在循环中附加随机选择的元素，而是通过[随机`sort`ing](https://stackoverflow.com/a/7151283/11465909) `div`代替并同时`append`ing 全部：

```
$(function() {
  var parent = $("#shuffle");
  var divs = parent.children();
  divs.sort(function(a, b) {
    return 0.5 - Math.random();
  });
  parent.append(divs);
}); 
```

**演示**：http: [//jsfiddle.net/ey70Lxhk/](http://jsfiddle.net/ey70Lxhk/)

但是请注意，这种技术在随机性方面并不准确，并且依赖于`sort`不随元素数量线性缩放的随机性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T19:39:31.530

我将 div 包装在外部 div 中，然后将其 id 传递给 shuffle_content()。

在那里，您可以创建一个新 div，以随机顺序[克隆](https://developer.mozilla.org/en/DOM/element.cloneNode)包装器 div 的节点以填充它，然后用新 div[替换](https://developer.mozilla.org/en/DOM/element.replaceChild)包装器 div。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T20:29:48.917

我会使用服务器端代码来完成此操作。我知道这并不是您问题的真正答案，但它**是**一种替代实现。

最好的问候，
弗兰克

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T21:17:23.783

对于您的 HTML，您的问题的简短回答是：

```
function shuffle_content() {
 var divA = new Array(3);
 for(var i=0; i < 3; i++) {
  divA[i] = document.getElementById('d'+(i+1));
  document.body.removeChild(divA[i]);
 }
 while (divA.length > 0)
  document.body.appendChild(divA.splice(Math.floor(Math.random() * divA.length),1)[0]);
} 
```

为了到达那里，我写了以下内容，我认为效果更好：

```
<html>
<div id="cards">
<div id="card0">Card0</div><div id="card1">Card1</div>
<div id="card2">Card2</div><div id="card3">Card3</div>
<div id="card4">Card4</div><div id="card5">Card5</div>
<div id="card6">Card6</div><div id="card7">Card7</div>
<div id="card8">Card8</div><div id="card9">Card9</div>
</div>
<button id="shuffle">Shuffle</button>
<script language="javascript">
<!--
document.getElementById('shuffle').onclick = function () {
var divCards = document.getElementById('cards');
var divCardsArray = new Array(
    document.getElementById('card0'),
    document.getElementById('card1'),
    document.getElementById('card2'),
    document.getElementById('card3'),
    document.getElementById('card4'),
    document.getElementById('card5'),
    document.getElementById('card6'),
    document.getElementById('card7'),
    document.getElementById('card8'),
    document.getElementById('card9')
    );
return function() {
    var mDivCardsArray=divCardsArray.slice();
    while (divCards.childNodes.length > 0) {
        divCards.removeChild(divCards.firstChild);
    }
    while (mDivCardsArray.length > 0) {
        var i = Math.floor(Math.random() * mDivCardsArray.length);
        divCards.appendChild(mDivCardsArray[i]);
        mDivCardsArray.splice(i,1);
    }
    return false;
}
}()
//-->
</script>
</html> 
```

我试图将最后一个 while 语句打包为：

```
 while (mDivCardsArray.length > 0) {
        divCards.appendChild(
            mDivCardsArray.splice(
                Math.floor(Math.random() * mDivCardsArray.length)
                ,1)[0]
        );
    } 
```

但这很难阅读并且容易出错。

使用 jQuery 或 Prototype，您可以遵循相同的基本结构并获得您正在寻找的结果。

`cards`就个人而言，我认为如果你在堆栈中再添加 2 个 div，展开`divCardsArray`，插入以下样式块，并在`divCardsArray`定义之后立即添加此代码，它看起来会更好。

```
<html>
...
<style>
html,body{height:100%;width:100%;text-align:center;font-family:sans-serif;}
#cards,#cards div{padding:5px;margin:5px auto 5px auto;width:100px;}
</style>
...
<div id="cardA">CardA</div><div id="cardB">CardB</div>
...
var colorCardsArray = new Array(
    '#f00', '#f80', '#ff0', '#8f0', '#0f0', '#0f8',
    '#0ff', '#08f', '#00f', '#80f', '#f0f', '#f08' );
for(var i=0;i<divCardsArray.length;i++)
    divCardsArray[i].style.backgroundColor=colorCardsArray[i];
...
</html> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-24T20:05:26.937

我建议您随机化内容，而不是实际的 Div 本身。您可以通过将内容放在单独的 html 页面中来实现这一点 - 没有标题信息或正文，只有内容。

然后在页面加载时使用一个函数来随机分配哪个 div 获取什么内容并使用它来更改 DIV 的内容：

```
<script type="text/javascript">
    function ajaxManager(){
        var args = ajaxManager.arguments;

        if (document.getElementById) {
            var x = (window.ActiveXObject) ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
        }
        if (x){         
            switch (args[0]){
                case "load_page":
                    if (x)
                    {
                        x.onreadystatechange = function()
                        {
                            if (x.readyState == 4 && x.status == 200){
                                el = document.getElementById(args[2]);
                                el.innerHTML = x.responseText;
                            }
                        }
                        x.open("GET", args[1], true);
                        x.send(null);
                    }
                    break;

                case "random_content":
                    ajaxManager('load_page', args[1], args[2]); /* args[1] is the content page, args[2] is the id of the div you want to populate with it. */       
                    break;
            } //END SWITCH
        } //END if(x)
    } //END AjaxManager

</script> 
```

# asp.net - ASP.NET GridView 新手关于 TFOOT 和 TH 的问题

> ID：315178
> 
> 赞同：2
> 
> 时间：2008-11-24T19:33:02.870
> 
> 标签：asp.net, gridview, c#-3.0

问候！

我仍在学习 GridView 控件，并且我有一个绑定到 ObjectDataSource。我的 Web 表单如下所示：

```
<asp:GridView ID="ourGrid" runat="server" DataSourceID="ourDataSource" onrowdatabound="ourGrid_RowDataBound"
              HeaderStyle-CssClass="header_style" AlternatingRowStyle-CssClass="altrow_style"
              ShowFooter="true">
    <columns>
    <asp:BoundField DataField="Name" HeaderText="Full Name" />
    <asp:BoundField DataField="Gender" HeaderText="Gender" />
    <asp:BoundField DataField="BirthYear" HeaderText="Year of Birth" />
    <asp:BoundField DataField="JoinDate" HeaderText="Date Joined" HtmlEncode="false" DataFormatString="{0:d}" />
  </columns>
</asp:GridView>
<asp:ObjectDataSource ID="ourDataSource" runat="server" SelectMethod="GetTopUsers" TypeName="Acme.Model.OurNewObject">
</asp:ObjectDataSource> 
```

它当前生成以下标记：

```
<table cellpadding="0" cellspacing="0" summary="">
    <thead>
        <tr style="header_style">
            <th scope="col">Full Name</th>
            <th scope="col">Gender</th>
            <th scope="col">Year of Birth</th>
            <th scope="col">Date Joined</th>
        </tr>
    </thead>

    <tfoot>
        <tr>
            <td> </td>
            <td> </td>
            <td> </td>
            <td> </td>
        </tr>
    </tfoot>

    <tbody>
        <tr>
            <td>John Smith</td>
            <td>Male</td>
            <td>1967</td>
            <td>17-6-2007</td>
        </tr>
        <tr class="AspNet-GridView-Alternate altrow_style">
            <td>Mary Kay</td>
            <td>Female</td>
            <td>1972</td>
            <td>15-11-2007</td>
        </tr>
        <tr>
            <td>Bill Jones</td>
            <td>Male</td>
            <td>1970</td>
            <td>23-2-2007</td>
        </tr>
    </tbody>
</table> 
```

还有一些 HTML 元素我想添加到这个 GridView 控件将生成的表格标记中。对于初学者，我需要 TFOOT 看起来像这样：

```
<tfoot>
    <tr>
        <td colspan="4">
            <div>
                <a class="footerlink_style" title="Newest Members" href="#">Newest Members</a>
                <a class="footerlink_style" title="Top Posters" href="#">Top Posters</a>
            </div>
        </td>
    </tr>
</tfoot> 
```

链接将不包含数据绑定信息，但可能是超链接控件。有没有办法可以在设计时指定它？

此外，对于 THEAD，是否可以在 GridView 中为每个列标题指定单独的样式？

```
<thead>
    <tr style="header_style">
        <th scope="col" style="col1_style">Full Name</th>
        <th scope="col" style="col2_style">Gender</th>
        <th scope="col" style="col3_style">Year of Birth</th>
        <th scope="col" style="col4_style">Date Joined</th>
    </tr>
</thead> 
```

最后，是否可以像这样指定表格的摘要属性？

```
<table cellpadding="0" cellspacing="0" summary="Here is a list of users"> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T20:16:38.943

**TFOOT定制：**

页脚将始终默认创建与网格视图其余部分相同数量的单元格。您可以通过添加以下代码在代码中覆盖它：

```
protected void OurGrid_RowCreated(object sender, GridViewRowEventArgs e)
{
    if(e.Row.RowType == DataControlRowType.Footer)
    {
        int colSpan = e.Row.Cells.Count;

        for(int i = (e.Row.Cells.Count - 1); i >= 1; i -= 1)
        {
            e.Row.Cells.RemoveAt(i);
            e.Row.Cells[0].ColumnSpan = colSpan;
        }  

        HtmlAnchor link1 = new HtmlAnchor();
        link1.HRef = "#";
        link1.InnerText = "Newest Members";  

        HtmlAnchor link2 = new HtmlAnchor();  
        link2.HRef = "#";
        link2.InnerText = "Top Posters";  

        // Add a non-breaking space...remove the space between & and nbsp;
        // I just can't seem to get it to render in
        LiteralControl space = new LiteralControl("& nbsp;");

        Panel p = new Panel();
        p.Controls.Add(link1);
        p.Controls.Add(space);
        p.Controls.Add(link2);

        e.Row.Cells[0].Controls.Add(p);
    }
} 
```

...并将 onrowcreated 属性添加到服务器控件：

```
<asp:GridView ID="ourGrid" onrowcreated="OurGrid_RowCreated" ... 
```

**THEAD风格：**

您可以为每个绑定字段的“headerstyle-cssclass”中的每一列指定标题 css 类。例如：

```
<asp:BoundField headerstyle-cssclass="col1_style1" DataField="Name" HeaderText="Full Name" />    
<asp:BoundField headerstyle-cssclass="col1_style2" DataField="Gender" HeaderText="Gender" /> 
```

**表摘要：**

只需将摘要属性添加到 griview：

```
<asp:GridView ID="ourGrid" summary="blah" ... 
```

把它们放在一起：

```
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Data"%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
        DataSet ds = CreateDataSet();
        this.gv.DataSource = ds.Tables[0];

        this.gv.DataBind();
        this.gv.HeaderRow.TableSection = TableRowSection.TableHeader;
        this.gv.FooterRow.TableSection = TableRowSection.TableFooter;
    }

    protected void OurGrid_RowCreated(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.Footer)
        {
            int colSpan = e.Row.Cells.Count;

            for (int i = (e.Row.Cells.Count - 1); i >= 1; i -= 1)
            {
                e.Row.Cells.RemoveAt(i);
                e.Row.Cells[0].ColumnSpan = colSpan;
            }

            HtmlAnchor link1 = new HtmlAnchor();
            link1.HRef = "#";
            link1.InnerText = "Newest Members";

            HtmlAnchor link2 = new HtmlAnchor();
            link2.HRef = "#";
            link2.InnerText = "Top Posters";

            LiteralControl l = new LiteralControl("&nbsp;");

            Panel p = new Panel();
            p.Controls.Add(link1);
            p.Controls.Add(l);
            p.Controls.Add(link2);

            e.Row.Cells[0].Controls.Add(p);

        }
    }

    private DataSet CreateDataSet()
    {
        DataTable table = new DataTable("tblLinks");
        DataColumn col;
        DataRow row;

        col = new DataColumn();
        col.DataType = Type.GetType("System.Int32");
        col.ColumnName = "ID";
        col.ReadOnly = true;
        col.Unique = true;
        table.Columns.Add(col);

        col = new DataColumn();
        col.DataType = Type.GetType("System.DateTime");
        col.ColumnName = "Date";
        col.ReadOnly = true;
        col.Unique = false;
        table.Columns.Add(col);

        col = new DataColumn();
        col.DataType = Type.GetType("System.String");
        col.ColumnName = "Url";
        col.ReadOnly = true;
        col.Unique = false;
        table.Columns.Add(col);

        DataColumn[] primaryKeysColumns = new DataColumn[1];
        primaryKeysColumns[0] = table.Columns["ID"];
        table.PrimaryKey = primaryKeysColumns;

        DataSet ds = new DataSet();
        ds.Tables.Add(table);

        row = table.NewRow();
        row["ID"] = 1;
        row["Date"] = new DateTime(2008, 11, 1);
        row["Url"] = "www.bbc.co.uk/newsitem1.html";
        table.Rows.Add(row);

        row = table.NewRow();
        row["ID"] = 2;
        row["Date"] = new DateTime(2008, 11, 1);
        row["Url"] = "www.bbc.co.uk/newsitem2.html";
        table.Rows.Add(row);

        return ds;
    }
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <style type="text/css">
    .red
    {
         color: red;
    }
    .olive
    {
        color:Olive;
    }
    .teal
    {
        color:Teal;
    }
    </style>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:gridview 
        id="gv" 
        autogeneratecolumns="false"
        showheader="true" 
        showfooter="true"
        summary="Here is the news!"
        caption="The Caption"
        captionalign="Top"
        alternatingrowstyle-cssclass="alt_row" 
        useaccessibleheader="true"
        onrowcreated="OurGrid_RowCreated" 
        runat="server">
        <columns>
            <asp:boundfield 
                headertext="ID" 
                headerstyle-cssclass="olive"  
                datafield="id" />
            <asp:hyperlinkfield 
                headertext="Link" 
                headerstyle-cssclass="red" 
                datanavigateurlfields="Url" 
                datanavigateurlformatstring="http://{0}" 
                datatextfield="Url" 
                datatextformatstring="http://{0}" />
            <asp:boundfield 
                headertext="Date"  
                headerstyle-cssclass="teal" 
                datafield="Date"/>
        </columns>
    </asp:gridview>
    </div>
    </form>
</body>
</html> 
```

以上生成以下 HTML：

```
<table cellspacing="0" 
        rules="all" 
        summary="Here is the news!" 
        border="1" 
        id="gv" 
        style="border-collapse:collapse;">

    <caption align="Top">
        The Caption
    </caption>
    <thead>
        <tr>
            <th class="olive" scope="col">ID</th>
            <th class="red" scope="col">Link</th>
            <th class="teal" scope="col">Date</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>
                <a href="http://www.bbc.co.uk/newsitem1.html">
                    http://www.bbc.co.uk/newsitem1.html
                </a>
            </td>
            <td>01/11/2008 00:00:00</td>
        </tr>
        <tr class="alt_row">
            <td>2</td>
            <td>
                <a href="http://www.bbc.co.uk/newsitem2.html">
                    http://www.bbc.co.uk/newsitem2.html
                </a>
            </td>
            <td>01/11/2008 00:00:00</td>
        </tr>
    </tbody>
    <tfoot>
        <tr>
            <td colspan="3">
                <div>
                    <a href="#">Newest Members</a>&nbsp;<a href="#">Top Posters</a>
                </div>
            </td>
        </tr>
    </tfoot>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-29T02:55:19.047

通过使用 ListView 控件，您可能会在尝试做的事情上取得更大的成功。这样您就可以定义标记，而不是依靠 GridView 来正确执行它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-24T20:01:25.760

需要在数据绑定上生成页脚内容。为 RowDataBound 设置处理程序。逻辑应该是这样的：

```
if (e.Row.Type == DataControlRowType.Footer)
{
// Do Work
} 
```

要为标题指定不同的样式，如下所示：

```
<Columns>
  <asp:BoundField DataField="PrimaryKey" HeaderText="TheKey">
    <headerstyle cssclass="Header1" />
  </asp:BoundField>
  <asp:BoundField DataField="Value" HeaderText="AValue">
    <HeaderStyle cssclass="Header2" />
  </asp:BoundField>
  <%-- ... --%>
</Columns> 
```

对于摘要部分，您可以简单地将其包含在 GridView 控件的声明中。

```
<asp:GridView id="theGrid" runat="server" summary="The Summary" >
...
</asp:GridView> 
```

根据您的验证设置，Visual Studio 可能会对您产生影响，但它会呈现。

# wpf - Model-View-Presenter 和 Modal 对话框.... 如何？

> ID：315180
> 
> 赞同：7
> 
> 时间：2008-11-24T19:33:53.413
> 
> 标签：wpf, design-patterns, mvvm, mvp

我正在 WPF 中实现 MVP/MV-VM，到目前为止我很幸运。但是，我看不到这个模型如何支持实现模态对话框。我从 Crack.NET ( [http://www.codeplex.com/cracknetproject](http://www.codeplex.com/cracknetproject) ) 获得了我的工作，以了解这些东西是如何工作的。

我有一个带有菜单的 ShellView 视图（它只是 XAML）。该菜单绑定到 ShellModelView 中显示“EditPreferences”的命令。

ShellModelView 实现了 EditPreferences 的 ICommand，在这里我们要放置一个对话框，让用户编辑应用程序的首选项。

这里有几个问题： 1\. ShellModelView 没有对 ShellView 的引用来正确地作为对话框的父级。ShellModelView 是 ShellView 的 DataContext，但我没有看到设置的反向引用。2\. ShellModelView 无论如何都不应该加载显式 UI。那么这里正确的交互模型是什么？3\. 我如何建立我的 PreferencesDialog 以便它在逻辑和视图之间正确分离？PreferencesDialog 本身需要是一个 Window，因此您可以在其上调用 ShowDialog，但这意味着您需要对 Window（例如 View）的引用才能实例化它。理想情况下，我应该能够在不实例化视图的情况下对 PreferencesDialog 中的代码/验证进行单元测试（也许使用 Mock 视图？）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T14:40:59.493

也许这不是看待它的合适方式，但这是我在 WPF 中使用 MV-VM 所采用的方法。打开窗口和对话框或“EditPreferences”视图是 UI 特定的功能。如果我要重写您的整个 UI 以替换所有视图，我可能会最终将“EditPreferences”视图与另一个视图结合起来，因此永远不想在另一个屏幕中打开它。如果这与 ViewModel 相关联，则很难解决。在这种特殊情况下，我的“ShellView”中有一个按钮或菜单项，它创建我的“EditPreferences”视图的新实例，然后传入“EditPreferences”ViewModel，它可能来自我的“ShellViewModel”中的属性”，或者我的“EditPreferences”视图实例化了 ViewModel 本身。

这是关于 SO 的类似问题，基本上说的是同一件事：[MV-VM Design Question。从 ViewModel 调用 View](https://stackoverflow.com/questions/303006/m-v-vm-design-question-calling-view-from-viewmodel#306902)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T20:17:29.720

在您的情况下，您将需要一个控制器。控制器应负责显示首选项对话框窗口。

正如我想象的那样，控制器应该负责创建 ShellModelView 并将视图的 DataContext 绑定到它。控制器还应负责处理 EditPreferences 的命令执行。在执行逻辑中，控制器将创建一个新的 PreferencesDialog 及其对应的视图模型。

如果您还没有这样做，您可以在[Prism](http://www.codeplex.com/CompositeWPF)中找到类似的模式。您还可以重用那里提供的 DelegateCommand :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T20:20:37.283

让 PreferencesDialog 实现一个接口，该接口是 EditPreference 命令的属性之一。该命令将通过界面与对话框交互。对于单元测试，模拟对象将改为实现接口。

然后对话类可以驻留在您的最高层。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-19T21:09:59.787

我的 2 美分是：

1.  将某种 viewfactory 契约作为命令参数传递，或者将 viewfactory 契约注入到视图模型中。视图模型将使用 viewfactory 创建它需要的任何模态/非模态视图。viewfactory 还可以将要显示的视图模型作为其 Show/ShowModal 方法的参数。此外，视图工厂可以使用数据模板来显示作为参数传入的任何视图模式。

2.  将 ShowViewModel 属性添加到相关视图模型。然后，DataTrigger 可以监视此属性，并在它属于特定类型时显示视图等。

# hardware - 哪些 Hypervisor 允许原始 PCI 访问？

> ID：315182
> 
> 赞同：3
> 
> 时间：2008-11-24T19:34:02.460
> 
> 标签：hardware, vmware, xen, pci-bus, hypervisor

我正在尝试找出哪个 Hypervisor 将允许我向虚拟机授予对专用 PCI 卡（例如电话卡）的访问权限。到目前为止，我已经试用了 VMWare ESXi 服务器，但它似乎不允许我这样做。我听说 Microsoft Virtual Server 确实允许这样做，但我找不到任何支持文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T04:21:28.400

我会研究[Xen](http://www.xen.org)，看来您可以在主机操作系统上加载后端 xen 驱动程序，然后您可以直接与来宾的硬件通信。

有关更多信息，请参阅[此链接](http://www.bestgrid.org/index.php/Xen:_assigning_PCI_devices_to_a_domain)。我不是 Xen 用户，但根据我的虚拟化经验，我猜想 Xen 主机/猜测的半虚拟化方面将是您访问原始设备的最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-29T01:02:08.343

是的，Xen 可以成功地做到这一点。它被称为 PCI 直通：[http ://wiki.xen.org/wiki/Xen_PCI_Passthrough](http://wiki.xen.org/wiki/Xen_PCI_Passthrough)

我已经使用我系统的 IOMMU 成功地为带有 Xen 4.x 的 Windows 和 Linux 来宾完成了这项工作。根据特定系统中的 PCI 层次结构，可以将哪些设备分配给哪些来宾存在一些限制。您可以使用“lspci -t”（用于“树”）在 Linux 中查看您的。

IOMMU 位于树中相当高的位置，因此在类似笔记本电脑的系统上，可能没有太多可用的分区。不过，几乎总是可以分配附加 PCIe 卡。

# javascript - jQuery：将 JavaScript 移动到页面底部？

> ID：315183
> 
> 赞同：10
> 
> 时间：2008-11-24T19:34:54.753
> 
> 标签：javascript, asp.net, jquery

我们正在开发具有大量包含 ASCX 控件的动态创建页面的大型 ASP.NET 应用程序。我们到处使用大量的 jQuery。

我一直在读到将内联 JavaScript 代码移动到页面底部是有意义的，因为当它被“过早”包含时，它可能会延迟页面的加载。

我现在的问题是：**在使用 jQuery 时这仍然有意义吗？**

大多数代码都在就绪处理程序中执行，所以我希望这不会减慢页面的加载速度。在我的例子中，多个 Usercontrols **ASCX 都有自己的 jQuery**点点滴滴，在渲染页面中将它们全部向下移动并不容易。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T23:25:27.783

建议将脚本放在 HTML 的后面，因为加载和执行脚本是按顺序进行的（一次一个脚本），同时完全阻止了图像和 CSS 文件的加载和解析。

页面顶部附近的大型/滞后/运行缓慢的脚本可能会对页面内容/布局的加载和呈现造成不必要的延迟。

脚本的大小（下载时间）和复杂性（执行时间（dom 遍历等））是重要因素——但更重要的是，单个`<script>`HTTP 请求的数量更重要（请求越少越好）。

使用“document.ready”处理程序减少了由缓慢执行引起的延迟——但仍然存在顺序 HTTP 开销的问题。

推荐阅读： Nate Koeckley 的[高性能网站](http://nate.koechley.com/blog/2007/06/12/high-performance-web-sites/)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-24T20:03:41.263

[您可以对在Cuzillion](http://stevesouders.com/cuzillion/)中排序 JavaScript 的不同方式进行建模，以了解它如何影响页面加载。

有关页面元素排序如何影响速度的示例，请参阅[示例](http://stevesouders.com/cuzillion/help.php#examples)和[此博客文章。](http://www.stevesouders.com/blog/2008/04/25/cuzillion/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T00:43:30.760

当您包含 JS 时，从该点加载页面将延迟，因为 JS 文件可能包含“document.write”语句。

这意味着整个页面将停止从您包含 JS 文件并使浏览器变为“白色”或其他内容（至少不显示页面的其余部分）的位置呈现，所以简短的回答*肯定是肯定*的...... ！

（更长的答案是“可能”，概率为 99%）

就像将 JS（以及内联 JS - 你不应该使用 BTW）移到底部一样......

也就是说，如果你在 ASP.NET 上，你不应该使用 jQuery，而应该使用[Ra-Ajax](http://ra-ajax.org)，顺便说一句，它自动为你包含了所有这些“最佳实践”......

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-24T22:46:34.290

大多数情况下，将 JavaScript 移动到页面底部的原因是为了确保 JavaScript 可能引用的任何 DOM 元素都已在 JavaScript 运行之前创建。这也确保了页面在运行任何 JavaScript 之前有时间呈现。

在这种情况下，我不会担心将 JavaScript 向下移动到页面的下方。

# sql-server - 查询SqlServer系统数据库查找DB对象的sql是什么？

> ID：315185
> 
> 赞同：2
> 
> 时间：2008-11-24T19:36:48.900
> 
> 标签：sql-server

我有一个包含许多表和存储过程的大型数据库，我想查找并查看，例如，是否有一个名称包含“设置”的表作为它的一部分。我对 SqlServer 的系统数据库（如 master、msdb 等）不太熟悉，我知道有一种方法可以查询其中一个数据库以获取我需要的东西，有人知道该怎么做吗？

谢谢你，雷。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T19:41:33.070

SQL Server 还支持标准信息架构视图。使用它们可能更好，因为如果您需要进行迁移，此查询也应该可以跨不同的数据库引擎工作：

```
SELECT * FROM INFORMATION_SCHEMA.tables where table_name LIKE '%Settings%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T19:39:05.290

你想要的表是 sys.objects

```
SELECT * 
FROM sys.objects 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T19:39:51.247

包含您查找的信息的表称为 sysobjects。这是您所描述内容的查询：

```
SELECT * FROM sysobjects WHERE xtype = 'U' AND NAME LIKE '%setting%' 
```

（U 是用户表的类型）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T19:50:07.157

对于 SQL Server 2005

SELECT * FROM sys.objects where type in ('U') and name like '%setting%'

# sql - SQL join 查找两个数据源之间的不一致

> ID：315196
> 
> 赞同：3
> 
> 时间：2008-11-24T19:39:53.247
> 
> 标签：sql, sql-server

我有一个 SQL 挑战让我脑筋急转弯。我正在尝试协调两个应用程序许可证的报告。

第一个报告是一个访问数据库表。它是由我的前辈手工创建和维护的。每当他们安装或卸载应用程序时，他们或多或少都会手动更新表格。它有各种不一致的数据列，包括名称(displayName) 网络ID(SAMAccountName) 和计算机名称。每条记录至少有一个这些字段的值。不过，大多数只有 1 或 2 个值。

第二个报告基于 SMS 清单。它包含三列：NetbiosName（计算机名称）、SAMAccountName 和 displayName。每条记录都有一个 NetbiosName，但 SAMAccountName 和 displayName 中有一些空值。

我已将这两个表作为表导入到 MS SQL Server 2005 数据库中。

我需要做的是获取 Access 表中不在 SMS 表中的每条记录的报告，反之亦然。我认为可以通过正确形成的联接和 where 子句来完成，但我不知道该怎么做。

*编辑以添加更多详细信息：*
如果记录与三列中的至少一列匹配，则为匹配。所以我需要访问表中的记录，其中名称、网络 ID 和计算机名称都从 SMS 表中丢失。我可以为任何专栏做这件事，但我看不到如何组合所有三个专栏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T23:20:18.667

以 Kaboing 的回答和编辑后的问题，解决方案似乎是：

```
SELECT *
FROM report_1 r1 
FULL OUTER JOIN report_2 r2 
    ON r1.SAMAccountName = r2.SAMAccountName
    OR r1.NetbiosName = r2.NetbiosName
    OR r1.DisplayName = r2.DisplayName
WHERE r2.NetbiosName IS NULL OR r1.NetbiosName IS NULL 
```

不确定记录是否会显示多次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T20:16:23.967

您需要查看[EXCEPT](http://msdn.microsoft.com/en-us/library/ms188055.aspx)子句。它是 SQL SERVER 2005 的新功能，与 Oracle 的 MINUS 功能相同。

SQL1 除了 SQL2

将为您提供 SQL2 IF 中未找到的 SQL1 中的所有行

SQL1 = A、B、C、D SQL2 = B、C、E

结果是 A，D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T20:20:19.450

基于 Gabriel1836 的回答，变得更简单，但可能更难解释：

```
SELECT *
FROM report_1 r1 
FULL OUTER JOIN report_2 r2 ON r1.SAMAccountName = r2.SAMAccountName
WHERE r2.SAMAccountName IS NULL OR r1.SAMAccountName IS NULL 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T14:06:50.530

看一下sql server自带的[tabeldiff.exe](http://weblogs.sqlteam.com/mladenp/archive/2007/03/03/60125.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T19:42:21.197

尝试以下操作：

```
SELECT displayName, 'report_1' as type
FROM report_1 r1 
LEFT OUTER JOIN report_2 r2 ON r1.SAMAccountName = r2.SAMAccountName
WHERE r2.SAMAccountName IS NULL
UNION
SELECT displayName, 'report_2' as type
FROM report_1 r1
RIGHT OUTER JOIN report_2 r2 ON r1.SAMAccountName = r2.SAMAccountName
WHERE r1.SAMAccountName IS NULL 
```

# java - Java 直接打印到 Postscript 网络打印机

> ID：315209
> 
> 赞同：10
> 
> 时间：2008-11-24T19:44:50.130
> 
> 标签：java, networking, printing, postscript

我在内存中（在 Java Tomcat webapp 中）有 Postscript 代码/数据（？），我想直接发送到联网的 PS 打印机。有没有一种简单的方法（即只是弹出一个端口并发送文本）来打印它，绕过所有特定于操作系统的驱动程序和东西（希望甚至不需要额外的罐子）？显示如何执行此操作的示例代码的链接？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-26T01:16:16.980

打开到目标打印机上 LPR 端口的 TCP 套接字。

发送您的数据；只要打印机理解它，你就很酷。

完成后不要忘记换行。

（然后关闭端口。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-27T20:59:59.233

您可以将其直接发送到端口 9100 上的网络打印机。我在这里写了一篇关于此的博客文章：

[http://frank.zinepal.com/printing-directly-to-a-network-printer](http://frank.zinepal.com/printing-directly-to-a-network-printer)

问题是大多数激光打印机不支持 PostScript。您通常必须为此购买打印机插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T19:53:34.683

我不确定您是否可以在没有额外库的情况下做到这一点。

此[示例](http://livedocs.adobe.com/livecycle/es/sdkHelp/programmer/sdkHelp/wwhelp/wwhimpl/common/html/wwhelp.htm?context=sdkHelp&file=outputCreatingPrint.46.3.html)向您展示如何将文件发送到网络打印机，但需要 adobe 库（尽管基于商业 J2EE [Livecycle ES](http://www.adobe.com/devnet/livecycle/trial/)，因此不是通用的“免费”解决方案......）。

```
import com.adobe.livecycle.output.client.*;
import java.util.*;    
import java.io.File;    
import java.io.FileInputStream;    
import com.adobe.idp.Document;    
import com.adobe.idp.dsc.clientsdk.ServiceClientFactory;

public class SendToPrinter {

    public static void main(String[] args) {
        try{
            //Set LiveCycle ES service connection properties                            
            Properties ConnectionProps = new Properties();
            ConnectionProps.setProperty("DSC_DEFAULT_EJB_ENDPOINT", "jnp://localhost:1099");
            ConnectionProps.setProperty("DSC_TRANSPORT_PROTOCOL","EJB");          
            ConnectionProps.setProperty("DSC_SERVER_TYPE", "JBoss");
            ConnectionProps.setProperty("DSC_CREDENTIAL_USERNAME", "administrator");
            ConnectionProps.setProperty("DSC_CREDENTIAL_PASSWORD", "password");
            //Create a ServiceClientFactory object
            ServiceClientFactory myFactory = ServiceClientFactory.createInstance(ConnectionProps);
            //Create an OutputClient object
            OutputClient outClient = new OutputClient(myFactory); 
            //Reference XML data that represents form data
            FileInputStream fileInputStream = new FileInputStream("C:\\Adobe\\Loan_data.xml"); 
            Document inputXML = new Document(fileInputStream);
            //Set print run-time options
            PrintedOutputOptionsSpec printOptions = new PrintedOutputOptionsSpec(); 
            printOptions.setPrinterURI("\\\\Printer1\\Printer");
            printOptions.setCopies(2);

            //Send a PostScript print stream to printer
            OutputResult outputDocument = outClient.generatePrintedOutput(
                    PrintFormat.PostScript,
                    "Loan.xdp",
                    "C:\\Adobe",
                    "C:\\Adobe",
                    printOptions,
                    inputXML); 

            //Write the results of the operation to OutputLog.xml
            Document resultData = outputDocument.getStatusDoc();
            File myFile = new File("C:\\Adobe\\OutputLog.xml");
            resultData.copyToFile(myFile);
        }
        catch (Exception ee)
        {
            ee.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T23:39:21.763

查看 java.awt.print。它是java中的通用打印API。

不幸的是，它并不是针对处理您已经拥有的后记内容。它旨在让您使用 java 2d 图形 API 在一张纸上“绘图”。

# visual-studio-2008 - 无法调试 WCF 服务消息

> ID：315210
> 
> 赞同：31
> 
> 时间：2008-11-24T19:44:57.883
> 
> 标签：visual-studio-2008, wcf

我有一个带有 WCF 服务和客户端的 Visual Studio 2008 解决方案。

当我运行我的客户端并从我的服务中调用一个方法时，我收到一条消息“无法自动调试'Home.Service'。无法调试远程过程。这通常表明服务器上尚未启用调试。 "

我已经用谷歌搜索了，并尝试了以下方法。

```
<system.web>
   <compilation debug="true" />
</system.web> 
```

已在客户端和服务器上的 app.config 中添加。

我还确保项目是在调试模式下编译的。

还有什么可能导致此消息？

编辑：根据反馈问题添加了更多信息

*   它正在使用 wsHttpBinding
*   我已经设定

    ```
    <serviceDebug includeExceptionDetailInFaults="true"/> 
    ```

*   我在用

    ```
    var service = new HomeReference.HomeServiceClient();
    service.ClientCredentials.Windows.ClientCredential = CredentialCache.DefaultNetworkCredentials; 
    ```

不幸的是，当我第一次在我的服务上调用方法时，错误就会出现。我可以关闭消息框，应用程序继续工作。但是，服务器上抛出的任何异常都不会传播回客户端（我认为应该如此？）

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-09-14T16:58:31.910

我与这个完全相同的错误斗争了一个多小时，结果发现我重新启动了 VS2008，它神奇地自行修复了。试一试，因为它可能会为您节省一些时间。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-17T10:52:39.787

在我的情况下，问题原来是客户端和服务器上的安全设置不匹配。我正在使用这样的自定义绑定：

```
<customBinding>
    <binding name="AuthorisedBinaryHttpsBinding" receiveTimeout="00:03:00" sendTimeout="00:03:00">
      <!-- this next element caused the problem: -->
      <security authenticationMode="UserNameOverTransport">
      </security>
      <binaryMessageEncoding>
        <readerQuotas maxDepth="100" maxStringContentLength="1000000"
          maxArrayLength="655360000" />
      </binaryMessageEncoding>
      <httpsTransport />
    </binding>
  </customBinding> 
```

当我删除上面突出显示的安全元素时，“无法自动调试”消息的问题消失了。

为了解决这个问题，我首先打开了[WCF 跟踪](http://blogs.msdn.com/madhuponduru/archive/2006/05/18/601458.aspx)。这向我表明 WCF 正在抛出**MessageSecurityException**：

> 安全处理器无法在邮件中找到安全标头。这可能是因为消息是不安全的错误，或者是因为通信双方之间存在绑定不匹配。如果为安全配置了服务并且客户端未使用安全性，则可能会发生这种情况。

这让我看看客户端的绑定设置。事实证明，我没有将所需的安全元素添加到那里的自定义绑定中。由于我是通过代码执行此操作的，因此我需要以下内容（注意第 3 行）：

```
 var binding = new CustomBinding(
      binaryEncoding,
      SecurityBindingElement.CreateUserNameOverTransportBindingElement(),
      new HttpsTransportBindingElement { MaxReceivedMessageSize = MaxMessageSize, }); 
```

至于为什么 Visual Studio 显示该错误，我不知道 - 在我看来是一个错误。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-26T16:43:19.057

自动附加到服务有以下限制：

*   该服务必须是您正在调试的 Visual Studio 解决方案的一部分。

*   必须托管该服务。它可能是网站项目（文件系统和 HTTP）、Web 应用程序项目（文件系统和 HTTP）或 WCF 服务库项目的一部分。WCF 服务库项目可以是服务库或工作流服务库。

*   该服务必须从 WCF 客户端调用。

*   必须使用 app.config 或 Web.config 文件中的以下代码启用调试：

    ```
    <system.web>
      <compilation debug="true" />
    </system.web> 
    ```

请参阅[WCF 调试的限制](http://msdn.microsoft.com/en-us/library/bb157687.aspx)

此外，如果两个项目（客户端和服务）在同一个解决方案中，但将在不同的进程中运行（例如，如果您使用本地 IIS 服务器进行开发，并且在与其服务**不同的应用程序池上**运行 Web 应用程序）消耗），您可能需要为解决方案启用“**多个启动项目**”（在解决方案属性 -> 启动项目上），以便调试器可以附加到两者。

为了避免每次调试时都显示服务浏览器窗口，您可以将“开始操作”（在服务项目属性上）设置为“不打开页面。等待来自外部应用程序的请求”。

这是来自个人经验，可能对其他人有所帮助。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-03-15T18:31:58.843

您可能会看到此错误的另一个原因（我相信对我来说就是这种情况）是您在 64 位 Windows 中运行。显然 Visual Studio 没有任何 x64 调试器支持。

您可以通过更改消费应用程序的平台目标来解决此问题：

项目属性 -> 构建 -> 将“平台目标”更改为“x86”。

不幸的是，这对我不起作用，因为我试图在 Windows Azure Development AppFabric 中运行，这似乎需要所有东西都以 64 位模式运行！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-25T06:32:42.130

我也遇到了同样的问题。我在客户端和服务配置文件中都进行了更改，例如

编译调试设置为 true。

这对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T19:48:59.123

你有没有尝试过

```
 <serviceBehaviors>

  <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors> 
```

出于调试目的？

编辑：没关系，我想我误解了这个问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T00:04:44.620

我遇到了类似的问题，结果证明是由于未在 IIS 站点/虚拟目录上启用 Windows 身份验证。

您是否尝试将身份验证模式设置为集成而不是匿名？ [http://msdn.microsoft.com/en-us/library/x8a5axew(VS.80).aspx](http://msdn.microsoft.com/en-us/library/x8a5axew(VS.80).aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-24T20:38:50.813

在您的 Web 服务 web.config 中，确保编译调试设置为 true。那应该可以解决您的问题！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-01T08:13:10.600

就我而言，问题原来是完全不同的。我更改了 Web 服务上的操作名称，却忘记更新客户端。由于某种原因，这导致了“无法自动调试...”错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-03T09:46:58.837

也可以是在 IISExpress 和 IIS 中使用相同的端口号。如果您在 Visual Studio 和 IISExpress 中开发 WCF 应用程序，然后在本地 IIS 上安装相同的应用程序，请确保不要在 IIS 和 IISExpress 中使用相同的端口号。使用相同的端口号将导致此错误消息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-21T09:58:21.540

我在 Visual Studio 2017 中遇到了同样的问题。删除解决方案文件夹根目录中隐藏的 .vs 文件夹后，我能够再次调试。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-11-24T19:57:33.443

在客户端中创建服务引用后添加这行代码。

```
MyWCFService.IService _proxy = new MyWCFService.IService();
_proxy.ClientCredentials.Windows.ClientCredential = System.Net.CredentialCache.DefaultNetworkCredentials; 
```

# c++ - C++ 模板和继承

> ID：315218
> 
> 赞同：6
> 
> 时间：2008-11-24T19:49:15.770
> 
> 标签：c++, inheritance, templates

我的 C++ 框架有按钮。Button 派生自 Control。因此，接受 Control 的函数可以将 Button 作为其参数。到现在为止还挺好。

我也有列表`<`T>。但是，List `<`Button> 不是从 List `<`Control> 派生的，这意味着接受控件列表的函数不能将按钮列表作为其参数。这是不幸的。

也许这是一个愚蠢的问题，但我不知道如何解决这个问题:( List `<`Button`>`应该派生自 List `<`Control `>`，但我看不到“自动”发生这种情况的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T19:56:10.140

Stroustrup 在他的常见问题解答中对此有一个项目：

[为什么我不能将 a 分配`vector<Apple*>`给 a`vector<Fruit*>`](http://www.research.att.com/~bs/bs_faq2.html#conversion)

您可以通过两种方式解决它：

*   使列表包含指向`Control`. 然后接受`List<Control*>`
*   使您的函数成为模板。你仍然可以使用`List<Button>`然后`List<Control>`，但它更多的是样板代码，并且大多数时候都不需要。

这是第二种选择的代码。第一种选择已经由其他答案解释：

```
class MyWindow {
    template<typename T>
    void doSomething(List<T> & l) {
        // do something with the list...
        if(boost::is_same<Control, T>::value) {
            // special casing Control

        } else if(boost::is_same<Button, T>::value) {
            // special casing Button

        }

    }
}; 
```

为了`doSomething`只限制 for `List<derived from Control>`，需要更多的代码（`enable_if`如果你想知道，请查找）。

请注意，这种代码（查看您拥有的类型）是应避免的。你应该用虚函数来处理这些事情。向 Control添加一个函数`doSomething`，并在 Button 中覆盖它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T19:52:24.577

如何使用指针？只需列出`list<Control*>`您喜欢的任何 Control 派生对象并将其放入其中即可。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-24T20:06:31.773

我不想告诉你，但如果你使用 Control 的实例列表而不是 Control 的指针，那么你的按钮无论如何都是垃圾（谷歌“对象切片”）。如果它们是指针列表，则要么按照其他人的建议将其`list<button*>`变为`list<control*>`，要么将其复制到新`list<control*>`的`list<button*>`并将其传递*给*函数。或者将函数重写为模板。

因此，如果您之前有一个名为 doSomething 的函数，该函数将控件列表作为参数，您可以将其重写为：

```
template <class TControl>
void doSomething( const std::list<TControl*>& myControls ) {
  ... whatever the function is currently doing ...
}

void doSomethingElse() {
   std::list<Button*> buttons;
   std::list<Control*> controls;
   doSomething( buttons );
   doSomething( controls );
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T19:52:37.557

不使用 List<Button>，而是使用指向 Buttons 的 List<Control*>。这样，您的函数只需采用一种类型：List<Control*>。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T09:44:15.350

通常，编写对列表、序列等执行的算法的 C++ 方法是提供迭代器作为参数。

```
template < class iterator >
doSomething(iterator beg, iterator end); 
```

这解决了 List<Button*> 不是从 List<Control*> 派生的。（使用模板 List< T* > 也可以，但这会让你的函数变得通用但不是真的）

以我的经验，在迭代器上制作好的模板化函数可能需要很多（太多......）工作，但这是“C++方式”......

如果你走这条路，请考虑使用[Boost.ConceptCheck](http://www.boost.org/doc/libs/1_37_0/libs/concept_check/concept_check.htm)。它会让你的生活轻松很多。

# c# - 如何在 C# 中在不同的 Active Directory 域中添加用户？

> ID：315227
> 
> 赞同：2
> 
> 时间：2008-11-24T19:51:21.037
> 
> 标签：c#, active-directory, cross-domain

所以我的目标是能够将一个 Active Directory 域中的用户添加到另一个 Active Directory 域中的另一个组。

我想在 C# 中执行此操作。我知道有一个 System.DirectoryServices 命名空间，其中包含与 AD 通信的类，但我找不到有关跨域添加用户的任何信息。

在环境中有两个域控制器具有相同的父林。两个域之间存在临时信任，我们称它们为域 A 和 B。

我可以使用 Active Directory 工具将 B 中的用户添加到域 A 内的域本地或通用组。

有谁知道我如何使用 C# 以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T03:59:22.910

几年前我写代码来做这件事时，什么对我有用：

1.  获取要添加成员的组的 DirectoryEntry。
2.  对组 DirectoryEntry 调用 Invoke，将参数“Add”作为方法名称和数组中成员的[ADsPath传递。](http://msdn.microsoft.com/en-us/library/aa746384(VS.85).aspx)

一些示例代码在我脑海中浮现：

```
DirectoryEntry group = new DirectoryEntry(@"LDAP://CN=foo,DC=domainA");
string memberADsPath = @"LDAP://CN=bar,DC=domainB";
group.Invoke("Add", new Object[] {memberADsPath}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-27T07:53:59.080

您需要为 Group 创建一个 DirectoryEntry 对象。然后，将要添加到组的用户的 DN 添加到组的成员属性中。例如：

```
DirectoryEntry group = new DirectoryEntry("LDAP://child.domain.com/cn=group,ou=sample,dc=child,dc=domain,dc=com");

string userDN = "cn=user,ou=sample,dc=domain,dc=com";

group.Properties["member"].Add(userDN);
group.CommitChanges(); 
```

可能您在绑定到组 DirectoryEntry 时遇到问题。在尝试添加组以确保成功绑定之前，请确保您可以读取该 DE 的属性。

# .net - Visual Studio 中的多语言项目

> ID：315230
> 
> 赞同：1
> 
> 时间：2008-11-24T19:51:57.697
> 
> 标签：.net, visual-studio, f#, pex

有人知道 Visual Studio 是否有计划或扩展以允许多语言项目吗？

虽然 .NET 平台是真正的多语言，但 Visual Studio 项目是顽固的单语言，这意味着所有用于工具 C# 和 VB 的工作都不能用于 F# 和 IronPython 等新语言。

PEX 是一个很好的 Visual Studio 扩展示例，它在 F# 中根本不起作用。

.NET 中没有专门用于启用多语言编译的模块系统吗？

问候，

丹尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T20:20:28.797

我在 Microsoft 的 F# 团队工作，像 PEX 这样的 .NET 库应该可以与 F# 模错误完全互操作，所以如果您遇到问题，请将问题发送到 fsbugs@microsoft.com。

可以使用称为 netmodules 的概念在 .NET 中生成多语言程序集：http: [//blogs.msdn.com/junfeng/archive/2005/02/12/371683.aspx](http://blogs.msdn.com/junfeng/archive/2005/02/12/371683.aspx)。不幸的是，我不知道 F# 是否支持这一点（我对此表示怀疑。）

至于获得多语言开发的工具支持，目前没有计划在 Visual Studio 中启用它。[但是，请考虑在http://connect.microsoft.com/VisualStudio](http://connect.microsoft.com/VisualStudio)上提及这一点。为未来版本提供功能的人会考虑对该站点的反馈，特别是如果它在 .NET 社区中获得了很大的关注。

但目前我建议您将 F# 用于它擅长的领域 - 算法开发、探索数据等。并使用 C#/VB 作为表示层。

# c# - 使用 Reflection 设置 List 类型的 Property

> ID：315231
> 
> 赞同：14
> 
> 时间：2008-11-24T19:52:16.077
> 
> 标签：c#, reflection, .net-2.0

如何使用反射创建具有自定义类 (List<CustomClass>) 的通用列表？我需要能够添加值并用于 `propertyInfo.SetValue(..., ..., ...)`存储它。将这些 List<> 存储为其他数据结构会更好吗？

编辑：

我应该指定对象更像这样，但 Marc Gravell 的回答仍然有效。

```
class Foo
{
    public List<string> Bar { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-24T20:01:47.677

```
class Foo
{
    public string Bar { get; set; }
}
class Program
{
    static void Main()
    {
        Type type = typeof(Foo); // possibly from a string
        IList list = (IList) Activator.CreateInstance(
            typeof(List<>).MakeGenericType(type));

        object obj = Activator.CreateInstance(type);
        type.GetProperty("Bar").SetValue(obj, "abc", null);
        list.Add(obj);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T19:57:48.497

这是一个将 List<> 类型转换为 List<string> 的示例。

var list = typeof(List<>).MakeGenericType(typeof(string));

# c# - 在 C# 中获取组合框文本

> ID：315237
> 
> 赞同：6
> 
> 时间：2008-11-24T19:53:20.817
> 
> 标签：c#, .net, winforms, combobox

我用枚举中的值填充了一个组合框。

现在组合框是文本对吗？所以我使用了一个getter和一个setter。我在阅读文本时遇到问题。

这是代码：

```
public BookType type
{
    get
    {
        return (BookType)Enum.Parse(typeof(BookType), this.typeComboBox.Text);
    }
    set
    {
        this.typeComboBox.Text = value.ToString();
    }
} 
```

出于某种原因，`this.typeComboBox.Text`当我在组合框中选择一个项目时，总是返回一个空字符串。

有人看到我做错了吗？

编辑：我得出的结论是问题出在时间上。我召唤文本的时间点确实是在我更改组合框之后，但仍然在该值被解析为值之前。现在以不同的方式解决了问题，感谢所有想法。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-08-05T11:22:20.590

试试这个。这对我有用。

```
string selectedText = this.ComboBox.GetItemText(this.ComboBox.SelectedItem); 
```

GetItemText 方法分析项目并返回绑定到该项目的文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T20:18:45.180

将`DropDownStyle`ComboBox 的 设置为`DropDownList`。这将确保只能选择列表中已有的元素（无需检查文本实际上是否为有效值）。然后，如果您使用`Enum.GetValues(typeof(BookType))`来填充组合框，则`typeComboBox.SelectedItem`属性将为`BookType`. 所以你可以在属性 getter 和 setter 中使用它。

所以总结一下。只要您使用 DropDownList 样式，就不必将组合框绑定到文本值列表。使用 SelectedItem 属性来获取所需类型的项目，而不是检查 Text 属性。

编辑：您可能必须检查 SelectedItem 属性是否为空

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T20:07:22.737

组合框从索引 -1 开始，它没有文本，因此是一个空字符串：“”

然后我将索引更改为我需要的 BookType，然后我得到错误的输出......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T20:11:20.297

你应该试试 this.typeComboBox.SelectedItem.ToString()

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T20:11:54.710

您是否尝试过使用`this.typeComboBox.SelectedText`而不是`typeComboBox.Text`？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T20:14:43.953

我刚刚创建了一个简单的 Windows 窗体，对我来说一切正常。这是代码。

```
public enum Test
{
    One, Two, Three
}

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        this.comboBox1.DataSource = Enum.GetNames(typeof(Test));
    }

    public Test Test
    {
        get 
        {
            return (Test)Enum.Parse(typeof(Test), this.comboBox1.Text);
        }
        set
        {
            this.comboBox1.Text = value.ToString();
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        MessageBox.Show(this.Test.ToString());

        this.Test = Test.Two;

        MessageBox.Show(this.Test.ToString());
    }
} 
```

# database - 审计跟踪和实施 SOX/HIPAA/等，敏感数据的最佳实践

> ID：315240
> 
> 赞同：5
> 
> 时间：2008-11-24T19:54:00.253
> 
> 标签：database, security, audit

我认为自己在应用程序设计方面相对精通，但我从来不用处理敏感数据。我一直想知道审计跟踪的最佳实践是什么，以及应该如何实施它们。我现在不必这样做，但如果他们要求我为他们做一些工作，能够自信地与医疗公司交谈会很好。

假设我们有一个“学校”数据库，“老师”、“班级”、“学生”都在多对多“成绩”表中标准化。你会记录什么？“成绩表”上的每次插入/更新？只有更新（比如说，一个孩子闯入并想改变成绩，这应该发出危险信号）？这是否完全取决于一个人想要的偏执程度？有最佳实践吗？

这是应该在数据库中完成的事情吗？（每个敏感 SELECT 上的触发器会在记录每个查询的“审计”表中插入一行？）应该记录什么？是否有自动内置到 Oracle/DB2 中的功能为您做这件事？这应该是应用程序端逻辑吗？

如果有人有任何关于如何处理敏感数据的正式文档/书籍（不是国防部的“可信计算”规范，而是类似的东西：P），我将不胜感激。如果这个问题非常模糊，我很抱歉。我意识到这因应用程序而异。我只是想听听您在处理敏感数据方面的详细经验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T05:47:33.410

首先要了解的是您选择的 DBMS 的原生审计功能。这些在细节上有所不同，但通常提供一种配置审计哪些操作的方法，并为它们生成的审计记录提供安全存储。

接下来要了解的是您要审核的内容。例如，对于 HIPAA 和 SOX，您可能正在查看 PII - 个人识别信息。记住人们对访问奥巴马的电话记录或各种名人医疗记录的大惊小怪，或者......那些被抓住是因为系统审核了谁阅读了这些记录，而审计分析官 (AAO) 发现名人记录被人们访问了没有特别授权这样做的人。因此，这些系统必须记录谁访问了每条记录，并发现这样做的用户没有真正的商业理由这样做。在这些情况下，用户似乎具有读取记录的权限，因此如果他们的日常职责要求他们查看记录，他们可以这样做。但，

这意味着您可能不想跟踪谁访问了状态表，该表记录了州代码和全名（以及有关州的其他信息）。该列表没有任何机密信息 - 谁阅读它并不重要。当然，几乎没有人应该写信给它。状态列表不会经常更改 - 但这可能可以通过撤销每个人对表的更新和删除权限来处理。

OTOH，您可能确实想要记录谁访问了病史 (HIPAA) 中的记录，或者谁修改了会计系统 (SOX) 中的数据。您可能需要也可能不需要担心谁会读取会计数据；其中很多可以通过基本权限来处理（会计人员有权限；IT 人员没有）。但是，审计始终是一道额外的防线。

请记住，如果从未查看过审计记录，它们将无济于事。一般来说，审计会减慢系统的速度（仅仅是因为它在写入审计记录时会做更多的工作）；在决定实施您的审计策略之前，了解它减慢了多少是很重要的。但是，有些事情比申请速度更重要，其中之一就是让自己和其他工作人员免于入狱。审计可能是必要的，以确保发生这种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-29T18:56:11.557

Oracle 有一个名为 Oracle Audit Vault 的产品——DB2 可能有一个等效产品。

你应该从*预防*开始。系统不应允许无效操作。时期。如果系统允许需要监视的“可疑”操作，那就是“业务逻辑”，您可能最好像其他业务逻辑一样实施。

如果您想在数据库中执行某些操作，可以查看日志传送（术语可能因 RDBMS 与 RDBMS 不同）。基本上，任何 DML 操作都会记录到文件中。您可以将此信息用于备份和时间点恢复，甚至用于复制/HA/故障转移/等。如果您以“仅附加”的方式将日志发送到单独的“受信任”系统（即日志发送过程具有创建新日志文件的权限，但不能修改现有信息），那么您已经拥有原始审计功能. 如果您以安全的方式（即身份验证、不可否认性）进行操作，您甚至可能非常接近“合规性”：-p

当然，筛选大量的 INSERT/UPDATE/DELETE 语句并不是最复杂的工作方式。

# eclipse - 源代码控制设置

> ID：315242
> 
> 赞同：1
> 
> 时间：2008-11-24T19:54:31.780
> 
> 标签：eclipse, svn, version-control

我想我会在家里为我的爱好项目安装一个 Subversion，我第一次尝试做对（我的工作的源代码控制策略或缺少它们，嗯，并不完美）。

我正在努力解决的问题是：我想对整个 Eclipse 项目进行版本控制。从 Eclipse 的角度来看，这会很好——我会让它做它的事情，并且应该只是意味着我需要忽略一些二进制文件/整个构建目录，并在我设置项目时只设置一次这些忽略（对？）。无论如何，我已经尝试了几次，svn 似乎感到困惑并忽略了我的忽略设置。正确的程序应该是什么？

谢谢。

PS 我正在从命令行执行 svn 位，试图避免使用 GUI，直到我满意为止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T20:36:56.733

基本上有两种方法可以通过名称或模式来指示 subversion 忽略文件。

第一种方法是找到配置文件（位置取决于平台）并将文件名或模式添加到 global-ignores 列表中。这适用于机器上或该用户的所有 svn 操作。

第二种方法是在版本化目录上设置 svn:ignore 属性，例如：

```
svn propedit svn:ignore myDirectory 
```

这将为 svn:ignore 属性打开一个编辑器，您可以在其中添加例如：

```
bin
obj
*.bak 
```

请注意，此属性更改也是版本化的并且需要提交，之后它们适用于在该目录上工作的每个人（当​​然是在更新之后）。此属性不适用于递归子目录。

有关更多信息，请参阅[svn 书](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.ignore.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T20:34:23.150

IIRC，如果您按名称显式添加它们，Subversion 不会阻止您`svn add`标记标记为忽略的文件（尽管它可能会警告您）。svn:ignore 属性主要是为了防止它们出现在`svn status`.

此外，AFAIK， svn:ignore 属性不是递归的，因此它只适用于它设置的目录的第一级子级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T20:57:03.883

您能否更清楚地了解 svn 对什么特别感到困惑？请记住，该`svn:ignore`属性是按目录设置的；即，如果您想忽略`.foo`in`./bar`和 in 中的文件`./bar/abc`，则需要编辑每个目录的属性。是的，这是一个痛苦的屁股。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T20:09:04.170

如果你在 linux 机器上，你可以尝试这些步骤，如果在 windows 上，漂亮的安装程序会为你做事。 [https://help.ubuntu.com/community/Subversion](https://help.ubuntu.com/community/Subversion)

颠覆书也可能有助于 [http://svnbook.red-bean.com/en/1.5/index.html](http://svnbook.red-bean.com/en/1.5/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T21:24:37.387

我有几种方法将项目添加到源代码管理中。这是更高级别的描述：

一种方法是导入一个空的顶级文件夹，然后 svn checkout，然后将项目文件复制到该工作副本，然后 svn 添加除要忽略的文件之外的所有文件（或 svn 还原特定文件/文件夹）并将忽略属性设置为需要，然后提交。

另一种方法是复制项目文件，手动删除要忽略的文件和文件夹，然后svn import。然后删除那些文件。然后执行 svn checkout，然后在该工作副本和 svn commit 上设置忽略属性。然后将原始忽略的文件/文件夹复制到工作副本。

当然，全局忽略的东西越多，这些步骤就越容易。

# apache-flex - 如何让一个窗口显示在应用程序之外？

> ID：315243
> 
> 赞同：1
> 
> 时间：2008-11-24T19:54:34.247
> 
> 标签：apache-flex, actionscript-3, air

在我们的 Flex AIR 应用程序中，我们的应用程序主窗口相当窄。这意味着警报对话框的两边都被切掉了，而右键菜单被裁剪了。我们怎样才能让这些窗口不被我们的主窗口裁剪？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T15:33:28.500

将您的主 AIR 窗口变成一个不可见的透明窗口，并使您的应用程序的主要工作窗口成为不可见窗口的子窗口。然后，当您的 AIR 应用程序启动时，将不可见窗口设置为包含桌面的大小。然后，您将能够在此桌面区域上放置任意数量的窗口和对话框，而不必担心它们会像现在发生的那样被剪裁。

如果您想支持多屏幕显示 - 以便您的可见应用程序窗口可以从一个显示到另一个显示，那么将您的不可见窗口设置为整个图形坐标系的大小，以便它包含任何和所有显示屏幕。

一旦采用了不可见窗口的方法，您将能够实现类似于原生应用程序的窗口行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-10T16:29:23.233

你如何显示警报？如果您使用 Alert.show()，它将使用默认宽度。但是，您可以通过创建警报对象、手动（甚至动态地）设置宽度，然后使用 PopUpManager 显示它、将其放置在您想要的位置并隐藏它来解决此问题。它需要更多的代码，但会给你更多的灵活性。

这是一个小样本：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" 
    creationComplete="creationCompleteHandler();">
    <mx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.managers.PopUpManager;

            private function creationCompleteHandler():void
            {
                var alert:Alert = new Alert();

                alert.width = 100;

                alert.text = "this Alert is\n100px wide";

                PopUpManager.addPopUp(alert, this);

                PopUpManager.centerPopUp(alert);

                Alert.show("this Alert uses the default width");
            }
        ]]>
    </mx:Script>
</mx:WindowedApplication> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T16:05:16.267

在 Flash 播放器内部运行 flex 应用程序时，无法在舞台外显示窗口。因此，完成这项工作的唯一方法是让您的应用程序更大。

虽然您可以使用 flex/ajax 桥并调用 javascript 警报框，但它们不会受到舞台的约束。但它不会像应用程序的其他部分那样被蒙皮，并且需要更多的工作才能上钩，特别是如果你正在听用户点击确定按钮......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T09:07:36.117

我相信 adobe air 的 dojo 扩展应该能够满足您的需求。我自己从来没有使用过它，也不确定会有什么权衡，但它可能值得一看。

[http://sitepen.com/labs/dair/](http://sitepen.com/labs/dair/)

# c++ - 在 Qt 4.4 中使用 QMDIArea。

> ID：315261
> 
> 赞同：1
> 
> 时间：2008-11-24T19:59:32.677
> 
> 标签：c++, qt, user-interface, qt4, qmdiarea

我正在使用`QMdiArea`Qt 4.4 中的。

如果创建了一个新项目，我会在一个`QMdiArea`. 我想禁止用户在运行时关闭子窗口。只有关闭整个应用程序或创建新项目时，才应关闭子窗口。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-21T10:52:29.097

您需要定义自己的`subWindow`. 创建一个子类`QMdiSubWindow`并覆盖`closeEvent(QCloseEvent *closeEvent)`. 你可以通过参数来控制它。例如：

```
void ChildWindow::closeEvent(QCloseEvent *closeEvent)
{
  if(/*condition C*/)
    closeEvent->accept();
  else
   closeEvent->ignore(); // you can do something else, like 
                         // writing a string in status bar ...
} 
```

然后像这样子类化`QMdiArea`并覆盖`QMdiArea::closeAllSubWindows ()`：

```
class MainWindowArea : public QMdiArea
{
    Q_OBJECT
public:
    explicit MainWindowArea(QWidget *parent = 0);

signals:
    void closeAllSubWindows();
public slots:

};
// Implementation:
MainWindowArea::closeAllSubWindows()
{
    // set close condition (new project is creating, C = true)
    foreach(QMdiSubWindow* sub,this->subWindowList())
    {
        (qobject_cast<ChildWindow*>(sub))->close();
    }
} 
```

您可能还需要覆盖`close`您的 mdi 区域的插槽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T02:57:28.403

您将执行与顶级窗口相同的操作：处理并忽略它发送的 QCloseEvent。QMdiArea::closeActiveSubWindow/QMdiArea::closeAllSubWindows 只需调用 QWidget::close，它会发送一个 closeEvent 并在继续之前确认它已被接受。

您可以通过继承 QMdiSubWindow 并重新实现 QWidget::closeEvent 来处理此事件，或者使用事件过滤器来拦截它。

# c++ - 我可以在同一个进程中使用同一个 DLL 的两个不兼容版本吗？

> ID：315285
> 
> 赞同：12
> 
> 时间：2008-11-24T20:09:02.157
> 
> 标签：c++, windows, winapi, dll

我正在使用由同一供应商生产的两个商业库，称为 VendorLibA 和 VendorLibB。这些库的分布取决于编译器版本（例如 VC7、VC8）的许多 DLL。这两个库都依赖于由该供应商生产的另一个库，称为 VendorLibUtils 并包含在一个 DLL 中。

问题：VendorLibA 使用的 VendorLibUtils 版本与 VendorLibB 不同。这两个版本不是二进制兼容的，即使它们是，使用错误的版本也是一个坏主意。

有什么办法可以在同一进程下使用这两个库？

**注意：** LoadLibrary 无法解决这个问题，因为我的流程不是导入 VendorLibUtils 的流程。

**编辑：**忘记提及显而易见的事情，我不必为任何商业库提供源代码，而且我可能永远也不会拥有（*叹气*）。

**编辑：**另一种方法是这样做：[How to combine GUI applications in Windows](https://stackoverflow.com/questions/312569/how-to-combine-gui-applications-in-windows)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T23:14:22.640

我认为你最有希望的选择是大声抱怨销售互不兼容产品的供应商。这与 DLL 的想法相反。

您不能只是将 DLL 放在不同的目录中。一旦加载了具有给定名称的 DLL，所有其他尝试加载具有相同模块名称的另一个 DLL 将仅使用已加载的那个，即使路径不同。

由此，我们可以得出结论，要加载 VendorLibUtils 的两个副本，一个副本需要具有不同的名称。您不能只重命名 DLL 文件；你程序中的代码不会知道去寻找不同的文件。因此，也许有一种方法可以编辑 VendorLibB 的导入表，使其认为它需要的函数在 VendorLibUtilsB.dll 中，而不仅仅是 VendorLibUtils.dll。恐怕我不知道有什么实用程序可以做到这一点，但我毫不怀疑它是可能的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-17T13:21:14.090

我有一个类似的问题。具体来说，我想使用嵌入在使用不兼容 Qt 版本的应用程序中的 Python 解释器中的 PyQt。主应用程序使用了两个 Qt DLL：QtCore.dll 和 QtGui.dll。

当我从嵌入式 Python 解释器加载 PyQt 时，我会收到一个错误：

```
ImportError: DLL load failed: The specified procedure could not be found. 
```

这发生在线上：

```
from PyQt4 import QtGui 
```

问题是一旦不兼容的 QtGui.dll 被加载到主应用程序的进程空间中，任何对 QtGui.dll 的引用（例如来自文件 QtGui.pyd）都是不正确的。

接下来发生的事情，我并不骄傲。

> 首先，我`QtGui4.dll`在 PyQt 发行版中重命名为`QtGuiX.dll` ，然后将其重命名`QtCore4.dll`为`QtCoreX.dll`. 请注意，重命名保持了相同数量的字符，这很重要。
> 
> 接下来，我在 Notepad++ 中打开了文件，并替换了to和 from to`QtGui.pyd`的所有纯文本引用。我对文件重复了这个过程 ：和.`QtGui4.dll``QtGuiX.dll``QtCore4.dll``QtCoreX.dll``QtCore.pyd``QtGuiX.dll``QtCoreX.dll`
> 
> 最后我检查了我的 PyQt 测试应用程序是否仍然有效。它做了！然后我尝试从嵌入式 Python 解释器运行 PyQt 测试应用程序，它运行良好。
> 
> 因此，它似乎适用于几个微不足道的情况。我希望我需要对 PyQt 发行版中的所有 DLL 和 PYD 重复该过程。

这可能不是正确的做事方式，但我想不出它会爆炸的任何具体原因（除非我更改文件名的长度）。

归功于（或责备）线程上的其他人启发了这个可怕的故事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T01:55:12.787

正如其他人所提到的，您可以重命名 VendorLibUtils 的副本之一并修改关联的 VendorLib DLL 的导入表以链接到它，而不是创建它的 VendorLibUtils.dll。

有一些工具可以让您以这种方式编辑 EXE/DLL 文件。[CFF Explorer](http://www.ntcore.com/exsuite.php)是一款相当不错的浏览器，它允许编辑导入表。如果您打开其中的 VendorLib DLL 并转到 Import Directory 部分（在左侧的树中），您将在主窗口的顶部看到一个模块列表。您可以通过双击其名称来重命名模块。然后您只需保存 DLL，它现在应该使用您重命名的 VendorLibUtils DLL。

当然，这假设 VendorLib 使用导入表来访问 VendorLibUtils，它可能不会 - 它可能使用`LoadLibrary`/ `GetProcAddress`，在这种情况下您将看不到 VendorLibUtils 的导入表条目。

实际上，如果 VendorLib 确实使用了导入表，但在某些地方*也*用于`LoadLibrary`访问 VendorLibUtils DLL（我已经看到它完成了），那么这些地方仍然会使用错误的。如果您重命名这两个库，在这种情况下您至少可能会看到一个错误（因为现在不存在具有原始名称的 DLL）。如果发生这种情况，有一种方法可以解决，但此时它开始变得相当复杂，所以除非你真的想/需要知道，否则我不会详细说明。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T20:41:31.233

由于您没有直接使用 VendorLibUtils，我假设您不能使用[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)等。

如果 VendorLibUtils DLL 仅按序号导出，您可能可以重命名其中一个库并修补相应的 VendorLib *X*以对其导入使用不同的文件名。

如果 VendorLibUtils DLL 有一个或多个同名的导出符号，您*可能*还需要修补导入和导出表，但我们希望不要！:-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T20:36:54.097

我不是 DLL 方面的专家，但我认为可能的唯一方法是使用[`LoadLibrary()`](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)并显式加载 DLL。然后，您可以使用[`GetProcAddress()`](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx).

```
HMODULE v1 = LoadLibrary(_T("libv1_0.dll"));
libv1_0::fun_in_lib = reinterpret_cast<FUNTYPE>(GetProcAddress(v1, _T("fun_in_lib")); 
```

和

```
HMODULE v2 = LoadLibrary(_T("libv2_0.dll"));
libv2_0::fun_in_lib = reinterpret_cast<FUNTYPE>(GetProcAddress(v2, _T("fun_in_lib")); 
```

这是否可行仍然取决于图书馆，所以它可能会或可能不会起作用，但据我所知，这是唯一的可能性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-03T15:27:32.380

你的意思是，你有类似于 MSVCRT80.DLL 和 MSVCRT90.DLL 的情况？Microsoft 对这些 DLL 进行编号是有充分理由的。如果两者都称为 MSVCRT.DLL，则只有其中一个会在单个进程中加载​​。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-12T05:52:01.260

实际上可以将不同版本的 dll 隐式加载到单个进程中。

这样做需要：

1.  创建两个程序集，每个程序集都包含一个必须多次加载的 dll 版本。听起来很复杂，但实际上它只需要创建 (2) 个命名的子文件夹，每个文件夹都有一个包含一些 xml 的 .manifest 文件，以及它自己的 dll 副本。所以，VendorUtilsAssemblyV1 和 VendorUtilsAssemblyV2

2.  使每个依赖 dll 使用组装机制来解决隐式依赖关系 - 通过添加显式标识 VendorUtilsAssemblyV1 或 V2 的 assemblyDependency 指令。

第 2 点有一些选项。如果 VendorLibA 和 VendorLibB 文件不包含它们自己的清单，那么您可以简单地使用名为 VendorLibA.2.dll.manifest 和 VendorLibB.2.dll.manifest 的所需依赖Assembly 指令添加清单文件。如果它们已经包含清单（可能链接到 VS2005 或 VS2008 C-Runtime），则使用 MT.EXE 工具合并新的依赖项。

# wpf - 使用 XAML 矢量图像作为窗口图标

> ID：315295
> 
> 赞同：5
> 
> 时间：2008-11-24T20:14:21.460
> 
> 标签：wpf, xaml, vector-graphics

LearnWPF.com 发布[了这篇](http://learnwpf.com/Posts/Post.aspx?postId=d849072b-4e45-4ad4-b28c-71341ea30d46)关于将位图图像转换为 XAML 并在您的应用程序中使用它们的文章。

XAML 图像的外部元素是`Canvas`. 但是，该`Window.Icon`属性只接受一个`ImageSource`对象。有谁知道我如何“包装”`Canvas`在一个中，`ImageSource`以便我可以将它用作窗口图标？

或者，是否有更好的方法将 XAML 图像用作窗口图标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T20:38:56.153

WPF 窗口 Chrome（标题栏、图标等）是典型 Win32 窗口系统的一部分。因此，它不是为与 Vector Icon 一起使用而构建的，您需要为 Window.Icon 属性指定***.Ico***、***.png***或其他一些受支持的图像文件。

但是如果你真的想做一个 Vector(XAML) 动画图标，你需要考虑**Chrome 少窗口**的概念。这意味着摆脱旧样式的窗口镶边（***WIndowStyle="None"***）并完全使用 WPF 构建我们自己的镶边，然后您可以将 Vector 直接放在左上角，它就像您使用任何其他 XAML 一样工作应用程序中的视觉效果。

阅读有关如何在以下链接上创建 Chromeless 窗口的更多信息

*   [如何使用 WPF 实现无镶边窗口？](https://stackoverflow.com/questions/37830/how-do-i-implement-a-chromeless-window-with-wpf)
*   [在 WPF 中创建自定义窗口](http://www.kirupa.com/blend_wpf/custom_wpf_windows.htm)

# c# - 如何列出所有月份名称，例如组合？

> ID：315301
> 
> 赞同：79
> 
> 时间：2008-11-24T20:16:53.513
> 
> 标签：c#, asp.net, .net, datetime

目前我正在`DateTime`为每个月创建一个并将其格式化为仅包含该月。
有没有其他或更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-11-24T20:22:58.197

您可以使用[`DateTimeFormatInfo`](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.aspx)获取该信息：

```
// Will return January
string name = DateTimeFormatInfo.CurrentInfo.GetMonthName(1); 
```

或获取所有名称：

```
string[] names = DateTimeFormatInfo.CurrentInfo.MonthNames; 
```

您还可以`DateTimeFormatInfo`基于`CultureInfo`with实例化一个新的，[`DateTimeFormatInfo.GetInstance`](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.getinstance.aspx)或者您可以使用当前区域性的[`CultureInfo.DateTimeFormat`](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.datetimeformat.aspx)属性。

```
var dateFormatInfo = CultureInfo.GetCultureInfo("en-GB").DateTimeFormat; 
```

请记住，.Net 中的日历最多支持 13 个月，因此对于只有 12 个月的日历（例如在 en-US 或 fr 中找到的日历），您将在末尾获得一个额外的空字符串。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-06-11T20:28:45.423

此方法将允许您将月份的键值对列表应用于其`int`对应项。我们使用 Enumerable Ranges 和 LINQ 用一行生成它。万岁，LINQ 代码打高尔夫球！

```
var months = Enumerable.Range(1, 12).Select(i => new { I = i, M = DateTimeFormatInfo.CurrentInfo.GetMonthName(i) }); 
```

要将其应用于 ASP 下拉列表：

```
// <asp:DropDownList runat="server" ID="ddlMonths" />
ddlMonths.DataSource = months;
ddlMonths.DataTextField = "M";
ddlMonths.DataValueField = "I";
ddlMonths.DataBind(); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-24T20:22:24.877

您可以使用以下内容返回包含月份名称的字符串数组

```
System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.MonthNames 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-24T20:26:33.853

它们被定义为全球化命名空间中的一个数组。

```
using System.Globalization;

for (int i = 0; i < 12; i++) {
   Console.WriteLine(CultureInfo.CurrentUICulture.DateTimeFormat.MonthNames[i]);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-24T20:23:09.943

您可以从 中获取本地化月份`Thread.CurrentThread.CurrentCulture.DateTimeFormat.MonthNames`和不变月份的列表`DateTimeFormatInfo.InvariantInfo.MonthNames`。

```
string[] localizedMonths = Thread.CurrentThread.CurrentCulture.DateTimeFormat.MonthNames;
string[] invariantMonths = DateTimeFormatInfo.InvariantInfo.MonthNames;

for( int month = 0; month < 12; month++ )
{
    ListItem monthListItem = new ListItem( localizedMonths[month], invariantMonths[month] );
    monthsDropDown.Items.Add( monthListItem );
} 
```

根据日历类型，一年中的月数可能存在一些问题，但在此示例中我只是假设为 12 个月。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-24T20:23:32.220

尝试枚举月份名称：

```
for( int i = 1; i <= 12; i++ ){
  combo.Items.Add(CultureInfo.CurrentCulture.DateTimeFormat.MonthNames[i]);
} 
```

它位于 System.Globalization 命名空间中。

希望有帮助！

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-06T20:11:00.003

```
public IEnumerable<SelectListItem> Months
{
  get
  {
    return Enumerable.Range(1, 12).Select(x => new SelectListItem
    {
      Value = x.ToString(),
      Text = DateTimeFormatInfo.CurrentInfo.GetMonthName(x)
    });
  }
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-04-22T14:38:12.917

一种在**C#**中使用**LINQ检索****动态文化**特定月份名称列表的方法。

 ****```
ComboBoxName.ItemsSource= 
System.Globalization.CultureInfo.
CurrentCulture.DateTimeFormat.MonthNames.
TakeWhile(m => m != String.Empty).ToList(); 
```

**或者**

在此示例中，使用 Month 和 MonthName 属性创建了一个匿名对象

```
var months = CultureInfo.CurrentCulture.DateTimeFormat.MonthNames
 .TakeWhile(m => m != String.Empty)
 .Select((m,i) => new  
 {  
     Month = i+1,  
     MonthName = m
 }) 
 .ToList(); 
```

**PS**：我们使用 TakeWhile 方法是因为 MonthNames 数组包含一个空的第 13 个月。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-02-03T20:00:47.117

一个小 LINQ 只是因为它非常简洁：

```
var monthOptions = DateTimeFormatInfo.CurrentInfo.MonthNames
    .Where(p=>!string.IsNullOrEmpty(p))
    .Select((item, index) => new { Id = index + 1, Name = item }); 
```

您需要 Where 子句，因为日历返回第 13 个月的名称（英文为空）。

该索引返回 IEnumerable 内的索引，因此您需要为实际月份索引 +1。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-02-12T21:01:38.760

当然，我会为一个 10 岁以上的问题提供意见。

在我的例子中，我创建了一个返回字典（或类似字典）的属性，使用以下代码生成：

```
Dictionary<int, string> Months = Enumerable.Range(1, 12).Select(i => new KeyValuePair<int, string>(i, System.Globalization.DateTimeFormatInfo.CurrentInfo.GetMonthName(i))).ToDictionary(x => x.Key, x => x.Value); 
```

**输出（来自 Linqpad）：**

```
Key Value
1   January
2   February
3   March
4   April
5   May
6   June
7   July
8   August
9   September
10  October
11  November
12  December 
```

希望有人觉得这很有用！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-06-17T13:36:08.213

我是通过以下方式进行的：（可以设置文化）

```
var months = Enumerable.Range(1, 12).Select(i => 
    new
    {
        Index = i,
        MonthName = new CultureInfo("en-US").DateTimeFormat.GetAbbreviatedMonthName(i)
    })
    .ToDictionary(x => x.Index, x => x.MonthName); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-05T21:42:54.473

```
List<string> mnt = new List<string>();    
int monthCount = Convert.ToInt32(cbYear.Text) == DateTime.Now.Year ? DateTime.Now.Month : 12;    
            for (int i = 0; i < monthCount; i++)    
            {    
                mnt.Add(CultureInfo.CurrentUICulture.DateTimeFormat.MonthNames[i]);    
            }    
            cbMonth.DataSource = mnt; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-03T07:06:33.453

这是使用信用卡月份表格填写下拉列表的一个很好的示例：

```
 Dim currentCulture As CultureInfo = CultureInfo.CurrentUICulture
    Dim monthName, monthNumber As String

    For x As Integer = 0 To 11
        monthNumber = (x + 1).ToString("D2")
        monthName = currentCulture.DateTimeFormat.MonthNames(x)
        Dim month As New ListItem(String.Format("{0} - {1}", monthNumber, monthName),
                                  x.ToString("D2"))
        ddl_expirymonth.Items.Add(month)
    Next 
```

创建以下本地化为当前语言的内容，例如：

```
01 - January
02 - February
etc. 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-21T05:19:33.203

**如何以任何顺序创建自定义月份名称列表**

是的，我正在回答一个 10 多年前的问题！:D

然而，我想添加这个代码片段，希望它可以帮助其他人。它显示了如何以任何自定义顺序输出月份名称列表。就我而言，我需要它在 10 月开始，但您可以通过设置整数列表将月份按任何顺序排列（甚至有重复的月份）。

```
model.Controls = new
{
    FiscalMonths = new
    {
        Value = DateTime.Now.Month,
        Options = (new List<int> { 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9 }).Select(p => new
        {
            Value = p,
            Text = DateTimeFormatInfo.CurrentInfo.GetMonthName(p)
        })
    }
}; 
```

以及用于下拉列表的 json 输出：

```
 "FiscalMonths": {
   "Value": 10,
   "Options": [
    {
     "Value": 10,
     "Text": "October"
    },
    {
     "Value": 11,
     "Text": "November"
    },
    {
     "Value": 12,
     "Text": "December"
    },
    {
     "Value": 1,
     "Text": "January"
    },
    {
     "Value": 2,
     "Text": "February"
    },
    etc .... 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-01-22T18:53:31.527

您可以使用 linq 轻松地执行以下操作，以便下拉列表中只有 12 个项目。

```
var Months = new SelectList((DateTimeFormatInfo.CurrentInfo.MonthNames).Take(12)); 
```

# if-statement - “如果”贵吗？

> ID：315306
> 
> 赞同：117
> 
> 时间：2008-11-24T20:18:32.997
> 
> 标签：if-statement, language-agnostic, branch-prediction

我一辈子都记不住老师那天到底说了什么，我希望你可能知道。

该模块是“数据结构和算法”，他告诉我们一些类似的事情：

> `if`声明是最昂贵的[东西] 。[某事]注册[某事]。

是的，我确实有一个可怕的记忆，我真的很抱歉，但我已经搜索了几个小时，但没有任何结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2008-11-24T20:38:53.093

在最低级别（在硬件中），是的，**如果**s 很昂贵。为了理解原因，您必须了解[管道](http://en.wikipedia.org/wiki/Pipeline_(computing))是如何工作的。

当前要执行的指令存储在通常称为*指令指针*（IP）或*程序计数器*（PC）的东西中；这些术语是同义词，但不同的术语用于不同的架构。对于大多数指令，下一条指令的 PC 只是当前 PC 加上当前指令的长度。对于大多数 RISC 架构，指令的长度都是恒定的，因此 PC 可以以恒定的量递增。对于 x86 等 CISC 架构，指令可以是可变长度的，因此对指令进行解码的逻辑必须计算出当前指令需要多长时间才能找到下一条指令的位置。

然而，对于*分支*指令，要执行的下一条指令不是当前指令之后的下一个位置。分支是 goto - 它们告诉处理器下一条指令在哪里。分支可以是有条件的或无条件的，目标位置可以是固定的或计算的。

有条件的与无条件的很容易理解——只有在某个条件成立时才会采用条件分支（例如一个数字是否等于另一个）；如果不采取分支，则控制正常进行分支之后的下一条指令。对于无条件分支，总是采用分支。条件分支出现在`if`语句`for`和`while`循环的控制测试中。无条件分支出现在无限循环、函数调用、函数返回`break`和`continue`语句、臭名昭著的`goto`语句等等（这些列表远非详尽）中。

分支目标是另一个重要问题。大多数分支都有一个固定的分支目标——它们转到代码中的特定位置，该位置在编译时是固定的。这包括`if`语句、各种循环、常规函数调用等等。 *计算*分支在运行时计算分支的目标。这包括`switch`语句（有时）、从函数返回、虚函数调用和函数指针调用。

那么这一切对性能意味着什么呢？当处理器看到一条分支指令出现在它的流水线中时，它需要弄清楚如何继续填满它的流水线。为了弄清楚程序流中分支之后的指令是什么，它需要知道两件事：（1）是否会采用分支和（2）分支的目标。弄清楚这一点称为[分支预测](http://en.wikipedia.org/wiki/Branch_prediction)，这是一个具有挑战性的问题。如果处理器猜对了，程序就会全速运行。相反，如果处理器猜错了，它只是花了一些时间计算错误的东西*。*它现在必须刷新其管道并使用来自正确执行路径的指令重新加载它。底线：性能大受打击。

因此，if 语句昂贵的原因是由于**分支错误预测**。这只是最低级别的。如果您正在编写高级代码，则根本不需要担心这些细节。只有在使用 C 或汇编语言编写对性能至关重要的代码时，才应该关心这一点。如果是这样的话，即使需要更多的指令，编写无分支代码通常也优于有分支的代码。您可以使用一些很酷的小技巧来计算诸如`abs()`、`min()`和`max()`没有分支之类的东西。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-24T20:25:11.703

“昂贵”是一个非常相对的术语，尤其是与“ `if`”语句的关系，因为您还必须考虑条件的成本。范围可以从几条简短的 cpu 指令到测试调用远程数据库的函数的结果。

我不会担心的。除非您正在做嵌入式编程，否则您可能根本不应该担心“ `if`”的成本。对于大多数程序员来说，它*永远不会*成为您应用程序性能的驱动因素。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-24T20:27:48.563

分支，尤其是在 RISC 架构微处理器上，是一些最昂贵的指令。这是因为在许多架构上，编译器会预测最有可能采用哪条执行路径并将这些指令放在可执行文件中，因此当分支发生时它们已经在 CPU 缓存中。如果分支走另一条路，它必须返回主内存并获取新指令——这是相当昂贵的。在许多 RISC 架构上，所有指令都是一个周期，除了分支（通常是 2 个周期）。我们在这里谈论的不是主要成本，所以不用担心。此外，编译器在 99% 的时间里会比你优化得更好：) 关于 EPIC 架构（安腾就是一个例子）真正令人敬畏的事情之一是它缓存（并开始处理）来自分支两侧的指令，然后一旦分支的结果是丢弃它不需要的集合已知。如果典型架构沿着不可预测的路径分支，这可以节省额外的内存访问。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-24T21:01:50.630

查看关于单元性能的文章[通过消除分支获得更好的性能。](http://www.cellperformance.com/articles/2006/07/tutorial_branch_elimination_pa.html)另一个有趣的是[这篇关于](http://realtimecollisiondetection.net/blog/?p=90)实时碰撞检测博客上的无分支选择的帖子。

除了已经针对此问题发布的出色答案之外，我想提醒一下，尽管“if”语句被认为是昂贵的低级操作，但尝试在更高级别的环境中使用无分支编程技术，例如脚本语言或业务逻辑层（不管语言），可能是非常不合适的。

绝大多数情况下，程序应该首先为了清晰而编写，然后为了性能而优化。有许多问题领域的性能是最重要的，但一个简单的事实是，大多数开发人员并没有编写用于渲染引擎核心或连续运行数周的高性能流体动力学模拟的模块。当您的解决方案的首要任务是“正常工作”时，您最不想考虑的应该是您是否可以节省代码中条件语句的开销。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-24T20:36:46.157

`if`本身**并不**慢。缓慢总是相对的，我敢打赌，你从来没有感觉到 if 语句的“开销”。如果您要编写高性能代码，则可能无论如何都希望避免分支。缓慢的原因是处理器基于一些启发式和诸如此类的东西`if`从之后预加载代码。`if`它还将停止流水线`if`在机器代码中的分支指令之后直接执行代码，因为处理器还不知道将采用什么路径（在流水线处理器中，多条指令被交错并执行）。执行的代码可能必须反向执行（如果采用另一个分支。它被称为`branch misprediction`），或者`noop`在那些地方填充 ' 以便不会发生这种情况。

如果`if`是邪恶的，那么`switch`也是邪恶的，并且`&&`，`||`也是。别担心。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-24T20:28:50.103

在可能的最低级别`if`包括（在计算所有特定于应用程序的先决条件之后`if`）：

*   一些测试说明
*   如果测试成功，则跳转到代码中的某个位置，否则继续前进。

与此相关的费用：

*   低级比较——通常是 1 个 cpu 操作，超级便宜
*   潜在的跳跃——这可能很昂贵

解释为什么跳跃很昂贵：

*   您可以跳转到内存中任何位置的任意代码，如果结果证明它没有被 cpu 缓存 - 我们有问题，因为我们需要访问主内存，这比较慢
*   现代 CPU 进行分支预测。他们试图猜测是否会成功并在管道中提前执行代码，因此加快速度。如果预测失败，则管道提前完成的所有计算都必须无效。这也是一项昂贵的操作

所以总结一下：

*   如果可以的话，如果你真的，真的，真的很关心性能。
*   **当且仅当**您正在编写实时光线追踪器或生物模拟或类似的东西时，您才应该关心它。在大多数现实世界中，没有理由关心它。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-24T20:36:14.643

现代处理器有很长的执行流水线，这意味着几条指令同时在不同的阶段执行。当下一条指令开始运行时，他们可能并不总是知道一条指令的结果。当他们遇到条件跳转（如果）时，他们有时必须等到管道为空才能知道指令指针应该走哪条路。

我认为它是一列长途货运列车。它可以在直线上快速运载大量货物，但转弯很糟糕。

Pentium 4 (Prescott) 拥有着名的 31 级长流水线。

更多关于[维基百科](http://en.wikipedia.org/wiki/Instruction_pipeline)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-24T20:22:51.707

也许分支会杀死 CPU 指令预取？

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-13T14:42:09.640

另请注意，循环内部*不一定*非常昂贵。

现代 CPU 在第一次访问 if 语句时假定要采用“if-body”（或者反过来说：它还假定要多次采用循环体）（*）。在第二次和进一步访问时，它（CPU）可能会查看**分支历史表**，并查看上次条件如何（是真的吗？是假的吗？）。如果上次为假，则推测执行将继续执行 if 的“else”，或超出循环。

(*) 规则实际上是“**未采用前向分支，采用后向分支**”。在 if 语句中，如果条件评估为假，则*只有*[forward] 跳转（到**if-body 之后的**点）（请记住：CPU 无论如何都假定不进行分支/跳转），但在循环中，循环之后的位置可能有一个前向分支（不被采用），重复时可能有一个向后分支（被采用）。

这也是为什么调用虚函数或函数指针调用并不像许多人认为的那样糟糕的原因之一（[http://phresnel.org/blog/](http://phresnel.org/blog/)）

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-11-24T22:45:28.207

正如许多人所指出的，条件分支在现代计算机上可能非常慢。

话虽这么说，有很多条件分支并不存在于 if 语句中，你不能总是知道编译器会想出什么，担心基本语句需要多长时间实际上总是错误的去做。（如果你能知道编译器会可靠地生成什么，那么你可能没有一个好的优化编译器。）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-24T20:26:28.563

我能想象的唯一可能是指一个`if`语句通常会导致分支的事实。根据处理器架构的具体情况，分支可能会导致流水线停顿或其他不太理想的情况。

然而，这是非常特殊的情况——大多数现代处理器都具有分支预测功能，试图将分支的负面影响降至最低。另一个例子是 ARM 架构（可能还有其他架构）如何处理条件逻辑 - ARM 具有指令级条件执行，因此简单的条件逻辑不会导致分支 - 如果条件不满足，指令将简单地作为 NOP 执行。

说了这么多——在担心这些事情之前先弄清楚你的逻辑是正确的。不正确的代码是尽可能未经优化的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-24T20:33:50.280

CPU 是深度流水线的。任何分支指令（if/for/while/switch/etc）都意味着 CPU 并不真正知道接下来要加载和运行什么指令。

CPU 要么在等待知道要做什么时停止，要么 CPU 进行猜测。对于较旧的 CPU，或者如果猜测错误，您将不得不在它运行并加载正确指令时遭受流水线停顿。根据 CPU 的不同，这可能高达 10-20 条指令的停顿。

现代 CPU 试图通过进行良好的分支预测来避免这种情况，同时执行多个路径，并且只保留实际的路径。这有很大帮助，但只能走这么远。

祝你在课堂上好运。

此外，如果您在现实生活中必须担心这一点，您可能正在做操作系统设计、实时图形、科学计算或类似 CPU 密集型的事情。担心之前的个人资料。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-06-22T01:48:25.890

以最清晰、最简单、最干净的方式编写程序，这显然不是低效的。这可以充分利用最昂贵的资源，你。无论是编写程序还是稍后调试（需要理解）程序。如果性能不够，请*测量*瓶颈在哪里，看看如何缓解它们。只有在极少数情况下，您才需要担心个别（源）指令。性能是关于在第一行选择正确的算法和数据结构，仔细编程，获得足够快的机器。使用好的编译器，当您看到现代编译器所做的那种代码重组时，您会感到惊讶。重构代码以提高性能是一种最后的手段，代码变得更复杂（因此更容易出错），更难修改，因此更昂贵。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-10T19:11:48.020

一些 CPU（如 X86）为编程级别提供分支预测以避免这种分支预测延迟。

一些编译器公开（如 GCC）这些作为高级编程语言（如 C/C++）的扩展。

参考[Linux 内核中的可能（）/不太可能（）宏——它们是如何工作的？他们有什么好处？](https://stackoverflow.com/questions/109710/likely-unlikely-macros-in-the-linux-kernel).

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-24T20:42:22.353

就 ALU 使用而言，最昂贵的是？它使用 CPU 寄存器来存储要比较的值，并在每次运行 if 语句时占用时间来获取和比较值。

因此，对此的优化是在循环运行之前进行一次比较并将结果存储为变量。

只是试图解释你丢失的单词。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-24T20:47:45.760

我曾经和我的一个朋友发生过这样的争论。他使用了一个非常幼稚的圆算法，但声称他的比我的更快（只计算圆的 1/8 的那种），因为我的使用了 if。最后， if 语句被替换为 sqrt 并且不知何故更快。也许是因为 FPU 内置了 sqrt？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-24T17:19:29.777

**你的代码应该是可预测的和可能的。**

如果你的整个程序是这样的：

诠释苹果 = 1;

if (apple == 1) then 这是可预测且可能的代码。

它也是优化的代码，因为您使编译器和 cpu 变得容易；他们不必预测任何事情，因此不存在代价高昂的错误预测，即分支错误预测。

所以你试着写一个程序，让每一行都是一个自我实现的预言。你有 3 种筹码：Truth、False 和 Unknown。您正在尝试仅使用 Truth 芯片构建程序。

为此：

```
If else: if should be more likely and if there is a return that should be in else.

For and While should be replace by: do while -> except if there is a continue.

That continue should then become an: if do while -> in that order.

If it absolutely necessary to test at beginning use: if do while

If there is less than 5 cases switch to if else from most likely to least likely

Cases should be of relative likelihood, otherwise should be expressed as if else before switch.

Bitwise operators and better logical operators 
```

“简单的整数运算，例如加法、减法、比较、位运算和移位运算（以及增量运算符）在大多数微处理器上只需要一个时钟周期。”</p>

增量运算符：i++优于++I；

布尔操作数：

1.  在 && 语句中最有可能为真
2.  在 || 把最有可能是真的放在第一位。

**因此，要回答您的问题，如果条件为真或可能为真，则 if 语句并不昂贵，否则会陷入分支错误预测。**

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-01-24T17:34:27.197

在许多较旧的处理器上，可以识别“如果”会很昂贵的情况和不会的情况，但是现代高性能处理器包括预测哪些分支将被采用和不会被采用的电路，并且分支仅在以下情况下成本高昂这样的电路猜错了。不幸的是，这通常使得确定编写一段代码的最佳方式变得非常困难，因为处理器完全有可能在处理人为的测试数据时正确预测分支结果，但在处理现实世界时猜测其中的许多结果是错误的数据，反之亦然。

除非有人试图优化其分支时序已被很好理解的特定目标的性能，否则最好的方法通常是假设分支时序不太可能成为整体性能的重要因素，除非或直到可以证明并非如此。分支时序可能会受到输入数据的细微差异的影响，并且通常没有实用的方法来确保测试数据包含可能影响性能的所有变化。

# ruby-on-rails - Windows Server 2008 上的 Rails 或克隆 - 性能最高？

> ID：315325
> 
> 赞同：1
> 
> 时间：2008-11-24T20:24:04.280
> 
> 标签：ruby-on-rails, windows-server-2008

我对学习 Ruby on Rails / Django 类型的 Web 技术非常感兴趣，但目前正在使用 Windows Server 2008（用于 .Net Web 应用程序）。我读过 RoR 在 Windows 上的性能不是很好。

1.  就性能而言，在 Windows Web 服务器上的 RoR 中创建运行 beta Web 应用程序是否不可取？

2.  Django 或其他类似技术会是更好的选择吗？你能成为一个“快乐、高效的程序员”并且仍然使用 Windows Server 吗？

（注意：我实际上确实喜欢经过大量修改的 Asp.Net / C#。我正在尝试一些不同的堆栈，这些堆栈可能从一开始就很有趣且富有成效。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T20:27:43.960

你仍然可以在 Windows 上学习一项技术，即使它在那个平台上的性能还不是很好。

我强烈*反对*在实施您关心的实际项目的同时尝试学习新技术。最好在学习新工具或语言的同时编写一个假装项目。

这样，您就可以尝试与您想要的项目无关的技术功能，并且在您尝试学习时不会因专注于自己的项目需求而分心。

所以继续学习两者，在 Windows 上进行实验。Windows 上的[Rails](http://instantrails.rubyforge.org/wiki/wiki.pl)和[Django](http://bitnami.org/stack/djangostack)都有很好的分步教程和可直接安装的包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T20:31:09.880

如果您只是对学习 MVC 模式（而不是另一种语言）感兴趣，请尝试 MonoRail。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T20:38:17.730

如果您只是在学习和评估框架，我不会太在意平台特定的性能。如果/当你有一个真正的项目成功到足以让性能变得重要时，那么你可以开始考虑进行特定于平台的性能调整，或者只是将应用程序移动到其首选平台上的自己的服务器上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-29T15:38:23.937

试试 ASP.NET MVC。这是一个非常相似的框架。

# php - 限制大型查询的数据库流量的最佳方法？

> ID：315331
> 
> 赞同：0
> 
> 时间：2008-11-24T20:25:24.073
> 
> 标签：php, sql, database

我有一个我正在处理的数据库，每隔几个小时远程更新一次（不是在任何特定的时间跨度上），我无法控制它的管理。我有网络客户端连接到它以查看其中包含的信息。这些客户端（使用 PHP 和 Javascript 编码）可能会经常检查数据库（不耐烦的用户），即使数据库本身可能没有任何更改，并且检查将涉及涉及大量查找和交叉引用等的相当长的查询.

因此，为了减少数据库查询并使事情保持敏捷，限制客户端实际在数据库上运行整个查询的次数的最佳方法是什么？

为了让事情变得清晰，我无法更改数据库，我只能查询它。但我可以完全控制网络客户端的来源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T20:30:36.840

您应该使用某种缓存。对于更严肃的网站，请查看 memcached。如果您的规模较小，请通过序列化结果将结果缓存到文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-26T18:46:26.597

我会看看[Zend_Cache](http://framework.zend.com/manual/en/zend.cache.html)。

每个查询只会在缓存的生命周期内运行一次（可以轻松更改）。会话不是一个可行的解决方案，因为每个用户至少会运行一次相同的查询。会话也可以轻松更新。

您需要检查结果集是否存在于缓存中。如果没有，则使用唯一标识符缓存结果集：

```
$query = "SELECT * FROM really_big_table";
$cache_query = md5($query);
if(!$result = $cache->load($cache_query))
{
     $result = $db->fetchAll($query);
     $cache->save($result, $cache_query);
} 
```

通过使用缓存，您可以设置自己的时间范围，以便为所有用户更新数据。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-11-24T20:30:54.390

您可以控制网络应用程序吗？如果用户已登录并且有与之关联的会话，您可以缓存自用户上次查询数据库以来的时间，如果自上次查询以来请求低于某个阈值间隔，则拒绝交回新数据。

[PHP 会话](http://us.php.net/session "PHP 会话")

# c# - C# LINQ SEO 通用编程问题，如何正确获取某个位置的结果？

> ID：315336
> 
> 赞同：3
> 
> 时间：2008-11-24T20:26:20.360
> 
> 标签：c#, linq, seo

对不起标题:)

这是我的基本问题，我尝试对某个位置实施 SEO 类型查询。

这是我的例子

*   /利兹
*   /利兹_英格兰
*   /汉普郡_英格兰
*   /英格兰_利兹
*   /Europe_England

我正在尝试获取位置，现在我正在拆分“_”，然后通过我的列表对每个部分进行 LINQ 查找。位置有

城市 省份 地区 国家 大陆

如果我找到一个计数更大的变量，我将一个变量设置为“cityFound”并将结果附加到一系列位置。

然后，我再次使用 LINQ 对拆分的这些结果进行检查，以查看我得到了什么，并尝试确定每个拆分部分是否位于同一位置。

现在我觉得我做错了，但我不知道如何“很好地”做到这一点。我想我可以创建一个递归方法，或者我认为它完全错误。

你们将如何解决这个问题？伪代码很好，这是我被难住的逻辑！

干杯，萨基。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:09:46.497

我对无序拆分的担忧是可能会出现重复。请原谅我洋基对欧洲地理的无知，把我比较熟悉的美国地理送给你。

拉斯维加斯是一个很好的起点。人们会想到拉斯维加斯，那个热带沙漠绿洲想从你身上吸钱。当然，人们不会想到新墨西哥州的拉斯维加斯——只是内华达州的拉斯维加斯。亚利桑那州凤凰城和纽约凤凰城也是如此。你达到了技术可行性需要成为等式的一部分的地步。相信我，我和我们的搜索引擎人员也有同样的争论。我感觉到你的痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T02:41:24.983

这就是我将如何做到的。在最坏的情况下它仍然会花费线性时间，但对于常规情况会平滑到恒定时间。

如果您不重用该对象，那么此实现仍然使您能够设置覆盖以处理**Las Vegas**和**Phoenix**。

它将允许您以任何位置属性的顺序进行查询。（请原谅我有任何语法错误 - 我有一段时间没有编写 C#。）

```
class LocationResolver {
    private IEnumerable<Location> locations;
    private Map<String, Location> memory = new Map<String, Location>();

    public LocationResolver(IEnumerable<Location> locs) {
        locations = locs;
        //
        // Add any locations that need disambiguation
        //
        memory["/Las Vegas"] = FromUrl("/Las Vegas_Nevada");
        memory["/Phoenix"] = FromUrl("/Phoenix_Arizona");
    }

    public Location Resolve(string url) {
        Location result;
        if (memory.TryGet(url, out result)) {
            result = FindWithParts(url.Substring(1).Split('_'));
            memory[url] = result;
        }
        return result;
    }

    private Location FindWithParts(string[] parts) {
        string[] locParts = new string[5];
        for (Location l in locations) {
            locParts[0] = l.City;
            locParts[1] = l.Province;
            locParts[2] = l.Region;
            locParts[3] = l.Country;
            locParts[4] = l.Continent;
            bool found = true;
            for (int i = 0; i < parts.Length && found; i++)
                found = Array.IndexOf(locParts, parts[i]) >= 0;
            }
            if (found) {
                return l;
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T09:22:58.310

抱歉忘了关闭它，我所做的是有一些变量。

CityText 省Text等

对于 _ 的每个拆分，我查找是否可以找到该位置，是否可以设置该值。

CityText = 利兹省Text = 西约克郡

然后我浏览了结果并在哪里查找结果。

所有地点 == 利兹

和所有地点 == 西约克郡

和 x 和 x

然后我在底部的位置满足该位置的所有部分。

为代码干杯！

萨基。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T20:56:04.747

除了逻辑，我确实有一个建议。在构建基于位置的 URL 时，我一直发现使用最大的地理位置和最小的地理位置更容易。这是一个合乎逻辑的假设，即每个额外的“改进”都比父级更有针对性。定义一个严格的模式并坚持下去，因为它会更容易维护。我注意到你的例子并不总是遵循你的模式，特别是最后一个在城市之前有大陆的例子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T21:03:23.140

是的，这就是问题所在，我知道我想从他们那里得到什么。但根据我们的“SEO”，最好允许多种类型。（不要让我开始）。

您会说最好先做最大...如果我找到结果，请将其重新插入方法中。可能值得一试。

我只是想确保我已经尝试了每个参数拆分，因为我不知道顺序。

# asp.net - 有什么方法可以以编程方式在 ReportViewer 中的报表上设置自动刷新？

> ID：315339
> 
> 赞同：1
> 
> 时间：2008-11-24T20:27:01.963
> 
> 标签：asp.net, reporting-services

我知道您可以在报表本身的设计中设置自动刷新间隔，但我想做的是允许用户自己在使用 ReportViewer 控件的 Web 应用程序 (ASP.NET) 中设置/更改此间隔。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:06:52.883

如果您通过页面提供报告，则可以使用简单的 HTTP 元标记来刷新页面。[元刷新](http://en.wikipedia.org/wiki/Meta_refresh)

# regex - 实用的非图灵完备语言？

> ID：315340
> 
> 赞同：52
> 
> 时间：2008-11-24T20:27:35.940
> 
> 标签：regex, finite-automata, turing-complete, halting-problem

几乎所有使用的编程语言都是[图灵完备](http://en.wikipedia.org/wiki/Turing_Complete)的，虽然这提供了表示任何[可计算](http://en.wikipedia.org/wiki/Computability_theory_(computer_science))算法的语言，但它也带来了自己的一系列[问题](http://en.wikipedia.org/wiki/Halting_problem)。鉴于我编写的所有算法都打算停止，我希望能够用一种保证它们会停止的语言来表示它们。

[词法分析](http://en.wikipedia.org/wiki/Lexing)时使用用于匹配字符串和[有限状态机的正则](http://en.wikipedia.org/wiki/Finite_state_machine)[表达式](http://en.wikipedia.org/wiki/Regular_Expression)，但我想知道是否有一种更通用、更广泛的语言不是图灵完备的？

**编辑：**我应该澄清一下，通过“通用”我不一定希望能够用该语言编写所有停止算法（我认为这种语言不会存在）但我怀疑有共同的线程停止证明，可以推广以产生一种语言，其中所有算法都保证停止。

还有另一种方法可以解决这个问题——消除理论上无限内存的需要。一旦限制了机器允许的内存量，机器所处的状态数是有限且可数的，因此您可以确定算法是否会停止（通过不允许机器进入之前的状态） ）。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-07-05T03:24:24.687

不要听那些反对者的话。如果您想保证终止或简化代码，例如通过消除运行时错误的可能性，那么在某些情况下，人们可能会更喜欢非图灵完备的语言，这是有充分理由的。有时，仅仅忽略一些事情可能还不够。

[Total Functional Programming](http://www.jucs.org/jucs_10_7/total_functional_programming/jucs_10_07_0751_0768_turner.pdf)一文或多或少有说服力地指出，事实上我们几乎总是应该更喜欢这种受限制的语言，因为编译器的保证要强得多。能够证明程序停止本身就很重要，但实际上这是更简单的语言提供的更容易推理的产物。作为具有不同能力的语言层次结构中的一个组成部分，非通用语言的实用范围非常广泛。

另一个更充分地解决这种分层概念的系统是[Hume](http://www-fp.cs.st-andrews.ac.uk/hume/index.shtml)。休[谟报告](http://www-fp.cs.st-andrews.ac.uk/hume/report/hume-report.pdf)全面描述了该系统及其五层逐渐更完整、逐渐降低安全性的语言。

最后，不要忘记[慈善](http://pll.cpsc.ucalgary.ca/charity1/www/home.html)。它有点抽象，但对于一种有用但非通用的编程语言来说，它也是一种非常有趣的方法，它非常直接地基于类别理论的概念。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-24T20:52:43.300

[BlooP](http://en.wikipedia.org/wiki/BlooP_and_FlooP)（有**界****循环**的缩写）是一种有趣的非图灵完备语言。它本质上是一种图灵完备的语言，有一个（主要）警告：每个循环都*必须*包含迭代次数的界限。不允许无限循环。因此，可以解决 BlooP 程序的停机问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-24T20:44:11.757

问题不在于图灵机，而在于“算法”。您无法预测算法是否会停止的原因是：

```
function confusion()
{
    if( halts( confusion ) )
    {
        while True:
            no-op
    }
    else
        return;
} 
```

任何不能进行递归或循环的语言都不会真正是“通用的”。

正则表达式和有限状态机是一回事！词法分析和字符串匹配是一回事！FSM 停止的原因是它们从不循环；他们只是逐个传递输入并退出。

编辑：

对于许多算法，它们是否会停止是显而易见的。

例如：

```
function nonhalting()
{
    while 1:
        no-op
} 
```

这个功能显然永远不会停止。

而且，这个函数显然会停止：

```
function simple_halting_function()
{
    return 1;
} 
```

所以底线：你可以保证你的算法停止，只需设计它就可以了。

如果您不确定算法是否会一直停止；那么您可能无法用任何保证“停止”的语言来实现它。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-09-10T09:35:06.077

[Charity](http://en.wikipedia.org/wiki/Charity_(programming_language)) is not Turing complete, still, it is not only theoretically, didactically interesting (category theory), but moreover, it can solve practical problems (Hanoi towers). Its strength is so great that it can express even [Ackermann function](http://en.wikipedia.org/wiki/Ackermann_function).

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-24T20:51:57.250

事实证明，图灵完备是相当容易的。例如，你只需要 8 条指令 ala [BrainF**k](http://esolangs.org/wiki/Brainfuck)，更重要的是你真的只需要[一条指令](http://en.wikipedia.org/wiki/One_instruction_set_computer)。

这些语言的核心是一个循环结构，一旦你有无限循环，你就会遇到一个固有的停止问题。循环何时终止？即使在支持无限循环的非图灵完备语言中，您在[实践中仍](http://en.wikipedia.org/wiki/Halting_problem#Common_pitfalls)[可能](http://en.wikipedia.org/wiki/Halting_problem#Common_pitfalls)遇到停止问题。

如果您希望所有程序都终止，那么您只需要仔细编写代码。一种特定的语言可能更符合您的喜好和风格，但我认为没有任何语言可以绝对保证生成的程序会停止。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T22:49:24.533

“消除对理论上无限记忆的需求。” ——嗯，是的。任何物理计算机都受到宇宙熵的限制，甚至在此之前，还受到光速（== 信息传播的最大速率）的限制。

更简单的是，在物理上可实现的计算机中，只需监控资源消耗并对其进行一些限制。（即，当内存或时间消耗> MY_LIMIT 时，终止进程）。

如果您要问的是纯粹的数学/理论解决方案，那么您如何定义“通用”？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-15T10:54:18.030

恕我直言，做到这一点的正确方法是拥有一种图灵完备的语言，但要提供一个系统来说明可由证明检查器处理的语义。

然后，假设您正在特意编写一个终止程序，您心中有一个很好的论据来说明它为什么会停止，并且使用这种新的语言，您应该能够表达这个论点，并证明它。

作为我的生产编译器的一个旁白，我知道我肯定不会在某些输入上停止递归。我使用了一个讨厌的技巧来阻止它：一个具有“合理”限制的计数器。仅供参考，实际代码涉及单态多态代码，并且在使用多态递归时会发生无限扩展。Haskell 捕捉到了这一点，我的 Felix 编译器没有（这是编译器中的一个错误，我碰巧不知道如何修复）。

根据我的一般论点..我肯定想知道哪种注释对所述目的有好处：我碰巧控制了一种语言和编译器，因此只要我知道确切的内容，我就可以轻松添加此类支持添加:)我已经看到为此目的在循环中添加了“不变”和“变体”子句，尽管我不认为该语言扩展到使用该信息来证明终止（而是在如果我没记错的话，运行时间）。

也许这值得另一个问题..

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-11-24T20:39:59.020

任何非图灵完备的语言作为通用语言都不会很有用。您可能能够找到一些自称是通用语言而不是图灵完备的东西，但我从未见过。

# asp.net - 如何同时编辑 ASP.NET ListView 控件中的所有行？

> ID：315349
> 
> 赞同：3
> 
> 时间：2008-11-24T20:29:39.323
> 
> 标签：asp.net, listview

我想知道如何一次将我的所有 ListView 行置于编辑模式。我不是在寻找一次编辑每一行的传统行为。答案可以在 C# 或 VB.NET 中。

此外，如果可能，在所有行都被编辑后保存每行更改的任何示例代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T16:30:42.877

可能最简单的方法是只使用 ListView 的 ItemTemplate，所以本质上，ListView 始终处于“编辑模式”：

```
<asp:ListView 
    ID="lvwDepartments" 
    runat="server" 
    DataKeyNames="department_id" 
    DataSourceID="sqlDepartments" 
    ItemPlaceholderID="plcItem">

    <ItemTemplate>
        <tr>
            <td>
                <%# Eval("department_id") %>
            </td>
            <td>
                <asp:TextBox runat="server" ID="txtDepartmentName" Text='<%# Eval("dname") %>' Columns="30" />
            </td>
        </tr>
    </ItemTemplate>
    <EmptyDataTemplate>
        <p>
            No departments found.
        </p>
    </EmptyDataTemplate>
    <LayoutTemplate>
        <table>
            <thead>
                <tr>
                    <th>Department ID</th>
                    <th>Name</th>
                </tr>
            </thead>
            <tbody>
                <asp:PlaceHolder runat="server" ID="plcItem" />
            </tbody>
        </table>
    </LayoutTemplate>
</asp:ListView>

<asp:SqlDataSource 
    ID="sqlDepartments" 
    runat="server" 
    ConnectionString="<%$ ConnectionStrings:HelpDeskConnectionString %>" 
    SelectCommand="SELECT * FROM [departments]" />

<asp:Button runat="server" ID="cmdSave" Text="Save Changes" OnClick="cmdSave_Click" /> 
```

然后，您可以在用户单击按钮时读取更改的值：

```
protected void cmdSave_Click ( object sender, EventArgs e )
{
    foreach ( ListViewItem item in lvwDepartments.Items )
    {
        if ( item.ItemType == ListViewItemType.DataItem )
        {
            TextBox txtDepartmentName = ( TextBox ) item.FindControl( "txtDepartmentName" );

            // Process changed data here...
        }
    }
} 
```

# hyperlink - 超链接问题

> ID：315357
> 
> 赞同：1
> 
> 时间：2008-11-24T20:30:49.367
> 
> 标签：hyperlink

如何在我的页面上设置一个超链接，以识别来自另一个来源（网页）的登录页面并临时更改我的链接目标？

换句话说：

第一页。有人单击页面 (1) 上的链接，并将他们带到我的页面。在我的页面上有一个链接可以转到另一个页面，特别是注册页面。我希望我的页面能够识别发件人页面并链接并更改我的链接，以便它转到他们想要的目标页面。

如果可以或建议在哪里寻找网站，请提供帮助。抱歉，如果我没有用正确的词来描述我的问题，我还在学习 HTML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T20:36:47.793

如果我正确理解您的问题，您需要`HTTP_REFERER`变量（在 PHP:`$_SERVER['HTTP_REFERER']`中）

这将为您提供用户来自的页面，然后您可以使用它来决定向用户提供什么链接。请注意，它很容易伪造或删除，因此您不能过分依赖它。但是，这是找出用户来自哪个页面（来自另一个站点）的唯一方法。

**编辑**：从问题中不清楚您是否可以控制指向您网站的链接。如果你*这样做*了，那么只需让他们在 URL 的末尾添加一个引用代码，如下所示：`http://www.example.com/page.php?referrer=foo`

然后，您可以使用该变量来识别它们，例如在 PHP 中：

```
if ($_REQUEST['referrer'] == 'foo') { ... } 
```

# c# - C# 语法 - 用逗号将字符串拆分为数组、转换为通用列表和倒序

> ID：315358
> 
> 赞同：99
> 
> 时间：2008-11-24T20:30:50.177
> 
> 标签：c#, generics, syntax, ilist

正确的语法是什么：

```
IList<string> names = "Tom,Scott,Bob".Split(',').ToList<string>().Reverse(); 
```

我在搞砸什么？TSource 是什么意思？

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2008-11-24T20:35:32.510

问题是您正在调用`List<T>.Reverse()`which 返回`void`。

你可以这样做：

```
List<string> names = "Tom,Scott,Bob".Split(',').ToList<string>();
names.Reverse(); 
```

或者：

```
IList<string> names = "Tom,Scott,Bob".Split(',').Reverse().ToList<string>(); 
```

后者更昂贵，因为反转任意`IEnumerable<T>`数据涉及缓冲所有数据，然后全部产生 - 而`List<T>`可以“就地”完成所有反转。（这里的区别在于它调用的是`Enumerable.Reverse<T>()`扩展方法，而不是`List<T>.Reverse()`实例方法。）

更有效的是，您可以使用：

```
string[] namesArray = "Tom,Scott,Bob".Split(',');
List<string> namesList = new List<string>(namesArray.Length);
namesList.AddRange(namesArray);
namesList.Reverse(); 
```

这避免了创建任何大小不合适的缓冲区 - 代价是在一个可以做的地方使用四个语句......与以往一样，在实际用例中权衡可读性与性能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-05T07:31:27.693

我意识到这个问题已经很老了，但是我遇到了类似的问题，除了我的字符串中包含空格。对于那些需要知道如何用不仅仅是逗号来分隔字符串的人：

```
string str = "Tom, Scott, Bob";
  IList<string> names = str.Split(new string[] {","," "},
  StringSplitOptions.RemoveEmptyEntries); 
```

StringSplitOptions 删除仅是空格字符的记录...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T20:37:04.330

```
List<string> names = "Tom,Scott,Bob".Split(',').Reverse().ToList(); 
```

这个有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T20:33:48.567

试试这个：

```
List<string> names = new List<string>("Tom,Scott,Bob".Split(','));
names.Reverse(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T20:37:33.237

您在这里缺少的是 .Reverse() 是一个 void 方法。无法将 .Reverse() 的结果分配给变量。但是，您可以更改顺序以使用 Enumerable.Reverse() 并获得结果

```
var x = "Tom,Scott,Bob".Split(',').Reverse().ToList<string>() 
```

不同之处在于 Enumerable.Reverse() 返回一个 IEnumerable<T> 而不是 void 返回

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-21T14:06:16.613

如果你想

1.  使用多个分隔符
2.  过滤任何空字符串
3.  修剪前导/尾随空格

以下应该工作：

```
string str = "Tom Cruise, Scott, ,Bob | at";
IEnumerable<string> names = str
                            .Split(new char[]{',', '|'})
                            .Where(x=>x!=null && x.Trim().Length > 0)
                            .Select(x=>x.Trim()); 
```

输出

*   汤姆
*   巡航
*   斯科特
*   鲍勃
*   在

现在您显然可以按照其他人的建议颠倒顺序。

# python - Python iMAP 电子邮件访问的正确格式示例？

> ID：315362
> 
> 赞同：10
> 
> 时间：2008-11-24T20:31:14.297
> 
> 标签：python, email, imap

tldr：有人可以告诉我如何正确格式化这个 Python iMAP 示例以使其正常工作吗？

来自 [https://docs.python.org/2.4/lib/imap4-example.html](https://docs.python.org/2.4/lib/imap4-example.html)

> ```
> import getpass, imaplib
> 
> M = imaplib.IMAP4()
> M.login(getpass.getuser(), getpass.getpass())
> M.select()
> typ, data = M.search(None, 'ALL')
> for num in data[0].split():
>     typ, data = M.fetch(num, '(RFC822)')
>     print 'Message %s\n%s\n' % (num, data[0][1])
> M.close()
> M.logout() 
> ```

假设我的电子邮件是“email@gmail.com”，密码是“password”，这应该如何？我试过`M.login(getpass.getuser(email@gmail.com), getpass.getpass(password))` 了，它超时了。在这里完成 newb，所以很可能我错过了一些明显的东西（比如先创建一个 iMAP 对象？不确定）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-25T05:42:27.147

这是我用来从邮箱中获取 logwatch 信息的脚本。[在 2008 年 LFNW 上发表](http://brianlane.com/articles/lfnw2008/)-

```
#!/usr/bin/env python

''' Utility to scan my mailbox for new mesages from Logwatch on systems and then
    grab useful info from the message and output a summary page.

    by Brian C. Lane <bcl@brianlane.com>
'''
import os, sys, imaplib, rfc822, re, StringIO

server  ='mail.brianlane.com'
username='yourusername'
password='yourpassword'

M = imaplib.IMAP4_SSL(server)
M.login(username, password)
M.select()
typ, data = M.search(None, '(UNSEEN SUBJECT "Logwatch")')
for num in data[0].split():
    typ, data = M.fetch(num, '(RFC822)')
#   print 'Message %s\n%s\n' % (num, data[0][1])

    match = re.search(  "^(Users logging in.*?)^\w",
                        data[0][1],
                        re.MULTILINE|re.DOTALL )
    if match:
        file = StringIO.StringIO(data[0][1])
        message = rfc822.Message(file)
        print message['from']
        print match.group(1).strip()
        print '----'

M.close()
M.logout() 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-24T22:18:52.130

```
import imaplib

# you want to connect to a server; specify which server
server= imaplib.IMAP4_SSL('imap.googlemail.com')
# after connecting, tell the server who you are
server.login('email@gmail.com', 'password')
# this will show you a list of available folders
# possibly your Inbox is called INBOX, but check the list of mailboxes
code, mailboxen= server.list()
print mailboxen
# if it's called INBOX, then…
server.select("INBOX") 
```

您的其余代码似乎是正确的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T20:39:52.750

您是否忘记指定 IMAP 主机和端口？使用以下效果：

```
M = imaplib.IMAP4_SSL( 'imap.gmail.com' ) 
```

或者，

```
M = imaplib.IMAP4_SSL()
M.open( 'imap.gmail.com' ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-19T18:01:18.053

而不是`M.login(getpass.getuser(email@gmail.com), getpass.getpass(password))`你需要使用`M.login('email@gmail.com', 'password')`，即纯字符串（或者更好的是，包含它们的变量）。您的尝试实际上根本不应该奏效，因为[`getpass`](https://docs.python.org/2/library/getpass.html)'s`getuser`不带参数，而仅返回用户登录名。甚至不是一个有效的变量名（你`email@gmail.com`没有把它放在引号中）......

# python - 垃圾邮件机器人正在弄乱我的日志文件 [Django]

> ID：315363
> 
> 赞同：4
> 
> 时间：2008-11-24T20:31:20.240
> 
> 标签：python, django, apache, spam-prevention

我有一个漂亮可爱的 Django 站点正在运行，但我注意到我的`error.log`文件在运行几个月后变得很大，超过 150 MB。结果是一堆垃圾邮件机器人正在寻找众所周知的 URL 漏洞（或其他东西）并攻击一堆子目录，如`http://mysite.com/ie`or`http://mysite.com/~admin.php`等​​。

由于 Django 使用 URL 重写，它正在寻找适合这些请求的模板，这会引发`TemplateDoesNotExist`异常，然后是 500 消息（Django 这样做，而不是我）。我关闭了调试，所以他们只收到通用的 500 消息，但它很快就填满了我的日志。

有没有办法关闭这种行为？或者也许只是阻止IP这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T20:44:05.517

嗯，也许，使用[logrotate](http://linuxcommand.org/man_pages/logrotate8.html)定期旋转和压缩日志，如果它还没有完成的话。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T21:39:47.030

如果您可以在 UserAgent 字符串中找到模式，则可以使用`DISALLOWED_USER_AGENT`设置。我的是：

```
DISALLOWED_USER_AGENTS = (
    re.compile(r'Java'),
    re.compile(r'gigamega'),
    re.compile(r'litefinder'),
) 
```

[请参阅Django 文档](http://docs.djangoproject.com/en/dev/ref/settings/#disallowed-user-agents)中的描述。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T21:06:03.413

“有没有办法关闭这种行为？” - 500 是绝对强制性的。日志条目也是强制性的。

“或者也许只是阻止 IP 这样做？” - 我们不希望。

每个人都有这个问题。几乎每个人都使用 Apache[日志轮换](http://httpd.apache.org/docs/1.3/logs.html#rotation)。其他人要么使用操作系统轮换，要么自己滚动。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T16:17:47.223

如果 URL 与 URLConf 中的任何条目都不匹配，Django 应该抛出 404，而不是 500。

[http://docs.djangoproject.com/en/dev/topics/http/urls/#handler404](http://docs.djangoproject.com/en/dev/topics/http/urls/#handler404)

您需要提供 404 模板：

> 如果您没有定义自己的 404 视图——而只是使用推荐的默认视图——您仍然有一项义务：在模板目录的根目录中创建 404.html 模板。默认的 404 视图将使用该模板来处理所有 404 错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T20:41:43.870

编程解决方案是：

*   打开日志文件
*   读取缓冲区中的行
*   替换与机器人引起的错误匹配的行
*   寻找到文件的开头
*   写入新缓冲区
*   将文件截断到当前指针位置
*   关闭

瞧！完成 ！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T21:46:38.387

如何将一个包罗万象的模式设置为您的 urls 文件中的最后一项并将其定向到通用的“没有此类页面”甚至您的主页？换句话说，将 500 个请求转化为对您主页的请求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T01:26:56.977

为什么不修复那些“错误”？如果 url 模式不匹配，则应显示正确的错误消息。通过添加这些模板，您将[帮助用户](http://www.codinghorror.com/blog/archives/000819.html)和您自己:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T16:52:54.440

1.  是的，它应该是 404，而不是 500。500 表示正在尝试处理 URL 并且在此过程中失败。你需要找到并修复它。

2.  我们也有类似的问题。由于我们正在运行 Apache/mod_python，我选择在 .htaccess 中使用 mod_rewrite 规则来处理它。我会定期查看日志并将一些模式添加到我的“下地狱”列表中。这些都重写以提供 1x1 像素的 gif 文件。没有 404 的海啸会扰乱我的日志分析，它给 Django 和 Apache 带来最小的负载。

You can't make these a**holes go away, so all you can do is minimize their impact on your system and get on with your life.

# c++ - C++ 性能提示和经验法则有人吗？

> ID：315378
> 
> 赞同：7
> 
> 时间：2008-11-24T20:37:18.607
> 
> 标签：c++, performance, cross-platform

编码时，在性能方面要记住什么好的经验法则？有无数种方法可以针对特定平台和编译器进行优化，但我正在寻找同样适用于（或几乎）跨编译器和平台的答案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T20:43:37.237

想起一句名言：

“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。” （Knuth, Donald。带 go to Statements 的结构化编程，ACM Journal Computing Surveys，第 6 卷，第 4 期，1974 年 12 月。第 268 页。）

但是也许您无论如何都不应该按值传递大型数据结构... :-)

编辑：也许还可以避免*O* (N^2) 或更复杂的算法...

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-24T20:40:28.473

排名第一的性能提示是尽早且经常地分析您的代码。有很多通用的“不要这样做”提示，但很难保证这会影响应用程序的性能。为什么？每个应用程序都是不同的。如果你有很多元素，很容易说按值传递向量是不好的，但你的程序甚至使用向量（你可能应该但是......）？

分析是了解应用程序性能的唯一方法。我遇到过太多的情况，人们“优化”了代码，但从来没有分析过。事实证明，“优化”引入了许多错误，甚至不是代码路径中的热点。浪费大家的时间。

编辑：

有几个人评论了我回答的“早期”部分。我认为您不应该从第一天开始进行分析。但是您也不应该等到发货后的 1 个月。

一旦我有几个明确的端到端场景，或者在一个更大的项目中，一个主要是功能组件，我通常会首先进行概要分析。我需要一两天（通常与 QA 一起工作）来收集一些大型场景并将其扔到代码中。这是一个很好的抽查，可以及早发现明显的性能问题。此时修复它们要容易一些。

在一个典型的项目中，我发现我的代码在整个项目过程中 30%-40% 都符合这个标准（100% 在客户手中）。这次我松散地归类为早。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-24T20:47:29.973

*   尽可能使用`if`或`switch`代替通过函数指针调用。澄清：`void doit(int m) { switch(m) { case 1: f1(); break; case 2: f2(); break; } }`而不是`void doit(void(*m)()) { m(); }`可以内联调用。
*   在可能且不造成伤害的情况下，首选 CRTP 而不是虚拟功能
*   如果可能，请避免使用 C 字符串并使用 String 类。它通常会更快。（恒定时间长度“测量”，附加摊销的恒定时间，...）
*   *始终*通过引用 const (T const&) 而不是复制值来传递用户定义的类型值（除了没有意义的地方。例如迭代器）。
*   对于用户定义的类型，总是首选`++t`而不是`t++`
*   `const`尽早使用，经常使用。最重要的是提高可读性。
*   尽量保持`new`在最低限度。如果可能，总是更喜欢自动变量（在堆栈上）
*   与其自己填充数组，不如使用空的初始化列表进行初始化，就像`T t[N] = { };`你想要零一样。
*   尽可能多地使用构造函数初始化器列表，尤其是在初始化用户定义的类型成员时。
*   利用函子（`operator()`重载的类型）。它们内联比通过函数指针调用更好。
*   `std::vector`如果您的`std::string`数量固定不变，请不要使用此类。使用`boost::array<T, Size>`或裸数组并正确使用它。

事实上，我差点忘记了：

**过早的优化是万恶之源**

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-24T21:01:18.510

有人提到了函数指针（以及为什么你应该使用`if`）。好吧，甚至更好：改用仿函数，它们被内联并且通常具有*零开销*。仿函数是一种结构（或类，但通常是前者），它重载了运算符`()`和实例，可以像普通函数一样使用：

```
template <typename T>
struct add {
    operator T ()(T const& a, T const& b) const { return a + b; }
};

int result = add<int>()(1, 2); 
```

这些几乎可以在可以使用普通函数或函数指针的所有上下文中使用。它们通常来自`std::unary_function`or `std::binary_function`，但这通常不是必需的（实际上只是为了继承一些有用`typedef`的 s）。

**编辑**在上面的代码中，显式`<int>`类型限定是必需的。类型推断仅适用于函数调用，不适用于实例创建。但是，通常可以通过使用`make`辅助函数来省略它。这是在 STL 中为`pair`s 完成的：

```
template <typename T1, typename T2>
pair<T1, T2> make_pair(T1 const& first, T2 const& second) {
    return pair<T1, T2>(first, second);
}

// Implied types:
pair<int, float> pif = make_pair(1, 1.0f); 
```

有人在评论中提到，仿函数有时被称为“functionoids”。是*的*，但不完全是。事实上，“函子”是“函数对象”的（有点奇怪）缩写。functionoid 在概念上是相似的，但通过使用虚函数来实现（尽管它们有时被同义使用）。例如，functionoid 可能如下所示（连同其必要的接口定义）：

```
template <typename T, typename R>
struct UnaryFunctionoid {
    virtual R invoke(T const& value) const = 0;
};

struct IsEvenFunction : UnaryFunctionoid<int, bool> {
    bool invoke(int const& value) const { return value % 2 == 0; }
};

// call it, somewhat clumsily:
UnaryFunctionoid const& f = IsEvenFunction();
f.invoke(4); // true 
```

当然，这会失去仿函数由于其虚函数调用而具有的任何性能优势。因此，它用于实际需要多态（有状态）运行时函数的不同上下文中。

C++ FAQ 有[更多](http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.10)关于这个主题的内容。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-24T20:45:47.183

在需要之前不要费心优化。要了解是否需要，请配置文件。不要猜测；有证据。

此外，算法优化通常比微观优化具有更大的影响。使用 A-star 而不是蛮力寻路会更快，就像 Bresenham 圆比使用 sin/cos 更好一样。当然，这些也有例外，但它们非常（非常）罕见（<0.1%）。如果你有一个好的设计，改变算法只会改变你代码中的一个模块。简单的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-24T20:50:03.383

使用已经使用和重复使用的现有的、经过审查的代码。（例如：STL、提升与滚动您自己的容器和算法）

由于评论而更新：正确使用已使用和重复使用的现有、已审核的代码。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-24T20:47:13.780

就性能而言，您能做的最好的事情就是从可靠的架构和线程模型开始。其他一切都将建立在此之上，因此，如果您的基础很糟糕，那么您的成品也只会那么好。分析会晚一点，甚至比微优化更晚（一般来说，这些都是微不足道的，并且比任何东西都更复杂代码。）

这个故事的寓意是：从一个有效的基础开始，建立在不做完全愚蠢和缓慢的事情的认识之上，你应该会没事的。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-24T21:24:07.420

还有一点：**最快的代码是不存在的代码。**这意味着您的项目需要越健壮和功能齐全，它就会越慢。底线：尽可能跳过绒毛，同时确保您仍然满足要求。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-24T21:14:21.400

C++ 的两个最佳技巧：

购买由 Scott Meyers 撰写的 Effective C++。

然后购买 Scott Meyers 的《更有效的 C++》。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-24T20:45:56.873

尽可能保持代码干净。如今的编译器非常棒。然后，如果您确实有性能问题，请配置文件。

所有这一切都是在为您的问题选择了可用的最佳算法之后。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-24T20:55:45.247

[Wikibooks 有一些东西。](http://en.wikibooks.org/wiki/Optimizing_C%2B%2B/Writing_efficient_code)

一件好事是知道你正在使用的东西的效率。乘法的加法速度有多快，向量与普通数组的比较速度或某些算法与更高尺度的比较速度有多快。这使您可以为任务选择最有效的工具

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-24T20:58:46.347

使用通用算法是一个很好的优化技巧——不是在运行时间方面，而是在编码时间方面。知道您可以排序（开始，结束）并期望范围 - 无论是指向数据库的两个指针或迭代器 - 都会被排序（而且，使用的算法也将是运行时高效的）。泛型编程是 C++ 独特而强大的原因，您应该始终牢记这一点。您不必编写许多算法，因为版本已经存在（并且可能与您编写的任何算法一样快或更快）。如果您有其他考虑，那么您可以专门研究算法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-24T20:45:48.883

一个简单的建议是养成做 ++i 而不是 i++ 的习惯。i++ 制作一个副本，这可能很昂贵。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-24T20:47:21.737

这里有几个：

*   有效利用[内联](http://www.arm.com/support/faqdev/1220.html)（取决于您的平台）。

*   尽可能避免使用[临时工（并知道它们是什么）](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=198)

    x = y + z;

    如果写成这样会更好地优化：

    x=y;

    x+=z;

此外，避免使用[虚函数](http://www.codersource.net/published/view/325/virtual_functions_in.aspx)，只在需要使用它们时创建对象。

如果您有心情，请查看[Efficient C++](https://rads.stackoverflow.com/amzn/click/com/0201379503)。我上学的时候家里有一本。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-24T21:03:33.310

考虑使用[内存池](http://www.boost.org/doc/libs/1_37_0/libs/pool/doc/index.html)。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-24T21:56:00.850

1.  始终尝试考虑您的内存的外观 - 例如，数组是大小为 numOfObjects X 的连续内存行`sizeof(object)`。一个二维数组是 n X m X`sizeof(object)`并且每个对象都在 n + m X n 的索引中，所以

    ```
    for(int i = 0 ; i < n ; i++){
        for(int j = 0 ; j < m ; j++){
            arr[i,j] = f(); 
    ```

    比（在单个进程上）要好得多：

    ```
    for(int i = 0 ; i < n ; i++){
        for(int j = 0 ; j < m ; j++){
            arr[j,i] = f(); 
    ```

    因为数组是以连续块的形式进入缓存的，所以第一个片段在缓存中的所有单元格上运行，然后再获取其余部分，而第二个片段需要一遍又一遍地将新的数组单元格提取到单元格中

2.  当您的应用程序开始变慢时，使用性能基准来找到确切的瓶颈，甚至`GetTickCount`可以使用简单的调用来确定组件运行所需的时间。在较大的项目上，在开始优化之前使用适当的分析器，这样您就可以在重要的地方花费最多的优化工作。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-24T22:50:21.427

不要使用效率极低的算法，在编译器中打开优化，不要优化任何东西，除非分析器显示它是一个瓶颈，当你尝试改进事情时，测试看看你做得好还是坏。还要记住，库函数通常是由比你更擅长的人优化的。

与这些相比，几乎所有其他事情都是次要的。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-25T03:39:02.623

基本上，您最大的性能提升将来自算法改进。这意味着使用最高效的算法，进而使用最高效的数据项容器。

有时很难知道最好的权衡是什么，但幸运的是，STL 的设计者正是考虑到了这个用例，因此 STL 容器通常足够灵活，可以根据需要混合和匹配容器的应用程序。

但是，要充分实现好处，您需要确保不会将内部设计选择作为类/模块/其他接口的一部分公开。您的任何客户都不应*依赖*于您对`std::vector`. 至少提供他们（和您）可以使用的 typedef，这应该允许根据您的需要将向量更改为列表（或其他）。

同样，请确保您拥有尽可能多的已调试算法和容器供您使用。如今，Boost 和/或 TR1 几乎是必需品。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-23T10:38:50.140

来自我参考的一本 C++ 书籍（Bulka 和 Mayhew 的 Efficient C++ performance Techniques），其中明确谈到了 C++ 性能方面。其中之一是；

在定义构造函数时..也初始化其他构造函数；就像是;

```
class x {

x::x(char *str):m_x(str) {} // and not as x::x(char *str) { m_str(str); }

private:
std::string m_x;

}; 
```

以上是一些引起我注意并帮助我改进编码风格的事情......这本书有更多关于这个有趣的性能主题的分享。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-01-15T23:50:50.623

## 粗略设计

在对性能至关重要的领域中，将您的类和数据结构设计保持在较粗略的方面，而不是细粒度的方面。通过性能关键，我的意思是要么这样测量，要么你可以肯定地预期大量输入被重复处理（例如：每一帧）。这样做的目的是在未来为任何必要的优化留出足够的喘息空间。否则，我们可能会看到需要对代码库的中心区域进行大量重新设计/重写的瓶颈，这需要对所有依赖项进行级联重写。

让我们来看几个我从其他遇到热点的人那里遇到的粒度设计示例。

**一大堆弦乐**

```
// Stores millions of strings.
std::vector<std::string> boatload_of_strings; 
```

这是一个细粒度的设计，因为我们通过数百万个实例存储了一个成熟的字符串容器/类。数百万存储的每一个很小的字符串都使用一个成熟的、可变大小的内存管理`std::string`容器来表示。这最终会导致内存使用爆炸，需要比必要更多的内存，或者使用比必要更多的堆分配，或者两者兼而有之。通过最近的小字符串优化，最小值`sizeof(std::string)`可以达到 24 字节，如果我们的大多数字符串只有几个字符长，这将是相当爆炸性的内存使用。如果字符串是中等长度的，你仍然可以为每个字符串分配一个单独的堆。无论哪种方式，它都会转化为大量缓存未命中。相反，如果您像这样使设计更粗糙：

```
class BoatloadOfStrings
{
public:
     // Returns the nth string.
     const char* operator[](int n) const
     {
         return buffer.data() + string_start[n];
     }

     // Inserts a string.
     void insert(const char* str)
     {
         string_start.push_back(buffer.size());
         buffer.insert(buffer.end(), str, str + strlen(str)+1);
     }

private:
     // Stores all the characters of all null-terminated
     // strings in one giant buffer.
     std::vector<char> buffer;

     // Stores the starting position of each null-terminated
     // string.
     std::vector<size_t> string_start;
}; 
```

...现在我们最终使用更少的内存，并且仅在这两个向量之一超过容量（摊销成本）时才面临堆分配。即使我们从使用`std::vector`存储数百万个实例的上述解决方案开始`std::string`，使用这种更粗略的`BoatloadOfStrings`类设计也比我们对前一种表示具有大量依赖项的情况有更多的优化空间。

**大量抽象像素**

```
class IPixel
{
public:
     virtual ~IPixel() {}

     // Abstract pixel operations.
     ...
}; 
```

在这里，如果我们正在设计一个图像/视频处理应用程序，它必须重复循环遍历像素以执行自定义视频过滤器等操作，那么上述设计非常浪费，但也给我们没有喘息的空间来进一步优化它如果整个系统都依赖于这样的接口。

通常情况下，动态调度和虚拟指针之类的成本是几美分，但如果每帧多次支付数百万次，那么便士就会变得昂贵。为每个像素支付虚拟调度的成本确实变得相对非常昂贵，而且虚拟指针的大小，尽管在 64 位系统上只有 8 个字节，却使32 位系统的内存使用量增加了*四倍*。位 RGBA 图像，当我们考虑其大小时，考虑到其 64 位对齐要求（64 位 vptr + 32 位像素数据 + 32 位对齐 vptr 的填充），它将添加到结构中的填充。

在这种情况下，我推荐的解决方案相同。在更粗略的水平上进行设计。如果你需要多态，看看你是否可以在更粗略的图像级别进行抽象：

```
class IImage
{
public:
     virtual ~IImage() {}

     // Abstract image operations.
     ...
}; 
```

突然之间，虚拟指针和虚拟调度的成本变得非常便宜，因为它们只需为整个图像支付一次，整个图像很可能包含数百万像素作为像素容器。现在您有空间做一些事情，例如在中央级别将 SIMD 内在函数应用于并行循环中的图像操作，而无需重写大部分代码库。

**一大堆生物**

```
class Creature
{
public:
     virtual ~Creature() {}

     // Abstract creature operations.
     ...
};

class Human: public Creature
{
     ...
};

class Orc: public Creature
{
     ...
};

class Undead: public Creature
{
     ...
}; 
```

假设我们有一个实时战争模拟，其中包括在单个游戏会话中具有大量单位的一大堆抽象生物，指环王风格。这些生物可以在任何给定时刻被移除，因为它们可能会死亡，例如，我们每帧应用的大多数关键循环实际上是顺序循环，它们只是做一些事情，比如沿着给定路径移动所有生物。

在这种情况下，上述表示可能会成为瓶颈，几乎没有进一步优化的空间，因为代码使用指向 的多态基指针`Creature*`，迫使我们一次处理一个生物。最重要的是，每个生物可能有不同的大小和对齐要求，这意味着它们通常不能连续存储在内存中（例如：我们可能无法将兽人的数据与人类的数据交错存储在内存中，即使我们想要处理一个兽人，然后是一个人类）。

在这些情况下，您可以通过为每个生物子类型使用单独的分配器来稍微提高性能，例如每个生物子类型的单独空闲列表，它将特定类型的生物分配到连续的块中，以及对多态基础进行基数排序用于改进引用局部性的地址指针（例如，相同类型的相邻生物的空间局部性和 vtable 上的时间局部性）。但是，在有限的空间内进行优化需要付出很多努力。同时，如果您只使用这样的粗略设计：

```
class CreatureHorde
{
public:
     virtual ~CreatureHorde() {}

     // Abstract creature horde operations.
     ...
};

class HumanHorde: public CreatureHorde
{
     ...
};

class OrcHorde: public CreatureHorde
{
     ...
};

class UndeadHorde: public CreatureHorde
{
     ...
}; 
```

...现在我们在整个生物群的水平上进行设计，就像我们将抽象像素界面变成抽象图像界面一样。现在我们有各种空间可以轻松优化，因为我们的多态基指针 ( `CreatureHorde*`) 将指向要处理的整个*生物*群，而不是一次处理一个生物。在每个部落中，我们可能对缓存友好的顺序处理，例如，在一个连续的向量/数组中顺序存储和处理的一群人类中的人类单位的所有数据。

**结论**

所以无论如何，这是我的第一条建议，它与设计有关，而不是与实施有关。当您预计系统中有较大的、对性能至关重要的循环区域时，请在较粗略的级别进行设计。使用更粗略的数据结构、更粗略的类接口和更粗略的抽象。不要将一大堆小东西单独表示为单独的类和独立的数据结构，或者至少不要将其表示为更粗略设计的私有实现细节。

在您获得足够粗略的设计以给您优化的*喘息空间*之后，您可能会考虑让自己获得一些不错的分析工具，提高您对内存层次结构的理解，并行化您的代码（使用更粗略的设计也变得更容易），矢量化它（粗糙的设计也变得更容易）等。

但是，当我们预先考虑效率时，对我来说最重要的是设计效率，因为缺乏这一点，即使我们分析并准确地发现我们的热点，我们也无法在事后有效地优化我们的实现。设计效率通常归结为有足够的喘息空间来优化设计，而这实际上归结为更粗略的设计，不尝试对最小的对象和数据结构进行建模。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-24T20:42:55.130

“过早的优化是万恶之源”（Knuth，Donald）

这实际上取决于您编写的代码类型及其典型用法。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-25T07:12:23.207

无论您采取什么措施来节省几个周期，请记住这一点：不要试图比编译器更聪明 - 测量以验证增益。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-11-25T08:19:48.763

虽然没有解决确切的问题，但一些建议是：

总是为接口编码（当涉及到算法时），这样你就可以用高效的接口（通过任何 req 方式）平滑地替换它们。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-12-18T17:28:54.373

我同意关于过早优化的建议。但是，我喜欢在设计过程中遵循一些准则，因为它们以后可能难以优化：

*   尝试在启动时分配所有对象，`new`在运行时尽量减少使用。
*   设计你的数据结构，使你的算法在 O(1) 时有很好的机会。
*   像往常一样，模块化，以便您以后可以拆掉和更换。这意味着您拥有一套全面的单元测试，可以让您确信您的新解决方案是正确的。
*   将性能测试添加到您的单元测试套件中，以确保您不会无意中得到一些 O(n*n) 代码:-)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-18T17:34:33.363

*   规则 1：不要
*   规则 2：测量

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-06-17T07:25:38.740

选择性能最好的算法，使用更少的内存，使用更少的分支，使用快速操作，使用少量的迭代。

# python - 如何使用 Python 在文件夹中搜索与正则表达式匹配的文件名？

> ID：315381
> 
> 赞同：3
> 
> 时间：2008-11-24T20:38:45.560
> 
> 标签：python, regex

我在编写一个函数时遇到了一些困难，该函数将在目录中搜索与特定正则表达式匹配的文件（我使用're.compile'编译）。所以我的问题是：如何在目录（我打算使用 os.walk）中搜索与特定正则表达式匹配的文件？一个例子将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T20:51:04.740

这将找到所有以两位数开头并以 gif 结尾的文件，如果您愿意，可以将文件添加到全局列表中：

```
import re
import os
r = re.compile(r'\d{2}.+gif$')
for root, dirs, files in os.walk('/home/vinko'):
  l = [os.path.join(root,x) for x in files if r.match(x)]
  if l: print l #Or append to a global list, whatever 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T20:44:50.227

1.  阅读[RE](http://www.python.org/doc/2.5.2/lib/module-re.html)模式的`match`方法。

2.  阅读有关[如何将具有特定文件扩展名的文件复制到我的 python（2.5 版）脚本中的文件夹的](https://stackoverflow.com/questions/296173/how-do-i-copy-files-with-specific-file-extension-to-a-folder-in-my-python-versi)所有答案？

3.  选择一个使用`fnmatch`. 替换`fnmatch`为`re.match`。这需要仔细考虑。这不是剪切和粘贴。

4.  然后，提出具体问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T20:59:28.343

如果您必须匹配的模式足够简单，可以使用文件系统通配符来抓取，我建议您查看 glob 模块，该模块正是为此目的而存在的。

# c++ - 我无法将 KAction 连接到 KMainWindow 上的插槽

> ID：315393
> 
> 赞同：0
> 
> 时间：2008-11-24T20:41:38.910
> 
> 标签：c++, qt, connect, kde

我有一个 KMainWindow：

```
//file.h
class MainWindow: public KMainWindow {
public:
    MainWindow(QWidget *parent = 0);
...
...
...

private slots:
    void removeClick();

//file.cpp
MainWindow::MainWindow(QWidget *parent) :
KMainWindow(parent) {}

void MainWindow::removeClick() 
    {
    std::cout << "Remove" << std::endl;
    } 
```

我可以正确编译它，但是当我执行时我得到了消息

```
Object::connect: No such slot KMainWindow::removeClick() 
```

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T14:00:15.880

您忘记了 Q_OBJECT 宏。

```
class MainWindow: public KMainWindow 
{
    Q_OBJECT

public:
    // [snip]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T12:51:06.300

使用 KXmlGuiWindow 而不是 KMainWindow 和 Q_OBJECT 宏解决

# model - Verilog中用于硬件实现的高效C代码

> ID：315398
> 
> 赞同：0
> 
> 时间：2008-11-24T20:43:26.907
> 
> 标签：model, hardware

我有一个用于图像编解码器的纯 C 代码。我的目标是开发一个高效的 C 模型，该模型将使用 Verilog 或一些此类硬件描述语言在硬件中采用和实现。我想知道的是：

1.) 需要对现有 C 代码结构进行哪些修改以使其硬件高效

2.)是否需要修改数据结构。是否有任何与数组/缓冲区相关的约束（就像它们应该用存储类寄存器声明一样。

3.）我听说硬件模型不应该有条件或尽可能少。那是关于什么的？

（考虑使用一些 FPGA 的通用硬件实现，Verilog 没有关于总线、时钟等的详细信息。）

-广告

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T09:25:19.333

1.  这取决于您希望算法的硬件实现如何串行或并行。

在 always 块中，“<=”（非阻塞）和“=”阻塞分配之间存在差异。阻塞分配就像您在软件中所拥有的一样，所有内容都是逐行评估的，这往往会综合为性能较低的优先级编码顺序逻辑。使用非阻塞语句，always 块中的所有赋值都会被同时评估，这往往会产生更多的并行结构。在将软件移植到硬件时，这可能是您最需要关注的部分。

2.  在 RTL 友好的 Verilog 中，您可以使用组合逻辑（逻辑方程的连续分配）和内存分配（寄存器和锁存器）来保持一段时间内的状态。您编码为 RTL 的数据结构可能会在逻辑综合期间推断出寄存器和锁存器。在 Verilog 中正确编码时，您的数据结构可能会工作，但在微处理器上执行有意义的方法可能不是在硬件中构建它的最佳方式。再次取决于。

3.  “if”可用于组合逻辑和内存逻辑（保持状态）“if”在编写为三元运算符时（Verilog 与 C 具有相同的语法）综合到多路复用器（mux）。“if”也可用于寄存器的逻辑描述中，以查看在始终阻止事件列表触发后复位引脚是否被置位（这只是一个示例）。小心“If”：当打算使用 always 块创建组合逻辑时（事件列表没有 posedge clk 或 negedge clk、posedge 复位、negedge 复位等），并将组合逻辑变量赋值为一个“if”语句，然后忘记“else”语句，在综合期间将推断出一个锁存器。“if”没有匹配的“else”语句

“reg”类型用于描述组合逻辑和内存逻辑；合成什么逻辑取决于总是阻塞事件列表和完整案例的存在。C 代码通常转换为 always 块中使用的样式。

“wire”类型用于连续分配（组合逻辑）。

[ImpulseC](http://www.impulsec.com/)是一个看起来很有趣的软件到硬件编译器。 [HDL Coder](http://www.mathworks.com/products/slhdlcoder/)是[MATLAB](http://en.wikipedia.org/wiki/MATLAB) / [Simulink](http://en.wikipedia.org/wiki/Simulink)的配套产品，可自动生成您的硬件描述。

即使您使用这些软件工具为您创建硬件描述，您仍然想了解它们生成的内容。

# c# - server.Databases[databaseName].Drop(); 在 MSTest 中失败

> ID：315402
> 
> 赞同：3
> 
> 时间：2008-11-24T20:44:18.623
> 
> 标签：c#, .net, sql-server-2005, smo

抛出以下异常：

错误消息：Microsoft.SqlServer.Management.Smo.FailedOperationException：数据库“4d982a46-58cb-4ddb-8999-28bd5bb900c7”删除失败。---> Microsoft.SqlServer.Management.Common.ExecutionFailureException：执行 Transact-SQL 语句或批处理时发生异常。---> System.Data.SqlClient.SqlException：无法删除数据库“4d982a46-58cb-4ddb-8999-28bd5bb900c7”，因为它当前正在使用中。

知道是什么原因造成的吗？

是否可以调用 SMO 函数来完成任何正在运行的 Transact-SQL 语句？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-26T01:48:28.897

使用[Server.KillDatabase(string database)](http://technet.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.server.killdatabase.aspx)方法为您关闭所有打开的连接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T20:47:50.283

作为一种猜测，我想知道您的连接池是否对您不利 - 即您之前已经在 a 上执行了一些命令`SqlConnection`，现在被保留以供重复使用。您可以尝试禁用池？（连接字符串中的 pooling=false，IIRC）。

另外-您是否小心关闭了所有命令/连接/阅读器等？理想情况下通过`using`? 作为最后的手段，你可以尝试使用 T-SQL 来杀死你机器上的所有其他 spid - hacky，但它可能会起作用。

# asp.net - 从 asp.net 获取经过身份验证的 AD 用户 objectGuid

> ID：315403
> 
> 赞同：7
> 
> 时间：2008-11-24T20:44:38.747
> 
> 标签：asp.net, active-directory, windows-authentication

我在 ASP.NET 应用程序中使用 Windows 身份验证。我想知道如何最好地从当前登录的用户那里获取 objectGuid？

问候，埃吉尔。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-04-07T00:14:19.643

建议的解决方案相当昂贵。与其通过域和用户名进行搜索，更好的解决方案是使用 SID 来查找帐户：

```
// using System.Security.Principal;
IPrincipal userPrincipal = HttpContext.Current.User;
WindowsIdentity windowsId = userPrincipal.Identity as WindowsIdentity;
if (windowsId != null)
{
    SecurityIdentifier sid = windowsId.User;

    using(DirectoryEntry userDe = new DirectoryEntry("LDAP://<SID=" + sid.Value + ">"))
    {
        Guid objectGuid = new Guid(userDe.NativeGuid);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T08:47:38.227

您可以使用 System.DirectoryServices 命名空间来执行此操作。

```
Dim entry As DirectoryServices.DirectoryEntry
Dim mySearcher As System.DirectoryServices.DirectorySearcher
Dim result As System.DirectoryServices.SearchResult
Dim myEntry As DirectoryEntry
Dim domainName As String
Dim userId As String
Dim objectGuid As Guid

'Split the username into domain and userid parts
domainName = Page.User.Identity.Name.Substring(0, Page.User.Identity.Name.IndexOf("\"))
userId = Page.User.Identity.Name.Substring(Page.User.Identity.Name.IndexOf("\") + 1)

'Start at the top level domain
entry = New DirectoryEntry(domainName)

mySearcher = New DirectorySearcher(entry)

'Build a filter for just the user
mySearcher.Filter = ("(&(anr=" & userId & ")(objectClass=user))")

'Get the search result ...
result = mySearcher.FindOne

'... and then get the AD entry that goes with it
myEntry = result.GetDirectoryEntry

'The Guid property is the objectGuid
objectGuid = myEntry.Guid 
```

可能有更好的方法来做到这一点，但这有效！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-06T05:54:11.640

您需要使用[NativeGuid](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.nativeguid.aspx)属性。C#代码：

```
string login = HttpContext.Current.User.Identity.Name;
string domain = login.Substring(0, login.IndexOf('\\'));
string userName = login.Substring(login.IndexOf('\\') + 1);
DirectoryEntry domainEntry = new DirectoryEntry("LDAP://" + domain);
DirectorySearcher searcher = new DirectorySearcher(domainEntry);
searcher.Filter = string.Format(
   "(&(objectCategory=person)(objectClass=user)(sAMAccountName={0}))",
   userName);
SearchResult searchResult = searcher.FindOne();
DirectoryEntry entry = searchResult.GetDirectoryEntry();
Guid objectGuid = new Guid(entry.NativeGuid); 
```

# javascript - 是否建议在 Javascript 中使用数以万计的索引使用数组？

> ID：315410
> 
> 赞同：5
> 
> 时间：2008-11-24T20:45:59.790
> 
> 标签：javascript, performance, arrays

是否建议在 Javascript 中使用数以万计的索引使用数组？

我有一个包含静态数据表的数据库，这意味着它永远不会改变。在这种情况下，是否建议将此表转换为 javascript 数组并在需要时在其中查找信息？这是不好的做法吗？

有问题的表包含大约 40,000 个键/值对条目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T20:48:36.787

不。

我会保留这张桌子，因为它是一个单一的维护点。

您会发现执行 XmlHTTPRequest 以基于服务器端查询返回键/值对，实际上执行速度更快，并且内存占用比巨大的 JavaScript 数组少得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T20:49:32.370

以我的经验，在浏览器中缓存客户端的数组中移动超过几千行会导致地狱般的体验。臃肿的浏览器内存占用、缓慢的加载时间和普遍的迟缓是当时的情况。您应该自己测试这个场景以获得体验。花费你几分钟的时间是值得的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T20:49:39.407

要考虑的主要因素是最终用户性能。假设它在您的机器上运行良好并不意味着它在旧机器上运行良好。关于您的方法的客户端方面，风险最大的部分是它在很大程度上取决于客户拥有什么。就个人而言，我会避免向客户提供这么多数据，但我对您项目的背景了解不足，无法确定您可能需要这样做的原因。

从服务器检索缓存数据的某种 AJAX 方法可能更合适。

# vba - 从 PowerPoint 导出为动画 gif？

> ID：315419
> 
> 赞同：13
> 
> 时间：2008-11-24T20:48:42.310
> 
> 标签：vba, animation, powerpoint, gif

是否可以将带有自定义动画的图片从 PowerPoint 导出为动画 gif？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-11-04T22:59:23.730

Powerpoint 2010可以直接保存为windows视频格式。

从那里转换为gif。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T01:43:42.263

有许多服务和软件可以将 PowerPoint 演示文稿转换为各种类型的视频。 [AuthorStream](http://www.authorstream.com/)是一个将 PPT 转换为 MPEG4 的网站。[这里](http://www.mydigitallife.info/2007/10/09/how-to-convert-powerpoint-presentation-ppt-to-video-avimpeg-flash-and-cddvd/)列出了一堆进行转换的程序，有些是免费的，有些不是。[Camtasia](http://www.techsmith.com/camtasia.asp)有一个[插件](http://www.techsmith.com/camtasia/accessories/powerpoint.asp)，可以直接从 PowerPoint 转换为 GIF。如果您使用其中一种免费产品转换为视频，则可以使用[MEncoder等工具将该视频转换为图像，然后使用包括](http://en.wikipedia.org/wiki/MEncoder)[GIMP](http://www.gimp.org)在内的许多免费工具或服务中的任何一种将这些单独的图像转换为动画 gif 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-24T00:07:13.583

将幻灯片另存为图像（JPEG 等），然后导入 Adob​​e Photoshop。说明在这里：

[http://www.youtube.com/watch?v=9F6pxRiL4Hs](http://www.youtube.com/watch?v=9F6pxRiL4Hs)

# c# - wpf故事板死亡

> ID：315427
> 
> 赞同：4
> 
> 时间：2008-11-24T20:49:51.730
> 
> 标签：c#, wpf, xaml, timer, storyboard

C＃：

```
public partial class MainWindow : Window
{
    Storyboard a = new Storyboard();
    int i;
    public MainWindow()
    {
        InitializeComponent();
        a.Completed += new EventHandler(a_Completed);
        a.Duration = TimeSpan.FromMilliseconds(10);
        a.Begin();
    }

    void a_Completed(object sender, EventArgs e)
    {
        textblock.Text = (++i).ToString();
        a.Begin();
    }
} 
```

XAML：

```
<Window x:Class="Gui.MainWindow" x:Name="control"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="MainWindow" Height="300" Width="300">
<Canvas>
    <TextBlock Name="textblock"></TextBlock>
</Canvas> 
```

这段代码有什么问题？故事板在 20-50 轮后停止。每次都是不同的号码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T01:39:48.353

我相信这是因为您的代码在 Storyboard 的动画时钟和 TextBlock 的 Text DependencyProperty 之间没有创建任何关系。如果我不得不猜测我会说 Storyboard 何时结束，那是由于 DependencyProperty （TextBlock.Text 是一个 DependencyProperty）更新管道的污染而出现的随机时间。创建如下关联（RunTimeline 或 RunStoryboard 都可以，但显示查看此关联的替代方法）：

```
public partial class Window1 : Window
{
    Storyboard a = new Storyboard();
    StringAnimationUsingKeyFrames timeline = new StringAnimationUsingKeyFrames();
    DiscreteStringKeyFrame keyframe = new DiscreteStringKeyFrame();

    int i;

    public Window1()
    {
        InitializeComponent();

        //RunTimeline();
        RunStoryboard();
    }

    private void RunTimeline()
    {
        timeline.SetValue(Storyboard.TargetPropertyProperty, new PropertyPath("(TextBlock.Text)"));
        timeline.Completed += timeline_Completed;
        timeline.Duration = new Duration(TimeSpan.FromMilliseconds(10));
        textblock.BeginAnimation(TextBlock.TextProperty, timeline);
    }

    private void RunStoryboard()
    {
        timeline.SetValue(Storyboard.TargetPropertyProperty, new PropertyPath("(TextBlock.Text)"));
        a.Children.Add(timeline);
        a.Completed += a_Completed;
        a.Duration = new Duration(TimeSpan.FromMilliseconds(10));
        a.Begin(textblock);
    }

    void timeline_Completed(object sender, EventArgs e)
    {
        textblock.Text = (++i).ToString();
        textblock.BeginAnimation(TextBlock.TextProperty, timeline);
    }

    void a_Completed(object sender, EventArgs e)
    {
        textblock.Text = (++i).ToString();
        a.Begin(textblock);
    }
} 
```

只要我让它运行，这对我有用（比其他情况下运行的时间长约 10 倍）。

蒂姆

# python - 需要黑白棋游戏的说明

> ID：315435
> 
> 赞同：3
> 
> 时间：2008-11-24T20:53:22.270
> 
> 标签：python, reversi

我正在尝试用 Python 编写黑白棋游戏。谁能给我一些简单，好且易于使用的基本想法和策略？

我会很感激任何帮助，因为我已经走了一点路，但被困在代码之间，而且它也变得更加复杂。我认为我在某些应该相当简单的部分做得过火了。所以....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T21:01:43.563

黑白棋是一款优雅简单的游戏。我将使用伪 C#/Java 语言来解释一些概念，但您可以将它们转换为 Python。

要将其分解为最简单的组件，您有两个基本的东西：

代表游戏板的二维数组：

```
gameBoard[10,10] 
```

以及某种形式的枚举，用于存储游戏板中每个图块的状态：

```
enum tile
{
    none,
    white,
    black
} 
```

为了渲染棋盘，你循环遍历 gameBoard 数组，增加棋子大小的偏移量：

```
for (int i = 0; i < 10; i++)
{
    for (int j = 0; j < 10; j++)
    {
        // The Piece to draw would be at gameBoard[i,j];
        // Pixel locations are calculated by multiplying the array location by an offset.
        DrawPiece(gameBoard[i,j],i * Width of Tile, j * width of tile);
    }
} 
```

同样，将鼠标单击解析回数组中的某个位置也是类似的，使用鼠标位置和偏移量来计算您所在的实际图块。

每次放置瓷砖时，您都会扫描整个阵列，并根据新颜色应该是什么应用一个基于简单规则的引擎。（这是真正的挑战，我会留给你。）

AI 可以利用假设动作进行阵列扫描，让它扫描大约 10 个可能的动作，然后选择产生最佳结果的动作。尽量不要让它变得聪明，因为当你让它在脑海中玩完整个游戏时，它很容易制造出无与伦比的 AI。

当阵列中不再有任何空闲位置时，您结束游戏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T22:12:36.680

维基[百科页面](http://en.wikipedia.org/wiki/Reversi)包含所有规则和一些体面的黑白棋策略建议。基本上，您需要某种数据结构来表示棋盘状态，即棋盘上所有棋子在游戏中任意时刻的位置。正如其他人所建议的那样，二维数组可能是一个不错的选择，但只要它是一种对您有意义的表示形式，它并不重要。一些困难的事情是找出哪些空间是有效的移动，然后哪些部分要翻转，但是，维基百科页面再次包含所有细节，所以它不应该太难实现。

如果你想为你的游戏创建一个 AI，那么我建议你看看某种带有 Alpha-Beta 修剪的极小极大类型算法。网络上有大量的资源，使用极小极大和良好评估功能的人工智能将能够轻松击败大多数人类玩家，因为它可以在很短的时间内至少领先 8 或 9 步。minimax 上还有一些其他更高级的变体，例如 negamax 或 negascout，它们甚至可以比基本的 minimax 做得更好，但我会从更简单的变体开始。维基百科有关于所有这些算法的页面，并且有大量关于所有这些算法的信息，因为许多 AI 课程将它们用于奥赛罗或类似的东西。一个特别有用的页面是[这个 Java Applet](http://wolfey.110mb.com/GameVisual/launch.php?agent=2). 它允许您在带有和不带有 alpha-beta 修剪的样本状态树上逐步完成 minimax 和 negamax 的步骤。

如果这些都没有意义，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:21:09.827

你需要一个二维数组。当心 [[0] * 8] * 8，而是使用 [[0 for _ in [0] * 8] for _ in [0] * 8]

白色应该是 1，黑色应该是 -1（当然反之亦然）。这样，您可以使用 *=-1 进行翻转并保持空白 双四循环将能够计算总分并确定游戏是否做得很好。map(sum,map(sum,board)) 会给你净分数

不要忘记检查玩家是否可以在回合开始时移动

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T02:53:14.633

不要被多暗阵列解决方案所吸引。我已经写了一个带有 multi-dim 的井字游戏，它工作得很好，但是当我开始我自己的 othello 版本时，我做了一个线性整数数组，它的速度几乎快了 2 倍。

[将整数转换为笛卡尔坐标的替代/更快方法？](https://stackoverflow.com/questions/507295/alternative-faster-methods-of-converting-an-integer-to-a-cartesian-coordinate)

我已经把所有东西大部分都用 PHP 编码了，但仍然在研究 Idea's for the AI 作为像井字游戏那样的蛮力解决方案是行不通的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T03:32:23.027

您甚至不需要线性阵列。两个 64 位 java long 值就足够了（一个用于白色，一个用于黑色。assert (white&black)==0 。

您可以通过计算不是连接到角落的棋子，而是计算无法取走的棋子来使游戏更强大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-26T06:41:00.570

您可能还希望考虑应用“模糊逻辑”循环来分析位置。Reversi/Othello 因强迫玩家考虑某些战略收益而不是战略损失而臭名昭著，并且将一个积极的举动优先于另一个。

模糊系统将通过设置各种设置来让您更好地控制测试移动选择，并让您能够通过改变各种权重来创建多个“个性”来对抗。

# c++ - 使用 Win32 C++ 检测文件句柄泄漏

> ID：315437
> 
> 赞同：8
> 
> 时间：2008-11-24T20:55:19.553
> 
> 标签：c++, winapi, visual-c++

有没有办法在程序终止时检测文件句柄泄漏？

特别是我想确保我创建的所有句柄都在代码中被释放。

例如，我可能在某处有一个 CreateFile()，并且在程序终止时我想检测并确保它们都已关闭。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-25T09:25:41.987

如果可以（即，如果它不是一个巨大的遗留代码库，则您正在修复错误）您应该考虑使用[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)习惯用法来环绕您的文件句柄。通过在构造函数中“获取”文件句柄并在析构函数中释放它，您可以确保当您的 RAII 超出范围时，您的文件句柄也被很好地清理了。

它与智能指针的原理相同，它是一个非常有用的概念，可以在您的工具箱中使用，以避免在 C++ 中出现此类问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-28T09:38:07.487

我使用过windbg 的!htrace 命令。

```
!htrace -enable
!htrace -snapshot
!htrace -diff 
```

允许您比较两个执行点的句柄情况，并帮助您定位已分配泄漏句柄的点。

它对我来说效果很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T21:08:52.707

您还可以使用 MS 的[Application Verifier](http://msdn.microsoft.com/en-us/library/ms220948.aspx)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-14T11:55:27.397

如果你买不起 BoundsChecker 或类似的东西......

我使用的一个技巧是`CreateFile`用我自己的包装器替换等。除了返回句柄值之外，它们还会记录 __FILE__ 和 __LINE__ 以与每个句柄一起使用。您还需要包装`CloseHandle`，以确保正确关闭的句柄不会引发误报。

它很简单：

```
// StdAfx.h
#include <windows.h>
#undef CreateFile
#if defined(UNICODE)
 #define CreateFile DbgCreateFileW
#else
 #define CreateFile DbgCreateFileA
#endif

// etc. 
```

然后，您在代码中的某处定义`DbgCreateFileW`和。`DbgCreateFileA`

这假设您已经控制了相关的代码。如果没有，您可以使用（例如）Microsoft Detours 来做类似的事情（您需要许可证才能将其包含在已发布的产品中，但我相信它可以免费用于调试/测试/等。）

但是，从长远来看，您应该考虑将代码转换为使用“智能”句柄类型，该句柄类型`CloseHandle`会在超出范围时自动调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T20:59:03.880

BoundsChecker 或其他类似程序会这样做。我还以为在VC6及以上的调试器下运行会报告泄漏列表。也许这是因为我总是有插件工具来做这类事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T22:13:42.983

对文件句柄和类似资源使用智能指针。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-27T14:43:05.417

另一个技巧是 SysInternals FileMon ( [Link](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx) )。

它向您显示文件系统活动，因此它应该支持您查找打开的句柄。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T12:55:44.747

我建议使用此工具[Memory Validator](http://www.softwareverify.com/cpp/memory/index.html?gclid=CPvOgpiMjpgCFZiT3wodEC7cUw)

这是很不错的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T12:05:46.047

正如 MadKeithV 所说，您可以使用 RAII 来发挥出色的效果。

还有一种简单的方法（免费）是使用[Visual Leak Detector](http://dmoulding.googlepages.com/vld)。这并不完美，但它是确保您拥有 free'd/delete[]d/close'd 等的好方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T22:31:47.577

windbg 或 ntsd 有一个 !handle 扩展名，告诉您应用程序打开了哪些句柄。我想您可以在程序末尾放置一个断点并将句柄转储到那里。

您还可以在 powerdbg ( [http://www.codeplex.com/powerdbg](http://www.codeplex.com/powerdbg) ) 中执行某些操作来自动执行此过程。

当然，这假设您的时间比购买解决方案便宜:)

# wpf - WPF：向按钮添加触发器

> ID：315440
> 
> 赞同：1
> 
> 时间：2008-11-24T20:55:50.970
> 
> 标签：wpf, vb.net, triggers, styles

我目前正在编写一个带有 WPF UI 的程序，并且我有一个关闭或取消的按钮，具体取决于页面上是否有任何更改。为了实现这一点，我想在按钮上使用触发器（以样式包装），以便当依赖属性 HasChanges 为 true 时，按钮将从“关闭”变为“取消”。到目前为止，我的程序将“关闭”显示为按钮的文本，但是当我的依赖属性 HasChanges 变为 true 时没有任何反应。WPF 页面是用 VB.Net 而不是 XAML 编写的。

到目前为止，我有：

```
Private Sub SetUpMyButton()
    Me.MyButton.Style = Me.GetMyButtonStyle()
End Sub

Private Function GetMyButtonStyle() As Style
    Dim hasChangesTrigger as New Trigger
    hasChangesTrigger.Property = CustomControl.HasChangesProperty
    hasChangesTrigger.Value = True
    hasChangesTrigger.Setters.Add(New Setter(Button.ContentProperty, "Cancel"))

    Dim hasChangesStyle as New Style
    hasChangesStyle.TargetType = GetType(Button)
    hasChangesStyle.Setters.Add(New Setter(Button.ContentProperty, "Close"))
    hasChangesStyle.Triggers.Add(hasChangesTrigger)
    hasChangesStyle.Seal()

    Return hasChangesStyle
End Function 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T10:22:07.847

我不知道为什么要在代码中而不是 XAML 中执行此操作，但我认为只是您的触发器不知道在哪里查找自定义依赖项属性。使用您的代码，它将在按钮本身上查找 HasChanges 属性。这是故意的吗？也许您需要设置`Trigger`'`SourceName`属性。或者可能完全使用不同的触发器类型（例如 a `DataTrigger`）会更容易。

# linux - 约 250,000 张图像的最佳 Web 文件夹结构

> ID：315459
> 
> 赞同：5
> 
> 时间：2008-11-24T21:03:09.193
> 
> 标签：linux, apache, image, file-management

我将有大约 200,000 张图片作为我网站的一部分。每个图像将被存储 3 次：全尺寸、缩略图、更大的缩略图。全尺寸图像约为 50Kb 到 500Kb。

普通技术：VPS 上的 Linux、Apache、MySQL、PHP。

存储这些以通过浏览器快速检索和显示的最佳方式是什么？

我应该将所有内容存储在一个文件夹中吗？我应该将完整尺寸的图像存储在 1 个文件夹中，将缩略图存储在另一个文件夹中吗？我应该将图像存储在 1000 个文件夹中，并保留图像所在文件夹的索引吗？

感谢您的任何建议。阿尔伯特。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T21:14:30.933

我会使用拆分目录结构，深度为三到四级，其想法是将所有文件均匀地拆分到多个目录中，主要是为了便于维护和快速访问。

怎么做？有多种选择：

*   取图像名称的第一个字符
*   取名称哈希的第一个字符
*   取自 1970 年以来添加图片之日起的最后秒数
*   获取数据库中图像 ID 的最后一个字符（如果存在）

假设我们有 IMG8993_full.jpg、IMG8993_thumb.jpg、IMG8993_smallthumb.jpg

然后我们可以有，例如：

```
/images/I/M/G/8/IMG8993:
IMG8993_full.jpg
IMG8993_thumb.jpg
IMG8993_smallthumb.jpg 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T21:29:22.463

除非您的用户要访问包含图像目录列表的打开文件夹，否则我认为文件夹结构不会显着提高或降低用户的检索速度。正如其他人所说，确保索引已打开。但是，如果我是您，我会考虑编写（或复制和粘贴）动态提供图像的服务，而不是将它们直接存储在您的 Web 文件结构中。研究在 PHP 中使用 LibGD——它应该预装在大多数 LAMP 服务器上。

缺点：

*   通过服务提供图像将比提供直接链接慢一点
*   如果您使用后端图像存储，例如数据库，它可能会崩溃并导致您的所有图像暂时不可用

优点：

*   您将通过将图像动态调整为缩略图来节省存储空间，并使维护更容易
*   通常，处理器速度比存储空间便宜

使用 URL 重写，你甚至可以将难看的 URL 变成诸如

```
/imageServer.php?userID=12345imageId=67890&size=full 
```

变成对用户更时尚、更透明的东西：

```
/jeremyZX/images/myPhoto.jpg
/jeremyZX/images/tn/myPhoto.jpg 
```

这将给出图像的整个目录结构的外观，而它们实际上以您想要的任何后端格式存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:16:22.257

无论你做什么，确保在文件系统上启用目录索引（你应该选择一个支持它的文件系统 - 但他们都这样做）

在实践中，比如说 ext3，这不是问题，因为它在较新的系统上默认启用。您可以使用 tune2fs 找出答案（阅读手册）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T21:23:58.557

使用这些类型的数字，您可能会或可能不会遇到服务器上设置的 inode 限制。这可能会有问题，具体取决于谁控制该框。

一般来说，我会想出一些方案来将它们分成更易于管理的大小。即使`ls`在这么大的目录上运行也需要很长时间才能对所有目录进行排序和显示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T21:11:03.437

取决于您如何索引它们，以及如何检索它们。

没有什么特别反对将它们全部存储在一个文件夹中，但它变得难以管理。如果您按文件名存储它们，并且文件名是合理的正态分布，您可能希望子文件夹由名称的第一个字母等分隔。如果您按添加日期编制索引，您可能希望将它们分开.

据我所知，没有“更快”或“更慢”的方式来存储图像以供浏览器检索。

# image-processing - 在没有 X11 的机器上将绘图导出为 Mathematica 中的图像（即，不涉及前端）

> ID：315464
> 
> 赞同：10
> 
> 时间：2008-11-24T21:04:12.327
> 
> 标签：image-processing, export, wolfram-mathematica

考虑以下带有内核命令行界面的对话框：

```
$ math
Mathematica 6.0 for Linux x86 (32-bit)

In[1]:= p = Plot[x^2, {x,-1,1}]
Out[1]= -Graphics-

In[2]:= Export["foo.png", p]
Out[2]= foo.png 
```

这在具有以下错误的机器上运行良好，但在具有以下错误`$Version = 6.0 for Linux x86 (32-bit) (June 2, 2008)`的机器上失败：`$Version = 7.0 for Linux x86 (64-bit) (November 11, 2008)`

```
Export::nofe: A front end is not available; export of PNG 
requires a front end. 
```

我能想到的任何其他图像格式都有类似的错误。

所以问题是，我怎样才能让没有前端的 Mathematica 内核导出图像？为什么它可以在 Mathematica 6.0 中顺利运行？如果上面的示例在版本 7 中适用于您，请告诉我！

PS：版本 7 引入了该功能`UsingFrontEnd`，但失败了

```
Developer`UseFrontEnd::nofestart: 
Unable to launch a front end. Proceeding without a front end. 
```

大概是因为机器上没有安装X11。

### 附录

事实证明，在这方面，版本 6 和版本 7 没有区别。相反，在版本 6 的机器上，前端被静默调用。另一台机器的问题，正如这个问题的答案所表明的那样，是没有 X 服务器，因此无法调用前端。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-09T20:01:14.930

您需要一个前端来从 MathKernel 导出图形。图形的渲染完全由前端覆盖。没有前端，您就没有要导出的图形。没有解决方法。

如果你有一个工作的前端，你可以做的是使用：

`UseFrontEnd[Export[filename,graphics]]`

这将从终端调用前端，允许您导出图形。

要在没有安装 X 服务器和 Windows 管理器的 Linux 机器上运行前端，您有以下选项：

1.  使用其他机器的 X 显示。参见例如[http://www.hungry.com/~jamie/xexport.html](http://www.hungry.com/~jamie/xexport.html)。基本上它归结为设置环境变量`export DISPLAY=machine_address:0.0`或在每个执行选项期间传递`-display machine_address:0.0`。

2.  在本地安装 Xvfb，它是一个 X 服务器帧缓冲区。它非常简单易用。参见例如 Xvfb 上的 Wikipedia 条目。您可以在运行 Xvfb 时设置 X 显示`Xvfb :display_nr &`，然后像之前的选项一样使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T13:18:06.277

导出图形也需要版本 6 中的前端。反过来，前端可能需要 X（毕竟甚至一些 2D 绘图也需要 3D 图形加速......）

我只有适用于 Windows 的 v6。从命令行会话导出图形时，前端会根据需要在后台自动启动。

# ruby-on-rails - Rails 中的 RT 并行处理

> ID：315466
> 
> 赞同：3
> 
> 时间：2008-11-24T21:04:29.597
> 
> 标签：ruby-on-rails, parallel-processing, mapreduce

我正在开发一种在 Ruby on Rails 中的个性化搜索引擎，我目前正在尝试根据用户的记录实时找到对结果进行排序的最佳方式。

示例：搜索的项目可以有标签（带有 id 的单独实体），例如项目有标签=[1,5,10,23,45]。

另一方面，用户可能已将某些标签标记为特别感兴趣，因此假设用户的标签=[5, 23]。

用于对结果进行排序的分数应考虑用户“盯着”的项目标签的数量。例如，项目的分数将基于项目的属性为 50%，而排名为 50%，具体取决于用户的（注视的标签数量）。

一个想法是将其注入信息检索系统的排序功能中。但是在我可能会使用的 Sphinx 中，实现起来会非常尴尬（当用户的向量很大时）。我不了解 Lucene/solr，但它们似乎没有我需要的高级非文本搜索功能（距离、日期、时间等）

其他选项是从 IR 系统检索中介集，然后在应用程序级别对其进行处理。但是，我很确定按顺序处理 100-1000 条记录，然后在 Rails 中对它们进行排序会非常慢。

另一方面，这似乎是可以轻松并行处理的任务 - 将 1000 条记录分成由单独的线程处理然后排序的集合。

我读到了几个 map reduce 实现，既有像 hadoop 这样的通用实现，也有像 skynet 等特定于 rails 的实现，但它们最适合大批量作业，而不是实时处理（除非我弄错了？）。

我可以为此使用任何内存中的轻型 MR 实现吗？或者，也许你有一些其他的想法如何处理它？

（旁注：我相信这个设置类似于谷歌新闻的工作方式，从我从“谷歌新闻个性化：可扩展的在线协同过滤”论文中了解到。它们实时匹配一组候选故事和用户所属的一组集群到（之前预先计算的）以个性化的方式对故事进行排序）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T07:46:33.527

Map/Reduce 非常适合这种事情，但您可以使用中间表在 SQL 中处理它。

大概，你已经有这样的表：

```
用户（ID，...）
项目（id，...）
标签（id，...）
users_tags (user_id, tag_id)
items_tags (item_id, tag_id)

```

所以，你为什么不也维护一个这样的表：

```
users_items_tags (user_id, item_id, tag_id)
```

其中每一行的意思是“这个用户和这个项目共享这个标签”。

然后，您的搜索查询是这样的：

```
  选择 item_id, count(tag_id) 作为分数
    来自 users_items_tags
   其中 user_id = <USER_ID>
按 item_id 分组
按分数顺序排列

```

当用户添加标签时，`users_items_tags`更新如下：

```
插入 users_items_tags (user_id, item_id, tag_id)
     选择 <USER_ID>、item_id、<TAG_ID>
       来自 items_tags
      其中 tag_id = <TAG_ID>

```

在向项目添加标签时也是如此。删除标签时，只需删除标签和用户/项目。

此解决方案有一些问题案例。如果某个特定标签在项目中是常见的，那么当用户添加该标签时将执行大量写入，反之亦然。如果标签在项目和用户中都是通用的，那么表格将变得非常大。您必须为您的特定数据集考虑这些情况。

# castle-monorail - NVelocity、foreach 和两个列表的问题

> ID：315475
> 
> 赞同：5
> 
> 时间：2008-11-24T21:09:16.997
> 
> 标签：castle-monorail, nvelocity

有没有一种简单的方法可以解决以下问题。

假设我从我的模型中获取了一个 IList，其中包含我的控制器中的一些书籍。现在我想丰富输出并使用来自外部框架的另一个模型从 Amazon 获取预览并获取另一个 IList。

现在我将两个 IList 都放入一个属性包中。

在 NVelocity 中，我为 BookList 使用了#foreach，但是如何通过正确的预览访问 amazonbooklist？我不能使用 $amazonbook[index]，其中 index 是 isbn。我真的需要将两个列表放在一个大列表中，其中包含一个仅包含其他两个对象的简单对象吗？

请记住，两种模型都来自不同的框架，不能放在一个框架中。两个框架必须保持分离。我尝试解决 NVelocity 问题，当然，这个问题只是一个例子，我们不卖书；）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-08T11:38:49.653

看这里： http: [//www.castleproject.org/monorail/faq.html#NVelocity%20View%20Engine](http://www.castleproject.org/monorail/faq.html#NVelocity%20View%20Engine)

您可以通过以下方式访问 NVelocity 中的字典

```
$amazonbook.get_Item($index) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T21:39:27.717

可能有一个更简单的解决方案，但我会创建这样的第三类

```
class BookList{
       MyBookObject     a;
       AmazonBookObject b;
} 
```

这第三类的列表可以立即传递给您的视图。

# visual-studio - 如何在 Visual Studio 中切换自动换行？

> ID：315485
> 
> 赞同：364
> 
> 时间：2008-11-24T21:12:56.270
> 
> 标签：visual-studio, word-wrap

Visual Studio .NET 是否可以打开和关闭自动换行？

我习惯了 Eclipse 中的这个功能，它允许您右键单击并打开和关闭自动换行，这样当您有向右延伸的长行时，您不必左右移动底部滚动条阅读您的代码 [/html：http://web.archive.org/web/20131027224437/http://ahtik.com:80/blog/2006/06/18/first-alpha-of-eclipse-word-wrap-发布/](http://web.archive.org/web/20131027224437/http://ahtik.com:80/blog/2006/06/18/first-alpha-of-eclipse-word-wrap-released/)

* * *

## 回答 #1

> 赞同：692
> 
> 时间：2008-11-24T21:20:08.783

按照[https://docs.microsoft.com/en-gb/visualstudio/ide/reference/how-to-manage-word-wrap-in-the-editor](https://docs.microsoft.com/en-gb/visualstudio/ide/reference/how-to-manage-word-wrap-in-the-editor)

**查看文档时**：编辑/高级/自动换行（`Ctrl`+ `E`、`Ctrl`+ `W`）

**常规设置**：工具/选项/文本编辑器/所有语言/自动换行

或在“快速启动”框中搜索“自动换行”。

* * *

[已知问题](https://docs.microsoft.com/en-gb/visualstudio/ide/reference/how-to-manage-word-wrap-in-the-editor?view=vs-2017#known-issues)：

> 如果您熟悉 Notepad++、Sublime Text 或 Visual Studio Code 中的自动换行，请注意 Visual Studio 与其他编辑器的行为不同的以下问题：
> 
> 1.  [三击不会选择整行](https://developercommunity.visualstudio.com/content/problem/268989/triple-click-doesnt-select-whole-line-when-word-wr.html)
> 2.  [剪切命令不会删除整行](https://developercommunity.visualstudio.com/content/problem/138259/cut-command-should-delete-logical-line.html)
> 3.  [按 End 键两次不会将光标移动到行尾](https://developercommunity.visualstudio.com/content/problem/138274/pressing-end-key-twice-should-move-cursor-to-end-o.html)

不幸的是，这些错误已被“低优先级”关闭。如果您希望修复这些错误，请投票支持功能请求[*Fix known questions with word wrap*](https://developercommunity.visualstudio.com/content/idea/351760/fix-known-issues-in-word-wrap.html)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-24T21:25:45.620

我经常使用此功能，因此我在命令栏上添加了一个自定义按钮。

1.  单击**添加或删除按钮**->**自定义**
2.  单击**命令**选项卡
3.  单击**添加命令...**
4.  从列表中选择**编辑**（或编辑|高级对于较新的 VS 版本）
5.  找到**Toggle Word Wrap**并将其拖到您的栏上

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-07-09T10:53:35.363

从 Visual Studio 2013 开始，自动换行功能终于可以使用了——它尊重缩进。还有几个问题（线条突出显示、选择），但值得使用。就是这样

![在此处输入图像描述](https://i.stack.imgur.com/8asKT.png)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-24T21:25:33.140

在 Visual Studio 2005 专业版中：

`Ctrl`+ `E`, `Ctrl`+`W`

或菜单*编辑*→*高级*→*自动换行*。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-13T01:00:12.747

1.  打开输出窗口。

2.  在工具栏的最右侧查找以文本“显示输出：”开头的小图标。它看起来像一个带有回车图标的小窗口。当您将鼠标悬停在它上面时，Visual Studio 应该在鼠标指针附近显示“切换自动换行”。

3.  单击该图标。

你现在已经学到了一些非常明显的痛苦，我为很久以前不知道这一点而感到尴尬，因此选择了支付我的会费并与其他人分享我的答案，这样他们就不会遭受同样的痛苦。

说真的，这对小屏幕的人来说真的很有用。我有一个小型的 Lilliput USB 显示器，它适用于小型工具窗口、Skype IM 等。它非常适合打开输出窗口，但它总是横向滚动很糟糕。在忍受了几个月的横向滚动之后，我终于决定看看我是否可以让它自动换行。答案很简单，但它节省的时间/精力是巨大的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-28T19:45:26.437

在 Visual Studio 2008 中，`CTRL`++ `E`.`W`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-01-28T09:38:22.457

[Visual Studio 中的键盘快捷键](https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf)

(alt + z) => 切换自动换行

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-24T21:24:52.347

在 Visual Studio 2008 中，它是`Ctrl`++ `E`。`W`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-24T21:13:58.470

在 Visual Studio 2003 中使用菜单*编辑*→*高级*→*自动换行。*

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-04-28T05:45:15.300

`Visual Studio 2017`执行以下操作：

**工具 > 选项 > 所有语言**，然后根据您的偏好选中或取消选中该复选框。如下图所示：

![](https://i.stack.imgur.com/fOK9Z.png)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-03-26T20:35:36.107

在最新版本中。

1.点击左下角图标[设置](https://i.stack.imgur.com/pm3Aq.png)

2.选择设置[设置](https://i.stack.imgur.com/6dlKC.png)

[3.在自动换](https://i.stack.imgur.com/II6RV.png)行上选择“文本编辑器”>“自动换行”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-24T14:07:31.103

在 VS 代码中 === 版本：1.52.1

1.  打开 VS Code**设置**

2.  从设置中找到 settings.json 文件并打开它

3.  添加此代码 - **“editor.accessibilitySupport”：“关闭”**

如果您之前已经添加了值为**"on"的****"editor.accessibilitySupport"** ，则只需将其设置为**"off"**。当我在使用我的一个 JS 项目时遇到同样的问题时，这是为我工作的代码。

 ****# video-encoding - 重新编码 AVI 文件以适应给定的输出文件大小。

> ID：315488
> 
> 赞同：1
> 
> 时间：2008-11-24T21:13:57.533
> 
> 标签：video-encoding, avi, divx

我有一个 AVI 文件，我想对其重新编码以适合大小为 650 MB 的 CD。如何编码以使文件大小不超过给定大小？我可以使用哪个程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T22:14:00.517

我假设您想以编程方式执行此操作：

**对于 Windows：**

您可以使用 directshow 通过构建过滤器图对视频进行转码。

获取（如果您还没有）适用于 Windows 的平台 SDK。然后浏览此处查看一些构建过滤器图以进行转码的 directshow 示例。

要构建，您将需要基类。你可以在这里构建它们：

```
C:\Program Files\Microsoft SDKs\Windows\v6.1\Samples\Multimedia\DirectShow\BaseClasses 
```

然后在这里查看示例：

```
C:\Program Files\Microsoft SDKs\Windows\v6.1\Samples\Multimedia\DirectShow 
```

您还可以手动创建过滤器图以了解它们的使用方式并查看这些东西的意义（例如您将在示例中了解的编码器的枚举）：

```
C:\Program Files\Microsoft SDKs\Windows\v6.1\Bin\graphedt.exe 
```

一旦您走到这一步并了解了 directshow 的工作原理，您就可以使用一些数学来计算如何对视频进行转码以适合您想要的大小。为此，您可能需要查看输入视频的帧数/秒以及每帧的大小。

不同的编码器以不同的方式工作：

假设您正在将 avi 文件转码为更小或质量更低的 avi 文件。查看您的输入帧大小和 fps 以确定整个文件大小，然后使用一些代数来计算如何减小帧大小或减少每秒帧数（或两者的组合）以达到所需的大小（可以是你的输入变量）。

至于其他编码器，您可能想看看它们是如何工作的。mp4 等有损编码器执行估计以找出哪些视频在帧之间发生了变化，并且该信息存储在文件中以重建帧。您将不得不阅读它们的工作原理 - 或查看如何使用您的特定编码器以获取更多详细信息。

**对于 Linux（以及 Windows）：**

您可以使用[ffmpeg](http://ffmpeg.mplayerhq.hu/)，它是用于将视频转码和其他内容的一体机。您甚至可以找到命令行应用程序的预构建 exe，尽管主页没有托管它（只是源代码）。这个应用程序使用开源视频库来做很多视频转码以及许多其他事情。如果你能找到一个好的可靠的 exe 文件，如果你想要一些易于用于你的应用程序的东西，你可能应该检查一下。在这里查看他们的主页。

我希望这能让你开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T22:28:54.590

要使其适合特定大小，您必须使用适当的比特率。

对于固定比特率视频，要获得目标比特率，您将采用目标大小（以比特为单位）和源的长度（以秒为单位）。

```
target bit-rate = size / seconds 
```

例如：

```
seconds = (90mins * 60) = 5400
size = ((650MB * 1024) * 8) = 5324800
target bit-rate = ~986 kilobytes per second 
```

使用可变比特率，事情变得更加复杂。不太确定是否有办法准确地将输出文件设置为固定大小。最简单的方法是使用上述方法计算最大比特率，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:41:26.697

[AutoGK](http://www.autogk.me.uk/)可以非常有效地做到这一点。主要设计用于 DVD ****cough**** 备份目的，但它也将接受 AVI 作为源。它更像是一组具有协调 GUI 的开源程序，所以当安装程序安装多个项目时不要担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T22:31:01.463

计算 AVI 的秒数。然后，取文件大小并除以长度。转换为每秒千比特，并将其用作比特率中位数。（使用 Google 轻松进行数学计算和转换。）

您可以根据需要权衡视频和音频比特率。通常 96 kbps 对 AAC 来说已经足够了，但您可能需要更多或更少。实验。

# asp.net - 对 SharePoint Web 部件和控件进行性能测试有哪些好的技术？

> ID：315490
> 
> 赞同：3
> 
> 时间：2008-11-24T21:14:04.960
> 
> 标签：asp.net, performance, sharepoint, web-parts

这是一个关于特定于 SharePoint Web 部件和控件的性能测试的问题（尽管标准的 ASP.NET 方法也适用）。我想知道什么是一些好的技术，考虑到以下因素：

*   缓存（什么时候应该缓存什么？）
*   负载均衡服务器（存储状态）
*   与页面其他部分的交互（例如多个 JavaScript 执行）
*   测量特定控件的 CPU 使用率
*   呈现的页面大小

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T03:46:37.163

我推荐带有 SP1 的 Visual Studio Test Suite 2008。我们在索引服务器上使用了测试代理，测试控制器在安装了 Visual Studio 的开发人员桌面上运行。

可以模拟浏览器缓存，我们发现我们自己的服务器缓存存在错误，而缓存实际上并没有起作用。

负载平衡服务器易于使用，因为您可以模拟一系列 IP 地址。您确实需要能够为运行测试的机器分配一个 IP 地址范围，并且只能调整 IP 地址的最后一个八位字节。每个 Web 前端的统计信息都可以添加到测试生成的 perfmon 统计信息中。

如果需要，您可以模拟页面不同部分的点击，但场景越复杂，就越难做到完美。

CPU 和其他统计数据测量非常棒。所有测试结果都可以添加到数据库中，并且负载测试期间和之后的测试图表非常好。

可以在每次测试运行中添加注释，以便在需要查看之前运行的测试结果时轻松识别它们。

请注意，随着时间的推移，结果会迅速增加。

# sql-server-2005 - 奇怪的 SQL Server 管理工作室行为

> ID：315495
> 
> 赞同：0
> 
> 时间：2008-11-24T21:14:33.303
> 
> 标签：sql-server-2005, ssms

我目前正在使用 SQL Server Management Studio (Ver 9.00.3042.00) 并单击“新建查询”并编写以下代码：

```
Select 
    colA,
    colB,
    colC
    colD
From
    table1 
```

当我单击解析（复选框）按钮以验证 SQL 语句时，它显示“命令已成功完成”。解析按钮不是应该捕获这些简单的错误...

有没有人经历过 Management Studio 的这种行为？这刚刚开始发生在这周......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T21:19:51.280

那是因为那是有效的 SQL。您实际上是用名称 colD 为 colC 起别名。这与键入相同：

```
colC as colD 
```

编辑：对于它的价值，这就是为什么人们会争辩说在这种情况下你应该把逗号放在行首的原因之一。当代码格式如下时，发现这样的陷阱要容易得多：

```
Select 
    colA
    , colB
    , colC
    colD
From
    table1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T21:37:09.763

在玩了一会儿之后，它会在以下代码片段中抛出“Incorrect syntax near”

```
Select     
    colA,    
    colB    
    colC    
    colD
From    
    table1

Select     
    colA,    
    colB,    
    colC,    
    colD,
From    
    table1 
```

# php - PHP 对象作为伪数组

> ID：315496
> 
> 赞同：1
> 
> 时间：2008-11-24T21:14:51.930
> 
> 标签：php, arrays, spl

我有一个实现[ArrayAccess](http://www.php.net/~helly/php/ext/spl/interfaceArrayAccess.html)、[Iterator](http://www.php.net/~helly/php/ext/spl/interfaceIterator.html)和[Countable](http://www.php.net/~helly/php/ext/spl/interfaceCountable.html)的对象。这会产生近乎完美的阵列掩蔽。`$object[foo]`我可以使用偏移量[`foreach`](http://php.net/foreach)（

但是我不能做的是把它交给本机数组迭代器函数（`next()`, `reset()`, `current()`, `key()`），即使我已经从 Iterator 实现了所需的方法。PHP 似乎顽固地尝试遍历其成员变量，并且完全无视迭代器方法。

是否有一个接口可以将对象连接到剩余的数组遍历函数，或者我是否坚持我所拥有的？

**更新：** IteratorAggregate 似乎也不是答案。虽然它在`foreach`-loops 中使用，但基本的数组迭代器函数不会调用这些方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T21:55:49.367

PHP 的最新变化阻止了使用标准数组函数（reset、next 等）操作 ArrayIterators 表单。

这应该很快恢复：http: [//news.php.net/php.internals/42015](http://news.php.net/php.internals/42015)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T21:36:32.183

使其工作的一种方法是在单独的类中定义您自己的迭代器，然后告诉您的主类使用该新迭代器而不是默认迭代器。

```
class MyIterator implements Iterator {
  public function key() {
    //
  }

  public function rewind() {
    //
  }

  // etc.

}

class MyMainClass implements IteratorAggregate {
  private $_data = array();

  // getIterator is required for the IteratorAggregate interface.
  public function getIterator() {
    return new MyIterator($this->_data);
  }

  // etc.

} 
```

那么你应该有尽可能多的控制权。（并且您可以在多个类中重用您自己的 MyIterator）。

上面没有做过测试，但原理是正确的，我相信。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:25:44.967

ArrayIterator不是您要找的吗[？](http://www.php.net/~helly/php/ext/spl/classArrayIterator.html)或者[ArrayObject](http://www.php.net/~helly/php/ext/spl/classArrayObject.html)怎么样，这似乎是您想要实现的 SPL 接口。

# sql - Excel中生成SQL语句的技巧

> ID：315504
> 
> 赞同：19
> 
> 时间：2008-11-24T21:17:55.467
> 
> 标签：sql, vba, excel, metaprogramming

对于各种数据导入场景，在 Excel 中生成 SQL 语句（主要是 INSERT）有什么技巧吗？

我真的厌倦了用like写公式

`="INSERT INTO Table (ID, Name) VALUES (" & C2 & ", '" & D2 & "')"`

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-24T21:28:22.073

分号需要在最后一个双引号内并带有右括号。在字符串周围添加单引号时，请记住将它们添加到所选单元格之外。

（为可见性添加空格 - 插入前删除）

`=CONCATENATE("insert into table (id, name) values (",C2,",' ",D2," ');")`

这是另一种观点：

`=CONCATENATE("insert into table (id, date, price) values (",C3,",'",D3,"',",B3,");")`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T01:07:22.150

我曾经使用字符串连接方法在 Excel 中创建 SQL 插入。它可以很好地工作，但也可能有点耗时且“繁琐”。

我创建了一个 Excel 加载项，可以更轻松地从 Excel 生成插入：

（参见页面底部的视频） [http://www.howinexcel.com/2009/06/generating-sql-insert-statements-in-excel.html](http://www.howinexcel.com/2009/06/generating-sql-insert-statements-in-excel.html)

[http://www.querycell.com/SQLGenerator.html](http://www.querycell.com/SQLGenerator.html)

[http://www.oneclickcommissions.com/excel-statement.html](http://www.oneclickcommissions.com/excel-statement.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-09T01:24:10.330

有时我使用替代来替换 SQL 命令中的模式，而不是尝试从连接中构建 sql 命令。假设数据在 A 列和 B 列中。插入顶行。在单元格 C1 中使用模式放置 SQL 命令：

```
insert into table t1 values('<<A>>', '<<B>>') 
```

然后在第 2 行中放置 excel 公式：

```
=SUBSTITUTE(SUBSTITUTE($C$1, "<<A>>", A2), "<<B>>", B2) 
```

请注意使用绝对单元寻址`$C$1`来获取模式。在使用 char 或 varchar 并且必须在连接中混合单引号和双引号时特别好。相比于：

```
=concatenate("insert into table t1 values '", A2, "', '", B2, "')" 
```

不止一次让我感到困扰的另一件事是尝试使用 excel 处理一些数字字符或 varchars，除了它们有前导零，例如 007。Excel 将转换为数字 7。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-12T15:31:14.787

VBA 方法是：声明你的字符串并像这样分配你的 SQL 语句

```
dim SqlString as String
SqlString = "SELECT * FROM %1 WHERE (var=%2)"
SqlString = Replace("%1", "Table_Name")
SqlString = Replace("%2", ""value"") 
```

Excel 方法类似，但使用了`SUBSTITUTE`函数。

我更喜欢这种方法，因为它使 SQL 文本清晰易读，并避免了所有烦人的 & 和连接问题。是的，它需要一个额外的单元格，但对于审计跟踪来说是值得的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-16T20:45:27.193

我知道这种痛苦。我最终[在我的博客上写了](https://christopherjmcclellan.wordpress.com/2013/10/22/excel-sqlconcat-function/)...[两次](https://christopherjmcclellan.wordpress.com/2014/02/14/excel-sqlconcat-function-revisited/)。
我创建了一个 UDF，它将一系列单元格与几个选项连接在一起。这将始终以逗号分隔值，但也可以根据需要添加单引号和/或括号。

因此，您编写了 sql 语句的简单部分。

```
INSERT INTO table
VALUES /*string that we don't want to type by hand*/ 
```

或者

```
SELECT *
FROM table
WHERE foo IN (/*another string I don't want to type out*/) 
```

下面的自定义 excel 函数会将电子表格范围内的值转换为适合您的字符串。

```
Function SQLConcat(rng As Range, Optional quoted As Boolean = False, Optional parenthesis As Boolean = False) As String
' ***************************************************************
' * Returns a comma separated list for use in SQL IN statements *
' * Params *
' * - rng: Range of cells to concatenate *
' * - quoted: True/False. If true, values are placed inside *
' * of single quotes. Default of false *
' * - parenthesis: Boolean. *
' * Useful for INSERT INTO tbl VALUES(53),(90),(397) *
' * *
' * Author: Christopher J. McClellan *
' * Published under Creative Commons Attribution-Share Alike *
' * http://creativecommons.org/licenses/by-sa/3.0/ *
' * You are free to change, distribute, and pretty much do *
' * whatever you like with the code, but you must give credit *
' * to the original author and publish any derivitive of this *
' * code under the same license. *
' ***************************************************************

Dim tmp As String 'temporary string
Dim row As Long 'first cell is special case
row = 0 'initalize row count
Dim c As Object 'cell
Dim txtwrapperLeft As String, txtwrapperRight As String

If quoted = True And parenthesis = False Then
 txtwrapperLeft = "'"
 txtwrapperRight = "'"
ElseIf quoted = True And parenthesis = True Then
 txtwrapperLeft = "('"
 txtwrapperRight = "')"
ElseIf quoted = False And parenthesis = True Then
 txtwrapperLeft = "("
 txtwrapperRight = ")"
Else
'quoted = false and parenthesis = false
 txtwrapperLeft = ""
 txtwrapperRight = ""
End If

For Each c In rng.Cells
 If row = 0 Then
 tmp = txtwrapperLeft & c.Value & txtwrapperRight
 Else
 tmp = tmp & "," & txtwrapperLeft & c.Value & txtwrapperRight
 End If
 row = row + 1
 Debug.Print tmp
Next c

'return
SQLConcat = tmp
End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T00:28:48.717

我昨天正在这样做，是的，正确引用引号很烦人。我做的一件事是有一个只包含一个单引号的命名单元格。键入 A1 `="'"`（等于、双引号、单引号、双引号），然后通过在最低工具栏左侧的框中键入该单元格来命名此单元格“QUOTE”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T17:14:31.837

有时，构建 SQL 插入似乎是最简单的方法。但是你很快就会厌倦它，而且我认为没有“聪明”的方法来做到这一点（除了宏/VBA 编程）。

我会指出您避免使用 Excel 并探索其他一些想法：

*   使用 Access（出色的 csv 导入过滤器，然后链接到 DB 表并让 Access 处理插入）
*   使用 TOAD（更好的导入功能，因为它允许您混合和匹配列，甚至可以从剪贴板导入）
*   使用 SQL Loader（使用起来有点棘手，但快速且非常灵活）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T11:42:15.763

将 excel 文件导出为 csv 可能是另一种选择（请参阅 Bill Krawin 的帖子 - 作为新海报，我还不能添加评论）。但是请注意，您可能必须将日期字段的格式更改为 yyyy-mm-dd，否则日期列将全部显示 00/00/00 - 这是因为 MySQL 使用与 Microsoft Excel 不同的日期格式。或者使用 OpenOffice 保存 csv 文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-16T13:05:17.187

如何使用 ACE/Jet（又名 Access）SQL 查询 Excel 工作簿中的数据并将其插入到源中？这需要一个 ACE/Jet，它可能是另一个 Excel 电子表格。这是一个简单的例子：

```
INSERT INTO 
   [ODBC;Driver={SQL Server};SERVER=MYSERVER;DATABASE=MyDatabase;UID=sa;Pwd=mypassword;].MyTable (ID, Name)
SELECT F1, F2
  FROM 
   [Excel 8.0;HDR=NO;IMEX=1;Database=C:\db.xls;].[Sheet1$A1:B4]; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-19T10:43:23.377

用于将数据插入到 sql 表中

```
=CONCATENATE("INSERT INTO `database_name`.`table_name`(`Column_Name`,`Column_Name`) VALUES ( '",A1,"',",B1,"); ") 
```

# language-agnostic - 重写这个非尾递归函数的好方法是什么？

> ID：315507
> 
> 赞同：12
> 
> 时间：2008-11-24T21:19:10.330
> 
> 标签：language-agnostic, functional-programming, recursion, tree, clojure

出于某种原因，我很难想出一种重写此函数的好方法，以便它使用恒定的堆栈空间。大多数关于树递归的在线讨论都是通过使用斐波那契函数并利用该特定问题的属性来作弊的。有没有人对递归的这种“真实世界”（嗯，比斐波那契数列更真实）使用有任何想法？

[Clojure](http://clojure.org)是一个有趣的案例，因为它没有尾调用优化，而只有通过“recur”特殊形式的尾递归。它还强烈反对使用可变状态。它确实有许多惰性结构，包括[tree-seq](http://clojure.org/api#toc489)，但我看不到它们如何帮助我解决这种情况。谁能分享他们从 C、Scheme、Haskell 或其他编程语言中学到的一些技术？

```
(defn flatten [x]
  (let [type (:type x)]
    (cond (or (= type :NIL) (= type :TEXT))
          x
          (= type :CONCAT)
          (doc-concat (flatten (:doc1 x))
                      (flatten (:doc2 x)))
          (= type :NEST)
          (doc-nest (:level x)
                    (flatten (:doc x)))
          (= type :LINE)
          (doc-text " ")
          (= type :UNION)
          (recur (:doc1 x))))) 
```

编辑：根据评论中的要求...

用一般术语重述并使用 Scheme——如何重写以下递归模式，使其不消耗堆栈空间或需要对非自调用进行尾调用优化？

```
(define (frob x)
  (cond ((foo? x)
         x)
        ((bar? x)
         (macerate (f x) (frob (g x))))
        ((thud? x)
         (frobnicate (frob (g x))
                     (frob (h x)))))) 
```

我选择了烦人的名字来说明我正在寻找不依赖于 x、浸渍、frobnicate、f、g 或 h 的代数属性的答案。我只想重写递归。

**更新**：

Rich Hickey为 Clojure添加了一个显式的[蹦床函数。](http://lambda-the-ultimate.org/node/3106)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T00:32:43.403

请不要对此投反对票，因为它很难看。我知道这很丑。但这是一种以蹦床风格（没有系统堆栈溢出）并且不使用 goto 的方法。

```
push x,1 on homemade stack
while stack length > 1
  n = pop
  if (n==1)
    x = pop
    if (type(x)==NIL || type(x)==TEXT)
      push x // this is the "return value"
    else if (type(x)==CONCAT)
      push 2 // say call doc-concat
      push doc2(x), 1 // 2nd recursion
      push doc1(x), 1 // 1st recursion
    else if (type(x)==NEST)
      push 3 // say call doc-nest
      push level(x) // push level argument to doc-nest
      push doc(x), 1 // schedule recursion
    else if (type(x)==LINE)
      push " " // return a blank
    else if (type(x)==UNION)
      push doc1(x), 1 // just recur
  else if (n==2)
    push doc-concat(pop, pop) // finish the CONCAT case
  else if (n==3)
    push doc-nest(pop, pop) // finish the NEST case
  endif
endwhile
// final value is the only value on the stack 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T22:10:51.320

轻松转换算法的主要障碍是它不会导致对同一函数的一系列调用；但在几个之间交替，每个都对另一个的结果进行操作。

我会说你有三个选择：

1.  完全重新制定算法（这就是斐波那契示例所做的）。
    *   将所有函数组合成一个带有大量 cond 的函数（丑陋，并且可能不会导致真正的尾递归，即使使用单个函数）。
    *   将流程由内而外：编写一个简单的尾递归函数，将输入数据转换为必须执行的操作序列，然后对其进行评估。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T22:53:18.330

如果 flatten 两次调用自身（在 :CONCAT 的情况下），它如何变成一个循环？也许我错过了一些东西。似乎它本质上是一个树行走。

我的意思是，有一些方法可以在没有堆栈的情况下进行树遍历，但必须是无界的，例如使用 FIFO 进行，或者按照建议使用延续。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T23:29:31.067

您可以使用延续传递：

```
(define (frob0 x k)
  (cond ((foo? x)
         (k x))
        ((bar? x)
         (frob0 (g x) 
           (lambda (y) 
             (k (macerate (f x) y))))
        ((thud? x)
         (frob0 (g x) 
           (lambda (y)
             (frob0 (h x) 
               (lambda (z)
                 (k (frobnicate y z))))))))

(define (frob x)
  (frob0 x (lambda (y) y)) 
```

这不会让事情更容易理解:-(

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-25T00:34:26.583

标准的通用技术是转换为[蹦床风格](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.32.6328)。对于您的特定问题（实现漂亮打印组合器），您可能会发现 Derek Oppen 1980 年的论文“Prettyprinting”（不在网络 AFAIK 上）很有帮助。它提出了一种基于堆栈的命令式算法，类似于 Wadler 后来的函数式算法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T00:06:50.977

我能想到的最好的是这样的：

```
(define (doaction vars action)
  (cond ((symbol=? action 'frob)
         (cond ((foo? (first vars))
                (first vars))
               ((bar? (first vars))
                (doaction (list (f (first vars)) (doaction (g x) 'frob)) 'macerate)
etc... 
```

它不是完全尾递归的，但可能是你能得到的最好的。总拥有成本确实是要走的路。（我知道由于 JVM，Clojure 不能拥有它）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-26T00:32:06.680

以下不是您问题的具体答案，但希望这将是一个有用的示例。它用一堆任务替换了多个递归（否则需要一个无界的调用堆栈）。

（在 Haskellish 代码中）：

```
`data Tree = Null | Node Tree Val Tree

-- original, non-tail-recursive function:
flatten :: Tree -> Result
flatten Null = nullval
flatten (Node a v b) = nodefunc (flatten a) v (flatten b)

-- modified, tail-recursive code:
data Task = A Val Tree | B Result Val

eval :: Tree -> [Task] -> Result
use  :: Result -> [Task] -> Result

eval Null tasks = use nullval tasks
eval (Node a v b) tasks = eval a ((A v b):tasks)

use aval ((A v b):tasks) = eval b ((B aval v):tasks)
use bval ((B aval v):tasks) = use (nodefunc aval v bval) tasks
use val [] = val

-- actual substitute function
flatten2 :: Tree -> Result
flatten2 tree = eval tree []` 
```

# `.net - COM over USB 和 .NET 与第 3 方硬件接口`

 `> ID：315508
> 
> 赞同：0
> 
> 时间：2008-11-24T21:19:13.387
> 
> 标签：.net, com, hardware, usb

我有一个项目，我必须与两个通过 COM over USB 提供数据的不同设备进行交互。客户告诉我，这可以通过超级终端轻松完成，但我不熟悉它。我正在使用 .NET 2.0 进行编码（但如有必要，可以使用 3.5）。

从这些硬件设备获取数据的最简单/最快的方法是什么？有控制吗？图书馆？还有什么，那是标准的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T21:23:31.913

你想要[System.IO.Ports.SerialPort](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)。然后，您可以使用 Read()、ReadLine() 等从第 3 方硬件读取数据。

# directshow - 除了 DirectShow 之外，.NET 的标准网络摄像头接口？

> ID：315513
> 
> 赞同：0
> 
> 时间：2008-11-24T21:20:29.640
> 
> 标签：directshow, webcam, ocx

我希望能够通过 .NET 2.0（或 3.5，如有必要）使用网络摄像头拍摄静止图像。我知道我可以使用 DirectShow，但这似乎是一个非常大的学习曲线。

是否有一个简单易用的 OCX 或可以与大多数标准网络摄像头一起使用的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T02:18:42.520

Pegasus Imaging 具有[CapturePRO](http://www.pegasusimaging.com/capturepro.htm)控件。它有 ActiveX 和 .NET (WinForms) 两种版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-31T23:52:45.777

[Windows Image Acqisition](http://msdn.microsoft.com/en-us/library/ms630368(VS.85).aspx)将是执行此操作的标准非直接显示方式。（即：非第三方）。

# url - Adobe Air 在运行时检索服务器 URL

> ID：315516
> 
> 赞同：1
> 
> 时间：2008-11-24T21:21:17.173
> 
> 标签：url, air, adobe

我不熟悉 Adob​​e Air，我正在将文件上传到服务器。出于简单测试的目的，我将上传 URL（特别是指向 amf 通道指向的服务器上的上传目录的 URL）硬编码到代码中。adobe air 有没有办法在运行时获取此服务器 URL？

或者这个问题没有任何意义，因为有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T19:04:55.203

在我看来，您希望上传 URL 是动态的。在这种情况下，您可以使用多种方法在运行时检索此类数据。如果我是你，我会使用 XML，我将在下面说明如何这样做。

```
//THE XML - Place in same folder as the FLA and name setup.xml
<?XML version="1.0" encoding="utf-8"?>
<xml>
    <upload url="path/to/file" />
</xml> 
```

现在这是一个非常简单的 XML 文件，它可以很容易地包含背景音乐的信息、用 CDATA 包装的 CSS 格式文本或您想要保存和检索的任何其他类型的数据。

```
//The ActionScript 3.0

package
{
    import flash.display.Sprite;
    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import flash.events.Event;

    public class TestDocClass extends Sprite
    {
        private var _xml:XML;
        private var _xmlLoader:URLLoader;
        private var _xmlRequest:URLRequest;

        public function TestDocClass():void
        {
            _xmlLoader = new URLLoader();
            _xmlRequest = new URLRequest('setup.xml');
            _xmlLoader.addEventListener(Event.COMPLETE, onXMLComplete, false, 0, true);
            _xmlLoader.load(_xmlRequest);
        }
        private function onXMLComplete(e:Event):void
        {
             _xmlLoader.removeEventListener(Event.COMPLETE, onXMLComplete, false);

            //Create the XML object and insert the data.
            _xml = new XML(e.target.data);

            //Now to access the upload line we use its Namespace of "upload"
            //The @ symbol specifies we are retrieving an attribute.

            trace(_xml.upload.@url);
        }
    }
} 
```

因此，在您需要上传目的地的任何地方，您只需调用`_xml.upload.@url`或在数据到达时将变量设置为该值 ( `var uploadURL:String = _xml.upload.@url`)。

# java - 有没有比这段代码更优雅的方式将 XML 文档转换为 Java 中的字符串？

> ID：315517
> 
> 赞同：70
> 
> 时间：2008-11-24T21:21:30.107
> 
> 标签：java, xml

这是当前使用的代码。

```
public String getStringFromDoc(org.w3c.dom.Document doc)    {
        try
        {
           DOMSource domSource = new DOMSource(doc);
           StringWriter writer = new StringWriter();
           StreamResult result = new StreamResult(writer);
           TransformerFactory tf = TransformerFactory.newInstance();
           Transformer transformer = tf.newTransformer();
           transformer.transform(domSource, result);
           writer.flush();
           return writer.toString();
        }
        catch(TransformerException ex)
        {
           ex.printStackTrace();
           return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-11-24T21:58:55.757

依赖[DOM Level3 加载/保存](http://www.w3.org/TR/DOM-Level-3-LS/load-save.html)：

```
public String getStringFromDoc(org.w3c.dom.Document doc)    {
    DOMImplementationLS domImplementation = (DOMImplementationLS) doc.getImplementation();
    LSSerializer lsSerializer = domImplementation.createLSSerializer();
    return lsSerializer.writeToString(doc);   
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T21:35:38.863

转换器 API 是从 DOM 对象转换为序列化表单（在本例中为字符串）的唯一 XML 标准方法。作为标准，我的意思是 SUN [Java XML API for XML Processing](http://en.wikipedia.org/wiki/Java_API_for_XML_Processing)。

[Xerces XMLSerializer](http://xerces.apache.org/xerces-j/apiDocs/org/apache/xml/serialize/XMLSerializer.html)或 JDOM [XMLOutputter](http://www.jdom.org/docs/apidocs/org/jdom/output/XMLOutputter.html)等其他替代方法是更直接的方法（代码更少），但它们是特定于框架的。

在我看来，您使用的方式是最优雅和最便携的。通过使用标准 XML Java API，您可以插入您选择的 XML-Parser 或 XML-Transformer，而无需更改代码（与 JDBC 驱动程序相同）。还有比这更优雅的吗？

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-24T21:37:04.630

这更简洁一点：

```
try {
    Transformer transformer = TransformerFactory.newInstance().newTransformer();
    StreamResult result = new StreamResult(new StringWriter());
    DOMSource source = new DOMSource(doc);
    transformer.transform(source, result);
    return result.getWriter().toString();
} catch(TransformerException ex) {
    ex.printStackTrace();
    return null;
} 
```

否则，您可以使用 Apache 的 XMLSerializer 之类的库：

```
//Serialize DOM
OutputFormat format    = new OutputFormat (doc); 
// as a String
StringWriter stringOut = new StringWriter ();    
XMLSerializer serial   = new XMLSerializer (stringOut,format);
serial.serialize(doc);
// Display the XML
System.out.println(stringOut.toString()); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-24T21:39:40.570

你可以使用[XOM](http://xom.nu/)：

```
org.w3c.dom.Document domDocument = ...;
nu.xom.Document xomDocument = 
    nu.xom.converters.DOMConverter.convert(domDocument);
String xml = xomDocument.toXML(); 
```

你可以使用[Jsoup](https://jsoup.org/)：

```
org.jsoup.helper.W3CDom converter = new W3CDom();
String html = converter.asString( domDocument ); 
```

# .net - PowerShell：如何查询 AD 和交换邮箱大小

> ID：315518
> 
> 赞同：0
> 
> 时间：2008-11-24T21:21:34.867
> 
> 标签：.net, powershell, active-directory, exchange-server, exchange-server-2007

我最近才发现 Exchange server2007 将不再支持 WMI，即使用`\ROOT\MicrosoftExchangeV2`.

我编写的旧脚本将 ServerName、StorageGroupName、Storename、MailboxDisplayName、Size、TotalItems、DeletedMessageSizeExtended 字段输出到 CSV 文本文件。

我将如何在 PowerShell 中执行此操作？

我发现您可以在运行的 2007 Exchange 管理控制台中执行此操作

```
Get-MailboxStatistics | FT database, DisplayName, ItemCount, TotalItemSize |
Out-File textfile1.txt 
```

这会产生一些交换字段。如何为 Exchange 数据库中的同一用户生成其余的 Active Directory 字段，例如在 Active Directory 中找到的描述和 Office 字段，并将其输出到 txt 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:37:43.133

顺便说一句...根据您希望如何格式化此信息，最好编写一个获取用户信息的函数，然后是 Exchange 信息，然后将它们组合成一个自定义对象。然后，PowerShell 可以以各种方式为您输出和格式化它。[我在http://technet.microsoft.com/en-us/magazine/dd228985.aspx](http://technet.microsoft.com/en-us/magazine/dd228985.aspx)上的 PowerShell 专栏正是如此 - 将来自多个位置的信息组合到合并的输出中。我在 ConcentratedTech.com 上也有一些关于该主题的博客文章（我认为在搜索中查找“进化”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:47:40.250

我想到了..

它就像这样简单

Get-User |选择姓名、办公室

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:35:28.630

Quest PowerShell cmdlet (quest.com/powershell) 可能是最好的方法。您可以使用 Get-QADUser -IncludeAllProperties 来获取用户的所有 AD 属性，包括 Office、Description 等。请记住，拥有此信息的是 AD，而不是 Exchange。

Exchange cmdlet (Get-Mailbox) 将为您获取一定数量的信息，但 Exchange cmdlet 确实尽可能只关注 Exchange 位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T22:31:18.703

您还可以使用 Get-User 交换 cmdlet 来获取用户 AD 属性的部分列表：

PS > 获取用户 | 获取成员

# coding-style - 编码风格...首先还是最后一个错误条件？

> ID：315519
> 
> 赞同：13
> 
> 时间：2008-11-24T21:22:03.710
> 
> 标签：coding-style

就排序而言，哪个更好？您将故障条件放在顶部还是底部？

```
if (noProblems == true) {
    // do stuff
} else {
    // deal with problem
} 
```

或者

```
if (noProblems == false) {
    // deal with problem
} else {
    // do stuff
} 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-24T21:23:48.510

我喜欢首先消除错误情况 - 并尽早从函数返回，以便“快乐路径”保持未嵌套，例如

```
if (some error condition)
{
    //handle it
    return;
}
//implicit else for happy path
... 
```

如果很容易确定通向幸福道路的条件，那么一定要把该子句放在第一位（感谢 Marcin！）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T21:42:53.637

也许这取决于语言约定或其他因素，但我觉得名义案例应该在顶部，分支应该包含异常条件。它使代码更容易阅读。当有许多异常情况时尤其如此，而且在大多数情况下都有。您将能够轻松地假设作者希望大多数时间都采用这条特定的路径，并且通过这种方式更容易理解代码。

从“代码完整，第 2 版”第 15.1 节：

通过将最常见的情况放在首位，您可以最大限度地减少人们必须阅读以找到常见情况的异常情况处理代码的数量。**您可以提高效率，因为您可以最大限度地减少代码为查找最常见情况而进行的测试次数。**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T21:24:06.513

如果它有 1 或 2 行并且提前返回，我会把它放在顶部——特别是如果它位于函数的开头。这几乎读起来像一份合同。否则，我会遵循“消极条件之前的积极条件”规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T21:26:51.827

这取决于你对什么更清楚。我的意思是，更有意义的是，noProblems 具有真实价值或具有虚假价值。

例如，对于 isDeviceEnabled()，我总是会检查真实结果，因为“启用”隐含一个正值。对于隐含的负值，我们可以检查例如“isMemoryAvailable()”，可能是因为您只需要检查没有更多空间容纳新对象/数组或其他数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T21:29:01.043

这是一种非常个人化的决定，但我倾向于将我的错误条件放在首位，假装将类似代码组合在一起。也就是说，如果我做了某事，但它失败了，那么检查失败实际上是做某事的一部分；如果我在我的代码的开头放置基于它的失败检查和操作，我已经将我的操作和对该操作的复杂响应组合在一起（假设失败结果实际上是一个更复杂的返回案例比成功）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T21:30:39.760

第一个对我来说似乎更可取，因为它避免了条件中的双重否定。

除此之外，你已经构建了一些你不能真正做到的东西

```
// do stuff 
```

您先请

```
// deal with problem 
```

所以除此之外，一个似乎和另一个一样好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T21:34:36.960

与**try/catch**一样，我执行正常流程，然后处理异常情况。

这并不意味着错误检查/清理不会首先发生，但那是如果我不相信传递给我的内容。

例如，

```
if (foo is null) then
    // bail
end if

if (bar == foo) then
    // foo hasn't been changed... print the regular report
else
    // foo has changed, run the reconciliation report instead.
end if 
```

我喜欢快乐的故事像一条直线一样流动，而不幸的故事则顺其自然。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T21:49:12.283

为什么不从函数中创建一个退出点并在那里进行适当的清理而不是多次返回...

```
 DWORD bRetVal= TRUE;
if(foo is null) 
{
   bRetVal = FALSE;
   goto Error;
}
else
{
// do something
}

Exit:
 return bRetVal; 

```

# handle - ShellExecute() 的句柄 - 父窗口？

> ID：315527
> 
> 赞同：3
> 
> 时间：2008-11-24T21:24:39.570
> 
> 标签：handle, shellexecute

我正在尝试使用[ShellExecute](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)在 Excel 中打开文件。我在 MSDN 论坛上阅读了有关该功能的信息，并找到了有关句柄的以下信息，这是第一个参数：

“hwnd [in] 用于显示用户界面 (UI) 或错误消息的所有者窗口的句柄。如果操作与窗口无关，则此值可以为 NULL。”

我还听说这被称为父窗口的句柄。什么是父/所有者窗口？正如您在下面看到的，我使用 NULL 作为句柄，但由于操作确实与窗口相关联，我可能需要一个句柄，但我不知道该句柄使用什么。

```
ShellExecute(NULL, "open" ,"Excel.exe", 
    "C:\\Documents and Settings\\Lab1\\My Documents\\Test.xls", 
    NULL, SW_SHOWNORMAL); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T21:32:51.427

通常[为 0](http://www.oehive.org/node/521)

> hwnd ：将接收可能的消息框的父窗口。该参数通常为 0。

它指的是顶级窗口：您正在打开的窗口没有任何父窗口，并且是正在执行的应用程序的主窗口。

当您在应用程序之间切换 (ALT-TAB) 时，您将按 z 顺序显示下一个顶级窗口（下一个父句柄等于 0 的应用程序）（例如）。

当然，您的应用程序的父级[不能是桌面窗口本身](http://blogs.msdn.com/oldnewthing/archive/2004/02/24/79212.aspx)：

> 如果您创建一个父窗口为 GetDesktopWindow() 的子窗口，则您的窗口现在粘在桌面窗口上。如果您的窗口随后调用 MessageBox() 之类的东西，那么这是一个模态对话框，然后上面的规则就会启动，桌面会被禁用，机器会吐司。

对于路径，我建议在简单引号周围使用双引号：`" ' ... ' "`

```
"'C:\\Documents and Settings\\Lab1\\My Documents\\Test.xls'" 
```

也可以使用双双引号（未经测试）：`" "" ... "" "`

```
"""C:\\Documents and Settings\\Lab1\\My Documents\\Test.xls""" 
```

，如[this thread](http://www.tech-archive.net/Archive/Access/microsoft.public.access.formscoding/2007-05/msg01211.html)所示。

* * *

实际上，正如 Andy 和 Mesidin 在您[的](https://stackoverflow.com/users/3857/andy)另一个[问题](https://stackoverflow.com/users/454/mesidin)[中](https://stackoverflow.com/questions/310031)以及在[ShellExecute Function 手册](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)中所提到的，您可以打开文件，并在参数中传递其路径。

```
ShellExecute( NULL, "open", 
              "Test.xls", "C:\\Documents and Settings\\Lab1\\My Documents\\", 
              NULL, SW_SHOWNORMAL); 
```

这意味着 Excel 是打开 .xls 扩展文件的默认应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T22:59:08.040

当您看到它被描述为“父窗口句柄”时，这意味着它将*成为*该函数选择显示的任何 UI 的父窗口。在您调用时，您传递的句柄可能已经或可能不是其他窗口的父级`ShellExecute`，但这并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T23:29:15.340

你为什么专门ShellExecuting Excel？如果他们有 OpenOffice.org，他们就坏了——你真的应该在电子表格文件上调用“打开”动词，你不需要在“Excel”名称中硬编码，这就是 ShellExecute 的用途。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T23:16:03.043

有什么具体原因，您使用的是 ShellExecute 吗？

您可以使用 [System.Diagnostics.]Process.Start [文件名] 打开 xls 文件
抱歉，我没有查看标签并假设您使用的是 .net

# javascript - 雅虎地图 api，3.8 版不显示自定义图像？

> ID：315532
> 
> 赞同：0
> 
> 时间：2008-11-24T21:25:57.587
> 
> 标签：javascript, yahoo-api, yahoo-maps

我使用以下代码在 Yahoo Maps 上显示自定义标记：

```
<Script type=text/javascript>
  var map=new YMap(document.getElementById('map'));                                                                  // Create a map object
  Get_Lat_Lon()                                                                                                      // 
  var myPoint=new YGeoPoint(Lat,Lon);                                                                                // Create a lat/lon object
  map.addPanControl();                                                                                               // Add a pan control
  map.drawZoomAndCenter(myPoint,16);                                                                                 // Display the map centered on a latitude and longitude
  map.setMapType(YAHOO_MAP_REG);                                                                                     // Set map type to either of: YAHOO_MAP_SAT YAHOO_MAP_HYB YAHOO_MAP_REG
  var myMapTypes = map.getMapTypes();                                                                                // Get valid map types, returns array [YAHOO_MAP_REG, YAHOO_MAP_SAT, YAHOO_MAP_HYB]
  var myImage = new YImage();                                                                                        // Create Custom Marker_Image
  myImage.src = 'C:/Dir_Data/Center_Image.png';                                                                                                  // Specify image url
  myImage.size = new YSize(10,10);                                                                                   // Set image size
  var marker = new YMarker(myPoint,myImage);                                                                                                       // Create a marker positioned at a lat/lon
  marker.addLabel("<Font Size=1>Here</Font>");                                                                                                    // Add a label to the marker
  var Location_Image = new YImage();                                                                                 // Create Custom Marker_Image
  Location_Image.src = 'C:/Dir_Data/Sample_Image.png';                                                               // Specify image url
  Location_Image.size = new YSize(6,6);                                                                              // Set image size
  var marker_0 = new YMarker(new YGeoPoint(12.4567890,-12.456789),Location_Image);                                   // Create a marker positioned at a lat/lon
  marker_0.addLabel("<Font Size=1>AAA</Font>");                                                                      // Add a label to the marker
  marker_0.addAutoExpand("<Html><Center>[ A-Id :  ]<Br>AAA</Center></Html>");                                        // Add a mouse over label to the marker
  var markup_0 = "Lat = 12.4567890<Br>Lon = -12.456789";                                                               // Add a markup label to the marker
  YEvent.Capture(marker_0,EventsList.MouseClick,function(){ marker_0.openSmartWindow(markup_0); });                  //
  map.addOverlay(marker_0);                                                                                          // Display the marker
  var Location_Image = new YImage();                                                                                 // Create Custom Marker_Image
  Location_Image.src = 'C:/Dir_Data/Sample_Image.png';                                                               // Specify image url
  Location_Image.size = new YSize(6,6);                                                                              // Set image size
  var marker_1 = new YMarker(new YGeoPoint(-8.253114,33.808793),Location_Image);                                   // Create a marker positioned at a lat/lon
  marker_1.addLabel("<Font Size=1>BBB</Font>");                                                                      // Add a label to the marker
  marker_1.addAutoExpand("<Html><Center>[ B-Id :  ]<Br>BBB</Center></Html>");                                        // Add a mouse over label to the marker
  var markup_1 = "Lat = -8.253114<Br>Lon = 33.808793";                                                               // Add a markup label to the marker
  YEvent.Capture(marker_1,EventsList.MouseClick,function(){ marker_1.openSmartWindow(markup_1); });                  //
  map.addOverlay(marker_1);                                                                                          // Display the marker
  var Location_Image = new YImage();                                                                                 // Create Custom Marker_Image
  Location_Image.src = 'C:/Dir_Data/Sample_Image.png';                                                               // Specify image url
  Location_Image.size = new YSize(5,5);                                                                              // Set image size
  var marker_2 = new YMarker(new YGeoPoint(70,80),Location_Image);                                   // Create a marker positioned at a lat/lon
  marker_2.addLabel("<Font Size=1>CCC</Font>");                                                                      // Add a label to the marker
  marker_2.addAutoExpand("<Html><Center>[ C-Id :  ]<Br>CCC</Center></Html>");                                        // Add a mouse over label to the marker
  var markup_2 = "Lat = 70<Br>Lon = 80";                                                               // Add a markup label to the marker
  YEvent.Capture(marker_2,EventsList.MouseClick,function(){ marker_2.openSmartWindow(markup_2); });                  //
  map.addOverlay(marker_2);                                                                                          // Display the marker
  var Location_Image = new YImage();                                                                                 // Create Custom Marker_Image
  Location_Image.src = 'C:/Dir_Data/Sample_Image.png';                                                               // Specify image url
  Location_Image.size = new YSize(3,3);                                                                              
......
</Script> 
```

它曾经可以正常工作：

`<Script Type=text/javascript Src=http://api.maps.yahoo.com/ajaxymap?v=3.0&appid=`

我可以在地图上看到我的自定义图像（一个色点）。现在有了：

```
<Script Type=text/javascript Src=http://api.maps.yahoo.com/ajaxymap?v=3.8&appid= 
```

我的自定义图像没有显示，3.0 版和 3.8 版似乎有区别，我该怎么做才能修复它？

坦率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T19:53:30.457

如果添加marker.addAutoExpand("为此效果添加标签到标记"); 在marker.addLabel（“Y”）之前；它会起作用的。顺便说一句，我使用 v3.8

# c# - 科学数据可视化和 .NET 框架

> ID：315533
> 
> 赞同：13
> 
> 时间：2008-11-24T21:26:49.020
> 
> 标签：c#, .net, f#, ironpython, data-visualization

我花了很长时间寻找可以将类似于 matplotlib 的功能引入 .NET 框架的产品。据我所知，没有什么真正符合标准的。这是一个准确的评估吗？这是我发现的：

商业的：

*   图表外汇
*   邓达斯
*   KitWare 的 ActiViz（基本上是 VTK 的托管版本）

开源：

*   绘图
*   CodePlex 上的各种项目，尤其是 VSLab

我认为拥有一个能够以交互方式绘制来自 F# 和 IronPython 等语言的数据的能力的 .NET 项目将非常有价值。有人知道这样的项目吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T11:09:20.343

你也可以看看[F# for Visualization](http://www.ffconsultancy.com/products/fsharp_for_visualization/index.html)，我有测试版，它对于一些基本的东西非常好 - 如果你想要更多地控制演示文稿，它还不是很好。

另一种可能性（我还没有尝试过，但我打算很快尝试）是[Microsoft Chart Controls](http://www.microsoft.com/downloads/details.aspx?familyid=130F7986-BF49-4FE5-9CA8-910AE6EA442C&displaylang=en)（以前称为 Dundas...），它已独立于 SQL Server 发布。[这里](http://thevalerios.net/matt/2008/11/using-the-microsoft-charting-library-from-f/)有一篇关于在 F# 中使用它们的文章 - 正如您将从示例代码中看到的那样，您可以更好地控制演示文稿，但这是有代价的......

**更新**我确实最终尝试了 Microsoft Chart Controls，老实说，它把 F# for Visualization 吹到了水里（对不起，乔恩！）。然而，Luca Bolognese 更进一步，制作了一个[非常有用的包装器](http://lucabolognese.wordpress.com/2010/02/17/lchart-displaying-charts-in-f-part-ii/)。油漆还是湿的，但绝对值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T16:58:50.713

VTK [http://www.vtk.org/](http://www.vtk.org/)是一个非常强大的开源科学可视化工具。我不完全清楚您是否认为它“不合格”是因为您想做一些它不能做的事情，或者您只是想能够从您选择的语言中调用。我不相信你提到的语言有绑定，但我想用你选择的语言包装 VTK 的项目比从头开始编写可视化工具更有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T21:50:24.120

我不确定它是否具备科学工作所需的所有功能，但我对[Zedgraph](http://zedgraph.org/wiki/index.php?title=Main_Page)总体上很满意。它稳定、强大且非常易于使用，而且图表看起来很棒！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T22:12:06.840

在[Resolver Systems](http://www.resolversystems.com)，我们正在开发一个名为[Ironclad](http://code.google.com/p/ironclad)的项目，最终（希望）允许您从 IronPython 透明地使用 matplotlib 和 numpy 等 cPython 扩展。

目前我们专注于 numpy（现在大部分都可以使用），但 matplotlib 和它的朋友们也在名单上。

这是一个开源项目，我们可以在帮助下完成。你应该看看它是否有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-21T23:43:24.527

[F# for Visualization](http://www.ffconsultancy.com/products/fsharp_for_visualization/?so)专为此目的而设计。

# .net - 针对 x86 的 .NET EXE 能否在 AMD 芯片上运行？

> ID：315537
> 
> 赞同：1
> 
> 时间：2008-11-24T21:28:50.000
> 
> 标签：.net, x86, amd-processor

如果我的 .NET 应用程序以 x86 平台为目标，它会在 AMD 芯片上正常运行吗？我知道它可以与 Intel 芯片一起使用，而且 Vista 64 能够以特殊模式运行 x86 应用程序，但我不知道其中有多少是硬件，有多少是操作系统。

我已经用 Intel 芯片在 Vista 64 上对其进行了测试，它运行良好，但我没有 AMD 机器来测试。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T21:30:22.197

是的 - 它们是二进制兼容的，否则它们不会成为彼此的替代品:)

除非您的意思是 IA64 与 AMD64 - 它们是不兼容的架构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T21:34:02.907

是的，它可以工作，但是它将作为 32 位进程而不是 64 位进程运行。抽象层是通过引入子系统在操作系统级别完成的。它被称为 Wow64（Windows 64 上的 Windows）。这允许 32 位进程在 64 位机器上本地运行。

如果您进行低级内核集成，它只会崩溃。可能是您没有使用 .Net 应用程序做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:31:08.903

它会正常工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T21:31:43.067

这与 Intel 或 AMD 无关，它适用于相同硬件架构的所有品牌。32 位应用程序可以在 32 位操作系统和 64 位操作系统上运行。64 位应用程序只能在 64 位操作系统（和 64 位硬件）上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T21:33:02.627

这里的关键是 .NET 代码以 CLR 为目标，因此任何处理器级别的问题都应该在那里解决……我不确定这一点，但我相信 x86 / 64 的 CLR 有多个版本。

# methods - 即使在这种情况下，每个方法也只有一个返回语句？

> ID：315546
> 
> 赞同：12
> 
> 时间：2008-11-24T21:31:08.963
> 
> 标签：methods, return

我喜欢每个方法只有一个`return`语句的想法。

在这种情况下你会怎么做？

```
public static string ChopText(string Text)
{
   if (String.IsNullOrEmpty(Text))
   {
      // return here ?????
   }
} 
```

我能想到的唯一选择是设置一个标志，然后检查标志。

**问题是，我不喜欢跨越超过一页的巨大 if 语句。** 因此，我还看到了丑陋的嵌套 if 语句。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-24T21:35:17.600

[用保护子句替换嵌套条件](http://martinfowler.com/refactoring/catalog/replaceNestedConditionalWithGuardClauses.html)是可以的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-24T21:33:33.080

坦率地说，像这样的情况就是过于严格的规则不好的原因。

像这样的规则的重点是使代码更具可读性和可维护性，因此当它们使代码更难阅读时，它们应该被忽略。

这并不意味着应该完全放弃该规则，因为大多数时候它确实使代码更具可读性。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-24T21:40:00.443

试图每个函数只有一个返回值的代码要复杂得多。它通常是 if-thens 和 assignments 的老鼠窝。我挑战你看看那种代码，并知道正确的值总是从那些不同的路径返回。没门。

话虽如此，大型函数表明您可能需要将代码重构为更小的更简单的函数。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-24T21:34:10.987

我个人认为

```
public static string ChopText(string Text))
{
   if(String.IsNullOrEmpty(Text)
      return Text;

   ...
} 
```

完全没问题，如果你不喜欢那些，如果它变大了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T21:36:04.523

这是应该忽略规则的情况。如果传入的参数格式不正确，通常在方法的入口点有几个保护子句返回或抛出 ArgumentException。只需将这些语句集中在方法的开头即可。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-24T21:37:30.980

“我喜欢每个方法只有 1 个返回语句的想法。” 解释？

一旦知道传递给方法的参数无效，就应该返回或抛出异常。

坏的：

```
if (Valid) { do lots of stuff}
else {return}; 
```

干净的：

```
if (invalid) { return; }
if (invalid2) {return; } 
```

另一种方法：

```
if (invalid) {
     throws IllegalArgumentException(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T21:35:41.937

你真的必须权衡做这样的事情的成本和收益。只有一个 return 语句的好处会超过必须扭曲一个应该相当简单编写的方法的缺点吗？

对于这种情况，我不同意。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-24T21:46:26.283

除了例外，无论如何都不再有“单进单出”规则，因此绝对没有必要遵循严格的“单次返回声明”规则。理论上，控制流可以通过抛出异常和展开堆栈随时退出函数，因此即使您实施严格的“单入口 - 单出口”策略，也不能保证它会被完全遵循。

如果适合您，请随时退出功能！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T22:10:41.710

一般而言，您的方法不应跨越“一个屏幕”。如果他们这样做，您应该（通常再次）尝试将它们分成几种方法。这可能比“只有一个退货声明”重要得多......

毕竟，我们正在寻找的是可读性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T22:06:42.247

我坚信“一进一出”，除了在函数顶部验证输入。不过，这必须在函数的真正工作开始之前发生。

我认为这条规则旨在阻止人们仅仅因为他们认为他们已经“完成”而退出正在做实际工作的代码中间。

多次返回的问题是您不能确定是否会执行所需的退出处理，例如关闭套接字或释放一些其他资源。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-04-07T13:14:47.173

```
 public static string ChopText(string Text)
{
   string returnString = "";
   if(String.IsNullOrEmpty(Text))
   {
      returnString = "return string text";
   }
   return returnString;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-24T21:56:54.887

规则已经过时了。干净利落。它的存在是为了帮助糟糕的程序员编写更具可读性的代码……结果适得其反。使您的代码小而易读，并摆脱那个愚蠢的规则。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-13T03:30:28.030

我强烈不同意“一进一出”导致代码复杂的想法。我刚刚用 Java 为 Blackberry 和 Android 手机编写了一个应用程序，它包含大约 100 个文件，并且没有一个方法最终不会退出。虽然它是一个 GUI 应用程序和多线程，但代码并不复杂。很少有例程在屏幕上不完整可见。除了少数几种语言和操作系统，我已经设计和编写软件 46 年了，对我来说，“一进一出”使得代码非常简单、易于阅读和维护。我的价值 0.02 美元。对不起，如果我激怒了任何羽毛。

# javascript - javascript document.write 在外部 js 文件中

> ID：315552
> 
> 赞同：9
> 
> 时间：2008-11-24T21:31:53.893
> 
> 标签：javascript, double-click, banner, document.write

在从事大型、高负载的项目时，我遇到了论坛和博客上已经在数十亿个主题中描述的问题，但没有解决方案对我的情况有帮助。这是故事。

我有横幅的HTML代码，我不知道代码是什么。有时它是纯 HTML，但有时它是`<script>`带有 document.write的`<script>`标签，其中带有 src 的标签，可以在其中双击网络。

所以我们有：脚本 > document.write > 脚本（双击）。

双击网络，您可能知道，也使用 document.write 并且大多数时候他们提供需要加载更多 js 文件的 flash 横幅。

所以毕竟我们有： script > document.write > script(doubleclick) > document.write > script > ...

当您直接将它放在 HTML 中时，这很有效。页面渲染1部分，加载banner1，继续渲染页面，加载banner2，完成页面渲染。

但是现在我需要先渲染页面，并且只有在加载横幅之后。作为横幅使用 document.write 我需要在 window.onload 事件之前加载它（注意：在 window.onload document.write 之后将重写整个文档。）

我做了什么：

在头部分我有一个横幅对象（真正的命名空间类型很大:)），具有属性范围。

当页面渲染和横幅代码相遇时，我将横幅的代码放入范围并放置`<div id="bannerPlaceHolder"+id></div>`——所以这里我稍后需要放置横幅内容

页面呈现和`</body>`标记之前，我将`<script>banners.load()</script>`banners.load 方法对范围数组中的每个项目执行此操作：

```
document.write('<div id="codeHolder'+id+'">');
document.write(bannerCode);
document.write('</div>'); 
```

只有在此之后，我才有`window.onload()`这样做的事件：

获取所有横幅codeHolders并逐个节点将其节点从codeHolder附加到placeHolder，因此结果我在渲染页面后加载了横幅并且横幅位于正确的位置。

除了 IE 之外，一切都很完美，它会加载以异步方式动态放入 DOM 的任何 js 脚本，因此双击脚本中的 document.write 会将节点附加到文档的末尾，而不是在我的 codeHolder 节点中。像往常一样，它只在 IE 中。

我将非常感谢任何可能知道解决方案的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-29T16:36:11.800

您需要[writeCapture.js](http://github.com/iamnoah/writeCapture)（完全披露：我是作者。）所有赌注都与 3rd 方脚本无关。今天他们`document.write`用来生成一些特定的 HTML，但明天他们可以改变它，任何基于替换的简单黑客`document.write`都需要更新。writeCapture 负责处理。您的用法将类似于：

```
$('#bannerPlaceHolder').writeCapture().html('<script type="text/javascript" src="http://doubleclick.net/bannerCode.js"></script>'); 
```

该库可以处理任意深度的脚本标签，并且可以很好地处理穿插的 HTML。如果你不使用 jQuery，它也有一个独立的构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:55:12.670

通常使用横幅，您会知道确切的尺寸和位置，那么如何动态创建一个 iframe，其内容就是您在 bannerCode 中拥有的内容，仅此而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:16:11.937

将其加载到隐藏的（大小 0x0）iframe 中，然后使用 javascript 将其移动到其他位置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T21:37:03.273

也许您可以使用属性 innerHTML： document.getElementById("x").innerHTML="..................";

或者你可以使用 DOM：CreateElement 和 AppendChild

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T13:54:03.707

我认为 iframe 解决方案很丑陋。为什么不能将横幅加载到单独的页面中并将它们 AJAX 加载到 DIV 中？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-23T13:26:40.100

将 document.write() 调用拆分为单独的标签，因此输出应如下所示：

document.write(''); document.write(bannerCode);

document.write('');

IE 将等待 document.write(bannerCode) 准备好以及何时写入结束标签。

# vb.net - 如何覆盖 WinForm 最小化和最大化按钮的背景颜色

> ID：315566
> 
> 赞同：1
> 
> 时间：2008-11-24T21:35:07.053
> 
> 标签：vb.net, winforms

是否可以覆盖 WinForms 中最小化和最大化按钮的背景颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:40:21.147

并非没有编写自己的 NC_PAINT ，这本身就是非常糟糕的做法。

你永远不知道用户何时会使用一种从未听说过的新视觉风格。您的应用程序将在现有样式上显示旧的丑陋按钮，一切都会发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T21:40:40.397

你不能轻易做到。

最好的选择是： http: [//geekswithblogs.net/kobush/articles/CustomBorderForms3.aspx](http://geekswithblogs.net/kobush/articles/CustomBorderForms3.aspx)

您可以在此处找到更多答案： [WinForms 应用程序中的自定义标题栏/镶边](https://stackoverflow.com/questions/42460/custom-titlebarschrome-in-a-winforms-app)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T21:41:55.010

简短的版本是开箱即用的，我不知道。

更长的版本是没有什么能阻止您创建无边界表单，然后在其上创建自己的 [minimize|restore]/maximize/close 按钮​​。您必须绘制自己的表单标题栏，并基本上承担在屏幕上移动的所有魔力等，但这并非不可能。

[以 Code Maverick](http://codemaverick.blogspot.com/2007/02/creating-custom-winforms-in-net-20-yes.html)的这篇文章为起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T22:02:20.867

我曾经尝试过类似的事情。这花了太多时间，而且那里有很多第三方控件。我使用以下[Krypton Toolkit](http://www.componentfactory.com/)，它很棒而且该工具包是免费的。

# sharepoint - TFS 2005 维基模板？

> ID：315576
> 
> 赞同：1
> 
> 时间：2008-11-24T21:36:44.693
> 
> 标签：sharepoint, visual-studio-2005, tfs, wiki

是否有 TFS 2005 的 Wiki 插件，即。共享服务 2.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T13:31:14.053

这里有一个：http: [//www.neoworks.com/products/sharepoint/wikipoint/index.html](http://www.neoworks.com/products/sharepoint/wikipoint/index.html) 我不知道它有多好，但你可以安装一个演示并尝试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:22:47.490

如果您升级到 TFS2008，那么您可以使用包含基本 Wiki 功能的 Sharepoint Services 3.0 门户。升级到 TFS2008 的原因还有很多（错误更少、速度更快、功能更多、与 VS2005 向后兼容等），但我只是想提一下。

# project-management - Scrum 和 Fogbugz

> ID：315585
> 
> 赞同：23
> 
> 时间：2008-11-24T21:38:21.290
> 
> 标签：project-management, scrum, fogbugz

有人一起使用 Fogbugz 和 Scrum 吗？

我们广泛使用 Fogbugz，我正在寻找任何可能将它用作 Scrum 一部分的人的想法。我找到了这两个项目，但它们已存档，无法进一步讨论。我对将 Scrum 概念映射到 Fogbugz 的想法特别感兴趣。

有些事情是相当明显的。发布和冲刺很好地相互映射。但是 Scrum 的其他部分并不真正适合。

[http://support.fogcreek.com/default.asp?fogbugz.4.12143.4](http://support.fogcreek.com/default.asp?fogbugz.4.12143.4)
[http://support.fogcreek.com/default.asp?fogbugz.4.19971.3](http://support.fogcreek.com/default.asp?fogbugz.4.19971.3)

~~我还认为创建一些轻量级的自定义东西来包裹 Fogbugz 可能并不难，这样我们就不必为了改进我们的软件流程集成而放弃我们最喜欢的工具之一。~~

**编辑：**

我正在添加一些更具体的问题。对这些项目的任何建议都会有所帮助：

*   ~~我们如何对只有 Fogbugz 提供的 7 个优先级的大量积压工作进行优先级排序？我们可以修改数据库表以添加更多级别，但这在当前/预期的 Fogbugz 模型中是否合适？~~
*   我们如何/在哪里记录冲刺目标？
*   我们如何记录取消的冲刺？
*   我们如何记录冲刺评审？
*   我们如何跟踪已完成或取消的冲刺？

**编辑#2：**

Chris 下面的回复提醒了我，我们确实升级到了 Fogbugz v7。它具有许多与敏捷、Scrum 和精益更紧密结合的强大功能，包括：

*   项目积压（通过插件）
*   自定义工作流程
*   燃尽图
*   看板（通过插件）

有关详细信息，请参阅以下链接：
[http ://www.fogcreek.com/FogBugz/WhatsNew.html](http://www.fogcreek.com/FogBugz/WhatsNew.html)
[http://www.fogcreek.com/FogBugz/Plugins/default.aspx?ixCategory=-3](http://www.fogcreek.com/FogBugz/Plugins/default.aspx?ixCategory=-3)

**编辑 #3** 添加 Perhentian 在他的回答中提到的链接以及我发现的另一个链接：

[http://www.danielroot.info/2009/08/how-to-apply-scrum-using-fogbugz-7.html](http://www.danielroot.info/2009/08/how-to-apply-scrum-using-fogbugz-7.html)
[http://www.fogcreek.com/FogBugz/blog/post/Scrum-Friendly-Features .aspx](http://www.fogcreek.com/FogBugz/blog/post/Scrum-Friendly-Features.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-03T19:36:14.760

FogBugz 现在（从版本 7 开始）支持插件，这应该使它更容易与 Scrum 一起使用。

[敏捷/Scrum 工具](http://www.fogcreek.com/FogBUGZ/LearnMore.html?section=AgileScrum)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-15T16:03:01.320

我们已经使用 FB***很长时间***了，但最近开始正式确定我们对 Scrum 的使用。

发现以下内容很有帮助：

1.  为每个 Scrum sprint 使用一个标签。
2.  sprint 标签被输入到该 sprint 中的每个 FB 案例中。
3.  我们有一个名为“Scrum Sprint Reports”的 Wiki
4.  在该 Wiki 中，我们为每个新的 sprint 添加一篇文章（我们按周添加）。那篇文章的标签与 sprint 的标签相同。

然后，以下事情会有所帮助：

首先，如果您只是通过标签搜索，您会发现：所有案例和特定的 Wiki 文章（即使在标题视图中也会显示目标）

其次，我们创建了两个过滤器：一个过滤器用于在列表视图中显示该 scrum 的案例，第二个过滤器用于在饼图中显示打开/关闭的案例。当你度过这一周时，你希望能吃更多的馅饼。

对此我唯一不喜欢的是，我必须每周五修改我的两个过滤器，但至少要修改 TGIF。

* * *

PS：就像提到FB Wiki Editor 比7.0 中的一个要好，但实际上应该是0.8 版本。它至少还有 2 个版本才能成为稳定的东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-29T14:15:53.337

在使用 FOGBUGZ 和 JIRA 进行敏捷之后，我认为这两种工具都不是支持模型的理想选择。你能不能让任何一个工作。是的。JIRA 实际上要好一些，因为它能够自定义更多（创建用户故事等）但是如果你真的希望你的团队处于 SCRUM 模式，你需要让每个人都查看燃尽图，每个人都查看积压工作，我认为你应该看看像 SCRUMWORKS 这样的工具。基本版本是免费的，它会给你你想要的。使用 JIRA 和 Fogbugz 来完成它们的任务，跟踪错误和请求，但不是完整的 SCRUM 管理工具。

更新：您可以在 JIRA 中使用 Greenhopper 插件，这对于支持敏捷项目会更好一些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-30T07:33:26.643

在 icanhascheezburger.com，我们使用 FogBugz，我们发现 FogBugz 在很多方面都很出色，但它在开箱即用的敏捷开发中效果不佳。以下是我们要做的两件事：

我们将讨论板用于每日 Scrum 报告，但 wiki 页面可能更适合于此，因为您可以订阅它。

我们还将优先级 7 用于积压工作。要查找所有积压案例，只需搜索：

```
priority:7 project:"project name" 
```

该 API 将使编写一个小的 scrum 客户端变得非常容易。

> [**FogBugz**看板插件****](http://www.fogcreek.com/fogbugz/plugins/plugin.aspx?sPostbackUrl=https://adwiza.fogbugz.com/?pgx=PL&sId=kanbanboard@ergonlabs.com)

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T22:37:04.697

我们目前正在基于 SCRUM 的项目中试用 FogBugz。

我们仍然非常依赖 SCRUM（和 FogBugz），所以我们所做的可能不是“纯粹的”SCRUM。

首先，我们将 Excel 用于发布积压工作，例如我们将在 x.xx 版本中交付的内容

实际上，我曾写过一篇关于使用 FogBugz 作为积压工作的博客[文章](http://jamie-rorrison.blogspot.com/2008/08/using-fogbugz-as-product-backlog.html)，但最终还是选择了 Excel，因为我的提议回想起来有点复杂，而且我认为我并没有真正获得任何东西。

在 backlog 电子表格中，我们保留了 back log 项目的名称、大小估计值，以便我们可以计算速度以及一些其他信息，例如我们将在哪个 sprint 中交付每个项目。

我们将产品规范保存在 FogBugz wiki 中，并从积压的每个条目中添加指向此的链接。

在 Fogbugz 中，我们将发布映射到 sprint，并使用计划项目来跟踪每个积压项目的任务。

在我们开始一个 sprint 之前，我们选择我们将在这个 sprint 中交付哪些 backlog 项目。在 FogBugz 中，我创建了一个新版本并将结束日期设置为两周后。然后，我们将选择的积压项目分解为任务，并将它们作为“计划项目”添加到发布中。

每个人都像往常一样使用“工作中”菜单估计自己的任务并跟踪他们的时间。团队成员每天都会修改他们的估计，然后我们可以使用各种报告来了解事情的进展情况。发货日期置信度图表为您提供了一种反向燃尽图。

团队的每个成员还有一个他们每天编辑的“状态”计划项目，以记录每日站立会议的状态报告，例如我昨天做了什么？, 我今天在做什么？我的路上有什么障碍？

如您所见，我们实际上只是使用 FogBugz 进行任务管理。

我们更多地为[EBS](http://www.joelonsoftware.com/items/2007/10/26.html)和 Wiki 选择了它。

到目前为止，它运行得很好，但我正在使用它的项目是一个 3 人 6 周的项目。

希望有些帮助。如果您需要任何澄清，请告诉我。

编辑：我也不是第一次尝试让完美的系统启动并运行。我非常喜欢尝试一些东西，如果它不起作用，那就改变它。到目前为止，FogBugz 还不错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T23:13:39.383

FogBugz 和 Scrum 充分合作。我认为你的问题很好，所以我会坚持回答这些问题......

> 我们如何对只有 Fogbugz 提供的 7 个优先级的大量积压工作进行优先级排序？我们可以修改数据库表以添加更多级别，但这在当前/预期的 Fogbugz 模型中是否合适？

恕我直言，7 太多了，无法管理，我发现前 3-4 名是可以管理的，除此之外，我不妨将所有内容归为一个“稍后”的积压工作。但是，FogBugz 文档或知识库文章偶尔会为添加了额外优先级的人提供指导，因此如果 FogBugz 不打算让您使用它，他们似乎很清楚它并基本上支持人们这样做。

> 我们如何/在哪里记录冲刺目标？我们在每个项目的 wiki 上都有一个“sprint review”页面。我们将最近的 sprint 记录在顶部，并使其成为一个巨大的页面（尽管我想我们最终会只保留最近的一年或其他时间，因为这些页面变得越来越大）。我们使用的 sprint review 很简单，并且有一组必须由团队和 PM 完成的字段。在 sprint 之前，我们记录一个目标和 SBL，在我们添加用于审查的字段之后。
> 
> 我们如何记录取消的冲刺？

在上面提到的 sprint review 页面中。

> 我们如何记录冲刺评审？我们如何跟踪已完成或取消的冲刺？

我想你现在可以猜到我们如何处理这两个 :)

我希望这对您和其他阅读者有所帮助。我们确实有一些与 FB 估计相关的fogbugz hack，我没有在这里讨论，但如果您想进一步讨论，我很乐意这样做。也许您有一些经验可以分享，我可以从中学习？

-斯科特

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-26T12:19:15.603

查看新版本的 FogBugz。这里有一篇博客文章总结了支持 Scrum 的改进。我们使用它，它对我们很有效。

[http://www.fogcreek.com/FogBugz/blog/post/Scrum-Friendly-Features.aspx](http://www.fogcreek.com/FogBugz/blog/post/Scrum-Friendly-Features.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-30T00:27:14.227

我们使用 Scrumworks 和 JIRA。

SCRUM 并没有真正涵盖您如何实施 QA/QC 程序，敏捷的一部分是能够定义、改进、迭代流程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-01T18:46:51.777

到目前为止的评论很好。我将看看 Scrumworks。我们真的很喜欢 Fogbugz 并且团队对此很满意，所以这就是为什么我想看看它是否可行。

@Stefan，链接文章中对产品积压的建议之一是，项目积压可以在 Fogbugz 中实现，方法是创建一个可分配的同名版本，不带日期、正式合同结束时的日期或远距离进入未来。您是否尝试过或对为什么您的方法可能更好有任何想法？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-01T19:14:09.223

我们将 FogBugz 用于 scrum，通过对项目 backlog 使用“发布”，然后为 sprint 创建发布，将项目从项目 backlog 发布移动到当前的 sprint 发布。每个项目都有一个估计值，我们可以从中构建一个燃尽图，如[前面的 SO question](https://stackoverflow.com/questions/213214/scrum-burndown-patterns#213307)中所示。

不，这并不理想，但效果很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-08T05:17:34.753

开源工具trac[集成了FogBugz](http://www.fogcreek.com/FogBugz/blog/post/Trac--FogBugz-integration.aspx)，Scrum部分可以使用[Agilo for Scrum](http://www.agile42.com/cms/pages/agilo/)，它基于[trac](http://trac.edgewall.org/)，全面支持Scrum。

# c# - 如何将位于我的资源文件夹中的图像放入数组中？

> ID：315590
> 
> 赞同：2
> 
> 时间：2008-11-24T21:38:43.410
> 
> 标签：c#

我想将 52 张 gif 格式的图像（卡片组）从我的资源文件夹加载到 c# 中的 Image[] 中。有任何想法吗？

谢谢，乔恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T21:45:24.613

您可以从这样的文件中读取位图；

```
 public static Bitmap GetBitmap( string filename )
  {
     Bitmap retBitmap = null;
     string path = String.Concat( BitmapDir, filename );
     if ( File.Exists( path ) )
     {
        try
        {
           retBitmap = new Bitmap( path, true );
        }
        catch { }
     }
     return retBitmap;
  } 
```

您可以像这样在资源目录中获取文件列表；

```
string[] files = Directory.GetFiles( BitmapDir, "*.gif" ); 
```

只需遍历调用 GetBitmap(file) 的文件并填充您的数组。BitmapDir 显然是 GIF 文件所在的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T21:53:44.130

假设您在本地文件系统的文件夹中有图像并且您在 .NET 3.5 下运行：

```
Image[] cards = Directory.GetFiles(cardsFolder).Select(f => Image.FromFile(f)).ToArray(); 
```

单线总是很好:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T22:13:38.893

如果你的资源没有被复制到一个文件夹，因为它们是嵌入的，你应该使用反射，一个起点就是这个（图像作为一种方法存储在资源文件中）：

```
 List<System.Drawing.Image> images = new List<System.Drawing.Image>();
        foreach (System.Reflection.MethodInfo t 
            in typeof(Resources.Resource).GetMethods())
        {
            if (t.ReturnType.ToString() == "System.Drawing.Bitmap")
            {
                images.Add(new System.Drawing.Bitmap((System.Drawing.Image)t.Invoke(null, null)));

            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T23:04:53.940

也许最好验证文件是否是图像，因为如果不是，则会引发异常：

```
 protected void MethodToBeCalled()
    {

        System.Drawing.Image[] cards = Directory.GetFiles(cardsFolder).Where(
              f =>
              {

                  if (IsImage((string)f))
                  {
                      return true ;
                  }
                  else { return false; }
              }
            ).Select(f => System.Drawing.Image.FromFile(f)).ToArray();

    }
        private bool IsImage(string filename)
    {
        string[] knownPicExtensions = {".jpg",".gif",".png",".bmp",".jpeg",".jpe" };

        foreach (string extension in knownPicExtensions)
        {
            if (filename.ToLower().EndsWith(extension))
                return true;
        }

        return false;
    } 
```

# objective-c - 如何将类名作为参数传递给可可中的对象工厂？

> ID：315591
> 
> 赞同：16
> 
> 时间：2008-11-24T21:38:55.300
> 
> 标签：objective-c, cocoa, constructor, factory

我正在开发一个对象工厂来跟踪一小部分对象。对象可以是不同的类型，但它们都会响应`createInstance`和`reset`。这些对象不能从公共基类派生，因为其中一些必须从内置的可可类派生，例如`NSView`和`NSWindowController`。

我希望能够通过简单地将所需的类名传递给我的工厂来创建任何合适对象的实例，如下所示：

```
myClass * variable = [factory makeObjectOfClass:myClass];
```

该`makeObjectOfClass:`方法看起来像这样：

```
- (id)makeObjectOfClass:(CLASSNAME)className
{
    assert([className instancesRespondToSelector:@selector(reset)]);
    id newInstance = [className createInstance];
    [managedObjects addObject:newInstance];
    return newInstance;
}
```

有没有办法将类名传递给方法，就像我`(CLASSNAME)className`对上面的参数所做的那样`makeObjectOfClass:`？

为了完整起见，这就是我要管理所有对象的原因。我希望能够通过调用`[factory reset];`.

```
- (void)reset
{
    [managedObjects makeObjectsPerformSelector:@selector(reset)];
}
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-24T21:58:45.040

您可以使用以下函数将字符串转换为类：NSClassFromString

```
Class classFromString = NSClassFromString(@"MyClass"); 
```

不过，在您的情况下，您最好直接使用 Class 对象。

```
MyClass * variable = [factory makeObjectOfClass:[MyClass class]];

- (id)makeObjectOfClass:(Class)aClass
{
    assert([aClass instancesRespondToSelector:@selector(reset)]);
    id newInstance = [aClass createInstance];
    [managedObjects addObject:newInstance];
    return newInstance;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-28T07:48:24.877

我有一个更好的教程，请查看 [https://appengineer.in/2014/03/13/send-class-name-as-a-argument-in-ios/](https://appengineer.in/2014/03/13/send-class-name-as-a-argument-in-ios/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T21:56:35.763

动态指定一个类很容易，事实上你可以通过它的名字来引用它：

```
id string = [[NSClassFromString(@"NSString") alloc] initWithString:@"Hello!"];
NSLog( @"%@", string ); 
```

另一个提示，我会避免使用命名法“托管对象”，因为大多数其他 Cocoa 程序员会将其读作 NSManagedObject，来自 Core Data。您可能还会发现使用全局 NSNotification（所有可重置对象都订阅）而不是管理不同类型对象的集合更容易，但您比我更了解做出该决定。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T22:08:33.757

其他答案中缺少的答案是您可以定义一个`@protocol`包含您的`+createInstance`和方法的`+reset`方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T21:55:14.063

听起来你想要这样的东西：

```
- (id)makeObjectOfClassNamed:(NSString *)className
{
    Class klass = NSClassFromString(className);
    assert([klass instancesRespondToSelector:@selector(reset)]);
    id newInstance = [klass createInstance];
    [managedObjects addObject:newInstance];
    return newInstance;
} 
```

这将假定一个名为 的类方法`+createInstance`。或者你可以只使用`[[klass alloc] init]`.

调用它：

```
MyClass *variable = [factory makeObjectOfClassNamed:@"MyClass"]; 
```

根据您要执行的操作，传递类对象可能比传递字符串更好，例如：

```
MyClass *variable = [factory makeObjectOfClass:[MyClass class]]; 
```

# vb.net - VB.NET：如何在运行时重新映射 Web 服务的 soap.location 属性？

> ID：315599
> 
> 赞同：2
> 
> 时间：2008-11-24T21:40:37.387
> 
> 标签：vb.net, web-services

我有一个要在多个客户端上部署的 Web 应用程序。每个客户端都将使用由第三方开发并托管在每个客户端位置的 Web 服务。每个部署的soap.location 都不同。

我希望避免对每个客户进行单独的编译。

[这篇博文](http://codebetter.com/blogs/steve.hebert/archive/2007/11/13/manually-mapping-wsdl-soap-address-location-on-the-fly.aspx)有一个潜在的解决方案，但缺少一个关键要素；如何让客户端使用派生类进行肥皂调用。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:44:58.873

检查[如何在 .NET 中动态切换 Web 服务地址而无需重新编译](https://stackoverflow.com/questions/125399/how-can-i-dynamically-switch-web-service-addresses-in-net-without-a-recompile#125424)

# apache-flex - 概念问题：松散耦合

> ID：315608
> 
> 赞同：2
> 
> 时间：2008-11-24T21:44:16.597
> 
> 标签：apache-flex, coupling, conceptual, loose

我正在构建一个图形板，例如我面临设计问题的项目。

Main Class 是 Board，它是一个画布，负责在绘制形状时处理鼠标事件。它还具有上下文变量，例如 currentShape 或 snapFlag 来激活网格磁性。

为了处理形状的移动/调整大小/旋转，它们继承自名为 ObjectHandles (flex) 的第三方开源工具。

我有一个 baseShape 扩展 ObjectHandles 主类来覆盖它的一些内部函数，比如 onMove 函数。

当创建一个形状（鼠标向下、移动、鼠标向上）时，这是由 Board 处理的，它知道他自己的 snap 标志。

var mouseUpPoint:Point = boardCanvas.globalToLocal(new Point(event.stageX, event.stageY)); var snapMouseUpPoint = snapPoint(mouseUpPoint.x, mouseUpPoint.y);

在我覆盖的 onMove 方法中，我希望形状能够了解 Board snap 标志及其变化时间。我该怎么做呢 ？

**我是否在我的 basicShape 构造函数中将 Board 作为参数传递，以便我可以检查 snap ？**

**我是否将标志作为参数传递并以某种方式使所有形状都监听变化？**

什么是最干净的解决方案？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T21:56:38.353

我会从一个稍微不同的角度来处理这个问题。我假设`Board`对象首先捕获鼠标事件，以便它可以决定单击了哪个形状。我也会让板子捕获鼠标移动，将正确的（捕捉或未捕捉的）坐标“向下”传递给选定的`Shape`对象，而不是让形状对象弄清楚。

这将网格捕捉处理留给`Board`，并使您的`Shape`对象`onMove`方法保持混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T22:26:45.123

不知道您的应用程序：

形状是否有可能拥有自己的“捕捉”行为？也就是说，是否可以将 Shape 排除在捕捉之外，而其他形状则不能？如果是这样，使 snapFlag 成为 Shape 的成员。在板上设置 snapFlag 时，遍历您的 Shapes 并根据您的规则设置或不设置。

如果吸附行为适用于板上的所有形状，请考虑使用事件驱动模型（如果可用 - 我是 Flex 菜鸟）。当 Shape 移动时，让它引发 OnMove 事件。然后，董事会可以做出回应并决定在合适的情况下将形状“卡入”到位。

如果快照行为适用于所有形状并且事件不可用，我只想说在这种情况下松散耦合的地狱 - 让形状板感知。听起来您正在使用 ObjectHandle 保存一堆代码。这种好处可能会超过耦合 UI 元素的成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T09:35:44.837

以这种方式解决它：

由于我在我的 baseShape 类中覆盖了 onMouseMove 并且我使用的是 PureMVC 框架，所以我只是让 baseShape 知道我的 boardMediator。

覆盖受保护的函数 onMouseMove(event:MouseEvent) : void { [...]

```
// added on override
var board:BoardMediator = ApplicationFacade.getInstance().retrieveMediator(BoardMediator.NAME) as BoardMediator; 
```

然后

```
desiredPos = board.snapPoint(desiredPos.x, desiredPos.y); 
```

也许不是超级漂亮，但它有效，o 在我的棋盘视图中覆盖 globalToLocal 方法也有效，但在 onMouseMove 内部进行了一些更多的计算，导致不对齐的快速移动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T21:59:44.727

只是想和你一起思考.. 我认为具有 IBoard 界面的 Shapes 没什么大不了的。不过，我不喜欢他们必须检查板上的标志的想法......

您将如何将标志作为参数传递？在 OnMove() 方法中？不太明白这个……你能扩展一下吗？

虽然..如果您尝试考虑一下 SRP - 单一责任原则...... Shape 类的责任是什么？是的，这就是 eJames 已经写的。

在我看来，他们的主要职责可能不是处理鼠标事件......这里需要更多地了解您的应用程序，但我的一般感觉是为什么不让其他人放下这个鼠标，然后弄清楚形状应该用它做什么例如使用新坐标在 Shape 上调用 Draw()？

假设您想应用诸如复合模式（形状内的形状...）之类的东西，并且您希望他们能够自己处理这些鼠标事件...但是如果他们在本地感知到此鼠标事件，那将是合乎逻辑的坐标，但是我认为您应该通过此事件提供所有信息（本地坐标，鼠标状态...），这样他们就不必在板上询问“全局”变量...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T22:13:12.297

将标志作为形状构造函数的参数传递。但这不会很好，因为标志会改变，我必须让每个形状在变化时更新他们的标志副本。

确实，形状责任不知道如何处理鼠标事件。但这就是 ObjectHandles 所做的：对事件做出反应，更新形状的高度宽度旋转参数。

也许我应该在我的板类中转移一些库代码来处理形状选择和移动/调整大小/旋转。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T22:45:18.143

OnMouseMove 对象句柄

```
 protected function onMouseMove(event:MouseEvent) : void
    {
        if( ! visible ) { return; }

        if( ! event.buttonDown )
        {
            setMouseCursor( event.stageX, event.stageY );
            return;
        }

        if(parent == null )
        {
            return;
        }

        var dest:Point = parent.globalToLocal( new Point(event.stageX, event.stageY) );
        var desiredPos:Point = new Point();
        var desiredSize:Point = new Point();
        var desiredRotation:Number = 0; 

... plenty more
then 

            if( wasMoved ) {    dispatchMoving() ; }
            if( wasResized ) {  dispatchResizing() ; }
            if( wasRotated ) {  dispatchRotating(); } 
```

所以我不能听移动事件并告诉板子捕捉它，因为形状已经自由移动。我应该在这里添加快照：

var dest:Point = parent.globalToLocal( new Point(event.stageX, event.stageY) );

所有形状都遵循捕捉规则，不能一个捕捉而另一个自由。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-19T17:14:05.327

使用 ObjectHandles 版本 2，然后创建一个约束来做你想做的事。

# wcf - 工作流程 - 选择合适的主机环境

> ID：315609
> 
> 赞同：2
> 
> 时间：2008-11-24T21:44:17.987
> 
> 标签：wcf, workflow, workflow-foundation

我正在设计的应用程序将按计划从各种不同的来源检索和存储内容。在某些情况下，将根据时间间隔（想想股票报价）检索内容，而在其他情况下，将根据自定义时间表（MWF @ 2pm）检索内容。许多流程都适用于 MS Workflow。内置的 SQL 跟踪服务将提供很多价值。内容源非常不同，每种不同类型的内容检索都将是一个自定义工作流。

我的问题是，我应该如何托管、监控、安排和公开工作流程？

要求：

*   必须能够通过管理 UI 监控每个内容“代理”的运行状况
*   必须能够通过管理 UI 启动和停止单个工作流
*   工作流根据计划重复出现，但不一定“长期运行”
*   “服务”必须具有高可用性

Windows 服务、工作流服务、ASP.Net、WCF 都可供我使用，我也愿意接受其他建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T23:05:11.083

WF 和 WCF 可以作为一个 WindowsService 托管，

您可以创建一组服务以通过 WCF Web 服务从 WindowsService 中的工作流公开状态/信息。因此，WCF 服务应该引用您的工作流交换合同（以某种方式可以引用工作流引擎以从客户端 UI 传递请求信息）。

*   必须能够通过管理 UI 监控每个内容“代理”的运行状况

Admin UI 可以从 web 服务中检索数据

*   必须能够通过管理 UI 启动和停止单个工作流

让工作流实例处理特定事件来启动或停止

*   工作流根据计划重复出现，但不一定“长期运行”

让工作流实例来处理特定事件来这样做

*   “服务”必须具有高可用性

WindowsService 是类似守护进程的应用程序，如果不崩溃，它将永远运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T23:11:54.800

我发现这篇文章也很有帮助：

[http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,77c334e8-0ec1-4f91-ab7e-0bcfa7f2f47d.aspx](http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,77c334e8-0ec1-4f91-ab7e-0bcfa7f2f47d.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T02:51:48.730

您可能想了解Microsoft 即将推出的工作流服务集成主机[Dublin 。](http://www.microsoft.com/net/dublin.aspx)它尚未发布，但提供了您正在寻找的一些功能。

# java - 如何在 Java 中提取 tar 文件？

> ID：315618
> 
> 赞同：66
> 
> 时间：2008-11-24T21:48:03.190
> 
> 标签：java, archive, tar

如何在 Java 中提取 tar（或 tar.gz 或 tar.bz2）文件？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2011-09-26T14:05:15.840

您可以使用 Apache Commons Compress 库来执行此操作。[您可以从http://mvnrepository.com/artifact/org.apache.commons/commons-compress/1.2](http://mvnrepository.com/artifact/org.apache.commons/commons-compress/1.2)下载 1.2 版本。

这里有两种方法：一种是解压缩文件，另一种是解压缩文件。因此，对于文件 <fileName>tar.gz，您需要先解压缩它，然后再解压缩它。请注意，tar 存档也可能包含文件夹，在这种情况下需要在本地文件系统上创建它们。

享受。

```
/** Untar an input file into an output file.

 * The output file is created in the output folder, having the same name
 * as the input file, minus the '.tar' extension. 
 * 
 * @param inputFile     the input .tar file
 * @param outputDir     the output directory file. 
 * @throws IOException 
 * @throws FileNotFoundException
 *  
 * @return  The {@link List} of {@link File}s with the untared content.
 * @throws ArchiveException 
 */
private static List<File> unTar(final File inputFile, final File outputDir) throws FileNotFoundException, IOException, ArchiveException {

    LOG.info(String.format("Untaring %s to dir %s.", inputFile.getAbsolutePath(), outputDir.getAbsolutePath()));

    final List<File> untaredFiles = new LinkedList<File>();
    final InputStream is = new FileInputStream(inputFile); 
    final TarArchiveInputStream debInputStream = (TarArchiveInputStream) new ArchiveStreamFactory().createArchiveInputStream("tar", is);
    TarArchiveEntry entry = null; 
    while ((entry = (TarArchiveEntry)debInputStream.getNextEntry()) != null) {
        final File outputFile = new File(outputDir, entry.getName());
        if (entry.isDirectory()) {
            LOG.info(String.format("Attempting to write output directory %s.", outputFile.getAbsolutePath()));
            if (!outputFile.exists()) {
                LOG.info(String.format("Attempting to create output directory %s.", outputFile.getAbsolutePath()));
                if (!outputFile.mkdirs()) {
                    throw new IllegalStateException(String.format("Couldn't create directory %s.", outputFile.getAbsolutePath()));
                }
            }
        } else {
            LOG.info(String.format("Creating output file %s.", outputFile.getAbsolutePath()));
            final OutputStream outputFileStream = new FileOutputStream(outputFile); 
            IOUtils.copy(debInputStream, outputFileStream);
            outputFileStream.close();
        }
        untaredFiles.add(outputFile);
    }
    debInputStream.close(); 

    return untaredFiles;
}

/**
 * Ungzip an input file into an output file.
 * <p>
 * The output file is created in the output folder, having the same name
 * as the input file, minus the '.gz' extension. 
 * 
 * @param inputFile     the input .gz file
 * @param outputDir     the output directory file. 
 * @throws IOException 
 * @throws FileNotFoundException
 *  
 * @return  The {@File} with the ungzipped content.
 */
private static File unGzip(final File inputFile, final File outputDir) throws FileNotFoundException, IOException {

    LOG.info(String.format("Ungzipping %s to dir %s.", inputFile.getAbsolutePath(), outputDir.getAbsolutePath()));

    final File outputFile = new File(outputDir, inputFile.getName().substring(0, inputFile.getName().length() - 3));

    final GZIPInputStream in = new GZIPInputStream(new FileInputStream(inputFile));
    final FileOutputStream out = new FileOutputStream(outputFile);

    IOUtils.copy(in, out);

    in.close();
    out.close();

    return outputFile;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-24T22:00:41.743

*注意：*此功能后来通过一个单独的项目 Apache Commons Compress 发布，如[另一个答案中所述。](https://stackoverflow.com/a/7556307/3474)这个答案已经过时了。

* * *

我没有直接用过 tar API，但是 tar 和 bzip2 是在 Ant 中实现的；你可以借用他们的实现，或者可能使用 Ant 来做你需要的事情。

[Gzip 是 Java SE 的一部分](http://java.sun.com/j2se/1.5.0/docs/api/java/util/zip/package-summary.html)（我猜 Ant 的实现遵循相同的模型）。

`GZIPInputStream`只是一个`InputStream`装饰器。例如，您可以将 a 包装`FileInputStream`在 a 中`GZIPInputStream`，并以与使用 any 相同的方式使用它`InputStream`：

```
InputStream is = new GZIPInputStream(new FileInputStream(file)); 
```

（请注意，GZIPInputStream 有自己的内部缓冲区，因此将其包装`FileInputStream`在 a`BufferedInputStream`中可能会降低性能。）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-11-12T13:30:10.607

[Apache Commons VFS](http://commons.apache.org/vfs/filesystems.html)支持 tar 作为一种**虚拟文件系统**，它支持这样的 URL`tar:gz:[http://anyhost/dir/mytar.tar.gz!/mytar.tar!/path/in/tar/README.txt](http://anyhost/dir/mytar.tar.gz!/mytar.tar!/path/in/tar/README.txt)`

[TrueZip](https://christian-schlichtherle.bitbucket.io/truezip/)或其继任者[TrueVFS 也是](http://truevfs.net/)如此……它也可以从 Maven Central 获得。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-03-18T14:04:08.240

```
Archiver archiver = ArchiverFactory.createArchiver("tar", "gz");
archiver.extract(archiveFile, destDir); 
```

依赖：

```
 <dependency>
        <groupId>org.rauschig</groupId>
        <artifactId>jarchivelib</artifactId>
        <version>0.5.0</version>
</dependency> 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-09-23T21:17:43.633

我只是尝试了一堆建议的库（TrueZip、Apache Compress），但没有运气。

以下是 Apache Commons VFS 的示例：

```
FileSystemManager fsManager = VFS.getManager();
FileObject archive = fsManager.resolveFile("tgz:file://" + fileName);

// List the children of the archive file
FileObject[] children = archive.getChildren();
System.out.println("Children of " + archive.getName().getURI()+" are ");
for (int i = 0; i < children.length; i++) {
    FileObject fo = children[i];
    System.out.println(fo.getName().getBaseName());
    if (fo.isReadable() && fo.getType() == FileType.FILE
        && fo.getName().getExtension().equals("nxml")) {
        FileContent fc = fo.getContent();
        InputStream is = fc.getInputStream();
    }
} 
```

和maven依赖：

```
 <dependency>
      <groupId>commons-vfs</groupId>
      <artifactId>commons-vfs</artifactId>
      <version>1.0</version>
    </dependency> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-11-12T13:19:00.563

除了 gzip 和 bzip2，[Apache Commons Compress API](http://commons.apache.org/compress/)还支持 tar，最初基于[ICE Engineering Java Tar Package](http://www.trustice.com/java/tar/)，它既是 API 又是独立工具。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-24T21:55:04.767

将这个[API](http://www.trustice.com/java/tar/)用于 tar 文件，[另一个](http://www.kohsuke.org/bzip2/)包含在 Ant 中的 BZIP2 和[标准](http://java.sun.com/j2se/1.4.2/docs/api/java/util/zip/GZIPInputStream.html)的 GZIP 的 API 怎么样？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-02-22T16:06:55.240

这是一个基于Dan Borza[早期回答](https://stackoverflow.com/a/7556307/207245)的版本，它使用[Apache Commons Compress](https://mvnrepository.com/artifact/org.apache.commons/commons-compress/1.18)和 Java NIO（即路径而不是文件）。它还在一个流中进行解压缩和解压缩，因此无需创建中间文件。

```
public static void unTarGz( Path pathInput, Path pathOutput ) throws IOException {
    TarArchiveInputStream tararchiveinputstream =
        new TarArchiveInputStream(
            new GzipCompressorInputStream(
                new BufferedInputStream( Files.newInputStream( pathInput ) ) ) );

    ArchiveEntry archiveentry = null;
    while( (archiveentry = tararchiveinputstream.getNextEntry()) != null ) {
        Path pathEntryOutput = pathOutput.resolve( archiveentry.getName() );
        if( archiveentry.isDirectory() ) {
            if( !Files.exists( pathEntryOutput ) )
                Files.createDirectory( pathEntryOutput );
        }
        else
            Files.copy( tararchiveinputstream, pathEntryOutput );
    }

    tararchiveinputstream.close();
} 
```

# mysql - MySQL：如何从表中选择除最后一行之外的所有行

> ID：315621
> 
> 赞同：11
> 
> 时间：2008-11-24T21:48:53.670
> 
> 标签：mysql, select, limits

我有一个有 N 行的表，我想选择 N-1 行。

如果可能的话，关于如何在一个查询中执行此操作的建议..？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-24T21:52:12.557

最后一行是否具有最高 ID？如果是这样，我认为这会起作用：

```
SELECT * FROM TABLE WHERE ID != (SELECT MAX(ID) FROM TABLE) 
```

MySQL 在当前版本中确实允许子选择，对吧？

但是，在大多数情况下，如果您选择所有行然后在应用程序中过滤掉不需要的数据，它可能会执行得更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-09T17:45:37.777

我在这里没有看到的另一种技术是

```
SELECT * FROM table ORDER BY id DESC LIMIT 10000 OFFSET 1; 
```

这将为您提供按 id descendant 排序的记录，除了第一个，即原始顺序中的最后一个。
请注意，使用此方法您**只会获取 10000 条记录，但是此数字可以任意高，但不能省略。**
**这种方法的优点**是您可以随意订购。
**缺点**是它为您提供了从最后到第一个排序的记录。
最后值得注意的是，这里的其他方法效果很好

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T21:54:33.100

SELECT DISTINCT t1.columns FROM table t1
INNER JOIN table t2 ON t1.id < t2.id

根据我的经验，MySQL 喜欢这种技术，可以追溯到几个版本。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2016-08-09T17:57:13.013

另一种方法可能是：

```
SELECT * FROM table WHERE ID <> LAST_INSERT_ID() 
```

参考：[http ://dev.mysql.com/doc/refman/5.7/en/getting-unique-id.html](http://dev.mysql.com/doc/refman/5.7/en/getting-unique-id.html)

# documentation - 发行说明，有什么用？

> ID：315628
> 
> 赞同：14
> 
> 时间：2008-11-24T21:51:50.640
> 
> 标签：documentation, release-notes

什么是发行说明以及谁阅读它们？他们应该/可以通过为当前版本吐出错误修复来实现自动化，还是需要仔细的人工编辑？那么，任何人都可以链接到关于软件发行说明的最佳实践（背后的推理）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-24T21:56:12.050

错误修正和新增功能。用户将阅读它们以确定他们是否应该麻烦安装增量升级，或者等到下一个版本，因为这个版本没有添加他们需要的任何功能或修复他们正在使用的功能中的任何错误。

我想说他们至少需要一个人来阅读它们并确保每个注释都是有用的。这取决于对错误修复的评论有多好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T21:56:00.957

这实际上取决于您的应用程序是为谁构建的以及您的组织目标。但是，我倾向于认为发行说明需要是特定版本中包含的重要关键添加、增强或修复的简明列表。

有时一个简单的错误跟踪系统信息转储就足够了，其他时候，我发现它们需要改进。

关键是通常认为发行说明是“嘿，看看我们做了什么”类型的更改列表。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-24T22:09:07.640

发行说明对您的测试组织（如果有的话）也很重要，以便他们知道发行版中发生了什么变化并需要测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-24T21:57:24.607

我们的发行说明是人工创建的，而不是机器创建的。涵盖三个主要主题。

1.  版本中包含的内容（文件列表）

2.  如何安装它

3.  自上一个版本以来发生了什么变化（特别是如果这些变化还没有在手册中）。

第 1 项和第 2 项在不同版本之间变化不大，但需要对其进行审查。第 3 项工作量最大。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-24T22:04:50.533

**发行说明在生产环境**中也很重要。

他们帮助回答了这个古老的问题：

> 目前正在投入生产的到底是什么？

或者更精致的问题：这个错误实际上已经在这个版本中修复了吗？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-24T22:04:02.800

我习惯性地阅读发行说明。我倾向于想要一份完整的功能更改列表（或尽可能好），以便更好地使用新产品。

我想看看某些关键错误或关键安全问题何时得到解决。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T22:02:45.000

如果您的客户必须采取除正常程序之外的特殊操作以进行升级，那么发行说明和自述文件可能非常重要。警告客户/用户任何可能因安装较新补丁而自动发生的数据库升级也很有用。在我看来，发行说明和自述文件应该是为系统管理员受众编写的。因此，包括他们想知道的各种事情：重要更改的摘要、如何安装、已知的错误、您的软件可能会做的任何事情，这会让人大吃一惊，等等。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T22:21:13.623

发行说明取决于您的组织。

我可以为我的组织说话。我们使用 PDF 格式的发行说明，每次我们发布 clickonce 或后端版本。我们将发布说明发送给办公室经理。这是企业最高管理员（不仅是 IT）使用的文档。这份文件是他们了解正在发生的事情的一种方式。发生了哪些变化、正在生产中的新功能、已修复的错误以及他们可能想向用户解释的其他内容。

这是一个3到4页的文件，用简短的文字描述了这个版本中已经完成的工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T22:37:43.167

这当然高度依赖于应用程序/服务/诸如此类的类型，
但我发现阅读我最喜欢的开发工具等的发行说明
经常让我偶然发现我想要的漂亮、有趣甚至杀手级的功能如果我至少没有略读笔记，可能会错过.....好吧，也许不是杀手，但你明白我的意思;-)

作为大多数计算机高级用户（现在那是什么样的表达......）
我从不打扰普通文档，所以
除了点击，悬停和常见问题外，这给了我一些额外的东西......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-02T22:30:48.357

发行说明供测试人员和用户了解新增/更改内容。此外，在为您为客户构建的软件的新“版本”计费时，发行说明可用作支持文档。v1.31 似乎更容易关联和深入研究。

与其手动编译这两个列表，如果您可以使用您的发行说明为您执行此操作，那就太好了。

# c# - 是否存在 System.Diagnostics.ConditionalAttribute 的逆？

> ID：315646
> 
> 赞同：7
> 
> 时间：2008-11-24T21:55:56.433
> 
> 标签：c#, visual-studio, attributes, symbols

是否有类似的条件不存在属性，或者是否有一种方法可以使用条件属性来仅包含未定义该符号的*方法*？

我正在寻找的是这样的东西：

```
[Conditional("!SILVERLIGHT")]
private void DoStuffThatSilverlightCant() {...} 
```

`SILVERLIGHT`这样，如果符号确实存在，则不会包含该方法。

我不想使用 simple 的原因`#ifdef`是我可以利用编译器删除调用语句，而不必将每个单独的调用包装在`#ifdef`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T21:58:28.287

更新：以下代码片段仅在 #if 位于每个调用文件中时才有效，这不是很实用。

```
#if !SILVERLIGHT
#define NOT_SILVERLIGHT
#endif

[Conditional("NOT_SILVERLIGHT")]
private void DoStuffThatSilverlightCant() {...} 
```

但是，可以做的是为您使用的任何平台进行构建配置，该配置将/定义所需的符号（在这种情况下为 NOT_SILVERLIGHT）。

# linux - 确定特定术语的词频

> ID：315667
> 
> 赞同：14
> 
> 时间：2008-11-24T22:00:36.923
> 
> 标签：linux, text, analysis, frequency, word-frequency

我是一名非计算机科学专业的学生，​​正在撰写一篇历史论文，该论文涉及确定许多文本中特定术语的频率，然后随着时间的推移绘制这些频率以确定变化和趋势。虽然我已经弄清楚如何确定给定文本文件的词频，但我正在处理（相对而言，对我而言）大量文件（> 100），并且为了保持一致性，我想限制频率计数中包含的词到一组特定的术语（有点像“停止列表”的反面）

这应该保持非常简单。最后，我需要的是我处理的每个文本文件的特定单词的频率，最好是电子表格格式（制表符描述的文件），这样我就可以使用该数据创建图表和可视化。

我每天都在使用 Linux，对使用命令行很舒服，并且喜欢开源解决方案（或者我可以用 WINE 运行的东西）。然而，这不是一个要求：

我看到了两种解决这个问题的方法：

1.  找到一种方法去除文本文件中除预定义列表之外的所有单词，然后从那里进行频率计数，或者：
2.  找到一种仅使用预定义列表中的术语进行频率计数的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T22:17:26.860

我会选择第二个想法。这是一个简单的 Perl 程序，它将从提供的第一个文件中读取单词列表，并从以制表符分隔格式提供的第二个文件中打印列表中每个单词的计数。第一个文件中的单词列表应每行提供一个。

```
#!/usr/bin/perl

use strict;
use warnings;

my $word_list_file = shift;
my $process_file = shift;

my %word_counts;

# Open the word list file, read a line at a time, remove the newline,
# add it to the hash of words to track, initialize the count to zero
open(WORDS, $word_list_file) or die "Failed to open list file: $!\n";
while (<WORDS>) {
  chomp;
  # Store words in lowercase for case-insensitive match
  $word_counts{lc($_)} = 0;
}
close(WORDS);

# Read the text file one line at a time, break the text up into words
# based on word boundaries (\b), iterate through each word incrementing
# the word count in the word hash if the word is in the hash
open(FILE, $process_file) or die "Failed to open process file: $!\n";

while (<FILE>) {
  chomp;
  while ( /-$/ ) {
    # If the line ends in a hyphen, remove the hyphen and
    # continue reading lines until we find one that doesn't
    chop;
    my $next_line = <FILE>;
    defined($next_line) ? $_ .= $next_line : last;
  }

  my @words = split /\b/, lc; # Split the lower-cased version of the string
  foreach my $word (@words) {
    $word_counts{$word}++ if exists $word_counts{$word};
  }
}
close(FILE);

# Print each word in the hash in alphabetical order along with the
# number of time encountered, delimited by tabs (\t)
foreach my $word (sort keys %word_counts)
{
  print "$word\t$word_counts{$word}\n"
} 
```

如果文件 words.txt 包含：

```
linux
frequencies
science
words 
```

并且文件 text.txt 包含您的帖子的文本，以下命令：

```
perl analyze.pl words.txt text.txt 
```

将打印：

```
frequencies     3
linux   1
science 1
words   3 
```

请注意，使用 \b 打破单词边界可能不会在所有情况下都以您想要的方式工作，例如，如果您的文本文件包含跨行连字符的单词，您将需要做一些更智能的事情来匹配这些。在这种情况下，您可以检查一行中的最后一个字符是否是连字符，如果是，只需删除连字符并在将行拆分为单词之前读取另一行。

**编辑**：更新的版本可以不区分大小写地处理单词并跨行处理带连字符的单词。

请注意，如果有连字符的单词，其中一些是跨行的，而另一些则不是，这不会找到它们，因为它只删除了行尾的连字符。在这种情况下，您可能只想删除所有连字符并在删除连字符后匹配单词。您可以通过在 split 函数之前添加以下行来做到这一点：

```
s/-//g; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T22:51:11.923

我使用如下脚本（在 bash 语法中）执行此类操作：

```
for file in *.txt
do 
  sed -r 's/([^ ]+) +/\1\n/g' "$file" \
  | grep -F -f 'go-words' \
  | sort | uniq -c > "${file}.frq"
done 
```

您可以调整用于分隔单个单词的正则表达式；在示例中，我只是将空格视为分隔符。grep 的 -f 参数是一个包含您感兴趣的单词的文件，每行一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T22:26:59.977

首先熟悉词法分析以及如何编写扫描器生成器规范。阅读有关使用 YACC、Lex、Bison 或我个人最喜欢的 JFlex 等工具的介绍。在这里，您定义什么构成令牌。这是您了解如何创建标记器的地方。

接下来你有所谓的种子列表。停止列表的反面通常被称为开始列表或有限词典。Lexicon 也是一个值得学习的好东西。部分应用需要将开始列表加载到内存中，以便快速查询。典型的存储方式是每行一个单词的文件，然后在应用程序开始时将其读入一次，读入类似于地图的内容。您可能想了解散列的概念。

从这里您想考虑存储结果所需的基本算法和数据结构。分布很容易表示为二维稀疏数组。学习稀疏矩阵的基础知识。你不需要 6 个月的线性代数来理解它的作用。

因为您正在处理更大的文件，所以我会提倡基于流的方法。不要将整个文件读入内存。将其作为流读入生成标记流的标记器。

在算法的下一部分考虑如何将标记列表转换为仅包含您想要的单词的列表。如果您考虑一下，列表在内存中并且可能非常大，因此最好在开始时过滤掉非起始词。因此，在您从分词器中获取新令牌的关键点，在将其添加到令牌列表之前，请在内存中的起始词列表中进行查找以查看该词是否为起始词。如果是这样，请将其保留在输出令牌列表中。否则忽略它并移至下一个标记，直到读取整个文件。

现在您有一个仅感兴趣的令牌列表。问题是，您没有查看其他索引指标，例如位置、案例和上下文。因此，您真的不需要所有令牌的列表。你真的只想要一个具有相关计数的不同标记的稀疏矩阵。

所以，首先创建一个空的稀疏矩阵。然后想想解析时新发现的token的插入。当它发生时，如果它在列表中，则增加它的计数，或者插入一个计数为 1 的新标记。这次，在解析文件结束时，您有一个不同标记的列表，每个标记的频率至少为1.

该列表现在在内存中，您可以做任何您想做的事情。将其转储到 CSV 文件将是一个简单的过程，即迭代条目并在每行写入每个条目及其计数。

为此，请查看名为“GATE”的非商业产品或 TextAnalyst 等商业产品或[http://textanalysis.info中列出的产品](http://textanalysis.info)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T22:08:43.710

我猜随着时间的推移会引入新文件，这就是事情的变化？

我认为您最好的选择是使用类似于您的选项 2 的方法。如果您只想计算关键字的出现次数，那么预处理文件没有多大意义。我只会浏览每个文件一次，计算列表中出现的每个单词。就我个人而言，我会用 Ruby 来完成，但是像 perl 或 python 这样的语言也会使这项任务变得非常简单。例如，您可以使用关联数组，其中关键字作为键，出现次数作为值。（但如果您需要存储有关事件的更多信息，这可能过于简单）。

我不确定您是要存储每个文件的信息，还是要存储整个数据集的信息？我想这不会太难合并。

我不确定一旦获得数据后如何处理数据 - 将其导出到电子表格会很好，如果这可以满足您的需求。或者，从长远来看，您可能会发现编写一些额外的代码来为您很好地显示数据会更容易。取决于你想对数据做什么（例如，如果你想在练习结束时只生成几个图表并将它们放入报告中，那么导出到 CSV 可能最有意义，而如果你想生成一年中每天都有一组新数据，然后构建一个自动执行此操作的工具几乎可以肯定是最好的主意。

编辑：我刚刚发现，由于您正在研究历史，因此您的文档可能不会随着时间而改变，而是反映了一系列已经发生的变化。很抱歉造成误解。无论如何，我认为我上面所说的几乎所有内容仍然适用，但我想你会倾向于导出到 CSV 或你有什么而不​​是自动显示。

听起来像是一个有趣的项目——祝你好运！

本

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T22:37:21.030

我会在文件上做一个“grep”来找到所有包含你的关键词的行。（Grep -f 可用于指定要搜索的单词输入文件（将 grep 的输出通过管道传输到文件）。这将为您提供包含单词实例的行列表。然后执行“sed”用换行符替换你的单词分隔符（很可能是空格），给你一个单独的单词文件（每行一个单词）。现在再次运行 grep，使用相同的单词列表，除了这次指定 -c （获取计数具有指定单词的行数；即原始文件中单词出现的计数）。

两遍方法只是让“sed”的生活更轻松；第一个 grep 应该消除很多行。

您可以在基本的 linux 命令行命令中完成这一切。一旦你对这个过程感到满意，你就可以很容易地将它全部放入 shell 脚本中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T00:44:20.213

另一个 Perl 尝试：

```
#!/usr/bin/perl -w
use strict;

use File::Slurp;
use Tie::File;

# Usage:
#
# $ perl WordCount.pl <Files>
# 
# Example:
# 
# $ perl WordCount.pl *.text
#
# Counts words in all files given as arguments.
# The words are taken from the file "WordList".
# The output is appended to the file "WordCount.out" in the format implied in the
# following example:
#
# File,Word1,Word2,Word3,...
# File1,0,5,3,...
# File2,6,3,4,...
# .
# .
# .
# 

### Configuration

my $CaseSensitive = 1;       # 0 or 1
my $OutputSeparator = ",";   # another option might be "\t" (TAB)
my $RemoveHyphenation = 0;   # 0 or 1\.  Careful, may be too greedy.

###

my @WordList = read_file("WordList");
chomp @WordList;

tie (my @Output, 'Tie::File', "WordCount.out");
push (@Output, join ($OutputSeparator, "File", @WordList));

for my $InFile (@ARGV)
    { my $Text = read_file($InFile);
      if ($RemoveHyphenation) { $Text =~ s/-\n//g; };
      my %Count;
      for my $Word (@WordList)
          { if ($CaseSensitive)
               { $Count{$Word} = ($Text =~ s/(\b$Word\b)/$1/g); }
               else
               { $Count{$Word} = ($Text =~ s/(\b$Word\b)/$1/gi); }; };
      my $OutputLine = "$InFile";
      for my $Word (@WordList)
          { if ($Count{$Word})
               { $OutputLine .= $OutputSeparator . $Count{$Word}; }
               else
               { $OutputLine .= $OutputSeparator . "0"; }; };
      push (@Output, $OutputLine); };

untie @Output; 
```

当我将您的问题放入文件`wc-test`并将 Robert Gamble 的答案放入`wc-ans-test`时，输出文件如下所示：

```
File,linux,frequencies,science,words
wc-ans-test,2,2,2,12
wc-test,1,3,1,3 
```

这是一个逗号分隔值 (csv) 文件（但您可以在脚本中更改分隔符）。它应该对任何电子表格应用程序都是可读的。对于绘图，我建议使用`gnuplot`完全可编写脚本的 ，因此您可以独立于输入数据调整输出。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-11T01:25:02.960

大脚本见鬼去吧。如果你愿意抓住*所有*的话，试试这个 shell fu：

```
cat *.txt | tr A-Z a-z | tr -cs a-z '\n' | sort | uniq -c | sort -rn | 
sed '/[0-9] /&, /' 
```

这（经过测试）将为您提供按频率排序的 CSV 格式的所有单词列表，可以通过您喜欢的电子表格轻松导入。如果您必须有停用词，请尝试插入`grep -w -F -f stopwords.txt`管道（未测试）。

# python - 使用格式化输出自动扩展 Python 列表

> ID：315672
> 
> 赞同：6
> 
> 时间：2008-11-24T22:02:29.930
> 
> 标签：python, list, mysql

有谁知道是否有办法在 Python 中自动扩展列表，用逗号分隔？我正在编写一些使用 MySQLdb 库的 Python 代码，并且我正在尝试使用某些键值动态更新 MySQL 数据库中的行列表。

例如，在下面的代码中，我希望将 record_ids 列表中的数值扩展为 SQL 的“ `IN`”子句。

```
import MySQLdb
record_ids = [ 23, 43, 71, 102, 121, 241 ]

mysql = MySQLdb.connect(user="username", passwd="secret", db="apps")
mysql_cursor = mysql.cursor()

sqlStmt="UPDATE apps.sometable SET lastmod=SYSDATE() where rec_id in ( %s )"

mysql_cursor.execute( sqlStmt, record_ids )
mysql.commit() 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T22:06:59.720

尝试：

```
",".join( map(str, record_ids) ) 
```

`",".join( list_of_strings )`通过用逗号分隔字符串来加入列表

如果您有数字列表，`map( str, list )`会将其转换为字符串列表

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T23:09:46.690

我做这样的事情（以确保我使用绑定）：

```
sqlStmt=("UPDATE apps.sometable SET lastmod=SYSDATE() where rec_id in (%s)"
    % ', '.join(['?' for n in record_ids]))

mysql_cursor.execute(sqlStmt, record_ids)
mysql.commit() 
```

这适用于您想要绑定的所有动态列表，而不会让您容易受到 SQL 注入攻击。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T22:53:27.880

除了给定的答案，请注意，您可能希望将空列表情况特殊化，因为“ `where rec_id in ()`”不是有效的 SQL，因此您会收到错误消息。

还要非常小心地像这样手动构建 SQL，而不仅仅是使用自动转义的参数。对于整数列表，它会起作用，但如果您正在处理从用户输入接收的字符串，则这样做会打开一个巨大的 SQL 注入漏洞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T18:11:38.010

与达斯汀的答案略有不同的替代方案：

```
sqlStmt=("UPDATE apps.sometable SET lastmod=SYSDATE() where rec_id in (%s)"
    % ', '.join(['?'] * len(record_ids))) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-06-30T05:14:17.007

或者，使用*replace*：

```
sqlStmt="UPDATE apps.sometable SET lastmod=SYSDATE() where rec_id in " +
    record_ids.__str__().replace('[','(').replace(']',')') 
```

# javascript - 需要一个 ExtJS 错误解决方法

> ID：315678
> 
> 赞同：0
> 
> 时间：2008-11-24T22:04:32.237
> 
> 标签：javascript, css, extjs

我有一个使用 Ext-JS 2.2 的 Web 应用程序。在某个组件中，我们有一个空的工具栏，我们正在尝试添加一个按钮来使用

```
myPanel.getTopToolbar().insertButton(0, [...array of buttons...]); 
```

但是，在 IE6/7 中，由于 ext-all-debug.js 中的第 20241-20242 行，这会失败：

```
var td = document.createElement("td");
this.tr.insertBefore(td, this.tr.childNodes[index]); 
```

由于 IE 中尚不存在“this.tr.childNodes([0])”，因此失败并显示“无效参数”。

真正的问题：我可以使用类似于下面的 CSS 向每个工具栏 <tr> 添加一个子项，以便找到 this.tr.childNodes[0]：

```
div.x-toolbar tr:after { content: " "; } 
```

我完全意识到这是一个 hack，但出于法律原因，我无法更改任何 Javascript，甚至无法向每个工具栏添加一个空按钮 ({})。对任何能解决这个问题的人表示敬意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-06T19:27:37.053

我过去必须做的是在我的元素配置中包含一个空工具栏：

酒吧：[]

然后（并且仅在元素完全渲染后）使用 .add() 方法注入按钮。

事件的顺序每次都会让你。需要一段时间才能掌握它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T02:16:56.267

如果您所做的只是添加到一个空面板

```
 myPanel.getTopToolbar().add(buttons etc); 
```

或者

```
 myPanel.getTopToolbar().addButton(..); 
```

要么应该工作。看起来 insertButton 的目的是将按钮放在非空工具栏中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T04:50:04.980

您是否考虑在面板渲染后添加按钮？也许是这样的：

```
myPanel.on('render', function() {
   this.getTopToolbar().insertButton(0, [...array of buttons...]);
}, true); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T18:43:15.387

我不认为有一个纯 CSS 的解决方案。

作为记录，我最终将 javascript 注入到页面中，该页面覆盖了 insertButton() 函数的 Ext.Toolbar 原型，以检查“this.tr.childNodes([0])”是否存在，如果出现则默认为 addButton()它不存在。

# windows - 打开对话框保留设置

> ID：315692
> 
> 赞同：3
> 
> 时间：2008-11-24T22:10:20.820
> 
> 标签：windows, openfiledialog

如何保存打开对话框中的设置？例如，我希望打开对话框记住我选择了详细信息视图并按修改日期排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T22:56:52.600

微软认为不适合向我们提供任何记录在案的方法，但有些人已经弄清楚了一些难题。此链接显示如何设置视图，但不显示如何获取当前设置：

[http://msdn.microsoft.com/en-us/magazine/cc164009.aspx](http://msdn.microsoft.com/en-us/magazine/cc164009.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T11:42:36.373

我不太确定这不是操作系统设置。如果用户选择他们的文件夹首选项，那么 Windows 将记住与否。在这种情况下，从可访问性和可用性的角度来看，这是用户的偏好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T13:49:15.833

您可以从对话框的类继承，然后查看可以覆盖哪些内容以保持其状态的持久性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-10T21:45:22.977

简单的非技术解决方案。这在某些情况下对我有用（WinXP SP3），但不是全部。由于您无法在常用的“打开”对话框中进行更改，因此您可以尝试在 Windows 资源管理器中进行更改。打开 Windows 资源管理器。如果要更改排序顺序，请转到详细信息视图并单击要排序的列，通常为名称，但您可能希望按日期排序。现在将视图更改回您想要的任何内容。现在选择“工具”，然后选择“文件夹选项”。在“常规”选项卡上，“任务”选择“使用 Windows 经典文件夹”，“浏览文件夹”选择“在同一窗口中打开每个文件夹”。现在单击“查看”选项卡。向下滚动并选中“记住每个文件夹视图设置”复选框。如果已选中，请取消选中，然后再次选中。单击窗口底部的“应用”按钮。单击顶部附近的“应用到所有文件夹”按钮。这些设置*可能会*出现在您的打开对话框中。完成此操作后，您现在可以更改 Windows 资源管理器或任何其他允许您更改它们的文件夹窗口中的设置，并且该文件夹窗口应该记住它们。这修复了我的图形编辑器中的“打开”对话框，但没有修复我的视频编辑器中的“打开”对话框。

# jquery - 在 jQuery 中实现一个可拖动/可排序的堆叠列表

> ID：315704
> 
> 赞同：1
> 
> 时间：2008-11-24T22:15:13.243
> 
> 标签：jquery, drag-and-drop, list, jquery-ui-sortable

我需要制作这个布局编辑器，它使用大量的**jQuery**来让人们使用简历上的项目。我设想显示一个带有各部分图形表示的对话框，有点像：

```
[Details - locked -- immovable]
[Overview -- immovable, but can be hidden or shown again]
----imaginary line where things can not be moved above this---
[Career History -- movable]
[Key Skills -- movable + can be hidden or shown again]
[Education & Qualifications -- movable]
[Personal Interests -- movable + can be hidden or shown again]
---imaginary line where things cannot be moved below this--
[References -- immovable] 
```

移动物品时，它们需要滑入最近的插槽。

您不会碰巧知道网络上与此类似的示例，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T22:18:47.433

jquery.ui.draggable 和 jquery.ui.sortable 浮现在脑海。

[http://docs.jquery.com/UI](http://docs.jquery.com/UI)

# perl - 仅当存在完整行时，如何从 IO::Socket::INET 文件句柄中读取？

> ID：315706
> 
> 赞同：2
> 
> 时间：2008-11-24T22:17:06.097
> 
> 标签：perl, sockets, blocking

从[IO::Socket::INET](http://search.cpan.org/dist/IO)文件句柄中读取时，不能假定流中总是有可用数据。有哪些技术可用于查看流以检查数据是否可用，或者在进行读取时，如果没有有效的行终止，则不获取数据并立即通过读取？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T22:36:58.350

创建套接字时将`Blocking`选项设置为：`0`

```
$sock = IO::Socket::INET->new(Blocking => 0, ...); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T14:44:25.667

结帐[IO::Select](http://search.cpan.org/~gbarr/IO-1.2301/IO/Select.pm "IO::选择") ; 在以非阻塞方式处理套接字时，我经常使用它。

# c# - C# 技术 - 通过字符串获取常量值

> ID：315708
> 
> 赞同：3
> 
> 时间：2008-11-24T22:18:44.720
> 
> 标签：c#, .net, excel, vsto, constants

有没有什么好方法可以将“xlSum”、“xlAverage”和“xlCount”等字符串转换为它们在 Microsoft.Office.Interop.Excel.XlConsolidationFunction 下的值？

我想反射会很慢（如果可能的话）。这些常数值大约有 10 个。如果可能的话，我试图避免使用大的 switch 语句。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T22:23:34.490

这是一个枚举，所以你应该能够使用

```
using Microsoft.Office.Interop.Excel;

XlConslidationFunction func = (XlConsolidationFunction)
                               Enum.Parse( typeof(XlConsolidationFunction),
                                           stringVal ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T22:21:17.820

您可以始终使用 a`Dictionary<string, ...>`并在应用程序启动时填充一次，而不是 switch

# javascript - 如何在 Javascript 中向元素数组添加带参数的事件处理程序？

> ID：315712
> 
> 赞同：7
> 
> 时间：2008-11-24T22:19:45.903
> 
> 标签：javascript, event-handling, prototypejs, dom-events

我有一个完全依赖于 JavaScript 和 Ajax 的三步过程来加载数据并动画化从一步到下一步的过程。更复杂的是，步骤之间的过渡（向前和向后）是动画的:-(。当用户通过流程锚点的进度出现时，会显示当前步骤和之前的步骤。如果他们点击了之前的步骤，那么它会将他们带回到上一步。

现在，整个过程（向前和向后）正常工作，如果您从第 1 步开始，但如果您直接跳到第 3 步，则第 1 步和第 2 步的锚点也会执行与第 3 步相同的操作。

这是代码的一部分，它循环遍历所有步骤直到用户将要执行的当前步骤，并依次显示每个锚点并将适当的函数分配给点击事件：

```
for (var i = 0; i < profile.current + 1; i++) {
    if ($('step_anchor_' + i).innerHTML.empty()) {
        var action = profile.steps[i].action;
        var dao_id = profile.steps[i].dao_id;

        $('step_anchor_' + i).innerHTML = profile.steps[i].anchor;
        $('step_anchor_' + i).observe('click', function(){
            pm.loadData(action, dao_id, true);
        });

        Effect.Appear('step_anchor_' + i, {
            duration: 1,
            delay: (down_delay++)
        });
    }
} 
```

我知道问题在于传递 action 和 dao_id 参数的方式。我也尝试过传递 profile.steps[i].action 和 profile.steps[i].dao_id 但在这种情况下 profile 和 i或者至少我不在范围内。

如何做到这一点，以便我可以为每个步骤正确分配 action 和 dao_id 的参数？（如果有什么不同，我们使用的是 Prototype 和 Scriptaculous）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T23:31:36.133

您的封闭范围链导致了您的问题。通过内联声明处理函数，您已经创建了一个闭包。显然，您这样做是为了利用循环。

但是，由于您已经创建了一个闭包，因此您正在按照闭包范围规则进行操作。这些规则规定，只要闭包存在，父函数中的局部变量就会保持活动和可用。

您正在尝试将“action”和“dao_id”传递给您的闭包，但您在这里传递的是引用，而不是值。因此，当您的闭包（处理程序）被调用时，它们使用上次分配引用的值。在您的情况下，第 3 步处理程序。

闭包范围规则已经够混乱了，但你也可能会因为“action”和“dao_id”在循环块已经执行完毕的情况下仍然存在这一事实而感到困惑。好吧，在 JavaScript 中没有块作用域之类的东西。一旦你声明了一个变量，它在函数结束或被删除之前都是可用的。以先到者为准。

综上所述，您需要打破作用域链。这里有两种方法可以做到这一点：

试试这个：

```
for (var i = 0; i < profile.current + 1; i++) {
    if ($('step_anchor_' + i).innerHTML.empty()) {
        var action = profile.steps[i].action;
        var dao_id = profile.steps[i].dao_id;

        $('step_anchor_' + i).innerHTML = profile.steps[i].anchor;
        $('step_anchor_' + i).observe('click', function(a, b){
                return function(){pm.loadData(a, b, true)};
        }(action, dao_id));

        Effect.Appear('step_anchor_' + i, {
                duration: 1,
                delay: (down_delay++)
        });
    }
} 
```

或这个：

```
function createHandler(action, dao_id) {
    return function(){pm.loadData(action, dao_id, true);};
} 

/* snip - inside some other function */
for (var i = 0; i < profile.current + 1; i++) {
    if ($('step_anchor_' + i).innerHTML.empty()) {
        var action = profile.steps[i].action;
        var dao_id = profile.steps[i].dao_id;

        $('step_anchor_' + i).innerHTML = profile.steps[i].anchor;
        $('step_anchor_' + i).observe('click', createHandler(action, dao_id));
        Effect.Appear('step_anchor_' + i, {
                duration: 1,
                delay: (down_delay++)
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T22:38:01.920

首先，记住你在点击事件中的执行范围。该上下文中的*this*关键字指的是被单击的元素。有什么方法可以从被点击的元素中确定 dao_id 吗？

# python - 在扭曲协议中定期运行函数

> ID：315716
> 
> 赞同：24
> 
> 时间：2008-11-24T22:21:17.943
> 
> 标签：python, tcp, twisted, protocols

我正在寻找一种方法来定期通过连接到 TCP 端口的所有客户端发送一些数据。我在看twisted python，我知道reactor.callLater。但是如何使用它定期向所有连接的客户端发送一些数据？数据发送逻辑在协议类中，由reactor根据需要进行实例化。我不知道如何将它从反应堆绑定到所有协议实例......

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-25T07:12:05.703

您可能希望在工厂中为连接执行此操作。每次建立和丢失连接时不会自动通知工厂，因此您可以从协议通知它。

这是一个完整的示例，说明如何将 twisted.internet.task.LoopingCall 与自定义的基本工厂和协议结合使用，以每 10 秒向每个连接宣布“10 秒已过去”。

```
from twisted.internet import reactor, protocol, task

class MyProtocol(protocol.Protocol):
    def connectionMade(self):
        self.factory.clientConnectionMade(self)
    def connectionLost(self, reason):
        self.factory.clientConnectionLost(self)

class MyFactory(protocol.Factory):
    protocol = MyProtocol
    def __init__(self):
        self.clients = []
        self.lc = task.LoopingCall(self.announce)
        self.lc.start(10)

    def announce(self):
        for client in self.clients:
            client.transport.write("10 seconds has passed\n")

    def clientConnectionMade(self, client):
        self.clients.append(client)

    def clientConnectionLost(self, client):
        self.clients.remove(client)

myfactory = MyFactory()
reactor.listenTCP(9000, myfactory)
reactor.run() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T23:19:48.170

我想最简单的方法是使用客户端中的 connectionMade 和 connectionLost 管理协议中的客户端列表，然后使用 LoopingCall 要求每个客户端发送数据。

这感觉有点侵入性，但我认为如果协议没有对传输/接收进行一些控制，你不会想要这样做。当然，我必须查看您的代码才能真正了解它如何适合。有github链接吗？:)

# windows-installer - 如何检查是否安装了 Windows Installer 3.1 或更高版本？

> ID：315717
> 
> 赞同：21
> 
> 时间：2008-11-24T22:22:14.743
> 
> 标签：windows-installer

我需要知道这一点，因为这是 .NET 3.5 的先决条件，如果我包含 .NET 引导程序，我还应该查看是否需要 Windows Installer 3.1。

现在我正在检查注册表项：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP3\KB893803v2 
```

它将检查 Windows Installer 3.1，但我怀疑它不会检查更高版本。（无法确认或否认）

我应该查看哪个注册表项来查找此信息？

编辑：我需要在 Inno Setup 中检查这个，这是我用作引导程序的东西，我不确定如何在那里检查 dll 版本。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-16T16:23:25.257

使用此注册表路径找到安装程序 msi.dll：HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer

值：安装程序位置

然后从该文件中获取版本信息。

更新：上面的方式很旧！此处记录了检测版本的新方法：http: [//msdn.microsoft.com/en-us/library/aa368280%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa368280%28VS.85%29.aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-12-01T17:01:12.810

在“运行”窗口中，键入“msiexec”。将出现一个窗口，在第一行显示 Windows Installer 版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-18T11:29:41.427

如果要检查系统上 Windows 安装程序 **的版本，请检查Windows\System 32 文件夹中的*MSI.DLL版本。***

右键单击 MSI.DLL ，选择属性 -> 转到详细信息选项卡并检查文件版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T23:04:35.813

如果这在 MSI 文件本身内，您可以检查[VersionMsi](http://msdn.microsoft.com/en-us/library/aa372493(VS.85).aspx)属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-24T12:44:51.090

请检查[此链接](http://www.pitribe.com/posts.aspx?id=2603.1467569276_check-windows-installer-version)可能对您有所帮助，因为它已经**适用于我**的**Windows 7**，希望也适用于其他版本的**Windows**以及检查 Windows Installer 版本。

# regex - 正则表达式/Textmate 混淆

> ID：315718
> 
> 赞同：1
> 
> 时间：2008-11-24T22:23:24.023
> 
> 标签：regex, textmate, oniguruma

我正在尝试创建一个 Textmate 片段，但遇到了一些困难。基本上，我想输入一个名称并将其拆分为各个部分。

例子，

比尔盖茨：（比尔），（比尔），（盖茨），（盖茨），（比尔盖茨），（比尔盖茨），（比尔盖茨），（比尔盖茨）

编辑**

因此，如果我使用编程语言，我肯定可以非常简单地产生这些结果。例如，我可以拆分单词，然后调用大写或小写函数来产生这个输出。

但在我的情况下，我使用 Textmate 及其正则表达式功能来创建选项卡片段。我想输入一些触发键，即doit，按tab，然后输入用户名。然后将创建上面的输出。这不会为我节省太多时间，但我觉得我在 Textmate 中经常遇到这类东西，并想弄清楚。

我一直在使用它作为参考，但仍然不知道如何使用正则表达式来选择单词和大小写的值（\u \U \l \L）

[http://manual.macromates.com/en/snippets](http://manual.macromates.com/en/snippets)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T23:33:01.340

您可以[将 Ruby 用于 textmate 片段](http://drnicwilliams.com/2008/06/11/using-ruby-within-textmate-snippets-and-commands/)。那应该使它更简单。

# javascript - VBScript chr() 似乎返回错误值

> ID：315719
> 
> 赞同：4
> 
> 时间：2008-11-24T22:23:25.647
> 
> 标签：javascript, vbscript, fromcharcode, chr

我正在尝试使用 chr() 将字符代码转换为字符，但 VBScript 并没有给我期望的值。根据 VBScript，字符代码 199 是：

```
ï¿½ 
```

但是，当使用 Javascript 的 String.fromCharCode 之类的东西时，199 是：

```
Ç 
```

第二个结果是我需要摆脱 VBScript 的 chr() 函数。知道问题是什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T22:26:33.720

**编辑以反映评论**

`Chr(199)`返回一个 2 字节字符，它被解释为 2 个单独的字符。

*   用于`ChrW(199)`返回一个`Unicode`字符串。
*   用于`ChrB(199)`将其作为单字节字符返回

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T22:25:27.093

编码是问题。Javascript 可能被解释为 latin-1；VBScript 可能使用了不同的编码并感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T22:29:22.780

`fromCharCode()`接受指定的值`Unicode`并返回一个字符串。

该`Chr()`函数将指定的`ANSI`字符代码转换为字符。

# ruby-on-rails - Rails：是否有跳过 after_save 过滤器的 save_without_validation 等效项？

> ID：315724
> 
> 赞同：4
> 
> 时间：2008-11-24T22:25:55.890
> 
> 标签：ruby-on-rails, after-save

我有一个 after_save 过滤器，我不想在特定实例中触发它。有没有类似于 save_without_validation 的方法？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-18T22:31:14.053

使用 rails 2 时，您可以通过以下方式调用私有方法`create_without_callbacks`：

```
@my_obj.send(:create_without_callbacks) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T02:20:53.310

这里有一个扩展 ActiveRecord 以提供回调跳过的好例子：[http ://weareintegrum.com/?p=10](http://weareintegrum.com/?p=10)

这个想法是在 ActiveRecord 上创建一个名为 skip_callback 的方法，该方法接受一个块：

```
def self.skip_callback(callback, &block)
  method = instance_method(callback)
  remove_method(callback) if respond_to?(callback)
  define_method(callback){ true }
  begin
    result = yield
  ensure
    remove_method(callback)
    define_method(callback, method)
  end
  result
end 
```

然后你在块中所做的任何事情都不会执行回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-16T04:01:48.063

您可以像这样设置和重置回调：

```
 Post.after_update.reject! {|callback| callback.method.to_s == 'fancy_callback_on_update' }
  Post.after_create.reject! {|callback| callback.method.to_s == 'fancy_callback_on_create' }

  Post.after_create :fancy_callback_on_create
  Post.after_update :fancy_callback_on_update 
```

您可以在自定义`save`方法周围添加这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-18T22:29:01.203

对于 Rails 2，您还可以使用以下方法：

`create_without_callbacks`或者`update_without_callbacks`

# asp.net - 控制器的动作名称本地化

> ID：315729
> 
> 赞同：1
> 
> 时间：2008-11-24T22:27:37.960
> 
> 标签：asp.net, asp.net-mvc, localization

我面临一个问题。我想在我的项目中本地化我的动作名称，以便法国人可以使用带有法语名称的干净网址。

[http://www.test.com/Home](http://www.test.com/Home)应该是[http://www.test.com/Accueil](http://www.test.com/Accueil)

这对于谷歌索引也是一件好事。此外，我想在应用程序上保持安静，所以我也想保留英文名称，因为开发人员（甚至是法国人）更喜欢使用英文名称。

我不知道这是否可能以及如何。

我的第一个想法应该是获取浏览器语言，将其分配给 CurrentThread.CurrentCulture，这样我就可以选择我想要的视图名称。

非常感谢您的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T22:32:15.130

您可以在 global.asax 中注册路由时执行此操作。

如果通常你有这个：

```
routes.MapRoute("Catalog-Brands", "catalog/brand/", new {controller = "Brand", action = "Index", isActive = true}); 
```

你也可以做这个（我不懂法语，抱歉）

```
routes.MapRoute("Catalog-Brands-French", "french-catalog/french-brand/", new {controller = "Brand", action = "Index", isActive = true}); 
```

您可以使它们在全球范围内全部可用，也可以单独使用：

```
public static void RegisterUsRoutes

public static void RegisterFrenchRoutes 
```

不过，您必须在应用程序启动时做出决定（您可能会也可能无法在运行时注册路由。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T00:02:44.603

如果你可以使用ISAPIs，也就是说如果你控制IIS，最好是使用ISAPI我推荐你Ionics Isapi： http: [//www.codeplex.com/IIRF](http://www.codeplex.com/IIRF)

它或多或少地实现了 Apache 中的 Rewrite mod 所做的（重定向）。

# c# - 如何防止 WCF 服务进入故障状态？

> ID：315736
> 
> 赞同：36
> 
> 时间：2008-11-24T22:31:33.553
> 
> 标签：c#, .net, wcf, msmq

我有一个不应进入故障状态的 WCF 服务。如果出现异常，则应将其记录下来，并且服务应继续不间断。该服务具有单向操作契约，并且正在从 MSMQ 读取消息。

我的问题有两个：

1.  该服务似乎正在吞噬异常/故障，因此我无法对其进行调试。如何让服务公开异常以便我可以记录或处理它？
2.  吞下此异常后，服务进入故障状态。如何防止服务进入故障状态？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-05-10T08:43:13.307

关于如何处理故障的官方文档在这里：

*   [**处理异常和故障**](http://msdn.microsoft.com/en-us/library/ms789039.aspx)

*   [**了解状态变化**](http://msdn.microsoft.com/en-us/library/ms789041.aspx)

主页位于[Channel Model Overview](http://msdn.microsoft.com/en-us/library/ms729840.aspx)

有一个很好的状态图显示了事情是如何发生的：

![在此处输入图像描述](https://i.stack.imgur.com/KXLng.gif)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-25T06:54:29.903

大多数（如果不是所有）异常都可以在 WCF 跟踪（[配置跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)）中看到，最好使用[服务跟踪查看器查看跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)。

显然，这不是您应该在生产环境中整天运行的东西，但无论如何它有助于故障排除。

除此之外，请注意，根据您使用的 SessionMode，oneways 可能不会像真正的“即发即弃”一样运行。如果您将服务配置为 SessionMode.Allowed 甚至 SessionMode.Required，则 oneway 操作将像根本不是 oneway 一样运行（在 netTcpBinding 上使用 oneway 时可以观察到这一点）。但是，坦率地说，我不知道这是否会改变您可以获得的异常类型，或者何时获得它们。但是，无论如何，如果根本无法发送请求，您应该得到一个异常。AFAIK，当它在服务器端成功排队时，单向“结束”。因此，在此之前（想到序列化/反序列化）会有一些地方（WCF 框架相关）异常。

然后，使用上面提到的跟踪/跟踪查看器可以最好地看到此类与框架相关的异常（即使是 IErrorHandler 也无法全部获取它们，因为它在请求/响应流中被调用时）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-24T22:41:14.550

异常会使代理出错。AFAIK 对此无能为力：不要导致异常；-p

我有点惊讶单向仍然会导致问题，但对于吞咽**，**一般有 3 个方面：

1.  你在抛出[错误](http://msdn.microsoft.com/en-us/library/ms733721.aspx)吗？还是例外？这很重要（并且应该是“错误”）
2.  作为 hack，您可以启用调试异常消息 - 但请关闭它！！！
3.  你在“使用”服务对象吗？我刚刚就这个确切的主题发表了[博客](http://marcgravell.blogspot.com/2008/11/dontdontuse-using.html)......基本上，你的“使用”可以吞下这个例外。3个选项：

    *   不要使用“使用”
    *   子类化代理并覆盖 Dispose()
    *   把它包起来，根据博客

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-12-02T15:12:01.140

通常 WCF 服务托管在 ServiceHost 中，如果 WCF 服务失败，那么唯一的选择是终止 WCF 服务并启动一个新服务。

ServiceHost 具有在 WCF 服务失败时激活的事件触发器“故障”：

```
ServiceHost host = new ServiceHost(new Service.MyService());
host.Faulted += new EventHandler(host_faulted);
host.Open(); 
```

可能会得到导致故障的异常，但需要做更多的工作：

```
public class ErrorHandler : IErrorHandler
{
    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {

    }

    public bool HandleError(Exception error)
    {
        Console.WriteLine("exception");
        return false;
    }
}

public class ErrorServiceBehavior : IServiceBehavior
{
    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {

    }

    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, Collection<ServiceEndpoint> endpoints, BindingParameterCollection bindingParameters)
    {

    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        ErrorHandler handler = new ErrorHandler();
        foreach (ChannelDispatcher dispatcher in serviceHostBase.ChannelDispatchers)
        {
            dispatcher.ErrorHandlers.Add(handler);
        }
    }
}

ServiceHost host = new ServiceHost(new Service.MyService());
host.Faulted += new EventHandler(host_faulted);
host.Description.Behaviors.Add(new ErrorServiceBehavior());
host.Open(); 
```

学分[http://www.haveyougotwoods.ca/2009/06/24/creating-a-global-error-handler-in-wcf](http://www.haveyougotwoods.ca/2009/06/24/creating-a-global-error-handler-in-wcf)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-25T07:12:15.313

关于 2)...

诀窍是您应该使用“使用”并且应该始终在引发异常的代理上调用 Abort()。文章[WCF Gotcha](https://web.archive.org/web/20110111204151/http://old.iserviceoriented.com/blog/post/Indisposable+-+WCF+Gotcha+1.aspx)解释了这一切。

我们使用受包装服务调用的那篇文章启发的服务类。这是我项目中的示例代码：

```
ServiceHelper<CodeListServiceClient, CodeListService.CodeListService>.Use(
    proxy => seasonCodeBindingSource.DataSource = proxy.GetSeasonCodes(brandID);
); 
```

这是ServiceHelper的代码，根据文章稍作修改。到目前为止，它为我们提供了很好的服务。

```
using System;
using System.ServiceModel;

namespace Sportina.EnterpriseSystem.Client.Framework.Helpers
{
    public delegate void UseServiceDelegate<TServiceProxy>(TServiceProxy proxy);

    public static class ServiceHelper<TServiceClient, TServiceInterface> where TServiceClient : ClientBase<TServiceInterface>, new() where TServiceInterface : class
    {
        public static void Use(UseServiceDelegate<TServiceClient> codeBlock)
        {
            TServiceClient proxy = null;
            bool success = false;
            try
            {
                proxy = new TServiceClient();               
                codeBlock(proxy);
                proxy.Close();
                success = true;
            }
            catch (Exception ex)
            {
                Common.Logger.Log.Fatal("Service error: " + ex);                                
                throw;
            }
            finally
            {
                if (!success && proxy != null)
                    proxy.Abort();
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-09-25T22:58:27.310

我遇到了一个问题，即在 ReceiveTimeout 异常之后 Channel 仍处于故障状态。这将导致任何后续连接都无法使用该服务。

对我来说，从故障状态恢复服务的修复方法是处理通信通道的故障事件：

```
 channelFactory = new ChannelFactory<IService>(endpoint);
 channelFactory.Faulted += OnChannelFaulted;
 var channel = channelFactory.CreateChannel(); 
```

然后定义 OnChannelFaulted：

```
 void OnChannelFaulted(object sender, EventArgs e)
 {
     channelFactory.Abort();
 } 
```

注意：我通过代码运行 WCF 配置，而不是在 Web.config 中使用绑定。

# html - 非常简单的 html 的意外边距

> ID：315738
> 
> 赞同：5
> 
> 时间：2008-11-24T22:32:18.577
> 
> 标签：html, css

我有一个非常简单的 html。红色 div 位于蓝色 div 内，顶部边距为 10 px。在非 ie 浏览器上，蓝色框距视口顶部 10 px，红色 div 位于蓝色 div 的最顶部。我期望的是 ie 行为：红色 div 必须与蓝色 div 的顶部相距 10 px。为什么非ie浏览器会这样渲染？（我想错误的行为是 IE，但为什么？）

而且，这样做的正确方法是什么？

[为什么空白？http://img92.imageshack.us/img92/7662/blankmr7.jpg](http://img92.imageshack.us/img92/7662/blankmr7.jpg)

```
<html>
<head>
<style>
body { margin:0; padding:0; }
.outer
{
    background-color: #00f;
    height: 50px;    
}
.inner
{
    height: 20px;
    width: 20px;
    background-color: #f00;
    margin: 10px 0 0 10px;
}
</style>
</head>
<body>
<div class="outer">
    <div class="inner">
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T23:16:03.667

尽管[strager 的回答](https://stackoverflow.com/questions/315738/unexpected-margin-with-very-simple-html#315759)已经解释了你需要知道的原因 - 即它发生在 IE 以外的浏览器中的方式，因为规范是这样说的 - 我认为他从该部分中选择了错误的引用关于[折叠边距](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)的[CSS 2.1 规范](http://www.w3.org/TR/CSS21/)。

他引用的观点解释了边距如何折叠，而不是它们如何“移动”到父元素。

这就是解释它的原因：

> *   如果盒子的顶部和底部边距相邻，则边距可能会通过它折叠。在这种情况下，元素的位置取决于它与边距被折叠的其他元素的关系。
>     *   如果元素的边距与其父元素的上边距折叠在一起，则框的上边框边缘被定义为与父元素的相同。

[或者，在Mozilla 开发人员文档](https://developer.mozilla.org/En/CSS/Margin_collapsing)中以更易于阅读的形式：

> **父母和第一个/最后一个孩子：**
> 
> 如果没有边框、内边距、内联内容或间隙将块的外边距顶部与其第一个子块的外边距顶部分开，或者没有边框、内边距、内联内容、高度、最小高度或最大-height 将块的边距底部与其最后一个子块的边距底部分开，然后这些边距折叠。折叠的边距最终在父级之外。

至于如何解决它，我可能会选择[Chris Lloyd 建议](https://stackoverflow.com/questions/315738/unexpected-margin-with-very-simple-html#315772)`overflow: auto`的解决方案（尽管这可能会产生副作用）。

但这真的取决于你的代码的其余部分到底是什么样的。在这个简单的示例中，您可以轻松地将子元素的*边距*更改为父元素的*填充。*

或者你可以浮动子元素，或者绝对定位它......

或者，如果您想变得非常花哨，那么反向[clearfix](http://www.positioniseverything.net/easyclearing.html)怎么样：

```
.outer:before {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T22:40:53.333

边距正在合并。IE 产生的输出可能不正确。

在规格中（目前对我来说是不利的）：

> 正常流程中两个或多个相邻的块框垂直边距折叠。生成的边距宽度是相邻边距宽度的最大值。

您可以使用边框代替边距，将边框颜色设置为透明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T22:45:39.190

这个问题有一个非常合适的答案：`overflow: auto;`

```
<html>
<head>
<style>
body { margin:0; padding:0; }
.outer
{
    background-color: #00f;
    height: 50px;
    overflow: auto;
}
.inner
{
    height: 20px;
    width: 20px;
    background-color: #f00;
    margin: 10px 0 0 10px;
}
</style>
</head>
<body>
<div class="outer">
    <div class="inner">
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T22:53:21.390

难道是 IE 将 DOM 视为 div.inner 将 div.outer 作为它的父节点（并计算它的偏移量），
而其他浏览器反而让它们都响应 body 元素？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T22:55:35.737

好的，没有自动溢出的解决方案：

```
<html>
<head>
<style>
body { margin:0; padding:0; }
.outer
{
    background-color: #00f;
    height: 50px;
    border: 1px solid transparent;
}
.inner
{
    height: 20px;
    width: 20px;
    background-color: #f00;
    margin: 10px 0 0 10px;
    padding: 0;
}
</style>
</head>
<body>
<div class="outer">
    <div class="inner">
    </div>
</div>
</body>
</html> 
```

内部元素想要推动一些东西，并提供一个边框（或强制浏览器考虑溢出）来做到这一点。

# javascript - jQuery 回调触发太早

> ID：315739
> 
> 赞同：0
> 
> 时间：2008-11-24T22:32:45.517
> 
> 标签：javascript, jquery, internet-explorer, callback

在使用 jQuery 将函数分配给 IE 7 中按钮的单击事件时，我遇到了问题。类似下面的东西在 Opera 中可以正常工作，但在 IE 中会产生无限循环：

```
function updateIndputFields(index, id) {
   $("#reloadBtn").click(function(){ updateIndputFields(index, id) });
} 
```

据我了解，在这种情况下，无限循环不会是预期的行为。但我是 jQuery 的新手，所以也许我错过了一些东西。无论如何，我应该怎么做才能在IE中将reloadBtn按钮的点击事件设置为'updateIndputFields（index，id）'？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T22:54:54.663

我认为您回答的关键在于取消绑定您已经绑定到 click 事件的事件。我在 IE 上使用了这个，如果我理解你想要做什么，它似乎可以满足你的需要：

```
<script type="text/javascript">
function updateIndputFields(index, id) {
$('#output').append('<p>' + index + ' : ' + id + '</p>');
$('#reloadBtn').unbind('click');
$("#reloadBtn").click(function(){ updateIndputFields(index, id) });
}
</script>
<p><a href="#" id="reloadBtn">reload</a></p>
<p><a href="#" onclick="updateIndputFields(1,2);return false;">start</a></p>
<div id="output"></div> 
```

每次单击都应将传递的参数恰好一次输出到输出 div 中。

如果您不取消绑定最初​​分配的单击事件，则它会保持存在，并且每次单击时都会将重复的单击事件处理程序附加到该事件。即使在 Firefox 中，不取消绑定事件也会产生有趣的递归情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T04:32:36.400

或者只是使用[.one](http://docs.jquery.com/Events/one#typedatafn)来绑定事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T22:38:36.113

在绑定之前尝试取消绑定事件。

# c++ - 检测连接丢失以修复网关？（快速解决）

> ID：315743
> 
> 赞同：2
> 
> 时间：2008-11-24T22:34:03.627
> 
> 标签：c++, sockets, connectivity, quickfix, fix-protocol

我正在尝试找到一种检测连接丢失的好方法。

我的适配器基于示例之一实现为 Fix::Application。它使用套接字启动器连接到修复网关。

当我拔下互联网时，Fix::Application 的 onLogout 方法大约需要 30 秒才能被触发。似乎某些底层类会更早地意识到套接字存在问题。有没有一种快速的方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T00:53:22.950

解决此问题的最佳方法可能是减少您的心跳间隔，以便您更快知道。我不知道任何因 TCP 连接丢失而触发的消息，但我认为 QuickFix 也没有监听操作系统事件。虽然，如果有这样的消息，它可能会通过 fromAdmin 事件。

您是否将问题发布到 QuickFix DL？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T00:46:59.037

当 TCP 断开连接时，您使用的修复引擎可能不会回调，或者它会回调 onLogout 以外的其他东西。由于您使用的是修复，我猜它会由于错过心跳而强制注销。

快速的方法是查看代码并检查正在处理套接字关闭的位置，以及发生这种情况时执行的路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-30T18:20:25.670

TCP 本身带有一种称为[SO_KEEPALIVE](http://www.unixguide.net/network/socketfaq/4.7.shtml)的本机心跳机制。问题是此心跳的默认间隔可能高达 2 小时。这是在操作系统级别配置的。所以理论上你可以开启SO_KEEPALIVE，在OS层面配置合理的心跳间隔，开心就好。但是，因为如上所述这非常依赖于操作系统，所以大多数应用程序选择在应用程序级别实现心跳，FIX 也不例外。减少您的 FIX 心跳间隔是这里的方法，特别是如果您依赖于断开连接时取消，并且额外的未检测到的连接丢失秒数可能会导致不需要的订单执行。在任何修复引擎之上实现的 FIX 网关应该支持开箱即用的心跳配置。看看[CoralGateway](http://www.coralblocks.com/index.php/category/coralgateway/)例如。（免责声明：我是 CoralGateway 的开发者之一）

# c# - 事件处理程序问题 c#

> ID：315744
> 
> 赞同：0
> 
> 时间：2008-11-24T22:34:43.143
> 
> 标签：c#, outlook, event-handling

我有一个句柄，当在 Outlook 中的已发送邮件文件夹上触发 ItemAdd 事件时触发。此句柄会提示用户，然后根据他们的选择打开自定义窗口表单以保存发送的电子邮件。

现在......继承人会发生什么......

*   将项目放入“已发送项目”文件夹时提示显示正常，如果您将其关闭，下次触发事件时它会再次显示正常，依此类推。
*   如果您接受提示，将显示 Windows 窗体并能够保存电子邮件。但是下次将电子邮件放入已发送的项目文件夹时，事件不会触发，因此提示甚至不会显示！
*   如果我在 Outlook OnSend 事件上而不是在已发送项目文件夹的 ItemAdd 上放置相同的句柄，则所有工作都一样，除非在第一次加载 Windows 窗体后它将继续加载（即事件触发并被处理) 下次你想要它时完美。

由于某种原因，似乎显示 Windows 窗体会导致事件停止触发或句柄丢弃已发送的项目文件夹（但只有已发送的项目文件夹）。我认为后者更有可能。我有一个变通的想法，但如果我能侥幸成功的话，我并不是真的很喜欢变通。

有人知道这里可能发生什么吗？

非常感谢人们可能有的任何想法。

干杯，斯图夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-03T02:04:15.310

我有一个类似的问题。听起来您的变量之一正在收集垃圾。如果您可以发布一些代码，我可能会为您提供帮助。

# asp.net - 表单元素弄乱了 ASP.NET 中导入的 HTML/CSS 布局模板

> ID：315745
> 
> 赞同：0
> 
> 时间：2008-11-24T22:34:54.203
> 
> 标签：asp.net, layout

我想为我的 ASP.NET 网站使用这个纯 HTML/CSS 模板：

[http://sub3.tanguay.de](http://sub3.tanguay.de)

我将它复制到我的 Default.aspx 页面中，在 FORM 元素内，但是表单弄乱了布局：

[http://sub2.tanguay.de](http://sub2.tanguay.de)
**更新：现在可以正确显示，这要感谢 Devio。**

我尝试更改表单标签的样式，但无法让它停止影响布局，我尝试过：

```
style="margin: 0px; padding: 0px; display: inline; background-color: transparent;" 
```

*   在将布局模板复制到 ASP.NET 时，这是一个常见问题吗？
*   有没有简单的解决方法，比如一些 margin:-2px 修复或类似的东西？
*   当然，我需要为 ASP.NET 功能保留表单标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-30T16:56:31.680

我遇到了同样的问题并将表单元素更改为以下固定内容：

```
<form id="form1" runat="server" style="display: inline; background-color: transparent;"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T22:46:48.563

1）尝试从表单类中删除背景颜色属性：

```
form {
    margin:10px; padding: 0;
    border: 1px solid #f2f2f2; 
    background-color: #FAFAFA; /* remove this */
} 
```

2）您不能嵌套表单，但搜索表单包含在 ASP.Net 表单中，并且 ASP.Net 每页只需要一个表单标记。

# c# - 嘲笑傻瓜？

> ID：315747
> 
> 赞同：15
> 
> 时间：2008-11-24T22:36:09.940
> 
> 标签：c#, .net, asp.net, unit-testing, mocking

我是新手，我有一个新的 .net Web 项目，它位于 UI->BLL->DAL->DB 结构中，我目前使用 NUnit 进行一些测试。我打算用它来测试中间层，所以我不必实际写入数据库。

现在，我从来没有做过任何模拟，不知道从哪里开始，所以我正在寻找一个有一些端到端示例的模拟框架！有人能指点我一些从头开始的嘲笑材料吗？请提供完整的样本？

谢谢，

射线。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-25T07:40:11.887

你应该在 Dimecasts.net 上查看一些关于模拟的视频，这是一种快速了解模拟是什么并开始编写你自己的代码的方法。

[起订量简介](http://dimecasts.net/Casts/ByTag/Moq)

[RhinoMocks 简介](http://dimecasts.net/Casts/ByTag/Rhino%20Mocks)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T08:55:13.390

目前有许多不同的模拟框架。我建议您看看 RhinoMock 或 TypeMock。两者对于个人/开源项目都是免费的。TypeMock 也有公司许可证。

RhinoMock 强制您重构代码以实现可测试性（如果需要，如果您已经有可测试的代码，那么您做得很好）。这需要更多的工作，但它会给你留下松散耦合的代码，这本身就是一个福音。由于这个原因，有些结构你根本不能直接用 Rhino 模拟。但是，您始终可以引入额外的间接层并以这种方式解决它。然而，底线是：您需要做更多的工作，但最终重构将使您的代码受益。

另一方面，TypeMock 通过动态修改代码来工作（它使用分析器 API 来注入代码）。这允许您对不适合此类测试的代码使用模拟。TypeMock 几乎可以让您模拟任何东西（mscorlib 除外），因此它很容易上手，并且可以很好地与遗留代码配合使用。但是，由于您不必重构代码，因此您不会获得松散耦合类型的额外好处。此外，由于运行代码被修改，TypeMock 有时会导致非常奇怪的错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T22:44:41.953

[Rhino Mocks](http://ayende.com/projects/rhino-mocks.aspx)是一个你可以使用的框架，我已经使用了一点。

[备忘单](http://weblogs.asp.net/rosherove/archive/2007/01/29/cheat-sheets-for-asp-net-regex-mock-objects-and-more.aspx)有一些链接，如果您想尝试其他一些，尽管这篇文章有点过时了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T22:53:14.993

类型模拟？...

好吧，对我来说最好的模拟 - 接口，对你的代码进行一些重构，并弄清楚你想要测试什么，这样你就不需要任何模拟了。或者 - 任何依赖注入来模拟一些东西（但在你需要重构之前）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T13:20:22.630

您可能对我们正在编写的书感兴趣[http://www.mockobjects.com/book](http://www.mockobjects.com/book)。它是 Java，但原理是相同的。

# javascript - 下载完成时触发 javascript 代码

> ID：315752
> 
> 赞同：0
> 
> 时间：2008-11-24T22:37:04.057
> 
> 标签：javascript, html

我需要更新一对旧的经典 asp`search.asp`页面——一个提供简单表单的页面，然后将其发布到`results.asp`页面。搜索页面上的表单选项之一是“格式”的下拉列表 ( `<select`)。如果用户选择 excel 格式，结果页面只需将 Response.ContentType 设置为`application/vnd.ms-excel`并添加内容处置标头以设置文件名并使其成为附件。就是这样：由 excel 来正确渲染 html，它通常做得很好。

所有这些都很好，除了一件事。Excel 选项的原因是，在这种情况下，用户确实希望在一次搜索中看到多达 10,000 个甚至更多的项目。他们将使用 Excel 对结果进行一些额外的分析。所以搜索操作通常只需要一分钟多一点，我无法改变它。

那一分钟的用户体验不太理想。不仅用户只是坐在那里几乎没有反馈，而且经常有足够的结果导致页面溢出响应缓冲区。这意味着页面必须定期刷新，因此文件会立即开始下载，但下载管理器本身无法提供有意义的反馈。我的任务是改善这种情况。

第一步是`processing...`在表单提交时在搜索页面上显示一条简单的消息，我可以很容易地做到这一点。事实上，它已经为“HTML”格式选项这样做了。问题是，当下载 Excel 文件时，我不知道如何告诉有关下载的任何信息，因此我可以再次隐藏该消息，并且现有的实现根本没有提供任何有关下载进度的反馈。有任何想法吗？如果我可以在下载完成时触发一个 javascript 函数，我可以将任何东西与它挂钩，但我什至还不能这样做。

**更新：**
我重新措辞了这个问题，试图更清楚地提出问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T14:28:17.430

据我所知，浏览器不会提供任何关于下载进度的挂钩。理论上，你可以在服务器端做点什么，然后使用 AJAX 来查询服务器，看看已经发送了多少下载，但我不知道该怎么做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:43:50.020

我建议考虑修改您的上传方法以使用类似 SWFUpload 的东西，它允许对代码进行 JavaScript 回调。上传文件后（假设您正在存储它），我会考虑将文件名和类型传递到您的 Results.asp 页面，然后它将从文件存储中检索它。它不如将其保存在您的问题中回避的内存中那么安全；但是，将提供更好的用户体验，并可能提供您需要的回调解决方案。

[http://swfupload.org/](http://swfupload.org/)

这是一个 jQuery 插件示例，它使上传过程和 SWFUpload 集成变得容易： http: [//blog.codeville.net/2008/11/24/jquery-ajax-uploader-plugin-with-progress-bar/](http://blog.codeville.net/2008/11/24/jquery-ajax-uploader-plugin-with-progress-bar/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T23:14:55.417

嗯，有可能通过ajax来做到这一点吗？即，用户选择格式，通过 ajax 发送查询，并将相应的文档加载到 search.asp 上的 iframe 中。然后，您可以在 ajax 调用中获取成功事件并适当地处理消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T23:21:59.740

您可以通过添加标题将文件作为附件下载，以便用户的浏览器保持正常运行。我意识到这并不是您所要求的；但是如果你将它与你用于 HTML 版本的插页式页面结合起来，它可能会改善用户体验。

```
Response.AddHeader "Content-Disposition", "attachment; filename=report.xls" 
```

用户将看到带有处理图形的插页式页面，然后重新发布搜索表单。这将允许显示“正在处理...”图形，直到页面弹出 Excel 文件的下载提示。

**更新：**我尝试使用 iframe，让页面定期检查文档对象并在切换到 Excel 时捕获“接口不存在”错误，但是当 Excel 文档在 iframe 中下载时，它仍然锁定浏览器。 .我认为纯js解决方案行不通。在那之后，我认为下一个最好的途径是（不幸的是）Flash。祝你好运。

# asp.net - 基于 ASP.NET 的工作流引擎

> ID：315758
> 
> 赞同：8
> 
> 时间：2008-11-24T22:38:50.670
> 
> 标签：asp.net, workflow

我正在为一个受工作流驱动的新应用程序设计规范。

在我重新发明轮子之前，是否已经有一个像样的轻量级工作流引擎可以插入到 ASP.NET 中？

基本上，我正在寻找能够在自动处理状态管理的同时处理通过一组定义的工作流页面移动的东西。

如果还没有，我肯定会尝试从我的应用程序中抽象出引擎并将其放在 codeplex 上，因为它真的很方便。

有什么建议么？

注意：.NET 2.0，所以没有 WWF，尽管我认为 WWF 对我的需求来说太过分了。

编辑：似乎有一个合法的需求，并且那里没有产品......所以我可能会建造这个。

这是我所描绘的：

*   称为 WebFlowPage 的自定义页面类
*   所有 WebFlowPage 都在工作流映射器中注册。
*   每个 WebFlowPage 都有某种形式的状态对象。
*   HttpHandler 处理基于工作流选择适当的 WebFlowPage，并从状态对象中填充它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-24T04:12:57.017

我认为“工作流程”一词非常容易解释。我最近一直在使用一种与您所描述的非常不同的工作流程。Mine 是一个基于状态机的工作流，其中特定记录的状态决定了用户可以采取哪些操作来将记录移动到业务流程的下一步。因此，在这种情况下，“工作流程”意味着记录如何从一种状态流向另一种状态，直到最终完成。

您对工作流的使用似乎更多地与在线性多步骤过程中将用户从一个页面移动到另一个页面有关，这是一个完全不同的用例（如果我错了，请纠正我）。因此，在提出任何人都可以使用的通用“工作流”引擎之前，我建议更好地定义该系统将处理的情况类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T00:26:11.170

Not sure exactly what you wish to do here, but [Ra-Ajax](http://ra-ajax.org) can easily keep state at least if you want your solution ajaxified...

For reference purposes you might want to check out the [Ajax Calendar sample](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx) or even the (banalistically implemented) [Ajax Wizard sample](http://ra-ajax.org/samples/Ajax-Wizard.aspx). It surely beats the hell out of doing it with JavaScript...

And every time you "do something" you're in "server-land" which means you can store temporaries all the time as you wish...

The project is LGPL

(PS! Yes I do work with it)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T21:22:31.020

构建自定义工作流引擎并非易事，尽管乍一看似乎很简单。我们已经尝试过了。这在很大程度上取决于您需要涵盖的逻辑的复杂性。

鉴于 Windows Workflow Foundation 的当前状态以及缺乏另一个抽象工作流概念的框架，如果您需要复杂的逻辑、异步处理或工作流中的分支，我会选择 WF。

通过工作流跟踪您的状态可以通过携带某种 xml 有效负载或将状态存储在数据库中来完成，

如果您的工作流程实际上是一组需要用户填写的顺序表单，那么可以通过一些简单的自定义解决方案来完成跟踪步骤并引导用户进行下一步。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T00:00:24.640

工作流是动态的还是静态的？

如果工作流程很简单，您可以推出自己的工作流程引擎。在某些情况下，它可以相当简单，只需几个数据表来处理规则、处理和状态。

许多工作流引擎是为大规模处理（例如信用卡应用程序）而构建的。对于小规模，您至少应该考虑自己的，这将消除/对引擎的开销和依赖。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T21:13:50.383

你也可以看看[InRule](http://inrule.com/)引擎。此外，还有[nxBRE](http://nxbre.wiki.sourceforge.net/SimpleFactsAndQueries)。

这些也主要用于业务规则。InRule 是专有的，而 nxBRE 支持 RuleML（事实上的标准）。

您可能需要为页面制作自己的实现，并将规则引擎用作“结构”。

目前，我知道 Sharepoint 2007 支持页面工作流（使用 WF），但这意味着使用 .NET Framework 3 和部署 sharepoint。

我的建议是使用任何你觉得更轻、更容易使用的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-08T20:41:51.790

在网上浏览一些工作流和 BPM 资源时，我发现了以下项目：[NetBPM](http://www.netbpm.org/)。不幸的是，该项目似乎已停止。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-04T19:43:08.093

我已经使用了几个月[http://objectflow.codeplex.com](http://objectflow.codeplex.com)。不是特定的，但它可能适合您的需求

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-08T19:44:29.257

工作流程选项很少。“Aspose”和“Skelta”是我正在评估的报价。

法比奥

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T22:57:23.237

我不认为有一个工作流引擎会自动为您处理状态，但是如果您正在浏览一组页面，例如电子商务网站上的结帐等流程，也许 ASP.NET 向导控件可以帮助您？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-05T08:40:12.960

您可以使用[WorkFlow Engine](https://workflowengine.io/)，只需阅读[文档](https://workflowengine.io/documentation)并运行[Demo](https://workflowengine.io/demo/designer/)即可。他们在其中添加的动态工作流引擎所需的所有功能。

# javascript - 用 JavaScript 确定一个月天数的最佳方法是什么？

> ID：315760
> 
> 赞同：122
> 
> 时间：2008-11-24T22:41:05.143
> 
> 标签：javascript, date

我一直在使用此功能，但我想知道获得它的最有效和最准确的方法是什么。

```
function daysInMonth(iMonth, iYear) {
   return 32 - new Date(iYear, iMonth, 32).getDate();
} 
```

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2008-11-24T22:44:29.627

```
function daysInMonth (month, year) { // Use 1 for January, 2 for February, etc.
  return new Date(year, month, 0).getDate();
}

console.log(daysInMonth(2, 1999)); // February in a non-leap year.
console.log(daysInMonth(2, 2000)); // February in a leap year.
```

第 0 天是上个月的最后一天。因为月份构造函数是从 0 开始的，所以这很好用。有点小技巧，但这基本上就是你通过减去 32 所做的。

查看更多： [当月的天数](https://stackoverflow.com/a/69267613/7942242)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-07T02:33:52.660

一些答案（也在其他问题上）有闰年问题或使用了日期对象。尽管 javascript`Date object`涵盖了 1970 年 1 月 1 日前后大约 285616 年（100,000,000 天），但我厌倦了不同浏览器（最明显的是 0 年到 99 年）之间出现的各种意外日期[不一致。](http://people.cs.nctu.edu.tw/~tsaiwn/sisc/runtime_error_200_div_by_0/www.merlyn.demon.co.uk/js-datex.htm)我也很好奇如何计算它。

所以我写了一个简单的*小*算法来计算*正确*的（[Proleptic](http://en.wikipedia.org/wiki/Proleptic_Gregorian_calendarhttp://en.wikipedia.org/wiki/Proleptic_Gregorian_calendar) [Gregorian](http://en.wikipedia.org/wiki/Gregorian_calendar) / Astronomical / ISO 8601:2004（条款 4.3.2.1），所以存在[年份`0`](http://en.wikipedia.org/wiki/0_%28year%29)并且是闰年并且*支持负年份*）天数给定的月份和年份。
它使用[短路位掩码模leapYear算法](https://stackoverflow.com/a/11595914/588079)（针对js稍作修改）和常见的mod-8月算法。

请注意，在`AD/BC`符号中，公元 0 年/公元前 0 年不存在：相反，年份`1 BC`是闰年！
如果您需要考虑 BC 表示法，那么只需先减去（否则为正）年份值的一年！（或从中减去年份`1`以进行进一步的年份计算。）

```
function daysInMonth(m, y){
  return m===2?y&3||!(y%25)&&y&15?28:29:30+(m+(m>>3)&1);
}
```

```
<!-- example for the snippet -->
<input type="text" value="enter year" onblur="
  for( var r='', i=0, y=+this.value
     ; 12>i++
     ; r+= 'Month: ' + i + ' has ' + daysInMonth(i, y) + ' days<br>'
     );
  this.nextSibling.innerHTML=r;
" /><div></div>
```

注意，月份必须从 1 开始！

请注意，这是一种不同的算法，与我在[Javascript 中使用的幻数查找计算一年中的哪一天 (1 - 366)](https://stackoverflow.com/a/27790471/588079)答案不同，因为这里仅在二月需要闰年的额外分支。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-03-29T11:44:50.020

如果您经常调用此函数，则缓存该值以获得更好的性能可能很有用。

这是[FlySwat 答案](https://stackoverflow.com/questions/315760/what-is-the-best-way-to-determine-the-number-of-days-in-a-month-with-javascript#315767)的缓存版本：

```
var daysInMonth = (function() {
    var cache = {};
    return function(month, year) {
        var entry = year + '-' + month;

        if (cache[entry]) return cache[entry];

        return cache[entry] = new Date(year, month, 0).getDate();
    }
})(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-14T10:10:58.957

为了消除混淆，我可能会基于月份字符串，因为它目前是基于 0 的。

```
function daysInMonth(month,year) {
    var monthNum =  new Date(Date.parse(month +" 1,"+year)).getMonth()+1
    return new Date(year, monthNum, 0).getDate();
}

daysInMonth('feb', 2015)
//28

daysInMonth('feb', 2008)
//29 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-22T09:48:19.707

使用[moment.js](http://momentjs.com/)，您可以使用 daysInMonth() 方法：

```
moment().daysInMonth(); // number of days in the current month
moment("2012-02", "YYYY-MM").daysInMonth() // 29
moment("2012-01", "YYYY-MM").daysInMonth() // 31 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-04T11:43:36.787

这里是

```
new Date(2019,2,0).getDate(); //28
new Date(2020,2,0).getDate(); //29 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-06-15T01:16:48.710

ES6 语法

```
const d = (y, m) => new Date(y, m, 0).getDate(); 
```

返回

```
console.log( d(2020, 2) );
// 29

console.log( d(2020, 6) );
// 30 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-06T22:33:05.347

```
function numberOfDays(iMonth, iYear) {
         var myDate = new Date(iYear, iMonth + 1, 1);  //find the fist day of next month
         var newDate = new Date(myDate - 1);  //find the last day
            return newDate.getDate();         //return # of days in this month
        } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-22T18:48:15.527

考虑闰年：

```
function (year, month) {
    var isLeapYear = ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0);

    return [31, (isLeapYear ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-09-13T10:09:16.990

单线直接计算（无 Date 对象）：

```
function daysInMonth(m, y) {//m is 1-based, feb = 2
   return 31 - (--m ^ 1? m % 7 & 1:  y & 3? 3: y % 25? 2: y & 15? 3: 2);
}

console.log(daysInMonth(2, 1999)); // February in a non-leap year
console.log(daysInMonth(2, 2000)); // February in a leap year
```

从 0 开始的月份的变化：

```
function daysInMonth(m, y) {//m is 0-based, feb = 1
   return 31 - (m ^ 1? m % 7 & 1:  y & 3? 3: y % 25? 2: y & 15? 3: 2);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-03-09T01:06:12.460

如果您想要 Date 对象当前月份的天数，请考虑以下方法：

```
Date.prototype.getNumberOfDaysInMonth = function(monthOffset) {
    if (monthOffset !== undefined) {
        return new Date(this.getFullYear(), this.getMonth()+monthOffset, 0).getDate();
    } else {
        return new Date(this.getFullYear(), this.getMonth(), 0).getDate();
    }
} 
```

然后你可以像这样运行它：

```
var myDate = new Date();
myDate.getNumberOfDaysInMonth(); // Returns 28, 29, 30, 31, etc. as necessary
myDate.getNumberOfDaysInMonth(); // BONUS: This also tells you the number of days in past/future months! 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-10-06T12:05:38.673

在一行中：

```
// month is 1-12
function getDaysInMonth(year, month){
    return month == 2 ? 28 + (year % 4 == 0 ? (year % 100 == 0 ? (year % 400 == 0 ? 1 : 0) : 1):0) : 31 - (month - 1) % 7 % 2;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-03-17T13:58:36.160

与选定的答案相比，可能有点过分杀戮:)但这里是：

```
function getDayCountOfMonth(year, month) {
  if (month === 3 || month === 5 || month === 8 || month === 10) {
    return 30;
  }

  if (month === 1) {
    if (year % 4 === 0 && year % 100 !== 0 || year % 400 === 0) {
      return 29;
    } else {
      return 28;
    }
  }

  return 31;
};

console.log(getDayCountOfMonth(2020, 1));
```

我在这里找到了上面的代码：[https ://github.com/ElemeFE/element/blob/dev/src/utils/date-util.js](https://github.com/ElemeFE/element/blob/dev/src/utils/date-util.js)

```
function isLeapYear(year) { 
  return ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0); 
};

const getDaysInMonth = function (year, month) {
  return [31, (isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
};

console.log(getDaysInMonth(2020, 1));
```

我在这里找到了上面的代码：[https ://github.com/datejs/Datejs/blob/master/src/core.js](https://github.com/datejs/Datejs/blob/master/src/core.js)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-05-03T14:04:17.367

如果您要传递日期变量，这可能会有所帮助

```
const getDaysInMonth = date =>
  new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();

daysInThisMonth = getDaysInMonth(new Date());

console.log(daysInThisMonth);
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-27T23:02:04.600

单线，不使用 Date 对象：

```
const countDays = (month, year) => 30 + (month === 2 ? (year % 4 === 0 && 1) - 2 : (month + Number(month > 7)) % 2); 
```

返回：

```
countDays(11,2020) // 30
countDays(2,2020) // 29
countDays(2,2021) // 28 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-21T10:50:33.707

获取**当月****的天**数

 **```
let nbOfDaysInCurrentMonth = new Date(Date.UTC(new Date().getUTCFullYear(), new Date().getUTCMonth(), 0)).getDate()

console.log(nbOfDaysInCurrentMonth)
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-11-08T19:31:47.697

也许不是最优雅的解决方案，但易于理解和维护；而且，它经过了实战考验。

```
function daysInMonth(month, year) {
    var days;
    switch (month) {
        case 1: // Feb, our problem child
            var leapYear = ((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0);
            days = leapYear ? 29 : 28;
            break;
        case 3: case 5: case 8: case 10: 
            days = 30;
            break;
        default: 
            days = 31;
        }
    return days;
}, 
```

# visual-studio-2008 - 是否可以让班级文档中的不同成员具有不同的颜色？

> ID：315770
> 
> 赞同：1
> 
> 时间：2008-11-24T22:45:18.440
> 
> 标签：visual-studio-2008

我正在使用 Visual Studio 2008 Professional 并且想知道，如何为类方法中的方法调用和属性/字段设置不同的颜色？这会很好，因为它可以让我快速直观地了解我的课程有太多内容（例如 20 个字段和 2 个方法 - 这将为我提供一些关于我的设计的有趣信息 - 无论如何，我不会这样做）。

理想情况下，我希望突出显示这些成员，就像您通过时一样。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T17:23:21.680

Out of the box, I do not believe it is possible in Visual Studio 2008\. You might need an aftermarket addon to implement this specific functionality. You could always look into [Visual Assist X](http://www.wholetomato.com/tour.asp?syntax), although it is a commercial product.

# continuous-integration - CruiseControl.Net：如何清除过时的构建历史？

> ID：315778
> 
> 赞同：8
> 
> 时间：2008-11-24T22:51:09.100
> 
> 标签：continuous-integration, cruisecontrol.net

我刚开始使用 CCNet，在设置我的构建项目的过程中，我积累了很多从试验和错误中获得的构建历史。我真的不想保留那些旧东西，但我似乎看不出在哪里/如何摆脱它。我确信这是一个愚蠢的问题，如果我忽略了一些应该很明显的事情，我深表歉意。我做了大约半小时的[RTM](http://confluence.public.thoughtworks.org/display/CCNET/Documentation)和 Google，并浏览了我的 CCNet 安装，但它并没有对我产生影响。我删除了项目的状态文件（不知道这是否与它有关），但如果我从仪表板深入了解项目的统计信息，旧版本仍然存在。有什么建议么？谢谢。

**回答**：我已经明确地将 artifacts 目录设置到了一个不在 CCNet 服务器目录下的位置，因此再也没有查看过它……去寻找，迪斯科，那里有构建历史。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-01-26T14:29:36.663

不要忘记您可以使用[Artifact Cleanup Publisher](http://www.cruisecontrolnet.org/projects/ccnet/wiki/Artifact_Cleanup_Publisher)来防止您的构建历史随着时间的推移增长到火星的大小。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T23:05:11.240

假设您有一个名为“Dev”的项目并且您已将 CCNet 安装到默认位置，您将拥有一个名为：

c:\Program Files\CruiseControl.NET\server\Dev

和一个 Dev.state 文件：

c:\Program Files\CruiseControl.NET\server

只需删除文件夹和状态文件即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-22T23:44:13.053

您正在寻找的是“工件”文件夹。检查您的 ccnet.config 文件中的标记

停止您的服务，删除工件目录文件夹，然后重新启动您的服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-09T23:15:42.127

日志存储在 artifacts\MyProjectName\Build\log*.xml 下的 artifacts 目录中。

状态文件存储诸如上次构建日期、时间、信息之类的内容。

最好停止服务，然后删除*ProgFiles\CC.net\server 中的 .state 并删除 artifacts\MyProjectName\Build\log* .xml 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-14T12:57:03.683

如上所述，使用 Artifact Cleanup Publisher 将工件的数量保持在合理的水平。

如果您有很多项目并且需要进行回顾性清理，您可以使用以下 Powershell 脚本来删除旧的日志文件：

```
$limit = (Get-Date).AddDays(-60)

get-childitem -Path D:\Builds -filter MatchMyProjects.* | %{ 
    $projectPath=$_.FullName
    $logsPath=$projectPath + "\Logs"    
    write-host Removing logs from folder $logsPath
    Get-ChildItem -Path $logsPath -Force -Filter *.xml | Where-Object { !$_.PSIsContainer -and $_.CreationTime -lt $limit } | Remove-Item -Force
} 
```

感谢这个答案：[使用 PowerShell 删除超过 15 天的文件](https://stackoverflow.com/questions/17829785/delete-files-older-than-15-days-using-powershell)

# asp.net - ASP.NET 主题未正确呈现

> ID：315780
> 
> 赞同：0
> 
> 时间：2008-11-24T22:51:54.073
> 
> 标签：asp.net, deployment

我有一个使用主题的小型 Web 应用程序。主题在主机上工作，以此类推，如果主机 = a，则加载 x 主题，如果主机 = b，则加载 y 主题。

在我的代码中，这看起来像：

If request.url.host.contains("a") Then Page.Theme = x Else request.url.host.contains("b") Then Page.Theme = y

我有一个 url 是 a.abc.com 和另一个是 b.abc.com （这是这个结构，但字母是有意义的/公司名称）。问题是（并且我已经完成了 host == ""），当我在 localhost 上调试我的站点时（上面 if 块中的另一个子句 where host = localhost），样式呈现完美。正如我在css中为宽度、边距等提供的数值所期望的那样，元素的对齐是完美的。但是当我使用 VS2008 的发布工具（勾选可更新），并上传到与 localhost 具有相同样式表的 a.abc.com（在其自己的文件夹中的副本）时，就会出现各种对齐问题，好像我没有做任何工作。为什么我的样式在@运行时渲染不正确？如果有帮助，我正在使用 VS2008 Pro Edition、IIS6 和 Windows Server 2003。

令人沮丧的是，页面源代码表明主题加载正常，因为它在 HTML 头部中被引用。因此，当我发布时，会加载并引用 a.abc.com 的主题。除了所有这些信息之外，没有明显迹象表明问题出在哪里。我没有尝试在 ASPX 标记中按惯例引用单个 CSS 文件，但如果我这样做了并且这有效，那么无论如何它也不能解释问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T23:34:37.763

您是否在代码中足够早地设置了主题？如果您在代码隐藏中执行，则必须在请求生命周期的早期，在 PreInit 事件中将主题应用于页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-01T23:26:47.643

我最近遇到了这个问题，并写[了一篇快速博客来解释如何解决它](http://johnmcavinue.ie/Blog/Asp.net-Theme-does-not-work-on-Login-page)。万一其他人遇到这个问题，你只需要在你的 web.config 中授权 Theme 文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T09:21:26.940

是的，它在页面 preinit 上。

我认为这与表单身份验证有关。如果我查看（而不是调试）登录页面，它会选择 localhost 主题并正确显示所有内容。登录控件位于页面中间，应该是这样，等等。

但是，如果我调试页面，并且如您所料，登录页面是开始/默认页面，登录控件会像我部署时一样显示在左侧，并且源指示已选择适当主机的 css up - 只有当我调试时，在我登录之前没有应用任何样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T22:18:32.770

你在使用内置的网络服务器吗？在 ASP.Net Development Server 中运行时，App_Themes 中的样式不会用于任何未经身份验证的页面（例如 Login.aspx 或 ForgotPassword.aspx）。那是因为用户还没有对该文件夹的浏览权限，或者 App_Themes 文件夹没有浏览权限。显然，IIS 处理了这个，但 Cassini 没有。

尝试将此添加到 web.config 以让主题和样式在身份验证之前工作。

或者，如果可能，切换到在您机器上的 IIS 上运行该应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-29T10:05:58.820

我已经启用并安装了所有子功能

`Internet Information Services --> World Wide Web Services --> Common HTTP Features`

这由 Theme not working 问题解决。

# java - 开发应用程序以本地运行或跨平台运行？

> ID：315782
> 
> 赞同：5
> 
> 时间：2008-11-24T22:52:51.467
> 
> 标签：java, macos, cross-platform

对于应该为特定平台编写应用程序还是使用跨平台方法并接触更多潜在客户，您有什么看法？

这将是一个基于 GUI 的应用程序，我正在考虑使用 Java。

我使用的大多数基于 Java 构建的应用程序在各自平台上的运行不如本地应用程序流畅。

我想到的两个平台是windows和macs。

如果我只是为了自己的使用而创建应用程序，并且我必须选择一个系统，我会选择专注于 mac。

我想听听你的想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T00:31:28.850

I would use Qt and yes, definitely target Cross Platform...

The major reason isn't in fact what you think it is (being cross platform by itself) but actually that by targeting multiple platforms your code by some freaking weird magical reasons tends to end up with far better code quality. I've seen this happen countless times in my own projects. Every time I add a new platform the quality of the code increases and the code becomes more clean...

Also every serious app should have as few "dependencies" as possible, being cross platform means you have less dependencies... ;)

Then as a "bonus" you get to your app to run on multiple platforms...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T22:59:26.837

要求，要求，要求。

严肃地说，“这取决于”是正确的答案。

真正的跨平台是艰苦的工作；在您/您的用户熟悉的地方工作是值得的。以有效的方式解决问题确实是重中之重。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T23:02:22.773

一般来说，跨平台开发作为一种艺术形式有点被高估了。Java 是这里的领先技术，但即使在这种情况下，大多数 Java 程序员也不会真正跨平台。Vuze、LimeWire 和 JRipper 等工具在任何地方都能很好地工作，但从统计数据来看，这些都是例外。大多数 Java 应用程序，尤其是企业类型的应用程序，都是针对一个平台进行编码的，而且它们从不真正移动。

如果您想使用 Mac 和 Windows，请考虑花时间研究 Limewire 和 Vuze 代码库。这两个应用程序在两个平台上都运行得非常好。

你肯定需要两个构建。一个版本可能不会做。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T22:57:58.040

建议先针对自己觉得舒服的平台开发，可以利用所有平台噱头的地方；在这种情况下，这将是 OS X。

稍后，如果您的应用程序在 Mac 上成功，请查看移植选项。IMO 不值得在移植上投入精力，直到确定首先会对应用程序产生重大兴趣。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T23:04:25.110

在这个时代，编写原生代码真的有充分的理由吗？

是的。可用的语言和库不能很好地完成出色的编程。充其量，它们允许人们编写跨平台运行良好的代码，但永远不会出类拔萃。

选择一个并专注于它。专注于那些观众（无论如何，你会发现观众的口味和欲望是不同的）。

一旦你有了一个人们在另一边叫嚣的应用程序，就在有人成为竞争对手之前，评估移植你精心调整和精心设计的产品的成本/收益。

如果您尝试“为两个主人服务”，您将根据两个平台最简单的方式做出设计决策，这不是一个好的设计过程。

-亚当

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T10:23:21.323

取决于您希望在申请上花费多少时间。最快的方法是 Java，否则您可以使用 C++ 构建模型并使用 MFC 和 Cocoa 执行单独的 GUI 代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T23:01:04.930

如果您的应用程序使用 MVC 设计，您可以使用 C++ 编写可移植模型类，并为您想要支持的每个平台编写本机控制器和视图类。这为您提供了两全其美的优势 - 实用的可移植性，以及您的用户会感谢您的本机界面。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T23:01:38.127

我同意您对 Java 应用程序与本机应用程序的观察，尽管我确信有经验的 Java 程序员可能会使其工作。

最重要的是，Mac 和 Windows 的编程 API 是在各自系统上构建接口的最佳工具。如果您希望您的应用程序在特定系统上顺利运行，您应该使用该系统的 API。

如果跨平台实现绝对必要，请考虑将程序的所有核心功能（非用户界面部分）编写在一个可以为两个系统编译的库中（c++ 是一个明显的选择），然后为每个可以调用公共库的目标系统构建一个漂亮的用户界面。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T23:03:54.270

恕我直言，这个讨论应该由客户需求来回答。

大多数时候，IT 提供解决方案，构建解决方案的方式只是客户的一个细节。

但是，如果您的首选开发环境错误，使代码可重用可能会很有用。

许多其他标准可能会进入考虑范围。例如，如果您的软件用于医疗保健，您可能希望支持 10 年，那么您必须选择支持超过 10 年的操作系统（忘记 windows 和 mac）。等等

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-21T01:53:31.210

我经常发现 PC 开发人员试图利用 Mac 市场（有些成功）。反过来，他们在上述“跨平台”架构（Java，或一些 Qt 框架等）中开发应用程序，结果通常是一个看起来丑陋的应用程序，操作系统集成支持很差，社区的强烈反对开始于评论。

我的建议，移植它。做好工作，了解您的市场，然后再将您的跨平台产品倾销到地毯式炸弹营销方法中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-24T22:56:01.290

为什么不考虑 Web 应用程序。

您可以在浏览器中构建丰富的 UI 网站，该网站可以在任何地方和所有平台上运行，如果您熟悉 Java，您可以尝试使用 GWT 的“Weblication”查看[GWT 的演示页面](http://gwt.google.com/samples/Showcase/Showcase.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-24T22:57:35.093

让它成为一个网络应用程序？否则我猜是Java。这取决于很多事情，您的应用程序类型，目标等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-02T21:42:33.413

这实际上取决于您的用户是谁。不要仅仅因为可以跨平台。无论工具如何，都需要有真正的需求。测试会消耗相当多的时间。您仍然需要在两个平台上进行彻底测试。

我使用 REALbasic 从单个代码库创建各种跨平台桌面应用程序，它对我和我的客户都很有效。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-24T23:25:16.333

[我在使用SWT](http://www.eclipse.org/swt/)的跨平台 Java 方面运气不错。这将在任何操作系统上为您提供漂亮的原生外观，并且没有很多问题需要任何 JNI 代码。运气好的话，您应该能够将完全相同的代码库分发给两个目标，并且它应该可以正常工作。

话虽如此，您应该评估您是否真的需要跨平台功能。至少，它将要求您在每个操作系统上测试应用程序的 GUI 层（测试布局、演示等）。对于大型应用程序，这很快就会变得很麻烦。

在任何一种情况下，从一开始就选择跨平台语言将为您提供未来的灵活性。如果您要从一开始就编写本机代码，那么将代码移植到另一个平台并非易事。它可能伴随着几个错误，并且还需要将所有测试代码移植到新平台。您会遇到任何新功能、错误修复等的同步问题。使用 Java，您可以编写将在两个操作系统中运行的 JUnit 测试，并且任何错误或新功能都将自动传播到两个版本。

这确实取决于您的特定应用程序。如果您预计两个操作系统都有用户群，那么这应该决定您的语言选择。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-02T18:33:12.847

可以在 Windows、Linux 和 Java 上运行一个漂亮的 Java 应用程序 - 例如查看[SBCommander](http://sbcommander.sourceforge.net) - 请注意，即使您没有应该的硬件，您也可以运行它并查看 UI控制。

另一方面，我发现很难做的一件事是编写一个跨平台的应用程序，它的外观和行为都像每个平台上的原生应用程序。关于应用程序的行为方式有太多不同的假设。

# asp.net - 使用 Linq 查询从 DropDownList 中选择 ListItem

> ID：315787
> 
> 赞同：5
> 
> 时间：2008-11-24T22:53:28.800
> 
> 标签：asp.net, drop-down-menu, linq-to-objects

我试图使用 Linq 查询在下拉列表控件中查找和设置所选值。

```
 Dim qry = From i In ddlOutcome.Items _
           Where i.Text.Contains(value)

 Dim selectedItem As ListItem = qry.First

 ddlOutcome.SelectedValue = selectedItem.Value 
```

即使文档说 DropDownList.Items 集合实现了 IEnumerable 我在 Where 子句中收到一个错误，即 Option Strict ON 不允许后期绑定！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-24T23:52:11.783

我可以用 C# 给你一个答案，希望对你有帮助。

使用 DropDownlist 方法的最简单方法，比 linq 查询更好：

```
DropDownList1.SelectedIndex = 
       DropDownList1.Items.IndexOf(DropDownList1.Items.FindByText("2")); 
```

如果你想要 linq 查询，它会是这样的：

```
var selected=from i in DropDownList1.Items.Cast<ListItem>()
                     where ((ListItem)i).Text.Contains("2") select i;

DropDownList1.SelectedValue = selected.ToList()[0].Text; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-20T08:17:13.113

有人想过：

```
foreach (ListItem li in drp.Items.Cast<ListItem>().Where(li => li.Value == ""))
{
    li.Selected = true;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T14:51:56.150

感谢您的建议，它们都有助于引导我找到可行的解决方案。虽然我同意使用下拉列表本身的方法应该是要走的路，但我没有与列表中项目的文本完全匹配，所以我需要另一种方法。

```
 Dim qry = From i In ddlOutcome.Items.Cast(Of ListItem)() _
              Where i.Text.Contains(value)

    qry.First().Selected = True 
```

linq 查询似乎比我自己遍历列表更可取，我在此过程中学到了一些东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T23:30:30.237

我的 vb.net 不稳定，（c# guy）但尝试：

```
Dim qry = From DirectCast(i, ListItem) In ddlOutcome.Items ... 
```

我可能有 DirectCast 语法错误，但你知道我来自哪里。问题在于，在编译时，无法将 Items 作为 ListItem 的集合进行验证，因为 IEnumerable 的 Current 属性返回 Object。Items 不是通用集合。

-Oisin

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T12:17:18.850

使用以下代码选择的简单方法

```
foreach (ListItem i in DropDownList1.Items)
   {
      DropDownList1.SelectedValue = i.Value;
     if (DropDownList1.SelectedItem.Text=="text of your DropDownList")
       {
         break;
       }
    } 
```

# javascript - iPhone 的极简可缓存 jQuery/javascript 库？

> ID：315788
> 
> 赞同：5
> 
> 时间：2008-11-24T22:53:57.207
> 
> 标签：javascript, jquery, iphone, dojo

鉴于[iPhone 对文件缓存的 25k 限制](http://www.niallkennedy.com/blog/2008/02/iphone-cache-performance.html)，我想知道是否对 iPhone 优化的 javascript 库感兴趣，该库使缓存成为顶级目标。由于它只是 iPhone，它可以摆脱大多数跨浏览器的垃圾并依赖于 safari 的特定功能，希望减少一些周长并保持 25k。

[John Resig 简要讨论了这](http://ejohn.org/blog/jquery-plugins-size-and-storage/)一点，但似乎主要是为了驳回它。他确实提到：

> 如果您对将 jQuery 分解成小块感到特别兴奋，您可以从 SVN 中获取各个部分并构建自定义副本。

有人试过吗？

Dojo 实现了一个似乎依赖于延迟加载的 6k 版本。我主要是 jQuery 用户，所以我没有尝试过，但它看起来很有趣。

总体而言：您如何看待 safari/iphone 特定的 JavaScript 库，它实现了 jQuery（或您最喜欢的其他库）中使用率最高的 90% 的 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T05:24:57.477

更新：看起来[Zepto](http://zeptojs.com/)是这些天要走的路。

找到[XUI](http://github.com/brianleroux/xui/tree/master)，看起来像我在找的东西，虽然我还没有尝试过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T23:02:36.203

您应该查看 QuickConnectiPhone。它可能会做你想做的事。它可以在[https://sourceforge.net/projects/quickconnect/](https://sourceforge.net/projects/quickconnect/)找到。它还允许您使用 JavaScript、CSS 和 HTML 编写应用程序，然后将其安装在设备上。

有一个 API 可以让您调用 Objective-C 层以及手机振动、GPS 位置、加速度计信息等。您甚至可以将其扩展到其他本机电话行为。

该框架的开发博客位于[http://tetontech.wordpress.com](http://tetontech.wordpress.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-23T09:53:41.567

我也在试验 XUI，看起来很有希望，似乎遵循 JQuery 的做事方式。

The same people also created '[lawnchair](http://brianleroux.github.com/lawnchair/)' for persistant storage of data in json format, XUI+lawnchair looks like a great combination for cross-platform (as in at least iphone+android, maybe webos, symbian, blackberry and ms as well) mobile development.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T00:36:41.337

我认为这会很棒，但是除非有人真正拿起并运行它，否则很难匹配 jquery 的测试和可靠性。如果有一个轻量级的、仅限于 safari 的 jquery 版本，它与插件和文档化方法完全兼容，那将是天赐之物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T03:50:43.380

鉴于 iphone 越来越受欢迎，我认为这将是一件非常有用的事情，它可能会删除跨浏览器的东西并缩小它的大小......但是，如果 iphone 有它会更有用更现实的缓存限制。

这确实让我怀疑iphone中的缓存限制是由硬件容量还是运营商的业务需求决定的。50K 缓存限制将减少更多的运营商使用...

# ruby-on-rails - 如何避免 has_many :through 关系中的重复？

> ID：315792
> 
> 赞同：38
> 
> 时间：2008-11-24T22:56:25.517
> 
> 标签：ruby-on-rails, ruby, duplicates, has-many-through, has-many

我怎样才能实现以下目标？我有两个模型（博客和读者）和一个 JOIN 表，它允许我在它们之间建立 N:M 关系：

```
class Blog < ActiveRecord::Base
  has_many :blogs_readers, :dependent => :destroy
  has_many :readers, :through => :blogs_readers
end

class Reader < ActiveRecord::Base
  has_many :blogs_readers, :dependent => :destroy
  has_many :blogs, :through => :blogs_readers
end

class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader
end 
```

我现在想做的，是将读者添加到不同的博客。但是，条件是我只能将读者添加到博客一次。所以表中不能有任何重复项（相同`readerID`，相同`blogID`）`BlogsReaders`。我怎样才能做到这一点？

第二个问题是，我如何获得读者尚未订阅的博客列表（例如，填写下拉选择列表，然后可以使用该列表将读者添加到另一个博客）？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-11-25T17:13:19.373

Rails 内置的更简单的解决方案：

```
 class Blog < ActiveRecord::Base
     has_many :blogs_readers, :dependent => :destroy
     has_many :readers, :through => :blogs_readers, :uniq => true
    end

    class Reader < ActiveRecord::Base
     has_many :blogs_readers, :dependent => :destroy
     has_many :blogs, :through => :blogs_readers, :uniq => true
    end

    class BlogsReaders < ActiveRecord::Base
      belongs_to :blog
      belongs_to :reader
    end 
```

请注意将`:uniq => true`选项添加到`has_many`调用中。

此外，您可能需要`has_and_belongs_to_many`在 Blog 和 Reader 之间考虑，除非您希望在连接模型上拥有一些其他属性（目前您没有）。该方法也有一个`:uniq`选项。

请注意，这不会阻止您在表中创建条目，但它确实确保当您查询集合时，您只能获得每个对象中的一个。

**更新**

在 Rails 4 中，这样做的方法是通过范围块。以上更改为。

```
class Blog < ActiveRecord::Base
 has_many :blogs_readers, dependent:  :destroy
 has_many :readers,  -> { uniq }, through: :blogs_readers
end

class Reader < ActiveRecord::Base
 has_many :blogs_readers, dependent: :destroy
 has_many :blogs, -> { uniq }, through: :blogs_readers
end

class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader
end 
```

**Rails 5 更新**

在作用域块中使用`uniq`会导致错误 `NoMethodError: undefined method 'extensions' for []:Array`。改用`distinct`：

```
class Blog < ActiveRecord::Base
 has_many :blogs_readers, dependent:  :destroy
 has_many :readers,  -> { distinct }, through: :blogs_readers
end

class Reader < ActiveRecord::Base
 has_many :blogs_readers, dependent: :destroy
 has_many :blogs, -> { distinct }, through: :blogs_readers
end

class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader
end 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-24T23:08:27.787

这应该解决您的第一个问题：

```
class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader

  validates_uniqueness_of :reader_id, :scope => :blog_id
end 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-08-09T08:12:08.087

**Rails 5.1 方式**

```
class Blog < ActiveRecord::Base
 has_many :blogs_readers, dependent:  :destroy
 has_many :readers,  -> { distinct }, through: :blogs_readers
end

class Reader < ActiveRecord::Base
 has_many :blogs_readers, dependent: :destroy
 has_many :blogs, -> { distinct }, through: :blogs_readers
end

class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader
end 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-25T14:39:59.840

关于什么：

```
Blog.find(:all,
          :conditions => ['id NOT IN (?)', the_reader.blog_ids]) 
```

Rails 使用关联方法为我们处理 id 的收集！:)

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-03T15:05:58.490

此链接上的答案显示了如何覆盖“<<”方法来实现您正在寻找的东西而不引发异常或创建单独的方法：[Rails idiom to Avoid duplicates in has_many :through](https://stackoverflow.com/questions/1315109/rails-idiom-to-avoid-duplicates-in-has-many-through)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-04T16:01:17.650

目前的最佳答案`uniq`是在 proc 中使用：

```
class Blog < ActiveRecord::Base
 has_many :blogs_readers, dependent:  :destroy
 has_many :readers,  -> { uniq }, through: :blogs_readers
end 
```

然而，这会将关系踢入数组，并且可能会破坏期望对关系而不是数组执行操作的事物。

如果您使用`distinct`它，则将其保留为关系：

```
class Blog < ActiveRecord::Base
 has_many :blogs_readers, dependent:  :destroy
 has_many :readers,  -> { distinct }, through: :blogs_readers
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T00:42:04.603

我想有人会提出比这更好的答案。

```
the_reader = Reader.find(:first, :include => :blogs)

Blog.find(:all, 
          :conditions => ['id NOT IN (?)', the_reader.blogs.map(&:id)]) 
```

[编辑]

请参阅下面的乔希的回答。这是要走的路。（我知道那里有更好的方法；）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-08-30T19:45:18.883

我为 Rails 6 执行以下操作

```
class BlogsReaders < ActiveRecord::Base
  belongs_to :blog
  belongs_to :reader

  validates :blog_id, uniqueness: { scope: :reader_id }
end 
```

不要忘记创建数据库约束以防止违反唯一性。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-02-02T22:32:42.163

最简单的方法是将关系序列化为数组：

```
class Blog < ActiveRecord::Base
  has_many :blogs_readers, :dependent => :destroy
  has_many :readers, :through => :blogs_readers
  serialize :reader_ids, Array
end 
```

然后在为读者分配值时，将它们应用为

```
blog.reader_ids = [1,2,3,4] 
```

以这种方式分配关系时，会自动删除重复项。

# c# - 如何处理 C# 中的多个错误？

> ID：315799
> 
> 赞同：4
> 
> 时间：2008-11-24T22:59:42.373
> 
> 标签：c#, error-handling, try-catch

我有一些读取 10 个注册表项的代码，有时值不存在，有时键不存在，有时值不是布尔值等等。我应该如何添加错误处理，目前它被放在一个很大的尝试中{} catch{} 但如果我读取的第二个值失败，那么在程序跳转到 catch{} 时不会读取其余值，我可以为每个值添加一个 try{} catch{} 但我猜有更好的方法. 你会怎么处理这个？我在问，因为我经常遇到类似的问题，我自己的解决方案是添加一个 try{} catch{}。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T23:03:22.600

首先，吞下异常*通常*是个坏主意——你能不能写一个方法来检查键等是否存在，如果有则返回值？

如果这*绝对*是不可能的，您可以将代码重构为对单个方法的多次调用，该方法（对于每个方法）执行 try/catch（吞下）：

```
SomeReturnType foo = HackyMethod(first path);
SomeReturnType bar = HackyMethod(sedond path);

SomeReturnType HackyMethod(string path)
{
    try {} catch {} etc
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T23:16:17.787

```
Dictionary<String,String> regKeys = new Dictionary<String,String>()
{
    { "Key1", String.Empty},
    { "Key2", String.Empty},
    { "Key3", String.Empty}
};

for (int i = 0; i < regKeys.Length; i++)
{
   try
   {
       regKeys[i].Value = ReadFromRegistry(regKeys[i].Key);
   }
   catch (Exception ex)
   {
      Console.WriteLine("Unable to read Key: " + regKeys[i].Key 
         + " Exception: " + ex.Message);
   } 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T23:46:55.103

您如何读取注册表值？Registry 类 (Microsoft.Win32.Registry) 允许您读取注册表值并在值/名称对不存在时返回您指定的默认值，如下所示：

```
object o = Microsoft.Win32.Registry.GetValue(
    @"HKEY_CURRENT_USER\Software\Microsoft\Calc", "layout", ""); 
```

这里的最后一个参数是指定的默认值，如果没有找到值名称则返回。我将其设为空白字符串，但您可以将其更改为您喜欢的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T00:11:19.670

@Marc's answer is the best, but if you absolutely must have a single excpetion that contains the collection of registry keys that had errors you should look at using the [Data](http://msdn.microsoft.com/en-us/library/system.exception.data.aspx) property of the exception. From the MSDN documentation on this property,

> Use the System.Collections.IDictionary object returned by the Data property to store and retrieve supplementary information relevant to the exception. The information is in the form of an arbitrary number of user-defined key/value pairs. The key component of each key/value pair is typically an identifying string, whereas the value component of the pair can be any type of object.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T23:03:04.443

将读取值的代码重构到它自己的函数中，该函数以您希望的方式处理错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T23:04:00.680

本质上，是的，您想定义每个单独元素的错误处理，而不是定义元素集的错误处理。也就是说，如果您希望捕获每个错误但不导致进程中止，您应该对每个单独的元素执行错误处理，而不是对整个组执行错误处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T23:05:04.907

这取决于错误的严重程度。如果它查找的某些键丢失或类型错误，程序继续运行是否有意义和有用？某些键是否比其他键更重要？

我建议如下：

*   找到您*必须拥有*的所有键，并将它们放在一个 try{} 中，使用 catch{} 报告致命错误并启动清理。先执行这个块。

*   找到所有可选键并将它们分别放在各自的 try{} 块中，这样您就可以恢复并继续使用其他键。为了使这更简单，您可以添加一个包装器方法，该方法具有必要的 try/catch 块和错误检查，并将键名作为参数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T23:06:49.303

编辑：改变了一切。:PI 建议了一个结构或类（以前），但现在我将其更改为一个简单的字符串集合。

我头顶上的一些伪代码....

```
public IEnumerable<string> ReadRegistryKeys()
{
    IEnumerable<string> resultList = new List<string>();
    if (string.IsNullOrEmpty(read_in_key_#1())
    {

        resultList.Add("Failed to load key 'blah'..");
    }

    if (.... read in the next key .. etc.... ) ...

    return resultList == null || resultList.Count <= 0 ? null : resultList;
} 
```

如果您愿意，您也可以使用 StringCollection (System.Collections.Specialized?)。

# python - OpenCV 的 Python - OS X

> ID：315803
> 
> 赞同：4
> 
> 时间：2008-11-24T23:01:50.483
> 
> 标签：python, macos, opencv

在 OS X 10.5 (intel) 上构建 OpenCV 时出现以下错误：

```
ld: warning in .libs/_cv_la-_cv.o, file is not of required architecture
ld: warning in .libs/_cv_la-error.o, file is not of required architecture
ld: warning in .libs/_cv_la-pyhelpers.o, file is not of required architecture
ld: warning in .libs/_cv_la-cvshadow.o, file is not of required architecture
ld: warning in ../../../cv/src/.libs/libcv.dylib, file is not of required architecture
ld: warning in /Developer/SDKs/MacOSX10.4u.sdk/usr/local/lib/libcxcore.dylib, file is not of required architecture
Undefined symbols for architecture i386:
"_fputs$UNIX2003", referenced from:
  _PySwigObject_print in _cv_la-_cv.o
  _PySwigPacked_print in _cv_la-_cv.o
  _PySwigPacked_print in _cv_la-_cv.o
ld: symbol(s) not found for architecture i386
collect2: ld returned 1 exit status
lipo: can't open input file: /var/folders/Sr/Srq9N4R8Hr82xeFvW3o-uk+++TI/-Tmp-//cchT0WVX.out (No such file or directory)
make[4]: *** [_cv.la] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all-recursive] Error 1
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2 
```

运行 ./configure --without-python 时一切正常。另一个奇怪的是，当我使用 Python 2.4.5 或 2.5.1 时一切都构建好了，切换到 Python Framework 2.5.2 后出现问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T10:29:09.330

在链接时寻找 /Developer/SDKs/MacOSX10.4u.sdk 时警告不同架构似乎有点奇怪 - 你能给我们一些关于你的构建环境的更多细节（XCode，GCC，Python，$PATH 的版本ETC）

或者，任何可用的 OpenCV 二进制文件都不适合您吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-26T17:42:00.283

/Developer/SDKs/MacOSX10.4u.sdk/usr/local/lib 只是删除导致我收到警告的文件后指向 /usr/local/lib 的链接：

```
ld: warning in .libs/_cv_la-_cv.o, file is not of required architecture
ld: warning in .libs/_cv_la-error.o, file is not of required architecture
ld: warning in .libs/_cv_la-pyhelpers.o, file is not of required architecture
ld: warning in .libs/_cv_la-cvshadow.o, file is not of required architecture
ld: warning in ../../../cv/src/.libs/libcv.dylib, file is not of required architecture
ld: warning in /Users/Pietras/opencv/cxcore/src/.libs/libcxcore.dylib, file is not of required architecture
Undefined symbols for architecture i386: ... ` 
```

这些文件是由 make 创建的。

gcc：i686-apple-darwin9-gcc-4.0.1

$路径：

```
/Library/Frameworks/Python.framework/Versions/Current/bin:/Library/Frameworks/Python.framework/Versions/Current/bin:/sw/bin:/sw/sbin:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/AVRMacPack/bin:/usr/X11R6/bin 
```

XCode 3（最新）

Python 2.5.1 (r251:54869, Apr 18 2007, 22:08:04) - 来自 python.org 的 MacPython（试图降级并使用它而不是 2.5.2，但这不再起作用了......）

```
which python
/Library/Frameworks/Python.framework/Versions/Current/bin/python 
```

我没有找到任何适用于 OS X 的 Python OpenCV 二进制文件。我尝试将 macports 中的 python2.4 或 2.5 设置为默认值并编译和安装，但是当我尝试导入时出现总线错误或致命错误Python 错误解释器未初始化（版本不匹配？）并退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T20:37:14.033

好的，我有点解决了

它需要使用来自 macports 或其他任何东西的 python 编译。然后我需要运行`/System/Library/Frameworks/Python.framework/Versions/2.5/bin/python2.5`（这是我以前的 python 版本）并且 OpenCV 可以正常工作。

# jsf - 如何在 JSF 中显示我的应用程序的错误？

> ID：315804
> 
> 赞同：42
> 
> 时间：2008-11-24T23:02:10.887
> 
> 标签：jsf, error-handling, facelets

在我的 JSF/Facelets 应用程序中，这是我的部分表单的简化版本：

```
<h:form id="myform">
  <h:inputSecret value="#{createNewPassword.newPassword1}" id="newPassword1" />
  <h:message class="error" for="newPassword1" />
  <h:inputSecret value="#{createNewPassword.newPassword2}" id="newPassword2" />
  <h:message class="error" for="newPassword2" />
  <h:commandButton value="Continue" action="#{createNewPassword.continueButton}" />
</h:form> 
```

我希望能够根据 continueButton() 方法中发生的事情将错误分配给特定的 h:message 标记。newPassword 和 newPassword2 需要显示不同的错误。验证器不会真正起作用，因为将传递结果（来自数据库）的方法在 continueButton() 方法中运行，并且运行两次的成本太高。

我不能使用 h:messages 标记，因为该页面有多个地方需要显示不同的错误消息。当我尝试这样做时，页面显示每条消息的重复项。

我试过这个作为最好的猜测，但没有运气：

```
public Navigation continueButton() {
  ...
  expensiveMethod();
  if(...) {
    FacesContext.getCurrentInstance().addMessage("newPassword", new FacesMessage("Error: Your password is NOT strong enough."));
  }
} 
```

我错过了什么？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-26T18:44:41.093

[FacesContext.addMessage(String, FacesMessage)](http://java.sun.com/javaee/javaserverfaces/1.1_01/docs/api/javax/faces/context/FacesContext.html#addMessage(java.lang.String,%20javax.faces.application.FacesMessage))需要组件的clientId **，**而*不是***id**。如果您想知道为什么，请考虑将控件作为 dataTable 的子项，为每一行使用相同的控件标记不同的值 - 可以为每一行打印不同的消息。**id**总是一样的；**clientId**每行都是唯一的。

所以“myform:mybutton”是正确的值，但是硬编码是不明智的。查找将在视图和业务逻辑之间创建较少的耦合，并且将是一种适用于更严格的环境（如 portlet）的方法。

```
<f:view>
  <h:form>
    <h:commandButton id="mybutton" value="click"
      binding="#{showMessageAction.mybutton}"
      action="#{showMessageAction.validatePassword}" />
    <h:message for="mybutton" />
  </h:form>
</f:view> 
```

托管bean逻辑：

```
/** Must be request scope for binding */
public class ShowMessageAction {

    private UIComponent mybutton;

    private boolean isOK = false;

    public String validatePassword() {
        if (isOK) {
            return "ok";
        }
        else {
            // invalid
            FacesMessage message = new FacesMessage("Invalid password length");
            FacesContext context = FacesContext.getCurrentInstance();
            context.addMessage(mybutton.getClientId(context), message);
        }
        return null;
    }

    public void setMybutton(UIComponent mybutton) {
        this.mybutton = mybutton;
    }

    public UIComponent getMybutton() {
        return mybutton;
    }
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-25T21:57:26.273

万一有人好奇，我可以根据您的所有回答结合起来弄清楚这一点！

这是在 Facelet 中：

```
<h:form id="myform">
  <h:inputSecret value="#{createNewPassword.newPassword1}" id="newPassword1" />
  <h:message class="error" for="newPassword1" id="newPassword1Error" />
  <h:inputSecret value="#{createNewPassword.newPassword2}" id="newPassword2" />
  <h:message class="error" for="newPassword2" id="newPassword2Error" />
  <h:commandButton value="Continue" action="#{createNewPassword.continueButton}" />
</h:form> 
```

这是在 continueButton() 方法中：

```
FacesContext.getCurrentInstance().addMessage("myForm:newPassword1", new FacesMessage(PASSWORDS_DONT_MATCH, PASSWORDS_DONT_MATCH)); 
```

它有效！谢谢您的帮助！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T14:44:29.720

您还必须在调用 addMessage() 时包含 FormID。

```
 FacesContext.getCurrentInstance().addMessage("myform:newPassword1", new FacesMessage("Error: Your password is NOT strong enough.")); 
```

这应该可以解决问题。

问候。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-10T23:25:47.817

请记住：

```
FacesContext context = FacesContext.getCurrentInstance();
context.addMessage( null, new FacesMessage( "The message to display in client" )); 
```

也是有效的，因为当将*null*指定为第一个参数时，它将应用于整个表单。

更多信息：[coreservlets.com](http://courses.coreservlets.com/Course-Materials/pdf/jsf/jsf2/JSF2-Validation.pdf) //过时

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T23:23:53.683

JSF 是一头野兽。我可能遗漏了一些东西，但我曾经通过将所需的消息保存到 bean 的属性，然后通过 outputText 显示属性来解决类似的问题：

```
<h:outputText
    value="#{CreateNewPasswordBean.errorMessage}"
    render="#{CreateNewPasswordBean.errorMessage != null}" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T23:10:48.890

谷歌搜索时发现[了这个](http://www.jsf-faq.com/faqs/faces-messages.html)。第二篇文章指出了 JSF 的不同阶段，这可能会导致您的错误消息丢失。此外，请尝试使用 null 代替“newPassword”，因为您没有任何 ID 为 newPassword 的对象。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T10:07:40.420

> 我试过这个作为最好的猜测，但没有运气：

在我看来是对的。您是否尝试过明确设置消息严重性？此外，我认为 ID 需要与组件的 ID 相同（即，如果这些是您的 ID，则需要使用 newPassword1 或 newPassword2，而不是示例中的 newPassword）。

```
FacesContext.getCurrentInstance().addMessage("newPassword1", 
                    new FacesMessage(FacesMessage.SEVERITY_ERROR, "Error Message")); 
```

然后用于`<h:message for="newPassword1" />`在 JSF 页面上显示错误消息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-21T16:53:04.603

简单的答案，如果您不需要将其绑定到特定组件...

爪哇：

```
 FacesMessage message = new FacesMessage(FacesMessage.SEVERITY_ERROR, "Authentication failed", null);
            FacesContext context = FacesContext.getCurrentInstance();
            context.addMessage(null, message); 
```

XHTML：

```
 <h:messages></h:messages> 
```

# content-management-system - 滚动我自己的或使用现有的 CMS（也许是 Drupal？）

> ID：315828
> 
> 赞同：0
> 
> 时间：2008-11-24T23:12:20.587
> 
> 标签：content-management-system

我需要创建一个内部网站，但不知道我们应该编写自己的网站还是使用现有的框架。

大多数网站本质上都是数据库的前端。我们需要让许多人将数据输入表单。然后我们希望能够显示所有这些数据的不同视图——包括运行小查询（例如，我们有多少资源具有属性'X'）。通常情况下，我们需要定期调整 UI。

实际的数据设计并不是资源到条目的简单 1:1 映射。例如，我们可能会跟踪一个项目的多个属性作为该项目的“基本数据集”。然后我们可以有几组额外的数据。

想象一个食谱应用程序。你可能有一个开胃菜的食谱。然后可以由需要相同信息的其他几个食谱引用。

我觉得这最适合通用框架（Ruby on Rails、Django 等），但我想知道它是否不适合像 Drupal 这样的“传统”CMS 平台？我特别提到了 Drupal，因为开发它的人使用 php 和 MySql 的知识最多。

我通常倾向于想要使用现有平台，但对其他人的想法感兴趣。为了让您了解范围，我想如果我们从头开始编写这篇文章，我们可能会谈论 3-5 周的开发。

你会推荐我们自己编写，还是使用现有的框架？如果您建议使用现有的东西，您会推荐什么？

您认为这最适合直接框架还是直接 CMS？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T00:36:38.623

Drupal 可能对您来说是一个很好的解决方案，尽管您可能需要一些关键的附加模块，例如“内容创建工具包”（CCK）和“视图”。

与其他 Web CMS 系统（WordPress、Exponent、phpNuke）不同，Drupal 将您的条目视为内容的“池”，您可以从中提取站点不同区域的各种子集。

Drupal 有很多文档（几乎太多了），最大的问题是找到与您想要实现的目标相关的部分。潜入其中一个交互式 IRC 频道可能是一个好主意，因为社区非常有帮助，并且几乎总是愿意为您指明正确的方向。

Drupal 的强大、灵活性和能力是它最大的优势和弱点——我知道我花了一些精力来理解关键概念，而且我还远不是 Drupal 专家。

最后一条评论：从头开始编写我自己的 CMS，我放弃了支持 Drupal，我建议您的 3-5 周估计可能偏轻。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T00:04:02.073

对于任何需要自定义功能的站点，请远离 Drupal。我最近在工作中将 Drupal 用于一个网站，很难弄清楚如何让它做我想做的事情。那里有很多文档，但所有这些都无济于事——它回答了关于特定问题的非常具体的问题，但没有提供任何关于如何构建整个站点的上下文。如果您是程序员，使用更通用的框架可能会更好，因为 CMS 是为特定类型的站点设计的，如果您希望您的站点具有非标准功能，您将与系统对抗而不是使用它。如果您的开发人员在 PHP 方面最有经验，请尝试模仿 Rails 架构的 PHP 框架之一——例如 cakePHP 或 CodeIgniter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T00:32:11.017

当您需要处理广泛且可能扩展的不同内容类型和模式时，CMS 通常是有意义的。Drupal 实际上有几十个。鉴于您提到的 RoR，听起来您需要更多的是 MVC 风格的框架。也许类似于构建stackoverflow的那种东西。.NET 对您来说是个问题吗？

但是，如果你真的被限制在 3-5 周，我认为基于 Rails 的策略是有意义的，所以选择 RoR 或 CodeIgniter

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T01:06:04.850

如果 Drupal 可以轻松完成您需要的工作，我会说使用 Drupal。我对 Drupal 了解不多。

否则，您所描述的听起来像是一个数据驱动的网络应用程序，或者更像是一个报告应用程序。听起来您可能有一些非常具体的需求，或者用户将来可能需要非常具体的需求。这是很难从预制软件中获得的，因为您不知道用户会要求什么。由于我是一名程序员，我可能想自己构建它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T01:11:11.640

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T03:04:29.787

# c# - C# 对象是否知道更具体的类的类型？

> ID：315829
> 
> 赞同：7
> 
> 时间：2008-11-24T23:13:20.023
> 
> 标签：c#, object, types

假设您创建了一个通用 Object 变量并将其分配给特定实例。如果你执行 GetType()，它会得到类型 Object 还是原始类的类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T23:14:55.353

是的。

你也可以这样做：

```
object c = new FooBar();
if(c is FooBar)
     Console.WriteLine("FOOBAR!!!"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T23:14:55.887

**简短回答：GetType() 将返回特定对象的类型。**我做了一个快速应用程序来测试这个：

```
 Foo f = new Foo();
        Type t = f.GetType();

        Object o = (object)f;
        Type t2 = o.GetType();

        bool areSame = t.Equals(t2); 
```

是的，它们是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T23:15:48.240

调用 GetType() 将调用 ACTUAL 类型。如果您想知道基本类型，可以调用 GetType().BaseType

# c# - 从 Java POV 学习 C#

> ID：315833
> 
> 赞同：2
> 
> 时间：2008-11-24T23:14:37.820
> 
> 标签：c#, java

如果一个多年来一直是 Java 开发人员并且现在正在尝试走 c#/asp.net 路线的人，你们会推荐什么书？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T23:24:32.747

首先阅读本白皮书：

[从 Java 开发人员的角度来看 C#](http://www.25hoursaday.com/CsharpVsJava.html)

然后，您可以继续阅读涵盖 .NET 框架的书籍，因为您会发现语言差异很快就学会了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T23:21:49.163

[CLR Via C](http://www.microsoft.com/MSPress/books/6522.aspx) # 对于有编程经验的人来说是一本很棒的 C# 书籍。尤其是其他托管语言的经验

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T13:28:03.667

我最近正是这样做的，发现最有价值的两本书是：

> **Jeffrey Richter[通过 C# 编写的 CLR](http://www.amazon.co.uk/CLR-Via-Applied-Framework-Programming/dp/0735621632/ref=sr_1_1?ie=UTF8&s=books&qid=1227619247&sr=1-1)**。写得非常好，对 .net 运行时有很好的了解——很多关于你已经从 java 中了解的概念，例如垃圾收集、线程、泛型等。另外，对 c# 构造（如委托和事件）的深入报道非常好'不附带java（还）。

和

> **Andrew Troelsen[的 Pro C# 和 .net 3.5 平台](http://www.amazon.co.uk/Pro-2008-NET-Platform-Fourth/dp/1590598849/ref=sr_1_2?ie=UTF8&s=books&qid=1227619142&sr=1-2)**。这更像是关于 .net 生态系统的一般性文本。它有一个优秀的核心语言部分，但也很好地概述了主要的库和 api - WPF、WCF、ASP.net 等。

这些应该为您提供坚实的基础，并且都非常适合有经验的程序员。在那之后，您可能最终会寻找更具体到您正在使用的技术的东西 - 一本详细的 ASP.net 书籍在您的案例中 - 但我经常提到这两个，所以这是物有所值的钱恕我直言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T23:17:38.283

我发现

> Pro C# with .NET 3.0, Special Edition by Andrew Troelsen Apress © 2007 (1238 pages) ISBN:9781590598238

成为一本优秀的书。

# css - 我应该避免使用“text-align: justify;”吗？

> ID：315845
> 
> 赞同：76
> 
> 时间：2008-11-24T23:16:17.833
> 
> 标签：css, usability, typography

有什么理由避免使用`text-align: justify;`？

它是否会降低可读性或导致问题？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-18T09:25:18.117

首先，这纯粹是一个与设计相关的问题和解决方案。网格的设计指定是否需要对齐文本。我认为 justify align 单独对可用性没有重大影响。使文本难以辨认的不良排版会降低可用性。也就是说，请确保您的字体具有鲜明的对比和良好的间距平衡。字体大小也很重要。

[该站点](http://rebecamendez.com/)是在线证明文本合理性的成功尝试。由于使用 CSS 无法像使用 InDesign 那样控制字母和单词之间的空格，因此很难证明文本的合理性并且不会让行中的空白“河流”流过，当单词之间的空格时会发生这种情况超过行间距。使文本对齐变得困难的事情：长的单词，没有足够的单词的行宽，以及文本和背景颜色之间的对比太大；它们使河流显得更宽、更明显。

排版的理想是有一个均匀的文本块，如果你眯着眼睛，文本块就会变成一个均匀的实心阴影。因此，如果您在白色背景上将文本保持在大约 10 像素和 60% 的灰色，并且有适合大约 20 个单词的行，则 justify align 看起来应该不会难看。但请记住，这对提高可用性没有任何帮助。小而相对较轻的文字会惹恼很多人，尤其是年长的读者。

我应该注意，通过`&shy;`（软连字符）正确地分离像 superawesome 这样长而麻烦的词，您可以模仿正确的排版（例如 InDesign）。有很多东西可以帮助你做到这一点。我会推荐隐藏、操作和显示要在客户端完成的文本的逻辑，也许使用[这个](http://code.google.com/p/hyphenator/).

**编辑**：正如下面其他人提到的，现在可以使用[css 连字符](http://caniuse.com/#feat=css-hyphens)，除非不可行（不在 Chrome 中）。另外，[css4 提供了更多的控制](http://generatedcontent.org/post/44751461516)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-24T23:30:15.433

[text-align: justify 目前不应该](http://www.webtypography.net/Rhythm_and_Proportion/Horizontal_Motion/2.1.3/)在浏览器中使用。他们不擅长处理其中的微小细节，并且输出最终包含大量河流，并且不支持[连字符](http://webtypography.net/Rhythm_and_Proportion/Etiquette_of_Hyphenation_and_Pagination/2.4.1/)（软连字符除外）。

*上面的注释*是 4.5 年前写的。事情正在慢慢改变...... [http://caniuse.com/#feat=css-hyphens](http://caniuse.com/#feat=css-hyphens)

*编辑：* 在这个答案的评论中，[连字符引起了我的注意。](http://code.google.com/p/hyphenator/)看起来它使 text-align 值得使用，请查看使用它的网站。在使用此脚本之前，您可能希望使用 javascript 来应用 text-align justify，这样那些没有 javascript 的人就不会被抓到。

*编辑 2：* CSS 现在允许使用属性 [[浏览器支持](http://caniuse.com/css-hyphens)]进行[断字。](http://www.w3.org/TR/css3-text/#hyphenation)PPK 现在说[将其添加到您的样式表](http://www.quirksmode.org/blog/archives/2012/11/hyphenation_wor.html)中，而 Eric Meyer 说[只需将其添加到移动设备](http://meyerweb.com/eric/thoughts/2012/12/10/should-you-hyphenate/)中。`hyphens`

*编辑 3：对我们现在可用的东西* [的一个很好的概述](http://typeplate.com/#hyphenation)，带有一些 SASS。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-24T23:47:06.880

其他人提出的关于对齐对齐的问题在窄列中更为普遍。如果您的列相对于您的字体大小和其他参数足够宽，那么可以证明文本的合理性。假设您平均每行至少需要 12 到 15 个单词。越多越好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-24T23:21:56.010

没有技术上的理由不这样做 - 这纯粹是一个设计决定。许多人发现合理的文本更难阅读，但我想这取决于您的情况。虽然它可以很好地用于打印，但通常网络浏览器不会对文本的最终输出提供足够的控制，以保证您所提供的内容不会在某些人的屏幕上看起来像垃圾。

你最好的选择是避免辩解。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-25T09:15:04.160

我想不出一个令人信服的理由为什么不证明文本是合理的——在某种程度上，内容的体积和宽度几乎要求它是合理的。当然，你会遇到由某些单词组合组成的内容的问题，但在我看来，如果你看到河流和单词之间异常大的空间，你就会遇到完全不同的问题——可读性和清晰度。

我会不惜一切代价避免居中的正文。我认为业余网页设计没有比这更大的危险信号了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T23:21:01.083

我更喜欢左对齐（文本对齐：左），因为它通常更具可读性。阅读均匀间隔的单词也更快，所以我听到了。除非你有使用 justify 的文体原因，否则请保持左、右或居中。特别是对于正文，请使用左。（实际上，对于另一个方向的文本（例如希伯来语），您需要类似“前进”的东西......）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T00:29:34.563

像任何网页设计问题一样......这取决于。正如已经建议的那样，两端对齐的文本通常不会在窄列中看起来很好。我建议不要将其作为侧边栏中的一般规则，因为侧边栏通常很窄。

使用通常推荐的每行 10 个单词的正文（或任何数量以上的单词），您可能能够摆脱合理的文本，并且在大多数情况下让它看起来相当不错，除非您使用了很多非常长的单词和/或字符串。

我想我以前在 StackOverflow 上拉过这个网站，但是[Jon Tan](http://jontangerine.com/)在他的正文（在文章中）使用了合理的文本，而且 99.99% 的时间看起来都很棒。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-18T16:05:15.547

不使用连字符就不能使用理由。这是一个[基于 PHP 的连字符库](http://kingdesk.com/projects/php-typography/)，以及这个库到 WordPress 插件的端口： [wp-Typography](http://wordpress.org/extend/plugins/wp-typography/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T23:25:42.383

我认为它在打印上完全没问题，但在大多数 Web 浏览器上它很笨拙，因为缺乏对间距和连字符的精细控制。在某些情况下，排版师甚至可以稍微调整字母间距或字体收缩，因为可以微调页面/列（至少在杂志中）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-25T00:32:57.647

呃……不……！

[认真] WordPress 使用 justify，我认为这对于它是否会降低可读性来说是一个非常有力的声明......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-02T17:25:45.813

您也可以使用 text-justify:newspaper。text-justify css 标签可帮助您控制对齐时文本的换行方式

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-03T18:05:28.200

应该提到的是，Internet Explorer（至少）最高版本 8 无法`text-align: justify`正确呈现。相反，它被解释为`text-align: center`.

这里有更多信息：[text-align: justify](http://reference.sitepoint.com/css/text-align)

让我有些头疼，想知道为什么 IE 一直居中。也许它可以节省其他人一些时间。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-08T15:08:04.737

文本对齐可以通过多种方式完成。

几个定义： 调整单词之间的间距是“跟踪” 调整字符之间的间距是“紧缩” 好的布局程序会自动进行一些紧缩，它会因字母对而异。变量的 va 可以比 xa 更接近。好的字体内置了字距调整提示表以帮助完成此过程。

在等宽字体的早期，它是通过在单词之间插入额外的空格来完成的。这使得输出看起来非常笨重。如果行尾有 4 个空格，行中有 6 个空格，则其中 4 个将变为双空格。

等宽字体不应该被证明是合理的。

对于可变宽度字体，我们有 em 空格、en 空格等，因此可以更好地分配空间。

我认为这是大多数浏览器现在的位置。它在大多数情况下工作得相当好。要使其正常工作，需要满足以下条件：

*   一行需要合理数量的单词。
*   行尾的大字会产生问题。

英语中的平均单词是 5 个字符。因此，平均而言，您将有 5 个字符（5 个字符的单词加上空格不适合，因此会被撞到下一行）

如果一行有 10 个单词，那么你需要在每个单词间隙添加大约一半的标准空格。

如果最后一个词很长，比如“头痛”并且没有空间，那么现在你有 10 个空间可以分配。这开始看起来很糟糕。

这就是连字字典发挥作用的地方。断字可以通过算法完成，但有足够多的例外，拥有字典会有很大帮助。（字典中没有的单词的软连字符有一个特殊字符。）

连字符可以拆分一个单词，使该行更均匀地填充。

根据经验，我认为 65 em 的线长是一个很好的折衷方案。这在很多时候每行给出 11-13 个单词。

对齐的另一种方法是在字符之间拆分空间。这避免了上面的一些问题，但如果你在没有足够的行中分配大量空间，仍然看起来很奇怪。您不时在报纸上看到这一点，其中一个单词似乎在每个字符之间都有一个完整的空格。对于更长的线路，这是一个很好的论据。

好的排版程序（InDesign、*TeX、Framemaker）将字间距中的额外空间和字符之间的微小额外空间结合起来。

块上有一个新的孩子，可以在 CSS 中使用 text-justify 来修改 text-align: justify 的使用。名义上它接受选项

*   自动（默认）
*   间词
*   字符间（+出于遗留原因分发）
*   没有任何

CanIuse [https://caniuse.com/#search=text-justify](https://caniuse.com/#search=text-justify) CSS 工作组[https: //drafts.c​​sswg.org/css-text-3/#text-justify-property](https://drafts.csswg.org/css-text-3/#text-justify-property)

CanIuse 目前仅报告 Firefox 的合规性，Chrome 支持它，但要求您启用实验性功能。CanIuse 声称支持是错误的。访问 Chromium 错误跟踪站点，声称它已修复。去搞清楚。没有测试过。

其他务实点：

我对网站的样式表做了四处更改：

*   最大线长 65 rem
*   正文字体增加到 110%
*   领先增长至 125%
*   对齐文本。

结果是每个会话的网站停留时间和页面数增加了一倍。

轶事，但可能值得您自己测试。

# java - 为什么 null 强制转换参数？

> ID：315846
> 
> 赞同：82
> 
> 时间：2008-11-24T23:16:42.760
> 
> 标签：java, null

何时以及为什么有人会做以下事情：

```
doSomething( (MyClass) null ); 
```

你做过吗？你能分享你的经验吗？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2008-11-24T23:19:37.107

如果`doSomething`是重载，则需要将 null 显式转换为，`MyClass`以便选择正确的重载：

```
public void doSomething(MyClass c) {
    // ...
}

public void doSomething(MyOtherClass c) {
    // ...
} 
```

当您调用 varargs 函数时，需要强制转换的一种非人为情况：

```
class Example {
    static void test(String code, String... s) {
        System.out.println("code: " + code);
        if(s == null) {
            System.out.println("array is null");
            return;
        }
        for(String str: s) {
            if(str != null) {
                System.out.println(str);
            } else {
                System.out.println("element is null");
            }
        }
        System.out.println("---");
    }

    public static void main(String... args) {
        /* the array will contain two elements */
        test("numbers", "one", "two");
        /* the array will contain zero elements */
        test("nothing");
        /* the array will be null in test */
        test("null-array", (String[])null); 
        /* first argument of the array is null */
        test("one-null-element", (String)null); 
        /* will produce a warning. passes a null array */
        test("warning", null);
    }
} 
```

最后一行将产生以下警告：

> Example.java:26：警告：可变参数方法的非可变参数调用，最后一个参数的参数类型不准确；为可变参数调用强制转换
> 为非可变参数调用并抑制此警告`java.lang.String`
> `java.lang.String[]`

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-24T23:24:41.123

假设您有这两个函数，并假设它们接受`null`作为第二个参数的有效值。

`void ShowMessage(String msg, Control parent);`
`void ShowMessage(String msg, MyDelegate callBack);`

这两种方法的区别仅在于它们的第二个参数的类型。如果你想使用其中一个`null`作为第二个参数，你必须将其`null`转换为相应函数的第二个参数的类型，以便编译器可以决定调用哪个函数。

调用第一个函数：`ShowMessage("Test", (Control) null);`
对于第二个：`ShowMessage("Test2", (MyDelegate) null);`

# ruby-on-rails - 没有数据库的 Rails 模型

> ID：315850
> 
> 赞同：70
> 
> 时间：2008-11-24T23:18:57.077
> 
> 标签：ruby-on-rails, ruby, activerecord

我想创建一个带有 ActiveRecord 验证但没有数据库表的 Rails（2.1 和 2.2）模型。最广泛使用的方法是什么？我发现了一些声称提供此功能的插件，但其中许多似乎并未被广泛使用或维护。社区建议我做什么？现在，我倾向于根据[这篇博文](http://www.prestonlee.com/2007/12/29/rails-20-validations-without-extending-activerecordbase/)提出自己的解决方案。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2010-09-30T13:29:14.087

在 Rails 3 中有一个更好的方法：[http ://railscasts.com/episodes/219-active-model](http://railscasts.com/episodes/219-active-model)

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-11-25T21:22:42.460

这是我过去使用的一种方法：

在**app/models/tableless.rb**

```
class Tableless < ActiveRecord::Base
  def self.columns
    @columns ||= [];
  end

  def self.column(name, sql_type = nil, default = nil, null = true)
    columns << ActiveRecord::ConnectionAdapters::Column.new(name.to_s, default,
      sql_type.to_s, null)
  end

  # Override the save method to prevent exceptions.
  def save(validate = true)
    validate ? valid? : true
  end
end 
```

在**app/models/foo.rb**

```
class Foo < Tableless
  column :bar, :string  
  validates_presence_of :bar
end 
```

在**脚本/控制台中**

```
Loading development environment (Rails 2.2.2)
>> foo = Foo.new
=> #<Foo bar: nil>
>> foo.valid?
=> false
>> foo.errors
=> #<ActiveRecord::Errors:0x235b270 @errors={"bar"=>["can't be blank"]}, @base=#<Foo bar: nil>> 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-12-18T11:45:27.780

现在有更简单的方法：

```
class Model
  include ActiveModel::Model

  attr_accessor :var

  validates :var, presence: true
end 
```

`ActiveModel::Model`代码：

```
module ActiveModel
  module Model
    def self.included(base)
      base.class_eval do
        extend  ActiveModel::Naming
        extend  ActiveModel::Translation
        include ActiveModel::Validations
        include ActiveModel::Conversion
      end
    end

    def initialize(params={})
      params.each do |attr, value|
        self.public_send("#{attr}=", value)
      end if params
    end

    def persisted?
      false
    end
  end
end 
```

[http://api.rubyonrails.org/classes/ActiveModel/Model.html](http://api.rubyonrails.org/classes/ActiveModel/Model.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-25T15:20:49.600

我认为您链接的博客文章是最好的方法。我只建议将存根的方法移到一个模块中，以免污染您的代码。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-25T01:14:01.730

只需按照您习惯的约定（文件名和类名的单数，文件名的下划线，类名的驼峰式大小写）在“models/”目录中创建一个以“.rb”结尾的新文件。这里的关键是不要从 ActiveRecord 继承你的模型（因为它是为你提供数据库功能的 AR）。例如：对于汽车的新模型，在您的模型/目录和模型内部创建一个名为“car.rb”的文件：

```
class Car
    # here goes all your model's stuff
end 
```

编辑：顺便说一句，如果你想要你的类的属性，你可以在这里使用你在 ruby​​ 上使用的所有东西，只需使用“attr_accessor”添加几行：

```
class Car
    attr_accessor :wheels # this will create for you the reader and writer for this attribute
    attr_accessor :doors # ya, this will do the same

    # here goes all your model's stuff
end 
```

编辑#2：在阅读了 Mike 的评论之后，如果您想要 ActiveRecord 的所有功能但在数据库中没有表，我会告诉您按照他的方式行事。如果你只想要一个普通的 Ruby 类，也许你会发现这个解决方案更好；）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-06-30T14:48:36.183

为了完整起见：

Rails 现在（在 V5 中）有一个方便的模块，您可以包括：

`include ActiveModel::Model`

这允许您使用哈希进行初始化，并使用验证等。

完整的文档在[这里](http://api.rubyonrails.org/classes/ActiveModel/Model.html)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-25T15:23:28.020

有一个关于非 Active Record 模型的[截屏视频](http://railscasts.com/episodes/121-non-active-record-model)，由 Ryan Bates 制作。一个很好的起点。

以防万一您还没有观看。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-06-18T03:51:54.710

根据 John Topley 的建议，我已经建立了一个快速的 Mixin 来处理这个问题。

[http://github.com/willrjmarshall/Tableless](http://github.com/willrjmarshall/Tableless)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-25T01:18:38.523

将类标记为抽象类怎么样？

```
class Car < ActiveRecord::Base
  self.abstract = true
end 
```

这将告诉 Rails Car 类没有对应的表。

[编辑]

如果您需要执行以下操作，这不会真正帮助您：

```
my_car = Car.new 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-12T03:52:08.093

使用可验证的 gem。正如您所说，有基于 AR 的解决方案，但它们往往很脆弱。

[http://validatable.rubyforge.org/](http://validatable.rubyforge.org/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-26T10:21:44.743

有没有人尝试过在非 Active Record 类中包含和查看尝试设置验证器时会发生什么`ActiveRecord::Validations`？`ActiveRecord::Validations::ClassMethods`

我确信验证框架和 ActiveRecord 本身之间有很多依赖关系。但是您可以通过从 AR 验证框架中分叉出您自己的验证框架来成功摆脱这些依赖关系。

只是一个想法。

**更新**：哎呀，这或多或少是与您的问题相关的帖子中的建议。对不起，打扰了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-25T16:24:44.073

就像 Tiago Pinto 所说的那样，只是不要让你的模型从 ActiveRecord::Base 继承。它只是一个常规的 Ruby 类，您将其粘贴在 app/models/ 目录中的文件中。如果您的模型都没有表并且您的应用程序中根本没有使用数据库或 ActiveRecord，请务必修改您的 environment.rb 文件以具有以下行：

```
config.frameworks -= [:active_record] 
```

这应该在`Rails::Initializer.run do |config|`块内。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-18T04:46:42.233

你应该检查[PassiveRecord](http://github.com/artofmission/passive_record/tree/master)插件。它为非数据库模型提供了一个类似于 ActiveRecord 的接口。这很简单，而且比对抗 ActiveRecord 更轻松。

我们将 PassiveRecord 与[Validatable](http://validatable.rubyforge.org/) gem 结合使用来获得 OP 所需的行为。

# windows - Azure 是操作系统还是框架？

> ID：315879
> 
> 赞同：7
> 
> 时间：2008-11-24T23:30:57.460
> 
> 标签：windows, azure

MS 将 Azure 称为操作系统。

对我来说，它更像是一个框架。我在分别定义两者时遇到了一些麻烦。我有一个普遍的直觉，但我还不够清楚地说 Azure 是否真的是一个操作系统，或者只是一个位于操作系统之上的框架。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T23:44:53.827

我刚刚收听了[Deep Fried Bytes Podcast #20](http://deepfriedbytes.com/podcast/episode-20-windows-azure-the-overlord-in-the-cloud/)，其中他们采访了 Windows Azure 项目经理 Steve Marx，他解释了这一切。

从我迄今为止收集到的信息（还没有完成所有的播客），它的工作原理是这样的：

1.  微软有大量运行 Hyper-V 的服务器，可以运行 windows server 2008 的虚拟化实例

2.  您可以使用 API 启动/停止/重新启动任意数量的这些虚拟 win2k8 服务器，并且仅根据您使用的内容收费。

3.  **控制此启动/停止/重启/崩溃恢复/配置/计费/等的平台是 Windows Azure**。他们开玩笑地称它为“Windows 服务器霸主”

4.  您为这些虚拟机定义角色，可以是

    *   web-role，您可以在其中运行托管在 IIS 中的任何 .NET 代码（例如：ASP.NET、httpHandler 等），
    *   worker-role，您可以在其中运行一些独立的 .NET 代码以进行后台处理等
    *   一旦他们从 CTP 出来，也许会有更多的角色
5.  您可以使用 windows azure API 来启动/停止它们 - 例如：“给我 5 个我的网络角色实例和 3 个我的工作角色实例”

6.  数据由他们的存储服务存储，并且可以

    *   Blob（我假设类似 S3）
    *   队列（我假设类似 SQS）
    *   表 - 马克思提到了“网络规模的非关系数据存储” - 类似于 SimpleDB 或 BigTable
7.  这些虚拟机有许多其他可用的服务——Windows Live 的 Live 服务、.NET 服务、SQL 服务（如果您需要用于关系数据的完整 SQL 服务器）、Sharepoint 服务（如果您需要共享点）等。

8.  **所有这些东西汇总在一起就是 Windows Azure 服务平台**

我的看法 - 巨人营销失败了。混乱比比皆是。不过，MS 似乎总是在做这种“将其全部汇总为一个流行语”的事情（5 年前的.NET，有人吗？）。我真希望他们能阻止它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-03T23:31:40.247

我听说 Windows Azure 提出的另一种方式是“基础设施即服务”。这意味着您不必像使用您调整的服务器或 VM 一样考虑操作系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T23:44:56.620

[什么是 Windows Azure？](https://stackoverflow.com/questions/240455/what-is-windows-azure)似乎回答了这个问题，也许？

引用[@daok](https://stackoverflow.com/questions/240455/what-is-windows-azure#240533)：

## 描述

Azure™ 服务平台 (Azure)**是托管在 Microsoft 数据中心的互联网规模云服务平台**，它提供了一个操作系统和一组可以单独或一起使用的开发人员服务。Azure 灵活且可互操作的平台可用于构建从云运行的新应用程序，或使用基于云的功能增强现有应用程序。其开放式架构使开发人员可以选择构建 Web 应用程序、在连接的设备、PC、服务器或混合解决方案上运行的应用程序，从而提供最好的在线和本地。

Azure**减少了对前期技术购买的需求**，它使开发人员能够快速**轻松地创建在云中运行的应用程序**通过使用他们在 Microsoft Visual Studio 开发环境和 Microsoft .NET Framework 方面的现有技能。除了 .NET 支持的托管代码语言之外，Azure 将在不久的将来支持更多的编程语言和开发环境。Azure 通过提供按需计算和存储来托管、扩展和管理 Web 和连接的应用程序，从而简化了应用程序的维护和操作。基础设施管理通过一个为高可用性和动态扩展而设计的平台实现自动化，以匹配使用需求和按需付费定价模式选项。Azure 提供了一个开放的、基于标准的、可互操作的环境，支持多种 Internet 协议，包括 HTTP、REST、SOAP 和 XML。

## 特征

Azure 服务平台的关键组件包括：

*   用于服务托管和管理、低级可扩展存储、计算和网络的 Windows Azure
*   用于各种数据库服务和报告的 Microsoft SQL 服务
*   Microsoft .NET 服务是熟悉的 .NET Framework 概念（例如工作流和访问控制）的基于服务的实现
*   Live Services 为用户提供一种一致的方式在其 PC、手机、PC 应用程序和网站之间存储、共享和同步文档、照片、文件和信息
*   Microsoft SharePoint Services 和 Microsoft Dynamics CRM Services 用于云中的业务内容、协作和快速解决方案开发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T23:56:39.013

从技术上讲，Azure 是一组运行在普通 Windows 2008 服务器上的服务，这些服务器几乎在 Hyper-V 内部运行。您的应用程序在这些服务上运行，从实际操作系统中抽象出来。因此，他们将 Azure 称为“云操作系统”。不幸的是，这些答案没有回答我的问题......所以......

我将我的问题重新格式化为更通用的内容： [操作系统和框架之间有什么区别？](https://stackoverflow.com/questions/315918/what-is-the-difference-between-an-os-and-a-framework)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-19T17:18:11.963

Windows Azure 既是一个框架又是一个操作系统。任何操作系统为开发人员提供的主要两件事是 CPU 和 Windows Azure 通过计算节点以不同方式提供的内存。它还提供了可扩展的存储来存储多种类型的存储，无论是结构化、非结构化甚至半结构化数据。请注意，存储节点与计算节点运行在不同的硬件资源上，这为系统提供了更好的效率以及高可用性和可扩展性。如果您的应用程序遇到任何问题，系统将自动创建它的另一个实例，并且您的数据会被复制 3 次。

由于云计算是一个主要由三个层次组成的概念，基础设施、平台和软件（即服务），它们的每一层都针对特定的细分市场。windows azure 的目标是开发人员构建高可用性和可扩展的应用程序，它不管理基础架构，它安装在 Windows Server 上，对基础架构进行管理，但是由于云计算基于虚拟化，Windows Azure 具有它自己的管理程序不依赖于 Windows Server Hyper-V。

对于需要在云计算上构建应用程序的开发人员来说，他们需要一个设计好的框架或平台，让他们能够这样做。

这就是为什么我认为 Windows Azure 不仅仅是一个框架，而不仅仅是一个操作系统，它两者兼而有之。

# html - 使用 HTML 进行域屏蔽

> ID：315887
> 
> 赞同：1
> 
> 时间：2008-11-24T23:37:18.990
> 
> 标签：html, domain-mask

如何使用 HTML 屏蔽另一个站点的地址？

例如，我想：

[http://www.example.com/source.html](http://www.example.com/source.html)

指向另一个页面：

[http://www.example.com/dest.html](http://www.example.com/dest.html)

请注意，目标页面可能位于另一个域中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T23:48:47.907

有很多人会断言您的目标是误导用户，这是不道德的。但是，如果您真的必须这样做，您是否可以保留链接并在用户到达链接页面时重定向？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T07:48:34.583

一个框架集似乎是我正在寻找的：

```
<frameset rows="100%">
    <frame src="http://www.example.com/dest.html"/>
</frameset> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T23:57:26.470

如果你使用的是 Apache，你可以使用 REWRITE mod，但它必须在同一个域中。在 .NET 中完成了重写库。人们将在地址栏中看到：source.html，但代码将是 dest.html 的代码。

其他任何事情都是简单的重定向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T05:16:34.440

你可以用javascript做到这一点。只需将其粘贴在您的页面上，它就会重定向：

```
<script>location.href = 'http://www.example.com/dest.htm'</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T07:51:08.247

一种方法是将不可见的框架设置为浏览器高度的 100%。但是当有人点击该框架页面中的链接时会发生什么？我同意 DOK，人们会怀疑你这样做的动机。

# eclipse - 如何以编程方式更改 Eclipse 视图的名称或图标？

> ID：315891
> 
> 赞同：8
> 
> 时间：2008-11-24T23:42:06.830
> 
> 标签：eclipse, eclipse-plugin, eclipse-3.4

能否以编程方式更改 Eclipse 视图的名称和图标？我指的是视图选项卡中出现的名称和图标 - 在 plugin.xml 的 <view> 元素中指定为 XML 属性“名称”和“图标”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-25T10:00:36.987

`setPartName(String)`和`setTitleImage(Image)`，两者`WorkbenchPart`都是你要找的。

`EditorPart`s 和都是`ViewPart`的扩展`WorkbenchPart`。

应该注意的是，这两种方法都`protected`应该从部件本身中调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T01:05:11.060

ViewPart 类中的 setPartName(..)。

# javascript - 如何在javascript中将文字对象转换为用户定义的对象？

> ID：315893
> 
> 赞同：3
> 
> 时间：2008-11-24T23:43:51.833
> 
> 标签：javascript, ajax, json

编写大量使用 JSON/AJAX 的 Web 应用程序时，我发现自己返回大量文字 javascript 对象 (JSON)。例如，我可能会从 GetCats.asp 请求所有的猫。它会返回：

```
[
  { 'id': 0, 'name': '波斯语' },
  { 'id': 1, 'name': '印花布' },
  { 'id': 2, '名字': '虎斑' }
]

```

现在，这些都是具有行为的 Cat 对象。但是，如果我定义一个 Cat 对象，function Cat() { }，我知道没有任何有效的方法可以将这些文字对象哄骗到用户定义对象的行为中。

我可以通过遍历它们并分配功能的蛮力来做到这一点，但这不会很漂亮。有没有一种很好的、​​一行（或几行）的方式以某种方式将这种行为“投射”到这些文字对象上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T23:58:55.873

无法绕过这样一个事实，即您必须遍历所有简单对象并将它们更改为不同类型的对象。你无法避免循环。话虽如此，您可以创建一个构造函数，该构造函数采用这样的简单对象并将这些值复制到新实例中。

像这样：

```
function Cat(c) {
  this.id = c.id;
  this.name = c.name;
}
Cat.prototype.meow = function() {alert('meow');}
Cat.prototype.displayName= function() {alert(this.name);}

var cats = [
  { 'id': 0, 'name': 'Persian' },
  { 'id': 1, 'name': 'Calico' },
  { 'id': 2, 'name': 'Tabby' }
];

for (i=0,len=cats.length; i<len; i++) {
  cats[i] = new Cat(cats[i]);
}

cats[0].meow();  // displays "meow"
cats[0].displayName();  // display "Persian" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T00:29:00.510

If you're using the [json2 parser](http://www.json.org/js.html) (or another one with a compatible interface), you can simply provide a callback to replace the raw objects with custom objects:

```
var catSource = '[ { "id": 0, "name": "Persian" }, { "id": 1, "name": "Calico" }, { "id": 2, "name": "Tabby" } ]';

function Cat(id, name)
{
   this.id = id;
   this.name = name;
}
Cat.prototype = 
{
   toString: function()
   {
      return this.name;
   }
};

function doStuff()
{
   var cats = JSON.parse(catSource, function(key, val)
   {
      // some expression to detect the type of val 
      if ( val.id !== undefined && val.name !== undefined )
         return new Cat(val.id, val.name);
      return val;
   });
   alert(cats);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T01:06:16.923

你使用原型框架吗？如果是 - 这是一个例子

```
 var cats = [
    {id: 15, name: 'Tables', count:45 },
    {id: 23, name: 'Chairs', count:34 }
];
var catsObjects = [];
cats.each(function(item){
    var newObject = new Cat();
    Object.extend(newObject, item);
    catsObjects.push(newObject);
}); 

```

基本上 Array.each 函数与“for i < Array.length”
相同，Object.extend 与按属性向 newObject 添加属性相同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T15:03:15.643

扩展@Benry 的答案。

我发现具有将一个对象的属性复制到另一个对象的扩展功能是必不可少的。将它放在 Object 上有一个半传统的方法；`Object.extend()`存在于许多较小的库中（注意：这与 Object.prototype 不同）。

```
Object.extend = function ( take, give ) {
  for (var k in give) {
    if (give.hasOwnProperty(k)) {
      take[k] = give[k];
    }
  }
  return take;
} 
```

这样做的好处是您可以在编写代码时使用很好的可读文字符号：

```
function Cat (c) {
  Object.extend( this, ( c || this.defaults )  );
}

Object.extend(Cat.prototype, {

  meow : function() {
    alert( 'Meow, my name is ' + this.name );
  },

  defaults : {
    name : 'I have no name', 
    id   : null
  }

}); 
```

然后，您可以非常简单地创建您的猫大军：

```
var cats = [
  { 'id': 0, 'name': 'Persian' },
  { 'id': 1, 'name': 'Calico' },
  { 'id': 2, 'name': 'Tabby' }
];

for (i=0,len=cats.length; i<len; i++) {
  cats[i] = new Cat( cats[i] );
}

cats[0].meow();  // displays "meow, my name is Persian" 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-25T00:00:40.317

为每个对象分配一个适当的原型：

```
var list = [
  { 'id': 0, 'name': 'Persian' },
  { 'id': 1, 'name': 'Calico' },
  { 'id': 2, 'name': 'Tabby' }
];

for (obj in list)
{
  obj.prototype = new Cat();
} 
```

# nhibernate - 结合 .hbm.xml 和 Fluent NHibernate 时出现奇怪的异常 - 有什么想法吗？

> ID：315894
> 
> 赞同：1
> 
> 时间：2008-11-24T23:44:04.297
> 
> 标签：nhibernate, fluent-nhibernate

所以我根据需要转换我的映射文件（进行更改时，转换为映射）。像这样配置 NHibernate 时的任何：

```
Assembly asm = Assembly.Load("RPMWare.Core.DataAccess");

//NHibernate configuration: see hibernate.cfg.xml
var cfg = new Configuration();
cfg.AddMappingsFromAssembly(asm);
cfg.Configure(); 
```

并运行我的网络应用程序，我得到以下异常：

```
Could not load file or assembly 'NHibernate, Version=2.0.0.4000,
Culture=neutral, PublicKeyToken=aa95f207798dfdb4' or one of its
dependencies. The located assembly's manifest definition does not
match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

但是，我所有的集成测试都按预期工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T23:49:05.987

没关系。如果您使用的是最新版本的 Fluent NHibernate 和最新版本的 NHibernate，您需要在构建之前将您的 NHibernate 版本添加到 Fluent NHibernate 项目中。

# git - Git 初学者：权威实用指南

> ID：315911
> 
> 赞同：854
> 
> 时间：2008-11-24T23:50:29.370
> 
> 标签：git, version-control

好的，在看到[PJ Hyett 的这篇文章后](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/2678236#2678236)，我决定跳到最后并使用[Git](http://en.wikipedia.org/wiki/Git_(software))。

所以我需要的是一个初学者的Git**实用**指南。“初学者”被定义为知道如何处理他们的编译器的人，在某种程度上理解[Makefile](http://en.wikipedia.org/wiki/Make_%28software%29)是什么，并且在没有很好理解的情况下接触了源代码控制。

“实用”被定义为这个人不想深入了解 Git 在后台做什么，甚至不关心（或知道）它是分布式的。您的答案可能暗示了这些可能性，但尝试针对希望在备份和安全的“服务器”上保留“主”存储库并将其本地存储库仅视为“客户端”资源的初学者。

所以：

## 安装/设置

*   [如何安装 Git](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323764)
*   你如何设置Git？尝试涵盖 Linux、Windows、Mac，想想“客户端/服务器”的思维方式。
    *   [在 Windows 上使用 Msysgit 设置 GIT 服务器](https://stackoverflow.com/questions/1482824/setup-git-server-with-msysgit-on-windows)
*   [你如何创建一个新的项目/存储库？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#320140)
*   [如何将其配置为忽略不属于代码库的文件（.obj、.user 等）？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#316062)

## 使用代码

*   [你如何获得最新的代码？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/1350157#1350157)
*   [你如何检查代码？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323906)
*   [你如何提交更改？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#316055)
*   [您如何查看未提交的内容或当前代码库的状态？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#319465)
*   [你如何销毁不需要的提交？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323898)
*   [你如何比较一个文件的两个版本，或者你当前的文件和以前的版本？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/1762631#1762631)
*   [您如何查看文件的修订历史？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/2114836#2114836)
*   您如何处理二进制文件（例如，visio 文档或编译器环境）？
*   您如何合并“同时”更改的文件？
*   [您如何撤消（还原或重置）提交？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/323898#323898)

## 标记、分支、发布、基线

*   [你如何为一组特定的文件“标记”、“标记”或“发布”一组特定的修订，以便以后可以随时拉取那个？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#322967)
*   你如何拉一个特定的“发布”？
*   [你怎么分支？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/816614#816614)
*   [你如何合并分支？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/816636#816636)
*   您如何解决冲突并完成合并？
*   你如何将一个分支的部分合并到另一个分支中？
*   [什么是变基？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/5985070#5985070)
*   [如何跟踪远程分支？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/1590791#1590791)
*   [如何在远程存储库上创建分支？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/1590803#1590803)
*   [如何删除远程存储库上的分支？](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/5977604#5977604)
*   [Git 工作流示例](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/5968622#5968622)

## 其他

*   描述并链接到使 Git 成为非命令行资源的良好 GUI、IDE 插件等，但请列出其局限性和优点。
    *   [msysgit](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - 跨平台，包含在 Git 中
    *   [gitk](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - 跨平台历史查看器，包含在 Git 中
    *   [gitnub](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - Mac OS X
    *   [gitx](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - Mac OS X 历史查看器
    *   [smartgit](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - 跨平台，商业，测试版
    *   [tig](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/322989#322989) - Linux 的控制台 GUI
    *   [qgit](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/644129#644129) - 适用于 Windows、Linux 的 GUI
    *   [Git Extensions](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide#323559) - 适用于 Windows 的软件包，包括友好的 GUI
*   初学者应该知道的任何其他常见任务？
    *   [Git Status 告诉你刚刚做了什么，你有什么分支，以及其他有用的信息](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/319465#319465)
*   如何使用设置为我的源代码控制源的 subversion 存储库有效地工作？

## 其他 Git 初学者参考资料

*   [Git 指南](http://www.sourcemage.org/Git_Guide)
*   [吉特书](http://book.git-scm.com/)
*   [Git 魔法](http://www-cs-students.stanford.edu/~blynn/gitmagic/)
*   [gitcast](http://www.gitcasts.com/)
*   [GitHub 指南](http://github.com/guides/home)
*   [Git 教程](http://www.kernel.org/pub/software/scm/git/docs/gittutorial.html)
*   [Progit - Scott Chacon 的书](http://progit.org/book)
*   [Git - SVN 速成课程](http://git.or.cz/course/svn.html "Git - SVN 速成课程")
*   [Git 自下而上](http://www.newartisans.com/2008/04/git-from-the-bottom-up.html)
*   [Git 准备好了](http://www.gitready.com)
*   [gitref.org](http://gitref.org/)
*   [Git 可视化备忘单](http://www.ndpsoftware.com/git-cheatsheet.html)

## 深入研究 Git

*   [从概念上理解 Git](http://www.eecs.harvard.edu/~cduan/technical/git/)
*   [计算机科学家的 Git](http://eagain.net/articles/git-for-computer-scientists/)（和[另一个版本](http://sitaramc.github.com/gcs/)）

我会不时浏览条目并“整理”它们，使它们具有一致的外观/感觉，并且很容易扫描列表 - 随意遵循一个简单的“标题 - 简要说明 - 说明列表 - 陷阱和额外信息”模板。我还将链接到上面项目符号列表中的条目，以便以后轻松找到它们。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2008-11-26T09:26:46.540

# 你如何创建一个新的项目/存储库？

git 存储库只是一个包含特殊目录的`.git`目录。

这与“集中式”版本控制系统（如颠覆）不同，其中“存储库”托管在远程服务器上，您将其`checkout`置于“工作副本”目录中。使用 git，您的工作副本*就是*存储库。

只需`git init`在包含您要跟踪的文件的目录中运行。

例如，

```
cd ~/code/project001/
git init 
```

这会`.git`在当前目录中创建一个（隐藏的）文件夹。

要创建一个新项目，`git init`请使用附加参数（要创建的目录的名称）运行：

```
git init project002

(This is equivalent to: mkdir project002 && cd project002 && git init) 
```

要检查当前路径是否在 git 存储库中，只需运行`git status`- 如果它不是存储库，它将报告“致命：不是 git 存储库”

您还可以列出`.git`目录，并检查它是否包含类似于以下内容的文件/目录：

```
$ ls .git
HEAD         config       hooks/       objects/
branches/    description  info/        refs/ 
```

* * *

如果出于某种原因您希望“de-git”存储库（您希望停止使用 git 来跟踪该项目）。只需删除`.git`存储库基础级别的目录即可。

```
cd ~/code/project001/
rm -rf .git/ 
```

**注意：**这将破坏*所有*修订历史、*所有*标签以及git 所做的*一切。*它不会触及“当前”文件（您当前可以看到的文件），但之前的更改、删除的文件等将无法恢复！

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2008-11-27T11:56:59.853

# git 的图形用户界面

* * *

## 图形用户界面

包含在 git`git gui`中 — 从命令行运行，Windows [msysgit](http://code.google.com/p/msysgit/)安装程序将其添加到“开始”菜单。

Git GUI 可以完成您需要使用 git 完成的大部分工作。包括阶段更改、配置 git 和存储库、推送更改、创建/签出/删除分支、合并和许多其他事情。

我最喜欢的功能之一是右键菜单中的“stage line”和“stage hunk”快捷方式，可以让您提交文件的特定部分。您可以通过 实现相同的功能`git add -i`，但我发现它更易于使用。

它不是最漂亮的应用程序，但它几乎可以在所有平台上运行（基于 Tcl/Tk）

[截图](http://www.spearce.org/2007/01/git-gui-screenshots.html)| [截屏](http://www.simplicidade.org/notes/archives/2008/10/gitgui_screenca.html)

* * *

## [吉特克](http://www.kernel.org/pub/software/scm/git/docs/gitk.html)

也包含在 git 中。它是一个 git 历史查看器，可让您可视化存储库的历史（包括分支、何时创建和合并）。您可以查看和搜索提交。

与 git-gui 很好地结合在一起。

* * *

## [Gitnub](http://github.com/Caged/gitnub/wikis)

Mac OS X 应用程序。主要相当于，但与[github](http://github.com/Caged/gitnub/tree/master)`git log`有一些集成（如“网络视图”）。

看起来很漂亮，并且适合 Mac OS X。您可以搜索存储库。Gitnub 最大的批评是它以线性方式显示历史（一次一个分支） - 它没有可视化分支和合并，这对于 git 可能很重要，尽管这是计划中的改进。

[下载链接、更改日志和屏幕截图](http://github.com/Caged/gitnub/wikis)| [git仓库](http://github.com/Caged/gitnub/tree/master)

* * *

## [GitX](http://gitx.frim.nl/)

打算成为“OS X 的 gitk 克隆”。

它可以可视化非线性分支历史、执行提交、查看和搜索提交，它还有一些其他不错的功能，比如能够“快速查看”任何修订版中的任何文件（在文件列表视图中按空格键）、导出任何文件（通过拖放）。

它比`git-gui`/更好地集成到 OS X`gitk`中，并且即使在非常大的存储库中也能快速稳定。

最初的 git 存储库[pieter](https://github.com/pieter)最近没有更新（在撰写本文时已超过一年）。[Brotherbard/gitx](https://github.com/brotherbard/gitx)提供了一个更积极维护的分支- 它添加了“侧边栏、获取、拉取、推送、添加远程、合并、cherry-pick、rebase、克隆、克隆到”

[下载](http://gitx.frim.nl/index.html)| [截图](http://gitx.frim.nl/seeit.html)| [git 仓库](http://github.com/pieter/gitx/tree/master)| [兄弟叉](https://github.com/brotherbard/gitx)| [劳伦叉](http://gitx.laullon.com/)

* * *

## [SmartGit](http://www.syntevo.com/smartgit/index.html)

从主页：

> SmartGit 是分布式版本控制系统 Git 的前端，可在 Windows、Mac OS X 和 Linux 上运行。SmartGit 适用于更喜欢图形用户界面而不是命令行客户端的开发人员，使用 Git（当今最强大的 DVCS）提高工作效率。

你可以从[他们的网站](http://www.syntevo.com/smartgit/index.html)下载。

[下载](http://www.syntevo.com/smartgit/early-access.html)

* * *

## [TortoiseGit](http://code.google.com/p/tortoisegit/)

适用于 Windows 用户的 TortoiseSVN Git 版本。

> 正在移植 TortoiseSVN 到 TortoiseGit 最新版本 1.2.1.0 这个版本可以完成常规任务，例如提交、显示日志、比较两个版本、创建分支和标签、创建补丁等。有关详细信息，请参阅[发行](http://code.google.com/p/tortoisegit/wiki/ReleaseNotes)说明。欢迎贡献这个项目。

[下载](http://code.google.com/p/tortoisegit/downloads/list)

* * *

## [QGit](http://digilander.libero.it/mcostalba/)

> QGit 是一个基于 Qt/C++ 构建的 git GUI 查看器。
> 
> 使用 qgit，您将能够浏览修订历史、查看补丁内容和更改的文件，以图形方式跟踪不同的开发分支。

[下载](http://digilander.libero.it/mcostalba/#Download)

* * *

## [吉格](http://trac.novowork.com/gitg/)

> gitg 是一个针对 gtk+/GNOME 的 git 存储库查看器。其主要目标之一是为跨多个桌面的 git 前端提供更统一的用户体验。这不是编写跨平台应用程序，而是通过与其他操作系统的类似客户端（如 OS X 的 GitX）密切合作。

### 特征

*   浏览修订历史。
*   处理大型存储库（加载 linux 存储库，17000 多个修订版，不到 1 秒）。
*   提交更改。
*   舞台/非舞台个人帅哥。
*   还原更改。
*   显示修订中更改的彩色差异。
*   浏览给定修订的树。
*   导出给定版本的树的部分内容。
*   提供诸如“git log”之类的命令可以理解的任何参考规范来构建历史记录。
*   在历史视图中显示和切换分支。

下载：[发布](http://trac.novowork.com/gitg/wiki/Releases)或[来源](http://trac.novowork.com/gitg/wiki/WikiStart#Source)

* * *

## [Gitbox](http://gitbox.pierlis.com/)

> Gitbox 是一个用于 Git 版本控制系统的 Mac OS X 图形界面。在一个窗口中，您可以看到分支、历史记录和工作目录状态。
> 
> 日常操作很简单：使用复选框进行暂存和取消暂存更改。只需单击一下即可提交、拉取、合并和推送。双击更改以显示与 FileMerge.app 的差异。

[下载](http://gitbox.pierlis.com/)

* * *

## [吉蒂](http://macendeavor.com/gity)

Gity 网站没有太多信息，但从那里的屏幕截图来看，它似乎是一个功能丰富的开源 OS X git gui。

[下载](http://macendeavor.com/gity/download/)或[来源](http://github.com/beheadedmyway/gity)

* * *

## [融合](http://meld.sourceforge.net/)

> Meld 是一个视觉差异和合并工具。您可以比较两个或三个文件并就地编辑它们（差异动态更新）。您可以比较两个或三个文件夹并启动文件比较。您可以从流行的版本控制系统（例如 CVS、Subversion、Bazaar-ng 和 Mercurial [*和 Git* ]）浏览和查看工作副本。

[下载](http://ftp.gnome.org/pub/gnome/sources/meld/)

* * *

## [武士刀](http://dekorte.com/projects/shareware/Katana)

Steve Dekorte 为 OSX 开发的 Git GUI。

> 一目了然，查看哪些远程分支需要拉取更改，本地存储库需要推送更改。支持添加、提交、推送、拉取、标记和重置的 git 操作，以及突出显示本地更改和添加的项目层次结构的视觉差异和视觉浏览。

1 个存储库免费，25 美元更多。

[下载](http://dekorte.com/projects/shareware/Katana)

* * *

## [新芽（以前的 GitMac）](http://www.sproutmacapp.com/sprout)

专注于使 Git 易于使用。具有原生 Cocoa（类 mac）UI、快速存储库浏览、克隆、推/拉、分支/合并、可视差异、远程分支、轻松访问终端等。

通过使最常用的 Git 操作直观且易于执行，Sprout（以前称为 GitMac）使 Git 用户友好。Sprout 与大多数 Git 工作流程兼容，非常适合设计人员和开发人员、团队协作以及高级和新手用户。

[下载](http://www.sproutmacapp.com/sprout)| [网站](http://www.sproutmacapp.com/sprout)

* * *

## [塔](http://www.git-tower.com/)

适用于 Mac OSX 的功能丰富的 Git GUI。30 天免费试用，单用户许可证 59 美元。

[下载](http://www.git-tower.com/download)| [网站](http://www.git-tower.com/)

* * *

## [EGit](http://eclipse.org/egit/)

> EGit 是 Git 版本控制系统的 Eclipse Team 提供者。Git 是一个分布式 SCM，这意味着每个开发人员都拥有每个代码修订版本的所有历史记录的完整副本，从而可以非常快速且灵活地查询历史记录。
> 
> EGit 项目在 Git 的 JGit Java 实现之上实现 Eclipse 工具。

[下载](http://eclipse.org/egit/download/)| [网站](http://eclipse.org/egit/)

* * *

## [Git 扩展](http://code.google.com/p/gitextensions/)

适用于 Windows 的开源 - 将使用 Git 所需的一切安装在一个包中，易于使用。

> Git Extensions 是一个工具包，可让您在 Windows 上更直观地使用 Git。shell 扩展将集成在 Windows 资源管理器中，并在文件和目录上显示上下文菜单。还有一个 Visual Studio 插件可以使用 Visual Studio 中的 git。

[下载](http://code.google.com/p/gitextensions/downloads/list)

*非常感谢[dbr](https://stackoverflow.com/users/745/dbrBlockquote)对 git gui 的详细说明。*

* * *

## [源树](http://www.sourcetreeapp.com/)

SourceTree 是适用于 Git、Mercurial 和 SVN的*免费Mac 客户端。*由 BitBucket 背后的人 Atlassian 构建，它似乎与任何 VC 系统同样适用，它允许您掌握一个用于所有项目的工具，但它们是受版本控制的。功能丰富，免费。

> 适合新手和高级用户的专家级和功能丰富的用户：
> 
> 查看传出和传入的变更集。在树枝间摘樱桃。补丁处理、变基、存储/搁置等等。

[下载](http://www.sourcetreeapp.com/download/)| [网站](http://www.sourcetreeapp.com/)

* * *

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2008-11-25T00:49:37.707

Well, despite the fact that you asked that we not "simply" link to other resources, it's pretty foolish when there already exists a community grown (and growing) resource that's really quite good: the [Git Community Book](http://book.git-scm.com/). Seriously, this 20+ questions in a question is going to be anything but concise and consistent. The Git Community Book is available as both HTML and PDF and answers many of your questions with clear, well formatted and peer reviewed answers and in a format that allows you to jump straight to your problem at hand.

Alas, if my post really upsets you then I'll delete it. Just say so.

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2008-11-25T01:04:13.137

## 如何将其配置为忽略文件：

让 git 忽略您不希望它跟踪的文件的能力非常有用。

要忽略一个文件或一组文件，您需要提供一个模式。git 的模式语法相当简单，但功能强大。它适用于我将在下面提到的所有三个不同的文件。

*   空行不忽略任何文件，它通常用作分隔符。
*   以**#**开头的行用作注释。
*   **！** _ 前缀是可选的，将否定模式。任何匹配的否定模式都将覆盖较低优先级的模式。
*   支持高级表达式和通配符
    *   例如：模式：***.[oa]** 将忽略存储库中以 .o 或 .a 结尾的所有文件（对象和存档文件）
*   如果一个模式有一个以斜杠结尾的目录，git 只会匹配这个目录和它下面的路径。这会从匹配中排除常规文件和符号链接。
*   前导斜杠将匹配该路径名中的所有文件。
    *   例如：模式**/*.c**将匹配文件**foo.c**但不匹配**bar/awesome.c**

来自[gitignore(5)](http://www.kernel.org/pub/software/scm/git/docs/gitignore.html)手册页的好例子：

```
$ git status
[...]
# Untracked files:
[...]
#       Documentation/foo.html
#       Documentation/gitignore.html
#       file.o
#       lib.a
#       src/internal.o
[...]
$ cat .git/info/exclude
  # ignore objects and archives, anywhere in the tree.
  *.[oa]
$ cat Documentation/.gitignore
# ignore generated html files,
*.html
# except foo.html which is maintained by hand
!foo.html
$ git status
[...]
# Untracked files:
[...]
#       Documentation/foo.html
[...] 
```

* * *

通常有三种不同的方法可以忽略未跟踪的文件。

**1）忽略存储库的所有用户：**

将名为**.gitignore**的文件添加到工作副本的根目录。

编辑**.gitignore**以匹配您应该/不应忽略哪些文件的偏好。

```
git add .gitignore 
```

完成后提交。

**2）仅忽略您的存储库副本：**

在您的工作副本中添加/编辑文件**$GIT_DIR/info/exclude**，使用您喜欢的模式。

例如：我的工作副本是 ~/src/project1 所以我会编辑**~/src/project1/.git/info/exclude**

你完成了！

**3）在所有情况下，在您的系统上忽略：**

你的系统的全局忽略模式可以放在一个你想要的文件中。

我的个人称为**~/.gitglobalignore**

然后我可以通过使用以下行编辑我的**~/.gitconfig文件来让 git 知道这个文件：**

```
core.excludesfile = ~/.gitglobalignore 
```

你完成了！

我发现[gitignore](http://www.kernel.org/pub/software/scm/git/docs/gitignore.html)手册页是获取更多信息的最佳资源。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2008-11-27T04:58:56.953

# 你如何“标记”一组特定的修订

*你如何为一组特定的文件“标记”、“标记”或“发布”一组特定的修订，以便以后可以随时拉取那个？*

使用`git tag`命令。

要简单地“标记”当前版本，您只需运行..

```
git tag -a thetagname
git tag -a 0.1
git tag -a 2.6.1-rc1 -m 'Released on 01/02/03' 
```

要列出当前标签，只需`git tag`不带参数运行，或`-l`（小写 L）：

```
$ git tag -a thetagname # and enter a message, or use -m 'My tag annotation'
$ git tag -l
thetagname 
```

要删除标签，请使用以下`-d`标志：

```
$ git tag -d thetagname 
Deleted tag 'thetagname'
$ git tag
[no output] 
```

要标记特定的（以前的）提交，您只需执行..

```
git tag [tag name] [revision SHA1 hash] 
```

例如：

```
git tag 1.1.1 81b15a68c6c3e71f72e766931df4e6499990385b 
```

* * *

注意：默认情况下，git 创建一个“轻量级”标签（基本上是对特定版本的引用）。“正确”的方法是使用`-a`标志。这将启动您的编辑器，要求提供标签消息（与要求提交消息相同，您也可以使用该`-m`标志在命令行上提供标签消息）。使用带注释的标签创建一个具有自己的 ID、日期、标注者（作者）和可选的 GPG 签名（使用`-s`标签）的对象。 *有关这方面的更多信息，请参阅[此帖子](http://www.rockstarprogrammer.org/post/2008/oct/16/git-tag-does-wrong-thing-default/)*

```
git tag mytagwithmsg -a -m 'This is a tag, with message' 
```

并列出带有注释的标签，使用`-n1`标志显示每个标签消息的 1 行（`-n245`显示每个注释的前 245 行，依此类推）：

```
$ git tag -l -n1
mytagwithmsg    This is a tag, with message 
```

有关更多信息，请参阅[git-tag(1) 手册页](http://www.kernel.org/pub/software/scm/git/docs/git-tag.html)

* * *

## 回答 #6

> 赞同：46
> 
> 时间：2011-05-11T18:06:43.200

GIT 的工作流示例。

Git 非常灵活，可以很好地适应任何工作流程，但不强制执行特定的工作流程可能会产生负面影响，使您难以理解除了线性“备份”工作流程之外您可以使用 git 做什么，以及分支的有用性如何.

这篇[博](http://nvie.com/posts/a-successful-git-branching-model/)文很好地解释了一个非常简单但有效的工作流程，使用 git 很容易设置。

引用博客文章：我们认为 origin/master 是 HEAD 的源代码始终反映生产就绪状态的主要分支：

该工作流程已经变得足够流行，以至于制作了一个实现此工作流程的项目：[git-flow](https://github.com/nvie/gitflow)

一个简单的工作流程的很好的说明，您在开发中进行所有更改，并且仅在代码处于生产状态时推送到 master：

![简单的工作流程](https://i.stack.imgur.com/NAOZI.png)

现在假设你想开发一个新特性，或者重构一个模块。您可以创建一个新分支，我们可以称之为“功能”分支，这将需要一些时间并且可能会破坏一些代码。一旦您的功能“足够稳定”并希望将其“更接近”生产，您将您的功能分支合并到开发中。当合并后所有的错误都被整理出来并且你的代码通过了所有测试坚如磐石时，你将你的更改推送到 master。

在所有这些过程中，您会发现一个可怕的安全漏洞，必须立即修复。您可以有一个名为 hotfixes 的分支，与普通的“开发”分支相比，它可以更快地将更改推送回生产环境。

在这里，您可以了解此功能/修补程序/开发/生产工作流程的外观（在博客文章中进行了很好的解释，我重复一遍，博客文章比我更详细和更好地解释了整个过程.

![Git 工作流示例](https://i.stack.imgur.com/6rDUk.png)

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2010-04-20T20:02:59.703

这是 PJ Hyett 帖子的副本，因为它不再可用：

> ## Git 并不难
> 
> 2008 年 11 月 23 日
> 
> 当我们告诉人们为什么他们应该使用 Git 而不是 Subversion 时，最重要的是，“Git 比 Subversion 做得更好，但它做得更多。”</p>
> 
> “更多”是由一堆让 Git 真正闪耀的东西组成的，但对于那些来自其他 SCM （如 Subversion）的人来说，它可能会让人不知所措。
> 
> 也就是说，没有什么可以阻止您使用 Git，就像您在进行转换时使用 Subversion 一样。
> 
> 假设您已经安装了必要的软件并且在某处有一个远程存储库，这就是您将如何获取代码并使用 Subversion 将您的更改推回：
> 
> `$ svn checkout svn://foo.googlecode.com/svn/trunk foo`
> `# make your changes`
> `$ svn commit -m "my first commit"`
> 
> 你将如何在 Git 中做到这一点：
> 
> `$ git clone git@github.com:pjhyett/foo.git`
> `# make your changes`
> `$ git commit -a -m "my first commit"`
> `$ git push`
> 
> 在 Git 中实现它的另一个命令。这个额外的命令有很大的影响，但就本文而言，这就是我们要讨论的全部，一个额外的命令。
> 
> 看，真的没那么难。
> 
> **更新：**我还没有提到与 Git 相比，在 Subversion 中更新本地副本的等价物分别是`svn update`和 `git pull`。两种情况下只有一个命令。

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2008-11-27T13:25:31.423

# How to install Git

## On Windows:

Install [msysgit](http://code.google.com/p/msysgit/)

There are several downloads:

*   **Git:** Use this unless you specifically need one of the other options below.
*   **PortableGit:** Use this if you want to run Git on a PC without installing on that PC (e.g. running Git from a USB drive)
*   **msysGit:** Use this if you want to develop Git itself. If you just want to use Git for *your* source code, but don't want to edit *Git's* source code, you don't need this.

This also installs a Cygwin bash shell, so you can use the `git` in a nicer shell (than cmd.exe), and also includes git-gui (accessible via `git gui` command, or the `Start > All Programs > Git` menu)

## Mac OS X

Use the [git-osx-installer](http://code.google.com/p/git-osx-installer/), or you can also install from source

## Via a package manager

Install `git` using your native package manager. For example, on Debian (or Ubuntu):

```
apt-get install git-core 
```

Or on Mac OS X, via [MacPorts](http://www.macports.org/):

```
sudo port install git-core+bash_completion+doc 
```

…or fink:

```
fink install git 
```

…or [Homebrew](http://github.com/mxcl/homebrew):

```
brew install git 
```

On Red Hat based distributions, such as Fedora:

```
yum install git 
```

In Cygwin the Git package can be found under the "devel" section

## From source (Mac OS X/Linux/BSD/etc.)

In Mac OS X, if you have the Developer Tools installed, you can compile Git from source very easily. Download the latest version of Git as a `.tar.bz` or `.tar.gz` from [http://git-scm.com/](http://git-scm.com/), and extract it (double click in Finder)

On Linux/BSD/etc. it should be much the same. For example, in Debian (and Ubuntu), you need to install the `build-essential` package via `apt`.

Then in a Terminal, `cd` to where you extracted the files (Running `cd ~/Downloads/git*/` should work), and then run..

```
./configure && make && sudo make install 
```

This will install Git into the default place (`/usr/local` - so `git` will be in `/usr/local/bin/git`)

It will prompt you to enter your password (for `sudo`), this is so it can write to the `/usr/local/` directory, which can only be accessed by the "root" user so sudo is required!

If you with to install it somewhere separate (so Git's files aren't mixed in with other tools), use `--prefix` with the configure command:

```
./configure --prefix=/usr/local/gitpath
make
sudo make install 
```

This will install the `git` binary into `/usr/local/bin/gitpath/bin/git` - so you don't have to type that every time you, you should add into your `$PATH` by adding the following line into your `~/.profile`:

```
export PATH="${PATH}:/usr/local/bin/gitpath/bin/" 
```

If you do not have sudo access, you can use `--prefix=/Users/myusername/bin` and install into your home directory. Remember to add `~/bin/` to `$PATH`

The script [x-git-update-to-latest-version](http://www.simplicidade.org/notes/archives/2008/09/updated_xgitupd.html) automates a lot of this:

> This script updates my local clone of the git repo (localy at `~/work/track/git`), and then configures, installs (at `/usr/local/git`-`git describe`) and updates the `/usr/local/git` symlink.
> 
> This way, I can have `/usr/local/git/bin` in my `PATH` and I'm always using the latest version.
> 
> The latest version of this script also installs the man pages. You need to tweak your `MANPATH` to include the `/usr/local/git/share/man` directory.

* * *

## 回答 #9

> 赞同：32
> 
> 时间：2008-11-27T14:25:15.780

# Git 重置

假设您进行了拉取，将其合并到您的代码中，然后决定您不喜欢它。使用 git-log 或 tig，并找到您想要返回的任何地方的哈希（可能是您在拉/合并之前的最后一次提交）复制哈希，然后执行以下操作：

```
# Revert to a previous commit by hash:
git-reset --hard <hash> 
```

您可以使用**HEAD^**作为上一次提交的快捷方式，而不是哈希。

```
# Revert to previous commit:
git-reset --hard HEAD^ 
```

* * *

## 回答 #10

> 赞同：31
> 
> 时间：2010-06-03T08:43:19.957

# 您如何设置共享团队存储库？

[这里](https://stackoverflow.com/questions/315911/git-for-beginners-the-definitive-practical-guide/320140#320140)描述了如何建立一个*普通*的存储库——但是你如何建立一个每个人都可以拉取和推入的团队存储库？

## 使用共享 NFS 文件系统

假设您的团队已经拥有例如可以使用的共享组成员身份。

```
mkdir /your/share/folder/project.git
cd /your/share/folder/project.git
newgrp yourteamgroup # if necessary
git init --bare --shared 
```

要开始使用此存储库，最简单的方法是从您已经使用过的本地存储库开始：

```
cd your/local/workspace/project
git remote add origin /your/share/folder/project.git
git push origin master 
```

其他人现在可以克隆它并开始工作：

```
cd your/local/workspace
git clone /your/share/folder/project.git 
```

## 使用 SSH

在目标服务器上设置用户帐户。您是使用无密码帐户、有密码帐户还是使用`authorized_keys`真正取决于您所需的安全级别。查看[通过 SSH 配置 Git 以](https://stackoverflow.com/questions/1595848/configuring-git-over-ssh)获取更多信息。

如果所有开发人员都使用同一个帐户访问此共享存储库，则无需使用上述`--shared`选项。

以与上述相同的方式初始化存储库后，您可以像这样进行初始推送：

```
cd your/local/workspace/project
git remote add origin user@server:/path/to/project.git
git push origin master 
```

看到与上面的相似之处了吗？唯一可能发生的事情是如果帐户有密码，SSH 会要求输入密码。如果您在没有密码的帐户上收到此提示，则 SSH 服务器可能已禁用`PermitEmptyPasswords`。

克隆现在看起来像这样：

```
cd your/local/workspace
git clone user@server:/path/to/project.git 
```

* * *

## 回答 #11

> 赞同：28
> 
> 时间：2008-11-26T01:20:06.663

`git status`是你的朋友，经常使用它。适合回答以下问题：

*   那条命令刚刚做了什么？
*   我在哪个分支？
*   我将要进行哪些更改，我是否忘记了什么？
*   上次我在这个项目上工作时（几天、几周，或者几个月前），我是否正在做某事？

不像，说`svn status`，`git status`即使在大型项目上也几乎可以立即运行。我经常在学习 git 时发现它经常使用它，以确保我对正在发生的事情的心理模型是准确的。现在我主要用它来提醒自己自上次提交以来我发生了什么变化。

显然，如果您的 .gitignore 配置合理，它会更有用。

* * *

## 回答 #12

> 赞同：27
> 
> 时间：2008-11-25T01:01:00.150

## 提交更改

编辑文件后，您需要将更改提交到 git。当您执行此命令时，它会询问提交消息 - 这只是一个简单的文本，告诉大家您所做的更改。

```
$ git commit source/main.c 
```

将提交目录 ./source/ 中的文件 main.c

```
$ git commit -a # the -a flag pulls in all modified files 
```

将提交所有更改的文件（但不是新文件，这些文件需要使用 git-add 添加到索引中）。如果您只想提交某些文件，那么您需要先使用 git-add 暂存它们，然后在没有 -a 标志的情况下提交。

提交只会更改您的本地存储库，而不是远程存储库。如果要将提交发送到远程存储库，则需要进行推送。

```
$ git push <remote> <branch> # push new commits to the <branch> on the <remote> repository 
```

对于来自 CVS 或 SVN 的人来说，这是一个改变，因为提交到中央存储库现在需要两个步骤。

* * *

## 回答 #13

> 赞同：27
> 
> 时间：2009-05-03T08:56:11.820

# 你怎么分支？

git 存储库中的默认分支称为`master`.

创建一个新的分支使用

```
git branch <branch-name> 
```

查看当前存储库类型中所有分支的列表

```
git branch 
```

如果你想切换到另一个分支，你可以使用

```
git checkout <branch-name> 
```

一步创建一个新分支并切换到它

```
git checkout -b <branch-name> 
```

要删除分支，请使用

```
git branch -d <branch-name> 
```

要使用当前分支的更改创建一个分支，请执行

```
git stash
git stash branch <branch-name> 
```

* * *

## 回答 #14

> 赞同：21
> 
> 时间：2009-08-29T01:33:15.780

## 获取最新代码

```
$ git pull <remote> <branch> # fetches the code and merges it into 
                             # your working directory
$ git fetch <remote> <branch> # fetches the code but does not merge
                              # it into your working directory

$ git pull --tag <remote> <branch> # same as above but fetch tags as well
$ git fetch --tag <remote> <branch> # you get the idea 
```

这几乎涵盖了从远程存储库获取最新代码副本的所有情况。

* * *

## 回答 #15

> 赞同：20
> 
> 时间：2010-07-15T21:00:56.887

[Pro Git](http://progit.org)免费书绝对是我的最爱，尤其是对于初学者。

* * *

## 回答 #16

> 赞同：18
> 
> 时间：2008-11-25T01:02:49.053

[Git Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)是您所需要的一切。品质保证，退款保证！

* * *

## 回答 #17

> 赞同：16
> 
> 时间：2009-10-31T17:21:09.413

我还发现[Git Internals](http://peepcode.com/products/git-internals-pdf)非常有用。它由 Scott Chacon（Pro Git 的作者，Git Community Book 的维护者）编写。我喜欢 Git Internals 的地方在于它首先[关注概念，然后是命令](http://blog.jordanterrell.com/post/Favor-Concepts-Over-Commands.aspx)，并且因为它只有大约 100 个小页面，所以可以很快消化。

* * *

## 回答 #18

> 赞同：16
> 
> 时间：2009-05-03T09:08:01.247

# 你如何合并分支？

如果您想合并一个分支（例如`master`to `release`），请确保您当前的分支是您想要合并到的目标分支（使用`git branch`或`git status`查看您的当前分支）。

然后使用

```
git merge master 
```

（`master`要与当前分支合并的分支的名称在哪里）。

如果有任何冲突，您可以使用

```
git diff 
```

要查看您必须解决的未决冲突。

* * *

## 回答 #19

> 赞同：13
> 
> 时间：2010-01-22T03:59:11.177

# 您如何查看文件的修订历史？

```
git log -- filename
```

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2009-10-19T20:02:18.710

# 如何跟踪远程分支

假设有一个远程存储库，您从中克隆了本地存储库，并且还假设该远程存储库上有一个名为“some_branch”的分支，以下是如何在本地跟踪它：

```
# list remote branches
git branch -r

# start tracking one remote branch
git branch --track some_branch origin/some_branch

# change to the branch locally
git checkout some_branch

# make changes and commit them locally
....

# push your changes to the remote repository:
git push 
```

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2009-11-19T10:25:40.657

了解 Git 工作原理的真正好论文是[The Git Parable](http://tom.preston-werner.com/2009/05/19/the-git-parable.html)。非常推荐！

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2009-11-19T11:21:41.620

# 你如何比较一个文件的两个版本，或者你当前的文件和以前的版本？

比较命令是`git diff`.

要比较文件的 2 个修订版：

```
$ git diff <commit1> <commit2> <file_name> 
```

这将 commit1 与 commit2 区别开来；如果您更改顺序，则文件会以相反的方式进行区分，这可能不是您所期望的...

要将当前暂存文件与存储库进行比较：

```
$ git diff --staged <file_name> 
```

要将当前未暂存的文件与存储库进行比较：

```
$ git diff <file_name> 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2008-11-25T00:52:48.543

Why yet another howto? There are really good ones on the net, like the [git guide](http://www.sourcemage.org/Git_Guide) which is perfect to begin. It has good links including the [git book](http://book.git-scm.com/) to which one can contribute (hosted on git hub) and which is perfect for this collective task.

On stackoverflow, I would really prefer to see your favorite tricks !

Mine, which I discovered only lately, is `git stash`, explained [here](http://book.git-scm.com/4_stashing.html), which enables you to save your current job and go to another branch

EDIT: as the previous post, if you really prefer stackoverlow format with posts as a wiki I will delete this answer

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2008-11-27T05:23:15.827

# 控制台 UI - Tig

## 安装：

```
apt-get install tig 
```

## 用法

在 git repo 中，键入“tig”以查看交互式日志，在任何日志上按“enter”以查看有关它的更多信息。**h**寻求帮助，其中列出了基本功能。

## 琐事

“Tig”是倒过来的“Git”。

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2009-04-06T03:56:20.357

我开始使用官方[Git 教程](http://www.kernel.org/pub/software/scm/git/docs/gittutorial.html)。我认为它对初学者来说足够实用（根据你的定义，我曾经是，现在仍然是初学者！我几乎不掌握 makefile，我只玩过一点 Apache Subversion 等）。

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2011-05-12T11:58:27.040

## 如何删除远程存储库上的分支？

`:`使用分支名称之前在远程执行推送

```
git push origin :mybranchname 
```

是`origin`您的遥控器`mybranchname`的名称和即将被删除的分支的名称

[http://help.github.com/remotes/](http://help.github.com/remotes/)

* * *

## 回答 #27

> 赞同：8
> 
> 时间：2009-10-19T20:05:56.800

# 如何在远程存储库上创建分支？

假设您已经从某个远程存储库克隆了远程存储库。

```
# create a new branch locally
git branch name_of_branch
git checkout name_of_branch
# edit/add/remove files    
# ... 
# Commit your changes locally
git add fileName
git commit -m Message
# push changes and new branch to remote repository:
git push origin name_of_branch:name_of_branch 
```

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2008-11-27T13:21:13.773

**Push and pull changes**

In an simplified way, just do `git push` and `git pull`. Changes are merged and if there's a conflict git will let you know and you can resolve it manually.

When you first push to a remote repository you need to do a `git push origin master` (master being the master branch). From then on you just do the `git push`.

Push tags with `git push --tags`.

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2008-11-27T14:27:51.127

# 签出代码

首先转到一个空目录，使用“git init”使其成为存储库，然后将远程存储库克隆到您自己的存储库中。

```
git clone user@host.com:/dir/to/repo 
```

无论您最初从哪里克隆，默认情况下“git pull”将从哪里拉取。

* * *

## 回答 #30

> 赞同：7
> 
> 时间：2010-03-27T23:18:01.300

Gity：[http://macendeavor.com/gity](http://macendeavor.com/gity)

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2008-11-27T13:14:18.467

**Resource**: Definitely check out [Scott Chacon's Gitcasts](http://www.gitcasts.com/), **[especially the Railsconf talk](http://www.gitcasts.com/posts/railsconf-git-talk)**.

[Github](https://github.com/) is awesome and also has some [helpful guides](http://github.com/guides/home).

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2009-10-16T06:20:42.853

认真添加Tim在 Stack Overflow 帖子[Setup Git Server with Msysgit on Windows中](https://stackoverflow.com/questions/1482824/setup-git-server-with-msysgit-on-windows)[的回答](https://stackoverflow.com/questions/1482824/setup-git-server-with-msysgit-on-windows/1503986#1503986)中的链接。

它完美地告诉我如何使用[msysgit](http://code.google.com/p/msysgit/)在 Windows 上设置 Git ，并且是一篇非常详细的文章。

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2011-05-12T22:09:50.917

## 什么是变基？

Rebase 解释取自《*[Pragmatic Guide to Git - Travis Swicegood 》一书](https://rads.stackoverflow.com/amzn/click/com/1934356727)*

> 第三章
> 
> 16\. 通过变基重写历史
> 
> Rebase 提交是 Git 中的一个概念，在传统版本控制世界中没有对应的概念。使用 git rebase，您可以通过多种方式重写存储库的历史记录。它是 Git 中最强大的命令之一，也是最危险的命令之一。
> 
> **`rebase`接受一系列提交（通常是一个分支）并在另一个提交（通常是另一个分支中的最后一个提交）之上重播它们。父提交更改，因此重新计算所有提交 ID。这可能会给拥有您的代码的其他开发人员带来问题，因为 ID 不匹配。**
> 
> git rebase 有一个简单的经验法则：在本地提交上尽可能多地使用它。一旦您与另一位开发人员共享更改，通常不值得麻烦。

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2009-03-13T18:58:26.717

WRT 良好的 GUI/前端，您可能还想查看[qgit](http://sourceforge.net/projects/qgit)，它是 Git 的跨平台（Linux/Win32）存储库查看器，也可以用作最常见 Git 操作的高级前端，事实上它可以通过所谓的“自定义操作”轻松增强，以便用户可以提供自定义操作。

* * *

## 回答 #35

> 赞同：4
> 
> 时间：2009-05-21T00:50:09.250

我发现[这篇文章](http://www.eecs.harvard.edu/~cduan/technical/git/)对我入门非常有用。我仍然需要阅读这本书和其他资源，但正如标题所说，这篇文章对“从概念上理解 git”很有帮助。[我还建议参加RubyLearning](http://www.rubylearning.org)提供的 Git 和 GitHub 课程。

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2012-03-23T07:59:26.070

我真正认为应该在此列表中的另一个项目，可能对初学者非常有用：

# 不要恐慌

如果我做了一些提交，然后我做了一些可怕的事情，比如变基，现在有些东西——甚至所有东西——似乎都丢失了怎么办？（Rebase 似乎是第一次吸引大多数人的那个，所以我专注于它。虽然`git rebase --abort`很有帮助，但有时你会发现你在交互式 rebase 期间搞砸了编辑，例如，让 rebase完成，现在你想拿回你的旧东西。然后有类似`filter-branch`...）

一个关键的 git 原则是它永远不会真正删除您已提交的任何内容。（“什么，从来没有？” “不，从来没有！” “什么，*从来没有*？” “嗯，几乎从来没有！”）如果你没有跑`git gc`，*它还在里面*。可能需要一些挖掘才能找到你以前的工作，但如果你之前做了一些成功`git commit`的 s，那么，例如，即使你明显被破坏的一系列来自悲剧性的 rebase 错误的提交仍然在那里，通常至少一个月（从技术上讲，直到“reflogs”过期）。

重要的是要记住，每个分支名称都标记或指向一个“提交 ID”。这些是有趣的数字`7cc5272`。您所做的许多事情，例如向分支添加新提交，都会使分支名称指向一个新的、不同的提交 ID。每个提交 ID 都有一个链接指向一些以前的提交 ID，这实际上构成了一个充满提交的“分支”。

rebase 条目谈论“重写历史”和类似`git filter-branch`“重写历史”的命令，但它们不是通过破坏以前的历史，而是通过添加新的历史来做到这一点。一旦新的历史记录到位，git 将“移动标签”，这样*看起来*历史记录已经改变了。如果您在您的`fix-nasty-bug`分支上`git rebase`并设法破坏事物，则标签`fix-nasty-bug`现在指的是残骸，但原始版本仍然存在。变基特别制作了一个临时（非移动，非分支）标签拼写`ORIG_HEAD`，让您可以找到它们。这`filter-branch`命令也保存所有原始名称。在某些情况下，可能没有明显的名称，但始终可以找到提交。如有必要，给自己找一个“git guru”并解释你做了什么导致了残骸。

（该命令`git reflog show`还可以帮助查找提交 ID。）

如果您发现您认为是您以前的部分或全部工作，请尝试：

```
git log <commit-ID>   # ORIG_HEAD after a bad rebase, for instance
git show <commit-ID>  # or some long SHA1 value you can still see in a window 
```

如果它看起来正确或有用，请为其命名：

```
git branch recover-my-stuff ORIG_HEAD 
```

一切又回来了！事实上，现在你的坏 rebase 和你的原始工作都“永远”在你的 git repo 中（或者至少，直到你删除分支名称*并*等待几个月过去，然后它们被垃圾收集）。您可以为尽可能多的恢复提交添加任意数量的名称。（分支名称实际上是免费的，除了会使您的`git branch`输出变得混乱，当然它们还可以防止提交被垃圾收集。您也可以，或者，如果您愿意，可以在特定的提交 ID 上放置标签。）

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2012-05-10T08:47:01.013

关于合并冲突的非常好的帖子 - [GitGuys：合并冲突 - 冲突和解决方案](http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-resolutions/)

该博客非常棒 - 说明性，简洁的示例且易于理解。绝对值得一试。

# javascript - 在 jQuery 中发布/提交多个表单

> ID：315912
> 
> 赞同：5
> 
> 时间：2008-11-24T23:51:05.313
> 
> 标签：javascript, jquery

我在一个页面上有两个表单（一个被 AJAX 抓取）。我需要将它们都发布，所以我序列化第二个并在提交第一个之前使用 jQuery 在帖子中发送它。但是，似乎只发布了第一个表单。奇怪的是，如果我在序列化帖子之后发出警报，它会按预期工作。我的问题到底是什么？

```
$("#submit").livequery('click', function() {
    var form = $("#second_form");
    var action = form.attr("action");
    var serialized_form = form.serialize();
    $.post(action, serialized_form);

    //alert('test');

    $("#first_form").submit();

    return false;
}); 
```

有没有更好的方法来发布两个表单，然后在按下按钮时重定向到新页面？我尝试使用上述方法发布它们，然后使用 window.location 更改页面，但我遇到了类似的问题。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T00:26:29.157

您可以尝试在“second_form”帖子的回调中提交“first_form”。我相信“first_form”的提交正在卸载导致第二个帖子中止的页面。在“second_form”的回调中执行“first_form”的发布将确保初始发布在第二个发布开始之前完成。

```
$("#submit").livequery('click', function() {
    var form = $("#second_form");
    var action = form.attr("action");
    var serialized_form = form.serialize();
    $.post(action, serialized_form, submit_first);
});

function submit_first(val) {
   $("#first_form").submit();
} 
```

# excel - 试图提高数组公式的效率

> ID：315915
> 
> 赞同：4
> 
> 时间：2008-11-24T23:52:05.950
> 
> 标签：excel, worksheet-function, array-formulas

我有一个包含多个嵌套 IF 语句的 SUM 数组公式，因此效率非常低。我的公式跨越 500 多行，但这里是它的一个简单版本：

```
{=SUM(IF(IF(A1:A5>A7:A11,A1:A5,A7:A11)-A13:A17>0,
IF(A1:A5>A7:A11,A1:A5,A7:A11)-A13:A17,0))} 
```

如您所见，公式的前半部分检查数组大于零的位置，如果是，则将公式第二部分中的值相加。

你会注意到相同的 IF 语句在那里重复了两次，这对我来说效率很低，但这是我得到正确答案的唯一方法。

我的示例数据如下：

[电子表格中的示例数据 http://clients.estatemaster.net/SecureClientSite/Download/TempFiles/example.jpg](http://clients.estatemaster.net/SecureClientSite/Download/TempFiles/example.jpg) 在这种情况下，使用我上面提到的公式，答案应该是 350。

如果我试图在数组中放入一个 MAX 语句，因此删除测试以找到它大于零的位置，所以它是这样的：

```
{=SUM(MAX(IF(B2:B6>B8:B12,B2:B6,B8:B12)-B14:B18,0))} 
```

但是，它似乎只计算每个范围内的第一行数据，它给了我 70 的错误答案。

有谁知道我可以通过不需要在其中重复 IF 语句来减小公式的大小或使其更有效？

* * *

**更新**

吉米

您建议的 MAX 公式实际上并不适用于所有情况。

如果我将第 1 行到第 5 行中的示例数据更改如下（显示某些数字大于第 7 到第 11 行中它们各自的单元格，而某些数字则较低）

[电子表格中的示例数据 http://clients.estatemaster.net/SecureClientSite/Download/TempFiles/example2.jpg](http://clients.estatemaster.net/SecureClientSite/Download/TempFiles/example2.jpg)

我试图达到的正确答案是 310，但是您建议 MAX 公式给出的错误答案是 275。

我猜这个公式需要是一个数组函数才能给出正确的答案。

还有其他建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T00:45:44.127

```
=MAX( MAX( sum(A1:A5), sum(A7:A11) ) - sum(A13:A17), 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T16:24:25.213

一种计算效率更高（尤其是重新计算效率更高）的方法是使用辅助列而不是数组公式：

C1：`=MAX(A1,A7)-A13`
D1：`=IF(C1>0,C1,0)`

将这两个都复制 5 行

E1：`=SUM(D1:D5)`

然后，Excel 将仅根据任何更改的值重新计算公式，而不必在每次任何单个数字更改时都计算数组公式所隐含的所有虚拟列。即使你改变了所有的数字，它也做更少的计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T04:51:09.590

您可能需要查看 VB 宏编辑器。在“工具”菜单中，转到“宏”并选择“Visual Basic 编辑器”。这提供了一个完整的编程环境，您可以在其中编写自己的函数。

VB 是一种简单的编程语言，谷歌有你需要的所有指南。

在那里，您可以编写一个类似 MySum() 的函数，并让它以您自己编写的清晰方式执行您真正需要的任何数学运算。

我把这个从谷歌上拉下来了，它看起来像是一个很好的设置指南。 [http://office.microsoft.com/en-us/excel/HA011117011033.aspx](http://office.microsoft.com/en-us/excel/HA011117011033.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T00:02:09.907

那这个呢？

```
=MAX(SUM(IF(A1:A5>A7:A11, A1:A5, A7:A11))-SUM(A13:A17), 0) 
```

**编辑：**

糟糕——错过了扔掉底片的部分。那这个呢？不知道是不是更快...

```
=SUM((IF(A1:A5>A7:A11,IF(A1:A5>A13:A17,A1:A5,A13:A17),IF(A7:A11>A13:A17,A7:A11,A13:A17))-A13:A17)) 
```

**编辑2：**

这对你有什么影响？

```
=SUM((((A1:A5>A13:A17)+(A7:A11>A13:A17))>0)*(IF(A1:A5>A7:A11,A1:A5,A7:A11)-A13:A17)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T18:54:09.233

这似乎有效：

```
{=SUM(IF(A1:A5>A7:A11,A1:A5-A13:A17,A7:A11-A13:A17))} 
```

编辑 - 不处理减法最终为负的情况

这行得通 - 但它更有效吗？？？

```
{=SUM(IF(IF(A1:A5>A7:A11,A1:A5,A7:A11)>A13:A17,IF(A1:A5>A7:A11,A1:A5,A7:A11)-A13:A17,0))} 
```

# frameworks - 操作系统和框架有什么区别？

> ID：315918
> 
> 赞同：0
> 
> 时间：2008-11-24T23:53:23.607
> 
> 标签：frameworks, operating-system, azure

我最近发布了一个关于 Azure 的问题……[它真的是一个操作系统吗？](https://stackoverflow.com/questions/315879/is-azure-an-operating-system-or-a-framework) 我了解技术细节，但我得到了很多模糊的答案......我真的很想知道......你认为操作系统和框架之间的区别是什么？

仅供参考，Azure 将构建在 Hyper-V 服务器之上，虚拟机将运行 vanilla Windows Server 2008。它将运行在称为 Azure 的许多虚拟机之上创建云的服务。Windows 将 Azure 称为操作系统。

我试图了解如何定义操作系统和框架之间的区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T00:12:45.877

[操作系统](http://en.wikipedia.org/wiki/Operating_system)：计算机系统的基础软件组件

[框架](http://en.wikipedia.org/wiki/Framework#Software_framework)：软件系统（或子系统）的可重用设计。

根据这些定义，在我看来，可以使用框架构建操作系统，并且可以构建框架以与操作系统交互。

[Singularity](http://en.wikipedia.org/wiki/Singularity_(operating_system))是使用托管代码构建的实验性操作系统的一个示例。

框架是一个很宽泛的术语，它可以用来描述很多类型的子系统。它甚至可以描述一个操作系统。

操作系统更具体，它意味着通过使用人类用户界面促进与计算机或计算机硬件层的交互。我认为 Azure 符合这个描述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T00:24:51.127

这取决于营销 - 我认为这些术语不再具有明确的含义。**JVM**
是一个框架吗？如果它在原始**uC**甚至**FPGA**上运行会怎样——它是**操作系统**吗？

 ******* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T23:56:57.360

操作系统是直接与机器交互的东西，无论是虚拟的还是真实的。它必须公开处理输入设备、输出设备、声音、网络以及我们现在认为理所当然的所有其他事情的系统调用。它还经常提供某种 UI，使用这些服务使其易于使用/对最终用户有用。它需要有设备驱动程序才能与视频卡、声卡等一起工作（再一次，这些可以被虚拟化）。

框架是……建立在操作系统之上的东西。它也公开了一个 API，但它们通常不像操作系统公开的那样低级。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T00:24:25.293

框架提供了 ose 通常不提供的 api 合约——这意味着它们位于操作系统*之上*，隐藏和管理差异，从而为您提供平台独立性的好处，可以扩大我们的目标受众

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T21:53:13.500

一个框架被认为是一个开发环境，一个进一步开发的帮助平台，你可以使用框架的组件来创建一些其他的应用程序，而操作系统是系统软件，是一个操作系统的环境。

# oracle - 设置 global_names 参数

> ID：315919
> 
> 赞同：1
> 
> 时间：2008-11-24T23:54:00.503
> 
> 标签：oracle, peoplesoft

问候，

我的公司在财务和人力资源方面使用 Peoplesoft。我们的实现是在 Oracle 数据库上。设置 global_names = TRUE 会强制您将数据库链接命名为与目标相同。我的问题是有人知道在 init.ora 参数文件中将 global_names 设置为 false 的后果吗？

更具体地说，我希望我们的一个环境 (global_names = true) 有一个名为 PRODLINK 的数据库链接，它将指向生产 HR 数据库。另一个环境（其中 global_names = false）也将有一个名为 PRODLINK 的链接，但它将指向一个非生产数据库。更复杂的是，一个数据库环境是 Oracle 9.2，而另一个是 Oracle 10.2

我已经为此寻找答案，但找不到答案。提前感谢您提供的任何帮助/建议。

JC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T13:55:29.710

具有 global_names=TRUE 的好处只是它迫使您为数据库链接使用名称，这些名称清楚地表明它们连接到哪个数据库。将其设置为 FALSE 只会消除此限制；缺点是它允许您使用可能令人困惑的名称建立链接。在相反的情况下，如果您有数据库 A、B 和 C，您可以在 A 中创建一个名为“B”但指向 C 的链接。

您还可以将其视为一个安全问题，因为设置 global_names=FALSE 使得有人可能恶意更改链接的定义，从而导致不适当的访问或数据损坏。不过，我想不出一个具体的场景。

总体而言，将其设置为 FALSE 并没有太大的缺点。但是，您可以考虑其他几个选项。

一种是保持全局设置 TRUE，但在需要它的代码的会话级别将其重置为 FALSE。我们在我的网站上这样做是因为只有一个应用程序需要使用“错误”命名的链接。此方法可确保以交互方式使用链接或编写使用该链接的代码的任何人都会被提醒该名称与目的地不匹配。

另一种方法是保持 global_names=TRUE，因此环境使用不同的链接名称，但将链接名称作为代码中的参数或配置选项。例如，如果您有构建 PL/SQL 包的脚本，您可以将链接名称作为脚本的参数。

# sql-server-2005 - 在使用 SQL2005 的日志传送配置中，未添加主服务器的备份作业

> ID：315929
> 
> 赞同：0
> 
> 时间：2008-11-24T23:59:50.117
> 
> 标签：sql-server-2005, failover

我正在两个 sql server 2005 实例之间创建日志传送配置。我正在运送单个数据库的日志，并且我没有使用 Monitor 服务（暂时）。当我在数据库上运行 SQL Server 日志传送向导时，脚本会按原样执行并声称没有错误。但是当它完成时，辅助服务器有正确的作业列表（复制/恢复），但我认为主服务器应该有一个“备份”工作。它没有。

所以它要么默默地失败，要么我误解了日志传送的工作原理。有谁知道a）是否应该将作业添加到主服务器和b）如果应该有作业，未添加它的一些可能原因可能是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T17:44:26.847

事实证明，无声故障是由于辅助服务器实际上是一个虚拟机，它是主服务器的克隆。即使我更改了计算机名称和 sql 服务器名称。我猜还有其他东西可以识别未更改的实例，这导致了失败。不过，这只是一个猜测。

# css - SharePoint 默认样式

> ID：315932
> 
> 赞同：0
> 
> 时间：2008-11-25T00:01:23.810
> 
> 标签：css, sharepoint

我正在为 SharePoint 构建一个自定义 Web 部件，并且我正在尝试使用默认样式，因此当人们为网站设置主题时，它会以它为主题。

我发现了几个不错的网站，它们展示了不同的风格，例如： [http ://www.sharepointcustomization.com/resources/tipstricks/wss_cssguide.htm](http://www.sharepointcustomization.com/resources/tipstricks/wss_cssguide.htm)

但我正在寻找有更好例子的东西。具体来说，我正在寻找可以添加的良好表格样式。

有谁知道用示例显示不同 SharePoint CSS 样式的网站？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T01:07:10.837

[Heather Solomon 的博客是](http://www.heathersolomon.com/content/sp07cssreference.htm)Sharepoint 2007 CSS 的多人参考资料（您发布的链接适用于 SharePoint 2003）。您还可以使用[开发人员工具栏](http://addons.mozilla.org/en-US/firefox/addon/60)来查找您要查找的 CSS 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T23:28:15.453

如果您正在执行自定义 webpart，请考虑为您的表格使用 SPGridView，我相信它将使用标准的 sharepoint List 表格样式：http: [//msdn.microsoft.com/en-us/library/microsoft.sharepoint.webcontrols.spgridview。 aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webcontrols.spgridview.aspx)

# c# - WebBrowser document cast not valid

> ID：315938
> 
> 赞同：1
> 
> 时间：2008-11-25T00:04:01.527
> 
> 标签：c#, .net, winforms, webbrowser-control

I've got a WebBrowser control on my page. To fire some javascript on a page displayed in the browser control, I call this.myBrowser.Document.InvokeScript("Test");

This works on my dev box with IE7, but on a seperate test machine I get the following error:

```
Exception Type: System.InvalidCastException
Message: Specified cast is not valid.
Source: System.Windows.Forms
Stack Trace: 
   at System.Windows.Forms.UnsafeNativeMethods.IHTMLDocument2.GetLocation()
   at System.Windows.Forms.WebBrowser.get_Document()
   at InteriorHealth.EmbeddedBrowser.frmMain.CardRead(String strData) in E:\Develop\TestProject\frmMain.cs:line 265
   at MyTest.frmMain.prtCardReader_DataReceived(Object sender, SerialDataReceivedEventArgs e) in E:\Develop\TestProject\frmMain.cs:line 355 
```

The test machine is running IE6\. Although I'm not sure, I'm speculating that the difference in IE versions may be the reason for the error. Does this sound right? How do I work around this?

Line 265 of frmMain.cs is:

```
 this.webKiosk.Document.InvokeScript(ConfigurationState.CardReader.Error.FireJavaScriptMethod); 
```

Line 355 of frmMain.cs is:

```
CardRead(strCardData_m); 
```

I think the exception is being thrown by the Document property call on the WebBrowser object.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T19:15:08.177

Figured it out. My call was being invoked from a serial port data received event, which doesn't execute on the main GUI thread. I used a this.Invoke() method call to get my code to execute on the main GUI thread, all is good now!

# c# - 如何使用 Linq to Entity 获取最大 ID？

> ID：315946
> 
> 赞同：89
> 
> 时间：2008-11-25T00:09:15.947
> 
> 标签：c#, linq, entity-framework, linq-to-entities

我有一个表用户，它有一个身份列`UserID`，现在什么是正确的 Linq to Entity 代码行，它将返回我的最大值`UserID`？

我试过了：

```
using (MyDBEntities db = new MyDBEntities())
{
    var User = db.Users.Last();
    // or
    var User = db.Users.Max();

    return user.UserID;
} 
```

但似乎不受支持`Last`。`Max`

有任何想法吗？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2008-11-25T00:11:57.893

这样做

```
db.Users.OrderByDescending(u => u.UserId).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2009-03-27T14:06:33.660

试试这个

```
int intIdt = db.Users.Max(u => u.UserId); 
```

**更新：**

如果没有记录然后使用上面的代码生成异常试试这个

```
int? intIdt = db.Users.Max(u => (int?)u.UserId); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-05-15T11:08:26.577

```
var max = db.Users.DefaultIfEmpty().Max(r => r == null ? 0 : r.ModelID); 
```

当 db 中没有记录时，它会毫无例外地返回 0。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-08-18T16:38:41.147

尼萨普列托

```
Users user = bd.Users.Where(u=> u.UserAge > 21).Max(u => u.UserID); 
```

将不起作用，因为 MAX 返回与字段相同类型的变量，因此在这种情况下是 INT 而不是 User 对象。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-12T10:13:46.613

如果您使用`async`and`await`功能，则如下所示：

```
User currentUser = await db.Users.OrderByDescending(u => u.UserId).FirstOrDefaultAsync(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-03T01:42:59.017

请注意，如果键是 varchar，则这些答案都不起作用，因为在填充有“ints”的 varchar 列中使用 MAX 很诱人。

在数据库中，如果“Id”等列在数据库 1、2、3、110、112、113、4、5、6 中，则上述所有答案都将返回 6。

因此，在您的本地数据库中，一切都会正常工作，因为在开发过程中，您永远不会获得超过 100 条测试记录，然后，在生产过程中的某个时刻，您会收到一张奇怪的支持票。然后一个小时后，你会发现这条线“max”似乎由于某种原因返回了错误的键......

（请注意，上面没有任何地方说密钥是 INT ......）（如果碰巧最终出现在通用库中......）

所以使用：

Users.OrderByDescending(x=>x.Id.Length).ThenByDescending(a => a.Id).FirstOrDefault();

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-04-10T19:40:12.140

获取您添加的实体的 id 的最佳方法是这样的：

```
public int InsertEntity(Entity factor)
{
    Db.Entities.Add(factor);
    Db.SaveChanges();
    var id = factor.id;
    return id;
} 
```

# c++ - C++ catching all exceptions

> ID：315948
> 
> 赞同：302
> 
> 时间：2008-11-25T00:11:10.560
> 
> 标签：c++, exception

Is there a c++ equivalent of Java's

```
try {
    ...
}
catch (Throwable t) {
    ...
} 
```

I am trying to debug Java/jni code that calls native windows functions and the virtual machine keeps crashing. The native code appears fine in unit testing and only seems to crash when called through jni. A generic exception catching mechanism would prove extremely useful.

* * *

## 回答 #1

> 赞同：374
> 
> 时间：2008-11-25T00:22:53.173

```
try{
    // ...
} catch (...) {
    // ...
} 
```

will catch all C++ exceptions, but it should be considered bad design. You can use c++11's new current_exception mechanism, but if you don't have the ability to use c++11 (legacy code systems requiring a rewrite), then you have no named exception pointer to use to get a message or name. You may want to add separate catch clauses for the various exceptions you can catch, and only catch everything at the bottom to record an unexpected exception. E.g.:

```
try{
    // ...
} catch (const std::exception& ex) {
    // ...
} catch (const std::string& ex) {
    // ...
} catch (...) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2008-11-25T01:07:30.167

有人应该补充说，不能在 C++ 代码中捕获“崩溃”。那些不会抛出异常，而是做任何他们喜欢的事情。当你看到一个程序因为空指针取消引用而崩溃时，它正在执行未定义的行为。没有`std::null_pointer_exception`。试图捕捉异常将无济于事。

仅针对有人正在阅读此线程并认为他可以找到程序崩溃的原因的情况。应该使用像 gdb 这样的调试器。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2014-06-10T13:19:16.040

`catch(...)`如果您需要（在从第三方库中捕获未知数时可能很有用），这就是您可以使用 GCC 从内部对异常类型进行逆向工程的方法：

```
#include <iostream>

#include <exception>
#include <typeinfo>
#include <stdexcept>

int main()
{
    try {
        throw ...; // throw something
    }
    catch(...)
    {
        std::exception_ptr p = std::current_exception();
        std::clog <<(p ? p.__cxa_exception_type()->name() : "null") << std::endl;
    }
    return 1;
} 
```

如果你负担得起使用[Boost](http://www.boost.org/doc/libs/1_59_0/libs/exception/doc/current_exception_diagnostic_information.html)，你可以让你的 catch 部分更简单（在外面）并且可能是跨平台的

```
catch (...)
{
    std::clog << boost::current_exception_diagnostic_information() << std::endl;
} 
```

* * *

## 回答 #4

> 赞同：70
> 
> 时间：2008-11-25T00:15:44.560

```
try {
   // ...
} catch (...) {
   // ...
} 
```

Note that the `...` inside the `catch` is a real ellipsis, ie. three dots.

However, because C++ exceptions are not necessarily subclasses of a base `Exception` class, there isn't any way to actually see the exception variable that is thrown when using this construct.

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2009-10-11T15:57:27.830

不可能（在 C++ 中）以可移植的方式捕获所有异常。这是因为某些异常不是 C++ 上下文中的异常。这包括诸如除以零错误之类的东西。当这些错误发生时，可以破解并因此获得抛出异常的能力，但这并不容易，而且以可移植的方式正确处理当然也不容易。

如果你想捕获所有 STL 异常，你可以这样做

```
try { ... } catch( const std::exception &e) { ... } 
```

这将允许您使用`e.what()`，这将返回 a `const char*`，它可以告诉您有关异常本身的更多信息。这是最类似于您询问的 Java 构造的构造。

如果有人愚蠢到抛出不继承自的异常，这将无济于事`std::exception`。

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2014-03-08T11:36:11.280

简而言之，使用`catch(...)`. 但是，请注意，这基本上`catch(...)`是与以下内容结合使用的：`throw;`

```
try{
    foo = new Foo;
    bar = new Bar;
}
catch(...)       // will catch all possible errors thrown. 
{ 
    delete foo;
    delete bar;
    throw;       // throw the same error again to be handled somewhere else
} 
```

这是正确的使用方法`catch(...)`。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2013-09-20T14:20:23.967

可以这样写：

```
try
{
  //.......
}
catch(...) // <<- catch all
{
  //.......
} 
```

但是这里有一个非常不明显的风险：你无法在`try`块中找到已经抛出的错误的确切类型，所以`catch`当你确定无论是什么类型的异常，程序都必须坚持的时候使用这种以块中定义的方式`catch`。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-11-25T00:16:51.737

You can use

```
catch(...) 
```

but that is very dangerous. In his book [Debugging Windows](https://rads.stackoverflow.com/amzn/click/com/0735615365), John Robbins tells a war story about a really nasty bug that was masked by a catch(...) command. You're much better off catching specific exceptions. Catch whatever you think your try block might reasonably throw, but let the code throw an exception higher up if something really unexpected happens.

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2008-11-25T00:31:02.517

Let me just mention this here: the Java

```
try 
{
...
}
catch (Exception e)
{
...
} 
```

may NOT catch all exceptions! I've actually had this sort of thing happen before, and it's insantiy-provoking; Exception derives from Throwable. So literally, to catch everything, you DON'T want to catch Exceptions; you want to catch Throwable.

I know it sounds nitpicky, but when you've spent several days trying to figure out where the "uncaught exception" came from in code that was surrounded by a try ... catch (Exception e)" block comes from, it sticks with you.

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-04-23T16:50:19.750

好吧，例如，如果您想捕获所有异常以创建小型转储...

有人在 Windows 上完成了这项工作。

请参阅[http://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus](http://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus) 在文章中，他解释了如何发现如何捕获所有类型的异常，并提供了有效的代码。

这是您可以捕获的列表：

```
 SEH exception
 terminate
 unexpected
 pure virtual method call
 invalid parameter
 new operator fault 
 SIGABR
 SIGFPE
 SIGILL
 SIGINT
 SIGSEGV
 SIGTERM
 Raised exception
C++ typed exception 
```

以及用法：CCrashHandler ch; ch.SetProcessExceptionHandlers(); // 为一个线程执行此操作 ch.SetThreadExceptionHandlers(); // 对于每个线程

默认情况下，这会在当前目录中创建一个小型转储 (crashdump.dmp)

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2020-03-25T13:40:25.273

意识到

```
try{
// ...
} catch (...) {
// ...
} 
```

仅捕获语言级异常，其他低级异常/错误，例如`Access Violation`并且`Segmentation Fault`不会被捕获。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-11-25T00:44:50.650

> A generic exception catching mechanism would prove extremely useful.

Doubtful. You already know your code is broken, because it's crashing. Eating exceptions may mask this, but that'll probably just result in even nastier, more subtle bugs.

What you really want is a debugger...

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-25T21:15:34.953

1.  您能否从控制台窗口运行使用 JNI 的 Java 应用程序（从 java 命令行启动它），以查看在 JVM 崩溃之前是否有任何可能检测到的报告。当直接作为 Java 窗口应用程序运行时，您可能会丢失从控制台窗口运行时出现的消息。

2.  其次，您能否存根您的 JNI DLL 实现以显示您的 DLL 中的方法是从 JNI 输入的，您是否正确返回等等？

3.  万一问题出在 C++ 代码中不正确使用其中一种 JNI 接口方法，您是否验证了一些简单的 JNI 示例可以编译并与您的设置一起使用？我特别考虑使用 JNI 接口方法将参数转换为本机 C++ 格式并将函数结果转换为 Java 类型。存根这些以确保数据转换正常工作并且您不会在对 JNI 接口的类似 COM 的调用中陷入混乱是很有用的。

4.  还有其他事情要检查，但是如果不了解更多关于您的本机 Java 方法是什么以及它们的 JNI 实现试图做什么，就很难提出任何建议。目前尚不清楚从 C++ 代码级别捕获异常是否与您的问题有关。（您可以使用 JNI 接口将异常重新抛出为 Java 异常，但从您提供的内容中不清楚这是否会有所帮助。）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-01-18T22:56:34.503

对于无法正确调试使用 JNI 的程序的真正问题（或在调试器下运行时未出现该错误）：

在这种情况下，它通常有助于在 JNI 调用周围添加 Java 包装器（即，所有本地方法都是私有的，并且类中的公共方法调用它们）进行一些基本的完整性检查（检查所有“对象”是否已释放和“对象”释放后不使用）或同步（只需将所有方法从一个 DLL 同步到单个对象实例）。让 java 包装器方法记录错误并抛出异常。

与尝试在本机调试器...

如果您知道原因，请将代码保留在避免它的包装方法中。最好让你的包装器方法抛出异常，而不是让你的 JNI 代码使 VM 崩溃......

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-13T08:45:50.650

如果您正在寻找**特定于 Windows 的**解决方案，那么有*结构化异常处理*： [https ://docs.microsoft.com/en-us/cpp/cpp/try-except-statement](https://docs.microsoft.com/en-us/cpp/cpp/try-except-statement)

代码如下

```
__try
{
   // code here may throw or make access violation
}
__except( EXCEPTION_EXECUTE_HANDLER )
{
    // after exception code here, e.g. log the error
} 
```

它不仅会捕获 C++ 异常，还会捕获访问冲突或其他系统异常。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-04-22T16:30:20.167

那么这真的取决于编译器环境。gcc 没有捕捉到这些。Visual Studio 和我使用的最后一个 Borland。

所以关于崩溃的结论是它取决于你的开发环境的质量。

C++ 规范说 catch(...) 必须捕获任何异常，但并非在所有情况下都如此。

至少从我的尝试来看。

# c# - 从 MS SQL Server 获取自动编号主键

> ID：315963
> 
> 赞同：4
> 
> 时间：2008-11-25T00:19:32.230
> 
> 标签：c#, sql-server, autonumber

我目前正在使用 C#，我需要在一个表中插入一条新记录，获取新的主键值，然后在插入更多记录时将其用作外键引用。数据库是 MS SQL Server 2003。感谢所有帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T00:27:32.667

获取插入行标识的方法是使用`SCOPE_IDENTITY()`函数。如果您使用的是存储过程，那么这将类似于以下内容，以将行标识作为输出参数返回。

```
CREATE PROCEDURE dbo.MyProcedure
(
    @RowId INT = NULL OUTPUT
)
AS

INSERT INTO MyTable
(
    Column1
    ,Column2
    ,...
)
VALUES
(
    @Param1
    ,@Param2
    ,...
);

SET @RowId = SCOPE_IDENTITY(); 
```

然后，您可以将此值用于任何后续插入（或者，如果您可以将数据全部传递到存储过程中，那么您可以在过程主体的其余部分中使用它）。

如果您动态传递 SQL，那么您将使用大致相同的技术，但使用带有语句分隔符的单个字符串（也在`;`SQL 中），例如：

```
var sql = "INSERT INTO MyTable (Column1, Column2, ...) VALUES (@P1, @P2, ...);" +
          "SELECT SCOPE_IDENTITY();"; 
```

然后，如果您使用执行此操作`ExecuteScalar`，您将能够将标识作为标量结果返回并将其转换为正确的类型。或者，您可以一次构建整个批次，例如

```
var sql = "DECLARE @RowId INT;" + 
          "INSERT INTO MyTable (Column1, Column2, ...) VALUES (@P1, @P2, ...);" +
          "SET @RowId = SCOPE_IDENTITY();" +
          "INSERT INTO MyOtherTable (Column1, ...) VALUES (@P3, @P4, ...);"; 
```

这可能不是*完全*正确的语法，您可能需要`SET NOCOUNT ON;`在开始时使用（我的头脑很生疏，因为我很少使用动态 SQL），但它应该让您走上正确的轨道。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T00:24:44.590

最好的方法是在 TSQL 中使用 SCOPE_IDENTITY() 函数。这应该作为插入的一部分执行，即

```
SqlCommand cmd = new SqlCommand(@"
    INSERT INTO T (Name) VALUES(@Name)
    SELECT SCOPE_IDENTITY() As TheId", conn);
cmd.AddParameter("@Name", SqlDbType.VarChar, 50).Value = "Test";
int tId = (int)cmd.ExecuteScalar(); 
```

或者，您可以将 SCOPE_IDENTITY() 分配给要在连续语句中使用的变量。例如

```
DECLARE @T1 int

INSERT INTO T (Name) VALUES('Test')

SELECT @T1 = SCOPE_IDENTITY() 

INSERT INTO T2 (Name, TId) VALUES('Test', @T1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T00:31:20.893

If you are just using SQL then check Duncan's answer. If however you are using LINQ then you can create the entity, save it to the DB and the ID parameter will be populated automatically.

Given a user entity and a user table it might look like this:

```
using(var db = new DataContext()) {
    var user = new User { Name = "Jhon" };
    db.Users.InsertOnSubmit(user);
    db.SubmitChanges();
    /* At this point the user.ID field will have the primary key from the database */
} 
```

# dependency-injection - 使用 IOC 框架绑定到多个具体实现？

> ID：315964
> 
> 赞同：2
> 
> 时间：2008-11-25T00:20:09.327
> 
> 标签：dependency-injection, inversion-of-control, ioc-container

我对 DI/IOC 容器的概念相对熟悉，我曾在之前已经使用它们的项目上工作过。然而，对于这个新项目，没有现有的框架，我不得不选择一个。

长话短说，在某些场景中，我们将为给定接口配置多个实现。环顾网络，似乎使用任何主流框架来选择性地绑定到其中一个实现都非常简单。

然而，在某些情况下，我们需要运行*所有*配置的实现。我已经在这里搜索了所有 IOC 标记的帖子，我正在尝试翻阅主要框架的文档（到目前为止，查看 Unity、Ninject 和 Windsor），但是文档通常很少，我没有时间检查所有软件包的来源。

那么，是否有任何主流 IOC 容器允许我为我的一项服务绑定到所有已配置的具体类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T04:03:11.310

当我第一次尝试解析已注册类型的所有实现时，让我印象深刻的一件事是，当您调用 ResolveAll() 时，*不会返回未命名（默认）类型的注册。*仅返回命名实例。

所以：

```
IUnityContainer container = new UnityContainer();
container.RegisterType<IMyInterface, MyFirstClass>();
container.RegisterType<IMyInterface, MySecondClass>("Two");
container.RegisterType<IMyInterface, MyThirdClass>("Three");

var instances = container.ResolveAll<IMyInterface>();

Assert.AreEqual(2, instances.Count, "MyFirstClass doesn't get constructed"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T00:56:32.170

所以我不知何故错过了我第一次通过 Unity 浏览...但我会回答我自己的问题。

Unity 正是我想要的。 [http://msdn.microsoft.com/en-us/library/cc440943.aspx](http://msdn.microsoft.com/en-us/library/cc440943.aspx)

此外，对于像我一样从事 IOC 狩猎和跳舞的其他人来说，这个链接被证明是无价的。 [http://blog.ashmind.com/index.php/2008/09/08/comparing-net-di-ioc-frameworks-part-2/](http://blog.ashmind.com/index.php/2008/09/08/comparing-net-di-ioc-frameworks-part-2/)

# mysql - MySQL -- create two indexes, only one appears in SHOW CREATE TABLE output

> ID：315965
> 
> 赞同：2
> 
> 时间：2008-11-25T00:20:24.457
> 
> 标签：mysql, indexing, foreign-keys, constraints

In have a many-to-many linking table and I'm trying to set up two foreign keys on it. I run these two statements:

```
ALTER TABLE address_list_memberships
ADD CONSTRAINT fk_address_list_memberships_address_id
FOREIGN KEY index_address_id (address_id)
REFERENCES addresses (id);

ALTER TABLE address_list_memberships
ADD CONSTRAINT fk_address_list_memberships_list_id
FOREIGN KEY index_list_id (list_id)
REFERENCES lists (id); 
```

I would expect that when I run `SHOW CREATE TABLE address_list_memberships` I'd see this:

```
[...]
KEY `index_address_id` (`address_id`),
KEY `index_list_id` (`list_id`),
CONSTRAINT `fk_address_list_memberships_list_id` FOREIGN KEY (`list_id`) 
    REFERENCES `lists` (`id`),
CONSTRAINT `fk_address_list_memberships_address_id` FOREIGN KEY (`address_id`) 
    REFERENCES `addresses` (`id`) 
```

But instead I get this:

```
[...]
KEY `index_list_id` (`list_id`),
CONSTRAINT `fk_address_list_memberships_list_id` FOREIGN KEY (`list_id`) 
    REFERENCES `lists` (`id`),
CONSTRAINT `fk_address_list_memberships_address_id` FOREIGN KEY (`address_id`) 
    REFERENCES `addresses` (`id`) 
```

It looks as though only one index is there. Seems to contradict the [MySQL docs](http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html) which say MySQL automatically creates an index on the referencing column whenever you create a foreign key.

I've noticed this only-one-index thing every time I create two FKs on a table whether I use a GUI tool such as CocoaMySQL or SQLyog, or whether I do it on the command line.

Any illumination of this mystery would be very much appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T00:59:48.607

我刚试过，对我来说效果很好。我复制并粘贴了`ALTER`你写的陈述，这是我得到的：

```
mysql> show create table address_list_memberships;

CREATE TABLE `address_list_memberships` (
  `address_id` bigint(20) unsigned NOT NULL,
  `list_id` bigint(20) unsigned NOT NULL,
  KEY `index_address_id` (`address_id`),
  KEY `index_list_id` (`list_id`),
  CONSTRAINT `fk_address_list_memberships_list_id` 
    FOREIGN KEY (`list_id`) REFERENCES `lists` (`id`),
  CONSTRAINT `fk_address_list_memberships_address_id` 
    FOREIGN KEY (`address_id`) REFERENCES `addresses` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

我在 Mac OS X 上使用 MySQL 5.0.51a。

**编辑：** 尝试以下查询以获取 MySQL*认为*您的表上存在的所有索引：

```
SELECT * FROM information_schema.key_column_usage 
WHERE table_schema = 'test' AND table_name = 'address_list_memberships'\G 
```

（我使用“测试”数据库进行测试；您应该将此字符串替换为定义表的模式的名称。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T14:08:40.450

这并不重要。您仍然在 list_id 上有一个索引。MySQL 要求任何外键约束在引用字段上也有索引。由于 index_list_id 和 fk_address_list_memberships_list_id 都是建立在 list_id 上的，MySQL 可能会看到这一点并使用 index_list_id 作为索引，将其重命名为 fk_address_list_memberships_list_id。您甚至可以跳过声明索引，因为 MySQL 会在您使用的版本中隐式执行它。

# c# - 如何构造 LINQ to Entities 查询以直接加载子对象，而不是调用 Reference 属性或 Load()

> ID：315966
> 
> 赞同：46
> 
> 时间：2008-11-25T00:22:40.647
> 
> 标签：c#, linq, linq-to-entities

我不熟悉使用 LINQ to Entities（或他们所称的实体框架），我正在编写很多这样的代码：

```
var item = (from InventoryItem item in db.Inventory
            where item.ID == id
            select item).First<InventoryItem>(); 
```

然后像这样在该对象上调用方法：

```
var type = item.ItemTypeReference; 
```

或者

```
var orders = item.OrderLineItems.Load(); 
```

检索子对象或相关对象。

我没有对数据库进行分析或深入挖掘，但我的猜测是，当我调用 .Load() 或 *Reference 属性时，我实际上是在再次调用数据库。如果是这种情况，有没有办法在我的初始 LINQ 表达式中获取这些对象？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-11-25T00:29:40.117

您想在这篇[“塑造查询结果”](http://msdn.microsoft.com/en-us/library/bb896272.aspx)一文中使用 .Include(string) 方法引用。

```
var item = from InventoryItem item in
              db.Inventory.Include("ItemTypeReference").Include("OrderLineItems")
           where item.ID == id
           select item; 
```

Includes 也可能有一个“sql”样式的语法。

另请参阅[这篇](http://blogs.msdn.com/adonet/archive/2008/10/07/migrating-from-linq-to-sql-to-entity-framework-eager-loading.aspx)关于从 LINQ-to-SQL 迁移到 LINQ-to-Entities 的文章。

**对于为Linq to SQL**寻找此问题的解决方案的其他人，您需要执行以下操作（将 DataContext 和其他类型替换为您拥有的任何内容）：

```
using (DataContext db = new DataContext())
{
    DataLoadOptions options = new DataLoadOptions();
    options.LoadWith<InventoryItem>(ii => ii.ItemTypeReference);
    options.LoadWith<InventoryItem>(ii => ii.OrderLineItems);
    db.LoadOptions = options;

    var item = from InventoryItem item in db.Inventory
               where item.ID == id
               select item;
} 
```

每当加载父项 (InventoryItem) 时，这将为该特定上下文加载 LoadWith 中指定的属性。

为了回答 James 和 Jesper 提出的一些进一步问题，请查看这个[问题](https://stackoverflow.com/questions/648782/how-do-i-create-a-where-condition-on-a-sub-table-in-linq)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T14:09:14.683

除了罗伯特的回答之外，您可能还想查看此问题以了解扩展方法的选项，该方法允许您使用表达式而不是字符串来 .Include() ，因此您可以进行编译时检查：

[带有编译时检查的实体框架 .Include()？](https://stackoverflow.com/questions/2921119/entity-framework-include-with-compile-time-checking)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T14:24:01.860

AFAIK, For silverlight(domain services) adding [Include] attribute to right place(over navigation property in metadata) is enough [https://stackoverflow.com/a/5332188/413032](https://stackoverflow.com/a/5332188/413032)

# asp.net - 问题：关于 GridView boundfield ReadOnly 属性

> ID：315968
> 
> 赞同：1
> 
> 时间：2008-11-25T00:23:35.170
> 
> 标签：asp.net

我有一个 Gridview boundfield，我将 ReadOnly 设置为 true，因为我不希望用户更改它的值。但是，在 objectdatasource 控件的 update 方法中，当我尝试将它用作 update 方法中的参数时，boundfield 变为 null。有没有办法在更新期间设置该值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T00:47:42.287

不，只需将您需要的字段名称添加到 GridView 的 DataKeyNames 属性中。然后该值将被发送到更新命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T01:56:53.547

当您在 GridView 上将字段标记为只读时，它会在页面上呈现为 span 元素，而不是输入。因此，该值在 PostBack 上不可用。如果您可以构造更新语句以使其不期望该字段，那将是处理此问题的最佳方法。如果更新语句是自动生成的并且您无法绕过要更新的值，那么您可以在进行更新之前从数据库中读取值（以便您拥有它）或包含绑定到此列的 HiddenField 并使用通过 Eval 而不是绑定（如果需要）获取值的文字。这将需要使用模板。

```
<asp:TemplateField>
    <InsertItemTemplate>
      <asp:TextBox runat="server" ID="itemTextBox" />
    </InsertItemTemplate>
    <EditItemTemplate>
      <asp:HiddenField runat="server" ID="itemHF" Value='<% Bind("Item") %>' />
      <asp:Label runat="server" ID="itemLabel" Text='<% Eval("Item") %>' />
    </EditItemTemplate>
    <ItemTemplate>
       <asp:Label runat="server" ID="itemLabel" Text='<% Bind("Item") %>' />
    </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T19:29:13.613

另一种方法是向您的 tableadapter 添加一个新查询。创建一个仅使用要更新的字段的更新查询。在 ODS 上选择更新方法时，选择更新查询。现在可以将不属于更新查询的 BoundFields 转换为 readonly=true 并且它应该可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-25T16:48:52.527

我有一个类似的问题，并以稍微不同的方式解决了它。但在我的情况下，我想在 Update 方法中使用的参数是我的主键，并且在查询字符串中可用。因此，在我的 DataSource 定义中，我定义了要使用的 UpdateParameters 部分，而不是 . 然后我能够从我的表中完全删除该参数，它将恢复为查询字符串参数。

# c++ - 在 C++ 中，您几乎一直都在做什么？

> ID：315987
> 
> 赞同：5
> 
> 时间：2008-11-25T00:30:41.177
> 
> 标签：c++

当我在 C++ 中将一个类放在一起时，我几乎总是会做一些事情。

1) 虚拟析构函数 2) 复制构造函数和赋值运算符（我要么用称为 Copy() 的私有函数来实现它们，要么将它们声明为私有，从而明确禁止编译器自动生成它们）。

你发现什么东西几乎总是有用的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-25T01:49:49.973

奇怪的是，这里的大多数建议都是我特别不做的事情。

*   我不会让 dtors 成为虚拟的，除非我专门设计它来继承。它增加了很多开销并阻止了自动内联，这很糟糕，因为无论如何大多数 dtor 都是空的（很少有类从继承中受益）
*   除非默认设置不起作用，否则我不会进行复制 ctor/assignment 操作——如果不起作用，我可能想重新考虑设计。请记住，在字符串和向量之间，几乎没有理由再调用 new 了。并且创建自己的与默认相同的复制 ctor 几乎肯定会降低效率。
*   我不添加字符串转换。它会导致太多问题，在您不希望它出现的地方默默地调用演员表。最好添加一个 ToString() 方法。
*   我不加好友oper<<，因为好友又邪恶又乱。最好添加一个 Display(ostream) 方法。然后 oper<< 可以调用它，并且不需要成为朋友。事实上，您可以将 oper<< 设为调用 Display() 的模板函数，而不必再担心它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-25T00:52:38.963

我发现打开 gcc 标志`-Wall`、`-Werror`和 （这是有趣的）`-Weffc++`有助于发现很多潜在的问题。从 gcc 手册页：

> ```
>  -Weffc++ (C++ only)
>       Warn about violations of the following style guidelines from Scott
>       Meyers’ Effective C++ book:
> 
>       ·   Item 11:  Define a copy constructor and an assignment operator
>           for classes with dynamically allocated memory.
> 
>       ·   Item 12:  Prefer initialization to assignment in constructors.
> 
>       ·   Item 14:  Make destructors virtual in base classes.
> 
>       ·   Item 15:  Have "operator=" return a reference to *this.
> 
>       ·   Item 23:  Don’t try to return a reference when you must return
>           an object.
> 
>       and about violations of the following style guidelines from Scott
>       Meyers’ More Effective C++ book:
> 
>       ·   Item 6:  Distinguish between prefix and postfix forms of incre-
>           ment and decrement operators.
> 
>       ·   Item 7:  Never overload "&&", "││", or ",".
> 
>       If you use this option, you should be aware that the standard
>       library headers do not obey all of these guidelines; you can use
>       grep -v to filter out those warnings. 
> ```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T01:11:09.223

当我把一个类放在一起时，我做的第一件事就是在它上面放一些关于它为什么存在以及它做什么的评论。

我曾经参与过一个小组项目，他们说他们想在项目结束时记录这些东西。稍后将注释放入代码中是一团糟。我不想让这种事情再次发生。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T00:49:13.917

在类定义后添加分号。每次我忘记这样做时，这都会让我感到很痛苦，因为 gcc 的错误消息含糊不清，而且通常会说*“无法在函数的返回类型中定义类型”*，这并不意味着很多。 ..

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T10:50:06.590

停下来想一想

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T00:35:04.757

经常，

```
operator string () const; 
```

或者

```
friend ostream& operator << (ostream&, const MyClass&); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T00:53:13.487

在头文件中，执行

```
#ifndef __SOMEDEFINE__
#define __SOMEDEFINE__

#endif 
```

在VS中，我添加

```
#pragma warning(disable: 4786) 
```

哦，我也用

```
#include <inttypes.h> 
```

因为我 <3 C99 类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T00:54:29.553

我**通常**包含一个返回码的枚举，所以类可以告诉它的调用者在它的成员函数中发生了什么。大多数情况下，这将是类的所有成员返回的唯一类型。所有结果都通过引用传回。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-25T08:37:31.210

我首先调用设置包含保护的开发环境宏（#ifdefs 和/或 #pragma once）。

接下来，我将类名和它所在的任何命名空间存根，根本不添加任何功能。

然后我为该类创建单元测试文件，并添加第一个测试（通常是参数构造函数测试）。

我只是从那里开始工作，在思考我真正需要什么时编写和重构课程。我倾向于专门测试的东西：常量正确性、隐式和显式转换、抛出的异常类型等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-25T19:29:55.137

我对一个全新的类文件做的第一件事是写几段关于类做什么、为什么存在、它使用什么类以及如何使用它的注释。随机打开模块中的文件的人从该评论中知道足够多的知识以找到他们实际正在寻找的文件就足够了。

我同意 James 的观点——我非常小心不要向不需要它的类添加功能，大多数类不需要虚拟析构函数（或根本不需要析构函数）。如果他们这样做，我质疑他们为什么不只使用智能指针和其他自动内存管理。显然有许多类（即智能作用域锁）确实需要析构函数，但这不仅仅是理所当然的事情。

# windows-vista - XCOPY 从批处理文件中托管 vista 上的文件

> ID：315991
> 
> 赞同：2
> 
> 时间：2008-11-25T00:31:51.923
> 
> 标签：windows-vista, xcopy, hosts-file

我需要一个命令来替换我机器上的主机文件。看起来很简单，但我无法让命令与 xcopy 一起使用。命令有什么明显的缺陷吗？

luaexec -w -f "XCOPY" "%ScriptPath%/ModifiedHosts/vista/hosts" "%windir%/system32/drivers/etc/hosts" /H

/R 标志似乎没有帮助，如果我删除除开头和结尾引号之外的所有引号，我得到的错误是“错误：ShellExecuteEx 失败 0x2”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T00:37:26.233

你有什么错误吗？

试试这个：

```
luaexec -w -f "XCOPY %ScriptPath%/ModifiedHosts/vista/hosts %windir%/system32/drivers/etc/hosts" /H 
```

此外，您可以尝试 robocopy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T00:35:04.880

主机文件是否写保护？它可能是..在命令行中添加 /R

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T04:50:21.183

在 Vista 上，您需要以管理员身份运行才能更改 hosts 文件。

[参考](http://geekswithblogs.net/thibbard/archive/2006/12/13/ChangingYourHostsFileInVista.aspx)**********`********