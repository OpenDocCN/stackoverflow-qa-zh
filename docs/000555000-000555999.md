# StackOverflow 问答 000555000-000555999

# python - 欧拉问题编号 #4

> ID：555009
> 
> 赞同：3
> 
> 时间：2009-02-16T23:21:46.053
> 
> 标签：python, palindrome

使用 Python，我正在尝试解决[Project Euler](http://projecteuler.net/)问题中的[问题 #4](http://projecteuler.net/index.php?section=problems&id=4)。有人可以告诉我我做错了什么吗？问题是**找到由两个 3 位数字的乘积组成的最大回文数**。这是我到目前为止所拥有的。

 **```
import math

def main(): 
    for z in range(100, 1000):
        for y in range(100, 1000):
            for x in range(1, 1000000):
                x = str(x)
                if x == x[::-1] and x == z*y:
                    print x 

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T00:08:11.700

一些效率问题：

1.  从顶部开始（因为我们可以使用它来跳过很多计算）
2.  不要重复计算

> ```
> def is_palindrome(n):
>     s = str(n)
>     return s == s[::-1]
> 
> def biggest():
>     big_x, big_y, max_seen = 0,0, 0
>     for x in xrange(999,99,-1):
>         for y in xrange(x, 99,-1):  # so we don't double count   
>             if x*y < max_seen: continue  # since we're decreasing, 
>                                 # nothing else in the row can be bigger
>             if is_palindrome(x*y):
>                 big_x, big_y, max_seen = x,y, x*y
> 
>     return big_x,big_y,max_seen
> 
> biggest()
> # (993, 913, 906609) 
> ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-16T23:25:00.493

尝试从 z 和 y 的乘积计算 x，而不是检查从 1 到 100 万之间的每个数字。想一想：如果你被要求计算 500*240，哪个更有效 - 将它们相乘，还是从 1 开始计数直到找到正确答案？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T01:10:59.147

以下是一些需要牢记的一般优化。发布的代码处理所有这些，但这些是学习的一般规则，可能有助于解决未来的问题：

1) 如果您已经检查过 z = 995, y = 990，则无需检查 z = 990, y = 995。Greg Lind 正确处理此问题

2) 你计算 z*y 的乘积，然后在一个很大的范围内运行 x 并将该值与 y*z 进行比较。例如，你刚刚计算了 900*950，然后你将 x 从 1000 运行到 1M，看看 x = 900*950。你看到这个问题了吗？

3）另外，下面的代码会发生什么？（这就是为什么您的代码没有返回任何内容，但无论如何您都不应该这样做）

```
x = str(100)
y = 100
print x == y 
```

4）如果你算出（3），你将在那里打印很多信息。您需要找出一种存储最大值的方法，并且只在最后返回该值。

5）这是计算欧拉问题的好方法：

```
if __name__ == "__main__":
    import time
    tStart = time.time()
    print "Answer = " + main()
    print "Run time = " + str(time.time() - tStart) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T00:20:51.980

而不是枚举所有 3 位数字的乘积（~900^2 次迭代），枚举所有 6 位和 5 位回文串（这需要 ~1000 次迭代）；然后为每个回文决定它是否可以用两个 3 位数的乘积表示（如果不能，它应该有一个 4 位数的素数，所以这很容易测试）。

另外，你问的是问题#4，而不是#3。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T23:25:30.553

将字符串与整数进行比较

```
x == z*y 
```

也有逻辑错误

以相反的顺序开始`range(999, 99, -1)`。那会更有效率。完全删除第三个循环和第二个比较。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-03T22:11:23.030

哇，这种方法比这个页面上的其他实现改进了很多，包括[我](https://stackoverflow.com/a/14146888/423105)的。

代替

*   逐行遍历三位数因子（首先对 x = 999 执行所有 y，然后对 x = 998 执行所有 y，等等），

我们

*   沿着对角线走：首先做所有 x, y 使得 x + y = 999 + 999；然后做所有 x, y 使得 x + y = 999 + 998; 等等

不难证明，在每条对角线上，x 和 y 越接近，积越高。所以我们可以从中间开始，`x = y`（或`x = y + 1`奇数对角线），仍然像以前一样做短路优化。而且因为我们可以从最高的对角线开始，也就是最短的对角线，我们很可能更快地找到最高的合格回文。

```
maxFactor = 999
minFactor = 100

def biggest():
    big_x, big_y, max_seen, prod = 0, 0, 0, 0

    for r in xrange(maxFactor, minFactor-1, -1):
        if r * r < max_seen: break

        # Iterate along diagonals ("ribs"):

        # Do rib x + y = r + r
        for i in xrange(0, maxFactor - r + 1):
            prod = (r + i) * (r - i)

            if prod < max_seen: break

            if is_palindrome(prod):
                big_x, big_y, max_seen = r+i, r-i, prod

        # Do rib x + y = r + r - 1
        for i in xrange(0, maxFactor - r + 1):
            prod = (r + i) * (r - i - 1)

            if prod < max_seen: break

            if is_palindrome(prod):
                big_x, big_y, max_seen = r+i,r-i-1, prod

    return big_x, big_y, max_seen

# biggest()
# (993, 913, 906609) 
```

## 几乎是 3 倍的改进

我们现在只调用了 2228 次，而不是调用 is_palindrome() 6124 次。并且总累积时间已经从大约 23 毫秒下降到大约 9 毫秒！

我仍然想知道是否有一种完全线性（O（n））的方式来生成按降序排列的两组数字的产品列表。但我对上述算法很满意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-03T20:39:36.900

This adds a couple of optimizations to @GreggLind's good solution, cutting the run time in half:

```
def is_palindrome(n):
    s = str(n)
    return s == s[::-1]

def biggest():
    big_x, big_y, max_seen = 0,0, 0
    for x in xrange(999,99,-1):
        # Optim. 1: Nothing in any row from here on can be bigger.
        if x*x < max_seen: break  

        for y in xrange(x, 99,-1):  # so we don't double count   
            # Optim. 2: break, not continue
            if x*y < max_seen: break  # since we're decreasing, 
                                # nothing else in the row can be bigger

            if is_palindrome(x*y):
                big_x, big_y, max_seen = x,y, x*y

    return big_x,big_y,max_seen

biggest()
# (993, 913, 906609) 
```

The line

```
if x*x < max_seen: break 
```

means that once we get to the point where x is less than sqrt of largest palindrome yet seen, not only do we not need to investigate any more factors on that row; we don't even need to investigate any more rows at all, since all remaining rows would start from a number less than the current value of x.

This doesn't reduce the number of times we call `is_palindrome()`, but it means many fewer iterations of the outer loop. The value of `x` that it breaks on is 952, so we've eliminated the checking of 853 rows (albeit the "smaller" ones, thanks to the other `break`).

I also noticed that

```
if x*y < max_seen: continue 
```

should be

```
if x*y < max_seen: break 
```

We are trying to short-circuit the whole row, not just the current iteration of the inner loop.

When I ran this script using [cProfile](http://docs.python.org/2/library/profile.html#module-cProfile), the cumulative time for `biggest()` was about 56 msec on average, before the optimizations. The optimizations shrank it to about 23 msec. Either optimization alone would deliver most of that improvement, but the first one is slightly more helpful than the second.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T00:04:09.650

问题指出：

```
What is the largest prime factor of the number 600851475143? 
```

我使用 C# 解决了这个问题，但算法本身与语言无关。

1.  创建一个方法来确定一个数是否为素数。这可以是蛮力（而不是使用更有效的筛选算法），看起来像这样：

* * *

```
private static long IsPrime(long input)
        {
            if ((input % 2) == 0)
            {
                return 2;
            }
            else if ((input == 1))
            {
                return 1;
            }
            else
            {
                long threshold = (Convert.ToInt64(Math.Sqrt(input)));
                long tryDivide = 3;
                while (tryDivide < threshold)
                {
                    if ((input % tryDivide) == 0)
                    {
                        Console.WriteLine("Found a factor: " + tryDivide);
                        return tryDivide;
                    }
                    tryDivide += 2;
                }
                Console.WriteLine("Found a factor: " + input);
                return -1;
            }
        } 
```

2.  一旦我有一个函数来确定素数，我就可以使用这个函数来找到最高的素数

* * *

```
private static long HighestPrimeFactor(long input)
{
    bool searching = true;
    long highestFactor = 0;
    while (searching)
    {
        long factor = IsPrime(input);
        if (factor != -1)
        {
            theFactors.Add(factor);
            input = input / factor; 
        }
        if (factor == -1)
        {
            theFactors.Add(input);
            highestFactor = theFactors.Max();
            searching = false;
        }
    }
    return highestFactor;
} 
```

我希望这会有所帮助，而不会放弃太多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-04T00:19:00.700

这是您可能会考虑的解决方案。它可能会更有效率，但只需要一点时间即可运行。

```
largest = 0
for a in range(100, 1000):
    for b in range(100, 1000):
        c = a * b
        if str(c) == ''.join(reversed(str(c))):
            largest = max(largest, c)
print(largest) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-24T22:27:31.250

这里的另一个建议很棒。此代码也有效。我从 999 开始，因为我们知道可能的最大组合是 999*999。不是python，而是一些快速完成的伪代码。

```
public static int problem4()
    {       
    int biggestSoFar=0;
        for(int i = 999; i>99;i--){
            for(int j=999; j>99;j--){
                if(isPaladrome(i*j))
                   if(i*j>biggestSoFar)
                        biggestSoFar=i*j;
            }
        }
        return biggestSoFar;    
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-09T21:24:48.090

这是一个有效的通用解决方案（比我见过的其他解决方案快约 5 倍）：

```
def pgen(factor):
    ''' Generates stream of palindromes smaller than factor**2 
        starting with largest possible palindrome '''
    pmax = str(factor**2)
    half_palindrome = int(pmax[0:len(pmax)/2]) - 1
    for x in xrange(half_palindrome, 0, -1):
        yield int(str(x) + str(x)[::-1])

def biggest(factor):
    ''' Returns largest palindrome and factors '''
    for palindrome in pgen(factor):
        for f1 in xrange(factor/11*11, factor/10, -11):
            f2 = palindrome/f1
            if f2 > factor:
                break
            if f2*f1 == palindrome:
                return palindrome, f1, f2

>>> biggest(99)
(9009, 99, 91)
>>> biggest(999)
(906609, 993, 913)
>>> biggest(9999)
(99000099, 9999, 9901)
>>> biggest(99999)
(9966006699L, 99979, 99681L)
>>> biggest(9999999)
(99956644665999L, 9998017, 9997647L)
>>> biggest(99999999)
(9999000000009999L, 99999999, 99990001L)
>>> biggest(999999999)
(999900665566009999L, 999920317, 999980347L) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-17T00:36:52.863

如果您的程序运行缓慢，并且您有这样的嵌套循环：

```
for z in range(100, 1000):
    for y in range(100, 1000):
        for x in range(1, 1000000): 
```

那么你应该问自己的一个问题是：“最内层循环的主体将执行多少次？” （最内层循环的主体是以： 开头的代码`x = str(x)`）

在这种情况下，很容易弄清楚。外部循环将执行 900 次。 *对于每次迭代*，中间循环也将执行 900 次——即 900×900 或 810,000 次。然后，对于这 810,000 次迭代中的每一次，内部循环本身将执行 999,999 次。我想我需要很长时间来计算：

```
>>> 900*900*999999
809999190000L 
```

换句话说，您进行了近*8100 亿*次回文检查。如果您想将其纳入 Project Euler 建议的每个问题 1 分钟的限制，您可能需要稍微优化一下 :-)（请参阅 David 的评论）

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-17T01:10:10.893

这就是我在 Java 中所做的：

```
public class Euler0004
{
    //assumes positive int
    static boolean palindrome(int p)
    {
        //if there's only one char, then it's
        //  automagically a palindrome
        if(p < 10)
            return true;

        char[] c = String.valueOf(p).toCharArray();

        //loop over the char array to check that
        //  the chars are an in a palindromic manner
        for(int i = 0; i < c.length / 2; i++)
            if(c[i] != c[c.length-1 - i])
                return false;

        return true;
    }

    public static void main(String args[]) throws Exception
    {
        int num;
        int max = 0;

        //testing all multiples of two 3 digit numbers.
        // we want the biggest palindrome, so we
        // iterate backwards
        for(int i = 999; i > 99; i--)
        {
            // start at j == i, so that we
            //  don't calc 999 * 998 as well as
            //  998 * 999...
            for(int j = i; j > 99; j--)
            {
                num = i*j;

                //if the number we calculate is smaller
                //  than the current max, then it can't
                //  be a solution, so we start again
                if(num < max)
                    break;

                //if the number is a palindrome, and it's
                //  bigger than our previous max, it
                //  could be the answer
                if(palindrome(num) && num > max)
                    max = num;
            }
        }

        //once we've gone over all of the numbers
        //  the number remaining is our answer
        System.out.println(max);

    }
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-06-18T18:03:15.523

这是我的解决方案：

```
polindroms = [(x, y, x * y) for x in range(100, 999) for y in range(100, 999) if str(x * y) == str(x * y)[::-1]]
print max(polindroms, key = lambda item : item[2]) 
```

# struct - Clojure 结构嵌套在另一个结构中

> ID：555013
> 
> 赞同：6
> 
> 时间：2009-02-16T23:23:33.240
> 
> 标签：struct, clojure, nested

是否可以在 Clojure 的结构中嵌套结构？考虑以下代码：

```
(defstruct rect :height :width)
(defstruct color-rect :color (struct rect))

(defn 
#^{:doc "Echoes the details of the rect passed to it"}
echo-rect
[r]
  (println (:color r))
  (println (:height r))
  (println (:width r)))

(def first-rect (struct rect 1 2))
;(def c-rect1 (struct color-rect 249 first-rect)) ;form 1
;output "249 nil nil"
(def c-rect1 (struct color-rect 249 1 2)) ;form 2
;output "Too many arguments to struct constructor

(echo-rect c-rect1) 
```

当然，这是一个人为的例子，但在某些情况下，我想将大型数据结构分解为更小的子结构，以使代码更易于维护。正如评论所表明的，如果我做表格 1，我会得到“249 nil nil”，但如果我做表格 2，我会得到“结构构造函数的参数太多”。

如果我以错误的方式处理这个问题，请告诉我我应该做什么。搜索 Clojure 谷歌组并没有为我找到任何东西。

* * *

编辑：

我想我在问题的陈述中并没有我想的那么清楚：

1.) 是否可以在 Clojure 中将一个结构嵌套在另一个结构中？（从下面判断是肯定的。）

2.) 如果是这样，正确的语法是什么？（再一次，从下面来看，似乎有几种方法可以做到这一点。）

3.) 当你有一个嵌套在另一个结构中的结构时，你如何通过指定的键获取一个值？

我想我的示例代码并没有真正证明我想要做得很好。我在此处添加此内容，以便其他搜索此内容的人可以更轻松地找到此问题及其答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T14:03:01.067

我同意其他海报中的 struct maps 并不真正支持继承。但是，如果您只想创建一个使用另一个键的新结构，这将起作用：

```
; Create the rect struct
(defstruct rect :height :width)

; Create the color-rect using all the keys from rect, with color added on
(def color-rect (apply create-struct (cons :color (keys (struct rect)))))

(defn create-color-rect 
  "A constructor function that takes a color and a rect, or a color height and width"
  ([c r] (apply struct (concat [color-rect c] (vals r))))
  ([c h w] (struct color-rect c h w))) 
```

您不需要该`echo-rect`函数，您可以简单地评估 struct map 实例以查看其中的内容：

```
user=> (def first-rect (struct rect 1 2))
#'user/first-rect
user=> first-rect
{:height 1, :width 2}
user=> (create-color-rect 249 first-rect)
{:color 249, :height 1, :width 2}
user=> (create-color-rect 249 1 2)
{:color 249, :height 1, :width 2} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T00:04:23.067

嵌套结构是可能的，有时也是可取的。但是，看起来您正在尝试做一些不同的事情：看起来您正在尝试使用结构类型的继承而不是组合。也就是说，在表格 2 中，您正在创建一个*包含*rect 的 color-rect，但您正在尝试构建一个实例，就好像它*是*一个 rect。表格 1 有效，因为您正在从预先存在的 rect 构造 c-rect1，这是使用组合的正确方法。

在 Clojure 组或一般的网络上进行快速搜索应该可以很好地描述组合和继承之间的区别。在 Clojure 中，组合或鸭子类型（再次参见 Google）几乎总是比继承更受欢迎。

* * *

编辑：

回答您的问题 #3：正如 Brian Carper 在他的回答中所描述的，使用 -> 提取嵌套结构中的数据的替代方法是 get-in，以及它的兄弟姐妹 assoc-in 和 update-in：

例如：

```
(def cr {:rect {:height 1, :width 2}, :color :blue})
(get-in cr [:rect :width])
;; => 2

(assoc-in cr [:rect :height] 7)
;; => {:rect {:height 7, :width 2}, :color :blue}

(update-in cr [:rect :width] * 2)
;; => {:rect {:height 1, :width 4}, :color :blue}

(assoc-in cr [:a :new :deeply :nested :field] 123)
;; => {:a {:new {:deeply {:nested {:field 123}}}}, 
;;     :rect {:height 1, :width 2}, :color :blue} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-18T19:59:20.780

如果你给它一个要关联的键，你可以使一个结构成为另一个结构的值。您可以按如下方式进行。

（您可以通过 轻松访问任意嵌套的哈希/结构`->`的内容，作为一些语法糖。）

```
(defstruct rect :height :width)
(defstruct color-rect :rect :color)

(def cr (struct color-rect (struct rect 1 2) :blue))
;; => {:rect {:height 1, :width 2}, :color :blue}

(:color cr)           ;; => :blue
(:width (:rect cr))   ;; => 2
(-> cr :color)        ;; => :blue
(-> cr :rect :width)  ;; => 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T00:01:59.840

我对clojure真的很陌生，所以我可能错了。但我认为，你不能做类似的事情

```
(defstruct color-rect :color (struct rect)) 
```

据我了解clojure-structs，这将创建一个结构（基本上是一个带有已知键的映射），它以某种方式将结构“rect”作为它的一个键。

我的假设得到了观察结果的支持，即对 (struct rect) 的简单评估会产生

```
{:height nil, :width nil} 
```

而 (struct color-rect) 的评估产生：

```
{:color nil, {:height nil, :width nil} nil} 
```

编辑：可以帮助你的是，结构不限于键，它们是用定义的。似乎您可以通过以下方式完成您正在尝试的事情：

```
(def c-rect1 (struct-map color-rect :color 249 :height 1 :width 1 )) ;form 3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-20T00:57:45.207

我现在意识到这是一个老问题，但我想出了以下宏：

```
(defmacro extendstruct [n b & k]
  `(def ~n
    (apply create-struct
      (clojure.set/union
        (keys (struct ~b))
        #{~@k})))) 
```

这将允许你这样写：

```
(defstruct rect :width :height)
(extendstruct color-rect rect :color) 
```

测试：

```
(struct rect)       ; {:width nil, :height nil}
(struct color-rect) ; {:color nil, :width nil, :height nil} 
```

这会是你想要的吗？

它也可以被修改，以便可以使用结构的集合。甚至允许您使用其他结构定义作为键的名称，这些名称会自动扩展为此类结构生成的键：

```
(defstructx one :a :b)
(defstructx two :c one :d)
(defstructx three :e two :f :g)
; three
(keys (struct three)) ; #{:e :c :a :b :d :f :g} 
```

# asp.net - 从 ASP.Net 和 C# 后面的代码调用 JQuery 函数

> ID：555016
> 
> 赞同：12
> 
> 时间：2009-02-16T23:24:05.830
> 
> 标签：asp.net, jquery, ajax, updatepanel

我需要以编程方式禁用 JQuery 选项卡。选项卡位于更新面板 (Ajax) 中，而更新面板位于 ASP.NET 页面中。代码：

```
<link type="text/css" rel="stylesheet" href="http://ui.jquery.com/testing/themes/base/ui.all.css" />

<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>

<script type="text/javascript" src="http://ui.jquery.com/testing/ui/ui.core.js"></script>

<script type="text/javascript" src="http://ui.jquery.com/testing/ui/ui.tabs.js"></script>

<script type="text/javascript">

    $(document).ready(function(){
        $("#example").tabs();
    });

    function hidetabs(){
        $(document).ready(function(){
        $("#example").tabs();
        $('#example').data('disabled.tabs', [1, 2]);});
    }
</script>

<%@ Page Language="C#" MasterPageFile="~/any.Master" AutoEventWireup="true" Codebehind="anycode.aspx.cs"
    Inherits="anycode" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">

<asp:UpdatePanel ID="UpdatePanel_Deal_Import" runat="server">
<ContentTemplate>
<div id="example">
<ul>
<li><a href="#fragment-1"><span>One</span></a></li>
<li><a href="#fragment-2"><span>Two</span></a></li>
<li><a href="#fragment-3"><span>Three</span></a></li>
</ul>
<div id="fragment-1">
<p>
First tab is active by default:</p>
<pre><code>$('#example').tabs();</code></pre>

<asp:Button ID="btn_Save" OnClick="btn_Save_Click" runat="server" Text="Save" Visible="False" CommandName="Save">
</div>

<div id="fragment-2">
Lorem ipsum dolor sit amet, consectetuer 
ut laoreet dolore magna aliquam erat volutpat.
</div>
<div id="fragment-3">
Lorem ipsum dolor sit amet, consectetuer 
aliquam erat volutpat.
</div>
</div>

      </ContentTemplate>
</asp:UpdatePanel>
</asp:Content>

Code behind:

protected void btn_Save_Click(object sender, EventArgs e)
{
//here I need to diable the panels.

} 
```

btn_Save_Click 函数不会发布页面，因此它不会调用 Javascript/jquery hidetabs 函数。谢谢你的帮助！！！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-07-28T13:29:20.420

我使用了以下方式，对我来说 100% 正常工作：

首先我创建一个函数并将我的 jquery 函数写入我的页面中的函数：

```
<script>
    function myFunction(params) {
        $.my_jquery(params...)
        ......
    }
</script> 
```

然后我在我的控件的事件处理程序中使用了这段代码（例如单击一个按钮），我的控件位于更新面板中：

```
protected void myButton(object sender, EventArgs e)
{
    .....
    ScriptManager.RegisterStartupScript(this.Page, this.GetType(), "tmp", "<script type='text/javascript'>myFunction(params...);</script>", false);
} 
```

成功的

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T23:32:32.533

听起来您需要一个具有**客户端**操作而不是回发的按钮。

```
<asp:Button ID="Clickable" runat="server" text="Click me" OnClientClick="JavascriptCall();" /> 
```

此外，虽然 jQuery 通常是向后兼容的，但直接引用 jQuery 最新的 .js 文件并不是一个好主意。相反，我会下载您想要的版本，并将其静态放置在您的站点上，以便直接参考已知版本。在不需要时添加对外部站点上资源的状态或可用性的依赖是不好的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T05:41:07.910

谢谢克里斯，

实际上是的，部分解决方案是直接调用 javascript 函数，但不是使用客户端控件，而是在我的 UpdatePanel 请求结束后调用 Javascript，如下面的博客中所述：

[http://blog.jeromeparadis.com/archive/2007/03/01/1501.aspx](http://blog.jeromeparadis.com/archive/2007/03/01/1501.aspx)

现在我的代码看起来像：

```
<link type="text/css" rel="stylesheet" href="css/ui.all.css" />

    <script type="text/javascript" src="jquery-latest.js"></script>

    <script type="text/javascript" src="ui.core.js"></script>

    <script type="text/javascript" src="ui.tabs.js"></script>

    <script type="text/javascript">

    //enable tabs if a deal is selcted or saved.
    function EndRequestHandler(sender, args) {
        var rec_id = document.getElementById('<%=hidden_value.UniqueID %>').value;

        if (rec_id=="")
            hidetabs();
        else
            showtabs();
    }

    hidetabs();

    $(document).ready(function(){
        $("#rec_entry").tabs();
    });

    function hidetabs(){
        $(document).ready(function(){
        $("#rec_entry").tabs();
        $('#rec_entry').data('disabled.tabs', [1, 2, 3, 4, 5]);});
    }

    function showtabs(){
        $(document).ready(function(){
        $("#rec_entry").tabs();
        $('#rec_entry').data('disabled.tabs', []);});
    }

    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);

    </script>

    ...html code add the tabs... 
```

后面的代码：

受保护的无效btn_Save_Click（对象发送者，EventArgs e）{

```
 .... code to save the new record ........  

        UpdatePanel_mypanel.Update();
    } 
```

面板更新后，EndRequestHandler 评估一个标志（在本例中为隐藏字段）并调用启用或禁用选项卡的 Javascript 函数。

由于我的 javascript 中包含这句话，endrequesthandler 得到了控制：

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler); 
```

我听从了您的建议，将 javascript 文件包含到我的项目中。再次感谢！

伊斯特兰

# c# - Silverlight InitParams，其中 value 有逗号

> ID：555022
> 
> 赞同：4
> 
> 时间：2009-02-16T23:25:24.593
> 
> 标签：c#, asp.net, silverlight-2.0

在 Silverlight 2 中，使用 ASP.NET 上的 C#，您可以通过为 Silverlight 对象的 InitiParams 分配一个字符串来传递一组初始化参数，该字符串是一系列逗号分隔的键/值对。

我见过其他系统具有类似的机制，可以将键/值对集合作为单个字符串传递。

指定包含逗号的值的解决方案是什么？

例如这个字符串没有问题：

```
string s1 = "key1=value1,key2=value2"; 
```

但这一个可以：

```
string s2 = "key1=value1,key2=two,values"; 
```

即“两个，值”需要以某种方式转义逗号......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T23:46:08.460

不幸的是，在快速谷歌搜索之后，我不认为 InitParams 的解析机制遵循任何类型的编码方案。如果它是一个 URL Query String 片段实际上会更好，它具有相当标准的编码和规则并且是逗号友好的。

所以我认为您唯一的选择是使用不同的分隔符，例如管道符号 |。

例如：

```
key1=value1,key2=two|values 
```

如果出于某种原因必须在值中使用逗号，则始终可以执行 String.Replace ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T07:34:05.670

我遇到了同样的问题，并为我的 InitParams 使用了 URL 编码。我使用 web.config 文件中的 silverlightInitParams 部分一次加载多个参数并生成 initParams 字符串，如下所示：

```
var initParams = new StringBuilder();
var initParamsFromConfig = (NameValueCollection)ConfigurationManager.GetSection("silverlightInitParams");
foreach (string key in initParamsFromConfig)
{
    initParams.AppendFormat("{0}={1},", key, Server.UrlEncode(initParamsFromConfig[key]));
} 
```

在 Application_Startup 中的 Silverlight 客户端中，我提取参数并将它们存储在字典中：

```
foreach (var initParam in e.InitParams)
{
    InitParameters.Add(initParam.Key, HttpUtility.UrlDecode(initParam.Value));
} 
```

# wpf - 如何在 WPF 中动态添加详细信息行？

> ID：555025
> 
> 赞同：3
> 
> 时间：2009-02-16T23:29:42.353
> 
> 标签：wpf, xaml

我能想到的唯一示例是 html - 例如，如果您在其中动态添加一个带有 colspan + div 的 TR，其中包含单击前一个 TR 的详细信息（可编辑）

我正在尝试了解 XAML，并想看看是否有人可以通过这个古怪的请求为我指明正确的方向。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T05:24:19.350

这是一些东西，不确定它是否是您正在寻找的东西：

XAML：

```
<Grid Name="_mainGrid">
    <Grid.ColumnDefinitions>
        <!-- Contains the button -->
        <ColumnDefinition Width="Auto"/>
        <!-- Contains the edit control -->
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <!-- So that we have the 'empty' space at the end -->
        <RowDefinition Height="*"/> 
    </Grid.RowDefinitions>
</Grid> 
```

代码：

```
 public Window1()
    {
        InitializeComponent();
        CreateRow(); // Bootstrap
    }

    private void CreateRow()
    {
        RowDefinition newRow = new RowDefinition();
        newRow.Height = new GridLength(0, GridUnitType.Auto);
        _mainGrid.RowDefinitions.Insert(_mainGrid.RowDefinitions.Count - 1, newRow);

        int rowIndex = _mainGrid.RowDefinitions.Count - 2;

        UIElement editControl = CreateEditControl();
        Grid.SetRow(editControl, rowIndex);
        Grid.SetColumn(editControl, 1);
        Grid.SetRowSpan(editControl, 1);
        Grid.SetColumnSpan(editControl, 1); // Change this if you want.
        _mainGrid.Children.Add(editControl);

        Button addButton = new Button();
        addButton.Content = "Add";
        addButton.Click += new RoutedEventHandler(b_Click);
        Grid.SetRow(addButton, rowIndex);
        Grid.SetColumn(addButton, 0);
        _mainGrid.Children.Add(addButton);
        addButton.Tag = editControl;

    }

    void b_Click(object sender, RoutedEventArgs e)
    {
        CreateRow();
        Control button = (Control)sender;
        UIElement editControl = (UIElement)button.Tag;
        _mainGrid.Children.Remove(button);
        Grid.SetColumn(editControl, 0);
        Grid.SetColumnSpan(editControl, 2);
    }

    private UIElement CreateEditControl()
    {
        return new TextBox();
    } 
```

# javascript - Javascript命名空间，语法错误在哪里？

> ID：555031
> 
> 赞同：1
> 
> 时间：2009-02-16T23:33:42.810
> 
> 标签：javascript, namespaces

我正在使用我前段时间编写的现有 JS 库，并尝试在一个公共命名空间下组织它......这是我尝试使用的技术的一个示例：

```
var NameSpace = new function ()
{
    var privateMember = [];

    function privateMethod() {};

    return 
    {       
        PublicMethod1 : function(arg, arg2)
        {
            // etc
        },
        PublicMethod2 : function ()
        {
            // etc
        },
        PublicMethod3 : function(arg, arg2)
        {
            // etc
        }
    };  

}(); 
```

据我所知，这应该可以完美地工作，但是我在这一行得到一个语法错误：

```
PublicMethod1 : function(arg, arg2) 
```

任何人都可以看到这种技术有一些明显的问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T23:44:45.420

```
var NameSpace= function ()
{
    var privateMember = new Array();

    function privateMethod() { };

    return {           
        PublicMethod1 : function(arg, arg2)
        {
                // etc
        },
        PublicMethod2 : function ()
        {
                // etc
        },
        PublicMethod3 : function(arg, arg2)
        {
                // etc
        }
    };  

}(); 
```

问题真的很棘手， return 和 { 显然应该在同一行。new [] 也无效，我也为您解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T00:54:49.963

只是关于数组分配的快速说明。

这有效： `var privateMember = new Array();`

这也有效： `var privateMember = [];`

当然，这不会： `var privateMember = new [];`

从原始闭包创建一个单例（更正返回位置）是完全可以接受的，并且不需要像第二条评论中那样是对象的实例化

# php - PHP headers 强制下载然后重定向

> ID：555035
> 
> 赞同：2
> 
> 时间：2009-02-16T23:35:01.717
> 
> 标签：php, redirect, download

现在我有一个强制下载 zip 的 PHP 表单。

如何重定向到另一个页面并强制下载？

我会使用 JavaScript 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T23:43:45.407

您不能在同一页面上同时执行这两种操作：强制下载文件（使用 Content-disposition 标头）并重定向用户。

您可以做的一件事是在单击链接时使用 JavaScript 打开一个新的下载时间窗口，然后在几秒钟后将用户重定向到另一个页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T23:36:04.240

您可以在下载重定向中执行以下操作：

```
Header("Location: downloadscript.php?filename"); 
```

祝你好运！

# c++ - 在运行时提升异常

> ID：555038
> 
> 赞同：2
> 
> 时间：2009-02-16T23:35:40.653
> 
> 标签：c++, boost, runtime-error

使用此代码：

```
#include <fstream>

#include <boost/archive/text_oarchive.hpp>

using namespace std;

int main()
{
    std::ofstream ofs("c:\test");
    boost::archive::text_oarchive oa(ofs);
} 
```

在执行 boost 存档行时，我在运行时遇到未处理的异常：

```
boost::exception_detail::clone_impl<boost::exception_detail::error_info_injector<boost::archive::archive_exception> > 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T05:47:24.270

以下行有错误：

```
 std::ofstream ofs("c:\test"); 
```

如果您的文件被调用，编译器会（至少）发出警告`jest`；但是`'\t'`- 作为插入选项卡的转义，您的错误未被发现。简而言之，文件不会被创建。您可以使用以下方法进行测试：

```
if (ofs.good()) { ... } 
```

现在，由于未创建文件，因此您没有有效的迭代器可以传递给`boost::archive::text_oarchive`它会引发异常。

试试这个：

```
std::ofstream ofs("c:\\test");
//                  --^ (note the extra backslash)
if (ofs.good()) {
    boost::archive::text_oarchive oa(ofs);
    // ...
} 
```

希望这可以帮助！

**PS：**我无法阻止自己制作的最后一点——如果你打算使用

```
using namespace std; 
```

然后

```
ofstream ofs("c:\\test"); 
```

已经足够好了。当然，qualify 不是错误`ofstream`，但它不是最好的编码风格。但是，你知道使用`using namespace`是不好的，不是吗？

**PPS**：谢谢你——`sharptooth`提​​醒我`\t`给你一个标签！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T23:54:04.853

您需要捕获异常，然后检查其 exception_code 以查看根本原因是什么。

# iphone - iPhone/iPod Touch 应用程序的通配符应用程序 ID

> ID：555043
> 
> 赞同：12
> 
> 时间：2009-02-16T23:37:07.983
> 
> 标签：iphone

我正在编写我的第三个应用程序，并且我已经在 App Store 中有一个应用程序，但我仍然没有得到这个 App ID 业务。

我为我的前两个应用程序创建了 App ID，如下所示：

```
XXXXXXXXXX.me.cbg.FirstApp
YYYYYYYYYY.me.cbg.SecondApp
```

但后来 Apple 引入了 App ID 向导，我用它来为我的第三个应用程序创建 App ID 和配置文件：

```
ZZZZZZZZZZ.*
```

所以我的问题是：为三个完全独立的应用程序创建应用程序 ID 的“正确”方式是什么？

我应该使用`XXXXXXXXXX.*`格式还是`XXXXXXXXXX.me.cbg.*`？

我应该创建三个不同的 App ID，还是只创建一个通配符 ID？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-16T23:58:16.293

两者都是“正确的”，这主要是在易于管理和允许更精细的证书管理之间进行权衡的问题。

有两个技术区别：

1.  从顶层保存的具有相同 ID 的应用程序（例如 com.mycompany.aaa 和 com.mycompany.bbb）能够访问彼此保存的数据。如果您正在编写一套应用程序，那么这可能非常有用。

2.  您只能创建有限数量的“AdHoc”证书。如果您的应用程序具有相同的通配符标识符，则此限制将应用于您的所有应用程序。

对于小型开发人员，我个人建议使用通配符 ID。它导致在多个领域的管理要少得多，因此消除了很多错误的可能性。请记住，对于每个 ID，您可能会拥有三个单独的证书（dev/adhoc/appstore）。

背景：

每个 iPhone 应用程序都必须有一个唯一的标识符和证书。开发人员可以使用完整名称（例如 com.mycompany.aaa）为每个应用程序创建证书，或者他们可以创建通配符证书/ID（例如 com.mycompany.*），在这种情况下，应用程序名称在 .plist 文件中用于在 DRM 过程中完成标识符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-26T11:56:44.917

嘿，我刚来这里，但是（恕我直言）我有点惊讶，这个回答不清楚。

据我了解，如果您不想在应用程序中使用应用内购买或推送通知服务，您可以使用通配符应用程序 ID 自由提交应用程序。如果您希望使用其中之一，Apple 提到您应该具体说明您的应用程序 ID。

但是，另外还有另一个要求，引用自 Provisioning 门户：

> 如果您正在创建一套应用程序将共享相同的钥匙串访问（例如，在应用程序之间共享密码）或有一组没有钥匙串访问要求的应用程序，请为所有应用程序创建一个应用程序 ID，使用尾随星号作为通配符-卡字符。

登录开发者门户时请参考此页面： [iPhone Provisioning Portal - App ID How To](http://developer.apple.com/iphone/manage/bundles/howto.action)

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T00:00:21.797

在苹果网站上创建您的应用 ID 时，在第二个框中使用如下内容：

```
me.cbg.* 
```

现在在您的应用程序 Info.plist 中使用捆绑标识符，如下所示：

```
me.cbg.${PRODUCT_NAME:identifier}
// or
me.cbg.SomeAppName 
```

您可以放心地忽略 XXXXXXXXXX 预置您的应用程序 ID。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T14:17:38.607

1.  使用通配符 App ID 进行开发，因为所有应用程序只需要 1 个 ID。
2.  如果您的应用程序需要应用内购买和 Apple 推送通知服务，请在生产环境中使用显式应用 ID。

我个人总是会在生产中使用显式应用程序 ID，因为您永远不知道将来何时需要应用内购买或推送通知。苹果声称虽然可以从通配符升级到显式应用程序 ID，但是......

该链接很有用：http: [//developer.apple.com/library/ios/#qa/qa1713/_index.html](http://developer.apple.com/library/ios/#qa/qa1713/_index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-21T00:27:33.680

要理解的关键是何时必须使用显式应用程序 ID。来自[iOS 团队管理员指南](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/DevPortalGuide/CreatingandConfiguringAppIDs/CreatingandConfiguringAppIDs.html "iOS 团队管理员指南")：

> 如果您想使用**APNS、应用内购买、iCloud**和**游戏中心**功能，请使用明确的应用 ID。

如果您对无法访问这些功能感到满意，则可以使用通配符 App ID。

# .net - NHibernate HQL 相当于 T-SQL 的 TOP 关键字

> ID：555045
> 
> 赞同：23
> 
> 时间：2009-02-16T23:37:33.520
> 
> 标签：.net, nhibernate, orm, hql

NHibernate HQL 相当于 T-SQL 的 TOP 关键字是什么？

还有什么是非 HQL 方式来说给我一个班级的前 15 个？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-16T23:45:28.727

在 HQL 中其实很简单：

```
var top15 = session.CreateQuery("from SomeEntity")
                .SetFirstResult(0)
                .SetMaxResults(15)
                .List<SomeEntity>(); 
```

虽然不知道如何使用标准 API 来做到这一点。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-16T23:48:43.430

标准 API 方法：

```
ICriteria criteria = DaoSession.CreateCriteria(typeof(T));
criteria.SetFirstResult(StartIndex);
criteria.SetMaxResults(MaximumObjects);
return criteria.List<T>(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-09T12:29:11.743

从 NHibernate 3.2 开始，您可以`SKIP n / TAKE n`在查询结束时在 hql 中使用。它在您不能使用的子查询中非常有用`SetMaxResults`。

例如：

```
select l, (select u from User u where u.Location = l order by u.Date asc take 1) 
from Location l 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:53:09.513

为了完整起见，这里是使用`QueryOver`NHibernate 3.0 中引入的 API 的方法：

```
var top15 = session.QueryOver<SomeEntity>().Take(15).List(); 
```

如果`.Skip(someInt)`您需要定义起始索引，例如用于分页，请输入 a。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-06-14T15:17:28.563

mookid8000 提供虚假信息。

没有办法用 HQL 设置 SQL TOP N :(

它总是将所有表格下载到 .NET 并获得 TOP，这简直是愚蠢的！

# linq - 如何使用 LINQ 执行此使用列重命名（或列别名）的 SELECT 语句？

> ID：555047
> 
> 赞同：4
> 
> 时间：2009-02-16T23:38:07.277
> 
> 标签：linq

如何在 LINQ 中获取“anotherColumnName”？

```
SELECT thisColumnName as anotherColumnName FROM TableName 
```

我有以下显然给我'thisColumnName'而不是'anotherColumnName'

```
 var query = from names in _context.TableName
                select names;
    return query.ToList(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T23:39:35.590

使用匿名类型：

```
var query = (from name in _context.Table
            select new { anotherColumnName = name.ColumnName }); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T00:28:15.783

@Ian P - 感谢您的回答。

对于完成的解决方案，我还需要一些额外的内容，如下所示......

旧版。

```
public List<OldClassName> GetSomething()
{
    var query = from names in _context.OldClassNames
                select names;

    return query.ToList();
} 
```

具有列重命名的新版本。

```
public List<NewClassName> GetSomething()
{
    var query = from names in _context.OldClassNames
                select new NewClassName
                {
                    NewColumName = names.OldColumnName
                };
    return query.ToList();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T08:37:23.487

如果您使用变量来存储列名，则可以考虑使用动态 LINQ。 [动态 LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# entity-framework - 好的实体框架示例应用程序？

> ID：555062
> 
> 赞同：7
> 
> 时间：2009-02-16T23:44:37.963
> 
> 标签：entity-framework

我正在寻找一些使用实体框架的优秀 asp.net 示例应用程序。我看到了几个用于 NorthWind 的应用程序（一个是基于 MVC 的）。寻找一个比 MSDN 上的简单应用程序更复杂的应用程序（HRSkillsCombined、CourseManager、AdWksSalesWinDataBind、ResearchCollaborationAssistant）。可能使用实体继承、多表更改跟踪等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T13:47:55.160

这是一项正在进行的工作，但微软的 Danny Simmons 已经开始[了一系列关于使用实体框架实现 MUD 的帖子](http://blogs.msdn.com/dsimmons/archive/tags/D3/default.aspx)。他不仅在讨论如何使用实体框架本身（他是最有资格这样做的人之一），而且还在讨论如何在应用程序架构的上下文中使用它。

这是一[本关于实体框架的免费书籍，其中包含一个完整的示例项目](http://weblogs.asp.net/zeeshanhirani/archive/2008/12/18/my-christmas-present-to-the-entity-framework-community.aspx)。

# entity-framework - 在实体框架中使用 EntityDataSource 与 ObjectDataSource 的优缺点？

> ID：555066
> 
> 赞同：5
> 
> 时间：2009-02-16T23:45:51.347
> 
> 标签：entity-framework

在基于 Entity Framework asp.net 的应用程序中使用 EntityDataSource 与 ObjectDataSource 的优缺点是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T00:16:10.183

基本上[EntityDataSource](http://msdn.microsoft.com/en-us/library/cc488502.aspx "实体数据源")是为了支持 Entity Framework 实体的排序、过滤、插入、删除等功能而构建的……如果您使用[ObjectDataSource](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx "对象数据源")，您将不得不自己执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-24T22:56:49.200

我刚刚发现的 EDS 控件的一个巨大缺点是它们想要立即更新数据库，并且每个这样的控件都有自己的 EF 对象上下文、自己的数据库连接，甚至在我编写了一个处理程序来共享上下文之后，共享一个数据库连接并关闭所有立即插入，更新和删除，以便我可以做最后`SaveChanges()`最后，当用户点击最后的“提交”按钮时，EDS 控件以这样一种方式使用 EF，它仍然会获取已删除的记录。并且不获取插入的记录。因此，我将在我使用 EDS 控件的位置转换为使用 ODS 控件，从而允许我在我的 radgird 视图和 EF 之间插入另一个对象模型，以便让网格显示插入的记录而不显示已删除的记录并且能够允许用户延迟提交回数据库。据我所知，没有其他方法可以让 Web 网格使用 EDS 控件并延迟此最终提交以及显示插入的记录或不显示已删除的记录。我很想在这些事实上被证明是错误的。e

# c# - 在单个操作上启用多个 HTTP 方法？

> ID：555073
> 
> 赞同：10
> 
> 时间：2009-02-16T23:49:32.820
> 
> 标签：c#, .net, wcf, web-services

我有一个操作合同（如下），我想允许 GET 和 POST 请求。如何告诉 WCF 接受单个 OperationContract 的两种类型的请求？

```
[OperationContract,
WebInvoke(Method="POST",
    BodyStyle = WebMessageBodyStyle.Bare,
    RequestFormat = WebMessageFormat.Xml,
    ResponseFormat = WebMessageFormat.Xml,
    UriTemplate = "query")]
XElement Query(string qry);

[OperationContract,
WebInvoke(Method="GET",
    BodyStyle = WebMessageBodyStyle.Bare,
    RequestFormat = WebMessageFormat.Xml,
    ResponseFormat = WebMessageFormat.Xml,
    UriTemplate = "query?query={qry}")]
XElement Query(string qry); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-09T15:18:18.513

如果有人在寻找不同的解决方案，

```
[OperationContract]
[WebInvoke(Method="*")]
public <> DoWork()
{
     var method = WebOperationContext.Current.IncomingRequest.Method;
     if (method == "POST") return DoPost();
     else if (method == "GET") return DoGet();
     throw new ArgumentException("Method is not supported.");
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T00:02:47.937

[Carlos Figueira 在 MSDN 论坛](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/ad5bb2f0-058c-47ae-bcf3-8f5c4727a70e/)上的这篇文章有一个解决方案。我现在会这样做，但如果其他人有任何更清洁的解决方案，请告诉我。

```
[OperationContract,
WebInvoke(Method="POST",
    BodyStyle = WebMessageBodyStyle.Bare,
    RequestFormat = WebMessageFormat.Xml,
    ResponseFormat = WebMessageFormat.Xml,
    UriTemplate = "query")]
XElement Query_Post(string qry);

[OperationContract,
WebInvoke(Method="GET",
    BodyStyle = WebMessageBodyStyle.Bare,
    RequestFormat = WebMessageFormat.Xml,
    ResponseFormat = WebMessageFormat.Xml,
    UriTemplate = "query?query={qry}")]
XElement Query_Get(string qry); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T03:20:26.260

您可能想看看 WebGetAttribute，我自己没有尝试过，但您可以将它与 WebInvokeAttribute 一起应用于相同的方法。

[MSDN](http://jeffbarnes.net/portal/blogs/jeff_barnes/archive/2007/09/11/wcf-3-5-webget-attribute.aspx)和[Jeff Barnes](http://jeffbarnes.net/portal/blogs/jeff_barnes/archive/2007/09/11/wcf-3-5-webget-attribute.aspx)上的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T06:01:06.077

对于上述问题，在 Query_Get API 的情况下将 WebInvoke 更改为 WebGet 即可解决问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-17T11:14:28.103

GET 和 POST 意味着不同的操作。

这不会让客户感到困惑，并且从 REST 的角度来看是错误的吗？

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-02-16T23:53:29.347

不使用 WebInvoke 就可以了。

不过，这可能不是您正在寻找的答案。

# security - 用于存储秘密的便携式数据库

> ID：555076
> 
> 赞同：4
> 
> 时间：2009-02-16T23:52:06.153
> 
> 标签：security, sqlite, firebird, portable-database

*我正在开发一个需要在数据库中存储秘密的应用程序。*

我需要一个便携式数据库（如 Firebird、Sqlite 等），其中数据将被加密或密码保护或两者兼而有之......

*让我们以我想创建一个密码管理器**为例。***我需要将该密码存储在数据库中。我习惯使用 Embed Firebird，但不用于秘密数据。

另一种解决方案是在我没有连接到文件时自然使用数据库并加密数据库文件，但我不确定安全性或性能影响。

您推荐的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T02:54:08.337

您还可以查看 SQL Server Compact 版本，它只需要一个 DLL 并将数据存储在单个文件中，就像 SQLite 或 Access、Firebird 等一样。

它还内置了加密功能。

一些参考资料：

*   [SQL Server Compact 的安全性和加密](http://blogs.msdn.com/stevelasker/archive/2008/05/14/security-and-encryption-for-sql-server-compact.aspx)
*   [使用 SQL Server Compact Edition 的教程](http://arcanecode.wordpress.com/arcane-lessons/)（页面下方的第二和第三部分）。

**密码加密**

请参阅我对您的[其他问题 os SO](https://stackoverflow.com/questions/555222/how-to-not-hardcode-passwords/555388#555388)的回答。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T00:00:54.993

有一个名为[sqlite-crypt](http://sqlite-crypt.com/documentation.htm)的项目。这应该是你最好的选择。sqlite db，磁盘上的所有数据都已加密。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T23:55:55.770

诚实地？使用[TrueCrypt](http://www.truecrypt.org/)或[KeePass](http://keepass.info/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T00:01:13.463

我同意 CJM 的观点，但如果您对编写自己的代码一无所知，您应该在写入时加密流并在读取时对其进行解密。任何已发布的稍微强大的算法都应该保证事情的安全。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T00:36:58.183

REALbasic 对加密 SQLite 数据库的内置支持在我的几个项目中运行良好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-29T14:26:09.530

我强烈建议您查看[SQLCipher](http://www.zetetic.net/software/sqlcipher)（完全公开，我是开发人员之一！）它是 SQLite 透明、页面级加密的免费和开源实现。该实现相当健壮，正在积极开发中，并且非常易于使用（相对而言）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-27T03:02:51.317

我赞同使用 KeePass 的建议。它是存储敏感数据的好地方，并且提供了一个非常好的 API。以下是如何读取标准 Keypass 2 数据库的示例：

```
var dbpath = @"C:\path\to\passwords.kdbx";
var masterpw = "Your$uper$tr0ngMst3rP@ssw0rd";

var ioConnInfo = new IOConnectionInfo { Path = dbpath };
var compKey = new CompositeKey();
compKey.AddUserKey(new KcpPassword(masterpw));

var db = new KeePassLib.PwDatabase();
db.Open(ioConnInfo, compKey, null);

var kpdata = from entry in db.RootGroup.GetEntries(true)
                select new
                {
                    Group = entry.ParentGroup.Name,
                    Title = entry.Strings.ReadSafe("Title"),
                    Username = entry.Strings.ReadSafe("UserName"),
                    Password = entry.Strings.ReadSafe("Password"),
                    URL = entry.Strings.ReadSafe("URL"),
                    Notes = entry.Strings.ReadSafe("Notes")

                };                                      
db.Close(); 
```

# debugging - 浮点代码更改上的 Visual C++ 数据断点

> ID：555084
> 
> 赞同：1
> 
> 时间：2009-02-16T23:57:42.097
> 
> 标签：debugging, visual-studio-2005, floating-point

是否有可能在浮点代码（ST0-ST7）更改时在 VS 2005（C++）中设置断点（如我所见的数据断点）？例如，在 ST7==INF 条件下更改值 ST7。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T00:10:05.687

我刚刚在 VC++ 2008 Express 中尝试过，您可以设置一个条件断点来测试任何浮点堆栈值，例如 ST0 == 1.0，作为条件。

我认为这不是你所追求的，但是我猜你想找到使 ST7 == INF 的代码行，为此你需要在每一行上放置这样的断点，条件为 ST7 = = INF，然后更容易找出进行更改的位置。

希望这也适用于 VS 2005...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T09:21:37.910

你不能，但你可以靠近。

您可以创建一个数据断点，然后右键单击它并添加一个条件 - 以查明，例如，对 42.0f 的更改。

可悲的是，数据断点本质上仅限于检测内存中的变化——它们依赖于处理器中的特殊调试寄存器，即访问指定内存地址的标志。

我假设您确实将计算存储到内存中的某个变量中。你可以在它上面创建一个数据断点，一旦你找到编写代码的位置 - 单步执行它之前的反汇编。

# java - 与 jar 文件相比，诊断和改进 java jnlp 的性能

> ID：555100
> 
> 赞同：0
> 
> 时间：2009-02-17T00:04:38.307
> 
> 标签：java, performance, memory, jar, java-web-start

客户 X 要求改进他使用的 Java 进程的启动时间。问题是，它不是通过 jar 文件运行，而是通过“jnlp”（我假设它是一个 java webstart 应用程序）

```
StartUserWorx.jnlp 
```

有没有办法将其转换为 JAR 文件，然后让用户在本地调用应用程序，并在 JRE 中包含一个启动标志来为进程分配更多内存？

用户有点沮丧，因为同一办公室的其他工作人员在几乎相同的机器上使用相同的应用程序，但他的过程似乎总是需要更长的时间来加载（几分钟而不是几秒钟）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T02:07:13.753

检查慢速机器上的代理设置。该用户可能没有正确的代理设置，并且可能会发生大量额外的网络流量/超时？

我们之前在 webstart 上遇到过这个问题，从本地服务器下载 jar 是通过代理往返于另一个海岸并返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T05:44:19.473

如果您使用记事本之类的工具查看 .jnlp 文件的内容，您将看到它用于运行的所有信息。

查找 main-class（在 application-desc 节点上）。这是包含 main 方法的 java 类。有关更多信息，您应该参考[http://java.sun.com/javase/technologies/desktop/javawebstart/index.jsp](http://java.sun.com/javase/technologies/desktop/javawebstart/index.jsp)了解 jnlp 的规范。

从这里您可以创建一个带有适当类路径的批处理文件来运行应用程序。但是，您破坏了使用 jnlp 方法的任何优点。所以你需要记住这一点。

jnlp 文件中还有一个“资源”部分，它将向您显示它需要的 jar 文件和其他 webstart jnlp。

不过，您应该在实际应用程序之外进行一些检查。如果这些是相似的机器，那么很可能有些不同。需要碎片整理？网络？也许 java-vm 本身加载时间太长。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T19:43:15.897

检查用户的网络设置。根据我的经验，一分钟的延迟通常是由 DNS 配置错误、路由表错误（当没有收到肯定响应时 DNS 必须超时）或简单的 lmhosts 文件不正确造成的。

# math - 在任意非矩形物体上寻路

> ID：555104
> 
> 赞同：2
> 
> 时间：2009-02-17T00:06:38.177
> 
> 标签：math, geometry, artificial-intelligence, path-finding

我有各种表面为 3D 且非矩形的对象，例如球体、金字塔以及由网格表示的各种其他对象。网格不是由相同大小和分布在对象表面上的多边形组成，它们也不是像圆柱体、球体和圆锥体的理想形状那样都是半/对称的对象。

因此，我将如何设计或改进一种寻路算法，该算法采用任意网格并生成可以以多种方式环绕自身的节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T16:20:56.850

一个（可能是最简单的）选项是使用基于网格的搜索技术——有一些非常简单的方法可以生成多分辨率网格分解，将单元标记为“自由”或“碰撞”并使用类似 A* 的方法搜索生成的网格（正如[Theran](https://stackoverflow.com/questions/555104/pathfinding-on-arbitrary-non-rectangular-bodies/555240#555240)提到的）。

通常，您可能需要使用更强大的运动规划技术，例如[概率路线图](http://www.kavrakilab.org/robotics/prm.html)(PRM) 或[快速探索随机树](http://msl.cs.uiuc.edu/rrt/)(RRT)。在这些领域有相当多的学术工作。

作为介绍，您可能想查看一份像[这样](http://msl.cs.uiuc.edu/~lavalle/papers/LinLav03b.pdf)的调查报告(PDF)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T01:25:04.557

A* 搜索在此应用程序中应该可以正常工作。它需要一个不会高估两点之间距离的函数，但直线距离永远不会高估沿曲面的距离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T01:40:18.297

我意识到您可能没有在这里告诉我们更大的图景，而是试图将您的问题归结为 3d 场景 => 有向图 => ??? => 寻路，但您是否考虑过从不同的方向来解决这个问题？

有没有办法预先组成你的有向图？大多数游戏（我假设这是一款游戏）在构建搜索路径时不会考虑场景中每个对象的完整几何形状。也许还有另一种方式？

无论如何，您可能会发现[此链接](http://www.gameai.com/pathfinding.html)对您的研究很有用。

# c++ - 使用“this”作为参数复制构造函数

> ID：555108
> 
> 赞同：9
> 
> 时间：2009-02-17T00:08:35.397
> 
> 标签：c++

我有一个 c++ 类，假设它被称为 c，我想在其中一种方法中使用隐式复制构造函数，如下所示：

```
c c::do_something() {
  c copy = this; //I want implicit copy constructor here!
  copy.something_else(); 
  //........//
  return copy;
} 
```

但是，gcc 返回此错误：

> 错误：从 'c* const' 到 'long unsigned int' 的无效转换

（我有另一个来自 long unsigned int 的构造函数）

...好像复制构造函数不存在。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-17T00:10:11.523

*这*是一个指向对象的指针，所以它应该是

```
c copy = *this; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-17T01:05:28.690

顺便说一句，但它真的不适合评论，而且似乎存在一些分歧。试试这段代码，了解何时调用复制构造函数和赋值运算符：

```
class A
{
public:
    A() { cout << "A::A()\n"; }
    A(const A &) { cout << "A::A(const A &)\n"; }
    void operator =(const A &) { cout << "A::operator=(const A &)\n"; }
};

int main()
{
    A a; // default constructor
    A copy = a; // copy constructor (and no assignment operator)
    A copy2(a); // copy constructor (and no assignment operator)
    a = copy; // assignment operator
    A function(); // declares a function return A
    A b = A(); // default constructor (but no assignment operator)
    A b2 = A(a); // copy constructor (but no assignment operator)
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T00:23:17.030

哇哇！另外，不要混淆复制构造函数和复制赋值运算符。

```
c copy (*this); 
```

是复制构造函数；

```
c copy = *this; 
```

是复制赋值运算符。两者都可以，尽管复制构造函数在技术上更有效，尽管复制赋值运算符通常经过优化以执行相同的操作。

* * *

哇 - 我发现自己纠正了。在声明变量的同一语句中使用 = 运算符确实会调用复制构造函数。你每天学习新的东西！

# javascript - JavaScript 库性能比较 - 有什么资源吗？

> ID：555114
> 
> 赞同：1
> 
> 时间：2009-02-17T00:10:17.357
> 
> 标签：javascript, jquery, asp.net-ajax, comparison

我正在向我的公司介绍我采用 jQuery 作为首选 JavaScript/AJAX 库的原因。

虽然大部分工作已经完成，但不同库之间的比较会很有用——尤其是针​​对 Microsoft ASP.Net Ajax 框架。

现在请注意，我不是在讨论哪个框架更好的神学辩论。我们以前使用过微软的东西，并且正在系统地切换到 jQuery。我想通过一些关于性能、足迹（即库大小 - 缩小和“原始”）等方面的良好量化措施来支持该计划。

有谁知道可以提供这些措施的任何资源？请记住 - 我在进行包含 Microsoft 的比较。[维基百科比较图表](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)等资源尚未包含此内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T00:15:06.690

我不太确定将 ASP.NET AJAX 与 jQuery 进行比较是否是天方夜谭。ASP.NET AJAX 服务于客户端功能的一个非常特定的子集，特别是向 WebForms 控件模型添加异步功能，其**具体**目的是尽可能抽象掉标记和客户端脚本。另一方面，jQuery 专门用于手工制作 JS 功能。

我想说的是，Microsoft/ASP.NET 团队建议几乎所有事情都使用 jQuery，而 ASP.NET 4.0 未来/路线图比以往任何时候都更依赖 jQuery 的事实表明 MS 自己认为 jQuery 是更好的——大约。众所周知，jQuery 对于大多数事情来说都非常快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T00:19:14.230

随着最新 jQuery 的发布，他们提供了与许多其他 JavaScript 库的比较：[jQuery 1.3 release](http://docs.jquery.com/Release:jQuery_1.3)。它非常广泛，涵盖了图书馆的多个方面，而不仅仅是整体比较。

# winforms - WinForms 应用程序的 FormView 等效项？

> ID：555115
> 
> 赞同：1
> 
> 时间：2009-02-17T00:10:59.850
> 
> 标签：winforms, data-binding

我正在尝试开发一个小型实用程序（WinForms 应用程序），我希望（以节省时间）使用 WinForms 等效于 ASP.net FormView 或 DetailsView（绑定到） - 即用于单个对象（而不是多个对象，我们可以使用 DataGridView）。

自从我在 WinForms 世界中做任何有意义的事情以来已经过去了大约三年（而且我无法在 WPF 中这样做） - 任何人都可以建议一个支持数据绑定并以类似于 ASP 的方式工作的控件或容器.net 的 FormView 实现？

基本思想是绑定到普通旧 CLR 对象 (POCO) 或 DTO（数据传输对象）。但是，我开始觉得这是一种收益递减的练习……或者我可能需要第三方控制……基础设施？

/R

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T00:54:04.070

WinForms 使用了另一种范式。它使用 BindingSource，这与您使用什么控件无关。例如，它可以是简单的 UserControl 甚至是 Panel。

以下是将您的类绑定到表单的步骤。

1.  将 BindingSource 拖放到您的表单或面板或其他任何东西上......
2.  在 DataSource 属性中单击添加项目数据源。

3.  选择对象，选择要绑定的对象。

4.  单击完成。在这个阶段，我们已经配置了数据源。下一步将生成类似于 FormView 的内容。

5.  打开数据源停靠窗口。

6.  使用下拉菜单选择详细信息。

7.  将其拖放到您的表单中。

结果应该是类似于FormView的形式。

如果您有任何问题，请告诉我。

# c# - 建议一种自动更新我的 C# 程序的方法

> ID：555118
> 
> 赞同：17
> 
> 时间：2009-02-17T00:13:31.780
> 
> 标签：c#, auto-update

我需要更新我编写的程序，这将在接下来的一年左右经常发生，这需要通过 Internet 完成。你会建议我从哪里开始，有什么常用的技术吗？欢迎任何建议。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-05-04T10:26:47.580

还好还不够好:)

NAppUpdate 是我写的一个开源库来解决这个问题。总体思路是以尽可能低的开销获得最大的灵活性。

因此，集成非常简单，该库几乎可以为您完成所有工作，包括同步操作。它还非常灵活，可以让您确定要执行的任务以及在什么条件下执行 - 您可以设置规则。最后一点是对任何更新源（网络、BitTorrent 等）和任何提要格式的支持——任何未实现的内容您都可以自己编写。

还支持冷更新（需要重新启动应用程序），并且会自动完成，除非为任务指定“热交换”。

这一切都归结为一个小于 70kb 的 DLL。

更多详情请访问[http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/](http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/)

代码位于[http://github.com/synhershko/NAppUpdate](http://github.com/synhershko/NAppUpdate)（在 Apache 2.0 许可下获得许可）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-17T00:16:22.520

[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d.aspx)非常适合这种情况。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-05-22T05:54:07.433

有一个很棒的框架叫做[NetSparkle](http://netsparkle.codeplex.com/) 还有这个 [DotNetUpdater](http://windowsclient.net/articles/appupdater.aspx)

我还没有使用它们，但希望很快就能使用。你可以试试看。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T00:35:44.940

ClickOnce 是一个很好的解决方案，但如果您希望拥有完全的控制权，那么您可以自己动手。我建议轮询网络服务以查找是否有更高版本可用，将所需文件下载到并排目录，并使用启动器（或更新快捷方式）自动启动最新版本。

这有点复杂，但适合应用程序可能正在运行的情况，因此不能被覆盖。

# c# - 面向 C# 开发人员的 Java

> ID：555129
> 
> 赞同：47
> 
> 时间：2009-02-17T00:18:02.080
> 
> 标签：c#, java, jakarta-ee

对于希望在企业级 Java 团队中起步的 C# 开发人员来说，最快的资源集是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-17T02:07:51.833

语言本身应该易于理解。没有那么多的语言结构，一切可能都在库中完成。

图书馆需要一些时间来适应。您可以做的最关键的两件事是：

1：使用 NetBeans 或 Eclipse 并一直按 ctrl-space。这就像上帝的钥匙。

2：将此页面添加为书签：[https](http://java.sun.com/j2se/1.5.0/docs/api/) ://docs.oracle.com/javase/8/docs/ （或适合您的java版本的那个——但版本并不重要）图形中的每个框代表一个库包，单击一个您想要概览的包。尝试了解每个包的作用。浏览感兴趣的包并扫描类。此页面还链接到很多教程。

之后，只需了解您需要哪些其他库来完成您的工作。如果您的团队使用 J2EE，那么 J2EE 有很多内容，您可能最终会使用 Hibernate，并且您应该研究消息传递和 RMI（您可能不直接使用它，但几乎所有内部​​ Java 通信都基于 RMI ）。

记住 ctrl 空格。它将为您提供参数、与您迄今为止键入的内容相匹配的函数列表、填写导入声明、扩展宏...

哦，还有另外两个 Eclipse 技巧：ctrl-shift-T。“查找类型”（在 Eclipse 中，NetBeans 中有一个，但我不记得键序列，可能是 ctrl-shift-O）。不管怎样，你输入一个部分类名，它会给你一个项目中所有匹配类的列表。单击一个以将其打开。

按住 ctrl 单击。跳转到您单击的任何内容的声明/定义。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-17T00:31:05.403

我会推荐以下书籍：

*   [Java Enterprise 简而言之，O'Reilly](https://rads.stackoverflow.com/amzn/click/com/0596101422)
*   [有效的企业 Java](https://rads.stackoverflow.com/amzn/click/com/0321130006)
*   [Java 企业最佳实践，O'Reilly](https://rads.stackoverflow.com/amzn/click/com/0596003846)

Java 确实是一条不同的鱼 - 开发企业应用程序比 C# 要做的要多得多。您需要担心各种不同的事情——EJB、企业与“个人”运行时等等。

我能给您的最佳建议是使用 NetBeans IDE。它又大又慢又笨重，但它确实在大多数情况下为您提供指导。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-17T00:20:33.447

为抽象做好准备。很多很多的抽象；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-21T13:08:34.600

阅读包`java.lang`、`java.io`和的 API 文档`java.util`。严重地。在 java 中，业余爱好者的标志是当 java.util.Collections 中有一个方法已经完成了他们想要的操作时，有人编写了一个循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-19T15:59:30.490

[在http://www.kynosarges.org/JavaCSharp.html](http://www.kynosarges.org/JavaCSharp.html)上有一个易于理解、结构化和全面的总结。

它还提到了缺少 C#/CLR/BCL 功能的已知解决方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T00:34:41.837

很好读：

*   [http://www.ikvm.net/](http://www.ikvm.net/)
*   [http://blogs.msdn.com/alfredth/archive/2009/01/28/java-to-c-orange-book.aspx](http://blogs.msdn.com/alfredth/archive/2009/01/28/java-to-c-orange-book.aspx)
*   [http://www.infoq.com/news/2008/12/Ja-NET](http://www.infoq.com/news/2008/12/Ja-NET)
*   [http://www.janetdev.org/](http://www.janetdev.org/)
*   [http://www.janetdev.org/Projects/JaNETSE/Overview/tabid/88/Default.aspx](http://www.janetdev.org/Projects/JaNETSE/Overview/tabid/88/Default.aspx)

爱它还是恨它！:-)

# apache - 基于 Apache 名称的虚拟主机

> ID：555139
> 
> 赞同：1
> 
> 时间：2009-02-17T00:22:28.077
> 
> 标签：apache

上次我尝试在我的开发机器上设置基于名称的虚拟主机时，我刚刚放弃并将网站映射到不同的端口。这一次，我正在努力做对:)！

我已经正确注册了 DNS 条目并向服务器发送了两个不同的标头：

```
Host: dev.site1.com
Host: dev.site2.com 
```

但是，Apache 让我很难将*dev.site2.com*映射到*dev.site1.com*

这是我精简的配置：

```
Listen 80
ServerName localhost:80
NameVirtualHost *:80

<VirtualHost *>
    ServerName dev.site1.com
    DocumentRoot /www/site1
</VirtualHost>

<VirtualHost *>
    ServerName dev.site2.com
    DocumentRoot /www/site2
</VirtualHost> 
```

我尝试过诸如（无效）之类的组合：

```
ServerName site1.com
ServerName site2.com

ServerName site1.com
ServerAlias *.site1.com site1
ServerName site2.com site2
ServerAlias *.site2.com site2 
```

我很高兴运行 Apache 2.2，并希望有一些以前解决过相同问题的人可以帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T00:27:56.767

我注意到以下几点：

1.  您的 ServerName 是 localhost:81 - 这不应该是 localhost:80 吗？
2.  两个 VirtualHosts 的 DocumentRoot 是相同的 - /www/site1 - 所以即使它工作也会提供相同的页面

尝试为第二个虚拟主机创建一个单独的 DocumentRoot。

作为一个帮助，这是我的（工作，修剪，URL重命名）httpd.conf：

```
NameVirtualHost *

<VirtualHost *>
        DocumentRoot    /var/www/site1
        ServerName      my.website.co.nz
        ServerAlias     www.my.website.co.nz
</VirtualHost>

<VirtualHost *>
        DocumentRoot    /var/www/joker
        ServerName      another.site.co.nz
        ServerAlias     www.another.site.co.nz
</VirtualHost> 
```

狩猎愉快！

编辑：MrTopf 有一个很好的观点。NameVirtualHost 必须与 VirtualHost 指令完全匹配。请注意我如何只为其中的每一个添加一个星号，而您有一个 *:80 的 NameVirtualHost 和带有 *.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T00:51:16.820

我通常还会在 VirtualHost 指令中指定端口，但不确定这是否是问题所在：

```
<VirtualHost *:80>
    ServerName dev.site2.com
    DocumentRoot /www/site2
</VirtualHost> 
```

（我什至指定 IP 地址通常是为了确保它真的在收听正确的 IP 地址，以防服务器在某个时候获得额外的 IP 地址）。

事实上，我只是在[文档](http://httpd.apache.org/docs/2.2/en/mod/core.html#namevirtualhost)中注意到这一行：

> 请注意，该指令的参数必须与 NameVirtualHost 指令的参数完全匹配。

So the problem can be that you specify your NameVirtualHost with a port but the VirtualHost directive without one which eventually does not make them match.

# python - 多个输出文件

> ID：555146
> 
> 赞同：0
> 
> 时间：2009-02-17T00:29:18.030
> 
> 标签：python, file-io

编辑：最初我试图笼统，但结果含糊不清。我在下面提供了更多详细信息。

我正在编写一个脚本，它从两个大型 CSV 文件中提取数据，一个是人们的日程安排，另一个是有关他们日程安排的信息。对数据进行挖掘和组合，最终为周一至周六的人们连接创建 pajek 格式图，第七张图表示一周内的所有连接，用 1 和 0 的字符串表示一周中的哪几天建立了连接。最后一张图与 pajek 格式不同，由另一位研究人员编写的单独程序使用。

Pajek 格式有一个大标题，然后将连接列为 (vertex1 vertex2) 无序对。很难将这些对存储在字典中，因为两对之间通常在同一天有多个连接。

我想知道输出到这些图表的最佳方式是什么。我应该制作大型单图并让第二个脚本将其解构为几个较小的图吗？我应该保持七个流打开并在我确定连接写入它们时，还是应该为每个流保留一些其他数据结构并在可以时输出它们（如队列）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T00:34:36.270

我会打开七个文件流，因为如果数据很多，累积它们可能会占用大量内存。当然，如果您可以对它们进行实时排序并且不需要首先读取所有数据来进行排序，那这只是一种选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T02:56:04.150

**“...从两个大型 CSV 文件中提取数据，一个是人们的日程安排，另一个是有关他们日程安排的信息。”** 模糊，但我想我明白了。

**“数据被挖掘和组合，最终为周一至周六的人们联系创建 pajek 格式图表，”挖掘和** 组合。凉爽的。在哪里？在这个脚本中？在另一个应用程序中？通过一些第 3 方模块？通过一些网络服务？

这是一次一行的算法吗？一行输入是否会产生一个连接，该连接会发送到一个或多个每日图表？

这是一个必须先查看整个时间表才能产生任何东西的算法吗？[如果是这样，它可能是错误的，但我真的不知道，你的问题在这个中心细节上非常模糊。]

**“...第七张图表示一周内的所有连接，带有 1 和 0 的字符串，表示一周中的哪几天建立了连接。”** 不完整，但可能已经足够好了。

```
def makeKey2( row2 ):
    return ( row2[1], row2[2] ) # Whatever the lookup key is for source2

def makeKey1( row1 ):
    return ( row1[3], row1[0] ) # Whatever the lookup key is for source1

dayFile = [ open("day%d.pajek","w") for i in range(6) ]
combined = open("combined.dat","w")
source1 = open( schedules, "r" )
rdr1= csv.reader( source1 )
source2 = open( aboutSchedules, "r" )
rdr2= csv.reader( source2 )

# "Combine" usually means a relational join between source 1 and source 2.
# We'll assume that source2 is a small-ish dimension and the
# source1 is largish facts

aboutDim = dict( (makeKey2(row),row) for row in rdr2 )

for row in rdr1:
    connection, dayList = mine_and_combine( row, aboutDim[ makeKey1(row) ] )
    for d in dayList:
        dayFile[d].write( connection )
    flags = [ 1 if d is in dayList else 0 for d in range(6) ]
    combined.write( connection, flags ) 
```

类似的东西。

要点是：

1.  遍历每个数据源。没有嵌套循环。 **O** ( *n* ) 处理。

2.  尽可能少地保留内存以创建有用的结果。

# pdf - 在 LaTeX 文档中嵌入多页文档

> ID：555154
> 
> 赞同：1
> 
> 时间：2009-02-17T00:32:31.623
> 
> 标签：pdf, image, latex

我正在写我的论文，需要复制我在学习中使用的不同的小册子（2-7 页）。

理想情况下，我希望小册子的每一页在我的论文中显示为一页，但包含在某个框架内并使用我的论文的页码等。我有 Word 格式的小册子，但宁愿将它们嵌入为 PDF，以便它们看起来就像他们对我的科目所做的那样。

我可以通过将每个 PDF 拆分为多个文件并将它们分别包含在我的 LaTeX 中来手动执行此操作。

但是，是否有一些包或宏可以在没有所有这些工作的情况下实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T00:35:18.950

看看[pdfpages](http://www.google.co.uk/search?q=pdfpages) - 我以前用过它，据我所知，它具有你所说的所有功能。

# outlook - Outlook AppointmentItem - 如何以编程方式将 RTF 添加到其正文？

> ID：555156
> 
> 赞同：2
> 
> 时间：2009-02-17T00:33:04.667
> 
> 标签：outlook

我想将`Body`an设置`AppointmentItem`为包含嵌入图像的 RTF 字符串。设置`Microsoft.Office.Interop.Outlook.AppointmentItem.Body`会导致 RTF 按原样出现在约会中。

我尝试使用[Redemption](http://www.dimastr.com/redemption/)来包装约会并公开`RTFBody`属性，但 RTF 格式（包括图像）丢失了。

在此示例（没有嵌入图像）中，RTF 按原样显示在文档中。有没有人设法做到这一点？

```
var appointment = (AppointmentItem)app.CreateItem(OlItemType.olAppointmentItem);
appointment.Subject = "test subject";
appointment.Start = DateTime.Now;
appointment.End = DateTime.Now.AddHours(1);
appointment.Body = @"{\rtf1\ansi\deff0{\fonttbl{\f0 Arial;}}{\colortbl ;\red0\green0\blue255;}\pard\cf1\f0\fs24 Test}";
appointment.Save(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-02T11:36:04.227

我知道的唯一方法是访问 AppointmentItem 的 GetInspector 属性，并使用它来获取用于解析 RTF 格式的基础 WordEditor，例如：

```
var doc = appointment.GetInspector.WordEditor as Microsoft.Office.Interop.Word.Document; 
```

然后根据[Word Object Model](http://msdn.microsoft.com/en-us/library/kw65a0we%28v=vs.80%29.aspx)使用 doc.Content 格式化文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-30T01:22:26.067

我在这方面看到的最好的信息是按照这个答案： [http ://social.msdn.microsoft.com/Forums/en-US/vsto/thread/b41acf6f-71c1-4a8b-9662-fbff26ba3a24/](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/b41acf6f-71c1-4a8b-9662-fbff26ba3a24/)

基本上，这是一个笨拙的两步过程：

1.  获取对 WordEditor 对象的引用
2.  使用剪贴板，将格式化的内容复制并粘贴到编辑器中

说真的微软，你当然可以想出更好的设计。

# objective-c - 在 Objective-C 中保留/释放方法参数是个好主意吗？

> ID：555165
> 
> 赞同：5
> 
> 时间：2009-02-17T00:36:42.347
> 
> 标签：objective-c

考虑以下 ObjC 代码示例：

```
- (void)doStuffWithString:(NSString *)someParam {
    // Do stuff with someParam
}
```

如果此代码在多线程应用程序中执行，保留/释放是个好主意`someParam`吗？具体来说，我正在考虑传入参数是许多线程共享的单例对象的场景。例如，以下是否更安全？

```
- (void)doStuffWithString:(NSString *)someParam {
    [stringParam retain];
    // Do stuff with someParam
    [stringParam release];
}
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T00:48:03.850

不，尝试为参数提供线程安全不是单个函数的工作。

在堆栈的某处，某处向下传递了作为“doStuffWithString”参数的对象。这是应该保证该对象在函数调用期间保持有效的代码。

需要考虑的两件事；

1.  在您调用第三方或库函数的情况下，这些函数不会为您执行保留/释放。
2.  如果存在删除参数的危险，这可能发生在您调用“保留”之前！

[该线程](https://stackoverflow.com/questions/554270/iphone-use-of-mutexes-with-asynchronous-url-requests)也可能会有所帮助。

# sql - 如何使用 MSSQL 2000 读取/写入文件？

> ID：555169
> 
> 赞同：1
> 
> 时间：2009-02-17T00:38:18.227
> 
> 标签：sql, sql-server

在 MySQL 中，您可以非常简单地读取文件`SELECT load_file('foo.txt')`并使用`SELECT 'text' INTO DUMPFILE 'foo.txt'`.

我正在寻找一种在 MSSQL 2000 中执行此操作的方法，而无需使用任何外部工具，只需使用查询或存储过程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T02:02:06.107

对于输入，您可以使用文本文件 ODBC 驱动程序：

```
select * from OpenRowset('MSDASQL',
'Driver={Microsoft Text Driver (*.txt;
*.csv)};DefaultDir=c:\;','select * from [FileName.csv]') 
```

假设输出文件已经存在，您可以使用 Jet 对其进行写入：

```
INSERT INTO
OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
'Text;Database=C:\;HDR=Yes;', 'SELECT
* FROM filename.csv')   SELECT 1234,5678 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T01:09:23.407

有几种方法可以做到这一点。

使用 xp_cmdshell：

```
declare @writetofile varchar(1000)
select @writetofile = 'osql -U -P -S -Q"select * from yourtable" -o"c:\foo.txt"'

exec master..xp_cmdshell @writetofile 
```

或者您可以从命令行使用 bcp 来读取/写入文件，这通常更快地执行批量插入/选择

或者，您也可以使用 sp_OACreate，但您可能不想走这条路，因为这不完全是数据库的本意。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:15:20.200

您还可以使用 BULK INSERT 来读取文件。

# php - 如何正确导出到带有逗号的表记录值的 CSV 文件？

> ID：555171
> 
> 赞同：0
> 
> 时间：2009-02-17T00:39:36.897
> 
> 标签：php, mysql, csv

我有一个将值导出到 CSV 文件的函数，但是“注释”字段中有逗号，当您在电子表格程序中打开它时，它会弄乱列。

有没有办法正确导出它？

```
//this exports only names and comments into a CSV file
function exportNamesCommentsCSV($table, $columns) {
    $file = "volunteer_comments";
    $csv_output = '';
    $table = 'volunteers_2009';
    $result = mysql_query("select * FROM ".$table."");
    $i = 0;
    if (mysql_num_rows($result) > 0) {
        while ($row = mysql_fetch_assoc($result)) {
            $csv_output .= $row['Field'].", ";
            $i++;
        }
    }
    $csv_output .= "\n";

    $values = mysql_query("SELECT lname, fname, email, comments FROM ".$table."");

    while ($rowr = mysql_fetch_row($values)) {
        for ($j=0;$j<$i;$j++) {
            $csv_output .= $rowr[$j].", ";
        }
        $csv_output .= "\n";
    }

    $filename = $file."_".date("Y-m-d_H-i",time());
    header("Content-type: application/vnd.ms-excel");
    header("Content-disposition: csv" . date("Y-m-d") . ".csv");
    header( "Content-disposition: filename=".$filename.".csv");
    print $csv_output;
    exit;
} 
```

编辑：这将是评论的一个例子......

我宁愿在门口工作，但我真的可以在任何地方工作。

上面示例注释中的 ,（逗号）会抛出正确的列结构。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-17T00:43:31.333

您需要做的是将值括在引号中，如下所示：

```
"value","value","value" 
```

这将正确处理值中的逗号，并且数值也仍然可以正常工作。

但是，要在值中加上引号，您需要将两个引号放在一起。例如表示这个字符串：

```
Bobby says, "Hi!" 
```

它需要表示为

```
"some value","Bobby says, ""Hi!""","Some other value" 
```

你可以这样做：

```
$csv_value = "\"" . eregi_replace("\"", "\"\"", $orig_value) . "\""; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T01:18:02.857

PHP 具有处理为您制作逗号分隔文件的功能。

查看[`fputcsv`](http://us2.php.net/manual/en/function.fputcsv.php)功能。它可以让你做这样的事情：

```
<?php
$list = array (
    array('this has, commas, in it','bbb','ccc','dddd'),
    array('123','456','789', 'this is "like this"'),
    array('1234','124','1242', 'yay, woo"!"')
);

$fp = fopen('file.csv', 'w');

foreach ($list as $record) {
    fputcsv($fp, $record);
}

fclose($fp);
?> 
```

该文件`file.csv`将包含以下内容：

```
"this has, commas, in it",bbb,ccc,dddd
123,456,789,"this is ""like this"""
1234,124,1242,"yay, woo""!""" 
```

稍后当您需要阅读它时，如果您曾经阅读过，您可以使用[`fgetcsv`](http://us2.php.net/manual/en/function.fgetcsv.php).

所以在你的情况下，你需要做的就是制作一个数组，每个数组都有名称和注释，然后把它通过`fputcsv`，你就很成功了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T00:42:41.583

您需要将条目包装在限定符中；通常引用。

```
"col1", "col2,,,", "col3" 
```

如果条目包含引号，则需要加倍引号。

这是[维基百科](http://en.wikipedia.org/wiki/Comma-separated_values)的文章

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T00:46:26.037

实现您想要的一种方法是在您的“评论”字段上进行搜索和替换，假设您确定这是唯一可以包含嵌入逗号的字段。

您可能还需要检查您的备注字段是否不能包含 CR 或 LF，它们也会干扰您的 csv 文件导入。

# asp.net - 如何创建/使用 MembershipProvider？

> ID：555175
> 
> 赞同：4
> 
> 时间：2009-02-17T00:43:09.087
> 
> 标签：asp.net, sql-server, asp.net-mvc, sql-server-2005, membership-provider

如何创建 MembershipProvider 以在 ASP.NET/MVC 网站中使用？

它不会在您的数据库中生成它需要的表吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T01:07:24.707

ASP.NET/MVC 的默认模板已经在您的 web.config 中注册了 Membership。最后你只需要运行：

```
aspnet_regsql.exe -W 
```

此命令将启动向导，该向导将指导您完成数据库创建过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T00:56:52.347

基本上，您必须创建一个继承自.NET 框架中的抽象[MembershipProvider类的类。](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)然后你必须实现基类的所有抽象成员。ValidateUser、GetUser 和 Initialize 可能是要实现的最重要的成员，具体取决于您要支持多少接口。

默认成员资格提供程序不会自动在数据库中创建任何内容。您必须运行`aspnet_regsql.exe`以创建必要的数据库。

使用默认的 asp.net [SqlMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx "SqlMemberShipProvider")。您只需启用它并输入正确的连接字符串（请参阅 MSDN 上的示例配置）。然后，您必须创建一个登录页面，该页面使用配置的成员资格提供程序验证用户。最简单的方法是使用[登录控件](http://msdn.microsoft.com/en-us/library/ms178331.aspx "登录控制")。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T00:48:19.963

谷歌是你的朋友：

*   [如何：实现自定义成员资格用户](http://msdn.microsoft.com/en-us/library/ms366730.aspx)
*   [使用 DataSet 创建自定义成员资格提供程序和成员资格](http://www.shiningstar.net/ASPNet_Articles/CustomProvider/CustomProvider.aspx)

绝大多数取决于你想做什么。也许如果您详细说明为什么要创建自定义项，我们可以给出更好的答案。

# image - 如何以编程方式将许多图像组合成一张？

> ID：555177
> 
> 赞同：2
> 
> 时间：2009-02-17T00:43:48.290
> 
> 标签：image, panoramas

我正在寻找一种编写脚本的方法，该脚本将采用大约 400 个 png 图像并将它们合并/组合成一个。

我花了几天时间玩 Python 和 C++ 的图像处理库，但都失败了。

如果有人可以向我指出您知道具有此功能的特定语言或库，那将是很棒的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T00:46:26.380

[ImageMagick](http://www.imagemagick.org/script/index.php)库和工具都支持这一点。

示例[链接](http://www.imagemagick.org/script/montage.php)：

```
 montage -background #336699 -geometry +4+4 rose.jpg red-ball.png montage.jpg 
```

或者

```
convert image1.jpg image2.jpg +append output.jpg 
```

您还可以将重叠的照片混合在一起，如[本文](http://imagemagick.org/Usage/photos/#overlap)中所列。

# c# - 解码 PKCS#12 文件

> ID：555184
> 
> 赞同：4
> 
> 时间：2009-02-17T00:47:18.377
> 
> 标签：c#, pfx, pkcs#12

我正在寻找在 .NET 中解码 PKCS#12 文件的方法，我需要提取私钥和任何证书，以便我可以以编程方式访问以下内容。

*   模量
*   公共指数
*   私人指数
*   素数1
*   素数2
*   指数1
*   指数2
*   系数

我需要此信息，以便我可以成功使用 PKCS#11 创建私钥并在 USB 令牌上进行认证。

我找到了一个使用[OpenSSL](http://www.claushc.dk/ssl/)来输出这些数据的网站。当我发现[OpenSSL.NET](http://sourceforge.net/projects/openssl-net)时我非常兴奋，但是拆分 PKCS#12 文件的功能尚未实现。我想知道是否有人知道任何替代方案。

谢谢

罗汉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T03:19:37.230

干杯曼努埃尔，

我下载了 Bouncy Castle API，很快就找到了我需要的东西。源代码包含大量单元测试。

```
static void Main(string[] args)
{
    char[] password = new char[] {'p','a','s','s','w','o','r','d'};

    using(StreamReader reader = new StreamReader(@"Test.pfx"))
    {
        Pkcs12Store store = new Pkcs12Store(reader.BaseStream,password);
        foreach (string n in store.Aliases)
        {
            if(store.IsKeyEntry(n))
            {
                AsymmetricKeyEntry key = store.GetKey(n);

                if(key.Key.IsPrivate)
                {
                    RsaPrivateCrtKeyParameters parameters = key.Key as RsaPrivateCrtKeyParameters;
                    Console.WriteLine(parameters.PublicExponent);
                }                       
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T02:25:48.187

我在最近的一个项目中，在它的 Java 端口上，可扩展地使用了 bouncy castle API，它完美无瑕地创造了奇迹。

我敢打赌，他们的 C# 并没有太大的不同，而且它在目标方面做得非常好。

[http://www.bouncycastle.org/](http://www.bouncycastle.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T02:09:07.180

AFAIK，您必须使用 win32 加密库，请参阅此 MSDN 文章：http: [//msdn.microsoft.com/en-us/library/ms867088.aspx](http://msdn.microsoft.com/en-us/library/ms867088.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T02:22:39.003

您应该能够通过 pInvoke 直接使用 OpenSSL。也许你可以在 OpenSSL.NET 项目开始工作时回馈它。

win32 加密提供程序是一个不错的选择，但它在可以解析和生成的格式方面可能有点不灵活。

# javascript - Javascript信号量/测试和设置/锁定？

> ID：555191
> 
> 赞同：61
> 
> 时间：2009-02-17T00:51:21.923
> 
> 标签：javascript, concurrency, semaphore

Javascript 中是否存在诸如原子测试和设置、信号量或锁定之类的东西？

我有 javascript 通过自定义协议调用异步后台进程（后台进程实际上在一个单独的进程中运行，与浏览器无关）。我相信我正在陷入竞争状态；后台进程在我的测试和我的设置之间返回，在 javascript 方面搞砸了。我需要一个测试和设置操作来使它成为一个真正的信号量。

这是尝试检测后台进程并将它们排队的 javascript 代码：

```
Call = function () {

var isRunning = true,
    queue = [];

return  {
    // myPublicProperty: "something",

    call: function (method) {
            if (isRunning) {
                console.log("Busy, pushing " + method);
                queue.push(method);
            } else {
                isRunning = true;
                objccall(method);
            }
        },

        done: function() {
            isRunning = false;
            if (queue.length > 0) {
                Call.call(queue.shift());
            }
        }
    };
}(); 
```

call 是一个实现排队的单例；任何想要调用外部进程的人都会调用 Call.call("something") 。

有任何想法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-17T01:19:40.340

JavaScript 没有锁定语义，因为 JS 不是多线程语言。多个线程只能在完全不同的上下文中同时运行——例如。HTML5 Worker 线程，或者在 JavaScriptCore API 的上下文对象的多个实例中（我假设 SpiderMonkey 有类似的概念）。它们不能共享状态，所以本质上所有的执行都是原子的。

好的，因为您现在已经提供了一些代码，我假设您有类似的东西：

```
External Process:
<JSObject>.isRunning = true;
doSomething()
<JSObject>.done() 
```

或者一些这样的（使用适当的 API）。在这种情况下，如果 JS 在您的 js 对象的上下文中执行（这是 JavaScriptCore 会做的），我希望 JS 引擎会阻塞，否则您可能需要在 js 执行周围放置一个手动锁定。

你用什么引擎来做这一切？我问是因为根据您的描述，听起来您正在使用该语言提供的 C/C++ API 从非 JS 语言的辅助线程设置标志，并且大多数 JS 引擎假定通过 API 进行的任何状态操作将发生在单个线程上，通常是所有执行都发生在同一个线程上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T01:16:15.840

也许您可以实现一个基本的整数信号量，只需将变量添加到 DOM 中并锁定/解锁它并确保您的函数不断检查它，否则会使它们超时 =)

如果您正在使用诸如 Mootools 之类的框架，您可以尝试使用诸如 onComplete 等事件来处理应用程序的流程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-04T00:24:03.167

首先，虽然 JavaScript 确实是单线程的，但 JavaScript 应用程序并不需要任何序列化机制。

一个简单的示例是，提交按钮应在一定时间内淡出，在此期间，对服务器的 Ajax 请求正在工作。当异步 Ajax 请求成功完成时，应该会在按钮所在的位置显示一条消息。

虽然能够取消按钮的淡出并简单地将其样式设置为“显示：无”会很好，但只要 Ajax 请求完成，这在 jQuery 中是不可能的。此外，解决方案可以使用事件来同步两个同时进行的活动，但这对于一个简单的问题来说基本上是多余的。

一个低技术的解决方案是轮询一个锁，当淡出完成时它被解锁，但是“服务器完成”消息不会显示，直到 $.post 设置的成功回调执行。

```
var gl_lock;
var gl_selfID;

function poll_lock(message) {
     if (gl_lock === 0) {
          $('#output').text(message).fadeIn(200);
          window.clearInterval(gl_selfID);
     }
 } // end of poll_lock

 function worker() {

     // no one gets in or out
     gl_lock = 1;

     $.post(..., data,function() { 
           gl_selfID = window.setInterval(poll_lock, 40, data.message);
      }, "json");

     // end of fadeout unlock the semaphore
     $('#submit-button').fadeOut(400, function() { gl_lock = 0; });

  } // end of worker 
```

最后，我认为这是更详细的答案，与 perrohunter 先前在本次讨论中建议的思路一致。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-15T02:31:43.413

我不太确定问题到底在问什么，但请在此处查看我的信号量对象：[https](https://github.com/agamemnus/semaphore.js) ://github.com/agamemnus/semaphore.js 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-08T22:33:32.120

我有填充选择列表的 ajax 东西，我需要将其锁定，所以我做了这样的事情。我认为你可以通过使用延迟和管道或其他东西来更简单地完成它。

```
var semaphore=[];

function myFunc(arg){
   var dfd;
   $.when(semaphore[table]).done(
      function(){
            dfd=myFuncInner(arg);
      }
      );
return dfd;
}

function myFuncInner(table){
semaphore[arg] = new $.Deferred();
... 
somethingasynchronous({
    semaphore[arg].resolve();
});

return  semaphore[arg];
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-08T15:53:31.360

我使用该`async-mutex`包解决了[Expo SQLite 不阻止 iOS 中的 BEGIN TRANSACTION 的](https://stackoverflow.com/questions/68304305/is-expo-sqlite-begin-transaction-blocking-on-ios)问题。您创建互斥体并将关键部分包装在`runExclusive`方法中

```
 return this.mutex.runExclusive(async () => {
      try {
        await this.executeSqlAsync('begin immediate transaction');
        const tx = new AsyncSQLTransaction(this);
        const rs = await callback(tx);
        await this.executeSqlAsync('commit');
        return rs;
      } catch (error) {
        await this.executeSqlAsync('rollback');
        throw error;
      }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-30T05:48:44.707

我有同样的问题，这是我解决它的方法。它适用于两个并发进程。如果您有三个或更多进程，则两个进程可能同时启动。

```
var isRunning = false;
...
var id = setInterval(function(){ //loop until isRunning becomes false
            if (!isRunning){
                isRunning = true;
                //do something synchronous or use a promise
                isRunning = false;
                clearInterval(id); // stop the loop here
            }
        , 10); 
```

它比 while 循环更好，因为它解决了读取/设置的并发/异步问题`isRunning`。

# vb.net - 带有 case OR-ing 的 VB.NET 选择 case 语句逻辑是什么？

> ID：555197
> 
> 赞同：57
> 
> 时间：2009-02-17T00:57:12.313
> 
> 标签：vb.net, syntax, switch-statement

我在 case 表达式中使用了[Or](https://msdn.microsoft.com/en-us/library/06s37a7f.aspx)语句。

即使我在此范围内有一个值，它也没有找到匹配项。为什么不？

**示例代码**：

```
Select Case 2
    Case 0
        ' Some logic

    Case 1
        ' Some other logic

    Case 2 Or 3
        Console.WriteLine("hit")

 End Select 
```

有了上面的内容，我会假设`hit`会被打印出来，但事实并非如此。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-02-17T01:03:43.983

使用逗号运算符分隔 case 语句

```
Select Case 2
    Case 0,1,2,3
        Console.WriteLine("hit")
 End Select 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-17T01:14:18.140

正如*Jared*所说，您需要使用逗号运算符来分隔 case 语句。

你正在做的`Or`是一个按位或，导致它是“3”。有趣的是，“2 AND 3”可能适用于您的具体情况。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-02-17T01:08:53.113

JaredPar 是对的，但您也可以使用 To 构造

```
Select Case 2
    Case 0,1
    Case 2 To 3
        Console.WriteLine("Hit")
End Select 
```

这将是 0 或 1 什么都不做，2 或 3 打印 Hit...To 构造是一个范围...

[这是 MSDN](http://msdn.microsoft.com/en-us/library/cy37t14y.aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-17T01:01:54.690

**编辑：** 假设 VB.NET 不允许大小写 ORing，看来我错了。我在用 C# 和 IL 思考，看来我错了。

但是，正如有人指出的那样，您的代码不起作用的原因是因为案例 2 或 3 将 2 或 3 评估为按位或，因此评估为案例 3。

为了澄清：

```
 2 binary = 0000 0010
       3 binary = 0000 0011
  2 Or 3 binary = 0000 0011 (= 3) 
```

```
 Select Case 2
     Case 0            '--> no match

     Case 1            '--> no match

     Case 2 Or 3       '(equivalent to Case 3  --> no match)
   End Select 
```

但是，我觉得我应该指出，为了性能，不应该使用这样的构造。当编译器遇到 Select 语句（C# 中的 switch）时，它会尝试使用查找表和***switch*** MSIL 指令来编译它们，但在你有类似*情况 1、2、11、55*的情况下，编译器将无法转换到一个查找表，它必须使用一系列比较（这就像使用 If.. Else）。

关键是，为了真正利用 Select 语句，在设计案例时应该考虑到这一点。否则，唯一的好处是代码可读性。

设计良好的开关是 O(1) 操作，而设计不佳的开关（相当于一系列 If..Then..Else 语句）是 O(n) 操作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T00:59:45.147

这将允许您在 0 的情况下执行“something”，在 1 的情况下执行“something else”，在 2 或 3 的情况下执行“hit”或“hit else”。

```
Select Case 2
    Case 0
        Console.WriteLine("something")
    Case 1
        Console.WriteLine("something else")
    Case Is 2 To 3
        Console.WriteLine("hit")
    Else
        Console.WriteLine("hit else")
 End Select 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-21T18:41:02.723

## 大多数或所有这些答案都忽略了失败（或 Goto Case）的目的：

不必重用代码或只为同一`Select Case`/中的几个区域创建特殊功能`If Tree`，这样您就可以避免重用代码，比如这个 Javascript。

*这些样本非常做作。肯定有方法可以简化这种情况，但很多时候没有。*

```
let pay = 100, perks = '';
Switch (EmpObj.type) {
  Case 'Boss':
    pay = pay * 10;
    perks = '11 month vacation per year';
  Case 'Manager':
    pay = pay * 3; // This will make Boss pay * 30
  Case 'Employee':
    EmpObj.pay = pay;
    EmpObj.perks = perks;
    break;
  Case 'Intern':
    EmpObj.sendMessage("Go get some coffee.")
} 
```

在 VB.net 中，相同的代码将是

```
dim pay = 100, perks = "";
Switch (EmpObj.type) {
  Case "Boss":
    pay = pay * 30
    perks = "11 month vacation per year"
  Case "Manager":
    pay = pay * 3
  Case "Employee":
  Case 'Intern':
    pay = 0
    EmpObj.sendMessage("Go get some coffee.")
End Select

EmpObj.pay = pay;
EmpObj.perks = perks; 
```

在简单的情况下，case 比比较 if-branch 更容易读写，但 fall-through 是最好的部分。

## 至少在 Visual Basic 2017 中现在有一种方法可以使用。虽然它不是最漂亮的。

`GoTo Case "[label]"`仍然`Goto [Case-label]`无法正常工作。

标签（`Number2`此处）必须在`Case`. 那是最令人失望的部分。

```
dim Value = "1"
Select Case Value
    Case "0"
       ' do nothing, example
    Case "1"
        MsgBox("one")
        GoTo Number2
    Case "2"
Number2:
        MsgBox("two")
    Case "boolean"
        MsgBox("three")
        ' just to show it won't fall through
End Select 
```

# security - 如何不对密码进行硬编码？

> ID：555222
> 
> 赞同：9
> 
> 时间：2009-02-17T01:13:06.097
> 
> 标签：security, password-protection, password-storage

在我的最后一个问题“用于存储机密的便携式数据库”[中，到目前为止，最好的答案](https://stackoverflow.com/questions/555076/portable-database-for-storing-secrets/555090#555090)告诉使用 sqlite-crypt。

阅读 sqlite-crypt 文档，打开数据库的新参数是密码。当然，我不想硬编码密码，所以我在想什么是存储密码的最佳、简单和快速的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T01:24:16.913

一些选项。

1.  向用户询问密码（也就是他们记住一个密码以获取所有密码）（好主意）

2.  在应用程序的第一次启动时创建一个密钥，然后以您自己独特的方式对其进行哈希处理（坏主意）

3.  混合使用上述方法，也就是给用户一个或两个选项（记住我的密码复选框）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T01:17:55.493

您*必须*将其存储在用户中。

否则，您只是用其他一些安全机制代替您要询问的安全机制...

* * *

[大卫在评论 Infamy 的回答](https://stackoverflow.com/questions/555222/how-to-not-hardcode-passwords/555238#555238)中的观点很好。应该允许一些灵活性，以防用户在较低层处理保护......所以，去投票给 Infamy。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T01:53:37.687

硬编码在某些时候是不可避免的，除非密码只能交互使用。

在文件中有密码的情况下，您可以做的最好的事情是首先让访问它变得非常困难，然后限制如果有人找到它可以用它做什么。一条经验法则是，您不应该为存储在字符串中的密码提供比您必须在提示符下键入的密码更多的权限。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T02:53:18.807

在 Windows 上，您可以/应该使用[DPAPI](http://msdn.microsoft.com/en-us/library/ms995355.aspx)，即提供存储加密的[数据保护 API 。](http://en.wikipedia.org/wiki/Data_protection_API)
它只是针对这种类型的问题。

存储的加密基于：

*   用户帐户，因此只有登录用户才能访问数据。这使得数据可以使用完全相同的用户凭据传输到另一台 PC。
*   机器，使数据只能在该特定机器设置上访问，而不能传输到另一台 PC。

有一个[与 Karl Franklin 合作的 dnrTV 节目，](http://www.dnrtv.com/default.aspx?showNum=79)准确地展示了实现此功能和其他加密功能所需的内容。
该节目的源代码也可在页面上找到。

当然，还有很多关于这个主题的[其他文章。](http://www.codeproject.com/info/search.aspx?artkw=DPAPI&sbo=kw)

# c++ - 在提升正则表达式中使用 char* 上的字符串迭代器

> ID：555223
> 
> 赞同：1
> 
> 时间：2009-02-17T01:13:07.720
> 
> 标签：c++, regex, boost, char

我正在尝试搜索 char* 以查找匹配项并将每个匹配项存储为使用 boost 正则表达式的结构。我不知道如何在 char* 上使用 std::string 迭代器。所以我从 char* 创建了 std::string 并使用它们。但现在我想要原始 char* 中的指针，只能使用我创建的 std::string 找到。请参阅以下代码。评论应该可以消除您的疑虑。

```
typedef struct {
 void *pFind; // Pointer to begining of match   
 int lenFind; // Length of match
} IppRegExpFind;

bool regExSearch(int nStrLen /*Length of input string*/, 
             std::vector<IppRegExpFind>& vectResult /*vector of struct to store matches*/, 
             int &numMatches /* number of matches*/, 
             const char *sStrInput /*Input string to be searched*/,
             const char *sStrRegex /*Input regex string*/)
{
 bool bStatusOk = true;
 try{
     std::string regexStr(sStrRegex);
     std::string inputStr(sStrInput);
     static const boost::regex ex(regexStr);
     std::string::const_iterator start, end;
     start = inputStr.begin();
     end = inputStr.end();
     boost::match_results<std::string::const_iterator> what; 
     boost::match_flag_type flags = boost::match_default; 
     std::vector <std::string> matches;
     while(boost::regex_search(start, end, what, ex, flags))
        {
         matches.push_back(what.str());
         start = what[0].second;
        }
    //  convert boost:match_Results to a vector of IppRegExpFind
   }
   catch(...){
    bStatusOk = false;
    }
return bStatusOk;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T02:14:47.837

您可以通过

```
sStrInput+what.position(0) 
```

但是，我不确定为什么你需要 std::string 的所有技巧。根据文档，`boost::regex_search`可以搜索由双向迭代器指定的任何范围（即，`char*`是双向迭代器，因此您将 ( `str`, `str+strlen(str)`) 作为开始和结束传递），甚至 char* 的重载将其视为 C 字符串。

# design-patterns - 领域驱动设计和工厂类的作用

> ID：555241
> 
> 赞同：57
> 
> 时间：2009-02-17T01:27:07.577
> 
> 标签：design-patterns, domain-driven-design

我不清楚工厂类的角色和职责是什么。我知道工厂类应该负责创建域对象（聚合根）及其关联的实体和值对象。

但我不清楚工厂“层”在 DDD 架构中的位置？工厂是否应该直接调用存储库以获取其数据或服务库？

工厂在哪里适合以下框架：
UI > App > Domain > Service > Data

此外，因为工厂是唯一允许创建对象的地方，如果您想在数据和服务层中创建对象，您不会获得循环引用吗？

如果工厂类的作用是创建对象，那么服务层有什么好处呢？

我已经问了很多问题，并感谢任何回应。我缺少的是一个示例应用程序，它演示了域驱动设计项目中的所有层如何组合在一起......那里有什么吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-21T00:53:20.967

> 但我不清楚工厂“层”在 DDD 架构中的位置？工厂是否应该直接调用存储库以获取其数据或服务库？

工厂应该是构建领域对象的一站式商店。需要执行此操作的代码的任何其他部分都应使用工厂。

通常，至少有三个数据源用作域对象构造的工厂的输入：来自 UI 的输入、来自持久性的查询结果和对域有意义的请求。因此，要回答您的具体问题，存储库将使用工厂。

这是一个例子。我在这里使用[Holub 的 Builder 模式](http://www.javaworld.com/javaworld/jw-01-2004/jw-0102-toolbox.html?page=4)。**编辑**：忽略此模式的使用。我开始意识到它[与 DDD 工厂混合得不太好](http://moffdub.wordpress.com/2009/02/22/i-suffer-from-ocd-odorless-code-dreamer/)。

```
// domain layer
class Order
{
    private Integer ID;
    private Customer owner;
    private List<Product> ordered;

    // can't be null, needs complicated rules to initialize
    private Product featured; 

    // can't be null, needs complicated rules to initialize, not part of Order aggregate
    private Itinerary schedule; 

    void importFrom(Importer importer) { ... }

    void exportTo(Exporter exporter) { ... }

    ... insert business logic methods here ...

    interface Importer
    {
        Integer importID();
        Customer importOwner();
        Product importOrdered();
    }

    interface Exporter
    {
        void exportID(Integer id);
        void exportOwner(Customer owner);
        void exportOrdered(Product ordered);
    }
}

// domain layer
interface OrderEntryScreenExport { ... }

// UI
class UIScreen
{
    public UIScreen(OrderEntryDTO dto) { ... }
}

// App Layer
class OrderEntryDTO implements OrderEntryScreenExport { ... } 
```

下面是 OrderFactory 的样子：

```
interface OrderFactory
{
    Order createWith(Customer owner, Product ordered);
    Order createFrom(OrderEntryScreenExport to);
    Order createFrom(List<String> resultSets);
} 
```

特色产品的逻辑和行程的生成都在 OrderFactory 中。

现在这里是在每个实例中如何使用工厂。

在 OrderRepository 中：

```
public List<Order> findAllMatching(Criteria someCriteria)
{
    ResultSet rcds = this.db.execFindOrdersQueryWith(someCriteria.toString());
    List<List<String>> results = convertToStringList(rcds);

    List<Order> returnList = new ArrayList<Order>();

    for(List<String> row : results)
        returnList.add(this.orderFactory.createFrom(row));

    return returnList;
} 
```

在您的应用层：

```
public void submitOrder(OrderEntryDTO dto)
{
    Order toBeSubmitted = this.orderFactory.createFrom(dto);

    this.orderRepo.add(toBeSubmitted);

    // do other stuff, raise events, etc
} 
```

在您的领域层中，单元测试可能：

```
Customer carl = customerRepo.findByName("Carl");
List<Product> weapons = productRepo.findAllByName("Ruger P-95 9mm");
Order weaponsForCarl = orderFactory.createWith(carl, weapons);

weaponsForCarl.place();

assertTrue(weaponsForCarl.isPlaced());
assertTrue(weaponsForCarl.hasSpecialShippingNeeds()); 
```

> 工厂在哪里适合以下框架：UI > App > Domain > Service > Data

领域。

> 此外，因为工厂是唯一允许创建对象的地方，如果您想在数据和服务层中创建对象，您不会获得循环引用吗？

在我的示例中，所有依赖项都是从上到下流动的。我使用了[依赖倒置原则](http://www.objectmentor.com/resources/articles/dip.pdf)（PDF链接）来避免你所说的问题。

> 如果工厂类的作用是创建对象，那么服务层有什么好处呢？

如果您的逻辑不适合任何单个域对象，或者您有一个涉及编排多个域对象的算法，请使用服务。该服务将封装任何不适合其他任何事物的逻辑，并将其委托给适合的领域对象。

在我在这里写的示例中，我想为订单制定行程将涉及多个域对象。OrderFactory 可以委托给这样的服务。

顺便说一句，您描述的层次结构可能应该是 UI > App > Domain Services > Domain > Infrastructure (Data)

> 我已经问了很多问题，并感谢任何回应。我缺少的是一个示例应用程序，它演示了域驱动设计项目中的所有层如何组合在一起......那里有什么吗？

[Jimmy Nilsson 的Applying Domain Driven Design and Patterns是对 Eric Evans 的](https://rads.stackoverflow.com/amzn/click/com/0321268202)[Domain-Driven Design](https://rads.stackoverflow.com/amzn/click/com/0321125215)的极大赞美。它有很多代码示例，虽然我不知道是否强调分层。分层可能很棘手，几乎是与 DDD 分开的主题。

在 Evans 的书中，有一个非常小的分层示例，您可能想要查看。分层是一种企业模式，Martin Fowler 写了[Patterns of Enterprise Application Architecture](https://rads.stackoverflow.com/amzn/click/com/0321127420)，您可能会发现它也很有用。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-25T14:30:39.553

存储库和工厂的区别在于，存储库代表抽象的持久存储，而工厂负责构建对象。

例如，假设我正在注册一个用户。我将从工厂获取我的用户对象

```
IUser user = userFactory.Create(name, email); 
```

然后将其传递给存储库，存储库将负责处理它。

```
userRepository.Insert(user); 
```

DDD 中的工厂可以被认为是一种隐藏新的方法，一种对实例化细节的抽象。它允许您非常有效地编程到接口而不是具体的。

此外，这允许存储库专注于它们的实体类型，因此泛型的使用变得非常强大。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-22T19:12:37.570

除非我真的陷入困境，否则我倾向于不强调设计模式，这可能是我自己的危险。我只是按照我的想法构建系统并重构，直到第二天它变得有意义。

我在以下情况下使用工厂：

*   有些层需要创建一个有规律的对象。**和**
*   只有该层知道何时创建它，或者使用什么定制**和**
*   只有其他一些层确切地知道要创建什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T02:34:01.223

DDD 家伙和我可能会争论这个问题，但基本上那个“工厂”类的想法是发布域对象。然后域对象访问数据并成为您正在使用的域的“模型”的一部分。

应用程序*包含*UI 等，它不是继承层次结构。

小心那种“那种”运算符；很多人认为因为他们可以使用继承，所以他们必须使用继承。聚合（“包含”或“具有”而不是“是”）通常是更好的选择。

### 更新

不必要。想想域告诉你什么：它类似于“我需要一个产品，并且我知道产品的产品编号。当产品工厂完成后，我希望得到代表我的产品的完全填充的对象。” 当您创建 Product 对象时，它需要做什么才能成为代表特定产品的有效 Product 对象？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-22T15:24:40.097

> 工厂是否应该直接调用存储库以获取其数据或服务库？

我不会说，如果可能的话，应该直接传递它需要的信息。

> 工厂在哪里适合以下框架：UI > App > Domain > Service > Data

不确定这种分层来自哪里，DDD 中没有固定层，但我会说你最好专注于这种风格

UI > 应用程序 > 域

在域中，您将拥有多种类型的对象，我将设置有关它们之间关系的规则：

*   工厂应该通过他们完成工作所需的一切，因此在大多数情况下我不会让他们调用其他服务或存储库。
*   在大多数情况下，实体不应该联系存储库，而是服务（或其他上层）应该负责这项工作。
*   实体不应调用服务，服务位于实体/价值对象/规范之上并酌情协调它们。
*   域内的服务是用来协调的，它们不包含重要的域/业务行为。

> 如果工厂类的作用是创建对象，那么服务层有什么好处呢？

埃里克在书中很好地解释了这一点，所以我会参考它，但如果你有交叉聚合行为或不能很好地融入一个聚合的行为（例如书中的帐户示例），它最终会很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-23T20:51:57.317

我看到应用程序服务层负责通过调用工厂来创建新实体。因此，实体工厂接口定义在 Application Service 模块中，实际实现是一个基础设施服务，与持久化相同。对于通用应用程序服务与域服务与基础设施服务的一个很好的清晰概念，我通过观看以下内容获得了很多清晰：[Bob Martin Ruby Midwest 2011](https://youtu.be/hALFGQNeEnU)

# sql - SQLite INNER JOIN 中的“不明确的列名”

> ID：555246
> 
> 赞同：5
> 
> 时间：2009-02-17T01:35:43.610
> 
> 标签：sql, sqlite, join

我在 SQLite DB 中有两个表，INVITEM 和 SHOPITEM。他们的共享属性是 ItemId，我想执行 INNER JOIN。这是查询：

```
 SELECT  INVITEM.CharId AS CharId, 
            INVITEM.ItemId AS ItemId 
      FROM  (INVITEM as INVITEM 
INNER JOIN  SHOPITEM AS SHOPITEM 
        ON  SHOPITEM.ItemId = INVITEM.ItemId)
     WHERE  ItemId = 3; 
```

SQLite 不喜欢它：

```
SQL error: ambiguous column name: ItemId 
```

如果我写，错误就会消失`WHERE INVITEM.ItemId = 3`，但由于 WHERE 条件或多或少是用户指定的，我宁愿让它工作而不必指定表。NATURAL JOIN 似乎解决了这个问题，但我不确定该解决方案是否足够通用（即我可以在这种情况下使用，但我不确定我是否可以在每种情况下使用）

任何可以解决问题的替代 SQL 语法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T01:47:06.767

我会这样写这个查询：

```
SELECT i.CharId AS CharId, i.ItemId AS ItemId 
FROM INVITEM as i INNER JOIN SHOPITEM AS s USING (ItemId)
WHERE i.ItemId = 3; 
```

我使用的`USING (ItemId)`语法只是口味问题。它相当于`ON (i.ItemID = s.ItemID)`.

`i.ItemID`但是我通过在`WHERE`子句中进行限定来解决歧义。你会认为这是不必要的，因为`i.ItemID = s.ItemID`. 它们在交换性上是相等的，所以没有语义上的歧义。但显然 SQLite 不够聪明，无法知道这一点。

我不喜欢用`NATURAL JOIN`。它相当于两个同名表中存在的*每一列的等连接。*我不喜欢使用它，因为我不希望它比较我不想要的列，只是因为它们具有相同的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T01:39:48.530

我会避免允许用户直接编写 SQL 子句。这就是 SQL 注入漏洞的来源。

如果您需要灵活的查询，请尝试解析用户的输入并添加适当的 where 子句。

这是一些 C# 代码来显示一般想法

```
// from user input
string user_column = "ItemID";
string user_value = "3";

string sql = "SELECT INVITEM.CharId AS CharId, INVITEM.ItemId AS ItemId FROM (INVITEM as INVITEM INNER JOIN SHOPITEM AS SHOPITEM ON SHOPITEM.ItemId = INVITEM.ItemId) ";

if (user_column == "ItemID")
{
    // using Int32.Parse here to prevent rubbish like "0 OR 1=1; --" being entered.
    sql += string.Format("WHERE INVITEM.ItemID={0}",Int32.Parse(user_value));
} 
```

显然，如果您要处理多个子句，则必须在后续子句中用 AND 代替 WHERE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T01:47:05.720

只需将您的列别名更改为类似但唯一的名称（例如 ITEM_ID）。

# html - HTML 的松散标准是伤害还是帮助了互联网

> ID：555249
> 
> 赞同：5
> 
> 时间：2009-02-17T01:38:11.903
> 
> 标签：html, standards

我正在阅读 O'Reilly 的[Learning XML](http://oreilly.com/catalog/9780596004200/index.html) Book 并阅读了以下内容

> HTML 在某些方面倒退了一步。为了实现真正有用所需的简单性，必须牺牲一些通用编码原则。...回到通用编码的理想，一些人试图将 SGML 用于 web ...这被证明太难了。

这让我想起了 StackOverflow 播客，他们在其中讨论了适用于浏览器的格式不佳的 HTML。

我的问题是，如果标准像现在开发人员希望的那样严格，互联网还会成功吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-17T02:44:05.473

缺乏标准的执行丝毫没有影响网络的采用。如果有的话，它帮助了它。该网络最初是为科学家（通常对编程没有耐心）设计的，用于发布研究结果。所以自由解析器允许他们不关心标记——足够好就足够好了。

如果它没有在科学家中取得成功，它就永远不会迁移到学术界的其他地方，也不会从那里迁移到更广阔的世界，今天它仍然是一项学术活动。

但是现在它已经在更广阔的世界中出现了，我们应该取缔吗？我认为任何人都没有这样做的动机。浏览器制造商想要市场份额，但他们不会因为对正确显示的页面感到不满而获得市场份额。内容网站想要接触到人们，而仅仅通过正确地出现在 Opera 中并不能做到这一点。像现在这样的开发者大厅是不够的。

此外，前端开发人员（与视觉设计师相比）可以收取大量费用的原因之一是因为他们了解各种浏览器的来龙去脉。如果只有一种正确的方法，那么它可以自动完成，并且不再需要那些人 - 好吧，无论如何，不​​需要程序员的薪水。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T01:49:10.630

今天网络上的大多数歧义和不一致不是来自未封闭的标签之类的东西——而是来自一个浏览器到另一个浏览器的 CSS 语义不一致。即使所有的网页都是奇迹般地格式良好的 XML，它也无济于事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T01:49:45.293

html 只是“标记”文本而不是一种具有运算符、循环、函数和其他常见编程语言元素的语言，这一事实*使得*它可以被松散地解释。

人们*可以*将这种松散的解释关联为使标记语言更易于访问和使用，从而允许更多“未受过教育”的人访问该语言。

我个人的看法是，这与互联网的成功关系不大。相反，让互联网“成功”的是交流和共享信息的能力。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T02:23:12.857

它严重伤害了互联网。

我记得听过一个与从事 HTML 2.0 规范和 IIRC 工作的人的播客采访，当时围绕着遵守标准的解析器的严格性进行了一场大辩论。

该论点的获胜者使用了当时流行的“一个实施良好的系统应该在它接受的内容上是自由的，在它的输出上应该是严格的”方法。

AFAICT 许多人现在认为这种方法过于简单——原则上听起来不错，但实际上很少在实践中起作用。

IMO，即使 HTML 从一开始就非常严格，对于大多数人来说仍然足够简单。一开始的吸收可能会稍微慢一些，但从中长期来看，会节省大量的时间/金钱（数十亿美元）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T21:16:46.570

有一个原则描述了 HTML 和 Web 浏览器如何能够成功地工作和互操作：

**在你接受的东西上要自由，在你输出的东西上要保守。**

什么是“正确”和“可接受”的 HTML 之间需要有一定的自由度。因为 HTML 被设计为“人类+rw”，所以我们不应该对标签汤有这么多口味感到惊讶。在任何需要人类参与的地方，灵活性都是 HTML 的优势。

但是，这种灵活性增加了处理开销，当您需要为机器消耗创建一些东西时，这很难证明是合理的。这就是 XHTML 和 XML 的原因：它带走了一些灵活性以换取可预测的输入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T21:31:41.683

如果 HTML 更加严格，那么更容易的东西就会产生互联网成为主流所需的网络效应。

# .net - 仅使用 XAML 在左键单击时显示 ContextMenu

> ID：555252
> 
> 赞同：8
> 
> 时间：2009-02-17T01:39:18.220
> 
> 标签：.net, wpf, xaml, mvvm, contextmenu

WPF 的默认行为`ContextMenu`是在用户右键单击时显示它。我希望在`ContextMenu`用户左键单击时显示。看起来这应该是 上的一个简单属性`ContextMenu`，但事实并非如此。

我操纵它，以便我`LeftMouseButtonDown`在代码隐藏中处理事件，然后显示上下文菜单。

我在我的项目中使用 MVVM，这意味着我将`DataTemplate`s 用于具有上下文菜单的项目。摆脱代码隐藏并找到一种使用 XAML 中的触发器或属性来显示上下文菜单的方法会更加优雅。

对此问题有任何想法或解决方案吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-03-18T13:53:35.337

我刚刚根据 HK1 的回答编写并测试了这个（您还可以阅读[附加属性概述中的附加属性）](https://msdn.microsoft.com/en-us/library/ms749011%28v=vs.110%29.aspx)：

```
public static class ContextMenuLeftClickBehavior
{
    public static bool GetIsLeftClickEnabled(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsLeftClickEnabledProperty);
    }

    public static void SetIsLeftClickEnabled(DependencyObject obj, bool value)
    {
        obj.SetValue(IsLeftClickEnabledProperty, value);
    }

    public static readonly DependencyProperty IsLeftClickEnabledProperty = DependencyProperty.RegisterAttached(
        "IsLeftClickEnabled", 
        typeof(bool), 
        typeof(ContextMenuLeftClickBehavior), 
        new UIPropertyMetadata(false, OnIsLeftClickEnabledChanged));

    private static void OnIsLeftClickEnabledChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        var uiElement = sender as UIElement;

        if(uiElement != null) 
        {
            bool IsEnabled = e.NewValue is bool && (bool) e.NewValue;

            if(IsEnabled)
            {
                if(uiElement is ButtonBase)
                    ((ButtonBase)uiElement).Click += OnMouseLeftButtonUp;
                else
                    uiElement.MouseLeftButtonUp += OnMouseLeftButtonUp;
            }
            else
            {
                if(uiElement is ButtonBase)
                    ((ButtonBase)uiElement).Click -= OnMouseLeftButtonUp;
                else
                    uiElement.MouseLeftButtonUp -= OnMouseLeftButtonUp;
            }
        }
    }

    private static void OnMouseLeftButtonUp(object sender, RoutedEventArgs e)
    {
        Debug.Print("OnMouseLeftButtonUp");
        var fe = sender as FrameworkElement;
        if(fe != null)
        {
            // if we use binding in our context menu, then it's DataContext won't be set when we show the menu on left click
            // (it seems setting DataContext for ContextMenu is hardcoded in WPF when user right clicks on a control, although I'm not sure)
            // so we have to set up ContextMenu.DataContext manually here
            if (fe.ContextMenu.DataContext == null)
            {
                fe.ContextMenu.SetBinding(FrameworkElement.DataContextProperty, new Binding { Source = fe.DataContext });
            }

            fe.ContextMenu.IsOpen = true;
        }
    }

} 
```

...

```
<Button Content="Do All" local:ContextMenuLeftClickBehavior.IsLeftClickEnabled="True" >
    <Button.ContextMenu>
        <ContextMenu>
            <MenuItem Header="Make everything awesome" />
            <MenuItem Header="Control the World" />
        </ContextMenu>
    </Button.ContextMenu>
</Button> 
```

（注意 OnMouseLeftButtonUp() 方法中的注释）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-18T23:37:06.483

我建议做的是制作一个带有附加 DependencyProperty 的新静态类。调用类 LeftClickContextMenu 和属性 Enabled（只是想法）。当您注册 DependencyProperty 时，添加一个 on changed 回调。然后在属性更改回调中，如果 Enabled 设置为 true，然后将处理程序添加到 LeftMouseButtonDown 事件并在那里执行您的操作。如果 Enabled 设置为 false，则删除处理程序。这允许您通过简单地在 xaml 中使用以下内容将其设置为任何属性。

```
<Border namespace:LeftClickContextMenu.Enabled="True" /> 
```

这种技术称为附加行为，您可以在此代码项目文章中了解更多信息：http: [//www.codeproject.com/KB/WPF/AttachedBehaviors.aspx](http://www.codeproject.com/KB/WPF/AttachedBehaviors.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-26T15:57:32.230

虽然 Caleb 的答案是正确的，但它不包括工作代码。我使用 VB.NET 设置了一个示例（对不起），所以我将其发布在这里。

```
<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:AttachedBehaviorTest.AttachedBehaviorTest"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <StackPanel>
            <TextBlock local:ContextMenuLeftClickBehavior.IsLeftClickEnabled="True">Some Text Goes Here
                <TextBlock.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Test1" />
                    </ContextMenu>
                </TextBlock.ContextMenu>            
            </TextBlock>

        </StackPanel>
    </Grid>
</Window> 
```

```
Namespace AttachedBehaviorTest

    Public NotInheritable Class ContextMenuLeftClickBehavior

        Private Sub New()
        End Sub

        Public Shared Function GetIsLeftClickEnabled(obj As DependencyObject) As Boolean
            Return CBool(obj.GetValue(IsLeftClickEnabled))
        End Function

        Public Shared Sub SetIsLeftClickEnabled(obj As DependencyObject, value As Boolean)
            obj.SetValue(IsLeftClickEnabled, value)
        End Sub

        Public Shared ReadOnly IsLeftClickEnabled As DependencyProperty = _
            DependencyProperty.RegisterAttached("IsLeftClickEnabled", GetType(Boolean), GetType(ContextMenuLeftClickBehavior), New UIPropertyMetadata(False, AddressOf OnIsLeftClickEnabled))

        Private Shared Sub OnIsLeftClickEnabled(sender As Object, e As DependencyPropertyChangedEventArgs)
            Dim fe As FrameworkElement = TryCast(sender, FrameworkElement)
            If fe IsNot Nothing Then
                Dim IsEnabled As Boolean = CBool(e.NewValue)
                If IsEnabled = True Then
                    AddHandler fe.MouseLeftButtonUp, AddressOf OnMouseLeftButtonUp
                    Debug.Print("Added Handlers")
                Else
                    RemoveHandler fe.MouseLeftButtonUp, AddressOf OnMouseLeftButtonUp
                    Debug.Print("RemovedHandlers")
                End If 
            End If
        End Sub

        Private Shared Sub OnMouseLeftButtonUp(sender As Object, e As RoutedEventArgs)
            Debug.Print("OnMouseLeftButtonUp")
            Dim fe As FrameworkElement = TryCast(sender, FrameworkElement)
            If fe IsNot Nothing Then
                'Next Line is Needed if Context Menu items are Data Bound
                'fe.ContextMenu.DataContext = fe.DataContext
                fe.ContextMenu.IsOpen = True
            End If
        End Sub

    End Class

End Namespace 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-04T13:07:00.990

这个答案与@nightcoder 的答案完全相同（感谢您的灵感！）。它使用 Blend 风格的行为，与附加属性相比，这是一种更现代的方法。

```
using System;
using System.Windows;
using System.Windows.Controls.Primitives;
using System.Windows.Data;
using System.Windows.Interactivity;

/// <summary>
/// Add this to any button menu allow a left click to open the context menu as well as the right.
/// </summary>
public class ContextMenuLeftClickBehavior : Behavior<ButtonBase>
{
    protected override void OnAttached()
    {
        base.OnAttached();

        this.AssociatedObject.Loaded += this.OnWindowLoaded;
        this.AssociatedObject.Unloaded += this.OnWindowUnloaded;
    }

    private void OnWindowLoaded(object sender, RoutedEventArgs e)
    {
        this.AssociatedObject.Click += OnMouseLeftButtonUp;
    }

    private void OnWindowUnloaded(object sender, RoutedEventArgs e)
    {
        this.AssociatedObject.Click -= OnMouseLeftButtonUp; // Cannot override OnDetached(), as this is not called on Dispose. Known issue in WPF.
    }

    private static void OnMouseLeftButtonUp(object sender, RoutedEventArgs e)
    {
        if (sender is ButtonBase fe && fe.ContextMenu != null)
        {
            if (fe.ContextMenu != null)
            {
                // If we use binding in our context menu, then it's DataContext won't be set when we show the menu on left click. It
                // seems setting DataContext for ContextMenu is hardcoded in WPF when user right clicks on a control? So we have to set
                // up ContextMenu.DataContext manually here.
                if (fe.ContextMenu?.DataContext == null)
                {
                    fe.ContextMenu?.SetBinding(FrameworkElement.DataContextProperty, new Binding { Source = fe.DataContext });
                }

                fe.ContextMenu.IsOpen = true;
            }
        }
    }
} 
```

然后将行为添加到按钮：

```
<Button>
    <i:Interaction.Behaviors>
        <attachedProperties:ContextMenuLeftClickBehavior/>
    </i:Interaction.Behaviors>                                                
<Button> 
```

像 Ellipse 或 Rectangle 这样的元素没有`OnClick`事件，这意味着没有什么能真正适用于任何交互的东西。因此，将所有内容包装在一个按钮中以获取该`OnClick`事件。也可以通过将鼠标光标更改为鼠标悬停时的手来暗示该区域是可点击的。

```
<Button.Style>
    <Style TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Ellipse Fill="{TemplateBinding Background}" Width="16" Height="16"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <!--  Bind to custom color in ViewModel -->
                <Setter Property="Background" Value="{Binding CustomBrush}"/>
                <Setter Property="Cursor" Value="Hand"/>
            </Trigger>
        </Style.Triggers>
    </Style>
</Button.Style> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-12-29T18:44:35.003

忘记“唯一的xaml”的东西。当您将其包装到附加行为中时，可以很好地解决这个问题。

这是一种在左键单击时显示上下文菜单的方法：

`Border`在元素上创建一个新的左键处理程序：

```
<Border x:Name="Win"
        Width="40"
        Height="40"
        Background="Purple"
        MouseLeftButtonUp="UIElement_OnMouseLeftButtonUp"> 
```

然后添加：

```
private void UIElement_OnMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
    e.Handled = true;

    var mouseDownEvent =
        new MouseButtonEventArgs(Mouse.PrimaryDevice,
            Environment.TickCount,
            MouseButton.Right)
        {
            RoutedEvent = Mouse.MouseUpEvent,
            Source = Win,
        };

    InputManager.Current.ProcessInput(mouseDownEvent);
} 
```

它的作用是，它基本上将左键单击映射到右键单击。为了可重用性，您可以将其包装到附加的行为中。

# wcf - WCF 服务中的并发打开 TCP 连接

> ID：555255
> 
> 赞同：6
> 
> 时间：2009-02-17T01:40:50.087
> 
> 标签：wcf, perfmon

我们有一个带有多个 TCP 端点的 WCF 服务。我有兴趣在任何给定时间监视并发打开连接的总数。是否有任何性能计数器可以让我们开箱即用地做到这一点？请注意，在我们的例子中，实例数 != 连接数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T13:24:12.517

如果您更喜欢使用[PerfMon](http://technet.microsoft.com/en-us/library/bb490957.aspx)，请查看[这些性能计数器](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/iisbook/c05_monitoring_tcp_connections.mspx?mfr=true)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T06:25:06.723

使用 netstat 命令查看打开的 tcp 连接

[http://technet.microsoft.com/en-us/library/bb490947.aspx](http://technet.microsoft.com/en-us/library/bb490947.aspx)

# algorithm - 亚马逊 Faceted Search 为何如此之快？

> ID：555259
> 
> 赞同：11
> 
> 时间：2009-02-17T01:43:11.830
> 
> 标签：algorithm

在 amazon.com 上搜索一个词，例如“堆栈溢出”，搜索结果很快就会回来。

在窗口的左侧，有一个分面搜索显示在某些类别中，与该词匹配的产品数量。

然后，您可以深入研究这些术语。例如，有 1094 本书与该术语匹配，分为 Computers & Internet (1003)、Science 等。

鉴于对书籍的搜索涵盖了其中一些书籍的内容，我觉得这是一个非常令人印象深刻的壮举。

亚马逊是如何做到这一点的？大规模并行化？例如，每个节点都知道一些产品？

顺便说一句，我记得1981年的一本书《新机器之魂》的正文中出现了“堆栈溢出”

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-17T01:46:27.937

简短的回答是，很多索引。更长的答案是，大量的索引、大量的冗余、大量的缓存和智能分区。

真正的答案是——读这本书： [http ://www-csli.stanford.edu/~hinrich/information-retrieval-book.html](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html)

（它是免费的，而且非常好）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-17T01:46:09.030

好吧，有并行化，但是每个人在这些类型的后端所做的事情之一是运行缓慢的过程（如书籍内容的语义解析）并在其上进行快速查找。他们实际上是在一些大型数据库中缓存搜索结果，因此他们所要做的就是对您的搜索结果进行数据库查找。也许我误解了这个问题，但这与谷歌所做的类似。当您输入搜索词时，您不会认为他们的蜘蛛会在网上搜索您的网站，对吧？

# .net - .NET：绘画（剪辑）只是控件的一部分？

> ID：555265
> 
> 赞同：0
> 
> 时间：2009-02-17T01:47:02.990
> 
> 标签：.net, vb.net, paint, clipping

我有一个 VB.NET 程序，我在其中使用 WebBrowser 控件来模拟时间表表单。对于数据输入，我使用了位于 WebBrowser 控件顶部的 DateTimePicker 控件，我已将其编程为在单击 WebBrowser 控件时移动到 WebBrowser 控件中表格单元格的顶部。（如果你想问我为什么不使用 DataGridView，那是为了格式化）

我的问题是，我想将 WebBrowser 的某些部分（标题、滚动条）视为位于 DateTimePicker 之上，尤其是在用户滚动 WebBrowser 时。我的想法是以某种方式为 DateTimePicker 提供一个矩形，使其仅绘制该区域内的控件部分。不幸的是，我对 .NET 几乎是全新的（但不是一般的编程），在谷歌搜索了半天之后，我仍然不知道该怎么做。

有谁知道如何做到这一点并且可以告诉我/指向我可以告诉我如何的地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T02:20:45.890

我认为您正在寻找[Control.Invalidate](http://msdn.microsoft.com/en-us/library/wtzka3b5.aspx)方法。

但是在重新阅读您的问题后，我不太确定。也许您正试图让 DateTimePicker 被 WebBrowser 控件的边框剪裁……在这种情况下，您需要确保将 DateTimePicker 添加到 WebBrowser 的 Controls 集合中。

我通过创建一个带有 WebBrowser、DateTimePicker 和 Button 的表单来运行一个简单的测试。将此代码放在按钮的 Click 事件中：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    WebBrowser1.Controls.Add(DateTimePicker1)
End Sub 
```

如果您进行设置以使 DTP 延伸到 WebBrowser 的边缘，您会看到单击按钮后它会被剪裁。它移动的原因是它相对于它的容器定位，一旦你单击按钮，它就变成了 WebBrowser。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T14:11:34.400

JeffK：我刚刚尝试将 DTP 添加到 WebBrowser 的控件集合中，但 DTP 仍然显示在 WebBrowser 的滚动条和表格标题之上（表格标题是固定位置的 HTML 元素）。你有什么想法可以防止这种情况发生吗？

肖恩：不，在你提到它之前，我实际上从未听说过 WPF。你有什么好的链接可以让我了解更多关于它/如何使用它吗？

# javascript - 添加额外的 js 文件会破坏 jQuery IntelliSense

> ID：555269
> 
> 赞同：9
> 
> 时间：2009-02-17T01:48:22.143
> 
> 标签：javascript, jquery, visual-studio-2008, intellisense

我一直在 VS2008 中使用 jQuery IntelliSense，它非常棒。最近我添加了对 jQuery UI 的引用，从那时起，jQuery IntelliSense 就消失了。我发现一旦您在文档中引用另一个 .js 文件，IntelliSense 就会消失。有什么办法可以避免这种情况？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-21T01:02:31.507

如果任何引用的文件中存在错误，它将破坏来自同一文档的所有文件引用的智能感知。Visual Studio 的下一个版本在这方面将更加强大。我为这种脆弱性直接道歉。我们很早就做出了一些设计决定，阻止我们使 VS9 外部引用更加健壮。

同时，使用以下解决方法。从 Slace 给你的链接安装 SP1。如果您引用了一个名为 .js 的文件，并且在同一位置有一个名为 -vsdoc.js 的文件，那么 JS intellisense 将选择 -vsdoc 版本。如果该脚本为空，则不会产生错误。确定导致智能感知生成失败的 jquery 插件，并在其旁边放置一个 -vsdoc 版本。你不会得到 UI 的智能感知，但你仍然会得到 jquery 和其他可以工作的插件。

您放入 vsdoc 版本的任何内容都将显示在智能感知中。如果需要，您可以将要显示的数据结构的欺骗版本放入智能感知中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-17T02:18:38.093

很可能在随后引用的 JavaScript 文件之一中存在错误。打开你的JS文件，一旦“Updaing JavaScript Intellisense”从Visual Studio的状态栏中消失（有一个菜单选项会强制JS intellisense刷新，不记得它在哪里，我只是创建了一个键盘快捷键通过工具 -> 选项 -> 键盘区域）打开错误窗口并在警告下找到智能感知加载失败的原因。

这通常是在解析其中一个文件时发现的一个错误，但是当我引用了很多文件时，我遇到了堆栈溢出。

**编辑**：您还应该确保已安装此 VS 补丁：http: [//code.msdn.microsoft.com/KB958502](http://code.msdn.microsoft.com/KB958502)和 VS 2008 SP1（先安装 SP1！）。然后你只需要：

```
/// <reference path="/path/to/jquery-1.3.1.js" /> 
```

确保您维护`-vsdocs`intellisense 文件，它将被自动拾取（只要它与您引用的文件位于同一文件夹中）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-18T14:39:12.637

接受的答案帮助我解决了这个问题，但没有解决问题。我安装了修补程序：[http](http://code.msdn.microsoft.com/KB958502) ://code.msdn.microsoft.com/KB958502但仍然收到错误。

错误：

```
Error updating JScript IntelliSense: D:\Dev\Test\Scripts\jQuery-1.3.2-vsdoc.js: 'jQuery.support.htmlSerialize' is null or not an object @ 1430:4 
```

似乎在没有适当的 -vsdoc.js 文件的情况下添加以下文件会导致上述问题。

```
<script src="../../Scripts/jquery-ui-1.7.custom.min.js" type="text/javascript"></script> 
```

我在脚本文件夹中添加了一个空文件“jquery-ui-1.7.custom.min-vsdoc.js”，Jscript Intellisense 问题就消失了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-18T04:13:54.667

我想提出一个稍微好一点的解决方案。几个月前，我解决了这个问题并为 jQuery UI 创建了一个非常基本的 vsdoc 文件。[这是博客文章的链接（其中包含可供下载的文件）。](http://www.theruntime.com/blogs/jaykimble/archive/2009/07/20/jquery-ui-visual-studio-intellisense-vsdoc-file.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-21T15:43:37.777

我根据上面的建议通过一个小扩展解决了这个问题：对我来说，诀窍是在我的页面上添加对我的 jqueryui.com 库和我创建的文件的空白 -vsdoc.js 版本的引用：

```
<script type="text/javascript" src="../../Scripts/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="../../Scripts/jquery-ui-1.7.2.custom.min-vsdoc.js"></script> 
```

希望这可以帮助！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-05T02:00:21.250

太好了，调整是为每个麻烦的 *.js 文件创建一个空的 *-vsdoc.js 文件。

我发现这个错误是由匿名函数引起的，例如：

```
(function($) {
    $.anything...;
})(jQuery); 
```

希望这将有助于创建[http://code.msdn.microsoft.com/KB958502](http://code.msdn.microsoft.com/KB958502)和 JScript IntelliSense 团队的人。

# java - 在 AWT 中绘制半透 明 .png

> ID：555273
> 
> 赞同：2
> 
> 时间：2009-02-17T01:50:54.603
> 
> 标签：java, transparency, awt

我正在尝试在电视信号上绘制一张 transparent.png 图像（因此在渲染之前进行混合有点过时了）。

当我绘制透明矩形时，我可以设置 SrcOver 并为我的背景颜色指定一个 alpha 并且它会起作用：

```
((DVBGraphics) g).setDVBComposite(DVBAlphaComposite.SrcOver); 
```

但现在我实际上正在尝试使用设置了透明度的 png 但这不起作用（它只是实心的）。

如果我设置 XOR 模式：

```
g.setXORMode(Color.white); 
```

设置 SrcOver 后，整个图像变为半透明，而不仅仅是指定的点。此外，设置为“透明”的部分仍然可见。

任何人都可以指出使这项工作的神奇调用集吗？

（另外，swing 不可用——只是 java 1.4 的大部分）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T05:56:25.667

我只能建议您重新检查所有内容；我之前使用 AWT 绘制了 PNG 图像，它工作得很好，只是做了显而易见的事情：

```
private final Image                     image;                                  //

protected void paintForeground(Graphics2D gc, int wid, int hgt) {
    ...
    gc.drawImage(image,dx,dy,(dx+width),(dy+height),0,0,width,height,null);
    ...
    } 
```

除了在 J2ME 1.1 平台上之外，这会以尊重的图像透明度进行绘制。

绘图模式是普通绘制，而不是 XOR。

# java - Eclipse RCP：利用配置目录

> ID：555275
> 
> 赞同：7
> 
> 时间：2009-02-17T01:51:44.943
> 
> 标签：java, eclipse, rcp

我的 Eclipse RCP 应用程序需要一个包含一些信息的配置文件才能连接到远程数据库。存储此配置文件的最佳位置在哪里？

我可以为此目的使用默认配置目录（通常存储“config.ini”的位置）吗？如果是这样，我如何以编程方式将 File 实例获取到该位置？我还注意到这个目录在我的 Eclipse IDE 中不存在。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T13:22:28.590

与往常一样，您有多种选择，具体取决于您的要求。

*   使用[运行时首](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/runtime_preferences.htm)选项通过合适的 PreferenceInitializer 存储在 PreferenceStore 中。相当大而广泛的 API，其中包含了很多想法。默认情况下，首选项不会向用户或管理员公开，因此您需要做一些工作来公开首选项页面或写入属性文件。

对于不太高级/较少的工作，特别是如果您无权访问 eclipse 首选项（例如服务器端 OSGi）：

*   在 RCP.ini 中设置为系统属性。启动后用户不可更改，需要访问 RCP.ini (eclipse.ini) 文件，这可能是可能的，尤其是在您没有贡献 IDE 的情况下。
*   设置为系统属性，作为快捷方式中的参数。取决于使用快捷方式的用户。安装时需要生成专门的快捷方式。

如果文件系统的可访问性真的很重要，那么我会考虑使用上述方法之一来设置`etc`目录，并让您的捆绑包在`etc`目录中生成默认属性文件（如果它们在首次使用时不存在）。这本质上是滚动您自己的首选项商店，因此如果您确实有访问首选项捆绑包，那么您最好这样做。这个相当古老的[用户设置常见问题解答](http://dev.eclipse.org/viewcvs/index.cgi/platform-core-home/documents/user_settings/faq.html?view=co)也可能会有所帮助。

我确实记得 Erich Gamma（如四人组和 JDT 技术负责人）的一次采访，他说大约有七种不同的偏好机制，他从来不知道该使用哪一种。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-29T08:20:39.470

正如已经指出的，Preferences API 是值得一看的。还有适用于将用户名和密码加密存储在磁盘上的 Secure Preferences API。

另一种选择是使用“org.eclipse.osgi.service.datalocation.Location”OSGi 服务。这提供了对不同可用位置的访问。

第三种选择是在“config.ini”中定义一个系统属性，该属性使用占位符指向包含您的连接信息的文件：“my.connection.settings=@config.dir/mysettings.ini”。'@config.dir' 是一个占位符，它被替换为配置目录的实际路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T03:33:23.797

看看资源插件 - 可能会给你你正在寻找的东西：

[http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resInt_filesystem.htm](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/resInt_filesystem.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T03:32:43.063

通常，我喜欢将配置文件隐藏在“bin”目录中，或者不在根目录中的某个地方。您可能应该将它保存在项目的子目录中，这样您就不会弄乱系统上的一些随机位置。如果您需要获取文件的句柄，您可以这样做：

```
File configFile = new File("./bin/remoteDbConfig.ini"); 
```

然后，如果它是一个真正的 ini 文件，您可以使用[Properties.load()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html#load(java.io.InputStream))来加载和使用 ini 文件中的值。

您还可以使用 Preferences API 来存储远程连接所需的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T15:38:07.097

要获取配置目录的文件位置，请运行：

新的 org.eclipse.core.runtime.preferences.ConfigurationScope().getLocation().toFile();

# objective-c - 转换点：

> ID：555276
> 
> 赞同：2
> 
> 时间：2009-02-17T01:51:55.070
> 
> 标签：objective-c

我正在学习 Objective-C 和 Cocoa（在时间允许的情况下时断时续），所以要温柔。

示例应用程序具有以下几行：

```
NSPoint down = [mouseEvent locationInWindow];
//...some other stuff
NSPoint p = [self convertPoint:down fromView:nil]; 
```

然后它继续使用 p 进行拖放操作（使用 pasteBoard）。但是，我不明白这一切都在一个视图中，为什么不只使用`down`，为什么要使用`convertPoint:`？还是我错过了一些基本的东西？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T02:07:47.403

“下”点在窗口的坐标系中——它从窗口的角落开始。点“p”在视图的坐标系中。除非这个视图的原点恰好在窗口的原点，并且它们的坐标系都没有变换（比如，使用 setBounds:)，否则这两个点不会在同一个地方。

# lotus-notes - 我需要视图中两列的总和

> ID：555277
> 
> 赞同：2
> 
> 时间：2009-02-17T01:52:40.950
> 
> 标签：lotus-notes, lotus-domino, lotusscript

我发现这段代码通过并打印出两列的 csv。我稍后解析并计算这两列。我想在这里计算它，而不是稍后打印和计算。我一直在胡闹，但无法弄清楚。

```
Dim entry As NotesViewEntry
Dim vc As NotesViewEntryCollection
Dim rowstring As String
Dim session As New NotesSession
Dim db As NotesDatabase
Set db = session.CurrentDatabase
Dim view As NotesView
Set view = db.GetView( nameofview )
Set vc = view.AllEntries
Set entry = vc.GetFirstEntry()

While Not entry Is Nothing 
    rowstring = ""
    Forall colval In entry.ColumnValues
        If rowstring = "" Then
            rowstring = colval
        Else
            rowstring = rowstring + +","  + colval
        End If          
    End Forall
Wend 
```

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T02:07:23.893

试试这个，它通过将 colval 字符串转换为数值来将列累积到 rowval 中。如果它们是浮点数，您可以轻松地使用 double/CDbl() 。这是假设，通过“计算两列”，您的意思是将它们相加并输出总和。如果您的意思是字面上的计数，则将其保留为`Integer`并更改行

```
rowval = rowval + CInt(colval) 
```

到

```
rowval = rowval + 1 
```

这里是：

```
Dim entry As NotesViewEntry
Dim vc As NotesViewEntryCollection
Dim rowval As Integer                       ' or Double '
Dim session As New NotesSession
Dim db As NotesDatabase
Set db = session.CurrentDatabase
Dim view As NotesView
Set view = db.GetView( nameofview )
Set vc = view.AllEntries
Set entry = vc.GetFirstEntry()

While Not entry Is Nothing 
    rowval = 0
    Forall colval In entry.ColumnValues
        rowval = rowval + CInt(colval)      ' Or CDbl() '
    End Forall
    ' Output rowval here. '
    Set entry=vc.GetNextEntry (entry)
Wend 
```

根据您的原始示例，我没有输出任何内容（？），但我已经在您应该做的地方发表了评论。

# mysql - 如何让 phpMyAdmin 连接到本地 mysql 服务器？

> ID：555282
> 
> 赞同：0
> 
> 时间：2009-02-17T01:56:02.750
> 
> 标签：mysql, phpmyadmin, mysql-error-1045

我有我的 config.inc.php 文件，并将我的主机名设置为 localhost。不幸的是，我不知道我的用户名/密码应该是什么。这是我需要在 MySql 端配置的东西吗？我尝试创建任意用户名/密码（管理员/密码），但是当我尝试使用这些凭据登录 phpMyAdmin 时，出现错误：（#1045 - 用户 'admin'@'localhost' 的访问被拒绝（使用密码：是的））

谁能指出我正确的方向？（对不起这个愚蠢的问题；我以前没有安装过 mysql。我一直有一个主机名/用户名/密码给我。）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T03:02:21.733

没有密码的root。

$cfg['Servers'][$i]['user'] = 'root'; // MySQL 用户 $cfg['Servers'][$i]['password'] = ''; // MySQL 密码（只需要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T01:59:41.697

你用的是什么安装的mysql？不知道这很难知道。我建议安装 wamp 并记住通常的“正常”安装使用用户名：root 并且没有密码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T01:59:48.343

在这里，您拥有 mysql 中的默认权限，以及如何更改它们。

[http://dev.mysql.com/doc/refman/5.0/en/default-privileges.html](http://dev.mysql.com/doc/refman/5.0/en/default-privileges.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T03:29:27.177

我之前遇到过这个问题，你需要自己去配置文件中查找密码，因为phpMyAdmin的界面会对你隐藏密码。这很痛苦......不幸的是，我懒得自己安装它并找到适合你的确切位置。

# java - 如何组织游戏代码以适应 MVC 模式？

> ID：555283
> 
> 赞同：72
> 
> 时间：2009-02-17T01:59:04.210
> 
> 标签：java, oop, design-patterns, model-view-controller

我是一名大学新生，正在攻读计算机科学学位……过去几年我已经编写了很多程序，但最近我对组织代码、设计模式、语言差异等的理论思想有了更多的了解。

我有一个 Java 类，所以我放弃了 C++ 研究/开发，转而使用 Java 和 JOGL（Java OpenGL）。太棒了！但这无关紧要。

我想做一个小型角色扮演游戏，但这个问题确实适用于任何类型的游戏。您如何以结构化的方式组织游戏对象，例如模型-视图-控制器模式？它看起来是一个惊人的模式，使用非常广泛并且很有意义，但是我在弄清楚如何实现它时遇到了麻烦。

例如，我需要跟踪一个 GL 对象以绘制到屏幕上。我必须有实现 MouseListener、MouseMotionListener、MouseWheelListener 和 KeyListener 的类（或一个类，一个多合一的输入管理器）。而且我必须将我的游戏数据放在所有这些不同的类都可以访问和修改它的地方；如果有人按下键盘上的按钮，输入管理类需要以某种方式执行该键映射到的操作；当需要绘制框架时，图形类需要找到一种方法来循环遍历所有不同的“事物”并将它们全部绘制出来。

我最大的问题是图形用户界面；它与这一切有什么关系？它有点像输入，但不完全是，它需要从实际游戏模拟中设置和获取数据片段......而且更复杂的是，如果我决定尝试添加网络，它（类似于 GUI ) 还需要访问大量数据以进行修改和读取...

哦，我只是很困惑。我不知道如何让所有这些以面向对象的方式协同工作......编写明显符合模式的东西很容易，但是当你有大量发生的事情都与一个游戏循环相关时，相互修改还有游戏数据等等，……我什至都不知道了。也许我只是在做一个比实际更大的交易。

有没有其他人有这种感觉？请说明我的情况，这样我就可以花更少的时间担心和不知道从哪里开始！

编辑：找到一个很好的图表，可以帮助我弄清楚这一切......来源：（当心，PS文件！）[http://www.tucs.fi/publications/attachment.php?fname=TR553.ps.gz](http://www.tucs.fi/publications/attachment.php?fname=TR553.ps.gz)

Edit2：我也喜欢这个人对他如何计划他的 MVC 游戏的解释：http: [//interactivesection.wordpress.com/2007/11/19/dum-de-dum-drum-my-first-mvc-game-development/](http://interactivesection.wordpress.com/2007/11/19/dum-de-dum-drum-my-first-mvc-game-development/)

Edit3：另一篇很棒的文章！ [http://dewitters.koonsolo.com/gamemvc.html](http://dewitters.koonsolo.com/gamemvc.html)

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-17T05:00:41.013

将模型视为一种游戏 API 可能会对您有所帮助。如果游戏一开始就没有 UI，你的游戏会沦落到什么地步？你提到你想到的是一个角色扮演游戏，所以在这种情况下，你可以想象让玩家角色、他/她的库存、法术、能力、NPC，甚至地图和战斗规则之类的东西都成为模型的一部分. 这就像大富翁的规则和片段，没有最终游戏如何显示或用户将如何与之交互的细节。它就像 Quake 作为一组抽象的 3D 对象在一个关卡中移动，计算出交叉和碰撞等内容，但没有渲染、阴影或声音效果。

通过将所有这些都放入模型中，游戏本身现在与 UI 无关。它可以连接到像 Rogue 游戏那样的 ASCII 文本界面，或类似于 Zork 的命令行 UI，或基于 Web 或 3D UI。根据游戏机制，其中一些 UI 可能非常适合，但它们都是可能的。

View 层是 UI 依赖层。它反映了您所使用的 UI 的特定选择，并将非常专注于该技术。它可能负责读取模型的状态并以 3D、ASCII 或图像和网页的 HTML 格式绘制模型。它还负责显示玩家与游戏交互所需的任何控制机制。

控制器层是两者之间的粘合剂。它不应该包含任何实际的游戏逻辑，也不应该负责驱动 View 层。相反，它应该将视图层中的动作（点击按钮、点击屏幕区域、操纵杆动作等）转换为模型上的动作。例如，掉落物品、攻击 NPC 等等。它还负责收集数据并进行任何转换或处理，以使 View 层更容易显示它。

现在，我在上面描述的方式好像有一个非常独特的事件序列驱动游戏，这可能只适合网页游戏。那是因为这就是我最近花费的时间。在一个不受用户请求和服务器响应驱动的游戏中（例如，在用户机器上运行的游戏），您可能希望确保模型层很好地实现了观察者模式。例如，如果由于时间流逝而在模型中发生操作，那么您可能不希望视图层不断轮询模型以获取更新。相反，通过使用观察者模式，模型可以在模型对象发生变化时通知任何观察者。这又可以用来提示立即更新视图以反映更改。

然后，如果 60 秒过去导致玩家的基地发生了一些维修，基地可以进行维修并立即通知任何附属于它的观察者基地已经更新。视图可以作为观察者附加，并注意它需要重新显示基础，因为它的状态已经改变。通知本身可能包含足够的信息来更新视图，或者它可能必须转身并咨询模型才能更新，但结果将是相同的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-17T02:26:17.093

你在那里相处得很好。基本上，问自己一个问题“如果我必须更改程序的某些部分，哪些代码会更改？”

如果它会在不改变基本数据的情况下改变它的外观，那么它就在视图中。如果是可以通过多种方式查看的数据，那就是模型。如果这是你的演奏方式，那么它就是控制。

所以，如果你是用两把刀片还是一把刀片来画一把“斧头”，那就是视图。如果是你用斧头造成的生命值伤害，那就是模型。如果是通过键入“s”或右键单击来挥动斧头，它就是控制。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-17T06:18:42.057

我和你一样，我记得当我第一次发现 MVC 时，我试图把所有东西都塞进去。我确实制作了一个使用 MVC 模式的游戏。但我后来发现，我所做的太过分了。我试图将我创建的几乎每个类都归入 MVC 中的一个类别。

我的建议是阅读四人组的“设计模式”。除了 MVC，还有很多有用的模式。有时使用 MVC 根本没有任何意义。特别是对于游戏，我不确定 MVC 是否是个好主意。原因是您不想以多种不同的方式（视图）显示游戏对象，但您想为许多不同类型的游戏对象重用绘图代码。

对于我自己的 2D 游戏引擎，我非常积极地使用了**策略模式。**游戏对象，比如玩家和我称之为**Sprite**的怪物。我让精灵的绘制由*策略模式*处理。那是当我调用**sprite.draw()**时，我会做这样的事情：

```
class Sprite {
  void draw() {
    this.view.draw(this.currentPosition, this.currentOrientation);
  }

  Point  currentPosition;    // Current position of this sprite
  double currentOrientation; // Facing angle of sprite
}; 
```

这种方法的好处是您可以在多个精灵之间共享一个视图对象。因为通常会有很多看起来相同但位置不同并且可能表现不同的怪物。

所以行为我也会使用一个策略模式，它是一个包含描述行为的代码的对象。这样我就可以将相同的行为应用于不同位置的几个怪物。所以每一帧我都会调用一个**update()**函数来更新位置方向和怪物的作用。

```
class Sprite {
  void setUpdateAction(Action action) {
    this.updateAction = action;
  }

  void update(double start_time, double delta_time)
  {
    this.prevPosition = position();  
    advance(delta_time); // Advance to next position based on current speed and orientation

    this.updateAction.execute(this, start_time, delta_time);
  }

  Action updateAction;
}; 
```

这有很多变化。在我目前的实现中，我什至将**currentPosition**、**speed**、**orientation**和**advance()**分离到一个名为**MotionState**的单独对象中。这样我就可以在进行路径搜索算法时构建可能位置和方向的搜索树。然后我不想随身携带有关如何进行每次更新或如何绘制精灵的信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T02:26:53.987

集中用户交互逻辑的 MVC 概念是游戏开发的一个很好的模型。

我在 Flash 游戏开发方面做了一些工作。 [这](http://lab.polygonal.de/2008/06/18/using-object-pools/)是一篇关于 Flash 中的对象池的文章。这个概念是跨平台的，可能会给你一些想法。

您一次关注所有发生的事情是正确的。根据您的游戏设计，您的游戏循环可能需要处理很多事情。在这里您将学习所有肮脏的优化技巧，通常是艰难的：）

有很多方法可以组织您的代码 - 一种选择可能是将 GameManager 类编写为 Singleton。所有游戏对象都与它联系起来以进行管理和用户交互。GameManager 处理所有用户输入并将消息分派到其对象池。您可以使用接口来定义游戏对象和 GameManager 之间的通用通信模式。

就性能优化而言，线程非常强大。异步操作可以确保您不会浪费那些宝贵的周期。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T02:27:47.480

您所有的侦听器和处理程序都需要进入 Controller 类，屏幕上对象的状态（例如位置、颜色等）应该是您的模型类的一部分，并且在屏幕上绘制东西的任何代码都将是其中的一部分风景。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-16T08:24:13.633

我对 MVC 的看法是作为 MDUC
模型
显示
用户输入控制器

模型包含域模型对象
显示屏在屏幕上显示域模型对象的当前状态和行为。
用户输入控制器处理所有用户输入。

完全一样的模式，只是名字的描述性稍强一些，所以我发现模式的每个部分的职责更清晰，模式的含义也更容易记住。

一旦您看到您正在将数据和模型操作从显示中分离出来，从用户的输入中，您就可以更轻松地查看在您自己的代码中对哪些内容进行分组。

# c++ - 线程通信理论

> ID：555292
> 
> 赞同：7
> 
> 时间：2009-02-17T02:04:12.653
> 
> 标签：c++, c, multithreading, theory

线程通信背后的共同理论是什么？我对它应该如何工作有一些原始的想法，但有些东西对我来说并不好。有没有办法通过中断来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T02:08:36.340

实际上，它与*任何*并发问题相同：您有多个控制线程，并且不确定何时执行哪些线程上的哪些语句。这意味着程序中有大量的 POTENTIAL 执行路径，并且您的程序必须在所有这些路径下都是正确的。

通常，可能出现问题的地方是线程之间共享状态（过去称为“轻量级进程”）。当有共享内存区域时，就会发生这种情况，

为了确保正确性，您需要做的是确保以不会导致错误的方式更新这些数据区域。为此，您需要识别程序的“关键部分”，其中必须保证顺序操作。这些可以少到一条指令或一行代码；如果语言和架构确保这些是*原子*的，即不能被中断，那么你就是黄金。

否则，您将识别该部分，并在其上放置某种保护措施。经典的方法是使用*信号量*，它是一种原子语句，一次只允许一个控制线程过去。这些是由 Edsgar Dijkstra 发明的，因此有来自荷兰语、*P*和*V*的名称。当你来到*P*时，只有一个线程可以继续；所有其他线程都排队等待，直到执行线程到达关联的*V*操作。

因为这些原语有点原始，而且荷兰语的名称不是很直观，所以已经开发了一些更大规模的方法。

Per Brinch-Hansen 发明了*monitor*，它基本上只是一个数据结构，具有保证原子的操作；它们可以用信号量来实现。监视器几乎是 Java`synchronized`语句的基础。它们使对象或代码块具有特定的行为——也就是说，一次只能有一个线程“进入”它们——语法更简单。

还有其他可能的模式。Haskell 和 Erlang 通过函数式语言解决了这个问题，它们一旦创建就不允许修改变量；这意味着他们自然不需要担心同步问题。一些新的语言，比如 Clojure，有一个叫做“事务性内存”的结构，这基本上意味着当有*一个*赋值时，你可以保证这个赋值是原子的和可逆的。

简而言之就是这样。要真正了解它，查看操作系统文本的最佳位置，例如[Andy Tannenbaum 的文本](https://rads.stackoverflow.com/amzn/click/com/0136006639)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T02:23:43.963

线程通信最常见的两种机制是共享状态和[消息传递](http://lambda-the-ultimate.org/node/193)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T02:11:38.797

线程最常见的通信方式是通过一些共享数据结构，通常是队列。一些线程将信息放入队列，而另一些则将其取出。队列必须受到操作系统设施的保护，例如互斥锁和信号量。中断与它无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T02:12:34.957

要在线程之间进行通信，您需要使用操作系统和/或运行时提供的任何机制。中断将异常低级别，尽管如果您的线程使用套接字或命名管道进行通信，它们可能会被隐式使用。

一种常见的模式是使用共享内存块来实现共享状态，依靠操作系统提供的同步原语（例如互斥锁）来避免您在从块中读取时忙于等待。请记住，如果您有线程，那么您必须已经有某种调度程序（无论它是来自操作系统的本机还是在您的语言运行时中模拟）。所以这个调度器可以提供同步对象和“睡眠”功能，而不必依赖硬件支持。

套接字、管道和共享内存也在进程之间工作。有时，运行时会为您提供一种更轻量级的方式来为同一进程中的线程进行同步。共享内存在单个进程中更便宜。有时你的运行时也会给你一个原子的消息传递机制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T02:22:30.003

如果您真的对线程通信*理论*感兴趣，您可能需要研究像[pi Calculus](http://en.wikipedia.org/wiki/Pi-calculus)这样的形式。

# sql - 在表中查找双向连接

> ID：555296
> 
> 赞同：1
> 
> 时间：2009-02-17T02:06:57.950
> 
> 标签：sql

我有以下 SQL 结果集（作为加入 FWIW 的结果）：

```
A,C
B,E
C,A
D,A 
```

每个值代表一个节点。所以所涉及的总节点集是 A,B,C,D,E。每行描述一个有向边。

```
A -> C
B -> E
C -> A
D -> A 
```

当然这可以简化为

```
A <-> C
B -> E
D -> A 
```

现在我想过滤掉没有双向对应的行。所以最终的结果集应该是

```
A,C
C,A 
```

或者

```
A,C 
```

在这种情况下。

我正在寻找用 SQL 表达这一点的最佳方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T02:11:42.307

想象一下具有 Node1 和 Node2 列的节点表。

```
SELECT node1, node2
FROM nodes n
WHERE EXISTS (SELECT 1 FROM nodes WHERE node1 = n.node2 AND node2 = n.node1) 
```

当然，您需要确保其适当的索引，即：

```
(node1, node2) 
```

和

```
(node2, node1) 
```

这仍然会让你获得 A、C 和 C、A。要过滤掉这些，请将查询更改为：

```
SELECT node1, node2
FROM nodes n
WHERE EXISTS (SELECT 1 FROM nodes WHERE node1 = n.node2 AND node2 = n.node1)
AND node1 < node2 
```

假设您可以利用自然顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T02:17:21.873

```
 -- Temp table creating to insert example rows
SELECT 
'A' AS Col1, 'C' AS Col2
INTO #TEMP
UNION
SELECT 'B', 'E'
UNION
SELECT 'C', 'A'
UNION
SELECT 'D', 'A'

SELECT A.* FROM #TEMP A, #TEMP B
WHERE (A.COL1 = B.COL2 AND A.COL2 = B.COL1) 

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T02:27:08.650

将节点对内部连接到自己？

```
select node1, node2
from nodes n
inner join nodes n2
on n.node1 = n2.node2 and n.node2 = n2.node1 
```

（用您的子查询替换“节点”）

# objective-c - Objective-C 相当于 Ruby 的#define_method？

> ID：555298
> 
> 赞同：2
> 
> 时间：2009-02-17T02:07:17.950
> 
> 标签：objective-c

是否可以像在 Ruby 中那样在 Objective-C 中动态定义方法？

```
[:failure, :error, :success].each do |method|
 define_method method do
    self.state = method
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T08:44:35.170

实际上可以做到这一点，尽管 obj-c 语法不支持它，但 obj-c 运行时提供了可以做到这一点的函数。你想要的是`class_addMethod`，但在我脑海中，我不记得确切的细节。所有运行时方法都记录在[developer.apple.com](http://developer.apple.com)

对于它的地狱，我撞了一个非常简单的例子

```
#import <objc/objc-class.h>

@interface MyClass : NSObject {
}
@end

@implementation MyClass
@end

id myMethod(id self, SEL cmd, NSString* message)
{
    NSLog(message);
    return nil;
}

int main(int argc, char *argv[])
{

    class_addMethod([MyClass class], @selector(newMethod:), (IMP)myMethod, "v@:#");
    [[[MyClass alloc] init] newMethod:@"Hello World"];
    return 0;
} 
```

现在严格来说，我认为`myMethod`应该是可变参数，而且恰好可以按照我在 x86 上的方式进行操作，并且可能会在 ppc 上失败——但我可能是错的。

哦[，这是糟糕的类型编码文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/chapter_7_section_1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T02:35:20.877

我不相信这是可能的，因为 Objective C 毕竟是一种编译语言。您的“定义方法”必须将方法添加到表中并有办法在运行时编译该方法。

# actionscript-3 - 在 Flash 中更改符号上的文本

> ID：555304
> 
> 赞同：0
> 
> 时间：2009-02-17T02:08:24.483
> 
> 标签：actionscript-3, actionscript-2, flash-cs3

我试图通过让用户按下一个指定的符号来更改几个符号上的文本！我不在乎它是使用 flash 2.0 还是 3.0，我做了一个菜单栏，如果特别按下了符号，我想更改符号上的文本！我尝试了我能想到的一切，并期望它相当容易！我肯定错过了什么 ！

当用户按下符号代码时，将执行更改所有其他按钮上的文本！

必须不止 my_symbol.text="text I want";
是否有 sub_scene.scene.instance_name.text 或我缺少的东西？

谢谢

皮特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T18:59:57.983

这个问题很模糊，但无论如何您都需要定位 textField 而不是符号：

```
myMovieClip.myTextField.text = "Changed" 
```

如果这不起作用，首先要检查的是容器的实例是否可以从您的脚本自己的范围访问：

```
trace(myMovieClip); 
```

# apache-flex - 我应该分支到 Flex 还是 Flash？

> ID：555306
> 
> 赞同：2
> 
> 时间：2009-02-17T02:08:48.570
> 
> 标签：apache-flex, flash

我是一名 C# 开发人员，希望拓展业务。我想尝试使用 flex 或 flash。有什么建议可以使用，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T02:37:45.520

Flex 是一个用于富 Internet 应用程序开发的框架。它使用 UI、数据等的控件和命名空间扩展了 Flash。

如果您想冒险走出自己*的*舒适区，请尝试使用 Flex。如果您曾经使用过 WPF，它会感觉很熟悉。如果您想变得非常狂野和疯狂，请添加 Flash。您可以将 Flash 资源与 Flex 项目相结合，以创建一些视觉上令人兴奋的应用程序。值得对两者进行试验，以了解他们可以一起做什么，这是相当多的。Flex Builder 对于 Flex 和 ActionScript 项目都是一个很好的工具。

我鼓励您也尝试使用 Silverlight，因为您已经拥有 C#。这两个平台都有很多东西可以提供。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T02:21:53.717

银光！:D

说真的，如果您已经了解 C#，并且希望将其用于富 Internet 应用程序，那么这是您最好的选择。

也就是说，如果您想要一种对程序员友好的非 C# 做事方式，我建议您使用 Flex 而不是 Flash。闪电是……*不寒而栗*。

[此链接](http://www.scottklarr.com/topic/39/adobe-air-vs-flash-vs-flex-vs-microsoft-silverlight/)可能会帮助您做出决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T02:35:04.467

我必须同意 Dr. Dredel。在闪存中访问数据库和其他服务器端的东西真的很难（并非不可能）。我在高中参加了 Flash 课程，这是我计算机生活中最糟糕的 18 周。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T05:43:26.417

你们忘记了 98% 的计算机都安装了 Flash，而甚至比尔盖茨本人都不知道有多少台计算机安装了 Silverlight。在决定在哪个平台上进行实验时，您应该牢记您的受众。另外，请记住 linux 不支持 Silverlight。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T02:32:24.393

我认为与您的问题的一个很好的类比是“我正在考虑尝试新事物，我应该学习如何烘焙或交际舞吗？”

Flash 主要是一个客户端构建的东西。它有很多花里胡哨的东西，但归根结底，你所构建的 98% 都是在客户端上显示内容，而不是在服务器上运行。

flex 在某种程度上是 JSP 之类的替代品。

商业上对 Flash 有很多需求，而 Flex 才刚刚起步。因此，这可能会在一定程度上影响您的决策。

# jquery - Jquery检查ajax post的成功

> ID：555315
> 
> 赞同：67
> 
> 时间：2009-02-17T02:15:19.833
> 
> 标签：jquery

我如何定义 ajax $.post 的成功和失败函数？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-02-17T02:17:44.057

文档在这里：[http ://docs.jquery.com/Ajax/jQuery.ajax](http://docs.jquery.com/Ajax/jQuery.ajax)

但是，总而言之，ajax 调用有很多选项。您正在寻找的是错误和成功。

你可以这样称呼它：

```
$.ajax({
  url: 'mypage.html',
  success: function(){
    alert('success');
  },
  error: function(){
    alert('failure');
  }
}); 
```

我已经展示了不带参数的成功和错误函数，但它们可以接收参数。

错误函数可以采用三个参数：XMLHttpRequest、textStatus 和 errorThrown。

成功函数可以接受两个参数：data 和 textStatus。您请求的页面将在 data 参数中。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-02-17T02:25:31.073

如果需要失败函数，则不能使用 $.get 或 $.post 函数；您将需要直接调用 $.ajax 函数。您传递一个可以具有“成功”和“错误”回调的选项对象。

而不是这个：

```
$.post("/post/url.php", parameters, successFunction); 
```

你会用这个：

```
$.ajax({
    url: "/post/url.php",
    type: "POST",
    data: parameters,
    success: successFunction,
    error: errorFunction
}); 
```

还有很多其他选择。[该文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)列出了所有可用的选项。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-07-20T19:57:36.037

使用 jQuery 1.8 及更高版本，应使用以下内容：

```
var request = $.ajax({
    type: 'POST',
    url: 'mmm.php',
    data: { abc: "abcdefghijklmnopqrstuvwxyz" } })
    .done(function(data) { alert("success"+data.slice(0, 100)); })
    .fail(function() { alert("error"); })
    .always(function() { alert("complete"); }); 
```

查看@hitautodestruct 所述的文档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-05T17:59:28.480

我想知道，为什么他们没有在 jquery 本身中提供，所以我在 jquery 文件中做了一些更改，，这里是更改后的代码块：

原始代码块：

```
 post: function( url, data, callback, type ) {
    // shift arguments if data argument was omited
    if ( jQuery.isFunction( data ) ) {
        type = type || callback;
        callback = data;
        data = {};
    }

    return jQuery.ajax({
        type: "POST",
        url: url,
        data: data,
        success: callback,
        dataType: type
    }); 
```

更改代码块：

```
 post: function (url, data, callback, failcallback, type) {
        if (type === undefined || type === null) {
            if (!jQuery.isFunction(failcallback)) { 
            type=failcallback
        }
        else if (!jQuery.isFunction(callback)) {
            type = callback
        }
        }
        if (jQuery.isFunction(data) && jQuery.isFunction(callback)) {
            failcallback = callback;

        }
        // shift arguments if data argument was omited
        if (jQuery.isFunction(data)) {
            type = type || callback;
            callback = data;
            data = {};

        }

        return jQuery.ajax({
            type: "POST",
            url: url,
            data: data,
            success: callback,
            error:failcallback,
            dataType: type
        });
    }, 
```

这应该有助于试图在 jquery 中捕获 $.Post 错误的人。

更新：或者还有另一种方法是：

```
 $.post(url,{},function(res){
        //To do write if call is successful
   }).error(function(p1,p2,p3){
             //To do Write if call is failed
          }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-26T07:03:30.810

这种风格也是可以的：

```
$.get("mypage.html")
    .done(function(result){
        alert("done. read "+result.length+" characters.");
    })
    .fail(function(jqXHR, textStatus, errorThrown){
        alert("fail. status: "+textStatus);
    }) 
```

# c# - Linq 返回 IEnumerable ，如何返回 MyListObject 呢？

> ID：555320
> 
> 赞同：1
> 
> 时间：2009-02-17T02:20:17.513
> 
> 标签：c#, .net, linq

有没有办法不循环所有 IEnumerable 来取回对象内部的数据（继承的 BindingList）？

```
MyListObject--> Transformed with Linq --> Back the data inside MyListObject 
```

我知道我可以做 .ToList 但它没有做我想做的事。

任何的想法？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T03:12:50.710

一种选择是通过使用/添加将 IEnumerable 作为 CStick 建议的构造函数，将返回的 IEnumerable 包装到您的集合类型中。也许更优雅的方法是为 IEnumerable 类型添加一个扩展方法，该方法将返回您的集合：

```
static MyListObject ToMyList(this IEnumerable<T> en) {
  // construct your MyListObject from 'en' somehow
}

// And then just write:
var mylist = (from c in ... ).ToMyList() 
```

对于这个简单的场景，最后一个可能过于复杂的选项是为您的类型实现所有 LINQ 查询运算符（扩展方法 Where、Select 和许多其他方法）。好处是您可以（也许）更有效地做一些事情，但这确实有点困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T10:37:00.627

我不确定您的确切要求是什么，尤其是关于`ToList`不做您需要的事情。

不幸的是，`BindingList<T>`它只在其构造函数中接受一个`IList<T>`参数，而不是一个`IEnumerable<T>`.

但是，如果您在自定义集合上实现传递构造函数（或者如果它已经有一个构造函数`IList<T>`），那么您可以执行类似的操作：

```
public class MyListObject<T> : BindingList<T>
{
    public MyListObject() : base() { }
    public MyListObject(IList<T> list) : base(list) { }
}

// ...

MyListObject<int> yourList = new MyListObject<int> { 1, 2, 3, 4, 5 };
yourList = new MyListObject<int>(yourList.Select(s => s * 2).ToList());
// yourList now contains 2, 4, 6, 8, 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T02:52:11.210

大多数列表在构造函数中接受一系列对象。那会奏效吗？

```
Dim objects = 'Linq statement returning IEnumberable array.
Dim mlo As New MyListObject(objects) 
```

# wpf - 如何使调整 WPF 窗口的大小不那么“滞后”？

> ID：555326
> 
> 赞同：6
> 
> 时间：2009-02-17T02:22:43.980
> 
> 标签：wpf, xaml, optimization, resize, window

我在 WPF 世界中相对较新，我立即注意到的一件事是，当您调整窗口大小时，窗口内容的绘制有多么滞后。例如，如果您在窗口边缘有滚动条，则这些滚动条在缩小时将部分隐藏，而在放大时它们与窗口边框之间有空间。

这甚至发生在 Visual Studio 中创建的空 WPF 项目中。更糟糕的是，它也发生在背景上，你可以看到窗口后面的东西（其他窗口、桌面壁纸等）在放大时会漏出。

起初，我认为看到原生或 WinForms 应用程序大小调整得很好（如果编写得当），这是 WPF 的一个丑陋限制。但是当我查看 Expression Blend 时，窗口背景保持不透明（尽管窗口内容仍然滞后）。他们做了什么来防止所描述的问题，有什么方法可以改进调整大小以更接近本机/WinForm GUI？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-20T03:53:35.117

滞后的原因在[这里得到了很好的解释](https://stackoverflow.com/questions/1406244/wpf-layout-on-a-window/1412125#1412125)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T02:43:38.767

您是否在没有 SP1 的情况下运行 Vista？根据我的阅读，这是一个应该已解决的常见问题。

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/3960d6a6-e873-455c-9ddc-1e2dd32e090b/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/3960d6a6-e873-455c-9ddc-1e2dd32e090b/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T15:24:26.650

我也一直在寻找有关此问题的信息。我只是认为这是一些勇敢的微软程序员认为很酷的 Windows“功能”。我希望能够将其关闭，以便窗口大小调整实际上会跟随我的鼠标，而不是滞后然后过冲。Grr。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T01:51:09.680

我自己没有看到这种行为。我在 vista x64 sp1 和/或运行 xp x32 sp3 的虚拟 PC 上开发。wpf使用directx，它可能是你的视频卡/机器吗？尝试在差异机器上运行您的应用程序，看看是否有相同的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-20T03:02:49.443

调整大小时界面滞后，我也有同样的问题。我怀疑滞后的原因是它在直接 X 中调整底层帧缓冲区的大小，这从来都不是特别快。我不确定你能做些什么。

# c++ - 检查有效图像

> ID：555327
> 
> 赞同：1
> 
> 时间：2009-02-17T02:23:07.553
> 
> 标签：c++, image

我正在编写一个从网络下载信息的程序，其中一部分是图像。

目前我遇到了一个问题，因为下载图像的代码与显示它们的代码不同（在 mvc 下）。如果发出 404 或图像下载以某种方式失败，则显示代码会弹出一条我想避免的消息提示。

有没有一种简单的方法来检查图像是否有效？我只关心jpg、gif和png。

注意：我不关心读取图像数据，只是检查它是否是有效的图像格式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T02:34:05.373

是否要检查下载是否成功？或者您想检查下载的内容是否实际上是图像？

在前一种情况下，唯一的检查方法是尝试访问它，看看你得到了什么样的 HTTP 响应代码。您可以发送 HTTP`HEAD`请求以获取响应代码而无需实际下载图像，但如果您只是继续下载图像（如果成功），那么发送单独的`HEAD`请求似乎是浪费时间（并且带宽）。

或者，如果您真的想检查您正在下载的是一个有效的图像文件，您必须阅读整个文件以检查它是否损坏。但是如果你只是想检查文件扩展名是否准确，检查文件的前几个字节应该足够了。所有 GIF 图像都以 ASCII 文本开头`GIF87`或`GIF89`取决于使用的 GIF 规范。PNG 图像以 ASCII 文本开头`PNG`，而 JPEG 图像有一些幻数，这似乎是`0xd8ffe0ff`基于我查看的 JPEG。（你应该做一些研究并检查一下，尝试维基百科的链接）但是请记住，即使要获取图像的前几个字节，你也需要发送一个可能返回 404 的 HTTP 请求（并且在那个如果您没有要检查的图像）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T02:45:02.617

谢谢你们的答案。我已经准备好下载文件，所以我只检查了幻数，因为我使用的前端（wxWidgets）都准备好了图像库，我想要一些非常轻的东西。

```
uint8 UTIL_isValidImage(const unsigned char h[5])
{

    //GIF8
    if (h[0] == 71 && h[1] == 73 && h[2] == 70 && h[3] == 56)
        return IMAGE_GIF;

    //89 PNG
    if (h[0] == 137 && h[1] == 80 && h[2] == 78 && h[3] == 71)
        return IMAGE_PNG;

    //FFD8
    if (h[0] == 255 && h[1] == 216)
        return IMAGE_JPG;

    return IMAGE_VOID;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T02:35:24.543

如果您真的想知道图像文件是否有效，您实际上必须对其进行解码（尽管您不需要存储这些位）。这是因为文件的大小可能不正确或可能已损坏。

如果您使用 HTTP 库进行下载，您应该能够检查标头并知道您收到的是 404 错误，而不是真正的有效负载。查看您正在使用的库的文档。

如果您要取回一个文件，并且您想查看它是否可能是一个没有完全解码的图像，那么您至少需要检查标题的有效性。 [libpng](http://www.libpng.org/pub/png/libpng.html)和[libjpeg](http://www.ijg.org/)分别提供对 png 和 jpeg 文件的低级访问。您还可以查看更高级别的库，例如[ImageMagick](http://www.imagemagick.org/script/index.php)、Microsoft 的 MFC 或任何最适合您的平台的库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T02:51:21.337

当您`GET`通过 HTTP 获取资源时，您必须使用`Content-Type`标头来确定如何处理内容。如果您已经将其下载到本地文件，则真正的 Web 浏览器所依赖的信息已经丢失。在许多情况下，URL 将匹配 Content-Type（例如`http://example.com/image.png`提供为`Content-Type: image/png`）。但是，您不能依赖于此。

# c++ - 模板：使用前向声明来减少编译时间？

> ID：555330
> 
> 赞同：27
> 
> 时间：2009-02-17T02:23:55.397
> 
> 标签：c++, templates, linker, compilation, forward-declaration

我必须处理一个由许多模板类组成的库，这些类当然都是在头文件中实现的。现在我试图找到一种方法来减少无法忍受的长编译时间，因为我几乎必须将整个库包含在我的每个编译单元中。

尽管有模板，但是否有可能使用前向声明？我正在尝试按照下面示例的方式进行操作，例如，我试图绕过`#include <vector>`, 但它给了我一个链接器错误，因为`push_back`它是未定义的。

```
#include <iostream>

namespace std {
  template<class T>
  class vector {
  public:
    void push_back(const T& t);
  };
}

int main(int argc, char** argv) {
  std::vector<int>* vec = new std::vector<int>();
  vec->push_back(3);
  delete vec;
  return EXIT_SUCCESS;
}

$ g++ fwddecl.cpp
ccuqbCmp.o(.text+0x140): In function `main':
: undefined reference to `std::vector<int>::push_back(int const&)'
collect2: ld returned 1 exit status 
```

我曾经尝试过预编译的头文件，但这根本没有改变编译时间（我确实确保它们确实被加载而不是真正的头文件）。但是如果你们都说预编译的头文件应该是要走的路，那么我会再试一次。

**更新：**有些人说前向声明 STL 类是不值得的。我要强调的是，`vector`上面的 STL 只是一个例子。我并没有真正尝试前向声明 STL 类，但它是关于我必须使用的某些库的其他大量模板化的类。

**更新2：**有没有办法让上面的例子真正编译和链接正确？洛根建议使用`-fno-implicit-templates`并放在`template class std::vector<int>`某个地方，大概是一个单独的`.cpp`文件，用 . 编译`-fno-implicit-templates`，但我仍然得到链接器错误。同样，我试图了解它是如何工作的，`std::vector`以便我可以将它应用到我实际使用的模板类中。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-17T02:31:02.150

您不能像这样转发声明类的“部分”。即使可以，您仍然需要在某处实例化代码，以便您可以链接它。有一些方法可以处理它，你可以让自己成为一个带有公共容器（例如vector）实例化的小库并将它们链接起来。然后你只需要编译一次，例如vector<int>。要实现这一点，您需要使用类似的东西`-fno-implicit-templates`，至少假设您坚持使用 g++ 并使用`template class std::vector<int>`

* * *

所以，一个真实的工作示例。这里我有 2 个文件，a.cp​​p 和 b.cpp

一个.cpp：

```
#include <vector> // still need to know the interface
#include <cstdlib>

int main(int argc, char **argv) {
  std::vector<int>* vec = new std::vector<int>();
  vec->push_back(3);
  delete vec;
  return EXIT_SUCCESS;
} 
```

所以现在我可以编译 a.cpp 了`-fno-implicit-templates`：

```
g++ -fno-implicit-templates -c a.cpp 
```

这会给我 ao 如果我然后我尝试链接 ao 我得到：

```
g++ a.o
/usr/bin/ld: Undefined symbols:
std::vector<int, std::allocator<int> >::_M_insert_aux(__gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, int const&)
void std::_Destroy<int*, std::allocator<int> >(int*, int*, std::allocator<int>)
collect2: ld returned 1 exit status 
```

不好。所以我们转向b.cpp：

```
#include <vector>
template class std::vector<int>;
template void std::_Destroy(int*,int*, std::allocator<int>);
template void std::__uninitialized_fill_n_a(__gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, unsigned long, int const&, std::allocator<int>);
template void std::__uninitialized_fill_n_a(int*, unsigned long, int const&, std::allocator<int>);
template void std::fill(__gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, __gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, int const&);
template __gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > > std::fill_n(__gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, unsigned long, int const&);
template int* std::fill_n(int*, unsigned long, int const&);
template void std::_Destroy(__gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, __gnu_cxx::__normal_iterator<int*, std::vector<int, std::allocator<int> > >, std::allocator<int>); 
```

现在你对自己说，所有这些额外的模板东西是从哪里来的？我看到了`template class std::vector<int>`，那很好，但是其余的呢？简短的回答是，这些东西的实现必然有点混乱，当你手动实例化它们时，这些混乱的一部分会泄露出来。您可能想知道我是如何弄清楚我需要实例化什么的。好吧，我使用了链接器错误；）。

所以现在我们编译 b.cpp

```
g++ -fno-implicit-templates -c b.cpp 
```

我们得到 bo 连接 ao 和 bo 我们可以得到

```
g++ a.o b.o 
```

万岁，没有链接器错误。

因此，要了解有关您更新的问题的一些详细信息，如果这是一门自酿课程，则不一定要如此混乱。例如，您可以将接口与实现分开，例如，除了 a.cpp 和 b.cpp 之外，我们还有 ch、c.cpp

ch

```
template<typename T>
class MyExample {
  T m_t;
  MyExample(const T& t);
  T get();
  void set(const T& t);
}; 
```

cpp

```
template<typename T>
MyExample<T>::MyExample(const T& t) : m_t(t) {}
template<typename T>
T MyExample<T>::get() { return m_t; }
template<typename T>
void MyExample<T>::set(const T& t) { m_t = t; } 
```

a.cpp

```
 #include "c.h" // only need interface
 #include <iostream>
 int main() {
   MyExample<int> x(10);
   std::cout << x.get() << std::endl;
   x.set( 9 );
   std::cout << x.get() << std::endl;
   return EXIT_SUCCESS;
 } 
```

b.cpp，“库”：

```
 #include "c.h" // need interface
 #include "c.cpp" // need implementation to actually instantiate it
 template class MyExample<int>; 
```

现在您将 b.cpp 编译为 bo 一次。当 a.cpp 更改时，您只需要重新编译它并链接到 bo

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-17T03:35:56.223

前向声明让您可以这样做：

```
template <class T> class vector; 
```

然后，您可以在不定义向量的情况下声明对的引用和指针`vector<whatever>`（不包括`vector`的头文件）。这与常规（非模板）类的前向声明相同。

特别是模板的问题在于，您通常不仅需要类声明，还需要头文件中的所有方法定义（以便编译器可以实例化所需的模板）。显式模板实例化（您可以强制使用 with `-fno-implicit-templates`）是一种解决方法；您可以将方法定义放在源文件中（或者，按照[Google Style Guide](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#The_-inl.h_Files)的示例，放在`-inl.h`您不必包含的头文件中），然后像这样显式实例化它们：

```
template <class int> class vector; 
```

请注意，您实际上并不需要`-fno-implicit-templates`从中受益；编译器将默默地避免实例化它没有定义的任何模板，假设链接器稍后会解决它。并且添加`-fno-implicit-templates`会使*所有*模板的使用变得更加困难（不仅仅是耗时的模板），所以我不推荐它。

您的示例代码的问题是您没有转发声明真正的`std::vector`类。通过不包括`<vector>`，您正在创建自己的非标准`vector`类，并且您从未定义`push_back`，因此编译器无需实例化。

我使用预编译的头文件效果很好；我不确定他们为什么不帮助你。您将所有不变的头文件放在一个单独的文件中`all.h`，对其进行预编译，并使用已加载的`strace`或类似的文件进行验证，`all.h.pch`而单个头文件不是？（如何使用`strace`：而不是运行`g++ mytest.cc`，运行`strace -o strace.out g++ mytest.cc`，然后`strace.out`在文本编辑器中查看并搜索`open(`调用以查看正在读取哪些文件。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-17T02:33:53.393

使用前向声明，您只能将成员或参数声明为该类型的指针或引用。您不能使用任何方法或其他需要所述类型的内脏的东西。也就是说，我发现前向声明在尝试加快编译时间时确实受到限制。我建议您进一步研究预编译头文件的可能性，因为我发现它们确实有助于缩短编译时间，尽管这是在 Windows 上使用 Visual C++ 而不是 g++。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T02:32:26.673

这`<iosfwd>`将为您提供 iostream 类的一些前向声明，但一般而言，在前向声明它们方面，您对 stl 模板无能为力。

预编译的标头是要走的路。第一次编译它们时您不会注意到任何速度增加，但是每次修改预编译头（或其中包含的任何内容）时，您应该只支付一次该价格。

有关加快编译的其他想法，[请参阅此问题。](https://stackoverflow.com/questions/373142/what-techniques-can-be-used-to-speed-up-c-compilation-times/373179)

# sql - 棘手的 SQL 查询

> ID：555331
> 
> 赞同：1
> 
> 时间：2009-02-17T02:25:15.690
> 
> 标签：sql

所以我有这张表，有 3 列：ID（唯一键）、PositionID 和 SupervisorID。PositionID 和 SupervisorID 都是 Positions 表的外键。

我无法弄清楚的是获得*继承*下属的一种不错的方式。例如：

* * *

**ID** **PositionID** **SupervisorID**

```
1     2           1

2     2           3

3     3           4

4     1           5
... 
```

我如何根据它们对 1 的从属位置来选择 2,3 和 4。目前的解决方案是一种相当混乱的方法，而且它似乎是一个很常见的问题，也许有一种可以接受的方法。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T02:36:48.567

递归公用表表达式：http: [//msdn.microsoft.com/en-us/library/ms186243.aspx](http://msdn.microsoft.com/en-us/library/ms186243.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T03:57:04.300

你可以试试：

```
 WITH HierarchyCTE (ID, PositionID, SupervisorID)
    AS
    (
      SELECT ID, PositionID, SupervisorID
        FROM SomeTable
        WHERE ID = 1
      UNION ALL
      SELECT b.ID, b.PositionID, b.SupervisorID
        FROM SomeTable AS b
        INNER JOIN HierarchyCTE AS c ON b.ID = c.PositionID 
    )
    SELECT ID, PositionID, SupervisorID FROM HierarchyCTE 
```

或类似的东西应该可以工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T03:14:17.820

如果您有 Microsoft SQL Server 2008，您应该查看[HierarchyId](http://technet.microsoft.com/en-us/library/bb677290.aspx "层次 ID")数据类型。我认为这正是您正在寻找的。没有这种类型你可以做到，但你必须听其他人的意见。;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T02:30:42.090

您可以使用标准 SQL 达到一定的深度（也可能使用各种 SQL 增强的任何深度），但是 SQL 语句将是来自撒旦自己地狱深处的可怕可憎。

SQL 是一种关系代数，而不是一个程序模型。说真的，为此使用代码（即使它是存储过程或 PL/SQL），它会让你的 SQL 更漂亮，让你的 DBA 和未来的维护者更快乐，让你的生活更长久、更繁荣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T03:42:49.407

我已经写了查询来做这件事并分解物料清单。我在 while 循环中使用了一个查询，该查询选择了一个临时表和递归公用表表达式。据我所知，这些是不使用递归函数/sproc 的唯一方法——在生产数据库中（在我看来）由于各种原因（首先因为 sql server 被限制为 16 个级别），这是不行的默认）。如果需要，我可以发布代码。

# iphone - 如何每 x 毫秒在我的视图控制器中执行一个方法？

> ID：555335
> 
> 赞同：3
> 
> 时间：2009-02-17T02:26:06.547
> 
> 标签：iphone, cocoa-touch

如何每 x 毫秒在我的视图控制器中执行一个方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T02:35:01.517

创建一个计时器，将您的视图和函数作为要调用的参数。或者，您可以将 NSInvocation 与 NSTimer 一起使用。

例如

```
[NSTimer scheduledTimerWithTimeInterval:0.1f target:myView selector:@selector(myMethod) userInfo:nil repeats:YES]; 
```

# .net - File.Copy() 从网络共享到同一台机器上的另一个共享是否通过网络复制文件？

> ID：555341
> 
> 赞同：14
> 
> 时间：2009-02-17T02:28:02.220
> 
> 标签：.net, windows, networking

如果我的 .NET 客户端使用**System.IO.File.Copy**将文件从**\server1\share1\file1.txt**复制到**\sever1\share2\file2.txt**，文件的数据是否会被读取到客户端然后写回到服务器？如果是，.NET 客户端是否可以将服务器上的文件复制到同一服务器上的另一个位置，而无需往返文件？如果目标共享与源共享相同，是否会有所不同？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T02:43:05.850

是的，它确实。我可以根据在机器之间复制 10 GB Zip 文件的个人经验来这么说。“客户端”机器与其他两台机器位于美国的不同海岸。在两台机器之间直接从其中一台机器上花费了相当长的时间。尝试从另一个海岸的机器上启动副本花了大约 10 个小时:(

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-17T14:17:48.937

这是一个老问题，但我认为这里没有正确的答案。

实际上有 2 个问题（3 个问题，但第 3 个问题是多余的）。

第一个问题是，如果在（第 3 台）客户端计算机上运行的 .Net 进程将文件从一个网络共享复制到另一个网络共享，如果源共享和目标共享位于同一台计算机上（不同于客户端），是否会有所不同？ ) 与 2 台不同的计算机？答案显然不是。网络共享之间没有机制，也没有秘密隧道。数据必须先传输到客户端，然后再传输到另一个共享。如果操作是复制或移动，则没有区别，如果共享与客户端位于同一台计算机上，则实际上没有区别（并且您确实使用 UNC 路径作为网络共享访问文件夹，而不是作为本地文件夹）。

第二个问题是，如何避免这种往返？以下是一些建议：

1.  如果源和目标在同一个共享上，则移动文件不需要往返，因为操作系统只更新文件系统中的引用。
2.  在具有源共享或目标共享的计算机上运行的进程可以执行复制，而无需往返客户端。如果任一主机运行 Linux，则此过程可以是远程复制等。在 Windows 主机上，您可以安装 WCF 服务，当请求从客户端到达时复制文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T02:43:44.710

文件内容必须通过执行复制操作的机器。解决此问题的唯一方法是在目标机器上运行程序，这些程序在中间没有客户端机器的情况下执行传输。例如使用 FTP 将服务器传输到服务器的[FXP 。](http://en.wikipedia.org/wiki/File_eXchange_Protocol)
但是，打开此路径也可能会打开一个安全漏洞，我怀疑许多管理员不愿意允许这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T02:31:08.877

这是一个很好的问题——我似乎找不到任何明确的答案，所以也许最好的办法是启动[Wireshark](http://www.wireshark.org/)进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T07:28:10.690

如果可以移动而不是复制，那应该立即发生。否则，您需要在目标机器上放置一个服务，以便您可以远程调用它。

# python - 在字符串末尾匹配一系列（非嵌套）平衡括号

> ID：555344
> 
> 赞同：3
> 
> 时间：2009-02-17T02:29:03.717
> 
> 标签：python, regex

如何匹配出现在字符串末尾的一个或多个括号表达式？

输入：

```
'hello (i) (m:foo)' 
```

期望的输出：

```
['i', 'm:foo'] 
```

用于 python 脚本。括号不能出现在彼此内部（[没有嵌套](http://i89.photobucket.com/albums/k220/kipper_308/fran_web.jpg)），括号表达式可以用空格分隔。

这比乍看起来要难，至少在我看来是这样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T03:02:58.097

```
paren_pattern = re.compile(r"\(([^()]*)\)(?=(?:\s*\([^()]*\))*\s*$)")

def getParens(s):
  return paren_pattern.findall(s) 
```

甚至更短：

```
getParens = re.compile(r"\(([^()]*)\)(?=(?:\s*\([^()]*\))*\s*$)").findall 
```

解释：

```
\(                     # opening paren
([^()]*)               # content, captured into group 1
\)                     # closing paren
(?=                    # look ahead for...
  (?:\s*\([^()]*\))*   #   a series of parens, separated by whitespace
  \s*                  #   possibly more whitespace after
  $                    #   end of string
)                      # end of look ahead 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T02:40:33.737

您*不需要*使用正则表达式：

```
def splitter(input):
    return [ s.rstrip(" \t)") for s in input.split("(") ][1:]
print splitter('hello (i) (m:foo)') 
```

**注意：**此解决方案仅在您的输入已知有效时才有效。请参阅适用于任何输入的 MizardX 解决方案。

# java - Java 的 3D 场景图库？

> ID：555347
> 
> 赞同：7
> 
> 时间：2009-02-17T02:30:50.733
> 
> 标签：java, 3d, scenegraph

我正在寻找一个可靠的 Java 3D 场景图 API，它具有良好的文档、活跃的社区和允许商业使用的许可证。

我排除了[com.sun.scenegraph](https://scenegraph.dev.java.net/)，因为它是 GPL（并且似乎已经死了），因为这篇文章而排除了 Java3D，因为[这篇](http://www.jmonkeyengine.com/jmeforum/index.php?topic=9247.0)[文章](https://java3d.dev.java.net/servlets/NewsItemView?newsItemID=5689)而排除了 JMonkeyEngine 。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T02:44:18.127

我对 Java3D 帖子的解释是，他们正在添加一个新的场景图，而不是替换当前的场景图，以便更有效地与针对 webapps 的 JavaFX 相结合。我过去使用过 Java3D 并且喜欢它，所以我建议尝试联系开发人员并询问他们对您正在构建的任何应用程序的计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T03:12:53.860

试试[Xith3D](http://xith.org)；它使用 JOGL，而不是 Java3D。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T03:58:03.113

还有[jReality](http://www3.math.tu-berlin.de/jreality/)，它是 BSD 许可的，使用 JOGL，看起来很不错。

> 支持多种输出形式：纯软件渲染、OpenGL渲染、沉浸式虚拟现实（如CAVE的）渲染；以及 Pixar 的 RenderMan® 和 SVG 等文件格式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-05T04:05:49.917

现在（2012 年中）我强烈建议[jMonkeyEngine](http://jmonkeyengine.com/engine/)。它具有相当不错的 3D[场景图能力](http://jmonkeyengine.org/wiki/doku.php/jme3%3athe_scene_graph)，适合在 3D 游戏等应用中使用。

它是完全开源的，还有一个非常活跃的社区和强大的开发路线图——如果你想长期使用，这非常重要！

# asp.net - Javascript 日期本地化

> ID：555353
> 
> 赞同：10
> 
> 时间：2009-02-17T02:33:47.463
> 
> 标签：asp.net, javascript, jquery, localization, globalization

我正在使用具有本地化和全球化的 ASP.NET 应用程序。在给定用户环境的情况下，我很难理解如何让 JavaScript 中的 Date() 函数正常工作。我的用户群分布在墨西哥（西班牙语）和美国（英语）之间。由于墨西哥日期格式为 dd/mm/yyyy，英文格式为 mm/dd/yyyy，标准 Date(strDate) javascript 构造函数对我不起作用。

有谁知道处理 javascript Date 值的全球化/本地化的最佳方法？我有一些业务规则要强制执行，例如 dateA 必须比 dateB 早 90 天，而 dateB 不能超过今天。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-17T02:56:56.770

看看[datejs](http://code.google.com/p/datejs/)，它可以很好地处理本地化。它带有[很多全球化设置](http://code.google.com/p/datejs/source/browse/#svn/trunk/src/globalization)。您只需加载当前 CultureInfo 的全球化设置，而 datejs 会负责其余的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T02:54:54.230

[Matt Kruse](http://www.mattkruse.com/)开发了一个[非常有趣的日期库](http://mattkruse.com/javascript/date/date.js)，它应该对您的特定情况有所帮助。

这是您应该针对您提到的问题使用的方法的片段：

```
// ------------------------------------------------------------------
// parseDate( date_string [, prefer_euro_format] )
//
// This function takes a date string and tries to match it to a
// number of possible date formats to get the value. It will try to
// match against the following international formats, in this order:
// y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d
// M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d
// d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M
// A second argument may be passed to instruct the method to search
// for formats like d/M/y (european format) before M/d/y (American).
// Returns a Date object or null if no patterns match.
// ------------------------------------------------------------------

function parseDate(val) {
    var preferEuro=(arguments.length==2)?arguments[1]:false;
    generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');
    monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');
    dateFirst =new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');
    var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');
    var d=null;
    for (var i=0; i<checkList.length; i++) {
        var l=window[checkList[i]];
        for (var j=0; j<l.length; j++) {
            d=getDateFromFormat(val,l[j]);
            if (d!=0) { return new Date(d); }
            }
        }
    return null;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-16T09:15:38.740

您可以使用： var a = Date.parseLocale(value, formats);

如果您未提供自定义格式，则此函数使用 Sys.CultureInfo.CurrentCulture 属性来确定区域性值。

你可以看看：http: [//msdn.microsoft.com/en-us/library/bb397521.aspx](http://msdn.microsoft.com/en-us/library/bb397521.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-09T19:57:07.030

我在这里写了一个答案。它使用 toLocalString 来确定 MM/DD/YYY、DD/MM/YYYY、...

[https://stackoverflow.com/a/18154195/119741](https://stackoverflow.com/a/18154195/119741)

# c# - Cisco VPN 客户端版本 4.8

> ID：555369
> 
> 赞同：-1
> 
> 时间：2009-02-17T02:39:29.527
> 
> 标签：c#, vpn, cisco

有没有办法使用 C# 创建服务来检查这个客户端是否打开？

我需要一种方法来自动化检查。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-07T19:59:39.577

这个客户端的问题是它的 GUI 组件“vpngui.exe”可以被终止（未在进程列表中列出），但它建立的网络接口将保持打开状态。

因此，您的服务不能简单地检查名为 vpngui.exe 的进程是否处于活动状态并且正在启动，首先您必须检测网络接口是否已启动。您可以通过检查显示隧道是否处于活动状态的注册表项来实现此目的（有关详细信息，请参阅我的其他帖子之一），或者通过检查所述接口的存在（再次，请参阅我的其他帖子）。

因此，您需要做的是 1）检查隧道是否处于活动状态 2）（可选）检查 GUI 是否处于活动状态

然后，您可以决定下一步做什么，例如，您可以使用 cisco VPN 客户端 CLI 界面（或任何其他基于 Windows 的选项）禁用网络接口，然后终止 gui。之后，您可以使用 CLI 界面启动 VPN 客户端的新实例，该实例将自动连接到您作为 CLI 命令参数提供的帐户/登录名/pcf。

下面是一些代码：这将检查故事的 GUI 部分是否存在：

```
 Process[] processlist = Process.GetProcesses();
 string theProcessThatISeekIs = "";
                foreach (Process theprocess in processlist)  
                {
                    if (theprocess.ProcessName.ToString().ToLower() == NameOfTheProcessYouSeek.ToLower())
                    {

                        theProcessThatISeekIs = theprocess.ProcessName.ToString();
                        break;
                    }
                } 
```

以下代码将返回 CISCO 正在使用的网络接口的名称，如果返回“NotFound”，则该接口已关闭。

```
string retVal = "";
        var nic = NetworkInterface
                  .GetAllNetworkInterfaces()
                  .Where(i => i.NetworkInterfaceType != NetworkInterfaceType.Loopback && i.NetworkInterfaceType != NetworkInterfaceType.Tunnel && i.Description == "Cisco Systems VPN Adapter");
        var name = nic.FirstOrDefault();
        if (name != null)
        {
            retVal = name.Name.ToString();

        }
        else
        {
            retVal = "NotFound";
        }
        return retVal; 
```

使用这两个片段，您应该能够很好地构建您的问题的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T02:57:26.253

如果窗口打开（不需要处于焦点）您可以使用 user32.dll 中的 FindWindow 窗口调用来检查窗口。将下面的代码剪切并放置在正确的位置（用于 dllimport 的使用、定义和实际代码）。这将告诉您窗口是否打开，您可以使用 Windows 调用执行更多操作。

```
using System.Runtime.InteropServices;

[DllImport("user32.dll", EntryPoint="FindWindow", SetLastError = true)] static extern IntPtr FindWindowByCaption(IntPtr ZeroOnly, string lpWindowName);

IntPtr hWnd = FindWindowByCaption(IntPtr.Zero,"Cisco vpn title here");
if(hWnd.ToInt64() == 0){
    Console.WriteLine("ERROR Could not find cisco vpn.");
}else{
    Console.WriteLine("Handle found");
} 
```

# emacs - Emacs 中的 lgrep 和 rgrep

> ID：555376
> 
> 赞同：6
> 
> 时间：2009-02-17T02:43:29.580
> 
> 标签：emacs, grep

我在 Emacs 中遇到了 greps 问题。

a) grep 似乎不理解用于搜索 .c 和 .h 文件的 .[ch]。这是 Emacs 使用**lgrep**命令提供的默认选项。该示例在 .c/.h 文件中搜索单词“global”。

```
grep -i -nH "global" *.[ch]
grep: *.[ch]: No such file or directory

Grep exited abnormally with code 2 at Mon Feb 16 19:34:36 
```

这种格式无效吗？

b）使用**rgrep**我得到以下错误：

```
find . "(" -path "*/CVS" -o -path "*/.svn" -o -path "*/{arch}" -o -path "*/.hg" -o -path "*/_darcs" -o -path "*/.git" -o -path "*/.bzr" ")" -prune -o  -type f "(" -iname "*.[ch]" ")" -print0 | xargs -0 -e grep -i -nH "global"
FIND: Wrong parameter format

Grep finished (matches found) at Mon Feb 16 19:37:10 
```

我在 Windows XP 上使用 Emacs 22.3.1 和 GNU W32 Utils（grep、find、xargs 等）。grep v2.5.3 并找到 v4.2.20。

我错过了什么？

**更新：**

太糟糕了，不能接受多个答案......因为我的问题的解决方案已经展开。

```
grep -i -nH "global" *.c *.h 
```

这解决了第一个问题。谢谢luapyad！

```
(setq find-program "c:\\path\\to\\gnuw32\\find.exe") 
```

emacs 确实在使用 Windows find.exe。强制 gnu32 find 解决了第二个问题。谢谢斯科特弗雷泽。

不过，我还是最喜欢[ack](http://petdance.com/ack/)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-13T21:43:34.780

我发现使用：

```
(setq find-program "\"C:/path/to/GnuWin32/bin/find.exe\"")
(setq grep-program "\"C:/path/to/GnuWin32/bin/grep.exe\"") 
```

在窗户上效果更好，因为你可以在路径周围留出空间，最终会搞砸。

请注意，我在`.emacs`文件中使用了这两个程序。

希望它对其他有需要的程序员有所帮助；）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T04:30:21.490

对于 a)，当前目录中似乎根本没有 .c 或 .h 文件。

对于 b) Windows 正在尝试使用自己的 find 而不是来自 GNU W32 Utils 的 find。尝试：

`(setq find-program "c:\\path\\to\\gnuw32\\find.exe")`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T09:17:06.480

好吧，总是有[Ack](http://petdance.com/ack/)和[Ack.el](http://repo.or.cz/w/ShellArchive.git?a=blob_plain;hb=HEAD;f=ack.el)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T23:12:42.820

亚当·罗森菲尔德的评论值得扩展为答案：

```
grep -r --include=\*.[ch] --exclude=\*{CVS,.svn,arch} -i -nH 
```

要使此问题中给出的示例起作用，请使用以下命令：

```
grep -i -nH --include=\*.[ch] "global" * 
```

`grep-command`将提供默认值的变量设置为`M-x grep`：

```
(setq grep-command "grep -i -nH --include=\*.[ch] ") 
```

这里还有一些其他有用的 grep 命令行参数：

```
-n print the line number

-s suppress error messages

-r recursive 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T05:09:34.097

我认为一般问题是 Windows cmd“shell”在文件名扩展正则表达式和通配符方面的行为与 unix shell 非常不同。

要回答您上面的（a），请尝试使用：

```
grep -i -nH "global" *.c *.h 
```

（如果不存在 *.c 或 *.h，您仍然会收到“无效参数”）。

或者您可以使用命令行选项`--include=\*.[ch]`使 windows grep 进行“正确”的文件名模式匹配（参见`grep --help`其他选项）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T03:39:26.497

如果需要，我通常只`M-x grep`在提示时使用和更改命令行参数。但我只是试着跑步`M-x lgrep`，得到了和你一样的东西。它只是意味着`*.[ch]`当前目录中没有文件匹配。您还可以自定义默认选项以`-r`递归地包含和搜索子目录：

```
M-x customize-group RET grep RET 
```

在该缓冲区中搜索 lgrep 以查找/编辑 Grep 模板。

就目前`M-x rgrep`而言，我怀疑这与`find`不喜欢默认选项的 Windows 版本有关。该命令在 Linux 上对我来说很好用。在同一个自定义缓冲区中搜索 rgrep 并调整这些选项，直到 Windows 找到满意为止。

抱歉，我无法为 Windows 选项提供更多帮助，但我不熟悉它们。

# c# - 用 C# 制作 Vista 风格的应用程序

> ID：555383
> 
> 赞同：4
> 
> 时间：2009-02-17T02:48:52.500
> 
> 标签：c#, visual-studio, windows-vista

我正在运行 windows vista 并希望外观看起来像常规 vista 程序。有没有关于如何构建 Vista 风格应用程序的非常好的教程/文章？我还想学习如何使用本机代码并将其转换为 C#，就像在[这个](http://bartdesmet.net/blogs/bart/archive/2006/09/26/4470.aspx)例子中一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T18:24:52.170

如果您使用的是 WinForms，它*相对*容易完成，因为 WinForms 基于本机 Win32 控件。许多控件可以通过设置附加标志（通过向本机控件发送消息）或使用[SetWindowTheme](http://msdn.microsoft.com/en-us/library/bb759827(VS.85).aspx)来增强其呈现。这可以通过互操作来实现。

举一个简单的 ListView 为例。如果您想要一个资源管理器样式的列表视图，您可以在 ListView 的公开句柄上使用 SetWindowTheme。我们使用互操作来访问本机 SetWindowTheme() 函数，挂钩 ListView 的窗口过程并在创建控件时应用主题：

```
static class NativeMethods
{
    public const int WM_CREATE = 0x1;

    [DllImport("uxtheme.dll", CharSet = CharSet.Unicode)]
    public extern static int SetWindowTheme(
        IntPtr hWnd, string pszSubAppName, string pszSubIdList);
}

class ListView : System.Windows.Forms.ListView
{
    protected override void WndProc(ref Message m)
    {
        if (m.Msg == NativeMethods.WM_CREATE) {
            NativeMethods.SetWindowTheme(this.Handle, "Explorer", null);
        }
        base.WndProc(ref m);
    }
} 
```

默认 ListView 和我们的增强版本之间的区别： [ListView 区别 http://img100.imageshack.us/img100/1027/62586064nt6.png](http://img100.imageshack.us/img100/1027/62586064nt6.png)

Unfortunately there isn't one simple way for every control. Some controls don't even have any WinForms wrapper. Recently I stumbled upon a nice compilation [in this CodeProject article](http://www.codeproject.com/KB/vista/themedvistacontrols.aspx) which is worth a look. There may also be managed libraries out there that package this.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T03:20:16.073

如果您使用 WPF，您可以使用 Microsoft 的[Vista Bridge 库](http://code.msdn.microsoft.com/VistaBridge)，它有几个有用的控件。否则，只需查看[Windows UX 指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)并自行编写。从该页面：

> Vista Bridge 示例库中包含的一些功能是 - Vista 风格的任务和文件对话框、通用打开和保存对话框、应用程序恢复和重新启动、已知文件夹、网络列表、电源管理、用户帐户控制、CommandLink 控制、Aero 向导控制, 系统提供的图标等。

此外，您可以查看**[Aero.Controls](http://factormystic.net/projects/code/aero.controls)**和**[Aero.Wizard](http://factormystic.net/projects/code/aero.wizard)**，我编写的两个免费开源 WinForms 包分别为您设置了一些标准控件和向导。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T03:15:46.863

如果您希望 Windows XP 的应用程序看起来 100% 像 Vista，那么这将非常复杂，因为您需要覆盖 Windows 的绘制方式，以便您可以设计自己的兼容版本。

通常这些事情是在 Windows 主题级别完成的，有时通过包含改变所有应用程序外观的特殊处理程序来完成。
然后还有[像 FastAero](http://www.appscout.com/2009/01/add_vistalike_transparency_to.php)这样的工具，可以为所有 Windows XP 表单添加透明度（[提供源代码](http://blogs.msdn.com/unnir/archive/2006/03/01/541154.aspx)）。

在任何情况下，如果您希望您的应用看起来像 Vista，您需要遵守适用于 Aero 的[Windows 用户体验交互指南](http://msdn.microsoft.com/en-us/library/aa511258.aspx)。

您还可以使用[WPF 来伪造 Aero 样式的控件](http://blogs.msdn.com/unnir/archive/2006/03/01/541154.aspx)，以便您的应用在任何版本的 Windows 上看起来都相似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T05:36:17.650

你可以看看第三方解决方案。

我们使用 DevExpress 在 WinXP 上实现样式精美的 WinForm 应用程序，特别是它们的[WinForms 功能区控件](http://devexpress.com/Products/NET/Controls/WinForms/Bars/)

# javascript - IE 专注于 ajax 响应中的表单元素

> ID：555386
> 
> 赞同：0
> 
> 时间：2009-02-17T02:52:04.207
> 
> 标签：javascript, jquery, internet-explorer-7

我已经尝试过 setTimeout、eval、try/catch、回调函数等，但没有任何工作可靠。这让我发疯了好多年！这是一个[测试用例](http://alpha.sleekcode.net/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T03:57:32.910

测试页对我有用

# asp.net - 我如何编码丑陋的字符串？

> ID：555391
> 
> 赞同：0
> 
> 时间：2009-02-17T02:54:06.730
> 
> 标签：asp.net, unicode

我有一个字符串是：

```
!"#$%&'()*+,-./0123456789:;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]\^_`abcdefghijklmnopqrstuvwxyz{|}~¡¢£¤¥¦§¨©ª« ®¯°±²³´µ ¶•¸¹º»¼½¾¿ÀÁÂÃÄÅàáâäèçéêëììíîïôö÷òóõùúý
```

我将它发布到服务并使用 Htmlencode，然后我得到一个结果：

```
!#$%&'()* ,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~���������������� �����•��������������������������������������</pre>

这不是我需要的结果，我如何获得原始字符串？谢谢！

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T03:13:09.913

您的字符串不是 ASCII，因此您要么使用字符串来表示二进制数据，要么您没有保持对多字节编码的认识。无论如何，处理任何基于 Internet 的技术（HTTP、SMTP、POP、IMAP）的最简单方法是将其编码为 7-bit clean。一种常见的方法是对数据进行 base64 编码，通过网络发送，然后在尝试处理之前对其进行 base64 解码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T05:36:29.180

我相信这就是您正在寻找的：

```
!&quot;#$%&amp;&apos;()*+,-./0123456789:;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]\\^_`abcdefghijklmnopqrstuvwxyz{|}~&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&reg;&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;&para;&bull;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&agrave;&aacute;&acirc;&auml;&egrave;&ccedil;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&ocirc;&ouml;&divide;&ograve;&oacute;&otilde;&ugrave;&uacute;&yacute; 
```

您只需要使用更好的 html 实体/编码库或工具。我用来生成这个的是 Ruby - 我使用了[HTML 实体库](http://htmlentities.rubyforge.org/)。我为此编写的代码如下。我不得不将您的文本放入 input.txt 以保留 Unicode（字符串中有一个 EOF 字符），但效果很好。

```
require 'rubygems'
require 'htmlentities'

str = File.read('input.txt')

coder = HTMLEntities.new
puts coder.encode(str, :named) 
```

# sql-server - 通过 VPN 的 SQL Server 事务复制

> ID：555395
> 
> 赞同：3
> 
> 时间：2009-02-17T02:55:41.390
> 
> 标签：sql-server, replication

我通过专用 VPN 连接在两台服务器之间运行事务复制。数据库相当大，所以我最初使用备份和恢复方法将初始快照传送到订阅者机器，然后让它从那里应用增量事务。

一切都运行良好，直到 VPN 线路变得不稳定（它偶尔会这样做），此时复制过程很容易锁定。当我查看订户端时，有一些 SQL 进程似乎已挂起，并且在订户数据库和表上持有锁。疯狂的是，这些进程*来自*复制服务。我可以向您保证（通过反复试验），除了复制本身之外，没有其他进程正在锁定该数据库。

那么，为什么复制过程会像这样绊倒自己呢？为什么它会因为失去网络连接而挂起？有什么建议可以让它更可靠吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T00:03:25.693

我听说过有关 vpn 连接的此类问题。[这里](http://www.mcse.ms/message1258115.html)有一个帖子可以帮助你。

另一种选择，如果您有持续的问题，并且根据您对速度和功能的要求，可能是使用日志传送。在我看来，这可以提供一种更有弹性的数据移动方式——至少从网络的角度来看是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:42:10.487

在 SQL Server 2005 中，它们允许您使用 Web 服务进行复制。这可能不允许您放弃 VPN，但由于 Web 服务的连接驱动较少，这可能有助于解决问题。我自己没有尝试过，所以我不知道结果可能是什么。

至于锁，我们害怕地认为很多东西都被锁住了，但事实证明复制监视器只是在自己锁定，所以在查看锁时请确保您没有打开它。不过，这听起来不像你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T02:54:45.650

我会问一些问题，也许他们可以给你一些想法，因为我在这里也没有线索。

复制器有没有办法在尝试开始复制之前测试连接性？有没有办法将连接测试放入您用于执行复制的任何脚本中？有没有办法让脚本在失败的情况下保释？

# c# - ASP.NET：TreeView CurrentNodeStyle 丢失？

> ID：555397
> 
> 赞同：0
> 
> 时间：2009-02-17T02:56:42.887
> 
> 标签：c#, asp.net, css, treeview

TreeView 的 ASP.NET 版本中是否有一组 CurrentNodeStyle 属性，还是我只是瞎了眼？我想为用户当前所在的任何节点设置 CssClass，但我没有看到这样做的方法。

谷歌搜索显示经典 ASP 中有这样的野兽，但我正在尝试使用 ASP.NET 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T03:04:37.017

我认为 SelectedNodeStyle 是您正在寻找的。:)

# php - 使用显式字符串作为索引访问 php 数组

> ID：555408
> 
> 赞同：3
> 
> 时间：2009-02-17T03:06:17.120
> 
> 标签：php, arrays, indexing

我知道使用 '' 分隔的字符串而不是 ""...

但我想知道这样做是否有任何性能改进

```
 $a = array( 'table' => 'myTable', 'order' => 'myOrder' );

$table = $a['table'] 
```

代替

```
 $a = array( table => 'myTable', order => 'myOrder' );

$table = $a[table] 
```

我想是的，但只是想知道你的意见......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T03:10:54.910

是的。在您的第二个示例中，PHP 处理器在将“表”默认为数组键之前检查是否将其定义为常量，因此它会进行比需要的更多检查。这也会产生问题。

考虑一下：

```
const table = 'text';

$a = array( table => 'myTable', order => 'myOrder' );

$table = $a[table] 
```

现在 PHP 将您的数组解释为 $a[text] 这不是您想要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T03:13:32.190

你应该总是引用你的字符串。在您的第二个示例中，PHP 确实将`table`and转换`order`为字符串，但如果`table`or`order`被[定义](http://php.net/define)为常量，PHP 将使用常量的值而不是字符串“table”或“order”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T16:12:50.490

根据研究，“字符串”和“字符串”之间的差异可以忽略不计，甚至不存在。没关系，但做起来更快

```
echo "this is {$var1} and {$var2} and {$var3}"; 
```

而不是

```
echo 'this is ' . $var1 . ' and ' . $var2 . ' and ' . $var3; 
```

# php - 我可以将 CURL 库作为一个类包含在我的 PHP 脚本中吗

> ID：555415
> 
> 赞同：1
> 
> 时间：2009-02-17T03:12:28.590
> 
> 标签：php, curl

我想使用 CURL 库，但我不想硬安装它

我只想做这样的事情

```
require_once('curl.php'); 
```

我不确定这是否可能？我在哪里可以找到这个 CURL 类？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T03:20:54.700

PHP 要求它使用 cURL 库构建，请参阅：

[http://www.php.net/manual/en/curl.installation.php](http://www.php.net/manual/en/curl.installation.php)

所以你会为你的系统安装 libcurl-devel 然后编译 PHP

```
--with-curl 
```

有可能

```
--with-curl=/path/to 
```

如果您将其安装在非标准位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T03:21:14.947

您的 PHP 副本要么必须使用 Curl 构建，要么动态加载它（因为 Curl 最初不是用 PHP 编写的，它是一个 C 库）。

创建一个调用 phpinfo() 的简单脚本。如果 curl 是内置的，它应该显示在这个页面上。

phpinfo();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T09:50:10.987

有一个名为[libCurlEmu的纯 PHP Curl 实现](http://code.blitzaffe.com/pages/phpclasses/category/52/fileid/7)

请记住：如果您无法使扩展工作，您应该*只将这种东西用作最后的手段。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T11:52:37.960

还有一个名为“MyCurl”的独立版本，无需安装即可包含：

[http://www.phpclasses.org/package/3588-PHP-Pure-PHP-implementation-of-the-cURL-library.html](http://www.phpclasses.org/package/3588-PHP-Pure-PHP-implementation-of-the-cURL-library.html)

我在我的项目中使用了它，它在 http-requests 中运行良好。

> 此类在纯 PHP 中提供了 cURL 扩展函数的替代实现。
> 
> 它会自动检测 cURL 库是否可用。如果它不可用，它会定义几个与 cURL 扩展名相同的函数，这些函数使用该类来模拟部分原始功能。
> 
> 目前它实现了以下功能：curl_init、curl_exec、curl_setopt 和 curl_close。可以使用 curl_setopt 函数设置几个最重要的选项。

尽管它有一些小错误，但在修复此问题后它可以工作：

1.  该示例开箱即用，导致无法访问域lazywebmastertools.com
2.  如果请求的域不以“/”结尾，则需要一个 @：

    > 返回“/”。@$tmp[1];

3.  如果您不使用代理，则必须设置

    > if (isset($this->proxy) 和 $this->proxy["host"])...

4.  > if (isset($this->headers["location"]) 和 $this->headers["location"] > "") {...

缺点是，这个类不支持 https。那里你需要史努比类： [https ://stackoverflow.com/a/1154247/1069083](https://stackoverflow.com/a/1154247/1069083)

# powershell - powershell quest：get-qaduser -identity guid 不起作用？

> ID：555422
> 
> 赞同：0
> 
> 时间：2009-02-17T03:14:21.237
> 
> 标签：powershell, quest

我首先通过以下方式查询 Exchange Server 2003：

```
POSH>get-wmiobject -class Exchange_mailbox -namespace Root\MicrosoftExchangeV2 -server srv02 
```

来获取用户。可用的属性之一是mailboxguid。所以为了测试，我跑

```
POSH> get-qaduser -identity <mailboxguid> 
```

但是它不起作用。我需要对mailboxguid 做些什么特别的事情吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T08:47:19.330

Get-QADUser 尝试通过以下属性之一解析对象：DN、SID、GUID、UPN 或 Domain\UserName，mailboxguid 不是其中之一。也就是说，您可以使用邮箱“MailboxDisplayName”属性作为 Get-QADUser 的标识：

get-wmiobject -class Exchange_mailbox -namespace Root\MicrosoftExchangeV2 -server srv02 | 获取 QADUser -identity {$_.MailboxDisplayName}

编辑：如果您不能使用 MailboxDisplayName，请尝试解析 LegacyDN WMI 属性：

get-wmiobject -class Exchange_mailbox -namespace Root\MicrosoftExchangeV2 **-computerName** srv02| 获取 QADUser -identity {$ *.LegacyDN.substring($* .LegacyDN.lastIndexOf("=")+1)}

顺便说一句，将 -server 替换为 -computerName，Get-WMIObject 没有 -server 参数。我另外你可以采取其他方式而不使用 WMI 来获取启用邮箱的对象，你可以直接查询 AD：

获取 QADObject -sizeLimit 0 -ldap "(homeMDB=*)"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-28T10:14:46.190

我认为问题出在其他地方：如果您通过其名称从 AD 获取对象（例如用户）并查看`ObjectGUID`，它包含如下字符串：

```
(Get-QADUser -Identity myDomain\myUser).ObjectGUID 
-> CAEC64A025153143A6755E0A3DAB5C1A 
```

要通过其 GUID 获取同一用户，您必须指定：

```
(Get-QADUser -Identity A064ECCA-1525-4331-A675-5E0A3DAB5C1A).ObjectGUID
-> CAEC64A025153143A6755E0A3DAB5C1A 
```

如果您比较这些 GUID，您会注意到它们看起来有些相似但并不相同：

```
CAEC64A0-2515-3143-A675-5E0A3DAB5C1A
A064ECCA-1525-4331-A675-5E0A3DAB5C1A 
```

出现此问题的原因是`System.GUID`使用与 Active Directory 不同的字节顺序来构造 GUID。

您可以像这样更正它（VB.NET）：

```
Private Shared Function GetCorrectGuid(ByVal aWrongGuid As Guid) As Guid
  Dim myGuidString As String = aWrongGuid.ToString("N")
  Dim myWrongGuid As Char() = myGuidString.ToCharArray()
  Dim myCorrectGuid As Char() = myGuidString.ToCharArray()
  myCorrectGuid(0) = myWrongGuid(6)
  myCorrectGuid(1) = myWrongGuid(7)
  myCorrectGuid(2) = myWrongGuid(4)
  myCorrectGuid(3) = myWrongGuid(5)
  myCorrectGuid(4) = myWrongGuid(2)
  myCorrectGuid(5) = myWrongGuid(3)
  myCorrectGuid(6) = myWrongGuid(0)
  myCorrectGuid(7) = myWrongGuid(1)
  myCorrectGuid(8) = myWrongGuid(10)
  myCorrectGuid(9) = myWrongGuid(11)
  myCorrectGuid(10) = myWrongGuid(8)
  myCorrectGuid(11) = myWrongGuid(9)
  myCorrectGuid(12) = myWrongGuid(14)
  myCorrectGuid(13) = myWrongGuid(15)
  myCorrectGuid(14) = myWrongGuid(12)
  myCorrectGuid(15) = myWrongGuid(13)
  Return New Guid(New String(myCorrectGuid, 0, 32))
End Function 
```

或者这个（C#）：

```
private static Guid GetCorrectGuid(Guid aWrongGuid) {
  string myGuidString = aWrongGuid.ToString("N");
  char[] myWrongGuid = myGuidString.ToCharArray();
  char[] myCorrectGuid = myGuidString.ToCharArray();
  myCorrectGuid[0] = myWrongGuid[6];
  myCorrectGuid[1] = myWrongGuid[7];
  myCorrectGuid[2] = myWrongGuid[4];
  myCorrectGuid[3] = myWrongGuid[5];
  myCorrectGuid[4] = myWrongGuid[2];
  myCorrectGuid[5] = myWrongGuid[3];
  myCorrectGuid[6] = myWrongGuid[0];
  myCorrectGuid[7] = myWrongGuid[1];
  myCorrectGuid[8] = myWrongGuid[10];
  myCorrectGuid[9] = myWrongGuid[11];
  myCorrectGuid[10] = myWrongGuid[8];
  myCorrectGuid[11] = myWrongGuid[9];
  myCorrectGuid[12] = myWrongGuid[14];
  myCorrectGuid[13] = myWrongGuid[15];
  myCorrectGuid[14] = myWrongGuid[12];
  myCorrectGuid[15] = myWrongGuid[13];
  return new Guid(new string(myCorrectGuid, 0, 32));
} 
```

是的，我知道这不是最有效的方法，但我现在根本没有时间将它重写为基于字节数组并使用 arraycopy 的函数。对不起。

希望对你有帮助

# ios - Apple 开发者连接网站要求我提供的“App Id”是什么？

> ID：555424
> 
> 赞同：18
> 
> 时间：2009-02-17T03:15:22.140
> 
> 标签：ios

我刚刚注册成为一名 iPhone 开发人员。什么是“应用程序 ID”？是我公司的名字吗？它只是我的应用程序名称吗？苹果对此并不十分清楚。

谢谢。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-06T19:58:25.617

我不认为亚历克斯的回答是*完全*正确的。

`com.myname.MyCoolApplication`是“捆绑 ID 搜索字符串”或“捆绑标识符”，具体取决于您查阅的 Apple 文档。

以下是一些 Apple 开发者资源：

*   [技术问答 QA1713：什么时候应该使用通配符 App ID？](https://developer.apple.com/library/ios/#qa/qa1713/_index.html)

要获得完整的“App ID”，您需要 Team ID（由 Apple 生成）加上您的 Bundle Identifier（由开发人员创建）。例如，来自[Q&A QA1713](https://developer.apple.com/library/ios/#qa/qa1713/_index.html)，

> 示例应用 ID：`ABCDE12345.com.foocompany.appname`
> 
> *   `ABCDE12345`是 Bundle Seed ID（由 Apple 生成）
> *   `com.foocompany.appname`是 App ID 的 Bundle Identifier，需要和你的应用的 Bundle Identifier 相同

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-17T03:18:48.497

它是您的应用程序的命名空间。例如：

```
com.myname.MyCoolApplication 
```

它使用一种反向域名格式，其想法是一次只有一个人拥有一个域。您可以创建一个通配符的 App ID，例如：

```
com.myname.* 
```

现在您可以在 * 创建一套应用程序的地方替换任何东西。

App ID 是唯一标识应用程序的标识符。它可能是显式的或通配符。显式意味着只有一个应用程序。相反，如果我们想为不同的应用程序使用相同的应用程序 ID，则使用通配符应用程序 ID。谢谢

# c# - ASP.NET MVC 中绑定对象的可选属性

> ID：555425
> 
> 赞同：1
> 
> 时间：2009-02-17T03:15:37.490
> 
> 标签：c#, asp.net-mvc, modelbinders

我正在尝试构建一个“新客户”表单，因此我使用默认模型绑定器来构建我的客户对象：

```
public ActionResult New(Customer customer) { ... } 
```

唯一的问题是我在 Customer 对象上有一些不需要的属性。当我将这些字段留空时，ASP.NET MVC 会自动抛出模型错误，说明“需要一个值”。

我如何向框架表明这些属性是可选的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T04:05:47.913

我不是 100%，但让它们可以为空应该可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T03:53:32.047

我有同样的问题，我找到了原始类型的解决方案，那就是使变量可以为空，例如

```
public virtual int? AnotherId {get; set;}
public virtual string? Name {get; set;} 
```

但是，对于作为对象的属性，我无法弄清楚。我仍然有问题。

```
public virtual Sponsor Sponsor { get; set; } 
```

# solaris - 映射 sd?/sdd? 名称到 Solaris 磁盘名称？

> ID：555427
> 
> 赞同：7
> 
> 时间：2009-02-17T03:17:07.127
> 
> 标签：solaris, iostat

Solaris 中的某些命令（例如 iostat）使用磁盘名称（例如 sd0 或 sdd2）报告磁盘相关信息。是否有一致的方法将这些名称映射回标准 /dev/dsk/c?t?d?s？Solaris中的磁盘名称？

编辑：正如 Amit 所指出的，**iostat -n**生成设备名称，例如 c0t0d0s0 而不是 sd0。但是我怎么发现 sd0 实际上是 c0t0d0s0 呢？我正在寻找产生这样一个列表的东西：

```
sd0=/dev/dsk/c0t0d0s0
...
sdd2=/dev/dsk/c1t0d0s4
...

```

也许我可以运行 iostat 两次（使用和不使用 -n）然后合并结果并希望 iostat 产生的行数和设备排序在两次运行之间是相同的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T18:26:38.443

按照 Amit 的想法回答我自己的问题，这就是我想出的：

```
iostat -x|tail -n +3|awk '{print $1}'>/tmp/f0.txt.$$
iostat -nx|tail -n +3|awk '{print "/dev/dsk/"$11}'>/tmp/f1.txt.$$
paste -d= /tmp/f[01].txt.$$
rm /tmp/f[01].txt.$$ 
```

在 Solaris 10 服务器上运行它会产生以下输出：

```
sd0=/dev/dsk/c0t0d0
sd1=/dev/dsk/c0t1d0
sd4=/dev/dsk/c0t4d0
sd6=/dev/dsk/c0t6d0
sd15=/dev/dsk/c1t0d0
sd16=/dev/dsk/c1t1d0
sd21=/dev/dsk/c1t6d0
ssd0=/dev/dsk/c2t1d0
ssd1=/dev/dsk/c3t5d0
ssd3=/dev/dsk/c3t6d0
ssd4=/dev/dsk/c3t22d0
ssd5=/dev/dsk/c3t20d0
ssd7=/dev/dsk/c3t21d0
ssd8=/dev/dsk/c3t2d0
ssd18=/dev/dsk/c3t3d0
ssd19=/dev/dsk/c3t4d0
ssd28=/dev/dsk/c3t0d0
ssd29=/dev/dsk/c3t18d0
ssd30=/dev/dsk/c3t17d0
ssd32=/dev/dsk/c3t16d0
ssd33=/dev/dsk/c3t19d0
ssd34=/dev/dsk/c3t1d0 
```

该解决方案不是很优雅（它不是单线），但它似乎有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-14T21:22:45.007

已接受答案的一个班轮版本（我只有 1 个声誉，因此无法发表评论）：

```
 paste -d= <(iostat -x | awk '{print $1}') <(iostat -xn | awk '{print $NF}') | tail -n +3 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T03:26:24.560

尝试使用“-n”开关。例如。'iostat -n'

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-25T18:33:39.540

我在 Solaris Transition Guide 中找到了以下内容：

“实例名称

实例名称是指系统中的第 n 个设备（例如 sd20）。

实例名称偶尔会在驱动程序错误消息中报告。您可以通过查看`dmesg(1M)`输出来确定实例名称与物理名称的绑定，如下例所示。

```
sd9 at esp2: target 1 lun 1
sd9 is /sbus@1,f8000000/esp@0,800000/sd@1,0
     <SUN0424 cyl 1151 alt 2 hd 9 sec 80> 
```

将实例名称分配给设备后，它仍然绑定到该设备。

实例编号编码在设备的次要编号中。为了在重新启动时保持实例编号一致，系统将它们记录在 /etc/path_to_inst 文件中。此文件在引导时只读，当前由“`add_drv(1M)`和`drvconf`”更新

因此，基于此，我编写了以下脚本：

用于 /dev/dsk/*s2 中的设备

做

```
dpath="$(ls -l $device | nawk '{print $11}')"

dpath="${dpath#*devices/}"

dpath="${dpath%:*}"

iname="$(nawk -v dpath=$dpath '{

    if ($0 ~ dpath) {

        gsub("\"", "", $3)

        print $3 $2

    }

}' /etc/path_to_inst)"

echo "$(basename ${device}) = ${iname}" 
```

完毕

```
By reading the information directly out of the path_to_inst file, we are allowing for adding and deleting devices, which will skew the instance numbers if you simply count the instances in the /devices directory tree. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-06T17:11:52.793

正如其他答案中所指出的，您可以通过设备路径和*/etc/path_to_inst*中包含的信息将设备名称映射回实例名称。这是一个完成任务的 Perl 脚本：

```
#!/usr/bin/env perl

use strict;

my @path_to_inst = qx#cat /etc/path_to_inst#;
map {s/"//g} @path_to_inst;
my ($device, $path, @instances);

for my $line (qx#ls -l /dev/dsk/*s2#) {
    ($device, $path) = (split(/\s+/, $line))[-3, -1];
    $path =~ s#.*/devices(.*):c#$1#;

    @instances =
        map {join("", (split /\s+/)[-1, -2])}
            grep {/$path/} @path_to_inst;
*emphasized text*
    for my $instance (@instances) {
        print "$device $instance\n";
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-26T12:26:11.483

我认为找到具有实例名称的描述性名称的最简单方法是：

```
# iostat -xn sd0
                    extended device statistics
    r/s    w/s   kr/s   kw/s wait actv wsvc_t asvc_t  %w  %b device
    4.9    0.2  312.1    1.9  0.0  0.0    3.3    3.5   0   1 c1t1d0
# 
```

最后一列显示提供的实例名称的描述性名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T19:22:04.490

sd0 sdd0 是设备的实例名称。您可以检查 /etc/path_to_inst 以获取实例名称映射到物理设备名称，然后检查 /dev/dsk 中的链接（它指向哪个物理设备）这是 100% 确定的方法，虽然我不知道如何编码；）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-11T13:45:46.513

前段时间我在互联网上找到了这个片段，它成功了。这是在 Solaris 8 上：

```
#!/bin/sh
cd /dev/rdsk
/usr/bin/ls -l *s0 | tee /tmp/d1c |awk '{print "/usr/bin/ls -l "$11}' | \
sh | awk '{print "sd" substr($0,38,4)/8}' >/tmp/d1d
awk '{print substr($9,1,6)}' /tmp/d1c |paste - /tmp/d1d
rm /tmp/d1[cd] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-25T16:53:12.983

允许磁盘名称超过 8 个字符的细微变化（在处理 SAN 上的磁盘阵列时遇到）

```
#!/bin/sh

cd /dev/rdsk
/usr/bin/ls -l *s0 | tee /tmp/d1c | awk '{print "/usr/bin/ls -l "$11}' | \
sh | awk '{print "sd" substr($0,38,4)/8}' >/tmp/d1d
awk '{print substr($9,1,index($9,"s0)-1)}' /tmp/d1c | paste - /tmp/d1d
rm /tmp/d1[cd] 
```

# c# - 使用 GetType() 进行投射

> ID：555462
> 
> 赞同：38
> 
> 时间：2009-02-17T03:42:41.683
> 
> 标签：c#, reflection, casting

是否可以将对象转换为从返回的类型`GetType()`？我想要一个可以接受对象（对于匿名类型）但然后返回一个对象强制转换为匿名类型的通用方法。我一直在考虑使用 LCG DynamicMethod 在容器类上构建一个方法，但我无法完全弄清楚那会是什么样子。使用该`GetType()`方法进行转换的想法是能够获取匿名类型并将对象转换为其实际类型，而无需实际知道类型。

首要目标是将匿名类型的对象粘贴到容器中，然后我可以在方法之间共享和传递。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-17T05:32:19.453

我想不出你为什么要强制转换为 GetType()，因为在编译时不知道类型的情况下，你将无法对结果做任何有用的事情。

也许您正在寻找的是能够转换。如果是这种情况，以下内容应该适合您：

```
object input = GetSomeInput();
object result = Convert.ChangeType(input, someOtherObject.GetType()); 
```

我们在从注册表读取值时使用它，这些值都存储为字符串，然后使用反射将它们填充到属性中。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-17T04:06:29.940

你的意图很不明确；但是，一种选择是泛型，`MakeGenericMethod`尤其是泛型。你想用这个做什么？例如：

```
static class Program
{
    static void Main()
    {
        object obj = 123.45;
        typeof(Program).GetMethod("DoSomething")
            .MakeGenericMethod(obj.GetType())
            .Invoke(null, new object[] { obj });
    }
    public static void DoSomething<T>(T value)
    {
        T item = value; // well... now what?
    }    
} 
```

所以现在我们有了`double`通过泛型输入的值——但除了调用*其他*泛型方法外，我们仍然无能为力……你想在这里做什么？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T02:35:01.500

您可以使用该`Activator.CreateInstance`方法从类型创建实例。

仅供参考，反射是 SLOOWWWW，因此如果您需要连续多次执行此转换，最好在枚举或类似的东西中定义您的类型，然后在不使用反射的情况下创建实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-18T15:40:37.247

我有一个类用于在我的[Windows 窗体](https://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx)应用程序中进行更改跟踪，因为并非所有项目都是数据[绑定](https://docs.microsoft.com/en-us/dotnet/framework/winforms/controls/how-to-bind-a-windows-forms-combobox-or-listbox-control-to-data)的。大多数项目是[TextBox](https://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.aspx)控件，但也有[ComboBox](https://msdn.microsoft.com/en-us/library/system.windows.controls.combobox.aspx)和[DateTimePicker](https://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.aspx)控件。

为简单起见，我的`HasChanged`属性测试通用[Windows.Forms.Control](https://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx)以查看它是否为*ComboBox*，但您可以测试添加到 Windows 窗体的任何类型的控件。

下面是该课程-如果它对任何人都有帮助。

```
internal class DataItem
{
    private static Color originalBackColor, changedBackColor, originalForeColor, changedForeColor;
    private static Font originalFont, changedFont;

    static DataItem()
    {
        originalBackColor = SystemColors.Control;
        changedBackColor = SystemColors.HighlightText;
        originalForeColor = Color.Black;
        changedForeColor = Color.Red;
        originalFont = new Font(FontFamily.GenericSansSerif, 12.5f);
        changedFont = new Font(originalFont, FontStyle.Bold);
    }

    public static void ChangeSetup(Control original, Color changedBackgroundColor)
    {
        originalBackColor = original.BackColor;
        originalForeColor = original.ForeColor;
        originalFont = original.Font;
        changedBackColor = changedBackgroundColor;
        changedFont = new Font(originalFont, FontStyle.Bold);
    }

    private bool changeTracking;

    public DataItem(Control control, Object value)
    {
        this.Control = control;
        var current = String.Format("{0}", Control.Text).Trim();
        if (Control is ComboBox)
        {
            var cbo = (ComboBox)Control;
            current = cbo.StateGet();
        }
        this.OriginalValue = current;
        this.Control.TextChanged += Control_TextChanged;
        changeTracking = true;
    }

    public Control Control { get; private set; }

    private void Control_TextChanged(Object sender, EventArgs e)
    {
        if (TrackingChanges)
        {
            if (HasChanged)
            {
                this.Control.BackColor = originalBackColor;
                this.Control.Font = originalFont;
                this.Control.ForeColor = originalForeColor;
            }
            else
            {
                this.Control.BackColor = changedBackColor;
                this.Control.Font = changedFont;
                this.Control.ForeColor = changedForeColor;
            }
        }
    }

    public bool HasChanged
    {
        get
        {
            var current = String.Format("{0}", Control.Text).Trim();
            if (Control is ComboBox)
            {
                var cbo = (ComboBox)Control;
                current = cbo.StateGet();
            }
            return !current.Equals(OriginalValue);
        }
    }

    public String OriginalValue { get; private set; }

    public void Reset()
    {
        changeTracking = false;
        this.OriginalValue = String.Empty;
        this.Control.Text = String.Empty;
        this.Control.BackColor = originalBackColor;
        this.Control.Font = originalFont;
        this.Control.ForeColor = originalForeColor;
    }
    public bool TrackingChanges
    {
        get
        {
            return changeTracking;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-02-13T23:03:02.117

您可以使用 getClass() 返回一个 Class 对象，然后使用 Class 对象中的 cast 方法将对象转换为该 Class 类型的对象，如下所示：

myObj.getClass().cast(myObj)

# php - 如何使用 Zend / PHP 插入非默认 Google 日历

> ID：555468
> 
> 赞同：3
> 
> 时间：2009-02-17T03:46:28.773
> 
> 标签：php, zend-framework, zend-gdata

我正在尝试在 Google 日历中插入一个新事件，我可以通过以下方式完成：

```
$sname = Zend_Gdata_Calendar::AUTH_SERVICE_NAME; // predefined service name for calendar
$client = Zend_Gdata_ClientLogin::getHttpClient($userName,$password,$sname);
$service = new Zend_Gdata_Calendar($client);

$event = $service->newEventEntry();
$event->title = $service->newTitle($name);
$event->when = array($when);
$newEvent = $service->insertEvent($event); 
```

但是，这只会插入到默认日历中。我正在尝试使用 insertEvent 的 URI 参数来获取我需要去的地方：

```
$uri = "http://www.google.com/calendar/feeds/default/something@somethingelse.com/private/full";
$newEvent = $service->insertEvent($event, $uri); 
```

这没有奏效。我已经尝试对 URI 进行编码和解码，这给了我不同的错误消息，但我就是无法让它工作。我已经用谷歌搜索解决方案几个小时了，但没有运气。任何人都可以帮忙吗？

谢谢。- 戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T01:48:43.263

发现问题：上面的 URI 不起作用：“ [http://www.google.com/calendar/feeds/](http://www.google.com/calendar/feeds/) **default** /something@somethingelse.com/private/full”；

那里不应该有默认部分。

此外，@ 符号应替换为编码。所以应该是：“ [http://www.google.com/calendar/feeds/something%40somethingelse.com/private/full](http://www.google.com/calendar/feeds/something%40somethingelse.com/private/full) ”；

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T21:31:54.100

我已经为此奋斗了一段时间，终于让它工作了。这不是很好的包装，但这是我正在寻找的答案

首先，您必须获取日历 ID。如果您进入日历并单击名称旁边的向下箭头图标，您将看到日历设置选项。选择该菜单项。在底部附近，您将看到日历地址。需要一点时间才能找到日历 ID，它看起来像这样

（日历 ID：o4g3921hdiaq5p8kdat2l4vgis@group.calendar.google.com）

你想要 o4g39j1hdihq4p8kdat2l4vgis@group.calendar.google.com

以后我会想在 php 中得到它，但现在我可以硬编码。所以我为此设置了一个变量

 ````
$calendar_user = 'o4g39j1hdihq4p8kdat2l4vgis@group.calendar.google.com'; 
````  `检索事件时，您将像这样设置用户

```
$gdataCal = new Zend_Gdata_Calendar($client);
$query = $gdataCal->newEventQuery();
$query->setUser($calendar_user); 
```

但是，当您添加事件时，您不能这样做，您必须在插入事件的位置使用 $calendar_user。

所以这里是完整的代码

```
$calendar_user = 'o4g39j1hdihq4p8kdat2l4vgis@group.calendar.google.com';
$user = 'myemail@yahoo.com';
$pass = 'mygooglecalendarpassword';
$service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME; // predefined service name for calendar
$client = Zend_Gdata_ClientLogin::getHttpClient($user,$pass,$service);

$gc = new Zend_Gdata_Calendar($client);
$newEntry = $gc->newEventEntry();
$newEntry->title = $gc->newTitle("mytitle");
$newEntry->where  = array($gc->newWhere("meeting place"));

$newEntry->content = $gc->newContent("Meeting description");
$newEntry->content->type = 'text';

$when = $gc->newWhen();
$when->startTime = "{'2012-06-28'}T{'10:00'}:00.000{'-08'}:00";
$when->endTime = "{'2012-06-28'}T{'11:00'}:00.000{'-08'}:00";
$newEntry->when = array($when);

$createdEvent = $gc->insertEvent($newEntry, "http://www.google.com/calendar/feeds/".$calendar_user."/private/full"); 
```

现在我希望这会有所帮助。我告诉你我花了很长时间才弄清楚这一点，但我不是世界上最聪明的人。

# emacs - 半模态编辑/自动前缀键

> ID：555470
> 
> 赞同：12
> 
> 时间：2009-02-17T03:46:47.600
> 
> 标签：emacs

大多数 emacs 模式都包含某种前缀来激活它们的功能。例如，当使用*GUD*时， “next”是“Cc Cn”。在这些模式中，许多提供了特殊的缓冲区，人们可以使用一个键来激活某些功能（例如，在*GNUS中，只需使用“n”或“p”来阅读下一封/上一封邮件）。*

然而，并非所有模式都提供这样的缓冲区，并且重复键入前缀可能会令人厌烦。是否有一个众所周知的 elisp 允许在一段时间内将前缀键的临时规范附加到所有输入？（例如，直到按下 ESC 或其他一些认可的键）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-17T22:58:31.000

我同意 Joe Casadonte 的回答，即要走的路是定义自己的次要（或主要）模式。

话虽如此，你的问题很有趣。

这是一个提示您输入键序列的解决方案，它采用前缀击键并将该键映射提升到顶层。

例如，假设以下键盘映射：

```
M-g ESC         Prefix Command
M-g g           goto-line
M-g n           next-error
M-g p           previous-error 
```

当您运行时`M-x semi-modal-minor-mode`，它会提示您输入一些按键。如果输入`M-g n`，则设置以下键绑定：

```
ESC         Prefix Command   (same as M-g ESC)
g           goto-line
n           next-error
p           previous-error 
```

所以 now`n`不会自插入，而是跳转到下一个错误。请参阅下面的代码。

注意：启用此次要模式时，`<f12>`将绑定到禁用次要模式的命令。这是因为键绑定很可能会禁用您的 Emacs（例如，如果 有一个新的键绑定会怎样`M-x`）。

*编辑添加了这些想法：次要模式变量最初是本地缓冲区，但除非您**也*将次要模式变量缓冲区设为本地（duh），否则这不起作用。但是，你也（可能）不希望这些绑定在 minibuffer 中......所以，我不打算测试它 b/c 它真的取决于你想要什么，但我已经在代码中添加了注释反映了这个想法。

无需再费周折：

```
(defvar semi-modal-minor-mode-keymap (make-sparse-keymap)
  "keymap holding the prefix key's keymapping, not really used")
(defvar semi-modal-minor-mode-disable-key (kbd "<f12>")
  "key to disable the minor mode")
(defun semi-modal-minor-mode-disable ()
  "disable the minor mode"
  (interactive)
  (semi-modal-minor-mode 0))

(define-minor-mode semi-modal-minor-mode
  "local minor mode that prompts for a prefix key and promotes that keymap to the toplevel
e.g. If there are bindings like the following:

M-g ESC         Prefix Command
M-g g           goto-line
M-g n           next-error
M-g p           previous-error

And you enter 'M-g n' when prompted,
then the minor mode keymap has the bindings
  g   ->   goto-line
  n   ->   next-error
  p   ->   previous-error
  ESC ->   Prefix Command (same as M-g ESC)

The variable semi-modal-minor-mode-disable-key is bound to disable the minor mode map.
This is provided because often the mappings make the keyboard unusable.
Use at your own risk."
  nil " Semi" semi-modal-minor-mode-keymap
  (make-local-variable 'semi-modal-minor-mode)
  (make-local-variable 'minor-mode-map-alist)
  (let ((pair-holding-keymap-to-modify (assq 'semi-modal-minor-mode minor-mode-map-alist)))
    (setcdr pair-holding-keymap-to-modify (make-sparse-keymap))
    (if semi-modal-minor-mode
        (let (key
              keymap)
          ;; all but last (b/c we want a prefix
          (setq key (substring (read-key-sequence "Enter a full key combination, the prefix will be used: ") 0 -1))
          (if (and (not (equal "" key))
                   (not (equal (kbd "C-g") key))
                   (let ((semi-modal-minor-mode nil))
                     (keymapp (setq keymap (key-binding key)))))
              (progn
                (setcdr pair-holding-keymap-to-modify (copy-keymap keymap))
                (when semi-modal-minor-mode-disable-key
                  (define-key (cdr pair-holding-keymap-to-modify)
                    semi-modal-minor-mode-disable-key 'semi-modal-minor-mode-disable)))
            (semi-modal-minor-mode 0)))))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T18:02:19.497

Emacs 中键绑定的特定模式（模态？）部分是由覆盖通用全局映射的各种局部映射实现的。大多数主要和次要模式都定义了自己的本地地图；例如，有一个 gud-mode-map。仅当当前缓冲区处于相应模式时，才会激活本地键映射中的键绑定。您可以通过模式的钩子自定义模式特定的键盘映射。例如，您可以将此代码段放入您的 ~/.emacs

```
    (add-hook 'gud-mode-hook
      （拉姆达（）
        （本地设置键（kbd“Cn”）
                       (lookup-key (current-local-map) (kbd "Cc Cn")))))

```

有关键映射的更多详细信息可以在[Elisp 参考手册](http://www.gnu.org/software/emacs/elisp/html_node/Keymaps.html#Keymaps)中找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T21:31:55.277

这里的基本问题是没有当前的键盘映射本身。全局键映射被主模式的键映射覆盖，而主模式的键映射又被一个或多个次要模式的键映射覆盖（我敢肯定，它们可以以某种定义的方式相互踩踏）。定义一个新的主要模式仍然会保留次要模式键的功能，并且定义一个新的次要模式只会影响您在次要模式的键盘映射中定义的任何键。

例如，您可以定义一个次要模式，只要次要模式处于活动状态，它就会执行您想要的操作。您定义了一个新的次要模式`my-gud-mode`，它将有自己的键盘映射。然后，您必须为其定义所有键映射（例如 n、p 等），并且您还必须定义所有您不想绑定到函数的键`ignore`。这是真正的痛苦，重新映射所有其他键。不过，次要模式很容易打开和关闭；这就是优势。

乍一看，定义一个新的主要模式会更容易，因为它可以让你一次性覆盖更多的“当前键盘映射”。它应该在缓冲区局部变量中记录当前的主要模式，以便稍后在关闭临时主要模式时恢复它。但是您仍然会有其他次要模式侵入您的键盘映射，因此它不会是“纯粹的”。

我在这种情况下所做的是定义一个更简单的前缀！对于我一直使用的东西，每天一整天，我都会给他们一个功能键（例如，我将 F1 留作我的 jabber 模式键）。对于不太立即有用的东西，我留出了另外两个功能键，F3 和 F12（我确信我很久以前选择它们是有原因的，但我不再记得为什么了）。F3 定义始终可用的键，无论主要模式如何。F12 定义依赖于主要模式的键。一些例子：

我将 F3-m- 设置为切换主要模式的前缀（例如 F3-mp 切换到 cperl-mode）和 F3-M- 作为次要模式的前缀（例如 F3-Mv 切换视图模式）。这些总是可用的，所以你可以做一些事情，比如将 F3-g- 绑定为你的 gud 前缀，然后键入 F3-gp 来表示之前的等等。

我的 F12 键取决于模式。因此，在 dired 模式下 F12-e 将调用`dired-nt-open-in-excel`当前文件，而在 emacs-lisp-mode F12-e 将调用`elint-current-buffer`. 不知何故，我从来没有让他们感到困惑。

如果您在定义这样的键盘映射时需要帮助，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-09T07:48:19.700

Viper 模式允许您在可视模式下（使用“esc”键输入）将命令映射到键或键序列。使用“i”返回插入模式。
看看[viper-in-more-modes.el](http://www.emacswiki.org/emacs/viper-in-more-modes.el)
它使用[viper-modify-major-mode](http://www.gnu.org/software/emacs/manual/html_node/viper/Key-Bindings.html)。
我也喜欢使用 viper-vi-global-user-map：我的 .emacs 文件中的一个[片段](https://gist.github.com/1273414)。

# c# - 修改方法内的方法参数或返回结果

> ID：555471
> 
> 赞同：35
> 
> 时间：2009-02-17T03:48:09.610
> 
> 标签：c#, .net

和有什么区别

```
private void DoSomething(int value) {
    value++;
} 
```

和

```
private int DoSomething(int value) {
   return value++;
} 
```

当用作

```
DoSomething(value); 
```

相对

```
value = DoSomething(value); 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-17T03:52:30.303

您正在谈论**按引用**传递和**按值传递**之间的区别，这在概念上类似于**值类型与引用类型**的概念。

如果将**值类型**传递给方法，则必须使用第二个示例；否则你只是在增加一个存在于 DoSomething() 范围内的整数。试试看：如果你执行你的第一个例子，在 DoSomething() 运行之后，你的 int 值将保持不变。

但是，如果您传递的不是值类型（比如对象 foo），那么实际上您**传递的是**对原始对象的引用。你在 DoSomething() 中对它所做的任何事情也会在方法之外生效，因为你仍然指的是同一个对象。

您可以通过编写以下代码来完成您在第一个示例中尝试的内容：

```
void DoSomething(ref int value) 
```

这指示 .NET 传递对项目的引用，无论它是否是值类型。

有关更详细的信息，请参阅 MSDN 上有关**[值类型与引用类型的这篇文章。](http://msdn.microsoft.com/en-us/library/t63sy5hs(VS.80).aspx)**

此外，正如[zodoz 指出的那样](https://stackoverflow.com/questions/555471/modify-method-parameter-within-method-or-return-result/555502#555502)（适当地赞成），通过返回，`value++`您将返回然后递增。要返回增加的值，请使用`++value`.

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-02-17T09:38:07.133

**返回一个值。**

为什么？

**正确性、可读性和自文档**

有意且易于理解的代码比副作用代码更好。考虑：

```
float area = pi * Square(r); 
```

对比

```
Square(r);
float area = pi * r;
// ... intervening code
float x = r * 5;  // did you mean to use the original r or r-squared here? 
```

还要考虑第一个示例中通过可组合性实现简洁的优点。

考虑方法本身，比较：

```
int DoSomething(int value)
   { return value+1; } 
```

这显然是正确的。对比

```
void DoSomething(int value)
   { value++; } 
```

这似乎是正确的，并且可以编译得很好，但实际上只是一个空操作。你真正想要的是：

```
void DoSomething(ref int value)
   { value++; }

// client code:
DoSomething(ref a); 
```

**变量很便宜**

许多命名良好的变量比少数重用的通用变量更可取。抵制过早优化的诱惑，您需要减少局部变量的数量以提高系统性能的可能性非常小。**同样，变量很便宜，不要重复使用变量！**

**可测试性**

考虑：

```
Assert.IsTrue(Square(2) == 4); 
```

对比

```
float a = 2;
Square(a);
Assert.IsTrue(a == 4); 
```

避免突变而不是返回值还有许多其他优点。数学将函数定义为输入值到输出值的映射不仅仅是偶然的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-17T04:07:21.750

其他人似乎都在暗示变量传递的差异，但我注意到一些不同的东西：

如果您正在显示的示例代码是您已经在查看的内容的简化，那么您可能需要在第二个示例中注意：

```
private int DoSomething(int value) {
    return value++;
} 
```

将`value`返回**然后**递增。因此，如果您执行以下操作：

```
public Main() {
    int val = 1;
    Console.writeln(DoSomething(val));
} 
```

您的输出将是`1`.

让我知道这是否有帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T03:56:32.540

只是第一个不起作用，因为您正在对价值副本进行操作。

你可以做类似的事情

```
private int DoSomething(ref int value)
{
  value++;
} 
```

并称它为

```
DoSomething(ref value); 
```

这会更改要通过引用传入的值。但实际上这样做的唯一原因是，如果你想从你的函数中返回不止一件东西。通常有更好的方法。

对于额外的奖励知识，还有类似于 ref 的 out 关键字，但不需要首先初始化值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T03:56:22.820

在您的第一个示例中， int 参数`value`递增，但在方法结束时被销毁，您无法获取方法外部的值，除非您使用[ref](http://msdn.microsoft.com/en-us/library/14akc2c7(VS.71).aspx)或[out](http://msdn.microsoft.com/en-us/library/t3c3bfhx.aspx)关键字。

例如：

```
private int DoSomething(ref int value) {
   return value++;
}

// ...
int myValue = 5;
DoSomething(ref myValue);
// Now myValue is 6. 
```

ref 和 out 参数传递模式用于允许方法更改由方法调用者传入的变量。ref 和 out 之间的主要区别可能很微妙，但很重要。

每种参数传递模式都旨在适应不同的编程需求。

**带有out**参数的方法的调用者不需要在调用之前分配作为 out 参数传递的变量；但是，该方法**需要**在返回之前分配给 out 参数。

一种考虑 out 参数的方法是，它们就像方法的附加返回值。当一个方法应该返回多个值时，它们很方便。

**ref**参数导致参数通过引用传递。其效果是，当控制权传回调用方法时，方法中参数的任何更改都将反映在该变量中。

*不要将通过引用传递的概念与引用类型的概念混淆*。

这两个概念不相关；方法参数无论是值类型还是引用类型都可以被ref修改，通过引用传递时没有值类型的装箱。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-17T03:55:16.130

对于大多数编程语言，您需要**通过引用**传递参数来更改您的 void 函数。一个函数通常不能改变其参数的值；相反，它会创建参数的副本并使用它。

为了使用实际变量，您必须更改函数头以接受对变量的引用，前面带有与号 (&)，如下所示：

```
private void DoSomething(int &value) 
```

希望有帮助！

# unix - 如何让人类和程序访问同一个文件而不互相踩到对方的脚趾

> ID：555494
> 
> 赞同：2
> 
> 时间：2009-02-17T04:01:47.753
> 
> 标签：unix, locking, monitoring, utilities, file-locking

假设我有一个文件 urls.txt，其中包含我正在监视的 URL 列表。我的监视脚本偶尔会编辑该文件，例如，以指示每个 URL 是否可访问。我还想手动编辑该文件，以添加或更改 URL 列表。我怎样才能允许这样我在手动编辑时不必考虑它？

以下是一些可能的答案。你会怎么做？

1.  从事黑客活动，例如让程序检查 vim 或 emacs 创建的锁定文件。因为这只是为了我，所以这实际上会起作用。

    *   如果人工编辑始终优先，则始终让人工破坏程序的更改（例如，忽略编辑器关于文件已在磁盘上更改的警告）。然后程序可以在下一个循环中重做它的更改。尽管如此，在用户编辑文件时更改文件并不是那么好。

    *   永远不要让人接触程序正在进行修改的文件。重新考虑设计并拥有一个只有人工编辑的文件和另一个只有程序编辑的文件。

    *   为人类提供一个自定义工具来编辑执行适当文件锁定的文件。这可能与锁定文件然后启动编辑器或自定义界面（可能是简单的命令行界面）一样粗略，用于从文件中插入/更改/删除条目。

    *   使用数据库而不是平面文件，然后自动处理所有锁定。

（请注意，我编写了 URL 监控示例以使其更加具体，并且因为我实际上想到的可能太奇怪和分散注意力——这个问题严格来说是关于如何让人类和程序都修改同一个状态文件。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T04:05:18.087

我会使用数据库，因为这基本上是您必须构建的，以实现您想要的。为什么要重新发明轮子？

如果成熟的 DBMS 负担过重，请将文件分成两个并定期同步它们。URL 是否可访问听起来不像用户会更改的内容，因此不应由他们编辑。

在同步过程中（这将不得不锁定监视器和用户，尽管它可能是监视器的子功能），删除监视器文件中未在用户中完整的条目。此外，将已添加到用户文件中的那些添加到监视文件中（并开始监视它们）。

但是，我会为用户使用带有特殊前端的数据库方法，因为您现在可以获得相对较好的轻量级数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T05:21:40.650

使用合理的版本控制系统！

（Git 在这里工作得很好）。

也就是说，问题的本质意味着真正的数据库是最好的——它们通常具有数据库级、表级或行级锁定——然后将您需要的任何脚本放入版本控制中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T04:41:50.590

我会选择选项 3。事实上，我会让程序读取人工编辑的输入文件，并将每个查询的结果附加到日志文件中。通过这种方式，您还可以分析网站随时间的可达性。您还可以让程序维护一个文件，该文件指示输入文件中每个站点的当前可达性状态，作为当前状态的快照。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:52:26.780

另一种选择是使用两个文件，一个用于自动访问，一个用于手动访问。您需要在用户文件中使用一种方法来指示修改或删除，但在其他一些解决方案中也会遇到类似的问题。

# silverlight - 何时取消挂钩 Silverlight 中的事件

> ID：555497
> 
> 赞同：5
> 
> 时间：2009-02-17T04:04:25.623
> 
> 标签：silverlight, events, mvvm

**一句话总结：**在 Silverlight2 的 UserControl 的构造函数中创建的 unhook 事件处理程序的最佳实践是什么？

**背景：** 我目前正在 Silverlight2 中构建一个业务线应用程序。由于 Silverlight 是一个浏览器插件，因此没有 Window 的概念 - 一切都在 UserControls 中完成。我在应用程序中处理不同“表单”的方式是拥有一个包含 Viewbox 的顶级用户控件。为了显示不同的表单，我将 Viewbox 的 Child 属性设置为不同的 UserControl。我的应用程序有一个单独的 PageManager 类，调用它来打开和关闭表单。表单 (UserControls) 存储在堆栈中。打开一个表单将它放在堆栈的顶部，关闭它会将它从堆栈中删除并显示它下面的一个。

我正在尝试遵循 Model-View-ViewModel 模式。在每个表单（从 UserControl 派生）中，我都有一个 ViewModel 来管理视图的所有数据。ViewModel 公开事件，以便在加载和保存等操作完成时通知 UI。

在我的表单中，在获得 ViewModel 之后，我订阅了构造函数中的事件

```
public partial class MyPage : UserControl
{

    public MyViewModel ViewModel{get; set;}

    // other constructors, which create the viewmodel and call the constructor below.

    public MyPage(MyViewModel viewModel)
    {
        InitializeComponent();
        ViewModel = viewModel;
        this.LayoutRoot.DataContext = this.ViewModel;

        // subscribe to event so we can do stuff
        this.ViewModel.LoadCompleted += new MyViewModel.LoadCompletedEventHandler(ViewModel_LoadCompleted);
    } 
```

我的问题是：既然我已经订阅了这个事件，我什么时候删除处理程序？我是创建一个析构函数并在那里执行它，还是创建一个先有鸡还是先有蛋的情况，即垃圾收集器在所有引用（即：事件处理程序）都消失之前不会销毁对象？我是否创建了表单必须实现的接口，该接口指定了在 PageManager 关闭表单时调用的 UnhookEvents 函数？

编辑：感谢您的回复。ViewModel持续时间长于表单（UserControl）的情况呢？我的应用程序的一部分允许用户创建相当复杂的结构，但在 95% 的情况下它要简单得多。我所做的是创建 2 个使用相同 ViewModel 的表单。用户可以开始填写简单的表单，然后切换到高级模式，这将创建一个新表单，并将 ViewModel 传递给它。

在简单的设置表单中：

```
 private void AdvancedSessionSetupButton_Click(object sender, RoutedEventArgs e)
    {
        PageManager.GetPageManager().Close(this);
        PageManager.GetPageManager().Open(new CreateSessionPage(this.ViewModel), "Create Session");
    } 
```

在高级设置表单中：

```
 private void BasicSessionSetupButton_Click(object sender, RoutedEventArgs e)
    {
        PageManager.GetPageManager().Close(this);
        PageManager.GetPageManager().Open(new CreateBasicSessionPage(this.ViewModel), "Create Session");
    } 
```

在 PageManager.Close 之后，唯一引用表单的是 ViewModel 中的事件。我想这就是我应该解开它们的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T09:56:35.560

在这种情况下，不需要 C# 程序员通常称为终结器的析构函数。假设 ViewModel_LoadCompleted 是一个成员函数，它包含一个指向“this”的指针，您将其提供给完全包含在“this”中的 ViewModel 对象。垃圾收集器应该明智地忽略这一点。

在这种情况下，正确的做法是不要浪费时间解绑它们。

通常，当您将“this”（显式或隐式）传递给某个对象，该对象将持有该引用比“this”的预期生命周期更长时，您需要取消绑定事件处理程序。例如，如果您在父控件的事件上设置处理程序。现在，父级通过处理程序及其子控件集合对您进行了引用。在这种情况下，您应该在从父级中移除时解除绑定。

如有疑问，请在对 Dispose() 的调用中实现 IDisposable 并取消绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T09:22:23.427

当垃圾收集器通过您的对象时，事件会自动解除绑定。

但是您可以随时使用“-=”语法显式取消绑定它们：

```
this.ViewModel.LoadCompleted -= ViewMode_LoadCompleted; 
```

您可以实现析构函数：

```
~MyPage
{
    this.ViewModel.LoadCompleted -= ViewMode_LoadCompleted;
} 
```

# java - 如何将以下程序的十六进制转换为字节？

> ID：555503
> 
> 赞同：2
> 
> 时间：2009-02-17T04:07:31.327
> 
> 标签：java

```
public static String asHex (byte buf[]) {
    StringBuffer strbuf = new StringBuffer(buf.length * 2);
    int i;

    for (i = 0; i < buf.length; i++) {
        if (((int) buf[i] & 0xff) < 0x10)
            strbuf.append("0");

        strbuf.append(Long.toString((int) buf[i] & 0xff, 16));
    }

    return strbuf.toString();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T04:49:32.583

这是一个完整的程序，其中包含`asBytes()`我假设您正在寻找的功能，与`asHex()`：

```
public class Temp {
    public static String asHex (byte buf[]) {
        StringBuffer strbuf = new StringBuffer(buf.length * 2);
        int i;
        for (i = 0; i < buf.length; i++) {
            if (((int) buf[i] & 0xff) < 0x10)
                strbuf.append("0");
            strbuf.append(Long.toString((int) buf[i] & 0xff, 16));
        }
       return strbuf.toString();
    }
    public static byte[] asBytes (String s) {
        String s2;
        byte[] b = new byte[s.length() / 2];
        int i;
        for (i = 0; i < s.length() / 2; i++) {
            s2 = s.substring(i * 2, i * 2 + 2);
            b[i] = (byte)(Integer.parseInt(s2, 16) & 0xff);
        }
        return b;
    }
    static public void main(String args[]) {
        byte[] b = Temp.asBytes("010203040506070809fdfeff");
        String s = Temp.asHex(b);
        System.out.println (s);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T04:15:36.113

要获取字节数组的十六进制字符串表示，您可以使用[`String.format()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#format(java.util.Locale,%20java.lang.String,%20java.lang.Object...))格式`%X` [说明符](http://java.sun.com/javase/6/docs/api/java/util/Formatter.html#syntax)：

```
public static String asHex(byte buf[]) 
{
    StringBuffer strbuf = new StringBuffer(buf.length * 2);

    for (byte b : buf)
       strbuf.append(String.format("%02X", b));

    return strbuf.toString();
} 
```

下面的方法给出了逆运算，返回一个十六进制字符串的字节数组表示。它使用[`Byte.parseByte()`](http://java.sun.com/javase/6/docs/api/java/lang/Byte.html#parseByte(java.lang.String,%20int))和一些位移来在一个字节中获取两个字符：

```
public static byte[] asBytes(String str)
{
    if ((str.length() % 2) == 1) str = "0" + str; // pad leading 0 if needed
    byte[] buf = new byte[str.length() / 2];
    int i = 0;

    for (char c : str.toCharArray())
    {
        byte b = Byte.parseByte(String.valueOf(c), 16);
        buf[i/2] |= (b << (((i % 2) == 0) ? 4 : 0));
        i++;
    }

    return buf;
} 
```

# c++ - C++ 中何时引入了“and”和“or”替代标记？

> ID：555505
> 
> 赞同：40
> 
> 时间：2009-02-17T04:08:51.340
> 
> 标签：c++, syntax, keyword, digraphs, trigraphs

我刚刚从 Reddit读到这篇[不错的文章。](http://www.vandevoorde.com/C++Solutions/)

他们提到`and`并`or`成为“替代代币`&&`”`||`

直到现在我才真正意识到这些。当然，每个人都知道[二合图和三合图](http://en.wikipedia.org/wiki/C_trigraph)，但是`and`和`or`？从何时起？这是该标准的最新补充吗？

我刚刚用 Visual C++ 2008 对其进行了检查，它似乎没有将这些识别为语法错误之外的任何东西。这是怎么回事？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-17T04:18:01.740

从第*一个*ISO C++ 标准开始`C++98`，这在中有所描述`2.5/ Alternative tokens [lex.digraph]`：

* * *

1.  为某些运算符和标点符号提供了替代标记表示。
2.  在语言的所有方面，除了拼写之外，每个替代标记的行为分别与其主要标记相同。表 2 中定义了一组替代令牌。

```
Table 2 - Alternative tokens

    alternative primary | alternative primary | alternative primary
    --------------------+---------------------+--------------------
       <%          {    |    and         &&   |    and_eq      &=
       %>          }    |    bitor       |    |    or_eq       |=
       <:          [    |    or          ||   |    xor_eq      ^=
       :>          ]    |    xor         ^    |    not         !
       %:          #    |    compl       ~    |    not_eq      !=
       %:%:        ##   |    bitand      &    | 
```

* * *

因此，从 C++ 标准化过程的早期开始，它就一直存在。很少有人知道它的原因可能是因为主要用例是针对在不一定可用完整字符集的环境中操作的人。例如（这让我记忆犹新），IBM 大型机上的基线 EBCDIC 字符集没有方括号字符`[`和`]`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-17T04:21:56.800

`/Za`仅当您使用禁用扩展的选项时，MSVC 才支持将它们作为关键字；至少从 VC7.1 (VS2003) 开始是这样。

您可以通过包含`iso646.h`.

我的猜测是，他们认为默认将它们设为关键字会破坏太多现有代码（如果它们是正确的，我不会感到惊讶）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-07-15T20:32:56.307

要真正回答这个问题：

它们是在第一个 C++ 标准中定义的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-17T04:19:02.097

请参阅 C++ 标准。委员会草案 #2 可在以下网址免费获得[ftp://ftp.research.att.com/dist/c++std/WP/CD2/body.pdf](ftp://ftp.research.att.com/dist/c++std/WP/CD2/body.pdf)，虽然它是非权威的、过时的并且在一些地方部分不正确。具体来说，在第 2.5 节，**替代令牌**中，定义了以下内容：

```
替代小学
<%{
%> }
<：[
:> ]
%：#
%:%: ##
和 ＆＆
比特|
或 ||
异或^
编译~
比特和
and_eq &=
or_eq |=
xor_eq ^=
不是 ！
not_eq !=

```

`and`虽然老实说，除了、`or`和之外，我从未见过使用过它们中的任何一个`not`，即便如此，这些也很少见。请注意，这些默认情况下在纯 C 代码中是不允许的，仅在 C++ 中。如果您想在 C 中使用它们，您必须`#define`自己将它们用作宏，或者将其定义为除宏之外的所有上述内容`#include`的 header （请参阅 C99 标准的第 7.9 节）。`<iso646.h>``<%` `>%` `<:` `:>` `%:` `%:%:`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-19T15:29:48.400

虽然问题很老，但我想为它提供或多或少的完整答案：替代令牌已经是当前撤回的 C++98 的一部分（[ISO/IEC 14882:1998](https://www.iso.org/standard/25845.html)，我相信这是第一个C++ 的 ISO 标准）。虽然本身不​​是证明（而且我没有 c++98 的 ISO 副本），但[这里有一个链接 - 请参阅 C++ 部分。](https://en.wikipedia.org/wiki/C_alternative_tokens)

如其他答案中所述，MSVC 编译器在未指定*/Za标志时违反了标准的***[lex.digraph]**部分。

 ** * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T04:14:51.997

您可能会惊讶地了解其中的其余部分：

```
and and_eq bitand bitor compl not not_eq or or_eq xor xor_eq 
```

[C++ 关键字](http://cs.smu.ca/~porter/csc/ref/cpp_keywords.html)列表。

我相信最新版本的 GCC 支持这些关键字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T04:19:29.443

GNU 编译器 g++ 有它们，但我不知道 MS VC++。

您可以通过将其放在代码文件的顶部来获得相同的功能。

```
#define and &&
#define bitor |
#define or ||
#define xor ^
#define compl ~
#define bitand &
#define and_eq &=
#define or_eq ^=
#define xor_eq ^=
#define not !
#define not_eq != 
```

虽然这有点骇人听闻，但它应该可以工作。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-17T04:15:17.517

它们位于新 C++ 标准的工作文件中，第 14 页： [C++ 标准](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf)

# silverlight - 如何让 AccessKey 或 AcceleratorKey 在 Silverlight 中工作？

> ID：555515
> 
> 赞同：0
> 
> 时间：2009-02-17T04:16:49.010
> 
> 标签：silverlight, keyboard-shortcuts, accessibility

我希望用户从键盘访问我的 Silverlight 2 应用程序中有一些按钮。

如果我理解正确，我应该能够使用 AutomationProperties.AccessKey。例如：

```
<Button Content="Close" Name="btnClose" AutomationProperties.AccessKey="CTRL+Q" HorizontalAlignment="Left" /> 
```

但我不能让它工作吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T19:28:18.710

不幸的是，SL 不直接处理 AccessKey（或 AcceleratorKey）属性。这意味着您仍然必须在应用程序中捕获 KeyDown 事件并在那里激活功能。据我所知，设置 AccessKey/AcceleratorKey 属性的唯一优点是将您的意图通知给屏幕阅读器等。

# c# - 为什么 Visual Studio IDE 有时会初始化“this.components 对象：”而其他时候不会？

> ID：555526
> 
> 赞同：14
> 
> 时间：2009-02-17T04:24:47.260
> 
> 标签：c#, visual-studio, winforms, visual-studio-2008, visual-studio-2005

我最近注意到 Visual Studio Designer (C#) 的一些行为，我不明白，想知道是否有人可以澄清......

我的一些 Windows 窗体，设计器生成的代码的第一行读取；

```
this.components = new System.ComponentModel.Container(); 
```

在这种情况下，dispose 方法在同一个设计器文件中，dispose 方法将两个“Dispose”调用放置在 case“if”条件中，如下所示；

```
 protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
            base.Dispose(disposing);
        }
    } 
```

即，除非 disposing 为 true，否则不会调用任何内容，AND components 不为空。

在其他一些形式中，设计器生成的代码中的第一行丢失了。在这些情况下，base.Dispose 调用在“if”条件之外......

```
 protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    } 
```

我在跟踪表单未关闭的错误时注意到了这一点，其中 this.components 为空，但 base.Dispose 调用在该条件内（我怀疑设计器代码已被篡改，但这是另一回事。

是什么控制了这种行为？

（项目中的一些早期表单是在 VS 2005 中创建的，我们现在使用 VS 2008 - 线索？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T18:25:41.497

这是可重现的行为。当您创建一个新表单时，它会从一个包含 this.components 构造函数调用的骨架开始。然后，当您添加一个组件（例如 Timer）并再次删除它时，设计器会重新生成代码，现在无需调用构造函数。那不是错误。

Fwiw，骨架代码由`Common7\IDE\ItemTemplates\CSharp\Windows Forms\1033\Form.zip\form.designer.cs`

在 if() 语句中看到 base.Dispose() 调用是一个错误。那可能是自作自受。或者它可能是骨架代码的测试版。VS2005 做得对。请检查 ItemsTemplatesCache 文件夹。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-22T07:21:04.323

6年后，这个问题仍然存在。我已经设法找到它发生的至少一个原因。

在测试您的组件是否具有采用 IContainer 的构造函数时，System.ComponentModel.Design.Serialization.ComponentCodeDomSerializer 为您的项目缓存对 IContainer 类型的引用。如果您随后在同一个解决方案中为另一个项目保存了一个对象，或者当您在项目中进行了一些其他类型的更改时，ComponentCodeDomSerializer 将无法再找到构造函数，因为 IContainer 的类型不再等于它的缓存类型。

如果您的项目经常发生这种情况，那么有一个非常丑陋的解决方法。将此[VB](http://pastebin.com/tB3VGZDc)或[C#](http://pastebin.com/LUcFdGHD) `VisualStudioWorkaroundSerializer`类添加到您的解决方案中。然后将属性添加`DesignerSerializer(GetType(VisualStudioWorkaroundSerializer), GetType(CodeDomSerializer))`到您的组件。每当保存您的组件时，此自定义序列化程序将检测问题并修复它，并在此问题即将发生时强制您再次保存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T04:57:55.980

有趣的故障！它确实听起来像一个版本的设计器/模板中的错误。当然，如果您认为设计器代码已被篡改，那么无论如何，所有的赌注都差不多...

但是，在 VS2008 中，它生成的版本无疑是正确的：

```
if (disposing && (components != null))
{
    components.Dispose();
}
base.Dispose(disposing); 
```

所以`Dispose(...)`叫基地。不幸的是，我没有方便的 VS2005 来测试它。但是 - 它不会初始化组件，直到它必须 - 声明是：

```
private System.ComponentModel.IContainer components = null; 
```

然后*，如果*需要，将其填充到`InitializeComponent`：

```
private void InitializeComponent()
{
    this.components = new System.ComponentModel.Container();
    //...
} 
```

我猜这个结构只需要维护`InitializeComponent`（而不是字段本身）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T05:27:34.053

我已经看到这种情况发生了，并且我偶尔也会从 Dispose 方法中收到有关组件的警告，这些组件要么从未分配过其值，要么没有被定义。

我认为这是两件事的结合：

1.  Visual Studio 版本之间的代码生成略有不同
2.  Dispose 方法仅在文件中没有时才会生成，而 InitializeComponent（和相关的声明）每次都会生成

这会导致 InitializeComponent/declarations 部分与 Dispose 方法不符。

# .net - JSON-P 与 WCF 的示例？

> ID：555529
> 
> 赞同：3
> 
> 时间：2009-02-17T04:30:19.137
> 
> 标签：.net, wcf, json, cross-domain, jsonp

我正在尝试制作一个可以与 JSON-P 一起使用的 WCF 服务（长话短说，我们必须跨域调用 Web 服务并接收回调，所以我需要它与 JSON-P 一起使用）。

[我在 MSDN ( http://msdn.microsoft.com/en-us/library/cc716898.aspx](http://msdn.microsoft.com/en-us/library/cc716898.aspx) )上找到了一个代码示例。如果我提取 ZIP 文件并导航到 Samples\WCFWFCardSpace\WCF\Extensibility\Ajax\JSONP\CS，我会得到一个项目，其中创建了某些绑定和扩展，这将使 WCF 能够发出对返回 JSON 后的 JS 函数。

不幸的是，当我尝试复制此代码并在我的项目中实现它时，它不起作用。

我收到以下错误：

找不到配置绑定扩展“system.serviceModel/bindings/jsonpBinding”。验证此绑定扩展是否已在 system.serviceModel/extensions/bindingExtensions 中正确注册并且拼写正确。

就好像微软的开发人员遗漏了一些重要的代码，而我不确定他们遗漏了什么或它的目的是什么。

有没有人有使用 WCF 和 JSON-P 的经验？

如果有办法让这个示例项目工作，我会全力以赴。

如果有另一种方法可以从 Javascript 到 WCF 进行跨域 Web 服务调用，我也很感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T14:37:07.273

您可以在问题中包含您的 web.config 文件吗？

您收到的消息是由于您的 web.config 中的扩展元素不存在或无效。

验证以下

```
<system.serviceModel>
  <!-- client, behavior, and bindings -->   
  <extensions>
    <bindingElementExtensions>
      <add name="jsonpMessageEncoding"
           type="Namespace, Assembly, Version=X.X.X.X, Culture=neutral, PublicKeyToken=null"/>
    </bindingElementExtensions>
  </extensions>    
</system.serviceModel> 
```

# c# - 什么时候，如果有的话，我们应该使用 const 吗？

> ID：555534
> 
> 赞同：30
> 
> 时间：2009-02-17T04:34:05.367
> 
> 标签：c#, constants, readonly

`Const`被烘焙到客户端代码中。`Readonly`不是。但是`const`速度更快。可能只是轻微的。

`const`问题是，有没有你更喜欢的场景`readonly`？或者换种说法，我们实际上不是*总是*`readonly`用 a代替 a更好`const`吗（记住上面所说的烘焙）？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-17T04:39:55.773

我相信“const”唯一合适的时候是当你编写的规范比你正在编写的程序更耐用时。例如，如果您正在实现 HTTP 协议，则为“GET”设置一个 const 成员是合适的，因为它永远不会改变，并且客户端当然可以将其硬编码到他们编译的应用程序中，而不必担心您需要更改以后值。

如果您有任何机会在未来的版本中更改该值，请不要使用 const。

哦！除非你已经测量过，否则永远不要假设 const 比只读字段快。有 JIT 优化可以做到这一点，所以它实际上是完全一样的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-17T05:13:04.570

[const 与 readonly](http://weblogs.asp.net/psteele/archive/2004/01/27/63416.aspx)：

> 关于 C# 中 'const' 和 'readonly' 之间区别的快速概要：'const'：
> 
> *   不能是静态的。
> *   ***在编译时评***估值。
> **   仅在声明时初始化。*
> 
>  *'只读'：
> 
> *   可以是实例级的或静态的。
> *   ***在运行***时评估值。
> **   可以在声明中初始化，也可以通过构造函数中的代码初始化。**

 ****更正：**上述状态 const 不能是静态的。那是用词不当。它们不能应用 static 关键字，因为它们已经是静态的。

因此，您将 const 用于要在编译时评估的静态项目。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T04:50:42.127

您可以在 switch 语句中使用 const 值作为 case，fwiw。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T04:37:40.973

当初始化不直接时， readonly 很有用。
当您在编译之前确定该值时，可以使用 const。

在某种程度上， readonly 是一个运行时常量 & const 是一个编译时常量值。

编辑：如果您使用 www.koders.com 查看一些代码，您会发现在可以使用 const 的地方使用 readonly。我认为，其背后的原因可能是它可以在构造函数中修改（如果需要）。在 const （尤其是 public）的情况下，您有机会根据您的代码破坏客户端代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T16:53:14.857

我通常只将 const 用于我知道**永远不会**改变的事情，例如真空中的光速。

*对于可能*发生变化的事情，我更喜欢 readonly 。这样，如果发生更改，我只需要重新编译一个 dll。这个经验法则的一个例外是变量是否对其自己的程序集是私有的/受保护的/友好的。在这些情况下，使用 const 是安全的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T04:51:39.380

const 不能用于类或结构（字符串常量和 null 除外，正如 Skeet 先生指出的那样），只能用于值类型并作为静态字段访问。const 的值在编译时设置，并且必须在声明时设置。

readonly 可用于除枚举之外的任何内容，并且可以是静态字段或实例字段。只读的值是在运行时设置的，可以根据调用的构造函数进行不同的设置。

这是 const、readonly 和 static 关键字概述的[好页面。](http://en.csharp-online.net/const,_static_and_readonly)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T07:41:58.427

您应该更喜欢在编译时测试的修饰符，而不是在运行时测试的修饰符（在这种情况下 const 而不是 readonly）。并且您应该始终使用支持您需要的语义的修饰符。如果某些东西不打算被修改 - 保护它，否则有人会写一些东西（偶然或无知）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T04:37:24.423

只要可以在声明中设置值并且不必等待构造函数，就应该使用 const。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T05:17:03.423

const 的一个很好的用途是用于键/值对的键。*例如，如果您仍在使用 AppSetting（而不是 ApplicationSettings），则将密钥的名称加载*到配置设置中没有任何意义。如果在多个地方使用，请将 Key 粘贴在 const 中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-26T08:20:42.073

`const`当您的字段是**简单类型**（数字、布尔值或字符串）并且它们的值永远不会更改时使用。如果更改它们的值，则应重新编译项目。

**当它们从另一个源（文件、数据库或其他代码、..等）初始化时**使用`readonly`字段，但它们不会被更改。

 ****当您想让它们被所有实例共享**时使用`static readonly`字段。

 *** * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-07T12:20:54.253

我发现 const 的一个特殊用途是属性中使用的可重用“魔术”字符串，因为它们只能是 const，你不能使用静态只读。

我的特殊用例是 ASP.NET 授权属性

```
[Authorize(Roles = Roles.FirstParty)] 
```

# asp.net - 运行 Ajax Control Toolkit 的问题

> ID：555537
> 
> 赞同：0
> 
> 时间：2009-02-17T04:36:12.740
> 
> 标签：asp.net, ajaxcontroltoolkit

当我运行任何 Ajax 控件时，我收到以下错误：这是用 .net 2.0 编写并在 .net 3.5 上运行的。

请帮助我我需要更改的设置是什么。

“错误 32 无法加载文件或程序集 'System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。系统找不到指定的文件。D:\DotNet\AJAX \Ajax 视频\HDI-ACT-Accordion-CS\web.config 30 "

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T05:11:43.247

查看错误消息，您可能在 web.config 中有对 System.Web.Extensions.dll 的引用（提及）。

尝试从 web.config 中删除该行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T05:47:05.130

如果机器没有 System.Web.Extensions.dll 的 2.0 版本，那可能是您的问题。您可能需要从此处重新下载/安装 Ajax 扩展的 .NET 2.0 版本：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa-e8c9-42e3-aa19-08e2c027f5d6&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa-e8c9-42e3-aa19-08e2c027f5d6&displaylang=en)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T15:52:23.297

你说过：

> 这是用 .net 2.0 编写的，并在 .net 3.5 上运行。

我假设您的意思是该站点最初是使用 ASP .Net 2.0 编写的，但后来升级到了 ASP .Net 3.5。如果是这种情况，则可能是您对 System.Web.Extensions 版本 1 的引用不正确。这可以通过以下步骤进行补救：

1) 在 web.config 中添加对 System.Web.Extensions v3.5 的引用：

```
<assemblies>
   <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
</assemblies> 
```

2) 在 web.config 中添加以下内容作为配置的子项：

```
<configuration>
   <!--Some other config-->
   <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
         <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
         <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
   </assemblyBinding>
</configuration> 
```

正如 brenden 所提到的，您可能还需要正确版本的 Ajax Toolkit。

# messages - SWIFT MT 消息验证

> ID：555550
> 
> 赞同：1
> 
> 时间：2009-02-17T04:43:45.797
> 
> 标签：messages, swift-mt

我正在寻找可用于 - SWIFT 消息语法验证 - 从可用数据构建 SWIFT 消息的 java 库或 vb 插件。- 检索所需的标签/字段数据。

有人可以在这方面帮助我吗？

## 我见过很少有可用的库，如 WIFE，但如果消息不是标准格式，所有库都无法捕获错误。

帕万

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-01T07:17:32.527

使用“SWIFT 消息语法验证”我猜您是在谈论正确获取 FIN 语法？

如果是这样，我刚刚在 StackOverflow 上发布了另一个与 SWIFT 相关的问题的答案。

为了您的方便，我再次复制并粘贴了我的回复（从这里：[java-swift-library](https://stackoverflow.com/questions/25192/java-swift-library)）：

* * *

SWIFT 正在发布一个“标准开发工具包”，其中包括一个“MT/XML 模式库”。

来自文档：“MT/XML 模式库是一整套用于 MT 消息的 XML 模式定义，以及显示如何将消息从 MT 格式转换为 MT XML 表示并返回的软件。这种方法允许应用程序之间的 XML 集成而 MT (FIN) 格式将继续通过 SWIFT 网络传输。”

Java 源代码也将提供，同样来自文档：“将 MT 格式的消息转换为 XML 实例以及从 XML 实例转换为 MT 格式的消息的工作示例 Java 源代码。”

见：[https ://www.swiftcommunity.net/communities/download.cfm?id=4798](https://www.swiftcommunity.net/communities/download.cfm?id=4798)

这对于处理 XML 语法中的 FIN 消息非常有帮助。

* * *

因此，使用“标准开发工具包”，您不必再担心获得正确的 FIN 语法。

希望对你有用，

斯蒂金。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T19:49:44.727

我们使用 WIFE，并且必须在使用 WIFE 构造消息之前对 Swift 标签数据进行验证。我不相信 WIFE 提供任何验证。

**更新**：谷歌[搜索](http://www.google.com/search?q=swift+validation)出现了[AnaSys](http://www.anasys.com/Services/swiftvalidationservice/)服务以及其他一些看起来很有希望的服务。

# flash - Flash：如何做多页Flash应用？

> ID：555558
> 
> 赞同：0
> 
> 时间：2009-02-17T04:50:31.957
> 
> 标签：flash

我们需要创建一个 Flash 应用程序，其中会有一个“菜单页”。
当您单击此处的链接时，它将带您进入另一个布局和功能完全不同的页面。

现在我是 Flash 新手，想知道这通常是如何完成的。

如果是 HTML，您将创建 2 个相互链接的 HTML 页面。
您是否创建了两个单独的 Flash 应用程序？或者，还有更好的方法？

我可能会使用 FlexBuilder 进行编码，创建 .as 文件——如果这与此有关的话。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T04:56:48.183

通常，您将所有页面拆分为不同的 swf 文件并根据需要加载/卸载它们。如果您打算使用 ActionScript 3，请参阅[Loader 类](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Loader.html)的文档。

通常我所做的是创建一个主文档，其中包含一个像 a 这样的内容容器`Sprite`，以及所有加载方法、主内容菜单、进度条等。所有加载的页面都添加到这个内容容器中，所有的“内容链接” " 调用主文档加载方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-17T02:40:11.463

在 Flash builder 4 中，您必须能够管理状态。有一个状态窗口，您可以在其中管理这些状态，您可以选择将元素添加到所有状态或仅添加特定状态。

状态可以是完全不同的页面，也可以只是一个应用程序的不同状态。我用它来轻松管理一系列对话框。

更改状态也很简单，只需执行以下操作：

```
currentState="State2"; 
```

我发现在 Flash 中创建和在 FlashDevelop 中编程很有趣，但这是 flex 独有的选项

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T05:49:02.970

有很多方法可以制作这样的页面。最简单的方法是在 Flash IDE 中的 MovieClips 中制作您想要的所有页面，并在用户单击按钮时对其进行动画处理。

它看起来像这样：

```
myButton.addEventListener(MouseEvent.CLICK, onClickHandler);

function onClickHandler(e:MouseEvent):void {
  //animate stuff
} 
```

Flex 应该负责您的导入。

此外，您可以考虑将[Tweener](http://code.google.com/p/tweener/)用于您的动画，如果您真的喜欢它，请查看[swfAddress](http://www.asual.com/swfaddress/)。

# crud - 基于 HTA 的 Crud 应用程序的设计建议

> ID：555563
> 
> 赞同：1
> 
> 时间：2009-02-17T04:56:13.177
> 
> 标签：crud, hta, wordml

我正在为各种内部 CRUD 应用程序开发一个框架。我已经考虑了几种 MS 技术（WPF、Access、WinForms、ASP.NET），并且已经为客户端选择了带有 HTA+Jquery 的 ASP.NET MVC。我这样做的原因是，我需要一种方法来编写和部署快速的一次性 GUI 应用程序，以及维护预计具有较长生命周期的更强大的应用程序。

首先，对于在客户端使用 ADODB 与在服务器端使用 ADO.NET 的相对优点，我将不胜感激。我倾向于 ADODB，因为我将拥有对 SQL Server 的客户端访问权限（我已经编写了一个处理与 ADODB 交互的 js 库）。但是，我可以看到开发 RESTful 服务最终可能会有用。

其次，我需要将报告功能整合到系统中。我可以使用 SQL Server 报表服务或水晶报表，但用户已经习惯了一些使用 VBA 在 Word 中编写报表的旧应用程序；所以我正在考虑使用 WordML 来编写报告。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T05:22:30.117

**数据库访问**

如果您需要一个瘦客户端，那么最好不要从客户端直接访问数据库。

主要问题是您将引入对特定网络架构的高度依赖，并且您的 ASP.Net 应用程序和 HTA 都将高度依赖数据库。

相反，我更愿意切断对数据库的直接视线的依赖，并让数据由服务器处理。

这有几个优点：

*   对于数据库的许多小的更改，您可能只需要更新 ASP 应用程序。

*   如果您需要您的客户端应用程序在 Internet 上运行（例如，因为一些用户要参加外部会议、需要下班或您的公司开设新分支机构），那么您将不必重写您的瘦客户端。

*   您可以更好地控制对资源的访问：只让 ASP 应用程序与数据库对话并过滤输入/输出的内容。
    这将使您不必在客户端实现所有安全性：ASP 应用程序成为数据库的守护者。这是一种更好的保护信息的方法，它为您提供了更多的控制权。

**报告**

对于报告，我会再次使用服务器，而不是在客户端本身实现复杂的报告功能。
问题是，如果您使用 HTA 并且不想开始在每个用户的机器上安装依赖项，那么您将始终受到客户端的限制。
你很快就会建立一个*胖*客户端......

如果您使用的是 ASP.Net，那么有很多非常好的报告工具可以让您的生活更轻松，并允许您的用户在 Excel、Word、PDF 等中获得漂亮的报告，而无需您自己编写这些功能。
Crystal Reports 没问题，但还有更好更简单的替代方案，例如[Developer Express Report](http://devexpress.com/Products/NET/Reporting/)引擎非常易于使用。

# sql - SQL Server 中的 DateCreated 列？

> ID：555567
> 
> 赞同：7
> 
> 时间：2009-02-17T04:57:56.853
> 
> 标签：sql, sql-server, sql-server-2005, linq-to-sql, datecreated

是否有一种特殊的方法可以在 MS Sql Server 表中声明 DateCreated 列，以便在创建时自动使用适当的时间戳填充它？

或者..我是否必须在手动进行查询时向它提供日期时间？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-17T05:10:36.980

默认值有两个主要缺点。

*   如果插入语句为列指定了一个值，则不使用默认值。
*   该列可以随时更新。

这意味着您不能确定这些值没有在您的控制之外进行修改。

如果您想要真正的数据完整性（以便确定行中的日期是创建日期），则需要使用触发器。

将列设置为当前日期的插入触发器和防止更改该列（或更准确地说，将其设置为其当前值）的更新触发器是实现 DateCreated 列的方法。

将列设置为当前日期的插入和更新触发器是实现 DateModified 列的方法。

**（来自用户 Gabriel 的编辑 - 这是我尝试按照描述实现这一点 - 我不是 100% 确定它是正确的，但我希望 OP 对其进行审查......）：**

```
CREATE TRIGGER [dbo].[tr_Affiliate_IU] 
   ON  [dbo].[Affiliate] 
   AFTER INSERT, UPDATE
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Get the current date.
    DECLARE @getDate DATETIME = GETDATE()

    -- Set the initial values of date_created and date_modified.
    UPDATE
        dbo.Affiliate
    SET 
         date_created = @getDate
    FROM
        dbo.Affiliate A 
        INNER JOIN INSERTED I ON A.id = I.id
        LEFT OUTER JOIN DELETED D ON I.id = D.id
    WHERE
        D.id IS NULL

    -- Ensure the value of date_created does never changes.
    -- Update the value of date_modified to the current date.
    UPDATE
        dbo.Affiliate
    SET
         date_created = D.date_created
        ,date_modified = @getDate
    FROM 
        dbo.Affiliate A 
        INNER JOIN INSERTED I ON A.id = I.id
        INNER JOIN DELETED D ON I.id = D.id 
END 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-17T04:59:20.953

您可以将列的默认值设置为“getdate()”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T11:31:26.330

我们在 CreatedDate 上有默认值，并且不使用触发器强制执行

有时我们想明确设置日期 - 例如，如果我们从其他来源导入数据。

存在应用程序错误可能会弄乱 CreateDate 的风险，或者对此感到不满的 DBA（我们没有非 DBA 直接连接到我们的 DB）

我想您可能会在 CreateDate 上设置列级权限。

折衷办法可能是让 INSERT TRIGGER 在 1:1 表中创建一行，以便该列位于主表之外。第二个表可以具有 SELECT 权限，其中主表具有 UPDATE 权限，因此不需要 UPDATE 触发器来防止对 CreateDate 的更改 - 这将在正常更新行时删除一些“权重”。

我想你可以在第二个表上有一个 UPDATE/DELETE 触发器来防止更改（在正常情况下永远不会执行，所以“轻量级”）

虽然有点痛苦，但拥有额外的表......可能有一个表用于所有 CreateDates - TableName，PK，CreateDate。大多数数据库架构师会讨厌这样......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T08:52:40.173

当然是。

这是为您提供的示例。

```
Create table #TableName
(
    ID INT IDENTITY(1,1) PRIMARY KEY,
    CreatedDate DATETIME NOT NULL DEFAULT GETDATE(),
    SomeDate VARCHAR(100)
)

INSERT INTO #TableName (SomeDate)
SELECT 'Some data one' UNION ALL SELECT 'some data two' 

SELECT * FROM #TableName 

DROP TABLE #TableName 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-17T08:30:39.293

设置默认值是不够的，你应该添加一个触发器来防止更新：

```
CREATE TRIGGER UpdateRecord ON my_table
AFTER UPDATE AS UPDATE my_table
SET [CreatedDate] = ((SELECT TOP 1 [CreatedDate] FROM Deleted d where d.[id]=[id])) 
```

# python - 获取当前包中所有模块的列表

> ID：555571
> 
> 赞同：0
> 
> 时间：2009-02-17T05:02:44.923
> 
> 标签：python, unit-testing, module, packages, python-2.5

这就是我想要做的：我想构建一个测试套件，它被组织成包，如 tests.ui、tests.text、tests.fileio 等。在这些包中的每个`__`init `__`.py 中，我想制作一个测试套件，包括该包中所有模块中的所有测试。当然，可以使用 unittest.TestLoader 完成所有测试，但似乎我必须单独添加每个模块。所以假设 test.ui 有编辑`_`窗口`_`test.py 和预览`_`窗口`_`test.py，我希望`__`init `__`.py 导入这两个文件并获取两个模块对象的列表。这个想法是我想自动化测试套件的制作，这样我就不会忘记在测试套件中包含一些东西。

最好的方法是什么？看起来这将是一件容易的事情，但我没有找到任何东西。

我正在使用 Python 2.5 顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T06:37:56.083

从我们的 django 项目中解决这个问题：

```
"""Test loader for all module tests
"""
import unittest
import re, os, imp, sys

def find_modules(package):
    files = [re.sub('\.py$', '', f) for f in os.listdir(os.path.dirname(package.__file__))
             if f.endswith(".py")]
    return [imp.load_module(file, *imp.find_module(file, package.__path__)) for file in files]

def suite(package=None):
    """Assemble test suite for Django default test loader"""
    if not package: package = myapp.tests # Default argument required for Django test runner
    return unittest.TestSuite([unittest.TestLoader().loadTestsFromModule(m)
                               for m in find_modules(package)])

if __name__ == '__main__':
    unittest.TextTestRunner().run(suite(myapp.tests)) 
```

编辑：与 bialix 的解决方案相比的好处是您可以将此加载程序放在项目树中的任何位置，无需在每个测试目录中修改**init** .py。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:36:55.720

这里有很好的答案，但**最好**的办法是使用 3rd 方测试发现和运行器，例如：

*   [鼻子](http://somethingaboutorange.com/mrl/projects/nose/)（我最喜欢的）
*   [试用](http://twistedmatrix.com/trac/wiki/TwistedTrial)（非常好，尤其是在测试异步内容时）
*   [py.test](http://codespeak.net/py/dist/test.html)（在我看来不太好）

它们都与普通的 unittest.TestCase 兼容，您不必以任何方式修改测试，也不必使用其中任何一个中的高级功能。只需用作套件发现。

您是否有特定的原因要重新发明这些库中的讨厌的东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T06:20:25.830

您可以使用 os.listdir 查找 test.* 目录中的所有文件，然后过滤掉 .py 文件：

```
# Place this code to your __init__.py in test.* directory
import os
modules = []
for name in os.listdir(os.path.dirname(os.path.abspath(__file__))):
    m, ext = os.path.splitext()
    if ext == '.py':
        modules.append(__import__(m))
__all__ = modules 
```

魔术变量`__file__`包含当前模块的文件路径。尝试

```
print __file__ 
```

去检查。

# ms-access - 组合框的问题

> ID：555573
> 
> 赞同：0
> 
> 时间：2009-02-17T05:04:20.160
> 
> 标签：ms-access, combobox

我有一个已转换为 2007 Access 的数据库。我最终重建了组合框。它们在活动数据库中都可以正常工作，但是一旦我关闭数据库并重新打开它 - 它们就不起作用并且显示了许多错误..

如果我以相同的方式创建第二个组合 - 那么两个组合都开始工作......但是一旦我关闭数据库并重新打开它......他们都停止工作了吗？

这些只是搜索当前 FORM 以查找记录的组合框。

即.. 字段“公司名称” - 组合正在搜索从下拉组合框中输入或选择的特定公司记录。

在数据库设置/信任中心中，我打开了 true all marcos 等。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T05:22:59.840

有几件事：

*   尝试反编译项目。它可能已损坏。
    只需从命令行打开文件并添加`/decompile`参数。
    然后重建你的项目并压缩它。

*   确保您在 VBA IDE > Tools > References... 中的引用包含正确的库：

    Visual Basic For Application
    Microsoft *Access* 12.0 对象库
    OLE 自动化
    Microsoft Office 12.0 Access 数据库引擎对象库
    Microsoft *Office* 12.0 对象库

OLE 自动化有时是奇怪问题的根源：它有时会在我的 Windows Server 2008 x64 机器上自动选择，但我必须在我的 Windows XP 32 位桌面上禁用它...

# ruby-on-rails - RubyOnRails 应用程序的 Thin + Nginx 生产就绪组合

> ID：555576
> 
> 赞同：3
> 
> 时间：2009-02-17T05:06:25.617
> 
> 标签：ruby-on-rails, deployment, nginx, thin

我最近在我的部署服务器上安装了 Nginx + Thin，但我不确定这在最后的请求和响应情况下会如何执行。让我们说每秒 1000/req。

所以瘦的速度很好，每秒 10-100 个请求

我想知道请求/响应集群上​​正在处理的大量数据。

指导我这个:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T05:50:12.827

多个瘦进程和 nginx 能够提供很大的速度，具体取决于您的应用程序在做什么。因此，问题将出在您的应用程序代码、应用程序服务器的速度和数据库服务器上。

[Scaling Rails Screencasts](http://railslab.newrelic.com/scaling-rails)最近深入介绍了Scaling Rails 。我建议你从那里开始。我扩展 Rails 的 5 步计划是：

1.  第一步是使用工具来查看您的应用程序中什么是缓慢的。当您不知道问题出在哪里时，不要花时间优化应用程序中的所有内容。
2.  每秒处理大量请求的最简单方法是使用页面缓存。
3.  如果您不能这样做，请缓存所有可能的内容（片段缓存、使用 memcached 缓存数据等），以加速您的应用程序。
4.  之后，尽可能优化您的应用程序，使 SQL 查询快速，索引所有内容等。
5.  如果您仍然需要更高的速度，请在问题上投入更多的硬件。获取一个强大的大型数据库服务器、一堆应用程序服务器，并在它们之间代理您的请求。您也可以从这里开始，但这只会延迟优化过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T05:59:56.343

如果您只有一台服务器，我认为主要的关键是，除了已经提到的所有内容之外，不要吝啬它的规格。试图获得太多而太少只是灾难的根源。

让 monit 或 God 监控你的瘦实例也是一个好主意，我从 God 开始，但它在 Ruby 1.8.6 上泄漏内存非常糟糕，所以我停止使用它来支持 monit。Monit 是用 CI 编写的，相信内存占用很小，所以我推荐那个。

如果这一切看起来有点让 nginx 和瘦身发挥得很好，你可能想要研究一个多合一的解决方案，比如Passenger 或 LiteSpeed。我对这些方面的经验很少，因此无法为他们提供实质性建议。

# python - SQLAlchemy/Elixir 验证规则？

> ID：555578
> 
> 赞同：1
> 
> 时间：2009-02-17T05:06:35.507
> 
> 标签：python, validation, sqlalchemy, python-elixir

我刚刚发现如何在保存之前验证我的数据库输入，但我有点沮丧地发现在一些基于 Web 的框架中没有预先制定的规则（如验证电子邮件、长度等）。是否有任何验证库位于我尚未找到的某些预制验证列表隐藏的任何地方或某个地方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T08:18:18.167

是的。有。但是将您的验证与数据层分开。（就像所有的 Web 框架一样。）

现在，您可以用于验证的库正是来自 Web 框架的表单库。从...开始：

*   [形式代码](http://formencode.org/)

最近出现了很多其他的，但其中大多数也处理某种程度的表单生成。我个人最喜欢的是[WTForms](http://wtforms.simplecodes.com/)。

有趣的是，Formencode 实际上来自（现在）较少使用的 SQLObject 库的验证库，因此它在这个确切的领域中肯定有一些牵引力和用途。

# java - 在 Java 中查找内存使用情况

> ID：555580
> 
> 赞同：6
> 
> 时间：2009-02-17T05:08:29.997
> 
> 标签：java, memory, memory-management, garbage-collection

以下是我需要解决的场景。我有两种解决方案。

我需要维护从数据库中获取的数据缓存，以便在 Swing GUI 上显示。每当我的 JVM 内存超过其分配内存的 70% 时，我需要警告用户过度使用。一旦 JVM 内存使用率超过 80%，那么我必须停止所有数据库查询并清理作为用户操作的一部分获取的现有缓存并通知用户。在清理过程中，我将根据一些规则手动处理删除一些数据，并指示 JVM 进行 GC。每当 GC 发生时，如果内存清理并达到分配内存的 60%，我需要重新启动所有数据库处理并将控制权交还给用户。

为了检查 JVM 内存统计信息，我发现了以下两种解决方案。无法决定哪个是最好的方法以及为什么。

1.  Runtime.freeMemory() - 创建的线程每 10 秒运行一次并检查可用内存，如果内存超过上述限制，必要的弹出窗口将提示用户并调用方法来停止操作并释放内存。

2.  MemoryPoolMXBean.getUsage() - Java 5 引入了 JMX 以在运行时获取内存快照。在，JMX 我不能使用阈值通知，因为它只会在内存达到/超过给定阈值时通知。唯一的使用方法是在 MemoryMXBean 中轮询并检查一段时间内的内存统计信息。

在使用轮询的情况下，对我来说，这两种实现似乎都是相同的。

请提出这些方法的优点，以及是否有任何其他替代方案/对使用的方法进行任何更正。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-17T08:49:31.133

附带说明：`Runtime.freeMemory()`没有说明剩余分配的内存量，它只是当前分配的内存中可用的内存量（最初小于 VM 配置使用的最大内存），但会增长随着时间的推移。

启动 VM 时，最大内存 ( `Runtime.maxMemory()`) 仅定义 VM 可以分配的内存上限（可使用 -Xmx VM 选项进行配置）。总内存 ( `Runtime.totalMemory()`) 是为 VM 进程分配的内存的初始大小（可使用 -Xms VM 选项进行配置），并且每次分配的内存超过其当前空闲部分 ( `Runtime.freeMemory()`) 时都会动态增长，直到达到最大内存。

您感兴趣的指标是可用于进一步分配的内存：

```
long usableFreeMemory= Runtime.getRuntime().maxMemory()
    -Runtime.getRuntime().totalMemory()
    +Runtime.getRuntime().freeMemory() 
```

或者：

```
double usedPercent=(double)(Runtime.getRuntime().totalMemory()
    -Runtime.getRuntime().freeMemory())/Runtime.getRuntime().maxMemory() 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-18T12:54:33.953

处理这类事情的通常方法是使用`WeakReference`s 和`SoftReference`s。你需要同时使用这两种方法——弱引用意味着你没有持有多个副本，而软引用意味着 GC 会一直挂在东西上，直到它开始耗尽内存。

如果您需要进行额外的清理，那么您可以添加对队列的引用，并覆盖队列通知方法以触发清理。这一切都很有趣，但是您确实需要了解这些课程的作用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T07:22:54.400

JVM 达到 100% 的内存使用率是完全正常的，并且它们在 GC 之后又回到 10% 并且每隔几秒执行一次。

您不需要尝试以这种方式管理内存。在运行完整的 GC 之前，您无法说出保留了多少内存。

我建议你弄清楚你真正想要达到的目标，并以另一种方式看待问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T13:46:32.700

您提到的要求与垃圾收集在 JVM 中的工作方式明显矛盾。

由于 JVM 的行为，很难以正确的方式警告您的用户。完全停止 als 数据库操作，清理东西并重新开始确实不是要走的路。

让JVM做它该做的，为你处理所有相关的内存。现代的 JVM 非常擅长它，通过对 GC 参数进行一些微调，您将获得更清洁的内存处理，然后自己强制执行

[http://www.kodewerk.com/advice_on_jvm_heap_tuning_dont_touch_that_dial.htm](http://www.kodewerk.com/advice_on_jvm_heap_tuning_dont_touch_that_dial.htm)之类的文章提到了优缺点，并很好地解释了 VM 为您做什么

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T05:15:09.947

我只将第一种方法用于类似任务，没关系。

对于这两种方法，你应该注意的一件事是实现某种去抖动 - 即，一旦你认识到你已经达到 70% 的内存，等待一分钟（或任何其他你认为合适的时间） - GC 可以在那个时候运行时间并清理大量内存。

如果您在系统中实现 Runtime.freeMemory() 图，您将看到内存如何不断地上下波动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-08T22:12:52.490

VisualVM 比 JConsole 好一点，因为它为您提供了一个漂亮的可视垃圾收集器视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-15T15:14:42.883

我知道，在原始帖子之后很晚，但我想我会发布一个示例来说明我是如何做到的。希望它对某人有用（我强调，这是主要示例的证明，仅此而已……也不是特别优雅:)）

只需将这两个函数放在一个类中，它就可以工作。

编辑：哦，还有`import java.util.ArrayList; import java.util.List;`

```
public static int MEM(){
    return (int)(Runtime.getRuntime().maxMemory()-Runtime.getRuntime().totalMemory() +Runtime.getRuntime().freeMemory())/1024/1024;
}

public static void main(String[] args) throws InterruptedException
{
    List list = new ArrayList();

    //get available memory before filling list
    int initMem = MEM();
    int lowMemWarning = (int) (initMem * 0.2);
    int highMem = (int) (initMem *0.8);

    int iteration =0;
    while(true)
    {
        //use up some memory
        list.add(Math.random());

        //report
        if(++iteration%10000==0)
        {
            System.out.printf("Available Memory: %dMb \tListSize: %d\n", MEM(),list.size());

            //if low on memory, clear list and await garbage collection before continuing
            if(MEM()<lowMemWarning)
            {
                System.out.printf("Warning! Low memory (%dMb remaining). Clearing list and cleaning up.\n",MEM());

                //clear list
                list = new ArrayList();  //obviously, here is a good place to put your warning logic

                //ensure garbage collection occurs before continuing to re-add to list, to avoid immediately entering this block again
                while(MEM()<highMem)
                {
                    System.out.printf("Awaiting gc...(%dMb remaining)\n",MEM());
                    //give it a nudge
                    Runtime.getRuntime().gc(); 
                    Thread.sleep(250);
                }

                System.out.printf("gc successful! Continuing to fill list (%dMb remaining). List size: %d\n",MEM(),list.size());
                Thread.sleep(3000); //just to view output
            }
        }
    }
} 
```

编辑：但是，这种方法仍然依赖于使用 -Xmx 在 jvm 中合理设置内存。

EDIT2： 似乎 gc 请求行确实有帮助，至少在我的 jvm 上。ymmv。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T23:00:30.790

查看 JConsole。它绘制了您需要的信息，因此只需根据您的需要进行调整（假设您在 Sun Java 6 上运行）。

这也使您可以将监视过程与要查看的内容分开。

# c# - C# 条件日志记录/跟踪

> ID：555581
> 
> 赞同：8
> 
> 时间：2009-02-17T05:09:26.047
> 
> 标签：c#, logging, trace

我想向我的 C# 应用程序添加日志记录或跟踪，但如果日志详细级别设置得太低以至于不会记录消息，我不希望记录格式化字符串或计算值的开销。

在 C++ 中，您可以使用预处理器来定义将阻止代码执行的宏，如下所示：

```
#define VLOG(level,expr) if (level >= g_log.verbosity) { g_log.output << expr; } 
```

像这样使用：

```
VLOG(5,"Expensive function call returns " << ExpensiveFunctionCall()); 
```

你如何在 C# 中做到这一点？

我已经阅读了解释 Trace 和 Debug 设施的 Microsoft 文档[，](http://msdn.microsoft.com/en-us/library/64yxa344(VS.80).aspx)他们声称使用 #undef DEBUG 和 #undef TRACE 会从生成的可执行文件中删除所有跟踪和调试代码，但它真的会删除整个调用吗？意思是，如果我写

```
System.Diagnostics.Trace.WriteLineIf(g_log.verbosity>=5,ExpensiveFunctionCall()); 
```

如果我取消定义 TRACE，它不会调用我昂贵的函数吗？还是打了电话，**然后**决定不追踪任何东西？

无论如何，即使它确实删除了它，这也不如 C++ 宏，因为我不能让那个丑陋的大调用看起来像我在 C++ 中的简单 VLOG() 调用并且仍然避免评估参数，可以吗？我也不能像在 C++ 中那样通过在运行时定义更低的详细程度来避免开销，对吧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-17T05:31:19.410

要回答您的问题之一，如果 Trace.WriteLine 被编译出来，则不会调用所有必须评估才能调用 Trace.WriteLine（或其兄弟姐妹/表兄弟）的方法调用。因此，继续将昂贵的方法调用直接作为 Trace 调用的参数放入，如果您未定义 TRACE 符号，它将在编译时删除。

现在关于在运行时更改详细程度的其他问题。这里的诀窍是 Trace.WriteLine 和类似的方法将 'params object[] args' 作为其字符串格式参数。只有在实际发出字符串时（当详细程度设置得足够高时），该方法才会对这些对象调用 ToString 以从中获取字符串。所以我经常玩的一个技巧是将对象而不是完全组装的字符串传递给这些方法，并将字符串创建留在我传入的对象的 ToString 中。这样，只有在实际发生日志记录时才支付运行时性能税，它使您可以自由地更改详细程度，而无需重新编译您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T05:40:11.090

[ConditionalAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)是你最好的朋友。当未设置#define 时，呼叫将被完全删除（就像呼叫站点是#if'd）。

编辑：有人将其放在评论中（谢谢！），但在主要答案正文中值得注意：

Trace 类的所有方法都用 Conditional("TRACE") 修饰。刚刚看到这个使用反射器。

这意味着如果未定义 TRACE，则 Trace.Blah(...expensive...) 确实会完全消失。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T05:54:20.773

一个对我有用的解决方案是使用[单例](http://search.live.com/results.aspx?q=c%23+implementing+singleton&FORM=AWRE2)类。它可以公开您的日志记录功能，并且您可以有效地控制其行为。让我们调用类“AppLogger”。她就是一个例子

```
public class AppLogger
{
   public void WriteLine(String format, params object[] args)
    {
        if ( LoggingEnabled )
        {
            Console.WriteLine( format, args );
        }
    }
} 
```

请注意，Singleton 的东西不在上面的例子中。试管中有很多很好的例子。现在有趣的是如何支持多线程。我是这样做的：（为简洁起见，哈哈哈）

```
public static void WriteLine( String format, params object[] args )
{
    if ( TheInstance != null )
    {
        TheInstance.TheCreatingThreadDispatcher.BeginInvoke(  Instance.WriteLine_Signal, format, args );
    }
} 
```

这样，任何线程都可以记录，并且消息在原始创建线程上处理。或者您可以创建一个专门的线程来处理日志输出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-15T21:20:06.397

有关 Conditional(Trace) 的所有信息都很好 - 但我认为您真正的问题是您希望将 Trace 调用留在生产代码中，但（通常）在运行时禁用它们，除非您遇到问题。

如果您正在使用 TraceSource（我相信您应该这样做，而不是直接调用 Trace，因为它可以让您在运行时对组件级别的跟踪进行更细粒度的控制），您可以执行以下操作：

```
if (Component1TraceSource.ShouldTrace(TraceEventType.Verbose))
     OutputExpensiveTraceInformation() 
```

这假设您能够隔离另一个函数中的跟踪参数（即，它们主要依赖于当前类的成员，而不是对该代码所在函数的参数进行昂贵的操作）。

这种方法的优点是因为 JITer 可以根据需要逐个函数编译，如果“if”评估为 false，则不仅不会调用该函数 - 它甚至不会被 JITed。缺点是 (a) 您已经在此调用和函数 OutputExpensiveTraceInformation 之间分离了跟踪级别的知识（因此，例如，如果您将 TraceEventType 更改为 TraceEventType.Information，它将无法工作，因为您永远不会甚至调用它，除非在此示例中为详细级别跟踪启用了 TraceSource）和（b）它需要编写更多代码。

在这种情况下，类似 C 的预处理器似乎会有所帮助（例如，因为它可以确保 ShouldTrace 和最终 TraceEvent 调用的参数相同），但我理解为什么 C# 没有包括那个。

Andrew 建议在传递给 TraceEvent 的对象的 .ToString 方法中隔离昂贵的操作，这也是一个很好的建议；在这种情况下，您可以例如开发一个仅用于 Trace 的对象，您可以向该对象传递您想要构建昂贵的字符串表示的对象，并在跟踪对象的 ToString 方法中隔离该代码，而不是在TraceEvent 调用的参数列表（即使在运行时未启用 TraceLevel 也会导致它被执行）。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T07:10:17.160

您是否尝试过像 log4net ( [http://logging.apache.org/log4net/index.html](http://logging.apache.org/log4net/index.html) ) 这样的复杂日志记录 API？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-18T03:24:10.500

其中两个答案（Andrew Arnott 和 Brian 的）确实回答了我的部分问题。如果 TRACE 或 DEBUG 为 #undef'd，则应用于 Trace 和 Debug 类方法的 ConditionalAttribute 会导致删除对方法的所有调用，包括昂贵的参数评估。谢谢！

对于第二部分，是否可以在运行时而不是在编译时完全删除所有调用，我在 log4net [fac](http://logging.apache.org/log4net/release/faq.html#What%20is%20REALLY%20the%20FASTEST%20way%20of%20(not)%20logging%3F)中找到了答案。根据他们的说法，如果您在启动时设置只读属性，运行时将编译掉所有未通过测试的调用！这不会让您在启动后更改它，但这很好，这比在编译时删除它们要好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T05:14:46.453

对于您的评论

“因为我不能让那个丑陋的大调用看起来像我在 C++ 中的简单 VLOG() 调用” - 您可以添加一个 using 语句，如下例所示。

 `````
using System.Diagnostics;

....
Trace.WriteLineIf(.....)

````  `据我了解，如果您取消定义 Trace 符号，它将删除包含 Trace 的行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T05:17:26.480

我不确定，但你可以自己找出答案。

让它成为一个非常昂贵的功能（如`Thread.Sleep(10000)`）并计时。如果需要很长时间，那么无论如何它都会调用您的函数。

（您可以使用 and 包装`Trace.WriteLineIf()`调用`#if TRACE`并`#endif`再次对其进行测试以进行基本比较。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T05:48:05.390

它将调用昂贵的调用，因为它可能具有所需的副作用。

你可以做的是用 [Conditional("TRACE")] 或 [Conditional("DEBUG")] 属性来装饰你昂贵的方法。如果未定义 DEBUG 或 TRACE 常量，则该方法将不会被编译为最终的可执行文件，也不会任何调用来执行昂贵的方法。

# opengl - 如何使用 jogl（直接 OpenGL）将 PImage 绑定到处理中的纹理

> ID：555592
> 
> 赞同：0
> 
> 时间：2009-02-17T05:15:40.790
> 
> 标签：opengl, processing, jogl

如果您已在处理中将图像加载到 PImage 中，使用 OpenGL 调用将其绑定到纹理的最佳方法是什么？我没有使用任何处理渲染的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-03T13:42:32.510

我猜你应该能够绑定一个`BufferedImage`.

如果是这样，您可以使用 PImage 的[`getNative()`](http://processing.github.io/processing-javadocs/core/processing/core/PImage.html#getNative--)方法来访问`BufferedImage`：

```
BufferedImage bufferedImage = (BufferedImage) loadedPImage.getNative(); 
```

# javascript - 对 WCF 服务的跨站点 ajax 调用

> ID：555595
> 
> 赞同：3
> 
> 时间：2009-02-17T05:17:42.423
> 
> 标签：javascript, wcf, json, cross-site

是否可以使用 Javascript 对 WCF 服务进行跨站点调用？

我不介意它是 POST 还是 GET。

但是我听说这些天来，浏览器不允许使用 POST 或 GET 进行跨站点调用。

我怎样才能绕过这个并仍然调用*WCF 服务*？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T06:04:50.750

要绕过浏览器的跨站点脚本拦截器，您无能为力。这些阻止程序阻止 XMLHTTPRequest 发生在任何域，但加载包含脚本或页面的域除外。

也就是说，有一种常用的解决方法：使用 JavaScript 向 DOM 中写入一个新条目，该条目引用作为跨站点 URL 的 src。你将把你所有的 RPC 方法参数传递给这个“脚本”，它会返回一些将被执行的 JavaScript，告诉你成功或失败。

无法以这种方式进行 POST，src URL 必须是 GET，因此您可以通过这种方式传递参数。我不确定 WCF 是否有“仅获取”的访问方法。而且，由于浏览器会期望远程标记的结果是有效的 JavaScript 对象，因此您必须确保 WCF 服务也遵守这一点，否则您将收到 JavaScript 错误。

绕过跨站点脚本的另一种常见方法是为您的请求编写代理。换句话说，如果您想从 example.com 上托管的脚本访问域 test.com，则在 example.com 上创建一些 URL，以正确的方式将请求代理到 test.com。

对于您的示例，代理可能是正确的答案，假设 WCF 没有它自己的跨站点脚本限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T21:35:21.707

您是否有机会使用 jQuery？jQuery 支持使用“JSONP”的跨域 JSON 请求。您将仅限于 GET 请求，但我已经尝试过了，效果很好！开始工作也很简单。

有关详细信息，请参阅此页面上的“跨域 getJSON（使用 JSONP）”部分： [http ://docs.jquery.com/Release:jQuery_1.2/Ajax](http://docs.jquery.com/Release:jQuery_1.2/Ajax)

以下是 JSONP 的一些背景知识：http: [//bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/](http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/)

让我知道事情的后续！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-20T21:53:14.317

新的 W3C 建议正在标准化，以通过跨站点请求的[访问控制规范允许受信任方之间的跨站点请求](http://www.w3.org/TR/access-control/)。

这需要一个服务于合适的访问控制 HTTP 标头的服务器和一个能够理解这些标头并对其进行操作的浏览器。

简而言之，如果远程主机说它喜欢您的域，并且浏览器理解这意味着什么，那么您可以针对该主机执行 xmlHttpRequests，而不管同源策略如何。

目前很少有浏览器支持此功能。IE8 显然可以（我还没有测试过），而 Firefox 3.1 可以（我已经对此进行了广泛的测试）。我希望其他浏览器能很快效仿。

你不应该期望最早在 2012 年之前充分采用兼容的浏览器。

这是问题的最终解决方案。缺点是要等几年才能在主流应用中使用。

如果这是在您完全控制的环境中使用，例如用于您可以确定使用哪个浏览器以及可以配置多个服务器以发出正确标头的 Intranet，则它可以完美运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-20T21:37:24.010

为了扩展 Ben 的答案...我扩展了我们的 WCF 服务以支持来自 jQuery 的 JSONP 调用，使用类似于 Microsoft 的这个示例的代码：

[http://msdn.microsoft.com/en-us/library/cc716898.aspx](http://msdn.microsoft.com/en-us/library/cc716898.aspx)

# javascript - 向 PHP 提交 Javascript 对象

> ID：555596
> 
> 赞同：0
> 
> 时间：2009-02-17T05:19:25.243
> 
> 标签：javascript, jquery

请教我一个新手问题。

我有一个大型数据集，我**更喜欢**作为对象而不是数组提交；例如

```
foo = bar = baz = {};
$.ajax({
    url: "index",
    type: "post",
    data: { foo: foo, bar: bar, baz: baz },
    dataType: "json"
}); 
```

提交后，Firebug 告诉我我已提交：

```
bar [object Object]
baz [object Object]
foo [object Object] 
```

我想要的是能够访问 foo、bar、baz 的内容（当然是人为的例子）。

这在Javascript中可能吗？还是我需要使用我不喜欢的数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T06:00:49.627

您的示例中的 bar、baz 和 foo 是空对象，[object] 废话是 JavaScript 尽最大努力将变量转换为字符串。我建议包含一些可以将您的对象转换为 JSON 字符串的内容。请参阅[json.org](http://www.json.org/)，特别是[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)，然后对它们中的每一个调用 stringify() 方法：

```
foo = bar = baz = {};
$.ajax({
    url: "index",
    type: "post",
    data: { foo: foo.stringify(), bar: bar.stringify(), baz: baz.stringify() },
    dataType: "json"
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T05:26:22.433

不，通过 HTTP 提交的所有内容基本上都是一个字符串或字符串数​​组。您*可以*使用[JSON](http://www.json.org/)将每个对象转换为字符串表示，这可能是您想要的。

# installation - 如何通过 msi 安装更新特定文件

> ID：555600
> 
> 赞同：1
> 
> 时间：2009-02-17T05:22:14.673
> 
> 标签：installation, windows-installer

我想做一个既可以是新安装也可以是更新安装的安装。当它用作更新安装时，无论版本和修改日期时间如何，我都希望更新一些文件。有些文件永远不会更新。

我尝试了什么：将“REINSTALLMODE”设置为“amus”。并将永不更新文件组件的“永不覆盖”属性设置为“是”。

我得到了什么：它不起作用。那些带有“Never overwrite = yes”的组件仍然以某种方式更新。

我的问题：这对吗？REINSTALLMODE 的优先级高于组件的“从不覆盖”属性？如何处理这个部分更新问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T21:42:19.207

MSI 具有特定的[文件替换逻辑](http://blogs.msdn.com/astebner/archive/2005/08/30/458295.aspx)（[存档链接](https://web.archive.org/web/20100118152341/http://blogs.msdn.com/astebner/archive/2005/08/30/458295.aspx)）。

我会考虑进行[重大升级](http://msdn.microsoft.com/en-us/library/aa369786(VS.85).aspx)。

假设这些是未版本化的文件（例如 text/xml 配置文件，而不是程序集），我将在我想要始终更新的任何文件上手动设置文件版本（手动设置的版本将覆盖已经安装的文件），而不管文件替换逻辑应该忽略的其他内容。

这是关于[REINSTALLMODE=amus](http://msiworld.blogspot.com/2008/10/how-reinstallmodeamus-works.html)的文档，其中提到“a”表示忽略文件版本控制规则并更新所有内容。不是你想要的。另外，我相信 REINSTALLMODE 通常用于“修复”操作，而不是安装/升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:54:39.660

我们做这样的事情......

1.  安装文件到程序文件
2.  为所有用户 appdata 安装默认配置
3.  如果未找到每个用户的配置，则将默认配置复制到每个用户的 appdata。

这意味着如果应用了更新，默认配置会被重置，但不会重置每个用户的配置。在 MSI 更新期间，所有设置等都会被保存并且不会被覆盖。

根据您尝试“不更新”的文件，我怀疑您可能可以按照类似的方式做一些事情。

# performance - 使用 Copyfile() 从不同计算机复制文件的性能问题

> ID：555601
> 
> 赞同：1
> 
> 时间：2009-02-17T05:22:19.040
> 
> 标签：performance, visual-c++, mfc, file-copying

使用 VC++ VisualStudio 2003。

我正在尝试将多个图像文件（每个文件 30kb 左右）从另一台计算机的共享文件夹复制到本地文件。

问题是一次传输可以有超过 2000 个左右的文件，而且它似乎会造成损失，需要更多的时间才能完成。

是否有任何替代方法可以从另一台计算机复制文件以加快复制速度？

提前致谢。

编辑*由于客户的要求，不可能显着改变代码库，讨厌因为非技术问题而不得不偏离最佳实践，但有没有更微妙的方法？比如另一个函数调用？

我知道我在要求一些神奇的巫术，以防万一有人知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T05:37:23.123

有几件事要尝试：

*   使用操作系统复制文件是否更快？

*   如果不是，那么您的网络或其设置方式可能存在一些固有限制（可能是身份验证问题，或者远程服务器有一些硬件问题，或者它太忙，或者网卡由于冲突而丢失了太多数据包，故障开关，接线不良...）

*   进行一些测试以传输各种大小的文件。
    小文件的传输总是较慢，因为获取它们的详细信息、传输数据、然后创建目录条目等需要大量开销。

*   如果大文件速度很快，那么您的网络还可以，您可能无法对系统进行太多改进（瓶颈在其他地方）。

*   最终，从代码中，您可以尝试打开文件，一次将文件读入一个大缓冲区，然后将它们保存在本地驱动器上。这可能会更快，因为您将绕过操作系统内部执行的大量检查。

*   您甚至可以通过几个线程同时打开、加载、写入文件以加快速度。

您可以检查多线程文件副本的几个参考：

*   MTCopy： CodeProject 上[的多线程单/多文件复制工具](http://www.codeproject.com/KB/files/Lys_MTCopy.aspx)
*   [好的并行/多线程文件复制工具？](http://channel9.msdn.com/forums/Coffeehouse/417860-Good-parallelmulti-thread-file-copy-util/)第 9 频道的讨论主题。
*   [McTool](http://kd7lrj.xenopho.be/mctool)一个用于并行文件复制的命令行工具。

如果在代码中自己实现这个太麻烦，您总是可以简单地在应用程序的后台执行一个像 McTool 这样的实用程序，让它为您完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T05:36:46.417

好吧，首先，2000**不是**几个。如果大部分时间是因为您要发送大量小文件，那么您会想出一个解决方案，将它们在源处打包成一个文件并在目的地解包。这将需要在源代码处运行一些代码 - 您必须设计您的解决方案以允许这样做，因为我假设您目前只是从网络共享复制。

如果是网络速度（不太可能），您也可以压缩它们。

我自己的信念是，这将是文件的数量，基本上是副本的所有重复启动成本。这是因为 2000 个 30K 文件只有 60MB，而在 10Mb 链接上，理论上最短时间约为一分钟。

如果您的时间大大高于此，那么我会说我是对的。

使用 7zip 或类似的解决方案将它们全部压缩到一个`7z`文件中，传输它们，然后在另一端解压缩它们听起来就像您正在寻找的那样。

但是测量，不要猜测！测试一下，看看它是否能提高性能。然后做出决定。

# asp.net - 是否可以使用表单身份验证来保护 Web 服务？

> ID：555611
> 
> 赞同：7
> 
> 时间：2009-02-17T05:28:31.880
> 
> 标签：asp.net, web-services, forms-authentication

我们正在寻求保护一堆 ASP.Net 2.0 .asmx Web 服务。将托管 Web 服务的已经是经过身份验证的表单。
是否可以使用表单身份验证来保护 Web 服务？实现这一目标的利弊和其他可能的方法是什么。我们当然不想在每个 Web 方法调用中传递用户名/密码或令牌。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T05:39:56.567

表单身份验证的特点是它是为人们设计的，其中 Web 服务被设计为由客户端应用程序使用。虽然可以像这样进行身份验证，但这是错误的思维方式。

所需的安全级别显然取决于您正在使用的数据的敏感性，但我将假设它至少有点敏感（但低于银行交易）。您也许可以使用 SSL 并按照 jle 的建议传递用户名和密码，而我正在输入此内容，或者您​​可能需要一个 api 密钥，就像 flickr 所做的那样。

另一个更安全的选择是只传递一次用户名和密码（并且具有 ssl 的安全性），并让它发出一个在一段时间内有效的令牌。这样做的好处是可以保护密码信息，并避免 ssl 的持续开销。

如前所述，这在很大程度上取决于您要保护的信息的敏感程度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T18:25:00.063

WSE 已过时。除非您别无选择，否则不要使用它。

几乎WSE的所有功能都被WCF更好地实现了。WCF 未实现的其余功能本身已过时（例如 DIME）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T05:36:04.717

这是可能的，但您需要将用户重定向到登录页面。传递用户名/密码的另一种选择是通过**ssl**使用 Web 服务。如果您加密连接，则可以使用基本身份验证没有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T05:43:38.600

您应该能够使用 WSE 使用表单身份验证来保护您的服务 - 尽管我个人从来没有这样做过。

以下是一些使用 WSE 的资源：

*   [http://aleemkhan.wordpress.com/2007/09/18/using-wse-30-for-web-service-authentication/](http://aleemkhan.wordpress.com/2007/09/18/using-wse-30-for-web-service-authentication/)
*   [http://msdn.microsoft.com/en-us/library/aa480575.aspx](http://msdn.microsoft.com/en-us/library/aa480575.aspx)

要不使用 WSE，您需要像其他一些预发者所暗示的那样实现类似的东西，尽管我不确定它有多可靠：

*   [http://www.dotnetbips.com/articles/dbd724e9-78f0-4a05-adfb-190d151103b2.aspx](http://www.dotnetbips.com/articles/dbd724e9-78f0-4a05-adfb-190d151103b2.aspx)

# c++ - 构造函数不适用于从 std::string 继承的类

> ID：555612
> 
> 赞同：5
> 
> 时间：2009-02-17T05:28:43.270
> 
> 标签：c++, stl

做的时候

```
#include <string>

class MyString : public std::string 
{
 public:    
   MyString() {}
}; 
```

但是下面的用法：

```
MyString s = "Happy day";
MyString s("Happy Day");
MyString s = (MyString)"Happy day"; 
```

它们都不起作用。

似乎与构造函数/运算符声明/覆盖有关，但任何人都可以帮助指出我在哪里可以找到这些资源？

谢谢。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-17T05:37:09.100

`std::string`不是为继承而设计的。它没有**任何**虚函数（甚至没有析构函数！），所以你不能覆盖任何东西。它也没有受保护的接口，因此您从子类化中没有任何收获，而通过创建一些独立的实用程序函数来获取`std::string`.

请记住，大多数 STL 实现都希望您使用`std::string`复制语义，而不是引用语义，这使得添加继承字段或覆盖函数的情况变得更弱。

如果您**真的**想要`std::string`具有额外功能的东西，您可以考虑使用组合而不是继承，但这也不是很好。您不必担心`std::string`没有正确调用析构函数，但您最终不得不包装很多`std::string`您需要的方法，这很乏味。此外，您的实用程序函数仅在大多数代码预期时才能与 MyString 一起使用`std::string`，因此它不是很可重用。

你最好做一些实用功能，需要`std::string`. 或者，如果`std::string`没有提供您需要的东西，您应该使用其他一些适合您需要的字符串实现。以下是我想到的一些可能性：

*   SGI 的 STL 扩展，[`std::rope`](http://www.sgi.com/tech/stl/Rope.html). 它在 GNU C++ 中，所以也许你可以依赖它。
*   [Boost](http://www.boost.org)有一个非常广泛的[字符串算法库](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo.html)，可以让您使用概念来指定[字符串的表示方式](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo/design.html)。
*   [如果您*必须*](https://stackoverflow.com/a/4205121/15161)从 std::string [“派生”](https://stackoverflow.com/a/4205121/15161) ，也请参阅此内容

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T05:56:49.707

您需要为希望能够转换为字符串的不同类型定义一些构造函数。这些构造函数基本上可以将参数传递给底层`std::string`。

如果您不手动创建它们，编译器会为您创建一个默认构造函数和一个复制构造函数：

```
MyString() : std::string() { }
MyString(const MyString &other) : std::string(other) { } 
```

要允许从字符串文字进行构造，您需要一个构造函数，该构造函数采用`const char*`：

```
MyString(const char* other) : std::string(other) { } 
```

采用 a 的构造函数对于将s 转换为您的字符串类型`const std::string&`也很有用。`std::string`如果你想避免普通字符串的隐式转换，你应该这样做`explicit`：

```
explicit MyString(const std::string &other) : std::string(other) { } 
```

（已编辑，因为我的原始版本充满了错误，我无法删除已接受的答案）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-20T19:07:05.103

底线是你不应该这样做。析构函数`std::string`不是虚拟的。这意味着，如果您执行以下操作：

```
std::vector<std::string*> s_vector;
s_vector.push_back(new MyString("Hello"));
s_vector.push_back(new std::string("World"));

const std::vector<std::string*>::iterator s_vector_end = s_vector.end();
std::vector<std::string*>::iterator s = s_vector.begin();
for (; s != s_vector_end; ++s)
{
    delete *s; // Error, MyString's destructor will
               // not be called, but std::string's!
} 
```

这可能是安全的唯一方法是如果您不将成员添加到您的字符串。您可能认为您现在不需要任何东西，但不知道这些问题的人可能会在稍后出现（或者您，当您可能忘记了这个建议时）并添加一个，然后嘿，你有难以追踪的内存泄漏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T05:36:22.627

问题是您需要重载接受 const char* 的构造函数并调用基类构造函数，如下所示：

```
class MyString : public std::string {
   public:    
      MyString() {}
      MyString( const char* c ) : std::string( c )  {}
}; 
```

那么你的所有三个测试都应该工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T05:37:06.947

std::string 不打算继承自。它没有任何虚拟方法，因此您不能覆盖它的任何方法。

你应该看看作文。或者简单地创建在 std::strings 上运行的实用程序函数

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T05:36:04.220

您正在定义一个不带参数的 ctor MyString 。如果覆盖其他 ctor，则根本没有 ctor 采用字符串参数。

您需要对 type 的一个参数进行 ctor `const char *`，例如

```
 MyString(const char * s): std::string(s){} 
```

（不要相信语法，查一下；我不再每天都写 C++。）

检查[C++ FAQ Lite 中关于 ctors](http://www.parashift.com/c++-faq-lite/ctors.html)的部分。

（哎呀。Const char *，不是字符串。告诉你我不是每天都写 C++。）

# php - 使用 PHP 显示图像不起作用

> ID：555616
> 
> 赞同：0
> 
> 时间：2009-02-17T05:32:07.427
> 
> 标签：php, image, image-processing, gd, gd2

我正在尝试使用 PHP 脚本显示图像。基本上这样 php 脚本会在图像的完整路径上传递，然后它会在浏览器中显示该图像。我已经检查以确保图像存在，它被正确读取等，但是在浏览器中，如果我去那里，我只会看到损坏的图像框（例如 IE 中的小红叉）。

我的脚本发出这些标头：

```
<?php
header('Last-Modified: ' . gmdate('D, d M Y H:i:s T', filemtime($file)));
header('Content-Type: '.$mime);
header('Content-Length: '.filesize($file)."\n\n");
header('Etag: '.md5($file));
echo $file;
die; 
```

`$file`包含类似`'/var/www/htdocs/images/file.jpg'`which works 的东西。`$mime`是`'image/jpeg'`。_

我也尝试过回显`file_get_contents($file)`，但也没有用。

有什么问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-05-06T12:08:12.453

```
<?php
$filename = basename($file);
$file_extension = strtolower(substr(strrchr($filename,"."),1));
switch( $file_extension ) 
    {
    case "gif": 
        $ctype="image/gif"; 
        break;
    case "png": 
        $ctype="image/png"; 
        break;
    case "jpeg":
    case "jpg": 
        $ctype="image/jpeg"; 
        break;
    default:
    }
ob_clean();  // add this before header
header('Content-type: ' . $ctype);
readFile($file);  
?> 
```

有时可能会在任何其他文件中产生额外的空间。因此可以通过在调用 header() 之前调用 ob_clean() 来删除这些额外的空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T05:43:37.540

力求简单...

```
<?php
header('Content-type:' . mime_content_type($file));
readfile($file); 
```

应该按预期运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T05:53:07.110

我找到了答案，我在`?>`标记后有一些额外的空格导致标题不起作用。呸呸呸

# stored-procedures - 用 SQL 和 Java 编写 DB2 存储过程的优缺点是什么？

> ID：555621
> 
> 赞同：2
> 
> 时间：2009-02-17T05:35:18.107
> 
> 标签：stored-procedures, db2

使用较新版本的 DB2，您可以用 SQL 编写存储过程，也可以用 Java（或其他语言）创建过程，然后可以将其添加到数据库中并像 SQL 过程一样调用。我想知道每种方法的优缺点是什么。我对比较这两种类型的程序特别感兴趣，而不是争论程序与我认为已经涵盖的外部代码。到目前为止，这是我想出的：

SQL：

*   基本 SQL 功能的更好性能

*   简单的逻辑不那么冗长，即可以直接运行 SQL

*   没有额外的编译步骤 - 只需创建过程......

爪哇：

*   更结构化和功能齐全的代码（类、对象、重用、库）

*   在程序员和文档方面提供更好的帮助资源

还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T05:47:21.463

不仅是 Java，还有任何程序语言：**procedural**，这是关键。

DB2 是一种关系代数，而不是一种编程语言。如果您需要做一些复杂的事情，最好使用过程语言而不是试图将 SQL 弯曲成它不应该的东西。

我们实际上将 REXX 用于我们的 DB2/z 工作，但我看到这里的人在大型机上使用 bash 进行快速原型设计。一些只使用 SQL 的人创建了所有这些可怕的临时表来存储最好保存在结构中并远离数据库的东西。

我的想法是复杂性是直接在存储过程中使用 SQL 和过程方法之间的唯一区别因素。在做出这些决定时，我们有两条经验法则。

1/ 如果一个工作单元需要两次以上的数据库访问，我们将其设为存储过程。

2/ 如果存储过程创建了一个临时表，那么我们使用过程语言来完成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T05:28:52.977

您可能已经发现了这一点，但为了以防万一，以及其他任何经过这里的人，有一本关于 SProcs 的 IBM 红皮书和 DB2 v9 的更改可在 [DB2 9 for z/OS 存储过程：通过 CALL 和超越](http://www.redbooks.ibm.com/abstracts/sg247604.html) 讨论可用的选项及其相对优点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-06T00:09:47.080

SQL 存储过程的优点是它们可以移植到其他 Db2 UDb 中，只需进行很少的更改或无需更改。但是 Db2 外部过程将是一个更好的选择，因为您可以使用过程语言比单独使用 sql 做更多的事情。我想说 cobol 比 Java 更适合 DB2 外部存储过程，原因如下。1）。您将能够重用现有程序中的一些代码。将 cobol 子程序转换为存储过程或将存储过程转换为 cobol 子程序非常容易完成。2）。您将能够使用具有系统功能知识的现有 cobol 开发团队。

# sql - 我如何知道 CONSTRAINT_NAME 是主键还是外键？

> ID：555622
> 
> 赞同：3
> 
> 时间：2009-02-17T05:35:19.977
> 
> 标签：sql, sql-server, metadata, constraints, table-structure

在 SQL Server 2005 上使用此 SQL

```
SELECT CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE TABLE_NAME = @TableName
  AND COLUMN_NAME=@ColumnName 
```

我得到主键和外键。

我怎样才能只获得外键？如何查看约束是主键还是外键？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:52:18.307

[在这里](http://blog.sqlauthority.com/2007/09/04/sql-server-2005-find-tables-with-foreign-key-constraint-in-database/)找到了一个更优雅的解决方案

为了完整起见，在下面添加了代码，但所有功劳归于 Pinal Dave

```
SELECT f.name AS ForeignKey,
   OBJECT_NAME(f.parent_object_id) AS TableName,
   COL_NAME(fc.parent_object_id, 
   fc.parent_column_id) AS ColumnName,
   OBJECT_NAME (f.referenced_object_id) AS ReferenceTableName,
   COL_NAME(fc.referenced_object_id, 
   fc.referenced_column_id) AS ReferenceColumnName
FROM sys.foreign_keys AS f
LEFT JOIN sys.foreign_key_columns AS fc
   ON f.OBJECT_ID = fc.constraint_object_id 
```

如果你只想要主键......

```
SELECT i.name AS IndexName,
        OBJECT_NAME(ic.OBJECT_ID) AS TableName,
        COL_NAME(ic.OBJECT_ID,ic.column_id) AS ColumnName
FROM sys.indexes AS i
        INNER JOIN sys.index_columns AS ic
        ON i.OBJECT_ID = ic.OBJECT_ID 
    AND i.index_id = ic.index_id
WHERE i.is_primary_key = 1 
```

将此添加为附加答案，因为它与我之前的答案相去甚远:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T17:10:02.613

我将以下 SQL 与 SQL Server 2005 一起使用以通过主键获取约束名称：

```
SELECT Constraint_Name 
FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS 
WHERE UNIQUE_CONSTRAINT_NAME = 
   (SELECT CONSTRAINT_NAME 
    FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
    WHERE TABLE_NAME = @TableName AND COLUMN_NAME = @ColumnName) 
```

通过外键获取约束名称：

```
SELECT CONSTRAINT_NAME 
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE TABLE_NAME = @TableName AND COLUMN_NAME = @ColumnName 
```

通过约束名称获取外键的表和字段：

```
SELECT TABLE_NAME, COLUMN_NAME 
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE CONSTRAINT_NAME = @ConstraintName 
```

通过约束名称获取主键的表和字段：

```
SELECT TABLE_NAME, COLUMN_NAME 
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE CONSTRAINT_NAME = 
    (SELECT UNIQUE_CONSTRAINT_NAME 
     FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS 
     WHERE CONSTRAINT_NAME = @ConstraintName) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T05:43:33.873

这取决于您的 DBMS，但约束应该在某处具有目标表和列。

如果是外键约束，则目标表与当前表不同。尝试

```
select * 
```

代替

```
select constraint_name 
```

查看您可以使用的所有神奇列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T10:27:50.413

```
SELECT CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_NAME = @TableName
  AND COLUMN_NAME=@ColumnName
  AND REFERENCED_COLUMN_NAME IS NOT NULL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T10:38:33.993

这不是最优雅的解决方案，但 MS SQL Server 使用 PK 和 FK 前缀命名约定的键，所以你可以使用类似...

```
SELECT CONSTRAINT_NAME 
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
WHERE TABLE_NAME = @TableName
AND LEFT(CONSTRAINT_NAME,2) = 'FK' 
```

如果那是您的 DBMS :)

**编辑**

当我尝试 Quassnoi 的答案时，我得到一个“无效的列名'REFERENCED_COLUMN_NAME'”。错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T10:04:47.357

我使用类似的东西。它也适用于 SQL Server 2000。

```
select  object_name(fkx.constid) as fk_name,
        fkx.keyno as num,
        object_name(fkx.fkeyid) as child_table,
        col_name(fkx.fkeyid, fkx.fkey) as child_column,
        object_name(fkx.rkeyid) as parent_table,
        col_name(fkx.rkeyid, fkx.rkey) as parent_column
from sysforeignkeys fkx
order by fk_name, fkx.keyno 
```

这一切都在系统表和视图中，这些都有很好的记录。

# iphone - 当我使用与 SeismicXML 示例相同的 NSXMLParser 时出现内存泄漏问题

> ID：555623
> 
> 赞同：0
> 
> 时间：2009-02-17T05:35:55.437
> 
> 标签：iphone

我已经完成了与 SeismicXML 示例相同的 xml 解析。但现在它给了我内存泄漏问题。

当我用仪器测试 SeismicXML 时，它也给出了相同的内存泄漏。

在 SeismicXML 中，有 EarthQuake 示例，它包含来自 xml 解析的所有字符串和数组。所以“泄漏”仪器将所有这些字符串和数组显示为泄漏的对象。

我在这个问题背后花了很多时间。但我还不能解决。如果有人解决了这个问题，请与我分享您的评论。

谢谢，哈雷什。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T14:14:04.783

好的，

我假设您正确安装了该工具，以便您可以从终端调用它。

要使用它：

1) cd /your/project/path 2) scan-build -k -V xcodebuild

如果这不起作用，那么您没有正确安装该工具：至少您没有正确设置“路径”。

以下是如何设置 c 或 tcsh shell 的路径，假设您在 /opt/checker-0.160 中安装了该工具

设置 mypath=(/opt/checker-0.160) 设置路径=($mypath $path)

3) 如果命令正常工作，它会构建您的项目并在您的机器上启动一个 Web 服务器。然后它会为您提供可以在您的机器上连接以读取结果的 url。

如果该命令无法启动 Web 服务器，它无论如何都会告诉您 html 文件在特定目录中可用，并且您将获得路径。通常可以在 /tmp 下找到该目录。

直接进入这个目录

cd /path/to/results/目录

接着

打开 index.html

您将看到完整的报告。此致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T11:13:13.043

您可能需要下载、安装和使用 CLANG 检查器工具来了解您的代码泄漏内存的原因。这个工具（已经为 Leopard 10.5.x 构建）有时可能无法提供正确的答案，但根据我的个人经验，它从未失败过。我强烈推荐它作为你的日常开发工具之一。

你可以从

[http://clang.llvm.org/StaticAnalysis.html](http://clang.llvm.org/StaticAnalysis.html)

使用它真的很简单。看一眼

[http://clang.llvm.org/StaticAnalysisUsage.html#BasicUsage](http://clang.llvm.org/StaticAnalysisUsage.html#BasicUsage)

在实践中，您只需使用以下命令构建您的 Xcode 项目

扫描构建 -k -V xcodebuild

然后，您使用将在终端窗口中显示为输出的命令检查生成的输出 HTML 文件。这些文件将为您详细解释代码中出现问题的原因（不仅仅是内存泄漏）。

亲切的问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-09T17:47:28.787

在初始化我的 NSXMLParser 之前，我设置了以下内容：

```
[[NSURLCache sharedURLCache] setMemoryCapacity:0];
[[NSURLCache sharedURLCache] setDiskCapacity:0];
NSXMLParser *parser = [[NSXMLParser alloc] initWithContentsOfURL:URL]; 
```

这停止泄漏。

# linq-to-sql - Linq to SQL GridView 中的空值

> ID：555660
> 
> 赞同：1
> 
> 时间：2009-02-17T05:53:06.300
> 
> 标签：linq-to-sql, objectdatasource

通常，如果我将 ObjectDataSource 链接到 GridView 并且我有一个 TemplateColumn，其中有一个 Eval 并且它是 Null，我可以只放置一个“.ToString()”它工作正常。出于某种原因，当您使用 Linq to SQL 时，这并不相同。

我最初使用自定义 BLL 为我的 DAL 使用 XSD 文件。我使用 ObjectDataSource 将它绑定到 GridView。我正在用 Linq 将 XSD 文件换成 SQL，除了可以具有 Null 值的列之外，一切都像旧方法一样工作。

以前有没有人遇到过这个问题，如果有，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T06:39:40.370

LINQ 返回的大多数内容都是[Nullable 类型](http://msdn.microsoft.com/en-us/library/2cf62fcy.aspx)。因此，在您的绑定表达式中，您需要使用 GetValueOrDefault().ToString() 或新的“??” null 合并运算符，而不仅仅是普通的旧 ToString()。我希望这有帮助。检查此[链接](http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx)。

例子：

```
// this will output the int if not null otherwise an empty string.
<%# (int?)Eval("MyIntegerField") ?? "" %> 
```

# ruby-on-rails - 单表继承以及在 Rails 中的使用位置

> ID：555668
> 
> 赞同：53
> 
> 时间：2009-02-17T06:02:51.470
> 
> 标签：ruby-on-rails, inheritance

我陷入了一个奇怪的设计问题，

我正在研究两种类型的配置文件模型，

*   用户资料（属于用户）
*   其他作为“机器人”在现场维护的（不属于任何人）

这两种配置文件的典型 OO 行为是相同的，但只有重要的属性/属性是共同的（非常重要的 5-6 个），其他属性，如“兴趣等”（几乎 10-15 个属性）不存在对于机器人配置文件

早先从事此工作的编码人员为机器人配置文件/用户配置文件创建了单独的模型/控制器，这在任何地方都产生了很多冗余，并且正如预期的那样难以维护，编写测试等。我想把它干掉，至少解决一些/全部这些冗余问题。

有人建议单表继承作为解决方案

有人建议改用多态关联。

什么是更好的方法。我们什么时候真正使用 STI？

我自己的想法是，当模型的属性相同且行为不同时，最好使用 STI。

想我能做什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-17T06:26:59.387

当属性相同但行为不同时，将 STI 表征为最有用是“大约正确”，但可能有点限制。顾名思义，当存在明确的 OO 风格的继承关系，而不是不同类型的对象之间的数据库风格的关系时，我喜欢使用 STI。

如果机器人和用户之间有共同的代码，我会说 STI 听起来像是赢家。如果只有一些共同的属性，它可能不太适用，但仍然值得一试。

我是一个很有实验性的人，所以我的建议是试一试。分支您的代码并将模型重构为 STI 关系。看看它是否真的使事情变得枯燥，或者只是将一组头痛换成其他问题。

我认为你不会从中受益的一件事是让你的控制器干涸。根据我的经验，STI 模型通常不会转化为类似的相关控制器。但这将是另一种尝试。有时会赢，有时不会。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-12-11T16:16:44.340

我已经写了一篇关于这个主题的文章，包括一些使用 STI 的技巧：

[Rails 中的单表继承](http://www.alexreisner.com/code/single-table-inheritance-in-rails)

简而言之：对象之间需要有清晰的 OO 风格的继承关系（正如 womble 雄辩地指​​出的那样），而不仅仅是一些共享数据。如果没有自然而明显的类层次结构，STI 设计可能会随着应用程序的发展而变得难以维护。

其次，您应该考虑将所有数据放在一个表中是否重要。使用多态关联，您的数据库查询将变得更加复杂，并且可能更慢。如果您计划在网站上将所有对象一起列出（例如，在表格中），那么 STI 可能是您的最佳选择。

第三，确保您的子类没有太多独特的属性。将所有数据放在一个表中，您不需要很多非全局列。这些不仅占用空间（不是主要问题），而且使数据结构混乱。如果您确实有“特殊”列，则应在代码中明确说明它们。

最后，如果您确实使用 STI，我强烈建议您为所有子模型使用单个控制器。控制器的主要功能是提供对对象的访问，如果需要以非常不同的方式访问对象，那么 STI 可能一开始就不是正确的设计选择。

查看我的文章（上面的链接）以获取更多有用的提示。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T06:37:14.570

我可能会使用 STI 或根本不使用特殊功能。您可能可以将所有内容称为个人资料，并且如果其用户为零，您就会知道它是否是“机器人”。您也可以在不使用 STI 的情况下存储“类型”字段。

某些事情会影响我使用 STI 的决定：

*   是否有特定于bot的逻辑
*   有多少机器人与用户配置文件（机器人数量少意味着 STI 是好的 - 很多机器人，我可能会将它们存储在其他地方）

避免 STI 的原因是它有时会妨碍您。例如，将对象从一种类型更改为另一种类型（在这种情况下是 Bot 到 Profile）可能会非常烦人。有时一个简单的“类型”字段会更好。

值得注意的是，如果您使用 STI，您可能需要一个通用的基类。所以你可能想要`Profile`,`BotProfile`和`UserProfile`. 名字由你决定。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-18T00:23:20.763

Rails STI 的一个问题——大多数插件（等等）并不完全支持它。你会发现自己修补了许多常见的补丁。

# ruby-on-rails - RESTful rails 应用程序的简单面包屑

> ID：555669
> 
> 赞同：3
> 
> 时间：2009-02-17T06:04:32.340
> 
> 标签：ruby-on-rails, rest, breadcrumbs

是否有任何帮助方法（除了[默认的 rails breadcrumb](http://wiki.rubyonrails.org/rails/pages/Breadcrumbs)）可以为特定页面动态生成面包屑导航，而无需在 RESTful 应用程序中传递琐碎的参数？也就是说，可以根据用户访问的 REST url 自动确定用户的位置？

对于上述实现，我们需要传递参数，如

**休息**

```
<% add_crumb(‘Profile’, user_profile_path) %> 
```

**当前页面**

```
<% add_crumb(“My Incoming Messages”, request.path) %> 
```

必须有一种方法来概括代码，这样就不需要传递参数，并且应该适用于所有具有最少配置的 RESTful 应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T06:20:36.687

开发了一个简单的hack。然而，该方法假定与 RESTful url 中的每个资源对应的每个模型对象都存在一个方法“名称”。无论方法“名称”返回什么，都显示为面包屑名称。如果未找到，则按原样显示，而不使其链接到任何内容。使用的分隔符是 '->' 您可以更改它以满足您的要求。

```
def get_bread_crumb(url)
  begin
    breadcrumb = ''
    sofar = '/'
    elements = url.split('/')
    for i in 1...elements.size
      sofar += elements[i] + '/'
      if i%2 == 0
        begin
          breadcrumb += "<a href='#{sofar}'>"  + eval("#{elements[i - 1].singularize.camelize}.find(#{elements[i]}).name").to_s + '</a>'
        rescue
          breadcrumb += elements[i]
        end
      else
        breadcrumb += "<a href='#{sofar}'>#{elements[i].pluralize}</a>"
      end
      breadcrumb += ' -> ' if i != elements.size - 1
    end
    breadcrumb
  rescue
    'Not available'
  end
end 
```

该方法一般接受request.url（给定当前页面的url）作为参数。该方法有目的地接受 url 用于自定义目的。要生成面包屑，只需在视图中添加以下代码 -

`<%= get_bread_crumb(request.url) %>`

对于 url `/ideabox/2/idea/1`，面包屑看起来像

[替代文字 http://www.imagechicken.com/uploads/1234855404069992300.png](http://www.imagechicken.com/uploads/1234855404069992300.png)

如果代码质量不是那么好，请原谅。我确信这段代码可以重构，但我也确信你可以在使用它之前做到这一点。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-17T00:53:25.303

chirantan 提供的解决方案很棒。如果您需要命名空间控制器的面包屑，并且还需要根据命名空间更改面包屑，那么试试这个。这并不完美，但可以根据需要对其进行重构。它适用于我的项目。

定义一个新的助手：`navigation_helper.rb`

```
module NavigationHelper

  def navigation_add(title, url, namespace)

    if defined? @@namespace and !@@namespace.nil? and @@namespace == namespace
      @@navigation ||= []
    else
      @@navigation = []
    end

    @@navigation << {title: title, url: url} unless title == "Home"

    new_nav = []
    @@navigation.each do |hash|
      new_nav.push hash
      if hash[:title].to_s == title.to_s
        break
      end
    end

    @@navigation = new_nav
    @@navigation.uniq!
    @@namespace = namespace
  end

  def render_navigation
    if (request.path_parameters[:controller].sub('/', '::_').camelize + 'Controller').classify.constantize.action_methods.to_a.include? 'index'
      navigation_add controller_name.camelize.to_s, request.path_parameters.merge({action: 'index'}).except(:id), params[:controller].include?('/') ? params[:controller].split("/").first : nil
    end
    if defined? @@navigation
      render partial: 'navigation/navigation', locals: { navs: @@navigation, namespace: @@namespace }
    else
      render text: ''
    end
  end
end 
```

然后为这个助手定义一个视图`_navigation.haml`

```
- unless navs.blank?

  %ol.breadcrumb

    - navs.each_with_index do |nav, index|

      - if index == 0

        %li=link_to fa_icon('arrow-left', text: 'Go Back'), :back

        - unless namespace.nil?

          %li

            %h4.inline= request.fullpath.split('/')[1].gsub('-', '_').camelize

            = fa_icon('angle-double-right')

      %li= link_to_unless (nav[:title] == controller_name.camelize and action_name == 'index'),  fa_icon(nav[:title].downcase.singularize, text: nav[:title]), nav[:url] 
```

# c++ - 嵌套类和对外部类的引用 (c++)

> ID：555681
> 
> 赞同：1
> 
> 时间：2009-02-17T06:19:12.197
> 
> 标签：c++

这很简单 - gcc 无法编译此示例代码 (c++)。

```
class myclass {
    struct mystruct {
        myclass something;
        int something_else;
    };
}; 
```

它告诉我，

> 字段“某事”的类型不完整。

我可能错过了一些琐碎的事情，因为我在 C++ 中很新，但是为什么我不能使用外部类的引用来制作嵌套类/结构呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T06:22:44.903

你不能把一个物体放进它自己。也许你想要一个指向 myclass 的指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:28:40.470

好吧，在您放置该成员时，嵌套类 myclass 尚未完成。当 myclass 完成后，您可以定义 mystruct 类型：

```
class myclass {
    struct mystruct;
};

struct myclass::mystruct {
        myclass something;
        int something_else;
}; 
```

请注意，仅仅因为 mystruct 是 myclass 的嵌套类型，并不意味着 myclass 包含 mystruct 的对象。所以这里的循环遏制是没有问题的。既然你提到你来自 Java - 当我告诉你嵌套类就像 Java 中的静态嵌套类时，它可能会对你有所帮助。事实上，C++ 不像 Java 中那样具有“非静态嵌套类”。所以如果你创建了一个myclass对象，既没有自动创建和嵌入的mystruct对象，也没有可以创建的mystruct和嵌套类的任何创建对象之间的特殊关系。C++ 中的嵌套类给你带来了什么（可能更多——这是我的想法）：

*   将外部类的成员包括到通常的非限定名称查找中 (1)
*   嵌套类和嵌套类的自动友谊——嵌套类可以访问嵌套类的非公共成员。(2)
*   将嵌套类从外部隐藏或封装到嵌套类中。

这是一个例子：

```
class myclass {
    typedef int test_type;

    struct mystruct;
    mystruct * s; 
};

struct myclass::mystruct {
        mystruct() {
            // note, setting private member (2)
            something.s = this;

            // note, we don't have to type myclass::test_type (1)
            test_type silly_integer = 42;
        }
        myclass something;
        int something_else;
}; 
```

但是你可能想在你的代码中放置一个指向嵌套类的指针——当嵌套类进入游戏时，这通常是需要的。您必须记住，当您有一个变量时，该变量是对象本身的名称 - 而不仅仅是对它的引用（如在 java 中）。然而，C++ 指针的行为类似于 Java 引用——它可以在其生命周期内为空并指向不同的对象：

```
struct myclass::mystruct {
        myclass *something;
        int something_else;
}; 
```

这将使其仅引用 myclass 类型的对象，该对象将在其他地方创建，而不是该对象本身。所以，它就像一个节点，*可能*有一个父节点（由某物指向）——但不是必须的。就像指向某个容器的迭代器一样，它正在迭代。

还有另一种方法，嵌套类有一个指向嵌套类的指针（除了我上面的愚蠢示例）。**这在pimpl idiom**中非常常用。我强烈建议你看看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T06:23:00.487

`myclass`尚未完全定义，您已经在使用它。您可以改用指向的指针来解决此问题`myclass`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T06:24:48.080

为了创建一个`myclass`对象，您需要有一个`mystruct`对象，而后者又需要一个`myclass`对象，所以......你得到了漂移。链接列表是您遇到此类问题的常见情况。你试过用指针吗？

```
class myclass {
struct mystruct {
    myclass* something;
    int something_else;
    }
}; 
```

# c++ - 多维字符数组

> ID：555684
> 
> 赞同：1
> 
> 时间：2009-02-17T06:20:59.417
> 
> 标签：c++, arrays

如何在 C++ 中初始化和取消初始化多维字符数组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T06:33:36.360

阅读[**常见问题解答**](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.16)——您会在那里找到所需的一切！

**创建：**

静态分配：

```
char mda[ dim1_size ][ dim2_size ]...[ dimn_size ]; 
```

动态分配：嵌套`new[]`调用。

**初始化：**

嵌套for循环；`for`与您的尺寸一样多。

**统一化：**你的意思是破坏吗？

静态分配：编译器在堆栈帧展开时执行此操作（或对于全局变量——当程序停止运行时）。

动态分配：

```
Using nested delete[]. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T07:12:40.180

我建议你使用 Boost.Multi_Array 库。数组的维度必须在编译时提供，但大小仅在运行时使用。这意味着您拥有动态分配的优势，而无需处理内存问题。

这是[Boost 文档](http://www.boost.org/doc/libs/release/libs/multi_array/doc/user.html)中的示例。

```
int 
main () {
  // Create a 3D array that is 3 x 4 x 2
  typedef boost::multi_array<double, 3> array_type;
  typedef array_type::index index;
  array_type A(boost::extents[3][4][2]);

  // Assign values to the elements
  int values = 0;
  for(index i = 0; i != 3; ++i) 
    for(index j = 0; j != 4; ++j)
      for(index k = 0; k != 2; ++k)
        A[i][j][k] = values++;

  // Verify values
  int verify = 0;
  for(index i = 0; i != 3; ++i) 
    for(index j = 0; j != 4; ++j)
      for(index k = 0; k != 2; ++k)
        assert(A[i][j][k] == verify++);

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T06:59:13.007

这很有趣，**这**需要认真看待。

roo 给出的答案是一个被广泛使用的答案，但我喜欢他的观察——*仅仅因为它编译并不意味着它有效*

我认为更好的解决方案是分配一个连续的内存块（行*列），然后将其视为二维数组？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T06:35:17.773

你可以像这样初始化一个多维数组：

```
int grid[2][3] = {1, 3, 5, 2, 4, 6}; 
```

在这种情况下，单独的值将是：

```
grid[0, 0]: 1
grid[0, 1]: 3
grid[0, 2]: 5
grid[1, 0]: 2
grid[1, 1]: 4
grid[1, 2]: 6 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T06:38:49.483

一个快速的片段 - 它在 g++ 中编译。

```
int rows = 10;
int cols = 10;

char** array = new char*[rows];
for( int i = 0; i < cols; ++i ) {
  array[i] = new char[cols];
}

//do stuff with array

for( int i = 0; i < cols; ++i ) {
  delete array[i];
}
delete array; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-26T12:21:47.687

我是用井字棋板学的

```
const int ROW = 3;
const int COLUMN = 3;
char board [ROW] [COLUMN] = {{'O', 'X', 'O'},
                             {'X', 'X', 'X'},
                             {'X', 'O', 'X'}}; 
```

我希望这会有所帮助。

# cocoa - 处理 OSX Dock 拖放

> ID：555685
> 
> 赞同：7
> 
> 时间：2009-02-17T06:21:45.403
> 
> 标签：cocoa, pyobjc

关于如何在 OSX 中处理拖放到 Dock 的信息，我从高处和低处查看。拖放文档（[http://developer.apple.com/documentation/Cocoa/Conceptual/DragandDrop/DragandDrop.html#//apple_ref/doc/uid/10000069](http://developer.apple.com/documentation/Cocoa/Conceptual/DragandDrop/DragandDrop.html#//apple_ref/doc/uid/10000069)）我发现所有处理从一个视图拖到另一个视图。如果有人可以向我指出一些代码示例，那就太好了。

我正在使用 PyObjC 新娘编写我的应用程序，但同样欢迎 Cocoa 示例:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T06:38:46.643

好吧，看来我问得太早了。这是一个很棒的教程，展示了如何做到这一点：

[http://recurser.com/articles/2007/04/13/cocoa-drag-to-dock-to-open/](http://recurser.com/articles/2007/04/13/cocoa-drag-to-dock-to-open/)

基本上，只需将您的控制器设置为 NSApplication 的委托并实现 openFile 方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T11:34:41.220

[这是几周前的一个类似问题。](https://stackoverflow.com/questions/501079/how-do-i-make-an-os-x-application-react-when-a-file-picture-etc-is-dropped-on-i)我的回答涵盖了拖动文件，这就是您所说的；另一个答案包括拖动数据，例如图像和文本位（不是图像*文件*或文本*文件*，而是裸数据）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T23:53:25.360

[http://lethain.com/entry/2008/aug/06/cocoa-drag-and-drop-text-into-the-dock-icon/](http://lethain.com/entry/2008/aug/06/cocoa-drag-and-drop-text-into-the-dock-icon/)涵盖了使用 pyobjc 将文本拖放到停靠图标中。您可以轻松地将其调整到其他文件中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-18T06:50:22.790

[这是一个示例项目“DockDrop”。](http://r.rpj.me/ifionlyhadaname/DockDrop_1.0.zip)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-30T17:15:23.417

这是 Xcode 4 的更新文章 [http://fredandrandall.com/blog/2011/09/12/how-to-open-any-file-you-drag-onto-your-apps-dock-icon](http://fredandrandall.com/blog/2011/09/12/how-to-open-any-file-you-drag-onto-your-apps-dock-icon)

# windows - 如何在远程机器上启动和停止服务？

> ID：555693
> 
> 赞同：3
> 
> 时间：2009-02-17T06:26:32.537
> 
> 标签：windows

我在项目中有一个要求，即我们必须在远程机器（位于同一 LAN 上）中停止特定服务“x”，远程更改注册表项并再次启动服务。

我尝试了命令`sc \server stop service`，但我得到了错误：

> [SC] 获取服务密钥名称失败 1060：
> 
> 指定的服务不作为已安装的服务存在。

我正在使用 Windows 2003 SP1。Windows 上是否有任何内置命令或 API？

我需要在命令提示符下运行命令。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-01-03T15:02:45.787

另请记住，“sc”命令行工具所期望的“服务名称”参数并不总是等同于您在服务控制面板小程序中看到的名称（即服务“显示名称”）。

例如，在我的服务控制面板小程序中显示为“Adobe Acrobat Update Service”的服务的*实际名称*为“AdobeARMservice”。通过“sc”实用程序管理服务时，您必须使用后者，而不是前者。

例子：

```
sc Stop "AdobeARMservice" (works)
sc Stop "Adobe Acrobat Update Service" (doesn't work) 
```

要获得服务的“真实”名称，请在服务控制面板小程序中双击其条目，然后查看“常规”选项卡上的“服务名称”字段。

当然在某些情况下，显示名称和服务名称是相同的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T07:38:41.693

您可能想查看[SysInternals](http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx)中的[PSTools](http://technet.microsoft.com/en-us/sysinternals/default.aspx)。这些工具是免费提供的，可以帮助您管理远程 Windows 机器上的进程。

PsTools 套件中包含的工具可作为软件包下载，包括：

```
PsExec - 远程执行进程
PsFile - 显示远程打开的文件
PsGetSid - 显示计算机或用户的 SID
PsInfo - 列出有关系统的信息
PsKill - 按名称或进程 ID 杀死进程
PsList - 列出进程的详细信息
PsLoggedOn - 查看谁在本地和通过资源共享登录
PsLogList - 转储事件日志记录
PsPasswd - 更改帐户密码
PsService - 查看和控制服务
PsShutdown - 关闭并选择性地重新启动计算机
PsSuspend - 暂停进程
PsUptime - 显示系统自上次重启以来运行了多长时间
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T06:38:37.970

**从这个[网址](http://www.computing.net/answers/networking/stop-remote-services/25126.html)：**

```
To stop a service remotely you can use the command sc.

Example:
> sc \\computer stop "Service Name"
> sc \\computer start "Service Name" 
```

也许您缺少“\”字符？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T06:35:23.780

使用 OpenCSManager，然后使用 OpenService，然后使用 StartService。

# javascript - 将 javascript 放在一个 .js 文件中还是将其拆分为多个 .js 文件？

> ID：555696
> 
> 赞同：51
> 
> 时间：2009-02-17T06:28:02.520
> 
> 标签：javascript

我的 Web 应用程序使用 jQuery 和一些 jQuery 插件（例如验证、自动完成）。我想知道是否应该将它们粘贴到一个 .js 文件中以便可以更轻松地对其进行缓存，或者将它们分成单独的文件并仅包含给定页面所需的文件。

我还应该提到，我关心的不仅是下载 .js 文件所需的时间，还包括基于加载的 .js 文件内容的页面速度减慢多少。例如，即使在缓存时，添加自动完成插件也会使我的基本测试的响应时间减慢 100 毫秒左右。我的猜测是它必须扫描导致此延迟的 DOM 中的元素。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-02-17T20:03:33.523

我认为这取决于他们改变的频率。让我们看这个例子：

*   JQuery：一年换一次
*   第 3 方插件：每 6 个月更换一次
*   您的自定义代码：每周更改

如果您的自定义代码仅占总代码的 10%，那么您不希望用户每周下载另外 90%。您将至少拆分为 2 个 js：JQuery + 插件和您的自定义代码。现在，如果您的自定义代码代表完整大小的 90%，则将所有内容放在一个文件中更有意义。

在选择如何组合 JS 文件（CSS 也是如此）时，我平衡：

*   文件的相对大小
*   预期更新次数

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-17T06:46:11.820

常见但相关的答案：

> 这取决于项目。

如果您有一个相当有限的网站，其中大部分功能在网站的多个部分中重复使用，那么将所有脚本放在一个文件中是有意义的。

然而，在我参与过的几个大型 Web 项目中，将通用站点范围的功能放入单个文件并将更多特定于部分的功能放入它们自己的文件中会更有意义。（我们在这里讨论的是大型脚本文件，用于几个不同的 Web 应用程序的行为，它们都在同一个域下提供服务。）

将脚本拆分为单独文件的好处是，您不必为用户提供他们没有使用的不必要的内容和带宽。（例如，如果他们从不访问网站上的“App A”，他们将永远不需要“App A”部分的 100K 脚本。但他们需要通用的站点范围的功能。）

将脚本保存在一个文件中的好处是简单。服务器上的点击次数更少。为用户减少下载。

不过，像往常一样，YMMV。没有硬性规定。根据用户的使用情况和项目结构，做对用户最有意义的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T06:53:30.680

如果每个页面都需要这些文件，请将它们放在一个文件中。这将减少 HTTP 请求的数量并提高响应时间（对于大量访问）。

有关其他提示，请参阅[Yahoo 最佳实践](http://developer.yahoo.com/performance/rules.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T06:31:40.530

如果人们要访问您网站中的多个页面，最好将它们全部放在一个文件中，以便缓存它们。他们会先受到一次打击，但这将是他们在您网站上花费的全部时间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T06:32:23.663

在一天结束时，这取决于你。

但是，每个网页包含的信息越少，最终浏览者下载的速度就越快。

如果您只包含每个页面所需的 js 文件，您的网站似乎更有可能更加高效和精简

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T13:14:36.393

这在很大程度上取决于用户与您的网站交互的方式。

一些问题供您考虑：

*   您的第一页加载速度非常快有多重要？
*   用户是否通常将大部分时间花在具有功能子集的网站的不同部分？
*   您是否需要在页面准备好时准备好所有脚本，或者您可以在页面加载后通过在页面中插入`<script>`元素来加载一些脚本？

如果您真的希望提高性能，那么了解用户如何使用您的网站以及您想要优化的内容是一个好主意。

但是，我的默认方法是将我的所有 javascript 连接并缩小到一个文件中。jQuery 和 jQuery.ui 很小，开销也很低。如果您使用的插件对页面加载时间有 100 毫秒的影响，那么可能有问题。

需要检查的几件事：

*   您的 HTTP 服务器上是否启用了 gzipping？
*   您是否在部署过程中生成具有唯一名称的静态文件？
*   您是否正在提供具有永无止境的缓存过期的静态文件？
*   您是否在页面顶部包含 CSS，在底部包含脚本？
*   有没有更好（更小、更快）的 jQuery 插件可以做同样的事情？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-17T07:47:21.657

我非常同意 bigmattyh 所说的话，这取决于。

作为一般规则，我尝试尽可能多地聚合脚本文件，但如果您有一些仅在站点的少数区域使用的脚本，尤其是那些在加载时执行大型 DOM 遍历的脚本，那么将是有意义的将它们留在单独的文件中。
例如，如果您只在您的联系页面上使用验证，为什么要在您的主页上加载它？

顺便说一句，您有时可以将这些文件偷偷放到插页式页面中，而其他内容并不多，因此当用户登陆需要它的其他非常沉重的页面时，它应该已经被缓存 - 谨慎使用 - 但可以当有人对您进行基准测试时，这是一个方便的技巧。

因此，在合理范围内尽可能少的脚本文件。

如果您要发送 100K 的单体，但仅将 20K 用于 80% 的页面，请考虑将其拆分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-01T01:56:09.197

我基本上已经到了将整个 Web 应用程序减少到 3 个文件的地步。

*   供应商.js
*   应用程序.js
*   应用程序.css

供应商很整洁，因为它也包含所有样式。即，我将所有供应商 CSS 转换为缩小的 CSS，然后将其转换为 javascript，并将其包含在 vendor.js 文件中。那是在它也被 sass 改造之后。

因为我的供应商的东西不经常更新，所以一旦投入生产就很少见了。当它确实更新时，我只需将其重命名为 vendor_1.0.0.js 之类的名称。

还有这些文件的缩小版本。在开发中我加载未缩小的版本，在生产中我加载缩小版本。

我使用 gulp 来处理所有这些。使这成为可能的主要插件是....

*   吞咽包括
*   gulp-css2js
*   吞咽连接
*   gulp-csso
*   gulp-html-to-js
*   吞咽模式
*   gulp-重命名
*   吞咽丑化
*   节点 sass 波浪号导入器

现在这也包括我的图像，因为我使用 sass 并且我有一个 sass 函数，可以将图像编译为我的 css 表中的数据 URL。

```
function sassFunctions(options) {
options = options || {};
options.base = options.base || process.cwd();

var fs = require('fs');
var path = require('path');
var types = require('node-sass').types;

var funcs = {};

funcs['inline-image($file)'] = function (file, done) {
    var file = path.resolve(options.base, file.getValue());
    var ext = file.split('.').pop();
    fs.readFile(file, function (err, data) {
        if (err) return done(err);
        data = new Buffer(data);
        data = data.toString('base64');
        data = 'url(data:image/' + ext + ';base64,' + data + ')';
        data = types.String(data);
        done(data);
    });
};

return funcs;
} 
```

所以我的 app.css 将在 css 中包含我所有的应用程序图像，我可以将图像添加到我想要的任何样式块中。通常，我为独特的图像创建类，如果我希望它具有该图像，我只会使用该类的东西。我完全避免使用图像标签。

此外，使用 html 到 js 插件我将所有 html 编译为 js 文件到一个模板对象，该对象由 html 文件的路径散列，即“html\templates\header.html”，然后使用类似敲除的东西我可以数据-将该html绑定到一个元素或多个元素。

最终结果是我可以最终得到一个完整的 Web 应用程序，该应用程序启动一个“index.html”，其中没有任何内容，但这个：

```
<html>
<head>
    <script src="dst\vendor.js"></script>
    <script src="dst\app.css"></script>
    <script src="dst\app.js"></script>
</head>
<body id="body">
    <xyz-app params="//xyz.com/api/v1"></xyz-app>
    <script>
        ko.applyBindings(document.getTagById("body"));
    </script>
</body>
</html> 
```

这将启动我的组件“xyz-app”，它是整个应用程序，它没有任何服务器端事件。它不在 PHP、DotNet Core MVC、一般的 MVC 或任何类似的东西上运行。它只是用 Gulp 之类的构建系统管理的基本 html，它需要的所有数据都是 rest api。

*   身份验证 -> 休息 API
*   产品 -> 休息API
*   搜索 -> Google Compute Engine（python api 用于索引从 rest api 返回的内容）。

所以我从来没有从服务器返回任何 html（只是静态文件，它们非常快）。除了 index.html 本身之外，只有 3 个文件需要缓存。Web 服务器支持默认文档 (index.html)，因此您只会在 url 中看到“blah.com”以及用于维护状态的任何查询字符串或散列片段（用于为 url 添加书签的路由等）。

快疯了，一切都在运行它的 JS 引擎上等待。

搜索优化比较棘手。这只是一种不同的思考方式。即你让谷歌抓取你的api，而不是你的物理网站，你告诉谷歌如何在每个结果上访问你的网站。

假设您有一个产品 ID 为 129 的 ABC Thing 产品页面。Google 将抓取您的产品 api 以遍历您的所有产品并将它们编入索引。在那里，您的 api 在结果中返回一个 url，告诉谷歌如何在网站上访问该产品。即“ [http://blah#products/129](http://blah#products/129) ”。

因此，当用户搜索“ABC 事物”时，他们会看到列表并单击它会将他们带到“ [http://blah#products/129](http://blah#products/129) ”。

我认为搜索引擎需要像这样开始变得聪明，这是未来的 imo。

我喜欢建立这样的网站，因为它摆脱了所有后端的复杂性。您不需要 RAZOR、PHP、Java 或 ASPX Web 表单，也不需要摆脱那些整个堆栈......您所需要的只是一种编写 rest api（WebApi2、Java Spring 或w/e 等）。

这将网页设计分为 UI 工程、后端工程和设计，并在它们之间建立了清晰的分离。您可以让 UX 团队构建整个应用程序，而让架构团队完成所有其余的 api 工作，这样就不需要全栈开发人员。

安全性也不是问题，因为您可以在 ajax 请求上传递凭据，如果您的东西都在同一个域上，您可以在根域上创建您的身份验证 cookie 并 presto（自动、无缝 SSO 与您的所有其余 api） .

更不用说服务器场设置有多简单。负载平衡需求少了很多。交通能力要高很多。在负载均衡器上集群 rest api 服务器比整个网站更容易。

只需设置 1 个 nginx 反向代理服务器即可为您的索引 .html 提供服务，并将 api 请求定向到 4 个 rest api 服务器之一。

*   API 服务器 1
*   API 服务器 2
*   API 服务器 3
*   API 服务器 4

并且您的 sql 框（复制的）只是从 4 个其余 api 服务器获得负载平衡（如果可能，全部使用 SSD）

*   Sql 框 1
*   Sql 框 2

您的所有服务器都可以在没有公共 ips 的内部网络上，只需将反向代理服务器公开，所有请求都会进入它。

您可以在循环 DNS 上对反向代理服务器进行负载平衡。

这意味着您只需要 1 个 SSL 证书，因为它是一个公共域。

如果您使用 Google Compute Engine 进行搜索和 seo，那是在云端，所以无需担心，只需 $。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-17T07:04:13.430

如果您喜欢将代码放在单独的文件中进行开发，您可以随时编写一个快速脚本在缩小之前将它们连接到一个文件中。

正如其他海报所指出的那样，一个大文件更适合减少 HTTP 请求。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-17T07:45:19.633

我也认为你应该像其他人建议的那样走一个文件的路线。但是，就您的观点而言，仅将插件包含在大型 js 文件中就会占用周期：

在执行昂贵的操作之前，请使用一些检查以确保您甚至在需要操作的页面上。也许您可以在运行自动完成插件之前检测到 dom 节点的存在（或不存在），并且仅在必要时初始化插件。无需在永远不需要某些功能的页面或部分上浪费 dom 遍历的开销。

在昂贵的代码块之前的简单条件将为您提供您正在决定的两种方法的好处。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-07-21T08:46:44.947

我尝试在多个文件中破坏我的 JS 并遇到了问题。我有一个登录表单，我将其代码（AJAX 提交等）放在它自己的文件中。登录成功后，AJAX 回调调用函数来显示其他页面元素。由于这些元素不是登录过程的一部分，我将它们的 JS 代码放在一个单独的文件中。问题是一个文件中的 JS 不能调用第二个文件中的函数，除非首先加载第二个文件（请参阅 Stack Overflow Q. 25962958），因此，在我的情况下，被调用的函数无法显示其他页面元素. 有一些方法可以解决这个加载顺序问题（参见 Stack Overflow Q. 8996852），但我发现将所有代码放在一个更大的文件中并清楚地分开和注释属于同一功能组的代码部分更简单，例如

# python - 使用 Python 进行字符翻译（如 tr 命令）

> ID：555705
> 
> 赞同：54
> 
> 时间：2009-02-17T06:33:06.780
> 
> 标签：python, perl, tr, transliteration

有没有办法使用**Python**[`tr`](https://perldoc.perl.org/functions/tr)进行字符翻译/音译（有点像命令）？

 **Perl 中的一些示例是：

```
my $string = "some fields";
$string =~ tr/dies/eaid/;
print $string;  # domi failed

$string = 'the cat sat on the mat.';
$string =~ tr/a-z/b/d;
print "$string\n";  # b b   b.  (because option "d" is used to delete characters not replaced) 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-17T06:40:10.757

看[`string.translate`](http://docs.python.org/library/stdtypes.html#str.translate)

```
import string
"abc".translate(string.maketrans("abc", "def")) # => "def" 
```

请注意文档关于 unicode 字符串翻译中的微妙之处的评论。

而对于 Python 3，您可以直接使用：

```
str.translate(str.maketrans("abc", "def")) 
```

编辑：由于`tr`有点高级，也考虑使用`re.sub`.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-09-06T12:17:56.313

如果您使用的是 python3，则翻译不那么冗长：

```
>>> 'abc'.translate(str.maketrans('ac','xy'))
'xby' 
```

啊..还有等价于`tr -d`：

```
>>> "abc".translate(str.maketrans('','','b'))
'ac' 
```

对于`tr -d`python2.x 使用附加参数来翻译函数：

```
>>> "abc".translate(None, 'b')
'ac' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-15T13:11:18.147

我开发了python-tr，实现了tr算法。让我们试试看。

安装：

```
$ pip install python-tr 
```

例子：

```
>>> from tr import tr
>>> tr('bn', 'cr', 'bunny')
'curry'
>>> tr('n', '', 'bunny', 'd')
'buy'
>>> tr('n', 'u', 'bunny', 'c')
'uunnu'
>>> tr('n', '', 'bunny', 's')
'buny'
>>> tr('bn', '', 'bunny', 'cd')
'bnn'
>>> tr('bn', 'cr', 'bunny', 'cs')
'brnnr'
>>> tr('bn', 'cr', 'bunny', 'ds')
'uy' 
```

*   [https://pypi.python.org/pypi/python-tr](https://pypi.python.org/pypi/python-tr)
*   [https://github.com/ikegami-yukino/python-tr](https://github.com/ikegami-yukino/python-tr)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-18T17:41:42.637

在 Python 2 中，`unicode.translate()`接受普通映射，即。也不需要导入任何东西：

```
>>> u'abc+-'.translate({ord('+'): u'-', ord('-'): u'+', ord('b'): None})
u'ac-+' 
```

该`translate()`方法对于交换字符（如上面的“+”和“-”）特别有用，这不能用 来完成`replace()`，并且`re.sub()`为此目的使用也不是很简单。

然而，我不得不承认，重复使用`ord()`不会使代码看起来漂亮整洁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-01T12:13:27.727

我们建立一个地图，然后逐字翻译。当使用 get 作为字典时，第二个参数指定如果找不到任何东西要返回什么。

它可以很容易地转移到单独的功能。大多数情况下应该非常有效。

```
def transy(strin, old, new):
  assert len(old)==len(new)
  trans = dict(zip(list(old),list(new)))
  res =  "".join([trans.get(i,i) for i in strin])
  return res

>>> transy("abcd", "abc", "xyz")
'xyzd' 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2013-10-03T18:00:24.673

更简单的方法可能是使用替换。例如

```
 "abc".replace("abc", "def")
'def' 
```

无需导入任何东西。在 Python 2.x 中工作

# .net - 跨平台更改屏幕分辨率的方法

> ID：555706
> 
> 赞同：5
> 
> 时间：2009-02-17T06:33:11.010
> 
> 标签：.net, mono, cross-platform, screen-resolution

是否有任何跨平台方式（Windows、Linux、MacOSX）来更改屏幕分辨率？Java 和 .Net-Mono 都无法做到这一点。只能通过本机 API 调用。这是很奇怪的情况：有明确（托管）的方法来获取屏幕分辨率，但没有设置方法。此功能是否非常危险或复杂？是否有任何其他跨平台系统（Parrot、RealBasic 等）可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T07:54:27.100

我不确定您是否使用 libSDL，但请查看：http: [//docs.huihoo.com/sdl/1.2/sdlsetvideomode.html](http://docs.huihoo.com/sdl/1.2/sdlsetvideomode.html)

PS 哦，顺便说一句，如果不知道的话，LibSDL 是一个主要用于游戏的跨平台库。 [http://www.libsdl.org/](http://www.libsdl.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T07:37:18.657

实际上 - 设置屏幕分辨率取决于 OS/X-Server。如果您真的需要它，您应该考虑它，然后，如果需要，您应该编写某种具有特定于操作系统实现的抽象层。并且设置测试环境（尤其是使用不同的 Linux 风格）将是地狱！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T06:55:07.180

嗯，这真的取决于平台（win32、Mac OS X、Linux 都不同[不同的显示驱动程序]）。您可能应该首先问自己为什么需要更改屏幕分辨率。

您可以轻松地而不是更改分辨率，而是以较低的屏幕分辨率渲染您拥有的任何内容，然后对其进行缩放以适应（填充）屏幕。这是同一件事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T06:58:49.807

这是个好问题。我不知道有任何跨平台系统可以做到这一点。我曾经开发过一个可以自动更改屏幕分辨率的应用程序，如果我不得不重新做一次，我就不会那样设计它了。更改分辨率会对用户造成干扰——有点像移动脚下的地面。LCD 显示器具有迄今为止看起来最好的“自然”分辨率。如果你改变它，用户可能会非常恼火。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:32:59.630

有很多设备无法更改分辨率。电话，例如 *其中一些运行 Mac OSX 或 Linux）。但即使在台式机上，改变分辨率的能力也不是给定的。您可能需要某种超级用户帐户。考虑到这些限制，跨平台工具不打扰似乎是合乎逻辑的。

# gcc - 在 AIX 上编译的帮助

> ID：555711
> 
> 赞同：1
> 
> 时间：2009-02-17T06:35:28.367
> 
> 标签：gcc, aix

是否有一个站点可以找到特定库中使用的符号及其版本。例如，我试图在 AIX 上使用 gcc 编译一些代码，它给我带来了很多未定义的符号错误例如，这是一个输出：

```
ld: 0711-317 ERROR: Undefined symbol: .__fixdfdi
ld: 0711-317 ERROR: Undefined symbol: .__divdi3
ld: 0711-317 ERROR: Undefined symbol: .__moddi3
ld: 0711-317 ERROR: Undefined symbol: .__floatdidf
ld: 0711-317 ERROR: Undefined symbol: .__umoddi3
ld: 0711-317 ERROR: Undefined symbol: .__udivdi3
ld: 0711-317 ERROR: Undefined symbol: .__fixunsdfdi 
```

我在哪里可以找到这些符号在哪里。如果我在 Linux 上运行相同的`gcc`命令，它运行良好。

我也尝试包括在内`-lgcc`，但它又会为某些`register_frame`...blah blah... 抛出未定义的符号，而且我厌倦了 AIX。

对此的任何帮助将不胜感激..请不要在这个问题上使用谷歌搜索。你最终将无处可去。

许多人问过这类问题，但没有答案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T07:04:18.953

自从我在 AIX 上编译任何东西以来已经有很长时间了（谢天谢地），我确实感受到了您的痛苦，因为花了一年左右的时间试图让我们公司的 JNI 和其他在 AIX 上构建的软件库。

我似乎确实记得 GCC 从来没有特别好用，因为它总是会出现类似的错误。有没有使用本机编译器（xlC）的选项？

如果我不检查你的图书馆的顺序，它在使东西正常工作方面起着重要作用..

我认为您已经使用 nm 实用程序遍历 /usr/lib （等）中的每个库以查找丢失符号的位置？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T06:29:57.587

这些是数学符号。尝试将 -lm 添加到您的链接行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-20T12:39:51.450

这是因为您使用**gcc**编译了一个要链接到使用**xlc**编译的代码的库。或者至少是我的情况

您有 2 个选项：

1.  使用 xlc 而不是 gcc 进行所有编译（不要混合 gcc 和 xlc）
2.  使用 xlc 编译但也调用 gcc 库，例如：

> ```
> sudo  find  / -name libgcc.a
> /opt/freeware/lib/gcc/powerpc-ibm-aix6.1.0.0/4.2.0/libgcc.a
> 
> /opt/IBM/xlC/13.1.0/bin/xlC -g  -o MyBIN MyBIN.o  -L/usr/etctera -
>  L/opt/freeware/lib/gcc/powerpc-ibm-aix6.1.0.0/4.2.0/ -lgcc -letcetera 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:29:33.117

主要是问题：

*   哪个版本的 GCC？
*   您使用的是哪个版本的 AIX？
*   您的 GCC 副本是为哪个版本的 AIX 构建的？
*   您使用的链接线到底是什么？

在使用在 AIX 的低版本上编译的 GCC 版本时，我已经看到了这种错误。例如，如果 GCC 是为 AIX 4.3.3 编译的，并且正在 AIX 5.x 上运行。通常，如果 GCC 是在 AIX 的向上版本上编译的，它不会在向下版本上运行，所以这不太可能是问题。

另一种（不太可能）的可能性：您的 GCC 是否安装在编译预期安装的位置？当你构建它时，你指定（可能是隐式的）安装位置（默认情况下，在 下`/usr/local`）。如果您将副本安装在其他地方，但其中有一个旧的 GCC，`/usr/local`并且您的副本希望安装在 中`/usr/local`，那么您可能会遇到此类问题。这比版本不匹配的可能性要小得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-23T15:37:06.670

列出的外部符号来自`libgcc`所以添加`-lgcc`是正确的。`register_frame`也是 32 位的一部分，但`libgcc`仅适用于 32 位。检查您是否为编译器、链接器和库使用相同的位深度模式。

# javascript - 一个很好的与浏览器和 DOM 相关的 Javascript API 参考文档

> ID：555726
> 
> 赞同：32
> 
> 时间：2009-02-17T06:41:50.207
> 
> 标签：javascript, api, reference

我正在寻找一个很好的 Javascript API 文档，尤其是与浏览器和 DOM 相关的文档。我不是在寻找任何类型的 Javascript 教程，而只是所有标准 Javascript 类和 Web 浏览器中使用的类的文档。

类似于 Java 的 Javadoc ( [http://java.sun.com/j2se/1.4.2/docs/api/](http://java.sun.com/j2se/1.4.2/docs/api/) )

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-17T07:15:31.173

标准如何？

1.  [DOM2 核心](http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/DOM2-Core.pdf)(W3C)
2.  [DOM2 事件](http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/DOM2-Events.pdf)(W3C)
3.  [DOM2 HTML](http://www.w3.org/TR/2003/REC-DOM-Level-2-HTML-20030109/DOM2-HTML.pdf) (W3C)
4.  [DOM2 CSS](http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/DOM2-Style.pdf) (W3C)

对于 javascript 本身：

5.  [标准 ECMA-262 ECMAScript 语言规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)(ECMA)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-17T06:46:02.460

[Gecko DOM 参考](https://developer.mozilla.org/en/Gecko_DOM_Reference)

[JavaScript 工具包 - DOM 参考](http://www.javascriptkit.com/domref/)

[还有更多](http://www.google.com/search?q=dom+reference)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-17T06:46:49.853

我更喜欢[Got API](http://www.gotapi.com/html)，它可以让您轻松查看有关 Web 开发的所有各个部分的 api 文档。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T06:46:46.110

[https://developer.mozilla.org/](https://developer.mozilla.org/)

它的 DOM 部分可能是你要找的，还有 Javascript。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-25T08:50:50.927

我遇到的最好的网站之一是 [http://www.quirksmode.org/](http://www.quirksmode.org/)

[http://www.quirksmode.org/compatibility.html](http://www.quirksmode.org/compatibility.html)

Compares major browsers’ CSS and JavaScript capabilities, as well as their adherence to the W3C standards.

**Added 18/01**

When can I use... [http://caniuse.com/](http://caniuse.com/)

Compatibility tables for support of HTML5, CSS3, SVG and more in desktop and mobile browsers

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T06:47:33.987

特定于 jQuery 我很喜欢[visualjquery.com](http://visualjquery.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T07:05:04.410

我发现，在大量使用这些东西时，没有什么比拥有一本书更好的了（由于磨损，它会自动在 2-3 个最受欢迎的地方打开）。没有什么比[rhino book](http://oreilly.com/catalog/9780596101992/?CMP=AFC-ak_book&ATT=JavaScript%3A+The+Definitive+Guide)更好的了，它还很好地涵盖了您可以从不同浏览器中获得的差异。获取最新版本。

# algorithm - 在数组中查找两个重复数字的算法，无需排序

> ID：555744
> 
> 赞同：25
> 
> 时间：2009-02-17T06:56:00.300
> 
> 标签：algorithm, search

有一个大小为 n 的数组（数字介于 0 和 n - 3 之间），并且只有 2 个数字重复。元素随机放置在数组中。

例如在 {2, 3, 6, 1, 5, 4, 0, 3, 5} n=9 中，重复的数字是 3 和 5。

找到重复数字的最佳方法是什么？

PS [你不应该使用排序]

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-17T07:08:15.417

如果您知道可能的输入域是什么，则有一个**O(n) 解决方案。**例如，如果您的输入数组包含 0 到 100 之间的数字，请考虑以下代码。

```
bool flags[100];
for(int i = 0; i < 100; i++)
    flags[i] = false;

for(int i = 0; i < input_size; i++)
    if(flags[input_array[i]])
         return input_array[i];
    else       
        flags[input_array[i]] = true; 
```

当然还有额外的内存，但这是最快的。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-17T08:39:15.013

好吧，看来我不能休息了:)

## 最简单的解决方案

```
int A[N] = {...};

int signed_1(n) { return n%2<1 ? +n : -n;  } // 0,-1,+2,-3,+4,-5,+6,-7,...
int signed_2(n) { return n%4<2 ? +n : -n;  } // 0,+1,-2,-3,+4,+5,-6,-7,...

long S1 = 0;  // or int64, or long long, or some user-defined class
long S2 = 0;  // so that it has enough bits to contain sum without overflow

for (int i=0; i<N-2; ++i)
{
   S1 += signed_1(A[i]) - signed_1(i);
   S2 += signed_2(A[i]) - signed_2(i);
} 

for (int i=N-2; i<N; ++i)
{
   S1 += signed_1(A[i]);
   S2 += signed_2(A[i]);
} 

S1 = abs(S1);
S2 = abs(S2);

assert(S1 != S2);  // this algorithm fails in this case

p = (S1+S2)/2;
q = abs(S1-S2)/2; 
```

一个和（S1 或 S2）包含符号相同的 p 和 q，另一个和 - 符号相反，所有其他成员都被消除。
*S1 和 S2 必须有足够的位来容纳和，由于 abs()，算法不代表溢出。*

如果 abs(S1)==abs(S2) 则算法失败，尽管该值仍然是 p 和 q 之间的差值（即 abs(p - q) == abs(S1)）。

## 以前的解决方案

我怀疑有人会在该领域遇到这样的问题；）
我想，我知道老师的期望：

让我们采用数组 {0,1,2,...,n-2,n-1}，
可以通过用未知的 p 和 q 替换最后两个元素 n-2 和 n-1 来生成给定的数组（少阶）

因此，元素的总和将是 (n-1)n/2 ***+ p + q - (n-2) - (n-1)***
平方和 (n-1)n(2n-1)/6 ***+ p^2 + q^2 - (n-2)^2 - (n-1)^2***

简单的数学仍然存在：

```
 (1)  p+q = S1  
  (2)  p^2+q^2 = S2 
```

当然，您不会像数学课教解决平方方程一样解决它。

首先，以 2^32 为模计算所有内容，即允许溢出。
然后检查对 {p,q}: {0, S1}, {1, S1-1} ... 对表达式（2）找到候选*（由于模和平方可能有超过 2 个）*
最后检查找到如果他们真的出现在数组中两次。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-17T13:19:33.573

您知道您的 Array 包含从 0 到 n-3 的每个数字以及两个重复的数字 (p & q)。为简单起见，让我们暂时忽略 0-case。

您可以计算数组的总和和乘积，结果是：

```
1 + 2 + ... + n-3 + p + q = p + q + (n-3)(n-2)/2 
```

所以如果你从整个数组的总和中减去 (n-3)(n-2)/2，你会得到

```
sum(Array) - (n-3)(n-2)/2 = x = p + q 
```

现在对产品做同样的事情：

```
1 * 2 * ... * n - 3 * p * q = (n - 3)! * p * q

prod(Array) / (n - 3)! = y = p * q 
```

你现在得到了这些条款：

```
x = p + q

y = p * q

=> y(p + q) = x(p * q) 
```

如果你变换这一项，你应该可以计算出 p 和 q

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-17T07:05:01.837

将每个元素插入到集合/哈希表中，首先检查它是否已经在其中。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-17T07:09:41.013

您也许可以利用 sum(array) = (n-2)*(n-3)/2 + 两个缺失数字这一事实。

编辑：正如其他人所指出的，结合平方和，你可以使用它，我只是有点慢了。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-17T07:08:58.067

查看有关该主题的旧但很好的论文：

*   [查找重复元素](http://www.cs.utexas.edu/users/misra/scannedPdf.dir/FindRepeatedElements.pdf) *(PDF)*

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-17T13:03:42.020

问题的一些答案：[确定数组是否包含 n...n+m 的算法？](https://stackoverflow.com/questions/177118/algorithm-to-determine-if-array-contains-n-nm)包含您可以为您的目的采用的子问题解决方案。

例如，这是[我的回答中的一个相关部分](https://stackoverflow.com/questions/177118/algorithm-to-determine-if-array-contains-n-nm/311497#311497)中的一个相关部分：

```
bool has_duplicates(int* a, int m, int n)
{
  /** O(m) in time, O(1) in space (for 'typeof(m) == typeof(*a) == int')

      Whether a[] array has duplicates.

      precondition: all values are in [n, n+m) range.

      feature: It marks visited items using a sign bit.
  */
  assert((INT_MIN - (INT_MIN - 1)) == 1); // check n == INT_MIN
  for (int *p = a; p != &a[m]; ++p) {
    *p -= (n - 1); // [n, n+m) -> [1, m+1)
    assert(*p > 0);
  }

  // determine: are there duplicates
  bool has_dups = false;
  for (int i = 0; i < m; ++i) {
    const int j = abs(a[i]) - 1;
    assert(j >= 0);
    assert(j < m);
    if (a[j] > 0)
      a[j] *= -1; // mark
    else { // already seen
      has_dups = true;
      break;
    }
  }

  // restore the array
  for (int *p = a; p != &a[m]; ++p) {
    if (*p < 0) 
      *p *= -1; // unmark
    // [1, m+1) -> [n, n+m)
    *p += (n - 1);        
  }

  return has_dups; 
} 
```

程序保持数组不变（数组应该是可写的，但它的值在退出时恢复）。

它适用于最大数组大小`INT_MAX`（在 64 位系统上`9223372036854775807`）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-09-15T14:04:29.193

```
假设数组是

a[0], a[1], a[2] ..... a[n-1]

sumA = a[0] + a[1] +....+a[n-1]
sumASquare = a[0]*a[0] + a[1]*a[1] + a[2]*a[2] + .... + a[n]*a[n]

sumFirstN = (N*(N+1))/2 其中 N=n-3 所以
sumFirstN = (n-3)(n-2)/2

相似地

sumFirstNSquare = N*(N+1)*(2*N+1)/6 = (n-3)(n-2)(2n-5)/6

假设重复元素是 = X 和 Y

所以 X + Y = sumA - sumFirstN;
X*X + Y*Y = sumASquare - sumFirstNSquare;

所以在求解这个二次方程时，我们可以得到 X 和 Y 的值。
时间复杂度 = O(n)
空间复杂度 = O(1)

```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-01-17T04:54:25.223

我知道这个问题很老了，但我突然想到了它，我想我有一个有趣的答案。我们知道这是一个脑筋急转弯和一个微不足道的解决方案（即 HashMap、Sort 等），无论它们有多好都会很无聊。

由于数字是整数，它们具有恒定的位大小（即 32）。让我们假设我们现在正在使用 4 位整数。我们寻找重复数字的**A**和**B。**

我们需要 4 个存储桶，每个存储一位。每个存储桶包含其特定位为 1 的数字。例如存储桶 1 获取 2、3、4、7、...：

```
Bucket 0 : Sum ( x where: x & 2 power 0 == 0 )
...
Bucket i : Sum ( x where: x & 2 power i == 0 ) 
```

如果没有重复，我们知道每个桶的总和是多少。我认为这是先验知识。

一旦生成了上述存储桶，其中的一堆将具有超出预期的值。通过从桶中构造数字，我们将拥有（A 或 B 供您参考）。

我们可以计算**（A XOR B）**如下：

```
A XOR B = Array[i] XOR Array[i-1] XOR ... 0, XOR n-3 XOR n-2  ... XOR 0 
```

现在回到桶，我们确切地知道哪些桶有我们的数字，哪些只有一个（来自 XOR 位）。

对于只有一个数字的桶，我们可以提取数字 num = (sum - 桶的预期总和)。然而，只有当我们能找到一个重复的数字时，我们才应该是好的，所以如果我们在 A XOR B 中至少有一位，我们就得到了答案。

但是如果 A XOR B 为零怎么办？好吧，这种情况只有在两个重复的数字都是相同的数字时才有可能，那么我们的数字就是 A OR B 的答案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-17T07:00:35.437

对数组进行排序似乎是最好的解决方案。然后，一个简单的排序将使搜索变得微不足道，并且将花费更少的时间/空间。

否则，如果您知道数字的域，请创建一个包含那么多桶的数组，并在遍历数组时递增每个桶。像这样的东西：

```
int count [10];

for (int i = 0; i < arraylen; i++) {
    count[array[i]]++;
} 
```

然后只需在您的数组中搜索大于 1 的任何数字。这些是具有重复项的项目。只需要遍历原始数组和遍历计数数组。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-09-15T09:35:30.697

**您可以使用简单的嵌套 for 循环**

```
 int[] numArray = new int[] { 1, 2, 3, 4, 5, 7, 8, 3, 7 };

        for (int i = 0; i < numArray.Length; i++)
        {
            for (int j = i + 1; j < numArray.Length; j++)
            {
                if (numArray[i] == numArray[j])
                {
                   //DO SOMETHING
                }
            } 
```

****或者，如果您想获取出现次数，您可以过滤数组并使用递归函数****

```
int[] array = { 1, 2, 3, 4, 5, 4, 4, 1, 8, 9, 23, 4, 6, 8, 9, 1,4 };
int[] myNewArray = null;
int a = 1;

 void GetDuplicates(int[] array)
    for (int i = 0; i < array.Length; i++)
            {
                for (int j = i + 1; j < array.Length; j++)
                {
                    if (array[i] == array[j])
                    {
                          a += 1;
                    }
                }
                Console.WriteLine(" {0} occurred {1} time/s", array[i], a);

                IEnumerable<int> num = from n in array where n != array[i] select n;
                 myNewArray = null;
                 a = 1;
                 myNewArray = num.ToArray() ;

                 break;

            }
             GetDuplicates(myNewArray); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-18T17:59:16.187

[这是@eugensk00](https://stackoverflow.com/questions/555744/algorithm-to-find-two-repeated-numbers-in-an-array-without-sorting/555956#555956)的答案（其修订之一）在Python 中的实现，它不使用模运算。它是一个**单遍**算法，**空间中的 O(log(n))**。如果使用固定宽度（例如 32 位）整数，则只需要两个固定宽度数字（例如，对于 32 位：一个 64 位数字和一个 128 位数字）。它可以处理任意大整数序列（它一次读取一个整数，因此整个序列不需要在内存中）。

```
def two_repeated(iterable):
    s1, s2 = 0, 0
    for i, j in enumerate(iterable):
        s1 += j - i     # number_of_digits(s1) ~ 2 * number_of_digits(i)
        s2 += j*j - i*i # number_of_digits(s2) ~ 4 * number_of_digits(i) 
    s1 += (i - 1) + i
    s2 += (i - 1)**2 + i**2

    p = (s1 - int((2*s2 - s1**2)**.5)) // 2 
    # `Decimal().sqrt()` could replace `int()**.5` for really large integers
    # or any function to compute integer square root
    return p, s1 - p 
```

例子：

```
>>> two_repeated([2, 3, 6, 1, 5, 4, 0, 3, 5])
(3, 5) 
```

上述代码的更详细版本与解释如下：

```
def two_repeated_seq(arr):
    """Return the only two duplicates from `arr`.

    >>> two_repeated_seq([2, 3, 6, 1, 5, 4, 0, 3, 5])
    (3, 5)
    """
    n = len(arr)
    assert all(0 <= i < n - 2 for i in arr) # all in range [0, n-2)
    assert len(set(arr)) == (n - 2) # number of unique items

    s1 = (n-2) + (n-1)       # s1 and s2 have ~ 2*(k+1) and 4*(k+1) digits  
    s2 = (n-2)**2 + (n-1)**2 # where k is a number of digits in `max(arr)`
    for i, j in enumerate(arr):
        s1 += j - i     
        s2 += j*j - i*i

    """
    s1 = (n-2) + (n-1) + sum(arr) - sum(range(n))
       = sum(arr) - sum(range(n-2))
       = sum(range(n-2)) + p + q - sum(range(n-2))
       = p + q
    """
    assert s1 == (sum(arr) - sum(range(n-2)))

    """
    s2 = (n-2)**2 + (n-1)**2 + sum(i*i for i in arr) - sum(i*i for i in range(n))
       = sum(i*i for i in arr) - sum(i*i for i in range(n-2))
       = p*p + q*q
    """
    assert s2 == (sum(i*i for i in arr) - sum(i*i for i in range(n-2)))

    """
    s1 = p+q
    -> s1**2 = (p+q)**2
    -> s1**2 = p*p + 2*p*q + q*q
    -> s1**2 - (p*p + q*q) = 2*p*q
    s2 = p*p + q*q
    -> p*q = (s1**2 - s2)/2

    Let C = p*q = (s1**2 - s2)/2 and B = p+q = s1 then from Viete theorem follows
    that p and q are roots of x**2 - B*x + C = 0
    -> p = (B + sqrtD) / 2
    -> q = (B - sqrtD) / 2
    where sqrtD = sqrt(B**2 - 4*C)

    -> p = (s1 + sqrt(2*s2 - s1**2))/2
    """
    sqrtD = (2*s2 - s1**2)**.5
    assert int(sqrtD)**2 == (2*s2 - s1**2) # perfect square
    sqrtD = int(sqrtD)
    assert (s1 - sqrtD) % 2 == 0 # even
    p = (s1 - sqrtD) // 2
    q = s1 - p
    assert q == ((s1 + sqrtD) // 2)
    assert sqrtD == (q - p)
    return p, q 
```

注意：计算数字的整数平方根 (~ N**4) 会使上述算法成为非线性算法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-01-09T18:17:37.593

检查一下... O(n) 时间和 O(1) 空间复杂度

```
 for(i=0;i< n;i++)
 xor=xor^arr[i]
 for(i=1;i<=n-3;i++)
 xor=xor^i; 
```

所以在给定的例子中，你会得到 3 和 5 的异或

```
xor=xor & -xor  //Isolate the last digit

for(i = 0; i < n; i++)
{
if(arr[i] & xor)
  x = x ^ arr[i]; 
else
  y = y ^ arr[i]; 
}
for(i = 1; i <= n-3; i++)
{
if(i & xor)
  x = x ^ i; 
else
  y = y ^ i; 
```

}

x 和 y 是你的答案

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-08-07T05:58:46.863

回答 18 .. 您正在使用 9 的数组，元素从 0 开始..所以 max ele 在您的数组中将是 6。对 0 到 6 的元素求和，然后对数组元素求和。计算它们的差异（例如 d）。这是 p + q。现在对 0 到 6 的元素进行异或运算（比如 x1）。现在对数组元素进行异或（比如 x2）。x2 是从 0 到 6 的所有元素的 XOR，除了两个重复元素，因为它们相互抵消。现在对于 i = 0 到 6，对于数组的每个 ele，说 p 是那个 ele a[i] 所以你可以通过从 d 中减去这个 ele 来计算 q。对 p 和 q 进行 XOR 并用 x2 对它们进行 XOR 并检查 x1==x2。同样对所有元素执行此操作，您将获得满足此条件的元素，并且您在 O(n) 中完成。继续编码！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-05-12T22:50:23.750

由于指定了范围，您可以执行基数排序。这将在 O(n) 中对您的数组进行排序。然后在排序数组中搜索重复项是 O(n)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-08-25T17:19:34.400

这是一个使用订单统计并在`O(n)`.

`SELECT`您可以通过以中值作为参数重复调用来解决此问题。

您还依赖于这样一个事实：在调用 之后`SELECT`，小于或等于中位数的元素将移动到中位数的左侧。

*   `SELECT`以`A`中位数为参数调用。
*   如果中值是`floor(n/2)`，则重复值正好是中值。所以你继续数组的右半部分。
*   否则，如果不是这样，则将重复值留给中位数。所以你继续数组的左半部分。
*   你递归地继续这种方式。

例如：

*   什么时候`A={2, 3, 6, 1, 5, 4, 0, 3, 5}` `n=9`，那么中位数应该是值`4`。
*   第一次调用后`SELECT`
*   `A={3, 2, 0, 1, <3>, 4, 5, 6, 5}`中值小于`4`所以我们继续左半部分。
*   `A={3, 2, 0, 1, 3}`
*   第二次调用后`SELECT`
*   `A={1, 0, <2>, 3, 3}`那么中位数应该是`2`，所以我们继续右半部分。
*   `A={3, 3}`， 成立。

该算法在`O(n+n/2+n/4+...)=O(n)`.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-17T09:06:33.153

这个怎么样：

```
for (i=0; i<n-1; i++) {
  for (j=i+1; j<n; j++) {
    if (a[i] == a[j]) {
        printf("%d appears more than once\n",a[i]);
        break;
    }
  }
} 
```

当然它不是最快的，但它简单易懂，并且不需要额外的内存。如果 n 是像 9 或 100 这样的小数，那么它很可能是“最好的”。（即“最佳”可能意味着不同的东西：执行速度最快、内存占用最小、可维护性最强、开发成本最低等。）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-17T07:01:35.900

对于每个数字：检查它是否存在于数组的其余部分中。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-17T07:06:08.463

如果不进行排序，您将跟踪您已经访问过的数字。

在伪代码中，这基本上是（这样做，所以我不只是给你答案）：

```
for each number in the list
   if number not already in unique numbers list
      add it to the unique numbers list
   else
      return that number as it is a duplicate
   end if
end for each 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-11-10T09:59:51.277

我写了一个小程序来找出不重复的元素数量，只要通过这个让我知道你的意见，目前我假设偶数元素是偶数，但也可以很容易地扩展到奇数。

所以我的想法是先对数字进行排序，然后应用我的算法。快速排序可用于对这些元素进行排序。

让我们采用如下输入数组

```
int arr[] = {1,1,2,10,3,3,4,5,5,6,6}; 
```

数字 2,10 和 4 不重复，但它们是按排序顺序排列的，如果没有排序，请使用快速排序先排序。

让我们将我的程序应用于此

```
using namespace std;

main()
{
    //int arr[] = {2, 9, 6, 1, 1, 4, 2, 3, 5};
    int arr[] = {1,1,2,10,3,3,4,5,5,6,6};

    int i = 0;

    vector<int> vec;

    int var = arr[0];
    for(i = 1 ; i < sizeof(arr)/sizeof(arr[0]); i += 2)
    {
            var = var ^ arr[i];

            if(var != 0 )
            {
                //put in vector
                var = arr[i-1];
                vec.push_back(var);
                i = i-1;
            }
            var = arr[i+1];
    }

    for(int i = 0 ; i < vec.size() ; i++)
        printf("value not repeated = %d\n",vec[i]);

} 
```

这给出了输出：

```
value not repeated= 2

value not repeated= 10

value not repeated= 4 
```

它简单而直接，只需使用 XOR 人。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-05-12T16:41:29.427

在 c 中：

```
 int arr[] = {2, 3, 6, 1, 5, 4, 0, 3, 5};

    int num = 0, i;

    for (i=0; i < 8; i++)
         num = num ^ arr[i] ^i; 
```

由于`x^x=0`，重复奇数次的数字被中和。让我们称唯一的数字 a 和 b。我们剩下`a^b`。我们知道`a^b != 0`，自从`a != b`。选择 的任何 1 位`a^b`，并将其用作掩码，即选择 x 作为 2 的幂，因此它`x & (a^b)`是非零的。

现在将列表分成两个子列表——一个子列表包含所有数字 y 和`y&x == 0`，其余的进入另一个子列表。通过我们选择 x 的方式，我们知道 a 和 b 的对在不同的桶中。所以我们现在可以将上面使用的相同方法独立地应用于每个桶，并发现 a 和 b 是什么。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-11-04T09:40:51.677

```
for(i=1;i<=n;i++) {
  if(!(arr[i] ^ arr[i+1]))
        printf("Found Repeated number %5d",arr[i]);
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-06-27T05:41:58.420

好吧，使用嵌套的 for 循环并假设问题是找到数组中仅出现两次的数字。

```
def repeated(ar,n):
    count=0
    for i in range(n):
        for j in range(i+1,n):
            if ar[i] == ar[j]:
                count+=1
        if count == 1:
            count=0
            print("repeated:",ar[i])    

arr= [2, 3, 6, 1, 5, 4, 0, 3, 5]
n = len(arr)
repeated(arr,n) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-01-31T02:21:13.817

使用[https://en.wikipedia.org/wiki/HyperLogLog](https://en.wikipedia.org/wiki/HyperLogLog)怎么样？

Redis 做[http://redis.io/topics/data-types-intro#hyperloglogs](http://redis.io/topics/data-types-intro#hyperloglogs)

> HyperLogLog 是一种概率数据结构，用于对独特事物进行计数（从技术上讲，这称为估计集合的基数）。通常计算唯一项目需要使用与您要计算的项目数量成比例的内存量，因为您需要记住过去已经看到的元素以避免多次计算它们。但是，有一组算法可以用内存来换取精度：在 Redis 实现的情况下，您会得到一个具有标准误差的估计测量值，该误差小于 1%。该算法的神奇之处在于您不再需要使用与计数的项目数成正比的内存量，而是可以使用恒定量的内存！最坏情况下为 12k 字节，如果您的 HyperLogLog（我们的

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2010-06-14T15:27:19.403

我们为什么要尝试做数学（特别是解决二次方程）这些都是昂贵的操作。解决这个问题的最好方法是构造一个大小为 (n-3) bits 的位图，即 (n -3 ) +7 / 8 bytes 。最好为这个内存做一个 calloc，这样每一位都会被初始化为 0。然后遍历列表并在遇到时将特定位设置为 1，如果该位已经设置为 1 表示 no ，那么这就是重复的 no 。这可以扩展以找出数组中是否缺少任何 no。该解决方案的时间复杂度为 O(n)

# c# - 如何获取字典的所有值 作为 IList ?

> ID：555750
> 
> 赞同：69
> 
> 时间：2009-02-17T07:01:11.597
> 
> 标签：c#, .net-3.5, dictionary, ilist

我有以下字典：

```
IDictionary<int, IList<MyClass>> myDictionary 
```

我想将字典中的所有值作为 IList....

* * *

只是为了添加一点背景知识，说明我是如何陷入这种境地的……

我有一个方法可以让我获得 MyClass 的列表。然后我有另一种方法将该列表转换为字典，其中键是 MyClass 的 id。稍后...并且无法访问该原始列表...我需要获取 MyClass 的原始未分组列表。

* * *

当我将 myDictionary.Values.ToList() 传递给采用 IList 的方法时，我收到一个编译错误，指出它无法从

```
System.Collections.Generic.List<System.Collections.Generic.IList<MyClass>> 
```

到：

```
System.Collections.Generic.IList<MyClass> 
```

现在，我可以理解它已经消失并将 IList 的每个组作为列表的单独元素添加到新列表中......但在这种情况下，它并不是我真正想要的。我只想要整个字典中所有值的列表。

那么如何在不遍历字典中的每个键值并创建我想要的列表的情况下获得我想要的东西呢？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2015-11-10T15:16:17.573

注意到很多答案都很老了。

这也将起作用：

```
using System.Linq;

dict.Values.ToList(); 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-02-17T07:18:05.347

由于字典（或哈希表）的维护方式，这就是您要做的。在内部，实现包含键、桶（用于冲突处理）和值。您可能能够检索内部值列表，但您最好使用以下内容：

```
IDictionary<int, IList<MyClass>> dict;
var flattenList = dict.SelectMany( x => x.Value ); 
```

它应该可以解决问题；） SelectMany 使结果变平，这意味着每个列表都连接成一个长序列（IEnumerable`1）。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-17T07:24:10.857

约翰建议的变体：

```
var flattenedValues = dict.Values.SelectMany(x => x); 
```

如果你需要它们在一个列表中，你当然可以调用 ToList：

```
var flattenedList = dict.Values.SelectMany(x => x).ToList(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-12T21:53:09.593

```
dictionary.values.toList(); 
```

如果你想得到 Sum 就做

```
myDictionary.values.sum(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T07:22:26.147

[`Values`](http://msdn.microsoft.com/en-us/library/0yxt5h4s.aspx)获取[`ICollection`](http://msdn.microsoft.com/en-us/library/92t2ye13.aspx)包含字典值的 a。正如您的字典的定义所暗示的那样，它可以定义为一个`ICollection<IList<MyClass>>`集合。因此，如果您真的想要一个`IList<IList<MyClass>>`，请使用[spacedog](https://stackoverflow.com/questions/555750/how-do-i-get-all-the-values-of-a-dictionarytkey-tvalue-as-an-ilisttvalue/555761#555761)的解决方案。

如果您真正想要的是一个扁平的“IList”，那么除了遍历每个值之外没有其他解决方案：

```
IList<MyClass> l=new List<MyClass>();
foreach (IList<MyClass> v in myDictionary.Values)
    l.AddRange(v); 
```

请注意，这是非常低效的，您应该再次考虑使用字典来实现您想要实现的目标。

# c# - c#：使用任何字符执行 sql LIKE 搜索的正确方法是什么

> ID：555752
> 
> 赞同：0
> 
> 时间：2009-02-17T07:01:41.580
> 
> 标签：c#, sql

我正在使用 LIKE %somestring% 条件即时构建（c#）sql select 命令字符串。在我的搜索字符串中，我希望能够处理在标准 PC（美国）键盘上找到的任何字符（包括 ~ ! @ # % 等，不需要 alt 特殊字符，但最好有）。我知道单引号需要加倍，也许双引号也是如此。可能需要哪些其他字符串修复来确保语法正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T07:14:06.543

无需修复：

```
SqlCommand cmd = new SqlCommand("select * from Foo where Bar like @p", connection);

SqlParameter p  = new SqlParameter();
param.ParameterName = "@p";
param.Value = pattern;

cmd.Parameters.Add(param); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T10:42:45.823

除了将单引号加倍（或使用参数化查询）之外，用户是否会知道“_”和“%”是通配符（分别是任意字符和零个或多个任意字符），而“[. ..]" 创建一个闭包？

为了逃避这些字符，有两条路线

```
WHERE Foo LIKE '%xxx\%yyy%' ESCAPE '\' 
```

或 WHERE Foo LIKE '%xxx[%]yyy%'

第二个使用创建闭包的副作用，并避免使用 ESCAPE （它本身需要考虑选择一个与字符串的其余部分不冲突的字符，或者在它出现的地方本身被转义）

请注意，使用 'LIKE %somestring%' 通常需要进行表扫描，因此可能会导致性能问题 - 例如，如果您要检查数百万行。

在 SQL Server 中，如果您通过字符串连接生成 WHERE 子句，则可以使用 sp_ExecuteSQL - 这样仅包含用户指定条件的字段。sp_ExecuteSQL 将缓存查询并在大多数情况下提高性能。（请询问它是否相关并且您需要帮助）

# css - 像这样 style.css 放置的 CSS 链接的目的是什么？23409823098

> ID：555760
> 
> 赞同：0
> 
> 时间：2009-02-17T07:05:24.457
> 
> 标签：css

[与 css 链接中的操作](https://stackoverflow.com/questions/438821/what-does-do-in-a-css-link)重复

我见过一些网站列出了其中包含参数的样式表。有谁知道它叫什么以及它们服务的目的是什么？

前任：

href="fonts.css?1169659562000"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T07:09:12.343

每次文件内容更改时，该参数都会更改。这允许站点主机设置无限缓存超时，从而防止浏览器重新请求 CSS。如果没有该参数，更新将永远不会到达客户端。

另请参阅[Stackoverflow Podcast #38](https://blog.stackoverflow.com/2009/01/podcast-38/)和[YSlow 工具](http://developer.yahoo.com/yslow/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T07:07:23.843

强制浏览器刷新 CSS 链接。它比过期标题等更可靠。

# architecture - 错误报告工具/服务

> ID：555770
> 
> 赞同：0
> 
> 时间：2009-02-17T07:11:24.973
> 
> 标签：architecture

我想知道是否有任何工具可以轻松集成到我现有的应用程序基础架构中并处理错误报告。一种服务。

它应该允许我（作为应用程序开发人员）向其中发送未处理的错误..例如使用网络服务等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T07:51:15.407

看看[SmartInspect](http://www.gurock.com/products/smartinspect/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T07:55:33.323

不知何故，提到的工具都没有满足我的要求。

我找到了一个最符合要求的..虽然它可能需要更多的补充。（它的开源所以很棒）

*   [埃尔玛](http://code.google.com/p/elmah/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T08:25:16.933

您应该寻找带有 Web 服务接口的[错误/问题跟踪系统。](http://en.wikipedia.org/wiki/Comparison_of_issue_tracking_systems)例如，[Bugzilla](http://www.bugzilla.org)非常受欢迎。它有一个[xml-rpc 接口](http://www.bugzilla.org/docs/3.0/html/api/Bugzilla/WebService.html)和一些语言的客户端库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T07:19:35.220

为了全局捕获错误，您必须拥有某种特定于应用程序的处理机制。

对于其他一切，请使用[log4net](http://logging.apache.org/log4net/index.html)之类的日志框架，它可以记录到 Windows 事件日志（可以[通过 WMI 远程监控](http://www.c-sharpcorner.com/UploadFile/mgold/MonitoringRemoteLogusingWMI11232005020152AM/MonitoringRemoteLogusingWMI.aspx)）或远程 Syslog 服务器（根据定义是集中的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:24:25.750

我希望[Microsoft Enterprise Library](http://msdn.microsoft.com/en-us/library/cc467894.aspx)对您有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-01T10:52:01.913

我们创建了这样的服务“BugsVoice”，也受到您的问题的启发：

[http://bugsvoice.com](http://bugsvoice.com)

# wcf - WCF 自定义绑定 - 始终达到发送超时

> ID：555773
> 
> 赞同：1
> 
> 时间：2009-02-17T07:13:41.160
> 
> 标签：wcf, binding, wcf-security

我有一个需要实现回调并托管在 IIS 6.0 上的 wcf 服务。由于 IIS 6.0 不支持 net.tcp 绑定，我决定使用自定义绑定，因为该服务由不同时区的不同客户端访问，并且使用自定义绑定，我可以将允许的时钟偏移时间设置为除默认一个。

这是我的服务器配置文件：

```
<bindings>
  <customBinding>        
    <binding name="pscNetBinding" openTimeout="00:10:00">          
      <reliableSession acknowledgementInterval="00:00:00.2000000"
  flowControlEnabled="true" inactivityTimeout="23:59:59"
  maxPendingChannels="128" maxRetryCount="8" maxTransferWindowSize="128"
  ordered="true" />
      <compositeDuplex />
      <oneWay maxAcceptedChannels="128" packetRoutable="false">
        <channelPoolSettings idleTimeout="00:10:00"
  leaseTimeout="00:10:00" maxOutboundChannelsPerEndpoint="10" />
      </oneWay>
      <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
  messageVersion="Default" writeEncoding="utf-8">
        <readerQuotas maxDepth="2147483647"
  maxStringContentLength="2147483647" maxArrayLength="2147483647"
  maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
      </textMessageEncoding>
      <httpTransport manualAddressing="false"
  maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647"
  allowCookies="false" authenticationScheme="Anonymous"
  bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
  keepAliveEnabled="true" maxBufferSize="2147483647"
  proxyAuthenticationScheme="Anonymous" realm="" transferMode="Buffered"
  unsafeConnectionNtlmAuthentication="false" useDefaultWebProxy="true"/>
    </binding>
  </customBinding>
</bindings>

<services>
  <service name="SchneiderElectric.PSCNet.Server.Services.PSCNetWCFService" behaviorConfiguration="Behaviors1">
    <host>
      <baseAddresses>
        <add baseAddress ="http://10.155.18.18:2000/PSCNet"/>
      </baseAddresses>
    </host>
    <endpoint address="" binding="customBinding"    bindingConfiguration="pscNetBinding"
                                contract="SchneiderElectric.PSCNet.Server.Contracts.IPSCNetWCFService"/>
  </service>
</services>    
<behaviors>
  <serviceBehaviors>
    <behavior name="Behaviors1">
      <serviceMetadata httpGetEnabled = "true"/>
      <!--<serviceThrottling maxConcurrentCalls="2048" maxConcurrentSessions="2048" maxConcurrentInstances="2048" />
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />-->
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

客户端配置文件：

```
 <bindings>
    <customBinding>
      <binding name="pscNetBinding" openTimeout="00:10:00">            
        <reliableSession acknowledgementInterval="00:00:00.2000000"
    flowControlEnabled="true" inactivityTimeout="23:59:59"
    maxPendingChannels="128" maxRetryCount="8" maxTransferWindowSize="128"
    ordered="true" />
        <compositeDuplex />
        <oneWay maxAcceptedChannels="128" packetRoutable="false">
          <channelPoolSettings idleTimeout="00:10:00"
    leaseTimeout="00:10:00" maxOutboundChannelsPerEndpoint="10" />
        </oneWay>
        <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
    messageVersion="Default" writeEncoding="utf-8" >
          <readerQuotas maxDepth="2147483647"
    maxStringContentLength="2147483647" maxArrayLength="2147483647"
    maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
        </textMessageEncoding >
        <httpTransport manualAddressing="false"
    maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647"
    allowCookies="false" authenticationScheme="Anonymous"
    bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
    keepAliveEnabled="true" maxBufferSize="2147483647"
    proxyAuthenticationScheme="Anonymous" realm="" transferMode="Buffered"
    unsafeConnectionNtlmAuthentication="false" useDefaultWebProxy="true" />                    
      </binding>
    </customBinding>
  </bindings>
  <client>
    <endpoint address="http://10.155.18.18:2000/PSCNet" binding="customBinding"
        bindingConfiguration="pscNetBinding" contract="PSCNetWCFService.IPSCNetWCFService"
        name="pscNetBinding" />
  </client> 
```

如果我在同一台机器上使用服务器和客户端，一切正常。如果我在不同的机器上运行它们，我会收到以下错误：

> 无法连接到 [http://10.155.18.198:9000/e60ba5b3-f979-4922-b9f8-c820caaa04c2](http://10.155.18.198:9000/e60ba5b3-f979-4922-b9f8-c820caaa04c2)。TCP错误码10060：连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应10.155.18.198:9000。

社区中的任何人都可以在这方面帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T04:03:13.323

你能显示你定义customBinding的配置部分吗？也许您只是没有粘贴该部分，但是当您定义自定义绑定时，您必须至少指定编码和传输 - 如下所示：

```
<bindings>
    <customBinding>
        <binding name="MyCustomTextTcpBinding">
            <textMessageEncoding />
            <tcpTransport />
        </binding>
    </customBinding>
</bindings> 
```

您还可以粘贴您定义“pscNetBinding”绑定配置的部分吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-26T20:25:59.740

Windows 服务无疑是一个不错的解决方案，但我认为更好的是自托管，您可以对其进行任何类型的绑定。

# c++ - 协调类、继承和 C 回调

> ID：555774
> 
> 赞同：2
> 
> 时间：2009-02-17T07:13:51.147
> 
> 标签：c++, c, oop

在我的 C++ 项目中，我选择使用 C 库。由于我热衷于拥有一个抽象而简单的设计，我最终做了一些杂乱无章的事情。我的设计要求的一部分是我可以轻松地为给定任务支持多个 API 和库（主要是由于我对跨平台支持的要求）。因此，我选择创建一个抽象基类，它可以统一处理给定的库选择。

考虑一下我的设计的这种简化：

```
class BaseClass
{
public:
    BaseClass() {}
    ~BaseClass() {}

    bool init() { return doInit(); }
    bool run() { return doWork(); }
    void shutdown() { destroy(); }
private:
    virtual bool doInit() = 0;
    virtual bool doWork() = 0;
    virtual void destroy() = 0;
}; 
```

还有一个继承自它的类：

```
class LibrarySupportClass : public BaseClass
{
public:
    LibrarySupportClass()
        : BaseClass(), state_manager(new SomeOtherClass()) {}

    int callbackA(int a, int b);
private:
    virtual bool doInit();
    virtual bool doWork();
    virtual void destroy();

    SomeOtherClass* state_manager;
};

// LSC.cpp:

bool LibrarySupportClass::doInit()
{
    if (!libraryInit()) return false;

    // the issue is that I can't do this:
    libraryCallbackA(&LibrarySupportClass::callbackA);

    return true;
}
// ... and so on 
```

我遇到的问题是，因为这是一个 C 库，所以我需要提供 form 的 C 兼容回调`int (*)(int, int)`，但该库不支持这些回调的额外 userdata 指针。我**更喜欢**在类中执行所有这些回调，因为该类带有一个状态对象。

我最终做的是...

```
static LibrarySupportClass* _inst_ptr = NULL;
static int callbackADispatch(int a, int b)
{
    _inst_ptr->callbackA(a, b);
}

bool LibrarySupportClass::doInit()
{
    _inst_ptr = this;

    if (!libraryInit()) return false;

    // the issue is that I can't do this:
    libraryCallbackA(&callbackADispatch);

    return true;
} 
```

如果多次实例化 LibrarySupportClass，这显然会做坏事（TM），所以我考虑使用单例设计，但出于这个原因，我不能证明这种选择是正确的。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T07:18:46.750

您可以证明该选择是合理的：您的理由是 C 库仅支持一个回调实例。

> 单例让我害怕：不清楚如何正确地销毁单例，而继承只会使事情复杂化。我将再看看这种方法。

这就是我的做法。

**图书馆支持类.h**

```
class LibrarySupportClass : public BaseClass
{
public:
    LibrarySupportClass();
    ~LibrarySupportClass();
    static int static_callbackA(int a, int b);
    int callbackA(int a, int b);
private:
    //copy and assignment are rivate and not implemented
    LibrarySupportClass(const LibrarySupportClass&);
    LibrarySupportClass& operator=(const LibrarySupportClass&);
private:
    static LibrarySupportClass* singleton_instance;
}; 
```

**图书馆支持类.cpp**

```
LibrarySupportClass* LibrarySupportClass::singleton_instance = 0;

int LibrarySupportClass::static_callbackA(int a, int b)
{
  if (!singleton_instance)
  {
    WHAT? unexpected callback while no instance exists
  }
  else
  {
    return singleton_instance->callback(a, b);
  }
}

LibrarySupportClass::LibrarySupportClass()
{
  if (singleton_instance)
  {
    WHAT? unexpected creation of a second concurrent instance
    throw some kind of exception here
  }
  singleton_instance = this;
}

LibrarySupportClass::~LibrarySupportClass()
{
  singleton_instance = 0;
} 
```

* * *

我的观点是，你不需要给它一个规范的“单例”的外部接口（例如，这使得它难以销毁）。

相反，它只有一个的事实可以是私有实现细节，并由私有实现细节强制执行（例如，通过构造函数中的 throw 语句）......假设应用程序代码已经这样，它不会尝试创建该类的多个实例。

拥有这样的 API（而不是更规范的“单例”API）意味着您可以例如在堆栈上创建此类的实例（前提是您不尝试创建多个实例） .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T07:56:53.320

c 库的外部约束规定，当你的回调被调用时，你没有回调的“拥有”实例的标识。因此，我认为您的方法是正确的。

我建议将 callbackDispatch 方法声明为类的静态成员，并使类本身成为单例（有很多关于如何实现单例的示例）。这将允许您为其他库实现类似的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T08:11:06.093

Dani 在答案上击败了我，但另一个想法是您可以拥有一个消息传递系统，其中回调函数将结果分派给您的类的所有或部分实例。如果没有明确的方法来确定哪个实例应该得到结果，那么就让那些不需要它的实例忽略结果。

当然，如果您有很多实例，这会带来性能问题，并且您必须遍历整个列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T08:33:19.923

我看到的问题是，因为你的方法不是静态的，你很容易在一个不应该有的函数中拥有一个内部状态，因为顶部有一个实例文件，可以在调用之间结转，这是一件非常糟糕的事情（tm）。至少，正如 Dani 上面所建议的那样，无论您从 C 回调中调用的任何方法都必须是静态的，这样您才能保证调用回调时不会留下任何残留状态。

以上假设您已`static LibrarySupportClass* _inst_ptr`在最顶部声明​​。作为替代方案，请考虑使用工厂功能，该功能`LibrarySupportClass`将从池中按需创建工作副本。这些副本可以在您完成后返回到池中并被回收，这样您就不必在每次需要该功能时都创建实例。

这样，您可以让您的对象在单个回调调用期间保持状态，因为将有一个明确的点，您的实例被释放并获得绿灯以供重用。对于多线程环境，您也将处于更好的位置，在这种情况下，每个线程都有自己的`LibrarySupportClass`实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T07:37:47.017

> 我遇到的问题是，因为这是一个 C 库，我需要提供 int (*)(int, int) 形式的 C 兼容回调，但该库不支持额外的用户数据这些回调的指针

你能详细说明吗？根据用户数据选择回调类型有问题吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T15:17:56.083

您的回调可以选择基于`a`和/或的实例`b`吗？如果是这样，则在全局/静态映射中注册您的库支持类，然后在映射中`callbackADispatch()`查找正确的实例。

使用互斥锁序列化对映射的访问将是使此线程安全的合理方法，但请注意：如果库在调用回调时持有任何锁，那么您可能需要做一些更聪明的事情来避免死锁，具体取决于你的锁层次结构。

# vba - 使用 Excel VBA 列出特定模式的文件

> ID：555776
> 
> 赞同：1
> 
> 时间：2009-02-17T07:14:16.323
> 
> 标签：vba, excel, file-listing

如何列出用户指定目录中与特定模式匹配的所有文件？这应该在所选目录的子文件夹中递归地工作。我还需要一种方便的方式（如树控件）来列出它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-15T03:14:15.427

似乎有几个答案是关于递归的，一个是关于正则表达式的。这是一些将两个主题放在一起的代码。我从[http://vba-tutorial.com获取了代码](http://vba-tutorial.com)

```
Sub FindPatternMatchedFiles()

    Dim objFSO As Object
    Set objFSO = CreateObject("Scripting.FileSystemObject")

    Dim objRegExp As Object
    Set objRegExp = CreateObject("VBScript.RegExp")
    objRegExp.pattern = ".*xlsx"
    objRegExp.IgnoreCase = True

    Dim colFiles As Collection
    Set colFiles = New Collection

    RecursiveFileSearch "C:\Path\To\Your\Directory", objRegExp, colFiles, objFSO

    For Each f In colFiles
        Debug.Print (f)
        'Insert code here to do something with the matched files
    Next

    'Garbage Collection
    Set objFSO = Nothing
    Set objRegExp = Nothing

End Sub

Sub RecursiveFileSearch(ByVal targetFolder As String, ByRef objRegExp As Object, _
                ByRef matchedFiles As Collection, ByRef objFSO As Object)

    Dim objFolder As Object
    Dim objFile As Object
    Dim objSubFolders As Object

    'Get the folder object associated with the target directory
    Set objFolder = objFSO.GetFolder(targetFolder)

    'Loop through the files current folder
    For Each objFile In objFolder.files
        If objRegExp.test(objFile) Then
            matchedFiles.Add (objFile)
        End If
    Next

    'Loop through the each of the sub folders recursively
    Set objSubFolders = objFolder.Subfolders
    For Each objSubfolder In objSubFolders
        RecursiveFileSearch objSubfolder, objRegExp, matchedFiles, objFSO
    Next

    'Garbage Collection
    Set objFolder = Nothing
    Set objFile = Nothing
    Set objSubFolders = Nothing

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T08:48:54.053

尝试 Windows 脚本 - 文件系统对象。这个可以从 vba 创建的 COM 对象具有列出目录等功能。

[您可以在MSDN](http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx)上找到文档

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-30T02:59:13.620

我看到我上面的人已经回答了如何通过文件树递归，这可能会让您对搜索文件/文件名中的模式感兴趣。这是一个允许使用正则表达式的 VBA 函数。

```
Private Function RegularExpression(SearchString As String, Pattern As String) As String

    Dim RE As Object, REMatches As Object

    'Create the regex object' 
    Set RE = CreateObject("vbscript.regexp")
    With RE
        .MultiLine = False
        .Global = False
        .IgnoreCase = True
        'set the search pattern using parameter Pattern'
        .Pattern = Pattern 
    End With

    'Search for the pattern' 
    Set REMatches = RE.Execute(SearchString) 
    If REMatches.Count > 0 Then
        'return the first match'
        RegularExpression = REMatches(0) 
    Else
        'nothing found, return empty string'
        RegularExpression = ""
    End If

End Function 
```

您可以使用它在文件名中搜索模式。我建议使用[正则表达式主页](http://www.regular-expressions.info)以获取有关如何使用正则表达式的更多信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T08:15:34.587

作为一般指针，请查看 Application.FileSearch、递归函数、用户窗体和“Microsoft TreeView 控件”。

FileSearch 可用于在与模式匹配的文件夹中查找文件，递归函数可以调用自身，直到所有路径都用尽，UserForm 可以托管用于显示数据的控件，TreeView 控件可以显示您的文件系统。

请记住，有可用于显示文件系统的预构建函数/控件，例如 Application.GetOpenFileName、Application.GetSaveAsFileName、Microsoft WebBrowser（给定一个 'file://...' URL）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-08T17:32:07.807

不完全是你要求的，但我想我会在这里发布它，因为它是相关的。

这是根据[http://www.cpearson.com/excel/FOLDERTREEVIEW.ASPX上的代码修改的](http://www.cpearson.com/excel/FOLDERTREEVIEW.ASPX)

这需要参考**Microsoft Scripting Runtime**。

```
Sub ListFilePaths()

    Dim Path As String
    Dim Files As Long

    Path = "C:\Folder"

    Files = GetFilePaths(Path, "A", 1)

    MsgBox "Found " & Files - 1 & " Files"

End Sub

Function GetFilePaths(Path As String, Column As String, StartRow As Long) As Long

    Dim Folder As Scripting.Folder
    Dim SubFolder As Scripting.Folder
    Dim File As Scripting.File
    Dim FSO As Scripting.FileSystemObject
    Dim CurrentRow As Long

    Set FSO = New Scripting.FileSystemObject
    Set Folder = FSO.GetFolder(folderpath:=Path)

    CurrentRow = StartRow

    For Each File In Folder.Files
        Range(Column & CurrentRow).Value = File.Path
        CurrentRow = CurrentRow + 1
    Next File

    For Each SubFolder In Folder.SubFolders
        CurrentRow = GetFilePaths(SubFolder.Path, Column, CurrentRow)
    Next SubFolder

    GetFilePaths = CurrentRow

    Set Folder = Nothing
    Set FSO = Nothing
End Function 
```

# c# - .Net 等效于 ScaleHeight 和 Scalewidth

> ID：555793
> 
> 赞同：2
> 
> 时间：2009-02-17T07:24:49.777
> 
> 标签：c#, .net, gdi+, drawing, gdi

基本上我想做的是让我的绘画工作更容易。

早在 VB6 时代，就有一种叫做 Scalewidth 和 Scaleheight 的东西，我可以将它们设置为自定义值。前任。100。

然后，当我需要在可用空间的中心绘制一个点时，我会在 50,50 处绘制它。

.Net 中有什么方法可以让我获得类似的功能吗？

因此，无论我得到多大的绘图画布，我都可以使用绝对坐标在上面绘图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T08:10:09.310

我不知道是否有办法在 .NET 中实现这一点，但您可以自己轻松实现：

```
// Unscaled coordinates = x, y; canvas size = w, h;
// Scaled coordinates = sx, sy; Scalewidth, Scaleheight = sw, sh;
x = (sx / sw) * w;
y = (sy / sh) * h;

// Or the other way round
sx = (x / w) * sw;
sy = (y / h) * sh; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T13:43:23.803

首先，您为什么不使用[Graphics.ScaleTransform](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.scaletransform.aspx)而不是自己处理所有缩放？就像是：

```
e.Graphics.ScaleTransform( 
  100.0 / this.ClientSize.Width, 
  100.0 / this.ClientSize.Height ); 
```

你的代码最终会更清晰，我敢打赌这会更快一点。

其次，如果您坚持使用 cnvX/rcnvX 函数，请确保使用[this.ClientSize.Width](http://msdn.microsoft.com/en-us/library/9278sfx2.aspx)（高度也相同）而不是“this.Width”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T11:01:55.423

Schnaader 的想法是正确的……最终我实现了四个函数来做到这一点。功能如下

```
private float cnvX(double x)
{
    return (float)((Width / 100.00) * x);
}

private float rcnvX(double x)
{
    return (float)(x / Width) * 100;
}

private float rcnvY(double y)
{
    return (float)((y / Height) * 100);
}

private float cnvY(double y)
{
    return (float)((Height / 100.00) * y);
} 
```

# java - 关于在 Swing 应用程序中使用向导

> ID：555795
> 
> 赞同：0
> 
> 时间：2009-02-17T07:26:45.373
> 
> 标签：java, swing, wizard

我正在使用[此处](http://java.sun.com/developer/technicalArticles/GUI/swing/wizard/)给出的代码来创建我自己的向导应用程序。

从一个屏幕移动到另一个屏幕的基本动机就是这样实现的。但现在我被困在一个点上。问题是......假设我在screen1上输入了一些值，然后我移动到screen2 ..并且基于在screen1中输入的值我必须在屏幕2上显示一些值..我如何获得在screen1中设置的值在 screen2 中使用链接中给出的相同代码。

我试图详细研究代码，但无法理解，因为我对 Java 和 Swing 都很陌生。

如果有人已经使用相同的代码来实现向导，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T08:23:31.977

您应该将向导的状态存储在 中`WizardModel`，并适当地添加 getter 和 setter（即像 JavaBean）。例如：

```
public class WizardModel {
   ...
   private String host;

   public void setHost(String host) {
       this.host = host;
   }

   public String getHost() {
       return host;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T12:18:14.627

土豆头先生（？）是对的；模型是存储数据的地方。

例如，您可能希望查看[Freedom for Media in Java 的](http://fmj-sf.net/doc/fmj/index.html)示例代码，它似乎在 Documentation / Javadoc 部分的包 net.sf.fmj.ui.wizard 中实现了[WizardModel](http://fmj-sf.net/doc/fmj/net/sf/fmj/ui/wizard/package-summary.html)。

如果您希望获得更多 Swing 应用程序的示例以及布局精美的表单，请查看[JGoodies](http://www.jgoodies.com/)。即使您决定不使用他们的库，提供的示例也值得一读。

# c# - 这个编译器生成的枚举器是什么意思？

> ID：555796
> 
> 赞同：4
> 
> 时间：2009-02-17T07:26:58.650
> 
> 标签：c#, .net, compiler-construction, cil

我写了一个相当复杂的方法 yield-returns `IEnumerable<string>`，但是当我在 Reflector 中检查编译器输出时，我不明白编译器生成的实现的特定部分`IEnumerator`：

```
void IDisposable.Dispose()
{
    switch (this.<>1__state)
    {
        case 1:
        case 2:
        case 3:
            switch (this.<>1__state) // empty switch! why?!
            {
            }
            break;

        default:
            return;
            try   // What?! AFTER return?!
            {
            }
            finally // is the try-finally block anyhow relevant?
            {
                this.<>m__Finallya();
            }
            break;
    }
    this.<>m__Finally7();
} 
```

我猜测（或希望）Reflector 放错了外部的右大括号`switch`，并且它应该直接在`return`. 不过，我不明白为什么在案例 3 中有一个空开关，或者为什么在一个块`m__Finallya`中被调用。`finally`（正常运行和在块内运行之间是否存在语义差异`finally`？除了 CER，我的代码中没有。）

作为参考，这里是 IL：

```
.method private hidebysig newslot virtual final 
        instance void  System.IDisposable.Dispose() cil managed
{
  .override [mscorlib]System.IDisposable::Dispose
  // Code size       69 (0x45)
  .maxstack  2
  .locals init ([0] int32 CS$0$0000,
           [1] int32 CS$0$0001)
  IL_0000:  ldarg.0
  IL_0001:  ldfld      int32 FBD.TIP.Reader.MissingMessagesReader/'<GetMissingMessages>d__0'::'<>1__state'
  IL_0006:  stloc.0
  IL_0007:  ldloc.0
  IL_0008:  ldc.i4.1
  IL_0009:  sub
  IL_000a:  switch     ( 
                        IL_001c,
                        IL_001c,
                        IL_001c)
  IL_001b:  ret
  IL_001c:  ldarg.0
  IL_001d:  ldfld      int32 FBD.TIP.Reader.MissingMessagesReader/'<GetMissingMessages>d__0'::'<>1__state'
  IL_0022:  stloc.1
  IL_0023:  ldloc.1
  IL_0024:  ldc.i4.2
  IL_0025:  sub
  IL_0026:  switch     ( 
                        IL_0035,
                        IL_0035)
  IL_0033:  br.s       IL_003e
  .try
  {
    IL_0035:  leave.s    IL_003e
  }  // end .try
  finally
  {
    IL_0037:  ldarg.0
    IL_0038:  call       instance void FBD.TIP.Reader.MissingMessagesReader/'<GetMissingMessages>d__0'::'<>m__Finallya'()
    IL_003d:  endfinally
  }  // end handler
  IL_003e:  ldarg.0
  IL_003f:  call       instance void FBD.TIP.Reader.MissingMessagesReader/'<GetMissingMessages>d__0'::'<>m__Finally7'()
  IL_0044:  ret
} // end of method '<GetMissingMessages>d__0'::System.IDisposable.Dispose 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T07:48:31.217

你还没有展示你的原始迭代器块是什么样子，但我对反射器和编译器生成的代码的经验是，它并不总是能够完全准确地反编译，因为编译器使用了一些没有等效的 IL C＃。

我有[一篇关于迭代器块实现](http://csharpindepth.com/Articles/Chapter11/StreamingAndIterators.aspx)的文章，它可能会对你有所帮助，但我不会太担心编译后的代码是什么样子。在某些情况下，C# 编译器几乎肯定会生成不必要的代码，因为这会使编译器更简单。迭代器块必须非常棘手（它可能会变得非常复杂，使用 finally 块和迭代器处理）所以我认为信任 JIT 来优化生成代码中不必要的位（如 switch/case）是合理的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T07:46:17.790

这只是反射器努力跟上已生成的 IL（因为迭代器块不必与“正常”C# 相关，只要它们是有效的 IL）。特别`ret`是在`finally`块之后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T07:35:48.517

我可以说 C# 编译器很愚蠢，（它可能有点愚蠢）。也很可能这段代码在被运行时处理时看起来非常不同（所有讨厌的垃圾都被省略了）。

无论如何，您可能熟悉状态机？当你用 C# 编写生成器（yield stuff）时，你告诉编译器发出一个匿名类型，它将这个生成器实现为状态机。这是一种很好的形式化方法，可以验证。这可能就是它看起来如此的原因。

# file-io - 将 MemoryStream 转换为 FileStream 会创建数百个相同的文件？

> ID：555799
> 
> 赞同：2
> 
> 时间：2009-02-17T07:28:14.153
> 
> 标签：file-io, filestream, memorystream

我正在访问一个返回 pdf 文件作为响应的 httpwebrequest。我正在将该响应读入内存流，然后再转换为文件。问题是，正在创建数百个文件。不知道为什么，我尝试了很多方法，并且都做了同样的事情......这是第一个返回内存流的方法。

```
 MemoryStream memStream = new MemoryStream();
        byte[] buffer = new byte[2048];

        int bytesRead = 0;
        do
        {
            bytesRead = _ResponseStream.Read(buffer, 0, buffer.Length);
            memStream.Write(buffer, 0, bytesRead);
        } while (bytesRead != 0); 
```

其次要转换为 FileStream ...

```
 byte[] data = stream.ToArray();

            FileStream fs = new FileStream(newFile, FileMode.CreateNew);
            fs.Write(data, 0, data.Length); 
```

有任何想法吗？

**编辑以添加更多代码...**

```
 public MemoryStream GetToStream()
    {
        if (_Req == null)
            throw new Exception("HttpWebRequest is not initialised");

        GetResult(_Req);

        MemoryStream memStream = new MemoryStream();
        byte[] buffer = new byte[2048];

        int bytesRead = 0;
        do
        {
            bytesRead = _ResponseStream.Read(buffer, 0, buffer.Length);
            memStream.Write(buffer, 0, bytesRead);
        } while (bytesRead != 0);

        _ResponseStream.Close();

        if (memStream.Length > 0)
            return memStream;
        else return null;
    } 
```

newFile 是要创建的文件的服务器的映射路径。

```
 byte[] data = stream.ToArray();

            FileStream fs = new FileStream(newFile, FileMode.Create);
            fs.Write(data, 0, data.Length);
            fs.Close(); 
```

我试过stream.WriteTo(fs)，同样的事情发生了。相当离奇。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-17T07:39:17.730

完全不清楚为什么你会得到多个文件，但你应该能够根据文件名获得*一些*信息——每个文件都对应一个`newFile`.

顺便说一句，我注意到您没有关闭文件流。使用[`File.WriteAllBytes`](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)是实现目标的一种更简单的方法，并且不需要您关闭任何东西：

```
byte[] data = stream.ToArray();
File.WriteAllBytes(newFile, data); 
```

另一种方法是仍然使用 a `FileStream`(with a `using`statement)，但使用它[`MemoryStream.WriteTo`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.writeto.aspx)来避免`ToArray`必须复制所有数据的调用：

```
using (FileStream fs = File.Create(newFile))
{
    stream.WriteTo(fs);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T07:36:16.490

我建议您从客户那里收到的请求比您想象的要多。检查您的网络服务器访问日志文件。您显示的代码片段看起来很合理，但并没有真正显示足够的代码来解释问题 - 您没有显示代码的正确部分。无论如何，检查访问日志或使用某种跟踪。

# language-agnostic - 在任何编程语言中是否存在应该（或其他情态动词）结构？

> ID：555802
> 
> 赞同：4
> 
> 时间：2009-02-17T07:31:56.327
> 
> 标签：language-agnostic, computer-science

据我所知，我从来没有遇到过计算机语言中的*SHOULD*构造，但话说回来，与那里的数百种语言相比，我不知道那么多语言。

无论如何，*应该*和其他情态动词在自然语言中非常常见，在编写文档和具有法律约束力的合同时它们的含义非常清楚，因此它们并不是真正的灰色术语，理论上可以用编程术语来表达（我猜）。

例如*ASSERT*，在某种意义上支持*MUST*构造。

有没有这类事情的实际例子？有没有关于它的研究？我猜测一些基于规则的系统，也许模糊逻辑算法就是这样工作的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T07:41:48.520

我认为`try`是“应该”和`catch`“`finally`以防万一”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T08:29:35.690

*should*在自然语言中的确切含义也不明确。当您说“轮子*应该*排成一行”时，这到底是什么意思？*它可能与must*的含义相同，但在构造中没有任何意义。否则，您需要有多大的信心才能满足这一点？如果车轮不适合，该怎么办？

在您提到的意义上，有一些等价物，尽管我不知道使用“*应该*”这个词的语言：

## 测试/断言

`ASSERT`通常是语言指令、宏或测试库函数。在与*must*`ASSERT`相对应的意义上，一些语言和测试框架为“警告断言”定义了宏，如果检查失败但不会退出或测试失败，则会发出警告消息 - 这将对应于*should*。

 **## 异常处理

在某些方面，您可以将抛出的异常视为类似物 - 如果捕获到异常，程序可以处理某些不*应该*的情况。但有时异常描述了某些事情的失败，因为它*必须*是程序才能工作，在这种情况下，异常不会被捕获，或者处理程序会使程序优雅地失败。然而，情况并非总是如此 - 有时会执行代码来测试*可能*会或什至*不可能*会发生的事情，并且会捕获一个异常，期望它通常会被抛出。

## 约束逻辑

在各种正式的自然语言文档中， *must*和*should*的一个常见含义是关于约束 - *must*指定您始终必须满足的约束，如果不能，则您的状态不兼容，而*should*意味着您将始终满足约束*如果*给定状态和*must*隐含的约束是可能的，但*如果不可能*，那仍然有效。在非正式约束逻辑中，当上下文中存在“外部约束”时，就会发生这种情况——因此验证“解决方案”是否符合“*应该”*约束”可能只有在了解上下文的情况下才有可能，并且在给定上下文的情况下，您也可能能够满足“*应该*约束”的不同子集，但不能同时满足。因此，一些约束逻辑规范语言（无论您是称它们为“编程语言”取决于您的定义）具有约束排序的概念 - 第一级约束对应于*must*，下一级对应于*should*，并且如果可能，则必须满足约束条件给定外部的所有约束条件（在以前的级别中），即使这与下一个级别中的某些约束冲突，这些约束也不会得到满足。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T07:54:33.107

@Simon 也许 Try/finally 最接近应该。Try 中的任何内容都应该运行，但并非总是如此。Web 服务应该打开套接字，但如果没有，我们不在乎。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T08:14:25.460

这种模式在[RSpec](http://rspec.info/) - dsl 中用于以行为驱动的方式构建测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T11:38:58.247

像“应该”、“可能”、“可能”这样的情态动词可能会引起混淆，因此[RFC 2119](http://www.faqs.org/rfcs/rfc2119.html)给出了一个定义，将所有鼻子都指向同一个方向：

```
SHOULD   This word, or the adjective "RECOMMENDED", mean that there
may exist valid reasons in particular circumstances to ignore a
particular item, but the full implications must be understood and
carefully weighed before choosing a different course. 
```

从这个定义来看，它应该（不是双关语）清楚地表明它是用于规范，而不是程序代码，您希望事情具有确定性。至少*我*会。不过，我可以想象它可以在 AI 中使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T07:40:04.593

Well 应该可以在 prolog 类型语言中找到，作为更软的推论？即逻辑上的结果应该是 x 但可能不是。你可以说结果可能是 x 但不是很明确？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T08:18:23.173

如果结果不是它应该的，你期望程序的行为是什么？在 ASSERT 的情况下，它是一个异常（AssertException 或类似的）。程序应该抛出异常还是忽略结果？对我来说，两者之间似乎没有任何东西。结果要么被接受，要么不被接受。

否则，您应该指定您期望的行为。:-)

回到断言：如果断言失败，则抛出异常。这取决于你如何处理这个例外。例如，在 java/C# 中，您可以捕获它然后做任何您想做的事情，因此您可以定义断言是否具有 MUST 或 SHOULD 语义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T08:37:55.373

嗯，[Java2K](http://www.articleworld.org/index.php/Java2K)也有类似的概念。它应该做它被告知的......

信噪比。

# java - 实时Java图形/图表库？

> ID：555804
> 
> 赞同：29
> 
> 时间：2009-02-17T07:33:49.007
> 
> 标签：java, charts, graph, real-time

[在Java 图形或图表库](https://stackoverflow.com/questions/527640/java-graph-or-chart-library)上有一个较早的线程，发现 JFreeChart 非常好，**但是**，正如[其常见问题解答](http://www.jfree.org/jfreechart/faq.html#FAQ5)中所述，它不适合实时渲染。

谁能推荐一个支持实时渲染的类似库？只是一些基本的 xy 渲染 - 例如，从数据采集系统获取电压信号并在它出现时绘制它（x 轴上的时间，y 轴上的电压）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-17T08:10:01.040

常见问题解答实际上说的是 JFreeChart 不支持硬实时图表，这意味着图表不会在新数据到达时或之后的确定时间间隔更新。但是我发现 JFreeChart 可用于您所描述的那种应用程序。您可以实现每秒 1 次更新，这很好。我不认为人眼能比这更快地跟随一些东西。

如果你想要更多的东西，我怀疑你会在 Java（甚至是另一种语言）中找到任何东西。我们使用的操作系统并非设计为实时的。您不能保证他们会在事件发生后的最短时间间隔内做出响应。需要与硬件驱动程序紧密集成才能显示超过 1-10 帧/秒。

但是，如果您正确设计应用程序，操作系统会快速响应，并且您的应用程序可以轻松显示“实时”图形（即每秒更新一次的图形）。只是不要使用您的应用程序在紧急情况下关闭阀门！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-17T08:30:05.080

[http://www.live-graph.org/](http://www.live-graph.org/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-11-23T19:23:51.260

刚刚偶然发现有关如何使用[visualvm 图表库](http://java.dzone.com/news/real-time-charts-java-desktop)的描述。看起来很不错！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-17T07:55:12.497

看看[处理](http://processing.org/)——它是一个开源的、基于 java 的环境，专为各种动画可视化而设计。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-17T08:51:35.717

好吧，如果它必须是 Java，那么您可能想要研究这些。

*   [Java 实时系统](http://www.devx.com/Java/Article/35246/1954)（包括实时和非实时演示，以及图表应用程序的 JavaFX 版本）
*   [使用多核系统的实时 Java 应用程序开发](http://www.javaworld.com/javaworld/jw-04-2008/jw-04-realtime.html?page=3)
*   [加速实时任务图](http://www.alphaworks.ibm.com/tech/xrtgs?open&S_TACT=105AGX59&S_CMP=GRsite-jw64&ca=dgr-jw64awxrtgs)（该技术在 Linux 上运行，但可以在任何支持 Java 5.0 和 Eclipse 的平台上进行开发。）
*   [JavaFX - 饼图演示](http://learnjavafx.typepad.com/weblog/2009/01/javafx-pie-chart-in-jfxtras-project-thanks-ben-jones.html)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-12-08T23:56:02.773

您可能已经找到了一个很好的解决方案，但如果没有，我最近在一个框架上做了一些工作，用于生成 2D 图表，允许以每秒超过 50 次更改的速度进行实时更新。

最初的目的是在网页的滚动区域模仿图表记录器的外观，但我相信这种方法有更广泛的应用。

如果有人感兴趣，可以在[Chart Recorder Demo中找到演示。](http://www.journeylog.co.uk/chartRecorder)

外观由模板 (www.journeylog.co.uk/chart/templates/chartRecorder.xml) 定义。一项功能是能够使用 ExplorerCanvas 在服务器或浏览器中指定绘图。

如果有人感兴趣，我可以为它启动一个开源项目。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-17T20:21:53.917

[swtchart](http://www.swtchart.org)对实时来说足够快，至少在我的经验中是这样。即使有**大量**数据。不要被版本号吓跑，是的，它是一个相当新的 API，但我成功使用它没有问题。

顾名思义，它基于[SWT](http://www.eclipse.org/swt/)，使用原生 OS 绘图。它还为快速绘制做了一些巧妙的优化，比如不绘制数据集中的所有点（参见大型系列示例片段）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-19T02:36:56.593

这似乎是一个不错的候选人。

[http://jchart2d.sourceforge.net/](http://jchart2d.sourceforge.net/)

演示：

[http://jchart2d.sourceforge.net/applet.shtml](http://jchart2d.sourceforge.net/applet.shtml)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-08-16T08:42:06.637

JCCkit 是一个很好的库，它的目标是更少的内存，尤其是在嵌入式环境中：[https](https://sourceforge.net/projects/jcckit) ://sourceforge.net/projects/jcckit 。

占用少于 <100 kb 。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-17T08:19:21.923

您可以挖掘 NetBeans 的源代码。分析器实时绘制各种事物的图形，例如内存使用情况。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-07T19:46:15.490

[SWT XYGraph](https://code.google.com/p/swt-xy-graph/)可以使用您自己的数据提供者绘制数据，因此您可以创建一个提供实时数据的实时数据提供者。使用 SWTChart 和 JFreeChart，您必须为它准备整个数组。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-14T21:05:01.563

这个问题已经很好地回答了： [Java Real time graph plotting](https://stackoverflow.com/questions/7551673/java-real-time-graph-plotting)

由于 VisualVM 包含一个图表 API，并且此 API 包含在 JDK 中，因此您可以使用一个良好/快速的图表 API。

# unit-testing - 《单元测试》一份报告

> ID：555805
> 
> 赞同：10
> 
> 时间：2009-02-17T07:34:23.123
> 
> 标签：unit-testing, reporting

您将如何对由 Crystal Reports 或 SQL Server Reporting Services 等报表引擎创建的报表进行“单元测试”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T08:13:54.107

为了测试我们自己的基于 Java 的报告产品[i-net Clear Reports](http://www.inetsoftware.de/products/crystalclear)，我们运行了一大堆测试报告，将它们导出为各种导出格式，确保输出符合要求，然后每天持续运行这些相同的报告，将结果与原始数据进行比较。任何差异都会显示为测试失败。

它对我们来说效果很好。这样做的缺点是在重置测试数据之前，任何可能不会产生任何差异的微小差异都会显示为测试失败。

旁注：这不完全是单元测试，而是验收测试。但我看不出你如何真正“单元测试”整个报告。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T08:36:48.653

报告的问题类似于 GUI 的问题。如果报告/GUI 有很多（错位的）智能，它将使测试变得困难。那么解决方案是

*   [分离表示](http://martinfowler.com/eaaDev/SeparatedPresentation.html)：将表示与内容分离（数据访问/域/业务规则）。在当前上下文中意味着，您创建某种 ViewModel 类来反映最终报告的内容（例如，如果您的报告中有订单详细信息和行项目，则此类应该具有详细信息的属性和行列表项目对象）。ViewModel 的测试非常简单。最后一英里，将演示应用于内容应该是相对微不足道的（瘦 UI）。
    *例如，如果您使用 xslt 呈现报告，您可以使用 XmlUnit 或字符串比较等工具测试数据 xml。您可以对最终报告的数据 xml 上的 xsl 转换有合理的信心......此外，这里的任何错误都可以轻松修复。*
*   但是，如果您使用第三方供应商（如 Crystal Reports），则无法控制/访问连接到报表生成。在这种情况下，您能做的最好的事情就是生成具有代表性/预期的输出文件（例如 pdf），称为 Golden Files。在您的测试中使用它作为只读资源来比较实际输出。然而，这种方法非常脆弱......因为对报告生成代码的任何实质性更改都可能导致所有以前的黄金文件不正确。所以他们必须被重生。如果自动化的成本效益比太高，我会说使用老式 word doc 测试计划手动操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T08:01:02.997

我能想到的最好的是将结果与预期输出进行比较。

也许可以添加一些智能，但是要测试这些大块并不容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:08:31.387

我同意游戏猫。

从固定（恒定）数据生成报告，并将其与该数据的预期输出进行比较。

之后，您也许可以使用简单的测试，例如 diff（检查文件是否相同）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:22:26.003

我目前的想法是在两个级别上创建测试：

*   单元测试：使用一些用于测试 UI 的想法来构建报告以启用测试，例如 Humble View。报告本身将尽可能地愚蠢。它应该主要由简单的字段绑定组成。然后可以对充当这些绑定源的数据项/对象进行单元测试。

*   验收测试：生成一些示例报告。首先手动验证它们。然后设置一个使用 diff 进行比较的自动化测试。

# unit-testing - 即使我有 100% 的代码覆盖率，我的代码仍可能包含哪些类型的错误？

> ID：555807
> 
> 赞同：14
> 
> 时间：2009-02-17T07:34:56.400
> 
> 标签：unit-testing, code-coverage

即使我有 100% 的代码覆盖率，我的代码仍可能包含哪些类型的错误？我正在寻找具体示例或此类错误的具体示例的链接。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-17T07:41:38.880

拥有 100% 的代码覆盖率并不像人们想象的那么好。考虑一个简单的例子：

```
double Foo(double a, double b)
{
    return a / b;
} 
```

即使是单个单元测试也会将此方法的代码覆盖率提高到 100%，但所述单元测试不会告诉我们哪些代码在工作，哪些代码不工作。这可能是一个完全有效的代码，但没有测试边缘条件（例如 when `b`is `0.0`），单元测试充其量是不确定的。

代码覆盖率只告诉我们单元测试执行了什么，而不是它是否正确执行。这是一个重要的区别。仅仅因为单元测试执行了一行代码，并不一定意味着该行代码按预期工作。

听听[这个](http://hanselminutes.com/default.aspx?showID=121)有趣的讨论。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-17T07:41:08.723

代码覆盖率并不意味着您的代码在任何方面都没有错误。这是对测试用例覆盖源代码库的程度的估计。100% 的代码覆盖率意味着每一行代码都经过测试，但程序的每个状态肯定不是。在这方面正在进行研究，我认为它被称为有限状态建模，但它确实是一种尝试探索程序每个状态的蛮力方式。

做同样事情的一种更优雅的方式被称为抽象解释。MSR（微软研究院）发布了基于抽象解释的名为[CodeContracts的东西。](http://research.microsoft.com/en-us/projects/contracts/)还请查看[Pex](http://research.microsoft.com/en-us/projects/Pex/)，他们确实强调**了测试应用程序运行时行为的切割方法**。

我可以编写一个非常好的测试，它会给我很好的覆盖率，但不能保证该测试会探索我的程序可能具有的所有状态。这是编写非常好的测试的问题，这很难。

代码覆盖率并不意味着好的测试

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-17T07:42:06.257

呃？任何一种普通的逻辑错误，我猜？内存损坏、缓冲区溢出、普通的旧错误代码、赋值而不是测试，不胜枚举。覆盖范围仅此而已，它让您知道所有代码路径都已执行，而不是它们是否正确。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-17T07:54:32.217

正如我还没有看到它提到的那样，我想添加这个线程，代码覆盖率不会**告诉**你代码的哪一部分是没有错误的。

它只告诉您代码的哪些部分**保证未经测试。**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-17T07:45:05.970

**1.“数据空间”问题**

你的（坏）代码：

```
void f(int n, int increment)
{
  while(n < 500)
  {
    cout << n;
    n += increment;
  }
} 
```

你的测试：

```
f(200,100); 
```

实际使用中的错误：

```
f(200,0); 
```

我的观点：您的测试可能覆盖 100% 的代码行，但它不会（通常）覆盖所有可能的输入数据空间，即所有可能的输入值的集合。

**2\. 测试你自己的错误**

另一个经典的例子是当你在设计中做了一个错误的决定，并根据你自己的错误决定测试你的代码。

例如，规范文档说“打印所有素数到*n* ”并且你打印所有素数到*n*但*不包括* *n*。你的单元测试会测试你的错误想法。

**3\. 未定义的行为**

使用未初始化变量的值，导致无效的内存访问等，并且您的代码具有未定义的行为（在 C++ 或任何其他考虑“未定义行为”的语言中）。有时它会通过你的测试，但它会在现实世界中崩溃。

...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-17T07:41:17.553

总是会出现运行时异常：内存已满、数据库或其他连接未关闭等...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-17T07:44:59.387

考虑以下代码：

```
int add(int a, int b)
{
  return a + b;
} 
```

此代码可能无法实现一些必要的功能（即不满足最终用户的要求）：“100% 覆盖率”不一定测试/检测应该实现但没有实现的功能。

此代码适用于某些但不是所有输入数据范围（例如，当 a 和 b 都非常大时）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-17T07:48:33.060

*如果您的测试*包含错误，或者您正在测试错误的东西，代码覆盖率没有任何意义。

作为相关切线；我想提醒你，我可以简单地构造一个满足以下伪代码测试的 O(1) 方法：

```
sorted = sort(2,1,6,4,3,1,6,2);

for element in sorted {
  if (is_defined(previousElement)) {
    assert(element >= previousElement);
  }

  previousElement = element;
} 
```

*Jon Skeet 的额外业力，他指出了我正在考虑的漏洞*

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-17T08:04:41.693

**代码覆盖率通常只告诉你一个函数**中有多少分支被覆盖。它通常不会报告**函数调用之间**可以采用的各种路径。程序中的许多错误发生是因为从一种方法到另一种方法的切换是错误的，而不是因为方法本身包含错误。这种形式的所有错误仍然可能存在于 100% 的代码覆盖率中。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-17T08:08:29.533

在最近的 IEEE 软件论文“两个错误和无错误软件：一个忏悔”中，罗伯特·格拉斯认为，在“现实世界”中，由于他所谓的缺少逻辑或组合（无法防范）导致的错误更多使用代码覆盖工具）而不是逻辑错误（可以）。

换句话说，即使有 100% 的代码覆盖率，您仍然冒着遇到这类错误的风险。你能做的最好的事情是——你猜对了——做更多的代码审查。

论文的参考在[这里，我在](http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=4548415&isnumber=4548393)[这里](http://testmuse.spaces.live.com/blog/cns!FCF2D51D333DA1FD!300.entry)找到了一个粗略的总结。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-17T08:49:38.293

> *在我的机器上工作*

许多事情在本地机器上运行良好，我们不能保证在暂存/生产上运行。代码覆盖率可能不会涵盖这一点。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-17T07:47:44.387

测试中的错误:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-17T07:43:25.113

好吧，如果您的测试没有测试涵盖的代码中发生的事情。如果您有此方法可以向属性添加数字，例如：

```
public void AddTo(int i)
{
NumberA += i;
NumberB -= i;
} 
```

如果您的测试只检查 NumberA 属性，而不检查 NumberB，那么您将有 100% 的覆盖率，测试通过，但 NumberB 仍将包含错误。

结论：100% 的单元测试并不能保证代码没有错误。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-17T08:37:22.660

参数验证，又名。空检查。如果您接受任何外部输入并将它们传递给函数但从不检查它们是否有效/为空，那么您可以实现 100% 的覆盖率，但是如果您以某种方式将 null 传递给函数，您仍然会得到 NullReferenceException，因为这是您的数据库给出的你。

还有，算术溢出，比如

```
int result = int.MAXVALUE + int.MAXVALUE; 
```

代码覆盖率仅涵盖现有代码，它无法指出您应该在哪里添加更多代码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-17T11:20:53.407

我不知道其他人，但我们没有接近 100% 的覆盖率。我们的“这不应该发生”的 CATCH 都没有在我们的测试中得到锻炼（嗯，有时他们会这样做，但随后代码会被修复，所以他们不会再发生了！）。恐怕我不担心在从未发生过的 CATCH 中可能存在语法/逻辑错误

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-17T11:24:36.533

您的产品可能在技术上是正确的，但不能满足客户的需求。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-17T16:12:43.813

仅供参考，Microsoft Pex 试图通过探索您的代码并找到“边缘”情况来提供帮助，例如除以零、溢出等。

该工具是 VS2010 的一部分，但您可以在 VS2008 中安装技术预览版。该工具可以找到它找到的东西，这是非常了不起的，但是，IME，它仍然不会让你一路“防弹”。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-17T16:21:35.133

执行 100% 的代码覆盖率，即 100% 的指令、100% 的输入和输出域、100% 的路径、100% 的任何你想到的，你的代码中仍然可能存在错误：***缺少功能***。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-17T16:35:49.890

代码覆盖率意义不大。重要的是是否涵盖了所有（或大部分）影响行为的参数值。

例如，考虑一个典型的 compareTo 方法（在 java 中，但适用于大多数语言）：

```
//Return Negative, 0 or positive depending on x is <, = or > y
int compareTo(int x, int y) {
   return x-y;
} 
```

只要您对 进行了测试`compareTo(0,0)`，就可以获得代码覆盖率。但是，您在这里至少需要 3 个测试用例（用于 3 个结果）。它仍然不是没有错误的。添加测试以涵盖异常/错误情况也是值得的。在上述情况下，如果你尝试`compareTo(10, Integer.MAX_INT)`，它将失败。

底线：尝试根据行为将输入划分为不相交的集合，对每个集合中的至少一个输入进行测试。这将增加真正意义上的*覆盖范围。*

还要检查诸如[QuickCheck 之](http://www.cs.chalmers.se/~rjmh/QuickCheck/)类的工具（如果适用于您的语言）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-17T16:48:32.060

正如这里的许多答案所提到的，您可能拥有 100% 的代码覆盖率并且仍然存在错误。

最重要的是，您可能有 0 个错误，但代码中的逻辑可能不正确（不符合要求）。代码覆盖率或 100% 无错误根本无法帮助您。

典型的企业软件开发实践如下：

1.  有一个清晰的功能规范
2.  制定针对 (1) 的测试计划并进行同行评审
3.  针对 (2) 编写测试用例并进行同行评审
4.  根据功能规范编写代码并进行同行评审
5.  根据测试用例测试您的代码
6.  做代码覆盖率分析，编写更多的测试用例，达到良好的覆盖率。

请注意，我说的是“好”而不是“100%”。100% 的覆盖率可能并不总是可行的——在这种情况下，最好将精力花在实现代码的正确性上，而不是覆盖一些晦涩的分支。在上面的第 1 步到第 5 步中，不同类型的事情都可能出错：错误的想法、错误的规范、错误的测试、错误的代码、错误的测试执行……最重要的是，仅第 6 步并不是最重要的一步。过程。

没有任何错误且覆盖率为 100% 的错误代码的具体示例：

```
/**
 * Returns the duration in milliseconds
 */
int getDuration() {
    return end - start;
}

// test:

start = 0;
end = 1;
assertEquals(1, getDuration()); // yay!

// but the requirement was:
// The interface should have a method for returning the duration in *seconds*. 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-22T23:01:44.930

几乎所有东西。

你读过[完整的代码](http://www.cc2e.com/)吗？（因为 StackOverflow 说你真的[应该这样](https://stackoverflow.com/questions/1711/what-is-the-single-most-influential-book-every-programmer-should-read)做。）在第 22 章中它说“100% 的语句覆盖率是一个好的开始，但这还不够”。本章的其余部分解释了如何确定要添加哪些附加测试。这是一个简短的品尝者。

*   **结构化基础测试**和**数据流测试**意味着通过程序测试每个逻辑路径。下面的人为代码有四个路径，具体取决于 A 和 B 的值。100% 的语句覆盖率可以通过仅测试四个路径中的两个来实现，也许`f=1:g=1/f`和`f=0:g=f+1`。但`f=0:g=1/f`会给出除以零的错误。您必须考虑*if*语句以及*while*和*for*循环（循环体可能永远不会被执行）以及*select*或*switch*语句的每个分支。

    > `If A Then`
    > `f = 1`
    > `Else`
    > `f = 0`
    > `End If`
    > `If B Then`
    > `g = f + 1`
    > `Else`
    > `g = f / 0`
    > `End If`

*   **错误猜测**- 对经常导致错误的输入类型进行有根据的猜测。例如边界条件（关闭一个错误）、无效数据、非常大的值、非常小的值、零、空值、空集合。

即便如此，您的要求中可能存在错误，测试中的错误等 - 正如其他人所提到的。

# java - 使用 RTP 在 java 或 c++ 中开发屏幕共享/呈现应用程序的最佳方法是什么？

> ID：555831
> 
> 赞同：1
> 
> 时间：2009-02-17T07:44:40.057
> 
> 标签：java, c++, rtp

我正在尝试构建一个服务器端的基于 HTML 渲染的浏览器，就像 skyfire 一样。我正在评估构建它所需的技术。当用户在客户端框中键入 www.yahoo.com 时，服务器上会启动一个会话，然后我抓取屏幕截图并将它们以 RTP 流的形式发送回客户端。为了做 RTP 位，我开始使用 JMF [http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/solutions/ScreenGrabber.html](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/solutions/ScreenGrabber.html)我发现当我得到 RTP 流时在客户端上，它非常慢，有时我会在视频流中得到很多伪像。有没有比使用 JMF 更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T20:53:28.490

好吧，如果我正确理解了您的问题，那么您需要一种有效的方法来进行 RTP 流式传输。一个非常好的和高效的 C++ 流媒体库是[live555](http://www.live555.com/)。要对图像进行编码，您可以使用[ffmpeg](http://ffmpeg.org/)并最终使用其 C++/java/JMF 绑定[FOBS](http://fobs.sourceforge.net/)。这样您就可以拥有一个高效的流媒体服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T08:00:45.650

目前尚不清楚您要实现 Skyfire 的哪个功能。

如果您正在流式传输一系列屏幕截图，并且发现速度很慢，请压缩您发送的数据。据推测，一个屏幕截图与前一个屏幕截图仅略有不同：为了最大限度地减少带宽，您应该只传输每个屏幕截图之间的增量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T08:07:31.687

查看 VNC/VNCViewer。甚至还有一个查看器小程序，IIRC 有一个关于 SO 是否可以在 Java 桌面程序中完成的问题（与浏览器中的小程序相反）

# iphone - “修复” UIScrollView 中的子视图

> ID：555836
> 
> 赞同：0
> 
> 时间：2009-02-17T07:45:38.697
> 
> 标签：iphone, uiscrollview, subview

我有一个 UIScrollView，它包含一个沿 X 和 Y 轴滚动的视图（我们称之为“主视图”）。

我试图透明地覆盖该视图上的标题，该标题固定在屏幕顶部（不是视图），但像主视图一样沿 X 轴滚动。当主视图沿 Y 轴滚动时，标题保持在屏幕顶部。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:58:57.467

为您的指示器视图和滚动视图创建一个容器视图。使其成为屏幕的大小。

将 the`UIScrollView`和 your添加`HeadingView`到此作为子视图。当滚动视图平移时，标题将保持静止。您可以根据添加到 Scrollview 的 UIScrollViewDelegate 的消息更新标题。`scrollViewDidScroll:`是最明显的，但您可以收到其他通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T07:50:32.930

我根本不会把视图放在滚动视图中。使用滚动视图委托来捕捉滚动视图何时平移并手动水平移动子视图。

# iphone - 如何禁用 Xcode 中的按钮？

> ID：555846
> 
> 赞同：16
> 
> 时间：2009-02-17T07:54:17.273
> 
> 标签：iphone, xcode, cocoa-touch, interface-builder

我是 iPhone 开发的新手。我正在使用 Xcode 构建一个应用程序，但现在想禁用一个按钮。这怎么可能？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-17T08:02:01.607

```
myButton.enabled = NO; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-17T08:02:11.310

通过代码：

```
myButton.enabled = NO; 
```

如果您使用的是界面生成器，则有一个“启用”选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-24T05:26:08.207

如果您正在寻找 Swift 3.0 解决方案：

```
button.isEnabled = false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T04:09:31.190

button.enabled = 否；

您可以将按钮属性设置为 no，如果界面生成器可以取消选中该属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-08T23:59:57.267

```
 button.enabled = true; 
```

这将启用按钮

```
button.enabled = false; 
```

这将禁用按钮。如果你想隐藏按钮，你可以这样做

```
button.alpha = 0.0; 
```

如果你想再次显示按钮，你可以这样做。

```
button.alpha = 1.0 
```

希望这可以帮助！:)

# regex - 使用正则表达式验证 IP

> ID：555847
> 
> 赞同：4
> 
> 时间：2009-02-17T07:54:20.953
> 
> 标签：regex

我需要验证格式为 000000000 到 255255255 的 IP 范围，在 3 组数字之间没有任何分隔符。最终 IP 包含的三个组中的每一个都应该是 000（是的，0 填充）到 255。

由于这是我的第一个 stackoverflow 条目，如果我没有正确遵守礼仪，请宽容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T07:59:49.193

```
^([01]\d{2}|2[0-4]\d|25[0-5]){3}$ 
```

其中分解为以下部分：

1.  000-199
2.  200-249
3.  250-255

如果您决定要 4 个八位字节而不是 3 个，只需将最后一个更改`{3}`为`{4}`. 此外，您也应该了解 IPv6。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T08:02:24.897

我个人不会为此使用正则表达式。我认为更容易确保字符串由 9 位数字组成，将字符串分成 3 组 3 位数字，然后检查每个数字是否在 0 到 255 之间，包括 0 到 255。

如果你真的坚持使用正则表达式，那么你可以使用这样的东西：

```
"([0-1][0-9][0-9]|2[0-4][0-9]|25[0-5]){3}" 
```

该表达式包含三个项的交替：第一个匹配项`000-199`，第二个`200-249`，第三个`250-255`。`{3}`要求匹配恰好三遍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T07:58:55.203

这是一个很常见的问题。[这](http://www.regular-expressions.info/examples.html)是关于正则表达式的一个很好的介绍页面，以这种情况为例。它包括句点，但您可以很容易地编辑它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T07:47:48.680

仅匹配有效的 IP 地址使用

```
(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3} 
```

代替

```
([01]?[0-9][0-9]?|2[0-4][0-9]|25[0-5])(([01]?[0-9][0-9]?|2[0-4][0-9]|25[0-5])){3} 
```

因为许多正则表达式引擎匹配 OR 序列中的第一种可能性

你可以试试你的正则表达式引擎：10.48.0.200

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-10T09:02:56.843

```
\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b 
```

我使用这个 RegEx 在我的项目的代码中搜索所有 ip

# c# - 用于 C# 的易于模拟的 HTTP 客户端框架

> ID：555864
> 
> 赞同：4
> 
> 时间：2009-02-17T08:01:58.767
> 
> 标签：c#, http, tdd, mocking

在即将到来的项目中，我将使用 C# 编写一个应用程序，该应用程序部分必须与 HTTP 服务器通信。我非常喜欢编写 TDD 风格的代码，如果我可以在我的测试中模拟所有 HTTP 请求，我会喜欢它。

这里有人知道一个易于模拟的 HTTP 客户端框架吗？

附言。我通常使用 Moq 进行模拟。如果您知道一些可以更好地模拟 HTTP 请求的免费模拟框架，那也很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T16:03:16.957

DotNetOpenId 是一个可以重用代码的开源项目，它使用 HTTP 包装类，所有调用都是通过该类进行的。在测试期间，会注入一个模拟 HTTP 处理程序，以便可以在调用之前以编程方式设置响应。它有另一种模式，它托管自己的 ASP.NET 站点，以便可以使用完整的实际堆栈。

这很好用，尽管它还没有作为一个独立的解决方案退出。如果您有兴趣重用它，这里有一些相关的源链接。您可以通过 dotnetopenid@googlegroups.com 寻求帮助来集成它。

直播一： [StandardWebRequestHandler.cs](http://github.com/AArnott/dotnetopenid/blob/656ef7b1b405d56d986776082a2670c68c415c44/src/DotNetOpenAuth/Messaging/StandardWebRequestHandler.cs)

模拟： [MockHttpRequest.cs](http://github.com/AArnott/dotnetopenid/blob/656ef7b1b405d56d986776082a2670c68c415c44/src/DotNetOpenAuth.Test/Mocks/MockHttpRequest.cs)，[TestWebRequestHandler.cs](http://github.com/AArnott/dotnetopenid/blob/656ef7b1b405d56d986776082a2670c68c415c44/src/DotNetOpenAuth.Test/Mocks/TestWebRequestHandler.cs)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-19T00:12:12.577

我建议您为此使用框架支持，即 System.Net.WebRequest。

为 webrequest 定义一个非常简单的接口和一个简单的包装器。这样你就可以得到你想要的，并且不会为框架已经做得很好的东西添加外部依赖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-21T14:21:00.590

您可以使用[WireMock.Net](https://github.com/WireMock-Net/WireMock.Net)，它是一个灵活的库，用于使用请求匹配条件来存根和模拟 Web HTTP 响应。

这也可以很容易地用于单元测试项目。查看 wiki 了解详细信息。

NuGet 可在[此处](https://www.nuget.org/packages/WireMock.Net/)找到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:27:04.730

我认为实际上没有任何框架可以处理您要归档的内容。毕竟只有你知道每个 Http 请求应该做什么。所以基本上你有两个选择：

1.  拨打电话并在另一端使用虚拟实现。这可能是一个返回虚拟数据的简单控制台应用程序。如果您需要更多逻辑，我会考虑使用对象数据库——我认为它们非常适合这些应用程序。
2.  在应用程序端使用模拟实现。如果此实现有很多逻辑，请不要使用任何模拟框架 - 创建一个具有所有逻辑的自定义模拟类。

希望这可以帮助

# nhibernate - NHibernate 一对多问题

> ID：555870
> 
> 赞同：3
> 
> 时间：2009-02-17T08:06:39.613
> 
> 标签：nhibernate, fluent-nhibernate

我有一个与 VesselDetail 对象具有一对多关系的 Vessel 对象。当我将 VesselDetail 对象添加到 Vessel 对象并尝试保存 Vessel 对象时，似乎 NHibernate 在插入 VesselDetail 对象时没有添加外键。

我在哪里错了？我就是想不通。

错误消息：BDN.FindVessel.Tests.Integration.NhibernateRepositoryTests.SaveVessel_ShouldAddDetailsToDb_WhenAddedToEntity：NHibernate.Exceptions.GenericADOException：无法插入：[BDN.FindVessel.Domain.VesselDetail][SQL：INSERT INTO BoatsDetails（SaftyGear、OtherMachineryAndGear、材料、尺寸、各种, TranslatorId, SpeenAndConsumption, MainMachinery, Created, Class, Capasities, Culture, Interior, Electronics, DeckGear) 值 (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? , ?); 选择 SCOPE_IDENTITY()] ----> System.Data.SqlClient.SqlException：无法将值 NULL 插入到列“BoatId”、表“FindVesselTest.dbo.BoatsDetails”中；列不允许空值。插入失败。该语句已终止。

```
public class Vessel
{
        public virtual int BoatId { get; set; }
        public virtual IList<VesselDetail> Details { get; set; }
        //...
}

public class VesselDetail
{
        public virtual int VesselDetailId { get; set; }
        //some other properties
        //..
}

public class VesselMap: ClassMap<Vessel>
{
    public VesselMap()
    {
        WithTable("Boats");

        Id(x => x.BoatId, "Id");

        //..

        HasMany(x => x.Details)
            .WithKeyColumn("BoatId") //foreign key in the BoatsDetails table
            .Cascade.All();
    }
}

public class VesselDetailMap:ClassMap<VesselDetail>
{
  public VesselDetailMap()
  {
      WithTable("BoatsDetails");

      Id(x => x.VesselDetailId, "Id");

      //...
  }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T13:21:53.583

看来我缺少一些基本的 NHibernate 技能。稍微阅读一下，似乎您需要让子对象负责一对多关系。

这解决了我的问题：

```
public class VesselMap: ClassMap<Vessel>
{
    public VesselMap()
    {
        //...

        HasMany(x => x.Details)
                .Inverse()
                .WithKeyColumn("BoatId");
    }
}

public class VesselDetailMap:ClassMap<VesselDetail>
{
  public VesselDetailMap()
  {
      //..

       References(x => x.Vessel, "BoatId")
                .Cascade
                .SaveUpdate();
  }
} 
```

# c# - C#：具有相同内容的字符串

> ID：555871
> 
> 赞同：18
> 
> 时间：2009-02-17T08:07:23.700
> 
> 标签：c#, string

我听说并读到字符串不能更改（不可变？）。我猜这应该是正确的。但我也听说两个具有相同内容的字符串共享相同的内存空间（或者你所说的）。它是否正确？

如果是这样，这是否意味着如果我创建一个包含数千个字符串的列表，如果这些字符串中的大多数彼此相等，它就不会真正占用太多空间？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-17T08:47:04.947

编辑：在下面的答案中，我将实习生池称为特定于 AppDomain 的；我很确定这是我之前观察到的，但[String.Intern](http://msdn.microsoft.com/en-us/library/system.string.intern.aspx)的 MSDN 文档建议整个过程只有一个实习生池，这使得这一点更加重要。

**原始答案**

（我打算将此添加为评论，但我认为这是一个足够重要的点，需要额外的答案......）

正如其他人所解释的那样，所有字符串文字都会发生字符串实习，但不会发生在“动态创建”的字符串上（例如，从数据库或文件中读取的字符串，或使用`StringBuilder`or构建的字符串`String.Format`）

但是，我*不*建议调用`String.Intern`来绕过后一点：它将*在您的`AppDomain`*. 相反，请使用仅对您的使用而言本地的池。以下是此类池的示例：

```
public class StringPool
{
    private readonly Dictionary<string,string> contents =
        new Dictionary<string,string>();

    public string Add(string item)
    {
        string ret;
        if (!contents.TryGetValue(item, out ret))
        {
            contents[item] = item;
            ret = item;
        }
        return ret;
    }
} 
```

然后你只需使用类似的东西：

```
string data = pool.Add(ReadItemFromDatabase()); 
```

（请注意，池不是线程安全的；正常使用不需要它。）

这样，您可以在不再需要池时立即丢弃它，而不是永远在内存中拥有大量潜在的字符串。如果你真的想的话，你也可以让它更聪明，实现一个 LRU 缓存或其他东西。

编辑：只是为了澄清为什么这比使用`String.Intern`......假设你从数据库或日志文件中读取一堆字符串，处理它们，然后转移到另一个任务。如果您调用`String.Intern`这些字符串，只要您还活着，它们就*永远不会*`AppDomain`被垃圾收集- 甚至可能不会。如果您加载多个不同的日志文件，您将逐渐在实习生池中积累字符串，直到您完成或内存不足。相反，我建议这样的模式：

```
void ProcessLogFile(string file)
{
    StringPool pool = new StringPool();
    // Process the log file using strings in the pool
} // The pool can now be garbage collected 
```

在这里，您可以获得同一文件中的多个字符串在内存中仅存在一次（或至少仅通过 gen0 一次）的好处，但您不会污染“全局”资源（实习池）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T08:11:15.483

这或多或少是真的。它被称为“字符串实习”。字符串文字只会在内存中出现一次，并且每个设置为相同值的变量都指向这个单一的表示。但是，在代码中创建的字符串不会自动被实习。

[http://msmvps.com/blogs/manoj/archive/2004/01/09/1549.aspx](http://msmvps.com/blogs/manoj/archive/2004/01/09/1549.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T08:13:05.887

如果我没记错的话，在代码中硬编码的字符串是分开汇集的。这称为“Interned”，并且有一个方法可以查询字符串是否为：[String.IsInterned 方法](http://msdn.microsoft.com/en-us/library/system.string.isinterned.aspx)

在“备注”下的该页面上，您可以阅读：

> 公共语言运行时自动维护一个称为“实习池”的表，其中包含程序中声明的每个唯一文字字符串常量的单个实例，以及您以编程方式添加的任何唯一 String 实例。

希望这对您有所帮助，如果我错了，请纠正我。

马蒂亚斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:12:58.523

为了使字符串“共享”它们的内存位置，是将它们实习在实习池中，其中包含对在程序中以编程方式声明或创建的每个唯一文字字符串的单个引用。

请注意，代码中的所有字符串文字都是自动实习的。

# c# - 将序列化对象存储在数据库中而不是多个 xml 文本文件中是个好主意吗？

> ID：555880
> 
> 赞同：3
> 
> 时间：2009-02-17T08:10:37.843
> 
> 标签：c#, database-design

我目前正在开发一个需要保留用户的某些请求的 Web 应用程序。我有三个选择：

1.  序列化每个请求对象并将其存储为 xml 文本文件。
2.  序列化请求对象并使用 CLOB 将此 xml 文本存储在数据库中。
3.  将请求存储在数据库中的单独表中。

在我看来，我会选择选项 2（将序列化对象的 xml 文本存储在数据库中）。我会这样做，因为从 1 列读取然后反序列化对象以对它们进行一些处理会容易得多。我正在使用 c# 和 asp .net MVC 来编写这个应用程序。我对软件开发相当陌生，如果我能得到任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T08:40:09.860

简短回答：如果选项 2 非常适合您的需求，请使用它。将数据存储在数据库中没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:25:08.087

这个问题的答案真的取决于细节。存储什么样的数据？需要怎么查询？您需要多久查询一次？

通常，我会说同时执行 1 和 2 不是一个好主意。选项 2 的问题是您将更难查询特定字段。如果您要执行 LIKE 查询并让它搜索一个非常长的字符串，这将是一项昂贵的操作，并且您稍后可能会遇到性能问题。

如果您真的不想编写代码来读取多列来加载数据，请考虑使用像 Linq to SQL 这样的 ORM。这将有助于为您将数据库表加载到对象中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-18T13:56:28.487

我设计了许多系统，其中将“某些”对象作为序列化 xml 存储在数据库中已证明是更好的选择。我还学到了将对象作为 xml 存储在 db 中的经验，这最终会导致更多的麻烦。所以我想出了一些问题，你必须回答是才能舒服地做：

1.  对象是否需要便携？
2.  对象中的数据是否被封装，即不是其他东西的一部分，也不是由其他东西组成。
3.  未来2号可以改变吗？

在 SQL 中，您始终可以使用 XQuery 创建表视图，但我只建议您在以下情况下这样做：a）改变主意为时已晚 b）您没有那么多对象要管理。

在 XML 中序列化和存储对象有一些真正的好处，特别是对于可扩展性和敏捷开发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:27:35.337

如果这种物体的数量很大，而且它的尺寸不是很大。我认为使用数据库是个好主意。

将其存储在单独的表中还是将其存储在原始表中取决于您将如何将此 CLOB 数据与原始表一起使用。如果您在访问原始表时总是需要 CLOB 数据，请使用选项 2。否则请使用选项 3 以提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:28:36.050

您还需要考虑安全性和 n 层架构。在数据库中存储序列化数据意味着您的数据将在另一台服务器上，如果数据需要安全，这是理想的选择，但也会给您带来网络延迟，而将数据存储在文件系统中可以让您更快地访问 IO，但搜索非常有限能力。

我有这样的情况，我使用数据库。它还与其余相关数据一起正确备份。

# c# - CompositeWPF：EventAggregator - 何时使用？

> ID：555889
> 
> 赞同：11
> 
> 时间：2009-02-17T08:14:59.500
> 
> 标签：c#, events, prism

我一直在研究[Composite Application Library](http://www.codeplex.com/CompositeWPF)，它很棒，但我无法决定何时使用 EventAggregator ......或者更确切地说 - 何时不使用它。

看看 StockTraderRI 的例子，我更加困惑。他们在某些情况下使用 EventAggregator，在其他情况下使用“经典”事件（例如 IAccountPositionService 接口）。

我已经决定将它用于与繁重的工作任务进行通信，该任务应该在后台线程上运行。在这种情况下，EventAggregator 在幕后提供线程编组，所以我不必太担心。除此之外，我喜欢这种方法提供的解耦。

所以我的问题是：当我开始在我的应用程序中使用 EventAggregator 时，为什么不将它用于*所有*自定义事件？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-18T06:35:29.417

这是一个很好的问题。在 Composite WPF (Prism) 中，有 3 种可能的方式在应用程序的各个部分之间进行通信。一种方法是使用 Commanding，它仅用于将 UI 触发的操作传递到实现该操作的实际代码。另一种方法是使用共享服务，其中多个部分持有对同一服务（单例）的引用，并且它们以经典方式处理该服务上的各种事件。正如您已经说过的，对于断开连接和异步通信，最好的方法是使用事件聚合器（它密切遵循 Martin Fowler 的模式）。

现在，何时使用和不使用它：

1.  当您需要在模块之间进行通信时使用它。（例如，当任何其他模块创建任务时，需要通知任务模块）。
2.  当您有多个可能的接收者或同一事件的来源时使用它。例如，您有一个对象列表，并且您希望在保存或创建该类型的对象时刷新它。您只需订阅此特定事件，而不是保留对所有打开的编辑/创建屏幕的引用。
3.  当您只需要订阅 Model View Presenter 区域中的正常事件时，不要使用它。例如，如果您的 Presenter 侦听 Model 中的更改（例如，Model 实现了 INotifyPropertyChanged）并且您的 Presenter 需要对此类更改做出反应，那么您的 Presenter 最好直接处理 Model 的 PropertyChanged 事件，而不是通过事件聚合器。因此，如果发送者和接收者都在同一个单元中，则无需将此类事件“广播”到整个应用程序。

我希望这回答了你的问题。

# javascript - 合并压缩 CastleProject MonoRails 的 formhelper.js 和 behavior.js？

> ID：555894
> 
> 赞同：1
> 
> 时间：2009-02-17T08:18:21.537
> 
> 标签：javascript, optimization, castle-monorail

任何使用 CastleProject MonoRails MVC 的人都知道我是否可以将 formhelper 和行为 js 文件组合和/或压缩成类似 monorails.js 的东西？

我想尽可能少地获得网络请求的数量..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T06:19:41.203

彼得的回答很好，但是[YUI Compressor 有一个 .NET 实现](http://www.codeplex.com/YUICompressor)。我认为这对于 .Net 项目会更可取和有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T13:23:43.160

如果在一个页面上将两个 javascript 文件一起加载不是问题，那么将它们连接到一个文件中会得到相同的行为。当您使用它时，您也可以缩小它们：http: [//developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-02T16:44:03.710

我不久前做过这个。

[http://theusualsuspect.com/all-things-net/simple-js-and-css-compression-for-monorail](http://theusualsuspect.com/all-things-net/simple-js-and-css-compression-for-monorail)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T06:30:29.713

Castle MonoRails 在 CombineJS 组件中有一个 buildt，它用作带有名称（键）的 javascript 组合器。请注意，路径将是相对的，因此我们不应有超过 2 个 combinejs 块以保持 httprequests < 2（IE7 最大并行 http 请求数）。

```
#blockcomponent(CombineJS with "key=scripts") 
    $combiner.Add("my/script.${ext}")
#end 
```

PS！如果有人知道如何更改域（不是相对的），请告诉我:-)

# testing - 敏捷方式：集成测试与功能测试还是两者兼而有之？

> ID：555899
> 
> 赞同：37
> 
> 时间：2009-02-17T08:20:11.517
> 
> 标签：testing, tdd, scrum

我在一个已经做了一段时间敏捷的办公室工作。我们使用 Scrum 进行项目管理，并融入 XP 的工程实践中。它运作良好，我们不断吸取教训并完善我们的流程。

我想告诉您我们通常的测试实践，并获得有关如何改进的反馈：

**TDD：第一道防线** 我们对单元测试非常虔诚，我想说我们的开发人员也有足够的经验来编写全面的测试，并且总是用模拟隔离 SUT。

**集成测试** 对于我们的使用，集成测试与单元测试基本相同，只是不使用模拟。这往往会发现一些在单元测试中漏掉的问题。这些测试往往难以阅读，因为它们通常在规范框架的`before_each`和`after_each`部分中涉及很多或工作，因为系统必须经常达到某种状态才能使测试有意义。

**功能测试** 我们通常以结构化但手动的方式进行。我们玩过 Selenium 和 Windmill，它们很酷，但至少对我们来说还没有。

我想听听其他人是如何做事的。你认为如果集成测试或功能测试做得足够好，另一个可以忽略吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-17T08:33:18.317

单元、集成和功能测试虽然执行相同的代码，但从不同的角度对其进行攻击。正是这些观点产生了影响，如果你放弃一种类型的测试，那么某些东西可能会从那个角度发挥作用。

此外，单元测试并不是真的要测试你的代码，尤其是在你练习 TDD 的时候。[TDD](http://blog.robustsoftware.co.uk/2009/02/test-aided-development.html)的过程可以帮助你更好地设计你的代码，你只是在它结束时获得一套测试的额外好处。

你还没有提到你是否有一个持续集成服务器在运行。我强烈建议设置一个（[哈德森](http://hudson-ci.org/)很容易设置）。然后，您可以针对每次签入代码运行集成和功能测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T08:31:58.197

我们已经体验到，一套可靠的硒测试实际上很好地总结了客户对质量的期望。所以，本质上我们一直在讨论：如果编写 selenium 测试和编写单元测试一样简单，我们应该少关注单元测试。

如果某个地方存在*一个*对应用程序没有任何影响的错误，那么谁真正在乎呢？但总是存在围绕现实生活复杂性的问题。你确定你的功能测试捕​​捉到了正确的场景吗？其他系统可能会导致在应用程序的行为中不直接可见的潜在复杂性。

实际上，一旦您深入研究了最初的问题，编写 selenium 测试（使用适当的编程语言，而不是 selenese）*确实变得非常简单和有趣。*但是我们还不愿意放弃我们的单元测试......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T08:26:38.723

单元测试、集成测试和功能测试都有不同的用途。您不应该仅仅因为其他的以高可靠性运行而丢弃一个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T08:27:43.417

我会说（这只是一个意见问题）你的功能测试是你*真正*的测试。即那些实际模拟应用程序实际使用的测试。因此，无论如何，永远不要摆脱它们。

听起来你有一个体面的系统。如果您没有什么可失去的，请保留它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T09:13:22.323

在我目前的客户中，我们并没有真正区分单元测试和集成测试。业务实体如此依赖底层数据层（使用本土 ORM 框架），实际上我们几乎没有或根本没有真正的单元测试。

构建服务器在 Team Build 中使用持续集成 (CI) 进行设置，为了防止这种情况因缓慢的测试而陷入困境（完整的测试套件需要一个多小时才能在服务器上运行），我们将测试分为“缓慢”每天运行两次的测试和作为持续集成的一部分运行的“快速”测试。通过在测试方法上设置一个属性，构建服务器可以区分两者之间的区别。

一般来说，“慢”测试是任何需要进行数据访问、使用网络服务或类似的测试。按照惯例，这些将​​被视为集成测试或功能测试。示例包括：CRUD 测试、需要一组对象才能使用的业务验证规则测试等。

“快速”测试更像是单元测试，您可以在其中合理地隔离单个对象的状态和行为以进行测试。

我认为任何在十分之一秒或更短时间内运行的测试都是“快速”的。其他任何东西都很慢，可能不应该作为 CI 的一部分运行。

我同意您不应该过于拘泥于您在开发过程中使用的测试的“风味”（当然，将验收标准表示为测试是例外）。个人开发人员应该根据自己的判断来决定哪种类型的测试最适合他们的代码。坚持对业务实体进行单元测试可能不会揭示 CRUD 测试会出现的错误等等......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-23T19:45:33.620

我将单元测试比作确保段落中的单词拼写正确。功能测试就像确保段落有意义，并且在它所在的文档中很好地流动。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T08:38:59.723

我倾向于不区分 TDD 中的各种测试风格。对我来说，TDD 是测试驱动开发，而不是单元测试驱动开发。所以我的 TDD 实践结合了单元测试、集成测试、功能测试和验收测试。这导致某些组件被某些类型的测试覆盖，而其他组件以非常实用的方式被其他类型的测试覆盖。

我问了一个关于这种做法的相关性的[问题](https://stackoverflow.com/questions/517882/testing-unit-vs-integration-vs-others-what-is-the-need-for-separation)，简短的回答是，在实践中，快速/简单的测试在每次构建时自动运行，而慢速/复杂的测试运行频率较低。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-17T08:43:22.490

我的公司进行功能测试，但不进行单元或集成测试。我试图鼓励我们采用它们，我认为它们鼓励更好的设计和更快的迹象表明一切都很好。如果您进行功能测试，您是否需要单元测试？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-17T09:16:31.177

我真的很喜欢 Gojko Adzic 的“面子测试”概念，以此来确定您通过 UI 测试的内容：http: [//gojko.net/2007/09/25/effective-user-interface-testing/](http://gojko.net/2007/09/25/effective-user-interface-testing/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T16:02:04.037

你应该做所有这些，因为单元、集成和功能测试都有不同的用途。
属于我很重要的一点是，编写测试的方式很重要，TDD 是不够的，BDD（行为驱动开发）给出了一个很好的方法......

# tfs - 如何说服“管理层”使用 Visual Studio Team System 的各个方面？

> ID：555909
> 
> 赞同：0
> 
> 时间：2009-02-17T08:25:47.277
> 
> 标签：tfs, process, project-management, software-quality

目前我们有几个缺陷和错误跟踪系统，其中包括质量中心和定制支持系统（包括团队和公司范围）。我们还使用 Microsoft Project - 虽然我已经好几个月没有看到任务列表了......

但我觉得难以理解的是为什么我们公司购买 VSTS 并且只使用其中的一部分——我们目前使用源代码控制、自动化的夜间构建和团队测试功能。

我们的团队如何说服“管理层”使用系统的项目任务项、缺陷跟踪、报告和流程指导部分？一旦正确实施，这肯定会节省时间和金钱吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T08:35:55.707

如果您已经拥有 VSTS 许可证，那么为什么您的团队管理层需要签署任何协议？在您的团队中为小区域启动功能并逐渐增加。您会要求管理层签署您使用的文本编辑器吗？

管理层对任何可能以任何方式破坏生产力的事物都有一种基本的恐惧，并狂热地崇拜任何可以提高生产力而不会给自己带来风险的事物。从小处着手，让结果自我推销。

这就是我在以前的公司介绍单元测试和 Wiki 的方式。当结果开始显示人们很快想要参与其中时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T08:38:51.970

告诉他们，如果他们不决定，那么在一小时内你开始每五分钟杀死人质 10 次...

但更重要的是与管理层会面或写一些要求，说明使用解体系统需要多长时间，以及新购买的系统有多么强大和未被充分利用，但在此之前，soem 会分析系统是否真的适合所有当前需求。但要小心你的文字和名字。如果真的发现公司的设备软件未得到充分利用，这对公司的生产力和信息流产生了负面影响，这意味着更少的有价值的工作，即使是负责人也可能因此而堕落。这一切都取决于您的公司在这种情况下的严重程度。

请注意，从一种软到另一种切换并不是一个流畅的过程，人们有自己的习惯和他们习惯的东西，所以你必须在一些步骤中做到这一点，包括逐步向人们介绍新系统

# elisp - 处理来自 elisp 的 http 认证 url

> ID：555917
> 
> 赞同：0
> 
> 时间：2009-02-17T08:28:58.750
> 
> 标签：elisp, redirect, http-authentication

elisp 中是否有一个库可以帮助获取只有在身份验证后才能通过 HTTP 重定向访问的页面数据？我刚刚开始查看 URL 库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T14:46:28.903

虽然不是 elisp 包，但 wget 库是专门为此编写的：[http ://www.gnu.org/software/wget/](http://www.gnu.org/software/wget/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T13:52:48.143

也许[w3m](http://www.emacswiki.org/emacs/emacs-w3m)包中的某些东西可以提供帮助？

# c# - 当我希望它显示为 1000 时，DataGridView 值显示为 1,000

> ID：555920
> 
> 赞同：1
> 
> 时间：2009-02-17T08:29:57.577
> 
> 标签：c#, winforms, datagridview

我有一个`DataGridView`并且我正在将整数写入其中一列，当值> = 1000时，我希望这些值中没有逗号。但是目前，当我输入一个> = 1000的值时，它们以“1,000”的形式出现，逗号在某些区域可能被错误地翻译，所以我希望它只显示为“1000”。是否有任何格式`DataGridViewColumn`可以阻止这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T08:39:30.707

> 逗号在某些区域可能翻译错误

如果您的意思是“某些国家/地区”，那么这是不正确的。您的数字正在根据当前用户区域设置的规则进行格式化，因此一个区域设置中的逗号将成为其他区域中的一个点等。除此之外，将“D”或“d”指定为 DataFormatString 以在没有任何标点符号的情况下对其进行格式化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:37:04.610

这可能会有所帮助：

```
dataGridView1.Columns["NumericColumn"].DefaultCellStyle.Format = "d"; 
```

[如何：格式化 Windows 窗体 DataGridView 控件中的数据](http://msdn.microsoft.com/en-us/library/f9x2790s.aspx)

[标准数字格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

# database - 您是否曾经使用过没有“Relations”、没有“PKs”和没有“FKs”，只有原始数据的数据库？

> ID：555922
> 
> 赞同：2
> 
> 时间：2009-02-17T08:30:05.907
> 
> 标签：database, database-design

如今，我正在研究一个数据库，没有“关系、PK 和 FK”，只有原始数据。我可以说数据库只是一组文件。当我问到这个时，我有这个；“隐藏业务”。

另外，我的一位朋友说，这总是发生在“大型系统”中。

在大型系统中，他们试图通过原始数据隐藏他们的业务。关于发展；关系、约束、验证是在数据库中使用触发器完成的，当然还有用户界面。

您对此有何看法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T10:21:18.417

好吧，当您需要对**大量**( )进行**快速**响应时，这*可能*对大型数据库有意义。 ****`DML``INSERT / UPDATE / DELETE`****

 ****问题是如果你依靠数据库的方式来保证完整性，你很难优化它。

还有一个叫做`SQL/PLSQL context switching`in的东西`Oracle`：如果你在表上创建一个**空**触发器，它会减慢`DML`大约 20 倍 - 仅仅是触发器存在的事实。

在 Oracle 中，当您编写`ON UPDATE`触发器并更新`50,000`表中的行时，触发器和其中的查询会被调用`50,000`次数。外键性能更好，但它们也可能会变得迟钝（你不能对底层查询做任何事情）

在这种情况下，最好将要更新的结果放入临时表中，发出 a `MERGE`，前后检查完整性，并应用业务规则。处理行的单个查询比处理单个行`50,000`的查询循环运行得更快。`50,000`

当然，实现起来非常困难，只有当您拥有*非常*大的数据库并且需要对其执行*非常*大规模的更新时才会为自己买单。

在`Oracle`任何情况下，`FOREING KEY`约束都比实现相同功能的跳闸执行得更好。

`PRIMARY KEYS`很可能会提高性能，因为主键意味着`UNIQUE INDEX`在受约束的字段上创建，并且该索引可以在查询中有效地使用。A`UNIQUE INDEX`也是强制唯一性的一种自然且最有效的方式。

但是，当然，作为任何指数，是减慢`INSERTS`和那些条件不是选择性的。`UPDATES``DELETES``WHERE`

IE。如果你需要`UPDATE`或`DELETE` `1`行`2,000,000`，那么索引就是你的朋友；如果你需要`UPDATE`或`DELETE` `1,500,000`行`2,000,000`，索引就是你的敌人。这是一个权衡的问题。

你也可以[**在这里**](https://stackoverflow.com/questions/543274/is-it-a-best-practise-for-a-database-to-allow-apps-do-crud-operations-always-thro/543503#543503)看到我的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:35:08.297

我会说为了安全而牺牲数据完整性是一种糟糕的交易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T08:37:12.693

我想我遇到了至少两个数据库缺少关系和 FK 的应用程序。

这个想法可能是对出色的数据库模式进行逆向工程更加*困难*。

副作用是应用程序本身通常不太擅长检查约束，导致数据库中存在大量垃圾数据，实际上*这确实*使逆向工程变得更加困难，因为没有强制执行 FK 约束；）

我的观点是，一旦它是一个数据库，其他人就可以查看它，并且考虑到缺点（没有关系、没有 SP、没有触发器等），试图解决这个可见性的“特性”是没有意义的，而且通常不是一件好事）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T08:36:55.360

主键、关系等是使数据库开发更容易并使最终结果更快、更高效的工具。我只能想到一些罕见的情况，没有键/索引是个好主意。

你的朋友有没有解释他们为什么持有这种观点？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T10:34:33.767

这种事情可能发生在金融系统中。这与您所期望的相反，您会认为，因为在金融领域，最佳实践将得到更严格的应用。然而，反过来往往是正确的。这些数据库中的许多可能都是从 excel 开始的。

我见过许多数据库，他们不关心 fks 或 pks。我不能说我喜欢它，但有时你不得不忍受它，或者离开并去其他地方工作，以获得更少的钱，但具有更高的数据库完整性。

也许这就是他们需要你的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T12:05:10.447

（我=MSSQL）

从具有大量 FK 的大表中删除一行很慢。

我们的 APP 从未因该表上的 FK 约束违规而被拒绝删除

我考虑过放弃 FK 以提高性能。

太鸡了，但实际上没有做到:(

PS 我们会将 FK 保留在 DEV / TEST 系统上

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T14:41:20.477

也许这是从以前使用基于文件的结构来保存数据的系统转换而来的。新数据库中的表只是单个文件的反映。

# c++ - 简单的 USB 主机堆栈

> ID：555923
> 
> 赞同：8
> 
> 时间：2009-02-17T08:30:56.840
> 
> 标签：c++, c, embedded, usb

我正在尝试使用 Atmel 处理器上的 USB 主机端口连接到单个 USB 设备。我有一个内存有限且没有操作系统的嵌入式系统。我想实现一个简单的专用主机来连接单个 USB 从设备。

谁能指导我实现一个简单的 USB 主机？

处理器是 Atmel AT91SAM9261S。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T11:29:53.640

首先，如果我没记错的话，AT91SAM9261S板载[OHCI usb 控制器](ftp://ftp.compaq.com/pub/supportinformation/papers/hcir1_0a.pdf)，您至少需要实现简单的主机控制器驱动程序（您可以查看 Linux 实现）。根据您的设备将使用的传输类型，它可能不是很难 - 非常难:) 没有简单的方法来实现 USB 堆栈。实现控制器驱动程序后，您需要注意 USB 设备枚举部分，请参阅[USB 规范](http://mprolab.teipir.gr/vivlio80X86/usb11.pdf)的第 9 章。只有在此之后，您才能开始实现您的设备逻辑。

对于简化的用例，有很多代码可以省略，但是如果没有良好的 USB 背景，很难确定哪些相关，哪些不相关。

如果您正在寻找商业解决方案，[我公司](http://www.jungo.com/st/usbware_embedded_usb_solution.html)可以提供任何方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T16:27:34.877

我使用了On-Time 的[RTUSB-32](http://www.on-time.com/rtusb-32.htm)堆栈。这是一个很小的足迹堆栈，很容易集成到我们的环境中，文档很好。它们很好地抽象出所需的支持，因此它完全是平台和操作系统中立的，并且您需要提供给它的钩子数量相对较少 - 即：它被很好地封装。

由于您获得了所有源代码，您会发现该代码肯定不是世界上结构最完善的代码，但如果需要，无需大量工作即可破译它。无论如何，它基本上“正常工作”没有问题。我们已经让它在一些产品中运行了几年，并且只遇到了一个与堆栈的兼容性问题，它不能完全正确地使用某种类型的 USB 2.0 集线器进行自动发现。我们向他们发送了集线器的样本，他们在几天内就获得了补丁。很难打败它。总的来说，我认为这是一个很好的价值，当然比坐下来从头开始写东西要好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T15:36:35.700

如果您的设备不必是主机，这会容易得多：-P，因为 Atmel 提供了 USB 设备的示例源代码。如果我是你，我会考虑在[Atmel 的 AT91SAM 第三方](http://www.atmel.com/products/at91/thirdparty.asp)页面上使用喜欢 USB 的 RTOS 之一，这可能需要 Ilya 建议的 jungo 的 USB 堆栈。

如果您确实编写了自己的 OHCI 驱动程序，那么[libusb](http://libusb.wiki.sourceforge.net/)作为 USB 堆栈上层的实现可能会有所帮助。

# design-patterns - 最被过度使用的设计示例是什么？如果你有更好的例子，请提供

> ID：555924
> 
> 赞同：3
> 
> 时间：2009-02-17T08:31:34.797
> 
> 标签：design-patterns

当给出重构示例时，我厌倦了看到带有字符串文字的**数据访问层**，用于连接字符串被*IConnectionStringProvider*替换。

例如：

```
public DataSet GetCustomers()
{
    string connectionString = "SQLClient;Blah;Blah";

    using(SqlConnection conn = new SqlConnection(connectionString))
    ... 
```

对此

```
public DataSet GetCustomers()
{
    string coonectionString = connectionStringProvider.GetConnectionString();

    using(SqlConnection conn = new SqlConnection(connectionString))
    ... 
```

在**领域驱动设计**的世界里，我厌倦了看到领域是一个*客户*，他有很多*订单*，也有很多*OrderLineItems*。请用更有趣的东西来解释**聚合根！**

还是我完全失去了它并且重新整理这些简单化是教授这些想法的最佳方式？

哦，使用形状来解释继承......

你用什么例子来教授这些概念？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:13:03.473

我厌倦了看到函数式编程的倡导者展示如何在 Haskell、OCaml、F#、Scheme 等中的一行中实现“快速排序”。他们展示的“快速排序”并不是真正的快速排序，因为它不是交换元素到位，并且正在做各种列表构建和垃圾收集。用函数式语言做一个真正的快速排序真的很麻烦。

让我想知道他们还在撒谎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T08:23:53.230

作为一个做很多手机屏幕的人，我厌倦了听说 Shape 是 Square 和 Circle 的基类。在讨论类层次结构和接口时，我们需要一些更独立的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T08:30:40.250

类工厂/生成器模式。

尤其是许多关于将模式一劳永逸地放入代码中的令人费解的模板填充的文章。我的意思是，是的，它可以做到，这是一个有用的模式，但它不是圣杯。它是一个创建对象的对象。带接口。和参数。和东西。

布拉格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T08:34:18.783

我记得阅读 OOP 时带有 a`Car`或`Bicycle`扩展 a 的示例`Vehicle`，都具有`steer()`- 方法（或类似的东西）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T09:45:29.360

OO 之一是有一个 House 对象，包含几个 Window 对象和一个 Door 对象，太抽象而无用。

是的，与车辆相关的也不是很好。

这里要思考的问题是“我希望阅读本文的人*学到*什么？” 如果您想让人们了解对象和继承，那么请使用有意义的真实示例。

所以一个包含几个按钮对象和一个文本框对象的对话框对象是一个更现实的想法，而且理解起来也并不复杂——每个人都见过一个对话框。然后可以将其细化为通用“窗口”对象，其中按钮、文本框和对话框是子类。

然后，这将方便地导致创建一个真实的、工作的代码，而不是让读者的头脑充满抽象的理论，然后看看他们是否可以在精神上跳跃到现实世界的概念。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T09:00:07.707

我记得 OOP 和数据库设计中的员工、经理示例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T09:13:21.047

Duck.Quack();

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T08:21:40.600

对于 OOP 中的继承，我通常会选择四边形。将其扩展为正方形，矩形，... 将正方形扩展为立方体，将矩形扩展为长方体...

# wcf - Nh.Burrow 与 WCF

> ID：555926
> 
> 赞同：1
> 
> 时间：2009-02-17T08:32:20.520
> 
> 标签：wcf, nhibernate, nhibernate-burrow

在 asp.net 应用程序中实现 Nh.Burrow 后，我想知道如何为 WCF 服务执行此操作。

我的第一个想法是`BurrowFramework().InitWorkSpace();`在每个方法中放置一个，并将 InstanceContextMode 设置为这些方法的每个调用。现在我有两个问题：

1.  有没有更好的方法将 Nh.Burrow 与 WCF 结合起来？
2.  有没有办法通过 WCF 创建和使用 Long Burrow Conversation？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-13T07:42:52.610

查看[nhibernate 插件项目](http://code.google.com/p/unhaddins/)。他们拥有 WCF 集成工具，例如 NhSessionPerCallContextBehavior 以及许多其他有用的东西。

# html - 在另一个 html 表单中包含一个 html 表单是否有效？

> ID：555928
> 
> 赞同：363
> 
> 时间：2009-02-17T08:33:05.573
> 
> 标签：html, web-standards, standards-compliance

具有以下内容的html是否有效：

```
<form action="a">
    <input.../>
    <form action="b">
        <input.../>
        <input.../>
        <input.../>
    </form>
    <input.../>
</form> 
```

因此，当您提交“b”时，您只会获得内部表单中的字段。当您提交“a”时，您会得到所有字段减去“b”中的字段。

如果不可能，有什么解决方法可以解决这种情况？

* * *

## 回答 #1

> 赞同：414
> 
> 时间：2009-02-17T08:44:01.427

A.**它不是有效的 HTML 或 XHTML**

在官方的 W3C XHTML 规范中，第 B 节“元素禁止”规定：

> “表单不得包含其他表单元素。”

[http://www.w3.org/TR/xhtml1/#prohibitions](http://www.w3.org/TR/xhtml1/#prohibitions)

至于较旧的[HTML 3.2 规范](http://www.w3.org/MarkUp/html3/forms.html)，FORMS 元素部分指出：

> “每个表单都必须包含在一个 FORM 元素中。一个文档中可以有多个表单，但 FORM 元素不能嵌套。”

B.**解决方法**

有一些使用 JavaScript 的解决方法，无需嵌套表单标签。

**“如何创建嵌套表单。”** （尽管标题这*不是*嵌套的表单标签，而是一种 JavaScript 解决方法）。

[这个 StackOverflow 问题的答案](https://stackoverflow.com/questions/1759006/embed-an-html-form-within-a-larger-form)

**注意：** *虽然可以通过脚本操作 DOM 来欺骗 W3C 验证器来传递页面，但它仍然不是合法的 HTML。使用这种方法的问题在于，现在无法保证跨浏览器的代码行为。（因为它不是标准的）*

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-05-31T12:42:42.447

如果有人在这里发现这篇文章是一个很好的解决方案，而不需要 JS。使用两个具有不同名称属性的提交按钮检查您的服务器语言中哪个提交按钮被按下，因为只有其中一个将被发送到服务器。

```
<form method="post" action="ServerFileToExecute.php">
    <input type="submit" name="save" value="Click here to save" />
    <input type="submit" name="delete" value="Click here to delete" />
</form> 
```

如果您使用 php，服务器端可能看起来像这样：

```
<?php
    if(isset($_POST['save']))
        echo "Stored!";
    else if(isset($_POST['delete']))
        echo "Deleted!";
    else
        echo "Action is missing!";
?> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2010-05-13T21:59:15.327

HTML 4.x 和 HTML5 不允许嵌套表单，但 HTML5 将允许使用“表单”属性（“表单所有者”）的解决方法。

对于 HTML 4.x，您可以：

1.  使用仅包含隐藏字段和 JavaScript 的额外表单来设置其输入并提交表单。
2.  使用 CSS 将几个 HTML 表单排列成一个单一的实体——但我认为这太难了。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-17T08:47:29.127

正如其他人所说，它不是有效的 HTML。

听起来您这样做是为了在视觉上定位表单。如果是这种情况，只需做两个单独的表单并使用 CSS 来定位它们。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-17T08:37:07.827

不，HTML 规范声明任何`FORM`元素都不应包含另一个`FORM`元素。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-02-27T17:19:24.470

一种可能性是在外部表单内有一个 iframe。iframe 包含内部表单。确保使用`<base target="_parent" />`iframe 的 head 标签内的标签来使表单作为主页的一部分。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-17T08:39:43.857

而是在表单的 action 属性中使用自定义 javascript 方法！

例如

```
<html>
    <head>
        <script language="javascript" type="text/javascript">
        var input1 = null;
        var input2 = null;
        function InitInputs() {
            if (input1 == null) {
                input1 = document.getElementById("input1");
            }
            if (input2 == null) {
                input2 = document.getElementById("input2");
            }

            if (input1 == null) {
                alert("input1 missing");
            }
            if (input2 == null) {
                alert("input2 missing");
            }
        }
        function myMethod1() {
            InitInputs();
            alert(input1.value + " " + input2.value);
        }
        function myMethod2() {
            InitInputs();
            alert(input1.value);
        }
        </script>
    </head>
    <body>
        <form action="javascript:myMethod1();">
            <input id="input1" type="text" />
            <input id="input2" type="text" />
            <input type="button" onclick="myMethod2()" value="myMethod2"/>
            <input type="submit" value="myMethod1" />
        </form>
    </body>
</html> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-17T08:41:17.877

您可以通过将 HTML 代码输入[W3 Validator](http://validator.w3.org/#validate_by_input)来非常轻松地回答您自己的问题。（它具有文本输入字段，您甚至不必将代码放在服务器上......）

（不，它不会验证。）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-17T08:37:33.270

不，请参阅[w3c](http://www.w3.org/TR/html401/interact/forms.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-08-06T17:41:41.813

不，它无效。但是一个“解决方案”可以在包含表单“b”的表单“a”之外创建一个模式窗口。

```
<div id="myModalFormB" class="modal">
    <form action="b">
        <input.../>
        <input.../>
        <input.../>
        <button type="submit">Save</button>
    </form>
</div>

<form action="a">
    <input.../>
    <a href="#myModalFormB">Open modal b </a>
    <input.../>
</form> 
```

如果您使用引导程序或物化 css，则可以轻松完成。我这样做是为了避免使用 iframe。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-07-31T09:50:04.657

作为解决方法，您可以[`formaction`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/submit#formaction)在提交按钮上使用属性。并且只需在您的输入上使用不同的名称。

```
<form action="a">
<input.../>
    <!-- Form 2 inputs -->
    <input.../>
    <input.../>
    <input.../>
    <input type="submit" formaction="b">

</form>
<input.../> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-01T00:02:34.410

# 嵌套表单标签的非 JavaScript 解决方法：

因为你允许

> 所有字段减去“b”内的字段。

提交“a”时，以下内容将起作用，使用常规 Web 表单，无需花哨的 JavaScript 技巧：

步骤 1\. 将每个表单放在自己的网页上。

步骤 2\. 在您希望此子表单出现的任何位置插入 iframe。

步骤 3\. 利润。

我尝试使用 code-playground 网站来展示演示，但他们中的许多人禁止将他们的网站嵌入 iframe，即使在他们自己的域中也是如此。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-30T15:31:28.730

您正在尝试实现**HTML 不支持的**嵌套表单。

> 每个表单都必须包含在一个 FORM 元素中。一个文档中可以有多个表单，但 FORM 元素不能嵌套。

**解决方法**

您可以通过对 HTML 和 JavaScript 进行一些更改来实现此功能。（不使用 html 表单）

步骤1\. 使用***div***
*标签创建两个表单，如下所示（不要使用**表单**标签）*

 ****```
<div id="form_a">
 <input.../>
     <div id="form_b">
        <input.../>
        <input.../>
        <button id="submit_b">Submit B</button>
     </div>
 <input.../>
 <button id="submit_a">Submit A</button>
</div > 
```

*2.添加JQuery和Ajax提交各个表单数据*

```
 <script>
    // Submit form A data
    $('#submit_a').click( function() {
          $.ajax({
            url: 'ajax-url',
            type: 'post',
            dataType: 'json',
            data: $('#form_a input').not( "#form_b input" ).serialize(),
            success: function(data) {
                       // ... do something with the data...
                     }
        });
        });

   // Submit form B data
    $('#submit_b').click( function() {
          $.ajax({
            url: 'ajax-url',
            type: 'post',
            dataType: 'json',
            data: $('#form_b input').serialize(),
            success: function(data) {
                       // ... do something with the data...
                     }
        });
        });
    </script> 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-09-24T15:17:41.297

如果您需要表单将数据提交/提交到 1:M 关系数据库，我建议在表 A 上创建一个“插入后”数据库触发器，该触发器将为表 B 插入必要的数据。

# c# - C#：对象的内存使用情况

> ID：555929
> 
> 赞同：5
> 
> 时间：2009-02-17T08:33:07.647
> 
> 标签：c#, memory, memory-management

有没有办法找到特定对象使用了多少内存？例如一个列表。考虑到一切，比如字符串实习和编译器/运行时环境/其他任何事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T09:20:05.023

[ANTS Memory Profiler](http://www.red-gate.com/products/ants_memory_profiler/index.htm)分析 .NET 代码的内存消耗。过去我用它取得了很好的成绩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:39:10.910

您确实必须*准确*定义“特定对象使用了多少内存”的含义。例如，您可以表示“如果该对象被垃圾回收，将释放多少内存” - 或者您可以表示“该对象及其所接触的所有内容占用了多少内存”。

您关于字符串实习的观点就是一个很好的例子。假设你这样做：

```
List<string> internedStrings = new List<string>();
List<string> nonInternedStrings = new List<string>();
for (int i=0; i < 1000; i++)
{
    string tmp = new string(' ', i+1);
    nonInternedStrings.Add(tmp);
    tmp = tmp.Intern();
    internedStrings.Add(tmp);
} 
```

`nonInternedStrings`真的会占用更多的内存吗`internedStrings`？如果`internedStrings`被垃圾收集，它不会释放尽可能多的内存 - 但如果`internedStrings`从未*创建*过（包括不实习它的每个元素），那么永远不需要更多的内存。

如果您可以更具体地说*明*您的意思，我们或许可以为您提供帮助。虽然这是一个复杂的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T09:17:56.480

这似乎是这个[Delphi question](https://stackoverflow.com/questions/482604/recursive-class-instance-size-in-delphi/482643#482643)的兄弟。天真的算法不会考虑聚合和组合之间的差异。即使是基于标记和扫描的算法也不会告诉您哈希表是否必须增长其内部数组，因为它引用了一个对象。您可能最好针对各种场景分析您的应用程序并根据 N 绘制资源使用情况，其中 N 是数据集规模的某种度量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T08:36:28.030

您是否尝试过 CLR Profiler 2.0？

# regex - using RegExp to split string but store whitespace (space or crlf) to items

> ID：555939
> 
> 赞同：0
> 
> 时间：2009-02-17T08:36:43.707
> 
> 标签：regex, actionscript-3, flex3

sample input (orgtext = a[crlf]b[space]c[crlf] )

I like to store each word a,b, c to the words array with the original suffix crlf or space. Currently calling SPLIT drops the suffix as its separator, but I like to store separator as well. Can I adjust regexp to return also suffix and still split?

```
Words = new Array; 
var ar: Array = orgtext.split( /\s+/  );   

for (var i:int = 0; i<ar.length;i++ )
{
Words.push(  ar[i] +"suffix here" ); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T08:42:46.767

Generally you would use keep calling [exec](http://livedocs.adobe.com/flex/3/langref/RegExp.html#exec()) with an expression that uses the global (g) so that the [lastIndex](http://livedocs.adobe.com/flex/3/langref/RegExp.html#lastIndex) will be set.

```
var input : String = "asd asd asd asd";
var output : Array = new Array();

var expr : RegExp = /[^\s]+(?:$|\s+)/g;
var result : Object = expr.exec(input);

while(result != null)
{
    input.push(result[0].toString());
    result = expr.exec(input);
} 
```

Depending on the number of matches you can expect, it might be faster to use...

```
([^\s]+(?:$|\s+))+ 
```

... which will capture all possible matches in one exec(). The matches will be available in result[1] ... result[n]

# .net - 您使用哪个 .NET 依赖注入框架？

> ID：555943
> 
> 赞同：5
> 
> 时间：2009-02-17T08:37:04.517
> 
> 标签：.net, frameworks, dependency-injection, inversion-of-control

目前有很多 .NET 的 DI/IoC 框架（[http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)）。我觉得很难选择。所以我想衡量一下舆论，看看哪个框架最受欢迎——所以请把你最喜欢的框架贴在这里，让人们投票...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T08:40:39.110

我目前正在使用[Castle.Windsor](http://www.castleproject.org/container/index.html)。主要是因为它与 Rhino 工具库的集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T08:41:46.410

我一直在观看 Kzu（Moq 的创建者）在开发[Funq 时的](http://funq.me)[截屏系列](http://www.clariusconsulting.net/blogs/kzu/archive/2009/02/02/116399.aspx)- 一个 DI 框架，它以与 Moq 相同的方式广泛使用 lambda。还没有发布，但我期待着尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T08:45:00.847

结构图

我喜欢这样一个事实，即我可以使用流畅的界面（又名配置 DSL）来配置它。当我进行重构时，类型安全配置是必须的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T09:13:38.783

[自动法](http://code.google.com/p/autofac/)。类型安全并且与代码重构配合得很好。除了样板的东西，我发现代理工厂非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:38:28.010

使用[Windsor](http://www.castleproject.org/container/index.html)或 Unity，并根据 POC 决定

到目前为止，Unity 并没有那么臃肿，您可以根据您的项目类型使用它 - 特别是如果您使用的是 CompositeWPF 等依赖于统一的框架

请参阅 SO 上的另一个线程，[Enterprise Library Unity vs Other IoC Containers](https://stackoverflow.com/questions/411660/enterprise-library-unity-vs-other-ioc-containers/552237)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T08:39:40.860

看看[Structuremap](http://docs.structuremap.net/)，它是 .Net 的依赖注入/控制反转工具

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T09:21:15.550

**[Unity](http://www.codeplex.com/unity)** 它简单且不打扰，但类型安全。它是由*微软模式与实践*组创建的。

# javascript - 调试 IE8 Javascript 替换 innerHTML 运行时错误

> ID：555965
> 
> 赞同：17
> 
> 时间：2009-02-17T08:42:13.227
> 
> 标签：javascript, debugging, innerhtml

```
function DeleteData(ID)
{
 var ctrlId=ID.id;

 var divcontents=document.getElementById(ctrlId).innerHTML;
 var tabid=ctrlId.replace(/div/,'tab');
 var tabcontents=document.getElementById(tabid).innerHTML;
 alert(document.getElementById(tabid).innerHTML);
 document.getElementById(tabid).innerHTML="<TBody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr></TBody>";
 document.getElementById(ctrlId).innerHTML='';

} 
```

我正在尝试用空表替换表，但是

```
document.getElementById(tabid).innerHTML="<TBody><tr><td></td></tr><tr><td></td></tr><tr><td></td></tr></TBody>"; 
```

这条线导致`Unknown Runtime Error`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-17T09:02:04.583

您不能为表格的 innerHTML 设置值，您应该访问子单元格或行并像这样更改它们：

```
document.getElementById(tabid).rows[0].cells.innerHTML = 'blah blah'; 
```

有关更多信息/示例：[Table、TableHeader、TableRow、TableData 对象](http://www.w3schools.com/JS/js_examples_3.asp)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-11-03T03:42:59.620

在 IE8 中，当尝试从对象内触发的代码时，您无法更改对象的 innerHTML。

例如：

```
<span id='n1'>
  <input type=button value='test' onclick='DoSomething(this);'>
</span> 
```

将以下代码隐藏在文档的某个偏远角落：

```
<script type='text/javascript'>
  function DoSomething(element)
  {
    document.getElementById("n1").innerHTML = "This is a test"
  }
</script> 
```

这将失败并出现错误未知的运行时错误。我相信这与您试图替换触发当前执行行的 HTML 代码这一事实有关。onclick 事件是被 DoSomething 函数替换的代码的一部分。IE8 不喜欢这样。

我通过将计时器事件设置为 250 毫秒解决了我的问题，这样在 250 毫秒结束时调用的函数将替换 span 的 innerHTML。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-02-09T10:06:46.953

我发现在 IE8 中某些元素是只读的：COL、COLGROUP、FRAMESET、HEAD、HTML、STYLE、TABLE、TBODY、TFOOT、THEAD、TITLE、TR。

因此，如果您尝试为这些元素设置 innerHTML，IE8 会使用 Unknown Runtime Error 通知 alter。

更多细节在这里：http: [//msdn.microsoft.com/en-us/library/ms533897%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms533897%28VS.85%29.aspx)。

最简单的方法是将只读元素转换为 div 元素。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-08T21:22:03.210

我遇到了同样的问题，但我的错误是因为我在元素`p`下面直接插入了一个标签，如下所示`p`：

```
document.getElementById('p-element').innerHTML = '<p>some description</p>'; 
```

我真的不明白这是 HTML 格式错误；似乎更像是另一个 IE8 错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-23T22:53:08.873

太好了，我在设置`innerHTML`. 当我读到这篇文章时，我意识到其中一个元素是 a`TR`并且一个是 a`TD`并且`TD`正在工作。

更改代码以使它们都可以`TD`修复它，这意味着这是由表结构引起的一个相当不明显的问题。

据推测，当我开始更改表行时，它会使 DOM 出错，因为它不能再将表存储为数组。

我确信 IE 可以提供更多信息的错误消息，因为 DOM 动态更改并不少见，而且这只会引发表错误似乎很奇怪。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-07T14:29:47.423

哦，是的 - 请记住 HTML 结构必须有效。

我尝试将整个页面加载到`<p>`标签中 - 它失败（显然），将其更改为`<div>`标签解决了我的问题！

所以记住 HTML 结构！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-11T23:20:06.430

为什么它发生在IE中...

案例场景：

访问 Div 中的 Div 以添加 ajax 内容时，IE 中的 Javascript 未知运行时错误。

解决方案：

永远不要在表单标签之间放置嵌套的 div 来播放内容.. :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-09T15:48:53.967

使用 YUI 时尝试使用

```
Y.one('#'+data.id).setContent(html); 
```

代替：

```
Y.one('#'+data.id).set('innerHTML' , html); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-01T16:27:47.903

如果您需要将 innerHTML 设置为 "" （空字符串），那么您可以使用 removeChild

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-22T18:51:10.287

这不是一个大问题，因为几天前我遇到了同样的问题，这个错误发生在 ie 中的原因是 - 我们的 html 格式存在错误，或者您使用的元素不是`<td>`替换 innerHTML 即仅使用，不要使用表格、div 替换 innerHTML。

*   SwapnilK

# java - 在 45 天（左右）内从 PHP/Ajax 切换到 Java

> ID：555971
> 
> 赞同：1
> 
> 时间：2009-02-17T08:44:27.900
> 
> 标签：java, php

由于我们即将开始的新项目的性质，我需要很快进入 Java 世界。

我有大约 8 年的 PHP 经验和大约 3 年的 Javascript 经验。（CI、Kohana 和我自己的 MVC 框架）

我对 OOP 有扎实的了解（尽可能多地从 PHP/JS 和少量的 ActionScript 和 python 中获得）

因此，我没有从头开始学习，而是考虑使用一些 Web 框架（最后，项目将基于 Web）并在此过程中学习 Java。Java 代码本身并不太奇怪，而且我对 php 中的 MVC 有丰富的经验，所以整个概念对我来说很有意义。

**因此，我正在查找有关如何学习 Java 的说明列表。**

（并且不要在不那么重要的事情上花费太多时间）

你也可以建议框架，从我所见，struts 看起来不错，spring 也是，但它接缝它有太多的 XML 配置......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T09:12:34.637

从一本好书开始。我一直发现 T[在 Java 中的思考](http://mindview.net/Books/TIJ4)非常好，此外还有免费的在线版本可用。跳过你已经知道的事情。好吧，您可能知道对象是什么等等...

接下来要学习使用好的 IDE。看看 Netbeans、IntelliJ IDEA 或 Eclipse。没有合适的 IDE 的 Java 是没有用的。

如果你从 PhP 过渡，你可能会开发一些 Web 应用程序？这是一个陡峭的学习曲线。JavaEE 庞大而复杂，深入研究所有这些框架需要一段时间。可能您最终会说“为什么这么复杂，我可以在 PhP 中更轻松地做到这一点”。你是对的。

无法为您推荐最适合您的框架。我们使用Seam + Richfaces。没那么难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T17:16:48.513

如果您正在从 PHP 转换并查看 Web 框架，那么我假设您打算继续使用 Java 进行 Web 开发。在这种情况下，我会花一点时间在[Java Tutorials](http://java.sun.com/docs/books/tutorial/)上，然后读一本关于 Java Web 编程的书，比如[Head First Servlets 和 JSP](http://oreilly.com/catalog/9780596005405/)。我认为它会比关于 Java 语言的更一般的书籍更关注你需要的东西。

[![HFS&JSP](https://i.stack.imgur.com/WwFzr.gif)](https://i.stack.imgur.com/WwFzr.gif)
[（来源：[oreilly.com](http://oreilly.com/catalog/covers/9780596005405_cat.gif)）]

我还发现，一旦您学习了 servlet、JSP 和 JSTL 的基础知识，就会更容易理解任何不同的基于 Java 的 Web 框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T09:08:04.537

它们都不再需要大量的 XML 配置，那是过去的事了。

无论如何，我会建议你掌握 Java 概念。正如您所说，抓住一本好的 Java 书籍来学习它。[用 Java 思考](https://rads.stackoverflow.com/amzn/click/com/0131872486)很好，但它只是关于核心 Java 和概念。对于 java web，您可能想了解 Servlet 和 JSP basic，您可以使用 Sun 的官方 J2EE 教程来学习。

对于 Java Web 框架，有很多。但我会建议你一些你已经熟悉的东西。你是对的基于 MVC 的 Java 框架。Struts 和 Spring 都是 MVC 框架，并为您提供了清晰的层分离。Spring 本身就是一个巨人，它几乎可以解决所有问题，一开始可能会让你感到困惑。Struts 1 已经过时，Struts 2 的竞争非常激烈。

我建议您查看[Wicket](http://wicket.apache.org/)。它只是一个 Web 框架，与 Spring 不同，而且编写得非常好且易于掌握。

我必须说，这是一项艰巨的任务。让我们看看其他有什么推荐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T09:22:27.763

好点，努米。我建议使用 Netbeans，它更直观、更时尚。

IntelliJ 很棒，但它是商业的而不是免费的。

Eclipse 不是我喜欢的类型，很多其他人对此非常满意。你可能会觉得它也很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T09:46:27.970

> 因此，我正在查找有关如何学习 Java 的说明列表。（并且不要在不那么重要的事情上花费太多时间）

我喜欢 Head First Java，但我知道有些人觉得这种格式令人反感，有经验的程序员可能会觉得它有点简单，同一作者 (Kathy Sierra) 的 SJCP 学习指南在保持俏皮语气的同时更深入。当然还有在线[Java 教程](http://java.sun.com/docs/books/tutorial/)，您可以在其中快速了解平台的主要部分。一旦你掌握了基础知识，Effective Java 就是一本很好的“最佳实践”书。

> 你也可以建议框架，从我所见，struts 看起来不错，spring 也是，但它接缝它有太多的 XML 配置......

我再次投票支持 Wicket 作为 Web 框架。对于持久性/数据库部分，我建议您在尝试 Hibernate 之前查看 iBatis。这是一个面向“sql 查询”的框架，而不是对象关系映射，因此您可能会感觉更熟悉。我自己还没有使用过它，但据我所知，它的“陷阱”（关于缓存、性能等）也可能比 Hibernate 少。

# php - 如何在 PHP 中的数组中查找字符串？

> ID：555975
> 
> 赞同：10
> 
> 时间：2009-02-17T08:46:02.077
> 
> 标签：php, arrays

我有一个数组：

```
$array = array("apple", "banana", "cap", "dog", etc..) up to 80 values. 
```

和一个字符串变量：

```
$str = "abc"; 
```

如果我想检查这个字符串（`$str`）是否存在于数组中，我使用`preg_match`函数，它是这样的：

```
$isExists = preg_match("/$str/", $array);

if ($isExists) {
    echo "It exists";
} else {
    echo "It does not exist";
} 
```

这是正确的方法吗？如果数组变大，会不会很慢？还有其他方法吗？我正在尝试缩减我的数据库流量。

如果我有两个或多个字符串要比较，我该怎么做？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-17T08:49:02.883

```
 bool in_array  ( mixed $needle  , array $haystack  [, bool $strict  ] ) 
```

[http://php.net/manual/en/function.in-array.php](http://php.net/manual/en/function.in-array.php)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T08:49:37.110

如果您只需要完全匹配，请使用[in_array](http://php.net/in_array) ($str, $array) - 它会更快。

另一种方法是使用以字符串为键的关联数组，这应该在对数上更快。毫无疑问，您会发现它与只有 80 个元素的线性搜索方法之间存在巨大差异。

如果您*确实*需要模式匹配，那么您需要遍历数组元素以使用 preg_match。

* * *

您编辑了问题以询问“如果要检查多个字符串怎么办？” - 你需要遍历这些字符串，但是一旦你没有匹配到你就可以停止......

```
$find=array("foo", "bar");
$found=count($find)>0; //ensure found is initialised as false when no terms
foreach($find as $term)
{
   if(!in_array($term, $array))
   {
        $found=false;
        break;
   }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T09:00:32.900

preg_match 需要字符串输入而不是数组。如果您使用您描述的方法，您将收到：

> 警告：preg_match() 期望参数 2 是字符串，在第 X 行的 LOCATION 中给出的数组

你想要 in_array：

```
if ( in_array ( $str , $array ) ) {
    echo 'It exists';
} else {
    echo 'Does not exist';
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T08:52:02.877

为什么不使用内置函数 in_array？( [http://www.php.net/in_array](http://www.php.net/in_array) )

preg_match 仅在寻找另一个字符串中的子字符串时才有效。（[来源](http://www.php.net/manual/en/function.preg-match.php)）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T09:16:32.473

如果您有多个值，则可以分别测试每个值：

```
if (in_array($str1, $array) && in_array($str2, $array) && in_array($str3, $array) /* … */) {
    // every string is element of the array
    // replace AND operator (`&&`) by OR operator (`||`) to check
    // if at least one of the strings is element of the array
} 
```

或者您可以对字符串和数组进行[交集：](http://docs.php.net/array_intersect)

```
$strings = array($str1, $str2, $str3, /* … */);
if (count(array_intersect($strings, $array)) == count($strings)) {
    // every string is element of the array
    // remove "== count($strings)" to check if at least one of the strings is element
    // of the array
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-12T17:17:35.547

函数 in_array() 仅检测数组元素的完整条目。如果您希望检测数组中的部分字符串，则必须检查每个元素。

```
foreach ($array AS $this_string) {
  if (preg_match("/(!)/", $this_string)) {
    echo "It exists"; 
  }
} 
```

# java - Joptionpane 弹出窗口

> ID：555977
> 
> 赞同：0
> 
> 时间：2009-02-17T08:46:34.340
> 
> 标签：java, multithreading, core

我正在从串行端口读取数据，因为我创建了一个窗口。当我单击连接按钮时，我会看到另一个窗口显示消息为“已连接”并带有 ok 选项，同时数据开始出现，但它不会转储，直到我单击前窗口的确定按钮，我想在不单击前窗口的确定按钮的情况下转储数据，我该怎么做，请帮助我。

谢谢您的回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T08:51:08.523

您需要在与用于显示对话框的线程不同的线程中从串行端口读取数据。我建议阅读Sun[的 Swing 中的并发](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/)课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T09:56:18.167

JOptionPane 是一个模态对话框，无法调整。模态对话框阻塞调用线程。

如果您不想创建另一个线程（这似乎确实是最好的方法），您必须使用 JDialog 类创建自己的对话框窗口。

您可以观看[JDialog 教程](http://java.sun.com/docs/books/tutorial/uiswing/components/dialog.html)。

# open-source - 发布开源项目的最佳实践是什么？

> ID：555982
> 
> 赞同：4
> 
> 时间：2009-02-17T08:47:38.813
> 
> 标签：open-source, release, release-management

我们有一个非常酷的小型 Web 框架，我们已在数十个客户项目中成功使用它。我们计划将此软件发布到社区。但是，我正在为新的开源软件项目页面上应该/不应该做什么而绞尽脑汁。网站必须具备的东西是什么？文档？一个维基？有下载链接吗？还有什么？

而且，一个相关但可能不同的问题是我们如何开始标记版本号。我们在内部使用的只是 SVN 标记。有没有一种好方法来确定何时开始调用 0.9 版本与 1.0 和 1.1 等等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T08:56:45.453

您可以了解开源项目托管站点所提供的要求：

*   作为该项目的“一站式商店”的网站
*   文档，可能是 wiki 形式
*   允许浏览、匿名签出以及经过身份验证和授权提交的源存储库
*   问题跟踪和新功能请求

至于版本号......我认为还没*有人*想出最好的方法:) 考虑到最低限度，我会考虑：

*   v1.0 应该可以用于生产了
*   主要版本号更改可能会完全失去向后兼容性（如有必要 - 虽然这几乎不是目标！）
*   次要版本号更改通常应该大部分兼容 - 弃用可能比删除/重命名 API 位更好
*   小于次要版本号的更改应仅包括次要功能添加（如果有）和错误/性能修复

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-26T15:13:43.803

关于版本控制，我认为绝对最好的起点是[Semantic Versioning](http://semver.org)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T08:56:17.310

0.9 / 1.0 / 1.1 / 1.0.1 / ... 版本标签仅用于营销目的（在良好的意义上）。这允许您的用户/客户确定该版本是主要、次要还是错误修复，以及您是否认为它已经成熟。

交付的最低限度是来源。其他可交付成果取决于您愿意如何帮助您的用户并为他们提供支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T09:03:53.563

首先选择一个网站来托管源代码（例如，SourceForge）。在带有匿名签出的版本控制系统上获取源代码。在那里获取一个电子邮件地址，以便人们与您联系。

将此第一个版本称为 0.1。这是因为您还没有支持该项目的文档。

然后呼吸。

然后开始查看文档，例如 wiki。一旦你在基本的细节层面上涵盖了所有内容，并且你相信该版本已经准备好迎接黄金时段，然后转移到 1.0，并开始提供二进制下载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T10:46:48.327

确保您考虑源的许可证。

当我查看一个开源项目时，我检查的第一件事就是许可证。如果许可证不是 GPL2/GPL3/BSD 风格或类似的，那对我来说是一个消极因素。

许可证意味着人们将用它做什么，它如何发展，以及它由发布它的公司拥有多少。通过选择开源我尽量不依赖公司（他们依赖于他们的股东），我真的选择使用真正免费的软件。

由于开源社区对企业权力非常敏感（Google 目前似乎对此有点免疫），因此您确实必须确保在您的网站和您发布的有关该软件的其他材料上传递**真正免费的信息。**

查看更多关于FSF 的[自由软件](http://www.gnu.org/philosophy/free-sw.html)和[开源](http://www.gnu.org/philosophy/open-source-misses-the-point.html)定义的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T09:02:38.980

看看 GitHub 或 Google Code。它们为自己的开源项目提供了一个很好的起点。您可以描述您的项目，在 wiki 中记录，使用 git 或 svn 作为您的存储库，并提供下载以及问题跟踪和多开发人员管理。开箱即用的好环境，可以从中学习和使用它们。

对于发布号：我不推荐 0.9 或类似的预发布版本。原因？1.9版怎么样？它是主要版本 1 的第 9 个子版本还是版本 2 的最后一个预发布版本？我的发布标准在这里描述：[http](http://code.google.com/p/tideland-eas/wiki/ReleaseStandard) ://code.google.com/p/tideland-eas/wiki/ReleaseStandard 。我正在使用三数字方案，主要、次要和修复，以及状态代码、alpha、beta、gamma 和发布日期。所以我能够轻松地并行处理多个版本。

希望这可以帮助。

缪************``*******`**