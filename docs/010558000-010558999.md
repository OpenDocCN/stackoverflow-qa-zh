# StackOverflow 问答 10558000-10558999

# c# - 文本字段默认值覆盖用户输入

> ID：10558001
> 
> 赞同：0
> 
> 时间：2012-05-11T20:12:52.840
> 
> 标签：c#, asp.net

我正在为我的文本字段设置一些默认值，并且这些字段处于只读模式。当我将新值传递给这些字段并提交表单时，它保存了默认值而不是新值。我使用了 PostBack 功能，但它不起作用。这是我的代码，

```
protected void Page_Load(object sender, EventArgs e)
    {
      if (! this.IsPostBack)
       {
           MakeReadControl();
       }
    }

    private void MakeReadControl()
    {
            ((TextBox)this.FindControl("txtMedicalCheckup")).Text = System.DateTime.Now.ToShortDateString();
            ((TextBox)this.FindControl("txtBosiet")).Text = System.DateTime.Now.ToShortDateString();
            ((TextBox)this.FindControl("txtLandSurvival")).Text = System.DateTime.Now.ToShortDateString();
            ((TextBox)this.FindControl("txtDefensiveDriving")).Text = System.DateTime.Now.ToShortDateString();
            ((DropDownList)this.FindControl("comboDrivingLicense")).SelectedIndex = 1;
            ((TextBox)this.FindControl("txtOtherLicense")).Text = "Not available";
    } 
```

但是，下拉列表会正确更新该值。

**更新：-**

如果我使用启用属性而不是只读属性，那么它可以正常工作。

# haskell - 如何获取 utf8 RSS 提要？

> ID：10558003
> 
> 赞同：1
> 
> 时间：2012-05-11T20:13:18.133
> 
> 标签：haskell, utf-8, rss

我正在尝试将包[RSS](http://hackage.haskell.org/package/feed)与 UTF8 字符串一起使用，但无济于事。（我不想使用有效的 HXT，我只想了解我错在哪里）

在 ghci 中，当我输入“test”时，我只会得到带有“é”等字符的垃圾。

如果我从读取文件中获取字符串`UTF8.readFile`并将其发送给它`parseFromString`可以工作，但是当我下载并使用`getRespBody`它时不会。

这是我的示例代码：

```
import Network.HTTP                   (simpleHTTP,  getRequest, getResponseBody)
import Data.Maybe (fromJust)
import Text.Feed.Import (parseFeedString)
import Text.RSS.Syntax 
import Text.Feed.Types (Feed(..))
import Prelude hiding (putStrLn)
import Data.ByteString.Char8 (putStrLn)
import Data.ByteString.UTF8 (fromString)

siteUrl  =  "http://radiofrance-podcast.net/podcast09/rss_11549.xml"

type Links = [(String,String,String)]

-------------------------------------------------------------------------------
--   Main function 
-------------------------------------------------------------------------------

test = getLinks siteUrl >>= mapM_ (putStrLn.fromString) 

-------------------------------------------------------------------------------
--     Retrieve titles
-------------------------------------------------------------------------------

getLinks:: String -> IO [String]
getLinks url = simpleHTTP (getRequest url) >>= getResponseBody >>= parseDoc 

parseDoc d = do
 let RSSFeed rss = (fromJust . parseFeedString ) d 
    items = rssItems.rssChannel $ rss
    titles = map (fromJust.rssItemTitle)    items
 return $  titles 
```

* * *

**更新**：感谢罗马的回答，我修改了我的代码。这是任何可能感兴趣的人的修改。

```
import Codec.Binary.UTF8.String       (decodeString)  -- <-- added

getLinks:: String -> IO [String]
getLinks url = simpleHTTP (getRequest url) >>= getResponseBody >>= parseDoc.decodeString -- <-- modified 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T22:31:15.583

`simpleHTTP`可能返回基于响应的事实`String`有点令人困惑。实际上，它们不是 Unicode 字符串，而是按原样包含 HTTP 响应的字节字符串。没有进行自动解码。

因此，您需要在将 http 响应传递给解析函数（例如，使用`encoding`or`utf8-string`包）之前对其进行解码。

您可能希望从`Content-Type`http 标头或 RSS 文档本身中提取源编码信息。

# c# - 使用正则表达式过滤字符串列表但使用通配符（* 和？）？

> ID：10558013
> 
> 赞同：0
> 
> 时间：2012-05-11T20:14:06.670
> 
> 标签：c#, regex

我想知道是否可以修改使用的通配符表达式`*`并将`?`其转换为正则表达式以验证它是否与某些字符串匹配。

换句话说，如果我`*bl?e*`在这些字符串上使用过滤器（不区分大小写）：

```
["Blue", "Black", "Red", "Light blue", "Light black"] 
```

我想得到：

```
["Blue, "Light blue"]. 
```

有人知道如何用正则表达式做到这一点吗？除了使用正则表达式之外，还有更好的方法吗？

> 添加以更好地阐明我的想法...

行！...与往常一样，我以为我提出了一个非常明确的问题，并通过答案意识到我完全搞砸了我的问题。我想做一个函数，它会根据与 dos ('*' '?') 相同的规则的表达式（作为我的函数的参数）过滤集合。我认为使用正则表达式是个好主意。我是对的吗，正则表达式是什么？另外......我正在使用 C#，我想知道我是否无法访问任何可以直接完成这项工作的东西？

我还看看（相当好的答案）[如何在 ac# regex 语句中指定通配符（对于任何字符）？](https://stackoverflow.com/questions/3034535/how-do-i-specify-a-wildcard-for-any-character-in-a-c-sharp-regex-statement)

我终于在 .net Patterns and Practices 库中使用了 Glob 类。

但作为参考，这是我将 Glob exp 转换为 RegEx 的代码：

```
using System.Text;
using System.Text.RegularExpressions;

namespace HQ.Util.General
{
    public class RegexUtil
    {
        public const string RegExMetaChars = @"*?(){}[]+-^$.|\"; // Do not change the order. Algo depends on it (2 first chars should be dos like wildcard char)

        // ******************************************************************
        /// <summary>
        /// Convert an filter expression with '*' (wildcard any char) and '?' (wildcard on char) into a valid regex and
        /// strip any special regex character
        /// </summary>
        /// <param name="dosLikeExpressionFilter"></param>
        /// <returns></returns>
        public static string DosLikeExpressionFilterToRegExFilterExpression(string dosLikeExpressionFilter)
        {
            StringBuilder regex = new StringBuilder();
            regex.Append("(?i)"); // Case insensitive

            int startIndex = 0;
            int count = dosLikeExpressionFilter.Length;
            while (startIndex < count)
            {
                int metaIndex = RegExMetaChars.IndexOf(dosLikeExpressionFilter[startIndex]);
                if (metaIndex >= 0)
                {
                    if (metaIndex == 0)
                    {
                        regex.Append(".*");
                    }
                    else if (metaIndex == 1)
                    {
                        regex.Append(".");
                    }
                    else
                    {
                        regex.Append("\\");
                        regex.Append(dosLikeExpressionFilter[startIndex]);
                    }
                }
                else
                {
                    regex.Append(dosLikeExpressionFilter[startIndex]);
                }
                startIndex++;
            }

            return regex.ToString();
        }

        // ******************************************************************
        /// <summary>
        /// See 'DosLikeExpressionFilterToRegExFilterExpression' description to see what type of Regex is returned
        /// </summary>
        /// <param name="dosLikeExpressionFilter"></param>
        /// <returns></returns>
        public static Regex DosLikeExpressionFilterToRegEx(string dosLikeExpressionFilter)
        {
            return new Regex(DosLikeExpressionFilterToRegExFilterExpression(dosLikeExpressionFilter));
        }

        // ******************************************************************
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:21:12.300

```
 Any single character    Any number of characters   Character range
Glob syntax            ?                           *                    [0-9]
Regex syntax           .                           .*                   [0-9] 
```

所以`Bl?e`(glob) 变成`Bl.e`(regex)，然后`*Bl?e*`变成`.*Bl.e.*`.

正如乔伊正确指出的那样，您可以（通常，取决于正则表达式引擎）`(?i)`在您的正则表达式前面添加以使其不区分大小写。

但是请注意，许多在通配模式中没有特殊含义的字符在正则表达式中确实具有特殊含义，因此您不能只是从 glob 到正则表达式进行简单的搜索和替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-14T12:52:41.417

需要解决相同的问题（使用用户输入中的 * 和 ? 通配符模式来过滤任意字符串列表），但扩展名可能还包括要搜索的转义星号或问号。

由于 SQL LIKE 运算符（这些通配符是 % 和 _）通常提供反斜杠以进行转义，因此我采用了相同的方法。这使使用 Regex.Escape() 并将 * 替换为 .* 和 ? 和 。使用正则表达式（请参阅该问题的许多其他答案）。

以下代码概述了为某些通配符模式提供正则表达式的方法。它被实现为 C# 字符串的扩展方法。文档标签和注释应该完整地解释代码：

```
using System.Text.RegularExpressions;

public static class MyStringExtensions
{
    /// <summary>Interpret this string as wildcard pattern and create a corresponding regular expression. 
    /// Rules for simple wildcard matching are:
    /// * Matches any character zero or more times.
    /// ? Matches any character exactly one time.
    /// \ Backslash can be used to escape above wildcards (and itself) for an explicit match,
    /// e.g. \* would then match a single star, \? matches a question mark and \\ matches a backslash.
    /// If \ is not followed by star, question mark or backslash it also matches a single backslash.
    /// Character set matching (by use of rectangular braces []) is NOT used and regarded in this implementation.
    /// </summary>
    /// <param name="wildPat">This string to be used as wildcard match pattern.</param>
    /// <param name="caseSens">Optional parameter for case sensitive matching - default is case insensitive.</param>
    /// <returns>New instance of a regular expression performing the requested matches.
    /// If input string is null or empty, null is returned.</returns>
    public static Regex CreateWildcardRegEx(this string wildPat, bool caseSens = false)
    {
        if (string.IsNullOrEmpty(wildPat))
           return null;

        // 1\. STEP: Escape all special characters used in Regex later to avoid unwanted behavior.
        // Regex.Escape() prepends a backslash to any of following characters: \*+?|{[()^$.# and white space 
        wildPat = Regex.Escape(wildPat);

        // 2\. STEP: Replace all three possible occuring escape sequences defined for our 
        // wildcard pattern with temporary sub strings that CANNOT exist after 1\. STEP anymore.
        // Prepare some constant strings used below - @ in C# makes literal strings really literal - a backslash needs not be repeated!
        const string esc    = @"\\";    // Matches a backslash in a Regex
        const string any    = @"\*";    // Matches a star in a Regex
        const string sgl    = @"\?";    // Matches a question mark in a Regex
        const string tmpEsc = @"||\";   // Instead of doubled | any character Regex.Escape() escapes would do (except \ itself!)
        const string tmpAny =  "||*";   // See comment above
        const string tmpSgl =  "||?";   // See comment above

        // Watch that string.Replace() in C# will NOT stop replacing after the first match but continues instead...
        wildPat = wildPat.Replace(Regex.Escape(esc), tmpEsc)
                         .Replace(Regex.Escape(any), tmpAny)
                         .Replace(Regex.Escape(sgl), tmpSgl);

        // 3\. STEP: Substitute our (in 1\. STEP escaped) simple wildcards with the Regex counterparts.
        const string regAny = ".*";             // Matches any character zero or more times in a Regex
        wildPat = wildPat.Replace(any, regAny)
                         .Replace(sgl, ".");    // . matches any character in a Regex

        // 4\. STEP: Revert the temporary replacements of 2\. STEP (in reverse order) and replace with what a Regex really needs to match
        wildPat = wildPat.Replace(tmpSgl, sgl)
                         .Replace(tmpAny, any)
                         .Replace(tmpEsc, esc);

        // 5\. STEP: (Optional, for performance) - Simplify multiply occuring * wildcards (cases of ******* or similar)
        // Replace with the regAny string - Use a single Regex.Replace() instead of string.Contains() with string.Replace() in a while loop 
        wildPat = Regex.Replace(wildPat, @"(\.\*){2,}", regAny);

        // 6\. STEP: Finalize the Regex with begin and end line tags
        return new Regex('^' + wildPat + '$', caseSens ? RegexOptions.None : RegexOptions.IgnoreCase);

        // 2\. and 4\. STEP would be obsolete if we don't wanted to have the ability to escape * and ? characters for search
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:27:03.640

试试这个正则表达式：

```
^([\w,\s]*bl\we[\w,\s]*) 
```

它基本上可以识别任何一组单词和空格，其中包含一个以“bl”开头并以“e”结尾且中间有一个字符的单词。或者

```
^([\w,\s]*bl(\w+)e[\w,\s]*) 
```

如果您想识别任何以“bl”开头并以“e”结尾的单词。

另一种选择是对字符串使用一些不精确的匹配算法。不确定这是否正是您正在寻找的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-01T15:31:58.807

作为参考...我实际上使用了该代码：

```
using System.Text;
using System.Text.RegularExpressions;

namespace HQ.Util.General
{
    /*
        Usage:

           _glob = new FilterGlob(filterExpression, _caseSensitive);            

            public bool IsMatch(string s)
            {
                return _glob.IsMatch(s);
            }
    */

    /// <summary>
    /// Glob stand for: Pattern matching. Supported character are "?" and "*".
    /// </summary>
    public class FilterGlob
    {
        private readonly Regex pattern;

        /// <summary>
        /// Constructs a new <see cref="T:Microsoft.Practices.Unity.InterceptionExtension.Glob"/> instance that matches the given pattern.
        /// 
        /// </summary>
        /// <param name="pattern">The pattern to use. See <see cref="T:Microsoft.Practices.Unity.InterceptionExtension.Glob"/> summary for
        ///             details of the patterns supported.</param><param name="caseSensitive">If true, perform a case sensitive match.
        ///             If false, perform a case insensitive comparison.</param>
        public FilterGlob(string pattern, bool caseSensitive = true)
        {
            this.pattern = FilterGlob.GlobPatternToRegex(pattern, caseSensitive);
        }

        /// <summary>
        /// Checks to see if the given string matches the pattern.
        /// 
        /// </summary>
        /// <param name="s">String to check.</param>
        /// <returns>
        /// True if it matches, false if it doesn't.
        /// </returns>
        public bool IsMatch(string s)
        {
            return this.pattern.IsMatch(s);
        }

        private static Regex GlobPatternToRegex(string pattern, bool caseSensitive)
        {
            StringBuilder stringBuilder = new StringBuilder(pattern);
            string[] strArray = new string[9]
            {
                "\\",
                ".",
                "$",
                "^",
                "{",
                "(",
                "|",
                ")",
                "+"
            };

            foreach (string oldValue in strArray)
            {
                stringBuilder.Replace(oldValue, "\\" + oldValue);
            }

            stringBuilder.Replace("*", ".*");
            stringBuilder.Replace("?", ".");
            stringBuilder.Insert(0, "^");
            stringBuilder.Append("$");

            RegexOptions options = caseSensitive ? RegexOptions.None : RegexOptions.IgnoreCase;

            return new Regex(((object)stringBuilder).ToString(), options);
        }

    }
} 
```

# ruby - 移动到一个方法会导致“未定义的方法”

> ID：10558018
> 
> 赞同：0
> 
> 时间：2012-05-11T20:14:23.237
> 
> 标签：ruby

我正在尝试将两种类似的方法组合成一个，但我遇到了一些问题。

目前：

```
def self.tree
  self.projects.sort_by(&:name).map do |assembly|
    [ assembly, assembly.assemblies.map(&:tree) ]
  end
end

def tree
  [ self, self.assemblies.map(&:tree), self.parts ]
end 
```

我试过把它改成

```
def self.tree
  self.build_tree( self.projects )
end

def tree
  self.build_tree( [self] )
end

def build_tree( set )
  set.sort_by(&:name).map do |assembly|
    [ assembly, assembly.assemblies.map(&:tree), assembly.parts ]
  end
end 
```

但我只是得到`undefined method 'build_tree' for #<Class:0x000000036a5588>`

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:19:51.257

您可能将树称为类方法。在这种情况下，此方法尝试调用静态 build_tree（self 是自己的 Class）。为了工作，你需要做这样的事情：

```
def self.build_tree(set)
   code...
end 
```

# objective-c - 使用 dispatch_get_main_queue() 是否意味着我的代码将在主线程上？

> ID：10558019
> 
> 赞同：17
> 
> 时间：2012-05-11T20:14:27.513
> 
> 标签：objective-c, grand-central-dispatch, dispatch-async

以下代码是否在主线程上运行？“主队列”是指主线程吗？

```
dispatch_async(dispatch_get_main_queue(),
^{
   // Some code
}); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-11T20:24:39.700

调度异步与同步的异步部分不同于并发与串行。异步意味着函数立即返回，同步意味着它会等到块被执行。由于主线程/队列是串行的，因此事情将按顺序执行 - 我*相信*这意味着，由于您要求它在您正在调度的同一线程上异步调度，它会立即返回，等到当前运行循环的结尾和队列中的任何其他内容，然后执行您的块。

这对于队列内部比在主线程上更有用 - 您可以处理数据，让 UI 知道要更新，并继续处理而无需等待所有内容重绘等。这就是为什么您经常会看到 dispatch_async调用另一个dispatch_async（并发队列）中的主线程，而不仅仅是一个dispatch_sync。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-11T20:16:28.980

是的。来自[Apple 开发者网站](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dispatch_get_main_queue.3.html)：

> 调度框架提供了一个默认的串行队列供应用程序使用。该队列通过 dispatch_get_main_queue() 访问。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-11T20:18:59.727

这在多个地方都有记录，包括[文档`dispatch_get_main_queue()`本身](http://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW11)。[并发编程指南](http://developer.apple.com/library/mac/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW2)说：

> 主调度队列是一个全局可用的串行队列，它在应用程序的主线程上执行任务。

# vector - Rotate a 3D point around the origin / tilt a 3D vector

> ID：10558022
> 
> 赞同：0
> 
> 时间：2012-05-11T20:14:33.010
> 
> 标签：vector, 3d, rotation, translation

I have a 3D unity vector pointing in a certain direction. Now I want to get a new unity vector which is 45 degrees tilted from the direction of that vector, in which direction exactly has to be random. Does anyone know a way to compute that new vector?

(Alternatively, this may be expressed as the rotation of a 3D point around the origin in a random direction by 45 degrees.)

To remove the 'random' component: I am happy if I can find ANY vector that is 45 degrees tilted from my old vector, because then I might be able to rotate the end point of that vector a random distance around the old vector.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T23:03:14.103

Let's say you have a vector v1\. First, you should find a vector v2 which is perpendicular to v1\. Then the vector you want to find out is half between v1 and v2, that is `v3 = norm(norm(v1)+norm(v2))`. And how to find v2? You can take a cross product of v1 and any vector which is not parallel to v1\. So you can do something like this:

```
v2 = cross(v1, (1,0,0));
if (dot(v2, v2) < 0.001) v2 = cross(v1, (0,1,0));
v3 = normalize(normalize(v1)+normalize(v2)); 
```

Finally, the angle between v1 and v3 is 45 degrees.

# asp.net - 在asp.net中如何引用自定义基页面类中的页面控件

> ID：10558033
> 
> 赞同：4
> 
> 时间：2012-05-11T20:15:13.153
> 
> 标签：asp.net

我有大量的`.aspx`页面（asp.net 4，c#）都继承自自定义基页面类（继承自 System.Web.UI.Page 类）。

按照惯例，所有这些页面上都有相同的控件集（例如几个具有相同 ID 的文本框）。

我想将一些通用代码放在自定义基页面类中，该类`.Text`从页面上的这些控件中检索值。

请注意，这不是 MasterPage 设置。我有一个自定义基页类，然后是从该基页类继承的一系列页面。

如何从基类引用页面上的文本框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:34:01.353

您应该能够使用`Page.FindControl("ControlID")`.

从你的基类：

```
var txt = Page.FindControl("TextBox1") as TextBox;
if (txt != null)
{
    //found the textbox
    //...
} 
```

根据控件所在的窗体位置，特别是如果它们位于实现`INamingContainer`接口的容器中，您可能需要创建一个`FindControl()`可以遍历控件层次结构的递归方法。

```
public Control FindControlRecursive(Control root, string id)
{
    if (root.ID == id)
        return root;

    foreach (Control control in root.Controls)
    {
        Control foundControl = FindControlRecursive(control, id);
        if (foundControl != null)
            return foundControl;
    }

    return null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:20:59.460

如果按照惯例它们都有相同的控件集，为什么不将控件移到基类中呢？

或者，您可以创建一个包含通用控件集的接口，然后在您的所有 aspx.cs 代码隐藏中实现该接口。这将允许您拥有一些违反惯例的 aspx 页面。您可以将“this”作为接口，在基类中，如果它不为空，则修改控件。例如：

```
IControlSet controlSet = this as IControlSet;

if(controlSet != null)
{
    controlSet.Name.Text = "someName";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T20:23:21.623

您可以做的一件事是在基类上放置一个抽象方法或属性。这将迫使继承者实现此方法，并且基础可以可靠地调用它。

```
protected abstract TextBox MyTextBox { get; } 
```

那么您所有继承的页面都必须实现此方法，并且理想情况下会返回它们的 MyTextBox。

您可以创建一个如上定义的接口，或者只是创建另一个 PageBase，它从您的另一个 Base 继承来表示具有该组控件的页面。

**编辑：**

作为实现的一个例子。假设基类名为 MyPageBase 并且 HomePage.aspx 上有一个 ID="TextBox1" 的文本框

在基础上定义抽象属性

```
public abstract class MyPageBase : Page
{
    protected abstract TextBox MyTextBox { get; }
} 
```

在页面上：

```
public partial class HomePage : MyPageBase
{
    protected override TextBox MyTextBox
    {
        get 
        {
             return this.TextBox1;
        }
    }
} 
```

在基础中，您可以访问该属性，因为它的抽象就像一个接口一样工作并且必须实现。然后假设继承人遵守合同，基地可以访问此属性。

```
this.MyTextBox.Text = "Change the text"; 
```

如果您只想修改文本或其他特定属性，最好更好地封装它并仅为特定文本框上的文本属性提供 getter/setter。该示例不允许您更改文本框的实际实例，但它允许您访问和修改其任何属性。

# ios - 裁剪 UIImage 时的性能问题（CoreGraphics，iOS）

> ID：10558035
> 
> 赞同：3
> 
> 时间：2012-05-11T20:15:23.913
> 
> 标签：ios, uikit, uiimage, core-graphics, crop

我们试图做的基本想法是我们有一个很大的 UIImage，我们想把它分成几块。该函数的用户可以传入行数和列数，图像将被相应地裁剪（即3行3列将图像切成9块）。问题是，我们在尝试使用 CoreGraphics 完成此操作时遇到了性能问题。我们需要的最大网格是 5x5，操作需要几秒钟才能完成（这对用户来说是滞后时间）。这当然远非最佳。

我和我的同事在这方面花了很长时间，并在网上搜索了答案，但没有成功。我们俩都没有在 Core Graphics 方面非常有经验，所以我希望代码中有一些愚蠢的错误可以解决我们的问题。SO用户，请帮助我们解决这个问题！

[我们使用http://www.hive05.com/2008/11/crop-an-image-using-the-iphone-sdk/](http://www.hive05.com/2008/11/crop-an-image-using-the-iphone-sdk/)上的教程来修改我们的代码。

下面的函数：

```
-(void) getImagesFromImage:(UIImage*)image withRow:(NSInteger)rows withColumn:(NSInteger)columns
{
    CGSize imageSize = image.size;
    CGFloat xPos = 0.0;
    CGFloat yPos = 0.0;
    CGFloat width = imageSize.width / columns;
    CGFloat height = imageSize.height / rows;

    int imageCounter = 0;

    //create a context to do our clipping in
    UIGraphicsBeginImageContext(CGSizeMake(width, height));
    CGContextRef currentContext = UIGraphicsGetCurrentContext();

    CGRect clippedRect = CGRectMake(0, 0, width, height);
    CGContextClipToRect(currentContext, clippedRect);

    for(int i = 0; i < rows; i++)
    {
        xPos = 0.0;
        for(int j = 0; j < columns; j++)
        {
            //create a rect with the size we want to crop the image to
            //the X and Y here are zero so we start at the beginning of our
            //newly created context
            CGRect rect = CGRectMake(xPos, yPos, width, height);

            //create a rect equivalent to the full size of the image
            //offset the rect by the X and Y we want to start the crop
            //from in order to cut off anything before them
            CGRect drawRect = CGRectMake(rect.origin.x * -1,
                                     rect.origin.y * -1,
                                     image.size.width,
                                     image.size.height);

            //draw the image to our clipped context using our offset rect
            CGContextDrawImage(currentContext, drawRect, image.CGImage);

            //pull the image from our cropped context
            UIImage* croppedImg = UIGraphicsGetImageFromCurrentImageContext();

            //PuzzlePiece is a UIView subclass
            PuzzlePiece* newPP = [[PuzzlePiece alloc] initWithImageAndFrameAndID:croppedImg :rect :imageCounter];
            [slicedImages addObject:newPP];

            imageCounter++;
            xPos += (width);
        }
        yPos += (height);
    }
    //pop the context to get back to the default
    UIGraphicsEndImageContext();
} 
```

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T08:21:37.860

originalImageView 是一个 IBOutlet ImageView。此图像将被裁剪。

```
#import <QuartzCore/QuartzCore.h> 
```

每个切片周围的白色边框都需要 QuartzCore，以便更好地理解。

```
-(UIImage*)getCropImage:(CGRect)cropRect
{
CGImageRef image = CGImageCreateWithImageInRect([originalImageView.image CGImage],cropRect);
UIImage *cropedImage = [UIImage imageWithCGImage:image];
CGImageRelease(image);
return cropedImage;
}

-(void)prepareSlices:(uint)row:(uint)col
{
float flagX = originalImageView.image.size.width / originalImageView.frame.size.width;
float flagY = originalImageView.image.size.height / originalImageView.frame.size.height;

float _width    = originalImageView.frame.size.width / col;
float _height   = originalImageView.frame.size.height / row;

float _posX = 0.0;
float _posY = 0.0;

for (int i = 1; i <= row * col; i++) {

    UIImageView *croppedImageVeiw = [[UIImageView alloc] initWithFrame:CGRectMake(_posX, _posY, _width, _height)];
    UIImage *img = [self getCropImage:CGRectMake(_posX * flagX,_posY * flagY, _width * flagX, _height * flagY)];
    croppedImageVeiw.image = img;

    croppedImageVeiw.layer.borderColor = [[UIColor whiteColor] CGColor];
    croppedImageVeiw.layer.borderWidth = 1.0f;

    [self.view addSubview:croppedImageVeiw];
    [croppedImageVeiw release];

    _posX += _width;

    if (i % col == 0) {
        _posX = 0;
        _posY += _height;
    }

}

originalImageView.alpha = 0.0;

} 
```

originalImageView.alpha = 0.0; 你不会再看到 originalImageView 了。

像这样称呼它：

```
[self prepareSlices:4 :4]; 
```

它应该在 self.view 上创建 16 个切片 addSubView。我们有一个益智应用程序。这是那里的工作代码。

# facebook-graph-api - 如何删除我所有的申请成就？

> ID：10558037
> 
> 赞同：0
> 
> 时间：2012-05-11T20:15:27.400
> 
> 标签：facebook-graph-api, curl, facebook-opengraph, achievements

有没有快速删除我为 Facebook 应用创建的所有成就的方法？（我有数百个..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:02:58.367

不，您需要逐个删除

# maven - 我想在 maven 的 warfile 中添加一个 implementation-Version

> ID：10558040
> 
> 赞同：0
> 
> 时间：2012-05-11T20:15:44.020
> 
> 标签：maven, maven-plugin

我想在我的 warfile.with 实现版本中添加一个 Implementation-Version 行以清单为 projectname_mmddyyy.version。如何在 maven 中配置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:34:50.887

请参阅[Maven 存档](http://maven.apache.org/shared/maven-archiver/index.html)器以供参考。配置应该是这样的：

```
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-war-plugin</artifactId>
<configuration>
    <archive>
        ...
    </archive>
</configuration> 
```

# c# - 将本地文件与服务器文件同步

> ID：10558041
> 
> 赞同：1
> 
> 时间：2012-05-11T20:15:44.533
> 
> 标签：c#, java, .net, vb.net

**场景：**我想开发一个应用程序。该应用程序应该能够连接到我的远程服务器并将数据下载到本地磁盘，同时下载它应该检查新文件并且只下载新文件同时创建所需的（新）文件夹.

**问题：**我不知道如何将服务器中的文件与本地磁盘中的文件进行比较。如何仅将服务器中的新文件下载到本地磁盘？

**在想什么？：**我想将本地计算机中的文件与服务器中的文件同步。我打算使用 rsync 进行同步，但我不知道如何将它与 ASP.NET 一起使用。

请让我知道我的方法是否错误或者是否有其他更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:18:37.727

首先您可以比较文件名，然后是文件大小，当全部匹配时，您可以比较文件的哈希值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-16T19:24:47.460

我把这种问题称为“数据掌握”问题。我整个星期都与一家财富 100 强公司同步我们的数据库，并处理了许多业务流程问题。

处理生产数据的第一条规则是不要进行用户的数据输入。他们必须负责将任何涉及生产的业务流程付诸实施。他们必须了解流程并有权访问显示哪些数据已更改的日志，否则他们无法处理问题。如果你是为他们做这件事，那么你就是在承担这些责任。他们会期望您在问题发生时解决所有问题，而您无法做到这一点，因为 IT 无法解释业务数据或其相关性。例如，我处理交货记录，但必须被告知重复的密钥表示承运人更改。

我继承了几个管理不善的场景，在这些场景中，IT 只是将“较新”的数据转储到生产中而没有任何进一步的担忧。有时我会收到垃圾数据，我必须手动从母带处理过程中排除传入记录，因为它们具有无效的负数量。我的一些现有记录比传入数据更完整，因此我必须跳过同步特定列。当一个应用程序的导入过程完全失败时，我不得不通过创建一个有效的更新脚本来结束投诉。这些是您需要提前考虑的问题，因为它们会鼓励您组织对同步过程的每个步骤的控制。

同步步骤：

1.  在更新之前记录那里的内容

2.  下载并比较本地与远程副本的差异；如果没有 a) 将它们都放在相同的物理位置或 b) 控制另一个系统，则无法比较两者

3.  记录您正在更新的内容以及更新时的时间戳

4.  保存并关闭日志

5.  仅当 1-4 完成后，您才应将更新发布到生产环境

现在，就组织“掌握”过程而言，我称之为比较数据并生成不同之处的列表，我有更多的经验可以分享。对于一个应用程序，我必须重组（分散）表格和报告，然后才能可靠地比较两个来源。这意味着需要了解业务数据并知道它的格式正确。您不会说您是在比较 PDF、电子表格还是图像。对于数据，您必须为每个表（或工作表）编写单独的 mastering 流程，因为 mastering 流程的比较步骤可能会根据业务需求进行特殊调整。不要编写一个掌握一切的过程。让每个过程可控。

导入时，并非所有信息都以相同的方式进行比较。我们获取 PO 和交付数据，因此比较数万条记录以确定哪些数据点发生了变化，但一些发票信息只是简单地导入，没有任何未来的检查或同步。业务需求甚至可以覆盖更新并保留过时的数据。

然后可以根据需要定制每个母带处理过程的比较器模块。在比较 PDF 和电子表格等文件类型时，您需要特定的 API。我将 EPPlus 用于工作簿。当然，您无法打开的任何内容都必须进行二进制比较。

母版处理不应清理或转换数据，尤其是财务数据。这些步骤需要在母带制作之前进行，以便在母带制作开始之前发现这些问题。

我的工具在 3 个选项卡中组织数据——创建、更新和删除——每个选项卡都带有显示相关记录的 DataGridView。然后我可以记录、审查和提交更改，或者将责任交给愿意的人。

掌握工艺步骤：

1.  （在外部清理/转换数据）

2.  加载数据源

3.  比较外部数据和本地数据

4.  水合指示创建、更新和删除的数据集

# python - 将 Clojure 与 Python 混合是个好主意吗？

> ID：10558044
> 
> 赞同：8
> 
> 时间：2012-05-11T20:16:03.660
> 
> 标签：python, clojure

我正在做一个涉及大量基于 Web 和 AI 工作的大型项目。我对 Python 非常满意，尽管我唯一关心的是并发编程和扩展这个项目以使其在集群上工作。因此，Clojure for AI 和对 Java 函数调用的支持带来了并发编程。

使用 Python 完成所有基于 Web 的 api 工作并让 Clojure 处理大部分并发 AI 工作是否是个好主意？

编辑：让我详细解释一下交互。Python 将完成大部分繁琐的工作（抓取、图像处理、改进数据库等等）。如果可能，Clojure 将处理数据库或从 Python 获取数据。我除了一些 CPython 与 Python 和 Clojure 的链接。

Edit2：问这个问题可能很愚蠢，但这是一个相当长期的项目，会发生相当大的演变并经历多次迭代，Clojure 是一种语言吗？便携性够吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-11T21:32:07.477

我用 Clojure 的后端（在任意数量的机器上）和 Ruby on Rails 的前端构建了一个令人尴尬的并行数字运算应用程序。我不是特别喜欢 RoR，但当时这是一个零预算项目，我们手头有一个愿意免费工作的 Rails 程序员。

Clojure 部分由（大致）一个控制器、数字处理节点和一个实现 JSON-over-HTTP API 的服务器组成，该 API 是 Rails Web 应用程序的接口。Clojure 节点使用 RabbitMQ 相互通信。因为我们在应用程序的不同部分之间定义了清晰的 API，所以以后在 Clojure 中重写前端很容易（因为这更适合我们的需要）。

如果您正在从事一个具有较长生命周期和持续开发工作的分布式项目，那么将应用程序设计为通过定义明确的 API（json、bson、... over AMQP、 HTTP，...或数据库）。这意味着您可以使用自己熟悉的语言快速开始，如有必要，可以在稍后阶段用另一种语言重写部分内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-12T02:26:50.233

我看不出将 Python 用于 Web 应用程序和 Clojure 用于并发数据处理/后端代码有什么大问题。我假设您会使用 JSON over http 之类的东西来进行两者之间的通信，这应该可以正常工作。

我个人会同时使用 Clojure（例如使用优秀的[Noir](http://webnoir.org/)作为 Web 框架，使用[Korma](http://sqlkorma.com/)作为数据库的东西。），但是如果你说你的经验主要是在 Python 中，那么从生产力的角度坚持使用 Python 可能是有意义的观点（至少在短期内）。

要回答有关 Clojure 未来的问题：

*   它肯定会留在这里。它有一个非常活跃的社区，并且可能是目前“最热门”的 JVM 语言之一（与 Scala 和 Groovy 并列）。它似乎在大数据/分析领域做得特别好
*   Clojure 在库支持方面具有特别的优势，因为它可以轻松使用任何 Java 库。从实践的角度来看，这对于新语言来说是一个*巨大*的优势，因为它可以立即解决通常是建立新语言生态系统的最大问题之一。
*   Clojure 是一种新的语言，它仍在经历大量的发展。如果您选择使用 Clojure，您应该意识到您需要付出一些努力来保持最新状态并让您的代码与最新的 Clojure 版本保持同步。我个人认为这不是一个问题，但对于习惯于像 Java 这样更“稳定”的语言的人来说，这可能会让他们感到惊讶。
*   Clojure 非常便携——它基本上可以在任何你可以获得相当现代的 JVM 的地方运行，现在几乎无处不在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T20:22:37.007

如果您可以构建双方以使用数据和纯（ish）函数进行通信，那么这应该会很好。将您的 clojure 函数包装在采用并返回 JSON（或更优选地 clojure 形式）的 Web 服务中应该使您的基于 Python 的前端可以访问它们，这不会大惊小怪。

当然，全程用 Clojure 编写会更有趣。;)

如果这是一个长期项目，而不是构建交换数据的干净功能（如获取和返回值）接口变得更加重要，因为它将使您能够独立地发展组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T09:07:17.743

在这种情况下，我个人喜欢按以下顺序开始。

*   将系统划分为子系统，对每个系统的功能进行“非常明确”的定义，并且该定义应遵循“只做一件事，保持简单”的原则。在这个阶段不要考虑语言等。
*   选择运行这些子系统的平台（不是语言）。例如：JVM、Python VM、NodeJs、CLR(Mono)、其他 VM。尝试选择几个平台，或者如果可能的话只选择一个平台，因为这确实使复杂性方面的生活更轻松。
*   选择对这些平台进行编程的语言。这是非常主观的，但对于 JVM，您可以使用 Clojure 或 Jython（如果您像我一样喜欢动态语言）。

就 Clojure 的未来而言，这是一种由“优秀程序员社区”而不是某个公司开发的语言。我希望这能消除您对 Clojure 的“长期”关注的疑虑。顺便说一句，Clojure 是 LISP，因此您可以按照自己的方式修改语言并自行修复，即使有人不为您这样做。

# ios - 是否可以在我的应用程序中使用安装在 iOS 设备上的客户端证书？

> ID：10558046
> 
> 赞同：10
> 
> 时间：2012-05-11T20:16:09.527
> 
> 标签：ios, certificate, pki, client-certificates

我希望能够安装客户端证书（例如通过电子邮件），然后使用该证书来验证我的应用程序发送的请求。我有一种感觉，Apple 不会允许这种访问，但找不到任何明确的答案。这是真的，还是有办法从应用程序中访问安装在设备上的客户端证书？

**编辑**：澄清一下，这是一个本机应用程序，而不是一个网络应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T14:18:37.897

您的应用程序只能使用您存储在其自己的钥匙串（或共享相同配置证书的其他第 3 方应用程序的钥匙串）中的内容。至于实际加载，我们确实使用了 openssl（我们确实围绕它编写了一个 obj-c 包装器）来解码我们发送给应用程序的 .p12。

在设置->常规->配置文件中加载的证书以某种方式受到保护，只有内置应用程序（邮件、Safari）可以在那里添加内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-21T11:53:35.860

要在您的应用程序中使用客户端证书，您必须将应用程序内的证书导入到您的应用程序钥匙串。（注意您需要使用 PKCS#12 证书格式，但您需要在您的应用程序中注册它（搜索导出的 UTI 和文档类型），扩展名不同，而不是“.p12”，它已经被 iOS 注册了。我'在我的应用程序中使用过 .x-p12）请参见此处：[iOS 客户端证书和移动设备管理](https://stackoverflow.com/questions/25924881/ios-client-certificates-and-mobile-device-management) 和此处：[https ://developer.apple.com/library/ios/qa/qa1745/_index.html](https://developer.apple.com/library/ios/qa/qa1745/_index.html)

# ios5 - 如何检测与当前 UIView 的转换？

> ID：10558052
> 
> 赞同：0
> 
> 时间：2012-05-11T20:16:34.873
> 
> 标签：ios5, uiview

我希望在远离当前 UIView 的任何转换上执行一些代码。视图本身可能会一直存在并且不会被垃圾收集，因此 viewDidUnload 可能不是合适的事件。

是否有其他事件或方法来检测给定视图何时不再显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:50:30.377

`-(void)viewWillDisappear:(BOOL)animated;`
或
`-(void)viewDidDisappear:(BOOL)animated;`
取决于您要实现的业务逻辑

# android - 将图像从 Android 上的可绘制资源保存到 sdcard

> ID：10558053
> 
> 赞同：23
> 
> 时间：2012-05-11T20:16:35.033
> 
> 标签：android, drawable, sd-card, android-image, android-button

我想知道如何通过单击按钮将图像保存到用户的 SD 卡。有人可以告诉我怎么做。图像为 .png 格式，存储在可绘制目录中。我想编写一个按钮来将该图像保存到用户的 SD 卡中。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-12T06:17:01.840

此处描述了保存文件（在您的情况下为图像）的过程：[save-file-to-sd-card](http://android-er.blogspot.com/2010/07/save-file-to-sd-card.html)

* * *

## 从drawble资源将图像保存到sdcard：

假设您的可绘制对象中有一个名为 ic_launcher 的图像。然后从此图像中获取位图对象，例如：

```
Bitmap bm = BitmapFactory.decodeResource( getResources(), R.drawable.ic_launcher); 
```

可以使用以下方式检索 SD 卡的路径：

```
String extStorageDirectory = Environment.getExternalStorageDirectory().toString(); 
```

然后在按钮单击时保存到 sdcard：

```
File file = new File(extStorageDirectory, "ic_launcher.PNG");
    FileOutputStream outStream = new FileOutputStream(file);
    bm.compress(Bitmap.CompressFormat.PNG, 100, outStream);
    outStream.flush();
    outStream.close(); 
```

不要忘记添加`android.permission.WRITE_EXTERNAL_STORAGE`权限。

这是从drawable保存的修改文件：[SaveToSd](http://pastebin.com/KkZVK0vF) ，一个完整的示例项目：[SaveImage](http://www.mediafire.com/?q2x4c3nd55597t4)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-18T18:43:18.157

我认为这个问题没有真正的解决方案，唯一的方法是从 sd_card 缓存目录复制和启动，如下所示：

```
Bitmap bm = BitmapFactory.decodeResource(getResources(), resourceId);
File f = new File(getExternalCacheDir()+"/image.png");
try {
    FileOutputStream outStream = new FileOutputStream(f);
    bm.compress(Bitmap.CompressFormat.PNG, 100, outStream);
    outStream.flush();
    outStream.close();
} catch (Exception e) { throw new RuntimeException(e); }

Intent intent = new Intent();
intent.setAction(android.content.Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(f), "image/png");
startActivity(intent);

// NOT WORKING SOLUTION
// Uri path = Uri.parse("android.resource://" + getPackageName() + "/" + resourceId);
// Intent intent = new Intent();
// intent.setAction(android.content.Intent.ACTION_VIEW);
// intent.setDataAndType(path, "image/png");
// startActivity(intent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-21T13:42:05.197

如果你使用**Kotlin**，你可以这样做：

```
val mDrawable: Drawable? = baseContext.getDrawable(id)
val mbitmap = (mDrawable as BitmapDrawable).bitmap
val mfile = File(externalCacheDir, "myimage.PNG")
        try {
            val outStream = FileOutputStream(mfile)
            mbitmap.compress(Bitmap.CompressFormat.PNG, 100, outStream)
            outStream.flush()
            outStream.close()
        } catch (e: Exception) {
            throw RuntimeException(e)
        } 
```

# .net - WCF ServiceHost BaseAddresses 不包含所有 IIS 主机标头值，当在 IIS 中设置多个主机标头时

> ID：10558054
> 
> 赞同：2
> 
> 时间：2012-05-11T20:16:45.373
> 
> 标签：.net, wcf, iis, iis-6

我有一个运行了很长时间的 WCF 服务，托管在 IIS6 (Windows Web Server 2003) 中。

我正在尝试在 IIS 中添加第二个主机标头值（以前只有 1 个）。

所以现在在 IIS 中，假设我已经配置：

```
IP: All Available, Port: 80, Host: x.test.com
IP: All Available, Port: 80, Host: y.test.com 
```

在我的应用程序中，我设置了这个 WCF 配置属性：

```
<serviceHostingEnvironment multipleSiteBindingsEnabled="true">
</serviceHostingEnvironment> 
```

我有一个习惯`ServiceHostFactory`：

```
public class MySuperServiceHostFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        //...
    }
} 
```

在参数`Uri[] baseAddresses`中，WCF 似乎只传递给我 IIS 配置中的*第一个*值。所以对于这个例子，`baseAddresses`是一个`Uri[1]`具有一个值的`http://x.test.com/MyService.svc`。

* * *

*如果我在 IIS 中指定 HTTP和*HTTPS 主机标头，也会发生同样的事情。回到同一个例子，假设我们设置的 HTTP 流量：

```
IP: All Available, Port: 80, Host: x.test.com
IP: All Available, Port: 80, Host: y.test.com 
```

对于 SSL 流量，我们运行以下命令：

> cscript.exe c:\Inetpub\AdminScripts\adsutil.vbs 设置 /w3svc/12345/SecureBindings ":443:secureA.test.com" ":443:secureB.test.com"

所以现在我的网站应该有 4 个可能的地址。

但是现在 WCF 只是将每种*类型的连接中的**第一个*主机传递给我，所以我现在包含 2 个元素：*`Uri[]`*

 *```
http://x.test.com/MyService.svc
https://secureA.test.com/MyService.svc 
```

任何人都知道为什么会发生这种情况？

* * *

**编辑：**

此链接“ [WCF 如何支持每个站点指定的多个 IIS 绑定？](http://blogs.msdn.com/b/rampo/archive/2008/02/11/how-can-wcf-support-multiple-iis-binding-specified-per-site.aspx) ”在最底部说：

> **.Net Fx4.0 中的解决方案：BaseAddressPrefixFilters**
> 
> **Beta2 修复**
> 
> 在 .NET Framework 的当前 Beta2 版本中，我们添加了对多站点绑定的支持。只需在 IIS 站点中设置绑定，服务将继承该地址
> 
> **最终 RTM 修复**
> 
> 最后，出于应用程序兼容性的原因，我们决定选择加入。为了启用多站点绑定，您需要在应用程序中将 multipleSiteBindingEnabled 设置为 true。仅 Http 协议支持多站点绑定。配置文件中的端点地址需要是完整的 URI。将 3.0 或 3.5 解决方法移植到 4.0 时，您需要保留此特定方面。
> 
> ```
> <serviceHostingEnvironment multipleSiteBindingsEnabled="true" /> 
> ```

最后一点就是我正在做的事情。我正在使用 .NET4 的附加功能在 IIS 中设置多个主机标头，并`multipleSiteBindingsEnabled="true"`在我的配置中设置。

如果您不理会 WCF 的其余部分并让它做默认的事情来构建服务端点，这实际上工作得很好。

但是，我的问题是所有多个主机标头实际上并未传递给自定义`ServiceHostFactory`实现，因此在所有基地址上手动设置您自己的端点似乎很困难或不可能。

也许这只是 .NET 4 中的一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T20:04:56.623

在您的自定义类中，您是否手动添加其他端点？我确实相信它的设计方式你需要手动完成......

请参阅[http://msdn.microsoft.com/en-us/library/ms751515.aspx](http://msdn.microsoft.com/en-us/library/ms751515.aspx)

有了这个概念，如果 EndPoint 是配置，那么它将为您添加。由于您的配置为空，您必须手动添加端点。

请参阅[WCF 自托管服务 - C# 中的端点](https://stackoverflow.com/questions/2807525/wcf-self-host-service-endpoints-in-c-sharp)*

# redis - 如何在 Redis 中创建具有“field1 desc, field2 asc”顺序的排序集？

> ID：10558057
> 
> 赞同：2
> 
> 时间：2012-05-11T20:16:57.373
> 
> 标签：redis, sortedset

我正在尝试在 Redis 中建立排行榜，并能够获得最高`X`分并检索 user 的排名`Y`。

Redis 中的排序列表看起来很容易，除了一个问题 - 我需要的分数不仅按实际分数排序，还按日期排序（所以早先获得相同分数的人将排在首位）。SQL 查询将是：

```
select * from scores order by score desc, date asc 
```

在 Redis 中的排序集上运行`zrevrange`使用如下内容：

```
select * from scores order by score desc, key desc 
```

这将使用户在字典上具有更大的键。

我能想到的一种解决方案是对排序集中的分数字段进行一些操作，以生成由分数和时间戳组成的组合数字。

例如，对于`555`带有时间戳`111222333`的分数，最终分数可能类似于`555.111222333`将新分数置于旧分数之上（不完全是我需要的，但可以进一步调整）。

这会起作用，但只适用于小数字，因为排序集中的分数只有 16 位有效数字，因此其中 10 位将立即浪费在时间戳上，没有太多空间留给实际分数。

任何想法如何使排序集以正确的顺序排列值？我真的希望最终结果是一个排序集（以便轻松检索用户的排名），即使它需要一些临时结构和排序来构建这样的集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T21:23:23.930

实际上，我之前的所有答案都很糟糕。**忽略我以前的所有答案**（尽管为了其他人的利益，我将把它们留在身边）。

这就是你*实际*应该这样做的方式：

*   仅存储 zset 中的分数
*   单独存储玩家每次达到该分数的列表。

例如：

```
score_key = <whatever unique key you want to use for this score>
redis('ZADD scores-sorted %s %s' %(score, score))
redis('RPUSH score-%s %s' %(score, score_key)) 
```

然后读取分数：

```
top_score_keys = []
for score in redis('ZRANGE scores-sorted 0 10'):
    for score_key in redis('LRANGE score-%s 0 -1' %(score, )):
        top_score_keys.append(score_key) 
```

显然你想在那里做一些优化（例如，只阅读`score-`列表的大块，而不是阅读整个内容）。

但这绝对是做到这一点的方法。

用户排名将是直截了当的：对于每个用户，跟踪他们的高分：

```
redis('SET highscores-%s %s' %(user_id, user_high_score)) 
```

然后使用以下方法确定他们的排名：

```
user_high_score = redis('GET highscores-%s' %(user_id, ))
score_rank = int(redis('ZSCORE scores-sorted %s' %(user_high_score, )))
score_rank += int(redis('LINDEX score-%s' %(user_high_score, ))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T20:48:29.887

这并不是真正的完美解决方案，但如果您制作一个更接近当前时间的自定义纪元，那么您将需要更少的数字来表示它。

例如，如果您使用 2012 年 1 月 1 日作为您的纪元，那么您（目前）只需要 8 位数字来表示时间戳。

这是一个红宝石的例子：

```
(Time.new(2012,01,01,0,0,0)-Time.now).to_i 
```

这将使您在时间戳需要 9 位数字之前大约 3 年，此时您可以执行一些维护以再次向前移动自定义纪元。

但是，我很想听听是否有人有更好的主意，因为我有完全相同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-13T20:49:56.110

（**注意：**这个答案几乎可以肯定是次优的；请参阅[https://stackoverflow.com/a/10575370/71522](https://stackoverflow.com/a/10575370/71522)）

几个想法：

*   您可以对时间戳做出一些假设以使它们更小。例如，您可以存储“自 2012 年 5 月 13 日以来的分钟数”（例如），而不是存储 Unix 时间戳。作为七位有效数字的交换，您可以存储[未来 19 年](http://www.wolframalpha.com/input/?i=9999999+minutes)的时间。
*   同样，您可以减少分数中有效数字的数量。例如，如果您希望分数在 7 位范围内，则可以在将它们存储在排序列表中时将它们除以 10、100 或 1000，然后使用排序列表的结果来访问实际分数，排序那些在应用程序级别。

例如，使用上述两种方法（在可能有错误的伪代码中）：

```
score_small = int(score / 1000)
time_small = int((time - 1336942269) / 60)
score_key = uuid()
redis('SET full-score-%s "%s %s"' %(score_key, score, time))
redis('ZADD sorted-scores %s.%s %s' %(score_small, time_small, score_key)) 
```

然后加载它们（大约）：

```
top_scores = []
for score_key in redis('ZRANGE sorted-scores 0 10'):
    score_str, time_str = redis('GET full-score-%s' %(score_key, )).split(" ")
    top_scores.append((int(score_str), int(time_str))
top_scores.sort() 
```

`O(n)` `GET`此操作甚至可以使用[EVAL](http://redis.io/commands/eval)命令完全在 Redis 内部完成（避免操作的网络开销） （尽管我对 Lua 的了解还不够，无法自信地提供示例实现）。

最后，如果您期望分数的范围非常大（例如，您期望会有大量分数低于 10,000，而同样多的分数超过 1,000,000），那么您可以使用两个排序集：`scores-below-100000`和`scores-above-100000`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T21:15:22.873

(**Note:** this answer is almost certainly suboptimial; see [https://stackoverflow.com/a/10575370/71522](https://stackoverflow.com/a/10575370/71522))

Instead of using a timestamp in the score, you could use a global counter. For example:

```
score_key = <whatever unique key you want to use for this score>
score_number = redis('INCR global-score-counter')
redis('ZADD sorted-scores %s.%s %s' %(score, score_number, score_key) 
```

And to sort them in descending order, pick a large score count (`1<<24`, say), use that as the initial value of `global-score-counter`, then use `DECR` instead of `INCR`.

(this would also apply if you are using a timestamp)

Alternately, if you really incredibly worried about the number of players, you could use a per-score counter:

```
score_key = <whatever unique key you want to use for this score>
score_number = redis('HINCR score-counter %s' %(score, ))
redis('ZADD sorted-scores %s.%s %s' %(score, score_number, score_key)) 
```

# javascript - ASP Classic 中的日历

> ID：10558058
> 
> 赞同：0
> 
> 时间：2012-05-11T20:16:57.903
> 
> 标签：javascript, jquery, html, asp-classic

我正在尝试在使用 jquery 日历的 ASP Classic 中创建一个页面。我尝试遵循互联网上的几个教程，但不能。下面是我开发的代码。有人告诉我有什么问题吗？

下面是我正在开发的源代码：

```
<!--#include virtual = "/EcommerceNew/hidden/funcoes.asp"-->
<!--#include virtual = "/EcommerceNew/hidden/barra_progresso.asp"-->
<%
    Response.Buffer = true
    call Verificar_Login_Ativo()
    limite_excel            = 65000
%>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="../../../javascript/jquery.tools.min.js"></script>
    <link href="../../stylesheets/style.css" rel="stylesheet" type="text/css">
    <link href="../../../stylesheets/calendario.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <h2>
            Relatório de vendas de jornais
        </h2>
    </div>
    <div class="linha">
        </ br> </ br>
    </div>
    <div class="linha">
        <div class="bloco_text">
            Data inicial
        </div>
        <div class="bloco_input">
            <input type="date" name="txtDataInicial">
        </div>
        <div class="bloco_text">
            Data Final
        </div>
        <div class="bloco_input">
            <input type="date" name="txtDataFinal">
        </div>
    </div>
    <div class="linha">
        </ br> </ br>
    </div>
    <div class="linha">
        <input name="Procurar" type="SUBMIT" class="btn" value="Consultar">
    </div>
    </form>
    <script type="text/javascript">
        $(":date").dateinput();
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:23:42.803

假设 dateinput() 是一个创建 datepicker- 而不是

```
 $(":date").dateinput(); 
```

尝试

```
 $("input[type='date']").dateinput(); 
```

并确保将其放在 DOM 加载后`$(function(){ ... });`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:48:13.747

我的问题的解决方案是：

```
<!--#include virtual = "/EcommerceNew/hidden/funcoes.asp"-->
<!--#include virtual = "/EcommerceNew/hidden/barra_progresso.asp"-->
<%
    Response.Buffer = true
    'Guilherme teste - retirar após a conclusão do trabalho
    'call Verificar_Login_Ativo()
    limite_excel            = 65000
%>
<html>
<head>
    <title></title>
    <!--stylesheets-->
    <link href="../../stylesheets/style.css" rel="stylesheet" type="text/css">
    <link type="text/css" rel="Stylesheet" href="../../stylesheets/jquery-ui.css" />
    <!--javascripts-->
    <script type="text/javascript" src="../../javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="../../javascripts/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../javascripts/jquery.ui.datepicker-pt-BR.js"></script>

    <!-- Exemplo 
    <link type="text/css" rel="Stylesheet" href="http://ajax.microsoft.com/ajax/jquery.ui/1.8.6/themes/smoothness/jquery-ui.css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js"></script> 
    <!-- Exemplo fim -->

    <!-- Formatar data -->
    <script type="text/javascript">
    $(function () {
        $("#datainicial").datepicker();
    });
    $(function () {
        $("#datafinal").datepicker();
    });
    </script>

    <!-- scripts que eram utilizados pela vpc-->
    <script src="../hidden/iframe.js"></script>

</head>
<body>
    <form id="form1" runat="server">
    <div>
        <h2>
            Relatório de vendas de jornais
        </h2>
    </div>
    <div class="linha">
        <br> <br>
    </div>
    <div class="linha">
        <div class="bloco_text">
            Data inicial
        </div>
        <div class="bloco_input">
            <input id="datainicial" type="text" />
        </div>
        <div class="bloco_text">
            Data Final
        </div>
        <div class="bloco_input">
            <input id="datafinal" type="text" />
        </div>
    </div>
    <div class="linha">
        <br> <br>
    </div>
    <div class="linha">
        <input name="Consultar" type="SUBMIT" class="btn" value="Consultar">
    </div>
    </form>
</body>
</html> 
```

# javafx - 我们可以像 swing JSplitPane 一样在 Javafx SplitPane 上添加 OneTouchExpansable 按钮吗

> ID：10558063
> 
> 赞同：1
> 
> 时间：2012-05-11T20:17:35.823
> 
> 标签：javafx, javafx-2

我可以在 JavaFX 上使用 css/java api 库添加 OneTouchExpandable 按钮吗`SplitPane`？这个选项已经存在于 Swing 中`JSplitPane`。但我在 JavaFX API 上找不到该选项。

我想，我们可以添加`Button`SplitPane 来进行自动折叠和/展开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T15:45:53.177

目前还没有这样的 API。您可以尝试添加`Button`分隔符或向[http://javafx-jira.kenai.com](http://javafx-jira.kenai.com)`SplitPane`提交功能请求

# bash - 按修改时间排序文件

> ID：10558064
> 
> 赞同：0
> 
> 时间：2012-05-11T20:17:40.323
> 
> 标签：bash, sorting

我想使用例如 bubblesort 对**修改时间**进行排序，并使用**stat -c %y %n filename**打印 arr[] 的每个元素。

```
 #!/bin/sh

 arr=(*)  # * is list of all file and dir names

 newest=${arr[0]}
 for f in "${arr[@]}";
 do 
    if [ $f -nt $newest ]; then 
    newest=$f  
    fi 
 echo "$(stat -c %y %n $newest)"
 done 
```

我想输出类似**ls -art --full-time**的输出，但当然这更完整。我的问题是为什么它不打印文件名？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:39:35.657

格式字符串需要是单个参数；使用引号来完成此操作。`echo $(stat ...)`正如我在评论中指出的那样，您可能也不想在那里使用。

```
stat -c '%y %n' "$newest" 
```

（从技术上讲，您应该做更多的引用，以防止文件名中包含空格的可能性。）

# .net - .NET 全球化是周末？

> ID：10558065
> 
> 赞同：4
> 
> 时间：2012-05-11T20:17:41.130
> 
> 标签：.net, globalization

> **可能重复：**
> [根据文化寻找周末](https://stackoverflow.com/questions/2019098/finding-weekend-days-based-on-culture)

.NET 中是否有任何可用的语言环境信息来了解给定日期是在**工作日**还是**周末**？

我*会*使用这个功能：

```
public Boolean IsWeekend(DateTime value, CultureInfo cultureInfo)
{
   return (value.DayOfWeek == DayOfWeek.Saturday || value.DayOfWeek == DayOfWeek.Sunday);
} 
```

但对于[某些文化](http://en.wikipedia.org/wiki/Workweek_and_weekend#Islamic_countries)，它返回无效结果。

.NET 是否已经完成了编译所有文化的周末几日的工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T15:22:41.343

这是一个非常有趣的问题，答案似乎是否定的，.Net 中没有这样的功能。当然你可以使用[DateTimeFormatInfo](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo)的[FirstDayOfWeek](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.firstdayofweek)属性，但是还***不够***好。

它只会告诉你前一天很有可能是周末。但是，它不是很有帮助（另一个呢，......），因为有些国家只有[一天的周末](http://en.wikipedia.org/wiki/Workweek_and_weekend#Chile)。此外，在穆斯林国家，他们通常将星期五作为周末，但是......他们中的一些人也有星期四，一些星期六，我相信我听说过星期五和星期日休息的国家。在这种情况下，谈论周末将是相当困难的......

我查看了[CLDR Charts](http://cldr.unicode.org/index/charts)，但找不到合适的信息。看来你是一个人。
理论上，您可能会想到使用[ICU](http://site.icu-project.org/)的[Calendar 类](http://icu-project.org/apiref/icu4c/classCalendar.html)，它有`isWeekend()`方法，但导入一个 dll 只是为了使用其中的一个类听起来很糟糕。

# ruby-on-rails - 如何索引呈现相同视图的过滤记录？

> ID：10558067
> 
> 赞同：1
> 
> 时间：2012-05-11T20:17:58.033
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, indexing

我正在使用 Ruby on Rails 3.2.2，当我必须索引呈现*相同*视图的“过滤”记录时，我会选择正确的方式进行。

也就是说，我有由用户创建的文章和不是由该用户创建的文章，并且两者都可以由该用户索引。由于我必须显示那些记录“过滤”用户创建或不创建的文章，我认为处理这种情况的方法如下（在`ArticlesController`类中并通过呈现相同的视图）：

```
def index
  @articles =
    case params[:filter]
      when nil
        Article.all
      when "created_by_me"
        Article.created_by(@current_user)
    end

   ...
end 
```

以上是“正确”的继续方式吗？或者，也许，我应该实现一个新的控制器动作，例如，`index_my`？或者，也许，别的什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-17T00:11:37.167

将过滤器参数添加到索引比构建几个不同的索引操作要好得多。它还允许您灵活地添加更多过滤器，而无需添加更多重复的索引操作。

# c# - System.UnauthorizedAccess 异常：对路径 c:\\ 的访问被拒绝

> ID：10558071
> 
> 赞同：0
> 
> 时间：2012-05-11T20:18:20.493
> 
> 标签：c#, winforms

我正在从数据库上传和检索文档。上传效果很好但是检索是导致错误的原因 这是检索代码

```
DataGridViewRow row = dataGridView1.CurrentRow;
            int SelectedplantId = Convert.ToInt32(row.Cells["PId"].Value);
            SQLiteConnection conn = new SQLiteConnection(connString);
            conn.Open();
            string qry = "select Otherdocuments from Plant where PId = @PId";
            SQLiteCommand cmd = new SQLiteCommand(qry, conn);
            cmd.Parameters.AddWithValue("@PId", SelectedpId);

            byte[] buffer = (byte[])cmd.ExecuteScalar();
            conn.Close();

            //string filename = Application.StartupPath + "\\" + sFileName;
           string SaveLocation = "C:" + "\\" + sFileName;
           FileStream fs = null;
           try
           {
               fs = new FileStream(SaveLocation,FileMode.Create);
               fs.Write(buffer, 0, buffer.Length);
           }
           finally
           {
               if (fs != null)
               {
                   ((IDisposable)fs).Dispose();
               }
           } 
```

在 fs = new FileStream(SaveLocation,FileMode.Create); 是发生此异常的地方。

```
Stack Trace
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode)
   at RVEST.frmPlant.btnRetrieveDocs_Click(Object sender, EventArgs e) in C:\D_Drive_Stuff\RVESTV2\RVEST\frmPlant.cs:line 169
   at System.Windows.Forms.Control.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnClick(EventArgs e)
   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.ButtonBase.WndProc(Message& m)
   at System.Windows.Forms.Button.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
   at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
   at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
   at System.Windows.Forms.Application.Run(Form mainForm)
   at RVEST.Program.Main() in C:\D_Drive_Stuff\RVESTV2\RVEST\Program.cs:line 26
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart()
Thank you 
```

太阳

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:22:00.973

错误消息似乎很明显，该应用程序没有写入权限，`C:\`并且可能两者都没有`Application.StartupPath`。

```
 //string filename = Application.StartupPath + "\\" + sFileName;
 //string SaveLocation = "C:" + "\\" + sFileName;
 string SaveLocation = Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), sFileName); 
```

还有一些其他`SpecialFolder`的可能适用。

# android - ListView中具有灵活高度的Android自定义行布局

> ID：10558073
> 
> 赞同：1
> 
> 时间：2012-05-11T20:18:25.817
> 
> 标签：android, android-layout, android-listview, android-linearlayout, android-view

嗨，我正在尝试创建这样的行： ![在此处输入图像描述](../Images/4a668881df16ba5c858e3e01723935c5.png)

该行应该具有灵活的高度，并且随着字幕文本的长度变高。左侧的绿色视图也应该增长以填满行的整个高度。行高应仅根据文本（标题+副标题）确定。

这是我创建的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

        <View
            android:id="@+id/is_in_range_view"
            android:layout_width="15dip"
            android:layout_height="fill_parent"
            android:background="#99CC00" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:gravity="center_vertical"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/row_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dip"
                android:layout_marginTop="5dip"
                android:text="@string/title"
                android:textSize="16sp" />

            <TextView
                android:id="@+id/row_subtitle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginBottom="5dip"
                android:layout_marginLeft="10dip"
                android:text="@string/subtitle"
                android:textSize="12sp" />

            <View
                style="@style/SeparatorLine"
                android:layout_width="fill_parent"
                android:layout_height="1dip"
                android:layout_marginTop="5dip" />
        </LinearLayout>
</LinearLayout> 
```

但这是我得到的结果：

![在此处输入图像描述](../Images/236f3d81e75148ac79bd073c394ac454.png)

显然`fill_parent`View 的 layout_height 属性的值是有问题的，但这正是我想要的！我只希望行高基于文本，而不是绿色视图。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:51:38.687

好的，问题是我在包含两个`layout_height`的内部输入了错误的值。它被设置为而不是.`LinearLayout``TextView's``fill_parent``wrap_content`

一旦设置为`wrap_content`一切顺利。

正确的布局代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<View
    android:id="@+id/is_in_range_view"
    android:layout_width="15dip"
    android:layout_height="fill_parent"
    android:background="#99CC00" />

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_vertical"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/row_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dip"
        android:layout_marginTop="5dip"
        android:maxLines="1"
        android:text="@string/title"
        android:textSize="16sp" />

    <TextView
        android:id="@+id/row_subtitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="5dip"
        android:layout_marginLeft="10dip"
        android:maxLines="3"
        android:text="@string/subtitle"
        android:textSize="12sp" />

    <View
        style="@style/SeparatorLine"
        android:layout_width="fill_parent"
        android:layout_height="1dip"
        android:layout_marginTop="5dip" />
</LinearLayout> 
```

# android - HttpURLConnection、HttpClient 和 HttpPost 请求不适用于 Android 中的 POST 请求

> ID：10558074
> 
> 赞同：0
> 
> 时间：2012-05-11T20:18:28.120
> 
> 标签：android, http-post, response, httpurlconnection

我尝试了许多不同的方法来获得 http 响应，但总是收到消息为空。我曾尝试使用 chrome 附带的 Advance Rest Client 工具。在那我得到了成功的回应。我不知道我在哪里做错了。

```
try {

        String urlParameters = "id=userid&password=password&device=android";

        URL url = new URL("my url");
        HttpURLConnection urlConnection = (HttpURLConnection) url
                .openConnection();

        urlConnection.setRequestMethod("POST");
        urlConnection.setRequestProperty("Content-Type",
                "application/x-www-form-urlencoded");

        urlConnection.setRequestProperty("Content-Length",
                "" + Integer.toString(urlParameters.getBytes().length));
        urlConnection.setRequestProperty("Content-Language", "en-US");

        urlConnection.setUseCaches(false);
        urlConnection.setDoInput(true);
        urlConnection.setDoOutput(true);

        OutputStream outputStream = urlConnection.getOutputStream();
        outputStream.write(urlParameters.getBytes());
        outputStream.close();

        int responseCode = urlConnection.getResponseCode();
        if (responseCode == HttpURLConnection.HTTP_OK) {
            InputStream in = urlConnection.getInputStream();
            resultstring = convertinputStreamToString(in);
            Log.d("Result String-------->", resultstring);
        }
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

我附上了我得到结果的截图：成功但在上面的代码中我得到结果：失败

![在此处输入图像描述](../Images/fd0621922722c5f6c6a3beef1c2701c4.png)

我也尝试过使用 HttpClient 和 HttpPost 的代码。但这也不起作用

```
 try {
        HttpClient client = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(
                "my url");

        httpPost.setHeader("Accept", "application/json");
        httpPost.setHeader("Content-type", "application/x-www-form-urlencoded");

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(3);
        nameValuePairs.add(new BasicNameValuePair("id", "userid"));
        nameValuePairs.add(new BasicNameValuePair("password", "password"));
        nameValuePairs.add(new BasicNameValuePair("device", "android"));

        // httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        UrlEncodedFormEntity se = new UrlEncodedFormEntity(nameValuePairs);
        se.setContentType("application/x-www-form-urlencoded");
        httpPost.setEntity(se);
        httpPost.getParams().setBooleanParameter(
                "http.protocol.expect-continue", false);

        HttpResponse response = client.execute(httpPost);

        String responseAsText = EntityUtils.toString(response.getEntity());
        Log.d("Result String-------->", responseAsText);
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

请帮帮我。我几乎尝试了一切。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-11T21:20:51.307

```
HttpClient localHttpClient = this.app2.getHttpClient();
  HttpPost localHttpPost = new HttpPost("yourURL.com");
  localHttpPost.setEntity(new UrlEncodedFormEntity(myArrayList));
  InputStream localInputStream = localHttpClient.execute(localHttpPost).getEntity().getContent(); 
```

尝试这样的事情。您必须将响应作为输入流读取，然后在返回结果后执行您的工作。

另外，请务必检查服务器，因为它可能不会按预期返回响应。

# facebook - 在 Facebook 帖子上点赞和评论旁边添加分享按钮

> ID：10558080
> 
> 赞同：3
> 
> 时间：2012-05-11T20:18:43.550
> 
> 标签：facebook, facebook-graph-api, share

我正在使用 Facebook 的提要对话框：http: [//developers.facebook.com/docs/reference/dialogs/feed/](http://developers.facebook.com/docs/reference/dialogs/feed/)

每当我使用它发布内容时，Facebook 都会在底部添加 2 个链接（点赞和评论）：

![在此处输入图像描述](../Images/ab847f52c562eca87f3688321b1b4cbc.png)

但是，当我在时间轴中看到其他帖子时，我也会看到一个“分享”链接：

![在此处输入图像描述](../Images/eda637a1a6793b35a4c9989f8935288a.png)

如何指示 Facebook 也通过提要对话框添加此“分享”链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:31:16.327

具有共享选项的帖子是本地帖子，而不是应用程序帖子。您的帖子有“via Careers, Jobs and Recruitment App”，这意味着它是一个申请帖子。为了让您拥有原生的“分享”选项，您必须使用原生帖子，其中涉及使用[sharer.php](http://developers.facebook.com/docs/share/)（请参阅底部附近的“创建您自己的分享 URL”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:24:58.247

您不能拥有来自应用程序的提要帖子的共享链接，但您可以拥有链接帖子，如第二个示例中所述。或者您也可以将操作链接添加到这样的帖子消息中。

```
FB.ui(
   {
     method: 'feed',
     name: 'Facebook Dialogs',
     link: 'http://venu.com/',
     picture: 'http://venu.com/f8.jpg',
     caption: 'Venu site',
     description: 'asdasdasdasd.',
     message: 'asdasdasd!',
    actions: [
        { name: 'share', link: 'link here' }
      ]

   },
   function(response) {
     if (response && response.post_id) {
       alert('Post was published.');
     } else {
       alert('Post was not published.');
     }
   }
 ); 
```

链接将指向您网站/应用程序中的自定义页面。由于用户正在尝试共享其他人发布的消息，因此您应该在服务器中拥有该消息。您可以在自定义 URl 中传递消息的 id。

希望这可以帮助你:)

**[编辑]**

或者

您可以添加一个带有共享按钮的链接，您必须使用“我/链接”而不是“我/提要”。不幸的是，这不是一个完整的替代方法，因为 Facebook 在使用此方法时会忽略描述、标题和图片参数。这是此处发布的错误。（https://developers.facebook.com/bugs/194522957295380）

```
$attachment = array(
    'access_token'=>TOKEN_HERE,
    'message'=>'message_here',
    'link' => 'http://www.example.com/',
);

$result = $facebook->api(
    'me/links',
    'post',
    $attachment
); 
```

所以，现在这类似于在您的网站上有一个赞按钮。Facebook 从给定链接中的开放图元标签中提取信息。

```
<head>
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="name for ENTIRE SITE"/>
    <meta property="og:title" content="name of PAGE"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="<URL HERE>"/>
    <meta property="og:description" content="my description" />
    <title>Untitled</title>
</head> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T21:23:13.023

使用 Like Button 社交插件与使用 Sharer.php 方法几乎相同，并且是当前支持的 Share 按钮替代品。

如果您有一个网页，当用户单击“喜欢”按钮时，他们将发布一个链接到他们的墙上，其中将有一个“分享”链接。

您可以在画布应用程序中执行类似的操作，但这不适用于需要动态文本的 Feed 帖子，例如用户名或他们在应用程序中的操作的某些值。

# android - android 2.2 及更高版本中的外键

> ID：10558082
> 
> 赞同：0
> 
> 时间：2012-05-11T20:18:57.513
> 
> 标签：android

在 android 2.2 及更高版本中，SQLite 支持外键，但默认情况下它们是禁用的。在我的应用程序中，我使用 database.execSQL("PRAGMA foreign_keys=ON"); 每次打开数据库后。

我有两个问题：

1.  为什么默认禁用外键？
2.  您有更好的解决方案来启用外键吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:55:54.173

默认情况下，外键在 SQLite 中也被禁用（为了向后兼容）——我认为它甚至在 SQLite FK 文档中也是如此。因此，Android 根本*不会*扰乱默认行为。

这`PRAGMA`是启用外键支持的正确方法。

# python - Dropbox Python SDK SSL 错误

> ID：10558088
> 
> 赞同：0
> 
> 时间：2012-05-11T20:19:19.940
> 
> 标签：python, ssl, dropbox-api

我正在学习如何使用 Dropbox Python SDK。但是，当我尝试生成请求令牌时遇到了问题。这是我正在使用的代码（请注意，我在这里用 APP_KEY 和 APP_SECRET 替换了我的实际应用程序密钥和秘密，但我在尝试时使用了我的实际应用程序密钥和秘密。）

```
from dropbox import client, rest, session
APP_KEY = 'APP_KEY'
APP_SECRET = 'APP_SECRET'
ACCESS_TYPE = 'app_folder'
print 'Creating session object'
sess = session.DropboxSession(APP_KEY, APP_SECRET, ACCESS_TYPE)
print 'Session created!\nCreating request token'
request_token = sess.obtain_request_token()
print 'Created request token!'
url = sess.build_authorize_url(request_token)
print url
raw_input()
access_token = sess.obtain_access_token(request_token)
client1 = client.DropboxClient(sess)
print client1.account_info() 
```

我让程序在创建不同的对象时打印出消息，以便我可以看到错误发生的位置。这是输出：

```
aaron@Aarons-Ubuntu-Computer:~/Twisted$ python example.py
Creating session object
Session created!
Creating request token
Traceback (most recent call last):
  File "example.py", line 8, in <module>
    request_token = sess.obtain_request_token()
File "/usr/local/lib/python2.7/dist-packages/dropbox-1.4-py2.7.egg/dropbox/session.py", line 160, in obtain_request_token
response = rest.RESTClient.POST(url, headers=headers, params=params, raw_response=True)
File "/usr/local/lib/python2.7/dist-packages/dropbox-1.4-py2.7.egg/dropbox/rest.py", line 140, in POST
  return cls.request("POST", url, post_params=params, headers=headers, raw_response=raw_response)
File "/usr/local/lib/python2.7/dist-packages/dropbox-1.4-py2.7.egg/dropbox/rest.py", line 64, in request
  conn = ProperHTTPSConnection(host, 443)
File "/usr/local/lib/python2.7/dist-packages/dropbox-1.4-py2.7.egg/dropbox/rest.py", line 214, in __init__
  self.cert_reqs = ssl.CERT_REQUIRED
AttributeError: 'module' object has no attribute 'CERT_REQUIRED' 
```

我之前曾尝试使用此代码，但没有遇到此问题。我还删除了 Dropbox SDK 并重新安装它，但没有任何结果。是什么导致了这个问题，我该如何解决？

**更新**

添加 Kannan 的代码后，输出如下所示： `Ready` `Generating session` `Session Generated!` `Generating request token` `['Certificate', 'CertificateOptions', 'CertificateRequest', 'Client', 'ClientContextFactory', 'Connector', 'ContextFactory', 'DN', 'DefaultOpenSSLContextFactory', 'DistinguishedName', 'KeyPair', 'Port', 'PrivateCertificate', 'SSL', 'Server', '__all__', '__builtins__', '__doc__', '__file__', '__name__', '__package__', 'implementedBy', 'implements', 'implementsOnly', 'interfaces', 'supported', 'tcp']` 然后我得到错误。我试过重新创建我的 SSL 证书，但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T15:43:44.880

我遇到了同样的错误。我尝试了您的建议，结果发现 ssl 模块没有属性' **file** '，并且在我打印 dir(ssl) 时只有 [' **doc** ',' **loader** ',' **name** ',' **package** ']。另外值得注意的是，当我在 google app engine 中尝试 print str(ssl) 时，我看到： module 'ssl' (built-in) 但是当我从命令行运行 python 时，我看到： module 'ssl' from '/ Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ssl.pyc' 并且命令行中的 ssl 具有**文件**属性。

不知道 ssl 是如何被劫持的......但我很确定它是。

编辑：**加载程序**是 google.appengine.tools.dev_appserver_import_hook.HardenedModulesHook 对象，位于 0x1142684d0

编辑：在这里发现一个相关的问题：[SSLError on Google App Engine (local dev-server)](https://stackoverflow.com/questions/7308202/sslerror-on-google-app-engine-local-dev-server)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T04:41:35.977

这很奇怪。Python 2.7 文档肯定提到[`ssl.CERT_REQUIRED`](http://docs.python.org/release/2.7/library/ssl.html#ssl.CERT_REQUIRED).

尝试修改 SDK，并在失败的行之前添加

```
print dir(ssl)
print ssl.__file__ 
```

这可能会帮助您找出问题所在。

# java - 解析 JSON 时出错，但代码似乎没问题

> ID：10558089
> 
> 赞同：0
> 
> 时间：2012-05-11T20:19:21.287
> 
> 标签：java, android, json, parsing, exception

首先，感谢您阅读我的问题。

由于网络请求，我有以下 Json。

```
{"GetCommunicationsResult":"
   {\"Rows\":
      [{\"Data\":\"2011-12-16T00:00:00\",\"Teacher\":\"Surname Name\",
       \"Communication\":\"bla bla bla and bla bla bla\"},

       {\"Data\":\"2011-10-18T00:00:00\",\"Teacher\":\"Surname Name\",
        \"Communication\":\"bla bla bla and bla bla bla\"}]
   }"
 } 
```

我需要对其进行解码才能使用我的程序。

1.  首先，我将 JSON 作为字符串资源

    ```
    JSONObject jsonData = readUrl("http://myWebSite/folder/site.svc/Communications/000884"); 
    ```

    （readurl 是一种将 json 作为字符串返回的方法）

2.  然后我使用这个字符串创建一个 JSONObject

    ```
    JSONObject BaseObject = new JSONObject(jsonData); 
    ```

    （奇怪的是，JSONObject 构造函数不提供任何 Inputstream 或 Reader 参数，而只提供字符串或类似参数）

3.  最后，我尝试减少我的 JSON

    ```
    JSONObject DerivatedObject=BaseObject.getJSONObject("GetCommunicationsResult"); 
    ```

但是我遇到了一个奇怪的异常：

```
Value {"Rows":[{"Data":"2011-12-16T00:00:00","Teacher":"Surname Name","Communication":"bla bla bla and bla bla bla"},{"Data":"2011-10-18T00:00:00","Teacher":"Surname Name","Communication":"bla bla bla and bla bla bla"}]} 
at GetCommunicationsResult of type java.lang.String cannot be converted to JSONObject 
```

关于如何解决这个问题的任何建议？
我不知道为什么我的代码实际上找到了 JSON，但它无法解码它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:24:03.610

你有一个错误的报价。请参阅此行的最后一个公开报价：

```
{"GetCommunicationsResult":" 
```

这导致该值是字符串而不是 JSONObject。你可以说它是一个字符串，因为所有其他“在 JSON 中都被转义了：

```
{\"Rows\": 
```

那应该是；

```
{"Rows": 
```

因此，导致该问题的服务器出现问题。也许你正在放这样的东西：

```
jsonObject.put("GetCommunicationsResult", someJsonObject.toString() ); 
```

# visual-studio-2010 - 如何使用 TFS 查看目录的更改日志？

> ID：10558094
> 
> 赞同：2
> 
> 时间：2012-05-11T20:19:45.687
> 
> 标签：visual-studio-2010, tfs

我有兴趣查看使用 TFS 解决方案的最新更改（我正在使用 Visual Studio）。但是，我似乎找不到选项：在解决方案或项目上使用*查看历史记录*会显示文件本身的历史记录。我错过了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:09:24.597

***如果您在源代码管理资源管理器窗口***中右键单击包含解决方案的文件夹，您将看到所有变更集。这很明显，但我也不得不要求它。我正在使用 TFS2010/VS2010。

**编辑** 以下是步骤：团队/连接到 Team Foundation Server / 选择团队项目/在团队资源管理器中 dblclick 源代码控制和源代码控制探索包含您的解决方案的右键单击文件夹，选择查看历史记录，您就在这里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:10:57.110

查看历史命令将列出文件/目录更改的所有更改集（添加/移动/内容更改、删除等）。

因此，如果您对 .sln 或 .csproj 文件执行查看历史记录，您将只能看到在文件内容中所做的更改，而不是“Visual Studio 项目”及其相关项目。

总而言之，查看历史命令只是一个**文件系统**历史，没有更智能的逻辑。

**编辑**

了解解决方案或项目内部发生了什么变化的唯一方法是在公分母上执行查看历史记录（即包含您想要查看历史记录的所有内容的目录）。但它仍然是一种文件系统的历史。

Visual Studio 中没有解决方案和项目的逻辑历史记录。例如，您无法知道在查看两个给定版本的历史记录时将哪些文件添加到给定项目中。或者解决方案中添加/删除了哪些项目。

所有部分都在那里（因为所有更改都存储在 .csproj 或 .sln 中），但是解析内容并检索您想要查看的逻辑的功能本身并不存在。（顺便说一句，这是一个很棒的功能，我同意它应该在那里）。

底线：TFS/Visual Studio 为您提供两个历史系统：

1.  基于源代码控制/文件系统，通过显示变更集。
2.  基于源代码控制/文件系统，通过显示标签。

就这样...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T20:23:26.397

右键单击解决方案资源管理器中的文件夹，然后选择查看历史记录。然后您可以看到列出的所有适用于该目录的变更集。然后右键单击特定变更集并选择`Changeset details...`查看该变更集中发生的更改。

# java - 登录仅适用于数据库中的最后一个用户

> ID：10558097
> 
> 赞同：0
> 
> 时间：2012-05-11T20:19:53.563
> 
> 标签：java, mysql, jdbc

由于某种原因，登录仅适用于数据库中的最后一个用户。我有一个`while`循环，但我认为它使程序转到最后一个用户。我尝试使用`if`语句，但只有第一个用户可以登录。

```
 if (username!=null && password!=null) {
    pagename = "main";
    } else {
    username = request.getParameter("username");
    password = request.getParameter("password");

            while(results.next()) 
            { 
            if(results.getString(2).equals(password) && results.getString(1).equals(username)) 
            { 
            pagename="main";
            } 
            else 
            { 
            pagename="start";
            } 
    }
  } 
```

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:21:07.713

您正在将整个 DB 表复制到 Java 的内存中，并在`while`循环中对所有记录进行比较。当与记录匹配时，您不会中止`while`循环，因此它会继续循环剩余的记录，因此`pagename`每次都会被“开始”覆盖。

您需要添加一条`break`语句：

```
if (results.getString(2).equals(password) && results.getString(1).equals(username)) { 
    pagename="main";
    break;
} 
```

或者，更好的是，让 SQL 完成其设计的工作，**准确地**选择并返回您需要的数据：

```
preparedStatement = connection.prepareStatement("SELECT id FROM user WHERE username=? AND password=MD5(?)");
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);
resultSet = preparedStatement.executeQuery();

if (resultSet.next()) {
    pagename = "main";
}
else {
    pagename = "start";
} 
```

这样更有效，更明智。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:25:08.693

为什么要遍历整个表来执行此操作？如果你有 1000000 条记录怎么办？您应该使用传递用户名和密码参数的 WHERE 子句查询数据库，然后简单地检查是否有返回的行。

# c# - 内存泄漏 - 任何猜测它可能在哪里

> ID：10558098
> 
> 赞同：3
> 
> 时间：2012-05-11T20:19:55.070
> 
> 标签：c#, wcf, nhibernate, automapper-2

我正在处理 .Net 项目（Windows 服务），我发现内存泄漏。使用 ANTS 内存分析器，我已经确定 - 根本原因是在非托管内存范围内。但我不使用任何 COM/COM+ 或 p/invoke - 纯 .Net（DataAcces - Fluent nHibernate、Automapper、WCF）..

假设是什么原因？我怎样才能找到瓶颈..我对任何经历过并解决过这种问题的经历都感兴趣

更多细节：

*   我知道对象是如何处理的（并且做得对）
*   我（几乎）不使用事件
*   我正在使用计时器
*   我正在使用多线程（但它相当并行）
*   我的应用程序不是无状态的 - 我在对象的生命周期中跟踪它们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:49:32.317

## About Memory Leaks

Generally Speaking Memory Leaks still can exist in .net. (Sort of, not all of these are text book memory leaks per se) As in things get stuck in generation 2 garbage collection or when not disposing of object that inherit from IDisposable or for that matter Streams, Events, SQL connections that stay open and mess with you connection pool.While I am not an expert in the matter I will point you to a couple of places that may help you on your quest.

*   [Memory Management Fundementals](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/learning-memory-management/memory-management-fundamentals?utm_source=reflector&utm_medium=blog&utm_content=rickyleeks5&utm_campaign=antsmemoryprofiler)
*   [Detecting Memory Leaks in .NET](http://www.codeproject.com/Articles/42721/Best-Practices-No-5-Detecting-NET-application-memo#Introduction)

While you are at it Groking the way that garbage collection works helps in this sort of endevor a great deal. Start with something like [The Fundementals of Garbage Collection](http://msdn.microsoft.com/en-us/library/ee787088.aspx) for a general mental picture of just what the heck is going on with all that .NET magic behind the scenes.

## On the COM Stuff

Inherent in .NET there are many things that are just simply com and or win32 wrappers calling PInvoke behind the scenes. If gettin down and dirty with insides is what you are wanting then I'd recommend you look at a Decompiler (like IL Spy) where you suspect the leaky code.

Check this out for a deeper discussion on all the wrapper related stuff.
[Is .NET A Wrapper Around Win32?](http://www.grimes.nildram.co.uk/dotnet/dotnetWrappers.htm)

# java - 点运算符内的字符串

> ID：10558106
> 
> 赞同：0
> 
> 时间：2012-05-11T20:20:33.877
> 
> 标签：java, dot-operator

我很确定这是不可能的（考虑到它是如此糟糕的编程实践），但我还是要问。

在 Java 中，有没有办法使用点运算符使用字符串代替方法名称（或其他名称）？

例如：java.stringname.NumericShaper(); 其中字符串名称 = “awt.font”

我正在尝试将一些重复的代码放入迭代循环中。例如，我的变量之一是“Settings.can1.baud”，我想在每次循环时迭代“can1”部分。也许有更好的方法来做到这一点？

我是 Java 编程新手，所以我不确定这是否有意义......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:22:25.920

如果您的意思是您有一堆名为`can1`, `can2`,`can3`等的成员，那么您应该使用[数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)或[集合](http://docs.oracle.com/javase/tutorial/collections/index.html)来代替。

[可以使用反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)做你想做的事。但在这种情况下，它是繁琐的、不好的做法（通常），而且是不必要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:25:12.040

您可以使用反射来做到这一点：

```
try {   

        //loop over stringnames?
        String stringname = "awt.font";
        Class<?> numericShaperClass = Class.forName("java." + stringname + ".NumericShaper");

        NumericShaper numericShaper = (NumericShaper) numericShaperClass.newInstance();

    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } catch (InstantiationException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    }
} 
```

至于问题的第二部分，您可以使用 Class.getField() 方法访问 Properties 类的成员变量。

在这种情况下，使用反射可能有点过头了，可能会导致一些非常不可读的代码，并且可能会很慢。

# jquery - 如何保护 JQuery 参数

> ID：10558108
> 
> 赞同：0
> 
> 时间：2012-05-11T20:20:42.487
> 
> 标签：jquery, security

我在我的几个页面中使用 JQuery AJax。这个 JQuery Ajax 是使用带有少量参数的函数调用的，它调用 JQuery Ajax 并将记录插入数据库。我的问题是如何保护这个 Web 服务调用。

例子

在 .aspx 页面中，我放置了 JQuery Ajax 代码。

这个 Jquery Ajax 函数采用我将通过超链接传递的参数，并且这个调用可以在浏览器中进行查看源时公开访问。我的问题是如何在单击到 JQuery Ajax 函数的超链接上保护此传递参数。

我能想到的一种可能的方法是加密数据并分配给超链接，所以如果有人在浏览器中查看源代码，他只能获取加密数据，然后我可以在 Web 服务中解密这些数据并进行操作。但我正在为这个问题寻找更好的方法。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:40:18.510

正如已经指出的那样，这取决于您到底想实现什么，但假设您只想确保输入 URL 的任何人都无法使用该功能，一种选择是检查用户是否是如果您有登录系统，请在处理 ajax 调用的后端登录。

此外，您可以检查 jQuery 在发送 ajax 请求时设置的 HTTP_X_REQUESTED_WITH 标头（请参阅此处[检测 Ajax 调用 URL](https://stackoverflow.com/questions/3124636/detect-ajax-calling-url)），但请注意，仅实施不会使站点无懈可击，因为攻击者有可能伪造标头。

# foursquare - 在多请求中获取位置距离

> ID：10558109
> 
> 赞同：1
> 
> 时间：2012-05-11T20:20:53.400
> 
> 标签：foursquare

在尝试按 id 获取四方场地列表时，我最终使用了多端点。

但是，返回的场地与我当前的 lat long 没有距离值

所以，作为一个例子，我可以使用场地端点

*   [https://api.foursquare.com/v2/venues/43f9b9aaf964a520d12f1fe3?ll=47.62330382444445,-122.33604573666668](https://api.foursquare.com/v2/venues/43f9b9aaf964a520d12f1fe3?ll=47.62330382444445,-122.33604573666668)
*   这将返回一个具有距离值的场所

但是，尝试使用多端点做同样的事情

*   [https://api.foursquare.com/v2/multi?requests=/venues/43f9b9aaf964a520d12f1fe3,/venues/40a55d80f964a52020f31ee3&ll=47.62330382444445,-122.33604573666668](https://api.foursquare.com/v2/multi?requests=/venues/43f9b9aaf964a520d12f1fe3,/venues/40a55d80f964a52020f31ee3&ll=47.62330382444445,-122.33604573666668)
*   这**不会**返回距离值

知道如何在多请求中使用 lat long 参数吗？我找不到太多关于此的文档

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T03:30:53.507

您需要将“ll”参数作为“请求”中列出的每个请求的一部分传递。当前，“ll”参数被解释为“multi”端点的参数，而您实际上希望它成为两个“venues”请求中的每一个请求的参数。

您应该对两个完整请求（包括 ll 参数）进行 URL 编码，并将其设置为“requests”参数的值。

# iphone - 使用 Xcode 运行时应用程序挂起，但其他情况下工作正常

> ID：10558116
> 
> 赞同：0
> 
> 时间：2012-05-11T20:21:32.520
> 
> 标签：iphone, ios, xcode, ios-simulator, nslog

出于调试目的，我使用 xcode 运行应用程序并且 UI 冻结。如果我独立运行该应用程序，则该应用程序可以正常工作。

将 NSLog 语句通过管道传输到控制台会导致我的应用程序挂起吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:38:21.423

此错误已在 Xcode 4.4.1 的发布中得到修复。有关说明，请参阅以下错误报告：

[http://openradar.appspot.com/11972490](http://openradar.appspot.com/11972490)

# objective-c - 如何扫描字符串

> ID：10558117
> 
> 赞同：-2
> 
> 时间：2012-05-11T20:21:32.923
> 
> 标签：objective-c, macos, cocoa

我想扫描一个 NSString 以找到该文本：“S:027,13”然后如果扫描找到该文本（创建条件）

我找到了一些关于 NSScanner 的解释，但是对于我想做的“简单”事情来说，开发得太多了......

如果有人能照亮我的路:-)

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:26:53.567

if ([string rangeOfString:@"S:027,13"].location != NSNotFound)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:28:20.260

我很确定您正在寻找这个：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/ instm/NSString/rangeOfString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/rangeOfString)：

# c# - 将数据发送到部分视图模型和 .html() 速度慢的最佳方法

> ID：10558119
> 
> 赞同：0
> 
> 时间：2012-05-11T20:21:44.000
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3

想象一下，我有一个带有用户列表（循环）的部分视图，其中每个用户都是另一个部分视图，其中包含一个用户的详细信息。

```
foreach (var user in Model.Users)
 {
  <a href="#" onclick="JavascriptFunction(user.Id);">Details<a>
 } 
```

当我单击列表项之一的上述详细信息链接时，会弹出一个弹出窗口（JQuery modal dialog()），其中包含有关该选定用户的详细信息。或者至少这是目标。我需要将选定的用户详细信息添加到打开的新弹出窗口中。

所以现在我需要在 .dialog('Open') 触发之前使用用户详细信息填充弹出窗口将包含的部分视图后面的模型。

问题：从 Javascript 函数（上例中的 onclick JavascriptFunction 函数）调用 ActionMethod 并在显示对话框之前填充 Partial View 模型的最佳方法是什么？

现在我正在按照以下方式进行操作，但无论出于何种原因，我在页面上呈现的数据都会出现重大延迟。在 .html() 最终显示数据之前，我看到空白 div 5-10 秒：

在主列表页面上：

```
<div id="userPopup"></div> 
```

假设从 ActionMethod 加载带有用户详细信息的部分视图的 Javascript：

```
 $.post('@Url.Action("Details","User")', { id: userId},
        function (data) {

            $("#userPopup").html(data);
        }); 
```

可能有一种方法可以在页面上预加载部分视图，然后将我的数据加载到它的模型中而不重写整个 PartialView ？那将是理想的情况，但我认为没有办法做到这一点，是吗？

先感谢您 ！如果有任何事情听起来令人困惑，请随时提出问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:38:53.757

我认为您不应该在主页上预加载所有用户详细信息，如果您有 1000 多个用户并且访问者没有点击详细信息链接怎么办！我会这样做。每当用户单击链接时，调用返回数据的操作方法。

所以在你的主要观点中，

```
@foreach(var user in Model.Users)
{
  @Html.ActionLink(user.Name, "Details", "User",
                             new { Id = user.ID, }, new { @class ="popupLink" })

}

<script type="text/javascript">
$(function(){
    $(".popupLink").click(function (e) {
        e.preventDefault();
        var url = this.href;
        var dialog = $("#dialog");
        if ($("#dialog").length == 0) {
            dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
        }
        dialog.load(
            url,
            {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
            function (responseText, textStatus, XMLHttpRequest) {
                dialog.dialog({                       
                    close: function (event, ui) {                            
                        dialog.remove();
                    },
                    modal: true,
                    width: 460
                });
            }
        );         

    });
});
</script> 
```

在用户控制器中，有一个名为“详细信息”的操作方法，它接受 Id 作为参数并返回用户详细信息的视图

```
public ActionResult Details(int id)
{
  var usre=repositary.GetUser(id);
  return View(user);
} 
```

在 DetailsView 中添加 HTML 标记以获取详细信息。

此代码使用 jQuery UI 模型对话框。所以你需要包括它。

# keyboard - 设备和 AVD 上的不同行为

> ID：10558120
> 
> 赞同：0
> 
> 时间：2012-05-11T20:21:53.533
> 
> 标签：keyboard, nullpointerexception, avd, onclicklistener

目前我正在开发一个基于自定义键盘的应用程序。基本上，我有一个带有和编辑文本的布局和一个带有键盘布局的辅助 xml。该应用程序应该启动，隐藏默认键盘并显示自定义键盘。

几天前我完成了这个应用程序，我正在用 2.1 2.2 和 2.3 的 AVD 测试它，它们都像魅力一样工作！

之后我决定在实际设备上尝试，但自定义键盘不起作用，所以我调试了它。为键设置 onclick 侦听器时会出现问题，它们都抛出 nullPointerException。

真正让我感到困惑的是，它在 AVD 上完美运行，也为 AVD 调试了它，根本没有 nullPointerException。

这是正常的吗？

代码如下：

```
public class Main extends Activity implements OnTouchListener, OnClickListener,
    OnFocusChangeListener {
private EditText mEt;
private Button mBSpace, mBack, mBorrar;
private RelativeLayout mLayout, mKLayout;
private boolean isEdit = true; 
private int w, mWindowWidth;
private String cL[] = { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9",
        "A", "B", "C", "D", "E", "F", "G", "H", "I", "J",
        "K", "L", "M", "N", "Ñ", "O", "P", "Q", "R", "S", "T", "U", "V", "W",
        "X", "Y", "Z", ".", "?",  "!"}; 
private Button mB[] = new Button[40];

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    try {
        setContentView(R.layout.main);
        setKeys();  //get ids from xml and setOnClickListeners for every button.
        mEt = (EditText) findViewById(R.id.xEt);
        mEt.setOnTouchListener(this);
        mEt.setOnFocusChangeListener(this);
        mEt.setOnClickListener(this);
        mLayout = (RelativeLayout) findViewById(R.id.xK1);
        mKLayout = (RelativeLayout) findViewById(R.id.xKeyBoard);
        hideDefaultKeyboard(); //abrir teclado al prender app
        enableKeyboard();
        changeCapitalLetters();
        changeCapitalTags();

    } catch (Exception e) {
        Log.w(getClass().getName(), e.toString());
    }

}

@Override
public boolean onTouch(View v, MotionEvent event) {
    if (v == mEt) {
        hideDefaultKeyboard();
        enableKeyboard();
    }
    return true;
}

@Override
public void onClick(View v) {

    if (v != mBack && v != mBorrar) {

        addText(v);

    } else if (v != mBorrar  && v == mBack) {
        isBack(v);
    } else if (v != mBack && v == mBorrar) {
        isBorrar(v);
    }
}

@Override
public void onFocusChange(View v, boolean hasFocus) {
    if (v == mEt && hasFocus == true) {

        isEdit = true;

    } 

}

private void addText(View v) {
    if (isEdit == true) {
        String b = "";
        b = (String) v.getTag();
        if (b != null) {
            // adding text in Edittext
            mEt.append(b);

        }
    }

}

private void isBack(View v) {
    if (isEdit == true) {
        CharSequence cc = mEt.getText();
        if (cc != null && cc.length() > 0) {
            {
                mEt.setText("");
                mEt.append(cc.subSequence(0, cc.length() - 1));
            }

        }
    }

}
private void isBorrar(View v) {
    if (isEdit == true) {
        CharSequence cc = mEt.getText();
        if (cc != null && cc.length() > 0) {
            {
                mEt.setText("");
            }

        }
    }

}
private void changeCapitalLetters() {
    for (int i = 0; i < cL.length; i++)
        mB[i].setText(cL[i]);
}

private void changeCapitalTags() {
    for (int i = 0; i < cL.length; i++)
        mB[i].setTag(cL[i]);
}

// enabling customized keyboard
private void enableKeyboard() {
    mLayout.setVisibility(RelativeLayout.VISIBLE);
    mKLayout.setVisibility(RelativeLayout.VISIBLE);

}

// Disable customized keyboard
private void disableKeyboard() {
    mLayout.setVisibility(RelativeLayout.INVISIBLE);
    mKLayout.setVisibility(RelativeLayout.INVISIBLE);

}

private void hideDefaultKeyboard() {
    getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
    InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
    imm.hideSoftInputFromWindow(mEt.getWindowToken(), 0);
    //imm.hideSoftInputFromWindow(mKLayout.getApplicationWindowToken(), 0);

}

//get ids del xml y setOnClickListeners
private void setKeys() {
    mWindowWidth = getWindowManager().getDefaultDisplay().getWidth();
    mB[0] = (Button) findViewById(R.id.xCero);
    mB[1] = (Button) findViewById(R.id.xUno);
    mB[2] = (Button) findViewById(R.id.xDos);
    mB[3] = (Button) findViewById(R.id.xTres);
    mB[4] = (Button) findViewById(R.id.xCuatro);
    mB[5] = (Button) findViewById(R.id.xCinco);
    mB[6] = (Button) findViewById(R.id.xSeis);
    mB[7] = (Button) findViewById(R.id.xSiete);
    mB[8] = (Button) findViewById(R.id.xOcho);
    mB[9] = (Button) findViewById(R.id.xNueve);
    mB[10] = (Button) findViewById(R.id.xA);
    mB[11] = (Button) findViewById(R.id.xB);
    mB[12] = (Button) findViewById(R.id.xC);
    mB[13] = (Button) findViewById(R.id.xD);
    mB[14] = (Button) findViewById(R.id.xE);
    mB[15] = (Button) findViewById(R.id.xF);
    mB[16] = (Button) findViewById(R.id.xG);
    mB[17] = (Button) findViewById(R.id.xH);
    mB[18] = (Button) findViewById(R.id.xI);
    mB[19] = (Button) findViewById(R.id.xJ);
    mB[20] = (Button) findViewById(R.id.xK);
    mB[21] = (Button) findViewById(R.id.xL);
    mB[22] = (Button) findViewById(R.id.xM);
    mB[23] = (Button) findViewById(R.id.xN);
    mB[24] = (Button) findViewById(R.id.xENIE);
    mB[25] = (Button) findViewById(R.id.xO);
    mB[26] = (Button) findViewById(R.id.xP);
    mB[27] = (Button) findViewById(R.id.xQ);
    mB[28] = (Button) findViewById(R.id.xR);
    mB[29] = (Button) findViewById(R.id.xS);
    mB[30] = (Button) findViewById(R.id.xT);
    mB[31] = (Button) findViewById(R.id.xU);
    mB[32] = (Button) findViewById(R.id.xV);
    mB[33] = (Button) findViewById(R.id.xW);
    mB[34] = (Button) findViewById(R.id.xX);
    mB[35] = (Button) findViewById(R.id.xY);
    mB[36] = (Button) findViewById(R.id.xZ);
    mB[37] = (Button) findViewById(R.id.xPUNTO);
    mB[38] = (Button) findViewById(R.id.xPREGUNTA);
    mB[39] = (Button) findViewById(R.id.xEXCLAMACION);
    mBorrar = (Button) findViewById(R.id.xBorrar);
    mBSpace = (Button) findViewById(R.id.xSpace);
    mBack = (Button) findViewById(R.id.xBack);
    for (int i = 0; i < mB.length; i++)
        mB[i].setOnClickListener(this);
    mBorrar.setOnClickListener(this);
    mBSpace.setOnClickListener(this);
    mBack.setOnClickListener(this);

}

} 
```

和布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" android:id="@+id/xMLayout"
android:background="#000000" android:layout_height="fill_parent"
android:focusable="true"><!-- android:orientation="vertical"  -->
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" android:id="@+id/xsubLayout"
    android:keepScreenOn="true"
    android:layout_height="fill_parent"><!-- android:orientation="vertical"  -->
    <EditText android:id="@+id/xEt" android:layout_width="fill_parent"
        android:focusableInTouchMode="true" android:layout_height="wrap_content" />
    <!--<EditText android:id="@+id/et1" android:layout_width="fill_parent"
        android:layout_below="@+id/xEt" android:layout_height="wrap_content" />-->
</RelativeLayout>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" android:id="@+id/xK1"
    android:layout_height="wrap_content"
    android:visibility="gone"> <!-- android:orientation="vertical"  -->
    <include android:id="@+id/xKeyBoard" layout="@layout/keyboard"></include>
</RelativeLayout> 
```

键盘布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/hebrwKeyboardView" android:layout_width="fill_parent"
android:layout_alignParentBottom="true" android:layout_below="@+id/xsubLayout"
android:orientation="vertical" android:background="#252625"
android:visibility="visible" android:layout_height="225sp">
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" android:layout_height="225sp"
    android:orientation="vertical" android:layout_alignParentBottom="true"
    android:clipChildren="true">
    <TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content" android:layout_height="225sp"
        android:padding="0sp">
        <TableRow android:layout_width="fill_parent"
            android:layout_height="fill_parent" android:padding="0sp">
            <LinearLayout android:baselineAligned="true"
                android:layout_width="fill_parent" android:layout_height="45sp"
                android:fitsSystemWindows="true">
                <Button android:soundEffectsEnabled="true" android:id="@+id/xCero"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="0" android:textColor="#000" android:tag="0"
                    android:padding="0sp" android:textStyle="bold" android:layout_gravity="center"/>
                <Button android:soundEffectsEnabled="true" android:id="@+id/xUno"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:padding="0sp" android:textColor="#000" android:tag="1"
                    android:text="1" android:textStyle="bold" android:layout_gravity="center" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xDos"
                    android:layout_gravity="center" android:layout_width="32sp"
                    android:padding="0sp" android:layout_height="fill_parent"
                    android:text="2" android:tag="2" android:textStyle="bold"
                    android:textColor="#000" android:fitsSystemWindows="true" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xTres"
                    android:layout_width="32sp" android:layout_gravity="center"
                    android:layout_height="fill_parent" android:text="3" android:tag="3"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:fitsSystemWindows="true" /><!--  android:ellipsize="marquee" /> -->
                <Button android:soundEffectsEnabled="true" android:id="@+id/xCuatro"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:layout_gravity="center_horizontal" android:text="4"
                    android:tag="4" android:fitsSystemWindows="true"
                    android:textColor="#000" android:textStyle="bold"
                    android:ellipsize="marquee" android:padding="0sp"/>
                <Button android:soundEffectsEnabled="true" android:id="@+id/xCinco"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:tag="5" android:layout_gravity="center" android:text="5"
                    android:fitsSystemWindows="true" android:textColor="#000" android:padding="0sp"
                    android:textStyle="bold" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xSeis"
                    android:layout_width="32sp" android:layout_gravity="center_horizontal"
                    android:layout_height="fill_parent" android:text="6" android:tag="6"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:fitsSystemWindows="true" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xSiete"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="7" android:fitsSystemWindows="true" android:tag="7"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xOcho"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="8" android:fitsSystemWindows="true" android:tag="8"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xNueve"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:textColor="#000" android:textStyle="bold" android:text="9"
                    android:fitsSystemWindows="true" android:tag="9" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
            </LinearLayout>
        </TableRow>
        <TableRow android:layout_width="fill_parent"
            android:layout_height="fill_parent" android:padding="0sp">
            <LinearLayout android:baselineAligned="true"
                android:layout_width="fill_parent" android:layout_height="45sp"
                android:fitsSystemWindows="true">
                <Button android:soundEffectsEnabled="true" android:id="@+id/xA"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="A" android:textColor="#000" android:tag="A"
                    android:padding="0sp" android:textStyle="bold" android:layout_gravity="center"/>
                <Button android:soundEffectsEnabled="true" android:id="@+id/xB"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:padding="0sp" android:textColor="#000" android:tag="B"
                    android:text="B" android:textStyle="bold" android:layout_gravity="center" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xC"
                    android:layout_gravity="center" android:layout_width="32sp"
                    android:padding="0sp" android:layout_height="fill_parent"
                    android:text="C" android:tag="C" android:textStyle="bold"
                    android:textColor="#000" android:fitsSystemWindows="true" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xD"
                    android:layout_width="32sp" android:layout_gravity="center"
                    android:layout_height="fill_parent" android:text="D" android:tag="D"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:fitsSystemWindows="true" /><!--  android:ellipsize="marquee" /> -->
                <Button android:soundEffectsEnabled="true" android:id="@+id/xE"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:layout_gravity="center_horizontal" android:text="E"
                    android:tag="E" android:fitsSystemWindows="true"
                    android:textColor="#000" android:textStyle="bold"
                    android:ellipsize="marquee" android:padding="0sp"/>
                <Button android:soundEffectsEnabled="true" android:id="@+id/xF"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:tag="F" android:layout_gravity="center" android:text="F"
                    android:fitsSystemWindows="true" android:textColor="#000" android:padding="0sp"
                    android:textStyle="bold" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xG"
                    android:layout_width="32sp" android:layout_gravity="center_horizontal"
                    android:layout_height="fill_parent" android:text="G" android:tag="G"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:fitsSystemWindows="true" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xH"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="H" android:fitsSystemWindows="true" android:tag="H"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xI"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:text="I" android:fitsSystemWindows="true" android:tag="I"
                    android:textColor="#000" android:textStyle="bold" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xJ"
                    android:layout_width="32sp" android:layout_height="fill_parent"
                    android:textColor="#000" android:textStyle="bold" android:text="J"
                    android:fitsSystemWindows="true" android:tag="J" android:padding="0sp"
                    android:layout_gravity="center_horizontal" android:ellipsize="marquee" />
            </LinearLayout>
        </TableRow>
        ...
...
        <TableRow android:layout_width="fill_parent"
            android:layout_height="fill_parent" android:fitsSystemWindows="true"
            android:orientation="horizontal">
            <LinearLayout android:layout_width="fill_parent"
                android:layout_height="45sp" android:gravity="bottom"
                android:orientation="horizontal">
                <Button android:soundEffectsEnabled="true" android:id="@+id/xBorrar"
                    android:textColor="#000" android:textStyle="bold"
                    android:layout_width="115sp" android:layout_height="fill_parent"
                    android:tag="borrarTodo" android:text="BORRA_TODO" android:fitsSystemWindows="true" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xSpace"
                    android:textColor="#000" android:textStyle="bold"
                    android:layout_width="135sp" android:layout_height="fill_parent"
                    android:tag=" " android:text="|___ESPACIO___|" android:fitsSystemWindows="true" />
                <Button android:soundEffectsEnabled="true" android:id="@+id/xBack"
                    android:layout_width="70sp" android:layout_height="fill_parent"
                    android:textColor="#000" android:textStyle="bold" android:tag="back"
                    android:layout_gravity="center_horizontal|center_vertical|center"
                    android:fitsSystemWindows="true" android:text="BORRA" />
            </LinearLayout>
        </TableRow>
    </TableLayout>
</TableLayout> 
```

该应用程序基于我从以下网址下载的示例：http: [//tutorials-android.blogspot.com/2011/06/create-your-own-custom-keyboard-for.html](http://tutorials-android.blogspot.com/2011/06/create-your-own-custom-keyboard-for.html)

任何帮助都会很棒，我不知道现在还能尝试什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T15:44:18.443

我发现了问题所在。我使用的 AVD 的屏幕为 640x480，并使用标准布局 xml。我用来测试应用程序的物理设备是屏幕为 800x600 的平板电脑，因此针对没有所有按钮的 layout-large xml。

# objective-c - 如何对图像中的颜色进行采样

> ID：10558127
> 
> 赞同：1
> 
> 时间：2012-05-11T20:22:37.697
> 
> 标签：objective-c, ios, colors, uiimage

我正在尝试实现某种吸管，它可以对图像中的像素颜色进行采样并将其保存为 RGB 或 CMYK 颜色值。理想情况下，它将是可拖动的，并且可能具有类似于放大环的功能。如果有人能指出我的代码或有助于分配的组件的方向。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T07:19:15.483

要获得像素颜色，您可以使用 UIView 上的类别：[https ://github.com/ivanzoid/ikit/tree/master/UIView%2BColorOfPoint](https://github.com/ivanzoid/ikit/tree/master/UIView%2BColorOfPoint)

对于 draggabel 行为，您应该使用`UIPanGestureRecognizer`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:34:13.837

使用函数 NSReadPixel 为您提供传入点的颜色

# sql - 删除记录时自动递减 T-SQL ID？

> ID：10558129
> 
> 赞同：0
> 
> 时间：2012-05-11T20:22:55.887
> 
> 标签：sql, sql-server, tsql

在我们的一个应用程序中，我们从文件中读取数据并将其扩展为多个表。如果文件的任何部分损坏，我们会停止读取，并删除插入的任何数据。

这里的问题是，我们在其中一个导入表上有一个自动递增的 ID，当我们删除一个问题文件时，该 ID 将继续其导入后的值，而不是其导入前的值。

换句话说...

*   ID从50开始。
*   插入 100 条记录，现在最大 ID 为 150。
*   删除 100 条记录，最大 ID 仍然是 150。
*   插入50条记录，ID为200。

我们已经“丢失”了 100 条记录的范围。是否存在与自动增量相同的“自动减量”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:25:47.263

自动编号对您来说不应该那么有意义。他们的保证是他们只提供唯一性。如果您使用的是 sql server ，您仍然可以重新播种`DBCC CHECKIDENT`。

```
Checks the current identity value for the specified table and, if it is needed, changes the identity value. You can also use DBCC CHECKIDENT to manually set a new seed value for the identity column. 
```

来自 BOL：以下示例将 AdventureWorks 数据库中 Employee 表中的当前标识值强制为 30。

```
USE AdventureWorks;
GO
DBCC CHECKIDENT ('HumanResources.Employee', RESEED, 30);
GO 
```

我不推荐这个，只是指出来。 `DBCC CHECKIDENT`如果您尝试重新设置为已使用的值，则可能会引发错误，在这种情况下，如果您依赖此类任务，则必须具有逻辑。

我质疑是什么让这些数字如此重要的思考过程？听起来您想要一个称为`LineNumber`递增或递减的附加字段等。但即使在这种情况下，您也必须处理删除记录之后的行。因此，如果您有 50 行并删除第 25 行，则必须重新编号大于 25 的任何内容：

```
UPDATE 
       MyTable 
SET LineItemNumber = LineItemNumber - 1 
WHERE 
       LineItemNumber > @LineItemNumberToBeDeleted 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:27:08.570

删除时自动递减听起来是个坏主意。如果操作不正确，您可以开始在代码中注入更大的错误。如果 ID 很重要，请尝试给它一个批号，并为批次中的每个项目提供一个递增的 ID。您也可以使用指南，尽管它们不是顺序的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T20:27:32.233

您可以通过执行以下操作重新设置 AutoIncrement ID：

```
DBCC CHECKIDENT
(
  tablename

  [, [NORESEED | RESEED [, newreseedvalue]]]
) 
```

但是，我不建议将此作为最佳实践。您的查询应该是原子的（如果失败，它会提交并更新表或回滚（保持 ID 不变）。要实现原子查询，您可以使用`TRANSACTION`.

```
BEGIN TRY
   BEGIN TRANSACTION @TranName;

     -- Your database logic here

    COMMIT TRANSACTION @TranName;

END TRY

BEGIN CATCH

   ROLLBACK TRAN @TranName;

END CATCH

GO 
```

资料来源：

[http://msdn.microsoft.com/en-us/library/ms188929.aspx](http://msdn.microsoft.com/en-us/library/ms188929.aspx)

[http://www.techrepublic.com/blog/datacenter/how-do-i-reseed-a-sql-server-identity-column/406](http://www.techrepublic.com/blog/datacenter/how-do-i-reseed-a-sql-server-identity-column/406)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T17:31:39.497

根据我的经验，ETL（提取转换加载）过程这一部分的最佳实践是在多个步骤中执行批量加载：

1.  将文件中的数据加载到仅为此目的而存在的空“加载”或“暂存”表中。这会检测文件级损坏。
2.  检查数据的参照完整性和其他验证。这可以检测数据级错误。
3.  仅将有效数据插入“真实”表中。这避免了不必要的删除并避免浪费自动增量值。
4.  记录或报告未通过导入检查的数据。
5.  在下一次运行此过程之前，截断“加载”表。

# php - 使用 php 中的会话变量在 html 中打印图像

> ID：10558132
> 
> 赞同：0
> 
> 时间：2012-05-11T20:23:04.437
> 
> 标签：php, html, session-variables

我有这段代码试图使用 php 中的会话变量在 html 中打印图像。这是我的代码：

```
</head>
<body>
<?php
session_id(1);
session_start();
echo $_SESSION['phname'];
?>
<img src="../uploads/$_SESSION['phname']" alt="photo" width="498" height="720" border="0" /> 
```

这里：

```
session_id(1);
session_start();
echo $_SESSION['phname']; 
```

我正在检查我的变量是否已从 php 传递并且它没问题。和这里

```
?>
<img src="../uploads/$_SESSION['phname']" alt="photo" width="498" height="720" border="0" /> 
```

我正在使用 php 从以下来源打印图像

```
src="../uploads/$_SESSION['phname']" 
```

当 $_SESSION['phname'] 是我的图像名称但我没有得到图像时。我的代码有问题还是有其他方法可以打印我的图像？我尝试了很多东西和我在网上找到的很多代码，但没有什么能帮助我更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:27:12.217

您需要在`session_start`向浏览器输出任何内容之前执行您的操作，因为它会发送一些标头。

当然，当您想在 php 中回显某些内容时，您需要 php 标记和`echo`语句...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:27:26.540

```
<?session_start();?>
</head>
<body>
<?php
session_id(1);

echo $_SESSION['phname'];

echo "<img src=\"../uploads/". $_SESSION['phname']."\" alt=\"photo\" width=\"498\" height="720" border="0" />";
?> 
```

# web-applications - 如何仅使用密钥锁定付费客户的 Web 应用程序？

> ID：10558133
> 
> 赞同：-2
> 
> 时间：2012-05-11T20:23:09.637
> 
> 标签：web-applications

有些应用程序在购买时会让您输入某种密钥来证明您购买了该东西。很酷，但这是怎么做到的？不是为了黑客，而是出于好奇。它甚至有效吗？

比如说，

1.  一家虚构的 ACME 公司开发了 AcmeSuperDuperSlider。
2.  哪一个在 1 个域上购买和使用。

应用程序如何知道它何时在不同的域上使用？网页服务？

我可能需要在部署之前锁定某些东西，所以我正在寻找建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:25:58.700

这在 JavaScript 中永远不会完成，因为源代码不会对用户隐藏。

您必须使用某种服务器端语言并检查 HTTP 标头`REQUEST_URI`（或其等效项）的值。

在 JavaScript 中，您可以检查`window.location`，但就像我说的那样，这毫无意义。

# c# - Html 敏捷包。加载和抓取网页

> ID：10558149
> 
> 赞同：32
> 
> 时间：2012-05-11T20:24:26.937
> 
> 标签：c#, web-scraping, html-agility-pack

这是抓取时获取网页的*最佳方式吗？*

```
HttpWebRequest oReq = (HttpWebRequest)WebRequest.Create(url);
HttpWebResponse resp = (HttpWebResponse)oReq.GetResponse();

var doc = new HtmlAgilityPack.HtmlDocument();

doc.Load(resp.GetResponseStream());
var element = doc.GetElementbyId("//start-left");
var element2 = doc.DocumentNode.SelectSingleNode("//body");
string html = doc.DocumentNode.OuterHtml; 
```

我已经看到`HtmlWeb().Load`了一个网页。这是加载和抓取网页的更好选择吗？

* * *

好的，我会尝试。

```
HtmlDocument doc = web.Load(url); 
```

现在，当我得到我的`doc`并没有得到如此多的财产时。没有人喜欢`SelectSingleNode`。我唯一可以使用的是`GetElementById`，这很有效，但我想上课。

我需要这样做吗？

```
var htmlBody = doc.DocumentNode.SelectSingleNode("//body");
htmlBody.SelectSingleNode("//paging"); 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-05-11T20:28:13.210

使用 HtmlWeb 更容易。

```
string Url = "http://something";
HtmlWeb web = new HtmlWeb();
HtmlDocument doc = web.Load(Url); 
```

# asp.net - 文本框值在回发时消失

> ID：10558150
> 
> 赞同：0
> 
> 时间：2012-05-11T20:24:29.083
> 
> 标签：asp.net, vb.net, gridview

我有一个带有按钮的 asp.net 页面，该按钮向 gridview 添加额外的行以输入数据库。网格视图由 3 个文本框（模板字段）组成，当我添加一行时，已经输入的信息会以某种方式在回发中消失。我希望按钮添加其他行而不消除其他行中的数据，直到我点击提交按钮。这是我的代码

```
Private Sub AddNewRowToGrid()
    Dim rowIndex As Integer = 0
    If ViewState("CurrentTable") IsNot Nothing Then
        Dim dtCurrentTable As DataTable = DirectCast(ViewState("CurrentTable"), DataTable)
        Dim drCurrentRow As DataRow = Nothing
        If dtCurrentTable.Rows.Count > 0 Then
            For i As Integer = 1 To dtCurrentTable.Rows.Count
                'extract the TextBox values
                Dim box1 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(1).FindControl("txtAdjAppr"), TextBox)
                Dim box2 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(2).FindControl("txtAdjAmt"), TextBox)
                Dim box3 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(3).FindControl("txtCmmts"), TextBox)
                drCurrentRow = dtCurrentTable.NewRow()
                drCurrentRow("Approval Date") = box1.ToString
                dtCurrentTable.Rows(i - 1)("Total Amount") = box2.ToString
                dtCurrentTable.Rows(i - 1)("Comments") = box3.ToString
                'dtCurrentTable.Rows(i - 1)("Initials") = 
                rowIndex += 1
            Next
            dtCurrentTable.Rows.Add(drCurrentRow)
            ViewState("CurrentTable") = dtCurrentTable
            gvOLIAdj.DataSource = dtCurrentTable
            gvOLIAdj.DataBind()
        End If
    Else
        Response.Write("ViewState is null")
    End If
    'Set Previous Data on Postbacks
    'SetPreviousData()
End Sub

Private Sub SetPreviousData()
    Dim rowIndex As Integer = 0
    If ViewState("CurrentTable") IsNot Nothing Then
        Dim dats As DataTable = DirectCast(ViewState("CurrentTable"), DataTable)
        If dats.Rows.Count > 0 Then
            For i As Integer = 0 To dats.Rows.Count - 1
                Dim box1 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(1).FindControl("txtAdjAppr"), TextBox)
                Dim box2 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(2).FindControl("txtAdjAmt"), TextBox)
                Dim box3 As TextBox = DirectCast(gvOLIAdj.Rows(rowIndex).Cells(3).FindControl("txtCmmts"), TextBox)
                box1.Text = dats.Rows(i)("Approval Date").ToString()
                box2.Text = dats.Rows(i)("Total Amount").ToString()
                box3.Text = dats.Rows(i)("Comments").ToString()
                rowIndex += 1
            Next
        End If
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:09:26.190

I can think of two reasons why this may be happening:

1.  When you create controls dynamically it is VERY difficult to retrieve the values in the code behind after postback
2.  Your controls have the read-only attribute set in the raw HTML

You may want to try old-fashioned methods such as Request.Form [http://msdn.microsoft.com/en-us/library/ms525985%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms525985%28v=vs.90%29.aspx)

# php - 在“混合”类型的情况下，是否有办法在 IDE 的 Php 中进行代码竞争？

> ID：10558151
> 
> 赞同：-2
> 
> 时间：2012-05-11T20:24:30.910
> 
> 标签：php

让我们检查一个`Factory`类。它可以返回任何类，或者至少一个修复类。代码竞赛无法知道它的方法/属性，如何“告诉”IDE 的它的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:31:24.320

您可以使用 PHPDoc，大多数 IDE 都支持它。

```
/**
 * Factory::make()
 * 
 * @param string $classname
 *
 * @return Object - The object being made.
 */ 
```

# c++ - 错误：请求非类类型的成员

> ID：10558156
> 
> 赞同：0
> 
> 时间：2012-05-11T20:24:43.443
> 
> 标签：c++, forward-declaration

我正在使用前向声明，现在我收到一个错误，指的是使用前向声明的类......所以 fInstance 前向声明 fConfig，然后是 Helper 类（命名空间 - 用于对函数的全局访问） - 得到 t

**fConfig.h**

```
#ifndef FCONFIG_H
#define FCONFIG_H

#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <sstream>
#include <string>
#include <cstring>
#include <sys/types.h>
#include <fcntl.h>
#include "JWDSFork.h"
//#include "fInstance.h"

using namespace std;

class fConfig
{
    private:
        pid_t pid, w;

    public:
        pid_t cPid;
        string name;

        int group;
        int instanceId;
        int numInstance;
        int tries;

        bool reply;
        bool debug;
        bool service;
        bool currentlyRunning;

        time_t startTime;
        time_t endTime;

        string path;

        fConfig();
        virtual ~fConfig();

        void start();
        string intToString(int);
        char* stringToChar(string);
};

#endif // FCONFIG_H 
```

**fInstance.h**

```
#ifndef FINSTANCE_H
#define FINSTANCE_H

//#include "fConfig.h"
#include <vector>
#include <sys/types.h>
#include <string>

using namespace std;

class fConfig;

class fInstance
{
public:

    fConfig* config;
    pid_t pid;
    vector<string> notes;
    vector<time_t> times;

    fInstance();
    virtual ~fInstance();

};

#endif // FINSTANCE_H 
```

**助手.h**

```
#ifndef HELPER_H
#define HELPER_H

#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <string>
#include <cstring>
#include <vector>
#include <sstream>
#include <limits.h>
#include "fInstance.h"

using namespace std;

namespace Helper
{
    extern string APPDIR;

    bool errorCheck(int, char*);
    string charToString(char*, int);
    string longToString(unsigned long);
    bool Contains(vector<fInstance>, fInstance);
    string convertInt(int);
    string convertDouble(double);
    bool Read(int, char*, size_t);
    bool Write(int, char*, size_t);
};

#endif // HELPER_H 
```

**助手.cpp**

```
//Helper.cpp - function that causes a problem
#include "Helper.h"
namespace Helper
{

bool Contains(vector<fInstance> a, fInstance b)
    {
        for(unsigned int i= 0; i < a.size(); i++ )
        {
            if(a[i].config.name == b.config.name)
            {
                return true;
            }
        }

        return false;
    }
} 
```

我收到这些错误

```
error: request for member ‘name’ in ‘a.std::vector<_Tp, _Alloc>::operator[] [with _Tp = fInstance, _Alloc = std::allocator<fInstance>](((long unsigned int)i))->fInstance::config’, which is of non-class type ‘fConfig*’ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:28:37.350

这是一个非常不友好的错误消息，但这意味着该`config`成员是一个指针，因此您需要改用`->`运算符，即。

```
 if(a[i].config->name == b.config->name) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:34:12.387

假设您有一个 operator== 为您的 type 重载`fInstance`，您可以将您的函数编写为（另请注意，您应该传递参数`a`并`b`通过引用到 const）

```
#include<algorithm>

bool fInstance::operator==(const fInstance& other) 
{ 
    return config->name == other.config->name; 
}

bool Contains(const vector<fInstance>& a, const fInstance& b)
{
    return std::find_if(a.begin(), a.end(), b);
} 
```

如果你的类中没有`operator==`，`fInstance`你可以使用 C++11 [lambda 表达式](http://en.cppreference.com/w/cpp/language/lambda)

```
bool Contains(const vector<fInstance>& a, const fInstance& b)
{
    return std::find_if(a.begin(), a.end(), 
    [](const fInstance& i) { return i.config->name == b.config->name; });
} 
```

甚至更好的是，您应该将`name`成员封装到以下成员函数中`fInstance`：

```
std::string fInstance::name() { return config->name; };

bool Contains(const vector<fInstance>& a, const fInstance& b)
{
    return std::find_if(a.begin(), a.end(), 
    [](const fInstance& i) { return i.name() == b.name(); });
} 
```

这增加了封装，减少了编译时间，并使`fInstance`类的实现对其客户端不透明。您当前的实施使`fConfig`实施对客户透明。这种封装的减少被称为违反得[墨忒耳定律](http://en.wikipedia.org/wiki/Law_of_Demeter)。

# java - 从动作监听器中开始游戏

> ID：10558157
> 
> 赞同：6
> 
> 时间：2012-05-11T20:25:04.230
> 
> 标签：java, swing, event-handling, actionlistener

我有一个用 Java 制作的二十一点游戏，我想通过单击一个按钮来表示游戏开始。我所有的动作侦听器都可以正常工作，但问题在于如果游戏没有完全在 actionPerformed 方法中运行，我无法弄清楚如何启动游戏。显然，在 actionPerformed 方法中连续运行的函数将有效地禁用我的 GUI 的其余部分。这是一个代码片段......

```
go.addActionListener(new ActionListener()
    {
        public void actionPerformed(ActionEvent e)
        {
                 // START GAME SOMEHOW but must run outside of action listener
        }
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:41:46.077

> *Obviously, a function continuously running within the actionPerformed method will effectively disable the rest of my GUI.*

This is a valid observation and shows that you have understand the fundamental rule when working with Swing.

Your game is most likely event driven (correct me if I'm wrong) so the action performed by the button should just set the program in a new state, waiting for further events. This is nothing that should be time consuming, and is typically done directly by the EDT.

Of course, if you want to do a fancy start-new-game animation, that needs to be performed in a separate thread, in which case you simply start the animation thread (I would recommend using a SwingWorker though) from within the actionPerformed method, and then return.

In code, I imagine it would look something like this:

```
go.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {

        // Remove the menu components
        someJPanel.removeAll();

        // Show the game table
        someJPanel.add(new GamePanel());

        someJPanel.revalidate();
        someJPanel.repaint();

        // done. Wait for further user actions.
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:02:15.233

我相信您想扩展[javax.swing.SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)。

非 ui 启动功能将在[doInBackground](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html#doInBackground%28%29)中运行，并且在完成更新 ui 时将调用[done方法。](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html#done%28%29)

javadoc 类描述中甚至还有一个示例，可以用启动时发生的情况更新进度条。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T20:29:00.267

您的游戏可能应该从它自己的线程开始并自行管理（很难说），但是为了让您开始您的游戏，您可以在一个新的“外部”线程中开始您的游戏，在您的 actionPerformed 中是这样的：

```
public void actionPerformed(ActionEvent e) {
    Thread thread = new Thread("Game thread") {
        public void run() {
            startGame(); //or however you start your game
        }
    };
    thread.start();
} 
```

# mysql - 如何将具有相似时间戳的两行合并并返回两者

> ID：10558161
> 
> 赞同：1
> 
> 时间：2012-05-11T20:25:18.467
> 
> 标签：mysql

我有一个这样设置的 MySQL 比赛表。

```
|------------------------|
|bouts                   |
|------------------------|
|boutID                  |
|recording_athlete       |
|boutdate (timestamp)    |
|opponent                |
|recording_athlete_points|  
|------------------------| 
```

两个人之间的每次实际会面都会在表格中记录两次，具有唯一的 boutID 和 boutdate（反映实际进入的时刻，但在另一个 5 分钟内），其中一个记录的运动员是另一个的对手，反之亦然。这两个记录不一定是连续的。每天有两个参与者的额外会议，以较长的时间间隔分开：我们正在寻找时间戳和 ID 号最接近的两个（假设它们是属于一起的两个）。

我正在尝试 SELECT 一起属于一行的记录（并意识到并希望它会被执行两次），以便它将输出匹配的行，如下所示：

```
boutID|recording_athlete|boutdate|opponent|recording_athlete_points|boutID_b|boutdate_b|opponent_points
01|John|2012-05-10 20:33:04|Jane|15|04|2012-05-10 20:36:12|10
04|Jane|2012-05-10 20:36:12|John|10|01|2012-05-10 20:33:04|15 
```

这是我到目前为止所拥有的，以及我认为我需要去的地方，但只是不知道该使用什么。某种区间语句？还是我需要一个完全不同的结构？

```
SELECT 
    A.`boutID`,
    A.`recording_athlete`,
    A.`boutDate`,
    A.`opponent`,
    A.`recording_athlete_points`,
    B.`boutID` as `boutID_b`,
    B.`boutDate` as `boutdate_b`,
    B.`recording_athlete_points`as `opponent_points`
FROM bouts A
INNER JOIN bouts B on(A.`fullName` = B.`opponent` AND ????? )
ORDER by A.`boutDate` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:31:49.827

```
SELECT 
...
FROM bouts A
JOIN bouts B
   on A.fullName = B.opponent 
   AND B.boutdate between subdate(A.boutdate, interval 5 minute)
                      and adddate(A.boutdate, interval 5 minute) 
```

如果您在以下位置创建索引`boutdate`：

```
create index bouts_boutdate_index on bouts(boutdate); 
```

此查询将执行良好

# java - 从 Windows 桌面运行批处理文件以在 Eclipse 工作区中执行 Java 程序时出错

> ID：10558162
> 
> 赞同：0
> 
> 时间：2012-05-11T20:25:22.577
> 
> 标签：java, windows, eclipse, file, batch-file

我在 Eclipse 中有一个 Java 独立项目，其中包含大约 10 个包。我有一个主要方法（在​​ Eclipse 中），当从 Eclipse 执行时工作正常。

我已经编写了一个批处理文件来从桌面运行它。我只是单击批处理文件并希望运行该程序。

我的批处理文件代码如下。

**RunExecuteMyProg.bat**

```
echo Output of the Program
echo ---------------------

java C:\eclipse_workspace\eclipse\myprogram\MainProgram\ExecuteMainProgram

echo "Program Executed" 
```

该程序在 Eclipse 中运行时，通常需要 1 -4 分钟，具体取决于多种因素。但是当我单击 .bat 文件时，它会打开几分之一秒然后关闭。Java 在我的类路径上。当我尝试编译时，在命令提示符下，我收到编译错误，提示找不到某个类。然而，在日食上它运行良好。该程序运行时需要创建日志文件，但批处理文件没有任何反应。

PS：类文件与源文件在同一文件夹中创建。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:33:21.843

如果您打开命令提示符并在此处输入该命令，您将知道问题所在：

```
java C:\eclipse_workspace\eclipse\myprogram\MainProgram\ExecuteMainProgram 
```

可能是您的路径中没有java，或者您的程序已编写，因此它必须具有程序所在的当前工作目录等。或任何数量的东西。在命令提示符下手动执行该命令获取输出。

# xslt - 用于转换 xml 的 XSLT 样式表

> ID：10558164
> 
> 赞同：2
> 
> 时间：2012-05-11T20:25:35.393
> 
> 标签：xslt

我正在尝试创建一个 xslt 样式表来转换 xml。我研究过 muenchian 方法，但不熟悉它是如何工作的。我遇到了困难，因为每个 ManifestNo 都可以有任意数量的 SequenceNo。我正在尝试将源 xml 中的平面订单分组为目标 xml 中具有嵌套停止详细信息的订单。

```
<Orders>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>3524771-01</CustomerOrderNo>
    <Weight>180</Weight>
  </Order>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>3524771-02</CustomerOrderNo>
    <Weight>250</Weight>
  </Order>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>3524728-01</CustomerOrderNo>
    <Weight>25</Weight>
    </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>5464565-01</CustomerOrderNo>
    <Weight>150</Weight>
  </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>5874565-02</CustomerOrderNo>
    <Weight>125</Weight>
  </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>3524888-01</CustomerOrderNo>
    <Weight>95</Weight>
  </Order>
</Orders> 
```

到

```
<Orders>
     <Order>
        <ManifestNo>283749</ManifestNo>
        <Warehouse>35</Warehouse> 
        <Stop>
            <SequenceNo>1</SequenceNo>
            <Freight>
                <CustomerOrderNo>3524771-01</CustomerOrderNo>
                <Weight>180</Weight>
            </Freight>
            <Freight>
                <CustomerOrderNo>3524771-02</CustomerOrderNo>
                <Weight>250</Weight>
            </Freight>
        </Stop>
        <Stop>
            <SequenceNo>2</SequenceNo>
            <Freight>
                <CustomerOrderNo>3524728-01</CustomerOrderNo>
                <Weight>25</Weight>
            </Freight>
            <Freight>
                <CustomerOrderNo>3524771-02</CustomerOrderNo>
                <Weight>250</Weight>
            </Freight>
        </Stop>
         </Order>
        <Order>
        <ManifestNo>283750</ManifestNo>
        <Warehouse>50</Warehouse> 
        <Stop>
            <SequenceNo>1</SequenceNo>
            <Freight>
                <CustomerOrderNo>5464565-01</CustomerOrderNo>
                <Weight>150</Weight>
            </Freight>
        </Stop>
        <Stop>
            <SequenceNo>2</SequenceNo>
            <Freight>
                <CustomerOrderNo>5874565-02</CustomerOrderNo>
                <Weight>125</Weight>
            </Freight>
            <Freight>
                <CustomerOrderNo>3524888-0</CustomerOrderNo>
                <Weight>95</Weight>
            </Freight>
        </Stop>
         </Order>
    </Orders> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T03:05:35.870

**I. 这个 XSLT 1.0 转换**：

```
 <xsl:stylesheet version="1.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:key name="kOrderByNum" match="Order"
      use="ManifestNo"/>

     <xsl:key name="kSeqInOrder" match="SequenceNo"
      use="concat(../ManifestNo, '+', .)"/>

     <xsl:key name="kSeqByOrderNo" match="SequenceNo"
      use="../ManifestNo"/>

     <xsl:template match="Order"/>
     <xsl:template match="SequenceNo"/>

   <xsl:template match="/*">
     <Orders>
      <xsl:apply-templates/>
     </Orders>
     </xsl:template>

     <xsl:template match=
      "Order
         [generate-id()
         =
          generate-id(key('kOrderByNum', ManifestNo)[1])
          ]">
      <Order>
        <xsl:copy-of select="ManifestNo|Warehouse"/>

        <xsl:apply-templates select=
        "key('kSeqByOrderNo', ManifestNo)
          [generate-id()
          =
           generate-id(key('kSeqInOrder',
                           concat(../ManifestNo, '+', .)
                           )[1]
                      )
           ]
        "/>
      </Order>
     </xsl:template>

     <xsl:template match="SequenceNo[true()]">
      <Stop>
        <xsl:copy-of select="."/>
        <xsl:apply-templates mode="inGroup" select=
        "key('kSeqInOrder',
              concat(../ManifestNo, '+', .))"/>
      </Stop>
     </xsl:template>

     <xsl:template match="SequenceNo" mode="inGroup">
      <Freight>
        <xsl:copy-of select="../CustomerOrderNo|../Weight"/>
      </Freight>
     </xsl:template>
   </xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Orders>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>3524771-01</CustomerOrderNo>
    <Weight>180</Weight>
  </Order>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>3524771-02</CustomerOrderNo>
    <Weight>250</Weight>
  </Order>
  <Order>
    <ManifestNo>283749</ManifestNo>
    <Warehouse>35</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>3524728-01</CustomerOrderNo>
    <Weight>25</Weight>
    </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>1</SequenceNo>
    <CustomerOrderNo>5464565-01</CustomerOrderNo>
    <Weight>150</Weight>
  </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>5874565-02</CustomerOrderNo>
    <Weight>125</Weight>
  </Order>
  <Order>
    <ManifestNo>283750</ManifestNo>
    <Warehouse>50</Warehouse>
    <SequenceNo>2</SequenceNo>
    <CustomerOrderNo>3524888-01</CustomerOrderNo>
    <Weight>95</Weight>
  </Order>
</Orders> 
```

**产生想要的正确结果：**

```
<Orders>
   <Order>
      <ManifestNo>283749</ManifestNo>
      <Warehouse>35</Warehouse>
      <Stop>
         <SequenceNo>1</SequenceNo>
         <Freight>
            <CustomerOrderNo>3524771-01</CustomerOrderNo>
            <Weight>180</Weight>
         </Freight>
         <Freight>
            <CustomerOrderNo>3524771-02</CustomerOrderNo>
            <Weight>250</Weight>
         </Freight>
      </Stop>
      <Stop>
         <SequenceNo>2</SequenceNo>
         <Freight>
            <CustomerOrderNo>3524728-01</CustomerOrderNo>
            <Weight>25</Weight>
         </Freight>
      </Stop>
   </Order>
   <Order>
      <ManifestNo>283750</ManifestNo>
      <Warehouse>50</Warehouse>
      <Stop>
         <SequenceNo>1</SequenceNo>
         <Freight>
            <CustomerOrderNo>5464565-01</CustomerOrderNo>
            <Weight>150</Weight>
         </Freight>
      </Stop>
      <Stop>
         <SequenceNo>2</SequenceNo>
         <Freight>
            <CustomerOrderNo>5874565-02</CustomerOrderNo>
            <Weight>125</Weight>
         </Freight>
         <Freight>
            <CustomerOrderNo>3524888-01</CustomerOrderNo>
            <Weight>95</Weight>
         </Freight>
      </Stop>
   </Order>
</Orders> 
```

* * *

**二、XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kSeqByOrderNo" match="SequenceNo"
      use="../ManifestNo"/>

 <xsl:template match="/*">
   <Orders>
     <xsl:for-each-group select="Order" group-by="ManifestNo">
      <Order>
        <xsl:copy-of select="ManifestNo|Warehouse"/>

        <xsl:for-each-group select="key('kSeqByOrderNo', ManifestNo)"
         group-by=".">
         <xsl:copy-of select="."/>
         <Stop>
          <xsl:apply-templates select="current-group()"/>
         </Stop>
        </xsl:for-each-group>
      </Order>
     </xsl:for-each-group>
   </Orders>
 </xsl:template>

 <xsl:template match="SequenceNo">
   <Freight>
     <xsl:copy-of select="../CustomerOrderNo|../Weight"/>
   </Freight>
 </xsl:template>
</xsl:stylesheet> 
```

# c++ - 我怎样才能进一步专门化这个模板的想法？

> ID：10558168
> 
> 赞同：3
> 
> 时间：2012-05-11T20:25:50.190
> 
> 标签：c++, templates, boost, template-specialization, template-meta-programming

我可以通过我认为的模板专业化来做到这一点，对于 1,2,3 的嵌套（最常见的情况），分别嵌套 1,2,3 for 循环并通过它们在 stl 中的类型名来引用类型......但是对于任意深度，不使用预处理器，有没有办法做到这一点？也许用mpl？或者我还需要一个预处理器工具吗？现在我正在做这样的事情：

```
template<typename T, int>
struct MapDump {};

template<typename T >
struct MapDump<T,1>
{
  static void dump(const T& map, string file, string header="")
  {
    if (!header.empty())
      cout << header << endl;

    for (typename T::const_iterator cIt = map.begin();
         cIt != map.end();
         ++cIt)
      cout << cIt->first << "," << cIt->second << endl;
  }
};

template<typename T >
struct MapDump<T,2>
{
  static void dump(const T& map, string file, string header="")
  {
    if (!header.empty())
      cout << header << endl;

    for (typename T::const_iterator it1 = map.begin();
         it1 != map.end();
         ++it1)
      for (typename T::mapped_type::const_iterator it2 = it1->second.begin();
           it2 != it1->second.end();
           ++it2)
        cout << it1->first << "," << it2->first << "," << it2->second << endl;
  }
}; 
```

我可以打电话给，例如：

```
 map<int, map<int, double> > m;
  m[1][1] = 1.0;
  m[1][2] = 1.0;
  m[2][1] = 2.0;
  m[2][2] = 2.0;

  MapDump< map<int, map<int, double> >, 2 >::dump(m, "test.csv"); 
```

（我去掉了 fstream 的东西并留下了 std::cout 以简化此处的示例代码）我的问题是，当最后一级 mapped_type 是容器类型时，我该如何进行专业化？例如 map > 在技术上是一个 2-depth 构造，而不是一个单级构造...但是我的 2 个专业化嵌套不会为该类型编译...任何其他关于如何的建议，也许进一步抽象 thsi（弄清楚欢迎在编译时构造的深度）..谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:19:48.837

这将对所有嵌套类型执行递归，直到它到达非嵌套类型。它使用 SFINAE 来检测是否存在`mapped_type` 成员 typedef（您可以使用它`BOOST_HAS_XXX`来创建这样的助手）。

它还没有做的是收集键值并将它们传递到下一个级别。您可以收集向量中的键并继续向下传递它们，或者计算嵌套深度并使用近似元组（这会将编译时间复杂度增加到`n^2`）。

`decltype`如果您希望与 C++03 兼容，请不要使用and for_each 循环。

```
#include <map>
#include <iostream>

// sfinae to detect a mapped type
template<typename T>
struct has_mapped_type
{ 
private:
  typedef char one;
  typedef struct { char arr[2]; } two;
  template<typename U>
  struct wrap {};

  template<typename U>
  static one test(wrap<typename U::mapped_type>*);

  template<typename U>
  static two test(...);
public:
  static const bool value = sizeof(test<T>(0)) == 1;
};

template<typename T, bool has_mapped_type>
// false version
struct dump_impl {
  void operator()(const T& t) const {
    std::cout << t << std::endl;
  }
};

template<typename T>
// true version
struct dump_impl<T, true> 
  : dump_impl<
    typename T::mapped_type
    , has_mapped_type<typename T::mapped_type>::value
  > 
{
  void operator()(const T& t) const {
    for(auto& x : t) { 
      dump_impl<
        typename T::mapped_type
        , has_mapped_type<typename T::mapped_type>::value
        >::
        operator()(x.second);
    }
  }
};

template<typename T>
struct dump : public dump_impl<T, has_mapped_type<T>::value> {
  void operator()(const T& t) const {
    dump_impl<T, has_mapped_type<T>::value>::operator()(t);
  }
};

int main()
{
  std::map<int, std::map<int, double> > m;
  m[1][1] = 1.0;
  m[1][2] = 1.0;
  m[2][1] = 2.0;
  m[2][2] = 2.0;

  dump<decltype(m)>()(m);
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T14:43:07.110

尝试

```
template<int I>
struct Int { };

template<typename T, int I>
struct MapDump
{
  static void dump(const T& map, const string& file, const string& header="") {
    if (!header.empty())
      cout << header << endl;
    dump(map, "", Int<I>());
  }

private:
  template<typename Map, int I1>
  static void dump(const Map& map, const string& agg, Int<I1>) {
    for (typename Map::const_iterator cIt = map.begin();
         cIt != map.end();
         ++cIt) {
      dump(cIt->second, (agg + boost::lexical_cast<std::string>(
        cIt->first) + ", "), Int<I1-1>());
    }
  }

  template<typename D>
  static void dump(const D& d, const string& agg, Int<0>) {
     cout << agg << d << endl;
  }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T16:17:55.700

这是一个简单的递归函数模板，它将打印嵌套映射：

```
template <typename Last>
void dumpMap(const Last &last,const std::string &first)
{
  std::cout << first << last << "\n";
}

template <typename A,typename B>
void dumpMap(const std::map<A,B> &last,const std::string &first=std::string())
{
  typename std::map<A,B>::const_iterator i=last.begin(), i_end=last.end();
  for (;i!=i_end;++i) {
    std::ostringstream s;
    s << first << (*i).first << ",";
    dumpMap((*i).second,s.str());
  }
} 
```

你可以像这样使用它：

```
map<int, map<int, double> > m;
m[1][1] = 1.0;
m[1][2] = 1.0;
m[2][1] = 2.0;
m[2][2] = 2.0;

dumpMap(m); 
```

# jquery - jquery - 将 .click() 附加到多个变量

> ID：10558173
> 
> 赞同：1
> 
> 时间：2012-05-11T20:26:06.680
> 
> 标签：jquery, click

我有以下代码：

```
var buttonOne = $("#buttonOne");
var buttonTwo = $("#buttonTwo");

// opens an already initialized modal window 
(buttonOne, buttonTwo).click(function()
{
    modalBoxContainer.dialog("open");
}); 
```

这是行不通的。如果我使用元素，它将起作用，但不适用于变量。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T20:28:19.863

使用[`.add`](http://api.jquery.com/add/)方法。

```
buttonOne.add(buttonTwo).click(...); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:26:48.910

尝试组合选择器？

```
$("#buttonOne, #buttonTwo").click(... 
```

尽管您确实应该使用`on`(jQuery 1.7) 或`delegate`pre-1.7，但这将为处理程序中的所有元素创建一个事件。就像是：

```
$(document).on("click", "#buttonOne, #buttonTwo", function () {
    //function here
}); 
```

`on`文档：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

`delegate`文档：[http ://api.jquery.com/delegate/](http://api.jquery.com/delegate/)

# javascript - Javascript/jQuery mouseover 和 mouseout 事件监听器

> ID：10558174
> 
> 赞同：0
> 
> 时间：2012-05-11T20:26:26.120
> 
> 标签：javascript, jquery, html

不知道如何解决我目前遇到的问题。我正在构建一个 Javascript 和 PHP 驱动的图片库。基本的 div 结构是我有一个包含整个画廊的 div，一个用于显示的图像，一个包含“上一个按钮”的 div，另一个包含一个“下一个按钮”。

下一个/上一个按钮位于图像容器 div 底部的左侧/右侧（图库容器设置为相对位置，按钮 div 设置为绝对位置）。默认情况下，它们使用 jQuery 使它们不可见，并且当您将鼠标悬停在图像容器 div 上时它们变得可见。我遇到的问题是，当您将鼠标悬停在容器 div 上，然后悬停在箭头上时，过渡效果会重新播放，我不知道如何使用 HTML/CSS/JS 来解决这个问题。我当前的 div 结构是

```
<div id="galleryContainer">
  <div id="imageContainer">
    <img src="img" />
  </div>
  <div id="leftArrow"></div>
  <div id="rightArrow"></div>
</div> 
```

当我将鼠标悬停在下一个/上一个按钮上时，如何使我的淡入/淡出效果停止运行？当我建立 div 时，我尝试了一系列使用“onmouseover”监听器的组合，使用 jQuery 监听器，试图改变驱动器的层次结构。任何帮助，将不胜感激！

编辑：这是我目前正在尝试做的 jQuery 代码：

```
$(document).ready(function(){

$("#imageContainer").mouseover(function()
{
    $("#leftArrow").fadeIn();
    $("#rightArrow").fadeIn();
});

$("#galleryContainer").mouseout(function()
{
    $("#leftArrow").fadeOut();
    $("#rightArrow").fadeOut();
}); 
}); 
```

当我将按钮放在 imageContainer 内时，它仍然会出现淡入淡出错误/效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:39:35.600

您可能想要使用[$.mouseleave](http://api.jquery.com/mouseleave/) 和[$mousenter](http://api.jquery.com/mouseenter/)一个问题是 mouseout 和 mouseover 事件会冒泡。然后，当这些事件在其任何后代中发生时在#galleryContainer 上触发时，将调用您的处理程序

[http://jsfiddle.net/z2Y8a/20/](http://jsfiddle.net/z2Y8a/20/)

```
$("#imageContainer").mouseenter(function() {
    $("#leftArrow").fadeIn();
    $("#rightArrow").fadeIn();
});

$("#galleryContainer").mouseleave(function() {
    $("#leftArrow").fadeOut();
    $("#rightArrow").fadeOut();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:41:46.883

This is how I interpreted your question without seeing any code.. Let me know.
I added colors to the divs so you can see which is located where.

jsFiddle: [http://jsfiddle.net/z2Y8a/19/](http://jsfiddle.net/z2Y8a/19/)

```
<div id="galleryContainer" style="width:200px;height:200px;background:green;">
    <div id="imageContainer" style="width:50px;height:100px;background:blue;">
        <div style="height:75px;">
            <img src="img" />
        </div>
        <div id="leftArrow" style="width:25px;height:25px;background:red;float:left;display:none;">L</div>
        <div id="rightArrow" style="width:25px;height:25px;background:yellow;float:left;display:none;">R</div>
    </div>
</div>​

<script>
    $("#imageContainer").hover( function()
    {
        $("#leftArrow").toggle();
        $("#rightArrow").toggle(); 
    });​
</script> 
```

-- EDIT --

```
$("#galleryContainer").hover(function()
{
    $("#leftArrow").toggle();
    $("#rightArrow").toggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:02:08.090

如果您的箭头在图像容器内，它不会闪烁。或者也许将显示箭头效果放在主画廊容器中。基本上，当您的鼠标固定图像容器时，它会触发鼠标移出。当我说离开时，我的意思是在代码意义上，在视觉上它不会离开，因为你的位置不同但在代码意义上，你的鼠标离开了图像容器并进入了箭头容器

# sql - 如何获取有效日期，例如使用 ISDATE 函数而不删除 Null 值？

> ID：10558200
> 
> 赞同：0
> 
> 时间：2012-05-11T20:28:24.940
> 
> 标签：sql, sql-server-2008, tsql

今天是个好日子！

我正在使用`ISDATE()`带有日期列的 T-SQL 函数作为参数来过滤掉错误的日期；问题是该`ISDATE`函数在遇到`NULL`值时将返回零。

所以用下面的例子；如果它们的日期为空，则表中的有效数据将被排除在结果集中。我该如何解决这个问题，以便我可以获得有效日期，但也可以检索没有日期的记录？我也需要没有日期的记录，我只需要删除那些日期不正确的记录，例如，不完整的日期或缺少字符的日期。

例子：

```
SELECT * FROM EXAMPLE WHERE ISDATE(MAYDATE) <> 0 
```

谢谢我的朋友们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:36:04.570

您可以使用[ISNULL](http://msdn.microsoft.com/en-us/library/ms184325.aspx)函数将 NULL 值替换为仅由 ISDATE 函数使用的有效日期值。这里有两个例子：

```
SELECT * FROM EXAMPLE WHERE ISDATE(ISNULL(MAYDATE, '1/1/1900')) <> 0
SELECT * FROM EXAMPLE WHERE ISDATE(ISNULL(MAYDATE, GETDATE())) <> 0 
```

或者只是检查该值是否为 NULL

```
SELECT * FROM EXAMPLE WHERE (ISDATE(MAYDATE) <> 0) OR (MAYDATE IS NULL) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:30:50.627

尝试：

```
SELECT * FROM EXAMPLE WHERE ISDATE(MAYDATE) <> 0 OR MAYDATE IS NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T20:31:42.570

首先检查空值

```
SELECT * FROM EXAMPLE WHERE MAYDATE is null or ISDATE(MAYDATE) <> 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T20:31:05.353

```
SELECT * FROM EXAMPLE WHERE (MAYDATE IS NOT NULL AND ISDATE(MAYDATE) <> 0)
     OR (MYDATE IS NULL) 
```

# javascript - javascript: 交换图片和点击

> ID：10558201
> 
> 赞同：2
> 
> 时间：2012-05-11T20:28:35.150
> 
> 标签：javascript, jquery

```
<img src="logo.jpg" class="myImage" alt="Logotyp" /> 
```

这是我的 JavaScript 代码：

```
$(function() {
    var windowWidth = $(window).width();
    if (windowWidth <= 480) {
        $(".myImage").attr("src", "load.jpg");
    }
}); 
```

当窗口宽度 = 480 时，图像 logo.jpg 变为 load.jpg。工作正常。但我想要一个 onClick 功能，当您单击 load.jpg 时，它会再次变为 logo.jpg。似乎无法让它工作。建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T20:32:12.893

```
$(".myImage").click(function(){
   $(this).attr("src"," logo.jpg"); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:02:19.697

## *[jsBin 演示](http://jsbin.com/ubakuc/2/edit)*

你可以：

*   创建一个变量`windowWidth`
*   创建一个函数“ `changeImg()`”，它将根据`windowWidth`var 值处理转换。
*   我们可以在任何我们想要的地方使用我们的函数`changeImg()`：我们也可以在 a 中执行它，`$(window).resize()`因此更改也将应用于手动调整大小。
*   比点击我们玩脏，我们欺骗 windowWidth 设置一个巨大的数字并调用我们的`changeImg`函数。乐趣。

jQuery：

```
$(function() {

  var windowWidth = $(window).width();

  function changeImg(){
     if (windowWidth <= 480) {
        $(".myImage").attr("src", "http://www.rockettheme.com/distribution/download/file.php?avatar=63759_1251026504.jpg");
     }else{
        $(".myImage").attr("src", "http://screenshots.en.sftcdn.net/blog/en/2009/12/2t_firefox-logo.jpg");
     }
  }
  changeImg();

  $(window).resize(function(){
    windowWidth = $(window).width(); // grab width while resizeing
    changeImg();
  });

  $('img[alt=Logotyp]').on('click', function(){
    windowWidth = 9876; // we fool the windowWidth
    changeImg();    // we play dead and call our function :D
  });

}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-11T20:34:50.670

功能 myAlert() { alert("heelo wrold") };

$(.myImage).setAttribute ("onclick", "myAlert()");

没试过这个，但似乎是对的。〜本

# android - Android：Activity.runOnUiThread 和 View.post 有什么区别？

> ID：10558208
> 
> 赞同：102
> 
> 时间：2012-05-11T20:29:15.150
> 
> 标签：android

`Activity.runOnUiThread`和之间有什么区别`View.post`，有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-05-11T20:31:59.857

没有真正的区别，只是`View.post`当您无法直接访问活动时它很有帮助。

在这两种情况下，如果不在 UI 线程上，[`Handler#post(Runnable)`](http://developer.android.com/reference/android/os/Handler.html#post%28java.lang.Runnable%29)将在幕后调用。

正如评论中提到的 CommonsWare 一样，两者之间存在区别 - 在 Ui 线程上调用时，`Activity#runOnUiThread`将直接调用该`run`方法，而`View#post`将 发布`runnable`到队列中（例如调用`Handler#post`）

重要的一点 IMO 是两者都有相同的目标，对于使用它的人来说，**应该没有区别**（并且未来的实现可能会改变）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-03-28T11:19:44.870

Activity.runOnUiThread 和 view.post() 的另一个区别是 view.post() 中的可运行对象是在视图附加到窗口后调用的。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-11T20:58:52.517

在大多数情况下，两者都是可以接受的，并且在大多数情况下它们是可以互换的，但它们*有*细微的不同。当然，最大的区别是一个可从 an 获得`Activity`，另一个可从 a 获得`View`。它们之间有很多重叠，但有时在 an 中`Activity`您将无法访问 a `View`，有时在 a 中`View`您将无法访问`Activity`.

[我在对另一个 SO 问题的回答中](https://stackoverflow.com/questions/4083787/runnable-is-posted-successfully-but-not-run/10457064#10457064)`View.post`提到了我遇到的一个边缘情况：仅当附加到窗口时才*从另一个线程工作。*这很少会成为问题，但偶尔会导致永远不会执行，尤其是当您调用. 另一种方法是使用which is what并在幕后使用。[`View.post`](https://stackoverflow.com/questions/4083787/runnable-is-posted-successfully-but-not-run/10457064#10457064)`View.post`*`View``Runnable``View.post``onCreate``Activity`[`Handler.post`](http://developer.android.com/reference/android/os/Handler.html#post%28java.lang.Runnable%29)`Activity.runOnUiThread``View.post`*

 **（为准确性而编辑，添加“来自另一个线程”）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-10T14:48:53.030

另一个区别：`post`是每个视图；`runOnUiThread`是每个活动。

This means it will be possible (in the future?) to do `view.getQueue` / `activity.getQueue` and get exactly what you want without your own tracking or filtering code.*

# java - 逆向工程中支配者的重要性

> ID：10558210
> 
> 赞同：1
> 
> 时间：2012-05-11T20:29:31.263
> 
> 标签：java, compiler-construction, graph, compiler-theory

遇到了这个问题：解释支配者在逆向工程 Java 代码中的作用。

我能想到的只是你需要能够计算控制图中的支配者，看看它是否可约：

1.  锻炼支配者
2.  识别并移除后边缘
3.  检查剩余的图是否是非循环的

如果图形是无环的 - 它是可还原的。因此所有的循环都是自然循环。如果它不可简化，则代码是非结构化的或优化的。

这听起来对你吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:05:18.673

支配者对程序分析感兴趣的原因有很多，无论您是否将逆向工程作为一种特殊情况。

关键概念是，如果 X 支配 Y，当 Y 被执行时，X 已经被执行。因此，如果您想了解 Y 在做什么，并且 Y 取决于执行它的上下文，那么您可能需要了解 X。

您还需要了解其他一些事情，例如进入 Y 的数据流、程序输入等。这只是一个有用的起点。

有许多使用支配者的分析算法，每种都回答特定类型的问题。很难说这些都是统治者扮演的“（关键）角色”。

# windows-phone-7.1 - 在没有 zune 的情况下调试 WP7 应用程序

> ID：10558212
> 
> 赞同：3
> 
> 时间：2012-05-11T20:29:53.170
> 
> 标签：windows-phone-7.1

在我的 WP7 应用程序调试期间，我想访问照片库，如果您连接到 zune，则无法访问，但需要 zune 附加调试器。

我知道有一个批处理脚本允许在没有 zune 的情况下将调试器连接到您的 WP7 应用程序，但我不记得该脚本的名称，我也无法在网上找到它。如果您知道，请分享一个链接。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T22:07:51.617

与 Zune 连接后，您可以关闭 Zune，然后运行`WPConnect.exe`

在以下位置找到它：
“C:\Program Files (x86)\Microsoft SDKs\Windows Phone\v7.1\Tools\WPConnect\x64\WPConnect.exe”

这将允许 VS 连接到设备并调试您的应用程序，但不会锁定部分操作系统（例如照片和 Zune 库）。

# php - preg_match_all 返回所有匹配的行，并排除匹配的模式

> ID：10558215
> 
> 赞同：0
> 
> 时间：2012-05-11T20:30:18.300
> 
> 标签：php, regex, preg-match-all

我正在处理大量数据，并试图返回其中包含字符串“INFO：”的所有行。我已经设法让模式返回我感兴趣的数据，但想知道如何改进这个正则表达式模式以省略我正在匹配的字符串（以及如果可能的空格），所以只返回我感兴趣的实际数据。

```
$pattern = "/^.*INFO:.*\$/m";
preg_match_all($pattern, $content, $matches);

INFO:   framerate             25.00
INFO:   width                 480.00
INFO:   height                360.00
INFO:   audioinputvolume      75.00
INFO:   audiocodecid          mp4a
INFO:   audiodatarate         48.00 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:35:37.363

```
preg_match_all('/^INFO:\s+([^\s]+)\s+([^\s]+)$/ms', $content, $matches); 
```

回报：

```
Array
(
    [0] => Array
        (
            [0] => INFO:   framerate             25.00
            [1] => INFO:   width                 480.00
            [2] => INFO:   height                360.00
            [3] => INFO:   audioinputvolume      75.00
            [4] => INFO:   audiocodecid          mp4a
            [5] => INFO:   audiodatarate         48.00
        )

    [1] => Array
        (
            [0] => framerate
            [1] => width
            [2] => height
            [3] => audioinputvolume
            [4] => audiocodecid
            [5] => audiodatarate
        )

    [2] => Array
        (
            [0] => 25.00
            [1] => 480.00
            [2] => 360.00
            [3] => 75.00
            [4] => mp4a
            [5] => 48.00
        )

) 
```

请注意，这两个字段都不允许有空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:34:26.100

```
$pattern = "/INFO:\s+(.*?)\s+(.*?)(\s|$)/m"; 
```

这应该够了吧。括号中匹配的内容将作为元素出现在 $matches[1] 和 $matches[2]

以下是这将输出的内容：

```
Array
(
[0] => Array
    (
        [0] => INFO:   framerate             25.00

        [1] => INFO:   width                 480.00

        [2] => INFO:   height                360.00

        [3] => INFO:   audioinputvolume      75.00

        [4] => INFO:   audiocodecid          mp4a

        [5] => INFO:   audiodatarate         48.00
    )

[1] => Array
    (
        [0] => framerate
        [1] => width
        [2] => height
        [3] => audioinputvolume
        [4] => audiocodecid
        [5] => audiodatarate
    )

[2] => Array
    (
        [0] => 25.00
        [1] => 480.00
        [2] => 360.00
        [3] => 75.00
        [4] => mp4a
        [5] => 48.00
    )

[3] => Array
    (
        [0] => 

        [1] => 

        [2] => 

        [3] => 

        [4] => 

        [5] => 
    )

) 
```

所有空格/行尾字符都有第三个数组，因为我使用括号来使用 | 操作员说空格或文本的结尾可以匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:34:41.403

将您有兴趣匹配的组放入[子模式中](http://www.php.net/manual/en/regexp.reference.subpatterns.php) `( )`

我认为在您的情况下，它看起来像：

```
$pattern = "/^.*INFO:(.*)\$/m"; 
```

现在您可以使用以下命令查看括号中的内容`$matches[1][$match]`

# javascript - FullCalendar jquery 没有加载我日历中的事件

> ID：10558221
> 
> 赞同：2
> 
> 时间：2012-05-11T20:30:47.083
> 
> 标签：javascript, jquery, asp.net-mvc-3, fullcalendar

我正在使用这个 jQuery 完整日历：

[http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)

根据他们的文档，我可以加载 JSON 事件数据并相应地显示。

[http://arshaw.com/fullcalendar/docs/event_data/Event_Source_Object/](http://arshaw.com/fullcalendar/docs/event_data/Event_Source_Object/)

这是我的 ActionMethod 返回的内容（通过 Firebug 获得）：

```
[{"url":"/Eventos/Ver/1","start":1352073600,"end":1352074800,"title":"Evento #1"}] 
```

我对为什么日历不会加载我的代码返回的任何事件感到有些困惑。可能是因为我的 JSON 没有按照图书馆期望的方式形成吗？有什么建议么？

我的服务器返回 200 OK 服务器响应，所以这不是问题。

这是我用来加载事件的 jQuery 代码：

```
<script language="javascript" type="text/javascript">
    $(document).ready(function () {
        $('#calendar').fullCalendar({
            // put your options and callbacks here
            events: '@Url.Action("GetEvents","Eventos")',
            header: {
                left: 'title',
                center: '',
                right: 'prev,next'
            },
            monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 
                         'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            dayNames: ['Domingo', 'Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes', 'Sabado'],
            dayNamesShort: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab']
        });
    })
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:41:19.390

您的代码工作正常，并且您的 JSON 格式正确。

你确定你看的是正确的月份吗？您的日期转换为 2012 年 11 月 4 日。

查看这个[JSFiddle](http://jsfiddle.net/8j5gy/)并导航到 11 月，您可以看到您的事件已显示。

不同之处在于示例中的 JSON 提要直接在 events 选项中指定，但如果您已经在 Firebug 中检查过它，那么应该没有问题。

# objective-c - 如何自动推送

> ID：10558231
> 
> 赞同：0
> 
> 时间：2012-05-11T20:31:30.340
> 
> 标签：objective-c, ios, cocoa-touch

如果 xml 文件包含超过 1 个文件，我现在正在检查我的应用程序，否则我想将视图控制器自动推送到另一个视图控制器。

我现在正在这样做，但它有效！

```
UIViewController *rootController = [[ViewControllerOne alloc] initWithNibName:@"ViewControllerOne" bundle:nil];

navigationController = [[UINavigationController alloc] initWithRootViewController:rootController];

self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
[self.window addSubview:navigationController.view];
[self.window makeKeyAndVisible]; 
```

我需要将数据从第一个视图控制器发送到我通常推送到（ViewControllerOne）的那个我正在做的事情：

```
ViewControllerthree *Controller = [[ViewControllerthree alloc] initWithNibName:@"ViewControllerthree" bundle:[NSBundle mainBundle]];

Controller.Title = [item objectForKey:@"Title"];
[self.navigationController pushViewController:Controller animated:YES];
Controller = nil; 
```

我想组合这段代码，这样我就可以“重定向”控制器，如果它在 ViewController 中包含两个东西，它需要在视图控制器中不显示后退按钮的情况下推送它，我将数据推送到

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:37:54.103

大声笑这就是答案！你刚刚发布了答案试试这个；

```
ViewControllerthree *Controller = [[ViewControllerthree alloc] initWithNibName:@"ViewControllerthree" bundle:[NSBundle mainBundle]];

    Controller.Title = [item objectForKey:@"Title"];
UIViewController *rootController = 
    [[ViewControllerOne alloc] 
     initWithNibName:@"ViewControllerOne" bundle:nil];

    navigationController = [[UINavigationController alloc]
                            initWithRootViewController:rootController];

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [self.window addSubview:navigationController.view];
    [self.window makeKeyAndVisible];
 [self.navigationController pushViewController:Controller animated:YES];
    Controller = nil; 
```

瞧！

祝你好运，内森

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:52:27.667

如果没有“返回”按钮，你将如何关闭 UIViewController？

要隐藏“返回”按钮，请使用以下命令：

```
self.navigationItem.hidesBackButton = YES; 
```

# php - 访问 PHP 中的另一个类受保护变量

> ID：10558239
> 
> 赞同：1
> 
> 时间：2012-05-11T20:32:11.387
> 
> 标签：php, oop, class

我正在用 php 编写一个足球经理模拟器，[HARD AlGORITHMS！]

我有 3 节课：

**播放器**

```
class Player {

protected $name;

public function addAttr($name) {
    $this->name = $name;
}
} 
```

**团队**

```
class Team {

protected $name;

protected $players = array();

public function setName($name) {
    $this->name = $name;
}

public function getName() {
    return $this->name;
}

public function addPlayer($player) {
    $this->players[] = $player;
}

public function getPlayers() {
    print_r($this->players);
}

public function getOpponetsPosition() {
    GAME::getOpponetPlayersPosition();
} 
```

和**游戏**

```
class Game {

protected $t1;
protected $t2;

function setTeams($team1,$team2) {
    $this->t1 = $team1;
    $this->t2 = $team2;
}

function getOpponetPlayersPosition() {
        $this->t1->getPlayers();
} 
```

}

和主脚本

```
require_once 'classes/CPlayer.php';
require_once 'classes/CTeam.php';
require_once 'classes/CGame.php';

$game = new Game;

$team1 = new Team;
$team1->setName("PO-1");
$team2 = new Team;
$team2->setName("PO-2");

$p1 = new Player;
$p2 = new Player;

$p1->addAttr("payam babaiy");
$p2->addAttr("parsa babaiy");

$team1->addPlayer($p1);
$team2->addplayer($p2);

$game->setTeams($team1,$team2);

$team1->getOpponetsPosition(); 
```

我需要在**Team**类中使用**getOpponetsPosition()**函数获取游戏中的所有玩家位置

 **但它不返回我在主脚本中输入的值。我这样做对吗？这是应用即时通讯写作的好方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:41:08.683

你的方法很好，有几点：

### 使用构造函数，它们可以让你的生活更轻松：

```
class Player {

    protected $name;

    **public function __construct($name) {
        $this->name = $name;
    }**

    public function addAttr($name) {
        $this->name = $name;
    }
}
```

进而

```
new Player("Lionel Messi"); 
```

**构造函数还确保您不会得到空名的球员/球队！您可以更好地控制课程中的内容！**

### 不要混合使用静态代码和普通代码

您的 getOpponentsPosition 函数不正确

```
public function getOpponetsPosition() {
    GAME::getOpponetPlayersPosition();
} 
```

事实上，它甚至不应该在这里，`Team`获取其他球队的位置不是 ' 的工作，而是游戏的工作，因为它包含两者。

**[请参阅此要点，了解我将如何实现您的目标。](https://gist.github.com/2662357)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:36:31.493

不，您正在调用一个静态函数，`GAME::getOpponetPlayersPosition();`因此`$this`该函数内部没有定义。**

# php - PHP 允许的 zip mimetypes

> ID：10558251
> 
> 赞同：3
> 
> 时间：2012-05-11T20:33:53.070
> 
> 标签：php, mime-types

我知道（从这个问题的答案：[.rar, .zip files MIME Type](https://stackoverflow.com/questions/6977544/rar-zip-files-mime-type)）大多数人在 PHP 中检查 zip 文件为`application/zip`or `application/octet-stream`，但我对此有几个问题：

*   检查是否安全`application/octet-stream`（因为它`application/octet-stream`可以用来描述更多的文件类型，而不仅仅是 zip！）。我知道我也可以用其他方式检查文件，但我认为我应该尽量让一切都尽可能简单
*   我尝试尽可能多地检查不同的实际拉链类型；但是，有些会产生一些意想不到的结果。我发现 1 的 mime-type 是`application/x-external-editor`，但是 PHP 在处理它时遇到了问题（尽管我得到的唯一错误是`Warning: ZipArchive::close() [ziparchive.close]: Invalid or unitialized Zip object`） - 这在任何地方都有记录吗？是否有`x-`PHP 可以处理的实际 mimetype 列表？

**编辑**

回答以下问题：

*   我通过 using 检查 mime 类型`$_FILES['fileatt']['type']`，但 using`mime_content_type()`给出了相同的结果。不同的 zip 文件似乎是以下任何一种：`'application/zip'`, `'application/x-compressed'`, `'application/x-zip-compressed'`, `'application/x-compressed'`, `'multipart/x-zip'`. 我不明白为什么当 mime 类型被检测为`application/x-external-editor`.
*   我已经安装了 zip 扩展程序，并且在上传 zip 文件时，我正在从 zip 文件中提取所有文件。我没想过检查错误。

我还发现了另一件事我不太明白：当我将以下代码与 PHP 读取为的文件一起使用时`application/x-external-editor`：

```
if($zip->open($_FILES[fileatt]['tmp_name'])===TRUE)
{
    echo "success";
} else {
    echo "error";
} 
```

打印“错误”，但检查文件类型为

```
$res = $zip->open($_FILES[fileatt]['tmp_name']);
if($res)
{
    echo "success";
} else {
    echo "error";
} 
```

打印“成功”；在这段代码中，我假设布尔值有效地使用`==`, not `===`，但是为什么这会有所作为呢？

错误：

```
$res = $zip->open($_FILES[fileatt]['tmp_name']);
if($res===TRUE)
{
    echo "success";
} else {
    echo $res;
} 
```

打印- 19 指的是`19`哪个错误（[http://uk3.php.net/manual/en/ziparchive.open.php ）？！](http://uk3.php.net/manual/en/ziparchive.open.php)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:43:01.103

永远不要相信 mime 类型，这很容易被客户端欺骗。如果他们愿意，他们可以提交一个 exe 并给它一个 mime 类型`text/plain`。

所有 zip 文件都以标准的本地文件头签名 (0x04034b50) 开头，因此您可以检查文件的前 4 个字节是否与 zip 签名字节匹配。有关详细信息，请参阅[PKZIP Appnote](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)。

如果您启用了[zip 扩展](http://php.net/zip)，您可以更进一步，尝试打开并读取 zip 以确保它是完全有效的 zip 文件。

像这样的东西效果很好：

```
$zip = zip_open('/path/to/file.zip');
if (is_int($zip)) {
    echo "Error $zip encountered reading the file, is it a valid zip?";
} else {
    echo "Thanks for uploading a valid zip file!";
} 
```

`zip_open`如果成功打开，则返回一个资源，否则返回一个整数，表示读取文件时发生的错误。

**编辑：**详细说明您的一些问题：

About `application/octet-stream`：正如你所说，这是一个非常通用的类型。这只是意味着任何包含 8 位数据的文件，基本上是所有内容。 `application/zip`是事实上的标准 mime 类型，但某些客户端会使用您发现的其他值。还考虑到客户端可以轻松欺骗任何文件类型以使用`application/zip`我不会依赖的事实，`$_FILES['fileatt']['type']`因为它可以是任何东西。

AFIK，`mime_content_type()`只需查看文件扩展名并将其映射到系统上的[mime.types](http://servers.digitaldaze.com/extensions/mimetypes/mime.types.txt)文件或内置于 PHP 中的 mime 类型。如果有人`.zip`在文件上添加扩展名，`exe`它仍然会注册为`application/zip`. 我相信某些扩展可能会检查文件头。

`Zip::open()``TRUE`如果文件打开成功，则返回一个整数错误代码。因此，`==`会给你一个错误的误报，因为任何非零整数都将评估为真，`==`因为它会将非零整数转换为`TRUE`. 如果您要检查`Zip::open`您的回报，应始终使用`$res === true`以检查是否成功。您可以在页面底部的评论中找到错误代码[的](http://www.php.net/manual/en/zip.constants.php)含义。

底线：由于您说您已经在提取 zip，因此根据 mime 类型进行验证可能不会那么麻烦，但是尝试打开文件并根据`open`. 如果它返回 true，您可以确定该文件是一个有效的 zip（当然，文件后面可能会出现错误，但他们至少上传了类似于 zip 文件的内容）。

希望对您有所帮助。

# javascript - 将 HTML 片段加载到动态创建的 iframe 中

> ID：10558253
> 
> 赞同：0
> 
> 时间：2012-05-11T20:33:53.990
> 
> 标签：javascript, html, iframe

我正在尝试将 HTML 片段加载到以下新创建的 iframe 中。

```
<!DOCTYPE html>
<html>
<head><title>Test</title></head>
<body>
<script type="text/javascript">
    var iframeId = "frame"
            + Math.floor((Math.random() + "") * 1000000000000).toString();

    document.write('<iframe height="300"'
        + ' width="300"'
        + ' frameborder="0"'
        + ' scrolling="no"'
        + ' id="' + iframeId + '"'
        + ' name="' + iframeId + '"'
        + ' allowtransparency="true"></iframe>');

    var iframe = document.getElementById(iframeId);
    var iframeContent = '<!-- --\><script language=\"javascript\"\></script\>';
    iframe.contentWindow.document.open();

    iframe.contentWindow.document.write(
        '<!DOCTYPE html\><html\><head\><title\>Test</title\></head\><body\>'
        + iframeContent
        + '</body\></html\>');

    iframe.contentWindow.document.close();
</script>
</body>
</html> 
```

当我在浏览器中打开此文档时，iframe 未正确加载。关于可能导致这种情况的任何想法？

如果我将 iFrameContent 设置为

```
var iframeContent = '<!-- --\>'; 
```

或者

```
var iframeContent = '<script language=\"javascript\"\></script\>'; 
```

该页面似乎正确加载。

iframeContent 本质上是第三方 HTML 片段（使用 freemarker js_string 转义）并且可能包含 HTML 注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:45:26.057

The problem is that the only way that the browser knows that your script section is done is to look for the "" tag, and you've got one of those right in the middle of your script. It thinks that that is the end of your javascript, and so of course that's a syntax error. It may also notice the "" tag, and think you have nested scripts. You can try something like this:

```
var iframeContent = '<!-- --\><' + 
    'script language=\"javascript\"\></' + 'script\>'; 
```

And see if that works.

Even better is to use something like document.createElement or the jQuery library to create your DOM elements.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:00:16.983

看来，您的代码在 IE 中运行，但在其他浏览器中不运行。为了让它工作，你需要以某种方式转义开始评论的令牌，例如：

```
var iframeContent = '<!\-- --\><script language=\"javascript\"\></script\>'; 
```

结束`</script\>`-tag 在这里不是问题，因为它不是`</script>`代码中的文字。

# ruby-on-rails - 使用和理解 RubyGem 及其 api

> ID：10558255
> 
> 赞同：0
> 
> 时间：2012-05-11T20:33:58.347
> 
> 标签：ruby-on-rails, rubygems

我正在尝试使用这个 RubyGem：[https ://github.com/pengwynn/linkedin](https://github.com/pengwynn/linkedin)

我还将它分叉到我的 github 存储库：[https ://github.com/genadinik/linkedin/](https://github.com/genadinik/linkedin/)

它是 LinkedIn API 的包装器。我可以查询它，但它的方法太少了。

这是他们的api：

```
https://github.com/genadinik/linkedin/blob/134fade9c4940cffad53cfe238ed21a9ad1145ee/lib/linked_in/api/query_methods.rb 
```

我试图了解如何向该 gem API 添加方法，以便添加更多方法。

但我不一定要将我的新方法添加回原始来源。

知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:55:59.773

您想将修改添加到现有的 gem 中吗？

一种方法是将覆盖源添加到您的初始化程序，例如

```
initializers/linkedin_gem_overrides.rb 
```

这样，您就可以为所欲为。但是，您没有组织测试和赶上未来升级的能力。

另一种方法是，您也可以将您的分叉 git 存储库用于您的 gem 源。

假设您使用捆绑器，请将linkedin gem 行修改为您的

```
gem 'linkedin', :git => 'git://github.com/genadinik/linkedin.git' 
```

通过这样做，您可以在途中组织 gem 进行测试，但您可能会失去原始 gem 的升级。

我建议如果您对自己的修改感到满意（通过完整的测试！！！），请发送作者拉取请求。一旦作者接受您的更改，您可以简单地删除该行以使用 ruby​​gems.org。

```
gem 'linkedin' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:37:32.027

好吧，您可以使用 Bundler 直接使用来自 Github 的分叉版本：[这是](http://gembundler.com/git.html)如何操作的。你可以在它上面做更多的开发，因为它在 Github 上，如果你确定你*确实*有他们可能想要的东西，你可以向源发出拉取请求。如果你不熟悉 Bundler，你应该阅读它：它本质上是一种指定和安装每个项目 gem 依赖项的方法。

# mysql - := 和 = 与 mysql 变量有区别吗？

> ID：10558256
> 
> 赞同：1
> 
> 时间：2012-05-11T20:33:59.283
> 
> 标签：mysql

@var := 0; 之间有区别吗？和@var = 0; ?

有和没有结肠？那有什么作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:37:31.027

在[SET](http://dev.mysql.com/doc/refman/5.5/en/set-statement.html)的情况下，它们是同义词：

```
SET @var := 1234;
SET @var = 1234; 
```

但`=`在 a 中使用时充当条件运算符`SELECT`：

```
SELECT @var := 1234; -- 1234
SELECT @var = 1234;  -- 1 
```

因此，通常最好坚持`:=`for assignment 以避免混淆。

# c++ - 如何检查线程是否持有互斥锁 c++

> ID：10558257
> 
> 赞同：1
> 
> 时间：2012-05-11T20:34:00.997
> 
> 标签：c++, multithreading, unix

在我的应用程序（C++/Linux）中，有时一个线程在被取消时会获取一个互斥锁（递归）。这会导致死锁，因为其他线程也使用相同的互斥锁并且无法获得它。

现在可以检查该线程是否锁定了任何互斥体。我的动机是手动清除线程锁定然后取消线程。

我能想到的一种可能的方法是维护一个 counter 。任何更好的方法也将受到欢迎..

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:40:57.667

许多库提供类似于 Windows 的[TryEnterCriticalSection](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686857%28v=vs.85%29.aspx)的机制。如果这返回一个表明互斥锁已被占用的信号，那么您就有了答案。

但是你有一个比这更大的问题。在正确设计的多代码应用程序中，您永远不会遇到死锁或竞争条件，并且您当然不必手动插入另一个线程来操纵它的状态。

您应该修复错误，而不是编写一些 hack。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T00:19:14.217

一般来说，你应该避免使用`pthread_cancel()`，因为这样的问题。如果你必须使用它，你应该使用[pthread_cleanup_push 和 pthread_cleanup_pop](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cleanup_push.html)来保证如果线程被取消，互斥锁被解锁。

如果有人调用`pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS)`，根本无法保证正确执行，所以不要那样做。

`pthread_cancel()`非常C-ish。考虑使用[Boost 的线程中断](http://www.boost.org/doc/libs/1_49_0/doc/html/thread/thread_management.html#thread.thread_management.interruption)，因为您使用 C++ 编程。这将与作用域锁定对象很好地组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T17:08:57.580

正如约翰所说，主要问题是应用程序设计。

提示：在 C++ 中，在失败（抛出）的情况​​下唯一保证执行的是什么？析构函数。

您有 2 个选择：

1.  您可以使用 C++11 或 boost lock_guard，它封装了一个普通的互斥锁，但提供了异常安全性，旨在避免像您这样的问题。但这意味着您需要将整个应用程序更改为使用 C++11 或 boost 线程，而不是 pthread。

2.  您可以在析构函数中释放互斥锁。

祝你好运！

# vhdl - 需要额外 LE 的 VHDL 函数？

> ID：10558259
> 
> 赞同：0
> 
> 时间：2012-05-11T20:34:07.213
> 
> 标签：vhdl, synthesis

我正在创建一个具有多个定义的包，类似于以下内容

```
 -- Control Register Address Type Declaration
    SUBTYPE ctrl_reg_addr_type IS std_logic_vector( ADDR_BITS-1 DOWNTO 0 );
    -- Control Register Data Type Declaration
    SUBTYPE ctrl_reg_data_type IS std_logic_vector( DATA_BITS-1 DOWNTO 0 );
    -- Control Register Type Declaration
    SUBTYPE ctrl_reg_word_type IS std_logic_vector( CTRL_BITS-1 DOWNTO 0 );

    -- Left/Right Line-In Control Type Declarations
    CONSTANT LINE_IN_VOL_BITS : integer := 5;

    SUBTYPE line_in_volume_type IS natural
    RANGE 0 TO ( 2**LINE_IN_VOL_BITS )-1;

    TYPE line_in_ctrl_type IS RECORD

        -- Left/Right Channel Line Input Volume (4:0)
        -- Registers: LINVOL/RINVOL
        -- 0x1F = +12.0dB
        -- ...  =   1.5dB steps
        -- 0x00 = -34.5dB
        -- 0x17 - 0dB (Default)
        volume : std_logic_vector( LINE_IN_VOL_BITS-1 DOWNTO 0 );
        -- Left/Right Channel Line Input Mute to ADC (7)
        -- Registers: LINMUTE/RINMUTE
        -- 0x1 = Enable Mute
        -- 0x0 = Disable Mute
        mute   : std_logic;
        -- Left/Right Channel Line Input Volume and Mute Load (8)
        -- Registers: LRINBOTH/RLINBOTH
        -- 0x1 = Enable Simultaneous Load of LINVOL/LINMUTE <-> RINVOL/RINMUTE
        -- 0x0 = Disable Simultaneous Load
        both   : std_logic;

    END RECORD line_in_ctrl_type; 
```

我想使用类似于以下的函数来修改记录类型中的字段。

```
 -- Left/Right Line-In Increase Volume Function Body
    FUNCTION increase_volume( ctrl : line_in_ctrl_type )
    RETURN line_in_ctrl_type IS

        VARIABLE volume : line_in_volume_type := 0;
        VARIABLE tmp    : line_in_ctrl_type;

    BEGIN

        tmp    := ctrl;
        volume := natural( to_integer( unsigned( ctrl.volume ) ) );

        IF ( volume < line_in_volume_type'HIGH ) THEN

            volume     := volume + 1;

            tmp.volume := std_logic_vector(
                              to_unsigned( volume, LINE_IN_VOL_BITS ) );

        END IF;

        RETURN ( tmp );

    END FUNCTION increase_volume;

    -- Left/Right Line-In Increase Volume Function Body
    FUNCTION increase_volume( ctrl : line_in_ctrl_type;
                              step : natural )
    RETURN line_in_ctrl_type IS

        VARIABLE volume : line_in_volume_type := 0;
        VARIABLE tmp    : line_in_ctrl_type;

    BEGIN

        tmp    := ctrl;
        volume := natural( to_integer( unsigned( ctrl.volume ) ) );

        IF ( volume < ( line_in_volume_type'HIGH - step ) ) THEN

            volume     := volume + step;

            tmp.volume := std_logic_vector(
                              to_unsigned( volume, LINE_IN_VOL_BITS ) );

        ELSE

            tmp := increase_volume( tmp );

        END IF;

        RETURN ( tmp );

    END FUNCTION increase_volume; 
```

我的问题是，将使用类似于所示示例的函数，使用比显式修改记录值更多的 LE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T22:36:16.720

在 VHDL 中使用函数非常抽象（VHDL 应该如此）。它可以离 RTL 尽可能远。这意味着很难确定 LE 中会干扰什么。它主要取决于综合工具以及它们如何挑选逻辑结构。

函数的合成更像是一个宏。每次调用它时，您可能最终都会实例化同一逻辑块的另一个实例。你多久打电话一次？

为了有效地使用 LE，您需要编写可重用功能块的代码。例如，编写一个通用结构读/写引擎并使用它一次，但将输入和输出从/到不同的地方。

如果您担心 LE 的使用，并且仍然想使用功能，我建议您考虑是否有足够大的 FPGA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:31:30.567

使用这样的函数只是以一种方便的形式包装了大量的逻辑。

如果您以这种方式获得明显不同的逻辑使用，与复制/粘贴所有内容相比，请向您的综合供应商记录错误。

# c# - C# 线程中止异常

> ID：10558260
> 
> 赞同：4
> 
> 时间：2012-05-11T20:34:11.073
> 
> 标签：c#, multithreading

**在 thread.Abort() 之后会发生什么？**

说我有：

```
Thread mWorker = new Thread(new ThreadStart(this.run));
..
mWorker.Start();

**where**

private void run() 
{
      Logger.d(TAG, "run()");

      ...
      try {
        while (this.mRunning){
          ...
        }
      } catch (ThreadAbortException tae){
           Logger.e(TAG,"some msg", tae);
           this.doSomething();
      } catch (IOException ioe){
           Logger.e(TAG,"some msg", ioe);
           this.doSomething();
      } catch (Exception e){
           Logger.e(TAG,"some msg", e);
           this.doSomething();
      } finally {
            gracefoulyClose();
      }

      Logger.d(TAG, "run() - ended");
} 
```

线程更复杂..但这里显示了本质。那么当 Abort() 被调用时会发生什么？我的 catch 会起作用并继续调用 doSomething() 吗？

因为我仍然在控制台中收到：

```
A first chance exception of type 'System.Threading.ThreadAbortException' occurred in mscorlib.dll
An exception of type 'System.Threading.ThreadAbortException' occurred in mscorlib.dll but was not handled in user code 
```

但我确实对此有把握。我不是吗？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:37:15.783

从[文档](http://msdn.microsoft.com/en-us/library/system.threading.threadabortexception.aspx)：

> 当调用 Abort 方法来销毁线程时，公共语言运行时会引发 ThreadAbortException。 **ThreadAbortException 是一个可以被捕获的特殊异常，但它会在 catch 块结束时自动再次引发**。引发此异常时，**运行时会在结束线程之前执行所有 finally 块**。因为线程可以在 finally 块中进行无限计算或调用 Thread.ResetAbort 来取消中止，所以不能保证线程将永远结束。如果要等到中止的线程结束，可以调用 Thread.Join 方法。Join 是一个阻塞调用，直到线程真正停止执行才返回。

所以换句话说，在你的 catch 块`ThreadAbortException`执行之后，异常被重新引发，所以你的最后一个记录器行（例如`Logger.d(TAG, "run() - ended")`）永远不会执行。但是由于调用`this.doSoemthing`是在 的 catch 块中`ThreadAbortException`，所以**它将**执行。

另请注意，您的`finally`块**确实**执行（请参阅上面的文档）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-20T11:33:38.157

如果您在代码中使用某些地方， `response.redirect();`那么它将在内部运行`thread.abort();` ，因此会引发异常。您可以使用 `Response.Redirect(url,false);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:22:20.343

您收到 ThreadAbortException 是因为您的上下文在线程完成运行之前退出。在退出之前，您需要等待线程完成。如果您想退出，您需要确保您的线程可以接收到您的程序希望结束的信号（并对其采取行动），然后您的管理程序执行的代码必须等待线程完成：

```
if (mThread != null && mThread.IsAlive) {
    mThread.Join();
} 
```

如果您担心线程永远不会退出，请使用带超时的重载，如果您点击计时器，则明确终止线程。

# c - 是否可以将 Eigen 与 c 一起使用？

> ID：10558262
> 
> 赞同：6
> 
> 时间：2012-05-11T20:34:13.493
> 
> 标签：c, eigen

我对模板编程不是很了解，目前使用的是gsl。我有兴趣看看 Eigen 是否可以在 C 中使用。以前有人在 C 中使用过 Eigen 吗？有什么我可以测试的，看看它是否容易？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T20:37:14.523

由于 Eigen 是 C++ 模板库，因此不能直接与 C 一起使用。

假设，可以将 C++ 模板包装到 C API 中并使用它。但是，这必然会涉及大量工作，并且会让我觉得有点毫无意义（不妨将现有的 C 库用于线性代数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:37:37.467

AFAIK，Eigen 是一个纯模板库。C 不支持模板。因此，无需编写一堆暴露 C 风格接口的包装函数，不。

# javascript - chrome.devtools 扩展面板图标看起来不正确

> ID：10558265
> 
> 赞同：1
> 
> 时间：2012-05-11T20:34:16.363
> 
> 标签：javascript, google-chrome, google-chrome-extension, google-chrome-devtools

在 chrome.devtools api 中从 png 设置开发工具面板图标会在我单击它时呈现偏移并移动。单击时其他股票图标变暗-我认为这是一个动画，我不确定它为什么或如何尝试为我的 png 设置动画。

我如何生成一个看起来像 devtools 面板图标的图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:29:34.297

使用另一个 DevTools 实例检查按钮图像（所有图像都存储在 中`chrome-devtools://devtools/Images/toolbarIcons.png`）。在`toolbarIcons.png`中，正常和抑郁（变暗）图像版本按列排列，因此您应该对面板图标图像执行相同操作。

# .net - 这似乎是 .NET 的 JavaScript 反序列化中的一个错误……是吗？

> ID：10558268
> 
> 赞同：4
> 
> 时间：2012-05-11T20:34:32.440
> 
> 标签：.net, json, serialization, javascriptserializer

基本上，我发现作为 JavaScript 对象（关联数组）的 JSON 字符串，其属性/键之一为空字符串，将导致内置的 .NET 序列化程序引发异常。

例如这段代码：

```
string json = "{ \"\" : [\"b\"] }";

JavaScriptSerializer js = new JavaScriptSerializer();

var map = js.Deserialize<Dictionary<string, List<string>>>(json); 
```

将抛出 ArgumentException，表明可能正确的 JSON 不允许属性名称为空字符串。只需浏览[Crockford](http://json.org/)网站上的[Backaus Naur 表单图](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form)/[语法图](http://en.wikipedia.org/wiki/Syntax_diagram)，就可以看出允许使用空字符串。

```
object => '{'  string ':' value '}'
string => ""
       => " chars " 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:40:56.187

是的。这对我来说肯定是个错误。这绝对是有效的：

```
var x = {"" : ["b"]}
alert(x[""]); 
```

我不是说你*应该*这样做，但你*可以*在 JS 中做到这一点。

*编辑*话虽如此。你的代码对我有用。您使用的是哪个版本的 .NET？

*编辑*确认。它在 .NET 3.5 中中断，但在 4.0 中有效。

# ruby-on-rails - 设置哈希键的值以返回函数的值，rails 3 & mongomapper

> ID：10558273
> 
> 赞同：1
> 
> 时间：2012-05-11T20:35:09.680
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mongomapper

有人可以解释这里发生了什么吗？这是尝试在我的 rails 3.0.11、mongomapper 0.9.0 应用程序中设置哈希键的一些奇怪的简化示例。

```
class Foo
  key :a, Hash
  key :b, Hash
end

> foo = Foo.new( :a=>{:timezone=>"Adelaide"}, :b=>{:timezone=>"Azores"} )
> foo.a[:time] = Time.use_zone(foo.a[:timezone]){Time.zone.now}
  => Fri, 11 May 2012 20:20:36 AZOST +00:00 
> foo.a[:time]
  => nil 
```

当使用来自同一散列的时区时，它实际上并没有将散列键设置为返回值。但：

```
> foo.a[:time] = Time.use_zone(foo.b[:timezone]){Time.zone.now}
 => Sat, 12 May 2012 05:51:07 CST +09:30 
> foo.a[:time]
 => Sat, 12 May 2012 05:51:07 CST +09:30 
```

使用 b 哈希时区并存储该值。什么？我可以将 use_zone 块的返回值存储在局部变量中，然后设置散列键，或者为时区等使用静态字符串，但是当块使用散列本身的时区值时，我无法设置键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T17:43:18.373

试试这个：

```
foo = Foo.new( :a=>{:timezone=>"Adelaide"}, :b=>{:timezone=>"Azores"} )
Time.use_zone(foo.a[:timezone]){
  foo.a[:time] = Time.zone.now
} 
```

# android - 你能知道有多少用户连接到安卓设备上的 wifi 吗？

> ID：10558274
> 
> 赞同：0
> 
> 时间：2012-05-11T20:35:13.307
> 
> 标签：android, wifi, android-wifi

我想构建一个 android 应用程序，告诉有多少用户连接到无线网络？有没有办法做到这一点？可以使用tcpdump吗？请提出一些方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:49:10.407

This really depends on the goals of the App.

Many enterprise wireless access points have a web service and api running on the device that can be queried against. It should be as simple as setting up a http session on the android app and calling the API or web service through post/get calls. even if the AP does not have an api you should still be able to access the routers state through what ever mechanism is used to set it up.

# c - 使用 libsndfile 和 libsamplerate 的音频采样率转换器。不确定是否正确使用函数 src_simple

> ID：10558275
> 
> 赞同：2
> 
> 时间：2012-05-11T20:35:22.757
> 
> 标签：c, audio, libsndfile, sample-rate

我一直在使用 libsndfile 和 libsamplerate 在 c 中构建一个简单的采样率转换器。无论我尝试什么，我似乎都无法让 libsamplerate 的 src_simple 函数工作。我已经将我的代码剥离得尽可能简单，现在它只输出一个相同采样率的无声音频文件：

```
#include <stdio.h>
#include <sndfile.h>
#include <samplerate.h>

#define BUFFER_LEN 1024
#define MAX_CHANNELS 6

int main ()
{
    static double datain [BUFFER_LEN];
    static double dataout [BUFFER_LEN];
    SNDFILE *infile, *outfile;
    SF_INFO     sfinfo, sfinfo2 ;
    int         readcount ;
    const char  *infilename = "C:/Users/Oli/Desktop/MARTYTHM.wav" ;
    const char  *outfilename = "C:/Users/Oli/Desktop/Done.wav" ;
    SRC_DATA    src_data;

    infile = sf_open (infilename, SFM_READ, &sfinfo);
    outfile = sf_open (outfilename, SFM_WRITE, &sfinfo);

    src_data.data_in = datain
    src_data.input_frames = BUFFER_LEN;
    src_data.data_out = dataout;
    src_data.output_frames = BUFFER_LEN;
    src_data.src_ratio = 0.5;

    src_simple (&src_data, SRC_SINC_BEST_QUALITY, 1);

    while ((readcount = sf_read_double (infile, datain, BUFFER_LEN)))
    {
        src_simple (&src_data, SRC_SINC_BEST_QUALITY, 1);
        sf_write_double (outfile, dataout, readcount) ;
    };

    sf_close (infile);
    sf_close (outfile);

    sf_open ("C:/Users/Oli/Desktop/Done.wav", SFM_READ, &sfinfo2);

    printf("%d", sfinfo2.samplerate);

    return 0;
} 
```

这真的开始让我感到压力了。该计划是一个单人项目，很快就要到期了，这让我非常焦虑，因为无论我尝试什么似乎都会导致失败。谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:15:03.567

我不是这个特定库的专家，但仅通过查看[在线文档](http://www.mega-nerd.com/SRC/api_simple.html)，我发现您的代码存在一些问题：

*   `src_simple`显然适用于浮点数，但您的缓冲区是双倍的 - 我认为您需要将缓冲区更改为浮点数并将`sf_read_float`/`sf_write_float`用于 I/O。

*   `src_simple`是“简单”界面，旨在一次调用中应用于整个波形，而不是像您所做的那样以块的形式应用-请参阅[http://www.mega-nerd.com/SRC/faq.html#Q004-](http://www.mega-nerd.com/SRC/faq.html#Q004)您应该首先获取输入文件的大小，然后分配足够的内存，读入整个文件，一次转换，然后将转换后的输出数据写入输出文件。

*   更改采样率时，您将在输出文件中获得与输出文件中不同数量的样本（在这种情况下约为一半），但您正在写入与您读取的相同数量的样本（`readcount`）。您可能应该使用`src_data.output_frames_gen`作为要写入的帧数，而不是`readcount`.

# jquery - 为什么jquery需要一个ui对话框的选择器

> ID：10558282
> 
> 赞同：1
> 
> 时间：2012-05-11T20:36:06.583
> 
> 标签：jquery, asp.net-mvc, jquery-selectors, jquery-dialog

我知道 jquery 需要一个选择器来使用它，就像 class="x" 在所有带有 class="x" 的链接上。

但我不明白的是，为什么 jquery 需要像 #dialog 这样指向 div 的选择器，因为对话框对 div 没有任何作用。

在我看来，窗口/对话框应该与 div 无关，因为对话框位于所有其他 ui 元素之上。

样本：

```
<div id="dialog"> what is that div for?</div>
$('#dialog').dialog({... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:38:28.257

对话框元素充当容器。当您打开对话框时，它会显示该容器的内容。您始终可以动态生成内容并显示该内容，但使用容器允许您先定义内容（并说隐藏它），然后再显示/渲染它。

# iphone - 强制 iOS 警报留在系统下拉菜单中

> ID：10558284
> 
> 赞同：0
> 
> 时间：2012-05-11T20:36:30.030
> 
> 标签：iphone, push-notification, apple-push-notifications

在应用商店提交之前，我正在测试 iPhone 应用。

但是，推送通知警报仅作为警报横幅出现，然后在 1 秒后滚开，但永远不会停留在系统下拉菜单中。

为什么警报徽章会保留给其他应用程序？是因为他们已经被appstore批准了吗？

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:47:19.057

用户可以通过应用程序配置警报消息的配置。是否在设备的设置中为您的应用程序启用了通知中心？我怀疑横幅通知已启用，但通知中心未启用。

# iphone - iPhone播放声音时如何进行操作？

> ID：10558288
> 
> 赞同：5
> 
> 时间：2012-05-11T20:36:59.653
> 
> 标签：iphone, avaudioplayer

我使用 AVAudioPlayer 在我的 iPhone 应用程序中播放 MP3；我需要在特定时间（比如第 30 秒、1 分钟）执行一些操作；有没有办法根据 mp3 播放时间调用回调函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T09:49:39.237

我相信最好的解决方案是在开始播放`NSTimer`时开始`AVAudioPlayer`播放。您可以将计时器设置为每半秒左右触发一次。然后每次定时器触发时，查看`currentTime`音频播放器上的属性。

为了在特定的时间间隔做某事，我建议你为上次调用计时器回调的播放时间保留一个实例变量。然后，如果您已经通过了上次回调和 this 之间的临界点，请执行您的操作。

因此，在伪代码中，计时器回调：

1.  获取`currentTime`您的 AVAudioPlayer
2.  检查是否`currentTime`大于`criticalPoint`
3.  如果是，检查是否`lastCurrentTime`小于`criticalPoint`
4.  如果也同意，请采取行动。
5.  设置`lastCurrentTime`为`currentTime`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-21T09:53:36.327

如果您能够使用 AVPlayer 而不是 AVAudioPlayer，则可以设置边界或周期性时间观察器：

```
// File URL or URL of a media library item
AVPlayer *player = [[AVPlayer alloc] initWithURL:url];        

CMTime time = CMTimeMakeWithSeconds(30.0, 600);
NSArray *times = [NSArray arrayWithObject:[NSValue valueWithCMTime:time]];

id playerObserver = [player addBoundaryTimeObserverForTimes:times queue:NULL usingBlock:^{
    NSLog(@"Playback time is 30 seconds");            
}];

[player play];

// remove the observer when you're done with the player:
[player removeTimeObserver:playerObserver]; 
```

AVPlayer 文档：http: [//developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T09:49:41.150

是的，当然你可以......这很棘手，我希望它对你有用，但它对我有用..

```
1- you play your mp3 file. 
```

2-`[self performSelector:@selector(Operation:) withObject:Object afterDelay:30];` 然后是功能

```
-(void)Operation:(id)sender; 
```

称为；所以你在 mp3 文件 30 秒后触发了函数..你可以根据你想要的时间制作许多函数..

3-还有其他使用计时器的解决方案

```
[NSTimer scheduledTimerWithTimeInterval:0 target:self selector:@selector(CheckTime:) userInfo:nil repeats:YES]; 
```

它将触发名为 Check Time 的函数

```
-(void)CheckTime:(id)sender{
   if (avAudioPlayerObject.currentTime == 30.0)
   {
       //Do Something
       //Fire and function call such
       [self performSelector:@selector(Operation:) withObject:Object]
   }
} 
```

然后你可以改变你想要的时间间隔，重复是为了让你控制是否每 5 秒重复一次这个动作.. 希望有帮助..

谢谢

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T09:51:48.970

使用多线程，您的目标很简单，只需这样做：

```
1 :  in your main thread create a variable for storing time passed 
2 :  create new thread like "checkthread" that check each 30-20 sec(as you need)
3 :  if the time passed is what you want do the callback 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T09:47:18.480

我发现[这个链接](http://developer.apple.com/library/mac/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html#//apple_ref/occ/instp/AVAudioPlayer/currentTime)描述了一个似乎表明您可以获得当前播放时间的属性。

> 如果声音正在播放，currentTime 是当前播放位置的偏移量，以声音开始的秒数为单位。如果声音没有播放，currentTime 是调用 play 方法时开始播放的偏移量，以从声音开始开始的秒数为单位。
> 
> 通过设置此属性，您可以寻找到声音文件中的特定点或实现音频快进和快退功能。

要检查时间并执行您的操作，您只需查询它：

```
if (avAudioPlayerObject.currentTime == 30.0) //You may need a more broad check. Double may not be able to exactly represent 30.0s
{
    //Do Something
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-14T10:02:20.683

我认为，您想在 30 秒后播放不同的声音文件，然后使用以下代码：

1) 所有声音文件都放在数组中，然后从文档目录中检索

2）然后试试这个：

```
-(IBAction)play_sound
{

    BackgroundPlayer=[[AVAudioPlayer alloc]initWithContentsOfURL:[NSURL fileURLWithPath:[[NSBundle mainBundle]pathForResource:[Arr_tone_selected objectAtIndex:j]ofType:@"mp3"]]error:NULL];
    BackgroundPlayer.delegate=self;

    [BackgroundPlayer play];

}   

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    [BackgroundPlayer stop];
    j++;
    [self performSelector:@selector(play_sound) withObject:Object afterDelay:30];   
} 
```

# java - Matlab 不使用 java.library.path 加载本机库？

> ID：10558291
> 
> 赞同：1
> 
> 时间：2012-05-11T20:37:10.957
> 
> 标签：java, macos, matlab

有没有其他人遇到过 MATLAB 似乎没有搜索`java.library.path`本机依赖项的问题？

例如：

这是我的 librarypath.txt：

```
##
## FILE: librarypath.txt
##
## Entries:
##    o path_to_jnifile
##    o [alpha,glnx86,sol2,unix,win32,mac]=path_to_jnifile
##    o $matlabroot/path_to_jnifile
##    o $jre_home/path_to_jnifile
##
$matlabroot/bin/$arch 
```

现在我打开 MATLAB：

```
java.lang.System.getProperty('java.library.path')
ans =
/Applications/MATLAB_R2012a.app/bin/maci64 
```

好的，看起来不错。现在让我们看看该文件夹中的内容：

```
ls /Applications/MATLAB_R2012a.app/bin/maci64/
...
libmex.dylib
... 
```

好的，`libmex.dylib`（例如）存在于该文件夹中。让我们尝试加载它：

```
java.lang.System.loadLibrary('libmex.dylib')
Java exception occurred:
java.lang.UnsatisfiedLinkError: no libmex.dylib in java.library.path 
```

为什么！？

# javascript - 如何检测元素是否未显示在屏幕上以进行滚动？

> ID：10558292
> 
> 赞同：2
> 
> 时间：2012-05-11T20:37:13.180
> 
> 标签：javascript, jquery

当用户在我的网站上向下滚动时，我想检测最上面的标题何时不在视野范围内。这可以用jquery吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:41:22.837

正如@RoryMcCrossan 提到的，您可以自己计算。

如果你想要更多的灵活性，试试这个 jQuery 插件：

[http://www.appelsiini.net/projects/viewport](http://www.appelsiini.net/projects/viewport)

它会让你根据元素是否在可见视口内来查询 DOM。

例如：

```
$("div:in-viewport") 
```

只会返回`div`当前可见的 s。

您还可以根据它们的位置查询不可见的元素。主要是：

```
$(":below-the-fold")
$(":above-the-top")
$(":left-of-screen")
$(":right-of-screen") 
```

查看上面的链接以获取更多信息和下载。

* * *

如果你想使用这个库来查询当前未显示的元素，
无论它们在哪里，然后使用这个：

```
$("div").not(":in-viewport") 
```

* * *

因此，假设您的标头的 ID 为`header`，您可以使用：

```
var $header = $('#header');

$(window).scroll(function()
{
    var isVisible = $header.is(':in-viewport');
    // Now show, hide, or do whatever you want...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:42:05.813

您需要检查元素`offset()`的位置，使用窗口滚动的位置。像这样的东西：

```
$(window).scroll(function() {
    var $header = $("#header");
    var headerBottomPos = $header.offset().top + $header.height();
    if (headerBottomPos < this.scrollTop()) {
        // header is not being displayed
    }
}); 
```

# java - 加载 .mtl 和 .obj 文件时使用 min3d 解析错误

> ID：10558293
> 
> 赞同：1
> 
> 时间：2012-05-11T20:37:14.273
> 
> 标签：java, android, opengl-es, .obj

Blender >> .obj, .mtl >> Java 使用 min3D, openGL ES >> Android 设备

我做错了什么或者这些 .mtl 或 .obj 文件有什么问题会导致在 min3d 中出现解析器错误？

到目前为止，我只用下划线“mtllib face_mtl”替换了“mtllib face.mtl”中的句点

没有任何东西是表格或间隔的。如果它看起来很奇怪，那是因为我在提交这个问题时犯了错误。

到目前为止，“MatD 教程”中的所有示例都运行良好。只有当我尝试加载自己的文件时，才会遇到问题。

在检查 Wavefront obj 文件的 Wiki 页面时，我逐行查看了这两个文件，但没有运气。

我有一种感觉，这可能与 .mtl 或整个导出中的纹理问题有关。我没有使用 Blender 导出的任何图像或任何其他文件。

非常感谢，我希望这一切都清晰易读。

**错误：**发生在我在下面的代码中评论的地方

05-11 16:06:01.371：E/AndroidRuntime(2280)：致命异常：GLThread 9

05-11 16:06:01.371: E/AndroidRuntime(2280): java.lang.NullPointerException

**05-11 16:06:01.371: E/AndroidRuntime(2280): 在 min3d.parser.ObjParser.readMaterialLib(ObjParser.java:197)**

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 min3d.parser.ObjParser.parse(ObjParser.java:107)

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 nbg.min3d.test.Obj3DView.initScene(Obj3DView.java:24)

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 min3d.core.Scene.init(Scene.java:254)

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 min3d.core.Renderer.onSurfaceCreated(Renderer.java:75)

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1317)

05-11 16:06:01.371: E/AndroidRuntime(2280): 在 android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1116)

这是发生错误的地方：

```
private void readMaterialLib(String libID) {
    StringBuffer resourceID = new StringBuffer(packageID);
    StringBuffer libIDSbuf = new StringBuffer(libID);
    int dotIndex = libIDSbuf.lastIndexOf(".");
    if (dotIndex > -1)
        libIDSbuf = libIDSbuf.replace(dotIndex, dotIndex + 1, "_");

    resourceID.append(":raw/");
    resourceID.append(libIDSbuf.toString());

    InputStream fileIn = resources.openRawResource(resources.getIdentifier(
            resourceID.toString(), null, null));
    BufferedReader buffer = new BufferedReader(
            new InputStreamReader(fileIn));
    String line;
    String currentMaterial = "";

    try {
        while ((line = buffer.readLine()) != null) {
            String[] parts = line.split(" ");
            if (parts.length == 0)
                continue;
            String type = parts[0];

            if (type.equals(NEW_MATERIAL)) {
                if (parts.length > 1) {
                    currentMaterial = parts[1];
                    materialMap.put(currentMaterial, new Material(
                            currentMaterial));
                }
            } else if(type.equals(DIFFUSE_COLOR) && !type.equals(DIFFUSE_TEX_MAP)) {
                Color4 diffuseColor = new Color4(Float.parseFloat(parts[1]) * 255.0f, Float.parseFloat(parts[2]) * 255.0f, Float.parseFloat(parts[3]) * 255.0f, 255.0f);

**//Below is where the error happens.. aka (ObjParser.java: 197)**

                materialMap.get(currentMaterial).diffuseColor = diffuseColor;
            } else if (type.equals(DIFFUSE_TEX_MAP)) {
                if (parts.length > 1) {
                    materialMap.get(currentMaterial).diffuseTextureMap = parts[1];
                    StringBuffer texture = new StringBuffer(packageID);
                    texture.append(":drawable/");

                    StringBuffer textureName = new StringBuffer(parts[1]);
                    dotIndex = textureName.lastIndexOf(".");
                    if (dotIndex > -1)
                        texture.append(textureName.substring(0, dotIndex));
                    else
                        texture.append(textureName);

                    int bmResourceID = resources.getIdentifier(texture
                            .toString(), null, null);
                    Bitmap b = Utils.makeBitmapFromResourceId(bmResourceID);
                    textureAtlas.addBitmapAsset(new BitmapAsset(currentMaterial, texture.toString()));
                }
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

.obj 文件：

```
# Blender v2.62 (sub 0) OBJ File: 'cylxyzaxis.blend'
# www.blender.org
mtllib face_mtl
o Cylinder.002
v 0.003384 0.016776 -1.001130
v 0.004515 0.016664 -1.001130
v 0.005603 0.016334 -1.001130
v 0.006606 0.015798 -1.001130
v 0.007485 0.015077 -1.001130
v 0.008206 0.014198 -1.001130
v 0.008742 0.013195 -1.001130
v 0.009072 0.012107 -1.001130
v 0.009184 0.010976 -1.001130
v 0.009072 0.009844 -1.001130
v 0.008742 0.008756 -1.001130
v 0.008206 0.007753 -1.001130
v 0.007485 0.006874 -1.001130
v 0.006606 0.006153 -1.001130
v 0.005603 0.005617 -1.001130
v 0.004515 0.005287 -1.001130
v 0.003384 0.005176 -1.001130
v 0.002252 0.005287 -1.001130
v 0.001164 0.005617 -1.001130
v 0.000161 0.006153 -1.001130
v -0.000717 0.006874 -1.001130
v -0.001439 0.007753 -1.001130
v -0.001975 0.008756 -1.001130
v -0.002305 0.009844 -1.001130
v -0.002416 0.010976 -1.001130
v -0.002305 0.012107 -1.001130
v -0.001975 0.013195 -1.001130
v -0.001439 0.014198 -1.001130
v -0.000717 0.015077 -1.001130
v 0.000161 0.015798 -1.001130
v 0.001164 0.016334 -1.001130
v 0.002252 0.016664 -1.001130
v 0.003384 0.016774 0.998870
v 0.004515 0.016663 0.998870
v 0.005603 0.016333 0.998870
v 0.006606 0.015797 0.998870
v 0.007485 0.015076 0.998870
v 0.008206 0.014197 0.998870
v 0.008742 0.013194 0.998870
v 0.009072 0.012106 0.998870
v 0.009184 0.010974 0.998870
v 0.009072 0.009843 0.998870
v 0.008742 0.008755 0.998870
v 0.008206 0.007752 0.998870
v 0.007485 0.006873 0.998870
v 0.006606 0.006152 0.998870
v 0.005603 0.005616 0.998870
v 0.004515 0.005286 0.998870
v 0.003384 0.005174 0.998870
v 0.002252 0.005286 0.998870
v 0.001164 0.005616 0.998870
v 0.000161 0.006152 0.998870
v -0.000717 0.006873 0.998870
v -0.001439 0.007752 0.998870
v -0.001975 0.008755 0.998870
v -0.002305 0.009843 0.998870
v -0.002416 0.010974 0.998870
v -0.002305 0.012106 0.998870
v -0.001975 0.013194 0.998870
v -0.001439 0.014197 0.998870
v -0.000718 0.015075 0.998870
v 0.000161 0.015797 0.998870
v 0.001164 0.016333 0.998870
v 0.002252 0.016663 0.998870
v 0.003384 0.010976 -1.001130
v 0.003384 0.010974 0.998870
usemtl 
s off
f 65 1 2
f 66 34 33
f 65 2 3
f 66 35 34
f 65 3 4
f 66 36 35
f 65 4 5
f 66 37 36
f 65 5 6
f 66 38 37
f 65 6 7
f 66 39 38
f 65 7 8
f 66 40 39
f 65 8 9
f 66 41 40
f 65 9 10
f 66 42 41
f 65 10 11
f 66 43 42
f 65 11 12
f 66 44 43
f 65 12 13
f 66 45 44
f 65 13 14
f 66 46 45
f 65 14 15
f 66 47 46
f 65 15 16
f 66 48 47
f 65 16 17
f 66 49 48
f 65 17 18
f 66 50 49
f 65 18 19
f 66 51 50
f 65 19 20
f 66 52 51
f 65 20 21
f 66 53 52
f 65 21 22
f 66 54 53
f 65 22 23
f 66 55 54
f 65 23 24
f 66 56 55
f 65 24 25
f 66 57 56
f 65 25 26
f 66 58 57
f 65 26 27
f 66 59 58
f 65 27 28
f 66 60 59
f 65 28 29
f 66 61 60
f 65 29 30
f 66 62 61
f 65 30 31
f 66 63 62
f 65 31 32
f 66 64 63
f 32 1 65
f 66 33 64
f 1 33 34 2
f 2 34 35 3
f 3 35 36 4
f 4 36 37 5
f 5 37 38 6
f 6 38 39 7
f 7 39 40 8
f 8 40 41 9
f 9 41 42 10
f 10 42 43 11
f 11 43 44 12
f 12 44 45 13
f 13 45 46 14
f 14 46 47 15
f 15 47 48 16
f 16 48 49 17
f 17 49 50 18
f 18 50 51 19
f 19 51 52 20
f 20 52 53 21
f 21 53 54 22
f 22 54 55 23
f 23 55 56 24
f 24 56 57 25
f 25 57 58 26
f 26 58 59 27
f 27 59 60 28
f 28 60 61 29
f 29 61 62 30
f 30 62 63 31
f 31 63 64 32
f 33 1 32 64
o Cylinder.001
v -0.996616 0.010976 -0.006930
v -0.996616 0.009844 -0.006819
v -0.996616 0.008756 -0.006489
v -0.996616 0.007753 -0.005953
v -0.996616 0.006874 -0.005231
v -0.996616 0.006153 -0.004353
v -0.996616 0.005617 -0.003350
v -0.996616 0.005287 -0.002262
v -0.996616 0.005176 -0.001130
v -0.996616 0.005287 0.000001
v -0.996616 0.005617 0.001089
v -0.996616 0.006153 0.002092
v -0.996616 0.006874 0.002971
v -0.996616 0.007753 0.003692
v -0.996616 0.008756 0.004228
v -0.996616 0.009844 0.004558
v -0.996616 0.010976 0.004670
v -0.996616 0.012107 0.004558
v -0.996616 0.013195 0.004228
v -0.996616 0.014198 0.003692
v -0.996616 0.015077 0.002971
v -0.996616 0.015798 0.002092
v -0.996616 0.016334 0.001089
v -0.996616 0.016664 0.000001
v -0.996616 0.016776 -0.001130
v -0.996616 0.016664 -0.002262
v -0.996616 0.016334 -0.003350
v -0.996616 0.015798 -0.004353
v -0.996616 0.015077 -0.005231
v -0.996616 0.014198 -0.005953
v -0.996616 0.013195 -0.006489
v -0.996616 0.012107 -0.006819
v 1.003384 0.010974 -0.006930
v 1.003384 0.009843 -0.006819
v 1.003384 0.008755 -0.006489
v 1.003384 0.007752 -0.005953
v 1.003384 0.006873 -0.005231
v 1.003384 0.006152 -0.004353
v 1.003384 0.005616 -0.003350
v 1.003384 0.005286 -0.002262
v 1.003384 0.005174 -0.001130
v 1.003384 0.005286 0.000001
v 1.003384 0.005616 0.001089
v 1.003384 0.006152 0.002092
v 1.003384 0.006873 0.002971
v 1.003384 0.007752 0.003692
v 1.003384 0.008755 0.004228
v 1.003384 0.009843 0.004558
v 1.003384 0.010974 0.004670
v 1.003384 0.012106 0.004558
v 1.003384 0.013194 0.004228
v 1.003384 0.014197 0.003692
v 1.003384 0.015076 0.002971
v 1.003384 0.015797 0.002092
v 1.003384 0.016333 0.001089
v 1.003384 0.016663 0.000001
v 1.003384 0.016774 -0.001130
v 1.003384 0.016663 -0.002262
v 1.003384 0.016333 -0.003350
v 1.003384 0.015797 -0.004352
v 1.003384 0.015076 -0.005231
v 1.003384 0.014197 -0.005953
v 1.003384 0.013194 -0.006489
v 1.003384 0.012106 -0.006819
v -0.996616 0.010976 -0.001130
v 1.003384 0.010974 -0.001130
usemtl 
s off
f 131 67 68
f 132 100 99
f 131 68 69
f 132 101 100
f 131 69 70
f 132 102 101
f 131 70 71
f 132 103 102
f 131 71 72
f 132 104 103
f 131 72 73
f 132 105 104
f 131 73 74
f 132 106 105
f 131 74 75
f 132 107 106
f 131 75 76
f 132 108 107
f 131 76 77
f 132 109 108
f 131 77 78
f 132 110 109
f 131 78 79
f 132 111 110
f 131 79 80
f 132 112 111
f 131 80 81
f 132 113 112
f 131 81 82
f 132 114 113
f 131 82 83
f 132 115 114
f 131 83 84
f 132 116 115
f 131 84 85
f 132 117 116
f 131 85 86
f 132 118 117
f 131 86 87
f 132 119 118
f 131 87 88
f 132 120 119
f 131 88 89
f 132 121 120
f 131 89 90
f 132 122 121
f 131 90 91
f 132 123 122
f 131 91 92
f 132 124 123
f 131 92 93
f 132 125 124
f 131 93 94
f 132 126 125
f 131 94 95
f 132 127 126
f 131 95 96
f 132 128 127
f 131 96 97
f 132 129 128
f 131 97 98
f 132 130 129
f 98 67 131
f 132 99 130
f 67 99 100 68
f 68 100 101 69
f 69 101 102 70
f 70 102 103 71
f 71 103 104 72
f 72 104 105 73
f 73 105 106 74
f 74 106 107 75
f 75 107 108 76
f 76 108 109 77
f 77 109 110 78
f 78 110 111 79
f 79 111 112 80
f 80 112 113 81
f 81 113 114 82
f 82 114 115 83
f 83 115 116 84
f 84 116 117 85
f 85 117 118 86
f 86 118 119 87
f 87 119 120 88
f 88 120 121 89
f 89 121 122 90
f 90 122 123 91
f 91 123 124 92
f 92 124 125 93
f 93 125 126 94
f 94 126 127 95
f 95 127 128 96
f 96 128 129 97
f 97 129 130 98
f 99 67 98 130
o Cylinder
v 0.000000 -1.000000 -0.005800
v 0.001132 -1.000000 -0.005689
v 0.002220 -1.000000 -0.005358
v 0.003222 -1.000000 -0.004822
v 0.004101 -1.000000 -0.004101
v 0.004822 -1.000000 -0.003222
v 0.005358 -1.000000 -0.002220
v 0.005689 -1.000000 -0.001132
v 0.005800 -1.000000 -0.000000
v 0.005689 -1.000000 0.001132
v 0.005358 -1.000000 0.002220
v 0.004822 -1.000000 0.003222
v 0.004101 -1.000000 0.004101
v 0.003222 -1.000000 0.004822
v 0.002220 -1.000000 0.005358
v 0.001132 -1.000000 0.005689
v -0.000000 -1.000000 0.005800
v -0.001132 -1.000000 0.005689
v -0.002220 -1.000000 0.005358
v -0.003222 -1.000000 0.004822
v -0.004101 -1.000000 0.004101
v -0.004822 -1.000000 0.003222
v -0.005358 -1.000000 0.002220
v -0.005689 -1.000000 0.001132
v -0.005800 -1.000000 -0.000000
v -0.005689 -1.000000 -0.001132
v -0.005358 -1.000000 -0.002220
v -0.004822 -1.000000 -0.003222
v -0.004101 -1.000000 -0.004101
v -0.003222 -1.000000 -0.004822
v -0.002220 -1.000000 -0.005358
v -0.001132 -1.000000 -0.005689
v 0.000000 1.000000 -0.005800
v 0.001132 1.000000 -0.005689
v 0.002220 1.000000 -0.005358
v 0.003222 1.000000 -0.004822
v 0.004101 1.000000 -0.004101
v 0.004822 1.000000 -0.003222
v 0.005358 1.000000 -0.002220
v 0.005689 1.000000 -0.001132
v 0.005800 1.000000 0.000000
v 0.005689 1.000000 0.001132
v 0.005358 1.000000 0.002220
v 0.004822 1.000000 0.003222
v 0.004101 1.000000 0.004101
v 0.003222 1.000000 0.004822
v 0.002220 1.000000 0.005358
v 0.001132 1.000000 0.005689
v 0.000000 1.000000 0.005800
v -0.001132 1.000000 0.005689
v -0.002220 1.000000 0.005358
v -0.003222 1.000000 0.004822
v -0.004101 1.000000 0.004101
v -0.004822 1.000000 0.003222
v -0.005358 1.000000 0.002220
v -0.005688 1.000000 0.001132
v -0.005800 1.000000 0.000000
v -0.005689 1.000000 -0.001131
v -0.005358 1.000000 -0.002220
v -0.004822 1.000000 -0.003222
v -0.004101 1.000000 -0.004101
v -0.003222 1.000000 -0.004822
v -0.002220 1.000000 -0.005358
v -0.001132 1.000000 -0.005688
v 0.000000 -1.000000 0.000000
v 0.000000 1.000000 0.000000
usemtl 
s off
f 197 133 134
f 198 166 165
f 197 134 135
f 198 167 166
f 197 135 136
f 198 168 167
f 197 136 137
f 198 169 168
f 197 137 138
f 198 170 169
f 197 138 139
f 198 171 170
f 197 139 140
f 198 172 171
f 197 140 141
f 198 173 172
f 197 141 142
f 198 174 173
f 197 142 143
f 198 175 174
f 197 143 144
f 198 176 175
f 197 144 145
f 198 177 176
f 197 145 146
f 198 178 177
f 197 146 147
f 198 179 178
f 197 147 148
f 198 180 179
f 197 148 149
f 198 181 180
f 197 149 150
f 198 182 181
f 197 150 151
f 198 183 182
f 197 151 152
f 198 184 183
f 197 152 153
f 198 185 184
f 197 153 154
f 198 186 185
f 197 154 155
f 198 187 186
f 197 155 156
f 198 188 187
f 197 156 157
f 198 189 188
f 197 157 158
f 198 190 189
f 197 158 159
f 198 191 190
f 197 159 160
f 198 192 191
f 197 160 161
f 198 193 192
f 197 161 162
f 198 194 193
f 197 162 163
f 198 195 194
f 197 163 164
f 198 196 195
f 164 133 197
f 198 165 196
f 133 165 166 134
f 134 166 167 135
f 135 167 168 136
f 136 168 169 137
f 137 169 170 138
f 138 170 171 139
f 139 171 172 140
f 140 172 173 141
f 141 173 174 142
f 142 174 175 143
f 143 175 176 144
f 144 176 177 145
f 145 177 178 146
f 146 178 179 147
f 147 179 180 148
f 148 180 181 149
f 149 181 182 150
f 150 182 183 151
f 151 183 184 152
f 152 184 185 153
f 153 185 186 154
f 154 186 187 155
f 155 187 188 156
f 156 188 189 157
f 157 189 190 158
f 158 190 191 159
f 159 191 192 160
f 160 192 193 161
f 161 193 194 162
f 162 194 195 163
f 163 195 196 164
f 165 133 164 196 
```

.mtl 文件：

```
# Blender MTL File: 'cylxyzaxis.blend'
# Material Count: 1
newmtl
Ns 1.00000
Ka 0.000000 0.000000 0.000000
Kd 0.8 0.8 0.8
Ks 0.8 0.8 0.8
d 1
illum 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:15:07.030

我不是 .obj 的专家，但我认为这`usemtl`可能应该指定一个材料名称？类似的东西`usemtl some_material`。

这似乎与您的“当前材料为空”错误一致。

也应该在 mtl 文件中为材料命名：

`newmtl some_material`

# algorithm - Visvalingam-Whyatt 折线简化算法说明

> ID：10558299
> 
> 赞同：11
> 
> 时间：2012-05-11T20:37:30.837
> 
> 标签：algorithm, polyline, simplification

我正在尝试实现折线简化算法。原始文章可以在这里找到：http: [//archive.is/Tzq2](http://archive.is/Tzq2)。它在概念上似乎很简单，但我不理解提供的示例算法（我认为它措辞不佳）伪代码，并希望有人能提供一些见解。从文章中，我了解到基本思想是

1.  计算每个点的有效面积（由一条线上三个连续点之间的三角形组成）并删除面积为0的
2.  从最小的区域开始，将该点的区域与阈值进行比较，如果该区域低于该阈值，则将其从折线中删除。
3.  移动到两个相邻的点并在它们发生变化时重新计算它们的面积
4.  回到 2，直到阈值以下的所有点区域都被移除

算法如下（从文章中逐字复制）：

*   计算每个点的有效面积 删除所有面积为零的点，并将它们存储在具有该面积的单独列表中
*   重复
    *   找到有效面积最小的点并将其称为当前点。如果其计算的面积小于最后一个要消除的点的面积，则改用后者的面积。（这样可以确保在不消除先前消除的点的情况下无法消除当前点。）
    *   从原始列表中删除当前点并将其与相关区域一起添加到新列表中，以便可以在运行时过滤该行。
    *   重新计算两个相邻点的有效面积（见图 1b）。
*   直到
    *   原线只包含2个点，即起点和终点。

我对“重复”下第一步中的“if”子句感到困惑……有人能澄清一下吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-19T14:06:02.423

FWIW Mike Bostock 是 d3.js 的创建者，他为这个算法（Visvalingam's Algorithm）编写了一个紧凑的 JavaScript 实现。

*   [源代码](http://bost.ocks.org/mike/simplify/simplify.js)
*   [演示](http://bost.ocks.org/mike/simplify/)
*   [黑客新闻讨论](http://news.ycombinator.com/item?id=4055445)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-11T21:33:14.907

该算法的本质是按重要性对点进行排名。该点的意义近似于其有效面积。

假设您已经消除了 A 点，然后重新计算了 B 点的有效面积。新的面积可以大于*或小于*旧的面积。它可以小于 A 的有效区域。但是，该算法仍然认为 B 比 A 更重要。

该`if`子句的目的是确保 B 点在最终列表中比 A 点更重要，仅此而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-13T13:24:06.727

我也对此感到困惑，回去再次阅读这篇文章，并且如果您在进行过程中删除点，则*不需要*它- 也就是如果您正在使用固定区域阈值进行一次性简化。afaict javascript 实现以这种方式工作，因此它实际上不需要“if”语句（但它无论如何都有它，哦，好吧）。

如果您要保留所有要点，*则*需要“if”语句。在这种情况下，您将存储每个点的“有效区域”，以便*稍后*您可以过滤它们，也许使用控制输出点数的交互式滑块。通过存储更大的有效区域，您可以保持正确的顺序。

# ios - 在现有元素上显示进度线

> ID：10558309
> 
> 赞同：0
> 
> 时间：2012-05-11T20:38:35.817
> 
> 标签：ios, progress-bar, sequence, uibuilder

不确定标题是否很清楚，但我不知道我正在寻找的东西的确切名称。我有一个由 UIButtons 组成的网格（基本上是一个音序器）。我想要一条类似于此图像中垂直线的线（在每行的第 8 和第 9 个按钮之间：

![在此处输入图像描述](../Images/9c7bd1721142e695c8cdfb809df92496.png)

所以基本上当我的网格正在播放时，我想指出进度。知道我该怎么做吗？使用什么样的元素等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:56:15.373

您可以添加一个非常窄的 UIView，1 或 1.5 像素。将背景颜色设置为白色或渐变色。将此视图添加到与按钮相同的子视图中。

```
UIView *lineView = [[UIView alloc] initWithFrame:CGRectMake(100.0, 0.0, 1.5, 320.0)];
lineView.backgroundColor = [UIColor whiteColor];
[parentView addSubview:lineView]; 
```

要显示进度，您需要知道完成前还剩多少。取该值并除以 320 以获得 lineView 高度。

```
CGRect frame = CGRectMake(100.0, 0.0, 1.5, 0);
lineView.frame = frame; // 0% complete

frame = CGRectMake(100.0, 0.0, 1.5, 160.0);
lineView.frame = frame; // 50% complete

frame = CGRectMake(100.0, 0.0, 1.5, 320.0);
lineView.frame = frame; // 100% complete 
```

这就是想法。希望这有帮助。

**更新为在屏幕上移动的竖条**

```
UIView *lineView = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, 1.5, 320.0)];
lineView.backgroundColor = [UIColor whiteColor];
[parentView addSubview:lineView]; 
```

随着进展

```
- (void)progressWithValue(CGFloat)progress {
    CGRect frame = lineView.frame;
    frame.origin.x = progress;    // Change x position
    lineView.frame = frame;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:49:09.890

您可以使用 UISlider 显示您的事件或活动的进度（不太清楚您的代码）并根据您的需要对其进行自定义。您可以查看[Apple 的 UICatalog 示例代码](http://developer.apple.com/library/ios/#samplecode/UICatalog/Introduction/Intro.html)以了解如何自定义 UISlider与其他元素或[UISlider 教程](http://www.applausible.com/blog/?p=250)

# facebook - 带有自定义消息的 Facebook 请求对话框，例如 Branchout

> ID：10558310
> 
> 赞同：1
> 
> 时间：2012-05-11T20:38:36.723
> 
> 标签：facebook, dialog, request, apprequests, fb.ui

Branchout 如何自定义他们的请求对话框消息？对此没有选择。

文档[https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)没有提到任何额外的参数，只有 app_id、redirect_uri、message、to、filters、exclude_ids、max_recipients、data、title。

作为一个新用户，我不能发布图片。这里是链接：http: [//i.imgur.com/37tju.png](http://i.imgur.com/37tju.png) ,

我使用以下 javascript 调用 facebook 函数：

```
FB.ui({
    method        : 'apprequests',
    message       : 'Message itself',
    title         : 'Title message',
    display       : 'iframe',
    access_token  : '(access_token)',
    to            : uids
}, function(response) {
  if (response)
  {
    // handle callback.....
    // (...)
  } 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T13:57:42.007

有一些具有特殊权限的 API。您必须找到一种与 Facebook 取得联系的方式。我不知道任何文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T16:16:47.377

没有必要有特殊的伙伴关系来做这样的事情。

请检查[是否可以自定义类似于BranchOut的apprequest通知消息？](http://facebook.stackoverflow.com/questions/9981798/is-it-possible-to-customize-the-apprequest-notification-message-similar-to-branc)

# php - PHP 是完全无上下文的语言还是有上下文相关的部分？

> ID：10558311
> 
> 赞同：2
> 
> 时间：2012-05-11T20:38:39.577
> 
> 标签：php, grammar

PHP 有[一个 Bison 语法文件](https://github.com/php/php-src/blob/master/Zend/zend_language_parser.y)，这是否意味着 PHP 是一种完全无上下文的语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T12:49:15.620

如果您正在为 php 构建解析器，请查看现有的解析器：

[https://github.com/nikic/PHP-Parser](https://github.com/nikic/PHP-Parser) - 这是用 php 编写的，是一个独立的 php 解析器。

[https://github.com/svalaskevicius/ionPulse/tree/master/ionParticles/ionPhp/phpParser](https://github.com/svalaskevicius/ionPulse/tree/master/ionParticles/ionPhp/phpParser) - 这是 ionPulse IDE 的 php-support 插件的一部分，用 c++ 编写，功能测试在 <...>/ ionTests/phpparsertest.h [仍在进行中]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:56:18.147

只是想我会提到这一点，以防你没有看到它，它可能会为你节省很多时间，除非这是为了纯粹的学习。

查看 PHP [Tokenizer Functions](http://www.php.net/manual/en/ref.tokenizer.php)，它将为您将源文件解析为令牌。然后，您可以跨过令牌以检查来源。

这个例子取自 PHP.net，它将源文件读入令牌，并在去掉注释的情况下重现它：

```
<?php
/*
* T_ML_COMMENT does not exist in PHP 5.
* The following three lines define it in order to
* preserve backwards compatibility.
*
* The next two lines define the PHP 5 only T_DOC_COMMENT,
* which we will mask as T_ML_COMMENT for PHP 4.
*/
if (!defined('T_ML_COMMENT')) {
   define('T_ML_COMMENT', T_COMMENT);
} else {
   define('T_DOC_COMMENT', T_ML_COMMENT);
}

$source = file_get_contents('example.php');
$tokens = token_get_all($source);

foreach ($tokens as $token) {
   if (is_string($token)) {
       // simple 1-character token
       echo $token;
   } else {
       // token array
       list($id, $text) = $token;

       switch ($id) { 
           case T_COMMENT: 
           case T_ML_COMMENT: // we've defined this
           case T_DOC_COMMENT: // and this
               // no action on comments
               break;

           default:
               // anything else -> output "as is"
               echo $text;
               break;
       }
   }
}
?> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-11T20:43:53.370

I think you are mixing math with interpreted parsing.

Have a look at structures and data then determine the rationale behind your question.

# jquery - jQuery - 加载缩略图

> ID：10558315
> 
> 赞同：0
> 
> 时间：2012-05-11T20:39:11.103
> 
> 标签：jquery

基本上我在页面底部有缩略图和一张大图。我希望能够将鼠标悬停在缩略图上并让缩略图的来源替换大图像的来源，以便缩略图取代它。

请有人帮忙！！我需要尽快完成这个工作，我还应该提供其他信息吗？！

这是我正在使用的代码：

```
jQuery('.image-rollover').hover(function() {
    var src = $(this).attr("src").match(/[^\.]+/);
    jQuery('.replace img').replace("src", src);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:46:47.687

```
jQuery('.image-rollover').hover(function() {
    jQuery('.replace img').attr("src", this.src);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:50:03.013

这是您可能希望如何设置的总体思路：

[http://jsfiddle.net/GuSeg/](http://jsfiddle.net/GuSeg/)

您想将 mainImage 的 src 与悬停图像的 src 交换，方法是：

```
$('.thumbnailToHoverOn').hover(function(){
    $("#mainImg").attr("src", $(this).attr("src"));
});​ 
```

# windows - 批处理文件中延迟扩展的示例

> ID：10558316
> 
> 赞同：51
> 
> 时间：2012-05-11T20:39:27.033
> 
> 标签：windows, batch-file, cmd, environment-variables, delayedvariableexpansion

有人可以给我一个例子，说明批处理脚本在有或没有延迟扩展的情况下会有所不同吗？是否存在您不想使用延迟扩展的情况？谢谢。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-05-11T21:30:31.510

看看下面的例子......

**示例1：**下面的代码没有使用延迟扩展，所以for循环中的变量只被扩展了一次。这意味着无论我们使用 set 命令对它做什么，它`%Count%`都会在循环的每次迭代中展开：`0`

```
@echo off
set COUNT=0

for %%v in (1 2 3 4) do (
  set /A COUNT=%COUNT% + 1
  echo Count = %COUNT%
)
pause 
```

所以这个脚本会输出：

```
Count = 0
Count = 0
Count = 0
Count = 0 
```

这不是这个循环应该如何工作的。

**示例 2：**另一方面，如果我们使用延迟扩展，我们有以下脚本，它将按预期运行。

```
setlocal ENABLEDELAYEDEXPANSION
set COUNT=0

for %%v in (1 2 3 4) do (
  set /A COUNT=!COUNT! + 1
  echo Count = !COUNT!
)

pause 
```

并且，正如预期的那样，它将输出：

```
Count = 1
Count = 2
Count = 3
Count = 4 
```

当您使用`ENABLEDELAYEDEXPANSION`, 并使用`!`而不是扩展变量`%`时，每次都会重新扩展该变量，并且一切都按预期进行。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-04-30T19:26:07.637

我想添加一个很好的示例，说明“EnableDelayedExpansion”（EDE）如何在无处不在的 FOR 循环示例之外发挥作用。

这是我希望解析的一行地震数据（我称之为 1line.txt）

**ak_11574812 2015.04.29.193822 62.9525 -148.8849 1.0 9.5 1 49km S of Cantwell, Alaska**

我遇到的问题是这一行的最后一段并不总是从相同的列号开始。所以我需要创建一个灵活的 SET 命令，它可以准确地提取出这一行的最后一段。

```
ECHO OFF
setlocal enableDelayedExpansion
set where=72
set /p line=<1line.txt
set locate=!line:~%where%,28!
echo %locate% 
```

EDE 允许我将一个变量 (where) 放在另一个变量 (line) 中。EDE 将首先翻译 % 括起来的变量，然后处理 ! 括起来的变量 并且（在这种情况下）将结果推送到“定位”变量中。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-06-25T10:26:43.880

[Max 的回答](https://stackoverflow.com/a/10558905/3439404)给出了*一个示例，说明在有或没有延迟扩展的情况下，批处理脚本的行为会有所不同*。

为了完整起见，让我们回答问题的另一部分并展示当您的数据包含感叹号时您**不想使用延迟扩展的**`!`情况（并展示处理此类数据的两种方式）：

```
@ECHO OFF
SETLOCAL EnableExtensions DisableDelayedExpansion

  set "_auxFile=%temp%\%~n0.txt"
  rem create multiline sample file
  >"%_auxFile%" ( for /L %%G in (1,1,3) do echo line %%G is 100%% valid! Sure! Hurrah!)
  rem create one-line sample file
  >"%_auxFile%" echo this line is 100%% valid! Sure! Hurrah!

  echo(
  echo --- file content 
  type "%_auxFile%"

  echo(
  SETLOCAL EnableDelayedExpansion
    echo --- enabled delayed expansion chokes down unescaped exclamation marks^^^! "^!"
    for /F "usebackq delims=" %%G in ("%_auxFile%") do (
      set "_auxLine=%%~G"
      echo loop var=%%~G
      echo _auxLine=!_auxLine!
    )
  ENDLOCAL
  echo(
  SETLOCAL DisableDelayedExpansion
    echo --- toggled delayed expansion works although might be laborious!
    for /F "usebackq delims=" %%G in ("%_auxFile%") do (
      set "_auxLine=%%G"
      echo loop var=%%G
      SETLOCAL EnableDelayedExpansion
        echo _auxLine=!_auxLine!
      ENDLOCAL
    )
  ENDLOCAL
  echo(
  SETLOCAL DisableDelayedExpansion
    echo --- keep delayed expansion DISABLED: use CALL command!
    for /F "usebackq delims=" %%G in ("%_auxFile%") do (
      set "_auxLine=%%G"
      echo loop var=%%G
      call :ProcessVar
    )
  ENDLOCAL

  rem delete the sample file
  del "%_auxFile%"
ENDLOCAL
goto :eof

:ProcessVar
  echo _auxLine=%_auxLine%
  echo WARNING: neither !_auxLine! nor %%G loop variable is available here!  
goto :eof 
```

请注意，上面的脚本显示了[正确的转义方式](http://ss64.com/nt/syntax-esc.html)

*   `%`百分号`%%`加倍（延迟扩展无关紧要），和
*   `!`如果启用延迟扩展，感叹号：
    *   `"^!"`如果用一对双引号括起来，则使用`cmd`和批处理脚本通用转义字符`^`插入符号；
    *   `^^^!`否则，使用三个`^`插入符号。

**输出**：

```
==> D:\bat\SO\10558316.bat

--- file content
this line is 100% valid! Sure! Hurrah!

--- enabled delayed expansion chokes down unescaped exclamation marks! "!"
loop var=this line is 100% valid Hurrah
_auxLine=this line is 100% valid Hurrah

--- toggled delayed expansion works although might be laborious!
loop var=this line is 100% valid! Sure! Hurrah!
_auxLine=this line is 100% valid! Sure! Hurrah!

--- keep delayed expansion DISABLED: use CALL command!
loop var=this line is 100% valid! Sure! Hurrah!
_auxLine=this line is 100% valid! Sure! Hurrah!
WARNING: !_auxLine! as well as %G loop variables are not available here!

==> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-26T18:39:18.793

正如答案中所指出的，延迟扩展的主要用途是在括号上下文中设置和访问变量。

尽管它在其他情况下也很有用。

## 参数化子字符串和字符串替换：

```
@echo off
setlocal enableDelayedExpansion

set "string=test string value"
set start=5
set get_next=6

echo #!string:~%start%,%get_next%!#

set "search_for=string"
set "replace_with=text"

echo #!string:%search_for%=%replace_with%!# 
```

输出将是：

```
#string#
#test text value# 
```

虽然这可以通过额外的调用来实现，但这种方式更高效

## 在括号内使用 shift 命令参数化参数访问

```
@echo off

echo first attempt:
(
    echo "%~1"
    shift
    echo "%~1"
)
::now the shift command will take effect

setlocal enableDelayedExpansion
echo second attempt:

(   
    set /a argument=1
    call echo %%!argument! 
    shift
    call echo %%!argument! 
) 
```

输出将是：

```
first attempt:
"first argument"
"first argument"
second attempt:
"second argument"
"third argument" 
```

如您所见，参数化参数访问只能通过延迟扩展来完成。

## 使用 for 标记（或函数参数）进行参数化

另一种混合`!`s 和`%`s 的方法可能对嵌套循环有用：

```
@echo off
setlocal enabledelayedexpansion
set begin=2
set end=2
set string=12345

for /f "tokens=1,2" %%A in ("!begin! !end!") do set "string2=!string:~%%A,%%B!"
echo !string2!

endlocal 
```

正如您现在所看到的，for 命令标记用作参数。

# asp.net - 用 ASP 设置值的语法是什么？

> ID：10558319
> 
> 赞同：0
> 
> 时间：2012-05-11T20:39:32.277
> 
> 标签：asp.net, web-config

快速提问：如何使用 asp 设置默认值？这是我的代码：

```
 <SelectParameters>
        <asp:Parameter Name="ApplicationName" DefaultValue="Membership.ApplicationName"/>
    </SelectParameters> 
```

将 Membership.ApplicationName 从字符串转换为实际解析的语法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:51:58.463

您可以`Page_Load`像这样在您的方法中执行此操作：

```
yourSqlDataSource.SelectParameters.Add(
    new Parameter("ApplicationName", 
                   System.Data.DbType.String, 
                   Membership.ApplicationName)); 
```

（假设您`SqlDataSource`在页面上有一个名为`yourSqlDataSource`）

# java - Applet：Java.lang.SecurityException：类“...”的签名者信息与同一包中其他类的歌手信息不匹配

> ID：10558326
> 
> 赞同：1
> 
> 时间：2012-05-11T20:39:50.020
> 
> 标签：java, applet, securityexception

我有一个不会为在 Vista 上运行 IE7 的 1 个客户端加载的小程序。

错误是：

```
java.lang.SecurityException: class "com.arup.web.printing.WebPrintApplet"'s signer information does not match signer information of other classes in the same package. 
```

小程序代码位于名为***WebPrintApplet.jar***的 jar 文件中，它依赖于 Sun 的***PdfRenderer.jar***。我已经使用相同的证书对这两个 jar 文件进行了签名，并且我们正在从我们的 Web 服务器上的同一文件夹中托管这些 jar 文件。

我对在我们的案例中可能导致此问题的原因感到茫然。我的小程序的代码都在`com.arup.web.printing.WebPrintApplet`包中，并且整个 jar 文件都已签名。

关于这个问题的任何线索以及如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:44:43.683

> 我已经使用相同的证书对这两个 jar 文件进行了签名，并且我们正在从我们的 Web 服务器上的同一文件夹中托管这些 jar 文件。

如果其中一个罐子已经被签名，它现在将有多个数字签名。这可能会导致看到的错误。

顺便说一句，Java 7 JRE 应该支持使用[JWS](https://stackoverflow.com/tags/java-web-start/info)部署嵌入式小程序，这反过来又允许对打印机进行沙盒访问。这是一个[演示。或 JNLP`PrintService`](http://pscode.org/jws/api.html#prs)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T09:48:50.940

由于您似乎有很长的测试周期，您可能想要调查另一个失败的来源。**如果您在两个不同的 jar 文件中有同一个包**中的类，则通常会出现此错误，例如，如果您对 jar 文件中的 pdf 渲染器进行了扩展/更改。我认为您应该通过设计避免此类构造，并且在不可能的情况下，您必须对两个 jar 具有相同的签名者信息。

当前的插件支持不同 jar 上的不同签名者，但我不知道在不同 jar 上使用“共享”包的许多签名者的实现如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-01T22:13:13.213

我知道这已经两年了，但它可能对我的情况有所帮助：

将违规类的 jar 放入 $JDK/jre/lib/ext/ 并使用新的 JVM 进程重试。

# jquery - jQuery ContentFlow 不会加载所有图像

> ID：10558331
> 
> 赞同：1
> 
> 时间：2012-05-11T20:40:09.530
> 
> 标签：jquery, firefox

我已将 ContentFlow 幻灯片集成到我的网站中。

*   内容流：[http ://www.jacksasylum.eu/ContentFlow/](http://www.jacksasylum.eu/ContentFlow/)
*   测试站点：[http ://www.bennoerni.ch/test.html](http://www.bennoerni.ch/test.html)

问题是：幻灯片不会加载所有图像。（见上面的测试链接）。

该问题已在此处描述：

*   [http://www.jeremyckahn.com/blog/?p=61](http://www.jeremyckahn.com/blog/?p=61)
*   [http://code.google.com/p/contentflow/issues/detail?id=3](http://code.google.com/p/contentflow/issues/detail?id=3)

建议的解决方案“使用 v.1.0.0”在我的站点中不起作用。如果我这样做，内容流 div 的高度不够大 - 它隐藏了幻灯片的一半。而且我无法通过 CSS 让它变得更大。

我花了相当多的时间来寻找这个错误。我找到了改变 v.1.0.0 和 v.1.0.2 之间行为的行。（v.1.0.2 中的第 452 行）

```
this.content.onload = window.setTimeout(foobar, 100); 
```

v.1.0.0

```
this.content.onload = foobar; 
```

我还尝试了上面 google 代码链接中的所有代码片段。无法让它工作。

我将非常感谢任何帮助！

我认为最简单的方法是使用 v.1.0.0 并尝试修复 CSS。但我不知道该怎么做，因为 CSS 是由 ContentFlow 设置的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:36:06.887

在此处查看评论 41：[http](http://code.google.com/p/contentflow/issues/detail?id=3) ://code.google.com/p/contentflow/issues/detail?id= 3 为我修复了它。

# c# - aspnet_compiler.exe 是特殊的吗？

> ID：10558332
> 
> 赞同：2
> 
> 时间：2012-05-11T20:40:09.963
> 
> 标签：c#, asp.net, aspnet-compiler, precompile

我正在尝试为我正在处理的项目制作一个 ASP.NET 编译工具。使用 aspnet_compiler 确实可以很好地工作，但是自定义工具会更好地满足我们的目的。

但是，当我运行 ClientBuildManager.PrecompileApplication 方法时，我收到一个“MissingManifestResourceException”，抱怨“找不到适合指定文化或中性文化的任何资源”。

然后我反编译了 aspnet_compiler.exe 并使用了它的单个 Precompiler.cs 文件，它给出了相同的异常。

所以它不是我的代码，因为当我使用 aspnet_compiler.exe 源代码时会发生同样的问题，而是其他问题。

是什么让 aspnet_compiler 如此特别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:46:22.317

I think you're biting off more than you can probably chew trying to write your own ASP.NET compiler. If there's something special you need to do before or after compilation, look into using a *Pre* or *Post* build script.

![enter image description here](../Images/14e998c0ddcacad2d3fd576c07076ccf.png)

# asp.net-mvc-3 - 带区域和不同参数的路由，误解

> ID：10558334
> 
> 赞同：0
> 
> 时间：2012-05-11T20:40:14.823
> 
> 标签：asp.net-mvc-3, routing

我整天都很困惑，我有一个区域路由，它看起来像这样。

```
public class AdminAreaRegistration : AreaRegistration
{
    public override string AreaName
    {
        get
        {
            return "admin";
        }
    }

    public override void RegisterArea(AreaRegistrationContext context)
    {
        context.MapRouteLowercase(null, "Account/{action}",
                                  new {controller = "Account"},
                                  new {action = @"LogOff|LogOn|Create|Update|Delete|List"},
                                  new[] {"WebUI.Areas.Admin.Controllers"});

        context.MapRouteLowercase( //this works
            "AdminUpdateCategoryView",
            "admin/{controller}/{action}/{cid}",
            new {area = "admin", controller = "Main", action = "UpdateCategory", cid = ""},
            new {cid = @"\d+"},
            new[] {"WebUI.Areas.Admin.Controllers"}
        );

        context.MapRouteLowercase(//this not works
            "AdminCategoryListView",
            "admin/Main/{action}/{page}",
            new { action = "Category", page = "1" },
            new {page = @"\d+"},
            new[] {"WebUI.Areas.Admin.Controllers"}
        );

        context.MapRouteLowercase(
            "Admin_Default", // Route name
            "admin/{controller}/{action}/{id}", // URL with parameters
            new {controller = "Category", action = "Index", id = UrlParameter.Optional} // Parameter defaults
        );
    }
} 
```

我已经写了哪些有效，哪些无效，但是如果在它们之间改变一个不起作用，有效，另一个有效，不工作？

例子：

> ```
> first case-> /admin/main/updatecategory/1 --> works 
>              /admin/main/category/1       --> not works
>              result: /admin/main/category/1?page=1
> 
> second case-> /admin/main/category/1 --> works
>               /admin/main/updatecategory/1 --> not works
>               result: /admin/main/updatecategory/1?cid=1 
> ```

这是我的控制器操作：

```
public ActionResult Category(int? page)
    {
        int pageIndex = page.HasValue ? page.Value : 1;
        return View("Category", CategoryViewModelFactory(pageIndex));
    }

    public ActionResult CreateCategory()
    {
        return View();
    }

    public ActionResult UpdateCategory(int cid)
    {
        return View();
    }

    public ActionResult DeleteCategory(int? cid)
    {
        return View();
    } 
```

这是什么问题以及如何解决？

我很困惑，ASP.MVC3 中的路由是电子逻辑的。

帮助？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T02:25:41.923

搜索路由时，将使用与您的 URL 匹配的第一个路由。`AdminUpdateCategoryView`将匹配任何管理控制器和操作。您提供了“”的默认 cid，但这无关紧要，因为您要求 cid 是一个低于该数字的数字。`AdminCategoryListView`将匹配进入 main 的任何 url。因为您提供的默认页面为 1，所以即使没有提供页面也没关系。

所以如果`AdminCategoryListView`在最上面：admin/main 中的每条路由都将使用该路由。如果`AdminUpdateCategoryView`在管理员中到达此路由并具有数字 cid 值参数的每个路由都将使用它。

我建议放在`AdminCategoryListView`上面，因为它是更具体的路线。删除`page="1"`（取决于您是否要提供默认值），或替换`{action}`为“类别”，这样您的其他路由就不会使用此路由。此外，您应该提供一个默认的 main 控制器，否则它将假定您当前使用的控制器是正确的。

```
context.MapRouteLowercase(
        "AdminCategoryListView",
        "admin/Main/category/{page}",
        new { action = "Category", controller = "Main" },
        new {page = @"\d+"},
        new[] {"WebUI.Areas.Admin.Controllers"}
    );

//Put AdminUpdateCategoryView here 
```

# java - 将中缀表达式转换为后缀表达式 - 无效空格插入

> ID：10558343
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:11.180
> 
> 标签：java, parsing, spacing

我正在制作一个转换器，它将接受中缀表达式并将它们转换为后缀表达式。

```
Example:
Infix: 2 * 3 - 10 / 4
Postfix: 2 3 * 10 4 / - 
```

我有一个完全编码的方法，但它返回的后缀表达式是

```
2     3   *   1 0     4 / - 
```

这样做有两个问题： 1\. 主要问题是它们是 1 和 0 之间的一个空格，当它们应该在一起时（10）。2\. 有很多多余的空格，输出应该和上面提供的例子一样。

我已经研究过从中缀到后缀的转换，但我无法确定如何进行比单个数字表达式转换更多的操作。

下面附上我的 postfixtoinfix 类，表达式变量以完美间距保存上例中指示的中缀。

```
import java.util.*;

public class InfixToPostfix
{
//Declare Instance Variables
private String expression;
private Stack<Character> stack = new Stack<Character>();

//Constructor
public InfixToPostfix(String infixExpression)
{
        expression = infixExpression;
}//End of constructor

//Translate's the expression to postfix
public String translate()
{
    //Declare Method Variables
    String input = "";
    String output = "";
    char character = ' ';
    char nextCharacter = ' ';

    for(int x = 0; x < expression.length(); x++)
    {
        character = expression.charAt(x);

        if(isOperator(character))
        {
            while(!stack.empty() && precedence(stack.peek())>= precedence(character))
                output += stack.pop() + " ";
            stack.push(character);
        }   
        else if(character == '(')
        {
            stack.push(character);
        }
        else if(character == ')')
        {
            while(!stack.peek().equals('('))
                output += stack.pop() + " ";
            stack.pop();
        }
        else
        {
            if(Character.isDigit(character) && (x + 1) < expression.length() && Character.isDigit(expression.charAt(x+1)))
            {
                output += character;
            }
            else if(Character.isDigit(character))
            {
                output += character + " ";
            }   
            else
            {
                output += character;
            }
        }
    }//End of for

    while(!stack.empty())
    {
        output += stack.pop() + " ";
    }

    return output;
}//End of translate method

//Check priority on characters
public static int precedence(char operator)
{
    if(operator == '+' || operator =='-')
        return 1;
    else if(operator == '*' || operator == '/')
        return 2;
    else
        return 0;
}//End of priority method

public boolean isOperator(char element)
{
    if(element == '*' || element == '-' || element == '/' || element == '+')
        return true;
    else
        return false;
}//End of isOperator method

}//End of class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:50:56.990

您的代码没有将“10”视为一个实体，而是将其视为两个单独的字符“1”和“0”。对于任何不是运算符或括号的事情，你所做`output += character + " ";`的都会给你你的`1 0`而不是你想要的`10`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:55:48.217

将任意算术表达式从其中缀（即算术表达式的常规形式）转换为后缀形式的问题并不像最初看起来那么简单。

算术表达式代表一种上下文无关的语言，可以使用下推自动化来识别。作为这种识别的结果，可以构造语法树或 AST（抽象语法树），它们将自下而上遍历以构造后缀形式。

一本没有太多理论的很好的实用书是[Language Implementation Patterns](http://pragprog.com/book/tpdsl/language-implementation-patterns)，我强烈推荐。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:29:05.370

就像@digitaljoel 所说，您将单个字符识别为词汇标记，而不是完整的单词作为标记。

您应该让解析器调用一个方法来从输入中读取下一个完整的标记，而不是读取单个字符然后决定它是什么标记（运算符或操作数）。然后可以将令牌作为字符串（包含一个或多个组成令牌的字符）或作为类对象（包含令牌的文本和某种 token_type 属性）返回。

否则，您的解析器仅限于处理单字符标记。

Another benefit of using a separate lexical analyzer to read tokens is that you can handle whitespace in the lexer instead of in the parser.

# mvvm-light - 为什么 NuGet 会为所有框架和所有平台获取 MVVMLight？

> ID：10558346
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:15.353
> 
> 标签：mvvm-light, nuget, nuget-package

NuGet 正在为 WPF、SL3、SL4、SL5、WP7 获取 MVVMLight 二进制文件，我不太喜欢这样。有没有办法让它只适用于项目正在使用的框架？

NuGet 通常如何为其他包工作，这可能是 MVVMLight 作者在创建 NuGet 包时应该做的事情？

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T00:29:01.740

在一个独特的包中包含不同框架版本的库是一个 nuget 约定。这使包消费者更容易，只有一个版本的包要安装。

通过 NuGet 包管理器（UI 或控制台）安装包时，NuGet 只会添加对以项目框架为目标的库的引用。注意：所有的包内容都解包到“\packages\”，包括未使用的库。

示例：我创建了一个 SL4 应用程序并安装了 MVVMLightLibs。仅添加 GalaSoft.MvvmLight.Extras.SL4 和 GalaSoft.MvvmLight.SL4 作为参考。

[请参阅 nuget 文档：Supporting_Multiple_.NET_Framework_Versions_and_Profiles](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package#Supporting_Multiple_.NET_Framework_Versions_and_Profiles)

# ruby-on-rails - 在控制器测试中存根模型属性

> ID：10558347
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:15.983
> 
> 标签：ruby-on-rails, rspec, factory-bot, stub

我发现很难在控制器测试中存根模型的某些属性。我想确保尽可能少地存根。

* * *

**编辑**：我已经不再使用存根进行这种集成。我知道存根不会到达操作调用。现在正确的问题是：

> 如何在 Rails 控制器测试中使用 mocks 和 stub 来模拟某种状态？

* * *

所以我已经达到了以下内容：

## 规格

```
require 'spec_helper'

describe TeamsController do
  let(:team) { FactoryGirl.create :team }

  context "having questions" do
    let(:competition) { FactoryGirl.create :competition }

    it "allows a team to enter a competition" do
      post(:enter_competition, id: team.id, competition_id: competition.id)

      assigns(:enroll).team.should == team
      assigns(:enroll).competition.should == competition
    end
  end

  # ...
end 
```

## 工厂

```
FactoryGirl.define do
  factory :team do
    name "Ruby team"
  end

  factory :competition, class: Competition do
    name "Competition with questions"

    after_create do |competition|
      competition.
        stub(:questions).
        and_return([ 
          "something"
        ])
    end
  end

  factory :empty_competition, class: Competition do
    name "Competition without questions"
    questions []

    after_create do |competition|
      competition.stub(:questions).and_return []
    end
  end
end 
```

## 生产代码

```
class TeamsController < ApplicationController
  def enter_competition
    @team = Team.find params[:id]
    @competition = Competition.find params[:competition_id]
    @enroll = @team.enter_competition @competition

    render :nothing => true
  end
end

class Team < ActiveRecord::Base
  def enter_competition competition
    raise Competition::Closed if competition.questions.empty?

    enroll = Enroll.new team: self, competition: competition
    enroll.save
    enroll
  end
end 
```

当我运行测试时，该`questions`属性是存在的`nil`，因此在检查`nil.empty?`.

为什么不使用存根以便正确使用该消息的状态？我预计`@competition.questions`会是这样，`[ "question" ]`但我得到了`nil`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T13:36:40.407

您遇到的问题是`stub`适用于 Ruby 对象的实例；它不会影响代表同一行的所有 ActiveRecord 对象。

修复测试的最快方法是将其添加到您的测试中，在`post`：

```
Competition.stub(:find).and_return(competition) 
```

必要的原因是`Competition.find`它将返回一个`Competition`没有`questions`存根的新对象，即使它代表相同的数据库行。存根`find`也意味着它将返回相同的实例`Competition`，这意味着控制器将看到存根`questions`。

不过，我建议不要在您的工厂中使用该存根，因为作为使用工厂的开发人员，存根的内容并不明显，并且因为这意味着您将永远无法测试真正的`questions`方法，您将想要在`Competition`单元测试以及任何集成测试中做。

**长话短说**：如果你在你的模型实例上存根一个方法，你还需要`find`为那个模型存根（或者你用来找到它的任何类方法），但是有这样的存根不是一个好主意在工厂定义中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T07:49:21.833

当您调用`create`FactoryGirl 时，它会创建数据库记录，然后您可以在控制器代码中检索这些记录。所以你得到的实例 ( `@team`, `@competition`) 是纯 ActiveRecord，没有任何方法被删除。

就我个人而言，我会像这样写你的测试（根本不接触数据库）：

```
let(:team) { mock_model(Team) }
let(:competition) { mock_model(Competition) }

before do
  Team.stub(:find) { team }
  Competition.stub(:find) { competition }
end 
```

然后在你的测试中是这样的：

```
it "should call enter_competition on @team with @competition" do
  team.should_receive(:enter_competition).with(competition)

  post :enter_competition, id: 7, competition_id: 10 
```

我真的不明白你的控制器应该做什么或者你在测试什么，对不起:(

# android - 布尔变量未传递给 getBoolean 变量

> ID：10558348
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:17.553
> 
> 标签：android, bundle

```
Intent i = new Intent(AndroidGUIActivity.this, Basic_database_questionsActivity.class);
Bundle b = new Bundle();
// get the current value of timerStart variable and store it in timerlogic
Log.e(LOGS, "Whatis the value of timerstart inside the intentcalls method" +  timerStart);
b.getBoolean("timerlogic", timerStart);
boolean timermagic= b.getBoolean("timerlogic");
Log.e(LOGS, "Whatis the value of timerstart passed to timermagic" + timermagic); 
```

我不确定为什么 timermagics 变量的值为 false 而不是 true

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:09:26.827

您使用 设置布尔值[`Bundle#putBoolean(String,boolean)`](http://developer.android.com/reference/android/os/Bundle.html#putBoolean%28java.lang.String,%20boolean%29)，因此：

```
b.getBoolean("timerlogic", timerStart); 
```

应该：

```
b.putBoolean("timerlogic", timerStart); 
```

# java - Can i make some annotation required in classes that implements my interface?

> ID：10558352
> 
> 赞同：3
> 
> 时间：2012-05-11T20:41:28.370
> 
> 标签：java

I have this interface:

```
public interface IDbTable extends Serializable
{
    public int getId();
} 
```

I need to obligate all the classes that implements IDbTable, to have an annotation "@DatabaseTable" and at least one field inside class that have "@DatabaseField". The only way of implementing IDbTable needs to be like this:

```
@DatabaseTable(tableName = "Something")
public static class TestTable implements IDbTable
{
            @DatabaseField
            public int id;

    public int getId()
    {
        return id;
    }
} 
```

Is this possible with interface or inheritance? Today i have an unit test that scan all the classes and check this requirements. Is this a good practice?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:58:51.250

根据 Java 文档，您不能将注释应用于将由实现类继承的接口：http: [//docs.oracle.com/javase/6/docs/api/java/lang/annotation/Inherited.html](http://docs.oracle.com/javase/6/docs/api/java/lang/annotation/Inherited.html)

> 指示注释类型是自动继承的。如果注解类型声明中存在 Inherited 元注解，并且用户在类声明中查询注解类型，并且类声明没有该类型的注解，则将自动查询该类的超类以获取注解类型。将重复此过程，直到找到此类型的注释，或到达类层次结构（对象）的顶部。如果没有超类具有此类型的注释，则查询将指示所讨论的类没有此类注释。
> 
> 请注意，如果注释类型用于注释类以外的任何内容，则此元注释类型无效。另请注意，此元注释仅导致注释从超类继承；**已实现接口上的注释无效。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:53:36.380

为什么不使用注释处理来检查所需的注释在发送到您的框架时是否存在于您的类中，或者在构建/部署时。

# facebook - Share works as like?

> ID：10558353
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:28.967
> 
> 标签：facebook, share, facebook-like

I've notice that when I share some content from my app on my time line, counter of people who like this page (like button is placed on page that I share) increment by 1\. Of course it could be somebody wh like page while I'm sharing, butthere is not many users at testing phase under 10 visitors per day. tyr some times and it really looks loke share increment like counter. Does it true? Or may be I make some error and it works so now?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:52:01.930

喜欢按钮计数器由喜欢、分享和评论的总数组成。如果只想知道点赞数，需要使用FQL查询点赞表。

# python - Using an Access database (.mdb) with Python on Ubuntu

> ID：10558354
> 
> 赞同：7
> 
> 时间：2012-05-11T20:41:35.103
> 
> 标签：python, ms-access, ubuntu, pyodbc

I'm trying to use pyodbc to access a .mdb on Ubuntu. I've based my progress so far on this link

[Query crashes MS Access](https://stackoverflow.com/questions/3064830/query-crashes-ms-access)

I have installed pyodbc, unixodbc, and unixodbc-dev

My code looks like this:

```
import csv
import pyodbc

MDB = 'URY.mdb'
DRV ='Microsoft Access Driver (*.mdb)'
PWD = 'pass'

conn = pyodbc.connect('DRIVER=%s;DBQ=%s;PWD=%s' % (DRV,MDB,PWD))
curs = conn.cursor() 
```

When I run it, I receive this error message:

```
Traceback (most recent call last):
  File "mdbscraper.py", line 8, in <module>
    conn = pyodbc.connect('DRIVER=%s;DBQ=%s;PWD=%s' % (DRV,MDB,PWD))
pyodbc.Error: ('IM002', '[IM002] [unixODBC][Driver Manager]Data source name not found,         and no default driver specified (0) (SQLDriverConnect)') 
```

Does anyone have any ideas? Any help would be very much appreciated

Thank you!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-18T13:37:37.387

据我所知，此驱动程序“Microsoft Access Driver (*.mdb)”仅在 Microsoft 主机上可用，因为您使用的是 ubuntu，所以它无法工作。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-04T15:49:31.627

```
import pyodbc 
DBfile = '/data/MSAccess/Music_Library.mdb'
conn = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb)};DBQ='+DBfile)
cursor = conn.cursor()
SQL = 'SELECT Artist, AlbumName FROM RecordCollection ORDER BY Year;'

for row in cursor.execute(SQL): # cursors are iterable
print row.Artist, row.AlbumName

cursor.close()
conn.close() 
```

有The Official Example .. of use ...

# mysql - how to store data in arabic in MySQL database?

> ID：10558355
> 
> 赞同：0
> 
> 时间：2012-05-11T20:41:41.010
> 
> 标签：mysql, database, arabic

am using MySQL database, and i need to store data in Arabic into it, i have changed the collation to unicode so it works when am adding new fields through the PHPMyAdmin only, but when am adding data through my web site in to the same database it doesn`t works.

i need your help into this..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:53:30.067

检查您的网站是否使用相同的字符编码

# mysql - MySQL Week Function Unexpected Results

> ID：10558363
> 
> 赞同：0
> 
> 时间：2012-05-11T20:42:24.400
> 
> 标签：mysql

I am querying a database of hour entries and summing up by company and by week. I understand that MySQL's week function is based on a calendar week. That being said, I'm getting some unexpected grouping results. Perhaps you sharp-eyed folks can lend a hand:

```
SELECT * FROM (
    SELECT
        tms.date,
        SUM( IF( tms.skf_group = "HP Group", tms.hours, 0000.00 )) as HPHours,
        SUM( IF( tms.skf_group = "SKF Canada", tms.hours, 000.00 )) as SKFHours
    FROM time_management_system tms
    WHERE date >= "2012-01-01"
    AND date <= "2012-05-11" 
    AND tms.skf_group IN ( "HP Group", "SKF Canada" )
    GROUP BY WEEK( tms.date, 7 )
    # ORDER BY tms.date DESC
    # LIMIT 7
) AS T1
ORDER BY date ASC 
```

My results are as follows: (Occasionally we don't have entries on a Sunday for example. Do null values matter?)

```
('date'=>'2012-01-01','HPHours'=>'0.00','SKFHours'=>'2.50'),
('date'=>'2012-01-02','HPHours'=>'97.00','SKFHours'=>'78.75'),
('date'=>'2012-01-09','HPHours'=>'86.50','SKFHours'=>'100.00'),
('date'=>'2012-01-16','HPHours'=>'68.00','SKFHours'=>'96.25'),
('date'=>'2012-01-24','HPHours'=>'39.00','SKFHours'=>'99.50'),
('date'=>'2012-02-05','HPHours'=>'3.00','SKFHours'=>'93.00'),
('date'=>'2012-02-06','HPHours'=>'12.00','SKFHours'=>'122.50'),
('date'=>'2012-02-13','HPHours'=>'64.75','SKFHours'=>'117.50'),
('date'=>'2012-02-21','HPHours'=>'64.50','SKFHours'=>'93.00'),
('date'=>'2012-03-02','HPHours'=>'45.50','SKFHours'=>'143.25'),
('date'=>'2012-03-05','HPHours'=>'62.00','SKFHours'=>'136.75'),
('date'=>'2012-03-12','HPHours'=>'54.25','SKFHours'=>'133.00'),
('date'=>'2012-03-19','HPHours'=>'77.75','SKFHours'=>'130.75'),
('date'=>'2012-03-26','HPHours'=>'61.00','SKFHours'=>'147.00'),
('date'=>'2012-04-02','HPHours'=>'86.75','SKFHours'=>'96.75'),
('date'=>'2012-04-09','HPHours'=>'84.25','SKFHours'=>'120.50'),
('date'=>'2012-04-16','HPHours'=>'90.00','SKFHours'=>'127.25'),
('date'=>'2012-04-23','HPHours'=>'103.25','SKFHours'=>'89.50'),
('date'=>'2012-05-02','HPHours'=>'72.50','SKFHours'=>'143.75'),
('date'=>'2012-05-07','HPHours'=>'68.25','SKFHours'=>'119.00') 
```

January 2nd is the first Monday, hence Jan 1st is only one day. I would expect the output to be consecutive Mondays (Monday Jan 2, 9, 16, 23, 30, etc)? The unexpected week groupings below continue throughout the results. Any ideas?

Thanks very much!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:46:07.647

It's not clear what selecting `tms.date` even *means* when you're grouping by some function *on* `tms.date`. My guess is that it means "the `date` value from any source row corresponding to this group". At that point, the output is entirely reasonable.

Given that any given group can have seven dates within it, what date do you *want* to get in the results?

EDIT: This behaviour is actually documented in ["GROUP BY and HAVING with Hidden Columns"](http://dev.mysql.com/doc/refman/5.6/en/group-by-hidden-columns.html):

> MySQL extends the use of GROUP BY so that the select list can refer to nonaggregated columns not named in the GROUP BY clause.
> ...
> The server is free to choose any value from each group, so unless they are the same, the values chosen are indeterminate. Furthermore, the selection of values from each group cannot be influenced by adding an ORDER BY clause. Sorting of the result set occurs after values have been chosen, and ORDER BY does not affect which values the server chooses.

The `tms.date` column *isn't* part of the GROUP BY clause - only a function *operating on* `tms.date` is part of the GROUP BY clause, so I believe the text above applies to the way that you're selecting `tms.date`: you're getting *any date within that week*.

If you want the *earliest* date, you might try

```
SELECT MIN(tms.date), ... 
```

That's assuming that `MIN` works with date/time fields, of course. I can't easily tell from the documentation.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:49:57.350

问题对我来说不清楚，但我想你不想按周分组。因为一周给出一年中的一周。今天是第 19 周。

我认为您想按工作日分组，例如 GROUP BY WEEKday(tms.date)

# ios - Which directories does iOS apps have permission to write and read from?

> ID：10558365
> 
> 赞同：4
> 
> 时间：2012-05-11T20:42:34.723
> 
> 标签：ios, permissions, jailbreak

I know that the you have read permission to files in the `/var/mobile/Library/Preferences` directory, however you don't have read permission to some other directories located in `/var/mobile/Library/`.

Where can I find a list of the allowed paths to read and write from inside an app running as mobile user?

I don't care if it is allowed to access the directory, so it can be submitted to the app store, as it is for a jailbreak tweak I am making.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:29:10.537

复制自[http://iphonedevwiki.net/index.php/Seatbelt](http://iphonedevwiki.net/index.php/Seatbelt)部分“围绕沙箱工作”：

```
Anything in the container itself (of course).
~/* except the Media and Library subfolders, which only the following directories are readable:
~/Media/DCIM/*
~/Media/Photos/*
~/Library/AddressBook/*
~/Library/Keyboard/*
~/Library/Preferences/* 
```

`~`指哪里`/var/mobile`

# http - Express.js partial: Pressing 'back' in browser

> ID：10558371
> 
> 赞同：1
> 
> 时间：2012-05-11T20:43:22.690
> 
> 标签：http, node.js, backbone.js, xmlhttprequest, express

My tech stack: Node.js, express.js, backbone.js.

My web app is a two page app (you can hit two express routes to get fully rendered pages). Let's call them page A and page B. When I load page A and click on a link to load page B and then I press the back button, I only get a partially rendered page A (the part of the page that I can also deliver as an express.js partial with res.partial (not partial() within a template) via XHR).

From what I've debugged so far, pressing back in the browser doesn't hit an express route. When I inspect what Javascript is loaded there are no resources loaded. I was thinking I could do some debugging with the fronend routes (I'm using Backbone.js), but all I see is the partial HTML loaded on page A with no CSS styling and no JS resources.

Any direction on how to debug this issue?

# silverlight - MVVMLight v4.0.21.25721 SimpleIoc 注销和注册不起作用

> ID：10558373
> 
> 赞同：1
> 
> 时间：2012-05-11T20:43:27.067
> 
> 标签：silverlight, wcf-data-services, mvvm-light

我正在尝试重置我的 IDataService（它是我与 WCF 数据服务交互的包装器）并存储在 SimpleIoc.Default 中，以便我可以清空上下文以及它正在跟踪的实体。我不想使用从容器中删除所有内容的重置。我在启动时注册了我的 IDataService： `SimpleIoc.Default.Register<IDataService, DataService>();`

我正在尝试这个，但它没有像我预期的那样工作，我得到了这个异常：

```
{System.ArgumentException: An item with the same key has already been added.
   at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)
   at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)
   at GalaSoft.MvvmLight.Ioc.SimpleIoc.Register[TInterface,TClass](Boolean createInstanceImmediately)
   at GalaSoft.MvvmLight.Ioc.SimpleIoc.Register[TInterface,TClass]()
   at Bootstrap.ResetDataService()}

public static void ResetDataService()
{
    try
    {
        SimpleIoc.Default.Unregister<IDataService>();
        SimpleIoc.Default.Register<IDataService, DataService>();
    }
    catch (System.Exception)
    {
        throw;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T16:49:39.607

你是对的，这是一个错误。我将在下一个版本中修复它。

如果您需要有关您的特定项目的更多信息，请与我联系，我可以告诉您如何在源代码中修复它并构建您自己的版本。

干杯，劳伦特

# php - exp() returns NaN stuff

> ID：10558375
> 
> 赞同：2
> 
> 时间：2012-05-11T20:43:41.473
> 
> 标签：php, nan, exp

Ok, I'm stuck. I have this PHP code:

```
 echo exp(12), '<br/>';
    echo exp(4.2); 
```

just like on the PHP.net page. And what I have on the screen:

```
 NAN
    298.86740096706 
```

but then there comes the weirdest thing ever. I thought that maybe there's some PHP.ini problem with numbers like 2.67e8 and so (I mean with the 'e' inside) or something. But then, when I changed the above code into:

```
 echo (2.67e8), '<br/>';
    echo exp(4.2); 
```

suddenly I saw this whatever:

```
 267000000
    NAN 
```

It's kind of WTF especially because of the last NAN, when first it was a quite normal, calm float 298.86740096706 but then just with no reason it went to hell replaced by NAN. Do you have any ideas? Please?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:36:23.030

如果为真，这一定是您的 PHP 版本中的错误。请[报告](https://bugs.php.net/report.php)。

顺便说一句，我无法在 PHP 5.3.2 上重现它。跑步：

```
php -r 'do { $c = exp(4.2); echo "point "; } while (is_nan($c)); echo "$c\n";' 
```

产生预期的输出：

```
point 66.686331040925 
```

# python - .wav file doesn't play any sounds

> ID：10558377
> 
> 赞同：3
> 
> 时间：2012-05-11T20:43:57.110
> 
> 标签：python, audio, numpy, scipy, wav

I want to create a .wav file in Python using the numpy and scipy libraries, where multiple tones are played, the way I intend to do it is by storing my frequencies in an array and then the generated signals are stored in another one. I've managed to create such file with the desired playtime, but it doesn't play any sound. Am I missing something?

Thank you.

```
import numpy as np
from scipy.io import wavfile

freq =np.array([440,493,523,587,659,698,783,880]) #tone frequencies

fs=22050    #sample rate
duration=1 #signal duration
music=[]
t=np.arange(0,duration,1./fs) #time

for i in range(0,len(freq)):

    x=10000*np.cos(2*np.pi*freq[i]*t) #generated signals
    music=np.hstack((music,x))

wavfile.write('music.wav',fs,music) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T23:02:16.637

您用于创建波形文件的向量包含浮点数，但`scipy.io`将它们解释为 64 位整数（如[docs 中所述](http://www.scipy.org/doc/api_docs/SciPy.io.wavfile.html)），大多数播放器不支持。

将最后一行更改为

```
wavfile.write('music.wav',fs,music.astype(np.dtype('i2'))) 
```

应该会生成一个可以正常播放的文件。

# regex - Regex to add missing space after comma before argument in functions (to meet coding guidelines)

> ID：10558379
> 
> 赞同：0
> 
> 时间：2012-05-11T20:44:01.680
> 
> 标签：regex

there is an open source php project i would like to contribute by reducing some coding guidline violations. as there are about 5000 violations for a specific sniff i guess it would be appropriate to use some regex.

the coding guidline rule is called "FunctionCallArgumentSpacingNoSpaceAfterComma". this means that all arguemts should be separated by a comma followed by a space.

these example snippets violate this rule:

```
$this->message('About', 'Warning, very important!', $this->securityRisk().$this->alterPasswordForm(),2);
$sFiles = t3lib_div::getFilesInDir(PATH_typo3conf,'sql',1,1);
if (!strstr(implode(',',$sFiles).',', '/database.sql,')) { 
```

can anybody help in creating a useful regex to fix these coding guidline violations? i tried some hours but i am unfortunately not capable to solve this on my own.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:51:42.130

我会尝试的第一件事是这样的：

```
sed 's/,\([^ ]\)/, \1/g' someFile.php 
```

将逗号后跟非空格的逗号替换为逗号、空格和逗号后的*字符*。

在考虑了片刻之后，这可能有点工作。

但一定有很多我没有想到的事情......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:06:15.380

您不能使用正则表达式安全/可靠地执行此操作。在某些语言中，您甚至无法可靠地跳过过去的字符串文字（考虑 Perl 的`q`语法；尤其是它如何处理它认为是“括号”字符的内容）。即使忽略这些，如果代码库中有多种语言（例如 PHP、Java 和 Perl 中的字符串/字符文字之间存在细微差异），您也会遇到麻烦。

# python - python相当于perl的LWP和HTTP::Parse

> ID：10558381
> 
> 赞同：0
> 
> 时间：2012-05-11T20:44:33.910
> 
> 标签：python

我是 python 新手，我需要知道是否有 perl 的 LWP 和 HTTP::Parse。我有一个 perl 脚本来从 URL 获取内容并解析它，我想将它移植到 python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:07:23.003

查看获取部分的 Python 模块 httplib 和 urllib。Python中有几个用于解析的xml模块。您还可以查看不属于标准 Python 模块的 BeautifulSoup。

# algorithm - How to make sense of Phase 2 in Paxos distributed consensus algorithm?

> ID：10558382
> 
> 赞同：1
> 
> 时间：2012-05-11T20:44:35.917
> 
> 标签：algorithm, distributed-computing, paxos, consensus

I have pasted pseudocode for a paxos algorithm here:

[What is a "view" in the Paxos consensus algorithm?](https://stackoverflow.com/questions/10490902/what-is-a-view-in-the-paxos-consensus-algorithm)

and was wondering if someone could point me in the right direction.

The algorithm says that each node has a "state" which contains a bunch of information the node should keep track of.

Suppose we have two nodes: Node #1 and Node #2\. In the simplest case Node #2 joins Node #1 and they both play paxos. What exactly happens to the states of Node #1 and Node #2 after 2 joins 1? When does the "views" data structure change and what does it contain? If someone can explain to me this simple case of two nodes playing paxos, then I think I can figure out multiple node case.

My current understanding (which I'm pretty sure is not correct) is as follows:

1.  Node #2 sends a message to join Node #1.
2.  Node #1 receives message from Node #2 asking to join.
3.  Node #1 assumes leadership and kicks into phase 1, computes my_num = max(0,0) + 1 = 1
4.  Node #1 sends all nodes in views[0] (which is empty) prepare(1,1)
5.  Node #1 sends initial contact node (Node #2) prepare(1,1)
6.  Node #1 sends Node #1 (itself) prepare(1,1)
7.  Node #2 receives prepare(1,1). It sets its num_h=1 and returns to leader PROMISE(0,{empty list})
8.  Node #1 receives prepare(1,1) and sets its num_h=1 and returns itself PROMISE(0,{empty list}).

now we get to phase 2

This is where I am quite confused.

Node #1 is the leader and it receives two PROMISE(0,{empty list}) messages. According to the algorithm, if the leader gets a majority of promises in views[0] then it can set a value for "v" and send the ACCEPT message to all responders.

What I am confused about is currently the views[0] for the leader is empty so how can you compute the majority of an empty list?

Also, let's assume the leader has received a majority of promises and proceeds to set v = set of pingable nodes (including self). What exactly are pingable nodes? Is it just Node #1 and Node #2?

Would appreciate all / any help and will definitely award points to those that help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T14:07:48.283

伪代码不是专门针对特定问题的。事实上，教授说如果我们不想使用伪代码，我们不需要使用伪代码，并表示我们可以查看其他 Paxos 论文（即 paxos made simple、paxos made live 等）以获得有关实现此算法的指导. 也许你是对的，我应该看看维基百科来实现这个算法。因此，views[..] 只是一个哈希映射，节点可以选择它想要的任何值。如果我理解正确，您说多数声明只是检查它是否收到“足够”的 PROMISE 消息。但是知道我们是否有足够的唯一方法是节点是否跟踪它的组成员是谁。这意味着我需要一个不同的数据结构。

另外，因为你发表了评论，我不能给你积分。如果您发布答案，那么我可以给您积分。

# build - Creating a nightly build in Hudson depending on another build result

> ID：10558383
> 
> 赞同：0
> 
> 时间：2012-05-11T20:44:41.993
> 
> 标签：build, dependencies, hudson, delay

I am searching for a way to create a job in hudson that is a copy of another job, but deploys the installation on another machine (no problem until here). I need the second hudson build (= development environment) to start only in the night (no problem also) and ONLY if the first build (= check environment) is running properly.

The first build will be triggered by SVN checkins and due to a lot of checkins this build is started several times during the day. The second build must not start during our office time, because this would derail our development. At night this development environment should be reinstalled, if the last build of the check environment worked properly.

Does anyone have an idea how to solve this issue? At the moment I have to check the check environment and reinstall our development environment manually, if the check environment has no errors.

Thanks in advance.

# python - Sum of given series

> ID：10558385
> 
> 赞同：4
> 
> 时间：2012-05-11T20:44:44.597
> 
> 标签：python

I am trying to find the sum for series : `1 − 1 / 2 + 1 / 3 − 1 / 4 + · · · + 1 / 99 − 1 / 100 ** 2` with python.

My code is -

```
psum = 0
nsum = 0
for k in range(1,100):
    if k%2 == 0:
        nsum += 1.0/k
    else:
        psum += 1.0/k

print psum - nsum - 1.0/100**2 
```

The output is 0.69807217931

I don't have the answer and just want to verify if I am doing it right.

**This is not a homework question but just random Python practice.**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T20:50:46.357

这很好用，但为什么不只使用一个“求和”变量（调用它`total`，作为一种良好的做法，因为有一个内置的调用`sum`，你真的不想隐藏），并实际添加或减去它在每一步？

或者（双关语！），实际**使用**该`sum`功能。该`range`功能也可用于跳过每隔一个数字。

```
>>> sum(1.0/k for k in range(1, 100, 2)) - sum(1.0/k for k in range(2, 100, 2)) - (1.0/100**2)
0.6980721793101952 
```

或者，正如 steveha 所示，您可以使用逻辑来根据数字是否可被 2 整除来确定是加还是减，并使用“加权”总和（酌情加 1.0/k 或 -1.0/k）来处理它. 这就是为什么您应该作为程序员学习更多数学的原因:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T20:59:44.730

嗯，我相信

```
import math
print math.log(2) 
```

会成功的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T20:50:00.500

```
sum(1.0/k if k % 2 else -1.0/k for k in xrange(1, 100)) - 1.0/100**2 
```

上面的代码与您的代码执行相同的操作，并得到相同的答案。

为什么系列使用 1/k 从 1 到 99，然后使用 1/k**2 只为 k == 100？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T20:52:10.217

看看你是否做对了，最简单的方法是用一个更短的系列来尝试，你可以手动检查。例如，使用 range(1, 5) 并查看它是否给出了您期望的答案。

对于样式提示，您可以使用 xrange 代替 range。xrange 很好，因为它只是根据需要返回每个数字，而 range 创建所有数字的大列表。如果对 range(1, 1000000) 执行此操作，则会占用大量内存，而 xrange 不会。

我认为，您也可以只使用一个变量而不是两个变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:17:36.407

这是我的建议。LOC 比@steveha 少，但更通用。

```
getx=lambda x:(1.0/x)*((-1)**((x%2)+1))
num=100
sum((getx(x) for x in xrange(1,num)))+getx(num)**2
0.688172179310195 
```

# asp.net - How to convert MVC empty project to Web API?

> ID：10558386
> 
> 赞同：5
> 
> 时间：2012-05-11T20:44:52.240
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2010, rest, asp.net-web-api

I created a an "Empty" for MVC 4\. After coding some things out, I realized that an "Web API" project is better. I do not want to start over so is there a way to convert it to a Web API project instead? Below is a screenshot of what I am referring to. Any help would be greatly appreciated.

![enter image description here](../Images/eef1dac5485c9c4641013b657aa25a37.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-12T01:07:09.810

您可以将 Web API 控制器添加到 MVC 项目。在解决方案资源管理器中，右键单击控制器文件夹，选择添加控制器，然后选择 Web API 控制器。

您唯一需要的另一件事是路由 - 我相信“空” MVC 4 项目默认情况下已经包含 Web API 路由，所以您应该没问题。寻找类似的东西：

```
 routes.MapHttpRoute(
      name: "DefaultApi",
      routeTemplate: "api/{controller}/{id}",
      defaults: new { id = RouteParameter.Optional }
  ); 
```

但是，如果您想将现有的 MVC*控制器*转换为 Web API 控制器，则没有自动的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T01:27:10.407

如果您真的想迁移到 Web API 项目，最简单的方法就是创建一个新的空白 Web API 项目。然后，复制旧项目中的所有文件，删除旧项目并重命名新项目。

另一个可能需要更多努力的选项是创建一个新的空白 Web API 项目。然后，在文本编辑器中打开项目文件并与旧项目文件进行比较，并对原始文件进行必要的更改。这一切都在 XML 中，所以它不应该那么难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:37:10.263

仅当您想公开数据时，Web API 才会*更好。*如果您需要呈现视图（Razor 或 Web 窗体），请使用 ASP.NET MVC。

没有自动转换，因为它们做不同的事情。

# css - How can I display a CSS linear gradient in Netscape?

> ID：10558388
> 
> 赞同：-3
> 
> 时间：2012-05-11T20:45:15.430
> 
> 标签：css, linear-gradients, netscape

How do I use a CSS linear gradient with Netscape?

I am trying this code:

```
#gr {
    background: -webkit-gradient(linear, left top, left bottom, from(#ffffff), to(#000));
    background: -moz-linear-gradient(top,  #ffffff,  #000);
    filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#000');
    -ms-filter:  progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#000'); 
} 
```

It works with IE, Firefox, and Chrome but it does not work with Netscape.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T22:00:52.393

Netscape Navigator 9，最后一次更新是在 2006 年和 2008 年之间作为 Firefox 的衍生版本，除了 CSS2.1 规范的大部分子集之外，不提供对 CSS 的任何真正支持。它不支持 CSS3 渐变或大多数其他 CSS3 功能。

Netscape Navigator/Communicator 4.x 和更早的版本根本没有很多 CSS 支持。

如果您真的需要渐变，最好使用背景图像。这是过去 10 年来设计人员一直在使用的传统的、久经考验的方法，具有很好的跨浏览器兼容性，但摩擦很小。

如果您只是因为您是 Netscape 用户而试图支持 Netscape，请停止浪费您的时间。切换到火狐。在这个时代，没有严肃的网页设计师使用 Netscape。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:52:51.707

Netscape 不再受支持，而且很少有人使用。

但如果您仍想在您的网站上使用线性渐变，您可以使用 Photoshop 或任何其他图形编辑器创建图像，然后将其用作：

```
background-image: url('url-of-img.jpg'); 
```

# html - Wrapping between nowraps

> ID：10558391
> 
> 赞同：1
> 
> 时间：2012-05-11T20:45:18.613
> 
> 标签：html, css, word-wrap

I have a list of links that should be displayed inline. The thing is I do not want the text to wrap in the middle of links. If it needs to wrap, it should only do so ***between*** links.

I have therefore added the `white-space:nowrap;` property to my link. But the resulting list of links ***never*** wraps and gets out of my `div` box.

Any idea how I can get my list to wrap between the links? Thank you!

```
<div class="box">
<p>
<a href="mylink1" class="mytag">Hello there</a>
<a href="mylink2" class="mytag">Hello you</a>
<a href="mylink3" class="mytag">Hello people</a>
<a href="mylink4" class="mytag">Hello world</a>
</p>
</div> 
```

The relevant CSS is just:

```
.mytag,.mytag:link,.mytag:visited{
  background-color:#FFF5CA;
  border:1px solid #FFE5B5;
  color:#222;
  padding:2px 5px;
  margin-right:5px;
  white-space:nowrap;
}
.mytag:hover{
  background-color:#FFE5B5;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:53:48.020

基本上，`white-space:nowrap;`正在做它应该做的事情，而不是将元素分成多行。

您实际上正在寻找的是在单行上显示链接，而不会将链接换行到下一行。因此，使用`display`属性 as `inline-block`。

```
.mytag,.mytag:link,.mytag:visited{
  background-color:#FFF5CA;
  border:1px solid #FFE5B5;
  color:#222;
  padding:2px 5px;
  margin-right:5px;
  display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:47:29.290

There isn't anything mysterious here - they should automatically wrap between links if your container has a specific widhth: [http://jsfiddle.net/RZfd2/](http://jsfiddle.net/RZfd2/)

# maven - Maven Mojo: escape characters in default-value of properties

> ID：10558392
> 
> 赞同：0
> 
> 时间：2012-05-11T20:45:19.987
> 
> 标签：maven, maven-plugin

The default-value of a Mojo property starts with:

```
${user.home} 
```

I will write the value to a properties file and it should then be replaced at runtime not at build time.

I tried:

```
default-value="${user.home}/..."
default-value="\${user.home}/..."
default-value="\\${user.home}/..." 
```

but it always gets replaced with the user.home of the user running the build.

Is there a way to avoid the replacement?

Edit:

The code in question is in a custom Maven Mojo:

```
public class MyCustomMojo extends AbstractMojo {

    ...

    /**
     * @parameter expression="${some-expression}" default-value="\\${user.home}/some-path"
     * @required
     */
    private String userdir;

    ...

    @Override
    public void execute() throws MojoExecutionException, MojoFailureException {

        ...

        Properties configProperties = new Properties();
        configProperties.setProperty(Main.USER_DIR_PROPERTY, userdir);
        Path propertiesFilePath = confPath.resolve(propertiesFileName);
        try (BufferedOutputStream bos = new BufferedOutputStream(Files.newOutputStream(propertiesFilePath))) {
            properties.store(bos, "");
        }

        ...

    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-12T02:22:14.267

在明确您正在谈论创建插件之后......关键是[默认值](http://maven.apache.org/developers/mojo-api-specification.html)旨在在mojo的构建执行期间被替换。我不确定你想达到什么目标，但我认为你在表达上误会了它。此外，默认值的想法是它将被替换，包括。系统属性。也许您可以提供补充信息以查看您想要实现的目标。

# c++ - 防止在其工厂方法之外实例化对象

> ID：10558393
> 
> 赞同：5
> 
> 时间：2012-05-11T20:45:21.173
> 
> 标签：c++, oop, factory-pattern

假设我有一个带有工厂方法的类

```
class A {
public:
  static A* newA()
  {
    // Some code, logging, ...
    return new A();
  }
} 
```

是否可以使用 防止此类对象的实例化`new`，因此工厂方法是创建对象实例的唯一方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T20:46:52.623

当然; 只需将构造函数设为私有（如果这是基类则受保护）：

```
class A {
public:
  static A* newA()
  {
    // Some code, logging, ...
    return new A();
  }

private:
  A() {}  // Default constructor
}; 
```

如果需要，您还应该将复制构造函数设为私有/受保护。

和往常一样，您应该强烈考虑返回智能指针而不是原始指针，以简化内存管理问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:58:44.637

您可能还希望将复制构造函数设为私有，或者使用新的 C++11 语法，您可以显式告诉编译器不要复制它，并将默认构造函数设为私有，如下所示：

```
struct NonCopyable {
    NonCopyable & operator=(const NonCopyable&) = delete;
    NonCopyable(const NonCopyable&) = delete;
    NonCopyable() = default;
};

class A : NonCopyable {
public:
  static std::shared_ptr<A> newA()
  {
    // Some code, logging, ...
    return std::make_shared<A>();
  }

private:
  A() {}  // Default constructor
}; 
```

C++03 的方式通常是这样的：

```
class A {
public:
  static A* newA()
  {
    // Some code, logging, ...
    return new A();
  }

private:
  A() {}                        // no outsider default constructor
  A(const A& rhs);              // no copy
  A& operator=(const A& rhs);   // no assignment
};

int main()
{
    A x;        // C2248
    A y(x);     // C2248
    x = y;      // C2248
    A* p = A::newA(); // OK
    std::cin.get();
    return 0;
} 
```

# asp.net - 如何验证gridview中的下拉列表控件

> ID：10558395
> 
> 赞同：2
> 
> 时间：2012-05-11T20:45:46.990
> 
> 标签：asp.net

编辑：

```
var dropDownControls = $('#<%=GridView1.ClientID %> select option:selected');
var checkbox = $.......checkbox ..... 
  for(index = 0; index < dropDownControls.length; index++)
  {
      if (checkbox.checked) //my code gets exaclty what checkbox i checked
      {
      if(dropDownControls[index].selectedIndex == 0)
      {
          flag = false;
          break;
      }
      }
  } 
```

上面的代码有效

我在gridivew 外面有我的按钮，我正在尝试验证gridivew 内部的下拉列表。

```
<asp:Button ID="btn" runat="server" Text="Submit" OnClick="btn_Click"  CausesValidation="true"/>

<asp:GridView ID="GVInputMapping" runat="server" AutoGenerateColumns="False" DataKeyNames="Id"
                             EnableModelValidation="True" onrowdatabound="GVInputMapping_RowDataBound">
<Columns>
<asp:BoundField DataField="Name" ControlStyle-Width="250px" HeaderText="Name" SortExpression="Name" />
<asp:TemplateField>
<ItemTemplate>
<asp:CheckBox id="checkbox1" runat="server"/>
<asp:DropDownList runat="server" ID="ddldetail">
<asp:ListItem Selected="True" Value="0">Select me</asp:ListItem>
<asp:ListItem Value="1">abc</asp:ListItem>
<asp:ListItem Value="2">GHt</asp:ListItem>
</asp:DropDownList>
<asp:RequiredFieldValidator ID="requiredDDL" runat="server" 
              ControlToValidate="ddldetail" ErrorMessage="Please select" InitialValue="Select me"  Display="Dynamic"></asp:RequiredFieldValidator>
</ItemTemplate>
</asp:TemplateField>
</Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:48:54.923

将`RequiredFieldValidator`'s设置[`InitialValue`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator.initialvalue.aspx)为**0**而不是*“选择我”*，因为默认选择的项目的值为 0

```
<asp:ListItem Selected="True" Value="0">Select me</asp:ListItem> 
```

除此之外，它应该可以正常工作。

**编辑**：您的评论显示您使用 jQuery 来启用修复`DropDownList`选择的 CheckBox。用户现在应该已经选择了一些东西。所以你的要求实际上是验证器不应该处于活动状态。所以最初禁用所有验证器（`Enabled="false"`）。

由于您正在处理客户端上的复选框，因此我建议在选中验证器时启用它，并在未选中时禁用它。您可以使用 (Mini-) [Validation-Client-Side API](http://msdn.microsoft.com/en-us/library/aa479045.aspx#aspplusvalid_clientside)，尤其是该`ValidatorEnable(val, enable)`功能。您只需要对验证器的引用。但这对你来说应该不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:39:12.407

```
credit goes to ahaliav fox

http://stackoverflow.com/questions/10566599/how-to-control-asp-net-validator-controls-client-side-validation

 gridview:

    <asp:GridView ID="gv" runat="server" AutoGenerateColumns="False" DataKeyNames="Id"  OnRowDataBound="gv_RowDataBound">
            <Columns>
                <asp:BoundField DataField="ID" ControlStyle-Width="250px" HeaderText="ID" SortExpression="ID" />
                <asp:BoundField DataField="FirstName" ControlStyle-Width="250px" HeaderText="FirstName"
                    SortExpression="FirstName" />
                <asp:BoundField DataField="LastName" ControlStyle-Width="250px" HeaderText="LastName"
                    SortExpression="LastName" />
                <asp:TemplateField>
                    <ItemTemplate>
                        <asp:CheckBox ID="checkbox1" runat="server" />
                        <asp:DropDownList ID="drpPaymentMethod" runat="server">
                                    <asp:ListItem Value="-1">----</asp:ListItem>
                                    <asp:ListItem Value="0">Month</asp:ListItem>
                                    <asp:ListItem Value="1">At End</asp:ListItem>
                                    <asp:ListItem Value="2">At Travel</asp:ListItem>
                                </asp:DropDownList>
                        <asp:RequiredFieldValidator ID="rfv" InitialValue="-1" ControlToValidate="drpPaymentMethod" Enabled="false" Display="Static" runat="server" ErrorMessage="RequiredFieldValidator"></asp:RequiredFieldValidator>

                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Value">
                    <ItemTemplate>
                        <asp:TextBox ID="txt_Value" runat="server" Width="58px" Text="0"></asp:TextBox>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>

CS:

    protected void gv_RowDataBound(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                CheckBox checkbox1 = e.Row.FindControl("checkbox1") as CheckBox;
                RequiredFieldValidator rfv = e.Row.FindControl("rfv") as RequiredFieldValidator;
                DropDownList drpPaymentMethod = (DropDownList)e.Row.FindControl("drpPaymentMethod");
                // you can just pass "this" instead of "myDiv.ClientID" and get the ID from the DOM element
                checkbox1.Attributes.Add("onclick", "UpdateValidator('" + checkbox1.ClientID + "','" + drpPaymentMethod.ClientID + "','" + rfv.ClientID + "');");
                if (!checkbox1.Checked)
                    drpPaymentMethod.Attributes.Add("disabled", "disabled");
            }
        }

javascript:

    function UpdateValidator(chkID, drpID, validatorid) {
            //enabling the validator only if the checkbox is checked
            var enableValidator = $("#" + chkID).is(":checked");

            if (enableValidator)
                $('#' + drpID).removeAttr('disabled');
            else
                $('#' + drpID).attr('disabled', 'disabled');

            var vv = $('#' + validatorid).val();

            ValidatorEnable(document.getElementById(validatorid), enableValidator);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:48:47.077

我认为最好的方法是使用 customValidator 并使用客户端脚本进行验证。然后使用验证摘要来显示错误或需求

# asp.net-mvc-3 - MVC3 Controller not recongnising base controller with Ninject dependency

> ID：10558400
> 
> 赞同：2
> 
> 时间：2012-05-11T20:46:35.977
> 
> 标签：asp.net-mvc-3, ninject, nlog, petapoco

I've hooked up Ninject (correctly) to bind NLog. Here is my RegisterService method in my NinjectMVC3.cs

```
kernel.Bind<ILogger>().To<NLogger>(); 
```

I'm trying to port over to PetaPoco and have created a base controller here:

```
public class BaseController : Controller
{
    protected PetaPoco.Database _database;
    protected ILogger _logger;
    protected MemberRepository _members;

    public BaseController(ILogger logger)
    {
        _database = new PetaPoco.Database("TalentSiteConnection");
        _members = new MemberRepository(_database);
        _logger = logger;
    }
} 
```

When I inherit my base controller like so:

```
public class TestController : BaseController
{        
    public ActionResult Index()
    {
        TestViewModel model = new TestViewModel();
        model.Member = _members.Single<Member>(2579);
        return View("Index", model);
    }

} 
```

and try to run a build I'm getting a

> 'BaseController' does not contain a constructor that takes 0 arguments

What am I doing wrong? I thought Ninject would resolve the dependency on the constructor?

.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:49:36.633

TestController 需要那个 ctor...

```
public class TestController : BaseController
{
    public TestController(ILogger logger) : base(logger) {} 
```

...这与 NInject 无关。如果您向 BaseController 添加了无参数 ctor 并保持 TestController 原样，您将不会获得记录器注入。

# facebook-graph-api - 从 facebook 获取 lat 和 lon

> ID：10558403
> 
> 赞同：2
> 
> 时间：2012-05-11T20:46:49.267
> 
> 标签：facebook-graph-api, facebook-fql, facebook-opengraph

是否可以根据其 id 获取 facebook 位置的纬度和经度？当我为我的 fb 帐户获取用户对象时，在 JSON 中很清楚

```
["location":{"id":"106423786059675","name":"Buenos Aires, Argentina"}]. 
```

好吧，如果我可以查询位置 id 106423786059675 的纬度和经度，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T02:38:34.510

您是否尝试检查 API 以获取该页面的详细信息？

[http://graph.facebook.com/106423786059675](http://graph.facebook.com/106423786059675)

即使不需要访问令牌，也会返回大量信息，包括：

> “位置”：{ “纬度”：-34.6033，“经度”：-58.3817 }，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-09T20:14:36.940

如果你使用 php，你可以这样做：

```
$fb_location_id = 'LOCATION_ID';
$jsonurl        = 'http://graph.facebook.com/'.$fb_location_id;
$json           = file_get_contents($jsonurl,0,null,null);
$json_output    = json_decode($json);
// the latitude
$fb_latitude    = $json_output->location->latitude;
// the longitude
$fb_longitude   = $json_output->location->longitude; 
```

# python - 为什么这个函数从数据库返回 None ？

> ID：10558405
> 
> 赞同：1
> 
> 时间：2012-05-11T20:46:55.110
> 
> 标签：python, sqlalchemy

我有以下功能：

```
def get_some_field(grouping_type_id):
    checkConnection() # establishes connection if none

    sql = "SELECT name FROM table_foo WHERE id=%d" % grouping_type_id
    results = conn.execute(sql)
    data = results.fetchone()
    return str(data['name']) if ((data) and ('name' in data)) else '' 
```

如果数据库表为空，我希望该函数返回一个空字符串，但是，`None`它会被返回。

谁能解释这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:52:25.387

这也返回`'None'`：

```
data = {'name': None}
result = str(data['name']) if ((data) and ('name' in data)) else '' 
```

问题是这`(data) and ('name' in data)`是真的，因为`data`它不是空的，并且有`'name'`键集（虽然设置为`None`，但你不检查它）。

更改此行：

```
return str(data['name']) if ((data) and ('name' in data)) else '' 
```

进入这一行：

```
return str(data.get('name') or '') if data else '' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T20:52:33.777

我会假设，因为这是记录在案的 sqlalchemy 行为。 [来自文档：（](http://docs.sqlalchemy.org/en/rel_0_6/core/connections.html?highlight=fetchone#sqlalchemy.engine.base.ResultProxy.fetchone)强调我的）

> 获取一个（）
> 
> 获取一行，就像 DB-API cursor.fetchone()。
> 
> 如果存在一行，则在调用它后游标保持打开状态。否则光标自动关闭**并返回 None**

.

# wcf - WCF Client Performance

> ID：10558407
> 
> 赞同：1
> 
> 时间：2012-05-11T20:47:01.653
> 
> 标签：wcf

I used WCF to call a Java based web service and constantly get 1.4 second or 1.5 second response time. I used exactly same SOAP request in SoapUI to call the same web service and constantly get 0.9 second to 1 second response time.

Both requests are initiated from my local computer, both requets hit same target.

It is very hard for me to believe it will take 0.5 second to serialize and deserialize, but other than this what else can impact the performance?

**Update 1 - included sample code**

```
 Stopwatch sw = new Stopwatch();

        //Trust all certificates, non-production uses self-signed certificate
        System.Net.ServicePointManager.ServerCertificateValidationCallback = ((sender, certificate, chain, sslPolicyErrors) => true);

        MyServiceClient.MyService.Spml2ServicePortTypeClient client = new MyServiceClient.MyService.Spml2ServicePortTypeClient();

        client.ClientCredentials.UserName.UserName = "username";
        client.ClientCredentials.UserName.Password = "password";

        for (int i = 0; i < 5; i++)
        {
            MyServiceClient.MyService.SuggestUserIDRequestType webRequest = new MyServiceClient.MyService.SuggestUserIDRequestType();
            webRequest.requestID = "MyId";
            webRequest.givenName = "Hardy";
            webRequest.sn = "Wang";
            webRequest.uid = "some value";

            sw.Start();
            MyServiceClient.MyService.SuggestUserIDResponseType response = client.suggestUserID(webRequest);
            sw.Stop();

            Console.WriteLine("Elapsed time {0} ms.", sw.ElapsedMilliseconds);
            sw.Reset();

        } 
```

# jboss - JBoss 7 中所有 JNDI 名称的含义

> ID：10558411
> 
> 赞同：6
> 
> 时间：2012-05-11T20:47:22.420
> 
> 标签：jboss, jndi, jboss7.x

我正在 JBoss 7.1.1 上部署一个 Java EE 应用程序，当我的会话 bean 被部署时，JBoss 打印出一条消息，说它已经创建了多个 JNDI 绑定。像这样的东西：

```
java:global/ear-name/jar-name/MyClassImpl!fully.qualified.path.to.Interface
java:app/jar-name/MyClassImpl!fully.qualified.path.to.Interface
java:module/MyClassImpl!fully.qualified.path.to.Interface
java:jboss/exported/ear-name/jar-name/MyClassImpl!fully.qualified.path.to.Interface
java:global/ear-name/jar-name/MyClassImpl
java:app/jar-name/MyClassImpl
java:module/MyClassImpl 
```

它从 EJB 到 EJB 略有不同，但这是一般的想法。

我对这里发生的事情感到困惑。为什么有这么多？这些 JNDI 绑定之间有区别吗？如果有，应该在什么时候使用它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T23:46:05.027

您可以在此处找到所有文档 [1]，但简而言之，其中一些是由规范决定的，有些是 JBoss 特有的功能（主要是 java:jboss/exported、java:jboss 条目）

[1] [https://docs.jboss.org/author/display/AS71/JNDI%20Reference.html](https://docs.jboss.org/author/display/AS71/JNDI%20Reference.html)

# php - 使用 PHP/MYSQL Web 服务 (WSDL) 的 ASP.NET/C# 客户端

> ID：10558414
> 
> 赞同：6
> 
> 时间：2012-05-11T20:47:46.763
> 
> 标签：php, asp.net, mysql, soap, wsdl

我正在尝试访问网络服务（以下两个文件）。客户端将 ASP.NET/C# 用于其 Web 体系结构。我可以添加 Web 引用，但不知何故我无法为 wsdl 文件生成代理类。目的是使用 server.php 文件中的函数，以便我可以使用 xmlstring 在 ASP.NET 网站上显示数据。任何帮助将不胜感激。非常感谢

* * *

server.php 文件。该文件有一个 php 函数，该函数从 mysql 数据库中提取数据，该函数将数据作为 XML 字符串返回。

```
<?php
//WEB SERVICE FUNCTION TO EXTRACT DATA FROM CLIENT B INTO XML FORMAT
function getXML()
{
//CONNECT TO THE DATABASE SERVER
$dbserverIP = "xxxxxxx";
$dbusername = "xxxxxxx";
$dbpassword = "xxxxxxx";
$dbconnection = mysql_connect($dbserverIP,$dbusername,$dbpassword)  
or die ("The connection to the database server failed.");

//CONNECT TO THE DATABASE
$dbname = "xxxxxxxx";
$dbselectok = mysql_select_db($dbname,$dbconnection)
or die ("The connection to the database failed.");

//QUERY THE DATABASE
$sqlquery = "SELECT * FROM videogames";
$sqlresult = mysql_query($sqlquery,$dbconnection)
or die ("Error in executing the SQL statement");

//CREATE XML STRING
$xmlstring = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n";
$xmlstring.= "<videogames>";

while ($row = mysql_fetch_array($sqlresult))
{
    $xmlstring .= "\t<game>\r\n";
        $xmlstring .= "\t\t<gametitle>" .$row["gametitle"]. "</gametitle>\r\n";
        $xmlstring .= "\t\t<genre>" .$row["genre"]. "</genre>\r\n";
        $xmlstring .= "\t\t<year>" .$row["year"]. "</year>\r\n";
        $xmlstring .= "\t\t<platform>" .$row["platform"]. "</platform>\r\n";
        $xmlstring .= "\t\t<agerating>" .$row["agerating"]. "</agerating>\r\n";
        $xmlstring .= "\t\t<price>" .$row["price"]. "</price>\r\n";
    $xmlstring .= "\t</game>\r\n";
}

$xmlstring.= "</videogames>";

//WRITE XML STRING TO EXTERNAL FILE
$filename = "videogames.xml";
$fileaccessmode = "w";
$fptr = fopen($filename,$fileaccessmode);
fwrite($fptr,$xmlstring);
fclose($fptr);

//FREE UP MEMORY
mysql_free_result($sqlresult);
mysql_close($dbconnection);

return $xmlstring;

}

//CODE TO DISABLE THE WSDLE CACHE
ini_set("soap.wsdl_cache_enabled","0");

//DEFINE SOAP SERVER INSTANCE AND RELATED WSDL FILE
//THE service.wsdl FILE IS IN THE SAME FOLDER AS THIS server.php FILE
$server = new SoapServer("service.wsdl");

//ADD FUNCTION TO THE SERVER INSTANCE
$server->addFunction("getXML");

//ACTIVATE THE SOAP HANDLER
$server->handle();

?> 
```

这是链接到 server.php 文件的 WSDL 文件。

```
<?xml version ='1.0' encoding ='UTF-8' ?>

<!-- ====================== DEFINITIONS ====================== -->

<definitions name="MyWebService"
     targetNamespace="http://cet-apache-04.cet.bolton.ac.uk/student/mib1bee/CST3017/assignment/scenario1/service.wsdl"
     xmlns="http://schemas.xmlsoap.org/wsdl/"
     xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
     xmlns:tns="http://cet-apache-04.cet.bolton.ac.uk/student/mib1bee/CST3017/assignment/scenario1/service.wsdl"
     xmlns:xsd="http://www.w3.org/2001/XMLSchema">

<!-- ====================== TYPES ============================ -->
<!-- No need for type definitions as only xsd built-in ======= --> 
<!-- data types are used                                       -->
<!-- ========================================================= -->

<!-- ====================== MESSAGE ========================== -->

<message name="getXML_Request">
<part name="input" />
</message>

<message name="getXML_Response">
<part name="xmlString" type="xsd:string"/>
</message>

<!-- ====================== PORT TYPE ============================ -->

<portType name="myWebService_PortType">

<operation name="getXML">
   <input  message="tns:getXML_Request"/>
   <output message="tns:getXML_Response"/>
</operation>

</portType>

<!-- ======================= BINDING ============================= -->

<binding name="myWebService_Binding" type="tns:myWebService_PortType">
<soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>

<operation name="getXML">
   <input>
     <soap:body use="literal"/>
   </input>
   <output>
     <soap:body use="literal"/>
   </output>
</operation>

</binding>

<!-- ======================= SERVICE ============================= -->

<service name="myWebService_Service">
<port name="myWebService_Port" binding="tns:myWebService_Binding">
    <soap:address location="http://cet-apache-04.cet.bolton.ac.uk/student/mib1bee/CST3017/assignment/scenario1/server.php"/>
</port>
</service>

</definitions> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:35:15.950

您只需阅读本文，您就会清楚地了解您的答案

转到以下链接：

[php web服务到点网](http://sanity-free.org/125/php_webservices_and_csharp_dotnet_soap_clients.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:03:17.557

过去，我很难让 .Net 使用 wsdl 以 rpc/literal 格式创建的 Web 服务。尝试将您的 WSDL 转换为文档/文字格式，您应该会有更多的运气。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:35:24.780

您需要修复您的 wsdl：

```
<operation name="getXML">
    <soap:operation soapAction="urn:MyWebService#getXML"/>
   <input>
     <soap:body use="literal"/>
   </input>
   <output>
     <soap:body use="literal"/>
   </output>
</operation>

</binding> 
```

# javascript - jQuery - Disable list of links and move active link down the list in sequence

> ID：10558417
> 
> 赞同：0
> 
> 时间：2012-05-11T20:48:03.847
> 
> 标签：javascript, html, iframe, navigation

I'm trying to test the effectiveness of a navigational function in my prototype. On the left side of the page, I have an unordered list with 30 list items that flows off of the page. On the right side of the page is a prompt that is asking users to click through the navigational items in a randomized sequence.

The right and left side are displayed inside of iFrames, with the clicks on the left navigation updating the content on the right and in turn prompting users to click on the next item in the sequence. I'd like to avoid having all 30 list items live at once, to avoid test users erroneously clicking any item other than the next item in the sequence. Is it possible, using jQuery (or anything else, for that matter), to have the HREF in the navigation track the order of my sequence and link each item when it appears in the sequence and be *unlinked* when it does not appear next in the sequence?

Thanks.

**EDIT:**

I've made a bit of headway here. My javascript is still not producing the desired result (*disable all links except for the current link in the sequence, and once click, disable the link and activate the next one in the sequence*). I've simplified the scope of the list to make the problem easier to handle for now.

```
var linkInterceptor = function(event) {
    if($(event.target).hasClass("active")) {
        $('a').removeClass("active");

// assume links have class="nextlink_##"
var nextTarget = $(event.target).getAttr('class');
var nextId = nextTarget.substr(9);
$('#' + nextId).addClass("active");

return true;
} else {
event.preventDefault();
}
};

$('a').on('click', linkInterceptor); 
```

And here is the HTML

```
<div style="width:1024px; height:768px;">
    <div style="width:298px; height:708px; overflow:scroll; float:left;">
            <a class="nextlink_2" id="1" target="frame2" href="instruction_2.html">img</a>
            <a class="nextlink_3" id="2" target="frame2" href="instruction_3.html">img</a>
            <a class="nextlink_4" id="3" target="frame2" href="instruction_4.html">img</a>
            <a class="nextlink_5" id="4" target="frame2" href="instruction_5.html">img</a>
            <a id="5" target="frame2" href="instruction_6.html">img</a>
    </div>
    <div style="width:726px; float:left;">
        <iframe src="instruction_1.html" width="726" height="100%" scrolling="auto" frameborder="0" id="frame2"></iframe>
    </div>   
</div> 
```

Any idea where I'm going astray?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:08:04.613

弄清楚了。下面是停用列表中链接的代码，根据链接 ID 逐步执行预先确定的无序序列，并在单击时停用链接并激活序列中的下一个链接。的JavaScript：

```
<script>
    var linkInterceptor = function(event) {
    if($(event.target).hasClass("active")) {
    $('a').removeClass("active");

    // assume links have class="nextlink_##"
    var nextTarget = $(event.target).attr('class');
    var nextId = nextTarget.substr(9);
    $('#' + nextId).addClass("active");

    return true;
    } else {
    event.preventDefault();
    }
    };

    $('a').on('click', linkInterceptor);
</script> 
```

以及最终 HTML 的示例：

```
 <div style="width:1024px; height:768px;">
    <div style="width:298px; height:708px; overflow-y: scroll; overflow-x:hidden; float:left; padding-bottom:-20px; margin-bottom:-20px;">
        <li><a class="nextlink_13" id="12" target="frame2" href="instruction_13.html">Name 1</a></li>
        <li><a class="nextlink_11" id="10" target="frame2" href="instruction_11.html">Name 2</a></li>
        <li><a class="nextlink_20" id="19" target="frame2" href="instruction_20.html">Name 3</a></li>
        <li><a class="nextlink_3" id="2" target="frame2" href="instruction_3.html">Name 4</a></li>
        <li><a class="nextlink_16" id="15" target="frame2" href="instruction_16.html">Name 5</a></li>
    </div>
    </div> 
```

该列表有 30 个名字，所以我在上面截断了它。为了实现计划的随机性，我只是根据我们喜欢的顺序对 ID 进行编号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:07:47.030

我创建了一个可以工作的小型 JSFiddle。[http://jsfiddle.net/79ZFR/](http://jsfiddle.net/79ZFR/)

本质上，我删除了当前的点击处理程序，然后将点击处理程序添加到下一个数字。

```
 function AddClick(number) {
        $("#" + number).click(function () {
            $("#" + number).off('click');
            AddClick(number+1);
        });
    }​ 
```

然后您需要做的就是在加载时对其进行初始化。

```
 $(function () {
        AddClick(1);
    }); 
```

我的 HTML 是：

```
<ul>
    <li><a id="1" href="#">1</a></li>
    <li><a id="2" href="#">2</a></li>
    <li><a id="3" href="#">3</a></li>
    <li><a id="4" href="#">4</a></li>
    <li><a id="5" href="#">5</a></li>
</ul> 
```

但如果你想让它随机化，那么你可以在后端轻松地做到这一点。

我没有在其中使用任何 iframe。

注意：对于你的最后一个，你需要处理你的停止计时器事件。

编辑：

对于随机列表，我会在后端执行并生成我的 HTML

```
<ul>
    <li><a id="5" href="#">5</a></li>
    <li><a id="3" href="#">3</a></li>
    <li><a id="1" href="#">1</a></li>
    <li><a id="4" href="#">4</a></li>
    <li><a id="2" href="#">2</a></li>
</ul> 
```

# asp.net - 如何从类库/程序集中访问主机应用程序的 web.config 文件？

> ID：10558418
> 
> 赞同：0
> 
> 时间：2012-05-11T20:48:09.070
> 
> 标签：asp.net, c#-4.0, configuration

我正在创建一个将在 Web 应用程序中使用的类库。在其中一个程序集类中发生的一件事是它访问了数据库。通常，当我从服务中执行此操作时，连接字符串会从 web.config 文件中提取。对于类库，我不太确定它会如何以同样的方式工作。有什么建议么？

现在，我尝试将我的正常配置调用放入程序集中：

```
protected readonly string _utiConnStr =
 System.Web.Configuration.WebConfigurationManager.ConnectionStrings["UTI"].ConnectionString; 
```

它吐了，说“对象引用未设置为对象的实例”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:56:53.710

例如，如果我想要邮件设置：

```
 //open the webconfig
 Configuration webConfig = WebConfigurationManager.OpenWebConfiguration(@"~/web.config");

 // Get mail settings
 mailSettings = webConfig.GetSectionGroup("system.net/mailSettings") as MailSettingsSectionGroup; 
```

# sed - 将行拆分为列

> ID：10558431
> 
> 赞同：1
> 
> 时间：2012-05-11T20:49:49.767
> 
> 标签：sed, tr, tabular, csv

我有个问题。现在，一个应该用制表符分隔的文件缺少一些“换行符”......我的文件现在看起来像这样

```
Field1 Field2 Field3
Field1 Field2 Field3 Field1 Field2 Field3 Field1 Field2 Field3
Field1 Field2 Field3 Field1 Field2 Field3
Field1 Field2 Field3
Field1 Field2 Field3 Field1 Field2 Field3
Field1 Field2 Field3 
```

我想让它看起来统一，每个“field1”都从一个新行开始

```
Field1 Field2 Field3
Field1 Field2 Field3
Field1 Field2 Field3
Field1 Field2 Field3
Field1 Field2 Field3 
```

问题是，这些列中的每一列都有一组唯一的数据，所以我找不到熟悉的地方将其拆分为新行。任何帮助是极大的赞赏！

PS：非常感谢在 sed 或 tr 中执行此操作 PS：最多可以有 150 列，而不仅仅是 6 或 9 或任何其他 3 的倍数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:34:22.533

这可能对您有用：

```
sed 's/\s/\n/3;P;D' file 
```

解释：

*   第三个空格字符（空格或制表符）被换行符替换`s/\s/\n/3`

*   打印到第一个换行符的字符串`P`

*   删除第一个换行符之前的字符串`D`

    该`D`命令具有分裂的人格。如果没有换行符，则删除字符串并读入下一行。但是，如果存在换行符，则删除字符串直到换行符，然后在同一字符串上开始循环，直到不存在换行符为止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:20:16.713

这将适用于您提供的示例...

`sed -e 's/\([^\t ]* [^\t ]* [^\t ]*\)[\t ]/\1\n/g'`

# facebook - Facebook Open Graph 需要 URL 来发布操作

> ID：10558438
> 
> 赞同：3
> 
> 时间：2012-05-11T20:50:26.793
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

看起来 Facebook 的 Open Graph API 需要 URL 来发布操作。我的困惑是我的工作流程如下：

*   用户在原生 iOS 应用程序中对对象调用操作
*   此事件被发送到私有的服务器端 API
*   没有与此事件相关的公共 URL，只有移动客户端可以与服务器 API 交互

如果 Facebook 显示如下示例，我该如何发布到我的时间线：

```
https://graph.facebook.com/me/recipebox:cook?
  recipe=http://www.example.com/pumpkinpie.html&access_token=YOUR_ACCESS_TOKEN 
```

我的应用没有[http://www.example.com/pumpkinpie.html](http://www.example.com/pumpkinpie.html)。每当从客户端生成事件到服务器时，我都需要能够从我的服务器发布 Open Graph API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:53:18.240

您需要一个 URL——即使当用户登陆时所发生的只是他们被重定向到其他地方，您也需要一个带有描述该对象的元数据的 URL。

如果服务器没有代表您正在对其执行操作的对象的 URL，那么在 Facebook 上与该故事互动的人们会去哪里？

# ruby - Ruby 看不到 NLS_LANG 环境变量

> ID：10558439
> 
> 赞同：6
> 
> 时间：2012-05-11T20:50:32.047
> 
> 标签：ruby, bash, oci8

我在 CentOS 上运行 ruby​​ 脚本，并通过 rvm (1.9.3) 安装了 ruby​​。

我在 .bash_profile 中设置了 NLS_LANG 变量。

```
[app@box stasis]$ echo $NLS_LANG
en_US.UTF-8
[app@box stasis]$ which ruby
~/.rvm/rubies/ruby-1.9.3-p194/bin/ruby 
```

但是，当尝试通过 ruby​​（oci8 驱动程序执行此操作）访问它时，它找不到它：

```
 1.9.3-p194 :001 > ENV['NLS_LANG']
 => nil 
```

访问其他变量似乎有效：

```
 1.9.3-p194 :004 > ENV['USER']
 => "app" 
```

我的脚本显示以下内容：`Warning: NLS_LANG is not set. fallback to US7ASCII.`

事情是我正在从 ruby​​ 脚本运行 sqlplus（以执行一些 .sql 文件），并且特殊字符都搞砸了。

我怎样才能让红宝石看到价值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-11T21:43:30.603

您需要导出变量以在任何运行的应用程序中可用（除非它们是函数）：

```
export NLS_LANG 
```

或与设置一起：

```
export NLS_LANG=en_US.UTF-8 
```

或者在大多数系统上`LANG`应该可用：

```
export NLS_LANG=$LANG 
```

# python - IPv6 的 inet_aton 类似功能

> ID：10558441
> 
> 赞同：9
> 
> 时间：2012-05-11T20:50:53.997
> 
> 标签：python, ip, type-conversion, ipv6, inet

我正在使用`inet_aton`将 IPv4 IP(216.12.207.142) 转换为字符串 3624718222。为此，我使用以下代码：

```
ip_dec = unpack('>L', inet_aton(ip))[0] 
```

现在我需要将 IPv6 ip 2001:23::207:142 转换为类似的字符串。它给了我错误，因为它不是 IPv4 地址。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T22:52:15.307

这是我之前用于此目的的代码。请注意，它返回一个 128 位整数而不是字符串（一般来说，整数更有用）

```
from socket import inet_pton, AF_INET6
from struct import unpack

def ip6_to_integer(ip6):
    ip6 = inet_pton(AF_INET6, ip6)
    a, b = unpack(">QQ", ip6)
    return (a << 64) | b 
```

并对其进行测试

```
>>> ip6_to_integer("2001:23::207:142")
42540490934961530759802172199372521794L 
```

如果必须的话，或者作为字符串！

```
>>> str(ip6_to_integer("2001:23::207:142"))
'42540490934961530759802172199372521794' 
```

# php - 查询语法不正确

> ID：10558443
> 
> 赞同：0
> 
> 时间：2012-05-11T20:50:58.333
> 
> 标签：php, mysql, syntax-error

我目前正在制作购物车，但在下面的 SQL 查询中遇到问题：

```
$sql="SELECT * FROM component WHERE componentID IN (";

            foreach($_SESSION['cart'] as $id => $value) {
                $sql.=$id.",";
            }

            $sql=substr($sql, 0, -1).")";

            $query=mysql_query($sql) or die(mysql_error()); 
```

因此，我正在尝试使用 select 和 foreach 将 SESSION 项目与我的数据库项目一起检查。代码循环通过SESSION并将componentID添加到SELECT，然后将其带入substr函数以删除最后一个逗号（例如删除'001,002 * *，* *'。我确定语法是正确的，但是我不断得到语法错误是：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“00004,00007)”附近使用正确的语法

谁能看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:55:16.820

我认为这条线是你的问题：

您还可以按照 ccKep 的建议简化制作逗号分隔的 id 集的过程：

```
$sql .= implode(",", $_SESSION['cart']) . ")"; 
```

完整的代码如下所示：

```
$sql="SELECT * FROM component WHERE componentID IN (";
$sql .= implode(",", $_SESSION['cart']) . ")";

$query=mysql_query($sql) or die(mysql_error()); 
```

这将从 $_SESSION['cart'] 获取*值*- 如果你真的想要数组的索引，就像你第一次编码它一样，有这个选项：

```
$sql="SELECT * FROM component WHERE componentID IN (";
$sql .= implode(",", array_keys($_SESSION['cart'])) . ")";

$query=mysql_query($sql) or die(mysql_error()); 
```

array_keys() 将提取数组的索引并忽略值。如果您想要这些值，请坚持我的第一个建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:00:27.177

试试这个：

```
 $sql = "SELECT * FROM component WHERE componentID IN (";
    foreach($_SESSION['cart'] as $id => $value) {
            $some_temp_array[] = $id;
    }
    $sql .= implode(',', $some_temp_array).")"; 
```

# php - 创建一个对象并在另一个对象中使用它

> ID：10558445
> 
> 赞同：0
> 
> 时间：2012-05-11T20:51:04.750
> 
> 标签：php, model-view-controller, oop, include, mysqli

我对面向对象编程相当陌生。我制作了这个连接到 mysql 数据库的类，以便从模型中调用。有什么办法可以在 index.php 中包含“database.class.php”（我的 db 类文件），使其成为全局，然后像这样从任何对象访问它

```
$object = new object;
$object->dofunc(); 
```

另一个问题是 dofunc() 需要一个数组作为参数，我如何使这个数组也是全局的，以便可以从任何地方访问它！

这是我的数据库类

```
<?php

class Database {

    private $db;

    public function connect($config) {
        if (is_array($config)) {
            extract($config);
            $db = mysqli_connect($host, $username, $password);
            if ($db) {
                echo "balbabla";
                if (mysqli_select_db($db, $database)) {
                }
                else {
                    throw new exception("<br/><strong>Could not connect to $database under $host</strong>");
                }
            }
            else {
                throw new exception("<br/><strong>Could not connect to mySQL database! Please check your details</stromg>");
            }
        }
    }
}

?> 
```

这也是包含数组的文件

```
<?php

//Configuration for the MVC Framework
$_SETTINGS = array();

//Routing settings!

//Default controller(This controller will be loaded if there is none mentioned in the URI)
$_SETTINGS['default_controller'] = 'User';
//Default method(This will be the default method run if no method is mentioned in the URI)
$_SETTINGS['default_method'] = 'Register';

//Database settings
$DB_SETTINGS['host']     = 'localhost';
$DB_SETTINGS['username'] = 'root';
$DB_SETTINGS['password'] = 'foobar';
$DB_SETTINGS['database'] = 'freelance';
?> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:21:02.420

> 有什么办法可以在 index.php 中包含“database.class.php”（我的 db 类文件），使其成为全局

你可以，但你不应该。

> 另一个问题是 dofunc() 需要一个数组作为参数，我如何使这个数组也是全局的，以便可以从任何地方访问它！

你不应该再次这样做。

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)是要走的路。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T20:57:34.177

要从函数中访问全局变量，请使用`global`关键字。例如，要从 访问 $DB_SETTINGS `Database::connect()`，您可以执行以下操作：

```
public function connect() {
    global $DB_SETTINGS;
    ... 
```

然后可以在该函数内部访问该数组。

至于全局可访问的类，它们自动就是这样。定义一个类使其在任何地方都可用。

# facebook - 照片选择器对话框

> ID：10558446
> 
> 赞同：0
> 
> 时间：2012-05-11T20:51:23.933
> 
> 标签：facebook, dialog, photo

我想我已经看到了一个 Facebook 照片选择器对话框，它允许用户选择一个相册，然后选择一张照片。但是搜索 Facebook 的文档，这似乎并不存在。

有谁知道任何小部件来完成这个（目标平台是桌面/Javascript）？

有人知道这个对话框是否真的存在过一次还是我弄错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:58:51.850

是的，它确实存在于大约两年前，但不再存在。 [http://developers.facebook.com/docs/reference/fbml/multi-friend-selector/](http://developers.facebook.com/docs/reference/fbml/multi-friend-selector/)

您需要自己通过 FQL 来获得朋友，以及一些 CSS 和 HTML（以及多个条目的 Javascript）。谷歌搜索提供了其他选项： http: [//archives-mike.brevoort.com/2010/08/10/introducing-the-jquery-facebook-multi-friend-selector-plugin/index.html](http://archives-mike.brevoort.com/2010/08/10/introducing-the-jquery-facebook-multi-friend-selector-plugin/index.html)

# sql - ASP循环遍历SQL语句中的数组

> ID：10558447
> 
> 赞同：0
> 
> 时间：2012-05-11T20:51:27.070
> 
> 标签：sql, arrays, loops, asp-classic, insert

我有一个表单，其中包含不同数量的“答案”字段。所以我尝试这样构建我的数组：

```
 match = "found"
        form_counter = 1
        i=0
        DIM pollanswer()
        do while match = "found"
        pollanswer(i) = lr_request_collection_dict("poll_answer" & form_counter)
            if pollanswer(i) = "" then
            match ="notfound"
            end if
        form_counter=form_counter+1
        i=i+1
        loop 
```

稍后在我的代码中，我正在获取这些值并希望将它们插入到我的数据库中，但这是我卡住的地方，因为我确实需要自己插入第一个值，然后循环遍历其余的值。

```
thisQuery = "insert into survey_2_surveyquestionanswers (surveyquestionanswer_surveyquestionid, "&_
            "surveyquestionanswer_answer, surveyquestionanswer_answerlabel, surveyquestionanswer_order) "&_
            "select @@identity, "& SQLQuote(pollanswer(0)) &", "& SQLQuote(pollanswer(0)) &", 1 "&_
            icount = 1
            ecount = 2
            for each arrValue in pollanswer
            "union select @@identity, "& SQLQuote(pollanswer) &", "& SQLQuote(pollanswer) &", "& SQLInt(ecount)
            ecount=ecount+1
            next
            ";"
            set thisRS = dbAccessObj.DirectQuery("live", thisQuery) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:34:31.030

好吧，您似乎使用“for each”方法两次插入第一个条目。

您可以使用索引形式：

```
for a_index = 1 to Ubound(pollanswer)
    arrValue = pollanswer(a_index)
    ...
next 
```

这只是省略了第一个数组元素。

# regex - 寻找正则表达式 - 解析电子邮件

> ID：10558448
> 
> 赞同：2
> 
> 时间：2012-05-11T20:51:34.727
> 
> 标签：regex

我需要解析出以下字符串的电子邮件地址部分：

> “兔子先生” <bob@bunny.com>
> <bob@bunny.com>
> “bob 是兔子” <bob@bunny.com>
> bob@bunny.com
> “123 去吧，去吧！” <bob@bunny.com>

在所有情况下，我都在寻找字符串“bob@bunny.com”并且可以忽略其余部分。

我已经尝试了 /"[^"]?"?\s?<?([\w@.]?)>?/ 的各种组合，但发现神奇的模式正在逃避我。

建议？

FWIW 这将在 Perl 中运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:12:26.333

如果一个简单的正则表达式可以，那么您可以使用：

[([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,4})](http://regexr.com/?30u2h)

正如@Peter 提到的，如果您想遵守 RFC 2822，它会变得更加复杂。但是，实际上您可能不想完全遵守，因为 RFC 指定使用过时的双引号和括号，甚至不支持通过一些电子邮件应用程序。一个更实用但仍然相当健壮的示例是这样的：

```
[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:06:06.850

如果你想要一个遵守 RFC 2822 的，那么将它翻译成 Regex 语法就是你想要的：

```
(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]) 
```

来自[http://www.regular-expressions.info/email.html](http://bit.ly/JjVZRK)，其中包含其他更小的表达式。

# c++ - 从网站下载文件的库？

> ID：10558451
> 
> 赞同：-1
> 
> 时间：2012-05-11T20:51:39.450
> 
> 标签：c++, c, http

假设我有这个文件： [http ://www.example.com/somepic.png](http://www.example.com/somepic.png)

是否有一个跨平台的 C 或 C++ 库可以让我轻松地将其下载到指定目录？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:52:59.810

您可以使用[libcurl](http://curl.haxx.se/libcurl/c/)来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:26:15.177

除了它本身，[GNU libmicrohttpd](http://www.gnu.org/software/libmicrohttpd/)网站还列出了几个[替代方案](http://www.gnu.org/software/libmicrohttpd/#alternatives)。

# jquery - 有没有更短的方法来使用 jQuery 来相等块的高度？

> ID：10558453
> 
> 赞同：0
> 
> 时间：2012-05-11T20:51:46.570
> 
> 标签：jquery

最短的路在哪里？

```
var height=0;
$('.el').each(function(){
height<$(this).height()?height=$(this).height():height=height
}).height(height); 
```

如果它存在，当然。

**编辑：** 很好，谢谢你！

```
var h=0;
$('.el').each(function(){
    h=Math.max(h,$(this).height());
}).height(h); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:03:49.317

我猜稍微*短*一点，但*更干净*，*更快：*

```
$(".el").height(Math.max.apply(null, $(".el").map(function () {
    return $(this).height();
}).get())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:06:27.463

附加`.height(height);`到您的方法上只会在找到新的最大值后更新元素的高度。
您想循环返回元素，然后将它们更改为新找到的最大高度。
此外，使用 Math.max 进行比较。

比你少 4 个字符，它会更新所有元素。

```
var h=0;
$('.el').each(function(){h=Math.max(h,$(this).height());});
$('.el').each(function(){$(this).height(h);}); 
```

# jquery - CSS z-index 和 jquery 效果

> ID：10558458
> 
> 赞同：-3
> 
> 时间：2012-05-11T20:52:21.357
> 
> 标签：jquery, css, z-index

可以用 z-index 为图像设置动画，比如不透明度和其他？！

因为我做错了

```
 On click get id clicked and to the following to the img id equal to clicked id
 $('#gallery img').eq(atrb-1).css("z-index",z++).slideUp('slow'); 
```

但它显示图像的 z 指数较低

## 我怎么能避免呢？

是的，在javascript的开头问题不是z-index，而是z-index jquery动画，如fade等

```
 $("#gallery img").each(function() {
      z++;
     $(this).css('z-index', z).attr('id',z);//set z index and id

    $('#bar').append("<a href='#' id="+z+"/>");

}); 
```

当我单击#bar 中的链接时，链接 id 的图像位于其他人的前面

**找到了答案：它是 fadeToggle 隐藏所有元素并再次使用它来淡入隐藏元素:)))**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:01:43.453

当然，尽管它仍然是不同 z-index 之间的离散转换。所以我真的无法想象这样一个场景会做任何有用的事情——也许是一堆具有不同索引的对象？

看起来您正在尝试将 z-index “增加”一，这可以做到，但没有用。这就像 width:100px 和 width:101px 之间的“动画”

```
$('#gallery img').eq(atrb-1).animate("z-index",'+=1').slideUp('slow'); 
```

# powershell - powershell 异常具有误导性 InvocationInfo

> ID：10558463
> 
> 赞同：2
> 
> 时间：2012-05-11T20:52:30.413
> 
> 标签：powershell

给定脚本。

```
$foo = @("bar")

try {
    $foo | ForEach-Object {
        Join-Path $null $null
    }
} catch {
    $_.InvocationInfo.Line
} 
```

将打印

```
$foo | ForEach-Object { 
```

但我想

```
Join-Path $null $null 
```

我怎样才能得到实际引发异常的位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:21:55.027

这将为您提供实际的线路：

```
$_.Exception.CommandInvocation.Line 
```

和异常消息：

```
$_.Exception.Message 
```

和行号：

```
$_.Exception.Line 
```

和偏移量（列）：

```
$_.Exception.Offset 
```

所以你可以发出一个有用的小信息：

```
} catch {
    $msg = "Failed to do something. Failed on line number '{0}' column '{1}' ('{2}'). The error was '{3}'." -f 
        $_.Exception.Line, $_.Exception.Offset, $_.Exception.CommandInvocation.Line.Trim(), $_.Exception.Message
    Write-Error $msg
} 
```

# caching - Memcached 与 Redis？

> ID：10558465
> 
> 赞同：1483
> 
> 时间：2012-05-11T20:52:48.313
> 
> 标签：caching, web-applications, memcached, redis

我们正在使用带有[Redis](http://redis.io/)服务器的 Ruby Web 应用程序进行缓存。是否有必要改为测试[Memcached](http://memcached.org/)？

什么会给我们带来更好的表现？Redis 和 Memcached 之间有什么优缺点？

需要考虑的要点：

*   读/写速度。
*   内存使用情况。
*   磁盘 I/O 转储。
*   缩放。

* * *

## 回答 #1

> 赞同：2140
> 
> 时间：2012-06-29T06:54:00.957

# 摘要（TL；DR）

**2017 年 6 月 3 日更新**

Redis 比 memcached 更强大、更流行、支持更好。Memcached 只能做 Redis 能做的事情的一小部分。Redis 更好，即使它们的功能重叠。

对于任何新事物，请使用 Redis。

# Memcached 与 Redis：直接比较

这两种工具都是强大、快速的内存数据存储，可用作缓存。两者都可以通过缓存数据库结果、HTML 片段或其他任何生成成本可能很高的东西来帮助加速您的应用程序。

## 需要考虑的要点

当用于同一事物时，以下是它们使用原始问题的“要考虑的要点”进行比较的方式：

*   **读/写速度**：两者都非常快。基准测试因工作负载、版本和许多其他因素而异，但通常显示 redis 与 memcached 一样快或几乎一样快。我推荐redis，但不是因为memcached很慢。它不是。
*   **内存使用**：Redis 更好。
    *   memcached：您指定缓存大小，当您插入项目时，守护进程会迅速增长到比这个大小多一点。除了重新启动 memcached 之外，从来没有真正的方法来回收任何空间。你所有的密钥都可能过期，你可以刷新数据库，它仍然会使用你配置的全部 RAM。
    *   redis：设置最大大小由您决定。Redis 永远不会使用超过它必须使用的东西，并且会为您返还它不再使用的内存。
    *   我将 100,000 个 ~2KB 的随机句子字符串 (~200MB) 存储到两者中。Memcached RAM 使用量增长到 ~225MB。Redis RAM 使用量增长到 ~228MB。在刷新两者之后，redis 下降到 ~29MB，memcached 保持在 ~225MB。它们在存储数据方面同样高效，但只有一个能够回收它。
*   **磁盘 I/O 转储**：对于 redis 来说是一个明显的胜利，因为它默认执行此操作并且具有非常可配置的持久性。Memcached 没有在没有第三方工具的情况下转储到磁盘的机制。
*   **缩放**：在您需要多个实例作为缓存之前，两者都为您提供了大量的空间。Redis 包含的工具可帮助您超越这一点，而 memcached 则没有。

## 内存缓存

Memcached 是一个简单的易失性缓存服务器。它允许您存储键/值对，其中值被限制为最大 1MB 的字符串。

它擅长这一点，但仅此而已。您可以通过它们的键以极高的速度访问这些值，通常会使可用网络甚至内存带宽饱和。

当您重新启动 memcached 时，您的数据就消失了。这对于缓存来说很好。你不应该在那里存储任何重要的东西。

如果您需要高性能或高可用性，可以使用第三方工具、产品和服务。

## 雷迪斯

Redis 可以完成与 memcached 相同的工作，并且可以做得更好。

Redis 也可以[充当缓存](https://redis.io/topics/lru-cache)。它也可以存储键/值对。在 redis 中，它们甚至可以达到 512MB。

您可以关闭持久性，它也会很高兴在重新启动时丢失您的数据。如果您希望您的缓存在重新启动后仍然存在，那么您也可以这样做。事实上，这是默认设置。

它也非常快，通常受到网络或内存带宽的限制。

如果一个 redis/memcached 实例的性能不足以满足您的工作负载，那么 redis 是明确的选择。Redis 包括[集群支持](https://redis.io/topics/cluster-tutorial)，并带有高可用性工具（[redis-sentinel](https://redis.io/topics/sentinel)）“在盒子里”。在过去的几年里，redis 也已成为 3rd 方工具的明显领导者。Redis Labs、Amazon 等公司提供许多有用的 redis 工具和服务。redis 周围的生态系统要大得多。大规模部署的数量现在可能比 memcached 多。

# Redis 超集

Redis 不仅仅是一个缓存。它是一个内存数据结构服务器。您将在下面快速了解 Redis 可以做的事情，而不仅仅是像 memcached 这样的简单键/值缓存。*redis 的大部分*功能都是 memcached 无法做到的。

## 文档

Redis 比 memcached 有更好的文档记录。虽然这可能是主观的，但它似乎越来越真实。

[redis.io](https://redis.io/)是一个很棒的易于导航的资源。它让您可以[在浏览器中尝试 redis，](https://try.redis.io/)甚至可以为您提供文档中每个命令的实时交互式示例。

现在 redis 的 stackoverflow 结果是 memcached 的 2 倍。2 倍的 Google 结果。更多语言的更易于访问的示例。更积极的发展。更积极的客户开发。这些测量单独可能意义不大，但结合起来，它们描绘了一幅清晰的画面，即对 redis 的支持和文档更加强大，并且更加最新。

## [持久性](https://redis.io/topics/persistence)

默认情况下，redis 使用一种称为快照的机制将数据持久化到磁盘。如果您有足够的 RAM 可用，它能够将所有数据写入磁盘而几乎不会降低性能。它几乎是免费的！

在快照模式下，突然崩溃可能会导致少量数据丢失。如果您绝对需要确保不会丢失任何数据，请不要担心，redis 也支持 AOF（仅附加文件）模式。在这种持久性模式下，数据可以在写入时同步到磁盘。这可以将最大写入吞吐量降低到磁盘可以写入的速度，但仍然应该非常快。

如果需要，有许多配置选项可以微调持久性，但默认值非常合理。这些选项可以轻松地将 redis 设置为存储数据的安全、冗余的地方。它是一个*真正的*数据库。

## 多种数据类型

Memcached 仅限于字符串，但 Redis 是一种数据结构服务器，可以提供许多不同的数据类型。它还提供了充分利用这些数据类型所需的命令。

### 字符串（[命令](https://redis.io/commands#string)）

最大为 512MB 的简单文本或二进制值。这是 redis 和 memcached 共享的唯一数据类型，尽管 memcached 字符串限制为 1MB。

Redis 通过提供用于按位运算、位级操作、浮点递增/递减支持、范围查询和多键操作的命令，为您提供了更多利用此数据类型的工具。Memcached 不支持这些。

字符串对各种用例都很有用，这就是 memcached 单独用于这种数据类型的原因。

### 哈希（[命令](https://redis.io/commands#hash)）

哈希有点像键值存储中的键值存储。它们在字符串字段和字符串值之间映射。使用散列的字段-> 值映射比使用常规字符串的键-> 值映射更节省空间。

哈希可用作命名空间，或者当您想要对许多键进行逻辑分组时。使用散列，您可以有效地获取所有成员、将所有成员一起过期、一起删除所有成员等。非常适合您有多个需要分组的键/值对的任何用例。

哈希的一个示例使用是用于在应用程序之间存储用户配置文件。使用用户 ID 作为键存储的 redis 哈希将允许您根据需要存储有关用户的尽可能多的数据位，同时将它们存储在单个键下。使用哈希而不是将配置文件序列化为字符串的优点是，您可以让不同的应用程序读取/写入用户配置文件中的不同字段，而不必担心一个应用程序会覆盖其他应用程序所做的更改（如果您序列化陈旧，则可能会发生这种情况数据）。

### 列表（[命令](https://redis.io/commands#list)）

Redis 列表是有序的字符串集合。它们针对从列表的顶部或底部（又名：左侧或右侧）插入、读取或删除值进行了优化。

Redis 提供了许多用于利用列表的[命令](https://redis.io/commands#list)，包括推送/弹出项目、列表之间的推送/弹出、截断列表、执行范围查询等命令。

列表是非常持久的原子队列。它们非常适用于作业队列、日志、缓冲区和许多其他用例。

### 集（[命令](https://redis.io/commands#set)）

集合是唯一值的无序集合。它们经过优化，可让您快速检查值是否在集合中，快速添加/删除值，并测量与其他集合的重叠。

这些非常适合访问控制列表、唯一访客跟踪器和许多其他事物。大多数编程语言都有类似的东西（通常称为 Set）。就是这样，只是分布式的。

Redis 提供了几个[命令](https://redis.io/commands#set)来管理集合。存在诸如添加、删除和检查集合之类的明显操作。诸如弹出/读取随机项目以及与其他集合执行联合和交集的命令等不太明显的命令也是如此。

### 排序集（[命令](https://redis.io/commands#sorted_set)）

排序集也是唯一值的集合。顾名思义，这些是有序的。它们按分数排序，然后按字典顺序排列。

此数据类型针对按分数快速查找进行了优化。获得最高、最低或介于两者之间的任何值范围都非常快。

如果您将用户连同他们的高分一起添加到排序集中，您就拥有了一个完美的排行榜。当新的高分出现时，只需将他们的高分再次添加到集合中，它就会重新排列您的排行榜。也非常适合跟踪用户上次访问的时间以及谁在您的应用程序中处于活动状态。

存储具有相同分数的值会使它们按字典顺序排列（按字母顺序排列）。这对于诸如自动完成功能之类的东西很有用。

许多排序集[命令](https://redis.io/commands#sorted_set)类似于集命令，有时带有额外的分数参数。还包括用于管理分数和按分数查询的命令。

### 地理

Redis 有几个用于存储、检索和测量地理数据的[命令。](https://redis.io/commands#geo)这包括半径查询和测量点之间的距离。

从技术上讲，redis 中的地理数据存储在排序集中，因此这不是一个真正独立的数据类型。它更像是排序集之上的扩展。

### 位图和 HyperLogLog

像地理一样，这些不是完全独立的数据类型。这些命令允许您将字符串数据视为位图或超级日志。

位图是我在下面引用的位级运算符`Strings`的用途。这种数据类型是 reddit 最近合作艺术项目的基本构建块：[r/Place](https://redditblog.com/2017/04/13/how-we-built-rplace/)。

HyperLogLog 允许您使用恒定的极少量空间以惊人的准确性计算几乎无限的唯一值。仅使用约 16KB，您就可以有效地计算访问您网站的唯一身份访问者的数量，即使该数字以百万计。

## 事务和原子性

redis 中的命令是原子的，这意味着您可以确定，只要将值写入 redis，该值对连接到 redis 的所有客户端都是可见的。无需等待该值传播。从技术上讲，memcached 也是原子的，但是随着 redis 在 memcached 之外添加了所有这些功能，值得注意且令人印象深刻的是，所有这些额外的数据类型和特性也是原子的。

[虽然与关系数据库中的事务](https://redis.io/topics/transactions)不太一样，但 redis 也有使用“乐观锁定”（[WATCH](https://redis.io/commands/watch) / [MULTI](https://redis.io/commands/multi) / [EXEC](https://redis.io/commands/exec)）的事务。

## 流水线

Redis 提供了一种称为“[流水线](https://redis.io/topics/pipelining)”的功能。如果您有许多要执行的 redis 命令，您可以使用流水线将它们一次性发送到 redis，而不是一次一个。

通常，当您对 redis 或 memcached 执行命令时，每个命令都是一个单独的请求/响应周期。通过流水线，redis 可以缓冲多个命令并同时执行它们，在一个回复中响应所有命令的所有响应。

这可以让您在批量导入或涉及大量命令的其他操作时获得更大的吞吐量。

## 发布/订阅

Redis 具有专用于[发布/订阅功能的](https://redis.io/topics/pubsub)[命令](https://redis.io/commands#pubsub)，允许 redis 充当高速消息广播器。这允许单个客户端向连接到通道的许多其他客户端发布消息。

Redis 提供发布/订阅以及几乎所有工具。[像RabbitMQ](https://www.rabbitmq.com/)这样的专用消息代理可能在某些领域具有优势，但事实上，同一台服务器还可以为您提供持久的持久队列和您的 pub/sub 工作负载可能需要的其他数据结构，Redis 通常会被证明是最好和最简单的工具为了工作。

## Lua 脚本

您可以将[lua 脚本](https://redis.io/commands/eval)想象成redis 自己的 SQL 或存储过程。它既多又少，但这个类比大多是有效的。

也许你有想要 redis 执行的复杂计算。也许您不能让您的事务回滚，并且需要保证复杂过程的每一步都将自动发生。这些问题以及更多问题都可以通过 lua 脚本来解决。

整个脚本是原子执行的，因此如果您可以将逻辑放入 lua 脚本中，您通常可以避免与乐观锁定事务混淆。

## 缩放

如上所述，redis 包含对集群的内置支持，并与它自己的高可用性工具捆绑在一起，称为`redis-sentinel`.

# 结论

对于任何新项目或尚未使用 memcached 的现有项目，我会毫不犹豫地推荐 redis 而不是 memcached。

以上可能听起来我不喜欢memcached。相反：它是一个强大、简单、稳定、成熟和硬化的工具。甚至在一些用例中它比 redis 快一点。我喜欢内存缓存。我只是认为这对未来的发展没有多大意义。

Redis 完成了 memcached 所做的一切，而且通常做得更好。memcached 的任何性能优势都是次要的，并且是特定于工作负载的。还有一些工作负载 redis 会更快，还有更多的工作负载 redis 可以做而 memcached 根本做不到。面对巨大的功能鸿沟，微小的性能差异似乎微不足道，而且这两种工具都非常快速和高效，它们很可能是您永远不必担心扩展的基础架构的最后一块。

只有一种情况下 memcached 更有意义：memcached 已经用作缓存。如果您已经使用 memcached 进行缓存，那么如果它满足您的需求，请继续使用它。迁移到 redis 可能不值得付出努力，如果您仅将 redis 用于缓存，它可能无法提供足够的好处，不值得您花时间。如果 memcached 不能满足您的需求，那么您可能应该转向 redis。无论您需要超越 memcached 还是需要其他功能，这都是正确的。

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2012-07-05T06:04:10.597

使用 Redis 如果

1.  您需要有选择地删除/过期缓存中的项目。（你需要这个）

2.  您需要能够查询特定类型的键。等式。'blog1:posts:*'、'blog2:categories:xyz:posts:*'。哦耶！这个非常重要。使用它可以选择性地使某些类型的缓存项无效。您还可以使用它来使片段缓存、页面缓存、仅给定类型的 AR 对象等无效。

3.  持久性（你也需要这个，除非你对每次重新启动后必须预热缓存没问题。对于很少更改的对象非常重要）

使用 memcached 如果

1.  Memcached 让你头疼！
2.  嗯...集群？嗯。如果你要走那么远，请使用 Varnish 和 Redis 来缓存片段和 AR 对象。

根据我的经验，我使用 Redis 的稳定性比 Memcached 好得多

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2013-05-03T16:41:30.543

Memcached 是多线程且快速的。

Redis 有很多功能并且速度非常快，但由于它基于事件循环，因此完全限于一个核心。

我们两者都用。Memcached 用于缓存对象，主要是减少数据库的读取负载。Redis 用于诸如排序集之类的东西，它们可以方便地汇总时间序列数据。

* * *

## 回答 #4

> 赞同：92
> 
> 时间：2015-03-02T11:13:11.187

**这太长了，不能作为对已经接受的答案的评论发布，所以我把它作为一个单独的答案**

还需要考虑的一件事是您是否希望缓存实例具有硬的内存上限。

由于 redis 是一个具有大量功能的 nosql 数据库，并且缓存只是它可以使用的一个选项，它会根据需要分配内存——你放入的对象越多，它使用的内存就越多。该`maxmemory`选项不严格强制使用内存上限。当您使用缓存时，密钥会被逐出并过期；很可能您的密钥大小不一样，因此会发生内部内存碎片。

默认情况下，redis 使用[jemalloc](http://www.canonware.com/jemalloc/)内存分配器，它尽最大努力实现内存紧凑和快速，但它是一个通用的内存分配器，它无法跟上大量的分配和高速发生的对象清除。正因为如此，在某些加载模式下，redis 进程显然会由于内部碎片而泄漏内存。例如，如果你有一个 7 Gb RAM 的服务器并且你想使用 redis 作为非持久 LRU 缓存，你可能会发现`maxmemory`随着时间的推移设置为 5Gb 的 redis 进程会使用越来越多的内存，最终达到总 RAM 限制，直到内存不足的杀手干扰。

memcached 更适合上述场景，因为它以完全不同的方式管理其内存。memcached 分配一大块内存——它需要的一切——然后使用自己实现的[slab分配器](https://en.wikipedia.org/wiki/Slab_allocation)自行管理这块内存。此外，memcached 努力保持低内部碎片，因为它实际上[使用 per-slab LRU 算法](https://www.adayinthelifeof.nl/2011/02/06/memcache-internals/)，当 LRU 驱逐是在考虑对象大小的情况下完成的。

话虽如此，memcached 在必须强制执行和/或可预测内存使用的环境中仍然具有强大的地位。我们尝试在 10-15k op/s 的工作负载中使用最新的稳定版 redis (2.8.19) 作为基于 LRU 的非持久性 memcached 替代品，但它泄漏了很多内存；由于相同的原因，相同的工作负载在一天左右的时间内使 Amazon 的 ElastiCache redis 实例崩溃。

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2012-05-11T23:27:34.110

Memcached 擅长做简单的 key/value 存储，擅长做 key => STRING。这使得它非常适合会话存储。

Redis 擅长做 key => SOME_OBJECT。

这真的取决于你要在那里放什么。我的理解是，就性能而言，它们相当均衡。

也祝你好运找到任何客观的基准，如果你确实找到了一些，请将它们发送给我。

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2012-06-15T22:38:18.220

如果您不介意粗俗的写作风格，从可用性的角度来看，Systoilet 博客上的[Redis 与 Memcached](http://systoilet.wordpress.com/2010/08/09/redis-vs-memcached/ "Redis 与 Memcached，Systoilet 博客")值得一读，但在对性能做出任何结论之前，请务必阅读评论中的来回信息；存在一些方法问题（单线程忙循环测试），并且 Redis 也从撰写本文开始进行了一些改进。

没有一个基准链接是完整的而不会使事情有点混乱，所以还可以在[Dormondo 的 LiveJournal](http://dormando.livejournal.com/525147.html)和[Antirez Weblog](http://antirez.com/post/redis-memcached-benchmark.html "Antirez 博客")上查看一些相互冲突的基准。

*编辑*——正如 Antirez 指出的那样，Systoilet 分析的构思很糟糕。即使超出了单线程的不足，这些基准测试中的大部分性能差异也可以归因于客户端库而不是服务器吞吐量。[Antirez 博客](http://antirez.com/post/redis-memcached-benchmark.html "Antirez 博客")上的基准确实提供了更多的苹果对苹果（同一张嘴）的比较。

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2015-10-16T10:20:50.960

我有机会在我工作过的缓存代理中同时使用 memcached 和 redis，让我分享一下我到底在哪里使用了什么以及背后的原因......

雷迪斯 >

1) 用于在集群上索引缓存内容。我有超过十亿个键分布在 redis 集群中，redis 响应时间非常短且稳定。

2）基本上，它是一个键/值存储，所以无论在你的应用程序中，无论你有什么类似的东西，都可以使用 redis 来麻烦很多。

3) Redis 持久性、故障转移和备份 (AOF) 将使您的工作更轻松。

内存缓存 >

1）是的，可以用作缓存的优化内存。我用它来存储缓存内容被非常频繁地访问（每秒 50 次），大小小于 1 MB。

2) 当我的单个内容大小为 >1MB 时，我也只为 memcached 分配了 16 GB 中的 2GB。

3）随着内容的增长接近极限，有时我会在统计数据中观察到更高的响应时间（redis 不是这种情况）。

如果您要求整体体验，Redis 非常绿色，因为它易于配置、非常灵活且具有稳定的强大功能。

此外，此[链接](http://ruturaj.net/redis-memcached-tokyo-tyrant-and-mysql-comparision/)上有一个基准测试结果，以下是相同的几个亮点，

[![在此处输入图像描述](../Images/b27785c83323f44b89c7fb555efbcc53.png)](https://i.stack.imgur.com/jJYki.jpg)

[![在此处输入图像描述](../Images/3e3318d9adc891c8e40ea69d016c5322.png)](https://i.stack.imgur.com/RSRvZ.jpg)

希望这可以帮助！！

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2015-11-13T08:14:27.610

测试。运行一些简单的基准测试。很长一段时间以来，我都认为自己是一头老派犀牛，因为我主要使用 memcached，并认为 Redis 是新来的。

在我目前的公司中，Redis 被用作主缓存。当我深入研究一些性能统计数据并开始测试时，Redis 在性能方面与MySQL相当或**稍慢。**

Memcached，虽然很简单，却彻底把 Redis**彻底**淘汰了。它的扩展性要好得多：

*   对于更大的值（需要改变平板尺寸，但有效）
*   对于多个并发请求

此外，在我看来，memcached 驱逐策略实施得更好，从而在处理比缓存能够处理的更多数据的同时，总体上更稳定的平均响应时间。

一些基准测试显示，在我们的案例中，Redis 的性能非常差。我认为这与许多变量有关：

*   运行 Redis 的硬件类型
*   您存储的数据类型
*   获取和设置的数量
*   您的应用程序的并发程度
*   需要数据结构存储吗

就个人而言，我不同意 Redis 作者对并发和多线程的看法。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-07-04T12:42:21.953

另一个好处是它可以非常清楚 memcache 在缓存场景中的行为方式，而 redis 通常用作持久性数据存储，尽管它可以配置为就像 memcached 也就是在达到最大值时驱逐最近最少使用的项目容量。

我工作过的一些应用程序使用这两种方法只是为了明确我们希望数据如何表现——内存缓存中的东西，我们编写代码来处理它不存在的情况——redis中的东西，我们依赖它存在.

除此之外，Redis 通常被认为对于大多数功能更丰富、因此更灵活的用例来说更胜一筹。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-06-16T05:45:06.087

如果我们说redis是（缓存+数据结构）的组合，而memcached只是一个缓存，那就没有错。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-06-01T06:36:21.033

针对 redis-2.2.2 和 memcached 设置和获取 100k 唯一键和值的非常简单的测试。两者都在 linux VM（CentOS）上运行，我的客户端代码（粘贴在下面）在 Windows 桌面上运行。

**雷迪斯**

*   存储 100000 个值所需的时间为 = 18954 毫秒

*   加载 100000 个值所需的时间为 = 18328 毫秒

**内存缓存**

*   存储 100000 个值所需的时间为 = 797ms

*   检索 100000 个值所需的时间为 = 38984 毫秒

* * *

```
Jedis jed = new Jedis("localhost", 6379);
int count = 100000;
long startTime = System.currentTimeMillis();
for (int i=0; i<count; i++) {
  jed.set("u112-"+i, "v51"+i);
}
long endTime = System.currentTimeMillis();
System.out.println("Time taken to store "+ count + " values is ="+(endTime-startTime)+"ms");

startTime = System.currentTimeMillis();
for (int i=0; i<count; i++) {
  client.get("u112-"+i);
}
endTime = System.currentTimeMillis();
System.out.println("Time taken to retrieve "+ count + " values is ="+(endTime-startTime)+"ms"); 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-03-01T09:45:27.077

此处未指出的一个主要区别是 Memcache 始终具有内存上限，而 Redis 默认情况下没有（但可以配置为）。如果您总是想在一定时间内存储一个键/值（并且永远不会因为内存不足而将其驱逐），那么您希望使用 Redis。当然，你也冒着内存不足的风险......

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-06-19T20:55:47.983

如果您对性能感兴趣，Memcached 会更快，即使因为 Redis 涉及网络（TCP 调用）。在内部，Memcache 也更快。

Redis 具有其他答案中提到的更多功能。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-07-05T11:48:40.243

我们认为 Redis 是我们工作中项目的负载起飞。我们认为通过在`nginx`调用中使用模块`HttpRedis2Module`或类似的东西，我们会获得惊人的速度，但是当使用 AB-test 进行测试时，我们被证明是错误的。

也许模块不好或者我们的布局，但这是一个非常简单的任务，使用 php 获取数据然后将其填充到 MongoDB 中甚至更快。我们使用 APC 作为缓存系统以及 php 和 MongoDB。`nginx`它比Redis 模块快得多。

我的建议是自己测试它，这样做会向您显示您的环境的结果。我们认为在我们的项目中没有必要使用 Redis，因为它没有任何意义。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2015-11-20T21:32:31.970

剩下的最大原因是专业化。

Redis 可以做很多不同的事情，其中​​一个副作用是开发人员可能会开始在同一个实例上使用很多不同的功能集。如果您将 Redis 的 LRU 功能用于非 LRU 的硬数据存储旁边的缓存，则完全有可能耗尽内存。

如果您要设置一个专用的 Redis 实例，仅用作 LRU 实例以避免这种特定情况，那么实际上没有任何令人信服的理由使用 Redis 而不是 Memcached。

如果你需要一个可靠的“永不宕机”的 LRU 缓存......Memcached 将符合要求，因为它不可能在设计上耗尽内存，并且专门的功能阻止开发人员尝试使其成为可能危及它的东西。简单的关注点分离。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-03-22T04:22:12.080

**Redis 更好。**

的优点`Redis`是，

1.  它有很多数据存储选项，例如字符串、集合、排序集、散列、位图。
2.  记录的磁盘持久性
3.  存储过程（`LUA`脚本）支持
4.  可以使用 PUB/SUB 充当消息代理

而`Memcache`内存中的键值缓存类型系统。

1.  不支持 redis 中的各种数据类型存储，如列表、集合。
2.  主要缺点是 Memcache 没有磁盘持久性。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-08-10T06:09:39.290

[这](https://aws.amazon.com/elasticache/redis-vs-memcached/)是亚马逊提供的非常棒的文章/差异

与 memcached 相比，Redis 是明显的赢家。

Memcached 只有一个优点， **它是多线程的，速度很快。Redis 有很多很棒的功能，速度非常快，但仅限于一个核心。**

**关于 Redis 的要点，Memcached 不支持这些要点**

*   快照 - 用户可以拍摄 Redis 缓存的快照并在任何时间点保留在二级存储上。
*   内置支持许多数据结构，如 Set、Map、SortedSet、List、BitMaps 等。
*   支持 Redis 中的 Lua 脚本

# javascript - 在 Javascript 中，如何从父事件处理程序中防止子元素的默认值

> ID：10558471
> 
> 赞同：6
> 
> 时间：2012-05-11T20:53:04.833
> 
> 标签：javascript, jquery, jquery-events, preventdefault

假设我有这样的 HTML：

```
<div>
    <a href="http://google.com">Google</a>
</div> 
```

我有一个这样的事件处理程序（假设我有可用的 jQuery）：

```
$('div').on('click', function(ev) {
    // ...
}); 
```

是否可以从该事件处理程序中阻止`<a>`链接的默认操作？还是为时已晚？（换句话说，我是否*需要*在 the 或 lower 上附加一个事件`<a>`以防止默认链接操作，或者是否可以在上述处理程序中停止它）。

如上所述，如果解决方案需要，我可以使用 jQuery。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T20:58:06.917

这肯定会奏效：

```
$('div').on('click', "a", function(e) {
    e.preventDefault();
}); 
```

这是一个小提琴：http: [//jsfiddle.net/xvKNC/1/](http://jsfiddle.net/xvKNC/1/)

坚持，稍等。这似乎在 Chrome 中对我来说很好用

```
// prevent default on every click in the div
$('div').on('click', function(ev) {
    ev.preventDefault();
}); 
```

查看更新的小提琴：http: [//jsfiddle.net/xvKNC/2/](http://jsfiddle.net/xvKNC/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T21:07:13.743

它似乎工作：

```
$('div').on('click', function(ev) {
    ev.stopImmediatePropagation();
    ev.preventDefault();

}); 
```

JSFiddle：http: [//jsfiddle.net/3yFfC/](http://jsfiddle.net/3yFfC/)

# asp.net - VB.NET 复选框

> ID：10558473
> 
> 赞同：0
> 
> 时间：2012-05-11T20:53:13.257
> 
> 标签：asp.net, vb.net

我有一个包含以下 CheckBoxList 的 aspx 页面。

```
<form id="form1" runat="server">

    <asp:CheckBoxList id="check1" AutoPostBack="True" TextAlign="Right" OnSelectedIndexChanged="Check" runat="server">

    </asp:CheckBoxList>
    <br />
    <asp:label id="mess" runat="server"/>

</form> 
```

然后在 .vb 页面中，我在 Page_Load 子中有一个查询，我在其中获取所有客户姓名以及他们是否是经过验证的用户（真或假）。当我遍历数据集时，我想为每个名称添加一个 ListItem，如果他们是经过验证的用户，我希望选中该复选框。这是我的数据集循环

```
 For i = 0 To dt.Rows.Count - 1
        If CStr(dt.Rows(i).Item("isValid")) = True Then
            "<asp:ListItem>" + CStr(dt.Rows(i).Item("Name")) + "</asp:ListItem>" 
        Else
            "<asp:ListItem>" + CStr(dt.Rows(i).Item("Name")) + "</asp:ListItem>" 
        End If 
```

我知道上面的循环不会添加 listItems，如何在循环中添加选中的 ListItems？任何帮助，将不胜感激。谢谢

我知道有一种方法可以检查是否选中了一个框，例如

```
check1.Items(i).Selected 
```

如果没有检查如何检查？像这样的东西？：

```
check1.Items(i).Selected = False 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:13:18.997

您可以`CheckBoxList`使用向 中添加项目`CheckBoxList.Items.Add(ListItem)`。`ListItem`具有[`Selected`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitem.selected.aspx) 选中状态的属性：

```
For Each row As DataRow In dt.Rows
    Dim name = row.Field(Of String)("Name")
    Dim isValid = row.Field(Of Boolean)("isValid")
    Dim item = New ListItem(name)
    item.Selected = isValid
    check1.Items.Add(item)
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:59:24.590

我不知道 VB，但在 C# 中，它想`check1.items.add(new ListItem("val"))`添加每个`ListItem`.

# php - 在 PHP 中以平面数组形式给出时，有效地从层次结构中修剪无效分支

> ID：10558474
> 
> 赞同：1
> 
> 时间：2012-05-11T20:53:16.297
> 
> 标签：php, arrays, hierarchy

我有一个简单的项目清单。列表中的某些项目是列表中其他项目的父项。我需要检查每个项目，并确保它不是无效的。每个项目都有一个过期时间，如果一个项目是自己的或它的任何父项的过期时间已过，则该项目无效。如何有效地从列表中删除所有无效项目？

本质上，我在数组中得到了一组分层数据。每个项目都有自己的 id、parentID、时间信息和其他无用数据。

由于也可以有多个根节点，因此这有点复杂。它是一个项目没有 parentID，它是一个根节点。

示例数组（省略日期时间和其他信息）：

```
Array
(
    [0] => MyObject
        (
            [id:protected] => 1
            [parentID:protected] => 2
        )

    [1] => MyObject
        (
            [id:protected] => 4
        )

    [2] => MyObject
        (
            [id:protected] => 2
            [parentID:protected] => 4
        )

    [3] => MyObject
        (
            [id:protected] => 3
        )

    [4] => MyObject
        (
        [id:protected] => 5
        [parentID:protected] => 3
    )
) 
```

我想找到一种有效的方法来删除根据第一段无效的所有项目，并返回剩余项目的数组。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:08:18.673

我认为最有效的做法是遍历所有项目并删除自过期的节点。通过这样做，当您稍后构建树时（我假设最终您会这样做），任何没有被自我过期标准手动删除的项目都将成为孤立的，因为缺少祖先，并且涵盖了祖先过期标准。如果需要，您可以将树重新转换回平坦的，但我猜您最终想要这棵树。

# objective-c - Url scheme : 从邮件中打开应用或应用商店

> ID：10558475
> 
> 赞同：9
> 
> 时间：2012-05-11T20:53:17.960
> 
> 标签：objective-c, ios, url-scheme

我正在创建一个应用程序，用户可以通过相互发送电子邮件来共享数据。在这封邮件中有一个指向我的应用程序的链接（我为我的应用程序创建了一个 URL 方案）但是，如果用户在他的 iPhone 上没有我的应用程序，那么当他单击该链接时，什么也没有发生。

**我的问题**：当应用程序安装在用户的 iPhone 上时，我该如何启动我的应用程序，如果未安装此应用程序，则启动 Appstore 或网站

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:07:15.577

`canOpenURL`就是你要找的。

这是启动 twitter 应用程序的示例：

```
NSURL* twitterURL = [NSURL URLWithString:[NSString stringWithFormat:@"twitter:@%@", twitterUser]];

if ([[UIApplication sharedApplication] canOpenURL:twitterURL]) {
    [[UIApplication sharedApplication] openURL:twitterURL];
} else {
    NSURL* url = [NSURL URLWithString:@"http://itunes.apple.com/us/app/twitter/id333903271?mt=8"];
    [[UIApplication sharedApplication] openURL:url];
} 
```

**编辑**

如果您想通过网页或 html 电子邮件执行此操作，您可以在此处找到答案： [https ://stackoverflow.com/a/627942/550177](https://stackoverflow.com/a/627942/550177)

在这里： [https ://stackoverflow.com/a/1109200/550177](https://stackoverflow.com/a/1109200/550177)

# logback - 在 Logback 中使用带有 JMSAppender 的布局

> ID：10558482
> 
> 赞同：0
> 
> 时间：2012-05-11T20:53:50.243
> 
> 标签：logback

我正在使用 Logback 框架中的 JMSAppender 将消息写入 Websphere MQ。我们有一个自定义布局类，并在配置文件中指定了它。但是，布局没有被应用。我读到 JMS appender 并没有真正使用布局类。有没有办法为 JMSAppender 应用布局。

欢迎提出建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:56:46.190

虽然这可能有点晚了，你可能已经想通了......

`JMSAppender`我最近在做一些工作。日志按照类型发送到队列`ObjectMessage`，该类型`LoggingEventVO`基本上是日志条目的可序列化视图。在这种情况下，您拥有所需的一切，因此布局/编码器将无关紧要。在日志使用者方面，您将消息转换为正确的类型并在那里生成您喜欢的任何格式

看看[LoggingEventVO src](https://github.com/qos-ch/logback/blob/master/logback-classic/src/main/java/ch/qos/logback/classic/spi/LoggingEventVO.java)

# performance - 在 Visual Studio 中自动替换文本

> ID：10558483
> 
> 赞同：0
> 
> 时间：2012-05-11T20:53:53.250
> 
> 标签：performance, asp.net-mvc-3, visual-studio-2010, automation, replace

我有一个 Web 项目，我正在删除所有内联样式并将其添加到 CSS 文件中，我不禁想到有一种更简单的方法可以做到这一点。

我目前的流程是：

1.  搜索解决方案`style="`，如果未选择，请转到：`9`
2.  剪切引号之间的所有文本
3.  在 CSS 文件中创建新类
4.  在课堂上粘贴代码
5.  复制班级名称
6.  返回到 html 行并在引号之间粘贴类名
7.  重命名`style`为`class`
8.  去：`1`
9.  麾！

我真的很高兴，但内联样式的供应似乎永无止境。

有没有办法在 Visual Studio 2010 中自动执行此过程？如果它需要写一个插件，那完全没问题！我在许多项目上都有同样的任务要做。

另外，我希望能够对任意标签执行此操作。例如，我还使用所有`data-*`标签并做大致相同的事情，但添加一行 jQuery 将其添加回来。类似于：

```
$('SELECTOR').attr('data-bind','visible: IsValid'); 
```

这项工作太重复了，我不相信有一种自动化的（或至少更快/更好/更省时）的方式来做到这一点。

该项目是一个 MVC 项目，如果它改变了任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T07:07:58.597

您将需要一个宏。在一个文件中有实现的提示：

1/ 编辑点

```
Dim EditPt As EditPoint
EditPt = CType(DTE.ActiveDocument.Object, EnvDTE.TextDocument).StartPoint.CreateEditPoint 
```

2/ 搜索和替换

```
While EditPt.FindPattern("style="".*""")

End While 
```

你可以阅读文本`EditPt.GetText(6)`（返回'style='）删除文本`EditPt.Delete(6)`（删除'style='）`EditPt.Insert("_")`（在'style='之前插入_）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:05:58.777

如果您正在寻找将内联样式替换为 css 类的工具，可以使用以下工具：

[http://www.voodoobytes.info/humbles-tools/](http://www.voodoobytes.info/humbles-tools/)

[http://www.tinytool.net/96002/inline_css_extractor](http://www.tinytool.net/96002/inline_css_extractor)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:58:03.160

我自己不使用[CodeRush](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/index.xml)，但他们似乎有你正在寻找的东西，如果[这个链接](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/index.xml#maintc|whatsinside)是值得相信的。

> *   将样式属性移动到外部 CSS

您可能需要编写自己的插件来完成其他工作，但 CodeRush 确实支持这一点。

[我在Resharper](http://www.jetbrains.com/resharper/)中找不到类似的功能，尽管它也支持插件。

# sql - 如何创建用于计算总会费的 sql 程序

> ID：10558484
> 
> 赞同：2
> 
> 时间：2012-05-11T20:54:06.263
> 
> 标签：sql, visual-studio, sql-server-2000, crystal-reports-8.5

任何人都可以通过显示用于从三个表计算总会费的创建过程语句来帮助我吗？这是表格及其数据..

**表格1**

```
accountno   shipername   shiperaddress   Executivename
   001      john         123, London          Paul
   002      Robi         127, China           Soma 
```

**表_2**

```
Executivename shipername shiperaddress accountno currentamount anotheramount    
   paul          john     123,london     001         10500       12000
   soma          robi     127,china      002         11000        6800 
```

**表3**

```
accountno    Date        ReceivedAmount    MoneyReceiptNo
   001       1/1/2012       6500              G 256412
   002       1/2/2012       5200              D 246521 
```

在这里我要提一下，总会费将计算为

```
(currentamount + anotheramount) - receivedamount 
```

我试图通过以下存储过程来做到这一点。

```
CREATE PROCEDURE [dbo].[rptexetotaldues] @Executivename varchar(20) 
AS BEGIN
    select 
        table_1.Executivename, 
        sum(table_2.currentamount + table_2.anotheramount
             - table_3.receivedamount ) as TotalDues 
    from 
        table_1 
    full join 
        table_2 on table_1.accountno = table_2.accountno 
    join 
        table_3 on table_3.accountno = table_1.accountno 
    where 
        table_1.Executivename = @Executivename 
    group by 
        table_1.Executivename
end 
```

但这不起作用。请有人帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:25:11.317

你的样品对我有用。我唯一改变的是要转换的“日期”。我强烈建议避免将“日期”作为列名。我也稍微改变了别名，但这应该没问题。我认为@Gordon Linoff 是对的——你可能对 NULLS 有疑问。

```
DECLARE @table_1 TABLE (accountno char(5), shipername char(20), shiperaddress char(40), Executivename varchar(20))
INSERT INTO @table_1 VALUES ('001', 'john', '123, London', 'Paul')
INSERT INTO @table_1 VALUES ('002','Robi','127, China','Soma')

DECLARE @table_2 TABLE (Executivename varchar(20), shipername char(20), shiperaddress char(40),
                        accountno char(20), currentamount decimal(10,2), anotheramount decimal(10,2))

INSERT INTO @table_2 VALUES ('paul', 'john','123,london','001',10500, 12000)
INSERT INTO @table_2 VALUES ('soma', 'robi', '127,china', '002', 11000, 6800)

DECLARE @table_3 TABLE(accountno char(20), tranDate datetime, ReceivedAmount decimal(10,2), MoneyReceiptNo char(10))
INSERT INTO @table_3 VALUES ('001', '1/1/2012', 6500, 'G 256412')
INSERT INTO @table_3 VALUES ('002', '1/2/2012', 5200,'D 246521')

DECLARE @Executivename varchar(20) 

--SET @Executivename = 'Paul'
SET @Executivename = 'Soma'

    select 
        tb1.Executivename, 
        sum(tb2.currentamount + tb2.anotheramount - tb3.receivedamount ) as TotalDues 
    from 
        @table_1 tb1
        full join @table_2 tb2 on tb1.accountno = tb2.accountno 
        join @table_3 tb3 on tb3.accountno = tb1.accountno 
    where 
        tb1.Executivename=@Executivename group by tb1.Executivename 
```

这是我的结果：

```
Executivename   TotalDues
Soma    12600.00 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:15:52.097

我可以想到两个问题。首先是帐号在表 1 或表 2 中重复。这将添加额外的行。

第二个是表 3 中有一些行不在表 2 中。这意味着总和中的加法为 NULL，因为其中一个值为 NULL。您可以通过以下方式之一解决此问题：

```
 sum(table_2.currentamount) + sum(table_2.anotheramount) - sum(table_3.receivedamount) 
```

或者

```
 sum(coalesce(table_2.currentamount, 0.0) + coalesce(table_2.anotheramount, 0.0) - coalesce(table_3.receivedamount, 0.0) ) as TotalDues 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:26:04.937

我认为作为 UNION 查询会更直接，示例如下：

```
CREATE PROCEDURE [dbo].[rptexetotaldues] @Executivename varchar(20) 
AS BEGIN

SELECT SUB.ACCOUNTNO, SUM(SUB.DUE) AS TOTALDUE FROM 
  (SELECT ACCOUNTNO
        , CURRENTAMOUNT AS DUE
   FROM TABLE_2
   INNER JOIN TABLE_1 -- WILL ONLY WORK IF ACCOUNTNO IS UNIQUE WITHIN TABLE_1
   ON TABLE_1.ACCOUNTNO = TABLE2.ACCOUNTNO
   WHERE TABLE_1.EXECUTIVENAME = @Executivename

   UNION ALL

   SELECT ACCOUNTNO
        , ANOTHERAMOUNT AS DUE
   FROM TABLE_2
   INNER JOIN TABLE_1 
   ON TABLE_1.ACCOUNTNO = TABLE2.ACCOUNTNO
   WHERE TABLE_1.EXECUTIVENAME = @Executivename

   UNION ALL

   SELECT ACCOUNTNO
        , -RECEIVEDAMOUNT AS DUE -- NOTE NEGATIVE SIGN
   FROM TABLE 3
   INNER JOIN TABLE_1 
   ON TABLE_1.ACCOUNTNO = TABLE3.ACCOUNTNO
   WHERE TABLE_1.EXECUTIVENAME = @Executivename
   ) SUB

GROUP BY SUB.ACC 
```

# java - 完成父目录pom的所有阶段后，我可以运行子目录的pom文件吗？

> ID：10558486
> 
> 赞同：1
> 
> 时间：2012-05-11T20:54:10.143
> 
> 标签：java, maven-2

我有以下多模块 Maven 项目

```
MyProj
  -Api
    -pom.xml
  -Impl
    -pom.xml
  -pom.xml 
```

使用 maven replacer 插件替换了几个标签和代码后，我将 Api & Impl 模块复制到另一个目录下

```
MyProj
  -Api
    -pom.xml
  -Impl
    -pom.xml
  -pom.xml
  -PublicDir
      -Api
        -pom.xml
      -Impl
        -pom.xml
      -pom.xml 
```

我想为所有四个项目（已更改和未更改）创建工件我在编译从父 pom（\MyProject\pom.xml）在 PublicDir 下生成的源时遇到问题。有没有办法处理这种情况？build-helper-maven-plugin 插件会对此有所帮助吗？我添加了这个插件并指向生成的源位置，但无法获得所需的结果。

或者简单地说 - 我可以在完成 MyProj/pom.xml 的所有阶段后运行另一个 MyProj/publicDir/pom.xml 吗？

这是pom -

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>sample.mygroup</groupId>
    <artifactId>myartifact</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>pom</packaging>
    <modules>
        <module>api</module>
        <module>impl</module>
    </modules>
    <dependencies>
        <!-- Some dependencies -->
    </dependencies>
    <build>
        <plugins>
            <plugin>
                <groupId>com.google.code.maven-replacer-plugin</groupId>
                <artifactId>replacer</artifactId>
                <version>1.5.0</version>
                <executions>
                    <execution>
                        <id>regex</id>
                        <phase>process-sources</phase>
                        <goals>
                            <goal>replace</goal>
                        </goals>
                        <configuration>
                            <includes>
                                <include>api/**/*.*</include>
                                <include>impl/**/*.*</include>
                            </includes>
                            <token>@Start.*?@End</token>
                            <value></value>
                            <regexFlags>
                                <regexFlag>DOTALL</regexFlag>
                            </regexFlags>
                            <outputDir>/publicDir</outputDir>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <!-- some more plugin -->
        </plugins>
</project> 
```

# php - 在 linux/php 中将 RAW 照片转换为 JPEG

> ID：10558487
> 
> 赞同：7
> 
> 时间：2012-05-11T20:54:13.233
> 
> 标签：php, image, image-processing, imagemagick, photo

我正在开发一个照片上传应用程序，需要允许用户从相机上传原始文件（这些不是 jpeg），并让服务器自动创建它们的 jpeg 版本。我目前安装了 Imagemagick，但我认为那里没有办法做到这一点。

相机总是以新的原始格式出现，所以我正在寻找一些相对最新的东西，命令 php exec() 也是一个选项。

有人对原始转换有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T21:01:34.887

实际上，正如您在此列表中看到的，ImageMagick 确实支持 RAW 照片：[http](http://www.imagemagick.org/script/formats.php) ://www.imagemagick.org/script/formats.php （例如 .NEF 尼康照片和 .CR2 佳能照片）。

.CR2 照片的示例代码：

```
$im = new Imagick( 'source.CR2' );
$im->setImageFormat( 'jpg' );
$im->writeImage( 'result.jpg' );
$im->clear();
$im->destroy(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-07T02:43:32.257

甚至更容易

```
sudo apt-get install ufraw ufraw-batch 
```

然后要么使用 UFRaw（参见手册页），要么使用使用 UFRaw 的 ImageMagick

```
convert mypic.RAF mypic.jpeg 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:02:09.527

您可以使用 exec() 上传，并且当您转换为 jpg 时，您可以使用 jpg“提示”来加快速度 - 它应该只读取尽可能多的数据来创建 jpg 而不是整个文件。

从内存中，定义出现在图像之前的转换之后：

```
convert -define jpeg:size=128x128 input.raw -thumbnail 128x128 output.jpg 
```

Imagemagick 使用 Ufraw 处理 RAW 文件，我发现对于我的 CR2 文件，我需要稍微调整其中一个文件。我想是否支持文件取决于 Ufraw delagate。

我认为三星 RAW 文件是个问题，但不仅仅是 Imagemagick

这是我修改的 delegates.xml 文件，将这一行的 4 更改为 6：

```
<delegate decode="dng:decode" stealth="True" command="dcraw.exe -6 -w -O &quot;%u.ppm&quot; &quot;%i&quot;"/> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-03-03T13:07:16.270

我使用 Imagick 做了完全相同的页面。我成功地将 TIFF、DNG、CR2 文件转换为 JPEG。在执行此操作之前，您必须参考此视频[https://www.youtube.com/watch?v=q3c6O85_LoA&index=29&list=LLkmyV_KYAFxKz9gE_fEbjTA&t=23s](https://www.youtube.com/watch?v=q3c6O85_LoA&index=29&list=LLkmyV_KYAFxKz9gE_fEbjTA&t=23s)

这是一段带有 JavaScript、HTML 和 PHP 的代码：

```
<?php
$file=$_FILES['file'];
$fname=$_FILES['file']['name'];
$ftmp=$_FILES['file']['tmp_name'];
$ferr=$_FILES['file']['error'];
$check=explode(".",$fname);
$ext=end($check);
if(!$ftmp)
{
    //echo"ERROR: Please select a file first!";
    ?>
    <html>
        <script>
            alert("ERROR: Please select a file first!");
            location.href='/Image/1.html';
        </script>
    </html>
    <?php
}
else if(!preg_match("/\.(tif|tiff|cr2|pef|nef|dng)$/i",$fname))
{
    //echo"ERROR: File is not in TIF,TIFF,CR2,PEF,NEF or DNG</br>";
    //echo"File is of $ext format";
    ?>
    <html>
        <script>
            alert("ERROR: File is not in TIF,TIFF,CR2,PEF,NEF or DNG");
            location.href='/Image/1.html';
        </script>
    </html>
    <?php
}
else
{
    //echo".$ext File uploaded";
    ?>
    <html>
        <script>
            alert("File uploaded");

        </script>
    </html>
    <?php
    $im=new Imagick($ftmp);
    $im->setImageFormat('jpg');
    file_put_contents("/var/www/html/Image/Converted/a.jpg",$im);//Path where converted image will be saved on localhost.
    ?>
    <html>
        <script>
            function ok()
            {
                location.href='/Image/1.html';
            }
        </script>
        <img src="/Image/Converted/a.jpg" height="900" width="600">
        <input type=Button Value=Done onclick="ok()">
    </html>
    <?php
    $im->clear();
    $im->destroy();

}?> 
```

HTML 代码。在操作标签中插入您的 php 文件名。

```
<html>
<body>
    <h1 align=center>Upload image</h1>
    <form action=*.php method=POST enctype='multipart/form-data'>
        Please select the file:<br>
        <input type=file name=file><br>
        <input type=SUBMIT value=Submit>
        <input type=Reset value=Reset>
    </form>
</body> 
```

# c++ - Windows 消息过程的函数指针数组

> ID：10558488
> 
> 赞同：0
> 
> 时间：2012-05-11T20:54:16.990
> 
> 标签：c++, pointers

每个人我都想尝试一些东西，我需要一点帮助。我想做的是创建一些函数，将它们的指针存储到一个数组中，然后在 Windows 消息过程中调用它们。例如：

```
int create_functions[10];
int paint_functions[10];

int func1() {
    // code
}

void func2(int arg1) {
    // code
}

create_functions[0] = *func1; // add pointer of func1 to the first array
create_functions[1] = *func2; // add pointer of func2 to the second array

LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam) {
    switch (message) {
        case WM_CREATE:
            // execute create_functions[0] - How do I do it?
        case WM_PAINT:
            // execute paint_functions[0] - How do I do it?
        case WM_DESTROY:
            PostQuitMessage(0);
            break;
        default:
             return DefWindowProc(hWnd, message, wParam, lParam);
             break;
        }
        return 0;
    } 
```

我知道有人会问：为什么不直接执行func1/func2。因为我将决定在运行时执行哪些功能。感谢大家的帮助！

**编辑：** 回调函数呢？我不太明白如何使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:58:48.533

如果问题是：如何做函数指针，我建议你看一下这个主题的文章，比如[http://www.newty.de/fpt/index.html](http://www.newty.de/fpt/index.html)

如果这不是您的问题，您能否编辑并添加更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:01:24.793

这个

```
int create_functions[10];
int paint_functions[10]; 
```

应该

```
void (*create_functions[10])(void);
void (*create_functions[10])(int); 
```

和

```
// execute create_functions[0] - How do I do it?
// execute paint_functions[0] - How do I do it? 
```

应该

```
create_functions[0]();
paint_functions[0](some_integer_here); 
```

还

```
create_functions[0] = *func1; // add pointer of func1 to the first array
create_functions[1] = *func2; // add pointer of func2 to the second array 
```

应该

```
create_functions[0] = func1; // add pointer of func1 to the first array
create_functions[1] = func2; // add pointer of func2 to the second array 
```

或者

```
create_functions[0] = &func1; // add pointer of func1 to the first array
create_functions[1] = &func2; // add pointer of func2 to the second array 
```

根据您的口味或心情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:57:53.657

您可以将指针传递给 wParam 中的数组。

# ios - 基于地图缩放比例计算文本矩形区域的大小

> ID：10558494
> 
> 赞同：2
> 
> 时间：2012-05-11T20:54:47.767
> 
> 标签：ios

我有自定义 mapOverlayView 使用以下代码在地图上显示文本：

```
- (void)drawMapRect:(MKMapRect)mapRect
          zoomScale:(MKZoomScale)zoomScale
          inContext:(CGContextRef)ctx
{
       [super drawMapRect:mapRect zoomScale:zoomScale inContext:ctx];
        NSString *t=text2display;
      CGPoint point = CGPointMake(0,30);
        CGFloat fontSize = (3 * MKRoadWidthAtZoomScale(zoomScale)); 

        UIFont *font = [UIFont fontWithName:@"Helvetica-Bold" size:fontSize];

        // Draw outlined text.
        CGContextSetTextDrawingMode(ctx, kCGTextStroke);
        // Make the thickness of the outline a function of the font size in use.
        CGContextSetLineWidth(ctx, fontSize/18);
        CGContextSetStrokeColorWithColor(ctx, [[UIColor blackColor] CGColor]);
        [t drawAtPoint:point withFont:font];
        CGContextRestoreGState(ctx);
       UIGraphicsPopContext(); 
```

我还有一个相应的 mapOverlay 来创建文本的矩形区域：

```
- (MKMapRect)boundingMapRect
{

MKMapRect bounds = MKMapRectMake(upperLeft.x, upperLeft.y-Z , 2000, 2000);

    return bounds;
} 
```

我需要文本的底线始终保持在同一水平。因此，我需要根据要绘制的文本大小更改上述代码中 Z 的值。

文本的大小取决于地图的**缩放比例**。**有没有知道地图的缩放比例？**这样我就可以计算文本的大小。

# javascript - Javascript 为什么 IE 不执行这段代码？

> ID：10558497
> 
> 赞同：2
> 
> 时间：2012-05-11T20:55:12.797
> 
> 标签：javascript, internet-explorer-8, closures

大家，我正在制作一个有菜单的网站（[http://euroscala.balkanium.com/](http://euroscala.balkanium.com/)），当您单击菜单项时，应该会出现一个缩略图列表。我正在尝试预加载所有应该出现的图像，然后显示它们。它适用于除 IE 之外的所有浏览器（我有版本 8）。我已经为愿意在这里查看的任何人整理了代码：http: [//jsfiddle.net/THpgM/2/](http://jsfiddle.net/THpgM/2/)

我认为问题在于这段代码（它靠近小提琴中第一个函数的底部）

```
img.onload = (function(i){ 
  // code here is executed

  return function(){
    // code here is not

    ++totalLoaded;
    document.getElementById("li" + i).style.height = this.height + "px";
    document.getElementById("li" + i).setAttribute("data-height", this.height);

    if(totalLoaded == totalThumbs){
      // do some stuff
    }
  };
})(i); 
```

我花了大约 2 天的时间试图弄清楚这一点。如果有人可以帮助我，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:54:42.700

在 IE 中，您必须在分配`.onload`之前分配处理程序`.src`。如果您不这样做，则 onload 事件可能会在您的 onload 处理程序到位之前触发，您将错过该事件。

```
// assign .onload before .src
img.onload = function() {};
img.src = "xxx.jpg"; 
```

如果图像在浏览器缓存中（因此它们在`.src`分配时立即加载）并且您的 onload 处理程序将永远不会执行，则 IE 中的特定问题将发生。

因此，在您的 jsFiddle 中，将分配移动到`.src`分配到`.onload`.

# ruby - 有人可以解释 Class.superclass.class.superclass 悖论吗？

> ID：10558504
> 
> 赞同：29
> 
> 时间：2012-05-11T20:55:53.297
> 
> 标签：ruby, metaprogramming

这可能根本不是一个悖论，但从新手的角度来看，确实是这样。

```
> Class.superclass
=> Module
> Class.superclass.class
=> Class
> Class.superclass.class.superclass
=> Module 
```

那么一个类的父类是模块，但模块是一个类？

我怎样才能理解这一点？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-05-12T03:57:05.883

TL;DR：模块是**类的超**类。模块是类**的一个实例**。

* * *

让我试着更清楚地解释它。请原谅我的手写绘图 - 我没有任何精美的绘图软件。

Ruby 中的每个类都有 1 个超类*。

![在此处输入图像描述](../Images/7688539d4e8b894a54d87bafd5fea362.png)

*BasicObject 除外，它没有超类。

像这样阅读上图：Float 的超类是 Numeric。Numeric 的超类是 Object 等...

当您实例化一个对象时，该对象将是某个类的一个实例。例如，“Nathan”是 String 类的一个实例。“乔”或“约翰”也是如此。1 是 Fixnum 类的一个实例，2、3、4 等也是如此……

![在此处输入图像描述](../Images/bef47573ba24d60a8d51ffc220b4239d.png)

像这样阅读上图：“Joe”是 String 的一个实例。1 是 Fixnum 的一个实例，等等……

嗯，在 Ruby 中，与大多数其他语言不同，Class 只是另一个类，它也可以被实例化，就像 Fixnum 或 String 一样。

![在此处输入图像描述](../Images/cbb298d40f88488ae16ef9a7230d9ecb.png)

像这样阅读上图：0.01 是 Fl​​oat 的一个实例。字符串是类的一个实例，等等......

意识到 Fixnum 是 Class 的一个实例，就像“Nathan”是 String 的一个实例一样。就像 "John" 是 String 的一个实例，Float 只是 Class 的一个实例。每个类都只是类的一个实例，甚至是类本身！

每当您在应用程序中编写一个新类时，您只是在实例化一个类为 Class 的新对象，就像 Hash.new 实例化一个新 Hash，或者“Nathan”实例化一个新 String 一样。

```
# By running this, you will be instantiating a new Class, and 
# it will be named Post 
class Post < ActiveRecord::Base
end

# Here is another perfectly valid way to write the above code:
Post = Class.new(ActiveRecord::Base)

# you can even instantiate a Class without giving it an explicit name:
x = Class.new(ActiveRecord::Base)

# and since your new things are classes, they can be instantiated
obj1 = Post.new
obj2 = x.new 
```

此外，Module 只是 Class 的另一个实例。每当您在应用程序中编写新模块时，您只是在实例化一个新模块。

```
# this will instantiate a new Module, and assign it to Foo
module Foo
end

# Here is another perfectly valid way to write the above code:
Foo = Module.new

# you can even instantiate a Module without giving it an explicit name.
m = Module.new 
```

顺便说一句：模块只是方法和常量的集合。类也是方法和常量的集合，但具有能够被实例化的附加功能。无法实例化模块。也就是说，`m.new`不会工作。

所以，回到上图，你的问题可以直接回答：

> 那么一个类的父类是模块，但模块是一个类？

从上图可以看出：Module 是Class**的超**类。

从下图中：模块是类**的一个实例**。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-11T21:17:15.277

*   [类扩展模块](http://www.ruby-doc.org/core-1.9.3/Class.html)。这在您的第一个和第三个示例中得到了证明。
*   [模块扩展对象](http://www.ruby-doc.org/core-1.9.3/Module.html)。
*   [对象扩展基本对象](http://www.ruby-doc.org/core-1.9.3/Object.html)
*   [BasicObject 是类层次结构的根](http://www.ruby-doc.org/core-1.9.3/BasicObject.html)

在您的第二个示例 Class.superclass.class 中，您调用的是 Module.class。Module是指一个类，Module类。

`AnyClass.superclass.class`将返回 Class，除了`BasicObject.superclass.class`

类和实例之间的区别很重要。BasicObject 是一个类。它是一个扩展 nil 的类，这是一种说它没有超类的奇特方式。它是树的根。一切都是对象，这是说一切都是某个类的实例的另一种说法。

字符串示例

```
"Nathan" is an object.
"Nathan" is an instance of the String class.
"Nathan" is not a class.
"Nathan" has no superclass, because "Nathan" is not a class.

String is an object.
String is an instance of the Class class.
String's superclass is Object.

Object is an object.
Object is an instance of the Class class.
Object's superclass is BasicObject.

BasicObject is an object.
BasicObject is an instance of the Class class
BasicObject's superclass is nil.

nil is an object.
nil is an instance of the NilClass class
nil has no superclass, because it is not a class. 
```

固定编号示例

```
1 is an object.
1 is an instance of the Fixnum class.
1 is not a class.
1 has no superclass, because it is not a class.

Fixnum is an object.
Fixnum is an instance of the Class class.
Fixnum's superclass is Integer.

Integer is an object.
Integer is an instance of the Class class
Integer's superclass is Numeric.

Numeric is an object.
Numeric is an instance of the Class class.
Numeric's superclass is Object.

# everything below here is in the above example.
Object is an object.
Object is an instance of the Class class.
Object's superclass is BasicObject.

BasicObject is an object.
BasicObject is an instance of the Class class
BasicObject's superclass is nil.

nil is an object.
nil is an instance of the NilClass class
nil has no superclass, because it is not a class. 
```

所以，最后：

```
Class is an object.
Class is an instance of the Class class. # this is probably the most important part.
Class's superclass is Module # 2nd most important part

Module is an object
Module is an instance of the Class class. # 3rd
Module's superclass is Object # 4th

# everything below here is in the above examples.
Object is an object.
Object is an instance of the Class class.
Object's superclass is BasicObject.

BasicObject is an object.
BasicObject is an instance of the Class class
BasicObject's superclass is nil.

nil is an object.
nil is an instance of the NilClass class
nil has no superclass, because it is not a class. 
```

表格形式：

![在此处输入图像描述](../Images/4cc0f4d131781ed4c57e04a875eed4bb.png)

如果你想验证这一切都是真的，你可以在 Ruby 中运行它

```
"Nathan".is_a?(BasicObject) # => true    "Nathan" is an object.
"Nathan".class #=> String                "Nathan" is an instance of the String class.
"Nathan".is_a?(Class) #=> false          "Nathan" is not a class.
"Nathan".superclass # NoMethodError      "Nathan" has no superclass, because "Nathan" is not a class.

String.is_a?(BasicObject) #=> true       String is an object.
String.class #=> Class                   String is an instance of the Class class.
String.superclass #=> Object             String's superclass is Object.

Object.is_a?(BasicObject) #=> true       Object is an object.
Object.class #=> Class                   Object is an instance of the Class class.
Object.superclass #=> BasicObject        Object's superclass is BasicObject.

BasicObject.is_a?(BasicObject) #=> true  BasicObject is an object.
BasicObject.class #=> Class              BasicObject is an instance of the Class class
BasicObject.superclass #=> nil           BasicObject's superclass is nil.

nil.is_a?(BasicObject) #=> true          nil is an object.
nil.class #=> NilClass                   nil is an instance of the NilClass class
nil.superclass # NoMethodError           nil has no superclass, because it is not a class. 
```

从类开始：

```
Class.is_a?(BasicObject) #=> true        Class is an object.
Class.class #=> Class                    Class is an instance of the Class class. # this is probably the most important part.
Class.superclass #=> Module              Class's superclass is Module # 2nd most important part

Module.is_a?(BasicObject) #=> true       Module is an object
Module.class #=> Class                   Module is an instance of the Class class. # 3rd
Module.superclass #=> Object             Module's superclass is Object # 4th

Object.is_a?(BasicObject) #=> true       Object is an object.
Object.class #=> Class                   Object is an instance of the Class class.
Object.superclass #=> BasicObject        Object's superclass is BasicObject.

BasicObject.is_a?(BasicObject) #=> true  BasicObject is an object.
BasicObject.class #=> Class              BasicObject is an instance of the Class class
BasicObject.superclass #=> nil           BasicObject's superclass is nil.

nil.is_a?(BasicObject) #=> true          nil is an object.
nil.class #=> NilClass                   nil is an instance of the NilClass class
nil.superclass # NoMethodError           nil has no superclass, because it is not a class. 
```

# scala - Scala 中“for (elm <- myList) yield f(_)”和“myList map f(_)”之间的区别

> ID：10558513
> 
> 赞同：3
> 
> 时间：2012-05-11T20:56:16.597
> 
> 标签：scala, functional-programming

为什么不同的行给出不同的返回值？

```
val tagIds = postData._1 map (TagTable.newTag(_))
// tagIds is defined as val tagIds: Array[Long] 
```

和

```
val tagIds = for(tag <- postData._1) yield TagTable.newTag(_)
// tagIds is defined as val tagIds: Array[models.UnsavedTag => Long] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:00:46.257

由于一个简单的打字错误：

```
val tagIds = for(tag <- postData._1) yield TagTable.newTag(tag)
                                                           ^^^ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:00:01.967

```
val tagIds = postData._1 map (TagTable.newTag(_)) 
```

此行表示获取`tag`集合中包含的每个项目`postData._1`并调用`TagTable.newTag(tag)`。然后，`tagIds`是一个包含所有这些调用结果的集合。

```
val tagIds = for(tag <- postData._1) yield TagTable.newTag(_) 
```

这一行表示对于`tag`集合中包含的每个项目`postData._1`，返回函数`TagTable.newTag(_)`（相当于函数`x => TagTable.newTag(x)`）。然后，`tagIds`是一个包含所有这些功能的集合。

基本上，您实际上并没有在第二个版本中调用该函数。将其更改为：

```
val tagIds = for(tag <- postData._1) yield TagTable.newTag(tag) 
```

# php - 这个 php 唯一 ID 生成器有问题吗？

> ID：10558524
> 
> 赞同：1
> 
> 时间：2012-05-11T20:57:04.293
> 
> 标签：php, code-generation, sha1

此代码是我计划用于生成门票唯一代码的代码。

```
// A prefix to avoid uniqid collisions (when invoking this function at the same time).
// Should I use mt_rand or just rand?
$prefix = str_pad(dechex(mt_rand(0, 0xFFFFFF)), 6, '0', STR_PAD_LEFT);

// uniqid with more entropy enabled.
$unique_id = uniqid("$prefix-", TRUE);

// A SHA-1 hash for the generated code, this way it looks less sequential.
$unique_id = sha1($unique_id); 
```

如果您能告诉我此代码中的问题，将会更有帮助。

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:19:03.343

这取决于要求，它必须是一个没人能猜到的超级秘密字符串吗？

如果没有，假设您也要将门票存储在数据库中，您可以使用`$unique_id = sha1(DATABASE_KEY);`：

```
echo sha1(1) . "\n";
echo sha1(2) . "\n";
echo sha1(3) . "\n"; 
```

[请参阅示例](http://codepad.org/xxucCVFy)。

现在你已经有了一个长而有趣的字符串，你甚至不需要存储它。

# sql-server - 我被困在使用枢轴函数来获得这个结果

> ID：10558526
> 
> 赞同：1
> 
> 时间：2012-05-11T20:57:28.603
> 
> 标签：sql-server

```
sDisplayName,sMonitorTypeDescription,sMonitorTypeName

黑色测试可访问性 Ping

BLACK 文件传输协议（FTP 服务器） FTP

黑色 TCP/IP 监视器 SSH

BLACK NT Service Monitor RPC 服务

黑色 WMI 监控磁盘 C：可用空间低于 2GB

```

我希望它看起来像：

```
sDisplayName、测试可访问性、文件传输协议（FTP 服务器）、TCP/IP 监视器、NT 服务监视器、WMI 监视器

```

数据为：

```
黑色 Ping NULL NULL NULL NULL NULL

黑色 NULL FTP NULL NULL NULL NULL

```

等等...

有人可以帮忙吗？

# php - SOAP + WSDL + PHP

> ID：10558529
> 
> 赞同：2
> 
> 时间：2012-05-11T20:57:31.903
> 
> 标签：php, xml, soap, wsdl

我需要一点帮助。我有以下两个网址：

WSDL：[https ://amsel.dpwn.net/abholportal/gw/lp/schema/1.0/var3ws.wsdl](https://amsel.dpwn.net/abholportal/gw/lp/schema/1.0/var3ws.wsdl)

端点：[https ://amsel.dpwn.net/abholportal/gw/lp/SoapConnector](https://amsel.dpwn.net/abholportal/gw/lp/SoapConnector)

现在我想向服务器发送如下内容：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:var="https://amsel.dpwn.net/abholportal/gw/lp/schema/1.0/var3bl">
<soapenv:Header>
   <wsse:Security soapenv:mustUnderstand="1"
   xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-      secext-1.0.xsd">
      <wsse:UsernameToken>
         <wsse:Username>ws_online_retoure</wsse:Username>
         <wsse:Password
         Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-tokenprofile1.0#
         PasswordText">Anfang1!</wsse:Password>
      </wsse:UsernameToken>
   </wsse:Security>
</soapenv:Header>
<soapenv:Body>
   <var:BookLabelRequest
   portalId="OnlineRetoure"
   deliveryName="Spanien_Var3"
   shipmentReference="ShipRef Nextt"
   customerReference="1.Feld via Webservice"
   labelFormat="PDF"
   senderName1="Willi Webservice"
   senderName2="via Webservice"
   senderCareOfName="careOfName"
   senderContactPhone="0800 123456"
   senderStreet="Webservice Street"
   senderStreetNumber="8080"
   senderBoxNumber="12"
   senderPostalCode="28010"
   senderCity="Madrid"/>
</soapenv:Body>
</soapenv:Envelope> 
```

我怎样才能在 PHP 中做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:37:57.600

由于有关如何将 SOAP 与 PHP 一起使用的示例很少，我也遇到了类似的问题。这里有几个示例可以指导您开发 SOAP 接口。

[http://bisqwit.iki.fi/story/howto/phpajaxsoap/#IsSoapTheBestWay](http://bisqwit.iki.fi/story/howto/phpajaxsoap/#IsSoapTheBestWay)

[http://geekswithblogs.net/THines01/archive/2010/03/07/callws.aspx](http://geekswithblogs.net/THines01/archive/2010/03/07/callws.aspx)

[http://jimmyzimmerman.com/2007/02/soap-server-with-php5-part-1.html](http://jimmyzimmerman.com/2007/02/soap-server-with-php5-part-1.html)

在我看来，对于许多目的而言，SOAP 显然是一种过度杀伤力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:08:14.160

请参阅[NuSoap](http://sourceforge.net/projects/nusoap/)。

它简化了 Web 服务和客户端的构建。

# javascript - 您如何查看哪个 Javascript 脚本生成了某个 html 行？

> ID：10558534
> 
> 赞同：3
> 
> 时间：2012-05-11T20:57:57.007
> 
> 标签：javascript, html, firebug

我有一些疯狂的应用程序通过操纵 DOM 几乎 100% 完成，但我发现自己处于更改其中某些内容的不幸位置。由于可能有大约 100 种不同的脚本可以做上帝知道的事情，所以我不知道应该在哪个文件中进行更改。所以，我想问一下，有没有办法（可能使用 Firebug 或类似的东西）知道特定的 html 片段是在哪里生成的？我是一名 C 开发人员，所以我不太擅长这个，这让我发疯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T00:08:40.157

所有元素是在页面加载时添加的，还是部分在对用户输入的响应中添加的？（点击等）

*   对于添加对您的操作的响应的内容，您可以使用“脚本”选项卡中的 Firebug 的“下一个中断”按钮。要激活 BON，您必须单击它，或者在[刚刚发布的 Firebug 1.10.0a8](http://getfirebug.com/releases/firebug/1.10/firebug-1.10.0a8.xpi)中，使用键盘快捷键 ALT-CTRL-B（当您将事件侦听器绑定到鼠标移动时很有用）。然后，当任何一段 JS 将被执行以响应您的点击等时，您将遇到一个断点。
*   对于在页面加载时添加的内容，您可以使用扩展本机函数的技巧（这听起来可能很疯狂 - 是的，不要在生产中这样做！）如[appendChild、insertBefore、replaceChild](https://developer.mozilla.org/en/DOM/element.appendChild)。**只需在主 HTML 文件的最顶部**插入适当的代码，这样下面的所有代码都将“看到”更改。[不幸的是，由于一个错误](https://bugzilla.mozilla.org/show_bug.cgi?id=618379)，这在 Firefox 中不起作用。但适用于 Opera，我猜也适用于 Chrome。当您扩展本机功能时，您可以在真正将节点添加到页面之前注入任何代码。例如，调用`console.log`或创建断点来检查当前页面状态。您可以尝试使用断点来查看这些函数中的可用变量属性，以调整您推送到 console.log 的内容。

对于此代码：

```
<!doctype html>
<html>
   <head>
      <script type="text/javascript">

      // this should work in Firefox but it does not -- https://bugzilla.mozilla.org/show_bug.cgi?id=618379
      // works at least in Opera, probably Chrome too
      Node.prototype._appendChild = Node.prototype.appendChild;
      Node.prototype.appendChild = function(child) {
         console.log("appending " + child + " to " + this);
         return this._appendChild(child); // call the original function with the original parameters
      }

      // this works in Firefox
      document._createElement = document.createElement;
      document.createElement = function(tagName){
         console.log("creating " + tagName);
         return this._createElement(tagName);
      }

      </script>
   </head>

   <body>
      <script type="text/javascript">
         var p = document.createElement("p");
         p.appendChild( document.createTextNode("abc"));
         document.body.appendChild(p);
      </script>
   </body>
</html> 
```

歌剧输出：

```
creating p                                                           appendChild.html:14
appending [object Text] to [object HTMLParagraphElement]             appendChild.html:7
appending [object HTMLParagraphElement] to [object HTMLBodyElement]  appendChild.html:7 
```

为了克服 Firefox 的弱点（你不能覆盖`appendChild`），你可以使用技巧：将下面的代码放在 HTML 的顶部

```
<script>
      Node.prototype._appendChild = function(child) {
         console.log("appending " + child + " to " + this);
         return this.appendChild(child)
      };
</script> 
```

然后，通过创建[自动响应器（WMV 教程，9.9 MB）来使用](http://www.fiddler2.com/fiddler/help/video/FiddlerAutoResponder.wmv)[Fiddler 代理](http://www.fiddler2.com/fiddler2/)，您可以在其中手动替换所有调用`.appendChild``._appendChild`（您可以使用 Notepad++ 来“在所有打开的文件中查找替换”）。创建自动响应和手动篡改请求可能很普通，但它非常强大。要快速创建自动回复规则，请在 Fiddler 处于活动状态时加载页面，然后如下图所示拖放文件。对于每个文件，右键单击并从菜单中选择“生成文件”（这会将文件放在桌面上）或自己在不同的位置创建文件。（最好打开 Fiddler 生成的文件并从中删除响应标头；顺便说一句，“生成文件”仅在响应标头为 200 时才放入真实内容，因此请确保使用 CTRL-F5 加载页面以跳过缓存）。

![提琴手](../Images/0fdf727f014c0676eda11d0ee1a7b8f3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:05:52.213

在 Chrome 中，您可以检查一个元素并右键单击它。此菜单为您提供了一些选项，可以在元素下方的某些内容发生更改或它自己的属性发生更改时中断。也许这些断点之一会找到您正在寻找的东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:53:42.347

假设您可以访问原始（希望未缩小/混淆）JS 文件，也许只是在它们中搜索与 DOM 操作和/或您要创建的节点的属性相关的文本字符串？我会尝试诸如“appendChild”“createElement”和节点的ID/类名之类的东西。

您还可以在整个脚本文件中设置断点，并在页面加载时单步执行它们以帮助您缩小查看范围。从一开始就“暂停” JS 执行并逐步执行可能会有所帮助。

*如果*您可以共享代码（指向实时站点的链接就可以了），我很乐意看一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:16:55.377

如果您在 javascript 中使用 jQuery 框架来进行 DOM 更改，那么您可能会在 firefox 浏览器中找到[用于 FireBug 的 fireQuery 插件](http://firequery.binaryage.com/)可能会为您提供所需的信息。

例子： ![在此处输入图像描述](../Images/0319c46e913f3a13c4b5a567f5fbbd25.png)

它通过将附加的 jquery 元素信息叠加到显示中来向标准 HTML 视图添加附加信息，以更深入地了解您的 javascript 如何修改页面内容。

我希望这可以帮助你。

# asp.net - 切换虚拟主机时出现 aspx 问题

> ID：10558537
> 
> 赞同：1
> 
> 时间：2012-05-11T20:58:13.807
> 
> 标签：asp.net

我的朋友有一个用 aspx 编写的网站（我不太了解）。

我们正在尝试切换他的网络主机。我们开设了一个新帐户（在一个支持我们需要的一切的虚拟主机站点中）并将所有文件按**原样**移动到新的虚拟主机。

现在我们得到一个：

**目录列表被拒绝**

**此虚拟目录不允许列出内容。**

我们做错了什么？除了将文件放入新的网络主机之外，我们还需要考虑什么...？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:11:10.827

如果可行，请尝试[http://yourwebsite.com/yourwebpage.aspx](http://yourwebsite.com/yourwebpage.aspx)，那么您的部署是正确的。现在您需要将默认页面设置为“yourwebpage.aspx”，正如 Brandon 已经评论的那样。不同的主机服务提供不同的方法来做到这一点。首先让我们知道[http://yourwebsite.com/yourwebpage.aspx](http://yourwebsite.com/yourwebpage.aspx)是否有效。还提供您的主机服务提供商名称将查看他们的文档并告诉如何设置默认页面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:57:01.480

听起来该网站可能一直在运行 url 重写模块，该模块需要服务器使用 Wildmapping 通过 asp.net 传递所有请求。 [http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)

根据您使用的 IIS 版本，有不同的处理方式。根据您的托管环境，对此也有限制。

几个可能有助于确定问题的问题

1.  以前的托管环境是共享的还是专用的/虚拟的
2.  以前的托管环境是 Windows 2003/IIS 6 还是 windows 2008/IIS 7
3.  新的托管环境是共享的还是专用的/虚拟的
4.  新的托管环境是 Windows 2003/IIS 6 还是 windows 2008/IIS 7

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:01:26.963

在应用程序可以运行之前，您需要指定该文件夹是一个 asp.net 应用程序。应该有办法通过您的控制面板执行此操作，如果没有联系供应商

# vba - VBA 宏在 32000 行后崩溃

> ID：10558540
> 
> 赞同：17
> 
> 时间：2012-05-11T20:58:24.187
> 
> 标签：vba, excel

我有一个 VBA 宏，它根据在 3 列中的单元格中查找值将行从一个工作表复制到另一个工作表。宏有效，但在到达第 32767 行时崩溃。此行中没有公式或特殊格式。此外，我已经删除了该行，但它仍然在该行号上崩溃。这是excel的限制吗？正在处理的工作表中有一些 43000

因此，我问我的宏有什么问题以及如何让它到达工作表的末尾：

```
Dim LSearchRow As Integer
Dim LCopyToRow As Integer
Dim wks As Worksheet
On Error GoTo Err_Execute 
```

对于工作表中的每个周

```
LSearchRow = 4
LCopyToRow = 4

ThisWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)
Set wksCopyTo = ActiveSheet
wks.Rows(3).EntireRow.Copy wksCopyTo.Rows(3)

While Len(wks.Range("A" & CStr(LSearchRow)).Value) > 0

    If wks.Range("AB" & CStr(LSearchRow)).Value = "Yes" And wks.Range("AK" & CStr(LSearchRow)).Value = "Yes" And wks.Range("BB" & CStr(LSearchRow)).Value = "Y" Then

        Rows(CStr(LSearchRow) & ":" & CStr(LSearchRow)).Select
        Selection.Copy

        wksCopyTo.Select
        wksCopyTo.Rows(CStr(LCopyToRow) & ":" & CStr(LCopyToRow)).Select
        wksCopyTo.Paste

        'Move counter to next row
        LCopyToRow = LCopyToRow + 1
        'Go back to Sheet1 to continue searching
        wks.Select
    End If
    LSearchRow = LSearchRow + 1
Wend

Application.CutCopyMode = False
Range("A3").Select
MsgBox "All matching data has been copied."
Next wks
    Exit Sub
Err_Execute:
    MsgBox "An error occurred." 
```

请帮忙！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-11T21:07:58.057

VBA 'Int' 类型是带符号的 16 位字段，因此它只能保存从 -32768 到 +32767 的值。将这些变量更改为“Long”，这是一个带符号的 32 位字段，可以保存从 -2147483648 到 +2147483647 的值。Excel应该足够了。;)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-11T21:28:22.330

这听起来像一个整数问题

> **Integer**和Long 数据类型都可以保存正值或负值。它们之间的区别在于它们的大小：整数变量的值可以在**-32,768 和 32,767**之间，而长变量的值可以在 -2,147,483,648 到 2,147,483,647 之间。

但是您使用的是哪个版本？因为：

> 传统上，VBA 程序员使用整数来保存小数字，因为它们需要更少的内存。然而，在最近的版本中，**VBA 将所有整数值转换为 Long 类型，即使它们被声明为 Integer 类型。**因此，使用整数变量不再具有性能优势；事实上，Long 变量可能会稍微快一些，因为 VBA 不必转换它们。

此信息直接来自[MSDN](http://msdn.microsoft.com/en-us/library/aa164754(v=office.10).aspx)

**更新**

也请阅读第一条评论！我以错误的方式解释了 MSDN 信息！

> 那是 MSDN 具有误导性：VBA 本身不会将 Integer 转换为 Long。在幕后，CPU 将整数转换为 long，进行算术运算，然后将得到的 long 转换回整数。所以 VBA 整数仍然不能容纳大于 32K 的数字 – [Charles Williams](https://stackoverflow.com/users/88173/charles-williams)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-12T16:06:05.903

您可以通过使用 For Each 而不是递增行来避免 Integer vs. Long 问题。For Each 通常更快，避免选择范围也是如此。这是一个例子：

```
Sub CopySheets()

    Dim shSource As Worksheet
    Dim shDest As Worksheet
    Dim rCell As Range
    Dim aSheets() As Worksheet
    Dim lShtCnt As Long
    Dim i As Long

    Const sDESTPREFIX As String = "dest_"

    On Error GoTo Err_Execute

    For Each shSource In ThisWorkbook.Worksheets
        lShtCnt = lShtCnt + 1
        ReDim Preserve aSheets(1 To lShtCnt)
        Set aSheets(lShtCnt) = shSource
    Next shSource

    For i = LBound(aSheets) To UBound(aSheets)
        Set shSource = aSheets(i)

        'Add a new sheet
        With ThisWorkbook
            Set shDest = .Worksheets.Add(, .Worksheets(.Worksheets.Count))
            shDest.Name = sDESTPREFIX & shSource.Name
        End With

        'copy header row
        shSource.Rows(3).Copy shDest.Rows(3)

        'loop through the cells in column a
        For Each rCell In shSource.Range("A4", shSource.Cells(shSource.Rows.Count, 1).End(xlUp)).Cells
            If Not IsEmpty(rCell.Value) And _
                rCell.Offset(0, 27).Value = "Yes" And _
                rCell.Offset(0, 36).Value = "Yes" And _
                rCell.Offset(0, 53).Value = "Yes" Then

                'copy the row
                rCell.EntireRow.Copy shDest.Range(rCell.Address).EntireRow
            End If
        Next rCell
    Next i

    MsgBox "All matching data has been copied."

Err_Exit:
    'do this stuff even if an error occurs
    On Error Resume Next
    Application.CutCopyMode = False
    Exit Sub

Err_Execute:
    MsgBox "An error occurred."
    Resume Err_Exit

End Sub 
```

# c# - @ .aspx 中的引用控件，但在相应的 aspx.cs 中找不到类

> ID：10558541
> 
> 赞同：0
> 
> 时间：2012-05-11T20:58:24.980
> 
> 标签：c#, asp.net

希望这个标题至少有一些意义。

我今天第一次摆弄 ASP.NET 和 C# - 遵循教程。我已经很轻松地做到了[这一点](http://asp.net-tutorials.com/user-controls/using/)；但是，当我尝试实施时：

```
<%@ Reference Control="~/UserInfoBoxControl.ascx" %> 
```

和

```
UserInfoBoxControl userInfoBoxControl = (UserInfoBoxControl)LoadControl("~/UserInfoBoxControl.ascx");
userInfoBoxControl.UserName = "John Doe";
userInfoBoxControl.UserAge = 78;
userInfoBoxControl.UserCountry = "Spain";
UserInfoBoxPH.Controls.Add(userInfoBoxControl); 
```

我明白了

```
The type or namespace name 'UserInfoBoxControl' could not be found... 
```

我的 Java 背景让我现在想用 '导入'这个控件类`using`，尽管我知道它`@ Reference`可以完成这项工作。我已经尝试通过删除教程前面的代码来进行一些基本的故障排除，但没有运气。从我在其他地方读到的内容来看，代码看起来一切都很好，所以我有点困惑并渴望在我的教程中继续前进:)

谢谢！

**编辑：**

我仍然处于这个障碍，所以我认为最终转储我所有的代码是最简单的：

[默认.aspx](http://pastebin.com/embed_iframe.php?i=CDsga2Rg)

[Default.aspx.cs](http://pastebin.com/embed_iframe.php?i=D1YqTPwK)（声明时出错`userInfoBoxControl`）

[用户信息框控件.ascx](http://pastebin.com/embed_iframe.php?i=RKnHsuGa)

[UserInfoBoxControl.ascx.cs](http://pastebin.com/embed_iframe.php?i=GFndPyJ1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:29:40.650

如果您正确声明了所有内容，那么您的代码应该可以工作。

[需要Register 指令](http://msdn.microsoft.com/en-us/library/c76dd5k1%28v=vs.100%29.aspx)来引用页面中的控件、用户控件等。

[Reference 指令](http://msdn.microsoft.com/en-us/library/w70c655a%28v=vs.100%29)，相反，“*指示另一个用户控件、页面源文件或位于某个虚拟路径的任意文件应动态编译并链接到当前的 ASP.NET 文件（网页、用户控件或母版页）声明了这个指令。”*

这只是一个猜测，但是您是否有可能在单个文件中声明了您的控制（即 C# 代码不在单独的文件中）并且您忘记了`@ Control`指令中的“className”属性？

**编辑**：我看过你的代码，问题是*文件*被命名为“UserInfoBoxControl”，但类的名称是`WebUserControl`：

```
public partial class WebUserControl : System.Web.UI.UserControl { 
```

您的`@Reference`指令正在导入*文件*“~/UserInfoBoxControl.ascx”，但类型名称是 WebUserControl。
试试这个，它应该编译：

```
WebUserControl userInfoBoxControl = (WebUserControl)LoadControl("~/UserInfoBoxControl.ascx"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:08:05.863

您将在页面指令中导入命名空间。您注册用户控件：

```
<%@ Register TagPrefix="uc1" TagName="UserInfoBox" Src="UserInfoBoxControl.ascx" %> 
```

编辑：（来自我的评论）引用命名空间 ASP：

```
using ASP; 
```

# jquery - 如果还没有，添加一个类（或属性）

> ID：10558542
> 
> 赞同：4
> 
> 时间：2012-05-11T20:58:36.353
> 
> 标签：jquery

如果该元素还没有该属性，我将如何向该元素添加该属性？

```
if (' this does not have class=selected') {

    $(this).addClass('selected');
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:59:25.293

```
if(!$(this).attr('name')) {
   $(this).attr('name', 'value');
} 
```

应该这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:01:59.097

如果您专门谈论课程，那么请继续添加它。如果它已经存在，则不会添加两次。

```
$(this).addClass('selected'); // will only add the class if it doesn't exist 
```

我怀疑对班级的第一次测试会更有效率。

***现场演示：http:*** [//jsfiddle.net/2sLd5/](http://jsfiddle.net/2sLd5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T20:59:51.843

jQuery 文档是你的朋友！:) [http://api.jquery.com/category/css/](http://api.jquery.com/category/css/)

您可能正在寻找 HasClass

[http://api.jquery.com/hasClass/](http://api.jquery.com/hasClass/)

```
$('#mydiv').hasClass('foo') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T21:13:29.820

您可以使用属性而不是选择器。这不仅适用于类，也适用于任何属性

```
if($('#elemid[class!="myclass"]').length) {
    $('#elemid').addClass('otherClass');
} 
```

当然，如前所述，如果您想添加您检查的类，只需添加它。这没有什么坏处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:15:09.550

在添加类之前，没有必要检查类是否已经存在。查看 jQuery 源代码（https://github.com/jquery/jquery/blob/master/src/attributes.js，搜索），如果该类已经存在`addClass`，则似乎什么都不做。`addClass`因此，没有必要先检查。

# c# - Java 到 C# - CallableStatement 转换

> ID：10558545
> 
> 赞同：2
> 
> 时间：2012-05-11T20:58:45.633
> 
> 标签：c#, java, .net, cubrid

嗨，我想了解如何将 java 代码转换为 C#，我阅读了一些关于 java 的教程，但我没有找到如何翻译这行代码的方法：

```
CallableStatement cstmt = con.prepareCall("?=CALL
cstmt.registerOutParameter(1, Types.JAVA_OBJECT);
cstmt.execute(); 
ResultSet rs = (ResultSet) cstmt.getObject(1); 
```

我尝试

```
 CUBRIDConnection con = new CUBRIDConnection(ConnectionString);
  CUBRIDCommand com = new CUBRIDCommand();
  com.CommandType = CommandType.StoredProcedure;
  com.Connection = con;
  com.CommandText = "call mySP();";
  com.Parameters.Add("?=p", CUBRIDDataType.CCI_U_TYPE_RESULTSET).Direction =
      ParameterDirection.Output;
  con.Open();
  DbDataReader df = com.ExecuteReader(CommandBehavior.SingleResult);
  //some stuff
  con.Close(); 
```

这不起作用，我该如何翻译？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:03:27.117

尝试这个

```
 SqlConnection con = new SqlConnection("your connection string");
    SqlCommand com = new SqlCommand();
    com.CommandType = CommandType.StoredProcedure;
    com.Connection = con;
    com.CommandText = "yourstoredprocedurename"; //no paranthesis or call key word just procedure name
    SqlParameter parameter = new SqlParameter("yourparametername", SqlDbType.Binary); //just parameter name no questionmark
    parameter.Direction= ParameterDirection.Output;
    com.Parameters.Add(parameter);
    con.Open();
    var df = com.ExecuteReader(CommandBehavior.SingleResult);
    //some stuff
    con.Close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:04:55.773

我概述了以下可以改进以帮助它工作的行：

```
SqlConnection con = new SqlConnection("ValidConnectionString");    

com.CommandText = "storedProcedureName"; // You need to give the command the actual SP name, call mySP(); is invalid.

com.Parameters.Add("@ParameterName", SqlDbType.Binary).Direction = ParameterDirection.Output; // Parameters are usually prefixed with @ParameterName (some people omit the @) however this is preference amongst developers. 
```

注意：您必须用您的 connectionString 替换“ValidConnectionString”（除非 ConnectionString 是保存此信息的变量）。如果不是，则连接字符串如下所示： `Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword;` 它将连接到 SQL Server 2008 数据库。对于其他连接字符串，请查看以下站点：

[http://www.connectionstrings.com/](http://www.connectionstrings.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T17:26:00.660

我使用以下方法解决它。

[http://www.cubrid.org/?mid=forum&category=195532&document_srl=358924](http://www.cubrid.org/?mid=forum&category=195532&document_srl=358924)

# javascript - 在 faye 客户端上禁用 websockets（使用 private_pub）

> ID：10558552
> 
> 赞同：0
> 
> 时间：2012-05-11T20:59:04.717
> 
> 标签：javascript, ruby-on-rails, websocket, faye

我正在使用 private_pub，它是 faye 的包装器

[https://github.com/ryanb/private_pub](https://github.com/ryanb/private_pub)

我不想在客户端禁用 websockets，所以 faye 会退回到轮询，因为我的生产环境不支持 websockets。

建议在faye网站上这样做：

> 对于某些应用程序，您可能需要从使用中排除某些传输。例如，您可能知道您的部署环境不支持 WebSocket，或者您有理由坚持轮询。在这种情况下，您可以像这样禁用传输：

`client.disable('websocket');`

[http://faye.jcoglan.com/browser.html](http://faye.jcoglan.com/browser.html)

我尝试修改 private_pub.js 代码以在创建时禁用 websocket：

```
self.fayeClient = new Faye.Client(self.subscriptions.server);
self.fayeClient.disable('websocket'); // my modification 
```

但我收到此错误：TypeError: Object # has no method 'disable'

我很确定站点示例中的“客户端”与我的客户端类型相同，因为在站点的前面显示了此代码：`var client = new Faye.Client('http://localhost:8000/faye');`，就像我的代码中的 self.fayeClient 是如何创建的一样。

我对网站中的示例不了解吗？或者我应该如何禁用 websockets 以便我的 faye 客户端使用轮询而不是 websockets？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T07:54:22.153

看来这解决了问题： `Faye.Transport.WebSocket.isUsable = function(_,c) { c(false) }`. 在这里找到了解决方案： [http ://groups.google.com/group/faye-users/browse_thread/thread/14447dae9f75afab](http://groups.google.com/group/faye-users/browse_thread/thread/14447dae9f75afab)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:01:49.663

你试过吗

```
client.disable('websocket'); 
```

var 客户端等于 faye 客户端，但是你使用 self.fayeClient 作为对象

# c# - 使用 Prism、MVVM、Unity 查看切换导航

> ID：10558557
> 
> 赞同：3
> 
> 时间：2012-05-11T20:59:37.920
> 
> 标签：c#, mvvm, navigation, prism, unity-container

```
container.RegisterType<object, LabStatusView>("LabStatusView");
Uri LabStatusViewUri = new Uri("pack://application:,,,/LabStatus;component/LabStatusView.xaml",     
UriKind.Absolute);
regionManager.RequestNavigate("HorizonNavigatorView",LabStatusViewUri,NavigationCompleted); 
```

我正在使用它导航到 LabStatusView，这看起来很简单。

执行 requestNavigate 后的 ObjectStates：

1.  regionManager.Regions.ActiveRegion 包含一个“对象”类型的对象，而不是 LabStatusView。
2.  我知道使用 Unity 的唯一怪癖是我使用 RegiterType 方法的重载注册了我的类型。

有什么建议我在这里做错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T11:32:25.273

导航比在您的代码中要容易得多。这是我为一个项目所做的。

```
//Register your View on Startup
container.RegisterType<object, LabStatusView>("LabStatusView");

//Navigation works like this
var labStatusView = new Uri("LabStatusView", UriKind.Relative);
regionManager.RequestNavigate("HorizonNavigatorView", labStatusView); 
```

你可以这样试试吗？

许多人也使用静态类作为他们的区域和视图名称以避免“魔术字符串”。像这样的东西。

```
public class RegionNames
{
  public const string HorizonNavigatorView = "HorizonNavigatorView";
}
public class ViewNames
{
  public const string LabStatusView = "LabStatusView";
} 
```

# python - 带条件的字典理解

> ID：10558567
> 
> 赞同：3
> 
> 时间：2012-05-11T21:00:06.807
> 
> 标签：python, python-2.7, dictionary-comprehension

所以我想知道是否有人可以帮助我解决我遇到的这个问题。

假设我有一本字典：

```
d = {1: {2: 3}, 4: 5} 
```

我想创建任何包含字典的字典：

```
wanted_result = {2: 3} 
```

我正在尝试的是：

```
e = {inner_key: d[key][inner_key] for key in d.keys() for inner_key in d[key].keys() if isinstance(d[key], dict)} 
```

然而，这导致我得到一个错误，说整数没有键，我知道，但我认为我的条件会从我的例子中排除说 4 被包含在理解中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T21:21:44.050

```
d = {1: {2: 3}, 4: 5, 6: {7: 8}}
s = {k: v for elem in d.values() if type(elem) is dict for k, v in elem.items()}
>> {2: 3, 7: 8} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:08:00.677

在这种情况下，我会向您推荐一个 for 循环和[`update`](http://docs.python.org/library/stdtypes.html#dict.update)方法：

```
d = {1: {2: 3}, 4: 5, 6: {7: 8}}
inner_dicts = {}
for val in d.values():
    if type(val) is dict:
        inner_dicts.update(val)
print inner_dicts
# {2: 3, 7: 8} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:15:11.767

我的第一个想法是这样的：

```
d = {1: {2: 3}, 4: 5, 6: {7: 8}}
generator = (x.items() for x in d.itervalues() if type(x) == dict)
s = dict(sum( generator, list() )) 
# s = {2: 3, 7: 8} 
```

但是，为了避免让 `sum()`构建一个大型临时列表，您`items()`可以使用[itertools.chain](http://docs.python.org/library/itertools.html#itertools.chain)`iteritems()`代替：

```
# chain "concatenates" iterables
from itertools import chain
d = {1: {2: 3}, 4: 5, 6: {7: 8}}
s = dict(chain( *(x.iteritems() for x in d.itervalues() if type(x) == dict) ))
# s = {2: 3, 7: 8} 
```

您应该注意边缘情况。特别是如果部分字典中有相同的键，它们必然会以某种方式崩溃。

* * *

如果您还想支持`dict`从您的 中收集 的子类`d.values()`，您可能确实想使用`isinstance`代替`type`。有关详细信息，请参阅[此问题](https://stackoverflow.com/q/1549801/1025391)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T21:09:29.703

以下列表推导将返回每个作为 dict 的值：

```
>>> d = {1: {2: 3}, 4: 5}
>>> [d[i] for i in d.keys() if isinstance(d[i],dict)]
[{2: 3}] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T21:11:20.030

```
d = {1: {2: 3}, 4: 5,'j':{7:8}}
e={y:d[x][y] for x in d if isinstance(d[x],dict) for y in d[x]}
print(e)

{2: 3, 7: 8} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T08:29:03.690

使用 lambda 的其他方式

`(lambda x: {k:v for x in d.values() if type(x) == dict for k,v in x.items()})(d)`

# iphone - iOS 在后台监控用户位置。

> ID：10558569
> 
> 赞同：0
> 
> 时间：2012-05-11T21:00:18.747
> 
> 标签：iphone, objective-c, ios, core-location

我在这里阅读了许多帖子，这些帖子可以在应用程序处于后台时获取位置更新。

我的问题是我可以在多大程度上在后台进行计算，我会像处理任何其他代码一样处理它，即只是一个方法调用等。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:05:44.137

这是可能的，是的。您在 Info.plist 中设置“位置”UIBackgroundModes 标志，然后调用位置管理器。

请参阅[应用程序状态和多任务处理](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

您可以在应用程序在后台运行时进行计算，尽管您会冒着耗尽设备电池的风险。最好只响应位置事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:06:37.387

Apple 文档非常清楚您的应用程序在后台可以做什么。当您的应用程序处于后台时，您无法做任何您想做的事情——您只能做一些事情（即播放音频、跟踪用户位置等）。

查看[后台执行和多任务处理](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)。

# php - 这种从数据库中选择随机记录的方法有什么缺陷吗？

> ID：10558576
> 
> 赞同：2
> 
> 时间：2012-05-11T21:01:04.747
> 
> 标签：php, mysql, performance, algorithm

我有一个数据库表，里面有大约 30k 条记录。

我想一次随机选择一条记录（当用户要求时），从表中删除记录，然后将其插入另一个表中。

我听说/发现做起来`ORDER BY RAND()`可能很慢。所以我使用这个算法（伪代码）：

```
lowest = getLowestId(); //get lowest primary key id from table
highest = getHighestId(); //get highest primary key id from table

do
{
    id = rand(lowest, highest); //get random number between a range of lowest id and highest id
    idExists = checkIfRandomIdExists( id );
}
while (! idExists);

row = getRow (id);
process(row);
delete(id); 
```

现在，有 30k 条记录，我似乎很快就得到了随机 id。然而，随着表大小减少到 15k、10k、5k、100 等（可能是几个月），我担心这可能会开始变慢。

我可以做些什么来使这种方法更有效，还是有一个行数我应该开始做`ORDER BY RAND()`而不是这种方法？（例如，当剩下 5k 行时，开始 ORDER BY RAND() ？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:08:10.333

您可以使用该方法获得一个随机 ID，但不是检查它是否存在，而是尝试获取最接近的 ID？

```
SELECT * FROM table WHERE id >= $randomId ORDER BY id LIMIT 0,1 
```

然后，如果失败，请选择较低的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:11:47.810

一种方法可能是确定记录数并按记录选择：

```
select floor(count(*) * rand()) from thetable; 
```

在限制中使用生成的记录号（例如`chosenrec`）：

```
select * from thetable limit chosenrec, 1; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T21:13:55.080

我可能会在单独的表格中推荐[Fisher-Yates Shuffle 。](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)要生成它，请创建如下表：

```
CREATE TABLE Shuffle
(
    SequentialId INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    OtherTableId INT NOT NULL
) 
```

值得注意的是，不要打扰外键约束。例如，在 SQL Server 中，我会说使用 ; 添加外键约束`ON DELETE CASCADE`。如果你有一个可以在 MySQL 中使用的存储引擎，那就去吧。

现在，使用您选择的语言：

1.  获取另一个表中所有 ID 的数组（如评论中建议的@Truth）。
2.  使用 Fisher-Yates 对这些 id 进行洗牌（需要线性时间）。
3.  按顺序将它们插入`Shuffle`表中。

现在，你有一个随机顺序，所以你可以只`INNER JOIN`到`Shuffle`表中，然后`ORDER BY Shuffle.SequentialId`找到第一条记录。`Shuffle`如果您没有办法，您可以手动删除记录`ON DELETE CASCADE`。

# c - 重复错误：C 文件包含

> ID：10558578
> 
> 赞同：0
> 
> 时间：2012-05-11T21:01:19.600
> 
> 标签：c

我的问题之一是关于如何避免出现重复错误，因为我对 C 很陌生。基本上，当我在 Netbeans 中构建项目时，如果我在项目中有文件并且还包含它，我会收到该错误。

定义静态函数，是避免它的正确方法吗？还有哪些其他解决方案？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:03:38.583

`.c`/`.cpp`文件不应包含在内。

将声明移动到一个公共头文件并包含它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:18:52.987

正如 K. Horvath 所说，您不应该将一个 c 文件包含在另一个文件中。这意味着您必须为每个 .c 提供一个 .h，将 .c 文件编译为目标文件，然后根据需要包含 .h 文件并将所有对象与包含 .c 的 .c 一起编译`main()`。但是，您仍然可以在 .h 声明中出现重复，这就是**包含守卫**的用武之地。

```
#ifndef MY_HEADER
#define MY_HEADER

// all your type definitions, function prototypes, etc

#endif 
```

**WRT 首先编译每个 .c，这是gcc**的一个示例：您有一个 util.c 文件，其中包含要在 main.c 中使用的各种功能；然后 util.c 应该`#include`在 main.c 中有一个对应的 util.h。然后：

```
gcc -Wall -g -c util.c 
```

“-Wall”启用编译器警告

“-g”包括调试器符号

“-c”将生成一个.o（未链接的中间对象）文件而不是普通的可执行文件。

现在：

```
gcc -Wall -g util.o main.c 
```

这会编译 main.c 并包含 util.c 中编译成 util.o 的内容。

由于您使用的是 netbeans，这可能是理论上的——通常 IDE 会为您完成所有这些工作。但是，了解基本过程可能会更容易理解您的 IDE ;)

# sql - 生成动态数据以填充表格

> ID：10558579
> 
> 赞同：0
> 
> 时间：2012-05-11T21:01:22.373
> 
> 标签：sql, postgresql

假设我有下表：

> | 鳕鱼 | 姓名
> 
> | 0 |
> 
> | 1 |
> 
> | 2 |
> 
> | 3 |
> 
> | 4 |

我想要的是用“名称”+ Cod 填充名称列，如下所示：

> | 鳕鱼 | 姓名
> 
> | 0 | 名称0
> 
> | 1 | 名称1
> 
> | 2 | 名称2
> 
> | 3 | 名称3
> 
> | 4 | 名称4

是为了测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:03:01.823

```
SELECT "Cod", 'Name'||CAST("Cod" AS varchar) AS "Name"
  FROM table; 
```

如果您已经有 column `Name`，只需更新：

```
UPDATE table SET "Name" = 'Name'||CAST("Cod" AS varchar); 
```

注意，如果你想保持它们原样（大写），你必须用双引号括起来，否则它们都会被 PostgreSQL 转换为小写。

# glassfish - Glassfish 消息驱动的 bean 消息大小

> ID：10558582
> 
> 赞同：2
> 
> 时间：2012-05-11T21:01:34.780
> 
> 标签：glassfish, glassfish-3, message-driven-bean

我试图在我的 webapp 中使用消息驱动的 bean，但每次它都会抛出这个异常：

```
com.sun.messaging.jmq.jmsserver.util.BrokerException: [B4122]: Can not add message 1-127.0.1.1(b0:1a:c1:66:46:a9)-1-1336769823653 to destination PhysicalQueue [Queue]. The message size of 24968685 bytes is larger than the destination individual message byte limit (maxBytesPerMsg) of 10485760 bytes. 
```

经过一番研究，我发现默认限制是`-1`，所以它必须是无限的。

我在 Glassfish 的管理控制台中到处查看，但没有找到消除此限制的方法。甚至“新 JMS 资源”向导也不会询问有关此参数的任何内容。

有什么办法可以解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:17:51.417

为什么你的消息这么大？您可能需要重新考虑如何执行此操作。

……

您可以通过[imqcmd](http://docs.oracle.com/cd/E19798-01/821-1794/aeoes/index.html)命令对其进行更新。您要更改的值是 MaxBytesPerMsg。

来自[SunGlassFish MessageQueue 4.4 Administration Guide](http://www.filibeto.org/~aduritz/truetrue/glassfish/3/821-0027.pdf)或[4.2 guide](http://docs.oracle.com/cd/E19798-01/821-1794/aeoes/index.html)。

**更新物理目标属性**

子命令 imqcmd update dst 更改物理目标的指定属性的值：

```
imqcmd update dst -t destType -n destName
                   -o property1=value1 [ [-o property2=value2] ... ] 
```

要更新的属性可以包括表 18–1 中列出的任何属性（除了 isLocalOnly 属性，一旦创建目标就无法更改）。

例如，以下命令将队列目标 curlyQueue 的 maxBytesPerMsg 属性更改为 1000，将 maxNumMsgs 属性更改为 2000：

```
imqcmd update dst -t q -n curlyQueue -u admin
                  -o maxBytesPerMsg=1000
                  -o maxNumMsgs=2000 
```

# css - CSS 背景不会重置。它闹鬼

> ID：10558584
> 
> 赞同：0
> 
> 时间：2012-05-11T21:01:35.493
> 
> 标签：css, background

我根本无法解释这一点，但我已经在我的网站上放置了一个主题选择器。更改站点使用的 CSS 的 javascript 下拉框。

主题 7 是一个在背景中有灯光图像的主题。我不认为它与其余部分一起使用，所以我使用主机上的 cPanel 将其更改为不同的图像，点击保存，它像任何其他文件一样保存和更改。

我多次刷新以获取更改，并向下滚动到主题 7 以查看新图像的外观。

和以前一样的图像。

我尝试了一个新图像。一样。

....我完全删除了行背景图像，然后退出浏览器并重新启动它。

灯还在。

到底是怎么回事？？？我正在使用 Chrome 顺便说一句。在 Safari 中，图像只是纯黑色。我想我偶然发现了一张被诅咒的照片。

这是CSS

```
body {
    font-family: Calibri, Arial;
    text-align:center; 

    */background-repeat:repeat-y;
    background-size: 100%;*/

    }

input {
    padding: 3px; 
    font-size: 22px;
    }

select {
    padding: 4px;
    }

/*-----CLASSES-------*/

More stuff here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:12:38.793

尝试按`ctrl+r`清除 Chrome 的缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:13:36.160

它可能缓存了您之前在浏览器中使用的 css（也可能缓存了图像？）这是唯一有意义的答案。您可以通过更改对文件 my-styles.css?abcdefghijkl 的调用来强制清除浏览器的 css 缓存（或从您加载样式的任何位置）......但手动清除缓存也会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:21:21.093

您可能想要合并一个动态缓存控制...每次您使用 javascript 更改主题时，让它更改或重新加载缓存，这样您的用户就不必在更改主题时不断清除自己的缓存文件...根据您使用的服务器，您可以使用 php 和 .htaccess 或 .NET 和 web.config 执行此操作，我不确定是否有办法直接使用 javascript 执行此操作..？

# python - pytest 自动化显然在测试收集阶段运行测试

> ID：10558590
> 
> 赞同：1
> 
> 时间：2012-05-11T21:02:02.927
> 
> 标签：python, selenium, pytest

使用 pytest 和 selenium 运行 webui 自动化测试；有一个问题，我的测试似乎在*收集*阶段实际上正在运行。在这个阶段，我希望 pytest 能够收集测试——而不是运行它们。最终结果是我得到了 6 个测试结果，而我预计是 2 个。现在有趣的是，这 6 个结果只出现在 HTML 报告中；在命令行上，我只得到预期的 2 行输出（但运行这两个测试需要 300 秒，因为测试实际上是多次运行）。

测试/test_datadriven.py

```
#!/usr/bin/env python
from unittestzero import Assert
from pages.home import Home
from pages.administration import RolesTab
from api.api import ApiTasks
import time
import pytest

from data.datadrv import *

class TestRolesDataDriven(object):
    scenarios = [scenario1,scenario2]

    @pytest.mark.challenge
    def test_datadriven_rbac(self, mozwebqa, org, perm_name, resource, verbs, allowed, disallowed):
        """
Perform a data driven test related to role based access controls.
All parameters are fullfilled by the data.
:param org: Organization Name
:param perm_name: Permission name
:param resource: Resource
:param verbs: A tuple of verbs
:returns: Pass or Fail for the test
"""

        sysapi = ApiTasks(mozwebqa)
        home_page = Home(mozwebqa)
        rolestab = RolesTab(mozwebqa)

        role_name = "role_%s" % (home_page.random_string())
        perm_name = "perm_%s" % (home_page.random_string())
        username = "user%s" % home_page.random_string()
        email = username + "@example.com"
        password = "redhat%s" % (home_page.random_string())

        sysapi.create_org(org)
        sysapi.create_user(username, password, email)

        home_page.login()

        home_page.tabs.click_tab("administration_tab")
        home_page.tabs.click_tab("roles_administration")
        home_page.click_new()
        rolestab.create_new_role(role_name)

        rolestab.click_role_permissions()

        rolestab.role_org(org).click()
        rolestab.click_add_permission()

        rolestab.select_resource_type(resource)
        home_page.click_next()
        for v in verbs:
            home_page.select('verbs', v)
        home_page.click_next()

        rolestab.enter_permission_name(perm_name)
        rolestab.enter_permission_desc('Added by QE test.')
        rolestab.click_permission_done()

        rolestab.click_root_roles()
        rolestab.click_role_users()

        rolestab.role_user(username).add_user()

        home_page.header.click_logout()
        home_page.login(username, password)

        for t in allowed:
            Assert.true(t(home_page))

        for t in disallowed:
            Assert.false(t(home_page)) 
```

数据/data.py

```
###
# DO NOT EDIT HERE
###

def pytest_generate_tests(metafunc):
    """
Parse the data provided in scenarios.
"""
    idlist = []
    argvalues = []
    for scenario in metafunc.cls.scenarios:
        idlist.append(scenario[0])
        items = scenario[1].items()
        argnames = [x[0] for x in items]
        argvalues.append(([x[1] for x in items]))
    metafunc.parametrize(argnames, argvalues, ids=idlist)
###
# EDIT BELOW
# ADD NEW SCENARIOS
###

scenario1 = ('ACME_Manage_Keys', { 'org': 'ACME_Corporation',
                                   'perm_name': 'ManageAcmeCorp',
                                   'resource': 'activation_keys',
                                   'verbs': ('manage_all',),
                                   'allowed': (Base.is_system_tab_visible,
                                               Base.is_new_key_visible,
                                               Base.is_activation_key_name_editable),
                                   'disallowed': (Base.is_dashboard_subs_visible,)})
scenario2 = ('Global_Read_Only', { 'org': 'Global Permissions',
                                   'perm_name': 'ReadOnlyGlobal',
                                   'resource': 'organizations',
                                   'verbs': ('read','create'),
                                   'allowed': (Base.is_organizations_tab_visible,
                                               Base.is_new_organization_visible,
                                               Base.is_new_organization_name_field_editable),
                                   'disallowed': (Base.is_system_tab_visible,
                                                  Base.is_new_key_visible)}) 
```

完整源代码可在 github 获得；[https://github.com/eanxgeek/katello_challenge](https://github.com/eanxgeek/katello_challenge)

有人知道这里可能发生什么吗？我正在使用 pytest-mozwebqa 插件、pytests 和 selenium。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T20:47:27.190

检查您已安装的 pytest-mozwebqa 的版本。如果您安装的版本 < 0.10，那么您必须更新。

```
pip-python install --upgrade pytest-mozwebqa 
```

由于 pytest-mozwebqa 中的更改数量，我强烈建议您首先在 python virtualenv 中进行测试。

# git - Git 工作流程：单个工作站连接到具有多个用户的实验硬件

> ID：10558597
> 
> 赞同：1
> 
> 时间：2012-05-11T21:02:43.933
> 
> 标签：git, github

我有几个托管在 GitHub 上的 git 存储库，其中的代码用于控制某些特定的实验硬件。所以我经常遇到这种情况：

*   我和其他一些人拥有存储库的个人克隆/分支，用于在我们的笔记本电脑上进行开发工作。
*   连接到实验硬件的工作站具有我们用于调试和实验工作的存储库的克隆。

理想情况下，所有开发都将在我们的笔记本电脑上完成，工作站副本将是只读的，但这根本行不通。无论您多么努力，总是有需要在实验工作站上解决的错误。然后它变得棘手，因为，比如说，我可能是克隆存储库的人，因为我是设置它的人，但也许我的同事坐下来处理硬件并且必须进行一些更改。然后当他提交并推动时，它看起来像是来自我。这并不可怕，但它只是不*觉得*害怕。我认为理想情况下我希望能够使用分叉和拉取请求来强制进行一定数量的代码审查。

我的问题是，还有其他人有这种工作流程的经验吗？你是怎么做到的？或者也许有人对如何管理它有很好的建议？

我们通常不会在实验工作站上使用单独的用户帐户，因为太多的设置是特定于硬件的。相反，工作站只有一个每个人都使用的“实验室”登录。

我的一个想法是为实验室创建一个 GitHub 帐户，在工作站上使用它，并指望每个人都签署他们的提交。（我们已经有一个实验室“组织”帐户，我的意思是一个可以创建/提交回购的实际帐户。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:52:17.227

在您的第一个模型中，您没有分叉，只有克隆（请参阅“ [Git fork is git clone?](https://stackoverflow.com/a/6286877/6309) ”）

从一个克隆中，您可以作为单独的用户推送。
你只需要：

*   正确的 .netrc（每个用户一个），其中包含正确的 GitHub 凭据：请参阅“ [Git - 如何`.netrc`在 Windows 上使用文件来保存用户和密码](https://stackoverflow.com/a/6031266/6309)”
*   正确的本地 Git 配置（`config.user`和`config.email`）

现在，如果该设置不实用（因为涉及`.netrc`和`git config`管理），那么是的，注册提交是可能的：请参阅“ [Is there a way to “autosign” commits in Git with a GPG key？](https://stackoverflow.com/a/10166916/6309) ”，除了签署*标签*你会推送[比签署所有个人提交更好](http://git.661346.n2.nabble.com/GPG-signing-for-git-commit-tp2582986p2583316.html)。

拥有*分叉*（而不仅仅是一个 GitHub 存储库的本地克隆）可以是一种在 GitHub 存储库之间更好地分离关注点的方法（一个专用于开发，一个用于集成到 ' `experimental`'）。
拉取请求意味着更可控的集成。

# javascript - Youtube Javascript API：在 IE 中不起作用

> ID：10558598
> 
> 赞同：1
> 
> 时间：2012-05-11T21:02:44.070
> 
> 标签：javascript, internet-explorer, youtube

我有一个嵌入的 Youtube 视频，我想在用户暂停视频、跳过等时捕获事件。按照谷歌文档 ( [http://developers.google.com/youtube/js_api_reference](http://developers.google.com/youtube/js_api_reference) ) 中的示例，我执行下列的：

```
var video = (my video ID here);
var params = { allowScriptAccess: "always" };
var atts = { id: "youtubeplayer" };
var x = 854;
var y = 480;
swfobject.embedSWF("http://www.youtube.com/v/" + video + "?enablejsapi=1&playerapiid=ytplayer&version=3", "bobina", x, y, "8", null, null, params, atts);

function onYouTubePlayerReady(playerId) {
      youtubeplayer = document.getElementById('youtubeplayer');
      youtubeplayer.addEventListener("onStateChange", "onytplayerStateChange");
      youtubeplayer.setPlaybackQuality('large');
      }

function onytplayerStateChange(newState) {
    //Make it autoplay on page load
    if (newState == -1) {
        youtubeplayer.playVideo();
        }

    var tiempo=youtubeplayer.getCurrentTime();
    //Rounds to 2 decimals
    var tiempo = Math.round(tiempo*100)/100;
    alert(tiempo);
    } 
```

现在，这一切都在 Firefox 和 Safari 中完美运行，但无法在 IE8 中运行（我的意思是：视频加载，但未捕获事件：永远不会调用事件处理程序）。根据[javascript addEventListener onStateChange not working in IE](https://stackoverflow.com/questions/2885500/javascript-addeventlistener-onstatechange-not-working-in-ie)，IE 不支持 addEventListener()，所以我尝试将该行替换为：

```
youtubeplayer.attachEvent("onStateChange", onytplayerStateChange); 
```

但它也不起作用。（该问题的作者说他最终通过将“onComplete 放入我的颜色框并将 swfobject 放入其中”来解决它，但我在这里没有使用颜色框（我什至不知道那是什么），所以我不明白他的意思。

使用 alerts() 进行调试，我看到第一个函数 (onYoutubePlayerReady()) 确实被调用了，但我什至无法判断事件侦听器是否没有被注册或者它是否是 getElementById() 不起作用; 我尝试通过添加以下内容进行调试：

```
alert(typeof youtubeplayer); 
```

就在它之后，但它甚至没有弹出。

哦，还有一件事：视频在 Firefox 和 Safari 中自动启动，但在 IE 中也不会。（是的，我在服务器上运行它，而不是在本地页面上）。

有人有什么想法吗？我真的不知道还能尝试什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T14:03:23.593

好的，找到了解决方案。猜猜那是什么？只写如下：

```
var youtubeplayer = document.getElementById('youtubeplayer'); 
```

它在 IE 8 中完美运行。它所需要的只是“var”关键字。

以防万一它对其他有同样问题的人有用......

# regex - 如何使这个 sed“在 2 个关键字之间抓取文本”不区分大小写？

> ID：10558605
> 
> 赞同：3
> 
> 时间：2012-05-11T21:03:33.697
> 
> 标签：regex, bash, sed, match

**测试.txt**

```
Welcome notice
------------------------
Hello there, welcome! Foo

hello

world

Bar
Yes!
Foo

How are ya?!

Bar

Have a great day! 
```

**sed - 抓取文本**

```
$ sed -n '/Foo/,/Bar/p' test.txt 
```

**输出**

```
Hello there, welcome! Foo

hello

world

Bar
Foo

How are ya?!

Bar 
```

如何使这个不区分大小写？例如，说 'FOO' 或 'bAr' 将匹配 sed 的匹配模式？我试过用“我”，没有运气。这应该是一个快速的，谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:09:37.743

如果您的 sed 支持它，您可以使用 I ...

```
sed -n '/Foo/I,/Bar/Ip' text.txt 
```

如果没有，你将不得不做类似的事情

```
sed -n '/[fF][oO][oO]/,/[bB][aA][rR]/p' text.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:08:48.000

`sed -n '/Foo/,/Bar/Ip' test.txt`

# unit-testing - 使用 NBuilder 测试 NHibernate 映射

> ID：10558613
> 
> 赞同：0
> 
> 时间：2012-05-11T21:04:13.387
> 
> 标签：unit-testing, nhibernate, fluent-nhibernate, nhibernate-mapping, nbuilder

我在单元测试中使用 NBuilder 来模拟内存数据已经有一段时间了，它很棒，然后我想用它来测试我的 NHibernate 映射，我认为它会是透明的，但我不知道我是什么做错了=（它根本不起作用

我计划大量测试我的 NHibernate 映射，但由于我有太多实体，我不想手动填充数据，这是我想使用 NBuilder 的主要原因

作为快速参考：

```
 autoConfig.Override<Planet>(x =>
        {
            x.References(y => y.Sun).Cascade.SaveUpdate().Column("Star_id");
        });
        autoConfig.Override<Star>(y =>
        {
            y.HasMany(x => x.Planets).Inverse().Cascade.AllDeleteOrphan();
        }); 
```

（如果您需要，我可以提供有关实体和映射的信息，但我认为它们是正确的，因为我可以在手动填充数据时保存我的实体）

手动：

```
using (var session = factory.OpenSession())
using (var tran = session.BeginTransaction())
{
   var star = new Star { Class = StarTypes.B, Color = SurfaceColor.Red, Mass = 323.43, Name = "fu..nny star" };
   star.Planets = new List<Planet>
   {
      new Planet { IsHabitable = true, Name = "my pla", Sun = star }
   };
   session.Save(star);
   tran.Commit();
} 
```

上面的代码实际上可以正确地将两个实体保存到数据库中，这意味着我的映射是正确的，但现在我想使用 NBuilder 自动填充测试数据，如下所示：

```
var star = Builder<Star>.CreateNew().Build();
star.Planets = Builder<Planet>.CreateListOfSize(10).All().With(x => x.Sun, star).Build();
session.Save(star);
tran.Commit(); 
```

在调试时检查生成的实体对我来说是正确的，我可以毫无问题地浏览它们，但是当我想提交事务时，我收到以下错误：

**行被另一个事务更新或删除（或未保存的值映射不正确）：[CH9_NHibernateLinqToNHibernate.Domain.Planet#00000000-0000-0000-0000-000000000001]**

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:48:50.203

我发现了问题，基本上 NBuilder 正在为我的 Id 分配一个值，而 NHibernate 认为它“持久化”，它试图更新记录而不是创建一个新记录（虽然错误消息对我没有帮助......） ：

```
var star = Builder<Star>.CreateNew().Build();
star.Planets = Builder<Planet>.CreateListOfSize(10).All().With(x => x.Sun, star).With(x => x.Id, Guid.Empty).Build(); 
```

# mysql - 显示来自 mysql 存储过程的记录

> ID：10558617
> 
> 赞同：0
> 
> 时间：2012-05-11T21:04:51.277
> 
> 标签：mysql, stored-procedures

我刚刚开始学习如何在 MYSQL 中编写存储过程，但遇到了障碍。

我写了以下代码：

```
DELIMITER $$
DROP PROCEDURE IF EXISTS `emscribedx`.`countcodes` $$
CREATE PROCEDURE `emscribedx`.`countcodes` ()
BEGIN
declare doneprocessing int default 0;
declare thisaccount varchar(50);
declare countcursor cursor for select acct from patientid where patienttype='P';
declare continue handler for not found
set doneprocessing = 1;
Fetch countcursor into thisaccount;
Repeat
select * from doc_table where acct = thisaccount;
until doneprocessing = 1
END repeat;
close countcursor;
END $$

DELIMITER ; 
```

我想显示在重复语句之后出现的选择语句的结果。但是我该怎么做呢？当我执行存储过程时，什么都没有发生？

谢谢，

艾略特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:10:07.130

该过程只能返回单个查询的结果，为什么不使用它呢？

```
SELECT doc_table.* 
FROM doc_table 
INNER JOIN patientid
ON patientid.acct = doc_tableacct
WHERE patientid.patienttype='P'; 
```

如果你愿意，它可以放在一个过程中。

# objective-c - 编码 NSAttributedString 引发错误

> ID：10558619
> 
> 赞同：0
> 
> 时间：2012-05-11T21:04:55.967
> 
> 标签：objective-c, nskeyedarchiver, nsattributedstring, nscoder

根据[这个问题](https://stackoverflow.com/questions/2626667/saving-custom-attributes-in-nsattributedstring/ "这个问题")的公认答案，我编写了以下代码：

```
NSData* somedata;
somedata=[NSKeyedArchiver archivedDataWithRootObject:ts]; 
```

其中 ts 是一个 NSAttributedString ，其中填充了一些文本和一些属性（在本例中为颜色）。

当我执行此代码时，我收到此错误：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFType encodeWithCoder:]: unrecognized selector sent to instance 0x6eb5b90' 
```

我是 NSCoder 领域的新手，但上述问题的答案让我觉得这就是我所要做的。是吗？我错过了什么？

* * *

编辑：

在这种情况下，无法识别的选择器被发送到 NSAttributedString 中的颜色属性。当我像这样初始化字符串时：

```
NSAttributedString *ts = [[NSAttributedString alloc] initWithString:text attributes:self.currentAttributeDictionary]; 
```

字典是这样构建的：

```
self.currentAttributeDictionary=[NSDictionary dictionaryWithObjectsAndKeys:
                                 [self.currentColor CGColor],(NSString*)kCTForegroundColorAttributeName,
                                 nil]; 
```

字典的 NSLog 产生了这个：

```
New dictionary is: {
CTForegroundColor = "<CGColor 0x6eb5b90> [<CGColorSpace 0x6e968c0> (kCGColorSpaceDeviceRGB)] ( 1 1 0 1 )";} 
```

上面的 CGColor 的地址与错误消息中的地址匹配。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:35:53.073

虽然`UIColor`符合`NSCoding`，但（与大多数此类课程不同）**不是**免费桥接到`CGColorRef`. 您的字典正在尝试对其内容进行编码，`CGColorRef`但不知道如何对其进行编码。

假设您不想编码 a `UIColor`（因为这些听起来像 Core Text 属性），您将不得不自己处理序列化`CGColorRef`。例如，请参阅[这个问题](https://stackoverflow.com/questions/3949984/best-practice-of-copying-and-serializing-quartz-references)以获得一些有用的想法。

应该注意的是，顺便说一句，由于我不知道存档数据的去向，如果您想在 OS X 上取消存档数据，那么颜色在 AppKit/UIKit 级别再次成为令人头疼的问题：`NSColor`并且`UIColor`不直接兼容，所以你仍然需要通过`CGColorRef`，适当地存储色彩空间信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T20:48:18.647

根据要求，这是我用来完成我需要完成的代码的代码。自从我查看这段代码以来已经有一年了，编写它更多的是为了了解正在发生的事情，而不是为了伟大的编码实践或任何形式的效率。然而，它确实奏效了，而且效果很好！

我定义了一个NSAttributedString类的代码如下。

示例使用：

```
-(void)code:(id)sender {    
    self.testData=[textView.attributedString customEncode];
    NSLog(@"%@",self.testData);
}

-(void)recover:(id)sender {
    NSAttributedString* tString=[NSMutableAttributedString customDecode:self.testData];
    NSLog(@"Recover pressed: %@",tString);
    textView.attributedString=tString;
} 
```

这是底层代码：

```
#import "NSAttributedString+Extras.h"
#import <CoreText/CoreText.h>

@implementation NSAttributedString (Extras)

-(NSData*)customEncode {
    __block NSMutableArray* archivableAttributes=[[NSMutableArray alloc]init];

    [self enumerateAttributesInRange:NSMakeRange(0, [self length]) options:0 usingBlock:^(NSDictionary *attrs, NSRange range, BOOL *stop) {
        NSLog(@"range: %d %d",range.location, range.length);
        NSLog(@"dict: %@",attrs);
        NSLog(@"keys: %@", [attrs allKeys]);
        NSLog(@"values: %@", [attrs allValues]);

        NSMutableDictionary* tDict=[[NSMutableDictionary alloc]init];

        [tDict setObject:[NSNumber numberWithInt:range.location] forKey:@"location"];
        [tDict setObject:[NSNumber numberWithInt:range.length] forKey:@"length"];

        for (NSString* tKey in [attrs allKeys]) {
            if ([tKey isEqualToString:@"CTUnderlineColor"]) {
                [tDict setObject:[NSAttributedString arrayFromCGColorComponents:((CGColorRef)[attrs objectForKey:@"CTUnderlineColor"])] forKey:@"CTUnderlineColor"];
            }
            if ([tKey isEqualToString:@"NSUnderline"]) {
                NSNumber* underline=[attrs objectForKey:@"NSUnderline"];
                [tDict setObject:underline forKey:@"NSUnderline"];
            }
            if ([tKey isEqualToString:@"CTForegroundColor"]) {
                [tDict setObject:[NSAttributedString arrayFromCGColorComponents:((CGColorRef)[attrs objectForKey:@"CTForegroundColor"])] forKey:@"CTForegroundColor"];
            }
            if ([tKey isEqualToString:@"NSFont"]) {
                CTFontRef font=((CTFontRef)[attrs objectForKey:@"NSFont"]);

                NSDictionary* fontDict=[NSDictionary 
                                        dictionaryWithObjects:
                                        [NSArray arrayWithObjects:(NSString*)CTFontCopyPostScriptName(font),[NSNumber numberWithFloat:CTFontGetSize(font)], nil]
                                        forKeys:
                                        [NSArray arrayWithObjects:@"fontName", @"fontSize", nil]];

                [tDict setObject:fontDict forKey:@"NSFont"];
            }
        }

        [archivableAttributes addObject:tDict];
    }];

    NSMutableDictionary* archiveNSMString=[NSMutableDictionary 
                                           dictionaryWithObjects: [NSArray arrayWithObjects:[self string],archivableAttributes,nil]
                                           forKeys:[NSArray arrayWithObjects:@"string",@"attributes",nil]];

    NSLog(@"archivableAttributes array: %@",archiveNSMString);

    NSData* tData=[NSKeyedArchiver archivedDataWithRootObject:archiveNSMString];

    NSLog(@"tdata: %@",tData);

    return tData;
}

+(NSAttributedString*)customDecode:(NSData *)data {
    NSMutableAttributedString* tString;
    NSMutableDictionary* tDict=[NSKeyedUnarchiver unarchiveObjectWithData:data];
    NSArray* attrs;

    CTFontRef font=NULL;
    CGColorRef color=NULL;
    NSNumber* underlineProp=[NSNumber numberWithInt:0];
    CGColorRef underlineColor=NULL;

    NSLog(@"decoded dictionary: %@",tDict);

    if ([[tDict allKeys]containsObject:@"string"]) {
        tString=[[NSMutableAttributedString alloc]initWithString:((NSString*)[tDict objectForKey:@"string"])];
    }
    else {
        tString=[[NSMutableAttributedString alloc]initWithString:@""];
    }

    if ([[tDict allKeys]containsObject:@"attributes"]) {
        attrs=[tDict objectForKey:@"attributes"];
    }
    else {
        attrs=nil;
    }

    for (NSDictionary* attDict in attrs) {
        int location=-1;
        int length=-1;
        NSRange insertRange=NSMakeRange(-1, 0);

        if ([[attDict allKeys]containsObject:@"location"]) {
            location=[[attDict objectForKey:@"location"]intValue];
        }
        if ([[attDict allKeys]containsObject:@"length"]) {
            length=[[attDict objectForKey:@"length"]intValue];
        }
        if (location!=-1&&length!=-1) {
            insertRange=NSMakeRange(location, length);
        }

        if ([[attDict allKeys]containsObject:@"NSUnderline"]) {
            underlineProp=[attDict objectForKey:@"NSUnderline"];
        }

        if ([[attDict allKeys]containsObject:@"CTUnderlineColor"]) {
            underlineColor=[NSAttributedString cgColorRefFromArray:[attDict objectForKey:@"CTUnderlineColor"]];
        }        

        if ([[attDict allKeys]containsObject:@"CTForegroundColor"]) {
            color=[NSAttributedString cgColorRefFromArray:[attDict objectForKey:@"CTForegroundColor"]];
        }

        if ([[attDict allKeys]containsObject:@"NSFont"]) {
            NSString* name=nil;
            float size=-1;

            NSDictionary* fontDict=[attDict objectForKey:@"NSFont"];

            if ([[fontDict allKeys]containsObject:@"fontName"]) {
                name=[fontDict objectForKey:@"fontName"];
            }
            if ([[fontDict allKeys]containsObject:@"fontSize"]) {
                size=[[fontDict objectForKey:@"fontSize"]floatValue];
            }

            if (name!=nil&&size!=-1) {
                font=CTFontCreateWithName((CFStringRef)name, size, NULL);
            }
        }

        if (insertRange.location!=-1) {
            if (color!=NULL) {
                [tString addAttribute:(NSString*)kCTForegroundColorAttributeName value:(id)color range:insertRange];
            }
            if (font!=NULL) {
                [tString addAttribute:(NSString*)kCTFontAttributeName value:(id)font range:insertRange];
            }
            if ([underlineProp intValue]!=0&&underlineColor!=NULL) {
                [tString addAttribute:(NSString*)kCTUnderlineColorAttributeName value:(id)underlineColor range:insertRange];
                [tString addAttribute:(NSString*)kCTUnderlineStyleAttributeName value:(id)underlineProp range:insertRange];
            }
       }
    } 

    [tString enumerateAttributesInRange:NSMakeRange(0, [tString length]) options:0 usingBlock:^(NSDictionary *attrs, NSRange range, BOOL *stop) {
        NSLog(@"range: %d %d",range.location, range.length);
        NSLog(@"dict: %@",attrs);
        NSLog(@"keys: %@", [attrs allKeys]);
        NSLog(@"values: %@", [attrs allValues]);
    }];

    return [[NSAttributedString alloc]initWithAttributedString:tString];
}

+(NSArray*)arrayFromCGColorComponents:(CGColorRef)color {
    int numComponents=CGColorGetNumberOfComponents(color);
    CGFloat* components=CGColorGetComponents(color);
    NSMutableArray* retval=[[NSMutableArray alloc]init];
    for(int i=0;i<numComponents;i++) {
        [retval addObject:[NSNumber numberWithFloat:components[i]]];
    }
    return [NSArray arrayWithArray:retval];
}

+(CGColorRef)cgColorRefFromArray:(NSArray*)theArray {
    CGFloat* array=malloc(sizeof(CGFloat)*[theArray count]);
    for (int i=0; i<[theArray count]; i++) {
        array[i]=[[theArray objectAtIndex:i]floatValue];
    }

    CGColorSpaceRef theSpace;

    if ([theArray count]==2) {
        theSpace=CGColorSpaceCreateDeviceGray();
    }
    else {
        theSpace=CGColorSpaceCreateDeviceRGB();
    }

    return CGColorCreate(theSpace, array);
}

@end 
```

# c# - 在最终不需要计算器的情况下将枚举定义为 2 的标志/幂的任何技巧？

> ID：10558621
> 
> 赞同：70
> 
> 时间：2012-05-11T21:05:20.563
> 
> 标签：c#, enums

我知道我可以成倍增加，但我不想做懒惰的编程。

有没有人设计了一些魔法来自动将枚举编号为 2 的幂？

这是我要使其具体化的示例：

```
[Flags]
private enum Targets : uint
{
    None = 0,
    Campaigns = 1,
    CampaignGroups = 2,
    Advertisers = 4,
    AdvertiserGroups = 8,
    AffiliateGroups = 16,
    Affiliates = 32,
    Creatives = 64,
    DetailedLeads = 128,
    DetailedSales = 256,
    ProgramLeads = 512,
    CreativeDeployments = 1024,
    CampaignCategories = 2048,
    Payouts = 4096,
    All = uint.MaxValue
} 
```

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2012-05-11T21:08:06.940

将值写为移位位并让编译器进行数学运算：

```
[Flags]
private enum Targets : uint
{
    None                = 0,
    Campaigns           = 1,
    CampaignGroups      = 2 << 0,
    Advertisers         = 2 << 1,
    AdvertiserGroups    = 2 << 2,
    AffiliateGroups     = 2 << 3,
    Affiliates          = 2 << 4,
    Creatives           = 2 << 5,
    DetailedLeads       = 2 << 6,
    DetailedSales       = 2 << 7,
    ProgramLeads        = 2 << 8,
    CreativeDeployments = 2 << 9,
    CampaignCategories  = 2 << 10,
    Payouts             = 2 << 11,
    // etc.
} 
```

詹姆斯的建议也不错。事实上，我更喜欢这种方式。你也可以这样写：

```
[Flags]
private enum Targets : uint
{
    None                = 0,
    Campaigns           = 1 << 0,
    CampaignGroups      = 1 << 1,
    Advertisers         = 1 << 2,
    AdvertiserGroups    = 1 << 3,
    AffiliateGroups     = 1 << 4,
    // etc.
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-05-11T21:10:21.963

使用十六进制表示法也比十进制表示法简单一些（不需要计算器）：

```
[Flags]
private enum Targets : uint
{
    None                = 0,
    Campaigns           = 0x01,
    CampaignGroups      = 0x02,
    Advertisers         = 0x04,
    AdvertiserGroups    = 0x08,
    AffiliateGroups     = 0x10,
    Affiliates          = 0x20,
    Creatives           = 0x40,
    DetailedLeads       = 0x80,
    DetailedSales       = 0x100,
    ProgramLeads        = 0x200,
    CreativeDeployments = 0x400,
    CampaignCategories  = 0x800,
    Payouts             = 0x1000,
    // and the pattern of doubling continues
    // 0x2000
    // 0x4000
    // 0x8000
    // 0x10000
} 
```

不像 Cody 和 James 的解决方案那样优雅，但不需要计算器。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-11-21T11:23:03.523

快进五年后，从 C# 7.0 开始，您可以使用新的数字二进制文字来简化枚举标志声明。

```
[Flags]
private enum Targets : uint
{
    None = 0,
    Campaigns =             0b0000_0000_0000_0001,
    CampaignGroups =        0b0000_0000_0000_0010,
    Advertisers =           0b0000_0000_0000_0100,
    AdvertiserGroups =      0b0000_0000_0000_1000,
    AffiliateGroups =       0b0000_0000_0001_0000,
    Affiliates =            0b0000_0000_0010_0000,
    Creatives =             0b0000_0000_0100_0000,
    DetailedLeads =         0b0000_0000_1000_0000,
    DetailedSales =         0b0000_0001_0000_0000,
    ProgramLeads =          0b0000_0010_0000_0000,
    CreativeDeployments =   0b0000_0100_0000_0000,
    CampaignCategories =    0b0000_1000_0000_0000,
    Payouts =               0b0001_0000_0000_0000,
    All = uint.MaxValue
} 
```

[https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7#numeric-literal-syntax-improvements](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7#numeric-literal-syntax-improvements)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-29T00:16:54.213

我执行以下操作：

```
 using System;

 [Flags]
 public enum AnimalCharacteristics : long
 {
     Tail = 1 << AnimalCharacteristicsBitPositions.Tail,
     Eyes = 1 << AnimalCharacteristicsBitPositions.Eyes,
     Furry = 1 << AnimalCharacteristicsBitPositions.Furry,
     Bipedal = 1 << AnimalCharacteristicsBitPositions.Bipedal
 }

 internal enum AnimalCharacteristicsBitPositions : int
 {
     Tail = 0,
     Eyes,
     Furry,
     Bipedal
 }

 public class Program
 {
     public static void Main()
     {
         var human = AnimalCharacteristics.Eyes | AnimalCharacteristics.Bipedal;
         var dog = AnimalCharacteristics.Eyes | AnimalCharacteristics.Tail | AnimalCharacteristics.Furry;

         Console.WriteLine($"Human: {human} ({(long)human})");
         Console.WriteLine($"Dog: {dog} ({(long)dog})");
     }
 } 
```

这样做的好处是，您可以轻松地重新排序条目并添加新条目，只需按照模式将它们放入两个枚举中即可。位位置取决于第二个枚举。要跳过位位置，您只需在第二个枚举中的任意位置分配一个数字，编译器将从那里继续计数。

请注意，这些位置比实际位位置少一（如果您将最低有效位位置称为 1）。当然，您可以从 1 开始，如果您愿意，可以从第一个枚举中的位移位中减去 1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-09T15:14:03.130

这是另一种替代方法：

```
[Flags]
public enum COURSECOMPONENT_T : int
{
    Everything = -1,
    Nothing = 0,
    AttendanceRegisters = 1,
    Checklists = 2 * AttendanceRegisters,
    Competencies = 2 * Checklists,
    Content = 2 * Competencies,
    CourseFiles = 2 * Content,
    Discussions = 2 * CourseFiles,
    DisplaySettings = 2 * Discussions,
    Dropbox = 2 * DisplaySettings,
    Faq = 2 * Dropbox,
    Forms = 2 * Faq,
    Glossary = 2 * Forms,
    Grades = 2 * Glossary,
    GradesSettings = 2 * Grades,
    Groups = 2 * GradesSettings,
    Homepages = 2 * Groups,
    IntelligentAgents = 2 * Homepages,
    Links = 2 * IntelligentAgents,
    LtiLink = 2 * Links,
    LtiTP = 2 * LtiLink,
    Navbars = 2 * LtiTP,
    News = 2 * Navbars,
    QuestionLibrary = 2 * News,
    Quizzes = 2 * QuestionLibrary,
    ReleaseConditions = 2 * Quizzes,
    Rubrics = 2 * ReleaseConditions,
    Schedule = 2 * Rubrics,
    SelfAssessments = 2 * Schedule,
    Surveys = 2 * SelfAssessments,
    ToolNames = 2 * Surveys,
    Widgets = 2 * ToolNames,
} 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2019-04-04T05:13:03.197

```
#define BITS  \
    F(Campaigns) \
    F(Quizzes) \
    F(Groups) \
    F(Homepages)

#define F(x) x##_BIT,

enum bits {
    BITS
};

#undef F
#define F(x) x = (1 << x##_BIT),

enum flags {
    BITS
}; 
```

# c# - ValueInjecter 不同的类型/属性名称

> ID：10558622
> 
> 赞同：2
> 
> 时间：2012-05-11T21:05:26.040
> 
> 标签：c#, valueinjecter

是否可以从这样的东西注入：

```
public class DomainEntity
{
    public Resource DescriptionResource { get; set; }
}

public class Resource
{
    public List<ResourceLocalization> Localizations { get; set; }
}

public class ResourceLocalization
{
    public string Culture { get; set; }
    public string Value { get; set; }
} 
```

像这样：

```
public class DomainEntityViewModel
{
    public string Description { get; set; }
} 
```

（DomainEntity.DescriptionResource.Localizations.First().Value => DomainEntityViewModel.Description）

使用值注入器。

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T06:02:51.137

你可以使用这个注入：

```
 public class MyInj : ConventionInjection
    {
        protected override bool Match(ConventionInfo c)
        {
            return c.TargetProp.Name == c.SourceProp.Name 
            && c.TargetProp.Type == typeof (string) 
            && c.SourceProp.Type == typeof (List<ResourceLocalization>);
        }
        protected override object SetValue(ConventionInfo c)
        {
            return ((List<ResourceLocalization>) c.SourceProp.Value).First().Value;
        }
    } 
```

# php - 如何通过创建变量来显示结果？

> ID：10558623
> 
> 赞同：0
> 
> 时间：2012-05-11T21:05:38.813
> 
> 标签：php, casting, concat

我是 PHP 新手，所以请原谅我的混乱。对于像我这样的人来说，这是一个非常复杂的查询。

请参阅下面的查询。现在所有结果都显示在 $row['Post']; 相反，我希望能够执行以下操作：

$somerow = $row['some_row']; $somerow2 = $row['some_row2'];

然后可以通过上面使用的 $variables 在任何地方使用它。

我尝试在下面使用它，但它没有用：

```
if($rows == 0)
{
print("");

}
elseif($rows > 0)
{
while($row = mysql_fetch_array($query))
{

$postid = htmlspecialchars($row['post_id']);
$postname = htmlspecialchars($row['post_name']);

print("$postname and the id is $postid");
}

} 
```

我怎样才能做到这一点？

完整查询：

```
$denied = "Denied";
$userid = Drawn from db for user viewing;

$sql = "SELECT  concat(  (select client_name from user_accounts where 
User_id = tv.User_id), ' commanded ' , title_1  ,' on ', CAST(other_date AS 
CHAR(10)) ) AS Post FROM client_visits tv where User_id in (select contact_id 
from contacts where User_id = '$userid' ) and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_2  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM client_notes tv where User_id in (select contact_id from 
contacts where User_id = '$userid' ) and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_3  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM client_media tv where User_id in (select contact_id 
from contacts where User_id = '$userid' ) and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_4  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM client_stats tv where User_id in (select contact_id from 
contacts where User_id = '$userid' ) and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_5 ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM client_current_list  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_6 ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM client_past  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_7  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM  client_listers  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_8  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM    client_events  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_9  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM    client_admissions  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'
union
SELECT  concat(  (select client_name from user_accounts where User_id 
= tv.User_id), ' commanded ' , title_10  ,' on ', CAST(other_date AS CHAR(10)) )
AS Post FROM    client_immu  tv
where User_id in (select contact_id from contacts where User_id = '$userid' )
and user_allowed = '$denied'
or User_id in (select User_id from contacts where contact_id = '$userid')
and user_allowed = '$denied'";

$query = mysql_query($sql) or die ("Error: ".mysql_error());

$result = mysql_query($sql);

if ($result == "")
{
echo "";
}
echo "";

$rows = mysql_num_rows($result);

if($rows == 0)
{
print("");

}
elseif($rows > 0)
{
while($row = mysql_fetch_array($query))
{

print($row['Post']);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:56:39.017

您可以将每一行存储在一个数组中，然后选择要使用的行。

```
if($rows == 0)
{
    print("I have no rows!");
}
else
{
   $allrows = array();
   while($row = mysql_fetch_array($query))
   {
       $allrows[] = $row;
   }
   $row1 = $allrows[0];
   $row2 = $allrows[1];
   echo $row1['Post']; // Print out first row
   echo $row2['Post']; // Print out second row
   var_dump($allrows); // Print out all the rows and the structure of this array
} 
```

然后，如果您想在任何地方使用这些变量，则需要将它们设为全局变量，但我建议不要将全局变量用于类似的事情或任何一般的事情。

# android - FQL 事件开始时间查询

> ID：10558624
> 
> 赞同：0
> 
> 时间：2012-05-11T21:05:43.387
> 
> 标签：android, facebook

我在 Android 应用程序中使用 FQL 来获取事件

查询运行良好，我收到事件，例如

```
{eid":356869247704497,"name":"An event","start_time":1338595200,"end_time":1338606000} 
```

我采用 start_time 并通过转换为 Java 日历

```
Calendar occasionDate = Calendar.getInstance();
occasionDate.setTime(new Date(1338595200 * 1000));
Log.d("app", occasionDate.getTime().toString()); 
```

产生

2012 年 6 月 2 日星期六 01:00:00 GMT+01:00

而 FB 网站上的日期是 2012 年 6 月 1 日星期五下午 5:00

那么存储在数据库中的 start_time 是什么时区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:50:00.933

它在回报中说 - 格林威治标准时间 +1:00。这让游戏失去了:-)

# ruby-on-rails - Heroku 上有哪些不同的 Web 服务器选项？

> ID：10558627
> 
> 赞同：4
> 
> 时间：2012-05-11T21:05:53.340
> 
> 标签：ruby-on-rails, heroku

我最近部署了一个应用程序并正在使用 WEBrick，并且正在考虑切换到 Thin。我想知道存在哪些不同的选项并且最适合 heroku 环境？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T21:35:55.743

如果你在 Cedar 堆栈上，你可以使用任何你想要的东西 - Thin 工作，你可以通过 Heroku 从 Unicorn 中获得出色的性能 - [http://blog.railsonfire.com/2012/05/06/Unicorn-on -Heroku.html](http://blog.railsonfire.com/2012/05/06/Unicorn-on-Heroku.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T22:16:34.967

（假设：你说的不是WEB服务器（即Apache或者Nginx），而是你的应用进程）

唯一真正的限制是您可以在 Linux 上运行什么。Nginx 是 Heroku 堆栈使用的代理 - 但在这之后由您决定。

我已经看到运行 Thin、Webrick 和 Unicorn 的东西没有问题。

# python - 评估'字符串不在字符串中'时循环未执行

> ID：10558630
> 
> 赞同：0
> 
> 时间：2012-05-11T21:06:10.537
> 
> 标签：python

我做了一个函数，要求玩家输入一个字母，直到字母为 X、x、O 或 o。但是，每当我调用该函数时，while 循环都会以某种方式计算为 False 并且永远不会开始执行。可能是什么问题？非常感谢你。

```
def getLetter():
    letter = ""
    while letter not in "XxOo":
        print("Would you like to be X or O ?")
        letter = input() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:08:31.107

空字符串是所有字符串的成员。只需在 Python 提示符下尝试：

```
>>> "" in "lol"
True 
```

你可以初始化`letter`一些你知道不在选项中的东西，例如`<not chosen yet>`，而不是空字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:09:12.793

尝试将函数的第一行更改为`letter = "David is cool"`并仔细考虑将空字符串包含在另一个字符串中意味着什么，例如`"" in "XxOo"`.

# wpf - DevExpress Grid 是否与 MVVM 和命令一起使用（我能找到的只有事件）

> ID：10558640
> 
> 赞同：2
> 
> 时间：2012-05-11T21:06:50.233
> 
> 标签：wpf, mvvm, telerik, devexpress, xceed

我正在考虑使用 DevExpress WPF 控件。但似乎他们的控件（或至少是网格）使用事件而不是命令（对 MVVM 不友好）。

我已经看到了几种进行事件到命令转换的方法。但对我来说，它们似乎都有点被黑了。而且我[读到](http://community.devexpress.com/forums/t/91687.aspx)它们在连接到 DevExpress Grid 的某些部分时会崩溃。

我刚刚开始进行一些 Blue-Sky 开发，从一开始就破解我的 UI 似乎是个糟糕的主意。

DevExpress Grid 是否适用于 MVVM 和命令？（即我错过了什么？）

如果没有，Telerik 呢？或任何其他控制供应商？

现在我看到的唯一一个似乎这样做的是 Xceed。如果 DevExpress 像看起来那样有限，它们是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:06:15.700

Telerik definately works with Commands. However any WPF control can map behaviors to commands by using System.Windows.Interactivity.

Article to paruse [http://www.danharman.net/2011/08/05/binding-wpf-events-to-mvvm-viewmodel-commands/](http://www.danharman.net/2011/08/05/binding-wpf-events-to-mvvm-viewmodel-commands/)

The important bit is:

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
...
<DevExpressControl>    
    <i:Interaction.Triggers>        
        <i:EventTrigger EventName="MouseEnter" >
            <i:InvokeCommandAction Command="{Binding FooCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
</DevExpressControl> 
```

So, in just a couple of xaml lines, you bind an event to a command.

# sql-server - Crystal Reports - 通过文本范围选择记录

> ID：10558643
> 
> 赞同：1
> 
> 时间：2012-05-11T21:07:20.717
> 
> 标签：sql-server, string, crystal-reports

我有一个查询事务表的报告，我简化了下表：

```
CREATE TABLE [dbo].[NL_Trans](
    [NT_PRIMARY] [int] NOT NULL,
    [NT_CODE] [varchar][20] NOT NULL,
    [NT_CAT1] [varchar](6) NOT NULL,
    [NT_CAT2] [varchar](6) NOT NULL,
) 
```

表中数据如下：

```
NT_PRIMARY -- NT_CODE --- NT_CAT1 --- NT_CAT2
---------------------------------------------
      1       AB100         123         234
      2       AB200         124         234
      3       AB300         125         235
      4       AB400         126         235 
```

该表有几年的数据，有 8`NT_CAT`个字段，**这些是存储为 varchar 的数字**。

我有一个很大的类别列表来限制查询，但我找不到将其限制为文本范围的方法。到目前为止，我已经尝试过：

```
{NL_Trans.NT_CAT1} IN "124" to "125"

AND

(CDbl ({NL_Trans.NT_CAT1}) IN 124 to 125)) 
```

两者都没有返回任何结果。

我不能使用大量 OR 语句，因为在某些情况下范围超过 100 项，这意味着我需要数千行。

任何人都可以提供一个可行的替代方案（并在可能的情况下利用类别索引）或告诉我为什么上述任何一个陈述都不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T16:44:48.587

首先，您不能相信 Crystal 会评估类似`"5" in "1" to "10"`. 我不知道这些比较的基础，但我猜它是基于前导数字的 ascii 值或类似的东西。

话虽如此，转换为双精度*应该可以*工作...您的 NT_CAT 字段中是否可能有非数字字符？你应该在你的记录选择公式中尝试这样的事情，看看你是否有更好的运气：

`if not(isnull({NL_TRANS.NT_CAT1})) and isnumeric({NL_TRANS.NT_CAT1}) then cdbl({NL_TRANS.NT_CAT1}) in 124 to 125`

这样做的缺点是 Crystal 不会将此添加到要在 SQL Server 上处理的 WHERE 子句中，而是会在本地计算机上进行选择。为了避免这种性能损失，您可以在 Crystal 中创建一个 SQL 表达式，它将为您执行字符串到数字的转换。我不使用 TSQL，所以我不会尝试将我的 Crystal 代码片段转换为它，但如果您创建了 SQL 表达式 {%ConvertCAT1ToNumeric} 您可以在选择公式中使用它：

`not(isnull({%ConvertCAT1ToNumeric})) and {%ConvertCAT1ToNumeric} in 124 to 125`

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T05:14:13.873

试试这个。

删除那些是标准类型之一的行**。您可能正在寻找一个范围**{NL_Trans.NT_CAT1} IN“124”到“125”**AND

并且只将其放入选择标准，但首先，尝试为数字范围公式选择不同的字段，复制整个公式并创建一个新标准。将该字段重命名为适当的字段并运行报告。（不要忘记删除您所做的第一个虚拟标准）

原文：（CDbl ({NL_Trans.NT_CAT1}) IN 124 至 125)）

我认为这是范围数字的公式（CDbl（{NL_Trans.NT_CAT1}）在 124 到 125 之间））

# java - 在 Linux 上以最少的安装运行 sikuli 脚本

> ID：10558644
> 
> 赞同：1
> 
> 时间：2012-05-11T21:07:20.967
> 
> 标签：java, python, linux, gui-testing, sikuli

我想将 sikuli 脚本添加到我的存储库中，并在 Linux 上以最少的安装使其可供其他人使用。[有](https://answers.launchpad.net/sikuli/+question/196785)说明如何在不安装的情况下在 Windows 上运行脚本，但在 Linux 上更复杂。

有没有人有这个问题的经验或建议？

# apache - Mod将子域URL重写到根文件夹（apache）

> ID：10558648
> 
> 赞同：0
> 
> 时间：2012-05-11T21:07:50.320
> 
> 标签：apache, mod-rewrite

我目前有一个重写规则，将 *.domain.com 重写为 www.domain.com（blog.domain.com 除外）

> RewriteEngine On RewriteCond %{HTTP_HOST} ^domain.com$ [NC]
> 
> RewriteRule ^(.*)$ [http://www.domain.com](http://www.domain.com) $1 [R=301,L]

我想将我的所有 URL 从子域重写到根域，同时保留页面名称，添加“.html”扩展名，并添加 [301] perm 标签：

```
blog.domain.com/my-first-link  -->  www.domain.com/blog/my-first-link.html 
blog.domain.com/my-second-link -->  www.domain.com/blog/my-second-link.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:39:10.767

```
RewriteEngine on
RewriteRule ^(.*) http://www.domain.com/blog/$1.html [R=301,L] 
```

# c# - 报表查看器 Visual Studio 2010 子报表页眉

> ID：10558659
> 
> 赞同：0
> 
> 时间：2012-05-11T21:08:28.640
> 
> 标签：c#, .net, reportviewer, rdlc

我不知道如何让我的子报表具有页眉。表中的额外列设置为标题行是唯一的解决方法吗？

# php - foreach 循环在空数组上循环一次，错误？

> ID：10558661
> 
> 赞同：1
> 
> 时间：2012-05-11T21:08:31.857
> 
> 标签：php, foreach

我在 PHP 的 foreach 循环中发现了奇怪的行为。当我这样做时：

```
<?php
$arr = array();

foreach ( $arr as $a )
{
    echo 'Hello';
}
?> 
```

然后正如我所料，仅仅因为数组为空而没有打印任何内容，但是当我这样做时：

```
<? $arr = array(); ?>

<? foreach ( $arr as $a ): ?>
    Hello
<? endforeach; ?> 
```

然后单词'Hello'被打印一次......即使数组是空的。我不明白为什么这会表现不同。对我来说，这看起来像一个错误，但我可能会遗漏一些东西......

我正在使用 PHP 5.4 (Windows)。

如果您想知道，我在我的 .phtml 文件（模板文件）中使用了第二种方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:15:19.307

我做了一些测试，似乎正在发生这种情况，因为`short_open_tag`它已关闭。

您看到“Hello”是因为 PHP 没有运行。

您需要编辑您的`php.ini`并设置`short_open_tag`为`1`.

自 PHP 5.4 起，`<?php echo`别名`<?=`始终可用，但短标签 ( `<?`) 语法仍需要该选项集。

文档：[http ://www.php.net/manual/en/ini.core.php#ini.short-open-tag](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)

# ios - iOS：+[NSString stringWithUTF8String] 产生不可预测的结果？

> ID：10558663
> 
> 赞同：1
> 
> 时间：2012-05-11T21:08:43.657
> 
> 标签：ios, utf-8

我正在从服务器检索一些 UTF8 编码的 HTML。（在这种特殊情况下，我可以说每次我发出请求时，都会返回 763 个字节。）

然后，我将这些字节传递给 +[NSString stringWithUTF8String]，大约 90% 的时间，我得到的结果字符串看起来与服务器上我的文件中的 HTML 完全一样。10%的时候，我得到零。

我完全没有理由为什么这会不一致。NSURLConnection 从服务器读取的字节每次都是相同的。

有人有想法么？这是代码：

```
 [NSURLConnection sendAsynchronousRequest:[NSURLRequest requestWithURL:url] queue:customTableOperationQueue
            completionHandler: ^(NSURLResponse* response, NSData* data, NSError* error)
            {
                if (! error)
                {
                    NSString* newTableHTML = [NSString stringWithUTF8String:data.bytes];
                    NSLog(@"data.length = %d, newTableHTML.length = %d", data.length, newTableHTML.length);
                    self.tableHTML = newTableHTML;
                }
                else
                {
                    self.tableHTML = nil;
                    self.errorMessage = error.localizedDescription;
                }
            }
        ]; 
```

# iphone - Box2D 睡眠时间

> ID：10558664
> 
> 赞同：0
> 
> 时间：2012-05-11T21:08:45.467
> 
> 标签：iphone, cocos2d-iphone, box2d-iphone

我只是想知道是否有一种方法可以更改 box2d（cocos2d）中的身体激活睡眠状态之前的时间量。

我目前使用睡眠状态作为结束游戏的一种方式，所以如果我可以加快达到睡眠状态所需的时间，那将是更可取的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T09:04:50.353

物理引擎不会根据时间让对象进入睡眠状态。它只会让处于静止状态（空闲）的身体进入睡眠状态。通常，物理引擎定义规则何时可以安全地让身体进入睡眠状态，通常是身体完全停止移动，没有其他移动的身体接触它，并且在一段时间内同时满足这两个条件。

在 Box2D 中，除非您修改 Box2D 源代码（不推荐），否则您无法修改此行为。在 Chipmunk 中，您至少可以设置身体在进入睡眠之前必须空闲多长时间的阈值。更改此值有时会导致缓慢移动的对象突然进入睡眠状态。

要实现您想要的行为，您应该定义自己的规则集。遍历所有可能在游戏结束时缓慢移动的物体。获取角旋转和速度的值，并检查它们是否低于某个对您的游戏感觉良好的阈值。然后结束游戏，或者你也可以通过body->SetAwake(false)手动让物体进入睡眠状态。

# c# - 创建一个表视图，其中包含在 monotouch 中列出的目录和文件

> ID：10558666
> 
> 赞同：0
> 
> 时间：2012-05-11T21:08:49.077
> 
> 标签：c#, iphone, ios, ipad, xamarin.ios

我正在尝试创建一个表格视图，其中列出了文档文件夹中的文件和目录。选择目录后，应用程序应显示所选目录中的文件列表。它就像表格视图的嵌套。不幸的是，我只能使用特定目录中的文件创建表视图。我不能让它列出目录，也不能列出子目录中的文件。

我希望已经明确了我的目标。基本上我只想使用表格视图创建一个文档/文件夹资源管理器。

如果可以的话，请给我代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:25:54.833

有一些现有的示例说明如何使用 MonoTouch 实现递归目录/文件列表应用程序。

参见示例 1，[一个用于向上导航文件夹并在文件单击时发出警报消息的应用](https://github.com/SuperYeti/MonoTouch.DirectoryRecurser)

示例 2，[一个如何使用 MonoTouch 导航/递归文件和文件夹的工作示例](http://docs.xamarin.com/ios/tutorials/Working_with_the_File_System)

希望能帮助你走上正轨。

# iphone - 如何在 iOS 应用程序进入挂起模式时调用函数？

> ID：10558667
> 
> 赞同：0
> 
> 时间：2012-05-11T21:08:51.667
> 
> 标签：iphone, objective-c, ios, ios4, ios5

我是 iOS 新手。当我在 iPhone 中按下主页按钮时，应用程序进入挂起模式是我所知道的，在程序中，我如何捕获此事件并清除我的本地数据？友善的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:11:52.780

您可以在应用委托中使用以下方法：

```
- (void)applicationWillResignActive:(UIApplication *)application 
```

Apple 解释了何时调用此委托方法：

> 当应用程序即将从活动状态变为非活动状态时发送。这可能发生在某些类型的临时中断（例如来电或短信）或当用户退出应用程序并开始转换到后台状态时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:11:04.347

在您的委托中，将您要调用的代码放入其中。每次后台应用程序时都会触发一个，当您返回时另一个会触发。

```
- (void)applicationDidEnterBackground:(UIApplication *)application

- (void)applicationDidBecomeActive:(UIApplication *)application 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:12:33.273

如果需要，使用应用程序委托 applicationWillResignActive 方法和 UIBackgroundTaskIdentifier。例如：

```
- (void)applicationWillResignActive:(UIApplication *)application {
    UIBackgroundTaskIdentifier backgroundTaskIdentifier = [application beginBackgroundTaskWithExpirationHandler:^(void) {
        [application endBackgroundTask:backgroundTaskIdentifier];
        //your cleanup code
    }];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:16:48.263

虽然您可以实现其他人讨论的 UIApplicationDelegate 方法，但让需要清理的对象注册自己以获取相应的通知通常更方便（并且可以说更干净）：

```
UIApplicationDidEnterBackgroundNotification
UIApplicationWillResignActiveNotification 
```

例如

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(myCleanupMethod:)
                                             name:UIApplicationDidEnterBackgroundNotification
                                           object:nil]; 
```

（如果你走这条路，不要忘记在观察对象被释放时移除观察者。）

# ios - 故事板模式Xcode中是否有随机页面生成器

> ID：10558668
> 
> 赞同：0
> 
> 时间：2012-05-11T21:08:56.893
> 
> 标签：ios, xcode, random, storyboard, generator

您好我正在制作一个需要随机页面生成器的应用程序，所以我想知道是否有办法在 xcode 中将随机页面生成器添加到情节提要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T02:48:52.730

if your intention is to generate random page (meaning view controllers) from a single command (e.g. Button) you can try this approach:

1.  In the storyboard, simply link the homeviewcontroller to the numbers of random view controllers you intend to create, by pressing control-drag and select push as the segue.

2.  Identify the numbers of segues independently, e.g segue1, segue2, ... segue100000 etc

3.  Lastly, just key in the following coding according to your headers and implementation names;

For the header of the homeviewcontroller.h

-(IBAction)RandomButton:(id)sender

For the implementation of the homeviewcontroller.m

-(IBAction)RandomButton:(id)sender {

```
NSArray *segues = @[@"segue1", @"segue2", ... ,@"segue10000"];
NSString *segueID = segues[arc4random_uniform(segues.count)];
[self performSegueWithIdentifier: segueID sender: sender]; 
```

}

1.  Now try to run it. It should work fine! Cheers.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:20:06.263

我所知道的没有开箱即用的东西（并且鉴于每个应用程序都有不同的“页面”概念，我不确定是否存在*通用*方法。（不过，我不使用故事板，所以我有点在我的舒适区之外。）

生成随机数很容易，您可以将其用作某些方法的输入，例如，挑选一个索引视图控制器并将其推送到导航堆栈上。但这是假设的，完全取决于您的应用程序架构。

需要详细说明吗？

# python - python如何在数组中有不同的数据类型？

> ID：10558670
> 
> 赞同：1
> 
> 时间：2012-05-11T21:09:12.930
> 
> 标签：python, c, arrays

Python 中可以有一个包含不同数据类型的列表，即 [1,"two",3]。Python 是用 c 实现的，那么如何使用 c 创建一个包含不同数据类型的数组呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:12:00.990

所以，我不知道它是如何在 Python 中实现的，但是在 C 中，有一些方法可以对通用数据进行操作。以最简单的形式：

```
void *array[size]; 
```

现在你有一个完整的数组`void*`。每个都`void*`可以指向任何东西。您还需要一些额外的信息来告诉您它所指向的事物的大小。

```
typedef struct {
    void *data;
    size_t size;
} elem; 
```

如果需要，您可以通过各种方法表示实际类型。您可以使用联合将 N 类型之一保存在同一变量中。无论如何，关键是在 C 语言中有多种方法可以对通用数据进行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:12:22.053

> 如何使用 c 创建一个具有不同数据类型的数组？

你不能；C 是一种静态类型语言。

但是，您可以使用联合之类的东西：

```
typedef union {
    int i;
    float f;
} Foo;

Foo array[3];

array[0].i = 3;
array[1].f = 4.2;
... 
```

你也可以用它`void *`来指向你喜欢的任何对象，但这需要仔细的内存管理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T21:11:41.540

如果您的数组由以下形式的 C 结构组成怎么办：

```
struct slot {
  int type;
  char *data;
}; 
```

现在您有了一个可以包含任意类型数据的数组，只要您可以将它们表示为指向字符的指针。

当然，这不是 Python 的做法。关键是，您的应用程序如何处理数据与您的实现语言如何处理数据之间不必有任何联系。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T10:23:08.767

在 Python 中，没有“原始”值；一切都是对象并且知道它的类型。甚至整数也是对象（尝试打印`(1).__class__`或`1 .__class__`）。你在 C 语言中对 Python 对象所做的一切，都是通过一个`PyObject *`（指向对象的指针）来完成的。¹

Python`list`是一个动态的（即可调整大小的）数组`PyObject *`。由于每个对象都知道其类型，因此`list`不必将其声明为具有特定类型的成员。

¹ 另请注意：Python 没有通常意义上的“变量”（C、BASIC、Pascal 等），其中类型变量包含值；它具有命名空间和名称（实际上，字典将字符串映射到对象；命名空间是一个字典，它的键是名称，它的值是指向每个名称所指向的对象的指针）。

# javascript - 如何使用 Javascript 和 jQuery 创建一个表格，以便每个单元格都可以放置？

> ID：10558671
> 
> 赞同：0
> 
> 时间：2012-05-11T21:09:13.690
> 
> 标签：javascript, jquery

这段代码可以很好地创建一个 div 网格：

 `````
for (var i = 0; i < 10; i++) { // rows
    for (var j = 0; j < 6; j++) { // columns
        var id = String.fromCharCode(65 + j) + i; // e.g., B1
        $('<div></div>').data('accepts', id).appendTo("#cardSlots").droppable({
            accept: '#cardPile div',
            hoverClass: 'hovered',
            drop: handleCardDrop
        }); 
    }
$("cardSlots").append("<br />");
} 
````  `...但是当我调整窗口大小时，div 有时会滑到下一行。我想要一个固定大小为 6x10 的表格，但是当我尝试构建一个表格而不是 div 时，我破坏了“可放置”属性。

如何重写上面的代码，以便创建一个 6x10 的 html 表，其中每个单元格都是可放置的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:25:45.403

试试 jQuery UI 的 Sortable 库：

[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)

您可以仅按类或 ID 名称指定要排序的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:50:17.347

您应该创建一个`<table>`, 并在每个单元格中放置一个 div 并附上 droppable 和`width:100%;height:100%;`

这将解决您的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:21:35.543

好的，我需要学习两件事才能正确地做到这一点。第一个是 appendTo 足够聪明，可以知道将 td 放入 tr 中，所以这一行允许我动态创建表行：

`$('<tr></tr>').appendTo("#grid");`

第二个是我可以识别最后一个（即最近写入的）表行，如下所示：

`appendTo("#grid tr:last")`

所以最终的结果（它工作得很好，谢谢迈克！）是这样的：

 `````
for (var i = 0; i < 10; i++) { // rows
    $('<tr></tr>').appendTo("#grid");
    for (var j = 0; j < 6; j++) { // columns
        var id = String.fromCharCode(65 + j) + i; // e.g., B1

        $('<td id="'+id+'"><div>' + id +'</div></td>').data('accepts', id).appendTo("#grid tr:last").droppable({
            accept: '#stack div',
            hoverClass: 'hovered',
            drop: handleCardDrop
        });
    }
} 
```````

# apache-flex - 如何在 ActionScript 中获取 ComboBox 的值

> ID：10558673
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:09:23.833
> 
> 标签：apache-flex, actionscript

我想在它的 Change 事件处理程序中显示 ComboBox 的值。labelField是动态分配的，所以运行事件处理程序的时候不知道是什么

```
cmbArea.labelField = qry.outFields[0]; 
```

我希望我可以访问 selectedItem 的值，例如：

```
 protected function cmbArea_changeHandler(event:IndexChangeEvent):void{ 

       // TODO Auto-generated method stub
       Alert.show(event.target.selectedItem.value);
   } 
```

但它没有用。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:53:59.353

如果没有看到您的数据提供程序代码或错误消息，很难对此进行调试。但是，动态分配 labelField 并不重要。如果您的数据提供者中的元素具有名为“值”的属性，那么您所拥有的将起作用。如果您的数据提供者中的唯一属性是您指定为 labelField 的属性，您应该能够在您的更改处理程序中使用以下内容访问它：

```
Alert.show(ComboBox(event.target).selectedItem); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T01:45:10.163

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx">

    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;

            import spark.events.IndexChangeEvent;

            protected function comboBox_changeHandler(event:IndexChangeEvent):void
            {
                Alert.show(comboBox.selectedItem);
            }
        ]]>
    </fx:Script>

    <s:ComboBox id="comboBox"
                change="comboBox_changeHandler(event)">
        <s:dataProvider>
            <s:ArrayList>
                <fx:String>Item 1</fx:String>
                <fx:String>Item 2</fx:String>
                <fx:String>Item 3</fx:String>
            </s:ArrayList>
        </s:dataProvider>
    </s:ComboBox>

</s:Application> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T21:08:36.873

我测试了以下行，似乎它有效：

```
Alert.show(event.target.selectedItem[event.target.labelField]); 
```

# java - 测试红色

> ID：10558674
> 
> 赞同：1
> 
> 时间：2012-05-11T21:09:24.210
> 
> 标签：java, 2d, collision-detection, slick2d

我正在尝试为老式 RPG 编写碰撞地图。我使用红色 (255, 0, 0) 创建了一个应该发生碰撞的图像，并试图测试我的精灵位置 (x, y) 何时会在碰撞图上显示为红色。这是我的似乎不起作用的代码：

```
public boolean isBlocked(int testX, int testY) {

    System.out.println(collisionMap.getColor(testX, testY)); //debug
    System.out.println(Color.red); //debug

    if ((collisionMap.getColor(testX, testY)) == Color.red) {
            System.out.println("COLLISION OCCURRING!"); //debug
            return true;
    }
    else {
        System.out.println("NO COLLISION OCCURRING!"); //debug
        return false;
    }
} 
```

当应该发生碰撞时，我在控制台中得到以下输出：

颜色 (1.0,0.0,0.0,1.0)

颜色 (1.0,0.0,0.0,1.0)

没有发生碰撞！

由于某种原因，If 语句没有将两个值视为相等，即使它们看起来是相等的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:12:27.330

我相信这是因为 Color.red 是一个对象，而不是一个值。尝试使用

```
collisionMap.getColor(textX, testY).equals(Color.red) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:13:21.647

代码可能通过 == 比较对象引用。也许将比较替换为：

```
if ((collisionMap.getColor(testX, testY)).equals(Color.red)) 
```

此外，请确保您正确实施了 equals()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:19:55.617

我的第一个问题是你是否使用`java.awt.Color;`你的颜色对象。
当我输出它们时，我得到`java.awt.Color[r=255,g=0,b=0]`的不是`Color (1.0,0.0,0.0,1.0)`你。

尝试替换此行：

```
if ( ( collisionMap.getStringColor( 0 , 0 ) ).equalsIgnoreCase( Color.red.toString() ) ) 
```

我创建了一个独立运行的地方：

```
public class Test
{
    public static void main( String args[] )
    {
        CollisionMap collisionMap = new CollisionMap();

        System.out.println( collisionMap.getStringColor( 0 , 0 ) );
        System.out.println( collisionMap.getColorColor( 0 , 0 ) );

        if ( ( collisionMap.getStringColor( 0 , 0 ) ).equalsIgnoreCase( Color.red.toString() ) )
        {
            System.out.println( "COLLISION OCCURRING!" ); // debug
        }
        else
        {
            System.out.println( "NO COLLISION OCCURRING!" ); // debug
        }
    }

    public static class CollisionMap
    {
        public Color getColorColor( Integer x , Integer y )
        {
            return Color.red;
        }

        public String getStringColor( Integer x , Integer y )
        {
            return Color.red.toString();
        }
    }
} 
```

哪个输出：

```
java.awt.Color[r=255,g=0,b=0]
java.awt.Color[r=255,g=0,b=0]
COLLISION OCCURRING! 
```

# jquery - $j.ajax() 成功回调方法未按预期创建新表行

> ID：10558683
> 
> 赞同：1
> 
> 时间：2012-05-11T21:10:07.470
> 
> 标签：jquery, ajax

我有一个屏幕，用户可以单击“添加运输点”按钮，这会弹出一个对话框，他们在其中输入信息，点击“添加”，这会进行 Ajax 调用，将运输点添加到数据库，然后关闭对话框并那么 ajax 调用的成功回调方法应该在运输点表中附加一个 tr。一切正常，除了 tr 没有被添加。

这是应该将行添加到其中的运输点表的 html。

```
<table id="shipPoints" class="ui-widget-content" width="697">
<thead>
    <tr class="ui-widget-content"  width="696">
        <th class="ui-widget-header" width="395">
        Shipping Points
    </th>
    <th class="ui-widget-header" width="300">
        Remove
    </th>
    </tr>
</thead>

<tbody>
    <c:forEach items="${shippingPoints}" var="shippingPoint">
    <tr width="695">
        <td with="395">
            ${shippingPoint.shippingPointsCity},
            ${shippingPoint.shippingPointsState}
        </td>
        <td width="300">
        <INPUT type="checkbox" NAME="chk" value="${shippingPoint.shippingPointsId}" />
        <INPUT type="hidden" NAME="shipPointId" VALUE="${shippingPoint.shippingPointsId}" />
        </td>                           
    </tr>
</c:forEach>
</tbody>
</table> 
```

这是做这项工作的jquery。

```
function saveShippingPoint() 
{
//alert("Before ajax call.");
$j.ajax(
{
    url: "<portlet:resourceURL id='saveShippingPoint'/>" + 
       "?city=" + $j( "#city" ).val().toUpperCase() +
       "&state=" + $j( "#state" ).val().toUpperCase() +
       "&stateOther=" + $j( "#stateOther" ).val().toUpperCase() +
       "&zip=" + $j( "#zip" ).val() +
       "&product=" + $j( "#product" ).val().toUpperCase() ,
    type: 'GET',
    cache: false,
    timeout: 30000,
    success: function(data)
    {
        //alert("In success callback."); 
    $j("#shipPoints tr:last").after(                
          "<tr>"
        + "<td>"
        + city.val().toUpperCase()
        + ", "
        + state.val().toUpperCase()
        + "</td>"
        + "<td>"
        + "<INPUT type='checkbox' NAME='chk' VALUE='"+ data + "' />"
        + "<INPUT type='hidden' NAME='shipPointId' VALUE='"+ data + "' />"
        + "</td>"
        + "</tr>");
    },
    error: function()
    {
        alert("There was a problem adding the shipping point.");
    }
});
//alert("Done with ajax call, about to return.");
return;
}; 
```

这是用于输入信息的对话框的代码。

```
<div id="dialog-form" title="Shipping Points">
<p class="validateTips">
    Please include all vendor ship points by product group. If vendor
    ships all products from one location input City, State, Zip Code
then select "All" for product group.
</p>
<fieldset>
<label font-family="Courier New" align="left" for="city">City</label>
    <input maxlength=50 align="right" type="text" name="city" id="city"
        class="text ui-corner-all" />
    <br />
    <label font-family="Courier New" align="left" for="state">State</label>
    <select maxlength=6 align="right" name="state" id="state"
        class="text ui-corner-all">
        <option value="">Select State...</option>
        <c:forEach items="${states}" var="state">
            <option value="${state.fieldValue}">
                ${state.fieldDescription}
            </option>
        </c:forEach>
    </select>
    <br />
    <label font-family="Courier New" align="left" for="stateOther">State (Other):</label>
    <input maxlength=6 align="right" type="text" name="stateOther" id="stateOther" value=""
        class="text ui-corner-all" />
    <br />
    <label font-family="Courier New" align="left" for="zip">Zip</label>
    <input align="right" maxlength=10 align="right" type="text" name="zip" id="zip" value=""
        class="text ui-corner-all" />
    <br />
    <label font-family="Courier New" align="left" align="left" for="product">Product</label>
    <input align="right" maxlength=50 type="text" name="product" id="product" value=""
        class="text ui-corner-all" />
    <br />
    </fieldset>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T14:20:07.893

```
 function saveShippingPoint() {
            $j.ajax({
                url: "urlpath",
                data: { city: $j("#city").val().toUpperCase(),
                    state: $j("#state").val().toUpperCase(),
                    stateOther: $j("#stateOther").val().toUpperCase(),
                    zip: $j("#zip").val(),
                    product: $j("#product").val().toUpperCase()
                },
                type: 'GET',
                cache: false,
                timeout: 30000,
                success: function (data) {
                    alert(JSON.stringify(data));

                    var htmlTr = "<tr><td>" + city.val().toUpperCase() + ", " + state.val().toUpperCase() + "</td>"
                               + "<td><input type='checkbox' name='chk' value='" + data + "' /><input type='hidden' name='shipPointId' value='" + data + "' /></td></tr>";

                   alert(htmlTr);

                    //Or 

                    var htmlTr = "<tr><td>" + $j('#city').val().toUpperCase() + ", " + $j('#state').val().toUpperCase() + "</td>"
                               + "<td><input type='checkbox' name='chk' value='" + data + "' /><input type='hidden' name='shipPointId' value='" + data + "' /></td></tr>";

                    alert(htmlTr);

                    $j('#shipPoints').find('tbody tr:last').after(htmlTr);
                    //Or
                    $j('#shipPoints').find('tbody').append(htmlTr);
                },
                error: function () {
                    alert("There was a problem adding the shipping point.");
                }
            });
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T17:18:17.000

好的，我得到它的工作。

改组了一些代码，内联移动功能等。但这没有帮助。正在进行成功调用，我在调用中获取了 id，但没有创建行，也没有关闭对话框。修改了对话框关闭上的选择器并使其正常工作。所以我想这可能是表格添加上的选择器是问题所在。

我将 html 从 tr.after() 调用中提取出来，并将其放入一个变量中，这样我就可以在 after() 调用之前将它放在一个警报中，这样我就可以保证我传递的是有效的 HTML .. . 出于某种原因，这解决了问题。

这是工作版本。

```
$j("#dialog-form").dialog(
{
    autoOpen : false,
    height : 500,
    width : 500,
    modal : true,
    buttons : 
    {
        "Add Shipping Point" : function() 
        {
            var bValid     = true;
            var cityValid  = true;
            var stateValid = true;
            var zipPresent = true;
            var zipValid   = true;

            updateTips("");
            allFields.removeClass("ui-state-error");

            cityValid  = checkRequired(city, "City");
            stateValid = checkRequired(state, "State");
            zipPresent = checkRequired(zip, "Zip");

            if(zipPresent) { zipValid   = checkRegexp(zip, /(^\d{5}$)|(^\d{5}-\d{4}$)/, "Zip Code"); }

            bValid     = cityValid && stateValid && zipPresent && zipValid;

            if (bValid) 
            {
                //alert("Before save shipping point.");
                function saveShippingPoint() 
                {
                    //alert("Before ajax call.");
                    $j.ajax(
                    {
                        url: "<portlet:resourceURL id='saveShippingPoint'/>" + 
                        "?city=" + $j( "#city" ).val().toUpperCase() +
                        "&state=" + $j( "#state" ).val().toUpperCase() +
                        "&stateOther=" + $j( "#stateOther" ).val().toUpperCase() +
                        "&zip=" + $j( "#zip" ).val() +
                        "&product=" + $j( "#product" ).val().toUpperCase() ,
                        type: 'GET',
                        cache: false,
                        timeout: 30000,
                        success: function(data)
                        {                                      
                            var row = "<tr>"
                            + "<td>"
                            + city.val().toUpperCase()
                            + ", "
                            + state.val().toUpperCase()
                            + "</td>"
                            + "<td>"
                            + "<INPUT type='checkbox' NAME='chk' VALUE='"+ data + "' />"
                            + "<INPUT type='hidden' NAME='shipPointId' VALUE='"+ data + "' />"
                            + "</td>"
                            + "</tr>";

                            //alert("In success callback. About to add row " + row); 

                            //$j("#shipPoints').find('tbody tr:last").after( 
                            $j("#shipPoints tr:last").after(row);
                            //alert("After ajax call. About to call close");
                            $j("#dialog-form").dialog("close");
                        },
                        error: function()
                        {
                            alert("There was a problem adding the shipping point.");
                        }
                    });
                };
                saveShippingPoint();
            }
        },
        Cancel : function() 
        {
            $j(this).dialog("close");
        }
    },
    close : function() 
    {
        allFields.val("").removeClass("ui-state-error");
    }
}); 
```

感谢大家的帮助。如果有人知道为什么引入行变量修复了调用后的问题，请告诉我。

-吉姆

# asp.net-mvc-3 - 为什么我遇到@Href("path") 而不是@Url.Content 的问题？

> ID：10558689
> 
> 赞同：0
> 
> 时间：2012-05-11T21:10:55.893
> 
> 标签：asp.net-mvc-3, razor

我在写一个问题，问为什么@Href 不能正确识别路径。

例如

```
@helper CSS(string cssFile, string media = "screen") {
    <link href="@Href("~/content/stylesheets/" + @cssFile)" rel="stylesheet" type="text/css" media="@media" /> 
} 
```

正在抛出 sereval js 404 错误，试图在其中找到资源

*   http:// 本地主机/内容
*   http://localhost/仪表板/内容

从来没有我想要的：

*   http://localhost/MySite/内容

所以他们我发现了有趣的部分：`@Url.Content`而不是`@Href`正常工作！**为什么！？**

因此这不是更大的问题，问题在于 App_Code @Url 在上下文中不存在。那我可以用什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:47:19.403

MSDN 是你的朋友。来自[WebPageRenderingBase.Href](http://msdn.microsoft.com/en-us/library/system.web.webpages.webpagerenderingbase.href%28v=vs.99%29.aspx)方法：

> 在派生类中重写时，使用指定的参数构建 URL。

而来自[UrlHelper.Content 方法](http://msdn.microsoft.com/en-us/library/system.web.mvc.urlhelper.content.aspx)：

> 将虚拟（相对）路径转换为应用程序绝对路径。

路径中的波浪号使其成为虚拟路径，显然 @Href() 不理解。

# ruby-on-rails - Rails 3：如何将数组播种到seed.rb？

> ID：10558690
> 
> 赞同：0
> 
> 时间：2012-05-11T21:10:56.853
> 
> 标签：ruby-on-rails, activerecord

我有一个`interests`只有一个`:name`属性的表。

我正在尝试播种（通过`seed.rb`）以下数组，以便它们都显示在我的表单中（复选框）......我该怎么做？

有没有比将它存储在更好的方法`seed.rb`？

```
[ "Adventure Sports", "Arts and Crafts", "Beauty/Hair", 
  "Books", "Dining Out", "Fine Art", "Fine Jewelry", 
  "Gardening", "Golf" ] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:14:45.330

如果你想把它放到你的seed.rb中，你可以像在其他地方一样创建它们，例如

```
[ "Adventure Sports", "Arts and Crafts"].each do |interest|
  Interest.create!({:name => interest})
end 
```

或者，您可以将它们作为常量存储在您的模型中，并在您的表单中使用它。

```
class Interest < ActiveRecord::Base
  INTERESTS = [ "Adventure Sports", "Arts and Crafts" ]
end 
```

然后以您的形式，例如：

```
f.select Interest::INTERESTS 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T09:22:20.593

我`find_or_create_by_...`用来确保即使`seeds.rb`再次运行记录也只创建一次：

```
[ "Adventure Sports", "Arts and Crafts"].each do |interest|
  Interest.find_or_create_by_name(interest)
end 
```

作为`name`列名。如果列名是例如`title`使用`find_or_create_by_title`.

它还可以用于设置多个列，例如：

```
[["Adam", 10], ["Allan", 20], ["Andy", 30]].each do |data|
  role = Role.find_by_name("editor").id
  User.find_or_create_by_name_and_credits_and_role_id(data[0], data[1], role)
end 
```

# jquery - Lightbox（videobox.js；mootools 库）在 Mac OS X 和 Windows 的 Firefox 中不起作用

> ID：10558695
> 
> 赞同：1
> 
> 时间：2012-05-11T21:11:04.100
> 
> 标签：jquery, firefox, lightbox

首先，感谢您对此的任何帮助。

我有 jCarousel 滑块设置，用户单击缩略图以获取弹出视频框（弹出视频框是使用此处找到的名为 videobox.js 的脚本完成的：http://videobox-lb.sourceforge.net/ [）](http://videobox-lb.sourceforge.net/)。它在所有其他浏览器中都可以正常工作，但是在 Firefox 中单击水平滑块上的前三个缩略图之一会在新窗口中打开视频和/或链接断开（如果您滚动到接下来的三个缩略图，videobox 会奇怪地正常工作足够的）。页面顶部的两张医生（Bulger 博士、Renaud 博士）的照片工作正常，这让我认为这两个脚本（jsCarousel.js 和 videobox.js）存在冲突。同样，我只在使用 Firefox 时遇到这个问题。想法？

[这是带有滑块（水平和垂直）的网站： http](http://southwest.dogbark.com/) ://southwest.dogbark.com/

**源代码中的JS代码**

```
$.noConflict();
jQuery(document).ready(function() {

jQuery('#carouselv').jsCarousel({ onthumbnailclick: function(src) { alert(src); },   autoscroll: false, masked: false, itemstodisplay: 4, orientation: 'v' });
jQuery('#carouselh').jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: false, masked: false, itemstodisplay: 6, orientation: 'h' });
jQuery('#carouselhAuto').jsCarousel({ onthumbnailclick: function(src) { alert(src); }, autoscroll: false, masked: true, itemstodisplay: 6, orientation: 'h' });

    }); 
```

# php - str_replace 一个 .TPL 变量？

> ID：10558697
> 
> 赞同：0
> 
> 时间：2012-05-11T21:11:04.440
> 
> 标签：php, smarty, str-replace

我有一个名为 {$user.login} 的变量，我在这样的 URL 中使用它：

[http://profiles.mysite.com/](http://profiles.mysite.com/) {$user.login}

我想用 + 符号替换空格，如下所示：

“用户名”变为“用户+名称”。

这样，我的链接会更干净。

而不是[http://profiles.mysite.com/User%20name](http://profiles.mysite.com/User%20name)我会有[http://profiles.mysite.com/User+name](http://profiles.mysite.com/User+name)

我有什么办法可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:19:59.027

PHP 函数[urlencode](http://php.net/urlencode)将空格转换为`+`符号。

尝试： `http://profiles.mysite.com/{$user.login|urlencode}`在您的模板中。

# mysql - 使用 InnoDB 进行慢速 INSERT .. ON DUPLICATE KEY UPDATE 查询

> ID：10558700
> 
> 赞同：0
> 
> 时间：2012-05-11T21:11:18.310
> 
> 标签：mysql

基本上我正在监控网站上最慢的查询。事实证明它们是这样的：

```
INSERT INTO beststat (bestid,period,rawView) VALUES ( 'idX' , 2012 , 1 ) 
   ON DUPLICATE KEY UPDATE rawView = rawView+1 
```

基本上它是一个记录表。如果该行已经存在，它会更新`rawView`为`+1`

`beststat`所以`InnoDB`我有行级锁定和考虑我做了很多插入更新它应该比 MyISAM 更快。

无论如何，该查询不应该花这么长时间，也许还有其他问题。可能是什么？

当然我有`Unique` `Index`一个`bestid, period`

## 附加信息

**该表（ beststat**）目前有约 100 万条记录，其大小为：**68MB**。我有**4GB** RAM 和`innodb buffer pool size`= **104,857,600**。mysql：5.1.49-3

```
CREATE TABLE `beststat` (
 `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
 `bestid` int(11) unsigned NOT NULL,
 `period` mediumint(8) unsigned NOT NULL,
 `view` mediumint(8) unsigned NOT NULL DEFAULT '0',
 `rawView` mediumint(8) unsigned NOT NULL DEFAULT '0',
 PRIMARY KEY (`id`),
 UNIQUE KEY `bestid` (`bestid`,`period`)
) ENGINE=InnoDB AUTO_INCREMENT=2020577 DEFAULT CHARSET=utf8 
```

* * *

请注意，我可以做一些更快的事情，例如：

```
UPDATE beststat SET rawView = rawView + 1 WHERE bestid = idX AND period = 2012;
if (mysql_affected_rows()==0)
  INSERT INTO beststat (bestid,period,rawView) VALUES ('idX',2012,1) 
```

所以大多数时候我只会运行第一个查询`UPDATE`。但我想了解为什么第一个更简洁的查询很慢。

* * *

我发现[这篇有趣的文章](http://www.tokutek.com/2010/07/why-insert-on-duplicate-key-update-may-be-slow-by-incurring-disk-seeks/)...仍在阅读

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-11T23:10:28.460

处理大量行，我建议使用加载日期文件来加快查询速度。为了进一步提高查询时间，您也可以考虑使用内存表。

# c++ - 删除文件、C++、WinCE

> ID：10558702
> 
> 赞同：1
> 
> 时间：2012-05-11T21:11:32.797
> 
> 标签：c++, windows-ce, delete-file, evc4

这有什么问题？

```
if((
::DeleteFile( L"IO.res"))== NULL)
MessageBox(NULL,L"Error",L"OK",MB_OK); 
```

我在同一目录中有 IO.res 文件，但程序无法删除它。使用集成的文件管理器，我可以删除。我使用 EVC4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:32:35.207

Windows CE 没有任何“当前”或“工作”目录的概念。您必须提供要删除的文件的完全限定路径。

# linux - POSIX 队列和 msg_max

> ID：10558721
> 
> 赞同：6
> 
> 时间：2012-05-11T21:12:52.977
> 
> 标签：linux, posix, message-queue

我正在玩弄 POSIX 队列，但遇到了一个问题。创建新队列时，我可以指定例如消息的大小以及队列中可以有多少条消息。我的正常限制是 10，如发现

```
/proc/sys/fs/mqueue/msg_max 
```

有没有一种简单的方法可以在程序执行期间更改它，除了

```
echo number > /proc/sys/fs/mqueue/msg_max 
```

也许存在一些用于设置此类内容的系统调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-13T08:00:06.540

不。

该限制是系统范围的限制；这就是为什么它在`/proc/sys`。如果要更改它，则必须使用`echo`已显示的命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T01:13:43.340

队列在创建时设置，您无法在中途更改它。您可以通过在创建队列时以特权用户身份运行来增加队列消息的数量。因此，您要么必须运行单独的程序（作为 PU）来创建队列，要么作为 PU 运行、创建队列并在完成后删除权限。您最多可以增加的消息数量仍然受到队列整体大小的限制，因此您必须进行一些划分（减去少量开销字节）。如果您在 Google 周围搜索，则有一个简单的公式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-01T21:00:59.333

终于找到了： [Re: POSIX Message Queues](https://www.redhat.com/archives/rhl-list/2005-November/msg02922.html)

> 编辑 /etc/sysctl.conf 并添加以下行：
> 
> # 增加消息队列
> 
> fs.mqueue.msg_max = 100

在 Raspbian 上为我工作

# c - OpenGL - 着色器，符号在 v. 和 f 中定义为 2 种不同类型。着色器

> ID：10558723
> 
> 赞同：1
> 
> 时间：2012-05-11T21:13:03.177
> 
> 标签：c, opengl, shader

我正在从本教程中学习 OpenGL：http: [//openglbook.com/the-book/](http://openglbook.com/the-book/)。我有着色器的问题。我在编译/链接着色器时遇到错误，但我不知道我做错了什么。

错误：

> 符号 ex_Color 在顶点和片段着色器中使用 2 种不同类型定义。

着色器（由于 GLSL 版本，我对其进行了一些修改）：

```
const GLchar* VertexShader =
{
    "#version 130\n"\

    "in vec4 in_Position;\n"\
    "in vec4 in_Color;\n"\

    "out vec4 ex_Color;\n"\

    "void main(void)\n"\
    "{\n"\
    "       gl_Position = in_Position;\n"\
    "       ex_Color = in_Color;\n"\
    "}\n"
};

const GLchar* FragmentShader =
{
    "#version 130\n"\

    "precision mediump float;\n"\

    "in vec4 ex_Color;\n"\

    "out vec4 out_Color;\n"\

    "void main(void)\n"\
    "{\n"\
    "       out_Color = ex_Color;\n"\
    "}\n"
}; 
```

源代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <GL/glew.h>
#include <GL/freeglut.h>
#define WINDOW_TITLE_PREFIX "Chapter 2"

int CurrentWidth = 800,
    CurrentHeight = 600,
    WindowHandle = 0;

unsigned FrameCount = 0;

GLuint
    VertexShaderId,
    FragmentShaderId,
    ProgramId,
    VaoId,
    VboId,
    ColorBufferId;

    const GLchar* VertexShader =
    {
            "#version 130\n"\

            "in vec4 in_Position;\n"\
            "in vec4 in_Color;\n"\

            "out vec4 ex_Color;\n"\

            "void main(void)\n"\
            "{\n"\
            "       gl_Position = in_Position;\n"\
            "       ex_Color = in_Color;\n"\
            "}\n"
    };

    const GLchar* FragmentShader =
    {
            "#version 130\n"\

            "precision mediump float;\n"\

            "in vec4 ex_Color;\n"\

            "out vec4 out_Color;\n"\

            "void main(void)\n"\
            "{\n"\
            "       out_Color = ex_Color;\n"\
            "}\n"
    };

void Initialize(int, char*[]);
void InitWindow(int, char*[]);
void ResizeFunction(int, int);
void RenderFunction(void);
void TimerFunction(int);
void IdleFunction(void);
void Cleanup(void);
void CreateVBO(void);
void DestroyVBO(void);
void CreateShaders(void);
void DestroyShaders(void);

int main(int argc, char* argv[])
{
    Initialize(argc, argv);

    glutMainLoop();

    exit(EXIT_SUCCESS);
}

void Initialize(int argc, char* argv[])
{
    GLenum GlewInitResult;

    InitWindow(argc, argv);

    glewExperimental = GL_TRUE;
    GlewInitResult = glewInit();

    if (GLEW_OK != GlewInitResult) {
        fprintf(
            stderr,
            "ERROR: %s\n",
            glewGetErrorString(GlewInitResult)
        );
        exit(EXIT_FAILURE);
    }

    fprintf(
        stdout,
        "INFO: OpenGL Version: %s (GLSL = %s)\n",
        glGetString(GL_VERSION),
        glGetString(GL_SHADING_LANGUAGE_VERSION) 
    );

    CreateShaders();
    CreateVBO();

    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
}

void InitWindow(int argc, char* argv[])
{
    glutInit(&argc, argv);

    glutInitContextVersion(3, 1);
    glutInitContextFlags(GLUT_FORWARD_COMPATIBLE);
    glutInitContextProfile(GLUT_CORE_PROFILE);

    glutSetOption(
        GLUT_ACTION_ON_WINDOW_CLOSE,
        GLUT_ACTION_GLUTMAINLOOP_RETURNS
    );

    glutInitWindowSize(CurrentWidth, CurrentHeight);

    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);

    WindowHandle = glutCreateWindow(WINDOW_TITLE_PREFIX);

    if(WindowHandle < 1) {
        fprintf(
            stderr,
            "ERROR: Could not create a new rendering window.\n"
        );
        exit(EXIT_FAILURE);
    }

    glutReshapeFunc(ResizeFunction);
    glutDisplayFunc(RenderFunction);
    glutIdleFunc(IdleFunction);
    glutTimerFunc(0, TimerFunction, 0);
    glutCloseFunc(Cleanup);
}

void ResizeFunction(int Width, int Height)
{
    CurrentWidth = Width;
    CurrentHeight = Height;
    glViewport(0, 0, CurrentWidth, CurrentHeight);
}

void RenderFunction(void)
{
    ++FrameCount;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glDrawArrays(GL_TRIANGLES, 0, 3);

    glutSwapBuffers();
    glutPostRedisplay();
}

void IdleFunction(void)
{
    glutPostRedisplay();
}

void TimerFunction(int Value)
{
    if (0 != Value) {
        char* TempString = (char*)
            malloc(512 + strlen(WINDOW_TITLE_PREFIX));

        sprintf(
            TempString,
            "%s: %d Frames Per Second @ %d x %d",
            WINDOW_TITLE_PREFIX,
            FrameCount * 4,
            CurrentWidth,
            CurrentHeight
        );

        glutSetWindowTitle(TempString);
        free(TempString);
    }

    FrameCount = 0;
    glutTimerFunc(250, TimerFunction, 1);
}

void Cleanup(void)
{
    DestroyShaders();
    DestroyVBO();
}

void CreateVBO(void)
{
    GLfloat Vertices[] = {
        -0.8f, -0.8f, 0.0f, 1.0f,
         0.0f,  0.8f, 0.0f, 1.0f,
         0.8f, -0.8f, 0.0f, 1.0f
    };

    GLfloat Colors[] = {
        1.0f, 0.0f, 0.0f, 1.0f,
        0.0f, 1.0f, 0.0f, 1.0f,
        0.0f, 0.0f, 1.0f, 1.0f
    };

    GLenum ErrorCheckValue = glGetError();

    glGenVertexArrays(1, &VaoId);
    glBindVertexArray(VaoId);

    glGenBuffers(1, &VboId);
    glBindBuffer(GL_ARRAY_BUFFER, VboId);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);
    glVertexAttribPointer(0, 4, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

    glGenBuffers(1, &ColorBufferId);
    glBindBuffer(GL_ARRAY_BUFFER, ColorBufferId);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Colors), Colors, GL_STATIC_DRAW);
    glVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(1);

    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not create a VBO: %s \n",
            gluErrorString(ErrorCheckValue)
        );

        exit(-1);
    }
}

void DestroyVBO(void)
{
    GLenum ErrorCheckValue = glGetError();

    glDisableVertexAttribArray(1);
    glDisableVertexAttribArray(0);

    glBindBuffer(GL_ARRAY_BUFFER, 0);

    glDeleteBuffers(1, &ColorBufferId);
    glDeleteBuffers(1, &VboId);

    glBindVertexArray(0);
    glDeleteVertexArrays(1, &VaoId);

    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not destroy the VBO: %s \n",
            gluErrorString(ErrorCheckValue)
        );

        exit(-1);
    }
}

void CreateShaders(void)
{
    GLenum ErrorCheckValue = glGetError();

    VertexShaderId = glCreateShader(GL_VERTEX_SHADER);
    glShaderSource(VertexShaderId, 1, &VertexShader, NULL);
    glCompileShader(VertexShaderId);

    GLint vertex_shader_status;
    glGetShaderiv(FragmentShaderId, GL_COMPILE_STATUS, &vertex_shader_status);
    if (vertex_shader_status == 0)
    {
        GLint logLength;

        glGetShaderiv(FragmentShaderId, GL_INFO_LOG_LENGTH, &logLength);
        if (logLength > 0)
        {
            GLchar *log = (GLchar *)malloc(logLength);
            glGetShaderInfoLog(FragmentShaderId, logLength, &logLength, log);
            fprintf(
                stderr,
                "ERROR: Could not create the vertex shader: %s \n",
                log
            );
            free(log);
        }
        glDeleteShader(FragmentShaderId);

    } 

    FragmentShaderId = glCreateShader(GL_FRAGMENT_SHADER);
    glShaderSource(FragmentShaderId, 1, &FragmentShader, NULL);
    glCompileShader(FragmentShaderId);

    ProgramId = glCreateProgram();
        glAttachShader(ProgramId, VertexShaderId);
        glAttachShader(ProgramId, FragmentShaderId);
        glBindAttribLocation(ProgramId, 0, "in_Position");
        glBindAttribLocation(ProgramId, 1, "in_Color");
    glLinkProgram(ProgramId);
    glUseProgram(ProgramId);

    GLint logLength, status;

    glValidateProgram(ProgramId);
    glGetProgramiv(ProgramId, GL_INFO_LOG_LENGTH, &logLength);
    if (logLength > 0)
    {
        GLchar *log = (GLchar *)malloc(logLength);
        glGetProgramInfoLog(ProgramId, logLength, &logLength, log);
        fprintf(
                stderr,
                "ERROR: Could not create the program: %s \n",
                log
            );
        free(log);
    }

    glGetProgramiv(ProgramId, GL_VALIDATE_STATUS, &status);
    if (status == 0) {
        fprintf(
                stderr,
                "ERROR: Could not create the program: \n"
            );
    }

    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not create the shaders: %s \n",
            gluErrorString(ErrorCheckValue)
        );
        exit(-1);
    }
}

void DestroyShaders(void)
{
    GLenum ErrorCheckValue = glGetError();

    glUseProgram(0);

    glDetachShader(ProgramId, VertexShaderId);
    glDetachShader(ProgramId, FragmentShaderId);

    glDeleteShader(FragmentShaderId);
    glDeleteShader(VertexShaderId);

    glDeleteProgram(ProgramId);

    ErrorCheckValue = glGetError();
    if (ErrorCheckValue != GL_NO_ERROR)
    {
        fprintf(
            stderr,
            "ERROR: Could not destroy the shaders: %s \n",
            gluErrorString(ErrorCheckValue)
        );
        exit(-1);
    }
} 
```

我有 Mobility Radeon HD4570 显卡（OpenGL 3.1、GLSL 1.30）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:21:55.437

“精度中等浮点数；” 更改该着色器中定义的所有浮点数的类型。您使用该声明是否有原因？请注意，每个规范的 GLSL 根本没有任何意义。添加它是为了与 GLES 兼容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:19:52.000

如果我没记错的话，默认情况下浮点数`highp`在顶点着色器中具有精度。添加`mediump`到`out vec ex_Color`顶点着色器中。

# css - IE 上的 CSS 渐变和阴影

> ID：10558724
> 
> 赞同：0
> 
> 时间：2012-05-11T21:13:08.090
> 
> 标签：css, internet-explorer, less

我一直在努力让阴影在 IE 上工作……它们在 chrome、safari 和 firefox 中运行良好！有人有这方面的经验吗？我把网站放在了上面，这样你就可以看到完整的代码和输出。

[测试地点](http://3rdrockmarketing.com/CLIENTsites/Website%20Frame/)

我正在使用lesscss，所以也许这是我的问题？我希望不是！！！我也在使用 IE CSS3 Fix，[ie-css3.htc](http://fetchak.com/ie-css3/)我使用的代码如下......我试图在没有 htc 的情况下这样做，但没有运气......至少 htc 让我的背景渐变到在 IE 中工作......在它只显示蓝黑色之前，默认的 Microsoft 背景渐变颜色。

**预定义.less**

```
.RUNgradient(@COLOR: @CLR1){
  @CLRL:lighten(@COLOR, 10%);
  @CLRD:darken(@COLOR, 10%);
  background-color: @CLRL;
  background-repeat:repeat-x;
  background-image: -khtml-gradient(linear, left top, left bottom, from(@CLRL), to(@CLRD));
  background-image: -moz-linear-gradient(top, @CLRL, @CLRD);
  background-image: -ms-linear-gradient(top, @CLRL, @CLRD);
  background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, @CLRL), color-stop(100%, @CLRD));
  background-image: -webkit-linear-gradient(top, @CLRL, @CLRD);
  background-image: -o-linear-gradient(top, @CLRL, @CLRD);
  background-image: linear-gradient(top, @CLRL, @CLRD);
  behavior: url(css/ie-css3.htc);
} 
```

**样式.less**

```
div.wrapper{
    width:500px;
    margin:25px auto;
    padding: 10px 25px;
    text-align:center;
    .RUNgradient;
    .RUNshadow;
    p{
        font:24px @HEADERFONT;
        color:#ffffff;
        .RUNtextshadow;
    }
} 
```

过滤器就是答案！几乎...

对于梯度，

```
 filter: ~"progid:DXImageTransform.Microsoft.gradient(startColorStr="@CLRL~", EndColorStr="@CLRD~")"; 
```

而对于阴影，

```
 filter: ~"progid:DXImageTransform.Microsoft.shadow(color="@SCLR~", Direction="@DIR~", Strength="@STR~")"; 
```

唯一剩下的就是改变方向，使阴影在元素周围可见，而不仅仅是一侧。

## 解决方案

在研究了 Microsoft Filters 之后，我想出了如何获得类似的效果。我喜欢的角落有点粗糙，但这比以前更近了！

这是我使用的影子文件管理器...

```
.RUNshadow(@BLURRING:10px){
    @SCLR:#111111;
    @DIR:225;
    @DIR2:45;
    @DIR3:135;
    @DIR4:315;
    @STR:4;
  box-shadow: 0px 1px @BLURRING #111111;
  -moz-box-shadow: 0px 1px @BLURRING #111111;
  -webkit-box-shadow: 0px 1px @BLURRING #111111;
  filter: ~"progid:DXImageTransform.Microsoft.shadow(color="@SCLR~", Direction="@DIR2~", Strength="@STR~")
     progid:DXImageTransform.Microsoft.shadow(color="@SCLR~", Direction="@DIR~", Strength="@STR~")
     progid:DXImageTransform.Microsoft.shadow(color="@SCLR~", Direction="@DIR3~", Strength="@STR~")
     progid:DXImageTransform.Microsoft.shadow(color="@SCLR~", Direction="@DIR4~", Strength="@STR~")";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:19:04.317

> 我一直在努力让阴影在 IE 上工作……它们在 chrome、safari 和 firefox 中运行良好！有人有这方面的经验吗？”

是的，这很正常。大多数人不打扰。记得问问自己，[网站是否需要在每个浏览器中看起来完全一样？](http://dowebsitesneedtolookexactlythesameineverybrowser.com/)

如果你真的想要这个，你必须使用 IE 的[渐变过滤](http://msdn.microsoft.com/en-us/library/ms532847.aspx)器。将以下样式添加到您的`RUNgradient`类中：

```
filter: ~"progid:DXImageTransform.Microsoft.gradient(startColorStr="@CLRL~", EndColorStr="@CLRD~")"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:20:25.320

对于它们两者，您都可以使用 IE 过滤器。

您可以使用[`gradient filter`](http://msdn.microsoft.com/en-us/library/ms532997%28v=vs.85%29.aspx)渐变和[`Shadow filter`](http://msdn.microsoft.com/en-us/library/ms533086%28v=vs.85%29.aspx)阴影。渐变滤镜效果很好，阴影滤镜看起来很糟糕。

您可以在过滤器的文档中阅读如何使用它们。但如果你想自动完成，你需要看看[CSS3](http://css3please.com/)如何处理过滤器并将渐变转换为 IE 过滤器渐变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T05:05:03.213

您需要将这些行添加到样式标签以使其在 IE 中工作，

**filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#444444', endColorstr='#222222'); /* IE6 和 IE7 */**

**-ms-filter:"progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#444444', endColorstr='#222222')"; /* IE8 */**

示例代码片段：

.ms-viewheadertr ms-vhltr { background: #222 ;/*当渐变不填充时，它会填充颜色*/

背景：-webkit-linear-gradient(#444, #222);/* 适用于 Safari 5.1 到 6.0 */

背景：-moz-linear-gradient(#444, #222);/* 对于 Firefox 3.6 到 15 */

背景：-o-linear-gradient(#444, #222);/* 对于 Opera 11.1 到 12.0 */

background: linear-gradient(#444, #222);/* 标准语法 */

filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#444444', endColorstr='#222222'); /* IE6 和 IE7 */

-ms-filter:"progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='#444444', endColorstr='#222222')"; /* IE8 */

}

# php - 服务器页面语言在易用性或可用性方面有何贡献？

> ID：10558734
> 
> 赞同：-2
> 
> 时间：2012-05-11T21:13:39.427
> 
> 标签：php, web-services

本站用于比较一些CMS“内容管理系统” [http://www.cmsmatrix.org](http://www.cmsmatrix.org)

以及这个特性“服务器页面语言”下的易用性这个特性对可用性有何贡献？php、ASP、.. ??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:15:00.350

您选择的服务器端语言**不会**以任何有意义的方式影响 CMS 的易用性或可用性。

# php - codeigniter Disallowed Key Characters 错误

> ID：10558738
> 
> 赞同：1
> 
> 时间：2012-05-11T21:14:21.917
> 
> 标签：php, sql, forms, codeigniter

> **可能重复：**
> [CodeIgniter Disallowed Key Characters](https://stackoverflow.com/questions/4197976/codeigniter-disallowed-key-characters)

我试图将表单提交给控制器，然后将其插入数据库。它在过去几天有效，但显然我不小心改变了一些东西，因为它“随机”不起作用。任何帮助将不胜感激，因为我在网上搜索后无法弄清楚。谢谢！

PHP

```
 public function    houses () {
if ($this->input->post()) {
    $bedrooms = $this->input->post('bedrooms');
    $bathrooms = $this->input->post('bathrooms');
    $street = $this->input->post('street');
    $house_number = $this->input->post('house_number');
    $basement = $this->input->post('basement');
    $garage = $this->input->post('garage');
    $fence = $this->input->post('fence');

    $query = $this->db->query('INSERT INTO houses VALUES (NULL, "'.
         $bedrooms.'","'.$bathrooms.'","'.$house_number.'","'.
         $street.'","'.$basement.'","'.$garage.'","'.$fence.'")');
}

$query = $this->db->query("SELECT * FROM houses");

foreach($query->result() as $row) {
    $data['bedrooms'] = $row->bedrooms; $data['bathrooms'] = $row->bathrooms;
    $data['house_number'] = $row->house_number;
    $data['street'] = $row->street; $data['garage'] = $row->garage;
    $data['basement'] = $row->basement; $data['fence'] = $row->fence;
    $data['id'] = $row->id;

    $this->data['houses'][] = $data;
}

$title = 'Houses';
$this->data['title'] = $title;
$this->template->add_css('css/dog.css');
$this->template->write_view('content', 'houses', $this->data);
$this->template->render();
 } 
```

HTML

```
<form method='post' action='<?php site_url('welcome/houses')?>'>
  <li><span>Bedrooms</span>
    <input type="text" name="be stdClass::$emaildrooms" /></li>
  <li><span>Bathrooms</span>
    <input type="text" name="bathrooms" /></li>
  <li><span>House Number</span>
    <input type="text" name="house_number" /></li>
  <li><span>Street</span>
    <input type="text" name="street" /></li>
 <li>
   <span>Basement</span>
   <select name="basement">
     <option>Yes</option>
     <option>No</option>
   </select><br/>
 </li>
 <li>
   <span>Garage</span>
   <select name="garage">
     <option>Yes</option>
     <option>No</option>
   </select><br/>
 </li>
 <li>
   <span>Fence</span>
   <select name="fence">
     <option>Yes</option>
     <option>No</option>
   </select><br/>
 </li>
 <input type="submit" name="Submit" />
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:33:06.920

你的错误在这里：

```
<input type="text" name="be stdClass::$emaildrooms" /> 
```

`be stdClass::$emaildrooms`包含 Codeigniter 不允许在输入键中使用的字符。

无论如何，它看起来像是一个错误，好像`stdClass::$email`以某种方式偷偷溜进去 - 也许当您在文件中进行大量搜索/替换时。

# c - 如何在char数组C中使用正则表达式

> ID：10558739
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:14:29.043
> 
> 标签：c, regex, arrays, expression

## 编辑：

再一次，我将尝试更准确地解释它。

我正在编写 IRC 客户端 - 基于套接字的网络应用程序。使用函数从服务器接收数据`recv()`并将它们一个字符一个字符地存储在`rBuf[]`数组中。
然后将它们复制到`rBufh[]`传递给解析函数的数组中。
重要的是服务器一次只发送一个字符[一个字符在一个recv（）中]和键（存储在两个dim.array []中的字符数组`key1`）是字符串，如果解析方法在接收到的数据中找到其中一个它需要根据协议文档中指定的 3 位代码做出正确反应。- 至于基础。

解析算法/函数的工作原理如下：

1.  `key1`（包含键）和`rBufh` 数组是传递给它的参数
2.  获取存储的第一个字符串的第一个字符`key1`并将其与第一个字符进行比较`rBufh`
3.  如果它们匹配返回`int ret = 2`（这意味着“在收到的数据中找到了部分密钥”

现在`recv()`将一个字符（因为服务器每次只发送字符）添加到`rBufh`数组中，该数组再次传递给解析函数，算法再次开始，直到找到匹配的键，返回`int ret = 1`（找到匹配的键）或者`int ret = 0`如果在第 3 步中他们没有匹配。

在解析器工作时，停止打印到标准输出并根据解析器打印返回的值停止较长时间（如果`key1`找到数组中的一个键的一部分）或允许打印（如果已找到整个键或解析器无法将`rBufH`数组中传递给它的字母与存储在`key1`) 中的任何键匹配

我们越来越接近理解我的要求 - 我希望:)

存储在数组中的字符串数量`key1`是事先知道的，因为它们在协议文档中指定。因此可以在定义时立即对其进行初始化。

我问的是：

是否可以传递给`key1`（不一定像我那样使用 sprintf - 它看起来很方便）字符串，该字符串将包含代码的某些部分，意思是“任何三位数字”。

例如
，让上面 3 行提到的代码部分用 XXX 标记

`key1[0] = "irc2.gbatemp.net XXX nickname"`

现在，如果解析器遇到任何与 key1[0] 匹配的字符串，其中包含任意三位数代替 XXX，它将返回 1 - 因此其他函数将有可能做出正确反应。

这样我就不必在`key1`数组中存储许多具有不同 XXX 值的字符串，而只需一个可以匹配所有字符串的字符串。

* * *

好的，现在我真的尽力帮助您理解它并获得答案:)

问候
汤姆

附言

随意更改此主题的标题，因为我真的不知道应该如何用您已经注意到的几句话来描述这个问题。（之所以如此，是因为我的第一个想法是将一些正则表达式传递给`key1`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:22:19.463

如果您只想在字符串中插入任意 3 位数字，请执行以下操作：

```
int n = 123; // some integer value that you want to represent as 3 digits
sprintf(key1[1], ":irc2.gbatemp.net %03d %s ", n, nickname); 
```

请注意，`%03d`格式说明符不是正则表达式 - 它只是指定整数参数将显示为 3 位十进制值，如果需要，前导零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:25:20.490

你不能告诉编译器。签名是

`int sprintf ( char * str, const char * format, ... );`

编译器不查看格式字符串内部，甚至不确保您匹配您的 %d、%s 和 int、char* 。这必须是运行时的。就像

```
int printKey(char* key, int n) {
    if(!(0 <= n && n <= 999)) { 
        return -1; //C-style throw an error
    }
    sprintf(key, ":irc2.gbatemp.net %d %s", n, nickname);
    return 0;
} 
```

也使用 snprintf 而不是 sprintf 或者你要求内存问题。

# ruby-on-rails - Rails 数据库关系： Post.category.name = ? （未定义的方法“名称”）

> ID：10558749
> 
> 赞同：1
> 
> 时间：2012-05-11T21:15:12.743
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

每个帖子只有一个类别，我需要通过类似的方式访问类别的名称

```
p = Post.new
p.category.name = "tech"
p.save 
```

怎么做？

* * *

```
 class Category < ActiveRecord::Base
       has_many :posts, :dependent => :destroy

       attr_accessible :name, :image

    end 
```

Post.rb

```
class Post < ActiveRecord::Base
    belongs_to :category

    attr_accessible :category_id, :name, :text, :lang, :image

end 
```

架构.rb

```
create_table "categories", :force => true do |t|
    t.string "name"
    t.string "image"
  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:24:59.530

您的示例包含一个问题。

```
p = Post.new
p.category.name = "tech"
p.save 
```

首先，您创建一个新帖子。其次，您想为帖子的类别分配名称，但没有分配类别。这会导致调用类似于`post.nil.name`where`nil`将是类别对象（如果已分配），但事实并非如此。由于`nil`没有方法`name`，您会得到描述的错误`undefined method name for nil class`。

要解决这个问题，您首先需要分配一个类别来处理。

`p.category = Category.first`或`p.category_id = 1`。之后，`p.category`将返回类别对象，因此`p.category.name`是有效的，因为它是在类别对象上而不是在 上调用的`nil`。

**tl;博士：**

```
p = Post.new
p.category # => nil
p.category.name # throws an error

p.category = Category.first
p.category # => <#Category ...>
p.category.name # => 'actual name of category'
p.category.name = 'foo' # works now 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:27:28.410

问题是如果类别记录不存在，您需要/想要显式构建它。

为了解决这个问题，我会考虑`category_name=`在 Post 中创建一个方法：

`category_name=`设定者还将处理“得墨忒耳[法则”](http://en.wikipedia.org/wiki/Law_of_Demeter)问题

```
class Post < ActiveRecord::Base
  belongs_to :category

  attr_accessible :category_id, :name, :text, :lang, :image

  attr_accessible :category_name=, :category_name

  def category_name=(name)
    self.category = Category.find_or_create_by_name(name)
  end

  def category_name
    category && category.name
  end 
```

结尾

另请参阅[ActiveRecord](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)文档中的“关联扩展”以了解另一种方法。

# c++ - 是否有任何预制的库或程序可以生成格式良好的 CPE？

> ID：10558751
> 
> 赞同：2
> 
> 时间：2012-05-11T21:15:23.707
> 
> 标签：c++, ruby-on-rails, c, ruby

我的公司目前正在从我们的客户端代理中提取特定于机器的信息（操作系统、架构等），以跟踪趋势和信息。我们将这些信息映射到后端，但现在希望将其标准化为[CPE](http://cpe.mitre.org/)（通用平台枚举）格式。

有谁知道任何可以生成格式良好的 CPE 的技术（来自我们传入的信息或直接来自操作系统的信息）？我们的代理是 C/C++，我们的后端是 Ruby。

# php - 如何了解 mvc 与工厂模式的关系

> ID：10558754
> 
> 赞同：1
> 
> 时间：2012-05-11T21:16:06.313
> 
> 标签：php, model-view-controller, factory

抱歉，如果是一个虚拟问题，但我不太清楚。使用 php.ini 将工厂模式集成到 mvc 中是一种好习惯吗？例如，我可以有以下库结构：

```
index.php
 --init
   --abstract factory class for models
 --models 
   --model extend factory class 
 --controllers
 --views 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:02:52.573

这里要注意的一件事是，模型不应该从工厂扩展，而是您通常会直接使用工厂，这反过来又应该返回一个初始化的模型。例如，假设您有一个冷冻披萨（模型）和一个烤箱（工厂）；与其直接吃冷冻披萨，不如先使用烤箱，然后从中获得真正的可食用披萨。对于非常复杂的烤箱类型（如果对象创建过程涉及很多，请阅读），工厂模式是有意义的。

除此之外，如果您觉得它对您的需求有用，没有理由不使用该模式。我通常也将工厂直接包括在我存储模型的地方，因为它们都非常依赖于彼此（例如，如果没有另一个，一个将无法工作），但这只是我猜的口味问题。

最后一个提示：当你真的认为你需要它们时使用它们，而不是因为它们听起来很花哨。如果您认为*不*使用工厂模式可以让您的生活更轻松，并且可以更快地完成您的项目，那么千万不要使用它。这并不是说您不应该探索新模式，而是始终合理化实施和维护它们的时间和精力是否合理。

# mysql - 在 mysql 查询中使用 GROUP_CONCAT 并得到意外结果

> ID：10558757
> 
> 赞同：2
> 
> 时间：2012-05-11T21:16:28.620
> 
> 标签：mysql

我`GROUP_CONCAT`在 mysql 查询中使用，但查询给了我意想不到的未知结果。这是查询：

```
SELECT GROUP_CONCAT( DISTINCT (categoryid) )
FROM jos_community_groups
WHERE team_classification
IN (
      SELECT id
      FROM jos_league_classification
      ORDER BY winning_criteria ASC
   )
AND show_in_contact =1
AND team_state = 'Georgia'
AND categoryid
IN ( 
      SELECT sportstypeid
      FROM jos_gsa_tournament
      WHERE directorid =305
   )
ORDER BY categoryid, team_agegroup, team_classification 
```

结果看起来像这样

```
GROUP_CONCAT( DISTINCT ( categoryid ) )  // column
[BLOB - 10B]                             // result 
```

我想要逗号分隔的 categoryid 字符串，但我不明白为什么查询会给出这种类型的结果以及查询中缺少什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:26:26.987

问题仍然不清楚，但我想这会解决你的问题。像这样对 group_concat 进行强制转换：

> cast(group_concat(DISTINCT(categoryid)) as char)

# java - 接受对表中 JTextField 和 JTextArea 的关注

> ID：10558758
> 
> 赞同：0
> 
> 时间：2012-05-11T21:16:37.560
> 
> 标签：java, swing, jtable, tablecellrenderer, tablecelleditor

我有一个三列 JTable：一个不可编辑的 JTextField、一个可编辑的 JTextArea 和一个可编辑的 JTextField。

我的问题是双重的。我希望最后两列背景突出显示并准备好编辑，当我进入它们时，带有可见光标。他们还使用特定的字体；因此自定义渲染器和编辑器。

如果我在其中一个单元格中单击两次，我会成功，但如果我使用键盘到达那里，则不会。我可以从一个单元格切换到另一个单元格（感谢对 JTextArea 的 setTraversalKeys 调用）并开始输入，但焦点所在的位置并不明显。

我有一个焦点事件侦听器，它在触发它的任何组件上设置背景颜色。它用于用于单元格编辑的 JTextField 和 JTextArea，以及用于良好度量的单元格渲染器。但只有鼠标点击才会触发它们。

如何确保在我要进入的单元格上触发焦点事件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T16:13:14.760

您应该听取选择更改并在需要的地方开始编辑：

```
 final JTable table = new JTable (
            new String[][]{ { "col1", "col2", "col3" }, { "col1", "col2", "col3" } },
            new String[]{ "1", "2", "3" } );
    ListSelectionListener listener = new ListSelectionListener ()
    {
        public void valueChanged ( ListSelectionEvent e )
        {
            if ( table.getSelectedRow () != -1 && table.getSelectedColumn () != -1 )
            {
                table.editCellAt ( table.getSelectedRow (), table.getSelectedColumn () );
            }
        }
    };
    table.getColumnModel ().getSelectionModel ().addListSelectionListener ( listener );
    table.getSelectionModel ().addListSelectionListener ( listener ); 
```

那只是一个示例，您可以如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T00:51:13.113

谢谢你们。这就是我最终的结果：

```
 ListSelectionListener listener = new ListSelectionListener() {
        public void valueChanged(ListSelectionEvent e) {
            int row = table.getSelectedRow();
            int col = table.getSelectedColumn();

            // Only columns beyond the first are edited...
            if (row != -1 && col > 0) {
                table.editCellAt(row, col);
                try {
                    Robot robot = new Robot();
                    robot.keyPress(KeyEvent.VK_F2);
                    robot.keyRelease(KeyEvent.VK_F2);
                } catch (AWTException e1) {
                    e1.printStackTrace();
                }
            }
        }
    }; 
```

响应 editCell() 调用而创建的单元格编辑器在它们使用的 JTextArea 和 JTextField 上设置背景颜色。机器人的目的是模拟 F2 的按下，从而显示光标（错误的术语，我知道，但正确的术语逃脱了我）。

机器人在向前移动时工作，但不向后移动，尽管会出现阴影。我不知道在这种情况下是否执行了这段代码片段，尽管单元格编辑器是以某种方式创建的。由于这个程序仅供我自己使用，我改天尝试解决这个小问题。

# c - 检查一个数是否包含一对都是素数的组合

> ID：10558759
> 
> 赞同：1
> 
> 时间：2012-05-11T21:16:39.460
> 
> 标签：c, recursion, primes

我正在尝试创建一个布尔递归函数，它只接受 1 个参数并且不充当另一个函数的包装器，它检查一个数字是否包含一对都是素数的组合。

例如，8379 的可能组合是：

```
8 379  
83 79  
837 9 
```

我已经设法使用包装器函数创建了该函数，但如果没有包装器，我似乎无法做到这一点。

我目前拥有的是：

```
func(num):  
num is prime -> return true
else -> call func(num / 10, num % 10).

fun(num1, num2):  
num1 and num2 are primes -> return true  
num1 < 10 -> return false  
return func(num1 / 10, concat(num1 % 10, num2)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:33:50.120

假设您`isPrime`定义了一个函数，那么您可以定义您的函数，例如：

```
bool f(int x) {
    int right = x % 10, left = x / 10, iter = 1;

    while (left) {
        if (isPrime(left) && isPrime(right)) return true;

        right = (pow(10, iter++) * (left % 10)) + right;
        left = left / 10;
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T06:09:37.487

用Java编写。

我不太确定您是要检查数字的“多个”组合还是一个。

这是我的递归函数，用于检查一个组合的存在。如果我错误地解决了您的要求，请发表评论。

```
public static boolean splitPrime(int n, int pow10) {
        return (isPrime(n / pow10) && isPrime(n % pow10))
                || (pow10  < n/10 && splitPrime(n, pow10 * 10));
    } 
```

调用它使用`splitPrime(n,10)`

# php - 检查字符串以查看文件是否在本地存在

> ID：10558766
> 
> 赞同：5
> 
> 时间：2012-05-11T21:17:19.410
> 
> 标签：php

如果可以，我有一个问题。我有一个名为的变量`$source`，它*应该*包含文件的相对路径，例如`./uploads/2012/some-document.pdf`

现在，这个`$source`变量将包含用户输入，通过 $_GET 和 $_POST。我不希望人们输入 URL，我只想在文件仅存在于本地服务器上时做一些**事情**。

我的问题是检查文件是否仅存在于本地服务器上的最佳方法是什么？

* * *

这是我到目前为止所得到的：

1)`file_exists`可能会根据服务器配置返回 true，因此我可以将它与 stripos 一起使用来检查字符串的前几个字符是否为 http:// ，如下所示：

```
if( file_exists($source) && stripos($source,'http://')!==0 ) {
    echo 'File exists on local';
} 
```

但是，缺点是我必须指定所有不同的 URL 类型，例如 https://、http:// 和 ftp://，以确保安全。

2）我`realpath`用来获取文件的绝对路径，如果找不到则返回false。这似乎很可靠，但不是 100% 这是最好的应用程序

3) 用于`preg_replace`首先删除字符串中的所有 URL 提及，然后简单地使用`file_exists`. 虽然这可能是最安全的，但它很可能是最密集的，我不想使用这种方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:28:17.143

除了其他答案之外，您还可以简单地拒绝使用方案的路径：

```
if (parse_url($path, PHP_URL_SCHEME)) {
    // has something:// so ignore
} 
```

这也适用于特殊包装器，例如`php://`,`zlib://`等...

您还可以通过添加前缀来强制对输入变量进行本地检查`file://`：

```
file_exists('file://' . $path); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:20:51.520

与`realpath()`（与`file_exists`）一起去。它将为您过滤掉 URL，并且您应该得到关于文件是否存在的可靠结果。

# python - Google API 访问授权 - 需要指导

> ID：10558770
> 
> 赞同：1
> 
> 时间：2012-05-11T21:17:55.687
> 
> 标签：python, django, google-app-engine, oauth

我对 Google API 授权和需要什么类型感到困惑。

我正在尝试构建一个可以将事件放在我的谷歌日历上的 python 应用程序。请注意，我想要我的日历上的事件，并且只有我的日历。这将作为 django 应用程序的后端在服务器上运行。我根本不想访问任何其他用户的数据或日历。

**示例**：用户提出服务请求。我告诉用户感谢这个请求，然后我在我的日历上放了一个日历事件。

我尝试了 Web 应用程序的日历 API OAuth 模型客户端 ID，它似乎在请求访问请求用户数据的权限。正确的？

由于我使用用户名和密码登录我的 google 帐户并且我可以访问我的个人资料和日历，我的应用程序可以在我的帐户上执行相同的操作吗？

如何做到这一点？我需要什么 Google API 授权？有什么简单的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:57:41.550

推荐的对 Google API 进行授权的方法是使用 OAuth 2。Google 为 OAuth 2 提供了多种语言（例如 Python）的独立库，以及更全面的客户端库（请参阅[Python 库](http://code.google.com/p/google-api-python-client/)）以帮助使用 OAuth 2 使用 Google API，例如 Calendar API。

在 Google API 的上下文中，使用用户名和密码对通常称为 ClientLogin。这种做法已被弃用并且*强烈反对*。

除此之外，在 Google Developers 网站上有[简单的说明](https://developers.google.com/google-apps/calendar/firstapp)将 Calendar API v3 与 Python 客户端库一起使用。但是，这些说明是针对在命令行上运行的应用程序而不是在 Web 服务器上运行的应用程序量身定制的，因为从概念上和编程上讲，这更容易掌握。我建议先尝试这个示例，即使它不完全符合您的要求。

我知道 App Engine 示例上没有 OAuth 2，但有一个使用客户端库示例中包含[的 Google+ API的示例。](http://code.google.com/p/google-api-python-client/source/browse/#hg%2Fsamples%2Fappengine)

此示例的关键部分，即授权用户，在使用 Google+ API 的应用程序与使用日历 API 的应用程序之间几乎相同。最大的区别在于您的应用程序代表用户（范围）请求的访问权限，类似于：

```
https://www.googleapis.com/auth/calendar 
```

代替：

```
https://www.googleapis.com/auth/plus.me 
```

当然还有对 API 的实际调用，在[Calendar API 文档参考](https://developers.google.com/google-apps/calendar/v3/reference/)中有详细描述。如果您尝试了我上面链接的简单日历 API 示例，您应该能够应用您在那里学到的知识，以及来自 Google+ 示例的 OAuth 2 设置说明，来做您想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:21:21.663

去年我用示例 Python/Django 代码写了一篇关于这个的博客文章：

[http://www.dannyroa.com/2011/09/26/sign-in-with-google-get-user-info-from-google-profile/](http://www.dannyroa.com/2011/09/26/sign-in-with-google-get-user-info-from-google-profile/)

您需要更改范围以使用日历 API。

您可以在[https://code.google.com/apis/explorer/#_s=calendar&_v=v3](https://code.google.com/apis/explorer/#_s=calendar&_v=v3)使用日历 API 。

# jquery - 动态选择菜单不适用于添加的字段

> ID：10558771
> 
> 赞同：0
> 
> 时间：2012-05-11T21:17:59.507
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

我有一个包含动态选择菜单的子字段的 Rails 嵌套表单：--category (filter menu) --products

我可以让单个字段集工作，但我已经破解了产品菜单（通过在主表单中使用 DOM 就绪的“备份”collection_select），因为我无法让 .html() 加载选择数据动态场。我使用修改后的 Railscast #88 作为模板代码。

真正的问题是只有第一个选择菜单组合起作用——当我在其他字段集中选择类别菜单时，所有菜单都会失败。我尝试添加一个（this）方法，但可以让它工作。

任何见解都非常感谢！

相关js.coffee：

```
products = $('.products-backup').html()
$('form').on 'change', '.category', (event) ->
category = $('.category :selected').text()
escaped_category = category.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, '\\$1')
options = $(products).filter("optgroup[label='#{escaped_category}']").html()
if options
    $('.products').html(options)
else
    $('.products').empty() 
```

相关 rails html.erb 部分 - 注意，我为每个选择菜单分配了 :class 名称：

```
<fieldset>
<div class="field">
<%= f.collection_select :category_id, Category.all, :id, :name, { prompt: 'Select' }, 
{ :class => "category" } %> 
</div>
<div class="field">
<%= f.grouped_collection_select :product_id, Category.order(:name), :products, 
:name, :id, :name, { prompt: 'Select' }, { :class => "products" } %>
</div>
#...more fields
</fieldset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T17:06:55.743

@Jeff，你我想要这样的东西：

```
var $products_backup = $('#products_backup');
$('form').on('click', '.category', function() {
    var $category = $(this);
    if (!$category.is(":checked")) {
        return;
    }
    var escaped_category = $category.val().replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, '\\$1');
    var $options = $products_backup.find("optgroup[label='" + escaped_category + "']").find("option");
    //$('#products').empty().append('<option value="">Select an item</option>').append($options.clone()).val("");
    $category.closest('fieldset').find('.products').empty().append('<option value="">Select an item</option>').append($options.clone()).val("");
}); 
```

看 ：

*   [演示](http://jsfiddle.net/zvNQf/)（原创）
*   [演示](http://jsfiddle.net/zvNQf/2/)（更新）

如您所见，我猜这些`.category`元素可能是单选按钮。如果不是，那么代码将需要或多或少地进行调整。

# asp.net - 一个按钮重定向到另一个页面而不是调用回调函数

> ID：10558775
> 
> 赞同：0
> 
> 时间：2012-05-11T21:18:24.707
> 
> 标签：asp.net, ajaxcontroltoolkit

我有最奇怪的行为。我正在使用 ajaxcontrol 工具包来显示模态弹出窗口，它上面有一个表单。这个弹出窗口是从包含`asp:linkbutton`它的网页激活的（`OnClientClick="aspnetForm.target ='_blank';"`在它上面，我不这么认为，但也许这是相关的）。现在，如果我单击链接，则会打开另一个选项卡，其中包含新页面。当我回到原始选项卡并激活此模式弹出窗口时，如果我单击取消按钮（我在那里），则甚至不会调用回调函数（此回调只是假设隐藏弹出窗口）和我当前的选项卡被重定向到 asp:linkbutton 所指的同一页面。

一些代码：

我有一个包含以下 asp:linkbutton 的页面：

```
<asp:LinkButton ID="lbToBuy" runat="server" CssClass="ItemURLStyle" CausesValidation="false"
OnClientClick="aspnetForm.target ='_blank';">buy it>></asp:LinkButton> 
```

这是来自用户控件的一行，我将其动态添加到某些搜索结果页面。后面的代码是：

```
lbToBuy.PostBackUrl = "~/pages/PassagePage.aspx?i=" + itemInfo.ItemID.ToString(); 
```

现在，我在原始页面中添加了另一个用户控件，它是我网站中项目的搜索栏：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
            <ContentTemplate>
                <asp:LinkButton ID="lbAdvancedSearch" runat="server" Style="color: #f6f7ff; font-family: Arial;
                    font-size: 12px; text-decoration: underline;">Search options</asp:LinkButton>
                <asp:ModalPopupExtender runat="server" ID="AdvSearchPopupModal" TargetControlID="lbAdvancedSearch"
                    PopupControlID="pnlAdvSearch" BackgroundCssClass="modalBackground" DropShadow="false"
                    RepositionMode="RepositionOnWindowScroll">
                </asp:ModalPopupExtender>
                <asp:Panel ID="pnlAdvSearch" runat="server" CssClass="modalPopup" Style="display: none;">
                    <asp:Panel runat="server" ID="Panel3" CssClass="modalHeader">
                        Advanced search
                    </asp:Panel>
                    <div id="SearchFormWrap">
                        <div id="SearchFormBox">
                            <br />
                            <table cellspacing="5">
                                <colgroup>
                                    <col width="100px;" align="left" />
                                    <col width="300px;" />
                                </colgroup>
                                <tbody>
SOME UNIMPORTANT SEARCH CRITERION HERE
                                </tbody>
                            </table>
                            <div style="width: 280px; margin: auto; padding-bottom: 15px;">
                                <br />
                                <div style="width: 210px; height: 30px; margin: auto;">
                                    <asp:Button ID="btnQuitAdvSearch" runat="server" CssClass="myButtonShape" Style="font-size: 14px;
                                        float: left; height: 25px; width: 100px;" OnClick="btnQuitAdvSearch_Click" CausesValidation="false"
                                        Text="Cancel" />
                                    <div style="width: 3px; height: 25px; float: left;">
                                    </div>
                                    <asp:Button ID="btnAdvSearch" runat="server" class="myButtonShape" Style="font-size: 14px;
                                        float: left; height: 25px; width: 100px;" OnClick="btnAdvSearch_Click" OnClientClick="return btnSearch_OnClientClick();"
                                        CausesValidation="true" Text="Search" />
                                </div>
                            </div>
                        </div>
                    </div>
                </asp:Panel>
            </ContentTemplate>
        </asp:UpdatePanel> 
```

代码隐藏：

```
protected void btnQuitAdvSearch_Click(object sender, EventArgs e)
{
    this.AdvSearchPopupModal.Hide();
} 
```

现在，当我按下页面中的链接时，会按预期打开另一个带有定向链接的选项卡。当我回到原始页面并按下高级搜索按钮时，我会看到这个显示搜索条件的模式弹出窗口。如果我按下“搜索”按钮，一切都会按预期进行并形成新的搜索，但如果我按下“取消”按钮，页面将重定向到我单击的最后一个链接（在当前选项卡中，即替换原始页）。我在 btnQuitAdvSearch_Click 函数处设置了一个断点，但它从未被调用过。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T11:49:11.193

好的。现在我想通了。我很马虎。尽管 Drew 为我提供了一个案例的解决方案，但这仍然没有解释问题。整个解决方案是不同的。问题是我使用了这个人[在此处](https://stackoverflow.com/questions/104601/asp-net-response-redirect-to-new-window)提供并使用的建议，`OnClientClick="aspnetForm.target ='_blank';"`但我没有实施他建议添加到正文 onload（那里）的修复。现在一切正常。

非常感谢德鲁。

# asp.net-mvc - PartialView 在 jquery 对话框中持续一秒钟

> ID：10558776
> 
> 赞同：0
> 
> 时间：2012-05-11T21:18:25.923
> 
> 标签：asp.net-mvc, jquery-dialog, asp.net-mvc-partialview

该视图在对话框中快速可见一秒钟，然后对话框消失了，并且该视图在主站点中再次可见，就好像禁用了 javascript 一样。

我错了什么？我只想在调用控制器中的创建操作的对话框中显示创建视图。

索引视图：

```
@{
    Layout = null;   
 }

 <script type="text/javascript">

    $(function () {
        $('#dialog').dialog({
            autoOpen: false,
            width: 300,
            resizable: false,
            title: 'Create Template',
            modal: true,
            open: function(event, ui) {               
                $(this).load("@Url.Action("Create")");
            },
            buttons: {
                "Close": function () {
                    $(this).dialog("close");
                }
            }
        });

        $('#CreateTemplate').click(function ()
        {
            $('#dialog').dialog('open');
        });
    });

<div id="dialog" title="Create Template" style="overflow: hidden;"></div>
<div id="MenuBarDiv">   
    <a id="CreateTemplate" href="..\Template\Create">Create Template</a>
</div>
<div id="LeftDiv">
    Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod
    teimata sanctus est Lorem
    ipsum dolor sit amet.
</div>
<div id="RightDiv">
    Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod
    tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero
    eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea

</div>
<div class="clear">
</div> 
```

控制器：

```
 [HttpGet]
    public ActionResult Create()
    {
      return View("Create");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T09:39:18.517

在锚点的单击处理程序中，您不会取消默认操作，因此浏览器只会重定向到锚点的 href，而不会留下任何时间来显示对话框。如果您想留在同一页面上，您需要通过返回 false 来取消此默认操作：

```
$('#CreateTemplate').click(function () {
    $('#dialog').dialog('open');
    return false;
}); 
```

还要确保在您的`Create.cshtml`部分中您已取消布局 ( `Layout = null`) 或让您的 Create 操作返回 a`PartialView`而不是`View`避免在对话框中获取完整布局。

您的代码的另一项改进是替换以下硬编码锚：

```
<a id="CreateTemplate" href="..\Template\Create">Create Template</a> 
```

使用 html 帮助程序来确保它生成符合您的路由配置的正确 url：

```
@Html.ActionLink(
    "Create Template",             // linkText
    "Create",                      // actionName
    "Template",                    // controllerName
    null,                          // routeValues
    new { id = "CreateTemplate" }  // htmlAttributes
) 
```

# powershell - Windows - 使用 WMI 或 powershell 远程运行可执行文件或 cmd，并记录输出

> ID：10558777
> 
> 赞同：1
> 
> 时间：2012-05-11T21:18:28.217
> 
> 标签：powershell, scripting, wmi

这很难做到。我不敢相信。这应该很容易。

无论如何，使用 WMI（同时使用 vbscript 和 perl）我可以在运行 .exe 的远程计算机上启动一个进程，但我无法将输出写入日志。这让我发疯了。我必须使用 WMI 或 powershell，因为我无法在远程机器上安装任何额外的东西，这些机器都是 Windows 2003 或更高版本。我也不能假设所有目标机器上都启用了 powershell 远程处理，所以我什至可能无法使用 powershell。这可能会导致 powershell 出现问题。

这是我在伪代码中尝试做的事情：

服务器 = 服务器 1、服务器 2、服务器 3

对于服务器中的每个服务器

在远程服务器上运行命令 >> log.txt

下一个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:40:19.263

我假设您在所有服务器上都启用了 powershell 远程处理，并且您希望将结果保存在本地日志文件中（即不在每台服务器上）...

```
$Servers = "server1", "server2","server3"

Invoke-Command -ComputerName $Servers -ScriptBlock { ping.exe www.stackoverflow.com } >> c:\localfile.txt 
```

这也假设您的 exe 输出到标准输出，我认为捕获其他流会有问题。

# android - eclipse文件资源管理器拉文件，无法在Windows“文件正在使用”中打开文件

> ID：10558782
> 
> 赞同：2
> 
> 时间：2012-05-11T21:19:08.200
> 
> 标签：android, windows, eclipse

我正在使用 eclipse 在 java 中编写 android 应用程序。我使用 Eclipse 文件资源管理器“从设备中提取文件”到我的桌面。（所有这些都在 Windows 7 Enterprise 笔记本电脑上）。

当我在 Windows 桌面上打开文件时，通常但并非总是如此，它说我无法打开该文件，因为该文件“正在被另一个应用程序使用并且无法访问”。

有人知道我如何解决这个问题吗？我如何始终如一地访问我使用 eclipse 文件资源管理器 > 提取文件提取的文件，而无需退出并重新启动 eclipse 常量？（退出 Eclipse 确实有效。）

# html - 带有表单数据的 IE 的 Dojo 1.6 多文件 Flash 上传器？

> ID：10558784
> 
> 赞同：1
> 
> 时间：2012-05-11T21:19:14.610
> 
> 标签：html, flash, internet-explorer, upload, dojo

我在 IE 中使用 Dojo 1.6 dojox.form.Uploader。这使用 dojox.form.uploader.plugins.Flash 插件进行上传。在 Firefox 中，使用 HTML5，我可以通过调用以下方式提交其他表单数据以及上传：

```
uploaderDijit.upload({paramName:"paramValue"}); 
```

但是在 IE 中，Flash 版本的上传函数不带 formData 参数。有什么方法可以使用 Flash 插件提交其他数据以及文件上传？

这是我的示例代码：

```
dojo.require("dojox.form.Uploader");
dojo.require("dojox.form.uploader.FileList");
dojo.require("dojox.form.uploader.plugins.Flash");

function doUpload(){
     dijit.byId("uploader").upload({param: "paramValue"});
}

function onload(){
     // create uploader & file list dijits
     var uploaderDijit = new dojox.form.Uploader({
          id: "uploader",
          url: "MyApp/MyServlet",
          multiple: true
     });
     var fileListDijit = new dojox.form.uploader.FileList({uploader:uploaderDijit});

     // insert dijits into html
     var formNode = dojo.byId("multiUploadForm");
     var uploaderDiv = document.createElement("div");
     formNode.appendChild(uploaderDiv);
     uploaderDiv.appendChild(uploaderDijit.domNode);
     uploaderDiv.appendChild(fileListDijit.domNode);
}

dojo.addOnLoad(onload); 
```

和：

```
<form id="multiUploadForm" method="post" enctype="multipart/form-data" encoding="multipart/form-data"></form>
<button onclick="javascript:doUpload();">Upload</button> 
```

我尝试在表单中添加一个输入节点：

```
<form id="multiUploadForm" method="post" enctype="multipart/form-data" encoding="multipart/form-data">
     <input type="hidden" name="param" value="paramValue"/>
</form> 
```

而且我还尝试将参数附加到 url，但没有骰子：

```
var uploaderDijit = new dojox.form.Uploader({
     id: "uploader",
     url: "MyApp/MyServlet?param=paramValue",
     multiple: true
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T11:14:43.470

我相信还有其他问题。以下是（尽管来自 1.7.2 src）您所调用的函数是您在第一个代码块中的入口点。100% 确定，如果您使用`url: "MyApp/MyServlet?param=paramValue"` .

```
uploadFlash: function(/*Object ? */formData){
        // summary:
        //              Uploads selected files. Alias "upload()" should be used instead.
        // tags:
        //              private
        this.onBegin(this.getFileList());
        formData.returnType = "F";
        this.flashMovie.doUpload(formData);
}, 
```

# javascript - 如何从网页大小控制网页元素大小

> ID：10558785
> 
> 赞同：0
> 
> 时间：2012-05-11T21:19:18.370
> 
> 标签：javascript, jquery, css

**大家好**，

实际上，我的网页中有一张大桌子，当我减小网页大小时，我想减小它的大小。现在宽度和高度是自动的，当我减小页面时，一部分我的桌子是隐藏的。我知道，这是一个基本案例..但我对 css 很陌生。任何人都可以帮助我吗？谢谢

```
ClassDisplay.prototype.displayList = function(list,h)
    {
    //var font = {'font-family':'monospace', 'font-weight':'plain', 'font-size': 15 };
        h = '<div id="plot">';
        h += '<button id="plotshow" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" style="margin-top: 2.3%;">Plot Visualisation</button>';
        h += '</div>';
        h +="<table id=tablesorterr border='1'>";

    var List=list;
    //var header = list[0];
    //var data=list.splice(3);
    //var w = colWidths(header, data, font);

        for(var i=0;i<List.length;i++)
        {
            if(i==0)
            {
                h+="<thead>";
                h+="<tr>";
                for(var j=0;j<List[i].length;j++)
                {
                    h+="<th id='tabSSHeader_"+List[i][j]+"'><span>"+List[i][j]+"</span></th>";
                }
                h+="</tr>";
            }
            h+="</thead>";

            h+="<tbody>";
            if(i>=3)
            {
                h+="<tr>";
                for(var j=0;j<List[i].length;j++)
                {
                    objetSite.CURTAB = List[i][j];

                    if(j==0)
                    {

                        h+="<td><a href='#' rel='"+objetSite.CURTAB+"' class='clickOnTabLink'>"+objetSite.CURTAB+"</a></td>";
                    }
                    else
                    h+="<td>"+objetSite.CURTAB+"</td>";
                }
                h+="</tr>";
            }
            h+="</tbody>";
        }
        h+="</table>";
        h += '<div id="plot">';
        h += '<button id="plotshow" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">Plot Visualisation</button>';
        h += '</div>';

        $("#my_list").html(h);  

        $("#tablesorterr").tablesorter();

    for(var j=0;j<List[0].length;j++)
        {
        $('#tabSSHeader_'+List[0][j]).tooltip2(List[2][j]);
        }

    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:46:58.270

使用 CSS 来完成这项工作。jQuery 很好，但你不需要它。[在 css http://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)中使用@media 查询

# c# - 多张表中的相同型号

> ID：10558786
> 
> 赞同：2
> 
> 时间：2012-05-11T21:19:21.197
> 
> 标签：c#, entity-framework

我有一个类，假设它被称为`EntityModel`，并且我想创建三个具有相同列的不同表，如`EntityModel`. 让我们称表`tbPast`和。我还想在 Entity 中单独访问它们：`tbPresent``tbFuture``DbContext`

```
using (var db = new MyContext())
{
    var element = db.Past.Find(id);
    db.Past.Remove(element);
    db.Present.Add(element);
    db.SaveChanges();
} 
```

三张表的主要目的是性能：表会有几百万行，最重要的是`Present`，有几十行。大多数查询将在`Present`表中进行。

做这个的最好方式是什么？实现三个具有相同属性的模型似乎不适合我。

我正在使用实体框架、代码优先方法以及 ASP.NET MVC 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:27:27.147

您不能使用相同的模型来生成带有 EF 代码优先的单独表。如果您需要进行某种分组，请使用一个`Discriminator`字段并为其分配任何值：`Past` `Present` `Future`.

**编辑：**

类似的效果可以通过[table-per-concrete 类型](http://weblogs.asp.net/manavi/archive/2011/01/03/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-3-table-per-concrete-type-tpc-and-choosing-strategy-guidelines.aspx)继承来实现。因此，每种类型都有自己的表，并且可以共享大部分（如果不是全部）字段。

# ruby-on-rails-3 - 设计和 OmniAuth-Identity

> ID：10558787
> 
> 赞同：3
> 
> 时间：2012-05-11T21:19:27.883
> 
> 标签：ruby-on-rails-3, devise, omniauth

有没有人有使用 OmniAuth-Identity 支持设计的经验？我找不到任何例子，我不确定我需要在哪里设置什么参数才能让它开心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:23:05.373

我了解 OmniAuth-Identity 是一种完全不同的电子邮件密码身份验证方式，因此您无需使用设计。这个 railcast 剧集展示了如何配置 OmniAuth-Identity [http://railscasts.com/episodes/304-omniauth-identity](http://railscasts.com/episodes/304-omniauth-identity)

# zend-framework - 如何在windows7永恒的Xampp 1.7.1版上安装zend框架

> ID：10558788
> 
> 赞同：0
> 
> 时间：2012-05-11T21:19:27.603
> 
> 标签：zend-framework

我已经下载了 ZendFramework-1.11.11 并且它已经被解压了，然后 ZendFramework-1.11.11 的库文件夹里面有 zend 文件夹。然后它被复制并粘贴到 xampp 的 htdocs 中。我的 Xampp 版本 Xampp win32 1.7.1 或 Xampp win32 1.7.7 然后怎么做编写用于检查和在浏览器中的 URL 是什么。我需要你的手。请逐步指导我谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:55:46.920

[Zend Framework 快速入门](http://framework.zend.com/manual/en/learning.quickstart.intro.html)将引导您下载 Zend Framework，在 PHP 中设置 include_path，创建 ZF 项目，以及在 Apache 中创建虚拟主机以映射到新创建的 Zend Framework 项目。

我会从那里开始，如果您卡在某个特定位置，我们很乐意提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:03:54.720

安装 Zend 框架不依赖于它将运行的系统。请按照以下文章进行正确的演练。它表示开始所需的每一个动作。

[在 Windows 上安装 Zend Framework](http://framework.zend.com/wiki/display/ZFDEV/Installing+Zend+Framework+on+Windows)

# java - Apache HttpClient 临时错误：NoHttpResponseException

> ID：10558791
> 
> 赞同：91
> 
> 时间：2012-05-11T21:19:37.777
> 
> 标签：java, httpclient

我有一个接受 XML POST 方法的网络服务。它工作正常，然后在某个随机场合，它无法与服务器通信，并使用 message 抛出 IOException `The target server failed to respond`。随后的调用工作正常。

它主要发生在我拨打一些电话然后让我的应用程序空闲 10-15 分钟时。之后我进行的第一次调用会返回此错误。

我尝试了几件事......

我设置了重试处理程序，如

```
HttpRequestRetryHandler retryHandler = new HttpRequestRetryHandler() {

            public boolean retryRequest(IOException e, int retryCount, HttpContext httpCtx) {
                if (retryCount >= 3){
                    Logger.warn(CALLER, "Maximum tries reached, exception would be thrown to outer block");
                    return false;
                }
                if (e instanceof org.apache.http.NoHttpResponseException){
                    Logger.warn(CALLER, "No response from server on "+retryCount+" call");
                    return true;
                }
                return false;
            }
        };

        httpPost.getParams().setParameter(HttpMethodParams.RETRY_HANDLER, retryHandler); 
```

但是这个重试从来没有被调用过。（是的，我正在使用正确的 instanceof 子句）。在调试此类时永远不会被调用。

我什至尝试设置`HttpProtocolParams.setUseExpectContinue(httpClient.getParams(), false);`但没有用。有人可以建议我现在能做什么吗？

**重要** 除了弄清楚为什么会出现异常之外，我最关心的一个重要问题是为什么重试处理程序不在这里工作？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2012-05-15T12:34:35.973

连接管理器保持活动的最有可能的持久连接变得陈旧。也就是说，目标服务器在连接处于空闲状态时，在其端关闭连接而 HttpClient 无法对该事件做出反应，从而使连接处于半关闭状态或“陈旧”状态。通常这不是问题。HttpClient 使用多种技术在从池中租用时验证连接的有效性。即使禁用过时连接检查并且使用过时连接来传输请求消息，请求执行通常在写入操作中失败并出现 SocketException 并自动重试。然而，在某些情况下，写操作可以毫无例外地终止，随后的读操作返回 -1（流结束）。

补救这种情况的最简单方法是在一段时间不活动后从池中逐出过期连接和空闲时间超过 1 分钟的连接。有关详细信息，请参阅[HttpClient 教程的这一部分](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d5e659)。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-06-07T12:55:30.587

接受的答案是正确的，但缺乏解决方案。为避免此错误，您可以在[此答案](https://stackoverflow.com/a/10680629/1727132)中为您的 HTTP 客户端添加 setHttpRequestRetryHandler（或 apache 组件 4.4 的 setRetryHandler） 。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-12-12T09:48:17.977

HttpClient 4.4 在这个领域遇到了一个错误，该错误与在返回请求者之前验证可能陈旧的连接有关。它*没有*验证连接是否过时，然后立即生成`NoHttpResponseException`.

此问题已在 HttpClient 4.4.1 中解决。请参阅[此 JIRA](https://issues.apache.org/jira/browse/HTTPCLIENT-1609)和[发行说明](https://archive.apache.org/dist/httpcomponents/httpclient/RELEASE_NOTES-4.5.x.txt)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-06-03T10:05:04.643

虽然接受的答案是正确的，但恕我直言只是一种解决方法。

需要明确的是：持久连接可能会变得陈旧，这是一种完全正常的情况。但不幸的是，当 HTTP 客户端库无法正确处理它时，它是非常糟糕的。

由于 Apache HttpClient 中的这种错误行为多年未得到修复，我肯定更愿意切换到可以轻松从陈旧连接问题中恢复的库，例如 OkHttp。

为什么？

1.  OkHttp 默认池化 http 连接。
2.  当 http 连接过时并且由于不是幂等（例如 POST）而无法重试请求时，它可以优雅地恢复。我不能说 Apache HttpClient（提到`NoHttpResponseException`）。
3.  支持早期草稿和 beta 版本的 HTTP/2.0。

当我切换到 OkHttp 时，我的问题`NoHttpResponseException`永远消失了。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-11-07T09:11:55.287

**解决方案**：将 ReuseStrategy 更改为 never

由于这个问题非常复杂，并且有很多不同的因素可能会失败，我很高兴在另一篇文章中找到了这个解决方案：[如何解决 org.apache.http.NoHttpResponseException](https://stackoverflow.com/questions/29006222/how-to-solve-org-apache-http-nohttpresponseexception#)

永远不要重用连接：在 org.apache.http.impl.client.AbstractHttpClient 中配置：

```
httpClient.setReuseStrategy(new NoConnectionReuseStrategy()); 
```

可以在 org.apache.http.impl.client.HttpClientBuilder 构建器上配置相同的内容：

```
builder.setConnectionReuseStrategy(new NoConnectionReuseStrategy()); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-12-16T16:48:43.263

如今，除非另有声明，否则大多数 HTTP 连接都被[认为是持久](https://en.wikipedia.org/wiki/HTTP_persistent_connection)的。但是，为了节省服务器资源，连接很少会永远保持打开状态，许多服务器的默认连接超时相当短，例如 Apache httpd 2.2 及更高版本为 5 秒。

该`org.apache.http.NoHttpResponseException`错误很可能来自服务器关闭的一个持久连接。

可以设置在 Apache Http 客户端池中保持未使用连接打开的最长时间，以毫秒为单位。

使用 Spring Boot，实现此目的的一种方法：

```
public class RestTemplateCustomizers {
    static public class MaxConnectionTimeCustomizer implements RestTemplateCustomizer {

        @Override
        public void customize(RestTemplate restTemplate) {
            HttpClient httpClient = HttpClientBuilder
                .create()
                .setConnectionTimeToLive(1000, TimeUnit.MILLISECONDS)
                .build();

            restTemplate.setRequestFactory(
                new HttpComponentsClientHttpRequestFactory(httpClient));
        }
    }
}

// In your service that uses a RestTemplate
public MyRestService(RestTemplateBuilder builder ) {
    restTemplate = builder
         .customizers(new RestTemplateCustomizers.MaxConnectionTimeCustomizer())
         .build();
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-04-12T19:24:09.550

如果`disableContentCompression()`在分配给您的 HttpClient 的池管理器上设置，并且目标服务器正在尝试使用 gzip 压缩，则可能会发生这种情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-04-13T16:07:37.213

在 apache http 客户端 4.5.5 上添加默认标头对我来说同样的问题

连接：关闭

解决问题

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-16T08:48:10.217

使用`PoolingHttpClientConnectionManager`代替`BasicHttpClientConnectionManager`

`BasicHttpClientConnectionManager`将努力为具有相同路由的后续请求重用连接。但是，它将关闭现有连接并为给定路由重新打开它。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-10-01T10:33:54.030

我遇到了同样的问题，我通过添加“连接：关闭”作为扩展来解决，

步骤 1：创建一个新类**ConnectionCloseExtension**

```
import com.github.tomakehurst.wiremock.common.FileSource;
import com.github.tomakehurst.wiremock.extension.Parameters;
import com.github.tomakehurst.wiremock.extension.ResponseTransformer;
import com.github.tomakehurst.wiremock.http.HttpHeader;
import com.github.tomakehurst.wiremock.http.HttpHeaders;
import com.github.tomakehurst.wiremock.http.Request;
import com.github.tomakehurst.wiremock.http.Response;

public class ConnectionCloseExtension extends ResponseTransformer {
  @Override
  public Response transform(Request request, Response response, FileSource files, Parameters parameters) {
    return Response.Builder
        .like(response)
        .headers(HttpHeaders.copyOf(response.getHeaders())
            .plus(new HttpHeader("Connection", "Close")))
        .build();
  }

  @Override
  public String getName() {
    return "ConnectionCloseExtension";
  }
} 
```

第2步：在wireMockServer中设置扩展类，如下所示，

```
final WireMockServer wireMockServer = new WireMockServer(options()
                .extensions(ConnectionCloseExtension.class)
                .port(httpPort)); 
```

# xcode - 将对象添加到 NSArray

> ID：10558792
> 
> 赞同：2
> 
> 时间：2012-05-11T21:19:40.823
> 
> 标签：xcode

我是一个新手，整天都在工作，准备/观看/寻找解决方案。以下代码有效，但现在如何将整数添加到数组中？

```
 //this works

    NSArray *array = [NSArray arrayWithObjects:[NSNumber numberWithInt:10],
        [NSNumber numberWithFloat:25.96], @"Hello World", nil]; 

   for (id obj in array)
    NSLog(@"%@", obj); 
```

以下返回错误：使用未声明的标识符“obj”

```
 NSArray *array = [NSArray arrayWithObjects:[NSNumber numberWithInt:10],
       [NSNumber numberWithFloat:25.96], @"Hello World", nil]; 

    for (id obj in array) 
        [array addObject:7];
        NSLog(@"%@", obj); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:32:44.997

您必须使用 NSMutabbleArray 而不是 NSArray 来动态添加对象，并且不要忘记 [] 并且 arrayWithObjects 仅适用于 nsarray。尝试这个：

```
NSMutableArray *array = [[NSMutableArray alloc] init];
[array addObject:[NSNumber numberWithInt:10]];
[array addObject:[NSNumber numberWithFloat:25.96]];
[array addObject:@"Hello World"];
[array addObject:[NSNumber numberWithInt:7]];

for (id obj in array) {
    NSLog(@"%@", obj); 
} 
```

只需复制粘贴此代码，它将使用您想要的对象启动数组，然后显示它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:28:44.343

这里有几个问题：

1.  您正在尝试改变（更改）不可变数组。你需要一个`NSMutableArray`而不是`NSArray`做你想做的事。（顺便说一句，您的实际`NSArray`创建代码很好。）
2.  您的`for()`循环正在爆炸，主要是因为您没有大括号来分隔代码。如果没有大括号，编译器将*只*使用紧随其后的第一行`for`作为循环内容。因此，您`NSLog()`在循环之外，并且`obj`超出了范围。
3.  ~~我不知道为什么你的`addObject:`行周围没有括号，如`[array addObject:...]`. 那甚至编译了吗？那是复制和粘贴错误吗？~~
4.  最后，您不能将裸整数添加到 Cocoa 集合中，例如`NSArray`. 您需要遵循您之前在代码中正确执行的操作：`[array addObject:[NSNumber numberWithInt:7]]`.

鉴于您使用缩进作为语法，我猜您可能有更多的 Python（或类似）背景？如果是这样，您将不得不快速调整您的一些思维模式，以便在 C 或 Objective-C 中有效地编程。我*强烈建议*你买一本关于 Cocoa 编程的初学者书籍并从头开始，否则你很快就会感到非常沮丧。

编辑：我注意到在我发布后你添加了括号，所以我点击了上面的#3。这导致了另一个重要的注意事项：确保如果您提出问题，您复制并粘贴了失败的**确切**代码。永远不要重新输入！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:23:08.007

这是因为您在 for 循环中使用缩进只考虑以下行。试试这个

```
 for (id obj in array) {
         [array addObject:[NSNumber numberWithInt:7]];
         NSLog(@"%@", obj); 
     } 
```

**笔记**

我认为如果要在初始化后添加对象，则需要使用 NSMutableArray。此外，修改循环遍历的集合也不是一个好主意（在这种情况下，循环永远不会结束，因为您不断将对象添加到循环遍历的数组中）。您可以使用此行创建数组的可变版本。

```
NSMutableArray * mutArray = [NSMutableArray arrayWithArray:array]; 
```

# clojure - 在 Leiningen/Clojure 中使用 lwjgl

> ID：10558795
> 
> 赞同：9
> 
> 时间：2012-05-11T21:19:54.503
> 
> 标签：clojure

## 解决方案

```
(1) (println (. System getProperty "java.library.path")) 
```

这给了我一个 java 寻找本地扩展的地方的列表。

然后，我采用了 lwjgl 本机扩展，并将它们放在那里。

## 对我不起作用的东西（可能是因为我使用不当）

```
(*) setting :native-path
(*) setting :native-dependencies 
```

## 问题

我的设置：

```
(lein deps; echo "====="; cat project.clj; echo "====="; cat src/main.clj; echo "====="; lein repl) &> log 
```

“日志”的内容

```
 Copying 10 files to /Volumes/ramdisk/fail/lib
=====
(defproject
  mincase "0.0.1"
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [org.lwjgl.lwjgl/lwjgl "2.8.2"] ]
  :repositories {"local" "/Users/x/z/maven_repo"}
  :jvm-opts ["-Xms4g"  "-Xmx4g"]
  :repl-init main
  )

=====
(ns main
 (:import org.lwjgl.opengl.Display)) 
=====
REPL started; server listening on localhost port 31235
UnsatisfiedLinkError no lwjgl in java.library.path  java.lang.ClassLoader.loadLibrary (ClassLoader.java:1860)
clojure.core=> 
```

注意——我已经做了一个“lein deps”，所以 lwjgl 库已经被拉进了 maven。我不明白的是：

```
(*) how do I get access to lwjgl from Clojure?
(*) more importantly, how do I debug which step this whole thing has gone wrong at? 
```

$查找库

```
lib
lib/clojure-1.4.0.jar
lib/jinput-2.0.5.jar
lib/jinput-platform-2.0.5-natives-linux.jar
lib/jinput-platform-2.0.5-natives-osx.jar
lib/jinput-platform-2.0.5-natives-windows.jar
lib/jutils-1.0.0.jar
lib/lwjgl-2.8.2.jar
lib/lwjgl-platform-2.8.2-natives-linux.jar
lib/lwjgl-platform-2.8.2-natives-osx.jar
lib/lwjgl-platform-2.8.2-natives-windows.jar 
```

所以看来lwjgl已经被拉进去了。

我应该尝试哪些步骤来找出我出错的步骤？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T21:05:25.127

由于谷歌为我的类似问题找到了这篇文章，因此在此处删除了此注释。

Leiningen 的人现在已经解决了这个问题： [https ://github.com/technomancy/leiningen/issues/898](https://github.com/technomancy/leiningen/issues/898)

如果您获得版本 2.1.0 或更高版本，则它具有修复程序。有关详细信息，请参阅错误。

**更新：（2013 年 8 月）**

我在 github 上有一个项目，我在这里用 lwjgl 进行实验： [https ://github.com/rogerallen/hello_lwjgl](https://github.com/rogerallen/hello_lwjgl)

我也在我的shadertone项目中使用了LWJGL：[https](https://github.com/overtone/shadertone) ://github.com/overtone/shadertone 因为Shadertone是一个库，我发现我需要自己打包natives才能让它为依赖的项目合理安装着色器。

如果有人对 LWJGL 人员有一些吸引力，那么如果他们只是将本地人放入适当的子目录中，就像 lein 在他们的 clojars 版本中所期望的那样，那肯定会很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T22:22:17.163

看起来你的`LD_LIBRARY_PATH`. 您是否包含正确的文件`.dll`或`.so`文件？

您可能需要在`:native-dependencies [[lwjgl "2.8.2"]]`您的`project.clj`.

或者，您可以尝试从 shell 设置正确的值：

```
export LD_LIBRARY_PATH=/home/username/lwjgl-2.8.2/native/linux/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:15:24.503

`Display`尽管同一个 jar 文件中的其他类正确导入，但为什么拒绝导入有点令人困惑

```
(import '[org.lwjgl.opengl Util WindowsAWTGLCanvasPeerInfo]) 
```

我怀疑这个jar文件坏了，也许你可以试试不同的版本。

我尝试通过运行来调试它

```
cd lib
jar xf lwjgl-2.8.2.jar
cd org/lwjgl/opengl/ 
```

然后尝试加载我在那里看到的各种类。

`lein swank`还可以完成选项卡，这可以帮助探索类，而无需从 shell 中提取它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T11:58:27.930

今天遇到了这个问题，通过将本机目录添加到`:jvm-opts`in来解决它有点不同`project.clj`：

```
(defproject projectname "0.0.1-SNAPSHOT"
  :description "my project"
  :jvm-opts ["-Djava.library.path=native/linux"]
  :dependencies [[org.clojure/clojure "1.4.0"]]) 
```

我将 jar 文件从最新的 lwjgl 版本复制到`lib`并将`native`目录复制到项目根目录中。到目前为止似乎有效：

```
user=> (import org.lwjgl.opengl.Display)
org.lwjgl.opengl.Display 
```

但我才刚刚开始。无论如何，希望这对其他人有帮助:)

# php - PHP socket_write 第一次工作，但是

> ID：10558802
> 
> 赞同：3
> 
> 时间：2012-05-11T21:20:38.323
> 
> 标签：php, sockets

我想通过用 PHP 创建的一个套接字向设备写入几条消息（每条消息都是动态创建的）。第一条消息总是通过；但是，后续消息*不会*通过。为了帮助我调试，如果这个例子有问题，请告诉我：

```
 $socket= socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
        socket_connect($socket, $ip, $port); 
        socket_write($socket, "message 1\r");
        socket_write($socket, "message 2\r"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:26:22.487

您是否尝试在消息末尾添加回车符`socket_write($socket, "message 1\r\n");`？在许多情况下，当使用缓冲区和流时，这似乎可以解决问题。

其他值得一试的东西：

```
//all suggestions rolled into one (including Chris' chr(0) - thanks for that one)
socket_write($socket, 'message 1'."\r\n".chr(0));
usleep(5);
socket_write($socket, 'Foobar'."\r\n".chr(0)); 
```

只给一点额外的时间来清除缓冲区就可以创造奇迹。

**编辑**

刚刚有了另一个脑电波：您是否也尝试过使用可选的长度参数？

```
socket_write($socket, 'message 1'."\r\n".chr(0),strlen('message 1'."\r\n".chr(0))); 
```

# php - PayPal IPN 侦听器响应

> ID：10558810
> 
> 赞同：1
> 
> 时间：2012-05-11T21:21:07.993
> 
> 标签：php, paypal-ipn

在 PayPal 的沙箱中进行了全面测试并让流程完美运行之后。我已经把它活了，它不工作。

我通过 notify_url 从 PayPal 接收 POST 数据。然后我在数据前面使用 cmd=_notify-validate 将其发送回 PayPal。

使用 PayPals 记录的代码，我使用它来将消息发送到 PayPal。

```
$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
$fp = fsockopen ('ssl://www.paypal.com', 443, $errno, $errstr, 30); 
```

（使用此代码获取响应）

```
$res = stream_get_contents($fp, 1024); 
```

我得到的回应是：

```
HTTP/1.1 200 正常
日期：格林威治标准时间 2012 年 5 月 11 日星期五 20:51:28
X 框架选项：SAMEORIGIN
Set-Cookie: cwrClyrK4LoCV1fydGbAxiNL6iG=SdeBuKBN39mjr3w791CHr_MlSkoBdDmbxpQOjT_WOicyD_Sg6BYZm8koiEv2-5XBUkCjpXQwFqIxIQgIyo3e7arO8015CVw96dpne2CNjbgc1CvpDlqXn72IBWq%7cW7uYn6Za7ljG4iLtLVcyFoPk8gZD7sr_S8WjwZrZWD8UXzE7KAH3bll9TVik3wbdCFlrZG%7csxrZZHSH5SWBGfrKsIU6Dz-K43j4h37efIkWFcVJVER0ncRxNJ0wANN1Dp3pZpV2PLxC1m%7c1336769488; 域=.paypal.com；路径=/; 安全的; HttpOnly
设置 Cookie：cookie_check=yes；expires=周一，2022 年 5 月 9 日 20:51:28 GMT；域=.paypal.com；路径=/; 安全的; HttpOnly
设置 Cookie：navcmd=_notify-validate；域=.paypal.com；路径=/; 安全的; HttpOnly
设置 Cookie：navlns=0.0；到期=格林威治标准时间 2032 年 5 月 6 日星期四 20:51:28；域=.paypal.com；路径=/; 安全的; HttpOnly
设置 Cookie：Apache=10.73.8.50.1336769488653443；路径=/; expires=Sun, 04-May-42 20:51:28 GMT
变化：接受编码
严格的传输安全性：max-age=14400
连接：关闭
内容类型：文本/html；字符集=UTF-8
设置 Cookie：TSe9a623=bb3c8ce40a7f3f6d1c018255c9
```

我没有得到的是 INVALID 或 VERIFIED 响应。这是 PayPal 的全部输出。在沙箱中，我在最后一行得到了 VERIFIED，并且没有 Set-Cookie。

我没有收到 INVALID 或 VERIFIED 响应似乎很奇怪。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:26:19.070

您是否使用 fwrite/fputs 将请求写入套接字？此外，从响应的长度来看，您可能需要从流中读取超过 1024 个字节。这已经非常接近了。

您可能希望循环读取响应：

```
$resp = '';
while (!feof($fp)) {
    $resp .= stream_get_contents($fp, 1024);
} 
```

然后，您可以使用以下方法将标题与正文分开：

```
list($headers, $response) = explode("\r\n\r\n", 2); 
```

# java - 在具有数组的组合模型中打印的方法链接

> ID：10558813
> 
> 赞同：0
> 
> 时间：2012-05-11T21:21:36.187
> 
> 标签：java, bluej

我是一名学生，正在从事一个项目，使用数组创建类来模拟组合。我假设到目前为止我一切都正确，但似乎我在驱动程序类中的打印语句有问题。我不确定这是否与我将两者链接在一起的方法有关。任何信息将不胜感激。

```
public class MyWord
{
  private String word;     
  public MyWord(){
    word = "Null"; 
  }
  public MyWord(String s){
    word = s; 
  }
  public String getWord(){
    return word; 
  }
  public void setWord(String w){
    word = w; 
  }
  public void print(){
    System.out.println(word); 
  }
}

public class Page
{
private MyWord[] words = new MyWord[5]; 
private int pageNumber;     
public Page(){
    MyWord words[] = {} ; 
    pageNumber = 0; 
}    
public Page(MyWord[] a, int b){
    words = a; 
    pageNumber = b; 
}    
public MyWord[] getWord(){
    return words;
}   
public int getPageNumber(){
    return pageNumber;
}    
public void setMyWord(MyWord[] a){
    words = a; 
}    
public void setPageNumber(int b){
    pageNumber = b; 
}    
public void print(){
    System.out.print(" Page Number: " + pageNumber + " " + words);
}
}

public class Book
{
private Page[] p = new Page[5]; 
private String title;     
public Book(){
    Page[] p = {}; 
    title = " ";
}
    public Book(Page[] pa, String ti){
    p = pa; 
    title = ti; 
}
    public Page[] getPage(){
    return p; 
}
    public String getTitle(){
      return title; 
}    
public void setPage(Page[] x){
    p = x; 
}
public void setTitle(String y){
    title = y; 
}    
public void print(){
    System.out.print("Book info:" + p + " " + title);
}
}

public class Series
{
private Book bookOne, bookTwo, bookThree; 
private double price; 

public Series(){
    bookOne = null; 
    bookTwo = null; 
    bookThree = null; 
    price = 0; 
}

public Series(Book one, Book two, Book three, double p){
    bookOne = one; 
    bookTwo = two; 
    bookThree = three; 
    price = p; 
}    
public Book getBookTwo(){
    return bookTwo;
}    
public Book getBookOne(){
    return bookOne;
}    
public Book getBookThree(){
    return bookThree;
}    
public double getPrice(){
    return price;
}
public void setBookOne(Book bookOne){
    this.bookOne = bookOne;
}   
public void setBookTwo(Book bookTwo){
    this.bookTwo = bookTwo;
}    
public void setBookThree(Book bookThree){
    this.bookThree = bookThree;
}    
public void setPrice(double price){
    this.price = price; 
}
public void print(){
    System.out.println("Series info");
    System.out.println("Book one:" + bookOne + " Book Two: " +bookTwo
    + " Book Three: " + bookThree + "Price: " + price);
  }
 }

public class Driver
{
public static void main(String args[]){    
    MyWord[] w1 = new MyWord[2];
    w1[0] = new MyWord("Hello"); 
    w1[1] = new MyWord("Hola"); 

    Page[] p = new Page[2];
    p[0] = new Page(w1, 20); 
    p.print(); 
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:27:31.447

`p`是类型`Page[]`，即“页面数组”。而且数组没有`print()`方法。因此该语句`p.print()`无法编译（您应该在问题中这么说，并加入了确切的错误消息）。

要打印数组的所有页面，您需要遍历数组：

```
for (Page page : p) {
    page.print();
} 
```

请避免使用单字母变量，并为数组和集合使用复数形式：`Page[] pages = new Page[2];`

# jakarta-ee - Maven项目中的JCodeModel

> ID：10558817
> 
> 赞同：0
> 
> 时间：2012-05-11T21:22:02.197
> 
> 标签：jakarta-ee, maven, maven-plugin, maven-3

我是使用 JCodeModel 的新手。谁能给我一个简单的演示或链接如何在 maven 项目中使用 JCodeModel？我需要在哪里将 JCodeModel 类放在 maven 中以生成 java 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T07:07:23.603

我最终使用了两个不同的 Maven 插件来实现这一点。首先，我使用 maven ant 插件来编译我的 codemodel 代码。然后我使用 exec 插件运行 codemodel 代码，以便 maven 构建可以将生成的类构建为构建的一部分。我把Maven位放在下面：

```
 <plugins>
          ...
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <dependencies>
                <dependency>
                    <groupId>sun.jdk</groupId>
                    <artifactId>tools</artifactId>
                    <version>1.5.0</version>
                    <scope>system</scope>
                    <systemPath>${java.home}/../lib/tools.jar</systemPath>
                </dependency>
            </dependencies>

            <executions>
                <execution>
                    <id>1</id>
                    <phase>process-resources</phase>
                    <configuration>
                        <tasks>
                            <mkdir dir="${basedir}/target/classes" />
                            <javac srcdir="${basedir}/src/main/java/com/generation/" destdir="${basedir}/target/classes" classpathref="maven.compile.classpath">
                            </javac>
                        </tasks>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
         <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>exec-maven-plugin</artifactId>
            <version>1.2.1</version>
            <executions>
                <execution>
                    <id>2</id>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>exec</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <executable>java</executable>
                <arguments>
                    <argument>-classpath</argument>
                    <!-- automatically creates the classpath using all project dependencies,
                    also adding the project build directory -->
                    <classpath/>
                    <argument>com.generation.CodeGeneration</argument>
                </arguments>
            </configuration>
         </plugin>
        </plugins> 
```

# jquery - 如何在选项卡之间传递值/变量？

> ID：10558819
> 
> 赞同：1
> 
> 时间：2012-05-11T21:22:07.263
> 
> 标签：jquery

**设置：**

我正在使用 JSP 和 jQuery。有一个“父”页面，其中包含 3 个标签页。在选项卡 1 上，有一个表单，用户必须填写几个字段，例如名字、姓氏等。用户填写表单并转到其他选项卡。在选项卡 3 上，我必须显示他在选项卡 1 上输入的课程名称。所以基本上我必须在选项卡之间传递值。

**问题：**

我可以从选项卡 3 上的选项卡 1 访问一些字段，就像我在选项卡 1 上有一个下拉菜单：

```
 <div class="dropDownMenu">
                <select id="states">
                    <option value="ca">CA</option>
                    <option value="ny">NY</option>
                </select>
            </div> 
```

我可以在 Tab 3 上访问它，例如：

```
alert($('#states').text()); 
```

Bur 我无法访问选项卡 3 上的“course_id”。选项卡 1 包含以下内容：

```
 <div class="myCourse">
                <label for="course">Course</label>
                <input type="text" name="course_name" id="course_id" value=""/>
            </div> 
```

我想访问选项卡 3 上的**course_id**。有人可以告诉我该怎么做吗？我是 jQuery/Ajax 的新手，所以我可能会遗漏一些明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:31:04.537

绑定一个事件，`tabselect`我们将值写入`course_id`选项卡 3 上的位置。

jsFiddle：http: [//jsfiddle.net/UdSUp/4/](http://jsfiddle.net/UdSUp/4/)

```
$(function() {
    $( "#tabs" ).tabs();
});

$('#tabs').bind('tabsselect', function(event, ui) {
    $("#showCourseID").text($("#course_id").val());
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:24:54.193

如果您需要该值，请尝试

```
$("#course_id").val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:26:47.470

这应该为您提供 course_id 的值。值是由输入字段设置的，这就是文本不起作用的原因。

```
$('#course_id').val(); 
```

# sql - SQL Server 2008 - 在没有日志的情况下附加 mdf - 操作系统错误 5：5（访问被拒绝。）

> ID：10558820
> 
> 赞同：2
> 
> 时间：2012-05-11T21:22:12.893
> 
> 标签：sql, ssms, sql-server-2008

我正在尝试在没有日志文件的情况下附加数据库。

[附加缺少事务日志文件的 SQL Server 数据库](http://www.mssqltips.com/sqlservertip/1894/attach-a-sql-server-database-with-a-missing-transaction-log-file/)

**SSMS 错误**

![在此处输入图像描述](../Images/90ff58ccd94b83a6dd5069ff6bea89ea.png)

**TSL 错误**

> 消息 5120，级别 16，状态 101，第 1 行无法打开物理文件“....mdf”。操作系统错误 5：“5（拒绝访问。）”。

我不是 sa，但我是系统管理员角色。我不确定我需要什么访问权限。还是因为`.mdf`损坏了？

![在此处输入图像描述](../Images/06f236429f32d2712813f0b6b32fb85f.png)

预先感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T23:32:07.590

这是 SSMS 界面中的一个错误。可以使用 T-SQL 来完成。只是不要在文件列表中包含日志文件。

```
exec sp_attach_db 'dbname', 'filename' 
```

[sp_attach_db (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms179877.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T18:24:48.900

以管理员身份启动 SQL Server 管理器（右键单击程序，选择“以管理员身份启动”）：问题解决！

# regex - 使用 sed 删除大括号之间的所有内容

> ID：10558826
> 
> 赞同：4
> 
> 时间：2012-05-11T21:23:13.643
> 
> 标签：regex, sed

我有一个看起来像这样的字符串：

```
[%{%B%F{blue}%}master %{%F{red}%}*%{%f%k%b%}%{%f%k%b%K{black}%B%F{green}%}] 
```

我想删除匹配的子字符串`%{...}`，它可能包含也可能不包含相同顺序的其他子字符串。

我应该得到：`[master *]`作为最终输出。到目前为止我的进展：

```
gsed -E 's/%\{[^\}]*\}//g' 
```

这使：

```
echo '[%{%B%F{blue}%}master %{%F{red}%}*%{%f%k%b%}%{%f%k%b%K{black}%B%F{green}%}]' | gsed -E 's/%\{[^\}]*\}//g'
[%}master %}*%B%F{green}%}] 
```

因此，这*对于*`%{...}`不包含. 对于像（它返回）这样的字符串，它会失败。*`%{...}``%{%B%F{blue}%}``%}`*

 *我想要做的是解析字符串，直到找到*匹配* `}`的，然后删除直到那个点的所有内容，而不是删除与我遇到`%{`的*第一个之间的所有内容。* `}`我不知道该怎么做。

我完全意识到可能有多种方法可以做到这一点。如果可能的话，我希望得到关于问题中指定方式的答案，但任何想法都非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:44:59.717

这可能对您有用：

```
echo '[%{%B%F{blue}%}master %{%F{red}%}*%{%f%k%b%}%{%f%k%b%K{black}%B%F{green}%}]' |
sed 's/%{/{/g;:a;s/{[^{}]*}//g;ta'
[master *] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:33:26.510

使用递归从内到外吃掉它。

```
s/%{.*?%}//g 
```

然后包进去

```
while(there's at least one more brace) 
```

（可能而 $? -ne 0 ...无论 rcode sed 用来说“不匹配！”）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:01:12.813

试试这个：

```
sed -E 's/%{([^{}]*({[^}]*})*[^{}]*)*}//g' 
```*

# oracle - JBoss 应用程序无法与 Oracle 11g 建立 XA 连接

> ID：10558827
> 
> 赞同：0
> 
> 时间：2012-05-11T21:23:33.207
> 
> 标签：oracle, jboss, jta, xa

我一直在开发几个 JBoss 应用程序，我的笔记本电脑 (Windows XP) 上运行着所有东西，包括 Oracle 数据库（11g 企业版）。在笔记本电脑上一切正常。

现在我正在设置一台速度更快的新机器（运行 Windows 7 Professional），非 XA JBoss 应用程序运行良好，但需要 XA 连接的应用程序无法连接到 Oracle。我很确定这是我的新 Oracle 安装的问题，因为我可以将应用程序指向外部 Oracle 服务器并且它们可以工作，但是当它们指向我的本地 Oracle 数据库时它们无法连接。

我做了很多谷歌搜索，我能找到的唯一信息是我需要运行脚本`$ORACLE_HOME/rdbms/admin/xaview.sql`来创建一些 XA 视图，并且我需要向用户授予以下权限：

```
GRANT SELECT ON sys.dba_pending_transactions TO <user>;
GRANT SELECT ON sys.pending_trans$ TO <user>;
GRANT SELECT ON sys.dba_2pc_pending TO <user>;
GRANT EXECUTE ON sys.dbms_xa TO <user>; 
```

但是在完成所有这些之后，我仍然无法连接应用程序。这是我得到的例外：

```
org.jboss.resource.JBossResourceException：无法创建连接；- 嵌套的 throwable: (java.sql.SQLException: Io 异常:
网络适​​配器无法建立连接）在
org.jboss.resource.adapter.jdbc.xa.XAManagedConnectionFactory.createManagedConnection(XAMangedConnectionFactory.java:144) 在
org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventLisener(InternalManagedConnectionPool.java:577) 在
org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection(InternalManagedConnectionPool.java:262) 在
org.jboss.resource.connectionmanager.JBossManagedConnectionPool$BasePool.getConnection(JBossManagedConnectionPool.java:500) 在
org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection(BaseConnectionManager2.java:347) 在
org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection(TxConnectionManager.java:330) 在
org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection(BaseConnectionManager2.java:402) 在
org.jboss.resource.connectionmanager.BaseConnectionManager2$ConnectionManagerProxy.allocateConnection(BaseConnectionManager2.java:849) 在
org.jboss.resource.adapter.jdbc.WrapperDataSource.getConnection(WrapperDataSource.java:90) 在
org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:46) 在
org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:84)

```

我知道这不是一个真正的编程问题，但我希望有人以前见过这个。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:14:26.333

通过确保 LISTENER.ORA 文件和 TNSNAMES.ORA 文件中的主机名和域名设置匹配，我能够解决此问题。例如，如果一个有 HOST = localhost 而另一个有 HOST = myhost.xyz.com，那么它会导致 XA 出现问题，但不会导致正常的 Java JDBC 连接出现问题。我的理论是 XA 堆栈的某些部分需要建立一个读取 TNSNAMES.ORA 文件的 OCI 连接，但由于与侦听器配置不匹配而无法连接。普通的 Java JDBC 连接不关心 TNSNAMES.ORA 文件，因为它们使用自己的配置设置直接连接到侦听器。

我还必须将一些文件夹从 xxx_localhost_yyy 重命名为 xxx_myhost_yyy 才能让企业管理器工作。

为了让 TOAD 工作，我必须安装 32 位客户端，因为它不适用于 64 位客户端，我必须在 Windows 注册表中的 HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Oracle 下配置它的 ORACLE_HOME 变量。显然 Wow6432Node 是 Windows 注册表中的一个特殊位置，用于定义只有 32 位应用程序才能看到的值。

无论如何，我很欣慰所有的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T04:09:13.683

那么，您可以使用 sql 客户端连接到该数据库吗？

# excel-2010 - Excel 2010 - 嵌套 IF stmts - 为结果而不是数字获取“假”

> ID：10558828
> 
> 赞同：0
> 
> 时间：2012-05-11T21:23:38.367
> 
> 标签：excel-2010

示例中的总小时数 = 33

我正在使用的 if 语句：
`=IF(SUM(A5:A8)<39,(SUM(A5:A8)/8*$C$3),0)`适用于计算每日租金。 `=IF(SUM(A5:A8)>100,$E$3,0)`正确计算月租金。
`=IF(SUM(A5:A8)<100,(IF(SUM(A5:A8)>39,SUM(A5:A8)/40*$N$3)),IF(SUM(A5:A8)<39,0))`不起作用，它返回一个“假”而不是一个数字，在这种情况下应该是`0`.

如何让公式返回一个数字？或者他们是比使用 IF stmts 更好的方法吗？谢谢你。

我尝试了 MS 网站和其他来源，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:42:24.410

中心 if 语句`(IF(SUM(A5:A8)>39,SUM(A5:A8)/40*$N$3))`没有 False 子句，因此返回默认值 False

应该是`(IF(SUM(A5:A8)>39,SUM(A5:A8)/40*$N$3,some other expression))`

# php - 从字符串中回显表单

> ID：10558829
> 
> 赞同：0
> 
> 时间：2012-05-11T21:23:44.003
> 
> 标签：php, html

我有一个应该运行特定次数的回声语句，即'n'次，现在函数 abc() 是空的，出于测试目的，我想要做的是：-

```
echo "
<form  method=\"post\" action=\"<?php abc(); ?>\"  >
<input type='text' name='comment' style='width: 80%;height: 70px; margin-left: 60px' /> <br/>
<input type='submit' value='submit comment' style='margin-left:60px' />
</form>
"; 
```

但是每次我单击按钮提交表单时，我都会收到错误消息

> 禁止的
> 
> 您无权访问此服务器上的 /<。

如果我想做的事情是不可能的，有没有其他方法？

我想做的是；创建一个按钮，单击该按钮会调用 php 函数（可能会或可能不会重新加载页面，这并不重要）。将通过循环创建多个函数，并且对于每个循环迭代，传递给函数的值将不同。值，我不是指变量类型，我的意思是变量值会有所不同。我知道目前没有任何变量传递给 abc 函数，但就像我说的那样，abc 函数仅用于测试以尝试克服禁止的错误。

我实际上想要做的是这个..

```
$doubleinverted='"';
echo "
<form action=".$doubleinverted."<?php f_comment(".$row['ScrapId'].",'".$row1['Email']."');?>".$doubleinverted." method='post'>
<input type='text' name='comment' style='width: 80%;height: 70px; margin-left: 60px' /><br/>
<input type='submit' value='submit comment' style='margin-left:60px' />    
</form>
"; 
```

我知道您可以添加逗号`\"`，但我刚刚发现了这一点。

此外，此 echo 语句将处于循环中，并且对于每次迭代，传递给函数的值将不同

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:24:58.037

您不能在 echo 语句中使用 PHP 块。

如果`f_comment`回显一个字符串，你应该按照以下方式做一些事情：

```
echo "blah blah blah";
f_comment(...);
echo "more blah blah"; 
```

如果它返回一个值，则将其存储在变量中或连接字符串：

```
$string = "blah blah blah";
$string .= f_comment(...);
$string .= "more blah blah";

echo $string; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:27:02.853

```
echo "
<form  method=\"post\" action=\"<?php abc(); ?>\"  >
<input type='text' name='comment' style='width: 80%;height: 70px; margin-left: 60px' /> <br/>

<input type='submit' value='submit comment' style='margin-left:60px' />

</form>

"; 
```

表单的动作是`<?php abc(); ?>`在您已经处于 PHP 模式时。恐怕我不能让你那样做，戴夫！

将表格更改为`<form method=\"post\" action=\"' . abc() . '\" >`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T22:30:55.493

当您使用它时，请摆脱令人困惑的报价转义。这读起来更清楚...

```
<?php
    echo '<form  method="post" action="' . abc() . '">
    <input type="text" name="comment" style="width: 80%;height: 70px; margin-left: 60px" /> <br/>

    <input type="submit" value="submit comment" style="margin-left:60px" />

    </form>';
?> 
```

# image-processing - 抖动（图像）- 它到底是如何工作的？

> ID：10558830
> 
> 赞同：3
> 
> 时间：2012-05-11T21:24:04.650
> 
> 标签：image-processing, dithering

我认为抖动图像以下列方式工作是否正确：

我有一个由单个像素 (x) 组成的 2x2 图像块：

```
x  |  x
¬¬¬¬¬¬¬
x  |  x 
```

我希望通过以下值抖动图像：

```
3  |  4
¬¬¬¬¬¬¬
2  |  1 
```

因此，2x2 块是否会显示为：

```
x x | x x
x   | x x
¬¬¬¬¬¬¬¬¬
x x | x 
    | 
```

这个对吗？如果是这样，我是否正确说明了抖动的像素布局？

还是我完全错了？如果是这样，有人可以启发我（最好举个例子）？

我知道我选择使用的样本量很小，但这仅用于说明目的。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:19:15.287

我可以确认这是正确的方法。

# ios - 如何防止 NSTimer 被 iOS 5 中的用户界面操作延迟或中断

> ID：10558831
> 
> 赞同：5
> 
> 时间：2012-05-11T21:24:04.800
> 
> 标签：ios, ios5, nsrunloop

如何防止 NSTimer 被用户滚动表格延迟？

我找到了答案：

我有一个计时器，它以 0.4 到 0.8 秒的间隔重复大约 8 或 9 次。我不需要太多的精度，但是如果用户滚动表格，计时器将停止工作，直到表格完成滚动（这可能需要等待几秒钟！）。我以为我需要后台线程，但是后台线程上的计时器实现起来有些复杂。

我的问题的答案非常简单易行。我只需要在调用计时器后添加一行：

```
//////////// start the timer

self.playingTimer = [NSTimer scheduledTimerWithTimeInterval:tempo target:self selector:@selector(playSoundFromArray:) userInfo:nil repeats:YES];

//////////// the magic line:

[[NSRunLoop currentRunLoop] addTimer:self.playingTimer forMode:UITrackingRunLoopMode]; 
```

现在我可以随心所欲地滚动表格，而且我的计时器工作正常！！！

现在我需要多研究一点 NSRunLoop ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T07:21:50.933

您应该为 NSDefaultRunLoopMode 模式添加计时器。UITrackingRunLoopMode 用于跟踪 UI 操作（在您的情况下为滚动）。

# php - 如何获取php_phar.dll？

> ID：10558843
> 
> 赞同：5
> 
> 时间：2012-05-11T21:25:12.137
> 
> 标签：php, dll, pear, phar

Windows 上的 PHP 不包含**php_phar.dll**，这意味着

安装梨时，我必须这样做 php -d phar.require_hash=0 go-pear.phar 因为它不会安装梨的图形部分

我不能在 Eclipse 中使用 MakeGood 进行单元测试

我一般不能使用 phar

有没有办法进入 php_phar.dll 或 pear 社区刚刚决定他们不支持 Windows 服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T07:57:51.217

phar 扩展现在是 PHP 的一部分，无法删除（静态构建），因此您不需要 .dll 文件。

运行`php -m`以查看它的列表。

# android - 扫描进度条

> ID：10558846
> 
> 赞同：0
> 
> 时间：2012-05-11T21:25:30.323
> 
> 标签：android

我正在为我的应用程序开发向导类型的屏幕，用户将在其中提供一些将发送到服务器的数据。当用户等待响应时，我希望有一个像 android 一样的加载器来显示设备的第一次设置。它是绿色（或蓝色）的运行条纹块。有人知道如何在不做自定义动画的情况下将它们从 android 的风格主题中理想地带到我的应用程序中吗？

![设备设置屏幕](../Images/0fea5348ffda4162a5aad40256ffc907.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:03:52.020

那必须是一个 ProgressBar。

```
<ProgressBar
    android:id="@+id/scanning_progress_bar"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    style="?android:attr/progressBarStyleHorizontal" /> 
```

# c# - WPF RichTextBox 有效地将代码中的文本加粗

> ID：10558847
> 
> 赞同：0
> 
> 时间：2012-05-11T21:25:42.250
> 
> 标签：c#, wpf, formatting, richtextbox

我是 WPF 的新手，所以请原谅我的无知，我已经尝试用谷歌搜索这个问题大约 30 分钟以上，但似乎找不到适合我的场景的简单解决方案。

基本上我制作了一个 IRC 应用程序，它从服务器读取一行，我读取了昵称和消息。并像这样写一行：

```
<Nick> Message typed... 
```

我想要`<Nick>`粗体的部分。后来可能是一种颜色。我还看到了一些针对每个循环的示例，但是如果我有 1000 多行并且每次有人键入某些内容时都执行一个 foreach 循环，那会不会效率不高？

请从 c# 编程方面建议最好/最简单的方法。

这是我的代码：

```
 private void OnChannelMessage(object sender, IrcEventArgs e)
    {
        if (!txtActivity.Dispatcher.CheckAccess())
        {
            txtActivity.Dispatcher.Invoke(DispatcherPriority.Normal, new Action(delegate()
                  {
                      txtActivity.AppendText(string.Format("<Bold><{0}:{1}></Bold> {2}\n", e.Data.Channel, e.Data.Nick, e.Data.Message));

                      //Paragraph p = new Paragraph();
                      //p.Inlines.Add(new Bold(new Run(string.Format("<{0}> ", e.Data.Nick))));
                      //p.Inlines.Add(new Run(string.Format("{0}\n", e.Data.Message)));
                      //txtActivity.Document.Blocks.Add(p); // problem adds a big space between lines.
                  }
            ));
        }
    } 
```

XAML：

```
<Grid>
    <RichTextBox Name="txtActivity" VerticalScrollBarVisibility="Auto" Margin="12,12,12,41" BorderThickness="2" FontFamily="Consolas">
        <RichTextBox.Resources>
            <Style TargetType="{x:Type Paragraph}">
                <Setter Property="Margin" Value="0"/>
            </Style>
        </RichTextBox.Resources>
    </RichTextBox>
    <Button Content="Quit" Height="23" HorizontalAlignment="Left" Margin="628,371,0,0" Name="btnQuit" VerticalAlignment="Top" Width="50" Click="btnQuit_Click" />
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:46:59.797

使用流文档。它支持具有大量格式的标记。

[流文档](http://msdn.microsoft.com/en-us/library/system.windows.documents.flowdocument.aspx)

# objective-c - 如何获取在线朋友 - facebook graph api

> ID：10558849
> 
> 赞同：0
> 
> 时间：2012-05-11T21:25:43.087
> 
> 标签：objective-c, ios, facebook-graph-api

我正在为 iPhone 开发一款游戏，需要在个人朋友列表中获取在线的朋友。我只能获取朋友和他们的 ID。使用这个

```
[facebook requestWithGraphPath:@"me/friends" andDelegate:self]; 
```

任何代码都会有帮助谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T05:07:31.403

目前没有可用于 iPhone 的 api。您只能获取好友列表。

# session - 在 nodejs / redis 中保存 tcp 会话？

> ID：10558859
> 
> 赞同：0
> 
> 时间：2012-05-11T21:26:16.090
> 
> 标签：session, node.js, tcp, redis

我目前正在通过在 TCP 上开发一个小型聊天应用程序（经典案例）来学习 node.js。

我现在想做的是扩展这个应用程序以使用静态用户：

*   围绕消息传递的所有逻辑都应该基于用户而不是会话。
*   因此，每个会话都需要与对用户的引用一起保存（以便应用程序可以根据用户名在正确的会话中发送消息）。
*   我已经研究过 Redis 来存储这些数据，但到目前为止还没有成功。

    ```
     tcpServer.on 'connection', (tcpSocket) -> tcpSocket.write "Welcome"
            redis.hmset("sessions", userid, tcpSocket)
            tcpSocket.on "data", (data) ->
                redis.hvals "sessions", (err, repl) ->
                    repl.forEach (reply, y) ->
                        reply.Write("Data is written to clients!")
        tcpServer.listen 7000 
    ```

当前错误消息：TypeError: Object [object Object] has no method 'write'

这表明我现在无法存储 tcpSocket 。有人可以告诉我是否可以进行细微调整以使其正确，还是应该重新考虑此解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T05:00:38.560

Redis 支持的数据类型很少：字符串、列表、集合、排序列表和哈希表。就是这样。其他一些类型，如日期，可以很容易地转换为字符串/从字符串转换，因此也可以使用它。但是 socket 是一个复杂的内部对象，所以你很可能无法将其转换为字符串，因此无法存储在 Redis 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T09:39:02.627

由于套接字对象在 Redis 中存储起来很复杂，看来要走的路是根据下面的链接向对象添加标识符。

然后这个标识符当然可以保存在数据库中，以在不同对象之间创建关系等。

[如何使用 Node.js 唯一标识套接字](https://stackoverflow.com/questions/6805432/how-to-uniquely-identify-a-socket-with-node-js)

# c# - 请为我破译这个 C# 表达式

> ID：10558865
> 
> 赞同：1
> 
> 时间：2012-05-11T21:26:42.300
> 
> 标签：c#

这是什么意思？？

```
var cdParams = (includeUniversals) 
? new[] {pageDictionary[pageName], pageDictionary[CNNService.UniversalPage.Name]}
: new[] {pageDictionary[pageName]}; 
```

基本上它归结为什么？意思是什么 new[] 是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T21:29:06.940

它大致相当于：

```
Foo[] cdParams;  // Use the correct type instead of Foo. NB: var won't work here.
if (includeUniversals) { 
    dParams = new Foo[2];
    dParams[0] = pageDictionary[pageName];
    dParams[1] = pageDictionary[CNNService.UniversalPage.Name];
} else {
    dParams = new Foo[1];
    dParams[0] = pageDictionary[pageName];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T21:29:03.390

这是一个[三元表达式](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.80%29.aspx)。如果条件为真，则执行第一种情况。如果为假，则执行第二种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T21:29:04.363

如果布尔值`includeUniversals`计算为真，则返回一个新的匿名对象数组包含`pageDictionary[pageName]`，`pageDictionary[CNNService.UniversalPage.Name]`否则返回一个新的匿名对象数组包含`pageDictionary[pageName]`

那就是你要找的东西？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T21:29:17.930

```
var cdParams // type inferred by the compiler
 = (includeUniversals) ? // if includeUniversals is true

// then cdParams = new a new array with 2 values coming from a dictionary
 new[] { pageDictionary[pageName], pageDictionary[CNNService.UniversalPage.Name] }

// otherwise, cdParams = a new array with one value
: new[] { pageDictionary[pageName] }; 
```

请参阅[三元运算符](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.80%29.aspx)和[隐式数组类型](http://msdn.microsoft.com/en-us/library/bb384090.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:30:21.197

取决于`includeUniversals`，`cdParams`将是一个包含两个值的数组，即`pageDictionary[pageName]`和`pageDictionary[CNNService.UniversalPage.Name]`- 或，它将是一个包含一个值的数组，即`pageDictionary[pageName]`。

# ruby-on-rails-3 - Rails 未定义的方法计数

> ID：10558869
> 
> 赞同：0
> 
> 时间：2012-05-11T21:27:04.333
> 
> 标签：ruby-on-rails-3

我正在尝试在删除地址之前检查它是否未被使用。我的代码如下：

```
def destroy
        @address = current_user.addresses.find_by_id(params[:id])
        redirect_to user_addresses_path(current_user) if @address.nil?

        if Organisation.find_by_address_id(params[:id]).count == 0 && Event.find_by_address_id(params[:id]).count == 0
            @address.destroy
            redirect_to user_addresses_path(current_user)
        else
            flash[:error] = "Cannot delete address because it is being used"
            redirect_to user_addresses_path(current_user)
        end
    end 
```

但是，这给了我一个错误：

```
undefined method `count' for nil:NilClass 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:33:38.253

`Organisation.find_by_address_id(params[:id])`将返回一个对象，或者`nil`如果没有那个对象`address_id`不存在。

也许你的意思是`Organisation.find_all_by_address_id(params[:id])`。

# python - 如何获取与正则表达式匹配的片段的行号？

> ID：10558875
> 
> 赞同：2
> 
> 时间：2012-05-11T21:27:43.290
> 
> 标签：python, regex

如何在文件中获取与给定匹配的所有文本片段的**行号**`regexp`？

```
file_content = f.read()

m = re.compile('regexp')
# How to extract line numbers of the matched text snippets? 
```

正则表达式不能跨行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:40:40.420

```
 with open(somefile, 'r') as f:
     line_numbers = [n for n, line in enumerate(f) if re.search(someRegexp, line)] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T04:46:21.420

```
import re
reg="ha*"
count=0
f = open(somefile,'r')
while True:
        line= f.readline()
        if not line: break
        else:
                count+=1
                if re.search(reg,line):
                        print count,line 
```

# ubuntu - 从 ubuntu 的终端，更改文件描述符编号的 ulimit

> ID：10558876
> 
> 赞同：3
> 
> 时间：2012-05-11T21:27:57.897
> 
> 标签：ubuntu, uwsgi, ulimit

从终端我试图改变打开的文件描述的数量，他们不会坚持。如何从终端更改 ulimit？根据以下内容，当我从终端运行 uwsgi 时，fd 位于 1024。

```
ubuntu@ubuntu:/tmp$ uwsgi --loop gevent --socket :3031 --wsgi-file /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbAsyncServers/bottleServer.py --master --async 100 --listen 300 --processes 1
*** Starting uWSGI 1.2.1 (64bit) on [Sat May 12 05:24:25 2012] ***
compiled with version: 4.5.2 on 11 May 2012 03:42:53
detected number of CPU cores: 2
current working directory: /tmp
detected binary path: /usr/local/bin/uwsgi
your memory page size is 4096 bytes
detected max file descriptor number: 1024
async fd table size: 1024
allocated 103200 bytes (100 KB) for 100 cores per worker.
lock engine: pthread robust mutexes
uwsgi socket 0 bound to TCP address :3031 fd 3
Python version: 2.7.1+ (r271:86832, Apr 11 2011, 18:37:12)  [GCC 4.5.2]
*** Python threads support is disabled. You can enable it with --enable-threads ***
Python main interpreter initialized at 0xd9bfd0
your server socket listen backlog is limited to 300 connections
*** Operational MODE: async ***
WSGI app 0 (mountpoint='') ready in 8 seconds on interpreter 0xd9bfd0 pid: 17688 (default app)
*** uWSGI is running in multiple interpreter mode ***
spawned uWSGI master process (pid: 17688)
spawned uWSGI worker 1 (pid: 17742, cores: 100)
*** running gevent loop engine [addr:0x4503f0] ***
!!! Running gevent without threads IS NOT recommended, enable them with --enable-threads !!! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T10:49:53.100

在尝试增加 Nginx 的文件描述符数量时，我遇到了类似的问题。`nofile`我必须为www-data 用户更改*/etc/security/limits.conf ：*

```
www-data    hard    nofile    16384
www-data    soft    nofile    16384 
```

在此更改之后 ulimit 仍然显示限制为 1024。解决方案是在*/etc/pam.d/su*中启用 *pam_limits* 。我只是取消注释该行：

```
session    required    pam_limits.so 
```

更改此值不需要重新启动，我只是再次以 www-data 身份登录。现在，运行`ulimit -a`揭示了价值`16384`。

希望这可以帮助。

# java - Java游戏中的2D碰撞问题

> ID：10558879
> 
> 赞同：1
> 
> 时间：2012-05-11T21:28:18.523
> 
> 标签：java, collision-detection

几周以来，我一直在用 LWJGL 开发这款游戏。自从我添加了跳跃的能力，向上的碰撞给我带来了很多问题。

该游戏是基于 2D 瓷砖的横向卷轴。总的来说，除了玩家跳跃时，碰撞几乎是完美的。起初我想“哦，也许我只需要改变跳跃机制”，但后来我意识到只有当玩家通过某个 x 坐标时才会发生这种情况。

现在，对于实际问题本身：如果玩家在通过某个 x 坐标时跳跃，他们将通过瓷砖并且顶部碰撞测试返回 false。

这是整个 Player 类：

```
package Minecraft2D;

import static Minecraft2D.World.BLOCK_SIZE;
import Minecraft2D.Tools.Tools;
import Minecraft2D.UI.Inventory;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import static Minecraft2D.Boot.*;

import org.lwjgl.util.Rectangle;
import org.newdawn.slick.opengl.Texture;
import org.newdawn.slick.opengl.TextureLoader;

public class Player {

private float x;
private float y;
public int width = 32;
public int height = 50;
private float DX = 0;
private float DY = 0;
private Texture left = null;
private Texture right = null;
Texture texture = null;

public boolean direction[] = { false, false, false, false };
public boolean collision = false;
public boolean ground = false;
public boolean jump = false;
public boolean top = false;

public Player(float x, float y) {
    this.x = x;
    this.y = y;
    try {

        this.left = TextureLoader.getTexture("PNG", new FileInputStream(new File(path + "player_left.png")));
        this.right = TextureLoader.getTexture("PNG", new FileInputStream(new File(path + "player_right.png")));
        this.texture = this.right;
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

public void draw() {
    Tools.drawTexture((int)x, (int)y, width, height, texture);
}

public void checkCollision(Player player, Block block) {

    if (player.getY() < block.getY() + BLOCK_SIZE && player.getX() < block.getX() + BLOCK_SIZE && player.getY() + this.height > block.getY() && player.getX() + this.width > block.getX() && block.getType() != BlockType.AIR) {
        Rectangle top = new Rectangle();
        top.setBounds((int) player.x + 4, (int) player.y + 1, this.width - 8, 1);
        Rectangle bottom = new Rectangle();
        bottom.setBounds((int) player.x + 4, (int) player.y + this.height, this.width - 8, 1);
        Rectangle left = new Rectangle();
        left.setBounds((int) player.x, (int) player.y + 1, 1, this.height - 5);
        Rectangle right = new Rectangle();
        right.setBounds((int) player.x + player.width, (int) player.y + 1, 1, this.height - 5);
        Rectangle blok = new Rectangle();
        blok.setBounds((int) block.getX(), (int) block.getY(), BLOCK_SIZE, BLOCK_SIZE);
        if (bottom.intersects(blok)) {
            player.setY((block.getY() - this.height - 1));
            ground = true;
            jump = false;
        } else if (top.intersects(blok)) {
            DY = 0;
            this.top = true;
            y -= (player.y) - (block.getY() + BLOCK_SIZE);
        }
        if (!top.intersects(blok)) {
            if (left.intersects(blok)) {
                player.setX(block.getX() + this.width);
            } else if (right.intersects(blok)) {
                player.setX(block.getX() - this.width);
            }
        }

    } else {
        collision = false;
        ground = false;
    }

    if (!collision && !jump) {
        setDY(.003f);
    }
    if (ground && !jump) {
        DY = 0;
    }

    if (jump && DY < 0.003f) {
        DY += 0.0001;
    } else {
        // jump = false;
    }

    if (top) {
        DY = 0f;
        top = false;
    }

    x += DX;
    y += DY;

    if (x > Boot.SCREEN_WIDTH) {
        x = 0;
    }
    if (x < 0) {
        x = Boot.SCREEN_WIDTH;
    }
}

public float getX() {
    return x;
}

public void setX(float x) {
    this.x = x;
}

public float getY() {
    return y;
}

public void setY(float y) {
    this.y = y;
}

public void setDX(float dx) {
    this.DX = dx;
}

public void setDY(float dy) {
    this.DY = dy;
}

public void setJump() {
    if (!jump) {
        jump = true;
        ground = false;
        DY = -0.13f;
        y -= 1;
    }
}

public void setTexture(int tex) {
    if (tex == 0) {
        this.texture = this.left;
    }
    if (tex == 1) {
        this.texture = this.right;
    }
}

} 
```

===============

编辑：我不知道为什么，但是当我的角色靠近地图的 0 x 坐标时，角色的 y 坐标增加得非常缓慢。这可能与我遇到的问题有关。我正在调查它，我怀疑当我将玩家的 x 和 y 值从双精度值转换为整数以用于顶部、底部、左侧和右侧矩形时，它可能会有所作为。

再次编辑：我不知道这是否重要，但我一直在检查这样的碰撞：（这是在“引导”类中。）

```
private void checkCollision() {
            for (int x = 0; x < BLOCKS_WIDTH - 1; x++) {
              for (int y = 0; y < BLOCKS_HEIGHT - 1; y++) {
                Block blk = grid.getAt(x, y);
                player.checkCollision(blk);
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T22:27:21.513

为什么要将玩家传递给 checkCollision？似乎您不应该传入玩家，而是使用调用 checkCollision 方法的玩家成员。我认为这可能会给您带来一些困惑。如：

```
y -= (player.y) - (block.getY() + BLOCK_SIZE); 
```

这看起来像是您试图将玩家推到他们在跳跃过程中与之相交的块 b/c 下方。如果是这样的话，它应该只是

```
y = (block.getY() + BLOCK_SIZE); 
```

我会从函数参数中删除播放器并重写函数，看看你得到了什么。希望有帮助。

编辑

您的评论指出您不能再将播放器传递给该函数。不确定您的确切实现，但这是我通常看到的游戏的样子：

```
 public class Player 
 {
    private int x, y, dx, dy;

    public void checkCollision(Block block)
    {
       if (isTopCollision(block))
         fall(block.getY() + block.getHeight());
    }

    private boolean isTopCollision(Block block)
    {
       return y > block.getY() + block.getSize() && y < block.getY();
    }

    private void fall(int adjustedY)
    {
       y = adjustedY;
       top = true;
       dy = 0;
       // etc
    }
 }

 public class MyGame 
 {
     public void gameloop()
     {
       for (Block b : blocks)
         player.checkCollision(b);
     }
 } 
```

# git - Git gvim diff 无法显示差异

> ID：10558882
> 
> 赞同：3
> 
> 时间：2012-05-11T21:28:28.273
> 
> 标签：git, vim

我想将 gVim(7.3) 用于 git diff。我使用 cygwin，这是我的 .gitconfig 文件。

```
[diff]
    tool = my_gvimdiff
[difftool "my_gvimdiff"]
    cmd = gvim -d "$(cygpath -w $LOCAL)" "$REMOTE"
[alias]
    dt = difftool 
```

我的问题是，gVim 在 diffmode 中使用了正确的文件，但我没有看到任何彩色差异。gVim 给了我 E97 并说它不能在启动过程中产生差异。古玩是，如果我开始编辑本地文件，例如我添加一个新行，那么我只看到提交文件的这种差异（彩色）。我的配置有什么问题？谁能给我一个提示...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:45:16.750

我猜你在窗户上。我也猜你可能有 Cygwin/MSYSGIT 混合物。

在这种情况下，根据您启动 Vim 的方式，环境会有所不同

*   来自 GIT Bash
*   来自 cygwin bash
*   从 cmd.exe
*   从 TortoiseGit、Visual Studio 或其他应用程序或服务启动

Vim 可能没有找到外部`diff`命令（或者正在找到某种名称不合适的 Windows/DOS 命令）。

# java - 覆盖克隆方法 - 不起作用（Java）

> ID：10558884
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:28:54.233
> 
> 标签：java, clone, deep-copy

我正在编写一个搜索算法来解决java中的15个难题。当我克隆拼图状态以生成新的可能动作（女儿）时，它们仍然相互改变而不是分开。

这是我的克隆方法：

```
public FifteenPuzzleState clone() throws CloneNotSupportedException
{
FifteenPuzzleState copy = (FifteenPuzzleState)super.clone();
for(int i=0; i<copy.currentConfig.length; i++){
    copy.currentConfig[i] = Arrays.copyOf(currentConfig[i], currentConfig[i].length);
}
return copy;     
} 
```

所以我的问题是，在我克隆状态然后改变它之后，它也会影响以前的状态和所有其他克隆。我的第一个想法是我没有正确创建二维数组的深层副本，但我找不到上面的代码有什么问题。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:30:30.587

你是对的。您需要通过手动`clone()`ing 数组中的每个元素来进行深层复制。

# xml - RDF 三元组中的等价类

> ID：10558889
> 
> 赞同：0
> 
> 时间：2012-05-11T21:29:11.963
> 
> 标签：xml, rdf, ontology, triplestore

我在本体文件中有许多类，在 xml 文件中有相同数量的具有不同名称的类。我已经从 XML 文件创建了一个 RDF 三元存储。现在我需要将三重存储中的类名更改为本体中的类名。

任何人都可以知道如何使用 SPARQL 查询来实现等价吗？如果它不能通过 SPARQL 查询来完成，那么最好的方法是什么？

------------ 这是RDF的一小部分--------

```
<rdf:RDF
    xmlns:j.0="http://link/myLink/myOntology.rdf#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" > 
  <rdf:Description rdf:about="http://myDomain/myLink/%a=class/class9/">
    <j.0:hadP>Sea Power</j.0:hadP>
    <j.0:hadP>Steel city</j.0:hadP>
    <j.0:hadP>Singer1</j.0:hadP>
    <j.0:hadV>20</j.0:hadV>
    <j.0:hadP>City</j.0:hadP>
    <j.0:hadP>Singer2</j.0:hadP>
    <j.0:hadP>Singer3</j.0:hadP>
    <j.0:hadV>80</j.0:hadV>
    <j.0:hadVEvent>web:V</j.0:hadVEvent>
    <j.0:hadP>Park</j.0:hadP>
    <j.0:hadP>Arctic</j.0:hadP>
    <j.0:hadP>Guns</j.0:hadP>
    <rdf:type rdf:resource="http://link/myLink/myOntology.rdf#**ClassName**"/>
    <j.0:hadP>City Center</j.0:hadP>
    <j.0:hadV>100</j.0:hadV>
    <j.0:hadV>40</j.0:hadV>
  </rdf:Description>
 </rdf:RDF> 
```

我想将名称（ClassName）更改为不同的名称，例如（ClassA）。我可以通过编写 SPARQL QUERY 来做到这一点吗？

作为一个工具包，我正在使用 gena 我不确定我在问什么是可能的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T23:41:56.467

`Resource`通常，Jena 资源是不可变的：对象一旦创建就无法更改。这意味着您不能更改任何资源的 URI，包括类。

相反，您要做的是更新模型以展示重命名的效果。假设您要将资源重命名`R`为`S`. 对于每个三元组：

```
R P O 
```

你需要添加一个新的三元组：

```
S P O 
```

并删除旧的`R P O`三元组。同样，`Q P R`应该删除每个三元组并`Q P S`添加一个三元组。

Jena API 中有一个实用程序可以为您执行此操作：[`ResourceUtils.renameResource`](http://jena.apache.org/documentation/javadoc/jena/com/hp/hpl/jena/util/ResourceUtils.html#renameResource%28com.hp.hpl.jena.rdf.model.Resource,%20java.lang.String%29). 如果您想坚持使用 SPARQL，则必须经历相同的添加和删除三元组过程，但您可以通过[Jena 支持的](http://jena.apache.org/documentation/query/update.html)[SPARQL Update](http://www.w3.org/TR/sparql11-update/)来完成。

# html - TinyMCE Con tent_css 不工作

> ID：10558890
> 
> 赞同：1
> 
> 时间：2012-05-11T21:29:15.753
> 
> 标签：html, asp.net-mvc-3, tinymce

我正在使用带有 MVC 3 剃须刀引擎的 TinyMCE。我正在尝试添加我自己的类，我使用 content_css 并添加了我的样式表。这些类通常出现在下拉列表中，但是当我单击它们时，它们不会影响视图或 html。我应该在哪里查看或检查我使用的是 3.4.7 版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T22:45:42.533

问题出在tinymce版本上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:02:53.070

这可能是 tinymce 的错误。您可以获取最新版本并尝试。

还可以考虑迁移到[ckeditor](http://ckeditor.com/)。它是一个很棒的编辑器，并且支持一堆插件。它还具有高度可定制性且易于实施和设置。

# c - 将字符串从文件存储到数组

> ID：10558892
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:29:18.600
> 
> 标签：c, arrays, string, file

我已经从两个文件中读取了字符串并将它们存储到两个单独的数组中，然后我尝试对它们进行排序并将它们写入另一个文件......这部分按预期的方式工作，但我真正需要做的是组合字符串从两个数组合二为一，以便我可以按字母顺序对它们进行排序，然后写入文件，但问题是当我尝试将这两个数组存储到一个数组中时，我得到分段错误作为错误消息..我真的不知道如何将这两个数组存储到另一个数组中以便我可以按顺序对其进行排序...我知道如何对其进行排序我只是不确定如何将它们读入另一个数组...我不能使用#DEFINE，因为我将把所有这些写成一个测试代码的函数......

我尝试过类似的东西

> 新[i] = str;

并且：

> strcpy(新[i],str)

但这些都不起作用......任何帮助将不胜感激......

这是我的代码：

```
#include<stdio.h>
#include<string.h>

main (void)
{
    char str[200];
    char str2[300];
    char new[300];
    char temp [300];
    int linenumber=0;
    FILE *fa = fopen ("book1.dat", "r");
    FILE *fb = fopen ("book2.dat", "r");
    FILE *fc = fopen ("fixed.txt", "w");

    int i=0;
    int j=0;
    int k;

    /*read the strings into an array while it is not the end of file*/
    while(!feof(fa)&& !feof(fb))
    {
        linenumber++;
       fscanf(fa,"%[^\n]\n",str);
       fscanf(fb,"%[^\n]\n",str2);

       /*compare strings in array and write to array*/
       if(strcmp(str2, str)<0)
       {
           fprintf(fc, "%s\n", str2);
           fprintf(fc, "%s\n", str);
       }

       if (strcmp(str2,str)>0)
       {
           fprintf(fc, "%s\n", str);
           fprintf(fc, "%s\n", str2)
       }

       /*print out the results of str */
       printf("%s", str);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T13:51:18.830

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef char* Type;

typedef struct vector {
    size_t size;
    size_t capacity;
    Type *array;
} Vector;

Vector *vec_make(){
    Vector *v;
    v = (Vector*)malloc(sizeof(Vector));
    v->size = 0;
    v->capacity=16;
    v->array=(Type*)realloc(NULL, sizeof(Vector)*(v->capacity *= 2));
    return v;
}

void vec_add(Vector *v, Type value){
    v->array[v->size] = value;
    if(++v->size == v->capacity)
        v->array=(Type*)realloc(v->array, sizeof(Vector)*(v->capacity *= 2));
}

size_t vec_size(Vector *v){
    return v->size;
}

Type *vec_getArray(Vector *v){
    return v->array;
}

void vec_free(Vector *v){
    free(v->array);
    free(v);
}

int cmp(const void *a, const void *b){
    return strcmp(*(char**)a, *(char**)b);
}

void merge(const char *inpfile1, const char *inpfile2, const char *outfile){
    FILE *fp;
    char buff[256], **array;
    Vector *v;
    size_t c, size;

    v = vec_make();
    fp=fopen(inpfile1, "r");
    while(NULL!=fgets (buff, 256, fp))
        vec_add(v, strdup(buff));
    fclose(fp);

    fp=fopen(inpfile2, "r");
    while(NULL!=fgets (buff, 256, fp))
        vec_add(v, strdup(buff));
    fclose(fp);

    array=vec_getArray(v);
    size=vec_size(v);
//  qsort(array, size, sizeof(Type), cmp);
    fp=fopen(outfile, "w");
    for(c=0;c < size; ++c){
        fputs(array[c], fp);
        free(array[c]);
    }
    fclose(fp);
    vec_free(v);
}

int main(){
    merge("book1.txt", "book2.txt", "fixed.txt");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:49:43.480

新建一个 char* 数组并使用 strdup 复制 str 中包含的字符串。

# jquery - 循环一个 jQuery 字体大小的动画

> ID：10558894
> 
> 赞同：3
> 
> 时间：2012-05-11T21:29:29.923
> 
> 标签：jquery, css, animation, loops, font-size

我目前有一行文本，其默认字体大小为 24。我将其设置为动画以调整回 22：

```
$(document).ready(function animateHeader() {
$('#random_header').animate({fontSize : "22px"}, 500);
}); 
```

我想在 24 到 22 和 22 到 24 之间连续循环播放这个动画。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:32:37.593

### *[jsBin 演示](http://jsbin.com/uzaweg/2/edit)*

```
$(document).ready(function(){

  function animateHeader(){
    $('#random_header').animate({fontSize : 22}, 500,function(){
      $(this).animate({fontSize : 24}, 500, animateHeader);
    });
  }
  animateHeader();

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:35:07.710

```
$(document).ready(function animateHeader() {
    $('#random_header').animate({
        fontSize: $('#random_header').css('fontSize') == '24px' ? '22px' : '24px'
    }, 500, animateHeader);
});​ 
```

[http://jsfiddle.net/thirtydot/aDZLy/](http://jsfiddle.net/thirtydot/aDZLy/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T21:34:26.407

尝试

```
function ani(size){
 $('#random_header').animate({fontSize : size+"px"}, 500, function(){ ani((size==22) ? 24 : 22 ); } );
}

ani(24); 
```

# java - 快速 StringOutOfBoundsException 查询

> ID：10558895
> 
> 赞同：1
> 
> 时间：2012-05-11T21:29:30.173
> 
> 标签：java, exception

```
 if(Character.isDigit(character) && Character.isDigit(expression.charAt(x+1)))
            {
                output += character;
            }
            else if(Character.isDigit(character))
            {
                output += character + " ";
            }   
            else
            {
                output += character;
            } 
```

这个代码块在一个更大的 for 循环中，它遍历一个字符串。x+1 导致 StringOutOfBoundsException，有什么办法可以避免吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:32:45.303

您可以添加一个额外的检查，以确保您的值`x + 1`小于字符串的长度，以确保您的索引不会超过字符串的末尾：

```
if (Character.isDigit(character) &&
    (x + 1) < expression.length &&
    Character.isDigit(expression.charAt(x+1))) 
```

# java - Java 网络，超越简单的聊天室

> ID：10558906
> 
> 赞同：0
> 
> 时间：2012-05-11T21:30:40.830
> 
> 标签：java, networking

所以我最近关注[了这个](http://www.cn-java.com/download/data/book/socket_chat.pdf)教程，用 Java 制作一个基本的聊天室。它使用多线程，是一个“面向连接”的服务器。我想知道如何使用相同的 Sockets 和 ServerSockets 来发送对象的 3d 位置，而不仅仅是一个字符串？

目前，基本的聊天室系统只是向服务器发送一个字符串，然后服务器将其发送给所有连接的客户端。我想要的是能够让客户端更改对象的位置（很可能是他们的角色），并将位置更改发送到服务器。然后（我想）服务器会将位置变化发送给连接到它的每个客户端，然后每个客户端将依次在其新位置呈现该对象。

我想知道做这种事情的*最好*方法是什么？是否会发送一个字符串并让服务器将其解析为坐标？我可以一次向 DataOutputStream 写入多个内容吗？

我觉得我可能解释得不好，所以请提出一些澄清问题。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:35:49.063

为您的坐标系创建域对象模型。然后使用上述模型中的对象表示位置的变化。将它们序列化为可传输的字符串，如 XML、JSON 等。然后将字符串解组/反序列化为原始对象并对其进行操作。

这将您的传输层（使用套接字广播内容）与实际的业务逻辑（对象的放置）分开，并且系统变得可扩展。

# php - Jquery中JSON AJAX响应的时间

> ID：10558907
> 
> 赞同：0
> 
> 时间：2012-05-11T21:30:54.380
> 
> 标签：php, jquery, ajax, json, facebook-graph-api

我认为这更多地取决于时间而不是代码，所以我真的在寻找关于如何最好地获得 JSON 响应的最佳实践建议。

```
<script type="text/javascript">

            $(window).load(function() {
                $('#messages').append('<img src="images/loading.gif" alt="Currently Loading" id="loading" />');

                var ideaid = <?php echo $_GET['ideaid']; ?>;
                $.ajax({

                    url: 'sql/ajaxsql.php',
                    type: 'POST',
                    data: 'switch=commentList&ideaid=' + ideaid + '&filter=sortdate',
                    dataType: 'json',

                    success: function(result) {
                        var len = result.length;
                        var html;
                        console.log('length= ' + len);
                        $('#response').remove();
                        console.log(result);
                        for(var i = 0; i < len; i++) {
                            var pic = '<img src="https://graph.facebook.com/' + result[i].user_id + '/picture&type=small" align="middle" />';
                            var authname;
                            FB.api('/' + result[i].user_id + '?fields=name', function(AuthName) {
                                console.log(AuthName);
                                alert(AuthName.name);
                               authname = AuthName.name;

                            });
                            html = '<p>' + result[i].comment + '<br><hr>Date Added: ' + result[i].date + ' by ' + pic + ' ' + authname + '<br><hr><hr></p>';
                            $('#comms').append(html);

                        }

                        $('#loading').fadeOut(500, function() {
                            $(this).remove();

                        });
                    }
                });

                return false;
            });

        </script> 
```

使用此代码，它会触发以获取有关某个想法（idea_id）的评论。评论仅包含用户 ID (facebook)。当所有数据都返回时，成功然后将准备好以某种顺序打印到屏幕的数据排序。

作为成功的一部分，我在每条评论下都有日期、时间、FB 图片和名称作为作者信息的一部分。

日期和时间，有效。使用图表的图像有效，但名称在窗口加载时有点晚，因此错过了它的调用，所以返回未定义，然后弹出带有名称的警报。我知道ajax就是为了做到这一点。

解决这个问题的最佳方法是什么。

先感谢您。

安德鲁

**编辑**

即使有以下建议，我也无法完成这项工作。

***再次编辑**刚刚看到 bf 新的更新版本如下。也会奏效的。但是我在这个功能上花了一天时间，不敢玩。*

一旦 FB.api 发挥作用，我就无法从它的外部获取值。所以我采取了不同的方法。

我没有使用 ajax，而是使用 PHP 端的查询来获取数据，包括 uid，然后 json 对其进行查询，并将其固定到 (mysql_fetch_array) 数组中，如下所示：

```
 $gc_result = mysql_query($gc_query);
    while ($result = mysql_fetch_array($gc_result)) {
        $jsonURL = "https://graph.facebook.com/" . $result['user_id'] . "/";
        $json = json_decode(file_get_contents($jsonURL), true);
        $result["name"] = $json['name'];

        $data[] = $result;
    }

    echo json_encode($data); 
```

现在我有了它，然后我可以执行以下操作并在 jQuery 中调用它：

```
for(var i = 0; i < len; i++) {
    var pic = '<img src="https://graph.facebook.com/' + result[i].user_id + '/picture?type=small" align="middle" />';
     html = '<p>' + result[i].comment + '<br><hr>Date Added: ' + result[i].date + ' by ' + pic + ' ' + **result[i]['name']** + '<br><hr><hr></p>';
     $('#comms').append(html);  
                        } 
```

这一切都很好，我是一个完全的 jquery 编程和使用 Facebook API 和 JSON 的新手，但即使我坐下来，对这个解决方案印象深刻。在我得意忘形之前，在性能或安全方面是否存在任何潜在缺陷？？？

再次感谢提前。

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:36:28.583

调用`FB.api`可能是异步的（另一个 ajax 请求），因此您必须将其后的代码移动到`FB.api`回调内部：

```
FB.api('/' + result[i].user_id + '?fields=name', function(AuthName) {
    console.log(AuthName);
    alert(AuthName.name);
    authname = AuthName.name;
    html = '<p>' + result[i].comment + '<br><hr>Date Added: ' + result[i].date + ' by ' + pic + ' ' + authname + '<br><hr><hr></p>';
    $('#comms').append(html);
}); 
```

* * *

`for`由于循环，您还存在变量范围问题。解决此问题的方法之一是使用单独的函数来创建回调。在你的块之后添加这个`$(window).load`，之前`</script>`：

```
function createFbApiCallback(jsonResult) {
    return function(AuthName) {
        var authname = AuthName.name;
        var pic = '<img src="https://graph.facebook.com/' + jsonResult.user_id + '/picture&type=small" align="middle" />';
        var html = '<p>' + jsonResult.comment + '<br><hr>Date Added: ' + jsonResult.date + ' by ' + pic + ' ' + authname + '<br><hr><hr></p>';
        $('#comms').append(html);
    }
} 
```

然后将循环更改为：

```
for(var i = 0; i < len; i++) {
    FB.api('/' + result[i].user_id + '?fields=name', createFbApiCallback(result[i])); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:38:13.900

如果您必须在另一个回调函数中执行依赖于回调函数的代码，请在最内部的回调函数中执行您的代码。在您的情况下，将 FB API 回调中的所有内容移到其中，这样您的所有 DOM 操作仅在 AJAX 响应和 FB.api 响应都返回时完成。

# forms - 用于密码验证的表单中的“重复”组

> ID：10558909
> 
> 赞同：0
> 
> 时间：2012-05-11T21:30:55.200
> 
> 标签：forms, symfony

我正在使用“重复”字段来验证表单中的密码。根据文档，“重复”字段组应该呈现两个相同的字段（它正在这样做）并仅在两个字段的值匹配或应该引发验证错误时才提交。第二部分似乎不起作用。我尝试按原样使用示例代码，但是即使密码不匹配，表单也没有问题或错误地提交。有没有其他人遇到过同样的问题，或者我做错了什么？

我没有添加验证文件，也没有使用注释。根据我从文档中了解到的情况，重复字段会自动检查 first_name 和 second_name 字段中的值，并且仅在两个值相等时才提交表单，但它没有这样做。这是我正在使用的代码，

```
->add('password', 'repeated',
            array(
                'type' => 'password',
            )
        ) 
```

这会呈现两个字段“First”和“Second”，并在提交时传递一个包含“First”和“Second”值的数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:12:33.697

事实证明这是我的一个愚蠢的错误。我没有在控制器中验证表单。有一次，我这样做效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T11:03:23.043

正确的语法是

```
 ->add('tmpPassword', 'repeated', array('type' => 'password')); 
```

如果您对字段使用与类型相同的键，则无法正确分配值。

# jquery - Jquery插入unicode而不是符号

> ID：10558911
> 
> 赞同：7
> 
> 时间：2012-05-11T21:31:14.280
> 
> 标签：jquery, unicode, symbols

我正在寻找一种方法来制作一个真正基本的所见即所得，例如当用户舔按钮时，它会插入符号♂（`&#9794;)`

它正在工作，但有两个问题：1 - 只插入 unicode 字符，它们没有转换为符号（`&#9794;)`

2-如果您有时间，是否有一种简单的方法可以将符号插入“文本光标”所在的位置而不是文本区域内容的末尾？

谢谢你的帮助

[http://jsfiddle.net/cdjEr/3/](http://jsfiddle.net/cdjEr/3/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T21:33:28.713

`&#9794;`是一个**HTML**转义码。
它仅在 HTML 源中处理。

Javascript 字符串文字使用自己的转义码：（`'\u2642'`代码点为十六进制而不是十进制）。
您也可以直接使用字符：`'♂'`. （这要求您正确设置文件编码）

# iphone - 在一个 UITextField 中设置文本

> ID：10558916
> 
> 赞同：0
> 
> 时间：2012-05-11T21:31:50.023
> 
> 标签：iphone, objective-c, ios, ipad

我正在制作一个聊天应用程序。当消息到达时，它必须说明是谁发送的。例如，如果我是发件人，那么它应该说

武士：留言

安德烈斯：留言

我希望“Takeshi”和“Andres”的颜色不同，但与消息在同一行，换行，如下所示：

```
Takeshi: some message text, text, text , text
         text, text, text end. 
```

我正在尝试以下操作：

*   计算消息的大小。
*   计算发件人姓名的大小。
*   使用发件人姓名的长度创建字符串“”。

但是“”不是还不够。

我做这个：

```
NSString *from;

if(usr){
    from = [NSString stringWithFormat:@"%@: ", @"Yo"];
}else{
    from = [NSString stringWithFormat:@"%@:  ", [_lbSupportName text]];
}
//This give me one string of n characters of  ' ' character.

NSString *spaces = [ChatView stringWithRepeatCharacter:' ' times:from.length * 2];

NSString *mensaje = [NSString stringWithFormat:@"%@ %@", spaces, msg];

//Calculating the height
CGSize messageSize = [mensaje sizeWithFont:[UIFont fontWithName:DEFAULT_TEXTFONT size:20]
                           constrainedToSize:CGSizeMake(_scvConversation.frame.size.width - 10, FLT_MAX)
                               lineBreakMode:UILineBreakModeWordWrap];

CGSize fromSize = [from sizeWithFont:[UIFont fontWithName:DEFAULT_TEXTFONT size:22]
                   constrainedToSize:CGSizeMake(FLT_MAX, FLT_MAX)
                       lineBreakMode:UILineBreakModeWordWrap];

//Image Background
UIImageView *image = [[UIImageView alloc] initWithFrame:CGRectMake(5, yConversationPosition + 5, _scvConversation.frame.size.width - 10, messageSize.height + 30)];

yConversationPosition += image.frame.size.height + 5;

//Create the Label From
UILabel *lb_From = [[UILabel alloc] initWithFrame:CGRectMake(0, 9, fromSize.width, 30)];
[lb_From setFont:[UIFont fontWithName:DEFAULT_TEXTFONT size:20]];
[lb_From setBackgroundColor:[UIColor clearColor]];
[lb_From setText:from];

//Create the Label Message
UILabel *lb_WriteMessage = [[UILabel alloc] initWithFrame:CGRectMake(5, 5, image.frame.size.width-10, image.frame.size.height - 10)];
[lb_WriteMessage setNumberOfLines:messageSize.height / DEFAULT_TEXTSIZE];
[lb_WriteMessage setFont:[UIFont fontWithName:DEFAULT_TEXTFONT size:20]];
[lb_WriteMessage setText:mensaje];
[lb_WriteMessage setBackgroundColor:[UIColor clearColor]];
[lb_WriteMessage setTextColor:[UIColor colorWithRed:(92/255.0f) green:(98/255.0f) blue:(101/255.0f) alpha:1]];

if(usr){
    [image setImage:[UIImage imageNamed:@"chat-mensajes-yo.png"]];
    [lb_From setTextColor:[UIColor colorWithRed:(230/255.0f) green:(85/255.0f) blue:(84/255.0f) alpha:1]];
}else{
    [image setImage:[UIImage imageNamed:@"chat-mensajes-asesor.png"]];
    [lb_From setTextColor:[UIColor colorWithRed:(28/255.0f) green:(168/255.0f) blue:(175/255.0f) alpha:1]];
}

[lb_WriteMessage addSubview:lb_From];
[image addSubview:lb_WriteMessage];
[_scvConversation addSubview:image];

//Set the contentSize of the scv_Message and scroll to the new Message
[_scvConversation setContentSize:CGSizeMake(0, yConversationPosition)];

if(_scvConversation.contentSize.height > _scvConversation.frame.size.height){
    //Scroll to last Message
    float diference = yConversationPosition - _scvConversation.frame.size.height +5;
    [_scvConversation setContentOffset:CGPointMake(0, diference)];
}

[image release];
[lb_WriteMessage release]; 
```

请帮忙，我做不到。：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:24:33.537

看看 Core Text API。它不是一个简单的工具，但是当您了解它的工作原理时，它会给您带来难以置信的灵活性。这是一个很好的起点： http: [//www.cocoanetics.com/2011/01/befriending-core-text/](http://www.cocoanetics.com/2011/01/befriending-core-text/)

可能稍后您会想要在聊天中使用更复杂的逻辑，例如在消息中突出显示名称，或者其他一些丰富的文本格式。您可以使用核心文本完成所有这些操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:12:24.650

您应该使用两个标签。使用您想要的颜色（1 行标签）为“名称：”创建第一个标签并根据文本计算其宽度，然后创建一个新标签并计算其高度和行数并使用以下方法定位：

```
[lb_WriteMessage setFrame:CGRectMake(lb_From.frame.origin.x + lb_From.frame.size.width + spacer, lb_from.origin.y, messageSize.width, messageSize.height)]; 
```

（其中 spacer 是您想要的标签之间的像素空间数）。

# r - ggplot 2 facet_grid "free_y" 但强制 Y 轴四舍五入到最接近的整数

> ID：10558918
> 
> 赞同：19
> 
> 时间：2012-05-11T21:32:04.293
> 
> 标签：r, ggplot2

使用时：

```
facet_grid(SomeGroup ~, scales="free_y") 
```

是否可以指定尽管您希望刻度是“自由的”，但您希望它们四舍五入到最接近的整数？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-11T23:39:58.753

鉴于`breaks`规模可以采用一个函数，我想你可以将基本的破坏算法包装在一个不允许非整数的函数中。

从一个例子开始：

```
ggplot(mtcars, aes(wt, mpg)) + 
geom_point() + 
facet_grid(am+cyl~., scales="free_y") 
```

![在此处输入图像描述](../Images/1d04b5f94b77ac59e19770d994103879.png)

看看如何`scales::pretty_breaks`组合在一起，制作一个包装它并且只允许整数突破的函数：

```
library("scales")
integer_breaks <- function(n = 5, ...) {
  breaker <- pretty_breaks(n, ...)
  function(x) {
     breaks <- breaker(x)
     breaks[breaks == floor(breaks)]
  }
} 
```

现在使用 this 返回的`breaks`函数作为刻度中的函数

```
ggplot(mtcars, aes(wt, mpg)) + 
geom_point() + 
facet_grid(am+cyl~., scales="free_y") +
scale_y_continuous(breaks = integer_breaks()) 
```

![在此处输入图像描述](../Images/4711108666f5767222baa9e672d0b28a.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-12T08:27:30.780

我可能在这里遗漏了一些东西，但我会做这样的事情。

```
library(ggplot2)
ggplot(mtcars, aes(wt, mpg)) + 
   geom_point() + 
   facet_grid(am+cyl~., scales="free_y", space = "free_y") +
   scale_y_continuous(breaks = seq(0, 40, 2), expand = c(0, 1)) 
```

![在此处输入图像描述](../Images/8bc7b8e38eaf6e7449a2da60633ea867.png)

# facebook-ads-api - 关键字统计的范围是多少？

> ID：10558921
> 
> 赞同：1
> 
> 时间：2012-05-11T21:32:19.257
> 
> 标签：facebook-ads-api, keywordstats

Ads API 关键字统计方法返回的数据的时间范围是多少？它只是过去 7 天的总和吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T00:05:57.820

文档说，这是过去 7 天，不包括当天。

# ruby-on-rails - 差异化的访问控制。最佳实践

> ID：10558922
> 
> 赞同：0
> 
> 时间：2012-05-11T21:32:23.037
> 
> 标签：ruby-on-rails, model-view-controller, access-control

我目前在 Rails 中从事一个爱好项目，偶然发现了一个我认为是 Rails 中的常见问题。我已经阅读了几章和一个 Lynda 教程，但我还没有找到任何解决这个问题的最佳实践。也许在线社区可以帮助我。

在我的 application.html.erb 中，我添加了以下代码：

```
<!DOCTYPE html>
<html> 
<head>
  <title>SioMeny</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
 <body>
  <div id="wrapper">
    <header>
      <h1>SiO Menysystem</h1>
    </header>
    <div id="site_menu">
       <%= render :partial => "shared/admin_menu" if admin_logged_in? %>
       <%= render :partial => "shared/user_menu" if logged_in? %>
       <%= render :partial => "shared/site_menu" %>
    </div><!-- div#site_menu -->
   <div id="main">
      <%= render :partial => "shared/flash", :locals => {:flash => flash} unless flash.nil? %>
      <%= yield %>
    </div>
  </div><!-- div#wrapper -->
</body>
</html> 
```

我的问题始于#site_menu 和不同部分的加载。我在这里尝试实现的是根据用户可能拥有的权限扩展的菜单。登录？和admin_logged_in？位于 application_controller 中。

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  def login_required
    unless logged_in?
     flash[:notice] = "Du må være logget inn for å se denne siden"
     redirect_to :controller => "user", :action => "login"
   end
 end

   def admin_required
   unless admin_logged_in?
     flash[:notice] = "Du må være logget inn som administrator for å se denne siden"
     redirect_to :controller => "user", :action => "login"
   end
 end

  def logged_in? 
    if session[:user_id]
     return true
   end
    return false
 end

  def admin_logged_in? 
   if logged_in?
      user = User.find_by_id[:user_id]
     if user.is_admin?
       return true
     end
   end
   return false
  end

end 
```

此时我收到一个错误：

```
ArgumentError in Site#index

Showing /Users/ola/Documents/Coding/SioMeny/app/views/layouts/application.html.erb where line #15 raised:

wrong number of arguments (0 for 1)
Extracted source (around line #15):

12:       <h1>SiO Menysystem</h1>
13:     </header>
14:     <div id="site_menu">
15:       <%= render :partial => "shared/admin_menu" if admin_logged_in? %>
16:       <%= render :partial => "shared/user_menu" if logged_in? %>
17:       <%= render :partial => "shared/site_menu" %>
18:     </div><!-- div#site_menu -->
Rails.root: /Users/ola/Documents/Coding/SioMeny 
```

非常欢迎任何帮助！我还尝试让两个logged_in函数设置一个实例变量，该变量是在视图中检查的布尔类型，这有效，但并非一直有效，因为它们取决于它们的设置时间。我还尝试在帮助程序中创建类似的方法并从视图中调用它们，但这也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T22:50:58.973

我认为您的问题是 admin_logged_in 中的这一行？

```
user = User.find_by_id[:user_id] 
```

使用 find_by_id 末尾的括号，不会将符号作为参数传入，它只是直接调用 find_by_id 而不带参数。find_by_id 需要一个参数。假设您的参数哈希中有一个 :user_id 可用，您可以这样做：

```
user = User.find_by_id(params[:user_id]) 
```

# jquery - jQuery删除重复元素

> ID：10558923
> 
> 赞同：1
> 
> 时间：2012-05-11T21:32:28.650
> 
> 标签：jquery

如果 dom 生成重复的相同元素怎么办？例如：

```
 <ul id="listitem">
     <li>item1</li>
    </ul>

    <ul id="listitem">
     <li>item1</li>
    </ul>

    <ul id="listitem">
     <li>item1</li>
    </ul>

... 
```

那么这是否可以保留其中一个并删除额外的两个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T21:36:49.690

ID 应该是唯一的，以防万一它由外部代码呈现并且您无法控制它，那么您唯一的选择是遍历所有 ul 并删除重复的 ul。

```
var duplicateChk = {};

$('ul[id]').each (function () {
    if (duplicateChk.hasOwnProperty(this.id)) {
       $(this).remove();
    } else {
       duplicateChk[this.id] = 'true';
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T21:40:06.013

HTML 中的`id`字段必须是唯一的。如果您曾经遇到过应该将其应用于多个元素的情况，那么 a`class`更合适。

```
<ul class="listitem">
  <li>item1</li>
</ul> 
```

假设您切换到类，则可以使用以下代码删除除第一次出现之外的所有内容

```
$('.listitem:gt(0)').remove(); 
```

选择器的`:gt(0)`部分将使其仅匹配索引大于 0 的项目（除第一个元素外的所有项目）

# html - 选中的单选按钮

> ID：10558932
> 
> 赞同：-2
> 
> 时间：2012-05-11T21:33:08.237
> 
> 标签：html, jsp

我正在尝试制作一个 HTML 页面来计算成人和儿童的 BMI

我希望用户选择成人或儿童的计算类型

使用单选按钮，但我不希望它打开一个新页面..如果用户检查任何按钮

当他检查成人单选按钮时，我想要它，输入文本字段出现在两个单选按钮下方..如果我改变主意然后检查儿童单选按钮...出现另一个输入文本字段而不是成人的那些

我不知道我的要求是否明确.. 我希望如此

我希望有人帮助我如何做到这一点

实际上我无法在谷歌中搜索它，因为我不知道我想在那里写什么......非常初学者：D

因此，如果答案是阅读该内容的链接..我会接受^_^

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:36:49.017

你可以用 jQuery 做到这一点。您应该隐藏两个输入字段，如果用户选中单选按钮，则相应的输入会淡入。

```
<div id="formdiv">
    <form>
        <label for="1">Radio 1</label><input type="radio" id="1" name="choose" />
        <label for="2">Radio 2</label><input type="radio" id="2" name="choose" />
        <input type="text" class="1" name="input1" />
        <input type="text" class="2" name="input2" />
    </form>
</div>​​​​​​​​​​​​​​​​​​​​​​​

<script type="text/javascript">
    $("input[name='choose']").change(function() {
        var inputToFadeIn = $(this).attr('id');
        $("input[type='text']:visible").animate({visibility: 'hidden'}, 500);
        $('.' + inputToFadeIn).animate({visibility: 'visible'}, 500);
    });​
</script>

<style type="text/css">
    ​input[type='text']
    {
        visibility:hidden;
    }​​
</style> 
```

现在已经在 J​​SFiddle 上对其进行了测试，但不起作用。有人可以解释一下[http://jsfiddle.net/7eKP6/](http://jsfiddle.net/7eKP6/)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:45:52.260

这是一个[链接](http://api.jquery.com/checked-selector/)，它不会完全解决您的问题，但会让您知道如何去做。

# c++ - 不等待 cin 的 while 循环

> ID：10558934
> 
> 赞同：1
> 
> 时间：2012-05-11T21:33:20.437
> 
> 标签：c++, loops, while-loop

快速提问：为什么这个while循环不等待输入？（ing 是一个字符串）

```
while(ing != "0")

{
    cout << "Ingredient name: ";
    cin >> ing;
    for(int i = 0; i < ing.length(); i++)
    {
        if(ing[i] == ' ')
        ing[i] = '#';
    }
    fil << ing << ':';
    cout << "Quantity: ";
    cin >> quant;
    fil << quant << ':';
} 
```

它只是垃圾邮件“成分名称：数量：成分名称：数量：......”等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:48:45.953

不确定是什么`fil`。

我认为你的问题是你需要`cin.ignore()`在循环底部用 a 刷新流（或者做 a`cin.getline()`来获取你的输入）。否则，输入末尾的换行符（当您按 Enter 提交输入时）将保存为下一个`cin`您的`cin >> ing`. 所以换行符在那里用完了，实际上并没有要求用户输入新的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:59:36.700

我刚刚尝试了这段代码，我没有问题（Visual Studio 2008）。请发布更多您的代码，我会尽力提供帮助。

```
// CinProblem.cpp : Defines the entry point for the console application.
//

#include <stdio.h>
#include <tchar.h>
#include <string>
#include <sstream>
#include <iostream>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    string ing;
    stringstream fil;
    int quant = 0;

    while(ing != "0")
    {
        cout << "Ingredient name: ";
        cin >> ing;
        for(int i = 0; 
            i < (int)ing.length(); 
            i++)
        {
            if(ing[i] == ' ')
            ing[i] = '#';
        }
        fil << ing << ':';
        cout << "Quantity: ";
        cin >> quant;
        fil << quant << ':';
    }

    system("pause");

    return 0;
} 
```

# sorting - 通过计算 MongoDB 中两个列表的交集进行排序

> ID：10558938
> 
> 赞同：0
> 
> 时间：2012-05-11T21:33:36.953
> 
> 标签：sorting, mongodb, mapreduce

我们有一个发帖分析的需求，即对于一个具体的帖子，我们需要返回一个与之关联度最高的帖子列表，逻辑是比较帖子中常见标签的数量。例如：

```
 postA = {"author":"abc",
        "title":"blah blah",
        "tags":["japan","japanese style","england"],
    } 
```

可能还有其他带有以下标签的帖子：

```
postB:["japan", "england"]
postC:["japan"]
postD:["joke"] 
```

所以基本上，postB 得到 2 个计数，postC 在与 postA 中的标签进行比较时得到 1 个计数。postD 得到 0 并且不会包含在结果中。

我现在的理解是使用 map/reduce 来产生结果，我了解 map/reduce 的基本用法，但我无法为这个特定目的找到解决方案。

有什么帮助吗？或者有没有像自定义排序功能这样更好的方法来解决它？我目前正在使用 pymongodb，因为我是 python 开发人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T16:52:50.073

您应该在标签上创建索引：

```
db.posts.ensure_index([('tags', 1)]) 
```

并搜索至少与 postA 共享一个标签的帖子：

```
posts = list(db.posts.find({_id: {$ne: postA['_id']}, 'tags': {'$in': postA['tags']}})) 
```

最后，在 Python 中按交集排序：

```
key = lambda post: len(tag for tag in post['tags'] if tag in postA['tags'])
posts.sort(key=key, reverse=True) 
```

请注意，如果 postA 与大量其他帖子共享至少一个标签，这将不会很好地执行，因为您将从 Mongo 发送大量数据到您的应用程序；不幸的是，没有办法使用 Mongo 本身对交叉点的大小进行排序和限制。

# sharepoint - 自定义沙盒工作流活动问题

> ID：10558941
> 
> 赞同：0
> 
> 时间：2012-05-11T21:33:45.193
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-designer, sharepoint-workflow, sharepoint-api

我有一个自定义的 SharePoint 沙盒工作流活动，我试图将一个可选参数传递给它。但是，ULS 给了我以下异常消息：

> “SendEmailAttachment”类型的“SJW.SPDActivities.SendEmailWithAttachment.SendEmailWithAttachmentActivity”失败。该方法包含一个名为“RecipientCC”的参数，但参数字典不包含此参数的值。

我的猜测是 SPUserCodeWorkflowActionWrapper 正在使用某种反射将参数绑定到我的沙盒工作流方法。但是，因为其中一个在我的 Elements.xml 文件 (RecipientCC) 中被声明为可选，所以它无法找到要绑定的值，因此会引发异常。

知道如何解决这种不稳定的行为吗？我是否必须声明我的所有参数都是强制性的？

我的 Elements.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <WorkflowActions>
    <Action Name="Send an Email with an Attachment"
            SandboxedFunction="true"
            Assembly="$SharePoint.Project.AssemblyFullName$"
            ClassName="SJW.SPDActivities.SendEmailWithAttachment.SendEmailWithAttachmentActivity"
            FunctionName="SendEmailAttachment"
            AppliesTo="all"
            Category="SJW Custom Actions">
      <RuleDesigner Sentence="Email %1 with attachment %2">
        <FieldBind Field="RecipientTo,RecipientCC,Subject,Body" Text="these people" Id="1" DesignerType="Email"/>
        <FieldBind Field="AttachmentListID,AttachmentListItem" Text="file" Id="2" DesignerType="ChooseDoclibItem"/>
      </RuleDesigner>
      <Parameters>
        <Parameter Name="__Context" Type="Microsoft.SharePoint.WorkflowActions.WorkflowContext, Microsoft.SharePoint.WorkflowActions" Direction="In" DesignerType="Hide"/>
        <Parameter Name="RecipientTo" Type="System.Collections.ArrayList, mscorlib" Direction="In"/>
        <Parameter Name="RecipientCC" Type="System.Collections.ArrayList, mscorlib" Direction="Optional"/>
        <Parameter Name="Subject" Type="System.String, mscorlib" Direction="In"/>
        <Parameter Name="Body" Type="System.String, mscorlib" Direction="In"/>
        <Parameter Name="AttachmentListID" Type="System.String, mscorlib" Direction="In"/>
        <Parameter Name="AttachmentListItem" Type="System.Int32, mscorlib" Direction="In"/>
      </Parameters>
    </Action>
  </WorkflowActions>
</Elements> 
```

我的方法声明：

```
public Hashtable SendEmailAttachment(SPUserCodeWorkflowContext context,
                                     ArrayList RecipientTo,
                                     ArrayList RecipientCC,
                                     string Subject,
                                     string Body,
                                     string AttachmentListID,
                                     int AttachmentListItem) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T17:36:45.973

尝试在 Parameter 节点上使用 InitialValue="something"，重新启动 IIS，删除工作流关联并重新添加。然后，在您的代码中，当它作为“某物”出现时，您必须忽略参数值

# cocoa - 在 Mac OS X Lion 的 WebView 中禁用滚动动画？

> ID：10558942
> 
> 赞同：1
> 
> 时间：2012-05-11T21:33:47.490
> 
> 标签：cocoa, animation, webview, scroll, osx-lion

如何禁用在 Mac OS X Lion 中使用箭头键在 WebView 中导航时出现的动画？

我试图改变的行为似乎是 Mac OS X Lion 上 WebViews 的默认行为。如果您将文档加载到 WebView 中，设置插入点，然后使用向上箭头和向下箭头键进行导航，则滚动不是即时的 - 存在动画（视图明显向上或向下滚动）。

这是一个 Xcode 项目，您可以使用它来查看此行为（只需运行应用程序，在文档中设置插入点，然后使用向上箭头和向下箭头键进行导航以使视图滚动）： [http://dl。 dropbox.com/u/78928597/WebViewTest.zip](http://dl.dropbox.com/u/78928597/WebViewTest.zip)

我试图实现的行为是在 Safari 中发生的。如果您在 Safari 中打开`contenteditable`属性设置为的 html 文档`true`，您可以在文档中设置插入点，然后使用向上箭头键和向下箭头键进行导航。当您以这种方式导航时，滚动没有动画效果。视图立即滚动。

这是您可以用来查看此行为的 html 文档：http: [//dl.dropbox.com/u/78928597/WebViewTest.html](http://dl.dropbox.com/u/78928597/WebViewTest.html)

由于 Safari 使用 WebView，并且它会立即滚动，因此似乎应该有一种方法可以更改任何 WebView 的滚动行为，但我没有找到它。

请注意，您需要在使用箭头键导航之前设置插入点，否则您会看到不同的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T17:00:53.350

# php - ORDER BY RAND() 返回重复项

> ID：10558947
> 
> 赞同：1
> 
> 时间：2012-05-11T21:34:16.243
> 
> 标签：php, mysql, sql

我也尝试使用 distinct 并返回重复项。

```
$cubes = mysql_query("SELECT distinct * FROM posts ORDER BY RAND() $limit ") or die(mysql_error()); 
```

我只想拿我的帖子表......并以随机顺序返回它而没有重复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:36:27.597

仅选择您需要的不同 ID，例如

```
SELECT distinct id FROM posts ORDER BY RAND() $limit 
```

`Distinct`适用于您选择的“所有”行，因此如果您（例如）有一个唯一的时间戳字段，那么您很可能会返回每一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:37:40.087

您确定要执行 a`SELECT DISTINCT * FROM ...`而不仅仅是 a`SELECT DISTINCT column_name FROM ...`吗？

有关更多信息，请参阅[SQL DISTINCT STATEMENT 文档](http://www.w3schools.com/sql/sql_distinct.asp)。

# regex - 取消 KeyUP 事件的处理程序？VB.NET

> ID：10558948
> 
> 赞同：1
> 
> 时间：2012-05-11T21:34:20.790
> 
> 标签：regex, windows, vb.net, keyup

有办法在 keyup 事件上使用 e.Cancel () 吗？

我正在尝试使用 Regex 验证文本框，如果它不符合 Regex 表达式，我需要取消该事件，或者删除按下的键以满足表达式

例如：

```
Dim rex As Regex = New Regex("^[0-9]{0,9}(\.[0-9]{0,2})?$")
Private Sub prices_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Textbox1.KeyUp,

        Dim TxtB As TextBox = CType(sender, TextBox)

        If (rex.IsMatch(TxtB.Text) = False ) Then
            e.cancel = true
        End If

    End Sub 
```

**错误：** “取消”不是“System.Windows.Forms.KeyEventArgs”的成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:36:27.413

尝试

```
If (rex.IsMatch(TxtB.Text) = False) Then
  e.SuppressKeyPress = True
End If 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.suppresskeypress.aspx)：

> 您可以在 KeyDown 等事件处理程序中为该属性分配 true 以防止用户输入。
> 
> 将 SuppressKeyPress 设置为 true 也会将 Handled 设置为 true。

由于您正在读取 TextBox.Text 值，因此尚不清楚您要取消什么。 `KeyDown`通常是拦截击键的首选事件。

如果您尝试验证整个字符串，则该`Validating`事件可能更合适。使用 TextBox 控件，您将始终面临有人将剪贴板文本粘贴到控件中的危险，这可能会绕过关键事件。

# c#-4.0 - 从 Windsor 到结构图的重构语句

> ID：10558949
> 
> 赞同：0
> 
> 时间：2012-05-11T21:34:21.543
> 
> 标签：c#-4.0, castle-windsor, structuremap

我有下面的 Windsor 语句并试图将其转换为结构映射语句。我真的找不到任何建议如何去做。

```
Container.Register(AllTypes.FromThisAssembly().
    BasedOn<IType>().If(MatchStatement).Configure(c => c.LifeStyle.Transient.
    Named(c.Implementation.Name))); 
```

有人知道这是如何用结构图编写的吗？

编辑：为了更清楚..我上面的语句（几乎无论如何）是用温莎城堡写的，但是因为我们将使用 Structuremap 而不是我需要做同样的事情，但使用 Structuremap。我得到了它的一部分，但不是全部；

```
 Registry.Scan(x =>
                          {
                              x.TheCallingAssembly();
                              x.AddAllTypesOf<IType>();
                              //{What more?}
                          }); 
```

我还需要满足 MatchStatement 条件并返回命名实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:20:32.100

StructureMap 的默认生命周期是 PerGraph（瞬态和单例的混合）。

以下代码扫描调用程序集并添加所有实现，`IType`并且每个实现都使用实现的名称注册。

```
Scan(scan =>
{
    scan.TheCallingAssembly();
    scan.AddAllTypesOf<IType>().NameBy(type => type.Name);      
}); 
```

# php - 创建以电子邮件地址为标题的 SQL 表

> ID：10558952
> 
> 赞同：-1
> 
> 时间：2012-05-11T21:34:29.133
> 
> 标签：php, mysql, sql, forms

我正在努力使用电子邮件地址作为表名来创建 SQL 表。

我正在使用的代码产生以下错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '@gmail.com(id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), name VARCHAR' 附近使用正确的语法

相关代码是：

```
// create new table for users tosses
    // Make a MySQL Connection
        mysql_connect("localhost", "$sqlusername", "$sqlpassword") or die(mysql_error());
        mysql_select_db("$db_name") or die(mysql_error());

// Create a MySQL table in the selected database
        mysql_query("CREATE TABLE $emailaddress(
        id INT NOT NULL AUTO_INCREMENT, 
        PRIMARY KEY(id),
        name VARCHAR(30), 
        age INT)")
        or die(mysql_error()); 
```

`$emailaddress`当我从不是电子邮件地址的变量（即没有符号）中输入一个值时，它工作得很好`@`，但如果它包含一个`@`符号，它会显示该错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T21:38:34.587

您应该能够通过使用反引号 (`) 转义表名来解决此问题。但实际上，在大多数情况下，这是设计数据库的糟糕方式。

您应该使用一个带有电子邮件地址字段的表，而不是为每个用户/电子邮件地址创建一个新表，除非您有特殊需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:39:00.267

这里的问题是您没有使用反引号。使用反引号可以让您更自由地选择标识符：

```
CREATE TABLE `$emailaddress` ( id INT NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), name VARCHAR(30), age INT) 
```

有关这方面的更多信息，请参见[此处](http://dev.mysql.com/doc/refman/5.5/en/identifiers.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:41:04.420

[http://dev.mysql.com/doc/refman/5.5/en/identifiers.html](http://dev.mysql.com/doc/refman/5.5/en/identifiers.html)

`Permitted characters in quoted identifiers include the full Unicode Basic Multilingual Plane (BMP), except U+0000:`

`ASCII: U+0001 .. U+007F`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T21:48:48.547

如下设计一张表可能对您有利

```
CREATE TABLE emailaddr
(
    id INT NOT NULL AUTO_INCREMENT,
    email varchar(50),
    PRIMARY KEY(id),
    name VARCHAR(30),
    age INT,
    unique key (email)
); 
```

我建议这样做的原因是，如果您必须向表中添加更多字段，您只需更改一个表。使用您正在使用的设计，您将不得不查询一个可能还不存在的表（mysql 会预先为您做一些事情）。如果您添加字段，则必须循环浏览数百个甚至数千个表才能进行所需的更改。

您可以像这样查询电子邮件地址：

```
SELECT * FROM db_name.emailaddr where email = '$emailaddress'; 
```

使用您的设计，您必须首先检查表是否存在

```
SELECT COUNT(1) FROM information_schema.tables
WHERE table_schema = 'db_name' AND table_name = '$emailaddress'; 
```

然后，如果表数为 1，那么您可以

```
SELECT * FROM db_name.`$emailaddress`; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T22:52:22.220

将您的代码更改为：

```
// create new table for users tosses
    // Make a MySQL Connection
        mysql_connect("localhost", "$sqlusername", "$sqlpassword") or die(mysql_error());
        mysql_select_db("$db_name") or die(mysql_error());

// Create a MySQL table in the selected database
        mysql_query("CREATE TABLE `$emailaddress`(
        id INT NOT NULL AUTO_INCREMENT, 
        PRIMARY KEY(id),
        name VARCHAR(30), 
        age INT)")
        or die(mysql_error()); 
```

您需要在变量周围加上反引号“`”。

# xml - 我需要以下 xml 输入的 muenchain 分组代码

> ID：10558953
> 
> 赞同：1
> 
> 时间：2012-05-11T21:34:29.690
> 
> 标签：xml, xslt

我在下面复制了我的输入 xml 以及我想要的输出 xml。您能帮我使用 Meunchain Grouping 获得输出吗？

它必须首先按 RebateInvoiceID 分组，然后 RebateEventID 已显示在下面的所需输出中。

**输入 XML**

```
<EnterpriseDocument InterfaceName="RebateInvoiceAdjustmentImport" ClientID="1000001" ClientName="XXXX" Version="1.0" CreationSource="File" CreationTimestamp="2012-05-11T09:53:16" xmlns:script="script">
  <RawXMLRow RebateInvoiceID="1001878" RebateEventID="1003042" BusinessUnitCode="0402" CategoryID="1000057" PaymentAmount="89"/>
  <RawXMLRow RebateInvoiceID="1001878" RebateEventID="1003042" BusinessUnitCode="0405" CategoryID="1000057" PaymentAmount="94.42"/>
  <RawXMLRow RebateInvoiceID="1001878" RebateEventID="1003043" BusinessUnitCode="0406" CategoryID="1000057" PaymentAmount="147.5"/>
  <RawXMLRow RebateInvoiceID="1001878" RebateEventID="1003048" BusinessUnitCode="0423" CategoryID="1000057" PaymentAmount="97.36"/>
  <RawXMLRow RebateInvoiceID="1001879" RebateEventID="1008042" BusinessUnitCode="0433" CategoryID="1000057" PaymentAmount="89"/>
  <RawXMLRow RebateInvoiceID="1001879" RebateEventID="1008042" BusinessUnitCode="0434" CategoryID="1000057" PaymentAmount="70.24"/>
  <RawXMLRow RebateInvoiceID="1001879" RebateEventID="1008942" BusinessUnitCode="0435" CategoryID="1000057" PaymentAmount="53.08"/>
  <RawXMLRow RebateInvoiceID="1001879" RebateEventID="1008942" BusinessUnitCode="0435" CategoryID="1000057" PaymentAmount="59.4"/>
  <RawXMLRow RebateInvoiceID="1001978" RebateEventID="2003042" BusinessUnitCode="0437" CategoryID="1000057" PaymentAmount="127.85"/>
  <RawXMLRow RebateInvoiceID="1001978" RebateEventID="2003042" BusinessUnitCode="0438" CategoryID="1000057" PaymentAmount="180.04"/>
  <RawXMLRow RebateInvoiceID="1001978" RebateEventID="3003042" BusinessUnitCode="0446" CategoryID="1000057" PaymentAmount="146.61"/>
  <RawXMLRow RebateInvoiceID="1001978" RebateEventID="3003042" BusinessUnitCode="0448" CategoryID="1000057" PaymentAmount="76.56"/>
</EnterpriseDocument> 
```

**所需的输出 XML**

```
<EnterpriseDocument InterfaceName="RebateInvoiceAdjustmentImport" ClientID="1000001" ClientName="XXXX" Version="1.0" CreationSource="File" CreationTimestamp="2012-05-10T16:09:07" xmlns:script="script">
  <RebateInvoice RebateInvoiceID="1001878">
    <RebateProgram RebateEventID="1003042">
      <BusinessUnit BusinessUnitCode="0402">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="89"/>
      </BusinessUnit>
      <BusinessUnit BusinessUnitCode="0405">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="94.42"/>
      </BusinessUnit>
    </RebateProgram>
    <RebateProgram RebateEventID="1003043">
      <BusinessUnit BusinessUnitCode="0406">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="147.5"/>
      </BusinessUnit>
    </RebateProgram>
    <RebateProgram RebateEventID="1003048">
      <BusinessUnit BusinessUnitCode="0423">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="97.36"/>
      </BusinessUnit>
    </RebateProgram>
  </RebateInvoice>
  <RebateInvoice RebateInvoiceID="1001879">
    <RebateProgram RebateEventID="1008042">
      <BusinessUnit BusinessUnitCode="0433">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="89"/>
      </BusinessUnit>
      <BusinessUnit BusinessUnitCode="0434">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="70.24"/>
      </BusinessUnit>
    </RebateProgram>
    <RebateProgram RebateEventID="1008942">
      <BusinessUnit BusinessUnitCode="0435">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="53.08"/>
      </BusinessUnit>
    </RebateProgram>
  </RebateInvoice>
  <RebateInvoice RebateInvoiceID="1001978">
    <RebateProgram RebateEventID="2003042">
      <BusinessUnit BusinessUnitCode="0437">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="127.85"/>
      </BusinessUnit>
      <BusinessUnit BusinessUnitCode="0438">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="180.04"/>
      </BusinessUnit>
    </RebateProgram>
    <RebateProgram RebateEventID="3003042">
      <BusinessUnit BusinessUnitCode="0446">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="146.61"/>
      </BusinessUnit>
      <BusinessUnit BusinessUnitCode="0448">
        <ItemCategoryPayment CategoryID="1000057" PaymentAmount="76.56"/>
      </BusinessUnit>
    </RebateProgram>
  </RebateInvoice>
</EnterpriseDocument> 
```

* * *

谢谢回复。但我仍然收到错误消息，提示我的样式表为空或 XML 格式不正确。让我详细解释一下。我有一个 .js 文件，当我双击 .js 文件时，它将获取该文件夹中的 .csv 并使用 xslt 并给我一个 .xml 输出文件。

```
 /* code for my .js file */ (Please copy this to note pad and save it as             
 InvoiceAdjustment.js) 

showAbsolutePath("InvoiceAdjustment.js");

   function showAbsolutePath(path)
   {
 var fso = new ActiveXObject("Scripting.FileSystemObject");
  var s = "";
  s += fso.GetAbsolutePathName(path);

 var foldername = s.substring(0,s.indexOf(path,0));
 showFolderFileList(foldername);
  }

function showFolderFileList(foldername)
{
 var fso, f, fc, filename;

fso = new ActiveXObject("Scripting.FileSystemObject");
f = fso.GetFolder(foldername);
fc = new Enumerator(f.files);

for (; !fc.atEnd(); fc.moveNext())
{
  filename = "";
  filename += fc.item();

  if (filename.slice(-4) == ".csv")
  {
    convertCSVtoXML(foldername, filename);
  }
 }  

 fso = null;
}

function  convertCSVtoXML(foldername, filename)
{ 
 var objDOMDocument = new ActiveXObject("MSXML2.DOMDocument.4.0"); 
  objDOMDocument.async = false; 

//Create Header
 objDOMDocument.appendChild(XMLHeader(objDOMDocument)); 
 var objXMLDOMNode = objDOMDocument.documentElement.selectSingleNode("//Document"); 

 // Declare XML object -- this makes it easier to pass as a parameter 
 var objXML  = new Object(); 

 // Open the extracted csv from zip file
 var fso = new ActiveXObject("Scripting.FileSystemObject");

 var csvFilename = filename;

  var tso = fso.OpenTextFile(csvFilename, 1); 
  var strInput; 

 // Loop through the file 
 while(!tso.AtEndOfStream)  
 { 
  strInput = tso.ReadLine();

  var vInputLine = strInput.split(","); 
  objXML.a = vInputLine[0];
  objXML.b = vInputLine[1];
  objXML.c = vInputLine[2];
  objXML.d = vInputLine[3];
  objXML.e = vInputLine[4];

  if (objXML.a != 'RebateInvoiceID')
 {
 objXMLDOMNode.appendChild(XMLFileNode(objDOMDocument,objXML));
 }    
 } 
tso.Close();

 // Load Transform file
var TransformXSL = new ActiveXObject("MSXML2.DOMDocument.4.0");
TransformXSL.async = false  
TransformXSL.load(foldername + "\\InvAdj.xsl");

// Load XML file and transform it
var TempStagingDoc = new ActiveXObject("MSXML2.DOMDocument.4.0");
TempStagingDoc.async = false; 
TempStagingDoc.loadXML(objDOMDocument.xml);      
var FinalStr = TempStagingDoc.transformNode(TransformXSL);

// Grab just the file name minus any extension
var fn = filename.substring(0, filename.indexOf(".csv")); 
tmpxml = fn + ".xml";  

// Write out the transformed file. If writing out just the xml file before transform  
//  FSObject.WriteLine(objDOMDocument.xml);     

var FSObject = fso.CreateTextFile(tmpxml, true);
FSObject.WriteLine(FinalStr);
FSObject.Close();

// Clear all objects
objDOMDocument = null; 
fso = null;
TransformXSL = null;
objXML = null;
TempStagingDoc = null;
 }

function XMLHeader(objDOMDocument)
{ 
 var XMLHead;
XMLHead = objDOMDocument.createNode(1, "Document",""); 

var objXMLDOMAttribute = objDOMDocument.createAttribute("Version"); 
objXMLDOMAttribute.text = "1.0";
XMLHead.attributes.setNamedItem(objXMLDOMAttribute);

var objXMLDOMAttribute = objDOMDocument.createAttribute("CreationTimestamp"); 
objXMLDOMAttribute.text = getTimestamp();
XMLHead.attributes.setNamedItem(objXMLDOMAttribute);

return(XMLHead);
} 

function XMLFileNode(objDOMDocument,objXML)
{     
var objXMLDOMNode = objDOMDocument.createNode(1, "RawXMLRow","");

objXMLDOMElement = objDOMDocument.createElement("RebateInvoiceID"); 
objXMLDOMElement.text = objXML.a;
objXMLDOMNode.appendChild(objXMLDOMElement);

objXMLDOMElement = objDOMDocument.createElement("RebateEventID"); 
objXMLDOMElement.text = objXML.b;
objXMLDOMNode.appendChild(objXMLDOMElement);

objXMLDOMElement = objDOMDocument.createElement("BusinessUnitCode");
 function getBusinessUnitCode(){
  var r = String(objXML.c).length;
  if(r == 4)
return String(objXML.c);
if( r == 3)
  return "0"+String(objXML.c);
  if(r == 2){
          return "00"+String(objXML.c);
  }
  else
          return "000"+String(objXML.c);

}
objXMLDOMElement.text = getBusinessUnitCode();
 objXMLDOMNode.appendChild(objXMLDOMElement);

objXMLDOMElement = objDOMDocument.createElement("CategoryID"); 
objXMLDOMElement.text = objXML.d;
objXMLDOMNode.appendChild(objXMLDOMElement);

objXMLDOMElement = objDOMDocument.createElement("PaymentAmount"); 
objXMLDOMElement.text = objXML.e;
objXMLDOMNode.appendChild(objXMLDOMElement);

return(objXMLDOMNode);
}

function getTimestamp()
{
var d = new Date();
var mm = padZeros(d.getMonth()+1);
var dd = padZeros(d.getDate());
var hh = padZeros(d.getHours());
var mn = padZeros(d.getMinutes());
var ss = padZeros(d.getSeconds());

return d.getFullYear()+"-"+ mm +"-"+ dd +"T"+ hh +":"+ mm +":"+ ss;
}

function padZeros(s)
{
if (s < 10)
{
s = "0" + s;
}
return(s);
}

function getDate(stringDate)
{
var a = String(stringDate).split( "/" );
var strXML ;

 strDate = "" ;

 for ( var i = 0 ; i < a.length; i++ )
 {
 if (a[i].length == 1)
     strDate += "0" + a[i];
  else
     strDate += a[i];
  }

 strDate += "" ;

 return strDate;
}

  /* code for xslt */ ( make an xslt using below code and save it as InvAdj.xsl)

 <?xml version="1.0"?>
 <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"  
 xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:script="script" exclude-result-  
 prefixes="msxsl">
 <xsl:output omit-xml-declaration="yes"/>

<!-- ROOT -->
<xsl:template match="/">
<EnterpriseDocument>
  <xsl:attribute name="InterfaceName">RebateInvoiceAdjustmentImport</xsl:attribute>
  <xsl:attribute name="ClientID">
    <xsl:choose>
      <xsl:when test="normalize-space(ClientID)">
        <xsl:value-of select="//Document/RawXMLRow/ClientID"/>
      </xsl:when>
      <xsl:otherwise>1000001</xsl:otherwise>
    </xsl:choose>
  </xsl:attribute>
  <xsl:attribute name="ClientName">XXXX</xsl:attribute>
  <xsl:attribute name="Version">1.0</xsl:attribute>
  <xsl:attribute name="CreationSource">File</xsl:attribute>
  <xsl:attribute name="CreationTimestamp">
    <xsl:value-of select="script:getTimestamp()"/>
  </xsl:attribute>
  <xsl:call-template name="InvAdjData"/>
  </EnterpriseDocument>
  </xsl:template>

  <xsl:template name="InvAdjData">
  <xsl:for-each select="//Document/RawXMLRow[not(RebateInvoiceID=preceding-
   sibling::RawXMLRow/RebateInvoiceID)]">
    <xsl:sort select="RebateInvoiceID"/>
    <RebateInvoice>
      <xsl:attribute name="RebateInvoiceID">
        <xsl:value-of select="RebateInvoiceID"/>
      </xsl:attribute>
      <xsl:variable name="InvoiceID">
        <xsl:value-of select="RebateInvoiceID"/>
      </xsl:variable>
      <xsl:for-each select="//Document/RawXMLRow[not(RebateEventID=preceding-
      sibling::RawXMLRow[RebateInvoiceID=$InvoiceID]/RebateEventID)]">
        <xsl:if test="RebateInvoiceID=$InvoiceID">
          <xsl:variable name="EventID">
            <xsl:value-of select="RebateEventID"/>
          </xsl:variable>
          <RebateProgram>
            <xsl:attribute name="RebateEventID">
              <xsl:value-of select="RebateEventID"/>
            </xsl:attribute>
            <xsl:for-each select="//Document/RawXMLRow[not(BusinessUnitCode=preceding-
     sibling::RawXMLRow[RebateInvoiceID=$InvoiceID and  
     RebateEventID=$EventID]/BusinessUnitCode)]">
              <xsl:if test="RebateInvoiceID=$InvoiceID and RebateEventID=$EventID">
                <xsl:variable name="BUCode">
                  <xsl:value-of select="BusinessUnitCode" />
                </xsl:variable>
                <BusinessUnit>
                  <xsl:attribute name="BusinessUnitCode">
                  <xsl:value-of select="BusinessUnitCode"/>
                </xsl:attribute>

                  <xsl:for-each select="//Document/RawXMLRow[not(CategoryID=preceding-
    sibling::RawXMLRow[RebateInvoiceID=$InvoiceID and RebateEventID=$EventID and 
    BusinessUnitCode=$BUCode]/CategoryID)]">
                    <xsl:if test="RebateInvoiceID=$InvoiceID and RebateEventID=$EventID 
    and BusinessUnitCode=$BUCode">
                      <ItemCategoryPayment>

                        <xsl:attribute name="CategoryID">
                          <xsl:value-of select="CategoryID"/>
                        </xsl:attribute>
                        <xsl:attribute name="PaymentAmount">
                          <xsl:value-of select="PaymentAmount"/>
                        </xsl:attribute>
                      </ItemCategoryPayment>
                    </xsl:if>
                  </xsl:for-each>
                </BusinessUnit >
                </xsl:if>

            </xsl:for-each>

          </RebateProgram >
        </xsl:if>
      </xsl:for-each>
     </RebateInvoice >
     </xsl:for-each>

     </xsl:template>

     <!-- BEGIN JSCRIPT HELPER CODE, KEEP THIS SECTION AS SMALL AS POSSIBLE IT'S A 
     PERFORMANCE HOG -->
    <msxsl:script language="JScript" implements-prefix="script">
     <![CDATA[

   function getTimestamp()
   {
    var d = new Date();
    var m, dy, hr, mn, se;

   if (d.getMonth()+1 < 10)
   {
    m = "0"+(d.getMonth()+1);
       }
   else if (d.getMonth()+1 > 9)
   {
   m = d.getMonth()+1;
     }

   if (d.getDate() < 10)
     {
      dy = "0"+(d.getDate());
     }
   else if (d.getDate() > 9)
   {
   dy = d.getDate();
    }

    if (d.getHours() < 10)
   {
   hr = "0"+(d.getHours());
   }
  else if (d.getHours() > 9)
   {
   hr = d.getHours();
   }

  if (d.getMinutes() < 10)
  {
  mn = "0"+(d.getMinutes());
  }
  else if (d.getMinutes() > 9)
   {
    mn = d.getMinutes();
    }

   if (d.getSeconds() < 10)
    {
     se = "0"+(d.getSeconds());
    }
  else if (d.getSeconds() > 9)
    {
     se = d.getSeconds();
    }

   return d.getFullYear()+"-"+ m +"-"+ dy +"T"+ hr +":"+ mn +":"+ se;
    }

   ]]>
   </msxsl:script>

  Now copy this records into an excel sheet and save it as .csv 

  RebateInvoiceID   RebateEventID   BusinessUnitCode    CategoryID  PaymentAmount
  1001878   1003042 402 1000057 89
  1001878   1003042 405 1000057 94.42
  1001878   1003043 406 1000057 147.5
  1001878   1003048 423 1000057 97.36
  1001879   1008042 433 1000057 89
  1001879   1008042 434 1000057 70.24
  1001879   1008942 435 1000057 53.08
  1001978   2003042 437 1000057 127.85
  1001978   2003042 438 1000057 180.04
  1001978   3003042 446 1000057 146.61
  1001978   3003042 448 1000057 76.56 
```

现在将 .csv 输入文件和 .js 文件以及 xslt 放在一个文件夹中，然后双击 .js 文件，它将生成一个 .xml 文件。

现在我需要在 xslt 代码中使用 muenchain 分组方法获得相同的结果。你能帮我吗。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T13:08:04.183

这是一个样式表示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="1.0">

  <xsl:output indent="yes"/>

  <xsl:key name="k1" match="RawXMLRow" use="@RebateInvoiceID"/>
  <xsl:key name="k2" match="RawXMLRow" use="concat(@RebateInvoiceID, '|', @RebateEventID)"/>

  <xsl:template match="EnterpriseDocument">
    <xsl:copy>
      <xsl:copy-of select="@*"/>
      <xsl:apply-templates select="RawXMLRow[generate-id() = generate-id(key('k1', @RebateInvoiceID)[1])]"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="RawXMLRow">
    <RebateInvoice RebateInvoiceID="{@RebateInvoiceID}">
      <xsl:apply-templates select="key('k1', @RebateInvoiceID)[generate-id() = generate-id(key('k2', concat(@RebateInvoiceID, '|', @RebateEventID))[1])]" mode="evt"/>
    </RebateInvoice>
  </xsl:template>

  <xsl:template match="RawXMLRow" mode="evt">
    <RebateProgram RebateEventID="{@RebateEventID}">
      <xsl:apply-templates select="key('k2', concat(@RebateInvoiceID, '|', @RebateEventID))" mode="bus"/>
    </RebateProgram>
  </xsl:template>

  <xsl:template match="RawXMLRow" mode="bus">
    <BusinessUnit BusinessUnitCode="{@BusinessUnitCode}">
      <ItemCategoryPayment CategoryID="{@CategoryID}" PaymentAmount="{@CategoryID}"/>
    </BusinessUnit>
  </xsl:template>    

</xsl:stylesheet> 
```

# computer-vision - 使用卡尔曼滤波器对手部跟踪数据进行在线平滑

> ID：10558956
> 
> 赞同：5
> 
> 时间：2012-05-11T21:34:44.540
> 
> 标签：computer-vision, tracking, smoothing, kalman-filter

我将 Kinect 与 OpenNI/NITE 一起使用。OpenNI 可以在 NITE 的帮助下跟踪人手。此外，OpenNI 可以平滑跟踪的手线，我试图弄清楚它是如何做到的。

我尝试使用卡尔曼滤波器，用卡尔曼估计的手部位置替换旧的手部位置，但 OpenNI 中的平滑度仍然要好得多。

我将不胜感激有关如何平滑在线数据或如何在卡尔曼滤波器中设置参数的任何线索（特定于手部跟踪的东西，因为我已经知道参数的作用）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T07:36:11.327

使用卡尔曼滤波器并不像看起来那么容易。你需要选择一个好的运动模型、一个好的状态向量和一个好的测量模型。对于您的问题，我猜您是对位置进行 3d 跟踪，而不是方向（屏幕上手的 x、y 和 z 位置），我会选择以下内容：

```
State vector =[x, y, z, v_x, v_y, v_z]

Update equations: (x,y,z) = (x,y,z)+ (v_x,v_y,v_z)*delta(t)
velocity would be constant 
```

您还需要正确设置误差的协方差，因为这会将选择速度的误差建模为常数（这是不正确的）。

检查这篇[论文](http://www.cs.unc.edu/~tracker/media/pdf/SIGGRAPH2001_CoursePack_08.pdf)。查看滤波器预测和更新方程所需的雅可比矩阵。它们很重要。如果您认为它们是同一性的，则过滤器将起作用，但只有在您正确选择雅可比 W（乘以 Q）、H 和 A 时，它才会准确地起作用。Q 和 R 是对角线，请尝试给出实验值。

希望这有帮助，祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-26T22:16:05.797

[这里](http://www.morethantechnical.com/2011/06/17/simple-kalman-filter-for-tracking-using-opencv-2-2-w-code/)有一个简单的例子，展示了如何设置卡尔曼滤波器的参数。

这个例子代表了一种直观地测试不同平滑输出的简单方法。检查评论还帮助我了解了不同的参数（噪声、运动模型、初始化等）。

希望它有所帮助，它工作得很好，而且代码很容易理解。

它使用 opencv 实现。

希望能帮助到你！

# javascript - Javascript原型继承问题

> ID：10558957
> 
> 赞同：0
> 
> 时间：2012-05-11T21:34:56.133
> 
> 标签：javascript

我遇到了原型继承问题，我不知道为什么它不能正常工作。

片段是这样的：

```
function Field(newKey, val) {
    this.key = newKey || "";
    this.value = val || "";
}

Field.prototype.isEmpty = function() {
    return this.value === undefined || this.value === null || this.value === "";
};

function DoubleField(newKey, val) {
    this.base = Field;
    this.base(newKey, val);
}
DoubleField.prototype = new Field();
DoubleField.prototype.constructor = DoubleField;

function IntegerField(newKey, val) {
    this.base = DoubleField;
    this.base(newKey, val);
}
IntegerField.prototype = new DoubleField();
IntegerField.prototype.constructor = IntegerField;

var f = new Field('keyfield', 'valField');
var d = new DoubleField('keydouble', 'valDouble');
var i = new IntegerField('keyinteger');

var res = f.isEmtpy(); 
```

对 f.isEmpty 的调用失败了？为什么？对 d.isEmpty 或 i.isEmpty 的调用可以正常工作。

我无法意识到我做错了什么。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T21:40:11.177

错误在代码的最后一行：

```
var res = f.isEmtpy();//That's what you wrote 
```

正确的是：

```
var res = f.isEmpty(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:43:44.363

你还没有说它*是如何*失败的。正如我在评论中指出的那样，至少有一个错字：`var res = f.isEmtpy();`应该是`var res = f.isEmpty();`

但除此之外（我认为这只是*问题*中的错字，而不是代码），请注意派生构造函数中的这一行：

```
this.base = DoubleField; 
```

...不会按您的意愿工作。考虑 的情况`IntegerField`。你打电话`new IntegerField`，它设置`this.base`并`DoubleField`调用它。但`DoubleField`构造函数随后设置`this.base`为`Field`. 所以你有一个属性指向的`IntegerField`实例，而不是。`base``Field``DoubleField`

您不能使用实例属性来跟踪沿袭。它适用于父/子情况，但您会遇到上述“孙子”问题。

我建议使用其中的继承帮助程序脚本之一。有好几个，包括我自己的[`Lineage`](http://code.google.com/p/lineagejs/)。这些脚本帮助您构建继承层次结构，为您处理管道，以便您可以专注于构建您正在尝试构建的任何内容。我们只是暂时需要它们；JavaScript 将在下一个版本中获得[语法糖来帮助解决这个](http://wiki.ecmascript.org/doku.php?id=harmony%3aclasses)问题（当然，一旦它真正完成，我们还需要几年的时间才能看到对它的广泛支持）。

# jquery - 区分相同的类名

> ID：10558959
> 
> 赞同：1
> 
> 时间：2012-05-11T21:35:17.167
> 
> 标签：jquery

有两个部分 div 部分具有相同的类，并且具有相同的 ul 和 li 和 a。我有 jquery 点击事件。单击链接时，两个 jquery click 事件都会被触发。但我不希望两者都被解雇，只有一个被解雇。我如何做到这一点。这是我拥有的dom结构。

```
<div class = "a">
<ul>  
<li><a href="www.google.com">google</a></li></ul></div>

<div class ="a">
<ul>
<li><a href="www.yahoo.com>yahoo</a></li></ul></div> 
```

href 可能会改变，所以我不能以此为基础选择我的选择器。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:38:29.487

只有一个被解雇了，你只是误解了正在发生的事情。尝试这个：

```
$("div.a a").click(function(e){
    e.preventDefault();
    alert(this.href);
}); 
```

发布您的代码，我们也许可以帮助您修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:52:56.200

您可以使用正确的 href 属性定位一个：

```
$('a[href^="wwww.google"]').on('click', function(e) {
   e.preventDefault();
   alert('This is not the Google you are looking for...');
}); 
```

如果 href 发生变化，您将无法区分它们，没有 ID、类或结构差异，因此唯一的选择是检查它们在 DOM 中的索引：

```
$('.a > ul > li > a').on('click', function(e) {
    e.preventDefault();
    var A = $(this).closest('.a').index();
    if (A==3) {
        alert("this is the one I'm lookin for");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:38:51.453

您可以使用 first() 方法触发第一个和 last() 触发最后一个。除此之外，您可能必须实现唯一 ID 或应用另一个类：

```
http://api.jquery.com/first-selector/

http://api.jquery.com/last-selector/ 
```

使用另一个类：

```
<div class = "a google">  
<ul>    
<li><a href="www.google.com">google</a></li></ul></div>  

<div class ="a yahoo">  
<ul>  
<li><a href="www.yahoo.com>yahoo</a></li></ul></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-03T11:03:47.247

你可以试试这个

```
$(function(){ $('.a').click(function(){ var a = $(this).val(); alert(a); }); }); 
```

# python - Heroku 上的 IPython 笔记本

> ID：10558960
> 
> 赞同：6
> 
> 时间：2012-05-11T21:35:45.070
> 
> 标签：python, heroku, ipython

有没有人体验过在 Heroku 上部署 IPython 笔记本。我没有找到任何有关此的信息。

有人可以解释一下如何在 Heroku 上设置这样的笔记本吗？谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T13:46:58.727

请参阅[http://nbviewer.ipython.org/](http://nbviewer.ipython.org/)，它托管在 heroku 上：

```
$ host nbviewer.ipython.org
nbviewer.ipython.org is an alias for nbviewer.herokuapp.com.
nbviewer.herokuapp.com has address 107.22.226.64 
```

您甚至可以在那里访问自己的笔记本。参见例如这个 NumPy 教程： http: [//nbviewer.ipython.org/2847673/](http://nbviewer.ipython.org/2847673/)

当然，非常酷的 XKCD 绘图库：[http ://nbviewer.ipython.org/url/jakevdp.github.com/downloads/notebooks/XKCD_plots.ipynb](http://nbviewer.ipython.org/url/jakevdp.github.com/downloads/notebooks/XKCD_plots.ipynb)

# android - 在同一应用程序中在 android 中使用超过 1 个谷歌地图

> ID：10558961
> 
> 赞同：1
> 
> 时间：2012-05-11T21:35:48.897
> 
> 标签：android, google-maps, mobile

在我的应用程序中，我使用了 2 个地图，每个地图都有不同的用途，当我运行我的应用程序时效果很好，当我运行第一个地图（a）时它运行正确，当我运行第二个地图（b）时它运行正确也是，但问题是如果我想再次回到第一个（a），它会显示另一个地图（b）！两张地图现在显示相同的东西！！

注意：地图执行的顺序无关紧要，因为只要我运行 map(b) ，map(a) 每次都会显示 map(b) ！map(a) 只有在我运行 map(b) 之前才能正确显示！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:00:45.337

是的，这有点奇怪。解决方案。

让第二个地图的第二个活动使用不同的进程名称。[http://developer.android.com/guide/topics/manifest/activity-element.html#proc](http://developer.android.com/guide/topics/manifest/activity-element.html#proc)

```
<activity
  android:name=".Activity1">
</activity>

<activity
  android:name=".Activity2"
  android:process=":Map2">
</activity> 
```

将`:`进程定义为您想要的应用程序私有。（除非您希望其他应用程序可能使用该过程）。

一个缺点？这将为您的应用使用更多资源。想想你是否真的需要两个地图实例？

如果只是一个静态地图视图，在地图中显示一个图钉。考虑类似谷歌地图静态请求。[https://developers.google.com/maps/documentation/staticmaps/](https://developers.google.com/maps/documentation/staticmaps/)

问候，克里斯

# python - 如何动态更改 SQLAlchemy 声明性模型上的列类型？

> ID：10558965
> 
> 赞同：6
> 
> 时间：2012-05-11T21:35:58.427
> 
> 标签：python, sqlalchemy

我在生产中运行 mysql，但想在内存数据库中的 sqlite 中运行一个简单的测试。

旧版 mysql 数据库的表具有 mysql 特定类型的列，这些列在声明性模型中声明（子类化 declarative_base）。我想在不使用 mysql 的情况下运行一些简单的测试，因此需要交换模型的列。

我该怎么做呢？我已经尝试编写一个补丁程序/取消补丁程序来换出我模型中的**表**，但是当我运行一些测试时，我得到了

```
OperationalError: (OperationalError) near ")": syntax error u'\nCREATE TABLE my_table (\n)\n\n' () 
```

这使我认为我没有正确修补列。

有谁知道我该怎么做？我究竟做错了什么？

目前，我创建新列并将全新的 Table 对象附加到`__table__`旧表并保存。

数据库已创建，create_all() 已创建，并且 convert_columns 在 setUp 中运行。drop_all() 和 revert_columns 在我的测试中的 tearDown 期间运行

```
mysql_sqlite_mapping = {INTEGER: Integer,
                        MEDIUMINT: Integer,
                        TEXT: text}    

def convert_columns(self, my_class, mapping):
    for column in my_class.__table__.columns:
        if type(column.type) in mapping:
            replacement_col = Column(column.name,
                                     mapping[type(column.type)],
                                     primary_key=column.primary_key,
                                     nullable=column.nullable,
                                     key=column.key,
                                     unique=column.unique)

            converted_columns.append(replacement_col)

    self.registry[my_class] = my_class.__table__

    my_class.__table__.metadata.remove(my_class.__table__)
    my_class.__table__ = Table(my_class.__table__.name,
                               my_class.__table__.metadata)

    for column in converted_columns:
        my_class.__table__.append_column(column)

    return my_class

def revert_columns(self, my_class):
    saved_table = self.registry[my_class]

    metadata = my_class.__table__.metadata
    my_class.__table__.metadata.remove(my_class.__table__)

    model_class.__table__ = Table(saved_table.name,
                                  metadata)

    for column in saved_table.columns:
        column.table = None
        my_class.__table__.append_column(column)

    self.registry.pop(my_class) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T10:13:30.957

我希望下面的内容可以帮助您*更好*地处理这些修改。但是您的错误很奇怪，因为它在`CREATE TABLE`子句中没有列，所以我认为这不是您问题的直接答案/解决方案。

无论如何，与其完全替换表和列，不如尝试使用[自定义 SQL 构造和编译扩展/特定方言的编译规则](http://docs.sqlalchemy.org/en/rel_0_7/core/compiler.html#dialect-specific-compilation-rules)。请参阅应该为 sqlite 生成正确 SQL 语句而不更改表定义的示例代码：

```
from sqlalchemy.ext.compiler import compiles
from sqlalchemy.dialects.mysql import MEDIUMINT, INTEGER, TEXT

@compiles(MEDIUMINT, 'sqlite')
def compile_MEDIUMINT(element, compiler, **kw):
    """ Handles mysql MEDIUMINT datatype as Integer in sqlite.  """
    return compiler.visit_integer(element, **kw)

@compiles(INTEGER, 'sqlite')
def compile_INTEGER(element, compiler, **kw):
    """ Handles mysql INTEGER datatype as Integer in sqlite.  """
    return compiler.visit_integer(element, **kw)

@compiles(TEXT, 'sqlite')
def compile_TEXT(element, compiler, **kw):
    """ Handles mysql TEXT datatype as text in sqlite.  """
    return compiler.visit_text(element, **kw) 
```

# hibernate - Tomcat 中的 Hibernate 和 EJB3.1 - 需要什么才能使这成为可能？

> ID：10558966
> 
> 赞同：2
> 
> 时间：2012-05-11T21:36:00.777
> 
> 标签：hibernate, jakarta-ee, tomcat, jpa, ejb

我有三个一般的 JavaEE + Tomcat 问题：

1.  根据这个链接（[Using Hibernate with Tomcat](https://community.jboss.org/wiki/UsingHibernateWithTomcat)）在Tomcat中运行Hibernate是可能的（尽管Tomcat不支持JPA）。有谁知道我是否会遇到此配置的问题（Tomcat 上的休眠）？

2.  我可以做一些类似的事情来在 Tomcat 中获得 EJB3.1 支持吗？例如，通过将正确的文件放入标准 Tomcat7 容器（不是 TomEE）中，我是否可以运行 EJB3.1 `WEB-INF/lib`？`WEB-INF/classes`如果是，推荐哪些 EJB3.1 提供程序？

3.  通常，只要将适当的库和配置文件放在`WEB-INF/lib`和中，是否可以从 Tomcat 中运行任何 JavaEE 技术`WEB-INF/classes`？或者，是否只能运行 Tomcat 支持接口的技术？

提前感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T22:07:29.083

1.  没问题 - 这很常见。
2.  是的。例如[OpenEJB](http://en.wikipedia.org/wiki/Apache_OpenEJB)是 TomEE 的前身。根据[下载页面](http://openejb.apache.org/downloads.html)（如下）。
3.  不。

> 插入式战争。
> 
> 可以放入任何 Tomcat 7.x 安装的 Apache OpenEJB 版本，有效地创建您自己的 Apache TomEE Web Profile 或 Apache TomEE Plus。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T18:48:16.990

Java EE 中的许多东西都可以添加到 Tomcat 中。TomEE 就是活生生的证明。TomEE 所做的主要是您也可以做的。

将 JPA（Hibernate）和 JTA 事务管理器（Atomikos、JoTM 等）添加到 Tomcat 是非常典型的。列表中的下一个是 JSF（Mojarra 或 MyFaces）和 CDI（焊接）。也可以添加 JAX-RS（Jersey、RestEasy）。

最后，您可能会问自己，只是安装 TomEE 或 GlassFish 是否更容易......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:39:55.260

1.  您不会遇到问题，但是您必须自己处理事务和会话处理，除非您使用 Spring 等。

2.  不。

3.  不。

Tomcat 是一个 servlet 和 JSP 容器，而不是一个全栈 Java EE 容器。Java EE 容器必须支持 EAR 文件，而 Tomcat 只部署 WAR 文件。将库填充到 WAR 文件中不会使其成为 EAR 文件。

# android - 选择要在 Android 中打开链接的应用程序

> ID：10558967
> 
> 赞同：0
> 
> 时间：2012-05-11T21:36:07.923
> 
> 标签：android

我想编写一个应用程序，允许我从手机远程开始在我的桌面上下载种子文件。如何更改 android 以使用我的应用打开磁力链接？我正在尝试找到一个非浏览器特定的解决方案，可以在安装时执行，而无需用户进行设置。

编辑：

像这样的东西？

```
 <intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.BROWSABLE" />
    <category android:name="android.intent.category.DEFAULT" />
    <data android:scheme="magnet" />
    <data android:host="*" />
    <data android:mimeType="application/myApp" />
  </intent-filter> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:03:36.403

> 我正在尝试找到一个非浏览器特定的解决方案，可以在安装时执行，而无需用户进行设置。

我不太确定我理解你到底想用链接做什么。但我可以告诉你，它可能不会在任何库存设备上按照你想要的方式工作。系统中没有任何机制可以让您的应用程序在安装后立即开始执行任何操作。至少用户将不得不选择使用您的应用程序来处理您尝试覆盖的任何链接。

# wordpress - 仅从 Wordpress 中的特定组获取类别名称

> ID：10558968
> 
> 赞同：0
> 
> 时间：2012-05-11T21:36:15.773
> 
> 标签：wordpress, categories

我是 wordpress 的新手，有一个关于显示帖子类别名称的快速问题。我有两个主要类别

游戏

*   游离细胞
*   纸牌
*   经典游戏

    ——乒乓

    - 小姐。吃豆人

特色游戏

等等。这样我就可以发布帖子并标记它来自哪个游戏（注意这里有三层）。如果我的帖子是 ms 的屏幕截图。pacman，我会选择 Games > Classic Games > Ms. Pacman 类别。我可能还想在我的主页特色滑块中看到这张很棒的图片，所以我也可能会选择特色游戏。

然而！！！当我进入帖子详细信息页面时，我只想吐出 CATEGORY：Ms. Pacman。我不想要游戏/经典游戏或特色游戏。

所以现在，我有

```
<?php the_category(', ', 'single');?> 
```

仅显示子元素，但仍显示所有三个级别以及特色类别。我想我需要从查询中排除“特色类别”ID，但不知道如何。这是我的具体代码：

```
<?php if ( have_posts() ):?>
  <?php while ( have_posts() ) : the_post();?>
    <div class="category">CATEGORY: <?php the_category(', ', 'single');?></div>
  <?php endwhile;?>    
<?php endif;?> 
```

我不知道如何进行自定义查询或更改什么或更改它的位置。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:20:35.750

似乎没有任何过滤器可以轻松生成您要查找的内容，但是应该可以使用 get_the_category_list 的源代码将某些内容放在一起，您可以在此处找到：[http://core.trac.wordpress。 org/browser/tags/3.3.2/wp-includes/category-template.php#L0](http://core.trac.wordpress.org/browser/tags/3.3.2/wp-includes/category-template.php#L0)

像这样，随意更改标记：

```
$categories = get_the_category( false );
foreach( $categories as $category ) {
    echo '<a href="' . get_category_link( $category->term_id ) . '">' . $category->name . '</a>';
} 
```

# google-maps - Google Maps API 中 infoWindow 的显示不正确

> ID：10558972
> 
> 赞同：2
> 
> 时间：2012-05-11T21:36:34.213
> 
> 标签：google-maps, google-maps-api-3, infowindow

有人可以帮助我吗？

我在 Google Maps API 中显示 infoWindow 时遇到问题 - 背景阴影未正确显示。阴影的透明度不起作用。

[您可以在网页上看到问题][1]（点击圆圈中的红色小A表示问题）

代码在这里：

```
var geocoder;
var map;
function initialize() {  
var pinkParksStyles = [
{
featureType: "all",
stylers: [
{ saturation: -80 }
]
},
{
featureType: "landscape.man_made",
stylers: [
{ hue: "#ed1c26" },
{ saturation: 100 },
{ gamma: 0.2 }
]
}
];   

var pinkMapType = new google.maps.StyledMapType(pinkParksStyles,
{name: "Architektonická mapa"});

geocoder = new google.maps.Geocoder();
var latlng = new google.maps.LatLng(49.830896,15.331421);

var myOptions = {
  zoom: 7,
  center: latlng,
  mapTypeControlOptions: {
mapTypeIds: [google.maps.MapTypeId.ROADMAP, "pink_parks"]
  }
}

map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

var hvezdo = new google.maps.LatLng(49.872623,14.769359);

map.mapTypes.set("pink_parks", pinkMapType);
map.setMapTypeId("pink_parks");

var image = "http://www.cka2011.cz/archbook/wp-content/plugins/Ada_archmapa/icon-arch.png";

var hvezdo = new google.maps.LatLng(49.872623,14.769359);

  var marker = new google.maps.Marker({
  position: hvezdo,
  map: map,
  title:"matomas.cz",
  icon: image, 
});

var contentString = "<div id=content>"+
"<div id= siteNotice >"+
"</div>"+
"<h2 id= firstHeading  class= firstHeading >Uluru</h2>"+
"<div id= bodyContent >"+
"<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large " +
"sandstone rock formation in the southern part of the "+
"Northern Territory, central Australia. It lies 335 km (208 mi) "+
"south west of the nearest large town, Alice Springs; 450 km "+
"(280 mi) by road. Kata Tjuta and Uluru are the two major "+
"features of the Uluru - Kata Tjuta National Park. Uluru is "+
"sacred to the Pitjantjatjara and Yankunytjatjara, the "+
"Aboriginal people of the area. It has many springs, waterholes, "+
"rock caves and ancient paintings. Uluru is listed as a World "+
"Heritage Site.</p>"+
"<p>Attribution: Uluru, <a href= http://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194 >"+
"http://en.wikipedia.org/w/index.php?title=Uluru</a> (last visited June 22, 2009).</p>"+
"</div>"+
"</div>";

var infobox = new google.maps.InfoWindow({
content: contentString
 });

google.maps.event.addListener(marker, "click", function() {

infobox.open(map,marker);
});
}

function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { "address": address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);
    map.setZoom(14);
    var marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location
    });
  } else {
    alert("Geocode was not successful for the following reason: " + status);
  }
  });
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T22:17:33.460

您的 CSS 干扰了地图：

```
.entry img, img.thumbnail {
    background-color: #FFFFFF; 
```

您需要关闭地图图像的背景颜色：

```
#map_canvas img {
    background-color: transparent;
    } 
```

`datetime is undefined`（您的页面每秒也会出现一个错误。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:20:59.047

您的样式表正在影响信息窗口呈现。

[此样式表](http://www.cka2011.cz/archbook/wp-content/themes/spectrum/style.css)的第 285 行：

`.entry img, img.thumbnail { padding: 5px; background:#FFF; }`

级联并影响所有元素，包括信息窗口。建议您使样式表更具体，以免影响所有子 img 元素。

# android - Android：跨活动传递 Facebook 会话

> ID：10558973
> 
> 赞同：3
> 
> 时间：2012-05-11T21:36:46.380
> 
> 标签：android, facebook

我正在寻找跨活动传递 Facebook 会话。我从 Facebook 的 SDK 中看到了这个例子，有人提到“简单”的例子有办法做到这一点：`https://github.com/facebook/facebook-android-sdk/blob/master/examples/simple/src/com/facebook/android/SessionStore.java`

但这是如何工作的？在我的`MainActivity`，我有这个：

```
mPrefs = getPreferences(MODE_PRIVATE);
String accessToken = mPrefs.getString("access_token", null);
long expires = mPrefs.getLong("access_expires", 0);
if (accessToken != null) {
    //We have a valid session! Yay!
    facebook.setAccessToken(accessToken);
}
if (expires != 0) {
    //Since we're not expired, we can set the expiration time.
    facebook.setAccessExpires(expires);
}

//Are we good to go? If not, call the authentication menu.
if (!facebook.isSessionValid()) {
    facebook.authorize(this, new String[] { "email", "publish_stream" }, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {
        }

        @Override
        public void onFacebookError(FacebookError error) {
        }

        @Override
        public void onError(DialogError e) {
        }

        @Override
        public void onCancel() {
        }
    });
} 
```

但是我如何将它传递给我的`PhotoActivity`活动？有没有实施的例子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T04:12:33.570

使用 SharedPreferences 跨活动传递数据并不是一个好主意。SharedPreferences 用于在应用程序重新启动或设备重新启动时将一些数据存储到内存中。

相反，您有两个选择：

1.  声明一个静态变量来保存 facebook 会话，这是最简单的方法，但我不建议使用静态字段，因为没有其他方法。

2.  创建一个实现 parcelable 的类，并在那里设置你的 facebook 对象，查看一个 parcelable 实现，如下所示：

    ```
    // simple class that just has one member property as an example
    public class MyParcelable implements Parcelable {
        private int mData;

        /* everything below here is for implementing Parcelable */

        // 99.9% of the time you can just ignore this
        public int describeContents() {
            return 0;
        }

        // write your object's data to the passed-in Parcel
        public void writeToParcel(Parcel out, int flags) {
            out.writeInt(mData);
        }

        // this is used to regenerate your object. All Parcelables must have a CREATOR that implements these two methods
        public static final Parcelable.Creator<MyParcelable> CREATOR = new Parcelable.Creator<MyParcelable>() {
            public MyParcelable createFromParcel(Parcel in) {
                return new MyParcelable(in);
            }

            public MyParcelable[] newArray(int size) {
                return new MyParcelable[size];
            }
        };

        // example constructor that takes a Parcel and gives you an object populated with it's values
        private MyParcelable(Parcel in) {
            mData = in.readInt();
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-04T17:05:47.450

对于 FB SDK 3.5，在我的 FB 登录活动中，我通过 Intent Extras 传递活动会话对象，因为 Session 类实现了可序列化：

```
private void onSessionStateChange(Session session, SessionState state, Exception exception) {
    if (exception instanceof FacebookOperationCanceledException || exception instanceof FacebookAuthorizationException) {
        new AlertDialog.Builder(this).setTitle(R.string.cancelled).setMessage(R.string.permission_not_granted).setPositiveButton(R.string.ok, null).show();

    } else {

        Session session = Session.getActiveSession();

        if ((session != null && session.isOpened())) {
            // Kill login activity and go back to main
            finish();
            Intent intent = new Intent(getApplicationContext(), MainActivity.class);
            intent.putExtra("fb_session", session);
            startActivity(intent);
        }
    }
} 
```

从我的 MainActivity onCreate() 中，我检查额外的意图并启动会话：

```
Bundle extras = getIntent().getExtras();
if (extras != null) {           
    Session.setActiveSession((Session) extras.getSerializable("fb_session"));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T22:08:42.287

该示例几乎具有整个实现。你只是`SharedPreferences`用来存储你的会话。当您在 PhotoActivity 中需要它时，只需`SharedPreferences`再次查看（如果您遵循相同的模式，可能通过您的`SessionStore`静态方法）以获取您之前存储的 Facebook 会话。

# windows - powershell：get-psdrive 和 where-object

> ID：10558977
> 
> 赞同：1
> 
> 时间：2012-05-11T21:37:10.127
> 
> 标签：windows, powershell, logic

我试图在 Windows 2008 服务器上查找不是“C、E、L、S、T、W”的每个驱动器号。谁能告诉我我的逻辑错误或我该怎么做？

```
[char[]]”CELSTW” | Where-Object {!(Get-PSDrive $_ )} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:47:57.217

您从不需要的驱动器号列表 (CELSTW) 开始，并将不存在的驱动器号作为 psdrive 输出。

你想要的是从所有 PSDrives 的列表开始，然后在它们与你不想要的匹配的地方过滤掉它们：

```
Get-PSDrive | Where-Object { [char[]]"CELSTW" -notcontains $_.Name } 
```

尽管这将为您提供许多其他 PSDrive 类型。您可能还想为 FileSystem 提供程序过滤它：

```
 Get-PSDrive | Where-Object { [char[]]"CELSTW" -notcontains $_.Name -AND $_.Provider.Name -eq "FileSystem"} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:45:13.503

这应该为您提供名称（驱动器号）不是“C、E、L、S、T、W”的所有 psdrive

```
Get-PSDrive  | ?{[char[]]"CELSTW" -notcontains $_.name} 
```

但是，如果您想排除非文件系统 psdrive，请尝试以下操作：

```
Get-PSDrive  | ?{[char[]]"CELSTW" -notcontains $_.name} | ?{$_.Provider.name -eq "FileSystem"} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:44:52.557

你必须从另一端开始：

```
$drives = [char[]]"CD"
Get-PSDrive | ? { $drives -notcontains $_.Name} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T09:07:30.437

Another example using the -notmatch operator:

```
Get-PSDrive | Where-Object { $_.Name -notmatch '[CELSTW]'} 
```

# javascript - 一种形式的两种动作取决于哪个按钮？

> ID：10558981
> 
> 赞同：1
> 
> 时间：2012-05-11T21:37:37.537
> 
> 标签：javascript, jquery, forms

我有两个文件，`preview.php`&`save.php`

```
<form id="create-template" class="form" action="" method="post">
    <p class="_50">
        <label for="t-name">Template name</label>
        <input type="text" name="t-name" class="required"/>
    </p>
    <p class="_100">
        <label for="t-html">Template HTML</label>
        <textarea id="t-html" name="t-html" class="required" rows="10" cols="40"></textarea>
    </p>
    <div class="clear"></div>

    <div class="block-actions">
        <ul class="actions-left">
            <li><a class="button red" id="reset-template" href="javascript:void(0);">Clear</a></li>
        </ul>
        <ul class="actions-right">
            <li><div id="preview"><input type="submit" class="button" value="Preview template" onclick="return false;"></div></li>
            <li><input type="submit" class="button" value="Create template"></li>
        </ul>
    </div>
</form> 
```

当前的JS：

```
$("#preview").click(function() {
    $.post('preview.php', {body:$('#t-html').val().replace(/\n/g,'<br />'), function (result) {
        //maybe use .ajax instead? 
        //open preview.php in new window
    });
}); 
```

如何使用相同的表单但根据按下的按钮有两种不同的操作？

`Preview template`=> `preview.php`=>`opens to a new tab`

`Create template`=> `save.php`=>`posts on same page`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:45:33.093

您可以为按钮设置一个 click 事件处理程序，并相互附加同时的 ajax 调用。

您可以使用 javascript 在新选项卡中打开窗口。

```
window.open(<url>) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T00:53:56.303

尝试根据单击的按钮设置表单的“目标”属性。

将您的表单更改为以下内容：

```
<form id="create-template" class="form" action="" method="post" target="_blank">
    <p class="_50">
        <label for="t-name">Template name</label>
        <input type="text" name="t-name" class="required"/>
    </p>
    <p class="_100">
        <label for="t-html">Template HTML</label>
        <textarea id="t-html" name="t-html" class="required" rows="10" cols="40"></textarea>
    </p>
    <div class="clear"></div>

    <div class="block-actions">
        <ul class="actions-left">
            <li><a class="button red" id="reset-template" href="javascript:void(0);">Clear</a></li>
        </ul>
        <ul class="actions-right">
            <li><input id="preview-form" type="submit" class="button" value="Preview template" /></li>
            <li><input type="submit" id="submit-form" class="button" value="Create template" /></li>
        </ul>
    </div>
</form>​ 
```

并添加这个 JavaScript：

```
$('#preview-form').click(function(ev) {
    $('#create-template').attr('action', 'preview.php');    
    $('#create-template').attr('target', '_blank');
});

$('#submit-form').click(function(ev) {
    $('#create-template').attr('action', 'submit.php');
    $('#create-template').attr('target', '');
});
​ 
```

我还没有在所有浏览器上测试过这个，所以你可能想这样做。

# python - python用函数替换打印

> ID：10558986
> 
> 赞同：6
> 
> 时间：2012-05-11T21:38:26.683
> 
> 标签：python

我正在使用 python 2.6 并且在我的长程序中有一堆打印语句。如何用我的自定义打印函数替换它们，我们称之为 scribble()。因为如果我只是搜索并将 print 替换为 scribble( 没有结束的双引号。我认为正则表达式就是这样，但我已经用它们进行了一天左右的实验，我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-10-22T09:29:55.410

**使用 Pycharm**

如果您使用的是 pycharm，则可以通过以下模式使用 Regex 函数：

```
Replace: print\s(.*)
With: print($1) 
```

[![在此处输入图像描述](../Images/9c6560c3f79548f4bb8193b5839e6b8b.png)](https://i.stack.imgur.com/jaOAd.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-11T21:42:32.323

**使用编辑器**

我不知道您使用的是哪个编辑器，但如果它支持 RegEx 搜索和替换，您可以尝试以下操作：

```
Replace: print "(.*?)"
With: scribble( "\1" ) 
```

我在记事本++中对此进行了测试。

**使用 Python**

或者，您可以使用 Python 本身来完成：

```
import re

f = open( "code.py", "r" )
newsrc = re.sub( "print \"(.*?)\"", "scribble( \"\\1\" )", f.read() )
f.close()

f = open( "newcode.py", "w" )
f.write( newsrc )
f.close() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T22:07:51.133

实际上，您可以使用[附带的](http://docs.python.org/library/2to3.html)[工具](http://docs.python.org/library/2to3.html)`print`将所有语句转换为`print()`函数。虽然此工具通常用于将 Python 2 程序尽可能完整地转换为 Python 3 程序，但它实际上是一些小修复程序的集合，您可以选择运行哪些修复程序。在您的情况下，您可以通过在调用时提供参数来仅运行修复程序。[`2to3`](http://docs.python.org/library/2to3.html)`print``-f print``2to3`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T21:59:12.013

您可以重载打印功能，而不是替换它！

在 python 2.x 中，这是不可能的。但是有一些工具可以将 python 2.x 转换为 python 3 代码。

通过转换器运行您的代码，然后重载打印功能。

**低于 2.6 的 python 版本仍然通过使用 from future**支持打印函数（因此重载）。因此，一旦被隐藏，您的代码仍应适用于旧版本。**虽然如果不使用 3.x 似乎大多数都在使用 2.7 所以你将来**可能不需要

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T21:41:38.877

如果您还没有使用真正的 IDE，这是一个可以帮助您的地方。使用像 PyCharm 或 Eclipse 这样的 IDE，您可以使用重构来用不同的调用替换对特定函数的所有调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-27T17:07:46.240

这是一个 Emacs 实现，默认情况下，它将打印语句转换为打印函数，并可选择将任何语句更改为任何函数。我试图清楚地记录它，但如果有任何不清楚的地方，请告诉我。

OP 可以与 . 交互`M-x my-statement-to-function RET scribble RET`或以编程方式使用它`(my-statement-to-function "print" "scribble")`。

```
(defun my-statement-to-function (&optional statement func)
  "Convert STATEMENT to FUNC.

For use with statements in Python such as 'print'.  Converts
statements like,

  print \"Hello, world!\"

to a function like,

  print(\"Hello, world\")

Also works generally so that the STATEMENT can be changed to any
FUNC.  For instance, a 'print' statement,

  print \"Hello, world!\"

could be changed to a function,

  banana(\"Hello, world!\")

Default STATEMENT is 'print'.  Default FUNC is
STATEMENT (e.g. 'print').  Prompt for STATEMENT and FUNC when
called with universal prefix, `C-u'."
  (interactive "p")
  (let* ((arg statement)  ; statement argument overwritten, so preserve value
     ;; only prompt on universal prefix; 1 means no universal, 4 means universal
     (statement (cond ((eql arg 1) "print")  ; no prefix
                      ((eql arg 4) (read-string "Statement (print): " "" nil "print")))) ; C-u
     (func (cond ((eql arg 1) statement)  ; no prefix
                 ((eql arg 4) (read-string (concat "Function " "(" statement "): ") "" nil statement)))) ; C-u
     ;; [[:space:]]*  -- allow 0 or more spaces
     ;; \\(\"\\|\'\\) -- match single or double quotes
     ;; \\(\\)        -- define capture group for statement expression; recalled with \\2
     (regexp (concat statement "[[:space:]]*\\(\"\\|\'\\)\\(.*?\\)\\(\"\\|'\\)"))
     ;; replace statement with function and place statement expression within parentheses \(\)
     (replace (concat func "\(\"\\2\"\)")))
    (goto-char (point-min))
  (while (re-search-forward regexp nil t)
    (replace-match replace)))) 
```**

# c# - 使用 RSS SyndicationFeed api 渲染 pubDate

> ID：10558989
> 
> 赞同：2
> 
> 时间：2012-05-11T21:38:34.977
> 
> 标签：c#, asp.net-mvc, rss, syndicationfeed

我正在尝试从我的 ASP.net MVC 站点提供 RSS 提要。pubdate 元素的一切正常。我似乎无法让 Rss20FeedFormatter 输出它。我认为它映射到 SyndicationFeed 对象上的 LastUpdatedDate 属性，但输出为 LastBuildDate。

有谁知道我如何使用 SyndicationFeed 和 Rss20FeedFormatter 在我的 RssFeed 中呈现 pubDate 节点？

```
 public class RssActionResult : ActionResult
    {
        public SyndicationFeed Feed { get; set; }
        public override void ExecuteResult(ControllerContext context)
        {
            context.HttpContext.Response.ContentType = "application/rss+xml";
            var rssFormatter = new Rss20FeedFormatter(Feed, false);
            using (var writer = XmlWriter.Create(context.HttpContext.Response.Output, new XmlWriterSettings{ Indent = true}))
                rssFormatter.WriteTo(writer);
        }
    } 
```

我如何创建提要的示例。

```
new SyndicationFeed("Title", "Description", url, "test_id", publishDate, feedItems){ LastUpdatedTime = publishDate} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T08:51:36.370

似乎对象模型目前仅在项目上支持 pubDate，而不是在提要/频道上。您可以将其添加为 ElementExtension：

```
feed.ElementExtensions.Add("pubDate", "", DateTime.UtcNow.ToString("r")); 
```

您只需要注意正确格式化日期，请看这里：[RFC-1123 的 DateTime 给出了不准确的时区](https://stackoverflow.com/questions/2249889/datetime-to-rfc-1123-gives-inaccurate-timezone)

# maven - jenkins 通过参数传递 scm 标签值

> ID：10558990
> 
> 赞同：8
> 
> 时间：2012-05-11T21:38:37.833
> 
> 标签：maven, hudson, jenkins

可以给Jenkins传scm的参数值吗？

在我的 pom.xml 中，我将值设置为默认值：

```
<scm>
     <connection> scm:svn:https://172.10.10.30/svn/repPortal/branches/2012/Branch_A/ </ connection>
     <developerConnection>scm:svn:https://172.10.10.30/svn/repPortal/branches/2012/Branch_A/</developerConnection>
</ scm> 
```

问题是当我使用另一个分支运行并希望通过 jenkins 运行发布时（在发布过程中，它会生成项目的标签）它总是会得到 pom.xml 中定义的值。

我会在 Jenkins 的特定参数中传递一个新路径，该参数将自动在 scm pom 项目中设置。

我通过在参数化建筑物中设置字符串参数进行了一些测试，但他没有识别给定的参数和构造错误。

另一种方法是通过“发布目标和选项”：

```
-X -Dresume=false release:clean release:prepare release:perform \
    -DscmConnection="scm:svn:https://172.10.10.30/svn/repPortal/branches/2012/Branch_B"-DscmDeveloperConnection = "scm: svn: https :/ / 172.10.10.30/svn/repPortal/branches/2012/Branch_B "scm: validate 
```

错误仍然存​​在...

```
Caused by: org.apache.maven.shared.release.ReleaseFailureException:
    Missing required setting: scm connection or developerConnection must be specified. 
```

有没有办法让詹金斯告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:43:02.767

我注意到为 SCM 连接定义的属性不正确。在命令行上设置 SCM 连接的属性是`-Dproject.scm.connection`，开发者连接是`-Dproject.scm.developerConnection`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-25T12:26:14.603

根据[MRELEASE-707](https://issues.apache.org/jira/browse/MRELEASE-707)属性`connection`和`developerConnection`是只读的，不能直接设置。您必须为 url 定义自己的属性并将其用作占位符（请参阅：[如何在命令行中覆盖 maven 属性？](https://stackoverflow.com/q/13876165/1384681)）。

# python - 从包导入时模块抛出名称错误

> ID：10558991
> 
> 赞同：1
> 
> 时间：2012-05-11T21:38:44.203
> 
> 标签：python, web2py, python-module

我正在尝试将包含单行的模块：`import logging`, 导入到我的 web2py 项目中。当我尝试从名为 的包中导入模块时`mymodules`，我得到一个`<type 'exceptions.NameError'> name 'logging' is not defined error`，但是当我将模块从包中取出并直接导入时，它工作正常。

我的模块.py：

```
import logging 
```

从顶级模块目录导入它：
`import mymodule`- 工作正常

从包中导入：
`from mymodules import mymodule`- 获取名称错误

包没有问题 - 我在那里有其他模块，我可以毫无问题地导入。不知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:29:53.807

导入 mymodule 后，您必须引用`mymodule.logging`而不仅仅是`logging`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T02:27:52.823

首先，您不需要在`.py`导入语句中添加文件扩展名。所以应该是：

```
import mymodule
mymodule.logging.info("Just some info") 
```

不过 Anthony 是正确的，如果您希望能够从那里使用日志记录，则必须通过调用它。`mymodule.logging`您也可以使用通配符导入，但您只需要注意随后在 mymodule 中导入的内容。

```
from mymodule import *
#now you can use logging directly
logging.info("Just some info") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T13:28:15.897

发生这种情况是因为一些旧的 .pyc 文件仍在包中 - 它们一定是导致错误的日志记录引用。一旦我清除它们，我的问题就解决了。:S

# svn - 应用补丁不会创建具有“添加”状态的文件

> ID：10558993
> 
> 赞同：1
> 
> 时间：2012-05-11T21:38:55.567
> 
> 标签：svn, versioning, patch

我通常在项目中处理大量代码，并且不时必须将我的数据备份到补丁：

```
svn diff > /backups/assignment-XX_diff-YY.patch 
```

然后我恢复并更新我的本地工作副本：

```
svn revert -R . && svn up 
```

然后我开始处理我的其他任务，当它被提交时，我在本地清理并恢复，然后从我之前所做的工作中重新应用我的补丁：

```
svn revert -R .
svn up
patch -p0 < /backups/assignment-XX_diff-YY.patch 
```

我注意到的一件事是，当我创建一个新文件时，然后添加该文件，例如：

```
touch newFile.cpp
svn add newFile.cpp 
```

新添加的文件及其内容在我创建的补丁中，并且在我应用补丁时会重新创建文件，但是在我应用补丁时不会自动设置“已添加”状态。这导致我应用了一个准备好提交的补丁，但只有“修改”的文件被提交，而不是“添加的”文件。此外，“新”文件（如果它们已经存在）现在将整个补丁附加到 EOF，从而破坏它们。

因此，总而言之：当将补丁应用于我的本地工作副本时，是否可以`patch`自动对新/添加的文件发出命令？`svn add`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T11:25:45.223

是的，可以使用 svn 1.7 new command `svn patch`。

运行`svn patch /backups/assignment-XX_diff-YY.patch`而不是`patch -p0 < /backups/assignment-XX_diff-YY.patch`. 来自[Apache Subversion 1.7 发行说明](http://subversion.apache.org/docs/release-notes/1.7.html#patch)：

> svn patch 将像第三方补丁工具一样将 unidiff 更改应用于现有文件。它还将新创建的文件添加到版本控制中，并删除修补后留空的文件和目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-15T03:52:11.643

要在补丁中包含新添加的文件，我们可以使用 --show-copies-as-adds 选项

svn diff --show-copies-as-adds > TARGET_PATCH_FILE

# ruby-on-rails - 是否有某种方法或简单的方法可以返回仅包含给定键的哈希？

> ID：10558996
> 
> 赞同：0
> 
> 时间：2012-05-11T21:39:17.620
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, methods

我正在使用 Ruby on Rails 3.2.2，我正在寻找一种与[`except`](http://apidock.com/rails/v3.2.1/Hash/except)散列（[`except`文档](http://apidock.com/rails/v3.2.1/Hash/except)）相反的方法，可能是一种`only`方法。是否有某种方法或简单的方法可以返回*仅*包含给定键的哈希？

```
# Example, 'only' method as opposite to the 'except'
@person.update_attributes(params[:person].only(:name, :surname)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:50:29.647

我认为您正在寻找的是[`slice`](http://api.rubyonrails.org/classes/Hash.html#method-i-slice)，它将返回仅包含给定键的哈希。

# coq - 偶数归纳假设

> ID：10558997
> 
> 赞同：4
> 
> 时间：2012-05-11T21:39:26.817
> 
> 标签：coq, induction

我正在尝试编写一个专门用于证明**偶数**属性的归纳假设。我制定并证明了以下内容：

```
Theorem ind_hyp_on_evens:
forall (p : nat -> Prop), 
(p 0 -> (forall n, p n -> p (S (S n))) -> 
forall n, p (n + n)). 
Proof.
intros p P0 P1.
intro n.
assert(p (n + n) /\ p (S (S (n + n)))). 
induction n as [| n'].  
split. unfold plus. assumption.
unfold plus. 
apply (P1 0).
assumption.
destruct IHn' as [A B]. 
split. 
rewrite <- plus_Snm_nSm.
rewrite -> ? plus_Sn_m.
assumption. 
rewrite <- plus_Snm_nSm.
rewrite -> ? plus_Sn_m.
apply (P1 (S (S (n' + n')))).
assumption. 
destruct H as [H1 H2].
assumption. Qed. 
```

尽管它已被证明，但任何使用它的尝试都会导致错误消息：“错误：不是正确数量的归纳参数。”

有人可以告诉我归纳假设有什么问题，或者如何应用它？

谢谢，

迈耶

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:53:11.360

我相信`induction`假设将使用的任何归纳原理都具有固定形式

```
forall ... (P : SomeType -> Type) ..., (* or ->Set or ->Prop *)
   ... ->
   forall (v : SomeType), P v 
```

您的`ind_hyp_on_evens`匹配项`P (plus n n)`似乎令人困惑`induction`。

如果您有合适的目标，例如`forall n, is_even (n+n)`，您可以手动执行`induction`通常执行的步骤并将其扩展以处理特殊形式。

```
intro n0;                            (* temp. var *)
pattern (n0 + n0);                   (* restructure as (fun x => (is_even x)) (n0+n0) *)
refine (ind_hyp_on_evens _ _ _ n0);  (* apply ind. scheme *)
clear n0; [| intros n IHn ].         (* clear temp., do one 'intros' per branch *) 
```

我不知道是否可以将其打包为任何归纳方案的通用辅助策略，但是将这些步骤打包为每个方案的`Ltac`策略应该可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T04:54:58.303

您可以考虑编写一个描述偶数的归纳谓词（代码未经测试）：

```
Inductive even : nat -> Prop :=
| evenO : even O
| evenSSn : forall n, even n -> even (S (S n))
. 
```

Coq 会自动生成归纳原理。`even n`在能够对 n 的“均匀性”进行归纳之前，您必须证明这一点成立。

# sql-server - 这个更新会完成我想要的吗？

> ID：10558998
> 
> 赞同：0
> 
> 时间：2012-05-11T21:39:27.627
> 
> 标签：sql-server

对于那些 SQL 人员来说，这可能是一个非常简单的问题。

我有一个临时表 (TMP_VALIDATION_DATA)，其中存储了我希望在生产表 (PROVIDER_SERVICE) 中更新的某些字段的旧值和新值，以及需要更新的 PROVIDER_SERVICE 记录的 uuid。

我想要完成的是，在伪代码中：

```
For every prov_svc_uuid uuid in TMP_VALIDATION_DATA table
  Set PROVIDER_SERVICE_RATE.END_DATE = NewPvSvcEndDate
  Where [uuid in temp table] = [uuid in PROVIDER_SERVICE table] 
end for 
```

这个更新声明会完成我需要的吗？

```
update PROVIDER_SERVICE
set END_DATE = (
  select NewPvSvcEndDate 
  from TMP_VALIDATION_DATA T
  where T.PROVIDER_SERVICE_UUID = PROVIDER_SERVICE.PROVIDER_SERVICE_UUID 
) 
```

如果我的更新不正确，请您提供更正吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:45:09.287

您的查询将更新所有记录，如果您的子查询中有多个记录，您可能会收到错误消息。我还将您的语法更改为`JOIN`类似于下面的语法。

```
update P
set END_DATE = T.NewPvSvcEndDate
FROM PROVIDER_SERVICE P
JOIN TMP_VALIDATION_DATA T
   ON P.PROVIDER_SERVICE_UUID = T.PROVIDER_SERVICE_UUID 
```

如果您不想`UPDATE`所有记录，则添加一个`WHERE`子句。

我的建议是，如果您不知道 中将包含多少条记录`UPDATE`，请先编写您的查询`SELECT`，然后将其更改为`UPDATE`. 所以对于这个：

```
SELECT P.END_DATE, T.NewPvSvcEndDate
FROM PROVIDER_SERVICE P
JOIN TMP_VALIDATION_DATA T
   ON P.PROVIDER_SERVICE_UUID = T.PROVIDER_SERVICE_UUID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:42:21.857

这将更新所有记录，或者出错（不确定当您尝试更新具有多个值的列时会发生什么）。