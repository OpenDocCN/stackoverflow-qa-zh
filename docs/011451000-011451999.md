# StackOverflow 问答 11451000-11451999

# c# - 当我自定义绘制字符串时，为什么我的文本没有正确对齐？

> ID：11451001
> 
> 赞同：2
> 
> 时间：2012-07-12T11:37:41.687
> 
> 标签：c#, .net, winforms, graphics, user-controls

我正在尝试在自定义控件中绘制右对齐文本，但是，由于某种原因，它似乎与我的目标水平位置不对齐，并且字符串之间存在差异。

我可以接受它与我的目标水平位置不完全匹配的事实，但字符串之间的差异在视觉上很糟糕！

任何指针？

![在此处输入图像描述](../Images/5bf52c6e9ca49c9b32fee01508750752.png)

隔离代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace RightAlignTest {
    class RightControlTest : UserControl {
        public RightControlTest() {
            this.SetStyle(ControlStyles.UserPaint, true);
            this.SetStyle(ControlStyles.ResizeRedraw, true);
        }

        public static void DrawString(Graphics g, string s, Font f, RectangleF r, Color c) {
            float locx = r.Left;
            float locy = r.Top;
            SizeF txts = g.MeasureString(s, f);
            locx = (locx + r.Width - txts.Width);
            g.DrawString(s, f, new SolidBrush(c), locx, locy);
        }

        protected override void OnPaint(PaintEventArgs e) {
            base.OnPaint(e);
            int rightTarget = Width - 20;
            Font f = new Font("Arial Unicode MS", 13f, FontStyle.Regular);
            int i = 0;
            string[] strings = { "Current Limit 1:", "Current Limit 2:", "Temperature Center 1:", "Temperature Center 2:" };
            foreach (var s in strings) {
                Rectangle r1 = new Rectangle(0, 30 * i++, rightTarget, Height);
                DrawString(e.Graphics, s, f, r1, Color.Black);
            }
            e.Graphics.DrawLine(new Pen(new SolidBrush(Color.Blue)), rightTarget, 0, rightTarget, Height);
        }
    }
    public partial class Form1 : Form {
        public Form1() {
            RightControlTest t = new RightControlTest();
            t.Dock = DockStyle.Fill;
            Controls.Add(t);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:48:20.677

试试这是否有效：

```
public static void DrawString(
    Graphics g, string s, Font f, 
    RectangleF r, Color c) 
{
    StringFormat stringFormat = new StringFormat();
    stringFormat.Alignment = StringAlignment.Far;
    stringFormat.LineAlignment = StringAlignment.Center; // Not necessary here
    g.DrawString(s, f, new SolidBrush(c), r, stringFormat);
} 
```

使用`StringFormat`取自[http://msdn.microsoft.com/en-us/library/332kzs7c.aspx的示例](http://msdn.microsoft.com/en-us/library/332kzs7c.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-27T19:52:34.433

使用`StringFormat.SetTabStop(int,float[])`，像这样：

```
private void PrintPage_Print(object sender, PrintPageEventArgs e)
    {
        using (Font f = new Font("Segoe UI", 10f, FontStyle.Regular, GraphicsUnit.Point))
        {
            using (Brush b = new SolidBrush(Color.Black))
            {
                using (Graphics g = e.Graphics)
                {
                    float y = 5;
                    string headLine = "Article\tUnit\tNet\tGross";
                    Pen pen = new Pen(b);
                    SizeF measure = g.MeasureString(headLine, f);                        
                    StringFormat format = new StringFormat();

                    float[] tabs = new float[] { 200, 100, 55, 55};
                    Rectangle rect = new Rectangle(5, (int)y, (int)(tabs.Sum()+5), (int)measure.Height);
                    format.SetTabStops(0, tabs);

                    g.DrawString(headLine, f, b, rect, format);
                    g.DrawRectangle(pen, rect);
                    y += rect.Height + 3f;
                    format.LineAlignment = StringAlignment.Far;
                    foreach (var product in Bill.ListPositions())
                    {
                        measure = g.MeasureString(product.PositionString, f);
                        rect = new Rectangle(5, (int)y, (int)(tabs.Sum()+5), (int)measure.Height);
                        g.DrawString(product.PositionString, f, b, rect, format);
                        y += measure.Height + 2f;
                    }
                    g.DrawLine(pen, new Point(0, (int)y), new Point((int)(tabs.Sum()), (int)y));

                    tabs = new float[] { 300, 110 };
                    format.LineAlignment = StringAlignment.Near;
                    format.SetTabStops(0, tabs);
                    foreach (var line in DrawTotalSummaryLines())
                    {
                        measure = g.MeasureString(line, f);
                        rect = new Rectangle(5, (int)y, (int)(tabs.Sum()+5), (int)measure.Height);                            
                        g.DrawString(line, f, b, rect, format);
                        y += measure.Height + 2f;
                        if (line.Contains("Gross:") ||line.Contains("CHANGE:"))
                        {
                            g.DrawLine(pen, new Point(0, (int)y), new Point((int)(tabs.Sum()), (int)y));
                            y += measure.Height + 2f;
                        }
                    }
                    g.Dispose();
                    pen.Dispose();
                }
                b.Dispose();
            }
            f.Dispose();
        } 
```

结果应如下所示：

[![结果图片](../Images/ce90721dcc4d362c4c7101b6cbb327c9.png)](https://i.stack.imgur.com/56x0Y.png)

# javascript - Socket io，我从哪里获得需要提供给客户的 socket.io.js？

> ID：11451004
> 
> 赞同：-1
> 
> 时间：2012-07-12T11:37:47.750
> 
> 标签：javascript, node.js, socket.io

> **可能重复：**
> [找不到socket.io.js](https://stackoverflow.com/questions/8689877/cant-find-socket-io-js)

那么在使用 socket.io 时，您需要包含客户端使用

```
<script type="text/javascript" src="socket.io/socket.io.js"></script> 
```

但是我在哪里可以找到我需要为客户端放入 /socket.io/ 文件夹的“socket.io.js”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:41:53.023

[https://github.com/LearnBoost/socket.io-client](https://github.com/LearnBoost/socket.io-client) - 有关提供 socket.io 客户端 js 文件的最佳实践的更多信息，请参见：[https ://github.com/LearnBoost/Socket.IO/ wiki/我如何为客户服务](https://github.com/LearnBoost/Socket.IO/wiki/How-do-I-serve-the-client)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-12T11:41:48.093

socket.io.js 文件由服务器生成并提供，因此无需自己提供。

如果您使用的是 jQuery，则可以使用以下代码段来获取文件

```
$.getScript('http://localhost:1337/socket.io/socket.io.js', function(){
    //You can now use the io namespace
}); 
```

我自己也在为此苦苦挣扎，并早些时候在 SO 上发布了一个关于它的[问题。](https://stackoverflow.com/questions/8540358/including-socket-io-js-results-in-undefined-require)

# boolean - 布尔代数辅助

> ID：11451009
> 
> 赞同：-2
> 
> 时间：2012-07-12T11:38:04.797
> 
> 标签：boolean

我很困惑。这是一样的吗？

```
!A && !B = !(A && B)? 
```

或者是`= !(A || B)`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:47:29.370

创建一个[真值表](http://en.wikipedia.org/wiki/Truth_table)并亲自查看

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T11:48:35.723

!A && !B = !(A || B)

这是“[德摩根定律](https://en.wikipedia.org/wiki/De_Morgan%27s_laws)”之一。
根据经验，我喜欢用我曾经读过的一句话来记住德摩根定律：“做你讨厌*或*觉得困难的事；这是一个坚强的人的标志。软弱的人只会做他们喜欢做的事，*并且*觉得容易。” （强调我的）。这是德摩根定律在现实生活中的应用。

一般来说，你可以通过创建一个真值表来找出这些东西。

# sql-server - SQL Server 中的触发器——它们是什么？

> ID：11451011
> 
> 赞同：-4
> 
> 时间：2012-07-12T11:38:15.180
> 
> 标签：sql-server, sql-server-2005, triggers

我用过 SQL Server 2005。但是我没有用过触发器，请有人帮我告诉我什么是触发器？

触发器的类型，如何在 SQL Server 2005 中使用？

使用触发器有什么优点和缺点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:44:36.180

触发器是在数据库中发生某些事情时自动执行的过程。

来自[维基百科](http://en.wikipedia.org/wiki/Database_trigger)：

> 数据库触发器是响应数据库中特定表或视图上的某些事件而自动执行的过程代码。触发器主要用于维护数据库上信息的完整性。例如，当向雇员表添加新记录（代表新工人）时，还应在税表、假期表和工资表中创建新记录

网上有很多关于他们的资料：

[MSDN - 创建触发器](http://msdn.microsoft.com/en-us/library/aa258254%28v=sql.80%29.aspx)

[触发器简介](http://www.sqlteam.com/article/an-introduction-to-triggers-part-i)

[探索 SQL Server 触发器](http://msdn.microsoft.com/en-us/magazine/cc164047.aspx)

# wpf - 如何避免在每个窗口中导入 XAML 命名空间

> ID：11451012
> 
> 赞同：1
> 
> 时间：2012-07-12T11:38:30.640
> 
> 标签：wpf, xaml

`xmlns:Engine="clr-namespace..."`如果我在每个应用程序窗口中都需要相同的命名空间，是否有可能避免？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:50:05.237

我同意 HCL，我认为它不能完成并且添加命名空间不会消耗更多资源。

我会给你一个替代方案。您可以更改窗口模板（或创建您自己的模板）以使其包含您的命名空间。

在我的电脑中，对于VS2010，模板的路径是：
C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\ItemTemplates\VisualBasic\WPF\3082

请注意，一个用于 vb.Net，还有一个 CSHARP 目录。

**编辑**：

据我所知，模板适用于每台计算机，而不是每个项目，但是当您编辑模板时，您可以使用条件，例如：

```
$if$ ($targetframeworkversion$ >= 3.5)using System.Linq; 
```

您可以使用 $rootnamespace$ 常量来检查特定项目，然后添加或不添加命名空间。我不知道，可能存在一个具有当前项目名称的常量，但 $rootnamespace$ 应该足以满足这个 pourpose 的需要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T14:22:48.547

如果它是您自己在 Engine 命名空间中使用的程序集的源代码，您可以完全删除前缀请求和添加内容的需求。通过这个小技巧，您只需将自己的名称空间附加到 xaml 名称空间（已经包含在内）。

在您的“引擎”项目中（不是您拥有 xmlns:Engine 行的项目，**不能**是您使用它的同一个项目，它将无法工作）确保您添加了 WindowsBase 引用，然后添加以下内容在 AssemblyInfo.cs/AssemblyInfo.vb 文件中（c#：在 Properties 文件夹中找到）（vb：您需要使用“显示所有文件”按钮，然后您会在 My Project 文件夹中找到它）：

C＃：

```
[assembly: XmlnsDefinition("http://schemas.microsoft.com/winfx/2006/xaml/presentation", "The.Class.Namespace")] 
```

VB：

```
<Assembly: XmlnsDefinition("http://schemas.microsoft.com/winfx/2006/xaml/presentation", "The.Class.Namespace")> 
```

如果您的项目在多个您想在其他项目 xaml 中使用的命名空间中有多个类，则可以多次执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T11:40:43.123

不，没有办法避免这种情况。然而，声明一个命名空间并不意味着它消耗资源（在运行时）。

# netty - Netty DelimiterBasedFrameDecoder 仅将分隔符设置为 '\r'

> ID：11451014
> 
> 赞同：2
> 
> 时间：2012-07-12T11:38:48.013
> 
> 标签：netty

我如何让 netty 小心缓冲数据，直到它接收到分隔符（仅限“\r”！），即它必须忽略“\r\n”，然后将其分派给 ChannelPipeline 中的下一个处理程序。可以用 DelimiterBasedFrameDecoder 完成吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:42:21.640

您需要编写自己的解码器，它应该扩展 FrameDecoder。只需查看 FrameDecoder 的 javadocs 以了解如何实现它

# c# - 分页 Lucene.Net 搜索结果 asp.net

> ID：11451021
> 
> 赞同：5
> 
> 时间：2012-07-12T11:39:15.947
> 
> 标签：c#, lucene.net

我想为 lucene.net 搜索结果进行分页。当我从索引中获取数据时，我只需要在每页中获取 10 条记录。所以我搜索 lucene.net 寻呼技巧，我得到了一个我不清楚的答案。在这里……请看。

```
Hits hits = searcher.search(query);
int offset = page * recordsPerPage;
int count = Math.min(hits.length() - offset, recordsPerPage);
for (int i = 0; i < count; ++i) {
    Document doc = hits.doc(offset + i);

}

TopDocs topDocs = indexSearcher.Search(query, null, 150);
for(int i=100, i<min(topDocs.totalHits,150); i++) {
Document doc = indexSearcher.doc(topDocs.scoreDocs[i]);

// Do something with the doc
} 
```

我只需要知道有没有更好的技术。请讨论。谢谢

## 从这里我的更新开始

我用来搜索索引的不同方式。获得您的代码后，我尝试将其纳入我的代码中，但出现错误。请查看我的代码并以这种方式进行转换，以便我可以使用您的分页逻辑。

## 这是我的代码

```
 int PageIndex=0;
            int PageSize=10;
            searcher = new IndexSearcher(_directory, false);
            Query qry = MultiFieldQueryParser.Parse(Version.LUCENE_29, multiWordPhrase, fieldList, occurs.ToArray(), new StandardAnalyzer(Version.LUCENE_29));
            TopDocs topDocs = searcher.Search(qry, null, ((PageIndex + 1) * PageSize), Sort.RELEVANCE);

            int resultsCount = topDocs.TotalHits;
            lblMatchFound.Text = "Match Found " + resultsCount.ToString();

            List<SearchResult> list = new List<SearchResult>();
            SearchResult oSr = null;

            if (topDocs != null)
            {
                ScoreDoc[] scoreDocs = topDocs.ScoreDocs;
                foreach (ScoreDoc scoreDoc in scoreDocs)
                {
                    Document doc = searcher.Doc(scoreDoc.doc);
                    oSr = new SearchResult();
                    oSr.ID = doc.Get("ID");
                    oSr.Title = doc.Get("Title");
                    oSr.Description = doc.Get("Description");
                    //oSr.WordCount = AllExtension.WordCount(oSr.Description, WordExist(oSr.Title, multiWordPhrase));
                    string preview =
                    oSr.Description = AllExtension.HighlightKeywords(oSr.Description, multiWordPhrase);  //sr.Description;
                    oSr.Url = doc.Get("Url");
                    list.Add(oSr);
                }
            } 
```

请查看并以我可以进行分页的方式重组我的代码。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T11:49:20.523

首先不要使用`Hits`类，因为它已被弃用且速度慢。

对于您的寻呼案例：

搜索第一页，例如`TopDocs td = s.Search(query, 10);`

并在第二页`TopDocs td = s.Search(query, 20);`显示从 10 到 19 的结果

等等...

*PS：Lucene 中代价高昂的部分是从索引中读取结果，而不是搜索本身。所以上面的技巧应该表现得很好。*

**-- 编辑（未经测试） --**

```
int page = 2; //starting from 0

TopDocs td = searcher.Search(query, (page+1)*10);
for (int i = page * 10; i < (page + 1) * 10 && i < td.scoreDocs.Length; i++)
{
    Document doc = indexReader.Document(td.scoreDocs[i].doc);
} 
```

# objective-c - 如何检查2个日期是否相差30天？

> ID：11451023
> 
> 赞同：-6
> 
> 时间：2012-07-12T11:39:17.483
> 
> 标签：objective-c, ios

> **可能重复：**
> [如何计算两个日期之间的差异？](https://stackoverflow.com/questions/4371757/how-can-i-calculate-the-difference-between-two-dates)
> [NSDate，比较两个日期](https://stackoverflow.com/questions/9781467/nsdate-comparing-two-dates)

我有两个约会。如何检查它们之间是否有30天的差异？我实际上有一个应用内购买，需要在每购买 30 天后禁用。当用户购买该功能时，日期已保存，因此我需要检查日期。如果 30 天过去了，我需要再次禁用该功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T11:46:21.337

您可以使用 timeIntervalSince1970 将两个日期转换为秒，然后检查差异是否大于 2592000（30*24*60*60，即 30 天 * 24 小时 * 60 分钟 * 60 秒）。

```
NSTimeInterval difference = [date1 timeIntervalSince1970] - [date2 timeIntervalSince1970];

if(difference >2592000)
{
 //do your stuff here
} 
```

编辑：对于更紧凑的版本，您可以使用[- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/20000188--initWithTimeInterval_sinceDate_)

```
NSTimeInterval difference = [date1 timeIntervalSinceDate:date2];
if(difference >2592000)
{
    //do your stuff here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:51:25.730

以下列方式提供开始和结束 NSDate：

```
 NSDate *date_Start;
    NSDate *date_End;
    NSCalendar *cal=[NSCalendar currentCalendar];
NSDateComponents *components=[cal components:NSDayCalendarUnit fromDate:date_Start toDate:date_End options:0];
    int days=[components day];
    if(days>30){
     //Your code here
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-12T11:45:06.740

您可以创建一个从现在起 +30 天的日期：

```
NSDate *thrityDaysPlus = [[NSDate date] dateByAddingTimeInterval:3600*24*30] 
```

然后只需将其与您保存的日期进行比较

```
if ([date1 compare:date2] == NSOrderedDescending) {
    NSLog(@"date1 is later than date2");        

} else if ([date1 compare:date2] == NSOrderedAscending) {
    NSLog(@"date1 is earlier than date2");

} else {
    NSLog(@"dates are the same");

} 
```

# asp.net - 如何在 MVC Razor 视图中显示层次结构数据

> ID：11451027
> 
> 赞同：1
> 
> 时间：2012-07-12T11:39:41.363
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, razor

我正在尝试在视图中显示层次结构数据 - 我有 2 个模型（父/子链接）

楷模：

```
public class Clinic
{
    public int ClinicId { get; set; }
    [Display(Name="Clinic Name")]
    public string Name { get; set; }
    public string Description { get; set; }
    public List<Property> Properties { get; set; }

}

public class Property
{
    public int PropertyID { get; set; }
    public int ClinicId { get; set; }
    [Display(Name="Property Address")]
    public string Address { get; set; }
    public Clinic Clinic { get; set; }
    public List<Room> Rooms { get; set; }
 }

public class Room
{
    public int RoomId { get; set; }
    public int PropertyId { get; set; }
    public string RoomName { get; set; }
    public Property Property { get; set; }

} 
```

我的控制器正在构建这个 Linq 查询 - 它在 LinqPad 中显示良好：

```
 //
    // GET: /Property/Overview/
    public ActionResult Overview()
    {
   // original code - replaced following help below
   //  var ovw =
   //         (from c in db.Clinics
   //          select new
   //          {
   //              c.Name,
   //              Properties =
   //                  from p in db.Properties
   //                  where p.ClinicId == c.ClinicId
   //                  select new
   //                  {
   //                      p.Address
   //                  }
   //                  });

        IEnumerable<Clinic> ovw = from c in db.Clinics
        select c;

        return View(ovw);
    } 
```

我的看法是：

```
@model IEnumerable<ttp.Models.Clinic>

@{
    ViewBag.Title = "Overview";
}

<h2>Overview</h2>

 @foreach (var item in Model) {
 @item.Name
        <br />
 if (item.Properties != null){
    foreach (var item2 in item.Properties) {
        @item2.Address <br />

 if (item2.Rooms != null){
    foreach (var item3 in item2.Rooms) {
        @item3.RoomName <br />
     }

     }
    }
   } 
```

它应该显示：

```
Clinic1
   Property1
      Room1
      Room2
      Room3

   Property2
      Room4
      Room5

Clinic2
   Property3
      Room6
.... 
```

但只是显示：

```
Clinic1
Clinic2
Clinic3 
```

这只会填充诊所的第一级数据 - 而不是子属性或属性的子房间。

谁能帮我修复我的控制器或我的视图？

谢谢，马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T11:55:53.077

您应该创建 Clinic 和 Property 类的实例。您正在使用匿名类型。

也不要忘记为 Properties 调用 ToList() ，因为您的查询将返回`IEnumerable<Property>`or `IQueryable<Property>`。

```
IEnumerable<Clinic> ovw = from c in db.Clinics
                          select new Clinic
                          {
                            Name = c.Name,
                            Properties =(from p in db.Properties
                                         where p.ClinicId == c.ClinicId
                                         select new Property
                                         {
                                             Address = p.Address
                                         }).ToList()
                          }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T11:59:06.030

您实际上并没有返回诊所列表，因为您使用过

```
select new { ... } 
```

相反，您只想获得诊所。模型和集合已经存在。无需重新创建它：

```
var ovw = db.Clinics; 
```

如果您尝试使用与 db 模型分离的视图模型（这是一种很好的做法），请查看 AutoMapper 或手动从 db Clinic 映射到视图模型 Clinic。然后，您将使用 select new { ... } 而不是

```
select new vmClinic { Name = c.Name, ... } 
```

其中 vmClinic 是您的视图模型诊所。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T15:45:56.923

我已经将上面的答案加了 1，因为它们非常有帮助 - 但实际的问题/答案在我的模型定义中 - 要访问控制器/视图中的链接表，我必须将 VIRTUAL 添加到链接属性：

我有的地方：

```
public List<Property> Properties { get; set; } 
```

那应该是：

```
public virtual ICollection<Property> Properties { get; set; } 
```

我希望这可以帮助其他人解决这个问题。

感谢 Steve 和 Ufuk 的帮助和时间。

标记

# c# - 编组 PDouble (C# -> Delphi)

> ID：11451028
> 
> 赞同：1
> 
> 时间：2012-07-12T11:39:43.327
> 
> 标签：c#, delphi, pinvoke, marshalling

我有一个用 Delphi 编写的非托管 DLL 文件，其中包含一个具有以下定义的函数：

```
function F(tgran: integer; inputs: PDouble; goutp, outputs, toutp: PDouble): integer; stdcall; external 'mydll.dll'; 
```

我用 C# 编写了一个适配器，它应该可以帮助我使用它。

```
[UnmanagedFunctionPointer(APIAdapter.Convention)]
public delegate int FDelegate(int tgran, IntPtr inputs, IntPtr goutp, IntPtr outputs, IntPtr toutp);

public class APIAdapter : IDisposable
    {
        public const string DllName = "mydll.dll";
        public const CallingConvention Convention = CallingConvention.StdCall;
        public FDelegate F;
        [DllImport("kernel32")]
        private static extern IntPtr LoadLibrary(string lpLibFileName);

        [DllImport("kernel32")]
        private static extern bool FreeLibrary(IntPtr hModule);

        [DllImport("kernel32.dll")]
        private static extern IntPtr GetProcAddress(IntPtr hModule, String procname);

        private IntPtr _dllHandle;
        public APIAdapter()
        {
            _dllHandle = LoadLibrary(DllName);

            F = (FDelegate)GetFunction<CalcCavSpDelegate>("F");           
        }

        private Delegate GetFunction<T>(string procName)            
        {
            IntPtr procAddress = GetProcAddress(_dllHandle, procName);
            return Marshal.GetDelegateForFunctionPointer(procAddress, typeof(T));
        }

        ~APIAdapter()
        {
            Dispose(false);
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        private void Dispose(bool disposing)
        {
            if (disposing)
            { 
            }

            while (FreeLibrary(_dllHandle))
            { 
            }
        }
    } 
```

用法非常简单：

```
using(var api = new APIAdapter())
{
  // Call API functions
} 
```

问题是在 DLL 文件中发生的 AccessViolationException。

我试图将 PDouble 变量作为`double[], double* (unsafe code), IntPtr`. 无论我选择哪种方法，这都是同一个故事。我试图大幅增加传入数组的大小以排除数组索引错误 - 再次出现 AccessViolation 异常。

将 PDouble 传递到非托管 Delphi DLL 文件的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:09:14.533

我认为您可以通过简单地使用属性来消除所有`LoadLibrary`,`GetProcAddress`和`FreeLibrary`复杂性。`DllImport`不过，我可以说我不知道​​你为什么选择这条路的任何具体原因。

无论如何，您可以简单地`ref double doubleArg`在声明中包含通过 PDouble。这里应该没有必要`IntPtr`。

# php - 如何通过 PHP 在 Web 服务器上安全地存储/提供只能通过安全登录区域访问的文件？

> ID：11451036
> 
> 赞同：2
> 
> 时间：2012-07-12T11:32:45.550
> 
> 标签：php, http-headers, data-storage

我目前正在创建一个 PHP 网站，允许管理员上传各种文档（pdf、doc、docx、xls），然后可以在以后下载。这些只能由管理员在登录后访问。到目前为止，我一直将文件存储在 Web 根目录之上，然后使用 PHP 通过 PHP 脚本访问和提供文件，从而防止直接访问文件. 这确实有效，但似乎从来都不是一种理想的方法，因为它依赖于通过 PHP 为文件下载设置正确的标题，这并不总是在所有浏览器上给出正确的结果。如果他们知道文件的位置，我真的看不出有任何其他方法可以阻止文件被公开访问。

您通常会使用什么过程来在不应公开访问的 Web 服务器上存储和提供文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:40:02.640

示例 PHP：

```
<?php
    if (TRUE === $_SESSION['logged_in']) {

    }

    $file = '/full/path/to/useruploads/secret.pdf';

    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename=' . basename($file));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Pragma: public');
    header('Content-Length: ' . filesize($file));
    ob_clean();
    flush();
    readfile($file);
    exit;
?> 
```

# ruby-on-rails - Rails 3.2 在单击编辑后未在表单中保存下拉选择

> ID：11451038
> 
> 赞同：1
> 
> 时间：2012-07-12T11:40:14.103
> 
> 标签：ruby-on-rails, forms, save, submit

我有一个带有输入字段和下拉框的表单，其中包含来自其他表的数据。（加入）但现在当我提交时很好，但是当我想编辑字段时，下拉字段为空但文本字段不是

我的表单代码：

```
<%= form_for @contracten, :html => { :multipart => true } do |f| %>
  <% if @contracten.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@contracten.errors.count, "error") %> prohibited this contracten from being saved:</h2>

      <ul>
      <% @contracten.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div id="forms">
  <div class="field">
    <%= f.label :naam %><br />
    <%= f.text_field :naam %>
  </div>
  <br>
  <div class="field">
    <%= f.label :omschrijving %><br />
    <%= f.text_area :omschrijving %>
  </div>
  <br>
  <div class="field">
    <%= f.label :organisatie %><br />
    <%= f.select :organisatieid, options_for_select(@organisaties.map{ |f| [f.naam, f.id] }), :include_blank => true %>
  </div>
  <br>
  <div class="field">
    <%= f.label :vestiging %><br />
    <%= f.select :vestigingid, options_for_select(@vestigingens.map{ |f| [f.naam, f.id] }), :include_blank => true %>
  </div>
  <br>
  <div class="field">
    <%= f.label :Beheerder %><br />
    <%= f.select :persoonid, options_for_select(@personen.map{ |f| [f.naam, f.id] }), :include_blank => true %>
  </div>
  <br>
  <div class="field">
    <%= f.label :contractsoort %><br />
    <%= f.select :contractsoortid, options_for_select(@contractsoorten.map{ |f| [f.naam, f.id] }), :include_blank => true %>
  </div>
  <br>
  <div class="field">
    <%= f.label :datumingang %><br />
    <%= f.datetime_select :datumingang %>
  </div>
  <br>
  <div class="field">
    <%= f.label :datumeinde %><br />
    <%= f.datetime_select :datumeinde %>
  </div>
  <br>
  <div class="field">
    <%= f.label :contractduur %><br />
    <%= f.number_field :contractduur, :placeholder => 'in jaren' %>
  </div>
  <br>
  <div class="field">
    <%= f.label :opzegtermijn %><br />
    <%= f.number_field :opzegtermijn, :placeholder => 'In Maanden' %>
  </div>
  <br>
  <div class="field">
    <%= f.label :betalingsperiode_eenheid_id %><br>
    <%= f.select :betalingsperiodeeenheidid, options_for_select(@betalingsperiodeeenhedens.map{ |f| [f.omschrijving, f.id] }), :include_blank => true %>
  </div>
  <br>
  <div class="field">
    <%= f.label :betalingstermijn %><br />
    <%= f.number_field :betalingstermijn %>
  </div>
  <br>
  <div class="field">
    <%= f.label :pdf %><br />
    <%= f.file_field :pdf %>
  </div>
  <br>
  <div class="actions">
    <%= f.submit "Toevoegen", :class => 'button3' %>
  </div>
  </div>
<% end %>
<br> 
```

截屏： ![带有下拉菜单和文本区域的表单](../Images/4074c060d1d24acf7665ffa8fd848ffe.png)

我希望有人知道是什么问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T11:55:10.460

添加`:selected => ...`到您的`options_for_select`参数。

例如：

```
<%= f.select :contractsoortid, 
             options_from_collection_for_select(@contractsoorten, 'id', 'naam',
                                               :selected => @contracten.contractsortid), 
             :include_blank => true %> 
```

更改实际上已保存，但在呈现表单时，必须指定实际选择的值。

# c++ - WGL：可以找到屏幕外上下文并渲染到窗口吗？

> ID：11451053
> 
> 赞同：0
> 
> 时间：2012-07-12T11:41:09.030
> 
> 标签：c++, windows, opengl, webgl, chromium

有一个有趣的浏览器框架叫做[Awesomium](http://awesomium.com/)，它基本上是 Chromium 浏览器引擎的一个包装器。

我有兴趣使用它为桌面重新分发基于 WebGL 的游戏。然而，Awesomium 仅支持使用发送到 CPU 的像素缓冲区进行渲染，即使 WebGL 上下文本身是基于真正的硬件加速 OpenGL 上下文。这对于实时高性能游戏来说效率低下，并且可能会杀死低端机器上的帧率。

Awesomium 最终可能会解决这个问题，但它让我思考：是否可以在进程中搜索屏幕外 OpenGL 上下文并将其直接渲染到窗口？这将避免低效的渲染方法，完全在 GPU 上进行渲染。我在 Windows 上使用本机 C++ 应用程序，所以大概这将涉及 WGL 细节。此外，由于 Chromium 是一个多线程浏览器引擎，它可能涉及在不同的线程上查找 OpenGL 上下文或在不同的进程中查找事件。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:50:03.973

> 是否可以在进程中搜索屏幕外 OpenGL 上下文并将其直接渲染到窗口？

不，这不可能。如果为 OS 缓冲区创建了 opengl 上下文，则无法将其重定向到其他缓冲区和其他 opengl 上下文。

也许您可以使用共享的 opengl 资源（如果两个 opengl 上下文都是使用此类选项创建的）。

# iphone - 阻止 webViewDidFinishLoad 被快速调用

> ID：11451055
> 
> 赞同：3
> 
> 时间：2012-07-12T11:41:18.377
> 
> 标签：iphone, objective-c, cocoa-touch, sdk

在我的`webViewDidFinishLoad`方法中，我有以下代码：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView {   
    if (hasPressed == 1) {
        hasPressed = 0;
        isBlocked = 0;
    }
    else if (hasPressed == 0 && hasDroppedDown == 0) {
        if (viewState != kStateWeather || isBlocked == 0) {
        [UIView animateWithDuration:0.5 
                              delay:0.0 options:UIViewAnimationCurveLinear animations:^{
                                  //Animations
                              }
                         completion:^(BOOL finished){
                             hasDroppedDown = 1;
                         }];
        }
    }
} 
```

正如你所看到的，如果这个方法被快速调用，例如一个有重定向的网站，我的`else`in my`else if`变得毫无用处。我如何阻止它被如此迅速地调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:48:02.537

不幸的是，你不能这样做。当新的 URL 开始加载到`UIWebView`. 相反，你可以做一件事。实现委托功能

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
```

当新框架即将开始加载到`UIWebView`. `navigationType`您可以通过检查哪些可以获得值来确定要加载哪种类型的请求

```
UIWebViewNavigationTypeLinkClicked
UIWebViewNavigationTypeFormSubmitted
UIWebViewNavigationTypeBackForward
UIWebViewNavigationTypeReload
UIWebViewNavigationTypeFormResubmitted
UIWebViewNavigationTypeOther 
```

**注意**：`YES`如果您允许 webview 加载页面，则返回`NO`。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T11:58:57.510

```
- (void)main { //being called every 0.2
    t+=0.2;
}
- (void)webViewDidFinishLoad:(UIWebView *)webView {   
    loadImg.hidden = 1;
    m_activity.hidden= TRUE;     
    [m_activity stopAnimating];
    if (t>0.5) {
        [self finishedLoading];
        t=0;
    }
}
- (void)finishedLoading {
    if (hasPressed == 1) {
        hasPressed = 0;
        isBlocked = 0;
    }
    else if (hasPressed == 0 && hasDroppedDown == 0) {
        if (viewState != kStateWeather || isBlocked == 0) {
            [UIView animateWithDuration:0.5 
                                  delay:0.0 options:UIViewAnimationCurveLinear animations:^{
                                      //Animations
                                  }
                             completion:^(BOOL finished){
                                 hasDroppedDown = 1;
                             }];
        }
    }
} 
```

# asp.net - 在 .net 4.0 UI 中运行后台任务的选项

> ID：11451059
> 
> 赞同：0
> 
> 时间：2012-07-12T11:41:30.073
> 
> 标签：asp.net, vb.net, multithreading

我有一个 vb.net 4.0 UI，它基本上允许用户在 SQL Server 2008 数据库上搜索数据并更新/操作它。所有与数据库的通信都是通过存储过程完成的。其中一个更新过程可能需要长达 6 分钟的时间来处理 - 目前用户只会看到“处理中...”消息，直到更新完成，然后才会显示结果。

我认为这是一个很好的后台任务候选人。我希望用户能够调用请求，然后继续在 UI 中进行其他工作。当任务完成时，它会通知他们结果。我可以用线程来完成这个吗？我是线程新手，但鉴于一些文献和一个或 2 个示例，我可能正在路上。我已经进行了一些谷歌搜索，但在示例中用户是否可以在任务执行时继续在 UI 中工作并不明显。还有其他选择可以完成我所描述的吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:52:54.373

运行后台任务有很多选择，但在 .net 4.0 中，最简洁的可能是使用 TPL（任务并行库）。您可以按如下方式执行后台任务：

```
Task.Factory.StartNew(()=>SomeMethod()); 
```

详细信息可以在这里找到。

[http://msdn.microsoft.com/en-us/library/dd460717.aspx](http://msdn.microsoft.com/en-us/library/dd460717.aspx)

但请记住，如果您需要在从该调用返回时执行任何 UI 更新，则需要将其分派回 UI 线程。

TPL 还具有在 Dispatcher 线程上运行延续的机制。

在后台任务运行时，不会阻塞 UI 线程。

# html - 在 HTML ID 中使用数据库主键

> ID：11451061
> 
> 赞同：6
> 
> 时间：2012-07-12T11:41:34.660
> 
> 标签：html

就是想问问。

我有一个网站，每个用户都链接到数据库中的一个 ID，并且这个主键包含在许多表中。我提取用户信息的最快方法是拥有此 ID。

将此 ID 放在网站 HTML 代码中会被视为不好的做法吗？例如 id="theIDnumber"

否则我可以只使用用户名，然后在数据库中为这个 ID 引用它——这很好，但我相信使用 ID 会更快。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-26T07:59:15.953

我会说不，如果你的钥匙是**可预测**的。一个简单的例子：如果您使用顺序递增的主键，用户可以从可能涉及隐私问题的数据中提取信息。例如，他们可以推断出哪个帐户是在他们的帐户之前创建的。对于那些试图从您的网站系统地获取信息的人来说，生活也变得容易。

一些相关阅读

1.  [https://stackoverflow.com/a/7452072/781695](https://stackoverflow.com/a/7452072/781695)

    > 您让最终用户有机会处理这些变量并传递他们喜欢的任何数据。缓解此漏洞的对策是创建间接对象引用。这听起来像是一个很大的变化，但不一定非得如此。您不必重新设置所有表或任何东西的密钥，只需通过使用间接引用映射巧妙地处理数据即可。

2.  [https://security.stackexchange.com/a/33524/37949](https://security.stackexchange.com/a/33524/37949)

    > 隐藏数据库密钥并不是完全需要的，但如果攻击者试图在攻击中引用内部 ID，它确实会让生活变得更加困难。对文件名和其他此类内部标识符的直接引用可以让攻击者映射服务器的内部结构，这可能在其他攻击中很有用。这也引发了路径注入和目录遍历问题。

3.  [https://www.owasp.org/index.php/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet)

    > 对象引用映射首先由临时存储在会话中的授权值列表填充。当用户请求一个字段（例如：color=654321）时，应用程序会从会话中查找此映射以确定适当的列名。如果该有限映射中不存在该值，则用户未被授权。参考地图不应该是全局的（即包括所有可能的值），它们是临时地图/字典，只填充了授权值。

# servlets - Servlet 向 URL 发送请求？

> ID：11451065
> 
> 赞同：-1
> 
> 时间：2012-07-12T11:41:50.857
> 
> 标签：servlets, oauth

我对 servlet 完全陌生。我正在尝试向 google 发送请求以获取令牌。我尝试了很多来源，但我能得到的只是“向带有一些参数的 url 发送请求”。我的问题是我们如何通过使用 servlet 传递一些参数来向 url 发送请求..请帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:43:47.447

您可以使用查询字符串将参数与 url 一起发送。带有查询字符串的 URL 将如下所示：

```
http://google.com/search?a=b&c=d 
```

将分别具有值`a & c`的参数在哪里。`b & d`

# javascript - 为什么这个javascript不正确？

> ID：11451070
> 
> 赞同：1
> 
> 时间：2012-07-12T11:41:57.487
> 
> 标签：javascript, rubymine

我的 IDE RubyMine 说这是“可能不正确”：

```
function update_top_up_prices_via_localStorage(){
    var index = localStorage.getItem("volxs");
    $('.product-inner').each(function(){

        var product = this.getAttribute('data-product-miles');
        var cpm = ((localStorage.getItem("cpm_by_volxs_"+product)).split(","))[index];

        $(this).find('table tbody tr td').each(function(){
            var top_up_miles = Number(this.getAttribute('data-topup-miles'));
            var price = Number(top_up_miles * cpm * 1.06);
            price = price.toFixed(2);
            $(this).text('\u00A3'+price);
        })
    });
} 
```

我的 IDE`var top_up_miles`在线上说，“可能无效使用`this`. 这会检查 javascript`this`在闭包中与在外部上下文中是否相同。

js 在 Chrome 和 IE9 中运行良好。它在 IE8 中不起作用。

这是错的吗？有没有更好的方法来写这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:46:31.007

RubyMine 不知道`$().each`使用指定`this`上下文执行传递的函数。如果您想避免该警告，请使用

```
$(/* ... */).each(function (i, elem) { 
    elem.getAttribute(/* ... */);
}); 
```

等等

您的代码不适用于 IE8 的原因可能与此无关。然而，为了更好的兼容性，使用 jQuery 包装的函数而不是原生 API 函数：`$(this).attr`而不是`this.getAttribute`（感谢@freakish）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T11:48:28.780

`this`它提请您注意警告您在 JavaScript 中使用关键字时应该小心，因为它`this`总是指函数所有者。

要了解更多信息，请参阅有关 JavaScript[关键字](http://www.quirksmode.org/js/this.html)[的 quirksmode 的这篇文章`this`](http://www.quirksmode.org/js/this.html)。

# asp.net - 自动在 HTTP 和 HTTPS 之间切换 asp.net

> ID：11451071
> 
> 赞同：1
> 
> 时间：2012-07-12T11:42:00.020
> 
> 标签：asp.net, security, ssl, https, webforms

我在 asp.net Web 表单范例中（使用 MVC 中的 APIController 实现的 api）。我在 IISExpress 中添加了以下绑定

```
http://sarfraz-pc:80
https://sarfraz-pc:443 
```

使用这篇[很棒的文章](https://www.hanselman.com/blog/working-with-ssl-at-development-time-is-easier-with-iisexpress)。我可以使用 http 或 https 访问整个站点。现在，我想强制某些页面在 http 上运行，而其他页面在 https 上运行。谷歌给了我[很多结果，包括](https://www.google.com.pk/search?q=asp.net%20switch%20b/w%20http%20and%20https&rlz=1C1_____enPK456PK456&oq=asp.net%20switch%20b/w%20http%20and%20https&sugexp=chrome,mod=7&sourceid=chrome&ie=UTF-8#q=asp.net%20switch%20b/w%20http%20and%20https&hl=en&rlz=1C1_____enPK456PK456&prmd=imvnsfd&ei=FbP-T_C3CI3ysgb90on7AQ&start=0&sa=N&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=673242acfd9407a3&biw=1366&bih=667)[来自代码项目](https://www.codeproject.com/Articles/7206/Switching-Between-HTTP-and-HTTPS-Automatically-Ver)的一个非常古老的解决方案和另一个名为[Security Switch](https://web.archive.org/web/20160601015855/https://code.google.com/p/securityswitch/)的解决方案。

但我正在认真考虑使用[IIS 7.0 的 url 重写](https://weblogs.asp.net/owscott/url-rewrite-servervariables-url-parts-http-to-https-redirect-week-9)模块来实现这一点。有没有人为此使用过 URL 重写？我不知道详细的url重写所以我想问走这条路线有缺点吗？如果是，请提出一些替代方法（包括我提到的方法），但它不应该只是简单地`Response.Redirect`在应用程序中到处写代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:15:56.427

将此代码添加到您的 global.asax 文件以检查每个请求并即时转换。

```
protected void Application_BeginRequest(Object sender, EventArgs e)
{
   if (HttpContext.Current.Request.IsSecureConnection.Equals(false) && HttpContext.Current.Request.IsLocal.Equals(false))
   {
    Response.Redirect("https://" + Request.ServerVariables["HTTP_HOST"]
+   HttpContext.Current.Request.RawUrl);
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T11:53:19.460

虽然它没有使用 URL 重写（我只有少量经验），但我们通过 IIS 中的自定义错误来处理它。

*   将“403.4”（需要SSL）的自定义错误设置为“/Error/403_4.aspx”等URL。
*   将目录/目录设置为“需要 SSL”。

然后在`403_4.aspx`...

```
Private Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load
  Dim url As String = Request.Url.Query
  url = url.Replace("?403;", "")
  Dim port As String = String.Format(":{0}/", New Uri(url).Port)
  If url.IndexOf(port) <> -1 Then
    url = url.Replace(port, "/")
  End If
  url = url.Replace("http://", "https://")
  Response.Redirect(url, True)
End Sub 
```

我知道这并不完全是您所追求的，但它比在代码中的多个位置进行重定向要好。

# java - 测试 SNMP 连接可用性

> ID：11451073
> 
> 赞同：0
> 
> 时间：2012-07-12T11:42:02.687
> 
> 标签：java, snmp

有没有办法在 java 中测试 SNMP 连接的可用性？我正在使用[推理](http://ireasoning.com/)api。

```
 try {
            long timeTicks = System.currentTimeMillis();
            while (timeTicks > 4294967295L) { timeTicks-= 4294967295L; }
            SnmpTrap trap = new SnmpTrap(timeTicks, new SnmpOID(oid));
            try {
                InetAddress inet = InetAddress.getByName(agentIp);
                agentIp = inet.getHostAddress();
            } catch (Exception e2) {
                System.out.println("SendSNMPTrap::sendVersion2c unable to resolve "+agentIp+" to real IP. Exception="+e2.toString());
            }

            trap.addVarBinds(vb.getVarbinds());
            SnmpTrapSender.sendTrap(destHost, port, trap, true, community);
         } catch (Exception e) {
             logger.error("SendSNMPTrap::sendVersion2c Exception="+e.toString());
             result = false;
         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:50:34.920

测试任何资源可用性的最佳方法是尝试使用它。无论如何，当你使用它时，你必须处理失败。为什么要写两次相同的代码？为什么要尝试预测未来？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-24T14:17:30.040

您可以使用 INFORM PDU 代替 TRAP PDU。这样，Trap Receiver 将向您发送回复以确认它已收到 INFORM。

# wordpress - 无法访问租户站点的仪表板

> ID：11451074
> 
> 赞同：0
> 
> 时间：2012-07-12T11:42:04.823
> 
> 标签：wordpress

我已经创建了多网络结构，但是在访问租户站点的仪表板时遇到了问题。我的超级管理员是 helpdesk.com，它的租户是 abc.helpdesk.com，当我单击 mysites > abc_helpdesk > 仪表板时，它会将我重定向到登录部分，使用管理员用户名登录后，即我注册的用户名，我被重定向到我尝试访问 abc_helpdesk 仪表板的同一页面。

我的 .htaccess 文件有以下代码：-

```
# BEGIN WordPress
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
# uploaded files
RewriteRule ^files/(.+) wp-includes/ms-files.php?file=$1 [L]
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
RewriteRule . index.php [L]
# END WordPress 
```

在 config.php 我有以下代码： -

```
define('WP_ALLOW_MULTISITE', true);
define('MULTISITE', true);
define('SUBDOMAIN_INSTALL', true);
$base = '/';
define('DOMAIN_CURRENT_SITE', 'local.wordpress.com');
define('PATH_CURRENT_SITE', '/');
define('SITE_ID_CURRENT_SITE', 1);
define('BLOG_ID_CURRENT_SITE', 1);
/* That's all, stop editing! Happy blogging. */ 
```

已刷新所有 cookie，我再次无法使用仪表板，我只能访问该站点，因为任何其他选项登录页面正在启动，并且在使用管理员的用户名登录后，我被重定向到我之前所在的同一页面.. :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T06:10:17.973

实际上我必须在我的虚拟主机文件中设置通配符条目......即，在 httpd-vhost.conf 文件中我必须添加新行：- `ServerAlias *.local.wordpress.com`

在主机文件中我必须再添加一行 `127.0.0.1 *.local.wordpress.com`

这解决了我的问题:)

# pjsip - 在 IOS5 中实现 SIP 功能

> ID：11451076
> 
> 赞同：6
> 
> 时间：2012-07-12T11:42:14.897
> 
> 标签：pjsip

我想构建一个 iPhone 应用程序，它可以选择通过 SIP (VoIP) 拨打电话，但目前我不知道如何开始。

有没有人有关于这个主题的一些信息，或者我可以用来实现 SIP 功能的演示项目？

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-25T19:14:56.930

你面前有一条漫长而有趣的道路。: - )。

1.  您将需要选择一个 SIP 库来构建您的应用程序。有许多开源的 SIP 堆栈，其中一些甚至有适用于 Mac OS 和 iOS 的 xCode 项目。您可能想查看[ReSIPRocate](http://www.resiprocate.org/)、[PJSip](http://trac.pjsip.org/repos/wiki/Getting-Started/iPhone#BuildingPJSIP)、[Sofia SIP](http://sofia-sip.sourceforge.net/)或[oSIP/exoSIP](http://savannah.nongnu.org/projects/exosip/)。

2.  您需要围绕该 sip 堆栈构建逻辑，这将允许您管理 sip 对话，并处理您想要支持的所有可能的呼叫场景，为这些呼叫设置和管理音频通道等。一些 SIP 堆栈上面的功能比其他功能更多。还有许多公司出售基于这些开源 SIP 堆栈构建的 iOS 工具包，以使您的工作更轻松。

3.  您需要将该 SIP 堆栈与 iOS 集成。这意味着将您的 iOS 应用程序连接到（可能的）基于 C 的 SIP 堆栈并对其进行管理。[Apple 在其“高级应用程序技巧”iOS 开发人员文档（高级应用程序技巧](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html)）中提供了一组非常简短的关于开发 VoIP 应用程序的建议，其中提供了有关背景和音频通道的建议。

4.  使用 SIP 服务器和其他 sip 客户端进行测试。创建一个 Asterisk/Freeswitch 框并向其注册 SIP 客户端，包括您的 iOS Sip 客户端和其他基于桌面的 SIP 电话（XLite 是一个很好的使用）。尝试您想要支持的所有通话场景。

至于演示，有一个基于 PJSIP 的名为 siphone 的开源 iPhone 应用程序，它的源代码可免费下载：[http ://code.google.com/p/siphon/](http://code.google.com/p/siphon/)

我还会查看当前 App Store 中许多基于 SIP 的应用程序中的一些。这些包括 Bria、Acrobits、Fring、Truphone、iSIP 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T11:54:45.787

我知道这有点晚了，但供将来参考；我们有很好经验的另一种 SIP 堆栈是[Linphone 项目](http://www.linphone.org/eng/documentation/dev/liblinphone-free-sip-voip-sdk.html)。

与前面提到的一些堆栈一样，如果您也计划为其他操作系统（例如 Android）编写代码，则此堆栈非常适合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T11:31:53.627

检查下面的链接。您将从那里获得源代码，并且可以为设备和模拟器构建。

[https://github.com/radif/SIPHON-SIP-Client-that-actually-compiles](https://github.com/radif/SIPHON-SIP-Client-that-actually-compiles)

# ruby-on-rails - 为什么“assert_response”会忽略 Rails 中的自定义消息？

> ID：11451080
> 
> 赞同：4
> 
> 时间：2012-07-12T11:42:36.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, functional-testing

在我的功能测试中，我验证了这样的响应状态：

```
assert_response :error, "My error message" 
```

但是，Rails 忽略了我的自定义消息并报告：

> 预期响应为 <:error>，但为 <201>

任何想法为什么？

我使用 Rails 3.2.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T11:49:29.727

我想知道同样的事情。原来它已在 Github 上修复：[https ://github.com/rails/rails/commit/d28a15ede59f6434f1b7a8d01be060fa73b4746c](https://github.com/rails/rails/commit/d28a15ede59f6434f1b7a8d01be060fa73b4746c)

对我来说，将 rails/actionpack gem 更新到最新版本并未包含该修复，但我能够手动更新 response.rb。它位于：

```
/Users/alex/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_dispatch/testing/assertions/response.rb 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T17:06:27.987

在您的测试中，您提到响应类型为 :error，它与状态码 500-599 匹配。但是由于您的测试返回状态代码 201 它无法匹配它并根据 assert_response 的定义显示消息

```
def assert_response(type, message = nil)
    clean_backtrace do
      if [ :success, :missing, :redirect, :error ].include?(type) && @response.send("#{type}?")
        assert_block("") { true } # to count the assertion
      elsif type.is_a?(Fixnum) && @response.response_code == type
        assert_block("") { true } # to count the assertion
      else
        assert_block(build_message(message, "Expected response to be a <?>, but was <?>", type, @response.response_code)) { false }
      end               
    end
end 
```

由于类型和状态代码不匹配，它进入 else 并给出该消息。

以下是响应类型及其匹配代码：

```
:success: Status code was 200
:redirect: Status code was in the 300-399 range
:missing: Status code was 404
:error: Status code was in the 500-599 range 
```

# java - Netbeans 7.0.1 gui 不起作用

> ID：11451082
> 
> 赞同：0
> 
> 时间：2012-07-12T11:42:46.650
> 
> 标签：java, netbeans

我在 Ubuntu 12.04 上安装了 Netbeans 7.0.1，在选择设计选项卡以使用 gui builder 后，设计的 gui 在加载时冻结...并给我这个错误 java.lang.ClassNotFoundException: org.w3c.dom.ElementTraversal 然后设计的 gui没有出现这就像 gui builder 无法重新加载 gui 因为 xml 问题我尝试了 Netbeans 7.1，但它没有 Java 桌面应用程序，我不能将它用于我在 Netbeans 6.9 上创建的项目有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:50:24.487

根据[这个](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=653915)错误跟踪器，您不是第一个偶然发现该错误的人，尽管操作系统不是 Ubuntu。也可能是您缺少 Netbeans 安装可能假定您拥有的一些 Java 库。

全新安装的 Ubuntu（以及其他）随附[OpenJDK](http://openjdk.java.net/)。完整的 Java SDK 需要单独安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:44:49.757

导致此问题的原因是与 Xerces 的版本冲突。我发现，如果您使用 netbeans -cp:p [netbeans xerces 版本的位置]，那么一切都很好......如果不是，它会尝试从其他地方包含它并且事情会变得很不稳定。

# jquery - JQM：在文本框中输入时禁用表单提交

> ID：11451088
> 
> 赞同：0
> 
> 时间：2012-07-12T11:43:30.863
> 
> 标签：jquery, jquery-mobile, webforms

我在表单中有一个文本框，然后这个复选框被选中，我按 Enter 提交表单。然而，这不是我想要的行为。我想验证表单并仅在单击某个链接或在文本字段外按回车键时手动发送它。这是我的表格代码

```
<form action ="<?php echo $this->url(array('controller' => 'Queue','action' => 'checkinupcoming'))."/?confirmnumber=$this->confNumber&clientid=$this->clientId";?> " data-ajax="false" method= "post" class="checkin-form">     
                <h3>Customer Details</h3>

                <ul class="form" style="margin:  10px 0 15px 27px">
                        <li id="descriptionLiId" class="first last descriptionLi">
                                <label id="lbldescriptionId" class="lbldescription">Description</label>
                                <input id="descTextId" class="descriptionText" tabindex="1" type="text" name="description" title="Enter visually identifying description" value="Enter visually identifying description" onfocus="onFocusBehavior(this);" onblur="onBlurBehavior(this);" />
                        </li>
                </ul>

                <h3 id="hdrnotesId" class="hdrnotes">Notes</h3>

                <ul class="form">
                        <li id="notesListId" class="first last notesList">
                                <textarea id="notesId" class="text-area notes" tabindex="1" name="notes"></textarea>
                        </li>
                </ul>
</form> 
```

我通过序列化输入并发送 jquery ajax 请求来提交表单。当文本字段被聚焦时，我想禁用输入按钮上的表单提交

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:11:02.883

通过禁用回车键解决了这个问题

```
$('.descriptionText').bind('keypress', function (e){
        if(e.keyCode == 13){
            return false;
        }
        return true;
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-19T14:13:06.227

一个简单的解决方案是使用 `onsubmit="return false"`at form 标签，这样就不需要额外的 jQuery。

```
<form action="" data-ajax="false" method= "post" class="checkin-form" id="form1" onsubmit="return false"> 
```

但使用此方法时要小心，您应该像这样手动提交表单：

```
<input type="button" value="manual submit" onclick="document.getElementById('form1').submit()" /> 
```

关于您的代码，请注意建议使用 e.which 而不是 e.keycode

> [建议观看 event.which 进行键盘按键输入。](https://api.jquery.com/event.which/)

# android - 获取字符串的（Android.Graphics）路径

> ID：11451091
> 
> 赞同：5
> 
> 时间：2012-07-12T11:43:47.717
> 
> 标签：android, canvas, fonts, xamarin.android

我找不到任何方法来检索表示字符串的 Path 对象。它存在吗？必要点的列表就足够了，但我想，在内部，使用了一条路径。

例如在 GDI+ 中有：

```
GraphicsPath p = new GraphicsPath(); 
p.AddString("string"); 
```

从那里可以访问和修改“绘制的字符串”的任何点。

PS：我的意思不是沿着路径绘制文本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T22:53:15.307

我花了很长时间解决这个问题（在 OpenGL 中绘制矢量化文本）并且不得不深入挖掘 libSkia 源代码。结果很简单：

实际上，canvas 在内部使用路径，它使用 SkPaint 的`getTextPath()`方法将文本转换为矢量路径。幸运的是，它在公共 API 中的 Java 端公开为`android.graphics.Paint.getTextPath()`. 之后，您可以使用`android.graphics.PathMeasure`.

不幸的是，您无法阅读确切的绘图命令，但您可以使用类似二等分的方法对曲线进行非常接近的采样。

# c++ - UDP 服务器套接字缓冲区溢出

> ID：11451093
> 
> 赞同：6
> 
> 时间：2012-07-12T11:43:52.947
> 
> 标签：c++, linux, sockets, udp, buffer

我正在 Linux 上编写 C++ 应用程序。我的应用程序有一个 UDP 服务器，它在某些事件上向客户端发送数据。UDP 服务器还从客户端接收一些反馈/确认。

为了实现这个应用程序，我使用了一个 UDP 套接字（例如`int fdSocket`）来发送和接收来自所有客户端的数据。我将这个 socked 绑定到端口 8080 并将套接字设置为 NON_BLOCKING 模式。

我创建了两个线程。在一个线程中，我等待某个事件发生，如果发生事件，那么我使用 fdsocket 将数据发送到所有客户端（在 for 循环中）。

在另一个线程中，我使用`fdSocket`接收来自客户端的数据 ( `recvfrom()`)。该线程计划每 4 秒运行一次（即每 4 秒调用一次`recvfrom()`以从套接字缓冲区检索数据。由于它处于非阻塞模式，`recvfrom()`如果没有可用的 UDP 数据，该函数将立即返回，然后我会去睡眠 4 秒）。

来自所有客户端的 UDP 反馈/确认有一个固定的有效负载，其大小为 20 字节。

现在我有两个与此实现相关的问题：

1.  使用同一个套接字与多个客户端发送/接收 UDP 数据是否正确？
2.  如何找到我的应用程序在没有 UDP 套接字缓冲区溢出的情况下可以处理的最大 UDP 反馈/确认数据包数（因为我每 4 秒读取一次，如果我在这 4 秒内收到很多数据包，我可能会丢失一些数据包，即，我需要找到我可以安全处理的数据包/秒的速率）？

我尝试`fdsocket`使用函数调用获取我的套接字 ()的 Linux 套接字缓冲区大小`getsockopt(fdsocket,SOL_SOCKET,SO_RCVBUF,(void *)&n, &m);`。从这个函数中，我发现我的套接字缓冲区大小为 110592。但我不清楚这个套接字缓冲区中将存储哪些数据：它是否只存储 UDP 有效负载或整个 UDP 数据包或事件整个以太网数据包？我参考了这个[链接](http://www.6test.edu.cn/~lujx/linux_networking/index.html?page=0131777203_ch04lev1sec1.html)以获得一些想法，但感到困惑。

目前我的代码有点脏，我会尽快清理并在这里发布。

以下是我在发布此问题之前提到的链接。

1.  [Linux 网络](http://www.6test.edu.cn/~lujx/linux_networking/index.html?page=0131777203_ch04lev1sec1.html)
2.  [UDP SentTo 和 Recvfrom 最大缓冲区大小](https://stackoverflow.com/questions/3292281/udp-sendto-and-recvfrom-max-buffer-size)
3.  [UDP Socket 缓冲区溢出检测](https://stackoverflow.com/questions/8027758/udp-socket-buffer-overflow-detection)
4.  [UDP广播和单播通过同一个套接字？](https://stackoverflow.com/questions/800302/udp-broadcast-and-unicast-through-the-same-socket?rq=1)
5.  [在多个线程中从同一个 UDP 套接字发送](https://stackoverflow.com/questions/3460645/sending-from-the-same-udp-socket-in-multiple-threads?rq=1)
6.  [如何在 C 中刷新 UDP 套接字的输入缓冲区？](https://stackoverflow.com/questions/2299894/how-to-flush-input-buffer-of-an-udp-socket-in-c?rq=1)
7.  [如何找到linux的套接字缓冲区大小](https://stackoverflow.com/questions/7865069/how-to-find-the-socket-buffer-size-of-linux?rq=1)
8.  [如何获取 UDP 套接字的排队数据量？](https://stackoverflow.com/questions/9278189/how-do-i-get-amount-of-queued-data-for-udp-socket?rq=1)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:19:45.177

以四秒的固定间隔读取套接字肯定会让您丢失数据包。非阻塞 I/O 的传统可靠方法是解复用器系统调用[`select(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/select.2.html)// [`poll(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html)。[`epoll(7)`](http://www.kernel.org/doc/man-pages/online/pages/man4/epoll.4.html)看看您是否可以使用这些来捕获/响应您的其他事件。

另一方面，由于您已经在使用线程，您可以在没有四秒睡眠的情况下阻塞[recv(2) 。](http://www.kernel.org/doc/man-pages/online/pages/man2/recv.2.html)

阅读[史蒂文斯](http://books.google.com/books?id=ptSC4LpwGA0C&lpg=PP1&pg=PA207#v=onepage&q&f=false)的解释`SO_RCVBUF`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:17:25.173

问：使用同一个套接字与多个客户端发送/接收 UDP 数据是否正确？

A：是的，没错。

问：如何找到我的应用程序在没有 UDP 套接字缓冲区溢出的情况下可以处理的最大 UDP 反馈/确认数据包数（因为我每 4 秒读取一次，如果我在这 4 秒内收到很多数据包，我可能会丢失一些数据包，即，我需要找到速率：noofpackets/sec 我可以安全处理）？

答：瓶颈可能是网络带宽、CPU 或内存。您可以简单地进行测试，使用客户端向服务器发送连续编号的 ACK，并验证服务器是否存在丢包。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-12T12:21:29.150

您可以看到允许的最大缓冲区大小：

```
sysctl net.core.rmem_max 
```

您可以通过以下方式设置可以使用的最大缓冲区大小：

```
sysctl -w net.core.rmem_max=8388608 
```

您还可以通过使用 setsockopt 并更改 SO_RCVBUF 在运行时设置缓冲区大小（不超过上述最大值）。您可以通过查看 /proc/net/udp 查看缓冲区级别。

缓冲区用于存放UDP头和应用程序数据，其余属于较低级别。

# ruby-on-rails - Rails - CanCan HABTM 关联检查

> ID：11451094
> 
> 赞同：4
> 
> 时间：2012-07-12T11:44:04.610
> 
> 标签：ruby-on-rails, cancan

我的模型设置如下（联系人中的自关联，因为我想为经销商存储的信息反映了该表中的所有字段，似乎符合 DRY 以使用现有的数据结构）：

```
class Contact < ActiveRecord::Base
  attr_accessible :reseller_id
  has_and_belongs_to_many :users
  has_many :reseller_clients, :class_name => "Contact", :foreign_key => "reseller_id"
  belongs_to :reseller, :class_name => "Contact"
end

class User < ActiveRecord::Base
  attr:accessible :name
  has_and_belongs_to_many :contacts
end 
```

使用 cancan，我希望有一个能够管理自己联系人的经销商登录。用户和经销商之间的映射是HABTM，因此可以通过`can :manage Contact, :users => {:id => user.id}`以下方式实现。

我还希望经销商登录能够管理与 managed_accounts 在以下逻辑中描述的集合匹配的所有联系人：

```
reseller_contacts = user.contacts
managed_accounts = []
reseller_contacts.each do |i|
  managed_accounts << i.reseller_clients
end
managed_accounts.flatten! 
```

我目前的能力课程有：

```
class Ability
  include CanCan::Ability
  def initialize(user)
    if user.role? :reseller
      # Allow resellers to manage their own Contact
      can :manage, Contact, :users => {:id => user.id} # This works correctly at present
      # Allow resellers to manage their client Contacts
      can :manage, Contact, :reseller => {:users => {:id => user.id}} #This doesn't work
    end
  end
end 
```

我收到的错误如下：

```
Mysql2::Error: Unknown column 'contacts.users' in 'where clause': SELECT `contacts`.* FROM `contacts` INNER JOIN `contacts` `resellers_contacts` ON `resellers_contacts`.`id` = `contacts`.`reseller_id` INNER JOIN `contacts_users` ON `contacts_users`.`contact_id` = `resellers_contacts`.`id` INNER JOIN `users` ON `users`.`id` = `contacts_users`.`user_id` INNER JOIN `contacts_users` `users_contacts_join` ON `users_contacts_join`.`contact_id` = `contacts`.`id` INNER JOIN `users` `users_contacts` ON `users_contacts`.`id` = `users_contacts_join`.`user_id` WHERE ((`contacts`.`users` = '---\n:id: 6\n') OR (`users`.`id` = 6)) 
```

我对 cancan 的理解是，它会根据每个联系人检查允许和不允许的内容。如果我可以在一个块中做我想做的事情，它将如下所示（包括经销商自己的联系人和作为经销商客户的所有联系人）：

```
can :manage, Contact do |contact|
  user.contacts.exists?(contact.reseller_id) || user.contacts.exists?(contact.id)
end 
```

但是，我不能为此使用块，因为当尝试`@contacts = Contact.accessible_by(current_ability)`在控制器上的索引操作中使用时，我得到：

```
The accessible_by call cannot be used with a block 'can' definition. The SQL cannot be determined for :index Contact(id: integer, first_name: string, last_name: string, postal_addr_line_1: string, postal_addr_line_2: string, postal_addr_line_3: string, postal_addr_city: string, postal_addr_post_code: string, postal_addr_country: string, billing_addr_line_1: string, billing_addr_line_2: string, billing_addr_line_3: string, billing_addr_city: string, billing_addr_post_code: string, billing_addr_country: string, contact_email: string, company_name: string, phone_home: string, phone_work: string, phone_mobile: string, split_bills: boolean, created_at: datetime, updated_at: datetime, reseller_id: integer) 
```

## 编辑：

几乎解决了，现在我只是有一个组合能力的问题：

我将能力模型的工作部分更改为：

```
reseller_contacts = user.contacts
managed_accounts = []
reseller_contacts.each do |i|
  i.reseller_clients.each do |rc|
    managed_accounts << rc.id
  end
end

can :manage, Contact, :id => managed_accounts
can :manage, Contact, :users => {:id => user.id}
can :create, Contact 
```

现在唯一的问题是第一`can :manage`行被第二行覆盖。我的印象是它们应该是附加的，而不是替代的。需要更多的研究，但我认为这个问题本身已由上述解决。现在我需要弄清楚如何使两条`can :manage`线都适用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T21:40:00.230

**2015-03-26 编辑**

注意到这个问题/答案引起了一些关注，我想我应该指出我从那以后找到的更好的方法。

创建 has_one/has_many 关联时，rails 分别创建`foreign_model_id`/`foreign_model_ids`方法。这些方法分别返回一个整数或整数数组。

这意味着`ability.rb`可以简化文件中的条目而不是下面的答案，而不必使用那种丑陋的逻辑来创建我自己的对象数组并遍历它们以：

`can :manage, Contact, id: (user.contact_ids + user.reseller_client_ids)`

**以前的答案留给后代**

通过在我的 Ability.rb 文件中使用它来修复：

```
# Manage all contacts associated to this reseller
reseller_contacts = user.contacts
managed_contacts = []
reseller_contacts.each do |i|
  i.reseller_clients.each do |rc|
    managed_contacts << rc.id
  end
  managed_contacts << i.id
end

can :manage, Contact, :id => managed_contacts 
```

Deefour，感谢您一路上的帮助，不要以为没有您的评论我就不会到达那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:57:58.387

*我认为你仍然没有尽可能清楚地表达你的要求*

> ...经销商自己的联系人的 id

*`:reseller`a 的是`Contact`另一个`Contact`。中没有`:contact`属性`Contact`。当您应该指代**用户**（来自`CanCan`类）以避免与`Contact`类的`:reseller`关联混淆时，您可能会通过引用“经销商角色”和“经销商”来使事情变得混乱）*。

我会假设

> 经销商角色，以便能够管理所有将 reseller_id 字段设置为经销商自己的联系人 ID 的联系人。

意思是

> `user`可以管理一些联系人在`Contact` `c`哪里`c.reseller_id``user_id``user.contacts`

假设这是一个准确的解释：

```
can :manage, Contact do |c|
  user.contacts.where(:user_id => c.reseller_id)
end 
```

# c# - .ToUpper() 是如何工作的？

> ID：11451095
> 
> 赞同：6
> 
> 时间：2012-07-12T11:44:09.823
> 
> 标签：c#, .net

我只是好奇 .ToUpper() 是如何工作的？是否存在某种映射，较低的 a 具有 UTF 代码 XYZ，而较高的 a 具有 UTF 代码 XYZ1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:54:41.907

是的，它使用了 Unicode 元数据。每个字符（Unicode 代码点）都有一个大小写以及大小写（和标题大小写）的大小写映射。.NET 使用此信息将字符串转换为大写或小写。您可以在[Unicode 字符数据库](http://www.unicode.org/ucd/)中找到完全相同的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T11:51:58.333

[String.ToUpper](http://msdn.microsoft.com/en-us/library/ewdd6aed.aspx)只使用`CurrentCulture`in 核心。

形成`String.ToUpper()`from的反汇编版本`mscorelib.dll`，可以看到：

```
public string ToUpper(CultureInfo culture)
{
    if (culture == null)
    {
        throw new ArgumentNullException("culture");
    }
    return culture.TextInfo.ToUpper(this);
} 
```

所以这取决于你*现在*的文化。它总是有一个合适的过载，您可以在其中指定替代文化。

**编辑**

在内部，它在最后以其*本机*实现调用`nativeChangeCaseString`函数。它是如何在内部实现的，我不知道，因为它可以由开发它的人来回答。

 *正如@Tim 所建议的，添加一个链接到

[TextInfo.ToUpper](http://msdn.microsoft.com/en-us/library/fsc2y169)提供有关主题的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T11:53:46.123

之前在 StackOverflow 上（以一种迂回的方式）问过这个问题。当然，这不是关于 C# 或 .NET，而是回答了这个问题的 Unicode 部分。

[如何在 Unicode 中将字符串设置为大写/小写？](https://stackoverflow.com/questions/297703/how-do-you-set-strings-to-uppercase-lowercase-in-unicode)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:32:12.360

如果您对 ToUpper() 实现的设计方面感兴趣，可以参考以下部分：

*   来自 Gang of Four 设计模式目录的 FlyWeight 设计模式用于处理与字符相关的功能
*   根据这种设计模式，集合中的每个单元都被设计为具有定义行为的对象，最终对象是较小单元的集合
*   在 String 的情况下 - 给定的 String 实际上是作为字符数组处理的，其中每个字符都是具有定义行为的对象
*   当我们调用 ToUpper() 时采用这种设计模式，它会迭代字符串的字符并在内部将调用委托给每个字符。在字符上调用 ToUpper 时，String 类还传递了 Locale 的引用，其中包含字符映射和编码的详细信息

如果您对实际实现感兴趣，那么您可以参考 Java 语言的 java.lang.String 类部分的开源实现 - 这相当于 C# 字符串实用程序类。

以下是您可以找到 java.lang.String 类的源代码的链接 - 有 2 个重载方法：toUpper() 和 toUpper(Locale)。在内部 toUpper() 使用默认语言环境调用 toUpper(Locale) ，因此您会对第二种方法感兴趣。

[http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/String.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/String.java)

希望这些信息有所帮助。*

# jpa - JPA @NamedNativeQuery sql 具有动态排序和列名

> ID：11451098
> 
> 赞同：0
> 
> 时间：2012-07-12T11:44:15.347
> 
> 标签：jpa, jpa-2.0, named-query

这是我的 NamedNativeQuery：

```
SELECT * FROM ( SELECT ROWNUMBER() OVER(ORDER BY CMSSCODE DESC) AS EL_ROWNM ,
CMSSCODE , CMSSDESC FROM tableName d WHERE CMSPCODE = ? ) a
WHERE a.EL_ROWNM    < ? and a.EL_ROWNM > ? 
```

我需要以动态方式创建顺序，所以我的 sql 将类似于：

```
SELECT * FROM ( SELECT ROWNUMBER() OVER(ORDER BY ? ?) .... 
```

因此，在第一个参数中，`?`我将使用从用户那里获得的列名，在第二个参数中，`?`我将使用`ASC`或`DESC`根据我从用户那里获得的信息。

如何在 NamedNativeQuery 中进行动态排序？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:37:16.057

不它不是。

使用动态查询而不是命名查询。

# python - 使用 pyodbc 从 SQL 中检索数据

> ID：11451101
> 
> 赞同：58
> 
> 时间：2012-07-12T11:44:22.727
> 
> 标签：python, sql, sql-server, pyodbc

我正在尝试使用 pyodbc 从 SQL 服务器检索数据并使用 Python 将其打印在表中。但是，我似乎只能检索列名和数据类型之类的东西，而不是列的每一行中的实际数据值。

基本上我正在尝试复制一个检索服务器数据并将其显示在表格中的 Excel 工作表。我连接到服务器没有任何问题，只是我似乎无法找到进入表的实际数据。

这是我的代码示例：

```
import pyodbc
cnxn = pyodbc.connect('DRIVER={SQL Server};SERVER=SQLSRV01;DATABASE=DATABASE;UID=USER;PWD=PASSWORD')
cursor = cnxn.cursor()

cursor.execute("SELECT * FROM sys.tables")
tables = cursor.fetchall()
#cursor.execute("SELECT WORK_ORDER.TYPE,WORK_ORDER.STATUS, WORK_ORDER.BASE_ID, WORK_ORDER.LOT_ID FROM WORK_ORDER")

for row in cursor.columns(table='WORK_ORDER'):
    print row.column_name
    for field in row:
        print field 
```

然而，这样做的结果只是给了我诸如表名、列名、一些整数和“无”之类的东西，我不感兴趣：

```
STATUS_EFF_DATE
DATABASE
dbo
WORK_ORDER
STATUS_EFF_DATE
93
datetime
23
16
3
None
0
None
None
9
3
None
80
NO
61 
```

所以我不确定我在哪里可以得到值来填满我的表。它应该在 table='WORK_ORDER' 中，但它可以在不同的表名下吗？有没有办法打印我刚刚丢失的数据？

任何意见或建议将不胜感激。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-12T12:28:23.300

你是如此接近！

```
import pyodbc
cnxn = pyodbc.connect('DRIVER={SQL Server};SERVER=SQLSRV01;DATABASE=DATABASE;UID=USER;PWD=PASSWORD')
cursor = cnxn.cursor()

cursor.execute("SELECT WORK_ORDER.TYPE,WORK_ORDER.STATUS, WORK_ORDER.BASE_ID, WORK_ORDER.LOT_ID FROM WORK_ORDER")
for row in cursor.fetchall():
    print row 
```

（“columns()”函数收集有关命名表中列的元数据，而不是实际数据）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-12T12:00:34.603

为了接收存储在表中的实际数据，您应该使用 fetch...() 函数之一或将游标用作迭代器（即“for row in cursor”...）。这在[文档](http://code.google.com/p/pyodbc/wiki/GettingStarted)中有所描述：

```
cursor.execute("select user_id, user_name from users where user_id < 100")
rows = cursor.fetchall()
for row in rows:
    print row.user_id, row.user_name 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-04-04T20:22:52.523

您可以尝试使用 Pandas 检索信息并将其作为数据框获取

```
import pyodbc as cnn
import pandas as pd

cnxn = pyodbc.connect('DRIVER={SQL Server};SERVER=SQLSRV01;DATABASE=DATABASE;UID=USER;PWD=PASSWORD')

# Copy to Clipboard for paste in Excel sheet
def copia (argumento):
    df=pd.DataFrame(argumento)
    df.to_clipboard(index=False,header=True)

tableResult = pd.read_sql("SELECT * FROM YOURTABLE", cnxn) 

# Copy to Clipboard
copia(tableResult)

# Or create a Excel file with the results
df=pd.DataFrame(tableResult)
df.to_excel("FileExample.xlsx",sheet_name='Results') 
```

我希望这有帮助！干杯!

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-07-06T23:18:35.407

不要使用 pyodbc 库，而是使用 pypyodbc 库......这对我有用。

```
import pypyodbc

conn = pypyodbc.connect("DRIVER={SQL Server};"
                    "SERVER=server;"
                    "DATABASE=database;"
                    "Trusted_Connection=yes;")

cursor = conn.cursor()
cursor.execute('SELECT * FROM [table]')

for row in cursor:
    print('row = %r' % (row,)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-12-23T12:38:04.807

只需这样做：

```
import pandas as pd
import pyodbc

cnxn = pyodbc.connect("Driver={SQL Server}\
                    ;Server=SERVER_NAME\
                    ;Database=DATABASE_NAME\
                    ;Trusted_Connection=yes")

df = pd.read_sql("SELECT * FROM myTableName", cnxn) 
df.head() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-08T04:39:05.403

赞成的答案对我不起作用，它通过如下编辑连接线来修复（**用逗号替换分号并删除那些引号**）：

```
import pyodbc
cnxn = pyodbc.connect(DRIVER='{SQL Server}',SERVER=SQLSRV01,DATABASE=DATABASE,UID=USER,PWD=PASSWORD)
cursor = cnxn.cursor()

cursor.execute("SELECT WORK_ORDER.TYPE,WORK_ORDER.STATUS, WORK_ORDER.BASE_ID, WORK_ORDER.LOT_ID FROM WORK_ORDER")
for row in cursor.fetchall():
    print row 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-11-12T13:31:35.907

```
import pyodbc
conn = pyodbc.connect('Driver={SQL Server};'
                  'Server=db-server;'
                  'Database=db;'
                  'Trusted_Connection=yes;')
sql = "SELECT * FROM [mytable] "
cursor.execute(sql)
for r in cursor:
    print(r) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-22T07:23:10.807

为什么`pyodbc`你可以尝试使用`pymssql`. 有关更多信息，请点击此链接：[https](https://stackoverflow.com/a/70445445/8614314) ://stackoverflow.com/a/70445445/8614314 。

```
import pandas as pd
import pymssql

con = pymssql.connect(<conncetion to the server and db>)
cursor = con.cursor()
query = "<Your query>"
cursor.execute(query)
df = pd.read_sql(query, con)
con.close() 
```

# eclipse - 无法从 Eclipse 启动 JBoss

> ID：11451102
> 
> 赞同：1
> 
> 时间：2012-07-12T11:44:25.893
> 
> 标签：eclipse, jboss7.x

我在 Linux 上使用 Eclipse 和 JBoss AS 7.1.1 进行开发。我已经安装了 JBoss 工具，所以我可以从 Eclipse 部署到 JBoss。

现在我遇到了一个问题，JBoss 服务器不会从 Eclipse 启动（运行/调试）。我得到的信息是：`Reference to undefined variable PATH`。

这对我来说根本没有意义。服务器日志中没有任何内容，当我从控制台运行 eclipse 时，唯一的输出是：

```
Jul 12, 2012 1:38:55 PM org.xnio.Xnio <clinit>
INFO: XNIO Version 3.0.3.GA
Jul 12, 2012 1:38:56 PM org.xnio.nio.NioXnio <clinit>
INFO: XNIO NIO Implementation Version 3.0.3.GA
Jul 12, 2012 1:38:56 PM org.jboss.remoting3.EndpointImpl <clinit>
INFO: JBoss Remoting version 3.2.3.GA 
```

我认为错误发生在我在 JBoss 运行时关闭 Eclipse 之后。

从命令行启动 JBoss 没有问题，eclipse 甚至可以通过这种方式连接到它。如果 Eclipse 连接到 JBoss 它可以关闭它，所以问题纯粹是服务器的启动。

我尝试过干净的 JBoss 安装，但存在同样的问题。

更新：我尝试使用干净的工作区和干净的配置目录（~/.eclipse），重新安装了 JBoss 工具并遇到了同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T13:02:20.957

我通过重新启动计算机解决了我的问题。为什么我一开始没有这样做？问题在重新启动后立即出现。

我尝试了几件事，然后我发现当我以 root 身份运行 Eclipse 时问题不存在。当然，我认为这是与权限相关的问题，所以我将所有权更改`/usr/lib/eclipse-3.7/`为我的用户。这没有帮助。在尝试了一切之后，我重新启动了，这以某种方式成功了。

编辑：

我最近又遇到了这个问题，我终于找到了这个问题。问题来自设置在`/etc/env.d/`. 其中一个文件违反了以下规则：

> 定义其他变量时不能使用 shell 变量。这意味着像 FOO="$BAR" （其中 $BAR 是另一个变量）之类的东西是被禁止的。

结果被`$PATH`设置在`PATH`环境变量中，`PATH=/usr/bin/:$PATH`这当然是错误的。

# linux - 使用 xgettext 递归扫描文件

> ID：11451105
> 
> 赞同：10
> 
> 时间：2012-07-12T11:44:40.387
> 
> 标签：linux, localization, xgettext

我需要递归扫描项目中的所有文件夹以查找 xgettext 字符串。如何在 Linux 上使用 xgettext 来做到这一点？

我当前的参数是：--default-domain=project -k_

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-12T11:51:16.343

```
find . -iname "*.php" | xargs xgettext --from-code=UTF-8 --default-domain=project 
```

这应该可以解决问题。

# windows-phone-7 - 访问 isolotedstorage WP7 时出错

> ID：11451108
> 
> 赞同：0
> 
> 时间：2012-07-12T11:44:55.160
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone, isolatedstorage

我正在尝试通过这个从图片中心加载图像......

```
void photoChooser_Completed(object sender, PhotoResult e)
    {           
        try
        {
            var imageVar = new BitmapImage();
            imageVar.SetSource(e.ChosenPhoto);           
            var b = new WriteableBitmap(imageVar.PixelWidth, imageVar.PixelHeight);
            b.LoadJpeg(toStream(imageVar));//here comes the exception
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }

    }

Stream toStream(BitmapImage img) 
    {
        WriteableBitmap bmp = new WriteableBitmap((BitmapSource)img);

        using (MemoryStream stream = new MemoryStream())
        {

            bmp.SaveJpeg(stream, bmp.PixelWidth, bmp.PixelHeight, 0, 100);
            return stream;
        }
    } 
```

访问isolotedstorage**时发生错误**。请帮忙 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:35:54.907

如果我理解正确，您正在尝试：

1.  从选择器（流）中获取图像
2.  创建位图对象
3.  将其写入另一个流
4.  从第二个流创建一个 WriteableBitmap

这非常令人费解。您所要做的就是：

```
var imageVar = new BitmapImage();
imageVar.SetSource(e.ChosenPhoto);           
var b = new WriteableBitmap(imageVar.PixelWidth, imageVar.PixelHeight);
b.SetSource(e.ChosenPhoto); 
```

这将为您提供照片，但请记住，如果您首先使用 SetSource 方法创建 BitmapImage，它将限制您的照片大小小于 2000x2000。然后 WriteableBitmap 也将是那个更小、更小的尺寸。

如果您希望使用 LoadJpeg 方法创建一个全尺寸的 WriteableBitmap，您需要这样做：

```
//DO SOMETHING TO GET THE PIXEL WIDTH AND PIXEL HEIGHT OF PICTURE BASED JUST ON THE STREAM, FOR EXAMPLE USE EXIF READER: http://igrali.com/2011/11/01/reading-and-displaying-exif-photo-data-on-windows-phone/ OR SEE MORE ABOUT LOADING A LARGE PHOTO HERE: http://igrali.com/2012/01/03/how-to-open-and-work-with-large-photos-on-windows-phone/          
var b = new WriteableBitmap(PixelWidth, PixelHeight);
b.LoadJpeg(e.ChosenPhoto); 
```

这将为您加载全尺寸的JPEG。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T05:05:31.157

您使用的代码看起来不错！

```
void photoChooser_Completed(object sender, PhotoResult e)
{           
    try
    {
        var imageVar = new BitmapImage();
        imageVar.SetSource(e.ChosenPhoto);           
        var b = new WriteableBitmap(imageVar.PixelWidth, imageVar.PixelHeight);
        b.LoadJpeg(toStream(imageVar));//here comes the exception
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

} 
```

Stream toStream(BitmapImage img) { WriteableBitmap bmp = new WriteableBitmap((BitmapSource)img);

```
 using (MemoryStream stream = new MemoryStream())
    {

        bmp.SaveJpeg(stream, bmp.PixelWidth, bmp.PixelHeight, 0, 100);
        return stream;
    }
} 
```

尝试重新连接 USB ！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:17:01.310

您没有指定获取图像后要执行的操作。如果您只想在应用程序中显示图像，那么您可以遵循以下代码：

在您的尝试块中，只需添加此

```
var imageVar = new BitmapImage();
imageVar.SetSource(e.ChosenPhoto);
Image img = new Image();
img.Source = imageVar;
this.ContentPanel.Children.Add(img); 
```

# java - 基于 '=' 解析命令行参数

> ID：11451109
> 
> 赞同：3
> 
> 时间：2012-07-12T11:44:56.437
> 
> 标签：java, command-line-arguments, apache-commons-cli

我正在使用[apache commons.cli](http://commons.apache.org/cli/)库来解析命令行参数。默认的解析行为是它基于空格解析参数。我正在使用 ant 将参数传递给我的 Java 程序，而 ant 使用的语法略有不同，并且使用`=`的是空格而不是空格。如何更改基于 `=` 而不是空间解析的解析行为？我的解析目前看起来像这样：

```
 Options options = new Options();
    options.addOption("Dkey", true, "some parameter");
    CommandLineParser parser = new PosixParser();
    CommandLine cmd = parser.parse(options, args); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:14:47.183

查看[使用示例页面](http://commons.apache.org/cli/usage.html)，尤其是 Ant 示例。

您可以使用`OptionBuilder`and 创建一个`D`具有 2 个参数的选项。

对于您的情况，该页面的改编示例可能如下所示：

```
Option property  = OptionBuilder.withArgName( "key=value" )
                            .hasArgs(2)
                            .withValueSeparator()
                            .withDescription( "use value for given property" )
                            .create( "D" ); 
```

这是相关的 JavaDoc 和另一个示例：[http ://commons.apache.org/cli/api-1.2/org/apache/commons/cli/OptionBuilder.html#withValueSeparator%28%29](http://commons.apache.org/cli/api-1.2/org/apache/commons/cli/OptionBuilder.html#withValueSeparator%28%29)

```
Option opt = OptionBuilder.withValueSeparator().create('D');

CommandLine line = parser.parse(args);
String propertyName = opt.getValue(0);
String propertyValue = opt.getValue(1); 
```

# c# - 无法保存对上下文的更改

> ID：11451110
> 
> 赞同：1
> 
> 时间：2012-07-12T11:44:57.357
> 
> 标签：c#, asp.net-mvc

有人可以帮忙吗？

我的控制器中有创建操作：

```
 public class MovieController : Controller
  {
      Connect connection = new Connect();
      Movie movie = new Movie();

      [HttpPost]
      public ActionResult Create(Movie moviecreated)
      {
        try
        {
            // TODO: Add insert logic here
            connection.Connection().AddObject(moviecreated);
            connection.Connection().Context.SaveChanges();
            return RedirectToAction("Index");
        }
        catch
        {
            return View(movie);
        }
       }
    } 
```

我的连接类

```
public class Connect
{
    public ObjectSet<Movie> Connection() 
    { 
        var connStr = ConfigurationManager.ConnectionStrings["Entities"]; 
        ObjectContext context = new ObjectContext(connStr.ConnectionString); 
        var movieContext = context.CreateObjectSet<Movie>(); 
        return movieContext; 
    } 
 } 
```

它没有保存新添加的内容，我做错了什么？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:36:25.370

每次调用 connection() 时，它都会创建另一个实例。一旦添加新记录 another ，您将尝试保存但不同的上下文。将其更改为属性并保存您的上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:46:22.417

尝试这个：

```
public class MovieController : Controller
{
  private Connect connection;
  private Movie movie;

  public MovieController() 
  {
       this.connection = new Connect();
       this.movie = new Movie();
  }

  [HttpPost]
  public ActionResult Create(Movie moviecreated)
  {
    try
    {
        // TODO: Add insert logic here
        this.connection.MovieContext.AddObject(moviecreated);
        this.connection.MovieContext.Context.SaveChanges();
        return RedirectToAction("Index");
    }
    catch
    {
        return View(movie);
    }
   }
}

public class Connect
{
    private ObjectSet<Movie> movieContext;

    public ObjectSet<Movie> MovieContext 
    {
        get
        {
            if (this.movieContext == null) 
            { 
                this.SetMovieContext(); 
            }

            return this.movieContext;
        }
    }

    public void SetMovieContext() 
    { 
        var connStr = ConfigurationManager.ConnectionStrings["Entities"]; 
        var context = new ObjectContext(connStr.ConnectionString); 
        this.movieContext = context.CreateObjectSet<Movie>(); 
    } 
} 
```

# sql - 多对多清理

> ID：11451111
> 
> 赞同：1
> 
> 时间：2012-07-12T11:45:00.227
> 
> 标签：sql, sql-server-2008

我有一个多对多表已经变得有点混乱，我正在寻找更新架构以防止将来发生这种情况。为此，我首先需要清理现有数据以用作合并脚本的源。不知道如何定义这种命中 Google 的查询并没有真正的帮助。

简单地分解一下，这就是我正在查看的内容以及我想要提取的内容。

```
DECLARE @TestTable
TABLE ([IdA] INT, [IdB] INT);

DECLARE @Expected
TABLE ([KeyId] INT, [MemberId] INT);

INSERT INTO @TestTable
VALUES
    (1, 2),
    (2, 1),
    (1, 3),
    (4, 1),
    (12, 4),

    (5, 6),
    (6, 7),

    (8, 9),

    (11, 10)

INSERT INTO @Expected
VALUES
    (1, 1),
    (1, 2),
    (1, 3),
    (1, 4),
    (1, 12),

    (5, 5),
    (5, 6),
    (5, 7),

    (8, 8),
    (8, 9),

    (10, 10),
    (10, 11) 
```

*   组的最低 ID 应被视为关键
*   组的成员数将始终小于 20
*   只要结果数据集正确，排序并不重要

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:52:00.800

这是实现您想要做的事情的一种方法：

这是一个[SQLFiddle](http://www.sqlfiddle.com/#!3/d41d8/2518)

```
--Let's copy the rows in as they are to begin with
INSERT INTO 
  @Expected
SELECT
   [IdA]
  ,[IdB]
FROM 
  @TestTable

--Lets switch the column values where the higher ID's are in column B  
UPDATE @Expected
SET [KeyId] = [MemberId], [MemberId] = [KeyId]  
WHERE [KeyId] > [MemberId]

--Now lets set the KEY IDs
UPDATE
  E
SET
  E.[KeyId] = E1.[KeyId]
FROM
  @Expected E
INNER JOIN
  @Expected E1 
ON
  E1.[MemberId] = E.[KeyId]

--and you wanted mappings for the keys to themselves in your result set, so let's add those
INSERT INTO
  @Expected
SELECT
  [KeyId]
 ,[KeyId]
FROM
  @Expected E 
WHERE NOT EXISTS
  (SELECT * FROM @Expected WHERE [KeyId] = E.[KeyId] AND [MemberId] = [KeyID])

SELECT DISTINCT 
  * 
FROM 
  @Expected 
```

请注意，我最后选择了 DISTINCT，因为我没有从结果集中删除重复项。

# .net - 为什么我的 TransactionScope 在 EF Code First 应用程序中使用时尝试使用 MSDTC？

> ID：11451112
> 
> 赞同：6
> 
> 时间：2012-07-12T11:45:00.407
> 
> 标签：.net, entity-framework, transactionscope

我刚刚针对 SQL 2010 Express 本地数据库，使用 EF 4.3 Code First 向 MVC3 应用程序介绍了 TransactionScope 的使用。当我在范围内尝试 SaveChanges 时，我收到“Provider failed to open”通知，内部异常是关于缺少 MSDTC。据我所知，只有当我使用多个连接字符串时才会发生这种情况。我只使用到一个数据库的连接，我在应用程序中只有 1 个字符串。但是，我确实使用了几个 DbContext 实例，但在事务范围内只使用了一个。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-27T03:30:01.860

不知道是不是和这个帖子一样？ [如何在没有 MSDTC 的情况下在 TransactionScope 中运行两个实体框架上下文？](https://stackoverflow.com/questions/2370434/how-to-run-two-entity-framework-contexts-inside-transactionscope-without-msdtc/19042213#19042213)

解决方法是：

0) 创建可推广事务（取决于 SQL 服务器版本？）（[http://msdn.microsoft.com/en-us/library/ms172070.aspx](http://msdn.microsoft.com/en-us/library/ms172070.aspx)）

1）实体框架 - MSDTC Gotchya（[http://joeknowsdotnet.wordpress.com/2012/07/19/entity-framework-msdtc-gotchya/](http://joeknowsdotnet.wordpress.com/2012/07/19/entity-framework-msdtc-gotchya/)）

2）避免不必要的分布式事务升级（[http://petermeinl.wordpress.com/2011/03/13/avoiding-unwanted-escalation-to-distributed-transactions/](http://petermeinl.wordpress.com/2011/03/13/avoiding-unwanted-escalation-to-distributed-transactions/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T13:06:36.927

The first time your application makes a call to EF it will do the initialization (it will build the db if it doesn't exist etc.) If this first call is inside a TransactionScope it will promote to DTC.

To fix this, make a call to EF in your app startup method and this will ensure that EF will be initialized outside of the TransactionScope. From here on in you can include one or more calls to EF inside a TransactionScope and it won't promote to DTC providing: a) You always use EXACTLY the same connection string, and b) You are using Sql Server 2008 and above (which you are).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T11:52:03.397

我认为，如果您有一个事务范围并打开两个单独的连接，即使它们使用相同的连接字符串连接到相同的数据库，您也会发现该事务将被提升为分布式事务。

[http://www.bomisofmab.com/blog/?p=184](http://www.bomisofmab.com/blog/?p=184)充分描述了这种情况。

# wpf - 我应该如何将属性值从视图传递到 MVVM 中的模型？

> ID：11451114
> 
> 赞同：0
> 
> 时间：2012-07-12T11:45:06.837
> 
> 标签：wpf, mvvm, view, viewmodel

我有三门课，首先：

```
public class Setting 
```

它具有以下属性：

```
string ID, string Value; (implements INotifyPropertyChanged on Value) 
```

第二：

```
public class SettingCollection 
```

这是一个：

```
ObservableCollection<Setting> 
```

第三：

```
public class SimObject 
```

它具有以下属性：

```
string ID, SettingsCollection Settings; 
```

我有一个视图：SettingsDisplay.xaml，它具有依赖属性：

```
SettingsCollection SimObjSettings; 
```

并在 ItemsContainer 内的 TextBox 中显示设置的 ID 及其值。

我的 MainWindow ViewModel 有一个 SimObject Jeff；在我的视图中

```
<local:SettingsDisplay SimObjSettings="{Binding Jeff.Settings}"/> 
```

这一切都很好。

我需要知道何时发生`Setting` `Value`更改以及何时发生更改，我需要知道`Setting`所属的 SimObject ID，以便我可以调用一个方法来发送带有`Setting` `ID`和`Value`的事件`SimObject` `ID`。（例如`SendEvent(settingID, settingValue, targetObject)`）

显然`Setting`'s 和`SettingCollection`'s 不知道`SimObject`它们属于什么。

我尝试这样做的方法是在Value 属性的 Setter中的`Setting`类调用中。`SendEvent`

我正在努力寻找一种合适的方式将`SimObject`'传递`ID`给`Setting`' 类，我也不认为这是一个好的解决方案。

实现我想要做的事情的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:15:00.370

我最终通过提供所有`Setting`'sa属性（即设置的 SimObject 所有者）并 在以下`SimObject`位置创建事件处理程序来解决此问题：`delegate void SettingHandler(string settingID, string settingValue, string targetObj);``SimObject``public event SettingHandler SettingChanged;`

```
public void RaiseSettingChangedEvent(string settingId, string settingValue, string targetObj)
{
    if (SettingChanged != null)
    {
        SettingChanged(settingId, settingValue, targetObj);
    }
} 
```

在二传手`Setting`：`string Value`

```
set
{
   _value = value;
   RaisePropertyChanged("Value");
   SimObject.RaiseSettingChangedEvent(ID, Value, SimObject.Settings["UID"].Value);
} 
```

然后在`SettingsDisplay`我创建了一个 SelectedPropertyChangedCallback 它将`ParameterChanged`事件添加到`SimObject`并且还包含`SettingChanged`方法：

```
public void SettingChanged(string settingID, string settingValue, string targetObj)
{
    Framework.GetBusinessDelegate().SendEvent(settingID, settingValue, targetObj);
} 
```

不知道如何添加语法突出显示以使此答案更清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:03:00.523

有很多方法可以做到这一点，但显然所有这些方法都涉及到有人观察`SettingsCollection` *并*动态地将处理程序附加/分离`PropertyChanged`到其中的所有项目（至少这对我来说是您的要求）。

我会争辩说，如果您想要的只是无条件的实时更新，那么您根本不应该在其中涉及 Views 和 ViewModels。简单地写一个这样的实现：

```
interface ISimObjLiveUpdateService
{
    void StartObserving(SimObject o);
    bool IsObserving(SimObject o);
    bool StopObserving(SimObject o);
} 
```

实际的实现将连接到观察`o.SettingsCollection`和其中的所有项目。在你显示`SimObject`你`StartObserving`它之前，当你关闭视图时你`StopObserving`它。

# java - Java 蔚来。SocketChannel.read 方法总是返回 0。为什么？

> ID：11451118
> 
> 赞同：2
> 
> 时间：2012-07-12T11:45:22.480
> 
> 标签：java, sockets, nio, socketchannel

我尝试了解 java NIO 的工作原理。特别是 SocketChannel 的工作原理。

我在下面写了代码：

```
import java.io.*;
import java.net.*;
import java.nio.*;
import java.nio.channels.*;

public class Test {

    public static void main(String[] args) throws IOException {

        SocketChannel socketChannel = SocketChannel.open();
        socketChannel.configureBlocking(false);
        socketChannel.connect(new InetSocketAddress("google.com", 80));

        while (!socketChannel.finishConnect()) {
            // wait, or do something else...
        }

        String newData = "Some String...";

        ByteBuffer buf = ByteBuffer.allocate(48);
        buf.clear();
        buf.put(newData.getBytes());

        buf.flip();

        while (buf.hasRemaining()) {
            System.out.println(socketChannel.write(buf));
        }

        buf.clear().flip();

        int bytesRead;

        while ((bytesRead = socketChannel.read(buf)) != -1) {

            System.out.println(bytesRead);

        }

    }

} 
```

1.  我尝试连接到谷歌服务器。
2.  向服务器发送请求；
3.  从服务器读取答案。

但是，方法 socketChannel.read(buf) 始终返回 0 并无限执行。

我哪里做错了？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T11:47:07.913

因为`NIO SocektChannel`在数据可供读取之前不会阻塞。即，非阻塞通道可以`return 0 on read() operation`。

这就是为什么在使用 NIO 时您应该使用[java.nio.channels.Selector](https://docs.oracle.com/javase/10/docs/api/java/nio/channels/Selector.html)如果数据可用，它会在通道上为您提供读取通知。

另一方面，阻塞通道将等到数据可用并返回有多少数据可用。即，阻塞通道永远不会`return 0 on read() operation`。

**您可以在此处阅读有关 NIO 的更多信息：**

*   [http://tutorials.jenkov.com/java-nio/index.html](http://tutorials.jenkov.com/java-nio/index.html)
*   [http://java.sun.com/developer/technicalArticles/releases/nio/](http://java.sun.com/developer/technicalArticles/releases/nio/)
*   [https://www.ibm.com/developerworks/java/tutorials/j-nio/section2.html](https://www.ibm.com/developerworks/java/tutorials/j-nio/section2.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-12T12:21:51.847

你已经专门配置了

```
socketChannel.configureBlocking(false); 
```

如果您保留了默认*的阻塞*，那么您将永远不会返回 0 的长度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T13:32:54.327

在阅读标题时，我在说： b/c 缓冲区中没有空间：

与迄今为止的答案不同，真正的罪魁祸首是 `buf.clear().flip();`这样有效地设置缓冲区`position=limit=0`- 因此没有读取数据 - 更改为`buf.clear()`并且你很高兴。

在发布问题之前，与 NIO 一起玩得开心并使用调试器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T14:22:06.270

如果你真的想使用非阻塞 I/O，那么要么使用选择器，要么使用 Java 7 中的 nio2（AsynchronousSocketChannel 等）。使用选择器很棘手，最好找到现成的工作示例。使用 nio2 相对容易。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-08-08T19:20:33.563

技术解释是您没有向谷歌网络服务器发送完整的 HTTP 请求，因此在收到完整的请求之前它不会向您发送回复。

这解释了为什么您正在读取 0 字节，这意味着没有数据可供读取。

# java - 这 2 次 Spring IOC 注入有什么区别？

> ID：11451125
> 
> 赞同：6
> 
> 时间：2012-07-12T11:46:05.433
> 
> 标签：java, spring

这2次注射有什么区别？

```
@Autowired
private DocumentDAO documentDao;

@Resource(name = "documentDao")
private DocumentDAO documentDao; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-12T11:48:50.287

简单地说，@Autowired（Spring 中的规范）按类型连接，@Resource（JSR-250 中的规范）按名称连接。

但是，@Autowired 和 @Qualifier 也可以按名称自动装配为 @Resource。

请查看以下链接：

[@Autowire](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-autowired-annotation)

[@资源](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-resource-annotation)

[带有@Resource、@Autowired 和@Inject 的@Spring 注入](http://blogs.sourceallies.com/2011/08/spring-injection-with-resource-and-autowired/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T11:56:25.323

默认情况下`@Autowire`，“按类型”注入依赖项。`@Qualifier`但它也可以结合`@Autowire`注释使用“按名称”注入依赖项。

但关键区别在于它`@Autowired`是一个弹簧注释，而`@Resource`由 JSR-250 指定。所以`@Resource`另一方面是普通 Java 的一部分，`@Autowired`只有 Spring 可用。

# javascript - 如何同时按年、月和季节排序？

> ID：11451126
> 
> 赞同：0
> 
> 时间：2012-07-12T11:46:06.483
> 
> 标签：javascript, sorting, datatables

因此，我正在使用此代码来帮助对表中的“日期”列进行排序：

```
jQuery.extend( jQuery.fn.dataTableExt.oSort, {
"monthYear-pre": function ( a ) {
    return new Date('01 '+a);
},

"monthYear-asc": function ( a, b ) {
    return ((a < b) ? -1 : ((a > b) ? 1 : 0));
},

"monthYear-desc": function ( a, b ) {
    return ((a < b) ? 1 : ((a > b) ?  -1 : 0));
}
} ); 
```

它适用于诸如“2012 年 7 月”之类的日期，但它不会与只有年份（例如“2004”或有季节（例如 2008 年春季）的日期合作。另外，如果我有“未知”我'希望它总是出现在最后。

有任何想法吗？我认为将季节与一个月类似是最简单的排序方法（例如 Spring=Mar、Summer=Jun、Autumn=Sep 和 Winter=Dec），但我不知道该怎么做。

谢谢！

PS我是新手-我有点理解后两个字符串在做什么，但是第一个“monthYear-pre”是个谜。如果有人愿意解释，我会很激动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:09:40.143

```
"seasonYear-pre": (function() {
    var seasons = /\s*(winter|spring|summer|fall|autumn),?\s*(\d{4})\s*/,
        matchedMonths = {winter: '02-01', spring: '05-01', 
                         summer: '08-01', fall: '11-01', autumn: '11-01'}
    return function(a) {
        var match = seasons.exec(a.toLowerCase());
        return new Date(match[2] + "-" + matchedMonths[match[1]]);
    };
})(); 
```

这会将冬天放在年初，但您可以随意更改上面列表中的规范日期。它匹配诸如“Winter 2012”或“Autumn, 2007”之类的字符串。（逗号是可选的，并且不区分大小写。）我不知道这个 table-sorter API。我以“monthYear-pre”为模型，但如果它需要是一个简单的排序方法，它很容易改变。

# java - 你能解释一下为什么 Google Closure Templates 使用了这么多无意义的中间对象吗？

> ID：11451127
> 
> 赞同：-5
> 
> 时间：2012-07-12T11:46:09.527
> 
> 标签：java

女士们先生们。

我正在阅读[Google 的 Closure Templates 文档。](https://developers.google.com/closure/templates/docs/helloworld_java)

那里没有那么多代码，但它代表了我难以理解的内容（特别是在 Java 中）。我将逐行进行：

```
// Bundle the Soy files for your project into a SoyFileSet.
SoyFileSet sfs = new SoyFileSet.Builder().add(new File("simple.soy")).build(); 
```

我明白了。收集多个模板文件的对象。美好的。但为什么`.Builder()`？为什么不只是`new SoyFileSet().add(...).build()`？

```
// Compile the template into a SoyTofu object.
// SoyTofu's newRenderer method returns an object that can render any template in file set.
SoyTofu tofu = sfs.compileToJavaObj(); 
```

美好的。但我为什么要这个？收集完文件后，我期待的只是`sfs.render(Map<> data)`. 为什么我需要将其编译为 Java 对象？

最后...

```
// Call the template with no data.
System.out.println(tofu.newRenderer("examples.simple.helloWorld").render()); 
```

太好了，为什么我必须创建一个中间对象才能调用它的方法？为什么`sfs`对象不能有`.render()`方法？为什么我需要一个`Renderer`对象？

Java 令人沮丧，为什么事情不以直截了当的方式完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T11:51:33.280

1.  `SoyFileset`可能是一个不可变对象，因此您可以使用 a`Builder`一步构建它。顺便说一句，您的“为什么不”反例没有多大意义，因为它也以`build`. 在您的情况下`build`，不需要。

2.  `SoyTofu`是一个重量级的工厂对象，需要花费时间和空间来生产。您想多次重复使用它来生成渲染器。这就是为什么您在单独的步骤中创建它，然后保留它的原因。

3.  您需要一个`newRenderer`，因为渲染是一个复杂的过程，涉及相当多的内部状态。对象的`Renderer`实例变量是当程序流通过其方法时保持状态的地方。您可能还会在渲染器上获得一些生命周期/状态方法，可能是为了查看渲染是如何进行的，或者在渲染之前提供一些额外的信息/配置。

这是经典模式的一个示例，我们将工作划分为预先构建的重型、不可变、线程安全、长寿命的工厂对象和轻量级、非线程安全、可变、一次性的对象，它们共享不可变的状态他们的工厂在一个线程中完成一项任务，然后被丢弃。

总而言之：这些都是设计精良、行业实力强大的 API 的标志。Java 不一定看起来像那样，但是如果您采用直接的方法，那么您会在性能方面给自己开枪，甚至内存不足。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-12T11:57:28.647

`Builder`和类似名称的`Factory`方法被用作[工厂设计模式](http://en.wikipedia.org/wiki/Factory_method_pattern)的一部分。当由于某种原因需要集中创建对象时，这很有用。例如，工厂可能出于效率原因在内部保留一个对象池，而不是每次都返回一个新实例。

# wcf - 在 WCF 数据层和 WPF 前端之间构建业务层

> ID：11451133
> 
> 赞同：0
> 
> 时间：2012-07-12T11:46:23.580
> 
> 标签：wcf, n-tier-architecture

我正在设计一个数据驱动的 Windows 应用程序，它不是由底层 SQL Server 而是由 WCF 服务提供的，以便允许本地和远程访问。

所述 WCF 为检索用户、库存、客户等提供特定功能，并实际执行 ADO 操作，大致如下：

```
[OperationContract]
UserAdapter GetUserByWindowsIdentity(string Domain, string Account); 
```

返回以下之一：

```
[DataContract]
public class UserAdapter
{
    [DataMember]
    public int? ID;

    [DataMember]
    public string Domain;

    [DataMember]
    public string Account;

    [DataMember]
    public string Name;
} 
```

我不想在我的 WPF 前端应用程序中对我的 WCF 客户端进行特定引用，而是想在两者之间的另一层抽象一些进一步的功能 - 例如，通过他们的 WindowsIdentity 验证用户登录既不属于数据层，也不属于演示层，而是一个中间业务逻辑层。

我不确定该怎么做。我希望在我的表示层中能够执行以下操作：

```
User.Login(); 
```

并让用户对象根据我的 UserAdapter 类抽象域、帐户等相同的属性，但我不能子类化它，因为我不能向下转换我的数据层返回的对象。

任何我可以接受的建议，包括“把它拿出来”，都将不胜感激。谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:56:50.563

如果您有一些业务逻辑，那么中间的附加层绝对有意义，实现细节当然取决于您的要求。

如果您考虑一下，底层数据类应该不知道如何登录，因为这已经是业务逻辑：这实际上是您考虑的方法背后的真正问题。

将业务逻辑隐藏在另一组服务后面也是您应该考虑的一个选项，在业务逻辑级别获得 WCF 的所有好处（和拥有成本）。

[Dino Esposito 写了一本关于架构企业应用程序](https://rads.stackoverflow.com/amzn/click/com/073562609X)的好书，也许你可以从中找到一些灵感来实现你的分层架构。

# sql-server - 在 MDX 中，如何对给定维度按计数（*）进行分组？

> ID：11451138
> 
> 赞同：3
> 
> 时间：2012-07-12T11:46:32.673
> 
> 标签：sql-server, aggregate-functions, mdx

在 T-SQL 中，我只需在 select 语句中使用 group by 子句和 count(*) 来给我需要的值。但是对于多维数据集，情况就不同了，因为计数不仅仅是行数，而是维度组合。所以我用谷歌搜索了一个无济于事的答案。这是我的问题的详细解释：

我原来的MDX是：

```
SELECT 
  NON EMPTY 
    {
        [Measures].[Budget]
    } ON COLUMNS
 ,NON EMPTY 
    {
        [Location].[Category - Entity - Facility].[Facility].ALLMEMBERS*
        [Location].[Category - Facility - Unit].[Location].ALLMEMBERS*
        [Calendar].[Day].[Day].ALLMEMBERS
    } ON ROWS
FROM 
(
  SELECT 
    {[Location].[Category - Entity - Facility].[Category].&[3]} ON COLUMNS
  FROM 
  (
    SELECT 
        [Calendar].[Year  -  Quarter -  Month -  Day].[Day].&[2012-01-01T00:00:00]
      : [Calendar].[Year  -  Quarter -  Month -  Day].[Day].&[2012-05-31T00:00:00]
    ON COLUMNS
    FROM [PHI Census]
  )
)

Results look like this:
    Facility 1    Location 1    Day 1    100
    Facility 1    Location 1    Day 2    100
    Facility 1    Location 1    Day 3    100
    Facility 1    Location 1    Day 4    100
    Facility 1    Location 2    Day 1    80
    Facility 1    Location 2    Day 2    80
    Facility 1    Location 2    Day 3    80
    Facility 2    Location 1    Day 1    65
    Facility 2    Location 1    Day 2    65
    Facility 2    Location 1    Day 3    65
    Facility 2    Location 1    Day 4    65
    Facility 2    Location 2    Day 1    73
    Facility 2    Location 2    Day 2    73
    Facility 2    Location 2    Day 3    73 
```

这给了我为每个设施-位置-日组合列出一次的 [预算]。我想从 ON ROWS 子句中删除 [Calendar].[Day].[Day].ALLMEMBERS 并简单地使用一个计算成员，该成员将返回每个 Facility-Location 组合以及每一行的天数。所以基本上，

```
The results would look like this:
    Facility      Location      Budget   DayCount
    Facility 1    Location 1    100      4
    Facility 1    Location 2    80       3
    Facility 2    Location 1    65       4
    Facility 2    Location 2    73       3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T15:32:11.577

DayCount 的表达式可以是：

```
MEMBER [Measures].[DayCount] AS Count(NonEmpty([Calendar].[Day].[Day].ALLMEMBERS, [Measures].[Budget])) 
```

# html - 一个干净的 CSS3 3 列布局，从哪里开始？

> ID：11451142
> 
> 赞同：11
> 
> 时间：2012-07-12T11:46:45.597
> 
> 标签：html, css

我目前正在更新一个相当旧的网站（最后一次更新是在 2001 年左右），并同意使用 HTML5 和 CSS3。

对于一般设计，我正在使用非常干净的白色和灰色色调样式，并带有许多填充和边距。我的问题出在主页上：我想要一个 3 列居中的布局。但是从哪里开始呢？我尝试了一些浮动，但徒劳无功。

我这样做对吗？

HTML：

```
<div class="colwrapper">
    <div class="ltcol"></div>
    <div class="ctcol"></div>
    <div class="rtcol"></div>
</div> 
```

CSS：

```
.colwrapper { width:1020px; }
.ltcol, .ctcol, .rtcol { width:300px; margin:0 10px; padding:10px; }
.ltcol { float:left; }
.ctcol { margin-left:340px; }
.rtcol { float:right; } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-12T11:52:05.233

你的CSS应该是这样的：

```
.ltcol, .ctcol { float:left; }
.rtcol { float:right; } 
```

> 一般来说，CSS float 属性的目的是将块级元素向左或向右推，使其脱离与其他块元素相关的流。这允许自然流动的内容环绕浮动元素。这个概念类似于您每天在印刷文学中看到的内容，其中照片和其他图形元素对齐到一侧，而其他内容（通常是文本）自然地围绕左对齐或右对齐元素流动。

有关更多详细信息，您必须阅读这篇有趣的**[文章](http://coding.smashingmagazine.com/2009/10/19/the-mystery-of-css-float-property/)**。

看这个演示：http: [//jsfiddle.net/akhurshid/YRWLV/](http://jsfiddle.net/akhurshid/YRWLV/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T11:56:20.020

您的 HTML 非常干净 - 这是向前迈出的一大步。

您需要将 a 添加`float: left`到所有列。为确保在您的列之后取消浮动，最好`clear`在浮动列之后添加一个 div。

HTML：

```
<div class="colwrapper">
    <div class="ltcol">Column 1</div>
    <div class="ctcol">Column 2</div>
    <div class="rtcol">Column 3</div>
    <div class="clear"></div>
</div>​​​​​​​​​​​​​​​​​ 
```

CSS：

```
.colwrapper { width:1020px; }
.ltcol, .ctcol, .rtcol { width:300px; margin:0 10px; padding:10px; background-color: #efefef }
.ltcol { float:left; }
.ctcol { float:left; }
.rtcol { float:left; }
.clear { clear: left; } 
```

​</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-12T11:58:28.043

因此，您为此问题添加`css3`了标签，因此我建议您使用 css3 列布局进行此操作：

[更多信息](http://www.w3schools.com/css3/css3_multiple_columns.asp)

例如

**HTML**

```
<div class="colwrapper">
    <div>text</div>
</div> 
```

**CSS**

```
.colwrapper div
{
  -moz-column-count:3; /* Firefox */
  -webkit-column-count:3; /* Safari and Chrome */
  column-count:3;
} 
```

它不适用于 IE。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-12T11:59:05.103

使用这些久经考验的实现之一，而不是推出您自己的。除了您将获得测试和工作代码这一事实之外，您还将以几乎零的努力为您的网站添加响应能力。

*   [http://cssgrid.net/](http://cssgrid.net/)
*   [http://960.gs/](http://960.gs/)
*   [http://framelessgrid.com/](http://framelessgrid.com/)
*   [http://goldengridsystem.com/](http://goldengridsystem.com/)

如果你用谷歌搜索还有更多..

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-11-16T19:16:49.873

现在也可以为此使用 Flexbox 属性，因此您无需担心浮动或 clearfix。

```
 main{
  /* .colwrapper{ */
    display: flex;
    flex-flow: row;
    justify-content: center;
  }
  main > section{
  /* .ltcol,.ctcol,.rtcol{ */
    display:flex;
    flex-flow:column;
    align-items:center;
    padding:10px; padding:.625rem;
  }

  main > section:nth-child(2){
  /* .ctcol{ */
    margin:0 20px; margin:0 1.25rem;
  } 
```

[http://caniuse.com/flexbox](http://caniuse.com/flexbox)显示对它的支持并没有你想的那么远，但是，有一些方法可以通过将旧版本的语法与新的[http://css混合来改进支持-tricks.com/using-flexbox/](http://css-tricks.com/using-flexbox/)如果你想在下一个项目中使用它，Chris Coyier 有一篇很棒的文章（这篇文章已经相当老了）。您还可以在[http://html5please.com/#flexbox获取更多详细信息](http://html5please.com/#flexbox)

此外，如果您使用的是 HTML5，我可能会使用 div 上的部分以获得更多语义结构，因此比较看起来像这样：

```
<main>
  <section></section><!-- or <nav></nav> -->
  <section></section><!-- or <article></article> -->
  <section></section><!-- or <aside></aside> -->
</main>

instead of...

<div class="colwrapper">
  <div class="ltcol"></div>
  <div class="ctcol"></div>
  <div class="rtcol"></div>
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-12T11:54:16.310

只需尝试将 rtcol div 放在 le ltcol div 之前。

```
 <div class="colwrapper">
    <div class="rtcol">X</div>
    <div class="ltcol">X</div>
    <div class="ctcol">X</div>
  </div>​ 
```

[http://jsfiddle.net/EDjpy/](http://jsfiddle.net/EDjpy/)

# php - Google GCM 服务器返回 404 错误

> ID：11451143
> 
> 赞同：1
> 
> 时间：2012-07-12T11:46:52.727
> 
> 标签：php, android, google-cloud-messaging

我想通过 PHP 将消息从我的服务器发送到电话。这是我的代码：

```
 $apiKey = "AIxxxxxxxxxxxxxxxxxxxx";

    $registrationIDs = array( $c2dmId );

    $url = "https://android.googleapis.com/gcm/send";

    $headers = array( 
                        'Authorization: key='.$apiKey,
                        'Content-Type: application/json'
                    );

    $fields = array(
                    'collapse_key'      => $collapseKey,
                    'data'              => array( 
                        "type"      => $msgType,
                        "extra"     => $msgExtra,
                        "uuid"      => $uuid,
                        "user_id"   => $userId),
                    'registration_ids'  => $registrationIDs,
                    );

    print (json_encode($fields));
    echo "<br/>";

    $ch = curl_init();

    curl_setopt( $ch, CURLOPT_URL, $url );

    curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt( $ch, CURLOPT_HTTPHEADER, $headers);
    curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );

    curl_setopt( $ch, CURLOPT_POST, true );
    curl_setopt( $ch, CURLOPT_POSTFIELDS, json_encode( $fields ) );

    $result = curl_exec($ch);
    $resultInfo = curl_getinfo($ch);

    echo "resultinfo: $resultInfo <br>";
    foreach ($resultInfo as $key => $value) {
        echo "$key => $value <br>";
    }

    curl_close($ch);
    die ("Result: $result"); 
```

$c2dmId 只是我从手机发送到服务器的registrationId。结果我得到（在 $result 变量中）：

```
<HTML>
<HEAD>
<TITLE>Not Found</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1>Not Found</H1>
<H2>Error 404</H2>
</BODY>
</HTML> 
```

我不知道为什么。任何人都可以帮忙吗？文档没有说任何关于 404 代码的内容，所以我真的不知道发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T15:27:16.677

哦，我完全忘记了这个问题，对不起。我已经找出问题所在了。早些时候，我使用我之前发布的代码通过 C2DM 发送消息。我只做了一些改进以将其调整为 GCM。在某些情况下，变量之一 ($msgExtra) 可能等于 null。这是预期的行为，并且与 C2DM 一起工作得很好。不幸的是，当您尝试通过 GCM 在 JSON 中传递 null 时，您会收到 404 错误，尽管 GCM 文档对此只字未提……因此，只要您不尝试发送 null，我发布的代码就很好。我的问题的解决方案是用“”之类的东西替换空值。再一次 - 对不起，我刚刚发布它，我完全忘记了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:03:55.743

从 Google API 控制台生成浏览器 API 密钥，并在“授权”标头中使用它而不是服务器密钥。一旦你这样做，这个错误就会消失。

这是由 GCM 文档中的一个严重错误引起的，该错误指出您应该在 Authorization 标头中使用服务器密钥（如此[处](http://developer.android.com/guide/google/gcm/gs.html)所写）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T07:49:08.217

可能已经为您解决了。但这是我在设备上测试的代码的工作版本。

```
<?php

$apiKey = "AI.....";

$registrationIDs = array( "You registration key"  );

$url = "https://android.googleapis.com/gcm/send";

$headers = array( 
                    'Authorization: key='.$apiKey,
                    'Content-Type: application/json'
                );

$msgType = "hello";
$msgExtra = "rock";
$uuid = '1234';
$userId = '5678';

/* data you need to define message you want to send in APP.For ex: here myssg in what i am fetching at client side, so in notification it will show hello. You can change accordingly. */ 
$fields = array(
                'collapse_key'      => $collapseKey,
                'data'              => array( 
                    "mymsg"      => $msgType,
                    "extra"     => $msgExtra,
                    "uuid"      => $uuid,
                    "user_id"   => $userId),
                'registration_ids'  => $registrationIDs,
                );

print (json_encode($fields));
echo "<br/>";

$ch = curl_init();

curl_setopt( $ch, CURLOPT_URL, $url );

curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt( $ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );

curl_setopt( $ch, CURLOPT_POST, true );
curl_setopt( $ch, CURLOPT_POSTFIELDS, json_encode( $fields ) );

$result = curl_exec($ch);
$resultInfo = curl_getinfo($ch);

echo "resultinfo: $resultInfo <br>";
foreach ($resultInfo as $key => $value) {
    echo "$key => $value <br>";
}

curl_close($ch);
die ("Result: $result");
?> 
```

这不会给你 404 错误。希望这会帮助你或一些在 PHP 中寻找服务器端实现的人。

# android - 使用用户名和密码连接到 Web 服务

> ID：11451148
> 
> 赞同：0
> 
> 时间：2012-07-12T11:47:04.270
> 
> 标签：android, web-services

我是网络服务问题的新手。我想通过用户名和密码连接到网络服务器。我找到了一些解决方案如何连接并获得响应，但经过一些试验我没有成功。我遇到了一些如下所示的错误。这是我的代码，你能帮帮我吗？

```
package com.isoft.uploader;

import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransport;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class UploaderActivity extends Activity 
 {

//ArrayList<Response> WebData= new ArrayList<Response>();
public static final int SELECT_VIDEO=1;
public static final String TAG="UploadActivity";
String path="";
final String NAMESPACE = "http://tempuri.org/";
final String SERVICEURL = "http://192.168.10.177/androidws/isandroidws.asmx";
final String METHOD_NAME1="OzelVeriAlanlariniGetir";
final String METHOD_NAME="KullaniciGiris";
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button enter=(Button)findViewById(R.id.Enter);
    final EditText username=(EditText)findViewById(R.id.username);
    final EditText password=(EditText)findViewById(R.id.password);
    enter.setOnClickListener(new View.OnClickListener() 
    {

        @Override
        public void onClick(View arg0) 
        {
            // TODO Auto-generated method stub
            //request code for Webservice
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
            //sending the username to the webservice
            request.addProperty("kullaniciAdi",username.getText().toString());
            //sending the password to the webservice
            request.addProperty("password",password.getText().toString());
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            //Putting the request in an envelope
            envelope.setOutputSoapObject(request);
            HttpTransport transport = new HttpTransport(SERVICEURL);
            try
            {
                 transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
                 //getting the response from the webservice
                 Boolean response = (Boolean) envelope.getResponse();
                 if(response==true)
                 {
                     openGaleryVideo();
                 }//end of if statement

                 else setContentView(R.layout.main);

            }//end of try 
            catch(Exception exception)
            {
                exception.printStackTrace();
            }//end of catch

        }//end of onClick method
    });//end of OnclickListener method
}//end of onCreate method

public void openGaleryVideo()
{
    Intent intent=new Intent();
    intent.setType("video/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Video"),SELECT_VIDEO);
}//end of openGaleryVideo method

public String getPath(Uri uri)
{   
    String[] projection = { MediaStore.Video.Media.DATA};
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}//end of getPath method
}//end of main 
```

![在此处输入图像描述](../Images/bcb510fbac36f088f26c4fb28b1eff6c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:07:34.927

你需要得到正确版本的 ksoap2 jar

[ksoap2-android-assembly-2.4-jar-with-dependencies.jar](http://code.google.com/p/ksoap2-android/downloads/detail?name=ksoap2-android-assembly-2.4-jar-with-dependencies.jar)

*   下载此 jar 并将其添加到您的类路径

**编辑** 现在有一个更新的 ksoap2 JAR

[ksoap2-android-assembly-2.6.5-jar-with-dependencies.jar](http://ksoap2-android.googlecode.com/svn/m2-repo/com/google/code/ksoap2-android/ksoap2-android-assembly/2.6.5/ksoap2-android-assembly-2.6.5-jar-with-dependencies.jar)

试试这个

# php - 使用 php 和 onselection 更改另一个动态组合框的值创建动态组合框

> ID：11451150
> 
> 赞同：1
> 
> 时间：2012-07-12T11:47:04.977
> 
> 标签：php, javascript, html, combobox

我想创建 HTML 动态组合框，它使用 db 中的 php 脚本和另一个动态组合框的 onselection 更改值填充。最初，第二个组合框应该是不可见的，并且在选择第一个组合框时，使第二个组合框与相似数据相关。例如，我有这张桌子：

```
 Category Name
    Airport  ABC
    Airport  XYZ
    College  a1
    College  b1
    College  b2
    busstop  a
    busstop  b
    busstop  c
    busstop  d 
```

因此，第一个组合框将包含唯一类别列表（例如：机场、学院、巴士站），并在此选择的基础上启用具有相关值的第二个组合框，例如如果用户选择机场，则第二个组合框将仅包含 (ABC、XYZ)。

我基本上只想用 HTML、JAVASCRIPT 和 PHP 来做到这一点。

任何建议表示赞赏..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:04:59.400

在下面的代码片段中，我假设您有一个数组，其中包含作为对象的数据库行，我将其命名为 $results;

**编辑：**如何获取您的查询对象： [http ://www.php.net/manual/en/mysqli-result.fetch-object.php](http://www.php.net/manual/en/mysqli-result.fetch-object.php)

我首先收集用于创建组合框的数据：

```
$combobox_data = array();

$results = mysqli_query("SELECT * FROM TABLE");
//create a multi dimensional array with names per category
while($row = mysqli_fetch_object($results)){
    $combobox_data[$row->Category][] = $row->Name;
}

$category_combobox_html = "";
$name_combo_boxes_html = "";
//create category combo_box
foreach($combobox_data as $category=>$names){

    //Add category option to  category combo-box
    $category_combobox_html .= '<option value="'.$category.'">'.$category.'</option>';

    //Create Names combo-box for this category
    $name_combo_boxes_html .= '<select id="'.$category.'" name="'.$category.'" class="hidden_combobox">';

    //loop names, to add Names in the combo-box for this category
    foreach($names as $name){
        $name_combo_boxes_html .= '<option value="'.$name.'">'.$name.'</option>';
    }
    //end your combo box for this category
    $name_combo_boxes_html .= '</select>';
} 
```

**你的 CSS**

```
<style type="text/css" media="screen">
    .hidden_combobox{
        display:none;
    }
</style> 
```

**你的html**

```
<select name="categories" id="categories">
<?php echo $category_combobox_html; ?> 
</select>

<?php echo name_combo_boxes_html ;?> 
```

**你的 javascript**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript">

    //when you select something from category box
    $("#categories").change(function(){

        //get selected category
        var selectedValue = $(this).find(":selected").val();

        //hide all nameboxes
        $('.namebox').each(function(){
           $(this).hide();
        });

        //show combobox for this select
        $('#'+selectedValue).show();
    });
</script> 
```

***你的结果将是这样的：***

除非您选择与 combo_box 匹配的类别，否则所有名称组合框都将被隐藏

```
<select name="categories" id="categories">
    <option value="Airport">Airport</option>
    <option value="College">College</option>
    <option value="busstop">busstop</option>
</select>

<select id="Airport" name="Airport" class="namesbox hidden_combobox">
    <option value="ABC">ABC</option>
    <option value="XYZ">XYZ</option>
</select>
<select id="College" name="College" class="namesbox hidden_combobox">
    <option value="a1">a1</option>
    <option value="b1">b1</option>
    <option value="b2">b2</option>
</select>
<select id="busstop" name="busstop" class="namesbox hidden_combobox">
    <option value="a">a</option>
    <option value="b">b</option>
    <option value="c">c</option>
    <option value="d">d</option>
</select> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-12T11:55:15.717

你试过[谷歌](http://bit.ly/M4AgwN)吗？看来您正在寻找这样的[东西](http://graphnickdesign.com/blog/generating-dynamic-selection-dropdown-jquery-ajax/)。

# sql - SQL Server 2008 - 插入 Linq 查询的 SQL 超时异常

> ID：11451151
> 
> 赞同：2
> 
> 时间：2012-07-12T11:47:06.043
> 
> 标签：sql, timeout

目前，我的 Windows 服务每天处理大约 1500 笔交易。大约每周一次，我在使用 LINQ 完成的插入时遇到随机超时异常。

例外是：

```
Exception (SqlException) System.Data.SqlClient.SqlException (0x80131904): Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding. 
```

Linq 查询是：

```
dc.TransactionLoggings.InsertOnSubmit(new TransactionLogging()
                    {
                        DateAdded = DateTime.UtcNow,
                        InputMessage = message,
                        DocId = documentID.ToString(),
                        TransactionStatus = transactionStatus
                    });
                    dc.SubmitChanges(); 
```

关于如何诊断此问题的任何想法/建议？

非常感谢你的帮助，菲奥娜

**更新**

表结构为：

```
CREATE TABLE [dbo].[TransactionLogging](
[ID] [bigint] IDENTITY(1,1) NOT NULL,
[InputMessage] [nvarchar](max) NULL,
[CCHMessage] [nvarchar](max) NULL,
[DocId] [char](20) NOT NULL,
[TransactionStatus] [char](5) NOT NULL,
[DateAdded] [datetime] NULL,
[LastUpdate] [datetime] NULL,
[SentDate] [datetime] NULL, 
```

约束 [PK_TransactionLogging] 主键集群（[ID] ASC）WITH（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [PRIMARY]）ON [PRIMARY

此外，最近的 2 次交易超时发生在当天的第一笔交易中。我敢肯定，这绝非巧合！

也只是想知道是否有人对我的代码的以下更新有任何想法：

任何意见？！！！

```
 using (MiddlewareDBDataContext dc = new MiddlewareDBDataContext(ConfigurationWrapper.ActivityLoggingDatabase_ConnectionString))
            {

                dc.TransactionLoggings.InsertOnSubmit(new TransactionLogging()
                {
                    DateAdded = DateTime.UtcNow,
                    InputMessage = message,
                    DocId = documentID.ToString(),
                    TransactionStatus = transactionStatus
                });
                try
                {
                    dc.SubmitChanges();
                }
                catch (SqlException ex)
                {
                    //Wait for 30 seconds then retry..
                    System.Threading.Thread.Sleep(30000);
                    dc.SubmitChanges();
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:08:35.503

您应该给命令更多的时间来执行以防止超时。这可以通过以下方式完成：

```
 using(var db = new DataContext()) 
   { 
      db.CommandTimeout = 60; // seconds
      // your queries ...   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:13:26.050

除非你很幸运，否则这将需要一些工作才能找到。鉴于您每天要做 1500 次，而您每周都会获得其中一次，我会按照 Greg H 的建议去做，并在发生时处理它。

默认连接超时为 60 秒，默认命令超时为 15 秒。如果是连接失败，我希望大约在同一时间看到其他一些操作由于相同的原因失败。您可以增加命令超时，但在我看来，这将是症状修复，一个务实的解决方案，但问题的性质表明，如果您增加服务器上的负载，它会变得更糟，在这种情况下，事情可能会变得愚蠢.

我将研究对表格执行重大操作的函数，尤其是聚合函数。在它们周围放置某种跟踪日志可能会帮助您缩小范围。Definitley 想知道这是否值得付出努力，因为您在五天的操作中的失败率是 7500 分之一。在 7 天之内，万分之一...

顺便说一下，这张桌子上是否有任何触发器，如果​​有，它们将值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T11:59:26.727

好吧，SQL Server 可能需要不同的时间来执行操作。（`INSERT`特别是可能需要比您预期的更多的工作。）超时的概念是有原因的。

所以我认为答案是超时是你的代码需要处理的现实。您可以增加超时值，从而减少异常发生的频率。但是，您可能应该*捕获*异常并做一些合理的事情，例如尝试再次插入和/或将错误情况传递给用户。

# codec - 每个 VC1 配置文件的限制是什么？

> ID：11451153
> 
> 赞同：1
> 
> 时间：2012-07-12T11:47:11.120
> 
> 标签：codec, expression-encoder, expression-encoder-sdk, expression-encoder-4, vc1

当我尝试使用以下参数进行转换时：

```
mediaItem.OutputFormat.VideoProfile = new MainVC1VideoProfile()
                    {
                        Size = new System.Drawing.Size(1920, 1200),
                        Bitrate = new VariableQualityBitrate(75),
                        Complexity = VideoComplexity.Normal,
                        FrameRate = 1,
                        KeyFrameDistance = TimeSpan.FromSeconds(20)
                    }; 
```

我收到以下错误：

> 此配置文件的组合宽度、高度和帧速率太高。

谁能帮助我并告诉我每个配置文件的限制是什么？

SimpleVC1VideoProfile
MainVC1VideoProfile
AdvancedVC1VideoProfile

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:08:46.487

VC1 的主配置文件可以支持高达 1920 x 1080 的最大分辨率。在您的代码中，您将分辨率设置为 1920 x 1200，因此宽度大于允许的最大值。

简单配置文件支持高达 CIF 分辨率 (352 x 288)，高级配置文件可以解码高达 2048 x 1536（但比特率 = 135 MBits/s）。

在我看来，您最好的选择是将源大小调整为 1920 x 1080。

有关详细信息，请查看[此 Microsoft 文章](http://www.microsoft.com/windows/windowsmedia/howto/articles/vc1techoverview.aspx)或[此 Wikipedia 条目](http://en.wikipedia.org/wiki/VC-1#Profiles)。

# java - Phonegap 插件行为异常

> ID：11451155
> 
> 赞同：0
> 
> 时间：2012-07-12T11:47:15.843
> 
> 标签：java, javascript, html, cordova, phonegap-plugins

我已经为 v1.0.0 实现了 Phonegap 插件。请看一下我的 HTML 代码

```
/**** HTML FILE ****/
<!DOCTYPE html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-  scale=1.0, user-scalable=no;" />
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<script type="text/javascript" charset="utf-8" src="phonegap-1.0.0.js"></script>
<script type="text/javascript" charset="utf-8" src="system.js"></script>
<script type="text/javascript">

var uname = "User1";                    //------------- 2

var System = function() {};

System.prototype.func = function(funcname,funcdata) {

//alert("In the list function");

return PhoneGap.exec(
      null,                 //Success callback from the plugin
      null,                 //Error callback from the plugin
      'SystemPlugin',       //Tell PhoneGap to run     "DirectoryListingPlugin" Plugin
      funcname,             //Tell plugin, which action we want to perform
      funcdata);            //Passing list of args to the plugin
};

PhoneGap.addConstructor(

    function() {

       PhoneGap.addPlugin("system", new System());

    }

);

var _anomFunkMap = {};
var _anomFunkMapNextId = 0; 

function anomToNameFunk(fun)
{
    var funkId = "f" + _anomFunkMapNextId++;
    var funk = function()
    {
        fun.apply(this,arguments);
        _anomFunkMap[funkId] = null;
        delete _anomFunkMap[funkId];    
    }
    _anomFunkMap[funkId] = funk;

    return "_anomFunkMap." + funkId;
}

function GetFunctionName(fn)
{
  if (typeof fn === "function") {
    var name= fn.name;  
    if (!name) {
      var m = fn.toString().match(/^\s*function\s+([^\s\(]+)/);
      name= m && m[1];  
    }
    if (name && (window[name] === fn)) {
        return name;
    } else {
        return anomToNameFunk(fn);
    } 
  }else {
    return null;
  }
}

function post_sync_data(url, urlparam, param, requestheader, callback){

    //alert("In post_sync_data");

    if(undefined == callback){

        if(undefined == requestheader){

            var fnname = GetFunctionName(param);
            var dataArray = [fnname, fnname, url, urlparam];    

        }
        else{

            var fnname = GetFunctionName(requestheader);

            //Note : the param is optional parameter or request header
            var dataArray = [fnname, fnname, url, urlparam, param]; 

        }
    }
    else{

        var fnname = GetFunctionName(callback);
        var dataArray = [fnname, fnname, url, urlparam, param, requestheader];  

    }

    //alert("Calling plugin function post with \r\n"+dataArray);

    var r = window.plugins.system.func("post",dataArray);       
    //alert("r is :\r\n"+r);                                                        ------------- 3

    return r;       
}

function validate(){    

    //Make a webservice call for the Omnesys Token
    post_sync_data(url,urlparam,uname,postDataCB);

}

function postDataCB(token,name){

    //Here uname is undefined.
    alert("In postDataCB()\r\nuname: "+uname+"\r\nuname from C Func: "+name+"\r\n\r\ntoken: "+token);
    return;

}   

function onBodyLoad()
{       
    document.addEventListener("deviceready",onDeviceReady,false);

}

function onDeviceReady()
{
    // do your thing!
    navigator.notification.alert("PhoneGap is working")
    document.getElementById('d1').style.visibility = "visible";
}

</script>
    </head>
    <body onload="onBodyLoad()"> 
<div id="d1" style="visibility:hidden">
    <form>                                                                  <!-- 1 -->
    <button onclick="javascript:validate()">Submit</button><br />   
    </form>
</div>
    </body>
</html> 
```

我的 Phonegap 插件文件。

```
/*** My PhoneGap Plugin.xml File ***/
<?xml version="1.0" encoding="utf-8"?>
<plugins>
<plugin name="App" value="com.phonegap.App"/>
<plugin name="Geolocation" value="com.phonegap.GeoBroker"/>
<plugin name="Device" value="com.phonegap.Device"/>
<plugin name="Accelerometer" value="com.phonegap.AccelListener"/>
<plugin name="Compass" value="com.phonegap.CompassListener"/>
<plugin name="Media" value="com.phonegap.AudioHandler"/>
<plugin name="Camera" value="com.phonegap.CameraLauncher"/>
<plugin name="Contacts" value="com.phonegap.ContactManager"/>
<plugin name="Crypto" value="com.phonegap.CryptoHandler"/>
<plugin name="File" value="com.phonegap.FileUtils"/>
<plugin name="Network Status" value="com.phonegap.NetworkManager"/>
<plugin name="Notification" value="com.phonegap.Notification"/>
<plugin name="Storage" value="com.phonegap.Storage"/>
<plugin name="Temperature" value="com.phonegap.TempListener"/>
<plugin name="FileTransfer" value="com.phonegap.FileTransfer"/>
<plugin name="Capture" value="com.phonegap.Capture"/>
<plugin name="SystemPlugin" value="com.phonegap.test.SystemPlugin" />
</plugin> 
```

还有我的 JAVA 课

```
/** Plugin Code **/
public class SystemPlugin extends Plugin {

@Override
public PluginResult execute(String funcname, JSONArray funcargs, String jscallbackid){

    //Get the success and failure call back functions       
    try{        
        SuccessCallBack = funcargs.getString(0);
        FailureCallBack = funcargs.getString(1);        
    }
    catch (JSONException jsonEx) {

        return null;

    }

    if(funcname.equals("post")){

        try{

            url = funcargs.getString(2);
            urlparam = funcargs.getString(3);               

        }
        catch (JSONException e) {
            SendJS = "javascript:" + FailureCallBack + "('" + e.getMessage() + "')"; 
            sendJavascript(SendJS);
            return null;
        } 

        try {
            conn = new URL(url).openConnection();
            conn.setDoOutput(true);

        } catch (MalformedURLException e) {
            SendJS = "javascript:" + FailureCallBack + "('" + e.getMessage() + "')"; 
            sendJavascript(SendJS);
            return null;
        } catch (IOException e) {
            SendJS = "javascript:" + FailureCallBack + "('" + e.getMessage() + "')"; 
            sendJavascript(SendJS);
            return null;
        }

        if(requestheader == null){

            //Default Request Property
            conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

        }
        else{

            String Headers[] = requestheader.split("\r\n");

            for(i=0; i < Headers.length; i++){

                String hReq[] = Headers[i].split(":");

                if(hReq.length == 2){

                    conn.setRequestProperty(hReq[0], hReq[1]);                  
                }
            }
        }

        try {

            //Blank String
            String data="";

            String param[] = urlparam.split("&");

            for(i=0; i < param.length; i++){

                String keyval[] = param[i].split("=");

                if(keyval.length == 2){

                    data += URLEncoder.encode(keyval[0], "UTF-8") + "=" + URLEncoder.encode(keyval[1], "UTF-8") + "&";
                }
            }

            //remove the unwanted & at the end of the string
            data = data.substring(0,data.length()-1);  

            ro = new OutputStreamWriter(conn.getOutputStream());
            ro.write(data);

            //Close the connection
            ro.close(); 

        } catch (IOException e) {
            SendJS = "javascript:" + FailureCallBack + "('" + e.getMessage() + "')"; 
            sendJavascript(SendJS);
            return null;
        }

        try{

            rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));

            while ((line = rd.readLine()) != null)
            {
                sb.append(line);
            }

            //Close the connection
            rd.close();

        } catch (IOException e) {
            SendJS = "javascript:" + FailureCallBack + "('" + e.getMessage() + "')"; 
            sendJavascript(SendJS);
            return null;
        }

        SendJS = "javascript:" + SuccessCallBack + "('" + JSONObject.quote(sb.toString()); 

        if(jObj != null)
            SendJS += "','" +  jObj + "')";
        else if(StringParam != null)
            SendJS += "','" + StringParam + "')";
        else
            SendJS += "')";

        sendJavascript(SendJS);
        return null;        

    }   
    else{

        return null;

    }       
}
} 
```

现在在第一个代码中，您可以看到数字 1 2 3 1 - 表单元素 2 - 是全局变量 3 - 是插件警报

现在，如果我删除 1\. 一切正常。但是如果我保留表格，全局变量就不能保存它的值。它变成`undefined`并且警报也给出`undefined`

有人可以指导我是什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T05:04:00.610

这是一个表单问题。表格不是按照标准表格格式纠正这个问题。

# ruby - 如何让 Sinatra 使用 CSRF Authenticity 令牌？

> ID：11451161
> 
> 赞同：13
> 
> 时间：2012-07-12T11:47:31.283
> 
> 标签：ruby, sinatra, csrf

我正在使用 Sinatra 框架在 ruby​​ 中构建一个简单的应用程序。它主要基于“获取” - 大多数请求将用于列出数据。但是，应用程序中有几个关键屏幕可以收集用户输入。我想确保应用程序尽可能安全，目前，我正在尝试找到如何实现您在 Rails 表单中获得的那种真实性令牌？

我必须去的地方：嗯，我知道我需要 csrf 的令牌，但我不确定我是否需要自己生成它们，或者 Sinatra 是否可以为我做 - 我已经查看了文档，他们说Sinatra 正在使用机架保护，但是，我找不到任何示例代码，并且似乎无法弄清楚如何让它运行 - 任何帮助表示感谢 - 谢谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-12T11:51:36.390

使用[`rack_csrf`](https://github.com/baldowl/rack_csrf)宝石。安装它

```
gem install rack_csrf 
```

`rack_csrf`gem 有一个Sinatra[示例](https://github.com/baldowl/rack_csrf/tree/master/examples/sinatra)。以下是改编自此[页面](http://emilloer.com/2011/01/15/preventing-csrf-in-sinatra/)的更简单示例（似乎离线。[存档版本](http://web.archive.org/web/20110513020511/http://emilloer.com/)）：

```
require "rack/csrf"

configure do
  use Rack::Session::Cookie, :secret => "some unique secret string here"
  use Rack::Csrf, :raise => true
end 
```

在大多数情况下，使用`enable :sessions`而不是`use Rack::Session::Cookie ...`也可以工作（参见比尔的评论）。

`Rack::Csrf.csrf_token`在您看来，您可以使用and`Rack::Csrf.csrf_tag`方法获取令牌（或标记） 。如果这看起来很长，您可能希望按照以下方式定义一个助手：

```
helpers do
  def csrf_token
    Rack::Csrf.csrf_token(env)
  end

  def csrf_tag
    Rack::Csrf.csrf_tag(env)
  end
end 
```

使用辅助方法的小例子：

```
<form method="post" action="/tweet">
  <%= csrf_tag %>
  <input type="text" name="message"/>
  <input type="submit" value="Submit a tweet!"/>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-08T06:52:22.627

当呈现相同的 erb 视图时，在登录时凭据无效的情况下。现在在提交时呈现后，它会引发错误。 `Rack::Csrf::InvalidCsrfToken at /login` `Rack::Csrf::InvalidCsrfToken`

我们是否需要做一个重定向来代替渲染来完成这项工作？因为在渲染中旧的 csrf 令牌仍然存在。在完整的重定向中，我们生成了一个新令牌。

# java - 如何发布一个java应用程序？

> ID：11451164
> 
> 赞同：0
> 
> 时间：2012-07-12T11:47:47.243
> 
> 标签：java, deployment, desktop-application, deploying

我刚刚完成了一个简单的 java 桌面应用程序。

我想知道如何将这个应用程序组合成一个可执行文件，以便双击它运行应用程序。现在，我通过 IDE 运行应用程序，但这不是我希望它永远运行的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T11:57:22.080

我假设您一直在使用 Eclipse IDE。

在您的包资源管理器（通常在左侧）中，找到您要导出的 Java 项目，右键单击它并`Export`从菜单中选择。

当要求输入类型时，展开`Java`文件夹图标并选择`Runnable JAR file`。

在 下`Launch configuration`，找到并选择将运行它的类（带有`main`方法的类）。
选择要将其导出的位置以及要对正在使用的其他非标准库执行的操作。

点击`Finish`。

# python - 需要从 python 列表中查找子元素

> ID：11451167
> 
> 赞同：4
> 
> 时间：2012-07-12T11:48:02.007
> 
> 标签：python, list, iterator, match

我有一个如下的python列表

```
[(u'1', u'0'), (u'2', u'1'), (u'3', u'2'), (u'4', u'3'), (u'5', u'4'), (u'6', u'4'), (u'7', u'4'), (u'8', u'4'), (u'9', u'4'), (u'10', u'4'), (u'11', u'4'), (u'11.5', u'2'), (u'12', u'11.5'), (u'13', u'11.5'), (u'14', u'11.5'), (u'15', u'11.5'), (u'16', u'11.5'), (u'17', u'11.5'), (u'18', u'11.5'), (u'19', u'11.5'), (u'20', u'11.5'), (u'21', u'11.5'), (u'22', u'11.5'), (u'23', u'11.5'), (u'24', u'11.5'), (u'25', u'11.5'), (u'26', u'11.5'), (u'27', u'11.5'), (u'28', u'11.5'), (u'30', u'11.5'), (u'29', u'11.5')] 
```

这里每个元组的第 1 个位置是它自己的 id，而第 2 个位置是它的父 id。

我想得到特定ID的所有孩子。例如，如果我想获取所有自己的 ID 为“3”的孩子（或孩子的孩子......到 n 深度）的列表。所以答案列表将是`[u'4', u'5', u'6', u'7', u'8', u'9', u'10', u'11']`

有什么办法可以做到这一点？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:25:48.697

你可以使用`networkx`图书馆...

```
import networkx as nx
g = nx.DiGraph()
g.add_edges_from( (y,x) for x,y in your_list )
print list(nx.dfs_postorder_nodes(g, '3'))
[u'11', u'10', u'5', u'7', u'6', u'9', u'8', u'4', '3'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T11:52:23.423

如果您没有定义的级别数……</p>

用你的清单`li`：

```
d = {}
for o, p in li:
    d.setdefault(p, []).append(o)
todo = d[u'3'][:]
descendants = []
while todo:
    node = todo.pop(0)
    todo.extend(d.get(node, []))
    descendants.append(node) 
```

`descendants`包含搜索的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:06:18.903

如果关系不经常改变，一种解决方案是构建传递闭包，因此：

```
def tclose(data):
    data = set(data)
    while True:
        new = set( (a, d)
                   for (a, b) in data
                   for (c, d) in data
                   if b == c ) - data
        if not new:
            return data
        data.update(new)

data = tclose([(u'1', u'0'), …]) 
```

然后你可以找到后代，因此：

```
descendants = set( d for (d, a) in data if a == '3' ) 
```

如果要将搜索限制在固定深度，可以替换`while True`为`for _ in range(n - 1)`. 如果`n`有所不同，您将需要不同的解决方案。

请注意，此解决方案侧重于简单性。它不是最快的算法，如果你给它一个大的输入集，可能需要修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:00:20.600

```
from collections import defaultdict

mylist = [(u'1', u'0'), (u'2', u'1'), (u'3', u'2'), (u'4', u'3'), (u'5', u'4'), (u'6', u'4'), (u'7', u'4'), (u'8', u'4'), (u'9', u'4'), (u'10', u'4'), (u'11', u'4'), (u'11.5', u'2'), (u'12', u'11.5'), (u'13', u'11.5'), (u'14', u'11.5'), (u'15', u'11.5'), (u'16', u'11.5'), (u'17', u'11.5'), (u'18', u'11.5'), (u'19', u'11.5'), (u'20', u'11.5'), (u'21', u'11.5'), (u'22', u'11.5'), (u'23', u'11.5'), (u'24', u'11.5'), (u'25', u'11.5'), (u'26', u'11.5'), (u'27', u'11.5'), (u'28', u'11.5'), (u'30', u'11.5'), (u'29', u'11.5')]

def make_tree(lst):
    """
    Accepts a list of (item, parent)
    Returns a dict of parent:[children]
    """
    res = defaultdict(list)
    for child,parent in lst:
        res[parent].append(child)
    return res

def find_children(tree, root, max_depth=-1):
    """
    Accepts a dict of parent:[children]
    Returns a recursive list of (child, [children_of_child]) of root to the given maximum depth
      (if max_depth is negative, recursion is not limited)
    """
    if max_depth and (root in tree):
        return [(child, find_children(tree, child, max_depth-1)) for child in tree[root]]
    else:
        return []

def flatten(ans):
    """
    Accepts a recursive list
    Returns a flat list of nodes
    """
    res = []
    for parent,children in ans:
        res.append(parent)
        res.extend(flatten(children))
    return res

print flatten(find_children(build_tree(mylist), u'3', 4)) 
```

结果是

```
[u'4', u'5', u'6', u'7', u'8', u'9', u'10', u'11'] 
```

# java - 20 个模拟用户的休眠死锁

> ID：11451171
> 
> 赞同：2
> 
> 时间：2012-07-12T11:48:19.683
> 
> 标签：java, sql-server-2008, hibernate

我们有一个基本的 Java EE 应用程序，它在 tomcat 下运行并维护一个到 SQL 服务器数据库的连接池。我们遇到了一些仅在生产中出现的数据问题，因此我创建了一个测试工具，可以模拟不同数量的用户在不同的路径上通过系统。

我已经对此进行了一些研究，因此问题随着我的追逐而发展。现在的问题是这样的。

十个用户线程完美运行。20 个用户线程和用户登录系统时创建的日志记录永远不会为 20 个用户中的任何一个插入。事实上，Hibernate 3.3 经历了插入记录的动作，但是当我使用 show_sql 设置时，插入语句从未出现在转储中。这同样适用于 10 个用户。更令人费解的是，每隔一段时间它就会为 20 个用户中的一个工作。:(

我正在使用 JTDS 驱动程序，顺便说一句，以避免我们一直在 MS 中发现的问题。

我正在使用 tomcat 的本地机器上运行 SQL Server Express 2008 R2，并在我的 Eclipse IDE 中运行我的测试应用程序。有没有人见过这样的事情？关于为什么休眠可能在 10 个用户之后锁定的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:01:25.767

我认为问题在于您无法根据需要打开足够的会话（因为它们是汇集的）

*   你如何打开会话？
*   你的连接池有多大？
*   你总是关闭会话吗？

# php - 新的 Bing API PHP 示例不起作用

> ID：11451178
> 
> 赞同：8
> 
> 时间：2012-07-12T11:48:32.487
> 
> 标签：php, rest, bing

Microsoft 自己的新 Bing API 的 PHP 示例不起作用。我尝试了很多方法，它只是显示：

> 服务器错误
> 401 - 未经授权：由于凭据无效，访问被拒绝。
> 您无权使用您提供的凭据查看此目录或页面。

官方文档中给出的示例编码如下，它在

```
'proxy' => 'tcp://127.0.0.1:8888', 
```

我 100% 确定我的密钥是正确的，当我在浏览器 url 中输入它时它工作正常，即

```
https://api.datamarket.azure.com/Bing/SearchWeb/Web?Query=%27love+message%27 
```

（您需要将 API 密钥作为您的密码和用户名可以是任何东西）

```
<html>
    <head>
        <link href="styles.css" rel="stylesheet" type="text/css" />
        <title>PHP Bing</title>
    </head>
    <body>
        <form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">
            Type in a search:

            <input type="text" id="searchText" name="searchText"
                value="<?php
                        if (isset($_POST['searchText']))

                                   {
                            echo($_POST['searchText']);
                        }
                        else
                        {
                            echo('sushi');
                        }
                       ?>"
            />

            <input type="submit" value="Search!" name="submit" id="searchButton" />
            <?php
                if (isset($_POST['submit']))
                {
                    // Replace this value with your account key
                    $accountKey = 'BKqC2hIKr8foem2E1qiRvB5ttBQJK8objH8kZE/WJVs=';

                    $ServiceRootURL = 'https://api.datamarket.azure.com/Bing/Search/';

                    $WebSearchURL = $ServiceRootURL . 'Image?$format=json&Query=';

                    $context = stream_context_create(array(
                        'http' => array(
                            //'proxy' => 'tcp://127.0.0.1:8888',
                            'request_fulluri' => true,
                            'header' => "Authorization: Basic " . base64_encode($accountKey . ":" . $accountKey)
                        )
                    ));

                    $request = $WebSearchURL . urlencode( '\'' . $_POST["searchText"] . '\'');

                    echo($request);

                    $response = file_get_contents($request, 0, $context);

                    print_r($response);

                    $jsonobj = json_decode($response);

                    echo('<ul ID="resultList">');

                    foreach($jsonobj->d->results as $value)
                    {
                        echo('<li class="resultlistitem"><a href="' . $value->MediaURL . '">');

                        echo('<img src="' . $value->Thumbnail->MediaUrl. '"></li>');
                    }

                    echo("</ul>");
                }
            ?>
        </form>
    </body>
</html> 
```

我已经尝试过 google API 和 Yahoo API，没有一个比这更难。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T02:52:09.327

经过几天与微软技术支持的争论，他们承认它没有用

**这是在 BING API 中使用 CURL 执行此操作的正确编码，应用 CURL 方法而不是 file_get_contents 无法将正确的身份验证信息从 Linux 客户端传递到 BING 服务。**

```
<html>
    <head>
        <title>PHP Bing</title>
    </head>
    <body>
        <form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">
            Type in a search:

            <input type="text" id="searchText" name="searchText"
                value="<?php
                        if (isset($_POST['searchText']))

                                   {
                            echo($_POST['searchText']);
                        }
                        else
                        {
                            echo('sushi');
                        }
                       ?>"
            />

            <input type="submit" value="Search!" name="submit" id="searchButton" />
            <?php

                if (isset($_POST['submit']))
                {

            $credentials = "username:xxx";

                $url= "https://api.datamarket.azure.com/Bing/SearchWeb/Web?Query=%27{keyword}%27";        
                $url=str_replace('{keyword}', urlencode($_POST["searchText"]), $url);
                $ch = curl_init();

            $headers = array(
                    "Authorization: Basic " . base64_encode($credentials)
                );

                $ch = curl_init();
            curl_setopt($ch, CURLOPT_URL, $url);
                curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); 
                curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,5);
                curl_setopt($ch, CURLOPT_FAILONERROR, true);
                curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
                curl_setopt($ch, CURLOPT_AUTOREFERER, true);
                curl_setopt($ch, CURLOPT_TIMEOUT, 10);
            curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

                $rs = curl_exec($ch);
            echo($rs);
                curl_close($ch);
                return $rs;

        }

            ?>
        </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T14:37:16.160

我不得不添加

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
```

为了使它工作，至少在我的本地副本（WAMP）中。

希望对您有所帮助，我整天都在搞砸这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T21:13:27.007

```
$WebSearchURL = $ServiceRootURL . 'Image?$format=json&Query='; 
```

这是问题的一部分

这不会给出 bing 正在寻找的 url

```
e.g. https://api.datamarket.azure.com/Bing/SearchWeb/Web?Query=%27love+message%27 
```

这将是

```
https://api.datamarket.azure.com/Bing/Search/Image?$format=json&Query=%27love+message%27 
```

而您想要一个网络而不是图像搜索，并且格式和其他参数应该在查询之后

“图像”应该是“网络”

我花了 3 天的时间试图让它发挥作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-20T12:39:40.437

我刚刚发布了一个如何使用[Unirest 库](http://unirest.io/php)连接到 Bing/Azure API 的示例：[https ://stackoverflow.com/a/20096151/257815](https://stackoverflow.com/a/20096151/257815)

# android - cocos2d-2.0-rc2-x-2.0.1 Hello World 示例在 windows8 上使用 cygwin 不起作用

> ID：11451181
> 
> 赞同：0
> 
> 时间：2012-07-12T11:48:43.670
> 
> 标签：android, android-ndk, cygwin, cocos2d-x

我无法构建 helloWorld 示例以获取 .so 以在 Eclipse 中运行它。我已成功导入项目并根据需要将变量更改为我的根路径。这是我的 build_native.sh。我正在粘贴我在该文件中所做的唯一更改

```
NDK_ROOT_LOCAL=/cygdrive/e/android-ndk-r8
COCOS2DX_ROOT_LOCAL=/cygdrive/e/cocos2d 
```

我的 NDK 工作正常，因为我已经成功执行了 NDK 的 HelloWorld 示例。我的 SDK 版本是 20，NDK 版本是 8，我使用高于 1.7 的 cygwin。我已经在我的 NDK 目录上执行了 chown。但是当我在 cocos2d 的 HelloWorld 示例程序中运行命令 ./build_native.sh 时，我得到了这个错误

```
E:/android-ndk-r8/toolchains/arm-linux-androideabi-4.4.3/prebuilt/windows/bin/../lib/gcc/arm-          linux-androideabi/4.4.3/../../../../arm-linux-androideabi/bin/ld.exe: ./obj/local/armeabi/png.a: No such file: Permission denied
collect2: ld returned 1 exit status 
```

当我在我的 NDK 目录窗口中搜索 png.a 时，找不到该文件。我很困惑是权限错误还是文件不存在。但是我有最新的 NDK 如果文件不存在怎么会有人能够运行 cocos2d-x ？？？需要帮忙！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:38:15.883

当我也尝试过时，似乎缺少对构建文件的权限。

```
$ ls -l obj/local/armeabi/png.a
---------- 1 someuser Domain Users 912618 Jul 12 18:23 obj/local/armeabi/png.a 
```

[论坛](http://cocos2d-x.org/boards/6/topics/10521?r=10537#message-10537)上有一个[链接建议](http://www.cocos2d-x.org/boards/10/topics/4480?r=4484#message-4484)现在似乎无法访问。

无论如何，要修复，您可以设置文件的权限。

```
$ cd obj/local/armeabi/
$ chmod 664 *.a
$ cd ../../.. 
```

**编辑：**更好的[解决](https://stackoverflow.com/a/7082542/905908)方法可能是将 /etc/fstab 中的默认权限设置为

`none /cygdrive cygdrive binary,noacl,posix=0,user 0 0`

在此之后，您应该能够运行`./build_native.sh`.

您可以使用一个命令来定位当前目录下没有（读/写）权限的所有文件`find . -type f -perm 0`

请参阅此[答案](https://stackoverflow.com/a/1163346/905908)以设置工作目录下所有文件的写入权限。

如果您不熟悉它们，请考虑阅读有关[chmod的](http://www.perlfect.com/articles/chmod.shtml)[教程以了解 linux/unix 中的权限概念。](http://catcode.com/teachmod/)

# image - 巨大的图像即时重采样

> ID：11451182
> 
> 赞同：1
> 
> 时间：2012-07-12T11:48:45.750
> 
> 标签：image

我有一个巨大的图像（234 兆像素），我想以一种根据用户希望看到的区域大小动态重新采样的方式进行绘制。是否有任何工具支持这样做，或者我需要自己这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:09:02.740

通常，执行此操作的技术称为（图像）平铺渲染。基本上这就是谷歌地图等应用程序的工作方式。

[在google](https://www.google.com/search?q=image%20tiling%20library)上进行的快速搜索找到了一个 OpenGL 库，可以为您执行此操作（http://www.mesa3d.org/brianp/TR.html）。我敢肯定，如果这个库不符合您的技术需求，您应该能够发现其他一些内容。

# ruby-on-rails - Rails 控制器操作：自定义参数哈希中的键

> ID：11451189
> 
> 赞同：1
> 
> 时间：2012-07-12T11:49:09.183
> 
> 标签：ruby-on-rails

我正在开发 Rails 3.1.x 应用程序，我有以下一组模型：

```
class Widget
  include Mongoid::Document
  field :name
  embeds_many :comments
end

class ShinyWidget < Widget; end
class DullWidget < Widget; end  

class Comment
  include Mongoid::Document
  field :message
  embedded_in :widget
end 
```

所以基本上我需要允许评论与不同类型的小部件相关联。在我的路线中使用标准资源，例如：

```
resources: widgets do
  resources :comments
end 
```

这会公开诸如 、 等的 url `GET /widgets`。`GET /widgets/:widget_id/comments`但是，我想公开一个 API，用于向不同类型的小部件添加评论。我希望这些 API URL 看起来像：

```
GET /shinywidgets/:widget_id/comments
POST /shinywidgets/:widget_id/comments 
```

但是，我可以拥有一个 ShinyWidgetsController 和一个 DullWidgetsController，但我只想创建一个 CommentsController。由于我还没有想到让一个 CommentsController 来处理不同类型小部件的评论的好方法，所以我尝试了这个：

```
resources :widgets do
  get 'comments', to: 'widgets#comments_index'
  post 'comments', to: 'widgets#comments_create'
end 
```

当对 /widgets/:widget_id/comments 进行 POST 时，`params`哈希将发布的评论数据存储在一个名为`widget`而不是我希望的键中`comment`。

我知道使用过的 Rails 是否会将散列`resources :comments`中的那个键更改为，但是我可以告诉 Rails 在给定我当前设置的情况下如何命名该键吗？`params``comment`

目前我必须创建一个评论做这样的事情：

```
def comments_create
  widget = Widget.find(params.delete :widget_id)
  comment = widget.comments.create(params[:widget])
end 
```

我真的很想拥有：

```
comment = widget.comments.create(params[:comment]) 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:08:39.620

目前这是非常错误的。

为了使这项工作正常进行，您应该创建这样的路线

```
resources :widgets do
  get  'comments' => 'comments#index'
  post 'comments' => 'comments#create'
end 
```

并且在发布到此内容时`CommentsController`，您在`prams[:comment]`.

你的控制器会有这样的动作

```
def create
  widget = Widget.find(params.delete :widget_id)
  comment = widget.comments.create(params[:comment])
end 
```

# android - 是否可以将 Mozilla Persona (BrowserID) 与移动应用程序一起使用？

> ID：11451190
> 
> 赞同：14
> 
> 时间：2012-07-12T11:49:16.360
> 
> 标签：android, ios, mozilla, browserid

是否可以**轻松地**将[Mozilla Persona](http://www.mozilla.org/en-US/persona/)（[浏览器 ID](https://developer.mozilla.org/en/BrowserID/Why_BrowserID)）用于原生 iOS 和 Android 应用程序？还是从`web view`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T11:53:29.497

对于**iOS**，我刚刚发现：[https](https://github.com/mozilla/browserid-ios) ://github.com/mozilla/browserid-ios - 但是我还没有测试过。

此外，我还没有看到类似的 Android 项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-17T17:22:10.917

查看[android-browserid](https://github.com/seanmonstar/android-browserid)

[CouchChatAndroid](https://github.com/couchbaselabs/CouchChatAndroid)是一个使用 Persona 进行身份验证的开源项目。

# java - 如何解析mysql的json输出

> ID：11451197
> 
> 赞同：0
> 
> 时间：2012-07-12T11:49:39.760
> 
> 标签：java, android, json

我的android应用程序中有一个谷歌地图，我在mysql db中保存了一些经纬度数据，我想从mysql db中读取这些数据。我已经编写了代码，但应用程序仍然是错误的。

myphp 是：

```
 <?php
$link = mysql_connect('localhost', 'root', '') or die('Cannot connect to the DB');
mysql_select_db('joe', $link) or die('Cannot select the DB');

/* grab the posts from the db */
$query = "SELECT lattitude, longitude FROM tracking";
$result = mysql_query($query, $link) or die('Errorquery:  '.$query);

$rows = array();
while ($r = mysql_fetch_assoc($result)) {
$rows[] = $r;
}
$data = "{joel:".json_encode($rows)."}";
 echo $data;
?> 
```

我有 3 个 java 活动

```
public class lagiiiiteslagi extends ListActivity {

private static String url = "http://10.0.2.2/labiltrack/daftartracking.php";
// JSON Node names
private static final String TAG_lattitude = "lattitude";
private static final String TAG_longitude = "longitude";

// contacts JSONArray
JSONArray lattitude = null;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // Hashmap for ListView
    ArrayList<HashMap<String, String>> contactList = new        ArrayList<HashMap<String, String>>();

    // Creating JSON Parser instance
    JSONParser jParser = new JSONParser();
    // getting JSON string from URL
    JSONObject json = jParser.getJSONFromUrl(url);

    try {
         // Getting Array of Contacts
        lattitude = json.getJSONArray(TAG_lattitude);
        // looping through All Contacts
        for(int i = 0; i < lattitude.length(); i++) {
              JSONObject c = lattitude.getJSONObject(i);

            // Storing each json item in variable
              String lattitude = c.getString(TAG_lattitude);
              String longitude = c.getString(TAG_longitude);

           // Phone number is agin JSON Object
              //JSONObject phone = c.getJSONObject(TAG_PHONE);

              // creating new HashMap
              HashMap<String, String> map = new HashMap<String,String>();

              // adding each child node to HashMap key => value
              map.put(TAG_lattitude, lattitude);
              map.put(TAG_longitude, longitude);

              // adding HashList to ArrayList
              contactList.add(map);
               }
      } catch (JSONException e){
        e.printStackTrace();

      }

      /**
      * Updating parsed JSON data into ListView
      * */
     ListAdapter adapter = new SimpleAdapter(this, contactList,
            R.layout.main,
            new String[] { TAG_lattitude, TAG_longitude }, new int[] {
                    R.id.TextViewResult, R.id.TextViewResult1 });

      setListAdapter(adapter);

      // selecting single ListView item
      ListView lv = getListView();

     // Launching new screen on Selecting Single ListItem
     lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View view, int position,
                long id) {
            // TODO Auto-generated method stub
            // getting values from selected ListItem
            //String lattitude = ((TextView))  view.findViewById(R.id.TextViewResult)).getText().toString();
            //String longitude = ((TextView)) view.findViewById(R.id.TextViewResult1)).getText(lattitude).toString();
            String lattitude = ((TextView) view.findViewById(R.id.TextViewResult)).getText().toString();
            String longitude = ((TextView) view.findViewById(R.id.TextViewResult1)).getText().toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
            in.putExtra(TAG_lattitude, lattitude);
            in.putExtra(TAG_longitude, longitude);
            startActivity(in);              
        }

    });
    }
    } 
```

这个 JSONparser 类：

```
 public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser(){

}

public JSONObject getJSONFromUrl(String url) {
    // TODO Auto-generated method stub
    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();  

    }catch (UnsupportedEncodingException e){
        e.printStackTrace();
    }catch (ClientProtocolException e) {
        e.printStackTrace();
    }
    catch (IOException e) {
        e.printStackTrace();
    }
    try {
         BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            json = sb.toString();
    }catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try  {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }
    // return JSON String
    return jObj;
}

 } 
```

这用于在 listview 中显示：

```
 public class SingleMenuItemActivity extends Activity {
// JSON node keys
private static final String TAG_lattitude = "lattitude";
private static final String TAG_longitude = "longitude";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_list_item);

    // getting intent data
    Intent in = getIntent();

    // Get JSON values from previous intent
    String lattitude = in.getStringExtra(TAG_lattitude);
    String longitude = in.getStringExtra(TAG_longitude);

   // Displaying all values on the screen
     TextView lbllattitude = (TextView) findViewById(R.id.listlat);
    TextView lbllongitude = (TextView) findViewById(R.id.listlong);

    lbllattitude.setText(lattitude);
    lbllongitude.setText(longitude);

  } 
   } 
```

我只想在列表视图中显示纬度和经度，但仍然出错，我是 android 新手，希望有人能帮助我，在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:08:26.237

检查此[链接](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)以获取 json 帮助...我建议在不同的地方使用日志***来***`Log.e("JSON", json);`查找错误实际发生的点。

# c# - c# Install-SPUserSolution 中的嵌入式 powershell 脚本无法识别

> ID：11451199
> 
> 赞同：0
> 
> 时间：2012-07-12T11:49:48.710
> 
> 标签：c#, sharepoint, powershell, sharepoint-2010

我正在尝试通过将它们嵌入到 C# 代码中来运行 powershell 脚本，以便在 Sharepoint 站点上激活 (.wsp) 模板功能。我的代码如下

```
Command installCommand = new Command("Install-SPUserSolution");
installCommand.Parameters.Add("identity", "Template.wsp");
installCommand .Parameters .Add ("site", "siteURL");
// create Powershell runspace 
Runspace runspace = RunspaceFactory.CreateRunspace();

// open it 
runspace.Open()

// create a pipeline and feed it the script text 
Pipeline pipeline = runspace.CreatePipeline();
pipeline.Commands.AddScript(" Add-PsSnapin Microsoft.SharePoint.PowerShell");

pipeline.Commands.Add(installCommand);
//added just for reference since command dosen’t return anything
pipeline.Commands.Add("Out-String");

// execute the script 
Collection<PSObject> results = pipeline.Invoke();
//(This part of the code throws error saying Install-SPUserSolution is not a recognized cmdlet,function,script,…)

  // close the runspace 
 runspace.Close(); 
```

笔记：

1.  我尝试将整个命令添加为脚本，但我得到了同样的错误。
2.  我已经在 SharePoint 管理外壳命令提示符下尝试了该脚本，它在那里完美运行。
3.  我在 WCF 的库类中使用上述代码。
4.  我在 Visual Studio 中的每个子项目的所有平台都设置为“ANY CPU”，我使用的是 .net framework 3.5。
5.  我还检查了管理 shell 中可用的帮助选项，并且命令“Install-SPUserSolution”确实作为 Microsoft.Sharepoint.Powershell 的 cmdlet 存在。
6.  我正在使用客户端对象模型（COM）来完成我的任务，因此不能使用 C# 代码来激活功能，因为 COM 不支持它。

我完全不知道我可能做错了什么。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T09:44:23.540

我终于找到了我的问题的解决方案，因为我试图在 WCF 上运行此代码，所以我所要做的就是将 spadmin 帐户添加到我的应用程序池中，其中托管了 wcf，使用 sp.elevatepriviledges 委托和 turnh冒充

# iphone - Objective-C 等效于 curl 请求

> ID：11451205
> 
> 赞同：8
> 
> 时间：2012-07-12T11:50:08.747
> 
> 标签：iphone, objective-c, ios, xcode, curl

我试图在 Objective-C 中操纵这个 curl 请求：

```
curl -u username:password "http://www.example.com/myapi/getdata" 
```

我已经实现了以下内容，并且收到了数据获取`Domain=kCFErrorDomainCFNetwork Code=303`错误`NSErrorFailingURLKey=http://www.example.com/myapi/getdata`：

```
// Make a call to the API to pull out the categories
NSURL *url = [NSURL URLWithString:@"http://www.example.com/myapi/getdata"];
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

// Create the username:password string for the request
NSString *loginString = [NSString stringWithFormat:@"%@:%@", API_USERNAME, API_PASSWORD];

// Create the authorisation string from the username password string
NSData *postData = [loginString dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

[request setURL:url];
[request setHTTPMethod:@"GET"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData];

NSError *error;
NSURLResponse *response;
NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
```

我希望有人能发现我在尝试操纵 curl 请求时出错的地方，并指出我正确的方向。有什么明显的我错过了吗？从 API 返回的数据是 JSON 格式。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T13:13:44.103

我发现最好的办法是不要尝试在代码中进行身份验证，而是将其直接放在 URL 本身中。工作代码如下所示：

```
NSURL *url = [NSURL URLWithString: [NSString stringWithFormat:@"http://%@:%@@www.example.com/myapi/getdata", API_USERNAME, API_PASSWORD]];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];

[request setURL:url];
[request setHTTPMethod:@"GET"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];

NSError *error;
NSURLResponse *response;
NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T11:56:48.650

本指南似乎可以满足您的需求： [http ://deusty.blogspot.co.uk/2006/11/sending-http-get-and-post-from-cocoa.html](http://deusty.blogspot.co.uk/2006/11/sending-http-get-and-post-from-cocoa.html)

仅供参考，许多类都接受 initWithData，并且`NSData`有一个方法`dataWithContentsOfURL`，如果您想避免自己设置，`NSURLConnections`这可能是实现您正在寻找的更简单的方法。

# sql - SQL 在子查询中获取与每个结果匹配的第一行

> ID：11451206
> 
> 赞同：3
> 
> 时间：2012-07-12T11:50:17.417
> 
> 标签：sql, subquery

所以问题是这样的。我有一个包含 n 列数据的表，但我想为每组唯一的 3 列列出一行。

例如，假设表格的结构如下

```
ID | data1 | data2 | data3 | description | price | handler | creationTime | etc... 
```

我想要做的是使用这个子查询：

```
SELECT distinct data1, data2, data3 FROM Table_1 
```

... 获取 3 列的每个独特变体。但是我想为每个这样的结果从表中选择一个完整的行。

此查询用于大量使用并且需要优化，这就是为什么我不能使用表变量或 while 循环的原因。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:55:23.653

我认为您不了解 DISTINCT 的概念。如果你有：

```
ID  data1  data2 data3 description1 price1
ID  data1  data2 data3 description2 price2 
```

你期望结果是什么？`ID data1 data2 data3`将只返回一次，但是对于那些在相等的列中不同的其他列应该发生什么？

你总能做到

```
select distinct ID,  data1,  data2, data3, MAX(description1), MAX(price1) 
```

它会解析并给你一个结果，但它实际上并没有多大意义......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:07:28.933

如果您使用的是 SQL Server，则可以使用公用表表达式来执行此操作：

```
with minRow(ID) as 
    (select min(ID)
    from    Table_1
    group by data1, data2, data3)
select  t1.*
from    Table_1 t1 join minRow m1 on t1.ID = m1.ID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T14:30:58.883

你需要的是windows函数。这是从每个组返回“第一”行的查询：

```
select t.*
from (select t.*,
             row_number() over (partition by data1, data2, data3
                                order by (select NULL)) as seqnum
      FROM Table_1 t
     ) t
where seqnum = 1 
```

（这还包括最后一个带有“1”的 seqnum 列。）

这个想法是为每一行提供一个序列号并取第一个。“order by”子句是必需的。此查询中的语法只是在 SQL Server 中表示“我不关心顺序”的一种有效方式——这在其他数据库中有所不同。

# iphone - 如何自定义我的 Tabbar 控制器图标（背景图像）？

> ID：11451211
> 
> 赞同：1
> 
> 时间：2012-07-12T11:50:40.990
> 
> 标签：iphone, ios, ipad

![在此处输入图像描述](../Images/0d9fa79ac46c4167bca21f23f82909df.png)

我有一个 iphone 应用程序，我想在其中将我自己的图像显示为标签栏图标。但现在只有默认的 grayone 来了。我需要将其更改为我自己的图像？我浏览了很多链接，但似乎什么也没有非常清楚。有人可以知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:06:18.927

[请从这里](https://github.com/boctor/idev-recipes/tree/master/CustomTabBar)下载源代码并根据您的要求更改图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:40:05.533

您可以像这样在 tabBarItem 上设置图像：-

```
tabBarController = [[UITabBarController alloc] init];
tabBarController.delegate = self;
ViewController *viewObject= [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
UINavigationController *navView = [[UINavigationController alloc] initWithRootViewController: viewObject];
UITabBarItem *tabBarItem = [[UITabBarItem alloc] initWithTitle:@"Tutorial" image:[UIImage imageNamed:@"kb-emoji-U+E031.png"] tag:1];
navView.tabBarItem = tabBarItem;
tabBarController.viewControllers = [NSArray arrayWithObjects:navView,nil];
self.window.rootViewController = tabBarController; 
```

另请参阅此链接 -[点击我](http://kurrytran.blogspot.in/2011/10/ios-5-tutorial-creating-custom-tab-bar.html)

# drupal-7 - Drupal 7 书籍模块导航

> ID：11451212
> 
> 赞同：0
> 
> 时间：2012-07-12T11:50:41.643
> 
> 标签：drupal-7, drupal-modules

通常书籍模块会自动生成书籍导航，但我只想显示 4 本书中的 2 本书，我该怎么做？

*   书01
    *   子书01
    *   子书01
*   书02
    *   子书02
    *   子书02
*   ~~书03~~
    *   ~~子书03~~
    *   ~~子书03~~
*   ~~书04~~
    *   ~~子书04~~
    *   ~~子书04~~

谢谢大家的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T08:32:03.327

您可以创建一本新书，然后将要显示的两本书添加到这本书中。如：

*   新书

    *   书01
    *   书02

然后显示新书。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T16:25:29.710

为了能够正确显示/隐藏不同的书籍或章节，您可以安装 Book Helper ( [https://drupal.org/project/book_helper](https://drupal.org/project/book_helper) )，这对于允许您正在寻找的这种类型的自定义非常有用。

# javascript - 禁用socket.io的jsonpolling？

> ID：11451214
> 
> 赞同：2
> 
> 时间：2012-07-12T11:50:47.950
> 
> 标签：javascript, node.js, socket.io

由于 jsonpolling 弄乱了我的服务器，我想禁用它。我在互联网上找到了这个代码：

```
socket.set('transports', [ 'websocket', 'htmlfile', 'xhr-polling' ]) 
```

我把它放到“sockets.on（”connection“...”），所以它看起来像这样：

```
io.sockets.on('connection', function(socket) {
    socket.set('transports', [ 'websocket', 'htmlfile', 'xhr-polling' ],function(){
        ....code that I had directly in io.sockets.on("connection"...
    });
}); 
```

但是 jsonpolling 似乎仍然处于活动状态，因为它仍然会弄乱我的服务器！我能做些什么来防止这种情况发生？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T12:42:09.907

当您使用 初始化 socket.io 时`listen`，您可以使用配置选项指定一个对象：

```
var io = require('socket.io').listen(80, {
    transports: [...]
}); 
```

如果您需要在加载时间后更改它，您可以使用`io.set('transports', [...])`.

这会影响所有套接字，因此您只需调用一次，而不是为您创建的每个套接字调用。

# android - 具有 Divider 的 Listview 项目之间的距离

> ID：11451216
> 
> 赞同：3
> 
> 时间：2012-07-12T11:50:51.380
> 
> 标签：android, android-layout, android-listview, margin

我在这个主题上有几个关于 SO 的问题，但所有这些问题都与*Listview 项目之间的距离*有关，几乎所有答案都建议使用**透明分隔线**作为解决方案。

但就我而言，我已经在两个列表项之间设置了分隔符，那么如何在两个列表项之间应用一些边距/填充/距离？

任何帮助表示赞赏。

**xml:**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/listMainPlans"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:divider="@drawable/list_divide"
        android:dividerHeight="2dp" >
    </ListView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:03:20.023

根据[本教程](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)，您可以添加`padding`到**listview_item_row.xml**。

`ListView`使用您的适配器，您可以为您（教程中的WeatherAdapter.java）中的每个元素扩展此xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="10dp"> // <-----

     <ImageView  />

     <TextView  />

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:03:42.740

为该相对布局提供静态高度，例如：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/ic_innerbg">

    <RelativeLayout 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/item_background"
        android:minHeight="40dp">

    <TextView 
        android:id="@+id/txtTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="16dp"
        android:layout_centerVertical="true"
        android:layout_marginLeft="10dp"
        android:textColor="@color/blue"
        android:layout_marginRight="45dp"
        android:layout_marginTop="10dp"
        android:layout_marginBottom="10dp"
        android:textStyle="bold"/>

    <TextView 
        android:id="@+id/text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
         android:layout_alignParentRight="true"
         android:layout_centerInParent="true"
         android:layout_marginRight="10dp"/>

    </RelativeLayout>

</RelativeLayout> 
```

您将获得每行项目之间的距离

# c++ - 如何从 C++ 派生对象的集合中搜索和分配？

> ID：11451228
> 
> 赞同：0
> 
> 时间：2012-07-12T11:51:32.177
> 
> 标签：c++, architecture, containers

[对于我的问题](https://stackoverflow.com/questions/11434738/i-cant-assign-from-pointer-to-pointer-to-derived-class-and-pointer-to-pointer-t)的技术部分，我得到了一个很好的答案，即为什么我目前的处理方法不起作用（分配`derived**`给`base**`是类型不安全的，另请参阅[将 Derived** 转换为 Base** 和 Derived* 到 Base*](https://stackoverflow.com/questions/11264587/converting-derived-to-base-and-derived-to-base)）。但是，我仍然不知道如何以 C++ 方式实现我的想法。我开始一个新问题，因为最后一个标题太具体了。

这可能是对我正在尝试做的事情的更清晰的解释：

1.  创建多个对象，这些对象都是从一个类派生的类的实例。
2.  将这些对象与编译时人类可读的标识符（可能是字符串？）一起存储在某种类型的主容器中。
3.  从其他组件获取标识符列表，搜索主容器，并将它们传回（指针/引用）相应的对象，以便它们可以读取/修改它们。我认为此时我需要打破类型安全，并假设组件知道它们通过标识符请求的派生类型。

我认为这对于映射、向量和指向对象的指针来说会相对简单和优雅（我在[上一个问题](https://stackoverflow.com/questions/11434738/i-cant-assign-from-pointer-to-pointer-to-derived-class-and-pointer-to-pointer-t)中给出了一个简化的示例），但似乎我将不得不做很多 C-样式类型转换以允许组件传递指向位置的指针以存储来自主容器的值。这向我表明我没有遵循 C++ 范式，但我“应该”做什么？

[编辑]这是我如何设想的一些假设示例代码，希望这能澄清我的想法：

```
#include <map>
#include <vector>
#include <string>
using namespace std;

class BaseObj {};
class Der1Obj: public BaseObj {};
class Der2Obj: public BaseObj {};

typedef map<string, BaseObj**> ObjPtrDict;
typedef map<string, BaseObj*> ObjDict;

class BaseComp
{
public:
   ObjPtrDict objs;
};

class DervComp
{
   DervComp(){objs["d1"] = &d1; objs["d2"] = &d2; } // This wouldn't compile
   Der1Obj* d1;
   Der2Obj* d2;
}

typedef vector<BaseComp*> CompList;

void assign_objs(CompList comps, ObjDict objs)
{
   for (auto c = comps.begin(); c != comps.end(); c++)
     for (auto o = c.objs.begin(); o != c.objs.end(); o++)
       *(o->second) = objs[o->first];
}

int main(int argc, char* argv[])
{
    Der1Obj d, d1;
    Der2Obj d2;
    ObjDict objs;
    objs["d"] = &d;
    objs["d1"] = &d1;
    objs["d2"] = &d2;

    DervComp c;
    vector<DervComp*> comps;
    comps.push_back(&c);

    assign_objs(comps, objs); 

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:12:15.007

我读了你的另一篇文章，但我想我不明白你为什么要使用双指针。据我了解，您只需使用普通指针即可。

例如

```
class Base
{
};

class Deriv : public Base
{
};

std::map< std::string, Base* > ObjectStore;

function Component1( ... )
{
   Base* b = ObjectStore[ "MyObject" ];
   b->DoSomeFancyStuff();
}

function ModifyObjectStore( )
{
   delete ObjectStore[ "MyObject" ];
   ObjectStore[ "MyObject" ] = new Derived(); 

} 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:03:49.930

如果我得到了你想要的，你可以这样做：

```
#include <vector>

class Base
{
public:
    enum eDerived
    {
    //name these whatever you like
        DER1,//for first derived class
        DER2,//for second derived class
        DER3//for third derived class
    };

    virtual eDerived type() = 0;//this will return the class type.
};

class Derived1: public Base
{
public:
    virtual eDerived type() { return DER1; }
};

class Derived2: public Base
{
public:
    virtual eDerived type() { return DER2; }
};

class Derived3: public Base
{
public:
    virtual eDerived type() { return DER3; }
};

int main()
{
    std::vector<Base*> myList;//container for all elements
    //You can store a pointer to any of the derived classes here like this:
    Base * a = new Derived1();
    Base * b = new Derived2();
    Base * c = new Derived3();

    myList.push_back(a);
    myList.push_back(b);
    myList.push_back(c);

    //Iterating through the container
    for( Base * tmp: myList)
    {
        //You can check the type of the item like this:
        if( tmp->type() == Base::DER1 )
        {  
            //and cast to a corresponding type.
            //In this case you are sure that you are casting to the right type, since
            //you've already checked it.
            Derived1 * pointerToDerived1 = static_cast<Derived1 *>(tmp);
        }
    }
} 
```

Ofc 你可以选择任何类型的容器。如果你想给他们一个 ID，你可以使用`map`，或者将它添加到类本身中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:21:54.460

您说，“将它们传回相应的对象”。为此，您为什么要回传基地**？您可以简单地将 a 映射从字符串返回到指针。请参阅下面的代码进行解释。

```
class Container
{
    void add(const string& aKey_in, Base* b)
    {
        myObjects[aKey_in] = b;
    }
    void getObjs(list<string> aKeys_in, map<string,Base*>& anObjMap_out)
    {
        for(all string s in the aKeys_in)
            anObjMap_out[s] = myObjects[s];
    }
private:
    map<string, base*> myObjects;
}; 
```

您的条件在这里满足： *创建许多对象，这些对象都是从一个类派生的类的所有实例。* 您可以扩展该类以具有创建逻辑、工厂逻辑等。

*将这些对象与编译时人类可读的标识符（可能是字符串？）一起存储在某种类型的主容器中。* 用地图实现

*从其他组件获取标识符列表，搜索主容器，并将它们传回（指针/引用）相应的对象，以便它们可以读取/修改它们。我认为此时我需要打破类型安全，并假设组件知道它们通过标识符请求的派生类型。*

您不需要将指针传回指向客户端的指针。只需传回对象指针。

附加说明：您可以使用 shared_ptr 而不是原始指针来实现指针。如果您的客户端代码（使用 getObjs() 方法的任何人）编写正确，那么您将不需要从基指针到派生指针的动态转换。他们应该能够使用基指针。无论如何，这是一个你还没有问过的不同的问题。

# symfony - 如何从 Symfony2 中的 javascript 访问项目配置参数

> ID：11451234
> 
> 赞同：0
> 
> 时间：2012-07-12T11:51:44.270
> 
> 标签：symfony

我正在使用 Symfony 2.1 dev 并寻找从 app/config/parameters.yml (ini) 获取参数的最简单方法。

简单的例子：

我在 parameters.yml 中有记录

```
parameters:
    url: "http://domain.com" 
```

然后我想以某种方式在静态 js 文件中使用它

```
var url = "{{ app.url }}"; // trying to avoid hardcode 
```

此标记应替换为 config 之后的实际值

```
app/console assetic:dump 
```

所以最终的js会有

```
var url = "http://domain.com"; 
```

目前我正在考虑编写自己的控制台命令，但首先我想确保在 Symfony2 中没有任何标准的方式来做这些事情，或者可能是一些可以阻止我的包？

更新：我想用 AsseticBundle 来做这个，比如 YUI 和 LESS

```
assetic:
    debug:          %kernel.debug%
    use_controller: false
    write_to:       %kernel.root_dir%/../web
    filters:
        cssrewrite: ~
        lessphp: ~
        yui_js:
            jar: "%kernel.root_dir%/Resources/java/yuicompressor-2.4.6.jar"
        yui_css:
            jar: %kernel.root_dir%/Resources/java/yuicompressor-2.4.6.jar 
```

添加另一个过滤器，将 js 文件中的令牌 {{ app.url }} 替换为实际的“http://domain.com”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:40:21.477

一个简单的解决方案是在 twig 全局变量中引用您的参数：

```
parameters:
    url: "http://domain.com"
    an_array:
        twig: "is cool"
        and: "symfony2 to"

twig:
    globals:
        app_parameters:
            url: %url%
            an_array: %an_array% 
```

然后在您的模板中：

```
<script>
window.parameters = {{ app_parameters|json_encode|raw }};
</script> 
```

会呈现如下内容：

```
<script>
window.parameters = {"url":"http://domain.com","an_array":{"twig":"is cool","and":"symfony2 to"}};
</script> 
```

# winapi - winapi CComboBox 在编辑项上绘制

> ID：11451235
> 
> 赞同：0
> 
> 时间：2012-07-12T11:51:45.377
> 
> 标签：winapi, mfc, combobox, ccombobox

我在 WinApi/MFC 中编写我自己的控件 CCustomComboBox ，它继承自 CComboBox，我想绘制项目而不是仅将文本放入其中。

我通过定义样式 CBS_OWNDERDRAWVARIABLE 然后在 OnDrawItem 函数中绘制来实现这一点，但我不知道如何在 ComboBox（选择项）的主窗口上绘制。（组合框顶部的窗口）我可以调用它例如 SetWindowText()，但我想在上面画任何东西，例如 LineTo()。一般来说，我想将在组合框的特定项目上绘制的内容复制到编辑/主要项目。但首先要做到这一点，我想知道如何利用它。感谢您的建议！普热梅克

# jquery - IE7中没有出现按钮

> ID：11451236
> 
> 赞同：0
> 
> 时间：2012-07-12T11:51:53.017
> 
> 标签：jquery, css, button, dialog

使用 jquery，我构建了一个带有取消和确定按钮的对话框，该按钮在 IE 8 和 Firefox 等中正确显示，但在 IE7 中没有。即使在 IE7 中，如果我禁用然后启用该 input-type-button 元素的某些属性，按钮也会开始出现。

可能是什么原因？有没有类似的经历？

# performance - 性能差异

> ID：11451245
> 
> 赞同：0
> 
> 时间：2012-07-12T11:52:17.590
> 
> 标签：performance

假设我写了这样的代码

```
if(i==100)

{
    System.out.println("hello");
} 
```

或者我写这样的代码

```
if(i==100) System.out.println("hello"); 
```

以上两种代码的性能和效率会有什么不同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:54:12.537

性能没有差异，如果不使用括号，只会降低可读性。还因为您需要知道只有条件之后的第一行才会被执行。

# scala - 如何使用 Scala 在 Play!2 中提供上传的文件？

> ID：11451246
> 
> 赞同：16
> 
> 时间：2012-07-12T11:52:18.133
> 
> 标签：scala, playframework, playframework-2.0

我试图让用户将照片上传到服务器然后查看它们。上传按照[本指南中的说明](http://www.playframework.org/documentation/2.0/ScalaFileUpload)进行。这是代码：

```
def upload = Action(parse.multipartFormData) { request =>
  request.body.file("picture").map { picture =>
    import java.io.File
    val filename = picture.filename 
    val contentType = picture.contentType
    picture.ref.moveTo(new File("/tmp/picture"))
    Ok("File uploaded")
  }.getOrElse {
    Redirect(routes.Application.index).flashing(
      "error" -> "Missing file"
    )
  }
} 
```

我不清楚如何将上传的图像提供给想要查看它们的用户。现在我将服务器托管在我自己的机器上，因此指南中的代码片段将文件写入我的 D: 驱动器，该驱动器不能（也不应该）从 Internet 获得。据我所知，有两种选择：

1.  将照片存储在我的项目中的 /public 文件夹下（专用于资产的文件夹）。见这里：[http ://www.playframework.org/documentation/2.0/Assets](http://www.playframework.org/documentation/2.0/Assets)

2.  编写我自己的控制器，从我的驱动器中为自定义位置提供图像。

对于 1，我不确定这是否是资产的目的。对于 2，我不知道如何编写这样的控制器。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-10T18:07:28.390

简单的例子是

```
def index = Action {
  Ok.sendFile(new java.io.File("/tmp/fileToServe.pdf"))
} 
```

[https://www.playframework.com/documentation/2.4.x/ScalaStream#Serving-files](https://www.playframework.com/documentation/2.4.x/ScalaStream#Serving-files)有“服务文件”部分，它解释了如何提供文件

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T12:40:49.447

~~2.0.3 将具有一个可能（误）用于此的[外部资产控制器。](https://github.com/playframework/Play20/commit/7a27edadbcc2bf6f009f95e44381624e27bd27db)不过，编写这样的控制器并不神奇，您有预定义的文件夹，所有上传的内容都保存在该文件夹中，您可以从那里读取它们。在数据库中保存（唯一）文件名。~~

另一种方法是将上传的文件保存在数据库中。我们使用 MongoDB 中的[GridFS](http://www.mongodb.org/display/DOCS/GridFS)来实现这一点。自定义控制器将它们返回给用户。这样，您的数据将存储在一个中央位置，这也使备份和恢复更加简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T10:32:48.287

您可以像这样添加新路线：

```
GET     /myFiles/*file               controllers.Assets.at(path="/tmp", file) 
```

# c# - System.DBNull 错误

> ID：11451247
> 
> 赞同：2
> 
> 时间：2012-07-12T11:52:19.337
> 
> 标签：c#

我该如何解决这个问题？为什么图像文件制作 system.dbnull 错误？

```
 private void Form1_Load(object sender, EventArgs e)
    {
        SqlDataAdapter da = new SqlDataAdapter("select * from Categories", baglantiYolu);
        DataTable tablo = new DataTable();
        da.Fill(tablo);
        foreach (DataRow kategori in tablo.Rows)
        {
            Kategori k = new Kategori();
            k.KategoriID = int.Parse(kategori["CategoryID"].ToString());
            k.KategoriAdı = kategori["CategoryName"].ToString();
            k.UrunSayisi = UrunSayisiniGetir(int.Parse(kategori["CategoryID"].ToString()));
            k.Aciklama = kategori["Description"].ToString();
            k.Resim = (byte[])kategori["Picture"];
            listBoxKategoriler.Items.Add(k);
        }
    } 
```

![在此处输入图像描述](../Images/f8d8c9c58ef1f1e69910303d78637c62.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:56:13.780

如果该列的数据库返回值为 ，则`NULL`转换为`DBNull.Value`代码。

您需要检查这一点，因为它不会成功转换为`byte[]`. 像这样的东西：

```
object val = row["Pictire"];

if (val == DBNull.Value || val == null)
{
    k.Resim = new byte[0];
}
else
{
    k.Resim = (byte[])val;
} 
```

您将需要对所有可能为空的列进行类似的检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T11:54:12.013

问题是您没有图像，但该字段为空（null）。
您不能将 dbnull 值强制转换为其他值。
您首先必须检查是否为 null，如果没有读取它，则将其转换为`byte[]`.

```
object pict = kategori["Picture"];
k.Resim =  (pict == DBNull.Value) ? new byte[0] : (byte[])pict; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T11:56:25.607

您需要在转换之前检查 DBNull：

```
if( kategorie["Picture"] != DBNull.Value ) k.Resim = (Byte[])kategorie["Picture"]; 
```

# c# - 哪个事件捕获对 RichTextBox 的每次编辑？

> ID：11451250
> 
> 赞同：3
> 
> 时间：2012-07-12T11:52:46.200
> 
> 标签：c#, .net, wpf, events, richtextbox

在对文本进行任何更改后（例如，当用户按下一个键并插入一个字符时），我需要更新富文本框的格式。我怎样才能做到这一点？

KeyDown 发生得太早，无论如何都不会考虑按住键，KeyUp 发生得太晚，也不会考虑使用鼠标进行剪切或粘贴。

最好在更改甚至出现在屏幕上之前收到此事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:57:24.370

使用 TextChanged 事件了解文本何时发生更改

# jsf - PrimeFaces 如果 bean ViewScoped，则刷新使支持 bean 成员无效

> ID：11451253
> 
> 赞同：0
> 
> 时间：2012-07-12T11:52:54.267
> 
> 标签：jsf, jsf-2, primefaces

我正在使用 PrimeFaces UI 库和 JSF 2。

我有一个支持bean：

```
public class JobMgmtBean extends ClientBeanBase implements Serializable 
```

和

```
public class ClientBeanBase extends BeanBase 
```

（所以继承是`JobMgmtBean:ClientBeanBase:BeanBase`）。

我想将我`JobMgmtBean`的从请求范围设置为视图范围，但过了一会儿，我`sessionVars`定义的内容`BeanBase` **变为 null**并且 bean 不再起作用。

`sessionVars`我这样初始化`BeanBase`：

```
protected Map<String,Object> sessionVars = null;

ex = FacesContext.getCurrentInstance().getExternalContext();
sessionVars = ex.getSessionMap(); 
```

我每 5 秒刷新一次页面上的一些 PrimeFaces UI 组件（使用`<p:poll interval="5"...>`），几次刷新后`sessionVars`变为空。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T12:27:06.487

如果您可以在反序列化期间组装对象的状态，则可以使用 View 范围。

Java 为可序列化的类提供方法挂钩，您可以在其中执行自定义逻辑。

```
 private void writeObject(java.io.ObjectOutputStream stream) throws java.io.IOException {
        //custom logic
        stream.defaultWriteObject();
    }

    private void readObject(java.io.ObjectInputStream stream) throws java.io.IOException, ClassNotFoundException  {
        stream.defaultReadObject();
        // custom logic
    } 
```

您认为不想序列化的任何 bean 引用都可以将其标记为**瞬态**。

```
private transient Bean bean. 
```

> 这个 bean 不会被序列化，但问题是你有责任在方法钩子“readObject”中将引用设置回来

```
private void readObject(java.io.ObjectInputStream stream) throws java.io.IOException, ClassNotFoundException  {
        stream.defaultReadObject();
        // custom logic
        this.bean = ................ 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T11:50:05.017

ViewScoped bean 需要对对象进行序列化，而我的类扩展了许多具有太多对象的类，这些对象都需要序列化，这是不可能的。这意味着我在这里根本不能使用 ViewScoped。

# java - 模式语法错误

> ID：11451258
> 
> 赞同：1
> 
> 时间：2012-07-12T11:53:09.197
> 
> 标签：java, regex

以下正则表达式在 Eclipse 的查找对话框中工作，但在 Java 中引发异常。

我找不到原因

```
(?<=(00|\\+))?[\\d]{1}[\\d]* 
```

执行时出现语法错误：

```
Pattern.compile("(?<=(00|\\+))?[\\d]{1}[\\d]*") 
```

在我使用的查找中

```
(?<=(00|\+))?[\d]{1}[\d]* 
```

我想匹配带有或不带有 + 或 00 的电话号码。但这不是重点，因为我在位置 13 处遇到语法错误。如果我去掉第二个“？”，我不会收到错误消息。

```
Pattern.compile("(?<=(00|\\+))[\\d]{1}[\\d]*") 
```

请考虑，有时我需要使用更大的数字而不是 1，无论如何问题是关于语法错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:27:18.117

如果您的数据看起来像`00ddddd`或`+ddddd`d 是数字，那么您想获得[@Bergi](https://stackoverflow.com/a/11451509/1393766)的正则表达式`(?<=00|\\+)\\d+`就可以了。但是，如果您的数据有时没有任何您想忽略的部分，`ddddd`那么您可能应该使用组机制，例如

```
String[] data={"+123456","00123456","123456"};
Pattern p=Pattern.compile("(?:00|\\+)?(\\d+)");
Matcher m=null;
for (String s:data){
    m=p.matcher(s);
    if(m.find())
        System.out.println(m.group(1));
} 
```

输出

```
123456
123456
123456 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:08:31.123

您可能会大大缩短您的正则表达式。当内部只有一个类时不需要字符类 - 只需使用`\d`. 而且`{1}`也很没用。此外，您可以`+`用于匹配“一个或多个”（它是 的缩写`{1,}`）。接下来，不需要在您的lookbehind 中进行额外的分组。

最后，为什么lookbehind 是可选的（带有`?`）？如果你不需要它，就把它放在一边。这甚至可能是您的模式语法错误的来源 - 环顾不能是可选的。

试试这个：

```
/(?<=00|\+)\d+/ 
```

爪哇：

```
"(?<=00|\\+)\\d+" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:37:47.943

这是一个对我有用的例子：

```
public static void main(String[] args) {
        Pattern pattern = Pattern.compile("(?<=00|\\+)(\\d+)");
        Matcher matcher = pattern.matcher("+1123456");
        if (matcher.find()) {
            System.out.println(matcher.group(1));
        }
    } 
```

# css - 在 940 像素内放置四列

> ID：11451259
> 
> 赞同：0
> 
> 时间：2012-07-12T11:53:11.207
> 
> 标签：css, html

我正在尝试在宽度为 940 像素的容器中放置四列[http://jsfiddle.net/thiswolf/D3Z6g/](http://jsfiddle.net/thiswolf/D3Z6g/)但这些列并不完全适合。每列都有 220 像素和 20 像素的右边距，所以理想情况下它们应该适合好吧，如果我删除最后一列的右边距，但即使在那之后，它们也不适合。最后一列短了 12 像素。

我的浏览器是 Firefox 12

这是html

```
<!Doctype html>
<head>
<meta charset="uft-8">
<title>Four Columns Portfolio</title>
<style type="text/css">

.container{
width:940px;
border:1px dotted red;
height:auto;
}
li.portfolio{
display:inline-block;
width:220px;
height:180px;
background-color:orange;
margin-right:20px;
margin-bottom:10px;
}
li.every-forth{
background-color:orange;
width:208px !important;
margin-right:0;
}
.portfolio-div{
display:block;
margin-left:-40px;
}
</style>
</head>
<body>
   <div class="container">
   <div class="portfolio-div">
         <ul>
         <li class="portfolio">
         <p>Column 1</p>
         </li>
         <li class="portfolio">
         <p>Column 2</p>
         </li>
         <li class="portfolio">
         <p>Column 3</p>
         </li>
         <li class="every-forth portfolio">
         <p>Column 4</p>
         </li>
         </ul>  
    </div>
   </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:02:11.703

`inline-block`这是因为（like `inline`）元素之间的空间。为避免此问题，您有 2 个选项：

1.  `<li>`通过在s 之间添加 HTML 注释来删除空格

    ```
    <li class="portfolio">
        <p>Column 1</p>
    </li><!--
    --><li class="portfolio">
        <p>Column 2</p>
    </li> 
    ```

2.  去掉`<li>`s 之间的空格

    ```
    <li class="portfolio">
        <p>Column 1</p>
    </li><li class="portfolio">
        <p>Column 2</p>
    </li> 
    ```

但因为它是`<li>`，[它们不需要关闭](http://www.w3.org/TR/html5/syntax.html#optional-tags)，所以你可以这样做：

```
<li class="portfolio">
    <p>Column 1</p>
<li class="portfolio">
    <p>Column 2</p> 
```

前段时间我做了一个小[小提琴](http://jsfiddle.net/Calou/HcuAw/)，可以帮助你理解我在说什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:19:03.073

我终于让它像这样使用html5工作了

```
<!Doctype html>
<head>
<meta charset="uft-8">
<title>Four Equal Columns</title>
<style type="text/css">
html, body {
    margin:0;
    padding:0;
    height:100%;
}

.container {
    display:-moz-box;
    display:-webkit-box;
    display:box;
    -moz-box-orient:horizontal;
    -webkit-box-orient:horizontal;
    box-orient:horizontal;
    width:940px;
    margin-left:3%;
    border:1px dotted red;
}

.column {
    -moz-box-flex:1;
    -webkit-box-flex:1;
    box-flex:1;
    width:220px;
    margin-right:20px;
    background-color:#ddd;
}

.column p {
    background-color:orange;
    height:auto;
}
.every-forth{
margin-right:0;
}
</style>
</head>
<body>
    <div class="container">
    <div class="column">
        <p>Column 1"</p>
    </div>
    <div class="column">
        <p>Column 2</p>
    </div>
    <div class="column">
        <p>Column 3</p>
    </div>
     <div class="column every-forth">
        <p>Column 4</p>
    </div>
</div>
</body>
</html> 
```

这是一个小提琴[http://jsfiddle.net/thiswolf/YNf9N/](http://jsfiddle.net/thiswolf/YNf9N/)

# php - Nginx/PHP：发送 Etag 标头时 Nginx 未返回 304 响应

> ID：11451260
> 
> 赞同：2
> 
> 时间：2012-07-12T11:53:15.703
> 
> 标签：php, caching, header, nginx, etag

我正在尝试使用 ETags 和 nginx（1.2.1）服务器来理解本地缓存，它将 php 的请求重定向到 php-cgi 守护进程。

这是我的简单 index.php ：

```
<?php
header('Cache-Control: public');
header('Etag:"5954c6-10f4-449d11713aac0"');

echo microtime(true); 
```

在第二次请求之后，我的浏览器发送一个 If-None-Match 标头：

```
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4
Cache-Control:max-age=0
Connection:keep-alive
Host:cache.loc
If-None-Match:"5954c6-10f4-449d11713aac0" 
```

但我的网络服务器不返回 304 ：

```
HTTP/1.1 200 OK
Server: nginx/1.2.2
Date: Thu, 12 Jul 2012 11:46:03 GMT
Content-Type: text/html
Transfer-Encoding: chunked
Connection: keep-alive
X-Powered-By: PHP/5.3.12
Cache-Control: public
Etag: "5954c6-10f4-449d11713aac0"
Cache-Control: public 
```

除非我误解了，否则我的服务器应该将 Etag 与发送的 If-None-Match 进行比较并返回 304 响应，因为它们是相同的。

我哪里错了？我是否应该在我的 PHP 脚本中将 Etag 与 If-None-Match 进行比较，因为 nginx（或 Apache）本身不会完成这项工作？

问候，马努

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T11:55:09.690

如果您自己使用 php 实现此功能，*您*还需要负责发送 304 Not Modified。

So compare the If-None-Match header with your ETag, and use header() to send back the 304.

# iis - 如何配置 ARR - 应用程序请求路由 - 作为 Web 服务器应用程序和反向代理运行？

> ID：11451261
> 
> 赞同：0
> 
> 时间：2012-07-12T11:53:16.307
> 
> 标签：iis, iis-7, iis-7.5

我安装了带有 ARR 的 IIS7.5，并将其配置为另一台运行 IIS7 的服务器的反向代理。

在这个 IIS7.5 上，我安装了 ASP.NET 4 应用程序和简单的网站。

由于在此 IIS7.5 上配置场作为反向代理运行，因此本地应用程序不会运行并显示以下错误消息：

```
502 - Web server received an invalid response while acting as a gateway or proxy server.
There is a problem with the page you are looking for, and it cannot be displayed. When the Web server (while acting as a gateway or proxy) contacted the upstream content server, it received an invalid response from the content server. 
```

是否可以在此 IIS7.5 上同时运行本地应用程序和路由（反向代理），还是应该放弃并将应用程序移动到其他服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:47:32.343

应用程序请求路由作为服务器范围的 URL 重写器运行。

这意味着它会捕获*所有*进入盒子的流量。

您仍然可以在同一个盒子上托管一个 IIS 网站，但您需要确保 ARR 单独保留对该网站的请求。

我对此进行了设置，以便 ARR 规则在仍然保留通配符的同时`*`，确保部分匹配条件是对我的本地站点的请求保持不变。

您可以使用许多条件来创建`does not match`规则。

我用过：

`{HTTP_HOSTNAME}`如果您只是在执行 HTTP 请求，并且只想保留某些域名。

`{SERVER_PORT}`如果您托管的是 SSL 网站并且是包装盒上唯一的网站。

`{LOCAL_ADDR}`如果您的站点位于专用 IP 地址上。

更多......实际上，您只需要设置排除本地托管网站的规则。

# jquery - jquery # 滚动到顶部

> ID：11451262
> 
> 赞同：1
> 
> 时间：2012-07-12T11:53:16.797
> 
> 标签：jquery, href

> **可能重复：**
> [单击#-links 时避免窗口跳转到顶部](https://stackoverflow.com/questions/8240554/avoid-window-jump-to-top-when-clicking-links)

在我的网站上，我有可以点击的链接，jquery 会为它们处理一个事件。链接很简单，例如：

```
<a href=# class=bleh>click</a> 
```

问题是，我单击这样的链接，它会滚动到页面顶部（可能是因为#）。

有什么方法可以让页面根本不向上滚动并保持原样？

我知道我不需要 href 标签，但我希望它显示为链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T11:54:24.463

您可以尝试禁用链接上的默认点击行为`href="#"`。

```
$('[href="#"]').click(function (e) {
    e.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T11:54:31.287

您可以使用[`event.preventDefault()`](http://api.jquery.com/event.preventDefault/)它来阻止点击事件的默认操作：

> 如果调用该方法，则不会触发事件的默认动作。

```
$('.bleh').click(function(eve){
   eve.preventDefault()
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T11:57:24.983

```
$('.bleh').on('click', function(e) {
   e.preventDefault();
   return false;
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T11:57:36.043

或者你可以使用这个，稍微长一点，但有效

```
<a href="javascript:void(0);" class="bleh">click</a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T11:58:43.363

在“#”之后放置“void”应该会停止滚动并仍然允许事件触发。

```
<a href=#void class=bleh>click</a> 
```

# facebook - 使用 Facebook SDK 时“找不到访问令牌”

> ID：11451265
> 
> 赞同：1
> 
> 时间：2012-07-12T11:53:29.413
> 
> 标签：facebook, facebook-graph-api, blackberry

我有一个 BlackBerry 应用程序需要向用户的 Facebook 墙上发布消息。我正在使用[Facebook BlackBerry SDK](http://sourceforge.net/projects/facebook-bb-sdk/)。

我已经设置了一个简单的测试应用程序，它尝试通过调用以下方法在按下按钮时获取当前用户的详细信息：

```
private void postToFacebookWall(){

    String NEXT_URL = "http://www.facebook.com/connect/login_success.html";
    String APPLICATION_ID = "xxx"; //Removed for security
    String APPLICATION_SECRET = "xxx"; //Removed for security
    String[] PERMISSIONS = Facebook.Permissions.USER_DATA_PERMISSIONS;

    ApplicationSettings as = new ApplicationSettings(NEXT_URL, APPLICATION_ID, APPLICATION_SECRET, PERMISSIONS);
    Facebook fb = Facebook.getInstance(as);

    try {

        User user = fb.getCurrentUser();
        Logger.log("User has authenticated app and logged in. Name: "+user.getName());

    } catch (FacebookException e) {

        Logger.log(e.getMessage());
    }

} 
```

这是我单击按钮时发生的情况。

在系统日志中，我收到一条错误消息：找不到访问令牌。

然后显示以下登录屏幕：

![在此处输入图像描述](../Images/6931f32eac5663b6bd1390e6f995d6a8.png)

然后我被问到是否要验证这个应用程序：

![在此处输入图像描述](../Images/73780d0cb21856eb8b141a60954942b2.png)

单击“安装”或“取消”不会执行任何操作。

如果我通过网站登录 Facebook 并验证应用程序，那么我不会收到“找不到访问令牌”错误，并且一切都按预期工作。

如何正确验证我的 Facebook 应用程序以避免“找不到访问令牌”错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:24:37.593

实际上，任何具有相同方法的 BB 应用程序现在都无法授权。这是FB问题，但没有人急于修复它。

1.  这是我的问题： [Unable to pass FB OAuth for my application](https://stackoverflow.com/questions/11395874/unable-to-pass-fb-oauth-for-my-application)
2.  这是 FB 错误票： [https ://developers.facebook.com/bugs/401534949883394?browse=search_4ffad6fdebcfa6990918340](https://developers.facebook.com/bugs/401534949883394?browse=search_4ffad6fdebcfa6990918340)
3.  这是开发论坛上的主题：http: [//supportforums.blackberry.com/t5/Java-Development/FaceBook-API-error-code-11-Method-Deprecated/mp/1808833#M203977](http://supportforums.blackberry.com/t5/Java-Development/FaceBook-API-error-code-11-Method-Deprecated/m-p/1808833#M203977)

我找到了通过它的解决方法，但它不适用于所有操作系统/设备。使用 iPhone 用户代理**"Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML, like Gecko) Version/4.0 Mobile/7A341 Safari/528.16"**并在`BrowserField`.

请将 FB 问题标记为**转载**。因此，他们可能会提高优先级并更快地修复它。

更新：FB 解决了这个问题！请验证！

# c# - C# EF / LINQ hack 修复命中性能？其他固定方式？

> ID：11451274
> 
> 赞同：0
> 
> 时间：2012-07-12T11:53:58.073
> 
> 标签：c#, json, asp.net-mvc-3, linq, entity-framework

几个月来我一直在学习 C#/LINQ/ASP.NET/MVC 3/EF，现在来自 Java/Icefaces/Ibatis 基础（现实世界使用 .NET D；）。我真的很喜欢 .NET Framework 中的 LINQ / Entity Framework，但我在了解幕后真正发生的事情时遇到了一些问题。

这是我的问题：

我正在使用 AJAX / JSON 馈送的[jQuery](http://datatables.net/)数据表（我强烈推荐给任何需要免费网络数据表系统的人）。我的 MVC3 应用程序中有一个方法，它返回表所需数据的 JSON 结果，进行排序和所有操作。一切都运行良好且顺利。但是，我担心为了完成这项工作而不得不做的“肮脏”的黑客攻击。

这是完整的代码：

```
//inEntities is the Entity Framework Database Context
//It includes the following entities:
//  Poincon
//  Horaire
//  HoraireDetail
//Poincon, Horaire and HoraireDetail are "decorated" using the Metadata technic which
//adds properties methods and such to the Entity (Like getEmploye which you will see in
//the following snippet)
//
//The Entity Employe is not a database data and therefor not handled by the EF.
//Instead, it is a simple object with properties that applies Lazy Loading to get an
//Employe Name based off of his Employe ID in the Active Directory. An employe object
//can be constructed with his Employe ID which will expose the possibility of getting
//the Employe Name from the AD if needed.

[HttpPost]
public JsonResult List(FormCollection form)
{
    String sEcho;
    int iDisplayStart;
    int iDisplayLength;
    String sSearch;
    int iSortingCols;
    Dictionary<String, String> sorting;

    try
    {
        sEcho = form["sEcho"];
        iDisplayStart = int.Parse(form["iDisplayStart"]);
        iDisplayLength = int.Parse(form["iDisplayLength"]);
        sSearch = form["sSearch"];
        iSortingCols = int.Parse(form["iSortingCols"]);

        sorting = new Dictionary<string,string>();
        for (int i = 0; i < iSortingCols; i++)
            sorting.Add(form["mDataProp_" + form["iSortCol_" + i]].ToUpper(), form["sSortDir_" + i].ToUpper());
    }
    catch
    {
        HttpContext.Response.StatusCode = 500;
        return null;
    }

    var qPoincon = inEntities.Poincons.AsEnumerable();
    var lPoincon = qPoincon.Select(o => new
    {
        o.id,
        emp = o.getEmploye(),
        o.poinconStart,
        o.poinconEnd,
        o.commentaire,
        o.codeExceptions
    }).AsEnumerable();

    //Search
    lPoincon = lPoincon.Where(p => (p.emp.empNoStr.Contains(sSearch) || p.emp.empNom.Contains(sSearch) || (p.commentaire != null && p.commentaire.Contains(sSearch))));

    //Keep count
    int iTotalDisplayRecords = lPoincon.Count();

    //Sorting
    foreach(KeyValuePair<String,String> col in sorting)
    {
        switch (col.Key)
        {
            case "EMPNO":
                if (col.Value == "ASC")
                    lPoincon = lPoincon.OrderBy(h => h.emp.empNo);
                else
                    lPoincon = lPoincon.OrderByDescending(h => h.emp.empNo);
                break;
            case "POINCONSTART":
                if (col.Value == "ASC")
                    lPoincon = lPoincon.OrderBy(h => h.poinconStart);
                else
                    lPoincon = lPoincon.OrderByDescending(h => h.poinconStart);
                break;
            case "POINCONEND":
                if (col.Value == "ASC")
                    lPoincon = lPoincon.OrderBy(h => h.poinconEnd);
                else
                    lPoincon = lPoincon.OrderByDescending(h => h.poinconEnd);
                break;
            case "COMMENTAIRE":
                if (col.Value == "ASC")
                    lPoincon = lPoincon.OrderBy(h => h.commentaire);
                else
                    lPoincon = lPoincon.OrderByDescending(h => h.commentaire);
                break;
        }
    }

    //Paging
    lPoincon = lPoincon.Skip(iDisplayStart).Take(iDisplayLength);

    //Building Response
    var jdt = new
    {
        iTotalDisplayRecords = iTotalDisplayRecords,
        iTotalRecords = inEntities.Poincons.Count(),
        sEcho = sEcho,
        aaData = lPoincon
    };
    return Json(jdt);
} 
```

如您所见，当我从 EF 中获取“Poincons”的整个列表并将其转换为 Enumerable 时。根据我目前的理解，将 LINQ 查询转换为 Enumerable “杀死”到 EF 的链接，或者换句话说，将生成获取该列表所需的 SQL，而不是将 LINQ 数据保留到最后并执行只返回您需要的数据的精确查询。将此 LINQ 查询转换为 Enumerable 后，我对 LINQ 进行了大量过滤（因为在数据表中存在分页、排序、搜索）。这让我想到我的代码目前正在做的是“从数据库中获取所有“Poincons”并将其作为 Enumerable 放入 Web 服务器的内存中，

如果我是对的，那么当您点击几千个条目时，性能受到的影响非常大（一旦在生产中发生这种情况会非常快......每次员工上班时，它都会添加 1 个条目。100 名员工，~300一年的工作日，你懂的）。

这种 hack 的原因是 EF 不知道“Poincon”的“getEmploye”方法是什么，因此在运行时抛出类似于此的异常：

```
LINQ to Entities ne reconnaît pas la méthode « PortailNorclair.Models.Employe getEmploye() », et cette dernière ne peut pas être traduite en expression de magasin. 
```

近似翻译（如果有人可以在评论中让我知道如何配置 IIS / ASP.NET 以显示英文错误同时保持外语全球化，我将非常感激。有时缺少有关错误消息的法语信息）：

```
LINQ to Entity does not recognize the method " PortailNorclair.Models.Employe getEmploye()" and the following could not be translated to a SQL expression. 
```

“getEmploye”方法实例化并返回具有在 Poincon 对象中找到的员工 ID 的 Employe 对象。该 Employe 对象具有“延迟加载”信息的属性，例如来自 Active Directory 的员工姓名。

所以问题是：**如何避免在未过滤的对象列表上使用 .AsEnumerable() 对性能造成影响？**

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:45:20.193

> “getEmploye”方法实例化并返回具有在 Poincon 对象中找到的员工 ID 的 Employe 对象。该 Employe 对象具有“延迟加载”信息的属性，例如来自 Active Directory 的员工姓名。

您应该将员工姓名存储在数据库中，这样您就可以对 Linq 查询进行排序、排序、跳过和接收，而无需加载每个员工对象。

如果 empNoStr、empNom 和 empNo 都在数据库中，您可以只检索您想要的记录，并为每个记录调用 getEmploye()（从活动目录或任何地方加载您需要的任何其他内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:05:54.183

您的程序在某些类上执行其主要工作。

还有其他代表数据库行的类。

如果您将它们分开，您还可以将您打算在数据库中发生的操作与您打算在本地执行的操作分开。这使得在需要特定行时避免加载整个表变得微不足道。

我看到您也在本地进行分页，而数据库可以这样做并为您的网络服务器节省一些内存。

# apache - 在 Solr Highlight 中显示更多特征属性

> ID：11451276
> 
> 赞同：0
> 
> 时间：2012-07-12T11:54:07.867
> 
> 标签：apache, solr, highlight

如何从 Solr 高亮输出中获取更多特征字段？目前 Highlight 只返回文本片段和 docID。在索引步骤中，我将该功能与我想返回的其他字段一起编入索引。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T16:20:42.013

[`hl.fl`](http://wiki.apache.org/solr/HighlightingParameters/#hl.fl)您可以使用该参数指定其他字段以返回突出显示。对于多个额外字段，只需重复使用该字段即可。例如，如果您想在字段中突出显示`author`和`title`，您可以追加

```
&hl.fl=author&hl.fl=title 
```

到您的 Solr 查询。查看链接页面以了解其他突出显示选项。

# java - 获得一个精确的 JPanel 注册到 JPanel 并设置了 CardLayout

> ID：11451277
> 
> 赞同：1
> 
> 时间：2012-07-12T11:54:09.650
> 
> 标签：java, swing, layout, jpanel

我注册到 cardPanel 对象 3 JPanel。

```
JPanel cardPanel = new JPanel(new CardLayout());

cardPanel.add(viewPerf, "Performances");
cardPanel.add(viewFaults, "Faults");
cardPanel.add(viewGraph, "Throughput Graph"); 
```

我会得到一个 JPanel。我该怎么做这个操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:08:58.187

要在 a 中显示特定组件`CardLayout`，请使用该`CardLayout#show(String)`方法，并传递您在添加组件时为其提供的名称：

```
((CardLayout)cardPanel.getLayout()).show("Throughput Graph"); 
```

或者，您可以在创建布局时保存布局：

```
CardLayout cardPanelLayout = new CardLayout();
cardPanel.setLayout(cardPanelLayout);
...
cardPanelLayout.show("Throughput Graph"); 
```

编辑：要获得对当前可见组件的引用，我相信您可以这样做：

```
Component visibleComp = null;
for (Component comp : cardPanel.getComponents()) {
  if (comp.isVisible()) {
    visibleComp = comp;
    break;
  }
} 
```

# javascript - jquery 将输入字段值发送到弹出页面

> ID：11451281
> 
> 赞同：-1
> 
> 时间：2012-07-12T11:54:17.530
> 
> 标签：javascript, jquery, variables, post, popup

我有一个表格，表格显示来自 mysql 表格的数据，它有一个需要用户输入的字段。每行还包含一个 div。该表格有两个功能。

第一个功能是显示来自外部 PHP 页面的信息，该页面处理每一行中输入字段的值，并将结果以结果的形式发送到行 div

第一个功能完美运行，这是脚本：

```
<script type="text/javascript">
        function get(row){      //row being processed, defined in onchange="get(x)"
        $.post ('getpeopleinjobs.php',{     //data posted to external page
        postvarposition: form["position"+row].value,        //variable equal to input box, sent to external page
        postvarjob: form["job"+row].value,      //variable equal to input box, sent to external page
        postvarperson: form["person"+row].value,        //variable equal to drop down list, sent to external page
        postrow: row},      //variable equal row being processed, sent to external page
            function(output){ 
                $('#training'+row).html(output).show();     //display external results in row div
                    });
                }
</script> 
```

我需要帮助的第二个功能。我几乎需要再次重复相同的 javascript 函数。但是，我不想将行变量发送到外部页面，而是将它们发送到弹出页面。当我单击 div 中的 时，应该会触发此功能。

我有以下用于弹出窗口的 javascript。

```
 <script type="text/javascript">
    // Popup window code
    function newPopup(url) {
            popupWindow = window.open(      url,'popUpWindow','height=400,width=1000,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes')
    }
    </script>

What I want to do is send the variables to the popup page, the same variables that were sent to the external page.

so what I am aiming for is something like this:

<script type="text/javascript">
// Popup window code
function newPopup(url) {

            function get(row){      //row being processed, defined in onchange="get(x)"
        $.post ('trainingneeded.php',{      //my popup page
        postvarposition: form["position"+row].value,        //these variables must be posted to the popup page
        postvarjob: form["job"+row].value,      //these variables must be posted to the popup page
        postvarperson: form["person"+row].value,        //these variables must be posted to the popup page
        postrow: row},      //these variables must be posted to the popup page
        );
        }
    popupWindow = window.open( //open popup with the above variables posted to it
        url,'popUpWindow','height=400,width=1000,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes')
}
</script> 
```

我怎样才能使上述工作？使用 href 是最好的主意，或者 div 可以有一个 onclick 事件。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T22:21:09.447

不，不可能发布到弹出窗口。您可以将这些变量包含在 url 中并将其作为获取。

或者您可以将 target="_blank' 添加到表单中，并让它以这种方式打开一个新窗口。

它不会是一个弹出窗口，但这些天浏览器大多会阻止它们，或者无论如何都在标签中打开它们，所以它可能无关紧要。

另一种选择是用空白打开弹出窗口，然后使用 javascript`write()`将页面内容简单地添加到它。

另请参阅：[asp.net/jQuery：使用 jQuery 将数据发布到弹出窗口 [IE]](https://stackoverflow.com/questions/9130753/asp-net-jquery-post-data-with-jquery-to-a-popup-ie?rq=1)

# ios - 带有图像的 UIPagecontrol

> ID：11451292
> 
> 赞同：1
> 
> 时间：2012-07-12T11:54:38.167
> 
> 标签：ios, uiscrollview, pagecontrol

我正在尝试使用页面控制功能和 UIScrollView 在我的 IOS 应用程序上显示一组图像，我看过一些教程，但它们都显示了如何更改颜色，如何加载一些图像并使用页面控制通过他们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T07:10:25.147

```
-(void)loadScrollViewWithPage:(int)page;
{
    UIImageView *img=[[UIImageView alloc]initWithFrame:CGRectMake(scrollView.frame.size.width*page, 200, scrollView.frame.size.width, 100)];
    img.image=[UIImage imageNamed:[viewControllers objectAtIndex:page]];

    [scrollView addSubview:controller.view];
} 
```

`viewControllers`存储您拍摄的图像的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:12:10.087

使用 PageControl，您可以在视图中导航，因此您可以将图像视图放在视图上并将图像设置在图像视图上。

# ruby-on-rails - Koala GraphAPI 无法获取所有内容

> ID：11451296
> 
> 赞同：1
> 
> 时间：2012-07-12T11:54:48.120
> 
> 标签：ruby-on-rails, ruby, facebook, facebook-graph-api, koala

到目前为止，我已经阅读了大部分关于使用 Koala 查询 Facebook Graph 的教程，它们对我帮助很大。不过，我对考拉提供的结果并不完全满意。从我所见，获取用户的公共流时缺少共享状态/链接/图像：

```
@graph.get_connections("username", "feed", { :since => @date, :limit => 1000}) 
```

并且在获取粉丝页面的流时缺少其他人的帖子：

```
@graph.get_connections("fanpagename", "feed", { :since => @date, :limit => 1000}). 
```

这里有什么办法吗？我应该给 get_connections 函数什么以获得尽可能多的结果（这是我的主要基准）？到目前为止，我已经尝试过帖子、提要和状态——在我看来，提要给出了最好的结果。

# java - 从单击java的动作按钮到达变量数组

> ID：11451298
> 
> 赞同：0
> 
> 时间：2012-07-12T11:55:04.767
> 
> 标签：java, arrays, variables

我被编码困住了，我需要你的帮助。

好的，首先我在一个类下有一个数组变量。

我从 excel 中获取值并将其放入 nodename 数组中，如下所示。我缩短了以下代码。

以下类 Readexcel 也在 ConfigGenerator 类下。

```
class ReadExcel {
    private String inputFile;

    public void setInputFile(String inputFile) {
        this.inputFile = inputFile;
    }

    public void read() throws IOException {
        File inputWorkbook = new File(inputFile);
        Workbook nodes;
        try {
            nodes = Workbook.getWorkbook(inputWorkbook);
            // Get the first sheet
            Sheet nodessheet = nodes.getSheet(1);
            String[] nodename = new String[nodessheet.getRows()];
            for (int i = 1; i < nodessheet.getRows(); i++) {
                int j = 0;
                Cell x1a = nodessheet.getCell(0, i);
                nodename[j] = x1a.getContents();
                j++;
                // System.out.println(nodename[j]);
            }
        } catch (BiffException e) {
            // e.printStackTrace();
        }
    }
} 
```

但我的问题是通过按钮操作来达到这个变量。

```
 public class ConfigGenerator extends javax.swing.JFrame {
public ConfigGenerator() {
        initComponents();
        setSize(DEFAULT_WIDTH, DEFAULT_HEIGHT);
    }
        private void generateActionPerformed(java.awt.event.ActionEvent evt) {                                         
            try {
                Writer output = null;
                for (String name: Generator.ConfigGenerator.ReadExcel.nodename[????]){
                    System.out.println(name);
                }  
                output.close();
                System.out.println("Your files has been written."); 
            } catch (IOException ex) {
                Logger.getLogger(ConfigGenerator.class.getName()).log(Level.SEVERE, null, ex);
            }
        } 
    } 
```

我添加问号的部分是我最近 2 天的问题，但我无法从该数组中获取值。首先，我需要获取数组的长度，其次是值:) 非常感谢您提前提供的帮助。

好的，我通过添加带有代码的整个部分来编辑问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:06:25.167

也许你的意思是你想得到数组长度使用`nodename.length`，但我的代码有两个问题：

首先，您将其`nodename`作为本地数组访问`action`，然后将其作为`static`类的变量访问`ConfigGenerator`，这意味着你正在访问两个不同的数组。

此外，您将`nodename`数组作为`static`变量访问（尽管甚至`.class`不是必需的），但您将其称为“数组变量”，这意味着您需要首先创建一个新的 class 实例`ConfigGenerator`，初始化数组`nodename`，然后您可以使用它在其他类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:09:11.603

首先，Java中获取数组长度的方法是

```
nodename.length 
```

不是

```
nodename.getlength() 
```

但是您也可以使用缩短的语法来遍历特定数组中的所有元素：

```
for (Object obj : array) {
   System.out.println(obj);
} 
```

在您的情况下，它将是：

```
for (Object obj : ConfigGenerator.nodename) { //replace Object with your datatype
   System.out.println(obj);
} 
```

# security - Cgi 脚本 - 避免任何安全漏洞的注意事项

> ID：11451303
> 
> 赞同：0
> 
> 时间：2012-07-12T11:55:17.107
> 
> 标签：security, scripting, cgi

我有一个 cgi 脚本，它将调用一个 shell 脚本。shell 脚本将执行数据库查询并将该查询的结果存储在我服务器上的文件中。

cgi-script 将`DATABASE_NAME`,`HOST_IP`和`QUERY`作为输入，然后将其传递给 shell 脚本。

现在我非常担心它会造成的安全漏洞。

我正在做的一项检查是我正在解析查询以确保仅`SELECT`通过语句。如果任何`INSERT/UPDATE`类型的查询被传递，shell 脚本将不会被执行。

您能否指出可以利用此类 CGI 脚本的其他一些方法，以便我处理它们。

我的服务器运行为`userA`（具有 sudo 权限），shell 脚本中的查询将作为`userB`（dbadmin 用户）执行。

shell 脚本中执行查询的命令看起来像这样：

`sudo su -c "query" userB`

`DATABASE_NAME`and`HOST_IP`也在查询中传递。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:51:19.700

我希望您已经以某种方式对用户进行了身份验证，并且正在使用 HTTPS 来防止中间人攻击或嗅探身份验证信息和 CGI​​ 参数。

确保正确解析。您需要检查多语句查询。

此外，您可能希望考虑 DOS 攻击，因为编写 SELECT 查询非常容易，这将需要很长时间才能返回并使用大量资源。

此外，将允许的主机 IP 地址列入白名单，否则，我可以很容易地通过访问我的服务器来获取您的用户名和密码。

此外，将允许的数据库列入白名单以防止从系统表中读取。

# ios - 带有 iOS 5.0 的 Xcode 4.2 未检测到 iPhone iOS 5.1.1

> ID：11451304
> 
> 赞同：0
> 
> 时间：2012-07-12T11:55:19.650
> 
> 标签：ios, xcode, ios5, xcode4.2, iphone-4

我不久前从 Xcode 3 更改为 Snow Leopard 的 Xcode 4.2。一切都很好，我为 iPhone 开发了应用程序，直到今天一切都很顺利......我得到了警报：

> “iPhone Prophone”上的 iOS 版本与使用此 iOS SDK 安装支持开发的任何 iOS 版本不匹配。请将设备恢复到以下列出的操作系统版本，或更新到最新版本的 iOS SDK；可在此处获得。

这很奇怪，因为昨天我能够通过简单的“运行”测试我的应用程序**针对 iOS 5.0**（Xcode 目标 5.0，4C199）与我的 iPhone 4S，它有 iOS 5.1.1 (9B206) 很长一段时间。在 Organizer->Devices 中，我的 iPhone 有一个黄点，表明有问题。我不认为我做了什么出乎意料的事情，只是来了，打开了 mac 并启动了 Xcode ......有什么解决方案吗？

我读过[，](https://stackoverflow.com/questions/7812477/xcode-4-2-cant-build-to-a-device)但正如我所说 - 我使用新的 Xcode 几个星期，突然发生这种“未检测”......
我被卡住了，谢谢你的帮助。

编辑：
我在 SO 上找到了与这个[主题](https://stackoverflow.com/questions/9613565/is-is-possible-to-get-the-ios-5-1-sdk-for-use-with-xcode-4-2-on-snow-leopard)相关的内容，但我会等一下——也许有一些更简单或更明显的东西我错过了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T12:04:14.697

我设法通过以下方式解决了这个问题：
1) 下载 xcode 4.3.1
2) 从包内容 SDK & Device Support for iOS 5.1 复制到 Xcode 目录
3) 在您的设备上运行和测试

在这里找到的解决方案：[iOS 5.1 with Xcode 4.2 and Retina in iPad 3](https://stackoverflow.com/questions/9611596/ios-5-1-with-xcode-4-2-and-retina-in-ipad-3/9728951#9728951)

# svn - ubuntu 有颠覆管理器吗？

> ID：11451306
> 
> 赞同：1
> 
> 时间：2012-07-12T11:55:22.657
> 
> 标签：svn

我尝试设置我的 ovn svn 服务器。

我已经安装了 Ubuntu、apache2、mysql、subversion、subversion apache 模块。

但是颠覆配置对我来说非常困难。有任何 ubuntu 的 subversion 管理器，我可以通过 web 使用它来配置我的 subversion 服务器，创建新的用户帐户和存储库？

如果存储库可以从网络（如谷歌代码）获得，那也将是很好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:07:06.453

如果您正在寻找基于 Web 的 SVN 服务器管理界面，您可以查看

*   用 PHP 编写的[用户友好的 SVN (USVN)](http://usvn.info/en)

*   [sventon](http://www.sventon.org/)如果您更喜欢 JAVA 解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:27:42.403

[uberSVN](http://www.ubersvn.com/)为您提供了一个 GUI 来管理存储库、团队、用户和 apache 设置，并且是跨平台的。

# ssrs-2008 - 报表生成器 .rdl 检查数组键是否存在

> ID：11451307
> 
> 赞同：0
> 
> 时间：2012-07-12T11:55:23.403
> 
> 标签：ssrs-2008, reporting-services

我正在制作报告，我需要将逗号分隔的字符串拆分为表格的三列。

```
string = 'some text, some text, some text' 
```

但刺痛并不总是有两次昏迷，即

```
string = 'some text, some text' 
```

所以当我尝试获取第三列的值时

```
=Split(Fields!GLDescription.Value, ", ").GetValue(2) 
```

此代码可能会导致列中出现“#Error”消息。我试图通过像这样检查长度来解决这个问题

```
=IIF(Split(Fields!GLDescription.Value, ", ").Length >= 3, Split(Fields!GLDescription.Value, ", ").GetValue(2), "") 
```

但它仍然导致同样的错误。无论如何要检查数组键是否存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T16:38:46.007

如您所见，问题在于 SSRS`IIf`表达式不擅长短路。我可以想到一种适用于 2 列和 3 列字段的解决方法。

尝试如下表达式：

```
=IIf(
    Split(Fields!GLDescription.Value, ", ").Length = 3
    , Mid(
        Fields!GLDescription.Value
        , InStrRev(Fields!GLDescription.Value, ", ") + 2
        , Len(Fields!GLDescription.Value) - InStrRev(Fields!GLDescription.Value, ", ") + 2
    )
    , "No val 3"
) 
```

使用数据集：

![在此处输入图像描述](../Images/f95a160134c7777d88dabfea71085ea8.png)

给出结果：

![在此处输入图像描述](../Images/45896bc35afa122e3f8d57ac6bbbd2ef.png)

对于所有可能的情况，它并不是万无一失的，但对于您的数据来说可能就足够了。

# actionscript-3 - Flex 4.6 Spark 标签未正确显示泰语

> ID：11451309
> 
> 赞同：1
> 
> 时间：2012-07-12T11:55:25.563
> 
> 标签：actionscript-3, flash, apache-flex, unicode, thai

我有一个使用 itemrenderer 的火花列表组件。这是一个化身（图像）和人名的列表。拉丁语和其他语言可以正确显示，但对于泰语，它只显示方框。请帮忙！

这是我使用的代码：

```
<?xml version="1.0" encoding="utf-8"?>
  <s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"
    xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:mx="library://ns.adobe.com/flex/mx"
    xmlns:bd="com.bdement.imagecache.*"
    autoDrawBackground="false" width="270" height="45">
    <fx:Script>
      <![CDATA[
      override public function set data(object:Object):void {
        userName.text = "อีฟ จันทโรทัย";
      }
      ]]>
    </fx:Script>
    <s:HGroup click="onFriendClickReceived(event)" verticalAlign="middle"
      color.normal="#000000" horizontalAlign="left" width="270" height="45">
      <s:Spacer width="10"/>
      <bd:CachedImage id="userImage" cacheId="F32x32" width="32" height="32"
      left="8" verticalCenter="0"/>
      <s:Label id="userName" width="188" maxDisplayedLines="1" fontLookup="auto"
      fontFamily="Arial Unicode MS, Arial" verticalCenter="0" />
    </s:HGroup>
  </s:ItemRenderer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:40:05.970

您必须为您的语言定义一个 fontFamily。获取一个支持泰语的字体，然后像这样嵌入：

```
[Embed(source="font.ttf", mimeType="application/x-font", embedAsCFF="true", fontFamily="ThaiFontFamily")]
private var ThaiFont:Class; 
```

然后在你的 creationComplete 处理程序中嵌入这样的字体：

```
Font.registerFont(ThaiFont); 
```

在此之后，您可以自由地在 CSS 中使用您的 fontFamily 或直接在 MXML 中的标签上使用。像这样：

```
<s:Label id="userName" width="188" maxDisplayedLines="1" fontLookup="auto" fontFamily="ThaiFontFamily" verticalCenter="0" /> 
```

# list - 未请求密钥时 CouchDB 列表视图错误

> ID：11451311
> 
> 赞同：1
> 
> 时间：2012-07-12T11:55:33.253
> 
> 标签：list, view, couchdb, couchapp

我使用 CouchApp 编写的列表函数出现问题，从视图中获取名称，后跟 id 的哈希列表和为用户创建 CSV 文件的值。

```
function(head, req) {
    // set headers
    start({ "headers": { "Content-Type": "text/csv" }}); 

    // set arrays
    var snps = {}; 
    var test = {};
    var inds = [];

    // get data to associative array
    while(row = getRow()) {
        for (var i in row.value) {
            // add individual to list
            if (!test[i]) {
                test[i] = 1;
                inds.push(i);
            }   

            // add to snps hash
            if (snps[row.key]) {
                if (snps[row.key][i]) {
                    // multiple call
                } else {
                    snps[row.key][i] = row.value[i];
                }
            } else {
                snps[row.key] = {};
                snps[row.key][i] = row.value[i];
            }
            //send(row.key+" => "+i+" => "+snps[row.key][i]+'\n');
        }
    }

    // if there are individuals to write
    if (inds.length > 0) {
        // sort keys in array
        inds.sort();

        // print header if first
        var header = "variant,"+inds.join(",")+"\n";
        send(header);

        // for each SNP requested
        for (var j in snps) {
            // build row
            var row = j;
            for (var k in inds) {
                // if snp[rs_num][individual] is set, add to row string
                // else add ?
                if (snps[j][inds[k]]) {
                    row = row+","+snps[j][inds[k]];
                } else {
                    row = row+",?";
                }
            }

            // send row
            send(row+'\n');
        }
    } else {
        send('No results found.');
    }
} 
```

如果我使用 ?key="something" 或 ?keys=["something", "another] 请求 _list/mylist/myview （其中 mylist 是上面的列表函数并且视图返回如上所述），那么它可以工作，但删除查询字符串，我收到以下错误：

```
{"code":500,"error":"render_error","reason":"function raised error: (new SyntaxError(\"JSON.parse\", \"/usr/local/share/couchdb/server/main.js\", 865)) \nstacktrace: getRow()@/usr/local/share/couchdb/server/main.js:865\n([object Object],[object Object])@:14\nrunList(function (head, req) {var snps = {};var test = {};var inds = [];while ((row = getRow())) {for (var i in row.value) {if (!test[i]) {test[i] = 1;inds.push(i);}if (snps[row.key]) {if (snps[row.key][i]) {} else {snps[row.key][i] = row.value[i];}} else {snps[row.key] = {};snps[row.key][i] = row.value[i];}}}if (inds.length > 0) {inds.sort();var header = \"variant,\" + inds.join(\",\") + \"\\n\";send(header);for (var j in snps) {var row = j;for (var k in inds) {if (snps[j][inds[k]]) {row = row + \",\" + snps[j][inds[k]];} else {row = row + \",?\";}}send(row + \"\\n\");}} else {send(\"No results found.\");}},[object Object],[object Array])@/usr/local/share/couchdb/server/main.js:979\n(function (head, req) {var snps = {};var test = {};var inds = [];while ((row = getRow())) {for (var i in row.value) {if (!test[i]) {test[i] = 1;inds.push(i);}if (snps[row.key]) {if (snps[row.key][i]) {} else {snps[row.key][i] = row.value[i];}} else {snps[row.key] = {};snps[row.key][i] = row.value[i];}}}if (inds.length > 0) {inds.sort();var header = \"variant,\" + inds.join(\",\") + \"\\n\";send(header);for (var j in snps) {var row = j;for (var k in inds) {if (snps[j][inds[k]]) {row = row + \",\" + snps[j][inds[k]];} else {row = row + \",?\";}}send(row + \"\\n\");}} else {send(\"No results found.\");}},[object Object],[object Array])@/usr/local/share/couchdb/server/main.js:1024\n(\"_design/kbio\",[object Array],[object Array])@/usr/local/share/couchdb/server/main.js:1492\n()@/usr/local/share/couchdb/server/main.js:1535\n@/usr/local/share/couchdb/server/main.js:1546\n"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:01:37.823

不能肯定地说，因为您提供的细节很少，但是，问题的一个可能来源是使用数组从每一行收集数据：它消耗不可预测的内存量。这可以解释为什么当您查询几条记录时它会起作用，而当您查询所有记录时它会失败。

您应该尝试以一种无需在将输出发送到客户端之前收集所有值的方式来排列数据。请记住，虽然 map 和 reduce 结果保存在磁盘上，但列表函数会在每个查询上执行。如果你不保持列表功能快速和精简，你就会遇到问题。

# c# - 在 TextBlock 中换行

> ID：11451312
> 
> 赞同：10
> 
> 时间：2012-07-12T11:55:40.927
> 
> 标签：c#, wpf, textblock

是否有可能像在 HTML 中那样为 Textblock 提供自动换行建议，`<SHY> (soft hyphen)`或者`<WBR> (word break)`甚至更复杂且不易维护`zero-width-space &#8203;`

目前，Textblock 会根据需要中断单词，最终以换行形式结束，例如

> 堆栈
> 溢出

我想要的是：

> 堆栈
> 溢出

或者至少：

> 堆叠
> 流

如果有推荐的方法来实现所需，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T07:06:02.347

设置`TextBlock.IsHypenationEnabled`为 true 实际上会做类似的事情，但是如果你想使用标签，你可以使用这样的方法：

```
 /// <summary>
    /// Adds break to a TextBlock according to a specified tag
    /// </summary>
    /// <param name="text">The text containing the tags to break up</param>
    /// <param name="tb">The TextBlock we are assigning this text to</param>
    /// <param name="tag">The tag, eg <br> to use in adding breaks</param>
    /// <returns></returns>
    public string WordWrap(string text, TextBlock tb, string tag)
    {
        //get the amount of text that can fit into the textblock
        int len = (int)Math.Round((2 * tb.ActualWidth / tb.FontSize));
        string original = text.Replace(tag, "");
        string ret = "";
        while (original.Length > len)
        {
            //get index where tag occurred
            int i = text.IndexOf(tag);
            //get index where whitespace occurred
            int j = original.IndexOf(" ");
            //does tag occur earlier than whitespace, then let's use that index instead!
            if (j > i && j < len)
                i = j;
            //if we usde index of whitespace, there is no need to hyphenate
            ret += (i == j) ? original.Substring(0, i) + "\n" : original.Substring(0, i) + "-\n";
            //if we used index of whitespace, then let's remove the whitespace
            original = (i == j) ? original.Substring(i + 1) : original.Substring(i);
            text = text.Substring(i + tag.Length);
        }
        return ret + original;
    } 
```

这样你现在可以说：

```
textBlock1.Text = WordWrap("StackOver<br>Flow For<br>Ever", textBlock1, "<br>"); 
```

这将输出：

![刚刚测试](../Images/772dafa573d5e23f5a23e37f71fd3ac7.png)

但是，仅使用不带标签的 IsHyphenated，它将是：

![IsHypehnated Scenario1](../Images/e3fb9b72655cf3150092967c72152d93.png)

尽管：

```
textBlock1.Text = WordWrap("StackOver<br>Flow In<br> U", textBlock1, "<br>"); 
```

将输出：

![此处不添加 <brs>](../Images/dbd0cf554d5cbb00680f17c286c9cbe4.png)

并且 IsHyphenated 没有标签：

![IsHyphenated 场景 2](../Images/f0d67bedc26783d64c72107935c8e6b0.png)

**编辑：** 在减小字体大小时，我发现我发布的第一个代码不*喜欢*在用户指定的中断出现空格的地方添加中断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T13:27:50.023

将`TextFormatter`与 custom 结合使用`TextSource`来控制文本的分解和包装方式。

*   [http://msdn.microsoft.com/en-us/library/ms754036](http://msdn.microsoft.com/en-us/library/ms754036)

您需要从 TextSource 派生一个类，并在您的实现中分析您的内容/字符串并提供您的包装规则，例如寻找您的 <wbr> 标签...当您看到一个标签时，您返回一个`TextEndOfLine`else 您返回一个`TextCharacters`.

可以帮助实现 a 的示例`TextSource`如下：

*   [http://archive.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=wpfsamples&DownloadId=10113](http://archive.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=wpfsamples&DownloadId=10113)

对于一个非常高级的示例，请查看也使用它的“AvalonEdit”：

*   [http://community.sharpdevelop.net/forums/p/10187/28231.aspx](http://community.sharpdevelop.net/forums/p/10187/28231.aspx)

`GlyphRun`如果您不需要丰富的格式，您也可以进行调查。

*   [http://msdn.microsoft.com/en-us/library/bb613560.aspx](http://msdn.microsoft.com/en-us/library/bb613560.aspx)

# ruby - 从内部获取 Linux 中 Ruby 进程的内存使用情况的好方法？

> ID：11451314
> 
> 赞同：1
> 
> 时间：2012-07-12T11:55:50.507
> 
> 标签：ruby, linux, memory

我想要一种从自身内部获取 Linux 中 Ruby 进程的内存使用情况的好方法。为此，我定义了一个 Ruby 函数 vmrss()，它返回当前进程的驻留集大小：

```
#!/usr/bin/env ruby
def vmrss
    File.readlines('/proc/self/status').select {|l| l =~ /VmRSS/}.first.split[1..-1].join(" ")
end

puts "My current memory consumption: #{vmrss}" 
```

有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:58:34.083

您可以使用[proc-wait3 库](http://raa.ruby-lang.org/project/proc-wait3/)，它添加了`Process.getrusage`. 它可以节省你自己实现低级的东西，但是如果你只想要内存使用，包括一个库可能是矫枉过正的，特别是考虑到有一段时间没有更新。

# ravendb - RavenDB 字典上的静态索引

> ID：11451320
> 
> 赞同：4
> 
> 时间：2012-07-12T11:56:22.440
> 
> 标签：ravendb

我有一个使用文档的应用程序，其中包含字典中的属性列表，出于某种原因，我们需要使用静态索引并查询/过滤这些属性。

原型如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        IDocumentStore store = new DocumentStore() { DefaultDatabase = "Test", Url = "http://localhost:8081" };
        store.Initialize();

        IndexCreation.CreateIndexes(typeof(Program).Assembly, store);

        using (var session = store.OpenSession())
        {
            session.Store(new Document { Id = "1", Name = "doc_name", Attributes = new Dictionary<string, object> { { "Type", "1" }, { "Status", "Active" } } });
            session.SaveChanges();
        }

        using (var session = store.OpenSession())
        {
            // works
            var l1 = session.Query<Document, Documents_Index>().Where(a => a.Attributes["Type"] == "1").ToList();
            // not working
            var l2 = session.Query<Document, Documents_Index>().Where(a => a.Attributes["Status"] == "Active").ToList();
        }
    }
}

public class Documents_Index : AbstractIndexCreationTask<Document>
{
    public Documents_Index()
    {
        Map = docs => docs.Select(a =>
         new
         {
             a.Name,
             a.Attributes,
             Attributes_Type = a.Attributes["Type"]
         });
    }
}

[Serializable]
public class Document
{
    public string Id { get; set; }
    public string Name { get; set; }
    public Dictionary<string, object> Attributes { get; set; }
} 
```

但是由于我需要使用任意属性名称/值进行查询，所以这个索引确实解决了我们的问题。实际上属性列表在运行时是已知的（因此我们尝试修改 Map 表达式以注入任意数量的属性名称，但到目前为止我们还没有成功）。有没有办法以某种动态方式定义索引？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T07:53:28.560

你需要这样写：

```
public class Documents_Index : AbstractIndexCreationTask<Document>
{
    public Documents_Index()
    {
        Map = docs => docs.Select(a =>
         new
         {
             a.Name,
             _ = a.Attributes.Select(x=>CreateField("Attributes_"+x.Key, x.Value),
         });
    }
} 
```

# configuration - struts2约定插件中struts.convention.action.mapAllMatches的实际含义是什么

> ID：11451326
> 
> 赞同：0
> 
> 时间：2012-07-12T11:56:43.463
> 
> 标签：configuration, struts2, convention

的实际含义是什么

```
struts.convention.action.mapAllMatches 
```

在 struts2 约定插件中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:34:16.340

它允许（或者应该，我从未真正做过）在没有明确`@Action`注释的情况下查找操作。例如，如果一个动作没有实现`Action`并且没有注释，它可能不会被拾取。

# iphone - 从资源中选择图像并加载到 Web 视图中

> ID：11451329
> 
> 赞同：1
> 
> 时间：2012-07-12T11:56:49.893
> 
> 标签：iphone, uiwebview, resourcebundle

我在资源的文件夹 ABC 中有一张图片说 point.png。

我想在 html 中显示该图像

```
NSString *myFilePath=   [[NSBundle mainBundle] pathForResource:@"Point1" ofType:@"png"];
NSMutableString *strForWebView = [NSString stringWithFormat:@"<html>"
                                          "<head><b>%@</b></head><br>"
                                          "<img src= %@ height='30' width='30' />"
                                          , [[play quotations] objectForKey:@"Heading"], myFilePath, ....... 
```

所以现在我应该怎么做才能选择图像的路径......在 html 中，它从它被加载到 web 视图中......

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:37:26.050

使用您的方法对于提供正确的 baseUrl 来加载 webView 至关重要。

[如果您需要非本地基本 url 来加载一些外部数据，请考虑通过 base64 演示显示图像，我在这个](https://stackoverflow.com/a/10713277/792677)答案中详细说明了如何做到这一点。

在此线程的 OP 中，如果您只想显示本地内容，您还将看到必须如何使用基本 url。

# google-analytics - 如何使用 Google Analytics 自定义跟踪电子商务交易？

> ID：11451334
> 
> 赞同：0
> 
> 时间：2012-07-12T11:57:21.893
> 
> 标签：google-analytics, e-commerce, tracking

在使用 Google Analytics 进行的电子商务交易中，我们可以编写如下代码：

```
 _gaq.push(['_addTrans',
    '1234',       // order ID
    'SitePoint',  // store
    '19.99',      // total
    '1.50',       // tax
    '3.00',       // shipping
    'Chicago',    // city
    'Illinois',   // state
    'USA'         // country
]); 
```

但我想为雇主注册页面实施它，我不会得到 order_id 和 total 字段。相反，我可以通过替换 oerder_id 和存储来使用雇主 ID 和公司名称......它会工作吗？

作为参考，您可以查看[GA Ecommerce](http://www.sitepoint.com/track-ecommerce-transactions-google-analytics-reports/) 如何使用它进行雇主注册？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T17:01:14.873

你可以这样做，但这可能不是最好的方法。如果我打算这样做，我会使用一些代码来生成一个虚拟交易 ID，然后将总字段设置为 1 美元。下面是一些生成 order_id 的代码：

```
function generateOrderId() {
    // really crude unique ID
    var d = new Date();
    var r = Math.floor(Math.random()*1000);
    return d.valueOf()+''+r;
} 
```

更好的方法是使用事件跟踪它。这些旨在跟踪没有直接关联的美元金额的特殊事物。例如，下载量或用户在视频播放器上点击播放的次数。

文档非常好，如果您了解 Sitepoint 文章，事件跟踪就不难了。（这实际上是一个比电子商务更简单的过程） [https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)

# jquery - .html() 不适用于 jquery-mobile 哈希导航

> ID：11451342
> 
> 赞同：0
> 
> 时间：2012-07-12T11:57:36.047
> 
> 标签：jquery, jquery-mobile

我正在使用 jQuery 手机进行测试。我对哈希导航有疑问。

当我直接进入我的应用程序（[http://reev.nl/m/](http://reev.nl/m/)）时，它工作正常。但是当我导航到[http://reev.nl/m/#/m/index.html](http://reev.nl/m/#/m/index.html)（在某些手机上发生）时， .html() 似乎不起作用......

很奇怪，因为它的代码相同：

```
<script type="text/javascript">
    // The object
    var TwitterObj = {
        // Initialize
        init: function( options, elem ) {
            var self = this;

            // Log so I can see it's running
            console.log( 'init' );

            self.elem = elem;

            self.baseUrl = 'http://search.twitter.com/search.json';
            self.options = options;
            self.tweets = false;

            // Start load
            self.load();
        },

        // Fetch data from twitter
        fetch: function() {
            var self = this;

            // Log so I can see it's running
            console.log( 'fetch' );

            // Get tweets
            return $.ajax({
                url: self.baseUrl,
                data: {
                    q: self.options.query,
                    rpp: self.options.count,
                    lang: self.options.lang,
                    since_id: 0,
                    result_type: 'recent'
                },
                cache: false,
                dataType: 'jsonp'
            });
        },

        // Mapping
        mapping: function() {
            var self = this;

            // Log so I can see it's running
            console.log( 'mapping' );

            // Do some mapping
            self.tweets = $.map( self.tweets, function( obj, i ) {
                return '<li style="margin-bottom: 15px;"><span>'+ obj.created_at +'</span><br /><strong>'+ obj.from_user_name +':</strong> '+ obj.text +'</li>';
            }).join("\n");
        },

        // Add list
        display: function() {
            var self = this;

            // Log so I can see it's running
            console.log( 'display' );

            // load tweets in list
            self.elem.html( self.tweets ); //.listview( 'refresh' )
        },

        // Load tweets
        load: function() {
            var self = this;

            // Log so I can see it's running
            console.log( 'load' );

            // Show loading msg
            self.elem.html( '<li>loading...</li>' );

            // Get tweets
            self.fetch().done( function( data ) {
                self.tweets = data.results;

                // Map tweets and show them
                self.mapping();
                self.display();
            } );
        }
    }
</script>
<!-- Start of first page -->
<div data-role="page" id="twitter">

    <div data-role="header" data-position="fixed">
        <h1>Twitter</h1>
    </div>

    <div data-role="content">
        <p>
            <a href="contact.html">Bezoek ons</a>
        </p>
        <p>
            <ul id="TwitterList">
                <li>init</li>
            </ul>
        </p>
        <p>
            <a href="#" id="twReload">load</a>
        </p>
        <p>
            <a href="puppy.html">Boks</a>
        </p>
    </div>

    <div data-role="footer" data-position="fixed">
        <h4>&copy; Banaan</h4>
    </div>
</div>
<script type="text/javascript">
    var Twitter = Object.create( TwitterObj );
    var twElem = $('#TwitterList');
    var twOptions = {
        query: 'jQuery',
        count: 5,
        lang: 'en'
    };

    $(document).bind('pageinit', function(event, ui) {
        Twitter.init( twOptions, twElem );
    });

    $(document).live('pagebeforehide', function(event, ui) {
        var nextPage = 'twitter';

        if(ui.nextPage[0]) {
            nextPage = ui.nextPage[0].dataset.url
        }

        if( nextPage === 'twitter' ) {
            Twitter.load();
        }
    });

    $("#twReload").click(function() {
        Twitter.load();
    });
</script> 
```

# c# - c#中带有HTML表格代码的表格大小

> ID：11451349
> 
> 赞同：1
> 
> 时间：2012-07-12T11:58:27.143
> 
> 标签：c#, html, html-table

这是我在 C# 代码中的 html 代码

```
tosend = "<p><tr><th>The directory searched:  " + path + " </th><th> between the dates " + fdate + " and  " + ldate + "</th></tr> <br> </p> <tr><th>File Name</th>  <th>File Date</th>  <th>File Hash</th>  <th>Beamer Date</th>  <th>Beamer Hash</th> <th>Status</th></tr>";
for (int i = 0; i < thexfiles.Length; i++)
{ 
    tosend = tosend + "<tr><td>" + thexfiles[i] + "</td><td>" + filedate[i] + "</td><td>" + hashList[i] + "</td><td>" + thexdates[i] + "</td><td>" + beamerHash[i] + "</td><td>" +status[i] + "</td></tr>"; 
}
tosend = "<html><table border="+1+">" + tosend + "</table></html>"; 
```

这是它的外观链接：[点击这里](https://www.dropbox.com/s/7xoejbp9celza2x/Photo%2012-07-2012%2014%2049%2057.png?m)

我想做的是，

1.  我想扩展第一行，使其与其他行的大小相同，
2.  如您所见，日期行和状态行的高度太多，我希望它们看起来像一条线，例如展开。

这就是我所需要的，到目前为止我已经尝试过正常的 html width-height 等，我可能因为错误的符号而无法成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:18:26.780

您可以使用`colspan="100%"`扩展第一行（或使用设置的列数）。除此之外，您只是想将太多数据挤入一个小区域。您必须缩短时间或删除一列才能使行高与您拥有的数据正常工作。您还可以强制较长的列为其他列提供更多空间，但也会导致它们换行。

另请注意，`<br></>p>`行之间的标签不是有效的 HTML。

```
tosend = "<tr><th>The directory searched:  " + path + " </th><th colspan='100%'> between the dates " + fdate + " and  " + ldate + "</th></tr><tr><th>File Name</th>  <th>File Date</th>  <th>File Hash</th>  <th>Beamer Date</th>  <th>Beamer Hash</th> <th>Status</th></tr>";

for (int i = 0; i < thexfiles.Length; i++)
{  
    tosend = tosend + "<tr><td>" + thexfiles[i] + "</td><td>" + filedate[i].ToShortDateString() + "</td><td>" + hashList[i] + "</td><td>" + thexdates[i].ToShortDateString() + "</td><td>" + beamerHash[i] + "</td><td>" +status[i] + "</td></tr>";  
}
tosend = "<html><table border="+1+">" + tosend + "</table></html>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:15:32.117

正如@David 所说，HTML 的构造是无效的。

*   在“tr”中间有一个“p”和“br”标签
*   标签也丢失了。

尝试以这种方式构建表格。我单独放置 HTML 代码

```
 <html>
<body>
<table border=1>
     <tr>
        <th colspan="3">The directory searched</th>
        <th colspan="3"> between the dates </th>
     </tr>
     <tr>
        <th>File Name</th>
        <th>File Date</th>
        <th>File Hash</th>
        <th>Beamer Date</th>
        <th>Beamer Hash</th>
        <th>Status</th>
     </tr>

     <tr>
        <td>thexfiles[i]</td>
        <td>filedate[i]</td>
        <td>hashList[i]</td>
        <td>thexdates[i]</td>
        <td>beamerHash[i]</td>
        <td>status[i]</td>
    </tr>
</table>
</body>
 </html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:15:38.160

1.  对于第一行的单元格，如果您希望它以 5 列的形式出现，请使用 <td colspan="5">。

2.  将 <td nowrap="nowrap"> 用于您希望在 1 行中包含的单元格。

# jquery - 使用一个或两个 CDN 更好吗？

> ID：11451350
> 
> 赞同：1
> 
> 时间：2012-07-12T11:58:27.583
> 
> 标签：jquery, asp.net-mvc-3, jquery-validate, cdn

在我的 ASP.NET MVC 应用程序中，我从本地 /Scripts 目录中引用了三个脚本。

```
<script src="/Scripts/jquery-1.7.2.min.js"></script>
<script src="/Scripts/jquery.validate.min.js"></script>
<script src="/Scripts/jquery.validate.unobtrusive.min.js"></script> 
```

我现在将使用 CDN 来加载它们。

混合使用两个 CDN 并使用 Google 进行 jQuery 和 Microsoft 进行 jQuery Validate 是否更可取？这样，两者可以并行完成吗？

还是没用，依赖单个CDN更容易？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:24:09.650

确实可以并行加载脚本，但另一方面它会导致另一个域查找，这实际上可能比从同一域加载两个脚本花费更长的时间。

您还添加了另一个[单点故障](http://en.wikipedia.org/wiki/Single_point_of_failure)。两个 CDN 都必须为您的页面正常工作。即使那里失败的风险很低，它仍然是一个风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:11:18.083

为什么要并行加载它？脚本本质上是自然阻塞的，并且有充分的理由，因为脚本也很有可能依赖于其他脚本。在没有依赖关系的情况下加载一个很可能是致命的。尤其是在这里，因为`jquery.validate` **依赖**于`jquery`.

# javascript - 如何在单击时选择跨度的文本？

> ID：11451353
> 
> 赞同：29
> 
> 时间：2012-07-12T11:58:38.057
> 
> 标签：javascript, jquery

我正在寻找一种在单击文本时使用 jquery 选择跨度内文本的方法。

例如，在下面的 html 片段中，我希望文本“\apples\oranges\pears”在单击时被选中。

```
<p>Fruit <span class="unc_path">\\apples\oranges\pears</span></p> 
```

我已经尝试自己实现这一点无济于事。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-11T16:35:05.717

它可以用原生 JavaScript 来实现。[jsFiddle](http://jsfiddle.net/sYzwA/1/)上的工作演示。你的代码可能是这样的：

```
$('.unc_path').click(function (){
    var range, selection;

    if (window.getSelection && document.createRange) {
        selection = window.getSelection();
        range = document.createRange();
        range.selectNodeContents(this);
        selection.removeAllRanges();
        selection.addRange(range);
    } else if (document.selection && document.body.createTextRange) {
        range = document.body.createTextRange();
        range.moveToElementText(this);
        range.select();
    }
}); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-11-30T00:58:33.637

你可以使用 CSS 比 JS 更容易地做到这一点`style="user-select: all;"`

添加`cursor: pointer;`所以很明显他们可以点击...

见代码片段：

```
<p>
Fruit 
<span style="user-select: all; cursor: pointer;">\\apples\oranges\pears</span>
</p>
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-12T12:13:12.073

工作演示：http: [//jsfiddle.net/dystroy/V97DJ/](http://jsfiddle.net/dystroy/V97DJ/)

```
$('.unc_path').click(function (){
    var text = $(this).text();
    var $input = $('<input type=text>');
    $input.prop('value', text);
    $input.insertAfter($(this));
    $input.focus();
    $input.select();
    $(this).hide();
});​ 
```

这个想法（见上面的评论）是用输入动态替换跨度，这是我知道选择文本的唯一跨浏览器方式。

请注意，这只是路的一半，因为您可能想要取消选择、删除边框等样式。

而且我还必须指出，与跨度相反，输入不能跨越多行。

我不认为这可以/不应该在实际应用程序中使用，除非在一个非常具体的点。

* * *

**编辑**：新版本：http: [//jsfiddle.net/dystroy/A5ZEZ/](http://jsfiddle.net/dystroy/A5ZEZ/)

在这个版本中，失去焦点时文本会恢复正常。

```
$('.unc_path').click(function (){
    var text = $(this).text();
    var $this = $(this);
    var $input = $('<input type=text>');
    $input.prop('value', text);
    $input.insertAfter($(this));
    $input.focus();
    $input.select();
    $this.hide();
    $input.focusout(function(){
        $this.show();
        $input.remove();
    });
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:03:32.060

要选择特定的 Span，您需要为该 Span 提供一个 id。否则，您需要遍历所有可用跨度的列表来获取它。

让我们以此为例（已添加 id 属性）

```
 <p>Fruit <span class="unc_path" id="span1">\\apples\oranges\pears</span></p> 
```

JQuery 会是这样的

```
$('span1').text()  // if you want to take the text
$('span1').html() // if you want to take the html 
```

# json - 保存的 FabricJS 不存储 lockScalingX

> ID：11451357
> 
> 赞同：1
> 
> 时间：2012-07-12T11:58:57.647
> 
> 标签：json, canvas, save, store, fabricjs

经过几次测试，我终于将 fabric.canvas 保存到 MySQL 数据库，问题是我不希望画布中的图像可以调整大小，我只需要旋转。不幸的是，存储的 json 不存储 fabric.Image 对象的 lockScalingX 和 lockScalingY 属性，当我检索 fabric.canvas 时，我可以调整图像的大小。

有没有办法避免这种情况？

我使用该功能

```
var jsonCanvas = JSON.stringify(canvas.toDatalessObject()); 
```

使用 php 将 json 存储到数据库中我使用

```
canvas.loadFromJSON(data); 
```

要了解我在说什么，请参阅此小提琴-> [http://jsfiddle.net/lpccoder/YX9Wf/1/](http://jsfiddle.net/lpccoder/YX9Wf/1/) 我设置了 oImg.lockScalingX = oImg.lockScalingY = true; 之前添加到画布以避免调整大小。按钮保存，保存画布，但是当我加载它（使用加载按钮）时，我可以调整图像的大小。

好吧，因为我没有收到任何答案，我试图在加载画布后设置 lockScalingX 和 lockScalingY，但是当我使用 forEach 方法时会发生一些奇怪的行为。我的意思是，我需要在 forEach 之前发出警报以使其正常工作，如果我不发出此警报，则 forEach 循环将不起作用。为了澄清这一点，您可以查看并比较这两个小提琴：

工作一个-> jsfiddle.net/lpccoder/hGPCG/

不工作的一个-> jsfiddle.net/lpccoder/Vv4AW/

我是javascript编码的新手，也许这是一个新手问题，但我认为这是一个非常奇怪的行为......有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T11:20:19.867

感谢 Rodrigo Pandini 在[https://groups.google.com/forum/#!topic/fabricjs/rGX8F93TeGE上回答了这个问题](https://groups.google.com/forum/#!topic/fabricjs/rGX8F93TeGE)

解决方法是使用回调函数手动设置属性：

```
canvas.loadFromJSON(jsonCanvas, function(){
  var objects = canvas.getObjects();
  // Trying to set the property after load JSON
  //alert('Objects: ' + objects);
  objects.forEach(function(o) {
    o.lockScalingX = o.lockScalingY = true;
  });
  canvas.renderAll(); 
}); 
```

因为据我所知，json 不存储此属性。[您可以在 -> http://jsfiddle.net/lpccoder/Vv4AW/1/](http://jsfiddle.net/lpccoder/Vv4AW/1/)查看最终解决方案

# ruby-on-rails - 如何以不同的标记显示每 4 个产品？

> ID：11451366
> 
> 赞同：0
> 
> 时间：2012-07-12T11:59:29.057
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我刚从 Java 背景开始使用 Ruby。我正在尝试编写一个特定的循环，但无法找出正确的语法：

有人可以帮我解决这个问题吗？我正在尝试编写一个循环，但使用不同的 css 类来更改每个块的样式。

意识到这可能很容易，但感谢您的帮助....

```
 <%= @products.each do |product, i| %>
    <% if i % 1 %>
    <div class="items-row clearfix">
      <div class="one_fourth">
            <div class="item-thumb">
                <a href="" title=""><img src="<%= image_path "thumb.png" %>" alt="" class="thumb" width="162" height="230" /></a>
            </div>
            <p><%= product.name %></p>
            <p class="bold">$79.95 AUD</p>
            <p class="color-wrap">
                <span class="color" style="background:#ddd;"></span>
                <span class="color" style="background:#f9f9f9;"></span>
                <span class="color" style="background:green;"></span>
                <span class="color" style="background:red;"></span>
            </p>
        </div> 
    <% elsif i % 4 %>
    <div class="one_fourth last">
        <div class="item-thumb">
            <a href="#" title=""><img src="<%= image_path "thumb.png" %>" alt="" class="thumb" width="162" height="230" /></a>
        </div>
        <p><%= product.name %></p>
        <p class="bold">$79.95 AUD</p>
    </div>
    </div><!-- end row -->
    <% else %>
        <div class="one_fourth">
            <div class="item-thumb">
                <a href="#" title=""><img src="<%= image_path "thumb.png" %>" alt="" class="thumb" width="162" height="230" /></a>
            </div>
            <p>Item Name</p>
            <p class="bold">$79.95 AUD</p>
        </div>
    <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:14:06.277

[你可以使用循环](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-cycle)做这样的事情：

```
<% products.each_slice(4) do |slice| %>
  <div class="items-row clearfix">
    <% slice.each_with_index do |product,i| %>
      <div class="one_fourth <%= cycle("first", "second", "third", "fourth") %>">
        <%= render product %>
        <% if i != 3 %>
          <p class="color-wrap">
            <span class="color" style="background:#ddd;"></span>
            <span class="color" style="background:#f9f9f9;"></span>
            <span class="color" style="background:green;"></span>
            <span class="color" style="background:red;"></span>
          </p>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %> 
```

_product.html.erb：

```
<div class="item-thumb">
  <a href="" title=""><img src="<%= image_path "thumb.png" %>" alt="" class="thumb" width="162" height="230" /></a>
</div>
<p><%= product.name %></p>
<p class="bold">$79.95 AUD</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:15:13.410

与其在视图中使用 if/else 语句和 CSS 标记，不如将 CSS 外部化，制作一些部分，并使用[ActionView::Helpers::TextHelper#cycle](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-cycle)。例如：

```
<%= @products.each do |product| %>
  <div class="<%= cycle('first', 'second', 'third', 'fourth') -%>">
    <!-- 1\. let the CSS class handle display differences -->
    <!-- 2\. render a partial based on #current_cycle     -->
    <%= render :partial => current_cycle %>        
  </div>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:14:04.303

我会说mod是你的问题。它永远不会进入第一个块，因为 n%1 将始终返回 0。使用[irb](http://en.wikipedia.org/wiki/Interactive_Ruby_Shell)尝试你的逻辑让你继续。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T04:19:55.983

您可能想尝试[jQuery nth-child](http://api.jquery.com/nth-child-selector/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-13T14:13:24.153

我得到了部分答案。稍微改变语法以使用“each_with_index”而不是每个。

仍在尝试解决产品何时可以成为最后一个图块并需要关闭，第一个在行，第一个在集合中，最后一个在行中的很多变化......

谢谢大家，我想我已经回答了我自己的问题。

# android - android.widget.LinearLayout 的 ClassCastException

> ID：11451369
> 
> 赞同：1
> 
> 时间：2012-07-12T11:59:49.510
> 
> 标签：android, android-linearlayout

我已经为我的一项活动设计了布局，但出现了奇怪的错误。这是一个简单的活动，实际上它是主菜单活动，其中包含图像按钮。

```
"07-12 16:40:22.599: E/AndroidRuntime(1857): Caused by: java.lang.ClassCastException: android.widget.LinearLayout
" 
```

这是我的布局 xml 代码

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scrollView1"
    android:layout_width="match_parent"
    android:layout_height="fill_parent" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:background="@drawable/rpg"
        android:orientation="vertical" >

        <TableLayout
            android:id="@+id/tableLayout1"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                            " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                             " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <ImageButton
                    android:id="@+id/profile_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/a1" />

                <TextView android:text=" " />

                <ImageButton
                    android:id="@+id/share_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/a2" />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                              " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <ImageButton
                    android:id="@+id/settings_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/a3" />

                <TextView android:text="  " />

                <ImageButton
                    android:id="@+id/contacts_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/a4" />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <TextView android:text="                                 " />
            </TableRow>

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center" >

                <ImageButton
                    android:id="@+id/exit_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/a5" />

                <TextView android:text="  " />

                <ImageButton
                    android:id="@+id/amazon_btn"
                    android:layout_width="100dp"
                    android:layout_height="100dp"
                    android:src="@drawable/amazon" />
            </TableRow>
        </TableLayout>

        <LinearLayout
            android:id="@+id/ban2_mainmenu"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:background="@drawable/ban_2" >
        </LinearLayout>

        <LinearLayout
            android:id="@+id/ban1_mainmenu"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_alignRight="@+id/ban2_mainmenu"
            android:background="@drawable/ban_1" >
        </LinearLayout>
    </RelativeLayout>

</ScrollView> 
```

在下面这段代码的第一行的java中，我收到错误

```
 ImageButton amazon = (ImageButton) findViewById(R.id.amazon_btn);
        amazon.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                // TODO Auto-generated method stub

                Intent browse = new Intent(Intent.ACTION_VIEW, Uri
                        .parse("http://www.amazon.com/gp/product/B0084FCDKS"));
                startActivity(browse);

            }
        }); 
```

错误是

```
07-12 16:40:22.599: E/AndroidRuntime(1857): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.colony.rpgbluetoothchatlite/com.colony.rpgbluetoothchatlite.Menu_Main}: java.lang.ClassCastException: android.widget.LinearLayout
07-12 16:40:22.599: E/AndroidRuntime(1857): Caused by: java.lang.ClassCastException: android.widget.LinearLayout 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:07:25.647

您可以粘贴完整的 logcat 错误吗？因为我认为您正在尝试在 Java 代码中使用您的 xml 文件中定义的线性布局之一（可能是最后两个线性布局之一）并且您没有正确声明它们。

并尝试清理您的项目并运行一次。有时这发生在 Android 中，我也注意到了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:17:46.757

在你的`com.colony.rpgbluetoothchatlite.Menu_Main`课...

找出你在哪里调用这样的东西..我做了变量按钮..但你的应该是别的东西......

正在发生的事情是..你`R.id.ban1_mainmenu`是一个`RelativeLayout`......但你正试图将它转换为不同的类......在这种情况下，我正在转换为`Button`类..这将引发与你相同的异常......

```
Button btn1 = findViewById(R.id.ban1_mainmenu);
Button btn2 = findViewById(R.id.ban2_mainmenu); 
```

要解决这个问题..

```
LinearLayout btn1 = (LinearLayout)findViewById(R.id.ban1_mainmenu);
RelativeLayout btn2 = findViewById(R.id.ban2_mainmenu); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T20:03:04.713

出现此错误主要是由于错误的类型转换。例如下面的代码：在`listView` 我粘贴代码时，同样的错误给我带来了麻烦：

```
List.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                @Override
                public void onItemClick(AdapterView<?> parentAdapter,
                        View view, int position, long id) {
                    // The below line of TextView will generate same problem..
                    TextView clickedView = (TextView) view;
                    Toast.makeText(
                            ActivityName.this,
                            "Item with id [" + id + "] - Position ["
                                    + position + "] - Planet ["
                                    /*+ clickedView.getText()*/ + "]",
                            Toast.LENGTH_SHORT).show();
                }
            }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T01:37:20.733

这听起来你需要做的就是一个干净的项目。当您第一次放置scrollView 时，有时会发生这种情况。然而，一扫而光应该可以解决问题。

# oracle - 尝试创建 Oracle 表时不断收到错误“缺少右括号”

> ID：11451377
> 
> 赞同：1
> 
> 时间：2012-07-12T12:00:22.143
> 
> 标签：oracle, ddl

我在 SQL 开发人员中有以下代码，当我尝试运行代码来创建表时，它在这一行失败：'exists_flag varchar2(1) y/n，'

```
 create table moulds
 (mould_id  number,
 mould_type varchar2(50),
 mould_description varchar2(240),
 exists_flag varchar2(1) y/n,
 locate_id  number,
 ); 
```

谁能看到这条线有什么问题以及为什么它一直说“缺少右括号”？

```
 create table moulds
 (mould_id  number,
 mould_type varchar2(50),
 mould_description varchar2(240),
 check (exists_flag in ( 'y', 'n' )),
 locate_id  number,
 PRIMARY KEY (mould_id)
 ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:02:56.680

替换`y/n`为

```
check (exists_flag in ( 'y', 'n' )) 
```

# c - 服务器从多个客户端接收数据并在Linux中使用c通过线程同时存储在单独的文件中

> ID：11451386
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:01:21.220
> 
> 标签：c, multithreading

我有一个服务器和两个客户端。我想将数据同时存储在来自客户端的不同文件中。目前我将数据存储在来自两个客户端的同一个文件中。一个客户端发送数据后，第二个开始发送。

我希望两个客户端同时发送数据。任何人都可以帮助我...

服务器.c

```
void *function1(void *ptr);

typedef struct{
    int port_id;
    int thread_id;
}conn_id;

int main(int argc, char *argv[])
{
    conn_id conn_id1[2];

    conn_id1[0].port_id=7350;
    conn_id1[0].thread_id=1;
    conn_id1[1].port_id=7351;
    conn_id1[1].thread_id=2;

    conn_id* conn_ptr;

    pthread_t thread[2];
    int index=0;

    for(index=0;index<2;index++){
    conn_ptr=&conn_id1[index];

    pthread_create(&thread[index],NULL,&function1,(void*)conn_ptr);}

    pthread_join(thread[0],NULL);
    pthread_join(thread[1],NULL);

    return 0;
    }
void *function1( void *ptr)
{
    //Declaring process variables.
    int server_sockfd, client_sockfd;
    int server_len ; 
    int rc ; 

    conn_id* conn_ptr;
    conn_ptr = (conn_id*)ptr;
    unsigned client_len;
    char revbuf[LENGTH];

    struct sockaddr_in server_address;
    struct sockaddr_in client_address;

    //Remove any old socket and create an unnamed socket for the server.
    server_sockfd = socket(AF_INET, SOCK_STREAM, 0);
    server_address.sin_family = AF_INET;
    server_address.sin_addr.s_addr = htons(INADDR_ANY);
    server_address.sin_port = htons(conn_ptr->port_id);
    server_len = sizeof(server_address);

    bzero(&(server_address.sin_zero), 8);
    rc = bind(server_sockfd, (struct sockaddr *) &server_address, server_len);

    printf("RC from bind = %d\n", rc ) ; 

    //Create a connection queue and wait for clients
    rc = listen(server_sockfd, 5);

    printf("RC from listen = %d\n", rc ) ; 

    client_len = sizeof(client_address);
    client_sockfd = accept(server_sockfd, (struct sockaddr *) &client_address,                &client_len);

    printf("after accept()... client = %s\n", inet_ntoa(client_address.sin_addr)) ; 

    while(1)
    {
    /*Receive File from Client */
    char* fr_name = "/home/server/Desktop/fr_client.dat";
    FILE *fr = fopen(fr_name, "a"); 

    if(fr == NULL)
        printf("File %s Cannot be opened file on server.\n", fr_name);
    else
    {
        bzero(revbuf, LENGTH); 
        int fr_block_sz = 0;
        while((fr_block_sz = recv(client_sockfd, revbuf, LENGTH, 0)) > 0) 
        {
            int write_sz = fwrite(revbuf, sizeof(char), fr_block_sz, fr);
            if(write_sz < fr_block_sz)
            {
                error("File write failed on server.\n");
            }
            bzero(revbuf, LENGTH);
            if (fr_block_sz == 0 || fr_block_sz != 512) 
            {
                break;
            }
        }
        if(fr_block_sz < 0)
        {
            if (errno == EAGAIN)
            {
                printf("recv() timed out.\n");
            }
            else
            {
                fprintf(stderr, "recv() failed due to errno = %d\n", errno);
                exit(1);
            }
        }
        printf("Ok received from client!\n");
        fclose(fr); 
    }

    /* Call the Script */
    system("cd ; chmod +x script.sh ; ./script.sh");

    /* Send File to Client */

        char* fs_name = "/home/server/Desktop/output.txt";
        char sdbuf[LENGTH]; // Send buffer
        printf("[Server] Sending %s to the Client...", fs_name);
        FILE *fs = fopen(fs_name, "r");
        if(fs == NULL)
        {
            fprintf(stderr, "ERROR: File %s not found on server. (errno =   %d)\n", fs_name, errno);
            exit(1);
        }

        bzero(sdbuf, LENGTH); 
        int fs_block_sz; 
        while((fs_block_sz = fread(sdbuf, sizeof(char), LENGTH, fs))>0)
        {
            if(send(client_sockfd, sdbuf, fs_block_sz, 0) < 0)
            {
                fprintf(stderr, "ERROR: Failed to send file %s. (errno =  %d)\n", fs_name, errno);
                exit(1);
            }
            bzero(sdbuf, LENGTH);
        }
        printf("Ok sent to client!\n");

        close(client_sockfd);
        printf("[Server] Connection with Client closed. Server will wait  now...\n");
        while(waitpid(-1, NULL, WNOHANG) > 0);break;

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:36:07.807

如果您想同时从多个客户端接收数据，基本上，您有两种选择：

1.  仍然使用同步套接字 I/O，但是在多个线程中，每个线程与一个客户端通信，并将数据写入共享文件句柄，该句柄由互斥锁保护。

2.  使用异步套接字 I/O，单线程。在一个循环中，您应该首先在多个套接字上调用 select()，并在套接字上有事件时执行 I/O。在这种情况下，您不需要文件句柄上的互斥锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:41:00.717

另一种方法是为每个连接创建一个线程，并为每个线程创建一个文件，使用 client-ip 和端口来命名文件。稍后您可以合并这些文件。

# javascript - Web 应用程序的正确键盘快捷键

> ID：11451387
> 
> 赞同：1
> 
> 时间：2012-07-12T12:01:24.763
> 
> 标签：javascript, web-applications, interface, keyboard-shortcuts, usability

我正在记录我们的 Web 应用程序的键盘快捷键。如果出于任何原因（例如干扰浏览器自己的键盘快捷键/操作系统快捷键或出于一般可用性考虑）这些不是正确的键，请分享。

快捷方式启动器将是`    SPACE    `，类似于某些 Gmail 快捷方式使用“*”作为启动器的方式。快捷方式列表相当大，但这里有一些关键的：

**功能 - 快捷方式**

*   保存 - `    SPACE    `+`S`
*   撤消 - `    SPACE    `+`Z`
*   重做 - `    SPACE    `+`Y`

我们的 Web 应用程序是一个单页、无滚动的 JavaScript 应用程序。我们正在考虑为插件使用 John Resig 的[Hotkeys](https://github.com/jeresig/jquery.hotkeys)、[Mousetrap](http://craig.is/killing/mice)和[jKey](http://oscargodson.github.com/jKey/)。对于使用上述键盘快捷键的任何想法，警告将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-04T09:48:25.730

# android - TransactionTooLargeException 怎么办

> ID：11451393
> 
> 赞同：286
> 
> 时间：2012-07-12T12:01:37.820
> 
> 标签：android, exception

我有一个`TransactionTooLargeException`. 不可重现。在文档中它说

> Binder 事务因太大而失败。
> 
> 在远程过程调用期间，调用的参数和返回值作为存储在 Binder 事务缓冲区中的 Parcel 对象进行传输。如果参数或返回值太大而无法放入事务缓冲区，则调用将失败并抛出 TransactionTooLargeException。
> 
> ...
> 
> 当远程过程调用引发 TransactionTooLargeException 时，有两种可能的结果。客户端无法将其请求发送到服务（很可能是因为参数太大而无法放入事务缓冲区），或者服务无法将其响应发送回客户端（很可能如果返回值是太大而无法放入事务缓冲区）。
> 
> ...

所以我在某个地方传递或接收超过某个未知限制的参数。在哪里？

堆栈跟踪没有显示任何有用的信息：

```
java.lang.RuntimeException: Adding window failed
at android.view.ViewRootImpl.setView(ViewRootImpl.java:548)
at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:406)
at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:320)
at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:152)
at android.view.Window$LocalWindowManager.addView(Window.java:557)
at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2897)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2245)
at android.app.ActivityThread.access$600(ActivityThread.java:139)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:154)
at android.app.ActivityThread.main(ActivityThread.java:4977)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method)
Caused by: android.os.TransactionTooLargeException
at android.os.BinderProxy.transact(Native Method)
at android.view.IWindowSession$Stub$Proxy.add(IWindowSession.java:569)
at android.view.ViewRootImpl.setView(ViewRootImpl.java:538)
... 16 more
android.os.TransactionTooLargeException
at android.os.BinderProxy.transact(Native Method)
at android.view.IWindowSession$Stub$Proxy.add(IWindowSession.java:569)
at android.view.ViewRootImpl.setView(ViewRootImpl.java:538)
at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:406)
at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:320)
at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:152)
at android.view.Window$LocalWindowManager.addView(Window.java:557)
at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2897)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2245)
at android.app.ActivityThread.access$600(ActivityThread.java:139)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:154)
at android.app.ActivityThread.main(ActivityThread.java:4977)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

好像和观点有关？这与远程过程调用有何关系？

也许很重要：Android 版本：4.0.3，设备：HTC One X

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-10-09T22:10:26.073

我遇到了这个问题，我发现当服务和应用程序之间交换大量数据时（这涉及传输大量缩略图）。实际数据大小约为 500kb，IPC 事务缓冲区大小设置为 1024KB。我不确定为什么它超出了事务缓冲区。

当您通过 Intent Extras 传递大量数据时，也会发生这种情况

当您在应用程序中遇到此异常时，请分析您的代码。

1.  您是否在服务和应用程序之间交换大量数据？
2.  使用intents共享海量数据，（例如用户从gallery share press share中选择大量文件，选择文件的URI将使用intents传输）
3.  从服务接收位图文件
4.  等待 android 响应大量数据（例如，当用户安装大量应用程序时，getInstalledApplications()）
5.  使用 applyBatch() 有很多操作挂起

**遇到此异常时如何处理**

如果可能，将大操作拆分为小块，例如，不要使用 1000 个操作调用 applyBatch()，而是每个调用 100 个。

不要在服务和应用程序之间交换大量数据 (>1MB)

我不知道该怎么做，但是，不要查询 android，它会返回大量数据 :-)

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2018-05-03T19:45:55.063

如果您需要调查导致崩溃的 Parcel，您应该考虑尝试[TooLargeTool](https://github.com/guardian/toolargetool)。

（我发现这是@Max Spencer 在接受的答案下的评论，对我来说很有帮助。）

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-01-17T12:22:16.653

这不是一个确定的答案，但它可能会阐明 a 的原因`TransactionTooLargeException`并帮助查明问题。

尽管大多数答案都涉及传输的大量数据，但我看到在大量滚动和缩放以及反复打开 ActionBar 微调器菜单后偶然抛出了此异常。崩溃发生在点击操作栏时。（这是一个自定义地图应用程序）

唯一传递的数据似乎是从“输入调度程序”到应用程序的触摸。我认为这在“事务缓冲区”中不能合理地达到 1 mb 附近。

我的应用程序在四核 1.6 GHz 设备上运行，并使用 3 个线程进行繁重的工作，为 UI 线程保留一个内核空闲。此外，该应用程序使用 android:largeHeap，还有 10 mb 的未使用堆空间，还有 100 mb 的空间来增加堆空间。所以我不会说这是资源问题。

崩溃总是紧跟在这些行之前：

```
W/InputDispatcher( 2271): channel ~ Consumer closed input channel or an error occurred.  events=0x9
E/InputDispatcher( 2271): channel ~ Channel is unrecoverably broken and will be disposed!
E/JavaBinder(28182): !!! FAILED BINDER TRANSACTION !!! 
```

不一定按该顺序打印，但（据我检查）发生在同一毫秒。

为清楚起见，堆栈跟踪本身与问题中的相同：

```
E/AndroidRuntime(28182): java.lang.RuntimeException: Adding window failed
..
E/AndroidRuntime(28182): Caused by: android.os.TransactionTooLargeException 
```

深入研究 android one 的源代码会发现以下几行：

框架/基础/核心/jni/android_util_Binder.cpp：

```
case FAILED_TRANSACTION:
    ALOGE("!!! FAILED BINDER TRANSACTION !!!");
    // TransactionTooLargeException is a checked exception, only throw from certain methods.
    // FIXME: Transaction too large is the most common reason for FAILED_TRANSACTION
    //        but it is not the only one.  The Binder driver can return BR_FAILED_REPLY
    //        for other reasons also, such as if the transaction is malformed or
    //        refers to an FD that has been closed.  We should change the driver
    //        to enable us to distinguish these cases in the future.
    jniThrowException(env, canThrowRemoteException
            ? "android/os/TransactionTooLargeException"
                    : "java/lang/RuntimeException", NULL); 
```

对我来说，这听起来像是我可能遇到了这个未记录的功能，其中交易失败的原因除了交易是 TooLarge 之外的其他原因。他们应该给它命名`TransactionTooLargeOrAnotherReasonException`。

目前我没有解决这个问题，但如果我发现有用的东西，我会更新这个答案。

**更新：**原来我的代码泄露了一些文件描述符，在linux中是最大化的（通常是1024），这似乎触发了异常。所以这毕竟是一个资源问题。我通过打开`/dev/zero`1024 次验证了这一点，这导致 UI 相关操作中出现各种奇怪的异常，包括上面的异常，甚至是一些 SIGSEGV 的异常。显然，无法打开文件/套接字并不是在整个 Android 中非常干净地处理/报告的事情。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2017-04-03T20:11:26.890

`TransactionTooLargeException`困扰我们4个月了，终于解决了！

发生的事情是我们在 a 中使用`FragmentStatePagerAdapter`a `ViewPager`。用户将翻页并创建 100 多个片段（它是一个阅读应用程序）。

尽管我们在 中正确管理了片段`destroyItem()`，但在 Android 的实现中`FragmentStatePagerAdapter`存在一个错误，它保留了对以下列表的引用：

```
private ArrayList<Fragment.SavedState> mSavedState = new ArrayList<Fragment.SavedState>(); 
```

而当Android`FragmentStatePagerAdapter`试图保存状态时，它会调用该函数

```
@Override
public Parcelable saveState() {
    Bundle state = null;
    if (mSavedState.size() > 0) {
        state = new Bundle();
        Fragment.SavedState[] fss = new Fragment.SavedState[mSavedState.size()];
        mSavedState.toArray(fss);
        state.putParcelableArray("states", fss);
    }
    for (int i=0; i<mFragments.size(); i++) {
        Fragment f = mFragments.get(i);
        if (f != null && f.isAdded()) {
            if (state == null) {
                state = new Bundle();
            }
            String key = "f" + i;
            mFragmentManager.putFragment(state, key, f);
        }
    }
    return state;
} 
```

如您所见，即使您正确管理子类中的片段`FragmentStatePagerAdapter`，基类仍会`Fragment.SavedState`为每个已创建的片段存储一个。`TransactionTooLargeException`当该数组被转储到 a 并且操作系统不喜欢它 100 多个项目时，就会发生这种情况`parcelableArray`。

因此，我们的解决方法是覆盖该`saveState()`方法并且**不**为`"states"`.

```
@Override
public Parcelable saveState() {
    Bundle bundle = (Bundle) super.saveState();
    bundle.putParcelableArray("states", null); // Never maintain any states from the base class, just null it out
    return bundle;
} 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2016-11-29T17:24:28.577

对于那些在寻找 TransactionTooLargeException 为何出现的答案时深感失望的人，**请尝试检查您在实例状态中保存了多少信息。**

在 compile/ **targetSdkVersion <= 23 时，我们只有**关于保存状态大尺寸的内部警告，但没有任何崩溃：

```
E/ActivityThread: App sent too much data in instance state, so it was ignored
    android.os.TransactionTooLargeException: data parcel size 713856 bytes
    at android.os.BinderProxy.transactNative(Native Method)
    at android.os.BinderProxy.transact(Binder.java:615)
    at android.app.ActivityManagerProxy.activityStopped(ActivityManagerNative.java:3604)
    at android.app.ActivityThread$StopInfo.run(ActivityThread.java:3729)
    at android.os.Handler.handleCallback(Handler.java:751)
    at android.os.Handler.dispatchMessage(Handler.java:95)
    at android.os.Looper.loop(Looper.java:154)
    at android.app.ActivityThread.main(ActivityThread.java:6044)
    at java.lang.reflect.Method.invoke(Native Method)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:865)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:755) 
```

但是在 compile/ **targetSdkVersion >= 24 时**，在这种情况下我们会遇到真正的 RuntimeException 崩溃：

```
java.lang.RuntimeException: android.os.TransactionTooLargeException: data parcel size 713860 bytes
    at android.app.ActivityThread$StopInfo.run(ActivityThread.java:3737)
    at android.os.Handler.handleCallback(Handler.java:751)
    at android.os.Handler.dispatchMessage(Handler.java:95)
    at android.os.Looper.loop(Looper.java:154)
    at android.app.ActivityThread.main(ActivityThread.java:6044)
    at java.lang.reflect.Method.invoke(Native Method)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:865)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:755)
 Caused by: android.os.TransactionTooLargeException: data parcel size 713860 bytes
   at android.os.BinderProxy.transactNative(Native Method)
   at android.os.BinderProxy.transact(Binder.java:615)
   at android.app.ActivityManagerProxy.activityStopped(ActivityManagerNative.java:3604)
   at android.app.ActivityThread$StopInfo.run(ActivityThread.java:3729)
   at android.os.Handler.handleCallback(Handler.java:751) 
   at android.os.Handler.dispatchMessage(Handler.java:95) 
   at android.os.Looper.loop(Looper.java:154) 
   at android.app.ActivityThread.main(ActivityThread.java:6044) 
   at java.lang.reflect.Method.invoke(Native Method) 
   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:865) 
   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:755) 
```

**该怎么办？**

将数据保存在本地数据库中，并仅将 id 保留在可用于检索此数据的实例状态中。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-08-28T12:24:41.770

当应用程序被发送到后台时，通常会引发此异常。

所以我决定使用数据分片的方法来完全规避`onSavedInstanceStae`生命周期。我的解决方案还可以处理复杂的实例状态并尽快释放内存。

首先，我创建了一个简单的 Fargment 来存储数据：

```
package info.peakapps.peaksdk.logic;
import android.app.Fragment;
import android.app.FragmentManager;
import android.os.Bundle;

/**
 * A neat trick to avoid TransactionTooLargeException while saving our instance state
 */

public class SavedInstanceFragment extends Fragment {

    private static final String TAG = "SavedInstanceFragment";
    private Bundle mInstanceBundle = null;

    public SavedInstanceFragment() { // This will only be called once be cause of setRetainInstance()
        super();
        setRetainInstance( true );
    }

    public SavedInstanceFragment pushData( Bundle instanceState )
    {
        if ( this.mInstanceBundle == null ) {
            this.mInstanceBundle = instanceState;
        }
        else
        {
            this.mInstanceBundle.putAll( instanceState );
        }
        return this;
    }

    public Bundle popData()
    {
        Bundle out = this.mInstanceBundle;
        this.mInstanceBundle = null;
        return out;
    }

    public static final SavedInstanceFragment getInstance(FragmentManager fragmentManager )
    {
        SavedInstanceFragment out = (SavedInstanceFragment) fragmentManager.findFragmentByTag( TAG );

        if ( out == null )
        {
            out = new SavedInstanceFragment();
            fragmentManager.beginTransaction().add( out, TAG ).commit();
        }
        return out;
    }
} 
```

然后在我的主要活动中，我完全绕过保存的实例周期，并将责任推迟到我的数据片段。无需在 Fragments 本身上使用它，因为它们的状态会自动添加到 Activity 的状态中）：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);

    SavedInstanceFragment.getInstance( getFragmentManager() ).pushData( (Bundle) outState.clone() );
    outState.clear(); // We don't want a TransactionTooLargeException, so we handle things via the SavedInstanceFragment
} 
```

剩下的就是简单地弹出保存的实例：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(SavedInstanceFragment.getInstance(getFragmentManager()).popData());
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState( SavedInstanceFragment.getInstance( getFragmentManager() ).popData() );
} 
```

完整详情： http: [//www.devsbedevin.net/avoiding-transactiontoolargeexception-on-android-nougat-and-up/](http://www.devsbedevin.net/avoiding-transactiontoolargeexception-on-android-nougat-and-up/)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-10-04T10:46:59.213

这个问题没有一个具体的原因。对我来说，在我的 Fragment 课程中，我正在这样做：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    super.onCreateView(inflater, container, savedInstanceState);
    View rootView = inflater.inflate(R.layout.snacks_layout, container); //<-- notice the absence of the false argument
    return rootView;
} 
```

而不是这个：

```
View rootView = inflater.inflate(R.layout.softs_layout, container, false); 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-11-23T16:27:24.490

重要的是要了解事务缓冲区限制为 1 MB，无论设备功能或应用程序如何。此缓冲区用于您进行的每个 API 调用，并在应用程序当前正在运行的所有事务之间共享。

我相信它还包含一些特定的对象，例如 parcels 等`(Parcel.obtain())`，因此始终将 each`obtain()`与 a匹配很重要`recycle()`。

在返回大量数据的 API 调用上很容易发生此错误，即使返回的数据小于 1 MB（如果其他事务仍在运行）。

例如，`PackageManager.getInstalledApplication()`调用会返回所有已安装应用程序的列表。添加特定标志允许检索大量额外数据。这样做很可能会失败，因此建议不要检索任何额外的数据并在每个应用程序的基础上检索这些数据。

然而，调用可能仍然失败，所以用 a 包围它`catch`并在必要时能够重试非常重要。

据我所知，除了重试并确保检索尽可能少的信息外，没有解决此类问题的方法。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-08-17T13:03:10.503

我在三星 S3 上也遇到了这个异常。我怀疑有两个根本原因，

1.  您有加载并占用过多内存的位图，请使用缩小尺寸
2.  您在 drawable-_dpi 文件夹中缺少一些可绘制对象，android 在可绘制对象中查找它们并调整它们的大小，使您的 setContentView 突然跳转并使用大量内存。

使用 DDMS 并在播放应用程序时查看堆，这将为您提供一些关于哪个 setcontentview 正在创建问题的指示。

我复制了所有文件夹中的所有可绘制对象以解决问题 2。

问题已解决。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2018-11-05T12:18:40.050

将此添加到您的活动中

```
@Override
protected void onSaveInstanceState(Bundle oldInstanceState) {
    super.onSaveInstanceState(oldInstanceState);
    oldInstanceState.clear();
} 
```

它对我有用，希望它也能帮助你

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-09-19T21:21:47.400

所以对我们来说，我们试图通过我们的 AIDL 接口将太大的对象发送到远程服务。事务大小不能超过 1MB。请求被分解为 512KB 的单独块，并通过接口一次发送一个。我知道一个残酷的解决方案，但是嘿 - 它的 Android :(

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2018-05-31T07:26:23.543

当我尝试通过 Intent 发送位图时遇到了同样的问题，同时我折叠了应用程序。

它在本文中的[描述在此处输入链接描述](https://medium.com/@mdmasudparvez/android-os-transactiontoolargeexception-on-nougat-solved-3b6e30597345)它发生在 Activity 正在停止的过程中，这意味着 Activity 正试图将其保存的状态 Bundles 发送到系统操作系统以安全保存以便以后恢复（在配置更改后或进程死亡），但它发送的一个或多个 Bundle 太大。

我通过在我的活动中覆盖 onSaveInstanceState 通过 hack 解决了它：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    // super.onSaveInstanceState(outState);
} 
```

并评论呼叫超级。这是一个肮脏的黑客，但它工作得很好。位图已成功发送而没有崩溃。希望这会对某人有所帮助。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-07-07T10:36:17.917

**您已经从onSaveInstanceState**方法中清除了旧的 InstanceState ，它会运行良好。我正在为我的 viewpager 使用**FragmentStatePagerAdapter**，因此我将 Override 方法保留在我的父活动中以清除 InstanceState。

```
@Override
protected void onSaveInstanceState(Bundle InstanceState) {
             super.onSaveInstanceState(InstanceState);
             InstanceState.clear();
} 
```

我从这里的[android.os.TransactionTooLargeException on Nougat找到了这个解决方案](https://stackoverflow.com/questions/39098590/android-os-transactiontoolargeexception-on-nougat)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2021-02-09T06:35:17.460

我们的应用程序也有这个问题。经测试发现，当应用内存不足，Activity被回收时，系统调用**onSaveInstanceState**方法保存大量bundle数据，每次数据变大，最后会报**TransactionTooLargeException**错误，所以我觉得这个方法应该可以解决这个问题。

```
public final int MAX_BUNDLE_SIZE = 300;
@Override
protected void onSaveInstanceState(@NonNull Bundle outState) {
     super.onSaveInstanceState(outState);
     long bundleSize = getBundleSize(outState);
     if (bundleSize > MAX_BUNDLE_SIZE * 1024) {
         outState.clear();
     }
}

private long getBundleSize(Bundle bundle) {
     long dataSize;
     Parcel obtain = Parcel.obtain();
     try {
         obtain.writeBundle(bundle);
         dataSize = obtain.dataSize();
     } finally {
        obtain.recycle();
     }
     return dataSize;
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-06-03T11:39:48.390

***最近我在使用 Android 的Contacts Provider***时也遇到了一个有趣的案例。

我需要从内部联系人数据库中加载联系人的照片，并且根据系统架构，所有这些数据都通过查询传递给 Contacts Provider。

由于它作为一个单独的应用程序工作 - 各种数据传输都是通过使用 Binder 机制执行的，因此 Binder 缓冲区在这里发挥作用。

我的主要错误是**我没有关闭**从 Contacts Provider 获取的`Cursor`blob 数据，因此分配给提供程序的内存增加了，这使 Binder 缓冲区膨胀，直到我`!!!FAILED BINDER TRANSACTION!!!`在 LogCat 输出中收到大量消息。

所以主要的想法是，当你使用外部内容提供者并`Cursor`从他们那里得到 s 时，当你完成使用它们时总是关闭它。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2021-01-12T15:26:28.623

这可能会发生，因为 Activity "A" 可能有 Fragments 并且当您导航到 Activity "B" 时。

那么活动“A”的活动生命周期将是

OnResume->OnPause()->OnSavedInsanceState()

OnSavedInsanceState 中的此处可能会导致崩溃，因为它无法保存包含大量数据的状态。所以尝试通过添加以下代码来清除活动“A”的saveInsatnce。

```
 @Override
protected void onSaveInstanceState(Bundle oldInstanceState) {
    super.onSaveInstanceState(oldInstanceState);
    if (oldInstanceState != null) {
        oldInstanceState.clear();
    }

} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-08-11T21:32:54.847

就我而言，在本机库与 SIGSEGV 崩溃后，我得到 TransactionTooLargeException 作为二次崩溃。未报告本机库崩溃，因此我只收到 TransactionTooLargeException。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-01-15T08:56:22.397

当我尝试批量插入一个大的 ContentValues [] 时，我在我的同步适配器中得到了这个。我决定按如下方式修复它：

```
try {
    count = provider.bulkInsert(uri, contentValueses);
} catch (TransactionTooLarge e) {
    int half = contentValueses.length/2;
    count += provider.bulkInsert(uri, Arrays.copyOfRange(contentValueses, 0, half));
    count += provider.bulkInsert(uri, Arrays.copyOfRange(contentValueses, half, contentValueses.length));
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-09-28T10:56:52.037

对我来说，它也是`FragmentStatePagerAdapter`，但是覆盖`saveState()`不起作用。这是我修复它的方法：

调用`FragmentStatePagerAdapter`构造函数时，在类中保留一个单独的片段列表，并添加一个方法来删除片段：

```
class PagerAdapter extends FragmentStatePagerAdapter {
    ArrayList<Fragment> items;

    PagerAdapter(ArrayList<Fragment> frags) {
        super(getFragmentManager()); //or getChildFragmentManager() or getSupportFragmentManager()
        this.items = new ArrayList<>();
        this.items.addAll(frags);
    }

    public void removeFragments() {
        Iterator<Fragment> iter = items.iterator();

        while (iter.hasNext()) {
            Fragment item = iter.next();
                getFragmentManager().beginTransaction().remove(item).commit();
                iter.remove();
            }
            notifyDataSetChanged();
        }
    }
    //...getItem() and etc methods...
} 
```

然后在 中`Activity`，保存`ViewPager`位置并调用`adapter.removeFragments()`覆盖的`onSaveInstanceState()`方法：

```
private int pagerPosition;

@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    //save other view state here
    pagerPosition = mViewPager.getCurrentItem();
    adapter.removeFragments();
} 
```

最后，在被覆盖的`onResume()`方法中，如果不是，则重新实例化适配器`null`。（如果是`null`，那么`Activity`是第一次打开或在应用程序被 Android 杀死后打开，其中`onCreate`将创建适配器。）

```
@Override
public void onResume() {
    super.onResume();
    if (adapter != null) {
        adapter = new PagerAdapter(frags);
        mViewPager.setAdapter(adapter);
        mViewPager.setCurrentItem(currentTabPosition);
    }
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-01-04T19:09:24.610

这发生在我的应用程序中，因为我在片段的参数中传递了一个搜索结果列表，将该列表分配给片段的属性 - 这实际上是对片段参数指向的内存中相同位置的引用 - 然后添加列表中的新项目，这也改变了片段参数的大小。当活动暂停时，基片段类尝试将片段的参数保存在 onSaveInstanceState 中，如果参数大于 1MB，则会崩溃。例如：

```
private ArrayList<SearchResult> mSearchResults;

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    if (getArguments() != null && getArguments().getSerializable("SearchResults") != null) {
        mSearchResults = (ArrayList) getArguments().getSerializable("SearchResults");
    }
}

private void onSearchResultsObtained(ArrayList<SearchResult> pSearchResults) {

    // Because mSearchResults points to the same location in memory as the fragment's arguments
    // this will also increase the size of the arguments!
    mSearchResults.addAll(pSearchResults);
} 
```

在这种情况下，最简单的解决方案是将列表的副本分配给片段的属性，而不是分配引用：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    if (getArguments() != null && getArguments().getSerializable("SearchResults") != null) {

        // Copy value of array instead of reference
        mSearchResults = new ArrayList((ArrayList) getArguments().getSerializable("SearchResults"));
    }
} 
```

一个更好的解决方案是不在参数中传递这么多数据。

[如果没有这个答案](https://stackoverflow.com/a/50162810/1015595)和[TooLargeTool](https://github.com/guardian/toolargetool)的帮助，我可能永远不会找到这个。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-01-14T22:40:13.693

确保不要将大尺寸的 Intent 对象数据放入其中。在我的情况下，我添加了 String 500k 大小，然后开始另一个活动。它总是因为这个例外而失败。我通过使用活动的静态变量避免在活动之间共享数据——您不必将它们发送到 Intent 然后从中提取。

我有什么：

```
String html = new String();//some string of 500K data.
Intent intent = new Intent(MainActivity.this, PageWebView.class);
//this is workaround - I just set static variable and then access it from another    activity.
MainActivity.htmlBody = timelineDb.getHTMLBodyForTweet(tweet);
//This line was present and it actually failed with the same exception you had.
//intent.putExtra("com.gladimdim.offtie.webview", html); 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-12-09T06:10:16.543

当我`WebView`在我的应用程序中处理它时，它会发生。我认为它`addView`与 UI 资源有关。在我的应用程序中，我在`WebViewActivity`下面添加了一些代码，然后它运行正常：

```
@Override
protected void onDestroy() {
    if (mWebView != null) {
        ((ViewGroup) mWebView.getParent()).removeView(mWebView);  
        mWebView.removeAllViews();  
        mWebView.destroy();
    }
    super.onDestroy();
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-06-17T10:37:59.607

我找到了这个问题的根本原因（正如 mvds 所说，我们同时遇到了“添加窗口失败”和文件描述符泄漏）。

Android 4.4中存在一个[错误。](https://issuetracker.google.com/issues/36989300)`BitmapFactory.decodeFileDescriptor()`它仅在`inPurgeable`和`inInputShareable`of`BitmapOptions`设置为时发生`true`。这会在许多地方与文件交互导致许多问题。

请注意，该方法也从 调用`MediaStore.Images.Thumbnails.getThumbnail()`。

*Universal Image Loader*受此问题影响。*Picasso*和*Glide*似乎没有受到影响。 [https://github.com/nostra13/Android-Universal-Image-Loader/issues/1020](https://github.com/nostra13/Android-Universal-Image-Loader/issues/1020)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-04-16T13:34:21.910

writeToParcel(Parcel dest, int flags) 方法中的这一行代码帮助我摆脱了 TransactionTooLargeException。

```
dest=Parcel.obtain(); 
```

仅在此代码之后，我将所有数据写入包裹对象，即 dest.writeInt() 等。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2018-05-07T13:49:54.500

尝试使用`EventBus`或`ContentProvider`喜欢的解决方案。

如果您在同一个进程中（通常您的所有活动都将是），请尝试使用`EventBus`，因为进程中的数据交换不需要缓冲，因此您不必担心数据太大。（你可以只使用方法调用来传递数据，而EventBus隐藏了丑陋的东西）这里是细节：

```
// one side
startActivity(intentNotTooLarge);
EventBus.getDefault().post(new FooEvent(theHugeData));

// the other side
@Subscribe public void handleData(FooEvent event) { /* get and handle data */ } 
```

如果 Intent 的两侧不在同一个进程中，请尝试一下`ContentProvider`。

* * *

请参阅[TransactionTooLargeException](https://developer.android.com/reference/android/os/TransactionTooLargeException)

> Binder 事务因太大而失败。
> 
> 在远程过程调用期间，调用的参数和返回值作为存储在 Binder 事务缓冲区中的 Parcel 对象进行传输。如果参数或返回值太大而无法放入事务缓冲区，则调用将失败并抛出 TransactionTooLargeException。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2018-07-02T09:49:28.890

我从 Android Espresso 测试中的 Stackoverflow 错误中得到了 TransactionTooLargeException。当我为我的应用程序移除 Logcat 过滤器时，我在日志中发现了 stackoverflow 错误堆栈跟踪。

我猜测 Espresso 在尝试处理非常大的异常堆栈跟踪时会导致 TransactionTooLargeException。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2018-09-04T21:26:18.687

我也面临从一个活动传递到另一个活动的位图数据的这个问题，但是我通过将我的数据作为静态数据来解决这个问题，这对我来说是完美的

首先在活动中：

```
public static Bitmap bitmap_image;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_first);
   bitmap_image=mybitmap;
} 
```

在第二个活动中：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_second);
   Bitmap mybitmap=first.bitmap_image;
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2019-01-30T13:50:31.820

@Vaiden 的[回答](https://stackoverflow.com/a/45918926/2914140)帮助了我。我不明白为什么短名单会引发这种例外。我有很多片段和几个`ViewPager`带有列表的 s。所以，每次我开始另一个活动或停止一个程序（关闭屏幕）时，我都会捕捉到这个异常（通常在小米上）。

我发现*所有片段都调用*了它们的`onSaveInstanceState()`事件，并最终**托管了调用`onSaveInstanceState()`**before的活动`onStop()`。之后发生了崩溃。因此，我了解到许多短列表（大小为 10-100 Kb）可能会引发`TransactionTooLargeException`异常。

您可以通过将数据写入数据库然后通过它们`id`的 s 获取项目来克服这个问题。这样，您可以将`id`s 列表传递给 Activity/Fragment。

但是，如果您想要一种临时的快速方法，请执行此操作。

1）创建一个保留实例片段，它将在活动重新创建期间存活。

```
class SavedInstanceFragment : Fragment() {

    // This map will hold bundles from different sources (tag -> bundle).
    private lateinit var bundleMap: HashMap<String, Bundle?>

    // This method is only called once for this fragment.
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        retainInstance = true
        bundleMap = HashMap()
    }

    fun pushData(key: String, bundle: Bundle): SavedInstanceFragment {
        if (bundleMap[key] == null) {
            bundleMap[key] = bundle
        } else {
            bundleMap[key]!!.putAll(bundle)
        }
        return this
    }

    fun popData(key: String): Bundle? {
        val data = bundleMap[key]
        bundleMap[key] = null
        return data
    }

    fun removeData(key: String) {
        bundleMap.remove(key)
    }

    companion object {

        private val TAG = SavedInstanceFragment::class.java.simpleName

        // Create the fragment with this method in `onCreate()` of an activity.
        // Then you can get this fragment with this method again.
        fun getInstance(fragmentManager: FragmentManager): SavedInstanceFragment {
            var out = fragmentManager.findFragmentByTag(TAG) as SavedInstanceFragment?

            if (out == null) {
                out = SavedInstanceFragment()
                fragmentManager.beginTransaction().add(out, TAG).commit()
            }
            return out
        }
    }
} 
```

2) 在`onCreate()`您的包含问题片段的活动中，创建此片段。它将在活动娱乐中幸存下来。您应该在将其他片段添加到 之前创建它`FragmentManager`，因为此操作是异步的。

```
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    setContentView(R.layout.activity)

    if (savedInstanceState == null) {
        SavedInstanceFragment.getInstance(supportFragmentManager)
    }

    ...
} 
```

3）在每个问题片段中添加这些行。您应该随处访问一个保留实例片段`getInstance(activity!!.supportFragmentManager)`，以便您可以在内部找到它`FragmentManager`。如果`childFragmentManager`用作 的参数`getInstance()`，那么您将创建另一个片段并崩溃。

`arguments`在您阅读它们并设置 a`bundle`之后，例如在`onSaveInstanceState`:中设置 a也很清楚`arguments?.clear()`。这非常重要，因为当您创建新片段时，参数会保留在内存中。当您稍后返回当前片段并旋转屏幕时，数据不会丢失，因为它们已经包含在 a 中`bundle`并将被读取到`onCreate`.

```
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)

    val bundle = if (savedInstanceState == null) {
        // Remove old data in order not to show wrong information.
        SavedInstanceFragment.getInstance(activity!!.supportFragmentManager).removeData(TAG)
        null
    } else {
        SavedInstanceFragment.getInstance(activity!!.supportFragmentManager).popData(TAG)
    }
    (bundle ?: arguments)?.run { // I access 'bundle' or 'arguments', depending if it is not first or first call of 'onCreate()'.
        token = getString(ARG_TOKEN)!!
        id = getInt(ARG_ID)
        items = getParcelableArrayList(ARG_ITEMS)
    }
}

override fun onSaveInstanceState(outState: Bundle) {
    // Create a copy of savedInstanceState and push to the retain-instance fragment.
    val bundle = (outState.clone() as Bundle).apply {
        putString(ARG_TOKEN, token)
        putInt(ARG_ID, id)
        putParcelableArrayList(ARG_ITEMS, items)
    }
    SavedInstanceFragment.getInstance(activity!!.supportFragmentManager).pushData(TAG, bundle)
    arguments?.clear() // Avoids an exception "java.lang.RuntimeException: android.os.TransactionTooLargeException: data parcel size xxxxxxx bytes".
    super.onSaveInstanceState(outState)
}

companion object {

    private val TAG = YourFragment::class.java.simpleName

    private const val ARG_TOKEN = "ARG_TOKEN"
    private const val ARG_ID = "ARG_ID"
    private const val ARG_ITEMS = "ARG_ITEMS"

    fun newInstance(token: String, id: Int, items: ArrayList<Item>?) =
        YourFragment().apply {
            arguments = Bundle().apply {
                putString(ARG_TOKEN, token)
                putInt(ARG_ID, id)
                putParcelableArrayList(ARG_ITEMS, items)
            }
        }
} 
```

**您可以使用Singleton**代替持久片段。另请阅读[https://medium.com/@mdmasudparvez/android-os-transactiontoolargeexception-on-nougat-solved-3b6e30597345](https://medium.com/@mdmasudparvez/android-os-transactiontoolargeexception-on-nougat-solved-3b6e30597345)了解有关**库**、解决方案的更多信息。

我想，如果您的活动在开始其他活动后被删除，则此解决方案将不起作用。您可以在打开`Do not keep activities`开发人员选项中的复选框时检查此行为（不要忘记取消选中之后）。在这种情况下`getFragmentManager()`将是新的，您将不会获得旧数据。当您从新活动返回时，您将获得`null`一个`bundle`.

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2019-04-18T11:56:48.763

我也经历过 TransactionTooLargeException。首先，我一直在努力了解它发生在哪里。我知道它发生的原因。我们每个人都知道，因为内容很大。我的问题就是这样，我解决了。也许这个解决方案对任何人都有用。我有一个从 api 获取内容的应用程序。我在第一个屏幕中从 API 获取结果并将其发送到第二个屏幕。我可以成功将此内容发送到第二个屏幕。如果我想进入第三个屏幕，则在第二个屏幕之后会发生此异常。我的每个屏幕都是从 Fragment 创建的。我注意到当我从第二个屏幕离开时。它保存其捆绑内容。如果此内容太大，则会发生此异常。我的解决方案是在我从捆绑包中获取内容后清除它。

```
class SecondFragment : BaseFragment() {

    lateinit var myContent: MyContent

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        myContent = arguments?.getParcelable("mycontent")
        arguments?.clear()
    } 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2019-07-15T10:02:03.733

有时`Activity`包括一些需要完全重新创建片段内容的情况，如果没有明确的`Fragment`历史片段`Activity``sportFragmentManager.fragments`

```
 val fragments = sportFragmentManager.fragments
    val transaction = sportFragmentManager.beginTransaction()
    for (frag in fragments){
        transaction.remove(frag)
    }
    transaction.commitAllowingStateLoss() 
```

几次重新创建片段`Activity`会发生（调试使用[tooLargeTool](https://github.com/guardian/toolargetool)）

```
 W/ActivityStopInfo: Bundle stats:
 W/ActivityStopInfo:   android:viewHierarchyState [size=2304]
 W/ActivityStopInfo:     android:views [size=2256]
 W/ActivityStopInfo:   android:support:fragments [size=519072]
 W/ActivityStopInfo: PersistableBundle stats:
 W/ActivityStopInfo:   [null] 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2020-08-21T12:52:48.590

问题通过以下方式解决：

```
 Bundle bundle = new Bundle();
  bundle.putSerializable("data", bigdata);
...
  CacheHelper.saveState(bundle,"DATA");
  Intent intent = new Intent(mActivity, AActivity.class);
  startActivity(intent, bb);// do not put data to intent.

In Activity:
   @Override
   protected void onCreate(Bundle savedInstanceState) {
        Bundle bundle = CacheHelper.getInstance().loadState(Constants.DATA);
        if (bundle != null){
            Intent intent = getIntent();
            intent.putExtras(bundle);
        }
        getIntent().getExtra(..);
        ....
   }
   @Override
    protected void onDestroy() {
        super.onDestroy();
        CacheHelper.clearState("DATA");
    }

public class CacheHelper {

    public static void saveState(Bundle savedInstanceState, String name) {
        Bundle saved = (Bundle) savedInstanceState.clone();
        save(name, saved);
    }
    public Bundle loadState(String name) {

        Object object = load(name);
        if (object != null) {
            Bundle bundle = (Bundle) object;
            return bundle;
        }
        return null;
    }
    private static void save(String fileName, Bundle object) {
        try {
            String path = StorageUtils.getFullPath(fileName);
            File file = new File(path);
            if (file.exists()) {
                file.delete();
            }
            FileOutputStream fos = new FileOutputStream(path, false);

            Parcel p = Parcel.obtain(); //creating empty parcel object
            object.writeToParcel(p, 0); //saving bundle as parcel
            //parcel.writeBundle(bundle);
            fos.write(p.marshall()); //writing parcel to file

            fos.flush();
            fos.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    private static Bundle load(String fileName) {
        try {
            String path = StorageUtils.getFullPath(fileName);
            FileInputStream fis = new FileInputStream(path);

            byte[] array = new byte[(int) fis.getChannel().size()];
            fis.read(array, 0, array.length);

            Parcel parcel = Parcel.obtain(); //creating empty parcel object
            parcel.unmarshall(array, 0, array.length);
            parcel.setDataPosition(0);
            Bundle out = parcel.readBundle();
            out.putAll(out);

            fis.close();
            parcel.recycle();
            return out;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
public static void clearState(Activity ac) {
    String name = ac.getClass().getName();
    String path = StorageUtils.getFullPath(name);
    File file = new File(path);
    if (file.exists()) {
        file.delete();
    }
}
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-11-06T21:34:00.803

一个解决方案是应用程序将 ArrayList（或导致问题的任何对象）写入文件系统，然后通过 Intent 将对该文件的引用（例如，文件名/路径）传递给 IntentService，然后让 IntentService检索文件内容并将其转换回 ArrayList。

当 IntentService 处理完文件后，它应该删除它或通过本地广播将指令传回应用程序以删除它创建的文件（传回提供给它的相同文件引用）。

有关更多信息，请参阅[我对此相关问题的回答](https://stackoverflow.com/a/40454769/1617737)。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2017-06-12T06:58:44.413

作为 Intents、Content Providers、Messenger，所有系统服务（如电话、振动器等）都使用 Binder 提供的 IPC 基础设施。此外，活动生命周期回调也使用此基础设施。

1MB 是在特定时刻系统中执行的所有 binder 事务的总体限制。

如果在发送意图时发生大量事务，即使额外数据不大，它也可能会失败。[http://codetheory.in/an-overview-of-android-binder-framework/](http://codetheory.in/an-overview-of-android-binder-framework/)

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-01-03T00:59:42.793

有这么多地方会发生**TransactionTooLargeException** - 这是 Android 8 的另一个新功能 - 如果内容太大，当有人开始输入 EditText 时就会发生崩溃。

它与[AutoFillManager](https://developer.android.com/reference/android/view/autofill/AutofillManager.html)（API 26 中的新功能）和[以下](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/view/autofill/AutofillManager.java#1000)代码有关`StartSessionLocked()`：

```
 mSessionId = mService.startSession(mContext.getActivityToken(),
            mServiceClient.asBinder(), id, bounds, value, mContext.getUserId(),
            mCallback != null, flags, mContext.getOpPackageName()); 
```

如果我理解正确，这会调用自动填充服务——在活页夹中传递 AutofillManagerClient。而当 EditText 有很多内容时，似乎会导致 TLE。

一些事情可能会减轻它（或者像我测试的那样）：添加`android:importantForAutofill="noExcludeDescendants"`EditText 的 xml 布局声明。或在代码中：

```
EditText et = myView.findViewById(R.id.scriptEditTextView);
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
    et.setImportantForAutofill(View.IMPORTANT_FOR_AUTOFILL_NO_EXCLUDE_DESCENDANTS);
} 
```

第二个糟糕的解决方法也可能是覆盖`performClick()`和`onWindowFocusChanged()`方法来捕获 TextEdit 子类本身中的错误。但我认为这真的不明智...

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-01-24T12:17:27.190

对我来说，当我尝试通过意图将**大位图**图像从一个活动发送到另一个活动时，发生了***TransactionTooLargeException 。***我通过使用[应用程序的全局变量](https://stackoverflow.com/questions/1944656/android-global-variable)解决了这个问题。

 **例如，如果您想将大型位图图像从活动**A**发送到活动**B**，则将该位图图像存储在全局变量中

```
((Global) this.getApplication()).setBitmap(bitmap); 
```

然后启动活动 B 并从全局变量中读取

```
Bitmap bitmap = ((Global) this.getApplication()).getBitmap(); 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2018-08-24T06:08:58.980

一个可以使用：

```
android:largeHeap="true" 
```

在应用程序标签下的 Android 清单中。

这解决了我的问题！

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2018-12-06T10:33:55.647

对我来说，这个错误出现在演示者中。我对 onResume 发表了评论并在 onStart 中编写了相同的代码，它对我有用。

```
 @Override
    public void onStart() {
        super.onStart();
        Goal goal = Session.getInstance(getContext()).getGoalForType(mMeasureType);
        if (goal != null && goal.getValue() > 0) {
            mCurrentValue = (int) goal.getValue();
            notifyPropertyChanged(BR.currentValue);
            mIsButtonEnabled.set(true);
        }
    }
   /* @Override
    public void onResume() {
        super.onResume();
        Goal goal = Session.getInstance(getContext()).getGoalForType(mMeasureType);
        if (goal != null && goal.getValue() > 0) {
            mCurrentValue = (int) goal.getValue();
            notifyPropertyChanged(BR.currentValue);
            mIsButtonEnabled.set(true);
        }
    }*/ 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2019-06-17T09:27:50.840

如果您在项目中将位图转换为 Base64 并将其保存到可打包对象中，您应该使用以下代码调整位图大小，

用 jpeg 替换 png 并将质量 100 替换为 75 或 60 ：

`bitmap.compress(Bitmap.CompressFormat.JPEG, 75, byteArrayOutputStream)`

这个解决方案对我有用

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2020-07-30T10:08:59.893

在我的情况下，TransactionTooLargeException 的原因是我将大数据发送到参数中的片段（使用 Bundle），如下所示：

```
 var arguments = Bundle()
        arguments.putSerializable("argumentName", argumentValue)
        fragment.arguments = arguments 
```

只有当argumentValue 具有小尺寸（例如Int 或String）时它才能正常工作，但如果它具有大尺寸（例如DTO 列表） - 您可以获得TransactionTooLargeException。所以现在我将参数传递给构造函数中的片段，一切正常。

PS 感谢[sulai](https://stackoverflow.com/users/1208581/sulai)的[TooLargeTool](https://github.com/guardian/toolargetool)

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2021-03-15T13:55:09.593

我在 ViewPager2 和 FragmentStateAdapter 上遇到了同样的问题，这里的问题是将 FragmentStateAdapter 标记为“saveState()”作为最终的，而 ViewPager2 类也是最终的，所以我们不能覆盖其他答案中建议的方法，从而使现有答案不适用。

在我的情况下，通过在视图寻呼机的 XML 条目中添加 \android:saveEnabled="false" ' 来不保存寻呼机的状态，我能够摆脱事务太大的问题

```
<androidx.viewpager2.widget.ViewPager2
    android:saveEnabled="false"
    android:id="@+id/viewPager"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" /> 
```

* * *

## 回答 #41

> 赞同：-1
> 
> 时间：2021-05-27T19:42:51.430

**如果您将 ViewPager2 FragmentStateAdapter 与导航组件一起使用：**

我在 onViewCreated() 中创建了适配器，但每次导航返回时都会重新创建视图。由于某种原因，旧适配器没有正确分离并增加捆绑包大小，直到发生错误。我使用 TooLargeTool 对其进行调试，解决方案是避免在 onViewCreated() 中重新创建适配器。

在我的片段中，我有适配器变量：

```
var pagerAdapter:HomePagerAdapter?=null 
```

在 onViewCreated 方法中，我只创建了一次适配器：

```
if(pagerAdapter == null){
  pagerAdapter = HomePagerAdapter(childFragmentManager, lifecycle, myContent)
} 
```

为了防止 IllegalArgumentException，我手动将适配器从 onDestroyView 内的寻呼机中分离：

```
override fun onDestroyView() {
   pager.adapter = null
   super.onDestroyView()
} 
```

* * *

## 回答 #42

> 赞同：-6
> 
> 时间：2012-09-25T10:22:37.073

另一个可能的原因：

我有一个活动正在开始`onResume()`！这会导致大量交易并导致手机（Galaxy S2）完全冻结（没有 ANR 或任何东西）然后硬重置，这本身就是一个巨大的错误。

使用此代码查看其他手机上会发生什么会很有趣：

```
class MyActivity extends Activity
{
  // ...
  @Override
  void onResume()
  {
     super.onResume()
     startActivity(new Intent(this, MyActivity.class));
  }
} 
```

**我并不是说您应该使用该代码。****

# ios - 如何为 rgb 到 hsl 转换创建 lut

> ID：11451395
> 
> 赞同：1
> 
> 时间：2012-07-12T12:01:42.630
> 
> 标签：ios, opengl-es, shader, rgb, hsl

我需要使用着色器进行 rgb 到 hsl 的转换，反之亦然。我尝试以编程方式完成所有操作，但它太慢了……所以我阅读了有关转换的查找表 LUT，但我不知道如何创建它以及它必须包含的内容...我还需要知道如何将 lut 大小减小到所需的最小值，否则它可能对于 iphone 内存来说太大了。要处理的帧，所以要处理的纹理是 32 位 rgba --> 所以 rgb 是 24 位 --> 每像素 8 位。

我非常感谢任何帮助，但专注于创建 lut 并且只有在对如何使用它进行了很好的解释之后......因为我的问题是如何创建它。

这是着色器代码：

顶点着色器

```
attribute vec4 position;
attribute mediump vec4 textureCoordinate;
varying mediump vec2 coordinate;

void main()
{
    gl_Position = position;
    coordinate = textureCoordinate.xy;
} 
```

片段着色器

```
varying highp vec2 coordinate;
uniform sampler2D videoframe;

/*
 Hue, Saturation, Luminance
*/
highp vec3 RGBToHSL(highp vec3 color){
    highp vec3 hsl;;

    highp float fmin = min(min(color.r, color.g), color.b);
    highp float fmax = max(max(color.r, color.g), color.b);    

    highp float delta = fmax - fmin;

    hsl.z = (fmax + fmin)/2.0; 

    if(delta == 0.0) { //gray no chroma
        hsl.x = 0.0;
        hsl.y = 0.0;
    }
    else{
        if(hsl.z < 0.5){ //Saturation
            hsl.y = delta/(fmax + fmin);
        }
        else{
            hsl.y = delta/ (2.0 - fmax - fmin);
        }

//        //NO BRANCHING
//        highp float br1 = float(hsl.z<0.5);    
//        highp float br2 = float(hsl.z>=0.5);
//        highp float denominator = (2.0*(sign(br2))) + (sign(br1)*(fmax+fmin)) - (sign(br2)*(fmax+fmin));
//    
//        hsl.y = delta/denominator;        
//        //

        highp float deltaR = (((fmax - color.r)/6.0) + (delta / 2.0)) / delta;
        highp float deltaG = (((fmax - color.g)/6.0) + (delta / 2.0)) / delta;
        highp float deltaB = (((fmax - color.b)/6.0) + (delta / 2.0)) / delta; 

        if(color.r == fmax){ //Hue
            hsl.x = deltaB - deltaG; 
        }
        else if(color.g == fmax){
            hsl.x = (1.0/3.0) + deltaR - deltaB; 
        }
        else if(color.b == fmax){
            hsl.x = (2.0/3.0) + deltaG - deltaR;
        }

        if(hsl.x < 0.0){
            hsl.x = hsl.x + 1.0;
        }
        else if(hsl.x > 1.0){
            hsl.x = hsl.x - 1.0;
        }
    }

 //    //NO BRANCHING
 //    highp float br3 =  sign(float(delta!=0.0));
 //    
 //    hsl.x = hsl.x * br3;
 //    hsl.y = hsl.y * br3;    
 //    //

    return hsl;
}

highp float HueToRGB(highp float f1, highp float f2, highp float hue){

//    //NO BRANCHING
//    highp float br1 = sign(float(hue<0.0));
//    highp float br2 = sign(float(hue>1.0));    
//    hue = hue + (br1 * 1.0) - (br2 * 1.0);
//    //

    highp float res;
    if((6.0 * hue) < 1.0){
        res = f1 + (f2 - f1) * 6.0 * hue;
    }
    else if((2.0*hue)<1.0){
        res = f2;
    }
    else if((3.0*hue)<2.0){
        res = f1 + (f2-f1) * ((2.0/3.0) - hue) * 6.0;
    }
    else{
        res = f1;
    }

 //    //NO BRANCHING
 //    highp float br3 = sign(float((6.0 * hue) < 1.0));
 //    highp float br4 = sign(float((2.0*hue)<1.0));
 //    highp float br5 = sign(float((3.0*hue)<2.0));    
//
//    res = f1;
//    res = br3 * (f1 + (f2 - f1) * 6.0 * hue);
//    res = br4 * f2;
//    res = br5 * (f1 + (f2-f1) * ((2.0/3.0) - hue) * 6.0);    
 //    //

    return res;
}

highp vec3 HSLToRGB(highp vec3 hsl){
    highp vec3 rgb;

    if(hsl.y == 0.0){
        rgb = vec3(hsl.z);
    }
    else{
        highp float f2;

        if(hsl.z<0.5){
            f2 = hsl.z * (1.0 + hsl.y);
        }
        else{
            f2 = (hsl.z + hsl.y) - (hsl.y * hsl.z);
        }

//         //NO BRANCHING
//        highp float br2 = sign(float(hsl.z<0.5)); 
//        highp float br3 = sign(float(hsl.z>=0.5));         
//        f2 = br2 * (hsl.z * (1.0 + hsl.y)) + br3 * ((hsl.z + hsl.y) - (hsl.y * hsl.z));
//        //

        highp float f1 = 2.0 * hsl.z - f2;

        rgb.r = HueToRGB(f1,f2, hsl.x + (1.0/3.0));
        rgb.g = HueToRGB(f1,f2, hsl.x);
        rgb.b = HueToRGB(f1,f2, hsl.x - (1.0/3.0));        
    }

//        highp float br1 = sign(float(hsl.y == 0.0));
//        highp float not_br1 = sign(float(hsl.y != 0.0));
//        rgb = (rgb) * (not_br1,not_br1,not_br1) + (br1,br1,br1) *  vec3(hsl.z,hsl.z,hsl.z);    

    return rgb;
}

void main()  
{
    //GrayScale
    /*
    highp float grey = dot(texture2D(videoframe, coordinate).rgb, vec3(0.299, 0.587, 0.114));
gl_FragColor = vec4(grey, grey, grey, 1.0);
    */

    //Sepia
    /*
    highp float grey = dot(texture2D(videoframe, coordinate).rgb, vec3(0.299, 0.587, 0.114));
gl_FragColor = vec4(grey * vec3(1.2, 1.0, 0.8), 1.0);
    */

    //Other Effect
    ////**MULTIPLY STEP (Blending Multiply Mode)
    highp vec4 paleYellow = vec4(250.0/255.0, 220.0/255.0, 175.0/255.0, 1.0);
    highp vec3 paleYellowLuminance = RGBToHSL(paleYellow.xyz);

    highp vec4 FragColor = texture2D(videoframe, coordinate);
    highp vec3 fragLuminance = RGBToHSL(FragColor.xyz);

    highp float newLuminance = paleYellowLuminance.z * fragLuminance.z;
    highp vec3 fragHSL = vec3(fragLuminance.xy, newLuminance);

    ////
    gl_FragColor = vec4(HSLToRGB(fragHSL), 1.0); //this is very slow (if i comment this, and uncomment the last line to avoid crash, about 20 f/s otherwise 5-6 so the problem, obviously is here. I tried debranching too, as you can see looking at commented code, but no results...)
    //

    //gl_FragColor = texture2D(videoframe, coordinate);

} 
```

解决了！！！

# c# - 奇怪的 .NET 路径错误

> ID：11451398
> 
> 赞同：0
> 
> 时间：2012-07-12T12:01:55.697
> 
> 标签：c#, php, .net, path

我正在尝试通过 PHP 运行以调试模式构建的 .NET 应用程序。

PHP 成功运行其他应用程序。

问题是当我通过 Windows 资源管理器运行此应用程序时（即通过在地址栏中键入“C:\app.exe 参数”），它工作得非常好。

但是，当我使用 PHP 或 CMD.exe（命令提示符）运行相同的程序时，应用程序会崩溃。我查看了临时文件夹中生成的元数据文件，它有一个 FileNotFound IO 异常。

有什么线索吗？

看起来像一些臭名昭著的目录问题（工作路径等）

请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:08:45.550

> 看起来像一些臭名昭著的目录问题

是的，这听起来像是一个应用程序错误 - 可能应用程序正在对当前工作目录做出假设，这并不总是正确的。可能假设当前工作目录 ( `Environment.CurrentDirectory`) 与应用程序的安装目录 ( `AppDomain.CurrentDomain.BaseDirectory`) 相同。

从 Windows 资源管理器运行应用程序时，此假设可能是正确的，但在一般情况下不一定如此。

要访问存储在相对于安装目录的文件夹中的文件，请替换`Environment.CurrentDirectory`为`AppDomain.CurrentDomain.BaseDirectory`.

# extjs4.1 - EXTJS 4 MVC 架构

> ID：11451400
> 
> 赞同：2
> 
> 时间：2012-07-12T12:02:01.383
> 
> 标签：extjs4.1

我在 EXTJS 4.1 MVC 架构中工作。我对此完全陌生，我在想是否有办法在商店文件中拥有多个商店。

例如，我们有两个目录，model 和 store，每个目录都有文件。我在 store 文件夹中有一个名为 Locations.js 的文件。我想在这个文件中定义三个商店。例如：“地区”、“地区”、“城市”

所以，首先当我尝试定义第一个商店时，萤火虫显示错误找不到 store/regions.js 文件。而它应该查找的文件实际上是 Locations.js 文件。有没有办法解决这个问题，或者是存储名称和文件名应该相同，并且我们只能存储在一个文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:13:51.753

Loader 只知道如何在自己的文件中查找类。您可以通过手动加载文件来做到这一点，但这比它的价值更麻烦，而且您将失去 Ext 构建依赖关系树和使用 SDK 工具缩小的能力。

每个文件坚持一堂课。不过，您可以随心所欲地深入，因此您的文件系统可以具有以下内容：

```
App/store/location/Region.js
App/store/location/Area.js
App/store/location/City.js 
```

只要确保你的类有相应的名称。（例如`App.store.location.Region`）然后您甚至可以拥有`App.store.location.Location`所有其他人扩展的基础。如果这是一个大项目，我还发现从一开始就将 Ext.data.Store 子类化（make `App.store.Store`）很有用，并确保您的所有商店都扩展它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:15:32.807

这是由`Ext.loader`. 它提供了一个动态加载“类”的系统。所以是的，当你有一个对象时`MyApp.store.Regions`，它应该在 store 文件夹内的文件中。

但这应该不是什么大问题。您可以使用 sencha 构建工具在 1 个文件中缩小。

您还可以[禁用](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Loader-cfg-enabled)加载程序并手动进行加载。（但我不建议这样做）

# html - 需要选择两行，然后在这些行周围添加 HTML

> ID：11451406
> 
> 赞同：1
> 
> 时间：2012-07-12T12:02:29.737
> 
> 标签：html, regex

我试图将文本转换为 HTML 表格并且我卡在部分以分隔行。

假设我从显示如下的文本开始：

> 1：一个
> 
> 2：w
> 
> 3：p

然后用一点点正则表达式我把它变成了

```
<td>1</td>
<td>a</td>
<td>2</td>
<td>w</td>
<td>3</td>
<td>p</td> 
```

现在我将如何（使用 REGEX）将其变成这样：

```
<tr>
  <td>1</td>
  <td>a</td>
</tr>
<tr>
  <td>2</td>
  <td>w</td>
</tr>
<tr>
  <td>3</td>
  <td>p</td>
</tr> 
```

*缩进就在那里，因此您可以更好地看到它，我实际上并不希望它添加它们。*

所以我会以某种方式让它寻找

```
<td>[0-9] 
```

然后选择它和下一行，然后通过执行添加 and 到它

```
<td>\1<\td> 
```

但我完全不知道该怎么做，如果有人能理解这个烂摊子，你能帮我吗？丁：

**编辑：**解决了！

我从

> 1：一个
> 
> 2：w
> 
> 3：p

然后我这样做了：

```
Find: ": "
Replace: "\r\n" 
```

然后

```
Find: "([0-9])"
Replace: "<td>\1<td>" 
```

然后

```
Find: "^([^<]+)$"
Replace: "" 
```

然后

```
Find: "(<td>[0-9]</td>)[\r][\n]"
Replace: "\1" 
```

呼呼呼，然后

```
Find: "^(.*<td>[0-9]*+)$"
Replace: "<tr>\1</tr>" 
```

可能有更简单的方法可以做到这一点，但我终于明白了：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:08:16.173

您的第一个正则表达式应将初始文本转换为 3 行，而不是您显示的 6 行：

```
<td>1</td><td>a</td>
<td>2</td><td>w</td>
<td>3</td><td>p</td> 
```

那么问题就变得比较简单了。

# c#-4.0 - FirebirdSql中参数的正确使用

> ID：11451412
> 
> 赞同：5
> 
> 时间：2012-07-12T12:02:42.943
> 
> 标签：c#-4.0, firebird

我想知道是否有人可以提供以下帮助。

```
using (FbConnection conn = new FbConnection(ConnectionString))
{
    conn.Open();

    // --------------------------------------------------------------------------
    FbCommand command1 = new FbCommand("SELECT @AN_INT FROM RDB$DATABASE", conn);
    command1.Parameters.Add("AN_INT", FbDbType.Integer);
    try
    {
        command1.Prepare();  //  Message=Dynamic SQL Error
                            //SQL error code = -804
                            //Data type unknown
                            //  Source=FirebirdSql.Data.FirebirdClient
                            //  ErrorCode=335544569
                            //  SQLSTATE=42000
    }
    catch(Exception E)
    {
        MessageBox.Show(E.Message);
    }
    // --------------------------------------------------------------------------
    FbCommand command2 = new FbCommand("SELECT 123 FROM RDB$DATABASE WHERE 789 >= @AN_INT", conn);
    command2.Parameters.Add("AN_INT", FbDbType.Integer);
    try
    {
        command2.Prepare();  // No Problem
    }
    catch (Exception E)
    {
        MessageBox.Show(E.Message);
    }
} 
```

我的问题是——我从另一个编码员那里接了一个项目，我认为，如果可能的话，我应该更改数据库组件以使用参数化查询；现有技术是将值注入 Sql 字符串。任务是重构一个类以在现有项目中工作。

上面的代码示例演示了一个我必须解决的问题，我想知道还有其他问题。本质上，问题在于创建一个将字符串转换为参数化查询的类。有没有人这样做过，沿途可能有什么陷阱或技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:24:50.907

您的第一个查询需要是`SELECT cast(@AN_INT as int) FROM RDB$DATABASE`. 否则 Firebird 不知道参数类型是什么（即使它是在 C# 代码中指定的）。

您可以尝试直接在 Firebird 中运行这段代码，看看引擎本身的局限性。

```
execute block
as
begin
    execute statement ('select :foobar from rdb$database')(foobar := 10);
end 
```

# frameworks - 算法框架

> ID：11451425
> 
> 赞同：1
> 
> 时间：2012-07-12T12:03:28.870
> 
> 标签：frameworks

我想把自己投入到应用程序本地化中，我想知道使用哪种算法，是否有实现 A* 或 Dijkstra 算法的框架以促进开发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:06:42.857

我可以建议熟悉[Neo4j](http://neo4j.org)。

*这是一个基于图形的数据库，实现了开箱即*用的 A* 和 Dijkstra（以及其他）路径查找算法。您可以通过 REST（作为独立服务器运行）与此 DB 进行通信，或者将 DB 嵌入到您的应用程序中（有多种针对不同语言的绑定[——Python](https://github.com/neo4j/python-embedded)、[Ruby](https://github.com/maxdemarzi/neography/)等）。

[您可以在此](http://docs.neo4j.org/chunked/stable/rest-api-graph-algos.html)页面上阅读有关内置图形算法的信息。

![Neo4j 管理界面](../Images/64cefbc460614516b51efaa5be0d7b33.png)

# android - 在 Jelly Bean 上进行语音搜索之前处理耳机按钮

> ID：11451430
> 
> 赞同：8
> 
> 时间：2012-07-12T12:03:46.827
> 
> 标签：android, android-4.2-jelly-bean

Android Jelly Bean 引入了语音搜索，通过长按耳机的播放/暂停按钮来激活。由于我的应用程序需要能够使用这些长按，我想知道是否有任何方法可以禁用语音搜索或使 Android 与按钮事件公平竞争。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:20:28.180

我自己没有尝试过，但是您可以使用 AudioManager 的[registerMediaButtonEventReceiver](http://developer.android.com/reference/android/media/AudioManager.html#registerMediaButtonEventReceiver(android.content.ComponentName))方法来实现它，因为音量按钮是媒体按钮。

AOSP 音乐应用程序有一个[MediaButtonIntentReceiver](https://github.com/android/platform_packages_apps_music/blob/master/src/com/android/music/MediaButtonIntentReceiver.java)响应音量按钮按下。

此解决方案的功劳属于[此答案](https://stackoverflow.com/a/11510564/1023092)。

# ruby-on-rails - Rails i18n 输入验证（不是错误消息）

> ID：11451434
> 
> 赞同：1
> 
> 时间：2012-07-12T12:03:59.390
> 
> 标签：ruby-on-rails, validation, internationalization

我正在编写一个应用程序，它必须能够接受的不仅仅是英文字母。

我搜索的所有内容都指向我已经为翻译设置的错误验证消息；那没问题。

有谁知道 ruby​​/rails 中按语言/地区/国家定义可接受的字母的资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:24:27.237

Rails 接受所有字符。在您的代码中，您必须在 ruby​​ 文件的顶部添加“# encoding: UTF-8”。

# c++ - C++ SHGetFolderPath 问题

> ID：11451435
> 
> 赞同：0
> 
> 时间：2012-07-12T12:04:04.660
> 
> 标签：c++

我正在尝试获取本地“程序文件”目录路径并为其附加一些额外的路径并简单地执行它。不能让它正常工作。。

这是我当前的代码：

```
wchar_t* localAppData = 0;
SHGetFolderPath(NULL, CSIDL_PROGRAM_FILESX86, 0, NULL, &localAppData);

wstringstream ss;
ss << localAppData << L"/MyApp/MyExe.exe";

CreateProcess(static_cast<void*>(localAppData)); 
```

我为 SHGetFolderPath 得到了这个：

```
cannot convert parameter 5 from wchar_t ** to LPWSTR 
```

此外，即使我在标题中包含了 sstream，我也会收到以下错误：

```
'wstringstream' : undeclared identifier 
```

注意：我正在使用 SHGetFolderPath 因为我需要它才能在 XP 和 Vista/7 上工作

**编辑：**

上面的代码有一个错误，我试图运行`localAppData`“程序文件”目录的路径，而不是运行整个路径。

但是当我尝试在函数中使用`ss`var 而不是`localAppData`var 时`CreateProcess`，我收到关于使用错误类型的 var 的错误（需要使用 LPCWSTR）。

但是当我尝试这个时，效果不佳..没有错误但应用程序没有运行，我错过了什么？

```
wchar_t localAppData[MAX_PATH];
STARTUPINFO sInfo;
PROCESS_INFORMATION pInfo;
SHGetFolderPath(NULL, CSIDL_PROGRAM_FILESX86, 0, NULL, localAppData);

std::wstringstream ss;
ss << localAppData << L"/MyApp/MyExe.exe";
LPCWSTR str = ss.str().c_str();
CreateProcess(str, NULL,NULL, NULL,FALSE,NULL,NULL,NULL,&sInfo,&pInfo);
return str; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:07:31.743

```
wchar_t localAppData[MAX_PATH];
SHGetFolderPath(NULL, CSIDL_PROGRAM_FILESX86, 0, NULL, localAppData);
std::wstringstream ss；

```

1.  SHGetFolderPath 需要指向调用者分配的数组的指针，并用结果路径填充它。

2.  不要忘记 std 命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:08:12.083

`SHGetFolderPath`不会为您分配缓冲区并更改 的值`localAppData`，因此它不接受`wchar_t**`像您在此处传递的那样。您需要自己分配缓冲区，例如：

```
whar_t localAppData[MAX_PATH];
SHGetFolderPath(NULL, CSIDL_PROGRAM_FILESX86, 0, NULL, localAppData); 
```

至于`wstringstream`，你`using namespace std;`呢？如果不是，则需要将类型指定为`std::wstringstream`.

# caching - Azure 缓存（预览版）项目大小限制

> ID：11451437
> 
> 赞同：3
> 
> 时间：2012-07-12T12:04:22.433
> 
> 标签：caching, azure

Azure 缓存预览中的单个项目（对象）大小是否有限制？我知道 Azure 共享缓存有这个限制（8MB 序列化），但我找不到新缓存的那种信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T10:30:36.167

对象大小没有变化。它相同 - 8MB 序列化。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T06:26:31.360

默认情况下，缓存实现使用“标准”.Net 二进制序列化。这是非常有效的，但我使用 Protobuf 序列化获得了很好的结果：http: [//nuget.org/packages/protobuf-net/2.0.0.580](http://nuget.org/packages/protobuf-net/2.0.0.580) 编码/解码性能非常出色，它大大减少了序列化对象的大小： [http://code .google.com/p/protobuf-net/wiki/Performance](http://code.google.com/p/protobuf-net/wiki/Performance) 所以尝试一下，以防您达到 8MB 的限制。

# r - 为 r 中的列中的每个级别返回 n 行

> ID：11451438
> 
> 赞同：0
> 
> 时间：2012-07-12T12:04:28.157
> 
> 标签：r, dataframe

我有数据框

```
df1 = data.frame(Site=c(rep("A",5),rep("B",7)),Species=sample(1:100, size=12)) 
```

并希望过滤数据框，以便只返回每个站点的前 3 行。IE。返回数据框

```
df2=data.frame(Site=c(rep("A",3),rep("B",3)),Species=c(3,84,45,38,39,22)) 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:16:39.027

也许是这样的：

```
do.call("rbind", lapply(split(df1, df1$Site), function(x) x[1:3,])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:15:59.980

您可以使用以下方法轻松选择前三行`ddply`：

```
library(plyr)
ddply(df1, "Site", function(df) df[1:min(nrow(df), 3),]) 
```

使用`min(nrow(df), 3)`意味着如果站点只出现两次，我们不会尝试选择三行。

# windows - Windows 重新启动/关闭时未调用 DriverUnload

> ID：11451443
> 
> 赞同：3
> 
> 时间：2012-07-12T12:04:50.940
> 
> 标签：windows, driver, windows-xp-embedded, windows-embedded

我正在用 WinDbg 调试驱动程序。在`DriverUnload`函数中，调用了`KdBreakPoint()`.

当我从设备管理器禁用设备时，WinDbg 会进入该`DriverUnload`功能。

但是当我关闭或重新启动 Windows（通过开始 > 关闭）时，调试器不会中断。那么问题来了：为什么windows`DriverUnload`在重启或关机时不调用该函数呢？

（BTW：我已经在PNP调度函数中加了断点来catch/// `IRP_MN_QUERY_REMOVE_DEVICE`，`IRP_MN_REMOVE_DEVICE`结果是一样的`IRP_MN_QUERY_STOP_DEVICE`）`IRP_MN_STOP_DEVICE`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T13:01:31.353

啊，解决方案很“简单”。它根本没有被调用。不过，我不得不查一下。

**Windows 2000 设备驱动程序手册：程序员指南**指出：

> 系统关闭时不调用驱动程序的卸载例程。

另请参阅[此线程](http://www.osronline.com/showthread.cfm?link=160066)。

如果您有 WDM 驱动程序，请使用`DispatchShutdown`( `IRP_MJ_SHUTDOWN`)。

另请查看有关“关闭调度例程 [WDK 内核]”和“关闭电源管理 [WDK 内核]”的 WDK (7600) 文档。

# php - 使用 GoogleAPI 的 OAuth 会给出“invalid_grant”

> ID：11451444
> 
> 赞同：3
> 
> 时间：2012-07-12T12:04:54.900
> 
> 标签：php, oauth-2.0

我正在 PHP 中创建一个使用 Google Analytics 报告 API 的内部应用程序。该应用程序将始终使用相同的 Google 帐户连接到 Analytics，因此我只想在我的数据库中保留访问令牌和刷新令牌。

我使用以下[Google 教程](http://code.google.com/p/google-api-php-client/)来设置 OAuth。我采取了以下步骤：

**引导代码（每一步）**

```
$client = new apiClient();
$client->setApplicationName("Stat-robot");
$client->setApprovalPrompt("force");            
$client->setAccessType('offline');
$client->setClientId("CLIENT_ID");
$client->setClientSecret("CLIENT_SECRET");
$client->setDeveloperKey("DEV_KEY");
$client->setRedirectUri("http://localhost/statistics/api");
$client->setScopes("https://www.googleapis.com/auth/analytics.readonly"); 
```

**步骤1**

```
Redirect to the URL retrieved from $client->createAuthUrl()) 
```

**第2步**

```
//Get a redirect from Google with a GET-variable 'code'
$client->authenticate();
$accessToken = $client->getAccessToken
//This gives me a JSON-format access-token 
```

**第 3 步**

```
//Set the access token retrieved in previous request
$client->setAccessToken($accessToken);
//set the refresh token from the JSON response
$client->refreshToken($refreshToken); 
```

现在，最后一部分 ( `refreshToken`) 给了我一个错误：**invalid_grant**。我在 SO 和其他互联网上阅读过，我应该将我的访问类型设置为，`offline`并将我的批准提示设置为`force`. 但我想我有（看上面）。

那么出了什么问题呢？

**编辑：**我正在阅读 Google API 本身的源代码。OAuth 类中的`sign()`方法指定以下内容：

```
if ($expired) {
    if (! array_key_exists('refresh_token', $this->accessToken)) {
        throw new apiAuthException("The OAuth 2.0 access token has expired, "
            . "and a refresh token is not available. Refresh tokens are not "
            . "returned for responses that were auto-approved.");
      }
      $this->refreshToken($this->accessToken['refresh_token']);
    }
} 
```

所以真的没必要打电话`$client->refreshToken()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-29T06:26:34.880

我通过更改范围解决了 invalid_grant 错误...

googleapi.authorize({ client_id : '你的客户 ID', client_secret : '你的客户秘密', redirect_uri : ' ', scope : ' [https://www.googleapis.com/auth/userinfo.profile](https://www.googleapis.com/auth/userinfo.profile) [https://www. googleapis.com/auth/userinfo.email](https://www.googleapis.com/auth/userinfo.email) ' }).done(function(data) {

```
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T14:14:41.890

为了解决收到的错误**“invalid_grant”**，谷歌建议更新你的服务器时钟，检查你是否达到了最大的 api 调用。

# sass - 使用 SCSS 从另一个文件中减去一个文件

> ID：11451447
> 
> 赞同：0
> 
> 时间：2012-07-12T12:05:02.340
> 
> 标签：sass

我有一个`common.scss`跨多个项目共享的。该文件有几行应该为新项目删除。是否可以使用将从中减去的 CSS 选项创建文件`common.scss`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:11:33.600

您可以创建一个布尔变量并将代码行包装在 if 语句中。例如：

```
// common.scss

$include_extra_css: true;

// global css here

@if $include_extra_css {

   // special css here

} 
```

然后，为每个项目相应地更改 $include_extra_css 的值。

但是：如果 common.scss 是您导入另一个主要 Sass 文件的部分 (_common.scss) 会更好。这样，您可以在变量上使用 !default 标志，然后在导入它的任何文件中更改其值，而不必为每个项目修改其 common.scss 中的值。（请注意，将直接编译的 Sass 文件导入另一个直接编译的 Sass 文件是不好的做法）。像这样：

```
// common.scss

$include_extra_css: true !default;

// global css here

@if $include_extra_css {

   // special css here

}

// otherfile.scss

$include_extra_css: false;

@import "_common.scss"; 
```

这是关于 !default 的 Sass 文档：http: [//sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#variable_defaults_](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#variable_defaults_)

# javascript - require.js 优化器 a pp.build.js 文档需要

> ID：11451453
> 
> 赞同：3
> 
> 时间：2012-07-12T12:05:25.443
> 
> 标签：javascript, documentation, requirejs, r.js

RequireJS 的优化脚本由 app.build.js 文件配置（这只是一个约定）该文件定义了项目的构建方式。

此文件的基本用法如下所述：[http ://requirejs.org/docs/optimization.html#wholeproject](http://requirejs.org/docs/optimization.html#wholeproject)

但我找不到任何关于可用选项的文档。我只能找到一些例子，让我推断出我目前正在使用的一些选项。

除了我刚刚链接的页面之外，还有其他文档吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T07:11:13.340

它列在[http://requirejs.org/docs/optimization.html#options](http://requirejs.org/docs/optimization.html#options)的“所有配置选项”下。

文档`example.build.js`位于[https://github.com/jrburke/r.js/blob/master/build/example.build.js](https://github.com/jrburke/r.js/blob/master/build/example.build.js)

# html - HTML5 语义标记

> ID：11451455
> 
> 赞同：1
> 
> 时间：2012-07-12T12:05:36.357
> 
> 标签：html, semantic-markup

我需要从下图所示的布局中编写 HTML5 语义标记。

到目前为止，我的 HTML 代码如下。我不确定我所拥有的是否是语义的。有什么建议吗？

```
<body>
    <header>
        <h1>slogen+logo</h1>
    </header>
    <div id="login_or_register"></div>
    <nav><!--main menu-->
        <ul>
            <li>home</li>
            <li>about us</li>
            <li>deals</li>
        </ul>
    </nav>

    <select id=sort>
        <option>new</option>
        <option>price</option>
        <option>discount</option>
    </select>

    <select id=main_sort_by>
        <option>usa</option>
        <option>england</option>
        <option>japan</option>
    </select>

    <select id=main_sort_by>
        <option>category1</option>
        <option>category2</option>
        <option>category3</option>
    </select>
    <section>
        <article>
            <p>our price</p>
            <p>price</p>
            <p>details</p>
            <header>
                <h1>deal title</h1>
                <h2>deal description</h2>
                <img src="" id="deal_image"/>
            </header>
            <footer>
                <p>items left</p>
                <p>end of the deal</p>
            </footer>
        </article>

        <article>
            <p>our price</p>
            <p>price</p>
            <p>details</p>
            <header>
                <h1>deal title</h1>
                <h2>deal description</h2>
                <img src="" id="deal_image"/>
            </header>
            <footer>
                <p>items left</p>
                <p>end of the deal</p>
            </footer>
        </article>

    </section>

    <aside>
        <div id="newsletter"></div>
        <div id="rss"></div>
    </aside>

    <footer></footer>
</body> 
```

![我正在尝试标记的布局](../Images/c871695c37933a77ab8135e7f42a3037.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T09:00:22.717

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:09:42.513

对我来说看起来不错。

不过也可以装`<select>`在容器里。

# linq-to-sql - Linq to Sql 如何获取表数据

> ID：11451457
> 
> 赞同：0
> 
> 时间：2012-07-12T12:05:43.177
> 
> 标签：linq-to-sql

Heyah 我是 Linq to Sql 的新手，如何获取表值是可能的？例如，我在“Aquarium”表中有一个表名“Aquarium”我有以下“FishType”和“FishColor”然后FishColor包含“Blue”“Red”然后我有两个文本框

TextBox1 用于“FishType” TextBox2 用于“FishColor”

如果我在 TextBox2 中输入 Blue，我希望所有蓝色的鱼都会出现。

如果有人向我展示代码大声笑我真的很新，这将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:12:52.057

首先阅读如何获取 dbml 类的本教程

[http://www.progtalk.com/viewarticle.aspx?articleid=68](http://www.progtalk.com/viewarticle.aspx?articleid=68)

然后按照本教程的源代码视频

[http://www.sexyselect.net/blog/post/2011/06/15/part1-beginners-guid-to-linq-to-sql](http://www.sexyselect.net/blog/post/2011/06/15/part1-beginners-guid-to-linq-to-sql)

# mysql - Mysql Insert into with select from myisam to innodb

> ID：11451459
> 
> 赞同：1
> 
> 时间：2012-07-12T12:05:55.500
> 
> 标签：mysql, insert, innodb, calculated-columns, myisam

我有一个表，由多个工作应用程序访问，这些应用程序获取一批记录，在它们上计算一些东西并将计算结果更新回这个表。该表目前是基于 MyISAM 的，但由于我们对计算算法进行了一些更改并导致了巨大的加速，我们已经看到表上的锁负载，这是预期的，因为它是一个 MyISAM 表。（该表中有大约**650-700 000**条记录）。

处理完所有记录后，会根据它生成报告并截断表格。一旦表被截断，一个进程会重新初始化它并重新开始循环。

我正在考虑将 MyISAM 表切换到 InnoDB 以防止锁定，但是`INSERT INTO .. SELECT .. FROM`当我决定停止时，使用语句初始化表的进程（过去需要 3-4 分钟）运行了 35-40 分钟. 为什么是这样？有没有办法加快速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:39:02.103

MyISAM 按照插入的顺序存储记录。另一方面，InnoDB 的主键是聚集索引，因此记录的物理存储顺序与主键相同。因此，请确保您按主键顺序插入。您可以将 ORDER BY 子句添加到 INSERT INTO ... SELECT。

此外，为避免拆分页面和重建二级索引，请在插入初始行后添加二级索引。因此，删除索引，然后重新添加它们。

此外，为避免行锁定（和自动增量锁定）开销，请使用 LOCK TABLES 显式锁定表。

最后，增加[innodb_buffer_pool_size](http://dev.mysql.com/doc/refman/5.0/en/innodb-parameters.html#sysvar_innodb_buffer_pool_size)，否则你的索引会建立得很慢。默认只有 8MB。

# jsf - 添加对话框时行选择发生变化

> ID：11451461
> 
> 赞同：0
> 
> 时间：2012-07-12T12:06:00.783
> 
> 标签：jsf, primefaces

当我单击任何一行并单击删除链接时，会出现确认对话框，但是一旦单击该对话框，行选择就会更改。选定的行不会被删除，但其他行会被删除。请帮助修复它。

```
<p:column headerText="Delete" width="50" style="text-align:center">
            <p:commandLink id="showDialogButton"
                update=":studyPlanEditForm:display" onclick="cdDialog.show()"
                value="delete">
            </p:commandLink>
            <p:dialog widgetVar="cdDialog" appendToBody="true"
                header="Are you sure to delete this substudyplan?">
                <p:panel>
                <p:commandButton value="Yes" process=":studyPlanEditForm:display" 
                    action="#{editBean.deleteSubStudyPlan(selectedRow)}"
                    onclick="cdDialog.hide();"
                    update=":studyPlanEditForm"/>
                <p:commandButton value="No" onclick="cdDialog.hide();"
                     type="button"/>
                </p:panel>
            </p:dialog>
        </p:column> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:06:31.553

对话框必须在表格之外。此外，在删除按钮中，您正在更新组件“:studyPlanEditForm:display”。我在片段中没有看到该组件。对话框内的面板应该有 id="display"，因为对话框需要更新。

[您可以在 primefaces展示](http://www.primefaces.org/showcase/ui/datatableRowSelectionByColumn.jsf)中看到一个类似使用 casi 的工作示例。您只需替换显示确认消息内容的对话框，并添加一个删除该行的按钮。托管 bean 已经具有对选定行的引用。

这就是删除按钮的样子

```
<p:column headerText="Delete" width="50" style="text-align:center">
    <p:commandButton id="showDialogButton"
             update=":studyPlanEditForm:display" onclick="cdDialog.show()"
             value="delete">
        <f:setPropertyActionListener value="#{selectedRow}" target="#{bean.selectedRow}" />
      </p:commandButton>
</p:column> 
```

这是对话框（必须在表外）：

```
<p:dialog widgetVar="cdDialog" appendToBody="true"
          header="Are you sure to delete this substudyplan?">
    <p:panel id="display">
        <p:commandButton value="Yes" process="@this" 
                action="#{editBean.deleteSubStudyPlan}"
                onclick="cdDialog.hide();"
                update=":studyPlanEditForm"/>
        <p:commandButton value="No" onclick="cdDialog.hide();"
                 type="button"/>
    </p:panel>
</p:dialog> 
```

因此，托管 bean 有一个名为的属性`selectedRow`，并且在调用方法 deleteSubStudyPlan 时，该属性包含属于表中所选行的实体。

# javascript - 从网页调用 Adob e Reader PDF 打印对话框

> ID：11451462
> 
> 赞同：2
> 
> 时间：2012-07-12T12:06:05.997
> 
> 标签：javascript, jquery, pdf, acrobat, mpdf

请帮忙，我一直在寻找几个小时，但我找不到明确的答案......在我的网络应用程序上，会弹出一个 jQuery 对话框，其中包含在 iframe 中加载的 PDF。如果可能的话，我需要用户能够单击“打印”按钮（在 jQuery UI 模态对话框上），然后打开 Adob​​e Reader 打印对话框供他们打印 PDF。我知道他们可以将鼠标悬停在 PDF 上以显示工具栏，但这对于计算机文盲来说并不总是理想的。尝试了诸如 window.print() 之类的常用方法，并且还查看了 PDF“打开参数”，但均无济于事。

[http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf](http://partners.adobe.com/public/developer/en/acrobat/PDFOpenParameters.pdf)

我也尝试过嵌入 PDF 并使用 window.print() 和打印预览，但 PDF 没有显示在预览屏幕上。

# c# - 当没有值传入时，是否有一种 Rx 方法可以定期重复先前的值？

> ID：11451465
> 
> 赞同：13
> 
> 时间：2012-07-12T12:06:20.337
> 
> 标签：c#, system.reactive

我遇到的一个用例，我怀疑我不能是唯一的一个，是这样的方法：

```
IObservable<T> Observable.RepeatLastValueDuringSilence(this IObservable<T> inner, TimeSpan maxQuietPeriod); 
```

这将从内部 observable 返回所有未来的项目，而且，如果内部 observable 在一段时间内（maxQuietPeriod）没有调用 OnNext，它只会重复最后一个值（当然直到内部调用 OnCompleted 或 OnError） .

理由是服务定期 ping 出定期状态更新。例如：

```
var myStatus = Observable.FromEvent(
    h=>this.StatusUpdate+=h,
    h=>this.StatusUpdate-=h);

var messageBusStatusPinger = myStatus
    .RepeatLastValueDuringSilence(TimeSpan.FromSeconds(1))
    .Subscribe(update => _messageBus.Send(update)); 
```

这样的事情存在吗？还是我高估了它的用处？

谢谢，亚历克斯

PS：对于任何不正确的术语/语法，我深表歉意，因为我只是第一次探索 Rx。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T05:18:13.353

与 Matthew 的解决方案类似，但这里的计时器在源中收到每个元素后开始，我认为这更正确（但差异不太可能重要）：

```
public static IObservable<T> RepeatLastValueDuringSilence<T>(this IObservable<T> inner, TimeSpan maxQuietPeriod)
{    
    return inner.Select(x => 
        Observable.Interval(maxQuietPeriod)
                  .Select(_ => x)
                  .StartWith(x)
    ).Switch();
} 
```

和测试：

```
var source = Observable.Interval(TimeSpan.FromMilliseconds(100)).Take(5).Select(_ => "1")
                       .Concat(Observable.Interval(TimeSpan.FromSeconds(1)).Take(5).Select(_ => "2"))
                       .Concat(Observable.Interval(TimeSpan.FromMilliseconds(100)).Take(5).Select(_ => "3"));

source.RepeatLastValueDuringSilence(TimeSpan.FromMilliseconds(200)).Subscribe(Console.WriteLine); 
```

您应该看到`1`打印了 10 次（来自源的 5 次，在静默期间重复 5 次），然后`2`当您从源中获得一个时，从每个之间的静默中获得更多的 4 次，然后是无限的`3`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-13T09:41:49.113

这个相当简单的查询可以完成这项工作：

```
var query =
    source
        .Select(s =>
            Observable
                .Interval(TimeSpan.FromSeconds(1.0))
                .StartWith(s)
                .Select(x => s))
        .Switch(); 
```

永远不要低估`.Switch()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T00:55:48.513

我认为这可以满足您的要求，如果您的 observable 不热，则需`Publish`要这样做`Refcount`：

```
public static IObservable<T> RepeatLastValueDuringSilence<T>(this IObservable<T> inner, TimeSpan maxQuietPeriod)
{
    var throttled = inner.Throttle(maxQuietPeriod);
    var repeating = throttled.SelectMany(i => 
        Observable
            .Interval(maxQuietPeriod)
            .Select(_ => i)
            .TakeUntil(inner));
    return Observable.Merge(inner, throttled, repeating);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-12T17:32:58.450

Rx 库中没有方法，但我也需要这样的方法。在我的用例中，即使源没有输出任何值，我也需要输出值。如果您不想在第一个源值出现之前输出任何值，您可以在 subscribe 调用之前删除`defaultValue`参数和调用。`createTimer()`

需要调度程序来运行计时器。一个明显的重载是不使用调度程序并选择默认调度程序（我使用了 ThreadPool 调度程序）。

```
Imports System.Reactive
Imports System.Reactive.Concurrency
Imports System.Reactive.Disposables
Imports System.Reactive.Linq

<Extension()>
Public Function AtLeastEvery(Of T)(source As IObservable(Of T), 
                                   timeout As TimeSpan, 
                                   defaultValue As T, 
                                   scheduler As IScheduler
                                  ) As IObservable(Of T)
    If source Is Nothing Then Throw New ArgumentNullException("source")
    If scheduler Is Nothing Then Throw New ArgumentNullException("scheduler")
    Return Observable.Create(
        Function(observer As IObserver(Of T))
            Dim id As ULong
            Dim gate As New Object()
            Dim timer As New SerialDisposable()
            Dim lastValue As T = defaultValue

            Dim createTimer As Action =
                Sub()
                    Dim startId As ULong = id
                    timer.Disposable = scheduler.Schedule(timeout,
                                           Sub(self As Action(Of TimeSpan))
                                               Dim noChange As Boolean
                                               SyncLock gate
                                                   noChange = (id = startId)
                                                   If noChange Then
                                                       observer.OnNext(lastValue)
                                                   End If
                                               End SyncLock
                                               'only restart if no change, otherwise
                                               'the change restarted the timeout
                                               If noChange Then self(timeout)
                                           End Sub)
                End Sub
            'start the first timeout
            createTimer()
            'subscribe to the source observable
            Dim subscription = source.Subscribe(
                Sub(v)
                    SyncLock gate
                        id += 1UL
                        lastValue = v
                    End SyncLock
                    observer.OnNext(v)
                    createTimer() 'reset the timeout
                End Sub,
                Sub(ex)
                    SyncLock gate
                        id += 1UL
                    End SyncLock
                    observer.OnError(ex)
                    'do not reset the timeout, because the sequence has ended
                End Sub,
                Sub()
                    SyncLock gate
                        id += 1UL
                    End SyncLock
                    observer.OnCompleted()
                    'do not reset the timeout, because the sequence has ended
                End Sub)

            Return New CompositeDisposable(timer, subscription)
        End Function)
End Function 
```

# c# - 通过 WPF 中的接口引发键盘事件

> ID：11451472
> 
> 赞同：0
> 
> 时间：2012-07-12T12:06:33.727
> 
> 标签：c#, wpf, routed-events

我正在尝试在 WPF 中构建一个应用程序，我想在其中处理来自连接到单台计算机的多个键盘的输入（KeyPress 事件）。所以，我有一个类，我覆盖**WndProc()**方法并能够接收来自不同键盘设备的输入。在执行此操作时，我使用 MainWindow 句柄注册此类，因此窗口可以接收 CLR 键盘事件。但这不是问题。

问题是现在我正在开发`UserControl`WPF，它也可以响应这些多键盘事件。这些`UserControls`将在同一个窗口中实例化，但我正在考虑发送事件（尤其是`RoutedEvents`通过接口发送事件（尤其是 as ）。因此，我的自定义 UserControl 类只是实现了接口，我很高兴。

你们知道如何做到这一点，我对 WPF 真的很陌生，所以我遇到了一些困难。

提前致谢 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T08:12:43.890

所以，我想出了如何做到这一点。我有一个名为的类`BIFUserControl`，它实现了我创建的接口，用于处理来自连接到同一台计算机的多个键盘的事件。该接口称为`IMultiKeyboardEvents`. 我还有一个只读集合，它将每个键盘设备的当前状态存储为`BIFKeyboardDevice`类的实例。

所以，基本上我知道每个键盘设备的输入焦点是什么，它在`BIFKeyboardDevice`类中表示为一个属性。因此，当从键盘管理器类引发 CLR 事件时，`BIFKeyboardManager`我实际上可以在具有特定控件输入焦点的确切类中调用接口方法实现。

以下是`IMultiKeyboardEvents`自定义用户控件类实现的接口代码：

```
public interface IMultiKeyboardEvents  
{
    event MultiKeyEventHandler MultiKeyDown;
    event MultiKeyEventHandler MultiKeyUp;

    void OnMultiKeyDown(MultiKeyEventArgs);
    void OnMultiKeyDown(MultiKeyEventArgs);
} 
```

在覆盖**WndProc()**方法的键盘管理器类中，我有一个处理输入事件的方法，如下所示：

```
void ProcessInput(Message message)
{
    // Code sample which raises just the key down event
    switch (rawInput.keyboard.Message)
    {
        case (uint) BIFWin32.WindowMessage.WM_KEYDOWN:
        {
            if (BIFDeviceCollections.MouseCollection[ID].MouseFocusElement is IMultiKeyboardEvents)
            {
                IMultiKeyboardEvents widget = 
                (IMultiKeyboardEvent)BIFDeviceCollections.MouseCollection[ID].MouseFocusedElement;
                widget.OnMultiKeyDown(eventArgs);
            }
            break;
        }
        case (uint) BIFWin32.WindowMessage.WM_KEYUP:
        {
            if (BIFDeviceCollections.MouseCollection[ID].MouseFocusElement is IMultiKeyboardEvents)
            {
                IMultiKeyboardEvents widget = 
                (IMultiKeyboardEvent)BIFDeviceCollections.MouseCollection[ID].MouseFocusedElement;
                widget.OnMultiKeyUp(eventArgs);
            }
            break;
        }
    }
} 
```

**这只是在我的UserControl**类中调用 OnMultiKeyDown 方法的实现，我不必在用户控件类中使用键盘管理器实例并连接事件来监听它们。另外，因为我已经收集了所有设备对象（鼠标和键盘），并且它们维护一个字段，说明每个设备的当前焦点元素是什么，并且我已经配对了每个鼠标和键盘设备，所以我可以直接使用它引发事件的信息。

# c# - 禁用 RibbonSplitButton 上的顶部按钮

> ID：11451474
> 
> 赞同：0
> 
> 时间：2012-07-12T12:06:45.783
> 
> 标签：c#, .net, wpf, .net-4.0

是否可以仅禁用 RibbonSplitButton 中的顶部按钮？
如果我设置 IsEnabled=True 整个按钮（顶部按钮加下拉）被禁用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:13:04.367

我找到了这样做的方法。
如果顶部按钮绑定到命令，则该命令的 canExecute 必须设置为 false。

# javascript - 国家名称的 Javascript 正则表达式验证

> ID：11451476
> 
> 赞同：0
> 
> 时间：2012-07-12T12:06:58.543
> 
> 标签：javascript, jquery, regex

有人对国家名称使用 java 脚本验证吗？或者是否有任何 jquery 方法可以做到这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T14:12:20.680

您可能对允许您搜索地址（或简单的国家/地区）以进行检查的现有网络服务（例如[GeoNames ）感兴趣。](http://www.geonames.org/export/geonames-search.html)

# tfs - TFS 2012：无法将 80 端口设置为 Web 访问

> ID：11451477
> 
> 赞同：3
> 
> 时间：2012-07-12T12:07:01.710
> 
> 标签：tfs, tfs-web-access

当我在 IIS 上为 TFS Web 访问应用程序添加新绑定到 80 端口时： ![在此处输入图像描述](../Images/8ab5b49be2e5ea6fea511336a02f7dcc.png)

我的构建服务不起作用，但是：

![在此处输入图像描述](../Images/447b3c110506bc355242291d861c36b1.png)

如何修复我的构建服务并将绑定保存到 80 端口？还是有另一种方法可以在 80 端口上访问 TFS WebAccess？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T03:26:28.027

Martin Hinshelwood 对此有一篇博客文章，标题为：[TFS 2012 – Issue: Stuck builds in Team Foundation Build with no build number](http://blog.hinshelwood.com/tfs-2012-issue-stuck-builds-in-team-foundation-build-with-no-build-number/)

长话短说，您的构建配置需要允许多个主机标头

# powershell - 以管理员身份运行部分 vbscript

> ID：11451480
> 
> 赞同：0
> 
> 时间：2012-07-12T12:07:03.020
> 
> 标签：powershell, vbscript

嘿，我想运行这部分：

```
Dim objShell
Set objShell = WScript.CreateObject ("WScript.shell")
objShell.run "powershell -command '& {Start-Service AxInstSV}'" 
```

作为管理员的 vbscript。我该如何管理？我的电脑在域中。是否可以从 vbs 以管理员身份运行 powershell + 命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T20:46:50.633

为什么使用 VBScript 调用 PowerShell？使困惑。为什么不在 VBScript 中启动服务，或者只使用 Powershell 自己？

至于以“以管理员身份运行”以编程方式运行某些东西，为了使用“不受限制的令牌”，除了通过组策略配置自动管理批准之外，我还没有找到解决方案。

# javascript - 使用 CSS 禁用 onclick :: 可能吗？

> ID：11451483
> 
> 赞同：30
> 
> 时间：2012-07-12T12:07:07.420
> 
> 标签：javascript, html, css

我想`onclick`用 CSS 禁用事件。可能的？

假设我有

```
<div id="btnCopy" class="button" onclick="btnCopy(this);"><img src="copy.png"></div> 
```

并通过添加类*“禁用”*

```
document.getElementById("btnCopy").className += " disabled"; 
```

我想关闭此元素的 onclick 事件，因此`onclick="btnCopy(this);"`不会处于活动状态。

并通过删除*“禁用”*类

```
document.getElementById("btnCopy").className = 
  document.getElementById("btnCopy").className.replace(/(?:^|\s)disabled(?!\S)/, ''); 
```

它将恢复正常，因此`onclick`事件将处于活动状态。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2015-10-20T14:16:24.883

你可以这样做。

```
pointer-events: none;
cursor: default; 
```

更多[在这里](http://techniblogic.com/how-to-disable-anchor-tag-href-links-by-html-css-javascript/)

（请注意，这是不可访问的；它不会禁用对元素的制表符并按“Enter”；在这种情况下，事件仍将触发。）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-12T12:39:50.773

在某些浏览器中，您可以设置`pointer-events: none`，但这会禁用所有鼠标事件，而不仅仅是单击。参见：[https ://developer.mozilla.org/en/CSS/pointer-events/](https://developer.mozilla.org/en/CSS/pointer-events/)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-12T12:11:06.170

向您的函数添加一些 Javascript 以`btnCopy`检查参数元素是否具有`disabled`类。

使用 CSS 来改变 JavaScript 的行为是不可能的。CSS 用于样式化 HTML 元素，JavaScript 用于处理事件和站点的行为。**CSS 和 JavaScript 是两个非常不同的东西。**CSS 唯一可以做的就是防止用户点击输入（例如按钮）。使用 CSS 解决方案，您不会禁用 onclick 事件中的代码。您只是禁用用户触发 onclick 事件的能力。

但是，有很多方法可以更改页面上的内容（使用更多的 JavaScript 或为您的浏览器添加一些插件），尽管您使用了 CSS 伪元素，但仍然可以点击按钮。这就是为什么**不推荐使用 CSS 的原因。**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-12T12:10:44.383

这很 hackish，但我建议使用伪元素：

在具有禁用类的按钮上，您可以创建一个覆盖按钮的伪元素，使其不可点击。

但是使用 javascript 会更有意义，因为您已经在使用它来添加和删除类......

**编辑：**根本不推荐，但你去：

```
#btnCopy {position:relative;z-index:1;}

.disabled:before {
  content:" ";
  display:block;
  position:absolute;
  top:0;left:0;right:0;bottom:0;
  z-index:10;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-05-09T05:32:39.413

这就是 Bootstrap 的做法。

```
.btn.disabled, .btn[disabled] {
    cursor: not-allowed;
    opacity: 0.65;
    filter: alpha(opacity=65);
    box-shadow: none;
} 
```

您可以保留`cursor: not-allowed;`，如果您不需要重置样式，则将其删除`opacity: 0.65; filter: alpha(opacity=65); box-shadow: none;`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-12T12:09:14.800

如果您使用 javascript 添加和删除类，那么为什么不使用它来启用禁用点击事件呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-12T12:13:26.827

如果您想添加或删除“禁用”类，您不妨在事件处理程序中检查该类，而不是什么都不做，它的元素已禁用类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-12T13:18:59.293

`onclick`您可以通过添加这行javascript 来使用 javascript 来禁用按钮事件。

```
var btnCopy = document.getElementById("btnCopy");
btnCopy.className += " disabled";
btnCopy.onclick = null; 
```

最好的选择可能是使用 jQuery 并检查 btnCopy 是否具有“禁用”类。

```
if(!$('btnCopy').hasClass('disabled')){
   //Add code to copy text here
} 
```

祝你好运！

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-07-12T12:18:40.367

```
<div id="btnCopy" class="button" 
    onClick="if(this.className.indexOf('disabled') == -1){btnCopy(this);}">
    <img src="copy.png">
</div> 
```

它必须用Javascript来完成。一个`if(indexOf('disabled') == -1)`应该做的伎俩。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2012-07-12T12:28:55.293

纯粹通过 CSS 实现的一种方法是在悬停时显示不可点击的不可见叠加层。

演示：http: [//jsfiddle.net/FNVmh/1/](http://jsfiddle.net/FNVmh/1/)

# ruby-on-rails - 链接以在 Ruby On Rails 中显示

> ID：11451485
> 
> 赞同：2
> 
> 时间：2012-07-12T12:07:25.380
> 
> 标签：ruby-on-rails, ruby

好的，所以我有这个控制器（courses_controller.rb），def 显示如下：

```
def show
  @course = Course.find(params[:id])
end 
```

我想像这样链接到它：

```
<%= link_to "Back", :controller => "courses", :action => "show", course => @lesson.course_id %> 
```

顺便说一下，课程.rb 确实有一个 course_id。这是给我问题的最后一段（课程=> @lesson.course_id）。声明的后半部分有效，它是我无法正确理解的“课程”部分。我也试过@course。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:48:50.380

您确定在模型中设置了课程-课程关系吗？在`RAILS_APP/app/models/lesson.rb`中，你需要

```
Class Lesson < ActiveRecord::Base
  belongs_to :course
end 
```

在 中`RAILS_APP/app/models/course.rb`，你应该有

```
Class Course < ActiveRecord::Base
  has_many :lessons
end 
```

然后，在你看来，你可以说，

```
<%= link_to "Back", @lessson.course %> 
```

这应该就是全部了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:12:16.420

简单的！

```
<%= link_to "Back", course_path(@lesson) %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T02:32:56.773

试试这个

```
<%= link_to "Back", :controller => "courses", :action => "show", :id => @lesson.course_id %> 
```

而不是“课程”使用“id”，它会正常工作。

# html - 使用矢量图标图像中的图标

> ID：11451492
> 
> 赞同：1
> 
> 时间：2012-07-12T12:07:35.097
> 
> 标签：html, css, vector, icons

它们是互联网上可用的大量图标图像。我刚刚下载[了这个](http://fc07.deviantart.net/fs71/f/2012/047/d/0/350_free_vector_web_icons_by_themecavern-d4pwo03.jpg)，问题是我不知道如何使用它，我正在寻找一些关于这个主题的教程，但找不到一些有用的东西。这里有人知道如何使用这些图标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:17:32.280

如果您正在谈论使用`sprite`图像作为图标（尽管您显示的图像不是如何制作精灵的好例子......;）

然后，看看这里：http: [//jsfiddle.net/sWZrh/](http://jsfiddle.net/sWZrh/)

基本上，您将`background-image`所有图标设置为一个，然后将其重新定位`background-position`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T21:11:03.373

通常，图标的作者会为您提供说明。如何使用图标取决于它们的格式。如今，提供图标的最常见方式似乎是网络字体。一个很好的例子是[符号集](http://symbolset.com/)。

如果您只有矢量，例如 .ai 或 .eps 格式，您可以使用矢量编辑器（如 Adob​​e Illustrator）将其导出为 SVG。遗憾的是，对 SVG 的支持不如对 webfonts 的支持。更好的选择可能是自己制作 webfont。有几个可用的选项，我在应用程序[Glyphs](http://glyphsapp.com/)上取得了成功，但它可能很耗时。

如果你最终得到一个 webfont，你首先需要包含字体，并设置目标元素来使用它。然后通过引用正确的字符插入一个图标。如果结果是 SVG 图像，您可以使用*img*标签插入它。

# java - 无法在 JasperReports 中使用子报表

> ID：11451493
> 
> 赞同：1
> 
> 时间：2012-07-12T12:07:38.177
> 
> 标签：java, jasper-reports, ireport, subreport

我用于创建 Jasper 报告的 java 代码是

```
JasperReport report = JasperCompileManager.compileReport(jrxml);
JasperPrint print = JasperFillManager.fillReport(report,parameters, conn);
JasperExportManager.exportReportToPdfFile(print,filename); 
```

当我在不使用子报告的情况下创建报告时，它运行成功。当我插入任何子报告时，我的代码失败并且异常说

> 原因：空
> 
> MESSAGEnull
> 
> 本地消息null

请告诉我是否需要更改我的 Java 代码？

我在某处读过这一行以使用子报表。

```
JasperReport subreport = (JasperReport)JRLoader.loadObjectFromLocation("ProductReport.jasper"); 
```

我是否也需要使用此代码？我是一名 PHP 开发人员。对Java了解不多。我使用 Jasper 报告是因为我们需要创建大 PDF。这个工具对我们帮助很大。但是现在我遇到了一个需要使用子报表的新报表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T19:21:46.657

我使用的是 IREPORT 4.1.3，我在 java 代码中的 jar 文件是 Jasperreports-3.7.6.jar 我读了很多次，两者的版本应该是相同的。于是我试了一下，下载了jasperreports-4.1.3.jar并使用了。这行得通。现在子报表没有问题了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T21:02:22.077

这对我来说变得很困惑，但我们开始吧。

首先，您应该选择是从**.jrxml**还是**.jasper获取报告**

如果您选择 JRXML，您必须编译它，这是 JRXML 代码：

```
JasperReport report = JasperCompileManager.compileReport(jrxml); 
```

您会注意到您已经在执行此操作，因此如果您想以相同的方式加载子报表，您可以以相同的方式传递子报表的 JRXML 文件并将其放入另一个变量中：

```
JasperReport subReport = JasperCompileManager.compileReport(subReportjrxml); 
```

* * *

当我需要在我的主报告中放置一个子报告时，我只是将 jasper 文件作为参数传递到我的 HashMap 中，如下所示：

```
Map<String, Object> params = new HashMap<String, Object>;

params.put("SUB_REPORT", subReport); 
```

（您在 fillReport 方法中放置了“params”，但您只需要填写 mainReport，因为当您将 subReport 作为参数传递时，它也应该被填写）

在 iReport 编辑器中，在您的主报告中，您创建了一个具有相同名称“SUB_REPORT”的参数，您可以在 reportInspector（或类似的东西）中执行此操作，将类型作为对象。

选择您的 subReportElement 并转到属性，在那里您可以看到一个名为 SubReport Expression 的属性，您可以在其中放置您创建的参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-11T14:22:07.690

我相信 D. Rodrigues 实际上给了你正确的解决方案，过去三天我一直在研究类似的问题，但没有运气，最后在 D. Rodrigues 的建议下解决了。我意识到这是一年前的帖子，我发布此帖子是因为我希望它对将来遇到类似问题的人有所帮助。

我的情况是：我有一个包含多层子报表的 JasperReport，我想在 Netbeans 构建的 Java 应用程序中运行它。最初，我将 getResources() 用于我的主报告，当我运行它时，它在 IDE 中运行良好，但是当我构建它并从 jar 运行时，它给出了“找不到文件异常”，我尝试了替代方法使用“输入流”，并将子报表用作输入组，它总是给出“错误加载输入流”，经过几天的研究，我很沮丧，它与这个一起工作。

所以想法是您需要获取主要报告

```
JasperReport main = (JasperReport)JRLoader.loadObject(this.getClass().getResource("main.jasper")); 
```

和所有子报表作为资源

```
JasperReport sub1 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub1.jasper"));
JasperReport sub2 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub2.jasper"));
JasperReport sub3 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub3.jasper"));
JasperReport sub4 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub4.jasper")); 
```

（上例中有 4 个子报表）

由于您将子报表作为“参数”传递，因此您需要在报表中包含这些参数，并且您需要确保这些参数到达使用它们的层，对于我来说，这些层是 Main Sub1 Sub2 Sub3, Sub4

所以在我的main上，我有参数：sub1，sub2，sub3，sub4，在参数类中将它们全部设置为“Object”，将subrepot表达式设置为“$P{sub1}”，它将在运行时调用subreport“Sub1”，并在子报表参数中添加 $P{sub2}、$P{sub3}、$P{sub3}，因为您在子报表中使用此参数，但在 Java 代码中，您只是主报表的可能值

之后的层等等，我在 Java 中的最终代码是：

```
JasperReport jr = (JasperReport)JRLoader.loadObject(this.getClass().getResource("main.jasper"));
JasperReport sub1 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub1.jasper"));
JasperReport sub2 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub2.jasper"));
JasperReport sub3 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub3.jasper"));
JasperReport sub4 = (JasperReport)JRLoader.loadObject(this.getClass().getResource("sub4.jasper"));
Map para = new HashMap();
para.put("Sub1", sub1);
para.put("Sub2", sub2);
para.put("Sub3", sub3);
para.put("Sub4", sub4);
JasperPrint jp = JasperFillManager.fillReport(jr, para, conn);
JasperViewer.viewReport(jp, false); 
```

它就像魔术一样工作！

如果仍然无法正常工作，请发表评论或发送电子邮件至：smilelrnr@hotmail.com

我很想看看我能做什么！

# xml - 在 Saxon api 中插入查询

> ID：11451494
> 
> 赞同：0
> 
> 时间：2012-07-12T12:07:39.533
> 
> 标签：xml, insert, xquery, saxon, xquery-update

Saxon xqj api是否支持发出`insert`查询？如果否，是否有任何学术文章讨论此问题？应该使用什么替代方案？如果是，是否有任何代码示例可以这样做？

任何答案将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:42:49.383

*XQJ*不是为更新查询而设计的，因此对它们的支持总是依赖于实现的。在三年前的[这个帖子](https://dev.saxonica.com/community/boards/3/topics/1540)中，Saxon 的作者 Michael Kay 写道他不想这样做，所以现在不太可能支持它。

如果您可以使用特定于 Saxon 的[S9API](http://www.saxonica.com/documentation/javadoc/net/sf/saxon/s9api/package-summary.html)（它支持更新），那么您需要非免费的*Saxon-EE*版本，因为其他版本[根本不提供 XQuery Update](http://www.saxonica.com/feature-matrix.html)。

# android - Android 中 Fragments 的有效使用

> ID：11451499
> 
> 赞同：0
> 
> 时间：2012-07-12T12:08:03.487
> 
> 标签：android, android-layout, android-fragments

我想在横向模式下使用单个片段两次，在纵向模式下使用一次。

横向模式的xml：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff" android:orientation="horizontal" >
  <fragment class="com.afghanmag.android.StoreViewFragment"
        android:id="@+id/categories" android:layout_weight="1"
        android:layout_width="0px"
        android:layout_height="match_parent" />

  <fragment class="com.afghanmag.android.StoreViewFragment"
        android:id="@+id/library" android:layout_weight="1"
        android:layout_width="0px"
        android:layout_height="match_parent" />
  </LinearLayout> 
```

如何设计纵向模式视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:29:34.053

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff">

    <fragment class="com.afghanmag.android.StoreViewFragment"
        android:id="@+id/categories"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"/>

</RelativeLayout> 
```

# string - 从 Xtext2 中的规则结果中去除引号

> ID：11451500
> 
> 赞同：0
> 
> 时间：2012-07-12T12:08:07.743
> 
> 标签：string, xtext

我有以下 Xtext2 语法：

```
Bibliography:
  macros += Macro*
;

Macro:
  "@string{" name = ID "=" value = LATEXSTRING "}"
;

terminal LATEXSTRING:
  '"' (!('"'))* '"' 
; 
```

解析字符串时

```
@string{ABBREV = "Some Long Text"} 
```

并将其存储在某个`macro`类型的对象中，`Macro`它具有以下值：

```
macro.name: ABBREV
macro.value: "Some Long Text" 
```

都属于`String`( `EString`) 类型。我希望没有引号的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:21:38.407

您必须为规则 LATEXSTRING 注册一个值转换。根据[文档](http://www.eclipse.org/Xtext/documentation.html#valueconverter)，它应该如下所示：

```
@Inject
private LatexStringConverter latexStringConverter; 

@ValueConverter(rule = "LATEXSTRING")
public IValueConverter<String> converterForLatexString() {
  return latexStringConverter;
} 
```

和

```
public class LatexStringConverter extends AbstractLexerBasedConverter<String> {
  @Override
  protected String toEscapedString(String value) {
    ..      
  }

  public String toValue(String string, INode node) {
    ..
  }
} 
```

# ios - iFrameExtractor 无法使用 XCode 4.3.3 和 iOS 5.1 为 armv7 构建库

> ID：11451503
> 
> 赞同：0
> 
> 时间：2012-07-12T12:08:15.283
> 
> 标签：ios, ffmpeg

我已经从这个链接下载了使用 XCode 4.3.3 for iOS 5.1 构建的代码 - [https://github.com/lajos/iFrameExtractor](https://github.com/lajos/iFrameExtractor) 我成功地能够使用 build_universal 脚本为 FFmpeg 构建库。但它总是为 X86_64 架构构建库。用 lipo -info 命令检查。

还尝试了链接中的构建脚本 - [http://stexgroup.com/blog/ffmpeg-for-iphone-ios-xcode4.3-build-script](http://stexgroup.com/blog/ffmpeg-for-iphone-ios-xcode4.3-build-script)。它还为 X86_64 架构构建库。

我根据这篇文章更改了脚本-[为 iFrameExtractor 编译 ffmpeg 的问题](https://stackoverflow.com/questions/6994151/problem-compiling-ffmpeg-for-iframeextractor)

但没有什么对我有用。

armv7 [iFrameExtractor] 的构建脚本如下

```
./configure \
--disable-bzlib --disable-doc \
--disable-ffmpeg --disable-ffplay \
--disable-ffserver --disable-mmx \
--cc=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc \
--as='gas-preprocessor/gas-preprocessor.pl /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' \
--enable-cross-compile --target-os=darwin \
--arch=arm --cpu=cortex-a8 --enable-pic \
--sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk \
--extra-ldflags="-arch armv7 -    L//Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/usr/lib" \
--extra-cflags="-arch armv7" 
```

考虑到同样的事情对其他人有用，谁能指导我可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T09:22:11.747

使用以下脚本，我可以构建库。这些脚本是 Far Pointer 在此链接中共享的脚本的修改版本 -[为 iFrameExtractor 编译 ffmpeg 的问题](https://stackoverflow.com/questions/6994151/problem-compiling-ffmpeg-for-iframeextractor)

armv6

```
#!/bin/tcsh -f

if (! -d armv6) mkdir armv6
if (! -d lib) mkdir lib

rm armv6/*.a

make clean

./configure \
--disable-bzlib --disable-doc \
--disable-ffmpeg --disable-ffplay \
--disable-ffserver --disable-mmx \
--cc=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc \
--as='gas-preprocessor/gas-preprocessor.pl /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' \
--enable-cross-compile --target-os=darwin \
--arch=arm --cpu=arm1176jzf-s \
--sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk \
--extra-ldflags="-arch armv6 -L//Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/usr/lib/system" \
--extra-cflags="-arch armv6"

make

mv libavcodec/libavcodec.a armv6/
mv libavdevice/libavdevice.a armv6/
mv libavformat/libavformat.a armv6/
mv libavutil/libavutil.a armv6/
mv libswscale/libswscale.a armv6/

rm lib/*.a

cp armv6/*.a lib/ 
```

armv7

```
#!/bin/tcsh -f

if (! -d armv7) mkdir armv7
if (! -d lib) mkdir lib

rm armv7/*.a

make clean

./configure \
--disable-bzlib --disable-doc \
--disable-ffmpeg --disable-ffplay \
--disable-ffserver --disable-mmx \
--cc=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc \
--as='gas-preprocessor/gas-preprocessor.pl /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' \
--enable-cross-compile --target-os=darwin \
--arch=arm --cpu=cortex-a8 --enable-pic \
--sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk \
--extra-ldflags="-arch armv7 -    L//Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/usr/lib/system" \
--extra-cflags="-arch armv7"

make

mv libavcodec/libavcodec.a armv7/
mv libavdevice/libavdevice.a armv7/
mv libavformat/libavformat.a armv7/
mv libavutil/libavutil.a armv7/
mv libswscale/libswscale.a armv7/

rm lib/*.a

cp armv7/*.a lib/ 
```

i386

```
#!/bin/tcsh -f

if (! -d i386) mkdir i386
if (! -d lib) mkdir lib

rm i386/*.a

make clean

./configure \
--disable-bzlib --disable-doc \
--disable-ffmpeg --disable-ffplay \
--disable-ffserver --disable-mmx \
--cc=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc \
--as='gas-preprocessor/gas-preprocessor.pl     /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' \
--sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk \
--extra-ldflags="-arch i386 -L//Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk/usr/lib/system" \
--extra-cflags="-arch i386 -fmessage-length=0 -pipe -Wno-trigraphs -fpascal-strings -O0 -fasm-blocks -Wreturn-type -Wunused-variable -D__IPHONE_OS_VERSION_MIN_REQUIRED=40000 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk -fvisibility=hidden -mmacosx-version-min=10.5 -gdwarf-2"

make

mv libavcodec/libavcodec.a i386/
mv libavdevice/libavdevice.a i386/
mv libavformat/libavformat.a i386/
mv libavutil/libavutil.a i386/
mv libswscale/libswscale.a i386/

rm lib/*.a

cp i386/*.a lib/ 
```

现在的问题是所有脚本都为 armv6 架构构建库。有没有人遇到这样的问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T05:09:03.323

我已经发布了如何在所有版本的 ios 中集成 ffmpeg。只是检查一下

[iphone/ipad 项目上的 FFMPEG 集成](https://stackoverflow.com/questions/6854190/ffmpeg-integration-on-iphone-ipad-project/15429359#15429359)

最后我们将获得 ffmpeg 通用库和#include 文件。将其添加到您的项目中，然后按照该链接中给出的步骤进行操作。iframeextractor 对我来说工作正常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T17:53:44.720

# java - 如果语句中包含的方法内部发生错误，则返回 while 循环条件

> ID：11451508
> 
> 赞同：1
> 
> 时间：2012-07-12T12:08:30.243
> 
> 标签：java

在下面的代码行中，我在 while 循环中调用 validatePersonDTO 方法。如果 validatePersonDTO 的当前记录方法中发生任何错误，我需要返回到 while 循环来处理下一条记录。

> 笔记：

ValidatepersonDTo 方法位于 while 循环所在的另一个类中。

这是一个非常基本的问题，我已经尝试了一些选项，但是 continue 或 return 都不起作用。

所以请让我知道你的建议。

```
while ((nextLine = reader.readNext()) != null) {
hrUploadValidator.validatePersonDTO(personDTO);
}

public void validatePersonDTO(PersonDTO personDTO) {
    try {           
        validateCdsId(personDTO, logDTO,regionIdList);          
        validateEmpFirstName(personDTO, logDTO);            
        validateEmpLastName(personDTO, logDTO);         
        validateEffectiveIn(personDTO, logDTO);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:13:39.477

假设`validatePersonDTO`在验证失败时抛出异常（这是唯一的选择，因为方法是`void`），您在`while`循环中缺少一个 try/catch 块：

```
while ((nextLine = reader.readNext()) != null) {
    try {
        hrUploadValidator.validatePersonDTO(personDTO);
    } catch (Exception ex) {
        // Log / otherwise process your exception here
    }
} 
```

一旦在`catch`块中记录或以其他方式处理异常，您的循环将从停止的地方继续迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:13:21.740

将`try`/添加`catch`到您的循环代码中，如下所示：

```
while ((nextLine = reader.readNext()) != null)
{
    try
    {
        hrUploadValidator.validatePersonDTO(personDTO);
    }
    catch (Throwable x)
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:13:54.320

如果该方法`validatePersonDTO`抛出一个`Exception`，那么您可以用 a 包围它的调用，`try-catch`并在 catch 语句中执行该`continue`语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:15:00.573

如果你想对异常做出反应，不要`validatePersonDTO`在 while 循环中捕获它们：

```
while ((nextLine = reader.readNext()) != null) {
  try {           
    hrUploadValidator.validatePersonDTO(personDTO);
  } catch (ErrorThrownByValidationMethods e) {
    continue;
  } 
  // Processing
}

public void validatePersonDTO(PersonDTO personDTO) throw ErrorThrownByValidationMethods {

    validateCdsId(personDTO, logDTO,regionIdList);          
    validateEmpFirstName(personDTO, logDTO);            
    validateEmpLastName(personDTO, logDTO);         
    validateEffectiveIn(personDTO, logDTO);

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:15:32.267

您可以使用布尔标识符的标志，它从执行 while 的方法返回一个真值（如果它执行成功），然后继续前进，或者如果返回假，则再次进入该方法并更新值。

你可以这样做

```
 boolean x=false;
   while(<your condition>&&x==false)
  {
     try
       {
          <your code>
          x=true; //last statement of try block
       }
     catch(Exception e)
     {
        x=false;
     }
  } 
```

# c# - Monotouch、UIPopover 和获取事件

> ID：11451513
> 
> 赞同：0
> 
> 时间：2012-07-12T12:08:46.143
> 
> 标签：c#, xamarin.ios, uikit, uipopovercontroller

我是 Monotouch 的新手，但我在遥远的过去做过一些 Objective C。我正在尝试弄清楚我将如何执行以下操作：

1.  我有一个带有导航栏和按钮的 ViewController。
2.  当我单击按钮时，我希望出现一个 UIPopOver，其中可能有一个表格视图或按钮。

我要解决的是如何从放置在 UIPopOver 中的视图中获取委托/事件，以将其事件发送回调用视图。

在 Objective C 中，您在视图中的调用中设置委托，如下所示：

```
 UIPopoverController *popover = 
        [[UIPopoverController alloc] initWithContentViewController:myPopOverViewcontrol]; 
    popover.delegate = self; 
```

那么在 Monotouch 中你是如何做到这一点的呢？如果像这样设置 UIPopOver：

```
UIPopoverController myPopOver = new UIPopoverController(new myPopOverViewControl());
myPopOver.PopoverContentSize = new SizeF(200f, 300f);
myPopOver.PresentFromRect (btnButton.Frame, v, UIPopoverArrowDirection.Up, true); 
```

你如何附加代表？

谢谢

麦克风

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T14:13:49.177

您可以从三种样式中进行选择：(a) C# 事件样式，(b) 强类型/代码完成感知样式和 (c) 动态样式。

C# 事件样式是这样的：

```
popover.DidDismiss += (sender, args) {
   Console.WriteLine ("Dismissed!");
} 
```

如果使用上述方法，则只能在该对象上使用 C# 事件，不能在同一个对象中混搭。

强类型/代码完成感知风格是：

```
popover.Delegate = new MyUIPopoverControllerDelegate ();

[...]

class MyUIPopoverControllerDelegate : UIPopoverControllerDelegate {
     public override void DidDismiss (UIPopoverController popoverController);
} 
```

动态样式不执行参数检查，也不会警告您错误，并且与您在 Objective-C 中所做的非常相似。您还需要手动找出从 Objective-C 选择器到方法的绑定：

```
popover.WeakDelegate = this;

[...]

[Export ("popoverControllerDidDismissPopover:")]
void dismissed (UIPopoverController controller)
{
    Console.WriteLine ("Dismissed");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:26:35.120

在 MonoTouch 中，您可能会附加到`DidDismiss`事件：

```
var pop = new UIPopoverController();
pop.DidDismiss += (sender, args) => Console.WriteLine("Popover '{0}' was dismissed", (UIPopoverController)sender);
pop.PresentFromBarButtomItem(...); 
```

# jquery - jquery.validate.js 不工作？

> ID：11451517
> 
> 赞同：0
> 
> 时间：2012-07-12T12:08:57.030
> 
> 标签：jquery, validation

我不明白我在这里做错了什么：http: [//adam-sites-for-clients.info/set-up/](http://adam-sites-for-clients.info/set-up/)

我正在使用这个： [http ://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

我的代码是：

```
<script type="text/javascript">
$("#myForm").validate();
</script> 
```

想法？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:17:00.037

删除您的表单并将其粘贴到：

```
<form class="optin" method="post" action="submit.php" id="myForm">
  <label for="name" class="label"><img src="images/label1.png" alt="" /></label>
  <input type="text" name="name" class="textbox required" id="name" />
  <label for="phone" class="label move"><img src="images/label2.png" alt="" /></label>
  <input type="text" name="phone" class="textbox required" id="phone" />
  <label for="email" class="label move"><img src="images/label3.png" alt="" /></label>
  <input type="text" name="email" class="textbox required email" id="email" />
  <input type="submit" class="submit" name="submit" value="" />
  <input id="topic" type="hidden" name="topic" value="homepage">
</form> 
```

...然后阅读文档，然后从那里开始。

注意到我添加到`<input>`元素中的类了吗？

# python - SWIG/Python：带有 OpenGL 共享库的异常处理程序

> ID：11451520
> 
> 赞同：3
> 
> 时间：2012-07-12T12:09:03.080
> 
> 标签：python, opengl, swig

在一个项目中，我必须将 C++ 代码（包括 Python 中的 opengl 库）与 swig 绑定。问题是当我包含 OpenGL 共享库时，异常处理程序不再起作用。作为说明，这个项目：

例子.i

```
/* example.i */
%module example
%{
#include "example.h"
%}
class Error{
public:
    Error();
    const char *what() const throw();   
    virtual ~Error() throw();
};
void foo() throw(Error); 
```

例子.cpp

```
#include"example.h"
Error::Error(){}
const char *Error::what() const throw() { return "FOO"; }
Error::~Error() throw(){}

void foo() throw(Error){throw(Error());} 
```

例子.h

```
class Error{
public:
  Error();
  const char *what() const throw();
  virtual ~Error() throw();
};
void foo() throw(Error); 
```

例子.py

```
from example import * 
try:
    foo()
except Error,e:
     print e.what() 
```

生成文件

```
swig -c++ -python example.i
g++ -I/usr/include/python2.7/  -c -fpic example.cpp example_wrap.cxx
g++ -lGL -shared example.o example_wrap.o -o _example.so
python example.py 
```

使用 -lGL 会发生分段错误。没有，python 处理错误。你有解决这个问题的想法吗？

# javascript - JQuery/JavaScript - 从单词列表创建表格

> ID：11451521
> 
> 赞同：0
> 
> 时间：2012-07-12T12:09:11.033
> 
> 标签：javascript, jquery

目前，这会为单词列表创建表格，但仅在一列中。如何让它打印到 4x5 表中？

```
var listOfWords = ["mat","cat","dog", "pit", "pot", "fog", "log", "pan", "can", "man"];
var innerTable = '';
for (var i = 0, len = listOfWords.length; i < len; i++) {
innerTable += '<tr><td>'+listOfWords[i]+'</td></tr>';
}
$('<table>'+innerTable+'</table>').appendTo('body'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:20:15.703

现在线

```
innerTable += '<tr><td>'+listOfWords[i]+'</td></tr>'; 
```

正在为每个新单词创建一个新的“tr”（行）和“td”（列）。为了让单词在四列的网格中打印出来，您只需每四个单词附加一个“tr”。

作为一个快速破解：

```
var listOfWords = ["mat","cat","dog", "pit", "pot", "fog", "log", "pan", "can", "man"];
var innerTable = '';
for (var i = 0, len = listOfWords.length; i < len; i++) {
    if ((i%4)==0){
        innerTable += '<tr>';
    }
    innerTable += '<td>'+listOfWords[i]+'</td>';
    if ((i%4)==3){
        innerTable += '</tr>';
    }
}
$('<table>'+innerTable+'</table>').appendTo('body'); 
```

这应该仅将“tr”附加到元素 0、4、8、12、16 和元素 3、7、11、15、19（在 20 个元素的列表中——因为您提到了 4x5表我要做什么）。缺少 html 我无法证明它有效，但希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:32:53.237

你想要多行多列。实现这一点的最简单方法是遍历这两个，而不是遍历单词列表。

这看起来像这样：

```
var rows = 4;
var cols = 5;

for (var row=0; row < rows; row++) {
  // Open the <tr>
  for (var col=0; col < cols; col++) {
      index = (row*cols) + col;
      // Add a <td> containing   listOfWords[index]
  }
  // Close the <tr>
} 
```

此策略允许您轻松更改表中**的行数和列数**（即使列表的长度不是列数的精确倍数）。

我看到你删除了你的评论，但是要**随机化**哪个项目去哪里，你需要做的就是使用[`sort`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)and来打乱列表[`random`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)：

```
var listOfWords = ["mat","cat","dog", "pit", "pot", "fog", "log", "pan", "can", "man"];
listOfWords.sort(function() { return 0.5 - Math.random(); }); 
```

如果您需要保留原始列表，请先使用以下命令创建列表的副本[`slice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice)：

```
var listOfWords = ["mat","cat","dog", "pit", "pot", "fog", "log", "pan", "can", "man"];
var shuffledWords = listOfWords.slice(0);
shuffledWords.sort(function() { return 0.5 - Math.random(); }); 
```

# 完整的解决方案

由于您已经在使用 jQuery，因此创建新节点（ 、 等）的最佳方式`<tr>`不是`<td>`编写完整的 HTML，而是让[`jQuery()`函数](http://api.jquery.com/jQuery/)（与 相同`$()`）为您创建节点。这样，您就可以访问节点的所有 DOM 和 jQuery 函数，例如[`appendTo()`](http://api.jquery.com/appendTo/).

试试这个：

```
var listOfWords = ["mat","cat","dog", "pit", "pot", "fog", "log", "pan", "can", "man"];
var shuffledWords = listOfWords.slice(0);
shuffledWords.sort(function() { return 0.5 - Math.random(); });

var table = $('<table>'); // <-- creates a new jQuery object containing a <table> node
var rows = 4;
var cols = 5;
var tr;
var index;

for (var row=0; row < rows; row++) {
  tr = $('<tr>');
  for (var col=0; col < cols; col++) {
    index = (row*cols) + col;
    $('<td>').text(shuffledWords[index]).appendTo(tr);
  }
  tr.appendTo(table);
}

table.appendTo('body'); 
```

# 演示

您可以[在此处查看实时示例](http://jsbin.com/axewud/edit)。

# cocos2d-iphone - 当他们到达某个点时摧毁精灵身体

> ID：11451522
> 
> 赞同：0
> 
> 时间：2012-07-12T12:09:11.650
> 
> 标签：cocos2d-iphone

当他们到达某个点时，我怎么能摧毁精灵。我知道销毁精灵的代码，但不知道条件。我的精灵通过加速移动，我想在他们到达屏幕右下角时摧毁那个精灵......

请给我一个代码或提示该怎么做。请帮我

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:29:23.593

每当您获得精灵的位置时，请执行以下代码以删除 boxBody。它适用于带有 Box2D Physics 的 cocos2D。**将 Sprite 添加到图层时使用标签，**根据标签删除 Body。此代码不会删除精灵。

```
-(void) deleteBoxBody :(int) passTag 
{

    for (b2Body* b = _world->GetBodyList(); b; b = b->GetNext())
    {

        if (b->GetUserData() != NULL)
        {

            CCSprite *temp1 = (CCSprite*)b->GetUserData();

            if(temp1.tag == passTag)
            {
//              NSLog(@"Destroying here");
                _world->DestroyBody(b);
                [self removeChild:temp1 cleanup:YES];

                return;
            }               
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:41:22.497

使用此代码以避免崩溃。安全和定时销毁。

```
-(void) tick: (ccTime) dt
{
    ...
    std::vector<b2Body *>toDestroy; 
    std::vector<b2Body *>::iterator pos;

    for (b2Body* b = _world->GetBodyList(); b; b = b->GetNext())
    {

        if (b->GetUserData() != NULL)
        {

            CCSprite *temp1 = (CCSprite*)b->GetUserData();

            if(temp1.tag == kTagSpriteOnWish)
            {
             temp1.tag = kTagExpiredSprite;
                     temp1.visible = false;
   [self performSelector:@selector(removeSprite:)  withObject: temp1 afterDelay:1.5]; 

                 toDestroy.push_back(b);                 
            }               
        }
    }

for (pos = toDestroy.begin(); pos!=toDestroy.end(); ++pos) 
    {
        b2Body *body = *pos;     
        world->DestroyBody(body);
        body= NULL;
    }
}

-(void)removeSprite:(id)sender
{
    CCSprite *spr = (CCSprite*)sender;
    [spr removeAllChildrenWithCleanup:YES];
    [spr removeFromParentAndCleanup:YES];

//    printf("Removed ice block\n");
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:31:50.037

你需要做的就是精灵剔除。

您可以通过多种方式进行操作。在这里，您有几个简单的方法：

1.  安排一个精灵剔除器来评估您可能想要杀死的所有精灵的位置，然后将它们从屏幕上移除。根据您需要达到的精度，根据需要调整计划时间。

2.  使剔除器成为一个节点（或一系列节点）并将其放置在屏幕外。提供碰撞检测，以便您可以检测精灵何时到达剔除器。当精灵与剔除器碰撞时，它可以将它们从屏幕上移除。

# javascript - 我可以让列表项看起来像一个堆栈吗

> ID：11451527
> 
> 赞同：4
> 
> 时间：2012-07-12T12:09:19.403
> 
> 标签：javascript, html, css

通常，浮动 HTML 元素从左到右流动，如果达到容器的宽度，则落在下一行。

我想知道，是否有任何方法可以让它们漂浮在底部。我的意思是元素应该彼此向上堆叠。

我认为这个例子会让[http://jsfiddle.net/duGVa/](http://jsfiddle.net/duGVa/)

落在下一行的元素，即 LI-6，应该在其他 5 个元素的顶部。并且元素 1-5 应该接触到容器 UL 的底部。

谢谢你。

![在此处输入图像描述](../Images/8efe72bc4b3829dff1262f9e9f4d1f2b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:36:21.613

你可以作弊很可怕...

使用 CSS 转换来反转 UL 和 LI，你会得到你想要的结果。

```
ul {
    width: 500px;
    height: 100px;
    background: #def;
    list-style-type: none;
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -ms-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv();
}

li {
    background: #aaa;
    width: 50px;
    height: 40px;
    float: left;
    margin: 5px 25px;
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -ms-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv();
} 
```

看到[这个小提琴](http://jsfiddle.net/bNKY3/9)（在 Firefox、Chrome 中测试）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:36:48.827

将您的列表放在一个部门`<div>`中可以使其成为一个单元。

然后使用 CSS 你可以强制每个列表项`<li>`居中。

最后，为了确保每个列表项彼此对齐`<li>`，您可以使用 CSS 将它们的宽度设置为相同。

那应该显示为堆栈。这是一个例子..

```
<style type='text/css'>
#stack{
align: left;
}
#stack > ul {
align: center;
}
#stack > ul > li{
align: center;
width: 80px;
border: 2px solid black;
text-decoration: none;
}
</style>

<div id="stack">
<ul>
<li>Item 1</li>
<li>Item 2</li>
<li>Item 3</li>
</ul>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:27:26.917

你必须务实地设法实现这样的目标：

```
<ul>
    <li>LI 6</li>
</ul>
<ul>
    <li>LI 1</li>
    <li>LI 2</li>
    <li>LI 3</li>
    <li>LI 4</li>
    <li>LI 5</li>
</ul> 
```

[检查这个](http://jsfiddle.net/duGVa/12/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T05:07:17.727

我感谢`meouw`他在下面提到的好答案

**引用者`meouw`**

```
/* Only showing mozilla and webkit transforms */
ul {
    width: 500px;
    height: 100px;
    background: #def;
    list-style-type: none;
   -moz-transform: scaleY(-1);
   -webkit-transform: scaleY(-1);
}

li {
    background: #aaa;
    width: 50px;
    height: 40px;
    float: left;
    margin: 5px 25px;
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
} 
```

**但这里是跨浏览器解决方案：**

```
/* For All browsers : Chrome. Firefox, Mozilla, IE7+(tested), Opera */

ul {
    width: 500px;
    height: 100px;
    background: #def;
    list-style-type: none;
    -moz-transform: scaleY(-1); /* for Mozilla */
    -webkit-transform: scaleY(-1); /* for Webkit Safari/Chrome*/
    -o-transform: scaleY(-1); /* for Opera*/
    -ms-transform: scaleY(-1); /* for IE9 + */
    filter: flipv(); /* for IE9 below */
}

li {
    background: #aaa;
    width: 50px;
    height: 40px;
    float: left;
    margin: 5px 25px;
    -moz-transform: scaleY(-1); /* for Mozilla */
    -webkit-transform: scaleY(-1); /* for Webkit Safari/Chrome*/
    -o-transform: scaleY(-1); /* for Opera*/
    -ms-transform: scaleY(-1); /* for IE9 + */
    filter: flipv(); /* for IE9 below */
} 
```

对于 IE 9 下面您可以使用过滤器：`flipv();` **[请参阅参考](http://msdn.microsoft.com/en-us/library/ms532994%28v=vs.85%29.aspx)**

# jquery - jQuery 如何使用 .not 与此

> ID：11451528
> 
> 赞同：1
> 
> 时间：2012-07-12T12:09:26.487
> 
> 标签：jquery, if-statement, click, addclass, removeclass

我有票务系统。消息被放置在一个 div 中，并且该 div 隐藏了子消息（该票的回复）

[演示](http://www.gc-cdn.com/snippets/java.php)

[jsFiddle 托管演示](http://jsfiddle.net/cs87W/)

单击箭头 - 显示线程子项。再次单击它会隐藏线程子项，并且箭头会上下移动。

我想要它，如果当前线程是打开的，用户点击另一个箭头，打开的箭头应该恢复回来，反之亦然。

**jQuery**

```
 $(document).ready(function(){
        $('h1').click(function(){
            if ($(this).next('.parent').hasClass('showMe')){
                    $('.parent').removeClass('showMe').hide();
                    $(this).find("#ticket_arrow").removeClass('up');
                $(this).find("#ticket_arrow").addClass('down');
              } else {
                $('.parent').removeClass('showMe').hide();
                    $(this).find("#ticket_arrow").removeClass('down');
                $(this).find("#ticket_arrow").addClass('up');
                $(this).next('.parent').addClass('showMe').show();
            }
        });
    });
/**
  Hides all sub threads on Load
**/
$('.parent').hide(); 
```

**HTML**

```
<style type="text/css">
.ticket_thread_h1 span{cursor:pointer}
.down{background:url(http://www.gc-cdn.com/personalstylist/down.png) no-repeat;width:15px;height:10px;display:block}
.up{background:url(http://www.gc-cdn.com/personalstylist/up.png) no-repeat;width:15px;height:10px;display:block}
</style>
<h1 id="ticket_thread_1" class="ticket_thread_h1">Thread # 1 <span id="ticket_arrow" class="down">&nbsp;</span></h1>
<div class="parent">
    <div class="sub_thread"><p>Thread Messages #1 1</p></div>
    <div class="sub_thread"><p>Thread Messages #1 2</p></div>
</div>
<h1 id="ticket_thread_2" class="ticket_thread_h1">Thread # 2 <span id="ticket_arrow" class="down">&nbsp;</span></h1>
<div class="parent">
    <div class="sub_thread"><p>Thread Messages #2 1</p></div>
    <div class="sub_thread"><p>Thread Messages #2 2</p></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:25:16.177

添加以下代码：

```
$("h1").find('.up').each(function(){$(this).removeClass('up').addClass('down');}); 
```

部分之后`$(this).find("#ticket_arrow").removeClass('down');`，`else`所以代码必须是：

```
$('h1').click(function(){
            if ($(this).next('.parent').hasClass('showMe')){
                $('.parent').removeClass('showMe').hide();
                $(this).find("#ticket_arrow").removeClass('up');
                $(this).find("#ticket_arrow").addClass('down');
              } else {
                $('.parent').removeClass('showMe').hide();
                $(this).find("#ticket_arrow").removeClass('down');
                $("h1").find('.up').each(function(){$(this).removeClass('up').addClass('down');});
                $(this).find("#ticket_arrow").addClass('up');
                $(this).next('.parent').addClass('showMe').show();
            }
        }); 
```

这对我有用。

**编辑**：顺便说一句，为什么你有多个具有相同 ID 的元素？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:31:05.717

只需存储对最后显示项目的引用。

它不会遍历所有可能的消息，因为这样做效率低且相对昂贵。请注意，我没有在 jQuery 中验证这一点，请做我的客人。

```
var lastOpenItem = undefined;

$('h1').click(function(){

    if( lastOpenItem ) {
        lastOpenItem.removeClass('showMe');

        var curSelect = $(this).next('.parent');
        lastOpenItem = ( curSelect == lastOpenItem ) ? undefined : curSelect;
    }
}); 
```

最重要的是，您的代码对我来说似乎是多余的，因为它在 IF 和 ELSE 中有两次相同的行。我建议将其移出条件。

```
$('.parent').removeClass('showMe').hide(); 
```

老实说，我会为您的类名提供语义名称（向上、向下、showMe 与 activeMessage、arrowExpand 等），但是很好。

我还会重新组合您的 HTML，因为您的动态 ID 与数字不是......那么好。

最后，您不必切换 2 个类。给箭头类“箭头”或其他东西，CSS可以通过它的父状态切换，因为它们是相互绑定的。

HTML：

```
<h1 id="ticket_thread_2" class="ticket_thread_h1 activeMessage">Thread # 2 <span class="ticket_arrow">&nbsp;</span></h1>
<div class="parent">
    <div class="sub_thread"><p>Thread Messages #2 1</p></div>
    <div class="sub_thread"><p>Thread Messages #2 2</p></div>
</div> 
```

CSS：

```
.ticket-arrow{

    background:url(http://www.gc-cdn.com/personalstylist/down.png) no-repeat;
    width: 15px;
    height:10px;
    display:block

}
.activeMessage>.arrow {

    background-image:url(http://www.gc-cdn.com/personalstylist/up.png);
}​ 
```

我确实发现对图像使用绝对 url 并不常见，我认为您应该将它们复制到本地，除非您希望它们在 gc-cdn.com 确实更改它们时也更改..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:36:01.107

这是另一个工作版本 - 更干净一点。

HTML 标记 - 添加`.arrow`类和固定 ID：

```
<h1 id="ticket_thread_1" class="ticket_thread_h1">Thread # 1 <span id="ticket_arrow1" class="arrow down">&nbsp;</span></h1>
<div class="parent">
    <div class="sub_thread"><p>Thread Messages #1 1</p></div>
    <div class="sub_thread"><p>Thread Messages #1 2</p></div>
</div>
<h1 id="ticket_thread_2" class="ticket_thread_h1">Thread # 2 <span id="ticket_arrow2" class="arrow down">&nbsp;</span></h1>
<div class="parent">
    <div class="sub_thread"><p>Thread Messages #2 1</p></div>
    <div class="sub_thread"><p>Thread Messages #2 2</p></div>
</div> 
```

JavaScript - 缓存选择器：

```
$(document).ready(function(){
    $arrows = $('.arrow');
    $parents = $('.parent');
    $('h1').click(function(){
        if ($(this).next('.parent').hasClass('showMe')){
           $parents.removeClass('showMe').hide();
           // Just in case make all arrows point down:
           $arrows.removeClass('up').addClass('down');
        } else {
           $parents.removeClass('showMe').hide();
           $arrows.removeClass('up').addClass('down');
           $(this).find('.arrow').addClass('up');
           $(this).next('.parent').addClass('showMe').show();
        }
    });
    /**
    Hides all sub threads
    **/
   $parents.hide();
}); 
```

工作jsfiddle：http: [//jsfiddle.net/jfrej/cs87W/8/](http://jsfiddle.net/jfrej/cs87W/8/)

如果可以，您应该开始使用最新的 jQuery。jsfiddle 中的 1.3.2 版本已经过时 - 我将其保留以确保我的解决方案也适用于该版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:40:35.667

```
$('h1').click(function(){
  var $t = $(this);

  $t.siblings('h1').children('span').removeClass('up')
  .end().next().hide();

  $t.children('span').toggleClass('up')
  .end().next().toggle();
}); 
```

我只是将箭头默认设置为向下（大多数项目都会这样）并切换“向上”。

[jsfiddle](http://jsfiddle.net/cs87W/11/)

# git - .gitignore 被 Git 忽略

> ID：11451535
> 
> 赞同：1662
> 
> 时间：2012-07-12T12:09:56.280
> 
> 标签：git, gitignore

我的`.gitignore`文件似乎被 Git 忽略了 -`.gitignore`文件可能已损坏吗？Git 期望哪种文件格式、语言环境或文化？

我的`.gitignore`：

```
# This is a comment
debug.log
nbproject/ 
```

输出`git status`：

```
# On branch master
# Your branch is ahead of 'origin/master' by 1 commit.
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       debug.log
#       nbproject/
nothing added to commit but untracked files present (use "git add" to track) 
```

我希望`debug.log`并且`nbproject/`不要出现在未跟踪的文件列表中。

我应该从哪里着手解决这个问题？

* * *

## 回答 #1

> 赞同：3403
> 
> 时间：2012-07-12T12:20:59.183

即使到目前为止您还没有跟踪这些文件，Git 似乎也能够“知道”它们，即使您将它们添加到`.gitignore`.

**警告：**首先提交或存储您当前的更改，否则您将丢失它们。

然后从 Git 存储库的顶层文件夹运行以下命令：

```
git rm -r --cached .
git add .
git commit -m "fixed untracked files" 
```

* * *

## 回答 #2

> 赞同：354
> 
> 时间：2015-09-03T13:54:04.313

如果 Git 似乎没有注意到您对`.gitignore`文件所做的更改，您可能需要检查以下几点：

*   可能有一个全局`.gitignore`文件可能会干扰您的本地文件
*   当您将某些内容添加到 .gitignore 文件中时，请尝试以下操作：

    ```
    git add [uncommitted changes you want to keep] && git commit
    git rm -r --cached .
    git add .
    git commit -m "fixed untracked files" 
    ```

*   **如果您从 .gitignore 文件中删除某些内容，并且上述步骤可能不起作用，如果您发现上述步骤不起作用，请尝试以下操作**：

    ```
    git add -f [files you want to track again]
    git commit -m "Refresh removing files from .gitignore file."

    // For example, if you want the .java type file to be tracked again,
    // The command should be:
    //     git add -f *.java 
    ```

* * *

## 回答 #3

> 赞同：218
> 
> 时间：2012-07-12T12:30:50.053

固定的。好的，我在 Windows 上的记事本中创建了 .gitignore 文件，但它不工作。当我在 Linux 上查看 .gitignore 文件时，它看起来像是有条理的乱码——也许记事本写出了 Unicode 而不是 ASCII 或任何 8 位。

所以我在我的 Linux 机器上重写了文件，当我把它拉回 Windows 时它工作正常！欢呼！

* * *

## 回答 #4

> 赞同：119
> 
> 时间：2014-03-19T23:40:24.987

在不向您的项目添加另一个提交的情况下，一行就足以完成`.gitignore`预期的工作：

```
git rm -r --cached debug.log nbproject 
```

这将从存储库中删除它们，但仍保留它们。用简单的英语来说，它会删除与它们相关的任何更改历史记录，并且也不会在未来的任何提交中跟踪它们的更改。[您可能会在这里](http://stackoverflow.com/questions/37279654/when-should-i-use-rm-git-rm-git-rm-cached-git-add)找到更好的解释。

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2013-12-23T01:48:12.053

此问题的另一个原因是语句前的空格或制表符：

例子：

```
# Be aware of the following:
 notWorkingIgnore.*
workingIgnore.* 
```

正如下面的评论所指出的，尾随空格也可能是一个问题：

```
# Be aware of the following:
notWorkingIgnore.* #<-Space
workingIgnore.*#<-Nospace 
```

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2015-08-13T21:14:28.747

我注意到 的编码产生`.gitignore`了影响——如果文件是 Unicode，它被忽略，如果它是 ASCII，它不是。

过程：

1.  验证状态：`PS> git status`
2.  创建一个[Get-FileEncoding函数](https://stackoverflow.com/a/9121679/134367)
3.  测试`.gitignore`的编码：`PS> Get-FileEncoding .gitignore`
4.  [将编码更改](https://stackoverflow.com/a/9121679/134367)为 ASCII：`PS> Set-Content .gitignore -Encoding Ascii -Value (Get-Content .gitignore)`
5.  确认：`PS> git status`

* * *

## 回答 #7

> 赞同：37
> 
> 时间：2016-11-14T23:13:08.117

与其他解决方案一样，首先提交并注意您*将*丢失任何未提交的更改。

我有更好的结果：

```
git rm -r --cached .
git reset HEAD --hard
git status 
```

请注意，状态现在不应该有任何修改的文件。

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2017-08-21T08:27:15.583

就我而言，这是因为文件已经存在于存储库中，我试图忽略它。

这些是我为解决此问题所做的事情：

*   将文件复制到临时文件夹
*   从我的项目文件夹中删除它们。
*   提交从存储库中删除这些文件的更改
*   将这些文件重新添加到我的项目文件夹中

到那时，我对这些文件所做的任何更改都被忽略了。

我认为您不能忽略存储库中已经存在的文件。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2015-11-25T21:21:08.230

这里的所有答案实际上都是解决方法。您需要在运行*之前*`git init`创建 .gitignore 文件。否则`git`永远不会知道您需要忽略这些文件，因为它们已经被跟踪。

```
echo .idea/ >> .gitignore
git init 
```

如果您每天都在开发，我建议您将习惯性忽略的文件添加到您的`~/.gitignore_global`文件中。这样，`git`您就已经知道您（意思是“您的用户”，因为它是您的主目录中的一个文件）通常会忽略哪些文件。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-10-14T06:32:07.833

还要检查您放置的**目录**`.gitignore`。

它应该位于**项目的根目录中**：

```
./myproject/.gitignore 
```

不在

```
./myproject/.git/.gitignore 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2015-08-16T15:49:18.360

`.gitignore`可能会发生另一个问题，尤其是对于 Windows 用户。Git 不喜欢你命名时`.gitignore`（例如`unity.gitignore`）。

您将希望始终命名它`.gitignore`，或者在 Windows 上，`.gitignore.`因为 Windows 认为您正在尝试在没有文件名的情况下重命名它。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2017-11-11T01:20:04.073

专门针对 Windows 用户：如果您有未跟踪的文件并且清除/删除缓存的文件不起作用。尝试打开 PowerShell 并将 .gitignore 文件转换为 UTF-8 编码：

```
$Myfile = Get-Content .\.gitignore`
$Myfile | Out-File -Encoding "UTF8" .gitignore 
```

您只需执行一次即可为该目录编码 .gitignore 文件，并且由于该文件随后被正确编码，因此无论您将来何时编辑该文件，它都应该可以工作。我相信这是由于 GitHub 出现故障，无法读取 .gitignore 文件的非 UTF-8 编码。据我所知，Windows 尚未解决此问题。这没什么大不了的，只是在它不工作时调试起来很痛苦。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2017-08-25T06:36:10.823

我刚遇到这个问题。我的 .gitignore 文件中的内容继续出现在未跟踪文件列表中。

我正在使用它来创建忽略文件：

```
echo "node_modules" > .gitignore 
```

事实证明，双引号引起了我的问题。我删除了忽略文件，然后再次使用不带引号的命令，它按预期工作。我不需要弄乱文件编码。我在使用[Cmder](http://cmder.net/)的 Windows 10 机器上。

例子：

```
echo node_modules > .gitignore 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2020-03-10T14:27:27.563

已经有一些很好的答案，但我的情况很乏味。我在 Win10 上编辑了已安装的 PLM（产品生命周期管理）软件的源代码，然后决定，“我可能应该把它做成一个 git repo。”

因此，缓存选项直接对我不起作用。为其他可能在做了一堆初始工作后添加了源代码控制`.gitignore`但没有工作的人发帖，你可能害怕失去一堆​​工作，所以`git rm --cached`不适合你。

**！重要提示：**这真的是因为我将 git 添加到一个太大并且似乎忽略了我的 .gitignore 的“项目”中太晚了。我从来没有提交过。我可以摆脱这个:)

首先，我刚刚做了：

```
rm -rf .git
rm -rf .gitignore 
```

然后，我必须有一张我的变化的照片。同样，这是一个我已对其进行更改的安装产品。纯主分支的第一次提交为时已晚。所以，我需要一个列表，列出我安装程序后所做的更改，方法是添加 `> changed.log`以下任一内容：

**电源外壳**

```
# Get files modified since date.
Get-ChildItem -Path path\to\installed\software\ -Recurse -File | Where-Object -FilterScript {($_.LastWriteTime -gt '2020-02-25')} | Select-Object FullName 
```

**重击**

```
# Get files modified in the last 10 days...
find ./ -type f -mtime -10 
```

现在，我列出了我在过去十天中所做的更改（让我们不要在这里讨论最佳实践，只是说，是的，我对自己做了这个）。

重新开始，现在：

```
git init .
# Create and edit .gitignore 
```

我不得不将我更改的列表与我不断增长的 .gitignore 进行比较，`git status`在我改进它的同时运行，但是我在 .gitignore 中的编辑在我去的时候会被读入。

最后，我列出了所需的更改！在我的情况下，它是样板文件 - 一些主题与特定于针对该软件运行开发系统的服务器 xml 配置一起工作，我想放入一个 repo 供其他开发人员获取和贡献......这将是我们的主分支，所以提交，推动，最后为新工作分支！

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2017-02-20T00:47:06.093

对我来说，以前的答案都没有奏效。我不得不将`.gitignore`文本复制到`exclude.txt`找到的文件中

```
<Your-project-folder>\.git\info 
```

完成后，刷新您的更改，所有未跟踪的文件都消失了。像往常一样提交。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-05-03T14:21:03.457

我遇到了这个问题，一个 .gitignore 文件包含这一行：

```
lib/ext/ 
```

我刚刚意识到，事实上，这个目录是一个指向其他地方的文件夹的符号链接：

```
ls -la lib/ext/
lrwxr-xr-x 1 roipoussiere users 47 Feb  6 14:16 lib/ext -> /home/roipoussiere/real/path/to/the/lib 
```

上线了`lib/ext/`，Git其实是找*文件夹*的，但是符号链接是*文件*，所以我的`lib`文件夹没有被忽略。

`lib/ext/`我通过`lib/ext`在我的 .gitignore 文件中替换为来解决这个问题。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2018-01-08T02:15:35.010

我的问题是（正如 OP 所建议的）一个损坏的 .gitignore 文件。我不相信它是并且忽略了这种可能性，直到其他一切都失败了。损坏**未显示在 中`vi`**，但文件开头有两个字节导致 .gitignore 文件被忽略。对我来说，这些仅在我输入时出现`cat .gitignore`，显示：

```
��# Built application files
*.apk
*.ap_

# ... 
```

我不知道这些是如何结束的，但重新创建文件解决了这个问题。对损坏文件的十六进制分析显示如下：

```
user@dev ~/project/myproject $ xxd -b .gitignore
00000000: 11111111 11111110 00100011 00000000 00100000 00000000  ..#. .
00000006: 01000010 00000000 01110101 00000000 01101001 00000000  B.u.i. 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2015-02-21T06:32:39.580

我有同样的问题。我相信这个问题是 CR 与 CR+LF 的差异。我使用 CMD（在 Windows 7 上）和以下命令将东西藏在我的 .gitignore 中：

坏的：

```
echo "file_to_be_ignored.py" >> .gitignore<br>
echo "*~" >> .gitignore 
```

等等。

问题是这个命令没有为 Git 放置正确的行尾标记来识别换行符（当 Git 需要另一个时，是 CR 或 CR+LF）。我通过手动替换 Vim 中的每个换行符（Vim 来救命！）解决了这个问题，它工作得很好。

尝试在 Notepad++ 或 Vim 中编辑您的 .gitignore（理想情况下）。即使文件看起来格式正确，也请尝试替换换行符。这听起来很奇怪，我知道，但它对我有用。:D

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2016-03-29T10:41:30.810

好的，所以在我的情况下，接受的解决方案不起作用，这里描述了有效的解决方案：

*[Visual Studio 2013 是否忽略了您的 .gitignore 文件？](https://ericnelson.wordpress.com/2014/06/21/is-visual-studio-2013-ignoring-your-gitignore-file/)*

简而言之：

*   关闭 Visual Studio。
*   导航到您的 .git 文件夹
*   删除`ms-persist.xml`
*   重新启动 Visual Studio

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2019-05-23T09:57:25.303

**另一个可能的原因**——*几个 Git 客户端实例同时运行*。例如“git shell”+“GitHub 桌面”等。

* * *

这发生在我身上。我使用“GitHub Desktop”作为主要客户端，它忽略了一些新的 .gitignore 设置：提交后提交：

1.  你提交了一些东西。
2.  接下来，提交：它忽略 .gitignore 设置。提交包括 .gitignore 中提到的大量临时文件。
3.  清除 Git 缓存；检查 .gitignore 是否为 UTF-8；删除文件→提交→移回文件；跳过一次提交——没有任何帮助。

**原因**：Visual Studio Code 编辑器在后台运行，打开的存储库相同。Visual Studio Code 具有内置的 Git 控件，这会导致一些冲突。

**解决方案**：仔细检查多个隐藏的 Git 客户端，一次只使用一个 Git 客户端，尤其是在清除 Git 缓存时。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2012-11-13T02:21:22.253

还要看的一件事：您是否使用正确的行尾保存 .gitignore 文件？

视窗：

如果您在 Windows 上使用它，您是否使用 Windows 行结尾保存它？并非所有程序都会默认执行此操作；Notepad++ 和许多 PHP 编辑器默认使用 Linux 行结尾，因此文件将与服务器兼容。检查这一点的一种简单方法是在 Windows 记事本中打开文件。如果所有内容都出现在一行上，则该文件以 Linux 行结尾保存。

Linux：

如果文件在 Linux 环境中运行时遇到问题，请在 Emacs 或[nano](https://en.wikipedia.org/wiki/GNU_nano)等编辑器中打开文件。如果您看到任何不可打印的字符，则该文件以 Windows 行结尾保存。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2017-09-28T20:18:20.740

此处其他答案未涵盖的一个棘手的事情是，如果您有内联注释，则 .gitignore 文件将不起作用，如下所示：

```
foo/bar # The bar file contains sensitive data so we don't want to make this public 
```

因此，如果您确实有这样的评论，请像这样更改它们：

```
# The bar file contains sensitive data so we don't want to make this public
foo/bar 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2021-04-16T19:35:53.073

每当我遇到 git 正在跟踪中列出的文件的情况时`.gitignore`，我都会使用以下内容：

```
git update-index --skip-worktree <file_name> 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-09-04T19:41:28.063

对我来说，这又是一个问题。我的 .gitignore 文件设置为忽略除我告诉它不要忽略的内容之外的所有内容。像这样：

```
/*
!/content/ 
```

现在这显然意味着我还告诉 Git 忽略 .gitignore 文件本身。只要我不跟踪 .gitignore 文件，这不是问题。但在某些时候，我提交了 .gitignore 文件本身。这导致 .gitignore 文件被正确忽略。

所以再添加一行修复它：

```
/*
!/content/
!.gitignore 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2018-10-22T06:15:21.523

您也有可能`.gitignore`使用命令编辑文件`sudo`。我遇到了同样的问题，在执行命令时：`git status`，我仍然可以看到“应该被忽略”的文件。

在使用`nano .gitignore`而不是编辑时`sudo nano .gitignore`，我可以看到正确的反射。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2019-04-30T18:18:54.380

我`echo "..." > .gitignore`在 Windows 的 PowerShell 中创建了 .gitignore，因为它不允许我在 Windows 资源管理器中创建它。

我的问题是创建文件的编码，我把它改成ANSI后问题就解决了。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2019-07-20T00:01:55.237

我在 Ubuntu 上也有同样的问题，我`.gitignore`从终端创建了它，它对我有用

`touch .gitignore`

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2019-08-15T20:08:18.380

我的不起作用，因为我确实创建了一个名为 .gitignore 的文本文档

相反，创建一个文本文档，在 Notepad++ 中打开它，然后保存为 .gitignore

确保在保存时从下拉列表中选择所有类型 (*.*)。

* * *

或者在 gitbash 中，只需使用`touch .gitignore`

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-04-10T08:13:02.077

只需通过以下命令删除之前在 Git 中提交的文件夹或文件。然后 gitignore 文件将反映正确的文件。

```
 git rm -r -f "folder or files insides" 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2018-03-28T11:42:11.717

如果您是[Notepad++](http://en.wikipedia.org/wiki/Notepad%2B%2B)用户，请尝试执行以下操作：

使用 Notepad++ 打开您的 .gitignore 文件并执行以下操作：

菜单*编辑*→ *EOL 转换*→ *Windows 格式*→*保存*。

再次尝试使用`git status`，看看它是否适合您。

我在[这里](https://stackoverflow.com/a/49533525/3436775)发布了类似问题的答案。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2019-12-06T17:28:27.387

我的问题是我用引号“”而不是斜杠 / 写下要忽略的文件。

这不起作用并被 git 忽略：

```
"db.sqlite3"
"tdd_venv/" 
```

这工作得很好：

```
/db.sqlite3
/tdd_venv/ 
```

我还使用 Notepad++ 检查了我在 Windows 中的文件编码。编码设置为 UTF-8。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2021-05-03T10:53:10.377

我看到有几个人已经回答了，不知道有没有说清楚。就我而言，问题是使用 echo 命令创建 .gitignore 文件。在这种情况下，文件编码已更改，我必须打开文本文件，单击另存为并将底部选项卡中的编码更改为 UTF-8。当使用 touch 命令创建文件并通过文本编辑器编辑其内容时，.gitignore 的问题没有发生。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2021-06-25T13:23:12.607

**这里有很多答案，但对我有用的并不是任何特定的答案，我正在以一种简单的方式一一记下所有需要在这里完成的步骤：**

*Pre --- 备份 repo 以防万一。* （我没有，但可能会让你感觉更安全）

1.  确保这是您的第一次提交或更早这些文件已添加并因此已被缓存。
2.  如果是，则 git rm -r --cached 。和 git add 。（不要错过点）
3.  如果还是不行，用记事本打开文件
4.  转到文件-> 另存为
5.  将编码更改为 ANSI。（有些答案错误地说 UTF-8 ，但它不起作用并且不必要地浪费时间）
6.  再次 git rm -r --cached 。和 git add 。（不要错过点）
7.  现在做 Git status 并验证我们想要的已经发生了

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-03-09T09:13:18.297

这听起来可能很愚蠢，但解决我的问题的是意识到它`.gitignore` *工作*正常，即使它`deleted: yourfile`显示在 git status 上。

我打算忽略一个错误日志文件，忽略我造成的任何错误，但保存其他开发人员造成的错误，以防他们有一天在调试一个奇怪的问题时派上用场。但是，git 不允许您“忽略”并同时保留文件。

我希望它“及时冻结”，但 git 说它要么被跟踪，要么根本不允许存在。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2020-04-09T17:03:53.287

**PhpStorm（可能还​​有其他一些 IDE 用户）**，在我的情况下，问题是我通过 finder 在项目外部创建和添加了文件。

我删除了那个，并在 PhpStorm 项目中重新创建了相同的，右键单击 -> 新建 -> 文件，它立即工作。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2020-04-15T09:50:32.953

我的 30 美分把戏：

1.  请清理您的目录。`git clean -f`（我试过`git rm -r --cached .`了，但它对我不起作用。）

**警告： git clean -f 将删除未跟踪的文件，这意味着它们已经永远消失了，因为它们没有存储在存储库中。在执行此操作之前，请确保您确实要删除所有未跟踪的文件。**

也许您可以尝试`git clean -xdf`删除被忽略的目录和未跟踪的文件

2.  现在带到`HEAD`当前位置 `git reset HEAD --hard`。
3.  检查`git status`。

4.  现在创建`.gitignore`在我的情况下想要忽略名为`data`. 所以我写了`/data/`（最初`/`用于文件/文件夹，后来`/`仅用于文件夹）。

5.  现在执行 git add、commit 和 push。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2022-01-06T21:10:18.093

尽管尝试了这篇文章和其他文章中的各种建议（例如[Gitignore 不工作](https://stackoverflow.com/questions/25436312/gitignore-not-working)和[gitignore 不工作 - 被忽略？](https://stackoverflow.com/questions/33247935/gitignore-not-working-being-ignored)）我无法让 git 忽略我的 .gitignore.txt 文件中包含的文件/文件夹。

我应该强调，与许多先前的答案不同，这些答案解决了先前已提交的文件/目录将无法跟踪的问题，在我的情况下，我在进行第一次提交*之前*遇到了这个问题（即只运行了`git init`跟随由`git status`）。

还有许多其他有希望的建议，包括：

*   文本文件编码必须是 ANSI 而不是 UTF，例如 Encoding -> Notepad++ 中的 ANSI
*   Windows 的 EOL 转换，例如 Edit -> EOL Conversion -> Notepad++ 中的 Windows
*   .gitignore.txt 中的项目没有前导或尾随空格
*   定义文件夹时没有前导“/”

但没有一个适用或解决我的问题。

在尝试了创建 .gitignore.txt 文件的不同方法之后，我设法弄清楚*如何*让它工作，尽管我不能说我明白*为什么*。知道是否有人可以提供解释会很有趣。

为了那些可能还发现以前的答案没有解决他们的问题的人的利益，我将描述我尝试过的内容，无效的内容以及有效的内容。希望通过这样做也可以阐明*原因*。请注意，我使用的是 Windows 10。

**尝试 #1（失败）**

在 Windows 资源管理器中创建新的 txt 文件：

1.  （在项目文件夹中）右键->新建->文本文档
2.  将文件名更改为“.gitignore”
3.  在记事本++中打开文件，输入的文件/目录名称被忽略
4.  编码 -> ANSI [注 1]，保存更改

我跑了`git status`，但我想忽略的文件/文件夹显示为未跟踪。我在 Windows 资源管理器中检查了文件属性。正如预期的那样，文件名是“.gitignore”，文件类型是“文本文档（***.txt***）”。

*注1*：

*一些贡献者表示编码必须是 ANSI（而不是 UTF）。在记事本++中，我发现无论我执行编码-> ANSI，还是编码-> 转换为ANSI + 保存，关闭文件，然后重新打开它（在记事本++ 中），当我检查编码时，它总是报告UTF- 8\. 最终起作用的 .gitignore.txt 文件也是如此。*

**尝试#2（失败）**

在 Notepad++ 中创建新的 txt 文件：

1.  在记事本++中创建了新文件，输入了要忽略的项目
2.  另存为“.gitignore.txt”，将“保存类型”从“普通文本文件”（默认）更改为“所有类型”，并取消勾选“附加扩展名”框（默认勾选）。

我跑了`git status`，和以前一样，所有文件/目录都列在未跟踪的文件下。和以前一样，文件名是“.gitignore”，文件类型是“文本文档（***.txt***）”。

**尝试#3（成功）**

在 Notepad++ 中仍然打开相同的文件 (.gitignore.txt)：

1.  另存为“.gitignore”为“另存为类型”选择了“普通文本文件”，这会自动勾选“附加扩展名”框

我注意到创建的文件在 Windows 资源管理器中似乎没有名称。我检查了文件的属性：文件名字段为空白，文件类型为“文本文档（***.gitignore***）”。在 Windows 资源管理器（查看 -> 文件扩展名）中勾选“文件扩展名”后，“无名”文件显示“.gitignore”扩展名。

我跑了`git status`，这次我想忽略的文件/文件夹没有被列为未跟踪的文件 -*成功！*

在 Notepad++ 中打开文件我注意到编码是 UTF-8，并且文件名被标识为“.gitignore”（与 Windows 资源管理器不同）。

所以看起来 txt 文件的创建方式很微妙。也许这是 Windows 独有的特性？

# coq - 如何使用模块来隐藏 coq 中的引理？

> ID：11451536
> 
> 赞同：2
> 
> 时间：2012-07-12T12:10:02.010
> 
> 标签：coq

我有一个定理 T，它的证明，以及用于证明它的无数个引理。

我想隐藏引理，只提供定理——主要是因为我不想为引理想出好的全局名称。

我可以将定理、它的证明和引理放在一个模块中，受模块类型的限制，并且只使定理可用吗？

就像是：

```
模块类型 T_MY_T。
结束 T_MY_T。

模块 T_My_theorem：T_MY_T。
  引理 L1：...
  证明。承认。
  引理 L2：...
  证明。承认。
  定理 My_Great_Theorem: ...
  证明。申请L1；应用 L2。Qed。
结束 T_My_theorem。

```

如果是这样，有人可以发帖或指出一个简单的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:02:01.017

`Module Type A`应该包含您希望导出的定理的公理。`Module B : A`包含这些公理作为需要证明的定理。它还可以包含证明定理所需的任何引理和其他机制。要从模块外部访问定理，您可以`apply B.Theorem1`等。

# c# - .GetChanges 始终显示为空

> ID：11451538
> 
> 赞同：0
> 
> 时间：2012-07-12T12:10:18.670
> 
> 标签：c#, sql, datagridview

我正在使用 a`sqladapter`来直接从 a 更改数据库值`datagridview`。

为此，我使用以下代码：

```
private void ok_Modify_Click(object sender, EventArgs e) {
    //modify mod = new modify();
    //modify_gv.DataSource = mod.TabletoMod(tickerBox.Text, FundBox.Text);        
    connetionString = Properties.Settings.Default.TraFra;
    connection = new SqlConnection(connetionString);
    Sql = "select * from Approval where Ticker ='" + tickerBox.Text + "'";
    try {
        connection.Open();
        adapter = new SqlDataAdapter(Sql, connection);
        adapter.Fill(ds);
        connection.Close();
        modify_gv.DataSource = ds.Tables[0];
    } catch (Exception ex) {
        MessageBox.Show(ex.ToString());
    }
}

private void modify_gv_CellValueChanged(object sender, DataGridViewCellEventArgs e) {
    try {
        cmdBuilder = new SqlCommandBuilder(adapter);
        changes = ds.GetChanges();
        if(changes != null)
            adapter.Update(changes);
        //   MessageBox.Show("Changes Done");
    } catch (Exception ex) {
        MessageBox.Show(ex.ToString());
    }
} 
```

但是，每次我在 中进行更改时`datagridview`，变量“更改”始终为空。你知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:24:21.977

我认为您可能会发现 DataGridView 控件在您移出“当前”行之前不会将更改写入底层数据源 - 因此，当 CellValueChanged 事件触发时，它没有将更改写入绑定的 DataRow。

例如，如果您要处理 DataTable 对象的“RowChanged”事件，GetChanges 将返回更改的行*（您还可以观察到该事件仅在您离开正在编辑的行时触发）*。

我确信有一种方法可以强制 DataGridView 控件将更改写入底层 DataRow，但我还没有尝试过*（BeginEdit/EndEdit ？）*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-08T14:30:24.853

`ds.AcceptChanges()`之前打电话`ds.GetChanges()`

# javascript - 将多个 div 合并为一个

> ID：11451540
> 
> 赞同：2
> 
> 时间：2012-07-12T12:10:22.693
> 
> 标签：javascript, regex

我有这个

```
str = testString.replace(/<div style="(.*?)">(.*?)<\/div><div style="\1">/g, '<div style="$1">$2<br>'); 
```

它删除

```
<div style="text-align: right;">text1</div>
<div style="text-align: right;">text2</div> 
```

进入

```
<div style="text-align: right;">
    text1<br>text2
</div> 
```

伟大的！

如果我有多个`<div>`怎么办？

我该怎么做

```
<div style="text-align: right;">text1</div>
<div style="text-align: right;">text2</div>
<div style="text-align: right;">text3</div>
<div style="text-align: right;">text4</div> 
```

进入

```
<div style="text-align: right;">
    text1<br>text2<br>text3<br>text4
</div> 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:25:02.050

假设您已经`first`从 DOM 中选择了元素...

```
var next = first.nextElementSibling;

while (next && next.nodeName.toUpperCase() === "DIV") {
    first.appendChild(document.createElement('br'))
    first.appendChild(next.firstChild)
    next = next.nextElementSibling
} 
```

* * *

刚刚意识到我们没有从 DOM 中删除空 div。如果你愿意，你可以这样做......

```
var next;

while ((next = first.nextElementSibling) && next.nodeName.toUpperCase() === "DIV") {
    first.appendChild(document.createElement('br'))
    first.appendChild(next.firstChild)
    next.parentNode.removeChild(next);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:21:15.843

您不能将正则表达式用于复杂的 HTML 操作！请看[这个问题](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。您可以使用 jQuery 操作 DOM 来实现相同的结果！

**[请参阅此 jsfiddle 示例以获取可能的替代方法。](http://jsfiddle.net/6y5H2/)**

这是小提琴中的 jQuery 代码，假设所需的 div 位于带有 id 的包装 div 中`toParse`。

```
$('body').ready(function() {

var template = $('#toParse div').first().clone();

var result = "";
$('#toParse div').each(function(index, element) {
    result += $(element).html();
    result += "<br/>";
});

// you can add some extra code here to remove that 
// extra final <br/>

$('#toParse').html($(template).html(result));
console.log(result); 
});​ 
```

# jsf - 在 Web 应用程序中处理文件

> ID：11451541
> 
> 赞同：0
> 
> 时间：2012-07-12T12:10:24.473
> 
> 标签：jsf

在我的 Web 应用程序中，我正在创建一个最终用户将下载的文件。该文件应存储在内存中，直到用户下载为止。

所以我使用 File.createTempFile() 来完成这个任务。

这是一个好方法，还是有更好的创建文件的原因？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:15:27.870

我发现这是一个好方法，但您必须知道创建临时文件实际上意味着该文件是[在磁盘上创建的](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#createTempFile%28java.lang.String,%20java.lang.String,%20java.io.File%29)，而不是在内存中。

在[VM 终止时删除它](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#deleteOnExit%28%29)可能是另一个好的步骤。

# c++ - 使用 boost::program_options 解析配置文件

> ID：11451549
> 
> 赞同：4
> 
> 时间：2012-07-12T12:10:51.347
> 
> 标签：c++, boost, boost-program-options

再会，

我编写了一个类来通过 boost::program_options 解析配置文件。这是我所拥有的（缩短）：

```
namespace nsProOp = boost::program_options;
nsProOp::variables_map m_variableMap;
nsProOp::options_description m_description;

// To add options to the variableMap, e.g. "addOption<int>("money_amount");"
template <class T>
    void addOption(const std::string& option, const std::string& helpDescription = "") {
        m_description.add_options()(option.c_str(), nsProOp::value<T > (), helpDescription.c_str());
    }

// And this is how i actually read the file:
void ConfigFile::parse() {
    std::ifstream file;
    file.open(m_pathToFile.c_str());

    nsProOp::store(nsProOp::parse_config_file(file, m_description, true), m_variableMap);
    nsProOp::notify(m_variableMap);      
} 
```

好的，这很好用。但我希望能够再次解析同一个文件，以便我始终使用用户提供的最新条目！升压文档说关于“商店”：

> “将在 'options' 中定义的所有选项存储在 'm' 中。如果 'm' 已经具有选项的非默认值，则该值不会更改，即使 'options' 指定了某个值。”

所以，如果我再次调用“parse()”，什么都不会发生，因为 m_variableMap 已被填充。我尝试调用 m_variableMap.clear() 并不能解决我的问题，因此 store 只能在第一次工作。

有人给我建议吗？如果我的问题不清楚，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T13:40:22.000

至少在 boost 1.50 中，`variables_map::clear()`将允许通过`store`. 至少可以追溯到 boost 1.37 的另一种解决方案是在调用之前将默认构造的变量映射分配给变量映射`store`。

```
void ConfigFile::parse() {
  std::ifstream file;
  file.open(m_pathToFile.c_str());
  m_variableMap = nsProOp::variables_map(); // Clear m_variableMap.
  nsProOp::store(nsProOp::parse_config_file(file, m_description, true), 
                 m_variableMap);
  nsProOp::notify(m_variableMap);      
} 
```

* * *

这是一个示例程序：

```
#include <boost/program_options.hpp>
#include <iostream>
#include <fstream>
#include <string>

namespace po = boost::program_options;

void write_settings(const char* value)
{
  std::ofstream settings_file("settings.ini");
  settings_file << "name = " << value;
}

void read_settings(po::options_description& desc,
                   po::variables_map& vm)
{
  std::ifstream settings_file("settings.ini");

  // Clear the map.
  vm = po::variables_map();

  po::store(po::parse_config_file(settings_file , desc), vm);
  po::notify(vm);    
}

int main()
{
  std::string name;

  // Setup options.
  po::options_description desc("Options");
  desc.add_options()
    ("name", po::value<std::string>(&name), "name");
  po::variables_map vm;

  // Write, read, and print settings.
  write_settings("test");
  read_settings(desc, vm);
  std::cout << "name = " << name << std::endl;

  // Write, read, and print newer settings.
  write_settings("another test");
  read_settings(desc, vm);
  std::cout << "name = " << name << std::endl;
} 
```

产生以下输出：

```
名称 = 测试
名称 = 另一个测试
```

# asp.net - 带有超链接的回发

> ID：11451556
> 
> 赞同：0
> 
> 时间：2012-07-12T12:11:21.807
> 
> 标签：asp.net, c#-3.0

我们有一个旧网站，几个不同的用户可以登录并在网格视图中查看分配给他们的任务列表。每个任务当前都使用链接按钮上的命令链接到单独的详细信息页面。要阻止用户只需在查询字符串中键入任务 ID 并查看其他用户任务，每次单击链接时都会将会话变量设置为命令的一部分。一些用户现在要求能够右键单击任务链接并选择打开新选项卡/窗口，就像使用超链接一样。

似乎无论如何都没有使用链接按钮或回发并使用超链接设置会话变量来执行此操作。

是否有关于如何执行此操作的任何建议，或者阻止用户在没有会话变量的情况下查看其他任务，或者在同一选项卡中打开链接，或者首先打开带有回发的新选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:52:42.930

在任务详情页面，您可以在 Page_Load 方法中添加逻辑，以检查用户是否有权查看请求的任务。如果他没有权限，您可以使用 Response.Redirect 将他重定向到其他地方 - 例如，任务列表页面或“权限被拒绝”页面。

# matlab - for循环在matlab中不起作用

> ID：11451557
> 
> 赞同：0
> 
> 时间：2012-07-12T12:11:23.623
> 
> 标签：matlab, loops, for-loop

我正在尝试在同一张图上绘制两个数据集。两个数据都是同一天的，两种情况下的 x 轴都是包含日期和时间的时间馈送（格式为 dd:mm:yyyy hh:mm:ss）。然而，在这两种情况下，观察的数量可能不同，观察值的时间也可能不同。当我分别为文件夹中的每个 excel 文件进行绘图时，代码工作正常。但是我必须为整个月的每一天绘制相同类型的图（每个图将基于一个文件中的数据）。所以，我把代码放在一个for循环中。但令我大吃一惊的是，addaxis 将不再起作用。我得到的错误是：

```
Error in ==> addaxis at 108
hplt = plot(varargin{:});

Error in ==> crossplot at 17
addaxis(putdata.datenos,calldata.ltp,'r-'); 
```

其中 crossplot 是我的脚本文件的名称。addaxis 是我从文件交换中下载并安装的一个功能。它基本上提供了一种在同一图中绘制两个或多个不同轴的便捷方式。

现在我知道每种情况下数据点的数量都不同。但是当我为工作区中的每个文件单独运行代码时，代码仍然可以正常工作。当我将它放入 for 循环时，它只会给出错误。你能帮我解决这个问题吗？我完全被发生了什么弄糊涂了？我正在使用的代码如下：

```
cd('H:/heckyl intern/no analysis/pivots/ce 5200 28 jun');

callnames=dir('*.xlsx');

cd('H:/heckyl intern/no analysis/pivots/pe 5200 28 jun');

putnames=dir('*.xlsx');

for i=1:length(callnames)
    calldata=csv2struct(['H:/heckyl intern/no analysis/pivots/ce 5200 28 jun/' 
                        callnames(i).name]);
    putdata=csv2struct(['H:/heckyl intern/no analysis/pivots/pe 5200 28 jun/' 
                        putnames(i).name]);
    [tempname remain]=strtok(callnames(i).name,'.');
    figname=[tempname '.fig'];
    calldata.datenos=datenum(calldata.xchangefeedtime);
    putdata.datenos=datenum(putdata.xchangefeedtime);
    plot(calldata.datenos,calldata.ltp);
    addaxis(putdata.datenos,calldata.ltp,'r-');
    saveas(gcf,figname);
    close(gcf);
end 
```

PS：很抱歉长时间的询问。但我是 matlab 的新用户，不知道整个 Matlab 行话。这是我在这个板上的第一个问题。无论如何，提前感谢您帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:35:06.043

我不知道 addaxis，我的 Matlab 没有。它是文件交换之外的那个吗？你可以只使用绘图并保持，你不需要 addaxis 的声音。尝试这个：

```
 for i=1:length(callnames)
        calldata=csv2struct(['H:/heckyl intern/no analysis/pivots/ce 5200 28 jun/' 
                            callnames(i).name]);
        putdata=csv2struct(['H:/heckyl intern/no analysis/pivots/pe 5200 28 jun/' 
                            putnames(i).name]);
        [tempname remain]=strtok(callnames(i).name,'.');
        calldata.datenos=datenum(calldata.xchangefeedtime);
        putdata.datenos=datenum(putdata.xchangefeedtime);
        plot(calldata.datenos,calldata.ltp);
        hold on;
        plot(putdata.datenos,calldata.ltp,'r-')
        figname=[tempname '.fig'];
        saveas(gcf,figname);
        close(gcf);

    end 
```

# java - 为什么在eclipse中调试jdk库，看不到局部变量值？

> ID：11451558
> 
> 赞同：10
> 
> 时间：2012-07-12T12:11:25.867
> 
> 标签：java, eclipse, debugging

问题是在调试 java 库类时，例如 HashSet 函数，我看不到局部变量。在`variables`选项卡上，我只能看到函数参数和*this*的字段。当我尝试将局部变量添加到 时`watch`，eclipse 说：“评估期间出错”。

所以我的问题是为什么会发生这种情况？我怎样才能看到那些局部变量的值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:31:24.900

长话短说，JDK 发行版没有使用调试信息进行编译。

检查这些问题的答案：

*   [如何调试JDK源](https://stackoverflow.com/questions/10498282/how-to-debug-jdk-source)
*   [如何使用 Eclipse 检查调试符号状态？](https://stackoverflow.com/questions/6203321/how-can-i-check-on-debug-symbol-status-with-eclipse)

# c# - 如何正确使用 BindIPEndPointDelegate？

> ID：11451559
> 
> 赞同：1
> 
> 时间：2012-07-12T12:11:34.893
> 
> 标签：c#, sockets, httpwebrequest, ip

这是我用于 BindIPEndPointDelegate 的代码：

```
 ServicePoint servicePoint,
    IPEndPoint remoteEndPoint,
    int retryCount)
      {
          if (lastIpEndpoint != null)
          {
              return lastIpEndpoint;
          }
          var candidates =
              GetAddresses(remoteEndPoint.AddressFamily);
          if (candidates == null || candidates.Count() == 0)
          {
              throw new NotImplementedException();
          }

          return
              lastIpEndpoint = new IPEndPoint(candidates[rnd.Next(candidates.Count())], remoteEndPoint.Port);
      };

    static IPAddress[] GetAddresses(AddressFamily af)
    {
        System.Net.IPHostEntry _IPHostEntry = System.Net.Dns.GetHostEntry(System.Net.Dns.GetHostName());
        return (from i in _IPHostEntry.AddressList where i.AddressFamily == af select i).ToArray();
    } 
```

无论我做什么，我都会收到以下错误：

```
System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: The requested address is not valid in its context 173.194.39.68:80
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception)
   --- End of inner exception stack trace ---
   at System.Net.HttpWebRequest.GetResponse()
   at Webs.Web.SimpleGetResponseString(String uri, String& userAgent, List`1 redirectpath) 
   atWebs.Web.Get(String uri) 
   at test.Program.Main(String[] args)
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T11:27:28.093

BindIPEndPointDelegate 用于选择一个**本地**端点来发出请求，而不是选择远程端点。

当您需要来自某个 IP 地址或某个端口范围的请求时，这很有用。

# iphone - iPhone：应用商店中的应用名称和捆绑名称必须相似？

> ID：11451561
> 
> 赞同：3
> 
> 时间：2012-07-12T12:11:47.857
> 
> 标签：iphone, app-store, bundle

> **可能重复：**
> [iPhone：我可以使用简单名称作为捆绑名称和捆绑显示名称吗？](https://stackoverflow.com/questions/11450740/iphone-can-i-use-simple-name-for-bundle-name-and-bundle-display-name)

这是合理的，`app name at app store`并且`bundle display name(name on home screen)`必须是相似的。
因为它们都显示给用户。

但`bundle name`不会向用户显示。
你也需要做`bundle name`类似的`app name at app store`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:19:10.517

它们不必完全相同。例如，您的应用在应用商店中的名称可能是：`Tweet Helper Unlimited Genuine Edition`. 您的 bundle-name 可以是：`Tweet Helper Unlimited`和您的 bundle display name `Tweet Helper`。这样就好了。

当然，它们应该“几乎”相似，只要不要像这样不匹配： Appstore name: `Tweet Helper Unlimited Genuine Edition`，而 bundle (displayname) 类似于`Dog Personalizer`. 这会让你的应用被拒绝。

你明白我的意思吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:18:38.327

`Bundle Display`您的应用程序名称和您在**iTunesConnect**中输入的名称应该相同。如果两者不同，Apple 可能会拒绝您的申请。`Bundle Display`应用商店中应用程序的不同名称和名称可能会导致用户混淆。这就是苹果阻止这种情况的原因。

# character-encoding - Angularjs 请求编码和坏字符（在 FF 中工作正常）

> ID：11451563
> 
> 赞同：5
> 
> 时间：2012-07-12T12:11:50.297
> 
> 标签：character-encoding, http-headers, xmlhttprequest, angularjs

根据浏览器，我对请求的编码有一些问题。

下面的转储显示了 FF 和 Chrome 之间不同的标头（我删除了所有相同的标头）。查看“搜索”值的表示：

**火狐：好的**

```
Accept-Language: es-ar,es;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/json;charset=utf-8

POST: {"data":{"size":10,"search":"José","order":"name","page":1}} 
```

**铬：不好**

```
Pragma: no-cache
Cache-Control: no-cache
Origin: http://localhost
Content-Type: application/json;charset=UTF-8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: es-ES,es;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

POST: {"data":{"size":10,"search":"JosÃ©","order":"name","page":1}} 
```

**IE 不工作**

我试图强制 $http 中的 Content-Type，但没有。两个浏览器中的响应都可以正常工作。我在 Win 7“por si las moscas”上使用 Apache。

重要提示：请求在发送到服务器之前格式错误，我从 Firebug 和 Chrome 检查中获取上述标头。

任何想法？谢谢！

何塞

**更新**

我对帖子进行 url 编码，并在服务器中解码，我注意到使用 UTF-8 的 url 解码工作不好，但使用 ISO-8859-1 工作正常。然后浏览器发送带有 ISO-8859-1 的帖子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-13T20:50:20.540

根据[w3 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.2)，当未指定任何内容或不存在标头时，charset`ISO-8859-1`是默认值`Accept-Charset`。其他字符集可能会搞砸事情。

尝试取消定义该标题：

```
$http({
   method: 'POST',
   url: '/page.html',
   headers: { 'Accept-Charset': undefined }
})
.success(function(){ /*success fn here*/  }); 
```

# php - 两个不同日期之间的日期数组

> ID：11451565
> 
> 赞同：1
> 
> 时间：2012-07-12T12:11:53.863
> 
> 标签：php

我目前正在编写供我个人使用的日历脚本。因此我需要你的帮助:-)

我有两个格式为 YYYY-MM-DD 的日期。

例如：

```
2012-05-12 and
2012-05-16 
```

我需要的是他们之间的日期：

```
2012-05-13
2012-05-14
2012-05-15 
```

输出应该在一个数组中。我现在不知道如何开始......所以你有提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:18:50.320

这是 OOP 方法，您应该使用它：

```
$a = new DateTime('2012-05-12');
$b = new DateTime('2012-05-16');

// to exclude the end date (so you just get dates between start and end date):
// $b->modify('-1 day');

$period = new DatePeriod($a, new DateInterval('P1D'), $b, DatePeriod::EXCLUDE_START_DATE);

foreach($period as $dt) {
  echo $dt->format('Y-m-d');
} 
```

如需进一步阅读，请参阅[DateTime](http://php.net/datetime)、[DateInterval](http://php.net/dateinterval)和[DatePeriod](http://php.net/dateperiod)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:15:41.883

```
$date =  date("Y-m-d", strtotime("2012-05-12"));
$final_date = date("Y-m-d", strtotime("2012-05-16"));
while($date < $final_date){
   $date = date("Y-m-d", strtotime($date . " +1 day"));
   $dates[] = $date;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:17:19.920

```
function GetDays ($sStartDate, $sEndDate ) {  
  $sStartDate = gmdate( 'Y-m-d', strtotime( $sStartDate ) );  
  $sEndDate = gmdate( 'Y-m-d', strtotime( $sEndDate ) );  

  $aDays[] = $sStartDate;  

  $sCurrentDate = $sStartDate;  

  while( $sCurrentDate < $sEndDate ) {  
    $sCurrentDate = gmdate( 'Y-m-d', strtotime( '+1 day', strtotime( $sCurrentDate) ) );  

    $aDays[] = $sCurrentDate;  
  }  

  return $aDays;  
}  

print_r ( '2012-05-12', '2012-05-16' ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T12:19:49.533

```
function getDates($startTime, $endTime) {
    $day = 86400;
    $format = 'Y-m-d';
    $startTime = strtotime($startTime);
    $endTime = strtotime($endTime);
    //$numDays = round(($endTime - $startTime) / $day) + 1;
    $numDays = round(($endTime - $startTime) / $day); // remove increment 

    $days = array();

    for ($i = 1; $i < $numDays; $i++) { //change $i to 1
        $days[] = date($format, ($startTime + ($i * $day)));
    }

    return $days;
}

$days = getDates('2012-05-12', '2012-05-16'); 
```

输出：

```
Array
(
    [0] => 2012-05-13
    [1] => 2012-05-14
    [2] => 2012-05-15
) 
```

正如 Dan Lee 所说，我将函数更改为仅获取日期间隔，不包括数组中的第一天和最后一天。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:20:20.010

这是代码：

```
function createDateRangeArray($strDateFrom,$strDateTo)
    {
        // takes two dates formatted as YYYY-MM-DD and creates an
        // inclusive array of the dates between the from and to dates.

        // could test validity of dates here but I'm already doing
        // that in the main script

        $aryRange=array();

        $iDateFrom=mktime(1,0,0,substr($strDateFrom,5,2),     substr($strDateFrom,8,2),substr($strDateFrom,0,4));
        $iDateTo=mktime(1,0,0,substr($strDateTo,5,2),     substr($strDateTo,8,2),substr($strDateTo,0,4));

        if ($iDateTo>=$iDateFrom)
        {
            array_push($aryRange,date('Y-m-d',$iDateFrom)); // first entry
            while ($iDateFrom<$iDateTo)
            {
                $iDateFrom+=86400; // add 24 hours
                array_push($aryRange,date('Y-m-d',$iDateFrom));
            }
        }
        return $aryRange;
    } 
```

我参考了[这个](http://boonedocks.net/mike/archives/137-Creating-a-Date-Range-Array-with-PHP.html)网站。

# android - 一致地运行两个或多个服务的最佳实践是什么？

> ID：11451566
> 
> 赞同：1
> 
> 时间：2012-07-12T12:12:04.463
> 
> 标签：android, service

一致地运行两个或多个服务的最佳实践是什么？

例如： **REST**服务检索一些数据，如果有一些新的东西**下载**服务应该运行？

我在第一个完成后向接收器发送广播，接收器从意图中获取数据并将其发送到第二个服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:45:13.750

您也可以直接`Intent`从 the发送 an到 the ，而无需将 the 放在它们两者之间。`RestService``DownloadService``BroadcastReceiver`

我认为[`IntentService`](http://developer.android.com/reference/android/app/IntentService.html)这对你来说是一个更好的方法`DownloadService`。

> IntentService 是按需处理异步请求（表示为 Intent）的服务的基类。客户端通过 startService(Intent) 调用发送请求；该服务根据需要启动，使用工作线程依次处理每个 Intent，并在工作结束时自行停止。
> 
> 这种“工作队列处理器”模式通常用于从应用程序的主线程卸载任务。IntentService 类的存在是为了简化这种模式并处理机制。要使用它，请扩展 IntentService 并实现 onHandleIntent(Intent)。IntentService 将接收 Intent，启动工作线程，并酌情停止服务。
> 
> 所有请求都在单个工作线程上处理——它们可能需要尽可能长的时间（并且不会阻塞应用程序的主循环），但一次只会处理一个请求。

**编辑：**忘了提到，因为`API Level 9`Android 有一个[`DownloadManager`](http://developer.android.com/reference/android/app/DownloadManager.html)类可以处理您的下载，在失败、连接更改等后重试它们。

# java - 警报声 - 并不总是播放

> ID：11451568
> 
> 赞同：2
> 
> 时间：2012-07-12T12:12:08.843
> 
> 标签：java, android

我正在编写一个报警程序。其中大部分似乎工作正常。我可以设置闹钟响起的时间。当这个时间到来时，我的广播接收器会启动一个活动，该活动会振动、发出声音并显示一个按钮以允许用户停止声音。当我运行程序时，我可以将闹钟设置为在一两分钟内响起。然后我可以退出警报程序并运行其他程序。果然，闹钟时间到了，我被闹钟活动打断，手机震动，闹钟响起，我看到了按钮。即使将媒体音量调低，我也能听到声音。

问题是如果手机处于睡眠状态，那么在闹钟时间手机会振动，但我听不到任何声音。当我唤醒手机时，我正确地看到了屏幕上的按钮。

我查看了大量不同的代码片段，了解如何发出警报声。它们看起来都异常复杂，而且彼此之间有着惊人的不同。我不完全理解其中任何一个。我使用的是下面显示的几个片段的集合：

```
alarm_sound = new MediaPlayer();

Uri alert = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_ALARM);
if(alert == null){
    // alert is null, using backup
    alert = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
    if(alert == null){  // I can't see this ever being null (as always have a default notification) but just incase
        // alert backup is null, using 2nd backup
        alert = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_RINGTONE);               
    }
}

 try {
        alarm_sound.setDataSource(this, alert);
    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
 final AudioManager audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
 if (audioManager.getStreamVolume(AudioManager.STREAM_ALARM) != 0) 
 {

                alarm_sound.setAudioStreamType(AudioManager.STREAM_ALARM);
                alarm_sound.setLooping(true);
                try {
                    alarm_sound.prepare();
                } catch (IllegalStateException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                alarm_sound.start();
  } 
```

谁能告诉我如何更正我的代码以使其正常响铃……或者给我一个*简单*解释它的网站的网络链接。

**编辑：**我认为也许可以通过先唤醒电话来解决问题。为此，我在任何振动警报之前添加了以下代码：

```
PowerManager pm = (PowerManager) getApplicationContext().getSystemService(Context.POWER_SERVICE);
WakeLock wakeLock = pm.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
wakeLock.acquire();

PowerManager pm2 = (PowerManager) getApplicationContext().getSystemService(Context.POWER_SERVICE);
WakeLock wakeLock2 = pm2.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
wakeLock2.acquire(); 
```

我还在清单中添加了以下内容：

```
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.DISABLE_KEYGUARD" /> 
```

这段代码似乎只工作了一半——手机确实在屏幕亮起时唤醒了，但锁仍然打开，即我必须自己执行滑动解锁操作。而且只是雪上加霜，警报器仍然没有发出声音:-(

**编辑：：**我刚刚`getWindow().addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);` 为我的主窗口添加了。这绕过了锁定问题 - 但仍然没有声音。

# c# - 多线程 - 产生多个线程并等待

> ID：11451575
> 
> 赞同：1
> 
> 时间：2012-07-12T12:12:28.937
> 
> 标签：c#, multithreading

我需要一些关于多线程的建议。

示例：我想生成 200 个线程，每个线程都应该从网站上抓取一张不同的图片（该网站有点慢）。但应该有最大值。一次 40 个线程。

任何的想法？

我期待一些答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:51:37.680

您可以轻松地使用`ThreadPool`它。池在管理线程方面做得很好，但如果你*真的*必须限制你可以使用的最大数量：

```
ThreadPool.SetMaxThreads(40, 40);

// submit 200 tasks to the pool
for(int i = 0; i < 200; i++)
{
   ThreadPool.QueueUserWorkItem(
       () =>
       {
           // code for each task
       });
} 
```

不幸的是，没有内置的方法可以等待任务完成，所以你只需要即兴创作一些东西。如果您有权访问 .NET 4.0，您可以查看`Parallel.For`：

```
ParallelOptions po = new ParallelOptions();
po.MaxDegreeOfParallelism = 40;
Parallel.For(0, 200, po,
   i =>
   {
      // code for each task
   }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:14:22.807

使用一个线程安全的队列，里面装满了你想要的所有 URL。

创建 40 个线程，其任务是从该队列中获取下一个项目并从 URL 下载。当队列为空时，线程应该完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:24:28.890

尝试

```
SlimSemaphore slm=new SlimSemaphore(40);

slm.Wait()

[your code]

slm.Release(); 
```

这将只允许一次执行 40 个线程。

注意：SlimSemaphore（如果使用 .Net 框架 4.0）else Semaphore

```
 only efficiency difference is there 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:48:03.673

您可以使用您创建并提供给 Parallel.ForEach 循环的 ParallelOptions 对象设置 MaxDegreeParallelism。稍后当我再次使用正确的键盘时，我将粘贴一些代码。

# css - IE9 CSS 优先级...错误？

> ID：11451578
> 
> 赞同：1
> 
> 时间：2012-07-12T12:12:43.213
> 
> 标签：css, internet-explorer, firefox, operator-precedence

我有两个 CSS 规则：

```
.avo-lime-table th,
.avo-lime-table td {  
  background-color: grey;
} 
```

规则二

```
.avo-lime {
  background-color: green; 
} 
```

在 FireFox、Chrome、Opera 和 Safari 中一切正常。显然，微软的浏览器（一如既往）对渲染我的页面有一些不同的想法......

```
<div class="avo-center-shrink">
  <form method="post" action="/someformAction">
    <table class="avo-lime-table">
      <colgroup>
        <col>
        <col>
      </colgroup>
      <thead>
        <tr><th colspan="2" class="avo-lime">Login form heading here</th></tr>
      </thead>
      <tfoot>
        <tr><td colspan="2">submit button here</td>
      </tr></tfoot>    
      <tbody>
        <tr>
          <th class="avo-lime-h unselectable" scope="row">Login:</th>
          <td class="avo-light-h">login input here</td>
        </tr>
      </tbody>
    </table>
  </form>
</div> 
```

在上面的代码中，我跳过了一些对于这个例子来说并不重要的 's 。

它应该看起来如何（Firefox）：

![它应该看起来如何（Firefox）](../Images/ba8a952c552287323e69b2029c610a26.png)

它的外观（IE9）：

![外观 (IE9)](../Images/bf33e58ae264c6756dc0feee26b8cf90.png)

# 为什么第一条规则比第二条更具体（针对 IE）？

如何在 IE 中解决这个问题？我尝试了不同的东西：

```
**.avo-lime, .avo-lime-table th.avo-lime** { background-color: darkgreen; // fallback background color
 //here some gradients } 
```

但它不起作用！

# 编辑：

好的，看来我必须清除浏览器缓存两次，因为由于某种原因它在第一次之后没有更新 CSS 文件。

因此，**avo-lime-table th**比**.avo-lime**更具体的所有答案都是正确的，将其更改为**th.avo-lime**就可以了。

我会给每个人一个 +1 并标记回答第一个正确答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:38:16.300

**对于您的实际问题：**删除

```
filter: progid:dximagetransform.microsoft.gradient(enabled=false); 
```

它会在 IE9 中正常工作。

**关于 css-rule 优先级：**

规则

```
.avo-lime-table th 
```

优先级高于

```
.avo-lime 
```

因为它包含一个类选择器和一个高于仅一个类选择器的元素选择器。这不仅适用于 IE，也适用于所有其他浏览器。

为了给它更高的优先级，将其更改为

```
th.avo-lime 
```

现在这两个规则具有相同的特异性，但是第二个规则通过简单的级联覆盖了第一个规则（样式表中稍后声明的规则会覆盖以前的规则）

阅读有关[css 选择器特异性](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)的更多信息以了解这个复杂的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:36:56.243

你的问题有些地方不太对劲。

CSS规则：

```
.avo-lime { ... 
```

需要是

```
th.avo-lime { ... 
```

如果您希望它优先于其他规则。但在 Firefox 中也是如此。

这是[JSFiddle 示例](http://jsfiddle.net/Sohnee/nnCKJ/)`th`，您可以从中删除前导`th.avo-lime`以在 Firefox 中查看。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T12:39:38.157

您似乎正在禁用渐变，然后想知道为什么它没有显示渐变。

如果不是这样，那么答案是因为`.avo-lime-table td`比 更具体`.avo-lime`，所以优先。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T12:42:41.910

我在我的电脑上试过

只需删除`filter: progid:dximagetransform.microsoft.gradient(enabled=false);`

那是因为它覆盖了以前的属性`filter: progid:dximagetransform.microsoft.gradient(startColorstr='#46ae0e', endColorstr='#a5e54b', GradientType=0);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:52:46.043

请注意，您对`background-image`规则所做的不是根据浏览器设置背景图像，而是现在每一`background-image`行都会覆盖之前定义的行。背景在除 IE 之外的所有浏览器中都有效的原因是其他浏览器。

要确保`ms-`规则适用于 IE，您应该添加

```
.avo-lime {
    background-image: -ms-linear-gradient(top, #46ae0e, #a5e54b 85%);
} 
```

到在此之后加载的 css 文件或`<style>`标记，并且仅在 IE 是客户端的浏览器时才加载它，借助您的服务器端脚本语言或条件注释（注意：我听说后者将不再受支持从 IE10 开始）。

# command-line-arguments - 在 Visual C++ 中调试时设置命令行参数的格式

> ID：11451579
> 
> 赞同：2
> 
> 时间：2012-07-12T12:12:47.093
> 
> 标签：command-line-arguments, visual-c++-2010

我可以看到这或多或少得到了回答，但由于某种原因它不起作用。我正在使用 Visual C++ 2010 调试控制台应用程序。它需要一些输入参数，因此`Configuration Properties > Debugging > Command Arguments`我设置了这些参数。但是，由于某种原因，如果框中的输入是`"-r 700 -i data\military.pri -v on"`argc = 2 并且它们被错误地解析。

会不会是我格式不对？我在任何地方都需要“、”或逗号吗？

还是格式错误不可能是其他地方的问题？当使用相同的参数通过命令提示符运行它时，它可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:22:31.513

确保您输入命令行参数的构建配置（DEBUG/RELEASE/您创建的任何其他配置）与您实际运行的配置相匹配。如果您为 DEBUG 构建设置命令行参数，然后在 RELEASE 模式下运行，您将无法获得正确的参数。

这可能是你的问题吗？

# delphi - TClientDataset - 是否可以按 unicode 列名过滤？

> ID：11451580
> 
> 赞同：4
> 
> 时间：2012-07-12T12:12:51.630
> 
> 标签：delphi, filter, delphi-2009, tclientdataset

我有一个 TClientDataset 可以包含非 ascii 字符的列名。似乎我无法过滤这些列。这是一个示例代码：

```
uses
  DB, DBClient;

{$R *.dfm}

procedure TForm34.FormActivate(Sender: TObject);
var
  MyDataset: TClientDataSet;
begin
  MyDataset := TClientDataSet.Create(nil);
  with MyDataset.FieldDefs.AddFieldDef do
  begin
    Name := 'PLACÓWKA';
    DataType := ftString;
  end;
  MyDataset.CreateDataSet;
  MyDataset.Open;
  MyDataset.Append;
  MyDataset.Fields[0].Value := 'Value_1';
  MyDataset.Post;
  MyDataset.Append;
  MyDataset.Fields[0].Value := 'Value_2';
  MyDataset.Post;
  MyDataset.Filter := 'PLACÓWKA LIKE ''%Value_1%''';
  MyDataset.Filtered := True; //Exception here: Field 'PLAC' not found
end; 
```

设置后`MyDataset.Filtered := True`出现异常，提示未找到“PLAC”字段。

据我所知，问题在于单元中的方法`TExprParser.SetExprParams`无法`DBCommon`正确解析过滤器文本。

除了重命名列之外，我还能做些什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:11:52.607

对于非 ansi 字符，您应该使用带引号的标识符，每个数据库都有其默认值，在 MSSQL 中，它是大括号**[ ]**，例如：**[ PLACÓWKA ]**。

如果您不使用 MSSQL，您应该检查您的数据库文档以获取适当的引号字符。

# python - Python Mechanize - unescape_charref() 无法处理十六进制代码

> ID：11451583
> 
> 赞同：0
> 
> 时间：2012-07-12T12:13:01.937
> 
> 标签：python, escaping, mechanize

我在 Mechanize 中遇到了一个有趣的错误，我不确定将其作为错误提交，或者需要寻找解决方法。

打开（错误地？）包含带有十六进制代码的转义字符的页面会导致 ValueError。以下代码重现了该错误：

```
import mechanize
b = mechanize.Browser()
gr = 'http://www.goodreads.com/'
b.open(gr + 'book/show/613791.Santuario_De_La_Pen_X303_A_De_Francia') 
```

经过长时间的 Traceback 后，报告如下：

```
File "C:\Python27\lib\site-packages\mechanize\_html.py", line 317, in unescape_charref
  uc = unichr(int(name, base))
ValueError: invalid literal for int() with base 10: 'X303' 
```

我猜这是因为 unescape_charref() 需要一个二进制字符代码（例如 #771），而这个页面使用的是十六进制代码 #X303。有没有办法让 Mechanize 妥善处理这个问题？

在这种情况下，我实际上并不太关心正确的取消转义，因为我只想从此类页面的 head 元素中检索一个 URL。我想捕捉 ValueError 并继续获取响应。不幸的是，Mechanize 无法处理这个问题并返回 None。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:30:18.573

你应该报告它。

在短期内，您可以将源文件中的该行修改为如下内容：

```
try:
    uc = unichr(int(name, base))
except ValueError:
    if base == 10 and name[0].lower() == "x":
        uc = unichr(int(name[1 : ], 16))
    else:
        raise 
```

# ruby-on-rails - 从 Rails 的数组中收集唯一的活动记录对象？

> ID：11451584
> 
> 赞同：1
> 
> 时间：2012-07-12T12:13:08.687
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个返回超过 50k 记录的查询结果。我愿意 ：

```
@array.collect {|x| x.field_name1}.uniq, @array.collect {|x| x.field_name2}.uniq 
```

..为视图中的多个选择创建过滤器。这需要相当长的时间。有什么方法可以在一个循环中收集所有独特元素以提高性能？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-12T12:47:59.603

用于选择唯一列值的纯 Ruby/Rails 方法（没有硬编码 SQL）将是：

```
uniq_fields1 = Model.uniq.pluck(:field_1)
# issues: SELECT DISTINCT field_1 FROM "models" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:26:23.007

就像是

```
unique_field_1_values = Set.new
unique_field_2_values = Set.new
@array.each do |x|
  unique_field_1_values << x
  unique_field_2_values << x
end 
```

仅遍历数组一次，并为您提供两个具有该字段唯一值的集合。不确定它是否更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:54:23.317

按照@tokland 的评论：

```
[:field1, :field2].map { |f| YourTable.select(f).uniq } 
```

正如@Frederick 所指出的，这确实是对数据库的两次点击，但（可能）会更快，并且如果您在这些字段上有索引，几乎肯定会更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T10:00:07.620

如果我没有误解这个问题，`uniq`也应该给你独特的对象：

```
array_of_objects.uniq 
```

[文档](https://ruby-doc.org/core-2.2.0/Array.html#method-i-uniq)

# php - echo 巨大的sql查询结果

> ID：11451588
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:13:19.743
> 
> 标签：php, sql, echo, large-data

我有一个连接许多列的查询。我认为它目前足够快（结果为 5000 行），但如果条目数量增加怎么办？

如果我想通过 PHP`echo`语句显示结果，页面会重载...

我该怎么做才能显示这样大的结果？

这是我的 SQL 查询：

```
SELECT DISTINCT 
    dominios.dominio as dominio, 
    dominios.id_dominio as id_dominio, 
    dominios.data_insercao as data_insercao, 
    datas.data_insercao as data_insercao, 
    datas.data_expiracao as data_expiracao, 
    dnss.record1 as dns1, 
    entidades_gestoras.nome as ent_nome, 
    entidades_gestoras.email as ent_email, 
    estados.estado as estado, ips.ip as ip, 
    responsaveis_tecnicos.nome as resp_nome, 
    responsaveis_tecnicos.email as resp_email, 
    titulares.nome as tit_nome, 
    titulares.morada as tit_morada, 
    titulares.email as tit_email, 
    titulares.localidade as tit_localidade, 
    titulares.cod_postal as tit_postal 
from 
    dominios 
        left join datas 
            on dominios.id_dominio=datas.id_dominio 
        left join dnss 
            on dominios.id_dominio=dnss.id_dominio 
        left join entidades_gestoras 
            on dominios.id_dominio=entidades_gestoras.id_dominio 
        left join estados 
            on dominios.id_dominio=estados.id_dominio 
        left join ips 
            on dominios.id_dominio=ips.id_dominio 
        left join quantidade_dnss 
            on dominios.id_dominio=quantidade_dnss.id_dominio 
        left join responsaveis_tecnicos 
            on dominios.id_dominio=responsaveis_tecnicos.id_dominio 
        left join titulares 
            on dominios.id_dominio=titulares.id_dominio 
```

是的，我需要所有值来应用过滤器，并在表格上进行即时搜索。

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:15:13.663

如果您有巨大的结果，请尝试在您的网页上使用 LIMIT 和分页技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:21:59.413

我建议使用 jQuery 和插件[Datatables](http://www.datatables.net/index)，它可以让您进行服务器端搜索，而且设置起来也很容易。

我在我的几个项目中都有它，并且有 50k 行甚至更多的表。如果您只加载 100 行并让用户浏览它们或搜索，这将带来良好而流畅的用户体验。

对于 ajaxdatasourced 表，请查看[此链接](http://www.datatables.net/release-datatables/examples/ajax/ajax.html)

# wix - 如果位于单独的文件中，自定义操作不会运行

> ID：11451590
> 
> 赞同：4
> 
> 时间：2012-07-12T12:13:24.097
> 
> 标签：wix, custom-action

如果我在产品块中编写下面的代码，那么它可以正常工作，但如果我将它写在一个单独的文件中，那么它就无法正常工作。

请问谁能告诉我为什么会发生这种情况？

这是自定义操作的单独文件代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<?include SetupDefines.wxi?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>

    <!-- The custom action DLL itself.-->
    <Binary Id="CA" SourceFile="..\bin\debug\Name.CA.dll" />

    <CustomAction Id="CustomAction1"
              BinaryKey="CA"
              DllEntry="CustomAction1"
              Execute="immediate"
              Return="check" />

    <!--Custom Actions END-->
    <InstallExecuteSequence>

      <Custom Action="CustomAction1" Before="InstallFiles">
        <![CDATA[NOT Installed]]>
      </Custom>

    </InstallExecuteSequence>
  </Fragment>
</Wix> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T23:11:57.160

链接器将仅包含在解析引用时遇到的片段。

在您的产品 wxs 中使用[CustomActionRef](http://wix.sourceforge.net/manual-wix3/wix_xsd_customactionref.htm)元素以确保链接器包含该片段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T17:03:58.363

您的项目没有引用您的片段。您可以向您的片段添加一个虚拟属性，然后在您的主项目文件中引用您的片段，如此 SO 答案中所述：[WiX：从没有 CustomAction 的片段中提取 CustomTable](https://stackoverflow.com/questions/10339055/wix-pulling-in-a-customtable-from-a-fragment-without-a-customaction/10339330#10339330)

# ios - 适用于 iOS 的免费 SMB 库

> ID：11451594
> 
> 赞同：3
> 
> 时间：2012-07-12T12:13:27.190
> 
> 标签：ios, smb

我在 Google 上搜索了很多，以获取适用于 iOS 的免费 SMB 库。我从以下站点获得了 Tango Library：
[https](https://github.com/38leinaD/tango) ://github.com/38leinaD/tango 。

是否还有其他适用于 iOS 的 SMB 库？

# php - 查看 MySql 的 PHP IF 语句

> ID：11451606
> 
> 赞同：-3
> 
> 时间：2012-07-12T12:13:51.807
> 
> 标签：php, mysql

抱歉，我应该在问题中提供更多信息

我试图弄清楚如何创建一个查看 mysql 字段的 if 语句，例如： if date ("D") = mysqlDateField

我有一个小网站，用户将提醒放入论坛中，以便在他们设置的日期发送到指定的电子邮件地址。

日期以周一、周二、周三等格式存储在 mysql 数据库中。

用户可以选择多天，所以我每天都有一个字段（不确定这是否是最好的方法）

所以我有一个 sendmail 脚本，它运行并发送带有用户指定提醒的电子邮件。

我希望 if 语句检查当前日期与数据库中的日期

我目前正在使用日期（“D”）格式，因为它与数据库中存储的内容相匹配

在浏览了不同的论坛和 w3schools 之后，我在下面想出了这个但它不起作用，我是 php 和 mysql 的新手，不完全确定如何让它以我想要的方式工作

```
$result = mysql_query("SELECT * FROM users")or die(mysql_error());
$d = date ("D");

if (mysql_num_rows($result)==$d) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:20:35.750

代码示例之前的一些小说明：

*   创建一个日期来与 D 比较是不好的，使用一些更有用的格式，比如“Ymd”；
*   您要比较的日期必须采用相同的格式（您不应将 ymd 与 ymdhis 日期进行比较），否则它们会给您带来不一致的结果。在使用它们之前转换或格式化日期。
*   您通过表上的通配符查询收到很多结果，您应该尽可能避免使用 SELECT *

    ```
    foreach($result as $row){    
        if(strtotime($row['field_with_date']) == strtotime($d)){ } } 
    ```

# javascript - 如何在 Eclipse 中为特定项目配置缩进标签长度？

> ID：11451608
> 
> 赞同：3
> 
> 时间：2012-07-12T12:13:57.797
> 
> 标签：javascript, eclipse

在我的大多数项目中，我使用缩进的默认值，即 4 个空格长度。

在同一工作区中的特定项目中，我需要让每个选项卡的长度为 3 个空格（愚蠢的原因）。

我浏览了项目属性，没有找到任何东西。是否有黑客或插件来实现我的目标？

***编辑：***我忘了提到我正在编辑的文件是***javascript 文件***，它们不受项目的 java 代码格式化程序的自定义影响。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:47:21.850

选择项目，从菜单栏中单击项目下拉菜单，属性，Javascript，选择代码样式，格式化程序。启用项目特定设置。然后您应该能够为该项目创建一个新配置文件并将选项卡宽度更改为 3 个空格。

# android - 使用位图图像产生的 OutOfMemoryError

> ID：11451611
> 
> 赞同：1
> 
> 时间：2012-07-12T12:14:06.517
> 
> 标签：android, android-widget, out-of-memory

我的 Android 应用程序中有一个活动试图使用 17 个图像作为位图。但是，当我尝试开始此活动时，它会返回`java.lang.OutOfMemoryError`。我真的无法解决这个问题。谁能给我一个确切的解决方案？我`onCreate()`的在下面。谢谢你。

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.seviyor);

    activityHead=(ImageView) findViewById(R.id.activityhead1);
    shake = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);
    Options options=new Options();
    options.inSampleSize=1;
    for(int i=0;i<17;i++){  
        bmImages[i]=BitmapFactory.decodeResource(getResources(),drwbles[i] , options);
    }

    initilizeToastBackground();
    initilizeButtonsFor16Leafs();
    initilize16Lisener();

    resultIntent=new Intent(this,ResultFrame.class);
    fortuneCon=16;
    for(int i=0;i<17;i++){
        leafs[i]=(ImageView) findViewById(leafIDs[i]);
    }
    for(int i=0;i<17;i++){
        leafs[i].setImageBitmap(bmImages[i]);
    }

    Bundle frompreviousInent=getIntent().getExtras();
    categoryName=frompreviousInent.getString("category");
    setHeadOfActivity();
} 
```

这是我的 LogCat ...

```
 07-12 15:21:11.465: E/AndroidRuntime(23419): FATAL EXCEPTION: main

07-12 15:21:11.465: E/AndroidRuntime(23419): java.lang.OutOfMemoryError

07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.Bitmap.nativeCreate(Native Method)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.Bitmap.createBitmap(Bitmap.java:605)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.Bitmap.createBitmap(Bitmap.java:551)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:437)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:618)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:593)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:445)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:468)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at com.done.SS.onCreate(SS.java:65)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.Activity.performCreate(Activity.java:4562)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1053)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.ActivityThread.access$600(ActivityThread.java:128)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.os.Looper.loop(Looper.java:137)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at android.app.ActivityThread.main(ActivityThread.java:4514)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at java.lang.reflect.Method.invokeNative(Native Method)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at java.lang.reflect.Method.invoke(Method.java:511)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
07-12 15:21:11.465: E/AndroidRuntime(23419):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:43:56.813

你需要它们的全尺寸吗？尝试设置`options.inSampleSize = 8`。或者至少 2 或 4 个。

我怀疑有 17 张图像这可能是不够的。

另一种解决方案是查询图像并将它们作为缩略图放入您的活动中：

```
Uri tUri = MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI; // Where thumbnails are stored
String[] columns = { MediaStore.Images.ImageColumns._ID,
                     MediaStore.Images.ImageColumns.DATE_TAKEN,MediaStore.Images.ImageColumns.DISPLAY_NAME};

Cursor thumbCursor = this.managedQuery(tUri, null, null, null, null); // May need to use more paramaters to get
                                                                      // exactly the images you need
int i = 0;
if (thumbCursor.moveToFirst() && thumbCursor.getCount() == 17) 
{
    do
    {
         int columnIndex = thumbCursor.getColumnIndex(MediaStore.Images.Thumbnails.DATA);
         String filePath = thumbCursor.getString(columnIndex);
         Bitmap bitmap = BitmapFactory.decodeFile(filePath);
         leafs[i]=(ImageView) findViewById(leafIDs[i]);
         leafs[i].setImageBitmap(bitmap);
         i++;
     }
     while(thumbCursor.moveToNext());
     thumbCursor.close();
 } 
```

# sql - 单笔交易与多笔交易

> ID：11451612
> 
> 赞同：3
> 
> 时间：2012-07-12T12:14:07.783
> 
> 标签：sql, database, transactions

我需要将数据插入到同一个数据库中的两个单独的表中。我目前为每个插入使用单独的查询/事务，但我最近了解到我可以将两个插入组合成一个事务。

将它们组合成一个事务而不是将它们保持为单独的事务有什么区别？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-12T12:21:51.320

Well Transaction 为您提供了回滚 sql 语句的工具。例如你有两个表table1和table2，你想在table2中插入数据只有正确插入table1，如果在table1中插入数据发生错误你不会在table2中插入数据，在这种情况下你将使用交易。

**交易的四个基本功能：**

1.  `Atomicity:`当事务中涉及两条或更多条信息时，要么提交所有信息，要么不提交任何信息。
2.  `Consistency:`在事务结束时，要么存在新的有效数据形式，要么数据返回到其原始状态。
3.  `Isolation:`在事务期间（在提交或回滚之前），数据必须保持隔离状态，其他事务无法访问。
4.  `Durability:`事务提交后，即使服务器出现故障或重新启动，数据的最终状态仍然可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:26:03.670

如果数据是相关的，这意味着第二个 sql 存储的数据依赖，以某种方式与第一个查询存储的数据链接，反之亦然，那么你应该考虑制作一个`transaction`. 这样，`rollback`如果其中一个查询遇到问题，您就可以。`try-catch`您可以在语句中实现这一点。如果查询彼此完全不相关，则可以使用两个单独的 SQL 语句。

但是我认为，由于两个表的数据相同，因此最好进行事务处理。因此，如果您将来必须进行连接、删除等操作，那么您已经拥有了一个一致的数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:31:36.760

您是否需要以**原子**方式执行这 2 次插入（即它们必须都成功或失败，但您不能让一个成功而另一个失败）？

*   如果是，那么您必须将它们包含在同一个事务中。
*   如果不是，那么您有一定的选择余地，如下所述...

事务是[ACID](http://en.wikipedia.org/wiki/ACID)，“D”代表[“durable”](http://en.wikipedia.org/wiki/ACID#Durability)，这实际上意味着 DBMS 必须等到数据物理写入永久存储（而不是仅仅将其存储在缓存中并立即继续前进）。出于性能原因，您会希望这种“持久性等待”相对较少，并且在这方面使用一个事务而不是两个事务（每个语句一个事务）更好。当然，这会使它们成为原子的，这可能是可取的，也可能不是可取的，因此您必须平衡性能与所需的行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T12:20:21.013

一件事与另一件事无关。

将它们放在同一个事务中的目的是要么都发生，要么都不发生。

如果您的第一个插入成功而第二个插入失败，那么您需要问和回答的问题是什么。

就个人而言，由于我在某些操作中同时进行了两次插入，因此即使第二个事务失败的后果在其他地方处理，单个事务也是有意义的。

# android - Android webview 不显示

> ID：11451613
> 
> 赞同：1
> 
> 时间：2012-07-12T12:14:17.447
> 
> 标签：android, webview

我已经创建了一个 webview，但是当我运行应用程序时它没有显示。有谁知道为什么？

这是我的代码。这是我加载 webview 并添加 url 的地方：

```
_webView = (WebView) LayoutInflater.from(getBaseContext()).inflate(R.layout.clubdir, null);

_webView.getSettings().setJavaScriptEnabled(true);
_webView.getSettings().setBuiltInZoomControls(true);
_webView.getSettings().setSupportZoom(true);
_webView.setWebViewClient(new WebViewClient());
_webView.loadUrl("http://maps.google.com/maps?q=" + Postcode + "&ui=maps");

adapter = new MergeAdapter();
adapter.addView(ImageView);
adapter.addView(header);
adapter.addView(fixturesView);
adapter.addView(header2);
adapter.addView(resultsView);
adapter.addView(clubinfo);
adapter.addView(ClubInfo);
adapter.addView(clubdir);
adapter.addView(_webView);
adapter.addView(moreinfo);
adapter.addView(MoreInfo); 
setListAdapter(adapter); 
```

这是我正在膨胀的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<WebView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="150dp">
</WebView> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:23:43.393

而不是这个尝试这个简单的事情：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
<WebView android:id="@+id/webView"
    android:layout_width="fill_parent"
    android:layout_height="150dp">
</WebView>
</RelativeLayout> 
```

在您的活动中：

```
 WebView view=(WebView) findViewById(R.id.webView);
    view.getSettings().setJavaScriptEnabled(true);
    view.getSettings().setBuiltInZoomControls(true);
    view.getSettings().setSupportZoom(true);
    view.setWebViewClient(new WebViewClient());
    view.loadUrl("http://maps.google.com/maps?q=Pizza,texas&ui=maps"); 
```

就是这样。尝试希望这会对你有所帮助。如果它有效，而不是继续添加其他东西

# c# - C＃ - 对象铸造

> ID：11451614
> 
> 赞同：3
> 
> 时间：2012-07-12T12:14:19.933
> 
> 标签：c#, com, casting, queryinterface

据我所知，如果我们在处理`COM`接口，任何简单的转换通常都会触发`QueryInterface`例程，该例程用于确定对象是否实际实现了相应的`COM`接口。

```
object whatever;
IComInterface casted = (IComInterface) whatever; 
```

因此，以下代码（取决于编译器和优化）*可能会触发*内部`QueryInterface`对象转换实现：

```
IComInterface comInteface;

// I guess nothing COM-related happens here, but I might be wrong
object whatever = comInteface; 

// This might or might not trigger the 'QueryInterface' call.
IComInterface comInterface2 = (IComInteface) whatever; 
```

* * *

## 问：

假设我有一个通用`List<T>`实例：

```
List<IComInterface> list = new List<IComInterface>(); 
```

现在，我是否有强有力的保证以下代码不会触发`QueryInterface`基于 - 的演员表？

```
List<IComInterface> list = new List<IComInterface>();
IComInterface comInterface = (...); // Somehow got it.
list.Add(comInteface);
IComInterface retrieved = list[0]; 
```

*   在此处使用`ArrayList`而不是`List<T>`实际上会导致执行强制转换，因为您必须`IComInterface`从无类型`object`实例中获取相应的内容。

*   但是，对于泛型，我想，一切都应该在没有强制转换的情况下完成，但我实际上并不确定它们在表面下是如何工作的。

*   是否有可能`List<T>`仍然以某种方式对`object`类型进行操作（因此，将`QueryInterface`在所描述的场景中调用基于 - 的演员表）？

*   如果上一个问题的答案是“否”，那么是否真的不能保证任何可能的情况都一样`IList<T>`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:28:16.030

您可以将泛型*类型实例*（例如`List<IComInterface>`）视为从泛型*类型定义*（例如`List<T>`）创建的类，方法是用 name 逐字替换`T`name `IComInterface`。类型不会像在某些语言（最显着的是 Java）中那样被“擦除”，它与泛型类型实例一起保存，因此`T`在泛型类型定义中声明为类型的所有变量在泛型类型中保持强类型实例。

在 a 的情况下`List<IComInterface>`，`object`只要您`IComInterface`在编译时插入已知类型的对象，就不会进行强制转换。您帖子中的代码就是这种情况，但可能并非总是如此。例如，当您插入一个动态类型的对象时，编译器将添加一个强制转换：

```
dynamic comInteface = ...
list.Add(comInteface); // There will be an implicit cast here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:32:42.580

是的，这是一个相当不错的保证，除非必须，否则编译器不会发出 Opcodes.Castclass IL 指令。类型匹配，因此不需要强制转换。

这通常不应该让您担心。COM 接口的 QI 实现由于 COM 内部的各种原因而受到重创。它总是非常快，比较一个 guid 只需几纳秒。

# android - 检索短信详细信息中未显示姓名？

> ID：11451617
> 
> 赞同：0
> 
> 时间：2012-07-12T12:14:31.150
> 
> 标签：android

我使用的是 2.1 平台，我可以使用下面的代码检索短信详细信息。但是只显示号码和短信正文，名称还没有出现，我该怎么做才能检索名称呢？

**代码**

```
public class SMSActivity extends Activity {

    ListView lview;
    String Body  = "" ; 
    ArrayList<String> smslist=new ArrayList<String>();
    ArrayAdapter<String> itemAdapter;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.main);
    lview =(ListView)findViewById(R.id.lv);
    itemAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,smslist);
    lview.setAdapter(itemAdapter);

    ContentResolver cr = getContentResolver();
    Cursor c = getContentResolver().query(Uri.parse("content://sms/inbox"), null, null, null, null);
    while(c.moveToNext()){

    Number = c.getString(c.getColumnIndexOrThrow("address"));

   Body = c.getString(c.getColumnIndexOrThrow("body")).toString();

   smslist.add( Number + ":" +"\n"+ Body);
    }
    itemAdapter.notifyDataSetChanged();

    c.close();
}
} 
```

如何解决这个问题呢 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:16:22.510

你的**号码**是对的！！现在将此号码传递给此方法，它将返回您相应号码的联系人姓名。

```
 public String getContactName(String number) {
        String cName = null;
        Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));
        String nameColumn[] = new String[]{PhoneLookup.DISPLAY_NAME};
        Cursor c =  getContentResolver().query(uri, nameColumn, null, null, null);
        if(c == null || c.getCount() == 0)
            return cName;
        c.moveToFirst();
        cName = c.getString(0);
        return cName;

    } 
```

添加以下权限

`<uses-permission android:name="android.permission.READ_CONTACTS" />`

在您的清单文件中到 Read_contact 数据。

为您的代码替换此代码

```
Number = c.getString(c.getColumnIndexOrThrow("address"));

   Body = c.getString(c.getColumnIndexOrThrow("body")).toString();

   smslist.add( Number + ":" +"\n"+ Body); 
```

与下面

```
 Number = c.getString(c.getColumnIndexOrThrow("address"));
   String name = getContactName(Number); // declare name outside

   Body = c.getString(c.getColumnIndexOrThrow("body")).toString();
  if( name == null )
     smslist.add( Number + ":" +"\n"+ Body);
  else
        smslist.add( name + ":" +"\n"+ Body); 
```

# linux - 如何从 /dev/input/mice 读取鼠标按钮状态？

> ID：11451618
> 
> 赞同：9
> 
> 时间：2012-07-12T12:14:35.717
> 
> 标签：linux, linux-device-driver

如何从 /dev/input/mice 读取鼠标按钮状态？我想检测按钮是否被按下。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-04-26T22:15:09.377

您可以打开设备并从中读取。/dev/input/mice 中的事件有 3 个字节长，需要进行一些解析。我认为现在首选的方法是使用 /dev/input/event# 代替。然而，这里是一个使用 /dev/input/mice 的小例子。

```
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>

int main(int argc, char** argv)
{
    int fd, bytes;
    unsigned char data[3];

    const char *pDevice = "/dev/input/mice";

    // Open Mouse
    fd = open(pDevice, O_RDWR);
    if(fd == -1)
    {
        printf("ERROR Opening %s\n", pDevice);
        return -1;
    }

    int left, middle, right;
    signed char x, y;
    while(1)
    {
        // Read Mouse     
        bytes = read(fd, data, sizeof(data));

        if(bytes > 0)
        {
            left = data[0] & 0x1;
            right = data[0] & 0x2;
            middle = data[0] & 0x4;

            x = data[1];
            y = data[2];
            printf("x=%d, y=%d, left=%d, middle=%d, right=%d\n", x, y, left, middle, right);
        }   
    }
    return 0; 
} 
```

单击鼠标会生成以下内容：

```
x=0, y=0, left=1, middle=0, right=0
x=0, y=0, left=0, middle=0, right=0 
```

和一个鼠标移动（注意“相对”鼠标移动坐标）：

```
x=1, y=1, left=0, middle=0, right=0 
```

# wpf - 如何防止 RadMenu 在鼠标右键单击时关闭

> ID：11451624
> 
> 赞同：1
> 
> 时间：2012-07-12T12:15:02.400
> 
> 标签：wpf, telerik, contextmenu, right-click, radmenu

我`RadMenu`在我的 WPF 应用程序中创建，并添加了一个上下文菜单，`RadMenuItems`以下是代码/XAML`RadMenu`

```
<telerik:RadMenu Name="radMenu1" ItemsSource="{Binding MenuHeaders}" Height="76">
                <telerik:RadMenu.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Path=Children}">
                        <HierarchicalDataTemplate.ItemContainerStyle>
                            <Style TargetType="telerik:RadMenuItem">
                                <Setter Property="Command"
                            Value="{Binding Command}" />
                            </Style>
                        </HierarchicalDataTemplate.ItemContainerStyle>
                        <StackPanel Height="Auto">
                            <Image MaxWidth="32" MaxHeight="32" Source="{Binding mImage}" />
                            <TextBlock HorizontalAlignment="Center" Text="{Binding mText}"></TextBlock>
                            <Image MaxWidth="10" MaxHeight="10" HorizontalAlignment="Center" Source="{Binding mDownImage}" />
                        </StackPanel>
                    </HierarchicalDataTemplate>
                </telerik:RadMenu.ItemTemplate>
                <telerik:RadContextMenu.ContextMenu>
                    <telerik:RadContextMenu>
                            <telerik:RadMenuItem Header="Add to Wishlist">
                                <telerik:RadMenuItem.Icon>
                                    <Image Source="/WPFTestApp;component/Images/New.png" />
                                </telerik:RadMenuItem.Icon>
                            </telerik:RadMenuItem>
                    </telerik:RadContextMenu>
                </telerik:RadContextMenu.ContextMenu>
            </telerik:RadMenu> 
```

ContextMenu 工作正常，但是当我右键单击任何`RadMenuItem`ContextMenu 打开但 RadMenu 关闭时。我想保持 RadMenu 打开但不知道该怎么做？

# selenium - 如何使用过滤器选择记录？

> ID：11451626
> 
> 赞同：0
> 
> 时间：2012-07-12T12:15:07.193
> 
> 标签：selenium, webdriver

我使用硒网络驱动程序。我有这样的代码 - `driver.findElement(By.name("ctsk")).sendKeys("1234");`。它加上一些其他类似的命令填充了新记录。在我需要在概览中找到此记录之后。所以我使用这样的代码 - `driver.findElement(By.xpath("//*[@id='columnTitle2']/input")).sendKeys("1234");`. 但是如果我再次使用这样的命令，它不会重写过滤器中的值，而是将新值添加到以前的值。例如，我得到的是“12341234”，而不是“1234”。如何设置新值，而不仅仅是添加？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:27:08.707

可能最好的方法是在输入更多数据之前[清除WebElements ......](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html#clear%28%29)

# python - Django - Python：从每个不同值的列表中选择 x 个随机项

> ID：11451629
> 
> 赞同：1
> 
> 时间：2012-07-12T12:15:19.107
> 
> 标签：python, django, mongodb

我在 Django 中使用 Mongodb。

我有一个带有条目的 django 模型。我想从这些条目中选择 1、2、3 或 4，或者每个唯一条目我需要的数量，所以假设模型如下所示：

```
James, 011, A, B

Ben, 012, C, B

John, 014, C, B

Jamie, 0121, B, B

Sam, 015, B, B

Alex, 031, A, B 
```

因此，我希望公司的每个独特部门都有 1 个随机条目。

它应该给我：

```
James, 011, A, B

Sam, 011, B, B

John, 011, C, B 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:41:38.423

请查看[QuerySet.distinct() 函数](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.distinct)

```
queryset.distinct('department') 
```

# jquery - 拖动可调整大小的 2 列布局

> ID：11451638
> 
> 赞同：7
> 
> 时间：2012-07-12T12:15:39.060
> 
> 标签：jquery, css, jquery-ui

我只是尝试使用 jQuery ui 创建一个可重新调整大小的拖动布局

[http://jsfiddle.net/3zLRJ/](http://jsfiddle.net/3zLRJ/)

但我的实际目标是这样的

![在此处输入图像描述](../Images/b42ba1ff3013a395d24c4f8b67f814a3.png)

是否可以使用 jQuery Ui 方法或任何其他可用插件来实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T13:10:47.273

该插件默认不支持它，所以我为您实现目标做了一个开始。我只是将 div 硬编码到 的函数中`resize event`，让它成为动态的取决于你；）。

```
var total_width = 500;

$("#div1").resizable({
    grid: [1, 10000]
}).bind( "resize", resize_other);

function resize_other(event, ui) {
    var width = $("#div1").width();

    if(width > total_width) {
        width = total_width;

        $('#div1').css('width', width);
    }

    $('#div2').css('width', (total_width - width));
}​ 
```

[小提琴示例](http://jsfiddle.net/3zLRJ/4/)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:15:46.697

设置`handles`div 的属性：http: [//jsfiddle.net/3zLRJ/5/](http://jsfiddle.net/3zLRJ/5/)

`resize`但是，当通过事件调整 div 的大小时，您需要添加代码来调整两个 div 。

另一种选择是在两者之间创建第三个 div ，将其设为 a `draggable`，并将其运动限制为仅左右移动。`drag`然后，在事件中调整它周围的 div 。

# c++ - WritePrivateProfileString 未将属性添加到末尾

> ID：11451641
> 
> 赞同：2
> 
> 时间：2012-07-12T12:15:56.020
> 
> 标签：c++, winapi, writefile

我正在使用`WritePrivateProfileString`函数在 ini 文件中编写一些属性，一切正常，但是当我添加多行文本时，出现了问题。

这是代码和输出。

```
WritePrivateProfileString(_T("General"), _T("Name"), OLE2CT(text), FilePath); 
```

输出：

```
[General]
Name=mytext 
```

.

```
text = address\nstreet\nhouse
WritePrivateProfileString(_T("General"), _T("Address"), OLE2CT(text), FilePath); 
```

输出：

```
[General]
Name=mytext
Address=address
street
house 
```

但是当添加一个多行项目后，我添加了另一个项目，而不是添加这个来结束它在地址行之后添加新行

```
text = city
WritePrivateProfileString(_T("General"), _T("City"), OLE2CT(text), FilePath); 
```

输出：

```
[General]
Name=mytext
Address=address
City=city
street
house 
```

但输出应该是

```
[General]
Name=mytext
Address=address
street
house
City=city 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:31:54.860

我强烈建议您[在 Michael Kaplan 的博客上](http://www.siao2.com/2006/09/15/754992.aspx)阅读您的问题。

*如果您绝对必须使用 INI 文件*，请不要使用您现在正在使用的已弃用的 Win32 API 函数。它们是错误的，并且错误肯定不会再得到修复，因为[它们现在已被弃用](http://blogs.msdn.com/b/oldnewthing/archive/2007/11/26/6523907.aspx)。

而是使用[SimpleIni](https://github.com/brofield/simpleini)一个非常体面的 C++ 的 INI 读取器/写入器的跨平台实现。

微软（作为一个整体）似乎不确定他们是否更喜欢注册表或其他存储配置数据的机制。在某些时候，它是 INI 文件，然后是注册表（对我来说是一种优越的机制），然后它似乎转向 XML 和其他基于文件的存储机制。当然，您的用例将定义您需要什么，但请考虑使用这些已弃用函数的所有注意事项，并**至少寻找一种使用 INI 文件的替代机制（如果必须）**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T23:46:42.527

好吧，这不是 API 函数的 INI 文件的正确格式，您期望什么？

ini 文件的格式为：

```
[section]
item1=item1text
item2=item2text
...

[anothersection]
item1=item1text
item2=item2text
... 
```

如果要使用 ini API 调用，则必须遵守格式。您希望城市、街道和房屋成为城市项目的一部分吗？然后将它们全部放在“同一行”并使用一个分隔符，您可以稍后为每个字段解析。您可以使用逗号、竖线或其他任何不属于文本的内容。

# iphone - 如何剪切 json 字段值并将其存储在不同的索引中

> ID：11451648
> 
> 赞同：5
> 
> 时间：2012-07-12T12:16:07.500
> 
> 标签：iphone, ios, json, parsing

```
desc = [[NSMutableArray alloc] init];
for (NSString * strName in results) 
{
    arrRates = [results objectForKey:strName];
    for (int i = 0; i <= [arrRates count]; i++) 
    {
        if ([[[arrRates objectAtIndex:i] valueForKey:@"type"] isEqualToString:@"0"])
        {
            nextUrl = [[arrRates objectAtIndex:i] valueForKey:@"Nexturl"];
            [desc addObject:[[arrRates objectAtIndex:i] valueForKey:@"desc"]];
        }
    }
}
NSLog(@"type 0 desc is:--> %@",desc); 
```

**输出：-**

```
[7666:b303] type 0 desc is:--> (
    "Home|2028;Services|2029;Clients|2030;Portfolio|2031;Company|2032;Contact Us|2033;Career|2034;",
    "Article Submission|2064;Social Bookmarking|2065;Directory Submission|2066;Forum / Blog Link Generation|2067;Press Release Distribution|2068;Link Wheel Creation|2069;Content Writing|2070;Video Marketing|2071;",
    "Magento|2072;Joomla|2073;Wordpress|2074;Drupal|2075;osCommerce / Zencart|2076;",
    "PSD to XHTML|2077;Newsletter Design|2078;Logo Design|2079;Website Redesign|2080;W3C Validation|2081;Flash Intro|2082;",
    "SEO Services|2035;BPO / KPO Services|2036;Web Development|2037;Mobile Apps.|2038;",
    "SEO Portfolio|2039;Web Development Portfolio|2040;",
    "About Elsner|2083;Vision, Mission, Values|2084;Leadership Team|2085;Our Partners|2086;Awards and Recognition|2087;Press|2088;Events|2089;",
    "Link Building Services|2041;Pay Per Click Marketing Services|2042;Search Engine Marketing|2043;Social Media Marketing|2044;Keyword Research|2045;Website Optimization|2046;",
    "Data Entry Services|2048;Live Chat Support|2049;B2B Lead Generation|2050;24 x 7 Technical Support|2051;HR Recruitment Service|2052;Market Research and Analysis |2053;",
    "Open Source Solution|2054;Custom PHP|2055;CRM|2056;Ecommerce Solution|2057;Website Design|2058;Website Design|2058;Website Design|2059;",
    "Blackberry Apps|2060;J2ME Apps|2061;Iphone Apps|2062;Android Apps|2063;"
) 
```

我在 json 解析字段**"desc"**中有这种类型的数据。

该数据有一些“|” &“;” 分隔值。

从这种数据中，我想将数据存储在两个不同的参数中，比如......

```
title              id
-------            ----

Home               2028

Services           2029

Clients            2030

Portfolio          2031

Company            2032

Contact Us         2033

Career             2034 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T12:19:47.093

```
 NSString *desc=@"Home|2028;Services|2029;Clients|2030;Portfolio|2031";
NSArray *arr=[desc componentsSeparatedByString:@";"];
NSString *sub=@"|";
NSMutableArray *arrTitle=[[NSMutableArray alloc]init];
NSMutableArray *arrId=[[NSMutableArray alloc]init];
for (int i=0; i<[arr count]; i++) {
    [arrTitle addObject:[[arr objectAtIndex:i] substringToIndex:NSMaxRange([[arr objectAtIndex:i] rangeOfString:sub])-1]];
    [arrId addObject:[[arr objectAtIndex:i] substringFromIndex:NSMaxRange([[arr objectAtIndex:i] rangeOfString:sub])]];
} 
```

试试看.. vipul 帕特尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:20:34.900

当您使用 JSON 时，最好使用字典。

JSON 基本上只是一个键值对列表。所以你应该用它`NSDictionary`来存储值。

如果你有一个有效的 JSON，那么有很多 JSON 解析器会派上用场。例如。[看一看](http://jasarien.com/?p=428)

# c# - Metro 风格的应用程序会支持本地数据库吗

> ID：11451650
> 
> 赞同：3
> 
> 时间：2012-07-12T12:16:13.160
> 
> 标签：c#, xaml, windows-8, windows-runtime

我正在使用 XAML 和 C# 为 Windows 8 平板电脑开发 Metro 应用程序，所以有没有任何有效的方法可以将数据存储在本地数据库中（比如 iPhone 中使用的 SQLLite），所以我的问题是

1.  Metro 应用程序会支持本地数据库访问吗？
2.  如果支持哪个是实现它的有效方法以及使用哪个数据库来存储数据？

任何人都可以向我发送任何关于此的文章或链接，请帮助我提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:26:47.837

您可以在 Windows 8 上的 Metro 风格应用程序中使用 SQLite。您可以在[其下载页面](http://sqlite.org/download.html)上找到相应的二进制文件。

# sed - sed 用下划线替换破折号，直到到达字符

> ID：11451651
> 
> 赞同：3
> 
> 时间：2012-07-12T12:16:13.473
> 
> 标签：sed

这是一个示例文本

```
enable-threads       = yes
enable-shared        = yes
enable-parser        = yes
DAL-II-VERSION     = 7.1.0
DAL-II-MAJOR       = -L -f -g
DAL-II-MINOR         = 1 
```

我想在每行中用下划线替换所有破折号 (-)，直到达到 = 符号。

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:58:36.540

The easiest way to do something like that is using a [look-ahead assertion](http://www.regular-expressions.info/lookaround.html). `sed` doesn't support them, but `perl` does:

```
perl -pe 's/-(?=.*=)/_/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:08:43.883

不幸的是，`sed`不支持后视或前瞻。但是`perl`做`ssed`（见罗布的回答）。如果`perl`不可用，这是一种使用方法`awk`：

```
awk -F= 'OFS=FS { gsub("-", "_", $1); }1' file.txt 
```

输出：

```
enable_threads       = yes
enable_shared        = yes
enable_parser        = yes
DAL_II_VERSION     = 7.1.0
DAL_II_MAJOR       = -L -f -g
DAL_II_MINOR         = 1 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T16:06:22.833

This might work for you (GNU sed):

```
sed 'h;s/=.*//;y/-/_/;G;s/\n[^=]*//' file 
```

# android - 在andengine中开始这个课程之前黑屏

> ID：11451654
> 
> 赞同：2
> 
> 时间：2012-07-12T12:16:26.823
> 
> 标签：android, andengine

在开始我的游戏活动之前，它显示我黑屏...有人知道是什么原因吗？

下面我提到了我的代码：

公共类 BaseSpriteBackgroundnow 扩展 BaseGameActivity 实现 IAccelerometerListener, IOnSceneTouchListener, IOnMenuItemClickListener, IUpdateHandler, ITimerCallback {

```
// Layer Background
private static final int LAYER_BACKGROUND = 0;
private static final int LAYER_BOTTOM = LAYER_BACKGROUND + 1;
private static final int LAYER_MIDDLE = LAYER_BOTTOM + 1;
private static final int LAYER_TOP = LAYER_MIDDLE + 1;

// MAX WIDTH & HEIGHT of DEVICE

public static final int INNER_BOX_WIDTH = 64;
static final int OUTTER_BOX_WIDTH = (INNER_BOX_WIDTH * 1);
public static final int CAMERA_WIDTH = INNER_BOX_WIDTH * 5;
public static final int CAMERA_HEIGHT = INNER_BOX_WIDTH * 3;
static final int CAMERA_WIDTH_OUTER = OUTTER_BOX_WIDTH * 5;
static final int CAMERA_HEIGHT_OUTER = OUTTER_BOX_WIDTH * 3;

/*
 * final int inner_maxX = (CAMERA_WIDTH - INNER_BOX_WIDTH) +
 * (INNER_BOX_WIDTH / 2); final int inner_maxY = (int) (INNER_BOX_WIDTH *
 * 2.5); final int inner_minX = INNER_BOX_WIDTH / 2; final int inner_minY =
 * INNER_BOX_WIDTH / 2;
 */

AccelerometerData pLocalAccelorometer;
int gameTime;
boolean levelcomplete;
double angleCng = 0;
int restoreSplashCounter = 0; // counter to remove the splashed image when
                                // it reached 100
static float exactHalfX = PathArray.xDiff / 2;
static float exactHalfY = PathArray.xDiff / 2;
int counter = 0;
int counterX = 0, counterY = 0;
public int BUGS_COUNT = 0;
public int HIT_COUNT = 0;
private Font game_over_font, timeUpdateFont, scorePopUp_font,
        scoreBoard_Font;

public static Scene scene;
// private Camera mCamera;
private SmoothCamera mCamera;
private TextureRegion MbgImg;
private long lastSensorUpdate = -1;
public Sprite mPauseBtnSprite, mPlayBtnSprite;
public Body body;
public static int BALL_STATE = 0;// 0 - Ball at rest 1- Ball is Active

public ArrayList<AnimatedSprite> bugsArray;
Boolean modifierfinished = false;

private Texture bgTexture, antTexture, beetleTexture, flyTexture,
        beeTexture, spiderTexture, ballTexture, game_over_font_texture,
        scorePopUp_font_texture, scoreBoard_Font_texture,
        time_font_texture, pause_btn_texture, play_btn_texture,
        splash_texture, blood_splash_texture, menu_star_anim_texture1,menu_star_anim_texture2,menu_star_anim_texture3;

public TextureRegion pause_btn_texure_region, play_btn_texture_region;

public static AnimatedSprite spiderAnimatedSprite, bugs_splashSprite;
private static AnimatedSprite ball_splashSprite;
private AnimatedSprite antAnimatedSprite, beetleAnimatedSprite;
static AnimatedSprite hitBallAnimateSprite;
private AnimatedSprite beeAnimatedSprite, flysAnimatedSprite;

TiledTextureRegion antTextureRegion, beetleTextureRegion, flyTextureRegion,
        beeTextureRegion, SpiderTextureRegion,
        spider_splash_texture_region, blood_splashTextureRegion;
private static TiledTextureRegion hitBallTextureRegion;
public static double currentX = 0, currentY = 0, currentZ = -12;
private int isFirstmove = 0;

private double lastZ = 0.0;
static Path Ballpath;
public int Starscore = 0;

// private static final FixtureDef FIXTURE_DEF =
// PhysicsFactory.createFixtureDef(0, 0, 0);

private static Sound BallHitSound, smashSound[];
private static Music BallMissHitSound;
public static boolean removeBool = false;

public static Options options;

// pauseMenu Variables
// protected MenuScene levelMenu, restartMenu;
protected CustomMenuScene levelmenu, mMenuScene;
public Text textCenter;

private Texture mMenuTexture, levelMenuTexture;
protected TextureRegion mMenuResumeTextureRegion;
protected TextureRegion mMenuHomeTextureRegion;
protected TextureRegion mMenuResetTextureRegion;
protected TextureRegion levelMenuRestartTextureRegion;
protected TextureRegion levelMenuCancelTextureRegion;
protected TextureRegion levelMenuNextTextureRegion;
protected final int MENU_RESUME = 0;
protected final int MENU_QUIT = MENU_RESUME + 1;
protected final int MENU_RESET = MENU_QUIT + 1;
protected final int MENU_PLAYAGAIN = MENU_RESET + 1;
protected final int MENU_NEXT_LEVEL = MENU_PLAYAGAIN + 1;
protected final int MENU_CANCEL = MENU_NEXT_LEVEL + 1;
protected final int MENU_STAR_ANIMATION = MENU_CANCEL + 1;
public int STAR_COUNT = 0;
SharedPreferences myPrefs;
SharedPreferences.Editor prefsEditor;

private static ScoreBoard hud;

Texture scoreboard_background_texture;

TextureRegion ScoreBoardTextureRegion;
Sprite scoreBoardBGSprite;
TextureRegion PauseBackgroundRegion, menuStarTextureRegion,menuStarTextureRegion2,menuStarTextureRegion3;
Sprite pauseBGSprite;
Texture ScorePopup_texture;
TextureRegion ScorePopUpBackgroundRegion;
static Sprite ScoreBGSprite;
public Sprite Star2ani;
public Sprite Star3ani;
public Sprite starAnimatedSprite;

public SpriteMenuItem nextMenuItem;
public SpriteMenuItem restartMenuItem;
public SpriteMenuItem cancelMenuItem;
public SpriteMenuItem reseumemenudummy;

Texture menu_bg_texture;
TextureRegion MenuBGTextureRegion;
Sprite menuBGSprite;

public TimerHandler timeHandler;
public PauseGame pauseObject;
int releaseTimeIntevel = 0;
GamePauseMenu gmPause;
// Score Calculation variables
static int numberofHits = 0;
static int textureSum = 0;
static int timeleftBonus = 0;
static int levelScore = 0;

SpriteBackground gmImg, gmImg1;
ArrayList<BaseSprite> bgStack;

// Camcorder Try
private CamcorderView cv;

public Engine onLoadEngine() {
    // this.mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    this.mCamera = new SmoothCamera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT, 10,
            10, 1.0f);
    Log.d("dd", "onloadEng");
    myPrefs = this.getSharedPreferences("SPLATPREFF", MODE_WORLD_READABLE);
    prefsEditor = myPrefs.edit();
    options = new Options(BaseSpriteBackgroundnow.this);
    return new Engine(new EngineOptions(true, ScreenOrientation.LANDSCAPE,
            new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT),
            this.mCamera).setNeedsSound(true).setNeedsMusic(true));
}

public void onLoadResources() {

    bgStack = new ArrayList<BaseSprite>();
    for (int i = 1; i <= 6; i++) {
        this.bgTexture = new Texture(1024, 512, TextureOptions.DEFAULT);
        bgStack.add(new BaseSprite(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT_OUTER,
                TextureRegionFactory.createFromAsset(bgTexture, this,
                        "bg/bg/bgLevel" + i + ".jpg", 0, 0)) {
        });
        this.mEngine.getTextureManager().loadTexture(this.bgTexture);

    }
    pLocalAccelorometer = new AccelerometerData();
    releaseTimeIntevel = myPrefs.getInt("release", 0);
    Log.d("dd", "onLoad Resource");
    TextureRegionFactory.setAssetBasePath("bg/");

    pause_btn_texture = new Texture(32, 32, TextureOptions.BILINEAR);
    pause_btn_texure_region = TextureRegionFactory.createFromAsset(
            pause_btn_texture, this, "pause_btn.png", 0, 0);
    play_btn_texture = new Texture(32, 32, TextureOptions.BILINEAR);
    play_btn_texture_region = TextureRegionFactory.createFromAsset(
            play_btn_texture, this, "play_btn.png", 0, 0);

    scoreboard_background_texture = new Texture(256, 128,
            TextureOptions.BILINEAR);
    ScoreBoardTextureRegion = TextureRegionFactory.createFromAsset(
            scoreboard_background_texture, this, "splash_left.png", 0, 0);
    PauseBackgroundRegion = TextureRegionFactory.createFromAsset(
            scoreboard_background_texture, this, "splash_right.png", 64, 0);
    ScorePopup_texture = new Texture(256, 128, TextureOptions.BILINEAR);

    menu_bg_texture = new Texture(1024, 1024, TextureOptions.BILINEAR);
    MenuBGTextureRegion = TextureRegionFactory.createFromAsset(
            menu_bg_texture, this, "menu_bg.png", 0, 0);

    FontFactory.setAssetBasePath("fonts/");
    game_over_font_texture = new Texture(256, 256, TextureOptions.BILINEAR);
    game_over_font = FontFactory.createFromAsset(game_over_font_texture,
            this, "bugsfont.ttf", 20, true, Color.WHITE);
    time_font_texture = new Texture(128, 128, TextureOptions.BILINEAR);
    timeUpdateFont = FontFactory.createFromAsset(time_font_texture, this,
            "AllerDisplay.ttf", 18, true, Color.WHITE);

    scorePopUp_font_texture = new Texture(128, 128, TextureOptions.BILINEAR);
    scorePopUp_font = FontFactory.createFromAsset(scorePopUp_font_texture,
            this, "AllerDisplay.ttf", 16, true, Color.GREEN);

    scoreBoard_Font_texture = new Texture(128, 128, TextureOptions.BILINEAR);
    scoreBoard_Font = FontFactory.createFromAsset(
            scoreboard_background_texture, this, "AllerDisplay.ttf", 18,
            true, Color.WHITE);

    // Bugs Texture

    this.antTexture = new Texture(512, 128,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    antTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.antTexture, this, "bugs/ant_final.png", 0, 48, 6, 1);

    this.beetleTexture = new Texture(512, 128,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    beetleTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.beetleTexture, this, "bugs/beetle_final.png", 0, 48, 6, 1);

    this.beeTexture = new Texture(512, 128,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.beeTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.beeTexture, this, "bugs/bee_final.png", 0, 48, 6, 1);

    this.flyTexture = new Texture(512, 128,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.flyTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.flyTexture, this, "bugs/fly_final.png", 0, 48, 6, 1);

    this.spiderTexture = new Texture(512, 128,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.SpiderTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.spiderTexture, this, "bugs/spider_final.png", 0, 48, 6, 1);

    this.ballTexture = new Texture(512, 512,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    BaseSpriteBackgroundnow.hitBallTextureRegion = TextureRegionFactory
            .createTiledFromAsset(this.ballTexture, this, "ball_final.png",
                    0, 32, 3, 8);

    splash_texture = new Texture(256, 256, TextureOptions.BILINEAR);

    spider_splash_texture_region = TextureRegionFactory
            .createTiledFromAsset(this.splash_texture, this,
                    "splat_images.png", 0, 32, 6, 4);
    blood_splash_texture = new Texture(128, 64, TextureOptions.BILINEAR);
    blood_splashTextureRegion = TextureRegionFactory.createTiledFromAsset(
            this.blood_splash_texture, this, "splash_sprite_final.png", 0,
            32, 4, 1);
    try {
        SoundFactory.setAssetBasePath("sounds/");
        BallHitSound = SoundFactory.createSoundFromAsset(
                this.mEngine.getSoundManager(),
                BaseSpriteBackgroundnow.this, "fire.ogg");

        smashSound = new Sound[7];
        for (int i = 1; i <= 6; i++)
            smashSound[i] = SoundFactory.createSoundFromAsset(
                    this.getSoundManager(), this, "BugSplatSound" + i
                            + ".ogg");
        MusicFactory.setAssetBasePath("sounds/");
        BallMissHitSound = MusicFactory.createMusicFromAsset(
                this.getMusicManager(), this, "hit_miss.ogg");

    } catch (final IOException e) {
        Debug.e(e);
    }
    // Pause Menu textures

    this.mMenuTexture = new Texture(512, 512,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.mMenuResumeTextureRegion = TextureRegionFactory.createFromAsset(
            this.mMenuTexture, this, "menu_resume_b.png", 0, 0);
    this.mMenuHomeTextureRegion = TextureRegionFactory.createFromAsset(
            this.mMenuTexture, this, "menu_home_a.png", 0, 100);
    this.mMenuResetTextureRegion = TextureRegionFactory.createFromAsset(
            this.mMenuTexture, this, "menu_reset_b.png", 0, 200);
    this.mEngine.getTextureManager().loadTexture(this.mMenuTexture);
    // Level Complete menu
    levelMenuTexture = new Texture(512, 512,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    levelMenuRestartTextureRegion = TextureRegionFactory.createFromAsset(
            levelMenuTexture, this, "menu_replay_c.png", 0, 0);
    levelMenuCancelTextureRegion = TextureRegionFactory.createFromAsset(
            levelMenuTexture, this, "menu_home_a.png", 0, 100);
    levelMenuNextTextureRegion = TextureRegionFactory.createFromAsset(
            levelMenuTexture, this, "menu_nextlevel_c.png", 0, 200);
    menu_star_anim_texture1 = new Texture(256,256,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.menuStarTextureRegion = TextureRegionFactory.createFromAsset(
            this.menu_star_anim_texture1, this,  "star_1.png", 32, 0);

    menu_star_anim_texture2 = new Texture(256,256,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.menuStarTextureRegion2 = TextureRegionFactory.createFromAsset(
            this.menu_star_anim_texture2, this, "star_1.png", 32, 0);

    menu_star_anim_texture3 = new Texture(256,256,
            TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.menuStarTextureRegion3 = TextureRegionFactory.createFromAsset(
            this.menu_star_anim_texture3, this,  "star_1.png", 32, 0);

    this.mEngine.getTextureManager().loadTexture(
            this.menu_star_anim_texture1);
    this.mEngine.getTextureManager().loadTexture(
            this.menu_star_anim_texture2);
    this.mEngine.getTextureManager().loadTexture(
            this.menu_star_anim_texture3);
    this.mEngine.getTextureManager().loadTexture(this.levelMenuTexture);

    this.mEngine.getTextureManager().loadTextures(this.splash_texture,
            this.antTexture, this.beeTexture, this.beetleTexture,
            this.flyTexture, spiderTexture, this.ballTexture,
            game_over_font_texture, scorePopUp_font_texture,
            scoreBoard_Font_texture, time_font_texture, pause_btn_texture,
            play_btn_texture, ScorePopup_texture, blood_splash_texture,
            scoreboard_background_texture, menu_bg_texture);
    this.mEngine.getFontManager().loadFont(timeUpdateFont);
    this.mEngine.getFontManager().loadFont(game_over_font);
    this.mEngine.getFontManager().loadFont(scorePopUp_font);
    this.mEngine.getFontManager().loadFont(scoreBoard_Font);
    // this.enableAccelerometerSensor(this);
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T13:05:28.333

制作带有背景的预加载器场景。加载纹理时，它将显示带有标签或广告的图片。它还使您的应用程序更具吸引力。

```
public class Main extends BaseGameActivity {

    public static Camera mCamera;

    //Scenes
    public static MainState _MainState;
    private static Scene PreloaderScene;

    private static BitmapTextureAtlas Preloader_Texture;
    private static TextureRegion Preloader_TR;
    private static Sprite Preloader_Sp;

    private static boolean GameLoaded = false;

    public static Engine thisEngine;

    @Override
    protected void onCreate(final Bundle pSavedInstanceState) {
        super.onCreate(pSavedInstanceState);
    }

    @Override
    public Engine onLoadEngine() {
     mCamera = new Camera(0, 0, CommonValues.CAMERA_WIDTH, CommonValues.CAMERA_HEIGHT);
     return new Engine(new EngineOptions(
                               true, ScreenOrientation.PORTRAIT, 
                               new RatioResolutionPolicy(CommonValues.CAMERA_WIDTH, 
                                                         CommonValues.CAMERA_HEIGHT), 
                               mCamera
                           ).setNeedsSound(true).setNeedsMusic(true));
    }

    @Override
    public void onLoadResources() {

        thisEngine = this.mEngine;
        thisEngine.enableVibrator(this);

        BitmapTextureAtlasTextureRegionFactory.setAssetBasePath("gfx/");
        Preloader_Texture = new BitmapTextureAtlas(512, 1024, TextureOptions.DEFAULT);
        Preloader_TR = BitmapTextureAtlasTextureRegionFactory.createFromAsset(
                                           Preloader_Texture, 
                                           Main.this, "menu/loading_scr.jpg", 0, 0
                       );
        thisEngine.getTextureManager().loadTextures(Preloader_Texture);
    }

    public Scene onLoadScene() {

        PreloaderScene = new Scene();
        PreloaderScene.setIgnoreUpdate(true);
        Preloader_Sp = new Sprite(0, 0, Preloader_TR);
        PreloaderScene.attachChild(Preloader_Sp);

        GameLoaded = false;

        // showing preloader scene and loading resources in asynctask

        IAsyncCallback callback = new IAsyncCallback() {

            @Override
            public void workToDo() {
                Textures.LoadTextures(Main.this);
            }

            @Override
            public void onComplete() {
                GameLoaded();
            }
        };
        //Fixed variant working with gles1 and gles2
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                new AsyncTaskLoader().execute(callback);
            }
        });
        //Старый вариант. Не работает в GLES2
        //new AsyncTaskLoader().execute(callback);

        return PreloaderScene;
    }

    /**
     * Textures are loaded = hiding preloader and showing main scene
     */
    protected void GameLoaded() {
        GameLoaded = true;

        _MainState = new MainState(Main.this);
        mEngine.setScene(_MainState);

        PreloaderScene = null;
        thisEngine.getTextureManager().unloadTextures(Preloader_Texture);
        Preloader_Texture = null;
        Preloader_Sp = null;

        _MainState.ShowMainScreen();
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {
            if (_MainState != null) {
                _MainState.onKeyDown(keyCode, event);
                return true;
            }
        }

        return super.onKeyDown(keyCode, event);
    }

    @Override
    public void onLoadComplete() {
    }

    @Override
    public void onPauseGame() {
        super.onPauseGame();
        if (!GameLoaded) return;
        if (_MainState != null) _MainState.PauseGame();

    }

    @Override
    public void onResumeGame() {
        super.onResumeGame();
        if (!GameLoaded) return;
        if (_MainState != null) _MainState.UnPauseGame();
    }

}

    public abstract void workToDo();
    public abstract void onComplete();
}
// class AsyncTaskLoader:
public class AsyncTaskLoader extends AsyncTask<IAsyncCallback, Integer, Boolean> {

    IAsyncCallback[] _params;

    @Override
    protected Boolean doInBackground(IAsyncCallback... params) {
        this._params = params;
        int count = params.length;
        for (int i = 0; i < count; i++) {
            params[i].workToDo();
        }
        return true;
    }

    @Override
    protected void onPostExecute(Boolean result) {
        int count = this._params.length;
        for (int i = 0; i < count; i++) {
            this._params[i].onComplete();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T22:35:46.383

与其使用不同的活动，不如尝试使用一项活动和许多不同的场景。它更快，没有黑屏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:19:56.380

发生这种情况是因为加载资源需要一些时间。我建议制作一个启动画面（加载屏幕）。

# android - Android 获取 USB 设备内存的总大小和可用大小

> ID：11451659
> 
> 赞同：0
> 
> 时间：2012-07-12T12:16:48.133
> 
> 标签：android, usb

通过编程方式访问 USB 设备内存。

1.  获取 USB 设备总内存大小。
2.  获取 USB 设备总可用（可用）内存大小。

我知道内部/外部存储器的内存大小

```
File path = Environment.getDataDirectory();
StatFs stat = new StatFs(path.getPath());
long blockSize = stat.getBlockSize();
long availableBlocks = stat.getAvailableBlocks();
String availableMemory =  Formatter.formatFileSize(this, availableBlocks * blockSize);
Log.i("","Available MB : " + availableMemory); 
```

此代码不适用于识别 USB 设备存储器。

怎么找`USB Device Memory`。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:22:57.263

嗨，请使用下面的代码...

```
 StatFs statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath());        
     long blockSize = statFs.getBlockSize();
     long totalSize = statFs.getBlockCount()*blockSize;
     long availableSize = statFs.getAvailableBlocks()*blockSize;
     long freeSize = statFs.getFreeBlocks()*blockSize; 
```

如果你在 MB 中很好，那么

```
long megAvailable = availableSize/ (1024 * 1024);
Log.e("","Available MB : "+megAvailable); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:28:27.793

使用这个使用[StatFs](http://developer.android.com/reference/android/os/StatFs.html)类的辅助类：

```
public class MemoryUsage{
        /*
        Returns size in MegaBytes.

       */
            public int TotalMemory()
            {
                StatFs statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath());    
                int Total = (statFs.getBlockCount() * statFs.getBlockSize()) / 1048576;
                return Total;
            }

            public int FreeMemory()
            {
                StatFs statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath()); 
                int Free  = (statFs.getAvailableBlocks() * statFs.getBlockSize()) / 1048576;
                return Free;
            }

            public int BusyMemory()
            {
                StatFs statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath());    
                int Total = (statFs.getBlockCount() * statFs.getBlockSize()) / 1048576;
                int Free  = (statFs.getAvailableBlocks() * statFs.getBlockSize()) / 1048576;
                int Busy  = Total - Free;
                return Busy;
            }
} 
```

如果您需要计算内部内存，请更改此：

```
 StatFs statFs = new StatFs(Environment.getExternalStorageDirectory().getAbsolutePath()); 
```

对此：

```
 StatFs statFs = new StatFs(Environment.getRootDirectory().getAbsolutePath()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:48:33.907

您需要比“不起作用”更具体。

1.  你发现了什么行为？
2.  你得到了一个错误，还是你得到了零？
3.  你用的是模拟器还是设备？
4.  您使用的是具有多个外部存储的系统吗？

一个很好的例子：[Android 获得内部/外部内存的可用大小](https://stackoverflow.com/questions/8133417/android-get-free-size-of-internal-external-memory)

此外，如果未将默认存储设置为 USB 设备，则很难检测到 USB 设备。所有 Environment.* 文件夹/路径 API 都将返回

参考： http: [//developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory())

> 注意：不要被这里的“外部”这个词弄糊涂了。最好将此目录视为媒体/共享存储。它是一个文件系统，可以保存相对大量的数据，并且在所有应用程序之间共享（不强制执行权限）。传统上这是一张 SD 卡，但它也可以作为设备中的内置存储实现，与受保护的内部存储不同，并且可以作为文件系统安装在计算机上。

然后还有另一个 API 可能是您要检查的，而不是数据目录。

参考： http: [//developer.android.com/reference/android/os/Environment.html#getExternalStoragePublicDirectory(java.lang.String)](http://developer.android.com/reference/android/os/Environment.html#getExternalStoragePublicDirectory(java.lang.String))

这是摩托罗拉及其用于处理此类情况的特定 API，但根据您的特定问题，这可能不是您想要的：http: [//developer.motorola.com/docs/motorola-external-storage-api/](http://developer.motorola.com/docs/motorola-external-storage-api/)

无论如何，我希望这对您的问题有所帮助。如果没有，请提供更多信息，StackOverflow 的优秀人员将以他们通常的出色方式提供帮助。

希望这可以帮助。

# mysql - 如何通过查询使用mysql组

> ID：11451667
> 
> 赞同：1
> 
> 时间：2012-07-12T12:17:18.853
> 
> 标签：mysql, group-by, status

我有一个表，其中包含 Name、EmailId、Process、Status 列，如下所示。

```
**Input**

   Name       EmailId                Process      Status    
   apple1     apple@fruits.com       process1     Closed
   apple2     apple@fruits.com       process2     In Progress
   apple3     apple@fruits.com       process3     Complete      
   orange1    orange@fruits.com      process1     Closed
   orange2    orange@fruits.com      process2     Closed
   oran       orange@fruits.com      process3     Closed
   mango1     mango@fruits.com       process1     To Start 
```

现在我想要的是所有进程的状态都关闭的人的 emailId 和状态 - Process1，process2，process 3

```
**Output**

EmailId              Status    
orange@fruits.com    Closed 
```

由于橙色的所有进程都已关闭，因此我有上面的行类似地，我希望拥有进程已关闭的表的所有电子邮件 ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:19:57.450

要找到这一点，您可以使用聚合`COUNT()`来查找`HAVING`子句中的 count = 3，因此所有三个都是关闭的：

```
SELECT
  EmailId,
  /* How many different processes are closed per EmailId */
  COUNT(DISTINCT Process) AS numclosed
FROM
  yourtable
WHERE Status = 'Closed'
GROUP BY EmailId
/* Return only those with 3 processes closed */
HAVING numclosed = 3 
```

如果可能的进程数不完全是 3 并且您需要考虑所有这些，我相信您可以在`HAVING`子句中使用子查询来查找可能的进程的实际数量

```
SELECT
  EmailId,
  COUNT(DISTINCT Process) AS numclosed
FROM
  yourtable
WHERE Status = 'Closed'
GROUP BY EmailId
/* Compare the number closed for this EmailId against the number of possible Process values in the table */
HAVING numclosed = (SELECT COUNT(DISTINCT Process) FROM yourtable) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:40:15.293

其他方式：

```
SELECT 
    EmailId
FROM
    tableX AS t
GROUP BY 
    EmailId
HAVING
    COUNT( CASE WHEN Status <> 'Closed'
             THEN 1 
           END
         ) = 0 ; 
```

或者：

```
SELECT 
    t.EmailId
FROM
    ( SELECT DISTINCT EmailId
      FROM tableX 
    ) AS t
  LEFT JOIN
    tableX AS tt
      ON  tt.EmailId = t.EmailId
      AND tt.Status <> 'Closed'
WHERE
    tt.EmailId IS NULL ; 
```

# c# - 三元运算符 c#

> ID：11451674
> 
> 赞同：-4
> 
> 时间：2012-07-12T12:17:43.590
> 
> 标签：c#

在 php 中，我可以这样做：

```
$var = if($var2 == 3) ? $var : null; 
```

但是我怎么能在 C# 中做到这一点？

```
user_email.Content = if(dr["user_email"] == "") ? dr["user_email"] : null; 
```

不工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:18:45.897

```
user_email.Content = (dr["user_email"] != null && dr["user_email"] != "") ? dr["user_email"]: null; 
```

**? 的语法：运算符 (C#)：**

```
condition ? first_expression : second_expression; 
```

条件运算符 (?:) 根据布尔表达式的值返回两个值之一。条件运算符的形式为

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:21:44.033

我宁愿用以下方式重写它

```
user_email.Content = !string.IsNullOrEmpty(dr["user_email"]) ? dr["user_email"]: null; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:18:36.000

删除如果

```
user_email.Content =  dr["user_email"] == "" ? dr["user_email"]: null; 
```

你会得到一个警告（可能是错误的结果）：

> 可能的意外参考比较；要进行值比较，请将左侧转换为“字符串”

所以你可以尝试：

```
user_email.Content =  dr["user_email"].ToString() == "" ? dr["user_email"]: null; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-03T08:50:52.327

要使其编译只需删除 `if`：

```
user_email.Content = (dr["user_email"] == "") ? dr["user_email"]: null; 
```

我想说这个运算符并不总是易于阅读，尤其是在这种情况下（没有冒犯！）。为了使其更具可读性，我总是将其写成三行：

```
user_email.Content = (dr["user_email"] == "") 
    ? dr["user_email"]
    : null; 
```

但这只是一个建议^_^

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:20:12.043

它被称为[三元运算符](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.100%29.aspx)

```
 user_email.Content = dr["user_email"] == "" ? dr["user_email"] : null; 
```

由于将内容设置为`string.Empty`if it is`string.Empty`和 else to`null`似乎有点疯狂，我怀疑你的实际意思是这样的。

```
user_email.Content = dr["user_email"] == string.Empty ? null : dr["user_email"]; 
```

但是，如果`dr["user_email"]`实际上已经是，`null`那么您最好使用以下内容，因为在前面的示例中，空值会引发异常。

```
var emailValue = dr["user_email"];
user_email.Content = string.IsNullOrWhiteSpace(emailValue) ? null : emailValue; 
```

使用`emailValue`变量可以避免使用`dr`访问器两次。

# javascript - 如果数组为空JQplot，如何更改动态创建的数组？

> ID：11451676
> 
> 赞同：0
> 
> 时间：2012-07-12T12:17:51.537
> 
> 标签：javascript, arrays, dynamic, jqplot

我正在尝试创建一个具有恒定线和动态生成线的折线图。在我没有将任何值传递给数组的那一刻，jqplot 不会为我的动态线绘制任何东西。

如果动态行为空或仅说 5 个值中的 1 个，我希望 jqplot 具有默认值 1，例如，如果数组生成 []，它希望它生成 [[1]，[1]， [1],[1],[1]] 如果数组生成 [[4],[3],[],[],[]] 我希望它能够在空数组中放入 1例如 [[4],[3],[1],[1],[1]]

对此的任何帮助将不胜感激。

这是我到目前为止的一些代码；

```
 var values = $('input:radio:checked').map(function () { 
return this.value
}).get(); 

var line1 =[[1,values[0],1], [2,values[1],1], [3,values[2],1], [4,values[3],1],[5,values[4],1]];
var line2 =[[1,4],[2,5],[3,4],[4,5],[5,5]];

 $.jqplot('chartdiv',  [line2,line1],
{ 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:35:34.313

为什么不在设置数组之前检查数组的长度并采取相应措施？为此，您可以编写自己的检索值的方法，例如：

```
function getValue(index){
   return (values[index].length > 0 ? values[index] : [1];
} 
```

根据给定的代码片段，`line1`您可以像这样使用它：

```
var line1 = [[1,getValue(0),1], [2,getValue(1),1], [3,getValue(2),1], [4,getValue(3),1],[5,getValue(4),1]]; 
```

*请考虑我不是 100% 确定你在追求什么，但这是我最好的猜测 :)*

# websocket - Netty Websockets，是否可以让服务器等待客户端响应

> ID：11451679
> 
> 赞同：1
> 
> 时间：2012-07-12T12:18:09.417
> 
> 标签：websocket, netty

我一直试图弄清楚如何实现从netty websocket服务器到客户端的请求-响应，然后让服务器处理响应可能使用`channel future`java中的其他东西。

我看到了如何使用客户端向服务器发送请求并处理响应来做同样的事情 - 但不是相反。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:26:22.783

好吧，您需要与客户端建立连接，并创建一个新的处理程序，在该处理程序启动时，您将写入特定的 ip，您将需要客户端的 ip。

快速回顾：

1）与服务器建立连接（与客户端）。

2）让服务器为客户端创建一个处理程序，（提示：尝试将ip设置为参数（类型：字符串））

3）让服务器先写点东西。

4）让客户端与之交互。

5）（可选）看看客户端是否需要写回一些东西。

6）（可选）让服务器响应。

祝你的项目好运。

# perl - 内置变量$是什么意思？在 Perl 中

> ID：11451680
> 
> 赞同：3
> 
> 时间：2012-07-12T12:18:18.497
> 
> 标签：perl, system

> **可能重复：**
> [perl“美元符号和问号”问题](https://stackoverflow.com/questions/6287635/perl-dollar-sign-and-question-mark-question)

我试图理解某人编写的 Perl 脚本。我不明白`$?`脚本中的使用。谁能解释我下面一行的目的？

```
 system( "perform_task.sh", "-param1");
    if( ( $? >> 8 ) != 0 ) {
       print( "perform_task.sh failed " );
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-12T12:35:31.853

要查找任何变量的含义，您可以键入

```
$ perldoc -v '$?'
```

在命令行上使用相对较新版本的 Perl 或扫描`perldoc perlvar`安装在您的计算机上。通常，最好阅读`perl`您所拥有的特定版本的文档，但在紧要关头，请记住由于版本差异而可能出现的任何问题，在线版本也可以：[perldoc -v '$?'](http://perldoc.perl.org/perlvar.html#%24?) ：

> 最后一个管道关闭、反引号 ( ````) 命令、成功调用`wait()`or`waitpid()`或`system()`操作员返回的状态。这只是传统 Unix`wait()`系统调用返回的 16 位状态字（或者被编造出来的样子）。因此，子进程的退出值是真的`($? >> 8)`，并`$? &amp; 127`给出进程死于哪个信号（如果有），并`$? & 128`报告是否存在核心转储。

[可以从perldoc -f system](http://perldoc.perl.org/functions/system.html)的文档中收集更多信息：

> 如果您想手动检查“系统”的故障，可以通过如下检查来检查所有可能的故障模式`$?`：

```
 if ($? == -1) {
       print "failed to execute: $!\n";
   }
   elsif ($? & 127) {
       printf "child died with signal %d, %s coredump\n",
           ($? & 127),  ($? & 128) ? 'with' : 'without';
   }
   else {
       printf "child exited with value %d\n", $? >> 8;
   } 
```

虽然在 Stackoverflow 上问一些基本的问题都没有错，但如果你真的想成为一名有能力的程序员，你需要养成自己阅读文档的习惯，并培养自己理解它的能力。

否则，您将浪费宝贵的时间来解决问题，而不是等待其他人为您阅读文档。

如果您选择从不花费任何精力来尝试理解文档，这真的不会影响我们其他人，但从长远来看它会伤害您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:21:22.137

的`use English;`名称`$?`是`$CHILD_ERROR`。这是孩子的退出状态，包括导致它退出的可能信号号。见`perldoc perlvar`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-12T12:23:23.057

美元？是子进程的错误代码（perform_task.sh）。

对于您的脚本，返回代码向右移动 8 位，并将结果与​​ 0 进行比较。这意味着只有当返回代码大于 255 时，才会认为运行失败。

# c# - How to popup a page on button click?

> ID：11451682
> 
> 赞同：0
> 
> 时间：2012-07-12T12:18:27.440
> 
> 标签：c#, asp.net

I want to pop up a new page in the main page of my application . The location must be in center,can't be sizable, it shouldn't be opened as a new tab in the main page , the bar with the options for : closing,minimize/miximize shouldn't be there.

Here is my code:

```
 protected void Page_Load(object sender, EventArgs e)
        {
           HyperLink1.Attributes.Add("onclick", "window.open('WebForm1.aspx',null,'height=350, width=250,status= no, resizable= no, scrollbars=no, toolbar=no,location=center,menubar=no')");
        } 
```

But....

*   It's sisable,location is not in not in the center of the page.

*   The page is opened in the main page but as a new tab.

*   I don't know how to remove the bar with : closing,maximize,minimize

Can someone help me?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:27:40.733

Try this:

```
protected void Page_Load(object sender, EventArgs e)
        {
           HyperLink1.Attributes.Add("onclick", "centeredPopup('WebForm1.aspx','myWindow','500','300','yes');return false");
        }

<script language="javascript">
var popupWindow = null;
function centeredPopup(url,winName,w,h,scroll){
LeftPosition = (screen.width) ? (screen.width-w)/2 : 0;
TopPosition = (screen.height) ? (screen.height-h)/2 : 0;
settings =
'height='+h+',width='+w+',top='+TopPosition+',left='+LeftPosition+',scrollbars='+scroll+',resizable'
popupWindow = window.open(url,winName,settings)
}
</script> 
```

[For more details - see this](http://www.quackit.com/javascript/popup_windows.cfm)

# c++ - C++ - 将 auto_ptrs 放入 shared_ptr 向量中

> ID：11451687
> 
> 赞同：0
> 
> 时间：2012-07-12T12:18:39.477
> 
> 标签：c++, memory-management, smart-pointers

我有一个 shared_ptrs 的向量。我目前正在将 auto_ptrs 放入其中。没关系还是会破裂？

房间.hpp：

```
vector<shared_ptr<Item>> items;
void addItem(auto_ptr<Item>); 
```

主要的：

```
room.addItem(auto_ptr<Item>(new Item(...))); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T12:21:29.070

不。`auto_ptr`由于其奇怪的所有权语义，在 C++11 中已被弃用并从一开始就受到批评。复制一个`auto_ptr`将所有权转移到复制的对象。在您的情况下，这可能没问题，但如果您这样做，例如：

```
auto_ptr<Item> x = room[1]; // ouch 
```

事情开始变得丑陋。

`std::shared_ptr`如果您需要共享所有权，请使用 a ，如果不需要，请使用 a `std::unique_ptr`。如果您没有 C++11 编译器，请使用 Boost.SmartPointers。如果您仅将指针用于多态性而不是共享所有权，那么还有一个[Boost.Pointer 容器。](http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/ptr_container.html)

如果您真的想以这种方式保留您的 API，您需要使用：

```
addItem(auto_ptr<Item>&&); 
```

请记住，`auto_ptr`之后将是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:48:06.153

1.  不要`auto_ptr`在任何 STL 容器中使用。并且根本不要使用`auto_ptr`！**关于gotw**`auto_ptr`的麻烦有一篇很好的文章：[GotW#25](http://www.gotw.ca/gotw/025.htm)。

***   使用`boost::ptr_vector`.** 

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T13:08:59.630

这将起作用 -`shared_ptr`具有从`auto_ptr`.

但是，`auto_ptr`最好避免使用，因为它具有奇怪的破坏性复制语义；在 C++11 中，`unique_ptr`对于单一可转让所有权应该是首选。这也可以用来初始化一个`shared_ptr`.**

# sharepoint - 尝试使用 powershell 添加字段会引发错误

> ID：11451692
> 
> 赞同：1
> 
> 时间：2012-07-12T12:18:47.653
> 
> 标签：sharepoint, powershell, xsd, metadata, field

当我尝试通过 powershell 添加一个新字段，类型为分类法（托管元数据）时，方法是：AddFieldAsXml，它给我一个错误：

```
Error while adding field :  Exception calling "AddFieldAsXml" with "1" argument(s): "The object has been updated by another user since it was last fetched." 
```

奇怪的是我正在添加该字段，因此它不能被其他用户修改或更新！它可以 ？

如果你有想法？谢谢

# ios - 核心数据删除错误

> ID：11451698
> 
> 赞同：0
> 
> 时间：2012-07-12T12:19:19.793
> 
> 标签：ios, core-data, nsfetchedresultscontroller

尝试从与获取的结果控制器挂钩的 tableview 中删除行时出现以下错误：

*** -[UITableView _endCellAnimationsWithContext:], /SourceCache/UIKit_Sim/UIKit-1914.84/UITableView.m:1037 2012-07-12 13:11:19.921 Chef[28843:12203] 中的断言失败 ***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序'，原因：'无效更新：第0节中的行数无效。更新后现有节中包含的行数（20）必须等于更新前该节中包含的行数（20），加上或减去从该部分插入或删除的行数（0 插入，1 删除），加上或减去移入或移出该部分的行数（0 移入，0 移出）。

我的代码如下。

```
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
if (editingStyle == UITableViewCellEditingStyleDelete) {

    // Delete the record from the DB
    RecipeCategory *objectToBeDeleted = [self.fetchedResultsController objectAtIndexPath:indexPath];
    [self.context deleteObject:objectToBeDeleted];

    // Delete the row from the data source
    [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

}   
else if (editingStyle == UITableViewCellEditingStyleInsert) {
    // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
}   
} 
```

使用获取请求计数和方法 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section，我尝试记录 DB 记录数，以及行前后表中的行数[self.context deleteObject:objectToBeDeleted];，它们都从 20 减少到 19。

请帮忙！

编辑： PS 错误发生在 deleteRowsAtIndexPath 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T16:07:17.377

事实证明，下面的代码行超出了要求。我猜 NSFetchedResultsController 也可以处理这个问题。我还必须实现 NSFetchedResultsController 的委托方法。

```
// Delete the row from the data source
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade]; 
```

# php - Imagick 无法获得 pdf

> ID：11451700
> 
> 赞同：0
> 
> 时间：2012-07-12T12:19:27.563
> 
> 标签：php, pdf, imagick

我有这部分代码：

```
$im = new Imagick( $pdf_file );
            $im->setImageFormat( "png" );
            $im->scaleImage( 100, 100, true ); 
```

但我收到以下错误：`unable to open image`on`Imagick->__construct('/home/server/...')`

pdf 文件大小为 8MB，但如果我放置一个大小为 3 或 4 MB 的 pdf 文件，它就可以工作。有没有办法制作`Imagick`更大尺寸的文件？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:32:25.390

可能是你`memory_limit`的小于 8MB。检查它

`var_dump(ini_get('memory_limit'));`

您还可以在 php.ini 之外进行设置

`ini_set('memory_limit', '8M');`

# php - 命中计数器重置/随机下降非常低

> ID：11451701
> 
> 赞同：0
> 
> 时间：2012-07-12T12:19:30.260
> 
> 标签：php, counter

我正在使用以下基本 PHP：

```
<?php

    if (file_exists('count_file.txt')) 
    {
        $fil = fopen('count_file.txt', r);
        $dat = fread($fil, filesize('count_file.txt')); 
        echo $dat+1;
        fclose($fil);
        $fil = fopen('count_file.txt', w);
        fwrite($fil, $dat+1);
    }

    else
    {
        $fil = fopen('count_file.txt', w);
        fwrite($fil, 1);
        echo '1';
        fclose($fil);
    }
?> 
```

作为一个命中计数器（我宁愿没有一个，但我们坚持要这样做）。txt 文件记录了点击次数并且它可以工作......但是计数器随机（有时在几周后，有时在几个月后）决定跳闸并从 4300 下降到 11。谁能告诉我如何纠正这个作为越来越烦人了？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:25:07.813

filesize 函数告诉您文件中的字节数。PHP.net 可以向您描述该函数是如何工作的。您应该从文件中读取一行（fgets）而不是使用该函数（该行应该有命中计数），然后将命中计数加一，然后重新保存。

让我给你打个比方。你在厨房里，你拿出一个蓝莓容器，你想知道有多少蓝莓，但你却问容器它有多少英寸长。然后你把所有的蓝莓都扔掉，把英寸数 + 1 的蓝莓放在容器里。这没有任何意义，但这就是你的脚本所做的。如果您更改以下行： $dat = fread($fil, filesize('count_file.txt')); TO $dat = fgets($fil); 您应该阅读您有多少蓝莓，在该数字上加一并重新保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:22:03.567

您没有使用任何锁定。如果两个或多个请求同时访问您的服务器，它们将相互干扰对方的文件操作。这种事情最好在数据库中完成。

# android - JSON 解析器性能低下

> ID：11451703
> 
> 赞同：1
> 
> 时间：2012-07-12T12:19:36.803
> 
> 标签：android, json, http, parsing, request

我在这里重新发布以获得一些帮助。

我做了一个 JSON Parser，它返回一个 JSONArray（为了从我的 WebService 获取信息）。

当我在 IceScreamSandwich 上测试它时，我的最后一个代码抛出了 NetworkException 错误（在 2.3.3 版本上它很长但工作良好）。

我更改了我的代码以停止它并尝试获得更好的性能..但它仍然无法在我的 ICS 手机上运行：现在没有更多错误但出现 ioexcepetion：“无法从 JSON URL 读取”..

我向您展示我的活动：

```
public class TabNewsJSONParsingActivity extends ListActivity 
```

{

```
// url to make request
private static String url = "http://developer.prixo.fr/API/GetEvents?zone=8";

//JSON names
private static final String TAG_content = "content";
private static final String TAG_zone = "zone";
private static final String TAG_id = "id";
private static final String TAG_area = "area";
private static final String TAG_title = "title";
private static final String TAG_date = "date";
private static final String TAG_author = "author";

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.onglet_news);

    // Hashmap for ListView
    ArrayList<HashMap<String, String>> newsList = new ArrayList<HashMap<String, String>>();

    // Creating JSON Parser instance
    JSONParser jParser = new JSONParser();

    // getting JSON string from URL
    JSONArray json;
    try {
        json = jParser.getJSONFromUrl1(url);

                for(int i=0; i < json.length(); i++)
                {
                    JSONObject child = json.getJSONObject(i);

                    String id = child.getString(TAG_id);
                    String title = child.getString(TAG_title);
                    String content = child.getString(TAG_content);
                    String date = child.getString(TAG_date);
                    String author = child.getString(TAG_author);
                    String zone = child.getString(TAG_zone);
                    String area = child.getString(TAG_area);

                    // creating new HashMap
                    HashMap<String, String> map = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map.put(TAG_content, content);
                    map.put(TAG_title, title);
                    map.put(TAG_author, author);

                    // adding HashList to ArrayList
                    newsList.add(map);
                }
            }
        catch (JSONException e) {
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    /**
     * Updating parsed JSON data into ListView
     * */
    ListAdapter adapter = new SimpleAdapter(this, newsList,R.layout.onglet_news_listitem,new String[] { TAG_content, TAG_title, TAG_author }, new int[] {R.id.name, R.id.email, R.id.mobile });
    setListAdapter(adapter);

    // selecting single ListView item
    ListView lv = getListView();

    // Launching new screen on Selecting Single ListItem
    lv.setOnItemClickListener(new OnItemClickListener() 
    {
        public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
            // getting values from selected ListItem
            String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
            String cost = ((TextView) view.findViewById(R.id.email)).getText().toString();
            String description = ((TextView) view.findViewById(R.id.mobile)).getText().toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(), TabNewsSingleMenuItemActivity.class);
            in.putExtra(TAG_content, name);
            in.putExtra(TAG_title, cost);
            in.putExtra(TAG_author, description);
            startActivity(in);

        }
    });
}

public boolean onOptionsItemSelected(MenuItem item) 
{   
   //On regarde quel item a été cliqué grâce à son id et on déclenche une action
   switch (item.getItemId()) 
   {
      case R.id.credits:
         //pop up
        Toast.makeText(TabNewsJSONParsingActivity.this, "Un delire", Toast.LENGTH_SHORT).show();
         return true;
      case R.id.quitter:
         //Pour fermer l'application il suffit de faire finish()
         finish();
         return true;
   }
 return false;  
} 
```

}

还有我的解析器：

公共类 JSONParser {

```
static InputStream is = null;
static JSONObject jObj = null;
static String jsonstr = "";

public JSONParser() {}

 // throws IOException just to tell the caller that something bad happened (and 
 // what) instead of simply returning 'null' without any more information.
 public JSONArray getJSONFromUrl1(String url) throws IOException 
 {
     try 
     {
         // should be a member of the parser to allow multiple calls without recreating the client every time.
         DefaultHttpClient httpClient = new DefaultHttpClient();
         // Using POST means sending data (or it its not following HTTP RFCs)
         //HttpPost httpPost = new HttpPost(url);
         HttpGet httpGet = new HttpGet(url);

         // Here the client may not be entirely initialized (no timeout, no agent-string).
         HttpResponse httpResponse = httpClient.execute(httpGet);
         //HttpResponse httpResponse = httpClient.execute(httpPost);

         HttpEntity httpEntity = httpResponse.getEntity();

         // The native utility function is also handling other charsets
         String httpString = EntityUtils.toString(httpEntity);

         return new JSONArray(httpString);
     } catch (IOException ioe) {
     throw ioe;
     } catch (Exception ex) {
     throw new IOException("Failed to read JSON from Url");
     }
 } 
```

}

谁知道如何获得更好的性能并使其成为 4.0 的朗姆酒？如何将它与 Async Task 一起使用？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:21:56.610

你需要使用 AsyncTask 来下载和解析你的数据

下面的代码

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.StrictMode;
import android.view.MenuItem;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;
import android.widget.Toast;

public class TabNewsJSONParsingActivity extends ListActivity
{
    static{
        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();

        StrictMode.setThreadPolicy(policy);
    }

    // url to make request
    private static String url = "http://developer.prixo.fr/API/GetEvents?zone=8";

    //JSON names
    private static final String TAG_content = "content";
    private static final String TAG_zone = "zone";
    private static final String TAG_id = "id";
    private static final String TAG_area = "area";
    private static final String TAG_title = "title";
    private static final String TAG_date = "date";
    private static final String TAG_author = "author";

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.onglet_news);

        // selecting single ListView item
        ListView lv = getListView();

        // Launching new screen on Selecting Single ListItem
        lv.setOnItemClickListener(new OnItemClickListener() 
        {
            public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
                // getting values from selected ListItem
                String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
                String cost = ((TextView) view.findViewById(R.id.email)).getText().toString();
                String description = ((TextView) view.findViewById(R.id.mobile)).getText().toString();

                // Starting new intent
                Intent in = new Intent(getApplicationContext(), TabNewsSingleMenuItemActivity.class);
                in.putExtra(TAG_content, name);
                in.putExtra(TAG_title, cost);
                in.putExtra(TAG_author, description);
                startActivity(in);

            }
        });

        new DownloadData().execute();
    }

    public boolean onOptionsItemSelected(MenuItem item) 
    {   
       //On regarde quel item a été cliqué grâce à son id et on déclenche une action
       switch (item.getItemId()) 
       {
          case R.id.credits:
             //pop up
            Toast.makeText(TabNewsJSONParsingActivity.this, "Un delire", Toast.LENGTH_SHORT).show();
             return true;
          case R.id.quitter:
             //Pour fermer l'application il suffit de faire finish()
             finish();
             return true;
       }
     return false;  
    }

    private class DownloadData extends AsyncTask<Void, Integer, ArrayList<HashMap<String, String>>>
    {
        ProgressDialog pd = null;
        /* (non-Javadoc)
         * @see android.os.AsyncTask#onPreExecute()
         */
        @Override
        protected void onPreExecute() {
            // TODO Auto-generated method stub
            super.onPreExecute();

            pd = new ProgressDialog(TabNewsJSONParsingActivity.this);
            pd.setTitle("Downloading...");
            pd.setMessage("Please wait...");
            pd.setCancelable(false);
            pd.show();
        }

        /* (non-Javadoc)
         * @see android.os.AsyncTask#doInBackground(Params[])
         */
        @Override
        protected ArrayList<HashMap<String, String>> doInBackground(Void... params) {
            // TODO Auto-generated method stub

            // Hashmap for ListView
            ArrayList<HashMap<String, String>> newsList = new ArrayList<HashMap<String, String>>();

            // Creating JSON Parser instance
            JSONParser jParser = new JSONParser();

            // getting JSON string from URL
            JSONArray json;
            try {
                json = jParser.getJSONFromUrl1(url);

                        for(int i=0; i < json.length(); i++)
                        {
                            JSONObject child = json.getJSONObject(i);

                            String id = child.getString(TAG_id);
                            String title = child.getString(TAG_title);
                            String content = child.getString(TAG_content);
                            String date = child.getString(TAG_date);
                            String author = child.getString(TAG_author);
                            String zone = child.getString(TAG_zone);
                            String area = child.getString(TAG_area);

                            // creating new HashMap
                            HashMap<String, String> map = new HashMap<String, String>();

                            // adding each child node to HashMap key => value
                            map.put(TAG_content, content);
                            map.put(TAG_title, title);
                            map.put(TAG_author, author);

                            // adding HashList to ArrayList
                            newsList.add(map);
                        }
                    }
                catch (JSONException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            return newsList;
        }

        /* (non-Javadoc)
         * @see android.os.AsyncTask#onPostExecute(java.lang.Object)
         */
        @Override
        protected void onPostExecute(ArrayList<HashMap<String, String>> newsList) {
            // TODO Auto-generated method stub
            super.onPostExecute(newsList);
            pd.dismiss();

            /**
             * Updating parsed JSON data into ListView
             * */
            ListAdapter adapter = new SimpleAdapter(TabNewsJSONParsingActivity.this, newsList,R.layout.onglet_news_listitem,new String[] { TAG_content, TAG_title, TAG_author }, new int[] {R.id.name, R.id.email, R.id.mobile });
            TabNewsJSONParsingActivity.this.setListAdapter(adapter);

        }

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T13:23:06.633

启动你的 AsycnTask：

```
JSONTask g = new JSONTask();
g.execute(); 
```

还有一些关于如何实现它的代码；

```
public abstract class JSONTask extends AsyncTask<String, Void, String> {
@Override
protected String doInBackground(String... arg) {
  //Do http get json here
  String htpStatus= "";
  String httpJSON = "" // this is the json data from you web service

  // Create here your JSONObject...
  JSONObject json = new JSONObject(httpJSON);
  for(int i=0; i < json.length(); i++){
                JSONObject child = json.getJSONObject(i);

                String id = child.getString(TAG_id);
                String title = child.getString(TAG_title);
                String content = child.getString(TAG_content);
                String date = child.getString(TAG_date);
                String author = child.getString(TAG_author);
                String zone = child.getString(TAG_zone);
                String area = child.getString(TAG_area);

                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                // adding each child node to HashMap key => value
                map.put(TAG_content, content);
                map.put(TAG_title, title);
                map.put(TAG_author, author);

                // adding HashList to ArrayList
                newsList.add(map);
  }
  return htpStatus; // This value will be returned to your onPostExecute(result) method
}

@Override
protected void onPostExecute(String result) {

}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:25:21.943

这可能是因为您在主线程上运行 Web 连接。尝试将那段代码运行到 AsyncTask 或不同的线程中。

# c# - 如何渲染音频波形？

> ID：11451707
> 
> 赞同：5
> 
> 时间：2012-07-12T12:19:45.233
> 
> 标签：c#, audio, visualization, data-visualization, waveform

1.  是否有任何与音频/编程相关的堆栈交换站点？
2.  我正在尝试在 WinForms中制作[波形](http://www.google.com/search?q=audio%20waveform)
3.  我应该使用什么算法？

例如，如果我每个像素（垂直线）有 200 个样本，我应该从 200 个样本的那部分中抽取最低和最高样本吗？或者我应该绘制低样本和高样本的平均值吗？也许两者都有不同的颜色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-25T10:48:29.480

这将帮助您在 C# 中使用 nAudio 从音频文件生成波形...

```
using NAudio.Wave;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class test : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
    string strPath = Server.MapPath("audio/060.mp3");
    string SongID = "2";
    byte[] bytes = File.ReadAllBytes(strPath);
    WriteToFile(SongID,strPath, bytes);
    Response.Redirect("Main.aspx");
    }

private void WriteToFile(string SongID, string strPath, byte[] Buffer)
{
    try
    {
        int samplesPerPixel = 128;
        long startPosition = 0;
        //FileStream newFile = new FileStream(GeneralUtils.Get_SongFilePath() + "/" + strPath, FileMode.Create);
        float[] data = FloatArrayFromByteArray(Buffer);

        Bitmap bmp = new Bitmap(1170, 200);

        int BORDER_WIDTH = 5;
        int width = bmp.Width - (2 * BORDER_WIDTH);
        int height = bmp.Height - (2 * BORDER_WIDTH);

        NAudio.Wave.Mp3FileReader reader = new NAudio.Wave.Mp3FileReader(strPath, wf => new NAudio.FileFormats.Mp3.DmoMp3FrameDecompressor(wf));
        NAudio.Wave.WaveChannel32 channelStream = new NAudio.Wave.WaveChannel32(reader);

        int bytesPerSample = (reader.WaveFormat.BitsPerSample / 8) * channelStream.WaveFormat.Channels;

        using (Graphics g = Graphics.FromImage(bmp))
        {

            g.Clear(Color.White);
            Pen pen1 = new Pen(Color.Gray);
            int size = data.Length;

            string hexValue1 = "#009adf";
            Color colour1 = System.Drawing.ColorTranslator.FromHtml(hexValue1);
            pen1.Color = colour1;

            Stream wavestream = new NAudio.Wave.Mp3FileReader(strPath, wf => new NAudio.FileFormats.Mp3.DmoMp3FrameDecompressor(wf));

            wavestream.Position = 0;
            int bytesRead1;
            byte[] waveData1 = new byte[samplesPerPixel * bytesPerSample];
            wavestream.Position = startPosition + (width * bytesPerSample * samplesPerPixel);

            for (float x = 0; x < width; x++)
            {
                short low = 0;
                short high = 0;
                bytesRead1 = wavestream.Read(waveData1, 0, samplesPerPixel * bytesPerSample);
                if (bytesRead1 == 0)
                    break;
                for (int n = 0; n < bytesRead1; n += 2)
                {
                    short sample = BitConverter.ToInt16(waveData1, n);
                    if (sample < low) low = sample;
                    if (sample > high) high = sample;
                }
                float lowPercent = ((((float)low) - short.MinValue) / ushort.MaxValue);
                float highPercent = ((((float)high) - short.MinValue) / ushort.MaxValue);
                float lowValue = height * lowPercent;
                float highValue = height * highPercent;
                g.DrawLine(pen1, x, lowValue, x, highValue);

            }
        }

        string filename = Server.MapPath("image/060.png");
        bmp.Save(filename);
        bmp.Dispose();

    }
catch (Exception e)
    {

    }
}
public float[] FloatArrayFromStream(System.IO.MemoryStream stream)
{
    return FloatArrayFromByteArray(stream.GetBuffer());
}

public float[] FloatArrayFromByteArray(byte[] input)
{
    float[] output = new float[input.Length / 4];
    for (int i = 0; i < output.Length; i++)
    {
        output[i] = BitConverter.ToSingle(input, i * 4);
    }
    return output;
}

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-13T08:14:38.583

1.  试试 dsp.stackexchange.com

2.  每个像素有 200 个样本，您可以尝试多种方法。无论您做什么，通常最好在 0 上方和下方绘制每条垂直线，即。分别处理正负样本值。可能最简单的方法就是计算 RMS。在如此低的分辨率下，峰值可能会给您带来误导性的波形表示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:26:03.017

您可以使用代码项目中的[AudioControl](http://www.codeproject.com/Articles/4838/WaveControl)。

看看这个：[在 C# 中生成各种音频波形](http://www.smokycogs.com/blog/generating-various-audio-waveforms-in-c-sharp/)

如果最初实现您的代码，这些项目可能对您有用：

*   [高速功能丰富且易于使用的图形](http://www.codeproject.com/Articles/16350/High-Speed-Feature-Rich-and-Easy-To-Use-Graphs-and)
*   [还有这个](http://sine.ni.com/psp/app/doc/p/id/psp-317)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-18T12:06:44.103

万一有人遇到这个：

您可以将每个像素的样本视为缩放级别，在更高级别（缩小更多），出于性能原因，您可能希望对其进行二次采样。

您很可能需要一个适合屏幕的固定宽度来绘制并使用虚拟滚动（因此您可能没有几百万像素的绘制区域）。

您可以通过迭代音频数据来计算每个像素的值：跳过（滚动位置 * 每个像素的样本）+（像素 * 每个像素的样本）每个像素获取样本。这允许高性能无限缩放和滚动，因为您只读取和绘制最小量来填充视图。滚动宽度是用音频数据长度/每像素样本数计算的。

音频样本通常以两种方式之一显示，即样本范围的峰值或 rms 值。rms 值是通过对样本范围内所有值的平方求和来计算的，将总和除以样本长度，如果是平方根，则 rms 值（rms 会比平均值高一点，是感知响度的一个很好的度量）

您可以通过多种方式提高性能，例如增加子采样（导致细节丢失）、限制滚动和使绘制请求可取消，以防新的滚动在渲染之前触发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-07T16:27:04.693

只是为了记录它，如果你想让音频文件填充输出图像的宽度

```
samplesPerPixel = (reader.Length / bytesPerSample) / width ; 
```

# ios - 如何让 UISwitch 的状态反映在我的所有视图控制器中？

> ID：11451719
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:20:29.700
> 
> 标签：ios, storyboard, nsuserdefaults, uiswitch

我使用具有不同视图的故事板，在设置视图中我有一个 UISwitch。我希望这个开关影响我所有不同视图的状态。例如：如果在设置视图中关闭了开关，那么在播放视图中将没有声音。如何保存交换机的状态？

我已经搜索过，在很多地方都说你必须为此使用 NSUserDefaults，但我不完全理解它是如何工作的。我必须在 .m/.h/appdelegate.h/m 等中编写什么样的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:11:10.870

快速通读后，它似乎相当简单。

您将首先创建一个新的本地 NSUserObject：

```
NSUserDefaults *d = [NSUserDefaults standardUserDefaults]; 
```

然后，您将从任何视图中为其分配一个值，在这种情况下，我假设一个 BOOL 就足够了：

```
[d setBool:TRUE forKey:@"switchBOOL"]; 
//the key be understood by you and describes the switch 
```

并在其他视图的 viewWillLoad 中检索值：

```
NSUserDefaults *d = [NSUserDefaults standardUserDefaults];
[d boolForKey:@"switchBOOL"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:06:28.467

当用户激活开关时，您只需要在用户默认值中设置偏好值（例如声音关闭）。然后获取其他视图控制器的 viewWillAppear 或 viewDidAppear 方法中的值来保证持久性。

检查苹果关于[Preferences and Settings](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/UserDefaults/Introduction/Introduction.html#//apple_ref/doc/uid/10000059i)的文档。

# mysql - 在终端中运行我的 sql 转储

> ID：11451720
> 
> 赞同：2
> 
> 时间：2012-07-12T12:20:31.410
> 
> 标签：mysql, terminal, backup, mysqldump, dump

所以我可以创建一个转储

/Applications/MAMP/Library/bin/mysqldump -u admin -p testsite > yourdump.sql

但是如何在终端的另一台 Mac 上运行它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:49:34.853

我应该像运行这个一样简单：

```
mysql -u<user> -p dbName < db_backup.dump 
```

# c# - 如何读取 app.config 文件中定义的 basicHttpBinding

> ID：11451722
> 
> 赞同：4
> 
> 时间：2012-07-12T12:20:32.650
> 
> 标签：c#, app-config, configurationmanager, basichttpbinding

我试图弄清楚如何阅读如何阅读 app.config 文件中定义的 basicHttpBinding 部分。我试图像做端点地址一样做，但它不起作用。以下是我的端点地址：

```
private EndpointAddress EndPointAddy
{
    get
    {
        var config = ConfigurationManager.GetSection("system.serviceModel/Client") as ServiceModelSectionGroup;                
        foreach (ChannelEndpointElement endpoint in config.Client.Endpoints)
        {
            Uri address = endpoint.Address;

            if (address != null)
            {
                return new EndpointAddress(address);                         
            }          
        }
        return null;           
    }
} 
```

这是我用 BasicHttpBinding 尝试过的

```
private BasicHttpBinding Binding
{
    get
    {
        var config = ConfigurationManager.GetSection("system.serviceModel/Client") as ServiceModelSectionGroup;
        foreach (ChannelEndpointElement bindings in config.Bindings.BasicHttpBinding)
        {
            string binding = config.Bindings.BasicHttpBinding;

            if (config.Bindings.BasicHttpBinding != null)
            {
                return new BasicHttpBinding(config.Bindings.BasicHttpBinding);
            }
        }
        return null;
    } 
```

但是我收到一个错误，指出：

> “foreach 语句无法对‘System.ServiceModel.Configuration.BasicHttpBindingCollectionElement’类型的变量进行操作，因为‘System.ServiceModel.Configuration.BasicHttpBindingCollectionElement’不包含‘GetEnumerator’的公共定义”

我试过用 BasicHttpBindingElement 替换 ChannelEndpointElement 但这没有帮助。我不知道如何正确执行此操作，以便获得与端点地址相同的效果。

**编辑：** 我以为我已经解决了这个问题，但我所做的只是摆脱了错误。当我尝试调试程序时，我收到一个

> System.NullReferenceException：对象引用未设置为对象的实例

在以下点：

```
foreach (ChannelEndpointElement bindings in config.Bindings.BasicHttpBinding.Bindings) 
```

然而，即使它在这条线上失败了，我注意到它上面的线：

```
var config = ConfigurationManager.GetSection("system.serviceModel") as ServiceModelSectionGroup; 
```

也是空的。我不确定我做错了什么。

# c# - 如何创建一个包含两个 .cs 文件的页面？

> ID：11451726
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:20:39.540
> 
> 标签：c#, visual-studio-2010, windows-phone-7

这对你来说很简单：我想创建一个包含两个 .cs 文件的页面：

```
MainPage.cs
MainPage.xaml
MainPage.xaml.cs 
```

我该怎么做？提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T12:23:56.153

部分类定义允许您在多个文件之间传播类。

[http://msdn.microsoft.com/en-us/library/wa80x488.aspx](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:17:59.080

您可以像这样创建两个文件。

```
//MainPage.cs
public partial class MainPage
{
    private void DoSomething()
    {
    }
}
//MainPage2.aspx
public partial class MainPage
{
    public void GetSomething()
    {
        DoSomething();
    }
} 
```

# recursion - F# 中序列的递归函数

> ID：11451727
> 
> 赞同：5
> 
> 时间：2012-07-12T12:20:40.047
> 
> 标签：recursion, f#, sequence

相当琐碎的问题，但快速的谷歌搜索并没有给我答案。

为序列编写递归函数的标准方法是什么？对于列表，您将使用空列表和头+尾模式进行模式匹配，序列的等价物是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T12:30:08.913

没有标准的方法可以这样做，因为您很少为序列编写递归函数。

[您应该查看Seq 模块](http://msdn.microsoft.com/en-us/library/ee353635.aspx)中的各种高阶函数。它们通常绰绰有余，因此您不必自己编写递归函数。

要递归地生成序列，序列表达式是一种简单直观的方法：

```
let rec allFiles dir =
    seq { yield! Directory.GetFiles dir
          for d in Directory.GetDirectories dir do
            yield! allFiles d } 
```

如果你必须分解一个序列并递归地操作它，你就做错了。您应该从 F# PowerPack 操作`List`或[LazyList](http://fsharppowerpack.codeplex.com/SourceControl/changeset/view/68767#685030)，并将结果转换回序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:27:31.753

没有办法得到序列的尾部，因为它没有被评估（理论上可能是无限的），所以你不能递归地将尾部传递给函数。您只需使用 Seq.iter 或 yield！通过序列。

# javascript - Raphael.js 图像填充不会不断更新

> ID：11451728
> 
> 赞同：3
> 
> 时间：2012-07-12T12:20:42.800
> 
> 标签：javascript, raphael

我确实有一个`Paper.path()`充满简单纹理的拉斐尔：

```
var fill = screen.path(Iso.topFacePath(top)).attr({
  fill: 'url(http://www.example.com/mytexture.jpg)',
}); 
```

用户可以通过拖放更改路径。为此，我使用`Element.drag()`绑定处理程序。

我现在遇到的问题是，虽然`onmove`调用了 -handler 函数，但有问题的元素将被重新计算并且必须再次绘制。显然这对拉斐尔来说“太多了”，填充图案将随机消失（闪烁）并在一段时间后再次出现（最迟`onend`）。

我使用的实际代码有点过多，无法在此处发布，但我构建了一个**[小提琴](http://jsfiddle.net/rfWNR/21/)**，您可以在其中看到发生了什么（您可以拖动四边形的上边）。

有一个简单的解决方法吗？

我习惯于画布而不是拉斐尔（实际上这是我第一次真正使用拉斐尔）所以也许我每次改变时重绘所有东西的方法是完全错误的？

**编辑：**我刚刚发现这似乎也与浏览器相关。Chrome 和 Firefox 会产生闪烁，而 Safari 似乎一切正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T09:57:44.457

这似乎是缓存问题（raphael.js 不会*缓存*位图填充，并且会在每次更改时重新加载它）并且（对我而言）由**[GitHub 上的这个拉取请求](https://github.com/DmitryBaranovskiy/raphael/pull/592#issuecomment-6963441)**修复（截至 2012 年 8 月 14 日）仍待处理.

Raphael 很难/不可能自己构建，因为 make 文件指向本地和/或不存在的文件，但是您可以手动连接所有内容，修改构建脚本或使用**[示例](http://www.latinovotemap.org/map/)**中使用的修改后的构建来获取修复。

让我们希望它能在 Raphael 的未来版本中找到自己的方式。

# wordpress - 使用 WordPress 创建高级内容部分

> ID：11451729
> 
> 赞同：0
> 
> 时间：2012-07-12T12:20:46.007
> 
> 标签：wordpress

我需要创建一个具有“高级”内容部分的 WordPress 支持的网站。

我希望所有内容都可以访问，但是在访问者查看了高级部分（例如 5 次）后，我想要求他们注册（姓名和电子邮件地址）以继续查看高级内容。

我找到了一个名为 WP-Members 的 WordPress 插件，但它看起来无法判断用户访问网站某个部分的次数。

有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T05:36:46.667

尝试像愿望清单成员这样的插件，它没有非注册成员的查看限制，但您有短代码来定义登录和未登录用户可以看到的内容。

顺便说一句，根据视图限制用户不是一个好主意，如果他们更改 IP 地址或删除他们的 cookie 怎么办:)

# bash - 连接 sqlldr 中的多个字段

> ID：11451733
> 
> 赞同：2
> 
> 时间：2012-07-12T12:21:11.460
> 
> 标签：bash, shell, oracle11g, sql-loader

我正在使用 oracle 11g 中的 sqlldr(sql loader)。我正在尝试将 3 个字段连接成一个字段。有人做过吗？

例如：TABLE - “CELLINFO”，其中的字段是（mobile_no、service、longitude）。

给出的数据是 (+9198449844,idea,110,25,50) 即 (mobile_no,service,grad,min,sec)。

但是在将数据加载到表中时，我需要将最后 3 个字段（grad、min、sec）连接到表的经度字段中。

在这里我无法手动编辑，因为我要加载 1000 条数据。

我也尝试过使用 ||,+ 和 concat().... 但我做不到。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T13:24:15.917

ctl 可能是：

```
load data
append
into table      cellinfo
fields terminated by ","
(
mobile_no,
service,
grad BOUNDFILLER,
min BOUNDFILLER,
sec BOUNDFILLER,
latitude ":grad || :min|| :sec"
) 
```

假设 cellinfo(mobile_no, service, latitude)。

[orafaq 上](http://www.orafaq.com/wiki/SQL*Loader_FAQ#Can_one_selectively_load_only_the_records_that_one_needs.3F)有一些不错的信息

或者，您可以修改输入：

```
awk -F"," '{print $1","$2","$3":"$4":"$5}' inputfile > outputfile 
```

# objective-c - 如何使用 NSDateFormatter 将此字符串解析为 NSDate？

> ID：11451736
> 
> 赞同：0
> 
> 时间：2012-07-12T12:21:20.670
> 
> 标签：objective-c, ios, xcode, nsdateformatter

我有一个日期作为格式的字符串：

```
2010-12-31 20:21:00 +0200 
```

我想做的是使用 NSDateFormatter 将其解析为 NSDate 对象，但我很难正确匹配格式。

```
NSDateFormatter *dateFormatter = NSDateFormatter.alloc.init;
[dateFormatter setTimeZone: NSTimeZone.localTimeZone];
[dateFormatter setDateFormat: @"yyyy-MM-dd HH:mm:ss'Z'"];
[dateFormatter dateFromString: @"2010-12-31 20:21:00 +0200"] // returns nil ; 
```

谁能帮我找到正确的格式？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:24:09.377

此代码有效：

```
 NSDateFormatter *dateFormatter = NSDateFormatter.alloc.init;
  [dateFormatter setTimeZone:NSTimeZone.localTimeZone];
  [dateFormatter setDateFormat:@"yyyy-MM-dd HH:mm:ss Z"];
  NSDate *date = [dateFormatter dateFromString:@"2010-12-31 20:21:00 +0200"];
  NSLog(@"%@", [dateFormatter stringFromDate:date]); 
```

我只是想让你知道，好心的先生，当我看到这个时，我的眼睛在流血`NSDateFormatter.alloc.init`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:27:46.853

```
NSDateFormatter* format = [[NSDateFormatter alloc]init];
[format setDateFormat:@"MM/dd/YYYY"];

NSString * currentDate = [format stringFromDate:[NSDate date]];
NSDate *date = [format dateFromString:currentDate]; 
```

# asp.net - URL 将默认文档网页重写为 SEO URL

> ID：11451741
> 
> 赞同：1
> 
> 时间：2012-07-12T12:21:35.733
> 
> 标签：asp.net, url-rewriting, routing, webforms

我已经开始为我的站点使用 ASP.NET 路由。我一直在通过 Global.asax 文件中的 Application_Start() 注册路由。

IE

```
routes.MapPageRoute("ROUTE-ABOUT", "about", "~/About.aspx");
routes.MapPageRoute("ROUTE-CONTACT", "contact", "~/Contact.aspx");
//etc... 
```

这非常适用于“关于”和“联系”页面。

## 我想要的是：

我的主页是 Home.aspx，我想做的是重写任何访问过的人

```
http://localhost/mysite.com/Home.aspx 
```

到

```
http://localhost/mysite.com/Home 
```

## 我试过的

*   我的站点在我的机器上的本地 IIS v7.5 中运行（完全管理员权限）。
*   我已将以下内容添加到我的 Web.config

**网页配置**

```
<rewrite>
    <rules>
        <rule name="HOMETOSEO" stopProcessing="true">
            <match url="Home\.aspx" />
            <action type="Redirect" url="home" appendQueryString="false" />
        </rule>
    </rules>
</rewrite> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:10:36.963

经过数小时的尝试使其工作后，我最终设法使用文件`Web.config`和文件中`Application_Start()`的以下条目使其工作`Global.asax`：

**网页配置**

```
<rewrite>
    <rules>
        <rule name="default" enabled="true" patternSyntax="ECMAScript" stopProcessing="false">
            <match url="(.*)Home\.aspx" ignoreCase="true" />
            <action type="Redirect" url="home" appendQueryString="false" />
        </rule>
        <rule name="lower" enabled="true" patternSyntax="ECMAScript" stopProcessing="true">
            <match url="[A-Z]" ignoreCase="false" />
            <action type="Redirect" url="{ToLower:{URL}}" /> 
        </rule>
    </rules>
</rewrite> 
```

**全球.asax**

```
protected void Application_Start(object sender, EventArgs e)
{
    //...
    BuildStaticRoutes(RouteTable.Routes);
    //...
}

public void BuildStaticRoutes(RouteCollection routes)
{
    //...
    routes.MapPageRoute("ROUTE-HOME", "home", "~/Home.aspx");
    //...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:43:52.877

如果您使用的是 IIS v7.5，您可以在 web.config 中添加它

```
<system.webServer>  
<rewrite>
            <rules>                
                <rule name="HOMETOSEO" stopProcessing="true">
                    <match url="^Home" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="Home.aspx" />
                </rule>
            </rules>
</rewrite>
</system.webServer> 
```

当您键入`http://mysite.com/Home`时，它会显示`http://mysite.com/Home.aspx`。那是你所追求的还是相反？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T13:12:13.337

您可以通过从 RouteBase 继承使用自定义路由来执行此操作 - 所以在您的情况下，它看起来像这样

```
public class HomeRoute : RouteBase
{
    public override RouteData GetRouteData(HttpContextBase httpContext)
    {
        if (httpContext.Request.Url.ToString().ToLower().Contains("home.aspx"))
        {
            httpContext.Response.Status = "301 Moved Permanently"; //Optional 301 redirect
            httpContext.Response.RedirectLocation = "Home";
            httpContext.Response.End();
        }

        return null;
    }

    public override VirtualPathData GetVirtualPath(RequestContext requestContext, RouteValueDictionary values)
    {
        return null;
    }
} 
```

然后在您注册路线时，您将拥有

```
routes.Add("HomeUrl", new HomeRoute()); 
```

因此，对 /Home.aspx 的任何请求都会自动重定向到 /Home - 显然，通过一些额外的工作，您可以使任何 .aspx 请求更通用。

# list - Sencha Touch 2 列表在容器中不可见

> ID：11451744
> 
> 赞同：5
> 
> 时间：2012-07-12T12:21:36.740
> 
> 标签：list, touch, extjs, containers

我正在尝试用容器上的列表编写简单的视图，但我遇到了一些问题。首先，当我尝试这样做时，列表是不可见的：

```
 Ext.define('App.view.News', {
    extend: 'Ext.Container', 
```

但是当它这样写时：

```
Ext.define('App.view.News', {
    extend: 'Ext.navigation.View', 
```

有用。

问题是，当我使用扩展navigation.View 编写它时，我在顶部有两个工具栏，我找不到禁用第二个工具栏（由列表添加）的解决方案。

完整代码：

```
Ext.define('App.view.News', {
    extend: 'Ext.Container', //Ext.navigation.View
    xtype: 'news',
    requires: [
        'Ext.dataview.List',
        'Ext.data.proxy.JsonP',
        'Ext.data.Store'
    ],
    config: {
        style: ' background-color:white;',

        items: 
        [
            {
                xtype: 'toolbar',
                docked: 'top',
                title: 'News',
                minHeight: '60px',
                items: [
                    {
                        ui: 'back',
                        xtype: 'button',
                        id: 'backButton', 
                        text: 'Back',
                    },

                    {
                        minHeight: '60px',
                        right: '5px',
                        html: ['<img src="resources/images/Image.png"/ style="height: 100%; ">',].join(""),
                    },
                ],          
            },

            { 
                xtype: 'list',
                itemTpl: '{title},{author}',
                store: {
                    autoLoad: true,
                    fields : ['title', 'author'],
                    proxy: {
                        type: 'jsonp',
                        url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog',
                        reader: {
                            type: 'json',
                            rootProperty: 'responseData.feed.entries'
                        }
                    }
                }
            }   
        ]
    }
}); 
```

请帮忙！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-12T17:46:07.560

你需要给你的容器一个布局，给你的列表一个 flex 属性。flex 在列表中很重要，因为它们在滚动后没有可见的高度。我在下面的代码中添加了几个属性。希望这可以帮助。

```
Ext.define('App.view.News', {
    extend: 'Ext.Container', //Ext.navigation.View
    xtype: 'news',
    requires: [
        'Ext.dataview.List',
        'Ext.data.proxy.JsonP',
        'Ext.data.Store'
    ],
    config: {
        style: ' background-color:white;',
        layout: 'vbox', //  add a layout
        items: 
        [
            {
                xtype: 'toolbar',
                docked: 'top',
                title: 'News',
                minHeight: '60px',
                items: [
                    {
                        ui: 'back',
                        xtype: 'button',
                        id: 'backButton', 
                        text: 'Back',
                    },

                    {
                        minHeight: '60px',
                        right: '5px',
                        html: ['<img src="resources/images/Image.png"/ style="height: 100%; ">',].join(""),
                    },
                ],          
            },

            { 
                xtype: 'list',
                itemTpl: '{title},{author}',
                flex: 1,    //  add a flex property
                store: {
                    autoLoad: true,
                    fields : ['title', 'author'],
                    proxy: {
                        type: 'jsonp',
                        url: 'https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&q=http://feeds.feedburner.com/SenchaBlog',
                        reader: {
                            type: 'json',
                            rootProperty: 'responseData.feed.entries'
                        }
                    }
                }
            }   
        ]
    }
}); 
```

# spring - 在java中实现交叉验证

> ID：11451746
> 
> 赞同：0
> 
> 时间：2012-07-12T12:21:41.303
> 
> 标签：spring, jpa, spring-roo, bean-validation, cross-validation

我使用 Spring Roo + jpa + hibernate，**我想**在我的应用程序中实现交叉验证（同时验证多个字段）。

我不确定如何实施它。谁能给我建议和/或指导我查阅相关文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:29:38.803

看看 Hibernate Validator，它允许实体验证（使用注释）。

[http://www.hibernate.org/subprojects/validator.html](http://www.hibernate.org/subprojects/validator.html)

简而言之，您可以通过在它们上方放置休眠验证器/JPA 注释来注释您的字段约束。（例如@Min(10)）并使用以下代码查找任何无效字段；

```
ValidatorFactory factory = Validation.byDefaultProvider().configure().traversableResolver(new CustomTraversableResolver() ).buildValidatorFactory();
Validator validator = factory.getValidator();
Set<ConstraintViolation<BaseValidationObject>> constraintViolations = Validator.validate(myEntityToValidate); 
```

如果您需要验证实体之间的特定关系，您可以编写自定义验证器来满足该需求。

# java - 从java执行多个命令shell

> ID：11451752
> 
> 赞同：3
> 
> 时间：2012-07-12T12:21:55.483
> 
> 标签：java

我正在寻找一种从 java 执行几个命令 shell 的方法。我在 stackoverflow 中发现了这一点，但它仅有助于每个会话执行一个命令 shell：

```
try {  
        // Execute command  
        String command = "ls -la";  
        StringBuffer ret=new StringBuffer();  
        Process p = Runtime.getRuntime().exec(command);  

        // Get the input stream and read from it  
        InputStream in = child.getInputStream();  
        int c;  
        while ((c = in.read()) != -1) {  
        ret.append((char)c);  
        }  
        in.close();  
        System.out.println(ret.toString());  
    } catch (IOException e) {  
    e.printStackTrace();  
    } 
```

无论如何使用上面的代码在同一个会话中执行许多命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:23:27.810

您可以轻松地在`for-loop`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:27:05.810

也许您可以将命令分组到一个 shell 脚本中，然后执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:28:08.180

您可以使用一堆命令编写可执行的 shell 脚本或 bat 文件，并将其作为一个命令执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:30:06.777

首先，这不是您使用的方式[`Runtime.exec()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#exec%28java.lang.String%5B%5D%29)：第一个参数是*可执行文件*，其他参数是该可执行文件的参数。

现在，您的代码正在尝试执行一个名为 literal 的文件`"ls -la"`，该文件当然不存在。

将您的代码更改为：

```
String[] command = {"ls", "-la"}; // Use an array
Runtime.getRuntime().exec(command); 
```

# database - 单个首选项数据库表中的列太多？

> ID：11451757
> 
> 赞同：0
> 
> 时间：2012-07-12T12:22:16.373
> 
> 标签：database, normalization

我有一个应用程序，它基本上是由许多较小的应用程序构建的。每个应用程序都有自己的个人偏好，但它们都共享相同的 5 个偏好，例如，应用程序是否显示在导航中，是否公开，是否应生成报告等。

Web 应用程序中的任何页面都需要知道所有这些常见的偏好，因为导航是由它构建的。所以最初我将所有这些偏好放在一个表中。然而，随着应用程序数量的增长（现在 10 个，最终大约 30 个），列数最终将达到 150-200 个左右。这些列中的大多数只是布尔值，但它仍然让我担心一张表中有这么多列。另一方面，如果我要将它们分成单独的表（每个应用程序的首选项），每次我需要查看首选项时我都必须将它们全部连接在一起，那么为什么不把它们全部放在一起呢？

在应用程序中，我可以将首选项分解为更小的对象，以便它们更易于使用，但从数据库的角度来看，它们是一个单一的实体。是把它们放在一张大桌子上更好，还是把它们分成更小的桌子，但每次请求时都强制进行许多连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:30:25.243

您使用的是哪个数据库引擎？通常，您会在数据库引擎中找到有关每个表的推荐列数的一些建议。主要是行大小限制，这应该可以保证您的安全。

其他选项和建议包括：

1.  以整数形式为每个配置键分配一个位，并使用逻辑“与”运算仅显示在给定时间点您感兴趣的键。从 DB 读取单个值，每次读取配置键时进行一次快速逻辑操作。

2.  在内存中缓存首选项，减少到数据库服务器的往返次数，根据更改频率，您可能还必须在更新每个首选项时清除它的缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:30:38.930

为什么不将列转换为行并使用以下内容：

![ERD](../Images/ad349035b5114212f1f616f26bc6a152.png)

这是维护设置值列表的典型方法。

该`APP_SETTING`表包含设置的值。该`SETTING`表为您提供了设置的上下文。

有一些方法可以扩展它以添加信息，例如哪些设置适用于哪些应用程序，以及特定设置的可能值是否限制在特定列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:38:49.147

那么 CommonPreferences 和 ApplicationPreferences 肯定会有意义，甚至可能在代码中将它们隔离（两个查询而不是一个连接）。

之后，每个应用程序的表将更有意义。

另一种方法是沿着 Joel Brown 建议的路线前进。

第三种方法不是每个设置都有单独的列或行，而是将所有不常见的列填充到 xml 片段中或从首选项类中序列化。

您做出的决定取决于您的应用程序如何（或可以使用数据）。如果您按照设置表的方式获取应用程序设置作为一行将是非常痛苦的。沿着 xml 片段路由和跨应用程序查询设置将比几个连接更痛苦。

没有办法说你应该从这里妥协。我想我会先去 CommonPreferences，然后看看我在哪里。

# html - 在顶部的图像旁边设置文本

> ID：11451758
> 
> 赞同：1
> 
> 时间：2012-07-12T12:22:16.917
> 
> 标签：html, css, text-alignment

我有以下 HTML（由 JSF 生成）

```
 <div align="center">
        <img src="images/background_image.jpg" height="200px" width="30%" style="vertical-align: top"/>
        <span style="">
            Welcome abc, <input type="submit" value="logout" />.
            <br />
            Thu, 12-Jul-2012 15:46:07 AST
        </span>
    </div> 
```

我期待“Thu，2012 年 7 月 12 日 15:46:07 AST”应该在图像旁边，但是我在图像下方得到它。

我在图像右侧收到 Welcome abc 和 logout 按钮。

有人可以指出我做错了什么吗？

* * *

## 编辑 1

1.  我过去`<div align="center">`只是把一切都放在中心。
2.  如果我删除`<br />`标签，我会得到输出为`Welcome abc, logout.Thu, 12-Jul-2012 15:46:07 AST`. 如果我添加`<br />`标签，我期望输出为

    `Welcome abc, logout.`

    `Thu, 12-Jul-2012 15:46:07 AST`

    但是，由于`<br />`标签的原因，我得到了图像下方的输出。

希望这个解释有所帮助。

我要疯了:(

* * *

## 编辑 2

## [jsfiddle](http://jsfiddle.net/a2YJc/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:23:22.623

首先，第一个 div 需要足够宽以容纳您的图像和跨度及其文本，并将其设置为 overflow:auto 以允许在其中浮动元素。

然后，您应该将图像和跨度浮动到左侧。

跨度应设置为“display:inline-block”。

你可能想要给图像一些“margin-right”。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:36:13.633

您需要“浮动”您的图像和跨度：

```
img, span {
    float: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T20:18:34.637

我得到了解决方案。代码应该是

```
<div align="center">
    <img src="http://blog.kevinchisholm.com/wp-content/uploads/2011/11/jquery2.png" style="vertical-align: top"/>
    <span style="display:inline-block" align="right">
        Welcome abc, logout.
        <br />
    Thu, 12-Jul-2012 15:46:07 AST
    </span>
</div> 
```

## [jsfiddle](http://jsfiddle.net/a2YJc/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T12:44:19.867

也许您跨度中的文本太长了。在这种情况下，您可以将跨度宽度定义为 70%，如果它当然没有边框。

# android - 从静态类调用 AsyncTask

> ID：11451768
> 
> 赞同：1
> 
> 时间：2012-07-12T12:23:11.187
> 
> 标签：android, android-asynctask, static-class

我有一个需要调用另一个的静态类，第一个是静态的，并阻止我调用第二个并出现以下错误：

```
No enclosing instance of type Studies is accessible. Must qualify the allocation with an enclosing instance of type Studies (e.g. x.new A() where x is 
 an instance of Studies). 
```

异步任务类

```
 class DownloadFileAsync extends AsyncTask<String, String, String> {

        @Override
        protected void onPreExecute() {}

        @Override
        protected String doInBackground(String... aurl) {}
    } 
```

静态类

```
 public static void startDownload(int id) {
         ERROR LINE--> new DownloadFileAsync().execute("SOME URL");
   } 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:49:27.297

你可以试试`new Studies().new DownloadFileAsync().execute("SOME URL");`

但这不完全是 OOP 风格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:35:39.957

你有没有看到这个答案。[回答链接](https://stackoverflow.com/a/633602/519718)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-17T20:42:04.133

这是一个老问题，但如果有人仍然感兴趣，而不是在你的静态类中定义你的 AsyncTask，你可以在它自己的文件中定义它，这样就可以了。

# facebook - 是否可以将个人页面 facebook 喜欢转移到网站 facebook 喜欢

> ID：11451781
> 
> 赞同：1
> 
> 时间：2012-07-12T12:24:07.190
> 
> 标签：facebook

我想知道是否可以转移单个页面喜欢，例如。我们有一个网站`www.example.com/mobiles/nokia/mobilname.php`，这个页面有 256 个赞，我们的网站`www.example.com`有 5000 个赞。我想把256个以上的点赞转移到网站点赞，这样我就可以得到5256个点赞。是否可以在 Facebook 中执行此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:29:30.663

不——你不能那样做。不可能将“喜欢”从页面移动到网站、从网站移动到页面、从页面移动到页面或您能想到的任何其他组合。

如果有人“喜欢”一个页面 - 你怎么知道他“喜欢”你的 URL？简单的答案 - 你没有。

# android - Android：如何执行 AsyncTask？

> ID：11451782
> 
> 赞同：7
> 
> 时间：2012-07-12T12:24:09.320
> 
> 标签：android, xml, android-asynctask

我必须在我的应用程序中加载 XML 数据，我在扩展 AsyncTask 的活动类的子类中这样做，如下所示：

```
public class MyActivity extends Activity {

    ArrayList<Offre> listOffres;

    private class DownloadXML extends AsyncTask<Void, Void,Void>
    {
        protected Void doInBackground(Void... params)
        {
            listOffres = ContainerData.getFeeds();
            return null;
        }
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.activity_liste_offres);

        DownloadXML.execute(); // Problem here !

        for(Offre offre : listOffres) { // etc }
    }
} 
```

我不知道如何在这里使用 execute()，我有以下错误：

> 无法从 AsyncTask 类型对非静态方法 execute(Integer...) 进行静态引用

我猜一些参数但是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-12T12:25:45.560

您需要创建`DonwloadXML`文件的一个实例并调用`execute()`该方法：

```
DownloadXML task=new DownloadXML();
task.execute(); 
```

**编辑：**您可能还应该`listOffers`从您的方法中返回`doInBackground()`并处理数组。你可以看看这个简单的[AsyncTask 教程](http://developer.android.com/reference/android/os/AsyncTask.html)。`onPostExecute()``AsynTask`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-12T12:26:05.487

你应该这样称呼它：

```
new DownloadXML().execute(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T05:34:29.413

实际上，您正在调用 AsyncTask 的方法（它进一步扩展了 AsyncTask 类），而没有创建该类的 OBJECT。您可以通过两种方式调用执行方法。

1.  制作类的对象/实例

    ```
    DownloadXML task=new DownloadXML();
    task.execute(); 
    ```

2.  通过使用飞行物体。

    ```
    new DownloadXML().execute(); 
    ```

我更喜欢在这里使用第二种方法来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-07T06:25:47.373

好吧，如果你想通过**java**中的异步任务执行一些代码，你也可以这样做：

```
AsyncTask.execute(new Runnable() {
            @Override
            public void run() {

                // add code which you want to run in background thread

                runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        // add code which you want to run in main(UI) thread
                    }
                });
            }
        }); 
```

在**kotlin**中，如果您使用的是**anko**，还有更简单的方法可以实现这一点：

```
 doAsync {
            // add code which you want to run in background thread
            uiThread {
                // add code which you want to run in main(UI) thread
            }
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:50:59.997

你也可以执行你的异步任务

```
new DownloadXML().execute(); 
```

或者

```
 DownloadXML task=new DownloadXML();
 task.execute(); 
```

还有一件事你在 asynctask 的数组中得到了比为你的循环迭代使用 postexeceute 方法更好

如下所示

```
 protected void onPostExecute(String s) {

    for(Offre offre : listOffres) { // do ur work here after feeling array }    

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-27T13:02:39.607

您必须首先创建 DownloadXML 类的对象。

```
DownloadXML downloadxml= new DownloadXML();
downloadxml.execute(); 
```

并返回 listOffres。

```
listOffres = ContainerData.getFeeds();
return listOffers; 
```

# android - android 播放来自 res/raw 的视频

> ID：11451789
> 
> 赞同：3
> 
> 时间：2012-07-12T12:24:16.417
> 
> 标签：android, video, android-videoview, playback

我想在 android 中播放 res/raw 的视频，这是我的代码：

```
public class CreditsActivity extends Activity{

    @Override
     protected void onCreate(Bundle savedInstanceState){
            super.onCreate(savedInstanceState);
            setContentView(R.layout.creditslayout);
            VideoView v = (VideoView) findViewById(R.id.video);
            v.setVideoURI(Uri.parse("android.resource://test.test.test/raw/maincredits"));
            v.start();
    }
} 
```

但我只听到视频的声音。并且模拟器不会显示视频本身，文件大小为 2.8 MB。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:29:25.930

试试下面的代码：

```
public class CreditsActivity extends Activity{

        @Override
         protected void onCreate(Bundle savedInstanceState){
                super.onCreate(savedInstanceState);
                setContentView(R.layout.creditslayout);
                VideoView v = (VideoView) findViewById(R.id.video);
                v.setVideoURI(Uri.parse("android.resource://" + getPackageName() + "/" + R.raw.video_file));
                v.start();

    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:28:24.860

请试试这个。

```
Uri uri = Uri.parse("android.resource://test.test.test/"+R.raw.[video_resid]);    
v.setVideoURI(uri); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:28:46.313

尝试`Uri.parse("android.resource://test.test.test/" + R.raw.yourVideoName)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T13:17:57.847

尝试这个

```
 // trailer_final is the video name

      String fileName = "android.resource://"+ getPackageName()+"/raw/trailer_final";

      VideoView mvideo = (VideoView) findViewById(R.id.playVideo);

      mvideo.setVideoPath(fileName);

      MediaController controller = new MediaController(this);

      mvideo.setMediaController(controller);

      mvideo.requestFocus();

      mvideo.start(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T12:28:13.997

尝试这个：

```
VideoView view = (VideoView)findViewById(R.id.videoView);
String path = "android.resource://" + getPackageName() + "/" + R.raw.video_file;
view.setVideoURI(Uri.parse(path));
view.start(); 
```

只需传递项目 res 下 raw 文件夹中的视频名称即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-07T10:37:41.327

模拟器不显示视频。我在一个项目中遇到了这个问题。我们在一个实际的设备上试了一下，它玩得很完美。尝试在实际设备上播放。它可能会起作用。

# iis-6 - ASPNET 进程外会话被神秘地重置

> ID：11451795
> 
> 赞同：0
> 
> 时间：2012-07-12T12:24:42.933
> 
> 标签：iis-6, session-state, sessionid, out-of-process

我正面临一个非常特殊的问题，即在没有任何明显原因的情况下重置会话。这是随机发生的，每几十或几百个请求一次。

我的 Web 应用程序在 Windows 2003、IIS 6.0、.NET 1.1 上运行。该应用程序有一个网页，该网页在其 Page_Load 事件期间填充了一堆 Session 变量。数据存储在 ASPNET 状态服务的进程外。

在 Page_load 事件退出并显示页面后，用户单击一个按钮，该按钮检索会话数据并对其进行一些处理。而这个 Button_click 就是问题发生的地方。在某些情况下，会话变量为 null，从而引发 nullRefException。

我们的跟踪显示 Button_click 事件期间的 sessionID 是一个全新的会话，其 ID 与 Page_Load 事件的会话不同。因此，应用程序无法检索在 Page_Load 期间存储的数据。我们的事件日志显示，有问题的请求的会话变量确实在 Page_load 事件期间填充，并且响应发送没有问题，这通常会保留数据。

我们已经排除了会话超时；尽管超时仍会导致相同的 nullRefException，但 Page_load 中的相同会话 ID 将用于检索不存在的数据。在这种情况下，sessionID 与原始的不同。

我们不会以任何方式弄乱 ASPNET cookie，我们不会使用 session.abandon，也不会无意中从会话中删除项目。

我的问题是：哪些服务器端因素可能导致持卡人的会话被这样重置？应用程序事件日志不包含任何有用的信息。

此外，是否有任何客户端（例如 cookie 篡改）可以强制 IIS 在页面的后续回发时分配新会话？

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T05:34:26.247

我不确定这是否适用于您的情况，但它可能对其他人有所帮助。

我正在设计一个网站，但我发现了一条艰难的道路，这意味着我必须重新设计我正在处理的网站的一部分。当您在活动 IIS 文件夹中创建或删除文件夹（从 asp.net 页面）时，它会重置网站的所有会话。这意味着当前网站上的每个用户都会立即删除他们的会话。

如果您可以控制服务器，请将文件存储在 IIS 文件夹之外并根据需要将它们流式传输。如果您无法控制服务器，则必须删除所有使用文件夹的工作。

# c++ - 重新创建/修复 WinAPI ODBC 连接

> ID：11451798
> 
> 赞同：0
> 
> 时间：2012-07-12T12:25:01.137
> 
> 标签：c++, winapi, visual-c++, odbc

我们创建并缓存使用[SQLDriverConnect](http://msdn.microsoft.com/en-us/library/windows/desktop/ms715433%28v=vs.85%29.aspx "SQLDriverConnect")创建的 ODBC 连接；我们发现了连接丢失的情况......准备好的语句停止工作，等等。

我没有看到一个明显的功能来测试连接/语句是否有效，或者重置/重新创建连接，这似乎是一种相当常见的模式。谁能建议如何最好地实施？

[这个答案](https://stackoverflow.com/questions/7424298/efficient-way-to-test-odbc-connection?rq=1)是相同的，这也是正确的解决方案吗？如果是这样，是否有任何巧妙的方法可以“重新启动”现有语句以使用新连接？如果发现连接已死，是否还需要释放它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:54:44.617

在我看来，对于 SQL_ATTR_CONNECTION_DEAD 是否可以在您拨打要求它处于活动状态的呼叫之前测试连接是否仍然活动，一直存在一些混淆。这是基于许多 ODBC 驱动程序的使用，包括我编写的驱动程序，我怀疑它们可能都以不同的方式实现它。

在帖子中，您参考了尼克的答案（SQL_ATTR_CONNECTION_DEAD）不适用于我可以访问的许多驱动程序：

```
#include <stdio.h>
#include <sql.h>
#include <sqlext.h>
#include <stdlib.h>

static void extract_error(
    char *fn,
    SQLHANDLE handle,
    SQLSMALLINT type);

main() {
    SQLHENV henv;
    SQLHDBC hdbc;
    SQLHSTMT hstmt;
    SQLCHAR outstr[1024];
    SQLSMALLINT         outstr_len;
    SQLRETURN ret;
    SQLINTEGER dead;

    SQLAllocHandle(SQL_HANDLE_ENV, SQL_NULL_HANDLE, &henv);
    SQLSetEnvAttr(henv, SQL_ATTR_ODBC_VERSION, (void *) SQL_OV_ODBC3, 0);
    SQLAllocHandle(SQL_HANDLE_DBC, henv, &hdbc);
    ret = SQLDriverConnect(hdbc, (void *)0, "DSN=xx;UID=xx;PWD=xx", SQL_NTS,
                           outstr, sizeof(outstr), &outstr_len,
                           SQL_DRIVER_COMPLETE);
    if (!SQL_SUCCEEDED(ret)) {
        extract_error("SQLDriverConnect", hdbc, SQL_HANDLE_DBC);
        exit(1);
    }

    SQLAllocHandle(SQL_HANDLE_STMT, hdbc, &hstmt);
    ret = SQLPrepare(hstmt, "select 123", SQL_NTS);
    if (!SQL_SUCCEEDED(ret)) {
        extract_error("SQLPrepare", hstmt, SQL_HANDLE_STMT);
        exit(1);
    }

    ret = SQLExecute(hstmt);
    if (!SQL_SUCCEEDED(ret)) {
        extract_error("SQLExecute", hstmt, SQL_HANDLE_STMT);
        exit(1);
    }

    sleep(120);

    SQLGetConnectAttr(hdbc, SQL_ATTR_CONNECTION_DEAD, &dead, 0, NULL);
    printf ("dead=%ld\n", dead);

    ret = SQLExecute(hstmt);
    if (!SQL_SUCCEEDED(ret)) {
        extract_error("SQLExecute", hstmt, SQL_HANDLE_STMT);
    }
    SQLGetConnectAttr(hdbc, SQL_ATTR_CONNECTION_DEAD, &dead, 0, NULL);
    printf ("dead=%ld\n", dead);

}

static void extract_error(
    char *fn,
    SQLHANDLE handle,
    SQLSMALLINT type)
{
    SQLINTEGER i = 0, native;
    SQLCHAR state[ 7 ];
    SQLCHAR text[256];
    SQLSMALLINT len;
    int ret;

    fprintf(stderr,
            "\n"
            "The driver reported the following diagnostics whilst running "
            "%s\n\n",
            fn);

    do
    {
        ret = SQLGetDiagRec(type, handle, ++i, state, &native, text,
                            sizeof(text), &len );
        if (SQL_SUCCEEDED(ret))
            printf( "%s:%ld:%ld:%s\n", state, i, native, text );
    }
    while( ret == SQL_SUCCESS );
} 
```

输出有多个驱动程序：

```
dead=0
# At this point I took the server down
The driver reported the following diagnostics whilst running SQLExecute
08S01:1:0:[SQL Server Driver 10.0][SQL Server]Communication link failure: short write
dead=0 
```

您提到的帖子中指定的另一个选项是 SQL_COPT_SS_CONNECTION_DEAD ，但它特定于 MS SQL Server。

由于我认为您不打算让任何语句句柄失败，通常您不能只运行 stmt 并且如果它失败则假设连接已死并重新连接并重新准备？

如果连接确实死了，您仍然需要为各种句柄调用 SQLFreeHandle。

# rule-engine - 使用 IBM 规则引擎

> ID：11451805
> 
> 赞同：1
> 
> 时间：2012-07-12T12:25:16.447
> 
> 标签：rule-engine, ilog

我被要求编写与 IBM 规则引擎 (ILog) 一起使用的概念证明 (POC)。

我在 IBM 站点上看到了很多文档，但仍然没有设法使用它来推进 POC。

有没有人使用过 IBM 规则引擎并且可以给我关于这个规则引擎是如何工作的高级解释？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T12:36:10.277

首先，您应该拥有 ILOG Rule Studio。要将 POC 放在一起，您需要执行以下步骤。

第 1 步：**创建 XOM（执行对象模型）** - 创建一些 POJO 类、XSD 或 XML，您希望在规则调用期间使用它们。如果您的应用程序中有现有的 jar，您也可以使用它。这是您的业务领域的物理模型。

第 2 步：**创建 BOM（业务对象模型）** - 它必须使用规则工作室从 XOM 创建。这是您的业务领域的逻辑模型。

第 3 步：**创建语言化**- 创建 BOM 时，它会要求您语言化您的变量、设置器和获取器。这就像英语一样代表您的商业模式。

第 4 步：**创建规则项目并定义规则集参数**- 创建规则项目并定义输入和输出参数。

第 5 步：**编写规则**- 使用规则集参数和 BOM 编写业务规则。白色规则流程包括按顺序编写的规则。

第 6 步：**创建 RuleApp 项目并生成 RuleApp 存档**- 创建 ruleApp 项目并生成 ruleapp 存档。ruleapp 存档通常是编译成 IRL（ILOG 规则语言）的业务规则。

执行规则的最简单方法是将规则工作室生成的规则存档包含在应用程序中（这称为嵌入式执行模式）并使用 ILOG api 并通过传递输入参数来调用规则。

当调用规则时，输入参数被序列化并传递给规则引擎，规则引擎从存档解析调用的规则，根据输入参数评估规则，准备序列化输出并将输出返回给调用者。

# android - 图像索引的类型

> ID：11451807
> 
> 赞同：0
> 
> 时间：2012-07-12T12:25:26.433
> 
> 标签：android, testing, junit, automation, robotium

我正在使用 Robotium 来测试 Android apk 文件。我有图像问题。当我想点击图像时，我通常使用像这样的图像索引 solo.clickOnImage(1);
但是当这个测试运行多次时，有时会以相同的索引打开不同的图像！是否可以在 Android apk 测试中使用 R.id.add_note 之类的索引或其他索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T20:19:46.257

是的，您可以这样做，但您必须有权访问源代码。如果您有权访问源代码，则需要在测试程序构建路径中包含被测应用程序 (AUT)。从那里您可以使用资源 id 来选择特定视图（即文本视图、图像视图、列表视图等）。

如果您只有 apk，而您无权访问源代码，那么您将仅限于黑盒测试。

希望这可以帮助。

# mysql - 如何添加多个可能有值或没有值的查询 WHERE 语句

> ID：11451809
> 
> 赞同：-3
> 
> 时间：2012-07-12T12:25:27.260
> 
> 标签：mysql, forms, search

我正在创建一个表单，允许用户在数据库中搜索不同的标准：位置、城市、最低价格、最高价格等。

我有一个“基础”选择语句：`SELECT * FROM table`.

在搜索表单中，有几个文本框和下拉列表可能有也可能没有值，这取决于用户想要搜索的内容。

当可能有也可能没有用于特定表列的值（基于用户的选择）时，我无法弄清楚如何将 WHERE 子句添加到 sql 语句中。

感谢任何人的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:32:06.087

在生成 SQL 的代码中，检查用户输入了哪些字段，并在您找到来自用户的更多输入时将更多检查附加到查询中。PHP中的快速示例：

```
$sql = "SELECT * FROM table";
$where_checks = array();

if (isset($_POST['city']))
   $where_checks[] = "city = '{$_POST['city']}'";
if (isset($_POST['location']))
   $where_checks[] = "location = '{$_POST['location']}'";

// Add more stuff here

if (count($where_checks) > 0)
   $sql .= " WHERE " . implode('AND', $where_checks);

// run query 
```

我故意省略了帖子输入的卫生/转义，以保持示例简单。但是你显然也**必须清理输入**。

请注意之前的额外空间，`WHERE`否则查询将被破坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:35:45.027

使用这种方法

```
select 
    columns
from 
    table
where 
    (location=@location or @location is null) and
    (city=@city or @city is null) and
    .
    . 
```

# java - 在 OSGi/Equinox 上监控

> ID：11451810
> 
> 赞同：3
> 
> 时间：2012-07-12T12:25:31.480
> 
> 标签：java, osgi, monitoring, jmx

我们使用 Equinox 作为我们应用程序的运行时。OSGi 的模块化非常棒，但在 JBoss 时代我怀念一件事：监控设施。JMX 是 JVM 中的监控标准，但 Equinox 似乎没有为其提供太多内置支持。

除了 Equinox [Resource Monitoring](http://www.eclipse.org/equinox/incubator/monitoring/)项目，该项目自 2007 年以来似乎已经过时（并且没有退出孵化期），还有哪些选择？

有哪些其他 OSGi/Equinox 采用者用于监控基于 OSGi 的应用程序？其他 OSGi 实现呢？这对于触发迁移非常重要，以防例如 Felix+Karaf 提供更好的监控支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T17:43:03.287

有几个选项可用。[Gemini Management](http://www.eclipse.org/gemini/management/)为框架的 JMX 监控提供了 OSGi 标准的实现。

如果您想监控 Servlet 环境，您需要查看 Servlet 引擎提供的选项。我们在[Gyrex](http://www.eclipse.org/gyrex/)中包含了 Jetty ，它提供了几个选项。我们还添加了更多的 JMX bean 来测量平均请求时间、关于最后一个错误的信息等等。

实现自己的 JMX bean 实际上并不困难。您可以`ManagementFactory.getPlatformMBeanServer().registerMBean(...)`从代码中的任何位置调用以注册 bean。看看[我们的服务跟踪器实现](http://git.eclipse.org/c/gyrex/gyrex-platform.git/tree/bundles/org.eclipse.gyrex.monitoring/src/org/eclipse/gyrex/monitoring/internal/MetricSetTracker.java)，它为每个注册的特定类型的服务对象注册一个 JMX 监控 bean。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T18:59:23.550

我推荐使用 Apache Karaf。您可以将它与 Felix 或 Equinox 一起使用。它提供了很多监控功能。只需启动 karaf 并连接 Jconsole。除了 JMX，它还有 Felix Webconsole 和一个很棒的命令行，也可以通过 ssh 使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-09T18:18:56.870

我在谷歌搜索Equinox + JMX时发现了这个线程。由于这个线程来自 2012 年，其他人可能会在未来出现这个问题，因此是时候添加另一个适合我的解决方案了。

您可以轻松使用[Aries JMX](http://aries.apache.org/modules/jmx.html)。您可以在下面找到 Aries 文档的总结。为此添加

*   一个简单的捆绑包

    ```
    import java.lang.management.ManagementFactory;
    import javax.management.MBeanServer;
    import org.osgi.framework.BundleActivator;
    import org.osgi.framework.BundleContext;

    public class Activator implements BundleActivator {
        public void start(BundleContext context) throws Exception {
            MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
            context.registerService(MBeanServer.class.getName(), mbs, null);
        }

        public void stop(BundleContext context) throws Exception {}
        }
    } 
    ```

*   [白羊座 JMX 捆绑包](http://search.maven.org/#artifactdetails%7Corg.apache.aries.jmx%7Corg.apache.aries.jmx%7C1.1.5%7Cbundle)

*   [Aries JMX API 包](http://search.maven.org/#artifactdetails%7Corg.apache.aries.jmx%7Corg.apache.aries.jmx.api%7C1.1.5%7Cbundle)
*   [白羊座实用程序包](http://search.maven.org/#artifactdetails%7Corg.apache.aries%7Corg.apache.aries.util%7C1.1.1%7Cbundle)

因此，可以通过例如 JConsole 访问 Equinox Container。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:38:24.493

Apache Felix Web Console 是一个非常强大的工具，用于监控 OSGi 容器的状态。它也可以在 Equinox 中运行。

见[http://felix.apache.org/site/apache-felix-web-console.html](http://felix.apache.org/site/apache-felix-web-console.html)

# windows - 在windows的eclipse中部署vosao

> ID：11451813
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:25:49.053
> 
> 标签：windows, eclipse, google-app-engine, content-management-system, vosao

我在 Windows 操作系统的 Eclipse 中使用谷歌应用引擎。我想使用 Vosao CMS（为 GAE 开发）。但是我不能在windows的eclipse中部署，也不能在windows的eclipse中轻松部署。那么vosao（内容管理系统）如何在windows操作系统的eclipse中部署。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T06:53:44.160

在 windows 的 eclipse 中部署 Vosao 没有直接的方法。但是有一个替代解决方案。

For- 面向 Java 开发人员的 Eclipse IDE

1.解压war文件。

2.比在eclipse中创建一个项目。

3.然后将解压缩文件夹的内容一一复制并粘贴到项目中的适当位置。就像servlet粘贴到src和jsp页面粘贴到war文件夹中一样。

4.care 充分阅读这一点 在解压缩文件夹中有一个 web-inf 文件夹，并且在您的项目中也有 web-inf 文件夹。因此，将 web-inf 文件夹的内容小心复制到项目 web-inf 文件夹中。

面向 Java EE 开发人员的 For-Eclipse IDE

文件-->导入-->web-->war

这可能是工作。在我的项目中，两者都是工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T06:52:27.307

有一个非常好的教程。 [http://www.rarejava.com/blog/2011/07/deploying-vosao-from-eclipse](http://www.rarejava.com/blog/2011/07/deploying-vosao-from-eclipse)

我对 Maven 和 Subclip 1.8 做了一些小的修改。除此之外，博客就像一个魅力

# java - 通过java代码访问浏览器的标签

> ID：11451814
> 
> 赞同：-4
> 
> 时间：2012-07-12T12:25:49.100
> 
> 标签：java, browser, tabs

我想通过 java 代码选择浏览器的某些选项卡。例如，我想访问浏览器的第三个或最后一个选项卡并在那里操作一些网页。有办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:29:10.860

可能值得看看像 adobe 括号这样的东西是如何做到这一点的。它使用 chrome 中的开发人员模式（我认为），这允许它与 chrome 中的选项卡进行交互。但是我不知道这是否在非开发人员模式下可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:31:51.373

我不认为这是可能的。如果您有自己的浏览器在 java 中运行，您可能可以这样做。

# facebook - FQL 流查询中的 Facebook 帖子展示次数为空

> ID：11451815
> 
> 赞同：6
> 
> 时间：2012-07-12T12:25:56.003
> 
> 标签：facebook, facebook-graph-api, facebook-fql, facebook-insights

根据[FQL Stream 文档](http://developers.facebook.com/docs/reference/fql/stream/)，以下查询应该在经过身份验证的页面所有者运行时返回展示次数，但它永远不会返回。我们让页面所有者直接在具有扩展权限（read_stream、read_insights）的[图形 api 浏览器中进行身份验证，但展示次数始终为空。](http://developers.facebook.com/tools/explorer)

有没有*人*能让这个工作？

```
SELECT post_id, actor_id, message, impressions FROM stream WHERE actor_id = {owned_page} and source_id = {owned_page} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-09T03:37:16.203

我认为它在文档中丢失了，但是您应该使用**页面访问令牌**而不是用户访问令牌进行此调用以使其正常工作。

所以这里是步骤：

1.  从用户那里获得以下权限并获得`user access_token`：

    *   `manage_pages`- 获取页面访问令牌
    *   `read_insights`- 阅读印象（如文档中所述）
    *   `read_stream`- 对于当前会话用户能够查看的所有帖子

2.  使用该令牌，通过调用获取`page access_token`-

    `/{page-id}?fields=access_token`

3.  （*可选）*[在此处](https://stackoverflow.com/a/18322405/1343690)查看我的答案以扩展此**永不**过期的页面访问令牌。（基本上避免了一些步骤）

4.  使用页面访问令牌，运行您的查询 -

    `SELECT post_id, actor_id, message, impressions FROM stream WHERE actor_id = {owned_page} and source_id = {owned_page}`

    这将为您获取结果中的展示次数（如果有）。

    ![在此处输入图像描述](../Images/5f81e827d939356af3a9f11a81e88a25.png)

希望有帮助。！

# c# - 如何构建我的网站的移动（平板电脑）友好版本？

> ID：11451821
> 
> 赞同：3
> 
> 时间：2012-07-12T12:26:14.130
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, asp.net-mvc-3

我创建了网站，它的大部分部分都使用了流畅的布局 CSS。我现在想让这个网站看起来像平板电脑一样友好。

该网站应该可以在 Ipad 上正常查看。这是我唯一的要求。

我怎样才能做到这一点？哪些开发工具可以加快我的速度？

**编辑：**很多人都建议使用 Jquery Mobile。我可以将它与我现有的 Asp.Net 网站一起使用吗？我是否需要更改我现有的整个 CSS，并且我是否仅限于使用那些 Jquery UI 按钮？

第二个也是最重要的问题是这是否适用于 Asp.Net Vanilla。假设我的页面上有网格视图。将 Jquery 移动工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:30:04.157

对于设备友好的网站，您应该使用[Asp.net MVC4](http://www.asp.net/mvc/mvc4)和[jQuery Mobile](http://jquerymobile.com/)。它具有出色的[移动功能](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)

> 首先，您应该阅读[使用 HTML5 创建移动体验](http://msdn.microsoft.com/en-us/magazine/hh975346.aspx)和[50 个响应式 Web 示例](http://designmodo.com/responsive-design-examples/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:29:16.303

使用[CSS 媒体查询](http://www.w3.org/TR/css3-mediaqueries/)。这[是](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)一篇关于 ASP.NET MVC4 移动功能的有用文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:37:50.737

您还可以查看响应式 CSS。它使用设备宽度和图像缩放以及良好的 CSS 定义将站点缩放到设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T13:04:22.437

您还可以为响应式设计使用框架。

例如[无框网格](http://framelessgrid.com/)

# apache2 - 使用 301 登录页面重定向时出现错误

> ID：11451823
> 
> 赞同：0
> 
> 时间：2012-07-12T12:26:19.443
> 
> 标签：apache2

我正在将域重定向到我无权访问的另一个网站。例如，当有人在 url 中输入 www.mydomain.com 时，我希望他们重定向到 www.example.com/test.aspx?q=10。

如果我只是在地址栏中输入“http://www.example.com/test.aspx?q=10”，我会按预期被带到那里。当我重定向到那个确切的地址时，我得到一个错误。网站加载，但它是网站创建的错误页面。

我的问题是，这可能是我无法控制的网站上的某些内容，例如“if http.request == 301 {give error}”之类的代码。

请注意，这也发生在 303 请求上。

这是我重定向的方式：

```
<VirtualHost 1.1.1.1:80>
    ServerName www.mydomain.com
    Redirect 301 / http://www.example.com/test.aspx?q=10
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:30:19.330

我怀疑您对第三方网站阻止它的假设是正确的。可能类似于使用 HTTP_REFERER 检查引用页面？

也许您可以尝试删除 HTTP_REFERER

当你说你收到错误时，你能详细说明你的意思吗？

# python - 无法从我制作的 PyQt GUI 运行单个鼻子测试 - ValueError：没有这样的测试

> ID：11451828
> 
> 赞同：0
> 
> 时间：2012-07-12T12:26:37.140
> 
> 标签：python, pyqt, nose, nosetests

我创建了一个用于在 PyQt 中运行鼻子测试的 GUI。

界面代码： http: [//pastebin.com/uVhkdDZc](http://pastebin.com/uVhkdDZc)
我的代码： http: [//pastebin.com/3MG8PJn0](http://pastebin.com/3MG8PJn0)

我的界面读取 unittests 文件夹中的文件，然后用这些测试填充组合框，然后根据在所选测试文件中找到的测试填充另一个组合框。

基于[这些文档](http://nose.readthedocs.org/en/latest/man.html)，我认为我可以运行`nosetests /path/to/test/file.py:test_function`

但是，当我尝试在我的 unittest.py 文件中运行特定测试时，我得到一个`ValueError: No such test test_123`

我的界面生成的命令示例是：
`nosetests C:\path\to\my\unittest.py:test_123`
然而 unittest.py 包含`def test_123():`

那么我哪里错了？我需要添加到我的测试中吗？目前的设置/拆卸`pass`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T07:27:21.953

这可能比我想象的更明显，但是当我按照文档进行设置时，我总是忽略了基础知识。

因为我的测试是在一个类中设置的，所以在从该类中调用单个测试时需要引用该类。

所以我试图用
`nosetests C:\path\to\my\unittest.py:test_123`

我应该把它与它的班级联系起来
`nosetests C:\path\to\my\unittest.py:tests.test_123`

# sql - 用于减法的 SQL SPLIT 函数？

> ID：11451833
> 
> 赞同：0
> 
> 时间：2012-07-12T12:26:52.830
> 
> 标签：sql, split, db2

我在 DB2 中有表

```
id     HOURS     HOURSMINUTESECECONDS
1000   450.5     30:30:30 
```

Hours 是浮点值，HOURSMINUTESSECONDS 是字符串值

我使用这个函数减去它们：

```
 (HOURS - 
(CAST(substr(HOURSMINUTESSECONDS , 1, 2) AS float) +
 CAST(substr(HOURSMINUTESECONDS , 4, 2) AS float)/60 + 
CAST(substr(HOURSMINUTESECONDS , 7, 2) AS float)/3600)) as diff 
```

但是，如果我在 HOURSMINUTESECONDS 中的行在示例 300:30:30 或 3000:30:30 等上具有值，则这将不起作用（错误），因为子字符串仅采用第一个元素。

那么如何解决这个问题（SPLIT？）？要在“：”之间取全值，不计多少个字符？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:35:12.983

*   使用[`LOCATE`](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db2.doc.sqlref/flocate.htm)（告诉您在字符串中出现子字符串的索引）
*   或者，引用相对于字符串末尾的冒号：

`(HOURS - (CAST(substr(HOURSMINUTESSECONDS , 1, LENGTH(HOURSMINUTESSECONDS) - 6) AS float) + CAST(substr(HOURSMINUTESECONDS , LENGTH(HOURSMINUTESSECONDS) - 4, 2) AS float)/60 + CAST(substr(HOURSMINUTESECONDS , LENGTH(HOURSMINUTESSECONDS) - 1, 2) AS float)/3600)) as diff`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:34:03.937

可以使用MOD功能吗？

```
select 
    (hoursminutesseconds mod 10000) +
    ((hoursminutesseconds/100) mod 100)/60 +
    (hoursminutesseconds mod 100)*3600 
from
(
select replace(hoursminutesseconds,':','') as hoursminutesseconds from table
) as t 
```

# php - Drupal 7：过滤日期范围围绕公开日期的节点

> ID：11451834
> 
> 赞同：0
> 
> 时间：2012-07-12T12:26:54.437
> 
> 标签：php, drupal, view, drupal-7, drupal-views

我的问题与常见的“日期范围内的列表节点”有些相反。

所以，我有一个`Event`内容类型，带有字段`start_date`和`end_date`. 它们显示事件何时开始以及事件何时结束。现在我需要能够选择一个日期并获取所有`start_date < selected_date`事件`end_date > selected_date`。

选择的日期应该是对所有用户公开的过滤器，或者任何其他可以从 URL 获取的方式。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T17:12:14.333

只是一个想法：

*   制作两个暴露的过滤器（一个用于开始日期，另一个用于结束日期）
*   隐藏另一个
*   当用户在第一个中输入内容时填充两者

如果您不使用 AJAX 进行过滤，这应该可以工作。

# php - PHP Socket客户端 - 检测服务器断开连接

> ID：11451840
> 
> 赞同：1
> 
> 时间：2012-07-12T12:27:20.053
> 
> 标签：php, sockets

我有一个连接到服务器并等待从服务器发送文本行的套接字客户端。

我打开连接：

```
$handle = fsockopen(MY_IP_ADDRESS,MY_PORT,$sockErrno,$sockErrStr);
stream_set_blocking($handle,1);
stream_set_timeout($handle,MY_SOCKET_TIMEOUT); 
```

然后：

```
while (true) {
   $inString = fgets($handle,256);
   do some stuff with the received data... 
} 
```

这一切都很好。收到的消息之间没有特定的间隔。消息可能每秒到达数个或几分钟内不到达。

stream_set_timeout 设置为 60 秒......如果没有收到任何消息，那么我只是循环并再次将 fgets 排队。

有时，由于某种原因，连接会中断。

我希望能够检测到断开的连接，以便开始尝试重新连接。

有没有办法检测断开的连接？当流超时发生时，我可以检查哪些东西会告诉我不再有连接？

# android - 三星 Galaxy s2 DSR 已开启。不要发送 DTR ON

> ID：11451841
> 
> 赞同：16
> 
> 时间：2012-07-12T12:27:20.337
> 
> 标签：android

当我将设备插入计算机时，LogCat 中不断出现以下错误：

```
07-12 15:23:57.695: E/DataRouter(1820): DSR is ON. Don't send DTR ON.
07-12 15:23:59.700: E/DataRouter(1820): usb connection is true 
```

我的操作系统是 4.0.3 GT-19100T。

我看过有关它的帖子，但没有答案。any1 知道如何在我的 LogCat 中阻止这些烦人的消息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T15:28:51.040

您可以有选择地禁止显示日志。例如在你的情况下，你可以做

adb logcat 数据路由器：S

如果您想完全禁用日志

adb logcat -s

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T11:15:04.670

这个和许多其他错误是固件（或预装应用程序）的错误。你什么也做不了。如果您使用 Linux，我建议使用 grep 过滤此消息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T17:17:25.340

如果您只想查看应用程序的日志消息，请使用“-s”过滤掉其他所有内容，然后指定应用程序的标签以及所需的最低日志记录级别： adb logcat -s MyApp:V # show only MyApp, all日志级别 adb logcat -s MyApp:I # 仅显示 MyApp，日志级别为 'info' 及以上

要查看可用的过滤器字母，请使用 adb logcat --help 它们是（按优先顺序排列）：

*   致命的
*   E 错误
*   警告
*   我信息
*   D 调试
*   V 详细

它们对应于在您的应用程序中使用 Log.d(...)、Log.i(...) 等。

# tomcat - webapps中的Tomcat安全文件夹

> ID：11451842
> 
> 赞同：3
> 
> 时间：2012-07-12T12:27:21.693
> 
> 标签：tomcat, contextpath

我有一个 Web 应用程序和 Tomcat，比如它的服务器。我将我的网络应用程序放在文件夹中：`$(TOMCAT_HOME)/webapps/myapp`并将我的图像放入我在 tomcat 的**server.xml**`$(TOMCAT_HOME)/webapps/images` 中写下一个

 **```
<Context path="/images" docBase="c:/servers/apache-tomcat-7.0.29/webapps/images"/> 
```

它工作正常。但是，我想保护文件夹。我的意思是，如果用户没有登录我的应用程序，我想禁止访问该文件夹。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:56:02.647

您将需要在部署描述符中添加一个。类似这样的东西：

```
<security constraint>
    <web-resource-collection>
        <web-resource-name>Images</web-resource-name>
        <url-pattern>/images/*</url-pattern>
        <http-method>POST</http-method>

    <web-resource-collection>

    <auth-constraint>
        <role-name>Admin</role-name>
        <role-name>Member</role-name>
    </auth-constraint>

</security-constraint>

<security-role><role-name>Admin</role-name></security-role>
<security-role><role-name>Member</role-name></security-role>
<security-role><role-name>Guest</role-name></security-role> 
```

然后，您需要在 tomcat-users.xml 文件中定义用户角色：

```
<tomcat-users>
    <role rolename=”Admin”/>
    <role rolename=”Member”/>
    <role rolename=”Guest”/>
    <user username=”Conor” password=”admin” roles=”Admin, Member, Guest” />
    <user username=”SomebodyElse” password=”coder” roles=”Member, Guest” />
    <user username=”Andrew” password=”newbie” roles=”Guest” />
</tomcat-users> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-15T11:30:57.623

我知道这个问题有点老了，对于任何来这篇文章的人来说，我都遇到了类似的问题并找到了解决方法，

[Tomcat 7 - 保护 webapps 文件夹下的文件夹](https://stackoverflow.com/q/18142353/186896)**

# objective-c - 如何在模态视图控制器之间传递数据

> ID：11451845
> 
> 赞同：1
> 
> 时间：2012-07-12T12:27:31.593
> 
> 标签：objective-c, xcode

这是一个菜鸟问题。我想要将数据从我的 QuizViewcontroller 传递到 QuizModalViewController。我成功地创建了一个普通的模态视图控制器，但是在两者之间传递数据时遇到了问题。下面是我的代码。

**测验视图控制器**

```
-(IBAction)button3Clicked:(id)sender
{
  QuizModalViewController *mvid=[[QuizModalViewController alloc]initWithNibName:@"QuizModalViewController" bundle:nil];
mvid.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:mvid animated:YES];
} 
```

**QuizModalViewController**

```
- (IBAction)goBackToView
{
[self dismissModalViewControllerAnimated:YES];
//[controller loadQuestion:currentQuestionIndex+1];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:34:23.607

```
-(IBAction)button3Clicked:(id)sender
{
  QuizModalViewController *mvid=[[QuizModalViewController alloc]initWithNibName:@"QuizModalViewController" bundle:nil];
mvid.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
mvid.theDataYouWantToPass = theData; // this is how you do it
[self presentModalViewController:mvid animated:YES];
} 
```

请注意，`theDataYouWantToPass`必须是`QuizModalViewController.h`文件中声明的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T13:16:08.750

您还可以使用 -(void)prepareForSegue:... - 方法在控制器之间共享数据。

例如：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

   if ([segue.identifier isEqualToString:@"Your_Identifier"]) {

     TestViewController *controller = [segue destinationViewController];

     NSArray *array = [[NSArray alloc] initWithObjects:@"",nil];

     controller.objectInTestViewController = array;

   }
} 
```

希望这可以帮助某人....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:32:16.867

使您`QuizModalViewController`在类范围内可用，而不是使用局部变量。然后，`goBackToView:`您可以在关闭控制器之前访问控制器的内容。

顺便说一句：在您的代码中，您正在泄漏`mvid`. 模态呈现后释放它。

# magento - Magento 可配置产品页面 RRP 更新

> ID：11451848
> 
> 赞同：0
> 
> 时间：2012-07-12T12:27:46.367
> 
> 标签：magento

我们有一个可配置的产品，由所有具有不同价格和 RRP 的简单产品组成，当您在产品页面上从下拉列表中选择简单产品时，它会更新价格，但不会更新 RRP。

他们是一种让 RRP 和价格更新的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:34:37.927

我不确定 RRP（建议零售价？）是什么，但我认为您可能想查看 Magento 的事件系统并查找 product_save_before 事件。

您可以创建一个扩展，该扩展将在产品保存之前注入可以修改产品的代码。在这种情况下，您要更改 RRP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:39:11.517

嗨，是的，RRP 是 RRP（建议零售价？）就 product_save_before 而言，这与简单产品生成的选项下拉有关吗？我可能没有提到，但这是网站的前端。当用户在网站上选择简单产品时，它不仅会更改销售价格，还会更改显示的 RRP（RRP 与价格一起作为属性存储）

# vb.net - String 是一个类，不能用作表达式

> ID：11451851
> 
> 赞同：-4
> 
> 时间：2012-07-12T12:27:49.023
> 
> 标签：vb.net

我在 Visual Studio 2010 Express 中输入了以下内容，它是一个示例 Windows 应用程序，用于在 Web 浏览器中导航到 URI：

```
Private Sub Button1_Click(sender As System.Object, e As RoutedEventArgs)
String site = TextBox1.Text. 
```

我得到一个错误：

> String是类类型，不能作为表达式Visual Studio 2010 Express

来源可以在

[http://msdn.microsoft.com/en-us/library/ff402526(v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/ff402526(v=vs.92).aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T12:33:27.917

您声明变量错误。在 VB 中，您可以像这样声明一个变量：

```
Dim site As String = TextBox1.Text 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-12T12:34:47.677

在VB中写

```
Dim site As String = TextBox1.Text 
```

在 C# 中编写

```
string site = TextBox1.Text; 
```

你混合了两种语言。

给控件起有意义的名称也是一个好主意。例如`siteTextBox`或`txtSite`或`tbSite`。因为，一个人应该如何知道`TextBox17`或`Button19`应该代表什么？如果您创建事件处理程序，他们将“继承”这个名称，例如`btnOK_Click`，这告诉更多`Button3_Click`。

# php - foreach 循环中的数组问题

> ID：11451862
> 
> 赞同：0
> 
> 时间：2012-07-12T12:28:22.733
> 
> 标签：php, arrays, for-loop

我正在构建一个可以上传单个图像或多个图像的函数，具体取决于它是否来自字段数组。

这是函数和调用者：

```
private function imageUpload($image, $altText, $uploadDir)
{

    $uploadDir = (!substr($uploadDir, "/")) ? $uploadDir."/" : $uploadDir;
    print_r($_POST[$image]);
    if(is_array($_POST[$image]))
    {

        foreach($_FILES[$image] as $image)  //Line 316
        {

            //$targetPath = $uploadDir.basename($image['name']);
            //echo $targetPath;
            echo "array";

        }

    }
    else
    {

        $targetPath = $uploadDir.basename($image['name']);
        //echo $targetPath;
        echo "not array";

    }

}

$this->imageUpload('pei_image', 'pei_alt', '/images/upload/products/'); 
```

我尝试在 pei_image[] 字段中使用 1/2 图像字段，但出现以下错误：

> 遇到 PHP 错误
> 
> 严重性：通知消息：未定义索引：pei_image
> 
> 文件名：models/products_model.php
> 
> 行号：316
> 
> 遇到 PHP 错误
> 
> 严重性：警告
> 
> 消息：为 foreach() 提供的参数无效
> 
> 文件名：models/products_model.php
> 
> 行号：316

但是当我打印 $_POST[$image] 时，我得到了一个包含正确数量值的数组。结果如下：

> 数组（[0] => 06 Lect03 WD 概念 - mod SP.png [1] => brtemplate.jpg）

怎么了？

**编辑**

$_FILES 数组是空的，这是为什么呢？以下是表单中的 2 个图片上传字段：

```
<input type="file" name="pei_image[]" value="Showing-the-Heavy-horse.jpg" class="imageUpload" onchange="removePreviewButton(this, 2);">
<input type="file" name="pei_image[]" value="Showing-the-Heavy-horse.jpg" class="imageUpload" onchange="removePreviewButton(this, 3);"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:35:23.463

代替

```
foreach($_FILES[$image] as $image) 
```

经过

```
foreach($_FILES as $image) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:42:13.493

试试这个..

```
private function imageUpload($image, $altText, $uploadDir)
{

    $uploadDir = (!substr($uploadDir, "/")) ? $uploadDir."/" : $uploadDir;

    if(is_array($image)
    {

        foreach($image as $img)  //Line 316
        {

            //$targetPath = $uploadDir.basename($image['name']);
            //echo $targetPath;
            echo "array";

        }

    }
    else
    {

        $targetPath = $uploadDir.basename($image['name']);
        //echo $targetPath;
        echo "not array";

    }

}

$this->imageUpload('pei_image', 'pei_alt', '/images/upload/products/'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T12:43:37.547

假设 $image 是您的字段的名称，例如`'pictures'`或`'images'`其他名称，这会更好：

```
if (!empty($_FILES[$image])) {
    foreach ($_FILES[$image]["error"] as $key => $error) {
        if ($error == UPLOAD_ERR_OK) {
            $tmp_name = $_FILES[$image]["tmp_name"][$key];
            $name = $_FILES[$image]["name"][$key];

            // do your stuff
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T16:07:16.017

问题是我的 enctype 中的拼写错误，因此它默认为“application/x-www-form-urlencoded”，因此它不会上传到 $_FILES 数组。

# jquery - 如何使用 jquery-ui-1.8.21.autocomplete 和来自 mysql 的数据填写表格

> ID：11451866
> 
> 赞同：1
> 
> 时间：2012-07-12T12:28:27.507
> 
> 标签：jquery, mysql, jquery-ui-autocomplete

我正在使用 jquery-ui-autocomplete 从我的 mysql 数据库中成功检索一个字段，但是我需要从列表中获取用户的选择，从数据库中重新选择并使用从数据库中检索到的地址填写多个表单.

这是我到目前为止工作的代码，但我不知道如何继续，以获得我需要的结果。场景是这样的 - 我有一个 INPUT 字段，其中填充了从数据库中检索到的邮政编码。然后用户选择一个邮政编码，从该选择中我需要数据库中的所有地址来填充单个表单。

我的 HTML 文件：

```
$(document).ready(function() {
                $("#autocomplete").autocomplete({
                    autoFocus: true,
                    source: "search.php",
                    minLength: 2, //search after two characters
                    select: function(event, ui){
                        //do something
                        }
                    });
            });

<body>
    <input id="autocomplete" type="text" name="autocomplete" />
</body> 
```

我的 search.php 文件：

```
// DB connection is done here

$term = trim(strip_tags($_GET['term']));//retrieve the search term that autocomplete sends

$qstring = "SELECT DISTINCT zipcode FROM table WHERE zipcode LIKE '%".$term."%' ORDER BY zipcode ASC";
$result = mysql_query($qstring); //query the database for entries containing the term

while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) //loop through the retrieved values
{
$row['zipcode'] = htmlentities(stripslashes($row['zipcode']));
$row['id'] = (int)$row['id'];
$row_set[] = $row['zipcode']; //build an array
}

echo json_encode($row_set); //format the array into json data 
```

当然，我在查询中使用 DISTINCT 来消除多个相同的邮政编码。

谢谢您的帮助！罗伯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:16:52.607

It sounds like you want to use ajax. It will perform your search the same way it performs your autocomplete searches. The 'select' event will run whenever an autocomplete selection is made. If the user types in the full zipcode without using the autocomplete, I do not believe it will trigger. The 'change' event triggers upon leaving the field. It won't trigger until the user leaves the autocomplete field.

```
select: function(event, ui){

    $.ajax({
        url: "otherSearch.php",
        type: "POST",
        data: { input1 : input1,
                input2 : input2 },
        success: function(data) {

            //parse returned data and fill in the forms

            });
        }
    }
} 
```

more info on ajax: [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# c++ - c++ && <= 浮点数和如果

> ID：11451879
> 
> 赞同：-4
> 
> 时间：2012-07-12T12:29:01.423
> 
> 标签：c++, if-statement, floating-point, int

当我使用：

```
if( a>=0 && a<100 && b>=0 && b<200 ) 
```

一切正常，但如果我使用：

```
if( 0<=a<100 && 0<=b<200 ) 
```

我的程序崩溃了。a 和 b = 浮动。有人可以告诉我有什么区别吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-12T12:32:02.143

`0<=a<100`实际上是`(0<=a)<100`。由于`(0<=a)`是布尔值，它的值始终为 0 或 1（真或假），因此表达式变为`0<100`(or `1<100`)，它始终为真。

`a`由于您使用and来索引数组`b`，因此错误的边界检查会导致越界访问，这会使您的应用程序崩溃。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-12T12:39:51.987

它很可能会崩溃，因为即使 a 和 b 超出范围并且可能导致内存访问问题，条件也会评估为真。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-12T12:32:50.160

`0<=x<200`没有做你认为它在 C++ 中所做的事情。C++ 不允许您像那样将比较链接在一起，您需要这样做`0 <= x && x < 200`。

# java - 我可以让 MOXy 在生成 json 时将字符串转换为布尔值吗

> ID：11451880
> 
> 赞同：5
> 
> 时间：2012-07-12T12:29:04.000
> 
> 标签：java, json, jaxb, eclipselink, moxy

对象模型有一个以 String 类型结尾的元素

```
public class LifeSpan {

protected String begin;
protected String end;
@XmlJavaTypeAdapter(CollapsedStringAdapter.class)
protected String ended;
.... 
```

但它实际上只是一个布尔值，（我不知道 XmlJavaTypeAdapter 注释的意义）

当输出为 XML 给出

```
<life-span><begin>1999-04</begin><ended>true</ended></life-span> 
```

所以如果定义为布尔值或字符串并不重要

但 JSON 输出是

```
"life-span" : {
         "begin" : "1999-04",
         "ended" : "true"
      }, 
```

当我需要它时

```
 "life-span" : {
         "begin" : "1999-04",
         "ended" : true
      }, 
```

我无法真正更改对象模型，因此认为我可以映射到 oxml.xml 文件中的正确类型，并尝试了

```
<java-type name="LifeSpan">
            <java-attributes>
                <xml-element java-attribute="ended"  type="boolean"/>
            </java-attributes>
        </java-type> 
```

但它不喜欢那样。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T15:14:15.400

以下是如何使用[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)支持此用例：

**布尔字符串适配器**

An`XmlAdapter`允许您将一种类型的对象编组为另一种类型（请参阅[http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html](http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html)）。在此示例中，我们希望将`String`值视为`Boolean`1。

```
package forum11451880;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class BooleanStringAdapter extends XmlAdapter<Boolean, String> {

    @Override
    public String unmarshal(Boolean v) throws Exception {
        return v.toString();
    }

    @Override
    public Boolean marshal(String v) throws Exception {
        return Boolean.valueOf(v);
    }

} 
```

**oxm.xml**

我们可以利用 MOXy 的外部映射文档来增加通过注释提供的元数据以挂钩我们`XmlAadapter`（请参阅[http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html](http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html)）。

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum11451880">
    <java-types>
        <java-type name="LifeSpan">
            <java-attributes>
                <xml-element java-attribute="end">
                    <xml-java-type-adapter value="forum11451880.BooleanStringAdapter"/>
                </xml-element>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

**寿命**

下面是具有`end`type 属性的域模型`String`。

```
package forum11451880;

import javax.xml.bind.annotation.*;
import javax.xml.bind.annotation.adapters.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class LifeSpan {

    protected String begin;

    protected String end;

    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    protected String ended;

} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`使用以下条目调用的文件（请参阅[http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)）：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

下面的演示代码演示了如何利用外部映射文档。

```
package forum11451880;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextProperties;
import org.eclipse.persistence.jaxb.MarshallerProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum11451880/oxm.xml");
        JAXBContext jc = JAXBContext.newInstance(new Class[] {LifeSpan.class}, properties);

        LifeSpan lifeSpan = new LifeSpan();
        lifeSpan.begin = "1999-04";
        lifeSpan.end = "true";

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(lifeSpan, System.out);

        marshaller.setProperty(MarshallerProperties.MEDIA_TYPE, "application/json");
        marshaller.marshal(lifeSpan, System.out);
    }

} 
```

**输出**

下面是运行示例的输出。如您所见，该`true`值不带引号出现：

```
<?xml version="1.0" encoding="UTF-8"?>
<lifeSpan>
   <begin>1999-04</begin>
   <end>true</end>
</lifeSpan>
{
   "lifeSpan" : {
      "begin" : "1999-04",
      "end" : true
   }
} 
```

# sql - 日志解析器 ORDER BY CASE 语句

> ID：11451881
> 
> 赞同：1
> 
> 时间：2012-07-12T12:29:08.833
> 
> 标签：sql, logging, logparser

这是一个我似乎无法解决的微不足道的问题。我正在使用 LogParser 分析一些电话系统 CSV 日志文件。我正在尝试生成两个日期之间所有来电的图表，按星期几分组。我已经实现了这一点，但我正在努力让图表以正确的顺序显示列，从星期一开始。我传递给 LogParser 的 SQL 查询如下：

```
SELECT to_string(to_timestamp(c1, 'yyyy/MM/dd HH:mm'), 'dddd') as Day, count(*) as Calls
INTO graph.gif
FROM C:\logs\*.txt
WHERE c5 = 'I'
AND to_timestamp(c1, 'yyyy/MM/dd HH:mm')
    BETWEEN 
        timestamp('10/05/2012', 'dd/MM/yyyy')
    AND timestamp('24/05/2012', 'dd/MM/yyyy')
GROUP BY Day 
```

它实际上以正确的顺序输出，根本没有任何 ORDER BY 语句，但我认为第一列始终是日期范围开始的那一天，而我希望它始终是星期一（以便于比较图表）。目前发生的事情是将我的日志文件中的时间戳转换为星期几的字符串表示（用于输出），据我所知，没有内置逻辑'星期一'小于'星期二'等等。我的直觉是在 ORDER BY 中使用 CASE 语句，但 LogParser 不会接受这一点。

这是我的整个 LogParser 命令，以防万一，

```
C:\Program Files (x86)\Log Parser 2.2\Logparser.exe" -i:CSV "SELECT to_string(to_timestamp(c1, 'yyyy/MM/dd HH:mm'), 'dddd') as Day, count(*) as Calls INTO graph.gif FROM C:\logs\*.txt WHERE c5 = 'I' AND to_timestamp(c1, 'yyyy/MM/dd HH:mm') BETWEEN timestamp('10/05/2012', 'dd/MM/yyyy') AND timestamp('24/05/2012', 'dd/MM/yyyy') GROUP BY Day" -chartType:Column3D -chartTitle:"Incoming Calls" -values:ON -config:MyConfig.js -o:CHART -headerRow OFF -iHeaderFile C:\logs\header\header.txt 
```

我只想让我的结果订单始终从星期一开始，无论日期范围如何。有任何想法吗？

编辑 - 这是包含在 ORDER BY 中的 CASE 语句的查询。

```
SELECT to_string(to_timestamp(c1, 'yyyy/MM/dd HH:mm'), 'dddd') as Day, count(*) as Calls
INTO graph.gif
FROM C:\logs\*.txt
WHERE c5 = 'I'
AND to_timestamp(c1, 'yyyy/MM/dd HH:mm')
    BETWEEN 
        timestamp('10/05/2012', 'dd/MM/yyyy')
    AND timestamp('24/05/2012', 'dd/MM/yyyy')
GROUP BY Day
ORDER BY (CASE
    WHEN Day = 'Monday' THEN 1
    WHEN Day = 'Tuesday' THEN 2
    WHEN Day = 'Wednesday' THEN 3
    WHEN Day = 'Thursday' THEN 4
    WHEN Day = 'Friday' THEN 5
    WHEN Day = 'Saturday' THEN 6
    WHEN Day = 'Sunday' THEN 7
END) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:22:51.597

您的订单需要如下所示：

```
order by (case when day = 'Monady' then 1
               when day = 'Tuesday' then 2
               when day = 'Wednesday' then 3
               when day = 'Thursday' then 4
               when day = 'Friday' then 5
               when day = 'Saturday' then 6
               when day = 'Sunday' then 7
          end) 
```

或者，如果您的数据库具有星期功能，那么您可以执行以下操作：

```
order by (datepart(day, <date>)+5)%7 
```

这是 SQL Server 语法。datepart 给出了星期天的第 1 天和星期一的 2。算术只是将星期一移到 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T22:37:05.243

......

```
`   CASE Day WHEN 'Monday' THEN 1
else CASE Day WHEN 'Tuesday' THEN 2
else CASE Day WHEN 'Wednesday' THEN 3
else CASE Day WHEN 'Thursday' THEN 4
else CASE Day WHEN 'Friday' THEN 5
else CASE Day WHEN 'Saturday' THEN 6
else CASE Day WHEN 'Sunday' THEN 7
END end end end end end end AS DayNumber` 
```

...........

```
`Order by DayNumber` 
```

# javascript - function(){}和new function(){}有什么区别

> ID：11451885
> 
> 赞同：0
> 
> 时间：2012-07-12T12:29:26.063
> 
> 标签：javascript, oop, object

和有什么区别

```
RGBCatcher = new function(){} 
```

和

```
var Basket = function(){} 
```

一个有`new function()`而另一个只是有`function()`。还有一个是使用`var`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T12:35:05.717

它们不是 jQuery 对象。这是基本的 JavaScript 语法。

是否包含 a 的区别在于`var`省略 a`var`会使变量 ( `RGBCatcher`) 在全局范围内隐式声明，这是一种不好的做法；您应该始终使用`var`语句。

`function`它本身声明了一个函数（在这种情况下它是一个函数表达式），因此您可以调用`Basket()`以执行指向该`Basket`变量的函数。

`new function`调用构造`new`创建的匿名函数`function`；它与以下相同（当然，除了您没有创建名为 的函数`Constructor`）；

```
function Constructor() {

}

var RGBCatcher = new Constructor(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T12:38:23.057

请关注此线程：

[JavaScript中带有小写“f”的`new function()`](https://stackoverflow.com/questions/2274695/new-function-with-lower-case-f-in-javascript)

```
var a = new function(){

    var member = '1';
    alert(member);
} 
```

// 警报 1

```
 var b=   function(){
    alert('2');
    return '2';
}(); 
```

// 警报 2

```
(function (){
    alert ('3');
    return '3';
})(); 
```

//警报 3

```
alert (a); 
```

// 警报 [对象对象]

```
alert (b); 
```

// 警报 2

# python - OpenGL utf-8 字符串渲染

> ID：11451901
> 
> 赞同：1
> 
> 时间：2012-07-12T12:30:09.507
> 
> 标签：python, opengl, utf-8, pyopengl

是否有可以在 OpenGL 中显示 UTF-8 字符串的 python 模块？

我找到了 pyFTGL，但是当我运行以下代码时：

```
 glMaterialfv(GL_FRONT, GL_AMBIENT_AND_DIFFUSE, [1, 1, 1, 1])
    font = FTGL.PolygonFont("NeoTechStd-Medium.ttf")
    font.FaceSize(8)
    font.line_height
    font.Render("Angle = ? \u03C4") 
```

我收到此错误：

```
 font.Render(u"Weld Head Angle = ? \u03C4")
Boost.Python.ArgumentError: Python argument types in
    PolygonFont.Render(PolygonFont, unicode)
did not match C++ signature:
    Render(FontWrapper<FTPolygonFont> {lvalue}, char const*, double)
    Render(FontWrapper<FTPolygonFont> {lvalue}, char const*)
DEBUG:Helpers.opengl_pipe:Redrawing contents of GLArea. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:15:23.090

您没有通过 UTF-8 渲染方法；您正在向它传递一个 unicode 文字。

您需要将其编码为 UTF-8：

```
font.Render("Angle = ? \u03C4".encode('utf8')) 
```

我衷心推荐你阅读[这篇关于 Unicode 和编码主题的文章，](http://www.joelonsoftware.com/articles/Unicode.html)以帮助理解它们的区别。

# r - 使用循环计算子集

> ID：11451902
> 
> 赞同：0
> 
> 时间：2012-07-12T12:30:10.267
> 
> 标签：r

我有一个包含不同变量的数据框，我想使用某些条件从该数据框中构建不同的子集，并且我想使用循环，因为会有很多子集，这将节省大量时间。

这是条件：

变量 A 有一个区域的 ID，变量 B 有不同的物种（1、2、3 等），我想用这些列计算不同的子集。每个子集的名称应该是一个点的ID，内容应该是这个点上某个物种的所有个体。

为了更好地理解：

这将是一个子集的代码，我想使用一个循环

```
A_2_NGF_Abies_alba <- subset(A_2_NGF, subset = Baumart %in% c("Abies alba")) 
```

这可能在R中做吗

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:51:23.290

这对你有帮助吗？

```
Baumdaten <- data.frame(pointID=sample(c("A_2_SEF","A_2_LEF","A_3_LEF"), 10, T), Baumart=sample(c("Abies alba", "Betula pendula", "Fagus sylvatica"), 10, T))

split(Baumdaten, Baumdaten[, 1:2]) 
```

# perl - 计算器不考虑运算的优先级

> ID：11451903
> 
> 赞同：-5
> 
> 时间：2012-07-12T12:30:15.090
> 
> 标签：perl

这是一个简单的代码。必须稍微修改以考虑操作的优先级，但我不知道要修复什么。

`

```
print "\nEnter the expression: ";

chomp($_ = <>);

print "\n";

sub mul {return $1*$2;}
sub div {return $1/$2;}
sub sum {return $1+$2;}
sub dif {return $1-$2;}

while(
     s/([+-]?\d+)\s*[*]\s*([+-]?\d+)/mul($1,$2)/e  || 
     s/([+-]?\d+)\s*[\/]\s*([+-]?\d+)/div($1,$2)/e || 
     s/([+-]?\d+)\s*[+]\s*([+-]?\d+)/sum($1,$2)/e  || 
     s/([+-]?\d+)\s*[-]\s*([+-]?\d+)/dif($1,$2)/e  || 
     s/\(\s*([+-]?\d+)\s*\)/$1/e
      )

{print "$_\n";}

print "\nThe ansver = $_\n"; 
```

`

我很高兴能帮上忙，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T15:48:41.470

如果您决定使用[Parse::RecDescent](http://search.cpan.org/perldoc?Parse%3a%3aRecDescent)（或任何其他 LL 解析器），我建议您阅读[Parse::RecDescent 中的运算符关联性和消除左递归](http://www.perlmonks.org/?node_id=553889)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T15:42:30.417

您真的应该考虑将输入转换为某种语法树。它会缓解你的问题。调车码算法浮现在脑海中。

# perl - Perl 模块找出一个词是否是动词/名词/形容词/冠词/介词

> ID：11451908
> 
> 赞同：0
> 
> 时间：2012-07-12T12:30:29.720
> 
> 标签：perl, nlp

我有一个单词列表，我想根据它们是否是动词/形容词/名词/等将它们分成不同的组。所以，基本上我正在寻找一个 Perl 模块，它告诉一个单词是否是动词/名词等。

我用谷歌搜索，但找不到我要找的东西。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:54:19.977

请参阅[CPAN 中的 Lingua::EN:: 命名空间](http://search.cpan.org/search?query=lingua%3a%3aen&mode=all)。具体来说，[Link Grammar](http://www.link.cs.cmu.edu/link/)和[Lingua::EN::Tagger](http://p3rl.org/Lingua%3a%3aEN%3a%3aTagger)可以帮助你。WordNet 也提供了这种信息，您可以[使用这个 perl 模块](http://qwone.com/~jason/WordNet/)来查询它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:56:45.237

[Lingua::EN::Tagger](http://p3rl.org/Lingua%3a%3aEN%3a%3aTagger) , [Lingua::EN::Semtags::Engine](http://p3rl.org/Lingua%3a%3aEN%3a%3aSemtags%3a%3aEngine) , [Lingua::EN::NamedEntity](http://p3rl.org/Lingua%3a%3aEN%3a%3aNamedEntity)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-21T07:33:06.830

按照代码 perl 帮助您在文件夹中的文本文件中找到所有这些东西只给出目录的路径，它将一次处理所有文件并将结果保存在 report.txt 文件中强文本

```
 #!/usr/local/bin/perl

# for loop execution

# Perl Program to calculate Factorial
sub fact
{

# Retriving the first argument
# passed with function calling
my $x = $_[0];
my @names = @{$_[1]};
my $length = $_[2];

# checking if that value is 0 or 1
if ($x < $length)
{
#print @names[$x],"\n";

 use Lingua::EN::Fathom;
 my $text = Lingua::EN::Fathom->new();

 # Analyse contents of a text file
 $dirlocation="./2015/";
 $path =$dirlocation.$names[$x];

 $text->analyse_file($path); # Analyse contents of a text file

 $accumulate = 1;
 # Analyse contents of a text string
 $text->analyse_block($text_string,$accumulate);
  # TO Do, remove repetition

 $num_chars             = $text->num_chars;
 $num_words             = $text->num_words;
 $percent_complex_words = $text->percent_complex_words;
 $num_sentences         = $text->num_sentences;
 $num_text_lines        = $text->num_text_lines;
 $num_blank_lines       = $text->num_blank_lines;
 $num_paragraphs        = $text->num_paragraphs;
 $syllables_per_word    = $text->syllables_per_word;
 $words_per_sentence    = $text->words_per_sentence;

# comment needed
 %words = $text->unique_words;
 foreach $word ( sort keys %words )
 {
#   print("$words{$word} :$word\n");
 }

 $fog     = $text->fog;
 $flesch  = $text->flesch;
 $kincaid = $text->kincaid;
 use strict;
 use warnings;
 use 5.010;

    my $filename = 'report.txt';
    open(my $fh, '>>', $filename) or die "Could not open file '$filename' $!";
    say $fh $text->report;
    close $fh;
    say 'done';
    print($text->report);

    $x = $x+1;
    fact($x,\@names,$length);
}

# Recursively calling function with the next value
# which is one less than current one
else
{
    done();
}
}

# Driver Code
$a = 0;
@names = ("John Paul", "Lisa", "Kumar","touqeer");
opendir DIR1, "./2015" or die "cannot open dir: $!";
my @default_files= grep { ! /^\.\.?$/ } readdir  DIR1;
$length = scalar @default_files;
print $length;
# Function call and printing result after return
fact($a,\@default_files,$length);

sub done
{
    print "Done!";
} 
```

# android - 如何将图像保存到从图库中选择的 sqlite 数据库或从相机捕获到 sqlite 数据库

> ID：11451912
> 
> 赞同：1
> 
> 时间：2012-07-12T12:30:41.297
> 
> 标签：android

我想使用从图库中选择或从相机捕获的 blob 将图像存储到 sqlite 数据库，并从数据库中取回这些图像以显示在列表视图或网格视图中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:59:17.670

可以从 sqlite 数据库存储图像和检索图像。

存储它的代码

```
 // Convert your bitmap to byte array

ByteArrayOutputStream out = new ByteArrayOutputStream();

bitmap.compress(Bitmap.CompressFormat.PNG, 100, out);

byte[] bytes = out.toByteArray();

ContentValues cv = new ContentValues();

cv.put("IMAGE", bytes); 
```

检索它的代码

```
 // Use Cursor to retrieve the image

     byte[] bytes = cursor.getBlob(column_index);

     ByteArrayInputStream input = new ByteArrayInputStream(bytes);

     Bitmap bit = BitmapFactory.decodeStream(input); 
```

# asp.net-mvc - 为什么没有 @Html.RouteAction(routeName: "MyRouteName") 助手？

> ID：11451913
> 
> 赞同：-1
> 
> 时间：2012-07-12T12:30:47.980
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, html-helper

我喜欢使用强定义的路由，比如

`@Html.RouteLink("Home", RouteName.HomeIndex)`

为什么子动作没有等效的助手？我不喜欢真正的`@Html.Action(actionName, controllerName, routeValues)`帮手。

此外，性能会更好。无需检查 RouteCollection 中的所有内部路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:45:17.573

[在http://aspnet.codeplex.com/](http://aspnet.codeplex.com/)上贡献你的想法，甚至是帮助者——它是开源的。

为什么没有的答案是：

1.  还没有人想到
2.  有人想过但没有做任何事情
3.  有人想到了它，但想得更好——例如，因为路由可能非常通用，您需要为大多数路由提供控制器、动作和路由值，这意味着动作助手工作正常。

在性能方面，我没有遇到任何性能问题，`Html.Action`因此您可能需要在过于关注优化框架的这方面之前对其进行测量。

# css - 制作皇家滑块全屏

> ID：11451914
> 
> 赞同：2
> 
> 时间：2012-07-12T12:30:48.337
> 
> 标签：css, slider, positioning

嗨，我正在使用皇家滑块，并试图使其全屏显示。导航箭头似乎工作正常，但没有其他工作。我希望它像这个站点一样运行（单击任何缩略图以查看滑块）[http://ahrengot.com/work/skive-festival-website/](http://ahrengot.com/work/skive-festival-website/)这是我无法复制的页面[http://klossal.com/js/royalslider/demo/test.html](http://klossal.com/js/royalslider/demo/test.html)

我能得到的任何帮助都会很棒，这几乎是我网站需要的最后一个功能，而且我已经失败了几天了，谢谢。

HTML：

```
<div id="content-slider" class="royalSlider iskin">                
<ul class="royalSlidesContainer">       
    <li class="royalSlide"> 
        <div style="border:1px solid red;height:100%;">
            <img src="img/contentSliderAssets/4.jpg" width="285" height="200"/>
            <div style="border:1px solid red;">
                <h4>Content Slider</h4>
                <p>You can place HTML content on each slide, touch navigation still 
works. Also you can disable mouse navigation completely or just for specific elements:   
</p>
                <a class="learnMore non-draggable" href="javascript:void()">Non-  
draggable element</a>
                <a class="learnMore" href="javascript:void()">Draggable element</a>
            </div>
        </div>
    </li>
    <li class="royalSlide"> 
        <div >
            <img src="img/contentSliderAssets/1.jpg" width="195" height="240"/>
            <img src="img/contentSliderAssets/2.jpg" width="178" height="240"/>
            <img src="img/contentSliderAssets/3.jpg" width="197" height="240"/>
        </div>
    </li>
    <li class="royalSlide"> 
        <div>               
            <div style="text-align:center; width: 660px; margin: 100px auto 0;">                    
                <p>Slider is tested on  iPad, iPad 2, iPhone 4, HTC Desire and 
Blackberry PlayBook.<br/> If you've found that something works incorrect on your 
device, so please contact me using contact form on my <a 
href="http://goo.gl/H9VAg">profile page</a> and I'll try to fix it asap.</p>
            </div>   
        </div>      
    </li>        
</ul>   
</div> 
```

CSS：

```
/**
*  Slides area (set background here)
*/

.royalSlider .royalWrapper {
overflow:hidden;    
position:relative;

width:100%; 
height:100%;
}
.royalSlider .royalSlide,
.royalSlider .royalWrapper {
/* Bakground behind slides */
background: #111111;
}
/* slides holder, grabbing container */
.royalSlider .royalSlidesContainer {
position: relative;
left: 0;
top: 0 !important;
list-style:none !important;
margin:0 !important;
padding:0 !important;
border: 0 !important;
}

/* slide item */
.royalSlider .royalSlide {
padding: 0 !important;
margin: 0 !important;   
border: 0 !important;
list-style: none !important;

position:relative;
float:left; 

overflow:hidden;    
}

/* 

Direction Navigation (arrows) 

*/
.royalSlider .arrow
{   
/*background:url(../img/controlsSprite.png) no-repeat 0 0;*/
background-color: #C00;
background-repeat: no-repeat;
background-position: 0 0;

/* change arrows size here */
width: 45px;
height: 90px;

top:50%;
margin-top:-45px;   

cursor: pointer;
display: block;
position: absolute;     

z-index:25;

}
.royalSlider .arrow:hover {

}
.royalSlider .arrow.disabled {

}
/* left arrow */
.royalSlider .arrow.left {
background-position: top left;
left: 0;    
}
/* right arrow */
.royalSlider .arrow.right {
background-position: top right;
right: 0;
 }

/* Control navigation container (bullets or thumbs) */
.royalSlider .royalControlNavOverflow {
width:100%;
overflow:hidden;
position:absolute;
margin-top:-20px;
z-index:25;
}
/* This container is inside ".royalControlNavContainer"  
and is used for auto horizontal centering */
.royalSlider .royalControlNavCenterer { 
float: left;
position: relative;
left: -50%;
}
/* Control navigation container*/ 
.royalSlider .royalControlNavContainer {
float: left;
position: relative;
left: 50%;  
}

/* Scrollable thumbnails containers */
.royalSlider .royalControlNavThumbsContainer {      
left:0;
position:relative;
}
.royalSlider .thumbsAndArrowsContainer {
overflow:hidden;
width: 100%;
position: relative;
}
.royalSlider .royalControlNavOverflow.royalThumbs { 
width: auto;
position: relative;
overflow: hidden;
margin-top:4px; 
}

/* 

Control navigation (bullets, thumbnails)

*/
.royalSlider .royalControlNavOverflow a{    
background:#0C0 none no-repeat scroll 0 0;

width:20px;
height:20px;    

float:left; 
cursor:pointer; 

position:relative;
display:block;

text-indent: -9999px;   
}
/* Current control navigation item */
.royalSlider .royalControlNavOverflow a.current {   
background-color: #C00; 
}
/* Hover state navigation item */
.royalSlider .royalControlNavOverflow a:hover { 
background-color: #00C;
}

/* Thumbnails */
.royalSlider .royalControlNavOverflow a.royalThumb{ 
/*background: none no-repeat 0 0;*/
/*background-color: ;*/
width:144px;
height:60px;    
/* thumbnails spacing, use margin-right only */ 
margin-right:4px;

}
.royalSlider .royalControlNavOverflow a.royalThumb.current {    
background-position: -3px -3px  !important;
border:3px solid #C00 !important;
width:138px;
height:54px;
}
.royalSlider .royalControlNavOverflow a.royalThumb:hover {  
background-position: -3px -3px; 
border:3px solid #00C;
width:138px;
height:54px;
}

/* 

Thumbnails navigation arrows 

*/
.royalSlider .thumbsArrow { 
width: 38px;
height: 68px;   

cursor: pointer;
display: block;
position: relative;     
z-index: 25;

background: #C99;

}
.royalSlider .thumbsArrow.left {    
float: left;
}
.royalSlider .thumbsArrow.right {   
float: right;
}
.royalSlider .thumbsArrow:hover  {

}
.royalSlider .thumbsArrow.disabled {

}

/* Captions container */
.royalSlider .royalCaption {
z-index:20;
display:block;
position:absolute;  
left:0;
top:0;
/*font: normal normal normal 1em/1.5em Georgia, serif;
color:#FFF;     */
}
/* Caption item */
.royalSlider .royalCaptionItem {
position:absolute;  
left:0;
top:0;
margin: 0;
padding: 0;
}

/* Loading (welcome) screen */
.royalSlider .royalLoadingScreen {
background:#FFF;
width:100%;
height:100%;
position:absolute;
z-index:99; 
}
/* Loading screen text ("Loading...") */
.royalSlider .royalLoadingScreen p {        
width:100%;
position:absolute;  
margin:0 auto;
top: 45%;
text-align:center;
}

/* single slide image preloader */
.royalSlider .royalPreloader {  
position:absolute;
width:24px;
height:24px;
left:50%;
top:50%;
margin-left:-12px;
margin-top:-12px;   
z-index:0;  
background-image:url(../img/preloader.gif);
}

.royalSlider .grab-cursor{cursor:move;}
.royalSlider .grab-cursor{cursor:url("../img/cursors/grab.png") 8 8,-moz-grab;}
.royalSlider .grab-cursor{*cursor:url(../img/cursors/grab.cur);}
.royalSlider .grab-cursor{cursor:move\0/;} /* ie8 hack */

.royalSlider .grabbing-cursor{cursor:move;}
.royalSlider .grabbing-cursor{cursor:url("../img/cursors/grabbing.png") 8 8,-moz-
grabbing;}
.royalSlider .grabbing-cursor{*cursor:url(../img/cursors/grabbing.cur);}

/* Cursor used if mouse dragging is disabled */
.royalSlider .auto-cursor{cursor:auto;}

.royalSlider .royalHtmlContent {
position: absolute;
top: 0;
left: 0;
}
.royalSlider .non-draggable {
cursor: auto;
}
.royalSlider .fade-container .royalSlide{
position: absolute;
left: 0;
top: 0;
list-style-type: none;
margin: 0;
padding: 0;
z-index: 10;
}
.royalSlider .royalImage {
max-width:none;
margin:0;
padding: 0 !important;
border: 0 !important;   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T15:42:22.070

为什么不问脚本作者。自动缩放滑块选项根据宽度进行高度缩放，如果您想要全屏，则需要禁用它。

```
.royalSlider {
position: absolute;
left: 0;
top: 0;
bottom: 0;
right: 0;
height: auto;
width: auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:38:01.720

在 Royalslider 的脚本文件中，您可以通过设置以下值来管理它：

```
 autoScaleSlider: true,  // Overrides css slider size settings. Sets slider height based on base width and height. Don't forget to set slider width to 100%.
     autoScaleSliderWidth: 0,   // Base slider width
     autoScaleSliderHeight: 0, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T11:52:15.090

我注意到你的问题，因为我看到我的投资组合从这里来的流量。我的整个 WordPress 主题实际上是在 Github 上公开的，所以你可以看看我的代码。这是链接：[https ://github.com/Ahrengot/Ahrengot-WP-Theme](https://github.com/Ahrengot/Ahrengot-WP-Theme)

这是画廊使用的 JS 文件的链接：[https ://github.com/Ahrengot/Ahrengot-WP-Theme/blob/master/library/js/work-gallery.js](https://github.com/Ahrengot/Ahrengot-WP-Theme/blob/master/library/js/work-gallery.js)

希望这可以帮助 ：）

# debugging - vb6如何在msgbox中进入调试模式

> ID：11451915
> 
> 赞同：1
> 
> 时间：2012-07-12T12:30:49.427
> 
> 标签：debugging, vb6, msgbox

我已经进行了一些搜索，但没有找到这个问题，对不起。

在 vb6 循环中，我显示了一个 msgbox。有什么方法可以进入调试模式（如使用 F8）？我需要这个来改变 msgbox 的条件。

不是，我无法重新启动项目，因为那样我将丢失更改和阵列花费的时间（几个小时）。

TIA。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T12:37:43.720

假设您在 MsgBox 显示时在 Debugger 中运行，请按 Ctrl + Break 中断 MsgBox 并进入单行单步执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T12:35:10.347

您可以使用断点——您可以通过单击代码附近的栏来标记代码中的点，然后在指令指针到达这一点时运行代码，您将看到此时的代码和值。

希望这有帮助。

# java - 如何使用 jUnit 对 Servlet 过滤器进行单元测试？

> ID：11451917
> 
> 赞同：40
> 
> 时间：2012-07-12T12:30:54.027
> 
> 标签：java, junit

实施`doFilter()`。如何用 jUnit 正确覆盖过滤器？

```
public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
        throws java.io.IOException, javax.servlet.ServletException
{
    HttpServletRequest request = (HttpServletRequest) servletRequest;
    HttpServletResponse response = (HttpServletResponse) servletResponse;
    String currentURL = request.getRequestURI();

    if (!currentURL.equals("/maintenance.jsp") && modeService.getOnline())
    {
        response.sendRedirect("/maintenance.jsp");
    }
    filterChain.doFilter(servletRequest, servletResponse);
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-12T12:50:15.473

`ServletRequest`，`ServletResponse`并且`FilterChain`都是接口，因此您可以轻松地为它们创建测试存根，无论是手动还是使用模拟框架。

使模拟对象可配置，以便您可以准备一个预设响应`getRequestURI()`，以便您可以查询 ServletResponse 以断言已调用 sendRedirect。

注入一个模拟 ModeService。

调用 doFilter 传递模拟 ServletRequest、ServletResponse 和 FilterChain 作为其参数。

```
@Test
public void testSomethingAboutDoFilter() {
    MyFilter filterUnderTest = new MyFilter();
    filterUnderTest.setModeService(new MockModeService(ModeService.ONLINE));
    MockFilterChain mockChain = new MockFilterChain();
    MockServletRequest req = new MockServletRequest("/maintenance.jsp");
    MockServletResponse rsp = new MockServletResponse();

    filterUnderTest.doFilter(req, rsp, mockChain);

    assertEquals("/maintenance.jsp",rsp.getLastRedirect());
} 
```

在实践中，您需要将设置移动到 @Before`setUp()`方法中，并编写更多 @Test 方法来覆盖所有可能的执行路径。

...而且您可能会使用像 JMock 或 Mockito 这样的模拟框架来创建模拟，而不是`MockModeService`我在这里使用的假设等。

这是一种*单元测试*方法，与集成测试相反。您只是在执行被测单元（和测试代码）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-11-09T07:57:17.763

您可以使用模拟框架来模拟上述内容`HttpServletRequest`、对象`HttpServletResponse`及其`FilterChain`行为。根据框架，您具有某些功能，以验证在执行代码期间是否对所采取的模拟对象采取了正确的操作。

例如，当使用**Mockito**模拟框架时，`doFilter()`可以使用以下测试用例对提供的方法进行 JUnit 测试：

```
@Test
public void testDoFilter() throws IOException, ServletException {
    // create the objects to be mocked
    HttpServletRequest httpServletRequest = mock(HttpServletRequest.class);
    HttpServletResponse httpServletResponse = mock(HttpServletResponse.class);
    FilterChain filterChain = mock(FilterChain.class);
    // mock the getRequestURI() response
    when(httpServletRequest.getRequestURI()).thenReturn("/otherurl.jsp");

    MaintenanceFilter maintenanceFilter = new MaintenanceFilter();
    maintenanceFilter.doFilter(httpServletRequest, httpServletResponse,
            filterChain);

    // verify if a sendRedirect() was performed with the expected value
    verify(httpServletResponse).sendRedirect("/maintenance.jsp");
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-03-29T08:03:01.240

如果您使用的是 Spring，那么它有自己的模拟：

*   org.springframework.mock.web.MockFilterChain
*   org.springframework.mock.web.MockHttpServletRequest
*   org.springframework.mock.web.MockHttpServletResponse

例如，您可以添加标头并设置测试 Uri。

所以你的测试可以是这样的：

```
@RunWith(MockitoJUnitRunner.class)
public class TokenAuthenticationFilterTest {

    private static final String token = "260bce87-6be9-4897-add7-b3b675952538";
    private static final String testUri = "/testUri";

    @Mock
    private SecurityService securityService;

    @InjectMocks
    private TokenAuthenticationFilter tokenAuthenticationFilter = new TokenAuthenticationFilter();

    @Test
    public void testDoFilterInternalPositiveScenarioWhenTokenIsInHeader() throws ServletException, IOException {
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.addHeader(TOKEN, token);
        request.setRequestURI(testUri);
        MockHttpServletResponse response = new MockHttpServletResponse();
        MockFilterChain filterChain = new MockFilterChain();
        when(securityService.doesExistToken(token)).thenReturn(true);
        tokenAuthenticationFilter.doFilterInternal(request, response, filterChain);
        assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());
    }
} 
```

# javascript - 无法在最新（稳定的 12 和 beta v. 1497）歌剧中的 userjs（注入脚本）中执行跨域 xmlhttprequest，这是一个错误吗？

> ID：11451922
> 
> 赞同：2
> 
> 时间：2012-07-12T12:31:23.687
> 
> 标签：javascript, xmlhttprequest, cross-domain, opera, userscripts

问题是当脚本在页面上时它可以工作，通常是从网上获取的，但是当代码位于作为插件的一部分的用户脚本中时，它突然忘记了有`Access-Control-Allow-Origin: *`标题并停止响应跨域请求.

这是一些说明这一点的代码：

```
// ==UserScript==
// @include     *nasa.gov*
// ==/UserScript==

var xhr = new window.XMLHttpRequest();
xhr.onreadystatechange = function () {
  alert('state changed: ' + this.readyState + "\nstatus: " + this.status);
};
xhr.onload = function(){
  alert('document loaded');
};
xhr.open('GET','http://apod.nasa.gov');
xhr.send(null); 
```

我选择了 apod 站点，因为它没有现代网站的黑白，因此无需过滤事件。

在这种状态下它可以正常工作，但是当我将此 url 指向我的服务器时，它接受来自每个站点的调用，它会忽略 allow-origin 标头...

好的，这是一个错误，还是我在这里做错了什么？也许请求对象上的一些选项可以“确保”它可以去那里？我不知道喜欢`xhr.allowcrossdomainaccess = true`还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:57:40.373

（你已经想通了——但只是为了给这个问题一个正确的答案..）

注入的脚本以（大部分）正常的安全权限在页面中运行 - 与页面脚本相同。因此，您通常无法从注入的脚本执行跨域请求。

另请参阅[https://stackoverflow.com/a/9614760/163549](https://stackoverflow.com/a/9614760/163549)了解 Opera 中的 CORS 实施状态。

# linux - 如何确定 Linux shell 中当前伪终端的活动监视器？

> ID：11451924
> 
> 赞同：0
> 
> 时间：2012-07-12T12:31:25.557
> 
> 标签：linux, terminal, command-line-interface, xorg, konsole

一切都在标题中，我想知道当前监视器以`KDE Konsole`根据他的位置（左或右）重命名标题。

这样我将`~/.bashrc`通过示例输入或这样：

```
qdbus org.kde.konsole $KONSOLE_DBUS_SESSION org.kde.konsole.Session.setTitle \
    1 "LEFT" 
```

更改`Konsole`.

我看了一下手册页：

*   xdotool
*   xprop

我到处玩`qdbus`，但我只能找到当前桌面

```
qdbus org.kde.kwin /KWin org.kde.KWin.currentDesktop 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T14:49:35.090

学习 libXrandr 和/或`xrandr`命令。

[http://cgit.freedesktop.org/xorg/proto/randrproto/tree/randrproto.txt](http://cgit.freedesktop.org/xorg/proto/randrproto/tree/randrproto.txt)

您会发现您的窗口可以同时完全位于两个监视器内，甚至可以在两个监视器的视图之外。

您需要发现每个输出正在使用哪个 CRTC，然后发现 CRTC 覆盖的帧缓冲区区域。然后您需要发现您的应用程序在帧缓冲区中的哪个位置。

我不确定是否有任何更简单甚至特定于 kde 的方法来执行此操作。

# android - 我的计时器不工作

> ID：11451925
> 
> 赞同：1
> 
> 时间：2012-07-12T12:31:31.047
> 
> 标签：android, image, timer, timertask

我激活了一个有 2 个任务的计时器。

1.  每秒下载 1 张图像，并为 SD 卡上的每张图像显示此内容。
2.  显示在读取 sd 卡上的图像时不依赖于 Internet 连接，并且可以快速滚动我的 96 张图像以获取小视频。

问题是当我以 0.4 秒延迟的计时器激活我的第二个任务时，应用程序会跳过 1 或 2 个图像。实际上只有大约 45 张图像显示。

```
 MyTimerTask2 myTask = new MyTimerTask2();
        myTimer = new Timer();

        myTimer.schedule(myTask, 0 , 400); 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:56:55.870

**使用处理程序**

```
Runnable  runnableforadd ;
                    Handler handlerforadd ;
                    handlerforadd = new Handler();
                    runnableforadd  = new Runnable() {
                        @Override
                        public void run() {
                          //Your Code Here
                            handlerforadd.postDelayed(runnableforadd, 400);                         } 
                    };
                    handlerforadd.postDelayed(runnableforadd, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:47:36.763

您的计时器不起作用，因为您尚未定义`TimerTask`. Timer 需要创建为子类，需要定义，如下所示：

```
 private long splashDelay = 5000;
   @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash);
    TimerTask task = new TimerTask()
        {

        @Override
        public void run() {
        //Your code here

        }

    };

    Timer timer = new Timer();
    timer.schedule(task, splashDelay);

} 
```

这是`Timer`一个启动画面，但我相信你可以将它用于任何你需要的东西。

这里有几个链接可能会有所帮助：

[http://developer.android.com/reference/java/util/TimerTask.html](http://developer.android.com/reference/java/util/TimerTask.html)

[http://android-developers.blogspot.com/2007/11/stitch-in-time.html](http://android-developers.blogspot.com/2007/11/stitch-in-time.html)

如果您查看第一个链接，您会看到它`TimerTask`有一个名为`run`. 抽象方法必须被覆盖。您没有覆盖 run 方法，因此您的应用程序无法按预期工作。

希望这可以帮助。祝你好运！

# javascript - 使按钮 onclick 调用函数而不是表单操作

> ID：11451929
> 
> 赞同：0
> 
> 时间：2012-07-12T12:31:44.813
> 
> 标签：javascript, html

我编写了一个 JavaScript 函数以供我的`button.onclick()`事件调用，但该函数未被调用。相反，我的表单操作被执行。

HTML：

```
<form id = "Documents" action="Uploaded.php">
<input type="submit" id="Remove1" name="Remove[1]" value="Remove first" onclick="return Remove('Remove1');">
<input type="submit" id="Remove2" name="Remove[2]" value="Remove second" onclick=" return Remove('Remove2');">
</form> 
```

更新的 JavaScript：

```
function Remove(currentDoc)
{
if (window.XMLHttpRequest)
      {
  xmlhttp=new XMLHttpRequest();
  }
else
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("Removemsg").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","functions/remove.php?Doc="+currentDoc,true);
xmlhttp.send();

    return false;
} 
```

它调用`uploaded.php`而不是我的`remove.php`. 但我已经定义了我的`onclick`函数来调用`remove.php`. 好心提醒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T12:34:47.423

添加`return false;`声明以`function remove()`防止表单提交。

你也`onclick="Remove()"`应该是`onclick="return Remove();"`

你的JS代码也有错误

```
function Remove(currentDoc)
{
if (window.XMLHttpRequest)
  xmlhttp=new XMLHttpRequest();
else
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("Removemsg").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","functions/remove.php?Doc="+currentDoc,true);
xmlhttp.send();

    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:35:02.610

由于这是一个提交按钮，默认情况下它会将表单提交到 action 属性中的 url。

为了防止它，您需要在函数结束时返回 false：

```
function Remove(currentDoc)
{
if (window.XMLHttpRequest)
  xmlhttp=new XMLHttpRequest();
  }
else
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("Removemsg").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","functions/remove.php?Doc="+currentDoc,true);
xmlhttp.send();

return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:37:13.560

使用`<input type="button" />`而不是`<input type="submit" />`防止表单提交

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T12:39:23.340

除了使用`<input type="submit" ... />`生成按钮，您还可以使用`<button>`标签（[MDN 文档](https://developer.mozilla.org/en/HTML/Element/button)）

```
<button type="button" id="Remove1" name="Remove[1]" onclick="Remove('Remove1')">Remove first</button> 
```

这将生成一个按钮。通过设置`type="button"`您可以防止默认 ( `type="submit"`)，这将触发表单提交。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-12T12:45:13.953

当您单击提交按钮时，它提交表单是很自然的。如果你想防止这种情况发生，你应该在你的事件处理程序中返回 false。请注意，在 remove 函数末尾返回 false 是不够的，您应该编写如下内容：

```
<input type="submit" id="Remove1" name="Remove[1]" value="Remove first" onclick="return Remove('Remove1')"> 
```

并且您的删除函数应该返回 false。另请注意，您的 ajax 编码中存在语义错误。您应该在调用 xmlhttp 对象的 open() 函数后设置 onReadyStateChange。访问[这里](http://www.devx.com/webdev/Article/33024/1954)了解更多信息

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-07-12T12:39:14.830

如果您使用的是 JavaScript，则不需要使用`<form>`.

# visual-studio-2010 - Microsoft Visual Studio 2010 未在编辑器 C# 上显示左大括号

> ID：11451931
> 
> 赞同：0
> 
> 时间：2012-07-12T12:31:52.607
> 
> 标签：visual-studio-2010

我正在使用 Visual Studio 2010 Ultimate 开发 C# 应用程序。我的编辑器没有在函数调用中显示左大括号。例如。

```
var file = new StreamReader**(**fileName); 
```

在这个函数中，它的左大括号虽然在我粘贴它时存在。它之前工作正常。我已经恢复了编辑器设置。我没有在网上找到任何帮助，也没有在互联网上找到视觉工作室的帮助热线。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:42:18.140

有同样的问题，在我的情况下它是一个工作室插件 - 尝试使用安全模式开关启动 VS 并查看错误是否仍然出现......“devenv.exe /SafeMode”

%Program Files(x86)%\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe /SafeMode

# android - 为不同的按钮状态使用一张图片

> ID：11451933
> 
> 赞同：2
> 
> 时间：2012-07-12T12:31:56.917
> 
> 标签：android, xml, android-layout

我想用两种状态创建带有图像的 ImageButton - 正常和按下。状态使用相同的图像，但在按下状态它更轻。是否可以仅使用 XML，没有两个图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T16:12:19.310

我找到了一个我满意的解决方案：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/my_image" android:state_pressed="false"/>
    <item android:drawable="@drawable/my_image_pressed" android:state_pressed="true"/>
</selector> 
```

在按钮背景上，我放置了这个可绘制对象，其中`my_image`来自资源的图像和`my_image_pressed`下一个可绘制对象：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item>
        <bitmap android:src="@drawable/my_image" />
    </item>
    <item>
        <color android:color="#5FEC" />
    </item>
</layer-list> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:37:48.953

但是为什么你不想使用两个不同的图像呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T12:46:39.660

这样做：在名为 selector.xml 的可绘制文件夹中创建 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- When selected, use grey -->
    <item android:drawable="@drawable/lighter_image"
          android:state_pressed="true" />
    <!-- When not selected, use white-->
    <item android:drawable="@drawable/original_image"/>

 </selector> 
```

在 imageButton 上将背景设置为此 xml：

```
android:background="@drawable/selector" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T15:25:53.347

您可以在按下状态时将 ColorFilter 应用于 onDraw 中的 ImageButton 图像。并在未按下时将其清除。

```
filter = new PorterDuffColorFilter(0x7FFFFFFF, PorterDuff.Mode.SRC_ATOP);

@Override
protected void onDraw(Canvas canvas)
{
    super.onDraw(canvas);
    if (isPressed())
    {
        getDrawable().setColorFilter(filter);
    }
    else
    {
        getDrawable().clearColorFilter();
    }
} 
```

# c - [portaudio]传输和检测频率 - Windows

> ID：11451934
> 
> 赞同：0
> 
> 时间：2012-07-12T12:31:57.460
> 
> 标签：c, fft, frequency, portaudio

我是 portaudio 的新手，我查看了“如何提取频率……”的问题，但我仍然希望得到一些帮助。我需要传输一个频率（使用扬声器），然后我想检查这个频率是否被传输（在麦克风中捕捉它），当然我想使用 portaudio 进行发送和检测。另外，我不知道如何使用 fft 进行检测，因为我看到了记录示例，他们使用 SAMPLE 数据类型，并且使用这种数据类型，他们可以找到最大幅度，我可以用它来查找频率吗？

tnx 提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:26:54.370

PortAudio中的[示例代码](http://www.assembla.com/code/portaudio/subversion/nodes/portaudio/trunk/examples/paex_sine.c)给出了播放简单的音调。

虽然那里的音高不是从一个特定的数字计算出来的，但很容易算出来：

```
amplitude[n] = sin( n * desiredFreq * 2 * pi / samplerate ) 
```

就像在 PortAudio 示例代码中一样，您可能需要考虑使用查找表而不是每次调用都依赖 sin() 来提高性能（以及大量 sin 的准确性，这可能很好，但我不确定关于）。

检测播放的频率是 SO 上已提出的问题。[这](https://stackoverflow.com/questions/11431102/quickest-and-easiest-algorithm-for-comparing-the-frequency-content-of-two-sounds/11439204#11439204)是我最近给出的一个答案。

结果是有很多方法取决于你的技能水平，以及背景噪音等问题。如果您只是检测一个简单的 sin wav 并且不希望有很多噪声，那么在确保信号高于某个阈值之后，您最好只计算零交叉。如果你确实期待噪音，你将不得不变得更漂亮。

# jasper-reports - 来自 OLAP Connection 的 JasperServer Adhoc 报告中没有图表选项？

> ID：11451940
> 
> 赞同：0
> 
> 时间：2012-07-12T12:32:27.333
> 
> 标签：jasper-reports, olap, jasperserver, olap-cube

我使用 Jasper OLAP 设计器制作了一个 OLAP 多维数据集。比我在 Jasper Server 中使用该 OLAP 模式建立了一个 OLAP 连接。

我的目标是使用该 OLAP 多维数据集生成报告。基本上是 PDF 格式的预定报告，其中包含表格和图表。

现在，当我选择 Create->Ad Hoc report -> OLAP connection.. 我没有图表选项。唯一的选择是交叉表。从这里我只能得到表格报告。

我不知道出了什么问题.. 我关心的是如何用图表制作这份报告.. 我的问题可能是错的.. 我是 Jasper、OLAP 和所有方面的新手。请给我一些指导。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T21:34:36.027

您可以在 iReport 中创建使用 OLAP 数据源的报表。这些可以包括图表（或 JasperReports 支持的任何其他内容）。

但是在 Ad Hoc 中，当您选择 OLAP 源时，您只能创建交叉表报表。这个限制将在下一个版本中消失......但现在你不能在那里创建图表。

# javascript - 点击一个元素滚动到一个部分在 iPad 上很奇怪

> ID：11451941
> 
> 赞同：0
> 
> 时间：2012-07-12T12:32:28.053
> 
> 标签：javascript, ios, ipad, scroll, click

（网站链接已被作者删除）

情况是页面上有两个 V 形锚 ( `<a>`)。（它们是通过 javascript 添加到 DOM 中的）一个是“上一个”，另一个是“下一个”。通过点击“Next”锚点，该`toNextSection()`功能将被触发，页面将滚动到下一部分，反之亦然。

这适用于所有桌面浏览器，但在 iPad 上很奇怪。

最初，这两个 V 形是与“点击”事件绑定的。然后我尝试将代码更改为以下以解决 iPad 问题，但问题仍然存在。所以我想问题不在于事件类型。

```
var clickEvent = navigator.platform.match(/iPad/i) ? 'touchstart' : 'click';
$('#sectionnav .prev a').on(clickEvent, function() { toPrevSection() });
$('#sectionnav .next a').on(clickEvent, function() { toNextSection() }); 
```

* * *

到目前为止，我收集了一些关于 iPad 问题的信息：

*   第一次点击“下一个”V 形，页面成功滚动到下一个部分。但在那之后，你不能再点击任何一个 V 形。第二次点击它们没有任何作用。

*   `toPrevSection()`我曾尝试用一行替换函数的所有内容： `alert('Test');`，然后点击“上一个”人字形总是可以成功显示警报框。但如前所述，在点击“下一个”字形将页面滚动到下一部分后，点击“上一个”字形将不再显示任何警告框。

*   我试过`setInterval('toNextSection()', 10000);`or `setInterval(function() { $('#sectionnav .next a').trigger('touchstart') }, 10000);`，页面可以成功自动滚动到最后。

*   如果您在点击“下一个”V 形之前手动将页面向前滑动一点，那么点击“下一个”V 形将无法再滚动页面。

新的：

*   我还尝试将单击事件绑定到其他元素，例如页脚中的徽标或图像。问题是一样的。第一次敲击有效，第二次敲击无效。

*   在点击“下一步”V 形（或与单击事件绑定的任何内容）并且页面滚动到下一部分后，页面上的所有超链接和表单按钮都不再起作用（点击它们没有任何作用）。

*   当页面设置为自动滚动时（`setInterval`如上所述），在页面开始自动滚动之前点击“下一步”V 形仍然有效（自动滚动也有效）。但是在页面开始自动滚动后，页面上的所有超链接和表单按钮都不再起作用（点击它们没有任何作用）。

* * *

任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T16:50:37.543

您是否检查过其他元素，因为屏幕正在更改，放置在按钮上方并阻止它们被触摸？
您可以更改按钮 z-index 以将它们放置“更高”，但只有当它们的位置属性是绝对或相对等时才会起作用。

**好的**

试试看这个页面的第 5 点，它是关于 iOS safari 上的触摸事件。 [https://developer.apple.com/library/safari/#technotes/tn2010/tn2262/_index.html](https://developer.apple.com/library/safari/#technotes/tn2010/tn2262/_index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T10:50:27.663

很难调试，因为它实际上只发生在 iOS 设备（和模拟器）上。我几乎可以肯定**这与您的 JavaScript 无关，而仅与页面滚动和元素定位**以及它在 iOS 上的处理方式有关。这甚至可能是 iOS Safari 中的一个错误（见下文）。

似乎大多数链接（`next`、`previous`、`Twitter`等`Facebook`）仅在您的页面处于其原始位置时才有效（您提到了这一点）。例如，您可以单击`next`，然后滚动回到开头并`next`再次单击。因此，按钮似乎按应有的方式显示，但可点击区域位于可见区域之外的原始位置。

另一个观察结果：正如您所说，您单击后没有任何链接有效`next`。但是，当您在向右滚动后重新加载页面时，`next`仍然`previous`没有效果（页面会自动滚动到之前的位置），但所有其他链接都可以工作。

**我发现[了另一个](https://stackoverflow.com/questions/8752220/mobile-safari-bug-on-fixed-positioned-button-after-scrolltop-programmatically-ch)提到这一点**的问题，提供了一个[简单的示例页面](http://www.tsdexter.com/MobileSafariFixedPosBug.html)，该页面仍然在 iOS 5.1 模拟器中显示了这种奇怪的行为。建议的**[解决方案（现在有 16 个赞成票）](https://stackoverflow.com/a/9808770/95033)**是设置`position:relative`、滚动，然后`position:fixed`再次设置（顺便说一句，仅[iOS5 支持](http://davidbcalhoun.com/2011/new-mobile-safari-stuff-in-ios5-position-fixed-overflow-scroll-new-input-type-support-web-workers-ecmascript-5)，但我想这就是你正在使用的）。与该示例相反，我无法在您页面的某处找到可点击区域。

除了尝试该解决方法之外，我还建议您采取以下措施来解决这个问题：

*   尝试降低你的风格，直到定位有效，你有`position:absolute`很多`position:fixed`元素。

*   取消链接`scroll`事件处理程序，除了可能导致您的问题之外，这确实会妨碍使用该站点。充其量，您将内容定位和垂直滚动完全分开。我不确定这对视差效果意味着什么。

希望这有助于解决此问题并祝您好运。

**编辑**：报告[了一个错误](http://www.openradar.me/11207363)（状态`duplicate`- 我没有找到原件）。此外，[另一个答案中描述的修复](https://stackoverflow.com/a/10030251/95033)对我有用。

# android - 为什么我的关闭活动动画在 Android 4.0 (ICS) 上不起作用

> ID：11451943
> 
> 赞同：4
> 
> 时间：2012-07-12T12:32:42.217
> 
> 标签：android, animation, themes, android-4.0-ice-cream-sandwich

我用自定义动画制作了一个主题（向上滑动和向下滑动）。该动画在较旧的 android 版本上运行良好。但是，当我在 Android 4.0 (ICS) 上试用它时，关闭动画不起作用。只有上滑动画在 ICS 上运行良好。

这是我用于动画的主题：

```
<style name="myTheme" parent="android:Theme.Black">
    <item name="android:windowTitleSize">45dip</item>
    <item name="android:windowTitleBackgroundStyle">@style/CustomWindowTitleBackground</item>
    <item name="android:windowAnimationStyle">@style/myTheme.Window</item>
</style>

<style name="myTheme.Window" parent="@android:style/Animation.Activity">
    <item name="android:activityOpenEnterAnimation">@anim/push_up_in_no_alpha</item>
    <item name="android:activityOpenExitAnimation">@anim/no_anim</item>
    <item name="android:activityCloseEnterAnimation">@anim/no_anim</item>
    <item name="android:activityCloseExitAnimation">@anim/push_down_out_no_alpha</item>
</style> 
```

这是**push_down_out_no_alpha.xml**：

```
<set xmlns:android="http://schemas.android.com/apk/res/android">
        <translate android:fromYDelta="0" android:toYDelta="100%p"
        android:duration="@android:integer/config_longAnimTime"/>
</set> 
```

当我在代码中设置动画时，它在 ICS 上也可以正常工作，但为什么不作为主题呢？

```
 this.overridePendingTransition(R.anim.no_anim,R.anim.push_down_out_no_alpha); 
```

有谁知道为什么它不能在 Android 4.0 (ICS) 上运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T23:20:29.050

从清单中指定动画似乎在 ICS 中被破坏了 :-( 覆盖动画解决方案工作正常，但您可能不想对动画进行硬编码。最好从清单中获取它们，就像其他平台的版本..所以....

向您的活动添加几个成员字段以保存附加到您的活动的动画的 ID。

```
protected int activityCloseEnterAnimation;
protected int activityCloseExitAnimation; 
```

在你的 onCreate 的某个地方...

```
// Retrieve the animations set in the theme applied to this activity in the
// manifest..
TypedArray activityStyle = getTheme().obtainStyledAttributes(new int[] {android.R.attr.windowAnimationStyle});
int windowAnimationStyleResId = activityStyle.getResourceId(0, 0);      
activityStyle.recycle();

// Now retrieve the resource ids of the actual animations used in the animation style pointed to by 
// the window animation resource id.
activityStyle = getTheme().obtainStyledAttributes(windowAnimationStyleResId, new int[] {android.R.attr.activityCloseEnterAnimation, android.R.attr.activityCloseExitAnimation});
activityCloseEnterAnimation = activityStyle.getResourceId(0, 0);
activityCloseExitAnimation = activityStyle.getResourceId(1, 0);
activityStyle.recycle(); 
```

那么无论您的活动完成/应该应用动画，包括...

```
overridePendingTransition(activityCloseEnterAnimation, activityCloseExitAnimation); 
```

并且您的活动应该正确地尊重您在清单中附加到活动的主题/样式中设置的动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T07:13:20.807

我也尝试过，但它在这里不起作用。不知道是什么问题，但`this.overridePendingTransition(R.anim.no_anim,R.anim.push_down_out_no_alpha);`这段代码工作正常

# java - 从 Java Web 应用程序将条形码图像/数据发送到客户端的条形码写入器

> ID：11451946
> 
> 赞同：0
> 
> 时间：2012-07-12T12:32:45.573
> 
> 标签：java, web-applications, printing, barcode

[我需要将烧烤](http://barbecue.sourceforge.net/)生成的条形码图像（或字符串数​​据）发送到客户的条形码写入器（型号：Argox OS-214+）。我想我可以使用 javascript 或外部小程序，但我不知道如何制作它。有没有人建议一种特别适用于这种型号条形码写入器的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:34:00.070

好吧。

[如何在打印机中打印图像文件完全](https://stackoverflow.com/questions/2742144/how-to-print-a-image-file-in-printer)解决了我的问题，我已经从 javascript 将数据作为图像发送并配置打印机设置以获取其他详细信息。

谢谢大家！

# oop - 如何创建调用非全局类的静态方法的事务？

> ID：11451948
> 
> 赞同：4
> 
> 时间：2012-07-12T12:32:52.547
> 
> 标签：oop, abap

`ZCL_GRID_EVT_HANDLER`我的 ABAP/4 程序中有 1 个类，它有一个`MAIN`我想从事务开始的方法。

我尝试右键单击程序>创建>事务-然后选择“类方法（oo事务）”-然后取消选中复选框“OO事务模型”

-选择我的程序，选择类名和方法名，我得到的消息是“类 ZCL_GID_EVT_HANDLER 不存在”。（但该程序已激活）

帮助！请告诉我我做错了什么，或者我是否完全偏离了轨道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:48:30.660

将事务链接到包含本地类的程序并调用该`MAIN`程序内部的方法（在`START-OF-SELECTION`事件中）。

# javascript - 在等待 Excel 下载时显示加载图像

> ID：11451956
> 
> 赞同：2
> 
> 时间：2012-07-12T12:33:12.097
> 
> 标签：javascript, performance, loading

我有一个jsp，我们有一些报告的链接。当用户点击链接时，他会在 excel 文件中下载一份报告。excel文件是动态生成的，所以我的文件metrics.jsp带有一组链接，链接指向生成excel的report.jsp。这里的问题是，有时下载报告需要一段时间，我们想向用户显示文件正在下载，您需要等待。我该怎么做。

# oracle - 仅存在小数部分时，Oracle TO_NUMBER 转换失败

> ID：11451965
> 
> 赞同：2
> 
> 时间：2012-07-12T12:33:42.920
> 
> 标签：oracle, oracle10g, type-conversion

我有`VARCHAR2`一个数字，写为小数点和小数部分，例如`.02`。使用时

```
TO_NUMBER(NUMBER_COLUMN) 
```

我收到一个错误

> ORA-01722: 无效号码

表示格式不被识别。是否有内置的解决方法（我可以`DECODE`或`SUBSTR`提供所需的零？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T12:52:31.190

您遇到此错误不是因为您的 varchar 列中存在 radixpoint + 小数部分，而是因为您的 varchar 列包含一个非数字字符，当 to_number 运行时无法转换为数字。

我可以通过[这个 SQL fiddle来证明这一点](http://sqlfiddle.com/#!4/afefe/7)

也[可能是您的 NLS 参数](http://docs.oracle.com/cd/B28359_01/server.111/b28298/ch3globenv.htm#i1007705)与 Oracle 期望的小数分隔符不同，因此引发此错误。

您可以通过更改[`NLS_NUMERIC_CHARACTERS`](http://docs.oracle.com/cd/B19306_01/server.102/b14237/initparams129.htm)参数来更改 Oracle 期望作为小数运算符的字符。

```
ALTER SESSION SET NLS_NUMERIC_CHARACTERS = ".," 
```

将告诉 Oracle 期望 a`.`作为小数点和`,`千位分隔符

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-12T12:48:16.573

我没有要尝试的 Oracle 实例，但也许使用完整版本的 TO_NUMBER 会对您有所帮助：TO_NUMBER(column, '9999999999D99') 或 TO_NUMBER(column, 'B9999999999D99')

在此处阅读更多信息[http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements004.htm](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements004.htm)

此外，如果您需要使用不同的小数分隔符，则可以将第三个参数指定为 TO_NUMBER。例如，TO_NUMBER('$94 567,00', 'L999G999D00', NLS_NUMERIC_CHARACTERS ', ')。

# c# - 在 Windows 8 Metro App 中将联系人添加到用户联系人列表

> ID：11451966
> 
> 赞同：5
> 
> 时间：2012-07-12T12:33:50.800
> 
> 标签：c#, windows-8, contacts, microsoft-metro

我正在使用 c# 创建一个 Windows 8 Metro 应用程序

在应用程序中，您可以搜索电话簿中的人员。是否有可能将找到的联系人添加到用户联系人列表中？

我知道您可以使用 Windows.ApplicationModel.Contacts.Provider 浏览联系人，但我看不到您如何添加联系人。

感谢帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-12T18:06:45.983

[您可以通过Contact Picker Contract](http://msdn.microsoft.com/en-US/library/windows/apps/hh464906)做到这一点。使用[ContactPickerUI.AddContact](http://msdn.microsoft.com/en-US/library/windows/apps/windows.applicationmodel.contacts.provider.contactpickerui.addcontact)。这将打开一个用户界面，用户可以使用它来添加您提供给它的联系人。如果不调出联系人选取器 UI，则无法添加联系人。[联系人示例](http://code.msdn.microsoft.com/windowsapps/Contact-Picker-App-sample-fc6677a1)提供了添加联系人的示例。

# php - Symfony 2.1 功能测试中的身份验证

> ID：11451969
> 
> 赞同：19
> 
> 时间：2012-07-12T12:34:06.227
> 
> 标签：php, symfony, symfony-2.1

我目前正在将一个 2.0.* 项目迁移到 Symfony 当前的 2.1 beta 版本。

在我的功能测试中，我目前有此代码来创建具有身份验证的客户端：

```
$client = // create a normal test client
$role = 'ROLE_USER';
$firewallName = 'main';
$user = // pull a user from db

$client->getCookieJar()->set(new \Symfony\Component\BrowserKit\Cookie(session_name(), true));

$token = new UsernamePasswordToken($user, null, $firewallName, array($role));

self::$kernel->getContainer()->get('session')->set('_security_' . $firewallName, 
serialize($token)); 
```

这在 2.0.* 中按预期工作，但在 2.1 中没有，数据未在会话中设置。

有任何想法吗？

**编辑（添加更多信息）：**

似乎问题出在方法“ **onKernelResponse ”中的文件“** **Symfony\Component\Security\Http\Firewall\ContextListener** ”中。有这个代码：

 **```
if ((null === $token = $this->context->getToken()) || ($token instanceof AnonymousToken)) {
    $session->remove('_security_'.$this->contextKey);
} else {
    $session->set('_security_'.$this->contextKey, serialize($token));
} 
```

在我的情况下，如果“$token instanceof AnonymousToken”为真，因此会话密钥被删除。如果我注释掉该代码，一切都会按预期工作。

所以我想我的新问题是：我该怎么做才能使令牌不匿名？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T09:22:06.967

验证用户的正确方法是：

```
$firewallName = 'your-firewall-name';
$container = self::$kernel->getContainer()
$token = new UsernamePasswordToken($user, null, $firewallName, $user->getRoles());
$container->get('security.context')->setToken($token); 
```

和防火墙身份验证：

```
$session = $container->get('session');
$session->set('_security_'.$firewallName, serialize($token));
$session->save(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T11:52:39.083

我已经登录了一张票：[https ://github.com/symfony/symfony/issues/3287](https://github.com/symfony/symfony/issues/3287)

Symfony 2.1 RC 似乎存在一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T19:43:46.197

i had the same issue and found a solution while debugging. Depending on your Session Storage, you might have to change your cookie from session_name() to 'MOCKSESSID' (which is used if your using the mock session. I think if you have the following in your config_test.yml it is automatically changed to Mock Session Storage:

```
framework:
   test: ~ 
```

For completeness, here my full code (i'm using FOS/UserBundle)

```
 protected function createAuthorizedClient($username = 'user') {
      $client = $this->createClient(); //Normal WebTestCase client     
      $userProvider = $this->get('fos_user.user_manager');
      $user = $userProvider->loadUserByUsername($username);
      //$client->getCookieJar()->set(new Cookie(session_name(), true));
      $client->getCookieJar()->set(new Cookie('MOCKSESSID', true));
      $session = self::$kernel->getContainer()->get('session');
      $token = new UsernamePasswordToken($user, null, 'main', $user->getRoles());
      $client->getContainer()->get('security.context')->setToken($token);
      $session->set('_security_main', serialize($token));

    return $client;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-11T21:13:10.067

在我的测试套件中（在 2.0 和现在 2.1 上工作）我使用扩展 Symfony2 WebTestCase 类的 Base 类 WebTestCase。

我有这两个函数在我的测试中创建一个匿名客户端或一个记录的客户端：

```
static protected function createClient(array $options = array(), array $server = array())
{
    $client = parent::createClient($options, $server);

    self::$container = self::$kernel->getContainer();

    return $client;
}

protected function createAuthClient($user, $pass)
{
    return self::createClient(array(), array(
        'PHP_AUTH_USER' => $user,
        'PHP_AUTH_PW'   => $pass,
    ));
} 
```

然后，在我的测试课程中，我使用：

```
 $client = static::createClient(); 
```

创建一个匿名客户和

```
 $client = static::createAuthClient('user','pass'); 
```

创建一个经过身份验证的。

这在 2.1 上就像一个魅力

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-19T11:59:47.487

我可以建议另一种解决方案（因此它对我有用）。我有一个自定义身份验证提供程序，逻辑复杂，我根本无法使用 http_basic 机制。

你需要像这样创建特殊的动作

```
 //TestAuthController.php
 public function authTestAction(Request $request)
 { 
   // you can add different security checks as you wish
   $user_id = $request->query->get("id");
   // find user  by $user_id using service or user provider service from firewall config
   $token = new UsernamePasswordToken($user, null, $firewallName, array($role));
    // or another authenticated token
   $this->container->get('security.context')->setToken($token);
 } 
```

添加 routing_test.yml 并将其作为 routing_dev.yml 插入

重要的是，出于安全原因，此身份验证路由必须仅存在于测试环境中。

```
 //app/config/routing_test.yml
 // ... the same routes as in routing_dev.yml
_testauth:
    pattern:  /__test
    defaults: { _controller: MyBundle:TestAuth:authTest } 
```

然后在测试中将客户端发送到这个 url

```
public function testSomething()
{
    $client = static::createClient();
    $client->request('GET','/__test',array('id'=>146));
    $this->assertTrue($client->getContainer()->get('security.context')->isGranted('ROLE_USER')) //it will pass;
} 
```**

# java - NotesContext 未为线程初始化

> ID：11451970
> 
> 赞同：0
> 
> 时间：2012-07-12T12:34:08.283
> 
> 标签：java, xpages

我们有一个自定义控件，它在 java bean 中调用函数。这个 java bean 使用我们之前创建的代码，它以 ctgclient.jar 作为其依赖项。

此 bean 和自定义控件有效，但有时我们会在控制台上看到以下错误：

> HTTP JVM：java.lang.IllegalStateException：NotesContext 未为线程初始化。

我的想法是这是由使用不可序列化对象的 java 库引起的。我对么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T13:23:16.710

没有代码，这是任何人的猜测。当你创建一个 bean 时，你应该：

*   使其可序列化
*   不创建新的笔记线程 (initThread) 或会话
*   要么将会话作为调用参数传递
*   。或者。使用变量解析器
*   如果您想使用线程，请使用 OpenNTF[线程和作业](http://www.openntf.org/p/Threads%20and%20Jobs)项目作为起点
*   不要在会话、视图、文档等内部保留任何 NotesObject

到目前为止我的猜测。

# android - 从 appwidgetprovider 打开单个活动而不使用单实例或单任务

> ID：11451972
> 
> 赞同：2
> 
> 时间：2012-07-12T12:34:13.187
> 
> 标签：android, android-layout, android-widget

我正在编写一个应用程序，其中有几个活动，例如活动 A->B->C->D。除此之外，我们还可以从应用小部件启动活动。

应用要求：

*   `Activity C`可以从一个启动，`AppWidgetProvider`并且当按下返回或主页时应该显示主屏幕。
*   应用程序应从应用程序启动`Activity A`时开始（例如，如果用户在打开时按下主页按钮`Activity D`，则重新启动应用程序应从 开始`Activity A`。）

当前的方法如下：

/模式用于清除活动堆栈以满足需求`singleInstance`。`singleTask`但是，`onActivityResult()`、`android:activityOpenEnterAnimation`、`android:activityOpenExitAnimation`、`android:activityCloseEnterAnimation`等`android:activityCloseExitAnimation,`在使用这些模式时不起作用。

有没有其他方法可以达到要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:06:36.467

我认为 Android 开发者网站上的[Activity Lifecycle 教程](http://developer.android.com/training/basics/activity-lifecycle/index.html)将是一个很好的起点。它包括一个[完整的例子](http://developer.android.com/shareables/training/ActivityLifecycle.zip)，说明如何处理生命周期

# rubymotion - 如何在 RubyMotion 中使图像移动/动画？

> ID：11451983
> 
> 赞同：0
> 
> 时间：2012-07-12T12:34:57.523
> 
> 标签：rubymotion

有一些利用 animateWithDuration 的示例 - 是否有任何简单示例说明如何使用此函数将图像从 A 点移动到 B 点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T11:04:50.080

快速而肮脏只是为了显示它在使用中

```
class AppDelegate
  def application(application, didFinishLaunchingWithOptions:launchOptions)
    @window = UIWindow.alloc.initWithFrame UIScreen.mainScreen.bounds
    @window.makeKeyAndVisible

    my_view = UIView.alloc.initWithFrame [[0, 0], [50, 50]]
    my_view.backgroundColor = UIColor.greenColor
    @window.addSubview my_view

    UIView.animateWithDuration(0.25, animations: lambda {
      new_frame = my_view.frame
      new_frame.origin = [100, 100]
      my_view.frame = new_frame
    })
    true
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T06:21:22.423

The following code can be used for animating objects.

```
 my_view = UIView.alloc.initWithFrame [[0, 0], [50, 50]]
            my_view.backgroundColor = UIColor.greenColor
            view.addSubview my_view

            my_view.frame = [[0,0],[0,0]] #the position from which animation begins
            UIView.beginAnimations(nil,context:nil)
            UIView.setAnimationDuration(0.05)
            UIView.setAnimationDelay(0.2)
            UIView.setAnimationCurve(UIViewAnimationCurveEaseOut)
            my_view.frame = [[250,400],[50,50]]  # the position at which the animation ends
            my_view.backgroundColor = UIColor.blueColor #you can also change other properties while animating
            UIView.commitAnimations 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:49:50.180

使用[方糖](https://github.com/rubymotion/sugarcube)！

```
frame = my_view.frame
frame.origin = point_a
my_view.frame = frame

# animating the move to point_b is EASY
my_view.move_to point_b 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T11:21:41.677

您可能还想看看[沃尔特](https://github.com/clayallsopp/Walt)。

```
 {
    move: "my_id",
    from: [10, 10],
    to: [50, 50]
  } 
```

# php - PHP imap 和带空格的文件夹名称

> ID：11451986
> 
> 赞同：3
> 
> 时间：2012-07-12T12:35:04.310
> 
> 标签：php, imap

如何处理包含空格的文件夹名称？

在每个需要文件夹名称的函数中，我都使用这样的字符串：

```
{server.address.com:port}"INBOX.abc def" 
```

但它会导致 php 崩溃：

```
Can't subscribe to mailbox "INBOX.abc def": no such mailbox 
```

将字符串更改为如下所示：

```
{server.address.com:port}INBOX."abc def" 
```

没有改变任何东西，仍然错误。我如何打开/检查/任何名称中有空格的文件夹？

**编辑：** 问题更新了更好的错误消息

我尝试过的文件夹字符串的组合：

*   “INBOX.abc def” - 失败，
*   INBOX."abc def" - 失败，
*   \INBOX\abc def - 失败，
*   "\INBOX\abc def" - 失败

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T07:46:32.093

解决了！

根据 RFC3501，邮箱命名 (5.1)：

> 任何属于 atom-specials 之一的字符（请参阅正式语法）都需要将邮箱名称表示为带引号的字符串或文字。

这包括空间：

> atom-specials = "(" / ")" / "{" / SP / CTL / list-wildcards / quoted-specials / resp-specials

所以，正确的文件夹字符串应该是：

> {server}"INBOX. 带空格的文件夹"

但就我而言，正确的字符串是.....

> {server}INBOX. 带空格的文件夹

不知道为什么，似乎 PHP 的 imap 函数与 RFC 不完全兼容。或者只是我无法阅读和理解 rfc。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T12:46:28.100

当你引用目录时，你可以试试这个sintax：“\INBOX\folder with spaces”

所以这个解决方案获得了“在我的机器上工作”证书。你得到什么错误代码？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T09:22:50.030

"\INBOX\abc def" 这更好，但可能你的收件箱放错了地方！
我认为它必须在“htdocs”中！
而且您只能访问文件，不能访问文件夹！
比如：“\INBOX\abc def\file.txt”

# xslt - XSL 计数连续节点

> ID：11451989
> 
> 赞同：2
> 
> 时间：2012-07-12T12:35:09.050
> 
> 标签：xslt

我有xml之类的

```
<tr>
 <td class="x">1</td>
 <td class="x">2</td>
 <td>3</td>
 <td class="x">4</td>
 <td class="x">5</td>
 <td class="x">6</td>
 <td class="x">7</td>
</tr> 
```

我希望使用 xsl 的结果是：

```
\cont{1-2}
\cont{4-7} 
```

我可以这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T02:11:52.803

**这种转换既短（25 行）又高效（使用键）：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:key name="kFollowing" match="td[@class='x']"
  use="concat(generate-id(..),
              '+',generate-id(preceding-sibling::*
                                 [not(self::td and @class='x')][1])
              )"/>  

 <xsl:template match="/*">
  <xsl:variable name="vGroup" 
       select="key('kFollowing', concat(generate-id(),'+'))"/>
  <xsl:value-of select=
     "concat('\cont{{',$vGroup[1],'-',$vGroup[last()],'}}','&#xA;')"/>
  <xsl:apply-templates/>
 </xsl:template>

 <xsl:template match="*/*">
  <xsl:variable name="vGroup" select=
   "key('kFollowing', concat(generate-id(..),'+', generate-id()))"/>
  <xsl:value-of select=
     "concat('\cont{{',$vGroup[1],'-',$vGroup[last()],'}}','&#xA;')"/>
 </xsl:template>

 <xsl:template match="td[@class='x']|text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<tr>
    <td class="x">1</td>
    <td class="x">2</td>
    <td>3</td>
    <td class="x">4</td>
    <td class="x">5</td>
    <td class="x">6</td>
    <td class="x">7</td>
</tr> 
```

**产生了想要的正确结果：**

```
 \cont{1-2}
  \cont{4-7} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T14:32:37.743

有很好的方法，也有讨厌的方法。我没有足够的时间想一个好的方法，这如何抓住你？：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ext="http://exslt.org/common">
<xsl:output method="text" indent="no"/>

<xsl:template match="/tr">
    <xsl:for-each select="td[@class='x']">
        <xsl:variable name="currentNum" select="number(text())"/>
        <xsl:variable name="prevNum" select="number(preceding-sibling::td[@class='x'][1]/text())"/>
        <xsl:if test="($currentNum - 1) != $prevNum and $currentNum &gt; 0 and following-sibling::td[@class='x']">
            <xsl:variable name="following" select="following-sibling::td[@class='x']"/>
            <xsl:if test="number($following[1]/text()) = ($currentNum + 1)">
            \cont{<xsl:value-of select="$currentNum"/>-<xsl:call-template name="findend">
                    <xsl:with-param name="start" select="$currentNum"/>
                <xsl:with-param name="nodes" select="$following"/>
                </xsl:call-template>}
            </xsl:if>
         </xsl:if>
    </xsl:for-each>    
</xsl:template>

<xsl:template name="findend">
    <xsl:param name="nodes"/>
    <xsl:param name="start"/>
    <xsl:variable name="current" select="number($nodes[1]/text())"/>
    <xsl:choose>
        <xsl:when test="count($nodes) &lt; 2">
            <xsl:value-of select="$current"/>
        </xsl:when>
        <xsl:when test="number($nodes[2]/text()) != ($current + 1)">
            <xsl:value-of select="$current"/>
        </xsl:when>
        <xsl:otherwise>
            <xsl:call-template name="findend">
                <xsl:with-param name="nodes" select="$nodes[position() &gt; 1]"/>
                <xsl:with-param name="start" select="$current"/>
            </xsl:call-template>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template>

</xsl:stylesheet> 
```

输出是

```
\cont{1-2}
\cont{4-7} 
```

我做了一个假设，如果你只有一个数字，你不想继续，所以你不会得到 \cont{1-1}，而且它们必须按顺序排列，并且它们必须在 class= 'X'。

多花点时间，你可以想出更漂亮的东西！

不过，作为解释，它会通过寻找一个 td[@class='x'] 的数字不等于前一个 + 1 （即，没有数字或它不连续）。如果找到一个，它会检查下一个数字是这个数字 + 1，以避免出现 cont{1-1} 的情况，然后它调用一个递归模板来查找并打印结尾

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T16:12:27.510

这是一些使用键和模式的 XSLT 1.0 方法（但主要是为了避免复杂的模板匹配模式）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="text"/>

<xsl:key name="k1" 
  match="td[@class = 'x'][preceding-sibling::*[1][self::td[@class = 'x']]]"
  use="generate-id(
         preceding-sibling::td[
           @class = 'x' and 
           not(preceding-sibling::*[1][self::td[@class = 'x']])
         ][1]
       )"/>

<xsl:template match="tr">
  <xsl:apply-templates select="td[@class = 'x' and not(preceding-sibling::*[1][self::td[@class = 'x']])]" mode="start"/>
</xsl:template>

<xsl:template match="td[@class = 'x']" mode="start">
  <xsl:text>\cont{</xsl:text>
  <xsl:value-of select="."/>
  <xsl:text>-</xsl:text>
  <xsl:apply-templates select="key('k1', generate-id())[last()]" mode="end"/>
</xsl:template>

<xsl:template match="td[@class = 'x']" mode="end">
  <xsl:value-of select="."/>
  <xsl:text>}&#10;</xsl:text>
</xsl:template>

</xsl:stylesheet> 
```

该样式表，当应用于

```
<tr>
 <td class="x">1</td>
 <td class="x">2</td>
 <td>3</td>
 <td class="x">4</td>
 <td class="x">5</td>
 <td class="x">6</td>
 <td class="x">7</td>
</tr> 
```

输出

```
\cont{1-2}
\cont{4-7} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-12T20:47:05.143

我能想出的最简单的样式表可以解决您的问题：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="td[not(preceding-sibling::*[1][self::td][@class='x'])]">
        <xsl:text>\cont{</xsl:text>
        <xsl:value-of select="."/>
        <xsl:text>-</xsl:text>
        <xsl:value-of select="following-sibling::td[
                not(following-sibling::*[1][self::td][@class='x'])][1]"/>
        <xsl:text>}&#10;</xsl:text>
    </xsl:template>
  <xsl:template match="td"/>
</xsl:stylesheet> 
```

**解释**: 首先，我们匹配`td`其前一个兄弟本身不是 a 的每个`td`具有`class`等于 的属性`x`。这些是开始节点，所以我们使用它们的值作为每个序列的开始。

对于序列的结尾，我们使用下一个`td`不具有的下一个作为其紧随其后的兄弟`td`，另一个`class`是`x`。

所有其他节点都被忽略。

# php - 如何在页面可视区域的中间放置一个带有半透明背景的js对话框？

> ID：11451992
> 
> 赞同：0
> 
> 时间：2012-07-12T12:35:13.637
> 
> 标签：php, javascript, ajax

由于表格项目的增加，页面变得更长，如果我单击按钮打开对话框，它会显示在页面顶部，我必须滚动回顶部才能查看它。我希望它出现在我在页面上的任何位置的视口中间。

我正在向 php 页面发出 ajax 请求，以构建 html 标记，然后将 responseText 附加到 div 元素。

背景的CSS代码以及将覆盖它的对话框如下：

```
<script type='text/javascript'>
 div.Background {
background: #FFF;
position:absolute;
top:0px;
left:0px;
width:100%;
height:100%;
filter:alpha(opacity=28); 
-moz-opacity: 0.8; 
opacity: 0.8;
z-index:999;
 }
   div.Box {
border:1px solid #bbb;  
background:white;
position:absolute;
left:50%;
top:50%;
margin-left:-280px;
margin-top:-195px;
width:500px;
height:420px;
z-index:1000;
 -moz-box-shadow: 1px 3px 3px #ccc;
  -webkit-box-shadow: 1px 3px 3px #ccc;
  box-shadow: 1px 3px 3px #ccc;
 }

 </script> 
```

另请注意，我已将背景位置更改为相对保持框的绝对位置无济于事，并且我不想使用任何 jquery 或类似的东西。所以请我要求不要提出这些解决方案。只是让你们知道..请回复，提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T13:27:39.483

我注意到的第一件事是您的 CSS 规则包含在脚本标记中，这是不正确的。它们应该在样式标签内，即：

```
<style type="text/css">
    /*CSS rules here */
</style> 
```

现在问你的问题：不要给元素`position:absolute`，而是把它改成`position:fixed`. 这使您可以**相对于窗口**定位框，即使您上下滚动页面的其余部分，它也会保持在相同的位置。[请参阅jsfiddle](http://jsfiddle.net/yGmyM/1/)上的一个简单示例。

需要注意的一件事是 IE6 无法识别`position:fixed`，但您可能并不关心这一点。

# tsql - T-SQL 从 VARCHAR 中获取字节而不转换为 UNICODE

> ID：11451999
> 
> 赞同：8
> 
> 时间：2012-07-12T12:35:43.990
> 
> 标签：tsql

我们将密码哈希存储在数据库中。基本上我们得到 MD5 哈希（字节数组），然后在字节数组上运行 Encoding.Unicode.GetChars 并将生成的字符串存储在数据库中。然后当有人登录时，我们以相同的方式散列他们的密码并比较两个字符串。

这很好用，除了我无法在 T-SQL 中提取密码哈希并将其插入另一行。我可以让它工作的唯一方法是，如果我实际上直接从选择的具有有效哈希的另一行中设置密码哈希。

我试图将字符串转换为十六进制并让 SQL 转换它，但这也不起作用。我认为这是因为我们编码为 UNICODE 的字节可能不构成有效的 UNICODE 字符串。

例如（[SQL Server：将字符串转换为十六进制字符串并返回](http://timscyclingblog.wordpress.com/2012/01/12/sql-server-convert-a-string-into-a-hex-string-and-back-sql-sqlserver/)）：

当您运行以下命令时，“Help”这个词会被转换为 var binary，然后再转换为字符串，嘿嘿！你最终再次得到“帮助”。

```
SELECT CONVERT(VARCHAR(MAX), CONVERT(VARBINARY(MAX), 'Help')) 
```

问题是当我在密码哈希列上运行它时，结果值与存储在列中的值不同。如果我将包含哈希的字符串粘贴到两个 ' 符号之间的 SQL Management Studio 中，它会跳过 ' 并放入一些其他字符。同样，很可能试图解释一个不完整的 UNICODE 序列，因为它不是一个正确的 UNICODE 字符串。

所以我正在寻找一种方法来简单地获取包含密码哈希的 VARCHAR(64) 中的字节并将其写入编码文本格式，例如：

```
0x0F037584C99E7FD4F4F8C59550F8F507 
```

这样我就可以做类似的事情

```
UPDATE   [User]
SET      PasswordHash = CONVERT(NVARCHAR(64), 0x0F037584C99E7FD4F4F8C59550F8F507)
WHERE    UserID = 123 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:40:42.007

呃！找到了。当我重读我的帖子时，我意识到在我的示例中我使用的是转换为 VARCHAR，而不是 NVARCHAR。一旦我将它更改为 NVARCHAR ，它就开始工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-10T09:55:24.087

您可以使用

```
 select CONVERT(VARCHAR(MAX), CONVERT(VARBINARY(MAX),FileBytes)) 

   FileBytes=0x3C3F786D6C207665 
```