# StackOverflow 问答 10789000-10789999

# ajax - IE 9 不接受压缩的 AJAX 数据

> ID：10789000
> 
> 赞同：1
> 
> 时间：2012-05-28T18:30:23.263
> 
> 标签：ajax, http-headers, internet-explorer-9, http-compression, content-negotiation

我有一个返回网页数据的 node.js JSONP 服务器。该页面向 Node 服务器发出 AJAX 请求，并返回 JSONP 代码。

这在所有浏览器中都可以正常工作，直到我启用压缩。如果我以 deflate 或 gzip 压缩返回 AJAX 响应，它适用于除 IE 9 之外的所有人；这不会解码文件。IE 只显示返回的空白正文，没有错误，控制台上没有输出。

我已确保请求通过并将正确的数据返回给 IE 客户端，IE 只是不会接受它。以下是发送给所有客户端的响应标头：

```
 Access-Control-Allow-Origin:*
 Connection:keep-alive
 Content-Encoding:deflate
 Content-Length:31203
 Content-Type:application/javascript; charset=UTF-8
 X-Content-Type-Options:nosniff 
```

我应该添加 - 这些标头出现在其他浏览器中，但 IE 没有显示“Content-Encoding: 标头。我认为这可能是正常的，因为我注意到启用压缩并在 IE 中工作的网站存在相同的行为。IBM .com 例如 - Chrome 显示内容编码，IE 没有。

那么IE不支持压缩而其他服务器正在检测它吗？有谁知道为什么 IE 拒绝这些数据？

干杯，

白原子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T03:25:21.780

[Apache](http://newestindustry.org/2007/06/06/dear-apache-software-foundation-fix-the-msie-ssl-keepalive-settings/)可能被设置为嗅探 IE 并使用 HTTP 1.0 而不是 HTTP 1.1。如果站点使用 HTTPS，[IIS](http://support.microsoft.com/kb/187504)将不允许压缩。一个[相关的问题](https://stackoverflow.com/questions/11010153/ie-receiving-http-1-0-response-for-some-files)也可能有所帮助。

# map - go中map的类型转换

> ID：10789001
> 
> 赞同：2
> 
> 时间：2012-05-28T18:30:25.100
> 
> 标签：map, type-conversion, go

给定一个 typedef：“type ID int”

是否可以将 map[ID]int 转换为 map[int]int？

我试过了：

```
map[int]int(m) 
```

也

```
m.(map[int]int) 
```

似乎都不起作用： [http ://play.golang.org/p/oPzkUcgyaR](http://play.golang.org/p/oPzkUcgyaR)

有什么建议吗？

* * *

编辑更多细节，因为有几个人问过。

我想做的是获得联赛冠军。

有一堆“团队”，每个团队都有许多统计数据。对于每个统计数据，最高得分为 10 分，第二为 9 分，以此类推。

我将其建模为：

```
// Each team's statistics:
type StatLine map[StatID]float64

// The whole league:
map[TeamID]StatLine

// And I want to score that whole league with:
func score(s map[TeamID]StatLine) map[TeamID]int

// Only, is't also handy to score individual players:
func score(s map[PlayerID]StatLine) map[PlayerID]int 
```

最好不要写两次 score() （因为它是相同的逻辑）或复制整个地图。

碰巧 PlayerID 和 TeamID 是整数，因此我很好奇我是否可以只写 score(s map[int]int) 并进行类型转换。然而，SteveMcQwark 清楚地说明了为什么这可能是一个坏主意。

我认为泛型可以解决这个问题，但我知道它们不会立即出现。还有其他想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:31:16.903

如果你真的想在 Go 中做泛型，你需要一个接口。该接口将通过两种类型实现，一种用于团队，一种用于玩家。score 函数将这个接口类型的对象作为参数，并在不知道它是与球队还是球员一起工作的情况下实现公共评分逻辑。这就是概述。以下是一些细节：

接口的方法集正是评分函数需要的功能。让我们从它似乎需要的两种方法开始，

```
type scoreable interface {
    stats(scID) StatLine  // get statLine for ID
    score(scID, int)      // set score for ID
} 
```

和一个通用的可评分 ID 类型，

```
type scID int 
```

可以实现此接口的类型不是 TeamID 和 PlayerID，而是保存它们的映射的类型。此外，这些类型中的每一种都需要地图、StatLine 和分数地图。结构适用于此：

```
type teamScores struct {
    stats map[TeamID]StatLine
    scores map[TeamID]int
} 
```

然后实施 scoreable，

```
func (s *teamScores) stats(id scID) StatLine {
    return s.stats[TeamID(id)]
}

func (s *teamScores) score(id scID, sc int) {
    s.scores[TeamID(id)] = sc
} 
```

等等，你可能会说。scID 到 TeamID 的那种类型转换。那安全吗？我们是否还不如采用甚至没有 TeamID 的低工程方法？好吧，只要明智地使用这些方法，它就是安全的。struct teamScores 将一个 TeamID 映射与另一个 TeamID 映射相关联。我们即将编写的通用函数 score 将此结构作为参数，因此被赋予正确的关联。它不可能混淆 TeamID 和 PlayerID。这很有价值，并且在足够大的程序中可以证明这种技术是合理的。

对 PlayerID 执行相同的操作，定义一个类似的结构并添加两个方法。

写一次 score 函数。这样开始：

```
func score(s scoreable) {
    for 
```

糟糕，我们需要一些方法来迭代。一个权宜之计的解决方案是获取 ID 列表。让我们添加该方法：

```
type scoreable interface {
    ids() []scID          // get list of all IDs
    stats(scID) StatLine  // get statLine for ID
    score(scID, int)      // set score for ID
} 
```

以及 teamScores 的实现：

```
func (s *teamScores) ids() (a []scID) {
    for tid := range s.stats {
        a = append(a, scID(tid))
    }
    return
} 
```

现在我们在哪里？

```
func score(s scoreable) {
    // lets say we need some intermediate value
    sum := make(map[scID]float64)
    // for each id for which we have a statLine,
    for _, id := range s.ids() { // note method call
        // get the statLine
        stats := s.stats() // method call
        // compute intermediate value
        sum[id] = 0.
        for _, statValue := range stats {
            sum[id] += statValue
        }
    }
    // now compute the final scores
    for id, s := range sum {
        score := int(s) // stub computation
        s.score(id, score) // method call
    }
} 
```

请注意，该函数采用接口类型 scoreable，而不是像 *scoreable 这样的接口指针。一个接口可以保存指针类型 *teamScores。没有额外的指向接口的指针是合适的。

最后，为了调用通用函数，我们需要一个 teamScores 类型的对象。您可能已经拥有联赛统计数据，但可能尚未创建得分图。您可以像这样一次完成所有这些操作：

```
ts := &teamScores{
    stats:  ...your existing map[TeamID]Statline,
    scores: make(map[TeamID]int),
} 
```

称呼：

```
score(ts) 
```

并且团队分数将在 ts.scores 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:32:27.083

拥有单独的 TeamID 和 PlayerID 类型可能会过度设计。如果你对两者都使用相同的类型，比如 ScoreableID，问题就会消失。在大多数情况下，变量名、函数名或程序上下文可以清楚地表明某事是球员还是球队。注释将适用于任何剩余的模棱两可的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:13:48.313

转换规则是表达性和可维护性之间的权衡。每当您在两种类型之间进行转换时，您就是在赌这些类型在未来将在表示上和逻辑上保持兼容。类型系统的目标之一是最大限度地减少对这种兼容性的依赖性传播。另一方面，能够定义多个可以对同一数据进行操作的方法集非常有用，并且转换允许您根据需要选择适当的方法集来对现有数据进行操作。您只能在您可以合法地换出其他相同类型的方法集的情况下进行转换，这不包括您询问的情况。

*知道*你正在尝试做什么而不是你*如何*尝试这样做可能会很有用。我的意思是，如果您只需要对它进行只读访问，则可以将 a 包装`map[ID]int`在其中，或者您可以使用 a ，但很有可能这是不必要的。`func(int)(int, bool)``interface { Get(int)(int, bool); Set(int, int); Delete(int) }`

# php - AJAX PHP 多重响应

> ID：10789002
> 
> 赞同：1
> 
> 时间：2012-05-28T18:30:32.840
> 
> 标签：php, jquery, ajax, json

我有一个ajax问题要问大家。
我想从 php 中的 ajax 调用返回一个数组，然后从该数组中获取我返回用于 jquery ajax 调用的值，但我不知道该怎么做。谁能指出我正确的教程方向？

我知道 ajax 响应有很多不同的编码类型（想到 json 和 xml），但我真的不知道有什么用。现在我所做的就是回显我所拥有的作为响应以在我的页面上显示一些内容，但是我想更改我当前的实现以使用数组作为响应，而不仅仅是简单的文本。虽然我不知道从哪里开始查看有关如何执行此操作的教程。

另外，如果我可以回显我的文本并得到我想要的东西，那么使用编码类型有什么意义呢？我想我真的看不到 json 类型或 xml 的意义，如果我可以回显来显示的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:39:36.460

好吧，首先，编码类型专门用于解决诸如您提出的问题。它们用于在响应中组织多位信息，因此您可以从数据库中返回数组、列表或多行等。

Json 是我个人最喜欢的，因为它在语法上非常简单。要使用 AJAX 将数组从 PHP 传递到 javascript，您首先将数组编码为 json（基本上采用 PHP 数组对象，并对其进行文本表示）。您可以使用 PHP 的`json_encode()`函数（[PHP.NET 参考](http://php.net/manual/en/function.json-encode.php)）来做到这一点。

接下来你需要以某种方式获取它，我会在这里推荐 Jquery，因为它们的内置函数。使用 Jquery，您将键入如下内容：

```
$.ajax({
  url: "ajax.php",
  data: {"somedata":"somedata"},
  success: function (data)
  {
    alert(data);
  },
  dataType: "json" /*now jquery will parse the json for you*/
}); 
```

在这段代码中，成功中的匿名函数将在 Ajax 返回信息时被调用。因为 Jquery 很棒，它已经解析了 json，并将其放入对象数据中。现在，您从 php 传递的每个数组项都可以通过`data.[ArrayKey]`.

另外，您要求提供教程，这里似乎不错：[http ://www.jquery4u.com/json/ajaxjquery-getjson-simple/#.T8PGz9VYua8](http://www.jquery4u.com/json/ajaxjquery-getjson-simple/#.T8PGz9VYua8)

希望这有助于更好地解释它，如果你愿意，我可以给你一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:40:28.123

如果您要返回数组，我认为 JSON 是最好的方法。

它实际上很容易做到。

PHP：

```
$array=array();//this is my array

$array=json_encode($array);//encode the array to JSON format, so that jQuery can decode it.

echo $array;//print it on screen 
```

现在使用一些 jQuery：

```
$.getJSON('http://mysite.com/myphpscript.php', function(my_data){

//now, my_data is your array..

//so access it like this:

alert(my_data.keyname);//"keyname" is an array key of your array

});//end of ajax request 
```

对数组进行编码的*目的*是让 jQuery 可以将它作为一个数组（在 JSON 的帮助下）而不是标准文本。

# prolog - Prolog：如何编写图表

> ID：10789005
> 
> 赞同：1
> 
> 时间：2012-05-28T18:31:02.527
> 
> 标签：prolog

我是Prolog的初学者，遇到了一个我根本无法理解的问题。这是问题：

当我早上起床需要打扮时，我遵循下图所示的规则。这意味着在穿上我的右鞋之前，我需要穿上我的裤子和右袜子，等等。我没有在图表上显示箭头——如果节点 a 和 b 之间有一条线，我假设它从 a 定向到 b 且当 b 在图表中高于 a 时。因此，我之前的图可以被视为关系的有向图。

[http://dropcanvas.com/4j5z7/2](http://dropcanvas.com/4j5z7/2)

创建代表哈斯图的事实知识库。在/2 之前使用谓词（Prolog 文献中接受此表示法，表示之前的谓词有两个参数）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:48:12.427

一种编码是：

`before(ItemA, ListOfAllItemsYouHaveToWearBeforeItemA).`

或者`before(ListOfAllItemsYouHaveToWearBeforeItemA,ItemA).`

（我认为第一个更好）

所以对于合适的鞋子，你会写

```
before(right_shoe,[right_sock,pants]). 
```

另一种可能的编码是`before(ItemA,ItemYouHaveToWearBeforeItemA).`（或相反）。在这种情况下，您必须编写如下内容：

```
before(right_shoe,right_sock).
before(right_show,pants). 
```

编码的选择取决于您接下来想要/需要做什么（或任何其他练习要求）。例如，如果您想获得一件物品的要求，第一个编码会更好，而如果您不仅要询问在一件物品之前应该穿什么，而且还想问一件物品之后您可以穿什么，那么第二个编码会更好。

如果我只是要表示图形，我会使用第二种编码，因为两个参数具有相同的类型（图形项）并且它是图形的更直接表示

# linux - 使用 Steinberg VST SDK 的 g++ cdecl 调用约定

> ID：10789012
> 
> 赞同：1
> 
> 时间：2012-05-28T18:31:31.840
> 
> 标签：linux, g++, vst, cdecl

据我研究，我看到 GNU C 默认使用 cdecl 进行函数调用。使用 GNU C 编译时，VST SDK 将调用显式定义为 cdecl，并显示以下错误：

```
again.cpp:27:15: warning: multi-character character constant [-Wmultichar]
In file included from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffect.h:16:0,
             from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffectx.h:17,
             from again.h:16,
             from again.cpp:13:
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:125:32: error: expected ')' before '*' token
In file included from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffect.h:16:0,
             from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffectx.h:17,
             from again.h:16,
             from again.cpp:13:
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:126:32: error: expected ')' before '*' token
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:127:27: error: expected ')' before '*' token
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:128:27: error: expected ')' before '*' token
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:129:27: error: expected ')' before '*' token
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:130:28: error: expected ')' before '*' token
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:149:2: error: 'AEffectDispatcherProc' does not name a type
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:152:2: error: 'AEffectProcessProc' does not name a type
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:155:2: error: 'AEffectSetParameterProc' does not name a type
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:158:2: error: 'AEffectGetParameterProc' does not name a type
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:183:2: error: 'AEffectProcessProc' does not name a type
/code/vstsdk2.4/pluginterfaces/vst2.x/aeffect.h:187:2: error: 'AEffectProcessDoubleProc' does not name a type
In file included from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffectx.h:17:0,
             from again.h:16,
             from again.cpp:13:
/code/vstsdk2.4/public.sdk/source/vst2.x/audioeffect.h:27:35: error: expected ')' before 'audioMaster'
In file included from /code/vstsdk2.4/public.sdk/source/vst2.x/audioeffectx.h:17:0,
             from again.h:16,
             from again.cpp:13:
/code/vstsdk2.4/public.sdk/source/vst2.x/audioeffect.h:155:2: error: 'audioMasterCallback' does not name a type
In file included from again.h:16:0,
             from again.cpp:13:
/code/vstsdk2.4/public.sdk/source/vst2.x/audioeffectx.h:27:36: error: expected ')' before 'audioMaster'
In file included from again.cpp:13:0:
again.h:22:29: error: expected ')' before 'audioMaster'
again.cpp:16:36: error: 'audioMasterCallback' was not declared in this scope
again.cpp:17:1: error: expected ',' or ';' before '{' token
again.cpp:22:14: error: expected constructor, destructor, or type conversion before '(' token
scons: *** [again.os] Error 1
scons: building terminated because of errors. 
```

同时，当我删除显式定义 __cdecl 并让编译器决定时，它编译时没有任何问题。这不应该抛出同样的错误，因为默认是 cdecl 吗？

我在 Wikipedia 上读到，对于 cdecl，“从 GCC 版本 4.5 开始，调用函数时堆栈必须与 16 字节边界对齐（以前的版本只需要 4 字节对齐。）”这是否应该提供我的问题的洞察力和可能的原因？

当我将其定义为 __fastcall 或 __stdcall 时，我也面临同样的错误。那么这里到底发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T07:13:10.663

我不喜欢直接修改源代码，因为在尝试维护多个平台时会很麻烦。相反，我传递`-D__cdecl=""`给编译器标志来定义它。

我使用这种方法在 linux 上构建了一些 VST，并且效果很好。您应该安全地定义（或手动删除，如果您愿意）显式 __cdecl。VST SDK 在这个意义上有点迟钝，特别是它认为世界上只有 2 个操作系统值得支持，Mac 和 Windows。如果您查看`aeffect.h`，您会发现以下代码：

```
#if TARGET_API_MAC_CARBON
    #ifdef __LP64__
        #pragma options align=power
    #else
        #pragma options align=mac68k
    #endif
    #define VSTCALLBACK
#elif defined __BORLANDC__
    #pragma -a8
#elif defined(__GNUC__)
    #pragma pack(push,8)
    #define VSTCALLBACK __cdecl
#elif defined(WIN32) || defined(__FLAT__) || defined CBUILDER
    #pragma pack(push)
    #pragma pack(8)
    #define VSTCALLBACK __cdecl
#else
    #define VSTCALLBACK
#endif 
```

所以基本上，解决这个问题的最好方法是取消定义 __cdecl 。GCC 应该可以很好地编译您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:43:58.270

经过大量研究，由于我的 C++ 不太好，我找到了原因。它`__cdecl`是 Microsoft Visual C++ 的扩展，在 GNU C 中可以像`__attribute__((cdecl))`函数声明的末尾那样实现。

微软 VC++ 方法：

```
void __cdecl MyFunction(int, int); 
```

GNU C++ 方法：

```
void MyFunction(int, int) __attribute__((cdecl)); 
```

以上都不是标准 C++ 的一部分。

将 VSTCALLBACK 设置为空有效，因为 cdecl 是 G++ 中的默认调用方法。

我不明白为什么 Steinberg 程序员按照他们的方式定义它，因为我找不到一个用 G++ 实现的 VC++ 方法实例。事实上，对于 Mac OSX（g++ 编译器版本是 4.2.1，而在 Linux 上我有 4.6.3），当 VSTCALLBACK 设置为 __cdecl 时，它会以类似的方式失败。

# objective-c - 为什么我们不能使用 C 字符串作为 SEL？

> ID：10789014
> 
> 赞同：13
> 
> 时间：2012-05-28T18:32:01.200
> 
> 标签：objective-c, methods, selector, objective-c-runtime

所以，我又一次搞砸了 objc-runtime（出乎意料），我在[这里](http://opensource.apple.com/source/objc4/objc4-493.11/runtime/objc-sel.mm)发现了一个有趣的代码块：

```
const char *sel_getName(SEL sel) {
#if SUPPORT_IGNORED_SELECTOR_CONSTANT
    if ((uintptr_t)sel == kIgnore) return "<ignored selector>";
#endif
    return sel ? (const char *)sel : "<null selector>";
} 
```

所以，这告诉我的是`SEL`，在每一种习惯上，a 都等同于 C 弦。对包含的 SEL 的前 16 个字节进行十六进制转储`@selector(addObject:)`会得到以下结果：

> 61 64 64 4F 62 6A 65 63 74 3A 00 00 00 00 00 00

这等于 C-string `addObject:`。

话虽如此，当我使用 C 字符串作为选择器时，为什么这段代码会崩溃？

```
SEL normalSEL  = @selector(addObject:);
SEL cStringSEL = (SEL) "addObject:";

NSMutableArray *arr = [NSMutableArray arrayWithObjects:@"1", @"2", nil];

[arr performSelector:normalSEL withObject:@"3"];
[arr performSelector:cStringSEL withObject:@"4"];

NSLog(@"%@", arr); 
```

据我所知，选择器的内容是相同的，那么为什么第二个选择器崩溃并显示以下错误消息？

> `***`由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSArrayM addObject:]：无法识别的选择器发送到实例 0x101918720”`***`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-28T18:38:32.950

选择器是内部的 C 字符串，并通过它们的地址而不是它们的内容进行比较。字符串内容仅用于转换为/从外部字符串表示。实习是为了提高性能——当运行时查找与选择器匹配的方法实现时，它可以直接比较选择器指针，而不是取消引用每个指针并比较字符。

# ruby - 如何拆分数组中的字符串？

> ID：10789022
> 
> 赞同：2
> 
> 时间：2012-05-28T18:32:46.527
> 
> 标签：ruby, arrays

我正在尝试反转字符串变量数组中的单词，但 split 似乎不起作用。

在 IRB 中测试我得到“NoMethodError: private method `split' called for Array”，我假设这与我的程序悄悄地什么都不做有关。

例如，我有：

```
nameList = ["Joe Blow", "Mary Sue", "Alice Mallory"]. 
```

我希望返回：

```
["Blow Joe", "Sue Mary", "Mallory Alice"]. 
```

所以我遍历数组，拆分，反转和加入。这是没有任何反应的地方：

```
nameList.each { |x| 
  x.to_s.split(' ').reverse!.join(' ')
  puts x   #testing here
} 
```

这输出：

```
Joe Blow
Mary Sue
Alice Mallory 
```

我一定错过了一些非常简单的东西，因为这不会太难。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T18:36:17.507

您正在拆分、反转和丢弃结果。看一下这个。

```
nameList = ["Joe Blow", "Mary Sue", "Alice Mallory"]

nameList.each { |x| 
  puts x.to_s.split(' ').reverse.join(' ')
  puts x
  puts '' # for easier reading   
}
# >> Blow Joe
# >> Joe Blow
# >> 
# >> Sue Mary
# >> Mary Sue
# >> 
# >> Mallory Alice
# >> Alice Mallory
# >> 
```

如果您想对数组的每个元素进行一些转换，获取新值并构造这些值的新数组，使用`Array#map`函数是惯用的。

```
nameList = ["Joe Blow", "Mary Sue", "Alice Mallory"]

newList = nameList.map { |x| 
  x.to_s.split(' ').reverse.join(' ')
} 
```

**另外**，在这里你不应该使用 bang 版本的 reverse ( `reverse!`)。它具有破坏性语义。`reverse`创建一个新的反向数组，同时`reverse!`更新源数组。在这种情况下，源数组是一个临时变量，因此在结果方面没有区别。但我认为它令人困惑和分散注意力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:09:17.183

精简版：

```
nameList.map!{ |x| x.split.reverse.join(' ') }
#=> ["Blow Joe", "Sue Mary", "Mallory Alice"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:17:49.423

### 问题

Ruby 中的一切都有一个返回值。在这种情况下，您没有使用方法链的返回值；您只是在打印原始值。

```
nameList.each { |x| 
  # Returns a result, but you aren't doing anything with it.
  x.to_s.split(' ').reverse!.join(' ')

  # Here you print your original value.
  puts x   #testing here
} 
```

### 解决方案

执行此操作的简单方法是使用**#collect**，它返回一个数组。

```
p nameList.collect { |name| name.split.reverse.join(' ') }
["Blow Joe", "Sue Mary", "Mallory Alice"]
=> ["Blow Joe", "Sue Mary", "Mallory Alice"] 
```

这将打印一个修改后的数组，并返回一个数组作为进一步处理的结果。或者，如果你真的想改变你的数组，你可以像这样分配结果：

```
nameList = nameList.collect { |name| name.split.reverse.join(' ') }
 => ["Blow Joe", "Sue Mary", "Mallory Alice"] 
nameList
 => ["Blow Joe", "Sue Mary", "Mallory Alice"] 
```

当然还有其他方法可以做到这一点，但保持可读性很重要。在这种情况下，保持将数组分配给变量的语义是有意义的，这样意图就很清楚了。

# oracle - 在 oracle 包中查找非锚定变量

> ID：10789023
> 
> 赞同：2
> 
> 时间：2012-05-28T18:32:52.417
> 
> 标签：oracle, plsql, oracle11gr2, data-dictionary

我们如何才能找到包中所有未声明为锚定的变量。假设我有一个如下所示的包：

```
create or replace pkg body test 
is 
 TYPE AnEntry IS RECORD (
  term    VARCHAR2(20),   --TERM IS NOT  ANCHORED 
  meaning VARCHAR2(200));  --MEANING IS NOT ANCHORED 

 procedure abc is 
  v_emp_id number;-- here v_emp_id is not an anchored variable 
 begin

 end abc;

end test; 
```

我需要一个 sql 查询，我将包名称传递给它，它会给我所有`non anchored variables`with列表`line number`。

我们是否有任何`data dictionary views`具有如此精细细节的表格，我看过`user_identifiers`表格，它给出了精细细节，但我不能满足我的条件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:15:42.507

实际上，您需要通过`DBA_SOURCE`视图查找字符串，例如`VARCHAR2(`,`NUMBER`或`DATE;`.

# image - 修改 WordPress 多站点的图像大小调整器

> ID：10789026
> 
> 赞同：1
> 
> 时间：2012-05-28T18:33:05.647
> 
> 标签：image, wordpress

有人可以帮我修改图像调整器以使其与 WordPress 多站点一起使用吗？

有人告诉我，我应该使用此代码进行修改`image.php`，以便从正确的来源获取图像：

```
$theImageSrc = 'path/To/Image.jpg';
global $blog_id;
if (isset($blog_id) && $blog_id > 0) {
    $imageParts = explode('/files/', $theImageSrc);
    if (isset($imageParts[1])) {
        $theImageSrc = '/blogs.dir/' . $blog_id . '/files/' . $imageParts[1];
    }
} 
```

下面是 image.php 的样子。我不知道代码应该去哪里。先感谢您！

```
<?php 
// Smart Image Resizer 1.4.1
// Resizes images, intelligently sharpens, crops based on width:height ratios, color fills
// transparent GIFs and PNGs, and caches variations for optimal performance

// Created by: Joe Lencioni (http://shiftingpixel.com)
// Date: August 6, 2008
// Based on: http://veryraw.com/history/2005/03/image-resizing-with-php/

/////////////////////
// LICENSE
/////////////////////

// I love to hear when my work is being used, so if you decide to use this, feel encouraged
// to send me an email. Smart Image Resizer is released under a Creative Commons
// Attribution-Share Alike 3.0 United States license
// (http://creativecommons.org/licenses/by-sa/3.0/us/). All I ask is that you include a link
// back to Shifting Pixel (either this page or shiftingpixel.com), but don�t worry about
// including a big link on each page if you don�t want to�one will do just nicely. Feel
// free to contact me to discuss any specifics (joe@shiftingpixel.com).

/////////////////////
// REQUIREMENTS
/////////////////////

// PHP and GD

/////////////////////
// PARAMETERS
/////////////////////

// Parameters need to be passed in through the URL's query string:
// image        absolute path of local image starting with "/" (e.g. /images/toast.jpg)
// width        maximum width of final image in pixels (e.g. 700)
// height       maximum height of final image in pixels (e.g. 700)
// color        (optional) background hex color for filling transparent PNGs (e.g. 900 or 16a942)
// cropratio    (optional) ratio of width to height to crop final image (e.g. 1:1 or 3:2)
// nocache      (optional) does not read image from the cache
// quality      (optional, 0-100, default: 90) quality of output image

/////////////////////
// EXAMPLES
/////////////////////

// Resizing a JPEG:
// <img src="/image.php/image-name.jpg?width=100&amp;height=100&amp;image=/path/to/image.jpg" alt="Don't forget your alt text" />

// Resizing and cropping a JPEG into a square:
// <img src="/image.php/image-name.jpg?width=100&amp;height=100&amp;cropratio=1:1&amp;image=/path/to/image.jpg" alt="Don't forget your alt text" />

// Matting a PNG with #990000:
// <img src="/image.php/image-name.png?color=900&amp;image=/path/to/image.png" alt="Don't forget your alt text" />

/////////////////////
// CODE STARTS HERE
/////////////////////

if (!isset($_GET['image']))
{
    header('HTTP/1.1 400 Bad Request');
    echo 'Error: no image was specified';
    exit();
}

define('MEMORY_TO_ALLOCATE',    '100M');
define('DEFAULT_QUALITY',       90);
define('CURRENT_DIR',           dirname(__FILE__));
define('CACHE_DIR_NAME',        '/imagecache/');
define('CACHE_DIR',             CURRENT_DIR . CACHE_DIR_NAME);
define('DOCUMENT_ROOT',         $_SERVER['DOCUMENT_ROOT']);

// Images must be local files, so for convenience we strip the domain if it's there
$image          = preg_replace('/^(s?f|ht)tps?:\/\/[^\/]+/i', '', (string) $_GET['image']);

// For security, directories cannot contain ':', images cannot contain '..' or '<', and
// images must start with '/'
if ($image{0} != '/' || strpos(dirname($image), ':') || preg_match('/(\.\.|<|>)/', $image))
{
    header('HTTP/1.1 400 Bad Request');
    echo 'Error: malformed image path. Image paths must begin with \'/\'';
    exit();
}

// If the image doesn't exist, or we haven't been told what it is, there's nothing
// that we can do
if (!$image)
{
    header('HTTP/1.1 400 Bad Request');
    echo 'Error: no image was specified';
    exit();
}

// Strip the possible trailing slash off the document root
$docRoot    = preg_replace('/\/$/', '', DOCUMENT_ROOT);

if (!file_exists($docRoot . $image))
{
    header('HTTP/1.1 404 Not Found');
    echo 'Error: image does not exist: ' . $docRoot . $image;
    exit();
}

// Get the size and MIME type of the requested image
$size   = GetImageSize($docRoot . $image);
$mime   = $size['mime'];

// Make sure that the requested file is actually an image
if (substr($mime, 0, 6) != 'image/')
{
    header('HTTP/1.1 400 Bad Request');
    echo 'Error: requested file is not an accepted type: ' . $docRoot . $image;
    exit();
}

$width          = $size[0];
$height         = $size[1];

$maxWidth       = (isset($_GET['width'])) ? (int) $_GET['width'] : 0;
$maxHeight      = (isset($_GET['height'])) ? (int) $_GET['height'] : 0;

if (isset($_GET['color']))
    $color      = preg_replace('/[^0-9a-fA-F]/', '', (string) $_GET['color']);
else
    $color      = FALSE;

// If either a max width or max height are not specified, we default to something
// large so the unspecified dimension isn't a constraint on our resized image.
// If neither are specified but the color is, we aren't going to be resizing at
// all, just coloring.
if (!$maxWidth && $maxHeight)
{
    $maxWidth   = 99999999999999;
}
elseif ($maxWidth && !$maxHeight)
{
    $maxHeight  = 99999999999999;
}
elseif ($color && !$maxWidth && !$maxHeight)
{
    $maxWidth   = $width;
    $maxHeight  = $height;
}

// If we don't have a max width or max height, OR the image is smaller than both
// we do not want to resize it, so we simply output the original image and exit
if ((!$maxWidth && !$maxHeight) || (!$color && $maxWidth >= $width && $maxHeight >= $height))
{
    $data   = file_get_contents($docRoot . '/' . $image);

    $lastModifiedString = gmdate('D, d M Y H:i:s', filemtime($docRoot . '/' . $image)) . ' GMT';
    $etag               = md5($data);

    doConditionalGet($etag, $lastModifiedString);

    header("Content-type: $mime");
    header('Content-Length: ' . strlen($data));
    echo $data;
    exit();
}

// Ratio cropping
$offsetX    = 0;
$offsetY    = 0;

if (isset($_GET['cropratio']))
{
    $cropRatio      = explode(':', (string) $_GET['cropratio']);
    if (count($cropRatio) == 2)
    {
        $ratioComputed      = $width / $height;
        $cropRatioComputed  = (float) $cropRatio[0] / (float) $cropRatio[1];

        if ($ratioComputed < $cropRatioComputed)
        { // Image is too tall so we will crop the top and bottom
            $origHeight = $height;
            $height     = $width / $cropRatioComputed;
            $offsetY    = ($origHeight - $height) / 2;
        }
        else if ($ratioComputed > $cropRatioComputed)
        { // Image is too wide so we will crop off the left and right sides
            $origWidth  = $width;
            $width      = $height * $cropRatioComputed;
            $offsetX    = ($origWidth - $width) / 2;
        }
    }
}

// Setting up the ratios needed for resizing. We will compare these below to determine how to
// resize the image (based on height or based on width)
$xRatio     = $maxWidth / $width;
$yRatio     = $maxHeight / $height;

if ($xRatio * $height < $maxHeight)
{ // Resize the image based on width
    $tnHeight   = ceil($xRatio * $height);
    $tnWidth    = $maxWidth;
}
else // Resize the image based on height
{
    $tnWidth    = ceil($yRatio * $width);
    $tnHeight   = $maxHeight;
}

// Determine the quality of the output image
$quality    = (isset($_GET['quality'])) ? (int) $_GET['quality'] : DEFAULT_QUALITY;

// Before we actually do any crazy resizing of the image, we want to make sure that we
// haven't already done this one at these dimensions. To the cache!
// Note, cache must be world-readable

// We store our cached image filenames as a hash of the dimensions and the original filename
$resizedImageSource     = $tnWidth . 'x' . $tnHeight . 'x' . $quality;
if ($color)
    $resizedImageSource .= 'x' . $color;
if (isset($_GET['cropratio']))
    $resizedImageSource .= 'x' . (string) $_GET['cropratio'];
$resizedImageSource     .= '-' . $image;

$resizedImage   = md5($resizedImageSource);

$resized        = CACHE_DIR . $resizedImage;

// Check the modified times of the cached file and the original file.
// If the original file is older than the cached file, then we simply serve up the cached file
if (!isset($_GET['nocache']) && file_exists($resized))
{
    $imageModified  = filemtime($docRoot . $image);
    $thumbModified  = filemtime($resized);

    if($imageModified < $thumbModified) {
        $data   = file_get_contents($resized);

        $lastModifiedString = gmdate('D, d M Y H:i:s', $thumbModified) . ' GMT';
        $etag               = md5($data);

        doConditionalGet($etag, $lastModifiedString);

        header("Content-type: $mime");
        header('Content-Length: ' . strlen($data));
        echo $data;
        exit();
    }
}

// We don't want to run out of memory
ini_set('memory_limit', MEMORY_TO_ALLOCATE);

// Set up a blank canvas for our resized image (destination)
$dst    = imagecreatetruecolor($tnWidth, $tnHeight);

// Set up the appropriate image handling functions based on the original image's mime type
switch ($size['mime'])
{
    case 'image/gif':
        // We will be converting GIFs to PNGs to avoid transparency issues when resizing GIFs
        // This is maybe not the ideal solution, but IE6 can suck it
        $creationFunction   = 'ImageCreateFromGif';
        $outputFunction     = 'ImagePng';
        $mime               = 'image/png'; // We need to convert GIFs to PNGs
        $doSharpen          = FALSE;
        $quality            = round(10 - ($quality / 10)); // We are converting the GIF to a PNG and PNG needs a compression level of 0 (no compression) through 9
    break;

    case 'image/x-png':
    case 'image/png':
        $creationFunction   = 'ImageCreateFromPng';
        $outputFunction     = 'ImagePng';
        $doSharpen          = FALSE;
        $quality            = round(10 - ($quality / 10)); // PNG needs a compression level of 0 (no compression) through 9
    break;

    default:
        $creationFunction   = 'ImageCreateFromJpeg';
        $outputFunction     = 'ImageJpeg';
        $doSharpen          = TRUE;
    break;
}

// Read in the original image
$src    = $creationFunction($docRoot . $image);

if (in_array($size['mime'], array('image/gif', 'image/png')))
{
    if (!$color)
    {
        // If this is a GIF or a PNG, we need to set up transparency
        imagealphablending($dst, false);
        imagesavealpha($dst, true);
    }
    else
    {
        // Fill the background with the specified color for matting purposes
        if ($color[0] == '#')
            $color = substr($color, 1);

        $background = FALSE;

        if (strlen($color) == 6)
            $background = imagecolorallocate($dst, hexdec($color[0].$color[1]), hexdec($color[2].$color[3]), hexdec($color[4].$color[5]));
        else if (strlen($color) == 3)
            $background = imagecolorallocate($dst, hexdec($color[0].$color[0]), hexdec($color[1].$color[1]), hexdec($color[2].$color[2]));
        if ($background)
            imagefill($dst, 0, 0, $background);
    }
}

// Resample the original image into the resized canvas we set up earlier
ImageCopyResampled($dst, $src, 0, 0, $offsetX, $offsetY, $tnWidth, $tnHeight, $width, $height);

if ($doSharpen)
{
    // Sharpen the image based on two things:
    //  (1) the difference between the original size and the final size
    //  (2) the final size
    $sharpness  = findSharp($width, $tnWidth);

    $sharpenMatrix  = array(
        array(-1, -2, -1),
        array(-2, $sharpness + 12, -2),
        array(-1, -2, -1)
    );
    $divisor        = $sharpness;
    $offset         = 0;
    imageconvolution($dst, $sharpenMatrix, $divisor, $offset);
}

// Make sure the cache exists. If it doesn't, then create it
if (!file_exists(CACHE_DIR))
    mkdir(CACHE_DIR, 0755);

// Make sure we can read and write the cache directory
if (!is_readable(CACHE_DIR))
{
    header('HTTP/1.1 500 Internal Server Error');
    echo 'Error: the cache directory is not readable';
    exit();
}
else if (!is_writable(CACHE_DIR))
{
    header('HTTP/1.1 500 Internal Server Error');
    echo 'Error: the cache directory is not writable';
    exit();
}

// Write the resized image to the cache
$outputFunction($dst, $resized, $quality);

// Put the data of the resized image into a variable
ob_start();
$outputFunction($dst, null, $quality);
$data   = ob_get_contents();
ob_end_clean();

// Clean up the memory
ImageDestroy($src);
ImageDestroy($dst);

// See if the browser already has the image
$lastModifiedString = gmdate('D, d M Y H:i:s', filemtime($resized)) . ' GMT';
$etag               = md5($data);

doConditionalGet($etag, $lastModifiedString);

// Send the image to the browser with some delicious headers
header("Content-type: $mime");
header('Content-Length: ' . strlen($data));
echo $data;

function findSharp($orig, $final) // function from Ryan Rud (http://adryrun.com)
{
    $final  = $final * (750.0 / $orig);
    $a      = 52;
    $b      = -0.27810650887573124;
    $c      = .00047337278106508946;

    $result = $a + $b * $final + $c * $final * $final;

    return max(round($result), 0);
} // findSharp()

function doConditionalGet($etag, $lastModified)
{
    header("Last-Modified: $lastModified");
    header("ETag: \"{$etag}\"");

    $if_none_match = isset($_SERVER['HTTP_IF_NONE_MATCH']) ?
        stripslashes($_SERVER['HTTP_IF_NONE_MATCH']) : 
        false;

    $if_modified_since = isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) ?
        stripslashes($_SERVER['HTTP_IF_MODIFIED_SINCE']) :
        false;

    if (!$if_modified_since && !$if_none_match)
        return;

    if ($if_none_match && $if_none_match != $etag && $if_none_match != '"' . $etag . '"')
        return; // etag is there but doesn't match

    if ($if_modified_since && $if_modified_since != $lastModified)
        return; // if-modified-since is there but doesn't match

    // Nothing has changed since their last request - serve a 304 and exit
    header('HTTP/1.1 304 Not Modified');
    exit();
} // doConditionalGet()

// old pond
// a frog jumps
// the sound of water

// �Matsuo Basho
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-06T20:27:41.687

我知道我的回答迟到了。但是，为什么您需要在 Wordpress 站点中使用 PHP 图像缩放器？

对于在您的代码中硬编码的图像，我希望您只需在 Photoshop 中调整它们的大小以获得正确的大小。

对于通过 WP 上传的图像，满足[add_image_size()](https://developer.wordpress.org/reference/functions/add_image_size/)，它将处理您的图像大小，原生与 WP。

# c# - DragDropEffects.Copy 和 DragDropEffects.Move 有什么区别？

> ID：10789027
> 
> 赞同：6
> 
> 时间：2012-05-28T18:33:32.060
> 
> 标签：c#, drag-and-drop, copy, move, effects

我已经在整个互联网上寻找这个问题的答案，但我似乎找不到它。

DragDropEffects.Copy 和 DragDropEffects.Move 有什么区别？

在 DragEnter 上的代码中，我将其设置为：

```
private void Canvas_DragEnter(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(DataFormats.FileDrop))
            e.Effect = DragDropEffects.Move;
    } 
```

但是如果我使用

```
private void Canvas_DragEnter(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(DataFormats.FileDrop))
            e.Effect = DragDropEffects.Copy;
    } 
```

程序没有区别。

有人可以解释一下区别吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T18:39:19.847

如果您在目标上启用了 Allow Drop，它们会提供不同的鼠标光标。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-28T18:40:09.177

唯一的区别是光标，用户可以从光标的外观判断你的程序是移动还是复制。复制光标有一个+，移动光标没有。

但是，以这种方式实际实施它取决于您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-18T10:41:21.290

再添加一行看看效果：

```
private void Canvas_DragEnter(object sender, DragEventArgs e)
{
    if (e.Data.GetDataPresent(DataFormats.FileDrop))
    {
        e.Effect = DragDropEffects.Copy;
        e.Handled = true; //<<--- Add this line
    }
} 
```

# asp.net-mvc - 无法加载文件或程序集“MySite（来自 [计算机名]）”或其依赖项之一。（来自 HRESULT 的异常：0x80131040）

> ID：10789028
> 
> 赞同：3
> 
> 时间：2012-05-28T18:33:35.527
> 
> 标签：asp.net-mvc, entity-framework

**你好，**

运行我的 ASP.NET MVC 应用程序（使用 VS mini IIS）时，在 EnityFrameworkModel 中更新表后出现以下异常：

```
Server Error in '/' Application.

Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.IO.FileLoadException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Assembly Load Trace: The following information can be helpful to determine why the assembly 'myApp (from my-pc)' could not be loaded.

=== Pre-bind state information ===
LOG: User = my-PC\my
LOG: DisplayName = myApp (from my-pc)
 (Partial)
WRN: Partial binding information was supplied for an assembly:
WRN: Assembly Name: myApp (from my-pc) | Domain ID: 4
WRN: A partial bind occurs when only part of the assembly display name is provided.
WRN: This might result in the binder loading an incorrect assembly.
WRN: It is recommended to provide a fully specified textual identity for the assembly,
WRN: that consists of the simple name, version, culture, and public key token.
WRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.
LOG: Appbase = file:///C:/Users/my/Documents/Visual Studio 2010/Projects/myApp/myApp.Website/
LOG: Initial PrivatePath = C:\Users\my\Documents\Visual Studio 2010\Projects\myApp\myApp.Website\bin
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Users\my\Documents\Visual Studio 2010\Projects\myApp\myApp.Website\web.config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/9ac245ea/5244fde2/myApp (from my-pc).DLL.
LOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/Temporary ASP.NET Files/root/9ac245ea/5244fde2/myApp (from my-pc)/myApp (from my-pc).DLL.
LOG: Attempting download of new URL file:///C:/Users/my/Documents/Visual Studio 2010/Projects/myApp/myApp.Website/bin/myApp (from my-pc).DLL.
WRN: Comparing the assembly name resulted in the mismatch: NAME
ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated.

Stack Trace: 

[FileLoadException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +39
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +132
   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +144
   System.Reflection.Assembly.Load(String assemblyString) +28
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +46

[ConfigurationErrorsException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +618
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +209
   System.Web.Configuration.CompilationSection.LoadAssembly(AssemblyInfo ai) +130
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +178
   System.Web.Compilation.BuildManager.GetPreStartInitMethodsFromReferencedAssemblies() +94
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +332
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +677

[HttpException (0x80004005): Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +9090876
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +97
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +258

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

这是我尝试过的：

*   清洁溶液
*   停止迷你 IIS 并重新启动
*   重新启动的 Windows

但我还是有这个问题吗？

编辑1：

重新运行时，我现在得到这个：

```
 Server Error in '/' Application.

Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.IO.FileLoadException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Assembly Load Trace: The following information can be helpful to determine why the assembly 'myApp (from my-pc)' could not be loaded.

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

Stack Trace: 

[FileLoadException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +39
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +132
   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +144
   System.Reflection.Assembly.Load(String assemblyString) +28
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +46

[ConfigurationErrorsException: Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +618
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +209
   System.Web.Configuration.CompilationSection.LoadAssembly(AssemblyInfo ai) +130
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +178
   System.Web.Compilation.BuildManager.GetPreStartInitMethodsFromReferencedAssemblies() +94
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +332
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +677

[HttpException (0x80004005): Could not load file or assembly 'myApp (from my-pc)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +9090876
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +97
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +258 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T07:52:55.253

通过打开调试文件夹，我找到了 MyApp（来自 My-pc）之类的文件，我删除了 bin 中的所有内容并重新构建，它又可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:19:34.983

我也删除了冲突的文件，它能够解决我的问题。我能够按预期运行我的应用程序并查看我的默认网页。我正在运行 Visual Studio 2012，只是尝试在调试模式下运行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-16T18:27:18.597

我遇到了类似的问题。我的 bin 中有一些二进制文件，其名称类似于“MyApp - Copy.dll”。

我从我的垃圾箱中删除了那些冲突的文件。清洁解决方案重建

有效。

# java - 用于应用程序属性的 Mac 库

> ID：10789035
> 
> 赞同：0
> 
> 时间：2012-05-28T18:34:40.223
> 
> 标签：java, directory

我知道我可以使用 System.getProperty("user.home") 获取文件的默认主页，并且通常是我为应用程序放置属性文件的位置。但是我希望我的文件有一个更“离散”的位置，这样库就不会变得混乱（因为用户通常会看到该库）。有人知道我怎样才能得到这样的目录吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:42:36.630

您可以创建一个名称以“。”开头的文件夹。这样它就不会默认显示在 Finder 中。例如`System.getProperty("user.home")+"/.mydocs";`

在 Unix 系统上，默认情况下，名称以“.”开头的文件夹 被隐藏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:02:01.937

查看[java.util.prefs](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/prefs/package-summary.html)。此 API 旨在让您以独立于系统的方式访问用户首选项。

在 OS X 中，这是通过访问 ~/Library/Preferences 来支持的，有关详细信息，请参阅[此文档](http://developer.apple.com/library/mac/#qa/qa1170/_index.html)。

如果您尝试存储的特定于用户的数据不是严格的*首选项*，则同一文档建议：

```
System.getProperty("user.home") + "/Library/" + "Your App Name" 
```

# android - 在选项卡中使用 LinearLayout

> ID：10789037
> 
> 赞同：1
> 
> 时间：2012-05-28T18:34:54.900
> 
> 标签：android, tabs, android-linearlayout

我已经在一个简单的应用程序中成功实现了以下代码，该应用程序显示了一个可滚动的 LinearLayout，其中 grid_item.xml 布局定义了列表的元素。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
. 
.
.
 <!-- Header --> 
 <LinearLayout android:id="@+id/header" 
   .
   .
   . 
     </LinearLayout>

    <!-- List Divider --> 
     <View android:layout_width="fill_parent" 
         android:layout_height="1dip" 
         android:background="?android:attr/listDivider"/>

     <!-- ListView (grid_items) --> 
    <LinearLayout 
          android:id="@+id/linearLayout2" 
          android:layout_width="wrap_content" 
         android:layout_height="fill_parent">
         <ListView 
             android:layout_weight="1" 
             android:layout_width="0dip" 
             android:id="@+id/listview" 
             android:layout_height="fill_parent">
         </ListView>  
     </LinearLayout>  

</LinearLayout> 
```

现在我想在不同的选项卡中显示我解析数据的变化。我无法确定 Android 框架是否专门查找名为“grid_item.xml”的文件，或者我是否可以使用不同名称的该文件的副本并更改 TextView Id 以获得相同的效果。

（这是我在编程板上的第一个问题，所以我什至不确定我的问题是否可以理解！）

提前致谢。

# javascript - value.length 的 AJAX 问题

> ID：10789039
> 
> 赞同：0
> 
> 时间：2012-05-28T18:35:07.537
> 
> 标签：javascript, ajax

下面是一个非常简单的 AJAX 请求，它工作得很好，直到我在里面放了一个简单的语句。由于第 4 行，它失败了。

```
var wlen = str.value.length 
```

下面是 AJAX 代码

```
<script type="text/javascript">
function name_search(str)
{
var wlen = str.value.length;
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("name_div").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","/it/device/action/name_search_new.php?q="+str,true);
xmlhttp.send();
}
</script> 
```

**name_search_new.php**页面查找与在文本框中键入的内容相似的值并返回这些值。这个页面与这个问题无关，因为**任何 php 页面总是会因第 4 行新变量/赋值而失败，并且它总是会在变量/赋值消失的情况下工作。**

如果有帮助，下面列出了对该功能的请求......它也在“文本区域”框中也失败了。

```
<input type="text" name="name" id="name" value="" style="color:red" 
placeholder="Device/Item(Required)" onkeyup="name_search(this.value)" /> 
```

任何帮助表示赞赏，杰伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:41:21.900

你不需要做`str.value.length`。 `str.length`是你需要的。

这是一个 jsfiddle 演示：

[http://jsfiddle.net/ahEeH/](http://jsfiddle.net/ahEeH/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T18:39:04.667

你在打电话`name_search(this.value)`；因此，`str = this.value`. 然后您的第 4 行有效地执行`this.value.value.length`。但是，`this.value`是一个字符串，它没有一个名为`value`- 所以`this.value.value`是未定义的属性。访问未定义的属性将失败。

更改为`str.length`它应该可以工作。

顺便说一句：这个问题与 AJAX 无关。

# c++ - c++ 查找依赖文件

> ID：10789040
> 
> 赞同：1
> 
> 时间：2012-05-28T18:35:09.880
> 
> 标签：c++, buildbot, dependency-analysis

我一直在寻找一种方法或实用程序来查找大型 C/C++ 项目的依赖文件。

我想要的是，当文件被更改（提交）时，我希望我们的 buildbot 运行与更改的文件相关的类的测试。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:46:09.683

Depends on which kind of buildbot you're using. The most common method I know is to use the C++ compilers' -M option to generate dependency makefiles you include to your main makefile. Tools like cmake would do this automatically for you without any efforts.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:45:50.027

The compiler option

```
gcc -MMD 
```

will output a list of dependencies used by the compiler, in a format suitable for use with GNU or Posix Make. Other compilers should have similar options, and it's not difficult to transform that dependency format for use with other make systems using e.g. perl.

# python - python多线程比串行慢？

> ID：10789042
> 
> 赞同：14
> 
> 时间：2012-05-28T18:35:18.617
> 
> 标签：python, multithreading

我试图弄清楚python中的多线程编程。这是我想比较串行和并行速度的简单任务。

```
import threading
import Queue
import time
import math

def sinFunc(offset, n):
  result = []
  for i in range(n):
    result.append(math.sin(offset + i * i))
  return result

def timeSerial(k, n):
  t1 = time.time()    
  answers = []
  for i in range(k):
    answers.append(sinFunc(i, n))
  t2 = time.time()
  print "Serial time elapsed: %f" % (t2-t1)

class Worker(threading.Thread):

  def __init__(self, queue, name):
    self.__queue = queue
    threading.Thread.__init__(self)
    self.name = name

  def process(self, item):
    offset, n = item
    self.__queue.put(sinFunc(offset, n))
    self.__queue.task_done()
    self.__queue.task_done()

  def run(self):
    while 1:
        item = self.__queue.get()
        if item is None:
            self.__queue.task_done()
            break
        self.process(item)

def timeParallel(k, n, numThreads):
  t1 = time.time()    
  queue = Queue.Queue(0)
  for i in range(k):
    queue.put((i, n))
  for i in range(numThreads):
    queue.put(None)    
  for i in range(numThreads):
    Worker(queue, i).start()
  queue.join()
  t2 = time.time()
  print "Serial time elapsed: %f" % (t2-t1)

if __name__ == '__main__':

  n = 100000
  k = 100
  numThreads = 10

  timeSerial(k, n)
  timeParallel(k, n, numThreads)

#Serial time elapsed: 2.350883
#Serial time elapsed: 2.843030 
```

有人可以向我解释发生了什么吗？我习惯了 C++，使用该模块的类似版本可以看到我们期望的加速。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-28T19:17:55.707

其他答案提到 GIL 是 cpython 中的问题。但我觉得有一些缺失的信息。在线程中运行的代码受 CPU 限制的情况下，这将导致性能问题。在您的情况下，是的，在线程中进行许多计算很可能会导致性能显着下降。

但是，如果您正在执行更多 IO 绑定的操作，例如从网络应用程序中的许多套接字读取，或调用子进程，您可以从线程中获得性能提升。上面代码的一个简单示例是向 shell 添加一个愚蠢的简单调用：

```
import os

def sinFunc(offset, n):
  result = []
  for i in xrange(n):
    result.append(math.sin(offset + i * i))
  os.system("echo 'could be a database query' >> /dev/null; sleep .1")
  return result 
```

那个调用可能就像在文件系统上等待一样。但是你可以看到，在这个例子中，线程将开始被证明是有益的，因为当线程等待 IO 并且其他线程将继续处理时，GIL 可以被释放。即便如此，当更多线程开始被创建和同步它们的开销所抵消时，仍然存在一个最佳点。

对于 CPU 绑定代码，您将使用[多处理](http://docs.python.org/library/multiprocessing.html)

来自文章：[http ://www.informit.com/articles/article.aspx?p=1850445&seqNum=9](http://www.informit.com/articles/article.aspx?p=1850445&seqNum=9)

> ...线程更适合 I/O 绑定应用程序（I/O 释放 GIL，允许更多并发）...

关于线程与进程的类似问题参考：
[https ://stackoverflow.com/a/1227204/496445](https://stackoverflow.com/a/1227204/496445)
[https://stackoverflow.com/a/990436/496445](https://stackoverflow.com/a/990436/496445)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T18:39:52.107

Python 有一个严重的线程问题。基本上，向 Python 应用程序添加线程几乎总是无法使其更快，有时会使其变慢。

这是由于[Global Interpreter Lock](http://wiki.python.org/moin/GlobalInterpreterLock)或 GIL 造成的。

这是有关它的[博客文章](http://42bits.wordpress.com/2010/10/24/python-global-interpreter-lock-gil-explained-pycon-tech-talk/ "博文")，其中包括有关该主题的演讲。

绕过此限制的一种方法是使用进程而不是线程。[多处理](http://docs.python.org/library/multiprocessing.html)模块使这变得更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:48:02.860

用 C 编写的 Python 库可以随意获取/释放全局解释器锁 (GIL)。那些不使用 Python 对象的人可以释放 GIL，以便其他线程可以查看，但是我相信数学库一直使用 Python 对象，因此有效地将 math.sin 序列化。由于锁定/解锁是一种开销，因此 Python 线程比进程慢并不罕见。

# javascript - 没有事件的Javascript鼠标坐标

> ID：10789044
> 
> 赞同：0
> 
> 时间：2012-05-28T18:36:16.603
> 
> 标签：javascript, events, mouse

> **可能重复：**
> [如何在没有事件的情况下获取鼠标位置（不移动鼠标）？](https://stackoverflow.com/questions/2601097/how-to-get-the-mouse-position-without-events-without-moving-the-mouse)

是否可以在没有任何事件的情况下获取鼠标当前坐标？

只有Javascript！没有 jQuery...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:37:54.630

这是不可能的，无论是使用普通的 javascript，还是使用 jQuery 的帮助。你至少需要一个`mousemove`事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:38:38.373

不，仅使用 javascript 而没有事件是不可能的。

# api - API 设计：如何处理以下涉及用户权限/角色管理的情况

> ID：10789047
> 
> 赞同：1
> 
> 时间：2012-05-28T18:36:43.260
> 
> 标签：api, design-patterns

我正在设计一个 Web API，它还处于最基本的阶段。

我系统中的每个用户都可以拥有一个或多个角色。（示例用户和管理员）。

API 本身被设计为模块和方法，例如我有一个模块用户，在它下面有以下方法

**用户**

*   get_friends_of
*   get_profile_pic_url

现在，在我的用户角色管理代码中，这些方法中的每一个都是“权利”。这些权限被分配给一个或多个角色，例如两个角色看起来像

user_role = ['get_profile_pic_url'] 管理员角色 = ['get_profile_pic_url','get_friends_of']

因此，每当用户尝试调用一种方法时，我都会查看他的**任何**角色是否将此方法作为权利提及。如果是，则调用它，否则它不是。

除了以下情况外，这就像黄油一样工作。

用户 X 通常无权调用“get_friends_of”，但我希望允许他在尝试获取自己的朋友时调用该方法。

例如 get_friends_of(X) 是允许的，但 get_friends_of(y) 将被拒绝。

我的问题是如何将这些案例融入我的设计中？

一个直接的解决方案可能是我引入“get_my_friends”方法，但它会增加我的 API 的大小，我必须编写更多文档并查看它实际上只是“get_friends_of”的一个特例。从某种意义上说，它也是不可扩展的，我可能想让用户看到朋友的朋友。

我的 API 中的设计目标之一是调用你的每个方法都是互斥的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T09:08:04.300

您的授权工作方式...您拥有-用户->角色-角色->权限（功能名称）

如果你实现你正在尝试做的事情......你会做到： - 角色 - >权利（函数名称+特定参数值）。

这感觉不对。您可以根据函数名称和参数值拥有权限，但是您的整个授权逻辑将有太多逻辑......维护起来会非常复杂。

我建议你照你说的做......创建一个新函数 get_my_friends()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:44:31.820

在我看来，您的`User`模块正在以两种不同的方式使用 - 表示单个`User`实体（`get_my_friends`和`get_profile_pic_url`案例）并提供与用户相关的一般访问权限（`get_friends_of`案例）。您可能需要考虑将它们分开，可能分为 a`User`和 a `UserRepository`，其中前者代表一个`User`有朋友和个人资料图片 URL 的现实世界，后者提供对`User`s 的通用访问。

以下是一些链接，详细说明了您遇到的概念：

*   [实体](http://domaindrivendesign.org/node/109)
*   [存储库](http://domaindrivendesign.org/node/123)

# redis - 防止 servicestack RedisClient 中的属性序列化

> ID：10789051
> 
> 赞同：4
> 
> 时间：2012-05-28T18:37:13.713
> 
> 标签：redis, servicestack

我认为标题很清楚。ServiceStack Redis 客户端序列化（存储）仅获取属性（我还添加了 ReadOnly 属性）。

这是一个错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T19:21:52.877

这是预期的行为：如果它是可读的，它将被序列化，如果它是可写的，它是可反序列化的。即它将序列化**仅获取**属性但不会序列化**仅设置**公共属性。

ServiceStack 序列化程序确实支持忽略属性的 [IgnoreDataMember] 属性，请参阅[此示例](https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/DataContractTests.cs#L36)。

# java - 逻辑错误，draw(Graphics g) 调用时无法绘制 (Java)

> ID：10789052
> 
> 赞同：0
> 
> 时间：2012-05-28T18:37:18.347
> 
> 标签：java

我发现自己无法利用绘图方法在 JFrame 中显示图像。如果从不调用 draw(Graphics p) 方法，则以下代码的功能完全相同。是什么导致了这种功能的缺乏，可以采取什么措施来解决它？（假设“C:\test\background.png”是有效路径。）没有编译时错误，也没有显示运行时错误。这是该计划中唯一的课程。尝试在 JPanel 内绘图并不能解决问题。

```
package gui;

import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;

import javax.swing.ImageIcon;
import javax.swing.JFrame;

public class Main extends JFrame{
    private Image mainMenuBackground;
    private String state;
    Graphics g;

    Main(){
        setSize(800, 600);
        setVisible(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);
        state = "main menu";
    }

    public static void main(String args[]){
        Main m = new Main();
        m.run();
    }
    public void loadImages(){
        mainMenuBackground = new ImageIcon("C:\\test\\background.png").getImage();
    }
    public void run(){
        try{
            loadImages();
            draw(g);
            pack();
        }catch(Exception ex){}
    }
    public void draw(Graphics p){
        Graphics2D g = (Graphics2D) p;
        g.drawImage(mainMenuBackground, 0, 0, null);
        g.drawRect(0, 0, 50, 50);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:40:20.340

首先，这个：

```
catch(Exception ex){} 
```

会阻止你看到*任何*问题。您说“没有显示的运行时错误”-我并不感到惊讶，因为您已经压制了所有内容。

接下来，您永远不会为实例变量分配值，因此当您将它传递给方法时`g`，它仍然会有一个值，然后您可以在其中使用不同类型的*局部*变量......并取消引用它。这将导致 a ，然后您将其捕获并忽略。`null``draw`*`g``NullPointerException`*

 *所以基本上有很多错误，但基本上你不能只声明一个`Graphics`变量并希望它有一个有用的值。对于“正常”的绘画操作，图形上下文会自动*提供*给您的方法 - 或者您可以在使用图像对象时创建它。*

# c# - C# 中的文件传输程序在图像和无法打开的二进制文件上留下伪影

> ID：10789053
> 
> 赞同：0
> 
> 时间：2012-05-28T18:37:19.810
> 
> 标签：c#, sockets, file-upload, tcp-ip

文本文件似乎没问题。这是用于发送文件的代码：

```
System.IO.FileStream stream = new System.IO.FileStream(file, System.IO.FileMode.Open, System.IO.FileAccess.Read);
System.IO.BinaryReader reader = new System.IO.BinaryReader(stream);
double done = 0;
double tot = info.Length;
double chunk = 8096;

while (done < tot)
{
    if (chunk > tot - done)
    {
        chunk = tot - done;
    }
    Byte[] buffer = new Byte[(int)chunk];
    reader.Read(buffer,(int)done,(int)chunk);
    sock.Send(buffer);
    done += chunk;
    statusTxt.Text = Math.Round(done / tot * 100, 2).ToString() + "%";
} 
```

接收文件的代码非常相似：

```
private void ReceiveFile(string file, Socket sock,double size)
{
    while (done < size)
        {
            if (chunk > (size - done))
            {
                chunk = size - done;
            }
            Byte[] buffer = new Byte[(int)chunk];

            int count = sock.Receive(buffer);
            writer.Write(buffer);
            done += count;

            this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, (Action)delegate()
            {
                foreach (TextBlock block in files.Items)
                {
                    if (block.Tag.ToString() == file)
                    {
                        block.Text = "Uploading " + file + "... 0% ("+done.ToString()+"/" + size.ToString() + ")";
                    }
                }
            });
        }
        writer.Flush();
        writer.Close();
    } 
```

我看过很多关于图像伪影的帖子，但所有问题都涉及到将字节编码为文本的问题。我相信我已经避免了这个问题。我在整个过程中使用字节数组，并跟踪正在读取的字节数，但图像最终仍然损坏。我检查了文件，它们在客户端和服务器上包含相同数量的字节，所以服务器上发生了一些事情，但它只是不正确。代码有什么问题，或者可能是服务器问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:14:05.350

您似乎大多忽略了实际发送/接收的字节数。尤其是`writer.Write(buffer);`写入整个缓冲区，不管它`sock.Receive(buffer);`之前是否被完全填满。

# c# - 隔离存储读取上的 FormatException

> ID：10789056
> 
> 赞同：1
> 
> 时间：2012-05-28T18:37:53.340
> 
> 标签：c#, silverlight, windows-phone-7

我在应用程序设置中存储了一些项目。当我这样做时

`this._userSettings = IsolatedStorageSettings.ApplicationSettings;`

我得到一个`System.FormatException`. 当我阅读时，我如何弄清楚是什么原因造成的？我假设隔离存储中不应该存在某些东西。

这是堆栈。

```
 at System.Double.Parse(String s, NumberStyles style, IFormatProvider provider)
   at System.Xml.XmlConvert.ToDouble(String s)
   at System.Xml.XmlReader.ReadContentAsDouble()
   at System.Xml.XmlDictionaryReader.XmlWrappedReader.ReadContentAsDouble()
   at System.Xml.XmlDictionaryReader.ReadElementContentAsDouble()
   at System.Runtime.Serialization.XmlReaderDelegator.ReadElementContentAsDouble()
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(RuntimeMethodInfo rtmi, Object obj, BindingFlags invokeAttr, Binder binder, Object parameters, CultureInfo culture, Boolean isBinderDefault, Assembly caller, Boolean verifyAccess, StackCrawlMark& stackMark)
   at System.Reflection.RuntimeMethodInfo.InternalInvoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, StackCrawlMark& stackMark)
   at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
   at System.Runtime.Serialization.XmlFormatReader.ReadValue(Type type, String name, String ns, XmlObjectSerializerReadContext context, XmlReaderDelegator xmlReader)
   at System.Runtime.Serialization.XmlFormatReader.ReadMemberAtMemberIndex(ClassDataContract classContract, Object& objectLocal, DeserializedObject desObj)
   at System.Runtime.Serialization.XmlFormatReader.ReadClass(DeserializedObject desObj, ClassDataContract classContract, Int32 membersRead)
   at System.Runtime.Serialization.XmlFormatReader.Deserialize(XmlObjectSerializerReadContext context)
   at System.Runtime.Serialization.XmlFormatReader.InitializeCallStack(DataContract clContract, XmlReaderDelegator xmlReaderDelegator, XmlObjectSerializerReadContext xmlObjContext, XmlDictionaryString[] memberNamesColl, XmlDictionaryString[] memberNamespacesColl)
   at System.Runtime.Serialization.CollectionDataContract.ReadXmlValue(XmlReaderDelegator xmlReader, XmlObjectSerializerReadContext context)
   at System.Runtime.Serialization.XmlObjectSerializerReadContext.ReadDataContractValue(DataContract dataContract, XmlReaderDelegator reader)
   at System.Runtime.Serialization.XmlObjectSerializerReadContext.InternalDeserialize(XmlReaderDelegator reader, String name, String ns, DataContract& dataContract)
   at System.Runtime.Serialization.XmlObjectSerializerReadContext.InternalDeserialize(XmlReaderDelegator xmlReader, Type declaredType, DataContract dataContract, String name, String ns)
   at System.Runtime.Serialization.DataContractSerializer.InternalReadObject(XmlReaderDelegator xmlReader, Boolean verifyObjectName)
   at System.Runtime.Serialization.XmlObjectSerializer.ReadObjectHandleExceptions(XmlReaderDelegator reader, Boolean verifyObjectName)
   at System.Runtime.Serialization.XmlObjectSerializer.ReadObject(XmlDictionaryReader reader)
   at System.Runtime.Serialization.XmlObjectSerializer.ReadObject(Stream stream)
   at System.IO.IsolatedStorage.IsolatedStorageSettings.Reload()
   at System.IO.IsolatedStorage.IsolatedStorageSettings..ctor(Boolean useSiteSettings)
   at System.IO.IsolatedStorage.IsolatedStorageSettings.get_ApplicationSettings()
   at ShowSeek.Custom_Classes.StateManager.SetupState()
   at ShowSeek.App.Application_Activated(Object sender, ActivatedEventArgs e)
   at Microsoft.Phone.Shell.PhoneApplicationService.FireActivated(Boolean isExecutionContextPreserved)
   at Microsoft.Phone.Execution.NativeEmInterop.FireOnResume(Boolean isExecutionContextPreserved) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:27:59.773

Windows Phone Silverlight 中的 double.Parse 函数实现如下：

```
public static double Parse(string s, NumberStyles style, IFormatProvider provider)
{
    NumberFormatInfo.ValidateParseStyleFloatingPoint(style);
    NumberFormatInfo instance = NumberFormatInfo.GetInstance(provider);
    double result = 0.0;
    try
    {
        Number.ParseDouble(s, style, instance, true, ref result);
        return result;
    }
    catch (FormatException)
    {
        string str = s.Trim();
        if (str.Equals(instance.PositiveInfinitySymbol))
        {
            return PositiveInfinity;
        }
        if (str.Equals(instance.NegativeInfinitySymbol))
        {
            return NegativeInfinity;
        }
        if (!str.Equals(instance.NaNSymbol))
        {
            throw;
        }
        return NaN;
    }
} 
```

基本上，它首先尝试将您的双精度数读取为数字。然后，如果失败，它将尝试特殊情况（无穷大，NaN）。这就是该方法的实现方式，您对此无能为力。性能影响应该可以忽略不计，尤其是因为它在应用程序生命周期中只发生一次（您第一次尝试 `accessIsolatedStorageSettings.ApplicationSettings`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:00:32.620

当我使用传递 InvarientCulture 作为 IFormatProvider 时，我遇到了同样的错误

```
Convert.ToDouble(Text, CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T23:25:28.467

您之前的设置可能已更改（例如，类定义已更改）。

利用：

```
IsolatedStorageSettings.ApplicationSettings.Clear(); 
```

清空之前存储的设置。使用后不要忘记对代码进行注释。

# java - 在矢量图像中创建 QR 码

> ID：10789059
> 
> 赞同：13
> 
> 时间：2012-05-28T18:38:02.907
> 
> 标签：java, qr-code, zxing, vector-graphics

我可以使用 ZXing 成功创建 QR 码 PNG 图像，但没有简单的方法可以将输出作为 SVG 或 EPS。

如何从 QRCodeWriter 创建的 BitMatrix 对象创建矢量图像？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-05-03T05:13:30.277

我知道的老问题，但对于任何来寻找如何做到这一点的人......连接`ZXing`到`JFreeSVG`（[http://www.jfree.org/jfreesvg](http://www.jfree.org/jfreesvg)）非常容易，例如：

```
package org.jfree.demo;

import com.google.zxing.BarcodeFormat;
import com.google.zxing.WriterException;
import com.google.zxing.common.BitMatrix;
import com.google.zxing.qrcode.QRCodeWriter;
import java.awt.Color;
import java.io.File;
import java.io.IOException;
import org.jfree.graphics2d.svg.SVGGraphics2D;
import org.jfree.graphics2d.svg.SVGUtils;

public class QRCodes {

    public static void main(String[] args) throws WriterException, IOException {
        QRCodeWriter qrCodeWriter = new QRCodeWriter();
        BitMatrix bitMatrix = qrCodeWriter.encode("http://www.jfree.org/jfreesvg", 
                BarcodeFormat.QR_CODE, 160, 160);
        int w = bitMatrix.getWidth();
        SVGGraphics2D g2 = new SVGGraphics2D(w, w);
        g2.setColor(Color.BLACK);
    for (int xIndex = 0; xIndex < w; xIndex = xIndex + bitMatrix.getRowSize()) {
        for (int yIndex = 0; yIndex < w; yIndex = yIndex + bitMatrix.getRowSize()) {
            if (bitMatrix.get(xIndex, yIndex)) {
                g2.fillRect(xIndex, yIndex, bitMatrix.getRowSize(), bitMatrix.getRowSize());

            }
        }
    }

        SVGUtils.writeToSVG(new File("qrtest.svg"), g2.getSVGElement());
    }

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-03-11T14:27:28.413

你甚至可以只使用 zxing 来完成，而无需额外的库：

```
QRCodeWriter qrCodeWriter = new QRCodeWriter();
Map<EncodeHintType, Object> hints = new HashMap<>();
hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.M);
hints.put(EncodeHintType.CHARACTER_SET, StandardCharsets.UTF_8.name());

BitMatrix bitMatrix = qrCodeWriter.encode(payload, BarcodeFormat.QR_CODE, 543, 543, hints);

StringBuilder sbPath = new StringBuilder();
int width = bitMatrix.getWidth();
int height = bitMatrix.getHeight();
int rowSize = bitMatrix.getRowSize();
BitArray row = new BitArray(width);
for(int y = 0; y < height; ++y) {
    row = bitMatrix.getRow(y, row);
    for(int x = 0; x < width; ++x) {
        if (row.get(x)) {
            sbPath.append(" M"+x+","+y+"h1v1h-1z");
        }
    }
}

StringBuilder sb = new StringBuilder();
sb.append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
sb.append("<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" viewBox=\"0 0 ").append(width).append(" ").append(height).append("\" stroke=\"none\">\n");
sb.append("<style type=\"text/css\">\n");
sb.append(".black {fill:#000000;}\n");
sb.append("</style>\n");
sb.append("<path class=\"black\"  d=\"").append(sbPath.toString()).append("\"/>\n");
sb.append("</svg>\n"); 
```

请注意，上述解决方案在内存消耗方面比使用 Batik DOM 的解决方案要高效得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:38:03.217

我发现最简单的方法是使用 iText 创建 PDF，然后将生成的 PDF 转换为 EPS 或 SVG。以下是创建 PDF 的代码：

```
 @Test
   public void testQRtoPDF() throws WriterException, FileNotFoundException, DocumentException, UnsupportedEncodingException {
      final int s = 600;
      int r = 1;

      Charset charset = Charset.forName( "UTF-8" );
      CharsetEncoder encoder = charset.newEncoder();
      byte[] b = null;
      try {
         // Convert a string to UTF-8 bytes in a ByteBuffer
         ByteBuffer bbuf = encoder.encode( CharBuffer.wrap(
                     "1éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò1" +
                                 "2éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò2" +
                                 "3éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò3" +
                                 "4éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò4" +
                                 "5éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò5" +
                                 "6éöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùòïëéöàäèüùò6" ) );
         b = bbuf.array();
      } catch ( CharacterCodingException e ) {
         System.out.println( e.getMessage() );
      }

      String content = new String( b, "UTF-8" );
      QRCodeWriter qrCodeWriter = new QRCodeWriter();
      Hashtable<EncodeHintType, String> hints = new Hashtable<EncodeHintType, String>( 2 );
      hints.put( EncodeHintType.CHARACTER_SET, "UTF-8" );
      BitMatrix qrCode = qrCodeWriter.encode( content, BarcodeFormat.QR_CODE, s, s, hints );

      Document doc = new Document( new Rectangle( s, s ) );
      PdfWriter pdfWriter = PdfWriter.getInstance( doc, new FileOutputStream( "qr-code.pdf" ) );
      doc.open();
      PdfContentByte contentByte = pdfWriter.getDirectContent();
      contentByte.setColorFill( BaseColor.BLACK );

      boolean d = false;
      for ( int x = 0; x < qrCode.getWidth(); x += r ) {
         for ( int y = 0; y < qrCode.getHeight(); y += r ) {
            if ( qrCode.get( x, y ) ) {
               contentByte.rectangle( x, s - y, r, r );
               contentByte.fill();
               contentByte.stroke();
            }
         }
      }

      doc.close();
   } 
```

然后我使用图像魔法进行转换。像这样：

```
convert qr-code.pdf qr-code.eps 
```

不能对 svg 做同样的事情

```
convert qr-code.pdf qr-code.svg 
```

这不起作用

我用一些长内容测试了这段代码，它最多可以处理 600 个字符。这可能取决于手机或屏幕上摄像头的精度。

我希望这可以帮助别人

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-26T16:26:07.920

如果您想要一个更自由的许可证，您可以使用`Apache Batik`而不是。当您使用包含作为瞬态依赖`JFreeSVG`项时，这尤其有意义。`Apache FOP``Apache Batik`

这是一个调整后的版本。这个想法和原始代码的功劳归大卫吉尔伯特所有。

```
import com.google.zxing.BarcodeFormat;
import com.google.zxing.WriterException;
import com.google.zxing.common.BitMatrix;
import com.google.zxing.qrcode.QRCodeWriter;
import org.apache.batik.anim.dom.SVGDOMImplementation;
import org.w3c.dom.DOMImplementation;
import org.w3c.dom.svg.SVGDocument;

import java.awt.*;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.Writer;

public class QRCodesBatik {

    public static void main(String[] args) throws WriterException, IOException {
        QRCodeWriter qrCodeWriter = new QRCodeWriter();
        BitMatrix bitMatrix = qrCodeWriter.encode("https://xmlgraphics.apache.org/batik/",
                BarcodeFormat.QR_CODE, 800, 800);

        // Create a document with the appropriate namespace
        DOMImplementation domImpl = SVGDOMImplementation.getDOMImplementation();
        SVGDocument document = (SVGDocument) domImpl.createDocument(SVGDOMImplementation.SVG_NAMESPACE_URI, "svg", null);
        // Create an instance of the SVG Generator
        org.apache.batik.svggen.SVGGraphics2D g2 = new org.apache.batik.svggen.SVGGraphics2D(document);

        // draw onto the SVG Graphics object
        g2.setColor(Color.BLACK);

        for (int xIndex = 0; xIndex < bitMatrix.getWidth(); xIndex = xIndex + bitMatrix.getRowSize()) {
            for (int yIndex = 0; yIndex < bitMatrix.getWidth(); yIndex = yIndex + bitMatrix.getRowSize()) {
                if (bitMatrix.get(xIndex, yIndex)) {
                    g2.fillRect(xIndex, yIndex, bitMatrix.getRowSize(), bitMatrix.getRowSize());
                }
            }
        }

        try (Writer out = new OutputStreamWriter(new FileOutputStream(new File("qrtest.svg")), "UTF-8")) {
            g2.stream(out, true);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-24T22:31:17.130

Svg 格式是一组构成 BitMatrix 的矩形。格式背后的想法是图像的分辨率不受尺寸增加的影响。例如，@siom 的解决方案为所有像素创建 1x1 矩形（这就是它创建一个巨大文件的原因）。我将该解决方案归类为解决此问题的蛮力方法。

我开发了一个在 O(n^2) 中运行的更好的解决方案。它扫描整个 bitMatrix 并首先检测每个点的最大长度正方形，然后尝试将正方形扩展到每个维度的矩形。最后，它绘制了所有可能的各种尺寸的矩形和正方形。

```
import com.google.zxing.common.BitMatrix;
import java.awt.Color;
import java.awt.Point;
import java.nio.charset.StandardCharsets;
import java.util.HashSet;
import java.util.Set;
import org.jfree.graphics2d.svg.SVGGraphics2D;

public class SvgUtils {

  public static byte[] createSvgImage(BitMatrix bitMatrix){
    int width = bitMatrix.getWidth();
    int height = bitMatrix.getHeight();
    Set<Point> visitedPoints = new HashSet<>();
    SVGGraphics2D g2 = new SVGGraphics2D(width, height);
    g2.setColor(Color.BLACK);
    for (int x = 0; x < width; x++) {
      for (int y = 0; y < height; y++) {
        Point maxRectangleLength = getMaxRectangleLength(new Point(x, y), bitMatrix, visitedPoints);
        if(maxRectangleLength != null) {
          g2.fillRect(x, y, maxRectangleLength.x, maxRectangleLength.y);
          y += maxRectangleLength.y-1;
        }
      }
    }
    return g2.getSVGDocument().getBytes(StandardCharsets.UTF_8);
  }

  private static int getMaxSquareLength(Point startPoint, BitMatrix bitMatrix, Set<Point> visitedPoints){
    int width = bitMatrix.getWidth();
    int height = bitMatrix.getHeight();
    int maxLength = 0;
    while(startPoint.x + maxLength < width && startPoint.y + maxLength < height) {
      for (int xOffSett = 0; xOffSett < maxLength; xOffSett++) {
        if (!bitMatrix.get(startPoint.x + xOffSett, startPoint.y + maxLength) || visitedPoints.contains(new Point(startPoint.x + xOffSett, startPoint.y + maxLength))) {
          return maxLength;
        }
      }
      for (int yOffset = 0; yOffset <= maxLength; yOffset++) {
        if (!bitMatrix.get(startPoint.x + maxLength, startPoint.y + yOffset) || visitedPoints.contains(new Point(startPoint.x + maxLength, startPoint.y + yOffset))) {
          return maxLength;
        }
      }
      for (int xOffSett = 0; xOffSett < maxLength; xOffSett++) {
        visitedPoints.add(new Point(startPoint.x + xOffSett, startPoint.y + maxLength));
      }
      for (int yOffset = 0; yOffset <= maxLength; yOffset++) {
        visitedPoints.add(new Point(startPoint.x + maxLength, startPoint.y + yOffset));
      }
      maxLength++;
    }
    return maxLength;
  }

  private static Point getMaxRectangleLength(Point startPoint, BitMatrix bitMatrix, Set<Point> visitedPoints){
    int width = bitMatrix.getWidth();
    int height = bitMatrix.getHeight();
    int maxSquareLength = getMaxSquareLength(startPoint, bitMatrix, visitedPoints);
    if(maxSquareLength == 0)
      return null;
    int maxWidth = maxSquareLength-1;
    int maxHeight = maxSquareLength-1;
    boolean searchFinished = false;
    while(!searchFinished && startPoint.y + ++maxHeight < height) {
      for (int xOffSett = 0; xOffSett < maxSquareLength; xOffSett++) {
        if (!bitMatrix.get(startPoint.x + xOffSett, startPoint.y + maxHeight) ||
            visitedPoints.contains(new Point(startPoint.x + xOffSett, startPoint.y + maxHeight))) {
          searchFinished = true;
          break;
        }
      }
    }
    searchFinished = false;
    while(!searchFinished && startPoint.x + ++maxWidth < width) {
      for (int yOffSett = 0; yOffSett < maxSquareLength; yOffSett++) {
        if (!bitMatrix.get(startPoint.x + maxWidth, startPoint.y + yOffSett) ||
            visitedPoints.contains(new Point(startPoint.x + maxWidth, startPoint.y + yOffSett))) {
          searchFinished = true;
          break;
        }
      }
    }
    if(maxHeight >= maxWidth){
      for(int yOffSet = maxSquareLength; yOffSet < maxHeight; yOffSet++){
        for (int xOffSett = 0; xOffSett < maxSquareLength; xOffSett++) {
          visitedPoints.add(new Point(startPoint.x + xOffSett, startPoint.y + yOffSet));
        }
      }
      return new Point(maxSquareLength, maxHeight);
    } else {
      for(int xOffSett = maxSquareLength; xOffSett < maxWidth; xOffSett++){
        for (int yOffSet = 0; yOffSet < maxSquareLength; yOffSet++) {
          visitedPoints.add(new Point(startPoint.x + xOffSett, startPoint.y + yOffSet));
        }
      }
      return new Point(maxWidth, maxSquareLength);
    }
  }
} 
```

# ios - 新 iPhone，无法对其进行测试？

> ID：10789064
> 
> 赞同：1
> 
> 时间：2012-05-28T18:38:30.860
> 
> 标签：ios, xcode, code-signing

所以我有一部 iPhone 用于测试和开发。锁定按钮卡住了，所以我把它带到苹果公司更换。他们毫不犹豫地更换了手机，这太棒了。

我正在尝试在这款新手机上进行开发，但是当我在开发人员门户中输入新设备并设置新的配置文件（我也在手机上看到）时，每次尝试导出到 iOS 设备时，我都会得到没有连接手机/需要连接兼容的手机或其他什么的错误。

过去我从来没有真正遇到过这个问题，所以我想知道是否有人知道我错过了什么或者需要在电话或 xCode 中更改的内容？

请帮忙！

PS：我确实检查以确保配置文件和 xCode 应用程序中的标识符相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:48:45.283

确保您已按下 Xcode 管理器中的“使用此设备进行开发”按钮！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:45:03.907

嗯，这可能是 iOS/Xcode 版本问题吗？如果您获得的新手机运行的是 5.x，并且自发布以来您还没有更新您的 iOS/Xcode，那么它将看不到 5.x 设备。（最新版本的 iOS/Xcode 也需要 Lion OS）。

# java - 如何使用java在文档中追加新节点

> ID：10789066
> 
> 赞同：4
> 
> 时间：2012-05-28T18:38:37.087
> 
> 标签：java, xpath

我有以下 updateFile 代码，当我的 xml 文件中没有发布 ID 时，我正在尝试添加新节点。

```
public static void UpdateFile(String path, String publicationID, String url) {
        try {

            File file = new File(path);
            if (file.exists()) {
                DocumentBuilderFactory factory = DocumentBuilderFactory
                        .newInstance();
                DocumentBuilder builder = factory.newDocumentBuilder();
                Document document = builder.parse(file);
                document.getDocumentElement().normalize();
                 XPathFactory xpathFactory = XPathFactory.newInstance();
                 // XPath to find empty text nodes.
                 String xpath = "//*[@n='"+publicationID+"']"; 
                 XPathExpression xpathExp = xpathFactory.newXPath().compile(xpath);  
                 NodeList nodeList = (NodeList)xpathExp.evaluate(document, XPathConstants.NODESET);
                //NodeList nodeList = document.getElementsByTagName("p");
                 if(nodeList.getLength()==0)
                 {
                     Node node = document.getDocumentElement();
                     Element newelement = document.createElement("p");
                     newelement.setAttribute("n", publicationID);
                     newelement.setAttribute("u", url);
                     newelement.getOwnerDocument().appendChild(newelement);
                     System.out.println("New Attribute Created");
                 }
                 System.out.println();

                //writeXmlFile(document,path);
            }

        } catch (Exception e) {
            System.out.println(e);
        }
    } 
```

在上面的代码中，我使用 XPathExpression 并且所有匹配的节点都添加到 NodeList nodeList = (NodeList)xpathExp.evaluate(document, XPathConstants.NODESET);

在这里，我正在检查是否 (nodeList.getLength()==0) 那么这意味着我没有任何传递了 publicationid 的节点。

如果没有这样的节点，我想创建一个新节点。

在这一行中 newelement.getOwnerDocument().appendChild(newelement); 其给出错误（org.w3c.dom.DOMException：HIERARCHY_REQUEST_ERR：尝试插入不允许的节点。）。

请推荐！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T18:46:25.610

您当前正在调用`appendChild`文档本身。这最终会创建多个根元素，这显然是你做不到的。

您需要找到要在其中添加节点的适当元素，并将其添加到该元素中。例如，如果您想将新元素添加*到*根元素，您可以使用：

```
document.getDocumentElement().appendChild(newelement); 
```

# javascript - 返回 javascript 函数的真/假值，然后根据该值执行操作

> ID：10789069
> 
> 赞同：9
> 
> 时间：2012-05-28T18:38:42.093
> 
> 标签：javascript, jquery, forms, validation

我正在构建一个联系表单，我需要 jQuery 验证器的帮助。

```
function contactform() {
    $("form #submit").on("click", function() {
        $("form input").removeClass("error");
        validator();
        // 3rd action goes here
    });
}); 
```

`validator()`检查是否有任何输入为空，如果是，则向其中添加一个错误类：

```
function validator() {
    $("form input").each(function() {
        var value = $(this).val();
        if (value.length <= 0) {
            $(this).addClass("error");
            return false;
        }
    });
}); 
```

现在，对于`contactform()`我想说的第三个动作，如果`validator() = true`（即没有为空的输入），然后继续下一个代码。

我似乎无法返回`validator()`. 有人知道最好的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T18:43:18.153

这是另一种使用`filter`方法的解决方案：

```
function validator() {
    return $("form input").filter(function() {
        return $.trim(this.value).length == 0;
    }).addClass("error").length == 0;
});

function contactform() {
    ...
    if (validator()) {
        // it's OK
    } else {
        // there are errors
    }
} 
```

**更新**：在@am_not_i_am[的帮助下进行了惊人的更新。](https://stackoverflow.com/questions/10789069/return-true-false-value-of-a-javascript-function-and-then-do-stuff-based-on-that/10789118#comment14033422_10789118)谢谢！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T18:40:53.040

```
function validator() {
    var result = true;
    $("form input").removeClass("error");
    $('form input').each(function() {
           if(!$.trim(this.value)) {
             $(this).addClass('.error');
             result = false;  
           }
     });
    return result;
}

function contactform() {
    $("form #submit").on("click", function() {
        if(validator()) { // pass the validation

        } else { // fail validation

        }
        // 3rd action goes here
    });
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-28T18:41:46.023

您似乎遇到的问题是您有一个嵌套函数和闭包，这会阻止您直接返回值。

像这样的东西应该可以解决问题：

```
function validator() {
    var result=true;
    $("form input").each(function() {
        var value = $(this).val();
        if (value.length <= 0) {
            $(this).addClass("error");
            result = false;
        }
    });
    return result;
}); 
```

# android - 如果文本很长，android edittext 会自动调整宽度

> ID：10789075
> 
> 赞同：1
> 
> 时间：2012-05-28T18:39:10.170
> 
> 标签：android, android-edittext, resize

在我的应用程序中，我有六个编辑文本。我将它们分组为两个线性布局，3 个线性布局。它应该看起来像这样：

|编辑文本1|编辑文本4|

|编辑文本2|编辑文本5|

|编辑文本3|编辑文本6|

我要编辑的文本总是相同的大小。当用户开始在字段中键入内容时，就会出现问题。如果文本太长...编辑是文本正在调整大小。有焦点的会变大，同一横排的会变小。

如何防止这种情况？我想编辑文本保持相同大小...如果文本太长...我只需要滚动它并跟随文本光标。

怎么做？天呐！

这里有一些代码：

```
 <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical"
        android:weightSum="3" >

        <EditText
            android:id="@+id/blackPlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="5dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/black_name_selector"
            android:hint="@string/black"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@drawable/player_name_textcolor"
            android:textColorHint="@drawable/player_name_textcolor" />

        <EditText
            android:id="@+id/redPlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="5dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/red_name_selector"
            android:hint="@string/red"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@drawable/player_name_textcolor"
            android:textColorHint="@drawable/player_name_textcolor" />

        <EditText
            android:id="@+id/whitePlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="5dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/white_name_selector"
            android:hint="@string/white"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@color/black"
            android:textColorHint="@color/black" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:orientation="vertical"
        android:weightSum="3" >

        <EditText
            android:id="@+id/bluePlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/blue_name_selector"
            android:hint="@string/blue"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@drawable/player_name_textcolor"
            android:textColorHint="@drawable/player_name_textcolor" />

        <EditText
            android:id="@+id/greenPlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/green_name_selector"
            android:hint="@string/green"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@drawable/player_name_textcolor"
            android:textColorHint="@drawable/player_name_textcolor" />

        <EditText
            android:id="@+id/yellowPlayerName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/yellow_name_selector"
            android:hint="@string/yellow"
            android:inputType="textPersonName"
            android:maxLength="12"
            android:singleLine="true"
            android:textColor="@color/black"
            android:textColorHint="@color/black" />
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:01:23.620

对于每个编辑文本，将它们的 layout_width 设置为 0dp 并将 layout_weight 设置为 1

```
<EditText
    android:layout_width="0dp"
    android:layout_weight="1"
    ... /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:53:36.167

尝试使用[TableLayout](http://developer.android.com/reference/android/widget/TableLayout.html)

```
<TableLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <TableRow>
        <EditText ...>
        <EditText ...>
        <EditText ...>
    </TableRow>

    <TableRow>
        <EditText ...>
        <EditText ...>
        <EditText ...>
    </TableRow>
</TableLayout> 
```

# java - 如何编写 XSD 来验证转义的 xml 数据模式

> ID：10789076
> 
> 赞同：0
> 
> 时间：2012-05-28T18:39:10.313
> 
> 标签：java, xml, regex, xsd, xsd-validation

我在下面得到了一个特定的 xml 数据

```
<l7:ApiPlans xmlns:l7="http://ns.xcompany.com/2012/04/api-management">
  <l7:ApiPlan>
<l7:PlanPolicy>

&lt;wsp:Policy xmlns:L7p="http://www.xcompany.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
&lt;wsp:All wsp:Usage="Required"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
          ...... some other welformed xml
&lt;/wsp:All&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
    </l7:PlanPolicy>
  </l7:ApiPlan>
</l7:ApiPlans> 
```

我需要编写一个 XSD（如果可能）来验证 PlanPolicy 以

```
&lt;wsp:Policy xmlns:L7p="http://www.xcompany.com/ws/policy"     
xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
&lt;wsp:All wsp:Usage="Required"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt; 
```

并以

```
 &lt;/wsp:All&gt;
        &lt;/wsp:All&gt;
    &lt;/wsp:Policy&gt; 
```

到目前为止，我有这个，

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" targetNamespace="http://ns.xcompany.com/2012/04/api-management" xmlns:l7="http://ns.xcompany.com/2012/04/api-management">
<xs:element name="ApiPlans">
    <xs:complexType>
        <xs:sequence>
            <xs:element maxOccurs="unbounded" ref="l7:ApiPlan"/>
        </xs:sequence>
    </xs:complexType>
</xs:element>
<xs:element name="ApiPlan">
    <xs:complexType>
        <xs:sequence>               
            <xs:element ref="l7:PlanPolicy"/>
        </xs:sequence>
    </xs:complexType>
</xs:element>
<xs:element name="PlanPolicy" type="policyDataType"/>
<simpleType name="policyDataType">
    <restriction base="xs:string">
         <minLength value="1"></minLength>
        <pattern value="(&lt;).*(&gt;).*(&lt;).*(&gt;)"></pattern>
    </restriction>
</simpleType>
</xs:schema> 
```

那可能吗？作为一个附带问题，您如何在模式中定义：新行（CR/LF）、制表符和引号。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:52:31.703

我不会尝试这样做。

好吧，如果有一半的选择，我无论如何都不会在 XML 中使用转义的 XML —— XML 被设计为嵌套而不转义，而转义它只会让每个人的生活变得更加困难。

但是如果你不得不像这样忍受它，我会在提取并解析它之后单独验证内部 XML。无需在一次验证过程中完成所有操作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T19:30:20.453

是的，这绝对是可能的，正则表达式是您完成这项非典型任务的唯一选择。请注意，转义的内容不会作为 XML 处理，而是作为字符串处理。

请务必阅读如何在正则表达式中正确[转义各种特殊字符](http://www.xmlschemareference.com/regularExpression.html#Metacharacters)，包括括号。

换行符和制表符分别用`\n`和`\t`m 表示。

报价可以通过加倍输入。

# android - Android应用后退按钮显示空白屏幕

> ID：10789083
> 
> 赞同：3
> 
> 时间：2012-05-28T18:40:08.283
> 
> 标签：android, android-intent

我有一个 android 应用程序，它以一个简单的屏幕和一个“开始”按钮开始。一旦用户单击按钮，它就会从 url 中检索代码并将其放入列表中。如果您从列表视图中按下返回，它将显示一个空白屏幕，而不是带有“开始”按钮的屏幕。所有代码都在 onCreate 语句中。如果我遗漏了很明显这是我的第一个真正的 Android 应用程序（除了 Hello Android 教程），请原谅我。如果有帮助，下面是第一个活动中的代码。

```
public class Main extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button next = (Button) findViewById(R.id.butQR);
    next.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            setContentView(R.layout.listplaceholder);
            Intent myIntent = new Intent(view.getContext(), NewListActivity.class);
            myIntent.putExtra("race_id", view.getId());
            myIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
            myIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            startActivity(myIntent);
        }

    });
} 
```

更新：我正在使用 setContentView(R.layout.listplaceholder); 单击按钮并在新的 oncreate 中进行下一个活动。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:48:36.107

您不应该为子活动创建新任务，而且我认为没有理由清除任务堆栈的顶部。如果您不希望在用户返回时显示启动活动，您可以`finish()`在启动新活动后简单地显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:05:38.153

从您提到的内容来看，您似乎不需要意图标志。当您设置`FLAG_ACTIVITY_CLEAR_TOP`标志时，如果要启动的活动已经在运行，则其顶部的所有其他活动都将关闭，以便被调用的活动（已经在运行并在堆栈中）现在位于顶部。现在，当您按下后退按钮时，它应该转到在此之前运行的活动，但由于您的主活动因该标志而关闭，您会看到一个空白屏幕。

# c# - HtmlContainerControl ASP.NET 中的 InnerHtml 为空

> ID：10789087
> 
> 赞同：1
> 
> 时间：2012-05-28T18:40:28.177
> 
> 标签：c#, asp.net

我有一个相当具体的问题，我找不到谷歌搜索。

我有一个带有 runat 服务器的 div，如下所示：

```
<div id="Menu" runat="server">

<!--code-->
     <div><%= SomeValue %></div>
<!--code-->

</div> 
```

问题是在页面完成它的生命周期之前我需要元素的 InnerHtml（使其全球化），但是当我添加`<%=%>`InnerHtml 属性时，它会返回`""`（如果我删除它，它工作正常）。

例如：

1

```
<div id="Menu" runat="server">
  <span>Hi!</span>
</div>
//Menu.InnerHtml == "<span>Hi!</span>"; 
```

2

```
<div id="Menu" runat="server">
  <span>Hi!</span>
  <div><%= SomeValue %></div>
</div>
//Menu.InnerHtml == ""; 
```

有没有办法同时拥有 InnerHtml 和打印`SomeValue`？

我想可以通过其他方式解决这个问题，这并不是一个好的选择，但我正在处理现有代码。

谢谢！

# python - 我在课堂上有一个“属性”。当我调用它时，它说它没有那个属性

> ID：10789090
> 
> 赞同：0
> 
> 时间：2012-05-28T18:40:39.003
> 
> 标签：python, class, function, attributes

我有这段代码，我想做的是调用显示函数，但它给了我错误。这是代码：

```
level = [0, 0, 0,
         0, 1, 0,
         0, 0, 0]

class player:
    def getPlayerLoc(self, level):
        for i in level:
            if level[level.index(i)] == 1:
                print level.index(i)

    def display(self, level, levelx, levely):
        for i in level:
            layer = ""
            for h in range(levely): 
                height = h+1
                if level.index(i) < levelx*height and level.index(i) >= levelx*h:
                    if level[level.index(i)] == 0:
                        layer = layer + " - "
                    elif level[level.index(i)] == 1:
                        layer = layer + " O "

                if height == levely:
                    print layer
                    layer = ""

p1 = player()
p1.getPlayerLoc(level)
p1.display(level, 3, 3) 
```

输出是：

```
4
Traceback (most recent call last):
  File "gamy.py", line 28, in <module>
    p1.display(level, 3, 3)
AttributeError: player instance has no attribute 'display' 
```

这很奇怪，因为它获取了属性getPlayerLoc，但没有显示。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:48:56.903

也许你有一些缩进问题。可以在您的 ide 中启用“显示空白”功能。

尝试将您的显示方法移到 getPlayerLoc 上方。如果 getPlayerLoc 失败，它将指示缩进错误。

# android - 将 ToggleButton 开/关文本设置为空

> ID：10789099
> 
> 赞同：1
> 
> 时间：2012-05-28T18:41:20.907
> 
> 标签：android, android-widget

我正在尝试使用此代码：

```
actionToggleButton=new ToggleButton(context);
actionToggleButton.setTextOn(null);
actionToggleButton.setTextOff(null); 
```

但我仍然得到默认文本！我怎样才能清除它？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:58:41.113

试试这个：

```
 ToggleButton button = new ToggleButton(this);
    button.setText(null);
    button.setTextOn(null);
    button.setTextOff(null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-20T14:30:59.933

您也可以通过`textOn`and`textOff`属性在 XML 中执行此操作：

```
 <ToggleButton
        android:id="@+id/toggle_filter"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textOn="@null"
        android:textOff="@null"/> 
```

# java - 启动服务后活动挂起

> ID：10789101
> 
> 赞同：1
> 
> 时间：2012-05-28T18:41:22.687
> 
> 标签：java, android, android-service, android-activity

我有一个在 android 设备上运行的服务器作为`Service`. 我希望用户输入客户号码，然后服务启动。有没有更好的方法来解决这个问题，而不是将数据从活动传递到服务？

此外，当我使用上述方法时，客户端似乎挂起并强制应用程序销毁。这是代码：

```
String a = clients.getText().toString();
Bundle bundle = new Bundle();
bundle.putCharSequence("NumberOfClients", a);           
Intent intent = new Intent(Manage.this, Server.class);
intent.putExtras(bundle);
Log.d("hi", a);
startService(intent); 
```

这是服务器：

```
@Override
public void onCreate() 
{                         
    Thread server = new Thread(new ServerThread());
    server.start();                 
}

public int onStartCommand(Intent intent, int flags, int startId) {
     super.onStartCommand(intent, flags, startId);       
     Bundle bundle = new Bundle();
     bundle = intent.getExtras();
     numberofclients = (String) bundle.getCharSequence("NumberOfClients");
     int a = Integer.parseInt(numberofclients);     

     return a;
    } 
```

当我点击按钮连接到服务器时，客户端挂起。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:12:35.470

onStartCommand 应该返回一个关于如何处理服务的预定义值。看起来您想要一个 START_NOT_STICKY 所以在 onStartCommand 的 return 语句中，这就是您要返回的内容。IE

```
return START_NOT_STICKY; 
```

如果您想保存整数 a 以在服务中的其他地方使用，请创建一个全局变量并将其设置为等于 a。

参考 Android Docs on Service [http://developer.android.com/reference/android/app/Service.html#START_CONTINUATION_MASK](http://developer.android.com/reference/android/app/Service.html#START_CONTINUATION_MASK)

# c# - 引用的程序集无法识别

> ID：10789104
> 
> 赞同：1
> 
> 时间：2012-05-28T18:41:38.270
> 
> 标签：c#, .net, visual-studio-2010

在我的 C# 项目中，我添加了对“Microsoft.ExtendedReflection”的托管引用。

我可以在 Visual Studio 的“对象浏览器”中看到这个程序集并浏览它的类，但是当我尝试在我的代码中使用它时

```
using Microsoft.ExtendedReflection.Utilities; 
```

我收到以下错误：

> 错误 22 名称空间“Microsoft”中不存在类型或名称空间名称“ExtendedReflection”（您是否缺少程序集引用？）

这很奇怪，只发生在这个程序集中（它是 Pex 的一部分，我引用的其他程序集没有这样的问题）。这可能是什么原因？

![在此处输入图像描述](../Images/4aa9fa9696f8b49061236f64e1c8463a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:44:11.727

您的屏幕截图显示了正在添加到`PexMe`项目中的引用，但项目中出现了错误`PexMeHelper`。您是否也忘记在该项目中添加引用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:45:05.907

我会说依赖程序集需要完整版本的框架，而您的项目只需要客户端配置文件。尝试将您的项目切换到完整。

# visual-studio-2010 - 同步文件在同步时更改文件

> ID：10789107
> 
> 赞同：2
> 
> 时间：2012-05-28T18:41:51.577
> 
> 标签：visual-studio-2010, synchronization, microsoft-sync-framework

我想知道是否可以在以下场景中使用 Microsoft 同步框架。

我有一个带有高分辨率图像的本地文件夹（带有子文件夹）和另一个带有低分辨率图像的文件夹。我想同步两个文件夹。关键是low文件夹中的结构和文件必须与high文件夹中的相同，但图像必须是低分辨率的。显然图像不一样，所以我猜同步框架无法处理这个问题。

如果框架允许在同步时同步修改它们的文件，那将是完美的。这太棒了，但我想这超出了框架可以处理的范围，所以我在考虑某种半自动同步。我的意思是，让框架检测更改，读取这些更改并根据这些更改执行我自己的创建/删除文件操作。

这可能吗？有没有其他方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:43:30.130

Sync Framework 中的文件同步提供程序具有预览模式，可让您检测更改而无需进行实际同步...然后您可以循环通过更改并进行其他处理...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T08:34:25.727

我最接近解决类似问题的方法如下：

*   将文件夹设置为“假同步”；并在该文件夹中执行完全同步（不是在预览模式下，实际同步）。

*   将 SyncOrchestrator LocalProvider 设置为假文件夹的提供者，并将提供者设置为 ExplicitDetectChanges。

*   故意不要为您的假提供者调用 DetectChanges()（我们真的不想知道假文件夹中发生了什么）。

*   执行同步 (SyncDirectionOrder.Download)，并在 OnApplyingChange 中捕获更改文件的名称。这会将所有文件发送到假文件夹并更新元数据

*   删除 fake 文件夹中除元数据文件外的所有文件。

下次同步时，fake 文件夹中的元数据文件应保留更改，因此仅显示更改的文件。我知道我的情况与您的情况有些不同，但希望无论如何它会有所帮助。

# sql - SQL 子选择到 jpql

> ID：10789110
> 
> 赞同：0
> 
> 时间：2012-05-28T18:42:14.973
> 
> 标签：sql, jpa, jpql

我怎样才能用 jpql 语法编写这个 sql？

```
SELECT
SUM(t1.preise)
FROM
 (
SELECT
  preise
FROM
  `preistabelle`
ORDER BY
  `pid` DESC
LIMIT
  6  
 ) as t1 
```

它是一个子选择。如果我尝试这样的事情，我会得到一个错误：

SELECT sum(t1.preise) FROM (SELECT a.totalGRP FROM preise a) as t1

错误是意外令牌“（”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:49:02.643

你不能。JPQL 不支持它。

# javascript - 使用 knockout.js 隐藏/取消隐藏时不应用 jquery UI 主题

> ID：10789113
> 
> 赞同：0
> 
> 时间：2012-05-28T18:42:40.310
> 
> 标签：javascript, jquery-ui, knockout.js

我在后 DOM 初始化的底部有这个：

```
$("button, input:submit, input:button").button(); 
```

这适用于屏幕上的所有按钮，但稍后显示的按钮没有应用主题。我正在使用 knockout.js 中的“可见”绑定支持来根据页面上的用户交互显示表单。无论何时创建，将 jqueryUI 主题应用于所有内容的干净方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:08:35.057

不，它不会，因为除非您继续重新应用那里的 jquery 按钮代码，否则不会转换新按钮。

但是，有一个更好的方法来使用处理程序，例如，我使用这个......

```
 ko.bindingHandlers.button = {
        init: function (element, valueAccessor, allBindingsAccessor) {
            var options = allBindingsAccessor().buttonOptions || {};
            $(element).button(options);

            ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
                $(element).button("destroy");
            });

        }
    }; 
```

现在您可以将事物绑定为按钮。例如

```
<button data-bind='button:{}, buttonOptions:{icons: {primary: "ui-icon-pencil"}}'  onclick=""> 
```

# java - Java 中的 & 等于运算符是干什么用的？

> ID：10789119
> 
> 赞同：5
> 
> 时间：2012-05-28T18:43:24.147
> 
> 标签：java, operators, code-analysis

Java有`&=`运算符吗？我看到了这段代码：

```
boolean allReady = true;            
for(Entry<String,Boolean> ace : factory.readyAces.entrySet()) {
    allReady &= ace.getValue(); 
```

是什么`&=`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:45:20.283

它与以下内容相同：

```
allReady = allReady & ace.getValue(); 
```

这是一个有点明智的和。这意味着你总是评估双方，然后采取“逻辑与”（结果只有在双方都为真时才为真）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T18:45:15.140

这是按位与运算的捷径

```
allReady = allReady & ace.getValue(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T18:47:53.770

这是一个按位与赋值运算符。相当于做：

```
allReady = allReady & ace.getValue(); 
```

# java - Web 服务或 Jms

> ID：10789123
> 
> 赞同：0
> 
> 时间：2012-05-28T18:43:47.147
> 
> 标签：java, web-services, asp-classic, jms

目前我负责一项服务：在远程服务器上进行 Http Get 调用，为使用 asp（没有 .net 的普通 asp）的手机充电。URL 看起来像 charge.asp?param=provide Ai amount 100 Num 9999999
服务器大约需要 10 秒为手机充值然后发送响应。由于客户端应用程序使用 Java EE 技术，哪种 Java EE 技术最适合此场景（Web 服务、JMS 等）？同步和异步请求呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T18:47:27.467

由于涉及两种不同的技术，我建议使用 webservice，因为它使用行业标准而不是 Java 标准，

由于这本质上是事务性的，因此消息应该是同步的，因为通常用户更方便等待而不是稍后收到有关成功或失败的通知，如果等待时间长那么它可能是另一回事，但通常 10 秒是可以接受。

如果您的容量规划建议等待 10 秒会使服务器处于极端负载状态，请采取异步方法，同时确保通知用户成功或失败。

[WS 架构](http://java.sun.com/blueprints/webservices/using/webservbp3.html)

[WS 中的事务](http://www.ibm.com/developerworks/xml/library/x-transws/)

# c++ - Size of array (new[])

> ID：10789124
> 
> 赞同：2
> 
> 时间：2012-05-28T18:43:55.237
> 
> 标签：c++, arrays, new-operator

In debug heap I can get size of array, which was created by `new[]`:

```
int size = *((int *)((char *)ptr - 16)); 
```

It is working correctly if the size of the array is less than 28 (but I don't know why? 0_0).

Does this trick working in release mode (not using debug heap)?

How I can get size of the array (100% working and stable)?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:46:12.177

You are relying on an implementation detail. That's how your particular implementation stores the size of the memory region where the array is placed. As you already see, the size of the memory region may be bigger than the size of the allocated array.

If you need to know the size of an array allocated with `new[]`, you'll have to keep that value around.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-28T18:45:57.083

Like this:

```
std::vector< int > array( 1024 ); // allocate 1024 element array.
int size = array.size();
int sizeInBytes = size * sizeof( int ); 
```

;)

It really is the best way what you are trying to do is take adavantage of something which is COMPLETELY compiler/library dependent ... Its a really bad thing to do, in general, as your code becomes completely unportable not even mentioning that the next version of your compiler may come with a different memory allocation implementation which breaks what you are trying to do ...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T18:48:26.280

任何涉及从 CRT 中挖掘某些东西的方式都是未定义的，并且不能 100% 工作。
您唯一的方法是覆盖运算符 new[] ，它将在某个定义的位置存储大小，例如分配具有大小前缀的更大对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T19:02:31.583

正如其他人所提到的，您正在使用实现细节来确定分配数组的大小。您已经设法弄清楚，如果您从返回的指针的开头向后走 16 个字节，`new[]`您可以获得数组的大小。

16 字节的额外分配似乎过多，如果您编译应用程序的发布版本，则很可能不会出现这种情况。该实现可能会在您请求的长度之前和之后分配一些额外的字节，并用魔术值填充它以帮助捕获超出数组边界的代码。这个额外的空间可能不会在发布版本中分配。

此外，您自己提到，如果数组大小小于某个阈值，则 16 字节数似乎不再有效。如果您分配的对象比您现在分配的任何对象都大，那么您可能必须走得更远才能达到大小。

因此，您可以使用的解决方案是：

*   继续分配使用`new[]`并保持大小以供以后使用
*   使用`std::vector`并获取大小使用`std::vector::size`
*   如果事先知道数组的大小，并且不需要调整它的大小，请使用`std::array`. 请注意，此选项不会在堆上分配内存（当然除非您`new`自己`std::array`）

# html - CSS 背景图片边框

> ID：10789132
> 
> 赞同：0
> 
> 时间：2012-05-28T18:44:35.533
> 
> 标签：html, css, html-table

```
td.back {
    background:#000 url('0.jpg');
        } 
```

如何使背景图像看起来像`<img border="4" src="0.jpg"/>`

有任何想法吗？

html代码：

```
<table>
<table>
  <tr>
    <td></td>
    <td class="back"><img src="gif1.gif"/></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:11:44.210

试试这个：

```
td.back {
    background:#000 url('0.jpg');
    border: 4px solid #000;
        } 
```

[http://jsfiddle.net/ER4LB/或者您可以在](http://jsfiddle.net/ER4LB/)[w3schools](http://www.w3schools.com/css/css_border.asp) 中选择其他边框选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:46:23.707

```
 td.back {
        border-image:url('0.jpg');
        border: 4px solid #000;
}​ 
```

# java - Maven, GWT and Eclipse project

> ID：10789143
> 
> 赞同：1
> 
> 时间：2012-05-28T18:45:55.563
> 
> 标签：java, eclipse, gwt, maven, m2eclipse

I'm trying to setup new web project using newest Maven, GWT and Eclipse. I'm trying to generate it with available archetype from GWT Maven Plugin with command:

> mvn archetype:generate -DarchetypeGroupId=org.codehaus.mojo -DarchetypeArtifactId=gwt-maven-plugin -DarchetypeVersion=2.4.0 -DarchetypeRepository=repo1.maven.org

Running mvn gwt:run builds project, appication starts and everything seems to be ok. The problem appears when I'm trying to import this project as "Maven Project" into Eclipse Indigo. I'm getting mvn warning

> Description Resource Path Location Type maven-war-plugin goals "inplace", "exploded", "manifest" are ignored by m2e pom.xml /contactmanager line 93 Maven Project Build Lifecycle Mapping Problem

and many Java errors like

> *   Resource Path Location Type GreetingService cannot be resolved to a type GwtTestContactManager.java /contactmanager/src/test/java/com/jeffmaury/contactmanager/client
>     
>     
> *   Missing asynchronous interface GreetingServiceAsync

It seems like something has changed and the newest gwt, m2eclipse, eclipse indigo and mvn can't work together properly.

Is there any way to fix this basic GWT project after importing into Eclipse? And to run this generated application from IDE?

Btw I've followed also many tutorials (e.g. [http://riadiscuss.jeffmaury.com/2011/06/tutorial-maven-gwt-plugin-google.html](http://riadiscuss.jeffmaury.com/2011/06/tutorial-maven-gwt-plugin-google.html)) but without success. Almost all of them were deprecated...

Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:27:51.397

你可以尝试在你的项目 pom 中添加这样的东西：

```
<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>org.apache.maven.plugins</groupId>
                                    <artifactId>maven-war-plugin</artifactId>
                                    <versionRange>[2.0,)</versionRange>
                                    <goals>
                                        <goal>inplace</goal>
                                        <goal>exploded</goal>
                                        <goal>manifest</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <ignore />
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:05:29.873

maven 和 gwt 很难做到正确......我认为各种插件导致的问题多于解决的问题......

创建项目后，我使用 mvn eclipse:eclipse 创建 eclipse 文件

然后去调试

mvn gwt:调试

它在 Eclipse 之外启动托管模式并在端口 8000 上侦听调试器连接...

然后通过从 Eclipse 连接到远程应用程序进行调试....

我不是 100% 确定我是否按照您描述的方式创建了我的项目……我想是的，但已经有一段时间了

# html - 在css中居中一个元素

> ID：10789148
> 
> 赞同：0
> 
> 时间：2012-05-28T18:46:16.873
> 
> 标签：html, css, centering

我确信这个问题已经被问过了，通常我可以用 margin: 0 auto; 来完成这个问题。或其他东西，但在这个网站上：otgtires.com 我似乎无法让顶部的导航栏在其父元素内居中。我会在这里粘贴一些代码，但我认为在浏览器中使用开发工具更容易。请让我知道我错过了什么！

编辑：如果它看起来已经居中，请缩小。

因此，如果您放大网站上的浏览器，您会看到所有其他元素保持相对位置，但导航栏保持在左侧。无论用户窗口如何放大/缩小，我都希望导航栏保持在页面的中心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:54:19.897

它不是“居中”的，因为它当前使用的是基于百分比的宽度。尝试使用固定宽度：

```
#top_navigation {
    width: 500px;
    margin: 0 auto;
    } 
```

编辑：

此外，请考虑使用以下清除修复，因为导航元素是内联的，并且当浏览器宽度缩短时，下面的内容往往会混淆：

```
#top_navigation {
    overflow: hidden;
    } 
```

这是您的网站的屏幕截图，上面注入的代码演示了水平居中：

![在此处输入图像描述](../Images/e487073033e8fd4c6ff07c1ded7c9230.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:12:05.130

```
#top_navigation {
width: 1125px;
margin: 0 auto 0 auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:06:58.047

@gmeben 是正确的，因为您的

```
#top_navigation { width: 100% } 
```

我很快将其更改为

```
#top_navigation { width: 1125px; margin: 0 auto; } 
```

它居中。

# bash - Using getopts to store a filename as an argument

> ID：10789151
> 
> 赞同：0
> 
> 时间：2012-05-28T18:46:24.200
> 
> 标签：bash, for-loop

I'm trying to learn to use the getopts() feature in bash to parse my arguments, but my program requires that in addition to my standard -a -b -c type arguments I also need to get any number of files to work on, and I can't find any information on how to make getopts recognize them instead of throwing them out as invalid arguments. Here's an example:

```
while getopts "a:b:c:d" flag
do

    echo Doing: "$flag" $OPTIND $OPTARG

    if [ "$flag" = a ]; then
        first="$OPTARG"
        echo Found argument: $first
    fi 
```

... and so on with other if statements. This works great if my program just needed a command like: program -a -c , but instead I need to take in something like: program -a file.sh -c otherfile.sh.

Can somebody show me an example of how to do something like this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:11:47.077

这是我的一个 shell 脚本的片段，它[`getopts`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html)或多或少地使用和执行您想要做的事情：

```
arg0=$(basename $0 .sh)

usage()
{
    echo "Usage: $arg0 [-qvF] [-s suffix] -j jdcfile file.msd" 1>&2
    exit 1
}

error()
{
    echo "$arg0: $*" 1>&2
    exit 1
}

Fflag=
suffix=
jdcfile=
qflag=
vflag=no
while getopts Fj:qs:v opt
do
    case "$opt" in
    (F) Fflag="-F";;
    (j) jdcfile="$OPTARG";;
    (q) qflag="-q";;
    (s) suffix="$OPTARG";;
    (v) vflag=yes;;
    (*) usage;;
    esac
done

shift $(($OPTIND - 1))

case $# in
(1) : OK;;
(*) usage;;
esac

if [ -z "$jdcfile" ]
then error "you did not specify which jdcfile to use (-j option)"
fi

msd_file=$1 
```

我认为这`shift`是您缺少的部分。`getopts`那以及在处理循环之后对命令行上剩余参数的后续处理。

在这个特定程序的最后`"$@"`，应该处理一个文件名。对于此特定程序，没有文件或列出多个文件是错误的。您可以删除该最终版本`case`或对其进行修改以满足您的需要。此代码还强制执行`-j jdcfile`“选项”；它是一个强制参数，如使用消息中所示。

之后的一个更典型的模式`shift`是：

```
for file in "$@"
do
    ...processing of $file...
done 
```

这只是让您处理零文件名的情况。

`error`和`usage`函数也是有用的大纲/原型。`:`如评论中所述，如果您希望在选项字符串上使用前导，您可以负责错误处理。我选择不这样做，但我忘记了这是我做出的决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:29:51.700

根据我上面的评论 - 你不想要`getopts`这个。一种更简单的方法将起作用：

```
#!/bin/bash

args=()

for arg in "$@"
do
  case "$arg" in
    "-a" )
      echo "We have an '-a'!"
      ;;
    "-b" )
      echo "We have a '-b'!"
      ;;
    * )
      args+=($arg)
  esac
done

echo And we have these arguments: ${args[*]} 
```

要查看它运行：

```
$ ./program one -a two three -b four
We have an '-a'!
We have a '-b'!
And we have these arguments: one two three four 
```

# c# - 如何检查目录下是否存在特定目录？

> ID：10789155
> 
> 赞同：0
> 
> 时间：2012-05-28T18:46:56.750
> 
> 标签：c#, .net

如何检查`Test`路径下是否存在目录`C:\mypath\is\here`？

```
String[] getAllSubDirs = Directory.GetDirectories(directory, Match, SearchOption.AllDirectories);

foreach (String subDir in getAllSubDirs)
{
    if (!subDir.Contains("test"))
    {
        ListViewItem list = new ListViewItem(subDir);
        list.SubItems.Add("N/A");
        listView.Items.Add(list);
        listView.EnsureVisible(list.Index);
    }
} 
```

我想打印出那些没有名为`Test`present 的文件夹的目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:49:07.577

代替

```
!subDir.Contains("test") 
```

做

```
!Directory.Exists(Path.Combine(subDir, "Test")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:48:59.633

您可以使用

```
Directory.Exists(Path.Combine(subDir, "test")) 
```

或者如果您只知道完整路径：

```
Directory.Exists("C:\mypath\is\here\test") 
```

# java - When Servlet Destroy the Value of Declared Variable

> ID：10789158
> 
> 赞同：0
> 
> 时间：2012-05-28T18:47:10.897
> 
> 标签：java, jakarta-ee, servlets

I declare List in Servlet for temporary hold the data, before inserting database:

```
List poList= new ArrayList(); 
```

First time user enter the data,and then after 10-15 or 30-45 minutes he enter more data.

Does old data is available in Servlet or Servlet Destroy the all previous entered data after prescribed time ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:53:44.340

不要那样做。这个 webapp 的所有用户只有一个 servlet 实例。这意味着所有用户将同时将数据存储在同一个列表中。HTTP 会话是存储与特定用户相关的数据的地方，其生命周期必须跨越多个请求。

第一个请求：

```
request.getSession().setAttribute("myList", list); 
```

第二个请求：

```
List<Something> myList = (List<Something>) request.getSession().getAttribute("myList); 
```

另请注意，destroy 无关紧要：在应用程序结束时调用destroy（例如，因为服务器已停止）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:53:05.487

如果您想为每个用户存储数据，这将无法满足您的目的。将其`poList`添加到`HttpSession`as 属性中。在`doPost()`/`service()`方法中对其进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T18:50:36.450

这取决于。如果您的 poList 在单例中或被声明为静态列表，则值将保留在您的 poList 中。

# jboss - 如何从默认的 JBoss 服务器配置中删除 Hypersonic？

> ID：10789159
> 
> 赞同：3
> 
> 时间：2012-05-28T18:47:12.690
> 
> 标签：jboss, hsqldb, jboss5.x

JBoss 附带 Hypersonic 数据库开箱即用。JNDI 名称为 DefaultDS，描述符存储在 deploy/hsqldb-ds.xml 中。RedHat 建议在部署生产 JBoss 实例之前删除此数据源。RedHat 不支持运行 Hypersonic 的生产实例，已知存在以下问题：

*   没有隔离事务
*   线程和套接字泄漏
*   坚持品质
*   数据库损坏
*   负载下的数据库不稳定
*   不支持集群环境

那么我该如何移除它呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T18:52:53.920

仅删除数据源还不够好，因为您会遇到缺少依赖项错误：

```
DEPLOYMENTS IN ERROR: Deployment "jboss.ejb:service=EJBTimerService" is in error due to the following reason(s): ** NOT FOUND Depends on 'jboss.ejb:service=EJBTimerService' ** 
```

要干净地删除 Hypersonic 而不会出现依赖错误，您必须执行以下操作：

1.  删除部署/hsqldb-ds.xml
2.  删除 deploy/uuid-key-generator.sar
3.  删除部署/消息传递（如果您不使用它）
4.  删除 deploy/juddi-service.sar/ 和 deploy/snmp-adaptor.sar
5.  编辑 conf/standardjbosscmp-jdbc.xml，并注释掉 defaults 部分
6.  编辑 conf/login-config.xml，并删除“HsqlDbRealm”应用程序策略
7.  编辑deploy/ejb2-timer-service.xml注释掉数据库持久化策略，注释noop持久化策略，将EJBTimerServiceImpl持久化策略改为noop from database

完成这些步骤后，您应该不会再在启动时遇到依赖错误。但是，您会间歇性地看到以下警告：

```
WARN  [loggerI18N] [com.arjuna.ats.internal.jta.recovery.xarecovery1] Local XARecoveryModule.xaRecovery  got XA exception javax.transaction.xa.XAException: Error trying to connect to provider java:/DefaultJMSProvider, XAException.XAER_RMERR 
```

要解决此警告消息，您需要编辑 conf/jbossts-properties.xml 并注释掉 JBMESSAGING1 java:/DefaultJMSProvider 策略

完成所有这些步骤后，您应该已成功删除 Hypersonic。确保已完成正确的步骤（数据源等）以使用更好的替代数据库:-)

# racket - 我如何在 Dr Racket 中取消定义？

> ID：10789160
> 
> 赞同：2
> 
> 时间：2012-05-28T18:47:13.830
> 
> 标签：racket

在构建某些功能时，我可能会犯一些错误。发生这种情况时，我单击 RUN 并且必须重新输入所有以前的定义和新的尝试。

有什么方法可以“取消定义”前一个`(define (func args ...) body)`并继续前进吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:51:57.597

首先，行为是设计使然。变量不能在模块外改变。这使优化器有机会内联各种事物。有关详细说明，请参阅[http://docs.racket-lang.org/guide/module-set.html](http://docs.racket-lang.org/guide/module-set.html) 。

如果您需要修改模块内部的某些内容，那么标准的做法是使用参数。

这是一个快速 hack（我的意思是 hack），它滥用参数使重新定义成为可能。

要将函数声明为可重新定义，请使用`redefineable`. 在这个例子中，一个函数`foo`被声明为可重定义的。

```
#lang racket

(define-for-syntax (make-current-name stx id)
  (datum->syntax 
   stx (string->symbol
        (format "current-~a" (syntax-e id)))))

(define-syntax (redefine stx)
  (syntax-case stx ()
    [(_ (name arg ...) body ...)
     (with-syntax ([current-name (make-current-name stx #'name)])
       #'(current-name (lambda (arg ...) body ...)))]))

(define-syntax (redefineable stx)
  (syntax-case stx ()
    [(_ name)
     (with-syntax ([current-name (make-current-name stx #'name)])
       #'(begin
           (define current-name (make-parameter (λ x (error 'undefined))))
           (define (name . xs)
             (apply (current-name) xs))))]))

(redefineable foo)

(redefine (foo x) (+ x 1)) 
```

现在运行程序，在交互窗口中，我们现在可以执行以下操作：

```
Welcome to DrRacket, version 5.3.0.6--2012-05-11(9401a53/a) [3m].
Language: racket.
> (foo 41)
42
> (redefine (foo x y) (* x y))
> (foo 2 3)
6 
```

# git - git says files have been modified but I havn't touched them

> ID：10789163
> 
> 赞同：4
> 
> 时间：2012-05-28T18:47:36.267
> 
> 标签：git

I work on Mac OS, but to date this problem has only occurred on my MacBook Air with an SSD hard drive. I do a fresh checkout of a number of different repos and `status` shows me a long list of modified files (without touching anything). It seems to be third party javascript and css files. That with what else I've read seems to be line endings, but despot setting:

```
git config --global core.autocrlf input 
```

As suggested here [http://help.github.com/line-endings/](http://help.github.com/line-endings/) and then checking out. Has the same problem.

Help =(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:30:49.420

正如另一个答案所指出的，

```
git config --global core.autocrlf false 
```

如果您有将行结尾正确存储为 crlf 的文件，您还应该禁止突出显示“cr”。Git diff 和其他补丁输出将突出显示可能有问题的空白。您可以通过以下方式抑制它：

```
git config --global core.whitespace cr-at-eol 
```

请记住，`--global`当您以同一用户身份登录机器时，这将使您的所有存储库都有效。要将设置应用于任何用户，请`--system`改用。相反，您可以使用`--local`. `--local`如果没有给出范围选项，则隐含。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:20:01.497

先试试吧：

```
git config --global core.autocrlf false 
```

这将阻止任何“自动”转换。

另请参阅“[使用代码分发 git 配置](https://stackoverflow.com/questions/2333424/distributing-git-configuration-with-the-code/2354278#2354278)”以了解管理 eol 的替代方法。

# python - How to prevent python from using orphaned .pyc files? (ones with no matching .py files)

> ID：10789165
> 
> 赞同：18
> 
> 时间：2012-05-28T18:47:55.970
> 
> 标签：python, bytecode, pyc

Once in a while I run into a very difficult-to-debug problem: there's a leftover .pyc file somewhere in my $PYTHONPATH, and the matching .py file has been moved to somewhere else that's later in $PYTHONPATH - so when I try to import the module, the "orphaned" .pyc file is used and all changes to the "real" .py file are ignored, leaving me incredibly confused until I figure out that's what's happening.

Is there any way of making python *not* use "orphaned" .pyc files, or print a warning when using them?
Alternatively, does the fact that I have this problem at all mean I'm doing something wrong, and if so, what?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T18:53:52.767

试试这个（[见这里](http://docs.python.org/using/cmdline.html#envvar-PYTHONDONTWRITEBYTECODE)）：

> `PYTHONDONTWRITEBYTECODE`
> 
> 如果设置了此项，Python 将不会尝试在导入源模块时写入`.pyc`或文件。`.pyo`这相当于指定`-B`选项。
> 
> 2.6 版中的新功能。

但是有一个与之相关的问题：您将失去拥有`.pyc`文件的好处（从而失去性能）。更好、更干净、更友好的方法是**遍历目录并清理`.pyc`不需要的孤立文件**。您应该使用脚本来执行此操作，并确保您没有不应该与`.pyc`文件相关联`.py`的文件（例如，用于某种程度的混淆）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T19:22:55.017

如果 Python 在其路径中找到它们，则不能阻止 Python 加载 .pyc 文件，不。

你有几个选择：

1.  导入有问题的模块并找出它的路径是什么：

    ```
    >>> import borkenmod
    >>> import sys
    >>> sys.modules[borkenmod.__name__].__file__
    'lib/python2.7/borkenmod.pyc' 
    ```

2.  使用[脚本遍历您的 PYTHONPATH 并删除陈旧的字节码文件](http://pss.csse.rose-hulman.edu/redmine/projects/pss/repository/entry/src/remove-stale-bytecode?rev=master)。链接脚本会删除不存在对应文件的*所有* 文件。`.pyc``.py`

3.  擦除 PYTHONPATH 中的所有 .pyc 文件，并让 Python 使用[`compileall`模块](http://docs.python.org/library/compileall.html)重新生成它们：

    ```
    python -m compileall [path] 
    ```

    然后删除那个文件。

请注意，最后两个选项可能会导致合法的 python 模块被删除！一些 python 模块（尤其是商业许可的）仅作为编译后的字节码分发。

# java - 如何在 SOLR 中将布尔值转换为整数？

> ID：10789170
> 
> 赞同：3
> 
> 时间：2012-05-28T18:48:18.013
> 
> 标签：java, sorting, solr, lucene, schema

我维护一个包含列表的商店，其中一些是高级会员。我试图在搜索结果顶部 25 公里范围内获得高级会员，其余列表按最近附近排序。

为了表明列表是优质的，我定义了布尔字段 listing_premium。

```
<field name="listing_premium" type="boolean" indexed="true" stored="true" /> 
```

如果我可以通过将距离映射到查询 (listing_location) 并将其与表示布尔值的整数相乘 (true = 1, false = 0) 在排序子句中使用此布尔值，那将很容易

以下不起作用，因为 listing_premium 是一个布尔值......

```
&sort=mul(map(geodist(listing_location),0.0001,25,1,0),listing_premium)+desc,geodist(listing_location) asc 
```

我的问题是：

*   我可以以某种方式将 listing_premium 映射到 0 或 1
*   或者我可以在排序中包含一个 if 语句
*   或者我可以在模式中使用 copyField 来创建一个生成的字段，将 Listing_premium 转换为 Listing_premium_int

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T05:47:49.807

布尔值可能不是 0 和 1。您可以使用 if() 函数基于此选择值。

这个表达式：

```
if(listing_premium,1,0) 
```

如果 listing_premium 为真，则返回 1；如果为假，则返回 0。

# asp.net - Azure c#、javascript、sql 的 DateTime 问题....很困惑。

> ID：10789176
> 
> 赞同：0
> 
> 时间：2012-05-28T18:48:45.637
> 
> 标签：asp.net, json, datetime, timezone

好的，所以我的网站允许人们存储他们的工作时间表。他们输入班次开始日期时间和结束日期时间。很简单，对吧？

我的想法是我可以查看该站点，并看到 Bob 今晚 4 ​​点到 6 点在芝加哥工作，而 Joe 晚上 8 点到 10 点在纽约工作。这就是我希望在应用程序中显示日期的方式。如果我从加利福尼亚查看该站点，我仍然想为 Bob 显示芝加哥时间，为 Joe 显示纽约时间。我不想将那些时间转换为加利福尼亚时间，它会显示鲍勃从下午 2 点到 4 点工作，而乔从下午 5 点到 7 点工作。

我的网站有示例数据，当所有内容都位于同一时区时很好，但我现在已将其部署到美国中北部的 Azure 服务器（它也使用位于那里的 SQL Azure，尽管我不清楚那里有） ，现在日期和时间都关闭了（向前跳了 7 小时）。

我相信这样做的原因是我使用了很多 Ajax 和 JSON，而 JSON 要求将日期时间格式化为 /Date(1240718400000)/，其中数字表示自纪元/Unix 时间以来的毫秒数。我在日历/周/或日视图中显示日程安排，这需要大量的 javascript 日期时间比较。

无论如何，有人知道正确的方法来做我需要做的事情吗？我想我需要将日期时间存储为 UTC，但我还需要知道用户工作班次发生的时区，然后我需要在 C# 端进行调整，但是我需要做任何事情吗在javascript方面？

我只是感到困惑，目前似乎有太多变数无法解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T05:53:14.240

我认为你在正确的轨道上。

在多个时区访问的任何 Web 应用程序的第一条经验法则是以 UTC 格式存储时间，因为以 UTC 格式存储日期/时间值的主要优点是它通过提供通用参考点使数据可传输所有时区都被抵消了。

在您的情况下，最好存储用户时区，以便您可以根据此信息呈现时间。

当您读取 UTC 日期/时间和用户时区时，您可以直接在您的 C# 代码中计算它并将此数据作为常规字符串传递给您的视图，或者因为这实际上是为您的用户使用的数据而不是日期。如果您使用的是 JS，请不要执行以下操作，因为它会根据用户浏览器区域设置时间，而不是我会说只是作为字符串传递：

```
var datetime = new Date('May 29, 2012 2:52 AM UTC');
var formattedDateTime = dt.toLocaleString(); 
```

# php - Joomla - 如何根据来自外部 php 的会话 ID 重新启动会话

> ID：10789190
> 
> 赞同：1
> 
> 时间：2012-05-28T18:50:09.023
> 
> 标签：php, joomla

我正在尝试将 SWFUpload 集成到 Joomla 中（自定义实现，这就是为什么不能将扩展与 swfupload 一起使用）。

如果 SESSION 并且在服务器端我需要为传递的 ID 获取 $_SESSION 的所有数据，我正在通过 SWFUpload ID。

这是我拥有的代码（直接脚本访问）：基于[本教程](http://jeffbrand.net/programming/using-session-cookies-with-swfupload-despite-the-bug-in-adobes-flash-plugin/)

```
if (isset($_POST["PHPSESSID"])) {
    session_write_close();             // End the previously-started session
    session_id($_POST["PHPSESSID"]);   // Set the new session ID
    session_start();                   // Start it
} 
```

这是我在 SWFUpload 调试窗口中遇到的错误：

```
Fatal error: session_start(): Failed to initialize storage module: user (path: /var/lib/php5) in /srv/www/htdocs_appsrv/.../incoming.php on line 19 
```

第 19 行是

```
session_start(); 
```

如何重新启动具有会话 ID 的会话，然后从 $_SESSION 中获取所有需要的数据？

请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T13:45:31.400

好的，下面的代码似乎工作

```
if (isset($_POST["PHPSESSID"])) {
    session_write_close();             // End the previously-started session
    $jd = new JSessionStorageDatabase();
    session_id($_POST["PHPSESSID"]);   // Set the new session ID
    session_start();                   // Start it
} 
```

我发现基于[本教程](http://pribadidewa.wordpress.com/2008/04/07/session-management-in-joomla/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T00:51:02.363

你有没有尝试过：

```
JFactory::getSession()->destroy(); 
```

# nginx - 有没有办法在nginx中获取当前时间？

> ID：10789194
> 
> 赞同：12
> 
> 时间：2012-05-28T18:50:31.320
> 
> 标签：nginx

我正在尝试将 nginx 服务器的时间注入 HTTP 标头。

我可以添加到 HTTP 标头，如下所示：

```
proxy_set_header HELLO-WORLD 'something'; 
```

但是现在，我希望能够将时间注入 HTTP 标头，如下所示：

```
proxy_set_header THE-TIME $time_var; 
```

或类似的东西。

那可能吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-28T21:20:17.827

您可以使用 SSI 模块中的变量：$date_gmt 和 $date_local

```
proxy_set_header THE-TIME $date_gmt; 
```

[http://nginx.org/en/docs/http/ngx_http_ssi_module.html#variables](http://nginx.org/en/docs/http/ngx_http_ssi_module.html#variables)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-04-09T20:14:27.510

`$time_iso8601`对机器和人类都很友好。

# android - 如何在android中的网站上单击按钮

> ID：10789195
> 
> 赞同：0
> 
> 时间：2012-05-28T18:50:31.503
> 
> 标签：android, web, hyperlink, click

我正在使用 Jsoup 解析网站。一切正常，但网站上有 2 个链接（例如“+”和“-”来评价故事）

例如，“+”的链接：

`<a class="votelink" href="/vote/yes/985dbab6-9bfb-11e1-99eb-f23c91df8b43">bla bla bla</a>`

此链接的网站上的 js 函数是：

```
$(document).ready(function()
{
    $(".votelink").click(function(e)
    {
        $.get(this);
        this.parentNode.parentNode.innerHTML = 'bla bla bla'
        e.preventDefault();
     })
}); 
```

所以我的问题是：如何在我的按钮上添加操作并使用此操作在网站上的链接上单击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:00:16.633

如果您的按钮链接到您可以知道的网址，只需调用它们即可。

否则，使用 webview，加载页面并调用一些 javascript 函数来点击按钮：

[Android 在 WebView 中调用 JavaScript 函数](https://stackoverflow.com/questions/4325639/android-calling-javascript-functions-in-webview)

# objective-c - UISplitViewController 自定义

> ID：10789198
> 
> 赞同：0
> 
> 时间：2012-05-28T18:50:47.533
> 
> 标签：objective-c, user-interface, uiviewcontroller, uisplitviewcontroller

我想添加像 Kayak 这样的侧边栏导航（见图），但我不确定如何。我能想到的唯一方法是将 UIView 添加到我的每个主 ViewControllers 中，然后更改 AppDelegate.window.rootViewController 但我不确定。

另外，我想确保这适用于 UISplitViewControllers，而且我很难自定义这个类。

任何帮助表示赞赏，谢谢。

![皮划艇导航](../Images/9c946127fb5dde9f55b0a00d9c2d6e76.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:29:06.817

我将创建一个具有侧栏的容器视图控制器。然后将其他视图控制器添加到该容器视图控制器作为子视图控制器。通过侧边栏按钮操作，您可以切换（添加/删除...）子控制器的视图（由容器视图控制器处理）。

我没有完全理解你：

如果您想对该侧边栏使用拆分视图控制器

UISplitviewcontroller 有一个 320.0 像素（非视网膜）的主视图（左视图）。苹果不建议更改此值。

或者如果您想在侧边栏旁边使用拆分视图控制器

拆分视图控制器已成为应用程序窗口的根视图控制器。所以这里对它不好。也许您可以创建自己的。

我认为更改窗口的根视图控制器不是一个好主意。即使您这样做，您也需要在每个视图中都有一个侧边栏，这并不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T00:41:43.583

这可能有用。谨慎行事。

[http://seriot.ch/resources/talks_papers/SEVerticalTabBar.pdf](http://seriot.ch/resources/talks_papers/SEVerticalTabBar.pdf)

[https://github.com/nst/SEVerticalTabBar](https://github.com/nst/SEVerticalTabBar)

# c# - 城堡 WCF 设施 | Windows 服务托管

> ID：10789203
> 
> 赞同：1
> 
> 时间：2012-05-28T18:51:01.597
> 
> 标签：c#, wcf, c#-4.0, castle-windsor, wcffacility

我试图在我的 WCF 项目中使用 Castle WCF 集成工具，但在路上迷路了。你能帮帮我吗？

所以，情况如下：

我有一个 WCF 服务库，它通过 TCP 托管在 Windows 服务中。以下是我的 WCF 服务库中的内容：Service Impl：

```
[ServiceContract]
    public interface ICalculatorService
    {
        [OperationContract]
        int Add(int x, int y);
    }

    public class CalculatorService : ICalculatorService
    {
        public int Add(int x, int y)
        {
            return x + y;
        }
    } 
```

配置：

```
 <system.serviceModel>
    <services>
      <service name="namespace.CalculatorService">
        <endpoint address="" binding="netTcpBinding" bindingConfiguration=""
          contract="namespace.iCalculatorService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexTcpBinding" bindingConfiguration=""
          contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8732/CalculatorService/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata httpGetEnabled="false" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

**容器配置**这是在 WCF 项目内部，如果我将所有内容都注册到城堡（我不确定应该在哪里注册 wcf 设施，是否应该从 WCF 服务或托管 WCF 服务的 Windows 服务注册）。

```
 public class ConfigureContainerCastle
    {
        private readonly IWindsorContainer container;

        public ConfigureContainerCastle(IWindsorContainer container)
        {
            this.container = container;
        }

        public void Configure()
        {
            // Any component registration.
            container.Register(Component.For<ICalculatorService>().ImplementedBy<CalculatorService>());
            //All other component registration.
        }
    } 
```

以下是我的 Windows 服务中的内容：

```
 public class Host<T>:ServiceBase
    {
     private ServiceHost serviceHost = null;
            protected override void OnStart(string[] args)
            {
                if (serviceHost != null)
                {
                    serviceHost.Close();
                }

                // How do I call the DefaultServiceHostFactory and start the service?
                // Should I call the WCF facility from here or from WCF service library?
//                var container = new WindsorContainer();
  //              var configureContainer = new DataServicesConfigureContainer(container);
    //            var hostFactory = new DefaultServiceHostFactory(container.Kernel);

                serviceHost = new ServiceHost(typeof (T));
                serviceHost.Open();
            }

            protected override void OnStop()
            {
                if (serviceHost == null)
                    return;

                serviceHost.Close();
                serviceHost = null;
            }
    } 
```

我的 Windows 服务配置（app.config）与我的 WCF 服务相同，逐行逐行。

现在的问题是，我如何将这一切与 WCF 设施连接在一起？我见过很多使用 http 和 global.asax 的例子，但没有一个用于 Windows 服务的例子。你能帮忙吗？即使是适当的链接也会有所帮助。

谢谢，-迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T14:17:22.673

首先是一个小点 - 如果您想要 TCP，您需要使用`net.tcp`协议指定基地址，如下所示：

```
<add baseAddress="net.tcp://localhost:8732/CalculatorService" /> 
```

但这不是你的问题，所以迷恋......

> > （我不确定应该在哪里注册 wcf 工具，是否应该从 WCF 服务注册，还是从托管 WCF 服务的 Windows 服务注册）。

我建议您在靠近您注册服务的地方注册该设施。因此，在 WCF 服务库中 - 事实上，您发布的代码位将是注册它的好地方（只要它被注册，我认为它在哪里没有太大区别）。

> > 现在的问题是，我如何将这一切与 WCF 设施连接在一起？我见过很多使用 http 和 global.asax 的例子，但没有一个用于 Windows 服务的例子。你能帮忙吗？即使是适当的链接也会有所帮助。

实际上非常简单 - 如果您想将配置保留在配置文件中，您可以`Configure`像这样更改您的方法（我假设您已经参考了`Castle.Facilities.WcfIntegration`）：

```
public void Configure()
{
    container.AddFacility<WcfFacility>();

    // Any component registration.
    container.Register(Component
        .For<ICalculatorService>()
        .ImplementedBy<CalculatorService>()
        .AsWcfService());

    //All other component registration.
} 
```

就是这样 - Windsor 现在负责在 WCF 客户端连接到它时提供服务（不要相信我 - 将一些依赖项添加到您的 CalculatorService 并惊叹于奇迹）。

您现在可能想考虑完全取消配置文件并改用 Windsor fluent API - 它非常直观，只需看看您可以将什么传递给 AsWcfService 方法，然后就可以走了（或者只是坚持使用配置文件）。

# javascript - javascript表单验证？

> ID：10789205
> 
> 赞同：0
> 
> 时间：2012-05-28T18:51:28.467
> 
> 标签：javascript, forms, validation, function, if-statement

我需要添加一个变量还是什么？D：请帮忙？

```
 <html>
<head>
<script language="javascript" type="text/javascript">
function sub()
{
validateForm();
}
function validateForm()
{
if (document.forms.myForm.fname.value == "" || document.forms.myForm.fname.value == " ")
  {
  alert("First name must be filled out");
  }
if (document.forms.myForm.lname.value == "" || document.forms.myForm.lname.value == " ")
{
alert("Last name must be filled out");
}
else
{
window.location = "ok.html";
}
}
</script>
</head>

<body>
<form name="myForm">
First name: <input type="text" name="fname">
<br>
Last name: <input type="text" name="lname">
<br>
<input type="button" value="Submit" onclick="sub()">
</form>
</body>
</html> 
```

好的，我的代码有点工作-如果表单有效，我不确定如何更改“else”语句以使其重定向到下一页..我需要添加变量还是...？所以基本上代码会做我想要的，直到你只输入姓氏字段然后它显示错误消息但它仍然重定向 -
**如果两个字段都有效，我如何制作它以便代码重定向到成功页面？**

（我对javascript了解不多：/而且我知道你可以让它更简单，但我们必须这样做，所以我们强制代码这样做或其他）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T18:55:22.950

这应该可以解决问题：

```
<html>
    <head>
        <script language="javascript" type="text/javascript">
            function validateForm()
            {
                var worked = true;

                if (document.forms.myForm.fname.value == "" || document.forms.myForm.fname.value == " ")
                {
                    alert("First name must be filled out");
                    worked = false;
                }
                if (document.forms.myForm.lname.value == "" || document.forms.myForm.lname.value == " ")
                {
                    alert("Last name must be filled out");
                    worked = false;
                }

                if (worked)
                {
                    window.location = "ok.html";
                }
            }
        </script>
    </head>

    <body>
        <form name="myForm">
            First name: <input type="text" name="fname">
            <br />
            Last name: <input type="text" name="lname">
            <br />

            <input type="button" value="Submit" onclick="validateForm();">
        </form>
    </body>
</html> 
```

有很多方法可以完成这个简单的任务，这就是使用变量的方式。基本上，如果任何检查失败，变量`worked`就会被设置为`false`（表示某些东西没有工作），并且只有当该变量保持不变时（`true`），用户才能继续下一步。

PS：识别你的代码（看看我的代码比你的更容易阅读吗？）。PPS：你绝对不应该只依赖 JS 来验证你的表单，你也必须在你的服务器上检查它。有人可以轻松绕过这些检查，因为它们只是为了方便。

# ios - 将 iPhone 加速度计设置为 ±8g 模式

> ID：10789211
> 
> 赞同：28
> 
> 时间：2012-05-28T18:52:12.957
> 
> 标签：ios, iphone, accelerometer

是否可以将 iPhone 加速度计设置为接收 ±8g 范围内的数据？（据我所知安装在 iPhone 上的[ST LIS331DLH加速度计支持这种模式）](http://www.st.com/internet/analog/product/218132.jsp)

我们不仅在研究标准 API，而且还在研究

*   未记录的函数
*   可能的 iOS 黑客
*   硬件修补

无论如何扩展加速度计范围超出标准±2g

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-04T17:43:12.363

我的“答案”**不**包含对 Evgeny 问题的直接回答。但是，我发现了一堆可能会有所帮助的未记录功能。

我在 iOS SDK 中搜索了与加速度计相关的功能。似乎一切都归结为两个框架之一（其他框架依赖于其中之一）：SpringBoardServices（私有）和CoreMotion。

**SpingBoardServices** API 比较简单：另见：[SBSAccelerometer 描述](http://iphonedevwiki.net/index.php/SBSAccelerometer)

目标 C API：

```
@interface SBSAccelerometer : XXUnknownSuperclass {
    id<SBSAccelerometerDelegate> _delegate;
    CFRunLoopSourceRef _accelerometerEventsSource;
    CFRunLoopRef _accelerometerEventsRunLoop;
    double _interval;
    NSLock* _lock;
    BOOL _orientationEventsEnabled;
    int _orientationEventsToken;
    NSThread* _orientationEventsThread;
    float _xThreshold;
    float _yThreshold;
    float _zThreshold;
}
@property(assign, nonatomic) id<SBSAccelerometerDelegate> delegate;
@property(assign, nonatomic) BOOL orientationEventsEnabled;
@property(assign, nonatomic) float zThreshold;
@property(assign, nonatomic) float yThreshold;
@property(assign, nonatomic) float xThreshold;
@property(assign, nonatomic) double updateInterval;
@property(assign, nonatomic) BOOL accelerometerEventsEnabled;
-(id)init;
-(void)dealloc;
-(void)_checkIn;
-(void)_checkOut;
-(void)_serverWasRestarted;
-(int)currentDeviceOrientation;
-(id)_orientationEventsThread;
-(void)_orientationDidChange;
@end 
```

C-API（方法的签名未知）：

```
int SBAccelerometer_server(struct unknown *in, struct unknown *out); //returns 1 on success, 0 otherwise
int SBAccelerometer_server_routine(struct unknown *in); // retuns 0 on error;
(?) SBSetAccelerometerClientEventsEnabled(...);
(?) SBSetAccelerometerDeviceOrientationChangedEventsEnabled(...);
(?) SBSetAccelerometerRawEventsInterval(...);
(?) SBXXDeliverAccelerometerEvent(...);
(NSString* or char*) _SBXXSBAccelerometer_subsystem; 
```

**CoreMotion**框架低级 API 是 C++ API。我不会发布所有 API（它比 SpingBoardServices 大得多），但有最有希望的部分：

```
CLSensorFusionAccelerometerOnly::reset(float)
CLSensorNetworkProtocol::isAccelerometerPacket(__CFData const*)
CLSensorNetworkProtocol::serializeAccelerometerPacket(CLAccelerometer::Sample const&)
CLSensorNetworkProtocol::deserializeAccelerometerPacket(__CFData const*)
CLSensorInterface::setAccelerometerCallbackAndInfo(void (*)(void*, CLMotionTypeVector3 const&, double const&), void*) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T19:36:53.613

不幸的是，没有本地方法可以做到这一点。另一方面，如果你愿意越狱，你可以得到一个 Cydia 调整（我不记得名字），它会降低加速度计的灵敏度。如果你把它的灵敏度设为25%，它应该可以感应到±8g。仅供参考，如果您从应用程序读取输出，它的范围仍为 ±2g，但通过调整，您必须记住读数将按比例缩小 1/4。（意味着应用程序中的 2g = 实际空间中的 8g）。

# git - Git fetch says "success" but nothing is downloaded

> ID：10789212
> 
> 赞同：4
> 
> 时间：2012-05-28T18:52:14.310
> 
> 标签：git, github

I'm having some serious issues with git, and couldn't find any solutions online. I'm a new user, so I may be doing something wrong...

I have a repository hosted on Github, and someone on my team just pushed a new commit. Using Git GUI on windows, I attempted to fetch the new commit from Github. Git said that the fetch was a success, but no changes were found/downloaded.

I attempted to create a new remote to Github and used that instead. (e.g. git@github.com:MyUserName/MyProject). When fetching from this remote, Git says success and lists every branch as being newly updated. However, none of the branches get downloaded. If I run fetch again, the same message is displayed.

I had this same problem a couple days ago with the same repository. I 'fixed' it by deleting my local repository and cloning the repo from Github. But apparently it was only a temporary fix, as the problem is back again.

Any guidance is much appreciated!

SOLVED: You were right, I needed to merge after fetching the changes. (Sadly, Git GUI does not allow for pulling) I'm assuming that Git GUI used to do this automatically, but perhaps I accidentally changed the options at some point. Thanks for all the information!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T19:00:40.587

`fetch` does exactly what is happening in your case: it pulls down changes into your local Git (sync down the repositories), but does not merge those changes into your branches and does not update your working copy. I believe the verb you're looking for is `pull`.

[What is the difference between 'git pull' and 'git fetch'?](https://stackoverflow.com/questions/292357/whats-the-difference-between-git-pull-and-git-fetch)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T20:24:30.847

As the other answer says, `fetch` just gets the new commits into your history but updates only the "remote tracking branches". These are references to the new commits but are not local branches that you work on.

If you want to update your local branch with what the remote tracking branch will have, you want to use `git pull`.

I would advise that it is better to `git fetch` instead of `git pull` and then inspect what has changed on the remote branch with `git log --all` or `gitk --all` or some other way of inspecting the history. When you are aware of what changes you will be bringing in and their nature, you can now `git merge origin/some-branch` or `git rebase origin/some-branch` to update a local branch to include the changes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-18T07:18:08.420

Generally, pull = fetch + merge. Sometimes, you may not see any changes after "fetch". You have to use "pull" to see the real updates. I don't know the root cause.

# java - java管道/进程构建器不使用cmd.exe

> ID：10789213
> 
> 赞同：1
> 
> 时间：2012-05-28T18:52:21.813
> 
> 标签：java, process, piping

这是我的代码，它只是打开一个命令提示符 Windows 7，然后坐下。没有其他的。我希望它显然可以发送和接收命令。那怎么了？？

```
String line;
try {
    Process p = Runtime.getRuntime().exec("cmd /c start cmd.exe");
    BufferedReader inp =
        new BufferedReader(
            new InputStreamReader(p.getInputStream()));
    BufferedWriter out =
        new BufferedWriter(
            new OutputStreamWriter(p.getOutputStream()));
    out.append("sometext");
    out.write("Some Text!\n\n");
    out.flush();
    line = inp.readLine();
    System.out.println("response1: " + line );   // that's ok
    out.write("Second Line...\n");
    out.flush();
    line = inp.readLine();
    // returns an empty string, if it returns...
    System.out.println("response2: " + line);    
    inp.close();
    out.close();
} catch (IOException io) {

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:11:02.090

cmd start 将启动一个新的命令提示符窗口，您的输入和输出缓冲区将不会连接到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:59:41.750

您可能希望在不同的线程上异步执行这些操作，并且您绝对不想忽略异常或错误流。

但最重要的是，您没有正确调用 cmd，因为通过执行“cmd /c start cmd.exe”，您正在进程中创建一个进程。

例如，

```
import java.io.*;

public class OpenCmd {
   public static void main(String[] args) {
      try {
         // Process p = Runtime.getRuntime().exec("cmd /c start cmd.exe");
         Process p = Runtime.getRuntime().exec("cmd.exe");
         final BufferedReader inp = new BufferedReader(new InputStreamReader(
               p.getInputStream()));
         final BufferedWriter out = new BufferedWriter(new OutputStreamWriter(
               p.getOutputStream()));
         final BufferedReader err = new BufferedReader(new InputStreamReader(
               p.getErrorStream()));

         new Thread(new Runnable() {
            public void run() {
               try {
                  out.append("sometext");
                  out.write("Some Text!\n\n");
                  out.flush();
                  out.write("Second Line...\n");
                  out.flush();
               } catch (IOException e) {
                  e.printStackTrace();
               } finally {
                  try {
                     out.close();
                  } catch (IOException e) {
                     e.printStackTrace();
                  }
               }
            }
         }).start();
         new Thread(new Runnable() {
            public void run() {
               try {
                  String line = "";
                  while ((line = inp.readLine()) != null) {
                     System.out.println("response1: " + line);
                  }

               } catch (IOException e) {
                  e.printStackTrace();
               } finally {
                  try {
                     inp.close();
                  } catch (IOException e) {
                     e.printStackTrace();
                  }
               }
            }
         }).start();
         new Thread(new Runnable() {
            public void run() {
               try {
                  String line = "";
                  while ((line = err.readLine()) != null) {
                     System.err.println("err: " + line);
                  }
                  inp.close();
               } catch (IOException e) {
                  e.printStackTrace();
               }
            }
         }).start();
         int exitVal = p.waitFor();
         System.out.println("exitVal := " + exitVal);

      } catch (IOException io) {
         io.printStackTrace();
      } catch (InterruptedException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
      }
   }
} 
```

# c# - 如何不将 double 转换为 int C#？

> ID：10789214
> 
> 赞同：-4
> 
> 时间：2012-05-28T18:52:33.093
> 
> 标签：c#

好的，人们让我尝试清除最后一个项目。我有一个对象 a，我想检查它的值是 double、int 还是 string。

例如： - 如果对象 a = "12.3" 或 a = 12.3，它应该能够在转换为 int 的同时转换为 double 和 throw。如果对象 a = "12" 或 a = 12 或 a = 12.0，它应该能够转换为 int 并在转换为 double 时抛出。

如果 object a="apple" 它应该为 double 和 int 抛出。

希望这次我清楚。但 Timwi 的解决方案实际上为我解决了这个问题。:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:14:01.257

我认为你有一个双精度数，如果它是一个整数，你想将它转换为 int，否则抛出。这是你想要的吗？

```
public static int ToInt32(double val)
{
    if (val % 1 != 0)
        throw new FormatException("The value is not an integer.");
    return Convert.ToInt32(val);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T19:05:11.490

我怀疑这`a`是你的例子中的类型`object`，真正的代码有点像这样：

```
int myToInt(object a)
{
    return Convert.ToInt32(a);
} 
```

但是如果`a`是整数，您希望它抛出。那么这个怎么样：

```
int myToInt(object a)
{
    if (a is double)
        throw new ArgumentException("a", "Must not be a double");
    return Convert.ToInt32(a);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T18:58:40.893

```
var a = 12.34;
int c = Int32.Parse(a.ToString(), NumberStyles.Integer,
                    CultureInfo.InvariantCulture); 
```

如果数字的字符串表示不是整数，这将引发异常。它的文档在[这里](http://msdn.microsoft.com/en-us/library/9yaffedz.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T19:11:55.410

既然我们都在猜测 OP 想要什么，我会再试一次。假设您想要一个当且仅当值被截断时抛出的方法，请尝试以下操作：

```
int MyToInt32(double value)
{
    if (value != Math.Floor(value))
        throw new ArgumentException("value", "The value must not have a fractional part");
    return (int) value;
} 
```

但这可能是一个相当糟糕的主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T19:05:20.303

首先[Convert.Int32(double)](http://msdn.microsoft.com/en-us/library/ffdk7eyz.aspx)不会截断取整数部分但不包括小数部分的值。事实上，它返回四舍五入的值。

> 值，四舍五入到最接近的 32 位有符号整数。如果 value 在两个整数的中间，则返回偶数；即4.5转换为4，5.5转换为6。

强制转换将截断该值并将取整数部分并丢弃小数部分。

对于你的问题

> 当我尝试将 double 转换为 int 时，是否有一个自定义的 c# 方法可以抛出格式异常或其他东西。??

`Convert.ToInt32`如果传递给它的值不是有效的双精度值，则会抛出异常。例如

```
 var val = "12.54A";
 int iVal = Convert.ToInt32(val); 
```

而如果你尝试使用 int iVal = (int) val; 会给你编译错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-28T19:11:54.443

你能试试用数学吗？您可以尝试为 double 添加一些值，以确保它比 int 更大（或更小）。
然后尝试转换（这将返回错误）和相反的数学函数。

仍然不知道为什么要抛出错误...
Double -> int 将起作用，如果变量位于 int-borders 之间

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-28T19:21:45.330

使用的是什么

```
if( x is int )
{
    // convert here
}
else
{
    throw new Exception("Not an int");
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-28T18:54:29.320

使用演员表

```
var a = 12.34
int integer = (int)a; 
```

# html - 显示在 div 顶部的border-bottom

> ID：10789218
> 
> 赞同：2
> 
> 时间：2012-05-28T18:52:48.243
> 
> 标签：html, css

我设置了一个底部边框，但由于我无法解决的原因，它显示在顶部。

我在这里设置了一个jsfiddle：

[http://jsfiddle.net/nnEr9/](http://jsfiddle.net/nnEr9/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T18:56:15.297

`overflow: hidden`在标题上 - 见 [http://jsfiddle.net/thebabydino/nnEr9/1/](http://jsfiddle.net/thebabydino/nnEr9/1/)

问题是您已经浮动了标题的子项。因此，您的标题高度为零，如下所示

![截屏](../Images/aee3ff4f7f27906fc65d4893da3f5f20.png)

[链接到全尺寸图像](https://i.stack.imgur.com/UkkO8.jpg)

`overflow: hidden`你用（`overflow: auto`也可以）修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T18:57:25.897

您需要添加`overflow:auto`到标题 div。因为您浮动了其他 div，所以您需要添加这个来解释浮动：

```
#header {
    margin-top: 50px;
    border-bottom: 2px solid #8B0000;
    overflow:auto;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/nnEr9/2/)**。

# r - 获取矩阵每一列中第一次出现的值的索引

> ID：10789219
> 
> 赞同：15
> 
> 时间：2012-05-28T18:52:48.727
> 
> 标签：r

如果我有一个向量，我可以获得低于某个值的第一次出现：

```
test <- c(0.5,0.8,0.1,0.08,0.06,0.04)
which(test<0.1)[1] 
```

正确地给出了答案`4`。但是，如何在矩阵的每一列中获得第一次出现，例如以下 2 列矩阵中低于 5 的第一次出现：

```
test2 <- matrix(c(5,8,3,4,7,5,6,2),ncol=2) 
```

使用`apply`with`which`返回一个列表：

```
> apply(test2<5,2,which)
[[1]]
[1] 3 4

[[2]]
[1] 4 
```

使用`apply`with`which.min`返回`1`所有列时：

```
> apply(test2<5,2,which.min)
[1] 1 1 
```

然而，我想要的应该只是返回`[1] 3 4`- 我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:04:04.983

这是另一个答案。假设您的意思是您编写 test3 的 test2，请注意“test2<5”是一个逻辑向量。最小值将为 FALSE。最大值（TRUE）是您想要的：

```
> apply(test2<5,2,which.max)
[1] 3 4 
```

请注意，如果最大值不是 TRUE，则这是不正确的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T19:01:01.660

试试这个：

```
test2 <- matrix(c(5,8,3,4,7,5,6,2),ncol=2)
> test2
     [,1] [,2]
[1,]    5    7
[2,]    8    5
[3,]    3    6
[4,]    4    2
> foo <- function(x){which(x < 5)[1]}
> apply(test2,2,foo) 
```

这里的关键是你把你知道在单个向量上工作的部分，简单地将它包装在一个函数中。`apply`将，好吧，将该函数应用于每一列。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-12T15:33:42.900

因为我只是偶然发现了这一点，所以这是另一个解决方案：

```
max.col(t(test2 < 5), "first") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-23T11:16:53.990

正如 Matthew 所指出的，`which.max`如果列中没有值 <5，则不会返回正确的值（它返回`1`，而正确的值是“nothing”）。该`match`函数很好地处理这种情况：

```
> test2 <- matrix(c(5,8,3,4, 7,5,6,7), ncol=2)
> apply(test2<5, 2, which.max)
[1] 3 1
> apply(test2<5, 2, function(x) match(TRUE, x))
[1]  3 NA 
```

# javascript - JS/AJAX：隐藏/显示选择框

> ID：10789220
> 
> 赞同：0
> 
> 时间：2012-05-28T18:52:51.143
> 
> 标签：javascript, jquery, ajax

该功能禁用与主类别不匹配的选择框。我有一个主要类别和两个子类别。有没有办法可以隐藏和显示子类别选择框而不是禁用它们？

**JS/AJAX**

```
<script type="text/javascript">
var formObject = {
    run : function(obj) {

            obj.nextAll('.update').html('<option value="">----</option>').attr('disabled', true);
            var id = obj.attr('id');
            var v = obj.val();
            jQuery.getJSON('update.php', { id : id, value : v }, function(data) {
                if (!data.error) {
                    obj.next('.update').html(data.list).removeAttr('disabled');
                } else {
                    obj.nextAll('.update').html('<option value="">----</option>').attr('disabled', true);
                }
            });
        }   
}; 
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T18:56:08.020

您可以使用*style='display:none;'* 属性。或者使用 JQuery，$("#subc1").show() / $("#subc2").hide()。

*   显示： [http ://api.jquery.com/show/](http://api.jquery.com/show/)
*   隐藏： [http ://api.jquery.com/hide/](http://api.jquery.com/hide/)

# asp.net-mvc-3 - 访问控制器中的 Global.asa.cs 变量

> ID：10789221
> 
> 赞同：1
> 
> 时间：2012-05-28T18:52:53.453
> 
> 标签：asp.net-mvc-3

我想将我的 MVC 3 应用程序设置加载到内存中以获得更好的性能。

到目前为止，我可以在 global.asa.cs 中分配它们，但我无法访问任何控制器中的变量。知道为什么吗？

**Global.asa.cs 代码**

```
public class MvcApplication : System.Web.HttpApplication
{
    public static string DBUserName = Properties.Settings.Default.DBUserName;
    public static string DBPassword = Properties.Settings.Default.DBPassword; 
```

**家庭控制器代码：**

```
public class HomeController : Controller
    {

        public ActionResult Index()
        {
            ViewBag.Message = "Modify this template to jump-start your ASP.NET MVC application.";
            _Authenticate(DBUserName , DBPassword ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:55:45.167

您需要通过指定声明它们的类名来访问它们：

```
_Authenticate(MvcApplication.DBUserName, MvcApplication.DBPassword); 
```

`MvcApplication`是在这两个[字段](http://msdn.microsoft.com/en-us/library/ms173118.aspx)中声明的类的名称。

为此，您需要将 2 个字段声明为静态：

```
public static string DBUserName = Properties.Settings.Default.DBUserName;
public static string DBPassword = Properties.Settings.Default.DBPassword; 
```

# jquery - 将多个 Web 服务结果合并到单个 Knockout ViewModel

> ID：10789223
> 
> 赞同：1
> 
> 时间：2012-05-28T18:53:03.907
> 
> 标签：jquery, rest, knockout.js, asp.net-web-api

我需要调用多个 Web 服务来获取有关资源的不同信息。例如，我可能对多租户应用程序有以下调用：

1.  获取位置
2.  获取位置/{id}/服务器
3.  获取位置/{id}/租户
4.  等等

对于这些调用中的每一个，我最终都会对相应的 Web 服务进行不同的 jQuery ajax 调用。但是，我的 UI 显示了一个汇总页面，其中显示了每个查询结果的表格。构建一个单独的 Knockout ViewModel 似乎真的很容易，然后每个查询结果都有 ObservableArrays 但也许我正在错误地处理这个问题。无论哪种方式，我都不确定如何将多个调用合并到一个模型或为每个调用使用多个模型。

有没有人可以分享任何文档或示例代码来为我指明正确的方向？

**更新：**我想在我的淘汰赛对象中实现这个最终结果/结构。本质上，它是一对多的关系，一个位置对许多服务器或租户。

```
LOCATION
  - Name
  - ID
  - Date
  - Servers []
  - Tenants [] 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:32:28.347

我所做的是为页面创建一个视图模型，并使用每次调用的值更新属性。我使用带有三个参数的 ko.mapping 插件来更新现有的可观察数组并使属性可观察。这些`ko.mapping.fromJSON`调用将进入您的 AJAX 调用的成功函数中，您可以在其中获得结果，为了简单起见，我只是让它们单击处理程序。 [http://jsfiddle.net/jgoemat/v9XTf/](http://jsfiddle.net/jgoemat/v9XTf/)

```
var jsonLocations = '[{"name":"home"},{"name":"work"}]';
var jsonServers = '[{"name":"Mercury"},{"name":"Venus"}]';
var jsonTenants = '[{"name":"Betty"},{"name":"Frank"}]';

function ViewModel() {
    var self = this;
    self.locations = ko.observableArray();
    self.servers = ko.observableArray();
    self.tenants = ko.observableArray();

    self.loadLocations = function() { ko.mapping.fromJSON(jsonLocations, {}, self.locations); };
    self.loadServers  = function() { ko.mapping.fromJSON(jsonServers, {}, self.servers); };
    self.loadTenants = function() { ko.mapping.fromJSON(jsonTenants, {}, self.tenants); };
}

var my = { vm: new ViewModel() };                                                        

ko.applyBindings(my.vm);​ 
```

**编辑**-[更新小提琴](http://jsfiddle.net/jgoemat/6xzFW/1/)

如果位置包含租户，您可以修改该位置的属性，ko 事件处理程序将当前模型传递给处理程序：

```
self.loadServers  = function(location) {
    ko.mapping.fromJSON(jsonServers, {}, location.Servers);
}; 
```

如果您使用 jQuery 绑定，则可以使用`ko.dataFor(element)`从元素所在的上下文中获取模型：

```
$('.loadAll').live('click', function(e) {
    var location = ko.dataFor(this);
    // location can be used in success callback of ajax 
    ko.mapping.fromJSON(jsonServers, {}, location.Servers);
    ko.mapping.fromJSON(jsonTenants, {}, location.Tenants);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T14:18:04.073

如果我没听错的话，你有一个带有 observableArray 位置的视图模型。每个位置可能有一组服务器和一组租户。解决这个问题的一种方法是创建一个存储所有返回值的对象。所以在那个对象中你可能有 {locations: [], servers: [], tenants: []} 。这都是对象的主根。

当您获得您的位置时，将它们映射到可观察对象的本地模型。向 location 对象添加一个名为 servers 的属性。这将用于导航到该位置的服务器。服务器属性可以执行搜索（速度较慢但适应性更强）或使用备忘录对象来查找位置的索引。关键是在内存中设置这个本地对象，以帮助跟踪您的数据并保持导航正常工作。

另一种选择是简单地将每个位置的服务器加载到客户端上它们各自的位置对象中。无论哪种方式，您都可以在客户端上创建自己的模型。我很少准确地接受服务器给我的东西，而不是映射到某些东西。顺便说一句 - 我不为此使用映射插件，但我想你可以。

# php - ajaxSubmitButton：插入问题

> ID：10789227
> 
> 赞同：0
> 
> 时间：2012-05-28T18:53:24.420
> 
> 标签：php, mysql, ajax, yii

我在这里尝试做的是通过从 AjaxSubmitButton 传递一些值并调用控制器/动作来将它们插入到表中。

这是控制器动作

```
public function actionAddit()
{
        $connection = yii::app()->db;
        $transaction=$connection->beginTransaction();
        try 
        {    
        $connection = yii::app()->db;
        $sql1 = "INSERT INTO apTracker (id, title,createdDate,owner) VALUES(:id, :title,:createdDate,:owner)";

            $command=$connection->createCommand($sql1);

            $command->bindValue(":id", $_POST['id']);
            $command->bindValue(":title", $_POST['title']);
            $command->bindValue(":createdDate", new CDbExpression('NOW()'));
            $command->bindValue(":owner", $_POST['o']);

                $command->execute();
                $transaction->commit();
        }       
        catch(Exception $e)
        {
            $transaction->rollBack();
            $this->refresh;
        } 
```

这是视图文件中的 Ajaxbutton：

```
 <?php echo CHtml::ajaxSubmitButton('Yes!',          
        array('/entry/addit'), 
        array(
                'type'=>'POST',
                'data' => array('id' => '1','title' => 'Untitled','o'=>'6'),
                'success' => 'js:function(){window.location="site/message"}', 
        ));?> 
```

好吧，我不知道这到底是什么，但它不起作用。但是，如果我删除命令 bindvalue 并在 sql 查询本身中硬编码一些值，它就可以工作。所以，我猜这个问题可能是将 AjaxSubmit 部分的值传递给控制器​​。我在这里做错了什么，但不能完全弄清楚是什么。有帮助吗？

编辑：好的，很抱歉编辑混乱，问题又回到了原来的形式。

我已经尝试过 eggyal 的解决方案，但是，我仍然无法让它发挥作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:06:30.500

1.  您将字符串文字`'NOW()'`作为`:createdDate`参数传递，这是无效的。只需`NOW()`在 SQL 中使用：

    ```
    $sql1 = '
      INSERT INTO apTracker (id, title, createdDate, owner) VALUES
        (:id, :title, NOW(), :owner)
    ';

    $command = $connection->createCommand($sql1);

    $command->bindValue(':id',    $_POST['id']);
    $command->bindValue(':title', $_POST['title']);
    $command->bindValue(':owner', $_POST['o']);

    $command->execute(); 
    ```

2.  第二个 ( `$url`) 参数[`CHtml::ajaxSubmitButton`](http://www.yiiframework.com/doc/api/1.1/CHtml#ajaxSubmitButton-detail)应该是一个字符串，而不是一个数组：

    ```
    <?php
      echo CHtml::ajaxSubmitButton(
        'Yes!',          
        '/entry/addit', 
        array(
          'type'    => 'POST',
          'data'    => array('id' => '1', 'title' => 'Untitled', 'o'=>'6'),
          'success' => 'js:function(){window.location="site/message"}', 
        )
      );
    ?> 
    ```

3.  你`$connection`在你的`try`块内不必要地重新分配。

# c++ - Direct3D WVP 拉伸问题

> ID：10789229
> 
> 赞同：0
> 
> 时间：2012-05-28T18:53:34.730
> 
> 标签：c++, matrix, directx, shader, direct3d

我一直在使用 Direct3D 开发自己的 3D 引擎。这非常好，直到我遇到了世界视图和投影矩阵的问题。我正在使用我以前工作过的项目中的代码，但项目中没有。所以我决定使用 Direct3D 函数 D3DXMatrixLookAtLH 和 D3DXMatrixPerspectiveFovLH。

这给出了一个工作矩阵，但是如果通过旋转或平移相机我将几何体移动到靠近屏幕边缘的位置，它会在水平轴上拉伸整个对象，现在我不确定这是否正确。

屏幕中间的立方体看起来很正常： ![普通立方体](../Images/8f0c564deaf5c13aeaa7cbef8a36e56e.png)

但如果我把它移到一边，它就会开始伸展： ![拉伸立方体](../Images/bc2ed5a01c9c41d325012aa07b59f019.png)

这是我在这种情况下得到的视图矩阵：

```
-0.81964797 -0.017183444    -0.57260966 0.00000000
 0.00000000  0.99954993 -0.029995499    0.00000000
 0.57286739 -0.024585750    -0.81927919 0.00000000
-1.1457349   0.049171507     1.6385586  1.0000000 
```

我还注意到，在应用程序中的 WVP 矩阵和着色器接收到的矩阵之间，它被转置了。（我使用 memcpy 在 CBuffer 中获取它，所以这不应该是问题）这不是一个主要问题，我只是在它被发送之前转置它，但我想知道这是否常见。

这是我的着色器：

```
cbuffer WVP :cb0
{
    float4x4 WVP;
};

struct VOut
{
    float4 position : SV_POSITION;
    float4 color : COLOR;
};

VOut VShader(float3 position : POSITION, float4 color : COLOR)
{
    VOut output;

    output.position = mul( float4(position, 1.0f), WVP);

    output.color = color;

    return output;
}

float4 PShader(float4 position : SV_POSITION, float4 color : COLOR) : SV_TARGET
{
    return color;
} 
```

这是每帧根据输入更新视图矩阵的代码：

```
// reset the vectors so the changes don't stack
vcPos.Set(x, y, z);
vcDir.Set(0.0f, 0.0f, -1.0f);

// Rotate the dir vector
Matrix3D m;
m.Rota(Looky/100, 0.0f, Lookx/100);
vcDir.RotateWith(m);

// add the pos to the dir vector so it points to in a direction rather then a point in the world
vcDir += vcPos;

// Set and get the View matrix
g_pDevice->SetViewMatrix(vcRight, vcUp, vcDir, vcPos );
g_pDevice->GetViewProjMatrix(&g_mView, NULL);

// Multiply them
g_mWVP = g_mWorld * g_mView * g_mProj;

// Transpose them so the shader tranposes them back.
Transpose(&g_mWVP); 
```

这是它的幕后部分：

看法：

```
D3DXMatrixLookAtLH(&m_mView, &D3DXVECTOR3(vcPos.x, vcPos.y, vcPos.z),
                    &D3DXVECTOR3(vcDir.x, vcDir.y, vcDir.z), &D3DXVECTOR3(vcUp.x, vcUp.y, vcUp.z));   // The .x/.y/.z has to do with some compatability stuff 
```

项目：

```
D3DXMatrixPerspectiveFovLH(&m_mProj, FOV, Aspect, m_fNear, m_fFar); // Straight 
forward

D3DXMatrixPerspectiveFovLH(&m_mProj, 90.0, Aspect, 0.1f, 100.0f); // With values 
```

更新2：用新信息完成重写

Update3：我遇到了视图矩阵和投影的问题。世界矩阵工作正常。

更新4：

在更改了更多代码之后，我现在有了一些似乎可以工作的东西！我现在唯一的问题是向侧面伸展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T20:36:07.153

请注意，如果对象的前部更靠近相机，则垂直拉伸可能不会超过我的预期。你确定这个输出不正确吗？

但是，更相关的是，我会考虑调整您的 FoV 参数。为什么，确切地说，你要转换它？如果您使用 D3DXMATRIX，那么矩阵将已经按照正确的顺序发送到 GPU，并且不需要转置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T07:21:10.430

您是否确保考虑乘以翻译矩阵的顺序？我的意思是，如果你先平移，然后缩放，结果将是一个拉伸的网格。您必须确保按顺序执行它们。如果您希望网格围绕自己的轴旋转，您需要先旋转然后平移。如果您希望网格围绕某物“绕行”，您首先需要将其平移到绕物体绕行的距离，然后旋转，然后将其平移到该物体的位置。

无论如何，你提到了拉伸，所以我猜这可能是因为你先翻译然后缩放：

```
worldMatrix = translate * scale; // This will cause your mesh to stretch

worldMatrix = scale * translate; // this will cause your mesh to scale correctly 
```

唯一要先平移的时间是当您不进行缩放，并且您希望对象围绕另一个对象“运行”时

# data-structures - 表的数据结构

> ID：10789237
> 
> 赞同：0
> 
> 时间：2012-05-28T18:54:13.630
> 
> 标签：data-structures, relational

如果我有一个表，每行代表一条记录，并且有几列。我想对任何列进行快速查询和排序。我可以使用哪些数据结构？

我想节省空间。否则，我可以在每一列上缓存排序结果以进行查询和排序。但是除了表本身之外，如何消耗更少的空间呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:07:21.937

根据数据的复杂性，您可能正在寻找[关系代数](http://en.wikipedia.org/wiki/Relational_algebra)的实现。也就是说，一[组无序的元组](http://en.wikipedia.org/wiki/Relation_%28database%29)。

通常实现是某种形式的[B-tree](http://en.wikipedia.org/wiki/B-tree)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:12:18.170

这本质上是一个数据库编程问题。您将需要索引，每列一个（此答案的其余部分将假装我们在谈论单个索引；想象一下，如果需要，可以多次执行所有这些操作）。常见的解决方案包括哈希表和搜索树（例如 B 树），但当然，仅包含所有列条目的简单解决方案并不是特别节省空间。

答案是创建*稀疏*索引：将记录分组到块中，并仅存储索引中每个块中搜索键最低的记录。除非您遇到病态情况（始终添加非常低的值），否则这将在低空间要求下为您提供不错的性能。

为了处理病态情况，您可以考虑将记录分组到块中的不同方法，例如，保留一大堆尚未索引的记录，并且只将其中的一堆提交到一个组中（并将其编入索引）每当您可以找到一个在搜索键方面并非无处不在的子集时。

（这些只是想法。我更像是数据库的用户而不是数据库的程序员。尝试一些研究，看看比我了解更多的人在实践中做了什么。）

# php - 获取 php 动态生成的 html 代码作为字符串

> ID：10789238
> 
> 赞同：3
> 
> 时间：2012-05-28T18:54:17.290
> 
> 标签：php, html, oscommerce

这是通用的 PHP 问题，而不仅仅是 oscommerce。

在旧版本的 oscommerce 中，通过创建 PHP 类的对象来显示一列。如果我包含它，它会显示

```
new infoBox2($info_box_contents) ; 
```

但是在新版本中，由于很多原因，我没有这样做的自由。我**必须**将通过将上述对象创建为字符串而生成的所有 HTML 代码返回。这就是字符串现在的样子 -

```
$data = '<div class="ui-widget infoBoxContainer">' .'  <div class="ui-widget-header infoBoxHeading">' . MODULE_BOXES_CATEGORIES_BOX_TITLE . '</div>' .'  <div class="ui-widget-content infoBoxContents">' . $categories_string . '</div>' .'</div>'; 
```

您会注意到它是预定义的 HTML 代码。我需要将 $data 值更改为创建对象时生成的动态生成的 HTML 代码。关于如何做到这一点的任何想法？我尝试将对象类型转换为字符串并使用 var_dump

var_dump 给出了这样的东西

```
object(infoBox2)#8 (7) { ["table_border"]=> string(1) "0" ["table_width"]=> string(4) "100%" ["table_cellspacing"]=> string(1) "0" ["table_cellpadding"]=> string(1) "0" ["table_parameters"]=> string(22) " class="infoBox_table"" ["table_row_parameters"]=> string(0) "" ["table_data_parameters"]=> string(19) " class="infoBox_td"" } 
```

这不完全是它的 HTML 代码。

**这里重要的是获取由 PHP 代码生成的 HTML 代码作为字符串。我该怎么做？**

如果我将新对象的创建放在一个单独的文件中并使用 file_get_contents 那么它将返回 PHP 代码本身还是返回由 php.ini 生成的 HTML 代码。请注意，我将传递文件路径而不是 URL。由于 oscommerce 内部结构，我无法传递 URL，我现在不会深入探讨。我会使用这样的东西：-

```
file_get_contents("myfile.php"); 
```

**不是**

```
file_get_contents("http://mywebsite.com/myfile.php"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T18:59:16.543

您可以使用称为“输出缓冲”的技术。

```
# start redirecting output to a buffer
ob_start();

# execute the other PHP file
include('myfile.php');

# grab whatever got output since ob_start() (and stop buffering)
$html = ob_get_clean(); 
```

# .htaccess - .htaccess 友好的 URL

> ID：10789241
> 
> 赞同：-1
> 
> 时间：2012-05-28T18:54:21.993
> 
> 标签：.htaccess, url, friendly-url

我知道这个话题已经被讨论过并被打死了……但我的话题太简单了，也许我太复杂了？我已经编写了我的 .htaccess 文件，但它一直是用于动态内容的。pagename.php?id=1 或其他...但在这种情况下，我有一个 10 页的静态网站。没有 CMS，没有数据库...漂亮而简单的扁平 php 文件。PHO 仅用于某些包含文件。它实际上是 HTML。

但是，我想从链接中删除扩展名，以便 www.example.com/about.php 变为 www.example.com/about

我遇到的棘手部分是代码中的现有 URL

```
<a href="http://www.example.com/about.php"> 
```

我希望在用户滚动并单击它时重新编写，而无需编辑网站或更改文件名。虽然看似简单的任务，但我似乎无法让它发挥作用？任何想法重写规则是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:01:58.237

mod_rewrite 不会重写您的文档。它只重写浏览器发送的*请求*（浏览器只在用户点击链接后发送请求，即使这样当前显示页面的内容也不会改变）。

除非您想进行重大研究，否则您可能必须编辑文件。

# iphone - xCode 4.3 使用 RestKit 归档项目失败：#import 未找到

> ID：10789250
> 
> 赞同：1
> 
> 时间：2012-05-28T18:55:27.807
> 
> 标签：iphone, objective-c, xcode, archive, restkit

当我在 xCode 中进行“归档”操作时，该操作在这一行失败：

```
#import <RestKit/RestKit.h> 
```

我可以运行/构建一个项目，甚至可以“构建归档”。但是当我尝试为应用商店归档应用时，操作失败。

症状是我需要构建项目两次才能运行。感觉这与构建脚本和其余套件标头操作的复制有关。但我没有调试构建脚本的经验。

有没有人遇到过这个问题？**如何归档包含其余套件项目的项目？**

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:26:30.460

您是否为发布版本和调试版本设置了所有正确的链接器标志（不确定是否需要它们）。

归档构建实际上构建了发布版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:08:03.300

我最终修复了此处描述的构建路径以使应用程序成功归档： [归档时所有 RestKit 项目都无法构建](https://stackoverflow.com/questions/8303292/all-restkit-projects-fail-to-build-when-archiving)

# java - 必需：双 [] 找到：无参数

> ID：10789251
> 
> 赞同：2
> 
> 时间：2012-05-28T18:55:27.960
> 
> 标签：java, arrays, list, average

代码：

```
 ArrayList <Integer> marks = new ArrayList();

 String output = "Class average:" + calculateAverage() + "\n" + "Maximum mark:" +  
 calculateMaximum() + "\n" +"Minimum mark:" + calculateMinimum() + "\n" + "Range of 
 marks:" + range;

 analyzeTextArea.setText(output);

 private double calculateAverage(double [] marks) {
 double sum = 0;
 for (int i=0; i< marks.length; i++) {
 sum += marks[i];
 }
 return sum / marks.length;
 } 
```

忽略字符串中的其他内容（最小值、最大值和范围），但对于这一行，

```
 String output = "Class average:" + calculateAverage() + "\n" + "Maximum mark:" +  
 calculateMaximum() + "\n" +"Minimum mark:" + calculateMinimum() + "\n" + "Range of 
 marks:" + range; 
```

我收到一个错误：

> 必需：双 []
> 找到：无参数

为什么我会收到这个错误，我应该改变什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T18:57:26.537

您以这种方式调用方法 calculateAverage: `calculateAverage()`，没有任何参数。但是该方法是这样声明的：

```
private double calculateAverage(double [] marks) 
```

因此它需要一个 type 参数`double[]`，但你什么也不传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T18:57:47.180

看这个：

```
String output = "Class average:" + calculateAverage() + ... 
```

计算平均值是什么意思？您必须为该方法提供一些平均数据。`calculateMaximum`等情况也是如此`calculateMinimum`。没有任何上下文，这些方法将无能为力。

您的实际标记存储在哪里？大概你有某种变量存储标记 - 所以通过它。例如：

```
String output = "Class average:" + calculateAverage(actualMarks) + ... 
```

...除了很明显的真实变量，或者你用来存储标记的任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:08:27.807

private double calculateAverage(double [] 标记) 是方法声明，所以当它被调用时，它必须有双数组的参数

例如：

计算平均值（double_value_array）；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T19:03:37.840

你可以这样称呼它：

```
double d[] = {1, 2, 3};
double ret = calculateAverage(d);
System.out.println(ret); 
```

# c# - 侦听 ARP 请求

> ID：10789254
> 
> 赞同：1
> 
> 时间：2012-05-28T18:55:43.920
> 
> 标签：c#, vb.net, arp

有人可以向我解释如何在 VB.net 或 C# 中收听 ARP 请求吗？

我需要捕获 ARP 请求并获取请求者的 IP 地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T02:14:08.657

在最坏的情况下，您可以`arp -a`定期处理 run 的输出。

编辑：我知道这不回答 OP，但仅供参考，由于RHS 上列出的[相关答案](https://stackoverflow.com/a/1148861/256431 "如何通过 .NET 访问 ARP 协议信息？")`arp -a`，您可以通过编程获得等效的答案。

这是我在该答案中列出的 C# 代码的 VB.NET 版本：

```
Imports System
Imports System.Runtime.InteropServices
Imports System.ComponentModel
Imports System.Net
Imports System.Runtime.CompilerServices

Module Program

' The max length of physical address.
Const MAXLEN_PHYSADDR As Integer = 8

' Define the MIB_IPNETROW structure.
<StructLayout(LayoutKind.Sequential)> _
Structure MIB_IPNETROW

    <MarshalAs(UnmanagedType.U4)> _
    Public dwIndex As Integer
    <MarshalAs(UnmanagedType.U4)> _
    Public dwPhysAddrLen As Integer
    <MarshalAs(UnmanagedType.U1)> _
    Public mac0 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac1 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac2 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac3 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac4 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac5 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac6 As Byte
    <MarshalAs(UnmanagedType.U1)> _
    Public mac7 As Byte
    <MarshalAs(UnmanagedType.U4)> _
    Public dwAddr As Integer
    <MarshalAs(UnmanagedType.U4)> _
    Public dwType As Integer
End Structure

' Declare the GetIpNetTable function.
Declare Function GetIpNetTable Lib "IpHlpApi.dll" (
    ByVal pIpNetTable As IntPtr,
    <MarshalAs(UnmanagedType.U4)>
    ByRef pdwSize As Integer,
    ByVal bOrder As Boolean) As <MarshalAs(UnmanagedType.U4)> Integer

' The insufficient buffer error.
Const ERROR_INSUFFICIENT_BUFFER As Integer = 122

Sub Main(ByVal args() As String)

    ' The number of bytes needed.
    Dim bytesNeeded = 0

    ' The result from the API call.
    Dim result = GetIpNetTable(IntPtr.Zero, bytesNeeded, False)

    ' Call the function, expecting an insufficient buffer.
    If result <> ERROR_INSUFFICIENT_BUFFER Then
        ' Throw an exception.
        Throw New Win32Exception(result)
    End If

    ' Allocate the memory.
    Dim buffer = Marshal.AllocCoTaskMem(bytesNeeded)

    Try
        ' Make the call again. If it did not succeed, then
        ' raise an error.
        result = GetIpNetTable(buffer, bytesNeeded, False)

        ' If the result is not 0 (no error), then throw an exception.
        If result <> 0 Then _
            Throw New Win32Exception(result)

        ' Now we have the buffer, we have to marshal it. We can read
        ' the first 4 bytes to get the length of the buffer.
        Dim entries = Marshal.ReadInt32(buffer)

        Dim currentBuffer = buffer.PtrAdd(GetType(Integer))

        Dim table = New MIB_IPNETROW(0 To entries - 1) {}

        For index = 0 To entries - 1
            table(index) = DirectCast(Marshal.PtrToStructure(
                        currentBuffer.PtrAdd(GetType(MIB_IPNETROW), index), _
                    GetType(MIB_IPNETROW)), MIB_IPNETROW)
        Next

        For index = 0 To entries - 1

            With table(index)

                Dim ip = New IPAddress(BitConverter.GetBytes(.dwAddr))
                Console.Write(" IP: " & ip.ToString() & vbTab & " MAC: ")

                PrintByte(.mac0)

                PrintHyphenByte(.mac1)

                PrintHyphenByte(.mac2)

                PrintHyphenByte(.mac3)

                PrintHyphenByte(.mac4)

                PrintHyphenByte(.mac5)

                If .dwPhysAddrLen <> 6 Then _
                    Console.Write(" Actual length: {0} ", .dwPhysAddrLen)
                Console.Write(" Interface: 0x{0:X} Type: {1} ", .dwIndex, .dwType)
            End With
            Console.WriteLine()
        Next

    Finally
        ' Release the memory.
        Marshal.FreeCoTaskMem(buffer)

    End Try

    If Debugger.IsAttached Then _
        Console.ReadLine()
End Sub

<Extension()>
Private Function PtrAdd(ByVal Ptr As IntPtr, ByVal Type As Type, Optional ByVal Index As Long = 1) As IntPtr
    Return New IntPtr(Ptr.ToInt64() +
        Index * Marshal.SizeOf(Type))
End Function

Private Sub PrintHyphenByte(ByVal b As Byte)
    Console.Write("-")
    PrintByte(b)
End Sub

Private Sub PrintByte(ByVal b As Byte)
    Console.Write(b.ToString("x2"))
End Sub

End Module 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:00:27.023

将没有干净的 API 来执行此操作。ARP 请求通常不会传播到用户空间，它们由网络堆栈本身回答（如果不是由 NIC 驱动程序，我不确定）。您将不得不将卡置于混杂模式并基本上编写数据包嗅探器。你可以用 WinPcap 来做，例如[http://pcapdotnet.codeplex.com/](http://pcapdotnet.codeplex.com/)

# android - 从 ListView 启动 Activity

> ID：10789256
> 
> 赞同：0
> 
> 时间：2012-05-28T18:55:54.403
> 
> 标签：android, listview

我是法国人，但我会尝试解释我的问题一个新活动，特别是一个新视图（facebook.java），我可以用一个按钮来做，但我不能因为我的 ListView ，这是我的代码：

```
 package com.androiddev.tab;

import java.io.FileNotFoundException;
...

public class Tab5 extends ListActivity implements OnClickListener {
private ListView maListViewPerso25;

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                requestWindowFeature(Window.FEATURE_NO_TITLE);
                setContentView(R.layout.onglet5);

                Button button = (Button) findViewById(R.id.imageButtonSelector2);
                button.setOnClickListener(this);

                maListViewPerso25 = (ListView) findViewById(R.id.listView25);
                ArrayList<HashMap<String, String>> listItem25 = new ArrayList<HashMap<String, String>>();
                HashMap<String, String> map;
                map = new HashMap<String, String>();
                map.put("titre", "1 - Qui sommes-nous ?");
                map.put("img", String.valueOf(R.drawable.fleche));
                map.put("file", "QSN.pdf");
                listItem25.add(map);
                map = new HashMap<String, String>();
                map.put("titre", "2 - A propos de l'application");
                map.put("img", String.valueOf(R.drawable.fleche));
                map.put("file", "Apropos.pdf");
                listItem25.add(map);
                map = new HashMap<String, String>();
                map.put("titre", "3 - Sur Facebook");
                map.put("img", String.valueOf(R.drawable.fleche));
                listItem25.add(map);
                SimpleAdapter mSchedule = new SimpleAdapter (this.getBaseContext(), listItem25, R.layout.afichageitem,
                  new String[] {"img", "titre" }, new int[] {R.id.fleche, R.id.titre});
                maListViewPerso25.setAdapter(mSchedule);

                //LISTENER

                maListViewPerso25.setOnItemClickListener(new OnItemClickListener() {
                   public void onItemClick(AdapterView<?> a, View v, int position, long id) {
                         HashMap<String, String> map = (HashMap<String, String>) maListViewPerso25.getItemAtPosition(position);
                         String nomFichierDansAsset = map.get("file");
                         String nomFichierTemp = "list25.pdf";

                         if (copyAssetToTempFile(nomFichierDansAsset, nomFichierTemp)) {
                          try {
                                String name = getFileStreamPath(nomFichierTemp).getAbsolutePath();
                                Uri uri = Uri.parse("file://" + name);
                                Intent intent = new Intent(Intent.ACTION_VIEW);
                                intent.setDataAndType(uri, "application/pdf");
                                startActivity(intent);
                          } catch (ActivityNotFoundException e) {
                                // Cas d'erreur si pas de lecteur PDF installé
                                Log.d("xx", "Erreur affichage PDF", e);
                          }
                        }
                  }
                 });

                 };
  private boolean copyAssetToTempFile(String nomFichierAsset,
           String nomFichierTemp) {
           boolean result = true;
           try {
                 byte[] buffer = new byte[512];
                 FileOutputStream fos = openFileOutput(nomFichierTemp, MODE_WORLD_READABLE);
                 InputStream is = getAssets().open(nomFichierAsset);
                 int bytesRead = is.read(buffer);
                 while (bytesRead > 0) {
                   fos.write(buffer, 0, bytesRead);
                   bytesRead = is.read(buffer);
                 }
                 fos.close();
                 is.close();
           } catch (FileNotFoundException e) {
                 // Cas d'erreur de création de fichier
                 Log.d("xx", "Erreur creation fichier ", e);
                 result = false;
           } catch (IOException e) {
                 // Cas d'erreur de lecture de fichier
                 Log.d("xx", "Erreur lecture fichier", e);
                 result = false;
           }
           return result;
         }  
// POUR LE BOUTON
  public void onClick(View src) {
         Intent i = new Intent(this, TabAndroidActivity.class);
         startActivity(i);
  };
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T13:46:26.647

试试这个代码：

```
if(map.get("titre").equals("YourTile") {
    Intent mainIntent = new Intent(Tab5.this, "Your Facebook Activity Here".class);
    startActivity(mainIntent);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:08:50.917

你可以做第一件事`onItemClick`

```
if(map.get("titre").equals("3 - Sur Facebook") {
    startActivity(new Intent(this, TabAndroidActivity.class));
    return;
} 
```

这很难看，但如果它是您正在寻找的，那么您将能够做得更好

# javascript - netbeans ide coffeescript 将 utf-8 bom 添加到输出文件

> ID：10789258
> 
> 赞同：1
> 
> 时间：2012-05-28T18:56:05.633
> 
> 标签：javascript, netbeans, coffeescript, utf, byte-order-mark

我正在使用netbeans ide 7.1.1 并通过node.js 运行CoffeeScript 来观察我的coffeescript 文件夹的更改，然后使用javascript 自动编译到不同的文件夹。一切正常，然后我不知道发生了什么，但我开始在我的大多数 javascript 文件的开头得到 ï»¿ 字符。真是令人沮丧。唯一改变的是我认为我在 netbeans 中关闭了项目，然后重新打开它；那是问题开始的时候。我检查了编码以确保它在 netbeans 中设置为 UTF-8。似乎coffeescript编译器正在添加一个bom，但我认为真正的错误在于netbeans。

当我运行每个 js 文件时，我都会收到“未捕获的语法错误：意外的令牌非法”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-11T20:19:47.547

有完全相同的问题。

从命令行使用“咖啡”脚本没问题。

从 netbeans 编译所有 UTF-8 字符都会出现乱码。

解决方案很简单，但令人惊讶的是必须浪费多少时间才能找到解决方案。我不明白为什么在 netbeans 中指定我们的项目源是 UTF-8 是不够的。

所以这是解决方案，无论如何都对我有用。

在您的 netbeans 安装的 etc 目录中找到 netbeans.conf；

编辑**netbeans_default_options的值**

通过在字符串的末尾添加（当然是在双引号之前，并且在之前有一个空格......）：

```
-J-Dfile.encoding=UTF-8 
```

瞧。我这样做了，现在一切都很好。

哦..顺便说一句，以管理员身份打开您的编辑器，否则 Windows 可能会抱怨另一个程序正在被另一个程序使用（事实并非如此，目录只是被锁定）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T22:33:50.403

好的，我解决了问题，但我仍然不知道是什么原因造成的。这就是我所做的： - 在记事本++ 中打开所有 .coffee 文件，并将每个文件的编码更改为 UTF-8 without BOM。不知何故（netbeans？）一些文件变成了带有BOM的UTF-8。问题暂时解决了。

# javascript - 为 Web 应用程序创建图像工具栏

> ID：10789263
> 
> 赞同：0
> 
> 时间：2012-05-28T18:56:26.017
> 
> 标签：javascript, css, html

我正在构建一个非常基本的在线应用程序，您可以在其中从工具栏（或某种存储盒，因为最终会有很多图像）获取图像并将它们拖放到画布上。我是 Web 开发的新手，但我知道如何进行拖放，我只是在寻找一种制作工具栏并将图像放入其中的方法。理想情况下，我想要一个带有滚动条的框。

这似乎应该是一个非常简单的问题。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T17:36:20.637

我最终发现的最简单的方法是使用

```
overflow: scroll; 
```

在包含图像的 CSS div 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:01:12.420

这是一个非常好的和简单的 HTML5 中使用拖放的演示：

[http://html5demos.com/drag](http://html5demos.com/drag)

请注意，拖动链接很容易（如本演示中所示），但无法拖动任何不在 IE9 中链接内的图像。

如果您想要一个完全跨浏览器的解决方案，您将不得不恢复到旧的解决方案（跟踪鼠标向下、移动和向上并设置自己的对象位置）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T21:27:58.597

如果您说您知道拖放并且只想要一个带有滚动条的框，那么请检查：http: [//jqueryui.com/demos/slider/side-scroll.html](http://jqueryui.com/demos/slider/side-scroll.html)

# ios - 无法使用 plist 文件获取不同的 pin 图像

> ID：10789265
> 
> 赞同：1
> 
> 时间：2012-05-28T18:56:34.753
> 
> 标签：ios, xcode, image, annotations

我使用 plist 文件在字典中存储具有名称、地址、坐标和图标（图钉图像名称）字符串的注释数据。我需要根据 plist 中的图标字符串在地图上使用 pin 图像显示我的注释。我循环我的注释字典，但它显示在我所有引脚上的第一个字典的地图引脚图像上。

我的代码：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation
{

    if ([annotation isKindOfClass:[MKUserLocation class]])
        return nil;

    static NSString* AnnotationIdentifier = @"AnnotationIdentifier";
    MKPinAnnotationView* pinView = [[MKPinAnnotationView alloc]
                                    initWithAnnotation:annotation reuseIdentifier:AnnotationIdentifier];

    NSString *path = [[NSBundle mainBundle] pathForResource:@"data" ofType:@"plist"];
    NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:path];

    for(path in dict){

        NSString *theCategory;

        theCategory = [NSString stringWithFormat:@"%@", path];
        NSLog(@"%@", path);

        NSArray *anns = [dict objectForKey:theCategory];

        pinView.image = [UIImage imageNamed:[[anns objectAtIndex:0] objectForKey:@"Icon"]];

    }

    pinView.canShowCallout=YES;

    return pinView;
} 
```

我的 plist 文件构造：

![在此处输入图像描述](../Images/af7c11794630f2c01d9898fc8e4d53c6.png)

它向我展示了什么：

![在此处输入图像描述](../Images/b273e3785645e293b411f10e69e1333f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T02:48:55.117

将为添加的`viewForAnnotation`每个注释调用委托方法。

您在该方法中的 for 循环将对每个注释以相同的方式运行。所有 for 循环最终所做的（每个注释的每次）都设置`pinView.image`为 for 循环读取的最后一项。这恰好是 plist 中第一个字典中的第一项。

您需要设置`pinView.image`为***当前***正在调用的注释`Icon`的项目（即传递的参数）。因此，您*可以*保留 for 循环并检查项目是否匹配，然后才设置（然后退出 for 循环）。*`viewForAnnotation``annotation`*`annotation``pinView.image``break`**

 **但是，在该委托方法中不断地重新阅读和循环一个 plist 并不是一个好主意。最好为`Icon`注释类创建一个属性，*在创建注释时设置属性*（您可能首先循环通过 plist 来创建注释），然后直接从注释对象本身中使用该属性`viewForAnnotation`委托方法。

假设您有一些自定义注释类，请将 Icon 添加为属性：

```
@interface MyAnnotationClass : NSObject<MKAnnotation>

@property (nonatomic, assign) CLLocationCoordinate2D coordinate;
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *subtitle;
@property (nonatomic, copy) NSString *icon;  //<---and @synthesize it in .m 
```

然后在循环 plist 以创建注释的地方，像设置`icon`属性一样设置`title`属性：

```
ann.title = [item objectForKey:@"Name"];
ann.icon = [item objectForKey:@"Icon"]; 
```

最后，在 中，您可以直接从`viewForAnnotation`中读取属性。但首先，您应该检查它是否属于您的自定义类类型（因此用户位置蓝点不会受到影响，并且可以合理地确定将拥有您将要访问的属性）：`icon``annotation``annotation``annotation`

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation
{
    if (![annotation isKindOfClass:[MyAnnotationClass class]])
    {
        // Note "!" sign in front of above condition.
        // Return nil (default view) if annotation is 
        // anything but your custom class.
        return nil;
    }

    static NSString* AnnotationIdentifier = @"AnnotationIdentifier";

    MKAnnotationView *pinView = [mapView dequeueReusableAnnotationViewWithIdentifier:AnnotationIdentifier];
    // Create an MKAnnotationView instead of MKPinAnnotationView
    // because we are setting a custom image.
    // Using MKPinAnnotationView sometimes overrides custom image
    // with the built-in pin view.
    if (pinView == nil)
    {
        pinView = [[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:AnnotationIdentifier];
        pinView.canShowCallout = YES;
    }
    else
        pinView.annotation = annotation;

    MyAnnotationClass *myAnn = (MyAnnotationClass *)annotation;
    pinView.image = [UIImage imageNamed:myAnn.icon];
    // May want to check if myAnn.icon is blank (length == 0)
    // (OR if pinView.image is still nil after setting)
    // and show some default image in that case otherwise
    // annotation will be invisible.

    return pinView;
} 
```

顺便说一句，在您的 plist 文件中，`Test3`没有`Icon`设置。**

# asp.net - 需要解决方法 & in url, iis7

> ID：10789275
> 
> 赞同：1
> 
> 时间：2012-05-28T18:57:53.903
> 
> 标签：asp.net, iis-7, bad-request

我正在将旧的 asp.net 网站从 windows 2003 移动到 windows 2008 R2。

一些页面在 url 中有 '&'，它在 2003 年运行良好，但在 2008 年任何 '&' 在 '?' 之前 给出“错误请求”。

这些页面对网站受欢迎程度有严重影响，所有访问的 7% 都是从这里开始的，因此在不更改 url 的情况下正确处理它们很重要。任何想法如何处理 iis7 / asp.net 2.0 上的此类网址？

PS：验证请求不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:00:36.757

尝试在 web.config 中添加以下内容：

```
<system.web>
    <httpRuntime requestPathInvalidCharacters="*,:,\" />

    ...
</system.web> 
```

请注意，我已从`&`路径中的无效字符列表中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:05:13.600

[这是一个链接](http://forums.asp.net/p/1217915/2346761.aspx#2346761)，可能会让您到达您想去的地方，但是如果您阅读了详细信息，我会亲自将其添加到“您自担风险”类别中……[至少其中一个采用 Microsoft 的话“修复”](http://support.microsoft.com/default.aspx?scid=kb;EN-US;826437)：

> 重要 如果启用此修复程序，则会增加应用程序的攻击面。除非应用程序需要，否则不应启用此修复程序。

`DWORD HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET VerificationCompatibility = 1`

其他的应该只是通过设置名称（例如，）对*风险*进行自我解释：`AllowRestrictedCharacters``ValidateRequest=False`

也就是说，您应该考虑更新那些“旧版”网址并进行`301`永久重定向以说明您的 SEO/受欢迎程度......

# qt - QFileSystemModel 排序 DirsFirst

> ID：10789284
> 
> 赞同：2
> 
> 时间：2012-05-28T18:59:19.050
> 
> 标签：qt, sorting, qfilesystemmodel

您如何使用 QDir::DirsFirst 对 QFileSystemModel 进行排序，就像在 QDirModel 中一样？QFileSystemModel 没有`setSorting`方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-21T05:04:48.860

也许有人会需要这个。正如 Kuba Ober 在评论中提到的那样，我已经使用 QFileSystemModel 的 QSortFilterProxyModel 实现了目录首先排序。可能还不完美，但仍然是正确的方向。

```
bool MySortFilterProxyModel::lessThan(const QModelIndex &left, const QModelIndex &right) const
{
    // If sorting by file names column
    if (sortColumn() == 0) {
        QFileSystemModel *fsm = qobject_cast<QFileSystemModel*>(sourceModel());
        bool asc = sortOrder() == Qt::AscendingOrder ? true : false;

        QFileInfo leftFileInfo  = fsm->fileInfo(left);
        QFileInfo rightFileInfo = fsm->fileInfo(right);

        // If DotAndDot move in the beginning
        if (sourceModel()->data(left).toString() == "..")
            return asc;
        if (sourceModel()->data(right).toString() == "..")
            return !asc;

        // Move dirs upper
        if (!leftFileInfo.isDir() && rightFileInfo.isDir()) {
            return !asc;
        }
        if (leftFileInfo.isDir() && !rightFileInfo.isDir()) {
            return asc;
        }
    }

    return QSortFilterProxyModel::lessThan(left, right);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:54:51.997

据我所知，你不能（在 Qt4 中）。

默认排序顺序（按“名称”列）或按大小排序的行为类似于`QDir::DirsFirst`（或者`DirsLast`如果按相反顺序排序），但按时间或类型排序不会将目录与普通文件区别对待。

`QFileSystemModel`没有公开用于更改排序顺序的 API，而且我看不到在代码中影响它的任何机会`QFileSystemModel`。

（我在当前的 Qt5 文档中没有看到任何表明这已经改变的东西，但这些不是最终的，我没有仔细查看。）

# ruby-on-rails - God resque start 给出“服务器不可用”

> ID：10789286
> 
> 赞同：2
> 
> 时间：2012-05-28T18:59:35.497
> 
> 标签：ruby-on-rails, production-environment, resque, god

我无法弄清楚如何让上帝重新启动 resque。

我在 Ubuntu 10.04.3 LTS Linode 切片上有一个 Rails 3.2.2 堆栈。其运行系统 Ruby 1.9.3-p194（无 RVM）。

有一个上帝 init.d 服务，`/etc/init.d/god-service`其中包含：

```
CONF_DIR=/etc/god
GOD_BIN=/var/www/myapp.com/shared/bundle/ruby/1.9.1/bin/god
RUBY_BIN=/usr/local/bin/ruby
RETVAL=0

# Go no further if config directory is missing.
[ -d "$CONF_DIR" ] || exit 0

case "$1" in
    start)
        # Create pid directory
        $RUBY_BIN $GOD_BIN -c $CONF_DIR/master.conf
        RETVAL=$?
  ;;
    stop)
        $RUBY_BIN $GOD_BIN terminate
        RETVAL=$?
  ;;
    restart)
        $RUBY_BIN $GOD_BIN terminate
        $RUBY_BIN $GOD_BIN -c $CONF_DIR/master.conf
        RETVAL=$?
  ;;
    status)
        $RUBY_BIN $GOD_BIN status
        RETVAL=$?
  ;;
    *)
        echo "Usage: god {start|stop|restart|status}"
        exit 1
  ;;
esac

exit $RETVAL 
```

`master.conf`在上面包含：

```
load "/var/www/myapp.com/current/config/resque.god" 
```

`resque.god`在上面包含：

```
APP_ROOT  = "/var/www/myapp.com/current"
God.log_file  = "/var/www/myapp.com/shared/log/god.log"

God.watch do |w|
  w.name = 'resque'
  w.interval = 30.seconds
  w.dir = File.expand_path(File.join(File.dirname(__FILE__),'..'))
  w.start = "RAILS_ENV=production bundle exec rake resque:work QUEUE=*"
  w.uid = "deploy"
  w.gid = "deploy"

  w.start_grace = 10.seconds
  w.log = File.expand_path(File.join(File.dirname(__FILE__), '..','log','resque-worker.log'))

  # restart if memory gets too high
  w.transition(:up, :restart) do |on|
    on.condition(:memory_usage) do |c|
      c.above = 200.megabytes
      c.times = 2
    end
  end

  # determine the state on startup
  w.transition(:init, { true => :up, false => :start }) do |on|
    on.condition(:process_running) do |c|
      c.running = true
    end
  end

  # determine when process has finished starting
  w.transition([:start, :restart], :up) do |on|
    on.condition(:process_running) do |c|
      c.running = true
      c.interval = 5.seconds
    end

    # failsafe
    on.condition(:tries) do |c|
      c.times = 5
      c.transition = :start
      c.interval = 5.seconds
    end
  end

  # start if process is not running
  w.transition(:up, :start) do |on|
    on.condition(:process_running) do |c|
      c.running = false
    end
  end
end 
```

在`deploy.rb`我有一个重新加载任务：

```
task :reload_god_config do
  run "god stop resque"
  run "god load #{File.join(deploy_to, 'current', 'config', 'resque.god')}"
  run "god start resque"
end 
```

问题是无论我是部署还是`god (stop|start|restart|status) resque`手动运行，我都会收到错误消息：

```
The server is not available (or you do not have permissions to access it) 
```

我尝试安装`god`到系统 gem 并指向它`god-service`：

```
GOD_BIN=/usr/local/bin/god 
```

但`god start rescue`给出了同样的错误。

但是，我可以通过以下方式启动服务：

```
sudo /etc/init.d/god-service start 
```

`root`因此，我认为，这可能是一个权限问题，可能与 init.d 服务归用户所有，并且 God 由用户从捆绑包中运行的事实有关`deploy`。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-12T15:20:28.583

您正在以不同的用户身份运行上帝服务（很有可能是 root）。

另请查看：[上帝未运行：服务器不可用（或您无权访问它）](https://stackoverflow.com/questions/27063623/god-not-running-the-server-is-not-available-or-you-do-not-have-permissions-to/29013627#29013627)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-13T10:48:48.027

首先你使用“god --version”命令检查你是否在你的机器上安装了god。如果它可用，只需尝试使用 -D 选项运行一些神脚本。示例“god -c sample.god -D”它将在控制台的标准输出中为您提供某种类型的错误消息，确切的问题在哪里。当我尝试在没有“-D”选项的情况下运行命令时，我也遇到了同样的错误。然后当我尝试使用“-D”模式时，它被告知一些文件夹写入权限问题，我可以找到它并修复它。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-20T23:40:22.707

好的，这是您的配置文件的问题，请检查所有这些文件 + 包含失败的地方，它会向您抛出此错误。我检查了我的并修复了一些错误，之后它工作得很好！

# delphi - 依赖 DeHL 进行新项目是否安全？

> ID：10789292
> 
> 赞同：10
> 
> 时间：2012-05-28T19:00:25.130
> 
> 标签：delphi, dehl

我一直在[GoogleCode 上浏览 DeHL 存储库，它对](http://code.google.com/p/delphilhlplib/)我来说看起来非常好。

*   许多有趣的功能使基本的编程任务更容易；在这个库中可以找到 DotNet FCL 中但 Delphi RTL 中缺少的一些简洁的东西；

*   以现代方式编码，充分利用新的语言特性；

*   每个类、记录类型、成员函数和参数都以这样的方式记录在案，以便在 Delphi IDE 的代码完成中显示；

*   组织良好且干净的代码；

*   大量的单元测试；

*   开源和免费；

基本上，看起来这个库应该已经包含在 Delphi 中，作为 RTL 的一部分。

一个主要缺点：**该项目已停止。**:-(

现在我的问题是：
在未来的项目中依赖这个库是否安全，并将其用作构建的基础框架？

基本上，我想听听实际使用过这个库的人是否值得花时间了解这个库，以及为什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T19:36:54.153

IIRC 该项目被终止，因为它是一个过度设计的第一次尝试，它的许多功能变得非常混乱和臃肿。你应该看看 Alex Ciobanu 的第二次尝试，它简称为[Collections](http://code.google.com/p/delphi-coll/)。它包含 DeHL 的大部分有趣功能，但更精简。

不过要小心。它仍然大量使用泛型，如果你经常使用它，[这会使你的二进制文件变得非常大](http://tech.turbu-rpg.com/299/wish-list-generics-collapsing)，因为编译器团队还没有实现折叠重复代码的方法。

# python - AttributeError：NoneType 对象没有属性“健康”

> ID：10789296
> 
> 赞同：0
> 
> 时间：2012-05-28T19:00:41.247
> 
> 标签：python, debugging, pygame

在我的策略游戏 Table Wars 的一场长时间比赛中，我遇到了这个错误。每当战场上有许多单位时，它似乎就会发生。这是回溯：

```
Traceback (most recent call last):
  File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 727, in <module>
    main()
  File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 131, in main
RedTeam.update()
  File "C:\Python27\lib\site-packages\pygame\sprite.py", line 399, in update
for s in self.sprites(): s.update(*args)
  File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 372, in update
self.attack()
  File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 393, in attack
    self.target.health -= self.attack_damage
AttributeError: 'NoneType' object has no attribute 'health' 
```

异常似乎出现在目标和攻击代码中，所以我将它们发布在这里：

```
def move_toward(self, target):
    if self.target is None:
        self.rect.move_ip(1, 0)

def update(self):
    self.find_target()
    self.move_toward(self.target)
    self.attack()
    if self.health <= 0:
        self.kill()

def find_target(self):
    if self.target is not None: return
    for enemy in BluTeam.sprites():
        if enemy.rect.centerx - self.rect.centerx <= self.range and enemy.rect.centery - self.rect.centery <= self.range:
            self.target = enemy
            return
        self.target = None

def attack(self):
    global REDGOLD
    global BLUECOMMAND
    if self.target is None: return
    if self.target.health <= 0:
        REDGOLD += self.target.reward
        BLUECOMMAND += self.target.cmdback
        self.target = None
    if not self.cooldown_ready(): return
    self.target.health -= self.attack_damage

def cooldown_ready(self):
    now = pygame.time.get_ticks()
    if now - self.attack_last >= self.attack_cooldown:
        self.attack_last = now
        return True
    return False 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:05:00.937

解释常见错误或*如何更好地理解简单的回溯以调试我的程序*：

```
 File "<path>\<filename>.py", line 393, in <function> 
```

Traceback 为您提供调用堆栈并指出错误在哪个函数中引发。这里没什么特别的

```
 self.target.health -= self.attack_damage 
```

友好的解释器给出导致错误的语句。这很重要，因为这意味着引发的错误与这行代码有关。

```
AttributeError: 'NoneType' object has no attribute 'health' 
```

我们到了。错误是[`AttributeError`](http://docs.python.org/library/exceptions.html#exceptions.AttributeError)；该文档对此非常清楚：我正在尝试读取的值或我正在尝试分配给不是相关对象成员的变量。

我的对象是什么？它是一个`'NoneType' object`；我们没有名字，但我们有它的类型。我们有问题的对象是`NoneType`，因此它是特殊对象`None`。

这个`None`对象有什么错误？它没有`'health'`属性是说 Traceback。因此，我们正在`health`错误引发的代码行中的某处访问属性，这在`None`对象上调用。

现在我们几乎都设置好了：`self.target.health`是我们使用的错误行中唯一的位置`health`，因此它意味着`self.target`is `None`。现在我查看源代码，我试图理解为什么会这样，即使我在函数的开头对它进行了检查。这导致我必须`None`在该行之后以某种方式将其设置为。

* * *

所有这些推理步骤都导致了简短的答案：

这意味着`self.target`是`None`。该错误来自您的代码：

```
if self.target.health <= 0:
    REDGOLD += self.target.reward
    BLUECOMMAND += self.target.cmdback
    self.target = None  # set to None
if not self.cooldown_ready(): return
self.target.health -= self.attack_damage  # self.target is None, .health failed 
```

# jquery - 我无法让 afterLoad 在 FancyBox 中工作

> ID：10789298
> 
> 赞同：0
> 
> 时间：2012-05-28T19:00:57.663
> 
> 标签：jquery, fancybox

HTML：

```
<div class="left">
    <a rel="group" href="images/reveal.jpg" title="Lorem ipsum dolor." class="fancybox"><img src="images/images3.jpg"></a>
    <a rel="group" href="images/reveal2.jpg" title="Lorem ipsum dolor." class="fancybox"><img src="images/images1.jpg"></a>
    <a rel="group" href="images/reveal3.jpg" title="Lorem ipsum dolor." class="fancybox"><img src="images/images2.jpg"></a>
</div> 
```

JS：

```
<script type="text/javascript">
$(document).ready(function() {
    $(".fancybox").fancybox({
        afterLoad: function() {
            this.inner.append('<p>TEST</p>');
            this.content = '<p>TEST2</p>' + this.content.html();
        }
    });
});
</script> 
```

有了以上内容，我在 Firebug 中得到一个错误：“this.inner is undefined”。

我显然错过了一些东西，但我已经盯着这个太久了，看不到它是什么。任何帮助，将不胜感激。

**编辑：** 感谢您的建议。

我尝试了其中的每一个，但无济于事。我最终放弃了我尝试使用的方法，我只是要调用一个 div，并在那里设置我的内容。

最终结果将类似于此处的 HTML：http: [//jsfiddle.net/NjNMC/](http://jsfiddle.net/NjNMC/)。不会使用该示例中的 JS；这就是整个混乱局面的开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-27T11:34:42.170

这是一个有年头的问题，但这可能对正在搜索的人有所帮助..

尝试使用`beforeShow`在打开动画开始之前调用的“”回调..

[更多信息在这里](https://github.com/fancyapps/fancyBox/issues/254)..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:07:00.230

而不是`this.inner.append('<p>TEST</p>');`尝试`$(this).html('<p>TEST</p>');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:12:30.340

你可能想在fancybox 窗口中注入这个html。您不是用 te 关键字指代`this`，请尝试`$('#fancybox-outer')` 注意，这是无证使用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-28T19:05:24.823

尝试

```
$(document).ready(function() {
    $(".fancybox").fancybox({
        afterLoad: function() {
            $(".fancybox")[0].inner.append('<p>TEST</p>');
            //$(".fancybox")[0].content = '<p>TEST2</p>' + $(".fancybox")[0].content.html();
        }
    });
}); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-17T07:12:43.280

```
 $("a[href$='.jpg'],a[href$='.png'],a[href$='.gif']").attr('rel', 'gallery').fancybox({
     openEffect: 'none',
     closeEffect: 'none',
     afterLoad: function () {
         this.outer.prepend('<a href="index.html"> <img src="img/logo.svg" class="logoShow"></a>');
         this.outer.append('<div id="btnExpand"><img src="img/nav_menu_expand.png" input type="submit"/></div>');
     }
 }); 
```

# ruby-on-rails - 用于生产的内存中 ActiveRecord

> ID：10789304
> 
> 赞同：2
> 
> 时间：2012-05-28T19:01:30.200
> 
> 标签：ruby-on-rails, ruby, activerecord, redmine

我目前正在扩展 Redmine 1.4 问题跟踪器的一些功能（它使用 Rails 2.3.14 和 Ruby 1.8.7）。

对于我当前的用例，我不太喜欢它的一件事是，一些封装业务逻辑（角色、工作流）的类是基于数据库而不是基于代码的——我们的客户不应该能够在没有我们的情况下更改角色和工作流干预，虽然我可以使用我想要的角色和工作流预加载一组预烘焙的数据库数据，但我仍然认为这将是一个不是为了可维护性而最好的解决方案。

我想做的是这样的：

```
class Person < SomeInMemoryActiveRecordBaseClass
end

p = Person.new(:name => "Somebody)
p.save 
```

然后我希望能够在任何 Person 对象和 Person 类上调用 ActiveRecord 方法，即使它背后没有真正的数据库。

这似乎是一件愚蠢的事情（如果我从头开始创建项目，我根本不会使用基于 AR 的对象，但由于我正在构建已经存在的东西，所以这不是一个选项），但是对象我需要在很多地方使用内存，它们应该是基于 AR 的；在任何地方改变它们的用法真的很耗时。

我见过一些项目，比如[nulldb](https://github.com/nulldb/nulldb)，它们是面向测试的，而不是面向生产的，它们并没有实现所有方法。除此之外，AR 界面似乎非常面向 sql，我不知道“正确”获得 sql 仿真层是否真的可行。

是否有任何库可以适合我创建功能齐全的 activerecord 内存数据库的用例？

（我已经考虑过使用不同的连接并利用inmemory sqlite db，但对我来说似乎有点过度设计）。

# c# - 在表单视图内的标签文本中格式化日期

> ID：10789305
> 
> 赞同：0
> 
> 时间：2012-05-28T19:01:32.920
> 
> 标签：c#, asp.net

我想知道是否有更简单的方法来格式化表单视图内的标签，我使用的代码是这个，它在事件表单视图数据绑定内：

```
protected void FormView2_DataBound(object sender, EventArgs e)
{
    if (FormView2.CurrentMode == FormViewMode.Edit)
    {
        Label DAT_Label1 = (Label)FormView2.FindControl("DAT_Label1");
        if (DAT_Label1 != null)
        {
            DateTime date = Convert.ToDateTime(DAT_Label1.Text);
            DAT_Label1.Text = string.Format("{0:dd/MM/yyyy}", date);
        }
    }
} 
```

标签控件中是否没有属性可以帮助进行这种格式化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:15:30.173

有标准的[短日期格式说明符](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#ShortDate)，它比您的代码略少冗长，但确实具有使用用户格式样式的优点，因此在英国显示 dd/mm/yyyy 或在语言环境下显示 mm/dd/yyyy设置为美国

```
protected void FormView2_DataBound(object sender, EventArgs e)
{
if (FormView2.CurrentMode == FormViewMode.Edit)
{
    Label DAT_Label1 = (Label)FormView2.FindControl("DAT_Label1");
    if (DAT_Label1 != null)
    {
        DateTime date = Convert.ToDateTime(DAT_Label1.Text);
        DAT_Label1.Text = string.Format("{0:d}", date);
    }
} 
```

}

# nginx - 一些页面没有被 Nginx 传递给应用服务器

> ID：10789308
> 
> 赞同：1
> 
> 时间：2012-05-28T19:02:01.163
> 
> 标签：nginx, reverse-proxy

我将 nginx 设置为 Thin Rails 应用服务器的反向代理。

```
server {
    listen 82;
    server_name www.hamburgers.com;
    root /var/user_cases/user_00001/user_case_11/public;
    location ~\.* {
        proxy_pass http://127.0.0.1:3000;
        proxy_set_header Host $host;
    }
} 
```

一些页面打开，请参阅`/var/log/nginx/access.log`

```
127.0.0.1 - - [28/May/2012:18:33:53 +0400] "GET /assets/e.png HTTP/1.1" 304 0 "http://www.hamburgers.com:82/user_session/new" "Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0"
127.0.0.1 - - [28/May/2012:18:34:01 +0400] "POST /user_session HTTP/1.1" 302 113 "http://www.hamburgers.com:82/user_session/new" "Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0" 
```

但有些人在这样的记录中失败了`/var/log/nginx/error.log`

```
2012/05/28 18:34:03 [error] 5710#0: *117 open() "/var/www/nginx-default/user_cases" failed (2: No such file or directory), client: 127.0.0.1, server: localhost, request: "GET /user_cases HTTP/1.1", host: "www.hamburgers.com", referrer: "http://www.hamburgers.com:82/user_session/new" 
```

我想 nginx 出于某种原因使用`/var/www/nginx-default`而不是`www.humburgers.com`用于某些页面。我不知道为什么。

**我该如何解决？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T10:05:17.327

找到解决方案。我应该使用

```
proxy_set_header Host $http_host; 
```

代替

```
proxy_set_header Host $host; 
```

# ms-access - VBA 代码导入 - MS Access

> ID：10789320
> 
> 赞同：2
> 
> 时间：2012-05-28T19:03:58.953
> 
> 标签：ms-access, vba, import

我在 Access 表单后面有几个用 VBA 编码的按钮。我将有许多表单，它们的页脚中有这些按钮（新、下一个、上一个、重复等）。这些按钮不是标准的宏，但足够简单，可以在我的所有表单中使用相同的代码。

我该如何编写这些按钮（在所有表单中都具有相同的名称......类似于模板），所以我不必在所有表单中复制粘贴代码？有没有办法在模块中编写这些按钮并让表单导入该模块的文本（有点像大多数其他语言）？

只是好奇。使代码更简洁/更容易，因为编程的核心是我自己的，但其他人将对表单代码进行小幅编辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:30:40.330

最简单的做法是`Function`在标准代码模块中为每个按钮的功能创建一个。然后将每个按钮的 Click 属性从更改为`[Event Procedure]`与该按钮对应的函数的名称（例如，`=MyPrevFunction([Form])`）。

请注意，为了使其工作，您必须专门使用`Function`而不是`Sub`. VBA 中没有要求函数返回任何内容，因此只需将单词替换`Function`为`Sub`进行更改所需的全部内容。

![在 On Click 事件中显示 =MyButtonFunction([Form]) 的属性表屏幕截图](../Images/867a1fc0429d3dd31a59b8ab2cab4a02.png)

一张图片胜过千言万语。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:51:42.650

与@mwolfe02 建议的想法一样，您可以将按钮放在子表单中，这意味着只需要编辑一组按钮，或者更好的是，设置您自己的自定义菜单。这些可以在每个表单的基础上调用，也可以作为应用程序的“标准”菜单调用。您甚至可以拥有自己的右键菜单。

# algorithm - 最小化任何相邻站点之间的最大距离

> ID：10789322
> 
> 赞同：2
> 
> 时间：2012-05-28T19:04:14.297
> 
> 标签：algorithm, binary-search

> 给出了 100 个站点。相邻站之间的距离不相等。您将获得 10 个标志，您必须在这些站点中放置这些标志。第一个标志在第一个站，最后一个标志在最后一个站。现在放置剩余的标志，使两个标志之间的总相邻距离最小。

我的方法是这样的：

考虑这个问题 10 个站和 4 个标志让它们之间的距离为 **1-----2--3---4----5-----6--------7-- -----8-9---10**

式中-代表距离单位表示第1站和第2站的距离为5，因此第1站和第10站的距离为(5+2+3+4+5+6+7+1+3) = 36

我们在第 1 站和第 10 站之间应用二进制搜索，因此我们得到 36/2 = 18

因此，我们将选择枢轴作为 18 个距离单位并应用二进制搜索

> (i) 第 1 旗的第 1 和第 18 距离单位
> 
> (ii) 第 2 旗的第 19 和第 36 距离单位

1st flag 的平均距离为 9，更接近于 4th 站，我们将 flag 放置在 4 站。

平均距离为 9，因此距起点的距离为 27，更接近第 7 站因此我们在第 7 站放置第二个标志。

因此答案将是 **1** -----2--3--- **4** ----5-----6------ **7** --------8-9--- **10** 因此，在这种情况下，最大距离被优化为 b/w 任意两个站点为 15 类似地，我们可以求解 100 个站点

请检查这种方法是否正确，或者是否有更有效的方法。如果我错了，请纠正我提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T07:56:01.810

你的算法是错误的。在您的示例中，将站 6 移动到位置 24。您的算法仍然会给出 1-4-7-10 作为最大距离 15 的答案，但实际上 1-5-6-10 会更好，最大距离14。

[http://www.careercup.com/question?id=10680926](http://www.careercup.com/question?id=10680926)上的多项式时间解决方案（您复制了这个问题，很糟糕，来自）具有正确的优点，但远非最快的答案。这是此问题的更快答案。

假设我们从愿意使用的最大距离开始。我们可以从第一个站点开始，使用二分搜索找到我们愿意跳到的最远站点，然后搜索找到离那个最远的站点，等等。使用这种策略，我们可以编写一个函数来获取最大输入距离并告诉我们使用了多少个标志。（如果做不到，我们可以只报告非常多的标志——比如站的数量。）

我们可以把它变成一个函数，输入我们愿意做的最大跳跃，它告诉我们需要多少个标志。

现在我们可以对最小的最大距离进行二分搜索，从而得到我们想要的标志数量。

（您可以通过修改该函数以返回标志的数量以及将给出相同确切答案的最小和最大输入值来加快这一速度。额外的两位信息可用于加速二进制搜索。这给出了我知道这个问题的最快解决方案。）

# javascript - jQuery `Quicksand` 插件不起作用，我该如何使用它？

> ID：10789323
> 
> 赞同：2
> 
> 时间：2012-05-28T19:04:20.930
> 
> 标签：javascript, jquery, quicksand, jquery-isotope

## 基本上......让这个工作...... **[JSFiddle！](http://jsfiddle.net/SVYFY/)**

我正在尝试使用 jQuery 插件来过滤 3 个 UL 中的项目。*（每个`<ul></ul>`都有无限数量的列表项。）*

我正在使用的插件位于下面的链接（[流沙](http://razorjack.net/quicksand/docs-and-demos.html)）（连同文档和演示）。

## **流沙：** [http ://razorjack.net/quicksand/](http://razorjack.net/quicksand/)

## **文档** [http://razorjack.net/quicksand/docs-and-demos.html](http://razorjack.net/quicksand/docs-and-demos.html)

该插件基本上会过滤我的`<ul></ul>`.

我曾多次尝试过此操作，但没有收到控制台错误或任何提示我出错的地方，也不知道为什么它不起作用。

我有 3 个`<ul class="column"></ul>`标签，每个标签下面都有列表项（在本例中为 3 个）。我需要能够使用插件过滤（和动画）所有这些。

**我还用我的代码制作了一个** **[JS Fiddle](http://jsfiddle.net/SVYFY/)** **供您使用。（流沙作为“资源”包含在内）。**

我的 HTML 的基本结构是：

**菜单**

```
<!-- On click of these, filter according to 'data-value' -->
<ul id="definations" class="wrapper">
    <li><a href="javascript:;">all</a></li>
    <li data-value="web"><a href="javascript:;">digital - web</a></li>
    <li data-value="iphone"><a href="javascript:;">digital - mobile</a></li>
    <li data-value="android"><a href="javascript:;">branding & print</a></li>
    <li><a href="javascript:;">event</a></li>
    <li><a href="javascript:;">motion</a></li>
</ul> 
```

**要过滤的内容**

```
<div id="portfolio" class="wrapper">
    <ul class="column">
        <li class="work item" data-id="id-1" data-type="iphone" data-title="iPhone" data-project="iPhone and Android App" data-year="2012 Project">
            <a href="javascript:;"><img src="/css/img/product/work-demo1.png" alt="Omega"/></a>
            <a class="view" href="javascript:;"></a>
        </li>

        <li class="work item" data-id="id-2" data-type="android" data-title="Android" data-project="Rich Web Application" data-year="2012 Project">
            <a href="javascript:;"><img src="/css/img/product/work-demo3.png" alt="Description"/></a>
            <a class="view" href="javascript:;"></a>
        </li>

        <li class="work item" data-id="id-3" data-type="web" data-title="Web" data-project="Site Rebrand" data-year="2011 Project">
            <a href="javascript:;"><img src="/css/img/product/work-demo2.png" alt="Description"/></a>
            <a class="view" href="javascript:;"></a>
        </li>
    </ul>
    <!-- I have 3 of the above columns, I would like the filter to act on all of them -->
    <!-- I have only included 1 to keep it short -->
</div> 
```

- 准备好：[**JSFiddle！！**](http://jsfiddle.net/SVYFY/)

* * *

## - 更新 -

我最终决定购买并使用[Isotope](http://isotope.metafizzy.co/)插件。网站上的例子很好，可以达到我需要的效果。
非常可定制，是我需要的完美插件。（如果你读到这个，它可能是你想要的）。
查看：http: [//isotope.metafizzy.co/](http://isotope.metafizzy.co/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T22:04:44.120

**状态：**这是您想要使用下面的现场演示的示例：[jsFiddle](http://jsfiddle.net/3cpmu/1/)

我强烈推荐这个[带有现场演示的教程，它展示了使用](http://tutorialzine.com/2011/06/beautiful-portfolio-html5-jquery/)**流沙**插件的绝佳方法。下面显示的评论包括我解释如何在导航中具有可点击链接的一些提示。

标记与您的非常相似，除了 Quicksand JavaScript 文件之外，还需要一个**单独的资产文件**来配置您的 jsFiddle 未使用的 Quicksand。

可以肯定的是，这个资产文件是**Click 事件**处理程序，它根据您的标记布局激活流沙过滤。例如，这个[jsFiddle](http://jsfiddle.net/9cJPC/)显示了来自 Quicksand 网站的 5 个准备使用示例中的 1 个，这些示例链接在[示例部分](http://razorjack.net/quicksand/docs-and-demos.html#examples)中。我所指的单独资产文件可以被视为 JavaScript 窗口中的 jQuery 标记。

另请注意，**jQuery UI 库是必需**的，并且在上述 jsFiddle 中作为资产加载。

我在原始演示的基础上创建了一个**带有 Shadowbox 的流沙演示，这是一个灯箱替代品。**它在[Shadowbox 论坛](http://shadowbox.1309102.n2.nabble.com/Quicksand-Demo-featuring-Shadowbox-tp7303500.html)上。如果您需要这方面的帮助，请访问并在那里发帖，我很乐意提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-10T11:13:18.297

此错误/错误是因为该插件不适用于最新版本的 jQuery。您可以只使用旧的 jQuery 来解决它（我刚刚尝试过 1.7.2 并且它可以工作）。

请原谅我的英语...

# c++ - boost中的单元测试

> ID：10789324
> 
> 赞同：0
> 
> 时间：2012-05-28T19:04:22.477
> 
> 标签：c++, boost

我的单元测试有以下代码：

```
BOOST_AUTO_TEST_CASE (test_adapter) {
  boost::random::mt19937 gen;
  boost::normal_distribution<> nd1(10.0,31.0);
  unsigned int imax = 1000;
  std::vector<double> x, x_p;
  for (unsigned int k = 0 ; k < 1000 ; k++) {
    std::vector<double>().swap(x);
    std::vector<double>().swap(x_p);
    for (unsigned int i = 0 ; i < imax ; i++) {
      x.push_back(nd1(gen));
      x_p.push_back(nd1(gen));
        }
   }
        log_rtns <double >lr;
        BOOST_CHECK(lr( x, x_p) == false ); 
```

}

这是我的 log_rtns：

```
template<class T>
class log_rtns: public std::binary_function<T,T,bool> {
 public:
  inline bool operator()(T t, T t_p) {return (std::log(t/t_p));}
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:07:03.097

您正在创建一个`log_rtns`变量（此处`log_rtns lr;`）而不指定模板参数`T`。所以你必须写`log_rtns<something> lr;`。

我猜你想要`log_rtns<double>`，但`lr`没有使用该变量。

你也不能调用`BOOST_CHECK_CLOSE()`两个数组。你必须做类似的事情

```
BOOST_CHECK_EQUAL(x.size(), x_p.size());
for (size_t i = 0; i < x.size(); ++i) {
    BOOST_CHECK_CLOSE(x[i], x_p[i], 0.00000000000);
} 
```

# scala - Scala-redis 订阅 * 但收到零消息

> ID：10789325
> 
> 赞同：2
> 
> 时间：2012-05-28T19:04:26.197
> 
> 标签：scala, redis, akka

使用 Akka 将 redis 与我的 Scala 应用程序集成，但由于某种原因它没有收到任何消息。我可以通过在命令行上打开 redis-cli 来确认 redis 确实有大量流量。

在 pSubscribe 之后，它会收到：`subscribed to * and count = 1`

我的猜测是，这可能与 Akka 设置接收回调的方式有关。由于一些冲突，我不得不在 scala-redis 库中删除 Scala Actors 并用 Akka Actors 替换它们。

这是代码：

## 订阅者演员

```
class Subscriber(client: RedisClient) extends Actor {
  var callback: PubSubMessage => Any = { m => }

  def receive: Receive = { 
    case Subscribe(channels) =>
      client.subscribe(channels.head, channels.tail: _*)(callback)

    case pSubscribe(channels) =>
      client.pSubscribe(channels.head, channels.tail: _*)(callback)

    case pSubscribeAll(channels) =>
      Logger.info("Subscribing to all channels")
      client.pSubscribe(channels.head, channels.tail: _*)(callback)

    case Register(cb) =>
      Logger.info("Callback is registered")
      callback = cb

    case Unsubscribe(channels) =>
      client.unsubscribe(channels.head, channels.tail: _*)

    case UnsubscribeAll =>
      client.unsubscribe
  }
} 
```

## 初始化订阅者

```
class RelaySub extends Actor {

  // important config values
  val system = ActorSystem("pubsub")
  val conf = play.api.Play.current.configuration
  val relayPubHost = conf.getString("relays.redis.host").get
  val relayPubPort = conf.getInt("relays.redis.port").get

  val rs = new RedisClient(relayPubHost, relayPubPort)
  val s = system.actorOf(Props(new Subscriber(rs)))
  s ! Register(callback) 
  s ! pSubscribeAll(Array("*"))
  Logger.info("Engine Relay Subscriber has started up")

  def receive: Receive = {      
    case Register(callback) =>
  }

  def callback(pubsub: PubSubMessage) = pubsub match {
    case S(channel, no) => Logger.info("subscribed to " + channel + " and count = " + no)
      case U(channel, no) => Logger.info("unsubscribed from " + channel + " and count = " + no)
      case M(channel, msg) => 
        msg match {
          // exit will unsubscribe from all channels and stop subscription service
          case "exit" => 
            Logger.info("unsubscribe all ... no handler yet ;)")

          // message "+x" will subscribe to channel x
          case x if x startsWith "+" => 
            Logger.info("subscribe to ... no handler yet ;)")

          // message "-x" will unsubscribe from channel x
          case x if x startsWith "-" => 
            Logger.info("unsubscribe from ... no handler yet ;)")

          // other message receive
          case x => 
            Logger.info("Engine: received redis message")
            val channelVars = channel.split(".").toArray[String]
            if(channelVars(0)!=Engine.instanceID)
                channelVars(1) match {
                  case "relay" => 
                    EngineSyncLocal.constructRelay(channel, msg)
                  case _ => 
                    Logger.error("Engine: received unknown redis message")
                }
        }
  }
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:19:13.287

我发现了问题。它似乎是 scala-redis 客户端中的一个错误。

我在消费者类中添加了一些日志记录并开始收到`Engine: weird message`错误，这意味着它无法识别传入的流量。我会联系作者并提出拉取请求。

编码：

```
class Consumer(fn: PubSubMessage => Any) extends Runnable {

    def start () {
      val myThread = new Thread(this) ;
      myThread.start() ;
    }

    def run {
      whileTrue {
        asList match {
          case Some(Some(msgType) :: Some(channel) :: Some(data) :: Nil) =>
            Logger.info("Engine: redis traffic")
            msgType match {
              case "subscribe" | "psubscribe" => fn(S(channel, data.toInt))
              case "unsubscribe" if (data.toInt == 0) => 
                fn(U(channel, data.toInt))
                break
              case "punsubscribe" if (data.toInt == 0) => 
                fn(U(channel, data.toInt))
                break
              case "unsubscribe" | "punsubscribe" => 
                fn(U(channel, data.toInt))
              case "message" | "pmessage" => 
                fn(M(channel, data))
              case x => throw new RuntimeException("unhandled message: " + x)
            }
          case _ => Logger.error("Engine: weird redis message")
        }
      }
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T16:31:32.440

```
 case x => throw new RuntimeException("unhandled message: " + x)
          }
case Some(Some("pmessage")::Some(pattern)::Some(channel):: Some(message)::Nil)=>
              fn(M(channel, message)) 
```

asList 匹配缺少一个案例

# r - 我得到 131 kb 而不是 507 kb

> ID：10789326
> 
> 赞同：-2
> 
> 时间：2012-05-28T19:04:30.960
> 
> 标签：r

我只想从 float32 转换为 16b，比例因子为 10。我应该得到大小为 507kb（720*360*2）而不是 131kb 的文件。有什么帮助吗？

```
dir1 <- list.files("C:\\New folder (13)", "*.img", full.names = TRUE)
results <- list()
for (.files in seq_along(dir1)){
   file2 <- readBin(dir1[.files], double(), size = 4, n = 360*720, signed = TRUE)
   results[[length(results) + 1L]] <- file2[file2 != -9999]*10
   fileName <- sprintf("C:\\SWdown_200001_%d.bin", .files)
   writeBin(as.integer(results[[.files]]), fileName, size = 2)
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:20:19.360

'file2' 中等于 -9999 的每个元素都不会出现在 results[[.files]] 中。看起来“file2”中大约 3/4 的元素等于这个值。也许您想为这些元素分配不同的值，而不是在分配给 results[[...]] 时删除它们。

做你想做的事，试试这个：

```
file2[file2 != -9999] <- file2[file2 != -9999]*10
results[[length(results) + 1L]] <- file2; 
```

# asp.net-mvc - MVC jquery MOBILE 自动完成 - 创建项目符号而不是下拉菜单

> ID：10789332
> 
> 赞同：0
> 
> 时间：2012-05-28T19:05:16.450
> 
> 标签：asp.net-mvc, jquery-mobile

我在 jquery mobile 中遇到自动完成问题。我想创建一个文本输入，当用户在其中输入时，与用户输入的内容相对应的城市会显示在下拉菜单中，类似于 Google 搜索的工作方式。

我的问题是，它不是下拉菜单，而是创建所有城市的项目符号列表。我实现了 CSS 主题并启用了所有必要的 jquery/jquery 移动 ui 脚本。

在观看 MVC 上的 MVC 复数教程后，我能够连接到城市名称数据库并创建以下代码（这些只是片段）：

**看法**

```
<p>Hotel Location (City): <input type="text" data-autocomplete="@Url.Action("QuickSearch", "Booking")"/></p> 
```

**Javascript/Jquery**

```
 $(document).ready(function () {        
    $(":input[data-autocomplete]").each(function () {
        $(this).autocomplete({ source: $(this).attr("data-autocomplete") }); 
    });
  }); 
```

**控制器**

```
public ActionResult QuickSearch(string term)
    {
        testautocompleteDataContext _db = new testautocompleteDataContext();
        var cities = _db.CityTests
                        .Where(r => r.city.Contains(term))
                        .Take(10)
                        .Select(r => new { label = r.city });
        return Json(cities, JsonRequestBehavior.AllowGet); 
     } 
```

谢谢！我非常感谢您的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:53:15.053

我的错。我实际上忘记在我的布局页面中添加 jquery ui！愚蠢的错误哈哈哈

# php - PHP - 使用数组参数初始化对象成员

> ID：10789334
> 
> 赞同：0
> 
> 时间：2012-05-28T19:05:21.727
> 
> 标签：php, spl

是否可以使用关联数组在 php 中初始化对象私有或受保护成员。

例如：

```
 class TestClass
{
    public $_name;
    public $_age;

    public function __construct(array $params)
    {
        ??????
    }
}

$testClass = new TestClass(
    array(
        'name'  => 'Bob',
        'age' => '29',
    )
); 
```

我想知道是否有一个优雅的解决方案 - 也许通过实现一个 spl 接口或其他方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:06:35.543

```
foreach ($params as $key=>$value)
{
 $key = '_'.$key;
 $this->$key=$value;
} 
```

[在此处](http://codepad.org/JTExIeOr)查看工作示例的在线代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:51:08.973

你提到了 SPL。但是在不知道您的对象用途的确切要求的情况下，以下是我可以提供的唯一信息......

您可以让您的对象扩展 SPL 内置类`ArrayIterator`。然后，不用担心在构造函数中处理它（已经在父`ArrayIterator`类中处理），您可以像这样将一个数组导入到您的对象中：

```
class testClass extends ArrayIterator
{

 /* child '__construct' method not required */

 /* rest of your code here */

}

$t = new testClass(array('name' => 'asdf', 'age' => 99)); 
```

请记住，使用默认`ArrayIterator`行为，您以后不能像使用普通对象属性那样访问任何传递的数组值。您必须像访问数组一样访问它们：

```
echo $t['name']; // 'asdf'
echo $t->name; // NULL property unknown error 
```

而且，在内部，传递的数组作为单个私有`storage`参数存储在您的对象中。在您的情况下，您已经预先定义了所有对象属性并在前面加上下划线，因此您可能必须手动循环`$this`或`$params`无论如何在构造函数中设置任何真实对象属性。

您当然可以重新定义所有子对象的继承方法来处理您在or`ArrayIterator`上的特殊属性命名情况，但这似乎是多余的且没有效率，而不是在构造函数中循环/setting 。`get``set``$params``$this`

```
 public function __construct(array $params)
    {
        foreach ($params as $key => $val) {
            if (property_exists($this, "_$key")) {
                $this->{"_$key"} = $val;
            }
        }
    } 
```

因此，仅在构造函数中循环`$params`/setting`$this`可能是最好、最简单的解决方案。

# django - {{ STATIC_URL }} 在部署中会发生什么

> ID：10789339
> 
> 赞同：0
> 
> 时间：2012-05-28T19:05:41.727
> 
> 标签：django, deployment, static

简单的问题：

`{{ STATIC_URL }}`部署中的变量会发生什么？例如，如果我使用这样的过滤器：

```
@register.filter
def new_filter(g):
    from myapp import settings
    STATIC_URL = settings.STATIC_URL
    return STATIC_URL + 'dir/' + g 
```

我会遇到问题还是 Django 仍然指向与`STATIC_URL`localhost 中的相同？

我已经阅读了[文档](https://docs.djangoproject.com/en/dev/howto/static-files/#deploying-static-files-in-a-nutshell)，但我仍然不确定这一点。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:13:38.490

您的过滤器将始终指向`settings.STATIC_URL`故事结尾中定义的任何内容。

如果您更改生产设置，您的过滤器现在将指向您的新`STATIC_URL`. 如果你不这样做，它不会。

如果您`STATIC_URL`是相对 URL，您的 URL 将自动解析到主机。

*   `/static/`on development 可能会被查找为 localhost/static/
*   `/static/`在生产 example.com 上，浏览器将尝试 example.com/static/

如果它是绝对的，那么生产或开发浏览器将读取相同的资源，直到您更改`STATIC_URL`.

# hudson - 如何在 Jenkins/Hudson 中以编程方式设置环境变量？

> ID：10789341
> 
> 赞同：15
> 
> 时间：2012-05-28T19:05:44.987
> 
> 标签：hudson, jenkins, environment-variables, hudson-plugins, jenkins-plugins

我在 Jenkins 作业的预构建步骤中有两个脚本，第一个是 perl 脚本，第二个是使用 groovy 插件的系统 groovy 脚本。我需要第二个 groovy 脚本中第一个 perl 脚本的信息。我认为最好的方法是设置一些环境变量，并且想知道如何实现。

或者任何其他更好的方法。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-28T19:20:22.713

在构建步骤之间传播环境变量的方法是通过[EnvInject Plugin](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)。

以下是一些以前的答案，展示了如何做到这一点：

*   [如何在 Jenkins 中设置环境变量？](https://stackoverflow.com/a/10626193/1178189)
*   [Jenkins：在电子邮件正文中报告中间 [windows 批处理] 构建步骤的结果](https://stackoverflow.com/a/10626180/1178189)

但是，在您的情况下，在一个构建步骤中写入文件并在另一个构建步骤中读取该文件可能更简单。为确保您不会意外读取文件的先前版本，您可以将其合并`BUILD_ID`到文件名中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-14T07:19:12.537

从作业配置中使用[EnvInject 插件](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)，您应该使用`Inject environment variables to the build process / Evaluated Groovy script`.

根据您可以执行`Groovy`或`shell`命令的设置并将其保存在包含环境变量的地图中：

# 例子

通过使用`execute`方法获取命令结果：

```
return [DATE: 'date'.execute().text] 
```

或`Groovy`等效的，如果存在的话：

```
return [DATE: new Date()] 
```

# telerik-scheduler - 无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）。Telerik 应用程序

> ID：10789345
> 
> 赞同：0
> 
> 时间：2012-05-28T19:06:12.630
> 
> 标签：telerik-scheduler

将 RadScheduler 添加到我的项目时出现此错误。我正在使用 Visual Studio 2010 和 RadControls 2011 q2 感谢您的帮助

无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）。

```
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Web.HttpException: The Controls collection cannot be modified because the control contains code blocks (i.e. <% ... %>).

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[HttpException (0x80004005): The Controls collection cannot be modified because the control contains code blocks (i.e. <% ... %>).]
   System.Web.UI.ControlCollection.Add(Control child) +8828175
   Telerik.Web.SkinRegistrar.RegisterCssReference(Page _page, Control _control, String _url) +486

    [HttpException (0x80004005): Please, see whether wrapping the code block, generating the exception, within RadCodeBlock resolves the error.]
       Telerik.Web.SkinRegistrar.RegisterCssReference(Page _page, Control _control, String _url) +557
       Telerik.Web.SkinRegistrar.RegisterCssReferences(ISkinnableControl _control) +1563
       Telerik.Web.UI.RadDataBoundControl.RegisterCssReferences() +74
       Telerik.Web.UI.RadDataBoundControl.ControlPreRender() +50
       Telerik.Web.UI.RadDataBoundControl.OnPreRender(EventArgs e) +47
       Telerik.Web.UI.RadScheduler.OnPreRender(EventArgs e) +131
       System.Web.UI.Control.PreRenderRecursiveInternal() +103
       System.Web.UI.Control.PreRenderRecursiveInternal() +175
       System.Web.UI.Control.PreRenderRecursiveInternal() +175
       System.Web.UI.Control.PreRenderRecursiveInternal() +175
       System.Web.UI.Control.PreRenderRecursiveInternal() +175
       System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2496 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T11:26:19.577

当有 <% %> 块时，您不能修改控制树。查看[此](http://www.telerik.com/help/aspnet-ajax/ajax-radscriptblock-radcodeblock.html)帮助主题以获取更多信息。

# sql - 有没有一种将快速变化的内存数据与大型 SQL 数据库数据混合的好方法？

> ID：10789351
> 
> 赞同：1
> 
> 时间：2012-05-28T19:06:36.963
> 
> 标签：sql, .net, linq

我正在使用一种架构，该架构需要将大型（静态）表与非常频繁更改的数据相结合。

为了强调这一点，想象一下 SO 网站用户访问内部加入了他们的用户数据库）。

```
SELECT * FROM UserProfile INNER JOIN OnlineUser (on UserProfiles.id = OnlineUser.id) 
```

其中 UserProfile 位于一个大型 SQL 表中，而 OnlineUser 是 Web 服务器上的动态数据。

将所有内容都放入内存会占用大量空间，并且将所有内容都放入数据库中确实会给服务器带来负担（想到它就不寒而栗）。有没有更好的方法来做到这一点？

~~上帝~~Jon Skeet[说](https://stackoverflow.com/a/1982103/190708)LINQ 无法处理内存中集合和数据库表之间的连接。他建议使用包含子句或列表，在这种情况下两者都不合适。

**编辑：**

SQL Server 中的内存表 (PINTABLE) 可以做到这一点。由于该功能已被弃用，是否可以假设 SQL Server 2008 会设法将其保存在内存中以减少 IO？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:14:44.930

您必须在某处进行实际的连接操作。要么将`OnlineUser`数据带到 SQL Server 并在那里执行连接，要么将`UserProfile`数据带入内存并在那里执行连接。

通常最好让数据库服务器整理出所需的数据，然后只将其读入内存。解决该问题的一种方法是在 SQL Server 上创建一个临时表，在其中放置连接操作所需的数据字段（在您的示例中`OnlineUser.id`）。

然后执行 SQL 查询，将所需的数据放入内存。确保您拥有加快过滤速度的索引。检索到内存后，匹配两个集合（例如，将它们按相同的键排序，然后使用 linq`Zip`运算符）

# ios - iOS - 限制使用单个应用程序

> ID：10789352
> 
> 赞同：3
> 
> 时间：2012-05-28T19:06:39.283
> 
> 标签：ios

我正在开发一个在 iPad/iPod Touch 上使用的商业应用程序。我想知道是否有办法将设备上的使用限制为仅限我的应用程序。换句话说，我们不希望员工安装其他应用程序（例如游戏）并玩弄这些设备。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T19:12:19.547

是的，这是可能的。

查看[iOS 配置文件编程指南](https://developer.apple.com/library/ios/#featuredarticles/iPhoneConfigurationProfileRef/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010206)。

**编辑：**请参阅有关限制的部分，它将允许您完全按照您的需要做。但是请注意，您需要有权访问这些设备，理想情况下，这些设备应该是公司财产。您需要通过 Enterprise Distribution 分发您的应用程序。

**编辑 2：**从 iOS6 开始，此功能可通过普通设置应用程序使用。它被称为“引导式访问”，是辅助功能设置的一部分。它可以让你禁用主页按钮（通过三次单击主页按钮并输入预设代码来取消引导访问），它甚至可以让你定义应用程序中应该禁用的区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:12:10.670

我不这么认为，除非他们的设备已越狱。

如果他们登录到 Exchange 服务器，如果他们安装了任何东西，您可以远程擦除他们的手机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:12:26.273

你们提供设备吗？还是他们自带？

如果您提供的设备意味着您可以使用您的 Apple-id。如果员工尝试下载任何其他应用程序，他将需要您的 Apple-id 密码。所以这是防止这种情况的简单方法。

我不确定是否有这种类型的总“锁”。

# ruby - 具有 X 个单元格的表格行的 CSS 选择器

> ID：10789358
> 
> 赞同：0
> 
> 时间：2012-05-28T19:07:17.243
> 
> 标签：ruby, css-selectors, nokogiri

我正在尝试从网站上抓取一些内容，但我无法选择正确的元素。

我正在使用 Nokogiri，并且，因为我最了解 CSS，我正在尝试使用它来选择我想要的数据。

有一张大桌子，里面有我不想要的行，但这些可以改变；例如，它们并不总是第 4、5、6、10、14 行。

我可以判断它是否是我想要的行的唯一方法是该行中是否有`TD`标签。执行此操作的正确 CSS 选择器是什么？

```
 # Search for nodes by css
  doc.css('#mainContent p table tr').each do |td|
  throw td
  end 
```

* * *

编辑：

我正在尝试抓取[boxrec.com/schedule.php](http://boxrec.com/schedule.php?country=WWW&division=&title=&tv=&SUBMIT=Go)。我想要每个匹配的行，但是，它是一个非常大的表，其中包含许多不匹配的行。不需要每个日期部分的前几行，包括具有“bout subject to change...”的每一行，以及天之间的间隔行。

解决方案：

```
doc.xpath("//table[@align='center'][not(@id) and not(@class)]/tr").each do |trow|

    #Try get the date
    if trow.css('.show_left b').length == 1
      match_date = trow.css('.show_left b').first.content

    end

    if trow.css('td a').length == 2 and trow.css('* > td').length > 10

      first_boxer_td = trow.css('td:nth-child(5)').first
      second_boxer_td = trow.css('td:nth-child(5)').first

      match = {
        :round => trow.css('td:nth-child(3)').first.content.to_i,
        :weight => trow.css('td:nth-child(4)').first.content.to_s,
        :first_boxer_name => first_boxer_td.css('a').first.content.to_s,
        :first_boxer_link => first_boxer_td.css('a').first.attribute('href').to_s,
        :second_boxer_name => second_boxer_td.css('a').first.content.to_s,
        :second_boxer_link => second_boxer_td.css('a').first.attribute('href').to_s,
        :date => Time.parse(match_date)
      }  

      #:Weight => trow.css('td:nth-child(4)').to_s
      #:BoxerA => trow.css('td:nth-child(5)').to_s
      #:BoxerB => trow.css('td:nth-child(9)').to_s    

      myscrape.push(match)

    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:16:50.623

您将无法判断a 包含*多少* `td`个元素`tr`，但您可以判断它是否为空：

```
doc.css('#mainContent p table tr:not(:empty)').each do |td|
  throw td
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T01:26:48.070

你可以这样做：

tr 行，第 4 个 td

```
doc.xpath('//tr/td[4]/..') 
```

使用 css 的另一种方式：

```
doc.css('tr').select{|tr| tr.css('td').length >= 4} 
```

# php - PHP会话丢失

> ID：10789361
> 
> 赞同：-2
> 
> 时间：2012-05-28T19:07:33.007
> 
> 标签：php, jquery, session, session-variables, session-cookies

我正在尝试使用 jQuery 和 PHP 实现和身份验证系统。所有的 php 工作都是在控制器和数据处理程序类中完成的。.html 文件中没有 php 代码，.html 文件中的所有值都是通过 jQuery 呈现的，该 jQuery 从 php 服务器请求数据。所以我想做的是：

1.  当用户单击登录按钮时，jQuery 会调用我的控制器类中的 authenticate() 方法，它会检查用户是否正确，如果正确，则启动会话并在会话上设置 user_id 所以我稍后可以访问它，并再次将userId返回给jQuery客户端。
2.  之后，如果一切正常，在 jQuery 中我将其重定向到 html 文件。在 html 文件中，我从`<script>`将处理其他权限的标记中调用 jQuery。但是这个 jQuery 将访问方法 getPermissionString（来自前面提到的同一类`authenticate()`方法），它需要获取在 authenticate 方法中设置的会话值。

**问题：**

当我尝试获取其中的会话值时，`getPermissionString()`它说：

> 注意：未定义的变量：_SESSION

我试图检查会话是否在第二种方法中注册，但看起来不是。这是我的PHP代码。

任何想法？谢谢。

```
public function authenticate($login, $password)
{
    $result = $this->userDataHandler->authenticateUser($login, $password);

    if(is_numeric($result) && $result != 0) 
    {
        session_start();
        $_SESSION["uid"] = $result;

        if(isset($_SESSION["uid"]))
        {
            echo "registered";
            $userId = $_SESSION["uid"]; 
        }
        else
        {
            echo "not registered";  
        }

        echo $result;
    }
    else
    {
        echo 0; 
    }
}

public function getPermissionString()
{
    if(isset($_SESSION["uid"]))
    {
        echo "registered";
        $userId = $_SESSION["uid"]; 
    }
    else
    {
        echo "not registered";  
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:25:14.413

在您可以访问`$_SESSION`第二个功能之前，您需要确保程序已经`session_start()`预先调用。仅当激活会话时才会填充全局变量。如果您不记得在使用之前启动会话，那么您可以更改下面的 php.ini 变量：

```
[session]
session.auto_start = 1 
```

此外，您说您正在为您的代码使用一个类。在这种情况下，您还可以在每次使用魔术方法创建类时自动启动会话：

```
class auth {
  function __construct() {
    session_start();
  }
  function yourfunction() {
    ...
  }
  function yoursecondfunction(){
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:28:07.527

如果会话未启动，则不应使用该功能。所以抛出一个异常：

```
public function getPermissionString()
{
    if (session_status() !== PHP_SESSION_ACTIVE)
    {
        throw new Exception('No active session found.');
    }

    if(isset($_SESSION["uid"]))
    {
        echo "registered";
        $userId = $_SESSION["uid"]; 
    }
    else
    {
        echo "not registered";  
    }
} 
```

这样可以确保在函数内部检查函数的先决条件，因此您无需在每次调用函数之前都检查它。

如果您错误地使用该函数，您现在将看到一个异常，它会给您一个回溯，以便您可以更轻松地分析您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:20:21.507

如果您没有启用[session.auto_start ，并且在两个不同的请求上调用了](http://www.php.net/manual/en/session.configuration.php#ini.session.auto-start)*authenticate*和*getPermissionString*，则需要在每个函数中调用[session_start() 。](http://php.net/manual/en/function.session-start.php)

如果您需要有关如何传递会话 ID 的更多信息，请阅读[传递会话 ID](http://www.php.net/manual/en/session.idpassing.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T19:15:26.143

要使 php 会话正常工作，您必须在`session_start()`每次浏览器请求脚本时调用。

# c# - Windows Phone SDK - XAML - 上边距的自动边距

> ID：10789362
> 
> 赞同：1
> 
> 时间：2012-05-28T19:07:37.107
> 
> 标签：c#, windows, windows-phone-7, xaml

`XAML`我有以下内容`my Windows Phone app`：

```
<StackPanel Orientation="Horizontal">
  <Grid x:Name="LayoutRoot">
    <Image Source="{Binding ImageUrl}" Height="80" HorizontalAlignment="Left" Margin="10,10,0,0" Stretch="Fill" VerticalAlignment="Top" Width="93" />
    <TextBlock name="NameBlock" Text="{Binding Name}" FontSize="30" Margin="150,20,0,0" TextWrapping="Wrap" HorizontalAlignment="Left" VerticalAlignment="Top" Width="300" />
    <TextBlock name="DescriptionBlock" Text="{Binding Description}" FontSize="25" Margin="150,150,0,0" TextWrapping="Wrap" HorizontalAlignment="Left"  VerticalAlignment="Top" Width="300" />
  </Grid>
</StackPanel> 
```

目前，我将第二个 TextBlock ( `DescriptionBlock`) 的边距设置为静态值。现在因为我将第一个`TextBlock`( `NameBlock`) 的工作包装设置为`"Wrap"`，所以 的高度`TextBlock`是可变的。

**有谁知道如何使上边距`DescriptionBlock`等于自动高度`NameBlock`？**这将确保第二个 DescriptionBlock 直接出现在 的下方`NameBlock`，而与 的文本长度无关`NameBlock`。

非常感谢！布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:57:07.353

这就是面板的用途。将两个文本块包裹在堆栈面板中，它将一个文本块堆叠在另一个之上。

```
 <Grid x:Name="LayoutRoot">
        <Image Source="{Binding ImageUrl}" Height="80" HorizontalAlignment="Left" Margin="10,10,0,0" Stretch="Fill" VerticalAlignment="Top" Width="93" />
        <StackPanel Margin="150,20,0,0" Width="300">
            <TextBlock name="NameBlock" Text="{Binding Name}" FontSize="30"  TextWrapping="Wrap" HorizontalAlignment="Left" />
            <TextBlock name="DescriptionBlock" Text="{Binding Description}" FontSize="25" TextWrapping="Wrap" HorizontalAlignment="Left" />
        </StackPanel>
    </Grid> 
```

容纳单个孩子的面板通常是没用的，所以我删除了网格周围的堆栈面板。

如果您想继续使用`Grid`，您可以定义行使其自动调整大小。

# php - gmail没有正确显示html文本

> ID：10789364
> 
> 赞同：2
> 
> 时间：2012-05-28T19:08:01.933
> 
> 标签：php, html, gmail

我制作了向用户发送 html 电子邮件的脚本。但是，在 Gmail 中，我似乎无法让字体颜色正常工作。它适用于第一条消息，但对话中的下一条消息都显示为紫色。

仅当我使用 file_get_Contents()) 从 .txt 文件中获取字符串时才会发生这种情况。如果我用班级中的字符串填充变量或直接输入消息而不是使用变量，gmail 会正常显示 html。我没有发现其他网络邮件或邮件客户端有任何问题。对于邮件的实际发送，我尝试了[phpmailer](https://code.google.com/a/apache-extras.org/p/phpmailer/)和常规的 mail() 函数。

```
 $message = "<html><body><font face='Georgia, Times' color='red'>";
    $message .= "<p>Beste " . $this->name . "</p>";
    $message .= "<p>" . $parPersonal . "</p>";
    $message .= "<p>" . $parOne . "</p>";
    $message .= "<p>" . $parTwo . "</p>";
    $message .= "<p>" . $parThree . "</p></font></body></html>"; 
```

来自gmail的截图：

![https://imgur.com/h8cLL](../Images/805d60e78d4be09b3446c7d6959a9151.png)

附带说明一下，此脚本通常一次只会向 1 个人发送 1 封电子邮件，并且此问题不应该出现，它目前只是邮寄到我自己的 gmail 帐户以进行测试。但是，我非常好奇如何为将来的目的解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:19:41.010

这很可能是由于`<font>`标签嵌套不当造成的。

标签是一个内联`<font>`元素，它应该嵌套在你的块元素中，比如`<p>`标签。

这会导致 HTML 非常混乱，但电子邮件客户端使用的相当陈旧的 html 引擎就是如此。

如今，您可以在元素中使用内联样式来获得良好的覆盖率（但单独`<style>`的块仍然很难覆盖）。请参阅 CampaignMonitor 提供的这个很棒的资源，了解您可以使用的内容：http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:14:02.420

不要使用`<font>`标签。这就是您在 1995 年为 html 设置样式的方式。而是尝试使用内联样式：

```
<p style="color: red; font-family: Georgia, Times"> 
```

作为一般的仅供参考。许多电子邮件客户端从基于 html 的电子邮件中删除样式表信息。如果您有一个想要着色的特定区域，您可能需要考虑使用图像。

也就是说，您还应该知道，内联样式/过度使用旨在突出 CLICK ME 链接的强标签可以增加您的电子邮件的整体跨度分数。

# hibernate - 如何在 JSP 中显示列表？

> ID：10789365
> 
> 赞同：1
> 
> 时间：2012-05-28T19:08:24.327
> 
> 标签：hibernate, jsp

这个 Servlet，我在 color car 上做 GROUP BY。插入到请求中并在 jsp 中做广告，但它不会转换。

```
 Query query = session.createQuery("select count(carColor), carColor from Cars group by carColor order by carColor");
    List<Cars> list = query.list();
    Iterator iter = list.iterator();
    while (iter.hasNext()) {
        Object[] obj = (Object[]) iter.next();
        System.out.println(obj[0] + "  " + obj[1]);

    }

    request.setAttribute("list", list); 

    RequestDispatcher rd = request.getRequestDispatcher("test.jsp");
    rd.forward(request, response); 
```

控制台：2白10黑5蓝

JSP: [[Ljava.lang.Object;@1f3b536, [Ljava.lang.Object;@fdffb1,]]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T19:24:49.790

你的代码真的没有意义：

```
List<Cars> list = query.list(); 
```

在上面的行中，您声明您的列表是 Cars 列表（它不是）

```
Iterator iter = list.iterator();
while (iter.hasNext()) {
    Object[] obj = (Object[]) iter.next(); 
```

然后迭代列表，并将每个元素转换为`Object[]`. Cars 实例怎么可能是`Object[]`? 该列表应声明为`List<Object[]>`，并且您不应使用原始类型。你的循环应该写成

```
Iterator<Object[]> iter = list.iterator();
while (iter.hasNext()) {
    Object[] obj = iter.next(); 
```

或者，更简单：

```
for (Object[] obj : list) { 
```

现在，在 JSP 中，我怀疑您只是`${list}`用来显示列表。这只是调用列表上的 toString() 方法，它本身调用每个元素的 toString() 方法。由于每个元素都是`Object[]`，因此结果字符串是`[Ljava.lang.Object;@1f3b536`，这意味着“具有 hashCode 1f3b536 的对象数组”。

要显示列表的元素，您应该遍历列表，因为您必须在 Java 代码中执行此操作：

```
<c:forEach var="array" items="${list}">
    Count: ${array[0]} - Color: <c:out value="${array[1]}"/> <br/>
</c:forEach> 
```

# java - ui:include JSF 标签后面的类

> ID：10789373
> 
> 赞同：4
> 
> 时间：2012-05-28T19:09:06.527
> 
> 标签：java, jsf, implementation, uiinclude

`ui:include`标签是如何实现的？我在哪里可以找到它的实现（源代码）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T19:13:12.467

这取决于实现。

在[Mojarra](http://javaserverfaces.java.net)中，它是[`com.sun.faces.facelets.tag.ui.IncludeHandler`](http://grepcode.com/file/repo1.maven.org/maven2/com.sun.faces/jsf-impl/2.1.7/com/sun/faces/facelets/tag/ui/IncludeHandler.java/).
在[MyFaces](http://myfaces.apache.org)中，它是[`org.apache.myfaces.view.facelets.tag.ui.IncludeHandler`](http://www.grepcode.com/file/repo1.maven.org/maven2/org.apache.myfaces.core/myfaces-impl/2.1.6/org/apache/myfaces/view/facelets/tag/ui/IncludeHandler.java/).

# jquery - FancyBox 在函数内部不起作用

> ID：10789375
> 
> 赞同：0
> 
> 时间：2012-05-28T19:09:30.480
> 
> 标签：jquery, wordpress, function, fancybox

我有一个输入表单，在提交时（按回车键）我想显示一个 Fancybox。我为它做了一个函数，但它不会触发。奇怪的是警报有效。

这是功能：

```
 <script type="text/javascript">
    function showBox(){
        $("#profile").fancybox({
            'width'             : '75%',
            'padding'           : '0',
            'height'            : '75%',
            'autoScale'         : false,
            'transitionIn'      : 'fade',
            'transitionOut'     : 'fade',
            'type'              : 'inline',
        });
        alert('ga');
    }
  </script> 
```

这是形式：

```
<form action="javascript:showBox()" method="get">
<input name="s" type="hidden" value="add" />
<input name="pr" type="text" class="ask" placeholder="Placeholder text. So far."/> 
</form> 
```

我真的很茫然，我可以用手。

编辑：整个文件：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" <?php language_attributes(); ?>>

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="<?php bloginfo('html_type'); ?>; charset=<?php bloginfo('charset'); ?>" />

<title><?php bloginfo('name'); ?> <?php if ( is_single() ) { ?> &raquo; Answers Archive<?php } ?> <?php wp_title(); ?></title>
<?
$option1 = get_option("WpAnswersoption1Options");
$pathfavico=str_replace('../','',$option1['favicon']);
?>
<link rel="shortcut icon" type="image/x-icon" href="<?php bloginfo('url'); ?>/<? echo $pathfavico ?>">
<link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="<?php bloginfo('name'); ?> RSS Feed" href="<?php if($option1['rss']!=''){ echo $option1['rss']; }else{bloginfo('rss2_url');} ?>" />
<link rel="pingback" href="<?php bloginfo('pingback_url'); ?>" />

<?php wp_head(); ?>

<script type="application/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/fancybox/jquery.mousewheel-3.0.4.pack.js"></script>
    <script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
    <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory'); ?>/fancybox/jquery.fancybox-1.3.4.css" media="screen" />

    <script type="text/javascript">
        $(document).ready(function() 
        {

            $("#profile").fancybox({
                'width'             : '75%',
                'padding'           : '0',
                'height'            : '75%',
                'autoScale'         : false,
                'transitionIn'      : 'fade',
                'transitionOut'     : 'fade',
                'type'              : 'inline',
            });

            $("#profile-public").fancybox({
                'width'             : '75%',
                'padding'           : '0',
                'height'            : '75%',
                'autoScale'         : false,
                'transitionIn'      : 'fade',
                'transitionOut'     : 'fade',
                'type'              : 'inline',
            });

$("#button_right").mouseover(function () {
      $(this).hide("slide", { direction: "down" }, 1000);
      alert("ga");
});

  });
  </script>

  <script type="text/javascript">
        function showBox(){
            $("#profile").fancybox({
                'width'             : '75%',
                'padding'           : '0',
                'height'            : '75%',
                'autoScale'         : false,
                'transitionIn'      : 'fade',
                'transitionOut'     : 'fade',
                'type'              : 'inline',
            });
            alert('fa')
        };
  </script>

<script>
    if (navigator.userAgent.toLowerCase().indexOf("chrome") >= 0) {
    $(window).load(function(){
        $('input:-webkit-autofill').each(function(){
            var text = $(this).val();
            var name = $(this).attr('name');
            $(this).after(this.outerHTML).remove();
            $('input[name=' + name + ']').val(text);
        });
    });
}
</script>

</head>
<body>

<div id="container">
<?php do_action('beforehead'); //added by tomas ?>
<div id="header">

<div style="display: none;">
    <div id="profile_container">
        <div id="profile-picture">
            <div class="mask" style="padding-top:8px;"><?php
                global $current_user;
                get_currentuserinfo();
                echo get_avatar( $current_user->ID, 150 );
            ?>
            </div>
                <div class="details">
                    <h3>Change profile picture</h3>
            </div>

        </div>
        <div id="profile-name">
            <?php global $current_user;
                get_currentuserinfo();
                echo $current_user->user_login;
            ?> 
        </div>
        <div id="profile-fullname">
            <?php global $current_user;
                get_currentuserinfo();
                echo "(" . $current_user->user_firstname . "&nbsp;" . $current_user->user_lastname . ")";
            ?> 
        </div>

       <div id="social">
            <span class="icon">
                <a href="http://twitter.com/<?php echo get_user_meta(1, 'twitter', true); ?>" title="Follow <?php echo $current_user->user_login; ?> on Twitter"><img src="<?php bloginfo('template_directory'); ?>/images/social/twitter-icon.png" /></a>
            </span>

            <span class="icon">
                <a href="http://facebook.com/<?php echo get_user_meta(1, 'facebook', true); ?>" title="Add <?php echo $current_user->user_login; ?> on Facebook"><img src="<?php bloginfo('template_directory'); ?>/images/social/facebook-icon.png" /></a>
            </span>
       </div>
    </div>
</div>

<div style="display: none;">
    <div id="profile_container_public">
        <div id="profile-picture">
            <div style="padding-top:8px;">
            <?php
            if (have_posts()){
                echo get_avatar( get_the_author_meta('ID'), 150 );
            }
            ?>
        </div>
        </div>
        <div id="profile-name">
             <?php
            global $post;
            echo $post->post_author;
            ?>
  </div>
        <div id="profile-fullname">
        </div>

       <div id="social">
            <span class="icon">
                <a href="http://twitter.com/<?php the_author_meta('twitter'); ?>" title="Follow <?php echo $current_user->user_login; ?> on Twitter"><img src="<?php bloginfo('template_directory'); ?>/images/social/twitter-icon.png" /></a>
            </span>

            <span class="icon">
                <a href="http://facebook.com/<?php the_author_meta('facebook'); ?>" title="Add <?php echo $current_user->user_login; ?> on Facebook"><img src="<?php bloginfo('template_directory'); ?>/images/social/facebook-icon.png" /></a>
            </span>
       </div>
    </div>
</div>

<?php if (is_user_logged_in() ) {?>
<div id="welcome_text">Hello, &nbsp;<span id="welcome_user"><?php global $current_user; get_currentuserinfo(); echo $current_user->user_login  ?></span></div>
<?php } else {?>
<div id="welcome_text">Greetings, stranger. <span id="welcome_user"><a href="/wp-login.php?redirect_to=<?php echo $_SERVER['REQUEST_URI']; ?>" class="simplemodal-login">Log in</a></span> or <span id="welcome_user"><a href="/wp-login.php?action=register" class="simplemodal-register">Register</a></span>!</div>
<?php } ?> 

<?php if (is_user_logged_in() ) {?>
<a href="<?php echo wp_logout_url( home_url() ); ?>" id="power_out"></a>
<a href="" id="help" title="Help"></a>
<a href="<?php bloginfo('url'); ?>/profile/<?php global $current_user; get_currentuserinfo(); echo $current_user->user_login  ?>" id="user" title="Profile"></a>

<?php } else {?>
<a href="/wp-login.php?redirect_to=<?php echo $_SERVER['REQUEST_URI']; ?>" class="simplemodal-login" id="power"></a>
<?php } ?>

<div id="righthead">
<?php do_action('righthead') ?>
</div>
<?
$option1 = get_option("WpAnswersoption1Options");
$pathlogo=str_replace('../','',$option1['logo']);
?>

<?php if (is_user_logged_in() ) {?>
<div id="avatar_box" >
<a id="profile" href="#profile_container"><?php
        global $current_user;
        get_currentuserinfo();
        echo get_avatar( $current_user->ID, 64 );
 ?></a>
 </div>
<?php } else {?>
<div id="avatar_box">
<?php
        global $current_user;
        get_currentuserinfo();
        echo get_avatar( $current_user->ID, 64 );
 ?>
 </div>
<?php } ?>

</div><!-- end header -->
<div id="logo"><a href="<?php bloginfo('url'); ?>" title="I Want An Idea!" id="logo"></a></div>

<div id="askbox">
    <div id="askbox_text_border">
        <div id="askbox_text">
            <form action="javascript:showBox()" method="get">
                <input name="s" type="hidden" value="add" />
                <input name="pr" type="text" class="ask" placeholder="I want an awesome idea about..."/> 
            </form>
        </div>
    </div>
</div><!-- end askbox -->

<div id="main">

<!--<div id="recentbox">
<ul>
<li><a href="<?php bloginfo('url'); ?>"><img src="<?php bloginfo('url'); ?>/wp-content/themes/Wp-Answers-Black/images/recent-button.gif" height="38" width="117" alt="Recent Ideas"/></a></li>
<li><a href="<?php bloginfo('url'); ?>/?s=popular"><img src="<?php bloginfo('url'); ?>/wp-content/themes/Wp-Answers-Black/images/popular-button.gif" height="38" width="127" alt="Popular Questions"/></a></li>
</ul>
</div>--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:54:58.033

这

```
$("#profile").fancybox(); 
```

不会触发fancybox，它只是将选择器绑定`#profile`到它，因此您的函数`showBox()`实际上正在尝试再次将此类选择器绑定到fancybox（您已经有一个脚本可以在文档的其他地方执行此操作）。

您仍然需要在选择器上或通过 jQuery`click`触发。`click`

由于您已经在另一个脚本中将选择器绑定`#profile`到了幻想框，因此您的函数可能只需要像这样触发它：

```
function showBox(){
 $("#profile").trigger("click");
} 
```

或者您可能更愿意`bind`将`submit`事件添加到触发 fancybox 的函数，而不是尝试将其附加到`action`属性

```
$("#askbox_text form").bind("submit", function() {
 $("#profile").trigger("click");
}); 
```

# java - 如何逐列而不是逐行填充二维数组

> ID：10789378
> 
> 赞同：0
> 
> 时间：2012-05-28T19:09:41.720
> 
> 标签：java, arrays, sorting, matrix

我有一份从互联网下载的 .txt 财务报表。当它被下载时，单元格被逐列提取......搞砸了我以简单方式重建语句的能力。

所以我的问题是如何逐列而不是逐行填充二维数组。显然在一个循环中你必须跳过这些行，但我生疏了，无法解决这个简单的问题。帮助支持。

这是我试图以 53 行和 11 列重建的 [损益表 PASTEBUCKET.COM/2303](http://www.pastebucket.com/2303)

和我正常的排序方式。这很可能不会有很大用处

```
 String [][] fs = new String[53][11];
    while (input.hasNextLine())
    {   
            for(int row=0;row<53;row++){
                for (int col=0;col<11;col++){
                fs[row][col] = input.nextLine();
                System.out.printf("%s\t",fs[row][col]);
                }
            }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T19:14:46.583

只需反转哪个 for 循环在另一个内部运行。

```
for (int col=0;col<11;col++){
    for (int row=0;row<53;row++){
        fs[row][col] = input.nextLine();
        System.out.printf("%s\t",fs[row][col]);
    }
} 
```

# .net - 如何以编程方式将样式添加到 Word 文档

> ID：10789379
> 
> 赞同：0
> 
> 时间：2012-05-28T19:09:54.270
> 
> 标签：.net, vb.net, ms-word, ms-office, office-interop

我有一个在 Word 中打开的动态创建的文本框。我正在尝试为其提供 Word 2010 中的默认样式之一（“彩色填充，白色轮廓 - 重音 1），但是我无法找到执行此操作的代码。

以下是我到目前为止的内容，它创建并偏移了文本框：

```
oDoc = oWord.Documents.Add
Dim titleBanner As Word.Shape
titleBanner = oDoc.Shapes.AddTextbox(Microsoft.Office.Core.MsoTextOrientation.msoTextOrientationHorizontal, 81.0#, 20.5, 456.75, 24.75)
titleBanner.TextFrame.TextRange.Text = "This is a textbox!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:30:28.710

看一眼

[http://docx.codeplex.com/](http://docx.codeplex.com/)

您不需要使用 Com，它还允许您进行格式化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T14:22:19.060

这是我所做的：

1.  打开单词
2.  开始录制宏
3.  执行从我的文档中的颜色到我想要的颜色的查找和替换
4.  停止录制宏
5.  打开 VBA 宏
6.  查找颜色的整数值
7.  将以下示例语句中的 -738148353 替换为您的值：

    selection.Font.Color = (Microsoft.Office.Interop.Word.WdColor)(-738148353);

# c - 如何将参数的值包含到生成文件中的字符串中

> ID：10789382
> 
> 赞同：1
> 
> 时间：2012-05-28T19:10:27.313
> 
> 标签：c, makefile, optional-parameters

我有一个makefile，我通过命令行向它传递了一个参数。假设我传递了诸如此类的时钟频率参数。

```
make run FREQ=500 
```

在我的 makefile 中，我想将 FREQ 的值包含在一个字符串中，例如，我想像这样扩展它。

```
RUN_FLG = "--frequency = 500" 
```

我知道如果您正常使用该参数（不在字符串内部），您可以使用 $(FREQ)，但是如何在字符串内部扩展它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:22:53.360

`make`不知道什么是字符串；您将宏引用嵌入到字符串中，就像在字符串外一样：

```
DEFAULT_FREQ = 60
FREQ         = $(DEFAULT_FREQ)

RUN_FLG = "--frequency=$(FREQ)" 
```

我已经“纠正”了`--frequency`; 您通常不会`=`将选项文本与选项分开，并且该值也将不带空格。

我在内部为 FREQ 提供了一个默认值，`makefile`因此如果在没有任何`FREQ=500`覆盖的情况下调用它，您仍然可以将默认值作为`$(RUN_FLG)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:24:14.723

只需使用`$(value)`

例子：

```
freq = 500
x = "--frequency = $(freq)"

run:
    @$(/bin/echo -e) $(x) 
```

输出`make -n`：

```
"--frequency = 500" 
```

# javascript - 在 javascript 中将 Date() 舍入到最接近的 5 分钟

> ID：10789384
> 
> 赞同：75
> 
> 时间：2012-05-28T19:10:29.700
> 
> 标签：javascript

使用`Date()`实例，我如何将时间四舍五入到最接近的五分钟？

例如：如果是下午 4:47，它会将时间设置为下午 4:45

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2012-05-28T19:13:18.203

`Date`如果您已经有一个对象，那非常简单：

```
var coeff = 1000 * 60 * 5;
var date = new Date();  //or use any other date
var rounded = new Date(Math.round(date.getTime() / coeff) * coeff) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2018-01-26T00:28:53.080

# 四舍五入到最接近的 x 分钟

这是一种将日期对象舍入到最接近的 x 分钟的方法，或者如果您不给它任何日期，它将舍入当前时间。

```
let getRoundedDate = (minutes, d=new Date()) => {

  let ms = 1000 * 60 * minutes; // convert minutes to ms
  let roundedDate = new Date(Math.round(d.getTime() / ms) * ms);

  return roundedDate
}

// USAGE //

// Round existing date to 5 minutes
getRoundedDate(5, new Date()); // 2018-01-26T00:45:00.000Z

// Get current time rounded to 30 minutes
getRoundedDate(30); // 2018-01-26T00:30:00.000Z 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-06-05T13:53:21.280

使用 ES6 和部分函数，​​它可以很优雅。选择是否需要四舍五入到最接近或始终向下/向上：

```
const roundTo = roundTo => x => Math.round(x / roundTo) * roundTo;    
const roundDownTo = roundTo => x => Math.floor(x / roundTo) * roundTo;
const roundUpTo = roundTo => x => Math.ceil(x / roundTo) * roundTo;

const roundTo5Minutes = roundTo(1000 * 60 * 5);
const roundDownTo5Minutes = roundDownTo(1000 * 60 * 5);
const roundUpTo5Minutes = roundUpTo(1000 * 60 * 5);

const now = new Date();
const msRound = roundTo5Minutes(now)
const msDown = roundDownTo5Minutes(now)
const msUp = roundUpTo5Minutes(now)

console.log(now);
console.log(new Date(msRound));
console.log(new Date(msDown));
console.log(new Date(msUp));
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-16T12:25:14.177

我知道回答有点晚了，但也许它可以帮助某人。如果您按以下方式记录

```
new Date().getMinutes() 
```

你可以在最后 5 分钟

```
new Date().getMinutes() - (new Date().getMinutes()%5) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-22T09:49:40.960

可能效率较低，但这是另一种选择：

```
debug('Current timestamp:', timestamp);

timestamp.setMilliseconds(0);
timestamp.setSeconds(0);
timestamp.setMinutes(Math.round(timestamp.getMinutes() / 5) * 5);

debug('Rounded timestamp:', timestamp); 
```

> ```
> Current timestamp: 2019-10-22T09:47:17.989Z
> Rounded timestamp: 2019-10-22T09:45:00.000Z 
> ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-19T22:47:04.277

[Date-fns](https://date-fns.org/)现在有一个函数，可以对日期进行四舍五入。见[https://date-fns.org/v2.21.3/docs/roundToNearestMinutes](https://date-fns.org/v2.21.3/docs/roundToNearestMinutes)

```
const roundToNearestMinutes = require('date-fns/roundToNearestMinutes')
console.log(roundToNearestMinutes(new Date(), {nearestTo: 5}));
// e.g. 2021-05-19T22:45:00.000Z 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-06T17:06:24.663

使用此方法获取下一个使用纯JS的5分钟循环

```
function calculateNextCycle(interval) {
    const timeStampCurrentOrOldDate = Date.now();
    const timeStampStartOfDay = new Date().setHours(0, 0, 0, 0);
    const timeDiff = timeStampCurrentOrOldDate - timeStampStartOfDay;
    const mod = Math.ceil(timeDiff / interval);
    return new Date(timeStampStartOfDay + (mod * interval));
}

console.log(calculateNextCycle(5 * 60 * 1000)); // pass in milliseconds
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-08T22:05:42.193

一条线解决方案（向上或向下舍入）：

```
const fixedTime = (isRoundUp ? Math.ceil : Math.floor)(time / 60_000 / minutesRange)) * 60_000 * minutesRange;

// minutesRange: number -> 1, 5, 15, 30, etc // minutes
// isRoundUp: boolean
// time: number // millis 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-04T17:48:30.040

有一个[NPM 包](https://www.npmjs.com/package/@qc/date-round) `@qc/date-round`可以使用。鉴于您有一个`Date`要四舍五入的实例

```
import { round } from '@qc/date-round'

const dateIn = ...; // The date to be rounded
const interval = 5 * 60 * 1000; // 5 minutes
const dateOut = round(dateIn, interval) 
```

然后你可以使用[`date-fns`](https://github.com/date-fns/date-fns)格式化日期

```
import format from 'date-fns/format';

console.log(format(dateOut, 'HH:mm')) // 24-hr
console.log(format(dateOut, 'hh:mm a')) // 12-hr 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-13T07:48:48.067

最近发现了一种将日期四舍五入到时间范围的非常有效的方法

简而言之：

```
// minutes
var tf = 15; // 5,10,13,15, 60, - what ever you want
var dt = DateTime.UtcNow;
var minues = dt.TimeOfDay.TotalMinutes; // use TotalMinutes, TotalSecibds, TotalMillisecons  and etc
var roundedMinutes = (minues - (minues%tf));
var roundedDate = dt.Date.AddMinutes(a); 
```

我在 LINQPad 中进行了一些测试

```
// minutes
var tf = 15; // 5,10,13,15, 60, - what ever you want
var dt = DateTime.UtcNow;
var minues = dt.TimeOfDay.TotalMinutes;
dt.Dump();
minues.Dump();
(ms%tf).Dump();
var a = (minues - (minues%tf));
a.Dump();
dt.Date.AddMinutes(a).Dump(); 
```

输出：

```
13.07.2018 7:43:58 - current date
463,981443103333 - total mins
13,9814431033333 - rest
450 - rounded minutes value
13.07.2018 7:30:00 - rounded date 
```

# android - 如何更换电话.apk

> ID：10789385
> 
> 赞同：-2
> 
> 时间：2012-05-28T19:10:49.323
> 
> 标签：android

我正在尝试修改 Phone.apk。我可以使用 mm/mmm 构建它，但在手机上重新安装失败。我尝试先杀死进程 com.android.phone 但这也不起作用。（我认为电话是由某个实体自动重启的）。关于如何在正在运行的设备上替换 Phone.apk 的任何想法？
提前致谢。
-约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-16T14:27:47.647

进入飞行模式并更换 mod phone.apk 并重新启动并进入正常模式它将工作

在替换之前始终备份您的文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:14:36.780

使用亚行：

```
adb uninstall com.android.phone 
```

# c++ - 如何从 C++ 中的 .txt 文件打印特定的数组条目？

> ID：10789392
> 
> 赞同：0
> 
> 时间：2012-05-28T19:11:38.193
> 
> 标签：c++, arrays, text-files

首先，我对 C++ 编码非常陌生。所以，我有一个 .txt 文件，其中包含名称和数字——这是一个示例。

克里斯 5

塔拉 7

山姆 13

乔伊 15

我想使用这段代码来检索名称和数字，但是如何打印特定的数组条目而不仅仅是变量名称和数字（我希望它在屏幕上显示名称和数字）？

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std;

int main() {
string name;
int number;
struct sEntry
{
    std::string name;
    int number;
};
sEntry entries[256];
std::ifstream fin("input.txt"); // opens the text file
int nb_entries; // Keeps track of the number of entries read.

for (nb_entries = 0; fin.good() && nb_entries < 256;  nb_entries++) // Keep going until we hit the end of the file:
{
    fin >> entries[nb_entries].name;
    fin >> entries[nb_entries].number;
    cout << "Here, "<< name <<" is name.\n";
    cout << "Here, "<< number <<" is number.\n";
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:30:11.440

而不是使用 sEntry 的普通 C 数组，您应该使用 C++ 向量（它可以动态更改大小）。然后在循环中创建一个新的 sEntry 实例（然后可以使用 fin.eof() 作为终止条件）并使用 operator>>() 来分配值。之后，您使用 push_back() 将 sEntry 实例添加到您的向量中。您需要使用 sEntry.name、sEntry.number 字段在屏幕上进行输出，您的代码中显示的名称和编号将永远不会收到值。

```
#include <vector>
#include <string>
#include <iostream>

struct sEntry
{
    std::string name;
    int number;
};

int main() {
    string name;
    int number;
    std::vector<sEntry> entries;
    std::ifstream fin("input.txt"); // opens the text file
    // int nb_entries; // Keeps track of the number of entries read. -> not necessary, use entries.size()

    while(!fin.eof()) // Keep going until we hit the end of the file:
    {
        sEntry entry;
        fin >> entry.name;
        fin >> entry.number;
        cout << "Here, "<< entry.name <<" is name.\n";
        cout << "Here, "<< entry.number <<" is number.\n";
        entries.push_back(entry);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T09:04:28.120

你正在写出`name`and `number`，但那些不是你读过的变量。您已阅读数组条目。

让它尽可能简单地工作归结为将您的`cout`线路更改为：

```
cout << "Here, " << entries[nb_entries].name << " is name.\n";
cout << "Here, " << entries[nb_entries].number << " is number.\n"; 
```

不需要 std::vector，你的做法没有错。

# javascript - 使用“flickrnode”API 时出现“TypeError: undefined is not a function”错误

> ID：10789409
> 
> 赞同：1
> 
> 时间：2012-05-28T19:12:46.633
> 
> 标签：javascript, node.js, flickr

我是 Node.js 的新手，我正在尝试让 Flickr API 在我的本地机器上运行： [https](https://github.com/ciaranj/flickrnode) ://github.com/ciaranj/flickrnode 我已经使用 npm install flickr 安装了 flickr 模块。

最简单的调用是：

```
var FlickrAPI= require('flickr').FlickrAPI;
var sys= require('sys');
var flickr= new FlickrAPI(your_api_key_here);

// Search for photos with a tag of 'badgers'
flickr.photos.search({tags:'badgers'},  function(error, results) {
    sys.puts(sys.inspect(results));
}); 
```

我已将“sys”更改为“util”，因为节点提示我并添加了我的 api 密钥，所以我打电话：

```
var FlickrAPI= require('flickr').FlickrAPI;
var sys= require('util');
var flickr= new FlickrAPI('...');

// Search for photos with a tag of 'badgers'
flickr.photos.search({tags:'badgers'},  function(error, results) {
    sys.puts(sys.inspect(results));
}); 
```

运行 node myfile.js，我得到：

```
var flickr= new FlickrAPI('a513719086ba8c3a28d2c7726939b58e');
            ^
TypeError: undefined is not a function
    at Object.<anonymous> (/home/charm/ciaranj-flickrnode-8a9d85f/lib/simple.js:3:13)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31)
    at Function._load (module.js:311:12)
    at Array.0 (module.js:484:10)
    at EventEmitter._tickCallback (node.js:190:38) 
```

有谁知道我如何克服这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T00:37:42.560

`npm install flickr`安装[https://github.com/sujal/node-flickr](https://github.com/sujal/node-flickr)，而不是您正在寻找的那个。[如何在不使用 npm 的情况下安装 node.js 模块？](https://stackoverflow.com/questions/5786433)解释如何手动安装节点包

# image - 将鼠标悬停在图像 a

> ID：10789410
> 
> 赞同：0
> 
> 时间：2012-05-28T19:12:52.480
> 
> 标签：image, hover, joomla2.5

我正在 Joomla 中创建一个网站。

在我的首页上，我有一些图片，它们是链接。

我希望这些图像 a's 获得略带绿色的效果，例如不透明度 + 绿色，并且仍然具有下面的原始图像。

这可能只与css有关吗？

我可以使不透明度起作用，但不能使绿色起作用。

希望可以有人帮帮我。

[这是我的网站。它是“Referencer”和“Nyheder”下的小图像](http://martinehlers.dk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T18:43:51.483

这可以通过 CSS 实现。主要技巧是链接当前没有围绕 img 块，因为它们的显示类型是内联的。

假设以下 HTML：

```
<a href="#" class="greenish"><img src="..." /></a> 
```

这是您需要的 CSS：

```
a.greenish { 
    background: green;
    display: inline-block;
}
a.greenish img { 
    opacity: 0.5;
} 
```

显然，根据口味调整绿色和不透明度。

例如，请参阅这个[可爱的 jsfiddle](http://jsfiddle.net/UKXmy/3/)。请注意，这包括添加 CSS，以防您只希望它在悬停时变为绿色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T01:34:13.490

你将无法用纯 CSS 轻松地做你想做的事。CSS 中没有“覆盖”。您可以操纵背景颜色/不透明度，但图像将始终位于其之上，因此无法达到您想要的效果。

您需要做的是使图像成为 A 的背景，然后更改背景并使用已应用的效果制作类似的图像。这些图像很小，因此您可以轻松地将它们制作成同一张图像中的整体外观。我正是在公司网站顶部的社交图标上做到了这一点 - [http://www.bnrbranding.com/](http://www.bnrbranding.com/)

# c++ - 如何在 C++ 中创建一个按键的程序？

> ID：10789412
> 
> 赞同：2
> 
> 时间：2012-05-28T19:12:58.897
> 
> 标签：c++, winapi, macros, keyboard

我正在尝试用 C++ 创建一个宏程序。该程序应该每 10 秒按一次 H 键。我已经有了计时功能，但是如何让它按键呢？所以当程序运行时，如果我去记事本并把它留在那里，它会输入“hhhhhhhh(...)”

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T19:18:45.110

快速搜索发现这个问题之前已经回答过： [如何在 C++ 中模拟按键](https://stackoverflow.com/questions/5607849/how-to-simulate-a-key-press-in-c)

他们接受的答案是使用[SendInput()](http://msdn.microsoft.com/en-us/library/ms646310%28v=vs.85%29.aspx)

这完全取决于你的想法，但我个人发现，如果我想制作某种宏程序[AutoIt](http://www.autoitscript.com/site/autoit/)是最好的选择。

# arrays - 如何在调用 MATLAB 的 arrayfun 时捕获多个返回值？

> ID：10789417
> 
> 赞同：5
> 
> 时间：2012-05-28T19:13:27.700
> 
> 标签：arrays, matlab, return-value

我有一个函数，它将图像作为参数并产生一个标签和一个分数作为结果。我偶尔想快速测试一个（单元）图像数组，我知道的最方便的方法是使用`arrayfun`. 这可以很好地获取我的函数产生的标签，但我真的希望输出是一个`[label score]`单元格列表。

我可以围绕我的函数编写一个包装器，该包装器捕获两个值并将它们作为单元矩阵返回，然后在 内调用该包装器`arrayfun`，但似乎这是一个足够常见的习语，应该有一种方法可以处理多个返回值方便。有没有？（也许已经存在可以做到这一点的标准便利功能？有点像`deal`...的反面）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T19:23:19.127

您可以使用内置语法将输出作为两个矩阵：

```
 [A, B, ...] = arrayfun(fun, S, ...); 
```

例如：

```
function [y,z]=foo(x)
     y= x*x;
     z = x + 10;
end 
```

然后运行函数：

```
[A,B] = arrayfun( @foo, magic(5)) 
```

# php - 在 MySQL 查询中使用数组结果

> ID：10789421
> 
> 赞同：0
> 
> 时间：2012-05-28T19:13:43.570
> 
> 标签：php, mysql, arrays, implode

我有以下查询：

```
$query_q_pass = sprintf("SELECT * FROM answers INNER JOIN users WHERE a_id = %s and answers.user_id = users.user_id");
$q_pass = mysql_query($query_q_pass, $cd) or die(mysql_error());
$row_q_pass = mysql_fetch_assoc($q_pass); 
```

现在，上面查询的**答案**表有一行**brand_url**，其中有许多用逗号分隔的不同值，例如**dell、microsoft、hp、** ...

我想要做的是从**brand_url**行中选择所有这些值并将它们添加到另一个查询中，我将在其中提取存在于**brand_url**中的所有品牌。这是另一个查询：

```
$query_conn_brands = 'SELECT * FROM brands WHERE brand_url = 'VALUE FROM ABOVE QUERY'';
$conn_brands = mysql_query($query_conn_brands, $cd) or die(mysql_error());
$row_conn_brands = mysql_fetch_assoc($conn_brands);
$totalRows_conn_brands = mysql_num_rows($conn_brands); 
```

我尝试了许多使用数组的不同方法，但我得到的只是**品牌**表中的所有结果。这是我最后一次失败的尝试：

```
$brand_pass_ids = $row_q_pass['brand_id'];
$array = array($brand_pass_ids,);

$query_conn_brands = 'SELECT * FROM brands WHERE brand_url IN (' . implode(',', array_map('intval', $array)) . ')';
$conn_brands = mysql_query($query_conn_brands, $cd) or die(mysql_error());
$row_conn_brands = mysql_fetch_assoc($conn_brands);
$totalRows_conn_brands = mysql_num_rows($conn_brands); 
```

**从上面的示例中，我得到的只是品牌**表中的所有结果，而不仅仅是**答案**表中存在的结果。我真的希望有人能帮助我解决这个问题。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:33:17.400

使用 MySQL 的[`FIND_IN_SET()`](http://dev.mysql.com/doc/en/string-functions.html#function_find-in-set)功能：

> ***`N`***如果字符串在由 N 个子字符串组成***`str`***的字符串列表中，则返回 1 到范围内的值。***`strlist`***字符串列表是由“<code>”字符分隔的子字符串组成的字符串。如果第一个参数是常量字符串，第二个参数是 type 的列[`SET`](http://dev.mysql.com/doc/en/set.html)，则[`FIND_IN_SET()`](http://dev.mysql.com/doc/en/string-functions.html#function_find-in-set)函数被优化为使用位算术。`0`如果***`str`***不在***`strlist`***或是否***`strlist`***为空字符串，则返回。`NULL`如果任一参数为 则返回`NULL`。如果第一个参数包含逗号 (“<code>,”) 字符，则此函数无法正常工作。
> 
> ```
> mysql> SELECT FIND_IN_SET('b','a,b,c,d'); 
>         -> 2
> ```

在你的情况下：

```
SELECT * FROM brands WHERE FIND_IN_SET(brand_url, ?) 
```

但是，如果需要，您可以将您的查询连接在一起：

```
SELECT *
FROM   answers
  JOIN users  USING (user_id)
  JOIN brands ON FIND_IN_SET(brands.brand_url, answers.brand_url)
WHERE a_id = %s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:22:17.633

它失败的原因是因为您的查询将如下所示：

```
SELECT * FROM brands WHERE brand_url IN (dell,microsoft,hp) 
```

存在字符串值，因此必须将它们作为字符串处理。尝试：

```
implode(",",array_map(function($a) {return json_encode($a);},$array)) 
```

虽然编码为 JSON 可能看起来很疯狂，但在这里它实际上是一个不错的选择。字符串包含在引号中并根据需要进行转义，数字保持原样，并且`null`也得到了正确处理。

**编辑：**对于不支持匿名函数的旧版本 PHP：

```
implode(",",array_map(create_function('$a','return json_encode($a);'),$array)); 
```

# javascript - iPhone 上的 requestAnimationFrame

> ID：10789422
> 
> 赞同：2
> 
> 时间：2012-05-28T19:13:49.957
> 
> 标签：javascript, iphone, html, animation, canvas

是否可以在 iPhone（iOS 5.1）上调用 requestAnimationFrame？据我所知，移动 Safari 根本就没有这种方法，不管有没有供应商前缀。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:11:39.910

它看起来不像。这是我为自己编写的 jsfiddle 拍摄的一组屏幕截图的链接。

**截图链接** [http://crossbrowsertesting.com/users/34762/screenshots/z7e91b18ffb5e81e5079/public](http://crossbrowsertesting.com/users/34762/screenshots/z7e91b18ffb5e81e5079/public)

**jsfiddle 链接** [http://jsfiddle.net/fpmeh/](http://jsfiddle.net/fpmeh/)

在 5.1 IOS 屏幕截图上，您将看到 jsfiddle 中的文本设置为空。在较新的浏览器上，相同文本被设置为不同的可用方法之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-07T09:31:08.537

从 iOS 7 开始完全支持这一点。

[http://caniuse.com/#feat=requestanimationframe](http://caniuse.com/#feat=requestanimationframe)

# php - dompdf 一种删除最后一页页脚的方法？

> ID：10789425
> 
> 赞同：4
> 
> 时间：2012-05-28T19:14:02.577
> 
> 标签：php, dompdf

使用 DOMPDF 0.6.0 beta 3，我尝试构建一个 pdf，其中包含可变数量的文本页，最后一页充满了客户徽标。我想在除最后一页之外的所有页面的页脚中都有一个图像。

我现在使用它，它在所有页面上添加页脚，包括最后一个：

```
 $footer = $pdf->open_object();

  $w = $pdf->get_width();
  $h = $pdf->get_height();

  $y = $h - 2 * $text_height - 24;

  $img_w = 590; 
  $img_h = 170; 
  $pdf->image("footer-pdf.png", ($w - $img_w) / 2.0, $y - $img_h, $img_w, $img_h);

  $pdf->close_object();

  $pdf->add_object($footer, "all"); 
```

add_object() 可以接收（所有，加，奇，偶）参数，但我看不到可以控制最后一页的东西。

我尝试使用 $PAGE_NUM 和 $PAGE_COUNT 来检查它们是否相等，这意味着我在最后一页并在那里做一些事情。但是 $PAGE_NUM 和 $PAGE_COUNT 每次都返回 1。

关于如何删除最后一页页脚的任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T05:17:59.533

试试这个：

```
 <script type="text/php">
if ( isset($pdf) ) { 
    $pdf->page_script('
        if ($PAGE_COUNT > 1 && $PAGE_NUM!=$PAGE_COUNT ) {
            $font = Font_Metrics::get_font("helvetica", "normal");
            $size = 9;
            $pageText = "Page " . $PAGE_NUM . " of " . $PAGE_COUNT;
            $y = $pdf->get_height() - 24;
            $x = ($pdf->get_width() /2) - ( Font_Metrics::get_text_width($pageText, $font, $size) / 2);
            $pdf->text($x, $y, $pageText, $font, $size);
        } 
   ');
}   
 </script> 
```

# vim - Vim 的 Ctrl+P 自动完成带有破折号 '-' 的标识符

> ID：10789430
> 
> 赞同：12
> 
> 时间：2012-05-28T19:14:57.050
> 
> 标签：vim, autocomplete

在 Lispy 代码中，标识符可以用破折号代替下划线，如下所示：

```
(defn create-something ...)
(defn create-anything ...)
(defn create-nothing ...) 
```

如果 type `crea^P`，Vim 只显示 "create" 作为完成结果。如何使其将“-”解释为标识符的一部分并提供整个标识符以供完成？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-11-21T20:55:18.933

对于那些（像我一样）最终在这里更多地使用 CSS 而不是 lisp 的人，接受的（并且正确的！）答案可能不适合你。使用`set lisp`也会改变其他的东西（比如缩进）。

一种侵入性较小的方法是将连字符添加到您的`iskeyword`中，如下所示：

`:set iskeyword+=\-`

请参阅`help iskeyword`@romainl 建议。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-28T19:28:02.857

有一个适合您的选项：

```
:set lisp 
```

见`:help 'iskeyword'`和`:help 'lisp'`。

# javascript - 扩展 Ext.data.Model（动态添加字段）

> ID：10789433
> 
> 赞同：9
> 
> 时间：2012-05-28T19:15:04.657
> 
> 标签：javascript, model, extjs4

我通过使用原型添加字段来扩展现有模型。一切正常，可以从服务器端接收数据并可以在客户端使用。但是，当我现在更新我的数据并将其发送回服务器端时，代理的编写者无法识别“新”字段。

更具体地说：我有一个这样的模型：

```
 Ext.define('Osgaar', {
      extend: 'Ext.data.Model',
      fields: [
        { name: 'first', type: 'string' },
        { name: 'second', type: 'string' },
        { name' 'third', type: 'string' }
      ],

      proxy: {
        type: 'rest',
        url: 'public/svcmethod',
        reader: {
          type: 'json',
          root: 'data'
        },
        writer: {
          type: 'json',
          writeAllFields: false
        }
      }
    }); 
```

我正在像这样扩展模型：

```
 Osgaar.prototype.fields.add({ name: 'fourth', type: 'string' }); 
```

我试图设置`writeAllFields`为`false`转移*所有*属性，只有定义模型中的属性，而不是使用原型添加的属性（Fiddler 证实了这一点）。

现在有没有人可以在不定义新模型的情况下解决这个问题？

先感谢您。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-28T20:05:20.750

我认为这里最好的解决方案如下：

```
Osgaar.prototype.fields.add(new Ext.data.Field({ name: 'fifth', type: 'string'})); // create Ext.data.Field constructor, not just simple Object 
```

我快速浏览了[Writer](http://docs.sencha.com/ext-js/4-0/source/Writer.html#Ext-data-writer-Writer-method-write)的实现，下面是一个在写入数据时由**write()调用的方法：**

```
getRecordData: function(record) {
        var isPhantom = record.phantom === true,
            writeAll = this.writeAllFields || isPhantom,
            nameProperty = this.nameProperty,
            fields = record.fields,            // <- look here
            data = {},
            changes,
            name,
            field,
            key;

        if (writeAll) {
            fields.each(function(field){
                if (field.persist) {           // <- checks the persist property!
                    name = field[nameProperty] || field.name;
                    data[name] = record.get(field.name);
                }
            }); 
```

然后我检查了模型定义后添加到原型中的字段的**persist属性的值，结果发现它是***undefined*。这是因为您并没有真正创建一个*Ext.data.Field*实例来继承所有 Field 默认值和其他有用的东西，您只是将一个普通的 Object 添加到 fields 集合中。Osgaar.prototype.fields 只是一个*MixedCollection*，因为您直接使用它，所以没有地方可以隐式调用*Ext.data.Field构造函数。*

如果您的应用程序逻辑经常动态添加模型字段，请考虑为您的自定义模型实现**addField()**方法（在继承链中创建另一个基类）。

希望这有帮助，祝你好运！我已经使用 ExtJS 很长一段时间了，所以这对我来说就像一个测验:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T14:29:21.833

我为我的原始问题找到了另一种解决方案。

我没有将字段添加到模型的原型中，而是执行了以下操作：

```
Osgaar_Temp = Osgaar;
delete Osgaar;

Ext.define('Osgaar', {
    extend: 'Osgaar_Temp',
    fields: 
    [
        { name: 'typeCategories', type: 'string' }
    ]
}); 
```

这似乎是最好的解决方案。

# javascript - 形成在重复小数内查找模式的正则表达式

> ID：10789435
> 
> 赞同：3
> 
> 时间：2012-05-28T19:15:22.927
> 
> 标签：javascript, regex, unit-testing, qunit

如何形成一个正则表达式来匹配以重复小数重复的唯一数字？

目前我的正则表达式如下。

```
var re = /(?:[^\.]+\.\d*)(\d+)+(?:\1)$/; 
```

例子：

```
// Pass
deepEqual( func(1/111), [ "0.009009009009009009", "009" ] );

// Fails, since func(11/111) returns [ "0.099099099099099", "9" ]
deepEqual( func(11/111), [ "0.099099099099099", "099" ] ); 
```

现场演示：http: [//jsfiddle.net/9dGsw/](http://jsfiddle.net/9dGsw/)

这是我的代码。

```
// Goal: Find the pattern within repeating decimals.
// Problem from: Ratio.js <https://github.com/LarryBattle/Ratio.js>

var func = function( val ){
    var re = /(?:[^\.]+\.\d*)(\d+)+(?:\1)$/;
    var match = re.exec( val );
    if( !match ){
        val = (val||"").toString().replace( /\d$/, '' );
        match = re.exec( val );
    }
    return match;
};
test("find repeating decimals.", function() {
    deepEqual( func(1), null );
    deepEqual( func(1/10), null );
    deepEqual( func(1/111), [ "0.009009009009009009", "009" ] );

    // This test case fails...
    deepEqual( func(11/111), [ "0.099099099099099", "099" ], 
        "What's wrong with re in func()?" );

    deepEqual( func(100/111), [ "0.9009009009009009", "009"] );
    deepEqual( func(1/3), [ "0.3333333333333333", "3"]);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:38:01.317

行。通过接受 Joel 的建议，我在一定程度上解决了自己的问题。

问题是正则表达式部分`(\d+)+(?:\1)$`匹配最接近字符串末尾的模式，这使得它返回“9”，而不是字符串“0.099099099099099”的“099”。

我克服这个问题的方法是将匹配长度设置为 2 或更大，就像这样。

`(\d{2,})+(?:\1)$`,

并用 过滤结果`/^(\d+)(?:\1)$/`，以防模式卡在模式内。

这是通过我所有测试用例的代码。

现场演示：http: [//jsfiddle.net/9dGsw/1/](http://jsfiddle.net/9dGsw/1/)

```
var func = function( val ){
    val = (val || "").toString();
    var RE_PatternInRepeatDec = /(?:[^\.]+\.\d*)(\d{2,})+(?:\1)$/, 
        RE_RepeatingNums = /^(\d+)(?:\1)$/,
        match = RE_PatternInRepeatDec.exec( val );

    if( !match ){
        // Try again but take off last digit incase of precision error.
        val = val.replace( /\d$/, '' );
        match = RE_PatternInRepeatDec.exec( val );
    }
    if( match && 1 < match.length ){
        // Reset the match[1] if there is a pattern inside the matched pattern.
       match[1] = RE_RepeatingNums.test(match[1]) ? RE_RepeatingNums.exec(match[1])[1] : match[1];
    }
    return match;
}; 
```

感谢所有帮助过的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:36:57.287

采用：`var re = /^(?:\d*)\.(\d{1,3})(?:\1)+$/`

我已经用重复小数的 {min,max} 定义了最小/最大长度，因为否则 009009009 也会在第一个测试用例中匹配。也许它仍然不是最终的解决方案，但至少是一个提示。

# actionscript-3 - 如果加载了内容，Flash AS2 预加载器仍会运行

> ID：10789439
> 
> 赞同：0
> 
> 时间：2012-05-28T19:15:34.440
> 
> 标签：actionscript-3, flash, actionscript, actionscript-2

通常我的预加载器是 20 帧，看起来像这样：

框架 1 动作脚本：

```
var amountLoaded:Number = _root.getBytesLoaded()/_root.getBytesTotal();
preloader._width = amountLoaded * 200;
loadText.text = Math.round(amountLoaded * 100) + "%";

if(_root.getBytesLoaded() == _root.getBytesTotal())  {
     gotoAndPlay(21);
}

else {
     gotoAndPlay(1);
} 
```

在第 20 帧，我们显然有：

```
this.gotoAndPlay(1); 
```

这很好用，但它只是我想要播放我的 Flash 介绍的**主页。**因此，我在主页以外的每个页面上都使用 FlashVars 来告诉动画它应该跳到哪里。

为此，我将其放置在预加载器之后的第一帧上：

```
gotoAndPlay(AdFrame); 
```

在除主页之外的每个页面中，我都添加了这个 Flash 变量：

```
<param name="FlashVars" value="AdFrame=39" /> 
```

**我的问题：** 如果加载了动画，如何完全跳过预加载器？

**我失败的尝试：** 我尝试移动我的预加载器以从第 2 帧开始，并在第 1 帧更改：

```
var amountLoaded:Number = _root.getBytesLoaded()/_root.getBytesTotal();
preloader._width = amountLoaded * 200;
loadText.text = Math.round(amountLoaded * 100) + "%";

if(_root.getBytesLoaded() == _root.getBytesTotal())  {
     gotoAndPlay(AdFrame);
}

else {
     gotoAndPlay(2);
} 
```

但它仍然没有绕过预加载器。

如果内容已加载，关于如何完全跳过预加载器的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:18:16.867

如果我理解正确，您的条件不会评估为 true，因为在第一帧上，即使从浏览器缓存加载 SWF ， `getBytesLoaded`and方法返回的值也不相同。`getBytesTotal`

如果是这种情况，您可以尝试在检查负载状态之前等待。只需将代码移动到第 2 帧并将预加载器动画的开始移动到第 3 帧就足够了。（自从我不得不使用时间线以来已经很长时间了，但我似乎记得等待一帧通常是一个很好的经验法则）。

或者，您可以在执行检查之前在第一帧暂停一小段时间：

```
stop();

var interval = setInterval(function() {

    clearInterval(interval);

    var amountLoaded:Number = _root.getBytesLoaded()/_root.getBytesTotal();
    preloader._width = amountLoaded * 200;
    loadText.text = Math.round(amountLoaded * 100) + "%";

    if(_root.getBytesLoaded() == _root.getBytesTotal())  {
         gotoAndStop(3);
    }

    else {
         gotoAndStop(2);
    }
}, 500); 
```

您可以使用间隔持续时间（半秒可能过多）。请注意，每次播放头返回到第一帧时都会执行间隔，根据间隔的长度，这可能不是问题。如果这是一个问题，您可以考虑在第一次执行间隔时设置一个布尔标志，这样您就可以避免在后续循环中再次执行它。

# javascript - 在 Three.js 上使用灯光

> ID：10789441
> 
> 赞同：0
> 
> 时间：2012-05-28T19:15:43.240
> 
> 标签：javascript, 3d, three.js, light

我正在尝试使用灯光属性。我想更多地了解[DirectionalLight.js](https://github.com/mrdoob/three.js/blob/master/src/lights/DirectionalLight.js)和[SpotLight.js](https://github.com/mrdoob/three.js/blob/master/src/lights/SpotLight.js)源代码中的变量 meanig。

例如，castShadow 和 onlyShadow 有什么区别。

如何控制灯光不通过物体？例如，我有一所带墙壁的房子，我想控制每个房间的灯光。

* * *

我找到了PointLight。它运作良好。但是当我放 4 个以上的灯时，它们就不起作用了。有什么限制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:27:02.550

你检查过[文档](http://threejs.org/docs)吗？

*   [定向光](http://threejs.org/docs/#Reference/Lights/DirectionalLight)
*   [聚光灯](http://threejs.org/docs/#Reference/Lights/SpotLight)

# sql - SQL 检索不在聚合或分组依据中的列

> ID：10789442
> 
> 赞同：0
> 
> 时间：2012-05-28T19:15:50.657
> 
> 标签：sql, sql-server, greatest-n-per-group

好的，我代表一个表格中包含三列的矩阵。为简单起见：A、B 列和值。A 和 B 表示矩阵的 X 和 Y“坐标”。

有人可以帮我解决以下问题：

对于矩阵 (X) 中的每一列，我希望检索最小值和 Y 坐标字段，它表示 X 列中的最小值。

这是针对矩阵中的每一列/X。

我一直在苦苦挣扎，因为我不能在 group by 或聚合函数中包含 Y，所以它不会让我在与计算最小值相同的查询中返回它（X 是 GROUP BY'd）。

编辑如果有两行或更多行，则应返回最小 Y 值。

为了清楚起见，我的表格因此是：

是 | X | 价值

0 | 0 | 0.38

1 | 0 | 0.72

2 | 0 | 0.13

3 | 0 | 0.45

0 | 1 | 0.52

1 | 1 | 0.23

2 | 1 | 0.84

3 | 1 | 0.15

0 | 2 | 0.52

1 | 2 | 0.04

2 | 2 | 0.04

3 | 2 | 0.15

使用上述测试数据，它应该返回：

X | 是 | 价值

0 | 2 | 0.13

1 | 3 | 0.15

2 | 1 | 0.04

请注意 Y=2，第 1 行是最小的 Y，尽管第 2 行也有最小值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:27:01.893

```
SELECT x
     , y
     , value
FROM
  ( SELECT x
         , y
         , ROW_NUMBER() OVER (PARTITION BY x ORDER BY Value, y) AS rn 
         , Value
    FROM tableX
  ) AS tmp
WHERE rn = 1 ; 
```

您可以在以下位置对其进行测试：[SQL-Fiddle](http://sqlfiddle.com/#!3/7cd02/1)
（已更正以反映问题中更改的数据：[test-2](http://sqlfiddle.com/#!3/65bbe/2)）

索引对`(x, value, y)`性能很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:19:32.447

```
SELECT  y ,
        ( SELECT    MIN(x)
          FROM      user997112 i
          WHERE     i.Y = o.y
                    AND i.VALUE = o.VALUE
        ) AS x ,
        value
FROM    ( SELECT    y ,
                    MIN(VALUE) AS value
          FROM      dbo.user997112
          GROUP BY  y
        ) AS o 
```

这是我使用的架构

```
CREATE TABLE [dbo].[user997112](
    [x] [int] NULL,
    [y] [int] NULL,
    [VALUE] [decimal](5, 2) NULL
) 
GO
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (0, 0, CAST(0.38 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (1, 0, CAST(0.72 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (2, 0, CAST(0.13 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (3, 0, CAST(0.45 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (0, 1, CAST(0.52 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (1, 1, CAST(0.23 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (2, 1, CAST(0.84 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (3, 1, CAST(0.15 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (0, 2, CAST(0.52 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (1, 2, CAST(0.04 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (2, 2, CAST(0.04 AS Decimal(5, 2)))
INSERT [dbo].[user997112] ([x], [y], [VALUE]) VALUES (3, 2, CAST(0.15 AS Decimal(5, 2))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:26:00.283

这是一种方法，但它很笨拙：

```
SELECT X, MIN(Y), Value 
FROM your_table fullTable   
WHERE Value <= ALL (SELECT Value FROM your_table WHERE X = fullTable.X)  
GROUP BY X, Value 
```

如果您没有关于 Value 的索引，这可能会更高效。否则你可能会得到更好的性能

```
SELECT X, MIN(Y), Value   
FROM your_table fullTable   
WHERE Value = (SELECT MIN(Value) FROM your_table WHERE X = fullTable.X)  
GROUP BY X, Value 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T19:29:42.497

就像是

```
SELECT Test.X, Test.Y, MAX(Test.Value) AS Value FROM Test 
INNER JOIN (
SELECT DISTINCT X, MIN(Y) AS Y FROM Test
GROUP BY X) t 
ON Test.X = t.X AND Test.Y = t.Y 
GROUP BY Test.X, Test.Y 
```

基本上：先做一个子查询，得到X与最小Y的组合，然后加入到原表中，得到对应的值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T19:47:47.257

我希望我准时！

```
Select t1.A,
    min(t1.B),
    t1.value 
from `table` t1, 
 (SELECT MIN( value ) AS value, a
  FROM  `table` 
  GROUP BY (A)) `t2`
where t1.A = t2.A
group by (t1.a) 
```

首先给你 A 的最小值，然后按 B 分组

# java - java小程序在我的html页面上不起作用

> ID：10789447
> 
> 赞同：-2
> 
> 时间：2012-05-28T19:16:42.153
> 
> 标签：java, html, applet

我现在正在学习 java，我在某处读过我也可以在带有小程序的浏览器中运行我的 java 代码。如果我尝试使用它，它会显示错误，请单击此处了解详细信息。
问题是java程序确实在命令提示符下工作，但不在浏览器中。
这是我的 HTML 代码。（Planet.class 和 html 文件都在我的桌面上）

```
<applet code="Planet.class" width=500 height=500 /> 
```

这是我的 java 代码（此代码在命令提示符下工作得很好；不要试图了解它到底在做什么，它只会在 * 中生成一个菱形。）：

```
class HelloWorldApp {
  public static void main(String[] args) {
  int n=20;
  int i;
  int k;
  int j;
  for (i=1;i<=n;i++)
  {
    for (k=n-i;k>=0;k--)
    { System.out.printf(" ");}
        for (j=1;j<=2*i-1;j++)       
        {System.out.printf("*");}
        System.out.printf("\n");
  }

  for(i=n-1;i>=1;i--)
  {
    for (k=0;k<(n-i)+1;k++)
    { System.out.printf(" ");}
    for(j=2*i-1;j>=1;j--)      
         {System.out.printf("*");}
         System.out.printf("\n");
   } 
  }
} 
```

我相信这只是因为浏览器不支持 printf 但也许我在做其他完全错误的事情，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:21:42.737

1.  It is not an applet. For this class to be an applet it would have to inherrit either `Applet` or `JApplet`.
2.  Applets don't use main method (they have other lifecycle methods)
3.  You were right --- system out does not end in a webpage but in java console.

Please read [http://docs.oracle.com/javase/tutorial/deployment/applet/index.html](http://docs.oracle.com/javase/tutorial/deployment/applet/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:21:41.370

您的类必须扩展 JApplet。如果您使用 NetBeans，您将获得一些生成的代码，您可以从那里开始学习。

# iphone - 关于 ios 上的本地和推送通知的问题

> ID：10789449
> 
> 赞同：2
> 
> 时间：2012-05-28T19:16:45.987
> 
> 标签：iphone, ios, push-notification, apple-push-notifications, uilocalnotification

我无法找到有关推送/本地通知的一些问题的确切答案。

1.  禁用推送通知是否也会禁用本地通知？

2.  我可以检测用户是否为我的应用程序禁用了推送通知吗？如果是这样，我该怎么做？编辑：正如我提交问题一样，我发现：[在 iPhone 上确定用户是否启用了推送通知](https://stackoverflow.com/questions/1535403/determine-on-iphone-if-user-has-enabled-push-notifications)这是推荐的方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:17:06.313

1.  禁用推送通知不会禁用本地通知，它们是相互独立的。
2.  你可以检查那种方式，这确实有效。另一种选择是在 AppDelegate 类中设置一个持久标志。

    ```
    - (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken
    {
        [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"registeredForPush"];
    }

    - (void) application: (UIApplication *) application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error
    {
        [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"registeredForPush"];
    } 
    ```

# c# - 从 PC 到 PC 的最大窗口大小变化

> ID：10789452
> 
> 赞同：1
> 
> 时间：2012-05-28T19:16:58.993
> 
> 标签：c#

我创建了一个小型测试应用程序，它允许将文件从一个地方复制到另一个地方的功能非常有限。现在由于功能有限，我保持窗口大小固定（已最大化为错误且明确定义的高度和宽度为 250x200 像素）。只有 2 个文件浏览元素和一个复制按钮。

我的朋友在他们的 PC 上测试了它，问题是我的大多数朋友都运行得很好，但是其中 3 个注意到应用程序的高度不够，复制按钮被 80% 隐藏（只有 20%它是可见的）。其中一个分辨率为 1920x1080，另外两个分辨率为 1366x728。所有测试 PC 都是 Windows 7 计算机。

这如何以及为什么会发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:32:58.557

我能想到的一件事是他们的 DPI 设置与您的计算机不同。

> 控制面板\外观和个性化\显示

![](../Images/2feeaab599fed54b8c7e6a2a26de91c5.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:02:18.153

> 已最大化为 250x200 像素的错误和明确定义的高度和宽度

没关系，只要您*仅*在表单构造函数中设置此大小即可。并将 FormBorderStyle 设置为 Fixed ，这样就可以清楚地看到窗口不能调整大小。如果您稍后再执行此操作，例如在 Load 或 Resize 事件中，那么您会令拥有良好高分辨率显示的用户不满意。或者“视网膜”显示器，我们很快就会拥有它们。他们需要提高视频适配器的每英寸点数设置，这样他们仍然可以在没有放大镜的情况下阅读 8 点文本。

这会导致文本以更多像素呈现。这要求您的控件变得更大，它们的大小以像素为单位指定。如果您不让它们增长，那么您将拥有带有大文本的小控件，没有吸引力且不可读。反过来，更大的控件需要它们移动并且您的表单变得更大，以便它仍然适合控件。

这都是自动的，这要归功于表单的 AutoScaleMode 设置。它默认为您所需要的字体。但是，当您将表单强制恢复为其原始设计尺寸时，这将不起作用，它将剪切移动的控件。

除了修改视频 dpi 设置之外，检查您的表单是否仍然在这样的机器上正常工作的一种快速方法是 Load 事件处理程序中的这段测试代码：

```
 protected override void OnLoad(EventArgs e) {
        this.Font = new Font(this.Font.FontFamily, this.Font.Size * 125 / 96f);
        base.OnLoad(e);
    } 
```

# python - winpexpect 的行为不像 pexpect

> ID：10789455
> 
> 赞同：1
> 
> 时间：2012-05-28T19:17:25.067
> 
> 标签：python, windows, ssh, paramiko, pexpect

我已经有这个问题好几天了，我不知道出了什么问题。

我有一个使用在 OSX 上运行的 pexpect 的简单 python 脚本，它启动 ssh-keygen 并自动点击返回以生成密钥对，它工作正常。我想在 Windows 上做同样的事情。为了在 Windows 上获取 ssh 和 ssh-keygen，我安装了 OpenSSH for Windows，它允许 ssh 从 cmd 提示符运行，作为使用部分 CYGWIN 支持文件的普通 Windows 程序。我将相同的脚本移植到 Windows 并将 pexpect 更改为 winpexpect 并使用对应的 winspawn 启动子进程，但它在第一个提示时停止。

```
def generateKeys(self):
    print "GeneratingKeys..."
    gen = winpexpect.winspawn("ssh-keygen -t rsa")
    print gen.expect(":") #This is where it asks for a place to save the keys. retuns 0 if found
    print "before: " + gen.before
    print "after: " + gen.after
    print gen.sendline()
    #Next it should expect a prompt for a passphrase but it never reaches it
    print gen.expect(":")
    print "before: " + gen.before
    print "after: " + gen.after
    print gen.sendline() 
```

我得到的输出是这样的：

```
GeneratingKeys...
0
before: Enter file in which to save the key (/home/user/.ssh/id_rsa)
after: :
2
before: Enter file in which to save the key (/home/user/.ssh/id_rsa)
after: : 
```

在这里，它为所有收集数字灰尘的兔子提供了永恒的空间。

我也不明白为什么它在预期的冒号之后得到“：”。

是否有我可以使用的另一个模块可以让我更好地与 Windows 的 OpenSSH 进行通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:12:17.827

很久以前，我看了winpexpect。我也无法让它运行，它只是挂了。如果我没记错的话，与不受支持的部分和不完整的端口有关。

由于我需要它用于 ssh，因此我最终将其替换为[paramiko](http://www.lag.net/paramiko/)。它需要 pycrypto，这在 Windows 上设置起来很麻烦，除非您使用[预编译的安装程序](http://www.lfd.uci.edu/~gohlke/pythonlibs/)。有关密钥生成，请参阅[文档的这一部分](http://www.lag.net/paramiko/docs/paramiko.SSHClient-class.html)。它具有加载和保存密钥。还要注意缺少主机键功能。

为了快速启动和运行，这里有一个[概述](http://jessenoller.com/2009/02/05/ssh-programming-with-paramiko-completely-different/)。请注意，它并没有涵盖所有的函数调用，例如他为什么使用`AutoAddPolicy()`. 检查文档以了解优缺点和更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T08:53:11.547

这是一个 fork 项目[winpexpect](https://bitbucket.org/weyou/winpexpect)：此版本修复了许多错误。你可以试一试。

# php - 通过共享主机为 PHP 应用程序使用第 3 方 SMTP 主机？

> ID：10789459
> 
> 赞同：0
> 
> 时间：2012-05-28T19:17:57.810
> 
> 标签：php, smtp

我有一种情况，我试图通过共享托管帐户在 IIS 上托管基于 PHP/MySQL 的自定义应用程序。托管公司是 discountasp.net，在那个环境中，我似乎无权访问 php.ini 文件，我通常在该文件中设置出站 SMTP 的身份验证/凭据...

任何人都可以推荐一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:46:53.997

You should probably use [PHPMailer](http://sourceforge.net/projects/phpmailer/), which is a pretty good library to send emails with PHP and allows to send through any SMTP server.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:19:52.617

您是否尝试过使用 ini_set？

[http://php.net/manual/en/function.ini-set.php](http://php.net/manual/en/function.ini-set.php)

# jquery - 使用 jquery 使用 textarea 的内容实时更新 iframe

> ID：10789460
> 
> 赞同：2
> 
> 时间：2012-05-28T19:18:18.530
> 
> 标签：jquery, html, iframe

我正在尝试使用文本区域的内容加载 iframe，atm 我有这个

```
$(document).ready(function(){
$("#ce").html($("#som").val());
$("#som").keypress(function(){$("#ce").html($("#som").val());});
$("#som").keyup(function(){$("#ce").html($("#som").val());});
$("#som").keydown(function(){$("#ce").html($("#som").val());});
});

<div id="con">
    <textarea id="som"></textarea>
</div>
<div id="ce"></div> 
```

  正如您所看到的，我正在将信息加载到一个 div 中，由于某种原因我刚刚意识到它不起作用，因为如果用户输入 HTML，他们很容易能够更改页面。这就是我想要的，但我需要它来将它发送到 iframe。我用谷歌搜索了一段时间，但找不到我需要的东西。
  我希望它像我对基于 div 的那样保持简短和简单，如果可能的话，它类似于我设置它的方式。我不需要你为我把整个代码放在一起（虽然这会很好）你可以帮助我指出正确的方向，我会很高兴，在此先感谢。

# .net - 错误处理程序的 ASP.NET 共享变量

> ID：10789461
> 
> 赞同：0
> 
> 时间：2012-05-28T19:18:23.400
> 
> 标签：.net, vb.net

我打算使用共享变量来实现日志记录工具。看看下面的代码：

```
Imports System.IO

Public Class TestClass

    Public Shared objError As New StreamWriter("C:\Test.txt")

End Class

 Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Try
            TestClass.objError.WriteLine("Error 1")
            TestClass.objError.WriteLine("Error 2")
            TestClass.objError.WriteLine("Error 3")
            'TestClass.objError.Close()
            TestClass.objError.WriteLine("Error 4")
            TestClass.objError = Nothing
        Catch ex As Exception

        End Try
    End Sub 
```

我不明白这个共享变量是如何创建和销毁的（我假设它是在 form_load 之前创建并由 form_unload 销毁的）。我也不明白为什么可以将对静态变量的引用设置为 Nothing；在程序结束之前，变量肯定应该存在吗？（Q1，第 1 部分）我意识到这是一个简单的问题。

有没有更好的方法来实现日志记录机制？（第一季度第 2 部分）。日志记录机制写入错误和日志条目。

更新我想我在这里找到了答案：http: [//msdn.microsoft.com/en-us/library/z2cty7t8.aspx](http://msdn.microsoft.com/en-us/library/z2cty7t8.aspx)。“静态变量继续存在并保留其最新值。下次您的代码调用该过程时，该变量不会重新初始化，它仍然保留您分配给它的最新值。静态变量继续存在定义它的类或模块的生命周期。”

我不相信这是创建日志记录工具的最佳方式。因此，我的问题的第 2 部分仍然是开放的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:48:55.383

您在为变量保留的内存区域`Public Shared objError`和创建并分配给该区域的对象实例之间感到困惑`As New StreamWriter("C:\Test.txt").`

当您声明变量`objError`时，编译器会保留所需的内存，但不会用有效值（对象的实例）填充它。
是用 StreamWriter 的对象实例初始化此区域 的**New命令。**

当您为变量分配值**Nothing**时，您正在擦除 StreamWriter 的实例（实际上我更喜欢显式调用 Flush 和 Close），但您并没有删除为 Shared 变量保留的内存区域。

关于日志。您问“哪种方法最好”，那么最好的方法就是按照您的建议使用外部组件。创建一个更好的日志系统将非常困难，log4net 已经过尝试和测试，它是免费的，被认为是最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:20:13.567

作为对第 2 部分的回答，我建议您使用[log4net](http://logging.apache.org/log4net/)或任何其他日志框架。[您也可以通过ASP.NET Health Monitoring](http://msdn.microsoft.com/en-us/library/bb398933.aspx)捕获错误。然而，它不是一个普通的伐木设施吗？

# x86 - 如何使用 SSE 逻辑指令

> ID：10789469
> 
> 赞同：0
> 
> 时间：2012-05-28T19:19:19.000
> 
> 标签：x86, sse, simd

我需要一些关于如何在 Visual Studio 上使用 SSE 逻辑指令的帮助。基于[MSDN 网站](http://msdn.microsoft.com/en-us/library/73ck1xc5.aspx)，

```
__m128 _mm_and_ps(__m128 a , __m128 b );
ANDPS 
```

可用于对操作数*a*和*b*执行逻辑与。但我无法弄清楚获取结果所需的确切步骤（内存加载和初始化、设置、存储等）。

具体来说，我想知道如何：

1.  执行操作，
2.  取回结果，并且
3.  获得结果的大小（有效位数）。

有人可以在一个例子中告诉我如何做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T20:15:39.047

这是一个示例 - 使用 XOR 反转浮点向量中所有元素的符号：

```
__m128 v1 = _mm_set_ps(0.0f, 1.0f, -1.0f, -2.0f);
                                       //   v1 =  0.0f,  1.0f, -1.0f, -2.0f
__m128 sign = _mm_set1_ps(-0.0f);      // sign = -0.0f, -0.0f, -0.0f, -0.0f
__m128 v2 = _mm_xor_ps(v1, sign);      //   v2 = -0.0f, -1.0f,  1.0f,  2.0f 
```

因此，假设您想对数组中的所有值求反，您可以一次执行 4 个元素，如下所示：

```
const int N = 1024;
float a[N];
const __m128 sign = _mm_set1_ps(-0.0f);// sign = -0.0f, -0.0f, -0.0f, -0.0f
for (int i = 0; i < N; i += 4)
{
    v = _mm_loadu_ps(&a[i]);           // load 4 elements (unaligned) from a[]
    v = _mm_xor_ps(v1, sign);          // invert sign bit (i.e. negate)
    _mm_storeu_ps(&a[i], v);           // store 4 elements (unaligned) back to a[]
} 
```

# macos - 在 Qt for Mac 中链接到 libssl 0.9.8 而不是 0.9.7

> ID：10789470
> 
> 赞同：1
> 
> 时间：2012-05-28T19:19:19.423
> 
> 标签：macos, qt, qt-creator, libssl

我发现我在 Mac 下使用 Qt Creator 编译的应用程序（Qt 4.7.4 和 Qt 4.8.0）链接到`/usr/lib/libssl0.9.7`.

当我从基于 QtWebkit 的应用程序浏览 https 网站时，它给了我很多 SSL 错误。Qt 的 windows 版本基于 OpenSSL 0.9.8。我确实看到我的 Mac OS Lion 上也安装了 libssl 0.9.8。如何让 Qt Creator 链接到 libssl 0.9.8？

# windows-phone-7 - 锁定全景标题/图像

> ID：10789476
> 
> 赞同：1
> 
> 时间：2012-05-28T19:20:09.387
> 
> 标签：windows-phone-7, windows-phone-7.1

有没有办法锁定全景控件的标题，使其在页面切换时不会滑动？相反，它仍然在它的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T00:21:47.163

我可能会将全景图放在 2 行网格内。第一行可以包含文本、图像或您想要保持静态的任何内容。然后将全景控件放在第二行内。看一下这个：

```
<Grid x:Name="LayoutRoot">
    <Grid.RowDefinitions>
         <RowDefinition Height="60"/>
         <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Image x:Name="Logo" Grid.Row="0"/>
    <controls:Panorama Grid.Row="1" Margin="0,-60,0,0">
         <controls:Panorama.Title><Rectangle Height="60"/></controls:Panorama.Title>
    ...
    </controls:Panorama>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T06:35:44.717

如果我理解正确，您不需要全景图的视差标题图层。

如果是这样，试试这个：

```
public class NoParalaxTitleLayer : PanningTitleLayer
    {
        protected override double PanRate
        {
            get { return 0d; }
        }
    }

    public class NoParalaxBackgroundLayer : PanningBackgroundLayer
    {
        protected override double PanRate
        {
            get { return 1d; }
        }
    } 
```

风格：

```
<Style x:Key="NonParalaxPanorama" TargetType="controls:Panorama">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="controls:Panorama">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <local:NoParalaxBackgroundLayer x:Name="BackgroundLayer" 
                 HorizontalAlignment="Left" Grid.RowSpan="2">
                                <Border x:Name="background" 
                    Background="{TemplateBinding Background}" 
                    CacheMode="BitmapCache"/>
                            </local:NoParalaxBackgroundLayer>
                            <local:NoParalaxTitleLayer x:Name="TitleLayer" 
                 CacheMode="BitmapCache" 
                 ContentTemplate="{TemplateBinding TitleTemplate}" 
                 Content="{TemplateBinding Title}" 
                 FontSize="187" 
                 FontFamily="{StaticResource PhoneFontFamilyLight}" 
                 HorizontalAlignment="Left" 
                 Margin="10,-76,0,9" Grid.Row="0"/>
                            <controlsPrimitives:PanningLayer x:Name="ItemsLayer" 
                 HorizontalAlignment="Left" Grid.Row="1">
                                <ItemsPresenter x:Name="items"/>
                            </controlsPrimitives:PanningLayer>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

<controls:Panorama Style="{StaticResource NonParalaxPanorama}">
</controls:Panorama> 
```

# php - Zend GData 上传文件到特定文件夹

> ID：10789482
> 
> 赞同：3
> 
> 时间：2012-05-28T19:20:21.477
> 
> 标签：php, google-docs-api, zend-gdata

我正在尝试将文件上传到特定文件夹。我有文件夹 URI，所以我将它作为 Zend API 的 uploadFile 函数中的 URI 传递。

但是，我最终得到一个 401 错误。

此代码有效并将文件上传到 Google 文档的基础：

```
$newDocumentEntry = $docs->uploadFile($filePath, $documentTitle, null, Zend_Gdata_Docs::DOCUMENTS_LIST_FEED_URI); 
```

如何创建将其上传到特定文件夹的 URI？

* * *

我真的很努力解决这个问题。我已经尝试了所有我能想到的为特定文件夹创建有效 URI 的方法，但我总是收到以下错误消息：

```
Expected response code 200, got 400
Invalid request URI 
```

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:10:36.537

[php zend gdata 将文档/文件放入类别/文件夹 Google Docs](https://stackoverflow.com/questions/10299790/php-zend-gdata-put-a-document-file-into-a-category-folder-google-docs)

这是你想要的？

如果错误为401，请检查经过身份验证的google用户是否真的有对该文件夹的写入权限。

# .net - 将 Int32 字段数据绑定到可为空的 Decimal 属性时引发 CLR FormatException

> ID：10789496
> 
> 赞同：2
> 
> 时间：2012-05-28T19:21:43.453
> 
> 标签：.net, vb.net, winforms, data-binding, nullable

我编写了一个 .Net 4.0 Winforms Numeric Editor 控件（继承自 TextBox），并添加了一个可为空的十进制类型的 Value 属性，如下所示：

```
Public Class NumericEditor
    Inherits TextBox

    Private _value As Decimal? = Nothing

    <DefaultValue(GetType(Decimal?), "Nothing"), Bindable(True)>
    Public Property Value() As Decimal?
        Get
           Return _value
        End Get
        Set(ByVal newvalue As Decimal?)
            _value = newvalue
        End Set
    End Property

End Class 
```

我将 DataTable 字段绑定到控件的实例，如下所示：

```
Dim bindingNew As New Binding("Value", _bindingSource, strFieldName, True, DataSourceUpdateMode.OnValidation, Nothing)
NumericEditor1.DataBindings.Add(bindingNew) 
```

（我为绑定对象创建了一个变量来帮助调试，但是在第二行抛出了 CLR 异常。）

当将包含有效值的 Int32 类型的字段数据绑定到 Value 属性时，我收到了一个 FormatException 引发：

```
System.FormatException occurred
  Message=Input string was not in a correct format.
  Source=mscorlib
  StackTrace:
       at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
  InnerException: 
```

同样，当对包含 DBNull 的 Int32 类型的字段进行数据绑定时，我会收到一个一般异常：

```
System.Exception occurred
  Message=Nothing is not a valid value for Decimal.
  Source=System
  StackTrace:
       at System.ComponentModel.BaseNumberConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
  InnerException: System.FormatException
       Message=Input string was not in a correct format.
       Source=mscorlib
       StackTrace:
            at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
            at System.Number.ParseDecimal(String value, NumberStyles options, NumberFormatInfo numfmt)
            at System.ComponentModel.DecimalConverter.FromString(String value, NumberFormatInfo formatInfo)
            at System.ComponentModel.BaseNumberConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
       InnerException: 
```

在这一点上，我不知道如何解决这个异常，特别是当我将数字字段数据绑定到数字属性时，不应该发生字符串转换。有任何想法吗？

（为了使事情更加复杂，我对另一个控件使用了类似的技术，在该控件中我将 DateTime 字段数据绑定到可为空的 DateTime 属性，并且该控件工作得很好。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:58:39.063

```
<DefaultValue(GetType(Decimal?), "Nothing")> 
```

字符串“Nothing”是这里的问题。这是一个 VB.NET 特定的关键字，只有 VB.NET 编译器知道这意味着什么。.NET 框架绑定代码使用对“Nothing”一无所知的类型转换器。

只需将其删除，因为 Decimal 的默认值？已经是无。

# web-applications - 用于创建网站导览的 Web 应用程序

> ID：10789499
> 
> 赞同：2
> 
> 时间：2012-05-28T19:22:00.787
> 
> 标签：web-applications

我正在寻找一种方法来创建 Web 应用程序的导览，就像 youtube 不久前重新设计时所做的那样。

我很确定我看到了一个可以帮助您创建所有内容的网络应用程序，但似乎再也找不到了。我确实找到了 touration.com ( [http://www.killerstartups.com/web-app-tools/touration-com-guide-your-visitors-through-your-site/](http://www.killerstartups.com/web-app-tools/touration-com-guide-your-visitors-through-your-site/) ) 但它不再存在了。还发现了这个脚本[http://tympanus.net/codrops/2010/12/21/website-tour/comment-page-3/#comments](http://tympanus.net/codrops/2010/12/21/website-tour/comment-page-3/#comments)如果在一个网站上找不到这一切，我可能会使用它一切都为你准备好了。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T13:32:19.057

您可能想查看[Joyride jQuery 插件](http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin)或[Optimizely 的 Guided.js](http://blog.optimizely.com/introducing-guidersjs-an-open-source-guider-e)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T05:59:09.787

试试[www.tourmyapp.com](http://www.tourmyapp.com)虽然它不是免费的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-04T07:47:36.450

[Chardin.js](http://heelhook.github.com/chardin.js/ "Chardin.js")是一个有趣的概念，虽然它相当简单，但它没有多个步骤。它让我想起了 Gmail 的提示。

[Intro.js](http://usablica.github.com/intro.js/)是另一种流行的，它有多个步骤的可能性。

# javascript - 在单个页面上定义 jquery ui 小部件的多个实例

> ID：10789500
> 
> 赞同：0
> 
> 时间：2012-05-28T19:22:05.410
> 
> 标签：javascript, jquery

我正在开发一个网站，我使用自定义构建 jQuery 小部件将数据加载到多个 div 中。

**这是小部件的代码：**

```
(function ($, window, document, undefined) {

    $.widget ("my.contentloader", {

        options: {

            loading_message: true

        },

        _create: function () {

            var that = this;

            $.ajax ({

                type: "POST", 

                url: that.options.url, 

                data: {data: that.options.formdata, limit: that.options.limit, offset: that.options.offset},

                beforeSend: function (html) {

                    if (that.options.loading_message) {

                        $(that.options.target_area).html ("<div id='loading'>Loading</div>");

                    }

                },

                success: function (html) {

                    if (that.options.loading_message) {

                        $('#loading').remove ();

                    }

                    $(that.options.target_area).html (html);

                },

                error: function (html) {

                    $(that.options.error_area).html (html);

                }

            });

        },

        _setOption: function (key, value) {

            this.options[key] = value;

            $.Widget.prototype._setOption.apply (this, arguments);

    }

    });

})(jQuery, window, document); 
```

**我使用这样的小部件加载数据：**

```
$('#targetdiv').contentloader ({

 url: '<?php echo $action_url; ?>',

 target_area: '#popup_box',

 formdata: {'username' : username_email, 'password' : password}

}); 
```

我在同一页面上加载多个实例时遇到问题。有没有办法不像这样在特定的 div 上实例化小部件？

```
$('#targetdiv').contentloader 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:59:53.017

我认为您需要将每个实例分配给一个变量。这样，您可以控制每个实例，或编写一个迭代实例数组的函数。

```
var contentLoaders = [];
$('.target-div').each(function(i, data) {
    contentLoaders[i] = $.widget("my.contentloader", { ... });
}); 
```

因此，您应该能够独立地对每个加载器进行操作，例如：

```
for (var i in contentLoaders) {
    var contentLoader = contentLoaders[i];
    contentLoader.option( ... );
} 
```

此外，您将 DOM ID $('#loading') 用于小部件的多个实例。这是错误的。您需要为每个小部件使用单独的加载器，或者检查 ID 是否存在，如果不存在则仅插入新节点。删除它也是如此。

** 我已添加此示例块，希望对您有所帮助：**

```
//
// This is a way to do it if you want to explicitly define each contentloader.
// Below that, I'll write out a way to define the contentloaders in a loop.
//

var contentLoader1 = $('#targetdiv1').contentloader ({
 url: '<?php echo $action_url; ?>',
 target_area: '#popup_box',
 formdata: {'username' : username_email, 'password' : password}
});
contentLoader1.option('url', 'http://google.com');

var contentLoader2 = $('#targetdiv2').contentloader ({
 url: '<?php echo $action_url; ?>',
 target_area: '#popup_box',
 formdata: {'username' : username_email, 'password' : password}
});
contentLoader2.option('url', 'http:/apple.com');

// Push each widget instance into an array of widget objects
var contentLoaders = [];
contentLoaders.push(contentLoader1);
contentLoaders.push(contentLoader2);
for (var i in contentLoaders) {
    console.log(i, contentLoaders[i].option('url'));
}
// Should print:
// 0 http://google.com
// 1 http://apple.com

//
//
// How to set a bunch of widgets at once from an array of content loader data
//
//

var contentLoaderData = [
    {
        divid: '#targetDiv1',
        url: 'google.com',
        formdata: {
            username: 'joeshmo',
            password: 'joeshmo1'
        }
    },
    {
        divid: '#targetDiv2',
        url: 'apple.com',
        formdata: {
            username: 'plainjane',
            password: 'plainjane1'
        }
    }
];

// Array of widget instances
var contentLoaders = [];
$.each(contentLoaderData, function(index, value) {
    var contentLoader = $(this.divid).contentloader({
        url: this.url,
        target_area: '#popup_box',
        formdata: {'username' : this.formdata.username, 'password' : this.formdata.password}
    });
    // Push each contentLoader instance into the contentLoaders array
    contentLoaders.push(contentLoader);
});
for (var i in contentLoaders) {
    console.log(i, contentLoaders[i].option('url'));
}
// Should print:
// 0 http://google.com
// 1 http://apple.com 
```

# python - Python中的购物清单

> ID：10789501
> 
> 赞同：2
> 
> 时间：2012-05-28T19:22:12.213
> 
> 标签：python

我正在通过制作小程序来学习 Python（以及一般的编程）。下面是一个基本的购物程序，它将根据所选食物返回要购买的物品列表。

我想改进它并允许用户一次选择几种食物（例如用户输入将是“1、2、3”）并基于此返回一个成分列表。

我应该采取什么样的方法？我正在使用 Python 2.7，这是我现有的代码：

```
mm_soup = ['minced meat', 'potatoes', 'frozen vegetable']
sunday_soup = ['chicken with bones', 'noodles', 'soup vegetable']
gulas = ['pork meat', 'food cream', 'potatoes', 'onion', 'frozen peas']

print "What would you like to cook on weekend?"
print "Here are the options:"
print "1\. Minced Meat Soup"
print "2\. Sunday Soup"
print "3\. Gulas"

choose = raw_input("> ")

if choose == '1':
    print "Buy", ", ".join(mm_soup) + "." 

elif choose == '2':
    print "Buy", ", ".join(sunday_soup) + "."

elif choose == '3':
    print "Buy", ", ".join(gulas) + "."

else:
    print "Hmmm. No such food on the list." 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:53:13.680

您的代码存在一些常见问题，因此让我们从修复这些问题开始。

您有多个要呈现给用户的项目，并且您正在对这些值进行硬编码。这会为您带来很多努力，因为您必须经常重复自己。看看你的选择线，它们基本上都是一样的。您还可以通过在描述和代码中定义数字链接到的内容来重复自己。让我们尝试用数据结构来简化它。

在这里，我们列出所有选项 - 元组列表，定义给定食物的名称和项目集。我们在这里使用一套，因为我们不需要订购这些物品。

```
options = [
    ("Minced Meat Soup", {'minced meat', 'potatoes', 'frozen vegetable'}),
    ("Sunday Soup", {'chicken with bones', 'noodles', 'soup vegetable'}),
    ("Gulas", {'pork meat', 'food cream', 'potatoes', 'onion', 'frozen peas'}),
] 
```

这为我们提供了一个良好的数据结构。

然后我们可以提出我们的问题，而不是手动构建它，我们可以使用循环从我们的选项列表中构建它：

```
print "What would you like to cook on weekend?"
print "Here are the options:"
for option, (name, values) in enumerate(options, 1):
    print str(option)+". "+name 
```

请注意[内置函数](http://docs.python.org/library/functions.html#enumerate)[的`enumerate()`](http://docs.python.org/library/functions.html#enumerate)使用，以便为我们提供选项的数字。由于您想从 1 开始，而 Python 通常从 0 开始计数，因此我们也将其传入。

这为我们提供了输出，但我们现在可以轻松添加更多项目，而无需修改现有代码。我们像以前一样询问，然后我们可以简单地从列表中获取它们给我们的索引，而不是加载`if`/ s。`elif`我们首先必须将字符串更改为一个数字，然后取出一个（因为 Python 从 0 开始计数）。这给了我们：

```
_, values = options[int(choose)-1] 
```

（使用元组解包忽略第一个值，因为它是我们不需要的名称）。

现在唯一的问题是，例如，如果用户输入超出范围的数字或单词，将会发生什么。您可以在转换为 int 并使用它之前对其进行检查，但是简单地尝试它是 Pythonic，并在失败时捕获抛出的异常。例如：

```
try:
    _, values = options[int(choose)-1]
    print "Buy", ", ".join(values) + "."
except (IndexError, ValueError):
    print "Hmmm. No such food on the list." 
```

这使得整个程序变得更小，并且还要注意添加新项目是多么容易，您只需将它们添加到列表中即可。

那么我们如何处理多个项目呢？嗯，现在也很简单。我们可以获取用户的输入，用逗号分隔，然后删除值以删除任何空格，然后执行与之前相同的操作：

```
for choice in choose.split(","):
    choice = choice.strip()

    try:
        _, values = options[int(choice)-1]
        print "Buy", ", ".join(values) + "."
    except (IndexError, ValueError):
        print "Hmmm. No such food on the list." 
```

这很有效，可以打印出多条购买行，但这不是最佳选择，更好的主意是生成一个更大的购物清单，其中包含所有需要的物品。

我们可以通过在循环时构建一组所有项目，然后打印出该集合来构建它。

```
shopping_list = []
for choice in choose.split(","):
    choice = choice.strip()
    try:
        _, values = options[int(choice)-1]
        shopping_list.append(values)
    except (IndexError, ValueError):
        print "Hmmm. No such food on the list." 
```

然而，这有点低效和丑陋。Python 有一些内置功能来构建列表-[列表推导](https://www.youtube.com/watch?v=t85uBptTDYY)。我们可以这样操作：

```
try:
    shopping_list = [options[int(choice.strip())-1][3] for choice in choose.split(",")]
except (IndexError, ValueError):
    print "Hmmm. No such food on the list." 
```

现在我们需要打印出列表中的所有值。请记住，这是一个集合列表，因此`", ".join()`不会完全按照我们的意愿行事。我们在这里有两个选择。我们可以使用生成器表达式先连接集合，然后连接连接的字符串：

```
print "Buy " + ", ".join(", ".join(values) for values in shopping_list) + "." 
```

或者，我们可以[`itertools.chain.from_iterable()`](http://docs.python.org/library/itertools.html#itertools.chain.from_iterable)用来返回一个扁平化的迭代器：

```
print "Buy " + ", ".join(itertools.chain.from_iterable(shopping_list)) + "." 
```

这给了我们：

```
import itertools

options = [
    ("Minced Meat Soup", {'minced meat', 'potatoes', 'frozen vegetable'}),
    ("Sunday Soup", {'chicken with bones', 'noodles', 'soup vegetable'}),
    ("Gulas", {'pork meat', 'food cream', 'potatoes', 'onion', 'frozen peas'}),
]

print "What would you like to cook on weekend?"
print "Here are the options:"
for option, (name, values) in enumerate(options, 1):
    print str(option)+". "+name

choose = raw_input("> ")

try:
    shopping_list = [options[int(choice.strip())-1][1] for choice in choose.split(",")]
    print "Buy " + ", ".join(itertools.chain.from_iterable(shopping_list)) + "."
except (IndexError, ValueError):
    print "Hmmm. No such food on the list." 
```

这会产生类似的东西：

```
What would you like to cook on weekend?
Here are the options:
1\. Minced Meat Soup
2\. Sunday Soup
3\. Gulas
> 1, 2
Buy potatoes, frozen vegetable, minced meat, chicken with bones, noodles, soup vegetable. 
```

这很短，易于扩展，并且运行良好。您还可以处理一些其他问题（您想如何处理多个相同的项目？您可能需要对此进行研究[`collections.Counter`](http://docs.python.org/library/collections.html#collections.Counter)），但这是基本思想。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:28:29.143

我想您可以拆分输入的字符串并遍历其元素：

```
choose = raw_input("> ")
for choice in choose.split(', '): #split by comma and space
    if choice == '1':
        print "Buy", ", ".join(mm_soup) + "." 
    elif choice == '2':
        print "Buy", ", ".join(sunday_soup) + "."    
    elif choice == '3':
        print "Buy", ", ".join(gulas) + "."
    else:
        print "Hmmm. No such food on the list." 
```

或类似的东西：

```
choose = raw_input("> ");
selected = choose.split(', ') #split by comma and space

suggestion = '';
if '1' in selected :
    suggestion += ", ".join(mm_soup)
if '2' in selected :
    suggestion += ", ".join(sunday_soup)
if '3' in selected :
    suggestion += ", ".join(gulas)

if len(suggestion) > 0:
    print "Buy " + suggestion + "."
else:
    print "Hmmm. No such food on the list." 
```

# google-chrome - 如何阻止谷歌浏览器扩展中的特定 URL？

> ID：10789502
> 
> 赞同：1
> 
> 时间：2012-05-28T19:22:12.790
> 
> 标签：google-chrome, google-chrome-extension

我正在尝试开发一个 chrome 扩展程序，它可以阻止像 gmail.com 这样的特定 URL，当有人访问 gmail.com 时，他们会弹出输入密码以继续访问该网站，这可能会减少未经授权访问您的个人网站的方式。

如果您知道一些相关信息，请告诉我，我在 Google 上搜索了一些扩展程序，并且有两三个扩展程序可以阻止诸如保持专注之类的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T11:24:02.530

执行此操作的最简单方法是将内容脚本注入所有应“受保护”的页面（您可以使用 中的“content_scripts”/“matches”设置进行设置`manifest.json`）。当脚本被注入和触发时，它应该显示登录对话框并处理登录过程。您可以[将此代码](https://github.com/shreyansb/stay-focused/blob/master/manifest.json)用作扩展的起点。

顺便说一句，我认为您的扩展不能真正保护任何按照您描述的方式工作的东西。扩展可能很容易被停用/卸载。

# jquery - 如何使用 jQuery 突出显示选定的行？

> ID：10789503
> 
> 赞同：1
> 
> 时间：2012-05-28T19:22:14.990
> 
> 标签：jquery

我正在使用 jQuery 1.6.4，并且我有一个 html 表。我为表格分配了一个 id = "tbl"，然后使用点击事件来动态查找点击了哪一行。在该行中，我想突出显示它，以便用户可以看到单击了哪一行。

我在一本 jQuery 书中使用了一些代码，并对其进行了修改，以便与 (this) 一起使用。但是，它没有突出显示该行。

这是我的代码：

```
$('#tbl tr').click(function() { 
                //$('div.poem-stanza').addClass('highlight');
                $(this).addClass("highlight");
... 
```

在萤火虫中，我验证 (this) 引用了一个 tr 元素，但由于某种原因，代码不适用于突出显示。我需要做什么才能使用（this）动态工作？

根据评论，我仔细检查并没有 .highlight 在我的 css 文件中。我已经为其他命名元素添加了它，并且在我对 css 文件的引用中出现了拼写错误。感谢萤火虫，我能够看到加载的所有内容和丢失的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:27:52.263

tr 元素不能有背景颜色。为了突出显示一行，您必须突出显示该行中的每个 td。假设您为 tr 元素提供了 highlight 类，请将其添加到您的 css 文件中：

```
.highlight td { background-color:green; } 
```

您会发现该行显示为绿色。

或者，您可以执行以下操作：

```
$('#tbl tr').click(function() { 
      $(this).find('td').addClass("highlight");
}); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:26:45.897

如果这些行是在 DOM 之后动态添加的，那么您将需要跨表委托 click 函数。

```
$(document).live('click', '#tbl tr', function(){ 
  $(this).addClass('highlight"); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:30:44.420

你可以这样使用：

```
$("tr").one("click", "#tbl", function() {
      $(this).addClass("highlight");
}); 
```

**[现场演示](http://jsfiddle.net/SivaCharan/JsRTH/)**

# php - 无需编辑页面即可更新网站内容的最简单方法

> ID：10789504
> 
> 赞同：1
> 
> 时间：2012-05-28T19:22:16.687
> 
> 标签：php, html

我为一个朋友建立了一个[网站](http://www.bestofthebiro.com)，因为他技术不高，并且会相对经常地更新它。

我的问题是有没有一种方法可以使用 PHP 表单来更新网站，并将新的 div 写入页面？

因此，在标准英语中，它将如下所示：

*   输入标题
*   输入日期
*   进入海报
*   输入内容
*   提交

我可以在 PHP 中简单地做到这一点吗？我也愿意接受其他建议。

非常感谢！利亚姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:28:15.183

我强烈建议您“就地编辑”

*   [http://www.appelsiini.net/projects/jeditable](http://www.appelsiini.net/projects/jeditable)
*   [http://code.google.com/p/jquery-in-place-editor/](http://code.google.com/p/jquery-in-place-editor/)
*   [https://stackoverflow.com/questions/708801/whats-the-best-edit-in-place-plugin-for-jquery](https://stackoverflow.com/questions/708801/whats-the-best-edit-in-place-plugin-for-jquery)

用户只需指向并单击他想要更改的元素。简单明了...实现基本身份验证系统是您的责任，这样只有页面的所有者才可以编辑和保存数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:23:58.153

总而言之，它只是一个文件的编辑。您可以编写一个 php 脚本，从用户那里获取该输入并相应地重写 html 页面。

# wcf - netTcp 异步回调在互联网上执行得非常慢？

> ID：10789508
> 
> 赞同：0
> 
> 时间：2012-05-28T19:22:35.970
> 
> 标签：wcf, silverlight, iis, firewall, nettcpbinding

我有一个在 IIS 7 中托管的双工语音和视频聊天服务，带有`netTcpBinding`. 该服务的使用者是 Silverlight 客户端。客户端调用服务上的方法：`SendVoiceAsync(byte[] buffer)`每秒 10 次（每 100 毫秒），服务*应该* 每秒也给客户回电话 10 次（以响应每次呼叫）。我已经在 LAN 中严格测试了我的服务，它运行良好，对于向服务发送语音/视频缓冲区的每 100 个呼叫，该服务在该时间段内使用接收到的语音缓冲区调用其他客户端 100 次。但是，当我通过 Internet 使用该服务时，它会变得非常缓慢、严重滞后并且经常给我一个超时错误。我注意到，通过 HTTP 接收回调的速率约为每次调用服务器的 1/10，因此对于服务的每 100 次调用，服务器调用客户端 10 次，这个数字应该是100（因为它在局域网中）或非常接近它的东西。

那么是什么导致服务在 HTTP 上变得如此滞后呢？我遵循了配置`netTcpBinding`优化性能的一般准则，虽然它似乎在 LAN 中带来了好处，但在互联网上却很糟糕。感觉好像有什么东西阻止了客户端向服务发送回复，尽管我已经禁用了所有防火墙，并将托管服务的网站所在的端口`4502-4535`和端口转发到服务器计算机。`80`如果有帮助，我的服务已`ConcurrencyMode`设置为`Multiple`，并且已`InstanceContextMode`设置为`Single`。此外，我的服务操作都是一种方式，而不是请求回复。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:31:12.763

与 LAN 相比，互联网是一个更加嘈杂和困难的网络：​​数据包可能会丢失，通过不同的路由器/交换机重新路由，并且延迟通常非常糟糕。

这就是 TCP 存在的原因，它是一个有序、可靠的协议，因此每个数据包都会被接收方确认，如果没有成功则重新发送。
这样做的问题是它不会尝试快速，它会尝试按照发送的顺序获取所有发送的数据。

因此，您的设置在 LAN 中工作我并不感到惊讶，因为 LAN 往返时间 (RTT) 通常约为 5 ~ 80 毫秒，但在互联网上发生故障时，RTT 为 250 毫秒是正常的。

您可以尝试减少发送数据的频率，并切换到无序且不可靠但比 TCP 更快的 UDP。我认为 UDP 是互联网上语音/视频的标准，因为您可以通过稍微降低语音/视频质量来补偿丢失的数据包。

在线游戏也存在同样的问题，例如最初的雷神之锤无法在互联网上播放。

# header - 如何使用 PHP 邮件隐藏 X-PHP-Script 标头？

> ID：10789513
> 
> 赞同：4
> 
> 时间：2012-05-28T19:23:05.163
> 
> 标签：header, sendmail, php

我运行一个发送邮件的 PHP 脚本。在标题中有关于脚本路径的信息。有没有办法隐藏它？有没有办法隐藏或更改我发送邮件的域名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:31:03.700

尝试通过将其添加为标题将其覆盖为 null：

```
$headers = 'X-PHP-Script: ';
mail($to, $subject, $message, $headers); 
```

[或者，您可以按照本教程](http://www.the-art-of-web.com/php/x-php-script/)的说明编辑标题的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:45:42.540

请联系您的房东了解您在此处的选项。这是一个与安全相关的设置，并不总是意味着您可以禁用/更改它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T08:37:00.453

试试这个 - 它工作

```
// prevent user/script details being exposed in X-PHP-Script header 
$oldphpself = $_SERVER['PHP_SELF']; 
$oldremoteaddr = $_SERVER['REMOTE_ADDR'];
$_SERVER['PHP_SELF'] = "/"; 
$_SERVER['REMOTE_ADDR'] = $_SERVER['SERVER_ADDR']; 

// send the email 
mail($to, $subject, $message[, $additional_headers[, $additional_parameters]]) 

// restore obfuscated server variables 
$_SERVER['PHP_SELF'] = $oldphpself; 
$_SERVER['REMOTE_ADDR'] = $oldremoteaddr; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-10T13:52:48.650

托管公司知道他们为什么想要这些标头 - 以免自己远离垃圾邮件发送者。他们通常不想让你改变它。

# global-variables - 程序必须访问包中的全局变量

> ID：10789514
> 
> 赞同：0
> 
> 时间：2012-05-28T19:23:10.477
> 
> 标签：global-variables, go

我有一个包，其中包含与打开的文件 (*os.File) 相关的全局变量，以及关联的记录器。另一方面，我将构建几个将使用该包的命令，并且我不想在每次运行命令时打开文件将其设置为记录器。

所以，第一个运行的程序将设置全局变量，这是我的问题：

*   下一个使用该包的程序是否可以毫无问题地访问那些全局变量？它可以创建一个带有标志的命令，以在其他程序使用之前初始化这些值，并使用另一个标志来完成它（取消设置包中的全局变量）。

*   如果这是不可能的，那么避免这种 IO 绑定的最佳选择是什么？在 Unix 套接字中使用服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:38:16.917

假设“程序”实际上是指“过程”，答案是否定的。

如果你想在进程之间共享一个（也许是定制的）日志记录功能，那么我会考虑一个类似守护进程的（Go 还不支持编写真正的守护进程）进程/服务器和任何你认为方便的 IPC。

# php - 无法使用 Objective-C 和 JSON 从外部数据库返回信息

> ID：10789516
> 
> 赞同：0
> 
> 时间：2012-05-28T19:23:24.827
> 
> 标签：php, objective-c, json

我有一个小问题。我正在尝试使用 php 和 Json 从外部数据库中检索信息。如果我从 localhost 尝试，它可以工作，但如果我修改 URL 并放置外部 URL，它不会返回任何内容。简而言之，如果我在本地工作（xampp 和 phpmyadmin）工作，我会从数据库中返回人口，但如果我尝试从外部数据库中进行，则不起作用。代码有问题吗？如果我运行托管在外部服务器上的 php 脚本，它会返回数据。这是Objective-C代码的问题

```
//Método que devuelve las poblaciones

-(NSMutableArray * )obtenerPoblaciones
{
pobla = [[NSMutableArray alloc] init];  

URLpobalciones = @"http://deproba.netau.net/devolver_poblaciones.php";
NSURL *url = [NSURL URLWithString:URLpobalciones];
NSData *data = [NSData dataWithContentsOfURL:url];
NSError *error;
NSArray *items = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions     error:&error];

NSDictionary *item = [[NSDictionary alloc] init];
// This will print all the names of people in your JSON.
for (item in items)
{
    NSString *poblae =[NSString stringWithFormat:[item valueForKey:@"nombre"]];
    [pobla addObject:poblae];
}

return pobla; 
```

}

* * *

## 修改

再一次问好！我修改了代码。我想得到一些简单的东西，然后让它变得更复杂。我修改了php脚本和objective-c代码

## PHP 文件

```
<?php
header('Content-type: application/json');
$miArray = array(utf8_encode("París")=>"Francia", "Madrid"=>utf8_encode("España"));
echo(json_encode($miArray));
?> 
```

## 目标 C 代码

```
//NSURL *url = [NSURL URLWithString:@"http://search.twitter.com/search.json?q=g8production"];
NSURL *url = [NSURL URLWithString:@"http://prueba.vacau.com/php/prueba.php"];
NSData *jsonData = [NSData dataWithContentsOfURL:url];

if (jsonData != nil) {
    NSError *error = nil;
    id result = [NSJSONSerialization JSONObjectWithData:jsonData options:    (NSJSONReadingMutableContainers) error:&error];
    if (error == nil) {
        NSLog(@"Poblacion %@",result);
    }else
    {
        NSLog(@"jsonData  is empty");
    }
} 
```

如果我使用 URL (http://search.twitter.com/search.json?q=g8production)，它可以正常工作，但如果我使用我的 php 脚本则不起作用。使 if / else 语句打印：jsonData is empty 希望你能帮助我。再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T09:57:07.040

目前我不能写评论，所以它必须是一个答案。我同意。您的代码似乎没问题，问题一定与您的服务器脚本有关。

但关于我所看到的：

```
pobla = [[NSMutableArray alloc] init]; 
```

如我所见，这一定是 iVar。请改用访问器。不要直接使用 iVar 的名称。如果您的项目中没有启用 ARC，则可能是内存泄漏。在通过保留属性设置后使用自动释放。

然后我不明白你为什么使用这个：

```
NSDictionary *item = [[NSDictionary alloc] init];
// This will print all the names of people in your JSON.
for (item in items) {...} 
```

如果您正在考虑快速枚举，您可以编写：

```
for (NSDictionary *item in items) {...} 
```

您不需要显式分配您正在枚举的对象。它们已经存在于 items 数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T11:25:20.297

有用！我发现了错误，试图在 jsonlint.com 上验证 JSON 问题是免费托管。添加广告和 JSON 验证器会告诉您 JSON 格式不正确。我在真实主机上进行了测试，并且可以正常工作。控制台显示您从 PHP 获得的 JSON 值 谢谢大家！你很酷

# objective-c - 同一个 UILabel 中是否可以有多种颜色

> ID：10789518
> 
> 赞同：1
> 
> 时间：2012-05-28T19:23:32.630
> 
> 标签：objective-c, cocoa-touch, quartz-graphics

我想在同一个 UILabel 中使用不止一种字体颜色。我不知道这是否可能。我真的不这么认为，但也许你们中的一些人有一个聪明的解决方案？也许像`stringWithFormat`.`[NSString stringWithFormatAndColor: @"Text with color: %@ %@", text, color, text, color]`

这张图片说明了我想要完成的事情：

![在此处输入图像描述](../Images/987dc65bd2d1d10f092e5c387aa172bf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:29:11.953

您可以使用 NSAttributedSting 实现此目的。[TTTAtributedLabel](https://github.com/mattt/TTTAttributedLabel)或[OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)是一个易于使用且支持属性字符串的UILabel 替代品

根据我的经验，使用 NSMutableAttributedStrings 并逐步构建它会更容易。

```
NSMutableAttributedString *attrStr = [NSMutableAttributedString attributedStringWithString:@""];

NSMutableAttributedString *a = [NSMutableAttributedString attributedStringWithString:@"This is "];      
[a setTextColor:aColorObj];
NSMutableAttributedString *b = [NSMutableAttributedString attributedStringWithString:@"only one "];     
[b setTextColor:bColorObj];
NSMutableAttributedString *c = [NSMutableAttributedString attributedStringWithString:@"Label"];     
[c setTextColor:cColorObj];

[attrStr appendAttributedString:a];
[attrStr appendAttributedString:b];
[attrStr appendAttributedString:c];

OHAttributedLabel *attributedTextLabel = [[OHAttributedLabel] initWithFrame:frame]
[attributedTextLabel setAttributedText:attrStr]; 
```

# php - wordpress 导航菜单的 php 代码优化

> ID：10789522
> 
> 赞同：1
> 
> 时间：2012-05-28T19:24:03.660
> 
> 标签：php, wordpress, optimization

我制作了一个功能，可以在我的 Wordpress 主题中插入导航菜单。我想请你就如何让它变得更好甚至更小提出建议。这里是：

```
function cosmos_nav_menu($theme_location, $type) {

switch ( $type ) {

case 'basic-tabs' :
  $menu_class = 'nav nav-tabs';
  $wrap_before = '';
  $wrap_after = '';
  break;
case 'stacked-tabs' :
  $menu_class = 'nav nav-tabs nav-stacked';
  $wrap_before = '';
  $wrap_after = '';
  break;
case 'basic-pills' :
  $menu_class = 'nav nav-pills';
  $wrap_before = '';
  $wrap_after = '';
  break;
case 'stacked-pills' :
  $menu_class = 'nav nav-pills nav-stacked';
  $wrap_before = '';
  $wrap_after = '';
  break;
case 'list' :
  $menu_class = 'nav nav-list';
  $wrap_before = '';
  $wrap_after = '';
  break;
case 'navbar' :
  $menu_class = 'nav';
  $wrap_before  = "<div class=\"navbar\">\n<div class=\"navbar-inner\">\n<div class=\"container\">\n";
  $wrap_before .= "<a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\n";
  $wrap_before .= "<span class=\"icon-bar\"></span>\n<span class=\"icon-bar\"></span>\n<span class=\"icon-bar\"></span>\n</a>\n";
  $wrap_before .= "<div class=\"nav-collapse\">\n";
  $wrap_after = "\n</div>\n</div>\n</div>\n</div>";
  break;
case 'navbar-brand' :
  $menu_class = 'nav';
  $wrap_before  = "<div class=\"navbar\">\n<div class=\"navbar-inner\">\n<div class=\"container\">\n";
  $wrap_before .= "<a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\n";
  $wrap_before .= "<span class=\"icon-bar\"></span>\n<span class=\"icon-bar\"></span>\n<span class=\"icon-bar\"></span>\n</a>\n";
  $wrap_before .= "<a class=\"brand\" href=\"" . home_url('/') . "\">" . esc_html(get_bloginfo('name', 'display')) . "</a>\n";
  $wrap_before .= "<div class=\"nav-collapse\">\n";
  $wrap_after = "\n</div>\n</div>\n</div>\n</div>";
  break;
}

echo $wrap_before;

wp_nav_menu(array(
'theme_location' => $theme_location,
'container' => false,
'menu_class' => $menu_class,
'walker' => new Bootstrap_Walker()
));

echo $wrap_after;
} 
```

它基本上是 wordpress 的 wp_nav_menu() 函数的包装器。它在基于 $type 变量调用 wp_nav_menu() 函数之前和之后添加了一些 html 代码。前 5 种情况的前后代码均无。在最后两种情况下也有相当多的代码重复。我还想包括一个案例，其中提供给 $type 变量的字符串与任何案例都不匹配，并相应地回显一条消息。

我最初用很多“if”语句而不是“case”来编写这个函数，但它们中的任何一个对我来说都不好看。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:37:35.163

我会设置默认的 wrap_before 和 wrap_after，例如：

```
$wrap_before = '';
$wrap_after = '';

switch ($type)
{
    case 'basic-tabs' :
        $menu_class = 'nav nav-tabs';
        break;
    case 'basic-tabs' :
        $menu_class = 'nav nav-tabs nav-stacked';
        break;
} 
```

# ios - iOS 设备的跟踪 API

> ID：10789523
> 
> 赞同：2
> 
> 时间：2012-05-28T19:24:05.517
> 
> 标签：ios, flurry, testflight

我可以跟踪人们在 iOS 设备上使用我的应用程序或游戏的频率吗，据我所知，Apple 没有为此提供任何功能。

如果存在的话，也许我可以使用第三方 API。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:29:43.033

编辑：对，苹果只会告诉你下载。

Flurry 分析非常好。[http://flurry.com](http://flurry.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:32:50.080

我可以推荐我知道的两个选项：[Flurry](http://www.flurry.com/)和[TestFlight SDK——更具体地说是 Checkpoint API](https://testflightapp.com/sdk/download/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-28T19:53:49.623

我肯定会使用[Flurry](http://www.flurry.com/)。对我来说总是像魅力一样工作。

# php - 尝试用 PHP 制作简单的 WakeOnLan 脚本

> ID：10789525
> 
> 赞同：0
> 
> 时间：2012-05-28T19:24:31.303
> 
> 标签：php, wake-on-lan

试图制作一个可以打开服务器的小脚本。我在网上找到了几个例子，但想保持这个基本/简单也能更好地掌握它们是如何组合在一起的。但这不起作用，我意识到我必须在某处指定子网 255 255 255 0 ...

有任何想法吗？

```
<?php

//check if server is up and running
$alive = fsockopen("XXX.168.1.1", 80, $errno, $errstr, 2);

    if (!$alive) {
        echo "<h1>Server is Down!</h1>";
        echo "I will try to turn it on now...";

        //Creating magic packet
        $mac_address = str_repeat("XXX5XXXX5XXX", 16);
        $msg = "FFFFFFFFFFFF " . "$mac_address" . "000000000000";
        $host_addr = "XXX.168.1.1";
        $host_port = "X";

        //Connect send and close connection
        $socket = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);
        $socket_data = socket_send($socket, $msg, strlen($msg), 0, $host_addr, $host_port);

        socket_close($socket);
        //testing
        //echo 
    } else {
        echo "<h1>Server is Up!</h1>";
        fclose($alive);
    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:37:57.610

检查这个：[http ://www.php.net/manual/en/function.socket-sendto.php#57746](http://www.php.net/manual/en/function.socket-sendto.php#57746)

这：[http ://www.php.net/manual/en/function.socket-send.php#58574](http://www.php.net/manual/en/function.socket-send.php#58574)

甚至可能是这样： http: [//www.codeproject.com/Articles/11469/Wake-On-LAN-WOL](http://www.codeproject.com/Articles/11469/Wake-On-LAN-WOL)

你会发现你需要将ip地址参数设置为'255.255.255.255'才能进行广播:)

# jsf - @PostConstruct 在 @FacesValidator 中不起作用

> ID：10789526
> 
> 赞同：3
> 
> 时间：2012-05-28T19:24:36.930
> 
> 标签：jsf, validation, postconstruct

验证器不支持 post 构造注释吗？

我有一个应用程序范围的 jndi servicelocator bean，我将它作为托管属性注入到我的验证器中。

```
@ManagedProperty(value = "#{jndiServiceLocatorBean}")
private final JndiServiceLocatorBean jndiServiceLocatorBean = null; 
```

用于初始化我必要的远程 bean 的 post 构造注释方法永远不会被调用，因此我的远程 bean 保持为空。

```
private UserBeanRemote userBeanRemote = null;

@PostConstruct
public void postConstruct()
{
    this.userBeanRemote = (UserBeanRemote) this.jndiServiceLocatorBean.getRemoteBean(UserBeanRemote.class);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:34:52.677

它仅在`Validator`被注释为 a`@ManagedBean`或`@Named`而不是时才有效`@FacesValidator`。

只需使用普通的构造函数。

```
@FacesValidator("fooValidator")
public class FooValidator implements Validator {

    private UserBeanRemote userBeanRemote;

    public FooValidator() {
        FacesContext context = FacesContext.getCurrentInstance();
        JndiServiceLocatorBean jndiServiceLocatorBean = context.getApplication().evaluateExpressionGet(context, "#{jndiServiceLocatorBean}", JndiServiceLocatorBean.class);
        this.userBeanRemote = (UserBeanRemote) jndiServiceLocatorBean.getRemoteBean(UserBeanRemote.class);
    }

    // ...
} 
```

支持 JSF 工件中的依赖注入，而不是`@ManagedBean`为[JSF 2.2](http://jdevelopment.nl/jsf-22/)计划的（[规范问题 763](http://java.net/jira/browse/JAVASERVERFACES_SPEC_PUBLIC-763)）。

### 也可以看看：

*   [如何使用@EJB、@PersistenceContext、@Inject、@Autowired 注入@FacesValidator](https://stackoverflow.com/questions/7572335/dependency-injection-in-facesvalidator-jsf-validation/7572413#7572413)
*   [JSF 2.0 中的通信 - 获取 EJB`@FacesValidator`和`@FacesConverter`](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#GettingAnEJBInFacesConverterAndFacesValidator)

# c++ - 将函数指针的“部分”作为参数传递

> ID：10789533
> 
> 赞同：1
> 
> 时间：2012-05-28T19:25:39.053
> 
> 标签：c++, function, pointers, lambda, function-pointers

我确定以前有人问过这个问题，但是很难搜索...所以，我得到的是一个接受函数指针的函数。这个函数指针有 3 个参数。所以，我想传递给另一个函数，相同的指针，但填充了 2 个参数。

所以，像这样：

```
int func1 (int (*funcptr)(int, int, int)) {
  return func2(funcptr(,8,9));
}

int func2 (int (*funcptr)(int)) {
  return (*funcptr)(2);
} 
```

编辑：好的，所以我现在使用 lambda

```
int func2(int (*funcptr2)(int)) {
  return (*funcptr2)(2);
}
int func1(int (*funcptr1)(int, int, int)) {
  return func2(
    [funcptr1](int i)->int {
      return (*funcptr1)(i,8,9);
    }
  );
} 
```

但它给了我

“无法将参数 1转换`func1(int (*)(int, int, int))::<lambda(int)>`为”`int (*)(int)``int func2(int (*)(int))`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:27:57.370

这称为 lambda，您可以使用[较新的 C++ 版本](http://en.wikipedia.org/wiki/C%2B%2B11#Lambda_functions_and_expressions)、std::bind、boost::bind 或[boost::function 来](http://www.boost.org/doc/libs/1_49_0/doc/html/function.html)实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:27:24.757

在 C 中，你不能。您必须传递函数指针和两个参数。

在 C++ 中，您可以使用`std::bind`（或`boost::bind`在旧版本中）来实现这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T18:37:26.537

要回答您更新的问题，捕获变量的 lambda（就像您的 lambda 对 lambda 所做的那样`funcptr1`）不能转换为函数指针。直观地说，这是有道理的，因为您的 lambda 必须为每个 lambda 存储这个捕获的变量；而没有办法用函数指针来做到这一点。

最好的解决方案可能是采用 type 的参数`std::function`，它是任何可调用类型的包装器：

```
int func2(std::function<int(int)> funcptr2) {
  return funcptr2(2);
}
int func1(std::function<int(int,int,int)> funcptr1) {
  return func2(
    [funcptr1](int i)->int {
      return funcptr1(i,8,9);
    }
  );
} 
```

您还可以使用模板使您的函数适用于任何可调用类型：

```
template <typename F>
int func2(F funcptr2) {
  return funcptr2(2);
}
template <typename F>
int func1(F funcptr1) {
  return func2(
    [funcptr1](int i)->int {
      return funcptr1(i,8,9);
    }
  );
} 
```

# excel - 在 Excel 中使用 VBA 将项目添加到字典中的特定位置

> ID：10789534
> 
> 赞同：2
> 
> 时间：2012-05-28T19:25:39.777
> 
> 标签：excel, vba, dictionary

我需要在字典中的特定键和项目对之后添加一个项目。与 add 成员在集合中允许的行为基本相同：（`Collection.Add (item [,key] [,before] [,after])`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T19:55:53.097

没有允许这样做的 Dictionary 对象的内置方法。这是一个快速滚动自己的方法。这将具体完成您的要求，但修改起来应该很简单：

```
Function DictAdd(StartingDict As Dictionary, Key, Item, AfterKey) As Dictionary
Dim DictKey As Variant

    Set DictAdd = New Dictionary
    For Each DictKey In StartingDict
        DictAdd.Add DictKey, StartingDict(DictKey)
        If DictKey = AfterKey Then DictAdd.Add Key, Item
    Next DictKey
End Function 
```

并测试它运行以下过程：

```
Sub TestDictAdd()
Dim MyDict As New Dictionary, DictKey As Variant

    MyDict.Add "A", "Alpha"
    MyDict.Add "C", "Charlie"

    Set MyDict = DictAdd(MyDict, "B", "Bravo", "A")
    For Each DictKey In MyDict
        Debug.Print DictKey, MyDict(DictKey)
    Next DictKey
End Sub 
```

这只是为了让你开始。如果我自己这样做，我可能会创建自己的**自定义类**来使用并创建**自定义 Add 方法**而不是使用函数。我还将进行以下改进：

*   添加错误处理
*   使 AfterKey 成为可选参数
*   添加 BeforeKey 作为可选参数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:57:20.943

像这样？

```
Option Explicit

Sub Sample()
    Dim Dict As Dictionary
    Dim itm As Variant

    Set Dict = New Dictionary

    Dict.Add "MyKey1", "Hello"
    Dict.Add "MyKey2", "This"
    Dict.Add "MyKey3", "is"
    Dict.Add "MyKey4", "Example"

    '~~> USAGE: Dictionaty Object, Key, Text, Position        
    Additem Dict, "MyKey5", "An", 3

    For Each itm In Dict
        Debug.Print itm & " - " & Dict(itm)
    Next
End Sub

Function Additem(ByRef D As Dictionary, ky As Variant, itm As Variant, pos As Long)
    Dim kyAr() As Variant, itmAr() As Variant
    Dim temp1() As Variant, temp2() As Variant
    Dim i As Long

    kyAr = D.Keys: itmAr = D.Items

    ReDim temp1(UBound(kyAr) + 1)
    ReDim temp2(UBound(itmAr) + 1)

    For i = 0 To pos - 1
        temp1(i) = kyAr(i): temp2(i) = itmAr(i)
    Next

    temp1(pos) = ky: temp2(pos) = itm

    For i = pos + 1 To UBound(temp1)
        temp1(i) = kyAr(i - 1): temp2(i) = itmAr(i - 1)
    Next

    ReDim kyAr(0): ReDim itmAr(0)

    kyAr() = temp1(): itmAr() = temp2()

    D.RemoveAll

    For i = LBound(kyAr) To UBound(kyAr)
        D.Add kyAr(i), itmAr(i)
    Next i
End Function 
```

**输出**

*前*

```
MyKey1 - Hello
MyKey2 - This
MyKey3 - is
MyKey4 - Example 
```

*后*

```
MyKey1 - Hello
MyKey2 - This
MyKey3 - is
MyKey5 - An
MyKey4 - Example 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-26T16:16:10.930

我没有在字典包含所有项目时对它进行排序，而是实现了一个名为 DctAdd 的小程序，它在添加项目时立即对键进行排序。假设键是vAdd，项目是vItem，类型variant 和要排序的字典都是dct。所以而不是：

```
dct.Add vAdd, vItem 
```

我用：

```
DctAdd dct, vItem, vAdd, dam_sortasc 
```

对于性能，我只包括了一些基本测试，因为在我的项目中使用它时我发现它已经足够了。

要使用 DctAdd，必须将以下内容复制到相关模块的声明部分：

```
' Just for the performance time measurement -----------------------------
Private Declare Function GetTime Lib "winmm.dll" Alias "timeGetTime" () As Long
' For the execution mode of DctAdd --------------------------------------
' (may be extended to also cover insert before and after)
Public Enum enAddInsertMode
    dam_sortasc = 1
    dam_sortdesc = 2
End Enum 
```

以下代码可以复制到任何标准或类模块： 请注意，插入之前/之后尚未实现，但添加时间不会太长。

```
Public Sub DctAdd(ByRef dct As Scripting.Dictionary, _
                  ByVal vItem As Variant, _
                  ByVal vAdd As Variant, _
                  ByVal lMode As enAddInsertMode)
' ----------------------------------------------------------------------
' Add to the Dictionary dct the item vItem with vAdd as the key,
' sorted in ascending or descending order.
'
' If the vAdd key already exists, adding it will be skipped without
' an error. A not existing dictionary is established with the first add
'
' W. Rauschenberger, warbe@cogip.de, Berlin, Feb 2015
' ----------------------------------------------------------------------
Dim i           As Long
Dim dctTemp     As Scripting.Dictionary
Dim vTempKey    As Variant
Dim bAdd        As Boolean

    If dct Is Nothing Then Set dct = New Dictionary

    With dct
        If .count = 0 Then
            .Add vAdd, vItem
            Exit Sub
        Else
            ' -----------------------------------------------------------
            ' The can maybee added directly after the last key
            ' -----------------------------------------------------------
            vTempKey = .Keys()(.count - 1)      ' Get the very last key
            Select Case lMode
                Case dam_sortasc
                    If vAdd > vTempKey Then
                        .Add vAdd, vItem
                        Exit Sub                ' Done!
                    End If
                Case dam_sortdesc
                    If vAdd < vTempKey Then
                        .Add vAdd, vItem
                        Exit Sub                ' Done!
                    End If
            End Select
        End If
    End With

    ' -----------------------------------------------------------------
    ' Since the new key could not simply be added to the dct it must be
    ' added/inserted somewhere in between or before the very first key
    ' ------------------------------------------------------------------
    Set dctTemp = New Dictionary
    bAdd = True
    For Each vTempKey In dct
        With dctTemp
            If bAdd Then ' When the new item has yet not been added
                Select Case lMode
                    Case dam_sortasc
                        If vTempKey > vAdd Then
                            If Not dct.Exists(vAdd) Then
                               .Add vAdd, vItem
                            End If
                            bAdd = False ' Add done
                        End If
                    Case dam_sortdesc
                        If vTempKey < vAdd Then
                            If Not dct.Exists(vAdd) Then
                                .Add vAdd, vItem
                            End If
                            bAdd = False ' Add done
                        End If
                End Select
            End If
            .Add vTempKey, dct.Item(vTempKey)
        End With
    Next vTempKey
                               ' ------------------------------------
    Set dct = dctTemp          ' Return the temporary dictionary with
    Set dctTemp = Nothing      ' the added new item
    Exit Sub                   ' ------------------------------------

on_error:
   Debug.Print "Error in 'DctAdd'!"
End Sub 
```

这是我用来测试的：

```
Public Sub Testdct1Add()
Dim dct1    As Scripting.Dictionary
Dim dct2    As Scripting.Dictionary
Dim i       As Long
Dim lStart  As Long
Dim lAdd    As Long
Dim vKey    As Variant

    ' -----------------------------------------------------------------------
    Debug.Print vbLf & "DctAdd: Test ascending order"
    ' Add sorted ascending with the key provided in the reverse order
    Set dct1 = Nothing
    For i = 10 To 1 Step -1
        DctAdd dct1, i, i, dam_sortasc
    Next i
    ' Show the result and wait ----------------
    For Each vKey In dct1
        Debug.Print vKey & " " & dct1.Item(vKey)
    Next vKey
    Stop

    ' ------------------------------------------------------------------
    Debug.Print vbLf & "DctAdd: Test descending order"
    ' Add sorted ascending with the key provided in the reverse order
    Set dct1 = Nothing
    For i = 1 To 10
        DctAdd dct1, i, i, dam_sortdesc
    Next i
    ' Show the result and wait ----------------
    For Each vKey In dct1
        Debug.Print vKey & " " & dct1.Item(vKey)
    Next vKey
    Stop

    ' ------------------------------------------------------------------
    lAdd = 500
    Debug.Print vbLf & "DctAdd: Test a best case scenario by adding " & _
                vbLf & lAdd & " items in the desired sort order"
    Set dct1 = Nothing
    lStart = GetTime
    For i = 1 To lAdd
        DctAdd dct1, i, i, dam_sortasc
    Next i
    Debug.Print "Adding " & dct1.count & " items in the target " & _
         vbLf & "sort order = " & GetTime - lStart & " ms"
    Stop

    ' ------------------------------------------------------------------
    lAdd = 500
    Debug.Print vbLf & "DctAdd: Worst case scenarion test by adding " & _
                vbLf & lAdd & " items in the reverse sort order"
    Set dct1 = Nothing
    lStart = GetTime
    For i = lAdd To 1 Step -1
        DctAdd dct1, i, i, dam_sortasc
    Next i
    Debug.Print "Adding " & dct1.count & " items, 4 out of " & vbLf & _ 
                "order = " & GetTime - lStart & " ms"
    Stop

    ' -----------------------------------------------------------------
    lAdd = 1000
    Debug.Print vbLf & "DctAdd: Worst case scenarion test by adding " & _
                vbLf & lAdd & " items in the reverse sort order"
    Set dct1 = Nothing
    lStart = GetTime
    For i = lAdd To 1 Step -1
        DctAdd dct1, i, i, dam_sortasc
    Next i
    Debug.Print "Adding " & dct1.count & " items:" & vbLf & _
                GetTime - lStart & " ms"

    Stop

    ' -----------------------------------------------------------------
    ' Example for using dctAdd to sort any dictionary. The item if dct2 
    ' are temporarily added sorted ascending to the dct1 and finally set 
    ' to dct2
    ' ------------------------------------------------------------------
    Debug.Print vbLf & "DctAdd: Used to sort another Dictionary (dct2)"
    Set dct2 = New Dictionary
    dct2.Add "F", 1
    dct2.Add "A", 2
    dct2.Add "C", 3
    dct2.Add "H", 4
    dct2.Add "D", 5
    dct2.Add "E", 6
    dct2.Add "G", 7
    dct2.Add "B", 8

    Set dct1 = Nothing
    For Each vKey In dct2
        DctAdd dct1, dct2(vKey), vKey, dam_sortasc
    Next vKey
    Set dct2 = dct1
    ' Show the result and wait ----------------
    For Each vKey In dct2
        Debug.Print "Key=" & vKey & ", Item=" & dct2.Item(vKey)
    Next vKey

End Sub 
```

# python - mwclient 如何访问 https 后面的 wiki？

> ID：10789537
> 
> 赞同：0
> 
> 时间：2012-05-28T19:26:08.457
> 
> 标签：python, mediawiki

我想使用 mwclient 来编辑 HTTPS 后面的内部 wiki。 [此页面](https://github.com/mwclient/mwclient)建议您可以像这样传入主机元组：

> 站点 = mwclient.Site(('https','wiki.whatever.com'))

但是我看不到如何使用 Apache 进行身份验证。您是否需要设置带有身份验证的 urllib2 开启程序处理程序？

也欢迎使用 python-wikitools 的解决方案，但也缺少 https 示例。

更新：也许它使用与您登录 wiki 时相同的用户 ID 和密码？不过，在这种情况下我仍然会遇到错误：

> `Traceback (most recent call last): File "C:\ddc\DDC_Toolbox\python_root\apps\create_new_project\trunk\create_new_project.py", line 36, in <module> site = mwclient.Site(('https',url)) File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\client.py", line 92, in __init__ self.site_init() File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\client.py", line 100, in site_init siprop = 'general|namespaces', uiprop = 'groups|rights') File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\client.py", line 165, in api info = self.raw_api(action, **kwargs) File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\client.py", line 248, in raw_api json_data = self.raw_call('api', data).read() File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\client.py", line 223, in raw_call url, data = data, headers = headers) File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\http.py", line 226, in post path, headers, data) File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\http.py", line 161, in post return self.request('POST', host, path, headers, data) File "C:\bin\Python27\lib\site-packages\mwclient-0.6.5-py2.7.egg\mwclient\http.py", line 152, in request raise errors.HTTPStatusError, (res.status, res) mwclient.errors.HTTPStatusError: (401, <httplib.HTTPResponse instance at 0x0241C0D0>)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:46:10.210

好吧，`mwclient`不使用 urllib2，所以安装 urllib2 AuthHandler 不会做任何事情。

它正在使用`httplib`，并且从快速查看源代码来看，似乎无法将您自己的标头添加到库发送的请求中，因此如果不修改库本身，添加自定义 Authorization 标头将不起作用。

`python-wikitools`另一方面使用`urllib2`, 但[实例化它自己的 opener](http://code.google.com/p/python-wikitools/source/browse/trunk/wikitools/api.py?r=384#88)，并且能够向其中添加身份验证处理程序，您还需要修改库 -

因此，不幸的是，这两个 api 都不允许您使用开箱即用的身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T18:09:33.077

我已经能够将 HTTPS 身份验证添加到 python-wikitools。我会看到如何将补丁上传给包的维护者。

# python - 为什么 input() 行为不正确？

> ID：10789538
> 
> 赞同：0
> 
> 时间：2012-05-28T19:26:14.360
> 
> 标签：python

我有以下 python 2.7.3 代码，我将提交给 codechef 在线编程竞赛：

```
case = input() 
for i in xrange(0, case):
    try:
        l = [elem for elem in raw_input().split()]
        res = int(l[0][::-1]) + int(l[1][::-1])
        print int(str(res)[::-1])
    except:
        break 
```

这适用于我的计算机，即使我使用输入重定向并使用**in.txt**文件进行输入，它仍然有效。

但问题是当我提交它进行评估时，我得到一个异常，当我使用 raw_input 获取 case 的值时，该异常被删除

```
case = int(raw_input()) 
```

我的 in.txt 文件如下：

```
1
23 45 
```

我的问题是它在我的计算机上完美运行，在线竞赛网站在第一行提供的异常是什么，并且当我使用 raw_input 时它得到纠正。

当我的第一行始终是整数时， input() 不应该也起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T21:49:01.187

最有可能的是，您提交代码以禁用该`input`命令的站点。这有时是作为“沙盒”的一部分完成的，以防止您在他们的机器上运行任意代码。例如，他们不想让您运行删除其磁盘上所有文件的脚本。

该`input`命令或多或少等同于 running `eval(raw_input())`，并且`eval`可以用来做任何事情。

你说你有一个例外。究竟是什么异常，异常信息是什么？

# html - 让导航菜单转到我的标题底部

> ID：10789539
> 
> 赞同：1
> 
> 时间：2012-05-28T19:26:17.567
> 
> 标签：html, css

我有一个带有徽标和导航菜单的标题。

我希望导航菜单通过红色底部边框与徽标底部对齐。

这是我的jsfiddle

[http://jsfiddle.net/nnEr9/3/](http://jsfiddle.net/nnEr9/3/)

导航栏应与最右侧对齐，徽标位于最左侧。

宽度应为 960 像素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:46:34.007

使用定位而不是浮动。添加`position:relative`到您的`#header`和`position:absolute;right:0;bottom:0;`您的导航。

[**JSFiddle 演示**](http://jsfiddle.net/LSz3m)

也可以看看：

*   W3C：[CSS2.1：9.8.2 相对定位](http://www.w3.org/TR/CSS2/visuren.html#comp-relpos)
*   W3C: [CSS2.1: 9.8.4 绝对定位](http://www.w3.org/TR/CSS2/visuren.html#comp-abspos)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:47:25.967

那是你想要的结果吗？[http://jsfiddle.net/nnEr9/3/](http://jsfiddle.net/nnEr9/3/)

# windows - 地理定位如何在有线宽带连接的 Windows PC 上工作？

> ID：10789543
> 
> 赞同：4
> 
> 时间：2012-05-28T19:26:38.747
> 
> 标签：windows, windows-7, geolocation

我正在尝试开发一个使用地理定位的网络应用程序，并开始它在我家的 Windows 7 PC 上运行良好，无论是在 Chrome 还是 Firefox 中。

它在移动浏览器上仍然可以正常工作，但已经停止在我的 PC 上的两个浏览器上工作，这让我想知道它在我的 PC 上实际上是如何工作的 - 它是否正在查询一个 IP 地址的地理数据库，现在可能由于过度使用而阻止我？

有什么方法可以更改设置吗？“位置和其他传感器”控制面板告诉我没有安装传感器，并且“位置活动”的事件日志中没有显示任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-18T16:54:20.763

> Firefox 收集有关附近无线接入点和您计算机 IP 地址的信息。然后 Firefox 将此信息发送给默认的地理定位服务提供商 Google Location Services，以获取您的位置估计。然后与请求的网站共享该位置估计。

来自：[https ://www.mozilla.org/en-US/firefox/geolocation/](https://www.mozilla.org/en-US/firefox/geolocation/)

这也是 Chrome 确定位置的方式（将 IP 和附近的 Wi-Fi 信息发送到 Google 位置服务）。Windows 7 似乎也做了同样的事情，尽管我找不到其他具体细节，除非它使用邮政编码（如果有的话）。

# actionscript-3 - 错误 #1009：无法访问空对象引用的属性或方法

> ID：10789546
> 
> 赞同：0
> 
> 时间：2012-05-28T19:27:06.040
> 
> 标签：actionscript-3

我在视觉上有效时收到 #1009 错误，有人可以帮我吗？提前致谢。arrBellen 是字段级别的数组。

```
private function bellenSpel(mv:MovieClip,x:Number):void{
    stage.addEventListener(KeyboardEvent.KEY_DOWN,keyHandler);
    if(landschap.x == x){
        mv.visible = true;
        mv.mouseEnabled = true;
    }
    else{
        mv.visible = false;
        mv.mouseEnabled = false;
    }

    landschap.lblScore_onderwater.text.text = "Score: " + vogelTimer.currentCount;

    if(vogelTimer.currentCount % 300 == 0) {
        var bel:Bel = maakBellen();
        arrBellen.push(bel);
    }

    for(var i = 0;arrBellen.length - 1;i++){
        var bl:Bel = arrBellen[i];
        bl.y += 2; // output says error is here 
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:06:09.177

好的，这是我的假设…… mgraph 是正确的，或者 maakBellen() 实际上是一个返回 Bel 实例的函数

您的循环条件有错误：

```
for(var i = 0;arrBellen.length - 1;i++){
    var bl:Bel = arrBellen[i];
    bl.y += 2; // output says error is here 
} 
```

你应该有

```
for(var i = 0;i < arrBellen.length;i++){
    var bl:Bel = arrBellen[i];
    bl.y += 2; // output says error is here 
} 
```

我有点困惑为什么这会导致 NPE 而不是 OutOfRange 类型错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:46:30.013

我认为要么你的数组没有包含你认为的对象，要么它们不能转换为 Bel 类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:53:59.007

代替：

```
var bel:Bel = maakBellen(); 
```

喜欢：

```
var bel:Bel = new maakBellen(); 
```

# ios - 如何解决编码问题？（NSString / XMLParsing）

> ID：10789547
> 
> 赞同：0
> 
> 时间：2012-05-28T19:27:12.850
> 
> 标签：ios, encoding, nsstring, nsxmlparser

我解析了一个包含 UTF8/拉丁字符（é、â、è、î 等）的 XML 文件。

起初我试图用一个替换错误字符的函数来解决这个问题。但是我遇到了**à**的问题，替换为**"**。由于我不想替换我文件的所有**"**，所以我必须找到另一种方法来修复它。

有什么办法解决这个问题吗？

非常感谢您的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T11:53:14.103

为了最终回答这个问题，它[使用 TBXML](http://www.tbxml.co.uk/TBXML/TBXML_Free.html)工作。但只能使用 UTF-8 编码，而不是 ISO-8859-1。

# html - 如何在 HTML5 画布上触摸绘制形状

> ID：10789550
> 
> 赞同：0
> 
> 时间：2012-05-28T19:27:32.090
> 
> 标签：html, canvas, touch, draw, shapes

我有个问题...

我试图弄清楚如何在 HTML5 画布上**触摸绘制形状。**我一直在到处寻找，到目前为止，还找不到任何关于物质的下降**教程。**有人可以帮我吗？我知道如何在画布上“绘制”形状（使用代码），但是您如何使用（**触摸）****移动应用程序**的手指**绘制/绘画**？

 ****到目前为止，这是我的代码...

Javascript：

* * *

```
 // draws a Square to the x and y coordinates of the mouse event inside
  // the specified element using the specified context
  function drawSquare(mouseEvent, sigCanvas, context) {

     var position = getPosition(mouseEvent, sigCanvas);

     context.strokeStyle = "color";
     context.strokeRect(x,y,width,height);
  }

  // draws a square from the last coordiantes in the path to the finishing
  // coordinates and unbind any event handlers which need to be preceded
  // by the mouse down event
  function finishDrawing(mouseEvent, sigCanvas, context) {
     // draw the line to the finishing coordinates
     drawSquare(mouseEvent, sigCanvas, context);

     context.closePath();

     // unbind any events which could draw
     $(sigCanvas).unbind("mousemove")
                 .unbind("mouseup")
                 .unbind("mouseout");
  } 
```

HTML5：

* * *

```
 <div id="squareButton">  
    <p><button onclick="drawSquare();">Square</button></p>
</div> 
```

非常感谢，沃登克里夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:14:30.690

不是真正的教程，但 MDN 在这里有一个解决方案[https://developer.mozilla.org/en/DOM/Touch_events#Drawing_as_the_touches_move](https://developer.mozilla.org/en/DOM/Touch_events#Drawing_as_the_touches_move)

此外，您可能想查看触摸事件（也可以在上面的同一链接中找到）

这是我提供的链接的摘录

```
function startup() {
    var el = document.getElementsByTagName("canvas")[0];
    el.addEventListener("touchstart", handleStart, false);
    el.addEventListener("touchend", handleEnd, false);
    el.addEventListener("touchcancel", handleCancel, false);
    el.addEventListener("touchleave", handleEnd, false);
    el.addEventListener("touchmove", handleMove, false);
} 
```****

# uml - 阅读 Cardinality UML Visual Studio 2010

> ID：10789551
> 
> 赞同：0
> 
> 时间：2012-05-28T19:27:33.157
> 
> 标签：uml, t4

我希望通过阅读 Visual Studio 2010 的 UML 类图来使用 t4 生成代码。我能够阅读这些类及其关联。我想阅读相关课程的多样性？知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T18:31:01.210

这样的事情呢？this.Element 是 IClass 的类型

```
foreach (IAssociation association in this.Element.GetRelatedLinks<IAssociation>())
{
    var source = association.SourceElement as IClassifier;
    var target = association.TargetElement as IClassifier;

    foreach(var end in association.MemberEnds)
    {
        WriteLine("// mapping:" + end.Name + ": " + end.GetBounds());
    }
} 
```

我记得看到 GetBounds() 返回一个字符串，其中至少有“1”或“*”作为可能的值。

# php - 长时间后用户返回的数据库值？

> ID：10789553
> 
> 赞同：0
> 
> 时间：2012-05-28T19:27:37.827
> 
> 标签：php, mysql, database, time

**长时间后用户返回的数据库值？**

所以我的数据库中有值，例如 stamina, max_stamina, ...

我想做的是：

```
If stamina is < max_stamina then
    after 60 seconds stamina=stamina+1
else
    nothing 
```

我需要循环这个直到`stamina`等于`max_stamina`

我可以轻松创建 if 语句，我需要帮助的问题是编码 60 秒，我该怎么做？

所有这些都需要在玩家登录和未登录时运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:43:00.753

看看 mysql 事件和时间表认为这就是你要找的。此外，如果您有 1 个以上的用户，那么在您需要的 60 秒间隔内更新它们是明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:33:25.773

在不了解代码架构的情况下，您很可能需要每分钟运行一次 cronjob 并根据您的标准更新所有耐力记录。

# jquery - .hover(...) 和 on.("hover"...) 表现不同

> ID：10789554
> 
> 赞同：5
> 
> 时间：2012-05-28T19:27:39.710
> 
> 标签：jquery, hover

使用 JQuery 当元素具有悬停状态时，我试图链接几个函数。

我通常会使用`.hover`事件函数，但在阅读了一些教程后，我读到使用`.on`更好，因为您可以使用一个事件处理程序来监视文档中的所有冒泡事件。

但是，当我像这样将两个函数链接在一起时遇到问题：

```
$("element").on( "hover", function() {         
    console.log("one");     
}, function() {         
    console.log("two");     
}); 
```

我预计结果是**一二** *（使用时就是这种情况`.hover`）*，但我得到**了二二**。

谁能解释我做错了什么或者这是否是预期的行为以及为什么？

**转载使用`.hover(...)`：http: [//jsfiddle.net/gXSdG/](http://jsfiddle.net/gXSdG/)**

**转载使用`.on(hover...)`：http: [//jsfiddle.net/gXSdG/1/](http://jsfiddle.net/gXSdG/1/)**

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-28T19:30:27.960

`.on()`只能使用 1 个函数，因此您必须询问传递`event`的内容以检查事件是什么。尝试这个：

```
$("element").on("hover", function(e) {
    if (e.type == "mouseenter") {
        console.log("one");   
    }
    else { // mouseleave
        console.log("two");   
    }
}); 
```

[**示例小提琴**](http://jsfiddle.net/gXSdG/3/)

或者，您可以拆分构成方法的两个事件`hover()`-`mouseenter`和`mouseleave`：

```
$("#element").on("mouseenter", function() {
  console.log("one");   
}).on('mouseleave', function() {
  console.log("two");   
});
```

```
#element {
  background-color: black;
  height: 100px;
  margin: 100px;
  width: 100px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="element"></div>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:34:02.517

您只是对首先发生的事情感到困惑，您的两个示例中都没有函数链接。`hover`和的 API`on`不同，请仔细阅读它们，这里是与您的问题相关的概述：

[`hover`](http://api.jquery.com/hover/)接受一个或两个参数，都是函数。第一个在鼠标进入时运行，第二个在鼠标离开时运行。

[`on`](http://api.jquery.com/on/)只接受一个回调，并且永远不会使用您的第一个函数，因为它用于不同的参数，而第二个函数用作回调并为所有悬停事件调用，即鼠标进入*和*鼠标离开。

# java - Proguard injars 和 libraryjars

> ID：10789557
> 
> 赞同：6
> 
> 时间：2012-05-28T19:27:55.870
> 
> 标签：java, obfuscation, proguard

我已经使用 Eclipse 的 Export as Runnable JAR 文件菜单导出了带有多个 3rd 方库的 Java SE 应用程序。我必须如何设置 Proguard 的`injars`和`libraryjar`选项来混淆这个应用程序？

像这样？

*   injars MyApp.jar

*   injars 3rd 方库

*   injars 第二个 3rd 方库等

*   libraryjar ${java.home}/lib/rt.jar

*   libraryjar ${java.home}/lib/jsse.jar

*   libraryjar ${java.home}/lib/jce.jar

所以我必须将第 3 方库设置为`injars`和？`${java.home}/lib/*``libraryjar`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T23:33:57.600

`injars`包含您要混淆的 jar，以及`libraryjars`未混淆的第 3 方库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-12T06:00:10.483

*   ***-injars 类路径***

指定要处理的应用程序的输入 jars（或 aars、wars、ears、zip、apks 或目录）。***这些 jar 中的类文件将被处理并写入输出 jar。默认情况下，任何非类文件都将被复制而不做任何更改***。请注意任何临时文件（例如由 IDE 创建的），尤其是当您直接从目录中读取输入文件时。可以过滤类路径中的条目，如过滤器部分所述。为了更好的可读性，可以使用多个 -injars 选项指定类路径条目。

*   ***-libraryjars 类路径***

指定要处理的应用程序的库 jars（或 aars、wars、ears、zip、apks 或目录）。***`The files in these jars will not be included in the output jars. The specified library jars should at least contain the class files that are extended by application class files. Library class files that are only called needn't be present`***，尽管它们的存在可以改善优化步骤的结果。可以过滤类路径中的条目，如过滤器部分所述。为了更好的可读性，可以使用多个 -libraryjars 选项指定类路径条目。请注意，在查找库类时不考虑为运行 ProGuard 设置的引导路径和类路径。***`This means that you explicitly have to specify the run-time jar that your code will use.`***尽管这看起来很麻烦，但它允许您处理针对不同运行时环境的应用程序。例如，您可以处理 J2SE 应用程序以及 JME midlets 或 Android 应用程序，只需指定适当的运行时 jar。

***我的结果***`

1.  -injars MyApp.jar
2.  -libraryjars ${java.home}/lib/rt.jar
3.  -libraryjar ${java.home}/lib/jsse.jar
4.  -libraryjar ${java.home}/lib/jce.jar

至于第三部分库，有一些区别。

> 指定的库 jar 至少应该包含由应用程序类文件扩展的类文件。仅被调用的库类文件不需要存在

，所以第三部分库可能不需要设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T11:21:08.147

以下情况属实：

```
-injars MyApp.jar

-libraryjars 3rd party lib 
```

不要把系统路径举例：`${java.home}` `proguard`不会明白。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-12T13:55:20.107

一个老问题，但我认为仍然相关.. 这是使用 gradle 插件的解决方案

```
buildscript {
repositories {
    mavenCentral()
}
dependencies {
    classpath 'net.sf.proguard:proguard-gradle:6.2.2'
    classpath 'net.sf.proguard:proguard-base:6.2.2'
}
}

task proguard( type: proguard.gradle.ProGuardTask) {

def inputDir = new File("${System.getProperty('user.dir')}/injars/")
println ("List of jars for obfuscation : ")
inputDir.eachFileRecurse (FileType.FILES) { file ->
        println(file.getName())
        injars file
        outjars "${System.getProperty('user.dir')}/outjars/${file.getName()}"
    }

}

libraryjars "${System.getProperty('java.home')}/lib/rt.jar"
libraryjars "${System.getProperty('java.home')}/lib/jce.jar"
libraryjars "${System.getProperty('user.dir')}/dependencies/"

} 
```

*   将上面的代码添加到你的 build.gradle
*   执行`gradle proguard`

# c - 与 C 赋值叠加

> ID：10789561
> 
> 赞同：0
> 
> 时间：2012-05-28T19:28:11.410
> 
> 标签：c, string, function

我必须编写一个`int bit_to_ascii(const char input[], char output[]);`从字符数组中读取二进制代码并对其进行翻译的函数。我已经这样做了。

当我在家用计算机上使用 Code::Blocks 时，一切正常。但是，当我将代码放在必须为标记保留程序的服务器上时，它正在编译，但在程序的第一步之后给了我一个分段错误。我有什么错？Code::Blocks 中的编译器和服务器上的编译器有什么区别？

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>

#define LINES 5

/* assignment #1 function prototype */
int bit_to_ascii(const char input[], char output[]);

int main( ) {

const char *core_data[ ] = {
"0", /* should insert the null byte '\0' only */

"01010111 This sequence contains the letter 'W'       " /*  87 = 'W' */
"      r5 0 #! 1 1 gP 0 f66-:] 0 [ } 1 v4t^ 0 1 n>?:77" /* 101 = 'e' */
" junk ^*@&#^% 0110  more junk }{r;,<> 1100         2x" /* 108 = 'l' */
"                  0    1       1     0 0          011" /*  99 = 'c' */
"0  ^%jh  1 ]{) OVR 1 - 0 _! 9 + 1  118Y z(x pM1      " /* 111 = 'o' */
"This next group of 8 should be SKP skipped! 11111111 " /* skipped */
"*&^! 0  1  1  0 1     1 0     128673kjshd:L<    2938 " /* 109 = 'm' */
"      r5 0 #! 1 1 gP 0 f66-:] 0 [ } 1 v4t^ 0 1 n>?:77" /* 101 = 'e' */
"#!/bin/bash 00  1 00 00 0 g^b-ps 6@&^%               " /*  32 = ' ' */
"01010100 This sequence contains the letter 'T'       " /*  84 = 'T' */
"0  ^%jh  1 ]{) OVR 1 - 0 _! 9 + 1  118Y z(x pM1      " /* 111 = 'o' */
"#!/bin/bash 00  1 00 00 0 g^b-ps 6@&^%               " /*  32 = ' ' */
"---repeat--->0 1 0 0 1 1 1 1<------------RPT2--------" /*  79 = 'O' */
"0 1 0 1 0bbavac9872962  000&*************************" /*  80 = 'P' */
"a0b0c1d1e0f0g1h0ijklmnopqrstuvwxyz*******************" /*  50 = '2' */
"00fg333                                110100>>>>>>>>" /*  52 = '4' */
"00fg333                                110100>>>>>>>>" /*  52 = '4' */
"                     0000                            ",/*  0 = '\0' */

"00011110 This char should not be inserted!           " /*  30 cntrl */
" 00011111 This char should not be inserted!          " /*  31 cntrl */
"  00100000                                           " /*  32 = ' ' */
"   00100001                                          " /*  33 = '!' */
"    00100010                                         " /*  34 = '"' */
"     00100011                                        " /*  35 = '#' */
"      00100100                                       " /*  36 = '$' */
"       00100101                                      " /*  37 = '%' */
"        00100110                                     " /*  38 = '&' */
"         00100111                                    " /*  39 = ''' */
"          00101000                                   " /*  40 = '(' */
"           00101001                                  " /*  41 = ')' */
"            00101010                                 " /*  42 = '*' */
"             00101011                                " /*  43 = '+' */
"              00101100                               " /*  44 = ',' */
"               00101101                              " /*  45 = '-' */
"                00101110                             " /*  46 = '.' */
"                 00101111                            " /*  47 = '/' */
"                  00110000                           " /*  48 = '0' */
"                   00110001                          " /*  49 = '1' */
"                    00110010                         " /*  50 = '2' */
"                     00110011                        " /*  51 = '3' */
"                      00110100                       " /*  52 = '4' */
"                       00110101                      " /*  53 = '5' */
"                        00110110                     " /*  54 = '6' */
"                         00110111                    " /*  55 = '7' */
"                          00111000                   " /*  56 = '8' */
"                           00111001                  " /*  57 = '9' */
"                            00111010                 " /*  58 = ':' */
"                             00111011                " /*  59 = ';' */
"                              00111100               " /*  60 = '<' */
"                               00111101              " /*  61 = '=' */
"                                00111110             " /*  62 = '>' */
"                                 00111111            " /*  63 = '?' */
"                                  01000000           " /*  64 = '@' */
"                                   00000000          ",/*   0 = '\0'*/

"                                    01000001         " /*  65 = 'A' */
"                                     01000010        " /*  66 = 'B' */
"                                      01000011       " /*  67 = 'C' */
"                                       01000100      " /*  68 = 'D' */
"                                        01000101     " /*  69 = 'E' */
"                                         01000110    " /*  70 = 'F' */
"                                          01000111   " /*  71 = 'G' */
"                                           01001000  " /*  72 = 'H' */
"                                            01001001 " /*  73 = 'I' */
"                                             01001010" /*  74 = 'J' */
"                                            01001011 " /*  75 = 'K' */
"                                           01001100  " /*  76 = 'L' */
"                                          01001101   " /*  77 = 'M' */
"                                         01001110    " /*  78 = 'N' */
"                                        01001111     " /*  79 = 'O' */
"                                       01010000      " /*  80 = 'P' */
"                                      01010001       " /*  81 = 'Q' */
"                                     01010010        " /*  82 = 'R' */
"                                    01010011         " /*  83 = 'S' */
"                                   01010100          " /*  84 = 'T' */
"                                  01010101           " /*  85 = 'U' */
"                                 01010110            " /*  86 = 'V' */
"                                01010111             " /*  87 = 'W' */
"                               01011000              " /*  88 = 'X' */
"                              01011001               " /*  89 = 'Y' */
"                             01011010                " /*  90 = 'Z' */
"                            01011011                 " /*  91 = '[' */
"                           01011100                  " /*  92 = '/' */
"                          01011101                   " /*  93 = ']' */
"                         01011110                    " /*  94 = '^' */
"                        01011111                     " /*  95 = '_' */
"                       01100000                      " /*  96 = '`' */
"                      00000000                       ",/*   0 = '\0'*/

"                     01100001                        " /*  97 = 'a' */
"                    01100010                         " /*  98 = 'b' */
"                   01100011                          " /*  99 = 'c' */
"                  01100100                           " /* 100 = 'd' */
"                 01100101                            " /* 101 = 'e' */
"                01100110                             " /* 102 = 'f' */
"               01100111                              " /* 103 = 'g' */
"              01101000                               " /* 104 = 'h' */
"             01101001                                " /* 105 = 'i' */
"            01101010                                 " /* 106 = 'j' */
"           01101011                                  " /* 107 = 'k' */
"          01101100                                   " /* 108 = 'l' */
"         01101101                                    " /* 109 = 'm' */
"        01101110                                     " /* 110 = 'n' */
"       01101111                                      " /* 111 = 'o' */
"      01110000                                       " /* 112 = 'p' */
"     01110001                                        " /* 113 = 'q' */
"    01110010                                         " /* 114 = 'r' */
"   01110011                                          " /* 115 = 's' */
"  01110100                                           " /* 116 = 't' */
" 01110101                                            " /* 117 = 'u' */
"01110110                                             " /* 118 = 'v' */
" 01110111                                            " /* 119 = 'w' */
"  01111000                                           " /* 120 = 'x' */
"   01111001                                          " /* 121 = 'y' */
"    01111010                                         " /* 122 = 'z' */
"     01111011                                        " /* 123 = '{' */
"      011111RPT10                                    " /* 124 = '|' */
"       01111101                                      " /* 125 = '}' */
"        00000000                                     " /*   0 = '\0'*/
};

char phrase[41];
char correct[LINES][41] = {
  "",
  "Welcome To OOP244",
  " !\"#$%&'()*+,-./0123456789:;<=>?@",
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`",
  "abcdefghijklmnopqrstuvwxyz{||||||||||}"
 };

int rvalues[LINES] = { 1, 18, 34, 33, 39 }, i;
int valid = 1, rc;

for(i=0; i<LINES && valid; i++) {
  rc = bit_to_ascii(core_data[i], phrase);
  if(rc != rvalues[i] || strcmp(phrase, correct[i])) {
 printf("Failed on test... %d\n\n", i+1);
 valid = 0;
  }
  else {
 printf("Passed test %d...\n\n", i+1);
  }
  printf("Your string ----------> '%s'\n", phrase);
  printf("Actual string --------> '%s'\n", correct[i]);
  printf("Your return value ----> %d\n", rc);
  printf("Actual return value --> %d\n", rvalues[i]);
  printf("Press the ENTER key to continue...");
  getchar( );
 }
 if(valid) {
  printf("\nCongratualtions!!! You passed all tests.\n");
  printf("You may hand in your assignment.\n");
 }
 else {
  printf("\nYou correctly sequenced %d/5 data blocks...\n", i-1);
  printf("Your program still needs some work!\n");
  printf("Keep at it!\n\n");
 }
 return 0;
 }

 int bit_to_ascii(const char core[ ], char data[ ]) {
   int i, rc = 0, j, inte[7], len, len2, m, rpt1, rptcounter, bin, lendata = 0, p = 0;
   char binarray[9], rpt[4], skp[9];
    rpt[4]='\0';
   for(i=0, j=0; core[i] != '\0'; i++) {
 switch(core[i]) {
 case '1':
 case '0':
  if(j<8) {
       binarray[j++] = core[i];
       binarray[j] = '\0';
    }
  else {
     binarray[j] = '\0';
     inte[0] = (binarray[0] - 48) * 128;
     inte[1] = (binarray[1] - 48) * 64;
     inte[2] = (binarray[2] - 48) * 32;
     inte[3] = (binarray[3] - 48) * 16;
     inte[4] = (binarray[4] - 48) * 8;
     inte[5] = (binarray[5] - 48) * 4;
     inte[6] = (binarray[6] - 48) * 2;
     inte[7] = (binarray[7] - 48) * 1;

     bin = inte[0] + inte[1] + inte[2] + inte[3] + inte[4] + inte[5] + inte[6] +inte[7];
     if(bin<=0 || bin >=32) {
     data[lendata] = bin;
     lendata++;
     }
     j = 0; /* resets j to 0 after 8 1's or 0's have been found */

     if(j<8) {
       binarray[j++] = core[i];
     }//end if
     }//end else
     case 'R':

    if(core[i+1] == 'P' && core[i+2] == 'T') {
      i=i+3;
      if(isdigit(core[i])) {
         rpt[0] = core[i];
         i++;

            if(isdigit(core[i])) {
               rpt[1] = core[i];
               i++;
                  if(isdigit(core[i])) {
                     rpt[2] = core[i];
                     i++;
                  }
            }

         rpt1 = atoi (rpt);
         //printf("\n\n%d\n\n", rpt1);
         len = strlen(binarray);
         for(rptcounter=0, j=0; rptcounter<rpt1; rptcounter++ ){ //loops rpt1 times
            if(len<8){
                      len2 = 8 - len;
                      m = len;
                      do {
                                  binarray[m]='0';
                                  m++;
                      }while (m != 8);
                      }
            inte[0] = (binarray[0] - 48) * 128;
            inte[1] = (binarray[1] - 48) * 64;
            inte[2] = (binarray[2] - 48) * 32;
            inte[3] = (binarray[3] - 48) * 16;
            inte[4] = (binarray[4] - 48) * 8;
            inte[5] = (binarray[5] - 48) * 4;
            inte[6] = (binarray[6] - 48) * 2;
            inte[7] = (binarray[7] - 48) * 1;
      bin = inte[0] + inte[1] + inte[2] + inte[3] + inte[4] + inte[5] + inte[6]+inte[7];
            data[lendata] = bin;
            lendata++;
         }
      }
      }
      break;
    case 'S':
   if(core[i+1] == 'K' && core[i+2] == 'P') {
   i=i+3;
   for(p=0;p!=8;i++) {
      switch(core[i]) {
      case '1':
      case '0':
           skp[p] = core[i];
           p++;
           break;
      }
   }
   }
    break;
  }//end case
  }//end for
   binarray[j] = '\0';
   len = strlen(binarray);
            if(len<8){
                      len2 = 8 - len;
                      m = len;
                      do {
                                  binarray[m]='0';
                                  m++;
                      }while (m != 8);
                      }
   inte[0] = (binarray[0] - 48) * 128;
   inte[1] = (binarray[1] - 48) * 64;
   inte[2] = (binarray[2] - 48) * 32;
   inte[3] = (binarray[3] - 48) * 16;
   inte[4] = (binarray[4] - 48) * 8;
   inte[5] = (binarray[5] - 48) * 4;
   inte[6] = (binarray[6] - 48) * 2;
   inte[7] = (binarray[7] - 48) * 1;
   bin = inte[0] + inte[1] + inte[2] + inte[3] + inte[4] + inte[5] + inte[6] + inte[7];
   data[lendata] = bin;
   lendata++;
   data[lendata]='\0';
   rc = strlen(data) + 1;
   if (rc==0) {
          rc++;
          }
   return rc;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:02:37.370

认为您的问题在第 290 行。lendata 太大（3533）。我在理解您的代码时遇到了一些问题。但是lendata应该小于41（短语的大小）？（但使用调试器，在 unix 上使用 gdb。有一个名为 ddd 的图形前端。）编辑：inte 在第 180 行到第 [7] 行声明。大多数是线[8]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:08:33.853

另一个跳出来的问题是

```
char binarray[9], rpt[4], skp[9];
rpt[4]='\0'; 
```

`rpt[4]`尽管有效索引为 0-3，但您设置为 0。

你正在写八个元素`inte`，

```
inte[0] = (binarray[0] - 48) * 128;
inte[1] = (binarray[1] - 48) * 64;
inte[2] = (binarray[2] - 48) * 32;
inte[3] = (binarray[3] - 48) * 16;
inte[4] = (binarray[4] - 48) * 8;
inte[5] = (binarray[5] - 48) * 4;
inte[6] = (binarray[6] - 48) * 2;
inte[7] = (binarray[7] - 48) * 1; 
```

虽然它是声明的`int i, rc = 0, j, inte[7], ...`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T19:31:03.967

也许我看不清楚，但你在 core_data 中的行不应该用逗号分隔吗？

# c++ - typedef 中的三个术语是什么意思？

> ID：10789563
> 
> 赞同：2
> 
> 时间：2012-05-28T19:28:26.697
> 
> 标签：c++, c, typedef

当 typedef 中有三个项目时，这意味着什么？

例如：

```
typedef CK_BYTE     CK_PTR       CK_BYTE_PTR; 
```

我知道，如果你有`typedef CK_BYTE CK_PTR`; 那么`CK_BYTE`就只能称为`CK_PTR`.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-28T19:35:29.160

一点谷歌搜索表明这`CK_PTR`是一个定义在[`pkcs11.h`](ftp://ftp.mozilla.org/pub/security/nss/sonmi/Linux2.4_x86_glibc_PTH_DBG.OBJ/include/pkcs11.h). 按照该链接查看这些定义的文档。

通常定义为：

```
#define CK_PTR * 
```

但在一些古老的系统上，它可能被定义为

```
#define CK_PTR far * 
```

where`far`是一个大部分已过时的系统特定关键字，它指定某种非标准类型的指针。

所以这：

```
typedef CK_BYTE CK_PTR CK_BYTE_PTR; 
```

相当于这个（更清晰的）代码：

```
typedef CK_BYTE *CK_BYTE_PTR; 
```

它定义`CK_BYTE_PTR`为指向 a 的指针`CK_BYTE`。

引用的定义`CK_BYTE_PTR`出现在同一个头文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T19:30:22.887

它不是有效的语法，除非其中之一是宏（例如`#define CK_PTR *`，这是可怕的）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T19:30:49.057

假设`CK_PTR`定义为`*`您将 a类型定义`CK_BYTE*`为 a `CK_BYTE_PTR`。

# iphone - 比较 2 个 NSArray？

> ID：10789565
> 
> 赞同：1
> 
> 时间：2012-05-28T19:28:36.090
> 
> 标签：iphone, xcode, nsmutablearray

有没有更快的方法来比较 2 个 NSArrays？我需要知道两个数组中是否存在缺口并获取它们的索引。

看看我的方法，我认为我们可以更快地做一些事情

```
-(void)classPseudo
{
     AppDelegate  *app = [[UIApplication sharedApplication]delegate];
     NSString * documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
     NSString *fullFileName = [NSString stringWithFormat:@"%@/contactArray.txt", documentsPath];
     NSMutableArray *newOnlineArray = [[NSMutableArray alloc]initWithContentsOfFile:fullFileName];
     NSUInteger count = [newOnlineArray count];
     NSUInteger count2 = [app.messagePseudo count]; 
     for (NSUInteger index = 0; index < count; index++)
    {
        for (NSUInteger index2 = 0; index2 < count2; index2++)
        {

        dict1= [newOnlineArray objectAtIndex:index];
        st1 = [dict1 objectForKey:@"pseudo"];
        dict2= [app.messagePseudo objectAtIndex:index2];
         st2 = [dict2 objectForKey:@"expediteur"];
                if ([st2 isEqualToString:st1]) 
            {
                NSLog(@"YESS %d",index);

                 }
            else {
                NSLog(@"NOOOON");

            }
         }
    }
} 
```

任何帮助都将提前获得 .Thanx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:50:52.660

你没有很清楚地解释你的问题。例如，您没有解释所涉及的数据结构。（显然是两个字典数组。）你没有准确地说出你想要什么作为输出。而对于那些不会说法语的人来说，“nicks”在一种情况下对应于“pseudo”而在另一种情况下对应于“expediteur”并不是很清楚。您还没有解释预期的数据集。例如，每个伪预期在第一个数组中出现多次还是几次？第二个中的 expediteur 也是如此。

无论如何，您可以构建一个“伪”值到索引集的映射。然后，遍历第二个数组并在地图中查找 expediteurs。

```
NSMutableDictionary* pseudoIndexes = [NSMutableDictionary dictionary];
[newOnlineArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop){
    NSString* pseudo = [obj objectForKey:@"pseudo"];
    NSMutableIndexSet* indexes = [pseudoIndexes objectForKey:pseudo];
    if (!indexes)
    {
        indexes = [NSMutableIndexSet indexSet];
        [pseudoIndexes setObject:indexes forKey:pseudo];
    }
    [indexes addIndex:idx];
}];

[app.messagePseudo enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop){
    NSString* expediteur = [obj objectForKey:@"expediteur"];
    NSIndexSet* indexes = [pseudoIndexes objectForKey:expediteur];
    NSLog(@"For expediteur #%d '%@', pseudo indexes %@", idx, expediteur, indexes);
}]; 
```

# iphone - 每次从同一个视图加载应用程序

> ID：10789566
> 
> 赞同：2
> 
> 时间：2012-05-28T19:28:37.083
> 
> 标签：iphone, objective-c, ios, xcode, uitabbar

我希望我的应用程序每次完全加载到内存不足时都加载到同一个视图中，因此当应用程序关闭然后再次打开时，它会打开同一个视图（目前它是 UITabBar 中的选项卡之一）。我想看代码，而不仅仅是关于如何做到这一点的描述，因为我在 iOS 开发方面不是很有经验。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:34:34.747

~~`Info.plist`例如，如果您的选项卡是主菜单，您总是希望在应用程序运行时加载，那么考虑通过在应用程序文件中添加以下键来不允许多任务处理：~~

 ~~```
Application does not run in background - (tick the box)
or:
UIApplicationExitsOnSuspend - set to YES (BOOL) 
```~~ 

~~这将确保您的应用程序在按下 home 键并调用该`UIApplicationDelegate`方法时退出`applicationwillterminate:`。~~

编辑：

好的，我认为您需要跟踪您的特定选项卡和/或用户所在的选项卡，每当这种情况发生变化时。将此值保存在 NSUserDefaults (plist) 中，并在每次应用程序启动或激活时检查它 - 如果它不在正确的选项卡上，您可以切换到该选项卡。

这是你想要做的吗？

编辑2：

第一步，无论您在标签栏上是否听到按钮按下，都需要获取新选定索引的整数值，就像在此处接受的答案中一样：

[以编程方式切换到 TabBar 选项卡视图？](https://stackoverflow.com/questions/5413538/switching-to-a-tabbar-tab-view-programmatically)

然后，您需要将此值（存储/保存）写入 .plist 文件。首先，将一个新的属性列表文件添加到您的项目中，然后在 Xcode 中打开它并添加一个新行，将其命名为简单`SelectedTab`的类型，例如使用 Number 类型并说出值 1337。

在您的应用委托中，您需要告诉您的应用您有一个新的 .plist 需要向该应用注册，因此`application:didFinishLaunchingWithOptions:`您需要执行以下操作：

```
NSUserDefaults* userPreferences = [NSUserDefaults standardUserDefaults];
[userPreferences registerDefaults: [NSDictionary dictionaryWithContentsOfFile: [[NSBundle mainBundle] pathForResource: @"myNewFile" ofType: @"plist"]]]; 
```

以下是读取和写入`SelectedTab`plist 整数的方法：

要获取存储值...

```
int test = [[NSUserDefaults standardUserDefaults] integerForKey: @"SelectedTab"]; 
```

要将新值写入您的密钥...

```
int newTab = 2;
[[NSUserDefaults standardUserDefaults] setInteger: newTab forKey: @"SelectedTab"];
[[NSUserDefaults standardUserDefaults] synchronize]; // absolutely critical! 
```

您只需要在您的应用程序委托中选择正确的位置来执行此检查，然后告诉您的标签栏加载您想要的标签。

希望这可以帮助！

# asp.net - 将 webform 控件转换为 Razor 语法

> ID：10789567
> 
> 赞同：1
> 
> 时间：2012-05-28T19:28:43.770
> 
> 标签：asp.net, asp.net-mvc-3, razor

我得到了这个控件，它工作正常，但我需要在我的 mvc3 项目中使用它。我尝试了我的方法，但没有奏效。我希望有一个人可以帮助我。这就是 webform 自定义控件代码：

ASPX：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="BoletoCS.aspx.cs" Inherits="BoletoCS" %>
<%@ Register Assembly="Impactro.Cobranca" Namespace="Impactro.WebControls" TagPrefix="cob" %>

<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
    <title>Boleto</title>
    <style type="text/css">
    .BolCell { font-size: 7pt; font-family: Verdana; }
        .BolField { font-weight: bold; font-size: 12px; font-family: arial; }
</style>
</head>
<body>
    <form id="form1" runat="server">
         <cob:BoletoWeb id="bltPag" runat="server" CssCell="BolCell" CssField="BolField" ></cob:BoletoWeb>
     </form>
</body>
</html> 
```

代码隐藏：

```
using System;
using Impactro.Cobranca;

public partial class BoletoCS : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        var cedente = new CedenteInfo
        {
            Cedente = "CURRICULO AUT ASS E CONS EM RH",
            Banco = "341",
            Agencia = "6157",
            Conta = "30901-1",
            Carteira = "175",
            CNPJ = "14.765.492/0001-10"
        };

        var sacado = new SacadoInfo { Sacado = "RODRIGO MANGUINHO" };

        var boleto = new BoletoInfo
        {
            NossoNumero = "44",
            ValorDocumento = 99,
            DataDocumento = DateTime.Now,
            DataVencimento = DateTime.Now.AddMonths(1),
            LocalPagamento = "PAGÁVEL EM QUALQUER BANCO ATÉ O VENCIMENTO.",
            Especie = Especies.RC,
            Instrucoes = "NÃO ACEITAR PAGAMENTO APÓS O VENCIMENTO."
        };

        bltPag.MakeBoleto(cedente, sacado, boleto);
    }
} 
```

此自定义控件继承自 webcontrol。它基本上呈现一个表格。我试过用 Razor 做这个，但没有用。也没有任何错误。

```
@using Impactro.WebControls
@using Impactro.Cobranca

@{
    var ci = new CedenteInfo
    {
        Cedente = "CURRICULO AUT ASS E CONS EM RH",
        Banco = "341",
        Agencia = "6157",
        Conta = "30901-1",
        Carteira = "175",
        CNPJ = "14.765.492/0001-10"
    };

    var si = new SacadoInfo { Sacado = "RODRIGO MANGUINHO" };

    var bi = new BoletoInfo
    {
        NossoNumero = "44",
        ValorDocumento = 99,
        DataDocumento = DateTime.Now,
        DataVencimento = DateTime.Now.AddMonths(1),
        LocalPagamento = "PAGÁVEL EM QUALQUER BANCO ATÉ O VENCIMENTO.",
        Especie = Especies.RC,
        Instrucoes = "NÃO ACEITAR PAGAMENTO APÓS O VENCIMENTO."
    };

    var bw = new BoletoWeb
    {
        CssCell = "",
        CssField = "",
        ImagePath = Url.Content("~/images/bank-ticket")
    };

    bw.MakeBoleto(ci, si, bi);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:31:16.120

您不能在 ASP.NET MVC 应用程序中使用服务器端控件。尽管使用带有 Razor 的 WebForms 视图引擎仍然可以做到这一点（但不推荐），但现在已经不可能了。如果您绝对需要调用服务器端控件，请尝试对需要调用控件的特定视图使用 WebForms 视图引擎。但是如果这个控件依赖于 ViewState 和 PostBacks，它就不起作用了。

# python - Python 3 utf-8 编码似乎是错误的？

> ID：10789568
> 
> 赞同：2
> 
> 时间：2012-05-28T19:28:47.757
> 
> 标签：python, unicode, python-3.x

过去我用 Python 3.2 搞砸了，但现在我面临一个关于 Python 中 utf-8 编码的有点混乱的情况。
例如，假设我有这段代码：

```
'א'.encode() 
```

结果是`b'\xd7\x90'`（或`0xD790`），然而，这是错误的：希伯来字符 Alef 的 utf-8 编码应该是`0x5D0`。
但是，使用 utf-16 作为编码会返回正确的十六进制值，前缀为`0xFFFE`：

```
'א'.encode('utf-16') 
```

这返回`b'\xff\xfe\xd0\x05'`。

我觉得我的理解中缺少一些基本的东西，所以
用户，请帮助教育我！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T19:39:35.947

א的[unicode代码点是 U+05D0*或*](http://www.fileformat.info/info/unicode/char/05D0/index.htm)二进制`101 1101 0000`。11 位代码点 ABCDEFGHIJK 的 UTF-8 编码[是](http://en.wikipedia.org/wiki/UTF-8#Description)

```
110A BCDE  10FG HIJK
# i.e.
1101 0111  1001 0000 # binary
 d    7     9    0   # hex 
```

或者，在 Python 表示法中，`b'\xd7\x90'`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T19:38:23.590

`0x5d0`根本不是编码；它只是一个数字。是的，希伯来字母 ALEF 是 U+05D0，但 UTF-8 不是将代码点转录为字节。相反，它在每个字节的 MSb 中使用一组固定的位，并使用来自代码点值的可变位数填充 LSb。

```
0x5d0 = 101 1101 0000
      = 10111 010000 
```

插入[110xxxxxx 10xxxxxx](http://en.wikipedia.org/wiki/UTF-8#Description)我们得到：

```
11010111 10010000 = 0xd7 0x90 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-28T19:44:45.857

不，*unicode 代码点*是`א`0x5d0：

```
print("%x" % ord('א'))  
# '5d0' 
```

当您对其进行编码时，`utf-8`您将获得一种表示该特定代码点的可能方式。`utf-16`将是另一种表示它的方式，它使用 2 个字节表示每个代码点。你得到它前缀的原因`\xff\xfe`是它会`encode('utf-16')`生成一个字节顺序标记（BOM）。如果您明确指定字节顺序，则不会生成它：

```
>>> a='א'
>>> a.encode('utf-16')
b'\xff\xfe\xd0\x05'
>>> a.encode('utf-16-le')
b'\xd0\x05'
>>> a.encode('utf-16-be')
b'\x05\xd0' 
```

# django - 将 csv 内容传递给模板

> ID：10789571
> 
> 赞同：0
> 
> 时间：2012-05-28T19:29:07.960
> 
> 标签：django

将 csv 内容传递给模板。并得到错误。谢谢

```
 def ....
    with open('csv', 'rb') as f:
      reader = csv.reader(f)
    return render(request, template, {"results": reader}) 
```

错误

```
I/O operation on closed file 
```

[完整回溯](http://dpaste.org/ffXLn/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:27:03.980

`with`引入了一个新的上下文管理器，在文件的情况下，它负责在文件结束后关闭它的参数。但是，您的上下文管理器在下一行结束，因此在`render`调用该函数时，文件已关闭，并且 csv 阅读器无法操作。

您可能只是将`return`一个缩进向右移动，或者更好地在其中调用 render ，`with`但将其保存到您随后传递给的变量中`return`：

```
with open('csv', 'rb') as f:
    reader = csv.reader(f)
    html = render(request, template, {"results": reader})
return html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:30:13.893

问题是您将阅读器对象传递给模板（您在其中迭代它），但是由于它不在`with`块中，因此文件已关闭。

为了纠正这种情况，一种方法是将生成器转换为一些可迭代的序列。

例如：

```
def foo(request):
    lines = []
    with open('foo.csv', 'rb') as f:
        lines = [line for line in csv.reader(f)]
    return render(request, template, {'results': lines}) 
```

# php - 删除文件中的完全匹配

> ID：10789573
> 
> 赞同：2
> 
> 时间：2012-05-28T19:29:16.943
> 
> 标签：php, forms, file, match

我在这里进行了广泛搜索，但没有解决我的问题（php）。

场景：用户访问具有预先分配的注册号码（在 datafile.txt 中）的登录页面，当在字段中输入号码时，脚本搜索文件是否存在号码。

如果确实存在，则继续下一步。完成下一步后，我希望它在完成后自动“删除”最初使用的号码。

我相信“搜索和替换”是要走的路，同时搜索“精确”匹配。

我的数据文件将类似于以下内容：（datafile.txt）

```
0
12
123
1234
12345
123456 
```

12，如果搜索，将与 123 不同。

几天前我收到的一个脚本是为了完成另一项任务：

```
$numbers = file_get_contents("datafile.txt");

$uNumber = $_POST['uNum'];

if ( @preg_match( "/([^0-9]{$uNumber}[^0-9])/", $numbers ) ) {

echo "Numbers match";

} 
```

我试图为一项新任务做的是以下但没有成功：

```
$numbers = file_get_contents('datafile.txt', 'w+');

$uNumber = $_POST['uNum'];

if ( @preg_match( "/([^0-9]{$uNumber}[^0-9])/", $numbers ) ) {

$numbers = preg_replace('.$_Post["uNum"]','',$numbers);

echo "Existed but will be deleted from file. ";

} else {
echo "Message showed if not in file.";
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:11:04.830

这个怎么样：

```
$index = file_get_contents("datafile.txt"); 
$bodycont = str_replace("string to be replaced","what you want that string to be",$index);
$fh = fopen("datafile.txt","w");
fwrite($fh,$bodycont);
fclose($fh); 
```

或者：

```
 $file = file("datafile.txt", FILE_IGNORE_NEW_LINES);
 foreach($file as $text) {
 $test[] = $text;
 }

//get the size of the array

$arraysize = sizeof($test);

//use for loop to check if that string is found in the array and replace it

for($x=0;$x<$arraysize;$x++)
    {
               if($test[$x] == "$uNumber")
                {

                }
                else
                {
                   $newarray[] = $test[$x];
                }
    }
 $stringData = implode("\n",$newarray );
 $fh = fopen("datafile.txt","w");
 fwrite($fh,$stringData );
 fclose($fh); 
```

这应该以某种方式起作用。:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:59:24.737

为什么要使用正则表达式来做这么简单的事情？你可以这样：

```
<?php
$numbers = file_get_contents("datafile.txt");
$uNumber = $_POST['uNum'];

$numbers = explode($numbers, "\n");

foreach ($numbers as $num) {
     if ($num == $uNumber) {
         unset($num);
     }
}

$numbers = implode($numbers, "\n");

// some code that saves the file
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:33:55.743

如果它是每行文件一个数字，请使用`^`and`$`来限制您的正则表达式以匹配确切的模式。

```
preg_match( "/^({$uNumber})$/", $numbers) 
```

# java - 使用 java hibernate criteria API 作为单个查询进行选择和更新

> ID：10789576
> 
> 赞同：2
> 
> 时间：2012-05-28T19:29:34.103
> 
> 标签：java, sql, hibernate, criteria-api, nhibernate-criteria

我编写了一个应用程序，它一次从 Oracle Db 中的表中读取 1 条记录，对其进行一些处理，然后将其再次保存到同一个表中。我还在表中维护一个状态列，以跟踪我当前的记录进度。例如。在选择我将其更新为“U”并最后将其更改为“P”后，最初的记录状态为“N”。

现在我的问题是我想运行这个应用程序的许多实例，但是阻止程序是同一行可能被不同的实例选择，因为选择和更新状态到“U”不是一个单一的查询。所以它可能会发生进程 1 选择然后进程 2 选择相同然后记录Process1更新状态为'U'。我必须解决这个问题才能使我的应用程序分发。

我已经将选择和更新查询创建为单个事务，但我猜是因为这不能解决问题。我的这个逻辑是正确的吗？

我正在使用 Hibernate 访问数据库。任何人都知道如何使用 Hibernate java 来实现这一点？

如果我的上述逻辑（关于事务）是正确的，那么我可以通过两种方式来做到这一点，如果其中任何一种是由休眠提供的。

1-在 1 个查询中选择并更新记录

2-选择一行并将其锁定在 1 个查询中，然后在同一事务中运行另一个查询以将状态更新为 'U' 。在 Sql 中，我可以通过在查询结束时使用“for update”来做到这一点，但我不确定如何使用“Hibernate criteria”来做到这一点。Criteria 也有一个 API“forUpdate”，但我猜这不起作用，因为查询由在这种情况下，休眠最后没有“更新”。

有人可以帮我吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-27T12:32:30.810

是的，可以使用条件进行一次查询。

我正在写一个例子。我希望它对你有帮助。

```
public void updateEmployee(int empid,String firstname, String lastname, String email)
{
    sf=connect(); // get connection
    Session session=sf.openSession();
    Transaction t=session.beginTransaction();

    Employee emp= (Employee) session.get(Employee.class, empid);
    emp.setFirstname(firstname);
    emp.setLastname(lastname);
    emp.setEmail(email);

    session.update(emp);  // Update employee
    t.commit();
    session.close();
} 
```

# javascript - 是否有一个 CoffeeScript 包装函数可以将所有文件一起加载？

> ID：10789581
> 
> 赞同：0
> 
> 时间：2012-05-28T19:29:57.363
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, coffeescript

我的 CoffeeScript 代码约为 6,000 行。为了我的理智，我想把它分成几个文件。

CoffeScript 为每个文件添加一个包装器：

```
(function() {

  something = [1,2,3]

}).call(this); 
```

但相反，我希望它将清单中的所有文件包装在一起。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:29:34.203

您可以在 CoffeeScript 文件中调用 Sprockets`require`指令来要求来自另一个文件的代码。

```
#= require path/to/other/file 
```

否则，您也可以配置 Sprockets 以使用 bare 选项编译 CoffeeScript，但不建议这样做。

有关详细信息，请参阅“[如何在 Rails 3.1 中为 CoffeeScript 使用选项“--bare”？](https://stackoverflow.com/questions/6099342/how-can-i-use-option-bare-in-rails-3-1-for-coffeescript) ”。

# sql-server - 创建时 TSQL 触发器

> ID：10789582
> 
> 赞同：0
> 
> 时间：2012-05-28T19:30:03.307
> 
> 标签：sql-server, tsql, triggers, count

我需要一些帮助来创建触发器来执行以下操作。

**表**

1.  用户组
2.  用户

每次我创建一个新的用户记录时，我都会填充一个名为 UserGroupId 的外键字段，它将用户链接到用户组。我想要实现的是在 UserGroup 表上更新一个名为 TotalUsers 的 Count 字段。

请任何帮助都会很棒，因为我是 TSQL 触发器的新手。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T13:22:00.793

我同意 marc_s 的观点，这种信息可能更好地仅在必要时获取，而不是将其存储在表中的单独字段中。但这是一个应该做你想做的事的触发器：

```
create trigger UpdateUserCount on [User]
for insert, update, delete
as
begin
    update UserGroup set TotalUsers = sub.UserCount
    from (
        select UserGroupId, COUNT(*) as UserCount
        from [User]
        where UserGroupId in (
            select UserGroupId from inserted
            union
            select UserGroupId from deleted
        )
        group by UserGroupId
    ) as sub
    where UserGroup.UserGroupId = sub.UserGroupId
end 
```

当您删除用户或更新用户组时，此触发器也会更新计数。我假设 UserGroup 表中的主键列称为 UserGroupId。

# php - 跨域 IE 问题发送表单数据

> ID：10789583
> 
> 赞同：1
> 
> 时间：2012-05-28T19:30:08.757
> 
> 标签：php, forms, internet-explorer

我有一个 PHP 应用程序，可以很好地使用他自己的登录表单。但我想允许用户使用另一个域中的另一个表单从一个网站进行身份验证。形式和原来的一样，相同的字段，相同的名称。

问题是它适用于 Chrome 和 Firefox，但不适用于 IE。

当我提交表单时，我没有得到关于`$_POST`var 的数据。我用`var_dump`or显示它，`print_r`两者都显示一个空数组。

我已经禁用`XSS filter`了 IE 安全选项，但没有。

有什么建议么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T00:56:16.623

您是否考虑过在站点之间实施基于 OpenID 的身份验证，而不是重新发明轮子？出于安全原因，某些浏览器会阻止一个站点向另一个站点提交 POST 表单（信不信由你，IE 实际上在这里做得很好）；我不建议尝试解决这个问题，尤其是因为未来主流浏览器的浏览器版本越来越有可能阻止这种情况的发生，以防止表单劫持、网络钓鱼和其他可能损害最终结果的恶意行为用户。

# jquery - jquery文档方向

> ID：10789589
> 
> 赞同：1
> 
> 时间：2012-05-28T19:30:39.957
> 
> 标签：jquery, css

我在头部有块，其中包含以下内容：

```
*, body { direction:rtl; } 
```

我注意到 jQuery 的 dir 变量设置为 ltr：

```
$(function(){
   alert(this.dir); }); 
```

有没有办法检索具体的页面方向？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:33:11.147

```
$('body').css('direction') 
```

阅读更多关于[jQuery CSS](http://api.jquery.com/css/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:34:09.783

在您的 CSS 中，您正在使用，`direction`但在 jQuery 代码中，您通过`dir`. 您也需要`dir`在 CSS 中使用以获得正确的值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T19:32:56.460

尝试：

```
alert($('body').attr('dir')); 
```

祝你好运！

# .htaccess - .htaccess 重定向到 HTTPS，子域除外

> ID：10789598
> 
> 赞同：12
> 
> 时间：2012-05-28T19:31:29.440
> 
> 标签：.htaccess

我想将所有非 https 请求重定向到 https，但子域的请求除外。例如

```
http://example.com/  =>  https://example.com/
http://example.com/page  =>  https://example.com/page 
```

但

```
http://m.example.com/  REMAINS  http://m.example.com/ 
```

这就是我在 .htaccess 中的内容，它重定向所有请求（包括子域）：

```
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

我知道我必须在 RewriteRule 之前添加一个条件，但我不太确定语法。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-28T19:36:20.607

`RewriteCond`在你之前添加另一个`RewriteRule`：

```
RewriteCond %{HTTP_HOST} !=m.example.com 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-21T09:52:08.713

要从 https 重写中排除任何子域，请添加

```
RewriteCond %{HTTP_HOST} !=/(.*?)/.example.com 
```

# c++ - 如何在另一个对话框进程中将对话框 exe 作为子窗口加载

> ID：10789599
> 
> 赞同：0
> 
> 时间：2012-05-28T19:31:30.050
> 
> 标签：c++, winapi, mfc, win32gui

我有两个独立的应用程序**A.exe**和**B.exe**，这导致两个独立的顶级窗口。两者都是 C++ 应用程序，并在 windows 平台上使用 win32 gui 框架。我想将这些组合到一个新的应用程序**C.exe**中，以便它在多选项卡对话框中的单独选项卡中显示这两个。

Baiscaly 如何将**C.exe**`Dlg1`中的 Dialog 设置为 A.exe（顶级窗口）的父窗口，或者以其他方式如何将 A.exe（顶级窗口）加载为**C.exe**中的子窗口**`Dlg1`**

 ****有没有使用win32或MFC的解决方案？还是不可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:36:59.750

如果 C.exe 生成 A.exe 和 B.exe，它可以将自己的`HWND`作为命令行参数传递，然后 A.exe 和 B.exe 可以检索该参数并将其`HWND`用作调用`CreateWindow/Ex()`或`SetParent()`在需要时的父窗口. 否则，C.exe 将不得不使用`FindWindow/Ex()`or`EnumWindows()`手动查找`HWND`A.exe 和 B.exe 的句柄，然后调用`SetParent()`它们。****

# android - Listview 之外的 Android 应用程序按钮

> ID：10789600
> 
> 赞同：0
> 
> 时间：2012-05-28T19:31:31.893
> 
> 标签：android, android-listview

我有一个通过调用新活动来实现的列表视图。布局如下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_centerHorizontal="true"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/listWrap"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/testbutton"
    android:layout_alignParentTop="true"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/item_title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:padding="2dp"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textSize="20dp" >
    </TextView>

    <ListView
        android:id="@id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:drawSelectorOnTop="false" >
    </ListView>

    <TextView
        android:id="@+id/item_subtitle"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:padding="2dp"
        android:textSize="13dp" >
    </TextView>
</LinearLayout>

<Button
    android:id="@+id/testbutton"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:text="@string/hello" /></RelativeLayout> 
```

当活动加载时，按钮位于底部，但一旦加载列表而不是列表字段，按钮就会出现在每个列表项中。我怎样才能让这个按钮留在底部并在上面有一个列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-10T12:36:46.680

您可以根据图形布局中的视图更改列表视图集的高度：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
<ListView
android:layout_width="match_parent"
android:layout_height="250dp"
android:id="@+id/lv1"
android:background="#000"
android:scrollingCache="false"/>
<Button
 android:layout_width="match_parent"
 android:layout_height="wrap_content"
 android:text="OK"
 android:id="@+id/btnok"
 /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T05:25:16.343

将 Button 保持在单独的布局中并检查一次

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-28T19:40:59.293

从来没有尝试过（我觉得它看起来不太好），但如果我是你，我会尝试添加权重或给按钮一个 minHeight 。

# ocaml - 在 OCaml 中睡不到一秒

> ID：10789601
> 
> 赞同：14
> 
> 时间：2012-05-28T19:31:52.403
> 
> 标签：ocaml, delay, sleep, wait, thread-sleep

该`Unix.sleep`函数可以暂停程序整秒，但你怎么能暂停它不到一秒呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-28T19:39:17.140

经典的 Unix 解决方案是使用不带文件描述符的 select()：

```
let minisleep (sec: float) =
    ignore (Unix.select [] [] [] sec) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-28T19:31:52.873

该`Thread.delay`函数将线程暂停给定的秒数，但它需要一个浮点数，允许您暂停线程不到一秒。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-06-18T03:47:48.810

来自[Unix](http://caml.inria.fr/pub/docs/manual-ocaml/libref/Unix.html)模块

```
val sleepf : float -> unit 
```

> 在给定的秒数内停止执行。与睡眠类似，但支持几分之一秒。

# c++ - C++字符串拆分分段错误

> ID：10789603
> 
> 赞同：3
> 
> 时间：2012-05-28T19:32:07.633
> 
> 标签：c++, string, split, end-of-line

我正在将一个字符串拆分为一个字符串向量

```
 vector<string> tokens;

    stringstream strstm(str);
    string item;
    while (getline(strstm, item, ' ')) {
        tokens.push_back(item);
    }

    token_idx = 0;

    cout << "size = " << tokens.size() << endl;

    for (unsigned int i = 0; i < tokens.size(); i++)
    {
        cout << tokens[i] << "[" << i << "]" << endl;
    } 
```

拆分成功，size() 及其元素就是我喜欢的样子。然而，当我试图获得它的价值时，最后一个令牌似乎表现得很奇怪。

```
string Lexer::consume() {
    if (hasValue()) {
        token_idx++;
        cout << "consumed " << tokens[token_idx-1] << " tokens = " << token_idx -1 << endl;
        return tokens[token_idx-1];
    }
    cout << "didn't consume, token_idx = " << token_idx << endl;
    return "null";
} 
```

hasVal 是这样的

```
bool Lexer::hasValue() {
    if ( token_idx < tokens.size()) {
        return true;
    } else {
        return false;
    }
} 
```

如果我有一个像这样的输入字符串`1 + 2 * 3`，我的程序的预期输出应该是`(+1(*23))`，但是我得到一个分段错误。

```
size = 5
1[0]
+[1]
2[2]
*[3]
3[4]
consumed 1 tokens = 0
consumed + tokens = 1
consumed 2 tokens = 2
consumed * tokens = 3
consumed 3 tokens = 4
Segmentation fault (core dumped) 
```

但是如果我将 has value check 更改为`( token_idx < tokens.size() -1 )`，程序将返回`(+1 (*2 null))`

```
size = 5
1[0]
+[1]
2[2]
*[3]
3[4]
consumed 1 tokens = 0
consumed + tokens = 1
consumed 2 tokens = 2
consumed * tokens = 3
didn't consume, token_idx = 4
(+1 (*2 null)) 
```

所以我想知道在分割我所做的方式时是否在 3 之后有行尾，或者是否有其他因素导致这种行为？我很确定我不会超出向量的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T06:24:23.753

我认为生成错误的真正有罪的代码没有显示给她，但因为我能感觉到你操纵索引的方式......没有什么神秘的，你在访问令牌列表的末尾时出错了，此外还有一个容易出错的设计，仅此而已。

```
if (hasValue()) { // has value is useless to me
    token_idx++;  // why incrementing this here ?

    cout << "consumed " << tokens[token_idx-1] << " tokens = " << token_idx -1 << endl;

    return tokens[token_idx-1];
} 
```

将其更改为：

```
if ( token_idx < tokens.size() ) { 
    cout << "consumed " << tokens[token_idx] << " tokens = " << token_idx << endl;

    return tokens [ token_idx++ ];
} 
```

另请阅读[递归下降解析](http://en.wikipedia.org/wiki/Recursive_descent_parser)，它非常简单，您将对解析有更多的了解，避免常见的陷阱。

# actionscript-3 - 从函数中删除EventListener，不起作用，尝试了一切（我认为）

> ID：10789605
> 
> 赞同：1
> 
> 时间：2012-05-28T19:32:17.647
> 
> 标签：actionscript-3, flash, event-listener

我真的在这个小问题上尽了最大的努力，这是 2 周的漫长夜晚，我知道你们中的一个更有经验的 AS3 开发人员会在一两分钟内解决，我希望如此。

所以我有一个非常简单的游戏，你可以使用 MOUSEUP 放开可拖动的对象，然后播放动画然后点击主题并制作另一个动画（splat 或其他东西）。仅在影片剪辑内部的一帧上使用 hitTest。（这很好用）

我在删除所说的 eventListener 时遇到问题，我尝试在动画结束时删除它，所以在动画的最后一个从舞台上会有 AS 说 removeEventListener ，但这不起作用，所以我在动态添加后尝试了 removeEventListener动画到了舞台，依旧没有欢乐。

我希望这很简单，比如 this.removeEventListener 或 currentTarget，但可惜没有。

实在想不出别的了

为了爱，请帮助。一个解释也将是惊人的，我理解人们是如何没有时间的，所以任何输入都将不胜感激。

下面是我的AS，如果有人想看FLA，我可以发上来，我很乐意分享。

注意它可能很明显我是一个新手，所以请在我的路上帮助我....

```
import flash.display.MovieClip;

import flash.events.*;

var test:dart = new dart();
addChild(test);
circle.addEventListener(MouseEvent.MOUSE_DOWN, fl_ClickToDrag);

function fl_ClickToDrag(event:MouseEvent):void
{
    circle.startDrag();
}

stage.addEventListener(MouseEvent.MOUSE_UP, fl_ReleaseToDrop);

function fl_ReleaseToDrop(event:MouseEvent):void
{
    circle.stopDrag();
    addEventListener(Event.ENTER_FRAME, checkIfHitTest);
    function checkIfHitTest(Event)
    {

        if (circle.hitTestObject(square))
        {
            trace("true, the circle and square are colliding");
            var s:blood_splat = new blood_splat();
            addChild(s);
            s.x = mouseX;
            s.y = mouseY;
            **removeEventListener(Event.ENTER_FRAME,checkIfHitTest);**

        }
        else
        {
            trace("false, the circle and square are not colliding");
            var s:blood_splat = new blood_splat();
            addChild(s);
            s.x = mouseX;
            s.y = mouseY;
            s.alpha = 0.1;
            **removeEventListener(Event.ENTER_FRAME,checkIfHitTest);**
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:39:11.683

做就是了：

```
Event.currentTarget.removeEventListener(Event.type, checkIfHitTest) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:41:57.083

尝试在 fl_ReleaseToDrop 之外定义 checkIfHitTest。从理论上讲，您所做的应该可以工作，因为您的 removeEventListener 代码也在 fl_ReleaseToDrop 的闭包中运行，但它的定义可能被忽略，因为您不应该在类似的其他函数中定义命名函数。

另一个可能的问题是您为 checkIfHitTest 提供的参数与 Class、Event 具有相同的名称，因此您的定义存在冲突——您的事件实例没有常量 ENTER_FRAME。

老实说，即使您显然关闭了严格模式，或者您会看到大量编译错误，我也无法想象您没有遇到运行时错误。有没有安装调试播放器？你真的应该重新打开严格的打字——它会给你反馈，至少开始你自己解决很多这些问题。

# mono - ASP.NET 到 Mono - 获取 HTTP 500。处理请求时出错。System.ArgumentNullException：参数不能为空

> ID：10789607
> 
> 赞同：1
> 
> 时间：2012-05-28T19:32:30.227
> 
> 标签：mono

我正在开发我的第一个 ASP.NET 到 Mono 端口。我建立了一个具有多种功能的测试站点进行测试。一个只是一个简单的表单帖子。我得到的错误是：

参数不能为空。参数名称：输入字符串

说明：HTTP 500。处理请求时出错。

堆栈跟踪：

System.ArgumentNullException：参数不能为空。参数名称： System.Web.UI.ObjectStateFormatter.Deserialize (System.String inputString) [0x00000] in System.Web.UI.LosFormatter.Deserialize (System.String input) [0x00000] in :0 的 inputString

我尝试通过注释掉所有处理会话变量或表单输入（Request.Form）的代码来进行调试，但仍然出现错误。我现在甚至将页面加载中的所有代码都注释掉了，但仍然没有骰子。此表单在 IIS 上作为 ASP.NET 工作正常。也许有我没有做的配置？

** 编辑 ** 我能够将问题定位到我用来从 System.Web.UI.Page 继承的自定义 Page 类，我已经覆盖了一些基本方法。当我切换回 System.Web.UI.Page 时，错误消失了。我确实需要我的自定义 Page 类。当我进行表单发布/回发时发生错误；初始加载工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T22:54:02.533

*** 问题已解决 ***它在 LosFormatter.Deserialize 方法中。我让它检查传递的字符串是否为空，然后将其修改为使用 string.IsNullOrEmpty。也许它也不喜欢空字符串。

# c++ - 常量 char 继续转换为 int

> ID：10789612
> 
> 赞同：1
> 
> 时间：2012-05-28T19:32:59.737
> 
> 标签：c++, c++builder

Stackoverflow 用户！
我正在使用 Borland C++ Builder 6 来创建我的程序。是的，我知道它在过去两百万年里已经过时了，但是，我**必须**使用这个 IDE。我有一个需要拆分的字符串。所以我使用以下方法：

```
void Orders::split(TStringList* lout, char* str, const char* separator) {
  for(char* tok = strtok(str, separator); tok!=NULL; tok = strtok(NULL, separator))
      lout->Add(tok);
} 
```

另外，我有一个分隔符定义为预处理器常量：

```
#define SEPARATOR ':' 
```

然后我调用 split 方法

```
split(ords, input.c_str(), SEPARATOR); 
```

我收到以下错误：

> [C++ 错误] File3.cpp(47): E2034 无法将 'int' 转换为 'const char *'

就行了，我在这里调用 split 方法。转换为 const char* 会导致相同的结果。IDE 中是否存在错误，或者我太笨而无法在代码中看到自己的错误？
提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T19:38:36.020

`strtok`正在寻找一个`const char*`作为分隔符。尝试像这样定义它：

```
#define SEPARATOR ":" 
```

这是因为您可以指定一组分隔符，以便在找到*任何*这些字符时`strtok`停止。

# java - Java - 将 int 转换为字节数组而不考虑符号

> ID：10789618
> 
> 赞同：0
> 
> 时间：2012-05-28T19:33:42.503
> 
> 标签：java, bytearray

要将 int 转换为字节数组，我使用以下代码：

```
int a = 128;
byte[] b = convertIntValueToByteArray(a);
private static byte[] convertIntValueToByteArray(int intValue){
  BigInteger bigInteger = BigInteger.valueOf(intValue);
  byte[] origByteArray = bigInteger.toByteArray();
  byte[] noSignByteArray = new byte[bigInteger.bitLength()/8];

  if(bigInteger.bitLength()%8!=0){
    noSignByteArray = origByteArray;
  }else{
    System.arraycopy(origByteArray,1,noSignByteArray,0,noSignByteArray.length);
  }

  return noSignByteArray;
} 
```

我正在尝试做两件事。

1）我需要知道原始整数的字节数（四舍五入到结束字节）。但是，当我调用 toByteArray() 方法时，我不需要为符号位添加的额外位。这就是我有辅助方法的原因。所以在这个例子中，如果我没有辅助方法，当我将 128 转换为字节数组时，由于符号位，我得到的长度为 2 个八位字节，但我只希望它是一个八位字节。

2）我需要数字的积极表示。在这个例子中，如果我尝试打印数组 b 中的第一个元素，我得到 -128。但是，我将使用的数字只是正数，所以我真正想要的是 128。我仅限于使用字节数组。有没有办法做到这一点？

**更新帖子**

感谢您的回复。我还没有找到我正在寻找的确切答案，所以我会尝试提供更多细节。最终，我想在数据输出流上写入不同类型的值。在这篇文章中，我想澄清将整数写入数据输出流时会发生什么。我遇到过两种情况。

1)

```
DataOutputStream os = new DataOutputStream(this.socket.getOutputStream());

byte[] b = BigInteger.valueOf(128).toByteArray();

os.write(b); 
```

2)

```
DataOutputStream os = new DataOutputStream(this.socket.getOutputStream());
os.write(128); 
```

在第一种情况下，当从数据输入流中读取字节时，字节数组中的第一个元素似乎是表示 msb 的 0，而数组中的第二个元素包含数字 -128。但是，由于 msb 为 0，我们可以确定它是正数。在第二种情况下，没有 msb 并且从输入流读取的字节数组中存在的唯一元素是 -128。我期待数据输出流的 write() 方法以与 BigInteger 对象上的 toByteArray() 方法相同的方式将 int 转换为字节数组。但是，情况似乎并非如此，因为 msb 不存在。所以我的问题是，在第二种情况下，如果没有 msb，我们应该如何知道 128 应该是一个正数而不是负数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:56:55.420

你可能已经知道

*   在一个八位字节中，模式`10000000`可以解释为 128 或 -128，具体取决于，嗯，外部解释
*   Java 的`byte`类型仅将八位字节解释为 -128...127 中的值。

*如果*您正在构建一个整个世界仅由非负整数组成的应用程序，那么您可以简单地完成所有工作，假设字节值 -128 将意味着 128 并且 -127 将意味着 129 并且......并且 - 1 表示 255。这当然是可行的，但需要工作。

处理像这样的“无符号字节”的概念通常是通过将字节扩展为 a`short`或`int`将高阶位全部设置为零然后执行算术或显示您的值来完成的。您需要确定这种方法是否更符合您的喜好，而不仅仅是将 128 表示为数组中的两个八位字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:31:41.207

我认为以下代码可能就足够了。

在 java中**int**是一个二进制补码：

```
-1              = 111...111
ones complement = 000...000; + 1 =
1               = 000...001 
```

所以关于符号位我不明白。就这样，你能做到`Math.abs(n)`。一个**字节**的范围从 -128 到 127，但解释是一个掩码问题，如下所示。

```
public static void main(String[] args) {
    int n = 128;

    byte[] bytes = intToFlexBytes(n);
    for (byte b: bytes)
        System.out.println("byte " + (((int)b) & 0xFF));
}

public static byte[] intToFlexBytes(int n) {
    // Convert int to byte[4], via a ByteBuffer:
    byte[] bytes = new byte[4];
    ByteBuffer bb = ByteBuffer.allocateDirect(4);
    bb.asIntBuffer().put(n);
    bb.position(0);
    bb.get(bytes);

    // Leading bytes with 0:
    int i = 0;
    while (i < 4 && bytes[i] == 0)
        ++i;

    // Shorten bytes array if needed:
    if (i != 0) {
        byte[] shortenedBytes = new byte[4 - i];
        for (int j = i; j < 4; ++j) {
            shortenedBytes[j - i] = bytes[j]; // System.arrayCopy not needed.
        }
        bytes = shortenedBytes;
    }
    return bytes;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:55:00.930

要回答您的第一个问题（使用无符号表示法表示非负整数需要多少字节），请考虑我在 Common Lisp 中编写的以下函数。

```
(defconstant +bits-per-byte+ 8)

(defun bit-length (n)
  (check-type n (integer 0) "a nonnegative integer")
  (if (zerop n)
      1
      (1+ (floor (log n 2)))))

(defun bytes-for-bits (n)
  (check-type n (integer 1) "a positive integer")
  (values (ceiling n +bits-per-byte+))) 
```

这些突出了问题的数学基础：即，对[*数*](http://www.lispworks.com/documentation/HyperSpec/Body/f_log.htm)告诉您支配给定的非负整数需要多少 2 的幂（由位提供），调整为具有 的阶跃函数[`floor`](http://www.lispworks.com/documentation/HyperSpec/Body/f_floorc.htm)，以及它需要的字节数再次保持该位数作为阶跃函数，这次用 调整[`ceiling`](http://www.lispworks.com/documentation/HyperSpec/Body/f_floorc.htm)。

请注意，数字零作为对数函数的输入是不能容忍的，因此我们明确避免使用它。您可能会观察到，该`bit-length`函数也可以通过对核心表达式进行轻微转换来编写：

```
(defun bit-length-alt (n)
  (check-type n (integer 0) "a nonnegative integer")
  (values (ceiling (log (1+ n) 2)))) 
```

不幸的是，由于*1*的对数始终*为零*，无论底数如何，这个版本说整数零可以用零位表示，这不是我们想要的答案。

对于您的第二个目标，您可以使用我上面定义的函数来分配所需的字节数，并逐步设置您需要的位，忽略符号。很难判断您是否无法在字节向量中设置正确的位，或者您的问题是否在于以避免将高位视为符号位的方式*解释*位（即*二进制补码表示*）。请详细说明您需要什么样的推动才能让您再次移动。

# arrays - knockout.js 和对象上的排序数组

> ID：10789619
> 
> 赞同：1
> 
> 时间：2012-05-28T19:33:44.793
> 
> 标签：arrays, knockout.js

我可以对一个接受数组对象并对其进行排序的函数进行 foreach 吗？我知道我可以做一个依赖的 observable，但我有一个来自映射插件的数组数组。

```
foreach: sortList($array) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T00:12:13.820

是的......这是一个演示的小提琴：

[http://jsfiddle.net/jearles/sHQvV/](http://jsfiddle.net/jearles/sHQvV/)

它显示了 foreach 的三种用法：

1) 普通 2) 函数返回数组 3) 具有包含数组的数据属性的对象

[foreach 文档](http://knockoutjs.com/documentation/foreach-binding.html)对此进行了描述。

# c# - 如何在 WPF 中使用工厂模式

> ID：10789620
> 
> 赞同：1
> 
> 时间：2012-05-28T19:33:46.077
> 
> 标签：c#, wpf, factory-pattern

我被困在一个可以有很多游戏屏幕的场景中，我希望能够使用单选按钮或组合框来选择游戏屏幕。但问题是最好的实现方式是什么？

我应该将复选框或组合框选择的字符串传递给工厂，还是应该使用枚举？如果枚举是要走的路，我该如何使用它？一个简单的例子会很好谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:41:31.413

在这种情况下，我喜欢使用 Enums 而不是魔法字符串，因为它可以防止由拼写错误引起的问题，并使这些选项可用于智能感知。

```
namespace TheGame 
{
    // declare enum with all available themes
    public enum EnumGameTheme { theme1, theme2 };

    // factory class
    public class ThemeFactory 
    {
        // factory method.  should create a theme object with the type of the enum value themeToCreate
        public static GameTheme GetTheme(EnumGameTheme themeToCreate) 
        {
            throw new NotImplementedException();
            // TODO return theme
        }
    }

    // TODO game theme class
    public class GameTheme { }
} 
```

*给定在（比如说） lstThemes*中选择的主题调用工厂的代码：

```
// get the enum type from a string (selected item in the combo box)
TheGame.EnumGameTheme selectedTheme = Enum.Parse(typeof(TheGame.EnumGameTheme), (string)lstThemes.SelectedValue);
// invoke the factory method
TheGame.GameTheme newTheme = TheGame.ThemeFactory.GetTheme(selectedTheme); 
```

将可用主题作为字符串获取的代码：

```
// get a string array of all the game themes in the Enum (use this to populate the drop-down list)
string[] themeNames = Enum.GetNames(typeof(TheGame.EnumGameTheme)); 
```

# visual-c++ - Visual C++ 奇怪的选项在代码视图中显示奇怪的东西

> ID：10789625
> 
> 赞同：0
> 
> 时间：2012-05-28T19:34:22.640
> 
> 标签：visual-c++

[http://i.imgur.com/Yteu9.png](http://i.imgur.com/Yteu9.png) 当我想 /* 和 */ 我的代码时，我不小心按了一些键，这些东西出现了（箭头，小“-”）知道如何摆脱那个废话?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:35:55.713

您只是显示空白字符。切换`Ctrl-R Ctrl-W`。

# javascript - 谷歌地图搜索地标问题

> ID：10789629
> 
> 赞同：0
> 
> 时间：2012-05-28T19:34:40.363
> 
> 标签：javascript, html, google-maps, geocoding

我正在使用谷歌地图应用程序开发一个网页，但我遇到了一些麻烦。就目前而言，网页有一个功能地图（没有任何图层）和一个搜索栏。我是编程新手，所以希望有一个我缺少的快速修复。当我搜索地址时，地图上会放置一个地标。但是，地图不会放大地标。如何为每个搜索到的地址放大地图？

```
 <script type="text/javascript">
    var geocoder;
    var map; 
  function initialize() {
    geocoder = new google.maps.Geocoder ();
    var latlng = new google.maps.LatLng (55.1667, -114.4000);
    var myOptions = {
      zoom: 5,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
     map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
        }
    function codeAddress () {
        var address = document.getElementById ("address").value;
        geocoder.geocode ( { 'address': address}, function(results, status)  {
        if (status == google.maps.GeocoderStatus.OK)  {
            map.setCenter(results [0].geometry.location);
            var marker = new google.maps.Marker({
                map: map, 
                position: results [0].geometry.location
            });
            } 
        else {
            alert("Geocode was not successful for the following reason: " + status);
                }
    }); 
                            }
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:39:57.377

我会调用两个函数：

(1) 将地图置于标记的中心

要么您已经拥有 LatLng，要么通过`marker.getPosition()`调用`map.setCenter(myLatLng)`.

(2) 设置地图的缩放

`map.setZoom(zoomLevel)`, could be fixed around 12 to 16, or variable depending what kind of marker it is (street address or city overview?) This information can be stored in the marker variable, `marker.zoomLevel`.

```
function codeAddress () { 
  var address = document.getElementById ("address").value;
  geocoder.geocode ( {'address': address}, function(results, status) { 
    if (status == google.maps.GeocoderStatus.OK) { 
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({ map: map, 
        position: results[0].geometry.location });
      map.setZoom(16);
    } 
    else { 
      alert("Geocode was not successful for the following reason: " + status);
    }
  });
} 
```

# c++ - 如何使用 boost::iostreams::file_descriptor_source 读取文件？

> ID：10789631
> 
> 赞同：2
> 
> 时间：2012-05-28T19:35:15.853
> 
> 标签：c++, boost, boost-iostreams

我需要在我的应用程序中使用 boost::iostreams::file_descriptor::handle_type。我尝试使用以下代码读取文件，但它一直在 while 循环中循环（in.readsome() 返回 0 ）。

`using namespace boost::iostreams;`

 ````
file_descriptor_source source( "data.bin", never_close_handle);
stream_buffer<file_descriptor_source> stream(source);
std::istream in(&stream);

char buffer[1025];
memset(buffer, 0, sizeof(buffer));

while ( !in.eof() )
{
    streamsize read = in.readsome(&buffer[0], sizeof(buffer) - 1);
} 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:48:31.093

到达文件末尾并不是您应该检查的唯一条件，因为可能还有其他情况您也必须处理。例如，您可以：

*   检查是否发生了不可恢复的错误`bad()`。
*   检查关联的流上是否发生了错误`fail()`。

最好检查流本身的健康状况，如下所示：

```
while (in) {
    streamsize read = in.readsome(buffer, sizeof(buffer) - 1);
    if (read > 0) {
        ...
    }
} 
```

退出循环后，您可以使用 、 等检查退出的`eof()`原因`fail()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T22:34:29.910

以下语句不会从流中读取任何内容。

``streamsize read = in.readsome(&buffer[0], sizeof(buffer) - 1);``

并且总是返回 0，这就是它永远循环的原因。

“in”对象的初始化有问题。我不知道出了什么问题。`

# java - 有史以来第一个 Java 应用程序；不能在数据库中查询？

> ID：10789632
> 
> 赞同：0
> 
> 时间：2012-05-28T19:35:16.213
> 
> 标签：java, mysql

我用 Java 创建了我的第一个应用程序（但已经用 C# 和 Python 编程）并且遇到了一个我什至无法理解的问题，因为调试器消息对用户非常不友好。;-)

调试器输出如下所示：

> 调试：在 Kwestionariusz.MainWindow.access$100(MainWindow.java:14) 在 Kwestionariusz.MainWindow.jButton1ActionPerformed(MainWindow.java:176) 在 Kwestionariusz.MainWindow$2 的线程“AWT-EventQueue-0”java.lang.NullPointerException 中的异常。 actionPerformed(MainWindow.java:72) at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018) at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341) at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel .java:402) 在 javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259) 在 javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252) 在 java.awt.Component.processMouseEvent(Component. java:6505) 在 javax.swing.JComponent。processMouseEvent(JComponent.java:3321) 在 java.awt.Component.processEvent(Component.java:6270) 在 java.awt.Container.processEvent(Container.java:2229) 在 java.awt.Component.dispatchEventImpl(Component.java :4861) 在 java.awt.Container.dispatchEventImpl(Container.java:2287) 在 java.awt.Component.dispatchEvent(Component.java:4687) 在 java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832) 在 java .awt.LightweightDispatcher.processMouseEvent(Container.java:4492) 在 java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422) 在 java.awt.Container.dispatchEventImpl(Container.java:2273) 在 java.awt.Window。 dispatchEventImpl(Window.java:2719) 在 java.awt.Component.dispatchEvent(Component.java:4687) 在 java.awt.EventQueue.dispatchEventImpl(EventQueue.java:703) 在 java.awt。位于 java.awt.EventQueue$3.run(EventQueue.java:662) 的 EventQueue.access$000(EventQueue.java:102) 位于 java.security.AccessController 的 java.awt.EventQueue$3.run(EventQueue.java:660)。 doPrivileged(Native Method) at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76) at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87) at java.awt.EventQueue$4.run(EventQueue.java :676) 在 java.awt.EventQueue$4.run(EventQueue.java:674) 在 java.security.AccessController.doPrivileged(Native Method) 在 java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76) 在 java. awt.EventQueue.dispatchEvent(EventQueue.java:673) 在 java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244) 在 java.awt.EventDispatchThread。pumpEventsForFilter(EventDispatchThread.java:163) at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151) at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147) at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java :139) 在 java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 构建成功（总时间：16 秒）

可能与此操作有关：

```
if (("".equals(login) ) || ("".equals(password)) || ("".equals(accountType)))
        {}
        else
        {
            Users user;
            user = (Users) db.createNamedQuery("Users.findByLoginAndType")
            .setParameter("login", login)
            .setParameter("company", accountBool)
            .getSingleResult();
            if (password.equals(user.getPassword()))
            {
                JFrame appWindow;
                appWindow = new AppWindow();
                this.setVisible(false);
                appWindow.setVisible(true);       
            }
        } 
```

在哪里：

```
@NamedQuery(name = "Users.findByLoginAndType", query = "SELECT u FROM Users u WHERE u.login = :login AND u.company = :companyBool LIMIT 1") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:39:07.587

这是发生的地方：

```
Kwestionariusz.MainWindow.jButton1ActionPerformed(MainWindow.java:176) at 
```

MainWindow.java 中的第 176 行。打开文本编辑器，打开行号显示，然后转到该行。查看您在该行上使用的所有对象引用 - 其中一个为空。你需要弄清楚为什么你没有初始化它以指向有用的东西。

就个人而言，我认为这样的代码是一个巨大的错误：

```
if (("".equals(login) ) || ("".equals(password)) || ("".equals(accountType)))
        {} 
```

报告这三个中的哪一个是空白的没有任何价值吗？如果一个为空会发生什么？如果它有一个只有空格的字符串怎么办？

我认为您正在尝试在这里与用户表达您的合同，但是没有使用正确的习语来完成。在检查每个之后抛出`IllegalArgumentException`一个将是我这样做的方式。这是一个未经检查的异常，因此调用者将被迫处理它。

# ios - backgroundView 的慢速模式绘制

> ID：10789636
> 
> 赞同：1
> 
> 时间：2012-05-28T19:35:41.583
> 
> 标签：ios, uitableview, background, quartz-2d

对于我的 tableview，我已经完成了一个自定义背景视图，我在我的项目的每个 tableView 上调用 viewDidLoad：

```
- (void)viewDidLoad{
    [super viewDidLoad];
    //other unrelated sutff
    self.tableView.backgroundView=[[BlueStyleBackground alloc]init];
} 
```

我的理解是，做石英 2D 的东西是性能方面的最佳选择。然而，这个背景视图需要 0.45 秒（平均）来绘制。这使得 tableViews 之间的所有导航有点慢，不多但足以注意到它。

背景视图是具有重叠图案的渐变。我发现渐变在 0.12 秒内绘制，因此瓶颈似乎是图案绘制。令我惊讶的是，在我看来，画起来似乎并不复杂，它只是一条带有阴影的水平线。

以下是模式的调用方式（在 recDraw 中）：

```
static const CGPatternCallbacks callbacks = { 0, &MyDrawColoredPattern2, NULL };

CGContextSaveGState(context);
CGColorSpaceRef patternSpace = CGColorSpaceCreatePattern(NULL);
CGContextSetFillColorSpace(context, patternSpace);
CGColorSpaceRelease(patternSpace);

CGPatternRef pattern = CGPatternCreate(NULL,
                                         rect,//superficie que ha de cobrir CGRectMake(0, 0,self.bounds.size.width,8),
                                       CGAffineTransformIdentity,
                                       self.bounds.size.width,   // espai entre patrons (X)
                                       2,   // espai entre patrons (Y)
                                       kCGPatternTilingConstantSpacing,
                                       true,
                                       &callbacks); 
```

这是模式代码：

```
void MyDrawColoredPattern2 (void *info, CGContextRef context) {

    UIColor* __autoreleasing blauClar = [UIColor colorWithRed: 0.65 green: 0.65 blue: 0.65 alpha: 1];
    UIColor* __autoreleasing blauFosc = [UIColor colorWithRed: 0.106 green: 0.345 blue:0.486 alpha:1];     
    CGColorRef dotColor = blauFosc.CGColor;
    CGColorRef shadowColor = blauClar.CGColor;

    CGContextSetFillColorWithColor(context, dotColor);
    CGContextSetShadowWithColor(context, CGSizeMake(0, 1), 5, shadowColor);

    CGContextFillRect(context, CGRectMake(0, 0, 480, 1));
} 
```

以前我做了一个在 24+24 正方形内绘制两个六边形的图案。它看起来比上面的代码更复杂，但绘制只需要 0.15 秒。

我在这里做错了吗？我对石英绘图的了解并不是那么大，我将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:05:02.697

我讨厌回答自己，但经过一些试验和错误后，我发现将模式代码更改为以下内容，可以解决问题：

```
UIColor *__autoreleasing tileColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"pattern6-65.png"]];

CGColorRef tileCGColor = [tileColor CGColor];
CGColorSpaceRef colorSpace = CGColorGetColorSpace(tileCGColor);
CGContextSetFillColorSpace(context, colorSpace);

if (CGColorSpaceGetModel(colorSpace) == kCGColorSpaceModelPattern)
{
    CGFloat alpha = 1.0f;
    CGContextSetFillPattern(context, CGColorGetPattern(tileCGColor), &alpha);
}
else
{
    CGContextSetFillColor(context, CGColorGetComponents(tileCGColor));
}

CGContextFillRect(context, CGRectMake(0, 0, 10, 10)); 
```

它的作用是用一个非常小的 png 生成的图案填充屏幕。所以我不得不用photoshop绘制png，然后将它添加到项目中。png 越大越快，但在 Photoshop 中绘制越困难。

必须修改对模式的调用以适合 png 的大小（此处为 10 像素）：

```
CGPatternRef pattern = CGPatternCreate(NULL,
                                             rect,//superficie que ha de cobrir CGRectMake(0, 0,self.bounds.size.width,8),
                                           CGAffineTransformIdentity,
                                           10,   // espai entre patrons (X) self.bounds.size.width
                                           10,   // espai entre patrons (Y)
                                           kCGPatternTilingConstantSpacing,
                                           true,
                                           &callbacks); 
```

使用这个 10px png，整个绘制时间已经下降到 0.18 秒（渐变背景加图案）。

我希望它可以帮助有同样问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:45:31.623

如果我理解正确，您正在尝试在 tableView 背景上绘制渐变图案。

我建议您在任何图形编辑器中创建 .png 图像并将其放在背景上。

希望能帮助到你

# php - 存储图表数据的最有效方法

> ID：10789637
> 
> 赞同：3
> 
> 时间：2012-05-28T19:35:49.953
> 
> 标签：php, mysql, graph, data-storage

我总共提出了三种不同的、同样可行的方法来保存图表数据。

有问题的图表是“随着时间的推移，玩家在各个类别中的得分”。类别包括“建筑”、“物品”、“任务完成”、“成就”等。

## 方法一：

```
CREATE TABLE `graphdata` (
    `userid` INT UNSIGNED NOT NULL,
    `date` DATE NOT NULL,
    `category` ENUM('buildings','items',...) NOT NULL,
    `score` FLOAT UNSIGNED NOT NULL,
    PRIMARY KEY (`userid`, `date`, `category`),
    INDEX `userid` (`userid`),
    INDEX `date` (`date`)
) ENGINE=InnoDB 
```

此表包含每个用户/日期/类别组合的一行。要显示用户的数据，请选择`userid`。旧条目通过以下方式清除：

```
DELETE FROM `graphdata` WHERE `date` < DATE_ADD(NOW(),INTERVAL -1 WEEK) 
```

## 方法二：

```
CREATE TABLE `graphdata` (
    `userid` INT UNSIGNED NOT NULL,
    `buildings-1day` FLOAT UNSIGNED NOT NULL,
    `buildings-2day` FLOAT UNSIGNED NOT NULL,
    ... (and so on for each category up to `-7day`
    PRIMARY KEY (`userid`)
) 
```

由于是主键，因此按用户 ID 选择更快。每天的分数都会向下移动，如下所示：

```
... SET `buildings-3day`=`buildings-2day`, `buildings-2day`=`buildings-1day`... 
```

条目不会被删除（除非用户删除他们的帐户）。可以使用`INSERT...ON DUPLICATE KEY UPDATE`查询添加/更新行。

## 方法三：

为每个用户使用一个文件，其中包含一个 JSON 编码的分数数据数组。由于无论如何都是通过 AJAX JSON 调用获取数据，这意味着可以静态获取文件（甚至缓存到下一个午夜），而不会对服务器造成任何压力。服务器每天运行每个文件，`shift()`从每个阵列中`push()`找出最旧的分数，最后将新的分数排在最后。

* * *

就我个人而言，我认为方法 3 是迄今为止最好的，但是我听说过使用文件而不是数据库的坏事——例如，如果我希望能够根据用户在不同类别中的分数对他们进行排名，那么这个解决方案将非常糟糕。

在这两种数据库解决方案中，我已经在我的一个较旧的项目中实施了方法 2，这似乎效果很好。方法 1 似乎“更好”，因为它更好地利用了关系数据库和所有这些东西，但我有点担心它会包含`(number of users) * (number of categories) * 7`行，这可能会变成一个很大的数字。

我有什么遗漏可以帮助我最终决定使用哪种方法吗？1、2、3或以上都不是？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:12:38.113

如果你要使用关系数据库，方法一比方法二好很多。它是规范化的，所以很容易维护和搜索。我会将该`date`字段更改为 a`timestamp`并调用它`added_on`（或者不是像“日期”这样的保留字）。我会添加一个 auto_increment 主键`score_id`，这样 user_id/date/category 就不必是唯一的。这样，如果用户设法在同一秒内将他的建筑分数增加两次，仍然会记录两者。

第二种方法要求您每天更新所有记录。第一种方法只进行插入，不进行更新，因此每条记录只写入一次。

> ... 设置`buildings-3day`= `buildings-2day`, `buildings-2day`= `buildings-1day`...

您*真的*想每天更新表中的每条记录，直到时间结束？！

> 由于是主键，按用户 ID 选择更快

由于`user_id`是方法 1 主键中的第一个字段，因此查找速度同样快。作为常规索引中的第一个字段（这是我上面建议的），它仍然会非常快。

关系数据库的想法是每一行代表一个实例/动作/发生。所以当用户做某事影响他的分数时，做一个 INSERT 记录他做了什么。您始终可以从这样的数据中创建摘要。但是您无法从摘要中获得此类数据。

其次，您似乎不寻常地担心摆脱旧数据。为什么？您的选择查询将具有自动排除旧数据的日期范围。如果您担心性能，您可以 根据行龄对表进行[分区](http://dev.mysql.com/doc/refman/5.5/en/partitioning-types.html)，或者设置一个 cronjob 以定期删除旧记录。

## ETA：关于存储在文件中的 JSON

在我看来，这似乎将方法 2 的缺点（难以搜索，每个文件必须每天更新）与文件访问的其他缺点结合起来。文件访问是昂贵的。文件写入更是如此。如果您真的想存储汇总数据，我会仅在请求数据时运行查询，并将结果按 user_id 存储在汇总表中。该表可以保存一个 JSON 字符串：

```
CREATE TABLE score_summaries(
user_id INT unsigned NOT NULL PRIMARY KEY,
gen_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
json_data TEXT NOT NULL DEFAULT '{}'
); 
```

例如：

Bob (user_id=7) 首次登录游戏。他在显示他每周统计数据的个人资料页面上。这些查询运行：

```
SELECT json_data FROM score_summaries 
  WHERE user_id=7 
    AND gen_date > DATE_SUB(CURDATE() INTERVAL 1 DAY); 
//returns nothing so generate summary record

SELECT DATE(added_on), category, SUM(score) 
  FROM scores WHERE user_id=7 AND added_on < CURDATE() AND > DATE_SUB(CURDATE(), INTERVAL 1 WEEK)
  GROUP BY DATE(added_on), category; //never include today's data, encode as json with php

INSERT INTO score_summaries(user_id, json_data)
  VALUES(7, '$json') //from PHP, in this case $json == NULL
  ON DUPLICATE KEY UPDATE json_data=VALUES(json_data)

//use $json for presentation too 
```

今天的分数是根据需要生成的，而不是存储在摘要中。如果 Bob 今天再次查看他的分数，历史分数可以来自汇总表，也可以存储在第一次请求之后的会话中。如果 Bob 一周没有访问，则不需要生成摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:15:15.777

方法 1 对我来说似乎是一个明显的赢家。如果您担心单个表（graphData）的大小太大，您可以通过创建来减小它

```
CREATE TABLE `graphdata` (
    `graphDataId` INT UNSIGNED NOT NULL,
    `categoryId` INT NOT NULL,
    `score` FLOAT UNSIGNED NOT NULL,
    PRIMARY KEY (`GraphDataId'),
) ENGINE=InnoDB 
```

而不是创建 2 个表，因为您显然需要将 graphDataId 与 userId 连接起来的信息

```
create table 'graphDataUser'(
         `graphDataId` INT UNSIGNED NOT NULL,
        `userId` INT NOT NULL,
)ENGINE=InnoDB 
```

和 graphDataId 日期连接

```
create table 'graphDataDate'(
         `graphDataId` INT UNSIGNED NOT NULL,
        'graphDataDate' DATE NOT NULL
)ENGINE=InnoDB 
```

我认为你真的不需要担心某些表包含的行数，因为大多数 dba 在行数方面做得很好。您的工作只是将数据格式化为易于检索的方式，无论检索数据的任务是什么。我认为从长远来看，使用该建议应该会有所回报。

# html - UITableView 中的解析结果

> ID：10789638
> 
> 赞同：0
> 
> 时间：2012-05-28T19:35:50.580
> 
> 标签：html, ios, parsing, uitableview

我正在使用 Ben Reeves 的 HTMLParser。它工作得很好，但唯一的问题是我无法将输出放在 UITableView 中。谁能告诉我这段代码有什么问题？..................................................... ...................................

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Do any additional setup after loading the view, typically from a nib.

    NSError *error = nil;
    NSURL *url=[[NSURL alloc] initWithString:@"http://website.com/"];
    NSString *strin=[[NSString alloc] initWithContentsOfURL:url encoding:NSUTF8StringEncoding error:nil];

    HTMLParser *parser = [[HTMLParser alloc] initWithString:strin error:&error];

    if (error) {
        NSLog(@"Error: %@", error);
        return;
    }

    HTMLNode *bodyNode = [parser body];
    NSArray *divNodes = [bodyNode findChildTags:@"div"];

    for (HTMLNode *inputNode in divNodes) {
        if ([[inputNode getAttributeNamed:@"class"] isEqualToString:@"views-field-title"]) {
           NSLog(@"%@", [inputNode allContents]); 

           listData = [[NSArray alloc] initWithObjects:[inputNode allContents], nil];   
        }
    }      
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section 
{
    return [self.listData count]; 
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
    static NSString *SimpleTableIdentifier = @"SimpleTableIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier: SimpleTableIdentifier];

    if (cell == nil) 
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:SimpleTableIdentifier];
    }

    NSUInteger row = [indexPath row]; 
    cell.textLabel.text = [listData objectAtIndex:row];

    return cell; 
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:00:48.000

每次找到新元素时，您都会重新初始化数组。我觉得你需要搬家

`listData = [[NSArray alloc] initWithObjects:[inputNode allContents], nil];`

在您的循环之外并将其更改为

`listData = [[NSMutableArray alloc] init];`

`listData`应该是一个`NSMutableArray`，因此您可以向其中添加数据。您还需要在变量定义中更改它。

然后在你的循环中，使用`[listData addObject:[inputNode allContents]];`

# multithreading - 是否有取消另一个调度队列上的块的模式？

> ID：10789640
> 
> 赞同：1
> 
> 时间：2012-05-28T19:36:06.197
> 
> 标签：multithreading, cocoa, objective-c-blocks, blocking, grand-central-dispatch

关于如何最好地取消其他线程上的阻塞作业，这可能是一个更通用的问题，但我对 Grand Central Dispatch 上下文中的解决方案感兴趣。我需要调用一个基本上阻塞的函数，直到它从网络获取数据；它可能会被永远阻止。我现在已经设置好了，这个被阻塞的调用发生在一个私有调度队列上，当我得到数据时，我把一个块放回主队列。问题是，一旦我调度了我的私有队列块和阻塞调用，我永远无法真正取消它。想象一下，这种能力与用户设置切换相关联。如果他们关闭，我希望这个阻塞作业和执行块基本上刚刚结束。这类问题有好的解决方案吗？

谢谢

```
- (void)_beginListeningForNetworkJunk
{
    dispatch_async(my_private_queue, ^{
        // blocks until it gets data
        id data = [NetworkListener waitForData];
        dispatch_async(dispatch_get_main_queue(), ^{
            [self _handleNetworkData:data];
        });
    });
}

- (void)_endListeningForNetworkJunk
{
   // How do I kill that job that is blocked on my private queue?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:06:13.073

你不能。问题在于`NetworkListener`它的阻塞和不间断接口。

通常，您会编写代码块以异步服务网络连接，并监视其他一些信号机制，例如自定义运行循环源（`NSPort`或管道文件描述符或......）。当网络连接有活动时，就会得到服务。当信号机制触发时，您将关闭网络连接并退出该块。

通过这种方式，可以通过其合作取消该块。

由于您的块卡在 中`-waitForData`，因此无法合作。没有他们的合作，没有取消区块的机制。NSOperation 和 NSThread 也是如此。原因是没有它的合作，终止另一个线程的活动基本上是不可行的。

您的网络代码需要不同的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-26T18:48:22.913

原则上，您不能取消在任何其他线程上运行的任何内容。您只能礼貌地要求在另一个线程上运行的任务取消。我通常创建代表任务的对象，以便可以在这些对象上调用“取消”。

在您的情况下：无法取消 waitForData（除非 NetworkListener 有一些 API 可以执行此操作；在这种情况下，waitForData 需要某种机制来区分数据到达和取消）。

在 _endListenForNetworkJunk 中，可以设置一个 BOOL 值“cancelled”来表示呼叫被取消。然后在主队列上运行的代码中，检查“取消”值是否仍然被清除。这样，如果你从主线程调用 _endListenForNetworkJunk，你肯定不会调用 _handleNetworkData。如果您从另一个线程调用 _endListenForNetworkJunk，则主线程可能刚刚开始调用 _handleNetworkData。

如果您在分派到主队列之前选中“已取消”，则该块可能已经分派但在您在主线程上调用 _endListenForNetworkJunk 之前没有执行。

# c# - 使用 MSTest 测试私有字段

> ID：10789644
> 
> 赞同：7
> 
> 时间：2012-05-28T19:36:20.157
> 
> 标签：c#, mstest

是否可以在单元测试中访问私有字段？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T20:01:43.220

通常获取私有字段或方法的方法是使用反射。但是，单元测试框架包含一个帮助器类`PrivateObject`，以使这更容易。请参阅[文档](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject%28v=vs.100%29.aspx)。一般来说，当我使用它时，我最终制作了一个扩展方法，如下所示：

```
public static int GetPrivateField(this MyObject obj)
{
  PrivateObject po = new PrivateObject(obj);
  return (int)po.GetField("_privateIntField");
} 
```

但是，如果您需要在静态类中获取私有字段，则需要直接进行反射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-27T15:43:30.667

上面提供了很好的解决方案。为了完整起见，我已经使用这种技术一段时间了（使用 MSTest），但也将它扩展到属性值。

```
[ExcludeFromCodeCoverage]
public static class TestExtensionMethods
{
    public static T GetFieldValue<T>(this object sut, string name)
    {
        var field = sut
            .GetType()
            .GetField(name, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);

        return (T)field?.GetValue(sut);
    }

    public static T GetPropertyValue<T>(this object sut, string name)
    {
        var field = sut
            .GetType()
            .GetProperty(name, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);

        return (T)field?.GetValue(sut);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:39:47.317

不。如果您正在编写良好的单元测试，则不需要访问任何私有字段。单元测试应该测试当传入一组已知的值时，方法会以某种方式运行（通过返回适当的数据或以已知方式使用依赖项）。

如果您尝试测试后者，请使用依赖注入将依赖项注入您正在测试的类中。您将可以完全访问这些依赖项以进行测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T19:47:53.573

并不是说这是一个好主意，但我已经看到 InternalsVisibleTo 使用过。

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

看看这个问题。一个更不受欢迎的答案：

[单元测试和检查私有变量值](https://stackoverflow.com/questions/1093020/unit-testing-and-checking-private-variable-value)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-24T01:54:31.527

测试是为了发现缺陷，而TDD是为了尽早发现缺陷。您需要与代码中的圈复杂度一样多的测试条件。超过一定量的复杂度很难调试；这就是为什么我们将复杂的任务分解为不太复杂的功能。一些公共任务需要大量的整体复杂性，而将复杂性划分为更小的例程可以更好地管理这种复杂性。现在，当您可以为较低级别的函数编写更简单的测试时，为什么还要在较高级别的函数中遭受测试条件的组合爆炸？

您的方法是公共的还是私有的都没有关系。该方法的复杂性是其存在缺陷的可能性的最重要因素。如果您一次只需要测试一点复杂性，您将更快地发现和修复缺陷。

假设您已将复杂的任务 A 分解为不太复杂的任务 X、Y 和 Z。如果您仅在 A 处进行测试，您可能会发现自己需要 X * Y * Z 测试条件而不是 X + Y + Z 条件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-01T21:13:13.923

我知道这很旧，但想在测试私有方法时增加我的 2 美分。

我同意在大多数情况下测试面向公众的方法就足够了，但情况并非总是如此。

我能想到两个例子，能够测试私有方法会很棒并且产生更少的测试。

案例 1：报告：我有一个应用程序，它基于大量数据（接近 100 个数据点）生成报告。许多这些数据点依赖于一个或多个其他数据点。为了确保每个代码路径都经过测试，需要进行 1000 次测试。

案例 2：逻辑复杂的方法：我现在正在做一个项目，其中 3 或 4 个简短但复杂的逻辑块深埋在课堂上。能够对这些进行单元测试并开发它们会很方便。我是从另一种语言移植过来的，这些方法在 15 年多来发生了变化。所以它们不会变脆。

我尝试遵循 TDD 的 3 条法则，这对于很多私有方法来说真的很难做到。

我只是说单元测试私有方法是可取的时间和原因。

# php - 添加页脚文本 SVG 或 PDF

> ID：10789648
> 
> 赞同：1
> 
> 时间：2012-05-28T19:36:47.133
> 
> 标签：php, pdf, svg, inkscape

我正在编写一个小型**PHP 脚本**，该脚本使用 InkScape 命令行将 SVG 文件转换为 PDF。

问题是我需要添加带有订单号的页脚文本。这需要通过命令行进行，因为它是由脚本自动调用的。

我不担心文本格式或字体。我只需要稍微放大画布高度并添加白色背景的文本。

我看过几个 PDF 和 SVG 命令行编辑器，在转换之前或之后添加文本，但没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:42:34.373

您可以使用：

[http://php.net/manual/en/class.domdocument.php](http://php.net/manual/en/class.domdocument.php)

要在呈现给客户端之前遍历文档，找到页面底部（附加到 SVG 标记）并在结束服务器端处理之前附加页脚 dom 节点。

```
<svg>...<g><text>This is a footer</text></g></svg> 
```

# blackberry - 将管理器添加到 BlackBerry 屏幕底部

> ID：10789654
> 
> 赞同：0
> 
> 时间：2012-05-28T19:37:32.967
> 
> 标签：blackberry, java-me

我正在尝试创建一个布局，如下图所示：

![在此处输入图像描述](../Images/9a39d5ee6775041ce1931d6215f201f1.png)

这是我的屏幕组件，

1.  屏幕标题字段
2.  屏幕中央的按钮
3.  `HorizontalFieldManager`包含 3 个停靠在屏幕底部的按钮
4.  添加横幅，放置如下停靠。

我已经完成了所有的 1、2 和 4。我使用 setStatus(Field) 来放置广告横幅。此外，我已经定制了`HorizontalFieldManager`用于保持 3 个对齐的字段。现在我不知道如何将它放在添加横幅上方的屏幕底部，因为我已经将 setStatus() 用于广告横幅。此外，如果虚拟键盘出现，我希望它覆盖屏幕底部，而不是向上推动 Horizo​​nalFieldManager 和广告横幅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:14:31.417

将广告横幅和 3 个对齐字段与 VerticalFieldManager 组合，然后将组合管理器传递给 setStatus()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T08:36:53.820

考虑到 Display.getHeight()，不要使用 setstatus 添加横幅内容，而是可以在屏幕底部使用两个水平管理器。

我在我的应用程序中做了类似的屏幕，这里是关于它的简要信息。

1）父经理（垂直/水平）说parentManager

2）两个具有适当高度和最大宽度的水平管理器（在水平管理器的子布局中覆盖）并将这两个添加到垂直场管理器（底部管理器）

3）然后这是棘手的部分。到父 Manger 覆盖子布局并添加这些步骤

```
vfm_screen = new VerticalFieldManager(ScrollView.NO_VERTICAL_SCROLL | HORIZONTAL_SCROLL
                | NO_VERTICAL_SCROLL){

            protected void sublayout(int maxWidth, int maxHeight) {
                setPositionChild(parentManager, 0, 0);
                layoutChild(parentManager, Display.getWidth(), Display.getHeight());
                setPositionChild(bottommanager, 0, Display.getHeight()-114);
                layoutChild(bottommanager, Display.getWidth(), 114);
                setExtent(Display.getWidth(), Display.getHeight());
            };
        };

vfm_screen.add(parentManager);

vfm_screen.add(bottommanager);

add(vfm_screen); 
```

这里 114 是硬尺寸，您可以根据需要**更改它。**并将 Button 添加到屏幕中心的父管理器。

# c# - 在 C# 中清除一个 UserControl on Unload 事件

> ID：10789662
> 
> 赞同：1
> 
> 时间：2012-05-28T19:38:13.827
> 
> 标签：c#, asp.net, .net

我的应用程序中有一个 System.Web.UI.UserControl 用于向用户显示消息，但是在这些消息显示给用户之后，一旦我希望它们清除（有条件地）。

我现在尝试开始工作的简化代码如下：

```
protected override void OnUnload(EventArgs e) {
if (_resetOnUnload) {
    divMessageBlock.InnerHtml = "";
    _resetOnUnload = false;
}
base.OnUnload(e);
} 
```

但是，在 OnUnload 事件中对视图的任何更改都不会在下一页加载（表单提交）时转移。

我的问题是如何设置此用户控件以在任何消息可以添加到其他位置之前或在为用户呈现页面并保持这种状态之后清除自身？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:05:04.300

在关闭 ViewState 的情况下将消息输出到控件怎么样？这样，您的消息将被显示，并且任何后续回发都将清除该消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:30:07.630

尝试这个。将视图状态设置为保存_resetOnUnload，然后加载它。OnLoad 可以保持不变，测试是否清除。

```
protected override void OnLoad(EventArgs e) {
          base.OnLoad(e);

          if (_resetOnUnload) {
                 divMessageBlock.InnerHtml = "";
                 _resetOnUnload = false;
          }
   }

   protected override void LoadViewState(object savedState) {
          if (savedState != null) {
                 object[] myState = (object[])savedState;
                 _resetOnUnload = (bool)myState[0];
          }
   }

   protected override object SaveViewState() {
          object[] allStates = new object[]{ _resetOnUnload };
          return allStates;
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:50:53.440

我猜该`OnPreRender`事件是最后一个事件，您可以在其中更改控件的输出应该是什么。之后，控件已呈现，您的更改将无效。

# jquery - Jquery Validation Remote：将 1 显示为错误消息

> ID：10789664
> 
> 赞同：0
> 
> 时间：2012-05-28T19:38:18.697
> 
> 标签：jquery, jquery-validate

我正在尝试使用 jquery 验证插件验证表单中的用户名字段。我有以下自定义规则。

```
username: {
            required: true,
            minlength: 2,
            remote: {
                url: '<?php echo base_url();?>mycontoller/myfunction',
                type: 'post'
            } 
```

现在的问题是，如果我的控制器看起来像插件显示“1”作为错误消息。

```
 if(1>2){
                echo False;
            } else{ echo True;} 
```

但是如果我用以下代码替换控制器的代码，那么它会显示一条错误消息，说 - 用户名已经存在。

```
 if(1<2){
                echo False;
            } else{ echo True;} 
```

现在你能告诉我如何摆脱那个“1”或者将值（假或真）从控制器发送回视图的正确方法是什么。

仅供您参考。我在一个跨度内显示我所有的 jquery 验证错误消息。像这样。

```
 <span class="errormsg"></span>. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:07:50.263

这是一个我相信你会找到答案的例子：[http ://www.opencoder.co.uk/2010/07/jquery-remote-form-validation/](http://www.opencoder.co.uk/2010/07/jquery-remote-form-validation/)

# php - 如果行已经存在，检查 mysqli 结果

> ID：10789668
> 
> 赞同：0
> 
> 时间：2012-05-28T19:38:51.187
> 
> 标签：php, duplicates

我正在尝试检查我的数据库中是否存在这样的行：

```
 $uid = $_GET['queryString'];

    if(isset($_GET['queryString'])) {

    echo "New: ".$uid."<BR>";

    $query = "SELECT * FROM stuff WHERE $uid";

    // Escape Query
    $queryE = $db->real_escape_string($query);

        $results = $db->query($queryE);

        if(($results->num_rows) > 0) {
             echo "NO!";
        }
        else
        {
             echo "Make new row";

         }

    }
    else
    {
    echo 'Error!';
    } 
```

但我不断收到错误：`Trying to get property of non-object in ....`

所以如果它存在我做一件事，如果它不做另一件事，我一直在寻找大约一个小时来找到原因，也许我把旧的 PHP4 和我的 PHP5 东西混在一起了？

我已经尝试了很多，尝试了一些例子，但往往会得到错误：`mysql_fetch_array() expects parameter 1 to be resource, string given`

还是我应该在查询本身中检查它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T03:03:22.217

错误在哪一行？！

如果它`real_escape_string`在线，则说明您没有正确实例化 $db。

如果`$results->num_rows`在线，请尝试更改

`$results = $db->query($queryE);`到：

```
if(!($results = $db->query($queryE))) {
    echo 'Make new row';
} else {
    // user likely exists, check $results
} 
```

此外，您需要清理检查查询字符串的方式——只处理您想要的查询变量，而不是整个字符串。还建议为查询变量和表列使用不同的名称。

# backbone.js - Java 服务器上的 Underscore.js 模板

> ID：10789678
> 
> 赞同：0
> 
> 时间：2012-05-28T19:39:56.983
> 
> 标签：backbone.js, underscore.js

[当Backbone.js](http://backbonejs.org/)是我的 MV* 框架时，我正在构建一个单页 Web 应用程序。它需要[Underscore.js](http://underscorejs.org/)，所以我不想将它用作我的模板引擎。我将模板结果设置为要在其***渲染***函数中显示的视图内容：

```
this.el.append( compiledTemplate ); 
```

我想知道实现模板代码的正确方法：

1.  应该是生成 HTML 文本的 JS 代码吗？
2.  它应该是一个带有脚本标签的 HTML 文件来包含 JS 代码吗？
3.  如何将显示与逻辑分开？
4.  如何将我的 CSS 写在一个单独的文件中（而不是在 JS 文件中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:54:12.927

1.  嗯……这就是 Underscore 模板引擎，不是吗？所以，不，您的模板应该是带有*插入*标签的 HTML。

2.  通常它是一个 DOM 元素，其内容是模板，是的，它曾经是一个`script`标签。

3.  强制您自己仅在模板中使用*插值*模型属性。*如果您使用任何类型的装饰器*技术，您可以传递特殊的预先计算的属性。

4.  没有任何 Backbone 或 Underscore 限制，您不能像往常一样包含外部 CSS 文件。

# django - Django-tables2 - 如何在 TemplateColumn 中使用自定义过滤器

> ID：10789680
> 
> 赞同：3
> 
> 时间：2012-05-28T19:39:59.167
> 
> 标签：django, django-templates, django-template-filters, django-tables2

我在 django-tables2 表中有一个 TemplateColumn，我想使用自定义模板过滤器（名为 int_to_time）来转换数据。当我使用内置过滤器时，它工作正常。

到目前为止，我所做的是将模板\django_tables2\table.html 从 django-tables2 复制到我的项目中，并将我的标签库包含到 table.html 中。

但是，当我尝试渲染视图时，出现以下错误：

```
/details_show/2012/3/13/2 处的 TemplateSyntaxError
过滤器无效：“int_to_time”

```

错误似乎在 table.html 的第 28 行

```
{% for column, cell in row.items %}

```

我可以确认我的标签库正在加载，因为例如，如果我将标签库的名称写错了，那么我会得到一个找不到模板库的错误。

请帮忙 ！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T00:17:32.603

**最简单的解决方案**

[`TemplateColumn`](http://django-tables2.readthedocs.org/en/latest/index.html#templatecolumn-objects)在模板外部呈现列。您在模板中加载的任何自定义过滤器或标签都将不可用。

您应该能够在定义`TemplateColumn`. 就像是：

```
name1 = tables.TemplateColumn('{% load my_filters %}{{ record.name|int_to_time }}') 
```

**替代方案**（布拉德利在评论中建议）

而不是`TemplateColumn`在定义表的类中使用。使用 a ，但使用格式[`Column`](http://django-tables2.readthedocs.org/en/latest/index.html#django_tables2.columns.Column)定义方法。`render_columnname()`就像是：

```
from myfilters import int_to_time

class MyTable(tables.Table):
    time = tables.Column()

    def render_time(self, value):
        return int_to_time(value) 
```

有关详细信息，请参阅[Table.render_FOO() 方法](https://django-tables2.readthedocs.io/en/latest/pages/custom-data.html#table-render-foo)。

# java - 我需要一些关于大 O 的说明

> ID：10789681
> 
> 赞同：1
> 
> 时间：2012-05-28T19:40:01.987
> 
> 标签：java

我有几个问题，请多多包涵。我需要一些帮助来澄清 Big O 和运行时间。据我了解，Big O 是一种正确呈现算法运行时间的方式吗？从阅读中，我一直试图弄清楚如何计算算法的大 O。到目前为止，我已经发现像这样的东西有一个 O(N^2) 的大 O

```
for(i = 0; i < N, i++)
    for(j = 0; j < N; j++)
      //code 
```

但如果是这样会发生什么：

```
for(i = 0; i < N, i++)
    for(j = 0; j < M; j++)
      //code 
```

其中 N 并不总是等于 M。

另外，如果您将其中两个加在一起，那么大 O 是什么？

```
for(i = 0; i < N, i++)
    for(j = 0; j < N; j++)
      //code
for(i = 0; i < N, i++)
    for(j = 0; j < N; j++)
      //code 
```

大O是否等于N^2 + N^2 = 2N^2？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:42:30.083

> 其中 N 并不总是等于 M。

然后它是`O(NM)`，除非`M`是依赖于`N`或反之亦然。如果它们是独立的，那么说它是`O(N)`and也是正确的`O(M)`。

> 大O是否等于N^2 + N^2 = 2N^2？

`O(2N^2)`相当于`O(N^2)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T19:44:50.403

基本上你是对的。对于第二个，它将是 O(N*M)。对于第三个，你也是对的，但这可以从 O(N^2 + N^2)=O(2*N^2)=O(N^2) 减少。

大 oh 符号用于近似算法的运行时间。所以在这种情况下，乘法因子 2 几乎没有功率系数那么大，所以我们去掉它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:43:46.840

第二个例子是 O(N * M)。第三个仍然是 O(N^2)，因为常数因子 (2) 不会改变 BigO。重要的是，如果你加倍 N，时间乘以 4。如果你加倍 N，时间乘以 9。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T19:46:58.127

对于前两种情况，请意识到在这种情况下 Big-O 只是两个变量的函数。如果我告诉你，你`f(x,y) = x + sin y`会说 f(x) =`f(x) + sin x`吗？不，那是胡说八道。

真的是`O(N*M)`。如果您处于 M 是一个固定常数的情况，并且您对您的程序将如何根据 N 执行感兴趣，那么它在 N 或 中是线性的`O(N)`。但有时你会在你知道 N=M 的情况下，假设你正在处理一个正方形，其中你可以说函数是`O(N^2)`。`M=k`但是没有像某些 konstant k 或那样的任何限制`M=N`，唯一准确的说法是`O(N*M)`. 如果你告诉我这是二次的，那么我会进行逆向工程并期望 N=M 或其他东西，如果你告诉我它是线性的，我会期望一个保持不变。

如果你想获得更多的理论知识，你可以注意到在你指定你正在使用的变量之前，说总是`O(something)`无稽之谈。 `f(N,M) = NM`is`O(N) w.r.t. N`和. `O(NM) w.r.t N,M``O(N^2) w.r.t N where M=N`

如果您想获得更多数学知识...那就是维基百科或 math.stackexchange.com :)

# ruby-on-rails - Rails 加载一些列表 ob 对象以减慢

> ID：10789682
> 
> 赞同：0
> 
> 时间：2012-05-28T19:40:05.360
> 
> 标签：ruby-on-rails, caching

这是我在stackoverflow中的第一个问题。

在我的应用程序中，我有一个实时部分，可以查看网络的运动。它是一份在线报纸，该部分显示：新文章、新评论、新投票、新辩论……所有正在网络上发生的事情。

我有这个代码：

```
def index
    @objects = Article.find(:all, :conditions => { :created_at => (Time.now-48.hours)..(Time.now), :published => true })
    @objects = @objects + Debate.find(:all, :conditions => { :created_at => (Time.now-48.hours)..(Time.now), :active => true })
    @objects = @objects + Event.find(:all, :conditions => { :created_at => (Time.now-48.hours)..(Time.now), :active => true })

    @objects = @objects + Comment.find(:all, :conditions => {  :created_at => (Time.now-48.hours)..(Time.now), :active => true })
    @objects = @objects + Vote.find(:all, :conditions => {  :created_at => (Time.now-48.hours)..(Time.now) })

    @objects.sort! {|x,z| x.created_at <=> z.created_at}
    @objects.reverse!

end 
```

我在过去 48 小时内加载了所有内容。我一直在阅读有关在 Rails 中缓存的信息，因为我认为这不是我的解决方案。

我该怎么做才能更快地加载此列表？因为现在需要 7... 或 8 秒...

谢谢大家 :D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:49:48.780

几点注意事项：

1.  `find(:all)`已[弃用](http://m.onkey.org/active-record-query-interface)。改为使用`where()`。
2.  而不是进行 5 个 db 调用，而是将它们迁移到一个 db 调用中（如果需要，为此创建一个 sql 查询）。
3.  确保索引表中的日期列。
4.  不要排序排序和反向。而是替换`y <=> x`，这样它就会按照您需要的方式进行排序。

希望能帮助到你..

# java - 创建 JNDI Java Bean 错误

> ID：10789683
> 
> 赞同：-1
> 
> 时间：2012-05-28T19:40:05.300
> 
> 标签：java, tomcat, jndi

我正在尝试在应用程序中创建 JNDI bean，但在下面第一个代码块的第三行出现错误“无法创建资源实例”。[我正在按照http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html](http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html)中所示的步骤进行操作。

代码如下：

豆实例化：

```
 Context initCtx = new InitialContext();
            Context envCtx = (Context) initCtx.lookup("java:comp/env");
            MyBean bean = (MyBean) envCtx.lookup("bean/MyBeanFactory");

            System.out.println("foo = " + bean.getFoo() + ", bar = " +
                           bean.getBar()); 
```

MyBean 类：

```
package com.company.intrasc.funcionarios;
public class MyBean {
  private String foo = "Default Foo";

  public String getFoo() {
    return (this.foo);
  }

  public void setFoo(String foo) {
    this.foo = foo;
  }

  private int bar = 0;

  public int getBar() {
    return (this.bar);
  }

  public void setBar(int bar) {
    this.bar = bar;
  }

} 
```

MyBeanFactory 类：

```
package com.company.intrasc.factory;

import java.util.Enumeration;
import java.util.Hashtable;
import javax.naming.Context;
import javax.naming.Name;
import javax.naming.NamingException;
import javax.naming.RefAddr;
import javax.naming.Reference;
import javax.naming.spi.ObjectFactory;
import com.company.intrasc.funcionarios.MyBean;

public class MyBeanFactory implements ObjectFactory {

  public Object getObjectInstance(Object obj,
      Name name, Context nameCtx, Hashtable environment)
      throws NamingException {

      // Acquire an instance of our specified bean class
      MyBean bean = new MyBean();

      // Customize the bean properties from our attributes
      Reference ref = (Reference) obj;
      Enumeration addrs = ref.getAll();
      while (addrs.hasMoreElements()) {
          RefAddr addr = (RefAddr) addrs.nextElement();
          String name1 = addr.getType();
          String value = (String) addr.getContent();
          if (name1.equals("foo")) {
              bean.setFoo(value);
          } else if (name1.equals("bar")) {
              try {
                  bean.setBar(Integer.parseInt(value));
              } catch (NumberFormatException e) {
                  throw new NamingException("Invalid 'bar' value " + value);
              }
          }
      }

      // Return the customized instance
      return (bean);

  }

} 
```

应用程序文件夹中的 web.xml：

```
<resource-env-ref>
  <description>Object factory for MyBean instances.</description>
  <resource-env-ref-name>bean/MyBeanFactory</resource-env-ref-name>
  <resource-env-ref-type>com.company.intrasc.funcionarios.MyBean</resource-env-ref-type>
</resource-env-ref> 
```

server.xml 上下文配置：

```
 <Resource name="bean/MyBeanFactory" auth="Container" type="com.company.intrasc.funcionarios.MyBean" factory="com.company.intrasc.factory.MyBeanFactory" bar="23"/> 
```

堆栈跟踪：

```
javax.naming.NamingException: Cannot create resource instance
    at org.apache.naming.factory.ResourceEnvFactory.getObjectInstance(ResourceEnvFactory.java:114)
    at javax.naming.spi.NamingManager.getObjectInstance(Unknown Source)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:793)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:140)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:781)
    at org.apache.naming.NamingContext.lookup(NamingContext.java:153)
    at com.company.intrasc.servlet.Logon.executa(Logon.java:81)
    at com.company.intrasc.servlet.Controller.service(Controller.java:80)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Unknown Source) 
```

MyBean 和 MyBeanFactory 类导出到 catalina_home/lib 的压缩 JAR 中。服务器是 Tomcat 6，IDE 是 Eclipse Indigo，系统（在开发机器中）是 Windows Vista。应该有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T19:16:31.870

终于我发现了问题所在。我不知道它是否对任何人都有用，但问题出`<context>`在 server.xml 中的标记中。这个标签必须理解`<Resource>`标签，我忘了把它放进去。因此，上下文不是“看到”资源。

# php - Mysql 不返回所有值

> ID：10789684
> 
> 赞同：0
> 
> 时间：2012-05-28T19:40:27.270
> 
> 标签：php, mysql

我正在使用以下查询来使用 PHP 和 MySQL 检索数据。

```
$query = "
SELECT f.*, CONCAT(p.first_name, ' ', p.last_name) AS Name 
FROM a_fyp_evl f, a_person p 
WHERE p.person_id = f.faculty_id 
  AND f.group_id = '$_COOKIE[id]'
"; 
```

查询`Name`正确返回，但不是`f.*`. 我不知道为什么。

# vb.net - 如何从客户端连接到 SQL Server？

> ID：10789686
> 
> 赞同：0
> 
> 时间：2012-05-28T19:40:58.957
> 
> 标签：vb.net, sql-server-2008-r2

应该选择哪个？

```
Data Source=190.190.200.100,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 
```

或者

```
Data Source=190.190.200.100;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:49:21.027

这取决于 - 如果您的 SQL Server 完全使用默认设置在所有东西上运行，那么您不需要指定端口或要使用的协议。

只需使用：

```
Data Source=190.190.200.100;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 
```

这应该足够了。

如果您的服务器有自定义设置，例如使用自定义端口 - 当然，您必须将其添加到您的连接字符串中。

有关大量示例和说明，请参阅[connectionstrings.com](http://connectionstrings.com)

PS：我个人会用

```
Server=190.190.200.100;Database=myDataBase;User ID=myUsername;Password=myPassword; 
```

因为我发现`Server`and`Database`比 and 更清晰、更明显`Data Source`-`Initial Catalog`从功能的角度来看，这两个连接字符串是相同的（对于 SQL Server）

# php - 创建 3 个相互关联的下拉菜单

> ID：10789690
> 
> 赞同：0
> 
> 时间：2012-05-28T19:41:24.150
> 
> 标签：php, javascript

我需要创建 3 个相互关联的依赖下拉菜单。因此，如果选择第一个，相关数据将显示在第二个下拉列表中，当在第二个下拉列表中选择一个选项时，在第三个下拉列表中将显示一些相关数据。

And i need to use $_GET on this form, so if a specific option in the second one is slected a massage shows up, and when an option is the 3rd drop down is seleted, the page redirects for example to www.google.com . 我在第一个字段中需要两个不相关的数据，所以当它们被选中时，页面会重定向到 www.msn.com。

我知道它需要 JavaScript，但不幸的是我现在不知道 JS。

请不要使用“this.value”向 JavaScript 发送参数，因为它与我的其他代码之一冲突。

（而且我不希望页面重新加载）

像这样的东西：

```
Drop down 1  ----------------------- drop down 2  ----------------------- drop down 3

option 1 ( redirect to msn.com)

option 2 ==========================> Option 100 ======================> Option 500
                                     Option 101                         Option 501
Option 3 (redirect to google.com)    Option 102 (message:Hello )
                                     Option 103 ======================> Option 700
                                                                        Option 701 
```

我努力解释它，我希望你明白我想说的。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:11:34.583

这是一个快速而肮脏的答案......

```
 <html>
      <head>
        <script type='text/javascript'>
          var drop3Options = {"100":["500","501"],"103":["700","701"]};
          function drop1Change(){
            var value = document.getElementById("drop1").value;
            if(value == "msn")
              window.location.href = "http://www.msn.com";
            else if(value == "google"){
              window.location.href = "http://www.google.com";
            }                
          }
          function drop2Change(){
            var value = document.getElementById("drop2").value;
            var drop3List = document.getElementById("drop3");
            if(drop3Options[value]){
              drop3List.options.length = 0;
              for(var i = 0; i < drop3Options[value].length; i++){
                drop3List.options[i] = new Option(drop3Options[value][i],drop3Options[value][i]);
              }
            }
          }
        </script>
      </head>

      <body>
        <form method='GET' action='serverScript.php'>
          <select id='drop1' onchange='drop1Change()'>
            <option value='msn'>MSN</option>
            <option value='dr2'>DROP 2</option>
            <option value='google'>GOOGLE</option>  
          </select>

          <select id='drop2' onchange='drop2Change()'>
            <option value='100'>100</option>
            <option value='101'>101</option>
            <option value='102'>102</option>  
            <option value='103'>103</option>              
          </select>         

          <select id='drop3'>
            <option value='500'>500</option>
            <option value='501'>501</option>
          </select>
          <input type='submit' value='SUBMIT'/>
        </form>
      </body>
    </html> 
```

显然我不知道你到底在用这个脚本做什么，所以我很难做出假设并给你更好的代码，但这会做我理解的问题。我也不知道您将把它发送到什么服务器端脚本。但是只需更改表单中的 ACTION 属性以反映服务器脚本的位置..

javascript 有一个全局变量（drop3Options）。这是一个具有两个属性的对象，它们为选择 3 个选项保存 2 个数组。

所以 drop3Options['100'] 保存一个数组 ['500','501'] 并且 drop3Options['103'] 保存一个数组 ['700','701']

当您更改选择框时，它会调用适当的方法，这是通过将“onchange”属性添加到每个选择元素来完成的，它会调用查看值并相应执行操作的函数

我认为您需要做的不止于此，因此请评论更多细节，我很乐意提供帮助

# php - PHP eregi 和 eregi_replace 混淆

> ID：10789692
> 
> 赞同：0
> 
> 时间：2012-05-28T19:41:34.227
> 
> 标签：php, eregi

我正在尝试计算 textarea 字段中的单词。下面是一个简单的函数，它使用了已弃用的 eregi 和 eregi_replace。

我知道我可以用 preg_match 和 preg_replace 交换这两个函数，但我错过了之后的内容。我确定这是配置参数的方式。

```
function count_words($str){
//http://www.reconn.us/count_words.html
$words = 0;
$str = eregi_replace(" +", " ", $str);
$array = explode(" ", $str);
for($i=0;$i < count($array);$i++)
{
if (eregi("[0-9A-Za-zÀ-ÖØ-öø-ÿ]", $array[$i])) 
$words++;
}
return $words;
} 
```

如果我理解正确，对于 preg_match，我应该添加“i”：

```
if (preg_match("[0-9A-Za-zÀ-ÖØ-öø-ÿ]/i", $array[$i])) 
```

但我不确定 preg_replace。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:43:38.213

计数单词可以更容易地完成：

```
$words = mb_split(' +', $text);
$wordCount = count($words); 
```

但是， preg_replace 行应该是这样的：

```
preg_replace('/( +)', ' ', $str); 
```

# python - 使用 PIL 保存渐进式 2 兆像素 + Jpeg 时出现“编码器错误 -2”

> ID：10789700
> 
> 赞同：1
> 
> 时间：2012-05-28T19:42:02.463
> 
> 标签：python, python-imaging-library

我正在尝试使用 PIL 保存一些渐进式、视网膜大小的图像以在 iPad 3 上使用，但不断收到问题标题中提到的“编码器错误 -2”。

我知道这是一个已知的 PIL + Jpeg 问题，经过一番阅读，我听说可以通过在您的代码中添加类似这样的内容来解决它：

```
import PIL
from PIL import ImageFile
from exceptions import IOError

try:
    img.save("img.jpg", "JPEG" , quality=80, progressive=True)
except IOError:
    PIL.ImageFile.MAXBLOCK = img.size[0] * img.size[1]
    img.save("img.jpg", "JPEG" , quality=80, progressive=True) 
```

但是，即使使用上述方法增加 PIL 的 Maxblock 后，我的脚本*仍然*会抛出“编码器错误 -2”。我也尝试过让 MAXBLOCK 变得非常大，但也没有运气：

```
PIL.ImageFile.MAXBLOCK = 2048 ** 10 
```

我正在尝试处理的图像相当大（2048 x 2048），但我不敢相信它们对于 PIL 来说太大而无法处理。

有没有其他人遇到/解决过此类问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T10:37:20.963

如果您使用 pip 安装了 PIL，请将其卸载并安装枕头。枕头库有边缘版本的 PIL 库。来自 pip 的 PIL 太旧了。如果您更新为枕头而不是 PIL，则不必设置 PIL.ImageFile.MAXBLOCK。它是自动处理的。

如果您使用 git 子模块，只是将 PIL 源代码下载到 repo，请确保您从 GitHub 下载最新源并使用它。

# objective-c - Twitter JSON API 的 NSDate 格式化程序问题

> ID：10789702
> 
> 赞同：1
> 
> 时间：2012-05-28T19:42:20.763
> 
> 标签：objective-c, ios, cocoa-touch, twitter

我正在尝试格式化 JSON 响应日期值：

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
    //Wed Dec 01 17:08:03 +0000 2010
    [df setDateFormat:@"eee, MMM dd HH:mm:ss ZZZZ yyyy"];
    NSDate *date = [df dateFromString:[twitter objectForKey:@"created_at"]];
    [df setDateFormat:@"dd/MM/yyyy"];
    NSString *dateStr = [df stringFromDate:date]; 
```

我遵循这个问题的说明：

[iOS 中的日期/时间解析：如何处理（或不处理）时区？](https://stackoverflow.com/questions/5559912/date-time-parsing-in-ios-how-to-deal-or-not-deal-with-timezones)

实际上，JSON 响应中的日期值是：

```
created_at":"Mon, 28 May 2012 11:20:29 +0000" 
```

接收值时日期变量为零`[df dateFromString:[twitter objectForKey:@"created_at"]];`

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T20:03:26.383

如果月份是缩写的（Sept），请尝试这种格式：

```
[df setDateFormat:@"EEE, d MMM y HH:mm:ss Z"];; 
```

和

```
[df setDateFormat:@"EEE, d MMMM y HH:mm:ss Z"]; 
```

如果写出月份名称（九月）。

[格式说明符的完整列表。](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)

我还必须更改语言环境

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setLocale:[[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"] autorelease]];
[df setDateFormat:@"EEE, d MMM y HH:mm:ss Z"];
NSDate *date = [df dateFromString:@"Mon, 28 May 2012 11:20:29 +0000"];

[df setDateFormat:@"dd/MM/yyyy"];
NSString *dateStr = [df stringFromDate:date];

NSLog(@"%@",dateStr); 
```

**输出**

```
28/05/2012 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T15:52:49.290

我发现 twitter Json 响应中的“created_at”属性是这种格式：

```
Thu Apr 19 10:07:29 +0000 2012 
```

所以我使用了这个格式化程序：

```
[df setDateFormat:@"EEE MMM d HH:mm:ss Z y"]; 
```

它工作正常；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-28T20:16:15.113

要验证您使用的格式，请从日期创建一个字符串：

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"eee, MMM dd HH:mm:ss ZZZZ yyyy"];
NSLog(@"%@", [df stringFromDate: [NSDate date]]; 
```

将此与您的 JSON 响应中的日期进行比较，您应该能够看到您的格式错误的地方。

* * *

在*斯威夫特*

```
let df = NSDateFormatter()
df.dateFormat = "eee, MMM dd HH:mm:ss ZZZZ yyyy"
let dateStr = df.stringFromDate(NSDate())
println("\(dateStr)") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:45:35.353

正确的格式化程序值为：

```
[df setDateFormat:@"eee, dd MMM yyyy HH:mm:ss ZZZZ"]; 
```

为了：

```
created_at":"Mon, 28 May 2012 11:20:29 +0000" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-05T07:56:03.993

```
"created_at" = "Sat Apr 05 06:31:57 +0000 2014"; 
```

以下方法返回 twit 出现之前的多少时间。

```
-(NSString*)retrivePostTime:(NSString*)postDate{

    NSDateFormatter *df = [[NSDateFormatter alloc] init];
   [df setDateFormat:@"eee MMM dd HH:mm:ss ZZZZ yyyy"];
    NSDate *userPostDate = [df dateFromString:postDate];

    NSDate *currentDate = [NSDate date];
    NSTimeInterval distanceBetweenDates = [currentDate timeIntervalSinceDate:userPostDate];

    NSTimeInterval theTimeInterval = distanceBetweenDates;

    // Get the system calendar
    NSCalendar *sysCalendar = [NSCalendar currentCalendar];

    // Create the NSDates
    NSDate *date1 = [[NSDate alloc] init];
    NSDate *date2 = [[NSDate alloc] initWithTimeInterval:theTimeInterval sinceDate:date1];

    // Get conversion to months, days, hours, minutes
    unsigned int unitFlags = NSHourCalendarUnit | NSMinuteCalendarUnit | NSDayCalendarUnit | NSMonthCalendarUnit | NSSecondCalendarUnit;

    NSDateComponents *conversionInfo = [sysCalendar components:unitFlags fromDate:date1  toDate:date2  options:0];

    NSString *returnDate;
    if ([conversionInfo month] > 0) {
        returnDate = [NSString stringWithFormat:@"%ldmth ago",(long)[conversionInfo month]];
    }else if ([conversionInfo day] > 0){
        returnDate = [NSString stringWithFormat:@"%ldd ago",(long)[conversionInfo day]];
    }else if ([conversionInfo hour]>0){
        returnDate = [NSString stringWithFormat:@"%ldh ago",(long)[conversionInfo hour]];
    }else if ([conversionInfo minute]>0){
        returnDate = [NSString stringWithFormat:@"%ldm ago",(long)[conversionInfo minute]];
    }else{
        returnDate = [NSString stringWithFormat:@"%lds ago",(long)[conversionInfo second]];
    }
    return returnDate;
} 
```

# ios - 将 UIView 连接到 UIViewController

> ID：10789709
> 
> 赞同：0
> 
> 时间：2012-05-28T19:43:03.787
> 
> 标签：ios, cocoa-touch, model-view-controller, uiview, uiviewcontroller

我有一个 UIView 子类，其中包含一些标签、一个 tableview 和一些其他部分。它目前是 tableview 的委托和数据源，还管理许多 UI 操作，这些操作都不依赖于数据。例如，当按下“编辑”按钮时，它知道如何更新其控件，但是当按下“保存”时，除了将控件切换回之前的状态之外，它不会做任何事情。所有这些都是在代码中完成的，我在这个应用程序中根本没有使用 IB。

我现在想深入了解它可能引发的所有数据模型更改。但我想把这些放在一个新的控制器类中，我想这是符合 MVC 的做事方式。我不知道怎么去那里。

首先，我需要创建一个自定义控制器类。我是否应该从 UIView 子类中公开一些控件，以便视图控制器可以访问它们？例如，我需要在视图中读取和写入文本字段，那么我应该为此提供一个 getter/setter 吗？

其次，tableview - 而不是 UIView 作为委托，我是否也应该公开它，并使视图控制器成为委托？即来自 UIViewController 的 view.tableView.delegate = self？

最后，如何从另一个视图启动视图？具体来说，这是一个类似于天气应用程序的分页滚动视图应用程序，因此我有一个 mainView UIView，它指定单个分页滚动视图，然后添加多个自定义 UIView，每个页面一个。如何替换 [scrollView addSubview:myCustomView] 而添加 viewController？以及如何将视图连接到它的控制器，反之亦然？

我之前没有在没有 IB 的情况下尝试过所有这些，所以感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:26:34.567

您的问题非常广泛，部分答案取决于您如何编写解决方案。我将尝试回复**一些对我有用的提示**：

**视图：**作为一般经验法则，请记住，视图对象应该是非常通用的，它对自身层次结构之外的其他视图一无所知。因此，视图不应依赖与其他视图的任何特定交互，而应在需要时通过回调、协议、块等与它的委托/所有者/创建者进行通信。

**视图控制器：**任何时候你需要让不同层次结构中的两个视图相互交互，我的建议是你坚持通过视图控制器来处理这种交互。通过这样做，您将确保您的视图不会被在不同屏幕中无用的代码污染。

另外请记住，iOS 的 UIViewController 旨在成为一个用于处理完整可见视图层次结构的类，而不是充当单个视图的控制器。因此，我建议您不要尝试为每个视图设置一个控制器，而是使用一个控制器来处理所有视图。

**发布视图元素：** UIView 在其头文件中公开多少取决于您的实现。任何处理视图外观的方法，看起来是通用的和可重用的，并且不需要视图树范围之外的任何东西，肯定是你想要包含在它的实现中并在头文件中发布的东西.

对于您认为外部人员很可能需要访问的任何财产也是如此。

建议：只发布真正需要的内容。通常发布新方法和属性比稍后删除它们更容易。

# java - 试图了解 ConcurrentHashMap 的范围

> ID：10789710
> 
> 赞同：3
> 
> 时间：2012-05-28T19:43:08.973
> 
> 标签：java, concurrency, concurrenthashmap

提供`ConcurrentHashMap`线程安全但文档状态：

> “然而，即使所有操作都是线程安全的，检索操作并不需要锁定”

因此，据我所知，获取或设置键和值是线程安全的，但修改任何给定键的实际值不是（我实际上指的是该对象的值或状态）。

我只是对它是如何工作的感到困惑，目前我认为事情是这样的。

`ConcurrentHashMap`就设置/获取它们而言，密钥的唯一保证是线程安全的。但是您放在地图中的对象必须自己保护并发。

它是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:45:25.783

> 但是您放在地图中的对象必须自己保护并发。

你的理解是正确的。

从[文档](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)中：

> 但是，即使所有操作都是线程安全的，检索操作也不需要锁定，并且不支持以阻止所有访问的方式锁定整个表。

上面还说的是，在读取时没有内置的哈希映射自动锁定机制。特别是，这意味着`get()`操作可以与其他线程执行的并发修改重叠。

该文档继续解释并发语义：

> 检索操作（包括`get`）一般不会阻塞，因此可能与更新操作（包括`put`and `remove`）重叠。检索反映了最近完成的更新操作在其开始时保持的结果。`putAll`对于和等聚合操作`clear`，并发检索可能仅反映插入或删除某些条目。同样，在迭代器/枚举创建时或之后的某个时间点，返回反映哈希表状态的元素`Iterators`。`Enumerations`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T19:47:18.667

您所说的默认情况下是正确的 - 地图无法强制其键或其值的线程安全，因为这些是来自外部的对象。但是，您所读到的有关对象检索的内容与该事实无关。检索值时映射不会阻塞，因此可能同时发生另一个更新（这些操作可能重叠）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:00:58.277

The basic idea of the ConcurrentHashMap is that only modifications use a lock, while retrieval-only operations don't. This is possible because the entire data structure and the operations on it are defined in a way that allows `get()` to only ever see a "consistent enough" state of the map to do its work. If there's currently an insert operation in progress, then `get()` either sees the result or it doesn't, but it won't ever see a partial result or even temporarily invalid data.

# asp.net - 如何为 ASP.net UserControl 指定命名空间？

> ID：10789711
> 
> 赞同：3
> 
> 时间：2012-05-28T19:43:36.650
> 
> 标签：asp.net, user-controls, namespaces

我`UserControl`在 ASP.net 中有一个：

**`GrobSelector.ascx.cs`**：

```
...
public partial class GrobSelector : System.Web.UI.UserControl
{
   ... 
```

我想将此类包装在命名空间中：

**`GrobSelector.ascx.cs`**：

```
...
namespace GrobSelectorNamespace
{
   public partial class GrobSelector : System.Web.UI.UserControl
   {
      ...
   ...       
} 
```

除了现在代码无法编译：

> ```
> public partial class GrobSelector : System.Web.UI.UserControl 
> ```
> 
> 确保此代码文件中定义的类与'inherits' 属性匹配，并且它扩展了正确的基类（例如Page 或UserControl）。

将 ASP.net 放入命名空间的正确方法是`UserControl`什么？

* * *

## 奖金喋喋不休

*前面*的代码文件包含：

**`GrobSelector.ascx`**：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="GrobSelector.ascx.cs" 
    Inherits="GrobSelector"  %> 
```

## 奖金阅读

*   [将 Web 用户控件 (ascx) 放在命名空间中？](http://forums.asp.net/t/1158378.aspx/1)
*   [asp.net 用户控件中的命名空间](https://stackoverflow.com/questions/1635418/namespace-in-asp-net-usercontrol)
*   [获取 ASP.net 用户控件的命名空间名称未找到](https://stackoverflow.com/questions/826129/getting-namespace-name-not-found-for-asp-net-user-control)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T19:53:05.030

您收到的错误解释正确。

您应该更改“in-front”文件，以便该`Inherits`属性考虑控制类所在的命名空间：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="VacationSelector.ascx.cs" 
    Inherits="VacationSelectorNamespace.VacationSelector"  %> 
```

# oop - 这是反模式吗？如果是，为什么？如果不是为什么不呢？

> ID：10789712
> 
> 赞同：0
> 
> 时间：2012-05-28T19:43:37.643
> 
> 标签：oop, design-patterns, anti-patterns

我正在编写一些代码，我们正在创建对象模型，但模型具有通用键。例如

```
class myContact {
 var key;
 var value;
} 
```

然后在代码中实例化它们如下

```
myContact = new myContact()
myContact.key = 'address'
myContact.value = '123 my address'

myContact2 = new myContact()
myContact2.key = 'secondAddress'
myContact2.value = '123 my other address' 
```

然后将它们附加到父对象，例如

```
myBank = new company();
myBank.addContact(myContact);
myBank.addContact(myContact2); 
```

对我来说，这感觉不对，因为模型的定义如此松散。但是，您确实从班级名称中知道它将是某种联系信息。

同时，我可以看到为什么这可能很有用，就好像我们想在未来添加不同类型的联系人一样，这种方法可以很容易地做到这一点。

如果这是一种好习惯，有人可以向我解释吗？不良做法及其原因？

我最初的想法：

好习惯

*   将来易于扩展联系人类型。
*   轻松遍历 myBank 的联系信息并获取数据。

不好的做法

*   如果要更新特定的联系人类型，则必须循环查找正确的键。
*   我从来没有写过这样的代码，这就是为什么即使它是完全可以接受的，这也是一种不好的做法。
*   贫血模型，没有真正需要上课。
*   没有定义的键，因此我们无法在不重新搜索所有联系人的情况下轻松删除或添加联系人。
*   没有关于联系人是什么或应该是什么的定义。

任何想法将不胜感激。

编辑：当我一个人去的时候添加更多的想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T23:44:54.137

在我看来，“自定义字段”没有什么不好。它在所有允许用户定义自己的字段（例如jira、电话簿等）的系统中都相当流行。通常有一些基本的、预定义的字段/键，如姓名、ID、电子邮件等，用于例如搜索或身份验证。我唯一不喜欢这段代码的是贫血模型。如果您创建一个类 myClass（更改该名称！）然后公开访问其所有字段，那么您为什么需要一个类？类是关于封装的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T07:49:02.950

> 对我来说，这感觉不对，因为模型的定义如此松散。

“医生，我这样做会很痛”——“那就不要那样做”。

你*需要*一个松散的模型来表示它吗？然后去吧。如果不是，如果您觉得这只是一种负担，请选择更简单的解决方案。

显然，目前不需要它。未来出现这种需求的可能性有多大？这样的重构将如何影响您的代码库？你甚至可以对此做出假设吗？

[在这种情况下，在这种情况下应用YAGNI](http://en.wikipedia.org/wiki/You_ain%27t_gonna_need_it)原则可能是有意义的。

# ruby-on-rails - 设计：在会话#destroy 上调用方法

> ID：10789717
> 
> 赞同：3
> 
> 时间：2012-05-28T19:43:49.280
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我想知道向 Devise 的 session#destroy 操作添加额外功能的最佳方式是什么。

为了提供一些背景信息，我正在创建一个用户拥有购物车的网站，当用户的会话超时或他注销时，我希望他的购物车被标记为非活动状态。

我发现[了这个](https://stackoverflow.com/questions/3565952/rails-3-reset-session-using-devise)，但我有点犹豫是否要覆盖 Devise 控制器，因为它看起来有点乱......

当用户的会话被破坏时，是否有任何其他方法可以将此购物车设置为非活动状态？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T20:16:24.830

我确实建议您从设计中派生控制器并挂钩到动作，这样您就可以安全地远离设计的内部结构。

```
# routes.rb
devise_for :users, :controllers => { :sessions => "sessions" } # etc

# sessions_controller.rb
class SessionsController < Devise::SessionsController

  after_filter :set_cart_inactive!, :only => :destroy
  def set_cart_inactive!
    unless user_signed_in? # logout successful?
       # code here
    end
  end

end 
```

# php - Apache 2.4，在浏览器中启用文件夹视图

> ID：10789719
> 
> 赞同：8
> 
> 时间：2012-05-28T19:44:07.127
> 
> 标签：php, windows, apache

在 Apache Lounge 的 Win 7 机器上使用 Apache 2.4 64 位 VC10 构建，如何启用文件夹文件查看？我只想查看每个文件夹中没有该文件夹中的索引文件的文件。

这仅用于开发目的。我尝试使用选项索引/所有选项并重新启动我的服务器几次。我得到的只是403 Forbidden。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-01-26T07:27:40.387

对于 Apache 2.4，如果您启用了[目录索引](https://httpd.apache.org/docs/current/mod/mod_dir.html)，例如 index.html 或 index.php，您必须先禁用它，然后才能让文件夹和文件显示在 Web 浏览器中。

```
<Directory "/vhost/www/htdocs/path/to/folder">
 DirectoryIndex disabled
 Options Indexes
</Directory> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-10T20:00:33.600

Apache 中的指令已从 2.2 版本更改为 2.4 及更高版本。

我正在运行 2.4.7 版，基本的 vhost 文件如下所示：

```
<VirtualHost 192.168.1.5:80>

  DocumentRoot /srv/html/
  ServerName some.placeoverthe.rainbow

 <Directory /srv/html/>
   Options Indexes  ## Allows directory browsing.
   Require all granted  ## Allow all request
 </Directory>

</VirtualHost> 
```

取自 Apache 网站：[https ://httpd.apache.org/docs/2.4/upgrading.html](https://httpd.apache.org/docs/2.4/upgrading.html)

以下是执行相同访问控制的一些新旧方法的示例。

在此示例中，所有请求都被拒绝。

**2.2 配置：**

```
Order deny,allow
Deny from all 
```

**2.4 配置：**

```
Require all denied 
```

在此示例中，允许所有请求。

**2.2 配置：**

```
Order allow,deny
Allow from all 
```

**2.4 配置：**

```
Require all granted 
```

在下面的例子中，example.org 域中的所有主机都被允许访问；所有其他主机都被拒绝访问。

**2.2 配置：**

```
Order Deny,Allow
Deny from all
Allow from example.org 
```

**2.4 配置：**

```
Require host example.org 
```

**目录索引**

取自 Apache 网站：[http ://httpd.apache.org/docs/2.4/mod/core.html](http://httpd.apache.org/docs/2.4/mod/core.html)

Options 指令控制特定目录中可用的服务器功能。

选项可以设置为无，在这种情况下不启用任何额外功能，或者以下一项或多项：

**全部**

```
 All options except for MultiViews. 
```

**执行CGI**

```
 Execution of CGI scripts using mod_cgi is permitted. 
```

**跟随符号链接**

服务器将遵循此目录中的符号链接。这是默认设置。

即使服务器遵循符号链接，它也不会更改用于匹配部分的路径名。

FollowSymLinks 和 SymLinksIfOwnerMatch 选项仅适用于节或 .htaccess 文件。

忽略此选项不应被视为安全限制，因为符号链接测试受制于使其可以规避的竞争条件。

**包括**

```
Server-side includes provided by mod_include are permitted. 
```

**包括NOEXEC**

```
Server-side includes are permitted, but the #exec cmd and #exec cgi are disabled. It is still possible to #include virtual CGI scripts from ScriptAliased directories. 
```

**索引**

如果请求映射到目录的 URL，并且该目录中没有 **DirectoryIndex**（*例如*index.html），则*mod_autoindex*将返回该目录的格式化列表。

**多视图**

使用 mod_negotiation 允许内容协商“MultiViews”。

***注意：*** 如果设置在 以外的任何地方，此选项将被忽略，因为
mod_negotiation 需要真实资源来比较和评估。

**SymLinksIfOwnerMatch**

```
The server will only follow symbolic links for 
which the target file or directory is owned by 
the same user id as the link. 
```

***附带说明：***您可能需要检查并确保运行 apache 的用户有权从该目录读取。在 Windows 上，这可能不是问题，但在 Linux 上，这很可能是一个问题。在大多数 Linux 发行版上，默认用户通常是：

> www-数据

因此，如果该目录由运行 apache 的用户以外的其他人拥有，则您需要更改该目录的权限以允许 apache 访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T19:47:13.553

```
<Directory "/srv/www/htdocs"> 
        Options +Indexes
        ################
        Order allow,deny 
        Allow from all 
</Directory> 
```

# java - Eclipse 插件的跨项目版本控制

> ID：10789721
> 
> 赞同：0
> 
> 时间：2012-05-28T19:44:24.783
> 
> 标签：java, eclipse, maven, eclipse-plugin, versioning

我有多个相互依赖的 Elipse 插件项目。与此相关的几个问题：

1）如果我更改了一个插件的版本号，是否可以自动更新依赖插件的 plugin.xml 文件以反映版本号更改？

2) Maven pom 也是如此：当我更改版本号时，我能以某种方式自动更新 pom 吗？

3）如果我想保持 plugin.xml 和 pom.xml 版本号一致，有没有自动的方法呢？

4）最后：如果我有多个项目应该具有相同的版本号，我可以以某种方式同步版本号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T12:52:56.217

使用[Maven 发布插件](http://maven.apache.org/plugins/maven-release-plugin/index.html)- 尤其是[`update-versions`目标](http://maven.apache.org/plugins/maven-release-plugin/examples/update-versions.html)- 至少可以解决您已经解决的一些问题。

从[http://maven.apache.org/](http://maven.apache.org/)的文档中：

> 在某些情况下，您可能需要一种简单的方法来更新多模块项目的每个 POM 中的版本号。update-versions 目标旨在实现这一目标。
> 
> 要更新 POM 中的版本号，请运行：
> 
> `mvn release:update-versions`
> 
> 系统将提示您输入项目每个模块的版本号。如果您希望每个模块版本与父 POM 相同，则可以使用选项 autoVersionSubmodules。
> 
> `mvn release:update-versions -DautoVersionSubmodules=true`
> 
> 在这种情况下，只会提示您输入所需的版本号一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:31:59.857

正如 khmarbaise 所指出的，有 Tycho，它是一个 maven 插件，充当 maven 和 eclipse 插件之间的桥梁。

这两个链接提供了实现我在问题中提出的内容所需的信息：

[https://docs.sonatype.org/display/M2ECLIPSE/Staging+and+release+new+M2Eclipse+release](https://docs.sonatype.org/display/M2ECLIPSE/Staging+and+releasing+new+M2Eclipse+release)

[http://software.2206966.n2.nabble.com/Incrementing-updating-release-version-of-plugins-while-generating-p2-site-td5929658.html](http://software.2206966.n2.nabble.com/Incrementing-updating-release-version-of-plugins-while-generating-p2-site-td5929658.html)

看来您需要使用该命令

```
mvn -Dtycho.mode=maven org.eclipse.tycho:tycho-versions-plugin:set-version -DnewVersion=<version> 
```

这应该将父 pom、模块和 plugin.xml 的所有版本设置为给定的 version.lik

# ruby-on-rails - 未定义的局部变量或方法“authenticate_admin”

> ID：10789722
> 
> 赞同：0
> 
> 时间：2012-05-28T19:44:27.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图在我的博客控制器中查看我的新操作，但我不断收到以下错误消息：

```
NameError in BlogsController#new
undefined local variable or method `authenticate_admin' 
```

在我的博客控制器中，我想将新操作仅限于管理员（管理员和用户是两种不同的模型）。我能够让它在另一个模型中工作。如果我没记错的话，助手对所有班级都开放。我还尝试将我的管理员助手中的代码添加到博客助手中，但这不起作用。

**为什么我的博客控制器不能使用我的 authenticate_admin 方法？**

感谢lookign :)

以下是相关文件：

blogs_controller.rb

```
class BlogsController < ApplicationController
before_filter :authenticate_admin, :only => [:new]

  def new
    @blog = Blog.new
    @title = "New Article"
  end
end 
```

admins_helper.rb

```
def authenticate_admin
  deny_admin_access unless admin_signed_in?
end 

def deny_admin_access
  redirect_to admin_login_url, :notice => "Please sign in as admin to access this page."
end

def admin_signed_in?
  !current_admin.nil?
end

def current_admin
   @current_admin ||= Admin.find(session[:admin_id]) if session[:admin_id]
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:51:28.340

在这种情况下`Helpers`，可以在您的`Views`not in中访问`Controllers`。

解决方案是将您的方法从**admins_helper.rb**移动到`ApplicationController`并将它们设置为`helper_methods`. 您将能够在您的`Controllers`和中访问它们`Views`。

例子：

```
class ApplicationController < ActionController::Base

  # Helpers
  helper_method :authenticate_admin

  def authenticate_admin
    deny_admin_access unless admin_signed_in?
  end 

end 
```

阅读有关以下内容的文档`helper_method`：

[http://api.rubyonrails.org/classes/AbstractController/Helpers/ClassMethods.html#method-i-helper_method](http://api.rubyonrails.org/classes/AbstractController/Helpers/ClassMethods.html#method-i-helper_method)

# c# - Linq to SQL - 删除失败后刷新更改

> ID：10789723
> 
> 赞同：0
> 
> 时间：2012-05-28T19:44:30.217
> 
> 标签：c#, linq-to-sql

所以这是我的代码

```
var r = (from c in db.veClientes where c.Codigo.Equals(cod) select c).FirstOrDefault();
db.veClientes.DeleteOnSubmit(r);
try
{
    db.SubmitChanges();
}
catch
{
    r.DeBaja = 'S';
    db.SubmitChanges();
} 
```

基本上我得到一个客户端，尝试删除它，如果我不能更新客户端并将字段设置为“S”。问题是第二次 submitChanges 仍然要执行删除，又失败了，因为关系我无法删除，所以我只是禁用了该项目。如何刷新更改，以便我只更新而不是删除和更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:57:38.603

试试这种方式： -

```
var r = (from c in db.veClientes where c.Codigo.Equals(cod) select c).FirstOrDefault();
try
{
    r.DeBaja = "S";
    db.SubmitChanges();
}
catch (Exception e)
{
    Console.WriteLine(e);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:54:25.637

尝试这个：

```
try
{
    db.SubmitChanges();
}
catch
{
    db.Refresh(RefreshMode.OverwriteCurrentValues, r);
    r.DeBaja = 'S';
    db.SubmitChanges();
} 
```

# dojo - dojo 嵌套的自定义小部件未定义不是函数

> ID：10789725
> 
> 赞同：0
> 
> 时间：2012-05-28T19:44:44.397
> 
> 标签：dojo, widget, nested

我有一个叫做的小部件，`stat.widget.Weekly`它是一个`_Container`，但每当我使用时，我都会得到`require``stat.widget.Daily``Daily``new Daily()`

```
Uncaught TypeError: undefined is not a function 
```

我的代码是这样的

```
require([
 "dojo/_base/declare", "dojo/parser", ..., "stat/widget/Daily", "dijit/_Container"
 ], function(declare, ... , _WidgetBase, _TemplatedMixin, Daily, _Container){
     declare("stat.widget.Weekly", [_WidgetBase, _TemplatedMixin, _Container], {
        ....
        update: function(){
            new Daily();//< Fires Error
        },
        postCreate: function(){
            var self = this;
            setTimeout(function(){
              self.update();
            }, 500);            
        }
     });
 }); 
```

但这`stat/widget/Daily`可以在控制台中实例化`new`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T11:13:13.710

如果您的 stat.widget.Weekly 放在 stat-Modulepath/widget/Daily.js 下的文件中，则此语法在类加载器中处理起来会更流畅：

```
define([ // using define instead of require
 "dojo/_base/declare", "dojo/parser", ..., "stat/widget/Daily", "dijit/_Container"
 ], function(declare, ... , _WidgetBase, _TemplatedMixin, Daily, _Container){

 var myPrivates = declare("stat.widget._WeeklyResource", [], {
     ...
 });
 var myDefinition = declare("stat.widget.Weekly", [_WidgetBase, _TemplatedMixin, _Container], {
     ...
 });
 // returning the definition
 return myDefinition; 
```

});

# algorithm - 判断文本是否有意义的字符串搜索算法

> ID：10789732
> 
> 赞同：1
> 
> 时间：2012-05-28T19:45:10.567
> 
> 标签：algorithm

我正在解密一个旧文本，我想要一个快速算法来检查一个长字符串中是否有来自字典的有意义的单词。这样我就可以判断一个特定的键是否有效。

因此，可以使用字典预处理和大表，但在 25-50 个字符上尽可能快。

谢谢！

# 更新

我知道语言（意大利语），但文本没有空格，可能有几个随机字母。像：

> TANKSSEENNEARUDINE昨天

并且密码是一个奇怪的柱状换位，所以单个字母的频率是固定的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T20:30:06.413

密码学中的标准方法不是检查字典，而是检查明文（假定）语言的概率模型。例如，三元组的简单统计**，**即三个字符相邻的序列，在英语和胡言乱语之间存在显着差异。（在英语中，“THE”是最常见的三合词。类似地，像“CXC”这样的三合词根本不会出现在英语中。）

例如，可以通过简单的自相关方案推断密钥长度，然后根据底层明文语言的语言统计信息搜索实际密钥来破解 Vigenere 密码。当我在我们大学讲授密码学时，我什至为了演示目的实施了该程序...... :)

使用这些类型的概率/马尔可夫模型的好处是，它们还可以很好地容忍恰好在特定字典之外、有错别字、或者是替代或过时形式的单词。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T19:49:11.410

如果没有更多细节，我可能会将字典编码为 trie，并尝试匹配 haystack 字符串中的每个位置。如果您不了解尝试，它是用于快速字典查找的最佳结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T19:50:32.350

你需要缩小你的细节。想想看。如果你有很长的单词，比如 20-30 个字符，那么你需要这个字符串中所有子字符串的所有不同排列，并将它们与字典进行比较。那将是非常繁重的计算。此外，如果你有很多这样的长词，除非你在集群或其他东西上运行它，否则这将非常困难。

# c# - asp.net mvc 2.0 中的面包屑模式

> ID：10789733
> 
> 赞同：0
> 
> 时间：2012-05-28T19:45:12.523
> 
> 标签：c#, asp.net-mvc, breadcrumbs, asp.net-mvc-sitemap

我正在开发一个 asp.net mvc 2.0 应用程序，我想在其中实现面包屑模式，但我不知道如何在 asp.net 中实现它。通过浏览不同的站点，我了解了 MVCSiteMap Provider，但我不知道如何使用它以及如何使用 mvcsitemap 在 asp.net mvc 2.0 中实现面包屑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:47:09.980

不确定它在 MVC2 中是否以相同的方式工作，但这是 MVC3 的快速教程

[http://edspencer.me.uk/2011/09/20/mvc-sitemap-provider-tutorial-2-breadcrumbs/](http://edspencer.me.uk/2011/09/20/mvc-sitemap-provider-tutorial-2-breadcrumbs/)

# c++ - 通过值或引用传递 std::string

> ID：10789740
> 
> 赞同：90
> 
> 时间：2012-05-28T19:45:47.260
> 
> 标签：c++, string, std, move-semantics

> **可能重复：**
> [传递 const std::string & 作为参数的日子结束了吗？](https://stackoverflow.com/questions/10231349/are-the-days-of-passing-const-stdstring-as-a-parameter-over)

如果支持移动语义，我应该`std::string`通过值还是通过引用（到未内联函数）传递？那么使用小字符串优化（SSO）的实现呢？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-05-28T19:52:36.433

根据您对字符串的操作，有多个答案。

1）使用字符串作为id（不会被修改）。通过 const 引用传入它可能是这里最好的主意：`(std::string const&)`

2) 修改字符串但不希望调用者看到该更改。按值传递它是可取的：`(std::string)`

3) 修改字符串但希望调用者看到该更改。最好通过引用传递它：`(std::string &)`

4）将字符串发送到函数中，函数的调用者将不再使用该字符串。使用[移动语义](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)可能是一种选择`(std::string &&)`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-28T20:01:02.303

检查[C++11 这个答案](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)。基本上，如果你传递一个左值，右值引用

从[这篇文章](http://blogs.msdn.com/b/xiangfan/archive/2012/02/03/c-98-gt-c-11-pass-by-value-or-pass-by-reference.aspx)：

```
void f1(String s) {
    vector<String> v;
    v.push_back(std::move(s));
}
void f2(const String &s) {
    vector<String> v;
    v.push_back(s);
} 
```

“对于左值参数，'f1' 有一个额外的副本来传递参数，因为它是按值传递的，而 'f2' 有一个额外的副本来调用 push_back。所以没有区别；对于右值参数，编译器必须创建一个临时'String(L“”)' 并将临时值传递给 'f1' 或 'f2'。因为当参数是临时值（即右值）时，'f2' 可以利用移动 ctor，因此传递'f1' 和 'f2' 的参数现在是相同的。”

继续：“这意味着在 C++11 中，我们可以在以下情况下使用传递值方法获得更好的性能：

1.  参数类型支持移动语义 - 所有标准库组件都在 C++11 中执行
2.  移动构造函数的成本比复制构造函数便宜得多（时间和堆栈使用）。
3.  在函数内部，参数类型将被传递给另一个同时支持复制和移动的函数或操作。
4.  通常将临时参数作为参数传递 - 您可以组织代码来执行更多操作。

"

OTOH，对于 C++98，最好通过引用传递 - 更少的数据被复制。传递 const 或 non const 取决于您是否需要更改参数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-28T19:52:39.057

我相信正常的答案是，如果您需要在函数中复制它，它应该按值传递。否则通过 const 引用传递它。

这是一个很好的讨论：[http ://cpp-next.com/archive/2009/08/want-speed-pass-by-value/](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)

# python - ViewDoesNotExist at /news/ django

> ID：10789741
> 
> 赞同：1
> 
> 时间：2012-05-28T19:45:58.360
> 
> 标签：python, django, django-views, django-urls

```
Could not import photocomp.apps.news.views.news. View does not exist in module photocomp.apps.news.views. 
```

它说我在 /news/ 上没有视图，但它是：

网址.py

```
url(r'^news/', include('photocomp.apps.news.urls')), 
```

urls.py（用于新闻）

```
from django.conf.urls import patterns, include, url
from django.conf import settings

urlpatterns = patterns('',
url(r'^submit/$', 'photocomp.apps.news.views.submit'),
url(r'^success/$', 'photocomp.apps.news.views.success'),
url(r'^$', 'photocomp.apps.news.views.news'),    
) 
```

设置.py

```
INSTALLED_APPS = (
    'photocomp.apps.news',
) 
```

这是我的观点：

```
def news(request):
    news = News_Entry.objects.all().order_by('-publication')
    return render_to_response('news/news.html', {'news':news},context_instance=RequestContext(request)) 
```

什么会导致这个问题？我没有它与应用程序的其余部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:43:14.417

找到了答案。

有一个 @login_required('/login') 装饰器而不是 @login_required(login_url='/login')

# scala - 包含未接收类型的选项的列表上的Scala模式匹配？

> ID：10789743
> 
> 赞同：1
> 
> 时间：2012-05-28T19:46:12.977
> 
> 标签：scala, pattern-matching

尝试修复客户端 API 但在此处遇到问题：

```
case Some(List(Some(msgType:String), Some(channel:String), Some(data:String))) =>
        List(Some(msgType:String), Some(channel:String), Some(data:String)).foreach {
            msgType match {
              case "message" | "pmessage" => 
                fn(M(channel, data))
              case x => throw new RuntimeException("unhandled message: " + x)
            }
        } 
```

当我去编译代码时，我得到了`type mismatch; found : Any required: Some[String] => ?`错误`fn(M(channel, data))`

如何正确构建匹配以使其接收类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T21:31:39.883

让我们分解一下：

```
case Some(List(Some(msgType:String), Some(channel:String), Some(data:String))) =>
    List(Some(msgType:String), Some(channel:String), Some(data:String)).foreach { 
```

所以，在这一点上，你必须提供一个函数 from `Option[String]`to something。这是关键点：您需要将函数作为参数传递给`foreach`. 让我们继续：

```
 msgType match { 
```

您可能会认为这是一个函数——它不是。也许你明白这一点，但是，以防万一，让我解释一下这一点。函数接受一个参数并返回其他内容：它可以通过多种方式声明：

```
x => f(x) // anonymous function
{ case x => f(x) } // pattern-matching anonymous function
f _ // eta expansion of method f
f(_) // partial function application
_ + 1 // anonymous function with placeholder syntax 
```

请注意，`msgType match {`以上都不是。

现在，`msgType`这里指的是在第一种情况下匹配的内容。每次调用都将完全相同`foreach`（它将遍历`msgType`,`channel`和`data`，因此，调用传递的函数三次）。

```
 case "message" | "pmessage" => 
            fn(M(channel, data)) 
```

现在我们到达了问题的关键点。`fn(M(channel,data))`是将要传递给 的函数`foreach`，因此 的返回类型`fn`必须是`String => ???`。由于您没有提供有关`fn`or的任何信息`M`，因此我们无法评估可能出现的问题。

但是，也许你不打算`fn`返回一个函数，并且搞砸了`foreach`. 同样，你没有解释你想要完成什么，所以我无法解释如何完成它。

```
 case x => throw new RuntimeException("unhandled message: " + x)
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:02:44.230

我会做：

```
myList match {
  case Some(xs @ List(Some(msgType:String), Some(channel:String), Some(data:String))) =>
    xs.foreach {...}
  case _ => {...}
} 
```

我希望它有所帮助，即使肯定存在更清洁的方式。

# python - OpenCV 2.3.1 及更高版本中 CvTermCriteria 的 python 等效项是什么？

> ID：10789744
> 
> 赞同：5
> 
> 时间：2012-05-28T19:46:13.757
> 
> 标签：python, opencv, criteria, tracking

我正在使用 OpenCV 2.3.1 的 python 绑定，但我被卡住了。我正在尝试制作一个 LK 跟踪器。我正在使用 cv2.calcOpticalFlowPyrLK() [http://opencv.willowgarage.com/documentation/python/video_motion_analysis_and_object_tracking.html?highlight=opticalflow#calcopticalflowpyrlk](http://opencv.willowgarage.com/documentation/python/video_motion_analysis_and_object_tracking.html?highlight=opticalflow#calcopticalflowpyrlk)

它的论点之一是标准。在 C++ 中它是 CvTermCriteria。但我找不到它的 python 等价物。我猜他们在 OpenCV 2.0 之后已经停止了它。我还能用什么？它说*criteria.maxCount*或*criteria.epsilon*。但我也找不到。有什么建议么 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T20:00:14.800

Is 只是一个元组。例如：

```
(cv2.TERM_CRITERIA_EPS | cv2.TERM_CRITERIA_COUNT, 10, 0.03) 
```

# javascript - 如何知道 Chrome 窗口何时获得焦点（并且文档中有插件）？

> ID：10789747
> 
> 赞同：0
> 
> 时间：2012-05-28T19:46:30.717
> 
> 标签：javascript, google-chrome, focus, dom-events, silverlight-5.0

我有一个应用程序需要在它不处理键盘事件时通知它的用户。我一直在监视`document.hasFocus()`在 Firefox 和 IE（！）中可以满足我的需要，但在 Chrome 中却没有。

如果我从位置栏开始，则`document.hasFocus()`返回 false；当 I 时`TAB`，包含插件实例的文档获得焦点并`document.hasFocus()`返回 true；现在，如果我`TAB`再次，插件（在这种情况下为 Silverlight）获得焦点，并`document.hasFocus()`返回 false。

也许这是正确的行为，其他两个浏览器错误地返回 true，但如果是这种情况，我怎么知道浏览器窗口何时获得焦点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:08:18.210

你可以这样尝试：

```
var hasFocus = false,
    toggleFocus = function() {
        hasFocus = !hasFocus
    };
window.addEventListener( 'focus', toggleFocus );
window.addEventListener( 'blur', toggleFocus ); 
```

# php - 在 php 和 mySQL 中将 DATE 转换为 DATETIME

> ID：10789758
> 
> 赞同：0
> 
> 时间：2012-05-28T19:47:28.320
> 
> 标签：php, mysql, datetime, date

在我的 mySQL 数据库中，我有一个名为 FlowerOpen 的字段，它在我的 php 脚本中采用 DATE 格式 (YYYY-MM-DD)，我想对其进行转换，以便用户看到 2012 年 5 月 28 日星期一

我一直在寻找有关如何将 DATETIME 转换为 DATE 但不是将 DATE 转换为 DATETIME 的解释

我尝试使用以下命令转换日期：

```
$Date = DATE_FORMAT($ResultsLists['FlowerOpen'],'%W, %M %e, %Y'); 
```

我不断收到以下错误：

```
Warning: date_format() expects parameter 1 to be DateTime, string given in
C:\xampp\htdocs\Orchid\viewPlantInfo.php on line 383 
```

所以我尝试将 FlowerOpen 转换为 DATETIME，然后使用以下格式对其进行格式化：

```
$Date = date("Y-m-d H:i:s", strtotime($ResultsLists['FlowerOpen']));
$Date = DATE_FORMAT($Date,'%W, %M %e, %Y'); 
```

但我得到了同样的错误信息。

我也试过

```
$Date = SELECT CAST($ResultsLists['FlowerOpen'] AS DATETIME);
$Date = DATE_FORMAT($Date,'%W, %M %e, %Y'); 
```

但我得到了错误

```
Parse error: syntax error, unexpected T_STRING in 
C:\xampp\htdocs\Orchid\viewPlantInfo.php on line 382 (the CAST line) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:52:12.737

您可以使用以下方式通过 php 转换它[`strtotime`](http://php.net/manual/en/function.strtotime.php)：

```
echo date('l, M d, Y', strtotime($yourDate)); 
```

### [工作示例](http://codepad.org/p2ERdPEn)

```
echo date('l, M d, Y', strtotime('2012-05-29')); // Tuesday, May 29, 2012 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:13:33.383

[您可以通过使用mktime()](http://in3.php.net/manual/en/function.mktime.php)函数将 DATETIME 转换为 unix 时间戳格式将 DATETIME 存储在 mysql 中，当您从数据库中检索它时，您可以使用[date()](http://in3.php.net/manual/en/function.date.php)函数将其转换为所需的格式。

PS 在将数据时间存储到数据库之前将其转换为 unix 时间戳可以在以后使用日期时为您提供许多优势

# java - Android - 从应用程序子类中读取文本文件

> ID：10789761
> 
> 赞同：0
> 
> 时间：2012-05-28T19:47:49.863
> 
> 标签：java, android, file

我在 Application 的子类中有一个方法，需要从文本文件中读取信息。我在 Activity 的子类中使用了这个方法，它工作得很好。

```
InputStream is = this.getResources().openRawResource(R.raw.elements);
BufferedReader reader = new BufferedReader(new InputStreamReader(is));
String str = reader.readLine(); 
```

但是，如果我在 Application 子类中使用此代码，则会出现空指针异常。

文本文件位于 res/raw 文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:17:20.437

```
 private String readTxt() {

    InputStream inputStream = getResources().openRawResource(R.raw.elements);

    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

    int i;
    try {
        i = inputStream.read();
        while (i != -1) {
            byteArrayOutputStream.write(i);
            i = inputStream.read();
        }
        inputStream.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return byteArrayOutputStream.toString();
} 
```

完美运行，来源：[在 /res/raw 中显示文本文件](http://android-er.blogspot.in/2010/07/display-text-file-in-resraw_01.html "显示来自 res/raw 的文本")

# c# - 聊天 (XMPP) 消息传递平台

> ID：10789763
> 
> 赞同：0
> 
> 时间：2012-05-28T19:47:56.250
> 
> 标签：c#, xmpp, chat

我想为我的用户封装不同的消息平台（Google Talk、Facebook Chat）——当然它会使用 XMPP。

我将用 C# 编写服务器，用 Flex (AIR) 编写客户端。

*   我需要跟踪服务器中的所有消息吗？
*   通知用户新消息的最佳做法是什么？
    *   轮询？
    *   推？（C# 如何与 Flex 配合使用）

先感谢您...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T08:55:12.667

您根本不必编写服务器。您的 Flex (AIR) 客户端只能连接到 Facebooks 或 Googles XMPP 服务器。我建议从这里选择一个客户端库：http: [//xmpp.org/xmpp-software/libraries/](http://xmpp.org/xmpp-software/libraries/)并开始编码。

# asp.net-mvc-4 - MVC 4 ActionResult JsonRegister

> ID：10789764
> 
> 赞同：0
> 
> 时间：2012-05-28T19:48:33.220
> 
> 标签：asp.net-mvc-4

MVC 4 在 AccountControllers 中带有 2 个注册方法：

*   public ActionResult JsonRegister(RegisterModel 模型)
*   public ActionResult Register(RegisterModel 模型)

然而，没有办法指定在视图中使用哪一个。

**为什么需要两种方法在同一个控制器中注册用户？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T06:56:50.250

Beta 版中提供的模板将调用正确的方法，具体取决于您是使用模式对话框还是直接页面登录。该引用被硬编码在构成注册体验的视图和部分中。话虽如此，请注意，在 RTM 发布时，我们将从模板中删除基于 Ajax 的登录和注册工作流。

# java - Android - 读取输入流并保存为文件的最有效方法是什么？

> ID：10789765
> 
> 赞同：1
> 
> 时间：2012-05-28T19:48:33.543
> 
> 标签：java, android

我目前使用以下内容来读取蓝牙输入流并将其保存为文件。它适用于小文件，但对于较大的文件，它首先创建一个大字节数组。这样做的最有效方法是什么，并确保它只读取指定的长度，不多也不少？

```
 public void getAndWrite(InputStream is, long length, String filename)
            throws IOException {

        // Create the byte array to hold the data
        byte[] bytes = new byte[(int) length];

        // Read in the bytes
        int offset = 0;
        int numRead = 0;
        while (offset < bytes.length
                && (numRead = is.read(bytes, offset, bytes.length - offset)) >= 0) {
            offset += numRead;
        }

        // Ensure all the bytes have been read in
        if (offset < bytes.length) {
            throw new IOException("Could not completely read stream ");
        }

        // Write the byte array to file
        FileOutputStream fos = null;
        try {
            fos = mContext.openFileOutput(filename, Context.MODE_PRIVATE);
        } catch (FileNotFoundException e) {
            Log.e(TAG, "Problem finding internal storage", e);
        }
        try {
            fos.write(bytes);
            fos.close();
        } catch (IOException e) {
            Log.e(TAG, "Problem writing file", e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T19:59:42.023

```
int bufferSize = 1024;
byte[] buffer = new byte[bufferSize];
int remaining = length;
int read = 0;
while (remaining > 0 
       && (read = in.read(buffer, 0, Math.min(remaining, bufferSize))) >= 0) {
   out.write(buffer, 0, read);
   remaining -= read;
} 
```

请注意，以上内容确保您不会写入超过该长度的字节。但它并不能确保您准确写入长度字节。如果不读取内存中的长度字节，或者读取长度字节并写入临时文件，然后将临时文件写入最终目的地，我看不出你怎么能做到这一点。

# ios - 从视图中删除所有子图层

> ID：10789766
> 
> 赞同：60
> 
> 时间：2012-05-28T19:48:46.393
> 
> 标签：ios, objective-c, calayer

在动画中，我向视图添加了很多子**层****，**其中：

 **```
[self.view.layer addSublayer:layer1];
[self.view.layer addSublayer:layer2]; 
```

……

我想通过一个动作删除所有子层。我已经尝试过提出类似问题的建议：

```
rootLayer.sublayers = nil; 
```

但它不起作用......

你可以帮帮我吗？比你！

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2012-05-28T20:06:34.863

对象的`sublayers`属性`CALayer`返回数组的副本。将其设置为 no nil 对子层没有任何作用。然而，这会做：

```
for (CALayer *layer in self.view.layer.sublayers) {
    [layer removeFromSuperlayer];
} 
```

或者，在斯威夫特

```
self.view.layer.sublayers?.forEach { $0.removeFromSuperlayer() } 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2017-04-18T10:33:34.430

**斯威夫特 3.0 和斯威夫特 4.0**

将该`sublayers`属性设置为`nil`以从视图中删除所有子图层。

```
view.layer.sublayers = nil 
```

你也可以添加

```
.removeAll() 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-09-16T15:46:22.313

这对我有用并修复了崩溃：

```
[self.view.layer.sublayers makeObjectsPerformSelector:@selector(removeFromSuperlayer)] 
```

我用我的图像更改了视图，`UImageview`崩溃消失了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-02-09T10:27:57.217

**斯威夫特 2.0：**

```
 for layer: CALayer in self.view.layer.sublayers! {
        layer.removeFromSuperlayer()
    } 
```

或者

```
 self.view.layer.performSelector("removeFromSuperlayer") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-10-29T17:24:36.963

斯威夫特 5：

您可以删除图层本身或遍历它们并执行以下操作：

```
layer.removeAllAnimations()
layer.removeFromSuperlayer() 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-29T11:16:11.670

**让 swift5 从添加的视图中删除 CAShapeLayer**

```
for layer in self.view.layer.sublayers! {
   if layer.isKind(of: CAShapeLayer.self) {
      layer.removeFromSuperlayer()
   }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-06T12:27:15.163

**斯威夫特 4.1**

`self.view.layer.sublayers?.removeAll()`

或者如果只是在 UIView 子类中

`layer.sublayers?.removeAll()`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-07T21:41:34.313

如果您想**删除所有子图层并添加一个新子图层**，您可以轻松执行以下操作：

```
rootLayer.sublayers = [layer1] // adding one layer

rootLayer.sublayers = [layer1, layer2, ...] // adding two or more layers 
```

如果您使用`tableview`or ，这可能会有所帮助`collectionview cells`。您无需**调用**`prepareForReuse`删除.**`sublayers`**

 *** * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-08-02T16:43:27.510

SWIFT 4 中的简单一个班轮。

```
self.view.layer.sublayers.removeAll() 
```****

# facebook - 当前对话框和推荐对话框之间的区别

> ID：10789771
> 
> 赞同：0
> 
> 时间：2012-05-28T19:49:15.180
> 
> 标签：facebook, authentication, oauth

伙计们：我是 Facebook 开发的新手。我在显示我的应用程序在身份验证对话框中要求的用户详细信息时遇到问题。它始终向用户显示该应用程序将收到他的基本信息。在 Apps-->AppName--> Auth Dialog 的应用程序设置页面上，我可以看到 2 个预览对话框。一个是当前对话框，这是用户看到的，另一个是推荐对话框，这是我想向用户显示的，但我无法显示。我的问题是 2 个对话框之间的区别是什么，以及如何才能始终显示推荐对话框。

我想实现一个登录对话框，如以下站点中的登录对话框

[http://www.trippy.com/](http://www.trippy.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T23:29:20.173

标记 - 推荐对话是当应用程序用户创建和发布的链接被非应用程序用户在新闻提要、股票代码等中单击时。您可以在此处阅读确切的详细信息，在解释方面做得比我愿意。:) [https://developers.facebook.com/docs/opengraph/authentication/#referrals](https://developers.facebook.com/docs/opengraph/authentication/#referrals)

# c# - 扩展的 ASCII 字符，例如欧元符号被转换为其 unicode 等价物

> ID：10789773
> 
> 赞同：1
> 
> 时间：2012-05-28T19:49:23.523
> 
> 标签：c#, .net, string, ms-access, character-encoding

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:55:47.267

The fact that these two lines:

```
reader.GetValue(i).ToString()                  -> "€"
reader.GetValue(i).ToString().ToCharArray()[0] -> 8364 '€' 
```

do what you want tells me we can stop looking at data-access and MS Access, 'cos that is all working fine. The problem is simply: writing that to a file. The trick, then, is to be explicit when you create the `StreamWriter`. If you look at the `StreamWriter` constructors, you'll see that some take an `Encoding`. If you leave it blank, **it will default to UTF-8**. So: don't leave it blank. Explicitly pass in your chosen `Encoding`. I would recommend you figure out **exactly** which code-page you mean, and use:

```
const int CodePage = ....; // TODO: only you know this
var enc = Encoding.GetEncoding(CodePage);
using(var file = File.Create(path))
using(var writer = new StreamWriter(file, enc)) {
   ... // write the contents
} 
```

You could also use `Encoding.Default` (the system's default ANSI code-page), but that is a bit hit and miss.

# html - CSS3菜单布局和渐变不显示

> ID：10789777
> 
> 赞同：0
> 
> 时间：2012-05-28T19:50:03.650
> 
> 标签：html, css, gradient

我被赋予了重新创建以下菜单的任务：

![在此处输入图像描述](../Images/b39fed38c0b2d57e5e81657fedb9c2f5.png)

我只是不确定如何创建渐变。**完毕**

为什么在我的代码中看不到它？[http://jsfiddle.net/Vtr6d/](http://jsfiddle.net/Vtr6d/)

目前我有：

**CSS：**

```
.mainOptions{
    float:left;
    margin:0 20px 0 20px;
    color:#fff;
    width:500px;
    height:50px;
    background:gray;
}
.mainOptions .composer{
    width:50px;
    height:40px;
    background:-webkit-gradient(linear, 0 0, 0 100%, from(#184C82), to(#022243));
}
.mainOptions .composerIcon{
    display:inline-block;
    width:14px;
    height:14px;
    background:url('../images/composer.png') no-repeat -96px -72px;
}
.mainOptions ul li{
    display:inline-block;
    padding:4px 10px 4px;
    border-radius:4px;
}
.mainOptions li a{
    text-decoration:none;
    font-size:13px;
    line-height:18px;
    text-align:center;
    vertical-align:middle;
}
.mainOptions li{
    width:140px;
    background-color:pink;
} 
```

**HTML：**

```
<nav class="mainOptions">
                <ul>
                    <li class="composerIcon composer"><a href="#" style="margin-top: 2px; padding-top: 5px; padding-bottom: 5px;">Composer</a></li>
                    <li><a href="#">Address Books</a></li>
                    <li class="active"><a href="#" target="_self" title="View Messages Scheduled for Future Delivery">Scheduled Messages</a></li>
                    <li><a href="#" target="_self" title="Message Templates for you or your organisation">Templates</a></li>
                </ul>
            </nav> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T09:42:55.000

试试这个在所有浏览器中工作。

```
background: #184c82; /* Old browsers */
background: -moz-linear-gradient(top,  #184c82 0%, #022243 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#184c82), color-stop(100%,#022243)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  #184c82 0%,#022243 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  #184c82 0%,#022243 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  #184c82 0%,#022243 100%); /* IE10+ */
background: linear-gradient(top,  #184c82 0%,#022243 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#184c82', endColorstr='#022243',GradientType=0 ); /* IE6-9 */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:08:41.697

```
background-image:       -webkit-linear-gradient(linear,0%,0%,0%,100%,from(#3388FF),to(#296DCC));
background-image:       -webkit-linear-gradient(top,#3388FF,#296DCC);
background-image:       -ms-linear-gradient(top,#3388FF,#296DCC);
background-image:       -o-linear-gradient(top,#3388FF,#296DCC);
background-image:       -moz-linear-gradient(top,#3388FF,#296DCC);
background-image:       linear-gradient(top,#3388FF,#296DCC); 
```

对于浏览器兼容性问题，请使用所有这些

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:10:59.217

使用梯度生成器？[http://gradients.glrzad.com/](http://gradients.glrzad.com/)

您也可以手动执行此操作：

```
background-image: linear-gradient(bottom, <color1> 5%, <color2> 53%, <color3>  77%);
background-image: -o-linear-gradient(bottom, <color1> 5%, <color2> 53%, <color3> 77%);
background-image: -moz-linear-gradient(bottom, <color1> 5%, <color2> 53%, <color3> 77%);
background-image: -webkit-linear-gradient(bottom, <color1> 5%, <color2> 53%, <color3> 77%);
background-image: -ms-linear-gradient(bottom, <color1> 5%, <color2> 53%, <color3> 77%);

background-image: -webkit-gradient(
    linear,
    left bottom,
    left top,
    color-stop(0.05, <color1>),
    color-stop(0.53, <color2>),
    color-stop(0.77, <color3>)
); 
```

有`<color1>`,`<color2>`和`<color3>`三种`rgb(x,y,z)`颜色。您还可以编辑百分比以满足您的需要。

# ruby-on-rails - 设置依赖于关联模型的 rails 活动记录 default_scope 顺序

> ID：10789779
> 
> 赞同：2
> 
> 时间：2012-05-28T19:50:13.610
> 
> 标签：ruby-on-rails, postgresql, activerecord, associations

我有两个模型，发布和评论。每个帖子都有很多评论。我想订购我的帖子，哪个帖子有最新的评论。

我正在尝试在我的 Post 模型上设置 default_scope，如下所示：

```
default_scope :order => 'posts.comments.last.updated_at DESC' 
```

. . 但是当我尝试这样做时，我得到了一个 PGError。我应该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T22:15:15.380

用这个

```
default_scope.joins(:comments).find(:all, :order => 'comments.updated_at DESC', :group => 'id') 
```

这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:04:15.480

尝试这个：

```
default_scope :joins => :comments, :order => 'comments.updated_at DESC', :group => 'id' 
```

# java - 从系统加载 HTML 文件时出现 MalformedURLException

> ID：10789784
> 
> 赞同：0
> 
> 时间：2012-05-28T19:50:57.093
> 
> 标签：java, url, jeditorpane, malformedurlexception

所以我正在开发一个浏览器（只是因为），我不断得到一个`java.net.MalformedURLException`. 我正在尝试将 a`JEditorPane`的页面设置为从我的计算机加载的文件。这是代码：

```
 public Browser() {
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setSize(500, 500);
    URLField = new JTextField("Enter the full address of the website:");
    displayWindow = new JEditorPane();
    try {
        homeURL = new URL(getCurrentDirectory() + "/resources/home.html");
        displayWindow.setPage(homeURL);
    } catch (IOException e) {
        e.printStackTrace();
    }
    tabs = new JTabbedPane();
    tabs.addTab("Home", displayWindow);

    add(URLField, BorderLayout.PAGE_START);
    add(displayWindow, BorderLayout.CENTER);
} 
```

这是我得到的错误：

```
java.net.MalformedURLException: unknown protocol: x
    at java.net.URL.<init>(Unknown Source)
    at java.net.URL.<init>(Unknown Source)
    at java.net.URL.<init>(Unknown Source)
    at net.sourceforge.whowantsakookie.browser.Browser.<init>(Browser.java:25)
    at net.sourceforge.whowantsakookie.browser.Browser.main(Browser.java:42) 
```

它所指的行是第 25 行和第 42
行。第 25 行：

```
homeURL = new URL(getCurrentDirectory() + "/resources/home.html"); 
```

第 42 行：

```
Browser browser = new Browser(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T01:09:32.893

1.  建立一个`File`对象。
2.  检查它是否存在（健全性检查）。
3.  `URL url = file.toURI().toURL();`

请注意，这样做将确保文件名/路径中的空格字符等内容被正确编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:55:03.313

看起来您没有在 JTextField 中提供的 url 之前输入字符串“http://”。请检查。

# android - 为什么 OpenGL-ES 调整大小的图像看起来像素化？

> ID：10789785
> 
> 赞同：1
> 
> 时间：2012-05-28T19:51:08.230
> 
> 标签：android, opengl-es

我正在使用 OpenGL ES 为 android 开发相当简单的 2D 游戏。我希望它可以在市场上几乎所有的设备上运行。我面临的问题是，当我映射我使用的纹理时。如果我要映射的图像与其目标对象的大小不同，则图像质量会降低（即使图像的大小大于对象），它也会被像素化。我想要非常清晰的图像，接收它们的唯一方法是使用相同尺寸的纹理和对象。但在这种情况下，我需要 4,5 个纹理来代表不同尺寸的同一图像，以支持足够的屏幕分辨率。我正在使用 PNG 图像和以下 GL 方法：

```
glClear(GL10.GL_COLOR_BUFFER_BIT);
glEnable(GL10.GL_TEXTURE_2D);
glEnable(GL10.GL_BLEND);
glBlendFunc(GL10.GL_SRC_ALPHA, GL10.GL_ONE_MINUS_SRC_ALPHA);
//drawing happens here
glDisable(GL10.GL_BLEND); 
```

创建这么多图像对我来说没有问题，但是游戏的大小会变大。我做错了什么，或者只是 OpenGL 不能像 Photoshop 那样调整图像的大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:10:30.637

您是否尝试过其他采样选项，例如 GL_NEAREST 或 GL_LINEAR？（见`glTexParameteri`）。

我不认为这是 opengl 的错，但是当您显示的纹理不是其原始分辨率（或它的偶数倍）时，总会有一些准确性损失（因为图像必须重新采样非-像素边界）。GL_LINEAR 可能会以稍微模糊为代价来减轻一些像素化的外观，这可能会或可能不会被注意到。

# php - Jpgraph 图像添加到 zip 文件时未完全加载

> ID：10789788
> 
> 赞同：0
> 
> 时间：2012-05-28T19:51:29.553
> 
> 标签：php, jpgraph

PHP 应用程序应将使用 jpgraph 生成的图形添加到 zip 文件中：

```
$zip_obj = new ZipArchive;
$res = $zip_obj->open("../temp/$zip", ZipArchive::CREATE);
if ($res === TRUE) {
    $str = file_get_contents(urldecode($url));
    $zip_obj->addFromString($file, $str);
    $zip_obj->close();
} 
```

加载的图像总是被截断，如下所示：

[http://scfs.anieltec.com.br/temp/colheita.jpg](http://scfs.anieltec.com.br/temp/colheita.jpg)

在`$url`浏览器上加载时，图像会正确加载。

# c# - 从 for 循环中的表中选择

> ID：10789790
> 
> 赞同：0
> 
> 时间：2012-05-28T19:51:41.880
> 
> 标签：c#, sql, select

```
for (int i = 0; i < final_query.Length; i++)
{
   con.Open();

   SqlCommand cmd=new SqlCommand("SELECT * fROM TableFFF WHERE Data="+final_query[i]);

   SqlDataReader rdr = cmd.ExecuteReader();

   while (rdr.Read())
   {
      string PatientName = (string)rdr[" Data "];
   }
} 
```

我得到了那个错误

> ExecuteReader：连接属性尚未初始化。

在这条线上

```
SqlDataReader rdr = cmd.ExecuteReader(); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:54:51.543

您需要将连接传递给 SqlCommand

```
SqlCommand cmd=new SqlCommand("SELECT * fROM TableFFF WHERE Data="+final_query[i], con); 
```

但是还有其他错误：

*   对 con.Open() 的调用应该在 For 循环之外
*   使用和重用参数，而不是字符串连接

    ```
    con.Open();   
    SqlCommand cmd=new SqlCommand("SELECT * fROM TableFFF WHERE Data=@data", con);   
    cmd.Parameters.AddWithValue("@data", 0); // Supposing final_query[i] is an Int32
    for (int i = 0; i < final_query.Length; i++)   
    {   
        cmd.Parameters["@data"].Value = final_query[i];   
        SqlDataReader rdr = cmd.ExecuteReader();   
        while (rdr.Read())   
        {   
            string PatientName = (string)rdr[" Data "];   
        }   
    } 
    ```

而且在第一轮之后你还不清楚你打算用 PatientName 做什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:57:05.733

您没有告诉 sqlcommand 使用连接 con 尝试

```
SqlCommand("SELECT * fROM TableFFF WHERE Data="+final_query[i], con); 
```

虽然这似乎不是很好的编码，并且可以使用一些重新设计......

# django - Django同步数据库完整性错误

> ID：10789792
> 
> 赞同：1
> 
> 时间：2012-05-28T19:51:44.027
> 
> 标签：django, heroku

我试图将我的应用程序部署到heroku 我正在使用sqlite，所以我将设置更改为postgreSQL，我有一些初始数据initial_data.json 然后我删除了它但是当我尝试syncdb时我不断收到这个错误即使没有任何初始数据.

```
 File /usr/local/lib/python2.6/site-packages/django/db/backends/postgresql_psycopg2/base.py, line 44, in execute
    return self.cursor.execute(query, args)
django.db.utils.IntegrityError: duplicate key value violates unique constraint auth_permission_content_type_id_key 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:27:41.783

实际上，在查看之后，我发现我有一个权限，我自定义添加，当我删除它时它可能会引起冲突！

# xsd - 我可以要求 XML 属性具有值吗？

> ID：10789808
> 
> 赞同：0
> 
> 时间：2012-05-28T19:53:30.463
> 
> 标签：xsd, xml-validation

这是我想在我的模式中定义的 XML 的（部分）。我已经为元素的`name`属性添加了唯一约束。`<add />`

```
<parameters>
  <add name="one" value="1" />
  <add name="two" value="2" />
</parameters> 
```

但是不知道怎么预防`<add name="" value="" />`。我尝试了以下架构，但没有得到尊重：

```
<xs:attribute name="name" use="required" type="config:NonEmptyString" />

<xs:simpleType name="NonEmptyString">
  <xs:restriction base="xs:string">
    <xs:minLength value="1" />
  </xs:restriction>
</xs:simpleType> 
```

`config`是架构的目标命名空间。

编辑：当我在 XML 编辑器中编写 XML 时，我正在使用 Visual Studio 来验证 XML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T22:29:10.257

我做了一个快速测试；从 XML 中创建了一个 XSD 并添加了您的约束：

```
<?xml version="1.0" encoding="utf-8"?>
<!--XML Schema generated by QTAssistant/XML Schema Refactoring (XSR) Module (http://www.paschidev.com)-->
<xsd:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="parameters">
        <xsd:complexType>
            <xsd:sequence>
                <xsd:element maxOccurs="unbounded" name="add">
                    <xsd:complexType>
                        <xsd:attribute name="name" type="NonEmptyString" use="required"/>
                        <xsd:attribute name="value" type="xsd:unsignedByte" use="required"/>
                    </xsd:complexType>
                </xsd:element>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>
    <xsd:simpleType name="NonEmptyString">
        <xsd:restriction base="xsd:string">
            <xsd:minLength value="1"/>
        </xsd:restriction>
    </xsd:simpleType>
</xsd:schema> 
```

我已经验证了这个 XML：

```
<parameters>
  <add name="" value="1" />
  <add name="two" value="2" />
</parameters> 
```

我有这个错误：

```
Error occurred while loading [], line 2 position 8
The 'name' attribute is invalid - The value '' is invalid according to its datatype 'NonEmptyString' - The actual length is less than the MinLength value. 
```

我会说问题在于您的 XSD 处理器，而不是 XSD 本身。也许您可以使用您正在使用的处理器更新帖子？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T20:38:27.523

Visual Studio 2010 正确地进行验证 - 它产生警告：

```
Warning 4 The 'name' attribute is invalid - The value '' is invalid according to its datatype 'config:NonEmptyString' - The actual length is less than the MinLength value. XMLFile1.xml    3   14  Miscellaneous Files 
```

但由于某种原因（错误？），它没有在 XML 编辑器中强调错误位置。

# c# - 更改 DataGridView 的数据类型

> ID：10789809
> 
> 赞同：2
> 
> 时间：2012-05-28T19:53:31.290
> 
> 标签：c#, datagridview, value-type

我已经完成了一个从 VFP 数据库中选择一些数据并将所有内容插入 DataGrid 的工具。（直到这里一切正常......）此时我想更改特定列的一些值，但每次我都会收到错误，说类型不正确，因为需要“十进制”并且我正在插入一些字符串。 ..

我会用一个例子来解释。有一列包含行 ID，然后我有另一列包含所有用户 ID，依此类推。我需要的是用用户名更改用户 ID。（仅在我的 DataGrid 中，不在数据库中）这意味着，例如包含用户 ID“1234”的单元格更改为“John”。我的问题：在运行时包含“1234”的列被声明为“十进制”，所以我不能输入任何字符串。

我尝试使用所有这三个命令（一个一个，而不是一起使用）：

```
1) dataGrid.Columns["hot_kunde"].CellTemplate.ValueType = typeof(string);
2) dataGrid.Columns["hot_kunde"].ValueType = typeof(string);
3) for (int i = 0; i < dataGrid.RowCount; i++)
   {
       dataGrid.Rows[i].Cells[1].ValueType = typeof(String);
       dataGrid.Rows[i].Cells[1].Value = "test";
   } 
```

当我使用 MessageBox 显示新更改的类型时，它会抛出“System.String”。无论如何，当尝试使用字符串更改值时，它会引发异常（如“预期小数”之前所述）。（例如“测试”）

我错过了什么吗？

谢谢你的任何回复

* * *

## 编辑：

好的，这是我的实际代码：

```
public void SqlQuery(String SQL)
    {
        OleDbConnection conn = new OleDbConnection();
        conn.ConnectionString = "Provider=VFPOLEDB;" +
                                "Data Source=" + Properties.Settings.Default.DBCcontainer + "\\drive.dbc;" +
                                "Collating Sequence=machine;" +
                                "Password=;" +
                                "Mode=Share Deny Write;";
        conn.Open();

        OleDbCommand cmd = new OleDbCommand(SQL, conn);

        try
        {
            OleDbDataAdapter da = new OleDbDataAdapter(cmd);
            DataTable DTable = new DataTable();
            da.Fill(DTable);

            dataGrid.DataSource = DTable;
            conn.Dispose();
            conn.Close();

            dataGrid.Columns["hot_kunde"].CellTemplate.ValueType = typeof(string);
            //dataGrid.Columns["hot_kunde"].ValueType = typeof(string);
            for (int i = 0; i < dataGrid.RowCount; i++)
            {
                //MessageBox.Show(dataGrid.Rows[i].Cells["hot_kunde"].ValueType.ToString());
                //dataGrid.Rows[i].Cells[1].ValueType = typeof(String);
                dataGrid.Rows[i].Cells[1].Value = "test";
            }
        }
        catch (OleDbException e)
        {
            MessageBox.Show(e.Message + "\r\n------------------------------------------------------------\r\n\r\n" + e.Source, "OleDbException", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    } 
```

这是我传递给函数的 SQL 字符串：

```
SqlQuery("SELECT hot_erldat, hot_kunde, hot_bez, hot_text, hot_losung FROM hotges.dbf WHERE UPPER(SUBSTR(hot_bez, 1, " + sup.Length + ")) = '" + sup + "'"); 
```

好吧，在这里你看不到它，但是“hot_kunde”是用户 ID，它在数据库中定义为十进制，但我不需要用户 ID，而是需要名称。我该怎么做这个操作？

# arrays - AS3 删除对象的所有实例？

> ID：10789810
> 
> 赞同：0
> 
> 时间：2012-05-28T19:53:40.037
> 
> 标签：arrays, actionscript-3, instances

我在 AS3 中有一个游戏，其中包含一个文档类和一个自定义类，该类附加到我的 .fla 中的影片剪辑。该对象的实例每秒生成多次。我想在有 100 个实例时删除这些实例。（由于一段时间后的性能问题）实例在创建后存储在一个数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:18:15.533

当对象超过 100 个时，这将删除所有对象。

```
if(array.length > 100)
{
  for(var i:int = array.length - 1; i > -1; i--)
  {
    stage.removeChild(array[i]);// or any other parent containing instances
    array.pop();
    //array[i] = null; // if you want to make them null instead of deleting from array
  }
} 
```

* * *

提示：负循环 (i--) 的性能比正循环 (i++) 更快。
提示：pop() 的性能比 unshift() 快。

**更新**：

仅当对象超过 100 个时才会移除对象，从而导致舞台上仅剩下 100 个最后的对象。

```
if(array.length > 100)
{
  for(var i:int = array.length - 1; i > -1; i--)
  {
    if(array.length > 100)
    {
      stage.removeChild(array[i]);// or any other parent containing instances
      array.unshift();// if you want to delete oldest objects, you must use unshift(), instead of pop(), which deletes newer objects
      //array[i] = null; // if you want to make them null instead of deleting from array
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:59:11.753

您可以使用删除它们，`this.removeChild(obj);`并且 obj 是您从数组中的对象。所以你需要的是遍历数组并删除它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-29T15:27:00.110

```
/****** MyClass.as  *********/

public class MyClass extends Sprite{

    private var myVar:int=8567;

    private function myClass():void{
        //blablabla
    }

    public class destroy():void{
        myVar = null;
     this.removeFromParent(true); //method of Starling framework
    }
}

/********  Main.as  ****************/

public var myInstance:MyClass = new Myclass();

//Oh!! i need remove this instance D:

myInstance.destroy(); 
```

# javascript - ecmascript对window.onerror的使用

> ID：10789819
> 
> 赞同：2
> 
> 时间：2012-05-28T19:54:15.687
> 
> 标签：javascript

因此，我试图围绕我刚刚在*Nicholas Zakas*的“专业 Javascript”中读到的内容展开思考：它以以下代码为例：

```
window.onerror = function(message, url, line){
alert(message);
return false;
}; 
```

然后说：“通过返回 false，此函数有效地成为整个文档的 try-catch 语句，捕获所有未处理的运行时错误。此事件处理程序是防止浏览器报告错误的**最后一道防线..”**

所以我的问题是，如果遇到任何错误，这段代码会阻止脚本的执行停止吗？还是有任何错误仍会停止执行？谢谢。

* * *

编辑：也许一个更好的问题是，为什么这不是防止脚本在遇到错误时停止执行的好方法..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T19:57:11.113

一个非常简单的测试表明情况并非如此（至少对于 Chrome）：

```
window.onerror = function(message, url, line){
    alert(message);
    return false;
};
throw 'Catch this error'; 
```

没有警报，未捕获的异常出现在控制台中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:57:43.000

我相当确定无论是否忽略异常，语法错误之类的东西都会被认为是致命的。

使用这是一个坏主意，部分原因是浏览器的错误控制台中已经有一个完全足够的异常处理机制，但主要是因为如果您的网站有错误，那么在您的用户面前爆破它们不会使它们可能返回。

# ruby - 奇数除以 2 时向下舍入的原因是什么？

> ID：10789821
> 
> 赞同：1
> 
> 时间：2012-05-28T19:54:22.917
> 
> 标签：ruby, math, integer

将奇数除以 2 时看到错误会比错误的计算更好吗？

Ruby 中的示例（我猜它在其他语言中也一样，因为 int 和 float 是常见的数据类型）：

`39 / 2 => 19`

我知道输出不是 19.5，因为我们要求的是整数除以整数的值，而不是浮点数（39.0）除以整数。我的问题是，如果这些数据类型的限制阻止它计算正确的值，为什么要输出最不正确的值？

*   正确 = 19.5
*   正确的 = 20（四舍五入）
*   最不正确 = 19

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T19:57:09.137

> 看到错误不是更好吗？

抛出错误通常会适得其反，并且在大多数语言中计算效率低下。

并认为这通常是有用的行为：

```
total_minutes = 563;
hours   = total_minutes / 60;
minutes = total_minutes % 60; 
```

* * *

> *   正确 = 19.5
> *   正确的 = 20（四舍五入）
> *   最不正确 = 19

谁说 20 比 19 更正确？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:01:01.893

除其他原因之外，在除法和取模的兄弟运算符之间保持以下非常有用的关系。

商：`a / b = Q`

余：`a % b = R`

奇妙的关系：`a = b*Q + R`。

同样，整数除以二返回与右移一位和许多其他良好关系相同的结果。

但秘密，主要原因是 C 是这样做的，你根本不和 C 争论！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T10:51:57.050

如果除以 2.0，则在 Ruby 中得到正确的结果。

```
39 / 2.0 => 19.5 
```

# android - 我想在android中制作像iphone一样的时间选择器

> ID：10789831
> 
> 赞同：3
> 
> 时间：2012-05-28T19:55:51.527
> 
> 标签：android

我想在 android 中创建一个时间选择器，它应该类似于 iphone 的时间选择器，即垂直滑块。我应该怎么办？它会是一些自定义组件吗？如果是，比怎么样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T19:59:41.267

试试 Android Wheel [http://code.google.com/p/android-wheel/](http://code.google.com/p/android-wheel/)

# python - 用于情感分析的短语语料库

> ID：10789834
> 
> 赞同：5
> 
> 时间：2012-05-28T19:56:01.990
> 
> 标签：python, nlp, nltk

美好的一天，我正在尝试用python（使用朴素贝叶斯分类器）编写一个情感分析应用程序，目的是将新闻中的短语分类为正面或负面。我在为此找到合适的语料库时遇到了一些麻烦。我尝试使用“General Inquirer”（http://www.wjh.harvard.edu/~inquirer/homecat.htm），它工作正常，但我有一个大问题。由于它是一个单词列表，而不是一个短语列表，我在尝试标记以下句子时观察到以下问题：

> 预计他不会获胜。

这句话被归类为积极的，这是错误的。原因是“win”是肯定的，但“not”没有任何意义，因为“not win”是一个短语。任何人都可以针对该问题提出语料库或解决方法吗？非常感谢您的帮助和洞察力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T10:44:35.953

参见例如：Councill、McDonald 和 Velikovich 的“什么是好什么不是：学习对否定范围进行分类以改进情绪分析”

[http://dl.acm.org/citation.cfm?id=1858959.1858969](http://dl.acm.org/citation.cfm?id=1858959.1858969)

和跟进，

[http://scholar.google.com/scholar?cites=3029019835762139237&as_sdt=5,33&sciodt=0,33&hl=en](http://scholar.google.com/scholar?cites=3029019835762139237&as_sdt=5,33&sciodt=0,33&hl=en)

例如 Morante 等人 2011

[http://eprints.pascal-network.org/archive/00007634/](http://eprints.pascal-network.org/archive/00007634/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:24:58.170

在这种情况下，该作品*没有*修改短语*expecteed to win*的意思，将其颠倒过来。要识别这一点，您需要对句子进行 POS 标记并将否定副词应用于（*我*认为）动词短语作为否定。但是，我不知道是否有一个语料库会告诉您不是这种类型的修饰符。

# iphone - 压缩工作区以归档应用程序版本

> ID：10789835
> 
> 赞同：1
> 
> 时间：2012-05-28T19:56:06.733
> 
> 标签：iphone, compression, backup, versioning

**现在**（2012 年 6 月 1 日下午 6:13）：我辞职学习 git 和 github，以便进行版本控制。我不需要将（压缩）代码的副本邮寄给自己，但是在看了一天这些东西之后，我仍然不明白这种机制。

我得到了唯一标识文件的 SHA1 概念，并使用哈希的前 2 个字符作为目录名称。但我仍然对更新、指针、合并业务感到困惑。

**以前**：我有多个版本的程序，所以我可以退回到较早的版本来解决问题。

我以前喜欢压缩我正在使用的那个，然后通过电子邮件发送给自己，但是今天我这样做的时候压缩版本太小了（49 kb 而不是 6 mb）。所以我想我指的是“工作区”（应用程序上的扩展名是“.xcworkspace”）。

我可能不应该在这个问题上浪费太多时间，因为它只是一个备份，但另一方面，拥有完整大小表明整个应用程序是独立的，而不是其他地方的指针可能会被无意更改或销毁。

有什么方法可以“撤消”我当前的版本以获得所有正确的数据，还是真的很难？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:16:25.170

从个人经验来看，我同意其他评论员的观点，即 Git 是要走的路，甚至是 Mercurial。一段时间后，学习曲线会下降，尤其是在需求不高的情况下。

至于是否需要“穷人的版本控制”，有时您确实需要一个。例如，您在不允许下载和使用非公司软件的雇主工作，并且不允许将集中式 VCS 用于临时、实验或臭鼬工作。

相关帖子： [可怜的人源代码控制 zip 项目文件构建](https://stackoverflow.com/questions/7701573/poor-mans-source-control-zip-project-files-on-build)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:10:12.120

我不确定如何在不了解您的设置的情况下恢复任何更改，但我可以建议您研究一个稍微新的设置：您的电子邮件存档系统听起来像一个穷人的修订控制系统，除了比差还差，因为有很多很棒的 RCS 工具是免费的。

我建议你花一个小时左右阅读一下`git`。如果您学习了一些命令，您可以获得项目的完整更改历史记录，并可以随时跳回您喜欢的任何时间点。（然后改变历史，创建备用时间线，成为你自己的祖父母，并引发各种问题/冒险。）大多数时候，版本控制是在开发团队的环境中使用的，但它提供了很多好处，即使对于独狼。

# javascript - 谷歌地图地标不会取代旧地标

> ID：10789838
> 
> 赞同：1
> 
> 时间：2012-05-28T19:57:03.613
> 
> 标签：javascript, html, google-maps, geocoding, google-maps-markers

我正在使用谷歌地图应用程序开发一个网页，但我遇到了一些问题。就目前而言，网页有一个功能地图（没有任何图层）和一个搜索栏。我是编程新手，所以希望有一个我缺少的快速修复。

当我查找地址时，地标位于它应该在的位置。但是，当我使用不同的地址进行第二次搜索时，第一次搜索的地标仍然可见，因此屏幕上有两个地标。如何让新地标替换旧地标？

```
<script type="text/javascript">
    var geocoder;
    var map; 
    var marker;
  function initialize() {
    geocoder = new google.maps.Geocoder ();
    var latlng = new google.maps.LatLng (55.1667, -114.4000);
    var myOptions = {
      zoom: 5,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
     map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
    marker = new google.maps.Marker({map:map});
        }
    function codeAddress () {
        var address = document.getElementById ("address").value;
        geocoder.geocode ( { 'address': address}, function(results, status)                              {
        if (status == google.maps.GeocoderStatus.OK)  {
            map.setCenter(results [0].geometry.location);
            marker.setposition(results [0].geometry.location);
            map.setZoom(16);
            } 
        else {
            alert("Geocode was not successful for the following reason: " + status);
                }
    }); 
                            }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T22:02:34.310

实现您所描述的一种方法是使用全局`marker`变量。由于该`codeAddress`函数`new google.maps.Marker`每次运行时都会调用，因此您每次都会获得一个新标记。

相反，使用`setPosition`全局标记的功能来移动它。

```
 var geocoder;
    var map; 

    // ADDED
    var marker;

  function initialize() {
    geocoder = new google.maps.Geocoder ();
    var latlng = new google.maps.LatLng (55.1667, -114.4000);
    var myOptions = {
      zoom: 5,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
     map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);

     // ADDED
     marker = new google.maps.Marker({ map: map });
  }
    function codeAddress () {
        var address = document.getElementById ("address").value;
        geocoder.geocode ( { 'address': address}, function(results, status)  {
        if (status == google.maps.GeocoderStatus.OK)  {
            map.setCenter(results [0].geometry.location);

            // CHANGED
            marker.setPosition(results [0].geometry.location);

            map.setZoom(16);
        } 
        else {
            alert("Geocode was not successful for the following reason: " + status);
        }
    }); 
} 
```

# javascript - 无法从 JavaScript 中获取标签

> ID：10789851
> 
> 赞同：1
> 
> 时间：2012-05-28T19:58:12.920
> 
> 标签：javascript, html, label

我正在尝试比较 HTML 标签中的值，但无法解析它。

从这个 JS

```
document.getElementById ("00NE0000001BprW_chkbox"); 
```

我得到这个 HTML

```
img src="/img/checkbox_unchecked.gif" alt="Not Checked" width="21" height="16" class="checkImg" id="00NE0000001BprW_chkbox" title="Not Checked" 
```

我需要与标题进行比较，如果是“已检查”，就可以了。我如何与标题标签进行比较？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:01:13.373

```
if( document.getElementById('obscenely-long-id').title === "Checked") 
```

这就是你所需要的。（可选）将其转换为小写并将其与`"checked"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:01:46.823

你可以这样做：

```
if (document.getElementById("00NE0000001BprW_chkbox").title == "Checked") {
    // title matches
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:04:31.673

我怀疑您正在尝试使用某种控制台来可视化您的输出。线

```
document.getElementById ("00NE0000001BprW_chkbox"); 
```

给你一个 DOM 对象。在您的情况下，它是一个 IMG 元素。

如果你想将 title 属性与某些东西进行比较，你应该使用这个 DOM 对象的“title”属性：

```
var myImg = document.getElementById ("00NE0000001BprW_chkbox");
alert(myImg.title)); 
```

所以用

```
if( myImg.title === "Checked") { 
```

例如

[您可以在此处](http://www.javascriptkit.com/domref/elementproperties.shtml)找到 DOM 元素的其他属性。

# php - 我如何在 Joomla 的 Nano 模板 Mobile 中更改语言

> ID：10789857
> 
> 赞同：1
> 
> 时间：2012-05-28T19:59:43.453
> 
> 标签：php, templates, mobile, joomla2.5

我在 Joomla 中建立了一个网站。使用模板[Nano](http://yootheme.com/demo/)。还有一个移动模板，我正在使用。（我没有使用 Joomla 手机）。好吧..我现在已经建立了我的网站，并且网站底部有一个按钮，我可以在其中切换到桌面版本。这是用英文“切换到桌面版”写的。我想要这个丹麦语。我在哪里可以碰运气？我一直在寻找每个 php.ini 文件。doc，ini文件等。找不到它:(我偶然发现了Joomla中的语言，它在桌面网站上运行良好。有什么建议可以解决这个问题吗？

如果您有手机，可以在[此处访问该网站](http://martinehlers.dk)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T20:56:20.267

如果它在语言文件中，那么最好的办法是使用内置的 Joomla 语言覆盖来找到它。在管理员 -

1.  在扩展菜单中，单击语言管理器
2.  单击覆盖链接
3.  单击新的覆盖按钮
4.  在出现的搜索表单中搜索“切换到桌面版本”并选择值。
5.  如果它在语言文件中找到值，只需单击结果并编辑您想要的任何内容。

如果它没有在语言文件中找到它，那么您将不得不查看模板文件，它已经直接在某个地方进行了硬编码。

# ruby-on-rails - Mongoid 和 Postgres 脚手架/关系

> ID：10789859
> 
> 赞同：3
> 
> 时间：2012-05-28T20:00:10.813
> 
> 标签：ruby-on-rails, postgresql, mongodb, activerecord, mongoid

我需要某个模型来包含对文档的引用。大多数模型可以存储在 postgres 中。该模型用于游戏中的“关卡”。我想将关卡数据本身存储在文档中，这比在 sql 中制作复杂的树更有意义。

我可以使用安装了 mongoid 的 postgres；但是，在安装了 mongoid gem 之后，我似乎只能搭建 mongoid（非活动记录）文档。

问题是我引用了其他表，我不一定知道如何在 mongoid 模型中将其链接起来。

问题：

1.  如何强制使用活动记录而不是 mongoid 进行脚手架，反之亦然。 **编辑：**部分回答在这里：[在 Mongoid 安装后使用 Active Record 生成器？](https://stackoverflow.com/questions/6372626/using-active-record-generators-after-mongoid-installation)（第二个答案有效，但我不知道如何轻松地来回走动）

2.  有没有一种简单的方法可以从活动记录模型中引用文档（我知道文档说不要混合它们，但它非常适合我想要做的事情）。

3.  如果无法混合它们，那么我应该如何从 postgres/活动记录表中引用文档。换句话说，我怎样才能同时获得两条数据？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T15:24:32.187

关于您的第一个问题，理想的解决方案将类似于引用帖子中第一个答案的内容。但是，不是生成迁移，而是生成模型。因此，当您想要一个 Active Record 模型时，只需运行：

```
rails g active_record:model 
```

至于您的第二个和第三个问题，要将 Active Record 模型与 Mongoid 文档相关联，只需将 ObjectId 作为字符串存储在模型中。然后，当您检索记录时，从字符串中创建一个新的 ObjectId 并使用它来查询相关文档。

您可以像这样从字符串中创建对象 ID：

```
BSON::ObjectId.from_string("object_id_string") 
```

在 ActiveRecord 和 Mongoid 之间混合和匹配时，没有一种简单的方法可以轻松地遵循内部关系，所以恐怕必须通过 Ruby 代码来完成。

您在 rails 中定义的模型要么扩展一个 ORM 的基类，要么扩展另一个，并且它们彼此不知道。可能有一些项目可以作为这些 ORM 之上的一个层，但我不熟悉目前存在的任何项目。

# php - 在表单中搜索字段，然后对所有选择的结果执行某些操作

> ID：10789862
> 
> 赞同：0
> 
> 时间：2012-05-28T20:00:31.410
> 
> 标签：php, javascript, jquery, ajax

我想为用户提供打开使用 PHP/HTML 构建的表单的功能，然后在该表单上有一个框，允许他们搜索员工然后希望将表单发送到此阶段，而无需在此阶段提交表单。

他们将获得一个搜索框，允许他们输入姓名或零件名称，然后查询会找到与输入字符串匹配的所有员工，然后他们选择正确的员工并将该受访者添加到列表中，然后他们搜索下一个员工等等，直到他们添加了他们喜欢的数量。

一旦他们选择了名称，他们就会在表单上填写一些其他标准字段，然后在“表单”表中为每个发送的请求创建一个单独的条目。

很高兴如何在将其输入数据库等方面进行最后一部分以及如何在 PHP/MySQL 中进行“正常”搜索，但是我应该如何在表单中进行搜索并添加到预提交列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:11:59.187

您正在寻找的技术是 AJAX，它使用 javascript 在输入时检查表单字段，与 php 对话，获取数据，然后将其显示给用户，而无需重新加载页面或提交表单。您描述的确切内容称为自动完成，有许多预构建的[工具](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)用于（或者您可以使用一些 js 知识构建自己的自定义工具）。我不会尝试在此处发布所有代码，因为它会相当长且涉及，但如果您搜索这些术语，您肯定会找到您需要的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:12:36.693

这一切都可以通过 Javascript 来实现。

如果您有少量员工，您可以发送带有页面的员工数组。在表单字段中使用“onchange”事件，以便在每次按键时运行查找匹配员工与键入的文本。

您的员工数量可能不够少，而且我不确定最佳实践倡导者将您的整个公司通讯录发送到网页中！在这种情况下，您将需要在页面中使用 Javascript ajax 调用来执行相同的操作。在每次按键时，向服务器发出一个请求，请求匹配文本字符串的员工。

您将需要在另一个允许选择的表单小部件中动态显示匹配的员工，或者可能作为带有复选框的文本等。

有一些插件可以管理所有客户端部分，但您仍然需要组合自己的 Web 服务来进行员工查找。

# php - PHP变量有一个数字，我如何获得以0开头的数字

> ID：10789864
> 
> 赞同：-3
> 
> 时间：2012-05-28T20:00:44.297
> 
> 标签：php, arrays

我有这个变量`$day = 5;`我想把它变成这样的数组

```
$array = array(0 => 0, 1 => 1, 2 => 2, 3 => 3, 4 => 4, 5 => 5); 
```

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:02:05.963

查看[`range()`](http://php.net/range)功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:02:21.197

```
$array = range(0,$day); 
```

旧的，基于 1 的解决方案：

~~$array = array_combine(range(1,$day),range(1,$day);~~

# javascript - 将 Javascript .js（调用 Web 服务）异步加载到页面中

> ID：10789871
> 
> 赞同：1
> 
> 时间：2012-05-28T20:01:40.070
> 
> 标签：javascript, asp.net, ajax

**JScript.js 文件**

```
function Helloworld() {
$(document).ready(function () {
    $.ajax
    ({
        type: "POST",
        url: "Default.aspx/Helloworld",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        async: true,
        cache: false,
        success: function (msg) {
            document.getElementById('textbox').value = msg.d;
        }
    })
}); 
```

}

**默认.aspx**

```
 <head runat="server">
    <script src="jquery-1.7.1.min.js" type="text/javascript"></script>

   //Works Fine when I uncomment this 
   <%--  <script src="JScript.js" type="text/javascript"></script>--%>

    <script type="text/javascript" language="javascript">
        (function () {
        var load = document.createElement('script');
        load.type = 'text/javascript';
        load.src = 'JScript.js';
        load.async = true;
        (document.getElementsByTagName('head')[0] ||    document.getElementsByTagName('body')   [0]).appendChild(load);
    })();
    </script>
    </head>
    <body>
        <form id="form1" runat="server">
            <input type="input" id="textbox" />
    </form>
    </body> 
```

**默认.aspx.cs**

```
protected void Page_Load(object sender, EventArgs e)
{
    Page.ClientScript.RegisterStartupScript(this.GetType(), "KeyHelloworld", "<script type='text/javascript'>Helloworld()</script>");
}

[WebMethod(EnableSession = true)]
public static string Helloworld()
{
    return "Hello World";
} 
```

我正在尝试将此 JavaScript 文件异步加载到页面中，但上面的函数未执行是异步加载 JavaScript 文件的完整代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:19:13.977

我看到的一个明显问题是你正在将你的程序嵌入`$(document).ready()`到`Helloworld()`日常工作中。相反，取出`$(document).ready()`. 据推测，如果您正在调用 RegisterStartupScript，您希望在文档准备好时执行该 Javascript，从而使您的问题变得`$(document).ready()`多余并且可能是您的问题，因为在您的例程被触发`$(document).ready()`之前可能已经被调用。`Helloworld()`

因此，更改为以下代码，看看它是否有帮助：

```
function Helloworld() 
{
    $.ajax
    ({
        type: "POST",
        url: "Default.aspx/Helloworld",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        async: true,
        cache: false,
        success: function (msg) {
            document.getElementById('textbox').value = msg.d;
        }
    })
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:25:36.177

您似乎异步加载脚本，但同步调用它。输出 HTML 将在哪里`Page.ClientScript.RegisterStartupScript`登陆？

您需要为动态添加的脚本安装负载处理程序：

```
 ...
    load.async = true;
    load.onload = function() {
        Helloworld(); // execute when loaded?
    };
    ... 
```

或者直接执行，即去掉`Helloworld`.

# c# - 在中等信任主机上使用quartz.net

> ID：10789875
> 
> 赞同：1
> 
> 时间：2012-05-28T20:02:01.533
> 
> 标签：c#, .net, scheduling, quartz.net, quartz.net-2.0

我需要在我的 .NET MVC 网站上进行调度功能，我遇到了 Quartz.net 库，它可以完全满足我的需要。

问题是我在主机（GoDaddy）上运行我的网站，当我添加`Quartz.net 2.0.1`到我的项目时，我遇到了`"that assembly does not allow partially trusted callers"`异常。经过一番研究，我发现很多人都有同样的问题，有些人通过从 Quartz.net 中删除 Common.Logging 库解决了这个问题。

我遵循了一些建议并删除了对 Common.Logging 的所有引用，但我仍然遇到问题。看起来这还不够，现在我遇到了`Inheritance security rules violated while overriding member`异常，更多细节：

```
Inheritance security rules violated while overriding member: 
Quartz.Util.DirtyFlagMap`2<TKey,TValue>.GetObjectData
(System.Runtime.Serialization.SerializationInfo, 
System.Runtime.Serialization.StreamingContext)'.
Security accessibility of the overriding method must match the 
security accessibility of the method being overriden. 
```

看起来我真的需要在 Quartz.net 中改变一些东西才能让它工作。

有没有人以中等信任度运行 Quartz.net？如果是这样，需要做什么？可能有人可以提出一些替代方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T09:37:59.397

Steinar 的回答让我朝着正确的方向前进。在此处分享使 QuartZNet 在中等信任托管环境中工作的步骤。

QuartzNet 最初遇到了中等信任的权限问题，我们需要执行以下操作来解决问题

(1) 从 github 下载 QuartzNet 代码 ( 2.1.0.400 ) 并在对 AssemblyInfo.cs 进行以下更改后构建它

更换

```
#if !NET_40  
   [assembly: System.Security.AllowPartiallyTrustedCallers]  
#endif 
```

和

```
[assembly: AllowPartiallyTrustedCallers]  
#if NET_40  
   [assembly: SecurityRules(SecurityRuleSet.Level1)]  
#endif 
```

(2) 下载 C5 代码 (v 2.1) 并使用

```
[assembly: AllowPartiallyTrustedCallersAttribute() 
```

确保 C5 在与 Qartznet 相同的 .NET 版本中编译。

(3) 在 TGH 中的 web.config 中添加了 quartz 部分，该部分的 requirepermission 设置为 false。通用日志记录部分也将 requirepermission 设置为 false，还将其配置为使用 Common.Logging.Simple.NoOpLoggerFactoryAdapter。

```
<configSections>
<!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
   <sectionGroup name="common">
     <section name="logging" type="Common.Logging.ConfigurationSectionHandler, Common.Logging" requirePermission="false" />
   </sectionGroup>
   <section name="quartz" type="System.Configuration.NameValueSectionHandler, System, Version=1.0.5000.0,Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
 </configSections>
 <common>
    <logging>
      <factoryAdapter type="Common.Logging.Simple.NoOpLoggerFactoryAdapter, Common.Logging">
           <arg key="showLogName" value="true" />
           <arg key="showDataTime" value="true" />
           <arg key="level" value="OFF" />
           <arg key="dateTimeFormat" value="HH:mm:ss:fff" />
      </factoryAdapter>
    </logging>
  </common>
  <quartz>
      <add key="quartz.scheduler.instanceName" value="QuartzScheduler" />
      <add key="quartz.threadPool.type" value="Quartz.Simpl.SimpleThreadPool, Quartz"  />
      <add key="quartz.threadPool.threadCount" value="10" />
      <add key="quartz.threadPool.threadPriority" value="2" />
      <add key="quartz.jobStore.misfireThreshold" value="60000" />
      <add key="quartz.jobStore.type" value="Quartz.Simpl.RAMJobStore, Quartz" />
  </quartz> 
```

(4) 使用以namecollection为参数的构造函数初始化调度器，namecollection是从web.config中提取的quartz部分。

在 global.asax

```
QuartzScheduler.Start(); 
```

班上

```
public class QuartzScheduler
{
   public static void Start()
    {
       ISchedulerFactory schedulerFactory = new StdSchedulerFactory((NameValueCollection)ConfigurationManager.GetSection("quartz"));

       IScheduler scheduler = schedulerFactory.GetScheduler();
       scheduler.Start();

       IJobDetail inviteRequestProcessor = new JobDetailImpl("ProcessInviteRequest", null, typeof(InviteRequestJob));
       IDailyTimeIntervalTrigger trigger = new DailyTimeIntervalTriggerImpl("Invite Request Trigger", Quartz.TimeOfDay.HourMinuteAndSecondOfDay(0, 0, 0), Quartz.TimeOfDay.HourMinuteAndSecondOfDay(23, 23, 59), Quartz.IntervalUnit.Second, 1);
       scheduler.ScheduleJob(inviteRequestProcessor, trigger);
     }
  }

  public class InviteRequestJob : IJob
  {
     public void Execute(IJobExecutionContext context)
     {
        RequestInvite.ProcessInviteRequests();
     }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T09:28:53.317

我建议自己构建 Common.Logging 而不是从项目中删除它。您可以从[http://netcommon.sourceforge.net/downloads.html](http://netcommon.sourceforge.net/downloads.html)获得最新的源代码。

我猜第二个问题与 C5.dll 也不被信任有关。我也会自己建造。来源可以在这里找到：[http](http://www.itu.dk/research/c5/) ://www.itu.dk/research/c5/ 。

尽管除了构建 dll 之外还有其他选择（http://stackoverflow.com/questions/3072359/unblocking-a-dll-on-a-company-machine-how）我个人更喜欢自己构建 dll，除非我绝对信任下载的产品。

# c++ - Stack类的模板特化

> ID：10789889
> 
> 赞同：0
> 
> 时间：2012-05-28T20:04:18.397
> 
> 标签：c++, templates

我想编写类 Stack 的两个不同实现。

(1)

```
template<typename element_type, typename container_type = std::vector<element_type> >
   class Stack{//...

    }; 
```

(2)

```
template<typename element_type, size_t container_size>
   class Stack{
   }; 
```

如果我在一个文件中定义这两个实现，我会得到编译器错误。是否可以将它们都放在同一个文件中？

```
//compiler errors:

Stack.hpp:119:46: error: declaration of template ‘template<class element_type, long unsigned int container_size> int containers::Stack()’
Stack.hpp:25:9: error: conflicts with previous declaration ‘template<class element_type, class container_type> class containers::Stack’
Stack.hpp:25:9: error: previous non-function declaration ‘template<class element_type, class container_type> class containers::Stack’
Stack.hpp:119:46: error: conflicts with function declaration ‘template<class element_type, long unsigned int container_size> int containers::Stack()’ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:08:38.233

不，你不能。您不能拥有具有不同模板参数的模板类的两个版本。我建议以不同的方式调用这两种`Stack`或将它们放在不同的名称空间中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:09:02.713

你必须写这样的东西：

```
template<typename element_type, typename container_type = std::vector<element_type> >
class Stack {
  // This is *not* the specialization
};

template<typename element_type>
class Stack<element_type, std::vector<element_type> > {
  // Specialization goes here.
}; 
```

编辑：您不能更改模板参数的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:08:28.580

如果它们采用不同类型的参数，则必须给它们两个不同的名称。

# c# - 确定进程正在使用哪个网络适配器

> ID：10789898
> 
> 赞同：4
> 
> 时间：2012-05-28T20:05:10.657
> 
> 标签：c#, .net, networking

我在谷歌上看到了几个类似的问题，但没有什么完全符合我想要做的。我正在制作一个减少延迟的程序（用于游戏），它基本上会在某个进程打开时降低用户的 MTU，并在进程关闭时恢复它。但是，MTU 是特定于网络适配器的设置，有些用户有多个连接的网络适配器。为此，我认为最好让程序也检测游戏正在使用哪个适配器，并且只更改该适配器上的 MTU。

游戏一次只能使用*一个*适配器。

我无法硬编码终端服务器 IP 地址，因为它们变化相当频繁。似乎**必须**有一种方法可以在不知道最终 IP 地址的情况下确定其他进程正在使用哪个适配器，但我似乎找不到它。

**编辑**：感谢 Cicada 和 Remco，我已经解决了这个问题。

我使用了 Remco 链接到的 ManagedIPHelper 类（[ManagedIPHelper](http://www.timvw.be/2007/09/09/build-your-own-netstatexe-with-c/)），Cicada 的评论让我看到了这篇文章（[识别活动网络接口](https://stackoverflow.com/questions/359596/identifying-active-network-interface-in-net)）

将它们与一些（讨厌的，非常未优化的）LINQ 结合起来，我得到了这个代码片段，它采用进程名称并返回它正在使用的网络接口，如果找不到，则返回 null。

```
 private NetworkInterface getAdapterUsedByProcess(string pName)
    {
        Process[] candidates = Process.GetProcessesByName(pName);
        if (candidates.Length == 0)
            throw new Exception("Cannot find any running processes with the name " + pName + ".exe");

        IPAddress localAddr = null;
        using (Process p = candidates[0])
        {
            TcpTable table = ManagedIpHelper.GetExtendedTcpTable(true);
            foreach (TcpRow r in table)
                if (r.ProcessId == p.Id)
                {
                    localAddr = r.LocalEndPoint.Address;
                    break;
                }
        }

        if (localAddr == null)
            throw new Exception("No routing information for " + pName + ".exe found.");

        foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            IPInterfaceProperties ipProps = nic.GetIPProperties();
            if (ipProps.UnicastAddresses.Any(new Func<UnicastIPAddressInformation, bool>((u) => { return u.Address.ToString() == localAddr.ToString(); })))
                return nic;
        }
        return null;
    } 
```

测试证实这*非常*有效！非常感谢，伙计们！

*使用此代码段的任何人的旁注：*

*   您将需要 ManagedIpHelper 类。
*   根据具体情况，您的应用可能需要请求提升。
*   多个正在运行的进程（想想 Chrome）将返回未定义的结果。如果您打算在多进程候选情况下使用此代码，我*强烈*建议您将 **使用 (Process p = Candidates[0])**更改为更具体的过滤器，即基于 PID。
*   您可能还想隐含新的异常类型，例如，您可以更干净地捕获“无路由信息”，原因是通常只需稍等片刻即可修复此错误（让目标进程打开连接）然后重试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:39:09.833

除了蝉，这必须帮助你：

它是一些 c/c++ 代码的 C# 包装器，它可以为您提供所有打开连接的列表以及相关的 PID ( Process Id )。

[http://www.timvw.be/2007/09/09/build-your-own-netstatexe-with-c/](http://www.timvw.be/2007/09/09/build-your-own-netstatexe-with-c/)

我确实相信这是唯一的方法，根据可执行路径/名称确定进程（id）并尝试找到该进程的当前连接。

# javascript - ajax请求（xmlhttprequest）后javascript函数没有响应

> ID：10789907
> 
> 赞同：0
> 
> 时间：2012-05-28T20:06:32.983
> 
> 标签：javascript, ajax

我有以下功能：

```
$(function() { //add new language 
    var lg_select = $('#add_language');
    var table = lg_select.parent();
    var table_head = $('form[name=languageData] tr').has('th')
    $('.cv_addLang').click(function(e) {
        e.preventDefault();
        if(table_head.is(':hidden')) {
            $('.nolangauge').hide();
            table_head.show();
        }
        var new_lang = lg_select.clone();
        new_lang.find('select[disabled=disabled]').removeAttr('disabled');
        new_lang.find('select[name=new_language]').attr('name', 'language[]');
        new_lang.find('select[name=new_level]').attr('name', 'language_level[]');
        new_lang.appendTo(table).show();
    })
})

function getXMLHttpRequestObject() { //ajax
    var ajax = false;
    if(window.XMLHttpRequest) {
        ajax = new XMLHttpRequest();
    } else if(window.ActiveXObject) {
        try {
            ajax = new ActiveXObject("Msxml2.XMLHTTP");
        } catch(e) {
            try {
                ajax = new ActiveXObject("Microsoft.XMLHTTP");
            } catch(e) {
            }
        }
    }
    return ajax;
}

$(function() { //ajax
    var ajax = getXMLHttpRequestObject();
    if(ajax) {
        $('div').delegate(".but_cv_w", "click", function(e){
            e.preventDefault();
            var div_content = $(this).parent().parent();
            if(div_content) {
                var x=$(div_content).attr('id');
                //alert(x);
                //alert(div_content);
                var path = $(this).attr('href');
                //alert(path);
                ajax.open('get', path + '&ajax=true');
                ajax.onreadystatechange=function() {
                    if(ajax.readyState == 4) {
                        if((ajax.status == 200) || (ajax.status == 304)) {
                            $(div_content).html(ajax.responseText);
                        } else {
                            $(this).click;
                        }
                    }
                }
                ajax.send(null);
                return false;
            }
        })
    }
}) 
```

问题是新语言和 ajax 都工作正常但分开了。如果我删除 ajax 函数，则新语言函数正在工作，但如果我保留 ajax 函数并发出 ajax 请求，则其他函数（新语言）不再工作。接缝表明，在 ajax 请求之后，新的语言功能不会像 ajax 请求那样工作。新语言功能应该为语言添加新输入，“cv_addLang”是在正常服务器请求或ajax请求后出现在页面上的按钮的名称？

希望有人能帮我解决这个问题？？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T18:16:46.203

问题在于添加新语言功能。需要使用委托事件而不是单击事件，因此该函数应该看起来像这样才能使其工作。

```
$(function () { //add new language
$("body").delegate('.cv_addLang','click',function(e) {
    e.preventDefault();
    var lg_select = $('#add_language');
    var table = lg_select.parent();
    var table_head = $('form[name=languageData] tr').has('th');
    if(table_head.is(':hidden')) {
        $('.nolangauge').hide();
        table_head.show();
    }
    var new_lang = lg_select.clone();
    new_lang.find('select[disabled=disabled]').removeAttr('disabled');
    new_lang.find('select[name=new_language]').attr('name', 'language[]');
    new_lang.find('select[name=new_level]').attr('name', 'language_level[]');
    new_lang.appendTo(table).show();
}); 
```

})

# linux - 来自客户端 GlusterFS 的统计信息

> ID：10789909
> 
> 赞同：0
> 
> 时间：2012-05-28T20:06:43.967
> 
> 标签：linux, system, sysadmin

如何从客户端测试 GlusterFS 统计信息？即我在服务器A 上挂载了一个GFS 卷，挂载点为/mnt/volo1。有什么方法可以测试TPS、I/O读写速度等性能。在 GFS 服务器上有一个选项（gluster 卷配置文件 VOLNAME），但我希望它在客户端，就像我们为 localdisk 使用 iostat 一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T06:44:30.523

也许你应该试试[glusterg](https://github.com/gluster/gmc)，它是用 Java 编写的。

# dynamic-programming - 动态规划：查找与顺序相关的数字之和小于或等于某个数字的方式的数量

> ID：10789911
> 
> 赞同：1
> 
> 时间：2012-05-28T20:07:06.293
> 
> 标签：dynamic-programming

给定一个数字 N 和一组数字 S，找出 S 的数字的顺序相关之和小于或等于 N 的方式的数量。S 中的数字可以出现不止一次。例如，当 N = 3 且 S={1, 2} 时，答案为 6。在此示例中，1、1+1、2、1+1+1、1+2、2+1 小于或等于 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:02:16.137

When `S = {1, 2}`, the answers for `N = 0, 1, 2...` are `0, 1, 3, 6, 11, 19, 32...`. Think about why these numbers might be the same as the Fibonacci sequence with 2 subtracted.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T23:53:46.370

什么时候`S={n1, n2, …, nk}`，你有`f(N)=f(N-n1)+f(N-n2)+…+f(N-nk)`。所以你只需要计算`f(i)`，`i < nk`然后你可以很容易地`f(n)`用公式计算序列的[伴随矩阵](http://en.wikipedia.org/wiki/Companion_matrix)`(f(n),f(n+1),…,f(n+nk))=(f(0),f(1),…,f(nk))*A^n`在哪里。`A`

# jquery - 将间隔设置为 requestanimationframe

> ID：10789912
> 
> 赞同：0
> 
> 时间：2012-05-28T20:07:14.073
> 
> 标签：jquery, coffeescript, polyfills, requestanimationframe

```
class MakeCanvas
    constructor : (elemId,width,height,@slideTimeThrottled) ->      
        @ctx = document.getElementById(elemId).getContext '2d'  
        @ctx.canvas.width   = width 
        @ctx.canvas.height  = height
        @ctx.canvas.style.marginTop = (((height / 2) * -1)+(43 / 2))+'px'

        @aniInterval = null 
        clearInterval @aniInterval  
        @frameNum    = 0

    drawFrame : ->
        console.log 'drawFrame not overwritten'

    animate : ->
        clearInterval @aniInterval
        @frameNum    = 0
        @aniInterval = setInterval (=>
            @ctx.clearRect 0, 0, @ctx.canvas.width, @ctx.canvas.height
            @drawFrame()
            @frameNum++
            @stop() if @frameNum > @slideTimeThrottled
        ), frameRate
    stop    : ->
        clearInterval @aniInterval 
```

我正在使用咖啡脚本类来尝试自动化画布的一些基本功能。上面的代码在大多数情况下都可以正常工作，但我真的很想开始使用`requestanimationframe`而不是`setInterval`.

我想使用这里发布的 polyfill：[https ://gist.github.com/1579671](https://gist.github.com/1579671)

不幸的是，我只是不明白。如何重写此类以使其具有相同的功能并`requestanimationframe`改为使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:15:12.713

```
# requestAnimationFrame() shim by Paul Irish
# http://paulirish.com/2011/requestanimationframe-for-smart-animating/

window.requestAnimFrame = (->
  window.requestAnimationFrame or window.webkitRequestAnimationFrame or                         window.mozRequestAnimationFrame or window.oRequestAnimationFrame or window.msRequestAnimationFrame or (callback, element) ->
    window.setTimeout callback, 1000 / 60
)()

# Behaves the same as setInterval except uses requestAnimationFrame() where possible for better performance
# @param {function} fn The callback function
# @param {int} delay The delay in milliseconds

window.requestInterval = (fn, delay) ->

  return window.setInterval(fn, delay) if not window.requestAnimationFrame and not         window.webkitRequestAnimationFrame and not (window.mozRequestAnimationFrame and     window.mozCancelRequestAnimationFrame) and not window.oRequestAnimationFrame and not     window.msRequestAnimationFrame

  start = new Date().getTime()
  handle = {}

  theLoop = ->
    current = new Date().getTime()
    delta = current - start
    if delta >= delay
      fn.call()
      start = new Date().getTime()
    handle.value = requestAnimFrame(theLoop)  

  handle.value = requestAnimFrame(theLoop)
  return handle
# Behaves the same as clearInterval except uses cancelRequestAnimationFrame() where possible for better performance
# @param {int|object} fn The callback function

window.clearRequestInterval = (handle) ->
  (if window.cancelAnimationFrame then window.cancelAnimationFrame(handle.value) else (if     window.webkitCancelAnimationFrame then window.webkitCancelAnimationFrame(handle.value) else     (if window.webkitCancelRequestAnimationFrame then     window.webkitCancelRequestAnimationFrame(handle.value) else (if     window.mozCancelRequestAnimationFrame then window.mozCancelRequestAnimationFrame(handle.value)     else (if window.oCancelRequestAnimationFrame then     window.oCancelRequestAnimationFrame(handle.value) else (if window.msCancelRequestAnimationFrame then window.msCancelRequestAnimationFrame(handle.value)         else clearInterval(handle))))))) 
```

# jquery - 如何在延迟触发时停止第二次触摸？

> ID：10789913
> 
> 赞同：0
> 
> 时间：2012-05-28T20:07:15.073
> 
> 标签：jquery, fadein, fade, fadeout

我有这个 jquery -

```
(function(){

jQuery(window).bind('touchstart', function(){
    $('#email-info').fadeOut('2400', function() {
    });  
});

jQuery(window).bind('touchend', function(){
    $('#email-info').delay('2800').fadeIn('2400', function() {
    });    
});

})(); 
```

效果很好，但是如果我在手机处于“延迟”状态时触摸手机，它会再次快速淡入/淡出。

有没有办法阻止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:09:15.457

你试过用`.stop()`

[http://api.jquery.com/stop/](http://api.jquery.com/stop/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:21:08.267

```
jQuery(window).bind('touchend', function(){
    $('#email-info').delay('2800').stop(false,false).fadeIn('2400', function() {
    }); 
```

# c# - 如何检测失败的Windows登录

> ID：10789914
> 
> 赞同：1
> 
> 时间：2012-05-28T20:07:27.430
> 
> 标签：c#, .net, windows, security, winapi

我正在寻找检测无法登录到 Windows 的代码。

我查看了 sens.dll（ISensLogon 接口），它仅提供登录/关闭功能，但不提供错误登录时的事件。

谢谢，扎克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:48:00.247

打开对这些事件的审计并查询您程序中的安全事件日志。

# cron - 集群的 Cron

> ID：10789917
> 
> 赞同：0
> 
> 时间：2012-05-28T20:08:14.060
> 
> 标签：cron, cluster-computing

只是一个简单的问题，今天一直困扰着我。我拥有五台服务器，它们都具有完全相同的映像并在负载均衡器后面运行。我想每半小时在这些服务器上运行一个进程繁重的 cron。

我不想将 cron 放在每台机器上，因为它占用大量资源并且会阻塞所有传入连接长达 30 秒。另外，我真的不想把 cron 放在一台机器上，只是为了确保它是冗余的并且可以运行。

我对此的可能解决方案是拥有一个可以运行 cron 的远程服务，只需访问会触发它的 URL；我认为这将是目前最可行的。

我真的很好奇还有其他可用的解决方案。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:20:20.203

你可以在你的 5 台机器上设置交错的 cron 作业，所以它在你的 5 台机器上每 2.5 小时运行一次。可能最干净的方法是安排一个作业每 30 分钟运行一次，并让作业本身是一个有条件运行的脚本，具体取决于当前时间和它所在的机器。

或者，如果您有某种批处理调度系统，您可以在一个提交批处理作业的系统上运行 cron 作业，让调度系统选择使用哪个服务器。这样做的好处是，假设您的批处理系统正常工作，如果您的一台服务器停机，该作业仍应运行。您可能需要在 cron 作业中设置一些环境变量，以使其正确使用批处理系统。

# bash - 如何使用tomcat 7在嵌入的Web应用程序中运行bash脚本（linux）？

> ID：10789930
> 
> 赞同：0
> 
> 时间：2012-05-28T20:09:03.133
> 
> 标签：bash, jakarta-ee, tomcat, web-applications, root

我想用 java ee / servlets 运行一个 bash 脚本。我希望它嵌入到 web 应用程序中，在 linux 操作系统中使用 tomcat 7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:47:03.527

1.  将脚本嵌入到 web 应用程序中，例如在 war 文件的根目录中。
2.  部署应用程序后获取文件的路径：

    `String scriptPath = getServletContext().getRealPath("/script.sh");`

3.  使用 ProcessBuilder 类运行脚本：

    `new ProcessBuilder("/bin/sh", scriptPath).start();`

请注意，如果您的 servlet 容器未提取 war 文件的内容，则步骤 2 可能会失败。在这种情况下，您必须将脚本作为可用资源放在类路径中，将其内容复制到临时文件中，然后在那里运行脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:46:49.593

您必须搜索如何在 Tomcat 上启用和使用 CGI。

> CGI（通用网关接口）定义了一种 Web 服务器与外部内容生成程序交互的方式，这些程序通常被称为 CGI 程序或 CGI 脚本。

**来源：[Apache Tomcat 7 文档：CGI How To](http://tomcat.apache.org/tomcat-7.0-doc/cgi-howto.html)**

# - mxGraph

> ID：10789934
> 
> 赞同：0
> 
> 时间：2012-05-28T20:09:19.173
> 
> 标签：

mxGraph 是一个开源客户端 JavaScript 图表库，它使用 SVG 和 HTML 进行渲染。它还提供 Java 和 .NET 中的服务器端功能，以实现持久性（打开和保存）功能，以及服务器端图像生成。

# android - 未在 GridView 上单击的项目

> ID：10789935
> 
> 赞同：1
> 
> 时间：2012-05-28T20:09:25.297
> 
> 标签：android, android-gridview, android-event

我有一个 GridView，其项目是 ToggleButtons，并且我为单击项目定义了一个事件侦听器，但是当我单击它们时没有任何反应。这是听众：

```
 paintActionsGrid.setOnItemClickListener(new AdapterView.OnItemClickListener() 
    {
        public void onItemClick(AdapterView<?> parent,View view,int position,
                long id)
        { 
            ((ToggleButton)view).setChecked(true);
            paintBoardView.setPaintAction(paintActions[position]); 
        }
    }); 
```

我在监听器中放了一个断点，但没有到达，这意味着监听器根本没有被调用！有人可以告诉我有什么问题吗？这与这些项目是 ToggleButtons 的事实有关吗？如果需要，我可以附上适配器代码。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:13:01.527

单击事件由 ToggleButton 使用，因此不会传递给 GridView。类似于[这个帖子](https://stackoverflow.com/questions/6275183/android-listview-with-buttons-onitemclick-do-nothing)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T04:17:14.013

是的，问题是**ToggleButton**默认启用了可点击功能，因此您的 ItemClickListener 将不起作用。这个想法是默认情况下将 ToggleButton 的焦点设置为 false。

假设您的 ToggleButton 有一个自定义 xml，请将这一行添加到其中，

```
android:focusable="false" 
```

由于您有一个焦点元素，因此会出现此问题。试试这个简单的想法。

# javascript - 滚动过去后将 Div 粘贴到顶部

> ID：10789936
> 
> 赞同：11
> 
> 时间：2012-05-28T20:09:33.423
> 
> 标签：javascript, jquery, css, html

现在，我可以`div`在它向下滚动后将它粘在顶部，`320px`但我想知道是否有另一种方法可以实现这一点。下面我有我的代码：

```
jQuery(function($) {
    function fixDiv() {
        if ($(window).scrollTop() > 320) { 
            $('#navwrap').css({ 'position': 'fixed', 'top': '0', 'width': '100%' }); 
        }
        else {
            $('#navwrap').css({ 'position': 'static', 'top': 'auto', 'width': '100%' });
        }
    }
    $(window).scroll(fixDiv);
    fix5iv();
}); 
```

它可以工作，但`divs`它上面的一些并不总是相同的高度，所以我不能依赖`320px`. 如何在不使用的情况下使其工作，`if ($(window).scrollTop() > 320)`以便在用户滚动过去后让它在顶部淡​​入`div #navwrap`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-28T20:22:04.957

尝试使用元素`offset().top`的。`#navwrap`这样，元素将从文档中的起始位置固定，无论它在哪里。例如：

```
function fixDiv() {
    var $div = $("#navwrap");
    if ($(window).scrollTop() > $div.data("top")) { 
        $div.css({'position': 'fixed', 'top': '0', 'width': '100%'}); 
    }
    else {
        $div.css({'position': 'static', 'top': 'auto', 'width': '100%'});
    }
}

$("#navwrap").data("top", $("#navwrap").offset().top); // set original position on load
$(window).scroll(fixDiv); 
```

[**示例小提琴**](http://jsfiddle.net/5ADzD/1)

# .htaccess - .htaccess 将特定子域从 HTTPS 重定向回 HTTP

> ID：10789937
> 
> 赞同：0
> 
> 时间：2012-05-28T20:09:37.047
> 
> 标签：.htaccess

我正在使用 .htaccess 将所有请求（子域除外）从 HTTP 重定向到 HTTPS。这段代码对我来说很好：

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !=m.example.com
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

但是，它不会阻止用户手动尝试使用 HTTPS 访问子域（我拥有的 SSL 不涵盖子域并且在用于子域时显示信任错误）。

现在，我想知道：

1-如何将所有到子域的 HTTPS 请求重定向回 HTTP？

2-如何修改此代码以将子域限制动态应用于其他子域（不仅是 m.example.com）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:48:21.637

1) 如果证书不包含 m.example.com，则永远无法发送重定向，因为浏览器将拒绝建立连接。所以没有办法做到这一点。

2）因此，您希望 htaccess 做的就是将裸域重定向到 https。为此，请使用：

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^example.com$
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} 
```

我的情况下证书还包括`www.example.com`使用

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^(www.)?example.com$
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} 
```

# java - 我放入 extras 的字符串不是我取出的字符串

> ID：10789938
> 
> 赞同：0
> 
> 时间：2012-05-28T20:09:49.487
> 
> 标签：java, android, android-intent, android-activity

我正在开发一个 android 应用程序，用户可以在其中向其他用户发送“推荐”。在启动时，我运行以下方法，它查询远程数据库并检查新的引用：

```
@Override
protected void onHandleIntent(Intent intent) {
    Bundle extras = intent.getExtras();
    String username = extras.getString(WeShouldActivity.ACCOUNT_NAME);

    HttpClient httpclient = new DefaultHttpClient();

    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("user_email", username));

    String paramString = URLEncodedUtils.format(nameValuePairs, "utf-8");

    HttpGet httpget = new HttpGet("http://23.23.237.174/check-referrals?"+paramString);

    JSONObject resp = new JSONObject();
    JSONArray data = new JSONArray();

    try {

        HttpResponse response = httpclient.execute(httpget);

        InputStream is = response.getEntity().getContent();

        ByteArrayOutputStream baos = new ByteArrayOutputStream();

        int i=0;
        while(i != -1){
            i = is.read();
            baos.write(i);
        }

        byte[] buf = baos.toByteArray(); 
        //is.read(buf);

        Log.v("REFERRAL RESPONSE", new String(buf));

        resp = new JSONObject(new String(buf));

        data = resp.getJSONArray("referrals"); 

        Log.v("GETREFERRALSSERVICE", "Checking for new referrals");

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        Log.v("GETREFERRALSSERVICE", e.getMessage());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        Log.v("GETREFERRALSSERVICE", e.getMessage());
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.v("GET REFFERAL SERVICE", "JSON EXCEPTION "+e.getMessage());
    }

    String ns = Context.NOTIFICATION_SERVICE;
    NotificationManager nm = (NotificationManager) getSystemService(ns);

    int icon = R.drawable.restaurant;
    String tickerText = "New referrals!";
    long when = System.currentTimeMillis();
    Notification notification = new Notification(icon, tickerText, when);

    Context context = getApplicationContext();
    CharSequence contentTitle = "New referrals!";

    Log.v("REFERRAL DATA", data.toString());

    if(data.length() >0){
        CharSequence contentText = "You have "+data.length()+" new referrals awaiting your approval.";
        Intent notificationIntent = new Intent(this, ApproveReferral.class);
        notificationIntent.putExtra("we.should.communication.data", data.toString());
        //Log.v("AFTER EXTRAS INSERT", notificationIntent.getStringExtra("data"));
        PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);
        notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
        notification.flags = notification.flags | Notification.FLAG_AUTO_CANCEL;
        nm.notify(ActivityKey.NEW_REFERRAL.ordinal(), notification);
    } 
} 
```

因此，如果远程数据库上有任何推荐，则会弹出一条通知。单击通知会触发 ApproveReferral 活动，如下所示：

```
@Override
public void onCreate(Bundle savedInstanceState) {

    final Context c = this.getApplicationContext(); //I don't know if this is the right way to do this!
    super.onCreate(savedInstanceState);
    setContentView(R.layout.approve_referral);
    ListView lv = (ListView) findViewById(R.id.referralList);
    final List<Referral> list = new ArrayList<Referral>();
    Intent intent = this.getIntent();
    Bundle bundle = intent.getExtras();
    String dataAsString = bundle.getString("we.should.communication.data");
    Log.v("DATA EXTRA", dataAsString);
    JSONArray data = new JSONArray();
    //get referral items from extras
    try {
        data = new JSONArray(dataAsString);
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    for(int i=0; i<data.length(); i++){
        try {
            JSONObject o = data.getJSONObject(i);
            Log.v("REFFERAL OBJECT DATA", o.toString());

            JSONObject d = new JSONObject(o.getString("data"));

            list.add(new Referral(o.getString("item_name"), o.getString("referred_by"), false, d));
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            Log.v("REFERRAL OBJECT DATA", e.getMessage());
        }

    }
    Log.v("REFERRAL LIST", list.toString());
    mAdapter = new ReferralAdapter(this, list);
    lv.setAdapter(mAdapter);

    mSave = (Button) findViewById(R.id.save);
    mSave.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            List<Referral> approvedList = mAdapter.getApprovedList();

            //TODO: send approved/rejected to remote db and delete

            Referrals refs = Referrals.getReferralCategory(c);

            for(Referral r: approvedList){
                ReferralItem ref = refs.newItem(r.getData());

                try{
                    ref.save();
                } catch(Exception e) {
                    Toast.makeText(c, e.getMessage(), Toast.LENGTH_SHORT).show();
                    return;
                }

            }

            deleteRefs(list);

            finish();
        }

    });
} 
```

我一直有一个问题，我会给自己发推荐信（这是允许的，所以不是这样），或者其他人会给我发推荐信，我会收到一条通知，例如“你有 3新推荐”，但是当我打开批准推荐视图时，我只会得到 2 个。

我将其追溯到这样一个事实，即我为 ApproveReferral 添加到附加组件中的“数据”字符串不是输出的字符串。

例如

```
Log.v("REFERRAL DATA", data.toString());
notificationIntent.putExtra("we.should.communication.data", data.toString()); 
```

和 data.toString() 看起来像：

```
05-28 12:53:10.874: V/REFERRAL DATA(13610): [{"data":"{\"website:0:1\":\"http:\\\/\\\/m.imdb.com\\\/title\\\/tt0848228\",\"name:0:0\":\"The Avengers\",\"comment:1:5\":\"2012\",\"rating:3:4\":\"5.0\",\"tags:1:6\":\"[{\\\"id\\\":2,\\\"color\\\":\\\"Red\\\",\\\"tag\\\":\\\"again\\\"}]\"}","item_name":"The Avengers","referred_by":"troyschuring@gmail.com"},{"data":"{\"website:0:1\":\"http:\\\/\\\/www.edgewaterhotel.com\\\/edgewater_dining.aspx\",\"name:0:0\":\"Six Seven\",\"comment:1:5\":\"\",\"phone number:2:2\":\"(206) 269-4575\",\"rating:3:4\":\"\",\"tags:1:6\":\"[]\",\"address:1:3\":\"{\\\"long\\\":-122.352644,\\\"address\\\":\\\"2411 Alaskan Way, Seattle, WA, United States\\\",\\\"lat\\\":47.612579}\"}","item_name":"Six Seven","referred_by":"cc.emeraldeyes@gmail.com"},{"data":"{\"website:0:1\":\"http:\\\/\\\/www.paseoseattle.com\\\/\",\"name:0:0\":\"Paseo\",\"comment:1:5\":\"\",\"phone number:2:2\":\"(206) 545-7440\",\"rating:3:4\":\"5.0\",\"tags:1:6\":\"[{\\\"id\\\":1,\\\"color\\\":\\\"Purple\\\",\\\"tag\\\":\\\"Colin\\\"}]\",\"address:1:3\":\"{\\\"long\\\":-122.3501502,\\\"address\\\":\\\"4225 Fremont Avenue North, Seattle, WA, United States\\\",\\\"lat\\\":47.6586176}\"}","item_name":"Paseo","referred_by":"cc.emeraldeyes@gmail.com"}] 
```

看，有3个项目！

然后在approveReferral开始时：

```
05-28 12:53:13.877: V/DATA EXTRA(13610): [{"data":"{\"website:0:1\":\"http:\\\/\\\/m.imdb.com\\\/title\\\/tt0848228\",\"name:0:0\":\"The Avengers\",\"comment:1:5\":\"2012\",\"rating:3:4\":\"5.0\",\"tags:1:6\":\"[{\\\"id\\\":2,\\\"color\\\":\\\"Red\\\",\\\"tag\\\":\\\"again\\\"}]\"}","item_name":"The Avengers","referred_by":"troyschuring@gmail.com"},{"data":"{\"website:0:1\":\"http:\\\/\\\/www.edgewaterhotel.com\\\/edgewater_dining.aspx\",\"name:0:0\":\"Six Seven\",\"comment:1:5\":\"\",\"phone number:2:2\":\"(206) 269-4575\",\"rating:3:4\":\"\",\"tags:1:6\":\"[]\",\"address:1:3\":\"{\\\"long\\\":-122.352644,\\\"address\\\":\\\"2411 Alaskan Way, Seattle, WA, United States\\\",\\\"lat\\\":47.612579}\"}","item_name":"Six Seven","referred_by":"cc.emeraldeyes@gmail.com"}] 
```

现在只有2个。

我唯一能想到的是approveReferral，出于某种原因，是“缓存”（我把它放在引号中，因为我不熟悉android并且不确定该术语的适用性）它的附加功能并且没有使用更新的附加功能。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T21:38:17.317

事实证明，[Android 的副本一直在缓存我的 Intent 附加内容，如何声明一个保留新附加内容的待处理 Intent？](https://stackoverflow.com/questions/3140072/android-keeps-caching-my-intents-extras-how-to-declare-a-pending-intent-that-ke)，等等。

添加 FLAG_UPDATE_CURRENT 似乎已经解决了这个问题。

# objective-c - 创建一个处理枚举类型的堆栈？

> ID：10789940
> 
> 赞同：1
> 
> 时间：2012-05-28T20:10:16.870
> 
> 标签：objective-c, enums, stack

我使用了在[http://www.codeproject.com/Tips/226892/How-to-implement-Stack-in-Object-C](http://www.codeproject.com/Tips/226892/How-to-implement-Stack-in-Object-C)创建的堆栈，它可以接受任何对象，但我实际上想用它来存储一种`enum`类型。

当我试图给`enum`它赋值时，编译器说`enum`不能转换成`id`. 我应该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T20:15:25.787

如果您的堆栈存储 NSObjects，您可以简单地将枚举值转换为整数（它们是）并将它们装箱在 NSNumber 中：

**添加到堆栈：**

```
NSNumber *boxedValue = [NSNumber numberWithInteger:eMyEnumValue];
[stack push:boxedValue]; 
```

**从堆栈中检索：**

```
NSNumber *boxedValue = [stack pop];
MyEnum enumValue = (MyEnum) [boxedValue integerValue]; 
```

# python - 如何格式化数字来表示时间？

> ID：10789941
> 
> 赞同：0
> 
> 时间：2012-05-28T20:10:19.477
> 
> 标签：python, formatting

我正在寻找格式化一个简单的整数，即`1`打印出来`01:00 am`。阅读python字符串格式使它更加混乱，现在我所拥有的是`"02"`会给我`01`的，但仅此而已:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:16:05.440

您可以使用字符串格式来执行此操作。您应该使用该[`str.format()`](http://docs.python.org/library/functions.html#format)方法，这是首选方法 - 旧方法（使用模 ( `%`) 运算符）已过时，建议不要用于新代码：

```
>>> hour = 1
>>> am_pm = "am"
>>> print('{:02d}:00 {}'.format(hour, am_pm))
01:00 am 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T20:11:51.123

你总是可以使用这种格式

```
print '%02d:00 %s' % (hour, am_pm) 
```

其中`hour`包含您的整数值，以及`am_pm`相应的字符串`am`or `pm`。

还有其他格式化字符串的方法，例如，使用该`str.format`方法，但这很简单并且有效：

```
>>> am_pm = 'am'
>>> hour = 10
>>> print '%02d:00 %s' % (hour, am_pm)
10:00 am

>>> hour = 3
>>> am_pm = 'pm'
>>> print '%02d:00 %s' % (hour, am_pm)
03:00 pm 
```

# ruby-on-rails - 有很多“实时”页面更新（来自 Rails 背景）的网站使用什么工具？

> ID：10789947
> 
> 赞同：1
> 
> 时间：2012-05-28T20:10:46.770
> 
> 标签：ruby-on-rails, ruby, meteor, derbyjs

我们正计划为更多用户创建一个“大型”网站，最多可以容纳 5000 个用户。我们考虑加入大量实时功能，数据更改会立即传播到所有连接的客户端。Meteor 和 DerbyJS 等新框架看起来非常适合这类东西。

现在，我想知道是否可以使用这些新框架执行典型的后端工作，例如发送（批量）电子邮件、清理数据库、生成 pdf 等。并且以一种富有成效且不糟糕的方式。我也想知道用它们创建复杂的表格有多困难。我习惯了方便的 Rails 视图助手和 Ruby gem 来处理这些事情。

Meteor 和 DerbyJS 都是相当新的，所以我确实希望在不久的将来会添加很多功能。但是，我也想知道将这些框架与“传统”Rails 应用程序结合起来是否是个好主意，该应用程序提供某些不需要实时更新的复杂页面。和/或使用提供 API 来执行繁重后端处理的 Rails 或 Sinatra 应用程序。然后，这些 Rails 应用程序可以访问与 Meteor/DerbyJS 应用程序相同的数据库。有人认为这是个好主意吗？或者更确切地说不是？为什么？

如果对那些新的“单页应用程序实时”框架有足够经验的人可以对此发表评论，那就太好了。他们将走向何方？他们能否通过身份验证和后端处理来处理“完整”的 Web 应用程序？使用它们进行编程会像使用 Rails 一样高效/方便吗？好吧，我想没有人可以肯定地知道这一点；-) 好吧，欢迎任何想法、猜测和想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T07:12:08.627

对于发送**批量电子邮件和生成 PDF**等事情，Derby 让您只需使用普通的 Node.js 模块。npm 现在有超过 10,000 个包，因此您可能想要在服务器上执行大多数操作的包。Derby 不控制您的服务器，它可以在任何普通的 Express 服务器之上运行。您应该尽可能地坚持使用 Node.js 代码，而不是将 Rails 与 Derby 一起使用。这并不是说您不能将消息发送到单独的 Rails 应用程序，而是因为您已经必须运行一个 Node.js 应用程序来托管 Derby，您不妨将它用于此类事情。

要与此类服务器端代码进行通信，您可以使用 Derby 的模型事件。我们仍在探索这种代码是如何工作的，我们没有很多示例，但我们将有一个清晰的故事。我们正在自己构建一个与电子邮件服务器通信的应用程序，所以我们应该很快就会有一些实际的经验。

如果您不想使用 Derby 模型进行此类通信，也可以只使用普通的 AJAX 请求或通过 Socket.IO 手动发送消息。您可以使用 Express 以及您的 Derby 应用程序路由自由地创建自己的仅服务器端路由。我们认为拥有这种灵活性是很好的，以防出现我们没有正确预期框架的任何用例。

就**创建表单**而言，Derby 有一个非常强大的模板系统，我正在努力让它变得更好。我们正在开发一个新的 UI 组件功能，它可以构建独立的 UI 小部件库，这些小部件可以简单地放入 Derby 应用程序中，同时仍然可以很好地使用自动视图模型绑定和数据同步。一旦这个功能完成，我认为表单组件库会很快写出来。

我们确实希望包含普通应用程序所需的所有功能，就像 Rails 一样。它看起来不像 Rails 或像 Rails 那样工作，但它最终将具有类似的功能完整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:17:02.527

对于后端任务（例如发送电子邮件、清理数据库、生成 pdf）最好使用[resque](https://github.com/defunkt/resque)或[sidekiq](http://mperham.github.com/sidekiq/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T23:39:01.437

> 现在，我想知道是否可以使用这些新框架执行典型的后端工作，例如发送（批量）电子邮件、清理数据库、生成 pdf 等。并且以一种富有成效且不糟糕的方式。我也想知道用它们创建复杂的表格有多困难。我习惯了方便的 Rails 视图助手和 Ruby gem 来处理这些事情。
> 
> 此外，我的问题不仅与后台工作有关，还与在请求期间可以做的事情有关，例如生成 pdf，或者简单地使用 rails helper 或 gem 中的代码渲染复杂的视图。——</p>

您在这里混合了隐喻-单页应用程序只是一个无需重新加载整个页面即可加载内容的站点，可以是纯 js 的前端，也可以使用普通的 html 和 pjax。

无论您使用哪种前端框架，您所描述的事情都将在后台任务中完成。但是如果您使用的是 ruby​​，则为 sidekiq +1。

至于通知所有其他用户发生了变化，如果您不想维护 websocket 服务器，可以考虑使用[http://pusher.com](http://pusher.com)或[http://pubnub.com 。](http://pubnub.com)

# regex - 从一系列单元格中删除非数字字符

> ID：10789948
> 
> 赞同：4
> 
> 时间：2012-05-28T20:10:50.810
> 
> 标签：regex, excel, excel-formula, vba

1.  我有一个 1500 行的 excel 文件。
2.  在第一列中，我将字符与数字混合在一起（每一行都不同）。
3.  我想只留下数字并删除字母字符。

例如在`A1`我有

> **f90f5j49,35.48**

在我删除字母字符后，它应该是

> **905493548**

做这个的最好方式是什么？

我确实找到了这个[youtube 解决方案](http://www.youtube.com/watch?feature=player_embedded&v=zw3l_p37xYo)

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-29T02:09:31.383

你的方法是正确的方法。

实现这一点的最快方法是使用

*   一个[正则表达式](/questions/tagged/regexp "显示标记为“正则表达式”的问题")
*   和 VBA 中的变体数组。

使用基于我的文章的代码[Using Variant Arrays in Excel VBA for Large Scale Data Manipulation](http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/Excel/A_2684-Using-varinat-arrays-in-VBA-for-large-scale-data.html)

```
Sub KillNonNumbers()
    Dim rng1 As Range
    Dim rngArea As Range
    Dim lngRow As Long
    Dim lngCol As Long
    Dim lngCalc As Long
    Dim objReg As Object
    Dim X()

    On Error Resume Next
    Set rng1 = Application.InputBox("Select range for the replacement of non-number", "User select", Selection.Address, , , , , 8)
    If rng1 Is Nothing Then Exit Sub
    On Error GoTo 0

    'See Patrick Matthews excellent article on using Regular Expressions with VBA
    Set objReg = CreateObject("vbscript.regexp")
    objReg.Pattern = "[^\d]+"
    objReg.Global = True

   'Speed up the code by turning off screenupdating and setting calculation to manual
   'Disable any code events that may occur when writing to cells
    With Application
        lngCalc = .Calculation
        .ScreenUpdating = False
        .Calculation = xlCalculationManual
        .EnableEvents = False
    End With

    'Test each area in the user selected range

    'Non contiguous range areas are common when using SpecialCells to define specific cell types to work on
    For Each rngArea In rng1.Areas
        'The most common outcome is used for the True outcome to optimise code speed
        If rngArea.Cells.Count > 1 Then
           'If there is more than once cell then set the variant array to the dimensions of the range area
           'Using Value2 provides a useful speed improvement over Value. On my testing it was 2% on blank cells, up to 10% on non-blanks
            X = rngArea.Value2
            For lngRow = 1 To rngArea.Rows.Count
                For lngCol = 1 To rngArea.Columns.Count
                    'replace the leading zeroes
                    X(lngRow, lngCol) = objReg.Replace(X(lngRow, lngCol), vbNullString)
                Next lngCol
            Next lngRow
            'Dump the updated array sans leading zeroes back over the initial range
            rngArea.Value2 = X
        Else
            'caters for a single cell range area. No variant array required
            rngArea.Value = objReg.Replace(rngArea.Value, vbNullString)
        End If
    Next rngArea

    'cleanup the Application settings
    With Application
        .ScreenUpdating = True
        .Calculation = lngCalc
        .EnableEvents = True
    End With

    Set objReg = Nothing
End Sub 
```

# smarty - Prestashop：获取父类别的 id

> ID：10789950
> 
> 赞同：1
> 
> 时间：2012-05-28T20:11:05.850
> 
> 标签：smarty, prestashop

我在编写我的第一个 prestashop 模板时遇到了这个问题。所以我想要做的是获取同一父类别下的所有子类别的列表。所以运行 foreach 循环我需要发送父类别 ID。在互联网上没有太多关于 prestas 的编码、模块或东西的信息，但我找到了两种可能的解决方案。一个是： `{$product->id_category_default}` 但这仅适用于产品页面（？）也许我错了，有可能得到解决方案吗？另一种方式听起来有点绝望：`{$cookie->last_visited_category}` 这个问题，它仅在您直接来自父类别时才有效，但在跟随直接链接或任何其他方式时失败。我也在考虑编写 php 函数，它发送 MySQL 查询并返回父类别 ID，但这是最佳方法吗？此外，我还没有尝试在 smarty 中编写自己的 php 函数，似乎它以不同于调用函数的方式工作。

所以总结一下，有谁知道如何在没有单独的 php 函数的情况下获取父类别 ID，如果它如此绝望，在哪里以及如何为 smarty 定义自己的 php 函数以及如何调用它们。

我正在使用 prestashop 1.4。

感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T11:20:25.683

我在一个模块中使用了这段代码，你可能需要调整它，但基本上，父类别的 id 存储在数据库中。

```
$parentCategoryList = array(2, 3, 4, 5);
if(!in_array($id_category, $parentCategoryList)){
    $parentCategory = Db::getInstance(_PS_USE_SQL_SLAVE_)->ExecuteS('
        SELECT DISTINCT c.id_parent
        FROM '._DB_PREFIX_.'category c
        WHERE c.id_category = '.(int)($id_category)
    );
    $id_category_parent = $parentCategory[0]['id_parent'];
}
else{
    $id_category_parent = $id_category;
} 
```

在我的代码中，`$parentCategoryList`存储了我的主要类别的 id（将其更改为您的值）。然后它会检查您正在查看的类别 ( `$id_category`) 是否是主要类别。如果没有，它会在数据库中查找父类别。

我对使用数组手动存储主要类别并不满意，但它确实有效。

希望这可以帮助！

# c# - 如何编写可以轻松使用多个第三方 com 对象的 Windows 应用程序？

> ID：10789951
> 
> 赞同：0
> 
> 时间：2012-05-28T20:11:11.683
> 
> 标签：c#, winforms

我有一个与第三方 COM 对象紧密耦合的 Windows 应用程序。通过这个 com 对象的实例，我所做的就是创建、删除、保存和导出。现在随着新要求的出现，我必须添加另一个类似的第三方组件，但来自不同的供应商。

我不想编写与第一个类似的单独应用程序，除了第三方依赖项发生了变化。

我应该如何更改我的 Windows 应用程序，以便

1.  我可以轻松切换这些第三方依赖项。（就像松散耦合的东西）。
2.  我不需要维护单独的代码。

我需要一些指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:15:32.900

一种选择（可能不适合您）是编写一个所有插件都将继承的接口，其中包含您需要从每个 COM .dll 中实现的抽象方法。然后，每个插件都是一个实现接口的 C# 类库，并将所有调用传递给后端 COM 对象。

这意味着您将发布 3 个新的 DLL，一个包含您的接口（并被主应用程序和 .NET 类库引用），.NET 类库作为主要“插件”，然后是后端 COM。 dll也。

就像我说的那样，这只是一种方法，但可以让您以很少的开销 IMO 快速启动并运行。

* * *

简单的例子：

**IPlugin.cs** [IPlugin.dll]

```
interface IPlugin
{
    bool MethodReturningTrue();
} 
```

**YourPlugin.cs** [YourPlugin.dll，引用 IPlugin.dll]

```
class YourPlugin : IPlugin
{
    public bool MethodReturningTrue()
    {
        return true;
    }
} 
```

**PluginHost.cs** [yourapp.exe，引用 IPlugin.dll]

```
class PluginHost
{
    public static IPlugin GetPlugin()
    {
        Assembly asmbly = Assembly.LoadFrom("YourPlugin.dll");
        Type objectType = asmbly.GetType("YourPlugin");
        return (IPlugin)Activator.CreateInstance(objectType);
    }
} 
```

**PluginUser.cs** [yourapp.exe，引用 IPlugin.dll]

```
class PluginUser
{
    public bool GetTrueValueFromPlugin()
    {
        IPlugin pluginObj = PluginHost.GetPlugin();
        pluginObj.MethodReturningTrue();
    }
} 
```

当然，这依赖于“YourPlugin.dll”中名为“YourPlugin”的类。在支持多个 .dll 的生产环境中，您将枚举 .dll，加载每个程序集，并使用反射在该程序集中查找实现`IPlugin`接口的类。如果您需要插件和主机之间的双向通信，您可以创建另一个接口（即 . `IPluginHost`）并添加一个`IPlugin`接受`IPluginHost`. 然后，实现类可以存储该实例并调用方法以实现双向通信。

# security - Java EE 应用程序中的安全性

> ID：10789953
> 
> 赞同：0
> 
> 时间：2012-05-28T20:11:20.287
> 
> 标签：security, jakarta-ee

我有一个基于在 JBoss5 上运行的 EJB 3 + Struts 2 技术的应用程序。现在是时候增加安全性了。所以我在看 Spring Security 或 Apache Shiro。权限和角色计划存储在数据库中。不知道是否重要。你会建议选择什么，为什么？提前致谢。

# javascript - 正则表达式替换字符串“-”和“/”

> ID：10789954
> 
> 赞同：0
> 
> 时间：2012-05-28T20:11:21.110
> 
> 标签：javascript, jquery, regex

我有一个这样的字符串，例如：**`09223-2993/120029`**

我需要替换`-`并`/`使用正则表达式

我怎样才能做到这一点 ？

这是我所做的，正在更换工作`-`，但我找不到重新制作的方法`/`：

```
 var test = $("#myvalue").val().split("");

    for(var i=0; i < test.length; i++) {
        test[i] = test[i].replace(/-/g, '');
    }

    value2 = test.join("" );

    alert(value2); 
```

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T20:12:48.873

你真的很接近，你需要做的就是添加`/`到你的正则表达式

你应该能够做到这一点：

```
 test[i] = test[i].replace(/[-/]/g, ''); 
```

因为`-`对于正则表达式来说不是特别的，`/`所以使用上面的反斜杠转义它，或者将它放在里面`[]`来表示一个字符类。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T20:13:00.667

要在正则表达式中使用文字`/`，您必须对其进行转义。`\/`为此而写。

最终脚本应如下所示：

```
var test = $("#myvalue").val().replace(/[-/]/g,'');
alert(test); 
```

你的整个循环是完全没有必要的，所以我删除了它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T20:14:40.393

The character `/` has a special meaning in regex (you know, it encloses it `/regex/modifiers`). Special characters have to be escaped with backslash `\`.

```
test[i].replace(/\//g, 'something'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:23:03.580

As mentioned before, you have to escape a slash as `\/`. However, it might be a more robust approach to remove all characters that are not digits:

```
test[i] = test[i].replace(/\D/g, ''); 
```

`\D` is the negated version of `\d`, i.e. not digit.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-28T20:35:54.000

This only leaves the value, which might be a lot less complex

```
var value = $("#myvalue").val().replace(/[^0-9]/g, '');

alert(value); 
```

# xsd-validation - 如何使用 xsd 模式和 SAX 验证 xml？

> ID：10789956
> 
> 赞同：0
> 
> 时间：2012-05-28T20:11:30.683
> 
> 标签：xsd-validation

我将描述我的 xml 问题。

首先我用命名空间定义了我的 xsd 模式，它看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"           targetNamespace="http://www.example.org/schema"
xmlns:tns="http://www.example.org/schema" elementFormDefault="qualified">

<element name="Clients" type="tns:ClientsType"></element>

<complexType name="ContactType">
    <sequence>
        <element name="Type" type="string"></element>
    </sequence>
    <attribute name="ID" type="long" />
</complexType>

<complexType name="Contact">
    <sequence>
        <element name="ContactType" type="tns:ContactType"></element>
        <element name="Value" type="string"></element>
    </sequence>
    <attribute name="ID" type="long" />
</complexType>

<complexType name="ContactsType">
    <sequence>
        <element name="Contact" type="tns:Contact" maxOccurs="unbounded"></element>
    </sequence>

</complexType>

<complexType name="ClientType">
    <sequence>
        <element name="FirstName" type="string"></element>
        <element name="SecondName" type="string"></element>
        <element name="Contacts" type="tns:ContactsType"></element>
    </sequence>
    <attribute name="ID" type="long" />
</complexType>

<complexType name="ClientsType">
    <sequence>
        <element name="Client" type="tns:ClientType" maxOccurs="unbounded"></element>
    </sequence>
</complexType> 
```

所以它生成了明显的xml，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<tns:Clients xmlns:tns="http://www.example.org/schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/schema schema.xsd ">
<tns:Client ID="0">
    <tns:FirstName>tns:FirstName</tns:FirstName>
    <tns:SecondName>tns:SecondName</tns:SecondName>
    <tns:Contacts>
        <tns:Contact ID="0">
            <tns:ContactType ID="0">
                <tns:Type>tns:Type</tns:Type>
            </tns:ContactType>
            <tns:Value>tns:Value</tns:Value>
        </tns:Contact>
    </tns:Contacts>
</tns:Client> 
```

我的函数用数据创建特定的 xml：

```
 @Override
        public void printToFile() throws IOException, XMLStreamException {

        FileWriter fd = new FileWriter(outPath);
        Random rand = new Random();
        int end = rand.nextInt(1000);
        try{
        XMLOutputFactory xof = XMLOutputFactory.newInstance();
        XMLStreamWriter xtw = null;

    xtw = xof.createXMLStreamWriter(fd);

    xtw.writeStartDocument();

    //xtw.setPrefix("tns", "http://www.example.org/schema");
        xtw.writeStartElement("Clients");
        xtw.writeNamespace("tns", "http://www.example.org/schema");

     xtw.writeStartElement("tns","Client", "http://www.example.org/schema");
          //xtw.writeStartElement("Client");
            xtw.writeAttribute("ID", "1");
            xtw.writeStartElement("FirstName");
                xtw.writeCharacters("NameFirst");
            xtw.writeEndElement();
            xtw.writeStartElement("SecondName");
                xtw.writeCharacters("NameSecond");
            xtw.writeEndElement();
            xtw.writeStartElement("Contacts");
             for(int i=1;i<2;i++){
                    xtw.writeStartElement("Contact");
                        xtw.writeAttribute("ID",Integer.toString(i));
                        xtw.writeStartElement("ContactType");
                            xtw.writeAttribute("ID", Integer.toString(i));
                            xtw.writeStartElement("Type");
                                xtw.writeCharacters("mojTyp");
                            xtw.writeEndElement();                      
                        xtw.writeEndElement();
                            xtw.writeStartElement("Value");
                                xtw.writeCharacters("value");
                            xtw.writeEndElement();
                    xtw.writeEndElement();
             }

            xtw.writeEndElement();

        //xtw.writeEndElement();
        xtw.writeEndDocument();

    }catch(XMLStreamException xmlE)
    {

    }
    finally
    {
        fd.close();
    }

} 
```

我使用inx Sax生成简单的Junit测试来验证我的函数创建的xml：

```
@Test
public void testPrintToFileGoodXml() throws IOException,
        XMLStreamException, FactoryConfigurationError, SAXException {
    mService.printToFile();
    XMLStreamReader reader = XMLInputFactory.newInstance()
            .createXMLStreamReader(new FileInputStream(myPath));
    SchemaFactory factory = SchemaFactory
            .newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

    Schema schema = factory.newSchema(new File(mySchemaPath));
    Validator validator = schema.newValidator();

    validator.validate(new StAXSource(reader));
    assertTrue(true);
} 
```

但是测试失败了，所以我认为我的 printToFile 函数与命名空间和 xsd 模式中定义的其他属性连接存在问题，我不知道如何解决它。我阅读了许多站点和定义 xsd 的文档，但我仍然不知道如何解决我的问题。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T10:19:01.417

架构说根元素应该是 Clients

![模式的图形表示](../Images/c0835e9440461722abcb3ca078e31a1b.png)

但是，您的 XML 片段有一个开始元素 tns:Clients，但没有对应的结束元素。检查您的 writeEndElement 调用计数。

```
<?xml version="1.0" encoding="UTF-8"?>
<tns:Clients xmlns:tns="http://www.example.org/schema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.example.org/schema Contacts.xsd ">
    <tns:Client ID="0">
        <tns:FirstName>tns:FirstName</tns:FirstName>
        <tns:SecondName>tns:SecondName</tns:SecondName>
        <tns:Contacts>
            <tns:Contact ID="0">
                <tns:ContactType ID="0">
                    <tns:Type>tns:Type</tns:Type>
                </tns:ContactType>
                <tns:Value>tns:Value</tns:Value>
            </tns:Contact>
        </tns:Contacts>
    </tns:Client>
</tns:Clients> <--------- Missing 
```

# google-analytics - Analytics 中数据的最后“结束日期”

> ID：10789958
> 
> 赞同：0
> 
> 时间：2012-05-28T20:11:41.823
> 
> 标签：google-analytics, google-analytics-api

我正在使用**“报告 google Analitics API”**，但无法找到有关 Analytics 中数据的最后“结束日期”的信息。例如，假设您要检索上个月的数据。什么时候必须执行查询？当月的第一天？……还是第二个？...或者也许是第三个？

只有另一个问题：返回的数据是太平洋时间的几天吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T12:45:05.767

Google Analytics API 应该可以访问您在界面中拥有的相同数据。

谷歌表示，处理数据最多需要 24 小时。真正更新数据所需的时间取决于帐户的类型和大小。小帐户每天更新多次，并且可以在几个小时内获得数据。每月点击量达到 100 万次后，您将进入另一种模式，您帐户中的数据每天仅更新一次。即使对于大量流量，Google Analytics Premium 客户也会更频繁地进行更新。

没有办法通过 API 知道最后一次处理的准确时间。您可以按小时查询今天的数据并亲自查看。

通常你并不关心，只是想确保你查询的数据在那天得到了充分的处理。

因此，如果您查询昨天的数据，则它可能尚未完全更新，例如，如果现在是午夜，则昨天的数据只是几分钟前，可能尚未完全处理。在这种情况下，最安全的选择是查询 2 天前的数据。

因此，如果今天是 2012-06-15 并且您想要获取 1 个月的数据，那么一种安全的方法是使用`start-date=2012-05-13`和查询数据`end-date=2012-06-13`。大多数情况下，这将为您提供已完全处理的日期的数据，但它也不是 100% 安全的。谷歌分析过去曾出现过中断，数据处理时间比处理时间长，但这种情况并不常见。当您获取数据时，很难仅通过 API 判断那些日子的数据是否已被完全处理，使用 2 天前的 isea，您只会让它更有可能是。

这些天数是按照您在 Google Analytics（分析）配置文件中配置的时区设置汇总的。

# c# - 将变量推送到方法中

> ID：10789961
> 
> 赞同：0
> 
> 时间：2012-05-28T20:12:09.747
> 
> 标签：c#, .net, silverlight, windows-phone-7

我有一个 httpWebRequest 来访问 XML 并将其保存在本地，然后读取它并将其显示到屏幕上。问题是，我必须为多个“枢轴项”执行此操作，并且保存 xml 的方法是

```
private static void GetResponseCallback(IAsyncResult asynchronousResult) 
```

并且不支持向其添加新变量，因此我可以动态命名 xml ("tmp"+xmlName+".xml") 。

所以问题是：**如何在 xml 名称中推送变量？**

```
public class HttpWebReqMethod
    {

        public void httpRequestMethod (string url, string xmlName)
        {     
            HttpWebRequest httpRequest = (HttpWebRequest)WebRequest.Create(url);
            httpRequest.ContentType = "text/xml";
            httpRequest.Method = "POST";

            httpRequest.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), httpRequest);
        }

        private static void GetRequestStreamCallback(IAsyncResult asynchronousResult)
        {
            HttpWebRequest httpRequest = (HttpWebRequest)asynchronousResult.AsyncState;

            // End the operation
            Stream postStream = httpRequest.EndGetRequestStream(asynchronousResult);

            string postData = "";

            // Convert the string into a byte array.
            byte[] byteArray = Encoding.UTF8.GetBytes(postData);

            // Write to the request stream.
            postStream.Write(byteArray, 0, postData.Length);
            postStream.Close();

            // Start the asynchronous operation to get the response
            httpRequest.BeginGetResponse(new AsyncCallback(GetResponseCallback), httpRequest);
        }

        private static void GetResponseCallback(IAsyncResult asynchronousResult)
        {
            HttpWebRequest httpRequest = (HttpWebRequest)asynchronousResult.AsyncState;

            // End the operation
            HttpWebResponse response = (HttpWebResponse)httpRequest.EndGetResponse(asynchronousResult);
            Stream streamResponse = response.GetResponseStream();
            StreamReader streamRead = new StreamReader(streamResponse);
            string responseStream = streamRead.ReadToEnd();

            using (var store = IsolatedStorageFile.GetUserStoreForApplication())
            {
                using (var istream = new IsolatedStorageFileStream(@"tmp" + xmlName + ".xml", FileMode.OpenOrCreate, store))
                {
                    using (var sw = new StreamWriter(istream))
                    {
                        sw.Write(responseStream);
                    }
                }
            }

            // Close the stream object
            streamResponse.Close();
            streamRead.Close();

            // Release the HttpWebResponse
            response.Close();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T20:23:37.480

以下是您可以做的两件事：

1.  使 GetResponseCallback 不是静态的，并将**xmlName 存储在实例变量中**
2.  将一个**状态对象**（任何具有名为 xmlName 的属性，以及用于识别它的其他东西）传递给请求，您可以从`AsyncState`
3.  将 GetResponseCallback 的函数更改为以下内容，并使**整个事情成为回调“工厂”**

    ```
    private static AsyncCallback GetResponseCallback(string xmlName)
     {
        return (IAsyncResult asynchronousResult) =>{
        HttpWebRequest httpRequest = (HttpWebRequest)asynchronousResult.AsyncState;
        // End the operation
        HttpWebResponse response = (HttpWebResponse)httpRequest.EndGetResponse(asynchronousResult);
        Stream streamResponse = response.GetResponseStream();
        StreamReader streamRead = new StreamReader(streamResponse);
        string responseStream = streamRead.ReadToEnd();

        using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        {
            using (var istream = new IsolatedStorageFileStream(@"tmp" + xmlName + ".xml", FileMode.OpenOrCreate, store))
            {
                using (var sw = new StreamWriter(istream))
                {
                    sw.Write(responseStream);
                }
            }
        }

        // Close the stream object
        streamResponse.Close();
        streamRead.Close();

        // Release the HttpWebResponse
        response.Close();
      }
    } 
    ```

编辑添加：
用法然后更改为

```
 httpRequest.BeginGetRequestStream(GetRequestStreamCallback(xmlName), httpRequest); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:24:17.083

这是一个映射到特定委托类型的回调方法，所以不，你不能修改它的签名。

解决此问题的一种选择是有一个单独的类，例如：

```
class HttpRequestState {
    HttpWebRequest httpWebRequest;
    string xmlFileName;
} 
```

然后，您可以在运行 Begin 回调时将该类的实例设置为状态对象：

`httpRequest.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), httpRequest);`

会变成

`httpRequest.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), new HttpRequestState() { httpWebRequest = httpRequest; xmlFileName = "tmp"+xmlName+".xml" });`

然后，当然，您可以像这样提取 xmlFileName*和*httpWebRequest：

```
HttpRequestState stateObj = (HttpRequestState)asynchronousResult.AsyncState;
HttpWebRequest httpRequest = stateObj.httpWebRequest;
string fileName = xmlFileName; 
```

# asp.net-mvc-3 - 使用 IIS 7.5、ASP.Net v4.0 和 MVC3 使用适当的 SEO 进行域名和重定向？

> ID：10789962
> 
> 赞同：1
> 
> 时间：2012-05-28T20:12:10.677
> 
> 标签：asp.net-mvc-3, seo, dns, iis-7.5, asp.net-4.0

假设我有几个要创建的站点 - 所有站点都具有单独的域名。这些站点中的每一个都使用相同的后端，并且所有配置都来自相同的后端。

因此，我想知道是否可以执行以下操作：

在每个站点的 DNS 中，将它们全部指向同一个站点。

例如：

*   site1.com、site2.com、site3.com ---> mymainbackend.com

然后在 mymainbackend.com，我会读取传入的 URL，并根据传入的 URL 提供适当的内容。

这样做的一个问题是所有站点都将驻留在同一个应用程序池中，但一种解决方法是使用批处理池。

其架构是 IIS 7.5、MVC3、ASP.Net 4.0。

在这种情况下是否有任何 SEO got'cha's？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:00:18.210

我使用路由模块从同一主机运行 4 个不同的域来决定要提供哪些内容。

SEO明智的应该没有具体问题。

这与在同一台服务器上托管多个网站以及可能引发的潜在问题相同。

# spring - 在 Spring MVC 中，如何找出页面加载时间？

> ID：10789963
> 
> 赞同：2
> 
> 时间：2012-05-28T20:12:19.723
> 
> 标签：spring, model-view-controller, page-load-time

我试图在页面上显示类似于谷歌搜索时间的服务器响应时间，比如“页面加载大约 1.3 秒”左右。

实现这一目标的最佳方法是什么？我目前有一个 MVC 框架设置，我最初的方法是将初始时间存储在控制器中，并将其作为模型传递到视图中，由视图来计算经过的时间。

不知何故，我觉得必须有一种更好的方法，对于所有请求，上​​下文可能已经记录了请求开始时间或经过时间的信息。

有人可以验证我最初的想法是否正确吗？还是存在已经实施的解决方案？

谢谢，

杰森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T20:18:34.533

您可以使用 servlet 过滤器将开始时间存储在每个请求（或至少对页面的每个请求）的请求属性中，并在视图执行结束时计算经过的时间。

如果您使用 Tiles 或 SiteMesh 之类的模板引擎，则此经过时间计算将在一个地方调用：页面模板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-28T20:19:58.463

如果您一直等到您的控制器，您可能会错过很多“加载时间”。您想使用[过滤器](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html)在流程中尽可能早地对请求进行计时。Java EE 教程有[更多关于编写过滤器](http://docs.oracle.com/javaee/6/tutorial/doc/bnagb.html)的细节。还有另一个 SO answer 可以解决这个问题：

[在 Spring MVC 中，在哪里开始和结束计数器来测试速度执行时间？](https://stackoverflow.com/questions/3647218/in-spring-mvc-where-to-start-and-end-counter-to-test-for-speed-execution-time)

# mysql - 这个查询会使用索引吗？

> ID：10789964
> 
> 赞同：1
> 
> 时间：2012-05-28T20:12:31.073
> 
> 标签：mysql, sql, indexing

我有一张看起来像这样的大桌子：

```
CREATE TABLE `images` (
  `image_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(10) unsigned NOT NULL,
  `data` mediumblob,
  PRIMARY KEY (`user_id`,`image_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 
```

我必须在其上运行一个压缩 blob 字段的查询。MySQL 是否能够通过以下查询使用索引：

```
UPDATE images SET data = COMPRESS(data) WHERE (user_id = ? AND image_id = ?) OR (user_id = ? AND image_id = ?) OR (...) OR (...); 
```

我必须这样做，因为我无法在单个查询中更新整个表，而且我不能只使用`user_id`.

编辑：`explain`并且`update`不起作用，你们知道，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:17:07.507

是的，您的更新将使用表上的索引，因为在 之后引用的唯一列`WHERE`是您的主键所代表的列。

如果您不确定查询将使用什么，请随意使用以下`EXPLAIN`命令： [http ://dev.mysql.com/doc/refman/5.0/en/explain.html](http://dev.mysql.com/doc/refman/5.0/en/explain.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T20:34:41.233

利用

```
EXPLAIN SELECT data FROM images
  WHERE (user_id = ? AND image_id = ?)
    OR (user_id = ? AND image_id = ?)
    OR (...)
    OR (...); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T20:44:11.670

是的，它很可能会使用索引（除非您的条件具有非常低的基数）。

`MySQL`也支持这种语法：

```
(user_id, image_id) IN ((user1, image1), (user2, image2), (user3, image3)) 
```

但是这个不会使用索引（这只是一个实现缺陷）。

您还可以使用此查询：

```
UPDATE  (
        SELECT  user1 AS user_id, image1 AS image_id
        UNION ALL
        SELECT  user2 AS user_id, image2 AS image_id
        UNION ALL
        SELECT  user3 AS user_id, image3 AS image_id
        ) q
JOIN    images i
ON      (i.user_id, i.image_id) = (q.user_id, q.image_id)
SET     i.data = COMPRESS(i.data) 
```

这也将使用索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T20:16:11.010

在您的示例中，我希望 MySQL 使用主键作为聚集索引。这意味着索引存储所有列，实际上是磁盘上数据的唯一版本。

所以是的，它将使用索引。在包含`or`s 的条件下，我希望 MySQL 扫描索引（而不是查找。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-28T20:20:06.630

这`EXPLAIN`比猜测太多要好。

甚至在运行之前`EXPLAIN`，发出`ANALYZE TABLE`以确保查询优化器有最佳机会找到最佳查询计划。

# jsf - Primefaces 选项列表。DualListModel 的设置器删除源和目标

> ID：10789967
> 
> 赞同：4
> 
> 时间：2012-05-28T20:12:39.163
> 
> 标签：jsf, primefaces

我的选择列表有问题。显示源和目标有效，但是当按下命令按钮时，它会调用选择列表的设置器并清空选择列表的源和目标。之后它调用方法connectTags()。

这种行为的原因是什么，我该如何解决？

```
<h:form>
    <p:pickList id="pickList" value="#{employeeEditController.dualListTags}"
        var="tag" itemLabel="#{tag.value}" itemValue="#{tag}">
        <f:facet name="sourceCaption">Available</f:facet>
        <f:facet name="targetCaption">Connected</f:facet>  
    </p:pickList>
    <p:commandButton value="Save" actionListener="#{employeeEditController.connectTag()}"/>
</h:form> 
```

豆：

```
@Named(value = "employeeEditController")
@SessionScoped
public class EmployeeEditController implements Serializable, IEditController {
    private Employee selectedEmployee;
    private DualListModel<Tags> dualListTags;

@Inject
private EmployeeFacade employeeFacade;
@Inject
private CompanyFacade companyFacade;
@Inject
private TagFacade tagFacade;

public void setSelectedEmployee(Employee selectedEmployee) {
    System.out.println("setSelectedEmployee called. Value: " + selectedEmployee.getFirstName());
    this.selectedEmployee = selectedEmployee;
    this.refreshDualList();
}

private void refreshDualList(){
    List<Tags> source = (List<Tags>) this.getCompanyTags();
    List<Tags> target = (List<Tags>) this.getTags();
    System.out.println("refreshDualList called. \nSource: " + source.size() +
            "Target: " + target.size());
    this.dualListTags = new DualListModel<Tags>(source, target);
}

public Collection<Tags> getTags(){
    Collection<Tags> retVal;
    if(this.selectedEmployee != null){
        retVal = this.selectedEmployee.getTags();
        if(retVal == null){
           retVal = new ArrayList<Tags>();
        } 
    } else{
        System.out.println("selected emp is null");
        retVal = new ArrayList<Tags>();
    }
    return retVal;
}

public Collection<Tags> getCompanyTags() {
    Collection<Tags> retVal = new ArrayList<Tags>();
    if(this.companyID == null){
        String userstr = FacesContext.getCurrentInstance().getExternalContext().getRemoteUser();
        this.companyID = this.companyFacade.getCompanyIDByUser(userstr);
    }
    retVal = this.tagFacade.getTagsFromCompanyID(companyID);
    return retVal;
}

public void save(){
    if(this.selectedEmployee != null){
        System.out.println("Save called. Value: " + this.selectedEmployee.getFirstName());
        this.employeeFacade.edit(this.selectedEmployee);
    }
}

public void connectTag() {
    if(this.dualListTags != null){
        System.out.println("connectTag() called.\n" + "source: " + this.dualListTags.getSource().size() + 
                "\ntarget: " + this.dualListTags.getTarget().size());
        this.selectedEmployee.setTags((Collection<Tags>)this.dualListTags.getTarget());
        this.save();
    }
}

public DualListModel<Tags> getDualListTags() {
    System.out.println("getDualList called. \nSource :" + this.dualListTags.getSource().size()
            + "\nTargets: " + this.dualListTags.getTarget().size());
    return this.dualListTags; 
}

public void setDualListTags(DualListModel<Tags> dualListTags) {
    System.out.println("setDualList called. \nSource :" + this.dualListTags.getSource().size()
            + "\nTargets: " + this.dualListTags.getTarget().size());
    this.dualListTags = dualListTags;
    System.out.println("setDualList called after set. \nSource :" + this.dualListTags.getSource().size()
                + "\nTargets: " + this.dualListTags.getTarget().size());
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T06:45:32.623

我遇到了同样的问题，似乎解决方案是为您在选择列表中使用的实体实施自定义转换器。

这是我的自定义转换器的样子：

```
@ViewScoped
@ManagedBean(name = "vehicleGroupConverter")
public class VehicleGroupConverter implements Converter {

    @ManagedProperty(value = "#{vehiclesBean}")
    private VehiclesBean vehiclesBean;

    @Override
    public Object getAsObject(FacesContext context, UIComponent component,
            String value) {
        long groupId = Long.parseLong(value);
        List<AssetCategory> groups = vehiclesBean.getVehicleGroups();
        for (AssetCategory group : groups) {
            if (group.getCategoryId() == groupId) {
                return group;
            }
        }
        return null;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component,
            Object value) {
        return Long.toString(((AssetCategory) value).getCategoryId());
    }

    public void setVehiclesBean(VehiclesBean vehiclesBean) {
        this.vehiclesBean = vehiclesBean;
    }

} 
```

这是选择列表模板部分：

```
<p:pickList id="vehicleGroups" 
        value="#{vehiclesBean.selectedVehicleGroups}" 
        var="group" 
        itemLabel="#{group.name}" 
        itemValue="#{group}"
        converter="#{vehicleGroupConverter}"
        styleClass="pf-panel-grid"
        style="margin-bottom:10px">
    <f:facet name="sourceCaption">#{i18n['label-available-groups']}</f:facet>
    <f:facet name="targetCaption">#{i18n['label-assigned-groups']}</f:facet>
</p:pickList> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-18T10:23:54.100

当源或目标不为空时设置 duallistmodel：

```
public void setDualListTags(DualListModel<Tags> dualListTags) {
    if(this.dualListTags.getSource().size()!=0 && this.dualListTags.getTarget().size()!=0) {
        this.dualListTags = dualListTags;
    }
} 
```

# android - Android 应用 facebook 集成失败

> ID：10789982
> 
> 赞同：0
> 
> 时间：2012-05-28T20:14:35.853
> 
> 标签：android, facebook, posting

我的应用程序有问题，我不知道问题是否明显。我已经设法使用我为 Android 创建的应用程序将内容发布到我的 Facebook 墙上。但是当我将这个应用程序分发给我的测试人员时，他们并没有进入登录窗口。该应用程序在屏幕出现之前终止。

我已经使用了教程：http: [//developers.facebook.com/docs/mobile/android/build/](http://developers.facebook.com/docs/mobile/android/build/)

有人可以帮助我。我可以检查一些事情还是在互联网上有更全面的解释？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T04:04:49.720

你需要按照以下步骤，

1.) 转到[https://github.com/facebook/facebook-android-sdk/tree/master/examples](https://github.com/facebook/facebook-android-sdk/tree/master/examples)

2.) 下载名为**Hackbook**的示例。并执行它，这是 facebook 与 android 集成的工作示例

这里的条件是你必须有**App ID**和**App secret**。
如果有任何问题，请告诉我。

# c# - 防止人们对我的网络协议进行逆向工程

> ID：10789984
> 
> 赞同：4
> 
> 时间：2012-05-28T20:14:48.227
> 
> 标签：c#, security, networking, obfuscation

我知道我不能**阻止**人们对我的协议进行逆向工程，但我想采取一种通过隐蔽的安全方法来使其尽可能困难。

我有一个服务器/客户端系统，它通过网络与`http`样式数据包进行通信。

例子：

```
Header
Attribute: Value
Attribute2: Other Value

Payload 
```

我想让除了我的客户以外的任何人都尽可能难以访问网络。将他们反编译我的程序集的问题推到一边——我可以对这个网络规范做些什么好事情，这会让在没有源代码的情况下理解和制作另一个实现变得**非常困难？**

我在想某种奇怪的散列方法或某种很难的加密算法。

**编辑**我不想保护我的程序集或源代码。例如，我试图阻止某人使用 WireShark 或类似工具观看我的协议，然后根据该信息进行自己的实现。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T20:20:55.830

好的，三种情况：

*   用户无法访问服务器代码，也无法访问客户端代码：最简单的方法是使用存储在二进制文件中的预先生成的共享密钥，并使用 aes 加密/解密。

*   用户可以访问客户端或服务器代码，但不能同时访问两者：使用公钥/私钥方法。您可以使用公钥进行加密，但需要使用私钥进行解密。

*   用户可以访问客户端和服务器代码：你搞砸了。

如果你想提高安全性，这个静态密钥应该只在会话启动期间使用，以生成一个新的共享密钥，然后用于通信。

编辑：实际上，一个更简单和安全的解决方案是使用 ssl 和证书（这是你不应该实施自己的加密的口头禅）每个证书都带有一个秘密私钥。只要用户无权访问，如果您验证对等方具有完全正确的证书，您就是安全的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T20:22:43.580

由于已经反转了一些网络协议（来自 MMO），我可以告诉你，你*永远不会*保护你的协议很长时间，我很抱歉。

你能做的最好的事情是：

*   *使用自定义*算法对其进行混淆（因为反转所需的时间比已知算法要长）。使用已知的*加密*方案不会提供任何保护。
*   添加噪音。试着变得非常非常混乱。添加毫无意义的随机值。尝试对数据包使用动态布局。移动字段。发送无用的数据包。就像它是垃圾一样。
*   版本你的协议，使两个连续的版本不兼容。这可能很难做到，但它迫使逆向者为每个后续版本重新做工作。

但这些只是减缓攻击者的方法。这当然不会阻止他们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T00:05:52.257

有三种解决方案：

1.  TLS。
2.  SSLv3。
3.  不管你煮什么。

1和2已经工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T20:26:46.063

我也在用 C# 编写网络协议。我已经使用加密来保护协议。这是我如何做到这一点的支出，您可能会发现这很有用。

*   一旦客户端连接，服务器就从客户端请求一个随机 UUID，客户端使用服务器和客户端都知道的密码加密这个 UUID。
*   此后服务器或客户端发送的所有数据包都将使用该 UUID 作为密钥进行加密。

关于“我在想某种奇怪的散列方法”，散列通常只用于数据验证。即确保它在发送给您的途中没有被修改。

希望这可以帮助。

# javascript - 为 Firefox 扩展实现 Javascript 插件系统

> ID：10789986
> 
> 赞同：2
> 
> 时间：2012-05-28T20:15:05.727
> 
> 标签：javascript, html, firefox, firefox-addon, xul

我们正在尝试构建一个 Firefox 扩展，其中我们的扩展将包含许多 Javascript 插件。此处的插件被定义为一组具有主入口点的函数，它们通常提供响应。在 OOP 中，它们将共享相同的公共抽象类，并且可以预见 $obj->init()->run()->get() 链。

它们将是一个插件池，每个插件都应该有一个排名，插件的执行应该基于它们的排名。

主要问题是：
- 你如何在裸 Javascript 中创建插件系统
- 它们是 JS 中可用于启动的任何开源插件系统
- 你将如何存储插件池系统及其排名，以及
- 如何存储您确保插件按其排名顺序执行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T07:37:58.720

你的问题真的很模糊，所以我将根据一堆猜测来回答。您可能想做一些类似于[Add-on SDK](https://addons.mozilla.org/en-US/developers/builder)在内部所做的事情 - 将您的插件加载到[沙箱](https://developer.mozilla.org/en/Components.utils.Sandbox)中，为它们提供一些 API 并根据需要调用它们的方法。另外，我猜您想使用[null 主体](https://developer.mozilla.org/en/Security_check_basics#Principals)来确保沙箱没有额外的权限。这样的事情应该做：

```
Components.utils.import("resource://gre/modules/Services.jsm");

var sandboxProto = {
  rank: -1,
  foo: function()
  {
    throw new Error("Please implement");
  },
  myAPIMethod: function()
  {
    return 5;
  }
};
var sandboxPrincipal = Components.classes["@mozilla.org/nullprincipal;1"]
                         .getService(Components.interfaces.nsIPrincipal);

var plugins = [];

function loadPlugin(url)
{
  try
  {
    var sandbox = Components.utils.Sandbox(sandboxPrincipal, {
      sandboxName: url,
      sandboxPrototype: sandboxProto
    });
    Services.scriptloader.loadSubScript(url, sandbox);
    plugins.push(sandbox);
  }
  catch (e)
  {
    Components.utils.reportError(e);
  }
}

function callPluginMethod(methodName)
{
  var args = Array.prototype.slice.call(arguments, 1);

  // Always resort plugins in case their rank changes
  plugins.sort(function(a, b)
  {
    // Make sure that we work with numbers
    var r1 = parseInt(a.rank, 10) || -1;
    var r2 = parseInt(a.rank, 10) || -1;
    return r2 - r1;
  });

  var results = [];
  for (var i = 0; i < plugins.length; i++)
  {
    if (methodName in plugins[i])
    {
      try
      {
        results.push(plugins[i][methodName].apply(plugins[i], args));
      }
      catch (e)
      {
        Components.utils.reportError(e);
      }
    }
  }
  return results;
} 
```

一个插件看起来像这样：

```
var rank = 1000;

function foo()
{
  return 2 * myAPIMethod();
} 
```

所以下面的代码应该告诉你`[10]`：

```
loadPlugin("chrome://.../content/plugin.js");

var results = callPluginMethod("foo");
alert(results.toSource()); 
```

至于您的扩展如何知道在哪里可以找到它的插件 - 这是一个完全不同的问题，很大程度上取决于要求（这个问题中缺少的东西）。但是请注意，下标加载器仅适用于本地 URL - 只有作为扩展程序的一部分或位于用户磁盘上的插件才能使用。如果插件列表是动态的，那么您可能希望在用户配置文件中为它们创建一个目录并根据需要将它们下载到该目录（您应该非常小心，不要给这些插件太多权限，以避免安全问题）。

# php - 如何制作一个选择语句 PDO 并以 $row['field'] 结尾

> ID：10789991
> 
> 赞同：0
> 
> 时间：2012-05-28T20:15:29.527
> 
> 标签：php, mysql, pdo

我想制作一个 php PDO 选择语句，并最终可以放置`$row['field']`在我想要的任何地方。

在普通的mysql中，我会这样做：

```
$row = mysql_fetch_array(mysql_query("SELECT * FROM table WHERE id = '1234'")); 
```

然后我将能够放置`$row['name']`在一个地方和`$row['items']`另一个地方。

这个怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:19:13.597

```
$sth = $dbh->prepare("SELECT * FROM table WHERE id = '1234'");
$sth->execute();

$row = $sth->fetch(PDO::FETCH_ASSOC);

echo $row['field']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:19:34.550

PDO 对应的`mysql_fetch_array`是`fetch(PDO::FETCH_BOTH)`. 如果您只关心关联数组，则可以使用`fetch(PDO::FETCH_ASSOC)`

我建议你阅读这个简短的教程，它将让你很快地开始使用 PDO：http: [//net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-数据库访问/](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

# sql - 使 H2 将引用的名称和未引用的名称视为相同

> ID：10789994
> 
> 赞同：23
> 
> 时间：2012-05-28T20:15:34.087
> 
> 标签：sql, database, h2, double-quotes

H2 似乎在带引号的名称和不带引号的名称之间有所不同。有没有办法让它以同样的方式对待他们？

这是我所做的测试：

```
CREATE TABLE test (dummy INT);
CREATE TABLE "testquote" (dummy INT, "quotedDummy" INT); 
```

以下是查询：

```
SELECT * FROM test; --work
SELECT * FROM "test"; -- doesn't work
SELECT * FROM "testquote"; --work
SELECT * FROM testquote; --doesn't work
SELECT dummy FROM "testquote"; --work
SELECT quotedDummy FROM "testquote"; --doesn't work
SELECT "quotedDummy" FROM "testquote"; --work 
```

我该怎么做才能使这些查询与 H2 一起使用？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-29T05:10:21.070

根据 SQL 规范的要求，[H2 中的引号名称区分大小写。](http://h2database.com/html/grammar.html#quoted_name)这意味着这将起作用：

```
CREATE TABLE "testquote" (dummy INT, "quotedDummy" INT); 
SELECT * FROM "testquote"; 
```

但这不会：

```
SELECT * FROM "TestQuote";
SELECT * FROM "TESTQuote";
SELECT * FROM "TESTQUOTE"; 
```

[Unquotes 名称在 H2 中不区分大小写](http://h2database.com/html/grammar.html#name)。它们通常被转换为大写（如在 Oracle 和其他数据库中）。这意味着语句

```
CREATE TABLE test (dummy INT);
SELECT * FROM test; 
```

是一样的

```
CREATE TABLE "TEST" ("DUMMY" INT);
SELECT * FROM "TEST"; 
```

因为 H2 的行为方式与 Oracle 相同。这与 MySQL 和 PostgreSQL 等其他数据库处理标识符名称的方式有些不同。H2 有一个兼容性特性：如果附加[`;DATABASE_TO_UPPER=FALSE`](http://www.h2database.com/javadoc/org/h2/engine/DbSettings.html#DATABASE_TO_UPPER)到数据库 URL，取消引号标识符不会转换为大写，这意味着它们也区分大小写。但是您需要在创建数据库时附加它，并且每次使用它时（如果附加现有数据库的设置，现有对象的标识符已经转换为大写）。

[顺便说一句，这与函数 UPPER](http://h2database.com/html/functions.html#upper)无关，后者用于数据。您的问题是关于标识符，而不是数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-06T19:27:26.690

我在使用 Hibernate 和 H2 时遇到了一些奇怪的问题，如果我在 @Table 注释中指定目录和模式名称，生成的 SQL 将对引用的表名使用错误的大小写，导致它失败。这可能是一个缺陷，但我找到了一个解决方法，我在这里分享。

```
import org.hibernate.boot.model.naming.Identifier;
import org.hibernate.engine.jdbc.env.spi.JdbcEnvironment;
import org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl;

public class H2IdentifierNamingStrategy extends PhysicalNamingStrategyStandardImpl {
    private static final long serialVersionUID = 1L;

    @Override
    public Identifier toPhysicalTableName(Identifier name, JdbcEnvironment context) {
        if(name==null) return null;
        else return new Identifier(name.getText().toLowerCase(), name.isQuoted());
    }
} 
```

# ruby-on-rails - 查找表的 Rails 关联

> ID：10789998
> 
> 赞同：3
> 
> 时间：2012-05-28T20:15:58.467
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个仅包含 id 和名称字段（活动、非活动、待定等）的状态表。然后，我有诸如用户、成就、徽章之类的表，其中每个表都包含一个 status_id 外键。我的模型中的关联看起来正确吗？

```
class Status < ActiveRecord::Base
  has_many :achievements
  has_many :badges
  has_many :users
end

class User < ActiveRecord::Base
  belongs_to :status
end

class Badge < ActiveRecord::Base
  belongs_to :status
end

class Achievement < ActiveRecord::Base
  belongs_to :status
end 
```

在查找表的情况下，我正在努力如何正确读取 has_one 和 has_many 之间的区别。我知道一个用户拥有一家公司并拥有一个个人资料，而一家公司有很多用户，但这对我来说似乎倒退了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T20:39:34.170

最简单的关联设置是：

```
class User < ActiveRecord::Base
  has_one :status
end 
```

这准确地描述了您发布的内容。您的解决方案会起作用，但对于您所描述的内容来说太过分了。我上面发布的所有关联都是向用户模型添加一种方法，即

```
@user = User.find(1)
@user.status 
```

另一方面，如果您想要简单的语义来显示具有特定状态的所有用户，那么您将添加

```
class Status < ActiveRecord::Base
  has_many :users
end 
```

所以现在你可以这样做：

```
@status = Status.find_by_description('Active').first()

@status.users 
```

请注意，在这两种情况下，所需要的只是用户模型具有属性“status_id”

Belongs_to 更适合存在隐式层次结构，即

```
class Child << ActiveRecord::Base
   belongs_to :parent
end 
```