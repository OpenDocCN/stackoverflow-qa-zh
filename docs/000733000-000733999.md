# StackOverflow 问答 000733000-000733999

# syntax - 在自定义批处理语法中用作分隔符的最佳字符是什么？

> ID：733004
> 
> 赞同：3
> 
> 时间：2009-04-09T06:09:35.487
> 
> 标签：syntax, batch-processing

我编写了一个小程序来将图像从网络下载到不同的文件夹。我想创建一个快速而肮脏的批处理文件语法，并且想知道不同变量的最佳分隔符是什么。

这些变量可能包括 url、文件夹路径、文件名和一些自定义消息。

那么有没有不能用于前三个的字符呢？这将是用作分隔符的明显选择。好的旧逗号怎么样？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T07:00:25.647

您可以使用：

1.  [控制字符](http://en.wikipedia.org/wiki/Control_character)：控制字符不出现在文件中。Tab (\t) 可能是这里的最佳选择。
2.  您的文件中不太可能出现的某些字符组合。例如`#s#`等。

不过，Tab 是通常的首选。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T06:15:00.123

为什么不直接使用已经存在的东西？有一种或两种选择，perl、python、ruby、bash、sh、csh、Groovy、ECMAscript，天堂禁止 windows 脚本文件。

我看不出通过编写另一种批处理文件语法会获得什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T06:16:43.460

标签。然后展开或压缩在文本中找到的任何选项卡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T06:14:22.577

选择一个与您可能拥有的任何变量的名称冲突的可能性最小的分隔符（排除`#`,`/`等`:`）。逗号 ( `,`) 对我来说看起来不错（除非您的自定义消息有几个）或`<`和`>`（取决于先前的条件）。

但是，您可能还需要“转义”作为要分隔的变量的一部分出现的分隔符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T07:17:12.457

我会用'|'

这是最稀有的角色之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-17T05:07:01.920

怎么样`String.fromCharCode(1)`？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T06:44:19.850

这听起来真是个坏主意。无需创建另一种（数据表示）语言，有很多可能适合您的需求。除了 Ruby、Perl 等，您可能还需要考虑[YAML](http://yaml.org)。

为此类设计良好的语法是困难且充满危险的。**重新发明轮子**会敲响警钟吗？

# c# - 查找程序是否安装

> ID：733005
> 
> 赞同：2
> 
> 时间：2009-04-09T06:09:42.133
> 
> 标签：c#

我正在编写一个 C# 程序，它需要查看是否安装了特定程序（它将列在控制面板的“添加或删除程序”列表中）并卸载它。有没有办法做到这一点？..感谢您的帮助...

他们已经安装了应用程序......我需要的是它是否可以在添加或程序中使用......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T06:21:28.767

遍历“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall”键并检查其“DisplayName”值以获取该程序的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T06:24:12.863

是的。

**您可以在 [ HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall** ]检查 Windows 注册表

您可以使用两个重要的值：

*   **DisplayName** : 程序的名称
*   **UninstallString**：要执行的卸载程序的命令。这可能对您卸载应用程序很方便。

通常，所有程序都有其自定义注册表设置，最好使用它们。恕我直言。

# oop - “有一个”与“是一个”——决定的代码味道

> ID：733011
> 
> 赞同：2
> 
> 时间：2009-04-09T06:11:13.130
> 
> 标签：oop, inheritance, composition

我昨天在继承自 Bar 的类 Foo 中写了这个：

```
public override void AddItem(double a, int b)
{
    //Code smell?
    throw new NotImplementedException("This method not usable for Foo items");
} 
```

随后想知道这是否可能表明我应该*使用*Bar，而不是从它继承。

**还有哪些“代码气味”可以帮助在继承和组合之间进行选择？**

**编辑我应该补充一点，这***是*一个片段，还有其他共同的方法，我只是不想太详细。我必须分析切换到作曲的含义，并想知道是否还有其他“代码气味”可以帮助打破平衡。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-09T06:22:31.527

您在上面给出的示例显然是代码异味。该`AddItem`方法是基类的一种行为`Bar`。如果`Foo`不支持该`AddItem`行为，则不应继承自`Bar`.

让我们考虑一个更现实的 (C++) 示例。假设您有以下课程：

```
class Animal
{
    void Breathe() const=0;
}

class Dog : public Animal
{
    // Code smell
    void Breathe() { throw new NotSupportedException(); }
} 
```

基本抽象类`Animal`提供了一个纯虚`Breathe()`方法，因为动物必须呼吸才能生存。如果它不呼吸，那么根据定义，它就不是动物。

通过创建一个`Dog`继承自该行为`Animal`但*不*支持该`Breathe()`行为的新类，您违反了`Animal`该类规定的合同。可怜的狗活不下去了！

**公共继承的简单规则是，只有在派生类对象真正“是”基类对象时才应该这样做。**

在您的特定示例中：

*   `Foo`不支持合同`AddItem()`约定的行为`Bar`。
*   因此，根据定义，`Foo`is "not a" `Bar`，不应该从它继承。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T06:20:25.057

那么，如果没有扩展的 Foo 的行为不像 Bar，为什么要从 Bar 继承呢？想想看，我什至不会在基类中将像“AddItem”这样的方法声明为虚拟的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T06:39:04.870

是的，您必须“取消实现”方法表明您可能不应该使用“is-a”关系。您的 Foos 似乎并不是真正的酒吧。

但首先要考虑你的 Foos 和 Bars。是Foos酒吧吗？你能在纸上画出集合和子集吗，每个 Foo（即 Foo 类的每个成员）也会是 Bar（即 Bar 类的成员）吗？如果没有，您可能不想使用继承。

另一个表明 Foos 不是真正的 Bars 并且 Foo 不应该继承 Bar 的代码味道是您不能使用多态性。假设您有一个将 Bar 作为参数的方法，但它无法处理 Foo。（可能是因为它在其参数中调用了 AddItem 方法！）您必须添加一个检查或处理 NotImplementedException，这使代码变得复杂且难以理解。（还有气味！）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T07:17:40.427

> 不！正方形可能是矩形，但 Square 对象绝对不是 Rectangle 对象。为什么？因为 Square 对象的行为与 Rectangle 对象的行为不一致。**从行为上讲，正方形不是矩形！软件真正关注的是行为。**

来自Object Mentor 中[的 Liskov 替换原则](http://www.objectmentor.com/resources/articles/lsp.pdf)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T06:21:19.453

当然也有直接的反面，如果你的 Foo 实现了很多只将消息转发到它拥有的 Bar 的接口，这可能表明它应该*是*一个 Bar。只是，气味并不总是正确的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T21:04:12.787

虽然上面的示例可能表明出现了问题，但 NotImplementedException 本身并不总是错误的。这都是关于超类的契约和实现这个契约的子类。如果你的超类有这样的方法

```
// This method is optional and may be not supported
// If not supported it should throw NotImplementedException 
// To find out if it is supported or not, use isAddItemSupported()
public void AddItem(double a, int b){...} 
```

然后，合同不支持这种方法仍然可以。如果不支持，您可能应该在 UI 中禁用相应的操作。所以如果你对这样的合同没意见，那么子类就会正确地实现它。

当客户端明确声明它不使用所有类方法并且永远不会使用时的另一个选择。像这样

```
// This method never modifies orders, it just iterates over 
// them and gets elements by index.
// We decided to be not very bureaucratic and not define ReadonlyList interface,
// and this is closed-source 3rd party library so you can not modify it yourself.
// ha-ha-ha
public void saveOrders(List<Order> orders){...} 
```

然后可以传递不支持添加、删除和其他变异器的 List 的实现。只需记录它。

```
// Use with care - this implementation does not implement entire List contract
// It does not support methods that modify the content of the list.
public ReadonlyListImpl implements List{...} 
```

虽然让你的代码来定义你的所有合约是好的，因为它让你的编译器检查你是否违反了合约，但有时这是不合理的，你必须求助于弱定义的合约，比如注释。

简而言之，问题在于，如果您真的可以安全地将子类用作超类，考虑到超类是由其合同定义的，而不仅仅是代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T07:19:59.937

.Net 框架有这样的例子，特别是在 System.IO 命名空间中——一些读者没有实现他们所有的基类属性/方法，如果你尝试使用它们会抛出异常。

例如 Stream 有一个 position 属性，但是有些流不支持这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T18:37:27.380

组合比继承更[可取，因为它降低了复杂性。](http://www.cc2e.com/)更好的方法是使用[构造函数注入](http://en.wikipedia.org/wiki/Dependency_injection#Types)并在 Foo 类中保留对 Bar 的引用。

# c++-cli - 我如何使用 SQLSMO

> ID：733012
> 
> 赞同：0
> 
> 时间：2009-04-09T06:11:19.900
> 
> 标签：c++-cli

我是usnig visual studio2003和windows平台sdk2008。我必须在 C++ 中从 SQLDMO 迁移到 SQLSMO。我需要任何头文件才能在 C++ 中使用 sqlsmo。

任何机构都可以在这方面帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T06:58:26.323

我认为您不能使用 Visual Studio 2003 / .NET 1.1 中的 SQL SMO - SQL SMO 至少需要 .NET 2.0。

马克

# unix - Amazon EC2 的替代工具？

> ID：733013
> 
> 赞同：9
> 
> 时间：2009-04-09T06:11:28.650
> 
> 标签：unix, command-line, amazon-ec2

亚马逊用于与 EC2 交互的官方工具有点笨重，而且很难处理。我必须设置一堆环境变量，为 EC2 存储单独的私钥，向我的 PATH 添加额外的项目，等等。它们都输出了数百个字符长且没有标题的制表符分隔行，因此解释它们有点痛苦。他们设置 SSH 密钥对的说明为您提供了一个不受密码保护的密钥对，而不是让您使用现有的密钥对。这些程序都只是有点笨拙，不是很好的 Unix 程序。

那么，有没有更容易使用的命令行工具来访问 EC2 呢？我知道有 ElasticFox，还有他们的基于 Web 的控制台，这确实使过程更容易，但我想知道是否还有其他人编写了更好的命令行工具来与 EC2 交互。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T13:30:17.523

我有点晚了，但我有一个解决方案！

我在 Amazon AMI 工具中发现了同样的问题。它们是一个不错的参考实现，但很难使用，尤其是当您有多个实例时。我写了一个替代命令行工具作为另一个项目的一部分，叫做 Rudy，它回答了你的大部分问题

这些命令比 Amazon 的 AMI 工具更直观：

*   `rudy-ec2 instances -C`
*   `rudy-ec2 groups -A -p 8080 -a 11.22.33.44 group-name`
*   `rudy-ec2 volumes -C -s 100`
*   `rudy-ec2 images`
*   ...

所有配置都在一个文件中 ( `~/.rudy/config`)。

它可以输出多种格式（yaml、json、csv、tsv，当然还有常规文本）：

```
rudy-ec2 -f yaml snapshots
--- 
:awsid: snap-2457b24d
:progress: 100%
:created: "2009-05-08T15:24:17.000Z"
:volid: vol-4ee10427
:status: completed 
```

关于私钥，没有 EC2 工具允许使用密码创建私钥*以启动公共实例*，因为 API 不支持它。但是，如果您创建自己的图像，则可以使用您的私钥。

这里有更多信息：

*   [GitHub 项目](http://github.com/solutious/rudy/tree/master)
*   [rudy-ec2简介](http://solutious.com/blog/2009/04/22/rudy-ec2-api-tools-replacement/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T06:21:12.323

ElasticFox 对于大多数任务都很方便。尽管命令行工具更适合它们，但它们是场合。我个人将[boto](http://code.google.com/p/boto/)库用于 python。编写所有必需操作的脚本非常容易。您还可以使用它从 S3 上传/下载文件。一般来说，我会说像 Python 或 RUby 这样的脚本语言以及 AWS 库是最好的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-26T20:47:06.257

我个人使用 Tim Kay 的 Perl[命令行工具](http://timkay.com/aws/)，并且很长一段时间没有使用基于 Java 的原始 API。非常适合 UNIX 环境。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T01:52:13.123

不是命令行，而是看看免费的[RightScale](http://www.rightscale.com)帐户会给您带来什么 - 比命令行或 ElasticFox IMO 容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T23:30:01.627

关于 ec2-api-tools：

我同意它们有点太笨重，我特别不喜欢 ec2-describe-instances 的输出。我最近切换到 python-boto，它为 ec2 提供了一个非常干净且易于使用的界面。

关于无法为 EC2 生成的 ssh 密钥指定密码：

事实并非如此。您可以随时使用以下方法更改任何 ssh 私钥的密码：

```
ssh-keygen -p -f /path/to/keyfile 
```

例如

```
ssh-keygen -p -f ~/.ssh/id_rsa 
```

关于上传自己的 ssh 密钥对：

您可以使用 ec2-import-keypair，如下所示：

```
for i in $(ec2-describe-regions|cut -f 2);do
  ec2-import-keypair --region $i mykey --public-key-file ~/.ssh/id_rsa.pub
done 
```

上面的示例会将 ~/.ssh/id_rsa.pub 中的公钥上传到名为“mykey”的每个区域。请记住，每个区域都有自己的密钥对。

为了在您的 ec2 实例中安装密钥，您必须将“-k mykey”选项传递给 ec2-run-instances。

顺便说一句，上传您自己的密钥对是使用相同密钥登录所有区域的所有实例的唯一方法。如果您从 Web 界面创建密钥对，您将在每个区域拥有不同的密钥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-14T10:20:35.527

我有一个名为 EC2Dream 的开源图形系统管理工具，它取代了命令行工具。它安装在 windows、linux 和 Mac OS 客户端上，并使用 Ruby 和 FXRuby 编写。请参阅 www.ec2dream.com。

尼尔·特纳

[www.ec2dream.com](http://www.ec2dream.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-10T03:43:14.240

如果您使用 Windows，请尝试下面链接的工具（[O2 平台](http://o2platform.com)的一部分），它为您提供了一种简单的方法来启动和停止 Amazon EC2 映像（如果您需要扩展该工具，您可以轻松添加新功能（因为它只是动态编译和执行的 C# 脚本）

*   [O2 工具 – Amazon EC2 浏览器](http://o2platform.wordpress.com/2011/04/08/o2-tool-amazon-ec2-browser/)
*   [Amazon EC2 浏览器 – 停止实例的计时器](http://o2platform.wordpress.com/2011/04/10/amazon-ec2-browser-timer-to-stop-instances/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-23T13:21:46.163

替代库的问题在于它们并不总是保持最新，因此如果发布了 AWS 的新功能，那么您需要等待。您发布了您的主要问题是一堆环境变量，向您的 PATH 添加额外的项目等。我们在[BitNami遇到了这个问题，这也是我们创建](http://bitnami.org/)[BitNami Cloud Tools](http://bitnami.org/tools/cloud)的主要原因，该工具将所有 AWS 命令​​行工具与预配置的 Java 和 Ruby 语言运行时。您只需下载它，您需要的所有内容都将安装在一个文件夹中，而无需修改您的系统配置。我们会定期更新。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-26T23:09:32.743

有一个名为**云管理**的整个行业试图解决这类问题。**Scalr**和**RightScale**以及该领域的领导者（免责声明：我在 Scalr 工作）。

云管理软件构建在 Amazon EC2 API 之上（通常在其他公共 IaaS 上，如 Rackspace），并提供改进的用户界面以及您提到的备份或 SSH 管理等自动化工具。他们不提供更简单的命令行工具严格意义上的。他们的目标是让与 Amazon EC2 的交互更容易。

市场上有不同的选择：

*   **Scalr**：[Scalr](http://scalr.net)可作为托管服务提供试用版。否则，您可以自己[下载](http://scalr.net/pricing/open-source/)并安装源代码，因为它是在 Apache 2 许可下发布的。
*   **RightScale**：虽然它们通常被认为对小型企业来说很昂贵，但它们确实提供免费帐户。
*   **enStratus**：他们提供像 RightScale 这样的免费增值模式。

# c - Win32 Commport 嗅探

> ID：733014
> 
> 赞同：1
> 
> 时间：2009-04-09T06:11:37.120
> 
> 标签：c, winapi, serial-port

使用 C winapi，您如何从另一个程序独占打开的 commport 中捕获接收到的数据。

我知道有些程序可以做到这一点，但我想为特定目的编写自己的监控软件，想知道它是如何完成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T06:43:56.170

您可以使用 API 挂钩执行此操作，请参见此处： http: [//www.codeproject.com/KB/system/hooksys.aspx](http://www.codeproject.com/KB/system/hooksys.aspx)了解详细信息。基本上，您可以加载目标进程，将一些代码注入目标进程以挂钩您感兴趣的 API，然后使用 IPC 机制将数据从挂钩传输到分析程序。

这就是我的程序可以控制`GetTickCount()`另一个程序返回的值的工作方式（请参见此处[http://www.lenholgate.com/blog/2006/04/tickshifter-v02.html](http://www.lenholgate.com/blog/2006/04/tickshifter-v02.html)）

# excel - 在 Excel 单元格中声明变量

> ID：733019
> 
> 赞同：61
> 
> 时间：2009-04-09T06:13:48.380
> 
> 标签：excel, excel-formula

是否可以在 Excel 单元格中声明变量并将其用作其他单元格中公式的参数？

例如，我会`var1=10`在其中一个单元格中声明。在另一个单元格中，我将`var1`用于计算，例如：`=var1*20`.

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-04-09T06:24:33.440

您可以命名单元格。这是通过单击名称框（例如，公式栏旁边显示“A1”的那个东西）并输入名称来完成的，例如“myvar”。现在您可以使用该名称而不是单元格引用：

```
= myvar*25 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-07-18T14:59:40.737

我还刚刚发现了如何使用 Excel 名称管理器（公式 > 定义的名称部分 > 名称管理器）来执行此操作。

您可以定义一个不必“存在”在单元格中的变量，然后可以在公式中使用它。

![Excel 名称管理器](https://i.stack.imgur.com/yxfBQ.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-07-10T11:38:05.050

excel 中的术语不同，您无需“声明变量”，而是“命名”单元格或数组。

您如何做到这一点的一个很好的概述如下： http: [//office.microsoft.com/en-001/excel-help/define-and-use-names-in-formulas-HA010342417.aspx](http://office.microsoft.com/en-001/excel-help/define-and-use-names-in-formulas-HA010342417.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T06:21:52.197

您可以使用（隐藏）单元格作为变量。例如，您可以隐藏 C 列，将 C1 设置为

```
=20 
```

并将其用作

```
=c1*20 
```

或者，您可以编写设置和读取全局变量的 VBA 宏。

**编辑：** [AKX](https://stackoverflow.com/questions/733019/declcaring-variables-in-excel-cells/733044#733044)使我的答案部分不正确。我不知道你可以在 Excel 中命名单元格。

# php - 将 MySQL 查询放在 PHP 循环中是不是很糟糕？

> ID：733023
> 
> 赞同：10
> 
> 时间：2009-04-09T06:15:47.033
> 
> 标签：php, mysql

我经常需要运行 MySQL 查询来处理大型数组或 PHP 中的大量动态数据。

有没有更好的方法来运行诸如 INSERT 或 UPDATE 之类的许多进程，而无需遍历要插入或更新的信息？

示例（为简洁起见，我没有使用准备好的语句）：

```
$myArray = array('苹果','橙子','葡萄');

foreach($myArray as $arrayFruit) {
$query = "INSERT INTO `Fruits` (`FruitName`) VALUES ('" . $arrayFruit . "')";
mysql_query($query, $connection);
}

```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-09T06:20:24.887

选项 1 您实际上可以一次运行多个查询。

```
$queries = '';

foreach(){
    $queries  .= "INSERT....;";  //notice the semi colon
}

mysql_query($queries, $connection); 
```

这将节省您的处理时间。

选项 2

如果您的插入对于同一个表来说很简单，您可以在一个查询中进行多次插入

```
$fruits = "('".implode("'), ('", $fruitsArray)."')";
mysql_query("INSERT INTO Fruits (Fruit) VALUES $fruits", $connection); 
```

查询最终看起来像这样：

```
$query = "INSERT INTO Fruits (Fruit)
  VALUES
  ('Apple'),
  ('Pear'),
  ('Banana')"; 
```

这可能是你想走的路。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-09T17:44:45.573

如果您有 mysqli 类，则可以使用准备好的语句迭代要插入的值。

```
$sth = $dbh->prepare("INSERT INTO Fruits (Fruit) VALUES (?)");
foreach($fruits as $fruit)
{
    $sth->reset(); // make sure we are fresh from the previous iteration
    $sth->bind_param('s', $fruit); // bind one or more variables to the query
    $sth->execute(); // execute the query
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T18:19:14.803

关于您对 jerebear 的内爆方法（我以前使用过，并且很喜欢）的原始解决方案需要注意的一件事是它更容易阅读。内爆需要更多的程序员大脑周期来理解，这可能比处理器周期更昂贵。过早的优化，等等，等等，等等...... :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-12T09:21:56.833

关于 jerebear 在一个 INSERT 中使用多个 VALUE 块的答案需要注意的一件事：

对于真正大量的数据来说，这可能是相当危险的，因为大多数 DBMS 对它们可以处理的命令的大小都有上限。如果您超过了太多的 VALUE 块，您的插入将失败。例如，在 MySQL 上，限制通常是 1MB AFAIK。

因此，您应该弄清楚最大大小是多少（理想情况下，在运行时，可能会从数据库元数据中获得），并通过将值列表分布在多个 INSERT 上来确保不会超过它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T09:10:26.407

我受到 jerebear 的回答的启发，为我当前的一个项目构建了类似于他的第二个选项的东西。由于记录的剪切量，我无法一次保存和处理所有数据。所以我建立[了这个](http://sites.google.com/site/francyci/Home/developmentproject/dataimport-class/DataImport.php)来做进口。您添加数据，然后在每条记录完成后调用一个方法。在达到一定数量的可配置记录后，内存中的数据将通过大量插入（如 jerebear 的第二个选项）保存。

```
// CREATE TABLE example ( Id INT, Field1 INT, Field2 INT, Field3 INT);
$import=new DataImport($dbh, 'example', 'Id, Field1, Field2, Field3');
foreach ($whatever as $row) {
  // add data in the order of your column definition
  $import->addValue($Id);
  $import->addValue($Field1);
  $import->addValue($Field2);
  $import->addValue($Field3);
  $import->nextRow();
}
$import->lastRow(); 
```

# visual-studio-2008 - Visual Studio 2008，管理设置的简单方法？

> ID：733028
> 
> 赞同：1
> 
> 时间：2009-04-09T06:20:11.937
> 
> 标签：visual-studio-2008, settings

Visual Studio 2008 中是否有允许在用户设置文件之间轻松交换的插件或某些隐藏功能？一直使用导入/导出向导有点乏味。如果有一个名为“配置文件”的菜单项，您可以将其设置为包含具有不同设置的不同配置文件并即时更改它们，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T06:31:10.320

可能还有其他可用的东西，但我有一个巧妙的方法来实现你想要的。

在 VS 中，工具 > 外部工具 (wrt VS2005)。在这里，您可以使用菜单编写要执行的命令和工具。现在，您可以在这里做的是交换设置文件并重新启动 VS 实例。您可以有尽可能多的配置文件 1...n 的菜单

更新：示例 1
标题：设置配置文件 1
命令：%windir%\system32\replace.exe
参数：“C:\Documents and Settings\\My Documents\Visual Studio 2005\Settings\CurrentSettings.vssettings”“D:\Profile1\CurrentSettings .vssettings"

这应该用配置文件 1 的设置替换设置。此外，添加命令以重新启动 Devenv。

# java - 为什么我的 @BeforeClass 方法没有运行？

> ID：733037
> 
> 赞同：49
> 
> 时间：2009-04-09T06:22:32.523
> 
> 标签：java, junit, annotations

我有以下代码：

```
 @BeforeClass
    public static void setUpOnce() throws InterruptedException {
        fail("LOL");
    } 
```

以及@Before、@After、@Test 或@AfterClass 方法等各种其他方法。

测试在启动时并没有像它看起来应该的那样失败。有人能帮助我吗？

我有 JUnit 4.5

该方法在对注释为@before 的setUp() 的立即调用中失败。类定义是：

```
public class myTests extends TestCase { 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-09T08:46:25.160

不要同时扩展 TestCase 和使用注解！
如果您需要创建带有注释的测试套件，请使用 RunWith 注释，例如：

```
@RunWith(Suite.class)
@Suite.SuiteClasses({ MyTests.class, OtherTest.class })
public class AllTests {
    // empty
}

public class MyTests {  // no extends here
    @BeforeClass
    public static void setUpOnce() throws InterruptedException {
        ...
    @Test
    ... 
```

*（按照惯例：大写字母的类名）*

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-09T06:24:10.320

该方法[必须是静态](http://junit.org/junit/javadoc/4.5/org/junit/BeforeClass.html)的，不能直接调用fail（否则其他方法不会被执行）。

以下类显示了所有标准 JUnit 4 方法类型：

```
public class Sample {

    @BeforeClass
    public static void beforeClass() {
        System.out.println("@BeforeClass");
    }

    @Before
    public void before() {
        System.out.println("@Before");
    }

    @Test
    public void test() {
        System.out.println("@Test");
    }

    @After
    public void after() {
        System.out.println("@After");
    }

    @AfterClass
    public static void afterClass() {
        System.out.println("@AfterClass");
    }

} 
```

并且输出是（不足为奇）：

```
@BeforeClass
@Before
@Test
@After
@AfterClass 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2020-05-13T15:38:49.880

确保从正确的包中导入 @Test。

*   正确的包：org.junit.Test
*   不正确的包：org.junit.jupiter.api.Test

请注意，这是一个解决方案：如果您的 @Before、@Atter 等根本没有被调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-01T09:06:30.800

确保：

*   您的测试类不继承自 TestCase
*   @BeforeClass 方法是静态的
*   您在测试类层次结构中没有一个以上的 @BeforeClass 方法（只会执行最专业的 @BeforeClass 方法）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-01-06T23:50:39.623

检查你的进口。

*   @前
*   @后
*   @BeforeClass（这应该是静态的）
*   @AfterClass（这应该是静态的）

和 @Test 注释应该从同一路径导入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-30T14:27:46.733

为了运行之前带注释的函数，我必须执行以下操作：如果您使用 Maven，请向 Junit 4.11+ 添加依赖项：

```
 <properties>
              <version.java>1.7</version.java>
              <version.log4j>1.2.13</version.log4j>
              <version.mockito>1.9.0</version.mockito>
              <version.power-mockito>1.4.12</version.power-mockito>
               <version.junit>4.11</version.junit>   
              <version.power-mockito>1.4.12</version.power-mockito>
      </properties> 
```

和依赖：

```
 <dependencies>
        <dependency>
         <groupId>junit</groupId>
         <artifactId>junit</artifactId>
         <version>${version.junit}</version>
         <scope>test</scope>
       </dependency>    
        .
        .
        .
      </dependencies> 
```

确保您的 Junit Test 类没有扩展 TestCase 类，因为这将导致与旧版本重叠：

```
public class TuxedoExceptionMapperTest{
   protected TuxedoExceptionMapper subject;

   @Before
   public void before() throws Exception {
     subject = TuxedoExceptionMapper.getInstance();
      System.out.println("Start");
      MockitoAnnotations.initMocks(this);
   }
} 
```

# php - Zend Framework：一些电子邮件用户在尝试打开 PDF 附件时遇到错误？

> ID：733040
> 
> 赞同：1
> 
> 时间：2009-04-09T06:22:50.213
> 
> 标签：php, email, zend-framework, attachment, aol

我有一个奇怪的问题，不知道如何解决它。我在我的 Zend Framework 控制器中创建了一个脚本，允许管理员登录、上传 PDF 并作为附件发送给订阅邮件列表的每个人。问题是一些用户报告他们无法打开 PDF 附件，文件已损坏。我认为这只会发生在 AOL 用户身上，但我并不肯定。你以前遇到过这个问题吗？或者也许这不是 AOL 的问题，而是我的代码有问题？

这是完成工作的代码：

另外，我使用的是 ZF 1.6.0 版。不确定这是否相关。

```
//assuming the form is valid:
$table = new Subscribers();
$rowset = $table->fetchAll();
foreach ($rowset as $row) {
    $mail = new Zend_Mail();
    $mail->setBodyText($form->getElement('body')->getValue())
         ->setFrom('weekly-update@email.com', 'Weekly Update')
         ->addTo($row->email)
         ->setSubject($form->getElement('subject')->getValue());
    $fileLocation = $form->getElement('attachment')->getValue();
    $fileContents = file_get_contents($fileLocation);
    $attachment = $mail->createAttachment($fileContents);
    $attachment->filename = str_replace(Zend_Registry::get('config')->downloadsLocation . '/', '', $fileLocation);          
    $mail->send();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T06:41:04.447

在这行代码中（对我来说）似乎：

```
$attachment = $mail->createAttachment($fileContents); 
```

您可能需要在 Zend_Mail 框架的 createAttachment 方法中添加额外的头信息：

```
$attachment = $mail->createAttachment($fileContents,
                        Zend_Mime::DISPOSITION_INLINE); 
```

许多较大的电子邮件提供商都严格遵守良好的电子邮件政策（我发现）。

玩这个，我相信你会得到它的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-19T05:39:11.127

我也有这个问题。

我建议您以某种方式追踪文件流信息。我的应用程序的问题是`$fileContents = file_get_contents($fileLocation);`调用没有正确获取文件流，所以这就是你可能会失败的地方。

试试这个：

```
$mail = new Zend_Mail();
...
var_dump($mail->send()); 
```

您应该看到一堆乱码，其中文件流出现在键下的 var_dump 中：

```
["_content:protected"]=>
        string(37129) "%PDF-1.5
        etc... 
```

# ruby-on-rails - 我在创建设备时遇到困难

> ID：733045
> 
> 赞同：0
> 
> 时间：2009-04-09T06:25:01.817
> 
> 标签：ruby-on-rails

我正在创建一个设备，我的设备控制器中有两个动作，`new`并且`create`..我有两个新视图和一个部分形式..

我也有四张桌子..它们是`equipments`, `equipment_types`,`equipment_locations`和`equipment_management_informations`..

表格看起来像..

```
>= error_messages_for 'equipment'
%table.contentText{:style => "width: 100%"}
  - if @types
    %tr
      %td Equipment Type
      %td= collection_select 'equipment', 'equipment_type_id', @types,  :id, :name, {}, :class => "dropdownSelect"
  %tr
    %td Location
    %td= select 'equipment', 'equipment_location_id', @equipment_locations.collect { |e| ["#{e.name.capitalize!}", e.id]},{}, :class => "dropdownSelect"
  %tr
    %td Serial Number
    %td= text_field 'equipment', 'serial_number', :class => 'textFields'
  %tr
    %td MAC Address
    %td= text_field 'equipment', 'mac_address', :class => 'textFields'
  %tr
    %td IP Address
    %td= text_field 'equipment', 'ip_address', :class => 'textFields'
  - if @stands
    %tr
      %td Stand
      %td= collection_select 'equipment', 'stand_id', @stands, :id, :street_no, :include_blank => true
  %tr
    %td{:valign => 'top'} Description
    %td= text_area 'equipment', 'description', :cols => 45, :rows => '3', :class => "txt_area_effect" 
```

我的新观点是：

```
> %h3 New equipment
%div{:style => "border: 1px solid #CCC;"}
  - form_tag :action => 'create', :estate_id => @estate do
    = render :partial => 'form'
    = submit_tag "Create"
    - action = "list"
    %input{:type => "button", :value => "Back", :onclick => "window.location='#{action}';", :class => "start"} 
```

当我检查它时，我的创建操作显示为零

```
 @equipment = Equipment.find(params[:equipment]) 
```

它给出了一个错误

```
 Unknown key(s): equipment_type_id, mac_address, description, equipment_location_id, serial_number, ip_address 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T13:10:20.847

```
@equipment = Equipment.find(params[:equipment]) 
```

应该：

```
@equipment = Equipment.new(params[:equipment]) 
```

或者

```
@equipment = Equipment.new(params[:equipment]) 
```

（只是从评论中发布答案，所以这不再显示为未回答）

# wpf - wpf listview 失去焦点

> ID：733053
> 
> 赞同：10
> 
> 时间：2009-04-09T06:31:29.990
> 
> 标签：wpf, listview

我在 WPF 中有一些奇怪的 ListView 控件行为。

我们正在用 C# 开发应用程序。

我用一些项目创建了 ListView，并将 SelectedIndex 设置为列表中间的某个索引。然后我在 ListView 上的任意位置单击鼠标，然后使用 Up/Dows 键盘键导航，一切正常。但是，如果我将焦点移到另一个控件，然后尝试以编程方式将焦点设置回 ListView 控件，那么我就会遇到问题。

ListView 获得焦点，但是当我尝试使用键盘导航时，当前选择将被取消，第一个项目将被选中，并且导航将从列表中的第一个项目开始。

我通过调用 ListView 控件的 .Focus() 方法将焦点设置为。

即使 SelectedIndex 具有一些有效值，它看起来甚至 ListView 控件都处于焦点中，但实际上没有项目处于焦点中。

请帮我！如何以编程方式将焦点设置到 ListView 控件以防止此类行为？

我发现我的列表视图选择的索引与重点项目不同。谁 ？？？

在 selectedindex_changed 事件中，我将所选索引设置为修复项目 (5)，但是当我按下箭头键时，项目已更改。这意味着选定的索引固定为 5，但当前项目（显示为围绕它的点边框）移动到箭头键位置。无论如何，我的 selecteditem 已修复为 5，但我的滚动视图移动到当前项目的位置。

此代码在 listView1_SelectionChanged 中： listView1.SelectionMode = SelectionMode.Single; listView1.SelectedIndex = 5;

我的列表视图有一个修改后的视图：

```
 <l:PlainView x:Key="tileView"
            ItemTemplate="{StaticResource centralTile}"
            ItemHeight="120" ItemWidth="130" /> 
```

我不再知道这个问题了。

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T01:13:12.783

ListView 可能会遇到与 ListBox 相同的问题，因为它可以拥有独立于其项目的焦点。

当我想聚焦一个 ListBox 时，我需要做这样的事情：

```
listBox1.Focus();
if (listBox1.Items.Count > 0)
{
    var index = listBox1.SelectedIndex;
    if (index < 0) index = 0;

    var item = listBox1.ItemsContainerGenerator
                   .ContainerFromIndex(index) as ListBoxItem;
    item.Focus();
} 
```

因此，这聚焦于 ListBox，但如果 ListBox 包含任何项目，则它聚焦于选定项目或第一个项目（如果已选择一个项目）。

我从未在 WPF 中使用过 ListView，但大概您可以使用 ListView 而不是 ListBox 和[ListViewItem](http://msdn.microsoft.com/en-us/library/system.windows.controls.listviewitem.aspx)代替 ListBoxItem 来破解类似的方法。

# c++ - 有没有办法在 C++ 函数中获取函数名？

> ID：733056
> 
> 赞同：40
> 
> 时间：2009-04-09T06:33:30.237
> 
> 标签：c++, macros, profiling

我想实现一个函数跟踪器，它将跟踪函数执行所需的时间。我有以下相同的课程：-

```
class FuncTracer
{
    public:
        FuncTracer(LPCTSTR strFuncName_in)
        {
            m_strFuncName[0] = _T('\0');
            if( strFuncName_in ||
                _T('\0') != strFuncName_in[0])
            {   
                _tcscpy(m_strFuncName,strFuncName_in);

                TCHAR strLog[MAX_PATH];
                _stprintf(strLog,_T("Entering Func:- <%s>"),m_strFuncName);
                LOG(strLog)

                m_dwEnterTime = GetTickCount();
            }
        }

        ~FuncTracer()
        {
            TCHAR strLog[MAX_PATH];
            _stprintf(strLog,_T("Leaving Func:- <%s>, Time inside the func <%d> ms"),m_strFuncName, GetTickCount()-m_dwEnterTime);
            LOG(strLog)
        }

    private:
        TCHAR m_strFuncName[MAX_PATH];
        DWORD m_dwEnterTime;
};

void TestClass::TestFunction()
{
    // I want to avoid writing the function name maually..
    // Is there any macro (__LINE__)or some other way to 
    // get the function name inside a function ??

    FuncTracer(_T("TestClass::TestFunction"));
    /*
     * Rest of the function code.
     */
} 
```

我想知道是否有任何方法可以从函数内部获取函数的名称？基本上我希望我班级的用户简单地创建一个相同的对象。他们可能不会传递函数名称。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-09T06:42:06.690

C99 有`__func__`，但对于 C++，这将是特定于编译器的。从好的方面来说，一些特定于编译器的版本提供了额外的类型信息，这在您在模板化函数/类中进行跟踪时特别好。

*   [MSVC](http://msdn.microsoft.com/en-us/library/b0084kay.aspx) : `__FUNCTION__`, `__FUNCDNAME__`,`__FUNCSIG__`
*   [海合会](http://gcc.gnu.org/onlinedocs/gcc/Function-Names.html): `__func__`, `__FUNCTION__`,`__PRETTY_FUNCTION__`

[Boost 库在 header boost/current_function.hpp](http://www.boost.org/doc/libs/1_62_0/boost/current_function.hpp)`BOOST_CURRENT_FUNCTION`中为大多数 C++ 编译器定义了宏。如果编译器太旧而无法支持此功能，则结果将是“（未知）”。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-09T06:36:14.753

VC++有

```
__FUNCTION__ for undecorated names 
```

和

```
__FUNCDNAME__ for decorated names 
```

你可以编写一个宏，它自己会分配一个对象，并在构造函数中传递名称宏。喜欢

```
#define ALLOC_LOGGER FuncTracer ____tracer( __FUNCTION__ ); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2020-03-02T14:49:47.947

**C++20`std::source_location::function_name`**

这基本上完全符合您的要求。

[https://en.cppreference.com/w/cpp/utility/source_location](https://en.cppreference.com/w/cpp/utility/source_location)声明用法如下：

```
#include <iostream>
#include <string_view>
#include <source_location>

void log(std::string_view message,
         const std::source_location& location = std::source_location::current()
) {
    std::cout << "info:"
              << location.file_name() << ":"
              << location.line() << ":"
              << location.function_name() << " "
              << message << '\n';
}

int main() {
    log("Hello world!");
} 
```

可能的输出：

```
info:main.cpp:16:main Hello world! 
```

所以请注意呼叫如何保留呼叫者信息，因此我们看到所需的`main`呼叫位置而不是`log`.

我在以下位置更详细地介绍了相关标准：[__PRETTY_FUNCTION__、__FUNCTION__、__func__ 之间有什么区别？](https://stackoverflow.com/questions/4384765/whats-the-difference-between-pretty-function-function-func/31163837#31163837)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T06:43:29.743

我本来想说我不知道​​这样的事情，但后来我看到了其他答案......

您可能有兴趣知道执行分析器（如`gprof`）完全按照您的要求执行 - 它跟踪执行每个函数所花费的时间。分析器的工作原理是每隔 10 毫秒左右记录一次指令指针 (IP)、当前执行指令的地址。程序运行完毕后，您调用一个后处理器来检查 IP 列表和程序，并将这些地址转换为函数名称。所以我建议只使用指令指针，而不是函数名，因为它更容易编码，而且使用单个数字比使用字符串更有效。

# git - git可以通过ssh端口转发工作吗？

> ID：733057
> 
> 赞同：10
> 
> 时间：2009-04-09T06:33:32.887
> 
> 标签：git, ssh

我的情况是，我可以 ssh 到放置 git repos 的 ComputerB（代码仓库）。但是我的本地连接速度太慢，无法克隆代码。而且我可以ssh到另一台速度更快的机器（ComputerA），所以我想通过ComputerA克隆代码。

这就是我所做的：

```
 ssh tunnel                           ssh tunnel
MyComputer ----------> ComputerA (I can ssh to) ----------> ComputerB (where the Code repos is and I can ssh to but too slow) 
```

使用这样的命令：

```
ssh -L1234:ComputerA_ip:22 Code_repos_ip 
```

然后：

```
git clone git+ssh//localhost/repos local_repos (how can I assign the port 1234?) 
```

如果这不起作用，我还能做什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-09T06:38:04.327

通过两个连接将如何使您的连接更快？

无论如何，你应该能够做到：

```
git clone git+ssh://localhost:1234/repos local_repos 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-09T08:33:20.900

此外，您可以尝试将端口号放入您的`~/.ssh/config`：

```
Host ComputerA
HostName localhost
Port 1234 
```

然后在 git clone 命令中使用 ComputerA：

```
git clone git+ssh://ComputerA/repos local_repos 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T07:51:03.717

查看 SSH 的命令文件。当您通过 SSH 登录时，您可以自动执行命令。这是在 authorized_keys 文件中指定的。因此，在计算机 A 上，您将拥有一个自动 SSH-es 到计算机 B 的命令文件。然后，当您连接到计算机 A 时，它会自动连接到计算机 B。对于您的计算机，它直接连接到计算机 B。您甚至可以使用压缩隧道。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-09T06:37:48.633

首先克隆到ComputerA，然后从ComputerA 克隆到ComputerB。不过，您必须通过 ssh 连接到 ComputerA 才能获取新内容。

# c - 没有存根的 C RPC

> ID：733059
> 
> 赞同：2
> 
> 时间：2009-04-09T06:34:26.333
> 
> 标签：c, rpc

我有这个程序，我希望其他进程能够（通过 unix 套接字）调用函数。消息协议非常简单，函数名、函数签名和保存参数的缓冲区（char *）。

当我的程序中的一个模块想要允许访问某个函数时，它会向库注册名称和签名。我面临的问题是一旦请求进入就物理调用该函数。我查看了 RPC 和 java RMI 类库，但这些库需要我生成存根来包装调用。我正在开发的系统非常动态，我还必须与其他人的代码进行交互，而我无法修改这些代码。

所以基本上，一个函数可能看起来像：

```
int somefunc(int someparam, double another)
{
    return 1234;
} 
```

现在我在图书馆注册：

```
//           func ptr   name       signature
REG_FUNCTION(somefunc, "somefunc", "i:id"); 
```

当请求进来时，我会做一些错误检查，一旦有效我想调用该函数。所以我有变量：

```
void * funcptr = (the requested function);
char * sig = (the function signature);
char * params = (a buffer of function parameters);
//note that the params buffer can hold data types of arbitrary lengths 
```

如何使用 C 中的参数调用函数？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T06:55:37.610

我认为这通常不能完全解决，仅使用 C。例如，您不知道目标函数使用的调用约定。您最终可能会“欺骗”编译器，或者至少不得不对其进行猜测。如果编译器决定使用在寄存器中传递的参数来构建注册函数怎么办，可能是由于一些优化设置（或者如果它是用不同的编译器构建的呢？）。

通常也没有办法在 C 中表达您想要调用具有给定参数集的函数，并且参数的值需要从随机字节的缓冲区中解压缩。

你可以做一些像这样可怕的事情：

```
enum { VOID_INT, VOID_INT_DOUBLE, VOID_DOUBLE_INT, ... } Signature;

void do_call(const void *userfunction, const void *args, Signature sig)
{
  switch(signature)
  {
    case VOID_INT:
    {
      int x = *(int *) args;
      void (*f)(int) = userfunction;
      f(x);
      break;
    }
    case VOID_INT_DOUBLE:
    ...
  }
} 
```

但很明显，这与可扩展性不同。您当然可以为一些合理的返回类型和参数类型自动生成此代码。对于将函数指针转换为 / 从 ，您仍然会感到有些冷落`void *`，但这可能是可以接受的。但是，您仍然总是冒着有人将签名交给您的风险，而您没有预先生成的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-23T13:26:18.603

查看[libffi](http://sourceware.org/libffi/)。该库允许使用在运行时指定的一组参数调用函数。

# xml - 外部化junit存根对象

> ID：733067
> 
> 赞同：0
> 
> 时间：2009-04-09T06:38:02.410
> 
> 标签：xml, unit-testing, junit, xstream, stub

在我的项目中，我们创建了用于在 java(factories) 本身中测试 junit 的存根文件。但是，我们必须将这些存根外部化。在看到许多序列化器/反序列化器之后，我们决定使用 XStream 来序列化和反序列化这些存根对象。[XStream](http://xstream.codehaus.org/)就像一个魅力。它非常擅长它声称的内容。以前，我们有一个工厂类，比如 AFactory，它生成测试不同测试用例所需的所有存根。现在，当外部化每个生成的存根时，我们遇到了障碍。我们必须为工厂生产的每个存根创建 1 个 xml 文件。
例如，

```
public final class AFactory{
     public static A createStub1(){ /*Code here */}
     public static A createStub2(){ /*Code here */}  
     public static A createStub3(){ /*Code here */}
} 
```

现在，当尝试将此存根移动到外部文件时，我们必须为创建的每个存根创建 1 个 xml 文件（A-stub1.xml、A-stub2.xml 和 A-stub3.xml）。这种方法的问题在于，它会导致 xml 存根文件的扩散。

我在想，如何将与单个 bean 类相关的所有存根保存在单个 xml 文件中。

```
<?xml version="1.0"?>
<stubs class="A">
    <stub id="stub1">
      <!-- Here comes the externalized xml stub representation -->
    </stub>
    <stub id="stub2">
    </stub>
</stubs> 
```

是否有一个框架允许您将 xml 表示中的所有存根保存在一个 xml 文件中，如上？或者你们建议应该坚持的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-15T18:07:53.450

我不确定您为什么要尝试以这种方式将对象外部化。您是否正在尝试维护一组可以手动编辑的“测试对象”？由于不了解您实际要完成的工作，我建议最好在测试类中将其实现为 setUp/tearDown 代码。使用像[JMock](http://www.jmock.org/)这样的库会使这变得容易得多。

也就是说，如果您真的想将这些对象保存为序列化的 XML 文件，您可以简单地通过创建一个“容器”类来保存您的单个对象的数组/集合。当容器对象被序列化时，包含的存根将与它一起存储。

```
public class StubContainer implements Serializable {
   private ArrayList<Serializable> stubs = new ArrayList<Serializable>();

   public ArrayList<Serializable> getStubs() { 
     return stubs;
   }

   public void setStubs(ArrayList<Serializable> stubs) {
     this.stubs = stubs; 
   }
} 
```

顺便说一句，如果您的需求很简单，您可以尝试使用JRE 中内置的[XMLEncoder](http://java.sun.com/j2se/1.4.2/docs/api/java/beans/XMLEncoder.html) / [XMLDecoder 。](http://java.sun.com/j2se/1.4.2/docs/api/java/beans/XMLDecoder.html)它们使用起来非常简单，只要您对 XML 格式的细节不太挑剔。

# c - 编译到 LLVM 的问题

> ID：733082
> 
> 赞同：10
> 
> 时间：2009-04-09T06:46:25.477
> 
> 标签：c, compiler-construction, llvm, backend

我一直在玩[LLVM](http://en.wikipedia.org/wiki/Low_Level_Virtual_Machine) ，希望学习如何使用它。

然而，界面的复杂程度让我大吃一惊。

以他们的斐波那契函数为例

```
int fib(int x) {
    if(x<=2) 
        return 1;
    return fib(x-1) + fib(x-2);
   } 
```

要让它输出 LLVM IR，需要**61 行代码**！！！

它们还包括以拥有最小编译器（200 字节）而闻名的 BrainFuck。不幸的是，使用 LLVM，它超过**600 行**(18 kb)。

这是编译器后端的规范吗？到目前为止，执行汇编或 C 后端似乎要容易得多。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-12T18:54:33.983

问题在于 C++ 而不是 LLVM。

使用专为元编程设计的语言，如[OCaml](http://www.ffconsultancy.com/products/ocaml_journal/?so)，您的编译器将大大缩小。例如，[这篇 OCaml Journal 文章描述了一个 87 行的基于 LLVM 的 Brainfuck 编译器](http://ocamlnews.blogspot.com/2008/09/writing-bytecode-compiler-using-llvm.html)，[这篇邮件列表文章描述了完整的编程语言实现，包括](http://groups.google.com/group/fa.caml/msg/5aee553df34548e2)可以编译 Fibonacci 函数（以及其他程序）的解析器，整个编译器不到 100 行 OCaml代码使用 LLVM，而[HLVM 是一个高级虚拟机，使用 LLVM 在 2,000 行以下 OCaml 代码中具有多核垃圾收集功能](http://hlvm.forge.ocamlcore.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T07:58:09.020

LLVM 是否不会根据后端实现的特定架构来优化 IR？IR 代码不会直接 ​​1:1 转换成最终的二进制文件。据我了解，这就是它的工作原理。但是，我才刚刚开始使用后端（我将其移植到自定义处理器上）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T14:46:36.073

LLVM 确实需要一些样板代码，但是一旦你理解了它，它真的很简单。尝试寻找一个简单的 GCC 前端，你就会意识到 LLVM 是多么的干净。我肯定会推荐 LLVM 而不是 C 或 ASM。ASM 根本不可移植，生成源代码通常是一件坏事，因为它会使编译速度变慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-09T01:48:07.853

与非虚拟汇编器相比，中间表示可能有点冗长。我了解到查看 .NET IL，尽管我从来没有比查看更进一步。我对 LLVM 不是很熟悉，但我想这是同一个问题。

但是，当您考虑它时，它是有道理的。一个很大的区别是 IR 必须处理大量元数据。在汇编器中几乎没有 - 处理器隐含地定义了很多，而函数调用之类的约定留给程序员/编译器来定义。这很方便，但会带来很大的可移植性和互操作问题。

.NET 和 LLVM 等中间表示关心确保单独编译的组件可以一起工作——即使是用不同语言编写并由不同编译器前端编译的组件。这意味着需要元数据来描述在更高级别上发生的事情，例如，可能是参数处理的任意推送、弹出和加载，但可能只是任何事情。回报是相当大的，但要付出代价。

还有其他问题。中间表示并不是真的要由人类编写，但它应该是可读的。此外，它的通用性足以在多个版本中生存，而无需完全不兼容的从头重新设计。

基本上，在这种情况下，显式几乎总是比隐式好，因此很难避免冗长。

# keyword - oracle 9i 中的 top 关键字

> ID：733085
> 
> 赞同：1
> 
> 时间：2009-04-09T06:49:05.033
> 
> 标签：keyword

在 oracle 9i 中使用 top 关键字的格式是什么？我必须检索前 10 名记录..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T06:54:46.957

使用 RANK 函数，如...

```
select
   *
from
   (select empno,sal,rank()
    over (order by sal desc ) rnk
    from emp)
where rnk <= 5; 
```

查询是从[这里获取的](http://www.dba-oracle.com/oracle_news/oracle_faq/faq_beg_sql_top_n_rows.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T06:55:33.257

从 tbl1 中选择 column1,column2，其中 rownum<=10

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T06:55:02.447

您可以使用[rownum 关键字](http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html)

```
SELECT * FROM (your ordered query)  WHERE ROWNUM <= 10 
```

# tomcat - Tomcat6，如何解释停止服务事件？

> ID：733086
> 
> 赞同：1
> 
> 时间：2009-04-09T06:49:46.140
> 
> 标签：tomcat, tomcat6, lifecycle

当tomcat服务出现故障时，我想采取一些措施。例如，我想简单地记录一下 tomcat 服务的停止时间。有没有办法通过将钩子应用于 tomcat 生命周期事件来做到这一点？如果是，那么请提供一些细节。
我想在tomcat宕机时调用一个类，这个类会将时间记录在某个属性文件中。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:09:29.510

您必须实现接口**org.apache.catalina.LifecycleListener**，然后在您的 tomcat 配置中注册它。您可以在[本文档的](http://tomcat.apache.org/tomcat-6.0-doc/config/host.html)**Lifecycle Listeners**部分找到如何操作。

希望这可以帮助你..

**编辑：**将 URL 更改为正确的文档 ;-)

# compiler-theory - （何时）我应该学习编译器吗？

> ID：733093
> 
> 赞同：40
> 
> 时间：2009-04-09T06:55:14.193
> 
> 标签：compiler-theory

根据这篇[http://steve-yegge.blogspot.com/2007/06/rich-programmer-food.html](http://steve-yegge.blogspot.com/2007/06/rich-programmer-food.html) 文章，我绝对应该。

> 引用温和但坚持的执行摘要：如果你不知道编译器是如何工作的，那么你就不知道计算机是如何工作的。如果你不能 100% 确定你是否知道编译器是如何工作的，那么你就不知道它们是如何工作的。

本来觉得是一篇很有意思的文章，应用领域很有用（帮自己一个忙，看一下） 不过话说回来，我见过成功的高级sw工程师，对编译器不是很了解，或者内部机架构，但确实知道以下列表中每个项目的一两件事：

*   编程范式（OO、函数式……）
*   一个编程语言 API（C#、Java ..）和至少 2 个非常不同的人说！（Java/哈斯克尔）
*   一个编程框架（Java、.NET）
*   一个让您更有效率的 IDE（Eclipse、VisualStudio、Emacs ......）
*   编程最佳实践（例如，参见 fxcop 规则）
*   编程原则（DRY、高内聚、低耦合……）
*   编程方法（[TDD](http://en.wikipedia.org/wiki/Test-driven_development)， [MDE](http://en.wikipedia.org/wiki/Model_Driven_Engineering)）
*   设计模式（结构、行为……）
*   架构基础（层、层、流程模型（瀑布、敏捷……）
*   测试工具（单元测试、模型测试……）
*   一种 GUI 技术（WPF、Swing）
*   文档工具（Javadoc、Sandcastle..）
*   一种建模语言（可能还有工具）（UML、VisualParadigm、Rational）
*   （无疑在这里忘记了非常重要的东西）

并非所有这些工具都是成为一名优秀程序员所必需的（就像您不需要它时的 GUI），但大多数都是。编译器从何而来，它们真的那么重要吗，因为，正如我所提到的，许多程序员似乎在不了解它们的情况下做得很好，特别是，成为一名优秀的程序员被视为众多知识领域几乎是一生的成就：- ) ，所以即使编译器非常重要，难道不是总有更重要的东西吗？

或者我今天应该订购'The Unleashed Compilers Unlimited Bible (in 24H..))) 吗？

对于那些已经阅读文章并想立即开始学习的人：

[解析器、解释器和编译器的学习资源](https://stackoverflow.com/questions/41785/learning-resources-on-parsers-interpreters-and-compilers)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-09T07:31:07.227

如果你只是想成为一个普通的编码员，然后写一些东西……你不需要编译器。

如果你想学习计算机科学并欣赏并真正成为一名计算机科学家，你*必须*学习编译器。

编译器是计算机科学的缩影！它包含每一个问题，包括（但不限于）人工智能（贪婪算法和启发式搜索）、算法、理论（形式语言、自动机）、系统、架构等。

你会看到很多计算机科学以惊人的方式融合在一起。您不仅会更多地了解为什么编程语言会以它们的方式工作，而且您将成为更好的编码员，因为有了这种理解。你将学会理解低层次，这有助于高层次。

作为程序员，我们经常喜欢将事物称为“黑盒子”……但是当您对盒子中的内容有所了解时，事情就会变得更加顺畅。即使你不构建一个完整的编译器，你也一定会学到很多东西。您将看到解析背后的形式（并意识到这不仅仅是一堆特殊情况的组合），以及一堆 NP 完全问题。您将了解为什么计算机科学理论对于理解实际事物如此重要。（毕竟，编译器非常实用……如果没有形式主义，我们今天的编译器就不会存在）。

我真的希望您考虑了解它们...它将帮助您作为计算机科学家进入下一个层次:-)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T07:16:38.120

您应该了解编译器，原因很简单，**实现编译器会让您成为更好的程序员**。编译器肯定会很糟糕，但在此过程中你会学到很多东西。这是提高（或练习）您的编程技能的好方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-09T06:59:34.790

您不需要了解编译器即可成为一名优秀的程序员，但它可以提供帮助。我在了解它们时意识到的一件事是，编译只是一种翻译。

如果您曾经将一种语言翻译成另一种语言，那么您刚刚完成了编译。

* * *

那么什么时候应该学习编译器呢？

当您想要或需要它来解决问题时。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T07:01:04.163

编译器理论很有用，但不是必需的。

尽管有一些技术可以派上用场，比如词法分析和解析。

另一个是错误处理。编译器需要很多这些。用户输入可以包含任何内容，甚至是意料之外的内容。你需要处理所有这些。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-09T07:20:21.497

如果您要在一个足够高的水平上工作，并且担心 UML 和自描述代码，那么您可以轻松地完成整个职业生涯，而无需或不需要编译器如何工作的详细信息。

但是，如果你是一名底层编码人员并且没有管理你朋友的愿望，那么很可能有一天，你会意识到你正在与你的编译器进行战争。这可能是随机出现的错误，也可能是关于 while-verses-for 循环的走廊对话。你会意识到组装（或 IL，很可能，在未来几年）只是在你需要的东西的左边一点，另一个宇宙将会展开。

所以，我想我的答案是，现在只注意编译器，它做了很多事情，但不要太担心它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-09T07:55:04.160

如果您打算编写对时间要求极高的实时代码，您将从了解编译器如何优化您的代码中受益。但是，您实际上将从了解硬件的底层架构中受益更多。

根据我的经验，如果您了解硬件的工作原理以及编译器如何解释您的代码，您将能够编写出完全符合您预期的代码。我曾多次被抓到，编写的代码被编译器优化掉，并使硬件做一些我不打算做的事情。

总而言之，了解整个软硬件堆栈对于编写好的算法和代码并不是必不可少的，但它肯定会有所帮助！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-09T07:02:19.370

编译器课程通常侧重于如何分析高级代码并将其转换为机器代码。这很有趣，但并不重要。更重要的是了解编译器生成的机器代码是什么，这样您才能了解计算机的工作原理以及每种语言构造的成本是多少。

所以我宁愿说你应该知道一种汇编语言（我的意思是一种架构的汇编语言的有限子集）来理解计算机是如何工作的，而后者对于有能力的程序员来说绝对是必需的，这样他才能理解什么是分段错误，何时优化，何时不优化等类似的低级事物。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-02T09:17:46.467

从实践的角度来看，一般编译器理论比特定平台的汇编器、链接器和加载器**更受关注。**例如，我只是将 GCC 编译器视为 x86 平台上从我的高级 C 语言到低级汇编语言的翻译器。而且通常情况下，我会手动**优化**;) 编译器生成的代码。

从科学的角度来看，我强烈建议你学习编译器理论，它会帮助你理解构建计算机的伟大**理念。**更重要的是，您将对世界有不同的看法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-01T13:55:44.510

只是我的意见，但我相信编译器在 CS 课程中没有得到足够的关注，在我的课程中没有，在其他任何 afaik 中都没有。我认为任何 CS 专业的学生在休假或完成专业后都应该做两件事：必要时重新学习有限自动机和形式方法语言。应用它。用这些知识编写一个简单的编译器。Alex Aiken 有一个非常有用的在线教程，介绍如何为 COOL（面向对象的课堂语言）编写编译器，它是 Scala 的子集，截至 2013 年版本。至少在撰写本文时。

# iphone - 我可以在目标 c 中使用没有默认蓝色的突出显示的表格视图单元格吗？

> ID：733095
> 
> 赞同：1
> 
> 时间：2009-04-09T06:55:26.860
> 
> 标签：iphone, objective-c

我在做一个项目，我需要使用突出显示的表格视图颜色而不是默认颜色。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T08:31:35.117

当然可以。

有两种方法可以实现这一点：

1.  使用`UITableViewCell`的`selectedBackgroundView`和`selectedTextColor`属性
2.  子类`UITableViewCell`化并实现`drawInRect`and`setSelected:animated:`方法

后一个选项为您提供更大的灵活性和更好的性能，但如果您以前没有使用过 CoreGraphics，它可能会稍微困难一些。

**更新**回应OP的评论：

以下是您可以使用该`selectedBackgroundView`属性的方法：

```
UIView *bgView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 60)];
[bgView setBackgroundColor:[UIColor redColor]];
[cell setSelectedBackgroundView:bgView];
[bgView release]; 
```

我自己没有尝试过，但它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-13T08:55:48.267

尝试参考[这个演示](http://code.google.com/p/table-group-cell-background-color-demo/)- 也许你可以看看它并获得一些帮助。

# vb.net - 如何根据另一个字段的值从分组总和中排除一个值？

> ID：733100
> 
> 赞同：0
> 
> 时间：2009-04-09T06:59:30.640
> 
> 标签：vb.net, reporting-services, reportingservices-2005

如何根据另一个字段的值从分组总和中排除一个值？

即我打开报告=> 报告属性=> 代码并插入我的自定义代码，但是我将如何更改以下代码以排除以下情况下另一个字段的数值？

```
Public Function ChangeWord(ByVal s As String) As String
   Dim strBuilder As New System.Text.StringBuilder(s)
   If s.Contains("Others") Then
      strBuilder.Replace("Others", "Other NOT INCL")
      Return strBuilder.ToString()
      Else : Return s
   End If
End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T07:51:49.847

我假设您想从总和中排除一个数值，其中同一行上的单元格的字符串值包括“其他”，并且您提供的函数用作报告中表格的分组标准. 抱歉，如果这不正确。

`Iif`如果不使用第二条逻辑，无论是函数还是条件，都无法做到这一点。我目前没有可用的 SSRS 来测试这个，但是（假设你的 value 列是一个整数，代码看起来像：

```
Public Function ExcludeOthers(rowDesc As String, rowVal as integer)
    if ChangeWord(rowDesc) = "Other NOT INCL"
        Return 0
    else
        Return rowVal
    end if
End Function 
```

然后，在您希望条件和出现的单元格中：

```
=Sum(ExcludeOthers(Fields!desc.Value,Fields!val.Value)) 
```

或者，您可以在不使用该函数的情况下执行此操作，方法`Iif`是在将出现条件和的单元格中使用：

```
=Sum(Iif(ChangeWord(Fields!desc.Value) = "Other NOT INCL",0,Fields!desc.Value)) 
```

根据源数据的性质，您还可以通过将计算列添加到报表的源查询来执行此操作。

我倾向于第二个或第三个选项 - 为此目的，自定义代码似乎有点过分了。

# silverlight - 如何确定是否在 Silverlight 应用程序中切换了 Caps Lock？

> ID：733102
> 
> 赞同：5
> 
> 时间：2009-04-09T06:59:51.717
> 
> 标签：silverlight, dllimport, user32

在 Silverlight 应用程序的登录屏幕中，我需要确定是否切换了 Caps Lock。这很容易通过处理 KeyUp 或 KeyDown 事件，但是即使没有按下某个键，如何确定它是打开还是关闭？

我想这样做的原因是，如果用户在 Silverlight 应用程序运行时没有按 Caps Lock，而是在进入登录屏幕之前切换了它，该怎么办？我仍然需要警告他们大写锁定已打开。

显然，在 Silverlight 中无法处理非托管代码，因此以下内容不起作用。

[DllImport("user32.dll")] internal static extern short GetKeyState(int keyCode);

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T07:23:40.147

检测 CAPS LOCKS 的方法是检查 KeyValue 和 KeyEventArgs 的 Shift。
如果 KeyValue 为（例如）“A”但 Shift 为假，则 CAPS LOCKS 处于打开状态。
不是最好的方法，但它[是如何 ajax 应用程序一直在做](http://blog.dougalmatthews.com/2008/07/javascript-detecting-caps-lock/)的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T07:10:09.227

据我所知，你不能。您可能能够从您的应用中获取上下键，但如果用户离开您的应用，您将不知道它处于什么状态。

我没有注意到 SL3 中对它有任何额外的支持，但我不能说我一直在特别寻找它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T07:14:31.637

Silverlight 不支持在客户端调用 Win32 DLL。所以你不能使用上面的技术来测试 Capslock 键是否被按下。您是否尝试过使用 KeyDown 事件并测试系统键？我没有这样做，但这是一种预感。

# c# - 表单 DataGridView 缺少 OnRowDataBound？

> ID：733103
> 
> 赞同：4
> 
> 时间：2009-04-09T06:59:53.433
> 
> 标签：c#, .net, asp.net, winforms

昨天一位同事问我如何在网格中显示数据，其中内置数据绑定不支持他想要对某些列执行的操作。

很高兴能够帮助我解释了有关 OnRowDataBound 事件的所有内容，以及如何挂钩它并动态地操作行对象中的单元格以执行您想要的操作。伟大的。如果您正在使用 asp.net。

唯一的问题是他正在编写一个 winforms 应用程序并且 DataGridView 不支持 OnRowDataBound！我简直不敢相信，但它根本不存在。

那么winforms的家伙到底是如何管理这个的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T09:13:06.063

RowsAdded[事件大致等效，但由于它使用](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowsadded.aspx)[共享内存状态](http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx)，使用此事件访问行可能会遇到性能问题。这本质上是一种方案，其中 DataGridView 尝试通过在可能的情况下在行之间共享一些状态来最小化其内存占用，*直到*您访问其中一个共享行，这会导致它取消共享状态（内存和可能的性能损失）。很多东西已经被优化掉了，但是我在使用这个事件时遇到了一些问题。

因此，如果 RowsAdded 对您有用且不会降低性能，那就太好了。如果没有，你还有很多选择。您可以从 DataGridViewCell 和 DataGridView 派生以将自定义单元格（列）类型添加到网格。这可能是自定义 DataGridView 的最复杂的方法......但它几乎可以实现您想要的任何类型的单元格操作。

如果您希望在显示之前使用 GDI+ (System.Drawing) 绘制某些内容，CellPainting 事件为您提供了一个特定单元格绘制的钩子[。](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellpainting.aspx)还有一个[CellFormatting](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx)事件，它也为您提供特殊的事件参数 - 但我从未使用过那个，所以我不确定共享内存状态问题是否适用（通常对于绘画事件它不适用）。

HTH，理查德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T09:00:41.957

我不太确定，因为我也是一个 ASP.NET 人，但是在 winforms 中，您在真正的有状态环境中工作，而不是“伪有状态”（通过视图状态）环境。

因此，由于在将所有内容刷新到响应之前无需执行所有操作（例如更改单元格样式等），因此您可以等到数据完成绑定，然后根据需要更改每一行，您仍然可以数据源也是如此，所以如果你需要用它做更多的事情，就使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T11:20:53.697

> *因此，由于在将所有内容刷新到响应之前无需执行所有操作（例如更改单元格样式等），因此您可以等到数据完成绑定，然后根据需要更改每一行，您仍然可以数据源也是如此，所以如果你需要用它做更多的事情，就使用它。*

为了清楚起见，datagridview 当前已绑定，显示现有绑定列。现在，我需要在 datagridview 中添加新列，然后显示字典对象中的一些值。

试过了，这段代码，但没有运气。添加了列，但不显示值。

```
 if (dvMain.Columns[key] == null)
                    {
                        dvMain.Columns.Add(key, key);
                    }
                    dvMain[key,i].Value = myDictionary[key]; 
```

# asp.net-mvc - 单元测试适配器抛出异常：无法在 ASP.NET MVC 中加载一个或多个...

> ID：733114
> 
> 赞同：4
> 
> 时间：2009-04-09T07:05:55.743
> 
> 标签：asp.net-mvc

使用 ASP.NET MVC 1.0（当前）我在 x64 机器（Server 2008）上使用 Visual Studio 2008 创建了一个新的默认 ASP.NET MVC 项目，并接受所有默认值并构建并运行它。除了必须将 System.Web.* 程序集设置为“复制本地”之外，它还会运行并显示默认的 Web 应用程序。当我尝试在这个项目上运行单元测试时，我得到：

单元测试适配器抛出异常：无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

现在，如果我在 x86 机器（Server 2003）上使用 VS2008 重复相同的练习，那么所有 27 个默认单元测试都可以正常运行。（另外我不需要将 System.Web.* 程序集标记为“复制本地”）

解决异常的想法？

更多信息：在尝试了一些建议的解决方案后，我开始注释掉由新项目生成的部分样板测试代码。因此，我认为包含以下类之一会产生错误：

```
 public class MockIdentity : IIdentity
    {
        public string AuthenticationType
        {
            get
            {
                return "MockAuthentication";
            }
        }

        public bool IsAuthenticated
        {
            get
            {
                return true;
            }
        }

        public string Name
        {
            get
            {
                return "someUser";
            }
        }
    }

    public class MockPrincipal : IPrincipal
    {
        IIdentity _identity;

        public IIdentity Identity
        {
            get
            {
                if (_identity == null)
                {
                    _identity = new MockIdentity();
                }
                return _identity;
            }
        }

        public bool IsInRole(string role)
        {
            return false;
        }
    }

    public class MockMembershipUser : MembershipUser
    {
        public override bool ChangePassword(string oldPassword, string newPassword)
        {
            return newPassword.Equals("newPass");
        }
    }

    public class MockHttpContext : HttpContextBase
    {
        private IPrincipal _user;

        public override IPrincipal User
        {
            get
            {
                if (_user == null)
                {
                    _user = new MockPrincipal();
                }
                return _user;
            }
            set
            {
                _user = value;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T13:46:36.097

首先，您是否在 Release 配置中尝试过？您是否对解决方案进行了清理？

您是否尝试过构建您的测试项目？取出测试的源文件，从解决方案中删除项目并添加一个引用 MVC 应用程序的新测试项目。然后重新添加测试源文件。

**编辑**

您正在使用和实现的类和接口是否在您的测试范围内？

**编辑** 它是否引用 x64 而不是 x86 dll？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T15:37:50.097

你的 Win2k8 盒子里安装了 VS 2008 SP1 和 .NET 3.5 SP1 吗？默认情况下，VS 2008 安装了 3.5 框架，但没有安装 SP1。确保您同时安装了框架 SP1 和 VS 2008 SP1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T02:40:52.317

我不确定 x64 与 x86 发生了什么的微妙之处，但使用自定义身份/主体可能会导致一些有趣的小故障发生，特别是如果使用 cassini（内置的 vshost 网络服务器 - 我认为这就是您最终通过在 VS 中运行本地单元测试来使用）。我之前遇到过这个问题，而不是在这里详细说明，我将发布一个指向一些有用信息的链接。同样，我不确定这是否与您的问题有关（我不是 MVC 大师），但请仔细阅读。深思熟虑：

[http://www.lhotka.net/weblog/UpdateOnMyStrugglesWithTheASPNETDevelopmentServer.aspx](http://www.lhotka.net/weblog/UpdateOnMyStrugglesWithTheASPNETDevelopmentServer.aspx)

编辑：所以最终，这可能是序列化失败的问题，即使这个特殊的边缘情况不相关。您是否尝试将模拟的 iidentity/iprincpal 对象标记为 [serializable]？请记住，Visual Studio 是一个 32 位应用程序；也许在具有 64 位应用程序池的 IIS（如果不是 cassini）上对其进行测试会导致某处发生上下文切换，从而导致模拟身份（如果它们被分配为线程的身份）跨过这样的边界进行编组 - 缺少 [ serializable] 属性可能会导致 TypeLoadException。

如果将 IIS 设置为使用 32 位应用程序池（在 64 位服务器上），它仍然会抛出吗？

-Oisin

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T13:29:31.667

您是否尝试在 x64 机器上将您的项目构建为 x86 项目（项目属性 -> 构建 -> 平台目标）？

此外，不确定您的单元测试工具包，但例如 NUnit 可以作为 x86 或 x64（在 x64 机器上）的测试运行。如果您的程序集之一访问某些 32 位代码（例如 COM 对象），尝试在 x64 下运行它们将导致“无法加载一种或多种请求的类型”错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T22:03:29.990

我注意到您正在实现的某些类型（特别是`IIdentity`and `IPrincipal`）不在`System.Web.*`程序集中。

您是否尝试将`System.Security.Principal`程序集标记为“复制本地”？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T20:02:24.540

我想知道是否更显着的区别是 2k8 与 2k3 比 64 与 32 位。您是否以管理员身份生成了 Visual Studio？由于 windows 2k8 的虚拟存储，程序集可能会丢失。如果这是一个运行 2k8 的开发桌面，您可能需要考虑禁用虚拟存储，它在您的策略中标记为“用户帐户控制：虚拟化文件和注册表写入失败到每个用户位置”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T19:55:36.537

这让我想起了我曾经读过的一篇旧博客文章。也许您可以使用相同的技术来调试错误的原因：

[http://www.agileprogrammer.com/oneagilecoder/archive/2007/11/17.aspx](http://www.agileprogrammer.com/oneagilecoder/archive/2007/11/17.aspx)

# zend-framework - Zend Framework 应用程序中的“未定义默认模块”错误

> ID：733120
> 
> 赞同：0
> 
> 时间：2009-04-09T07:08:52.180
> 
> 标签：zend-framework, bootstrapping

我正在使我的 bootstrap.php 文件更有条理，但是在将所有内容放入单独的静态方法之后，我无法加载索引控制器之外的任何页面。例如，如果我尝试打开

`http://localhost/zftutorial/login/index`

我明白了

```
 Fatal error: Uncaught exception 'Zend_Controller_Dispatcher_Exception' with message 
'Invalid controller class ("Login_IndexController")' in C:\Program 
Files\VertrigoServ\www\library\Zend\library\Zend\Controller\Dispatcher\Standard.php:341 
Stack trace: #0 C:\Program 
Files\VertrigoServ\www\library\Zend\library\Zend\Controller\Dispatcher\Standard.php(255): 
Zend_Controller_Dispatcher_Standard->loadClass('IndexController') #1 C:\Program 
Files\VertrigoServ\www\library\Zend\library\Zend\Controller\Front.php(934): 
Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), 
Object(Zend_Controller_Response_Http)) #2 C:\Program 
Files\VertrigoServ\www\zftutorial\public\index.php(18): Zend_Controller_Front->dispatch() 
#3 C:\Program Files\VertrigoServ\www\zftutorial\public\index.php(138): Bootstrap::run() #4
 {main} thrown in C:\Program 
Files\VertrigoServ\www\library\Zend\library\Zend\Controller\Dispatcher\Standard.php on 
line 341 
```

在我的引导文件中，我似乎已经定义了应该在哪里找到控制器：

```
public static function setupFrontController()
{
    self::$frontController = Zend_Controller_Front::getInstance();
    self::$frontController->throwExceptions(true);
    self::$frontController->returnResponse(true);
    self::$frontController->setBaseUrl('/zftutorial');

    self::$frontController->setControllerDirectory(
        array(
            'default' => self::$root . '../application/controllers',
            'admin' => self::$root . '../application/controllers',
            'index' => self::$root . '../application/controllers',
            'login' => self::$root . '../application/controllers',
            'user' => self::$root . '../application/controllers'
        )
    );

    self::$frontController->setParam('registry', self::$registry);

} 
```

也许它与路由有关，但我的应用程序以前在隐式路由方面工作得很好，例如其他控制器也工作得很好。上述错误的根源是什么？我该如何测试/查找/修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T12:17:11.720

查看您的堆栈跟踪错误是*无效的控制器类（“Login_IndexController”）*

这表明类 Login_IndexController 不存在。

您应该在登录模块的控制器目录中有一个名为 IndexController.php 的文件。您目前拥有的结构将不起作用，因为两个模块不能有同名的控制器。将结构更改为

```
self::$frontController->setControllerDirectory(
        array(
            'default' => self::$root . '../application/modules/default/controllers',
            'admin' => self::$root . '../application/modules/admin/controllers',
            'index' => self::$root . '../application/modules/index/controllers',
            'login' => self::$root . '../application/modules/login/controllers',
            'user' => self::$root . '../application/modules/user/controllers'
        )
    ); 
```

在 self::$root 中创建 IndexController.php。'../application/modules/login/controllers 并确保该类被称为 Login_IndexController

# excel - 在 Excel 中检索单元格名称

> ID：733123
> 
> 赞同：16
> 
> 时间：2009-04-09T07:10:40.600
> 
> 标签：excel

有没有办法在另一个单元格中显示特定单元格的单元格名称？我想在相邻单元格中显示单元格名称，以便用户无需单击即可识别单元格名称。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-03-31T01:36:34.530

`ADDRESS(ROW(),COLUMN())`会给你地址，例如当前单元格的 $A$1。从行/列值（数字）中添加/减去以引用您之后的单元格。

如果您不想要 $ 那么您可以找到并替换它`SUBSTITUTE(ADDRESS(ROW(),COLUMN()),"$","")`并获得 A1 例如

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-09T18:34:03.097

此函数将给出单元所属的 NamedRange 的名称：

```
Public Function CellName(oCell As Range) As Variant  
Dim oName As Name  
For Each oName In ThisWorkbook.Names  
    If oName.RefersToRange.Parent Is oCell.Parent Then  
        If Not Intersect(oCell, oName.RefersToRange) Is Nothing Then  
           CellName = oName.Name  
           Exit Function  
        End If  
    End If  
Next  
CellName = CVErr(xlErrNA)  
End Function 
```

它遍历工作簿中的所有名称，然后检查每个名称是否引用了工作表输入参数中的任何内容。如果是，则检查输入单元格和名称所指的范围是否相交。如果他们这样做，则返回范围的名称。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-04-01T10:24:26.017

在 Excel 2013 中，也可能在某些旧版本中，**ADDRESS()**接受第三个参数，该参数定义要返回的地址格式，并带有以下值：

1 - 绝对（默认）

2 - 绝对行/相对列

3 - 相对行/绝对列

4 - 相对

所以让我们在单元格 A1 中说

```
ADDRESS(ROW();COLUMN()) //outputs $A$1
ADDRESS(ROW();COLUMN();1) //outputs $A$1
ADDRESS(ROW();COLUMN();2) //outputs A$1
ADDRESS(ROW();COLUMN();3) //outputs $A1
ADDRESS(ROW();COLUMN();4) //outputs A1 
```

如果要在单元格 A1 中显示单元格 D3 的名称，请键入：

```
ADDERSS(ROW(D3);COLUMN(D3);4) //outputs text D3 in cell A1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T08:53:44.423

这似乎不可能，这很奇怪。您会认为该`[cell()](http://spreadsheets.about.com/od/excelfunctions/qt/20071226_cell_f.htm)`函数应该提供一种获取名称的方法，但事实并非如此。真可惜。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-21T13:32:16.160

我从 Adarsha 的上述答案中得到了一些“建议”。我得到了与下面的代码类似的结果，带有该循环和一些改进。然而，我的“excel 提示”宏是让你的调试器成为你最好的朋友。

```
Function name_of(clls)
'
    name_of = ""
' 
    Dim  nam As String
    Dim  rg  As Range
    Set  rg = clls
'
    nam = rg.Name.Name
'
    name_of = nam
'
End Function 'name_of 
```

一点点耐心和毅力，给了我我想要的东西——一个用户定义的函数，给我一个单元格的定义名称。如果同一个 Cell 有多个名称会怎样？试试看。这是一个简单的测试，所以我想把它留给你去试验、学习和传递你的新知识。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-04T20:13:43.500

```
ActiveWorkbook.Sheets.Item(1).Cells(row, col).Name.Name 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-01-18T19:20:32.703

从技术上讲，如果您不介意在工作表中添加隐藏列，您可以结合 SUBSTITUTE() 和新的 FORMULATEXT() 函数来执行此操作。

假设单元格 A1 命名为**FOO** 在 B1 中添加一个简单的引用公式到命名单元格**=FOO** 在 C1 中添加一个公式**=SUBSTITUTE(FORMULATEXT(B2),"=","")** 隐藏 B 列

单元格 C1 将包含值 FOO（或未命名单元格的 RC 参考）

根据需要进行调整，您的里程（或公里）可能会有所不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T09:14:31.533

这将在非常基本的情况下起作用：

```
Public Function CellName(cel As Range) As Variant
Dim nm As Name
    For Each nm In Names
        If nm.RefersTo = "=" & cel.Parent.Name & "!" & cel.Address Then
            CellName = nm.Name
            Exit Function
        End If
    Next
    CellName = CVErr(xlErrNA)
End Function 
```

如果单元格是命名范围的一部分，它将不起作用，它不会显示单元格的多个名称，它不适用于命名公式中包含的单元格（例如`=OFFSET()`范围）。

这

```
"=" & cel.Parent.Name & "!" & cel.Address 
```

东西也很笨重。可能有更好的方法来进行检查。从 RefersTo 创建 Range 对象并使用 Intersect() 可能会起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T09:22:32.933

Excel 确实有一个函数“Cell()”，您可以从中获取某些属性。

您可以使用 =Cell("row", K9) 并返回第 9 行，并且有一个等效的“col”参数，但它返回列号 (11) 而不是字母。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-03-22T23:10:44.637

You can place your cursor in an empty cell, type = then click on the named cell. It will display the cell contents. Then you change the format of the cell to text and it will show =

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-02-05T16:30:08.657

在另一个单元格中引用命名单元格，在本例中为 E12，然后使用此公式：="'"&FORMULATEXT(E12)。这会在前面放置一个撇号，以便将名称或公式显示为文本。

# bash - “tar -cvf /dev/nst0 /home/user1 >> file1.log”有什么作用？

> ID：733124
> 
> 赞同：1
> 
> 时间：2009-04-09T07:11:49.987
> 
> 标签：bash, tar

我需要帮助来理解以下命令。

```
tar -cvf /dev/nst0 /home/user1 >> file1.log 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:14:00.967

阅读手册页：

```
-c stands for create
-v is for verbose
-f specify the archive name 
```

And`tar -cvf`等价于`tar -c -v -f`，所以这样做是创建 `/home/user1`into的存档`/dev/nst0`。将`>> file1.log`标准输出重定向并附加到 file1.log。 `tar -cvf archive_name [files] > file.log`将删除 file1.log 中的任何现有内容

[在这里](http://tldp.org/LDP/abs/html/io-redirection.html#IOREDIRREF)查看有关 I/O 重定向的说明

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T07:21:10.510

除了 shodanex 的回答：这会创建一个 tar 存档，从 /home/user1 写入 /dev/nst0（磁带驱动器？）并将输出（记住详细 -v）附加到 file1.log

# c++ - 在不重复代码的情况下使用多个参数

> ID：733125
> 
> 赞同：1
> 
> 时间：2009-04-09T07:12:16.197
> 
> 标签：c++, loops, arguments

有没有办法在不重复代码的情况下按顺序使用这个函数中的每个参数？例如，第一次通过循环我想使用 R，下一次我想使用 L 等等。 valuestruct 的设置顺序与参数相同，因此 button 方法将返回等价bool 我需要根据 int i 的 currentbutton。如果有更好的方法来完成同样的事情，那也没关系。

```
int valuex=0;

void SetValue(bool &R,bool &L,bool &D,bool &U,bool &T,bool &S,bool &B,bool &A,bool &Y,bool &X,bool &W,bool &E,bool &G, bool &F) {

        bool value[4] = {true, false, true, false};
        bool currentbutton;

        for (int i=0; i < 12; i++) {
            currentbutton=valuestruct.button(i);

            if(currentbutton) {
                "I want to grab each argument in sequence here"=value[valuex];
                valuex++;
                if(valuex>ARRAYSIZE(value))
                    valuex=0;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T07:33:19.077

如果您确实坚持使用此函数原型（并且不遵循此处传递数组或列表的其他建议-更好），则可以使用类似的东西-

```
void SetValue(bool &R,bool &L,bool &D,bool &U,bool &T,bool &S,bool &B,bool &A,bool &Y,bool &X,bool &W,bool &E,bool &G, bool &F)
{
   bool* Bools[] = { &R, &L, &D, &U, &T, &S, &B, &A, &Y, &X, &W, &E, &G, &F };

   // *Bools[i] can be used to access the ith element.

   // Print the 4th element.
   std::cout << *Bools[3];

   // Change the value of the 5th.
   *Bools[4] = true;
} 
```

顺便说一句，如果您真的不需要更改传递的值，则不应通过引用传递它们。通过引用传递布尔值只会浪费时间和空间。它还会使这里的代码不那么混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T07:14:40.370

您是否考虑过使用布尔数组？:) 收藏绝对是要走的路。如果您需要保留元数据以过滤或获取某些值，请考虑使用 Map。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T07:33:05.570

还是[位域](http://en.wikipedia.org/wiki/Bit_field)？快速和肮脏的版本：

```
int field = FLAG_R | FLAG_L

void SetValue(int fields) {
    for (int i = 0; i < FLAG_COUNT; i++) {
        if (fields & (1 << i)) {
            // Flag #i is set
        }
    }
} 
```

**编辑**

顺便说一句，如果您不更改值，则将布尔值作为参考传递是无用的。用于引用的指针可能比保存 bool 本身的类型长。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T07:33:00.233

您可以使用可变参数支持，因为您有固定数量的参数，您知道要循环多少。IIRC 它实际上并不要求函数具有可变参数。

```
va_list args;                                                                                                     
va_start(args,R);
// your code here...
va_end(); 
```

如果这是离题，请原谅我......自从我主动编写 C 代码以来已经有好几年了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T09:02:59.970

我会将其添加到 hexagon 的答案中，但我还不能编辑帖子。

```
int valuex=0;

void SetValue(bool &R,bool &L,bool &D,bool &U,bool &T,bool &S,bool &B,bool &A
             ,bool &Y,bool &X,bool &W,bool &E,bool &G, bool &F) 
{
    bool* bools[] = { &R, &L, &D, &U, &T, &S, &B, &A, &Y, &X, &W, &E, &G, &F };
    bool value[4] = {true, false, true, false};
    bool currentbutton;

    for (int i=0; i<12 && i < ARRAYSIZE(bools); i++) {
            currentbutton=valuestruct.button(i);

            if(currentbutton) {
                    *bools[i]=value[valuex];
                    valuex++;
                    if(valuex>ARRAYSIZE(value))
                            valuex=0;
            }
    }
} 
```

虽然我不明白在哪里认为您只会读取布尔值的值，但您可能不会设置所有这些值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T07:14:54.833

您可以将参数放入数组并传递数组。根据调用代码是什么，这可能会导致更少的代码。

# asp.net-mvc - 我如何对这种方法进行单元测试？

> ID：733127
> 
> 赞同：3
> 
> 时间：2009-04-09T07:12:46.553
> 
> 标签：asp.net-mvc, unit-testing, moq

我需要对这个方法进行单元测试。如果有帮助，我正在使用 moq 作为我的模拟框架。

```
[AcceptVerbs(HttpVerbs.Get)]
public RedirectToRouteResult LogOff()
{
    FormsAuthentication.SignOut();
    return RedirectToAction("Index", "Post");
} 
```

干杯:)

编辑：主要是我想知道的 FormsAuthentication。我什至应该测试它吗？我想我需要模拟一个身份，然后检查 IsAuthenticated 是否为假？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T13:15:03.080

您可以为 FormsAuthentication 创建一个包装器并将其存根

```
formsAuthentication = mockery.Stub<IFormsAuthentication>(); 
```

并做这样的事情。

```
With.Mocks(mockery)
    .Expecting(() => Expect.Call(() => formsAuthentication.SignOut()))
    .Verify(() => controller.LogOff());

 /* Asserts to go here */ 
```

在测试 FormsAuthentication 方面。在其他地方测试这个，关注点分离等等。

此操作的测试只需要检查 SignOut 方法是否已被调用以及是否发生了重定向。请记住，您正在测试操作，而不是操作中的方法。您不会在提交操作中测试数据存储工作，您会模拟所有这些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T14:38:09.377

这就是您使用 Moq 执行此操作的方式。假设您已创建 a`IFormsAuthentication`作为包装器：

```
[Test]
public void LogOffSignsUserOut()
{
   var controller = new MyController();
   var authMock = new Mock<IFormsAuthentication>();
   controller.Authentication = authMock.Object;   //inject your mock

   controller.LogOff()

   authMock.Verify(x=>x.SignOff(), Times.Once());
} 
```

# c# - 泛型子列表

> ID：733130
> 
> 赞同：0
> 
> 时间：2009-04-09T07:14:15.363
> 
> 标签：c#, generics, c#-2.0

检查代码。

```
class DynamicObj : BaseObj {}
class BaseObj {}

class clientCode 
{
   List<DynamicObj> GetFilteredObjs(List<BaseObj> baseList) 
   {
        // I want to return the sublist of baseList which only have DynamicObj.
        List<DynamicObj> dList = baseList.FindAll(
                                          delegate(BaseObj bo){        // Del1
                                          return bo is DynamicObj;
                                          }).ConvertAll<DynamicObj>(
                                             delegate(BaseObj bo){     // Del2 
                                             return bo as DynamicObj;
                                             });   

   }
} 
```

现在这可能是一个愚蠢的问题，但是我的代码必须循环对象 2 次，一次用于 Del1 循环，一次用于 Del2 循环。

有没有直接的方法？仅限 C# 2.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T07:20:54.520

最简单的方法可能是使用迭代器块：

```
public IEnumerable<TTarget> FilteredCast<TSource,TTarget>
    (IEnumerable<TSource> source)
    where TSource : class
    where TTarget : class, TSource
{
    foreach (TSource element in source)
    {
        TTarget converted = element as TTarget;
        if (converted != null)
        {
            yield return converted;
        }
    }
} 
```

（顺便说一句，这基本上是`Enumerable.OfType`LINQ to Objects 中的方法。为方便起见，我将其限制为引用类型，但它仍然是通用的，因此您可以更轻松地重用它。）

然后只写：

```
List<DynamicObj> GetFilteredObjs(List<BaseObj> baseList) 
{
    return new List<DynamicObj>(FilteredCast<BaseObj,DynamicObj>(baseList);
} 
```

请注意，这不会返回空值。如果您希望包含空值，则需要明确地满足这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:21:21.383

当然：

```
IEnumerable<DynamicObj> GetDynamicObjects(IEnumerable<BaseObj> baseList)
{
    foreach(BaseObj baseObj in baseList)
        if(baseObj is DynamicObj)
            yield return (DynamicObj)baseObj;
}

List<DynamicObj> dynamicList = new List<DynamicObj>(GetDynamicObjects(...)); 
```

# flash - VisorFreeMind Flash 浏览器（FLA 文件）

> ID：733132
> 
> 赞同：1
> 
> 时间：2009-04-09T07:14:37.983
> 
> 标签：flash

在[http://sourceforge.net/projects/freemind](http://sourceforge.net/projects/freemind)您可以下载 VisorFreeMind flash 浏览器的源文件，但这些只是 *.as 文件，没有像图像这样的其他文件。

有人为 freemind 浏览器编译了 *.fla 文件吗？或者知道如何从那些 *.as 文件中获取 *.fla（使用 mtasc ？？）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T13:57:46.080

您可能必须为它创建自己的 fla，并将 FreeMind 浏览器的主类添加为文档类。

您总是可以获取[flex sdk](http://opensource.adobe.com/wiki/display/flexsdk/Download+Flex+3)并使用它将 .as 编译成 .swf。如果您不想直接使用 sdk，它可以很好地与[FlashDevelop](http://www.flashdevelop.org/community/)相关联。

# flash - Flash + MySQL 通讯

> ID：733135
> 
> 赞同：1
> 
> 时间：2009-04-09T07:15:10.167
> 
> 标签：flash, actionscript-3, maps

我有一个闪存地图应用程序，我想在新的闪存平台 (AS3) 上重新构建它。

它将在应用程序开始时拉入大量记录，然后无需再次通信即可运行。

考虑到这种情况，您会推荐什么是将这组记录放入闪存的最佳（也是最灵活）的方法？

这是我正在处理的地图之一： [http ://www.norcrossga.net/map/Interface.html](http://www.norcrossga.net/map/Interface.html)

它内置在 Flash 7 中，不与我的 MySQL 后端通信，我每月手动更新一次数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T09:32:52.113

您似乎没有大量数据，因此 XML 非常适合。再加上 as3 中新的 super sweet [e4x](http://en.wikipedia.org/wiki/ECMAScript_for_XML)支持，解析起来会轻而易举。您将需要使用您首选的服务器端编程语言来生成它，但实际上并没有解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T13:50:58.077

如果您真的想让 Flash 与 MySQL 通信，则必须使用[AMF](http://en.wikipedia.org/wiki/Action_Message_Format)。wiki 页面简要描述了它是什么，并链接到了几种不同语言的不同 AMF 包。

但是，如果您没有大量数据，那么像grapefrukt 所说的那样使用XML 可能会更好。

# c# - 在 C# 和 MsSql 中有效的一对多插入

> ID：733136
> 
> 赞同：0
> 
> 时间：2009-04-09T07:15:29.590
> 
> 标签：c#, asp.net, sql

我有两个看起来像这样的表：

```
News: (ID, Title, TagID)
Tags: (ID, Tag) 
```

每条新闻只能有一个标签。处理对新闻表的插入最有效的方法是什么？标签表有大约 50 000 行。

我只做大约的批量插入。一次 300 条新闻，大约每小时 2 次。我假设我需要一些用于标签的内存缓存？

如果标签不在标签表中，我需要插入它并将 TagID 设置为新插入的 id。

希望你能明白这一点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:38:50.703

您在后台使用的是什么版本的 SQL Server？

如果您使用的是 SQL Server 2008，我建议将每天的标签和新闻批量加载到临时工作表中，然后使用 MERGE 语句从这些工作表中更新实际的标签和新闻表。为此，我将使用 C#“SqlBulkCopy”类。

MERGE 允许您轻松地仅插入那些已更改的项目，并可能更新那些已经存在的项目，所有这些都在一个方便的 SQL 语句中。

如果您使用的是 SQL Server 2005 或更低版本，您可以执行基本相同的操作，但您必须编写一些代码（C# 或 T-SQL）来手动检查需要从临时批量加载表中插入什么，以及什么已经存在。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T07:48:35.470

我假设每个新闻项目都会得到一个字符串列表，这些字符串是所谓的“标签”。从您给出的结构来看，每个新闻项只能有一个标签？这似乎不寻常，但以下内容仍然适用。

如果您的 Tags 表上有索引，则搜索速度会非常快，并且无论如何数据库都会处理缓存，因此不必担心缓存。当您在正确的位置拥有索引时，您会惊讶于数据库可以加快速度

从标签中选择其中标签 = 不管1（对每个标签执行此操作），每次如果没有返回行插入它，否则使用您找到的 id 来执行此操作。在每个 INSERT 上运行 proc。

# c# - Rhino.Commons，它不会编译

> ID：733144
> 
> 赞同：0
> 
> 时间：2009-04-09T07:17:34.343
> 
> 标签：c#, rhino-commons

当我尝试将 Rhino.Commons 与我的 asp.net mvc 应用程序一起使用时，我收到了这个非常奇怪的错误消息。

```
Error   3   'Rhino.Commons.Repository<Web.Models.Poll>.FindAll()' is not supported by the language  C:\frank\dev\SampleApplication\Web\Models\Repositories\IPollRepository.cs   15  20  Web 
```

有人对此错误有任何经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T07:42:28.387

试试[这个](http://ddkonline.blogspot.com/2008/02/fixing-design-time-exception-methodname.html)，看起来很有希望。即尝试为您的所有项目更新您引用的 dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T09:29:02.060

对于几种方法和构造函数，我遇到了相同的消息“语言不支持”。

我的解决方案是清理解决方案并重建所有内容。

# wcf - 提高 WCF 性能

> ID：733147
> 
> 赞同：4
> 
> 时间：2009-04-09T07:18:02.470
> 
> 标签：wcf, web-services, soap

我能知道提高 .Net WCF 服务性能的方法吗？现在它很慢，有时它会被堵塞并最终停止响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T07:22:24.517

那么，你发送什么样的数据，以及通过什么绑定？

问题是请求的*大小*（带宽）还是请求的*数量*（延迟）。如果延迟，则只需发出更少但更大的请求；-p

对于带宽：如果您通过 http 发送二进制数据，您可以启用 MTOM - 这将为您节省几个字节。您可以在服务器上启用压缩支持，但这不能保证。

如果您使用 .NET 到 .NET，您可能需要考虑[protobuf-net](http://code.google.com/p/protobuf-net/)；这有 WCF 挂钩，用于交换格式化程序 ( `DataContractSerializer`) 以使用谷歌的“协议缓冲区”二进制格式，这种格式非常小而且速度快。我可以*根据*要求提供建议。

除此之外：发送更少的数据；-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:40:41.150

您在服务类上使用了哪种 InstanceContextMode 和 ConcurrencyMode？

如果是 PerCall 实例，您可能需要检查是否可以减少为每个调用创建服务器实例的开销。

如果是单实例（单例）——你真的需要吗？:-) 尝试改用 PerCall。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T07:21:28.887

你用的是什么绑定？如果您使用的是 HTTP，则可以使用 TCP 获得更好的性能。

尽管瓶颈很可能在 WCF 管道中更高，并且可能在您的托管对象中。

我们需要有关您的 WCF 设置的更多详细信息，以便能够提供很大帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T10:55:13.243

您描述的症状可能是由任何原因引起的。您需要使用诸如 JetBrain 的 dotTrace 或 Automated QA 的 AQTime 之类的分析器来缩小范围。

或者你可以通过检测你的代码（这是分析器为你做的）来做这件事。在您的操作开始之前收集开始时间。完成后，从当前时间中减去开始时间以确定经过的时间，然后将其打印出来或记录下来或其他任何方式。围绕此操作调用的方法执行相同的操作。您将很快看到哪些方法花费的时间最长。然后，进入这些方法并做同样的事情，找出是什么让*它们*花这么长时间，等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-20T13:57:53.383

“提高我的 .Net WCF 服务的性能” - 这是您所问的非常通用的术语，我们可以通过不同的方式提高性能，同时您需要找到哪一个导致性能下降，例如 WCF 方法中的数据库访问。

请尝试了解 WCF 中的可用功能，例如 oneWay WCF 方法，它将帮助您找到提高性能的方法。

谢谢文卡特

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-07T10:13:47.743

这是一篇包含来自真实生产系统的一些统计数据的文章，您可以使用这些数据来比较/基准测试您的性能。

[WCF 服务性能](http://hubpages.com/_1k9ore6as3b3m/hub/WCF-Service-Performance)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-28T07:20:22.360

微软最近发布了一篇知识库文章：

*   [WCF 性能和稳定性问题 -](http://support.microsoft.com/kb/982897) [http://support.microsoft.com/kb/982897](http://support.microsoft.com/kb/982897)

> 这些问题包括：
> 应用程序崩溃 调用 WCF 服务时应用程序的一般性能
> 挂起。

# performance - Firebug中关于网络面板的两个问题

> ID：733153
> 
> 赞同：5
> 
> 时间：2009-04-09T07:20:41.293
> 
> 标签：performance, firebug, analysis

有人能告诉我关于萤火虫网络面板的两件事吗？

1.  为什么第一行和后面的行之间有“距离”？那里发生了什么？
2.  右侧的蓝线和红线的确切含义是什么？

任何帮助都非常感谢 - 提前非常感谢......

[替代文字 http://www.walkner.biz/_temp/firebug.png](http://www.walkner.biz/_temp/firebug.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T07:41:41.210

蓝线和红线标记了 javascript 事件（DOMContentLoaded 和 load）何时被触发。

[DOMContentLoaded 和 load](https://developer.mozilla.org/en/Gecko-Specific_DOM_Events)的 mozdev 文档：

> 当文档的 DOM 内容完成加载时在 Window 对象上触发，但与“加载”不同，它不会等到所有图像都加载完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T07:41:53.380

> 但我的问题是为什么第二个项目直到那时才加载......它不应该立即开始吗？– 斯沃克纳

在我的机器上，它几乎是连续的。我会将延迟贡献给处理和呈现数据所需的 CPU 时间。

我猜蓝线是浏览器开始显示时，红线是布局完成时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T07:28:48.467

从最左边到最右边是总加载体验的时间（1.03s）。

第二项“？” 直到整个加载过程大约 75% 才开始加载。

# asp.net - 保存图像的最佳实践

> ID：733161
> 
> 赞同：0
> 
> 时间：2009-04-09T07:21:50.993
> 
> 标签：asp.net, vb.net, file, file-upload, image

我允许我网站管理面板的用户上传照片，这是一个简单的过程，我检查图像的有效性，然后将其保存到文件夹中，然后我还必须为该图像记录几个数据库记录以以后能找回来，我的保存功能如下... 上传图片并保存在文件夹中的功能，我在另一个函数中构造了一个名称：

```
My_HTMLInputFile.PostedFile.SaveAs(HttpContext.Current.Server.MapPath("~/photos\" & pta.FileName)) 
```

以及为同一张图片创建数据库记录的函数：

```
Public Function InsertPhoto() As Integer
        Dim pta As New GKPTableAdapters.tblPhotosTableAdapter
        Return pta.InsertPhoto(PhotoCaption, PhotoDescription, ("http://www.myURL.com/photos/" & FileName), IsDefault, IsPicture)
    End Function 
```

现在我知道我正在做的事情充满了违反最佳实践的行为，所以请指出我应该做什么，记住用户可能会在以后删除图片，所以我想确保我可以删除数据库和图片的文件，整个路径问题让我感到困惑：P

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:26:28.847

我马上注意到的是，您正在将完整路径硬编码到图像中。

我只存储图像名称，然后在应用程序中显示它时添加相对路径

如果您允许您的用户通过您的应用程序删除文件，您应该删除数据库中的记录，然后使用[File.Delete 方法删除文件本身](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T07:30:42.110

您可能还想查看您的文件名生成。例如，如果您使用图像数据的 md5 哈希作为文件名，则可以防止人们上传重复的图像，并且您也不必想办法为图像生成“唯一”名称。

如果其中有公众不应该看到的图像并且您的命名策略是可预测的，那么将您的照片目录直接暴露在互联网上可能不是一个好主意。人们将开始猜测图像 URL 并偶然发现他们不允许看到的东西。

# visual-c++ - 将项目转换为 Visual Studio 2008

> ID：733169
> 
> 赞同：0
> 
> 时间：2009-04-09T07:25:08.507
> 
> 标签：visual-c++

如何将我的应用程序从 Visual Studio 6.0 转换为 Visual Studio 2008？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T07:27:16.753

我认为转换是内置的。有一个[转换向导](http://msdn.microsoft.com/en-us/library/60z6y467.aspx)可以帮助您，因此只需尝试在您拥有的最新工作室版本中打开您的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:31:55.290

请记住，转换为 VS2008 项目是一个破坏性的过程——VS 不会自动备份您的 VC6 项目。您将得到更好的服务来创建副本并对其进行处理，这样即使出现问题，您也有办法恢复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T07:29:03.677

可能内置在VS中。最近我将一个项目从 VS6 转换为 VS2005。所以到2008年不会有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T07:31:21.283

几天前，我刚刚在 VS2008 中打开了一个客户端的 VS 6.0 C++ 应用程序。转换是完全自动化的（通过向导）。完全无痛（尽管这是一个简单的测试应用程序）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T07:33:00.187

从 VS6 转换到 VS2008？我认为您可能正在转换一个 VB 应用程序，或者是吗？

转换向导（文件->打开）会自动将旧项目类型转换为新项目类型。使用时记得做好备份。

# c# - Linq to SQL ORM 3层问题

> ID：733179
> 
> 赞同：1
> 
> 时间：2009-04-09T07:27:40.997
> 
> 标签：c#, linq-to-sql, orm

我正在为一个中型组织设计这个 HR 系统（基于桌面）。问题是我设计了所有的表，并计划使用 VS2008 中的 O/RM 来生成实体类（这是我第一次使用 OR/M；事实上，这是我的第一个“大”项目。 ）我想用 3 层制作应用程序（公司的一位程序员建议不是 3 层而是 4 或 5 层）但是在阅读了很多博客文章和这里的很多问题之后，我意识到这并不完全使用 LINQ to SQL 很容易做到这一点，因为数据上下文的工作方式以及使用 LINQ to SQL 在层之间传递对象的难度。

可能我只会使用 VS2008 ORM 生成的实体类，并在部分类中添加任何验证和业务逻辑。**但这将是 2 层，或者不是？**该应用程序将被大约 10 个用户使用，所以我认为 2 层方法目前不是一个大问题。

**将来，将开发一个基于网络的前端，以便候选人可以在线申请工作。我想尽可能地开发它。但事实是我没有太多时间可以浪费在做决定上，时间不多了，呵呵。**

**说了这么多，我应该只使用VS2008 ORM生成的实体吗？**

因此，任何建议或想法将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:40:49.263

你在这里的提问中反复咀嚼了很多。（那里是否隐藏了一个具体的问题？）

对于层，我假设您指的是物理边界，即应用程序、应用程序/SOA/WCF 服务器、位于 SOA 服务器上的数据层以及某处的数据库。

为未来设计似乎是个好主意，但请确保在某个地方需要所有这些层。从本质上讲，如果您在某些时候不通过 Internet 公开您的应用程序，则您不需要基于 WCF/SOA 的方法。在许多情况下，Web 前端可以解决相同的问题。

我并不是说你根本不需要这些层，但你可能不需要。如果你真的这样做，接缝是你的朋友。您需要在可以定义边界的地方创建“切点”。我通常使用存储库模式来多样化数据访问方法，并使用通过 NHibernate 等技术持久化的普通对象 (POCO) 和接口。使用 POCO 还可以更轻松地在以后通过网络传输这些对象，无论是独立的还是消息的一部分。

创建被调用的服务接口可以巩固你的界限。当您准备好移动跨机器/物理边界时，您只需在服务实现中创建边界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:42:52.090

这听起来确实是一种危险的方式——首先创建表，然后是域，最后是 GUI。我必须承认我不是 ORM 专家，但我见过的生成的类看起来更像是数据对象而不是类。我会说你需要另一层来阻止所有逻辑最终出现在 GUI 中）。

# winforms - 比较从 System.Windows.Forms.ListBox 中删除所选项目的不同方法

> ID：733180
> 
> 赞同：0
> 
> 时间：2009-04-09T07:28:10.853
> 
> 标签：winforms, listbox

到目前为止，我已经找到了两种从列表框中删除所选项目的方法（winform）：

1.

```
ListBox.SelectedObjectCollection tempCollection = new ListBox.SelectedObjectCollection(myListBox);
for (int i = tempCollection.Count - 1; i >= 0; i--)
{
    myListBox.Items.Remove(tempCollection[i]);
} 
```

2.

```
while (myListBox.SelectedItems.Count > 0)
{
    myListBox.Items.Remove(myListBox.SelectedItem);
    // or
    //myListBox.Items.Remove(myListBox.SelectedItems[0]);
} 
```

第二种方式很容易理解，但第一种方式对我来说很奇怪。他们都为我工作，我只是想知道区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T08:03:09.007

第一种写法真的很奇怪。它看起来很奇怪，因为它倒退了。这样它就不会破坏所选项目的集合。选定的项目集合没有完全创建，它是一个可枚举的集合，只有当你要求它们时，项目才会从它中取出。您不能使用 foreach，因为当您删除项目时，所选项目的集合会不断变化。

我其实更喜欢第二种方式。此外，更容易阅读的东西更容易维护。第一个内容为：获取所选项目，向后浏览它们，从列表中删除每个项目。

第二个内容为：当有选定的项目时，删除第一个可用的选定项目。

第二种方法好多了。

# asp.net - .htaccess 用于重写 url

> ID：733182
> 
> 赞同：0
> 
> 时间：2009-04-09T07:28:20.823
> 
> 标签：asp.net, .htaccess

嗨，让我简要解释一下。

我有一个带有查询字符串的网址 - “ [http://Domain.com/FolderName/Default.aspx?EditID=6 ”。](http://Domain.com/FolderName/Default.aspx?EditID=6)

我需要显示如下所示的网址

```
"http://Domain.com/FolderName/Name" 
```

...这意味着我想`"Default.aspx?EditID=6"`从 url 中删除部分并想用某个名称替换它...

你能帮助我吗。

多谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-08T14:14:16.223

这是我目前用来重定向以及允许某些域通过某些文件进行热链接的方法：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L]
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?google.com/.*$ [NC]
RewriteRule \.(gif|jpg|png|zip|js|css)$ - [F] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T07:33:25.397

这应该有效（但我还没有实际测试过）：

```
# Turn on the rewriting engine
RewriteEngine On
# Change requests that match "FolderName/Name/" to "FolderName/Default.aspx?EditID=6"
RewriteRule ^FolderName/Name/?$ FolderName/Default.aspx?EditID=6 [NC] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T07:43:39.460

假设您启用了 mod_rewrite：

```
RewriteEngine On

#prevent an infinite rewrite loop
RewriteRule ^Community/Default\.aspx - [L]

#rewrite the names
RewriteRule ^Community/([^/]+) /Community/Default.aspx?N=$1 [L,NC,QSA] 
```

在您的 /Community/Default.aspx 中，您需要将 EditName 解析为 EditID - 例如，在您定义的某个表中查找它。

编辑：不幸的是，重写模块不知道哪个名称映射到哪个 ID（除非您为每个 ID 制定单独的规则，这根本无法扩展）。因此，重写模块将名称传递`N`给您的 Default.aspx，脚本负责找出所指的 ID。

# asp.net - 更改日期格式

> ID：733187
> 
> 赞同：0
> 
> 时间：2009-04-09T07:29:18.807
> 
> 标签：asp.net, vb.net

我有 dd/mm/yyyy 格式的日期。我必须在 vb 后面的代码中更改为 mm/dd/yyyy。任何人都可以帮助更改格式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T07:33:01.653

使用 DateTime.ParseExact 解析 dd/mm/yyyy 格式，然后使用 DateTime.ToString 将解析后的 DateTime 转换为 mm/dd/yyyy 格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:35:19.353

```
Dim inDate as Date = Date.ParseExact(strDate, "dd/MM/yyyy", New System.Globalization.DateTimeFormatInfo())

Dim strOutDate as String = inDate.ToString("MM/dd/yyyy")
Console.WriteLine(outDate) 
```

# asp.net-mvc - 如何合并 DropdownList 的 DatatextFiled 的列？

> ID：733195
> 
> 赞同：1
> 
> 时间：2009-04-09T07:32:33.510
> 
> 标签：asp.net-mvc

我有教师姓名的下拉列表。在我的数据库中，它们存储为 FirstName、LastName、MiddleName、

我想将它合并到下拉列表中

```
ViewData["FacultyID"] = new SelectList(faculty, "ID", "FirstName"); 
```

在datatextfield的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:53:40.103

```
ViewData["FacultyID"] = 
   new SelectList(faculty.Select(f=> new 
   {id= f.Id, Name = f.Firstname + f.LastName}), "ID", "Name"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T07:47:11.150

您可以更改您的 sql 查询：

```
SELECT ..., COALESCE(FirstName + ' ' + MiddleName + ' ' + LastName) as FullName,... 
```

# windows - 在WinXP中查找哪个驱动器对应哪个USB大容量存储设备

> ID：733206
> 
> 赞同：9
> 
> 时间：2009-04-09T07:35:35.767
> 
> 标签：windows, usb, device, usb-mass-storage

我有几个 USB 驱动器连接到 WinXP SP3 计算机，我需要以编程方式区分它们 -**我需要找到哪个驱动器号对应于哪个设备**（在这种情况下，一个设备〜一个卷）。我可以使用 获取他们的卷 ID 和驱动器`mountvol`号，如下所示：

```
C:\WINDOWS\> mountvol
\\?\Volume{bdb681b2-1ddf-11dd-bf71-806d6172696f}\
    C:\

\\?\Volume{6a8784f8-7406-11dd-a8c3-001e8c829b67}\
    A:\ 
```

此外，使用[devcon](http://support.microsoft.com/kb/311272)或设备管理器，我可以看到设备 ID：

```
C:\WINDOWS\> devcon resources *STOR*
STORAGE\REMOVABLEMEDIA\7&190C24E5&0&RM
    Name: Generic volume
STORAGE\VOLUME\1&30A96598&0&SIGNATURED84ED84EOFFSET7E00LENGTH2543150400
    Name: Generic volume
USBSTOR\DISK&VEN_KINGSTON&PROD_DATATRAVELER2.0&REV_1.00\0803240752536&0
    Name: Kingston DataTraveler2.0 USB Device 
```

但是，我还没有找到一种方法来链接设备 ID 和卷 ID/字母，就像“安全删除硬件”对话框一样（因此我认为这是可能的）：

[![通用卷 - A：](https://i.stack.imgur.com/6h4sd.png)](https://i.stack.imgur.com/6h4sd.png)
[（来源：[piskvor.org](http://stuff.piskvor.org/safely_remove.png)）]

如您所见，这些设备与我在 devcon 中看到的设备相同，并且与 mountvol 看到的卷相同；但到目前为止，我还没有找到它们之间的联系。

我发现了一些[相关的](https://stackoverflow.com/questions/85649/safe-remove-usb-drive-using-win32-api) [问题](https://stackoverflow.com/questions/206248/how-do-you-programmatically-eject-an-usb-mass-storage-device)，但这些问题似乎使用“你首先找到的是你的 USB 设备”的方法，这在我的情况下不是很有用，因为会有几个类似的设备（相同的供应商，通常是相同的产品类型） 连接的。

* * *

编辑：

[@MSalters](https://stackoverflow.com/questions/733206/find-which-drive-corresponds-to-which-usb-mass-storage-device-in-winxp/733284#733284)的回答看起来很有希望：在 XP 上，`HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices`有`REG_BINARY`值`\DosDevices\x:`（`x`[AZ] 在哪里）；注释是正确设备的 (UTF-16) 名称（例如
`\DosDevices\A:`= " `\??\STORAGE#RemovableMedia#7&190c24e5&0&RM#{53f5630d-b6bf-11d0-94f2-00a0c91efb8b}\"`，对应于
`STORAGE\REMOVABLEMEDIA\7&190C24E5&0&RM`上面在设备列表中看到的）。

会看看这是否是要走的路。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T08:05:30.717

这是一个不平凡的问题。据我所知，它没有官方的 API。因此，您需要一个未记录的 API：注册表。`HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices`包含驱动器号和卷 ID 的条目。如果您查看实际数据，您会发现它可以识别驱动器。将二进制数据视为 Unicode 字符串。它将指向您`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\ENUM\`。但是，XP 和 Vista 的不同之处在于其中引用了哪些子项以及如何引用。（Vista 更容易，所以先试试吧）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-21T13:05:32.157

有一个官方 API 可以做到这一点。请参阅此示例： http: [//www.codeproject.com/KB/system/RemoveDriveByLetter.aspx](http://www.codeproject.com/KB/system/RemoveDriveByLetter.aspx)

其原理是为 Windows 上的每个存储卷分配一个全局编号。首先，您向驱动器询问其编号（通过打开“\X:”并发送`IOCTL_STORAGE_GET_DEVICE_NUMBER`请求）。其次，您检查所有磁盘设备并询问每个设备的编号（通过不同的路径打开它，因此您不能只进行字符串比较）。

一旦你找到一个与你查询驱动器的编号相同的磁盘设备，你就知道你赢了。

# c# - 如何从 SiteMap.CurrentNode 向后循环到 SiteMap.RootNode

> ID：733210
> 
> 赞同：0
> 
> 时间：2009-04-09T07:38:20.860
> 
> 标签：c#, asp.net, xml, loops, sitemap

我有一个来自 asp:SiteMapDataSource 的简单站点地图：

第 1 页 > 第 2 页 > 第 3 页

我想在 C# 中创建 foreach 循环来生成它而不是使用 asp:SiteMapPath 因为我需要向它添加一些异常。现在我无法弄清楚如何从 SiteMap.CurrentNode 向后循环到 SiteMap.RootNode？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T07:51:58.690

您正在寻找的属性是[SiteMapNode.ParentNode](http://msdn.microsoft.com/en-us/library/system.web.sitemapnode.parentnode.aspx)

```
SiteMapNode currentNode = SiteMap.CurrentNode;
SiteMapNode rootNode = SiteMap.RootNode;
Stack<SiteMapNode> nodeStack = new Stack<SiteMapNode>();

while (currentNode != rootNode)
{
    nodeStack.Push(currentNode);

    currentNode = currentNode.ParentNode;
}

// If you want to include RootNode in your list
nodeStack.Push(rootNode);

SiteMapNode[] breadCrumbs = nodeStack.ToArray(); 
```

# visual-studio - 获取默认浏览器

> ID：733211
> 
> 赞同：8
> 
> 时间：2009-04-09T07:38:30.080
> 
> 标签：visual-studio, winapi, visual-c++, browser, mfc

如何以编程方式确定系统中的默认浏览器。代码必须使用 vc++ 开发 有没有这方面的 API？

默认浏览器值存储在注册表的哪个位置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T11:55:46.650

您通常不需要知道这一点。`ShellExecute(0,0,"http://stackoverflow.com",0,0,SW_SHOWNORMAL);`会成功的。Windows 将发现 http:// 并从那里确定您要打开一个 URL。“默认”网络浏览器几乎被定义为 Windows 用于此任务的网络浏览器。

支持的不仅仅是 http://。ShellExecute 也可以使用 https:// URL 启动默认网络浏览器。对于 mailto: URL，它会启动默认邮件客户端。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-09T07:50:32.860

您可以在注册表中找到默认浏览器

即对于 Windows XP 和 Vista 位于

```
HKEY_LOCAL_MACHINE\Software\Clients\StartMenuInternet\ 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-08T22:12:26.637

TL；DR：如果`HKEY_CURRENT_USER\Software\Clients\StartMenuInternet\`存在，请阅读；否则请阅读`HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\`。

在阅读了这里的答案后，我对如何检测默认浏览器几乎没有共识，所以我做了一些实验和研究来弄清楚。我下载了 Firefox 源代码，编写了一个脚本来读取一堆注册表项，并在一遍又一遍地更改默认浏览器的同时运行 Process Explorer。

我发现当 Firefox 和 Chrome 将自己设置为默认浏览器时，会更改很多注册表项。我相信 Safari 和 Opera 在行为上都很相似。IE 似乎只更改了我正在查看的注册表项之一。

我发现虽然大多数浏览器会更改其他注册表路径，但所有浏览器都会更改`HKEY_CURRENT_USER\Software\Clients\StartMenuInternet\` `(default)`

这是注册表项中的注册表值，`HKEY_CURRENT_USER\Software\Clients\StartMenuInternet\` `(default)`而每个浏览器都是默认浏览器。

*   即 9.0.8112.16421：`IEXPLORE.EXE`
*   铬 21.0.1180.60 米：`Google Chrome`
*   火狐 10.0.2：`FIREFOX.EXE`
*   Safari 3.2.2：`Safari.exe`
*   歌剧 12.01：`Opera`

在 Microsoft Windows 7 Home Premium SP1 64 位上测试

编辑：

我发现全新安装的 Windows XP SP3`HKEY_CURRENT_USER\SOFTWARE\Clients\StartMenuInternet\`不存在。在这种情况下，您应该从`HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\`. 我怀疑其他版本的 Windows 的全新安装也是如此。

附录：

`ShellExecute`如果您只想在默认浏览器中打开网页，该方法是一个很好的解决方案。但是，例如，如果您想仅在默认浏览器中安装扩展程序，`ShellExecute`则不能解决问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-09T05:21:24.613

顾名思义，`StartMenuInternet`用于将 Web 浏览器注册到开始菜单（它仅适用于 XP 和 Vista，从 Windows 7 开始已弃用）。这并不一定将浏览器建立为整个系统的默认浏览器。有许多不同的方式可以为不同的目的注册浏览器（加载文件、加载 URL、加载基于 MIME 类型的数据等）。这些注册中的每一个都是独立的。

[默认程序](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144154.aspx)

[如何使用 Windows 开始菜单注册 Internet 浏览器或电子邮件客户端](http://msdn.microsoft.com/en-us/library/windows/desktop/dd203067.aspx)

[将应用程序注册到 URL 协议](http://msdn.microsoft.com/en-us/library/aa767914.aspx)

[文件类型](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144148.aspx)

就个人而言，我可能会查看“http”和/或“https” URL 处理程序的注册以确定默认浏览器，因为这将是当用户在开始菜单或 Windows 资源管理器中键入 URL 时加载的应用程序，或应用程序将 URL 传递给`ShellExecute/Ex()`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T07:50:35.370

读取 的默认值，`HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet`并可选择检查`HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\XXX\shell\open\command`XXX 是从第一个键中获取的值的位置。

# asp.net-mvc - ASP.NET MVC ViewUserControl：如何动态加载其脚本？

> ID：733213
> 
> 赞同：1
> 
> 时间：2009-04-09T07:38:54.120
> 
> 标签：asp.net-mvc, viewusercontrol

我有一个 ViewUserControl 将在我网站的某些页面中使用，但不是全部。

此 ViewUserControl 需要一个 javascript 文件，因此我希望将脚本引用自动添加到使用此 ViewUserControl 的页面的头部会话中，这可能吗？

我试图向它添加一个内容控件，但看起来它是不允许的。

我也可以将脚本标记直接添加到 ViewUserControl 的 .ascx 代码中，但是如果我在页面中有 N 个此类控件，我将添加脚本引用 N 次。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:27:34.170

在 ASCX 的代码隐藏中，注册您的脚本引用（或块）。我刚刚回答了一个类似的问题，解释了如何做到这一点：

[如何最好地控制 ASP.NET 中多个 javascript 文件的加载？](https://stackoverflow.com/questions/732854/how-to-best-control-loading-of-multiple-javascript-files-in-asp-net/733411#733411)

使用这种技术，您可以在页面上多次拥有相同的控件，但仍然只包含一次脚本（并且仅在实际包含该控件的页面上）。

# php - 使用 PHP 将 HTML 转换为 PDF？

> ID：733219
> 
> 赞同：56
> 
> 时间：2009-04-09T07:41:24.427
> 
> 标签：php, pdf, pdf-generation

> **可能重复：**
> [使用 PHP 将 HTML + CSS 转换为 PDF？](https://stackoverflow.com/questions/391005/convert-html-css-to-pdf-with-php)

是否可以使用 PHP 将 HTML 页面转换为 PDF，如果可以，如何实现？

具体来说，该页面是动态生成的发票。所以我希望它使用以下方式加载：

```
http://example.com/invoices/3333 
```

并且 HTML 输出必须转换为 PDF。

任何能做到这一点的好的图书馆都可以。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-09T08:31:43.307

如果您想从 php***创建***pdf，pdflib 将帮助您（正如其他一些人所建议的那样）。

否则，如果您想通过 PHP***将***HTML 页面转换为 PDF，您会在这里遇到一些麻烦。3 年来，我一直在尽我所能做到最好。

所以，我知道的选项是：

[DOMPDF](https://github.com/dompdf/dompdf "DOMPDF")：包装 html 并构建 pdf 的 php 类。效果很好，可定制（如果你知道 php），基于 pdflib，如果我没记错的话，它甚至需要一些 CSS。坏消息：当 html 很大或很复杂时速度很慢。

[HTML2PS](http://user.it.uu.se/~jan/html2ps.html "HTML2PS")：与 DOMPDF 相同，但这个文件首先转换为 .ps（ghostscript）文件，然后转换为您需要的任何格式（pdf、jpg、png）。对我来说比 dompdf 好一点，但有同样的*速度问题*.. 但是，与 CSS 更好的兼容性。

这两个是 php 类，但如果你可以在服务器上安装一些软件，并通过 passthru() 或 system() 访问它，也可以看看这些：

[wkhtmltopdf](https://wkhtmltopdf.org "wkhtmltopdf")：基于 webkit（safari 的包装器），非常快速和强大.. 似乎这是将 html 页面动态转换为 pdf 的最佳方法（atm）；使用 CSS2 的 3 页 xHTML 文档仅需 2 秒。是最近的一个项目，反正google.code页面经常更新。

[htmldoc](https://michaelrsweet.github.io/htmldoc/ "htmldoc")：这是一辆坦克，它永远不会真正停止/崩溃。自 2007 年以来，该项目看起来已经死了，但无论如何，如果您不需要 CSS 兼容性，这对您来说可能会很好。

# scripting - 有没有使用函数式编程的像样的脚本语言？

> ID：733222
> 
> 赞同：17
> 
> 时间：2009-04-09T07:42:03.130
> 
> 标签：scripting, functional-programming

我最近读了一些关于函数式编程的文章，很想玩一玩。是否有任何体面的脚本语言支持函数式编程？我发现我的大部分临时编程都是用 Python 完成的，所以我想我也许可以用函数式语言来做同样的事情。有什么建议吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T07:47:04.460

[Lua](http://en.wikipedia.org/wiki/Lua_(programming_language))似乎满足您的需求：

> Lua（发音为/ˈluː.ə/ LOO-uh）是一种轻量级、反射式、命令式和函数式编程语言，设计为以可扩展语义为主要目标的脚本语言。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T14:40:45.700

[Scala](http://www.scala-lang.org)也可以用作脚本语言。它在 JVM 上运行，支持命令式 OO 和函数式编程。使用它，您可以访问整个 Java 类库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T07:46:27.813

Python 可以写成函数式风格，JavaScript 也可以。如果您的意思是更纯粹的功能，那么您可以尝试 Haskell。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T08:32:35.003

GNU 的[Guile](http://www.gnu.org/software/guile/guile.html)可以用作独立的脚本解释器，有关详细信息，请参阅[此常见问题解答条目](http://www.gnu.org/software/guile/docs/faq/guile-faq.html#How-do-I-make-foo_002escm-into-an-executable-script_003f)。不过，不确定 Guile 中有多少通用编程支持，但它至少可以让您快速开始使用看起来和感觉上应该像“传统”函数式语言的东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T14:29:57.503

Perl 可以很好地进行函数式编程。无论如何，它都不是一种纯粹的函数式语言，但它支持相当多的函数式习语。经典的完整版是 Mark Jason Dominus 的[*Higher Order Perl*](http://hop.perl.plover.com/)，现在可以在线免费获得。

有关简要介绍，请查看以下幻灯片：

*   [Perl 中的函数式编程](http://perl.plover.com/yak/fp/)
*   [Perl 函数式编程简介](http://perl.jonallen.info/talks/functionalprogramming)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T08:14:27.030

这取决于您所说的“脚本语言”是什么意思。通常不这么看，但许多 Scheme 实现[似乎与](http://gd.tuwien.ac.at/languages/scheme/tutorial-dsitaram/t-y-scheme-Z-H-17.html)Python 一样符合要求，而 Lisp 是一种原型函数式语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-22T11:12:41.643

朱莉娅语言。也不仅仅是一种“脚本”语言，与 C 一样快。

在这里查看我的答案：[https ://www.quora.com/Whats-a-good-scripting-functional-programming-language/answer/Páll-Haraldsson](https://www.quora.com/Whats-a-good-scripting-functional-programming-language/answer/P%C3%A1ll-Haraldsson)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-23T12:37:11.683

我最近在研究一种功能性脚本语言，并且已经完成了第一个版本。它有点像 haskell/perl 组合，因此也很适合脚本和数学问题。例如，这是一个代码片段，展示了它是多么容易：

`5 times {echo["Iteration: " concat str[x]]}`

有兴趣的可以试试：[http ://ac1235.github.io](http://ac1235.github.io)

# symfony1 - Symfony 中的多个数据库支持

> ID：733224
> 
> 赞同：3
> 
> 时间：2009-04-09T07:42:37.247
> 
> 标签：symfony1

我正在使用 Propel 作为我的 Symfony 项目的 DAL。我似乎无法让我的应用程序跨两个或多个数据库工作。

这是我的 schema.yml：

```
db1:
  lkp_User:
    pk_User:                     { type: integer, required: true, primaryKey: true, autoIncrement: true }
    UserName:                    { type: varchar(45), required: true }
    Password:                    longvarchar
    _uniques:
      Unique:                    [ UserName ]

db2:
  tesco:
    Id:                  { type: integer, required: true, primaryKey: true, autoIncrement: true }
    Name:                { type: varchar(45), required: true }
    Description:         longvarchar 
```

这是databases.yml：

```
dev:
  db1:
    param:
      classname: DebugPDO
test:
  db1:
    param:
      classname: DebugPDO
all:
  db1:
    class: sfPropelDatabase
    param:
      classname: PropelPDO
      dsn: 'mysql:dbname=bpodb;host=localhost'   #where the db is located
      username: root
      password: #pass
      encoding: utf8
      persistent: true
      pooling: true

  db2:
    class: sfPropelDatabase
    param:
      classname: PropelPDO
      dsn: 'mysql:dbname=mystore2;host=localhost'   #where the db is located
      username: root
      password: #pass
      encoding: utf8
      persistent: true
      pooling: true 
```

当我调用时`php symfony propel-build-model`，只有`db1`生成，`db2`不是。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T11:43:43.423

[我解决了这个问题](http://itscommonsensestupid.blogspot.com/2009/04/how-to-configure-multiple-databases-for.html)！最重要的是您必须根据 %dbname%.schema.yml 命名您的架构。通过这种方式，Symfony 将能够将 ymls 分配给正确的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T10:44:47.250

此外，在运行任务时，您应该指定连接，例如：

```
symfony propel:build-all-load --connection=my_connection 
```

这对我有用，希望它有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T08:53:24.513

您还可以使用`Propel::getConnection('db2')`手动检索连接。

请记住，您所说的“db1”、“db2”是*连接名称*。您可以通过各种登录/权限（如只读等）与同一个数据库建立多个连接。

这非常适合测试目的：您可以使用相同的连接名称与不同的数据库进行操作。没有办法让你的生产数据库崩溃:)

# c# - 在树结构 C# 中查找所有类型为 T 的对象

> ID：733227
> 
> 赞同：4
> 
> 时间：2009-04-09T07:44:03.063
> 
> 标签：c#, generics, search, tree

我需要编写一个树搜索方法，它接受一个类型参数 T 并返回树中存在的所有类型 T 的项目。有没有办法做到这一点？在这一点上，我更喜欢优雅而不是效率......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T07:48:11.867

好吧，在内部，该方法必须遍历树的所有元素，因此跳到仅枚举它，并且使用 OfType LINQ 方法并没有那么远：

```
var onlyTs = yourTree.OfType<SomeT>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:51:31.623

像这样的东西：

```
internal static IEnumerable<T> AllDescendantNodes<T>( this TreeNode input ) 
    where T class;
{
    T current = null;
    foreach ( TreeNode node in input.Nodes )
        if( (current = node as T) != null )
        {
            yield return current;
            foreach ( var subnode in node.AllDescendantNodes<T>() )
                yield return subnode;
        }
} 
```

然后，您可以将其作为扩展方法针对根节点调用：

```
foreach( MyCustomNodeClass item in rootNode.AllDescendantNodes<MyCustomNodeClass>() ) 
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T07:46:55.567

假设你的树是通用的。即`Item<T>`。

```
int count = yourTree.Count(p => p == typeof(T)); 
```

否则，解析每个节点并比较“ `item == typeof(T)`”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T07:49:38.883

您需要的是一个基本的树遍历函数（前序、中序或后序——这无关紧要）和一个过滤器函数。然后你可以将这两者组合在一起并得到你需要的东西：

```
IEnumerable<T> Traverse(Tree<T> tree)
{
    yield return tree.Data;

    foreach(Tree<T> subtree in tree.Subtrees)
        foreach(T t in Traverse(subtree))
            yield return t;
}

IEnumerable<U> Filter<T, U>(IEnumerable<T> source)        
    where U : T
{
    foreach(T t in source)
        if(t is U)
            yield return (U)t;
} 
```

# sql-server - 与 IIS、Firefox 和 SQL Server 集成的 Windows 身份验证

> ID：733237
> 
> 赞同：16
> 
> 时间：2009-04-09T07:48:07.997
> 
> 标签：sql-server, windows, iis, firefox, authentication

我有一个网站在我的本地主机上的 IIS 上运行。此网站已将目录安全设置为仅允许集成 Windows 身份验证。它是 Intranet 的一部分，需要通过我们的域帐户进行身份验证。

然后，我在连接字符串中使用 Integrated Security = SSPI 连接到 SQL Server。

这适用于 Microsoft Internet Explorer，它会在我登录到域时自动对我进行身份验证，并且我可以看到 logon_user 是我的域帐户，并且 SQL Server 连接字符串工作得很好。

但是，当我使用 Firefox 登录时，情况有所不同。

首先，提示我进行身份验证，这很好且正确，因为 Firefox 没有配置为足够信任 localhost 以自动发送凭据（实际上我已经知道如何引入这种信任，这不是问题）。然后我登录，这再次很好，只要我输入域帐户详细信息一切都很好。事实上，一两个调试语句表明 login_user 仍然是我的域帐户，一切都很好。

但是，当我连接到 SQL Server（它在远程服务器上运行，我的域帐户拥有完整的系统管理员权限）时，我收到以下错误：

```
Microsoft OLE DB Provider for SQL Server (0x80040E4D)
Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'. 
```

这向我表明身份验证堆栈中有问题，由于某种原因，当我使用来自 firefox 的 Windows 身份验证进行身份验证时，IIS 没有作为经过身份验证的帐户运行。

这在使用 Google Chrome 时也可以正常工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-09T08:47:44.610

[正如Pontus Gagge 所](https://stackoverflow.com/users/20402/pontus-gagge)指出[的](https://stackoverflow.com/questions/733237/integrated-windows-authentication-with-iis-firefox-and-sql-server/733313#733313)，IIS 需要将[Kerberos](http://en.wikipedia.org/wiki/Kerberos%5F%28protocol%29)票证传递给 SQL Server。这足以让我的 Google-fu 朝着正确的方向发展。

Firefox 支持 Kerberos，但是，您必须告诉它它信任哪些域来发送 Kerberos 令牌。

1.  打开火狐
2.  在地址栏中输入：about:config
3.  Firefox3.x 及更高版本要求您同意谨慎行事。
4.  配置页面加载后，在过滤器框中输入：network.negotiate-auth
5.  通过双击行修改network.negotiate-auth.trusted-uris并输入yourdomain.com
6.  可以通过逗号分隔多个域，例如 yourdomain.com、yourotherdomain.com

**注意：**这与*gbn*的[解决方案](https://stackoverflow.com/questions/733237/integrated-windows-authentication-with-iis-firefox-and-sql-server/733309#733309)[不同](https://stackoverflow.com/users/27535/gbn)，它只是将 firefox 配置为不提示您在登录时输入域帐户详细信息。

此外，如果您已经尝试在当前 Firefox 会话中通过堆栈进行身份验证，则需要重新启动 Firefox 才能使其正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-09T08:14:47.917

1.  打开火狐
2.  在地址栏中输入：about:config
3.  Firefox3.x 及更高版本要求您同意谨慎行事。
4.  配置页面加载后，在过滤器框中输入：network.automatic
5.  通过双击该行并输入[http://www.replacewithyoursite.com修改 network.automatic-ntlm-auth.trusted-uris](http://www.replacewithyoursite.com)
6.  可以通过逗号分隔多个站点来添加多个站点，例如[http://www.replacewithyoursite.com](http://www.replacewithyoursite.com)、[http://www.replacewithyourintranetsite.com](http://www.replacewithyourintranetsite.com)

我还为 Intranet 站点使用 IEtab 插件

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-09T08:15:53.187

IIS 需要将[Kerberos](http://en.wikipedia.org/wiki/Kerberos_(protocol))票证传递给 SQL Server，此方案才能正常工作。MSIE 正在获取工作站会话票证，而 Firefox 正在协商自己的身份验证（而不是 Kerberos）。

查看例如[这篇密集的博客文章](http://blogs.msdn.com/sql_protocols/archive/2006/12/02/understanding-kerberos-and-ntlm-authentication-in-sql-server-connections.aspx)，作为了解所需内容的起点。我不确定 FF 是否支持 MS-Kerberos。

请注意，如果您有错误的版本或信任配置，即使获得 MSIE->IIS->SQL Server 身份验证也可能会很棘手......

# wcf-data-services - 如果实体位于 ado.net 数据服务中的项目列表中，则查询拦截器返回 true

> ID：733240
> 
> 赞同：1
> 
> 时间：2009-04-09T07:49:13.860
> 
> 标签：wcf-data-services

我正在使用 ado.net 数据服务，并希望在查询拦截器中实现行级安全性，以将数据限制为仅返回允许用户查看的数据。复杂性在于用户的用户名在另一个表上。所以我想我可以根据该用户的 OnlineSubscription 表中的条目检索用户可以看到的事件列表，然后返回当前事件是否与返回的任何条目匹配，如下所示：

```
[QueryInterceptor("Events")]
public Expression<Func<Events, bool>> QueryEvents()
{

  var allowedEventList = (from os in context.OnlineSubscription
                          from e in os.Events
                         where os.UserName == HttpContext.Current.User.Identity.Name
                         select e;

return e => events.Intersect(new List<Events>
                                         {
                                                 e
                                         }).Any();
} 
```

但是，这会引发“未实现”异常。所以我的问题是：是否有正确的方法将当前实体与查询拦截器中的实体列表进行比较？

编辑：我也试过：

```
return e => events.Any(evnt => evnt.Event_Key == e.Event_Key); 
```

没有任何成功（再次获得“未实施”异常）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T04:38:02.447

显然这失败了，因为通过使用 lambda 表达式 events.Any... 它已经在初始上下文中查询（即直接查询事件），然后当您添加 events.Any 子句时，它还尝试查询新上下文（即 OnlineSubscription 中事件的嵌套“来自”），因此它可以理解地引发异常。

然后我用：

```
[QueryInterceptor("Events")]
public Expression<Func<Events, bool>> QueryEvents()
{    
    return e => e.OnlineSubscription.Any(os => os.UserName == HttpContext.Current.User.Identity.Name);
} 
```

这很有效，因为这只是在与初始查询相同的上下文中进行查询，并且只是遍历关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-03T01:05:20.773

真的吗？我收到此代码的“未实现”异常：

```
[QueryInterceptor("Products")]
public Expression<Func<Product, bool>> QueryProducts()
{
    return p => p.User.Username == HttpContext.Current.User.Identity.Name;
} 
```

如果我通过 Product 对象本身的属性进行过滤，但不是通过它的任何关系进行过滤，它工作正常。

# c# - 如何在 C# 中将数组的一部分复制到另一个数组？

> ID：733243
> 
> 赞同：155
> 
> 时间：2009-04-09T07:49:59.960
> 
> 标签：c#, arrays

如何将数组的一部分复制到另一个数组？

考虑我有

```
int[] a = {1,2,3,4,5}; 
```

现在，如果我给出数组的开始索引和结束索引，`a`它应该被复制到另一个数组。

就像我将起始索引设为 1 并将结束索引设为 3 一样，元素 2、3、4 应该被复制到新数组中。

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-04-09T07:52:09.407

```
int[] b = new int[3];
Array.Copy(a, 1, b, 0, 3); 
```

*   a = 源数组
*   1 = 源数组中的起始索引
*   b = 目标数组
*   0 = 目标数组中的起始索引
*   3 = 要复制的元素

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-09T07:55:40.960

看到[这个问题](https://stackoverflow.com/questions/406485/array-slices-in-c)。LINQ Take() 和 Skip() 以及 Array.CopyTo() 是最受欢迎的答案。

[这里描述了](http://www.dotnetperls.com/array-slice)一种据称更快的扩展方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-05-16T10:01:49.670

```
int[] a = {1,2,3,4,5};

int [] b= new int[a.length]; //New Array and the size of a which is 4

Array.Copy(a,b,a.length); 
```

其中 Array 是具有方法 Copy 的类，它将数组的元素复制到 b 数组。

从一个数组复制到另一个数组时，您必须为要复制的另一个数组提供相同的数据类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-09T05:05:15.093

注意：我发现这个问题正在寻找如何***调整***现有数组大小的答案中的步骤之一。

所以我想我会在这里添加这些信息，以防其他人正在寻找如何进行范围复制作为调整数组大小问题的部分答案。

对于其他任何发现这个问题的人都在寻找与我相同的东西，这非常简单：

```
Array.Resize<T>(ref arrayVariable, newSize); 
```

其中*T*是类型，即声明 arrayVariable 的位置：

```
T[] arrayVariable; 
```

该方法处理空值检查，以及 newSize==oldSize 无效，当然也可以静默处理其中一个数组比另一个数组长的情况。

有关更多信息，请参阅[MSDN 文章](http://msdn.microsoft.com/en-us/library/bb348051%28v=vs.110%29.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-26T09:55:56.640

如果您想实现自己的**Array.Copy**方法。

属于泛型类型的静态方法。

```
 static void MyCopy<T>(T[] sourceArray, long sourceIndex, T[] destinationArray, long destinationIndex, long copyNoOfElements)
 {
  long totaltraversal = sourceIndex + copyNoOfElements;
  long sourceArrayLength = sourceArray.Length;

  //to check all array's length and its indices properties before copying
  CheckBoundaries(sourceArray, sourceIndex, destinationArray, copyNoOfElements, sourceArrayLength);
   for (long i = sourceIndex; i < totaltraversal; i++)
     {
      destinationArray[destinationIndex++] = sourceArray[i]; 
     } 
  } 
```

边界方法实现。

```
private static void CheckBoundaries<T>(T[] sourceArray, long sourceIndex, T[] destinationArray, long copyNoOfElements, long sourceArrayLength)
        {
            if (sourceIndex >= sourceArray.Length)
            {
                throw new IndexOutOfRangeException();
            }
            if (copyNoOfElements > sourceArrayLength)
            {
                throw new IndexOutOfRangeException();
            }
            if (destinationArray.Length < copyNoOfElements)
            {
                throw new IndexOutOfRangeException();
            }
        } 
```

# c++ - 如何将二进制 std::string 插入 BLOB

> ID：733262
> 
> 赞同：5
> 
> 时间：2009-04-09T07:56:08.757
> 
> 标签：c++, mysql, blob

我有二进制 std::string ，我需要使用我拥有的简单数据层将它插入到 BLOB (MySQL) 中。所以，我需要执行查询：`ExecuteSQL((LPTSTR)strQ)`。

当我创建此查询字符串 (strQ) 时，我无法在添加此二进制字符串后向字符串中添加任何内容 - 如果终止它只是一种类型，并且无法添加任何内容。我不想使用`mysql_real_escape_string`，因为我想不仅为 MySQL 保留它。

请任何人帮忙！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T08:04:42.280

假设您的代码如下所示：

```
std::string s = ...      // populate string somehow
ExecuteSQL( (LPCSTR) s ); 
```

然后你有几个问题。Forstly，演员阵容不会工作。在 C++ 中，**每当**您使用强制转换时，您几乎肯定会做一些不正确的事情，这会破坏您的代码。您需要使用 std::string 成员函数 c_str() 创建一个以 null 结尾的字符串：

```
ExecuteSQL( s.c_str() ); 
```

但是，这可能无法解决您的所有问题，因为您说您有一个二进制字符串。如果该字符串包含零字节，那么您的 SQL 将终止于该字符而不是字符串的结尾。在这种情况下，您可能需要研究明确绑定您的值。

**编辑：**有关如何将参数绑定到 MySQL 语句的详细信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/mysql-stmt-bind-param.html](http://dev.mysql.com/doc/refman/5.1/en/mysql-stmt-bind-param.html)

# python - Python中的函数重载：缺失

> ID：733264
> 
> 赞同：63
> 
> 时间：2009-04-09T07:57:01.207
> 
> 标签：python, overloading, missing-features

正如*[函数重载](http://web.archive.org/web/20090624083829/http://mail.python.org/pipermail/python-list/2003-May/206149.html)*所说：

Python 中没有函数重载。

就我而言，这是一个很大的障碍，因为它也是一种面向对象（OO）的语言。最初我发现无法区分参数类型很困难，但是 Python 的动态特性使它变得容易（例如，列表、元组、字符串非常相似）。

但是，计算传递的参数数量然后执行这项工作就像是矫枉过正。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-09T09:36:49.093

现在，除非您尝试使用 Python 语法编写 C++ 代码，否则您需要重载什么？

我认为恰恰相反。重载只是使强类型语言的行为更像 Python 所必需的。在 Python 中，您有关键字参数，并且有`*args`and `**kwargs`。

参见例如：*[什么是在 Python 中拥有多个构造函数的干净的 Pythonic 方式？](https://stackoverflow.com/questions/682504/what-is-a-clean-pythonic-way-to-have-multiple-constructors-in-python)*

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-09T09:48:07.273

正如 unwind 所指出的，具有默认值的关键字参数可以走很长的路。

我还要声明，在我看来，过多地担心将哪些类型传递给方法，这违背了 Python 的精神。在 Python 中，我认为使用鸭子类型更容易接受——询问对象可以做什么，而不是它是什么。

因此，如果您的方法可以接受字符串或元组，您可以执行以下操作：

```
def print_names(names):
    """Takes a space-delimited string or an iterable"""
    try:
        for name in names.split(): # string case
            print name
    except AttributeError:
        for name in names:
            print name 
```

然后您可以执行以下任一操作：

```
print_names("Ryan Billy")
print_names(("Ryan", "Billy")) 
```

尽管这样的 API 有时表明存在设计问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-09T08:52:36.517

您不需要函数重载，因为您有 *args 和 **kwargs 参数。

事实上，函数重载是基于传递不同类型将执行不同代码的想法。如果你有像 Python 这样的动态类型语言，你不应该按类型区分，但你应该处理接口及其与你编写的代码的一致性。

例如，如果您有可以处理整数或整数列表的代码，您可以尝试对其进行迭代，如果您不能，那么您假设它是一个整数并继续前进。当然它可以是一个浮点数，但就行为而言，如果浮点数和整数看起来相同，那么它们可以互换。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-09T08:08:34.097

通常，您会看到建议使用带有默认值的关键字参数。调查一下。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-09T08:53:55.233

您可以将可变容器数据类型传递给函数，它可以包含您想要的任何内容。

如果您需要不同的功能，请以不同的方式命名函数，或者如果您需要相同的接口，只需编写一个接口函数（或方法），根据接收到的数据适当地调用函数。

我花了一段时间来适应来自 Java 的这种情况，但这确实不是一个“大障碍”。

# java - 如何从源代码制作midlet？

> ID：733268
> 
> 赞同：0
> 
> 时间：2009-04-09T07:59:00.903
> 
> 标签：java, java-me, compilation, midp, midlet

嘿，我有一些 midlet 应用程序的源文件。如何将这些编译成可以在手机上运行的 midlet？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T08:09:01.630

下载 Netbeans

创建新项目并将您的资源添加到其中

编译，你就完成了。

[面向 Midlets 的 Netbeans 简单指南](http://www.netbeans.org/kb/60/mobility/quickstart.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T08:33:34.830

您可以从现有源代码在[Netbeans](http://www.netbeans.org/) （6.5 版）中创建 Java Mobile 项目。打开 Netbeans，然后打开 File -> New Project 菜单。这是你看到的：

[替代文字 http://img17.imageshack.us/img17/8241/javame.jpg](http://img17.imageshack.us/img17/8241/javame.jpg)

创建项目，右键单击其名称并部署。在项目的 dist 文件夹中创建一个 MIDP jar 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T08:15:36.823

我在这里从记忆中走出来，自从我写任何移动Java以来​​已经有一段时间了。

首先，您需要获取 J2ME 库 - 即 Java2 Mobile Edition ^*。除了一些特定于移动设备的包之外，它们还包含 Java 库的子集。

然后，您的应用程序必须实现一个扩展 MIDlet 类的类。MIDlet 类是移动设备和应用程序之间的接口。

编译和预验证代码，创建清单并将全部打包到 JAR 文件中。

将 JAR 文件放到手机上很大程度上取决于您使用的手机 - 并非所有手机都允许您从 PC 下载应用程序，有些需要特殊的电缆。

[这是一个更详细的网站。](http://today.java.net/pub/a/today/2005/02/09/j2me1.html)

*   自从我编写 midlets 以来，似乎对名称进行了更新。

# sql - 先学习 LINQ，然后学习 SQL 是不是一个好主意？

> ID：733269
> 
> 赞同：6
> 
> 时间：2009-04-09T07:59:34.413
> 
> 标签：sql, linq

我知道在大多数情况下，学习更复杂的技术/语言然后再简单比反之更有用。
但是，实际上，完成大学任务的时间是有限的。如果我先学LINQ，再学SQL，会不会很难用和学sql？
**编辑**
我需要做的任务是使用数据库并从中获取一些数据，所以问题几乎是关于 LINQ to SQL 的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-09T08:00:45.317

这是个坏主意。

如果今天的大学教你LINQ，而不是给你奠定知识基础，我只能为他们的学生感到难过和可怜。

时间总是有限的。不要把它浪费在不断变化的事情上。

SQL 明天就会出现，LINQ....谁知道呢。

SQL 适用于任何地方，LINQ 仅适用于 .NET 世界。

无论是 LINQ 还是其他东西，之后“学习”它都很容易。当您了解 SQL 时，我只需几个小时/几天/几周，几乎不会更长。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-09T08:02:24.983

嗯，这两件事是非常不同的。*LINQ（在*纯粹意义上）实际上与数据库无关——它可以非常愉快地与内存对象一起使用，或者针对 Web 服务等。

如果您主要对编写更好的 .NET 代码感兴趣，那么学习 LINQ - 但要*正确地*学习它- 例如，可能会[在 Depth 中学习 C#](http://www.manning.com/skeet/) - 这在最后几章中很好地涵盖了它。

如果您想了解数据库，那么请务必：学习 SQL（例如 TSQL）——但要了解其中的差异。如果您需要编写企业软件，数据库是很好的，但如果您只是想做简单的任务，则不一定。

**编辑重新编辑问题**

如果您只是在数据库中输入和输出简单数据，那么您可能不需要对 SQL 了解太多。只需使用 LINQ-to-SQL（或任何工具），然后让 ORM 工具担心它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T08:06:35.863

SQL是标准，学习标准。

更确切地说 ：

*   学习数据库理论

*   学习 CODD 代数

*   然后拿起一个“通用数据库”，在上面做一些教程，...

我个人非常喜欢 PostgreSQL[教程](http://www.postgresql.org/docs/8.3/interactive/tutorial.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T08:08:11.303

先学 SQL，再学 LINQ。

这样，您将了解 LINQ-to-SQL 是如何在幕后工作的，但您也将了解足够多的知识，以便在 LINQ 无法满足您的需求时应对。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T14:07:21.953

我认为除非你有 SQL 知识，否则你不能有效地使用 LINQ。如果您至少不了解以下内容，则无法以任何方式有效地查询数据库：

```
select
insert
delete
update
joins
group by
boolean algebra
relational theory
set theory 
```

即使您以后使用 LINQ，学习 SQL 也会为您提供所需的概念。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T17:46:30.587

Sql。但是你可以玩一会儿[linq pad - 它是一个免费软件，并意识到 LINQ 是 SQL 和 C# 之间的一个很好的混合体](http://www.linqpad.net/)

# wpf - WPF 列表视图

> ID：733277
> 
> 赞同：0
> 
> 时间：2009-04-09T08:02:51.690
> 
> 标签：wpf, listview

如果我在设计时不知道列名，如何为 WPF ListView 创建类似 GridView 的视图，因为集合将在运行时创建，并且集合的类型为 DataTable，它可能包含列数。我可以用 WPF DataGrid 来做，但我想用 WPF ListView 来实现，我想在没有代码的情况下实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T06:08:20.207

您可以使用附加属性将列动态添加到 ListView。查看**CodeProject**上的这篇文章，它准确地解释了......

[WPF DynamicListView - 绑定到 DataMatrix](http://www.codeproject.com/KB/WPF/WPF_DynamicListView.aspx)

# c# - 使用 WiX 部署 CLR 触发器/存储过程

> ID：733286
> 
> 赞同：0
> 
> 时间：2009-04-09T08:06:24.413
> 
> 标签：c#, sql-server-2005, deployment, sqlclr

由于 stackoverflow 的创始人谈论了能够轻松部署更改，我正在尝试提出一个解决方案来解决我的问题。一个快速的背景是，一个客户联系了我，需要在数据库上完成一些不那么简单但并不难做到的事情（我花了大约一天的时间让这个过程开始工作）。不幸的是，客户需要能够部署这个“修复”大约 20 次，并且没有我的输入，因为他不会为此付费。

我编写了一个 CLR 触发器，它可以完成一些使用 TSQL 否则会非常困难的工作（xml 文档转换......我更擅长使用 CLR 与 TSQL）。部署通常是几行 SQL 并将 dll 转储到我可以钓到的目录中（到目前为止我只从 VS.Net 部署过）。

我需要做的是提供一个 MSI 安装程序，它将文件拖放到文件夹中，并提示用户输入将 CLR 过程连接到正确的数据库/表所需的数据库信息。

过去有没有人这样做过，如果有，你愿意教别人如何做到这一点，这样我就可以完成这个项目吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T08:14:33.690

如果您想避免放置文件的麻烦，可以使用 CREATE ASSEMBLY 语句的替代形式，该语句以字节形式指定程序集。例如

```
CREATE ASSEMBY MyAssembly FROM 0xFFFF....; 
```

显然，您将拥有我放置的实际汇编字节`0xFFFF....`。

# database - 在创建社交投票系统时，您是否应该在数据库中分别跟踪反对票和赞成票？

> ID：733288
> 
> 赞同：3
> 
> 时间：2009-04-09T08:07:09.433
> 
> 标签：database, social-networking, voting

使用 SO、Digg、Reddit 等...

是否应该独立于赞成票跟踪数据库中的反对票？或者他们应该只是有一个“投票”字段，根据用户所做的事情而减少/增加，而不需要持续存在？

应该如何处理选票？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T08:10:25.557

在 SO 上，赞成票获得+10，反对票获得-2。为此，需要单独跟踪它们。一个有争议的答案很可能会产生几个，而仅仅显示一个总数并没有多大意义。所以我会说让他们分开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T08:10:32.687

我会把它们分开。有些问题有很多活动（上下），你真的很想找出那些。

即使您现在对差异不感兴趣，表中的额外字段也不会那么昂贵，因此将其分开也没有什么坏处。因为如果你以后想添加它，如果不单独存储，你就无法检索数据。

我还假设 SO 对 CW 和非 CW 条目分别进行投票。因为如果问题稍后更改为 CW，即使重新计算，也会保留原始获得/丢失的代表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T08:28:30.537

取决于您希望如何处理您的数据。

如果您只想显示选票而不是我说您只使用一个字段。这就像论坛上某个主题的观看次数。您想查看点击次数最多的内容，而不是有人查看了多少次。

SO上的投票系统有点复杂。由于他们可以取消来自特定用户的所有投票，因此他们必须跟踪**谁**投票支持/反对**什么**。我认为，这写在另一个表中，但是因为每次有人查看问题时重新计算所有投票的成本很高，所以他们将计算值保留在字段中，每当有人投票时更改它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T08:54:08.557

我可以建议您将它们分开存储，甚至可能包含编写特定赞成或反对票的额外数据。谁知道呢，明天你可能会想出一个好主意，而你将需要这些额外的数据来实现它。

但最好有一种预先计算的字段（我们称之为缓存），只要提交赞成票或反对票，它就会更新。然后将使用此预先计算的字段呈现页面。这将增加响应时间并减轻 DB 上的负载。

如果立即重新计算值的成本太高，您可以考虑运行一些调度程序任务（每小时一次？），这将处理最新的投票并重新计算缓存的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T09:31:45.800

考虑到社交投票网站数据库中的数据量，用于存储否决票的额外`int`列的额外空间可以忽略不计，所以你会疯了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T08:10:43.170

好吧，鉴于 SO 有 +10 表示赞成票和 -2 表示反对票，并且偶尔会进行重新计算，因此需要独立存储它们。

否则，最初给您 90 分的 10 个赞成票和 5 个反对票的答案，如果它们没有单独存储，这将重新计算为 50。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T08:10:45.650

我会将它们分开，以便我可以单独查看它们。在社会上，赞成与反对是非常不同的，如果是我，我希望能够独立地看待它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T08:13:54.970

出于一个非常简单的原因，绝对是分开的。明天你会想做一些额外的事情，需要这些信息（例如某种报告或图表）。除了单独保存它们之外，您不会花费任何费用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T08:16:15.497

因为人们通常可以投票一次，并且（例如在 SO 中）可以取消他们的投票，所以您需要知道谁投票、在什么时间、什么投票以及在哪个项目上投票。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-09T08:16:16.340

我敢肯定，downvotes 和 upvotes 是分开保存的，尽管可能有一个聚合字段来保持计数。SO 可以让您稍后更改投票（使反对票成为赞成票），这就是为什么我相信每个用户也会记录投票。

# tomcat - Tomcat和windows集成认证

> ID：733289
> 
> 赞同：2
> 
> 时间：2009-04-09T08:08:05.780
> 
> 标签：tomcat, windows-authentication

我正在开发一个必须在 Tomcat 上运行的 Java 应用程序，并且我需要能够识别正在访问我的应用程序 Web 的远程用户。

这个远程用户在 Windows 上运行，所以我需要获取他的“Windows 登录”（SAMAccountName Active Directory 属性）。

在 IIS 上是最简单的。我按照这个[Detect user logged on a computer using ASP.NET app](https://stackoverflow.com/questions/688939/detect-user-logged-on-a-computer-using-asp-net-app)让用户登录

server.xml 的内容是：

```
<Realm
    className="org.apache.catalina.realm.JNDIRealm" debug="99"
    connectionURL="ldap://DAServer:389"
    connectionName="userAuth@mydomain.local"
    connectionPassword="secret"
    referrals="follow"
    userBase="OU=mycompany,DC=mydomain,DC=local"
    userSubtree="true"
    roleBase="OU=groups,DC=mydomain,DC=local"
    roleName="name"
    roleSubtree="true"
    roleSearch="(member={0})"/> 
```

而web.xml的内容是：

```
<!-- Define a Security Constraint on this Application -->
    <security-constraint>
        <web-resource-collection>
        <web-resource-name>Entire Application</web-resource-name>
            <url-pattern>/*</url-pattern>
        </web-resource-collection>

        <auth-constraint>
            <role-name>myCompany Users</role-name>
        </auth-constraint>
    </security-constraint>

    <!-- Define the Login Configuration for this Application -->
    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>myRealm</realm-name>
    </login-config>

    <!-- Security roles referenced by this web application -->
    <security-role>
        <description>The role that is required to log in to APP</description>
        <role-name>myCompany Users</role-name>
    </security-role> 
```

我需要自动登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T02:04:07.453

如果您正在构建 Intranet 应用程序并正在寻找 SSO，那么您可以使用基于[jCIFS的](http://jcifs.samba.org/)[Jespa 之](http://www.ioplex.com/jespa.html)类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T08:15:47.713

您必须使用 Tomcat JNDI 领域并将其与服务器的活动目录集成

[在这里](http://www.jspwiki.org/wiki/ActiveDirectoryIntegration)尝试一些指南

# c# - C# 中的 PHP Web 服务：Invoke() 函数返回 null

> ID：733303
> 
> 赞同：2
> 
> 时间：2009-04-09T08:13:01.433
> 
> 标签：c#, .net, web-services, apache, serialization

我在使用 .NET C# 中的第三方 Web 服务时遇到问题。它在 Apache (NuSoap) 上运行。一切正常，直到反序列化（可能......）。当我调用该`SoapHttpClientProtocol.Invoke()`函数时，我总是得到一个带有一个空对象的对象数组。不好的是这个 Web 服务不提供 WSDL 文档。:-(

有人可以帮我吗？我认为，反序列化过程没有运行。

这是肥皂的回应：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/">
  <SOAP-ENV:Body>
    <ns1:EncodingTestResponse xmlns:ns1="http://schemas.xmlsoap.org/soap/envelope/">

      <item xmlns:ns4071="http://xml.apache.org/xml-soap" xsi:type="ns4071:Map">
        <item>
          <key xsi:type="xsd:string">ascii</key>
          <value xsi:type="xsd:string">ertzyuuioasdcnERSTZYUIOADCN</value>
        </item>
        <item>
          <key xsi:type="xsd:string">latin2</key>
          <value xsi:type="xsd:string">xy</value>
        </item>
        <item>
          <key xsi:type="xsd:string">w1250</key>
          <value xsi:type="xsd:string">pq</value>
        </item>
      </item>

    </ns1:EncodingTestResponse>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

调用方法：

```
[SoapTrace]
[SoapDocumentMethod("EncodingTest",ParameterStyle=SoapParameterStyle.Wrapped)]
public item EncodingTest()
{
    var obj = this.Invoke("EncodingTest", new object[] {});
    return null;
} 
```

和我试图反序列化的对象：

```
[Serializable]  
[XmlType(Namespace = "http://xml.apache.org/xml-soap", TypeName="item")]
public class item
{
    [XmlArray("item", Form = XmlSchemaForm.Unqualified)]
    public item[] items { get; set; }

    [XmlElement(Form=XmlSchemaForm.Unqualified)]
    public string key { get; set; }

    [XmlElement(Form = XmlSchemaForm.Unqualified)]
    public string value { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-02T06:37:11.983

我解决了这个问题，但这并不容易。至少我学会了控制 xml 反序列化.. :)

```
[SoapDocumentMethod(ResponseElementName = "EncodingTestResponse", ResponseNamespace = "http://schemas.xmlsoap.org/soap/envelope/")]
[return: XmlArray("item", Namespace = "", IsNullable = false)]
[SoapTrace]
public item[] EncodingTest()
{
    object[] result = this.Invoke("EncodingTest", new object[] { });
    return (item[])result[0];
}

[SoapType(TypeName = "Map", Namespace = "http://xml.apache.org/xml-soap")]
    public class item
    {
        [XmlElement(Form = XmlSchemaForm.Unqualified)]
        public string key { get; set; }

        [XmlElement(Form = XmlSchemaForm.Unqualified)]
        public string value { get; set; }

        public item[] items { get; set; }
    } 
```

# php - 我可以使用什么 php html 标记器？

> ID：733304
> 
> 赞同：1
> 
> 时间：2009-04-09T08:13:38.530
> 
> 标签：php, html, tokenize

我需要处理在我的 Web 应用程序中提交的 html，并且不想用正则表达式来处理整个事情。我应该采用什么标记器方法和/或软件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T08:29:22.203

我会使用[DOMDocument::loadHTML 方法](http://docs.php.net/manual/en/domdocument.loadhtml.php)来加载 HTML 文档。如果您想要比 DOMDocument 方法更简单的处理，您可以使用[`simplexml_import_dom()`](http://docs.php.net/manual/en/function.simplexml-import-dom.php).

# scripting - 使用 VBS 计算 .c 文件中 #defines 的数量

> ID：733311
> 
> 赞同：2
> 
> 时间：2009-04-09T08:15:44.640
> 
> 标签：scripting, vbscript

我需要`#define`使用 VBS 计算 C 文件（其中 3 个）中的行数。请建议实现此目的的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T19:19:21.547

下面的脚本使用正则表达式来计算`#define`出现在行首的语句。语句之前以及`#`and之间允许有空格`define`。要搜索的文件列表应作为参数传入，例如：

```
cscript.exe script_name.vbs c:\myfile1.c c:\myfile2.c 
```

这是脚本代码：

```
Const ForReading = 1

Set oFSO = CreateObject("Scripting.FileSystemObject")

Set re = New RegExp
re.Pattern    = "^\s*#\s*define\b"
re.IgnoreCase = False
re.Global     = True
re.Multiline  = True

strReport = ""
For Each strFileName in WScript.Arguments.Unnamed
  Set oFile = oFSO.OpenTextFile(strFileName, ForReading)
  strText = oFile.ReadAll
  oFile.Close

  intCount  = re.Execute(strText).Count
  strReport = strReport & "There are " & intCount & " #define statement(s) in " & strFileName & vbNewLine
Next

WScript.Echo strReport 
```

脚本输出如下：

```
There are 7 #define statement(s) in c:\myfile1.c
There are 0 #define statement(s) in c:\myfile2.c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T15:27:53.357

这样的事情怎么样？只需将文件作为参数传入

```
 Const token = "#define"
Set objArgs = WScript.Arguments

tokenCount = 0

Set fso = CreateObject("Scripting.FileSystemObject")

For i = 0 To objArgs.Count - 1
    Set objFile = fso.OpenTextFile(objArgs(i), 1)
    Do Until objFile.AtEndofStream
         lineCount = lineCount + 1
         If InStr(1, objFile.ReadLine, token, 1)  0 Then
              tokenCount = tokenCount + 1
        End If
    Loop
Next

WScript.echo tokenCount 
```

这将忽略 # 和定义之间的空格

```
 Const token = "#define"
Set objArgs = WScript.Arguments

tokenCount = 0

Set fso = CreateObject("Scripting.FileSystemObject")

For i = 0 To objArgs.Count - 1
    Set objFile = fso.OpenTextFile(objArgs(i), 1)
    Do Until objFile.AtEndofStream
         lineCount = lineCount + 1
         If InStr(1, Replace(objFile.ReadLine, " ", "", 1, -1, 1), token, 1)  0 Then
            tokenCount = tokenCount + 1
        End If
    Loop
Next

WScript.echo tokenCount 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:14:05.557

此代码应计算任意数量的输入文件中的所有#define 语句。语句中已对空格进行了规定，例如“#define”或“#define”，它们都是有效的语句。

注意：我不计算一行的 # 和下一行的 "define"，我假设 # 和 "define" 至少在同一行，尽管您可以通过阅读整个文件和删除所有空格，然后保存到变量或临时文件或类似文件中并将其用作您的输入。

您可以通过放弃文件访问常量等来缩短代码，否则它将为您提供如下输出：

```
There are: 9 define statements in the source: c:\define.txt
There are: 11 define statements in the source: c:\define2.txt
There are: 10 define statements in the source: c:\define3.txt 
```

命令行将是： cscript scriptname.vbs c:\define.txt c:\define3.txt 等...

```
' Define constants for file access
Const TristateFalse = 0
Const ForReading = 1
Const ForWriting = 2
Const ForAppending = 8

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objArgs = WScript.Arguments

If objArgs.Count > 0 then

    For i = 0 To objArgs.Count - 1

        Set objFileInputStream = objFSO.OpenTextFile(objArgs(i), ForReading, False, TristateFalse)  

        intTempCount = 0
        tokenCount = 0
        Do while not objFileInputStream.AtEndOfStream   

            strLine = replace(ucase(objFileInputStream.ReadLine), " ", "")
            intLineLength = len(strLine)

            Do      

                If instr(strLine, "#DEFINE")  <> 0 then 
                    tokenCount = tokenCount + 1
                    strLine = replace(strLine, "#DEFINE","", 1, 1)
                    intTempCount = intTempCount + 1         
                else
                    exit do
                End If

            Loop until intTempCount = intLineLength

        Loop

        objFileInputStream.Close
        wscript.echo "There are: " & tokenCount & " define statements in the source: " & objArgs(i)

    Next

Else    
    wscript.echo "You must enter at least one filename."
End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T00:40:53.480

我不擅长 VB 脚本，但类似...

```
Dim re as New RegExp
re.IgnoreCase = True
re.Global = True
re.Pattern = "#define"
Set mc = re.Execute(yourFileText)
ans = mc.Count 
```

# jquery - jQuery 循环从 AJAX 成功的 JSON 结果？

> ID：733314
> 
> 赞同：160
> 
> 时间：2009-04-09T08:15:59.553
> 
> 标签：jquery, ajax, json

在 jQuery AJAX 成功回调上，我想遍历对象的结果。这是响应在 Firebug 中的外观示例。

```
[
 {"TEST1":45,"TEST2":23,"TEST3":"DATA1"},
 {"TEST1":46,"TEST2":24,"TEST3":"DATA2"},
 {"TEST1":47,"TEST2":25,"TEST3":"DATA3"}
] 
```

如何遍历结果以便可以访问每个元素？我已经尝试过类似下面的方法，但这似乎不起作用。

```
jQuery.each(data, function(index, itemData) {
  // itemData.TEST1
  // itemData.TEST2
  // itemData.TEST3
}); 
```

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-04-09T08:41:29.413

您可以删除外循环并替换`this`为`data.data`：

```
$.each(data.data, function(k, v) {
    /// do stuff
}); 
```

你很接近：

```
$.each(data, function() {
  $.each(this, function(k, v) {
    /// do stuff
  });
}); 
```

您有一个对象/映射数组，因此外部循环遍历这些对象/映射。内部循环遍历每个对象元素的属性。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2011-04-03T19:26:02.700

您还可以使用[getJSON](http://api.jquery.com/jQuery.getJSON/)函数：

```
 $.getJSON('/your/script.php', function(data) {
        $.each(data, function(index) {
            alert(data[index].TEST1);
            alert(data[index].TEST2);
        });
    }); 
```

这实际上只是对 ifesdjeen 答案的改写，但我认为它可能对人们有所帮助。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-04-09T08:58:08.920

如果您使用 Fire Fox，只需打开控制台（使用 F12 键）并尝试以下操作：

```
var a = [
 {"TEST1":45,"TEST2":23,"TEST3":"DATA1"},
 {"TEST1":46,"TEST2":24,"TEST3":"DATA2"},
 {"TEST1":47,"TEST2":25,"TEST3":"DATA3"}
];

$.each (a, function (bb) {
    console.log (bb);
    console.log (a[bb]);
    console.log (a[bb].TEST1);
}); 
```

希望能帮助到你

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-12-10T21:33:09.803

对于其他坚持这一点的人，它可能不起作用，因为 ajax 调用将您返回的数据解释为文本 - 即它还不是 JSON 对象。

您可以通过手动使用 parseJSON 命令将其转换为 JSON 对象，或者只需将 dataType: 'json' 属性添加到您的 ajax 调用中。例如

```
jQuery.ajax({
    type: 'POST',
    url: '<?php echo admin_url('admin-ajax.php'); ?>',
    data: data, 
    dataType: 'json', // ** ensure you add this line **
    success: function(data) {
        jQuery.each(data, function(index, item) {
            //now you can access properties using dot notation
        });
    },
    error: function(XMLHttpRequest, textStatus, errorThrown) {
        alert("some error");
    }
}); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-04-09T08:47:17.933

像访问任何其他数组一样访问 json 数组。

```
for(var i =0;i < itemData.length-1;i++)
{
  var item = itemData[i];
  alert(item.Test1 + item.Test2 + item.Test3);
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-12-02T04:18:33.773

这是我想出的轻松查看所有数据值的方法：

```
var dataItems = "";
$.each(data, function (index, itemData) {
    dataItems += index + ": " + itemData + "\n";
});
console.log(dataItems);
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-09-30T15:36:06.137

试试**jQuery.map**函数，它与地图配合得很好。

```
var mapArray = {
  "lastName": "Last Name cannot be null!",
  "email": "Email cannot be null!",
  "firstName": "First Name cannot be null!"
};

$.map(mapArray, function(val, key) {
  alert("Value is :" + val);
  alert("key is :" + key);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-06-13T15:09:16.980

如果您不想要警报，那就是您想要 html，然后执行此操作

```
...
    $.each(data, function(index) {
        $("#pr_result").append(data[index].dbcolumn);
    });
... 
```

注意：使用“append”而不是“html”，否则最后的结果就是您将在 html 视图中看到的结果

那么你的 html 代码应该是这样的

```
...
<div id="pr_result"></div>
... 
```

您还可以在 jquery 中为 div 设置样式（添加类），然后再将其呈现为 html

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-01-22T16:47:37.693

我将 .map 用于 foreach。例如

```
success: function(data) {
  let dataItems = JSON.parse(data)
  dataItems = dataItems.map((item) => {
    return $(`<article>
                <h2>${item.post_title}</h2>
                <p>${item.post_excerpt}</p>
              </article>`)
  })
}, 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-05-29T18:10:30.090

如果您使用如下所示的JQuery ajax 调用函数的short 方法，则需要将返回的数据解释为json 对象，以便您能够循环。

```
$.get('url', function(data, statusText, xheader){
 // your code within the success callback
  var data = $.parseJSON(data);
  $.each(data, function(i){
         console.log(data[i]);
      })
}) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-24T21:45:52.043

`$each`将工作..另一个选项是[数组结果的jQuery Ajax回调](https://stackoverflow.com/questions/13683263/jquery-ajax-callback-for-array-result)

```
function displayResultForLog(result) {
  if (result.hasOwnProperty("d")) {
    result = result.d
  }

  if (result !== undefined && result != null) {
    if (result.hasOwnProperty('length')) {
      if (result.length >= 1) {
        for (i = 0; i < result.length; i++) {
          var sentDate = result[i];
        }
      } else {
        $(requiredTable).append('Length is 0');
      }
    } else {
      $(requiredTable).append('Length is not available.');
    }

  } else {
    $(requiredTable).append('Result is null.');
  }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-29T18:45:36.343

我偏爱用于在数组中查找值的 ES2015 箭头函数

```
const result = data.find(x=> x.TEST1 === '46'); 
```

[在这里](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find)结帐 Array.prototype.find()

# c# - MCI 视频窗口的帮助

> ID：733324
> 
> 赞同：0
> 
> 时间：2009-04-09T08:31:14.087
> 
> 标签：c#

我正在用 c# 编写多媒体播放器，并使用图片框来处理视频窗口。我希望当我双击视频窗口时视频将全屏播放，但我找不到任何方法。谁能帮我？请！（对不起，我的英语不好）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T08:50:57.923

显然没有内置的方法可以做到这一点。

[在这里](http://www.techtalkz.com/c-c-sharp/125478-display-jpg-full-screen-mode.html)尝试一些说明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T16:01:48.930

您可以使用以下 MCI 字符串在已创建的窗口中播放视频：

```
open file.mpg type MPEGVideo Alias XXXX
window XXXX handle 1234
put XXXX destination
play XXXX 
```

视频在窗口中播放后，您可以随意移动和调整窗口大小。我不确定您是否可以实际最大化窗口：如果不能，那么您可以通过调整窗口大小以适应屏幕来模拟这一点。

# c# - 如何导入网络组件

> ID：733332
> 
> 赞同：3
> 
> 时间：2009-04-09T08:35:14.093
> 
> 标签：c#, .net-3.5, import, .net-assembly

我下载了 zlib.NET，我必须导入一个名为“zlib.net.dll”的文件。

我的问题是：如何导入该文件，以便可以在 C# Express 2008 中使用它，例如“System.zlib.etc”？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T08:37:08.113

您需要添加对程序集的引用：

*   将 DLL 复制到某个适当的目录中（我通常`lib`在代码附近的某处创建一个目录）。
*   打开 Visual Studio 并加载解决方案。
*   在解决方案资源管理器中，找到“参考”项并右键单击它。
*   选择“添加参考...”
*   切换到“浏览”选项卡并导航到 DLL

之后，您应该能够在代码中使用它。

# php - 重写规则 Apache, php

> ID：733335
> 
> 赞同：0
> 
> 时间：2009-04-09T08:36:30.503
> 
> 标签：php, apache, rewrite

我希望能够在用户输入[http://example.com/user/user-name](http://example.com/user/user-name)时将用户重定向到[http://example.com/user/user-name](http://example.com/user/user-name)，这会显示用户详细信息

**这是我正在使用的，但它给了我错误**

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^.*$ /user/ [R] 
```

**firefox给出的错误是**

> 重定向循环
> 
> Firefox 检测到服务器正在以永远不会完成的方式重定向对该地址的请求。浏览器已停止尝试检索请求的项目。该站点以永远不会完成的方式重定向请求。
> 
> *   您是否禁用或阻止了本网站要求的 cookie？
> *   注意：如果接受站点的 cookie 不能解决问题，则可能是服务器配置问题，而不是您的计算机。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T08:43:30.157

你确实有一个重定向循环。您正在尝试从`domain.com/user/user-name`到`domain.com/user/user-name`（相同的 URL）。会发生什么：

1.  用户访问`domain.com/user/user-name`。
2.  用户被重定向到`domain.com/user/user-name`（相同的位置）。
3.  用户再次被重定向到`domain.com/user/user-name`（相同的位置）。
4.  用户再次被重定向到`domain.com/user/user-name`（相同的位置）。
5.  重复恶心...

也许您打算重定向`domain.com/user/user-name`到`domain.com/users.php?u=user`或其他什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T09:03:29.003

您正在将*所有*内容重定向到 /user/ ，包括它自己。

编辑：每个请求都经过相同的重写集，并且由于您的 ^.*$ 正则表达式匹配，您将 /user/ 再次重定向到 /user/ 。浏览器只是通过在同一 URL 上尝试几次后停止循环来帮助您。

如果您希望将 /a/foo 重定向到 /b/foo，则需要以下内容：

重写规则 ^/a/(.*)$ /b/$1 [R]

..但是您需要使源和目标不重叠，如您的初始示例中那样，否则您将获得无限重定向循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T09:51:46.593

正如其他人已经说过的，`RewriteRule`匹配任何 URI 路径（包括`/user/`）并因此导致无限循环。

为避免这种情况，您必须排除此 URI 路径：

```
# either
RewriteRule !^/user/$ /user/ [R]
# or
RewriteCond %{REQUEST_URI} !^/user/$
RewriteRule ^ /user/ [R] 
```

这些规则重定向每个不匹配的 URI 路径`^/user/$`to `/user/`。如果要在 .htaccess 文件中使用此规则，则必须删除`RewriteRule`指令模式中的前导斜杠（因此只需`^user/$`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T08:39:32.350

这两个网址不一样吗？

编辑：当我回答时，问题只说明了需要，而不是错误

# sql-server - 使用 SQL 代理运行 SSIS 包时出现问题 - 因“DTSER_FAILURE(1)”而失败

> ID：733338
> 
> 赞同：12
> 
> 时间：2009-04-09T08:37:43.837
> 
> 标签：sql-server, sql-server-2005, ssis, sql-server-agent

我有一个存储在 MSDB 数据库中的 SSIS 包，当我执行它时它工作正常。它将在 SA 帐户下运行或使用 Windows 安全性。

我想安排这个作业与 SQL 代理一起运行，但是当我这样做时，我得到一个奇怪的错误，无论我尝试什么配置，它都会失败并出现以下错误：

**以用户身份执行：SERVER\SYSTEM。返回 DTSER_FAILURE (1)。开始时间：09:25:03 结束时间：09:25:04 经过时间：0.61 秒。包执行失败。步骤失败。**

SSIS 包本身正在向远程服务器读取和写入数据，但我认为它在包执行期间并没有那么远。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T08:44:15.070

您将需要授予运行 SQL 代理 windows 服务的帐户必要的权限。

或者，您可以通过指定代理帐户来运行步骤，在另一个安全上下文中运行各个作业步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T01:53:04.993

看看这个知识库： http: [//support.microsoft.com/kb/918760](http://support.microsoft.com/kb/918760)

特别有用的是关于错误日志的最后一节——关于如何获取更详细的错误信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-07T20:14:59.733

使用大师围棋

sp_configure '允许更新',0 去

使用 override go 重新配置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-07T23:39:53.860

`SQL 2008 R2 DB` 下面提到的错误的类似问题....

检查维护计划，发现子计划未设置为选择需要执行操作的任何特定数据库！我发现其中一个数据库**脱机**。

**狗时刻！**

我还设置了**Ignore Offline Databases**。

我重新运行作业，它成功了。

错误详情如下。

> 以用户身份执行：**********。适用于 64 位的 Microsoft (R) SQL Server 执行包实用程序版本 10.50.4000.0 版权所有 (C) Microsoft Corporation 2010。保留所有权利。开始时间：上午 9:53:00 进度：2012-11-12 09:53:00.82 来源：{108E79C2-F5AA-4698-8DD4-**********} 执行查询“DECLARE @Guid UNIQUEIDENTIFIER EXECUTE msdb..sp...".: 100% 完成结束进度 DTExec: 包执行返回 DTSER_FAILURE (1)。开始时间：上午 9:53:00 结束时间：上午 9:53:01 经过时间：0.734 秒。包执行失败。步骤失败。

# apache-flex - flex air 在安装程序中包含一个目录

> ID：733339
> 
> 赞同：2
> 
> 时间：2009-04-09T08:38:25.427
> 
> 标签：apache-flex, flex3, air

我正在使用 Flex 创建一个 AIR 应用程序。在其中我需要 2 个目录下载和上传。这些目录将下载文件和上传文件。但问题是我无法以编程方式创建这 2 个目录，而且我也无法将这 2 个目录与安装程序一起包含在应用程序目录中。

有什么方法可以在应用程序目录中创建或包含目录。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-09T09:19:18.380

在您的 Flex 项目中创建一个空文件夹。右键单击您的项目并转到 Properties->Compiler（不是确切的名称，而是类似的名称）。确保它具有“将非嵌入式资产复制到输出目录”（如果没有，请检查它）。单击确定。

导出 AIR 应用程序的发布版本。请勿在“签名”步骤后单击完成。按照每个步骤操作，直到进入“资产”屏幕。它将向您显示输出（默认情况下为 bin-debug）目录中的每个文件和文件夹的列表。

检查您想要的文件，取消选中您不想要的文件，然后单击“确定”。完毕。您将 AIR 文件与您想要的任何文件和文件夹打包在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-31T05:40:07.837

使用这个亲爱的:)

```
var dir:File = File.applicationDirectory.resolvePath("NewFolder");

dir =new File(dir.nativePath.toString());
dir.createDirectory(); 
```

问候

阿里·纳奎

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T04:58:23.067

> [...]但我需要在应用程序目录中创建目录。我正在使用： var dir = File.applicationDirectory.resolvePath("upload directory");dir.createDirectory(); 我得到：在运行时::SecurityManager$/checkPrivilegeForCaller()

这是一个已知问题。AIR 不允许您写入应用程序目录。而是尝试写作

*   到 File.applicationStorageDirectory（应用程序的暂存器），
*   或 File.documentsDirectory （用户可能想要查找的东西）

相关资源：

[Adobe AIR 团队博文](http://blogs.adobe.com/simplicity/2008/06/dont_write_to_app_dir.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T12:38:55.037

您是否尝试过类似以下的方法

```
var dir = File.userDirectory.resolvePath("upload directory");
dir.createDirectory(); 
```

如果目录“上传目录”不存在（在用户主目录中），这将创建目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-31T05:25:32.777

要添加到 johncblandii 的 anwser：我发现要使上述内容正常工作，您还需要在项目的构建路径中包含该文件夹。在 flash builder 识别文件夹并将其添加到包含选项之前，我还必须刷新项目的文件列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-21T23:37:32.823

我只想在 johncblandii 的评论中添加另一件事：创建一个 empty.txt 文件并在那里写一些东西。因为它看起来像空文件夹被允许包含在您的打包应用程序中

# asp.net-mvc - 是否可以让 Html.ActionLink 自动添加 URL 参数？

> ID：733342
> 
> 赞同：0
> 
> 时间：2009-04-09T08:40:52.270
> 
> 标签：asp.net-mvc

我想要的是所有 url 都包含某个参数，而不必将其传递给视图并通过 routevalues 参数将其添加到 ActionLink。我的网站中有一个部分，我想跟踪所有链接的“返回参数”。它适用于表单，因为 Html.BeginForm 已经将操作设置为确切的当前 url。

所以，如果我所在的页面是

```
/MyController/MyAction/300?ReturnTo=100 
```

我输出

```
Html.ActionLink("Next Screen", "MyOtherAction") 
```

我倒要看看

```
<a href="/MyController/MyOtherAction/300?ReturnTo=100">Next Screen</a> 
```

无需做

```
Html.ActionLink("Next Screen", "MyOtherAction", new {ReturnTo = Model.ReturnTo}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T08:46:32.600

您可以编写自己的 HtmlHelper 扩展，通过调用 Html.ActionLink 并组合查询字符串来完成此操作。使用 ViewContext 获取当前查询字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-02T18:04:32.030

试试这个：

```
Html.ActionLink("Next Screen", "MyOtherAction", new {Model.ReturnTo}) 
```

该链接现在将以您希望的方式显示。

# jquery - Jquery - POST 请求原来是 GET 请求.. 怎么来的？

> ID：733343
> 
> 赞同：3
> 
> 时间：2009-04-09T08:41:13.003
> 
> 标签：jquery, ajax

我从来没有遇到过这样的问题，我很困惑：

```
function delete_post(id) {
  var answer = confirm("Are you sure you want to delete your post? (this action cannot be undone)")

  if (answer) {
    $.ajax({ 
      method:"post",
      url: "ajax/delete.php",
      data:"id="+id,
      beforeSend: function(){ $('#delete_post').show('slow'); },
      success: function(html) { $("#delete_post").html(html); }
    });
  }
  else {}
  return false;
} 
```

我在服务器端遇到了问题，在使用 firebug 分析输出后，我注意到请求结果是 GET 而不是帖子！我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T08:46:26.873

哦，容易的。该属性是类型而不是方法：

```
$.ajax({ 
  type:"POST",
  url: "ajax/delete.php",
  data:"id="+id,
  beforeSend: function() {
    $('#delete_post').show('slow');
  },
  success: function(html) {
    $("#delete_post").html(html);
  }
}); 
```

**注意：**从[文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)中，方法（类型）是大写的（'GET'，'POST'）。我实际上不知道这是否重要。

# jquery - 如何使用 jQuery 将参数从 URL 传递到 XSL 样式表？

> ID：733345
> 
> 赞同：2
> 
> 时间：2009-04-09T08:41:16.577
> 
> 标签：jquery, xslt

我有这样的事情：

```
$('#output').xslt({xml: 'x',xslUrl: 'Test.xsl'}); 
```

如何将参数传递给 Test.xsl 文件并在 xsl 文件中检索相同的 url？

我正在使用 jquery 库：`jquery.1.1.3.js`和[`jquery.xslt.js`](http://www.jongma.org/webtools/jquery/xslt/)

或者有什么方法可以通过 js 或 jQuery 向我的 xsl 文件发送参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T07:50:40.903

解决方案：使用另一个 jQuery 库，它提供了将参数传递给 XSL 文件的选项：

*   `jquery-1.3.2.min.js`
*   `jquery.transform.js`

代码：

```
$.transform({
  datatype : "xml",
  el       : "#output",
  async    : false, 
  xmlstr   : [ xmlDoc ], 
  xsl      : 'Test.xsl', 
  xslParams: {
    abc: "value",
    pqr: "valu2"
  }
}); 
```

使用`xslParams`我可以传递参数。使用`<xsl:param>`我可以检索我的 XSL 中的参数：

```
<xsl:param name="abc" /> 
```

这`<xsl:param>`必须在您的 XSL 中全局声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:08:42.360

将 URL 添加到您正在使用 XSL 样式表进行转换的 XML 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T09:02:53.653

通过阅读文档，它看起来根本不支持参数/外部输入。

# mysql - 存储过程/函数列表 Mysql 命令行

> ID：733349
> 
> 赞同：505
> 
> 时间：2009-04-09T08:43:36.897
> 
> 标签：mysql, stored-procedures, command-line

如何在 mysql 命令行`show tables;`或`show databases;`命令中查看存储过程或存储函数的列表。

* * *

## 回答 #1

> 赞同：775
> 
> 时间：2009-04-09T08:45:53.647

```
SHOW PROCEDURE STATUS;
SHOW FUNCTION STATUS; 
```

* * *

## 回答 #2

> 赞同：221
> 
> 时间：2009-04-09T08:47:06.233

```
show procedure status 
```

将向您展示存储过程。

```
show create procedure MY_PROC 
```

将向您展示过程的定义。和

```
help show 
```

`show`将显示该命令的所有可用选项。

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2012-09-26T13:45:13.277

对于名称明智的查看过程

```
select name from mysql.proc 
```

下面的代码用于列出所有程序，下面的代码给出与显示程序状态相同的结果

```
select * from mysql.proc 
```

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2012-03-06T18:27:10.187

更具体的方式：

```
SHOW PROCEDURE STATUS 
WHERE Db = DATABASE() AND Type = 'PROCEDURE' 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2011-11-09T09:48:58.687

正如刚才提到的，

```
show procedure status; 
```

确实会显示程序列表，但会在服务器范围内显示*所有程序。*

如果您只想查看单个数据库中的那些，请尝试以下操作：

```
SHOW PROCEDURE STATUS WHERE Db = 'databasename'; 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2013-02-13T16:21:26.513

选择：

```
SELECT * FROM INFORMATION_SCHEMA.ROUTINES 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2016-04-18T17:17:11.547

我的偏好是：

1.  列出函数和过程，
2.  让我知道哪些是哪些，
3.  给出程序的名称和类型**，仅此而已**，
4.  按当前数据库过滤结果，*而不是当前定义者*
5.  对结果进行排序

从这个线程中的其他答案拼接在一起，我最终得到

```
select 
  name, type 
from 
  mysql.proc 
where 
  db = database() 
order by 
  type, name; 
```

...最终您会得到如下所示的结果：

```
mysql> select name, type from mysql.proc where db = database() order by type, name;
+------------------------------+-----------+
| name                         | type      |
+------------------------------+-----------+
| get_oldest_to_scan           | FUNCTION  |
| get_language_prevalence      | PROCEDURE |
| get_top_repos_by_user        | PROCEDURE |
| get_user_language_prevalence | PROCEDURE |
+------------------------------+-----------+
4 rows in set (0.30 sec) 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2017-12-07T05:22:14.400

显示所有存储过程：

```
SHOW PROCEDURE STATUS; 
```

显示所有功能：

```
SHOW FUNCTION STATUS; 
```

显示指定过程的定义：

```
SHOW CREATE PROCEDURE [PROC_NAME]; 
```

显示给定数据库的所有过程：

```
SHOW PROCEDURE STATUS WHERE Db = '[db_name]'; 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2009-04-09T08:48:55.310

用这个：

```
SHOW PROCEDURE STATUS; 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2014-08-27T09:46:06.420

Praveenkumar_V 帖子的变体：

```
SELECT `name` FROM mysql.proc WHERE db = 'dbname' AND `type` = 'PROCEDURE';
SELECT `name` FROM mysql.proc WHERE db = 'dbname' AND `type` = 'FUNCTION'; 
```

..这是因为我需要在做一些家务后节省时间：

```
SELECT CONCAT(
     "GRANT EXECUTE ON PROCEDURE `"
    ,`name`
    ,"` TO username@'%'; -- "
    ,`comment`
)
FROM mysql.proc
WHERE db = 'dbname'
AND `type` = 'PROCEDURE';

SELECT CONCAT(
     "GRANT EXECUTE ON FUNCTION `"
    ,`name`
    ,"` TO username@'%'; -- "
    ,`comment`
)
FROM mysql.proc
WHERE db = 'dbname'
AND `type` = 'FUNCTION'; 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2015-01-06T14:08:15.097

```
SELECT specific_name FROM `information_schema`.`ROUTINES` WHERE routine_schema='database_name' 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2012-12-27T05:40:00.573

只显示你的：

```
SELECT
  db, type, specific_name, param_list, returns
FROM
  mysql.proc
WHERE
  definer LIKE
  CONCAT('%', CONCAT((SUBSTRING_INDEX((SELECT user()), '@', 1)), '%')); 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2017-10-12T06:59:29.713

如果要列出当前选定数据库的存储过程，

```
SHOW PROCEDURE STATUS WHERE Db = DATABASE(); 
```

它将根据当前选定的数据库列出例程

**更新** 列出数据库中的函数

```
select * from information_schema.ROUTINES where ROUTINE_SCHEMA="YOUR DATABASE NAME" and ROUTINE_TYPE="FUNCTION"; 
```

列出数据库中的例程/存储过程，

```
select * from information_schema.ROUTINES where ROUTINE_SCHEMA="YOUR DATABASE NAME" and ROUTINE_TYPE="PROCEDURE"; 
```

列出数据库中的表，

```
select * from information_schema.TABLES WHERE TABLE_TYPE="BASE TABLE" AND TABLE_SCHEMA="YOUR DATABASE NAME"; 
```

列出数据库中的视图，

**方法一：**

```
select * from information_schema.TABLES WHERE TABLE_TYPE="VIEW" AND TABLE_SCHEMA="YOUR DATABASE NAME"; 
```

**方法二：**

```
select * from information_schema.VIEWS WHERE TABLE_SCHEMA="YOUR DATABASE NAME"; 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2020-09-07T18:50:14.390

从 MySQL 8.0 开始，该`mysql.procs`表已被删除。从此处的答案中运行任何使用此表的命令都会产生一个错误，上面写着（非常合乎逻辑）：

```
Table 'mysql.proc' doesn't exist 
```

相反，要检索仅包含过程/函数名称的列表，请使用：

```
SELECT specific_name FROM `information_schema`.`ROUTINES` WHERE routine_schema='<your_db_name>'; 
```

就我而言，我对其进行了编辑以仅显示程序而不显示功能：

```
SELECT specific_name FROM `information_schema`.`ROUTINES` WHERE routine_schema='<your_db_name>' AND routine_type='PROCEDURE'; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-03-11T12:43:43.403

我最喜欢的当前数据库程序列表的渲染：名称、参数列表、注释

```
SELECT specific_name AS name, param_list AS params, `comment`
FROM mysql.proc
WHERE db = DATABASE()
AND type = 'PROCEDURE'; 
```

为函数添加返回：

```
SELECT specific_name AS name, param_list AS params, `returns`, `comment`
FROM mysql.proc
WHERE db = DATABASE()
AND type = 'FUNCTION'; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-07-22T07:26:41.643

```
 show procedure status; 
```

使用此命令，您可以查看数据库中的所有过程

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-07T18:20:20.270

列出**所有数据库****的用户**程序和函数：

 **```
SELECT 
    `ROUTINE_SCHEMA` AS `database`
    ,`ROUTINE_TYPE` AS `type`
    ,`SPECIFIC_NAME` AS `name`
    ,`DTD_IDENTIFIER` AS `data_type`
FROM 
    `INFORMATION_SCHEMA`.`ROUTINES`
WHERE
  `definer` LIKE
  CONCAT('%', CONCAT((SUBSTRING_INDEX((SELECT user()), '@', 1)), '%'))
ORDER BY
    `database`
    ,`type`
    ,`name`
; 
```

列出**正在使用的数据库的****用户**程序和函数：

 **```
SELECT 
    `ROUTINE_SCHEMA` AS `database`
    ,`ROUTINE_TYPE` AS `type`
    ,`SPECIFIC_NAME` AS `name`
    ,`DTD_IDENTIFIER` AS `data_type`
FROM 
    `INFORMATION_SCHEMA`.`ROUTINES`
WHERE
  `definer` LIKE
  CONCAT('%', CONCAT((SUBSTRING_INDEX((SELECT user()), '@', 1)), '%'))
AND
   `ROUTINE_SCHEMA` = DATABASE()
ORDER BY
    `type`
    ,`name`
; 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2015-06-11T07:31:19.177

对所有过程使用以下查询：

```
select * from sysobjects 
where type='p'
order by crdate desc 
```

# svn - AnkhSVN 忽略模式

> ID：733355
> 
> 赞同：5
> 
> 时间：2009-04-09T08:45:24.460
> 
> 标签：svn, ankhsvn, svnignore

AnkhSVN 如何将非版本控制文件排除在 SVN 之外？我检查了全局忽略模式和 svn:ignore 属性，但没有发现任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T10:12:11.507

Visual Studio 项目实现提供了应作为其 SCC 支持的一部分添加到源代码管理的文件列表。AnkhSVN 2.0 捕获此列表（并注册到几个事件以接收更改），因此它不使用特定模式。

实现模式将使 AnkhSVN 项目类型特定，而 Visual Studio SDK 允许每个人创建自己的项目类型。我们曾经在 0.X/1.X 中添加 AnkhSVN 时有智能模式，但作为 SCC VAPI 实现我们不必再猜测了。

当 AnkhSVN 有这个列表时，它会检查未添加文件的颠覆忽略状态（全局忽略模式和目录上的 svn:ignore），并建议未忽略的文件为“新”（又名应该添加）。

# c++ - 为什么我们在 C++ 中没有虚拟构造函数？

> ID：733360
> 
> 赞同：280
> 
> 时间：2009-04-09T08:46:31.337
> 
> 标签：c++, constructor, virtual-functions

为什么 C++ 没有虚拟构造函数？

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-04-09T08:54:11.723

从马的嘴里听出来。:)

来自 Bjarne Stroustrup 的 C++ 风格和技术常见问题解答[为什么我们没有虚拟构造函数？](http://www.stroustrup.com/bs_faq2.html#virtual-ctor)

> 虚拟调用是一种在给定部分信息的情况下完成工作的机制。特别是，“虚拟”允许我们调用只知道任何接口而不知道对象的确切类型的函数。要创建一个对象，您需要完整的信息。特别是，您需要知道要创建的确切类型。因此，“对构造函数的调用”不能是虚拟的。

FAQ 条目继续提供代码，用于在没有虚拟构造函数的情况下实现此目的。

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2009-04-09T08:51:52.523

虚函数基本上提供多态行为。也就是说，当您使用动态类型与引用它的静态（编译时）类型不同的对象时，它会提供适合对象*实际*类型而不是对象静态类型的行为。

现在尝试将这种行为应用于构造函数。构造对象时，静态类型始终与实际对象类型相同，因为：

> 要构造一个对象，构造函数需要它要创建的对象的确切类型[...]此外[...]你不能有一个指向构造函数的指针

（Bjarne Stroustup（P424 C++ 编程语言 SE））

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2009-04-09T09:08:19.473

与 Smalltalk 或 Python 等面向对象的语言不同，其中构造函数是表示类的对象的虚拟方法（这意味着您不需要 GoF[抽象工厂模式](http://c2.com/cgi/wiki?AbstractFactoryPattern)，因为您可以传递表示类的对象而不是制作您自己的），C++ 是一种基于类的语言，并且没有代表任何语言结构的对象。该类在运行时不作为对象存在，因此您不能在其上调用虚拟方法。

这符合“不用为不用的东西付费”的理念，尽管我见过的每个大型 C++ 项目最终都实现了某种形式的抽象工厂或反射。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-04-09T21:20:26.257

我能想到的两个原因：

技术原因

对象只有在构造函数结束后才存在。为了使用虚拟表调度构造函数，必须存在一个带有指向该虚拟表的指针的现有对象，但如果该对象存在指向该虚拟表的指针怎么办？还不存在？:)

逻辑原因

当您想要声明某种多态行为时，您可以使用 virtual 关键字。但是构造函数没有任何多态性，C++ 中构造函数的工作就是简单地将对象数据放在内存中。由于虚拟表（以及一般的多态性）都是关于多态行为而不是多态数据，因此声明虚拟构造函数没有任何意义。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-09-24T06:19:11.650

***总结***：C++ 标准*可以*为“虚拟构造函数”指定一个符号和行为，它相当直观，编译器支持也不太难，但是当*功能*已经可以使用`create()`/`clone()`（参见以下）？它不像许多其他正在酝酿中的语言提案那样有用。

## 讨论

让我们假设一个“虚拟构造函数”机制：

```
Base* p = new Derived(...);
Base* p2 = new p->Base();  // possible syntax??? 
```

上面第一行构造了一个`Derived`对象，所以`*p`'s virtual dispatch table 可以合理地提供一个“虚拟构造函数”供第二行使用。（此页面上的数十个答案指出*“该对象尚不存在，因此不可能进行虚拟构造”，*这些答案不必要地短视了要构造的对象。）

第二行假设符号`new p->Base()`来请求动态分配和另一个`Derived`对象的默认构造。

笔记：

*   ***编译器必须在调用构造函数之前协调内存分配***- 构造函数通常支持*自动*（非正式“堆栈”）分配、*静态*（用于全局/命名空间范围和类/函数`static`对象）和*动态*（非正式“堆”）何时`new`使用

    *   `p->Base()`在编译时通常无法知道要构造的对象的大小，因此***动态分配是唯一有意义的方法***

        *   可以在堆栈上分配运行时指定的内存量 - 例如[GCC 的可变长度数组扩展](https://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html)-`alloca()`但会导致显着的低效率和复杂性（例如，分别为[此处](https://stackoverflow.com/a/21519062/410767)和[此处](https://stackoverflow.com/questions/1018853/why-is-the-use-of-alloca-not-considered-good-practice)）
*   对于动态分配，它*必须*返回一个指针，以便`delete`稍后可以存储内存。

*   假定的表示法明确列出`new`以强调动态分配和指针结果类型。

编译器需要：

*   `Derived`通过调用隐式`virtual` `sizeof`函数或通过 RTTI 获取此类信息，找出需要多少内存
*   调用`operator new(size_t)`分配内存
*   `Derived()`使用位置调用`new`。

或者

*   为结合动态分配和构造的函数创建额外的 vtable 条目

所以 - 指定和实现虚拟构造函数似乎不是不可克服的，但百万美元的问题是：它如何比使用现有 C++ 语言特性更好......？就个人而言，***我认为下面的解决方案没有任何好处。***

* * *

## `clone()` 和 `create()`

C++ FAQ 记录了一个“[虚拟构造函数”习语](https://isocpp.org/wiki/faq/virtual-functions#virtual-ctors)，包含默认构造或复制构造一个新的动态分配对象的方法`virtual` `create()`：`clone()`

```
class Shape {
  public:
    virtual ~Shape() { } // A virtual destructor
    virtual void draw() = 0; // A pure virtual function
    virtual void move() = 0;
    // ...
    virtual Shape* clone() const = 0; // Uses the copy constructor
    virtual Shape* create() const = 0; // Uses the default constructor
};
class Circle : public Shape {
  public:
    Circle* clone() const; // Covariant Return Types; see below
    Circle* create() const; // Covariant Return Types; see below
    // ...
};
Circle* Circle::clone() const { return new Circle(*this); }
Circle* Circle::create() const { return new Circle(); } 
```

也可以更改或重载`create()`以接受参数，但要匹配基类/接口的`virtual`函数签名，覆盖的参数必须与基类重载之一完全匹配。有了这些明确的用户提供的设施，添加日志记录、检测、更改内存分配等很容易。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-11-23T17:26:58.200

撇开语义原因不谈，直到对象被构造之后才存在 vtable，因此虚拟指定毫无用处。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2009-04-09T08:51:07.767

我们这样做，它只是不是构造函数:-)

```
struct A {
  virtual ~A() {}
  virtual A * Clone() { return new A; }
};

struct B : public A {
  virtual A * Clone() { return new B; }
};

int main() {

   A * a1 = new B;
   A * a2 = a1->Clone();    // virtual construction
   delete a2;
   delete a1;
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-07-21T17:55:01.407

C++ 中的虚函数是运行时多态性的一种实现，它们会进行函数覆盖。通常，`virtual`当您需要动态行为时，在 C++ 中使用关键字。它仅在对象存在时才起作用。而构造函数用于创建对象。构造函数将在对象创建时被调用。

因此，如果您将构造函数创建为`virtual`，根据 virtual 关键字定义，它应该有可用的对象，但构造函数用于创建对象，因此这种情况永远不会存在。所以你不应该将构造函数用作虚拟的。

因此，如果我们尝试声明虚拟构造函数，编译器会抛出错误：

> 构造函数不能被声明为虚拟的

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-05-04T07:34:06.220

您可以在@stefan 的回答中找到一个示例以及为什么不允许这样做的技术原因。根据我的说法，现在对这个问题的合乎逻辑的答案是：

virtual 关键字的主要用途是在我们不知道基类指针将指向什么类型的对象时启用多态行为。

但是想想这是更原始的方式，为了使用虚拟功能，你需要一个指针。指针需要什么？一个指向的对象！（考虑正确执行程序的情况）

所以，我们基本上需要一个已经存在于内存某处的对象（我们不关心内存是如何分配的，它可能是在编译时或运行时），以便我们的指针可以正确指向该对象。

现在，考虑一下当要指向的类的对象被分配一些内存的那一刻的情况 -> 它的构造函数将在该实例本身被自动调用！

所以我们可以看到我们实际上不需要担心构造函数是虚拟的，因为在任何情况下，您希望使用多态行为，我们的构造函数将已经执行，使我们的对象准备好使用！

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-11-27T14:45:34.983

使用虚函数是为了根据指针指向的对象类型调用函数，而不是指针本身的类型。但是没有“调用”构造函数。它仅在声明对象时调用一次。因此，构造函数不能在 C++ 中变为虚拟的。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-04-09T08:57:10.703

当人们问这样的问题时，我喜欢想自己“如果这真的可能会发生什么？” 我真的不知道这意味着什么，但我想这与能够基于正在创建的对象的动态类型覆盖构造函数实现有关。

我看到了一些潜在的问题。一方面，在调用虚拟构造函数时，派生类不会完全构建，因此实现存在潜在问题。

其次，在多重继承的情况下会发生什么？您的虚拟构造函数可能会被多次调用，然后您需要通过某种方式知道正在调用哪个构造函数。

第三，一般来说，在构造时，对象并没有完全构造虚拟表，这意味着需要对语言规范进行较大的更改以允许在构造时知道对象的动态类型这一事实时间。然后，这将允许基类构造函数在构造时调用其他虚函数，并使用未完全构造的动态类类型。

最后，正如其他人指出的那样，您可以使用静态“create”或“init”类型的函数来实现一种虚拟构造函数，这些函数基本上与虚拟构造函数做同样的事情。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2011-10-17T09:43:14.827

尽管由于对象类型是创建对象的先决条件，因此虚拟构造函数的概念不太适合，但它并没有完全被否决。

GOF 的“工厂方法”设计模式利用了虚拟构造函数的“概念”，这在某些设计情况下很方便。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-04-21T11:05:48.410

面试答案是：虚拟ptr和表与对象相关，但与类无关。因此构造函数构建虚拟表，因此我们不能有虚拟构造函数，因为在创建对象之前没有Vtable。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-04-09T08:51:05.817

您也不应该在构造函数中调用虚函数。见：[http ://www.artima.com/cppsource/nevercall.html](http://www.artima.com/cppsource/nevercall.html)

此外，我不确定您是否真的需要一个虚拟构造函数。没有它你可以实现多态构造：你可以编写一个函数来根据需要的参数构造你的对象。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2016-09-21T17:34:42.697

为每个具有一个或多个“虚拟功能”的类制作一个虚拟表（vtable）。每当创建此类类的对象时，它都包含一个“虚拟指针”，该指针指向相应 vtable 的基础。每当有虚函数调用时，vtable 用于解析到函数地址。构造函数不能是虚拟的，因为当一个类的构造函数被执行时，内存中没有vtable，意味着还没有定义虚拟指针。因此，构造函数应该始终是非虚拟的。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-11-18T13:06:25.710

我们不能简单地说......我们不能继承构造函数。所以没有必要将它们声明为虚拟，因为虚拟提供了多态性。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-06-23T11:47:36.557

C++ 虚拟构造函数是不可能的。例如，您不能将构造函数标记为虚拟。试试这个代码

```
#include<iostream.h>
using namespace std;
class aClass
{
    public:
        virtual aClass()
        {   
        }  
};
int main()
{
    aClass a; 
} 
```

它会导致错误。此代码试图将构造函数声明为虚拟的。现在让我们试着理解为什么我们使用 virtual 关键字。虚拟关键字用于提供运行时多态性。例如试试这个代码。

```
#include<iostream.h>
using namespace std;
class aClass
{
    public:
        aClass()
        {
            cout<<"aClass contructor\n";
        }
        ~aClass()
        {
            cout<<"aClass destructor\n";
        }

};
class anotherClass:public aClass
{

    public:
        anotherClass()
        {
            cout<<"anotherClass Constructor\n";
        }
        ~anotherClass()
        {
            cout<<"anotherClass destructor\n";
        }

};
int main()
{
    aClass* a;
    a=new anotherClass;
    delete a;   
    getchar(); 
} 
```

In main为声明为 . 类型的指针`a=new anotherClass;`分配内存。这会导致构造函数（In和）都自动调用。因此我们不需要将构造函数标记为虚拟。因为创建对象时，它必须遵循创建（即首先是基类，然后是派生类）。但是当我们尝试删除一个时，它会导致只调用基本的析构函数。所以我们必须使用 virtual 关键字来处理析构函数。**所以虚拟构造函数是不可能的，但虚拟析构函数是。**谢谢`anotherClass``a``aClass``aClass``anotherClass``delete a;`

 *** * *

## 回答 #18

> 赞同：2
> 
> 时间：2010-04-14T18:33:10.123

虚拟机制仅在您具有指向派生类对象的基类指针时才起作用。构造函数对于基类构造函数的调用有自己的规则，基本上是基类到派生。虚拟构造函数如何有用或被调用？我不知道其他语言做什么，但我看不出虚拟构造函数如何有用甚至实现。为了使虚拟机制有意义，必须进行构造，并且还需要进行构造以创建提供多态行为机制的 vtable 结构。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2015-07-23T21:55:36.397

有一个非常基本的原因：构造函数实际上是静态函数，而在 C++ 中，没有静态函数可以是虚拟的。

如果你对 C++ 有丰富的经验，你就会知道静态函数和成员函数之间的区别。静态函数与 CLASS 相关联，而不是对象（实例），因此它们看不到“this”指针。只有成员函数可以是虚拟的，因为 vtable（使“虚拟”工作的函数指针的隐藏表）实际上是每个对象的数据成员。

现在，构造函数的工作是什么？它的名字是——一个“T”构造函数在分配 T 对象时初始化它们。这会自动排除它成为成员函数！一个对象必须在它有一个“this”指针和一个 vtable 之前存在。这意味着即使该语言将构造函数视为普通函数（由于相关原因我不会讨论），它们也必须是静态成员函数。

了解这一点的一个好方法是查看“工厂”模式，尤其是工厂函数。他们做你想做的事，你会注意到如果类 T 有一个工厂方法，它总是静态的。它一定要是。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-06-10T12:12:14.763

“构造函数不能是虚拟的”

*   有一些正当的理由证明这种说法是正确的。

1.  要创建对象，**对象类的构造函数必须与类的类型相同**。但是，这对于虚拟实现的构造函数是不可能的。
2.  在调用构造函数时，**不会创建[虚拟表](https://www.learncpp.com/cpp-tutorial/the-virtual-table/)**来解析任何虚拟函数调用。因此，虚拟构造函数本身将无处可查。

* * *

因此，不可能将构造函数声明为虚拟的。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-07-27T08:44:28.203

1.  当一个构造函数被调用时，虽然到那时还没有创建对象，但我们仍然知道将要创建的对象的种类，因为该对象所属的类的**特定构造函数已经被调用了。**

    `Virtual`与函数关联的关键字意味着将**调用特定对象类型的函数**。

    所以，我的想法是没有必要创建虚拟构造函数，因为已经调用了将要创建其对象的所需构造函数，并且使构造函数虚拟只是一件多余的事情，因为已经调用了**特定于对象的构造函数**这与调用通过 virtual 关键字实现**的特定于类的函数相同。**

    **尽管出于 vptr 和 vtable 相关的原因，内部实现不允许使用虚拟构造函数。**

2.  另一个原因是 C++ 是一种静态类型语言，我们需要在编译时知道变量的类型。

    编译器必须知道创建对象的类类型。要创建的对象类型是编译时决定的。

    如果我们将构造函数设为虚拟，则意味着我们不需要在编译时知道对象的类型（这就是虚函数提供的。我们不需要知道实际的对象，只需要指向的基指针指向一个实际对象调用被指向对象的虚函数而不知道对象的类型）如果我们在编译时不知道对象的类型，那么它与静态类型语言相反。因此，无法实现运行时多态性。

    因此，在编译时不知道对象类型的情况下不会调用 Constructor。所以制作虚拟构造函数的想法失败了。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-12-11T14:15:15.883

如果您从逻辑上思考构造函数的工作原理以及虚函数在 C++ 中的含义/用法，那么您将意识到虚构造函数在 C++ 中毫无意义。在 C++ 中声明一些虚拟的东西意味着它可以被当前类的子类覆盖，但是在创建对象时调用构造函数，那时你不能创建该类的子类，你必须是创建类，因此永远不需要声明一个虚拟构造函数。

另一个原因是，构造函数与其类名相同，如果我们将构造函数声明为虚拟，那么它应该在其派生类中以相同的名称重新定义，但是两个类不能具有相同的名称。所以不可能有一个虚拟构造函数。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-09-24T01:54:29.400

Vpointer 在对象创建时创建。vpointer 在对象创建之前不会存在。所以没有必要将构造函数设为虚拟。

# sql-server - SQL Server - 获取所有连接的服务器名称

> ID：733362
> 
> 赞同：2
> 
> 时间：2009-04-09T08:46:47.543
> 
> 标签：sql-server, sql-server-2005

在 SQL Server 2000/2005 中，我想获取所有连接服务器的名称。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T08:56:46.303

执行 sp_helpserver

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:05:58.497

除了 sp_helpserver，您还可以从 sys.servers 获得其他信息。

```
SELECT * FROM sys.servers 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T10:47:11.437

如果您想搜索整个网络以检索拓扑中所有 SQL Server 实例的综合信息，您可以使用免费提供的 Quest Discovery Wizard。

[SQL Server 的 Quest 发现向导](http://www.quest.com/discovery-wizard-for-sql-server/)

# ms-access - 如何在 vba 中将字段与“备忘录”数据类型进行比较？

> ID：733365
> 
> 赞同：1
> 
> 时间：2009-04-09T08:47:21.677
> 
> 标签：ms-access, vba, ms-office

MS access 数据库不允许在 SQL 查询中将字段与“备忘录”数据类型进行比较。有没有办法在 VBA 中做到这一点？

如果备忘录大小>255 个字符，则简单比较不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T09:26:10.850

使用记录集时，您可以比较它们。

表格：Table1(int, memo, memo)

> ```
> id   memo1     memo2
> 1    A         B
> 2    D         C 
> ```

剧本 ：

```
Public Sub test()

Dim conn As New ADODB.Connection
Dim rst As New ADODB.Recordset
Dim strSql As String

Set conn = CurrentProject.Connection
strSql = "select * from Table1"

rst.Open strSql, conn

rst.MoveFirst
    While Not rst.EOF
        Debug.Print rst("memo1") > rst("memo2")
    rst.MoveNext
Wend

rst.Close
conn.Close

End Sub 
```

和输出：

```
False
True 
```

你是这个意思吗？

更新：它对我来说工作正常，长度为 4000 个字符的字段，刚刚测试过，长度函数也工作正常（vba from access 2003）

问候，彼得

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T09:43:30.170

您可能有一些具体的想法，但这个简单的案例可以正常工作，没有错误：

```
 CREATE TABLE TestMemo (memo1 MEMO, memo2 MEMO)
    ;
    INSERT INTO TestMemo (memo1, memo2) VALUES ('Blah', 'Blah')
    ;

INSERT INTO TestMemo (memo1, memo2) VALUES ('123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A', '123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789A123456789Z')
;

    SELECT memo1, memo2 
      FROM TestMemo
     WHERE memo1 = memo2
    ; 
```

我知道这会截断 255 个字符。这是你的问题吗？- 编辑：我已经用超过 255 个字符的值对其进行了测试，并且它没有被截断。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T18:35:25.200

我想最好的方法是将两个备忘录字段保存到 2 个文件中，然后与文件进行比较。

# asp.net - 如何使用 Google Checkout 处理运费和增值税？

> ID：733372
> 
> 赞同：0
> 
> 时间：2009-04-09T08:48:34.203
> 
> 标签：asp.net, google-checkout

我需要使用 asp.net c# 实现 google checkout，我能够在我的购物车中获取商品，并在 google checkout 中填充，但无法继续处理运费和增值税以及之后要做什么，即跟踪订单和重定向到我的网站，这样我就可以添加客户的订单。如果可能的话，请向我提供完整的实施示例，我将非常感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-10T17:24:19.613

谷歌提供了示例代码，它应该有效地提供一个集成示例：

[.Net 示例代码](http://code.google.com/p/google-checkout-dotnet-sample-code/)

和

[Google Checkout XML API 开发人员指南](http://code.google.com/apis/checkout/developer/Google_Checkout_XML_API.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-10T00:30:34.440

对于 .NET 集成问题，我还推荐 Checkout Developer 论坛：

[http://www.google.com/support/forum/p/checkout-merchants/label?lid=254e6cb63ecd682f&hl=en](http://www.google.com/support/forum/p/checkout-merchants/label?lid=254e6cb63ecd682f&hl=en)

# c# - 找出哪个 System.Diagnostics.Process 已完成

> ID：733376
> 
> 赞同：2
> 
> 时间：2009-04-09T08:49:34.933
> 
> 标签：c#, .net, process

我正在使用 System.Diagnostics.Process 在我的 C# 应用程序中生成新进程，如下所示：

```
void SpawnNewProcess
{
    string fileName = GetFileName();
    System.Diagnostics.Process proc = new System.Diagnostics.Process();
    proc.StartInfo.FileName = fileName;
    proc.Start();
    proc.Exited += new EventHandler(ProcessExited);
    proc.EnableRaisingEvents = true;
}          

private void ProcessExited(Object source, EventArgs e)
{ 

} 
```

用户可以随意生成任意数量的进程 - 现在的问题是：我在 ProcessExited 函数中，我如何找出哪些进程已经退出？

[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)中的示例仅显示了如何为此使用成员变量 - 但这不适用于更多进程。

任何想法如何找出刚刚退出的进程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T08:54:29.977

您将在事件处理程序中获得`Process`对象`source`。`source.Id`将有进程的PID。如果您需要更多信息，可以将 PID 和相关属性的查找表作为成员变量保存。

请注意，您必须先转换`source`为 a`Process`才能访问其成员。例如：

```
private void ProcessExited(Object source, EventArgs e)
{ 
    var proc = (Process)source;
    Console.WriteLine(proc.Id.ToString());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T08:53:35.453

该`source`参数可能是退出的进程。你必须投它。

# java - Lucene Javadoc 包

> ID：733377
> 
> 赞同：0
> 
> 时间：2009-04-09T08:49:48.987
> 
> 标签：java, lucene, packages, javadoc

Lucene 是否已将 jar 与 javadoc 分开？contrib 部分中的所有内容都分离了 javadoc jar，但在我看来核心没有。我对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T19:30:33.353

不，它没有用于核心 javadocs 的 jar。但是，您可以通过在 lucene-core-*.jar 的“/docs/api/core”文件夹上运行 JDK 中的“jar”实用程序来轻松实现。

# c# - 在 .NET 中进行字符串模板化的好方法是什么？

> ID：733378
> 
> 赞同：66
> 
> 时间：2009-04-09T08:49:56.883
> 
> 标签：c#, .net, string, templating

我需要向用户发送电子邮件通知，并且我需要允许管理员为消息正文（可能还有标题）提供模板。

我想要这样的东西`string.Format`允许我给出命名的替换字符串，所以模板看起来像这样：

```
Dear {User},

Your job finished at {FinishTime} and your file is available for download at {FileURL}.

Regards,

-- 
{Signature} 
```

对我来说最简单的方法是什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2015-06-26T09:06:29.163

Here is the version for those of you who can use a new version of C#:

```
// add $ at start to mark string as template
var template = $"Your job finished at {FinishTime} and your file is available for download at {FileURL}." 
```

In a line - this is now a fully supported language feature (string interpolation).

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-09T08:52:54.503

使用模板引擎。[StringTemplate](http://www.stringtemplate.org/)就是其中之一，而且还有很多。

例子：

```
using Antlr.StringTemplate;
using Antlr.StringTemplate.Language;

StringTemplate hello = new StringTemplate("Hello, $name$", typeof(DefaultTemplateLexer));
hello.SetAttribute("name", "World");
Console.Out.WriteLine(hello.ToString()); 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-04-09T09:40:16.713

You can use the "string.Format" method:

```
var user = GetUser();
var finishTime = GetFinishTime();
var fileUrl = GetFileUrl();
var signature = GetSignature();
string msg =
@"Dear {0},

Your job finished at {1} and your file is available for download at {2}.

Regards,

--
{3}";
msg = string.Format(msg, user, finishTime, fileUrl, signature); 
```

It allows you to change the content in the future and is friendly for localization.

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-11-06T09:37:29.323

I wrote a pretty simple library, [SmartFormat](https://github.com/scottrippey/SmartFormat/wiki) which meets all your requirements. It is focused on composing "natural language" text, and is great for generating data from lists, or applying conditional logic.

The syntax is extremely similar to `String.Format`, and is very simple and easy to learn and use. Here's an example of the syntax from the documentation:

```
Smart.Format("{Name}'s friends: {Friends:{Name}|, |, and}", user)
// Result: "Scott's friends: Michael, Jim, Pam, and Dwight" 
```

The library has great error-handling options (ignore errors, output errors, throw errors). Obviously, this would work perfect for your example.

The library is open source and easily extensible, so you can also enhance it with additional features too.

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-02-17T13:24:51.633

Building on Benjamin Gruenbaum's answer, in C# version 6 you can add a @ with the $ and pretty much use your code as it is, e.g.:

```
var text = $@"Dear {User},

Your job finished at {FinishTime} and your file is available for download at {FileURL}.

Regards,

-- 
{Signature}
"; 
```

The `$` is for string interpolation: [https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/interpolated](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/interpolated)

The `@` is the verbatim identifier: [https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/verbatim](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/verbatim)

...and you can use these in conjunction.

:o)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-04-09T09:28:42.123

You could use string.Replace(...), eventually in a for-each through all the keywords. If there are only a few keywords you can have them on a line like this:

```
string myString = template.Replace("FirstName", "John").Replace("LastName", "Smith").Replace("FinishTime", DateTime.Now.ToShortDateString()); 
```

Or you could use Regex.Replace(...), if you need something a bit more powerful and with more options.

Read this [article on codeproject](http://www.codeproject.com/KB/string/fastestcscaseinsstringrep.aspx?display=Print) to view which string replacement option is fastest for you.

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-01-08T14:43:42.743

A very simple regex-based solution. Supports `\n`-style single character escape sequences and `{Name}`-style named variables.

### Source

```
class Template
{
    /// <summary>Map of replacements for characters prefixed with a backward slash</summary>
    private static readonly Dictionary<char, string> EscapeChars
        = new Dictionary<char, string>
        {
            ['r'] = "\r",
            ['n'] = "\n",
            ['\\'] = "\\",
            ['{'] = "{",
        };

    /// <summary>Pre-compiled regular expression used during the rendering process</summary>
    private static readonly Regex RenderExpr = new Regex(@"\\.|{([a-z0-9_.\-]+)}",
        RegexOptions.IgnoreCase | RegexOptions.Compiled);

    /// <summary>Template string associated with the instance</summary>
    public string TemplateString { get; }

    /// <summary>Create a new instance with the specified template string</summary>
    /// <param name="TemplateString">Template string associated with the instance</param>
    public Template(string TemplateString)
    {
        if (TemplateString == null) {
            throw new ArgumentNullException(nameof(TemplateString));
        }

        this.TemplateString = TemplateString;
    }

    /// <summary>Render the template using the supplied variable values</summary>
    /// <param name="Variables">Variables that can be substituted in the template string</param>
    /// <returns>The rendered template string</returns>
    public string Render(Dictionary<string, object> Variables)
    {
        return Render(this.TemplateString, Variables);
    }

    /// <summary>Render the supplied template string using the supplied variable values</summary>
    /// <param name="TemplateString">The template string to render</param>
    /// <param name="Variables">Variables that can be substituted in the template string</param>
    /// <returns>The rendered template string</returns>
    public static string Render(string TemplateString, Dictionary<string, object> Variables)
    {
        if (TemplateString == null) {
            throw new ArgumentNullException(nameof(TemplateString));
        }

        return RenderExpr.Replace(TemplateString, Match => {
            switch (Match.Value[0]) {
                case '\\':
                    if (EscapeChars.ContainsKey(Match.Value[1])) {
                        return EscapeChars[Match.Value[1]];
                    }
                    break;

                case '{':
                    if (Variables.ContainsKey(Match.Groups[1].Value)) {
                        return Variables[Match.Groups[1].Value].ToString();
                    }
                    break;
            }

            return string.Empty;
        });
    }
} 
```

### Usage

```
var tplStr1 = @"Hello {Name},\nNice to meet you!";
var tplStr2 = @"This {Type} \{contains} \\ some things \\n that shouldn't be rendered";
var variableValues = new Dictionary<string, object>
{
    ["Name"] = "Bob",
    ["Type"] = "string",
};

Console.Write(Template.Render(tplStr1, variableValues));
// Hello Bob,
// Nice to meet you!

var template = new Template(tplStr2);
Console.Write(template.Render(variableValues));
// This string {contains} \ some things \n that shouldn't be rendered 
```

### Notes

*   I've only defined `\n`, `\r`, `\\` and `\{` escape sequences and hard-coded them. You could easily add more or make them definable by the consumer.
*   I've made variable names case-insensitive, as things like this are often presented to end-users/non-programmers and I don't personally think that case-sensitivity make sense in that use-case - it's just one more thing they can get wrong and phone you up to complain about (plus in general if you think you need case sensitive symbol names what you really need are better symbol names). To make them case-sensitive, simply remove the `RegexOptions.IgnoreCase` flag.
*   I strip invalid variable names and escape sequences from the result string. To leave them intact, return `Match.Value` instead of the empty string at the end of the `Regex.Replace` callback. You could also throw an exception.
*   I've used `{var}` syntax, but this may interfere with the native interpolated string syntax. If you want to define templates in string literals in you code, it might be advisable to change the variable delimiters to e.g. `%var%` (regex `\\.|%([a-z0-9_.\-]+)%`) or some other syntax of your choosing which is more appropriate to the use case.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-09T09:43:08.377

Actually, you can use XSLT. You create a simple XML template:

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
  <xsl:template match="TETT">
    <p>
       Dear <xsl:variable name="USERNAME" select="XML_PATH" />,

       Your job finished at <xsl:variable name="FINISH_TIME" select="XML_PATH" /> and your file is available for download at <xsl:variable name="FILE_URL" select="XML_PATH" />.

       Regards,
        -- 
       <xsl:variable name="SIGNATURE" select="XML_PATH" />
    </p>
</xsl:template> 
```

Then create a XmlDocument to perform transformation against: XmlDocument xmlDoc = new XmlDocument();

```
 XmlNode xmlNode = xmlDoc .CreateNode(XmlNodeType.Element, "EMAIL", null);
        XmlElement xmlElement= xmlDoc.CreateElement("USERNAME");
        xmlElement.InnerXml = username;
        xmlNode .AppendChild(xmlElement); ///repeat the same thing for all the required fields

        xmlDoc.AppendChild(xmlNode); 
```

After that, apply the transformation:

```
 XPathNavigator xPathNavigator = xmlDocument.DocumentElement.CreateNavigator();
        StringBuilder sb = new StringBuilder();
        StringWriter sw = new StringWriter(sb);
        XmlTextWriter xmlWriter = new XmlTextWriter(sw);
        your_xslt_transformation.Transform(xPathNavigator, null, xmlWriter);
        return sb.ToString(); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-09T09:50:28.250

Implementing your own custom formatter might be a good idea.

Here's how you do it. First, create a type that defines the stuff you want to inject into your message. Note: I'm only going to illustrate this with the User part of your template...

```
class JobDetails
{
    public string User 
    { 
        get;
        set; 
    }        
} 
```

Next, implement a simple custom formatter...

```
class ExampleFormatter : IFormatProvider, ICustomFormatter
{
    public object GetFormat(Type formatType)
    {
        return this;
    }

    public string Format(string format, object arg, IFormatProvider formatProvider)
    {
        // make this more robust
        JobDetails job = (JobDetails)arg;

        switch (format)
        {
            case "User":
            {
                return job.User;
            }
            default:
            {
                // this should be replaced with logic to cover the other formats you need
                return String.Empty;
            }
        }
    }
} 
```

Finally, use it like this...

```
string template = "Dear {0:User}. Your job finished...";

JobDetails job = new JobDetails()
                     {
                             User = "Martin Peck"
                     };

string message = string.Format(new ExampleFormatter(), template, job); 
```

... which will generate the text "Dear Martin Peck. Your job finished...".

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-05-20T04:40:21.833

In case someone is searching for an alternative -- an actual .NET one:

[https://github.com/crozone/FormatWith](https://github.com/crozone/FormatWith) | [https://www.nuget.org/packages/FormatWith](https://www.nuget.org/packages/FormatWith)

A nice simple extendable solution. Thank you crozone!

So using the string extension provided in FormatWith here are two examples:

```
 static string emailTemplate = @"
Dear {User},

Your job finished at {FinishTime} and your file is available for download at {FileURL}.

-- 
{Signature}
    ";

//////////////////////////////////
/// 1\. Use a dictionary that has the tokens as keys with values for the replacement
//////////////////////////////////
    public void TestUsingDictionary()
    {    
        var emailDictionary = new Dictionary<string, object>()
        {
            { "User", "Simon" },
            { "FinishTime", DateTime.Now },
            { "FileUrl", new Uri("http://example.com/dictionary") },
            { "Signature", $"Sincerely,{Environment.NewLine}Admin" }
        };

        var emailBody = emailTemplate.FormatWith(emailDictionary);

        System.Console.WriteLine(emailBody);
    }

//////////////////////////////////
/// 2\. Use a poco with properties that match the replacement tokens
//////////////////////////////////
    public class MessageValues
    {
        public string User { get; set; } = "Simon";
        public DateTime FinishTime { get; set; } = DateTime.Now;
        public Uri FileURL { get; set; } = new Uri("http://example.com");
        public string Signature { get; set; } = $"Sincerely,{Environment.NewLine}Admin";
    }

    public void TestUsingPoco()
    {
        var emailBody = emailTemplate.FormatWith(new MessageValues());

        System.Console.WriteLine(emailBody);
    } 
```

It allows formatting the replacement inline as well. For example, try changing `{FinishTime}` to `{FinishTime:HH:mm:ss}` in `emailTemplate`.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-09T08:56:47.833

如果您需要一些非常强大的东西（*但实际上不是最简单的方法*），您可以托管 ASP.NET 并将其用作您的模板引擎。

您将拥有 ASP.NET 的所有功能来格式化您的消息正文。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-08-31T16:07:05.657

If you are coding in VB.NET you can use XML literals. If you are coding in C# you can use ShartDevelop to have files in VB.NET in the same project as C# code.

# c# - 如何避免 NullReferenceException

> ID：733383
> 
> 赞同：1
> 
> 时间：2009-04-09T08:52:30.323
> 
> 标签：c#, exception, exception-handling, nullreferenceexception

```
 if (alMethSign[z].ToString().Contains(aClass.Namespace)) 
```

在这里，我加载一个 exe 或 dll 并检查其命名空间。在某些 dll 中，没有命名空间，因此`aclass.namespace`不存在并且它抛出一个`NullReferenceException`.

我必须避免它，它应该继续使用其余代码。如果我使用 try-catch，它会执行 catch 部分；我希望它继续使用其余的代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T08:55:36.040

不要捕获异常。相反，防御它：

```
string nmspace = aClass.Namespace;

if (nmspace != null && alMethSign[z].ToString().Contains(nmspace))
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T08:56:34.400

是`aClass`实例`Type`吗？如果是这样 - 只需检查它是否为空：

```
if (aClass != null && alMethSign[z].ToString().Contains(aClass.Namespace)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T08:57:25.350

在 if 语句中添加对 null 的测试。

```
if(aClass.NameSpace != null && alMethSign[z].ToString().Contains(aClass.Namespace)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T09:39:24.080

或者使用扩展方法来检查任何空值并返回空字符串或对象的字符串值：

```
public static string ToSafeString(this object o)
{
return o == null ? string.Empty : o.ToString();

} 
```

# windows - 如何枚举进程的句柄？

> ID：733384
> 
> 赞同：28
> 
> 时间：2009-04-09T08:52:33.443
> 
> 标签：windows, handles

有什么方法可以在windows中枚举给定PID的进程，并获取他所有打开的句柄（锁定文件等）的列表？

编辑：我不在乎语言。如果它在 .NET 中，我会很高兴，如果在 WinApi (C) 中，它不会受到伤害。如果在别的地方，我想我可以重写它:-)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-15T06:58:24.547

我做了一个深入的谷歌搜索，发现了这篇[文章](http://www.codeguru.com/Cpp/W-P/system/processesmodules/article.php/c2827/)。本文提供了[下载源代码](http://www.codeguru.com/code/legacy/system/ntsysteminfo.zip)的链接：

我尝试了 NtSystemInfoTest.cpp 中的方法（下载的源代码），它工作得非常好。

```
void ListHandles( DWORD processID, LPCTSTR lpFilter ) 
```

该代码具有以下声明：

```
// Written by Zoltan Csizmadia, zoltan_csizmadia@yahoo.com
// For companies(Austin,TX): If you would like to get my resume, send an email.
//
// The source is free, but if you want to use it, mention my name and e-mail address
//
//////////////////////////////////////////////////////////////////////////////////////
// 
```

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-13T06:24:50.760

如果您只想要一个工具，Sysinternals的命令行“ [Handle ”工具可以做到这一点。](https://docs.microsoft.com/en-us/sysinternals/downloads/handle)但是，如果您正在寻找代码解决方案，这对您没有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-09T09:02:43.310

[这是一个](http://www.codeguru.com/forum/archive/index.php/t-176997.html)使用`ZwQueryProcessInformation`DDK 的示例。DDK 现在称为“WDK”，可通过 MSDN 获得。如果您没有 MSDN，显然，您也可以从[这里](http://blogs.msdn.com/peterwie/archive/2006/05/30/611070.aspx)获取。

我没试过，我只是用谷歌搜索了你的问题。

```
#include "ntdll.h"
#include <stdlib.h>
#include <stdio.h>
#include "ntddk.h"

#define DUPLICATE_SAME_ATTRIBUTES 0x00000004

#pragma comment(lib,"ntdll.lib")

BOOL EnablePrivilege(PCSTR name)
{
TOKEN_PRIVILEGES priv = {1, {0, 0, SE_PRIVILEGE_ENABLED}};
LookupPrivilegeValue(0, name, &priv.Privileges[0].Luid);

HANDLE hToken;
OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES, &hToken);

AdjustTokenPrivileges(hToken, FALSE, &priv, sizeof priv, 0, 0);
BOOL rv = GetLastError() == ERROR_SUCCESS;

CloseHandle(hToken);
return rv;
}

int main(int argc, char *argv[])
{
if (argc == 1) return 0;

ULONG pid = strtoul(argv[1], 0, 0);

EnablePrivilege(SE_DEBUG_NAME);

HANDLE hProcess = OpenProcess(PROCESS_DUP_HANDLE, FALSE, pid);

ULONG n = 0x1000;
PULONG p = new ULONG[n];

while (NT::ZwQuerySystemInformation(NT::SystemHandleInformation, p, n * sizeof *p, 0)
== STATUS_INFO_LENGTH_MISMATCH)

delete [] p, p = new ULONG[n *= 2];

NT::PSYSTEM_HANDLE_INFORMATION h = NT::PSYSTEM_HANDLE_INFORMATION(p + 1);

for (ULONG i = 0; i < *p; i++) {

if (h[i].ProcessId == pid) {
HANDLE hObject;

if (NT::ZwDuplicateObject(hProcess, HANDLE(h[i].Handle), NtCurrentProcess(), &hObject,
0, 0, DUPLICATE_SAME_ATTRIBUTES)
!= STATUS_SUCCESS) continue;

NT::OBJECT_BASIC_INFORMATION obi;

NT::ZwQueryObject(hObject, NT::ObjectBasicInformation, &obi, sizeof obi, &n);

printf("%p %04hx %6lx %2x %3lx %3ld %4ld ",
h[i].Object, h[i].Handle, h[i].GrantedAccess,
int(h[i].Flags), obi.Attributes,
obi.HandleCount - 1, obi.PointerCount - 2);

n = obi.TypeInformationLength + 2;

NT::POBJECT_TYPE_INFORMATION oti = NT::POBJECT_TYPE_INFORMATION(new CHAR[n]);

NT::ZwQueryObject(hObject, NT::ObjectTypeInformation, oti, n, &n);

printf("%-14.*ws ", oti[0].Name.Length / 2, oti[0].Name.Buffer);

n = obi.NameInformationLength == 0
? MAX_PATH * sizeof (WCHAR) : obi.NameInformationLength;

NT::POBJECT_NAME_INFORMATION oni = NT::POBJECT_NAME_INFORMATION(new CHAR[n]);

NTSTATUS rv = NT::ZwQueryObject(hObject, NT::ObjectNameInformation, oni, n, &n);
if (NT_SUCCESS(rv))
printf("%.*ws", oni[0].Name.Length / 2, oni[0].Name.Buffer);

printf("\n");

CloseHandle(hObject);
}
}
delete [] p;

CloseHandle(hProcess);

return 0;
} 
```

# jquery - Jquery 无法在 ajx 加载事件上从新 div 访问原始 jquery 对象

> ID：733405
> 
> 赞同：1
> 
> 时间：2009-04-09T08:57:34.617
> 
> 标签：jquery, ajax, html

我有一个包含一堆 JQuery 对象的页面。在同一页面上，我有一个表单，您可以在其中输入一系列字段中的搜索词，然后单击搜索按钮，然后它将向服务器发送 AJAX 请求，然后将生成的 HTML 加载到 div 中。一个非常简单的 Jquery 应用程序...

问题是这样的。当您单击通过 ajax 加载到 div 中的搜索结果链接时，原始页面上的 Jquery 代码将不会触发。例如，如果我在原始页面上添加一个名为 searchClick() 的函数，然后我将 onClick="searchClick()"`<a>`添加到通过 ajax 加载到 div 中的每个标记，单击该链接会产生一个 JS 错误，上面写着searchClick() 未定义。但它是定义的！我在 AJAX 调用之前定义了它。我正在阅读 Jquery 事件冒泡，但这似乎不是问题。实际上我不确定，但我已经尝试过了，但它仍然没有用。这是我当前的代码

**在浏览器加载页面时加载的主页上：**

```
<script language="javascript" type="text/javascript"> 
```

$(文档).ready(函数() {

...

```
 **function searchClick(value)** {
      alert("here");
    }

     $('#search').click(function() {
             description = urlencode($("#description").val());
             manufacturer = urlencode($("#manufacturer").val());
             product = urlencode($("#product").val());
             category = urlencode($("#category").val());
             subcategory = urlencode($("#subcategory").val());

             $(**'#search_results'**).**load**('/productSearch.php?description=' + description + '&product=' + product + '&category=' + category + '&subcategory=' + subcategory')

       });

    ...
    </script>

    <div id="**search_results**"></div> 
```

**以下是调用 ajax 查询时出现在 search_results div 中的链接示例（load()）**

```
<a href="#" onclick="s**earchClick("some value")"**>Product 1</a> 
```

在上面的示例中单击该链接将产生一个 searchClick() 未定义错误。有人有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T09:13:08.697

首先，[现场活动](http://docs.jquery.com/Events/live)会让您的生活更轻松，因为您不必自己添加 onclick 处理程序。相反，您可以绑定一个事件处理程序，该处理程序也将应用于稍后添加到 DOM 的元素（例如通过 AJAX 调用）。

至于你的问题，我没有解释。尝试使用 Firebug 等工具监控 html 源代码以及 DOM 结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T09:40:15.497

```
$("#search").live("click", function()
{
    var description = urlencode($("#description").val());
    var manufacturer = urlencode($("#manufacturer").val());
    var product = urlencode($("#product").val());
    var category = urlencode($("#category").val());
    var subcategory = urlencode($("#subcategory").val());

   $.ajax
   ({
        type: "GET",
        url: "/productSearch.php",
        data: 'description=' + description + '&product=' + product + '&category=' + category +"&subcategory=" + subcategory,
        success: function(result)
        {   
            $("#search_result").html(result);
        }
    });
}); 
```

添加新元素时使用[JQuery Live](http://docs.jquery.com/Events/live#typefn)事件，它们仍然会对事件做出反应。不要使用

```
<a href="#" onclick="s**earchClick("some value")"**>Product 1</a> 
```

它的坏形式。

# php - php & mysql 订阅搜索/匹配查询

> ID：733408
> 
> 赞同：1
> 
> 时间：2009-04-09T08:59:47.107
> 
> 标签：php, mysql, matching, subscribe

我有一个房地产网站，它有几个类别。我希望用户能够通过电子邮件订阅某个优惠列表，它们可以是某个类别的优惠……也可以是搜索列表中的优惠。

我如何存储他们在 mysql 中订阅的最佳方式……以及我如何进行通知。

我想出的最好的办法是在 mysql 表中存储一个带有用户 ID 的 mysql 字符串，并运行一个 cron 来获取所有这些并遍历它……运行 cron，如果有新广告，它会发送一封电子邮件。

但我认为这不是最好的主意，因为这也意味着如果数据库设计（例如，字段名称）发生变化，那么所有这些查询都会出错。

多谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T09:08:24.187

通常，您希望将表格设计得尽可能灵活，以应对意外变化。如果这些字段发生更改，您的查询无论如何都需要更改。

如果没有具体细节，这些将是我的指导方针：

1.  有一个包含索引和电子邮件的用户表

2.  有一个订阅类型表

3.  有一个用户 ID + 订阅查找表

4.  有一个待处理的消息表

当出现新的更新时，收集所有电子邮件并在待处理消息表中创建一个消息日志条目。

构建您的 Cron 以每隔几分钟抓取 20 条未发送的消息，并在发送后删除该消息。

我之所以说通过 CRON 迭代地发送它们是因为随着订阅者的增长，您不希望有数百封电子邮件必须同时发送出去并占用您服务器的邮件队列资源。您可以根据需要继续添加消息，并且您的队列将始终将它们发送出去。

我们在所有的群发电子邮件应用程序、错误记录和提醒通知系统中都非常有效地使用了这种方法。它可能不是最好的解决方案，但事实证明它非常易于管理和灵活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T09:07:58.617

如果你改变数据库设计，你肯定需要修复一些东西，这就是这个世界的运作方式。

如果由于某种原因很难更改`cron`任务，您可以创建一个始终返回适合该任务的结果集的存储过程，并改为更改存储过程。

# json - JSONP 和无效标签

> ID：733409
> 
> 赞同：2
> 
> 时间：2009-04-09T09:00:01.727
> 
> 标签：json, mootools, jsonp

使用 mootools 和 JsonP 我在 Firefox 错误控制台中收到“无效标签”错误

JsonP 似乎工作（我正确获取数据）

```
{"jsondata":[{"title":"title1","link":"http://xxxx.xxx.xxx","thumbsrc":"http://xxxx.xxx.xxx/17_t.jpg" ,"description":".......","pubDate":"2009-03-09 06:26:00",},{"title":"title2","link":"http://xxxx.xxx.xxx","thumbsrc":"http://xxxx.xxx.xxx/16_t.jpg" ,"description":".......","pubDate":"2009-03-09 06:08:09",}]} 
```

但我在“jsondata”上收到无效标签错误

同一个文件适用于 request.json

* * *

逗号已删除...什么都没有

这是我正在使用的代码

window.addEvent('domready', function() {

```
var gallery = $('gallery'); 

new JsonP('http://myjsoncodeurl',{
        onComplete: function(jsonObj) {
            addImages(jsonObj.jsondata);
        }
    }).request();

var addImages = function(images) {
    images.each(function(image) {
        var el = new Element('div', {'class': 'item'});
        var name = new Element('h3').inject(el);
        var a1 = new Element('a', {'href': image.link,'html': image.title}).inject(name);                       
        var desc = new Element('span', {'html': image.description}).inject(name, 'after');
        var a2 = new Element('a', {'href': image.link}).inject(desc,'after');               
        var img = new Element('img', {'src': image.thumbsrc}).inject(a2);
        el.inject(gallery);
    });
}; 
```

});

它适用于普通 request.Json，但 JSONP 不喜欢我的代码 :(

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-08T19:16:12.120

> 同一个文件适用于 request.json

使用 JSONP，您的响应应该返回一个 JavaScript 函数调用（即回调），其中 JSON 数据作为参数传入。如果您的响应是一个普通的旧 JSON 文本，它在 JSONP 的上下文中将不起作用。您必须定制后端以接受回调参数并使用 JSON 数据调用该回调。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-05T14:03:40.533

你需要在你的对象周围加上括号（普通的，而不是大括号），因为有时 Javascript 会变得非常混乱，并认为你正在做一个标签语句，这是一种在我用谷歌搜索这个问题之前我不知道存在的语句类型。

[https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Statements#label_Statement](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Statements#label_Statement)

尝试传递你的对象， `{"jsondata":[ ... ]}`, 作为 `({"jsondata":[ ... ]})`代替。这似乎对它进行了排序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T17:47:42.727

把它放在这里：

[http://json.parser.online.fr/](http://json.parser.online.fr/)

表明它是有效的，但有额外的逗号（这会破坏 IE，尽管 FF 应该处理它）。如果删除逗号不能解决问题，您需要发布更多代码以帮助我们找到错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T17:43:54.200

这可能是由于日期后的额外逗号

# c# - 您期望不可变列表的不变性有多深？

> ID：733412
> 
> 赞同：6
> 
> 时间：2009-04-09T09:00:25.623
> 
> 标签：c#, java, collections, immutability

如果你有一个不可变的列表，你希望它在你请求时总是返回对同一个对象的引用，比如

```
list.get(0) 
```

我的问题是，您是否希望能够对对象进行变异并在下次从列表中获取它时反映该变异？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T09:05:33.413

这取决于上下文。在通用库中，我们应该假设**列表**是不可变的。*列表中元素的*更改将反映给所有调用者，这是每次返回相同引用的直接结果。

但是，如果这是一个专门的不可变树（或其他什么），*并且被记录为这样，*那么您会期望列表中的项目本身是不可变的，这将成为一个没有实际意义的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T10:50:45.157

问题不是关于列表的不变性，而是关于所包含对象的不变性。

事实上，如果你有引用类型，列表中的不可变实体就是引用。这意味着引用将始终相同。现在被引用的对象是否改变只取决于它是什么类型的对象。如果对象是不可变的（例如，.NET 和 Java 中的字符串，或 .NET 中的所有值类型），则对象不能更改。

否则，对象可以更改，并且对同一对象的所有其他引用将看到更改的状态，因为它们持有对同一实例的引用。因此，正如我在开头所写的，这完全独立于列表（以及它是否不可变）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T09:05:23.723

这通常是可以预料的。该列表是不可变的，这意味着您不能在其中添加或删除项目或完全替换项目。如果您希望这些项目是不可变的，您必须自己处理。一旦你得到一个对它的引用，这个列表当然不能阻止你改变对象的状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T10:57:24.720

是的。

我不希望一个不可变的列表在我获取它们时克隆它的对象，除非它被记录为这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T11:09:08.000

这实际上取决于您提出该问题的上下文。任何有经验的 Java 或 C# 开发人员都知道，在技术上几乎不可能拥有一般的“深度不变性”，因此不会期望这一点。在 C++ 中，这是一个[非常复杂的主题](http://en.wikipedia.org/wiki/Const_correctness#C.2B.2B_syntax)，因此大多数开发人员可能也不期望可靠的深度不变性。另一方面，D 编程语言[确实具有传递不变性的语言级概念](http://en.wikipedia.org/wiki/Const_correctness#const_and_invariant_in_D)，因此 D 程序员可能会在任何有意义的地方期望它（这很常见）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-14T22:37:14.000

假设一家维修店想要保留所有曾经访问过的汽车的永久附加记录，以便当每辆汽车进入时，车主可以查明它以前是否曾在店里。哪个会更好：

1.  永久记录每辆车的 VIN（车辆识别号）
2.  制作每辆车的副本（由于 VIN 必须是唯一的，因此必须与原始车辆具有不同的 VIN）并永久存储复制的汽车。

请注意，汽车本身是一个可变对象，但*身份*由 VIN 表示的汽车的属性是不可变的。一辆在参观商店时是蓝色的汽车完全有可能被漆成红色。因此，即使一个人能够根据其 VIN 轻松定位任何汽车，但汽车列表 (VIN) 以及它们何时在店内也无法确定例如上周四维修了多少辆蓝色汽车。另一方面，如果该列表的目的是让人们知道一辆进货车辆以前是否在商店里，那么 VIN 列表正是人们所需要的。如果一个人没有 VIN，而是拥有一组重复的汽车，那么不仅创建和存储所有这些重复汽车的成本会远远高于存储 VIN 的成本，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T09:06:12.600

是的，知道Java，对于“不可变”，`List<T>`我不希望 T 是不可变的，除非 T 是不可变的。然而，一个合理的实现，比如说，每次都`List<Date>`复制。`Date`问题是它`Date`是可变的，可以与其他相等`Date`的 s 区分开来。

# linux - 如何编写一个 Linux bash 脚本来告诉我 LAN 中哪些计算机处于打开状态？

> ID：733418
> 
> 赞同：33
> 
> 时间：2009-04-09T09:02:33.030
> 
> 标签：linux, bash, ping

如何编写一个 Linux Bash 脚本来告诉我 LAN 中哪些计算机处于打开状态？

如果我可以给它一个 IP 地址范围作为输入，那将会有所帮助。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-09T19:51:45.517

我建议使用 nmap 的 ping-scan 标志，

```
$ nmap -sn 192.168.1.60-70

Starting Nmap 4.11 ( http://www.insecure.org/nmap/ ) at 2009-04-09 20:13 BST
Host machine1.home (192.168.1.64) appears to be up.
Host machine2.home (192.168.1.65) appears to be up.
Nmap finished: 11 IP addresses (2 hosts up) scanned in 0.235 seconds 
```

也就是说，如果你想自己写（这很公平），我会这样做：

```
for ip in 192.168.1.{1..10}; do ping -c 1 -t 1 $ip > /dev/null && echo "${ip} is up"; done 
```

..以及上述命令的每一位的解释：

## 生成 IP 地址列表

您可以使用`{1..10}`语法生成数字列表，例如..

```
$ echo {1..10}
1 2 3 4 5 6 7 8 9 10 
```

（它也适用于`mkdir {dir1,dir2}/{sub1,sub2}`- 生成`dir1`and `dir2`，每个都包含`sub1`and `sub2`）

因此，要生成 IP 列表，我们会执行类似的操作

```
$ echo 192.168.1.{1..10}
192.168.1.1 192.168.1.2 [...] 192.168.1.10 
```

## 循环

要在 bash 中循环某些内容，请使用`for`：

```
$ for thingy in 1 2 3; do echo $thingy; done
1
2
3 
```

## 平平

接下来，ping .. ping 命令会因操作系统、发行版/版本的不同而有所不同（我目前使用的是 OS X）

默认情况下（同样，在 OS X 版本上`ping`）它会一直 ping 直到被中断，这对这个不起作用，所以`ping -c 1`只会尝试发送一个数据包，这应该足以确定机器是否启动。

另一个问题是超时值，在这个版本的 ping 上似乎是 11 秒。它使用`-t`标志进行了更改。一秒钟应该足以查看本地网络上的机器是否处于活动状态。

所以，我们将使用的 ping 命令是..

```
$ ping -c 1 -t 1 192.168.1.1
PING 192.168.1.1 (192.168.1.1): 56 data bytes

--- 192.168.1.1 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss 
```

## 检查 ping 结果

接下来，我们需要知道机器是否回复了..

如果第一个成功，我们可以使用`&&`运算符运行命令，例如：

```
$ echo && echo "It works"

It works
$ nonexistantcommand && echo "This should not echo"
-bash: nonexistantcommand: command not found 
```

很好，所以我们可以做..

ping -c 1 -t 1 192.168.1.1 && echo "192.168.1.1 起来了！"

另一种方法是使用 ping 的退出代码。如果 ping 命令有效，它将以退出代码 0（成功）退出，如果失败，则以非零代码退出。在 bash 中，您将使用变量获得最后一个命令退出代码`$?`

所以，要检查命令是否有效，我们会做..

```
ping -c 1 -t 1 192.168.1.1;
if [ $? -eq 0 ]; then
    echo "192.168.1.1 is up";
else 
    echo "ip is down";
fi 
```

## 隐藏 ping 输出

最后一件事，我们不需要看到 ping 输出，所以我们可以通过重定向重定向`stdout`到`/dev/null`，`>`例如：

```
$ ping -c 1 -t 1 192.168.1.1 > /dev/null && echo "IP is up"
IP is up 
```

并重定向`stderr`（丢弃`ping: sendto: Host is down`消息），您使用`2>`- 例如：

```
$ errorcausingcommand
-bash: errorcausingcommand: command not found
$ errorcausingcommand 2> /dev/null
$ 
```

## 剧本

所以，把这一切结合起来..

```
for ip in 192.168.1.{1..10}; do  # for loop and the {} operator
    ping -c 1 -t 1 192.168.1.1 > /dev/null 2> /dev/null  # ping and discard output
    if [ $? -eq 0 ]; then  # check the exit code
        echo "${ip} is up" # display the output
        # you could send this to a log file by using the >>pinglog.txt redirect
    else
        echo "${ip} is down"
    fi
done 
```

或者，使用该`&&`方法，在单行中：

```
for ip in 192.168.1.{1..10}; do ping -c 1 -t 1 $ip > /dev/null && echo "${ip} is up"; done 
```

## 问题

它很慢。每个 ping 命令大约需要 1 秒（因为我们将 -t 超时标志设置为 1 秒）。它一次只能运行一个 ping 命令。解决此问题的明显方法是使用线程，因此您可以运行并发命令，但这超出了您应该使用 bash 的范围。

[“Python 线程 - 第一个示例”](http://www.wellho.net/solutions/python-python-threads-a-first-example.html)解释了如何使用 Python 线程模块来编写多线程 ping'er.. 虽然在那时，我还是会再次建议使用`nmap -sn`..

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-09T09:24:08.797

在现实世界中，您可以使用**[nmap](http://nmap.org/)**来获得您想要的东西。

```
nmap -sn 10.1.1.1-255 
```

这将 ping 10.1.1.1 到 10.1.1.255 范围内的所有地址，并让您知道哪些地址会回答。

当然，如果您实际上想将此作为 bash 练习，您可以对每个地址运行 ping 并解析输出，但那是另一回事了。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-09T09:17:13.430

假设我的网络是 10.10.0.0/24，如果我在广播地址上运行 ping

```
ping -b 10.10.0.255 
```

我将从该网络上所有未阻止其 ICMP ping 端口的计算机获得答复。

```
64 bytes from 10.10.0.6: icmp_seq=1 ttl=64 time=0.000 ms
64 bytes from 10.10.0.12: icmp_seq=1 ttl=64 time=0.000 ms 
64 bytes from 10.10.0.71: icmp_seq=1 ttl=255 time=0.000 ms 
```

所以你只需要提取第 4 列，例如 awk：

```
ping -b 10.10.0.255 | grep 'bytes from' | awk '{ print $4 }'

10.10.0.12:
10.10.0.6:
10.10.0.71:
10.10.0.95: 
```

好吧，你会得到重复的，你可能需要删除'：'。

从评论中编辑：-c 选项限制了 ping 的数量，因为脚本将结束，我们也可以限制自己使用唯一的 IP

```
ping -c 5 -b 10.10.0.255 | grep 'bytes from' | awk '{ print $4 }' | sort | uniq 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-09T19:09:39.690

还有[fping](http://fping.sourceforge.net/)：

```
fping -g 192.168.1.0/24 
```

或者：

```
fping -g 192.168.1.0 192.168.1.255 
```

或仅显示活着的主机：

```
fping -ag 192.168.1.0/24 
```

它并行 ping 主机，因此扫描速度非常快。我不知道`fping`默认安装中包含的发行版，但在大多数发行版中，您可以通过包管理器获取它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-09T09:32:49.993

同样使用 chburd 指出的“ping广播地址”方法，这个管道应该可以为您解决问题：

```
ping -c 5 -b 10.11.255.255 | sed -n 's/.* \([0-9]\+\.[0-9]\+\.[0-9]\+\.[0-9]\+\).*/\1/p' | sort | uniq 
```

当然，您必须将广播地址更改为您的网络的地址。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-09T18:44:05.307

只是为了好玩，这里有一个替代品

 `````
     #!/bin/bash
     nmap -sP 192.168.1.0/24 > /dev/null 2>&1 && arp -an | grep -v incomplete | awk '{print$2}' | sed -e s,\(,, | sed -e s,\),,

````  `* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-09T09:15:32.920

如果您将自己限制为仅更改最后一个八位字节，则此脚本应该这样做。如何将其从一个八位字节扩展到多个八位字节应该是相当明显的。

```
#！/bin/bash
基础=$1
开始=$2
结束=$3

计数器=$START

而 [ $counter -le $END ]
做
  ip=$BASE.$counter
  如果 ping -qc 2 $ip
  然后
    echo "$ip 响应"
  菲
  计数器=$(($counter + 1))
完毕

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-09T18:57:51.887

*   [`ip neighbor`](http://linux-ip.net/html/tools-ip-neighbor.html)
*   [`arp -a`](http://linux-ip.net/html/ether-arp.html#ether-arp-cache)
*   [阿尔普手表](http://en.wikipedia.org/wiki/Arpwatch)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T19:09:30.860

正如其他海报指出的那样，`nmap`这是要走的路，但这里是如何在 bash 中执行相当于 ping 扫描的操作。我不会使用广播 ping，因为现在很多系统都配置为不响应广播 ICMP。

```
for i in $(seq 1 254); do
    host="192.168.100.$i"
    ping -c 1 -W 1 $host &> /dev/null
    echo -n "Host $host is "
    test $? -eq 0 && echo "up" || echo "down"
done 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-17T05:51:56.240

```
#!/bin/bash
#Get the ip address for the range
ip=$(/sbin/ifconfig eth0 | grep 'inet addr:' | cut -d: -f2 | awk '{ print $1}' | cut -d"." -f1,2,3)

# ping test and list the hosts and echo the info

for range in $ip ; do  [ $? -eq 0 ] && ping -c 1 -w 1 $range > /dev/null 2> /dev/null && echo "Node $range is up" 
done 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-04-19T14:06:55.127

虽然是一个老问题，但它似乎仍然很重要（至少对我来说足够重要来处理这个问题）。我的脚本也依赖于 nmap，所以这里没有什么特别的，除了你可以定义你想要扫描的接口并且 IP 范围是自动创建的（至少是那种）。

这就是我想出的

```
#!/bin/bash
#Script for scanning the (local) network for other computers 

command -v nmap >/dev/null 2>&1 || { echo "I require nmap but it's not installed. Aborting." >&2; exit 1; }

if [ -n ""$@"" ];  then
    ip=$(/sbin/ifconfig $1 | grep 'inet '  | awk '{ print $2}' | cut -d"." -f1,2,3 )
    nmap -sP $ip.1-255
else
    echo -e "\nThis is a script for scanning the (local) network for other computers.\n"
    echo "Enter Interface as parameter like this:"
    echo -e "\t./scannetwork.sh $(ifconfig -lu | awk '{print $2}')\n"

    echo "Possible interfaces which are up are: "   
    for i in $(ifconfig -lu)
    do
        echo -e "\033[32m \t $i \033[39;49m"
    done

    echo "Interfaces which could be used but are down at the moment: "
    for i in $(ifconfig -ld)
    do
        echo -e "\033[31m \t $i \033[39;49m"
    done
    echo
fi 
```

备注：此脚本是在 OSX 上创建的，因此可能会对 linux 环境进行一些更改。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-12-14T16:44:25.123

如果您想提供主机列表，可以使用 nmap、grep 和 awk 完成。

安装 nmap：

```
$ sudo apt-get install nmap 
```

像这样创建文件 hostcheck.sh：

主机检查.sh

```
#!/bin/bash

nmap -sP -iL hostlist -oG pingscan > /dev/null
grep Up pingscan | awk '{print $2}' > uplist
grep Down pingscan | awk '{print $2}' > downlist 
```

-sP：Ping 扫描 - 只需确定主机是否在线

-iL ：来自主机/网络列表的输入

-oG ：以 Grepable 格式将扫描结果输出到给定的文件名。

/dev/null ：丢弃输出

更改访问权限：

```
$ chmod 775 hostcheck.sh 
```

使用要检查的主机列表（主机名或 IP）创建文件主机列表：

主机列表（示例）

```
192.168.1.1-5
192.168.1.101
192.168.1.123 
```

192.168.1.1-5 是一个IP范围

运行脚本：

./hostcheck.sh 主机文件

将生成包含所有信息的文件 pingscan，与主机联机 (Up) 的 uplist 和与主机脱机 (Down) 的 downlist。

上行列表（示例）

```
192.168.1.1
192.168.1.2
192.168.1.3
192.168.1.4
192.168.1.101 
```

下列表（示例）

```
192.168.1.5
192.168.1.123 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-02-01T17:04:41.237

有些机器不响应 ping（例如防火墙）。

如果你只想要本地网络，你可以使用这个命令：

```
(for n in $(seq 1 254);do sudo arping -c1 10.0.0.$n &  done ; wait) | grep reply | grep --color -E '([0-9]+\.){3}[0-9]+' 
```

### 解释部分！

1.  `arping`是发送 ARP 请求的命令。它存在于大多数 linux 上。

例子：

```
sudo arping -c1 10.0.0.14 
```

如果您是 root ofc，则不需要 sudo。

*   `10.0.0.14`: 你要测试的ip
*   `-c1`: 只发送一个请求。

* * *

2.  `&`：“我不想等待”字符

这是一个非常有用的角色，它使您可以在子进程中启动命令而无需等待他完成（如线程）

* * *

3.  循环在`for`这里对所有 255 个 IP 地址进行 arping。它使用`seq`命令列出所有数字。

* * *

4.  `wait`: 在我们发起我们的请求后，我们想看看是否有一些回复。为此，我们只需放在`wait`循环之后。 `wait`看起来像`join()`其他语言中的函数。

* * *

5.  `()`：括号在这里将所有输出解释为文本，因此我们可以将其提供给`grep`

* * *

6.  `grep`: 我们只想看回复。第二个 grep 只是为了突出 IP。

hth

### 编辑 20150417：Maxi 更新！

我的解决方案的不好的部分是它在最后打印所有结果。这是因为 grep 有足够大的缓冲区来放入一些行。解决方案是添加`--line-buffered`到第一个 grep。像这样：

```
(for n in $(seq 1 254);do sudo arping -c1 10.0.0.$n &  done ; wait) | grep --line-buffered reply | grep --color -E '([0-9]+\.){3}[0-9]+' 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-27T04:30:33.313

```
#!/bin/bash

for ((n=0 ; n < 30 ; n+=1))
do
    ip=10.1.1.$n
    if ping -c 1 -w 1 $ip > /dev/null 2> /dev/null >> /etc/logping.txt; then  
        echo "${ip} is up" # output up
        # sintax >> /etc/logping.txt log with .txt format
    else
        echo "${ip} is down" # output down
    fi
done 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-16T17:12:32.417

以下（邪恶）代码的运行速度比 nmap 方法快两倍

```
for i in {1..254} ;do (ping 192.168.1.$i -c 1 -w 5  >/dev/null && echo "192.168.1.$i" &) ;done 
```

大约需要 10 秒，其中标准的 nmap

```
nmap -sP 192.168.1.1-254 
```

需要25秒...

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-13T19:39:45.807

嗯，这是我的一个脚本的一部分。

> **ship.sh** 一个简单、方便的网络寻址多功能工具，具有大量功能

**Ping 网络，显示该网络上的在线主机及其本地 IP 和 MAC 地址**

它不需要任何编辑。需要root权限才能运行。

```
GOOGLE_DNS="8.8.8.8"
ONLINE_INTERFACE=$(ip route get "${GOOGLE_DNS}" | awk -F 'dev ' 'NR == 1 {split($2, a, " "); print a[1]}')
NETWORK_IP=$(ip route | awk "/${ONLINE_INTERFACE}/ && /src/ {print \$1}" | cut --fields=1 --delimiter="/")
NETWORK_IP_CIDR=$(ip route | awk "/${ONLINE_INTERFACE}/ && /src/ {print \$1}")
FILTERED_IP=$(echo "${NETWORK_IP}" | awk 'BEGIN{FS=OFS="."} NF--')

ip -statistics neighbour flush all &>/dev/null

echo -ne "Pinging ${NETWORK_IP_CIDR}, please wait ..."
for HOST in {1..254}; do
  ping "${FILTERED_IP}.${HOST}" -c 1 -w 10 &>/dev/null &
done

for JOB in $(jobs -p); do wait "${JOB}"; done

ip neighbour | \
    awk 'tolower($0) ~ /reachable|stale|delay|probe/{printf ("%5s\t%s\n", $1, $5)}' | \
      sort --version-sort --unique 
```

# asp.net - ASP.net 中继器，一次滚动 3 个

> ID：733426
> 
> 赞同：0
> 
> 时间：2009-04-09T09:04:54.007
> 
> 标签：asp.net, repeater

我有一个需要在网页中一次显示 3 个的数据列表

第一个需要显示在名为“left”的 div 中，第二个需要显示在名为“centre”的 div 中，第三个需要显示在名为“right”的 div 中。

而且我需要能够使用寻呼机滚动浏览数据。以此类推，接下来的 3 个结果会以类似的方式显示，以此类推，直到数据集结束

显然中继器中的交替模板不适合这种情况。

有没有更聪明的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T12:23:57.877

试试这样的循环

for (int i = 3; i < enumerable.length + 3; i++) {

```
 if (i % 3 == 0)
  { 
     // Put it in div 1
  {
  else if (i % 3 == 1)
  {
     // put it in div 2
  {
  else if (i % 3 == 2)
  {
     // put it in div 3
  { 
```

}

第一次通过，它将使用 div1，第二次使用 div2，第三次使用 div3，然后第四次使用 div1，以此类推……

# java - 解决 java.security.AccessControlException 的快速方法

> ID：733435
> 
> 赞同：0
> 
> 时间：2009-04-09T09:08:10.160
> 
> 标签：java, security, applet, java-6

我有一个必须从服务器读取文件的小程序。但我收到以下异常

```
java.security.AccessControlException: access denied (java.io.FilePermission \kb1.xml read)
at java.security.AccessControlContext.checkPermission(Unknown Source)
at java.security.AccessController.checkPermission(Unknown Source)
at java.lang.SecurityManager.checkPermission(Unknown Source)
at java.lang.SecurityManager.checkRead(Unknown Source)
at java.io.File.isDirectory(Unknown Source)
at sun.net.www.protocol.file.FileURLConnection.connect(Unknown Source)
at sun.net.www.protocol.file.FileURLConnection.getInputStream(Unknown Source)
... 
```

我试图放置一个具有读取权限的 java.policy.applet 文件，但它不起作用。我需要一个快速的方法来解决这个问题。我必须指定为了制作这个小程序，我使用了 java 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:12:22.163

您说您要读取服务器上的文件，但是由于尝试读取客户端（运行小程序的机器）上的文件而导致异常。

您不能直接从服务器读取文件。您需要通过 HTTP 访问它们或将它们放入小程序的 jar 文件并从那里加载。

# javascript - 如何在 javascript 函数中使用 css

> ID：733440
> 
> 赞同：0
> 
> 时间：2009-04-09T09:09:02.593
> 
> 标签：javascript, jquery, css

我正在使用 jQuery 月历，其中每天都是一个单元格，在单元格中单击 onClick，我可以打印警报，但我也想更改我单击的单元格的背景颜色。但我没有办法使用 Javascript 调用 CSS。请帮帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T09:15:31.953

在 jQuery 中，您可以使用[css 方法](http://docs.jquery.com/CSS/css#namevalue)来更改单元格的背景颜色：

```
// let's say this is in a loop
$(this).css('background-color', '#f00'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T09:16:02.013

在纯 JavaScript 中：

```
var element = document.getElementById("myElement");
element.style.backgroundColor = "#fff"; 
```

史蒂夫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T09:40:29.240

使用 JS 更改任何元素的样式属性会创建一个非常高的特异性规则，该规则很难检测和删除，并且在处理多种样式效果时不太灵活（比如说你想要一个边框和一个背景，现在你有两倍很多工作要做）。

从维护、灵活性和关注点分离的角度来看，几乎总是最好*不要*直接修改元素的样式，而是更改它的类并让 CSS 为您完成工作。

例如，我想更改为这种边框+背景样式，所以我将在我的 CSS 中定义一个类

```
.highlight
{
  border: 1px solid black;
  background: white;
} 
```

然后我将修改我需要的元素：

```
document.getElementById('myElementId').className += " highlight"; //note the space 
```

现在在实践中，我实际上将该类修改代码包装在一个更通用的包装器中，以保护自己不会两次分配同一个类，并使其再次更容易删除，但原则上你可以看到现在改变效果是微不足道的仅在一个点上“突出显示”，它允许正常级联，并且检测元素具有突出显示类比检查它是否具有 FOO 的背景颜色和 BAR 的边框要容易得多。

它还非常重要地增加了语义价值。自我记录代码是一件*非常好的*事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T09:19:17.420

设置一个 CSS 属性：

```
$("#myCalender").css("background-color","SomeColor"); 
```

设置整个班级：

```
$("#myCalender").addClass("DifferentBGColorClass"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T09:29:29.813

要更改背景颜色，您可以使用：

```
document.getElementById("").style.backgroundColor = "#ffffff";

```

# python - 将整数格式化为带前导零的字符串的最佳方法？

> ID：733454
> 
> 赞同：382
> 
> 时间：2009-04-09T09:15:33.280
> 
> 标签：python, string-formatting

我需要在整数中添加前导零以创建一个具有定义数量的数字（$cnt）的字符串。将这个简单的函数从 PHP 转换为 Python 的最佳方法是什么：

```
function add_nulls($int, $cnt=2) {
    $int = intval($int);
    for($i=0; $i<($cnt-strlen($int)); $i++)
        $nulls .= '0';
    return $nulls.$int;
} 
```

有没有可以做到这一点的功能？

* * *

## 回答 #1

> 赞同：751
> 
> 时间：2009-04-09T09:23:23.387

您可以使用该`zfill()`方法用零填充字符串：

```
In [3]: str(1).zfill(2)
Out[3]: '01' 
```

* * *

## 回答 #2

> 赞同：220
> 
> 时间：2012-12-17T18:10:33.033

标准方法是使用格式字符串修饰符。这些格式字符串方法在大多数编程语言中都可用（例如，通过 c 中的 sprintf 函数），并且是一个方便的了解工具。

输出长度为 5 的字符串：

... 在 Python 3.5 及更高版本中：

```
i = random.randint(0, 99999)
print(f'{i:05d}') 
```

... Python 2.6 及更高版本：

```
print '{0:05d}'.format(i) 
```

...在 Python 2.6 之前：

```
print "%05d" % i 
```

请参阅：[https ://docs.python.org/3/library/string.html](https://docs.python.org/3/library/string.html)

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2017-03-02T17:39:22.320

Python 3.6 f-strings 允许我们轻松添加前导零：

```
number = 5
print(f' now we have leading zeros in {number:02d}') 
```

看看这个关于这个功能的[好帖子。](https://cito.github.io/blog/f-strings/)

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2009-04-09T09:16:59.953

您很可能只需要格式化整数：

```
'%0*d' % (fill, your_int) 
```

例如，

```
>>> '%0*d' % (3, 4)
'004' 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-04-09T09:59:49.193

Python 2.6 允许这样做：

```
add_nulls = lambda number, zero_count : "{0:0{1}d}".format(number, zero_count)

>>>add_nulls(2,3)
'002' 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2016-04-11T20:30:23.190

对于 Python 3 及更高版本： str.zfill() 仍然是最易读的选项

但是看看新的强大的 str.format() 是个好主意，如果你想填充不是 0 的东西怎么办？

```
 # if we want to pad 22 with zeros in front, to be 5 digits in length:
    str_output = '{:0>5}'.format(22)
    print(str_output)
    # >>> 00022
    # {:0>5} meaning: ":0" means: pad with 0, ">" means move 22 to right most, "5" means the total length is 5

    # another example for comparision
    str_output = '{:#<4}'.format(11)
    print(str_output)
    # >>> 11##

    # to put it in a less hard-coded format:
    int_inputArg = 22
    int_desiredLength = 5
    str_output = '{str_0:0>{str_1}}'.format(str_0=int_inputArg, str_1=int_desiredLength)
    print(str_output)
    # >>> 00022 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-09T11:36:57.760

你至少有两个选择：

*   str.zfill：`lambda n, cnt=2: str(n).zfill(cnt)`
*   `%`格式化：`lambda n, cnt=2: "%0*d" % (cnt, n)`

如果在 Python >2.5 上，请参阅 clorz 答案中的第三个选项。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-23T18:42:00.077

### 内置`zfill`.

此函数`x`将其转换为字符串，并仅在开头添加零且仅在长度太短时添加：

```
def zfill_alternative(x,len=4): return ( (('0'*len)+str(x))[-l:] if len(str(x))<len else str(x) ) 
```

总而言之 - build-in:`zfill`已经足够好了，但是如果有人对如何手动实现这一点感到好奇，这里还有一个例子。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T09:40:57.680

一个简单的转换将是（再次使用函数）：

```
def add_nulls2(int, cnt):
    nulls = str(int)
    for i in range(cnt - len(str(int))):
        nulls = '0' + nulls
    return nulls 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-09T09:36:21.187

这是我的 Python 函数：

```
def add_nulls(num, cnt=2):
  cnt = cnt - len(str(num))
  nulls = '0' * cnt
  return '%s%s' % (nulls, num) 
```

# javascript - IE 8 security warning - choosing not to display unsecure items - JS still run?

> ID：733463
> 
> 赞同：0
> 
> 时间：2009-04-09T09:17:18.220
> 
> 标签：javascript, security, internet-explorer, warnings

I've got Google conversion tracking code (small bit of JavaScript) on a confirmation page on my site which is displayed after a user completes a transaction. It is displayed on my wordpay callback page which is pulling data from the regular site (HTTP) to the worldpay site (HTTPS) so IE 7/8 asks

> do you want to display non-secure items?

Clicking no removes the CSS and all other styling info but still picks up the JS (can see it in the source code of the page).

What I want to know is, does the code still gets executed when the user clicks "no"? Because it is displayed you would assume so?

But the source of the page still displays the CSS and image links but they aren't rendered.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T09:23:23.463

The warning occurs when your page is loaded from `https` and includes items that are loaded via `http`. So if your Javascript comes from a non-secure source then I'd expect it to be disabled, even though it still appears in the code (heck, why shouldn't it. IE doesn't alter the DOM in that case but rather doesn't load certain external elements – that's why you still see image tags, etc. in the source even though they are not rendered).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T11:08:41.273

i've got a simillar problem... IE prompts for display of 'non-nsecure' elements... i get this for javascript and flash (loading calls javascript... direct adobe/macromedia drag&drop implementation) ...it doesnt really bother me if ppl have to confirm the page view but some with high security settings decline it by default settings (no prompt) and that is a problem

page is www.zivljenje.com ... its a simple javascript that has a table and a radnom function taht calls and writes one row of the table... something like "the thought of the day" (added the table comments and removed somea < begginig for the code visibility...)

> script language="JavaScript" type="text/javascript"> //THE TABLE
> 
> !-- var r_text = new Array (); r_text[0] = "OBSTAJA SAMO EN JEZIK, JEZIK SRCA. OBSTAJA SAMO ENA RELIGIJA, RELIGIJA LJUBEZNI. OBSTAJA SAMO ENA KASTA, KASTA ČLOVEŠTVA. OBSTAJA SAMO EN BOG, KI JE VSEPRISOTEN. "; r_text[1] = "Tako kot dobro preživet dan prinese srečen spanec, dobro porabljeno življenje prinese srečno smrt."; r_text[2] = "Ne moremo storiti velikih dejanj. Le mala dejanja z veliko ljubezni."; r_text[3] = "Poskrbi da dobiš, kar imaš rad, drugače boš prisiljen imeti rad, kar boš dobil."; r_text[4] = "Pogum ni odsotnost strahu, je le sodba, da je nekaj drugega pomembneje od strahu"; r_text[5] = "Izkušnja ni nekaj, kar se ti zgodi. Izkušnja je, kar narediš s tistim, kar se ti zgodi."; r_text[6] = "Vprašaj se, če te to kar delaš danes, vodi tja, kjer želiš biti jutri."; r_text[7] = "Gram časa je gram zlata. A z gramom zlata ne moremo kupiti grama časa."; r_text[8] = "Resnično srečen je človek, ki zna povsem natančno presoditi samega sebe..."; r_text[9] = "Nič več se ne odločam verjeti v stare omejitve in v pomanjkanje.";
> 
> //END TABLE
> 
> var i = Math.floor(0*Math.random())
> 
> document.write(r_text[i]); //-->

# php - PHP：奇怪的数组问题 - 我的价值在哪里？

> ID：733464
> 
> 赞同：0
> 
> 时间：2009-04-09T09:17:21.730
> 
> 标签：php, arrays, http-post-vars

我有一个数组（$form），它从 $_POST 中检索一些信息：

```
$form = $_POST['game']; 
```

现在我想使用这个数组中的值，但我不知何故失败了。

为了调试，我使用了这些命令（以完全相同的顺序，中间没有多余的行）：

```
print_r($form);
echo '#' . $form['System_ID'] . "#"; 
```

作为返回的输出，我得到：

```
Array
(
    ['Title'] => Empire: Total War - Special Forces
    ['Genre_ID'] => 1
    ['Type'] => Spiel
    ['System_ID'] => 1
)
## 
```

我的 System_ID 去哪儿了有什么想法吗？它在 print_r 中，但不在 echo 的下一行？！？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T09:28:19.410

好吧，我自己找到了解决方案（又名 d'oh！）

我添加了另一个

```
var_dump($form); 
```

进行进一步分析，这就是我得到的：

```
array(4) {
  ["'Title'"]=>
  string(34) "Empire: Total War - Special Forces"
  ["'Genre_ID'"]=>
  string(1) "1"
  ["'Type'"]=>
  string(5) "Spiel"
  ["'System_ID'"]=>
  string(1) "1"
} 
```

注意到双引号内的单引号了吗？

看起来好像您不允许在 html 表单中使用单引号，否则它们将包含在数组键中：

```
Wrong: <input type="text" name="game['Title']" />
Correct: <input type="text" name="game[Title]" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T09:52:01.350

print_r() 不会在键周围加上引号 - 为了调试，我建议完全放弃 print_r。var_export 或 var_dump 更好。

更好的是：使用[firephp](http://www.firephp.org/)。它通过标头发送调试信息，因此它不会弄乱您的输出，因此甚至可以与 ajax 一起使用。使用萤火虫很好地显示输出，包括数据结构的语法着色。

而且它更容易使用：只需`fb($myvar);`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T09:24:43.507

这个对我有用：

```
<?
  $form['System_ID'] = 1;
  print_r($form);
  echo '#' . $form['System_ID'] . '#';
?> 
```

输出：

```
% php foo.php
Array
(
    [System_ID] => 1
)
#1# 
```

PHP 5.2.6，在 Fedora Core 10 上

编辑 - 请注意，这里有真正原因的提示。在我的代码中，`print_r`输出（正确）显示了没有单引号的数组键。原始发布者的键在输出中*确实*有引号`print_r`，表明实际键以某种方式包含引号。

# dependencies - CMake & CTest : make test 不构建测试

> ID：733475
> 
> 赞同：102
> 
> 时间：2009-04-09T09:22:24.837
> 
> 标签：dependencies, cmake, ctest

我正在 CMake 中尝试 CTest，以便使用`make test`目标自动运行我的一些测试。问题是 CMake 不“理解”我愿意运行的测试必须构建，因为它是项目的一部分。

所以我正在寻找一种明确指定这种依赖关系的方法。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-04-10T05:57:33.937

*可以说*这是[CMake 中](https://gitlab.kitware.com/cmake/cmake/issues/8774)的一个错误（以前[在此处](http://public.kitware.com/Bug/view.php?id=8774)跟踪），这不能开箱即用。一种解决方法是执行以下操作：

```
add_test(TestName ExeName)
add_custom_target(check COMMAND ${CMAKE_CTEST_COMMAND}
                  DEPENDS ExeName) 
```

然后你可以运行`make check`它，它将编译并运行测试。如果您有多个测试，那么您将不得不`DEPENDS exe1 exe2 exe3 ...`在上面的行中使用。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-05-30T21:32:46.040

其实是有办法使用的`make test`。您需要将测试可执行文件的构建定义为测试之一，然后在测试之间添加依赖关系。那是：

```
ADD_TEST(ctest_build_test_code
         "${CMAKE_COMMAND}" --build ${CMAKE_BINARY_DIR} --target test_code)
ADD_TEST(ctest_run_test_code test_code)
SET_TESTS_PROPERTIES(ctest_run_test_code
                     PROPERTIES DEPENDS ctest_build_test_code) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-02-25T05:53:52.080

我使用richq 答案的变体。在顶层`CMakeLists.txt`，我添加了一个自定义目标`build_and_test`，用于构建和运行所有测试：

```
find_package(GTest)
if (GTEST_FOUND)
    enable_testing()
    add_custom_target(build_and_test ${CMAKE_CTEST_COMMAND} -V)
    add_subdirectory(test)
endif() 
```

在下的各种子项目`CMakeLists.txt`文件中`test/`，我将每个测试可执行文件添加为以下依赖项`build_and_test`：

```
include_directories(${CMAKE_SOURCE_DIR}/src/proj1)
include_directories(${GTEST_INCLUDE_DIRS})
add_executable(proj1_test proj1_test.cpp)
target_link_libraries(proj1_test ${GTEST_BOTH_LIBRARIES} pthread)
add_test(proj1_test proj1_test)
add_dependencies(build_and_test proj1_test) 
```

使用这种方法，我只需要`make build_and_test`代替`make test`（或`make all test`），它的好处是只构建测试代码（及其依赖项）。很遗憾我不能使用目标名称`test`。就我而言，这还不错，因为我有一个顶级脚本，它通过调用`cmake`然后进行树外调试和发布（和交叉编译）构建`make`，并将其转换`test`为`build_and_test`.

显然，不需要 GTest 的东西。我只是碰巧使用/喜欢 Google Test，并想分享一个使用 CMake/CTest 的完整示例。恕我直言，这种方法还具有允许我使用的好处`ctest -V`，它在测试运行时显示 Google Test 输出：

```
1: Running main() from gtest_main.cc
1: [==========] Running 1 test from 1 test case.
1: [----------] Global test environment set-up.
1: [----------] 1 test from proj1
1: [ RUN      ] proj1.dummy
1: [       OK ] proj1.dummy (0 ms)
1: [----------] 1 test from proj1 (1 ms total)
1:
1: [----------] Global test environment tear-down
1: [==========] 1 test from 1 test case ran. (1 ms total)
1: [  PASSED  ] 1 test.
1/2 Test #1: proj1_test .......................   Passed    0.03 sec 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-06-04T17:09:23.743

如果您使用 CMake >= 3.7，那么推荐的方法是使用[fixtures](https://crascit.com/2016/10/18/test-fixtures-with-cmake-ctest/)：

```
add_executable(test test.cpp)
add_test(test_build
  "${CMAKE_COMMAND}"
  --build "${CMAKE_BINARY_DIR}"
  --config "$<CONFIG>"
  --target test
)
set_tests_properties(test_build PROPERTIES FIXTURES_SETUP    test_fixture)
add_test(test test)
set_tests_properties(test       PROPERTIES FIXTURES_REQUIRED test_fixture) 
```

这将执行以下操作：

*   添加一个`test`从构建的可执行目标`test.cpp`
*   添加一个`test_build`运行 Cmake 来构建目标的“测试”`test`
*   将测试标记`test_build`为夹具的设置任务`test_fixture`
*   添加一个`test`只运行`test`可执行文件的测试
*   标记`test`测试需要fixture `test_fixture`。

因此，每次`test`运行 test 时，它首先运行 test `test_build`，它会构建必要的可执行文件。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-03-12T16:08:28.110

如果您尝试模拟`make check`，您可能会发现此 wiki 条目很有用：

[http://www.cmake.org/Wiki/CMakeEmulateMakeCheck](http://www.cmake.org/Wiki/CMakeEmulateMakeCheck)

我刚刚检查过它是否成功（CMake 2.8.10）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-04-04T08:48:26.030

免得自己头疼：

```
make all test 
```

对我来说开箱即用，并将在运行测试之前构建依赖项。鉴于这是多么简单，它几乎使本机`make test`功能变得方便，因为它使您可以选择运行最后的编译测试，即使您的代码已损坏。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-20T21:57:18.720

这是我敲定并一直在使用的：

```
set(${PROJECT_NAME}_TESTS a b c)

enable_testing()
add_custom_target(all_tests)
foreach(test ${${PROJECT_NAME}_TESTS})
        add_executable(${test} EXCLUDE_FROM_ALL ${test}.cc)
        add_test(NAME ${test} COMMAND $<TARGET_FILE:${test}>)
        add_dependencies(all_tests ${test})
endforeach(test)

build_command(CTEST_CUSTOM_PRE_TEST TARGET all_tests)
string(CONFIGURE \"@CTEST_CUSTOM_PRE_TEST@\" CTEST_CUSTOM_PRE_TEST_QUOTED ESCAPE_QUOTES)
file(WRITE "${CMAKE_BINARY_DIR}/CTestCustom.cmake" "set(CTEST_CUSTOM_PRE_TEST ${CTEST_CUSTOM_PRE_TEST_QUOTED})" "\n") 
```

YMMV

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-04-24T18:27:15.550

对于 CMake 3.10 或更高版本，另一种选择是使用[`TEST_INCLUDE_FILES`](https://cmake.org/cmake/help/latest/prop_dir/TEST_INCLUDE_FILES.html)目录属性设置脚本，在运行测试之前触发构建。在最外层`CMakeLists.txt`添加以下代码：

```
set_property(DIRECTORY APPEND
    PROPERTY TEST_INCLUDE_FILES "${CMAKE_CURRENT_BINARY_DIR}/BuildTestTarget.cmake")
file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/BuildTestTarget.cmake"
   "execute_process(COMMAND \"${CMAKE_COMMAND}\""
   " --build \"${CMAKE_BINARY_DIR}\""
   " --config \"\$ENV{CMAKE_CONFIG_TYPE}\")") 
```

实际的测试配置通过环境变量传递给构建`CMAKE_CONFIG_TYPE`。或者，您可以添加一个[`--target`](https://cmake.org/cmake/help/latest/manual/cmake.1.html#build-a-project)选项以仅构建测试所需的目标。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-09-03T22:24:18.963

井架的回答，简化和评论：

```
# It is impossible to make target "test" depend on "all":
# https://gitlab.kitware.com/cmake/cmake/-/issues/8774
# Set a magic variable in a magic file that tells ctest
# to invoke the generator once before running the tests:
file(WRITE "${CMAKE_BINARY_DIR}/CTestCustom.cmake"
    "set(CTEST_CUSTOM_PRE_TEST ${CMAKE_MAKE_PROGRAM})\n"
) 
```

这并不完全正确，因为它不能解决 running 的并发问题`ninja all test`，以防万一有人这样做。相反，因为现在，你有两个忍者进程。

[（Ftr，我也在这里](https://gist.github.com/anordal/c73be8a8fc922bef6088105f9cbfe802)分享了这个解决方案。）

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-08-24T14:20:11.553

以上所有答案都是完美的。但实际上 CMake 使用 CTest 作为其测试工具，因此执行任务的标准方法（我认为是）是：

```
enable_testing ()
add_test (TestName TestCommand)
add_test (TestName2 AnotherTestCommand) 
```

然后运行**​​cmake**和**make**来构建目标。之后，您可以运行**make test**，或者只运行

```
ctest 
```

你会得到结果。这是在 CMake 2.8 下测试的。

检查详细信息：[http ://cmake.org/Wiki/CMake/Testing_With_CTest#Simple_Testing](http://cmake.org/Wiki/CMake/Testing_With_CTest#Simple_Testing)

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2013-05-20T13:25:12.803

所有的答案都很好，但它们暗示了通过命令运行测试的传统违反`make test`。我已经完成了这个技巧：

```
add_test(NAME <mytest>
WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
COMMAND sh -c "make <mytarget>; $<TARGET_FILE:<mytarget>>") 
```

这意味着测试包括构建（可选）和运行可执行目标。

# asp.net - SessionState 和 ViewState 有什么区别？

> ID：733482
> 
> 赞同：118
> 
> 时间：2009-04-09T09:24:34.817
> 
> 标签：asp.net, session-state, viewstate

ASP.NET 中的 SessionState 和 ViewState 有什么区别？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-04-09T09:32:03.800

**会话状态**包含与服务器的特定会话（由特定客户端/浏览器/机器）有关的信息。这是一种跟踪用户在网站上所做的事情的方法......**跨多个页面**......在 Web 的无状态状态下。例如，特定用户购物车的内容就是会话数据。Cookies 可用于会话状态。另一方面，
**视图状态是特定网页的特定信息。**它存储在隐藏字段中，因此对用户不可见。它用于保持用户的错觉，即页面记住了他上次在其上所做的事情 - 不要每次回帖时都给他一个干净的页面。[查看此页面了解更多信息](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2009-04-09T09:27:29.693

会话状态保存在服务器上，ViewState 保存在页面中。

会话状态通常在用户一段时间不活动后被清除（在请求 cookie 中没有发生包含会话 ID 的请求）。

视图状态在随后的帖子中发布在隐藏字段中。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-04-09T09:27:02.673

**会话状态**

*   可以持久保存在内存中，这使其成为一种快速的解决方案。这意味着不能在 Web Farm/Web Garden 中共享状态。
*   可以保存在数据库中，对网络农场/网络花园很有用。
*   会话结束时清除 - 通常在 20 分钟不活动后。

**视图状态**

*   在服务器和客户端之间来回发送，占用带宽。
*   没有有效期。
*   在网络农场/网络花园中很有用

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-09T10:13:03.843

**用法：** 如果您要将要访问的信息存储在不同的网页上，可以使用 SessionState

如果要存储要从同一页面访问的信息，则可以使用 Viewstate

**存储** Viewstate 存储在页面本身中（以加密文本形式），而 Sessionstate 存储在服务器中。

SessionState 在以下情况下会清除

1.  被程序员清除
2.  由用户清除
3.  超时

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-09T09:34:33.123

会话主要用于存储用户特定数据[会话特定数据]。在会话的情况下，您可以使用整个会话的值，直到会话过期或用户放弃会话。Viewstate 是仅在使用它的页面中具有范围的数据类型。除非您将这些值传输到所需的页面，否则您无法让其他页面访问视图状态值。同样在视图状态的情况下，所有服务器端控件数据都作为 __Viewstate 中的键值对传输到服务器，并在回发发生时传输回并呈现给客户端中的适当控件。

# c++ - 是时候告别 VC6 编译器了吗？

> ID：733495
> 
> 赞同：6
> 
> 时间：2009-04-09T09:30:22.230
> 
> 标签：c++, compiler-construction, visual-c++-6

最近我面临着指向 VC6 编译器的问题。

其中很少有：

1.  功能尝试块不起作用。[相关问](https://stackoverflow.com/questions/697026/exception-handling-in-constructors-initializer-list)
2.  类内常量不起作用。
3.  __FUNCTION_（获取函数名的宏）不起作用
4.  最新添加的是**它不允许将 void 函数作为 for_each 的一部分传递。**

以下示例未使用 VC6 编译器进行编译。它说“错误C2562：'（）'：'void'函数返回一个值”。看起来 VC6 不喜欢将 void 函数传递给 for_each。

```
class Temp
{
public:
    Temp(int i):m_ii(i)
    {}

    int getI() const
    {
        return m_ii;
    }

    void printWithVoid()
    {
        cout<< "i = "<<m_ii<<endl;

    }
    bool printWithBool()
    {
        cout<< "i = "<<m_ii<<endl;
        return true;
    }
private:
    int m_ii;
};

int main(void) 
{
    std::vector<Temp>  arrTempObjects;

    arrTempObjects.push_back(Temp(0));
    arrTempObjects.push_back(Temp(2));

    //Doesnot work, compiler error 
    std::for_each(arrTempObjects.begin(), arrTempObjects.end(), std::mem_fun_ref(&Temp::printWithVoid));

    //Works
    std::for_each(arrTempObjects.begin(), arrTempObjects.end(), std::mem_fun_ref(&Temp::printWithBool));

    return 0;
} 
```

您是否遇到过与 VC6.0 相关的任何其他问题。有什么办法可以解决这些问题？或者是时候改变编译器了？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-09T09:32:27.327

坦率地说，我很难理解您为什么不购买现代计算机并切换到 Visual Studio 2008。

VC6 的 STL 存在缺陷、C++ 标准合规性差以及 GUI 过时。

你不应该让你的竞争对手使用比你更好的工具。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T12:31:08.520

好吧，事情就是这样。VC6 编译器很烂。但是... IDE 相当不错。

VS2005 有更好的源代码控制支持。否则，它的调试速度要慢得多，有一个糟糕的输出窗格，在插入输出行时会呈指数衰减（那是什么绝对的垃圾编码？），帮助系统慢很多倍，并且调试和继续（可能是微软优于其他 IDE 的最佳功能）破碎得多。

。网？当然，VS20xx 是唯一的出路。然而，对于一个坚持使用 VC6/MFC（用于嵌入式系统接口等）的小型客户端，我实际上很喜欢使用 VC6。这只是快速。

2008 年？我想...但是我的客户需要一段时间才能迁移。还没有人有。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-15T12:33:06.737

> 是时候告别 VC6 编译器了吗？

是的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T10:00:30.847

不费吹灰之力的答案是肯定的，并且尽快。如果成本有问题，您有免费的替代品，如 VC++ express 和 Code::Blocks。解决兼容性问题的痛苦是 IMO 没有理由不升级，因为无论如何你总有一天必须这样做，而且只会变得更难。

我看到可能存在障碍的唯一原因是，如果您的 MFC 代码移植起来很困难/耗时。在这种情况下，您不能使用 VC++ express（不支持 MFC）并且您必须至少为 VS std 进行投资。版。这将花费您大约 300 欧元（取决于您居住的地方）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-09T09:33:46.947

VC6 不能做任何类型的现代 C++。我记得我很久以前就尝试过使用其中一个 boost 库，比如可能是 Graph，它在整个地方都给出了“内部编译器错误”，所以最终我把它扔了进去。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-09T09:41:14.980

几个月前，我使用 g++ 从 VC++ 6.0 更改为 Code::Blocks（即 FOSS），并且还没有真正回头。我有点想念 VC++ 调试器，因为 CB 中的 gdb 实现远没有那么流畅，但仅此而已。IDE 中的某些东西工作得更好（代码完成、工具提示、依赖关系计算），编译器显然要好得多。

关于您的观点，函数 try 块几乎不是一个广泛使用的功能，而且大多数人认为它们毫无用处。而且`__FUNCTION__`宏不是 C++ 标准的一部分，所以如果可移植性是一个问题，你不应该过分依赖它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-27T14:00:06.190

不，十年前是时候告别它了。以下是几个原因：

*   Microsoft 和其他公司提供免费的、符合标准的编译器
*   VC6 是在 C++ 语言标准化之前编写的，它远不符合标准。特别是模板和标准库生活在自己的世界中，与这些功能在 ISO C++ 中的实际工作方式无关。它编译的语言不是 C++。它是预标准 C++、Microsoft 扩展、编译器限制和错误的混合体。这两者都不是可取的。
*   众所周知，VC6 在某些情况下会生成无效代码。它不仅编译了一种自制的、有缺陷的和非标准的语言，它还进行了无效的优化，导致崩溃，或者在某些情况下实际上产生了根本无法执行的错误程序集。

它坏了，而且它*总是*坏的。它旨在编译一种语言，该语言在编译器发布时（当语言标准化时）几乎在同一时间停止存在，即使在该任务中它也失败了，存在无数错误，*其中一些*已在六个中修复已发布的服务包。但不是全部，甚至不是所有关键的。

当然，这样做的缺点是您的应用程序很可能同样损坏。（不是因为你是糟糕的程序员，而是因为它针对一个损坏的编译器。它*必须*被损坏才能被 VC6 接受）

将其移植到符合标准的编译器可能需要做很多工作。不要以为您可以只导入旧项目，单击“构建”，它就会起作用。

因此，如果您是一家大企业的一员，不能只花一个月的时间来切换编译器，那么您可能必须将其作为一个副项目移植，而团队的一部分人正在维护 VC6 版本。在成功移植所有内容并且它可以工作之前，不要废弃 VC6。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-21T10:16:38.197

我想这就是为什么 Windows 上有这么多应用程序很糟糕的原因，因为人们仍然使用 VC6。当 wxWidgets 和 Qt4 比 MFC 好得多时，为什么还要搞砸、从未维护过的 MFC 甚至 Win32，而且您甚至可以使用 Visual Studio 2005+ 的免费附加功能

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T12:38:52.277

你可以学会忍受 VC6s 的缺点。如今，它几乎具有一定的复古魅力。多年来，我们一直在反复向客户提供一些库的“最后一个 VC6 版本”。很难与准备为反向移植和维护分支机构的额外工作付费的客户争论。但在某些时候，我们向后移植在较新 VC 中开发的新功能的成本将超过它们最终升级的成本（尤其是在更多的提升和英特尔 TBB 悄悄进入代码库的情况下）。或者至少我希望这会发生！在最坏的情况下，它会在出现片状 C++0x 支持时发生，我们将在 10 年内一直为他们提供支持......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-09T09:49:54.303

除非你有一个大程序要维护，否则是的。今天换！

VC++ 的 Express 版本可从 Microsoft 免费下载。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-09T13:33:11.833

一般规则似乎是新版本是升级，因此是值得的。

然而！您必须为它选择正确的时间，修复了很多错误，但是您需要了解标准的新错误和变体。

留出时间进行升级。升级编译器版本本身很可能是一个项目，请确保在升级之前拥有稳定的代码和良好的测试，并在完成后证明它仍然可以正常工作。

当您开始为 Vista 开发时，您可能会被迫升级，因为 VC6 不能轻松提供代码签名，并且 redist 不是 Vista 喜欢的形式。（至少要VC2K5）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-09T14:01:46.913

你会很快更新操作系统吗？当我研究将我们的应用程序迁移到 Vista 时，我发现 Vista 在 VS 2005 之前没有正式支持任何东西（VB 6 除外），并且有一页长的列表列出了 VS 2005 可能存在的小问题，这些问题可能会或可能不会咬你. 我建议推迟到 VS 2008 SP1 可用（即，当 VS 2008 真正可用时），并首先进行编译器转换。

如果该项目是为少数在旧 NT 机器上单独运行它的客户提供的特殊项目，您可能希望将其保持在 VS 6。如果您将其出售用于任何类型的一般消费，则需要将其设为 Vista-在某些时候兼容（或 7 兼容，或其他），您将需要升级。

# php - sql插入和更新问题

> ID：733499
> 
> 赞同：1
> 
> 时间：2009-04-09T09:32:07.217
> 
> 标签：php, mysql, ajax

我有一个将数据插入数据库的表单。此表单获取字段的内容，然后显示结果页面，在上下文中显示输入的信息。此页面上有一个链接可以编辑用户信息，该链接可以返回上一个表单。显然，我不想插入重复的记录。如果记录已经存在，是否有一种简单的方法来使用更新语句？我正在使用 ajax 和 php 执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T09:35:59.500

看一眼：

*   **`INSERT ... ON DUPLICATE`**：[http ://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)
*   **`REPLACE INTO`**：[http ://dev.mysql.com/doc/refman/5.0/en/replace.html](http://dev.mysql.com/doc/refman/5.0/en/replace.html)

**`INSERT ... ON DUPLICATE`**将允许您在匹配 UNIQUE INDEX 或 PRIMARY KEY 时发出 UPDATE 查询。

**`REPLACE`**工作原理完全相同，但如果找到该行，则在插入新行之前删除旧行。使用级联删除时，尤其要考虑这一点！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T09:35:55.883

MySQL 支持在 INSERT 语句中添加 ON DUPLICATE KEY UPDATE，这应该可以满足您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T09:38:18.793

假设您有一个像“用户名”或“电子邮件”这样的字段，您可以使用该字段来检查记录是否已经存在，如果存在，请更新它。

```
$res = mysql_query("SELECT primary_key FROM my_table WHERE `email` = '" . mysql_real_escape_string($email) . "'");

if($row = mysql_fetch_array($res))
{
    // Record exists, update it
    $q = "UPDATE my_table SET `username` = '" . mysql_real_escap_string($username) . "' WHERE primary_key = " . (int) $row['primary_key'];
}
else
{
    // Record doesn't exist, insert
    $q = "INSERT INTO my_table(username, email) VALUES('" . mysql_real_escape_string($username) . "', '" . mysql_real_escape_string($email) . "');";
} 
```

在上面的示例中，我假设您有一个主键字段，它是一个整数 (primary_key)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T10:40:33.310

您应该考虑使用像[http://www.ezpdo.net/blog/?p=2](http://www.ezpdo.net/blog/?p=2)这样的 ORM 在 Web 应用程序中仅在绝对必要时才应使用纯 SQL，仅出于安全原因，同时也避免像您这样的问题。

# visual-studio - 如何在 Visual Studio 配置中获取程序文件路径

> ID：733506
> 
> 赞同：0
> 
> 时间：2009-04-09T09:35:07.320
> 
> 标签：visual-studio, nunit

我按照[本](http://www.codeproject.com/KB/trace/tomaznunittests.aspx)教程使 NUnit 测试在 Visual Studio 中可调试。在调试选项中，我将“启动外部程序：”设置为 C:\Program Files\NUnit 2.4.8\bin\nunit-x86.exe。有没有办法动态获取程序文件目录以避免其他人在他们的系统上使用此解决方案时出现问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:41:50.627

环境变量 $PROGRAMFILES 保存它。Visual Studio 中的大多数属性都允许您像这样使用环境变量扩展：“$(PROGRAMFILES)\NUnit 2.4.8\”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T12:14:13.177

如果在 Windows 路径中使用，则为 %ProgamFiles%。

# java - Eclipse：将 Java 构建路径复制到不同的工作区

> ID：733518
> 
> 赞同：1
> 
> 时间：2009-04-09T09:39:22.223
> 
> 标签：java, eclipse

在 Eclipse 中，如何将 Java 构建路径复制到不同的工作区？

有人在某处写道，如果您复制项目，那么您也复制了构建路径。情况似乎并非如此。

我尝试将整个工作区复制到一个新目录。打开 Eclipse 并将其指向新目录具有所有项目和源文件，但我的项目的构建路径为空。它甚至没有用于构建的基本 Java 源文件 (java.lang.Object)。

Eclipse 3.3.0（欧罗巴）

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T09:46:16.560

构建路径存储在项目根目录中名为 .classpath 的文件中。我不知道有什么不同的方式，当然，复制目录也应该复制该文件。你如何复制项目？什么操作系统？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T12:34:34.050

要非常小心...

工作区本身只是 eclipse 中指向项目文件夹的元数据。如果项目实际上不在工作区目录中，那么您实际上并没有复制它们，只是对它们的引用。

如果您使用“将现有项目导入工作区”（即文件系统中的文件夹）而未选中“复制到工作区”复选框，或者使用现有目录创建项目，则可能会发生这种情况。

如果您将该工作区复制到另一台机器，则项目将不存在。

如果您想共享项目，最好的办法是使用源代码/版本控制（例如，subversion）并让每个人都连接到同一个存储库。

关于构建路径的另一个注意事项——如果您有一个 java 项目引用一个外部 jar，则该 jar 的绝对路径存储在构建路径中。如果共享该项目的其他人将 jar 放在他们机器上的不同位置，这可能会很糟糕。如果发生这种情况，您应该考虑在 eclipse 中使用 Classpath 变量或用户库。

你能对你在复制时尝试做的事情发表更多评论吗？

# winapi - Visual C++：如何获取 CPU 时间？

> ID：733530
> 
> 赞同：1
> 
> 时间：2009-04-09T09:42:02.437
> 
> 标签：winapi, visual-c++, mfc

如何`System Idle Process`使用 Visual C++ 以编程方式查找（在任务管理器中）显示的 CPU 时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T10:50:25.827

你想要的是这样的东西......

```
NTSTATUS hStatus;
SYSTEM_PERFORMANCE_INFORMATION             stSysPerfInfo;

hStatus = NtQuerySystemInformation(SystemPerformanceInformation, &stSysPerfInfo, sizeof(stSysPerfInfo), NULL);
if (hStatus != NO_ERROR)
{
  // Do work....
} 
```

或者看看这个“TaskManager”

[http://reactos.freedoors.org/Reactos%200.3.8/ReactOS-0.3.8-REL-src/base/applications/taskmgr/](http://reactos.freedoors.org/Reactos%200.3.8/ReactOS-0.3.8-REL-src/base/applications/taskmgr/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T11:01:15.927

我没有一个可以真正知道问题所在的窗口，但也许您可以查看 std::clock 标准函数来测量花费的 cpu 时间。如果您两次请求该时间，则可以通过常量 CLOCKS_PER_SEC 将经过时间段内的滴答数转换为秒。

结果将是您的进程花费的 CPU 时间，这与挂钟不同。在多线程应用程序中它可以更高，或者如果您的代码 _sleep_s 则更低，因为它不会花费时间。

```
void f()
{
   std::clock_t init = std::clock();
   // perform some operations
   std::clock_t end = std::clock();
   std::cout << end-init << " cpu ticks spent, or about " 
             << (end-init)/CLOCKS_PER_SEC << " seconds." << std::endl;
} 
```

这不会计入第一次测量之前的 CPU 时间，但它可以以标准方式为您提供近距离测量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T09:45:30.757

从未尝试过，但[GetProcessTimes](http://msdn.microsoft.com/en-us/library/ms683223(VS.85).aspx)似乎是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T12:02:55.483

我会使用 WMI 性能计数器，特别是 Process/%ProcessorTime/Idle。

**阅读这篇文章以了解如何在 C# 中执行此操作** [http://www.codeproject.com/KB/dotnet/perfcounter.aspx](http://www.codeproject.com/KB/dotnet/perfcounter.aspx)

在 C++ 中：http: [//msdn.microsoft.com/en-us/library/aa394558 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa394558(VS.85).aspx)

希望这能回答你的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T13:41:35.060

另请参阅我的帖子： http: [//osequal.blogspot.com/2009/03/accurate-time-measurement-for.html](http://osequal.blogspot.com/2009/03/accurate-time-measurement-for.html)。特别是查看 Intel TBB 库中 tick_count 的实现：http: [//cc.in2p3.fr/doc/INTEL/tbb/doc/html/a00199.html](http://cc.in2p3.fr/doc/INTEL/tbb/doc/html/a00199.html)

# asp.net - 在服务器场场景中实现新的消息通知功能

> ID：733536
> 
> 赞同：0
> 
> 时间：2009-04-09T09:43:30.933
> 
> 标签：asp.net, architecture, scalability

我正在开发一个基于论坛的网站，该网站还支持现场消息传递（即用户可以向其他用户发送私人消息），我想做的是通知成员是否有新消息，例如通过以粗体显示收件箱链接以及消息数量，例如**Inbox(3)**

我有点困惑如何为在服务器场上运行的网站实现这一点，用每个请求查询数据库对我来说似乎有点过头了，所以这是不可能的，可能应该为此使用共享缓存，我倾向于认为这是许多站点的共同功能，包括许多大型站点（在服务器场上运行），我想知道他们如何实现这一点，任何想法都会受到赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T09:46:54.653

SO 会缓存问题，但是每次回发都需要您的声誉。这可以通过快速写几个好的答案，然后刷新首页来看出。

问题只会每分钟左右改变一次，但你可以每次看到你的代表上升。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T13:39:19.997

Waleed，我建议您阅读有关[高可扩展性](http://highscalability.com/)的文章。他们对各种大型 Web 应用程序的架构进行了具体的案例研究。（见主页右侧的侧栏。）

这些天来的普遍共识是，在这种类型的应用程序中使用 RDBM 是一个瓶颈。也可以肯定地说，大多数高度可扩展的 Web 应用程序牺牲了一致性来实现可用性。

[本系列](http://highscalability.com/tags/perspectives)应提供有关该主题的各种观点的信息。[关于可扩展性的词](http://www.allthingsdistributed.com/2006/03/a_word_on_scalability.html)被高度引用。

在这一切中，请记住，这些人正在处理 Flickr、Amazon、Tweeter 规模问题和架构。这些解决方案与（以前接受的）规范有些根本性的背离，除非您的论坛应用程序是下一件大事，否则您可能希望首先测试传统方法以确定它是否可以处理负载。

# c# - 我应该使用 dynamic_cast 用于复制？

> ID：733537
> 
> 赞同：0
> 
> 时间：2009-04-09T09:43:42.667
> 
> 标签：c#, c++, dynamic-cast

> ### 更新1：
> 
> 更正了胡说八道的代码！感谢您的评论，我对第一个片段进行了哈希处理，哎呀。
> 
> ### 更新 2：
> 
> 还更新了问题标题，因为已指出答案没有必要使用 dynamic_cast。

我在这里想要实现的是使用强类型的深层副本；我希望能够将 Class2 复制到 Class2 的另一个实例；但是，我也想使用基础 Class1 中的 CopyTo 函数。这个想法来自我的 C# 经验，通常我只是将返回类型设为通用（参见 C# 片段）。

```
void Class1::CopyTo(Class1 *c1)
{
    // Write data in to c1 from this instance.
    c1->exampleData = exampleData;
}

// Class2 inherits Class1
Class2 *Class2::Copy()
{
    Class2 *c2a = new Class2();
    CopyTo(c2a);

    Class2 *c2b = dynamic_cast<Class2*>(c2a);
    return c2a;
} 
```

这就是我在 C# 中的方式：

```
public class Class1
{
    T Copy<T>()
        where T : Class1
    {
        /* Can't remember the best way to do this in C#;
         * basically if T was Class2 this would need to create
         * a new instance of that class, and the same goes for
         * Class1\. */         
        T copy = createNewInstance();

        // Copy the data from this to 'copy'.
        copy.exampleData = exampleData;

        return copy;
    }
} 
```

现在，与 C# 片段相比，C++ 片段感觉很臭。是否可以在没有指针的情况下执行此操作，或者这种方式是最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:47:26.760

我不清楚您在问什么，但请注意，当您说：

```
 Class2 *c2 = dynamic_cast<Class2*>(c1); 
```

强制转换的结果可能为 NULL，您必须对此进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T10:31:43.393

您应该在代码片段上多做一些工作。 ~~GetSomethingCopy 正在创建一个 Class2 类型的指针，该指针被传递给 CopyTo。CopyTo 尝试调用从未初始化的接收指针的成员函数：分段错误并且程序死亡。~~

即使这没有杀死应用程序，您也正在尝试从 Class2* 到 Class2* 的*dynamic_cast*，这几乎什么都不做。如果您打算从 CopyTo 转换返回值，您必须知道您不能在 void* 上使用 dynamic_cast。您必须更改 CopyTo 签名以返回 Class1（以便您以后可以转换它）或在 void* 上使用 static_cast。

请注意，Copy 是 Class1 中的虚函数，实际上在 Class2 中执行并创建了 Class2 对象，否则返回的元素将不是 Class2，而是 Class1。

CopyTo 方法的名称令人困惑，因为它不是复制*到*参数，而是从参数中复制。

毕竟，我仍然不知道你在问什么。您想在哪里使用堆栈内存？您可以将堆栈分配的元素传递给函数，但是将指针/引用返回到堆栈分配的元素又是一个分段错误：当函数结束时对象将被销毁，并且接收器将留下一个悬空的指针/引用。

现在，如果您的问题是关于是否可以在堆栈分配的元素上使用 dynamic_cast 更具理论性，您可以（假设 Class2 继承自 Class1）：

```
void f()
{
   Class2 c2;
   Class1 &c1 = c2; // c1 is a Class1 reference to a Class2 object

   dynamic_cast<Class2&>(c1).class2method(); 
   // or:
   dynamic_cast<Class2*>(&c1)->class2method();
} 
```

如果您更新代码，请在此答案中发表评论，以便我注意到并在今晚更正它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T09:46:30.007

如前所述，该代码没有任何意义……无论如何，如果您不使用 void* 作为 return ，我“猜想”您可以使用静态强制转换？

好的，现在代码有意义了。

您不需要任何动态转换，它已经属于 Class2 类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T09:48:09.550

在您的 CopyTo 函数中，您将返回一个指向在堆栈上创建的对象的指针 - 这是不可能的，因为指针指向的对象将在函数返回时被销毁。

在回答您的问题时，您可以使用`dynamic_cast`指针或引用。`new`在您的情况下，我可能会使用而不是在堆栈上分配要动态返回的对象，然后您可以安全地返回一个指针。但是，我倾向于将 using`dynamic_cast`视为潜在的代码异味，以及应该使用虚函数的标志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T09:55:22.980

不，dynamic_cast 仅适用于指针和引用。无论如何，您都无法安全地返回您在堆栈上分配的任何内容，因此我不确定在这种情况下您打算如何修改代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T12:49:35.730

我不确定您要实现什么，因为代码仍然没有多大意义。但是，我相信以下内容应该近似于您正在尝试做的事情。请注意，我*不*使用堆内存：这不是必需的，它会泄漏内存。

```
template <typename T>
T Class1::Copy()
{
    T instance;
    CopyTo(&instance);
    return instance;
} 
```

这是有效的，因为您将（多态）指针传递`instance`给`CopyTo`.`Class1`

然后你可以这样调用代码：

```
Class2 x1;
// Fill x1
Class2 x2 = x1.Copy<Class2>(); 
```

但是，这段代码*仍然*有异味，因为它不是惯用的 C++：在 C++ 中，您通常会编写一个复制构造函数。后期绑定的`Copy`方法确实存在，但它们很少需要，并且上面不是后期绑定的（但您的 C# 代码也不是）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T12:51:01.390

啊，现在问题很清楚了。从技术上讲，答案是否定的，不是 dynamic_cast<>，但我真的不明白你为什么想要它。看来你只是想要

```
void Class1::CopyTo(Class1& c1)
{
    // Write data in to c1 from this instance.
    c1.SomeIntValue = SomeIntValue;
}

// Class2 inherits Class1
Class2* Class2::Copy()
{
    Class2 *c2 = new Class2();
    CopyTo(*c2);
    return c2;
}
//or more idiomatic
Class2 Class2::Copy()
{
    Class2 c2
    CopyTo(c2);
    return c2;
} 
```

# c# - 使用 codedom 在 C# 中以编程方式生成代码

> ID：733539
> 
> 赞同：-1
> 
> 时间：2009-04-09T09:44:56.657
> 
> 标签：c#, codedom

我想生成用于创建哈希表对象并为其分配键和值 programmatic 的代码。它应该类似于

```
Hashtable ht = new Hashtable();

ht.Add( "key1", "value1" );
ht.Add( "key2", "value2" );
ht.Add( "key3", "value3" ); 
```

例如

```
CodeMemberMethod testMethod = new CodeMemberMethod();

        testMethod.Name = "Test" + mi.Name + "_" + intTestCaseCnt;
        testMethod.Attributes = MemberAttributes.Public;..... 
```

在这里它以编程方式创建一个方法现在我想创建一个哈希表所以我问如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T09:55:53.573

对于代码生成，请考虑[文本模板转换工具包](http://www.olegsych.com/2007/12/text-template-transformation-toolkit/)(T4)

这个模板...

```
Hashtable ht = new Hashtable();
<#
    foreach (var obj in DataSource)
    {
#>
ht.Add( "<#= obj.Key #>", "<#= obj.Value #>" );
<#
    }
#> 
```

...将生成此输出...

```
Hashtable ht = new Hashtable();
ht.Add( "key1", "value1" );
ht.Add( "key2", "value2" );
ht.Add( "key3", "value3" );
...
ht.Add( "keyN", "valueN" ); 
```

其中 N 是数据源中的记录数。

**最棒的是，它内置于 Visual Studio 2008**

我有很好的经验

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T10:52:05.170

你被困在哪里了？您知道如何创建 CodeMemberMethod，因此您应该能够将语句对象添加到 CodeMemberMethod.Statements 集合中。您需要一个用于变量声明的语句，一个用于赋值/初始化的语句，以及一个用于每个“Add”-Call 的语句。

顺便说一句：我过去使用过 Code DOM，但发现直接使用模板引擎生成代码的工作量更少，并且使代码更具可读性。我通常使用[StringTemplate](http://www.stringtemplate.org/ "字符串模板")，对此我很满意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:42:36.590

```
CodeParameterDeclarationExpression hashTableParam =new CodeParameterDeclarationExpression();
hashTableParam.Name = "hastable";

hashTableParam.Type = new CodeTypeReference(typeof(System.Collections.Hashtable)); 
```

> 这就是我正在寻找的感谢您的努力

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T09:58:31.287

我知道的两个代码生成器是......

Codesmith 在 ...[主站点](http://www.codesmithtools.com/)，有[免费版本](http://www.codesmithtools.com/freeware.aspx)

[Scott Hanselman 的 T4 在这里](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)有一篇关于它的博客文章

# actionscript - 从动作脚本动画中保存动画 gif

> ID：733554
> 
> 赞同：0
> 
> 时间：2009-04-09T09:50:31.417
> 
> 标签：actionscript, graphics, animation, gif

是否可以将 .fla 文件保存为动作脚本动画中的动画 gif？我知道您可以很容易地从补间动画中做到这一点，但无法从脚本动画中找到一种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T23:37:34.483

我不是 100% 确定我理解你的问题。

如果您想从 Flash IDE 将动作脚本动画写入文件，您可以尝试使用 quicktime(.mov)，方法是选择：文件 > 导出影片并选择 QuickTime 作为输出格式。这将允许您将动作脚本的呈现保存到文件中。Lee Brimlow 的方便视频可[在此处](http://www.gotoandlearn.com/play?id=89)获得。

我认为不可能从 IDE 中为 actionscript 保存 gif，但如果必须使用 GIF，您可以尝试使用 actionscript 将其渲染到您将提供给 GIFEncoder 的 BitmapData 对象数组中。

看看[Thibault Imbert 的这款有趣且易于使用的 GIF 编码器](http://www.bytearray.org/?p=93)。我发现它很容易上手。

玩得开心！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-14T23:38:01.573

如果您仍然好奇，请查看[将 SWF 转换为 GIF 文件](https://stackoverflow.com/questions/6351305/converting-swf-into-gif-file/6351313)

# c# - 如何在 C# 中创建数据网格？

> ID：733556
> 
> 赞同：0
> 
> 时间：2009-04-09T09:51:39.697
> 
> 标签：c#, winforms, datagrid

我想将 DataGrid 添加到窗体。当程序执行时，用户输入值，我在问题中使用这些值。对于具有两列的表，我需要一个类似的实现，当用户输入值时，我使用它们在程序中进行计算。

不需要将这些值保存到数据库中，它们只会在程序中使用。

我如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T09:58:39.307

在winforms环境下，可以绑定强类型集合作为数据源；集合中对象的每个属性构成一列（严格来说，我相信它会计算出集合返回的类型的属性，而不是其中的单个项目）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T10:06:33.860

如果您正在编写 WinForms 应用程序，那么您可以使用 DataTable 来存储数据并使用 DataGridView 来显示它。只需创建数据表：

```
dataTable = new DataTable(); 
```

以编程方式创建您需要的列：

```
var columnSpec = new DataColumn();
columSpec.DataType = typeof(decimal);  // If it holds a decimal
columSpec.ColumnName = "Interest Rate";
dataTable.Columns.Add(columnSpec); 
```

使用设计器将 DataGridView 添加到表单 - 但不要在创建表后使用以下方法将其绑定到网格：

```
dataGridView.DataSource = dataTable; 
```

您可以从设计器视图中设置网格上的属性。

我在只读情况下完成了此操作，其中 DataTable 从程序中填充并仅显示它。用户所能做的就是调整列的大小、重新排序或设置列的可见性。要添加新行，您需要挂钩到`RowsAdded`事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T10:08:19.033

重新措辞罗兰·肖

您不需要将数据库绑定到数据网格。如果您将数据填充到强类型或通用集合中，则可以将数据网格绑定到集合。数据网格将填充集合中的数据。

它将属性名称作为列，行将按照集合中的行显示。

如果您想要用户输入，那么我认为您应该考虑使用更好的网格控件。数据网格不适用于此目的。我不记得 flexgrid（ocx 之一）是否已为 .Net 重做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T10:15:52.947

您可以使用 datagridview 并构建数据表并通过代码添加列，并将 datagridview 的数据源设置为此数据表，并将 Dataggridview 属性窗口中的 AllowUserToAddRows 设置为 true （ true 是默认值）。

如果要在进行完整的 ro 更新后进行计算，则可以使用 RowPrePaint 事件，或者如果希望在每个单元格中的数据更新后进行计算，则可以使用 datagridview 的 CurrentCellChanged 事件。

希望这可以帮助....

# jquery - jQuery: Batiste 富文本编辑器——如何更新内容？

> ID：733559
> 
> 赞同：2
> 
> 时间：2009-04-09T09:54:28.147
> 
> 标签：jquery, richtext, rte

我正在使用这个轻量级的 jQuery 插件来创建一个富文本编辑器：[Batiste RTE jQuery Plugin](http://batiste.dosimple.ch/blog/posts/2007-09-11-1/rich-text-editor-jquery.html "Batiste RTE jQuery 插件")

作为更复杂表单的一部分，我具有*清除更改*的功能，我也希望能够为编辑器执行此操作。

我将初始内容保存在一个变量中，我想做类似的事情：setContent(INITIAL_CONTENT)，但我找不到访问 RTE 对象的方法，因为 `$("textarea").rte(some-options-here)`返回的是`textarea`对象而不是`rte`对象。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T15:33:00.347

RTE 用 iframe 替换 textarea 但保持相同的 ID。要访问 iframe 的内容，请尝试这样的操作。

```
$("#textarea_ID").contents().find("body").html(INITIAL_CONTENT); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T18:18:29.983

我只想附和 Shaun 在这里所说的话，但我也想举一个实际的例子。请注意，此示例所做的其中一件事是将 INITIAL_CONTENT 存储在全局变量中，因为 RTE 控件替换了文本区域，而不是隐藏它，我觉得这有点令人不安。

如果您担心它位于全局变量中，您可能会在创建 DOM 后将初始内容存储在 DOM 的某个成员中，但这对于您的目的可能是不必要的。

您正在尝试完成的示例：http: [//jsbin.com/ixipu](http://jsbin.com/ixipu)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T16:25:13.350

您可以从 iframe 中获取正文，然后设置/获取内容：

```
var $R = function(sel, newContent) {
    return $('body', $(sel).contents()).html(newContent || undefined); 
};
var iframe = $('iframe.rte-zone')[0];
alert($R(iframe)); // alerts the RTE's content
$R(iframe, '<strong>Lorem <em>ipsum</em></strong>'); // sets the content of the RTE to "<strong>Lorem <em>ipsum</em></strong>" 
```

如果您愿意，您也[可以查看一些示例。](http://jsbin.com/ifunu)

干杯:)

# authentication - 站点如何安全地支持 http（非 SSL）会话？

> ID：733564
> 
> 赞同：2
> 
> 时间：2009-04-09T09:56:03.620
> 
> 标签：authentication, session, cookies, https, gmail

我注意到某些网站（例如 gmail）允许用户通过 https 进行身份验证，然后切换到带有非安全 cookie 的 http 以用于该网站的主要用途。

怎么可能对会话进行 http 访问，但这仍然是安全的？还是它不安全，因此这就是为什么 gmail 提供了使用 https 保护整个会话的选项？

请举例说明其工作原理并避免会话劫持攻击，同时仍允许通过 http 访问经过身份验证的内容。如果它是安全的，我希望能够实施这样的方案，以避免出于性能原因必须将整个站点设置为 https。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T10:00:58.270

只有在密码不以明文形式传输的情况下，它才是安全的。在 HTTP 模式下拦截和滥用 GMail 会话 cookie 是可能的（并且已经完成）。

为避免会话劫持，您需要保持 HTTPS 模式（我认为是 GMail 现在提供的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T10:13:05.870

正如蒂洛所说，但我会进一步解释：）

网络服务器是无状态的！这确实是身份验证案例的问题。您不能只是登录，然后说“从现在开始，此用户已登录” - 您需要某种方式来确定这次请求新站点的用户是哪个用户。

一种常见的方法是实现会话。如果您在登录时对网络流量进行数据包嗅探，然后浏览网站，您通常会注意到以下内容：

登录：您将把您的用户名和密码传送到服务器。完全未加密！（SSL / HTTPS 将为您加密此请求以避免中间人攻击）

响应：您将收到一个随机生成的包含许多奇怪字符的字符串。这些通常会存储在 cookie 中。

只有您应该有权访问的某些站点的请求：您将随机生成的字符串传输到服务器。服务器将查找此字符串，并查看它是否与您的会话相关联。这允许服务器识别您，并授予您访问您的站点的权限。

.. 现在，HTTP 本身并不安全。这意味着您的密码和会话 cookie（随机生成的字符串）将完全不加密地传输。如果有人可以访问您的流量（通过木马、路由器劫持等），如果您不使用 HTTPS，他将能够在您登录时看到您的用户名/密码。这将授予他访问您网站的权限，直到您更改密码（除非他先更改密码：P）。在其余的请求中，他将能够获取您的会话 cookie，这意味着他可以在该 cookie 生命周期的剩余时间里窃取您的身份（直到您注销，或者服务器上的会话到期）。

如果您想感到安全，请使用 HTTPS。但实际上，将键盘记录器社会工程到您的计算机中比读取所有流量要容易得多:)

（或者正如其他人指出的那样，使用跨站点脚本来读取您的会话 cookie）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T10:05:31.317

这比纯 HTTP 稍微安全一点——登录名/密码不会以纯文本形式传输。除此之外，它的工作方式与普通的基于 HTTP cookie 的会话完全一样（因为它就是这样）；因此，所有会话劫持问题都适用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T10:06:10.723

这不是真的可能而且不安全。这就是我们得到“安全cookies”的原因。虽然它可以很好地抵御被动嗅探攻击，因为用户名/密码不会被暴露，但是会话劫持仍然是可能的。

另请查看此[SSL 实施安全常见问题解答](http://www.slideshare.net/fmavituna/ssl-implementation-security-faq)文件。

# winforms - 自动调整 WinForms RichTextBox 的内容

> ID：733566
> 
> 赞同：14
> 
> 时间：2009-04-09T09:56:05.477
> 
> 标签：winforms, richtextbox, autosize

有谁知道如何动态调整 RichTextBox 控件的大小以适应其内容？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-05-17T11:22:30.990

我想我为时已晚，但看看[这个](http://www.pcreview.co.uk/forums/autosize-textbox-richtextbox-t2290246.html)

这只是两行代码：

```
private void rtb_ContentsResized(object sender, ContentsResizedEventArgs e)
{
    ((RichTextBox)sender).Height = e.NewRectangle.Height + 5;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-18T16:14:46.223

再次假设固定字体，您可以执行以下操作：

```
using (Graphics g = CreateGraphics())
{
    richTextBox.Height = (int)g.MeasureString(richTextBox.Text,
        richTextBox.Font, richTextBox.Width).Height;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T18:27:54.937

这有点痛苦——使用 C# RichTextBox 经常令人沮丧。您是否尝试将框的大小设置为足够大以容纳其内容而无需任何滚动条？

如果 RichTextBox 具有恒定字体，则可以使用 TextRenderer.MeasureText 简单地测量所需的大小，并将框的宽度作为约束传入。

ContentsResized 事件给你一个 ContentsResizedEventsArgs，它给你一个 NewRectangle，告诉你文本区域有多大。但它仅在文本更改时触发，如果您只是想测量现有的richtextbox（尽管您可能只是做一些hacky，例如将框的文本设置为自身，触发此事件）。

还有一堆 Win32 api 调用，比如使用 EM_GETLINECOUNT ( [http://ryanfarley.com/blog/archive/2004/04/07/511.aspx](http://ryanfarley.com/blog/archive/2004/04/07/511.aspx) ) 等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-07T13:11:15.897

一个非常便宜的解决方案（一个可能充满问题的解决方案）是同时使用相同字体和大小的文本填充自动调整标签，然后只需将标签的宽度复制到 RTB 的宽度。

所以，像这样：

```
RichTextBox rtb = new RichTextBox();
rtb.Text = "this is some text";
rtb.Font = new Font("Franklin Gothic Medium Cond", 10, FontStyle.Regular);

Label fittingLabel = new Label();
fittingLabel.Text = rtb.Text;
fittingLabel.Font = rtb.Font;
fittingLabel.AutoSize = true;

//Not sure if it's necessary to add the label to the form for it to autosize...
fittingLabel.Location = new Point(-1000,-1000);
this.Controls.Add(fittingLabel);

rtb.Width = fittingLabel.Width;

this.Controls.Remove(fittingLabel); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-23T14:46:54.357

我找到了富文本框高度问题的解决方案..我已将其修改为一般用途..

**在您的应用程序中创建以下结构......**

```
[StructLayout(LayoutKind.Sequential)]
    public struct RECT {
        public Int32 left;
        public Int32 top;
        public Int32 right;
        public Int32 bottom;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct SCROLLBARINFO {
        public Int32 cbSize;
        public RECT rcScrollBar;
        public Int32 dxyLineButton;
        public Int32 xyThumbTop;
        public Int32 xyThumbBottom;
        public Int32 reserved;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 6)]
        public Int32[] rgstate;
    } 
```

在您的类中为表单创建以下私有变量（您需要计算富文本高度的地方）

```
private UInt32 SB_VERT = 1;
        private UInt32 OBJID_VSCROLL = 0xFFFFFFFB;

        [DllImport("user32.dll")]
        private static extern
            Int32 GetScrollRange(IntPtr hWnd, UInt32 nBar, out Int32 lpMinPos, out Int32 lpMaxPos);

        [DllImport("user32.dll")]
        private static extern
            Int32 GetScrollBarInfo(IntPtr hWnd, UInt32 idObject, ref SCROLLBARINFO psbi); 
```

**将以下方法添加到您的类中以获取表单**

```
private int CalculateRichTextHeight(string richText) {
            int height = 0;
            RichTextBox richTextBox = new RichTextBox();
            richTextBox.Rtf = richText;
            richTextBox.Height = this.Bounds.Height;
            richTextBox.Width = this.Bounds.Width;
            richTextBox.WordWrap = false;
            int nHeight = 0;
            int nMin = 0, nMax = 0;

            SCROLLBARINFO psbi = new SCROLLBARINFO();
            psbi.cbSize = Marshal.SizeOf(psbi);

            richTextBox.Height = 10;
            richTextBox.ScrollBars = RichTextBoxScrollBars.Vertical;

            int nResult = GetScrollBarInfo(richTextBox.Handle, OBJID_VSCROLL, ref psbi);
            if (psbi.rgstate[0] == 0) {
                GetScrollRange(richTextBox.Handle, SB_VERT, out nMin, out nMax);
                height = (nMax - nMin);
            }

            return height;
        } 
```

您可能需要修改上述方法以使其按照您的要求工作...确保将 Rtf 字符串作为参数发送给方法不是普通文本，并确保将可用宽度和高度分配给方法中的 Richtextbox 变量。 .

您可以根据需要使用 WordWrap...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-23T21:36:21.660

如本答案所述，使用[GetPreferredSize](https://stackoverflow.com/a/2365687/603828)更容易。然后您无需等待 ContentsResized 事件。

# django - 如何在 Django 管理界面中显示外部链接？

> ID：733569
> 
> 赞同：3
> 
> 时间：2009-04-09T09:57:48.590
> 
> 标签：django, django-admin

我需要在管理界面网格列中生成外部链接，但它们显示为 html 代码：

```
<a href="http://www.site.com/">site</a> 
```

管理界面将我的链接翻译为 html-entities 并且它们没有显示为正确的链接。是否可以在那里显示外部链接，而不是 html 代码？

我认为*list_display_links*不适用于此目的。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T10:09:34.990

[只需在http://docs.djangoproject.com/en/dev/ref/contrib/admin/#list-display](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#list-display)中走得更远

```
def colored_name(self):
    return '<span style="color: #%s;">%s %s</span>' % (self.color_code, self.first_name, self.last_name)
colored_name.allow_tags = True 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-05T00:07:45.410

在 Django 2.0 中执行此操作的正确方法是将字符串标记为安全 HTML。更好的是使用`format_html()`这样 Django 仍然可以逃避参数。

```
from django.utils.html import format_html

def my_link_field(self):
    return format_html(
            '<a href="{0}">{1}</a>',
            self.my_external_url,
            self.my_link_display_name,
        ) 
```

# python - 访问元组列表

> ID：733574
> 
> 赞同：3
> 
> 时间：2009-04-09T09:59:02.427
> 
> 标签：python

我有一个包含几个元组的列表，例如：

```
[('a_key', 'a value'), ('another_key', 'another value')] 
```

其中第一个元组值充当字典键。我现在正在寻找一种类似 python 的方式来访问键/值对，例如：

`"mylist.a_key"`或者`"mylist['a_key']"`

无需遍历列表。有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-09T10:03:41.540

如果没有任何迭代，你就无法做到这一点。您将需要迭代将其转换为字典，此时密钥访问将成为可能，无需迭代，或者您需要为每个密钥访问对其进行迭代。转换为 dict 似乎是更好的主意——从长远来看它更有效，但更重要的是，它代表了你实际看待这个数据结构的方式——作为键和值对。

```
>>> x = [('a_key', 'a value'), ('another_key', 'another value')]
>>> y = dict(x)
>>> y['a_key']
'a value'
>>> y['another_key']
'another value' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T10:07:28.990

如果您自己生成列表，则可以在源代码中将其创建为字典（允许键、值对）。

否则，我认为 Van Gale 的 defaultdict 是要走的路。

编辑：

如评论中所述，此处不需要 defaultdict ，除非您需要处理诸如列表中具有相同键的多个值之类的极端情况。尽管如此，如果您最初可以将“列表”生成为字典，那么您就不必在之后对其进行迭代。

# css - 你如何显示可以切换的项目（UI）

> ID：733575
> 
> 赞同：4
> 
> 时间：2009-04-09T09:59:41.520
> 
> 标签：css, usability, togglebutton

假设我有一些用户可以切换的状态，例如**[ON]** | **[关闭]**。

通常，我使用 ONE 开关 (BUTTON)，当它**打开**时，用户会看到：

灯光**[开]**

当它**关闭**时，他们看到

灯光**[关闭]**

我的问题是：应该单击**[ON]**将灯**[OFF]**是否明显（明智） ？

你怎么做呢？任何想法或想法表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T10:12:59.117

我会使用标签和按钮来显示操作。

灯亮 -**关闭？**

单击该按钮会将标签和按钮更改为：

灯熄灭 -**打开？**

该解决方案清楚地说明了可用的状态和操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T10:04:00.837

如果您关心的是清晰度，我肯定会包含类似复选框的控件的概念。这是一个被广泛接受的界面组件，大多数人都理解。

在任何情况下，您都可以使整行可点击，这样当我点击文本时它也会切换（就像 HTML 标签元素一样）。

显示仅带有“ON”文本的按钮可能会使用户感到困惑，无论它是打开灯还是当前状态为“on”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T10:17:24.783

一张图说一千个字……

根据应用程序的类型，显示可以单击以设置字段状态的电灯开关图像可能更直观？

然后你可以有一个灯泡打开和灯泡关闭的图像来显示状态。

不是每个人都知道复选框是什么；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T13:08:42.610

您可以使用单选框，这是相当标准的控件，不应该让大多数人感到困惑。

```
<input type="radio">Light on<br>
<input type="radio">Light off 
```

另一种选择是尝试实现某种开关按钮，就像在 iPhone 上使用的这样一个：

[iPhone 中的切换按钮 - 关闭 http://www.poolworksbvi.com/POOL_CONTROL/Pool1_files/iphone_switch.png](http://www.poolworksbvi.com/POOL_CONTROL/Pool1_files/iphone_switch.png)

[iPhone 上的切换按钮 - 在 http://www.poolworksbvi.com/POOL_CONTROL/Pool1_files/iphone_switch+on%20copy.png](http://www.poolworksbvi.com/POOL_CONTROL/Pool1_files/iphone_switch+on%20copy.png)

# html - 如何仅将几个 url 的一部分显示到一个 html 文件中？

> ID：733580
> 
> 赞同：1
> 
> 时间：2009-04-09T10:01:54.290
> 
> 标签：html, frameset-iframe

过去我使用的是 iframe，但它完整显示了所有网页 url 内容。

例如：我将以下代码保存在名为“trial.html”的文件中：

```
<iframe src="http://stackoverflow.com/unanswered" width=1100 height=1500></iframe>
<iframe src="http://stackoverflow.com/questions" width=1100 height=1500></iframe> 
```

**当我在 Firefox 中加载我的文件“trial.html”时，它会正确显示两个 url。;)**

* * *

但是，例如，我希望我的网页**只显示第一个 url 的右上角“投票”部分（灰色）**。我注意到它有以下代码：

```
<div class="module">
        <div class="summarycount" style="text-align: left;">11,308</div>
        <p>questions with <b style="color: maroon;">no upvoted answers</b></p>

        <p>The highest voted unanswered questions appear first, then the most recent ones. </p>        
    </div> 
```

* * *

**是否可以只显示部分*`<div class="summarycount"`*或 *`<div class="module">`*部分？**

提前致谢 ;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T10:15:27.393

框架只是另一个视口，与您的基本浏览器窗口相同，视口所做的只是提供一个显示文档的位置。整份文件。

如果您想解析一个文档，或者实际上是许多文档，以挑选并选择其中的部分并合并到另一个文档中，您将不得不使用服务器端语言来加载这些文档并为您进行手术。与往常一样，我推荐 XSLT 用于文档格式良好的情况，但每种语言都能够做到这一点。

如果您真的*想要*一个游击选项，如果您可以控制文档并且您不担心 x 域，您可以执行一些 JS DOM 操作以从 iframe 加载的文档中读取并将重要节点复制到父文档中，随时删除 iframe，但它不像干净或可靠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:27:37.627

我认为这也可以解决问题（但对于机器人不跟随 html 文件网站，恕我直言不会这样做）：

## 

使用 Google Docs 构建网页监视器并自动跟踪更改 [http://www.labnol.org/internet/monitor-web-pages-changes-with-google-docs/4536/](http://www.labnol.org/internet/monitor-web-pages-changes-with-google-docs/4536/)

# sql - sql连接问题

> ID：733581
> 
> 赞同：0
> 
> 时间：2009-04-09T10:02:08.673
> 
> 标签：sql, mysql

我有两张桌子，拍卖和用户。

我想从类别 = x 的拍卖中选择用户名表，然后从用户表中选择字段 a、b 和 c，其中用户中的用户名字段与拍卖中的用户名字段匹配。

我正在尝试这个：

```
SELECT AUCTIONS.USERNAME, USERS.firstname, USERS.lastname, USERS.flaggedauctions
FROM AUCTIONS
INNER JOIN USERS
ON AUCTIONS.USERNAME=USERS.USERNAME 
```

这似乎有效。但是，USERNAME 不是任何一个表中的主键，并且在拍卖表中可以有许多具有相同用户名的记录，因为用户表中的每个用户名只有一条记录。

上面的查询有效，但是如果我想将结果集限制为 10 来进行分页，就会出现问题。这可能会导致返回 10 条记录，其中一些是重复的。有没有办法在另一个查询中运行限制为每个姓氏 1 条记录的查询？

编辑：回答Quassnoi的帖子

用户名始终是唯一的

如果我有

```
Auctions:
    username    category    blah
    -------------------------------------
    user1       category1   tshirt
    user2       category2   jeans
    user3       category3   shoes
    user2       category3   belt
    user3       category3   pants

Users:
    username    firstname   lastname
    -------------------------------------
    user1       john        smith
    user2       fred        black
    user3       alice       brady

Then given category 3 as the category, I would want to show:

    username    firstname   lastname
    -------------------------------------
    user2       fred        black
    user3       alice       brady

With username coming from the auctions table.

Instead, at the moment this will display:

    username    firstname   lastname
    -------------------------------------
    user2       fred        black
    user3       alice       brady
    user3       alice       brady 
```

编辑2：

我在用

```
SELECT username, firstname, lastname
FROM USERS
WHERE username
IN (

SELECT USERNAME
FROM AUCTIONS
WHERE category = 'fake'
)
LIMIT 0 , 30 
```

返回 0 个结果。AUCTIONS 中肯定有许多记录的类别设置为假。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T10:10:00.170

我建议使用`SELECT DISTINCT`，但我宁愿问你这个问题：

给定表格：

```
AUCTION     USERNAME
--------    -------
Sotheby's   john
Christie's  john

USERNAME   FIRSTNAME LASTNAME
--------   --------  --------
john       John      Doe
john       John      Davis 
```

，你想被选中的`Sotheby's`原因是什么`Christie's`？

除非您回答此问题，否则无法理解“*运行查询限制为每个用户名 1 条记录的方式*”是什么意思。

**更新：**

```
SELECT  *
FROM    users
WHERE   username IN
        (
        SELECT  username
        FROM    auctions
        WHERE   category = 'category3'
        ) 
```

**更新 2：**

此查询是否返回某些内容？

```
SELECT  u.username, u.firstname, u.lastname
FROM    auctions a, users u
WHERE   a.category = 'fake'
        AND u.username = a.username 
```

**更新 3：**

```
SELECT  ao.username, u.firstname, u.lastname
FROM    (
        SELECT  DISTINCT username
        FROM    auctions a
        WHERE   category = 'fake'
        ) ao
LEFT JOIN
        users u
ON      u.username = a.username 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T10:07:41.423

使用`SELECT DISTINCT`而不是`SELECT`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T10:08:02.950

如果我理解正确，使用`SELECT DISTINCT`代替`SELECT`将解决您的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T10:11:26.967

英语不是我的母语，但如果我理解正确，您想选择所有在给定类别 x 中进行拍卖的用户（一次）。

我不确定这种语法是否适用于 MySQL，但请尝试以下操作：

```
SELECT
    AUCTIONS.USERNAME,
    USERS.firstname,
    USERS.lastname,
    USERS.flaggedauctions
FROM
(
    SELECT DISTINCT 
        AUCTIONS.USERNAME
    FROM
        AUCTIONS
    WHERE
        AUCTIONS.CATEGORY = x
) AS AUCTIONS
INNER JOIN 
    USERS
ON 
    USERS.USERNAME = AUCTIONS.USERNAME 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T11:22:56.733

你可以简单地使用

```
SELECT DISTINCT
    a.username,
    u.firstname,
    u.lastname
FROM 
    Users u
RIGHT JOIN
    Auctions a
    ON
    u.username = a.username
WHERE
    a.category = 'category3' 
```

# sql-server-2005 - How to delete a stubborn SQL 2005 Maintenance Plan

> ID：733587
> 
> 赞同：2
> 
> 时间：2009-04-09T10:04:21.150
> 
> 标签：sql-server-2005

Our SQL 2005 server has a Maintenance Plan that cannot be deleted.

When I try and delete it via Management Studio I get the following error:

> An exception occurred while executing a Transact-SQL statement or batch. (Microsoft.SqlServer.ConnectionInfo) -> The SELECT permission was denied on the object 'sysmaintplan_plans', database 'msdb', schema 'dbo'. (Microsoft SQL Server, Error: 229)

Its SQL 2005 Enterprise Edition version 9.0.3042.0

I have been able to modify the plan so that it doesn't do anything, but I can't rename it or delete it.

I have a hunch that this might be something to do with Service Pack 2, as the Maintenance Plan may have been created before SP2 was applied, and I've heard some people had problems with that scenario.

edit: I am logged in as sa

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T09:48:36.360

Thanks to SqlACID for the suggestion to fix this (see the question comments)

I had been using Management Studio on a separate machine.

Running Management Studio on the Server itself (and logging in as SA) allowed me to delete the stubborn Maintenance Plan.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:34:14.287

I was not able to delete a Maintenance Plan because of a permission issue. *"Authentication failed for user SA"* - and I was logged in as SA using Management Studio on the server.

Here is how I was able to fix the problem:

*   Open the problem Maintenance Plan.
*   Add a new (empty) Subplan.
*   Delete the first (existing) Subplan.

As a precaution I also did this:

*   Click the *Manage Connections* button.
*   Click *Edit* in the Manage Connections dialog box.
*   Overwrite the SA user name and password.
*   Click *OK* > *Close* to get back to the Maintenance Plan.

Finally

*   Save the Maintenance Plan.
*   Delete the Maintenance Plan.

Hope this helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-13T00:40:30.987

I did not have success with Pete's suggestion, but I did have success following the steps here: [https://social.msdn.microsoft.com/forums/sqlserver/en-US/ae6f809f-ef74-4534-8327-b7b120a2d700/unable-to-delete-a-sql-2005-maintenance-plan](https://social.msdn.microsoft.com/forums/sqlserver/en-US/ae6f809f-ef74-4534-8327-b7b120a2d700/unable-to-delete-a-sql-2005-maintenance-plan)

see the post by kahil kahalas:. it says:

You can also delete SQL 2005 Maintenance Plan using T - Sql.

We need to perform the below steps to delete the jobs or maintenance plans in such cases from sysmaintplan_log table or from sysmaintplan_subplans table .

Step 1: Execute the below query to obtain the Maintenance plan name and Id SELECT NAME, ID FROM MSDB..SYSMAINTPLAN_PLANS

(make sure msdb is selected for steps 2, 3 & 4)

Step 2: Replace the Id obtained from Step 1 into the below query and delete the entry from log table DELETE FROM SYSMAINTPLAN_LOG WHERE PLAN_ID=' '

Step 3: Replace the Id obtained from Step 1 into the below query and delete the entry from subplans table as shown below, DELETE FROM SYSMAINTPLAN_SUBPLANS WHERE PLAN_ID = ' '

Step 4: Finally delete the maintenance plan using the below query where ID is obtained from Step1 DELETE FROM SYSMAINTPLAN_PLANS WHERE ID = ' '

Step 5: Check and delete the jobs from SSMS if it exists.

(I had to go into Jobs Activity Monitor and delete it from there.)

Hope it helps u!

Kapil Khalas

# wpf - 如何使 WPF 资源样式在运行时可切换？

> ID：733605
> 
> 赞同：12
> 
> 时间：2009-04-09T10:10:08.577
> 
> 标签：wpf, xaml, styles

我在 WPF 中使用了样式资源，因此在我的 App.xaml 中我可以定义是使用客户还是管理员布局。通过以类似 HTML/CSS 的方式从主 XAML 中获取所有样式，这可以很好地工作。

**现在如何使这个动态化**，以便我可以单击应用程序中的按钮并在运行时在客户和管理员之间切换布局？

# 附录：

感谢 Meeh 的链接，所以我做了这个，当我调试时，它会遍历所有行但**仍然不会改变布局**，我还需要做什么才能在运行时改变布局？

```
private void Button_Switch_Layout_Click(object sender, RoutedEventArgs e)
{
    string layoutIdCode = "administrator";

    switch (layoutIdCode)
    {
        case "administrator":
            langDictPath = "Resources/AdministratorLayout.xaml";
            break;

        case "customer":
            langDictPath = "Resources/CustomerLayout.xaml";
            break;
    }

    Uri langDictUri = new Uri(langDictPath, UriKind.Relative);
    ResourceDictionary langDict = Application.LoadComponent(langDictUri) as ResourceDictionary;
    Application.Current.Resources.MergedDictionaries.Clear();
    Application.Current.Resources.MergedDictionaries.Add(langDict);
} 
```

## 原始代码：

* * *

**应用程序.xaml：**

```
<Application x:Class="TestMvvm8837.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    StartupUri="Window1.xaml">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Resources/CustomerLayout.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Application.Resources>
</Application> 
```

**Window1.xaml：**

```
<Window x:Class="TestMvvm8837.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Style="{StaticResource MainWindow}"
    Title="Resource Test" >
    <DockPanel>

        <Grid Style="{StaticResource Form}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBlock Style="{StaticResource FormLabel}" Grid.Column="0" Grid.Row="0" Text="First Name" />
            <TextBlock Style="{StaticResource FormLabel}" Grid.Column="0" Grid.Row="1" Text="Last Name" />
            <TextBlock Style="{StaticResource FormLabel}" Grid.Column="0" Grid.Row="2" Text="E-Mail" />

            <TextBox Grid.Column="1" Grid.Row="0"/>
            <TextBox Grid.Column="1" Grid.Row="1"/>
            <TextBox Grid.Column="1" Grid.Row="2"/>

            <Button Style="{StaticResource FormSaveButton}" Grid.Column="1" Grid.Row="3" Content="Save"/>

        </Grid>

    </DockPanel>
</Window> 
```

**管理员布局.xaml：**

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Style x:Key="MainWindow" TargetType="{x:Type Window}">
        <Setter Property="Width" Value="800"/>
        <Setter Property="Height" Value="600"/>
    </Style>

    <Style x:Key="Form" TargetType="{x:Type Grid}">
        <Setter Property="Margin" Value="20"/>
    </Style>

    <Style x:Key="FormLabel" TargetType="{x:Type TextBlock}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="FontFamily" Value="Verdana"/>
        <Setter Property="FontSize" Value="14"/>
    </Style>

    <Style TargetType="{x:Type TextBox}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="Width" Value="200"/>
        <Setter Property="HorizontalAlignment" Value="Left"/>
        <Setter Property="VerticalAlignment" Value="Top"/>
    </Style>

    <Style x:Key="FormSaveButton" TargetType="{x:Type Button}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="FontFamily" Value="Verdana"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Width" Value="100"/>
        <Setter Property="HorizontalAlignment" Value="Left"/>
        <Setter Property="VerticalAlignment" Value="Top"/>
        <Setter Property="Cursor" Value="Hand"/>
    </Style>

</ResourceDictionary> 
```

**客户布局.xaml：**

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Style x:Key="MainWindow" TargetType="{x:Type Window}">
        <Setter Property="Width" Value="600"/>
        <Setter Property="Height" Value="480"/>
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush EndPoint="1.156,1.133" StartPoint="-0.033,0.019">
                    <GradientStop Color="#FFFFFFFF" Offset="0"/>
                    <GradientStop Color="#FF4FADD3" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="Form" TargetType="{x:Type Grid}">
        <Setter Property="Margin" Value="5"/>
    </Style>

    <Style x:Key="FormLabel" TargetType="{x:Type TextBlock}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="FontFamily" Value="Verdana"/>
        <Setter Property="FontSize" Value="10"/>
    </Style>

    <Style TargetType="{x:Type TextBox}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="Width" Value="200"/>
        <Setter Property="HorizontalAlignment" Value="Left"/>
        <Setter Property="VerticalAlignment" Value="Top"/>
    </Style>

    <Style x:Key="FormSaveButton" TargetType="{x:Type Button}">
        <Setter Property="Margin" Value="10"/>
        <Setter Property="FontFamily" Value="Verdana"/>
        <Setter Property="FontSize" Value="10"/>
        <Setter Property="Width" Value="100"/>
        <Setter Property="HorizontalAlignment" Value="Left"/>
        <Setter Property="VerticalAlignment" Value="Top"/>
        <Setter Property="Cursor" Value="Hand"/>
    </Style>

</ResourceDictionary> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T14:26:56.680

您需要[`DynamicResource`](http://msdn.microsoft.com/en-us/library/ms748942(v=vs.110).aspx)在 Window1.xaml 内部使用，而不是[`StaticResource`](http://msdn.microsoft.com/en-us/library/ms750950(v=vs.110).aspx). `StaticResource`只评估一次，而`DynamicResource`实际监听变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T10:25:26.340

你应该：

*   使用已在其中定义新样式的 XamlReader 加载资源字典
*   从加载的资源中获取对新样式的引用（ newStyle = (Style)resource["styleName])
*   在控件上设置新样式：control.Style = newStyle

高温高压

再见

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-18T13:20:08.527

您可以使用 ContentControl - 在这里它根据 ViewType 变量更改 xaml。

```
<ContentControl Style="{StaticResource ScriptsViewTemplate}" VerticalAlignment="Stretch" />   

<Style x:Key="ScriptsViewTemplate" TargetType="ContentControl">
<Style.Triggers>
  <DataTrigger Binding="{Binding Path = ViewType,Mode=TwoWay}" Value="True">
    <Setter Property="Template" Value="{StaticResource ScriptsTreeViewTemplate}"/>
  </DataTrigger>
  <DataTrigger Binding="{Binding Path = ViewType,Mode=TwoWay}" Value="False">
    <Setter Property="Template" Value="{StaticResource ScriptsListViewTemplate}"/>
  </DataTrigger>
</Style.Triggers>
</Style> 
```

# wcf - 在 wcf 中使用远程事件

> ID：733607
> 
> 赞同：3
> 
> 时间：2009-04-09T10:10:12.103
> 
> 标签：wcf, events

我想将事件从服务器应用程序传递到多个客户端。由于我使用 wcf 向客户端公开服务接口，因此我查看了 wcf 异步回调机制，但它似乎不支持将一条消息分派给多个客户端。MSMQ 是实现向多个客户端传递事件的更好方法吗？

谢谢。

**=== 编辑 ===**

使用 MSMQ 我能够实现我所需要的。

我的服务器应用程序创建了一个队列，客户端从中获取消息。客户端使用 MessageQueue 提供的 peek 方法。这使队列中的消息可用于其他客户端。

为避免消息填满队列，服务器发送消息时将属性 TimeToBeReceived 设置为非常低的值，从而导致消息过期。

真可惜MSMQ不提供JMS之类的topic

**=== 编辑 2 ===**

毕竟在 WCF 中实现发布者订阅者模式很简单。

这两篇文章（[article1](http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx)，[article2](http://dotnetaddict.dotnetdevelopersjournal.com/wcf_alarmclock.htm)）描述了如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T10:16:36.720

您正在尝试做的事情称为发布者订阅者多播。不，如果不编写大量样板代码，您将无法在 WCF 中执行此操作。MSMQ 也不支持多播。

看看（所有免费和开源的）NServiceBus、MassTransit 或 Rhino Service Bus，如果你可以不使用 WCF。如果您必须使用 WCF，请查看[Neuron](http://www.neuronesb.com/)（商业产品）。

# windows - windows窗体中的主窗体

> ID：733608
> 
> 赞同：3
> 
> 时间：2009-04-09T10:10:13.087
> 
> 标签：windows, winforms, forms

像 ASP.NET 中的母版页一样，我们是否对 Windows 窗体应用程序有任何类似的概念。这样我就不必在整个应用程序中多次重复表单的相同部分（页眉和页脚）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T10:15:24.570

是的。

您需要做的是创建您的“主”表单，添加您想要的所有 UI、默认按钮等。

对于按钮之类的东西，我通常将处理 Click 事件的方法创建为“虚拟”，以便我可以以我正在构建的实际形式实现它们。

构建“主”表单后，您需要做的是右键单击项目并选择“新建项目”。完成此操作后，如果您使用的是 VS.Net 2008，则可以单击“Windows 窗体”类别，然后选择“继承的窗体”。

完成后，您将被要求从项目中的哪个表单继承。只需选择“主”表格，您就应该设置好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T10:15:45.757

将主窗体创建为带有页眉和页脚的窗体，但中间留空。

使用通用界面将“内页”实现为*UserControl*，并根据需要进行更改。（页眉、内容面板和页脚是 Windows.Form.Panel）。

```
-------------------------------
| Header                      |
-------------------------------         ______________
|                             |         |            |
|         ContentPanel        |   <---- | MonkeyEdit |
|                             |         |____________|
-------------------------------
| Footer                      |
------------------------------- 
```

并将内容实现为

```
public class MonkeyEdit : UserControl, IContent
{

} 
```

实现一个接口是有用的，但不是必需的。之后，根据事件/配置，只需使用Dock.Fill 将*MonkeyEdit*加载到*ContentPanel*中。正如您在另一篇文章中看到的那样，您也可以继承“主表单”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T10:14:44.183

与母版页并不完全相同，但您可以创建一个带有页眉和页脚的控件（例如基于[UserControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx)），您的所有其他表单都可以根据需要继承（或构造）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T10:16:08.250

您可以通过继承实现类似的目标；您创建一些带有重复控件的父表单，然后将此父表单用于您需要的每个自定义表单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T10:18:11.973

添加一个继承自 Form 的类，添加页眉和页脚（在代码中），然后让所有新表单都继承自该类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T14:24:01.837

母版页具有指定将嵌入页面的内容区域的能力。因此，从表格 A 派生表格，例如表格 B 并获取父表格的特征并不能证明这一点。Boj 提到的更有意义，我们在哪里使用面板。

# sql-server-2005 - 如果组件已安装，则无人值守安装 SQL Server 2005 会出现工作站组件错误

> ID：733618
> 
> 赞同：1
> 
> 时间：2009-04-09T10:15:22.700
> 
> 标签：sql-server-2005, installation, inno-setup

我之前问过类似的问题，但从未解决，所以我又来了！

我有一个无人值守的 SQL Server 2005 安装，当在尚未安装 SQL Server 的机器上安装 SQL Server 时效果很好。

我在执行安装时使用以下参数（这是通过 Inno Setup 自动安装的）：

```
#define SQL_SILENT                    "/passive /qb"
#define SQL_USERNAME                  "username=MyUserName"
#define SQL_COMPANYNAME               "companyname=MyCompanyName"
#define SQL_ADDLOCAL                  "ADDLOCAL=SQL_Engine"
#define SQL_UPGRADE                   ""
#define SQL_DISABLENETWORKPROTOCOLS   "disablenetworkprotocols=0"
#define SQL_INSTANCENAME              "instancename=MYSQLINSTANCE"
#define SQL_SQLAUTOSTART              "SQLAUTOSTART=1"
#define SQL_SECURITYMODE              "SECURITYMODE=SQL"
#define SQL_SAPWD                     "SAPWD=StrongPassword"
#define SQL_SQLACCOUNT                "SQLACCOUNT="""""
#define SQL_SQLPASSWORD               "SQLPASSWORD=""""" 
```

它可以毫无问题地安装 SQL Server Express 的实例。但是，当我尝试在已经有另一个带有工作站组件的实例的机器上安装 SQL Server 时，我收到以下错误：

“您在 ADD_LOCAL 属性中指定的组件已安装。要升级现有组件，请参阅 template.ini 并将 UPGRADE 属性设置为组件的名称。”

我也尝试过根据错误消息使用 UPGRADE 方法

```
#define SQL_UPGRADE       "UPGRADE=SQL_Engine INSTANCENAME=MYSQLINSTANCE" 
```

但得到以下错误：

“SQL Server 安装程序无法执行升级，因为该组件未安装在计算机上。要继续，请验证当前安装的要升级的组件，并且在 ADDLOCAL 属性中指定了要升级的组件。”

我可以从添加/删除程序（Vista 中的程序和功能）中手动删除工作站组件，并且安装工作正常，但这不是我每次都想手动执行的操作。特别是如果它安装在使用这些组件的 PC 上。

对于如何阻止在无人值守安装期间显示此错误的任何建议，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-16T10:44:33.787

要解决上述问题，我必须确保首先卸载组件和工具。

但是，这不再相关，因为我将安装 SQL Server 2008，我相信它会遇到更多问题！

# ruby-on-rails - 重命名 ActiveRecord/Rails 的 created_at、updated_at 列

> ID：733630
> 
> 赞同：15
> 
> 时间：2009-04-09T10:20:07.307
> 
> 标签：ruby-on-rails, activerecord, timestamp

我想重命名 timestamp.rb 中定义的时间戳列。timestamp.rb 的方法可以被覆盖吗？以及在使用具有覆盖方法的模块的应用程序中必须做什么。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-19T16:24:02.500

我认为 NPatel 的方法是一种正确的方法，但如果您只需要在单个模型上更改 #created_at，它就做得太多了。由于 Timestamp 模块包含在每个 AR 对象中，因此您可以按模型覆盖它，而不是全局覆盖它。

<= 导轨 5.0

```
class User < ActiveRecord::Base
  ...
  private
  def timestamp_attributes_for_create
    super << :registered_at
  end
end 
```

导轨 ~> 5.1

```
 private_class_method
  def self.timestamp_attributes_for_create
    # only strings allowed here, symbols won't work, see below commit for more details
    # https://github.com/rails/rails/commit/2b5dacb43dd92e98e1fd240a80c2a540ed380257 
    super << 'registered_at' 
  end
end 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-10-20T19:29:36.370

这可以通过重写 ActiveRecord::Timestamp 模块方法来完成。实际上并没有覆盖整个模块。我需要完成与使用遗留数据库相同的目标。我在 Rails 3 上，我已经开始遵循一种方法，如何通过重写 rails 功能来修补我的代码。

我首先创建了我正在使用的基础项目，并在初始化程序中创建了一个名为该文件的文件。在这种情况下，我创建了 active_record.rb。在文件中，我放置了代码来覆盖两个控制时间戳的方法。以下是我的代码示例：

```
module ActiveRecord
    module Timestamp      
      private
      def timestamp_attributes_for_update #:nodoc:
        ["updated_at", "updated_on", "modified_at"]
      end
      def timestamp_attributes_for_create #:nodoc:
        ["created_at", "created_on"]
      end      
    end
  end 
```

**注意：**我还想提一下，这种让事情正常工作的猴子补丁是不受欢迎的，并且可能会在升级时中断，所以要小心并充分意识到你想要做什么。

更新：

*   [每个api 更改](https://github.com/rails/rails/commit/2b5dacb43dd92e98e1fd240a80c2a540ed380257)将时间戳列名称从符号更改为字符串。感谢 Techbrunch 让我注意到这个 API 更改。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-09-11T13:17:35.327

**Rails >= 5.1**的更新anwser 。我建议`ApplicationRecord`在您的应用程序中使用默认可用的，并定义以下内容：

```
class ApplicationRecord < ActiveRecord::Base
  self.abstract_class = true

  class << self
    private

    def timestamp_attributes_for_create
      super << 'my_created_at_column'
    end

    def timestamp_attributes_for_update
      super << 'my_updated_at_column'
    end
  end
end 
```

**请注意**，如果您不想为所有模型配置此模块，也可以在特定模型上使用此模块。

**另请注意**，您应该使用字符串而不是符号。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-08-12T22:28:03.937

您可以使用 beforesave 和 beforecreate 方法将 DateTime.now 发布到您指定的列。

```
class Sample < ActiveRecord::Base
  before_create :set_time_stamps
  before_save :set_time_stamps

  private
  def set_time_stamps
    self.created_column = DateTime.now if self.new_record?
    self.updated_column = DateTime.now
  end
end 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-09T16:22:13.057

快速丑陋的 hack，从 Milan Novota 的回答中详细说明：将以下内容附加到 environment.rb，用所需的列名替换 CREATED_COL 和 UPDATED_COL 常量的值：

```
 module ActiveRecord
  module Timestamp
    CREATED_COL = 'created_at'
    UPDATED_COL = 'updated_at'
    private
      def create_with_timestamps #:nodoc:
        if record_timestamps
          t = self.class.default_timezone == :utc ? Time.now.utc : Time.now
          write_attribute(CREATED_COL, t) if respond_to?(CREATED_COL) && send(CREATED_COL).nil?
          write_attribute(UPDATED_COL, t) if respond_to?(UPDATED_COL) && send(UPDATED_COL).nil?
        end
        create_without_timestamps
      end

      def update_with_timestamps(*args) #:nodoc:
        if record_timestamps && (!partial_updates? || changed?)
          t = self.class.default_timezone == :utc ? Time.now.utc : Time.now
          write_attribute(UPDATED_COL, t) if respond_to?(UPDATED_COL)
        end
        update_without_timestamps(*args)
      end
  end
end 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-09T10:33:01.143

没有简单的方法可以做到这一点。您可以通过覆盖 ActiveRecord::Timestamp 模块或编写您自己的模块来为您实现这一点。

[这是](http://github.com/rails/rails/blob/63aac338332a06d3c9e28dde7954679703ec7620/activerecord/lib/active_record/timestamp.rb)魔术的工作原理。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-13T09:38:43.693

在 rails 4.2 中执行此操作的正确语法

```
class User < ActiveRecord::Base
...

private

    def timestamp_attributes_for_create
        super << 'date_add'
    end

    def timestamp_attributes_for_update
        super << 'date_update'
    end
end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-09T19:37:55.253

或者您可以创建自己的列 (DateTime)，并在创建时手动设置 created_at 列，并在更新时设置 updated_at 列。这可能比上面的 hack 更容易。这就是我要做的。更好的是，更新 rails 以允许我们更改这些名称。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-02T21:53:15.603

不使用猴子补丁的解决方案；[`reversible`](http://edgeguides.rubyonrails.org/active_record_migrations.html#using-reversible)在迁移期间使用该块：

```
class CreateTest < ActiveRecord::Migration
  def change

    create_table :test do |t|
    end

    # set the timestamp columns default to now()
    reversible do |dir|
      dir.up do
        tables = [
          :test
        ]
        tables.each do |t|
          execute <<-SQL
            ALTER TABLE #{t.to_s}
              add column created timestamp without time zone default now();
          SQL
          execute <<-SQL
            ALTER TABLE #{t.to_s}
              add column updated timestamp without time zone default now();
          SQL
        end
      end
      dir.down do
        # no need to do anything, the rollback will drop the tables
      end
    end

  end
end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-14T20:56:06.517

在 Rails 6.0 中，实例方法`timestamp_attributes_for_create`不再存在。这个方法被推到类方法级别，现在是私有的

[https://apidock.com/rails/v6.0.0/ActiveRecord/Timestamp/ClassMethods/timestamp_attributes_for_create](https://apidock.com/rails/v6.0.0/ActiveRecord/Timestamp/ClassMethods/timestamp_attributes_for_create)

此提交引入了此更改[https://github.com/rails/rails/commit/77ff9a0adbd1318b45203a76c64561b115245603](https://github.com/rails/rails/commit/77ff9a0adbd1318b45203a76c64561b115245603)

您仍然可以覆盖`self.timestamp_attributes_for_create`，但我强烈建议不要这样做，因为可以更改私有 API，而无需另行通知或更大的版本颠簸。

对于 Rails 6，我没有看到给定的“Rails 方式”来定义自定义`created_at`/`updated_at`列。

我建议遵循这个答案[https://stackoverflow.com/a/18197702/924050](https://stackoverflow.com/a/18197702/924050)

# sharepoint - 复制文档库 sharepoint 2003 包含历史记录

> ID：733633
> 
> 赞同：0
> 
> 时间：2009-04-09T10:21:24.103
> 
> 标签：sharepoint, wss

我有一个包含 15000 多个文档的 sharepoint 2003 文档库。现在我想存档它，以获得更快的性能。

如何复制包含内容和历史记录的文档库？我认为 stsadm 是可能的，就像 2007 一样。但那是不对的。

有没有人有保留版本历史的经验？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T12:00:58.653

您需要开发一个应用程序来执行此操作，因为它不是开箱即用的。好消息是可以通过 API 访问过去的版本。

我再也找不到很多在线 SharePoint 2003 文档，但我认为版本历史记录功能在 2007 年没有太大变化。请查看：[SPListItem.Versions Property](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.versions.aspx)。

# visual-studio - MS Visual Studio 2008 Professional：如何禁用其他项目的网络服务器？

> ID：733635
> 
> 赞同：0
> 
> 时间：2009-04-09T10:22:54.990
> 
> 标签：visual-studio, webserver

我正在使用 Visual Studio 2008 专业版。在我的解决方案中，我有大约 8 个项目。当我在处理 1 个项目并将这个项目设置为我的启动项目并想要调试这个项目时，我得到了 7 个网络服务器，它们都有不同的端口。

我不想要这个，我只想让我正在调试的项目只启动一个网络服务器。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T10:28:14.337

在 IDE 的项目属性中，有一个“调试时始终启动”属性。将此设置为 false，然后只会启动您实际调试的那个。在解决方案资源管理器中选择项目节点，然后查看“属性”窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T10:27:35.120

您可以使用“配置管理器”来禁用您不想调试的项目。

# .net - 对 WinForms 使用“Microsoft Chart Controls for .NET 3.5”，如何使用网格标记和标签标记某些日期？

> ID：733638
> 
> 赞同：2
> 
> 时间：2009-04-09T10:25:56.747
> 
> 标签：.net, charts, microsoft-chart-controls

我正在使用 Microsoft 图表控件，并沿 X 轴显示带有日期的数据，并希望在某些日期有一条不同颜色的网格线。

假设我显示一周的数据，X 轴上有 7 个值：

05.04.09 06.04.09 07.04.09 08.04.09 09.04.09 10.04.09 11.04.09

此外，我收集了一些事件的日期时间和名称，其中一个在 07.04.09，另一个在 10.04.09。然后，我想在每个日期上绘制一条垂直网格线，并添加一个带有事件名称的标签。

我只是不知道我怎么能做到这一点。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T10:36:06.667

我通过订阅 PostPaint 事件解决了这个问题。在事件处理程序中，我只需自己绘制线条并将标签添加到这些垂直线的顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-15T08:58:03.573

```
chartName.Series["seriesName"].Points[index]["Color"] 
  = System.Drawing.Color.Blue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T10:34:40.610

据我所知，您无法更改图表网格中特定线条的颜色。一个暂定的解决方案可能是添加一个 Column 类型的新图表系列；您要突出显示的日期中的系列值非零。这是一种解决方法，但它可能是一个起点。至于标签，我不知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T12:43:19.037

到目前为止，我已经设法通过在辅助 X 轴上使用 CustomLabels 来实现它，并在该轴上用我想要的颜色绘制刻度线。现在的主要问题是让两个 X 轴同步，以便 CustomLabels 最终到达我想要它们的位置，因为它们目前最终有点分散。

# visual-studio - 使用多个项目创建 BizTalk 解决方案

> ID：733639
> 
> 赞同：1
> 
> 时间：2009-04-09T10:26:33.857
> 
> 标签：visual-studio, biztalk

有没有人得到任何指导，更好的是生成“入门” BizTalk 解决方案的工具？

我一直在阅读各种博客、文章等，它们主要用于将解决方案拆分为单独的项目，一个用于模式，一个用于编排等。

我想遵循这种做法，但是创建全套设备很痛苦，所以我想知道是否有办法轻松设置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T15:42:05.647

认为我已经付出了代价，请查看[BSF的 BizTalk 软件工厂](http://bsf.codeplex.com/)

一个问题，确保您获得正确版本的 GAT ...
- MSI 安装程序将您指向 2007 年 7 月的页面
- 但您需要 2008 年 2 月的版本
- 有[正确 GAT的链接](http://bsf.codeplex.com/Thread/View.aspx?ThreadId=34226)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:38:56.167

我们使用应用程序来划分功能区域，然后使用项目来划分人工制品类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T20:43:08.653

如果您围绕功能区域而不是工件类型来组织项目，从长远来看，您会更快乐。否则，恐怕您会发现变更管理是一场噩梦。最近，人们倾向于将项目细分为工件类型的文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-06T11:17:41.230

我认为这是一个依赖、部署和可接受的停机时间的问题。如果您拆分地图、模式和编排，您将没有机会独立部署不同的流程。因此，具有“孤立”的集成域更有意义。BizTalk 项目应按功能创建并包含所有必要的工件。提取共享资源并定义部署顺序以适应依赖项。

就停机时间而言，请记住，您必须在部署后重新启动主机实例，这可能会影响其他集成过程。

# asp.net - ASP.NET 网站中的计划作业，无需购买专用服务器

> ID：733643
> 
> 赞同：3
> 
> 时间：2009-04-09T10:29:09.263
> 
> 标签：asp.net, scheduling, scheduled-tasks

如何在共享托管服务器上按照配置的计划时间执行各种任务（例如电子邮件警报/发送新闻信）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T10:34:03.903

这是一个 Global.ascx.cs 文件，我过去曾经做过这种事情，使用缓存到期来触发计划任务：

```
public class Global : HttpApplication
{
    private const string CACHE_ENTRY_KEY = "ServiceMimicCacheEntry";
    private const string CACHE_KEY = "ServiceMimicCache";

    private void Application_Start(object sender, EventArgs e)
    {
        Application[CACHE_KEY] = HttpContext.Current.Cache;
        RegisterCacheEntry();
    }

    private void RegisterCacheEntry()
    {
        Cache cache = (Cache)Application[CACHE_KEY];
        if (cache[CACHE_ENTRY_KEY] != null) return;
        cache.Add(CACHE_ENTRY_KEY, CACHE_ENTRY_KEY, null,
                  DateTime.MaxValue, TimeSpan.FromSeconds(120), CacheItemPriority.Normal,
                  new CacheItemRemovedCallback(CacheItemRemoved));
    }

    private void SpawnServiceActions()
    {
        ThreadStart threadStart = new ThreadStart(DoServiceActions);
        Thread thread = new Thread(threadStart);
        thread.Start();
    }

    private void DoServiceActions()
    {
        // do your scheduled stuff
    }

    private void CacheItemRemoved(string key, object value, CacheItemRemovedReason reason)
    {
        SpawnServiceActions();
        RegisterCacheEntry();
    }
} 
```

目前，这会每 2 分钟触发一次您的操作，但这可以在代码中进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:07:07.193

有些人在这里通过在 global.asax 中创建线程来做到这一点。听起来他们在这方面取得了成功。我自己从未测试过这种方法。

在我看来，这将是一个更好的选择，然后重载缓存过期机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-26T11:54:10.897

You can use [ATrigger](http://atrigger.com/) scheduling service on a **shared hosting without any problem**. A [.Net library](http://atrigger.com/docs/wiki/13/library-net) is also available to create scheduled tasks without overhead.

Disclaimer: I was among the ATrigger team. It's a freeware and I have not any commercial purpose.

# html - 空格删除影响排名？

> ID：733644
> 
> 赞同：0
> 
> 时间：2009-04-09T10:29:37.907
> 
> 标签：html, seo

我最近尝试从我的 HTML 代码中删除所有无用的空格/换行符/换行符，结果显然我的网站被除名/谷歌排名急剧下降（从前 10 名到肯定超出前 100 名）。删除空格是一种不好的 SEO 做法，还是我的页面在删除空格后关键字密度太高？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T12:55:36.293

HTML 是独立于空白的——只要你有有效的 HTML，它是否有空白都没有关系。只需查看 Google.com 的来源即可。

因此，请检查您的 HTML 是否经过验证，并且您还没有创建完全无法解析的内容。如果谷歌无法解析它，他们就无法阅读，也无法对你进行排名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T20:00:16.657

删除不必要的空白将减少网页**的加载时间，这是非常积极的。**

我不认为删除空格会影响您的排名，它一定是其他原因。你最近有没有做其他更新？

正如亚当所说，看看谷歌的源代码，他们已经删除了所有的空格以节省加载时间。

# matlab - nargin 与存在

> ID：733646
> 
> 赞同：12
> 
> 时间：2009-04-09T10:31:40.553
> 
> 标签：matlab

给定一个函数，如：

```
function foo(myParam)
if nargin<1
  myParam = 'default value';
end % if
end % function 
```

我见过人们使用类似下面的东西来代替 nargin 版本

```
if ~exist('myParam', 'var')
  myParam = 'default value';
end %if 
```

我想知道是否有任何偏好？

对我来说，“~exist...”版本的优势在于，如果我更改函数参数的顺序，那么它应该仍然可以工作。然而，我对这种方法的担忧是，在嵌套函数的情况下，我可能会无意中拾取全局定义或在周围函数范围内定义的变量。

对这个问题有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T12:33:10.823

两者都应该工作。但...

Exist 往往很慢，因为它必须在您的工作区中查找有问题的变量。当您编写这样的错误检查时，您不希望它们占用 CPU 周期。针对 nargin 的测试是针对单个数值的简单测试。

我通常还建议进行更广泛的测试。就像是

```
if (nargin<1) || isempty(myparam)

  myparam = defaultvalue;

elseif

  ...

end 
```

在 elseif 分支中，我将进行一组额外的测试，以查看参数是否具有预期的大小、形状、变量类别等。如果这些测试失败，我将返回一条友好的错误消息，解释错误所在.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T11:17:53.173

我会选择 nargin 有两个原因：

1.  如果您将参数的顺序更改为函数，则修复输入检查代码将是您最少的问题；您还必须将所有调用站点更新为您的函数。

2.  nargin 便宜得多。存在，即使只检查变量，也必须扫描整个工作区，并在此过程中进行一堆字符串比较。nargin 方法仅包含一个小于操作的标量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T12:53:47.047

我总是使用 来验证参数`nargchk`，然后`nargin`按照你的方式进行测试。正如其他人指出的那样，它们更便宜，而且我认为更清楚。

在我希望大量重用的函数中，我总是先进行大量检查，然后构建代码以便稍后调用真正的实现。

我也倾向于`varargin`像这样构造可选参数（不使用时）：

```
function x = myfcn( arg1, opt_arg2 )
if nargin < 2
   arg2 = 'default';
else
   arg2 = opt_arg2;
end 
```

因为我认为这使得在编辑文件时哪些参数应该是可选的变得更加明显。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T14:08:27.663

[由于SCFrench](https://stackoverflow.com/questions/733646/nargin-vs-exist/733772#733772)列出的原因，我会选择[NARGIN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/nargin.html)选项。另一个好处：当我有超过 2 个输入参数时，我经常发现自己将它与[SWITCH语句结合使用：](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/switch.html)

```
function outArgs = my_fcn(inArg1,inArg2,inArg3)
  switch nargin,
    case 0,  % No input case
      error('Not enough inputs!');
    case 1,  % Set last 2 inputs to default
      inArg2 = 'yes';
      inArg3 = 'on';
    case 2,  % Set last input to default
      inArg3 = 'on';
  end
  ...
  % Checking of variable types and values would go here! 
  ...
end 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-08-22T17:19:35.993

**对于那些使用 MATLAB R2007b 或更高版本的人，
这是一个更好的答案：[InputParser](https://mathworks.com/help/matlab/ref/inputparser-class.html)**

它省去了必须同步任何添加、删除、重命名和重新排序参数的麻烦。

（节省多少取决于您的编码风格，但没有比 InputParser 更简洁的方法了。）

我没有测试过它的速度，但是如果你的函数运行时间超过 1000 毫秒，就没有理由担心 InputParser 的速度。

例子：

```
function AbCdEfGhIj(ffff, ggggg, varargin)
opts = inputParser;
opts.addRequired('ffff', @(p)(ischar(p) && size(p,1)==1 || iscell(p)));
opts.addRequired('ggggg', @(p)(iscell(p) && all(cellfun(@ischar,p))));
opts.addOptional('Recursive', false, @islogical);
opts.addOptional('IncludeFullPath', logical([]), @islogical);
opts.parse(ffff, ggggg, varargin{:});
opts = opts.Results;
if isempty(opts.IncludeFullPath),
    opts.IncludeFullPath = iscell(opts.fffff) || opts.Recursive;
end 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-11-29T14:35:39.350

我非常喜欢`exist`这个`nargin`选项，原因有两个。

**1.** 在阅读了许多从未被教导过回顾自己代码的人的代码后，我对此感到更加强烈，因为`exist`它使代码具有可读性。例如，我曾经遇到过这样的函数。为方便起见，我给变量取了合理的名称：

```
[model, accuracy] = epicModelingFunction (dataMatrix, responseVector, indicatorForCategoricalVariables, optionsForInternalFunctions, typeOfDistanceCalculation, notationForMissingValues, isClassificationAndNotRegression, scalingMethod, shouldPlotAllIntermediateStuff)
% EPICMODELINGFUNCTION is actually a horrible function to read and not epic at all
% ... 
```

然后`if nargin < n`对除前两个变量之外的每个变量执行此操作。`nargin(n)`我可以在不计算标题输入的情况下遵循应该是什么的唯一原因是，`if nargin < n`总是后面跟着（有时只有几行代码和）使用默认值声明缺少的输入。对于更大的代码块`if nargin < n`，我肯定会迷失方向。

**2.** *如果从函数调用，*`exist`则不会真正检查完整的工作区。当然，比较两个数字比比较几个字符串要便宜，但是如果在函数的开头使用来填充未给定参数的默认值，那就没问题了。考虑以下函数：

 *```
function testExist(C)
if exist('B', 'var')
    disp('''exist'' in a function checks the workspace.')
elseif exist('C', 'var')
    disp('''exist'' in a function ignores the variables in the workspace, but checks the function space.')
else
    disp('''exist'' is broken or no parameter was given.')
end
end 
```

然后执行以下操作：

```
A = magic(3);
B = magic(4);
testExist(A) 
```

导致此输出：

```
'exist' in a function ignores the variables in the workspace, but checks the function space. 
```

# iphone - 我仍然可以将 App Store 与开发中的 iPod Touch 一起使用吗？

> ID：733647
> 
> 赞同：2
> 
> 时间：2009-04-09T10:31:41.990
> 
> 标签：iphone

我用谷歌搜索时似乎找不到任何帮助，所以我想是时候直接问专家了！

我有一个 iPod Touch，我将它用作我正在制作的应用程序的开发设备。我使用 iPod Touch 做的第一件事就是连接它并安装我的应用程序。

但是当我尝试从 App Store 安装下载的应用程序时，iTunes 不允许我将它们拖到设备上。我第一次尝试弹出窗口时确实出现了，但我在阅读之前不小心关闭了它，我无法让它重新出现，因为我确信它有一些有用的信息。

有人知道这笔交易吗？开发设备是您自己签名的应用程序独有的吗？

非常感谢，安迪

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T10:48:06.833

它们并非用于独家开发用途，您仍然可以使用 iPod Touch 做任何您喜欢的事情。

但请注意，某些应用程序可能对它们有设备限制。这意味着它们只能同步到某些设备。如果应用程序将设备限制设置为 iPhone，它不会同步到您的 iPod Touch。

我想确保在 iTunes 中启用了应用程序同步，并且选择了要放在设备上的应用程序（或所有应用程序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T10:37:35.330

不，他们不是。我使用 mi iPod Touch 作为 AppStore 设备的开发、音乐聆听和新应用程序。同时。iPhone 也是如此。

# sql - 从查询结果中选择随机结果样本

> ID：733652
> 
> 赞同：69
> 
> 时间：2009-04-09T10:33:22.907
> 
> 标签：sql, oracle, random-sample

[这个问题](https://stackoverflow.com/questions/652064/select-random-sampling-from-sqlserver-quickly)询问有关在 SQL Server 上获取随机（ish）记录样本的问题，答案是使用`TABLESAMPLE`. Oracle 10 中是否有等价物？

如果没有，是否有从查询集中获取随机结果样本的标准方法？例如，如何从正常返回数百万的查询中获取 1,000 行随机行？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-04-09T10:35:32.010

```
SELECT  *
FROM    (
        SELECT  *
        FROM    mytable
        ORDER BY
                dbms_random.value
        )
WHERE rownum <= 1000 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-09-19T20:11:09.553

[SAMPLE 子句](https://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10002.htm#i2065953)将为您提供表中所有行的随机样本百分比。

例如，这里我们获得了 25% 的行：

```
SELECT * FROM emp SAMPLE(25) 
```

以下 SQL（使用其中一个分析函数）将为您提供表中特定值（类似于 GROUP BY）每次出现的特定数量的随机样本。

在这里，我们每个样本 10 个：

```
SELECT * FROM (
SELECT job, sal, ROW_NUMBER()
OVER (
PARTITION BY job ORDER BY job
) SampleCount FROM emp
)
WHERE SampleCount <= 10 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-08-26T16:50:33.730

这不是一个完美的答案，但会获得更好的性能。

```
SELECT  *
FROM    (
    SELECT  *
    FROM    mytable sample (0.01)
    ORDER BY
            dbms_random.value
    )
WHERE rownum <= 1000 
```

Sample 将为您提供实际表的百分比，如果您真的想要 1000 行，则需要调整该数字。更常见的是，无论如何我只需要任意数量的行，所以我不会限制我的结果。在我有 200 万行的数据库上，我得到 2 秒和 60 秒。

```
select * from mytable sample (0.01) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-02-19T10:59:28.540

```
SELECT * FROM TABLE_NAME SAMPLE(1) 
```

会给你 olny 大约 1% 的份额，而不是正好 1/100 的观察次数。可能的原因是 Oracle 会为每个观察生成一个随机标志，以确定是否包含在它生成的样本中。在这样的生成过程中，参数 1 (1%) 扮演了每个观察被选入样本的概率的角色。

如果这是真的，样本量的实际分布将是二项式的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-06-25T09:32:17.970

样本函数用于**ORACLE**中的样本数据。所以你可以这样尝试： -

```
SELECT * FROM TABLE_NAME SAMPLE(50); 
```

这里 50 是表中包含的数据的百分比。因此，如果您想要 100000 中的 1000 行。您可以执行如下查询：

```
SELECT * FROM TABLE_NAME SAMPLE(1); 
```

希望这可以帮到你。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-08-23T12:08:07.950

我知道这已经得到解答，但是看到这里有这么多访问，我想添加一个使用 SAMPLE 子句但仍然允许先过滤行的版本：

```
with cte1 as (
    select *
    from t_your_table
    where your_column = 'ABC'
)
select * from cte1 sample (5) 
```

但是请注意，基本选择需要一`ROWID`列，这意味着它可能不适用于某些视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-30T09:42:50.013

像这样的东西应该工作：

```
SELECT * 
FROM table_name
WHERE primary_key IN (SELECT primary_key 
                      FROM
                      (
                        SELECT primary_key, SYS.DBMS_RANDOM.RANDOM 
                        FROM table_name 
                        ORDER BY 2
                      )
                      WHERE rownum <= 10 ); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-01T19:57:26.720

我们被分配从代理列表中仅选择两条记录..即在一周的跨度内为每个代理选择 2 条随机记录等....下面是我们得到的并且它有效

```
with summary as (
Select Dbms_Random.Random As Ran_Number,
             colmn1,
             colm2,
             colm3
             Row_Number() Over(Partition By col2 Order By Dbms_Random.Random) As Rank
    From table1, table2
 Where Table1.Id = Table2.Id
 Order By Dbms_Random.Random Asc)
Select tab1.col2,
             tab1.col4,
             tab1.col5,
    From Summary s
 Where s.Rank <= 2; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-03T16:55:48.170

假设您正试图从名为`my_table`. 这是一种方法：

```
select
    *
from
    (
        select
            row_number() over(order by dbms_random.value) as random_id,
            x.*
        from
            my_table x
    )
where
    random_id <= 1000
; 
```

这与@Quassnoi 发布的答案略有偏差。它们都具有相同的成本和执行时间。唯一的区别是您可以选择用于获取样本的随机数。

# java - 为什么我不能更新我的 J2ME RecordStore？

> ID：733654
> 
> 赞同：2
> 
> 时间：2009-04-09T10:34:10.780
> 
> 标签：java, java-me, midp, rms

我基本上希望我的 Midlet 能够编辑记录。

我有这个代码

添加信息如下

```
 protected void searchForNameToEdit()
 {
          Editrecord.deleteAll();

    try
    {

        rs = RecordStore.openRecordStore("Detail", true);
        RecordEnumeration re = rs.enumerateRecords(new NameMatcher(EditSearch.getString()), null, false);
        while (re.hasNextElement())
        {
            byte [] recordBuffer = re.nextRecord();
            String record = new String(recordBuffer);

            int endOfName = record.indexOf(";");
            int endOfDesc = record.indexOf(";" , endOfName + 1);
            int endOfTown = record.indexOf(";", endOfDesc + 1);
            int endOfPlace = record.indexOf(";", endOfTown + 1);
            int endOfSDay = record.indexOf("/", endOfPlace +1);
            int endOfSMonth = record.indexOf("/",endOfSDay + 1);
            int endOfSYear = record.indexOf(";", endOfSMonth + 1);
            int endOfEDay = record.indexOf("/", endOfSYear + 1);
            int endOfEMonth = record.indexOf("/", endOfEDay + 1);
            int endOfEYear = record.indexOf(";", endOfEMonth + 1);
            int endOfComment = record.indexOf(";", endOfEYear + 1);
            int endOfRating = record.indexOf (";", endOfComment + 1);
            int endOfReview = record.indexOf (";", endOfRating + 1);

            String Name = record.substring(0, endOfName);
            String Desc = record.substring(endOfName + 1, endOfDesc);
            String Town = record.substring(endOfDesc + 1, endOfTown);
            String Place= record.substring(endOfTown + 1, endOfPlace);
            String SDay = record.substring(endOfPlace +1, endOfSDay);
            String SMonth = record.substring(endOfSDay + 1, endOfSMonth);
            String SYear = record.substring(endOfSMonth + 1, endOfSYear);
            String EDay = record.substring(endOfSYear + 1, endOfEDay);
            String EMonth = record.substring(endOfEDay + 1, endOfEMonth);
            String EYear = record.substring(endOfEMonth + 1, endOfEYear);
            String Comment = record.substring(endOfEYear + 1, endOfComment);
            String Rating = record.substring(endOfComment + 1, endOfRating);
            String Review = record.substring(endOfRating + 1, endOfReview);

            EtxtName = new TextField("Name of Event: ", Name, 15, TextField.ANY);
            EdescEvent = new TextField("Describe the Event : ", Desc, 250, TextField.ANY);
            EtownEvent = new TextField("Name of Town : ", Town, 50, TextField.ANY);
            EplaceEvent = new TextField("Name of Place : ", Place, 25, TextField.ANY);
            EcommentEvent = new TextField("Any comments : ", Comment, 300, TextField.ANY);
            EStartDate = new TextField("Start Date : ", SDay + "/" + SMonth + "/" + SYear +";", 300, TextField.ANY);
            EEndDate =new TextField("End Date : ", EDay + "/" + EMonth + "/" + EYear +";", 300, TextField.ANY);
            EEventRating = new TextField("Event Rating : ", Rating, 10, TextField.ANY);
            EOverallReview = new TextField("Overall Review : ", Review, 300, TextField.ANY);

            Editrecord.append(EtxtName);
            Editrecord.append(EdescEvent);
            Editrecord.append(EtownEvent);
            Editrecord.append(EplaceEvent);
            Editrecord.append(EStartDate);
           // Editrecord.append("Start Date; " + SDay + "/" + SMonth + "/" + SYear);
            //Editrecord.append("End Date; " + EDay + "/" + EMonth + "/" + EYear);
            Editrecord.append(EEndDate);
            Editrecord.append(EcommentEvent);
            Editrecord.append(EEventRating);
            Editrecord.append(EOverallReview);

    }
        rs.closeRecordStore();
    }

    catch(Exception e)
    {
        mAlertConfirmDetailsSaved.setString("Couldn't read details");
        System.err.println("Error accessing database");
    }

    Display.setCurrent(Editrecord);

} 
```

这是执行更新的方法

```
protected void PerformUpdate()
{
    int id;

    strEName = EtxtName.getString();
    strEDescEvent = EdescEvent.getString();
    strETown = EtownEvent.getString();
    strEPlace = EplaceEvent.getString();

    strStartDate = EStartDate.getString();

    strEndDate = EEndDate.getString();

    strECommentE = EcommentEvent.getString();
    strERating = EEventRating.getString();
    strEReview = EOverallReview.getString();

        String detailsToUpdate = strEName + ";" +"\n"+
                                 strEDescEvent + ";" + "\n"+
                                 strETown + ";" + "\n" +
                                 strEPlace + ";"+ "\n" +
                                 strEStartDate + ";" + "\n" +
                                 strEEndDate + ";" + "\n" +
                                 strECommentE + ";"+ "\n" +
                                 strERating + ";"+ "\n" +
                                 strEReview + ";";

    if (listOfIDs != null)
    {

        try {
            //RecordStore
                    rs = RecordStore.openRecordStore("Detail", true);
            for (Enumeration e = listOfIDs.elements() ; e.hasMoreElements() ;)
            {
                id  = ((Integer)e.nextElement()).intValue();
                byte [] detailsBuffer = detailsToUpdate.getBytes();
             rs.setRecord(id,detailsBuffer, 0, detailsBuffer.length);

            }

            rs.closeRecordStore();

            mAlertDeleteDone.setString("  Selected record updated");

            }
        catch(Exception e)
            {
            mAlertDeleteDone.setString("Couldn't update record");
            System.err.println("Error accessing database");
            }

    } 
    else
    {
        mAlertDeleteDone.setString("No records to update");
    }

    Display.setCurrent(mAlertDeleteDone, mOpeningForm);
} 
```

我一直得到的只是没有要更新的记录的其他结果，我没有理由为什么？

请帮助或给我一个有用的教程谢谢

# sql - 从历史表中选择最近的状态

> ID：733660
> 
> 赞同：10
> 
> 时间：2009-04-09T10:37:01.600
> 
> 标签：sql, tsql

我继承了一个结构如下的表：

```
ID   Name   Timestamp   Data
----------------------------
1    A      40          ...
2    A      30          ...
3    A      20          ...
4    B      40          ...
5    B      20          ...
6    C      30          ...
7    C      20          ...
8    C      10          ... 
```

`ID``Name`是一个身份字段和主键，并且在和`Timestamp`字段上有非唯一索引。

获取每个项目名称的最新记录的最有效方法是什么，即应该返回上表中的第**1**行、**第 4**行和**第 6行，因为它们分别是项目****A**、**B**和**C**的最新条目.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-09T10:41:05.290

SQL Server 2005（更高版本）：

```
WITH MostRecentRows AS
(
    SELECT ID, Name, Data,
    ROW_NUMBER() OVER (PARTITION BY Name ORDER BY TimeStamp DESC) AS 'RowNumber'
    FROM MySchema.MyTable
) 
SELECT * FROM MostRecentRows 
WHERE RowNumber = 1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T10:48:57.267

假设每个名称没有重复的时间戳，这样的事情应该可以工作：

```
SELECT ID, Name, Timestamp, Data
FROM test AS o
WHERE o.Timestamp = (SELECT MAX(Timestamp)
                     FROM test as i
                     WHERE i.name = o.name) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T10:51:04.173

SQL Server 2000：

```
SELECT
  ID, Name, Timestamp, Data
FROM
  DataTable
  INNER JOIN
  (
     SELECT ID, MAX(Timestamp) Timestamp FROM DataTable GROUP BY ID
  ) latest ON 
    DataTable.ID = Latest.ID AND 
    DataTable.Timestamp = Latest.Timestamp 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T02:30:14.047

如果您使用的是 SQL Server 2005/2008，那么从性能角度来看，Mitch Weat 已经列出的 CTE 解决方案是最好的。但是，如果您使用的是 SQL Server 2000，那么您不能假设没有重复的 Name | 时间戳组合。使用以下代码仅返回每个名称的一条记录：

```
SELECT ID
    , Name
    , TimeStamp
    , Data
FROM DataTable dt
INNER JOIN
    (SELECT Name
    , MIN(DataTable.ID) AS MinimumID
FROM DataTable  
INNER JOIN  
    (SELECT Name
        , MAX(Timestamp) AS Timestamp 
    FROM DataTable 
    GROUP BY Name) latest 
    ON DataTable.Name = Latest.Name
    AND DataTable.Timestamp = Latest.Timestamp
GROUP BY Name) MinimumLatest
ON dt.ID = MinimumLatest.ID 
```

因此，如果您添加另一条记录，例如 9 C 30，那么这将只返回 ID 6。如果您不走这么远，那么您最终可能会返回 9 C 30 和 6 C 30。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T07:25:23.377

另一种简单的方法：

```
SELECT ID,Name,Timestamp, Data
FROM   Test_Most_Recent
WHERE Timestamp = (SELECT MAX(Timestamp)
                 FROM Test_Most_Recent
                 group by Name); 
```

# ruby-on-rails - Ruby Rails Time.change 没有像我预期的那样工作......我已经检查了文档！

> ID：733661
> 
> 赞同：4
> 
> 时间：2009-04-09T10:37:02.617
> 
> 标签：ruby-on-rails, ruby, datetime, date, time

我有一个包含一个日期元素和 3 个时间元素的表单。这是因为一个日期会发生 3 个时间事件，我不希望用户必须输入该日期 3 次。

在服务器端，我想将一个日期与 3 次结合起来得到 3 个日期时间对象。我在想我可以做类似的事情：

```
time_object.change(:day => date_object.day, :month => date_object.month, :year => date_object.year) 
```

但这没有奏效。这是我编写的一个简单的测试，我希望它可以工作：

```
 def before_validation
    logger.info("show_time = " + self.show_time.to_s)
    self.show_time.change(:year => 2012)
    self.show_time.change(:minute => 30)
    logger.info("show_time = " + self.show_time.to_s)
  end 
```

这两个打印语句应该不同，但它们是相同的。有谁知道合并时间和日期对象的最佳方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-09T11:11:09.820

你需要分配它。如果您进入脚本/控制台：

```
>> t = Time.now
=> Thu Apr 09 21:03:25 +1000 2009
>> t.change(:year => 2012)
=> Mon Apr 09 21:03:25 +1000 2012
>> t
=> Thu Apr 09 21:03:25 +1000 2009
>> t = t.change(:year => 2012)
=> Mon Apr 09 21:03:25 +1000 2012
>> t
=> Mon Apr 09 21:03:25 +1000 2012 
```

所以也许：

```
self.show_time = self.show_time.change(:year => 2012) 
```

可以为你工作。我不知道我对这个解决方案的感觉如何，但它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T16:52:54.687

另请注意，要更改您使用的分钟，`:min`而不是`:minute`

# c# - 当我将文件夹保存在某个位置时，它会存储在上面的文件夹中

> ID：733665
> 
> 赞同：0
> 
> 时间：2009-04-09T10:38:15.513
> 
> 标签：c#, file, path, directory, folderbrowserdialog

我导入一个文件，对其进行处理并将其保存在某个位置。我将我的文件保存在一个文件夹中，但它被保存在所选文件夹上方的文件夹中。这是代码，

```
 private void btnSave_Click(object sender, EventArgs e)
    {
        FolderBrowserDialog saveFile = new FolderBrowserDialog();
        saveFile.ShowNewFolderButton = true;
        if (saveFile.ShowDialog(this) == DialogResult.OK)

        {
            btnStartImport.Enabled = true;
            txtSaveBookName.Text = saveFile.SelectedPath;
            string r = Path.GetFileNameWithoutExtension(m_ImportFile);
            m_SaveDir = (txtSaveBookName.Text + r);

        }
    } 
```

m_ImportFile 给出了我们从中获取输入文件的文件的路径，我希望我保存的文件是我想要保存它的 m_ImportFile.extension 的名称。但是通过这种方法，我得到了我选择的文件夹我想要的 m_ImportFile.extension 的 .name。例如。我导入了一个文件 chh.xml，所以当我想保存它时，我想获取 chh.xuk，但是如果我选择一个文件夹 ab，那么保存文件的路径（如果 ab.chh.xuk 和该文件位于所选文件夹上方）文件夹。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T10:46:08.867

尝试：

```
m_SaveDir = Path.Combine(txtSaveBookName.Text, r); 
```

# c# - XSDObjectGen.exe 自动生成的代码中意外的 __ 前缀公共变量

> ID：733666
> 
> 赞同：0
> 
> 时间：2009-04-09T10:38:36.200
> 
> 标签：c#, xsd, code-generation, xsd.exe

我使用[XSDObjectGen.exe](http://www.microsoft.com/downloads/details.aspx?FamilyID=89E6B1E5-F66C-4A4D-933B-46222BB01EB0&displaylang=en)工具从 xsd 文件中自动生成了一些类。我的类包含额外的公共变量，使用前导下划线命名，我不知道为什么。

这是来自 xsd 文件的示例：

```
<xs:attribute name="Fare" type="xs:int" use="required">
    <xs:annotation>
        <xs:documentation>The fare price in pence</xs:documentation>
    </xs:annotation>
</xs:attribute> 
```

相应的自动生成的 C# 代码是：

```
[XmlAttribute(AttributeName = "Fare", DataType = "int")]
[EditorBrowsable(EditorBrowsableState.Advanced)]
public int __Fare;

[XmlIgnore]
[EditorBrowsable(EditorBrowsableState.Advanced)]
public bool __FareSpecified;

[XmlIgnore]
public int Fare
{
    get { return __Fare; }
    set { __Fare = value; __FareSpecified = true; }
} 
```

我了解所有这些代码，包括属性。但是，我不明白*为什么*以这种方式实施。

*   为什么这个类序列化`__Fare`而不是`Fare`属性？在这种情况下，`__Fare`变量将是私有的（并重命名`_fare`）或者可以使用自动属性。
*   `__FareSpecified`变量的目的是什么？

我们的感觉是`__`-prefixed 变量只会给使用这些类的任何开发人员增加不便，因此计划重写如下：

```
[XmlAttribute(AttributeName = "Fare", DataType = "int")]
public int Fare{ get; set;} 
```

甚至只是：

```
[XmlAttribute]
public int Fare{ get; set;} 
```

任何人都可以阐明`__`-prefixed 变量背后的基本原理吗？

请注意，我们的 xsd 文件预计不会经常更改（如果有的话），因此我们重新自动生成这些类的能力并不重要。

## 编辑

我在这里与团队仔细检查过，这个源代码实际上是使用 XSDObjectGen.exe 生成的，而不是我最初所说的 xsd.exe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T11:49:07.623

它用于区分公共财产及其支持变量。

XSD 对不可为空的类型执行 XXXSpecified 废话。

由于这样的事情，我不是 XSD 工具的特别粉丝。查看[XSDObjectGen](http://www.microsoft.com/downloads/details.aspx?familyid=89e6b1e5-f66c-4a4d-933b-46222bb01eb0&displaylang=en)或[WSDL.EXE](http://msdn.microsoft.com/en-us/library/7h3ystb6(VS.80).aspx)，看看它们是否更适合您。

# sql - 从 SQL Server 中的表中删除“第一条”记录，没有 WHERE 条件

> ID：733668
> 
> 赞同：79
> 
> 时间：2009-04-09T10:39:38.677
> 
> 标签：sql, sql-server

是否可以在不使用任何条件且不使用游标的情况下从表中删除*第一*条记录？`SQL Server``WHERE`

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-04-09T10:41:18.267

```
WITH  q AS
        (
        SELECT TOP 1 *
        FROM    mytable
        /* You may want to add ORDER BY here */
        )
DELETE
FROM    q 
```

注意

```
DELETE TOP (1)
FROM   mytable 
```

也可以工作，但是，如[**文档**](http://msdn.microsoft.com/en-us/library/ms189835.aspx)中所述：

> 与、或一起`TOP`使用的表达式中引用的行不按任何顺序排列。`INSERT``UPDATE``DELETE`

因此，最好使用`WITH`and`ORDER BY`子句，它可以让您更准确地指定您认为哪一行是第一行。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-09T10:48:01.373

取决于您的[DBMS](http://en.wikipedia.org/wiki/Dbms)

```
-- MYSql:
DELETE FROM table LIMIT 1;
-- Postgres:
DELETE FROM table LIMIT 1;
-- MSSql:
DELETE TOP(1) FROM table;
-- Oracle:
DELETE FROM table WHERE ROWNUM = 1; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-09T10:42:58.390

不，AFAIK，不可能便携。

无论如何都没有定义的“第一条”记录——在不同的 SQL 引擎上，“ `SELECT * FROM table`”很可能每次都以不同的顺序返回结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T10:45:05.450

定义“第一”？如果表有一个 PK，那么它将按此排序，您可以按此删除：

```
DECLARE @TABLE TABLE
(
    ID INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
    Data NVARCHAR(50) NOT NULL
)

INSERT INTO @TABLE(Data)
SELECT 'Hello' UNION
SELECT 'World' 

SET ROWCOUNT 1
DELETE FROM @TABLE
SET ROWCOUNT 0

SELECT * FROM @TABLE 
```

如果该表没有PK，则无法保证订购...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T10:43:00.527

这真的有意义吗？
关系数据库中没有“第一条”记录，只能随机删除一条记录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T12:43:25.247

«表中的“第一条”记录»是什么意思？我认为，关系数据库中没有“第一条记录”这样的概念。

使用 MS SQL Server 2005，如果您打算删除“顶部记录”（当您执行简单的“*select * from tablename*”时出现的第一个记录），您可以使用“ *delete top(1) from tablename* ” ...但请注意，这并不能确保从记录集中删除了哪一行，因为它只是删除了运行命令“ *select top(1) from tablename* ”时将显示的第一行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-04T17:12:22.213

与选择的答案类似，可以使用表源，在这种情况下是派生查询：

```
delete from dd
from (
    select top 1 *
    from my_table
) dd 
```

随意添加 orderbys 和条件。

对于下一个示例，我将假设对“位置”的限制是由于不想根据其值选择行。因此，假设我们要根据位置（在本例中为第一个位置）删除一行：

```
delete from dd
from (
    select
        *,
        row = row_number() over (order by (select 1))
    from my_table
) dd
where row = 1 
```

请注意， (select 1) 使其成为表或索引所在的排序顺序。您可以将其替换为 newid 以获得相当随机的行。

例如，您还可以添加分区以删除每种颜色的顶行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-21T18:57:18.910

SQL-92：

```
DELETE Field FROM Table WHERE Field IN (SELECT TOP 1 Field FROM Table ORDER BY Field DESC) 
```

# .net - 如何在嵌入式中集成 dotnet？

> ID：733672
> 
> 赞同：-3
> 
> 时间：2009-04-09T10:40:38.333
> 
> 标签：.net, embedded

如何在嵌入式中集成 dotnet？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T11:18:58.507

我不知道你需要什么。但是，我认为这听起来至少对您的问题很完美（这对帮助没有帮助）：

[http://en.wikipedia.org/wiki/.NET_Micro_Framework](http://en.wikipedia.org/wiki/.NET_Micro_Framework)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T23:09:42.220

如果您在嵌入式设备上谈论`ASP.NET`，您会发现它`.NET Compact Framework`没有内置支持`ASP.NET.`

`OpenNetCF`有一个名为[Padan](http://www.opennetcf.com/Products/Padarn/tabid/267/Default.aspx)的产品，它`ASP.NET`为`Windows CE`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-02T16:23:32.163

[Gadgeteer](http://netmf.com/gadgeteer/about.html)听起来像您所要求的。您可以将[Gadgeteer 原型板](http://www.ghielectronics.com/catalog/product/297)与[.NET Micro Framework](http://www.netmf.com/)一起使用。[在这里](http://www.ghielectronics.com/downloads/FEZ/Beginners%20guide%20to%20NETMF.pdf)您可以找到初学者指南。

# java - 为什么从数据库加载后备 bean 中的新数据后 jsf 视图没有更新？

> ID：733674
> 
> 赞同：4
> 
> 时间：2009-04-09T10:40:46.303
> 
> 标签：java, jsf, jakarta-ee

我 - 不幸的是 - 与 jsf 合作，我遇到了一个问题。我有一个 jsf 页面，它使用组件显示带有一些数据的表格`<h:dataTable>`。此表的每一行都有一个`<h:commandLink>`带有删除操作的删除该行中的项目。当我执行该操作时，支持 bean 中的方法被正确调用，包含表项的*ArrayList*被正确更新，并且在表所在的同一页面中返回的导航方法被正确执行。

但是**当页面重新加载时，表格不会更新**。我看到删除操作之前表中的相同项目。

**如果我再次重新加载页面，现在表格已更新。**

看起来就像在支持 bean 完成更新之前呈现视图一样。

如何在支持 bean 完成更新时强制渲染视图？

这里有一些代码：

jsf页面中的commandLink，在dataTable里面：

```
<h:column>
<f:facet name="header">
    <h:outputText value="Rimuovi" />
</f:facet>
<h:commandLink action="#{servicesListBean.removeServizio}" title="Rimuovi questo servizio" onclick="if(!confirm('Vuoi davvero rimuovere questo servizio?')) return false">
    <h:outputText value="Rimuovi" />
</h:commandLink>
</h:column> 
```

这里是支持 bean 中的方法：

```
public String removeServizio() {
        this.servizioToRemove = (Servizio) getDataTable().getRowData();
        try {
        ServiziDAO.removeServizio(this.servizioToRemove.getId());
        } catch (Exception e) {
            // ...
        }

        return userSessionBean.goToElencoServizi(); 
    } 
```

在这种情况下，我将**请求范围**赋予了支持 bean。我已经尝试给它会话范围并调用一个方法来更新列表，但结果是一样的。

我希望我足够清楚。提前感谢大家。

* * *

更新这个改变一切的问题

谢谢大家。正如 McDowell 所说，问题不在于呈现视图的时间，而且问题根本与 JSF 无关。

发生的事情是，当我从数据库中删除一个项目时，我没有删除该行，我只是为该项目设置了一个结束日期。这是在我的应用程序中执行此操作的正确方法，但是在将结束日期设置为我花时间使用的项目`System.currentTimiMillis()`的查询中，在重新加载更新列表的查询中，我使用`sysdate`了 Oracle 服务器的。

这两个日期之间有几分之一秒的差异，这就是为什么我在重新加载页面时可以看到更新的列表：因为已经过了一到两秒！

也许这个问题对其他人有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T11:39:16.163

> 看起来就像在支持 bean 完成更新之前呈现视图一样。

发生这种情况的唯一方法是，如果您在另一个线程中完成工作 - 但看起来您并没有这样做。

我猜，但它看起来像你的支持 bean 中的一个逻辑问题。您的*servicesListBean*是否保持状态？那是：

1.  HTTP POST
2.  生命周期的**RESTORE VIEW**阶段导致在请求范围内创建*servicesListBean*（生命周期的每个阶段都需要遍历每一行）
3.  *servicesListBean*从持久存储中获取行并将它们缓存在 bean 状态中
4.  当我们进入**INVOKE APPLICATION**阶段时，*removeServizio()*从持久存储中删除目标行，但不对缓存的 bean 状态做任何事情
5.  **RENDER RESPONSE**阶段呈现陈旧的缓存 bean状态
6.  如果你现在刷新，bean 会用新的缓存值重新创建，你会看到正确的状态

这个支持 bean 重现了这个问题：

```
public class DeleteFromRowBean {

  private ListDataModel dataModel;

  public DataModel getList() {
    if (dataModel == null) {
      List<RowBean> list = PersistenceStore.fetch();
      dataModel = new ListDataModel(list);
    }
    return dataModel;
  }

  public String deleteCurrentRow() {
    if (dataModel == null) {
      throw new IllegalStateException();
    }
    RowBean row = (RowBean) dataModel.getRowData();
    PersistenceStore.delete(row.getId());
    return null; // no navigation required
  }

} 
```

在数据表迭代时修改列表不是一个好主意（您将获得并发修改异常）。我的示例 bean 中最简单的解决方案就是释放对缓存数据的引用。**在INVOKE APPLICATION**阶段的迭代期间，数据表已经有对此的引用；当**RENDER RESPONSE**启动时，数据表将再次调用*getList()*，从而从持久存储中获取新状态。

```
public class DeleteFromRowBean {

  private ListDataModel dataModel;

  public DataModel getList() {
    if (dataModel == null) {
      List<RowBean> list = PersistenceStore.fetch();
      dataModel = new ListDataModel(list);
    }
    return dataModel;
  }

  public String deleteCurrentRow() {
    if (dataModel == null) {
      throw new IllegalStateException();
    }
    RowBean row = (RowBean) dataModel.getRowData();
    PersistenceStore.delete(row.getId());
    // flush cached data
    dataModel = null;
    return null; // no navigation required
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T11:43:39.070

如果您没有明确重定向到“另一个”页面（即使它是同一页面），您将获得旧数据。是特色。尝试类似：

```
public String removeServizio() {
    .
    .
    .
    userSessionBean.goToElencoServizi(); // if this redirects to needed page
    return null;
} 
```

# html - "display:none" 内容复制到剪贴板，粘贴时可见

> ID：733679
> 
> 赞同：10
> 
> 时间：2009-04-09T10:42:29.373
> 
> 标签：html, css, outlook, copy, paste

我遇到了将未显示的 HTML 元素复制到剪贴板，然后在将内容粘贴到 MS Word、Outlook 等时显示的问题。

例如：

```
<p>Hello</p>
<p style="display: none;">I'm Hidden</p>
<p>World</p> 
```

如果我在浏览器中查看该 HTML，将文本复制到剪贴板，然后粘贴到 Outlook 中，中间段落仍然隐藏。好消息。

但是，在此示例中：

```
<p>Hello</p>
<input type="text" value="I'm not hidden" style="display: none;" />
<p>World</p> 
```

如果我这样做 - 复制到剪贴板，粘贴到 Outlook - 文本输入*是*可见的。

有什么办法可以抑制这个吗？（没有诉诸于告诉用户在 Outlook 中选择“仅保留文本”。）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T10:52:27.383

使用 type='hidden' 而不是 type='text' 作为输入框，并将其包装在 div 中，样式设置为 display: none

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-28T20:41:08.537

听起来您需要让 JavaScript 创建 DOM 部分，而不仅仅是更改 CSS 样式。不要更改“我已隐藏”段落的显示属性，而是让 JavaScript 在您希望它显示时创建该元素，并在您希望隐藏它时将其删除。

如果元素足够复杂，那么也许您可以使用“display:none”将它们放在文档底部，然后将它们移动到您希望它们可见的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:44:06.723

您应该知道，只有在渲染器支持所有 CSS 样式时，才能使用 CSS 隐藏 HTML。

仅仅因为您在 Outlook 中看不到复制/粘贴的 HTML 并不意味着数据不存在。

我不确定您实际上想要实现什么：为什么您需要您的用户将 HTML 复制到 Outlook 中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-28T21:03:39.460

如果您要求用户复制内容，我建议将该内容放在 <textarea /> 中，并允许他们通过单击按钮来选择/复制。在浏览器中选择准确的文本可能很困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-21T05:45:12.360

这是我用来解决它的解决方案。

策略：

1.  删除元素时生成唯一编号
2.  将 DOM 中的元素替换为具有 ID 的新 div（又名：替换器 div），假设我们知道上一步中生成的唯一编号，我们将能够找到该 ID。
3.  为元素添加一个属性，以便我们稍后看到它时可以提取唯一编号
4.  将元素移动到在变量中声明的 div 中，以将其从文档中完全删除。
5.  当我们想要将元素移回时，我们只需从属性中获取唯一编号，找到我们留下的替换 div 并将其替换为原始元素。

以下是一些注意事项：

1.  我使用 slideUp() 和 slideDown() 来为移除设置动画，但您可以根据需要替换这些调用。
2.  我将元素放在变量中的 div 元素中。您可以选择将其移至 DOM 中的其他位置，但我希望将其完全移除。您也可以将其放入变量或数组中。我使用 div 变量的原因是我希望能够在其上使用 jQuery 的 DOM 搜索，但我不想在 DOM 中使用它。例如，我可以这样做： `whereHiddenThingsLive.find('.some-class')`。

编码：

```
var whereHiddenThingsLive = $('<div></div>');
var nextNum = 0;

function hideElement(element) {
    if (element.hasClass('sop-showing')) {
        element.finish();
    }
    if (element.is(':hidden') || element.hasClass('sop-hiding')) return;
    var num = nextNum++;
    element.addClass('sop-hiding');
    element.slideUp(400, function () {
        var replacer = $('<div class="hide-replacer" style="display:none;"></div>').prop('id', 'hide-replacer-' + num);
        element.prop('replaced-by', num);
        element.after(replacer);
        element.appendTo(whereHiddenThingsLive);
        element.removeClass('sop-hiding');
    });
}

function showElement(element) {
    if (element.hasClass('sop-hiding')) {
        element.finish();
    }
    if (element.is(':visible') || element.hasClass('sop-showing')) return;
    element.addClass('sop-showing');
    var num = element.prop('replaced-by');
    element.detach();
    element.removeProp('replaced-by');
    $('#hide-replacer-' + num).after(element).remove();
    element.slideDown(400, function() {
        element.removeClass('sop-showing');
    });
} 
```

# wcf - 跨 basicHttpBinding 的事务

> ID：733680
> 
> 赞同：4
> 
> 时间：2009-04-09T10:42:32.663
> 
> 标签：wcf, transactions

我们目前有一个 asmx webservice，它公开一个方法来对 Sql 数据库进行各种更新，内部包装在 SqlTransaction 中。

我正在 WCF 中重写此服务，我们希望将现有方法拆分为通过各种不同 WCF 服务访问的子调用。在服务上使用 basicHttpBinding 存在限制，这排除了所有内置的 WCF 事务功能。是否可以采用这种架构并跨多个服务调用维护事务？已建议将 WS-TRANS 作为可能的解决方案，但我不熟悉它，这可行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T11:28:11.883

很少有什么东西是白给的。**基本**HttpBinding 和**ws** HttpBinding的主要区别在于后者支持**WS-***协议。

basicHttpBinding 或多或少地为您提供了 ASMX 所拥有的东西。“交易”会*比*你在 ASMX 中拥有的要多得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T11:08:42.243

据我所知，[WS-TRANS](http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=trans-ws)代表翻译 Web 服务，所以这行不通。

您的意思是[WS-TX](http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=ws-tx)，其中[WS-AtomicTransaction](http://docs.oasis-open.org/ws-tx/wsat/2006/06)是其中的一部分。`BasicHttpBinding`根本不支持 WS-AtomicTransaction。恐怕您的设置无法正常工作...

# iphone - NavigationController 横向和纵 向

> ID：733686
> 
> 赞同：1
> 
> 时间：2009-04-09T10:44:31.583
> 
> 标签：iphone, uinavigationcontroller, orientation

我有两个`ViewController`支持方向另一个不支持，但是当我在第二个`ViewController`（支持方向的那个）旋转到横向并返回到第一个`ViewController`（不支持方向）同时第二个视图仍然保持横向时，它会改变第一个视图变成风景也是如此，但它不应该是风景，而首先`ViewController`不支持方向，我该如何防止这种情况？

我想要的是无论您如何旋转手机，第一个视图始终是纵向的，尤其是当从第二个视图返回并且它处于横向时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T13:17:16.193

in `viewWillAppear:Animated` of your first controller, call

```
[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait]; 
```

And of course, set up the shouldAutoRotateToInterfaceOrientation to return YES only on UIInterfaceOrientationPortrait.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-09-17T15:36:35.820

在 viewWillAppear:Animated 你的第一个控制器中，调用 [[UIDevice currentDevice] setOrientation:UIInterfaceOrientationPortrait];

# encryption - SHA1 VS RSA：它们之间有什么区别？

> ID：733692
> 
> 赞同：58
> 
> 时间：2009-04-09T10:47:44.757
> 
> 标签：encryption, cryptography, rsa, sha

SHA1 和 RSA 有什么区别？它们只是不同的算法，还是它们从根本上（即用于不同的事物）在某种程度上不同。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-04-09T10:50:54.843

根本不同。

**SHA1**是一种哈希算法，它是一种单向函数，将任意大小的输入转换为固定长度的输出（在本例中为 160 位）。加密散列函数是这样一种函数，它不应该找到两个给出相同输出的输入，除非通过蛮力（例如，对于 128 位函数，您应该平均需要尝试 2^64 消息才能找到这样的由于所谓的生日悖论而导致的“碰撞” - 谷歌搜索更多信息）。

事实上，对于 SHA1，情况已不再如此——该算法（至少在密码学术语中）现在已被破坏，Xiaoyun Wang 等人描述的碰撞攻击击败了经典的生日攻击。SHA2 系列没有被破坏，NIST 正在进行一个过程，以就 SHA3 算法或算法系列达成一致。

**编辑**- Google 现在已经生成并发布了一个实际的 SHA1 冲突。

**RSA**是一种非对称加密算法，将输入加密为可以解密的输出（对比无法反转的哈希算法）。它使用不同的密钥进行加密（公共密钥）与解密密钥（私有密钥）。因此，这可用于接收来自其他人的加密消息 - 您可以发布您的公钥，但只有拥有私钥的您才能解密已使用它加密的消息。

如果您反转 RSA 的密钥，它可用于生成数字签名 - 通过使用您的私钥加密某些内容，任何人都可以使用公钥对其进行解密，如果他们确定公钥属于您，那么他们拥有相信您是加密原始文件的人。这通常与散列函数一起完成——你对输入进行散列，然后用你的私钥对其进行加密，为你的输入消息提供一个固定长度的数字签名。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-01-22T09:15:53.413

前面的答案已经足够解释了。但我认为你问这个问题只是因为 SHA 和 RSA 经常一起出现。所以让我解释一下为什么。

首先，请记住

## RSA 效率不高，但 SHA 有效。

假设您下载了 Windows 7，并想确定它是否是 Microsoft 的原始 Windows 7。如果微软只是通过 RSA 加密 Windows 7，那将需要很长时间才能做到这一点，我们根本无法忍受。所以微软在 Windows 7 上使用 SHA1 并生成一个 160 位长的数据。然后微软用 RSA 签署这个 160 位长的数据（使用它的私钥）。

然后，您需要做的就是确保您的公钥来自 Microsoft。然后也使用 SHA1 生成 160 位长的数据。然后使用 RSA 的公钥解密微软的签名。然后你只需比较这两个 160 位长的数据，看看它们是否匹配。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-09T10:50:56.093

SHA1 是一种散列算法（文档和证书签名），而 RSA 是一种加密/解密算法（安全通信）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-09T10:58:41.690

SHA1 是一种加密散列函数，而 RSA 是一种加密算法。

散列函数接受一段数据并返回一个固定长度的字符串。在密码散列函数中，所有返回字符串具有相同的概率。仅给定哈希数，您无法确定输入，也无法找到另一个给出相同哈希的输入（概率非常小的异常）。Sha1 有一些安全漏洞。

加密算法给出了一段数据，但输出不是固定长度 - 你的加密。给定输出（加密），您可以（如果您有正确的密钥）确定输入。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-09T11:12:58.973

正如其他人所评论的那样，它们是根本不同的东西，服务于不同的功能。您使用 RSA 将信息打乱成看似随机的形式，同时使用 SHA1 来确保消息的完整性（即所有位都没有更改）。在安全应用程序中，您将使用一种或两种，具体取决于您需要的功能。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-04-09T10:57:26.390

安全散列算法 (SHA) 算法采用长度小于 264 位的消息并生成 160 位消息摘要。该算法比 MD5 略慢，但较大的消息摘要使其更安全地抵御暴力冲突和反转攻击。安全散列标准 (SHS, FIPS 180) 中指定的算法由 NIST 开发。SHA-1 是 SHA 的修订版，于 1994 年发布；修订版纠正了 SHA 中未发布的缺陷。它的设计与 Rivest 开发的 MD4 系列哈希函数非常相似。SHA-1 也在 ANSI X9.30 标准中进行了描述。

RSA 是一种用于公钥加密的算法。它是已知的第一个适用于签名和加密的算法，也是公钥密码学的第一个重大进步之一。RSA 广泛用于电子商务协议中，并且在足够长的密钥和使用最新实现的情况下被认为是安全的。

**最显着的区别是 SHA 是一种加密算法，而 RSA 既是加密算法又是签名算法。**

2005 年 8 月 16 日宣布，可以在 SHA-1 中的 2^63 操作中找到冲突。这项研究成果归功于北京清华大学的王晓云教授，以及Andrew Yao教授和Frances Yao教授。它扩展了 Wang、Yin 和 Yu 的工作，证明可以在 2^69 次操作中发现碰撞。这意味着在 SHA 中比在 RSA 中更容易发生冲突 - 但值得注意的是，从未发现有两个相似的密钥发生冲突。

# php - com_create_guid() 未定义：返回致命错误

> ID：733697
> 
> 赞同：4
> 
> 时间：2009-04-09T10:50:13.300
> 
> 标签：php, zend-framework

我在我的专用 linux 服务器上使用 PHP 5

> 5.2.6 (cli) (build: May 7 2008 01:11:22) Copyright (c) 1997-2008 The PHP Group Zend Engine v2.2.0, Copyright (c) 1998-2008 Zend Technologies

但 com_create_guid 函数对我不起作用它返回此错误消息

> 致命错误：在第 34 行的 /var/www/html/mysite/application/modules/consultant/models/Consultant.php 中调用未定义函数 com_create_guid()

我检查了[http://in.php.net/com_create_guid](http://in.php.net/com_create_guid)。它说你只需要 PHP5（我有）但是这个功能不起作用:(

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-09T10:52:30.003

COM 函数[仅在 Windows 上可用](http://www.php.net/manual/en/com.requirements.php)。

> COM 函数仅适用于 Windows 版本的 PHP。
> 
> .Net 支持需要 PHP 5 和 .Net 运行时。

# java - struts2 Tiles - 执行时出错

> ID：733707
> 
> 赞同：0
> 
> 时间：2009-04-09T10:51:51.940
> 
> 标签：java, struts2

我是 struts2 瓷砖的新手。在这里，我正在尝试使用 struts2 磁贴执行 1 个简单的应用程序。执行以下应用程序时出现错误：

无法加载 org.apache.tiles.web.startup.TilesListener 原因：org.apache.tiles.web.startup.TilesListener java.lang.ClassNotFoundException：org.apache.tiles.web.startup.TilesListener

我的 WEB.xml 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

```
<context-param>
    <param-name>tiles-definitions</param-name>
    <param-value>/WEB-INF/myTilesConfigFile.xml</param-value>
</context-param>
<listener>
    <listener-class>org.apache.tiles.web.startup.TilesListener</listener-class>
</listener>

<welcome-file-list>
    <welcome-file>/home.jsp</welcome-file>
</welcome-file-list> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T03:02:37.713

在你的 web.xml 中使用这个监听器：

```
<listener>
<listener-class>org.apache.struts2.tiles.StrutsTilesListener</listener-class>
</listener> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:02:56.360

您的类路径在运行时缺少指定的库。

我相信正确的听众要么是标准的瓦片听众（`org.apache.tiles.listener.TilesListener`）或 Struts2 一（`org.apache.struts2.tiles.TilesListener`）

# asp.net - 使用 JavaScript 禁用和重新启用 asp.net Timer 控件

> ID：733713
> 
> 赞同：1
> 
> 时间：2009-04-09T10:54:03.620
> 
> 标签：asp.net, javascript, timer

我有一个包含 ASP:Timer 控件的 ASP.Net 网页

```
<asp:Timer ID="TimerRefresh" runat="server" Interval="5000" Enabled="true" OnTick="TimerRefresh_Tick">
</asp:Timer> 
```

这由页面中的 asp:UpdatePanel 链接，以便异步刷新页面的特定部分。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <div class="TopRow" id="TopRowPlace" runat="server">
        ... More HTML Code here...
        </div>
    </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="TimerRefresh" />
        </Triggers>
</asp:UpdatePanel> 
```

问题是当用户执行某些操作时，可以隐藏包含异步更新的 HTML 的 DIV 标记（通过在样式中将 display 属性设置为 none）。发生这种情况时，不需要更新内容，因为它是隐藏的。

JavaScript中是否有办法禁用计时器运行和执行异步回发，实际上，当DIV标签再次可见时重新启用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T17:12:03.670

我查看了我的一个 WebForm 上的 Timer 添加到 BODY.onload 事件的 JavaScript。我不认为修改它会很容易，除非你真的想覆盖 Timer 的属性（并将它与更多的客户端 JavaScript 混合）。那么，当您说：

> ...当用户执行某些操作时，可以隐藏（...）异步更新的内容。

操作是否在服务器上执行？如果是这样，您可以禁用服务器上的计时器以响应 DIV 中的事件。
我在带有 CheckBox 的 WebForm 中有一个 UpdatePanel；CheckBox AutoPostBacks 并具有 CheckedChanged 事件处理程序。如果 CheckBox 被选中，则 Timer 被启用，并且 UpdatePanel 的内容在每次滴答时都会更新 - 如果 CheckBox 未被选中，则 Timer 被禁用。即使 Timer 被禁用，AutoPostBack 也能正常工作。
如果您在 DIV 中使用客户端 JavaScript，我仍然认为 AutoPostBack 将是最简单的解决方案。

# c++ - DECLARE_DYNAMIC 和 DECLARE_DYNCREATE 之间的区别？

> ID：733717
> 
> 赞同：11
> 
> 时间：2009-04-09T10:56:53.147
> 
> 标签：c++, visual-c++, mfc

`DECLARE_DYNAMIC`你能告诉我和有什么区别`DECLARE_DYNCREATE`吗？

我们究竟可以在哪里使用它们？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-09T11:25:08.523

第一个声明一个类具有运行时类型信息，第二个声明可以在运行时动态创建实例。这在 MSDN 文档中有详细描述 -有关更多信息，请参阅[运行时对象模型服务等链接。](https://docs.microsoft.com/en-us/cpp/mfc/reference/run-time-object-model-services)

# java - Android - 激活系统键锁（又名锁屏）

> ID：733721
> 
> 赞同：10
> 
> 时间：2009-04-09T10:58:27.383
> 
> 标签：java, android, keyboard, locking, device-admin

我必须激活android的系统键锁（当你按下*关机*/*挂机*按钮时你会得到一个）。看这里：

![图像](https://farm4.static.flickr.com/3202/2849046033_fd42359cef.jpg)

我已经浏览了文档，但我发现的都是[PowerManager](http://developer.android.com/reference/android/os/PowerManager.html)和[KeyguardManager](http://developer.android.com/reference/android/app/KeyguardManager.html)。两者似乎都不是解决方案:-(。

那么，每个人都知道如何从 android 应用程序中实现这一点吗？（如果需要特殊权限，那没问题，但更改设备的设置不是解决方案......）

**编辑**：或者有人知道这绝对不可能吗？顺便提一句。craigs 发送密钥的解决方案不再起作用（见评论）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-02T11:29:07.117

一段时间以来，我一直在寻找完全相同的问题的答案。显然，在 2.0 之后，应用级别的设备管理器权限被删除。但是在 Froyo - 2.2 中，设备策略管理器被揭示为我们的开发人员提供了大量的管理级别控制。

[http://developer.android.com/guide/topics/admin/device-admin.html](http://developer.android.com/guide/topics/admin/device-admin.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T15:12:45.857

您正在寻找的是我的朋友 KeyguardManager.KeyguardLock 中的**[reenableKeyguard()方法！](http://developer.android.com/reference/android/app/KeyguardManager.KeyguardLock.html#reenableKeyguard())**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T17:33:50.323

看起来屏幕锁定功能是使用以下方法执行的：

```
public void goToSleep(long time) 
```

中的方法`PowerManager.java`。可以通过这种方式获得对它的引用：

```
PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE); 
```

但是，这需要许可

```
android.permission.DEVICE_POWER 
```

这是仅对系统可用的 2 级权限。

所以看起来这是不可行的。这仅适用于 1.1 版，我不知道 1.5 版。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T16:57:08.637

这里有一个很好的例子：

[http://www.anddev.org/throwing-simulating_keystrokes_programatically-t717.html](http://www.anddev.org/throwing-simulating_keystrokes_programatically-t717.html)

看起来您可以以编程方式将任何击键发送到系统。听起来您正在寻找的键码是 KEYCODE_ENDCALL，但如果这不起作用，还有很多其他代码可以在这里尝试：

[http://developer.android.com/reference/android/view/KeyEvent.html](http://developer.android.com/reference/android/view/KeyEvent.html)

我不知道是否有任何 API 调用导致锁定发生，但这似乎是一个非常可靠的解决方法，直到您找到更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:01:37.197

挖掘 Android 源代码发现 WindowManagerService 似乎有一个公共方法 ( `startAppFreezingScreenLocked`) 来激活它。这可能是开始寻找答案的好地方，因为不幸的是，您似乎无法直接获得 WindowManagerService 对象。

# java - 在java中验证mailto链接

> ID：733724
> 
> 赞同：0
> 
> 时间：2009-04-09T10:59:20.223
> 
> 标签：java, email-validation, mailto

是否可以检查电子邮件是否为有效电子邮件？

为了检查链接是否有效，我正在检查这样...

URL url = 新 URL(" [http://www.google.com](http://www.google.com) ");
URLConnection 连接 = url.openConnection();

```
 if ( connection instanceof HttpURLConnection)
        {
            HttpURLConnection httpConnection = (HttpURLConnection)connection;
            httpConnection.connect();
            return httpConnection.getResponseCode();
        } 
```

现在，如果它是 mialto，我该怎么做？
URL url = 新的新 URL("mailto:someone@gmail.com");

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T11:04:05.437

答案与 Java 无关，简而言之：你不能不向该地址发送电子邮件。在此处查看我对类似问题的回答： [电子邮件 SMTP 验证器](https://stackoverflow.com/questions/27474/email-smtp-validator)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:02:38.140

要验证电子邮件地址是否有效，您可以阅读[http://azcarya.blogspot.com/2007/10/email-address-validation.html](http://azcarya.blogspot.com/2007/10/email-address-validation.html)。要检查电子邮件地址是否存在，您可以向该地址发送电子邮件并检查服务器回复，以防您收到电子邮件地址无效的状态邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T11:14:15.710

这闻起来。你为什么想做这个？在客户注册您的服务时验证他们的电子邮件，然后您可以确定他们的电子邮件存在。但是检查其他人的电子邮件是否存在异味。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T11:39:07.707

我确实相信您无法ping通电子邮件地址是有原因的。垃圾邮件发送者希望有机会；）

电子邮件客户端为您提供不下载图片的选项，这是因为这将使垃圾邮件发送者看到有人实际阅读了邮件，因此有人正在使用该地址。另一种方法是有一个“不要再给我发这个垃圾”按钮，当有人点击它时，你就知道这是一个使用过的地址。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T11:39:43.823

检查电子邮件地址是否真的是您可以使用的电子邮件地址

```
try{
    InternetAddress a = new InternetAddress("my@email.com");
    a.validate()
}catch(Exception e){
    //INVALID
} 
```

检查电子邮件地址是否存在是另一回事......

# .net - 在签名文件中共享有区别的联合

> ID：733726
> 
> 赞同：2
> 
> 时间：2009-04-09T11:00:34.557
> 
> 标签：.net, f#, functional-programming

我有一个可区分的联合，我想将它用作我在签名文件中公开的函数的参数。目前我有这样定义的代码：

签名.fsi：

```
type Union =
| Part of string
| Part2 of int

val Func: Union -> unit 
```

Func 在单独的 fs 文件中定义。

问题是当我这样做时，fs 文件无法获取联合定义，因此创建 Part 或 Part2 值的代码失败。除非我在使用联合的 fs 文件中再次定义联合。

例如：

签名.fs：

```
type Union =
| Part of string
| Part2 of int

let Func input:Union =
    ignore 
```

其他文件.fs

```
type Union =
| Part of string
| Part2 of int

let DoSomething =
    Func(Part("Test")) 
```

每次失败时都没有重新定义联合。我错过了什么明显的东西吗？当谈到 F# 时，我仍然很年轻。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T17:37:05.700

我想你正在寻找这样的东西：

测试.fsi：

```
#light

type Union =
    | Part of string
    | Part2 of int

val awesome: Union -> unit 
```

测试.fs：

```
#light

type Union =
    | Part of string
    | Part2 of int

let awesome (x :Union) = printfn "%A" x 
```

这将创建一个名为的模块`Test`，您可以从其他文件访问该模块：

另一个Test.fs：

```
#light

let wickedAwesome() =
    Test.awesome(Test.Part("hellz yeah!")) 
```

如果你`open`是`Test`模块，你可以重新编写 AnotherTest.fs 如下：

```
#light
open Test

let wickedAwesome() =
    awesome (Part("hellz yeah!")) 
```

有关更详尽的教程，请参阅[F# 模块和命名空间。](http://en.wikibooks.org/wiki/F_Sharp_Programming/Modules_and_Namespaces)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T11:28:39.637

您的 f# 项目需要以正确的顺序对文件进行排序。这意味着将包含 Func 定义的文件放置在比使用它的文件更高的位置（字面上）。您可能需要考虑将此类定义放在 fsi 文件中。

我要指出的是，鉴于 Func 表示[3.5 标准 (* -> x) 代表](http://msdn.microsoft.com/en-us/library/bb534960.aspx)的普遍性（以及大多数用户的假设），使用类型名称 Func 是一个非常糟糕的主意。

# mysql - 在 Mac OS 10.5 上启动 mysql 时出错

> ID：733728
> 
> 赞同：0
> 
> 时间：2009-04-09T11:01:14.057
> 
> 标签：mysql, macos

前几天我在这里安装 MySQL 时遇到了问题。在做了我能想到的一切都无济于事之后，我决定重新安装整个东西。

我从 mysql.com 安装了安装包格式，然后运行了安装程序。它将它安装在我卸载它之前的位置：/usr/local/mysql。

所以我尝试这样做：

```
sudo echo
sudo /usr/local/mysql/bin/mysqld_safe --user=mysql & 
```

我得到这个回应：

```
[3] 505
mysqld_safe Logging to '/usr/local/mysql/data/PB15.lan.err'.
mysqld_safe Starting mysqld daemon with databases from /usr/local/mysql/data
mysqld_safe mysqld from pid file /usr/local/mysql/data/PB15.lan.pid ended 
```

当我尝试这样做时：sudo mate /usr/local/mysql/data/PB15.lan.err，我得到一个空文件。

关于做什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T11:06:48.627

我知道这并不能回答您的问题，但是[MAMP](http://www.mamp.info/en/index.html)是在 Mac OS X 上使用 MySQL 的好方法。您不仅不必担心安装 MySQL，而且还可以轻松地在计算机之间移动 MySQL 设置。

史蒂夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T11:11:40.317

来自 mysql.com 的 MySQL 二进制包带有一个用于启动和停止它的首选项窗格。你为什么不用这些？即使您有充分的理由不这样做，也请尝试使用它，看看它是否有效。

要检查的另一件事是确保您下载的是 32 位版本的 MySQL，除非您使用的是 64 位 Mac。如果您不确定，请尝试 32 位版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-17T14:57:13.010

最后的解决方案是安装雪豹，给我一个全新的安装，一切都恢复正常了。感谢所有花时间回答的人。

埃里克

# .net - 如何处理 .NET 2.0 中的序列化更改

> ID：733730
> 
> 赞同：1
> 
> 时间：2009-04-09T11:01:45.083
> 
> 标签：.net, serialization

.NET 2.0 引入了 VTS（版本容错序列化， http: [//msdn.microsoft.com/en-us/library/ms229752](http://msdn.microsoft.com/en-us/library/ms229752(VS.80).aspx) (VS.80).aspx ）

一个简单的测试项目表明，2.0 中的默认行为是如果将字段添加到类中，则不抛出序列化异常，然后尝试从没有的类实例的二进制序列化中反序列化该类的实例。没有新领域。

如果二进制序列化位中缺少类中存在的字段，则 1.1 中的默认行为是引发序列化异常。

除了破坏向后兼容性（依赖于抛出异常的代码不再起作用）之外，还有一个更大的问题：没有明显的方法可以在 2.0 中模拟 1.1 的行为。

如何在 2.0 中模拟“在缺失/额外字段上抛出异常”1.1 行为？

非常感谢，米伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T11:39:55.943

一般来说，人们希望能够至少反序列化旧数据，而不管类设计的变化。不幸的是，BinaryFormatter（基于字段）在这里非常脆弱——即使切换到自动实现的属性[也会破坏事情](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)。

就个人而言，我将围绕数据合同或类似结构进行设计，这些结构*不是*特定于实现的，并且*是*可扩展的。对于二进制，[protobuf-net](http://code.google.com/p/protobuf-net/)在这方面有很多用途。

如果您真的想模仿 1.1 的行为 -`ISerializable`手动实现并自己抛出异常（或不抛出）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T11:47:48.343

只有应用了 OptionalFieldAttribute 属性的字段才应在反序列化期间忽略丢失的信息。简单地删除该属性应该会产生异常，并导致与 .NET Framework 1.1 中相同的行为。

更新：

罪魁祸首肯定是BinaryFormatter类的AssemblyFormat属性，1.1默认是FormatterAssemblyStyle.Full，2.0默认是FormatterAssemblyStyle.Simple。

事实上，在 1.1 中将此设置为 FormatterAssemblyStyle.Simple 将产生与 2.0 中相同的行为：不会引发异常。最后，在 .NET 2.0 中，您可以更细粒度地使用 OptionalFieldAttribute。

所以将此属性设置为 FormatterAssemblyStyle.Full，看看它的作用。

另请参见[此处](http://www.dotnetmonster.com/Uwe/Forum.aspx/dotnet-clr/1819/OptionalFieldAttribute-not-needed-with-BinaryFormatter-in-net)。

# sql - 将记录从两个表添加到第三个表：MS SQL Server 2005

> ID：733734
> 
> 赞同：0
> 
> 时间：2009-04-09T11:02:43.007
> 
> 标签：sql, sql-server-2005, tsql

我想将两个表中的一条记录添加到第三个表中。它类似于以下内容：

`table1: pln`

```
taskName   plnHec      pinDate(mm/dd/yyyy)
xx          10            3/1/2008 
yy          20            4/1/2008
zz          10            3/1/2008
zz          10            4/1/2008
xx          10            4/1/2008 
```

`table2 : actual`

```
taskName          actHec           acDate
xx                  9              4/1/2008
yy                 20              4/1/2008
ww                 10              4/1/2008 
```

`table3 : performance`

```
taskName       pdate        plnHec     actHec     cumulativepln  cumulativeact
xx             4/1/2008       10         9           20              9
yy             4/1/2008       20        20           20             20
ww             4/1/2008       0         10           0              10 
```

我正在使用 MS SQL Server 2005。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T11:12:45.680

如果我明白你想做什么（这不是要清楚）

```
insert into performance (taskname,pdate,plnhec,acthec,cumaltivepin,cumaltiveact)

select actual.taskname,max(pindate),acthec,plnhec, sum(plnhec),sm(acthec)
from actual
left join pl on actual.taskname=pln.taskname
group by taskname,acthec 
```

这假设所有任务名称的 acthec 都是相同的，否则您需要选择一个规则，例如 min 或 max。否则，您将获得两行性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:14:16.737

```
INSERT
INTO   performance
SELECT taskname, acDate,
       (
       SELECT  TOP 1 plnHeс
       FROM    pln pi
       WHERE   pi.taskName = ao.taskName
               AND pi.pinDate = ao.acDate
       ),
       actHec. SUM(plnHec), actHec
FROM   actual ao
JOIN   pln po
ON     po.taskName = ao.taskName
GROUP BY
       ao.taskName 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T11:14:19.407

也许我在这里错了，但我想你想在这里使用性能表作为其他表的一种总结？

例如，cumulativepnl、cumulativeact 是其他表中 plnHec 和 actHec 列的 SUM 值。

您是否真的需要这是一个新表，因为汇总数据都可以通过 SQL（存储过程或视图）从 2 个原始表中提取。

如果您真的需要复制数据，我会使用类似 Josh 的查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T11:16:36.297

仅选择部分，假设 pdate=max(pinDate) 和 pln/actHec 字段需要是最新值，并且可能缺少一些行为行：

```
select 
    p.taskName, 
    max(p.pinDate) as pdate, 
    (select top 1 plnHec from pln where taskName=p.taskName order by pinDate desc) as plnHec,
    isnull((select top 1 actHec from actual where taskName=p.taskName order by acDate desc),0) as plnHec,
    sum(isnull(a.actHec,0)) as cumulativeact,
    sum(p.plnHec) as cumulativepln
from
    pln p left join actual a on a.taskName=p.taskName
group by
    p.taskName 
```

# c++ - 内联虚函数真的是无稽之谈吗？

> ID：733737
> 
> 赞同：188
> 
> 时间：2009-04-09T11:03:52.147
> 
> 标签：c++, inline, virtual-functions

当我收到一条代码审查评论说虚函数不需要内联时，我得到了这个问题。

我认为内联虚函数可以在直接在对象上调用函数的场景中派上用场。但我想到的相反论点是——为什么要定义虚拟然后使用对象来调用方法？

最好不要使用内联虚函数，因为它们几乎从未扩展过？

我用于分析的代码片段：

```
class Temp
{
public:

    virtual ~Temp()
    {
    }
    virtual void myVirtualFunction() const
    {
        cout<<"Temp::myVirtualFunction"<<endl;
    }

};

class TempDerived : public Temp
{
public:

    void myVirtualFunction() const
    {
        cout<<"TempDerived::myVirtualFunction"<<endl;
    }

};

int main(void) 
{
    TempDerived aDerivedObj;
    //Compiler thinks it's safe to expand the virtual functions
    aDerivedObj.myVirtualFunction();

    //type of object Temp points to is always known;
    //does compiler still expand virtual functions?
    //I doubt compiler would be this much intelligent!
    Temp* pTemp = &aDerivedObj;
    pTemp->myVirtualFunction();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-04-09T11:23:18.557

有时可以内联虚函数。[优秀C++ 常见问题](http://www.cs.technion.ac.il/users/yechiel/c++-faq/inline-virtuals.html)的摘录：

> “内联虚调用唯一可以内联的时间是当编译器知道作为虚函数调用目标的对象的“确切类”时。只有当编译器有一个实际对象而不是指针或指针时，才会发生这种情况。对对象的引用。即，使用本地对象、全局/静态对象或组合内的完全包含对象。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2013-11-13T12:45:09.810

C++11 增加了`final`. 这改变了公认的答案：不再需要知道对象的确切类，只要知道对象至少具有函数声明为 final 的类类型就足够了：

```
class A { 
  virtual void foo();
};
class B : public A {
  inline virtual void foo() final { } 
};
class C : public B
{
};

void bar(B const& b) {
  A const& a = b; // Allowed, every B is an A.
  a.foo(); // Call to B::foo() can be inlined, even if b is actually a class C.
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-04-09T12:53:52.317

有一类虚函数仍然可以将它们内联。考虑以下情况：

```
class Base {
public:
  inline virtual ~Base () { }
};

class Derived1 : public Base {
  inline virtual ~Derived1 () { } // Implicitly calls Base::~Base ();
};

class Derived2 : public Derived1 {
  inline virtual ~Derived2 () { } // Implicitly calls Derived1::~Derived1 ();
};

void foo (Base * base) {
  delete base;             // Virtual call
} 
```

删除'base'的调用，将执行一个虚拟调用来调用正确的派生类析构函数，这个调用不是内联的。然而，因为每个析构函数都调用它的父析构函数（在这些情况下是空的），编译器可以内联*这些*调用，因为它们实际上并不调用基类函数。

对于基类构造函数或派生实现也调用基类实现的任何函数集，存在相同的原则。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-09T14:44:11.647

如果根本不存在非内联函数（然后在一个实现文件而不是头文件中定义），我已经看到编译器不会发出任何 v-table。他们会抛出类似`missing vtable-for-class-A`或类似的错误，你会像我一样感到困惑。

事实上，这不符合标准，但它发生了，所以考虑将至少一个虚函数放在头文件中（如果只有虚拟析构函数），以便编译器可以在那个地方为类发出一个 vtable。我知道它发生在某些版本的`gcc`.

正如有人提到的，内联虚函数*有时会带来好处，但当然，当您**不*知道对象的动态类型时，您通常会使用它，因为这首先是全部原因`virtual`。

然而，编译器不能完全忽略`inline`. 除了加速函数调用之外，它还有其他语义。类内定义的*隐式内联*是允许您将定义放入标题的机制：只有`inline`函数可以在整个程序中多次定义而不会违反任何规则。最后，它的行为就像您在整个程序中只定义一次一样，即使您将标题多次包含到链接在一起的不同文件中。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-11-18T20:46:52.173

好吧，实际上**虚函数总是可以内联**的，只要它们静态链接在一起：假设我们有一个`Base` 带有虚函数`F`和派生类的抽象类`Derived1`和`Derived2`：

```
class Base {
  virtual void F() = 0;
};

class Derived1 : public Base {
  virtual void F();
};

class Derived2 : public Base {
  virtual void F();
}; 
```

一个假设的呼叫`b->F();`（`b`类型`Base*`为 ）显然是虚拟的。但是你（或[编译器](https://hubicka.blogspot.jp/search/label/devirtualization)......）可以像这样重写它（假设`typeof`是一个类似`typeid`- 的函数，它返回一个可以在 a 中使用的值`switch`）

```
switch (typeof(b)) {
  case Derived1: b->Derived1::F(); break; // static, inlineable call
  case Derived2: b->Derived2::F(); break; // static, inlineable call
  case Base:     assert(!"pure virtual function call!");
  default:       b->F(); break; // virtual call (dyn-loaded code)
} 
```

虽然我们仍然需要 RTTI `typeof`，但调用可以有效地内联，基本上，将 vtable 嵌入指令流中并专门针对所有涉及的类调用。这也可以通过只专门化几个类来概括（比如，只是`Derived1`）：

```
switch (typeof(b)) {
  case Derived1: b->Derived1::F(); break; // hot path
  default:       b->F(); break; // default virtual call, cold path
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-09-15T04:41:08.387

将虚方法标记为内联，有助于在以下两种情况下进一步优化虚函数：

*   奇怪的重复模板模式（[http://www.codeproject.com/Tips/537606/Cplusplus-Prefer-Curiously-Recurring-Template-Patt](http://www.codeproject.com/Tips/537606/Cplusplus-Prefer-Curiously-Recurring-Template-Patt)）

*   用模板替换虚拟方法（[http://www.di.unipi.it/~nids/docs/templates_vs_inheritance.html](http://www.di.unipi.it/~nids/docs/templates_vs_inheritance.html)）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-09T11:07:43.323

*inline*真的没有做任何事情 - 这是一个提示。编译器可能会忽略它，或者如果它看到实现并喜欢这个想法，它可能会在没有*内联*的情况下内联调用事件。如果代码清晰度受到威胁，则应删除*内联。*

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-08-01T02:31:17.727

内联声明的虚函数在通过对象调用时被内联，而在通过指针或引用调用时被忽略。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T11:06:33.200

只有在编译时可以明确解析调用时，编译器才能内联函数。

然而，虚函数是在运行时解析的，因此编译器无法内联调用，因为在编译类型时无法确定动态类型（以及因此要调用的函数实现）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-09T11:08:17.750

使用现代编译器，它不会对它们造成任何伤害。一些古老的编译器/链接器组合可能已经创建了多个 vtable，但我认为这不再是一个问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-09T11:09:58.387

在函数调用明确且函数适合内联的情况下，编译器足够聪明，无论如何都可以内联代码。

其余时间“内联虚拟”是无稽之谈，确实有些编译器不会编译该代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-25T22:03:29.860

创建虚函数然后在对象而不是引用或指针上调用它们确实有意义。Scott Meyer 在他的《有效的 c++》一书中建议永远不要重新定义继承的非虚拟函数。这是有道理的，因为当你创建一个带有非虚函数的类并在派生类中重新定义该函数时，你可能确定自己会正确使用它，但你无法确定其他人会正确使用它。此外，您以后可能会错误地使用它。所以，如果你在基类中创建一个函数并且你希望它是可重定义的，你应该让它成为虚拟的。如果创建虚函数并在对象上调用它们是有意义的，那么内联它们也是有意义的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-29T18:35:27.937

实际上，在某些情况下，将“内联”添加到虚拟最终覆盖可能会使您的代码无法编译，因此有时会有所不同（至少在 VS2017s 编译器下）！

实际上，我在 VS2017 中执行了一个虚拟内联最终覆盖函数，添加了 c++17 标准来编译和链接，由于某种原因，当我使用两个项目时它失败了。

我有一个测试项目和一个我正在单元测试的实现 DLL。在测试项目中，我有一个“linker_includes.cpp”文件，其中 #include 来自所需的其他项目的 *.cpp 文件。我知道...我知道我可以设置 msbuild 以使用 DLL 中的目标文件，但请记住，它是 Microsoft 特定的解决方案，而包含 cpp 文件与构建系统无关并且更容易版本一个cpp文件而不是xml文件和项目设置等等......

有趣的是，我不断地从测试项目中得到链接器错误。即使我通过复制粘贴而不是通过包含添加了缺失函数的定义！太奇怪了。另一个项目已经建成，除了标记项目参考之外，两者之间没有任何联系，因此有一个构建顺序来确保始终构建两者......

我认为这是编译器中的某种错误。我不知道它是否存在于 VS2020 附带的编译器中，因为我使用的是旧版本，因为某些 SDK 只能正常工作:-(

我只是想补充一点，不仅将它们标记为内联可能意味着什么，甚至可能使您的代码在某些极少数情况下无法构建！这很奇怪，但很高兴知道。

PS.：我正在处理的代码与计算机图形相关，所以我更喜欢内联，这就是我同时使用 final 和 inline 的原因。我保留了最后的说明符，希望发布版本足够聪明，可以通过内联它来构建 DLL，即使我没有直接暗示......

PS（Linux）。：我希望在 gcc 或 clang 中不会发生同样的事情，因为我经常做这些事情。我不确定这个问题来自哪里......我更喜欢在 Linux 上执行 c++ 或至少使用一些 gcc，但有时项目的需求不同。

# sql-server-2005 - SQL 服务器错误 4060

> ID：733744
> 
> 赞同：8
> 
> 时间：2009-04-09T11:06:59.470
> 
> 标签：sql-server-2005, security

4060 “服务器拒绝连接；对选定数据库的访问被拒绝”。

如何解决此错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-08-02T07:52:40.390

如果数据库不存在也会出现此错误

所以请确保有一个您在 Catalog=MyDB 中提供的名称的数据库

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T11:18:31.237

您是否有权使用您提供的凭据访问数据库？您要使用哪个提供商？TCP/IP，命名管道？该提供程序是否已启用？是否有防火墙，您是否打开了客户端的端口？这会间歇性发生吗？如果是这样，当错误发生时您是否有足够的可用许可证？您可能需要检查服务器错误日志（以及您的客户端事件日志）以获取更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T16:44:15.677

用户凭据没问题，但用户无权连接到给定的数据库，您应该授予他所需的所有权限...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T11:25:09.160

您很可能没有访问数据库的必要权限，或者没有与您指定的信息相对应的数据库。

# security - 如何在同一（但不断变化的）IP 地址上处理 2 个不同主机的 ssh 主机密钥验证？

> ID：733753
> 
> 赞同：21
> 
> 时间：2009-04-09T11:09:34.223
> 
> 标签：security, ssh, verification, nat, openssh

我在 nat 防火墙后面有 2 台 ssh 服务器，位于每天更改其 wan IP 的位置。它们在给定时间始终位于相同的 wan IP 地址，但位于不同的端口。

我以这种方式连接到服务器 A：

```
ssh -p 22001 karl@x1.example.com 
```

和服务器 B：

```
ssh -p 22002 karl@x2.example.com 
```

因此，我为同一 IP 获得了 2 个不同的主机密钥，并且当 IP 更改时，甚至同一主机的不同 IP 也是如此。

我必须一遍又一遍地删除 known_hosts 文件中的另一个密钥或旧密钥（在 IP 更改的情况下）。

我正在犹豫是否要关闭密钥验证，因为这样会不太安全。但是一直收到警告也是不安全的（因为那时我一直忽略此类警告）。有更好的解决方案吗？

这与我的旧问题有关，但不一样：

[具有 2 个 DNS 名称的服务器上的 SSH 登录警告消息](https://stackoverflow.com/questions/696793/ssh-login-warning-message-on-a-server-with-2-dns-names)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-09T11:28:01.400

我认为这会起作用：

在您的目录中创建一个`config`文件，`.ssh`如下所示：

```
Host server1
  Hostname x1.example.com
  HostKeyAlias server1
  CheckHostIP no
  Port 22001
  User karl

Host server2
  Hostname x2.example.com
  HostKeyAlias server2
  CheckHostIP no
  Port 22002
  User karl 
```

下面的解释（来自`man ssh_config`）

> **检查主机IP**
> 
> 如果此标志设置为“yes”，ssh(1) 将另外检查 known_hosts 文件中的主机 IP 地址。这允许 ssh 检测主机密钥是否由于 DNS 欺骗而更改。如果该选项设置为“no”，则不会执行检查。默认值为“是”。
> 
> **主机密钥别名**
> 
> 指定在主机密钥数据库文件中查找或保存主机密钥时应使用的别名而不是真实主机名。此选项对于隧道 SSH 连接或在单个主机上运行的多个服务器很有用。

`Username`and行避免了您也必须在`Port`命令行上提供这些选项，因此您可以使用：

```
% ssh server1
% ssh server2 
```

# testing - 如何在嵌入式系统中执行回归测试

> ID：733756
> 
> 赞同：15
> 
> 时间：2009-04-09T11:11:16.183
> 
> 标签：testing, embedded, regression-testing, automated-tests

在嵌入式环境中或在自动化测试的可能性非常有限的其他情况下运行回归测试有哪些好的实践和策略。

根据我的经验，许多测试必须手动执行，即测试人员需要按下一系列按钮并验证机器是否正常运行。作为开发人员，很难保证您的更改不会破坏其他内容。

如果没有适当的回归测试，在大型重构等过程中情况会变得更糟。

有没有人认识到这个问题？您是否找到了处理此类问题的良好解决方案或流程？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T11:26:37.643

就个人而言，我非常喜欢在目标硬件和我自己的计算机上编译我的嵌入式代码。例如，在针对 8086 时，我同时包含了一个映射到 8086 硬件上的重置的入口点和一个 DOS 入口点。硬件的设计使所有 IO 都是内存映射的。然后我有条件地在硬件模拟器中编译，并有条件地将硬件内存位置更改为模拟的硬件内存。

如果我要在非 x86 平台上工作，我可能会编写一个模拟器。

另一种方法是创建一个测试台，其中硬件的所有输入和输出都通过软件控制。我们在工厂测试中经常使用它。

有一次我们在 IO 硬件中构建了一个模拟器。这样，系统的其余部分就可以通过通过 CAN 发送一些命令将硬件置于模拟模式来进行测试。类似地，精心设计的软件可以具有“模拟模式”，其中 IO 被模拟以响应软件命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T11:24:52.390

对于嵌入式测试，我建议您在开发过程的早期就设计出解决方法。将您的嵌入式代码沙箱化以在 PC 平台上运行有很大帮助，然后再进行模拟 :)

这将确保大部分内容的完整性，但您稍后仍需要手动进行系统和验收测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T16:39:16.073

> 有没有人认识到这个问题？

明确地。

> 您是否找到了处理此类问题的良好解决方案或流程？

技术组合：

*   自动化测试；
*   蛮力测试，即没有自动化测试那么智能，但是在很长一段时间（数小时或数天）内重复测试一个特性，并且可以在没有人为干预的情况下运行；
*   手动测试（通常难以避免）；
*   在 PC 上的软件模拟器上进行测试（或者作为最后的手段，硬件模拟器）。

关于在 PC 编译器上编译：这对于高级模块和具有适合测试工具的低级模块肯定是有意义的。

例如，当涉及到必须处理来自多个源的实时信号的部分代码时，仿真是一个很好的起点，但我认为这还不够。在尽可能真实的环境中，在实际硬件上测试代码通常是无可替代的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T02:36:32.837

与迄今为止的大多数响应者不同，我使用的嵌入式环境根本不像桌面系统，因此无法在桌面上模拟嵌入式系统。

为了编写好的测试系统，你需要你的测试系统有前馈和反馈。JTAG 是控制器件的最常见的前馈方式。您可以设置设备的完整状态（如果幸运的话，甚至可以设置整个电路板），然后将测试代码设置为运行。在这一点上你得到你的反馈。JTAG 也可以用作反馈设备。然而，在这种情况下，带有软件 API 的逻辑分析仪是最好的。您可以在引脚上查找特定电平、计数脉冲，甚至解析来自流外设的数据流。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T04:03:31.373

除了迄今为止关于确保您的应用程序可以在普通 PC 上构建和至少部分测试的建议（这对于使用 Valgrind 等工具也很有用），我会考虑您的软件设计。

我参与的一个项目有一个用于驱动硬件的组件，一个用于处理管理任务，另一个用于网络管理。网络管理由 SNMP 处理，因此很容易编写远程运行的脚本来驱动硬件做某事。

为了运行低级硬件测试，我编写了一个简单的脚本阅读器，它解析测试脚本并将命令注入我的驱动程序的 IPC。由于输出是基于视频的，因此除了肉眼之外很难自动验证处理，但它确实为我节省了 RSI。它在生成脚本以进行压力测试或模拟已知故障条件以确保错误不会再次发生时也非常有用。

如果我在哪里重新做一遍，我可能会实现一个共享库，供测试工具和发送核心消息的真实代码使用。然后我会用python（或类似的东西）包装lib，这样我的测试可能会稍微“可编写脚本”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-11T14:38:26.220

我同意每个人都说自动化硬件是必须的——我们正在使用这种方法来测试我们的一些单元的嵌入式软件。我们已经建立了充满硬件模拟器的大型两机架测试站，我们使用 NI TestStand 和 Labview VI、C# 代码、供应商 DLL 等来管理所有这些。我们必须测试很多硬件——这就是为什么我们有那么多废话。如果您只是在测试软件，那么您可以将其缩小到最基本的要求。测试串行接口？只需构建一个设备来模拟串行流量并运行所有消息（以及一些无效消息）以确保软件正确响应。测试 DIO？这很容易——有很多 USB 外围设备或嵌入式设备可以模拟 DIO。如果时机很重要，你'

重要的部分是始终知道你在测试什么，而不是测试除此之外的任何东西。如果是软件，请确保测试尽可能独立于硬件。如果您正在测试波形生成或使用 D/A 的东西，请将任务分开 - 在嵌入式设备上使用特殊构建的软件测试 D/A 硬件，除了吐出预先安排的序列电压水平。然后您可以查看您的参考是否关闭，您的滤波器是否设置为错误的频率等。然后您应该能够独立于硬件测试软件 - 使用开发板测试软件并验证处理器的行为针脚是正确的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-13T15:49:08.857

我工作的一个解决方案是自动化的夜间构建和测试程序。

1.  从源代码管理中查看主干头代码。
2.  构建项目并加载到目标上。
3.  运行 PC 控制的自动化测试脚本。

如果您使用某种通信协议，测试脚本很容易运行。这对内部单元测试有好处。使情况更有趣（和彻底）的是制作插入电路板以模拟外部 IO 的线束。

仿真有利于开发和基本的初始测试，但真实的物理运行时间是系统验证的唯一可靠方法。物理操作可以找出非代码问题（由编码方法引起），例如电压骤降、噪声、毛刺、去抖动问题、竞争条件等。

长时间的系统测试也很重要。设置一个自动化测试以连续数天/数周连续滥用系统是一种很好的方法来排除可能直到几个月后在该领域才会出现的问题。告诉客户只要事情开始变得有趣就循环供电并不是所有行业都可以接受的奢侈品。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-09T11:26:08.863

为单个子系统和整个项目提供模拟目标环境的测试工具/沙箱/模型。

这并没有消除在真实环境中进行测试的需要，但会大大减少它们的数量，因为模拟会捕捉到大多数问题，所以当它们都通过并且您执行昂贵的人工驱动测试时，您有理由相信您会首先通过该测试时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T19:15:42.210

In my experience, automated hardware testing has been critical. -- Investing in dual compilation in both PC & target is a "nice to have" feature but given the choice, I'd much rather invest in automated hardware testing. It'll be a more cost-effective solution in the end since the manufacturing arms will want/need the capability anyways for failure analysis.

# sql - UML 到 SQL 工具

> ID：733768
> 
> 赞同：8
> 
> 时间：2009-04-09T11:15:47.250
> 
> 标签：sql, uml

是否有一些 UML 工具可以让我绘制数据库设计并生成用于创建数据库的 SQL 脚本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T11:17:58.757

[我可以从http://www.sparxsystems.com.au/](http://www.sparxsystems.com.au/)推荐 Enterprise Architect

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T11:18:05.467

[Sparx Enterprise Architect](http://www.sparxsystems.com/)可以做到这一点。它还可以对现有数据库进行逆向工程。

当然，它的作用远不止于此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T11:21:14.710

[来自 CA 的 Erwin](http://www.ca.com/us/data-modeling.aspx)就是这样一种工具。

我们开始尝试在我以前的雇员中使用它的想法。但发现该工具的复杂性和成本抵消了对它的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T12:29:08.083

argouml 可以做到——开源和跨平台！但这还不是一种无缝的体验，尽管他们正在努力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-08T11:59:28.013

您还可以尝试在线代码生成服务[MOLA::UMLtoDB](http://modeling-languages.com/content/uml2db-full-code-generation-sql-scripts-databases)，它会自动生成 SQL DDL 脚本来创建与输入 UML 类图对应的数据库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-05T22:08:52.860

你可以试试视觉范式。[ [https://www.visual-paradigm.com/tutorials/sdevsgendb.jsp]](https://www.visual-paradigm.com/tutorials/sdevsgendb.jsp])

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T11:18:03.033

是的，有几种 CASE（计算机辅助软件工程）工具可以做到这一点。Microsoft Visio 就是其中之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T11:19:04.480

你最好使用 Visio，它直接在你的服务器上创建表 n 还支持逆向工程... n 支持许多数据库系统

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T11:19:38.393

是的有一些：

*   微软 Visio

*   [http://www.casestudio.com/enu/](http://www.casestudio.com/enu/)

*   [http://www.dds-lite.com/](http://www.dds-lite.com/)

*   [http://www.ca.com/us/database-design.aspx](http://www.ca.com/us/database-design.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-11T16:07:55.820

我不知道您使用的是哪种 SQL 风格，但您可以尝试 MySQL Workbench。它是跨平台和免费的（就像“言论自由”而不是“免费啤酒”一样）。

# vb.net - 使用 My.Setting 作为多个 ComboBox 的数据源

> ID：733783
> 
> 赞同：1
> 
> 时间：2009-04-09T11:20:06.053
> 
> 标签：vb.net, combobox, datasource

我想在我的程序的多次执行中维护一个潜在的组合框值列表，并将该列表用作多个组合框上的数据源。我还希望对 DataSource 所做的更改能够传播到应用程序中已经存在的所有 ComboBoxes。

有人可以推荐我应该使用哪种类型的对象作为我的数据源，因为 My.Settings 对象似乎不支持通用列表对象。

此外，除了该建议之外，我还可以就如何将集合的更新传播到所有 ComboBox 征求建议吗？我想我需要一个集合类型，当它的内容发生变化时会引发事件，但我想不出，而且无论如何也不知道哪些与 My.Settings 兼容。

希望我已经说明了这种情况。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T19:49:00.250

如果您只是存储字符串，则可以使用 StringCollection。它将与 My.Settings 一起使用。我不确定您是否可以将 StringCollection 直接绑定到组合框...

请注意，您还可以在 My.Settings 中使用自定义类型。您的自定义类型中需要一个空的构造函数，以便可以对其进行序列化。如果您将通用集合公开为自定义类型的属性，我相信它将正确保存到 My.Settings 中。

# c# - 用于存储库模型的 C# 中的实体基类设计

> ID：733787
> 
> 赞同：6
> 
> 时间：2009-04-09T11:21:21.637
> 
> 标签：c#, linq-to-sql, oop

我正在努力通过学习更多关于依赖注入/IoC 和其他最佳实践方法的知识来成为一名优秀的编程公民。为此，我有一个项目，我试图做出正确的选择并以“正确”的方式设计一切，无论这意味着什么。Ninject、Moq 和 ASP.NET MVC 有助于提高可测试性并将应用程序“推出”。

但是，我有一个关于如何为我的应用程序所包含的对象设计实体基类的问题。我有一个简单的类库，网络应用程序建立在它之上。这个库公开了一个 IRepository 接口，默认实现（应用程序使用的那个）在幕后使用 Linq-to-SQL（DataContext 等不暴露给 Web 应用程序）并且只包含获取这些实体的方法。存储库基本上看起来像这样（简化）：

```
public interface IRepository
{
    IEnumerable<T> FindAll<T>() where T : Entity
    T Get<T>(int id) where T : Entity
} 
```

默认实现使用 DataContext 上的 GetTable() 方法来提供正确的数据。

但是，这要求基类“实体”具有一些特性。通过创建与 Linq-to-SQL 给我的映射对象同名的部分类，很容易让我的对象从它继承，但是“正确”的方法是什么？

例如，上面的接口有一个通过它的 id 获取实体的功能——所有从实体派生的不同类型的类确实都有一个 int 类型的“id”字段（从它们各自表的主键映射），但是我怎样才能以一种让我像这样实现 IRepository 的方式来指定它呢？

```
public class ConcreteRepository : IRepository
{
    private SomeDataContext db = new SomeDataContext();

    public IEnumerable<T> FindAll<T>() where T : Entity
    {
        return db.GetTable<T>().ToList();
    }

    public T Get(int id) where T : Entity
    {
        return db.GetTable<T>().Where(ent => ent.id == id).FirstOrDefault();
    }
} 
```

我是在无编译器的 PC 上从内存中执行此操作的，因此请原谅任何错误，希望您能理解我的意图。

这里的技巧当然是要编译它，必须确定 Entity 承诺从它派生的每个人都有一个 id 字段。

而且我可以创建一个抽象字段，或者一个由 Linq-to-SQL 粘贴在生成的类中的 id 字段“隐藏”的普通字段。

但这一切都感觉有点像作弊，甚至会给出编译器警告。

“实体”真的应该是“IEntity”（而不是接口），我应该尝试以 Linq-to-SQL 将实现的方式定义 id 字段吗？这也可以很容易地指定实体实现者需要实现的其他接口。

或者“实体”应该是具有抽象 id 字段的抽象基类，并且它是否还应该以抽象的方式实现所需的接口以供其他人覆盖？

我不太了解 C#，无法看到一个优雅的解决方案，所以我很想听听更有经验的系统设计师有一些基类经验来权衡这个问题。

谢谢！

**编辑 4 月 10 日：**

我看到我在这里遗漏了一些重要的东西。我的 IRepository 有两个具体的实现——一个是使用 LINQ to SQL 的“真实”实现，另一个是 InMemoryRepository，它现在只使用一个 List，用于单元测试等。

添加的两种解决方案都适用于其中一种情况，而不适用于另一种情况。因此，如果可能的话，我需要一种方法来定义从 Entity 继承的所有内容都将具有“id”属性，并且这将与 LINQ to SQL DataContext 一起使用而不会“作弊”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T13:29:44.463

如果您在所有表中使用“Id”作为主键，那么所有生成的类都将具有如下公共属性：

```
public int Id {} 
```

然后创建一个接口

```
public interface IIdentifiable {
    Id { get; }
} 
```

然后是最繁琐的部分:(，为所有实体创建一个部分类并使其实现 IIdentifiable。

存储库类可能如下所示：

```
public class Repository<T> : IRepository where T : IIdentifiable {
} 
```

以下代码将起作用：

```
db.GetTable<T>().SingleOrDefault(ent => ent.Id.Equals(id)); 
```

如果您不使用生成的类并自己制作，那么从这个角度来看会更简单。

**编辑：**
而不是 ent => ent.Id == id 使用 ent => ent.Id.Equals(id)。刚刚测试，以下是一个完整的工作示例：

```
public interface IIdentifiable {
    int Id { get; }
}

public class Repository<T> where T : class, IIdentifiable {
    TestDataContext dataContext = new TestDataContext();

    public T GetById(int id) {
        T t = dataContext.GetTable<T>().SingleOrDefault(elem => elem.Id.Equals(id));
        return t;
    }
}

public partial class Item : IIdentifiable {
}

class Program {
    static void Main(string[] args) {
        Repository<Item> itemRepository = new Repository<Item>();

        Item item = itemRepository.GetById(1);

        Console.WriteLine(item.Text);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T11:33:34.227

“FindAll”是个坏主意，会强制它获取所有数据。返回`IQueryable<T>`会更好，但仍然不理想，IMO。

按 ID 重新查找 - 请参阅[此处获取 LINQ-to-SQL 答案](https://stackoverflow.com/questions/440474/can-i-make-a-generic-compiledquery-that-accepts-multiple-tables-and-generic-types/440608#440608)；这使用 LINQ-to-SQL 的元模型来定位主键，因此您不必这样做。它也适用于属性模型和基于资源的模型。

我不会强迫基类。这在 Entity Framework 中不是很流行，而且不太可能变得更流行......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T05:24:59.630

我有一个类似的项目，我主要基于[Rob Conery 的店面](http://blog.wekeroad.com/mvc-storefront/)理念，就像上面的建议一样，我使用界面来指示`int ID`字段：

```
public interface IModelObject
{
    int ID { get; set; }
} 
```

但我没有强制我的存储库实现一个类型，而是选择了该类型`IRepository`的扩展方法。`IQueryable<T>`所以我使用过滤器：

```
public static class ModelObjectFilters
{
    /// <summary>
    /// Filters the query by ID
    /// </summary>
    /// <typeparam name="T">The IModelObject being queried</typeparam>
    /// <param name="qry">The IQueryable being extended</param>
    /// <param name="ID">The ID to filter by</param>
    /// <returns></returns>
    public static IQueryable<T> WithID<T>(this IQueryable<T> qry,
        int ID) where T : IModelObject
    {
        return qry.Where(result => result.ID == ID);
    }
} 
```

..这样我可以`IQueryable<T>`从我的回购中返回一个类型，并简单地用于`.WithID(x)`拉单个对象。

我也将此代码与 LinqToSql 对象一起使用到堆栈中，因此相等比较器确实转换为 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T19:55:10.697

看看[Denis Troller](https://stackoverflow.com/questions/735140/c-linq-to-sql-refectoring-this-generic-getbyid-method/735888#735888)作为我的[问题](https://stackoverflow.com/questions/735140/c-linq-to-sql-refectoring-this-generic-getbyid-method)的答案发布的以下方法：

```
public virtual T GetById(short id)
            {
                var itemParameter = Expression.Parameter(typeof(T), "item");
                var whereExpression = Expression.Lambda<Func<T, bool>>
                    (
                    Expression.Equal(
                        Expression.Property(
                            itemParameter,
                            GetPrimaryKeyName<T>()
                            ),
                        Expression.Constant(id)
                        ),
                    new[] { itemParameter }
                    );
                var table = DB.GetTable<T>();
                return table.Where(whereExpression).Single();
            }

public string GetPrimaryKeyName<T>()
            {
                var type = Mapping.GetMetaType(typeof(T));

                var PK = (from m in type.DataMembers
                          where m.IsPrimaryKey
                          select m).Single();
                return PK.Name;
            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T12:42:28.770

你做的和我们一样。我们有一个通用的 Persist 接口和两个实现：一个使用 LinqToSql，另一个用于模拟。

我们在 GetById 上遇到了同样的问题。我们的解决方案是让所有实体都从一个基类继承。该基类有一个虚方法

```
protected object GetId() 
```

为了简化复合主键的情况，我们更改了数据库模式，以便每个表都有一个主键列。旧的复合主键成为唯一约束。

我们还发现拥有一个基类很方便，因为后来我们意识到我们需要一些其他通用特性来跨越所有实体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-28T06:10:30.813

对于 Id 字段，您实际上有 2 个选项：

1.  使用对象来表示实体中的 Id。（这为您提供了更多的灵活性，因为您是主键）

2.  只需使用一个 int Id。（这使您的实体非常易于使用，并成为您的实体/存储库的约定。

现在关于如何实现您的实体。您的实体类可能是抽象的。查看 Sharp-Architechture 或[CommonLibrary.NET](http://commonlibrarynet.codeplex.com/)或 SubSonic中的实体基类实现

通常你有审计字段，也许还有验证方法。我正在使用 CommonLibrary.NET

实体：IEntity

*   ID
*   创建日期
*   更新日期
*   创建用户
*   更新用户
*   证实（...）
*   已验证
*   错误

IEntity 接口是审计字段（CreateDate、UpdateUser 等）和实体验证方法的组合。

# java - Java RPC 服务器框架

> ID：733789
> 
> 赞同：4
> 
> 时间：2009-04-09T11:22:07.843
> 
> 标签：java, http, network-programming, rpc

我正计划用 Java 编写一个 RPC 服务器。服务器需要接受传入的 RPC（可能通过 HTTP）并回答它们。相当基本的东西。不需要支持“长轮询”或“挂起”RPC，因此每个请求的线程模型应该是完全足够的。

如果我是用 Python 编写的，我可能会使用像 twisted 这样的框架。在 C 语言中，类似 glibc。在每种情况下，该框架都提供了处理 IO 的通用“选择循环”核心的实现，并调用处理它的更高级别的构造，最终导致我的应用程序被调用以处理诸如接收 RPC 之类的事件。

不过，我已经很久没有用 Java 写过任何实质性的东西了，所以我不知道这种事情的最新技术或建议的解决方案是什么。甚至可能有部分标准库我可以很容易地用来做这件事。因此我向 StackOverflow 提出问题：有哪些框架适合这样的任务？

请注意，尽管我可能将 HTTP 用于 RPC，但这绝不是 Web 应用程序——因此，Web 框架并不合适。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T11:27:13.087

[Apache MINA](http://mina.apache.org)是一个设计非常好的异步非阻塞网络框架。它提供面向字节的访问来读取和写入数据包数据。在此基础上，它有一个过滤系统，可以添加额外的层，提供面向行的文本解析、加密（通过 TLS）、压缩等。

PS：强烈推荐 2.0 版本系列，尽管它仍处于“里程碑”形式，但它已被证明非常稳定并且接近最终版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T11:33:43.557

您有多项选择：

*   使用现有的用于套接字编程的 SDK 推出您自己的解决方案。
*   Java RMI，远程方法调用框架。
*   Java CORBA 绑定不再被认为是最新的。
*   Java Web Service 框架相当复杂。查看 Apache CXF 和不同的 J2EE 产品。

然后你有不同的系统在 HTTP 传输之上运行，比如 JSON/XML-RPC，你需要一个 Web 服务器。即使你把它们排除在外。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T12:31:41.217

你可以考虑使用像[Jetty](http://www.mortbay.org/jetty/)这样简单的东西，jetty的内部结构非常稳定，可以处理相当多的连接。如果您实现了特定于码头的处理程序接口，您也可以不使用所有 servlet 和 JSP 支持库，使其成为一个非常小的可嵌入应用程序服务器。

# error-handling - 使用 Global.aspx 页的错误报告

> ID：733792
> 
> 赞同：0
> 
> 时间：2009-04-09T11:23:40.647
> 
> 标签：error-handling, global-asax

从收到的错误报告中识别应用程序中的错误时，我总是遇到问题。目前，我构建了一封电子邮件，其中包含有关错误的信息。

*   用户
*   网址
*   错误信息
*   时间和日期

这是我使用的代码

```
Sub Application_Error(ByVal sender As Object, ByVal e As EventArgs)

    Dim _UserIpAddress as string = Request.ServerVariables("REMOTE_ADDR")
    Dim _Browser as string = Request.ServerVariables("HTTP_USER_AGENT")
    Dim _URL as string = Request.Url.AbsoluteUri
    Dim _ErrorDate as string = System.DateTime.Now
    Dim _Error as string = Server.GetLastError().InnerException.ToString()

End Sub 
```

问题是，在某些情况下，有了这些信息，我无法找出导致错误的原因。

我如何获得有关错误的更多详细信息？例如是什么控制导致它，变量中的数据在系统中传递

此外，除了电子邮件之外，您还使用了哪些收集数据的方法以及它们的成功程度。例如登录数据库，在文本文件中重新编码等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T11:40:39.623

例如，没有捕获所涉及变量的通用方法。您几乎要求在遇到错误时进行转储！即使这样，您也必须弄清楚用户在错误发生之前一直在做什么。您可以从 IIS 日志中获得*一些帮助（如果引用 URL 不为空，您还应该记录它）。*

这个问题的真正答案是一个难题：更好的质量保证。上线后发生的错误越少，您需要弄清楚的错误就越少。

通过自动化单元测试，特别是使用测试驱动开发，可以进一步减少 QA 中发现的错误数量。

# c# - 在 C# 中实现生产者/消费者模式

> ID：733793
> 
> 赞同：13
> 
> 时间：2009-04-09T11:24:00.957
> 
> 标签：c#, .net, events, design-patterns, producer-consumer

如何使用**Events 和 Delegates**在 C# 中实现**生产者/消费者**模式？在使用这些设计模式时，我需要注意哪些资源？有没有我需要注意的边缘情况？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-11-08T12:18:44.603

我知道这个线程有点老了，但是因为我有时在搜索中遇到它，所以我决定分享这个生产者-消费者代码，让人们想知道如何实现一个简单的通用生产者-消费者作业队列。

**Job**类用于以委托的形式“存储”对象的方法调用。然后在处理作业时调用委托。任何相关参数也存储在此 Job 类中。

使用这种简单的模式，可以在入队和出队过程中实现多线程。实际上这只是最简单的部分：多线程为您的代码带来了新的挑战，您稍后会注意到它们；-)

我最初在这个[线程](https://stackoverflow.com/questions/46862475/changing-thread-context-in-c-sharp-console-application/46863615#46863615)中发布了这段代码。

```
using System;
using System.Collections.Concurrent;
using System.Diagnostics;
using System.Threading;

// Compiled and tested in: Visual Studio 2017, DotNET 4.6.1

namespace MyNamespace
{
    public class Program
    {
        public static void Main(string[] args)
        {
            MyApplication app = new MyApplication();
            app.Run();
        }
    }

    public class MyApplication
    {
        private BlockingCollection<Job> JobQueue = new BlockingCollection<Job>();
        private CancellationTokenSource JobCancellationTokenSource = new CancellationTokenSource();
        private CancellationToken JobCancellationToken;
        private Timer Timer;
        private Thread UserInputThread;

        public void Run()
        {
            // Give a name to the main thread:
            Thread.CurrentThread.Name = "Main";

            // Fires a Timer thread:
            Timer = new Timer(new TimerCallback(TimerCallback), null, 1000, 2000);

            // Fires a thread to read user inputs:
            UserInputThread = new Thread(new ThreadStart(ReadUserInputs))
            {
                Name = "UserInputs",
                IsBackground = true
            };
            UserInputThread.Start();

            // Prepares a token to cancel the job queue:
            JobCancellationToken = JobCancellationTokenSource.Token;

            // Start processing jobs:
            ProcessJobs();

            // Clean up:
            JobQueue.Dispose();
            Timer.Dispose();
            UserInputThread.Abort();

            Console.WriteLine("Done.");
        }

        private void ProcessJobs()
        {
            try
            {
                // Checks if the blocking collection is still up for dequeueing:
                while (!JobQueue.IsCompleted)
                {
                    // The following line blocks the thread until a job is available or throws an exception in case the token is cancelled:
                    JobQueue.Take(JobCancellationToken).Run();
                }
            }
            catch { }
        }

        private void ReadUserInputs()
        {
            // User input thread is running here.
            ConsoleKey key = ConsoleKey.Enter;

            // Reads user inputs and queue them for processing until the escape key is pressed:
            while ((key = Console.ReadKey(true).Key) != ConsoleKey.Escape)
            {
                Job userInputJob = new Job("UserInput", this, new Action<ConsoleKey>(ProcessUserInputs), key);
                JobQueue.Add(userInputJob);
            }
            // Stops processing the JobQueue:
            JobCancellationTokenSource.Cancel();
        }

        private void ProcessUserInputs(ConsoleKey key)
        {
            // Main thread is running here.
            Console.WriteLine($"You just typed '{key}'. (Thread: {Thread.CurrentThread.Name})");
        }

        private void TimerCallback(object param)
        {
            // Timer thread is running here.
            Job job = new Job("TimerJob", this, new Action<string>(ProcessTimer), "A job from timer callback was processed.");
            JobQueue.TryAdd(job); // Just enqueues the job for later processing
        }

        private void ProcessTimer(string message)
        {
            // Main thread is running here.
            Console.WriteLine($"{message} (Thread: {Thread.CurrentThread.Name})");
        }
    }

    /// <summary>
    /// The Job class wraps an object's method call, with or without arguments. This method is called later, during the Job execution.
    /// </summary>
    public class Job
    {
        public string Name { get; }
        private object TargetObject;
        private Delegate TargetMethod;
        private object[] Arguments;

        public Job(string name, object obj, Delegate method, params object[] args)
        {
            Name = name;
            TargetObject = obj;
            TargetMethod = method;
            Arguments = args;
        }

        public void Run()
        {
            try
            {
                TargetMethod.Method.Invoke(TargetObject, Arguments);
            }
            catch(Exception ex)
            {
                Debug.WriteLine($"Unexpected error running job '{Name}': {ex}");
            }
        }

    }
} 
```

# performance - 有哪些 Unix 工具可以模拟不良网络？

> ID：733794
> 
> 赞同：3
> 
> 时间：2009-04-09T11:24:17.027
> 
> 标签：performance, networking, emulation

在开发服务器应用程序时，了解连接速度变慢、突然中断或吞吐量非常低时的工作原理非常重要，但是因为开发一个可以模拟上述所有“功能”的测试网络将花费一大笔钱，我们需要通过软件来模拟它们。

一种方法是更改​​客户端和服务器应用程序，但这也不是很划算。另一种方法是通过在操作系统级别拦截和更改行为，这似乎更有希望，以及我现在正在寻找的工具类型。

我的案例尤其是 Solaris 服务器，但通用的 Unix/BSD 工具非常受欢迎。也可以随意发布 Window 的工具，因为它可能会帮助其他人出现但不使用 Unix。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T11:32:08.770

[IPTABLES](http://en.wikipedia.org/wiki/Iptables)会让你扼杀带宽和这样的泡沫，它可能不是最直观的，但可以做到。（我们使用一个单独的盒子作为运行 FreeBSD 的“扼杀者”，但我认为 IPtables 出现在大多数 *nix 菌株上）

对于我所做的大多数网络损伤问题，我使用了一个名为[NetDisturb](http://www.pds-test.co.uk/products/netdisturb.html)的工具，但是它是基于 Windows 的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-10T22:40:11.130

尝试 Linux 的 Netem ( [http://www.linuxfoundation.org/en/Net:Netem](http://www.linuxfoundation.org/en/Net:Netem) ) 或 BSD 的 dummynet。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T11:41:56.610

我写了一个实用程序来做到这一点。它是用Java编写的，所以你需要安装java。它表现良好，应该做你需要的。它被称为[DonsProxy](http://donsproxy.sourceforge.net/)。只需点击链接，我希望你喜欢它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T11:58:53.293

在客户端，[`trickle`](http://monkey.org/~marius/pages/?page=trickle)这是一种模拟慢速网络的非常简单的方法（它不会丢包，因为它最初是作为带宽整形器，而不是测试工具）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T14:59:00.480

**WANem**可以解决问题。（他们有一个 LiveCD，您可以使用它并为您节省 Netem 等所需的安装\配置时间......） [http://wanem.sourceforge.net/](http://wanem.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T11:26:41.263

我最喜欢的技术是拔出网线。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T11:43:30.320

多年前，我们在我们的一个项目中开发了一个工具，它基本上是一个由 UNIX 机器上的 inetd 守护进程启动的程序。它基本上充当客户端和服务器之间的管道。

例如，如果我们在 www.test.box 上启动它：

```
conduit 1465 www.target.box 80 
```

然后我们可以在 www.test.box:1465 将客户端连接到它，它会打开一个到 www.target.box:80 的管道（inetd 实际上完成了大部分繁琐的连接工作，尽管我们也有一个版本可以充当它自己的长期运行的服务器）。

默认行为是在两个方向上全速传递所有内容，但它是可配置的（在运行时，通过共享内存传递给它的命令，但其他方法也是可能的）：

*   减慢传输速度。
*   损坏的传输。
*   丢失数据。
*   发送虚假数据。还有很多其他人。

它为我们提供了很好的服务，并在网络异常测试方面提供了很多帮助。

# debugging - VisualStudio2005调试很慢

> ID：733805
> 
> 赞同：2
> 
> 时间：2009-04-09T11:28:08.983
> 
> 标签：debugging, visual-c++, visual-studio-2005

我的电脑有 1GB 内存。在我的解决方案中，总共有 48 个项目。但我只调试一个项目。每个项目都依赖于另一个项目。在调试项目时，为什么 Visual Studio 会占用大量内存。系统也被挂起。

如果您有任何解决此调试问题的建议，任何人都可以告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T12:06:16.833

VS 只是不太擅长大型项目/解决方案，而 MS 一直声称正在改进这一点（尽管 VS 的进步总是非常难以察觉......）

我的建议是：

*   1GB 的 RAM 不足以满足您正在使用的项目的大小
*   VS2008 可能比 VS2005 更好
*   检查您是否没有尝试将符号下载到调试器中
*   如果您只想运行应用程序，请不要使用调试器 (F5) - 使用 Ctrl-F5

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:32:01.407

我确实记得一个问题，每次你这样做时断点都会加倍......我不记得了。

检查您是否设置了 1000 个断点（全部用于同一行）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T11:32:09.643

您是否尝试过关闭内联完成（在选项中）？这有时会导致这种类型的问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T11:32:32.153

只是为了公开这一点——是否有可能降低解决方案的复杂性？你真的需要 48 个项目吗？您正在从事的项目总共有多大？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T12:18:10.267

我已经解决了这个问题，并通过阻止我的病毒扫描程序扫描 Visual Studio 使用的目录来修复它，因为病毒扫描程序和 IDE/设计时编译器有时会相互锁定几秒钟。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-06-28T09:59:47.610

我的需要整整 20 秒才能开始调试。我删除了所有断点并修复了它。:)

# project-management - 您是如何与敏捷项目签订合同的？（不是你想的那样，你是怎么做的）

> ID：733809
> 
> 赞同：37
> 
> 时间：2009-04-09T11:30:12.160
> 
> 标签：project-management, agile, scrum

要执行敏捷项目，您首先需要一份合同。没有合同——没有项目！没有项目——没有敏捷、SCRUM 或任何东西！

如果我们谈论的是大中型项目，合同必须有明确定义的安全触发器。即客户希望非常确定，如果我们同意按时结束项目 = T、预算 = B 和范围 = S，我们最终不会得到时间 = T×2、预算 = B×3 或范围 = S /2。

另一方面，作为交付产品的公司，我们不希望项目意外结束。即，如果经过一些迭代客户说“现在我看到这实际上就是我们所需要的。我们现在停止。” 并且该项目计划了另外 2 个月，而不是我们有没有计划工作的人。如果 3-6 人不是大问题，那么 15-25 人可能是一个真正的问题！

然而，我没有找到任何具有安全功能的合同的真实示例，该合同允许项目以完全敏捷的方式执行（向客户说明或未说明）。我在许多论坛上发现的标准说法——与客户交谈，向他解释这是更有成效的工作方式等，这并不能说服我和我的管理层。并不是说我们不相信敏捷实际上是一种更好的方法。只是安全触发器的差距是如此明显，以至于我们的客户都没有购买它，我们也不喜欢它们（差距，而不是客户；））。

**请不要“它可能会以这种方式工作......”** - 我已经阅读了大量的内容。**只对“对我们来说它是这样工作的”感兴趣**。毫无疑问，跳过其中的所有自信信息。

PS 据我所知，标准的迭代、功能驱动的方法建议客户在每次迭代（迭代次数）后付费，并且能够在任何迭代后由客户和项目执行者停止项目，而无需多说后果，而不是说“无论如何它都会失败，所以越早越好”（这是正确的，但在签署合同时不是很有帮助）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-21T21:09:17.427

我在政府工作。

我们最近运行了一个软件开发采购流程，并选择了三个供应商来开展敏捷项目。一些注意事项：

1.  我们已经 75% 确定我们想要运行一个敏捷项目，因为我们知道我们的要求是模棱两可的，而且因为它是一个面向公众的 Web 项目，具有重要的设计元素。所以我想说，如果你的客户了解敏捷并从一开始就接受它，这会很有帮助，即使他们实际上并没有在内部实践它。请注意，（某些）政府圈子越来越接受敏捷，所以这可能会变得更容易。

2.  我们使用的一项保障措施是聘请一位非常有经验（独立）的 SCRUM 主管为我们工作并代表我们的团队负责人/架构师/可用性人员处理软件项目管理职责。我们花了很多时间找到这个人，并从三位优秀的申请人中选出了他们。这是昂贵的，但值得。

3.  一旦我们选择了我们的供应商并广泛同意他们的角色（设计、前端、后端），我们就制定了一份快速的谅解备忘录，概述了我们继续进行的意图、项目的可能预算、每个团队的可能规模供应商，承诺在月底前签署一份完整的合同，并在此期间签订时间和材料协议。

4.  然后我们参加了一个技术规划/规模调整会议，让事情顺利进行。这段时间没有进行任何开发工作或设计，但我们做了很多大小调整和高级估计。

5.  到月底，我们为每个供应商制定了合同（一份迟到了，但没关系）。一位供应商提出了我们可能会使用的样本合同，一份基于项目三分之二的付款；另一个在冲刺完成时。我认为最终我们完成了冲刺（按月计费），在我们的标准合同模板的付款部分使用了一些供应商建议的语言。

总的来说，我们对这种方法没问题（尽管承认存在一些风险），因为我们认为整个项目中没有大量的实际技术风险，并且因为我们对采购过程和供应商充满信心，我们已选择。

最后，这是一个非常成功的项目，我们已经开始在内部将 SCRUM 用于其他项目。我认为拥有一支优秀的团队是关键。我们对供应商充满信心——不仅他们能够胜任这项工作，而且他们非常适合作为一个团队工作的态度，并且每个人都有明确的角色（即他们会不是为了同样的钱而竞争）。

如果我们的供应商不是那么好，我们对签订这样的合同会有更多的保留意见，但是进行采购几乎是一门艺术和一门科学，我们知道我们选择了最合适的团队来自其他高质量受访者的态度。

从那以后，我们已经为第二年的开发延期了所有三份合同，尽管我想说这次进展并不顺利（新的 SCRUM 大师，不同的团队组成）它仍然是一个值得参与的伟大项目。

您可能还会发现这很有趣：[外包敏捷](http://blog.3months.com/2008/04/20/outsoucing-agile-can-it-be-done/)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T11:53:10.857

因为我主要在 Intranet 应用程序上工作，所以这对我来说并不是太大的问题。但是，我经常为其他部门做应用程序，有时，特别是当项目很大时，我们会就项目范围、（预期）持续时间和成本签署谅解备忘录（MOU）。由于我以敏捷的方式工作，这些事情都不是固定的，这通常很难向以前没有以这种方式工作的其他部门解释。通常，我将包括对过程本身的描述——几段——解释项目如何成为他们和我之间的合作项目，我们共同决定何时完成。

到实际编写 MOU 时，我已经在项目中投入了大量时间来发现需求是什么（这些是按标准小时费率处理的）。基于这一点，再加上对我的速度和与以前项目的相似性的估计，我对所需功能的时间和成本进行了广泛的估计——再次解释说，实际成本取决于我们实际实现的功能和真正需要多长时间。这需要相当多的信任，但由于我们一直在合作开发需求，所以我通常会与我直接打交道的个人一起制定需求。我经常试图在谅解备忘录中留下实际估计，但如果他们的经理坚持，我会将其包括在内。我确实试着给他们一个预算数字。

我的经验是，一旦项目开始并且您开始为客户提供价值，他们很少会不高兴。通常，他们要求（并支付）比原始项目范围更多的东西。通常，我们都同意不需要某些原始功能，但我总是希望如此。毕竟，在他们真正看到运行中的事物之前，他们真的无法确定他们真正需要的是什么。通常情况下，我们会根据实际开发删除一些功能并添加其他功能。我想如果我们不这样做，那么使用敏捷方法就没有任何意义了。

我认为关键问题是信任。我建议在较小的项目上与新客户合作，或者明确地将大型项目分解为较小的项目以建立信任。一旦他们和您知道您可以相互信任以构建具有正确功能的正确产品，我认为客户突然退出的风险——而且总是存在的——被最小化。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-09T13:28:07.587

我参与过的唯一敏捷项目是内部、时间和材料 (T&M) 或按周期付费项目。

正如您所指出的，问题在于，项目存在提前失败/结束的风险。但是，这和任何项目都不一样吗？如果您选择 T&M，您将承担所有风险，如果您选择固定价格，则客户将承担所有风险。通过按周期付费，您承担了大部分风险，但每次一个周期将一小部分风险传递给客户。碰巧的是，您或客户都不想承担任何风险，这就是您发布此问题的原因。

问题是冒险是商业的全部，你承担的风险越大，当它出现时利润就越大，但如果不这样做，损失也越大。如果风险太大而您无法处理，唯一的解决方案是找到其他可以承担风险的人，但您将不得不付钱给他们。如果您和客户都没有准备好接受它，那么可能只有两个答案：

1.  找一些有钱的傻瓜来承担风险（即买保险）。
2.  将风险分散到许多人中，直到每个人承担的风险小到可以接受为止。

我认为第二个选项是使接触器如此受欢迎的原因。因为他们很容易摆脱，他们最终冒着提前终止项目的风险。由于风险将在其中一些之间分散，因此风险分散到可接受的水平。由于额外的风险，他们会向您收取比员工更高的费用，但这就是您试图自己避免风险的结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T00:16:43.137

在敏捷项目中，您最不想要的是固定范围（通常包含在传统瀑布项目的合同中）。您需要的是与固定规模的团队针对优先产品积压工作达成固定时间表的协议。

如果你强迫你的商业伙伴在启动时定义一个固定的范围，他们会在合同中塞满他们能想到的所有东西。不是因为它有价值，而是因为以后很难做出改变，他们可能需要它。

可以为业务合作伙伴要求的一组功能提供高级估计。但是，由 IT 和产品负责人组成的团队接受范围和优先级将在功能实施过程中轻松更改。通过首先专注于最重要的功能，团队成为价值驱动而不是计划驱动。如果有任何东西确实不在列表中，那么它的价值就会降低，并且已经被团队学到的更重要的东西所取代。

固定范围的合同锁定了团队在他们对功能了解最少的情况下做出范围决策。关注优先级并允许优先级和范围在迭代之间灵活调整，确保交付的内容具有价值。

与其与企业签订固定范围的合同，不如与您的业务合作伙伴一起参加敏捷训练营。该课程应概述敏捷过程和产品所有者的角色。如果企业接受敏捷方法，您就可以开始开发了。构建您的产品待办事项，对其进行优先级排序，提供高级评估，构建发布和迭代计划并开始交付价值。

**我们执行这种关系的方式**是首先将业务合作伙伴送到敏捷训练营。然后我们将业务伙伴培训为产品负责人。然后我们建立了积压工作，提供了一个高水平的估计，并确定了团队的规模，并对开发进行了时间限制。在两周内，第一个工作软件被演示了。从那时起，业务合作伙伴就开始了解并了解做出改变的价值，因为他们学到了更多。任何关于固定范围合同的讨论很快就被遗忘了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T00:57:51.690

我们处理这个问题的方式非常有成效。

我们的客户基本上是购买迭代。客户签署了一份合同，上面写着“X 2 周迭代”。有一个客户教育过程（与我从事的所有敏捷项目一样）来帮助客户加快规划过程，并且他们在开发过程结束时实际得到的东西并不具体项目的开始，但他们控制最终结果。

我们的团队已经一起工作了近六个月，我们拥有自己开发的坚实技术基础，可以最大限度地降低风险。我们对我们在速度方面的持续能力有一个非常扎实的把握——这有助于我们预测满足期望的客户结果所需的迭代次数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T12:07:43.817

我们的 PM 实践仍在追赶交付软件的敏捷方法。大多数时候，出于谨慎考虑，最初的合同定义了高层次的目标，但对功能有可预见的技术挑战的限制。某些主要的交付里程碑，即 alpha、beta、final，被定义和定价。附加范围被定义为补充原始合同的变更请求。当我们远离传统的瀑布方法时，这是一种学习体验；我见过的最大问题是，像常规部署这样的事情很难定价，因为你永远不知道解决迭代中的“反馈”需要多少时间。我们有“这太棒了，我们进展顺利！” 我们有“这里”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T16:12:09.320

自从我们切换到敏捷后，我们的合同没有改变，客户仍然希望在重大里程碑时接收构建，并且距离在 sprint 的每一端都直接参与太远了。产品负责人不必是合同另一端的人，它可以是执行经理。产品负责人不断与真实客户的需求沟通，他评估需求并将其展示给客户。如果他经常发布，那么这个人与客户沟通会容易得多。

# iphone - UIBarButtonItem 具有自定义视图但也具有 UIBarButtonItemStyle

> ID：733814
> 
> 赞同：4
> 
> 时间：2009-04-09T11:32:23.480
> 
> 标签：iphone, uibarbuttonitem, uibarbuttonitemstyle

我正在创建`UIBarButtonItem`带有自定义视图的 a 以实现向 a 的转换，如此[处](https://stackoverflow.com/questions/614988/changing-leftbarbuttonitem-with-flip-transition)`UIActivityIndicatorView`所述。

但是我真的希望我的按钮保持正常`UIBarButtonItemStyle`，例如`UIBarButtonitemStyleBordered`.

有没有办法做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T09:53:08.613

如果我理解这个问题，您是否希望在 Maps.app 中有类似定位按钮的东西，它在定位设备时显示目标图标并变为活动指示器？

不幸的是 UIBarButtonItems 创建`-initWithImage:style:target:action:`或`-initWithTitle:style:target:action:`不支持按钮内的任意视图。

您可能必须自己绘制按钮边框。您可以为此使用图像，并通过在包含按钮边框图像的 UIImageView 顶部堆叠 UIActivityIndi​​catorView 来实现效果。

# deployment - 如何使用 Visual Studio 2008 创建静默安装程序包

> ID：733816
> 
> 赞同：2
> 
> 时间：2009-04-09T11:32:45.023
> 
> 标签：deployment, visual-studio-2008, windows-installer, visual-studio-setup-proje

我正在使用 Visual Studio2008 进行开发，并且我想创建一个静默设置包，即我不希望在安装过程中出现任何 UI。是否可以使用 Visual Studio 创建静默安装程序 MSI，如果没有，是否还有其他工具可以做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T12:04:59.533

ocdecio 所说的补充（绝对正确）：

如果您想将静默安装设为默认设置，即用户双击您的安装文件时的标准安装操作，您可以将您的 MSI 包装在由 IExpress 创建的自解压可执行文件中。

IExpress 包含在 Windows 中，允许您指定在提取 IExpress 包后要执行的命令。在您的情况下，您必须指定

```
msiexec /i mySetup.msi /q 
```

作为安装命令（在某些情况下，您需要 /qn 绝对禁止所有对话框）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T11:37:24.623

MSI 使用适当的命令行选项静默运行，我认为没有任何方法可以解决这个问题。请参见[此处](https://msdn.microsoft.com/en-us/library/windows/desktop/aa367988(v=vs.85).aspx)- 您必须使用 /q 开关。

另一种方法是[NSIS](http://nsis.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T08:14:20.840

请参阅此处的“静默安装要求的详细信息”：http: [//software.intel.com/en-us/articles/how-to-creating-your-msi-installer-using-visual-studio-2008](http://software.intel.com/en-us/articles/how-to-creating-your-msi-installer-using-visual-studio-2008)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-06T23:34:20.030

在 Visual Studio 的解决方案资源管理器中，您必须删除默认的安装包用户界面。

[在此处输入图像描述](https://i.stack.imgur.com/1IV8F.png)

[在此处输入图像描述](https://i.stack.imgur.com/BgmvJ.png)

# xml - 在 XML 文档中嵌入 XHTML 片段，并根据模式进行验证

> ID：733822
> 
> 赞同：2
> 
> 时间：2009-04-09T11:36:09.620
> 
> 标签：xml, xhtml, xsd

本质上，我想在必须针对自定义模式进行验证的 XML 文档中嵌入一些 XHTML。

完整背景：

我有一个使用 XML 文档的 web 服务。此 XML 文档已根据自定义模式进行验证。XML 中的数据被解析并存储在数据库中，并以有用的格式显示在网站上。

在我的 web 服务上触发 XML 的客户有自己的内部“IT/程序员”。他希望能够在某些网站页面的某些占位符中显示一些自定义 XHMTL。

我们已经同意他可以扩展他在我的 web 服务上触发的 XML，以包含 3 个将包含 HTML 的新元素，我将相应地调整我的架构。我还将进行处理以将他的 XHTML 从 XML 文档中提取到网页上。

我不想使用 cdata ，因为这可能非常不安全（我认为！），所以我试图`<xs:any>`在架构中使用 an ：

```
<xs:element name="SomeXhtmlStuff" minOccurs="0">
  <xs:complexType>
    <xs:sequence>
      <xs:any minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

我在想这意味着元素中的任何有效 XML 都可以，例如所有 XHTML 标记都可以，但是我尝试了这个：

```
<SomeXhtmlStuff>
  <p>This is a test HTML output for Job Details</p>
</SomeXhtmlStuff> 
```

并且 XML 不会针对它进行验证。编辑：Visual Studio 2008 在它的自动验证器中给出错误“'p' 元素未声明”

我在 XML/schema 方面没有太多经验，我继承了这个项目，任何建议都会非常受欢迎！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T11:55:32.613

我相信使用 CDATA 部分会更好。在 (X)HTML 的世界中，碰巧存在带有无效标记的文档。尽管如此，浏览器实际上正在显示有用的东西。因此，问题在于您可能不时收到响应，因为另一端试图在 XML 文档中发送无效的 XHTML 并停止正常运行。

顺便说一下，Atom 和 RSS 发布者使用 CDATA 部分来插入 XHTML/HTML 标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:56:02.177

您收到的验证错误是什么？

我相信这`<xs:any/>`意味着“任何将验证的 XML”。将`<p/>`验证什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T12:08:54.407

经过一番谷歌搜索后，我发现这个模式片段似乎有效：

```
<xs:element name="SomeXhtmlStuff" minOccurs="0" >
    <xs:complexType>
    <xs:complexContent mixed="true">
      <xs:restriction base="xs:anyType">
        <xs:sequence>
          <xs:any processContents="skip"
                  minOccurs="0"
                  maxOccurs="unbounded"/>
        </xs:sequence>
      </xs:restriction>
    </xs:complexContent>
  </xs:complexType>
  </xs:element> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T13:25:01.043

您可能应该考虑将 xhtml 命名空间放入该 xs:any 元素中。您可能还想将 processContents 属性更改为“lax”。lax 属性值通知验证器，如果它可以找到定义，它应该验证内容。因此，更好的元素模型可能是：

```
<xs:element name="SomeXhtmlStuff" minOccurs="0" >
    <xs:complexType>
    <xs:complexContent mixed="true">
      <xs:restriction base="xs:anyType">
        <xs:sequence>
          <xs:any processContents="lax"
                  namespace="http://www.w3.org/1999/xhtml"
                  minOccurs="0"
                  maxOccurs="unbounded"/>
        </xs:sequence>
      </xs:restriction>
    </xs:complexContent>
  </xs:complexType>
  </xs:element> 
```

*当然，如果他只是将元素*插入到您的 xml中，您可能还想更改该混合内容类型。

# linux - 如何在 Unix 控制台或 Mac 终端上运行 shell 脚本？

> ID：733824
> 
> 赞同：564
> 
> 时间：2009-04-09T11:36:26.107
> 
> 标签：linux, bash, macos, shell, unix

我知道它，忘记它并重新学习它。是时候把它写下来了。

* * *

## 回答 #1

> 赞同：1054
> 
> 时间：2009-04-09T11:58:50.470

要运行不可执行的`sh`脚本，请使用：

```
sh myscript 
```

要运行不可执行的`bash`脚本，请使用：

```
bash myscript 
```

启动可执行文件（即任何具有可执行权限的文件）；您只需通过其路径指定它：

```
/foo/bar
/bin/bar
./bar 
```

要使脚本可执行，请授予它必要的权限：

```
chmod +x bar
./bar 
```

当文件可执行时，**内核**负责确定如何执行它。对于非二进制文件，这是通过查看文件的第一行来完成的。它应该包含一个`hashbang`：

```
#! /usr/bin/env bash 
```

hashbang 告诉内核要运行什么程序（在这种情况下，命令`/usr/bin/env`使用参数 运行`bash`）。然后，脚本与您提供给脚本的所有参数一起作为后续参数传递给程序（作为第二个参数）。

这意味着**每个可执行的脚本都应该有一个 hashbang**。如果没有，您就没有告诉内核它*是*什么，因此内核不知道使用什么程序来解释它。它可以是`bash`, `perl`, `python`, `sh`, 或其他东西。（实际上，内核通常会使用用户的默认 shell 来解释文件，这是非常危险的，因为它可能根本不是正确的解释器，或者它可能能够解析其中的一些但存在细微的行为差异，例如`sh`和)之间的情况`bash`。

# 关于`/usr/bin/env`

最常见的是，你会看到像这样的哈希刘海：

```
#!/bin/bash 
```

结果是内核将运行程序`/bin/bash`来解释脚本。不幸的是，`bash`默认情况下并不总是提供，而且它并不总是在`/bin`. 虽然在 Linux 机器上通常是这样，但还有一系列其他 POSIX 机器`bash`在不同的位置发布，例如`/usr/xpg/bin/bash`或`/usr/local/bin/bash`.

因此，要编写可移植的 bash 脚本，我们不能依赖硬编码`bash`程序的位置。POSIX 已经有一种机制来处理这个问题：`PATH`. 这个想法是您将程序安装在其中一个目录中，`PATH`当您想按名称运行程序时，系统应该能够找到您的程序。

可悲的是，你***不能***这样做：

```
#!bash 
```

内核不会（有些可能）`PATH`为您搜索。有一个程序可以`PATH`为您进行搜索，不过，它被称为`env`. 幸运的是，几乎所有系统都`env`安装了`/usr/bin`. 所以我们开始`env`使用硬编码路径，然后`PATH`搜索`bash`并运行它，以便它可以解释您的脚本：

```
#!/usr/bin/env bash 
```

这种方法有一个缺点：根据 POSIX，hashbang 可以有**一个参数**。在这种情况下，我们将`bash`其用作程序的参数`env`。这意味着我们没有空间可以将参数传递给`bash`. 所以没有办法将类似的东西转换`#!/bin/bash -exu`成这个方案。你必须把`set -exu`hashbang 放在后面。

这种方法还有另一个优点：一些系统可能附带`/bin/bash`.，但用户可能不喜欢它，可能会发现它有问题或过时，并且可能在`bash`其他地方安装了自己的。在 OS X (Mac) 上经常出现这种情况，Apple 发布了一个过时的版本，而用户使用 Homebrew 之类`/bin/bash`的工具安装了最新版本。`/usr/local/bin/bash`当您使用`env`进行搜索的方法时`PATH`，您会考虑用户的偏好，并使用他的首选 bash，而不是他的系统随附的 bash。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2009-04-09T11:39:32.293

要启动 shell 脚本“file.sh”：

```
sh file.sh

bash file.sh 
```

另一个选项是使用 chmod 命令设置可执行权限：

```
chmod +x file.sh 
```

现在运行 .sh 文件，如下所示：

```
./file.sh 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-09T11:39:34.260

对于伯恩壳：

```
sh myscript.sh 
```

对于 bash：

```
bash myscript.sh 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-09T12:42:16.167

如果您希望脚本在当前 shell 中运行（例如，您希望它能够影响您的目录或环境），您应该说：

```
. /path/to/script.sh 
```

或者

```
source /path/to/script.sh 
```

注意`/path/to/script.sh`可以是相对的，例如`. bin/script.sh`在`script.sh`当前`bin`目录下的目录中运行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-25T17:29:26.543

首先，授予执行权限：-
`chmod +x script_name`

1.  如果脚本不可执行：-
    运行 sh 脚本文件：-
    `sh script_name`
    运行 bash 脚本文件：-
    `bash script_name`
2.  如果脚本是可执行的：-
    `./script_name`

***注意***：-您可以使用“ls -a”检查文件是否可执行

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-02T13:11:14.880

文件扩展名 .command 分配给 Terminal.app。双击任何 .command 文件将执行它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-05T21:02:31.037

另外一点，要从同一个文件夹运行解释器，仍然在脚本中使用**#!hashbang**。

**例如，从****/usr/bin**复制的 php7.2 可执行文件位于*hello*脚本的文件夹中。

```
#!./php7.2
<?php

echo "Hello!"; 
```

要运行它：

```
./hello 
```

其行为与以下内容相同：

```
./php7.2 hello 
```

* * *

具有良好文档的正确解决方案可以是工具[linuxdeploy](https://github.com/linuxdeploy/linuxdeploy)和/或[appimage](https://appimage.org/)，这是在后台使用此方法。

# .net - 如何在gridview中组合下拉列表和空字段？

> ID：733828
> 
> 赞同：2
> 
> 时间：2009-04-09T11:38:32.607
> 
> 标签：.net, asp.net, linq-to-sql, gridview

我有一个带有 LinqDataSource 的 GridView。我使用以下技术使用下拉列表填充字段（在本例中为供应商），其中包含来自不同 LinqDataSource 的值：

[![替代文字](https://i.stack.imgur.com/Qto5u.jpg)](https://i.stack.imgur.com/Qto5u.jpg)
[（来源：[scottgu.com](http://www.scottgu.com/blogposts/linq5/step27.jpg)）]

但是，假设我的供应商字段允许为空。任何想法如何允许输入空值以及其他 SupplierDataSource 选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T13:52:07.687

请试试这个：

```
 <asp:DropDownList ID="DropDownList1"
      DataSourceID="SupplierDataSource"
      DataValueField="SupplierID"
      DataTextField="CompanyName"
      SelectedValue='<%#Bind("SupplierID")%>'
      runat="server"
      AppendDataBoundItems="true">
        <asp:ListItem Value="" Text="None" />
    </asp:DropDownList> 
```

这应该将一个空列表项添加到您的下拉列表中。我相信您的数据源会将其解释为空值，但我尚未测试代码。

希望这可以帮助！

# asp.net - ASP.NET - 如何动态生成标签

> ID：733831
> 
> 赞同：0
> 
> 时间：2009-04-09T11:39:17.740
> 
> 标签：asp.net, dynamic-controls

我正在做一个关于航班预订系统的项目。我的职责是输入旅行乘客的详细信息。这些乘客可能包括成人和儿童。所以我需要为所有旅行的乘客动态生成单独的标签和文本框，以便输入所有乘客的详细信息。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T12:05:52.653

您可能想查看 GridViews / DetailsView / Repeaters 等。然后您可以编写一些数据绑定代码来根据需要显示每条记录的不同标签。

正如其他人所说，需要更多信息才能正确回答问题。也许您可以发布一些您已经拥有的代码，以便我们可以为您指明下一个方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T13:06:26.437

You page contains a Controls Collection that you can use to append new Controls, as Labels and Textboxes, i.e.

You can access this Controls Collection using code-behind, accessing the Page.Controls property and appending the controls you want to display in the page, that will then be rendered.

You can check this out: [http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx)

Here is a simple example you may try out:

Codefront (*aspx webfor*m)

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Test Website</title>
</head>
<body>
    <form id="form1" runat="server">

    <div>
    <!-- here you can place the static text and other elements -->
        <h1>TESTING</h1>
        blah blah blah blah blah
    </div>

    <div id="placeholder" runat="server">
    <!-- here is where the dinamically created elements will be placed -->
    </div>

    </form>
</body>
</html> 
```

Code-behind

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page  {

    protected override void CreateChildControls(){

        // Add a Label to the current ControlCollection.
        Label lbl = new Label();
        lbl.Text = "Label text";
        placeholder.Controls.Add(lbl);

        // Create a text box control, set the default Text property, and add it to the ControlCollection.
        TextBox box = new TextBox();
        box.Text = "Textbox text";
        placeholder.Controls.Add(box);

    }

} 
```

Hope this help ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:29:05.967

只是为了补充一些其他人所说的：如果您采用这种方法，那么我的猜测是您真的不了解 ASP.NET 在基础级别上是如何工作的。

如果你想显示一个乘客列表，那么你要做的*最后一*件事就是为每个乘客动态生成一个标签控件——在很多层面上都是错误的。

我能想到两种解决方案。首先，您可以在适当的位置放置一个标签，然后使用呈现乘客所需的 HTML 填充此标签（包括任何 href）。其次，您可以使用 GridView 或其同类控件之一来呈现此类信息。这是罗宾的建议，这确实是最好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T11:40:37.830

您可以使用[Response.Write()生成整个页面](http://www.w3schools.com/asp/met_write_response.asp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T11:44:55.213

不要*太*苛刻，而是从[http://www.asp.net/learn/](http://www.asp.net/learn/)开始。如果您有更具体的问题，请编辑您原来的、非常模糊的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T11:48:07.157

在后面的代码中添加控件非常容易 - 看看[controls.Add()](http://msdn.microsoft.com/en-us/library/system.web.ui.control.controls(VS.80).aspx)方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T13:08:37.010

Sometimes its much easier just to create your own server control. that way you can control the HTML which is outputted a lot easier and have greater control over different browsers and languages with less code.

# c# - 从 C# NET 3.5 中的字节 [] 保存文件

> ID：733832
> 
> 赞同：17
> 
> 时间：2009-04-09T11:39:19.533
> 
> 标签：c#, .net-3.5, compression, zlib

我的 TCP 客户端接收到一个数据包中的图像。图像是用 zlib 压缩的。任务是解压缩图像并将其放在表单上。

我打算将压缩后的图像保存在当前目录中，解压并在表单上加载解压后的文件。

第一个问题来自保存文件（压缩）。zlib 可以将其保存为解压缩。

下面的代码加载压缩文件，解压后保存。

```
 private void decompressFile(string inFile, string outFile)
    {
        System.IO.FileStream outFileStream = new System.IO.FileStream(outFile, System.IO.FileMode.Create);
        zlib.ZOutputStream outZStream = new zlib.ZOutputStream(outFileStream);
        System.IO.FileStream inFileStream = new System.IO.FileStream(inFile, System.IO.FileMode.Open);          
        try
        {
            CopyStream(inFileStream, outZStream);
        }
        finally
        {
            outZStream.Close();
            outFileStream.Close();
            inFileStream.Close();
        }
    }

    public static void CopyStream(System.IO.Stream input, System.IO.Stream output)
    {
        byte[] buffer = new byte[2000];
        int len;
        while ((len = input.Read(buffer, 0, 2000)) > 0)
        {
            output.Write(buffer, 0, len);
        }
        output.Flush();
    } 
```

如何将 byte[] 数组直接传递给该函数？我打算将其保存为压缩文件，然后使用压缩文件的位置调用该函数，但我既不知道如何从 byte[] 数组中保存文件，也不知道如何传递 byte[] 数组作为输入文件。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-09T11:52:53.510

使用静态 void System.IO.File.WriteAllBytes(string path, byte[] bytes) 方法。

```
byte[] buffer = new byte[200];
File.WriteAllBytes(@"c:\data.dmp", buffer); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-09T11:57:04.607

```
public static void SaveFile(this Byte[] fileBytes, string fileName)
{
    FileStream fileStream = new FileStream(fileName, FileMode.Create, FileAccess.ReadWrite);
    fileStream.Write(fileBytes, 0, fileBytes.Length);
    fileStream.Close();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T12:14:11.727

除了其他人已经说过的，我还建议您使用“使用”子句，因为所有这些对象都实现了 IDisposable。

```
using(FileStream outFileStream = new ...)
using(ZOutputStream outZStream = new ...)
using(FileStream inFileStream = new ...)
{
    CopyStream(inFileStream, outZStream);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T11:48:25.487

将您收到的字节数组粘贴到 a`MemoryStream`中，并在不使用临时文件的情况下即时压缩/解压缩它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T12:01:35.190

你可以试试这段代码

```
 private void t1()
    {
        FileStream f1 = new FileStream("C:\\myfile1.txt", FileMode.Open);
        int length = Convert.ToInt16(f1.Length);
        Byte[] b1 = new Byte[length];
        f1.Read(b1, 0, length);
        File.WriteAllBytes("C:\\myfile.txt",b1);
        f1.Dispose();
    } 
```

# eclipse - 在 Eclipse 插件开发中，如何以编程方式激活视图？

> ID：733839
> 
> 赞同：1
> 
> 时间：2009-04-09T11:40:48.547
> 
> 标签：eclipse, eclipse-pde

我有一个作为选择提供商的树视图。为了响应不同类型的选定项目，我想展示一个视图。（需要实例化它）。

我可以通过 VIEW_ID 和工作台 getViewRegistry 来做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T06:35:42.317

这篇文章“[通过视图链接让你的 Eclipse 应用程序更丰富](http://www.ibm.com/developerworks/opensource/library/os-ecllink/?ca=dgr-lnxw09EclipseGUIviews)”对基本技术进行了最好的描述，
它基于“选择提供者 - 选择侦听器”模式，这是一种创建响应其他视图变化的视图的便捷方式，现已更新与[**选择服务**](http://dev.eclipse.org/blogs/wayne/2008/01/14/the-selection-service/)。

就像是：

```
IViewRegistry viewRegistry = this.getWorkbenchWindow().getWorkbench().getViewRegistry();
IViewDescriptor desc = viewRegistry.find(VIEW_ID);
window.getActivePage().showView(VIEW_ID); 
```

应该能够打开/创建视图

# .net - .NET 中的“调试”和“发布”版本之间的主要区别是什么？

> ID：733840
> 
> 赞同：16
> 
> 时间：2009-04-09T11:41:55.067
> 
> 标签：.net

**重复：** [.NET 中的调试与发布](https://stackoverflow.com/questions/90871/debug-vs-release-in-net)

为什么在构建 .NET 应用程序时存在“调试”和“发布”模式？

它们之间的主要技术区别是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T00:08:16.757

差异：

*   调试在有用的 CIL 代码之间插入 NOP（无操作 CPU 指令）以允许调试器连接
*   调试不允许各种优化：
    *   内联（放置方法的代码来代替对其的调用以减少调用开销）
    *   循环展开（用重复的代码替换循环代码 - 例如 for - 以消除循环开销（循环变量维护））

还有许多其他人。发布速度明显更快，但它没有提供真正的调试支持。对于调试，有...调试模式:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T11:46:56.503

一个简短的回答是，在“发布”模式下构建的代码将针对速度或大小进行优化，并且还将删除用于调试的所有信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T12:05:49.267

是的，你甚至可以在发布模式下调试 [:)]。有复杂的过程来做到这一点。

但是，发布版本针对速度和性能进行了优化。此外，Microsoft 最终用户许可协议规定您不能在客户端系统上部署调试文件。

[http://www.codeproject.com/KB/debug/releasemode.aspx](http://www.codeproject.com/KB/debug/releasemode.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T11:46:00.953

据我了解，主要区别在于，在调试模式下，调试器使用的整个符号信息与程序一起存储，因此如果开发人员想在发布之前调试应用程序，他/她可以这样做，通过附加到任何调试器。

您可能已经注意到调试文件夹中的 .pdb 文件。可执行文件的大小也相当大。但是在发布模式下，调试器符号信息被省略，假设最终用户将使用应用程序，因此不得向他提供应用程序符号。

您可以将符号视为提供给调试器的信息，以了解哪些局部变量，哪些函数，设置断点的位置以及各种信息，以便它可以准确地告诉您当前正在执行的代码部分。

# c# - 单例模式在现实世界中的应用是什么？

> ID：733842
> 
> 赞同：16
> 
> 时间：2009-04-09T11:42:04.283
> 
> 标签：c#, design-patterns

### 复制

[关于设计模式：什么时候应该使用单例？](https://stackoverflow.com/questions/228164/on-design-patterns-when-to-use-the-singleton)

```
class Singleton
{
    private static Singleton instance;

    private Singleton() {}

    public static Singleton Instance
    {
        get
        {
            if (instance == null)
                instance = new Singleton();

            return instance;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-09T12:14:12.647

简单的。单身人士做什么？

*   它提供对对象实例的全局访问，并且
*   它保证不能创建超过一个该类型**的**实例。

因此，当您需要**这两个**东西时，您可以使用单例。

这是罕见的。全局变量一般来说很糟糕。我们倾向于尽可能避免它们。并且围绕“如果存在多个实例，则为错误”这一假设构建应用程序是危险的，因为您通常会发现该假设不成立。也许您希望能够在本地创建多个实例，以进行缓存。也许事实证明您需要多个数据库、多个日志，或者线程性能要求您为每个线程提供自己的实例。

在任何情况下，您都不需要强制执行“可能只存在一个实例”的假设。如果您只需要一个实例，只需创建一个实例。*但是让构造函数公开可见，以便在必要时*可以创建更多实例。

换句话说，单例提供的两个特性实际上都是负面的。一般来说，我们不*希望*我们的数据在全球范围内可见，也不*希望*无缘无故地剥夺灵活性。

如果您确实需要单例提供的功能之一，请实现该功能，而无需其他功能。如果您需要全局可访问的内容，请将其设为全局。不是单身狗。如果你确实需要强制只存在一个实例（我想不出任何你想要的合理情况），那么在没有全局可见性的情况下实现它。

我见过的唯一真实世界的单例应用程序是“一位架构师阅读了 GoF 的书，并决定在任何地方都塞满设计模式。”，或者“一些停留在 80 年代的程序员对整体感到不舒服”面向对象”的东西，并且想要以程序方式编码，这意味着将数据存储为全局变量。单例听起来像是一种“OOP”方式来制作全局变量而不会被大喊大叫”。

关键是单身人士混合了两个非常不同且极少需要的职责。通常，您*最多*需要任何给定对象中的一个。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-05-10T13:04:50.563

在我的项目中，我们创建了一个记录器组件，用于将应用程序记录到不同的源（例如，基于配置的文本文件、XML 和数据库）。所以有一个日志管理器，它在整个应用程序中创建唯一一个记录器类的实例，用于记录消息、错误等。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-10T00:04:52.880

Jon Skeet，**THE_SKEET**，有一篇很棒的文章举例说明了正确实现单例模式的各种方法（线程安全、惰性、高性能）。

## 去[这里阅读](http://www.yoda.arachsys.com/csharp/singleton.html)。 [存档链接](https://web.archive.org/web/20080713050413/http://www.yoda.arachsys.com/csharp/singleton.html)

根据大众的需求，我复制了 Skeet 版本：

```
public sealed class Singleton
{
    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            return Nested.instance;
        }
    }

    class Nested
    {
        // Explicit static constructor to tell C# compiler
        // not to mark type as beforefieldinit
        static Nested()
        {
        }

        internal static readonly Singleton instance = new Singleton();
    }
} 
```

> 在这里，实例化是由嵌套类的静态成员的第一个引用触发的，它只发生在 Instance 中。这意味着实现是完全惰性的，但具有以前的所有性能优势。请注意，尽管嵌套类可以访问封闭类的私有成员，但反之则不然，因此这里需要实例是内部的。不过，这不会引发任何其他问题，因为该类本身是私有的。然而，为了使实例化变得懒惰，代码有点复杂。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T11:48:59.183

我使用 Singleton 的一个很好的例子是在一个应用程序中，该应用程序必须从应用程序的多个位置调用 Web 服务组件。我需要维护状态，初始化一些字段，并维护一个调用和回调队列，所以我不能只进行静态调用。但我只想在整个应用程序中重用一个实例。我将这个“服务”类实现为单例，以便我可以在整个应用程序中调用它以响应许多不同的事件，但它们都在一个地方处理。

根据我的经验，我使用过单例，其中一个对象将在应用程序的生命周期内多次使用，需要初始化，和/或内存很重。基本上只有一个类的实例，而你可能有很多实例，这样做的成本很高。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T11:47:37.983

假设您的问题在标题中：

我曾经使用过一个 COM 对象，它每台服务器只能有一个实例。我们通过单例将它暴露给整个 ASP.NET 应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T11:48:32.600

请注意，此代码不是线程安全的：

```
get   
{
   if (instance == null)   
      instance = new Singleton();   
    return instance;   
} 
```

一个线程可以进入函数，通过 null 测试，然后被挂起。然后可以启动第二个线程并通过空测试。从那时起，两个线程将在某个时候创建​​自己的 sungleton 对象副本，其中只有一个被使用。

这在像 C# 这样的 GC 语言中可能没那么重要，但如果单例控制内存以外的资源，那么它确实很重要。您需要使用[双重检查锁定模式](http://en.wikipedia.org/wiki/Double_checked_locking_pattern)来防止它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-09T11:51:06.010

当一个对象应该只有一个实例时，您应该使用 Singleton。[然而，Misko Hevery 对单身人士为什么不好有一些想法！](http://www.youtube.com/watch?v=-FRm3VPhseI "清洁代码会谈 -")

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-09T12:03:55.700

我使用单例的一种方法是为应用程序实现一个“主控制器”对象。这有点像您使用 VBA 获得的 Application 对象。

该对象执行各种启动和关闭任务。它还提供对应用程序范围的设置和服务的访问。这包括命令行参数的值和日志服务等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T11:55:10.977

如果您有一个需要大量初始化的资源并且您多次使用的资源，例如当您使用[ORM](http://en.wikipedia.org/wiki/Object-relational_mapping)或某种连接时的对象上下文，您会发现单例模式很有用。

显然你必须注意，保持这个东西活着并不比每次都重新创建它花费更多。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-02-11T07:24:24.947

这不是单例，因为单例通过只读关键字提供线程安全。

例如，

```
public sealed class Singleton
{
    // private static Singleton instance; (instead of this, it should be like this, see below)
    private static readonly Singleton instance = new Singleton();

    static Singleton(){}

    private Singleton() {}

    public static Singleton Instance
    {
        get
        {
            if (instance == null)
                instance = new Singleton();
            return instance;
        }
    }
} 
```

通过使用它，它将提供胎面安全性和正确的单例模式（这就是它与静态类的不同之处）。您的单例代码不是线程安全的。

有关单例的更多信息，请查看以下链接：

*   [http://cshapindepth.com/articles/general/singleton.aspx](http://csharpindepth.com/articles/general/singleton.aspx)
*   [http://aspalliance.com/70_Session_Based_Singleton_Object](http://aspalliance.com/70_Session_Based_Singleton_Object)

# sql - FREETEXTTABLE 返回不正确的排名结果

> ID：733843
> 
> 赞同：1
> 
> 时间：2009-04-09T11:42:14.503
> 
> 标签：sql, sql-server, freetexttable

我正在尝试修复站点搜索功能的错误，并将其隔离为 FREETEXTTABLE 功能的问题。

我有以下查询：

```
SELECT * FROM dbo.SiteContentForSearch INNER JOIN FREETEXTTABLE(SiteContentForSearch, sSearchText, 'NFC' ) AS SearchResultTable 

ON dbo.SiteContentForSearch.liSearchID = SearchResultTable.[Key] 
```

对于 sSearchText 列中存在“NFC”的许多行，这将返回大于 0 的排名。然而，有（至少）一行它返回 o 的等级。它具有以下文本，如您所见，其中包含几次 NFC。有任何想法吗？

> 支付和票务 非接触式智能卡 非接触式智能卡技术已成功应用于许多领域。例如：零售商正在使用非接触式智能卡支付来增加购物篮大小并减少排队交通运营商正在使用非接触式智能卡（ITSO、Oyster 等）来简化后端流程并改善客户体验活动和场地运营商正在使用 RFID 腕带和手环来有效和安全票务和访问控制近场通信 (NFC) 和移动支付在推动移动支付和票务市场方面，手机技术近场通信 (NFC) 可能是答案。由于 NFC 不需要特殊的销售点非接触式读卡器，NFC 可以与现有的非接触式基础设施无缝集成。但是随着几年后大众市场的采用，您现在应该怎么做？使用非接触式智能卡、NFC 和移动支付长期以来我们一直在帮助客户改善使用 RFID 和移动电话技术的客户体验。因此，我们可以整合所有主要的支付方案。我们可以帮助您：了解您的客户的用户旅程，以获得正确的核心应用程序，例如支付和票务创新，例如使用 RFID 标签或带有数字标牌的 NFC 来个性化实时客户优惠在我们的 NFC 框架内构建和测试 NFC 应用程序 NFC 和移动支付长期以来，我们一直在帮助客户改善使用 RFID 和手机技术的客户体验。因此，我们可以整合所有主要的支付方案。我们可以帮助您：了解您的客户的用户旅程，以获得正确的核心应用程序，例如支付和票务创新，例如使用 RFID 标签或带有数字标牌的 NFC 来个性化实时客户优惠在我们的 NFC 框架内构建和测试 NFC 应用程序 NFC 和移动支付长期以来，我们一直在帮助客户改善使用 RFID 和手机技术的客户体验。因此，我们可以整合所有主要的支付方案。我们可以帮助您：了解您的客户的用户旅程，以获得正确的核心应用程序，例如支付和票务创新，例如使用 RFID 标签或带有数字标牌的 NFC 来个性化实时客户优惠在我们的 NFC 框架内构建和测试 NFC 应用程序

干杯

史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-23T10:18:57.053

我自己目前有一些 FreeTextTable 问题，并且对此问题的标记答案是：

[FREETEXTTABLE 为什么或如何给出比其他更高的排名值](https://stackoverflow.com/questions/210094/why-or-how-does-freetexttable-give-a-rank-value-higher-then-others)

其中包含此链接

[http://msdn.microsoft.com/en-us/library/ms345119%28SQL.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms345119%28SQL.90%29.aspx)

解释了 FreeTextTable 如何在数学中发挥作用。特别是参考OKAPI BM25排名公式。

数学部分下面是关于排名公式问题的部分。显然，您问这个问题已经 16 个月了，但也许这个答案会帮助其他有类似问题的人。如果您通过实施算法逐步解决问题和元问题，您可能会看到它可能会在哪里崩溃。

HTH（某人……）

编辑：也是这个问题的答案：

[FREETEXTTABLE 的等级始终为 0](https://stackoverflow.com/questions/3097166/freetexttable-always-has-a-rank-of-0)

包括这个链接

[http://msdn.microsoft.com/en-us/library/ms142524.aspx](http://msdn.microsoft.com/en-us/library/ms142524.aspx)

这是上一个链接中包含的有关排名公式如何工作的信息的更平易近人的摘要。

# c# - == 对象被装箱时运算符重载

> ID：733848
> 
> 赞同：5
> 
> 时间：2009-04-09T11:44:33.310
> 
> 标签：c#

以下代码的输出如下：

***不等于
等于***

请注意 x 和 xx 类型的差异，并且 == 运算符重载仅在第二种情况下执行，而不在第一种情况下执行。

有没有一种方法可以重载 == 运算符，以便在 MyDataObejct 实例之间进行比较时*始终执行它。*

**编辑 1:#**在这里我想覆盖 MyDataClass 上的 == 运算符，我不确定我该怎么做才能让 case1 也执行重载的 == 实现。

```
class Program {
    static void Main(string[] args) {
        // CASE 1
        Object x = new MyDataClass();
        Object y = new MyDataClass();
        if ( x == y ) {
            Console.WriteLine("equal");
        } else {
            Console.WriteLine("not equal");
        }

        // CASE 2 
        MyDataClass xx = new MyDataClass();
        MyDataClass yy = new MyDataClass();
        if (xx == yy) {
            Console.WriteLine("equal");
        } else {
            Console.WriteLine("not equal");
        }
    }
}

public class MyDataClass {
    private int x = 5;

    public static bool operator ==(MyDataClass a, MyDataClass b) {
        return a.x == b.x;
    }

    public static bool operator !=(MyDataClass a, MyDataClass b) {
        return !(a == b);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T11:46:35.490

不，基本上。`==`使用静态分析，因此将使用 object `==`。听起来您需要使用多态性来`object.Equals(x,y)`代替（或者`x.Equals(y)`如果您知道两者都不为空）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T12:06:20.623

下面是关于如何覆盖 Equals 和 == 运算符的描述：

[http://msdn.microsoft.com/en-us/library/ms173147(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173147(VS.80).aspx)

这就是它的外观（前提是您已经对 Equals() 进行了重载）：

```
public static bool operator ==(MyDataClass a, MyDataClass b)
{
    // If both are null, or both are same instance, return true.
    if (System.Object.ReferenceEquals(a, b))
    {
       return true;
    }

    // If one is null, but not both, return false.
    if (((object)a == null) || ((object)b == null))
    {
       return false;
    }

    // Otherwise use equals
    return a.Equals(b);
}

public override bool Equals(System.Object obj)
{
    // If parameter is null return false.
    if (obj == null)
    {
        return false;
    }

    // If parameter cannot be cast to MyDataClass return false.
    MyDataClass p = obj as MyDataClass;
    if ((System.Object)p == null)
    {
        return false;
    }

    return (x == p.x);
} 
```

# delphi - Delphi 2009 如何转换 Delphi 7 项目重新构建配置

> ID：733850
> 
> 赞同：4
> 
> 时间：2009-04-09T11:45:16.353
> 
> 标签：delphi, configuration, build, delphi-2009, delphi-7

我经常在 D7 和 D2009 之间移动，使用两者都可以使用的库代码。

为了便于双向使用，我会定期删除所有创建的 D2009 附加文件，例如：*.dproj 等，这样在进入 D2009 时我只会获取 D7 文件。
这很好，因为 D2009 会自动生成 *.dproj、*.dgroup 等，并且除了在进入 D2009 时通知每个项目已升级，您可以立即构建。

我有两台相同的机器，每台都装有 D2009。

'好' 做我上面列出的，用默认的构建配置'base'、'debug'和'release'创建一个升级的项目。查看这些，我可以看到从 Delphi 7 *.dof 文件复制的选项（例如编译器选项和输出目录等）。

在提供给它的相同 D7 项目的“坏”机器上，尽管它“升级”了项目，但它不会导入编译器选项和输出目录设置。
我根本没有摆弄构建配置。
我可以手动导入保存在好机器上的一组选项，但这很乏味，我想找出为什么“坏”机器会以不同的方式运行。

是否有一个“主”构建配置现在可能有一个时间/日期让 D2009 认为我想要它而不是默认升级？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-17T20:03:45.970

我刚刚遇到了这个确切的问题。

在我的[拖放组件](http://melander.dk/delphi/dragdrop "拖放组件套件")中，虽然我支持 Delphi 5 到 Delphi 2010，但我只分发自由文件。我这样做是为了避免让 dof 和 dproj 文件保持同步。现在突然间 dof 文件中的搜索路径设置没有被导出到 dproj 文件中。

我找到的解决方案是删除我不需要的所有内容的自由文件：

```
[FileVersion]
Version=7.0
[Directories]
OutputDir=.
UnitOutputDir=.
SearchPath=..\..\Source 
```

通过此更改，可以正确导入 dof 文件。

我没有时间（也没有理由或动机）来精确调查 dof 文件中的哪个条目阻止了 SearchPath 被导出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T14:15:20.637

好的，只是几个问题，你有两台机器，好坏（而不是丑）。该商品从 7 项目创建一个有效的 2009 年项目。但不好的是错过了编译器选项和目录设置。

首先，您确定您提供了 .cfg 文件吗？此信息需要此信息。

接下来，哪个顺序是安装的delphi版本。如果在最旧版本之前安装了最新版本，则可能会出现一些问题。以正确的顺序安装它们没有问题。（我在同一台机器上有 6、7、8、2006、2007、2009 没有问题）。

你说问题是“突然”发生的。你能回忆起在问题开始之前在坏机器上发生了什么变化吗？

如果你有时间，你可以尝试重新安装任何东西。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-24T12:35:09.080

您的项目中有相对路径吗？似乎 D2009（或一般的 BDS ide）对用于解析部分路径的工作目录的反应略有不同。

有时当您文件->打开文件时，所有相对路径突然都相对于该打开文件的路径。这种状态似乎也更加持久。

要排除此类问题，请从项目组的每个项目的相应 .dpr/.bdsproj/.dproj 目录中打开一个文件并进行构建。

# jakarta-ee - 如何转发到 j_security_check？

> ID：733856
> 
> 赞同：2
> 
> 时间：2009-04-09T11:47:16.520
> 
> 标签：jakarta-ee, jboss, jaas

我正在使用基于表单的身份验证（JBOSS/JAAS），但我的表单正在将数据发送到我的 Servlet，因此我可以在尝试登录之前执行一些检查。

现在我需要转发到 j_security_check 但我尝试的方法不起作用（404 错误）...

如何重定向/转发到 j_security_check（请注意应用程序通过 https / sssl 运行）？

我可以通过重定向使其工作，并且参数进入 URL，但这不安全（因为用户/通行证保留在浏览器历史记录中，等等）...

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T11:55:42.333

`j_security_check`Tomcat 仅在之前为该会话启动登录过程时才接受请求。所以首先你需要尝试访问一个安全约束资源。然后 Tomcat 会将您重定向到登录表单。只有这样你才能访问`j_security_check`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T14:05:02.760

我看到这是一个旧帖子，但我想分享一个答案。

如果原始请求是 POST，您可以在进行一些处理后简单地转发到 j_security_check。

```
...
request.getParameterMap().put( "j_username", new String[]{ userId } );
request.getParameterMap().put( "j_password", new String[]{ password } );

try 
{
    request.getRequestDispatcher("/j_security_check").forward( request , response );
    return null;
} 
catch (ServletException e) 
{
    logger.error( e );
} 
catch (IOException e)
{
    logger.error( e );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-10T10:53:52.353

我知道这是一个太老的问题，但我遇到了同样的问题，我发现解决它的独特方法是使用这样的东西：

```
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    String user = req.getParameter("j_username");
    String pass = req.getParameter("j_password");

    resp.sendRedirect("/Project-web/j_security_check?j_username=" + user    + "&j_password=" + pass);

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-26T13:13:42.093

由于我刚刚遇到同样的问题，而其他答案并没有证明对我有用，我想分享我自己的解决方案：

1) 创建一个新的 JSP，比如 loginForward.jsp，仅用于转发目的：

```
<%@ page language="java" %>
<%
    final String username = request.getParameter("j_username");
    final String password = request.getParameter("j_password");
%>
<body onload="document.getElementById('creds').submit()">
    <form name="creds" id='creds' method="POST" action="j_security_check">
        <input type="hidden" name="j_username" value="<%= username %>">
        <input type="hidden" name="j_password" value="<%= password %>">
    </form>
</body> 
```

2) 在您的 servlet 中，转发到该 JSP：

```
final String redirectURL = String.format("loginForward.jsp j_username=%s&j_password=%s", username, password);
RequestDispatcher requestDispatcher = request.getRequestDispatcher(redirectURL);
requestDispatcher.forward(request, response);
return; 
```

# .net - AppDomain、程序集、进程和线程之间的区别

> ID：733868
> 
> 赞同：51
> 
> 时间：2009-04-09T11:49:27.573
> 
> 标签：.net

**AppDomain**、**Assembly**、**Process**和**Thread**之间有什么区别？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-04-09T11:58:50.500

AppDomain 是进程中的一个隔离单元。AppDomain 可以在运行时创建、加载代码和卸载。它是一个隔离边界，旨在使 .NET 应用程序更可靠。

一个程序集包含一个或多个模块，这些模块包含已编译的代码块。您通常会将程序集视为 .EXE 或 .DLL。

进程是一个正在执行的应用程序（waaaay 过于简单化了）。

线程是一个执行上下文。操作系统在线程内执行代码。操作系统在线程之间切换，允许每个线程依次执行，从而给人以多个应用程序同时运行的印象。

把它们放在一起（非常简化）......

执行程序。一个进程由操作系统创建，并在其单个线程中开始加载代码以执行。在 .NET 应用程序中，单个 AppDomain 由 CLR 创建。应用程序的执行程序集（.EXE）被加载到这个 AppDomain 并开始执行。应用程序可以生成新进程、创建 AppDomain、将其他程序集加载到这些域中，然后创建新线程以在任何这些 AppDomain 中执行代码。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-23T07:14:22.917

CLR 的 JIT 编译器的最大优势之一是 - 它可以防止进程的虚拟地址空间重叠。例如，如果进程 1 被生成并且 CLR (MScorEE.dll) 正在管理该进程中托管程序集 (.exe 或 .dll) 的执行，则 JIT 编译器将确保分配给该进程的虚拟地址空间进程不会与其他相邻进程发生冲突或重叠。有了这个优势，现在可以重复使用单个进程来执行多个托管代码！每个托管代码执行都将有自己的 AppDomain，并且多个 AppDomain 可以是单个进程的一部分。这是 IIS 和 SQL Server 使用的（单个进程，许多 AppDomains）。

汇编是一个抽象术语，表示托管代码的单个可重用组件。汇编由元数据（PE32 或 PE32+ 标头 + IL 标头）和 IL 指令组成。CLR 的 JIT 编译器根据处理器及其架构（x86 或 x64）编译和转换 IL 汇编为机器特定的指令集。

进程是操作系统用来促进程序执行的东西。进程是具有地址空间的程序的“RAM 表示”，该地址空间由堆栈、堆、静态和代码区域组成。每个进程都有一个与之关联的唯一进程 ID。

线程是一个轻量级的进程。一个进程至少有一个线程（即主线程），并且取决于并行性，操作系统可以在单个进程中创建多个线程并在它们之间进行上下文切换，以支持更快的程序执行。线程可以在进程内共享一些内存区域。

# asp.net - MySQL 与 SQL Server 2005/2008 性能对比

> ID：733870
> 
> 赞同：6
> 
> 时间：2009-04-09T11:50:30.223
> 
> 标签：asp.net, mysql, sql-server, performance

我打算开始开发一个 ASP.NET 应用程序，我想知道使用哪个数据库。性能非常重要，数据库应该能够毫无问题地处理大约 50GB 的数据库。但是，我想知道 SQL Server 许可证是否值得付费。我一直在寻找 MSSQL Server (2005/2008) 和 MySQL 之间的性能和可伸缩性比较，但我似乎找不到任何好的测试。您能否指出与该主题相关的一些广泛的基准？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T11:58:04.900

如果您进行大量读取，MySQL 传统上非常快。例如，在一个网站中，可能有 100 比 1 的读写比率，因此 MySQL 运行良好。如果您正在计划一个高事务数据库，那么直接使用 MSSQL。如果钱不是问题，直接使用 MSSQL，因为它是一个更好的产品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T12:19:51.293

如前所述，只要您使用默认表类型，MySQL 就可以提供高读取性能（假设简单查询很少或没有连接）。

但是，您还说数据库大小为 50GB，这表明您可能正在寻找能够*可靠*存储信息的数据库。无论如何，使用默认表类型 MySQL 都不是一个可靠的数据库。

如果您想要一个快速、免费的 MS SQL 替代品，那么 PostgreSQL 可能是一个不错的选择 - 它快速可靠，并且具有更开放的许可证（如果您将 MySQL 用于商业项目，您需要非常仔细地阅读它的双重许可证）。PostgreSQL 唯一的缺点是它与 Oracle 有一些相同的 DBA 专家要求，因为 MS SQL 通常可以由普通的 IT 人员管理，而 MySQL 除了每次决定恢复旧备份之外不需要太多管理。损坏并丢失您的数据。

# c# - 使用 C# 将文本文件从 ANSI 转换为 ASCII

> ID：733871
> 
> 赞同：19
> 
> 时间：2009-04-09T11:50:57.837
> 
> 标签：c#, encoding, character-encoding, ascii

我有一个 ANSI 编码的文件，我想将从文件中读取的行转换为 ASCII。

我该如何在 C# 中执行此操作？

* * *

**编辑：**如果我使用“BinaryReader” `BinaryReader reader = new BinaryReader(input, Encoding.Default);` 但是这个阅读器需要（Stream，Encoding）但“Stream”是一个抽象怎么办！我应该把他将从中读取的文件的路径放在哪里？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-09T11:55:53.347

从 ANSI 到 ASCII 的直接转换可能并不总是可行的，因为 ANSI 是 ASCII 的超集。

不过，您可以尝试使用 UTF-8 转换为 UTF-8 `Encoding`：

```
Encoding ANSI = Encoding.GetEncoding(1252);

byte[] ansiBytes = ANSI.GetBytes(str);
byte[] utf8Bytes = Encoding.Convert(ANSI, Encoding.UTF8, ansiBytes);

String utf8String = Encoding.UTF8.GetString(utf8Bytes); 
```

当然你可以用 ASCII 替换 UTF8，但这并没有什么意义，因为：

*   如果原始字符串不包含任何大于 126 的字节，那么它已经是 ASCII
*   如果原始字符串确实包含一个或多个大于 126 的字节，那么这些字节将丢失

**更新：**

针对更新后的问题，您可以`BinaryReader`这样使用：

```
BinaryReader reader = new BinaryReader(File.Open("foo.txt", FileMode.Open),
                                       Encoding.GetEncoding(1252)); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-09T11:56:25.093

基本上，您需要`Encoding`在读取/写入文件时指定一个。例如：

```
// read with the **local** system default ANSI page
string text = File.ReadAllText(path, Encoding.Default); 

// ** I'm not sure you need to do this next bit - it sounds like
//  you just want to read it? **

// write as ASCII (if you want to do this)
File.WriteAllText(path2, text, Encoding.ASCII); 
```

请注意，一旦您阅读了它，它`text`在内存中实际上是 unicode。

您可以使用 选择不同的代码页`Encoding.GetEncoding`。

# version-control - 有没有地方可以在线托管您的代码？

> ID：733875
> 
> 赞同：19
> 
> 时间：2009-04-09T11:52:51.683
> 
> 标签：version-control, repository, hosting, revision-history

有许多免费的在线服务为您提供了很大的空间来存储您的个人资料、邮件等。但是有没有什么地方可以让我们托管我们的代码 - 保留更改历史记录？

[Google Code](http://en.wikipedia.org/wiki/Google_Code)或[SourceForge](http://en.wikipedia.org/wiki/SourceForge)可能不是一个理想的地方，因为它需要创建一个特定且对其他人有用的项目，而我想要的是一个存放任何我认为有用但可能对其他人没有用的代码的地方。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-09T23:07:45.313

这都是关于[Github](http://www.github.com)的。300 MB 存储库免费。界面美观，使用方便。另外，我们都知道 GIT > SVN :)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-09T11:57:16.090

[您可以在unfuddle.com](http://unfuddle.com/)获得免费的 GIT 和 SVN 托管

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-09T12:01:25.143

[BitBucket](http://bitbucket.org)允许公共和私有 Mercurial 存储库。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-09T11:54:34.160

Github 有可能对你有用的[Gists 。](http://gist.github.com/)此外，[Snipplr](http://snipplr.com/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-09T12:02:36.030

[http://codeplex.com](http://codeplex.com)是 MS通过 Team Foundation Server 提供开源控制**的地方。**

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-01T17:57:51.187

[projectlocker](http://projectlocker.com/)也是免费 Subversion、Git 托管的不错选择。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-01T17:39:33.557

您还可以在[http://beanstalkapp.com/](http://beanstalkapp.com/)获得免费的私有 SVN 托管。他们的 100MB 包是免费的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-09T23:22:59.207

谷歌代码[链接](https://www.google.com/accounts/ServiceLogin?service=code&ltmpl=phosting&continue=http%3A%2F%2Fcode.google.com%2Fhosting%2F&followup=http%3A%2F%2Fcode.google.com%2Fhosting%2F)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-09T12:00:38.267

付费的[http://cvsdude.com/或免费的](http://cvsdude.com/)[http://xp-dev.com/](http://xp-dev.com/)怎么样。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-12-06T07:01:16.777

来吧伙计们，你没看到他只对在线托管一些代码片段感兴趣，比如一些功能等，而不是完整的项目，也不是公开的而是私有的。当然，您在帖子中所说的每一个解决方案都是可能的，但这并不是他想要的。你们都像垃圾邮件发送者一样回复，这很有趣

那么你为什么不直接使用[http://gist.github.com/](http://gist.github.com/)

正如有人已经提到的

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-09T11:54:52.303

如果你想使用 Subversion，你可以在[DevjaVu](http://www.devjavu.com/)上托管私人项目。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-09T11:55:08.653

[http://www.svnhostingcomparison.com/](http://www.svnhostingcomparison.com/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-09T11:55:59.773

[CVSDude](http://cvsdude.com/)提供免费的 2M subversion 存储库，如果您付费也可以使用 CVS。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-09T12:05:01.703

我使用[http://planetsourcecode.com/](http://planetsourcecode.com/ "现在去那里！")来存储各种代码。用户甚至上传整个应用程序。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-09T12:25:23.837

甚至还有可用的在线代码编辑器（嗯，一种，该项目仍处于开发阶段）。

[链接： https](https://bespin.mozilla.com) ://bespin.mozilla.com/

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-01T17:23:56.933

我已经使用 CodeSpaces 一年多了，从来没有遇到过问题。我是新用户，所以我显然无法发布链接......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-01-05T03:54:10.580

已经提交了很多适合托管成熟应用程序的答案，所以我不会费心添加到列表中，但是如果您正在考虑托管带有修订历史的较小的东西（代码片段，更简单的项目），您可以考虑使用一个维基？

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-05-29T01:30:11.953

我知道这是 4 年前发布的，但你总是可以在[Pastebin](http://pastebin.com/)上注册并在那里拥有私有源代码。

Pastebin 自 2002 年以来一直存在，目前是“#1 粘贴工具”。它支持多种语法（包括 C++、C、Ruby 和 Java。网站上的完整列表。）

**编辑;**

他们的 PRO 计划一个月只需 2.95 美元，如果您购买一整年，每月只需 1.99 美元。您可以在[此处](http://pastebin.com/pro)了解有关免费与专业版限制的更多信息。

**编辑2；**

如果不出意外，请注册 Dropbox、SkyDrive 或 Mediafire 并在那里上传您的文件。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-06-06T16:31:29.687

[Team Services](https://www.visualstudio.com/products/visual-studio-team-services-vs)具有免费、私有、无限制的 Git 存储库，用于[版本控制](https://www.visualstudio.com/features/version-control-vs)。您还可以获得集成的错误和工作项跟踪、用于[DevOps的企业](https://www.visualstudio.com/features/alm-devops-vs)[敏捷工具](https://www.visualstudio.com/features/agiletools-vs)，例如积压和看板、自动构建、测试和发布，以及用于构建和发布应用程序的其他团队功能。

您可以连接 Xcode、Eclipse、IntelliJ、Android Studio、Visual Studio 或任何您喜欢的开发工具。

Team Services 对前 5 名具有基本访问权限的用户、处理积压工作的无限利益相关者和 Visual Studio 订阅者是免费的。以下是[如何开始使用 Team Services](https://www.visualstudio.com/docs/setup-admin/team-services/sign-up-for-visual-studio-team-services)。

# c++ - “调用失败，未执行”

> ID：733879
> 
> 赞同：0
> 
> 时间：2009-04-09T11:53:56.767
> 
> 标签：c++, windows, rpc

我有一个使用 Microsoft RPC 进行进程间通信的程序。当调用带有 [in, string] 参数的方法时（MIDL 表示法）：

```
interface IOurInterface
{
    error_status_t rpcMethod( [in, string] const WCHAR* parameter );
} 
```

调用它通常是成功的。但是如果参数字符串足够长（超过大约 300 万个字符），调用会失败并显示 RPC_S_CALL_FAILED_DNE（“远程过程调用失败并且没有执行。”）。这肯定取决于字符串的长度。如果字符串在限制范围内，相同条件下的相同调用始终成功，如果字符串较长，则始终失败。看起来限制也取决于系统或机器。

有没有人观察到这种行为以及可能的解决方案是什么（不缩短参数）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:52:07.597

我之前观察过该消息，但我不认为这是相同的原因 - “未执行”是一个通用的 RPC 错误，可能由许多事情引起。

在我们的特殊情况下，这是因为我们过于用力地敲击 WMI 而没有清理我们的对象。但在你的情况下，这似乎是一个不同的原因。

我知道您说您不想缩短参数，但这可能是您前进的唯一途径。我很难想象您需要通过 RPC 调用发送 6M 的情况。也许如果您解释其背后的原因，我们可以提供进一步的帮助。

基于迄今为止的评论的其他可能性：

1/ 分割。

让 RPC 调用限制通过网络传输的数据量。这可以通过在源处对消息进行分段并在目标处对其进行重构来完成，例如具有三个参数（您可以让服务器在另一个 RPC 调用中分发消息标识符或找到其他方法来确保没有两个客户端具有相同的ID）： - 消息标识符（用于将消息段捆绑在一起）。- 最后一个标志（开始重建过程）。- 有限大小的段（例如，1M）。

2/ 压缩。

由于 XML 是文本，因此压缩的时机已经成熟。7zip 库是我见过的在减小尺寸方面最好的库。这是否足够快是另一回事。

3/*可能*通过更改注册表来修复。

查看 RpcMaxSize 键的 HKLM/Software/Microsoft/Rpc 注册表区域。我用谷歌搜索了几个网站，建议将其设置为 -1 将消除大小限制（全球范围内，所以要小心）。

4/注册界面时*可能*的修复。

您显然可以在特定接口上实现与 (3) 相同的效果`RpcServerRegisterIf2()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T12:52:31.650

作为一个整体，每个 RPC 调用的大小通常受到各种因素的限制，例如传输限制（例如：UDP 上的数据包大小、比特率/最大延迟）

您可以做的是将字符串拆分为数据包并通过多次调用发送，

或打开一个额外的 tcp 套接字来发送您的数据并使用您当前的 RPC 控制它

# django - Iterate over choices in CheckboxSelectMultiple

> ID：733880
> 
> 赞同：15
> 
> 时间：2009-04-09T11:54:03.880
> 
> 标签：django, django-forms

I have a CheckboxSelectMultiple field, why can't I iterate over the single choices?

This doesn't work:

```
 {%for choice in form.travels.choices%}
    {{choice}}
  {%endfor%} 
```

Even specifying `{{choice.0}}` doesn't help, how could i do this?

Thanks

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-09T12:35:40.053

Inside the template, the `travels` field as actually an instance of `BoundField` (which is a Django object that binds together the field and its value for rendering). This means the properties are somewhat different.

To iterate over the choices as a tuple:

```
{% for choice in form.travels.field.choices %}
    {{ choice }} - 
{% endfor %}

Produces: (1, 'One') - (2, 'Two') - 
```

To iterate over the elements in the choice tuples separately:

```
{% for choice_id, choice_label in form.travels.field.choices %}
    {{ choice_id }} = {{ choice_label }} <br/>
{% endfor %}

Produces: 1 = One
          2 = Two 
```

Hope that helps. Having said that, though, I'm not sure of the context in which you're needing to do this; on the surface, it doesn't seem very django-like. You may find that using a custom form field or a custom template tag gives you a more portable, re-usable implementation that better maintains django's intended separation between view code and template code. Of course, YMMV and it could well be that the direct iteration approach is appropriate for you in this case.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T09:14:00.820

if you have a Form.ModelForm with a choice field, you can itrate it in the template by a simple template filter.

forms.py

```
 STATE_CHOICES = (
    (10, 'NO'),
    (4, 'YES'),
    (18, 'Send to another Chemist for Review'),
    (34, 'Send to another Market Expert for Review'),
    (20, 'HOLD'),
)
new_state = forms.ChoiceField(
    choices=STATE_CHOICES,
    required=True,
) 
```

Template:

```
{{ business_manager_form.new_state|filter_project_states:project }} 
```

and here is the filter it self.

```
@register.filter()
def filter_project_states(argv, project):
if project.department.id != 4:
argv.field.choices = [choice for choice in argv.field.choices if choice[0] != 34]
return argv 
```

I hope this helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-05T19:23:33.927

If you wish to customize the rendering of the field, you can use the same technique that is outline in the section for the [`RadioSelect` widget](https://docs.djangoproject.com/en/3.2/ref/forms/widgets/#django.forms.RadioSelect) in the docs.

The following is straight from the docs. You have a form `myform` with a `RadioSelect` field `beatles`. You can access the different elements like so:

```
<fieldset>
    <legend>{{ myform.beatles.label }}</legend>
    {% for radio in myform.beatles %}
    <label for="{{ radio.id_for_label }}">
        {{ radio.choice_label }}
        <span class="radio">{{ radio.tag }}</span>
    </label>
    {% endfor %}
</fieldset> 
```

I have just tried it with a `CheckboxSelectMultiple` and it works the same way.

# oop - 从对象数据中分离对象方法

> ID：733886
> 
> 赞同：0
> 
> 时间：2009-04-09T11:55:26.670
> 
> 标签：oop

遵循 SRP 和 KISS 原则，我设计了一个仅具有属性的对象，但我需要使用这些对象的方法。分离实体对象数据和实体集对象方法的最佳方法是什么？

目前我创建了以下对象：

宠物实体对象
属性名称
属性年龄

Pet Entity Set 对象
Pet 对象列表

宠物引擎对象
方法宠物实体集
的LoadPets方法宠物实体的
GetPetByName方法宠物实体集 的GetPetsByAge

这是设计对象的最佳方式吗？

我正在.net 中开发

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T12:02:33.410

您已经实现了[贫血域模型](http://www.martinfowler.com/bliki/AnemicDomainModel.html)反模式。类应该实现他们需要的方法，这不会破坏 SRP，但恕我直言，SRP 无论如何都被高估了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T12:03:13.983

总的想法是让方法接近他们操作的数据。结合数据和操作的构造称为*类*。

说真的，为什么您认为将数据与操作分开是个好主意？这与我们几十年来的发展方向相反！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T13:38:08.950

使用支持模式匹配的函数式语言。由于您使用的是 .net，因此 F# 是显而易见的选择。

这适用于面向消息的系统，在这些系统中，大多数无状态节点会转换消息，然后将消息传递到其他节点。在这些场景中，您不关心消息中的数据的变化，也不关心消息的身份；您关心推进每个节点中的处理并发送更多消息。

你不是在做面向对象的设计，面向对象的语言不能很好地支持这种范式——它们将一个可变的数据包绑定到一个具有身份的对象上，而不是创建一个消息转换器的反应系统。

In effect, this requires you to take the [dual](http://en.wikipedia.org/wiki/Dual_graph) of the system - the messages in a reactive system correspond to the method and arguments in object oriented systems. Roughly, the state which is in the fields of the objects of an OO program is kept the call stack of a reactive program, and the state which is the call stack of the OO program is kept in the fields of the messages in the reactive program.

# visual-studio - 如何将 Visual Studio 的集成帮助替换为基于浏览器的 Web 搜索？

> ID：733895
> 
> 赞同：2
> 
> 时间：2009-04-09T11:57:08.850
> 
> 标签：visual-studio, msdn

> **可能重复：**
> [从 Visual Studio 在浏览器中加载搜索 URL](https://stackoverflow.com/questions/1334212/load-search-url-in-browser-from-visual-studio)

在 VS 中按 F1 会启动 Microsoft 的 Document Explorer。我怎样才能在我的网络浏览器中打开帮助结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:05:19.313

查看“帮助”/“在线”下的“选项”。

在那里你可以选择 - 先尝试在线，然后本地

您可以选择多个提供商进行搜索。

# asp.net - 错误：不是有效的虚拟路径

> ID：733896
> 
> 赞同：0
> 
> 时间：2009-04-09T11:57:12.297
> 
> 标签：asp.net, vb.net, virtual, path

我使用了类似 Dim i As String i = Server.MapPath("~/photos/") + fileName 之类的东西，在一个正在工作和在线的项目中，在离线版本上，当我在我的机器上运行它时，它的工作，没有错误，我上传了它，它给了我一个错误，例如：

> '~/照片/ [http://www](http://www)。**MyURL** .com/photos/4411568359267Pic003.jpg' 不是有效的虚拟路径。

在我的代码中指出一行：

```
 var marker = new GMarker(new GLatLng(<%=coordinates%>)); 
```

这以前从未发生过，我不知道从哪里开始故障排除，因为这个脚本 -Google 地图 - 甚至不需要图像，我试图将其注释掉，它给了我同样的错误，但这次使用了不同的脚本, 显示文本区域的格式工具栏

```
Line 8:  new nicEditor({buttonList : ['fontSize','fontFamily','fontFormat','bold','italic','underline','strikethrough','forecolor','bgcolor','removeformat'], iconsPath : '../nicEdit/nicEditorIcons.gif'}).panelInstance('<%= txtDescription.ClientID %>'); 
```

..请帮忙 ：'（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T15:41:28.927

您可以发布您的文件上传 aspx 页面和您的功能，以便我们对其进行故障排除。“'~/photos/ [http://www.MyURL.com/photos/4411568359267Pic003.jpg](http://www.MyURL.com/photos/4411568359267Pic003.jpg) '” 仔细查看 url，它将完整的 url 附加到“i”。您使用什么类型的控件，通用控件或服务器端控件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T11:29:34.997

解决了，原来错误是由于我将整个路径存储在文件名中时的旧数据库记录...谢谢 Joshua 和 Keltex

# c# - C# 启动一个新的 MailTo 进程和 HTML URL 编码

> ID：733899
> 
> 赞同：1
> 
> 时间：2009-04-09T11:58:04.900
> 
> 标签：c#, process, url-encoding, mailto, processstartinfo

我为 Process 类创建了一个新的 MailTo 扩展方法，它只是用一个包含所需 mailto 参数的新 ProcessStartinfo 填充 Process。我创建了一个名为 FormatMailToArgument 的方法（最后右），它将控制字符转换为它们的 Url Encoded equivelants 并且已经测试了它并且它有效但是有没有更好的方法来做到这一点？

```
/// <summary>
/// <see cref="Process"/> extension methods.
/// </summary>
public static class Processes
{
    #region MailTo

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="mailMessage">The mail message.</param>
    public static void MailTo(this Process process, MailMessage mailMessage)
    {
        MailTo(
            process,
            mailMessage.To.ToDelimetedString(),
            mailMessage.CC.ToDelimetedString(),
            mailMessage.Bcc.ToDelimetedString(),
            mailMessage.Subject,
            mailMessage.Body);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    public static void MailTo(this Process process, IEnumerable<string> to)
    {
        MailTo(
            process,
            to.ToDelimetedString(Character.SemiColon),
            null,
            null,
            null,
            null);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    /// <param name="subject">The email subject.</param>
    public static void MailTo(this Process process, IEnumerable<string> to, string subject)
    {
        MailTo(
            process,
            to.ToDelimetedString(Character.SemiColon),
            null,
            null,
            subject,
            null);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    public static void MailTo(
        this Process process,
        IEnumerable<string> to,
        string subject,
        string body)
    {
        MailTo(
            process,
            to.ToDelimetedString(Character.SemiColon),
            null,
            null,
            subject,
            body);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    /// <param name="cc">The Cc email addresses.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    public static void MailTo(
        this Process process,
        IEnumerable<string> to,
        IEnumerable<string> cc,
        string subject,
        string body)
    {
        MailTo(
            process,
            to.ToDelimetedString(Character.SemiColon),
            cc.ToDelimetedString(Character.SemiColon),
            null,
            subject,
            body);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any 
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    /// <param name="cc">The Cc email addresses.</param>
    /// <param name="bcc">The Bcc email addresses.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    public static void MailTo(
        this Process process,
        IEnumerable<string> to,
        IEnumerable<string> cc,
        IEnumerable<string> bcc,
        string subject,
        string body)
    {
        MailTo(
            process,
            (to == null) ? null : to.ToDelimetedString(Character.SemiColon),
            (cc == null) ? null : cc.ToDelimetedString(Character.SemiColon),
            (bcc == null) ? null : bcc.ToDelimetedString(Character.SemiColon),
            subject,
            body);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses.</param>
    /// <param name="cc">The Cc email addresses.</param>
    /// <param name="bcc">The Bcc email addresses.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    /// <param name="attachmentPath">The attachment file path.</param>
    public static void MailTo(
        this Process process,
        IEnumerable<string> to,
        IEnumerable<string> cc,
        IEnumerable<string> bcc,
        string subject,
        string body,
        string attachmentPath)
    {
        MailTo(
            process,
            (to == null) ? null : to.ToDelimetedString(Character.SemiColon),
            (cc == null) ? null : cc.ToDelimetedString(Character.SemiColon),
            (bcc == null) ? null : bcc.ToDelimetedString(Character.SemiColon),
            subject,
            body,
            attachmentPath);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any 
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses delimeted by a semi-colon.</param>
    /// <param name="cc">The Cc email addresses delimeted by a semi-colon.</param>
    /// <param name="bcc">The Bcc email addresses delimeted by a semi-colon.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    public static void MailTo(this Process process, string to, string cc, string bcc, string subject, string body)
    {
        MailTo(process, to, cc, bcc, subject, body, null);
    }

    /// <summary>
    /// Populates the process with mailto <see cref="ProcessStartInfo"/>. You may leave any
    /// argument as <c>null</c> if not needed.
    /// </summary>
    /// <param name="process">The process.</param>
    /// <param name="to">To email addresses delimeted by a semi-colon.</param>
    /// <param name="cc">The Cc email addresses delimeted by a semi-colon.</param>
    /// <param name="bcc">The Bcc email addresses delimeted by a semi-colon.</param>
    /// <param name="subject">The email subject.</param>
    /// <param name="body">The email body.</param>
    /// <param name="attachmentPath">The attachment file path. Note: this will not work in some 
    /// email applications.</param>
    public static void MailTo(
        this Process process,
        string to,
        string cc,
        string bcc,
        string subject,
        string body,
        string attachmentPath)
    {
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.Append(Uri.UriSchemeMailto + Character.Colon);
        stringBuilder.Append(FormatMailToArgument(to));

        if (!string.IsNullOrEmpty(cc) || !string.IsNullOrEmpty(bcc) ||
            !string.IsNullOrEmpty(subject) || !string.IsNullOrEmpty(body) ||
            !string.IsNullOrEmpty(attachmentPath))
        {
            stringBuilder.Append(Character.Question);

            List<string> arguments = new List<string>();

            if (!string.IsNullOrEmpty(subject))
            {
                arguments.Add("subject=" + FormatMailToArgument(subject));
            }

            if (!string.IsNullOrEmpty(body))
            {
                arguments.Add("body=" + FormatMailToArgument(body));
            }

            if (!string.IsNullOrEmpty(cc))
            {
                arguments.Add("CC=" + FormatMailToArgument(cc));
            }

            if (!string.IsNullOrEmpty(bcc))
            {
                arguments.Add("BCC=" + FormatMailToArgument(bcc));
            }

            if (!string.IsNullOrEmpty(attachmentPath))
            {
                arguments.Add("attachment=" + FormatMailToArgument(attachmentPath));
            }

            stringBuilder.Append(arguments.ToDelimetedString(Character.Ampersand));
        }

        process.StartInfo = new ProcessStartInfo(stringBuilder.ToString());
    }

    #endregion

    #region Methods

    /// <summary>
    /// Formats the mailto argument. Converts <![CDATA['%', '&', ' ', '?', '\t', '\n']]> to their 
    /// hexadecimal representation.
    /// </summary>
    /// <param name="argument">The argument.</param>
    /// <returns>The formatted argument.</returns>
    private static string FormatMailToArgument(string argument)
    {
        return argument.
            Replace(Character.Percent.ToString(), "%25").
            Replace(Character.Ampersand.ToString(), "%26").
            Replace(Character.Colon.ToString(), "%3A").
            Replace(Character.HorizontalTab.ToString(), "%0D").
            Replace(Character.NewLine.ToString(), "%0A").
            Replace(Character.Question.ToString(), "%3F").
            Replace(Character.Quote.ToString(), "%22").
            Replace(Character.Space.ToString(), "%20");
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T12:19:41.260

如果您的意思是有更有效的方法来转义您的电子邮件地址，那么是的，您可以使用 System.Uri 类。

```
string escapedAddress = Uri.EscapeUriString("mailto:joe blogg's\r\n@mail.com");
Console.WriteLine(escapedAddress); 
```

输出：

```
mailto:joe%20blogg's%0D%0A@mail.com 
```

您会注意到在我的示例中，单引号字符没有被转义，但那是因为它不需要在电子邮件地址中。

就您使用的一般方法而言，我不明白为什么要向 Process 类添加扩展方法。发送电子邮件并转义所有地址。附件、服务器身份验证等等等。为什么不使用 [System.Net.Mail](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)类？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-21T11:07:00.110

如[官方链接](https://msdn.microsoft.com/en-us/library/system.uri.escapeuristring(v=vs.110).aspx)中所述，该`EscapeUriString`方法假定`stringToEscape`参数中没有转义序列。

这种方法非常适合转义 Uris，但要小心，因为目标字符串是`mailto:`一行可以包含许多参数（不仅是主题、正文，...），显然每个参数都用一些转义字符...例如*&*和*?* .

因此，在我对带有来自@anon 注释的文本的 Windows 应用商店应用程序的测试中，该字符串不会*仅* `Uri.EscapeUriString()`使用方法完全转义，因为它包含转义序列*&*。

您将需要一个额外的手动转义才能将整个字符串作为`mailto:`Uri 中的参数传递：

```
Uri.EscapeUriString(stringToEscape).Replace("&", "%26"); 
```

# c++ - 使用 malloc() 强制垃圾收集/压缩

> ID：733900
> 
> 赞同：4
> 
> 时间：2009-04-09T11:58:14.557
> 
> 标签：c++, memory, memory-management, malloc, heap-memory

我有一个 C++ 程序，可以对不同长度的输入数组的各种算法进行基准测试。它或多或少看起来像这样：

```
# (1)
for k in range(4..20):
  # (2)
  input = generate 2**k random points
  for variant in variants:
    benchmark the following call
    run variant on input array
  # (3) 
```

是否可以将 (2) 处的整个堆管理重置为 (1) 处的状态？在程序期间分配的堆上分配的所有内存都保证在 (3) 处被释放。

我在 Linux 上使用 g++ 4.3。

编辑：我知道 C/C++ 中没有真正的垃圾收集。我想强制内存分配在 (2) 处加入它在其空闲列表中的相邻空内存块。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T12:09:13.690

如果您希望测试运行以相同的堆状态开始，您可以在 fork() 创建的它们自己的进程中运行它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T12:07:30.043

我认为您的问题有一个简单的解决方案 - 您可以将外部循环移到应用程序之外并进入 shell 脚本或另一个应用程序，并通过命令行将 (k) （和任何其他）参数传递给基准测试应用程序 - 这个这样你就可以确保所有的执行都有相似的开始条件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:01:51.070

除了使用自己的堆管理实现自己的 new 和 delete 版本之外，没有办法使用标准 C++ 来做到这一点。另一种方法是不使用数组，而是使用 std::vectors - 然后您可以使用自定义分配器来进行堆管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T12:02:59.337

你什么意思？C 中没有垃圾收集，当然也没有压缩。

要“重置堆的状态”，您必须为每个 malloc() 调用调用 free()。据我了解您的代码，您已经这样做了。

压实几乎是不可能的。与 Java 或 C# 等高级语言不同，您不能更改对象的地址，因为任何指向它的指针都会失效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T12:02:20.180

没有自动的方法，您必须手动删除堆上的所有内容才能恢复到 (1) 的状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T08:00:37.340

他们是他们的一些垃圾收集代码。查看 perl/python/lua/ruby/mono/parrot/boehm/pike/slate/self/io 等。还要查看 alloca() 和动态数组。还可以考虑使用结构来实现自己的析构函数，或者在函数离开作用域时使用 gcc 属性来自由调用。

# css - 如何设置主 div 的高度？

> ID：733903
> 
> 赞同：1
> 
> 时间：2009-04-09T11:58:52.777
> 
> 标签：css

我需要将主 div 高度拉伸到视口高度并将页脚放在屏幕底部。有人可以解决这个问题吗？

```
body{text-align:center;}
#main{width:200px;margin:0px auto;background:#cccccc;}
#header{height:20px;background:#00FFFF;}
#content{height:80px;background:#cccccc;}
#footer{background:#0000FF;height:20px;}
.demo{width:90%;margin:0px auto;}

 <div id="main">MAIN
     <div id="header" class="demo">HEADER</div>
     <div id="content" class="demo">CONTENT</div>
     <div id="footer" class="demo">FOOTER</div>
 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T12:00:59.077

你可以试试 'position:fixed; 底部：页脚 div 上的 0px'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T12:27:35.097

这可以正常工作，但如果内容高度大于屏幕尺寸，则可能会出现问题。如果主框可以是 100% 的屏幕尺寸，那么我会尝试这样的事情：

```
＃主要的{
位置：相对；
最小高度：100%；
高度：100%；
高度：自动！重要；
}
#页脚{
位置：绝对；
底部：0px；
}

```

所有的heigth值只是为了让内容至少适合屏幕大小，但如果内容变大，它可能会扩大。

古士肯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T12:34:22.880

我曾多次尝试使用 CSS 严格执行此操作（考虑到跨浏览器合规性）。我发现编写一个快速的 jQuery 脚本来处理将 div 调整为适当的大小更容易。

```
 $(document).ready(function () {
      /* this could be something different, like subtracting the height of your footer or something */

      $(window).resize(function () { resizeMyDiv(); });
    });

    function resizeMyDiv() { 
      $("#divResize").height($(window).height()); 
    } 
```

不确定您是否使用 jQuery，但这样做似乎更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T15:57:17.297

这种方法效果很好：[http ://www.xs4all.nl/~peterned/examples/csslayout1.html](http://www.xs4all.nl/~peterned/examples/csslayout1.html)

# sql-server - 在 VMWare 上运行 Sharepoint 2003？

> ID：733905
> 
> 赞同：1
> 
> 时间：2009-04-09T11:59:29.237
> 
> 标签：sql-server, sharepoint, vmware, virtualization, virtual-machine

我们的生产 Sharepoint 服务器为大约 800 个用户提供服务，并在物理双核机器上与其 SQL Server 一起运行。

网络人现在把尽可能多的放在 VMWare 上。Sharepoint 服务器和 SQL Server 将放在不同的服务器上。

有没有人有在 VM 上运行生产级 Sharepoint 服务器的经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T13:05:44.880

共享点服务器：是的。数据库服务器：我不会。

我们的组织正在远离虚拟数据库服务器，转向大型多节点、多实例集群。

我们的大多数应用程序/网络服务器都是虚拟的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T01:34:32.300

我们在数据中心的 VMWare ESX 上的不同虚拟机上运行 SharePoint 和 SQL Server。ESX 不会对磁盘​​ I/O 性能造成太大影响，但诀窍是使用快速驱动器 (15K RPM)。我们发现，通过对硬件进行这种简单的更改，SharePoint 页面加载时间得到了极大的改善。由于 SharePoint 的所有配置数据都存储在 SQL Server 中，因此所有页面加载都依赖于从 DB 中读取数据，并将其组装到 IIS 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:49:55.900

我们在 VMWare 下运行 CRM 没有任何问题。如果您有正确配置的 ESX 3.0 或 3.5，并具有适当的资源，那就完全没问题了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T13:19:57.170

看看迈克尔·诺埃尔怎么说

[http://blogs.technet.com/virtualization/](http://blogs.technet.com/virtualization/)

他有一个 ppt，他还谈到了要照顾的事情 [http://www.google.se/url?sa=t&source=web&ct=&cd=5&url=http%3A%2F%2Fwww.sharepointusers.org.au%2FSydney %2FUser%2520Group%2520Presentations%2FVirtualizingSPComponents%2520-%2520November%25202008.ppt&ei=4vTdScutFtbisAb6j92zDA&usg=AFQjCNF5D68IsDrtTqTlQj075BNJ9COi9A&sig2=pVr_iV_9GvEit7](http://www.google.se/url?sa=t&source=web&ct=&cd=5&url=http%3A%2F%2Fwww.sharepointusers.org.au%2FSydney%2FUser%2520Group%2520Presentations%2FVirtualizingSPComponents%2520-%2520November%25202008.ppt&ei=4vTdScutFtbisAb6j92zDA&usg=AFQjCNF5D68IsDrtTqTlQj075BNJ9COi9A&sig2=pVr_iV_9Gvt9Icxx4iq7Eg)

我曾参与过一个项目，我们遇到了 Sharepoint 的性能问题，我的感觉是，如果你有一个虚拟环境，这就是人们最常指责的问题。取决于它是开箱即用的 Sharepoint 安装还是更定制的关键任务环境，我至少应该考虑做一些负载测试，看看安装如何扩展......

问候马格努斯

附言。吸取的教训是你必须测试极限在哪里......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T14:40:56.023

在虚拟化任何环境之前，请记住 Microsoft 的可支持性：

Microsoft 服务器软件和支持的虚拟化环境 [http://support.microsoft.com/kb/957006/en-us](http://support.microsoft.com/kb/957006/en-us) *此链接介绍了虚拟化环境下支持哪些产品*

Windows Server Catalog [http://www.windowsservercatalog.com/results.aspx?&bCatID=1521&cpID=0&avc=0&ava=0&avq=0&OR=1&PGS=25](http://www.windowsservercatalog.com/results.aspx?&bCatID=1521&cpID=0&avc=0&ava=0&avq=0&OR=1&PGS=25) *这个链接定义了微软支持的硬件虚拟化软件*

虚拟化时不支持 Sharepoint Portal Server 2003，这意味着如果您遇到问题并需要 Microsoft 的帮助，则必须在物理盒中重现它。

# python - Pygame：精灵因运动方向而改变

> ID：733916
> 
> 赞同：1
> 
> 时间：2009-04-09T12:01:58.370
> 
> 标签：python, 2d, pygame, sprite

我昨天刚开始学习如何使用pygame。我读过这本非常有用的书，并遵循了它的所有教程、示例和内容。我想尝试制作一个非常简单的横向卷轴/平台游戏，但是这本书很快就进入了 3D 建模，没有说明如何为上下左右的移动制作变化的精灵以及如何循环播放动画图像。

我今天花了所有时间试图让一个精灵显示并能够上下左右移动。但由于脚本简单，它使用静态图像并且拒绝更改。

谁能给我一些有关如何更改精灵的知识。或者发给我一个教程？

每个参考和尝试它的人一直在使用生成的形状，所以我永远无法使用它们。

非常感谢任何帮助。

补充：在弄清楚如何在我的场景中放置复杂的动画之前，我想知道如何让我的“播放器”更改为关于我向左或向右按​​下的不动图像。如果人们知道它真的很复杂，也许是对角线。

补充：这是我到目前为止所整理的。[http://animania1.ca/ShowFriends/dev/dirmove.rar](http://animania1.ca/ShowFriends/dev/dirmove.rar)是否有可能使方向/动作设置动作的列，并让小列设置代码也使它在循环中循环执行动画片？（或者这会是对效率的严重误用吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T15:38:23.833

这是一个愚蠢的示例，当您按下左/右时，它会在 spritesheet 的两个第一张图像之间交替：

```
import pygame

quit = False
pygame.init()
display = pygame.display.set_mode((640,480))
sprite_sheet = pygame.image.load('sprite.bmp').convert()

# by default, display the first sprite
image_number = 0

while quit == False:
    event = pygame.event.poll()
    no_more_events = True if event == pygame.NOEVENT else False

    # handle events (update game state)
    while no_more_events == False:
        if event.type == pygame.QUIT:
            quit = True
            break
        elif event.type == pygame.NOEVENT:
            no_more_events = True
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_LEFT:
                image_number = 0
            elif event.key == pygame.K_RIGHT:
                image_number = 1

        event = pygame.event.poll()

    if quit == False:
        # redraw the screen
        display.fill(pygame.Color('white'))
        area = pygame.Rect(image_number * 100, 0, 100, 150)
        display.blit(sprite_sheet, (0,0), area)
        pygame.display.flip() 
```

我以前从来没有真正使用过 Pygame，所以也许这段代码不应该作为一个例子。我希望它显示了基础知识。

为了更完整，我应该在更新之前等待一段时间，例如控制我每秒只更新 60 次。

编写一个可以简化工作的精灵类也很方便。您将在构造函数中传递一个精灵帧的大小，并且您将拥有类似的方法，它会自动完成选择下一帧、对精灵进行 blitting 等`update()`工作`draw()`。

Pygame 似乎为此目的提供了一个基类：[链接文本](http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Sprite)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T20:29:26.313

伙计，你唯一要做的就是离场

import pygame 和所有其他需要的东西类型代码和东西............然后当你制作一个 spri

```
class .your class nam here. (pygame.sprite.Sprite):
     def __init__(self):
          pygame.sprite.Sprite.init(self)
          self.image=pygame.image.load(your image and path)
          self.rect=self.image.get_rect()
          x=0
          y=0

          # any thing else is what you want like posistion and other variables

     def update(self):
          self.rect.move_ip((x,y)) 
```

就是这样！！！！但这不是结束。如果你这样做，你只会制作你需要的精灵来移动它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T13:10:39.297

我对 Pygame 了解不多，但我使用过 SDL（Pygame 所基于的）。

如果您使用`Surface.blit()`：[链接文本](http://www.pygame.org/docs/ref/surface.html#Surface.blit)

您可以使用可选`area`参数来选择要绘制曲面的哪个部分。因此，如果您将作为动画一部分的所有图像放在一个文件中，您可以选择要绘制的图像。它被称为“剪辑”。

我猜你会有一个游戏循环来更新游戏状态（如有必要，更改精灵的当前图像），然后使用它们的状态绘制精灵。

# warnings - OpenMp 编码：警告：忽略 #pragma omp parallel

> ID：733926
> 
> 赞同：21
> 
> 时间：2009-04-09T12:03:02.627
> 
> 标签：warnings, openmp

在 Linux 上使用 OpenMP 指令编译 C 代码时收到此警告：

```
warning: ignoring #pragma omp parallel 
```

Gcc 版本是 4.4。

这只是我不应该关心的警告吗？执行会并行吗？我想要一个带有一些解释的解决方案。

我已经提供`-fopenmp`了`make`命令，但 gcc 不接受，否则对于文件的单个编译，即`gcc -fopenmp`工作正常。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-09T12:19:18.563

IIRC 您必须传递`-fopenmp`给 g++ 调用才能实际启用 OpenMP。这也将链接到 OpenMP 运行时系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T22:06:14.347

确保安装了 lib-gomp 和 lib-gomp-dev。在一些奇怪的发行版中，它被删除了。它是必不可少的运行时和开发库。

# javascript - addClass 函数无法使用 JQuery

> ID：733934
> 
> 赞同：1
> 
> 时间：2009-04-09T12:05:32.107
> 
> 标签：javascript, jquery

我有以下代码：

```
function showAccessRequests_click() {
    var buttonValue = $("#showAccessRequests").val();
    if (buttonValue == "Show") {
        $(".hideAccessRequest").removeClass("hideAccessRequest");
        $("#showAccessRequests").val("Hide");
    }
    else {
        $(".hideAccessRequest").addClass("hideAccessRequest");
        $("#showAccessRequests").val("Show");
    }
} 
```

该脚本很好地删除了一个类，但它不想添加该类。你能看到这段代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T12:10:06.153

当您将 hideAccessRequest 类添加到元素时，您会通过该类的存在来搜索它。如果您正在添加它，那么该类将不会被应用，因此您将不会匹配任何元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T12:08:01.913

`$(".hideAccessRequest")`不存在。我猜你需要使用 id。你可能想看看[`toggleClass`](http://docs.jquery.com/Attributes/toggleClass#class).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T18:54:38.510

您需要一个要切换的类的标识符，例如：“accessRequest”...试试这个。

```
function showAccessRequests_click() {
    var buttonValue = $("#showAccessRequests").val();
    if (buttonValue == "Show") {
        $(".accessRequest").removeClass("hideAccessRequest");
        $("#showAccessRequests").val("Hide");
    }
    else {
        $(".accessRequest").addClass("hideAccessRequest");
        $("#showAccessRequests").val("Show");
    }
} 
```

类是用空格分隔的，所以如果你希望它们默认隐藏......

```
<div class="accessRequest hideAccessRequest">...</div> 
```

# c++ - 帮助对混合模式 Win32 应用程序进行事后调试

> ID：733948
> 
> 赞同：1
> 
> 时间：2009-04-09T12:09:29.553
> 
> 标签：c++, debugging, managed-c++, mixed-mode, postmortem-debugging

情况如下：

**背景**

我有一个在 Visual Studio 2008 中开发的混合模式 .NET/Native 应用程序。

我所说的混合模式是指前端是用 C++ .NET 编写的，它调用本机 C++ 库。本机代码在应用程序中完成大部分工作，包括根据需要启动新线程。.NET 代码仅用于 UI 目的（赢取表单）。

我有一个在测试人员的计算机上运行的应用程序的发布版本。

本机库经过全面优化编译，但也启用了调试（“调试信息格式”设置为“程序数据库”）。

这意味着我在 PDB 文件中有应用程序的调试符号。

**问题**

所以无论如何，其中一位测试人员遇到了应用程序问题，它偶尔会在 XP 上崩溃。我已经能够使用 Watson 博士多次运行获得崩溃的小型转储。

当我调试它时（使用 minidump - 我实际上并没有调试真正的应用程序），所有调试符号都正确加载：我可以正确看到所有本机线程的完整堆栈跟踪。其他线程（可能是 .NET 线程）没有堆栈跟踪，但它们至少都向我显示了线程是在哪个 dll 上启动的（即 ntdll.dll）。

它正确报告失败的线程（“用户（5）.dmp 中 0x0563d652 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000）。

但是，当我进入线程时，它显示没有任何用处。在堆栈跟踪中有一个条目，它只有内存地址“0563d652()”（甚至不是“ntldll.dll”）。

当我进行拆卸时，它只显示大约 30 条指令的随机部分。内存地址的任何一侧都只是“？？？”。它几乎看起来不是我的源代码的一部分（您的二进制文件不是按顺序加载到内存中吗？在中间有一组随机的汇编语句是否正常？）。

**我的问题**

所以基本上我的问题是三次的。

1）任何人都可以解释调试器缺乏信息吗？

2）请记住，我无法显示我的代码中发生的错误，任何人都可以提出失败的原因

3) 我可以做任何其他事情来帮助我在未来诊断当前的问题吗？

帮助！

约翰

**更新：**

这是来自 WinDBG 的失败线程的堆栈转储

```
 # ChildEBP RetAddr  
WARNING: Frame IP not in any known module. Following frames may be wrong.
00 099bf414 02d0e7fc 0x563d652
01 00000000 00000000 0x2d0e7fc 
```

很奇怪吧？甚至不显示 DLL。

是否有可能我已经以某种方式破坏了堆栈/堆，导致线程刚刚被破坏......？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T12:23:20.363

你在用WinDbg吗？如果是这样，您是否使用罢工之子扩展程序？

[Bugslayer：罢工之子](http://msdn.microsoft.com/en-us/magazine/cc164138.aspx)

-或者-

[深入了解 .NET Framework 内部结构，了解 CLR 如何创建运行时对象](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T13:11:38.780

We had an issue similar to this where a code bug was silent in MSVC2K5 SP1, but if you had the MSVC2K5 SP2 runtime installed it caused an error which didn't point at valid code.

Part of the problem is, when you start executing data as code you could be doing anything and so the crash location becomes useless as you cannot even get back to a valid stack trace.

We had this happen to us when the new .Net runtime install installed a newer version of the MSVC C++ Runtime in the SxS directory.

In the end our method to resolve the issue was to make the crash happen frequently and add as much logging as necessary to localize it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T17:56:24.903

一旦你抓住并安装了windbg的副本并在那里打开了转储文件，你能发布错误线程的堆栈吗？我们可以从那里开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T09:03:35.747

您的 EIP 刚刚损坏。
假设 ESP 有效，可以查看调用栈，只需输入：
dds esp [enter]
dds [enter]

您还可以使用内存窗口：
将地址设置为：esp
将格式设置为：指针和符号

# macos - Mac 终端无法下载开源项目的源代码

> ID：733951
> 
> 赞同：2
> 
> 时间：2009-04-09T12:11:03.623
> 
> 标签：macos, open-source, macports

我正在尝试在 Mac 中下载 wget 的源代码。

我设法通过以下方式在 Ubuntu 中获取 wget 的源代码

```
apt-get source wget 
```

但是，我还没有设法在 Mac 的终端中下载源代码。我在 MacPorts 中没有找到相同的实用程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T13:29:49.050

MacPorts 是一个基于源代码的包管理器。这意味着每次您通过 MacPorts 安装软件包时，它都会下载源代码，可能会对其进行修补、配置、构建、将其安装到临时位置（因此它可以跟踪端口需要哪些文件），并将其存档，然后将该存档安装到 MacPorts 根目录中，通常是`/opt/local`.

如果您想在构建它之前查看或编辑源代码，您可以执行下载和安装它所需的步骤的子集。`port extract <name>`将下载并提取端口的源代码，而不实际构建或安装它。然后，您可以使用以下命令找到提取的源`port dir <portname>`：

```
$ sudo port -v extract zlib
Password:
--->  Fetching zlib
--->  Verifying checksum(s) for zlib
--->  Checksumming zlib-1.2.3.tar.bz2
--->  Extracting zlib
--->  Extracting zlib-1.2.3.tar.bz2
$ ls $(port dir zlib)
Portfile    files       work
$ ls $(port dir zlib)/work
zlib-1.2.3
$ ls $(port dir zlib)/work/zlib-1.2.3
ChangeLog   as400       examples    inftrees.h  uncompr.c
FAQ     compress.c  gzio.c      make_vms.com    win32
INDEX       configure   infback.c   minigzip.c  zconf.h
Makefile    contrib     inffast.c   msdos       zconf.in.h
Makefile.in crc32.c     inffast.h   old     zlib.3
README      crc32.h     inffixed.h  projects    zlib.h
adler32.c   deflate.c   inflate.c   qnx     zutil.c
algorithm.txt   deflate.h   inflate.h   trees.c     zutil.h
amiga       example.c   inftrees.c  trees.h 
```

有关开发端口的更多信息，请参阅[MacPorts 指南](http://guide.macports.org/)，以及`man port`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T12:20:59.387

大多数开源项目都提供其源代码的压缩存档或可读的版本控制存储库。例如，[wget](http://www.gnu.org/software/wget/)的源代码可在[http://ftp.gnu.org/gnu/wget/](http://ftp.gnu.org/gnu/wget/)获得。您需要做的就是确定要下载的版本并在终端窗口中输入类似的命令

```
ftp http://ftp.gnu.org/gnu/wget/wget-1.10.2.tar.gz 
```

然后，您可以使用类似的命令解压缩源代码

```
tar xvzf wget-1.10.2.tar.gz 
```

如果代码位于版本控制存储库中，则项目还将列出下载代码所需的命令。例如，[cvs2svn](http://cvs2svn.tigris.org/)给你命令

```
svn co --username=guest http://cvs2svn.tigris.org/svn/cvs2svn/trunk cvs2svn-trunk 
```

可能有特定于 Mac 的方法，但我所描述的美妙之处在于它适用于任何类 Unix 环境。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T12:27:22.537

AFAIK，MacPorts 没有与 apt-get 的源代码类似的功能。

但是，源 URL 在 Portfiles 中。您可以通过键入来查看端口的端口文件

```
cat `port file port_name` 
```

在终端中，例如：

```
cat `port file wget` 
```

或者您可以只安装端口并在`/opt/local/var/macports/distfiles`.

您甚至可以使用 install 命令来下载（而不是构建或安装）端口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T13:24:01.310

`apt-get`是一个用于自动下载和安装软件包及其依赖项的程序；它仅在某些基于 Linux 的平台上可用，例如 Debian 和 Ubuntu。Mac OS X 有两个类似的实用程序：[Fink](http://www.finkproject.org/)和[MacPorts](http://www.macports.org/)。两者的目的相同`apt-get`。我个人更喜欢 MacPorts，因为我认为它有更好的用户界面，但两个软件的工作方式或多或少是相同的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T13:09:54.260

如果你想要一个适合开源项目的接口，请查看[Fink](http://www.finkproject.org/)，这是一个用于 Mac OS X 的 dpkg 系统，带有各种开源包。

# c# - WinForms：如何将用户控件包含在外部库中？

> ID：733958
> 
> 赞同：0
> 
> 时间：2009-04-09T12:14:21.150
> 
> 标签：c#, winforms

我在外部库中有一个类将 UserControl 子类化并设置为公共。现在我想在我的主 WinForms 应用程序中使用这个用户控件。我已将此外部库添加到主应用程序的引用中，但用户控件尚未出现在工具箱中 - 我被告知它应该出现。

我是第一次这样做。所以，对不起，如果我的问题太琐碎了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T12:19:24.070

1.  右键单击工具箱中您想要控制的标题面板。
2.  选择选择项目...
3.  在弹出的对话框中单击 .NET Framework Components 选项卡上的 Browse... 按钮（可能需要几秒钟才能显示）
4.  导航到外部库，选择文件并单击打开。

该库中的所有公共控件现在都可供选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T12:18:07.583

您可以右键单击工具箱并从上下文菜单中添加它...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T12:19:24.257

您可以通过右键单击“选择项目...”将项目添加到工具箱。然后去喝杯咖啡 -加载需要很*长时间。*找到你的 dll。

请注意，从工具箱中添加项目将自动添加对项目的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T12:19:02.450

查看 Tools->Options，导航到 Windows Forms Designer->General，并确保“AutoToolboxPopulate”设置为 true。

这适用于 VS 2008，但它应该在早期版本中处于类似位置。

**注意**：我相信这可能只适用于您自己的项目。如果它引用已编译的 DLL，它可能无法从 DLL 中获取控件。

# jquery - jQuery：添加到元素的事件

> ID：733963
> 
> 赞同：3
> 
> 时间：2009-04-09T12:18:00.407
> 
> 标签：jquery

jQuery中是否可以添加元素的事件？例如，如果我想在单击元素时将 .fadeIn() 添加到元素，但还要保留可能已经存在的任何其他功能（假设我不知道当前是否有任何东西在单击时触发）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T12:24:39.877

jQuery 不会覆盖事件，它会添加它们。所以如果你这样做了：

```
$(document).ready(function() {
    $("#test").click(function () { $(this).append("test<br />"); });
    $("#test").click(function () { $(this).append("test 2<br />"); });
}); 
```

一个 div 看起来像：

```
<div id="test">click me <br /></div> 
```

当你点击 div 时，它会同时附加“test”和“test 2”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T12:28:58.523

据我了解，您希望将多个事件映射到同一个元素，对吗？

对的，这是可能的。它将运行的顺序可能有点不可预测，但你可以拥有它们。

# c++ - 密码信息

> ID：733971
> 
> 赞同：2
> 
> 时间：2009-04-09T12:19:48.733
> 
> 标签：c++, windows, winapi, passwords, user-accounts

我想使用 Visual C++ 以编程方式获取存储在我的计算机中的各种用户帐户密码。是否有任何 API 可以帮助我做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T12:22:20.133

无法通过 Win32 API 检索 Windows 密码或大多数其他程序的密码。

对于 Windows 密码，您通常必须使用 LogonUser 要求用户输入他们的用户名/密码并进行验证。

对于其他程序，它们通常存储在由主机应用程序加密的磁盘上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T12:28:39.960

这在 Windows 上绝对是不允许的。

考虑让任何给定程序获取密码的后果。这意味着像纸牌这样的程序将能够获取您的密码并以多种邪恶的方式使用它。更糟糕的是，该程序可以使用密码访问其他机器的资源。

简而言之，它会将安全性抛到窗外

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T13:20:15.093

不，那将是一个安全漏洞。 [见这篇文章](http://blogs.msdn.com/oldnewthing/archive/2005/05/04/414602.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T12:27:38.450

这取决于您要获取的密码是什么？

某些密码无法找回，例如 Windows 登录密码。其他一些密码存储（明文或加密）在磁盘或注册表中的某个位置，具体取决于应用程序如何存储它们。

例如， Win32 API [CredEnumerate](http://msdn.microsoft.com/en-us/library/aa374794(VS.85).aspx)可以为您提供某些应用程序（Internet Explorer 密码等）的用户凭据（登录名和密码）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T13:03:30.877

您只能恢复散列密码，而不是密码本身。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T10:14:23.713

我对此没有个人经验，但有人告诉我，那里有一些实用程序（通常在 .ru 网站上可以找到；））可以为您完成此类工作。看到这是如何发生的令人震惊，这让你变得偏执。然而，我不能建议一个特定的工具来做到这一点，但我想反对所有那些一直说不可能的人。

# .net - 使用 64 位框架构建我的 .NET 应用程序有什么优势吗？

> ID：733975
> 
> 赞同：12
> 
> 时间：2009-04-09T12:22:04.843
> 
> 标签：.net, msbuild, 64-bit

我们使用 msbuild 在专用于构建的服务器上构建我们的 .NET 应用程序。我们正在迁移到具有 64 位 Windows 2003 的新硬件。我可以使用 Framework64 中的 64 位版本的 msbuild 构建应用程序，也可以使用 Framework 中的 32 位版本构建它。使用 64 位版本的 msbuild 进行构建有什么优势吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T12:25:28.673

不是特别没有。唯一真正的优势是 64 位版本的 msbuild 将能够利用更多的地址空间。就是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T12:27:47.107

不，但可能有一些缺点……如果您的应用程序使用任何 3rd 方驱动程序，请确保它们也符合 64 位标准。我们遇到了一个问题，我们将较旧的应用程序转换为 .net 并在 Build->General 上保留默认的“平台目标：任何 CPU”设置，而当我们将应用程序移到其开发机器上时，它运行良好一个64位服务器它死了。我们花了一些时间将其追溯到我们需要与外部数据源交互的第 3 方 ODBC 驱动程序。应用程序 DID 在 64 位平台上工作，我们只需要为 CPU 指定 x86，这有点违背目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-02T04:16:45.520

如果 MSBuild 正在运行依赖于 x64 库的测试；或者如果您的构建过程需要加载本机 x64 库，则需要使用 msbuild x64。

我们必须使用 msbuild x64，因为我们正在运行 xunit 测试，并且我们的一些库*必须*是 x64，因为它们调用本机 x64 库。

理论上，我们可以使用不同的测试运行器来启动 x64 进程来运行测试；但使用 msbuild x64 是最简单的。

如[https://xunit.github.io/docs/running-tests-in-msbuild.html](https://xunit.github.io/docs/running-tests-in-msbuild.html)中所述：

> 您可以使用`<exec>`MSBuild 中的任务来运行控制台运行程序。如果您需要更多地控制在 32 位和 64 位环境中运行测试，您可以选择使用控制台运行程序。使用 MSBuild 运行程序时，您只能选择用于运行构建的 MSBuild 可执行文件的位数。

请注意，这与编译无关——我们可以使用 msbuild x86 构建仅 x64 的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T19:51:03.037

如果你打算做 asp.net 的一大优势是 IIS 可以访问更多的内存，这给了你更多的可扩展性。

点不摇滚的家伙在这个
[http://www.dotnetrocks.com/default.aspx?showNum=341上做了一个节目](http://www.dotnetrocks.com/default.aspx?showNum=341)

有很多非常好的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T13:24:35.350

Biztalk 互操作程序集是不支持 64 位的程序集的一个很好的示例。因此，在做出这样的举动时/之后再次测试和测试。

# nhibernate - (Fluent) NHibernate - 将 Varchar 映射到 Int32

> ID：733976
> 
> 赞同：1
> 
> 时间：2009-04-09T12:22:18.183
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, legacy

我们使用将整数值保存到 varchar 列的遗留数据库。我们需要将此列映射到 Int32 属性，如果数据库列中的数据是数字或 NULL，它会很好地工作。

但是，如果列包含空字符串而不是 null，我们就会遇到问题 - nhibernate 会抛出无法将其转换为整数的错误。

**是否可以配置类映射以自动将异常引发的所有值转换为某个默认值（在这种情况下为零）？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T17:08:07.843

可能可以使用拦截器转换值。您可以通过搜索“空值替换”获得一些建议。

但是你真的有这个需求吗？您可以为 varchar 列映射一个私有或只读成员，并使用不同的属性来控制它。

```
private string _varcharField;

public string VarcharField
{
    get { return _varcharField; }
}

public int IntProperty
{
    get { [parse and return _varcharField]; }
    set { _varcharField = value.ToString(); }
} 
```

在这个例子中，_varcharField 将在 NHibernate 中使用访问策略进行映射。

# sql - 选择所有行直到第一次出现给定值

> ID：733979
> 
> 赞同：13
> 
> 时间：2009-04-09T12:23:23.373
> 
> 标签：sql, oracle

对于以下数据：

> 日期|值|检查
> 2009 | 5 | 1
> 2008 | 5 | 1
> 2007 | 5 | 1
> 2006 | 5 | 0
> 2005 | 5 | 0
> 2004 | 5 | 1
> 2003 | 5 | 1
> 2002 | 5 | 1

我需要从 2009 年开始选择所有行，直到在检查列中第一次出现 0：

> 日期|值|检查
> 2009 | 5 | 1
> 2008 | 5 | 1
> 2007 | 5 | 1

我尝试了滞后功能，但我只能在一个月前检查。

我正在开发 Oracle 10g。

更新：

一切似乎都运行良好，我的测试数据集太小，无法说明性能差异。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-09T12:36:43.263

```
SELECT * FROM mytable where date > (
   SELECT max(date) FROM mytable where check = 0    
) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T12:27:00.543

```
SELECT  *
FROM    (
        SELECT  m.*,
                MIN(CASE WHEN check = 0 THEN 0 ELSE 1 END) OVER (ORDER BY date DESC)) AS mn
        FROM    mytable
        )
WHERE   mn = 1 
```

甚至更好：

```
SELECT  *
FROM    (
        SELECT  m.*, ROW_NUMBER() OVER (ORDER BY mydate DESC) AS rn
        FROM    mytable m
        ORDER BY
                mydate DESC
        )
WHERE   rownum = DECODE(check, 0, NULL, rn)
ORDER BY
        mydate DESC 
```

后一个查询实际上会在遇到检查的第一个零时立即停止扫描。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:35:36.527

```
DECLARE @mytable TABLE (date integer, [value] integer, [check] integer)  

INSERT INTO @mytable VALUES (2009, 5, 1)  
INSERT INTO @mytable VALUES (2008, 5, 1)  
INSERT INTO @mytable VALUES (2007, 5, 1)  
INSERT INTO @mytable VALUES (2006, 5, 0)  
INSERT INTO @mytable VALUES (2005, 5, 0)  
INSERT INTO @mytable VALUES (2004, 5, 1)  
INSERT INTO @mytable VALUES (2003, 5, 1)  
INSERT INTO @mytable VALUES (2002, 5, 1)  

SELECT *  
FROM @mytable  
WHERE date > (SELECT MAX(date) FROM @mytable WHERE [Check] = 0) 
```

# php - 如何在我的网站上进行搜索

> ID：733980
> 
> 赞同：1
> 
> 时间：2009-04-09T12:23:42.140
> 
> 标签：php

我想在网站上添加一个搜索功能，允许用户搜索整个网站。

该网站有大约 20 个表，我希望搜索搜索所有 20 个表。

任何人都可以指出我需要构建什么样的 mysql 查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T12:27:30.760

首先，如何将[自定义 Google 网络搜索](http://www.google.com/services/custom.html)添加到您的网站？

困难的方法：您应该适当地对每个表进行查询，并且`LIMIT`（`LIKE`如果您的数据库软件支持，则使用文本列或使用全文索引）将结果变为 X（例如十个）结果。在您的代码中，以某种方式对这些结果进行评分并显示 X 最佳结果。

您也可以尝试使用`UNION`多个查询，但结果元组都必须具有相同的结构（如果我没记错的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T12:59:41.960

Use [Sphinx](http://www.php.net/sphinx) or if you're using ZF — [Lucene.](http://framework.zend.com/manual/en/zend.search.lucene.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T12:32:32.930

搜索引擎。我的计算机科学学位论文。首先你要问自己这个问题。您想为用户提供什么类型的搜索。如果用户清楚地知道他们在寻找什么，例如基于产品的网站，那么您应该提供基于元数据的搜索引擎。例如，用户将搜索特定产品或产品类型。这通常很容易提供。

接下来是您熟悉的网络搜索引擎，例如 Google。谷歌在这里瞄准了一个完全不同的市场。典型的用户并不确切地知道他们在寻找什么。例如，他们只知道他们正在寻找与飞机有关的东西。现在，谷歌必须尝试找出最有可能匹配并最相关的结果。

我知道谷歌有一个非常复杂和优化的系统，但是如果你想这样做，你需要从内存中创建一个叫做倒排索引文件的东西。然后您需要开始考虑词库，因为如果用户键入 cat，那么您还应该提供包含单词 feline 的结果。还有词树，因为用户输入 cat 猫的结果也将是相关的。

我很确定，如果您为您的网站提供搜索引擎，那么它很可能是元数据搜索引擎，在这种情况下您可以推出自己的解决方案。如果没有，而您正在寻找第二种类型，那么为什么不使用 Google 的服务。它们提供了可在您自己的网站中使用的自定义搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T12:33:17.687

1.：在有内容的字段上设置FULLTEXT索引，并使用mysql提供的全文搜索：http: [//dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

或者

2.：看看 Zend Framework 提供的 lucene 搜索：http: [//framework.zend.com/manual/en/zend.search.lucene.html](http://framework.zend.com/manual/en/zend.search.lucene.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T12:44:29.877

你试过看lucene吗？它是当今可用的最佳搜索模块之一。我强烈建议你试一试

# silverlight - 加载不在 xap Silverlight 中的图像

> ID：733982
> 
> 赞同：1
> 
> 时间：2009-04-09T12:24:08.163
> 
> 标签：silverlight, image, load

我正在开发一个应用程序，我将加载不在 clientbin 文件夹中的图像，但在放置在我的服务器中的文件夹中。我会做这样的事情 BitmapImage bit = new BitmapImage(); 字符串路径 = "c:/image.png"; bit.UriSource = new Uri(path, UriKind.Absolute); 身份。来源=位；但它不起作用。知道吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:43:18.490

尝试：

Image.Source = New Imaging.BitmapImage(New Uri(" [http://www.Pic.jpg](http://www.Pic.jpg) ", UriKind.Absolute))

您不想将它包含在您的项目中，否则 .xap 会变得很大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T16:04:02.070

Silverlight 应用程序在客户端上运行，而不是在服务器上，因此您一直在尝试引用路径，这将真正指向运行应用程序的客户端计算机上的路径。但是，出于安全原因，Silverlight 无论如何都无权读取或写入客户端磁盘。隔离存储功能是个例外。

因此，您的选择是尝试 Bill 给出的第一个答案，或者 WebService，实现起来更复杂。

ib。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-04T16:15:44.510

添加到比尔的答案。您还可以使用以下从 xap 文件位置派生的辅助方法来使用服务器端资源。

```
public static string GetUrlForResource(string resourcePage)
{

    var webUrl = Application.Current.Host.Source.ToString();
    //Get ClientBin Directory
    var stub = webUrl.Substring(0, webUrl.LastIndexOf("/"));
    //Get application root.
    stub = stub.Substring(0, stub.LastIndexOf("/") + 1);
    //Append the application root to the resource page.
    webUrl = stub + resourcePage;

    return webUrl;
} 
```

要像比尔的答案一样使用它，请使用以下命令：

```
Image.Source = new Imaging.BitmapImage(new Uri(GetUrlForResource("images/myimage.png"), UriKind.Absolute)); 
```

# coding-style - 你在变量名中使用文章吗？

> ID：733988
> 
> 赞同：13
> 
> 时间：2009-04-09T12:26:27.453
> 
> 标签：coding-style, smalltalk

**编辑：** Smalltalkers 这样做似乎至少有两个正当理由（消息链接和范围问题期间的可读性），但也许这个问题可以保持更长时间以解决一般用法。

**原文：**由于我早已忘记的原因，我从不在变量名中使用冠词。例如：

> 一个人，这辆车，一个物体

我想我觉得文章用无意义的信息弄脏了名字。当我看到使用此约定的同事的代码时，我的血压会略微升高。

最近我开始学习 Smalltalk，主要是因为我想学习 Martin Fowler、Kent Beck 和许多其他伟人在成长和喜爱的语言。

然而，我注意到 Smalltalkers 似乎在其变量名中广泛使用**不定**冠词 ( *a, an )。*下面的 Setter 方法就是一个很好的例子：

```
name: aName address: anAddress.
     self name: aName.
     self address: anAddress 
```

这让我重新考虑了自己的立场。如果像 Smalltalkers 这样受人尊敬和有影响力的社区广泛采用了变量命名方面的文章，那也许是有充分理由的。

你用它吗？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-09T13:34:14.123

这种命名约定是 Kent Beck 的书*Smalltalk Best Practice Patterns*中的一种模式。恕我直言，这本书即使对于非小语者来说也是必不可少的，因为它确实有助于命名事物和编写自记录代码。另外，它可能是少数几个没有名字就能展示[Alexander*品质*](http://www.amazon.co.uk/gp/product/0195019199?ie=UTF8&tag=playinktenuki-21&linkCode=as2&camp=1634&creative=19450&creativeASIN=0195019199)的模式语言之一。

另一本关于代码模式的好书是*Smalltalk with Style*，它[以免费 PDF 的](http://stephane.ducasse.free.fr/FreeBooks.html)形式提供。

通常，惯例是实例变量和访问器使用裸名词，参数使用不定冠词加上角色或类型，或组合。临时变量可以使用裸名词，因为它们很少重复实例变量；或者，为了表明它们在控制流中的作用，更准确地命名它们而不是不定冠词是很常见的：`eachFoo`, `nextFoo`, `randomChild`...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T12:32:44.053

它在 Smalltalk 中通常用作无类型语言，因为它在方法调用中提示参数的*类型*。文章本身表明您正在处理指定类的某个对象*的实例*。

但请记住，在 Smalltalk 中方法看起来不同，我们使用所谓的关键字消息，在这种情况下，文章实际上有助于提高可读性：

```
anAddressBook add: aPerson fromTownNamed: aString 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-09T12:49:03.890

我想我刚刚找到*了*答案。正如 Konrad Rudolph 所说，他们使用这种约定是出于技术原因：

> ...这意味着它 [*方法变量*] 不能重复实例变量、接口中定义的临时变量或另一个临时变量的名称。- [IBM Smalltalk 教程](http://www.inf.ufsc.br/poo/smalltalk/ibm/tutorial/chap3.html)

基本上，局部方法变量不能与对象/类变量命名相同。来自 Java，我假设方法的变量将是本地范围的，并且您可以使用以下方式访问实例变量：

```
self address 
```

我仍然需要更多地了解 Smalltalk 中的方法/本地范围，但似乎他们别无选择；它们**必须**使用与实例不同的变量名，因此*anAddress*可能是最简单的方法。仅使用*地址*会导致：

```
Name is already defined ->address 
```

如果您已经定义了实例变量*地址*...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T12:28:29.633

> 我总觉得那些文章用毫无意义的信息把名字弄脏了。

确切地。这就是放弃文章的全部原因：它们不必要地使代码混乱，并且没有提供额外的信息。

我不了解 Smalltalk，也无法谈论“他们的”约定的原因，但在其他任何地方，上述情况都成立。*Smalltalk 约定背后可能*有一个简单的技术原因（例如`ALL_CAPS`在 Ruby 中，它不仅按照约定而且由于语言语义是一个常量）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T13:05:13.150

我在使用它时来回摇晃。我认为这取决于在任何给定时间我的项目中 C++ 与 Objective C 的比率。至于依据和推理，Smalltalk 普及了对象是“事物”的概念。我认为是[Yourdon](http://en.wikipedia.org/wiki/Edward_Yourdon)和[Coad](http://en.wikipedia.org/wiki/Peter_Coad)强烈推动了以第一人称描述类。在 Python 中，它类似于以下代码段。我真的希望我能记住足够多的 SmallTalk 来组合一个“适当的”示例。

```
class Rectangle:
    """I am a rectangle. In other words, I am a polygon
    of four sides and 90 degree vertices."""
    def __init__(self, aPoint, anotherPoint):
        """Call me to create a new rectangle with the opposite
        vertices defined by aPoint and anotherPoint."""
        self.myFirstCorner = aPoint
        self.myOtherCorner = anotherPoint 
```

总的来说，它是一种提高程序可读性的对话方法。在变量名中使用冠词只是整个习语的一部分。还有一个关于参数命名和消息选择器 IIRC 的习语。就像是：

```
aRect <- [Rectangle createFromPoint: startPoint 
                    toPoint: otherPoint] 
```

这只是另一种过时的时尚，仍然经常出现。最近我注意到像这样`myHostName`的成员名称在 C++ 代码中作为`m_hostName`. 我越来越迷恋这种用法，我认为这有点像 SmallTalk 的习语。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T12:30:07.010

从未使用过，可能是因为在我的主要语言中没有任何文章：P

无论如何，我认为只要变量的名称有意义，是否有文章并不重要，这取决于编码器自己的喜好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T12:34:45.670

没有。我觉得这是浪费字符空间并削弱了代码的可读性。我可能会根据上下文使用名词的变体，例如 Person vs People。例如

```
ArrayList People = new ArrayList();
Person newPerson = new Person();
People.add(newPerson); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T12:39:05.817

不，我没有。我不觉得它为我的代码库的可读性或可维护性增加了任何东西，并且它不会以任何方式区分变量。

另一个缺点是，如果您鼓励使用变量名称的文章，那么有人在您的代码库中这样做只是时间问题。

```
var person = new Person();
var aPerson = GetSomeOtherPerson(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T13:04:15.833

在我工作的地方，标准是在所有实例字段前面加上“the-”，在局部变量前面加上“my-”，在方法参数前面加上“a-”。我相信这是因为许多开发人员使用 vi 之类的文本编辑器而不是 IDE，因为 IDE 可以在每个范围内显示不同的颜色。

在 Java 中，我不得不说我更喜欢它而不是编写你取消引用**this**的设置器。

比较

```
public void setName(String name) {
    this.name = name;
} 
```

相对

```
public void setName(String aName) {
    theName = aName;
} 
```

最重要的是有一个标准，每个人都遵守。***``******