# StackOverflow 问答 000054000-000054999

# asp.net - 无法加载类型“XXX.Global”

> ID：54001
> 
> 赞同：62
> 
> 时间：2008-09-10T13:13:14.953
> 
> 标签：asp.net, visual-studio

将项目从 ASP.NET 1.1 迁移到 ASP.NET 2.0，我一直遇到这个错误。

我实际上并不需要 Global 因为我没有向其中添加任何内容，但是在删除它之后会出现更多错误。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-01-20T08:17:53.690

**我遇到此问题的原因是因为我更改了构建配置。**当我将 Web 项目设置为 时`x86`，它会将输出路径更改为`bin\x86\Debug`. 但是，输出路径应该是`bin`，因此 Web 服务器不会找到二进制文件。

`bin`因此，解决方案是在更改构建配置后将网站的输出路径更改回。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-09-10T13:25:51.727

您可以尝试一些事情，似乎发生了很多，并且解决方案似乎因每个人而异。

*   如果您仍在使用 IIS 虚拟目录，请确保它指向正确的目录并检查它设置的 ASP.NET 版本，确保它设置为 ASP.NET 2.0。

*   清除所有的 bin/debug/obj。执行*Clean 解决方案*，然后执行*Build Solution*。

*   在文本编辑器中检查您的项目文件，并确保它在哪里寻找全局文件是正确的，有时它不会更改目录。

*   从解决方案中删除全局并在保存并关闭后将其添加回来。确保 ASPX 文件中的所有脚本标记都指向正确的标记。

*   您可以尝试运行*转换为 Web 应用程序*工具，它​​会重做所有代码和项目文件。

*   IIS Express 使用了错误的根目录（请参阅[基于错误路径的 VS 2012 启动应用程序](https://stackoverflow.com/questions/15818364/vs-2012-launching-app-based-on-wrong-path)中的答案）

确保在尝试后关闭 VS。

这些是我知道要尝试的一些事情。希望其中一个对你有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T01:33:49.427

我发现当 Global.asax.(vb|cs) 没有正确转换为部分类时会发生这种情况。

最快的解决方案是用 [方括号] 将类名“全局”括起来，如下所示（在 VB.Net 中）：

```
Public Class [Global]
    Inherits System.Web.HttpApplication
    ... 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-13T09:23:10.913

删除现有的 global.asax 文件并添加一个新文件，即可清除此错误。这对我有用很多次。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-09T12:53:02.270

如果您使用 Visual Studio 2010，则在更改配置部署类型时可能会出现此错误。这 3 种类型是 x86、x64 和混合模式。将解决方案中的所有项目更改为混合模式设置应该可以解决该问题。如果您是 ASP.NET 网站，请不要忘记删除 bin、Lib 文件并更改临时目录输出。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-11T20:36:08.690

这只是发生在我身上，在尝试了其他所有方法之后，我碰巧注意到应用程序池设置为 .Net 1.1 的错误消息。我将应用程序升级到 2.0，转换为 Web 应用程序，但从未更改应用程序池：

**版本信息：** Microsoft .NET Framework 版本：1.1.4322.2490；ASP.NET 版本：1.1.4322.2494

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-19T03:38:06.723

这让我彻底疯了，我找不到任何有用的东西来解决它。这可能不是大多数人有这个问题的原因，但我只是希望其他人能从这个答案中受益。

导致我的问题是配置部分`<clear />`中的一条语句。`<assemblies>`我之所以添加它是因为在生产中它是必需的，因为在同一个托管计划中有多个不相关的应用程序，我不希望它们中的任何一个受到其他应用程序的影响。更正确的解决方案是在发布时使用 Web 配置转换。

希望这对其他人有帮助！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-10T08:51:40.297

更改地址的端口号 (localhost:) 对我有用 :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-06-10T18:46:58.243

我通过简单地从调试切换到发布，启动程序（它在发布时工作），然后切换回调试来修复了这个错误。

我几乎尝试了其他所有方法，包括重新启动 Visual Studio，但没有任何效果。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-20T23:33:50.307

我在将我的应用程序安装到服务器时遇到了同样的问题。它最终成为安装程序项目，它没有安装运行 Web 应用程序所需的所有文件。我试图找出它被破坏的地方，但最后我不得不将项目恢复到以前的版本来修复它。希望这可以帮助某人...

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-14T12:46:30.210

就我而言，项目中用于编译 Web 应用程序的 AfterBuild 目标是导致此错误的原因。

请参阅[此处](https://stackoverflow.com/questions/755645/asp-net-mvc-1-0-afterbuilding-views-fails-on-tfs-build)了解更多信息

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-03-14T19:31:23.420

删除 global.asax 文件中的 Language="c#" 为我解决了这个问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-08-01T05:34:16.053

就我而言，我在本地复制了一个在线站点，并在 Utildev Cassini for asp.net 2.0 中本地获取了此错误。原来我只在本地复制了global.asax，并没有复制它的App_code conterpart。复制它解决了这个问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-03-27T18:13:05.997

当您尝试访问 Microsoft Dynamics NAV Web 客户端时，您会收到以下错误。无法从程序集“System.ServiceModel，Version=3.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”加载类型“System.ServiceModel.Activation.HttpModule”当计算机上有多个版本的 .NET Framework 时，可能会发生此错误即运行 IIS，并且 IIS 是在 .NET Framework 4.0 之后或在 Windows Communication Foundation 中的服务模型注册之前安装的。

对于 Windows 7 和 Windows Server 2008，使用 ASP.NET IIS 注册工具 (aspnet_regiis.exe) 注册正确版本的 ASP.NET。有关 aspnet_regiis.exe 的详细信息，请参阅 Microsoft 网站上的 ASP.NET IIS 注册工具。

试试这个解决方案 [https://www.youtube.com/watch?v=LNwpNqgX7qw](https://www.youtube.com/watch?v=LNwpNqgX7qw)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-02T05:32:57.087

确保项目的编译后的 dll 放置在正确的 bin 文件夹中。

就我而言，当我将子项目的编译目录更​​改为主项目的 bin 文件夹时，它起作用了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-02-24T19:29:24.083

在我的情况下出现此错误，我正在重命名应用程序。我更改了项目的名称和类的名称，但忽略了更改“我的项目”或项目属性中的“程序集名称”或“根名称空间”。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-12T06:13:11.803

删除 obj、bin 文件夹和重建修复了我的问题

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-19T19:02:19.813

我有这个问题。

我通过授予 CREATOR OWNER 对 Windows Temp 文件夹的完全权限来[解决这个问题。](https://stackoverflow.com/a/8315381/1038866)出于某种原因，该用户根本没有分配任何权限。也许是因为前段时间我在我的电脑上运行了 Combofix。

# scala - 从 Scala 中的 List 返回一个元素

> ID：54010
> 
> 赞同：16
> 
> 时间：2008-09-10T13:15:29.083
> 
> 标签：scala, list

我最近一直在做一个 Scala 的初学者项目，并且有一个关于 Scala 列表的初学者问题。

假设我有一个元组列表（`List[Tuple2[String, String]]`例如）。是否有一种方便的方法可以从列表中返回指定元组的第一次出现，或者是否需要手动遍历列表？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-14T17:37:53.833

```
scala> val list = List(("A", "B", 1), ("C", "D", 1), ("E", "F", 1), ("C", "D ", 2), ("G", "H", 1))
列表：List[(java.lang.String, java.lang.String, Int)] = List((A,B,1), (C,D,1), (E,F,1), (C, D,2), (G,H,1))

scala> 列表查找 {e => e._1 == "C" && e._2 == "D"}
res0: 选项[(java.lang.String, java.lang.String, Int)] = Some((C,D,1))

```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-10T14:07:35.930

您可以尝试使用[find](http://www.scala-lang.org/api/current/index.html#scala.collection.parallel.ParIterableLike$Find)。（更新了查找的 scala-doc 位置）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T20:14:47.927

正如之前的评论中提到的，`find`这可能是最简单的方法。Scala 的集合中实际上存在三种不同的“线性搜索”方法，每种方法返回的值略有不同。您使用哪一个取决于您需要数据的目的。例如，您需要一个索引，还是只需要一个布尔值`true`/ `false`？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-11T13:34:55.003

如果你正在学习 scala，我会好好看看[Seq](http://www.scala-lang.org/api/current/scala/collection/Seq.html)特征。它为 scala 的大部分功能提供了基础。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-24T23:42:21.227

您也可以这样做，这不需要知道 Tuple2 类中的字段名称——它使用模式匹配来代替：

```
list find { case (x,y,_) => x == "C" && y == "D" } 
```

当您知道您只需要一个时，“查找”很好；如果你想找到所有匹配的元素，你可以使用“过滤器”或等效的含糖来理解：

```
for ( (x,y,z) <- list if x == "C" && y == "D") yield (x,y,z) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-09T10:00:40.037

这是可能对您有所帮助的代码。

我有一个类似的案例，有一组基类条目（这里，`A`），我想从中找到某个派生类的节点，如果有的话（这里，`B`）。

```
class A

case class B(val name: String) extends A

object TestX extends App {
  val states: List[A] = List( B("aa"), new A, B("ccc") )

  def findByName( name: String ): Option[B] = {
    states.find{
      case x: B if x.name == name => return Some(x)
      case _ => false
    }
    None
  }

  println( findByName("ccc") )    // "Some(B(ccc))"
} 
```

这里的重要部分（对于我的应用程序）是`findByName`不返回`Option[A]`但`Option[B]`.

您可以轻松地将行为修改为返回`B`，如果没有找到则抛出异常。希望这可以帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-27T21:08:00.367

考虑为第一个匹配元组或其他方式`collectFirst`传递哪个传递，例如如下，`Some[(String,String)]``None`

```
xs collectFirst { case t@(a,_) if a == "existing" => t }
Some((existing,str))

scala> xs collectFirst { case t@(a,_) if a == "nonExisting" => t }
None 
```

使用`@`我们绑定元组的值，`t`以便可以收集整个匹配的元组。

# firefox - 以编程方式访问浏览器历史记录

> ID：54036
> 
> 赞同：4
> 
> 时间：2008-09-10T13:31:03.850
> 
> 标签：firefox, sqlite

如何创建一个应用程序来读取我的所有浏览器 (firefox) 历史记录？我注意到我有

C:\Users\user.name\AppData\Local\Mozilla\Firefox\Profiles\646vwtnu.default

看起来像一个 sqlite 数据库（urlclassifier3.sqlite），但我不知道它是否真的用于存储历史信息。我搜索了有关如何执行此操作的示例，但没有找到任何内容。

ps：虽然标题相似，但我相信这个问题与[“您如何访问浏览器历史记录？”不同。](https://stackoverflow.com/questions/48805/how-do-you-access-browser-history)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T13:46:36.467

我相信`places.sqlite`这是您应该研究历史的那个（Firefox 3）。以下是一些 Mozilla wiki 条目，其中包含有关该主题的一些信息。

*   [Mozilla 2：统一存储](https://wiki.mozilla.org/Mozilla2:Unified_Storage)
*   [浏览器历史记录](https://wiki.mozilla.org/Browser_History) *（请参见此处的“数据库设计”部分）*

在早期版本的 Firefox 中，他们将历史记录存储在一个名为 的文件中`history.dat`，该文件以一种名为“Mork”的格式编码。[Jamie Zawinski 的这个 perl 脚本](http://www.jwz.org/hacks/mork.pl)可用于解析 Mork 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-11T10:13:16.407

我还发现以下链接很有趣：

*   [用 Firefox 3 创造历史](http://www.forensicsblog.net/?p=5)
*   [.NET 上的 SQLite - 在 3 分钟内启动并运行。](http://www.mikeduncan.com/sqlite-on-dotnet-in-3-mins/)
*   [SQLite 管理器 Firefox 插件](https://addons.mozilla.org/en-US/firefox/addon/5817)

在我的 .Net 项目中添加对 System.Data.Sqlite 的引用后，创建连接所需要做的就是：

```
cnn = New SQLiteConnection("data source=c:\Users\user.name\AppData\Roaming\Mozilla\Firefox\Profiles\646vwtnu.default\places.sqlite")
cnn.Open() 
```

我有一个小故障，.net sqlite 提供程序不支持 sqlite3_enable_shared_cache，我相信这会阻止我在运行 firefox 时打开 places.sqlite 数据库（请参阅[对 sqlite3_enable_shared_cache 的支持）](http://sqlite.phxsoftware.com/forums/p/1357/5855.aspx#5855)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-08T01:32:14.537

[Firefox SQLite Manager Addon](https://addons.mozilla.org/en-US/firefox/addon/5817)是一个很棒的工具。如果您想了解 Firefox Places 设计和 DB 模式，请访问[Mozilla Places](https://developer.mozilla.org/en/Places)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-04T10:57:07.327

实际上历史记录在`places.sqlite`但数据库文件被锁定。所以你需要制作一个副本才能访问它：

```
$ pwd
/home/amirouche/.mozilla/firefox/p4x432.default
$ ls -l *sqlite
-rw-r--r-- 1 amirouche amirouche   229376 Oct  4 12:39 content-prefs.sqlite
-rw-r--r-- 1 amirouche amirouche  1572864 Oct  4 12:51 cookies.sqlite
-rw-r--r-- 1 amirouche amirouche 40501248 Oct  4 12:47 favicons.sqlite
-rw-r--r-- 1 amirouche amirouche   294912 Oct  4 12:46 formhistory.sqlite
-rw-r--r-- 1 amirouche amirouche   196608 Oct  4 12:50 permissions.sqlite
-rw-r--r-- 1 amirouche amirouche 36700160 Oct  4 12:50 places.sqlite
-rw-r--r-- 1 amirouche amirouche    65536 Oct  4 11:50 protections.sqlite
-rw-r--r-- 1 amirouche amirouche      512 Jul 24 23:41 storage.sqlite
-rw-r--r-- 1 amirouche amirouche   131072 Oct  4 12:05 storage-sync.sqlite
-rw-r--r-- 1 amirouche amirouche 15892480 Oct  4 12:51 webappsstore.sqlite

$ sqlite3 places.sqlite 
SQLite version 3.27.2 2019-02-25 16:06:06
Enter ".help" for usage hints.
sqlite> .schema
Error: database is locked
sqlite> 

$ cp places.sqlite places.backup.sqlite

$ sqlite3 places.backup.sqlite 
SQLite version 3.27.2 2019-02-25 16:06:06
Enter ".help" for usage hints.
sqlite> .schema 
```

这是输出，`moz_places`第 2 行有一个有趣的表：

```
CREATE TABLE moz_origins ( id INTEGER PRIMARY KEY, prefix TEXT NOT NULL, host TEXT NOT NULL, frecency INTEGER NOT NULL, UNIQUE (prefix, host) );
CREATE TABLE moz_places (   id INTEGER PRIMARY KEY, url LONGVARCHAR, title LONGVARCHAR, rev_host LONGVARCHAR, visit_count INTEGER DEFAULT 0, hidden INTEGER DEFAULT 0 NOT NULL, typed INTEGER DEFAULT 0 NOT NULL, frecency INTEGER DEFAULT -1 NOT NULL, last_visit_date INTEGER , guid TEXT, foreign_count INTEGER DEFAULT 0 NOT NULL, url_hash INTEGER DEFAULT 0 NOT NULL , description TEXT, preview_image_url TEXT, origin_id INTEGER REFERENCES moz_origins(id));
CREATE TABLE moz_historyvisits (  id INTEGER PRIMARY KEY, from_visit INTEGER, place_id INTEGER, visit_date INTEGER, visit_type INTEGER, session INTEGER);
CREATE TABLE moz_inputhistory (  place_id INTEGER NOT NULL, input LONGVARCHAR NOT NULL, use_count INTEGER, PRIMARY KEY (place_id, input));
CREATE TABLE moz_bookmarks (  id INTEGER PRIMARY KEY, type INTEGER, fk INTEGER DEFAULT NULL, parent INTEGER, position INTEGER, title LONGVARCHAR, keyword_id INTEGER, folder_type TEXT, dateAdded INTEGER, lastModified INTEGER, guid TEXT, syncStatus INTEGER NOT NULL DEFAULT 0, syncChangeCounter INTEGER NOT NULL DEFAULT 1);
CREATE TABLE moz_bookmarks_deleted (  guid TEXT PRIMARY KEY, dateRemoved INTEGER NOT NULL DEFAULT 0);
CREATE TABLE moz_keywords (  id INTEGER PRIMARY KEY AUTOINCREMENT, keyword TEXT UNIQUE, place_id INTEGER, post_data TEXT);
CREATE TABLE sqlite_sequence(name,seq);
CREATE TABLE moz_anno_attributes (  id INTEGER PRIMARY KEY, name VARCHAR(32) UNIQUE NOT NULL);
CREATE TABLE moz_annos (  id INTEGER PRIMARY KEY, place_id INTEGER NOT NULL, anno_attribute_id INTEGER, content LONGVARCHAR, flags INTEGER DEFAULT 0, expiration INTEGER DEFAULT 0, type INTEGER DEFAULT 0, dateAdded INTEGER DEFAULT 0, lastModified INTEGER DEFAULT 0);
CREATE TABLE moz_items_annos (  id INTEGER PRIMARY KEY, item_id INTEGER NOT NULL, anno_attribute_id INTEGER, content LONGVARCHAR, flags INTEGER DEFAULT 0, expiration INTEGER DEFAULT 0, type INTEGER DEFAULT 0, dateAdded INTEGER DEFAULT 0, lastModified INTEGER DEFAULT 0);
CREATE TABLE moz_meta (key TEXT PRIMARY KEY, value NOT NULL) WITHOUT ROWID ;
CREATE TABLE sqlite_stat1(tbl,idx,stat);
CREATE INDEX moz_places_url_hashindex ON moz_places (url_hash);
CREATE INDEX moz_places_hostindex ON moz_places (rev_host);
CREATE INDEX moz_places_visitcount ON moz_places (visit_count);
CREATE INDEX moz_places_frecencyindex ON moz_places (frecency);
CREATE INDEX moz_places_lastvisitdateindex ON moz_places (last_visit_date);
CREATE UNIQUE INDEX moz_places_guid_uniqueindex ON moz_places (guid);
CREATE INDEX moz_places_originidindex ON moz_places (origin_id);
CREATE INDEX moz_historyvisits_placedateindex ON moz_historyvisits (place_id, visit_date);
CREATE INDEX moz_historyvisits_fromindex ON moz_historyvisits (from_visit);
CREATE INDEX moz_historyvisits_dateindex ON moz_historyvisits (visit_date);
CREATE INDEX moz_bookmarks_itemindex ON moz_bookmarks (fk, type);
CREATE INDEX moz_bookmarks_parentindex ON moz_bookmarks (parent, position);
CREATE INDEX moz_bookmarks_itemlastmodifiedindex ON moz_bookmarks (fk, lastModified);
CREATE INDEX moz_bookmarks_dateaddedindex ON moz_bookmarks (dateAdded);
CREATE UNIQUE INDEX moz_bookmarks_guid_uniqueindex ON moz_bookmarks (guid);
CREATE UNIQUE INDEX moz_keywords_placepostdata_uniqueindex ON moz_keywords (place_id, post_data);
CREATE UNIQUE INDEX moz_annos_placeattributeindex ON moz_annos (place_id, anno_attribute_id);
CREATE UNIQUE INDEX moz_items_annos_itemattributeindex ON moz_items_annos (item_id, anno_attribute_id); 
```

# e-commerce - 信用卡到期日期 - 包含还是不包含？

> ID：54037
> 
> 赞同：130
> 
> 时间：2008-09-10T13:31:29.917
> 
> 标签：e-commerce, payment

假设您有一个到期日期为 05/08 的信用卡号 - 即 2008 年 5 月。

这是否意味着该卡在 2008 年 5 月 1 日上午或 2008 年 5 月 31 日晚上到期？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-09-10T13:40:39.443

我花了几分钟才找到一个我可以为此采购的网站。

> 该卡有效期至指定月份的最后一天，在下个月的最后 [原文如此] ¹ 天之后；如果商家试图获得授权，则该卡不能用于购买。-[来源](http://web.archive.org/web/20081003052424/http://cumemberscard.com/noda/CreditCardGlossary.asp)

此外，在查找此内容时，我在 Microsoft 的网站上发现了一篇有趣的文章，使用了这样的示例，执行摘要：[一个月/年的 Access 2000 默认为每月的第一天，以下是如何覆盖它以计算结束像你想要一张信用卡的月份](https://web.archive.org/web/20150113060002/http://support.microsoft.com/kb/210534)。

此外，此页面包含[您想了解的有关信用卡的所有信息](http://euro.ecom.cmu.edu/resources/elibrary/everycc.htm)。

* * *

1.  这被认为是一个错字，它应该是“……，在下个月的第一天之后；……”

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-10T13:40:17.043

如果您正在编写一个使用信用卡号码进行付款的网站：

1.  您可能应该尽可能宽容，以便如果它确实过期，您可以让信用卡公司抓住它。因此，请允许它直到该月最后一天的最后一秒。
2.  不要编写自己的信用卡处理代码。如果^H^H当你写一个bug时，有人会损失真金白银。我们都会犯错误，只是不要做出将错误变成灾难的决定。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-10T13:34:25.263

看看你自己的一张信用卡。它会有一些类似`EXPIRES END`或`VALID THRU`高于日期的文本。因此，该卡在给定月份的月底到期。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-10T13:32:48.637

根据我的经验，它已在该月底到期。这是基于我可以在那个月使用它的事实，而那个月是我的银行发送新的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-10T13:48:41.313

根据Visa的《[Visa商户卡受理与退单管理指引](http://usa.visa.com/download/merchants/chargeback-management-guidelines-for-visa-merchants.pdf)》；“Good Thru”（或“Valid Thru”）日期是卡的到期日期：

> 卡片有效期至所示月份的最后一天，（例如，如果有效期为 03/12，则卡片有效期至 2012 年 3 月 31 日，有效期至 2012 年 4 月 1 日。）

它位于浮雕帐号下方。**如果当前交易日期在“Good Thru”日期之后，则该卡已过期。**

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-10T13:39:28.683

我在工作中处理了很多信用卡交易，我可以告诉你，有效期包括在内。

另外，我同意 Gorgapor 的观点。不要编写自己的处理代码。它们是一些很好的信用卡处理工具。在这里，我们已经使用[Monetra](http://www.mainstreetsoftworks.com/) 3 年了，它在这方面做得相当不错。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-08-05T02:46:54.023

许多大公司甚至不再使用您的到期日期，因为当发行具有新到期日期和相同帐号的卡时，它会导致自动续订付款丢失。这一直是服务行业的一个大问题，因此这些公司迫使发卡机构处理没有到期日期的付款，以避免这种陷阱。还没有多少人知道这一点，因此并非所有公司都使用这种做法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-04-14T07:46:34.317

时区如何影响此分析。纽约卡会先于加州过期吗？它取决于帐单或送货地址吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-26T15:07:34.497

我在网上设置了自动计费，信用卡说它在 10 月 9 日之前说好，但该卡在 10 月的第一周被拒绝，下周又被拒绝。每次被拒绝，我都要支付 10 美元的费用。如果您有自动计费设置，请不要认为它在月底之前会很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-10T13:45:23.567

在您的示例中，信用卡于 2008 年 6 月到期。

在不知道您在做什么的情况下，我不能明确地说您不应该提前进行验证，但请注意，有时业务规则会违反所有逻辑。

例如，在我以前工作的地方，他们通常根本不处理卡，或者会继续交易失败，以便他们可以联系客户并获得另一张卡。

# php - 在 Wordpress 插件中运行计划任务

> ID：54038
> 
> 赞同：4
> 
> 时间：2008-09-10T13:32:16.127
> 
> 标签：php, wordpress

我正在尝试编写一个 Wordpress 插件，该插件会在一天中的某个时间自动发布博客文章。例如，阅读一堆 RSS 提要并发布所有新条目的每日摘要。

有一些插件可以做与我想要的类似的事情，但它们中的许多都依赖于一个 cron 作业来进行自动调度。如果必须，我会这样做，但我希望有更好的方法。让典型的 Wordpress 用户添加 cron 作业并不十分友好。

有没有安排从 Wordpress 插件运行的任务的好方法？它不必在正确的时间运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T14:08:35.447

[http://codex.wordpress.org/Function_Reference/wp_schedule_event](http://codex.wordpress.org/Function_Reference/wp_schedule_event)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T20:53:55.793

伪cron很好，但它有两个问题是

1，它需要有人“点击”博客才能执行。低容量站点可能具有广泛的执行时间，因此不要具体说明两个时间。

2，处理发生在页面加载之前。因此，如果执行时间发生并且您有很多“cron”条目，您可能会给访问者带来低于标准的体验，从而使他们感到不安。

只是我的 2 美分 :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T13:45:33.893

vBulletin 使用一种 Pseudo-Cron 系统，基本上检查每个页面访问的时间表，然后触发任何到期的进程。

自从我使用 Wordpress 以来已经有一段时间了，但我认为如果它在每个页面视图上运行，这样的东西应该可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T13:50:12.930

我认为最好的方法是使用伪 cron。我已经看过好几次了，虽然时间不准确，但它应该做你需要它做的事情。由于在 Wordpress 中 index.php 始终是根据 .htaccess 中的设置命中的第一件事，因此创建一个名为 pseudo-cron.php 的文件，将其转储到根目录中，然后从索引中要求它一次。每当有人访问该站点时，它就会运行，您可以使用它来启动脚本，并根据一天中的时间以及上一个摘要运行的时间检查是否需要生成另一个每日摘要。

# c# - 有谁知道用于处理数量/计量单位对的库？

> ID：54043
> 
> 赞同：2
> 
> 时间：2008-09-10T13:35:13.247
> 
> 标签：c#, .net, vb.net, metric

我希望能够做这样的事情

```
var m1 = new UnitOfMeasureQuantityPair(123.00, UnitOfMeasure.Pounds);
var m2 = new UnitOfMeasureQuantityPair(123.00, UnitOfMeasure.Liters);

m1.ToKilograms();
m2.ToPounds(new Density(7.0, DensityType.PoundsPerGallon); 
```

如果还没有这样的东西，有人有兴趣把它作为一个操作系统项目来做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T13:37:53.443

查看代码项目中的[测量单位转换库](http://www.codeproject.com/KB/library/Measurement_Conversion.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T13:45:01.600

我们实际上在我工作的地方建了一个内部。不幸的是，它不向公众开放。

这实际上是一个很棒的项目，而且做起来并不难。如果您打算自己做某事，我建议您阅读有关[Quantity](http://en.wikipedia.org/wiki/Physical_quantity)、[Dimension](http://en.wikipedia.org/wiki/Dimensional_analysis)和[Unit](http://en.wikipedia.org/wiki/Units_of_measurement)（[基本单位](http://en.wikipedia.org/wiki/Fundamental_units)）的内容。

这些帮助我们清楚地了解问题的领域，并在设计库时提供了很多帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T15:01:13.180

在Jim Arlow 和 Ila Neustadt所著的[Enterprise Patterns and MDA: Building Better Software with Archetype Patterns and UML一书的](http://www.informit.com/store/product.aspx?isbn=9780321112309&aid=3B419801-6640-4A1F-A653-6CD00295FCDD)[第 10 章数量原型模式](https://learning.oreilly.com/library/view/enterprise-patterns-and/032111230X/ch10.html)中，对这个主题和一些通用模式进行了非常有用的讨论，您可以将其用作指南。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:15:41.450

另请参阅最新的 F# 版本 - 它具有静态测量域/维度分析。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-19T15:25:57.427

[CodeProject](https://www.codeproject.com/Articles/611731/Working-with-Units-and-Amounts)上有一篇（旧）文章。我以前在生产环境中使用过它，效果很好。我们遇到了一些小问题（性能等），我解决了这些问题。我把所有这些都放在了一个你可以在[这里](https://github.com/petermorlion/RedStar.Amounts)找到的库中。

**免责声明：**我是这个项目的维护者，所以这可能被认为是一个无耻的插件。然而，图书馆是免费的（就像啤酒和演讲一样）。

它包括 SI 单位，但也允许创建新单位和转换。

例如，您可以创建一个单位“XP”（经验值）。然后，您可以注册转换为“m”（米，没有意义，但您可以做到）。您还可以创建一个像 3 XP/min（每分钟 3 经验值）这样的数量。我相信它提供了不错的默认值，同时允许灵活性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-12T09:37:31.200

Unix[单位](http://linux.die.net/man/1/units)太棒了；来源必须在网络上的某个地方。
（在“错误”下，原始文档说“不要将您的财务计划建立在货币兑换上”。）

# c++ - 正则表达式的开发人员

> ID：54047
> 
> 赞同：4
> 
> 时间：2008-09-10T13:37:15.910
> 
> 标签：c++, regex, visual-c++, utilities

我一直在尝试找出一个正则表达式来允许我在自动跳过评论的同时搜索特定的字符串。任何人有这样的RE或知道一个吗？它甚至不需要复杂到可以跳过`#if 0`块；我只是希望它跳过`//`并`/*`阻止。相反，仅在注释块内搜索，也将非常有用。

环境：VS 2003

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T13:40:23.250

这是一个比最初看起来更难的问题，因为您需要考虑字符串中的注释标记、本身被注释掉的注释标记等。

我为 C# 编写了一个字符串和注释解析器，让我看看我是否可以挖掘出一些有用的东西......如果我发现任何东西，我会更新。

编辑：...好的，所以我找到了我的旧“codemasker”项目。事实证明，我是分阶段进行的，而不是使用单个正则表达式。基本上，我通过一个源文件来寻找开始标记，当我找到一个时，我会寻找一个结束标记并掩盖其间的所有内容。这考虑了开始标记的上下文......如果您找到“字符串开始”的标记，那么您可以安全地忽略注释标记，直到找到字符串的结尾，反之亦然。一旦代码被屏蔽（我使用 guid 作为掩码，并使用哈希表来跟踪），您就可以安全地进行搜索和替换，然后最终恢复被屏蔽的代码。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T14:15:05.117

使用字符串时要特别小心。字符串通常具有转义序列，您在查找它们的结尾时也必须尊重这些序列。

所以例如`"This is \"a test\""`。您不能盲目地寻找双引号来终止。还要注意 `"This is \"`，这表明你不能只说“除非双引号前面有反斜杠”。

总之，做一些残酷的单元测试！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-11T01:07:43.880

正则表达式不是完成这项工作的最佳工具。

[Perl 常见问题解答](http://perldoc.perl.org/perlfaq6.html#How-do-I-use-a-regular-expression-to-strip-C-style-comments-from-a-file%3f)：

C 评论：

```
#!/usr/bin/perl
$/ = undef;
$_ = <>; 

s#/\*[^*]*\*+([^/*][^*]*\*+)*/|([^/"']*("[^"\\]*(\\[\d\D][^"\\]*)*"[^/"']*|'[^'\\]*(\\[\d\D][^'\\]*)*'[^/"']*|/+[^*/][^/"']*)*)#$2#g;
print; 
```

C++ 评论：

```
#!/usr/local/bin/perl
$/ = undef;
$_ = <>;

s#//(.*)|/\*[^*]*\*+([^/*][^*]*\*+)*/|"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[^/"']+#  $1 ? "/*$1 */" : $& #ge;
print; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:31:31.803

我会先复制并删除评论，然后以常规方式搜索字符串。

# asp.net - 如何从 ASP.NET 应用程序中获取登录的 Windows 域帐户？

> ID：54050
> 
> 赞同：8
> 
> 时间：2008-09-10T13:38:23.753
> 
> 标签：asp.net, webforms, login, ntlm

我们有一个 ASP.NET 应用程序来管理它自己的用户、角色和权限数据库，我们最近在用户表中添加了一个字段来保存 Windows 域帐户。

我想让用户不必 **亲自**登录我们的应用程序，而是根据当前登录的 Windows 域帐户 DOMAIN\username 自动登录。我们想根据我们自己的用户表对 Windows 域帐户进行身份验证。

这是在 Windows 窗体中做的小菜一碟，是否可以在 Web 窗体中做到这一点？

我不希望用户收到 Windows 挑战屏幕提示，我希望我们的系统处理登录。

**澄清**：我们正在使用我们自己的自定义 Principal 对象。

**澄清**：不确定它是否有所作为，但我们使用的是 IIS7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-20T17:23:45.397

这种集成是在服务器级别，是 IIS 决定用户未登录；并且是 IIS 将身份验证提示发送回用户，浏览器对此做出反应。

由于您想使用域登录，因此只有一种方法可以做到这一点；[集成 Windows 身份验证](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/1aa70bfa-add5-4f61-9c7b-a095c1bd4306.mspx?mfr=true)。这只有在 IIS 服务器也是域的一部分并且用户直接访问机器而不是通过代理，并且从也是域的一部分的机器（用户适当地登录）时才有效。

但是，您的自定义主体对象可能会创造乐趣和游戏；这种类型的身份验证将是一个 WindowsPrincipal 和一个 WindowsIdentity；您可以通过 User 对象访问它（请参阅[如何：在 ASP.NET 2.0 中使用 Windows 身份验证](http://msdn.microsoft.com/en-us/library/ms998358.aspx)）

我假设您因为您的自定义角色而想要一个自定义主体？我怀疑你能否让这两个发挥得很好。您可以创建一个自定义[角色提供程序](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)来查看您的数据存储，或者查看您可以查看[ADAM](http://msdn.microsoft.com/en-us/library/ms998358.aspx)，它是 AD 的扩展，它在每个程序的基础上提供角色并带有很好的管理工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T13:44:28.310

```
using System.Security.Principal;
...
WindowsPrincipal wp = (WindowsPrincipal)HttpContext.Current.User; 
```

获取当前域用户。当然，您必须确保将 IIS 设置为处理 Windows 身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T13:49:03.683

这可能会有所帮助：

```
WindowsIdentity myIdentity = WindowsIdentity.GetCurrent();

WindowsPrincipal myPrincipal = new WindowsPrincipal(myIdentity);

string name = myPrincipal.Identity.Name;
string authType = myPrincipal.Identity.AuthenticationType;
string isAuth = myPrincipal.Identity.IsAuthenticated.ToString();

string identName = myIdentity.Name;
string identType = myIdentity.AuthenticationType;
string identIsAuth = myIdentity.IsAuthenticated.ToString();
string iSAnon = myIdentity.IsAnonymous.ToString();
string isG = myIdentity.IsGuest.ToString();
string isSys = myIdentity.IsSystem.ToString();
string token = myIdentity.Token.ToString(); 
```

免责声明：我从一篇技术网文章中得到了这个，但我找不到链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T13:53:17.977

几年前我做了你想做的事情。我试图为它找到一些代码，尽管它是在以前的工作中，所以代码就在家里。

我记得虽然我用[这篇文章](http://msdn.microsoft.com/en-us/library/ms998360.aspx)作为我的起点。您设置了 LDAP 提供程序，以便您可以实际运行用户与 LDAP 的检查。如果您尝试使用 LDAP 方法，请确定一件事。在设置 LDAP 的设置文件中，确保 LDAP 全部大写，否则将无法解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T14:18:00.353

您可以使用`System.Threading.Thread.CurrentPrincipal`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-11T18:41:43.643

Request.ServerVariables["REMOTE_USER"]

这对于您的设置未经验证，但我记得不久前使用过它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-09T20:12:52.770

试试 Request.ServerVariables("LOGON_USER")。

如果设置了目录安全选项以使该目录不允许匿名用户，则当冲浪者点击此页面时，他们将收到标准模式对话框的提示，要求输入用户名和密码。Request.ServerVariables("LOGON_USER") 将返回该用户。

但是，这可能对您不起作用，因为您使用的是自己的自定义安全对象。如果你能弄清楚如何绕过那个登录框，或者在它要求它们之前将 NT 凭据传递给站点，那么你就一切就绪了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-10T14:03:21.057

你有没有想过模仿？您可以将用户的 NT 登录凭据存储在您的自定义安全对象中，然后在适当的时候通过代码假冒用户。

[http://msdn.microsoft.com/en-us/library/aa292118(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa292118(VS.71).aspx)

# visual-studio - 查看解决方案用户选项文件 (.suo) 内容的工具

> ID：54052
> 
> 赞同：26
> 
> 时间：2008-09-10T13:39:09.963
> 
> 标签：visual-studio, projects-and-solutions, suo

是否有任何免费工具可用于查看解决方案用户选项文件（解决方案文件随附的 .suo 文件）的内容？

我知道它基本上被格式化为文件中的文件系统，但我希望能够查看内容，以便弄清楚我的解决方案和自定义的哪些方面导致它随着时间的推移变得非常大。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-07-13T08:50:43.573

原始海报有点晚，但可能对其他人有用。

用于结构化存储文件（包括 .suo 文件）的两个免费软件查看器：

[https://github.com/ironfede/openmcdf](https://github.com/ironfede/openmcdf)（旧网址：http: [//sourceforge.net/projects/openmcdf/](http://sourceforge.net/projects/openmcdf/)）

[http://www.mitec.cz/ssv.html](http://www.mitec.cz/ssv.html)（非商业用途免费）

当您在其中一个查看器中打开 .suo 文件时，您将看到与以下内容相关的流：

*   书签
*   调试器监视
*   卸载项目
*   概述
*   任务列表用户任务
*   调试器异常
*   调试器断点
*   调试器查找源数据
*   打开文档窗口

以及更多...

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-02T07:55:39.740

.SUO 文件实际上是一次性的。如果它变得太大，只需将其删除。Visual Studio 将创建一个新的。

如果您*确实*想在其中四处寻找，它看起来像一个 OLE 复合文档文件。您应该能够使用 StgOpenStorage 函数来获取 IStorage 指针。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-13T00:49:20.490

我不知道有什么工具，但是您可以编写一个 Visual Studio 扩展来列出内容而无需太多工作。

如果您下载[Visual Studio SDK](http://msdn.microsoft.com/en-us/vsx/default.aspx)，它有一些可以使用的简单示例。找到一个看起来合适的（可能是工具窗口，如果你想给自己一个图形显示）并举起它（当然是为了你自己的个人使用）。

正如 aku 提到的，您在任何 VS 扩展中实现的 Package 类已经实现了 IVSPersistSolutionOpts，这很容易。所以你可以在你的包上调用[ReadUserOptions](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivspersistsolutionopts.readuseroptions(VS.80).aspx)方法并检查内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T13:44:29.373

我不知道任何工具，但您可以尝试通过[IVsPersistSolutionOpts](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivspersistsolutionopts_members%28VS.80%29.aspx) 接口访问用户设置

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-03T13:07:52.607

[您可以使用OpenMCDF](http://openmcdf.sourceforge.net/)附带的内置工具，称为结构化存储资源管理器。它不允许您查看所有详细信息，但允许您查看所有单独的设置及其大小。为了查看实际设置，您需要将字节格式化为 UTF-16。

参考： [https ://github.com/ParticularLabs/SetStartupProjects](https://github.com/ParticularLabs/SetStartupProjects)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-18T03:23:51.383

我为此创建了一个开源 dotnet 全局工具：

```
dotnet install --global suo
suo view <path-to-suo-file> 
```

更多信息请访问[https://github.com/drewnoakes/suo](https://github.com/drewnoakes/suo)

# algorithm - 从链表中有效地选择一组随机元素

> ID：54059
> 
> 赞同：40
> 
> 时间：2008-09-10T13:40:48.880
> 
> 标签：algorithm, language-agnostic, list

假设我有一个长度数字的链表`N`。`N`非常大，我事先不知道 的确切值`N`。

我怎样才能最有效地编写一个从列表中返回`k`完全*随机数*的函数？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-01-18T07:31:39.577

有一个非常好的和有效的算法，使用一种叫做**储层采样**的方法。

让我从给你它的**历史**开始：

**Knuth**在 p 上将此算法称为 R。他 1997 年版的半数算法（计算机编程艺术的第 2 卷）的第 144 卷，并在那里提供了一些代码。Knuth 将该算法归功于 Alan G. Waterman。尽管搜索了很长时间，但我还是找不到 Waterman 的原始文档（如果存在），这可能就是为什么您经常会看到 Knuth 被引用为该算法的来源的原因。

**McLeod 和 Bellhouse，1983** (1) 提供了比 Knuth 更彻底的讨论，以及该算法有效的第一个公开证明（据我所知）。

**Vitter 1985** (2) 回顾了算法 R，然后提出了另外三种算法，它们提供相同的输出，但有所不同。他的算法不是选择包含或跳过每个传入元素，而是预先确定要跳过的传入元素的数量。在他的测试中（诚然，这些测试现在已经过时了），通过避免随机数生成和对每个传入数字的比较，显着减少了执行时间。

在**伪代码**中，算法是：

```
Let R be the result array of size s
Let I be an input queue

> Fill the reservoir array
for j in the range [1,s]:
  R[j]=I.pop()

elements_seen=s
while I is not empty:
  elements_seen+=1
  j=random(1,elements_seen)       > This is inclusive
  if j<=s:
    R[j]=I.pop()
  else:
    I.pop() 
```

请注意，我专门编写了代码以避免指定输入的大小。这是该算法的一个很酷的特性：您可以运行它而无需事先知道输入的大小，它*仍然*可以确保您遇到的每个元素都有相同的概率结束`R`（也就是说，没有偏见）。此外，`R`包含算法一直考虑的元素的公平和代表性样本。这意味着您可以将其用作[在线算法](https://en.wikipedia.org/wiki/Online_algorithm)。

**为什么这行得通？**

McLeod 和 Bellhouse (1983) 使用组合数学提供了一个证明。它很漂亮，但在这里重建它会有点困难。因此，我生成了一个更容易解释的替代证明。

我们通过归纳证明进行。

假设我们想要生成一组`s`元素并且我们已经看到`n>s`了元素。

让我们假设我们当前的`s`元素已经以概率被选择`s/n`。

根据算法的定义，我们选择`n+1`概率为 的元素`s/(n+1)`。

已经是我们结果集中一部分的每个元素都有`1/s`被替换的概率。

`n`因此，来自 -seen 结果集中的元素在-seen 结果集中被替换的概率`n+1`为`(1/s)*s/(n+1)=1/(n+1)`。相反，元素未被替换的概率为`1-1/(n+1)=n/(n+1)`。

因此，`n+1`-seen 结果集包含一个元素，如果它是`n`-seen 结果集的一部分并且没有被替换---这个概率是`(s/n)*n/(n+1)=s/(n+1)`---或者如果元素被选择---具有概率`s/(n+1)`。

算法的定义告诉我们，第一个`s`元素自动包含`n=s`在结果集中的第一个成员中。因此，`n-seen`结果集包括具有 (=1) 概率的每个元素，`s/n`为我们提供了必要的归纳基础案例。

**参考**

1.  McLeod、A. Ian 和 David R. Bellhouse。“一种用于绘制简单随机样本的便捷算法。” 皇家统计学会杂志。系列 C（应用统计）32.2（1983）：182-184。（[链接](http://www.jstor.org/stable/10.2307/2347297)）

2.  Vitter, Jeffrey S. “水库随机抽样”。ACM 数学软件交易 (TOMS) 11.1 (1985): 37-57。（[链接](http://www.mathcs.emory.edu/~cheung/Courses/584-StreamDB/Syllabus/papers/RandomSampling/1985-Vitter-Random-sampling-with-reservior.pdf)）

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-09-10T13:54:13.030

这称为[储层采样](http://gregable.com/2007/10/reservoir-sampling.html)问题。简单的解决方案是为列表的每个元素分配一个随机数，如您所见，然后保持顶部（或底部）k 个元素按随机数排序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T13:45:28.900

我建议：首先找到你的 k 个随机数。对它们进行排序。然后遍历链表和你的随机数一次。

如果您不知何故不知道链表的长度（如何？），那么您可以将第一个 k 抓取到一个数组中，然后对于节点 r，在 [0, r) 中生成一个随机数，如果它小于比 k，替换数组的第 r 项。（不完全相信没有偏见......）

除此之外：“如果我是你，我不会从这里开始。” 您确定链表适合您的问题吗？有没有更好的数据结构，比如好的旧的平面数组列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:22:07.487

如果您不知道列表的长度，那么您将必须完整地遍历它以确保随机选择。我在这种情况下使用的方法是 Tom Hawtin ( [54070](https://stackoverflow.com/questions/54059/efficiently-selecting-a-set-of-random-elements-from-a-linked-list#54070) ) 所描述的方法。在遍历列表时，您将`k`构成随机选择的元素保留到该点。（最初你只是添加`k`你遇到的第一个元素。）然后，你用列表中的第 th 个元素（即你当时所在的元素）`k/i`替换你选择的随机元素。`i`

很容易证明这给出了随机选择。在看到`m`元素 ( `m > k`) 之后，我们发现`m`列表的第一个元素中的每一个都是您随机选择的一部分，概率为`k/m`。这最初成立是微不足道的。然后对于每个元素`m+1`，您将其放入您的选择中（替换随机元素） 概率`k/(m+1)`。您现在需要证明所有其他元素也有`k/(m+1)`被选中的概率。我们知道概率是`k/m * (k/(m+1)*(1-1/k) + (1-k/(m+1)))`（即元素在列表中的概率乘以它仍然存在的概率）。使用微积分，您可以直接证明这等于`k/(m+1)`。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-09-10T13:45:55.187

好吧，您至少需要知道 N 在运行时是多少，即使这涉及对列表进行额外的传递以计算它们。最简单的算法是在 N 中选择一个随机数并删除该项目，重复 k 次。或者，如果允许返回重复数字，请不要删除该项目。

除非你有一个非常大的 N 和非常严格的性能要求，否则这个算法运行起来很`O(N*k)`复杂，这应该是可以接受的。

编辑：没关系，Tom Hawtin 的方法要好得多。先选择随机数，然后遍历列表一次。我认为，理论上的复杂性相同，但预期的运行时间要好得多。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-10T13:49:25.617

为什么你不能做类似的事情

```
List GetKRandomFromList(List input, int k)
  List ret = new List();
  for(i=0;i<k;i++)
    ret.Add(input[Math.Rand(0,input.Length)]);
  return ret; 
```

我敢肯定你的意思不是那么简单，所以你能进一步说明吗？

# iis - 在 Vista 中开发的任何限制

> ID：54068
> 
> 赞同：0
> 
> 时间：2008-09-10T13:45:20.650
> 
> 标签：iis, windows-vista

我正在寻找一台可能具有 vista 的新计算机。但是有很多版本的vista；您可以在各种版本上运行的内容有什么奇怪的限制吗？例如，您无法在 Windows ME 上运行 IIS。你还能在vista的家庭版上运行IIS吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-10T13:49:30.593

您不能在“基本”版本上运行 Aero，并且有一些“附加”只能在 Ultimate 中运行。不过，您可能不会关心那些用于开发的东西。唯一需要注意的是它具有与 XP 相同的客户端访问限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T13:51:11.820

Vista Home Basic 仅具有足够的 IIS 功能来托管 WCF 服务，并且没有任何用于托管静态文件、asp.net 等的 Web 服务器功能。

这是比较版本的[链接。](http://www.microsoft.com/windows/windows-vista/compare-editions/default.aspx)我建议使用 Home Premium 或 Ultimate，具体取决于计算机是否在域上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T13:53:17.243

除非您需要连接到域控制器（如果您不知道那是什么，则不需要它），请获取家庭高级版。

# c# - 如何使用 C# 发送彩信

> ID：54092
> 
> 赞同：2
> 
> 时间：2008-09-10T13:51:31.743
> 
> 标签：c#, mms

我需要发送彩信以为 C# 应用程序。我已经找到了 2 个有趣的组件： [http://www.winwap.com](http://www.winwap.com)
[http://www.nowsms.com](http://www.nowsms.com)

有没有人有其他第三方组件的经验？
有人可以解释我需要什么样的服务器来发送这些彩信吗？它是经典的 SMTP 服务器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T14:06:04.953

通常，我总是使用 3rd 方聚合器来完成此操作。消息被编译成 SMIL，它是 MMS 消息的描述语言。然后将它们发送到聚合器，聚合器将通过网络运营商的 MMS 网关发送它们。它们通常按每条消息收费，聚合器将从运营商那里购买块中的消息。

如果您尝试发送彩信而不收取费用，那么我不确定如何执行此操作，或者是否可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T13:54:15.887

你可以自己做。一些 MMS 公司只有一个可以调用的 SOAP API。您需要做的就是构建 XML 并通过 URL 将其发送出去。我以前做过一次，但不记得我使用的公司的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T14:12:10.227

[这篇文章](https://stackoverflow.com/questions/53019/what-kind-of-technologies-are-available-for-sending-text-messages#53067)前面讨论了 SMS 的不同方法，可能对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T23:59:57.060

您可以使用 Twilio 来完成此操作。您可以[深入了解文档](https://www.twilio.com/docs/quickstart/csharp/sms/sending-via-rest)以了解具体的实现细节，但使用[C# 帮助程序库](https://www.twilio.com/docs/csharp/install)发送 MMS 的代码如下所示：

```
 // Send a new outgoing MMS by POSTing to the Messages resource */
    client.SendMessage(
        "YYY-YYY-YYYY", // From number, must be an SMS-enabled Twilio number
        person.Key,     // To number, if using Sandbox see note above
        // message content
        string.Format("Hey {0}, Monkey Party at 6PM. Bring Bananas!", person.Value),
        // media url of the image
        new string[] {"https://demo.twilio.com/owl.png" }
    ); 
```

免责声明：我为 Twilio 工作。

# asp.net - 通过 HTTPS 在 ASP.NET 中保护会话 cookie

> ID：54096
> 
> 赞同：14
> 
> 时间：2008-09-10T13:53:12.283
> 
> 标签：asp.net, security, session, cookies

[读完这个/](http://it.slashdot.org/it/08/09/09/1558218.shtml)后有点好奇。关于劫持 HTTPS cookie 的[文章。](http://it.slashdot.org/it/08/09/09/1558218.shtml)我稍微追踪了一下，我偶然发现的一个很好的资源列出了一些[在这里](http://casabasecurity.com/content/using-aspnet-session-handling-secure-sites-set-secure-flag)保护 cookie 的方法。我必须使用 adsutil，还是在 web.config 的 httpCookies 部分中设置 requireSSL 会覆盖所有其他会话 cookie（[在此处介绍](http://msdn2.microsoft.com/en-us/library/ms228262.aspx)）？还有什么我应该考虑进一步加强会议的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-10T14:12:26.170

[https://www.isecpartners.com/media/12009/web-session-management.pdf](https://www.isecpartners.com/media/12009/web-session-management.pdf)

一份 19 页的白皮书“使用 Cookie 进行 Web 应用程序的安全会话管理”

它们涵盖了许多我以前从未在一个地方看到过的安全问题。值得一读。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-15T15:07:38.320

用于控制它的 web.config 设置位于 System.Web 元素内部，如下所示：

```
<httpCookies httpOnlyCookies="true" requireSSL="true" /> 
```

# perl - 有什么方法可以在 vim 中为 Perl 启用代码完成？

> ID：54104
> 
> 赞同：26
> 
> 时间：2008-09-10T13:57:07.983
> 
> 标签：perl, vim, vi

令人惊讶的是，当您精通 vim 时，您可以比标准 IDE（例如 Eclipse）更快地编写代码。但我真正怀念的一件事是代码完成，尤其是对于长变量名和函数。

有什么方法可以在 vim 中为 Perl 启用代码完成？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-10T13:59:16.263

`Ctrl`- `P`(Get Previous Match) 和`Ctrl`- `N`(Get Next Match) 是一种伪代码补全。他们基本上搜索您正在编辑的文件（向后`Ctrl`- `P`，向前`Ctrl`- `N`）（以及任何打开的缓冲区，如果您在 TAG 文件中使用 TAGS 任何内容）以查找以您输入的内容开头的单词并添加下拉列表. 即使不是智能感知，它对于变量和函数名称的效果也出奇的好。通常我使用`Ctrl`-`P`因为我要查找的变量或函数通常位于代码后面。此外，如果您打开同一个 Vim 副本，它会搜索您之前打开的文件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-10T14:03:45.817

Vim 7 支持全向补全。

例如，我的 vimrc 中有这个

```
autocmd FileType php set omnifunc=phpcomplete#CompletePHP 
```

然后，当我在插入模式下按`Ctrl`- `X` `Ctrl`-`O`时，我会得到一个自动完成可能性的下拉列表。

[这是perl](http://www.vim.org/scripts/script.php?script_id=1924)的omnicfunc 。不知道它有多好用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-10T14:00:04.670

嗯，Vim 的通用完成机制出奇的好，只是在插入模式下使用`Ctrl`- 。`N`此外，使用 Cx Cl 完成行非常方便。

另请查看 perl 的这个[vim 脚本](http://www.vim.org/scripts/script.php?script_id=556)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-16T18:00:36.587

如果将以下内容添加到文件中，标准的`Ctrl`+`N`和`Ctrl`+效果会更好：`P``~/.vim/ftplugin/perl.vim`

```
set iskeyword+=: 
```

然后它将自动完成模块名称等。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-16T14:13:34.213

其他答案之一中的 .vimrc 剪辑略有错误。要将 tab 键变成自动完成键，请使用以下代码：

```
inoremap <tab> <c-r>=InsertTabWrapper()<cr>

function! InsertTabWrapper()
    let col = col('.') - 1
    if !col || getline('.')[col - 1] !~ '\k'
        return "\<tab>"
    else
        return "\<c-p>"
    endif
endfunction 
```

[你可以在 Perlmonks 的这个线程中](http://perlmonks.org/?node_id=540167 ".vimrc for perl 程序员")找到这个以及大量其他 vim 技巧——它链接到具有更多自定义的更多线程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-10T14:05:30.210

`Ctrl`+`N`

Perl Hacks 一书中对此进行了解释，以及如何完成包。强烈推荐。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-15T14:41:37.587

您应该查看 SuperTab 插件： [http](http://www.vim.org/scripts/script.php?script_id=1643) ://www.vim.org/scripts/script.php ?script_id=1643 它让您使用 tab 和 shift-tab 而不是 ^ 来完成（OmniCompletion 或常规完成） N 和 ^P。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-27T19:39:40.510

[https://github.com/c9s/perlomni.vim](https://github.com/c9s/perlomni.vim)

# .net-3.5 - 在母版页上填充菜单控件的最佳方法是什么？

> ID：54118
> 
> 赞同：3
> 
> 时间：2008-09-10T14:05:56.933
> 
> 标签：.net-3.5, master-pages, sitemap, menu

数据库？页面变量？枚举？

我在这里寻找意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T14:10:12.820

ASP.NET 站点地图功能就是为此而构建的，并且在很多情况下都能很好地工作。如果您希望您的[菜单看起来与站点地图不同，这里有一些解决方法](http://weblogs.asp.net/jgalloway/archive/2008/01/26/asp-net-menu-and-sitemap-security-trimming-plus-a-trick-for-when-your-menu-and-security-don-t-match-up.aspx)。

如果您有动态站点结构，则可以[创建自定义站点地图提供程序](http://msdn.microsoft.com/en-us/library/aa479320.aspx#custsit_topic4)。您可能会遇到麻烦多于其价值的问题，但总的来说，从站点地图中填充菜单会为您提供一些不错的功能，例如安全修剪，其中菜单选项适合登录用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T14:09:06.893

这是一个有趣的问题，有很多方法可以解决它。

您可以从 XML 加载菜单结构，这就是内置 ASP.NET 导航控件/“站点地图”设置的工作方式。总体而言，这可能是一个不错的选择，并且在 Visual Studio 中有相当不错的工具。

如果它是一个需要大量更改的动态菜单，那么从数据库中获取项目可能是一个好主意，但您肯定希望缓存它们，因此数据库不会在每个页面呈现时都受到影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-11T21:35:05.863

我使用[ASP.NET 登录控件](http://msdn.microsoft.com/en-us/library/ms178329.aspx)和[表单身份验证](http://msdn.microsoft.com/en-us/library/aa480476.aspx)为 ASP.NET Web 应用程序的成员资格/凭据创建了一个站点。我正在使用[站点地图](http://msdn.microsoft.com/en-us/library/yy2ykkab.aspx)进行站点导航。

我使用 SiteMapDataSource 填充了 ASP.NET TreeView 和 Menu 导航控件。但是非管理员用户可以看到仅限管理员的页面。

1.  我创建了一个 web.sitemap 站点地图文件。我[使用 ASP.NET 网站管理工具来设置访问规则](https://stackoverflow.com/questions/33263/how-do-i-best-handle-role-based-permissions-using-forms-authentication-on-my-as)。

2.  我在我的 .master 页面上添加了导航控件……

    ```
    <asp:SiteMapPath ID="SiteMapPath1" runat="server" />
    <asp:Menu ID="Menu1" runat="server" DataSourceID="SiteMapDataSource2" />
    <asp:TreeView ID="TreeView1" runat="server"  DataSourceID="SiteMapDataSource1" />
    <asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" />
    <asp:SiteMapDataSource ID="SiteMapDataSource2" runat="server" ShowStartingNode="False" /> 
    ```

3.  我在 web.config 文件中将 securityTrimmingEnabled 设置为“true”……

    ```
    <?xml version="1.0"?>
    <configuration>
        ...
        <system.web>
            ...
            <siteMap defaultProvider="default">
                <providers>
                    <clear/>
                    <add name="default"
                        type="System.Web.XmlSiteMapProvider"
                        siteMapFile="web.sitemap"
                        securityTrimmingEnabled="true"/>
                </providers>
            </siteMap>
            ...
        </system.web>
        ...
    </configuration> 
    ```

4.  我在文件后面的 master.vb 代码中调整了树…

    ```
    Protected Sub TreeView1_DataBound( ByVal sender As Object, ByVal e As EventArgs ) Handles TreeView1.DataBound

        'Collapse unnecessary menu items...
        If TreeView1.SelectedNode IsNot Nothing Then
            Dim n As TreeNode = TreeView1.SelectedNode
            TreeView1.CollapseAll()
            n.Expand()
            Do Until n.Parent Is Nothing
                n = n.Parent
                n.Expand()
            Loop
        Else
            TreeView1.ExpandAll()
        End If

    End Sub 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T14:07:53.060

如果菜单是*每个用户*的动态菜单，那么您必须为每个用户访问数据库。从那时起，我可能会将其存储在会话中，以避免将来往返数据库。

如果它是动态的，但整个站点看到相同的项目，则将其放入数据库并缓存结果

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T14:08:50.530

绑定到站点地图当然是最简单的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T14:16:47.483

这完全取决于网站的工作方式。我同意大多数人的观点，即站点地图通常是最好的方法。但是，如果您使用的是 CMS，则可能需要将其保存在数据库中。如果您有一个以分类为中心的网站，请使用分类来构建菜单。没有“最佳方式”进行导航，只有特定情况下的最佳方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T14:21:26.600

我们有一个类似的功能。

应用程序菜单从数据库加载到母版页上，因为可见菜单选项取决于用户的权限。

数据库上的一些约定和巧妙的结构确保菜单加载代码是通用的，并在选择某个菜单选项时自动导航到正确的屏幕。我们使用 UIP 进行导航，使用 ComponentArt 进行 Web 控件。

BTW ComponentArt 很烂。然后我想所有第三方控制库都可以。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-06T13:26:45.307

从用户的角度来看，高效访问是一项基本功能。一种通用的建议方法是 [字典查找](http://bu4.taipudex.com/pinyin.htm "字典查找")，它也非常适合大型和嵌套的菜单结构。用户通过点击或独特的按键进行导航，另外箭头键前进（右）或返回（左）与往常一样向上/向下。我建议填充菜单，除了最初的初始元素，只要选择最终元素，就会提供JavaScript操作。

# jquery - 使用jQuery美化别人的html

> ID：54138
> 
> 赞同：2
> 
> 时间：2008-09-10T14:12:30.740
> 
> 标签：jquery, html

我有一个第三方应用程序可以创建我需要显示的基于 HTML 的报告。我可以控制它们的外观，但总的来说它非常原始*。*不过，我*可以*注入一些 javascript。我想尝试在其中注入一些 jQuery 的优点来整理它。我想做的一件事是获取一个始终包含一行和可变数量列的表格（一个实际的 HTML <table>），然后神奇地将其转换为一个选项卡式视图，其中的内容（总是一个 <div>如果需要，我可以提供一个 ID）每个原始表格单元格代表选项卡式视图中的一个工作表。我还没有找到任何好的（阅读：简单）这样的重新养育项目的例子，所以我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T20:53:38.900

给定一个像这样的html页面：

```
<body><br/>
    <table id="my-table">`<br/>
        <tr><br/>
            <td><div>This is the contents of Column One</div></td><br/>
            <td><div>This is the contents of Column Two</div></td><br/>
            <td><div>This is the contents of Column Three</div></td><br/>
            <td><div>Contents of Column Four blah blah</div></td><br/>
            <td><div>Column Five is here</div></td><br/>
        </tr><br/>
    </table><br/>
</body><br/> 
```

以下 jQuery 代码将表格单元格转换为选项卡（在 FF 3 和 IE 7 中测试）

```
$(document).ready(function() {
    var tabCounter = 1;
    $("#my-table").after("<div id='tab-container' class='flora'><ul id='tab-list'></ul></div>");
    $("#my-table div").appendTo("#tab-container").each(function() {                    
        var id = "fragment-" + tabCounter;
        $(this).attr("id", id);
        $("#tab-list").append("<li><span><a href='#" + id + "'>Tab " + tabCounter + "</a></span></li>");
        tabCounter++;
    });
    $("#tab-container > ul").tabs();
}); 
```

为了让它工作，我引用了以下 jQuery 文件

*   jquery-latest.js
*   ui.core.js
*   ui.tabs.js

我引用了flora.all.css 样式表。基本上我从[jQuery 选项卡示例中复制了标题部分](http://docs.jquery.com/UI/Tabs#Example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T14:14:24.010

你可以用 jQuery 做到这一点，但它可能会使额外的维护成为一场噩梦。我建议不要这样做/屏幕抓取，因为如果源发生变化，你的工作也会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:28:04.900

这听起来当然是可能的。结合使用 jQuery.append 和 jQuery.fadeIn 和 fadeOut，您应该能够创建一个漂亮的小选项卡式控件。

请参阅 JQuery UI/Tabs 以获取基于`<ul>`元素和一组标签创建一组标签的简单方法：http `<div>'s`: [//docs.jquery.com/UI/Tabs](http://docs.jquery.com/UI/Tabs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T10:55:15.060

我还建议注入一个额外的样式表并使用它来显示/隐藏和设置丑陋元素的样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-07T10:35:55.580

听起来您不像 HTML Tidy 那样对 HTML 清理感兴趣，而是对静态 HTML 组件的交互式增强感兴趣（例如，在选项卡式界面中转换静态表格）。

这里的一些回复已经给了你提示，例如使用 Jquery Tabs，但我不喜欢他们的答案中的 HTML 重写方法。

恕我直言，最好使用 JQuery 选择器提取所需的表格单元格的内容，例如：

```
var mycontent = $('table tr[:first-child]').find('td[:first-child]').html() 
```

然后您可以通过以编程方式创建选项卡将此数据提供给 JQuery UI 插件：

```
$('body').append($('<div></div>').attr('id','mytabs'));
$('#mytabs').tabs({}); //specify tab preferences here
$('#mytabs').tabs('add',mycontent); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-26T13:17:31.063

美化 HTML 并不是一个简单的过程，因为标签之间的每个换行符都是一个文本节点，任意美化会以可能对文档结构有害且可能对内容有害的方式创建和删除文本节点。我建议使用已经考虑过所有这些条件的程序，例如[http://prettydiff.com/?m=beautify](http://prettydiff.com/?m=beautify)

# c++ - 逗号运算符如何工作

> ID：54142
> 
> 赞同：187
> 
> 时间：2008-09-10T14:13:39.550
> 
> 标签：c++, comma-operator

逗号运算符在 C++ 中如何工作？

例如，如果我这样做：

```
a = b, c; 
```

a最终等于b还是c？

（是的，我知道这很容易测试 - 只需在此处记录以供某人快速找到答案。）

**更新：** 这个问题暴露了使用逗号运算符时的细微差别。只是为了记录这一点：

```
a = b, c;    // a is set to the value of b!

a = (b, c);  // a is set to the value of c! 
```

这个问题实际上是受到代码中的错字的启发。本来打算是什么

```
a = b;
c = d; 
```

转换成

```
a = b,    //  <-  Note comma typo!
c = d; 
```

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-09-10T14:21:54.993

请注意逗号运算符可能在 C++ 中被重载。因此，实际行为可能与预期的非常不同。

例如，[Boost.Spirit](http://spirit.sourceforge.net/)非常巧妙地使用逗号运算符来实现符号表的列表初始值设定项。因此，它使以下语法成为可能且有意义：

```
keywords = "and", "or", "not", "xor"; 
```

请注意，由于运算符优先级，代码（故意！）与

```
(((keywords = "and"), "or"), "not"), "xor"; 
```

也就是说，调用的第一个运算符 is`keywords.operator =("and")`返回一个代理对象，在该对象上调用剩余`operator,`的 s：

```
keywords.operator =("and").operator ,("or").operator ,("not").operator ,("xor"); 
```

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2008-09-22T11:49:36.230

逗号运算符在所有 C/C++ 运算符中的优先级**最低。**因此，它始终是绑定到表达式的最后一个，这意味着：

```
a = b, c; 
```

相当于：

```
(a = b), c; 
```

另一个有趣的事实是逗号运算符引入了一个[序列点](http://en.wikipedia.org/wiki/Sequence_point)。这意味着表达式：

```
a+b, c(), d 
```

保证按顺序计算其三个子表达式（**a+b**、**c()**和**d ）。**如果它们有副作用，这很重要。通常允许编译器以他们认为合适的任何顺序来评估子表达式。例如，在函数调用中：

```
someFunc(arg1, arg2, arg3) 
```

可以按任意顺序评估参数。请注意，函数调用中的逗号*不是*运算符；它们是分隔符。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2008-09-10T14:14:27.910

这将等于`b`。

逗号运算符的优先级低于赋值。

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2013-10-05T14:43:20.383

逗号运算符：

*   具有最低优先级
*   是左结合的

为所有类型（内置和自定义）定义了逗号运算符的默认版本，它的工作方式如下 - 给定`exprA , exprB`：

*   `exprA`被评估
*   的结果`exprA`被忽略
*   `exprB`被评估
*   的结果`exprB`作为整个表达式的结果返回

对于大多数操作符，允许编译器选择执行顺序，甚至在不影响最终结果的情况下甚至需要跳过执行（例如`false && foo()`，将跳过对 的调用`foo`）。但是，逗号运算符并非如此，上述步骤将始终发生^*。

在实践中，默认逗号运算符的工作方式几乎与分号相同。不同之处在于，用分号分隔的两个表达式形成两个单独的语句，而逗号分隔将所有表达式保留为一个表达式。这就是为什么有时会在以下场景中使用逗号运算符的原因：

*   C 语法需要单个*表达式*，而不是语句。例如在`if( HERE )`
*   C 语法需要一条语句，而不是更多，例如在`for`循环的初始化中`for ( HERE ; ; )`
*   当你想跳过花括号并保留一个语句时：（`if (foo) HERE ;`请不要这样做，它真的很难看！）

当语句不是表达式时，分号不能用逗号代替。例如，这些是不允许的：

*   `(foo, if (foo) bar)`（`if`不是表达式）
*   int x, int y（变量声明不是表达式）

* * *

在您的情况下，我们有：

*   `a=b, c;`, 等价于`a=b; c;`, 假设`a`是不重载逗号运算符的类型。
*   `a = b, c = d;`等效于`a=b; c=d;`，假设`a`是不重载逗号运算符的类型。

* * *

请注意，并非每个逗号实际上都是逗号运算符。一些具有完全不同含义的逗号：

*   `int a, b;`--- 变量声明列表以逗号分隔，但这些不是逗号运算符
*   `int a=5, b=3;`--- 这也是一个逗号分隔的变量声明列表
*   `foo(x,y)`--- 逗号分隔的参数列表。事实上，`x`可以`y`按*任何*顺序进行评估！
*   `FOO(x,y)`--- 逗号分隔的宏参数列表
*   `foo<a,b>`--- 逗号分隔的模板参数列表
*   `int foo(int a, int b)`--- 逗号分隔的参数列表
*   `Foo::Foo() : a(5), b(3) {}`--- 类构造函数中逗号分隔的初始化列表

* * *

^*如果您应用优化，这并不完全正确。如果编译器识别出某段代码对其余部分完全没有影响，它将删除不必要的语句。

进一步阅读：[http ://en.wikipedia.org/wiki/Comma_o​​perator](http://en.wikipedia.org/wiki/Comma_operator)

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2008-09-15T18:29:25.323

`a`的值为`b`，但***表达式***的值为`c`。也就是说，在

```
d = (a = b, c); 
```

`a`将等于`b`，并且`d`将等于`c`。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-10T14:16:54.113

b 的值将分配给 a。c 什么都不会发生

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-07-04T13:31:23.830

是 逗号运算符的优先级低于赋值运算符

```
#include<stdio.h>
int main()
{
          int i;
          i = (1,2,3);
          printf("i:%d\n",i);
          return 0;
} 
```

输出：i=3
因为逗号运算符总是返回最右边的值。
如果逗号运算符带有赋值运算符：

```
 int main()
{
      int i;
      i = 1,2,3;
      printf("i:%d\n",i);
      return 0;
} 
```

输出：i=1
正如我们所知，逗号运算符的优先级低于赋值......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-10T14:22:01.967

a 的值将等于 b，因为逗号运算符的优先级低于赋值运算符。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-04-07T10:39:17.477

**首先要做的事情：**逗号实际上不是运算符，对于编译器来说，它只是一个*在上下文中*与其他标记一起获得含义的标记。

## 这是什么意思，为什么要打扰？

**示例 1：**

为了理解不同上下文中相同标记的含义之间的差异，我们看一下这个例子：

```
class Example {
   Foo<int, char*> ContentA;
} 
```

通常 C++ 初学者会认为这个表达式可以/会比较事物，但这是绝对错误的，`<`和`>`的含义`,`取决于使用的上下文。

对上面例子的正确解释当然是它是一个模板的实例化。

**示例 2：**

当我们编写一个具有多个初始化变量和/或多个表达式的典型 for 循环时，应该在循环的每次迭代之后完成，我们也使用逗号：

```
for(a=5,b=0;a<42;a++,b--)
   ... 
```

逗号的含义取决于使用的上下文，这里是`for`构造的上下文。

## 上下文中的逗号实际上是什么意思？

更复杂的是（在 C++ 中总是如此），逗号运算符本身可以被重载（感谢[Konrad Rudolph](https://stackoverflow.com/users/1968/konrad-rudolph)指出这一点）。

回到这个问题，守则

```
a = b, c; 
```

对编译器来说意味着类似

```
(a = b), c; 
```

因为token/operator的[优先](http://en.cppreference.com/w/cpp/language/operator_precedence)`=`级高于`,`token的优先级。

这在上下文中被解释为

```
a = b;
c; 
```

（请注意，解释取决于上下文，这里它既不是函数/方法调用也不是模板实例化。）

# javascript - 如何使用 javascript 在插入符号处插入字符？

> ID：54147
> 
> 赞同：11
> 
> 时间：2008-09-10T14:14:48.300
> 
> 标签：javascript

我想在按钮上使用 javascript 在文本框中的插入符号处插入一些特殊字符。如何才能做到这一点？

该脚本需要找到活动文本框并将字符插入该文本框中的插入符号处。该脚本还需要在 IE 和 Firefox 中运行。

**编辑：**也可以在先前活动的文本框中插入字符“last”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T05:36:12.757

我认为杰森科恩是不正确的。失去焦点时会保留插入符号的位置。

[**编辑**：添加了我最初没有的 FireFox 代码。]

[**编辑**：添加代码以确定最近的活动文本框。]

首先，您可以使用每个文本框的 onBlur 事件将变量设置为“this”，以便您始终知道最近的活动文本框。

然后，有一种在 Opera 中也可以使用的 IE 获取光标位置的方法，而在 Firefox 中还有一种更简单的方法。

在 IE 中，基本概念是使用 document.selection 对象*并将*一些文本*放入*选择中。然后，使用 indexOf，您可以获得您添加的文本的位置。

在 FireFox 中，有一个名为 selectionStart 的方法可以为您提供光标位置。

一旦你有了光标位置，你就用覆盖整个 text.value

光标位置之前的文本 + 要插入的文本 + 光标位置之后的文本

这是一个带有 IE 和 FireFox 单独链接的示例。您可以使用自己喜欢的浏览器检测方法来确定要运行的代码。

```
<html><head></head><body>

<script language="JavaScript">
<!--

var lasttext;

function doinsert_ie() {
    var oldtext = lasttext.value;
    var marker = "##MARKER##";
    lasttext.focus();
    var sel = document.selection.createRange();
    sel.text = marker;
    var tmptext = lasttext.value;
    var curpos = tmptext.indexOf(marker);
    pretext = oldtext.substring(0,curpos);
    posttest = oldtext.substring(curpos,oldtext.length);
    lasttext.value = pretext + "|" + posttest;
}

function doinsert_ff() {
    var oldtext = lasttext.value;
    var curpos = lasttext.selectionStart;
    pretext = oldtext.substring(0,curpos);
    posttest = oldtext.substring(curpos,oldtext.length);
    lasttext.value = pretext + "|" + posttest;
}

-->
</script>

<form name="testform">
<input type="text" name="testtext1" onBlur="lasttext=this;">
<input type="text" name="testtext2" onBlur="lasttext=this;">
<input type="text" name="testtext3" onBlur="lasttext=this;">

</form>
<a href="#" onClick="doinsert_ie();">Insert IE</a>
<br>
<a href="#" onClick="doinsert_ff();">Insert FF</a>
</body></html> 
```

这也适用于文本区域。我不知道如何重新定位光标，使其停留在插入点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T14:51:55.310

根据您的更新：

```
var inputs = document.getElementsByTagName('input');
var lastTextBox = null;

for(var i = 0; i < inputs.length; i++)
{
  if(inputs[i].getAttribute('type') == 'text')
  {
    inputs[i].onfocus = function() {
      lastTextBox = this;
    }
  }
}

var button = document.getElementById("YOURBUTTONID");
button.onclick = function() {
  lastTextBox.value += 'PUTYOURTEXTHERE';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:18:34.580

请注意，如果用户按下按钮，文本框上的焦点将丢失，并且没有插入符号位置！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T14:19:10.660

循环遍历所有输入字段...找到具有焦点的字段...然后一旦您拥有文本区域...您应该能够执行类似...

myTextArea.value = '要插入到文本区域的文本到这里';

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T14:20:20.067

我不确定您是否可以捕获插入符号的位置，但如果可以，您可以通过使用文本框的`onblur`事件捕获位置（相对于字符串）来避免 Jason Cohen 的担忧。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T15:12:05.600

先前答案中的 @bmb 代码的屠宰版本也可以很好地将光标重新定位在插入字符的末尾：

```
var lasttext;

function doinsert_ie() {
 var ttInsert = "bla";
 lasttext.focus();
 var sel = document.selection.createRange();
 sel.text = ttInsert;
 sel.select();
}

function doinsert_ff() {
 var oldtext = lasttext.value;
 var curposS = lasttext.selectionStart;
 var curposF = lasttext.selectionEnd;
 pretext = oldtext.substring(0,curposS);
 posttest = oldtext.substring(curposF,oldtext.length);
 var ttInsert='bla';
 lasttext.value = pretext + ttInsert + posttest;
 lasttext.selectionStart=curposS+ttInsert.length;
 lasttext.selectionEnd=curposS+ttInsert.length;
} 
```

# silverlight - 您认为 1 年后 Silverlight 的使用水平会是多少？

> ID：54169
> 
> 赞同：1
> 
> 时间：2008-09-10T14:21:22.200
> 
> 标签：silverlight

有很多关于**Microsoft Silverlight**的讨论，尤其是在奥运会之后。也`H264`将在未来的版本中得到支持。您认为 1 年后 Silverlight 会在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T14:28:23.963

他们说他们在 2008 年 3 月每天获得 150 万次下载，那是在奥运会和民主党全国代表大会之前。所以，除非我的数学是关闭的，否则超过 4 人。

我希望看到它显示为推荐的 Windows 更新，并且可能包含在 IE8 或将来的其他东西中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T14:27:38.160

一年后，安装运行时的人数仍将是极少数！

我怀疑选择**Silverlight**仍然会成为人们在很长一段时间内使用您的东西的障碍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T14:30:35.110

与我一起工作的大多数**.NET**开发人员一直在回避**Silverlight**。

现在，它似乎更像是一个新奇事物，而不是一个开发平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:44:28.557

一年后它仍将是少数内容，但安装基数将足够大，主流项目将考虑将其作为 Flash 的可行替代品。在他们调查熟悉它的可用、有才华的设计师之前。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-11T04:48:47.247

充其量，在 Flash 的同一个地方。现在，你们中有多少人从事 Flash 企业应用程序？Google 会做 Flash 应用程序吗？还是 SalesForce.com？甲骨文？或任何其他主要的按需应用程序提供商？

在我看来，即使它杀死了 Flash，它仍然与我们每天编写的应用程序类型无关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T14:22:42.197

100% 以上。

（所以大约4人）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T14:26:19.007

考虑到 NBC 已经放弃了 Silverlight 并再次将 Flash 用于 NFL 电视转播，我认为微软平台的未来并不乐观。

他们甚至有其他合作伙伴使用它吗？我知道 WWE 是他们的合作伙伴之一，但他们几乎没有在自己的网站上使用它。

编辑——不确定这是否属实，但这[个人](http://seekingalpha.com/article/94513-nbc-did-not-drop-dump-or-ditch-silverlight-in-favor-of-flash)说选择 Flash 的决定是 NFL 而不是 NBC。无论哪种方式，对于 MS 平台来说都不是很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T14:26:26.043

我认为只要[Moonlight](http://www.mono-project.com/Moonlight)项目成功，我们就会看到 Silverlight 成为 Flash 的重要竞争对手。

Silverlight 仍处于起步阶段 - 1.0 几乎没有。版本 2 现在处于测试阶段，它添加了许多开发人员编写应用程序所需的通用用户控件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T14:29:44.270

就将其安装在机器上而言，他们确实对奥运会产生了巨大的影响。看看他们能收集到多少开发商购买将会很有趣。对于前端网络人员来说，这是一个艰难的销售，因为它是一个完整的工具集更改。我知道 midteir/WPF 人喜欢它，因为它更接近于他们的正常 .NET 工具集，但他们**通常**不是从事网页设计的人。

恕我直言，HTML5 和 Gears 之类的东西是很多人要去的地方。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-10T14:35:37.220

我认为它会增长，但 MSFT 需要做更多的交易，就像他们在奥运会上所做的那样。在疯狂三月的广播中与 CBS/NCAA 联播将值得他们投入数百万美元。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-10T14:52:00.303

**Silverlight 1 与 Silverlight 2：**

Silverlight 2 预计将在未来几个月内推出（他们过去常说在 2008 年 8 月直到...... 8 月结束。在 9 月他们说 10 月。），所以 MS 可能会推广 Silverlight 2.1（或任何升级到 Silerlight 2 ) 一年后，Silverlight 1.0 很可能完全没有开发者份额，也没有动力。

**Silverlight 与基于 Javascript 的平台：**

谷歌浏览器（以及即将推出的 Firefox 2.1）承诺在 JavaScript 中的性能会提高一个数量级。我们还没有看到他们最好的一面。MS 将不得不提高 IE 的 JavaScript 速度，但谁知道他们什么时候才能发布（也许在 IE 9 中？）。

我认为在明显的赢家从竞争中脱颖而出还需要几年时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T11:19:17.290

在默认情况下随 Windows 一起提供之前，安装障碍将是一个问题。但即便如此，开发人员也只会支持已建立的 Flash。考虑到某些移动平台既没有 Flash 也没有 Silverlight，最好支持一个更有可能移植到所有平台的平台，那就是占主导地位的 Flash。

最后 Javascript + SVG 几乎肯定会胜过这些供应商生产的解决方案。但在一年之内，如果使用 Silverlight 完成任何大量开发，我会感到惊讶。Flash 有太多的动力，而 MS 对游戏来说太晚了，没有足够的吸引力。

# sql - 使用 CTE 的优点/缺点是什么？

> ID：54176
> 
> 赞同：3
> 
> 时间：2008-09-10T14:22:33.337
> 
> 标签：sql, sql-server, common-table-expression

我正在考虑提高某些 SQL 的性能，目前 CTE 在脚本中被多次使用和引用。我会改用表变量来改进吗？（不能使用临时表，因为代码在函数内）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-15T20:17:54.313

你真的必须进行性能测试 - 没有是/否的答案。根据 Andy Living 的上述链接，CTE 只是查询或子查询的简写。

如果您在同一个函数中调用它两次或更多次，则填充表变量然后加入/从中选择可能会获得更好的性能。但是，由于表变量在某处占用空间，并且没有索引/统计信息（表变量上声明的任何主键除外），因此无法说哪个会更快。

他们都有成本和节省，哪种方式最好取决于他们提取的数据以及他们如何处理这些数据。我遇到过您的情况，并且在测试了各种条件下的速度之后-某些函数使用了 CTE，而其他函数则使用了表变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T14:30:02.070

可能不是。CTE 特别擅长查询树结构的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-19T08:22:57.270

**CTE的优势**

CTE 可以称为“临时视图”，在某些情况下用作视图的良好替代品。视图的主要优点是内存的使用。由于 CTE 的范围仅限于其批次，因此一旦超过其批次，分配给它的内存就会被刷新。但是一旦创建了一个视图，它就会被存储，直到用户删除它。如果视图在创建后没有被使用，那么它只是浪费内存。与 View 相比，CTE 执行的 CPU 成本更低。与 View 一样，CTE 不存储其定义的任何元数据并提供更好的可读性。一个 CTE 可以在一个查询中被引用多次。由于范围仅限于批处理，因此多个 CTE 可以具有视图不能具有的相同名称。它可以是递归的。

**CTE的缺点**

尽管使用 CTE 是有利的，但它确实有一些限制需要牢记，我们知道它是视图的替代品，但 CTE 不能嵌套，而视图可以嵌套。声明后的视图可以多次使用，但不能使用 CTE。每次你想使用它时都应该声明它。对于这种情况，不建议使用 CTE，因为用户一次又一次地声明批次是一项累人的工作。在锚成员之间应该有 UNION、UNION ALL 或 EXCEPT 等运算符。在递归 CTE 中，您可以定义许多锚成员和递归成员，但所有锚成员必须在第一个递归成员之前定义。您不能在两个递归成员之间定义锚成员。Anchor 和 Recursive Members 中使用的列数、数据类型应该相同。在递归成员中，不允许使用 TOP 等聚合函数、DISTINCT 等运算符、HAVING 和 GROUP BY 等子句、子查询、Left Outer 或 Right Outer 或 Full Outer 等连接。关于 Join，Recursive Member 中只允许 Inner Join。Recursion Limit 为 32767，越过导致无限循环导致服务器崩溃。

# algorithm - 构建推荐引擎时应该考虑什么？

> ID：54179
> 
> 赞同：19
> 
> 时间：2008-09-10T14:23:16.690
> 
> 标签：algorithm, recommendation-engine

我读过《[编程集体智能](http://oreilly.com/catalog/9780596529321/ "编程集体智能")》一书，觉得它很吸引人。我最近听说亚马逊向全世界发布了一项挑战，旨在为他们的系统提供更好的推荐引擎。

获胜者显然通过限制提供给它的信息量来产生最好的算法。

作为第一条经验法则，我猜......“**在模糊算法方面，更多信息不一定更好。”**

我知道这是主观的，但最终它是可衡量的（响应推荐的点击）。

由于这些天我们大多数人都在处理网络并且搜索可以被视为一种推荐形式......我怀疑我不是唯一一个会欣赏其他人对此想法的人。

简而言之，**“建立推荐的最佳方式是什么？”**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T14:31:42.143

除非您没有关于用户的信息，否则您不想使用“整体流行度”。相反，您希望将此用户与相似用户对齐并相应地加权。

这正是[贝叶斯推理](http://en.wikipedia.org/wiki/Bayesian_inference)所做的。在英语中，这意味着调整您喜欢某事的总体概率（平均评分）与其他*通常也以您的方式投票的*人的评分。

另一条建议，但这次是特设的：我发现有些人如果喜欢某样东西，我几乎肯定*不会*喜欢它。我不知道这种影响是真实的还是想象的，但建立一种“负面影响”而不是仅仅通过相似性将人们聚集在一起可能会很有趣。

最后有一家专门从事这方面的公司，叫做[SenseArray](http://sensearray.com/)。所有者（[freenet 名声](http://freenetproject.org/)的[伊恩克拉克](http://en.wikipedia.org/wiki/Ian_Clarke_(computer_scientist))）非常平易近人。如果你打电话给他，你可以用我的名字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-23T15:48:39.390

计算机科学中有一个完整的研究领域致力于这一主题。我建议阅读[一些文章](http://scholar.google.com/scholar?q=recommendation+engine&hl=en&lr=&btnG=Search)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-05T05:51:39.297

同意@Ricardo。这个问题太宽泛了，比如问“优化系统的最佳方法是什么？”

几乎所有现有推荐引擎的一个共同特征是，做出最终推荐归结为将一些矩阵和向量相乘。例如，将包含用户之间接近权重的矩阵乘以项目评分向量。

（当然，你必须准备好让你的大多数向量变得超级稀疏！）

我的回答对于@Allain 来说肯定为时已晚，但对于其他通过搜索找到这个问题的用户来说——给我发私信并问一个更具体的问题，我一定会回复。

*（我专业地设计推荐引擎。）*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-18T19:16:56.453

@老子，我同意你的看法。

据我介绍，推荐引擎由以下部分组成：

> *   来自上下文感知系统的上下文输入（记录所有数据）
> *   过滤最明显的逻辑推理
> *   专家系统可根据上下文输入在一段时间内改进您的主观数据，以及
> *   基于先前行为（信念、愿望和意图）的加权总和进行接近接近决策的概率推理。

PS我做了这样的推荐引擎。

# windows - 监控网络连接带宽的最佳工具

> ID：54184
> 
> 赞同：5
> 
> 时间：2008-09-10T14:26:00.787
> 
> 标签：windows, networking

我正在寻找一个非常简单的工具来监控我所有应用程序的带宽。不需要像流量监视这样的额外功能，我只对带宽感兴趣。

我已经知道 Wireshark（这很棒），但我正在寻找的更像是具有当前带宽指示的 TcpView（来自 Sysinternals 的出色工具）。

PS：我只对 Windows 工具感兴趣

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T14:42:45.410

试试[NetLimiter](http://www.netlimiter.com/)，它非常适合，还允许您限制带宽使用，以便您可以在带宽减少的情况下测试您的应用程序。

# c++ - C++ 对 int 的读写是原子的吗？

> ID：54188
> 
> 赞同：87
> 
> 时间：2008-09-10T14:26:41.423
> 
> 标签：c++, multithreading, synchronization

我有两个线程，一个更新一个 int，一个读取它。这是一个统计值，其中读取和写入的顺序无关紧要。

我的问题是，我是否需要同步访问这个多字节值？或者，换一种说法，可以部分写入完成并被中断，然后读取发生。

例如，考虑一个值 = 0x0000FFFF，它的增量值为 0x00010000。

有没有我应该担心的值看起来像 0x0001FFFF 的时候？当然，类型越大，发生这种情况的可能性就越大。

我总是同步这些类型的访问，但很好奇社区的想法。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-09-10T14:42:36.033

男孩，什么问题。答案是：

> 是的，不，嗯，嗯，这取决于

这一切都归结为系统的架构。在 IA32 上，正确对齐的地址将是原子操作。未对齐的写入可能是原子的，它取决于使用的缓存系统。如果内存位于单个 L1 缓存行中，则它是原子的，否则不是。CPU 和 RAM 之间的总线宽度会影响原子性：8086 上正确对齐的 16 位写入是原子性的，而 8088 上的相同写入不是因为 8088 只有 8 位总线，而 8086 有16 位总线。

此外，如果您使用 C/C++，请不要忘记将共享值标记为 volatile，否则优化器会认为该变量永远不会在您的线程之一中更新。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-09-10T15:37:49.553

一开始可能会认为本机机器大小的读取和写入是原子的，但有许多问题需要处理，包括处理器/内核之间的缓存一致性。在 Windows 上使用 Interlocked* 等原子操作，在 Linux 上使用等效操作。C++0x 将有一个“原子”模板来将它们包装在一个漂亮的跨平台界面中。目前，如果您使用平台抽象层，它可能会提供这些功能。 [ACE](http://www.cse.wustl.edu/~schmidt/ACE.html)确实如此，请参阅类模板[ACE_Atomic_Op](http://www.dre.vanderbilt.edu/~schmidt/DOC_ROOT/ACE/ace/Atomic_Op.inl)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-10T14:41:34.367

如果您正在读取/写入 4 字节值并且它在内存中是 DWORD 对齐的并且您在 I32 架构上运行，那么读取和写入是原子的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-10T14:31:07.373

是的，您需要同步访问。在 C++0x 中，这将是一场数据竞争和未定义的行为。对于 POSIX 线程，它已经是未定义的行为。

在实践中，如果数据类型大于本机字长，您可能会得到错误的值。此外，由于移动读取和/或写入的优化，另一个线程可能永远不会看到写入的值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-10T14:38:01.693

您必须同步，但在某些架构上，有一些有效的方法可以做到这一点。

最好是使用子例程（可能隐藏在宏后面），以便您可以有条件地用特定于平台的实现替换实现。

Linux 内核已经有一些这样的代码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T21:46:03.877

在 Windows 上，Interlocked***Exchange***Add 保证是原子的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-11T16:07:06.307

呼应楼上大家所说的，C++0x 之前的语言不能保证任何关于多线程共享内存访问的事情。任何保证都取决于编译器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T14:30:12.913

不，它们不是（或者至少你不能假设它们是）。话虽如此，有一些技巧可以原子地执行此操作，但它们通常不可移植（请参阅[Compare-and-swap](http://en.wikipedia.org/wiki/Compare-and-swap)）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T15:00:19.533

我同意许多人的观点，尤其是[杰森](https://stackoverflow.com/questions/54188/are-c-reads-and-writes-of-an-int-atomic#54224)。在 Windows 上，可能会使用 InterlockedAdd 及其朋友。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T01:03:40.433

除了上面提到的缓存问题...

如果您将代码移植到具有较小寄存器大小的处理器，它将不再是原子的。

IMO，线程问题太棘手，不能冒险。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-31T16:39:33.913

让我们举这个例子

```
int x;
x++;
x=x+5; 
```

第一条语句被假定为原子语句，因为它转换为一个占用单个 CPU 周期的单个 INC 汇编指令。但是，第二个分配需要几个操作，所以它显然不是原子操作。

另一个例如，

```
x=5; 
```

同样，您必须反汇编代码才能看到这里到底发生了什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-19T09:22:09.967

tc，我认为当您使用常量（如 6）时，该指令不会在一个机器周期内完成。尝试查看 x+=6 与 x++ 相比的指令集

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-03-28T07:39:02.160

有些人认为 ++c 是原子的，但要注意生成的程序集。例如使用 'gcc -S' ：

```
movl    cpt.1586(%rip), %eax
addl    $1, %eax
movl    %eax, cpt.1586(%rip) 
```

为了增加一个 int，编译器首先将它加载到一个寄存器中，然后将它存储回内存中。这不是原子的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-22T09:13:50.597

绝对不！来自我们最高 C++ 权威 M. Boost 的回答：
**[不能保证对“普通”变量的操作是原子的。](http://www.boost.org/doc/libs/1_54_0/doc/html/atomic.html#atomic.introduction.introduction_purpose)**

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2010-05-09T01:47:06.663

唯一可移植的方法是为您的编译器使用在 signal.h 头文件中定义的 sig_atomic_t 类型。在大多数 C 和 C++ 实现中，这是一个 int。然后将您的变量声明为“volatile sig_atomic_t”。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-05-30T14:05:48.753

读取和写入是原子的，但您还需要担心编译器会重新排序您的代码。编译器优化可能会违反代码中语句的先发生关系。通过使用 atomic，您不必担心这一点。... 原子 i;

肥皂状态 = GOT_RESPONSE ；我 = 1

在上面的例子中，变量'i'只有在我们得到一个soap响应后才会被设置为1。

# .net - 如何使用 LinqToEntities 实现存储库模式？

> ID：54199
> 
> 赞同：2
> 
> 时间：2008-09-10T14:30:59.977
> 
> 标签：.net, .net-3.5, linq-to-entities

如何使用 LinqToEntities 实现存储库模式 如何实现接口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-11T11:44:13.007

我执行以下操作：

服务层包含我的业务对象。它通过控制反转传递到存储库（Castle Windor 是我通常的选择）。存储库负责业务对象和我的实体框架对象之间的映射。

优点：您对对象状态或 EF 对象的上下文没有任何问题，因为您只是在存储库端的数据操作期间加载它们。这在将它们传递给 WCF/Web 服务时缓解了这种情况。

缺点：您正在失去 Entity Framework 的一些跟踪功能，您必须手动加载数据对象（ef 对象），如果需要手动进行乐观并发检查（例如通过业务对象上的时间戳），则可能需要这样做。

但通常我更喜欢这种解决方案，因为以后可以更改存储库。它允许我拥有不同的存储库（例如，我的用户对象实际上使用的是 ASPNetAuthenticationRepository 而不是 EntityFrameworkRepository），但对于我的服务层来说它是透明的。

关于接口，我会使用服务层中的业务对象作为参数对象，不要让那些 EF 对象离开存储库层。希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T09:22:46.920

除了“Castle Windor”之外，我几乎喜欢这个。看看 openticket.codeplex.com

# .net - 在 web.config 中加密 appSettings

> ID：54200
> 
> 赞同：15
> 
> 时间：2008-09-10T14:31:04.657
> 
> 标签：.net, security, encryption, web-applications, appsettings

我正在开发一个网络应用程序，它需要将用户名和密码存储在 web.Config 中，它还引用了一些将由网络应用程序本身而不是客户端请求的 URL。

我知道 .Net 框架不允许提供 web.config 文件，但我仍然认为将此类信息以纯文本形式保留是不好的做法。

到目前为止，我所阅读的所有内容都要求我使用命令行开关或将值存储在服务器的注册表中。由于主机在线并且我只有 FTP 和控制面板 (helm) 访问权限，因此我无法访问这些。

任何人都可以推荐我可以使用的任何好的、免费的加密 DLL 或方法吗？我宁愿不开发自己的！

感谢到目前为止的反馈，但我无法发出命令，也无法编辑注册表。它必须是一个加密工具/助手，但只是想知道哪个！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-10T14:33:39.877

*   [MSDN 上的加密和解密配置部分](http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx)(ASP.NET)
*   在 ScottGu 的[博客上](http://weblogs.asp.net/scottgu/default.aspx)[加密 ASP.NET 2.0 中的 Web.Config 值](http://weblogs.asp.net/scottgu/archive/2006/01/09/434893.aspx)
*   K. Scott Allen[博客上的](http://odetocode.com/Blogs/scott/default.aspx)[加密自定义配置部分](http://odetocode.com/Blogs/scott/archive/2006/01/08/2707.aspx)

**编辑：**
如果您不能使用 asp 实用程序，您可以使用[SectionInformation.ProtectSection](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.protectsection.aspx)方法加密配置文件。

代码项目示例：

[ASP.Net 2.0 中 Web.config 内的连接字符串加密](https://secure.codeproject.com/KB/aspnet/webconfig.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-08T14:11:18.313

虽然乍一看似乎很简单，但我遇到了一些障碍。

因此，我使用默认加密提供程序提供了对我来说很好的步骤（加密**appSettings部分）：**

**加密**web.config 中的部分：

1.  打开管理员命令外壳（**以管理员身份运行！**）。命令提示符将在`C:`下面的步骤中假设。
    进一步假设应用程序已部署在`D:\Apps\myApp`- 将其替换为您在**步骤 3 中使用的路径。**
2.  `cd "C:\Windows\Microsoft.NET\Framework64\v4.0.30319"`, 在 32 位 Windows 系统上使用`Framework`而不是`Framework64`
3.  `cd /D "D:\Apps\myApp"`
    **注意：**如果驱动器与您当前的驱动器不同，该`/D`开关将自动更改驱动器。在这里它将更改路径和驱动器，因此当前目录将在`D:\Apps\myApp`之后。
4.  `c:aspnet_regiis -pef appConfig .`

您应该会看到以下消息：

> Microsoft (R) ASP.NET RegIIS 4.0.30319.0 管理实用程序，用于在本地计算机上安装和卸载 ASP.NET。版权所有 (C) 微软公司。版权所有。加密配置部分...成功！

您还可以**解密**web.config 中的部分：这些步骤相同，但使用选项`-pdf`而不是`-pef`aspnet_regiis。

也可以加密 web.config 的其他部分，例如，您可以通过以下方式**加密连接字符串**部分：

```
aspnet_regiis -pe "connectionStrings" -app "/SampleApplication" 
```

可以在[此处找到有关此内容的更多详细信息。](https://msdn.microsoft.com/en-us/library/ms178372.aspx)

* * *

**注意：**上述加密对您的 Web 应用程序是**透明**的，即您的 Web 应用程序无法识别设置已加密。
您还可以选择使用**非透明**加密，例如使用 Microsoft 的 DPAPI 或使用[AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)以及框架的[AES Class](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.aes?redirectedfrom=MSDN&view=netframework-4.7.2#Anchor_6)。[我在 Stackoverflow](https://stackoverflow.com/a/15342230/1016343)描述了
如何使用**DPAPI**完成它。DPAPI 的工作方式非常相似，它使用机器或用户凭证的密钥。通常，**非透明加密****为您提供更多控制权，例如您可以添加 SALT，或者您可以使用基于用户密码的密钥。如果您想了解有关如何从密码短语生成密钥的更多信息，请查看[此处](https://stackoverflow.com/a/45307604/1016343)。**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:36:56.937

使用 aspnet_setreg.exe [http://support.microsoft.com/kb/329290](http://support.microsoft.com/kb/329290)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-02T18:43:52.060

1.  发布您的项目
2.  **以管理员身份**打开开发人员命令提示符
***   使用这个命令**asp_rigiis -pef "appSettings" "C:\yourPublishPath" -prov "DataProtectionConfigurationProvider"****

 **# c# - Soap logging in .net

> ID：54207
> 
> 赞同：4
> 
> 时间：2008-09-10T14:32:19.553
> 
> 标签：c#, web-services, soap

I have an internal enterprise app that currently consumes 10 different web services. They're consumed via old style "Web References" instead of using WCF.

The problem I'm having is trying to work with the other teams in the company who are authoring the services I'm consuming. I found I needed to capture the exact SOAP messages that I'm sending and receiving. I did this by creating a new attribute that extends SoapExtensionAttribute. I then just add that attribute to the service method in the generated Reference.cs file. This works, but is painful for two reasons. First, it's a generated file so anything I do in there can be overwritten. Second, I have to remember to remove the attribute before checking in the file.

**Is There a better way to capture the exact SOAP messages that I am sending and receiving?**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T22:11:24.283

This seems to be a common question, as I just asked it and was told to look [here](https://stackoverflow.com/questions/300674/getting-raw-soap-data-from-a-web-reference-client-running-in-aspnet).

You don't have to edit the generated `Reference.cs`. You can reference the extension in your application's `app.config`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T15:09:59.883

Is this a webapp?

Place your SoapExtension code in a HTTPModule, and inject the SOAP envelope into the HTTPOutput stream.

That way, when in debug mode, I picture something like a collapsible div on the top of the page that lists all SOAP communication for that page.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T15:17:51.207

I have a HTTPModule already built that does this, I'll strip out my company specific information and post the goodies later today.

Also, check out SoapUI, its a handy tool.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:41:25.240

You can do this by creating a SoapExtention. Check [this article](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconAlteringSOAPMessageUsingSOAPExtensions.asp).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T15:04:06.730

I used the following code is an example of how I captured SOAP requests in a application written a while back.

```
<System.Diagnostics.Conditional("DEBUG")> _
    Private Sub CheckHTTPRequest(ByVal functionName As String)
        Dim e As New UTF8Encoding()

        Dim bytes As Long = Me.Context.Request.InputStream.Length
        Dim stream(bytes) As Byte
        Me.Context.Request.InputStream.Seek(0, IO.SeekOrigin.Begin)
        Me.Context.Request.InputStream.Read(stream, 0, CInt(bytes))

        Dim thishttpRequest As String = e.GetString(stream)

        My.Computer.FileSystem.WriteAllText("D:\SoapRequests\" & functionName & ".xml", thishttpRequest, False)

    End Sub 
```

Setting the conditional attribute like I did makes the compiler ignore the method call for all build types other than debug.

Sorry for the VB, it is forced upon me.

# ajax - Ajax XMLHttpRequest 对象限制

> ID：54217
> 
> 赞同：3
> 
> 时间：2008-09-10T14:34:44.103
> 
> 标签：ajax

您可以在单个页面上创建的 Ajax [XMLHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest)对象的数量是否存在安全限制？如果是这样，这是否因浏览器而异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T14:42:28.437

我不这么认为，但是每个客户端每个域最多只能同时连接两个 HTTP（您可以在 Firefox 中覆盖它，但实际上没有人这样做）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T15:11:19.147

我发现汇集和重用 XMLHTTPRequest 对象而不是创建新对象更容易......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:55:58.593

是的，正如 Kevin 所说，HTTP/1.1 规范说“单用户客户端不应与任何服务器或代理保持超过 2 个连接。”

# .net - 我应该如何处理需要存储多个不相关类型但按需提供特定类型的情况？

> ID：54219
> 
> 赞同：1
> 
> 时间：2008-09-10T14:36:26.547
> 
> 标签：.net, generics

我正在为我们使用的重要内部测试工具使用的文件开发一个编辑器。该工具本身又大又复杂，重构或重写所占用的资源比我们在可预见的未来所能投入的资源还要多，所以当涉及到大的修改时，我的双手束手无策。我必须使用 .NET 语言。

这些文件是工具使用的四个类的 XML 序列化版本（我们称它们为 A、B、C 和 D）。当一切正常时，这些类形成一个树结构。我们的编辑器通过加载一组文件、反序列化它们、计算它们之间的关系以及跟踪它可以找到的任何不良状态来工作。这个想法是让我们摆脱手动编辑这些文件，这会引入大量错误。

对于特定类型的错误，我想维护所有有问题的文件的集合。所有四个类都可能有问题，我想尽可能减少代码重复。一个重要的要求是用户需要能够获得成套的物品；例如，他们需要获取所有有错误的 A 对象，并告诉他们遍历整个集合并挑选出他们想要的东西与`GetAs()`方法相比是不可接受的。所以，我的第一个想法是制作一个与反序列化对象和一些元数据相关的通用项目以指示错误：

```
public class ErrorItem<T>
{
    public T Item { get; set; }
    public Metadata Metadata { get; set; }
} 
```

然后，我将有一个可以保存所有错误项的集合类，并使用辅助方法在用户需要时提取特定类的项。这就是麻烦开始的地方。

没有一个类继承自一个共同的祖先（除了`Object`）。这可能是最初设计的一个错误，但我花了几天时间思考它，除了唯一标识每个项目的 GUID 属性之外，这些类确实没有太多共同点，所以我可以明白为什么最初的设计师没有通过继承将它们联系起来。这意味着统一的错误集合需要存储`ErrorItem<Object>`对象，因为我没有基类或接口来限制进来的内容。但是，这让这个统一集合的想法对我来说有点粗略：

```
Public Class ErrorCollection
{
    public ErrorItem<Object> AllItems { get; set; }
} 
```

但是，这会对公共接口产生影响。我真正想要的是返回适当的`ErrorItem`泛型类型，如下所示：

```
public ErrorItem<A>[] GetA() 
```

这是不可能的，因为我只能存储`ErrorItem<Object>`！我已经在脑海中研究了一些解决方法；大多数情况下，它们包括在运行中创建一个`ErrorItem`合适类型的新的，但它只是感觉有点难看。另一个想法是使用 a`Dictionary`来按类型组织项目，但它似乎仍然不正确。

有什么模式可以帮助我吗？我知道解决这个问题的最简单方法是添加一个 A、B、C 和 D 派生自的基类，但我试图对原始工具产生尽可能小的影响。任何变通方法的成本是否足够大，以至于我应该推动更改初始工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T14:57:36.077

这是你想要的？

```
private List<ErrorItem<object>> _allObjects = new List<ErrorItem<object>>();

public IEnumerable<ErrorItem<A>> ItemsOfA
{
    get
    {
        foreach (ErrorItem<object> obj in _allObjects)
        {
            if (obj.Item is A)
                yield return new ErrorItem<A>((A)obj.Item, obj.MetaData);
        }
    }
} 
```

如果你想缓存`ItemsOfA`你可以很容易地做到这一点：

```
private List<ErrorItem<A>> _itemsOfA = null;

public IEnumerable<ErrorItem<A>> ItemsOfACached
{
    if (_itemsOfA == null)
        _itemsOfA = new List<ErrorItem<A>>(ItemsOfA);
    return _itemsOfA;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T16:48:01.240

到目前为止，我要使用的答案是来自fryguybob 和Mendelt Siebenga 的答案的组合。

正如 Mendelt Siebenga 所指出的，添加基类只会污染命名空间并引入类似的问题。我会更好地控制哪些项目可以进入收藏，但我仍然需要存储`ErrorItem<BaseClass>`并仍然进行一些铸造，所以我会遇到一个稍微不同的问题，原因是相同的。这就是我选择这篇文章作为答案的原因：它指出无论如何我都必须进行一些强制转换，而 KISS 会规定额外的基类和泛型太多了。

我喜欢fryguybob 的回答不是为了解决方案本身，而是为了提醒我关于`yield return`，这将使非缓存版本更容易编写（我打算使用LINQ）。我认为缓存版本更明智一些，尽管预期的性能参数不会使非缓存版本明显变慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:47:35.383

如果 A、B、C 和 D 没有共同点，那么添加基类不会真正为您带来任何好处。它只是一个空类，实际上与对象相同。

我只是创建一个没有泛型的 ErrorItem 类，使 Item 成为一个对象，并在您想要使用引用的对象时进行一些转换。如果您想使用除 Guid 之外的 A、B、C 或 D 类的任何属性或方法，则无论如何都必须强制转换它们。

# java - 我将如何允许用户将视频流式传输到 Web 应用程序进行存储？

> ID：54221
> 
> 赞同：1
> 
> 时间：2008-09-10T14:37:10.010
> 
> 标签：java, flash, applet, web-applications

我想为网站添加一些功能，允许用户使用他们的网络摄像头录制视频并轻松在线存储。我什至不知道现在这是否可行，但我认为 flash 可以访问通过浏览器运行的本地网络摄像头。

你有什么建议或资源让我开始做这件事吗？我主要是一名 java 开发人员，所以如果我可以在一个小程序中完成它会很棒，但使用 flash 或其他一些技术可能更容易完成。

这意味着将视频流式传输回网络服务器并将其存储在那里。上传文件很容易，但如果可能的话，我希望用户不必处理这个问题。

只是要清楚。我不是在谈论上传视频。我说的是允许用户在 Web 应用程序中单击“记录”，并在用户单击“停止”时将视频流式传输到服务器并存储。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T14:41:21.420

这可以通过[Adob​​e 的 Flash Media Server](http://www.adobe.com/products/flashmediaserver/)实现。[Red5](http://osflash.org/red5)是一个开源替代品。他们为此使用的协议是[RTMP](http://en.wikipedia.org/wiki/Real_Time_Messaging_Protocol)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T15:36:55.877

在服务器端，您有三种选择：

1.  [Adobe 的 Flash 媒体服务器](http://www.adobe.com/products/flashmediaserver/)
2.  [Red5](http://osflash.org/red5)，开源版本
3.  [Wowza Media Server Pro](http://www.wowzamedia.com/products.html)，一个商业替代品

您可以在自己的服务器上运行任何这些，也可以选择网络提供商（我发现[此列表](http://www.flashcomguru.com/articles/hosts.cfm)很有帮助）

在客户端，您需要一个用于用户界面的 flash 文件。Red5 和 Wowza 有一些带有示例记录器的源代码，因此很容易自定义这些以供您自己使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-20T16:09:40.927

除了以上选择，还可以使用haxevideo（开源）

# c# - 使用 LINQ to SQL 访问系统数据库/表？

> ID：54222
> 
> 赞同：10
> 
> 时间：2008-09-10T14:37:24.907
> 
> 标签：c#, sql-server, linq, linq-to-sql

现在我有一个每天早上运行的[SSIS](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)包，它会向我报告前一天失败或成功的包的数量。这些包的信息部分包含在[SQL Server 2005](http://en.wikipedia.org/wiki/Microsoft_SQL_Server#SQL_Server_2005)中数据库（系统数据库）内的`sysjobs`表（系统表）中。`msdb`

当尝试将包移动到 C# 可执行文件时（主要是为了更好地格式化发送出去的电子邮件），我无法找到一种方法来创建允许我通过[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)访问这些表的 dbml 文件。我试图寻找可以使这些表可见的任何属性，但我没有太多运气。

[LINQ to SQL](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_SQL_.28formerly_called_DLINQ.29)可以做到这一点吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-10T15:16:50.600

如果您在服务器资源管理器中，则可以通过以下方式使它们可见：

*   创建与所需服务器的连接。
*   右键单击服务器并选择更改视图 > 对象类型。
*   您现在应该看到系统表和用户表。您应该在那里看到 sysjobs，并且可以轻松地将其拖到 .dbml 表面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T14:40:15.213

它可能在设计器中不可用，但为什么不直接将它添加到 DBML 文件本身呢？

# c# - Asp.net 路径压缩

> ID：54227
> 
> 赞同：2
> 
> 时间：2008-09-10T14:38:33.703
> 
> 标签：c#, asp.net, path

我有一个 asp.net url 路径，它是在 web 表单中生成的，并且会出现类似“/foo/bar/../bar/path.aspx”的内容，并且也会像这样在生成的 html 中出现. 它应该缩短为“/foo/bar/path.aspx”。

Path.Combine 没有修复它。有清理这条路径的功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T14:52:42.983

您可以创建一个助手类，它在 System.Net 中包装了 UriBuilder 类

```
public static class UriHelper
{       
    public static string NormalizeRelativePath(string path)
    {
        UriBuilder _builder = new UriBuilder("http://localhost");
        builder.Path = path;
        return builder.Uri.AbsolutePath;
    }
} 
```

然后可以这样使用：

```
string url = "foo/bar/../bar/path.aspx";
Console.WriteLine(UriHelper.NormalizeRelativePath(url)); 
```

这有点hacky，但它适用于您给出的具体示例。

**编辑：更新以反映安德鲁的评论。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T15:01:22.167

无论您做什么，都不要使用静态 UriBuilder。这引入了各种潜在的竞争条件，直到您处于重负载下才能检测到。

如果两个不同的线程同时调用 UriHelper.NormalizeRelativePath，则一个线程的返回值可以任意传回另一个调用者。

如果您想使用 UriBuilder 来执行此操作，只需在需要时创建一个新的（创建成本不高）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T14:59:24.277

Sarcastic 的回复比我的要好得多，但是如果您使用的是文件系统路径，那么我**在下面的丑陋的 hack**可能也很有用。（翻译：我打的，不贴我就完蛋了：）

Path.Combine 只是将两个字符串拼接在一起，注意前导或尾随斜杠。据我所知，唯一进行标准化的 Path 方法是 Path.GetFullPath。以下将为您提供“清理”版本。

```
myPath = System.IO.Path.GetFullPath(myPath); 
```

当然，有一个小问题是生成的路径将被植根并且正斜杠将被转换为反斜杠（如“C:\foo\bar\path.aspx”）。但是如果您知道原始路径的父根，那么剥离根应该不是什么大问题。

# php - CakePHP ACL 数据库设置：ARO / ACO 结构？

> ID：54230
> 
> 赞同：21
> 
> 时间：2008-09-10T14:39:38.147
> 
> 标签：php, cakephp, permissions, acl, security-roles

我正在努力在 CakePHP 中实现 ACL。在阅读了[cake 手册](http://manual.cakephp.org/view/171/Access-Control-Lists)中的文档以及其他一些教程、博客文章等之后，我发现 Aran Johnson 的优秀教程帮助填补了许多空白。他的例子似乎与我在一些地方看到的其他例子发生冲突——特别是在他使用的 ARO 树结构中。

在他的[示例](http://aranworld.com/article/169/acl-and-auth-tutorial-database-setup)中，他的用户组被设置为级联树，最通用的用户类型位于树的顶部，其子级为每个更受限制的访问类型分支。在其他地方，我通常将每个用户类型视为相同通用用户类型的子级。

如何在 CakePHP 中设置 ARO 和 ACO？任何和所有提示表示赞赏！

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-11T13:36:18.010

CakePHP 的内置 ACL 系统非常强大，但在实际实现细节方面的文档却很少。我们在许多基于 CakePHP 的项目中成功使用的系统如下所示。

[这是对其他地方记录](http://realm3.com/articles/setting_up_user_groups_with_acl_and_auth_in_cakephp_1.2)的一些组级访问系统的修改。我们系统的目标是建立一个简单的系统，用户在组级别上获得授权，但他们可以对他们创建的项目或每个用户拥有特定的附加权限。我们希望避免必须为表中的每个用户（或者，更具体地说，为每个 ARO）创建一个特定条目`aros_acos`。

我们有一个用户表和一个角色表。

**用户**

`user_id, user_name, role_id`

**角色**

`id, role_name`

为每个角色创建 ARO 树（我们通常有 4 个角色 - 未经授权的访客（id 1）、授权用户（id 2）、站点管理员（id 3）和管理员（id 4））：

`cake acl create aro / Role.1`

`cake acl create aro 1 Role.2 ... etc ...`

在此之后，您必须使用 SQL 或 phpMyAdmin 或类似工具为所有这些添加别名，因为 cake 命令行工具不会这样做。我们为所有人使用“角色-{id}”和“用户-{id}”。

然后我们创建一个 ROOT ACO -

`cake acl create aco / 'ROOT'`

然后为该 ROOT 下的所有控制器创建 ACO：

`cake acl create aco 'ROOT' 'MyController' ... etc ...`

到目前为止一切正常。我们在名为 aros_acos 的表中添加了一个附加字段`_editown` ，我们可以将其用作 ACL 组件的 actionMap 中的附加操作。

```
CREATE TABLE IF NOT EXISTS `aros_acos` (
`id` int(11) NOT NULL auto_increment,
`aro_id` int(11) default NULL,
`aco_id` int(11) default NULL,
`_create` int(11) NOT NULL default '0',
`_read` int(11) NOT NULL default '0',
`_update` int(11) NOT NULL default '0',
`_delete` int(11) NOT NULL default '0',
`_editown` int(11) NOT NULL default '0',
PRIMARY KEY  (`id`),
KEY `acl` (`aro_id`,`aco_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8; 
```

然后，我们可以设置 Auth 组件以使用“crud”方法，该方法根据 AclComponent::check() 验证请求的控制器/操作。在 app_controller 我们有一些类似的东西：

```
private function setupAuth() {
    if(isset($this->Auth)) {
        ....
        $this->Auth->authorize = 'crud';
        $this->Auth->actionMap = array( 'index'     => 'read',
                        'add'       => 'create',
                        'edit'      => 'update'
                        'editMine'  => 'editown',
                        'view'      => 'read'
                        ... etc ...
                        );
        ... etc ...
    }
} 
```

同样，这是相当标准的 CakePHP 东西。然后我们在 AppController 中有一个 checkAccess 方法，它添加了组级别的东西来检查是检查组 ARO 还是用户 ARO 的访问权限：

```
private function checkAccess() {
    if(!$user = $this->Auth->user()) {
        $role_alias = 'Role-1';
        $user_alias = null;
    } else {
        $role_alias = 'Role-' . $user['User']['role_id'];
        $user_alias = 'User-' . $user['User']['id'];
    }

    // do we have an aro for this user?
    if($user_alias && ($user_aro = $this->User->Aro->findByAlias($user_alias))) {
        $aro_alias = $user_alias;
    } else {
        $aro_alias = $role_alias;
    }

    if ('editown' == $this->Auth->actionMap[$this->action]) {
        if($this->Acl->check($aro_alias, $this->name, 'editown') and $this->isMine()) {
            $this->Auth->allow();
        } else {
            $this->Auth->authorize = 'controller';
            $this->Auth->deny('*');
        }
    } else {
        // check this user-level aro for access
        if($this->Acl->check($aro_alias, $this->name, $this->Auth->actionMap[$this->action])) {
            $this->Auth->allow();
        } else {
            $this->Auth->authorize = 'controller';
            $this->Auth->deny('*');
        }
    }
} 
```

和方法在's ) 回调`setupAuth()`中调用。AppControler 中也有一个方法（见下文），它只检查所请求项目的 user_id 是否与当前经过身份验证的用户相同。为了清楚起见，我将其省略了。`checkAccess()``AppController``beforeFilter(``isMine`

这就是它的全部。然后，您可以允许/拒绝特定组访问特定 acos -

`cake acl grant 'Role-2' 'MyController' 'read'`

`cake acl grant 'Role-2' 'MyController' 'editown'`

`cake acl deny 'Role-2' 'MyController' 'update'`

`cake acl deny 'Role-2' 'MyController' 'delete'`

我相信你明白了。

无论如何，这个答案比我预期的要长得多，而且它可能几乎没有意义，但我希望它对你有所帮助......

- 编辑 -

`isMine()`根据要求，这是我们在 AppController 中的一个已编辑（纯粹是为了清楚起见 - 我们的样板代码中有很多东西在这里毫无意义）的方法。我也删除了很多错误检查的东西，但这是它的本质：

```
function isMine($model=null, $id=null, $usermodel='User', $foreignkey='user_id') {
    if(empty($model)) {
        // default model is first item in $this->uses array
        $model = $this->uses[0];
    }

    if(empty($id)) {
        if(!empty($this->passedArgs['id'])) {
        $id = $this->passedArgs['id'];
        } elseif(!empty($this->passedArgs[0])) {
            $id = $this->passedArgs[0];
        }
    }

    if(is_array($id)) {
        foreach($id as $i) {
            if(!$this->_isMine($model, $i, $usermodel, $foreignkey)) {
                return false;
            }
        }

        return true;
    }

    return $this->_isMine($model, $id, $usermodel, $foreignkey);
}

function _isMine($model, $id, $usermodel='User', $foreignkey='user_id') {
    $user = Configure::read('curr.loggedinuser'); // this is set in the UsersController on successful login

    if(isset($this->$model)) {
        $model = $this->$model;
    } else {
        $model = ClassRegistry::init($model);
    }

    //read model
    if(!($record = $model->read(null, $id))) {
        return false;
    }

    //get foreign key
    if($usermodel == $model->alias) {
        if($record[$model->alias][$model->primaryKey] == $user['User']['id']) {
            return true;
        }
    } elseif($record[$model->alias][$foreignkey] == $user['User']['id']) {
        return true;
    }

    return false;
} 
```

# javascript - 有没有办法突出书签的目标？（www.site.com/page.htm#bookmark）？

> ID：54237
> 
> 赞同：4
> 
> 时间：2008-09-10T14:41:43.697
> 
> 标签：javascript, jquery, css

我想链接到页面上的书签 (mysite.com/mypage.htm#bookmark) 并在视觉上突出显示已添加书签的项目（可能有红色边框）。自然地，会有多个项目被添加书签。因此，如果有人单击#bookmark2，则*该*其他区域将突出显示）。

我可以看到如何使用 .asp 或 .aspx 来做到这一点，但我想做的比这更简单。我想也许有一个聪明的方法可以用 CSS 做到这一点。

为什么我感兴趣： - 我想让我们的程序链接到列出所有程序的购物页面。我正在使用书签，因此他们会跳转到特定的程序区域（site.com/shoppingpage#Programx），但为了清楚起见，*我*想实际突出显示链接到的页面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T15:09:37.967

在您的CSS中，您需要定义

```
a.highlight {border:1px solid red;} 
```

或类似的东西

然后使用jQuery，

```
$(document).ready ( function () { //Work as soon as the DOM is ready for parsing
    var id  = location.hash.substr(1); //Get the word after the hash from the url
    if (id) $('#'+id).addClass('highlight'); // add class highlight to element whose id is the word after the hash
}); 
```

要突出显示鼠标悬停的目标，还要添加：

```
$("a[href^='#']")
    .mouseover(function() {
        var id  = $(this).attr('href').substr(1);
        $('#'+id).addClass('highlight');
    })
    .mouseout(function() {
        var id  = $(this).attr('href').substr(1);
        $('#'+id).removeClass('highlight');
    }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-11T00:05:47.833

您还可以`target`在 CSS 中使用伪类：

```
<html>
<head>

<style type="text/css">
div#test:target {
 background-color: yellow;
}
</style>

</head>
<body>

<p><b><a href="#test">Link</a></b></p>

<div id="test">
Target
</div>

</body>
</html> 
```

不幸的是，IE 或 Opera 不支持目标伪类，因此如果您在这里寻找通用解决方案，这可能还不够。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T14:54:21.153

使用您最喜欢的 JS 工具包向包含（或包含在）锚点的项目添加“突出显示”（或其他）类。

就像是：

```
jQuery(location.hash).addClass('highlight'); 
```

当然，如果您希望它由页面上的其他链接触发，您需要调用它 onready 或单击，并且您需要定义 .highlight 类。您还可以根据要突出显示的容器使 jQuery 选择器向上或向下遍历。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T14:47:29.643

我想您是否可以使用 JavaScript 和 cookie 存储这些信息以实现记住书签的功能，如果您想与数据库交互，甚至可以添加一点 Ajax。

CSS 只能做样式。您必须为带有书签的锚点提供一个在您的 CSS 文件中找到的类。

CSS 还具有 a:visited 选择器，用于对浏览器历史记录中的链接进行样式设置。

# vim - 在 Vim 中有没有办法在不将文本放入寄存器的情况下删除？

> ID：54255
> 
> 赞同：513
> 
> 时间：2008-09-10T14:46:35.277
> 
> 标签：vim, replace, vim-registers

使用 Vim，我经常想用我刚刚拉出的代码块替换代码块。

但是，当我删除要替换的代码块时，该块本身会进入寄存器，从而擦除我刚刚拉出的块。所以我养成了拉动，然后插入，然后删除我不想要的东西的习惯，但是对于大块代码，试图将插入的块和要删除的块分开会变得很混乱。

那么在 Vim 中替换文本最灵巧、最快捷的方法是什么？

*   有没有办法删除文本而不将其放入寄存器？
*   有没有办法说，例如“替换下一个单词”或“替换到下一段”
*   还是以某种方式使用多寄存器功能的最佳方法？

* * *

## 回答 #1

> 赞同：458
> 
> 时间：2008-09-10T15:36:42.830

要删除某些内容而不将其保存在寄存器中，您可以使用“黑洞寄存器”：

```
"_d 
```

当然，您也可以使用任何其他不包含您感兴趣的任何内容的寄存器。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2008-09-12T10:36:24.753

是的。它比首先删除“旧”文本稍微复杂一些，但是：

我从..

```
line1
line2
line3
line4

old1
old2
old3
old4 
```

I `shift`+`v`选中第1行、第2行、第3行和第4行，用`d`命令删除

然后我以同样的方式删除旧的 1-4 行。

然后做

```
"2p 
```

这将粘贴倒数第二行（第 1-4 行）。`"3p`将做倒数第三个，依此类推..

所以我最终得到

```
line1
line2
line3
line4 
```

**参考：** [编号寄存器上的 Vim 文档](http://vimdoc.sourceforge.net/htmldoc/change.html#quote_number)

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2009-02-04T00:07:33.200

VIM 文档：*编号寄存器 0 包含来自最近的 yank 命令的文本，除非该命令用 ["x] 指定了另一个寄存器。*

例如，我们拉出“foo”并删除“bar”——注册表 0 仍然包含“foo”！因此“foo”可以粘贴使用`"0p`

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2009-05-28T10:11:00.133

有一个简单的映射很方便，它可以让你用缓冲区替换当前的选择。

例如当你把它放在你的 .vimrc

```
" it's a capital 'p' at the end
vmap r "_dP 
```

然后，在将某些内容复制到寄存器后（即使用“y”），您只需选择要替换的文本，然后在键盘上按“r”即可。选择将替换为您当前的寄存器。

解释：

```
vmap - mapping for visual mode
"_d - delete current selection into "black hole register"
P - paste 
```

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2009-08-17T20:27:40.030

我将以下内容放入我的 vimrc 中：

```
noremap  y "*y
noremap  Y "*Y
noremap  p "*p
noremap  P "*P
vnoremap y "*y
vnoremap Y "*Y
vnoremap p "*p
vnoremap P "*P 
```

现在我从剪贴板寄存器中拉出和放入，不必关心默认寄存器会发生什么。另一个好处是我可以轻松地从其他应用程序粘贴。我知道我失去了一些功能（我不再能够为剪贴板寄存器和默认寄存器管理不同的复制信息），但无论如何我都无法跟踪多个寄存器/剪贴板。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2015-10-05T17:16:41.303

默认情况下，所有 yank 和 delete 操作都会写入未命名的寄存器。但是，最近的 yank 和最近的删除总是（单独）存储在编号的寄存器中。寄存器`0`保存最新的 yank。寄存器`1-9`保存 9 个最近的删除（`1`最近的）。

换句话说，**删除会覆盖未命名寄存器中最近的 yank，但它仍然存在于`0`寄存器中。**其他答案中提到的黑洞寄存器技巧（`"_dd`）有效，因为它可以防止覆盖未命名的寄存器，但这不是必需的。

您使用双引号引用寄存器，因此可以像这样粘贴最近提取的文本：

```
"0p 
```

这是一个很好的参考：

*   [http://blog.sanctum.geek.nz/advanced-vim-registers/](http://blog.sanctum.geek.nz/advanced-vim-registers/)

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2008-09-10T14:52:33.890

对于您给出的具体示例，如果我理解这个问题，那么这可能会起作用：

```
*Highlight what you want to put somewhere else
*delete (d)
*Highlight the code that you want it to replace
*paste (p) 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2010-04-01T01:45:02.013

强调[EBGreen 所说](https://stackoverflow.com/questions/54255/in-vim-is-there-a-way-to-delete-without-putting-text-in-the-register/54272#54272)的：

如果在选择文本时粘贴，则所选文本将**替换**为粘贴的文本。

如果要复制一些文本，然后将其粘贴到多个位置，请使用`"0p`粘贴。编号寄存器 0 包含来自最近的 yank 命令的文本。

* * *

此外，您可以列出所有寄存器的内容：

```
:registers 
```

[在执行类似dbr's answer 之](https://stackoverflow.com/questions/54255/in-vim-is-there-a-way-to-delete-without-putting-text-in-the-register/58637#58637)类的操作时，该命令可以更轻松地确定您想要的寄存器。您还将看到 /,%,# 寄存器。（另见`:help registers`）

* * *

最后，检查`cW`并`cW`更改包含和不包含尾随空格的单词。（使用大写`W`包括标点符号。）

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-10T15:34:03.757

如果您使用的是 Vim，那么您将拥有可视模式，就像选择一样，但分离模式是 vi/vim 的基础。

您要做的是使用可视模式选择源，然后拉动，然后再次使用可视模式选择目标范围，然后从默认缓冲区粘贴到文本。

例子：

在一个文本文件中：

```
1| qwer
2| 自卫队
3| zxcv
4| 呸呸呸

```

使用以下顺序：`ggVjyGVkp`您将以以下方式结束：

```
1| qwer
2| 自卫队
3| qwr
4| 自卫队

```

解释：

*   `gg`: 转到第一行
*   `V`：以整行启动视觉模式
*   `j`：向下一行（选择从前一行开始，这会使选择向下一行）
*   `y`: 拉到默认缓冲区（两条选定的行，它会自动退出可视模式）
*   `G`: 转到最后一行
*   `V`: 启动视觉模式（和之前一样）
*   `k`: 上一行（和以前一样，启用可视模式，这会将选择增加一行）
*   `p`：粘贴（在最后两行上进行选择，它将用缓冲区中的任何内容替换这些行——在这种情况下是前两行）

这有点不方便将最后一个块放在缓冲区上，所以它在某种程度上不希望重复粘贴相同的东西，所以你需要将源保存到一个命名缓冲区，比如`"ay`（到一个名为“a ") 并粘贴类似的东西`"ap`（但是如果你正在编程，你可能不想粘贴几次，而是创建一个函数并调用它，对吧？对吗**？**）。

如果你只使用vi，那么你将不得不使用隐形标记而不是视觉模式，`:he mark`关于这一点，我很抱歉，但我对这个隐形标记不是很好，我被视觉模式污染了。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-09-12T10:15:57.017

对于“替换单词”，请`cw`在正常模式下尝试。

`cap`对于“替换段落”，请在正常模式下尝试。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2015-09-09T20:44:35.703

**针对懒人的微创解决方案：**

寄存器`0`总是包含最后一个 yank（正如[Rafael](/questions/54255/in-vim-is-there-a-way-to-delete-without-putting-text-in-the-register#comment-6335532)、[alex2k8](/questions/54255/in-vim-is-there-a-way-to-delete-without-putting-text-in-the-register#answer-509557)和[idbrii](/questions/54255/in-vim-is-there-a-way-to-delete-without-putting-text-in-the-register#answer-2557670)已经提到的）。不幸的是`0`，一直选择注册会很烦人，所以如果默认`p`使用会很好`"0`。这可以通过将以下几行放入您的 中来实现`.vimrc`：

```
noremap p "0p
noremap P "0P
for s:i in ['"','*','+','-','.',':','%','/','=','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z']
    execute 'noremap "'.s:i.'p "'.s:i.'p'
    execute 'noremap "'.s:i.'P "'.s:i.'P'
endfor 
```

第一行将每个`p`笔划映射到`"0p`. 但是，这会阻止`p`访问任何其他寄存器。因此`p`，具有显式选择寄存器的所有笔划都映射到 for 循环内的等效命令行表达式。对`P`.

这种方式保留了标准行为，除了隐式`p`和`P`笔画，它们现在`0`默认使用寄存器。

**提示 1：** cut 命令现在`"0d`不再只是`d`. 但是由于我很懒，这对我来说太长了；）因此我使用了以下映射：

```
noremap <LEADER>d "0d
noremap <LEADER>D "0D 
```

前导键是默认设置的，因此您可以通过键入或`\`轻松剪切文本。`\d``\D`

**提示 2：**多键映射的默认超时时间非常短。您可能希望增加它以在选择寄存器时有更多时间。有关详细信息，请参阅`:help timeoutlen`，我正在使用：

```
set timeout timeoutlen=3000 ttimeoutlen=100 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-09-10T14:49:56.483

好吧，首先执行以下命令：

```
:h d 
```

然后你会意识到你可以删除到一个特定的寄存器。这样您就不会更改默认寄存器中的内容。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-12-20T16:56:32.540

我的情况：在`Normal`模式下，当我使用`x`按键删除字符时，这些删除会覆盖我最新的寄存器——使我想删除字符的编辑复杂化，`x`并粘贴我最近的寄存器中的内容（例如，在两个或两个位置粘贴相同的文本）更多的地方）。

我尝试了已接受答案 ( `"_d`) 中的建议，但没有奏效。

但是，从[https://vi.stackexchange.com/questions/122/performing-certain-operations-without-clearing-register](https://vi.stackexchange.com/questions/122/performing-certain-operations-without-clearing-register)上接受的答案/评论中，我将此添加到 my`~/.vimrc`中，它有效（您可能必须重新启动 Vim ):

```
nnoremap x "_x 
```

也就是说，我现在可以执行正常的 yank ( `y`)、delete ( `d`) 和 paste ( `p`) 命令——我删除使用的字符`x`不再填充最新的寄存器。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2020-02-07T19:19:00.837

Vim 偶尔偏爱复杂性而不是实用性，这给用户带来了应用寄存器来复制/删除操作的负担——通常情况下，人们只想粘贴复制的内容并“忘记”删除的内容。

但是，与其与 vim 的复杂寄存器作斗争，不如让它们更方便：选择一个“默认”寄存器来存储您最近的删除。例如，将删除发送到 d 寄存器（让 ac 打开以供临时使用；d 是一个很好的助记符）：

```
nnoremap d "dd           "send latest delete to d register
nnoremap D "dD           "send latest delete to d register 
nnoremap dd "ddd         "send latest delete to d register
nnoremap x "_x           "send char deletes to black hole, not worth saving
nnoremap <leader>p "dp   "paste what was deleted
nnoremap <leader>P "dP   "paste what was deleted 
```

这种方法可以防止删除破坏 yanks 但不会放弃注册删除 - 可以粘贴（返回）已删除的内容，而不是将其丢失在黑洞中（如已接受的答案中所示）。在上面的示例中，这种召回是通过两个领导者 p 映射完成的。这种方法的一个好处是，它使您能够选择要粘贴的内容：(a) 刚刚拉出的内容，或 (b) 刚刚删除的内容。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-09-11T10:05:01.373

在插入模式下删除的文本不会进入默认寄存器。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-03-20T19:04:34.963

我在正确的上下文中使用的两种解决方案是：

*   使用 Vims 模式突出显示要替换`VISUAL`的内容，然后粘贴寄存器。

我使用这个主要是出于习惯，因为我很久以后才找到第二个解决方案，例如

```
yiw   " yank the whole word
viwp  " replace any word with the default register 
```

*   [扬克环](http://www.vim.org/scripts/script.php?script_id=1234)。使用此插件，您可以使用键绑定`<ctrl>+<p>`将先前编号的寄存器替换为您刚刚粘贴的寄存器。

基本上你可以随意粘贴，但是当你意识到你已经覆盖了默认寄存器从而丢失了你真正想要粘贴的内容时，你可以`<C-P>`从 YankRing 历史记录中查找和替换！

其中之一必须有插件...

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-02-25T18:04:00.800

我为您的目的找到了一个非常有用的映射：

```
xnoremap p "_dP 
```

删除的文本被放入“黑洞寄存器”，而被抽出的文本仍然存在。

来源：http: [//vim.wikia.com/wiki/Replace_a_word_with_yanked_text](http://vim.wikia.com/wiki/Replace_a_word_with_yanked_text)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-15T13:41:05.377

在windows 版本中（也可能在Linux 中），您可以使用`"*y`（即在您的yank 命令前加上双引号和星号）来拉入系统的复制/粘贴缓冲区。

然后，您可以正常删除可替换行并使用 粘贴复制的文本`"*p`。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-10-12T17:23:41.900

我经常犯错误，当我按照命令 'y'ank 然后 '"_d'elete into a black hole 然后 'p'aste 0 寄存器，这是最后复制的文本被推送到的地方。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-12-16T11:46:37.127

对于 Dvorak 用户，一种非常方便的方法是将不需要的文本删除到“1 寄存器而不是”_黑洞寄存器，如果只是因为您可以使用相同的 shift 按和快速的小指动作按“+1”，因为 1 是Dvorak 中 " 正上方的键（另一方面，加号 d 使整个命令快得不得了）。

当然，“1 寄存器可以用于其他用途，因为它很方便，但除非你有比替换文本更常见的目的，否则我会说这是一个很好的寄存器用途。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2018-10-21T08:13:52.240

对于 emacs-evil 用户，`(evil-paste-pop)`可以在粘贴后触发该功能，并循环遍历 kill-ring 中的先前条目。假设您将其绑定到`<C-p>`（Spacemacs 中的默认设置），您将根据需要`p`依次点击`<C-p>`。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2019-09-20T10:30:34.913

对于那些将 JetBrans IDE（PhpStorm、WebStorm、IntelliJ IDEA）与 IdeaVim 一起使用的人。您可能在重新映射`nnoremap d "_d`和使用它删除一行时遇到问题`dd`。可能的解决方案：`nnoremap dd "_dd`

youtrack 上有问题，请投票给他们： [https ://youtrack.jetbrains.com/issue/VIM-1189](https://youtrack.jetbrains.com/issue/VIM-1189) [https://youtrack.jetbrains.com/issue/VIM-1363](https://youtrack.jetbrains.com/issue/VIM-1363)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-05-19T10:09:15.243

对于那些对通过虚拟选择和粘贴替换文本时不覆盖未命名寄存器感兴趣的人。

您可以使用以下简单且最适合我的解决方案：

`xnoremap <expr> p 'pgv"'.v:register.'y'`

它来自这里的答案（和评论）： [如何粘贴而不覆盖寄存器](https://stackoverflow.com/questions/290465/how-to-paste-over-without-overwriting-register)

它首先通过选择，然后再次选择带有新文本的选择（gv）。现在是最后在可视模式下使用的寄存器（通常是未命名的寄存器，但如果您使用另一个寄存器进行粘贴，也可以无副作用）。然后再次将新值拉到寄存器中。

PS：如果您需要一个更简单的变体，它也可以与 intellj idea 插件 vim-simulation 一起使用，您可以使用这个（缺点：即使给出另一个寄存器用于粘贴，也会覆盖未命名的寄存器）：

`vnoremap p pgvy`

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2020-05-23T16:21:40.017

寄存器 0 到 9 是您拉动或剪切的最新内容等，并且不包括已删除的内容等。因此，如果您拉动/剪切某些内容，它也在寄存器 0 中，即使您在那之后整天都说删除的东西，请注册 0仍然是你拉/切的最后一个东西。

yiw #进入默认寄存器和寄存器0

# 它拉动光标所在的单词

# 删除的东西等将进入默认寄存器，但不会注册 0

# 在标准模式下：

"0p #放寄存器0的内容

# 在插入模式下：

ctrl-r 0 #放入寄存器0的内容

我还有一个朋友总是拉/切注册 x 大声笑。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-07-17T10:21:21.973

下面的 vscode 设置应该允许例如 dd 和 dw 变成 "_dd 和 "_dw，它们现在可以在我们的重映射器中正常工作。

```
{
     "vim.normalModeKeyBindingsNonRecursive": [
        {
            "before": ["d"],
            "after": [ "\"", "_", "d" ]
        }
    ]
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-10-25T21:41:32.723

您可以使用以下命令制作一个简单的宏： `q"_dwq`

现在要删除下一个单词而不覆盖寄存器，您可以使用`@d`

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-11-02T07:00:11.757

主要问题是`p`在可视模式下使用。在您以可视模式粘贴内容后，以下功能将恢复未命名寄存器的内容。

```
 function! MyPaste(ex)
  let save_reg = @"
  let reg = v:register
  let l:count = v:count1
  let save_map = maparg('_', 'v', 0, 1)
  exec 'vnoremap _ '.a:ex
  exec 'normal gv"'.reg.l:count.'_'
  call mapset('v', 0, save_map)
  let @" = save_reg
endfunction

vmap p :<c-u>call MyPaste('p')<cr>
vmap P :<c-u>call MyPaste('P')<cr> 
```

用法和以前一样，寄存器"的内容没有改变。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-01-19T03:52:14.750

我发现一开始就拉入“p”缓冲区更容易。

### 复制（又名：猛拉）

```
# highlight text you want to copy, then:
"py 
```

### 粘贴

```
# delete or highlight the text you want to replace, then:
"pp 
```

优点（与删除到特定寄存器相反）：

*   `"pp`很容易用手指
*   不会在删除时意外覆盖您的粘贴缓冲区。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-04-02T23:23:51.437

`noremap mm m`

和

`noremap mx "_x`

这就是我的处理方式。

# refactoring - 跟踪 Bug 数据库中的重构

> ID：54264
> 
> 赞同：5
> 
> 时间：2008-09-10T14:49:45.237
> 
> 标签：refactoring, bug-tracking

假设您在某个地方工作，对源代码的每次更改都必须与错误报告或功能请求相关联，并且无法改革该政策。在这样的环境中，处理代码重构（即改进代码但不修复错误或添加功能的更改）的最佳方法是什么？

*   编写错误报告并将重构与它相关联。
*   编写一个功能请求并将重构与它相关联。
*   在处理与错误报告/功能请求相关的代码时潜入重构。
*   只是不要进行任何重构。
*   其他

请注意，所有错误报告和功能描述都将对经理和客户可见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T14:53:43.480

我投票赞成“重构潜入”方法，我相信，重构首先就是要完成的。仅仅为了“清理代码”而进行重构可能是个坏主意。这意味着您在没有真正原因的情况下进行更改。重构，顾名思义，就是在不修复错误或添加特性的情况下进行修改。如果您遵循 KISS 原则，那么任何新功能都需要至少进行一些重构，因为您并没有真正考虑如何在第一次就使最可扩展的系统成为可能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T14:56:08.497

我们的工作方式是：重构代码必须有充分的理由，否则为什么呢？

如果原因是允许其他功能使用相同的代码，请将更改与其他功能的请求相关联。

如果是为了让某些东西变得更快，请创建一个更快的“xyz”功能请求并将更改与之相关联——然后客户就会看到你正在改进产品。

如果要设计一个错误，请记录该错误。

值得注意的是，在我的环境中，该策略无法强制执行。但是聪明的管理者可以获得更改报告，如果他们在提交文本中没有错误\请求引用，则会跟进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T15:09:32.507

如果您正在处理代码块，在大多数情况下，这是因为存在需要更改该代码块的错误修复或新功能，并且重构是在更改之前以使其更容易，或者更改后整理结果。无论哪种情况，您都可以将重构与该错误修复或功能相关联。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T14:59:37.163

让我们看看每个选项：

*   编写错误报告并将重构与它相关联。

如果您认为，在您看来，原始代码会带来安全风险或崩溃或不稳定的可能性。写一个小错误报告，概述危险，然后修复它。

*   编写一个功能请求并将重构与它相关联。

根据功能请求来反应代码可能更难。但是您可以使用有效的功能请求来执行此操作，这会引导我进入下一点......

*   在处理与错误报告/功能请求相关的代码时潜入重构。

如果存在有效的错误或功能，请说明必须稍微更改功能 x 才能修复错误或添加功能。

*   只是不要进行任何重构。

这似乎表明不允许通过改进应用程序进行自我开发。应允许开发人员（如果不允许）鼓励探索新技术和新技术。

*   其他

或许你可以在相关会议上讨论你的改进，给出令人信服的理由说明为什么要做出改变。然后，至少您将获得管理层对更改的支持，而不必通过另一种方法潜入代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T16:05:41.450

*   其他

如果你在一个有那种僵化（和荒谬）政策的地方工作，最好的解决办法就是找另一份工作！

# architecture - 您使用什么来创建网站架构？

> ID：54277
> 
> 赞同：0
> 
> 时间：2008-09-10T14:54:21.013
> 
> 标签：architecture, project-planning

当然，我们可以使用简单的项目符号列表或思维导图。但是，必须有一种更好、更具交互性的方式。你在开始你的网站架构时使用什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T15:04:17.167

从物理和逻辑架构的角度来看，没有什么比白板更好的了，在盒子中绘制应用程序的层/层。然后使用 Visio 创建电子副本。

之后，迭代地深入每一层并使用适当的工具和技术进行设计。以下是我常用的：

1.  数据库：ERD
2.  业务对象（和服务契约）：UML 类图
3.  UI：原型和线框图
4.  工作流和异步操作：流程图和序列图

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T15:13:55.007

我喜欢用笔和纸勾勒出一个设计。严重地。没有电脑。布局主屏幕，包括导航栏。从这里开始，考虑您希望第 2 层和第 3 层页面的外观。

我发现这种将事情写在纸上的过程确实有助于我思考我想从网站中得到什么。尝试为一些屏幕提供模板。然后创建您想要包含的内容的大纲。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T15:48:40.790

纸质原型宝贝 - 白板上的便利贴（这样您就可以移动它们并保持关系流畅，而无需自己修改页面创意）。当然，一旦你深入了解了界面设计的本质，“放大”每个便利贴，并用它们来代表单个元素。适合可用性测试、避免代码重复、结构清晰……几乎所有东西。另外它很便宜而且非常非常快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T14:56:34.830

“架构”是指最初的站点地图吗？如果没有，请发表澄清，我将编辑我的回复。

我们的技术团队在我们的创意部门完成他们的工作后开始开发。我们得到的一部分是信息架构师的输出。他传递了一个图形站点地图、一个作为 Excel 表格的详细站点地图以及一组 PDF 中的线框。

# java - 如何使用排序键将 java.util.Properties 写入 XML？

> ID：54295
> 
> 赞同：13
> 
> 时间：2008-09-10T15:00:48.550
> 
> 标签：java, xml

我想将属性文件存储为 XML。这样做时有没有办法对键进行排序，以便生成的 XML 文件按字母顺序排列？

```
String propFile = "/path/to/file";
Properties props = new Properties();
/*set some properties here*/
try {
    FileOutputStream xmlStream = new FileOutputStream(propFile);
    /*this comes out unsorted*/
    props.storeToXML(xmlStream,"");
} catch (IOException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-10T15:41:34.020

这是一种快速而肮脏的方法：

```
String propFile = "/path/to/file";
Properties props = new Properties();

/* Set some properties here */

Properties tmp = new Properties() {
  @Override
  public Set<Object> keySet() {
    return Collections.unmodifiableSet(new TreeSet<Object>(super.keySet()));
  }
};

tmp.putAll(props);

try {
    FileOutputStream xmlStream = new FileOutputStream(propFile);
    /* This comes out SORTED! */
    tmp.storeToXML(xmlStream,"");
} catch (IOException e) {
    e.printStackTrace();
} 
```

以下是注意事项：

*   tmp 属性（匿名子类）不履行属性的合同。

例如，如果你得到它`keySet`并试图从中删除一个元素，则会引发异常。所以，不要让这个子类的实例逃跑！在上面的代码片段中，你永远不会将它传递给另一个对象或将它返回给一个有合法期望它履行属性合同的调用者，所以它是安全的。

*   Properties.storeToXML 的实现可能会发生变化，导致它忽略 keySet 方法。

例如，未来的版本或 OpenJDK 可以使用`keys()`方法 of`Hashtable`而不是`keySet`. 这就是为什么类应该总是记录它们的“自用”（有效的 Java 条款 15）的原因之一。但是，在这种情况下，最糟糕的情况是您的输出将恢复为未排序的。

*   请记住，属性存储方法会忽略任何“默认”条目。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-07-15T06:42:49.047

这是一种为 store`Properties.store(OutputStream out, String comments)`和生成排序输出的方法`Properties.storeToXML(OutputStream os, String comment)`：

```
Properties props = new Properties() {
    @Override
    public Set<Object> keySet(){
        return Collections.unmodifiableSet(new TreeSet<Object>(super.keySet()));
    }

    @Override
    public synchronized Enumeration<Object> keys() {
        return Collections.enumeration(new TreeSet<Object>(super.keySet()));
    }
};
props.put("B", "Should come second");
props.put("A", "Should come first");
props.storeToXML(new FileOutputStream(new File("sortedProps.xml")), null);
props.store(new FileOutputStream(new File("sortedProps.properties")), null); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T15:28:06.470

最简单的 hack 是覆盖 keySet。有点hack，并且不能保证在未来的实现中工作：

```
new Properties() {
    @Override Set<Object> keySet() {
        return new TreeSet<Object>(super.keySet());
    }
} 
```

（免责声明：我什至没有测试过它是否可以编译。）

或者，您可以使用 XSLT 之类的东西重新格式化生成的 XML。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-10T15:06:49.360

您可以先对键进行排序，然后遍历属性文件中的项目并将它们写入 xml 文件。

```
public static void main(String[] args){
        String propFile = "/tmp/test2.xml";
        Properties props = new Properties();
        props.setProperty("key", "value");
        props.setProperty("key1", "value1");
        props.setProperty("key2", "value2");
        props.setProperty("key3", "value3");
        props.setProperty("key4", "value4");

        try {
            BufferedWriter out = new BufferedWriter(new FileWriter(propFile));
            List<String> list = new ArrayList<String>();
            for(Object o : props.keySet()){
                list.add((String)o);
            }
            Collections.sort(list);
            out.write("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
            out.write("<!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\">\n");
            out.write("<properties>\n");
            out.write("<comment/>\n");
            for(String s : list){
                out.write("<entry key=\"" + s + "\">" + props.getProperty(s) + "</entry>\n");
            }
            out.write("</properties>\n");
            out.flush();
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-15T18:56:51.777

在我的测试中，这个问题的其他答案在 AIX 上不能正常工作。我的特定测试机器正在运行这个版本：

> IBM J9 VM（内部版本 2.4、JRE 1.6.0 IBM J9 2.4 AIX ppc64-64 jvmap6460sr9-20110624_85526

在查看了该`store`方法的实现后，我发现它依赖于`entrySet`. 这种方法对我很有效。

```
public static void saveSorted(Properties props, FileWriter fw, String comment) throws IOException {
    Properties tmp = new Properties() {
        @Override
        public Set<Object> keySet() {
            return Collections.unmodifiableSet(new TreeSet<Object>(super.keySet()));
        }

        @Override
        public Set<java.util.Map.Entry<Object,Object>> entrySet() {
            TreeSet<java.util.Map.Entry<Object,Object>> tmp = new TreeSet<java.util.Map.Entry<Object,Object>>(new Comparator<java.util.Map.Entry<Object,Object>>() {
                @Override
                public int compare(java.util.Map.Entry<Object, Object> entry1, java.util.Map.Entry<Object, Object> entry2) {
                    String key1 = entry1.getKey().toString();
                    String key2 = entry2.getKey().toString();
                    return key1.compareTo(key2);
                }
            });

            tmp.addAll(super.entrySet());

            return Collections.unmodifiableSet(tmp);
        }

        @Override
        public synchronized Enumeration<Object> keys() {
            return Collections.enumeration(new TreeSet<Object>(super.keySet()));
        }

        @Override
        public Set<String> stringPropertyNames() {
            TreeSet<String> set = new TreeSet<String>();
            for(Object o : keySet()) {
                set.add((String)o);
            }
            return set;
        }
    };

    tmp.putAll(props);
    tmp.store(fw, comment);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T15:03:13.957

java.util.Properties 基于 Hashtable，它不按字母顺序存储其值，而是按每个项目的哈希顺序存储，这就是您看到行为的原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T15:04:15.110

java.util.Properties 是 java.util 的子类。**哈希表**。（'哈希'，是这里的关键。）您必须根据保持/定义顺序的东西提出自己的客户实现......比如 TreeMap。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-10T02:34:24.600

您可以实现您`LinkedProperties`的排序而不是使用`Properties`Java。

源代码示例：

```
package com.cpviet.training.eclipseplugin;

import java.util.Enumeration;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Properties;
import java.util.Set;

public class LinkedProperties extends Properties {

    private static final long serialVersionUID = 1L;

    private Map<Object, Object> m_linkMap = new LinkedHashMap<Object, Object>();

    @Override
    public synchronized Object put(Object key, Object value) {
        return m_linkMap.put(key, value);
    }

    @Override
    public synchronized boolean contains(Object value) {
        return m_linkMap.containsValue(value);
    }

    @Override
    public boolean containsValue(Object value) {
        return m_linkMap.containsValue(value);
    }

    @Override
    public synchronized Enumeration<Object> elements() {
        throw new UnsupportedOperationException("Enumerations are so old-school, don't use them, " + "use keySet() or entrySet() instead");
    }

    @Override
    public Set<Entry<Object, Object>> entrySet() {
        return m_linkMap.entrySet();
    }

    @Override
    public synchronized void clear() {
        m_linkMap.clear();
    }

    @Override
    public synchronized boolean containsKey(Object key) {
        return m_linkMap.containsKey(key);
    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T15:22:16.423

你可以试试这个：

创建一个执行 java.util.XMLUtils 所做的新类，但在 save 方法中更改：

```
Set keys = props.keySet();
Iterator i = keys.iterator(); 
```

到

```
Set keys = props.keySet();
List<String> newKeys = new ArrayList<String>();
for(Object key : keys)
{
   newKeys.add(key.toString());
}
Collections.sort(newKeys);
Iterator i = newKeys.iterator(); 
```

扩展属性并覆盖 Properties 类的 storeToXML 方法以调用新类的保存方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-31T23:12:55.640

这是另一个解决方案：

```
public static void save_sorted(Properties props, String filename) throws Throwable {
    FileOutputStream fos = new FileOutputStream(filename);
    Properties prop_sorted = new Properties() {
        @Override
        public Set<String> stringPropertyNames() {
            TreeSet<String> set = new TreeSet<String>();
            for (Object o : keySet()) {
                set.add((String) o);
            }
            return set;
        }
    };
    prop_sorted.putAll(props);
    prop_sorted.storeToXML(fos, "test xml");
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-09-10T15:27:17.080

为什么首先要对 XML 文件进行排序？据推测，还有另一段代码读取文件并将数据放入另一个 Properties 对象中。是否要这样做，以便手动查找和编辑 XML 文件中的条目？

# oop - 是否有可能超过OO？

> ID：54299
> 
> 赞同：8
> 
> 时间：2008-09-10T15:01:48.407
> 
> 标签：oop

我的问题很简单；是否可以过度面向对象您的代码？

多少是太多了？你在什么时候为了 OO 而放弃可读性和可维护性？

我是一个巨大的 OO 人，但有时我想知道我的代码是否过于复杂......

想法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-10T15:03:17.030

> 是否可以过度面向对象您的代码

是的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T15:13:32.030

如果您认为更多对象更面向对象，那么是的。

在进行面向对象设计时，您必须平衡一些力量。大多数 OO 设计都是关于降低和处理复杂性。因此，如果您得到非常复杂的解决方案，您并没有做太多的 OO，而是您做错了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T15:04:31.473

如果您发现在您的项目中完全实施 OO 所需的时间不必要地导致错过最后期限，那么是的。

必须在发布软件和完​​全 OO 保真度之间进行权衡。如何决定取决于个人、团队、项目和运行项目的组织。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T15:04:31.940

是的，当然有 :-) 面向对象的技术是一种工具……如果您在给定的工作中使用了错误的工具，那么您将把事情复杂化（当您只需要一把刀时，想想勺子）。

对我来说，我根据项目的规模和范围来判断“多少”。如果它是一个小项目，有时它确实增加了太多的复杂性。如果项目很大，您仍然会承担这种复杂性，但它会在可维护性、可扩展性等方面为自己付出代价。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T15:06:34.120

我的建议是不要想太多。这通常会导致做某事过度或不足（如果不是 OO）。我通常使用的经验法则是：如果它使问题更容易让我理解，我会使用一个对象。如果另一种范式比我使用一个对象更容易让我的头绕起来，我会使用它。

这个策略还没有让我失望。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T15:06:24.370

是的，这绝对是可能的——也很常见。我曾经和一个人一起工作，他创建了一个绑定到下拉列表的数据结构——这样他就可以允许用户选择性别。没错，如果可能的性别列表发生变化，那将很有用，但他们还没有（我们不住在加利福尼亚）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T15:15:52.350

是的，就像人们可以过度规范化数据库设计一样。

这似乎是永远不会结束的纯粹主义与实用主义辩论之一。<:S

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T15:17:04.173

许多人试图设计他们的代码以获得最大的灵活性和重用性，而不考虑这种可能性有多大。相反，根据您正在编写的程序分解您的课程。如果您只有一个特定对象的实例，您可以考虑将其合并到包含对象中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-10T15:24:02.440

我认为你的问题应该是：“你能对你的应用程序进行架构吗？”

当然，答案还没有。OO 只是一种设计方法。如果您因为“多态性摇滚！”而花时间在系统中构建不必要的复杂性。那么是的，也许你已经结束了OOing。

非常 XP 的答案是，**无论您喜欢哪种方法（OO、程序等），设计都应该仅在明显必要的情况下复杂**。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-10T15:27:02.370

是的你可以。例如，如果您发现自己在创建接口或抽象类之前创建了它们的两个子类型，那么您做的太过分了。当开发人员预先（过度）设计时，我经常看到这种想法。我使用测试驱动开发和重构技术来避免这种行为。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-10T15:27:32.307

> 是否可以过度面向对象您的代码？

不，但是可能会使您的代码过于复杂。例如，您可以为了使用设计模式而使用设计模式。但是你不能过度面向对象你的代码。您的代码要么是面向对象的，要么不是。就像您的代码设计得很好或者不是一样。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-10T15:07:22.683

我想这是可能的，但很难用抽象的术语回答你的问题（不是双关语）。举一个超过 OO 的例子。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-10T15:08:46.877

是的。查看“[金锤](http://en.wikipedia.org/wiki/Golden_hammer) [反模式](http://sourcemaking.com/antipatterns/golden-hammer)”的概念

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-10T15:12:08.850

我认为有时OO设计可以发挥到极致，即使在非常大的项目中也会使代码的可读性和可维护性降低。例如，可以在鞋类基类和运动鞋、正装鞋等的子类中使用。但我已经阅读/审查了人们的代码，似乎他们正在极端地为 NikeSneakers 创建低于该类的类和锐步运动鞋。两者之间当然存在差异，但是为了拥有可读、可维护的代码，我认为有时扩展一个类以适应差异而不是创建新的子类来处理差异很重要。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-10T15:17:14.703

是的，这很容易。代码不会因为它是面向对象而变得更好，也不仅仅是因为它是模块化的或功能性的或通用的或生成的或基于数据流的或面向方面的或其他任何东西。

好的代码就是好的代码，因为它的编程范式设计得很好。

好的设计需要细心。

小心谨慎需要时间。

您的案例的一个例子：我见过可怕的 Java 部分，以“面向对象”的名义，每个类都实现了某个接口，即使没有其他类*实现*该接口。有时这是一种黑客行为，但在其他情况下，它确实是无偿的。

无论您以何种范式或习语编写代码，走得太远，参与太多好事，都会使代码比问题更复杂。有些人会说，当达到这一点时，代码甚至不再是真正的，例如面向对象的。

面向对象的代码应该被更好地组织，以便在合理独立的部分中更简单、更直接或更容易理解和消化。使用与此目标相反的面向对象编码机制*不会*导致面向对象*设计*。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-10T15:22:32.413

我认为明确的答案是肯定的，但取决于你所指的领域，它可能是真的，或者不太肯定。如果您正在构建高级 .Net 或 Java 应用程序，那么我认为这是后者，因为 OO 基本上是内置在语言中的。另一方面，如果您正在开发嵌入式应用程序，那么您超过 OO 的危险和可能性很高。没有什么比看到一个真正高水平的人进入一个嵌入式项目并把他们认为丑陋的事情变得过于复杂，但却是最简单快捷的做事方式更糟糕的事情了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-10T15:54:18.187

我认为任何事情都可能“过度”。我能想到的几乎所有最佳实践都是如此。我见过如此复杂的继承链，代码几乎无法管理。

# svn - 有任何工具可以获取 Subversion 存储库的代码流失指标吗？

> ID：54318
> 
> 赞同：29
> 
> 时间：2008-09-10T15:07:18.940
> 
> 标签：svn, project-management

我正在寻找任何可以为 Subversion 存储库提供代码流失指标（图形和图表会更好）的工具。

我知道的一个工具是[statsvn](http://www.statsvn.org/) - 一个 Java 工具，它可以创建一些 HTML 报告和一些代码流失指标。Statsvn 报告用户随时间修改（搅动）的行数，每个文件和文件夹/子文件夹的 LOC 的一些描述性统计信息等。

我想知道代码流失，以便更好地了解项目的状态。灵感来自 MS 研究背后的想法：[使用相对代码流失度量来预测系统缺陷密度](http://research.microsoft.com/research/pubs/view.aspx?type=Publication&id=1359)

简而言之，源代码搅动得越多（更改，是否添加新行，删除，更改等），缺陷被引入系统的可能性就越高。MS 研究论文说，可以根据一些相关的代码流失量度来预测产生的缺陷数量。

我想知道是否还有其他可能是开源的、可扩展的等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-14T04:03:12.543

我编写了一个名为“ [svnplot](http://code.google.com/p/svnplot) ”的工具（我承认它的灵感来自 StatSVN 的输出）。它是用 python 编写的，可以在 Google 代码中找到。[http://code.google.com/p/svnplot](http://code.google.com/p/svnplot)。[您可以在http://thinkingcraftsman.in/projects/svnplot/index.htm](http://thinkingcraftsman.in/projects/svnplot/index.htm)查看示例输出

细节/输出不如“鱼眼”那么精细。基本上，它将 Subversion 日志历史记录转换为“sqlite”数据库，然后查询 sqlite 数据库以生成图形。您可以使用创建的 sqlite 数据库编写自己的查询。

看看它是否适合你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-11T02:05:13.257

如果您愿意走商业路线，请查看 Atlassian 的[FishEye](http://www.atlassian.com/software/fisheye/)（另请参阅他们的[演示站点](http://www.cenqua.com/fisheye/demo)）。FishEye 还支持添加[插件](http://confluence.atlassian.com/display/FISHEYE/Developing+Fisheye+and+Crucible+Plugins)（尽管目前似乎不太支持）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-05T12:39:58.103

See [svn-churn](https://github.com/martinmoene/svn-churn), a simple Python script to determine file churn and fix count of a Subversion repository.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T15:35:26.983

我听说过和使用过的唯一一个是 statsvn，搜索 google 不会返回很多结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T23:02:05.893

您可以使用`svn blame`获取每行更改的日期，然后使用`sed`仅提取年份和月份，然后使用`sort`and`uniq -c`生成有用的报告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T16:00:08.927

The Power Software tool, KEPM, is pretty focused on CHURN these days. JP

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-07-16T07:54:54.387

try [programeter](http://programeter.edicypages.com/) which analyses Subversion and many other dev. tools.

# sql - 如何在 sql server 的查询中连接文本？

> ID：54334
> 
> 赞同：81
> 
> 时间：2008-09-10T15:11:42.983
> 
> 标签：sql, sql-server

下面的 SQL：

```
SELECT notes + 'SomeText'
FROM NotesTable a 
```

给出错误：

> 数据类型 nvarchar 和 text 在 add 运算符中不兼容。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-09-10T15:13:16.070

唯一的方法是将您的文本字段转换为 nvarchar 字段。

```
Select Cast(notes as nvarchar(4000)) + 'SomeText'
From NotesTable a 
```

否则，我建议在您的应用程序中进行连接。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-16T21:09:09.610

您可能还需要考虑 NULL 值。在您的示例中，如果列**notes**具有空值，则结果值为 NULL。如果您希望 null 值表现为空字符串（以便答案出现 'SomeText'），请使用 IsNull 函数：

```
Select IsNull(Cast(notes as nvarchar(4000)),'') + 'SomeText' From NotesTable a 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-11T16:38:46.510

如果您使用 SQL Server 2005 或更高版本，根据 Notes 字段中数据的大小，您可能需要考虑转换为 nvarchar(max) 而不是转换为可能导致字符串截断的特定长度。

```
Select Cast(notes as nvarchar(max)) + 'SomeText' From NotesTable a 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-10T15:15:48.950

您必须将字符串类型显式转换为相同类型才能连接它们，在您的情况下，您可以通过在“SomeText”（N'SomeText'）前面简单地添加一个“N”来解决问题。如果这不起作用，请尝试 Cast('SomeText' as nvarchar(8))。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-01-31T10:53:49.597

另一个选项是[CONCAT](https://docs.microsoft.com/en-us/sql/t-sql/functions/concat-transact-sql "康卡特")命令：

```
SELECT CONCAT(MyTable.TextColumn, 'Text') FROM MyTable 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T10:35:15.150

如果您使用的是 SQL Server 2005（或更高版本），您可能需要考虑在表定义中切换到 NVARCHAR(MAX)；SQL Server 2000 的 TEXT、NTEXT 和 IMAGE 数据类型将在 SQL Server 的未来版本中弃用。SQL Server 2005 提供了对数据类型的向后兼容性，但您可能应该改用 VARCHAR(MAX)、NVARCHAR(MAX) 和 VARBINARY(MAX)。

# c# - 如何找出 ASP .Net 网页元素的样式来自哪里？

> ID：54337
> 
> 赞同：2
> 
> 时间：2008-09-10T15:12:19.770
> 
> 标签：c#, asp.net, css, themes

我有一个难题。我的 Web 应用程序（C#、.Net 3.0 等）有主题、CSS 表，当然还有内联样式定义。现在有很多厨师在汤里加东西。毫不奇怪，所有这些结果在我的页面中有时会出现奇怪的样式。

我确信所有这些样式都以分层方法应用（尽管我不确定该顺序）。问题是每种样式都被应用为“透明”层，它只是掩盖了它正在应用的内容。我觉得这是一个好主意，因为您可以为整体指定样式，然后根据需要一次性指定样式。不幸的是，我不知道样式实际上来自哪一层。

我可以通过在所有层明确表达样式来解决这个问题，但这会变得庞大且难以管理，并且页面在 80% 的时间都可以正常工作。我只需要弄清楚这 20% 的松鼠是从哪里来的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T15:25:54.433

恕我直言，Firebug 将是您最好的选择。它会告诉您样式来自哪个文件，您可以单击文件名立即传输到文件中的相关行。

注意：您可以在任何页面上点击`ctrl`++以使用鼠标选择`shift`和`C`检查元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-10T16:32:38.063

这是一个关于如何使用 Firebug 找出元素从何处获得其样式的快速播放。

[http://screencast.com/t/oFpuDUoJ0](http://screencast.com/t/oFpuDUoJ0)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T15:14:13.930

在 Firefox 中使用 DOM 检查器、firebug 或检查这个。
在 IE 中，使用 IE 开发工具栏（或者更好的是[Firebug Lite](http://getfirebug.com/lite.html)）
在 Google Chrome 中，使用内置的“检查元素”功能

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T15:46:55.880

使用[IE 开发工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)，您可以选择一个元素（通过“单击选择元素”或在 DOM 树视图中单击其节点）并在“当前样式”窗格中，右键单击一行并选择“跟踪样式”。

其他工具具有类似的功能。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-11T19:04:33.853

解决复杂 CSS 问题的关键是找出导致奇怪外观的原因。最简单的查找方法是有选择地注释掉样式表，直到找到一个注释掉它可以解决问题的样式表。然后启用样式表并有选择地注释掉规则，直到找到导致问题的规则。如果您需要知道什么优先于什么，这里详细介绍了 CSS 中的级联细节 [，](http://www.w3.org/TR/CSS21/cascade.html)与单个规则的实现不同，这在浏览器中是相当一致的。

但是，如果您完全避免内联样式并拥有一组精心设计的样式表，每个样式表都有一个逻辑功能并且您了解其所有规则，那就更好了。出于同样的原因，您不会将服务器端代码以随机顺序放在随机文件中 -[我们](http://stackoverflow.com)

# asp.net - 将 ActiveDirectoryMembershipProvider 与两个域控制器一起使用

> ID：54364
> 
> 赞同：3
> 
> 时间：2008-09-10T15:17:06.623
> 
> 标签：asp.net, active-directory, directoryservices

我们有一个在客户站点上运行的 ASP.NET 应用程序，该应用程序使用 ActiveDirectory 通过 ActiveDirectoryMembershipProvider 进行用户登录。我们指向的他们的主域控制器今天早上出现故障，在恢复所有内容时，客户端想知道我们是否可以与两个域控制器建立冗余连接；即指定一个主要和一个备份AD 服务器。谷歌搜索被证明是徒劳的——有人知道这是否可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T15:46:52.197

如果 ActiveDirectory 不能处理多个域控制器，那么它就不是一个很好的技术。

您只需要确保在您的会员配置中指向“域”而不是“服务器”，然后将两个或更多控制器添加到您的域。

通常，如果您将域称为“LDAP://server/DC=domain,DC=com”，那么您应该能够删除“server”部分并简单地引用“LDAP://DC=domain,DC =com”

以下代码项目列出了您可以从 C# 在 Active Directory 中执行的操作：http: [//www.codeproject.com/KB/system/everythingInAD.aspx#7](http://www.codeproject.com/KB/system/everythingInAD.aspx#7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T15:44:17.103

这是可以做到的，只是需要一些工作。

您将需要创建一个继承 ActiveDirectoryMemberhsipProvider 的类，并在您的提供者中使用它。这样您就可以维护大部分功能。然后设置一种方法来指定两个 connectionStringName 属性，一个用于主属性，一个用于辅助属性。由于您正在更改配置，因此您还需要创建代码以从配置中读取信息。然后只需覆盖您需要在主服务器关闭并切换到辅助服务器时捕获的方法。这将是最可重用的方式。

可能还有其他方法可以做到这一点，但它可能会很hacky并且不是很可重用。就像在每个请求之前测试连接，然后以这种方式设置连接字符串。

根据该类的[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.security.activedirectorymembershipprovider.aspx)，这可能是唯一的方法。它们不提供内部功能。

# shell - 将一个衬垫添加到文件中

> ID：54365
> 
> 赞同：135
> 
> 时间：2008-09-10T15:17:09.507
> 
> 标签：shell, unix

这可能是[一个复杂的解决方案](http://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/x13320.html)。

我正在寻找像“>>”这样的简单运算符，但要预先添加。

恐怕它不存在。我将不得不做类似的事情

```
mv myfile tmp
 猫 myheader tmp > myfile

```

有什么更聪明的吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-09-10T15:21:26.127

这仍然使用一个临时文件，但至少它在一行：

```
echo "text" | cat - yourfile > /tmp/out && mv /tmp/out yourfile 
```

学分：[BASH：在文件中添加文本/行](http://www.cyberciti.biz/faq/bash-prepend-text-lines-to-file/)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2010-07-17T16:24:17.397

```
echo '0a
your text here
.
w' | ed some_file 
```

ed 是标准编辑器！[http://www.gnu.org/fun/jokes/ed.msg.html](http://www.gnu.org/fun/jokes/ed.msg.html)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-07T12:43:49.330

下面的**破解**是一个快速的即兴回答，它有效并获得了很多支持。然后，随着这个问题变得越来越流行并且时间越来越长，愤怒的人们开始报告说它有点工作，但可能会发生奇怪的事情，或者它根本不起作用，所以它一度被疯狂地否决了。好好玩。

该解决方案利用了系统上文件描述符的精确实现，并且由于 nixes 之间的实现差异很大，因此它的成功完全取决于系统，绝对不可移植，并且不应该依赖任何甚至模糊重要的事情。

现在，尽管如此，答案是：

* * *

为文件 ( ) 创建另一个文件描述符，`exec 3<> yourfile`然后写入该文件 ( `>&3`) 似乎克服了读取/写入同一文件的困境。使用 awk 在 600K 文件上为我工作。然而，使用 'cat' 尝试相同的技巧失败了。

将前缀作为变量传递给 awk ( `-v TEXT="$text"`) 克服了文字引号问题，该问题阻止了使用 'sed' 执行此技巧。

```
#!/bin/bash
text="Hello world
What's up?"

exec 3<> yourfile && awk -v TEXT="$text" 'BEGIN {print TEXT}{print}' yourfile >&3 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-05-02T16:03:15.637

John Mee：不能保证您的方法有效，如果您预先添加超过 4096 字节的内容，可能会失败（至少 gnu awk 会发生这种情况，但我认为其他实现也会有类似的限制）。在这种情况下，它不仅会失败，而且会进入一个无限循环，读取自己的输出，从而使文件增长，直到所有可用空间都被填满。

自己试试吧：

```
exec 3<>myfile && awk 'BEGIN{for(i=1;i<=1100;i++)print i}{print}' myfile >&3 
```

（警告：一段时间后将其杀死，否则它将填满文件系统）

此外，以这种方式编辑文件非常危险，而且这是非常糟糕的建议，好像在编辑文件时发生了某些事情（崩溃，磁盘已满），您几乎可以保证文件处于不一致的状态。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-09-10T15:22:22.740

没有临时文件是不可能的，但这里有一个 oneliner

```
{ echo foo; cat oldfile; } > newfile && mv newfile oldfile 
```

您可以使用 ed 或 perl 等其他工具在没有临时文件的情况下执行此操作。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2013-03-30T17:10:17.650

如果您在您控制的计算机上需要此功能，请安装包“moreutils”并使用“sponge”。然后你可以这样做：

```
cat header myfile | sponge myfile 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-12T16:51:54.147

可能值得注意的是，使用[mktemp](http://www.mktemp.org/ "mktemp 主页")之类的实用程序安全地生成临时文件通常是一个[好主意](http://www.linuxsecurity.com/content/view/115462/81/ "LinuxSecurity 的 Stefan Nordhausen 用 Shell 脚本安全地创建临时文件")，至少如果脚本将以 root 权限执行的话。例如，您可以执行以下操作（再次在 bash 中）：

```
(tmpfile=`mktemp` && { echo "prepended text" | cat - yourfile > $tmpfile && mv $tmpfile yourfile; } ) 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2015-02-13T16:41:08.003

使用 bash heredoc 可以避免对 tmp 文件的需要：

```
cat <<-EOF > myfile
  $(echo this is prepended)
  $(cat myfile)
EOF 
```

这是因为 $(cat myfile) 是在评估 bash 脚本时评估的，在执行带有重定向的 cat 之前。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-07-16T14:09:13.800

假设您要编辑的文件是 my.txt

```
$cat my.txt    
this is the regular file 
```

您要添加的文件是标题

```
$ cat header
this is the header 
```

确保头文件中有最后一个空行。
现在你可以在它前面加上

```
$cat header <(cat my.txt) > my.txt 
```

你最终得到

```
$ cat my.txt
this is the header
this is the regular file 
```

据我所知，这只适用于“bash”。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-09-14T23:08:41.447

当您开始尝试在 shell 脚本中做一些困难的事情时，我强烈建议您考虑用“适当的”脚本语言（Python/Perl/Ruby/etc）重写脚本

至于将一行添加到文件中，不可能通过管道来执行此操作，因为当您执行类似 的任何操作时`cat blah.txt | grep something > blah.txt`，它会无意中使文件空白。有一个名为`sponge`您可以安装的小实用程序命令（您安装`cat blah.txt | grep something | sponge blah.txt`它，它会缓冲文件的内容，然后将其写入文件）。它类似于临时文件，但您不必明确地这样做。但我会说这是一个比 Perl 更“糟糕”的要求。

可能有一种方法可以通过 awk 或类似方法来完成，但如果你必须使用 shell 脚本，我认为临时文件是迄今为止最简单（/唯一？）的方法。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2012-02-28T16:01:31.063

就像 Daniel Velkov 建议的那样，使用 tee。
对我来说，这是简单的智能解决方案：

```
{ echo foo; cat bar; } | tee bar > /dev/null 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-10-26T19:49:49.883

**编辑：这是坏的。[使用 cat 和 tee 附加到文件时，](https://stackoverflow.com/questions/25334938/weird-behavior-when-prepending-to-a-file-with-cat-and-tee)请参阅奇怪的行为**

覆盖问题的解决方法是使用`tee`：

```
cat header main | tee main > /dev/null 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2010-09-30T22:34:49.723

```
sed -i -e "1s/^/new first line\n/" old_file.txt 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-05-24T09:19:18.550

我使用的那个。这允许您以您喜欢的方式指定顺序、额外字符等：

```
echo -e "TEXTFIRSt\n$(< header)\n$(< my.txt)" > my.txt 
```

PS：只有当文件包含带反斜杠的文本时它才不起作用，因为它被解释为转义字符

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-07-08T17:21:32.583

主要是为了好玩/打壳高尔夫，但是

```
ex -c '0r myheader|x' myfile 
```

会成功的，并且没有管道或重定向。当然，vi/ex 并不是真正用于非交互式使用，所以 vi 会短暂闪现。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-01-05T07:14:22.107

使用**$( command )**您可以将命令的输出写入变量。所以我在一行中用三个命令完成了它，没有临时文件。

```
originalContent=$(cat targetfile) && echo "text to prepend" > targetfile && echo "$originalContent" >> targetfile 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-03-02T11:57:43.213

cb0 的“无临时文件”解决方案的一个变体，用于添加固定文本：

```
echo "text to prepend" | cat - file_to_be_modified | ( cat > file_to_be_modified ) 
```

这再次依赖于子 shell 执行 - (..) - 以避免 cat 拒绝使用相同的文件进行输入和输出。

注意：喜欢这个解决方案。但是，在我的 Mac 中，原始文件丢失了（认为它不应该，但它确实丢失了）。这可以通过将您的解决方案编写为来解决： echo "text to prepend" | 猫-file_to_be_modified | 猫 > tmp_file; mv tmp_file file_to_be_modified

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-03-06T08:11:55.997

警告：这需要更多的工作来满足 OP 的需求。

尽管有疑虑，但应该有一种方法可以使@shixilun 的 sed 方法发挥作用。`vis`将文件读入 sed 替代字符串时必须有一个 bash 命令来转义空格（例如，用 '\n' 替换换行符。Shell 命令`cat`可以处理不可打印的字符，但不能处理空格，所​​以这不会解决 OP 的问题问题：

```
sed -i -e "1s/^/$(cat file_with_header.txt)/" file_to_be_prepended.txt 
```

由于替代脚本中的原始换行符而失败，需要在其前面加上一个续行字符 () 并且可能后跟一个 &，以保持 shell 和 sed 快乐，就像[这个 SO answer](https://stackoverflow.com/a/723164/623735)

`sed`非全局搜索替换命令的大小限制为 40K（模式后没有尾随 /g），因此可能会避免匿名警告的 awk 可怕的缓冲区溢出问题。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2011-04-08T09:23:18.440

为什么不简单地使用 ed 命令（正如 fluffle 在这里所建议的那样）？

ed 将整个文件读入内存并自动执行就地文件编辑！

所以，如果你的文件不是那么大......

```
# cf. "Editing files with the ed text editor from scripts.",
# http://wiki.bash-hackers.org/doku.php?id=howto:edit-ed

prepend() {
   printf '%s\n' H 1i "${1}" . wq | ed -s "${2}"
}

echo 'Hello, world!' > myfile
prepend 'line to prepend' myfile 
```

另一种解决方法是使用 Jürgen Hötzel 在[Redirect output from sed 's/c/d/' myFile to myFile中建议的打开文件句柄](https://stackoverflow.com/questions/2585438/redirect-output-from-sed-s-c-d-myfile-to-myfile)

```
echo cat > manipulate.txt
exec 3<manipulate.txt
# Prevent open file from being truncated:
rm manipulate.txt
sed 's/cat/dog/' <&3 > manipulate.txt 
```

当然，所有这些都可以放在一条线上。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-11-21T07:24:37.550

这是我发现的：

```
echo -e "header \n$(cat file)" >file 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2012-05-06T15:30:20.870

```
sed -i -e '1rmyheader' -e '1{h;d}' -e '2{x;G}' myfile 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-11T05:00:50.917

如果您在 BASH 中编写脚本，实际上，您可以发出：

```
cat - 你的文件 /tmp/out && mv /tmp/out 你的文件

```

这实际上是在您自己在自己的问题中发布的复杂示例中。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-10-12T21:42:25.920

如果您有一个大文件（在我的情况下为几百 KB）并且可以访问 python，这比`cat`管道解决方案要快得多：

`python -c 'f = "filename"; t = open(f).read(); open(f, "w").write("text to prepend " + t)'`

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-06-29T02:22:30.190

一个解决方案`printf`：

```
new_line='the line you want to add'
target_file='/file you/want to/write to'

printf "%s\n$(cat ${target_file})" "${new_line}" > "${target_file}" 
```

你也可以这样做：

```
printf "${new_line}\n$(cat ${target_file})" > "${target_file}" 
```

但在这种情况下，您必须确保没有任何`%`地方，包括目标文件的内容，因为它可以被解释并搞砸您的结果。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-01-07T00:15:05.337

您可以使用 perl 命令行：

```
perl -i -0777 -pe 's/^/my_header/' tmp 
```

其中 -i 将创建文件的内联替换，而 -0777 将 slurp 整个文件并使 ^ 仅匹配开头。-pe 将打印所有行

或者如果 my_header 是一个文件：

```
perl -i -0777 -pe 's/^/`cat my_header`/e' tmp 
```

/e 将允许在替换中对代码进行评估。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-04-28T16:54:23.483

```
current=`cat my_file` && echo 'my_string' > my_file && echo $current >> my_file 
```

其中“my_file”是要添加“my_string”的文件。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2011-08-13T11:01:07.017

我最喜欢[@fluffle 的**ed**方法](https://stackoverflow.com/questions/54365/prepend-to-a-file-one-liner-shell/3272296#3272296)。毕竟，任何工具的命令行开关与脚本编辑器命令在这里本质上是一样的；没有看到脚本编辑器解决方案“清洁度”变得更小或诸如此类。

这是我附加到的单行代码，用于添加`.git/hooks/prepare-commit-msg`一个 in-repo`.gitmessage`文件以提交消息：

```
echo -e "1r $PWD/.gitmessage\n.\nw" | ed -s "$1" 
```

示例`.gitmessage`：

```
# Commit message formatting samples:
#       runlevels: boot +consolekit -zfs-fuse
# 
```

我正在做`1r`而不是`0r`，因为这会在原始模板的文件顶部留下空的准备写入行。不要在`.gitmessage`then 上面放一个空行，你最终会得到两个空行。`-s`抑制 ed 的诊断信息输出。

在经历这个过程中，我[发现](http://shawnbiddle.com/devblog/archive/git-commit-templates-vim-and-you)对于 vim 爱好者来说，拥有以下内容也很好：

```
[core]
        editor = vim -c ':normal gg' 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-08-17T10:20:38.867

变量，ftw？

```
NEWFILE=$(echo deb http://mirror.csesoc.unsw.edu.au/ubuntu/ $(lsb_release -cs) main universe restricted multiverse && cat /etc/apt/sources.list)
echo "$NEWFILE" | sudo tee /etc/apt/sources.list 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2012-12-29T00:06:56.080

我认为这是 ed 最干净的变体：

```
cat myheader | { echo '0a'; cat ; echo -e ".\nw";} | ed myfile 
```

作为一个函数：

```
function prepend() { { echo '0a'; cat ; echo -e ".\nw";} | ed $1; }

cat myheader | prepend myfile 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-08-16T14:05:40.043

恕我直言，无论两个文件`myheader`和`myfile`. 原因是，如果您想在不重复到临时文件的情况下执行此操作（并且不让 shell 以静默方式重复到临时文件，例如通过`exec 3<>myfile`、 管道`tee`等构造）。

您正在寻找的“真实”解决方案需要摆弄文件系统，因此它在用户空间中不可用并且取决于平台：您要求将正在使用的文件系统指针修改为文件系统指针`myfile`的当前值用指向当前文件系统地址的链接链接`myheader`替换文件系统中`EOF`的。这不是微不足道的，显然不能由非超级用户完成，也可能不是超级用户......玩 inode 等。`myheader``myfile`

不过，您可以或多或少地使用循环设备来伪造它。参见例如[这个 SO thread](https://stackoverflow.com/questions/5893531/fast-concatenate-multiple-files-on-linux)。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-06-05T10:00:23.243

又快又脏，用 python 缓冲内存中的所有内容：

```
$ echo two > file
$ echo one | python -c "import sys; f=open(sys.argv[1]).read(); open(sys.argv[1],'w').write(sys.stdin.read()+f)" file
$ cat file
one
two
$ # or creating a shortcut...
$ alias prepend='python -c "import sys; f=open(sys.argv[1]).read(); open(sys.argv[1],\"w\").write(sys.stdin.read()+f)"'
$ echo zero | prepend file
$ cat file
zero
one
two 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-10-11T01:14:57.703

对于破折号/灰烬：

```
echo "hello\n$(cat myfile)" > myfile 
```

例子：

```
$ echo "line" > myfile
$ cat myfile
line
$ echo "line1\n$(cat myfile)" > myfile
$ cat myfile
line1
line 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2022-01-04T17:37:04.887

我找到的最简单的解决方案是：

```
cat myHeader myFile | tee myFile 
```

或者

```
echo "<line to add>" | cat - myFile | tee myFile 
```

笔记：

*   如果`echo -n`您只想附加一段文本（而不是整行），请使用。
*   `&> /dev/null`如果您不想看到输出（生成的文件），请添加到末尾。
*   这可用于将 shebang 附加到文件中。例子：

    ```
    # make it executable (use u+x to allow only current user)
    chmod +x cropImage.ts
    # append the shebang
    echo '#''!'/usr/bin/env ts-node | cat - cropImage.ts | tee cropImage.ts &> /dev/null
    # execute it
    ./cropImage.ts myImage.png 
    ```

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2010-04-16T10:31:04.390

呸! 没有人愿意提及*tac*。

```
endor@grid ~ $ tac --help
Usage: tac [OPTION]... [FILE]...
Write each FILE to standard output, last line first.
With no FILE, or when FILE is -, read standard input.

Mandatory arguments to long options are mandatory for short options too.
  -b, --before             attach the separator before instead of after
  -r, --regex              interpret the separator as a regular expression
  -s, --separator=STRING   use STRING as the separator instead of newline
      --help     display this help and exit
      --version  output version information and exit

Report tac bugs to bug-coreutils@gnu.org
GNU coreutils home page: <http://www.gnu.org/software/coreutils/>
General help using GNU software: <http://www.gnu.org/gethelp/>
Report tac translation bugs to <http://translationproject.org/team/> 
```

# .net - 将 ADO.Net 数据服务应用程序部署到 IIS 时出现问题

> ID：54380
> 
> 赞同：14
> 
> 时间：2008-09-10T15:21:15.053
> 
> 标签：.net, web-services, iis, wcf-data-services

我正在向现有网页添加 ADO.Net 数据服务查找功能。从 Visual Studio 运行时一切正常，但是当我将其推出到 IIS 时，出现以下错误：

> **请求错误**
> 服务器在处理请求时遇到错误。有关更多详细信息，请参阅服务器日志。

即使尝试显示默认页面，我也会得到这个，即：

> [http://server/FFLookup.svc](http://server/FFLookup.svc)

我在服务器上安装了 3.5 SP1。

我错过了什么，它指的是哪个“服务器日志”？我找不到任何进一步的错误消息。

事件查看器日志（系统或应用程序）中没有任何内容，IIS 日志中除了 GET 之外没有任何内容：

> 2008-09-10 15:20:19 10.7.131.71 GET /FFLookup.svc - 8082 - 10.7.131.86 Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US)+AppleWebKit/525.13 +(KHTML,+like+Gecko)+Chrome/0.2.149.29+Safari/525.13 401 2 2148074254

没有返回堆栈跟踪。我得到的唯一响应是上面提到的“请求错误”。

谢谢

帕特里克

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-10T05:28:59.950

为了详细显示数据服务导致的错误，您可以在数据服务定义上方放置以下标记：

```
[System.ServiceModel.ServiceBehavior(IncludeExceptionDetailInFaults = true)] 
```

然后，这将在您的浏览器窗口中显示错误以及堆栈跟踪。

除了这个 dataservices 抛出 HandleException 方法的所有异常，所以如果你在你的 dataservice 类上实现这个方法，你可以在它上面放置一个断点并查看异常：

```
protected override void HandleException(HandleExceptionArgs e)
{
  try
  {
    e.UseVerboseErrors = true;
  }
  catch (Exception ex)
  {
    Console.WriteLine(ex.Message);
  }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-11T00:29:00.803

好吧，我找到了上面错误中提到的“服务器日志”。

您需要通过添加以下标记在 web.config 文件中打开跟踪：

```
 <system.diagnostics>
      <sources>
        <source name="System.ServiceModel.MessageLogging" switchValue="Warning, ActivityTracing" >
            <listeners>
                <add name="ServiceModelTraceListener"/>
            </listeners>
        </source>

        <source name="System.ServiceModel" switchValue="Verbose,ActivityTracing"        >
            <listeners>
                <add name="ServiceModelTraceListener"/>
            </listeners>
        </source>
        <source name="System.Runtime.Serialization" switchValue="Verbose,ActivityTracing">
            <listeners>
                <add name="ServiceModelTraceListener"/>
            </listeners>
        </source>
    </sources>
    <sharedListeners>
        <add initializeData="App_tracelog.svclog"   
                        type="System.Diagnostics.XmlWriterTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
                        name="ServiceModelTraceListener" traceOutputOptions="Timestamp"/>
    </sharedListeners>
</system.diagnostics> 
```

这将在您的网站目录中创建一个名为 app_tracelog.svclog 的文件。

然后使用 SvcTraceViewer.exe 实用程序查看此文件。查看器很好地突出了错误（以及有关通信的许多其他信息）。

**注意：使用上述参数创建的日志文件增长非常快。只能在调试时开启！**

在这种特殊情况下，问题最终是我们的 Oracle 数据提供程序 OraDirect.Net 的错误版本。我们使用的版本不支持 3.5 SP1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-05T22:31:11.893

对我来说，错误是由两个具有相同名称的方法（意外重载）引起的。

> 不支持重载，但类型“abc”具有重载方法“Void SubmitCart(System.String, Int32)”。

我是通过在调试模式下运行服务发现的。

# .net - 将 .net 方法公开为 Excel 函数？

> ID：54387
> 
> 赞同：6
> 
> 时间：2008-09-10T15:23:26.420
> 
> 标签：.net, excel, interop, vsto

我有一组位于.Net DLL 中的计算方法。我想让 Excel (2003+) 用户可以使用这些方法，以便他们可以在电子表格中使用它们。

例如，我的 .net 方法：

```
public double CalculateSomethingReallyComplex(double a, double b) {...} 
```

我希望他们能够通过在随机单元格中键入公式来调用此方法：

```
=CalculateSomethingReallyComplex(A1, B1) 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-09T14:17:39.000

您还应该看看 ExcelDna ( [http://www.codeplex.com/exceldna](http://www.codeplex.com/exceldna) )。ExcelDna 是一个开源项目（也可免费用于商业用途），它允许您使用 .Net 创建本机 .xll 插件。可以创建用户定义的函数 (UDF) 和宏。您的加载项代码可以位于包含 VB、C# 或 F# 代码的基于文本的脚本文件中，也可以位于托管 .dll 中。

由于使用本机 Excel SDK 接口，而不是基于 COM 的自动化，因此可以轻松部署基于 ExcelDna 的加载项，无需注册。ExcelDna 支持从 Excel '97 到 Excel 2007 的 Excel 版本，包括对 Excel 2007 数据类型（大工作表和 Unicode 字符串）的支持，以及 Excel 2007 下的多线程重新计算。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T15:36:08.357

有两种方法 - 您可以使用 Visual Studio Tools for Office (VSTO)：

[http://blogs.msdn.com/pstubbs/archive/2004/12/31/344964.aspx](http://blogs.msdn.com/pstubbs/archive/2004/12/31/344964.aspx)

或者你可以使用 COM：

[http://blogs.msdn.com/eric_carter/archive/2004/12/01/273127.aspx](http://blogs.msdn.com/eric_carter/archive/2004/12/01/273127.aspx)

我不确定 VSTO 方法是否适用于旧版本的 Excel，但 COM 方法应该可以正常工作。

# vim - vim 中代码块和宏的最佳策略是什么？

> ID：54401
> 
> 赞同：5
> 
> 时间：2008-09-10T15:27:50.480
> 
> 标签：vim, vi

随着我使用 vim 进行更多开发，我发现自己想要复制有用的代码块，类似于 Eclipse 中的“模板”。

我正在考虑为每个代码块制作一个单独的文件，然后将它们读入

```
:r code-fornext 
```

但这似乎有点原始。谷歌搜索我发现提到了 vim 宏和一些关于“地图”的东西，但没有什么看起来很简单。

我正在寻找的是诸如 Eclipse 的“模板”之类的东西，所以我弹出一个代码块，光标位于它的中间。或者 JEdit 的“宏”，我可以记录在一行上进行复杂的删除和重命名，然后我可以在其他 10 行上再次播放它，所以它对它们做同样的事情。

vim 有这两个功能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-10T16:03:36.230

要在 Vim 中录制宏，请在命令模式下，点击`q`要分配宏的键和另一个键。为了快速丢弃宏，我通常只是点击`qq`并将宏分配给`q`键。进入录制模式后，请运行您的击键。完成后，请确保您回到命令模式并`q`再次点击以停止录制。然后要手动重播宏，您可以键入`@q`. 要重播之前运行的宏，您可以键入`@@`or 运行 10 次，您可以键入`10@q`or`20@q`等​​。

总之：

```
+----------------------------------+-------------------------------------+
| start recording a macro          | qX (X = key to assign macro to)     |
+----------------------------------+-------------------------------------+
| stop recording a macro           | q                                   |  
+----------------------------------+-------------------------------------+
| playback macro                   | @X (X = key macro was assigned to)  |
+----------------------------------+-------------------------------------+
| replay previously played macro   | @@                                  |
+----------------------------------+-------------------------------------+ 
```

关于代码块，我发现并开始使用一个名为 snipMate 的 Vim 插件，它模仿了 TextMate 的片段功能。您可以在此处获取插件：

[http://www.vim.org/scripts/script.php?script_id=2540](http://www.vim.org/scripts/script.php?script_id=2540)

还有一篇关于使用 snipMate 的简短文章（以及显示它正在使用中的简短截屏视频）：

[http://www.catonmat.net/blog/vim-plugins-snipmate-vim/](http://www.catonmat.net/blog/vim-plugins-snipmate-vim/)

希望你觉得这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:42:28.240

在 vim.wikia 上，您会找到一[类](http://vim.wikia.com/wiki/Category:Automated_Text_Insertion "自动文本插入类别")专门用于片段和缩写扩展的提示。您还将看到简化复杂片段/模板文件定义的插件列表。

高温下，

# sql - 我如何（或我可以）在多列上选择 DISTINCT？

> ID：54418
> 
> 赞同：488
> 
> 时间：2008-09-10T15:33:10.890
> 
> 标签：sql, postgresql, sql-update, duplicates, distinct

我需要从一个表中检索所有行，其中 2 列组合起来都不同。所以我想要所有在同一天以相同价格发生的没有任何其他销售的销售。基于日期和价格的唯一销售将更新为活动状态。

所以我在想：

```
UPDATE sales
SET status = 'ACTIVE'
WHERE id IN (SELECT DISTINCT (saleprice, saledate), id, count(id)
             FROM sales
             HAVING count = 1) 
```

但是我的大脑比这更痛苦。

* * *

## 回答 #1

> 赞同：513
> 
> 时间：2008-09-10T15:36:09.417

```
SELECT DISTINCT a,b,c FROM t 
```

大致*相当于*：

```
SELECT a,b,c FROM t GROUP BY a,b,c 
```

习惯 GROUP BY 语法是个好主意，因为它更强大。

对于您的查询，我会这样做：

```
UPDATE sales
SET status='ACTIVE'
WHERE id IN
(
    SELECT id
    FROM sales S
    INNER JOIN
    (
        SELECT saleprice, saledate
        FROM sales
        GROUP BY saleprice, saledate
        HAVING COUNT(*) = 1 
    ) T
    ON S.saleprice=T.saleprice AND s.saledate=T.saledate
 ) 
```

* * *

## 回答 #2

> 赞同：376
> 
> 时间：2012-09-28T00:50:06.250

如果您将到目前为止的答案放在一起，进行清理和改进，您将得到这个高级查询：

```
UPDATE sales
SET    status = 'ACTIVE'
WHERE  (saleprice, saledate) IN (
    SELECT saleprice, saledate
    FROM   sales
    GROUP  BY saleprice, saledate
    HAVING count(*) = 1 
    ); 
```

这比他们中的任何一个*都快得多*。将当前接受的答案的性能提高 10 - 15 倍（在我对 PostgreSQL 8.4 和 9.1 的测试中）。

但这仍然远非最佳。使用[**`NOT EXISTS`**](https://www.postgresql.org/docs/current/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)（反）半连接以获得更好的性能。`EXISTS`是标准 SQL，一直存在（至少从 PostgreSQL 7.2 开始，早在问这个问题之前）并且完全符合提出的要求：

```
UPDATE sales s
SET    status = 'ACTIVE'
WHERE  NOT EXISTS (
   SELECT FROM sales s1                     -- SELECT list can be empty for EXISTS
   WHERE  s.saleprice = s1.saleprice
   AND    s.saledate  = s1.saledate
   AND    s.id <> s1.id                     -- except for row itself
   )
AND    s.status IS DISTINCT FROM 'ACTIVE';  -- avoid empty updates. see below 
```

*db<>fiddle [here](https://dbfiddle.uk/?rdbms=postgres_11&fiddle=26c7eb96c3a22330a9c271d554c869fe)*
[旧 SQL Fiddle](http://sqlfiddle.com/#!17/6b5ef/1)

### 标识行的唯一键

如果您没有表的主键或唯一键（`id`在示例中），您可以用系统列替换`ctid`此查询的目的（但不能用于其他一些目的）：

```
 AND    s1.ctid <> s.ctid 
```

[每个表都应该有一个主键。如果您还没有，请添加一个。我建议 Postgres 10+ 中的一个`serial`或一个`IDENTITY`专栏。]

有关的：

*   [有序序列生成](https://stackoverflow.com/questions/17500013/in-order-sequence-generation/17503095#17503095)
*   [自动递增表列](https://stackoverflow.com/questions/9875223/auto-increment-table-column/9875517#9875517)

### 这怎么更快？

`EXISTS`一旦发现第一个欺骗，反半连接中的子查询就可以停止评估（没有必要进一步研究）。对于几乎没有重复的基表，这只是稍微更有效。有了很多重复，这变得*更有*效率。

### 排除空更新

对于已经具有`status = 'ACTIVE'`此更新的行，不会更改任何内容，但仍会以全部成本插入新的行版本（适用少数例外情况）。通常，您不希望这样。添加另一个`WHERE`条件，如上所示，以避免这种情况并使其更快：

如果`status`已定义`NOT NULL`，则可以简化为：

```
AND status <> 'ACTIVE'; 
```

列的数据类型必须支持`<>`运算符。有些类型`json`不喜欢。看：

*   [如何查询空对象的 json 列？](https://stackoverflow.com/questions/24292575/how-to-query-a-json-column-for-empty-objects/24296054#24296054)

### NULL 处理的细微差别

此查询（与[Joel 当前接受的答案](https://stackoverflow.com/a/54430/939860)不同）不会将 NULL 值视为相等。以下两行将`(saleprice, saledate)`被视为“不同”（虽然看起来与人眼相同）：

```
(123, NULL)
(123, NULL) 
```

还传入一个唯一索引和几乎其他任何地方，因为根据 SQL 标准，NULL 值不比较相等。看：

*   [使用空列创建唯一约束](https://stackoverflow.com/questions/8289100/create-unique-constraint-with-null-columns/8289253#8289253)

OTOH, `GROUP BY`,`DISTINCT`或`DISTINCT ON ()`将 NULL 值视为相等。根据您想要实现的目标使用适当的查询样式。您仍然可以使用这个更快的查询来[`IS NOT DISTINCT FROM`](https://www.postgresql.org/docs/current/functions-comparison.html#FUNCTIONS-COMPARISON-PRED-TABLE)代替`=`任何或所有比较，以使 NULL 比较相等。更多的：

*   [如何删除没有唯一标识符的重复行](https://stackoverflow.com/questions/26769454/how-to-delete-duplicate-rows-without-unique-identifier/26773018#26773018)

如果定义了所有被比较的列`NOT NULL`，则没有分歧的余地。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-09-10T16:17:13.937

您的查询的问题在于，当使用 GROUP BY 子句（实际上是通过使用 distinct）时，您只能使用分组依据或聚合函数的列。您不能使用列 id，因为可能存在不同的值。在您的情况下，由于 HAVING 子句，始终只有一个值，但大多数 RDBMS 都不够聪明，无法识别这一点。

但是，这应该可以工作（并且不需要加入）：

```
UPDATE sales
SET status='ACTIVE'
WHERE id IN (
  SELECT MIN(id) FROM sales
  GROUP BY saleprice, saledate
  HAVING COUNT(id) = 1
) 
```

您也可以使用 MAX 或 AVG 代替 MIN，如果只有一个匹配行，则使用返回列值的函数很重要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-01-31T08:52:09.597

如果您的 DBMS 不支持具有多个列的 distinct，如下所示：

```
select distinct(col1, col2) from table 
```

多选通常可以安全地执行如下：

```
select distinct * from (select col1, col2 from table ) as x 
```

因为这可以在大多数 DBMS 上工作，并且由于您避免了分组功能，因此预计这比按解决方案分组更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-13T07:56:09.033

我想从一列“GrondOfLucht”中选择不同的值，但它们应该按照“排序”列中给出的顺序进行排序。我无法使用仅获得一列的不同值

```
Select distinct GrondOfLucht,sortering
from CorWijzeVanAanleg
order by sortering 
```

它还将给出“sortering”列，因为“GrondOfLucht”和“sortering”不是唯一的，结果将是所有行。

使用 GROUP 按“sortering”给出的顺序选择“GrondOfLucht”的记录

```
SELECT        GrondOfLucht
FROM            dbo.CorWijzeVanAanleg
GROUP BY GrondOfLucht, sortering
ORDER BY MIN(sortering) 
```

# wcf - 如何在 1 个 Windows 服务中托管 2 个 WCF 服务？

> ID：54419
> 
> 赞同：8
> 
> 时间：2008-09-10T15:33:23.103
> 
> 标签：wcf, windows-services

我有一个 WCF 应用程序，它有两个服务，我试图使用 net.tcp 在单个 Windows 服务中托管它们。我可以很好地运行任何一个服务，但是一旦我尝试将它们都放在 Windows 服务中，只会加载第一个服务。我已经确定正在调用第二个服务 ctor，但 OnStart 永远不会触发。这告诉我 WCF 在加载第二个服务时发现了一些问题。

使用 net.tcp 我知道我需要打开端口共享并在服务器上启动端口共享服务。这一切似乎工作正常。我尝试将服务放在不同的 tcp 端口上，但仍然没有成功。

我的服务安装程序类如下所示：

```
 [RunInstaller(true)]
 public class ProjectInstaller : Installer
 {
      private ServiceProcessInstaller _process;
      private ServiceInstaller        _serviceAdmin;
      private ServiceInstaller        _servicePrint;

      public ProjectInstaller()
      {
            _process = new ServiceProcessInstaller();
            _process.Account = ServiceAccount.LocalSystem;

            _servicePrint = new ServiceInstaller();
            _servicePrint.ServiceName = "PrintingService";
            _servicePrint.StartType = ServiceStartMode.Automatic;

            _serviceAdmin = new ServiceInstaller();
            _serviceAdmin.ServiceName = "PrintingAdminService";
            _serviceAdmin.StartType = ServiceStartMode.Automatic;

            Installers.AddRange(new Installer[] { _process, _servicePrint, _serviceAdmin });
      }   
} 
```

两种服务看起来都非常相似

```
 class PrintService : ServiceBase
 {

      public ServiceHost _host = null;

      public PrintService()
      {
            ServiceName = "PCTSPrintingService";
            CanStop = true;
            AutoLog = true;

      }

      protected override void OnStart(string[] args)
      {
            if (_host != null) _host.Close();

            _host = new ServiceHost(typeof(Printing.ServiceImplementation.PrintingService));
            _host.Faulted += host_Faulted;

            _host.Open();
      }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T08:13:37.370

将您的服务基于此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms733069.aspx)并创建两个服务主机。但是，您可以将其分解为任意数量的类，而不是直接调用每个服务主机，这些类定义了您要运行的每个服务：

```
internal class MyWCFService1
{
    internal static System.ServiceModel.ServiceHost serviceHost = null;

    internal static void StartService()
    {
        if (serviceHost != null)
        {
            serviceHost.Close();
        }

        // Instantiate new ServiceHost.
        serviceHost = new System.ServiceModel.ServiceHost(typeof(MyService1));
        // Open myServiceHost.
        serviceHost.Open();
    }

    internal static void StopService()
    {
        if (serviceHost != null)
        {
            serviceHost.Close();
            serviceHost = null;
        }
    }
}; 
```

在 windows 服务主机的主体中，调用不同的类：

```
 // Start the Windows service.
    protected override void OnStart( string[] args )
    {
        // Call all the set up WCF services...
        MyWCFService1.StartService();
        //MyWCFService2.StartService();
        //MyWCFService3.StartService();

    } 
```

然后，您可以将任意数量的 WCF 服务添加到一个 Windows 服务主机。

记住也要调用 stop 方法....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-06T11:02:43.687

```
 Type serviceAServiceType = typeof(AfwConfigure);
            Type serviceAContractType = typeof(IAfwConfigure);

            Type serviceBServiceType = typeof(ConfigurationConsole);
            Type serviceBContractType = typeof(IConfigurationConsole);

            Type serviceCServiceType = typeof(ConfigurationAgent);
            Type serviceCContractType = typeof(IConfigurationAgent);

            ServiceHost serviceAHost = new ServiceHost(serviceAServiceType);
            ServiceHost serviceBHost = new ServiceHost(serviceBServiceType);
            ServiceHost serviceCHost = new ServiceHost(serviceCServiceType);
            Debug.WriteLine("Enter1");
            serviceAHost.Open();
            Debug.WriteLine("Enter2");
            serviceBHost.Open();
            Debug.WriteLine("Enter3");
            serviceCHost.Open();
            Debug.WriteLine("Opened!!!!!!!!!"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T21:37:51.523

如果您希望一个 Windows 服务启动两个 WCF 服务，您将需要一个具有两个 ServiceHost 实例的 ServiceInstaller，这两个实例都在（单个）OnStart 方法中启动。

当您选择在 Visual Studio 中创建新的 Windows 服务时，您可能希望遵循模板代码中的 ServiceInstaller 模式 - 通常这是一个很好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T15:35:20.697

您可能只需要 2 个服务主机。

_host1 和 _host2。

# design-patterns - 处理命令行参数的设计模式是什么

> ID：54421
> 
> 赞同：50
> 
> 时间：2008-09-10T15:33:49.890
> 
> 标签：design-patterns, command-line, arguments, language-agnostic

如果您正在编写一个可以从命令行执行的程序，您通常希望为用户提供多个选项或标志，以及可能不止一个参数。我已经绊倒了很多次，但是是否有某种设计模式用于循环 args 并调用适当的处理函数？

考虑：

```
myprogram -f filename -d directory -r regex 
```

使用语言的任何内置函数检索参数后，如何组织处理函数？（欢迎使用特定语言的答案，如果这有助于您表达答案）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-09-23T13:45:56.650

我认为以下答案更符合您的要求：

您应该考虑应用模板模式（“设计模式”中的模板方法 [Gamma, el al]）

简而言之，它的整体处理如下所示：

```
If the arguments to the program are valid then
    Do necessary pre-processing
    For every line in the input
        Do necessary input processing
    Do necessary post-processing
Otherwise
    Show the user a friendly usage message 
```

简而言之，实现一个包含以下方法的 ConsoleEngineBase 类：

```
PreProcess()
ProcessLine()
PostProcess()
Usage()
Main() 
```

然后创建一个机箱，实例化一个 ConsoleEngine() 实例并发送 Main() 消息以启动它。

要查看如何将其应用于控制台或命令行程序的一个很好的示例，请查看以下链接：http: [//msdn.microsoft.com/en-us/magazine/cc164014.aspx](http://msdn.microsoft.com/en-us/magazine/cc164014.aspx)

该示例使用 C# 编写，但这些想法很容易在任何其他环境中实现。

您会将 GetOpt() 视为适合参数处理（预处理）的部分。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-10T15:41:59.793

我不知道任何记录在案的处理“模式”。

我相信用于处理参数的最古老的库/API 之一是 getopt。谷歌搜索“getopt”显示了许多手册页和实现的链接。

通常，我的应用程序中有一个首选项或设置服务，参数处理器知道如何与之通信。然后将参数转换为该服务中的应用程序然后查询的内容。这可以像设置字典一样简单（例如名为“文件名”的字符串设置）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-10T15:44:19.270

您没有提到该语言，但对于 Java，我们喜欢[Apache Commons CLI](http://commons.apache.org/cli/)。对于 C/C++，getopt。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-10T16:04:36.897

好吧，它是一个旧帖子，但我仍然想贡献。该问题旨在选择设计模式，但是我可以看到很多关于使用哪个库的讨论。我已经按照 lindsay 查看了 microsoft 链接，该链接讨论了要使用的模板设计模式。

但是，我不相信这个职位。模板模式的目的是定义一个模板，该模板将由各种其他类实现以具有统一的行为。我不认为解析命令行适合它。

我宁愿选择“命令”设计模式。这种模式最适合菜单驱动的选项。

[http://www.blackwasp.co.uk/Command.aspx](http://www.blackwasp.co.uk/Command.aspx)

因此，在您的情况下，-f、-d 和 -r 都成为定义了通用或单独接收器的命令。这样以后可以定义更多的接收器。下一步将链接这些命令的职责，以防需要处理链。我会选择。

[http://www.blackwasp.co.uk/ChainOfResponsibility.aspx](http://www.blackwasp.co.uk/ChainOfResponsibility.aspx)

我想这两者的组合最好是组织命令行处理或任何菜单驱动方法的代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-16T22:39:52.187

对此的一些评论...

首先，虽然本身没有任何模式，但编写解析器本质上是一种机械练习，因为给定语法，可以轻松生成解析器。想到了 Bison 和 ANTLR 等工具。

也就是说，解析器生成器对于命令行来说通常是多余的。所以通常的模式是自己写一个（正如其他人已经证明的那样）几次，直到你厌倦了处理繁琐的细节并找到一个库来为你做。

我为 C++ 编写了一个，它节省了 getopt 赋予的大量工作并很好地利用了模板：[`TCLAP`](http://tclap.sourceforge.net)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T16:09:38.417

[boost::program_options](http://www.boost.org/doc/libs/1_36_0/doc/html/program_options.html)库非常适合使用C++ 并且可以使用 Boost。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T16:57:41.887

假设您有一个“配置”对象，您打算使用标志和一个合适的命令行解析器来设置该对象，该解析器负责解析命令行并提供恒定的选项流，这里有一段伪代码

```
while (current_argument = cli_parser_next()) {
    switch(current_argument) {
        case "f": //Parser strips the dashes
        case "force":
            config->force = true;
            break;
        case "d":
        case "delete":
            config->delete = true;
            break;
        //So on and so forth
        default:
            printUsage();
            exit;
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-10T18:04:59.463

我更喜欢“-t text”和“-i 44”之类的选项；我不喜欢“-fname”或“--very-long-argument=some_value”。

而“-?”、“-h”和“/h”都会产生帮助屏幕。

这是我的代码的外观：

```
int main (int argc, char *argv[])
   {  int i;
      char *Arg;
      int ParamX, ParamY;
      char *Text, *Primary;

   // Initialize...
   ParamX = 1;
   ParamY = 0;
   Text = NULL;
   Primary = NULL;

   // For each argument...
   for (i = 0; i < argc; i++)
      {
      // Get the next argument and see what it is
      Arg = argv[i];
      switch (Arg[0])
         {
         case '-':
         case '/':
            // It's an argument; which one?
            switch (Arg[1])
               {
               case '?':
               case 'h':
               case 'H':
                  // A cry for help
                  printf ("Usage:  whatever...\n\n");
                  return (0);
                  break;

               case 't':
               case 'T':
                  // Param T requires a value; is it there?
                  i++;
                  if (i >= argc)
                     {
                     printf ("Error:  missing value after '%s'.\n\n", Arg);
                     return (1);
                     }

                  // Just remember this
                  Text = Arg;

                  break;

               case 'x':
               case 'X':
                  // Param X requires a value; is it there?
                  i++;
                  if (i >= argc)
                     {
                     printf ("Error:  missing value after '%s'.\n\n", Arg);
                     return (1);
                     }

                  // The value is there; get it and convert it to an int (1..10)
                  Arg = argv[i];
                  ParamX = atoi (Arg);
                  if ((ParamX == 0) || (ParamX > 10))
                     {
                     printf ("Error:  invalid value for '%s'; must be between 1 and 10.\n\n", Arg);
                     return (1);
                     }

                  break;

               case 'y':
               case 'Y':
                  // Param Y doesn't expect a value after it
                  ParamY = 1;
                  break;

               default:
                  // Unexpected argument
                  printf ("Error:  unexpected parameter '%s'; type 'command -?' for help.\n\n", Arg);
                  return (1);
                  break;
               }

            break;

         default:
            // It's not a switch that begins with '-' or '/', so it's the primary option
            Primary = Arg;

            break;
         }
      }

   // Done
   return (0);
   } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-21T16:28:28.330

我正在重复 mes5k 的 ANTLR 答案。此[Codeproject 链接](http://www.codeproject.com/KB/recipes/sota_expression_evaluator.aspx)用于讨论 ANLTR 并使用访问模式来实现您希望应用程序执行的操作的文章。它写得很好，值得回顾。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-10T15:42:55.360

我建议使用命令行处理器库。[一些俄罗斯人](http://netcode.ru/dotnet/?lang=&katID=30&skatID=268&artID=7379)创造了一个像样的，但那里有很多。将为您节省一些时间，以便您可以专注于应用程序的目的，而不是解析命令行开关！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-10T15:51:41.063

Getopt 是唯一的方法。

[http://sourceforge.net/projects/cshapoptparse](http://sourceforge.net/projects/csharpoptparse)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-07-28T16:12:48.183

解释器模式怎么样？ [http://www.dofactory.com/net/interpreter-design-pattern](http://www.dofactory.com/net/interpreter-design-pattern)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-10T15:47:21.307

您没有为此提及一种语言，但如果您正在寻找一个非常好的围绕 getopt 的 Objective-C 包装器，那么 Dave Dribin 的 DDCLI 框架非常好。

[http://www.dribin.org/dave/blog/archives/2008/04/29/ddcli](http://www.dribin.org/dave/blog/archives/2008/04/29/ddcli)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-10T15:47:22.260

我在 perl 中使用[Getopts::std](http://perldoc.perl.org/Getopt/Std.html)和[Getopts::long以及 C 中的](http://perldoc.perl.org/Getopt/Long.html)[Getopt](http://www.gnu.org/software/libc/manual/html_node/Getopt.html#Getopt)函数。这标准化了参数的解析和格式。其他语言有不同的机制来处理这些。

希望这可以帮助

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-10T15:47:32.243

标准设计通常遵循 getopt 所做的，有许多语言的 getopt 库，.NET、python、C、Perl、PHP 等。

基本设计是有一个命令行解析器，它部分返回传递给循环检查的参数。

[这篇](http://www-128.ibm.com/developerworks/aix/library/au-unix-getopt.html)文章更详细地讨论了它。

# javascript - 通过 URL 将用户所在的 URL 提交给另一个进程的最简洁、最短的 Javascript 是什么？

> ID：54426
> 
> 赞同：2
> 
> 时间：2008-09-10T15:35:31.447
> 
> 标签：javascript, url, submission

就像 Delicious 提交书签一样，我想要一些标准的 JavaScript，我可以使用它来将任何访问过的 URL 提交到 3rd 方站点，如果这可能通过 URL 的话。建议？

例如，我一直在使用

```
javascript:void(location.href="http://www.yacktrack.com/home?query="+encodeURI(location.href)) 
```

到目前为止，但想知道是否有更复杂的东西我可以使用或更好的实践。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T15:45:59.003

您是否想要与 Delicious 小书签完全一样的东西（例如，用户主动单击以提交 URL 的东西）？如果是这样，您可能只需复制他们的代码并替换目标 URL：

```
javascript:(function(){
    location.href='http://example.com/your-script.php?url='+
    encodeURIComponent(window.location.href)+
    '&title='+encodeURIComponent(document.title)
})() 
```

您可能需要更改查询字符串名称等，以匹配您的脚本所期望的。

如果您想通过您的网站自动跟踪用户，这可能是不可能的。您需要使用 AJAX 请求 URL，但 Web 浏览器不允许 Javascript 在原始域之外发出请求。也许它是可能的`iframe`诡计。

**编辑：**约翰打败了我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T15:38:03.747

```
document.location = "http://url_submitting_to.com?query_string_param=" + window.location; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T16:04:45.183

另一种选择是这样的：

```
<form action="http://www.yacktrack.com/home" method="get" name="f">
  <input type="hidden" name="query" />
</form> 
```

那么你的javascript将是：

```
f.query.value=location.href; f.submit(); 
```

或者您可以将 [保存链接] 与提交结合起来，如下所示：

```
<form action="http://www.yacktrack.com/home" method="get" name="f" onsubmit="f.query.value=location.href;">
  <input type="hidden" name="query" />
  <input type="submit" name="Save Link" />
</form> 
```

如果您正在运行服务器端代码，则可以插入该位置，这样您就可以无 JavaScript：

```
<form action="http://www.yacktrack.com/home" method="get" name="f">
  <input type="hidden" name="query" value="<%=Response.Url%>" />
  <input type="submit" name="Save Link" />
</form> 
```

# wpf - 使用 DataBinding 从 TreeView 添加项目到 ListBox WPF

> ID：54440
> 
> 赞同：0
> 
> 时间：2008-09-10T15:37:24.903
> 
> 标签：wpf, data-binding, listbox, treeview

我想使用（如果可以使用）将所选项目从 中添加`TreeView`到`ListBox`控件中。`DataBinding``DataBinding`

```
<TreeView HorizontalAlignment="Left" 
          Margin="30,32,0,83" 
          Name="treeView1" 
          Width="133" >

</TreeView>
<ListBox VerticalAlignment="Top" 
         Margin="208,36,93,0" 
         Name="listBox1" 
         Height="196" >       
</ListBox> 
```

`TreeView`从页面后面的代码中填充一些虚拟数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-11T05:09:39.397

您可以使用 ElementName 绑定到元素，因此如果要将选定的树项绑定到 ListBox 的 ItemsSource：

```
ItemsSource="{Binding SelectedItem, ElementName=treeView1}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T16:52:36.330

我很确定这是可能的，因为 WPF 在数据绑定方面非常灵活，但我还没有完成那个特定的场景。

最近，我一直在关注 MSDN 博客中的[WPF 数据绑定常见问题解答](http://blogs.msdn.com/wpfsdk/archive/2006/10/19/wpf-basic-data-binding-faq.aspx)，它提供了许多可能会有所帮助的见解。

# javascript - 激进的 JavaScript 缓存

> ID：54475
> 
> 赞同：20
> 
> 时间：2008-09-10T15:46:58.877
> 
> 标签：javascript, caching

我遇到了一个问题，我对 HTML 文件中引用的一些 JavaScript 文件进行了更改，但浏览器看不到这些更改。它保留缓存在浏览器中的副本，即使 Web 服务器具有较新的版本。

直到我强制浏览器清除缓存，我才能看到更改。

这是网络服务器配置吗？我是否需要将我的 JavaScript 文件设置为从不缓存？我在[Google Web Toolkit](http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=FAQ_GWTApplicationFiles)中看到了一些有趣的技术，它们实际上在每次进行更新时都会创建一个**新**的JavaScript 文件名。我相信这是为了防止代理和浏览器保留旧版本的 JavaScript 文件具有相同的名称。

某处是否有最佳实践列表？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-10T15:49:34.250

我们将产品内部版本号附加到所有 Javascript（和 CSS 等）的末尾，如下所示：

```
<script src="MyScript.js?4.0.8243"> 
```

浏览器会忽略问号后的所有内容，但升级会导致一个新的 URL，这意味着缓存重新加载。

这还有一个额外的好处，即您可以设置表示“从不缓存！”的 HTTP 标头。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-10T16:08:14.597

> 它保留缓存在浏览器中的副本，即使 Web 服务器具有较新的版本。

这可能是因为设置了 HTTP Expires / Cache-Control 标头。

[http://developer.yahoo.com/performance/rules.html#expires](http://developer.yahoo.com/performance/rules.html#expires)

我在这里写了这个：

[http://www.codinghorror.com/blog/archives/000932.html](http://www.codinghorror.com/blog/archives/000932.html)

> 这本身并不是一个坏建议，但如果你弄错了，它可能会导致巨大的问题。例如，在 Microsoft 的 IIS 中，Expires 标头在默认情况下始终处于关闭状态，可能正是出于这个原因。通过在 HTTP 资源上设置 Expires 标头，您是在告诉客户端*永远不要检查该资源的新版本*——至少在 Expires 标头的到期日期之前不要检查。**当我说从不时，我是认真的——浏览器甚至不会*要求*新版本；它只是假设它的缓存版本很好，直到客户端清除缓存，或者缓存达到到期日期。**雅虎指出，当他们需要刷新这些资源时，他们会更改这些资源的文件名。
> 
> 您在这里真正节省的只是客户端 ping 服务器以获取新版本并在资源未更改的常见情况下获取 304 not modified 标头的成本。这不是太多开销.. 除非你是雅虎。当然，如果您有一组几乎从不更改的图像或脚本，请务必利用客户端缓存并打开 Cache-Control 标头。缓存对浏览器性能至关重要；每个 Web 开发人员都应该深入了解 HTTP 缓存的工作原理。但对于那些可以受益的特定文件夹或文件，只能以手术的、有限的方式使用它。对于其他任何事情，风险大于收益。这当然不是您希望将其作为整个网站的默认设置打开的东西。除非您喜欢在每次内容更改时更改文件名。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-10T15:56:45.793

@杰森和达伦

~~IE6~~将带有查询字符串的任何内容视为不可缓存。您应该找到另一种将版本号获取到 url 中的方法，例如假目录：

```
<script src="/js/version/MyScript.js"/> 
```

并在满足请求之前删除服务器端 js 之后的第一个目录级别。

编辑：对不起所有；它是 Squid，而不是 IE6，它不会使用查询字符串进行缓存。更多信息[在这里](http://www.stevesouders.com/blog/2008/08/23/revving-filenames-dont-use-querystring/)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-07-30T20:00:10.353

我写了一篇关于我们如何在这里克服这个问题的博客文章：

[避免 ASP.NET 中的 JavaScript 和 CSS 样式表缓存问题](http://solutionmania.com/2009/7/30/avoiding-javascript-and-css-stylesheet-caching-problems-in-asp.net)

基本上，在开发过程中，您可以在 CSS 文件的文件名之后向查询字符串添加一个随机数。当您进行发布构建时，代码会改为使用您的程序集的修订号。这意味着在您的生产环境中，您的客户端可以缓存样式表，但是每当您发布站点的新版本时，他们将被迫重新加载文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T15:48:29.947

我也只是重命名的方法。它永远不会失败，而且很容易做到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T15:51:28.317

您的网络服务器是否发送了正确的标头来告诉浏览器它有一个新版本？我之前也将日期添加到查询字符串中。即 myscripts.js?date=4/14/2008 12:45:03 （只有日期会被编码）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T16:03:28.477

在每次发布时，我们只需在所有静态资产的根路径前添加一个单调递增的整数，这会强制客户端重新加载（我们之前在 IE6 中看到过查询字符串方法中断）。例如：

*   第 1 版：http://www.foo.com/1/js/foo.js
*   第 2 版：http://www.foo.com/2/js/foo.js

它需要在每个版本中重新调整链接，但我们已经构建了自动将链接更改为我们的部署工具的功能。

完成此操作后，您可以使用 Expires/Cache-Control 标头，让客户端“永远”缓存 JS 资源，因为路径随每个版本而变化，我认为这是 @JasonCohen 的意思。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T16:08:55.763

即使您不打算使用 powershell 来自动部署，[这里](http://www.codeproject.com/KB/install/DeploySite.aspx)也有一些非常有用的技术。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-22T09:47:51.383

值得一提的是，我看到[deviantART](http://PhiLho.deviantART.com/ "deviantART：艺术与应用的结合！")网站，相当大的一个，将他们的 JS 文件作为 54504.js 提供服务。我刚刚检查并看到他们现在将它们用作 v6core.css?-5855446573 v6core_jc.js?4150339741 等。

如果查询字符串的问题来自服务器，我想你可以或多或少地控制它。

# sql - 如何在 SQL Server 数据库中列出用户定义的类型？

> ID：54482
> 
> 赞同：40
> 
> 时间：2008-09-10T15:48:21.803
> 
> 标签：sql, sql-server, tsql

我需要用 枚举在`SQL Server`数据库中创建的所有用户定义类型`CREATE TYPE`，和/或找出它们是否已经被定义。

对于表或存储过程，我会做这样的事情：

```
if exists (select * from dbo.sysobjects where name='foobar' and xtype='U')
    drop table foobar 
```

但是我找不到用户定义类型的等价物（或合适的替代品）！我绝对看不到他们在任何地方`sysobjects`。

任何人都可以启发我吗？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-09-10T15:53:12.230

类型和 UDT 不出现在 sys.objects 中。您应该能够通过以下方式获得所需的内容：

```
select * from sys.types
where is_user_defined = 1 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-07-21T21:22:08.470

虽然帖子很旧，但我发现使用类似的查询很有用。您可能不会发现某些格式有用，但我想要完全限定的类型名称，并且我想查看按顺序列出的列。您可以仅删除所有 SUBSTRING 内容以单独获取列名。

```
SELECT USER_NAME(TYPE.schema_id) + '.' + TYPE.name      AS "Type Name",
       COL.column_id,
       SUBSTRING(CAST(COL.column_id + 100 AS char(3)), 2, 2)  + ': ' + COL.name   AS "Column",
       ST.name                                          AS "Data Type",
       CASE COL.Is_Nullable
       WHEN 1 THEN ''
       ELSE        'NOT NULL' 
       END                                              AS "Nullable",
       COL.max_length                                   AS "Length",
       COL.[precision]                                  AS "Precision",
       COL.scale                                        AS "Scale",
       ST.collation                                     AS "Collation"
FROM sys.table_types TYPE
JOIN sys.columns     COL
    ON TYPE.type_table_object_id = COL.object_id
JOIN sys.systypes AS ST  
    ON ST.xtype = COL.system_type_id
where TYPE.is_user_defined = 1
ORDER BY "Type Name",
         COL.column_id 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-01-24T15:47:22.083

为了扩展 jwolly2 的答案，您可以通过以下方式获取定义列表，包括标准数据类型：

```
-- User Defined Type definitions TP 20180124
select t1.name, t2.name, t1.precision, t1.scale, t1.max_length as bytes, t1.is_nullable
from sys.types t1
join sys.types t2 on t2.system_type_id = t1.system_type_id and t2.is_user_defined = 0
where t1.is_user_defined = 1 and t2.name <> 'sysname'
order by t1.name 
```

# java - Java中的条件数字格式

> ID：54487
> 
> 赞同：5
> 
> 时间：2008-09-10T15:49:35.750
> 
> 标签：java, java1.4

如何在 Java 中格式化浮点数，以便仅当浮点组件不为零时才显示？例如：

```
123.45 -> 123.45
99.0 -> 99
23.2 -> 23.2
45.0 -> 45

```

编辑：我忘了提——我还在使用 Java 1.4——对不起！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T15:56:19.837

如果您使用[DecimalFormat](http://java.sun.com/j2se/1.4.2/docs/api/java/text/DecimalFormat.html)并在模式中指定 #，则它仅显示不为零的值。

请参阅我的问题[如何在 java 中格式化数字？](https://stackoverflow.com/questions/50532/how-do-i-format-a-number-in-java)

示例代码

```
 DecimalFormat format = new DecimalFormat("###.##");

    double[] doubles = {123.45, 99.0, 23.2, 45.0};
    for(int i=0;i<doubles.length;i++){
        System.out.println(format.format(doubles[i]));
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T15:57:48.957

查看[DecimalFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/DecimalFormat.html)类，例如 new DecimalFormat("0.##").format(99.0) 将返回“99”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T15:57:58.707

```
new Formatter().format( "%f", myFloat ) 
```

# postgresql - 在 PostgreSQL 中存储图像

> ID：54500
> 
> 赞同：128
> 
> 时间：2008-09-10T15:55:30.320
> 
> 标签：postgresql, image

好的，所以我正在开发一个应用程序，该应用程序将使用运行 PostgreSQL 的 Linux 后端向 Windows 机器提供图像，前端用 C#.NET 编写，尽管前端几乎不重要。我的问题是：

*   **处理在 Postgres 中存储图像的最佳方法是什么？**

这些图像每个大约 4-6 兆像素，我们存储的图像超过 3000 个。还需要注意的是：这不是一个 Web 应用程序，最多有大约两个前端同时访问数据库。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-04-22T11:51:00.483

更新到 2012 年，当我们看到图像大小和图像数量在所有应用程序中都在增长和增长时......

我们需要区分“原始图像”和“处理后的图像”，例如缩略图。

正如 Jcoby 的回答所说，我建议有两种选择：

*   使用*blob* (Binary Large OBject)：用于原始图像存储，在您的餐桌上。请参阅 Ivan 的回答（备份 blob 没问题！）、[PostgreSQL 附加提供的模块](https://www.postgresql.org/docs/current/lo.html)、[操作](https://stackoverflow.com/questions/4386030/)方法等。

*   使用带有[DBlink](https://www.postgresql.org/docs/current/dblink.html)的单独数据库：对于原始图像存储，在另一个（统一/专业）数据库中。在这种情况下，我更喜欢*bytea*，但*blob* 几乎相同。分离数据库是“统一图像Web服务”的最佳方式。

*   使用*bytea* (BYTE Array)：用于缓存缩略图。缓存小图像以将其快速发送到 Web 浏览器（以避免呈现问题）并减少服务器处理。缓存也是必不可少的元数据，例如宽度和高度。数据库缓存是最简单的方法，但请检查您的需求和服务器配置（例如 Apache 模块）：[将缩略图存储在文件系统中](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)可能会更好，比较性能。请记住，它是一个（统一的）网络服务，然后可以存储在一个单独的数据库中（没有备份），为许多表提供服务。另请参阅[PostgreSQL 二进制数据类型手册](https://www.postgresql.org/docs/current/datatype-binary.html)、[使用 bytea 列](https://dba.stackexchange.com/questions/1742/how-to-insert-file-data-into-a-postgresql-bytea-column)的测试等。

注意1：今天不推荐使用[“双重解决方案”（数据库+文件系统）](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)（！）。使用“仅数据库”而不是双重的有很多优点。PostgreSQL 具有相当的性能和良好的导出/导入/输入/输出工具。

注意 2：请记住 PostgreSQL 只有*bytea*，没有默认 Oracle 的*BLOB*：“SQL 标准定义 (...) BLOB。输入格式与 bytea 不同，但提供的函数和运算符基本相同”，[手册](https://www.postgresql.org/docs/current/datatype-binary.html)。

* * *

编辑**2014**：我今天没有更改上面的原文（我的回答是 2012 年 4 月 22 日，现在有 14 票），*我正在为您的更改打开答案* （请参阅“Wiki 模式”，您可以编辑！），用于[校对](https://en.wikipedia.org/wiki/Proofreading)和**更新**。
问题是稳定的（@Ivans 的 08 年回答 19 票），请帮助改进此文本。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-09-19T06:21:26.677

Re jcoby 的回答：

bytea 是一个“正常”列也意味着当您获取它时该值被完全读入内存。相比之下，Blob 可以流式传输到标准输出。这有助于减少服务器内存占用。特别是当您存储 4-6 个 MPix 图像时。

备份 blob 没问题。pg_dump 提供“-b”选项以将大对象包含到备份中。

所以，我更喜欢使用 pg_lo_*，你可能猜到了。

重新克里斯埃里克森的回答：

我会说相反的:)。当图像不是您存储的唯一数据时，除非绝对必须，否则不要将它们存储在文件系统上。始终确保您的数据一致性并将数据“整合”（数据库）是非常有好处的。顺便说一句，PostgreSQL 在保持一致性方面非常出色。

然而，确实，现实通常对性能要求太高了 ;-)，它促使您从文件系统中提供二进制文件。但即便如此，我还是倾向于将数据库用作二进制文件的“主”存储，所有其他关系始终链接在一起，同时提供一些基于文件系统的缓存机制来优化性能。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-09-10T16:09:32.440

在数据库中，有两个选项：

*   拜茶。将数据存储在列中，作为备份的一部分导出。使用标准数据库函数来保存和检索。推荐用于您的需求。
*   斑点。将数据存储在外部，通常不作为备份的一部分导出。需要特殊的数据库功能来保存和检索。

过去，我使用 bytea 列非常成功地存储了 10+gb 的数千行图像。PG 的 TOAST 功能几乎否定了 blob 的任何优势。无论哪种情况，您都需要为文件名、内容类型、尺寸等包含元数据列。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2015-06-01T05:09:27.583

**快速更新至 2015 年中期：**

您可以使用**Postgres Foreign Data 接口**，将文件存储在更合适的数据库中。例如，将文件放在属于 MongoDB 的 GridFS 中。然后使用 [https://github.com/EnterpriseDB/mongo_fdw](https://github.com/EnterpriseDB/mongo_fdw) 在 Postgres 中访问它。

这样做的好处是，您可以在 Postrgres 和 MongoDB 中访问/读取/写入/备份它，这取决于您的灵活性。

**还有用于文件系统的外部数据包装器：** [https ://wiki.postgresql.org/wiki/Foreign_data_wrappers#File_Wrappers](https://wiki.postgresql.org/wiki/Foreign_data_wrappers#File_Wrappers)

作为一个例子，你可以使用这个： [https](https://multicorn.readthedocs.org/en/latest/foreign-data-wrappers/fsfdw.html) ://multicorn.readthedocs.org/en/latest/foreign-data-wrappers/fsfdw.html （见这里的简要使用示例）

这为您提供了一致性的优势（所有链接的文件肯定都存在）和所有其他 ACID，而实际文件系统上仍然存在，这意味着您可以使用任何您想要的文件系统并且网络服务器可以直接为它们提供服务（操作系统缓存也适用）。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2008-09-10T16:18:17.210

**10 年后的更新** 在 2008 年，运行数据库的硬盘与存储文件的磁盘相比，具有不同的特性和更高的成本。现在有更好的解决方案来存储 10 年前不存在的文件，我会撤销这个建议并建议读者查看这个线程中的其他一些答案。

**原来的**

除非绝对必要，否则不要将图像存储在数据库中。我知道这不是一个 Web 应用程序，但如果没有共享文件位置，您可以指向将文件的位置保存在数据库中。

```
//linuxserver/images/imagexxx.jpg 
```

那么也许您可以快速设置一个网络服务器并将网络 URL 存储在数据库中（以及本地路径）。虽然数据库可以处理 LOB 和 3000 张图像（4-6 兆像素，假设 500K 图像），但 1.5 Gigs 的空间并不多，文件系统比数据库更适合存储大文件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-10T16:11:00.190

试试[这个](http://jdbc.postgresql.org/documentation/80/binary-data.html)。我使用大对象二进制 (LOB) 格式将生成的 PDF 文档存储在数据库中，其中一些文档的大小超过 10 MB，而且效果非常好。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-10-04T03:11:47.620

如果您的图像很小，请考虑将它们以 base64 格式存储在纯文本字段中。

原因是虽然 base64 的开销为 33%，但压缩大部分消失了。（请参阅[Base64 编码的空间开销是多少？](https://lemire.me/blog/2019/01/30/what-is-the-space-overhead-of-base64-encoding/)）您的数据库会更大，但您的网络服务器发送给客户端的数据包不会更大。在 html 中，您可以在 <img src=""> 标记中内联 base64，这可能会简化您的应用程序，因为您不必在单独的浏览器获取中将图像作为二进制文件提供。当您必须发送/接收 json 时，将图像作为文本处理也可以简化事情，这不能很好地处理二进制文件。

是的，我知道您可以将二进制文件存储在数据库中，并在进出数据库的过程中将其转换为文本，但有时 ORM 会带来麻烦。像所有其他字段一样将其视为纯文本会更简单。

这绝对是处理缩略图的正确方法。

（OP的图像不小，所以这并不是他问题的真正答案。）

# .net - linux下.net应用程序的问题，不适用于shell脚本

> ID：54503
> 
> 赞同：1
> 
> 时间：2008-09-10T15:56:33.297
> 
> 标签：.net, linux, svn, mono

我正在开发一个 .net 提交后挂钩，以通过他们的 Soap SDK 将数据输入 OnTime。我的钩子在 Windows 上工作得很好，但在我们的生产 RHEL4 颠覆服务器上，当从 shell 脚本调用时它不会工作。

```
#!/bin/sh
/usr/bin/mono $1/hooks/post-commit.exe "$@"

```

当我从命令行使用参数执行它时，它可以正常工作。当通过 shell 脚本执行时，我收到以下错误：（看起来我用来获取修订日志数据的 SVN 的进程执行存在一些问题）：

```
未处理的异常：System.InvalidOperationException：进程必须退出才能获取请求的信息。
  在 System.Diagnostics.Process.get_ExitCode () [0x0003f] 在 /tmp/monobuild/build/BUILD/mono-1.9.1/mcs/class/System/System.Diagnostics/Process.cs:149
  在 (wrapper remoting-invoke-with-check) System.Diagnostics.Process:get_ExitCode ()
  在 SVNLib.SVN.Execute（System.String sCMD、System.String sParams、System.String sComment、System.String sUserPwd、SVNLib.SVNCallback 回调）[0x00000]
  在 SVNLib.SVN.Log (System.String sUrl, Int32 nRevLow, Int32 nRevHigh, SVNLib.SVNCallback 回调) [0x00000]
  在 SVNLib.SVN.LogAsString (System.String sUrl, Int32 nRevLow, Int32 nRevHigh) [0x00000]
  在 SVNCommit2OnTime.Program.Main (System.String[] args) [0x00000]

```

我尝试使用`mkbundle`and`mkbundle2`制作一个可以命名的独立设备`post-commit`，但我收到一条不同的错误消息：

```
未处理的异常：System.ArgumentNullException：参数不能为空。
参数名称：值不能为空。
  在 System.Guid.CheckNull (System.Object o) [0x00000]
  在 System.Guid..ctor (System.String g) [0x00000]
  在 SVNCommit2OnTime.Program.Main (System.String[] args) [0x00000]

```

任何想法为什么它可能会从 shell 脚本失败或捆绑版本可能有什么问题？

**编辑：** [@Herms](https://stackoverflow.com/questions/54503/problem-with-net-app-under-linux-doesnt-work-from-shell-script#54537)，我已经用回声试过了，看起来不错。至于`$1/hooks/post-commit.exe`.net 程序集，我已经尝试了带有和不带有 .net 程序集的完整路径的脚本，结果相同。

**编辑：** [@Leon](https://stackoverflow.com/questions/54503/problem-with-net-app-under-linux-doesnt-work-from-shell-script#54545)，我都试过了`$1 $2`，`"$@"`结果都一样。它是一个颠覆后提交挂钩，它需要两个参数，因此需要将这些参数传递给 .net 程序集。这`"$@"`是 mono 站点推荐的从 shell 脚本调用 .net 程序集的方法。shell 脚本*正在*执行 .net 程序集并使用正确的参数，但它抛出了一个异常，该异常在直接从命令行运行时不会抛出。

**编辑：** [@Vinko](https://stackoverflow.com/questions/54503/problem-with-net-app-under-linux-doesnt-work-from-shell-script#54568)，除了`BASH_LINENO`和`BASH_SOURCE`

**编辑：** [@Luke](https://stackoverflow.com/questions/54503/problem-with-net-app-under-linux-doesnt-work-from-shell-script#54818)，我累了，但这也没什么区别。我首先在我的机器上从 TortoiseSVN 测试时注意到了这个问题（当它作为 subversion 守护进程的子进程运行时），但也发现从 hooks 目录执行脚本时我得到了相同的结果（即`./post-commit REPOS REV`，在`post-commit`哪里上面的 sh 脚本。`mono post-commit.exe REPOS REV`工作正常。主要问题是要执行，我需要有一些名称`post-commit`以便调用它。但它不能从 shell 脚本工作，如上所述，`mkbundle`它不起作用有不同的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T17:47:13.413

某些进程在关闭其标准输出后会挂起一段时间是正常的（即，您会从它们那里读取文件结尾）。您需要`proc.WaitForExit()`在读取所有数据后但在检查 ExitCode 之前调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T16:07:59.277

只是一个可能有助于调试的随机想法。尝试将您的 shell 脚本更改为：

```
#!/bin/sh
echo /usr/bin/mono $1/hooks/post-commit.exe "$@" 
```

检查并查看它打印的行是否与您期望它运行的命令匹配。您在 shell 脚本中处理的命令行参数可能没有按照您的意愿进行。

我不知道您对脚本的预期输入是什么，但路径前的 $1 对我来说有点不合适。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T16:10:17.227

你确定你想做

```
/usr/bin/mono $1/hooks/post-commit.exe "$@"
```

$@ 扩展到所有参数。"$@" 扩展到所有由空格连接的参数。我怀疑你的shell脚本不正确。您没有确切说明您希望脚本做什么，所以这确实限制了我们提出建议的可能性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T16:20:39.060

比较 shell 和脚本中的环境变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T17:43:30.483

尝试将“cd $1/hooks/”放在运行单声道的行之前。您可能在该文件夹中有一些程序集，当您从 shell 中的该文件夹运行单声道时可以找到这些程序集，但在运行脚本时找不到这些程序集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T19:38:04.733

在验证了我的代码*确实*可以从命令行运行后，我发现它不再工作了！我查看了我的 .net 代码，看看是否有任何意义。

这是我所拥有的：

```
        静态公共 int 执行（字符串 sCMD，字符串 sParams，字符串 sComment，
                                  字符串 sUserPwd，SVNCallback 回调）
        {
            System.Diagnostics.Process proc = new System.Diagnostics.Process();
            proc.EnableRaisingEvents = false;
            proc.StartInfo.RedirectStandardOutput = true;
            proc.StartInfo.CreateNoWindow = true;
            proc.StartInfo.UseShellExecute = false;
            proc.StartInfo.Verb = "打开";
            proc.StartInfo.FileName = "svn";
            proc.StartInfo.Arguments = Cmd(sCMD, sParams, sComment, UserPass());
            proc.Start();
            诠释 nLine = 0;
            字符串 sLine = "";
            而 ((sLine = proc.StandardOutput.ReadLine()) != null)
            {
                ++n线；
                如果（回调！= null）
                {
                    callback.Invoke(nLine, sLine);
                }
            }
            int errorCode = proc.ExitCode;
            proc.Close();
            返回错误代码；
        }

```

我改变了这个：

```
            而（！proc.HasExited）
            {
                sLine = proc.StandardOutput.ReadLine();
                如果（sLine！= null）
                {
                    ++n线；
                    如果（回调！= null）
                    {
                        callback.Invoke(nLine, sLine);
                    }
                }
            }
            int errorCode = proc.ExitCode;

```

看起来进程比我得到输出的时间长了一点，因此`proc.ExitCode`抛出了一个错误。

# winapi - 为 WinXP、Vista 编写注册表调用/文件系统调用/进程创建过滤器的最佳实践是什么？

> ID：54504
> 
> 赞同：1
> 
> 时间：2008-09-10T15:56:38.120
> 
> 标签：winapi, drivers

我们需要监控系统中的所有进程注册表调用/文件系统调用/进程创建（针对防病毒臀部模块）。

此外，有时还需要延迟或拒绝某些呼叫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T16:36:55.853

支持的方法是[RegNotifyChangeKeyValue](http://msdn.microsoft.com/en-us/library/ms724892.aspx)

大多数病毒检查程序可能会执行某种 API 挂钩，而不是使用此函数。有很多关于 API 挂钩的信息，例如[http://www.codeproject.com/KB/system/hooksys.aspx](http://www.codeproject.com/KB/system/hooksys.aspx)、[http://www.codeguru.com/cpp/wp/system/misc/article.php /c5667](http://www.codeguru.com/cpp/w-p/system/misc/article.php/c5667)

# sql - 我应该如何将短文本字符串存储到 SQL Server 数据库中？

> ID：54512
> 
> 赞同：13
> 
> 时间：2008-09-10T15:58:05.417
> 
> 标签：sql, sql-server, database, database-design

varchar(255)、varchar(256)、nvarchar(255)、nvarchar(256)、nvarchar(max) 等？

256 似乎是一个不错的、圆形的、节省空间的数字。但我见过 255 用了很多。为什么？

varchar 和 nvarchar 有什么区别？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-15T14:24:34.803

在 MS SQL Server（7.0 及更高版本）中，varchar 数据在内部最多用三个值表示：

*   实际的字符串，从 0 到超过 8000 字节（它基于页面大小、为该行存储的其他列以及其他一些因素）
*   两个字节用于指示数据字符串的长度（产生从 0 到 8000+ 的值）
*   如果该列可以为空，则该行的空位掩码中的一位（因此最多八个可空列的空状态可以用一个字节表示）

重要的部分是两字节数据长度指示符。如果是一个字节，则只能正确记录长度为 0 到 255 的字符串；使用两个字节，您可以记录长度为 0 到超过 64000+（特别是 2^16 -1）的字符串。但是，SQL Server 页面长度为 8k，这就是 8000+ 字符限制的来源。（SQL 2005 中有数据溢出的东西，但如果你的字符串会那么长，你应该使用 varchar(max)。）

因此，无论您将 varchar 数据类型列声明为 (15, 127, 511) 多长时间，您实际上将为每一行存储的内容是：

*   2个字节表示字符串有多长
*   实际字符串，即该字符串中的字符数

这让我明白了：许多旧系统仅使用 1 个字节来存储字符串长度，这将您的最大长度限制为 255 个字符，这并不是那么长。使用 2 个字节，您就没有这样的任意限制......所以我建议选择一个对（假定非技术导向的）用户有意义的数字。，我喜欢 50、100、250、500，甚至 1000。考虑到 8000+ 字节的存储空间，255 或 256 与 200 或 250 一样有效，但在向最终用户解释事情时效率*较低*.

这适用于单字节数据（即 ansii、SQL_Latin1 * *_* *General_CP1 等）。如果您必须使用不同的字母存储多个代码页或语言的数据，则需要使用 nvarchar 数据类型（我认为它的工作方式相同，两个字节表示字符数，但每个实际的数据字符需要两个字节存储）。如果您的字符串可能超过 8000，或者在 nvarchar 中超过 4000，您将需要使用 [n]varchar(max) 数据类型。

如果你想知道为什么用额外的字节占用空间来跟踪数据的长度如此重要，请查看[http://www.joelonsoftware.com/articles/fog0000000319.html](http://www.joelonsoftware.com/articles/fog0000000319.html)

菲利普

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-10T15:59:41.573

VARCHAR(255)。它不会使用所有 255 个字符的存储空间，只使用您需要的存储空间。它是 255 而不是 256，因为这样你就有 255 加上空终止符（或大小字节）的空间。

“N”代表 Unicode。如果您期望非 ASCII 字符，请使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-11T02:49:26.833

在定义 char/varchar 和 N 变体时，还有其他几点需要考虑。

首先，在数据库中存储可变长度字符串会产生一些开销。一个好的一般经验法则是对长度小于 10 个字符的字符串使用 CHAR，因为 N/VARCHAR 存储字符串和长度，并且在 N/CHAR 与 N/VARCHAR 中存储*短*字符串之间的差异在 10 以下不是值得字符串长度的开销。

其次，SQL server 中的表存储在 8KB 页上，因此该行数据的最大大小为 8060 字节（另外 192 字节用于 SQL 的开销）。这就是 SQL 允许 VARCHAR(8000) 和 NVARCHAR(4000) 的最大定义列的原因。现在，您*可以*使用 VARCHAR(MAX) 和 unicode 版本。但可能会有额外的开销与此相关。

如果我没记错的话，SQL Server 会尝试将数据存储在与行的其余部分相同的页面上，但是，如果您尝试将太多数据放入 VARCHAR(Max) 列，它会将其视为二进制和将其存储在另一个页面上。

CHAR 和 VARCHAR 之间的另一个重大区别与页面拆分有关。鉴于 SQL Server 将数据存储在 8KB 页面中，您可以在一个页面上存储任意数量的数据行。如果您*UPDATE* VARCHAR 列的值足够大以至于该行不再适合页面，则服务器将*拆分*该页面，移走一些记录。如果数据库没有可用页并且数据库设置为自动增长，则服务器将首先增长数据库以为其分配空白页，然后将空白页分配给表，最后将单个页一分为二。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-10T15:58:45.150

如果您将支持英语以外的语言，您将需要使用 nvarchar。

HTML 应该没问题，只要它包含标准的 ASCII 字符。我主要在支持多语言的数据库中使用 nvarchar。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-10T16:05:27.443

因为 1 个字节中有**8 位**，所以在 1 个字节中您可以存储多达 256 个不同的值，即

```
0 1 2 3 4 5 ... 255 
```

请注意，第一个数字是 0，所以总共有**256**个数字。

因此，如果您使用 nvarchar(255) 它将使用**1 个字节来存储字符串的长度**，但是如果您翻倒 1 并使用 nvarchar(256) ，那么您将浪费 1 个字节*，只是*为了从255（因为您需要**2 个字节来存储数字 256**）。

这可能不是 SQL Server 的实际实现，但我相信这是将事物限制在 255 超过 256 项的典型原因。

**nvarchar**用于 Unicode ，每个字符使用 2+ 个字节，而
**varchar**用于仅使用 1 个字节的普通 ASCII 文本

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T16:00:23.257

IIRC，255 是 MySQL 中 varchar 在您必须切换到文本数据类型之前的最大大小，或者在某个时候（实际上，我认为它现在更高）。因此，将其保持在 255 可能会为您带来一些兼容性。不过，在采取行动之前，您需要先查看一下。

varchar vs nvarchar 有点像 ascii vs unicode。varchar 限制为每个字符一个字节，nvarchar 可以使用两个。这就是为什么你可以有一个 varchar(8000) 但只有一个 nvarchar(4000)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T16:04:42.453

varchar 和 nvarchar 都会根据内容自动调整大小，但您在声明列类型时定义的数字是最大值。

“nvarchar”中的值占用两倍于“varchar”的磁盘/内存空间，因为 unicode 是双字节的，但是当您声明列类型时，您声明的是字符数，而不是字节数。

因此，当您定义列类型时，您应该确定该列需要保存的最大字符数并将其作为 varchar（或 nvarchar）大小。

一个好的经验法则是估计列需要保持的最大字符串长度，然后添加对大约 10% 更多字符的支持，以避免将来出现意外长数据的问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-15T13:05:27.583

varchar(255) 也是 SQL Server 7.0 及更早版本中的最大长度。

# c# - 在 C# .Net 3.5 SP1 中将数据打印到预打印表单中

> ID：54522
> 
> 赞同：3
> 
> 时间：2008-09-10T16:01:23.397
> 
> 标签：c#, .net, printing

我需要将数据打印成预先打印的 A6 表格（横向 A4 尺寸的 1/4）。我不需要打印文本段落，只是散落在页面上的短行。

MSDN 上的所有内容都是关于打印文本段落。

感谢您提供的任何帮助，罗伯托

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T16:04:43.683

您必须创建一个 PrintDocument 对象，至少处理 PrintPage 事件并将适当的更改应用于 PrinterSettings 属性。

在您的 PrintPage 事件处理程序中，对 PringPageEventArgs.Graphics 对象执行您需要执行的任何操作；比如画线、画图等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T16:10:05.373

查找用于将新文本与预打印间隙对齐的 x,y 坐标时，图形对象的 Draw____() 函数的默认设置为每英寸 100 像素。这可能会根据您的打印机而有所变化，但在我（非常有限的）经验中，情况一直如此。

# windows - win32 GUI 应用程序，以“app.exe --help”调用时将使用文本写入标准输出

> ID：54536
> 
> 赞同：23
> 
> 时间：2008-09-10T16:07:58.607
> 
> 标签：windows

如何创建执行以下操作的 Windows 应用程序：

*   在没有命令行参数的情况下调用它是一个常规的 GUI 应用程序
*   指定可选的“--help”命令行参数会导致应用程序将使用文本写入标准输出然后终止
*   它必须是单个可执行文件。通过使控制台应用程序 exec 成为第二个可执行文件，不会作弊。
*   假设主要应用程序代码是用 C/C++ 编写的
*   如果在指定“--help”时没有创建 GUI 窗口，则可以加分。（即，短暂的窗口没有闪烁）

根据我的经验，控制台应用程序的标准 Visual Studio 模板没有 GUI 功能，并且普通的 win32 模板不会将其标准输出发送到父 cmd shell。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-22T03:26:14.397

微软将控制台和 GUI 应用程序设计为互斥的。这种短视意味着没有完美的解决方案。最流行的方法是拥有两个可执行文件（例如 cscript / wscript、java / javaw、devenv.com / devenv.exe 等），但是您已经表明您认为这是“作弊”。

您有两个选择 - 制作“控制台可执行文件”或“gui 可执行文件”，然后使用代码尝试提供其他行为。

*   图形用户界面可执行文件：

`cmd.exe`将假定您的程序没有控制台 I/O，因此在继续之前不会等待它终止，这在交互模式下（即不是批处理）意味着显示下一个（“ `C:\>`”）提示并从键盘读取。因此，即使您使用 AttachConsole，您的输出也会与`cmd`' 的输出混合，如果您尝试输入，情况会变得更糟。这基本上是一个非首发。

*   控制台可执行文件：

与想象相反，没有什么可以阻止控制台可执行文件显示 GUI，但有两个问题。

第一个是，如果您从不带参数的命令行运行它（所以您需要 GUI）， `cmd`仍然会等待它终止，然后再继续，因此特定控制台在此期间将无法使用。这可以通过启动同一可执行文件的第二个进程来克服（您认为这是作弊吗？），将 DETACHED_PROCESS 标志传递给 CreateProcess() 并立即退出。然后，新进程可以检测到它没有控制台并显示 GUI。

下面是说明这种方法的 C 代码：

```
#include <stdio.h>
#include <windows.h>

int main(int argc, char *argv[])
{
    if (GetStdHandle(STD_OUTPUT_HANDLE) == 0) // no console, we must be the child process
    {
        MessageBox(0, "Hello GUI world!", "", 0);
    }
    else if (argc > 1) // we have command line args
    {
        printf("Hello console world!\n");
    }
    else // no command line args but a console - launch child process
    {
        DWORD dwCreationFlags = CREATE_DEFAULT_ERROR_MODE | DETACHED_PROCESS;
        STARTUPINFO startinfo;
        PROCESS_INFORMATION procinfo;
        ZeroMemory(&startinfo, sizeof(startinfo));
        startinfo.cb = sizeof(startinfo);
        if (!CreateProcess(NULL, argv[0], NULL, NULL, FALSE, dwCreationFlags, NULL, NULL, &startinfo, &procinfo))
            MessageBox(0, "CreateProcess() failed :(", "", 0);
    }
    exit(0);
} 
```

我用 cygwin 的 gcc - YMMV 和 MSVC 编译它。

第二个问题是，当从资源管理器运行时，您的程序会在瞬间显示一个控制台窗口。没有编程方式解决这个问题，因为控制台是在应用程序启动时由 Windows 创建的，在它开始执行之前。您唯一能做的就是，在您的安装程序中，使用 SW_HIDE（即 0）的“显示命令”创建程序的快捷方式。这只会影响控制台，除非您在程序中故意尊重 STARTUPINFO 的 wShowWindow 字段，所以不要这样做。

我已经通过破解 cygwin 的“mkshortcut.exe”对此进行了测试。如何在您选择的安装程序中完成它取决于您。

当然，用户仍然可以通过在资源管理器中找到可执行文件并双击它来运行您的程序，绕过隐藏控制台的快捷方式并看到控制台窗口的短暂黑色闪烁。你对此无能为力。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-09-28T17:30:25.177

您可以使用[`AllocConsole()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944(v=vs.85).aspx)WinApi 函数为 GUI 应用程序分配控制台。您还可以尝试使用 附加到父进程的控制台，[`AttachConsole()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681952(v=vs.85).aspx)如果它已经有一个，这是有道理的。重定向到此控制台的完整代码将如下所示`stdout`：`stderr`

```
if(AttachConsole(ATTACH_PARENT_PROCESS) || AllocConsole()){
    freopen("CONOUT$", "w", stdout);
    freopen("CONOUT$", "w", stderr);
} 
```

我在[Pidgin](https://www.pidgin.im/)源代码中找到了这种方法（参见`WinMain()`pidgin/win32/winpidgin.c）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-08T13:57:27.437

我知道我的答案来晚了，但我认为这里情况的首选技术是“.com”和“.exe”方法。

根据您对两个可执行文件的定义，这可能被认为是“作弊”，但它只需要对程序员部分进行很少的更改，并且可以完成一个并忘记。此外，此解决方案没有 Hugh 解决方案的缺点，您可以在瞬间显示控制台窗口。

在 Windows 命令行中，如果您运行程序但未指定扩展名，则查找可执行文件的优先顺序将优先选择 .com 而非 .exe。

然后，您可以使用技巧让“.com”成为 stdin/stdout/stderr 的代理并启动同名的 .exe 文件。这给出了允许程序在从控制台调用时以命令行模式执行的行为（可能仅在检测到某些命令行参数时），同时仍然能够作为没有控制台的 GUI 应用程序启动。

有各种文章对此进行了描述，例如“如何将应用程序同时作为 GUI 和控制台应用程序？” （请参阅下面链接中的参考资料）。

我在 google 代码上托管了一个名为[dualsubsystem](http://code.google.com/p/dualsubsystem/ "双子系统")的项目，该项目更新了该技术的旧 codeguru 解决方案，并提供了源代码和工作示例二进制文件。

我希望这会有所帮助！

# javascript - 防止使用后退按钮（在 IE 中）

> ID：54539
> 
> 赞同：12
> 
> 时间：2008-09-10T16:08:24.563
> 
> 标签：javascript, internet-explorer, back-button

因此，我目前工作地点的中小企业想要尝试禁用某些页面的后退按钮。我们有一个页面，用户在其中进行一些选择并提交它们以进行处理。在某些情况下，他们必须在另一个页面上输入评论。

用户发现，如果他们提交信息并转到带有评论的页面然后点击返回按钮返回上一页，他们就不必输入评论。

我知道对此有几种不同的解决方案（其中许多比禁用后退按钮要优雅得多），但这就是我剩下的。是否可以通过更改后退按钮的行为来防止某人返回上一页。（就像提交 - > 返回错误排序的东西）。

由于重复发布信息，我无法让它返回上一页然后移动到当前页面。我只能让它不直接远离当前页面。我用谷歌搜索了它，但我只看到帖子说它总是会回到上一页。我希望有人有一些疯狂的 kung foo js 技能可以使这成为可能。

我知道每个人都说这是一个坏主意，我同意，但有时你只需要按照别人告诉你的去做。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-10T16:23:11.720

不要这样做，只是不要。这是糟糕的界面设计，并迫使用户的浏览器以他们不期望的方式运行。

我认为任何成功阻止我的后退按钮工作的脚本都是黑客攻击，我希望 IE 团队会为它发布安全修复程序。

后退按钮是他们程序界面的一部分，而不是您的网站。

在您的具体情况下，我认为最好的办法是在页面上添加一个卸载事件，如果用户没有完成表单，则警告用户。后退按钮不受影响，用户将被警告他们的操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T16:22:40.460

不，你注定要失败。即使您在其他浏览器中弹出页面并隐藏后退按钮，也总是有 Backspace 键。

营销人员和分析师类型的问题在于，他们中的一些人不了解网络无状态的基本概念。他们不明白页面完全、完全不知道浏览器在使用它，并且对浏览器的绝对控制完全超出了网页的能力。

阻止用户点击后退按钮的最佳方法是确保您的页面在他们按下后退时丢失*所有*数据，例如，评论页面是唯一可以保存数据的点，如果他们确实按下了后退按钮，他们必须重新做*所有事情*（按照 pragma: nocache 的思路思考）。

用户肯定会抱怨，但他们是这个被遗弃的要求存在的原因，对吧？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T16:21:04.440

我以前见过这个：

```
window.onBack = history.forward(); 
```

这绝对是一个肮脏的黑客，如果可能的话，我会尽量不禁用后退按钮。用户可能仍然可以很容易地绕过它。并且取决于缓存，不知道是否会处理服务器代码，或者是否会首先运行带有 JavaScript 的缓存页面。

所以，是的，使用风险自负:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-04T09:20:51.517

我想出了一个小技巧，可以使用 JavaScript 禁用后退按钮。我在 chrome 10、firefox 3.6 和 IE9 上检查了它：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<title>Untitled Page</title>
<script type = "text/javascript" >
function changeHashOnLoad() {
     window.location.href += "#";
     setTimeout("changeHashAgain()", "50"); 
}

function changeHashAgain() {
  window.location.href += "1";
}
// If you want to skip the auto-positioning at the top of browser window,you can add the below code:
window.location.hash=' ';
var storedHash = window.location.hash;
window.setInterval(function () {
    if (window.location.hash != storedHash) {
         window.location.hash = storedHash;
    }
}, 50);

</script>
</head>
<body onload="changeHashOnLoad(); ">
Try to hit the back button!
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-10T16:18:03.857

您有权访问服务器端源代码吗？如果是这样，如果信息已经提交，您可以检查重定向到第二页的第一页（显然，您需要为此使用会话）。在以前的工作中，这就是我们处理多步申请（申请与接受申请一样）的方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T16:16:21.643

您能否将评论移至上一页并使其成为必填字段？

禁用后退按钮**将不起作用。**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T16:19:40.653

由于浏览器中 javascript 的安全隔离，您无法更改后退按钮的功能。

也许您可以在用户会话中存储一些指示需要评论的内容，并让用户尝试加载的应用程序中的任何页面重定向到评论页面？

如果用户在进入评论页面时关闭浏览器怎么办？

我知道你在这里没有选择，但因为他们要求的似乎是不可能的......

也许在用户输入评论之前，您不能认为该项目已完成。因此，您需要同时跟踪正在进行的项目和已完成的项目，并在 UI 中进行区分，但这可能是最可靠的方法。

或者只是将评论字段放在表单页面上？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-10T16:42:44.187

> 用户发现，如果他们提交信息并转到带有评论的页面然后点击返回按钮返回上一页，他们就不必输入评论。

然后他们可能也足够聪明，可以在评论字段中输入*“无评论” 。*

您可以尝试强迫人们添加评论，但您可能最终会得到糟糕的无法使用的软件，惹恼用户，并且仍然无法获得评论。这通常是退后一步并从用户的角度重新考虑您在做什么的好时机。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-16T15:35:08.763

您应该保护您的应用程序免受双重提交，而不是破坏用户界面来隐藏错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-10T16:14:51.833

禁用后退按钮似乎是一种“蛮力”方法。

另一种选择是您可以跳出没有命令按钮的模式对话框，引导用户完成工作流程，并在流程完成后关闭对话框。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-10T16:19:26.893

根本没有可靠的方法来做到这一点。您不能保证 100% 的时间可以阻止用户这样做。

考虑到这一点，是否值得采用极其奇特的解决方案来禁用“大部分”时间？那是你来决定的。

祝你好运。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-06T01:29:23.143

作为一个简单的解决方案：试试这个。在其中插入一个更新面板和一个按钮，并使用 javascript 隐藏它，然后在页面加载时按下它。是的，我知道它会导致您的页面在加载时重新发布，并且如果禁用 javascript 可能无法正常工作，但肯定会帮助您对后退按钮问题做出一半体面的响应。安迪

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-29T19:43:05.663

您可以阻止他们返回上一页。`location.replace()`用新页面替换当前页面的历史条目，所以...

page1.html：用户点击指向 page2.html 的链接

page2.html：用户点击链接调用`location.replace('page3.html');`

page3.html：用户单击返回按钮并转到 page1.html

这可能不适合进行 POST，但您可以通过 AJAX 将数据发布到 Web 服务，然后调用 location.replace()

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-06-02T08:53:22.910

如果您从头开始一个新的 Web 应用程序，或者您有足够的时间来重新设计您的应用程序，您可以使用 JavaScript 和 AJAX 来避免浏览器的历史记录、后退和前进功能。

*   在登录之前或之后立即在新窗口中打开您的应用程序。
*   如果您愿意，可以使用窗口选项隐藏导航栏（使用后退和前进按钮）。
*   对所有服务器请求使用 AJAX，而无需更改窗口的位置 URL。
*   使用简单的 Web API 获取数据并执行操作，并使用 JavaScript 呈现应用程序。
*   窗口的历史记录中只有一个 URL。
*   后退和前进按钮什么也不做。
*   该窗口可以在注销时自动关闭。
*   浏览器历史记录不会泄露任何信息，这有助于提高安全性。

这种技术回答了这个问题，但它在几个方面也与最佳实践相矛盾：

*   后退和前进按钮应按预期运行。
*   应用程序不应打开新的浏览器窗口。
*   一个应用程序应该在没有 JavaScript 的情况下仍然可以运行。

在使用此技术之前，请仔细考虑您的要求和您的用户。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-10-17T12:16:59.940

我没有看到这个解决方案：

```
function removeBack(){
	window.location.hash="nbb";
	window.location.hash="";
	window.onhashchange=function(){window.location.hash="";}
}
```

# .net - 如何表明依赖程序集的多个版本都可以？

> ID：54546
> 
> 赞同：3
> 
> 时间：2008-09-10T16:10:35.433
> 
> 标签：.net, versioning

程序集 A 和 B 是私有部署和强命名的。程序集 A 包含对程序集 B 的引用。程序集 B 有两个版本：B1 和 B2。我希望能够为程序集 A 指示它可以绑定到 B1 或 B2——理想情况下，通过将此信息合并到程序集本身中。我有哪些选择？

我对版本控制策略及其应用于 GAC 的方式有些熟悉，但我不想依赖 GAC 中的这些程序集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-11T00:32:11.997

有几个地方可以向 .Net 框架表明，强类型库的特定版本应该优先于另一个版本。这些都是：

*   出版商政策文件
*   machine.config 文件
*   app.config 文件

所有这些方法都使用[“<bindingRedirect>”](http://msdn.microsoft.com/en-us/library/eftw1fys.aspx ".NET Framework 一般参考 - <bindingRedirect> 元素")元素，该元素可以指示 .Net Framework 将程序集的一个版本或一系列版本绑定到特定版本。

以下是用于将 2.0 版之前的所有版本的程序集绑定到 2.5 版的标签的简短示例：

```
<assemblyBinding>
    <dependantAssembly>
        <assemblyIdentity name="foo" publicKeyToken="00000000000" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0 - 2.0.0.0" newVersion="2.5.0.0" />
    </dependantAssembly>
</assemblyBinding> 
```

有很多细节，所以最好阅读[MSDN 上的 Redirecting Assembly Versions](http://msdn.microsoft.com/en-us/library/7wd6ex19.aspx ".NET Framework 开发人员指南 - 重定向程序集版本")来决定哪种方法最适合您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T16:14:37.513

您可以在 app.config 文件中设置版本策略。或者，您可以手动加载这些程序集，并在完成时调用`Assembly.LoadFrom()`不考虑程序集版本。

# php - 调用非对象的成员函数

> ID：54566
> 
> 赞同：78
> 
> 时间：2008-09-10T16:19:57.267
> 
> 标签：php

所以我正在重构我的代码以实现更多的 OOP。我设置了一个类来保存页面属性。

```
class PageAtrributes 
{
  private $db_connection;
  private $page_title;

    public function __construct($db_connection) 
    {
        $this->db_connection = $db_connection;
        $this->page_title = '';
    }

    public function get_page_title()
    {
        return $this->page_title;
    }

    public function set_page_title($page_title)
    {
        $this->page_title = $page_title;
    }
} 
```

稍后我像这样调用 set_page_title() 函数

```
function page_properties($objPortal) {    
    $objPage->set_page_title($myrow['title']);
} 
```

当我这样做时，我收到错误消息：

> 在非对象上调用成员函数 set_page_title()

那么我错过了什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-10T16:21:28.027

这意味着它`$objPage`不是对象的实例。我们能看到你用来初始化变量的代码吗？

正如您期望特定的对象类型一样，您还可以利用[PHP 的类型提示功能^(*Docs*)](http://php.net/manual/en/functions.arguments.php#functions.arguments.type-declaration)在您的逻辑被违反时获取错误：

```
function page_properties(PageAtrributes $objPortal) {    
    ...
    $objPage->set_page_title($myrow['title']);
} 
```

这个函数只接受`PageAtrributes`第一个参数。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-10-24T19:03:25.673

有一种简单的方法可以产生此错误：

```
 $joe = null;
    $joe->anything(); 
```

将呈现错误：

> `anything()`致命错误：在第 23 行的 /Applications/XAMPP/xamppfiles/htdocs/casMail/dao/server.php 中调用非对象的成员函数

**如果PHP**只是说，那就更好了，

> 致命错误：未定义来自 Joe 的调用，因为 (a) joe 为空或 (b) joe 未`anything()`在 <##> 行中定义。

通常你已经构建了你的类，所以它`$joe`没有在构造函数中定义或

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-02T09:46:36.747

要么`$objPage`不是实例变量，要么你正在`$objPage`用不是 class 实例的东西覆盖`PageAttributes`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-28T19:02:56.400

这也可能意味着当您初始化对象时，您可能在代码的另一部分中重新使用了对象名称。因此将它的方面从对象更改为标准变量。

IE

```
$game = new game;

$game->doGameStuff($gameReturn);

foreach($gameArray as $game)
{
   $game['STUFF']; // No longer an object and is now a standard variable pointer for $game.
}

$game->doGameStuff($gameReturn);  // Wont work because $game is declared as a standard variable.  You need to be careful when using common variable names and were they are declared in your code. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-08T16:46:47.040

我推荐上面接受的答案。但是，如果您处于紧要关头，您可以在**page_properties**函数中将该对象声明为全局对象。

```
$objPage = new PageAtrributes;

function page_properties() {
    global $objPage;
    $objPage->set_page_title($myrow['title']);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-20T09:53:59.360

```
function page_properties($objPortal) {    
    $objPage->set_page_title($myrow['title']);
} 
```

看起来像变量 $objPortal 与 $objPage 的不同名称

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T16:26:44.600

我意识到我没有将**$objPage**传递给**page_properties()**。它现在工作正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-04T09:47:17.677

您可以在下面的示例中使用“使用”

```
function page_properties($objPortal) use($objPage){    
    $objPage->set_page_title($myrow['title']);
} 
```

# java - 如何让 InputVerifier 与可编辑的 JComboBox 一起工作

> ID：54567
> 
> 赞同：3
> 
> 时间：2008-09-10T16:20:21.167
> 
> 标签：java, swing, jcombobox

当设置为可编辑时，我有`JComboBox`一个自定义设置来限制 MaxLength。`inputVerifyer`

verify 方法似乎永远不会被调用。
罚款时调用相同的验证器`JTextField`。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-10T17:38:35.067

我找到了解决方法。我想我会让下一个有这个问题的人知道。

基本上。而不是在 ComboBox 上设置 inputVerifier，而是将其设置为“编辑器组件”。

```
JComboBox combo = new JComboBox();
JTextField tf = (JTextField)(combo.getEditor().getEditorComponent());
tf.setInputVerifier(verifyer); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T16:40:48.293

向我们展示您的代码的一小部分。

```
package inputverifier;

import javax.swing.*;

    class Go {
    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() { public void run() {
            runEDT();
        }});
    }
    private static void runEDT() {
        new JFrame("combo thing") {{
            setLayout(new java.awt.GridLayout(2, 1));
            add(new JComboBox() {{
                setEditable(true);
                setInputVerifier(new InputVerifier() {
                    @Override public boolean verify(JComponent input) {
                        System.err.println("Hi!");
                        return true;
                    }
                });
            }});
            add(new JTextField());
            setDefaultCloseOperation(EXIT_ON_CLOSE);
            pack();
            setVisible(true);
        }};
    }    
} 
```

[看起来 JComboBox 是一个复合组件是一个问题。](http://bugs.sun.com)我建议避免使用这种讨厌的 UI 解决方案。

# windows - 如何捕获“pnputil.exe -e”的输出

> ID：54578
> 
> 赞同：3
> 
> 时间：2008-09-10T16:23:47.663
> 
> 标签：windows

如何捕获“%windir%/system32/pnputil.exe -e”的输出？（假设 windows vista 32 位）

额外的技术解释为什么应用程序通常将输出写入 cmd shell，但是当 stdout 和/或 stderr 被重定向时，应用程序不会向控制台或 stdout/stderr 写入任何内容？

```
C:\Windows\System32>PnPutil.exe --help
Microsoft PnP 实用程序 {...}

C:\Windows\System32>pnputil -e > c:\foo.txt

C:\Windows\System32>键入 c:\foo.txt

C:\Windows\System32>目录 c:\foo.txt
 驱动器 C 中的卷没有标签。
 卷序列号为 XXXX-XXXX

 c:\ 目录

2008 年 9 月 10 日下午 12:10 0 foo.txt
               1 文件 0 字节

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T16:56:12.873

我想我找到了为什么它会以这种方式运行的技术答案。WriteConsole 的 MSDN 页面说，将标准输出重定向到文件会导致 WriteConsole 失败，应该改用 WriteFile。调试器确认 pnputil.exe 确实调用了 kernel32!WriteConsoleW 和 kernel32!WriteConsoleInputW。

嗯，我应该把这个作为两个单独的问题来问。

我仍在寻找如何从该命令中抓取输出的答案。接受的答案将是回答这部分问题的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T17:58:39.167

似乎根本没有简单的方法。您将不得不开始挂钩对 WriteConsole 的调用并转储字符串缓冲区。有关类似讨论，请参阅[此帖子。](http://objectmix.com/tcl/366746-autoexpect-under-windows-later-mac-linux.html#post1359780)

当然，如果这是一次性的交互式使用，那么只需从命令窗口中选择所有输出并将其复制到剪贴板。（确保您的 cmd 窗口缓冲区足够大以存储所有输出）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-16T13:14:04.837

如果您知道驱动程序名称并拥有驱动程序，pnputil.exe -ad:\pnpdriver*.inf

这为您正在寻找的驱动程序提供了相应的 oemXX.inf 列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T16:32:19.187

编写了一些应用程序，以便它可以很好地在管道场景中工作，例如

```
svn status | find "? " 
```

是一个管道输出的命令，`svn status`因此`find "? "`它会将颠覆输出过滤到我的存储库中的未知文件（标有问号）。

想象一下，如果 svn status 也会输出一个标题，上面写着“版权？2009”那个非常具体的标题行也会出现。这*不是*我所期望的。

所以某些工具，比如 Sysinternals 的工具，*只有*在直接打印到命令窗口时才会写入任何头信息，如果检测到任何类型的重定向，那么这些头信息将不会按照上述原因写入。

在管道/自动化场景中使用时，标题信息会变成噪音。

我想如果你不能`>`用来输出到文件，那是因为该工具被硬连线不这样做。你需要一种间接的方法来捕捉它。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T16:41:17.030

正如问题中提到的，但没有明确说明，“pnputil -e 2> c:\foo.txt”也没有预期的结果。这个没有将任何内容定向到文件中，但它确实将输出发送到控制台。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T16:51:50.247

只有两个输出流。如果 "> c:\foo.txt" 不起作用，并且 "2> C:\foo.txt" 不起作用，则不会输出任何内容。

您可以将标准错误合并到标准输出中（2>&1），因此所有输出都通过标准输出：

pnputil -e 1>c:\foo.txt 2>&1

如果这没有向 foo.txt 输出任何内容，则 pnputil 必须检测重定向并停止输出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T12:46:24.487

你可以尝试让 Windows 的 Expect 来做这种事情，它会告诉工具有一个控制台，并为你挂钩 WriteConsole 调用。 [期待 Windows](http://docs.activestate.com/activetcl/8.5/expect4win/welcome.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-16T19:12:54.270

点击系统菜单图标（左上角->属性->布局）

更改屏幕缓冲区大小

分类

pnputil -e

;-P

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-17T18:36:16.277

所以我正在寻找相同类型的信息，并遇到了这个： [https](https://sysadminstricks.com/tricks/windows-tricks/cleaning-up-windows-driver-store-folder.html) ://sysadminstricks.com/tricks/windows-tricks/cleaning-up-windows-driver-store-folder.html 。虽然语法错误，但它似乎对我有用（稍加修正）：

```
pnputil.exe -e > c:\driveroutput.txt 
```

执行该命令时，它不会*输出*到命令行，但会生成`driveroutput.txt`到`C:`. 事实上，打开文本文件确实表明我现在在我的 PC 上获得了枚举的 OEM 驱动程序的输出。

# wcf - 没有配置文件的 WCF 配置

> ID：54579
> 
> 赞同：90
> 
> 时间：2008-09-10T16:25:29.267
> 
> 标签：wcf, configuration, configuration-files

有谁知道如何在不使用配置文件的情况下以编程方式公开 WCF 服务的一个很好的例子？我知道现在使用 WCF 服务对象模型更加丰富，所以我知道这是可能的。我只是没有看到如何做到这一点的例子。相反，我想看看没有配置文件的消耗是如何完成的。

在任何人问之前，我有一个非常具体的需要在没有配置文件的情况下执行此操作。我通常不会推荐这种做法，但正如我所说，在这种情况下有一个非常具体的需求。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2008-11-15T17:43:06.027

正如我所发现的，使用没有配置文件的 Web 服务非常简单。您只需创建一个绑定对象和地址对象，并将它们传递给客户端代理的构造函数或通用 ChannelFactory 实例。您可以查看默认的 app.config 以查看要使用的设置，然后在某处创建一个静态辅助方法来实例化您的代理：

```
internal static MyServiceSoapClient CreateWebServiceInstance() {
    BasicHttpBinding binding = new BasicHttpBinding();
    // I think most (or all) of these are defaults--I just copied them from app.config:
    binding.SendTimeout = TimeSpan.FromMinutes( 1 );
    binding.OpenTimeout = TimeSpan.FromMinutes( 1 );
    binding.CloseTimeout = TimeSpan.FromMinutes( 1 );
    binding.ReceiveTimeout = TimeSpan.FromMinutes( 10 );
    binding.AllowCookies = false;
    binding.BypassProxyOnLocal = false;
    binding.HostNameComparisonMode = HostNameComparisonMode.StrongWildcard;
    binding.MessageEncoding = WSMessageEncoding.Text;
    binding.TextEncoding = System.Text.Encoding.UTF8;
    binding.TransferMode = TransferMode.Buffered;
    binding.UseDefaultWebProxy = true;
    return new MyServiceSoapClient( binding, new EndpointAddress( "http://www.mysite.com/MyService.asmx" ) );
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-02-26T21:49:02.807

如果您有兴趣消除 web.config 中用于 IIS 托管的 System.ServiceModel 部分的使用，我已在此处发布了如何执行此操作的示例 ( [http://bejabbers2.blogspot.com/2010/02/wcf -zero-config-in-net-35-part-ii.html](http://bejabbers2.blogspot.com/2010/02/wcf-zero-config-in-net-35-part-ii.html)）。我将展示如何自定义 ServiceHost 以创建元数据和 wshttpbinding 端点。我以一种不需要额外编码的通用方式进行操作。对于那些没有立即升级到 .NET 4.0 的人来说，这可能非常方便。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-01-19T11:17:34.903

在这里，这是完整且有效的代码。我想这会对你有很大帮助。我一直在搜索，但从未找到完整的代码，这就是我试图放置完整且有效的代码的原因。祝你好运。

```
public class ValidatorClass
{
    WSHttpBinding BindingConfig;
    EndpointIdentity DNSIdentity;
    Uri URI;
    ContractDescription ConfDescription;

    public ValidatorClass()
    {  
        // In constructor initializing configuration elements by code
        BindingConfig = ValidatorClass.ConfigBinding();
        DNSIdentity = ValidatorClass.ConfigEndPoint();
        URI = ValidatorClass.ConfigURI();
        ConfDescription = ValidatorClass.ConfigContractDescription();
    }

    public void MainOperation()
    {
         var Address = new EndpointAddress(URI, DNSIdentity);
         var Client = new EvalServiceClient(BindingConfig, Address);
         Client.ClientCredentials.ServiceCertificate.Authentication.CertificateValidationMode = X509CertificateValidationMode.PeerTrust;
         Client.Endpoint.Contract = ConfDescription;
         Client.ClientCredentials.UserName.UserName = "companyUserName";
         Client.ClientCredentials.UserName.Password = "companyPassword";
         Client.Open();

         string CatchData = Client.CallServiceMethod();

         Client.Close();
    }

    public static WSHttpBinding ConfigBinding()
    {
        // ----- Programmatic definition of the SomeService Binding -----
        var wsHttpBinding = new WSHttpBinding();

        wsHttpBinding.Name = "BindingName";
        wsHttpBinding.CloseTimeout = TimeSpan.FromMinutes(1);
        wsHttpBinding.OpenTimeout = TimeSpan.FromMinutes(1);
        wsHttpBinding.ReceiveTimeout = TimeSpan.FromMinutes(10);
        wsHttpBinding.SendTimeout = TimeSpan.FromMinutes(1);
        wsHttpBinding.BypassProxyOnLocal = false;
        wsHttpBinding.TransactionFlow = false;
        wsHttpBinding.HostNameComparisonMode = HostNameComparisonMode.StrongWildcard;
        wsHttpBinding.MaxBufferPoolSize = 524288;
        wsHttpBinding.MaxReceivedMessageSize = 65536;
        wsHttpBinding.MessageEncoding = WSMessageEncoding.Text;
        wsHttpBinding.TextEncoding = Encoding.UTF8;
        wsHttpBinding.UseDefaultWebProxy = true;
        wsHttpBinding.AllowCookies = false;

        wsHttpBinding.ReaderQuotas.MaxDepth = 32;
        wsHttpBinding.ReaderQuotas.MaxArrayLength = 16384;
        wsHttpBinding.ReaderQuotas.MaxStringContentLength = 8192;
        wsHttpBinding.ReaderQuotas.MaxBytesPerRead = 4096;
        wsHttpBinding.ReaderQuotas.MaxNameTableCharCount = 16384;

        wsHttpBinding.ReliableSession.Ordered = true;
        wsHttpBinding.ReliableSession.InactivityTimeout = TimeSpan.FromMinutes(10);
        wsHttpBinding.ReliableSession.Enabled = false;

        wsHttpBinding.Security.Mode = SecurityMode.Message;
        wsHttpBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;
        wsHttpBinding.Security.Transport.ProxyCredentialType = HttpProxyCredentialType.None;
        wsHttpBinding.Security.Transport.Realm = "";

        wsHttpBinding.Security.Message.NegotiateServiceCredential = true;
        wsHttpBinding.Security.Message.ClientCredentialType = MessageCredentialType.UserName;
        wsHttpBinding.Security.Message.AlgorithmSuite = System.ServiceModel.Security.SecurityAlgorithmSuite.Basic256;
        // ----------- End Programmatic definition of the SomeServiceServiceBinding --------------

        return wsHttpBinding;

    }

    public static Uri ConfigURI()
    {
        // ----- Programmatic definition of the Service URI configuration -----
        Uri URI = new Uri("http://localhost:8732/Design_Time_Addresses/TestWcfServiceLibrary/EvalService/");

        return URI;
    }

    public static EndpointIdentity ConfigEndPoint()
    {
        // ----- Programmatic definition of the Service EndPointIdentitiy configuration -----
        EndpointIdentity DNSIdentity = EndpointIdentity.CreateDnsIdentity("tempCert");

        return DNSIdentity;
    }

    public static ContractDescription ConfigContractDescription()
    {
        // ----- Programmatic definition of the Service ContractDescription Binding -----
        ContractDescription Contract = ContractDescription.GetContract(typeof(IEvalService), typeof(EvalServiceClient));

        return Contract;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-10T16:28:09.417

[服务器端](http://blogs.msdn.com/drnick/archive/2006/12/04/overriding-the-default-configuration-file.aspx)不容易..

对于客户端，您可以使用[ChannelFactory](http://msdn.microsoft.com/en-us/library/ms734681.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-11T11:27:49.800

所有 WCF 配置都可以通过编程方式完成。所以可以在没有配置文件的情况下创建服务器和客户端。

我推荐 Juval Lowy 的《Programming WCF Services》一书，其中包含许多编程配置的示例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-21T21:57:15.050

我发现以下链接中围绕该主题的博客文章非常有趣。

我喜欢的一个想法是，能够将配置中的绑定或行为或地址 XML 部分传递给适当的 WCF 对象，并让它处理属性的分配——目前你不能这样做。

像网络上的其他人一样，我遇到了需要我的 WCF 实现使用与我的托管应用程序（这是一个 .NET 2.0 Windows 服务）不同的配置文件的问题。

[http://salvoz.com/blog/2007/12/09/programmatically-setting-wcf-configuration/](http://salvoz.com/blog/2007/12/09/programmatically-setting-wcf-configuration/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-21T22:24:13.550

在客户端和服务器端都非常容易做到。Juval Lowy 的书中有很好的例子。

至于您对配置文件的评论，我想说配置文件是穷人在代码中做的第二个。当您控制将连接到您的服务器的每个客户端并确保它们已更新并且用户无法找到它们并进行任何更改时，配置文件非常棒。我发现 WCF 配置文件模型受到限制，设计起来有点困难，而且是维护的噩梦。总而言之，我认为 MS 将配置文件作为默认的处理方式是一个非常糟糕的决定。

编辑：您不能使用配置文件做的一件事是使用非默认构造函数创建服务。这会导致 WCF 中出现静态/全局变量和单例以及其他类型的无意义。

# c++ - 什么时候应该在 C++ 中使用类和结构？

> ID：54585
> 
> 赞同：1145
> 
> 时间：2008-09-10T16:29:54.217
> 
> 标签：c++, oop, class, struct, ooad

在什么情况下在 C++中使用 a `struct`vs a更好？`class`

* * *

## 回答 #1

> 赞同：981
> 
> 时间：2008-09-10T16:35:23.003

C++ 中的 a`class`和 a的区别在于：`struct`

*   `struct`成员和基类/结构是`public`默认的。
*   `class` 默认情况下，成员和基类/支柱`private`。

类和结构都可以混合使用和成员`public`，可以使用继承并且可以具有成员函数。`protected``private`

我会推荐你​​：

*   用于`struct`没有任何类特征的普通旧数据结构；
*   在使用or成员、非默认构造函数和运算符等`class`特性时使用。`private``protected`

* * *

## 回答 #2

> 赞同：270
> 
> 时间：2009-07-28T04:02:20.127

正如其他人所指出的那样，实际上只有两个实际的语言差异：

*   `struct`默认为公共访问，`class`默认为私有访问。
*   继承时，`struct`默认为`public`继承，`class`默认为`private`继承。（具有讽刺意味的是，与 C++ 中的许多东西一样，默认值是向后的：`public`继承是迄今为止更常见的选择，但人们很少声明`struct`s 只是为了节省键入“ `public`”关键字的时间。

但实践中真正的区别在于声明构造函数`class`/`struct`析构函数的 / 和不声明构造函数/析构函数的 / 之间。“plain-old-data” POD 类型有一定的保证，一旦你接管了类的构造，这些保证就不再适用了。为了清楚区分，许多人故意只将`struct`s 用于 POD 类型，如果他们要添加任何方法，请使用`class`es。下面两个片段之间的区别在其他方面没有意义：

```
class X
{
  public:

  // ...
};

struct X
{
  // ...
}; 
```

（顺便说一句，这里有一个线程对“POD 类型”的实际含义进行了一些很好的解释：[什么是 C++ 中的 POD 类型？](https://stackoverflow.com/questions/146452/what-are-pod-types-in-c)）

* * *

## 回答 #3

> 赞同：236
> 
> 时间：2016-04-28T14:17:34.947

现有答案中有很多误解。

[**两者都`class`声明`struct`一个类。**](https://stackoverflow.com/a/34108140/560648)

是的，您可能必须在类定义中重新排列访问修改关键字，具体取决于您用于声明类的关键字。

但是，除了语法之外，选择其中之一的*唯一*原因是约定/风格/偏好。

有些人喜欢为没有成员函数的类坚持使用`struct`关键字，因为生成的定义“看起来像”来自 C 的简单结构。

类似地，有些人喜欢`class`为具有成员函数和数据的类使用关键字`private`，因为它上面写着“类”，因此看起来像是他们最喜欢的面向对象编程书籍中的示例。

现实情况是，这完全取决于您和您的团队，它对您的程序没有任何影响。

以下两个类除了它们的名称外，在各方面都是绝对等价的：

```
struct Foo
{
   int x;
};

class Bar
{
public:
   int x;
}; 
```

您甚至可以在重新声明时切换关键字：

```
class Foo;
struct Bar; 
```

（尽管[这会由于不符合而破坏 Visual Studio 构建](https://stackoverflow.com/q/33483623/560648)，因此编译器会在您执行此操作时发出警告。）

并且以下表达式的计算结果都为真：

```
std::is_class<Foo>::value
std::is_class<Bar>::value 
```

*但请注意，重新定义*时不能切换关键字；这仅仅是因为（根据单一定义规则）跨翻译单元的重复类定义必须*“由相同的标记序列组成”*。这意味着您甚至不能`const int member;`与交换，并且与or`int const member;`的语义无关。`class``struct`

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2008-09-10T18:08:44.230

我唯一一次使用结构而不是类是在函数调用中使用它之前声明一个仿函数并且为了清楚起见而希望最小化语法。例如：

```
struct Compare { bool operator() { ... } };
std::sort(collection.begin(), collection.end(), Compare()); 
```

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2009-07-28T04:07:46.200

来自[C++ FAQ Lite](http://www.faqs.org/faqs/C++-faq/part4/)：

> 结构的成员和基类默认是公共的，而在类中，它们默认是私有的。注意：您应该明确地使您的基类公开、私有或受保护，而不是依赖默认值。
> 
> struct 和 class 在其他方面在功能上是等效的。
> 
> 好的，足够干净的技术谈话了。从情感上讲，大多数开发人员在类和结构之间做出了强烈的区分。结构感觉就像是一堆开放的位，封装或功能的方式很少。一个类感觉就像是一个活生生的、负责任的社会成员，具有智能服务、强大的封装屏障和定义明确的接口。由于这是大多数人已经拥有的含义，因此如果您的类具有很少的方法并且具有公共数据（这样的事情确实存在于设计良好的系统中！），您可能应该使用 struct 关键字，否则您可能应该使用该类关键词。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-09-10T16:43:01.253

结构对我有帮助的一个地方是当我有一个系统从另一个系统接收固定格式的消息（比如说，一个串行端口）时。您可以将字节流转换为定义字段的结构，然后轻松访问这些字段。

```
typedef struct
{
    int messageId;
    int messageCounter;
    int messageData;
} tMessageType;

void processMessage(unsigned char *rawMessage)
{
    tMessageType *messageFields = (tMessageType *)rawMessage;
    printf("MessageId is %d\n", messageFields->messageId);
} 
```

显然，这与您在 C 中所做的相同，但我发现必须将消息解码为类的开销通常不值得。

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2009-10-27T01:50:38.970

如果您正在编写一个内部为 C++ 但 API 可以由 C 或 C++ 代码调用的库，则可以在 C++ 中使用“struct”。您只需创建一个包含结构和全局 API 函数的标头，您可以将它们公开给 C 和 C++ 代码，如下所示：

```
// C access Header to a C++ library
#ifdef __cpp
extern "C" {
#endif

// Put your C struct's here
struct foo
{
    ...
};
// NOTE: the typedef is used because C does not automatically generate
// a typedef with the same name as a struct like C++.
typedef struct foo foo;

// Put your C API functions here
void bar(foo *fun);

#ifdef __cpp
}
#endif 
```

然后，您可以使用 C++ 代码在 C++ 文件中编写函数 bar() 并使其可从 C 调用，并且两个世界可以通过声明的结构共享数据。当然，在混合 C 和 C++ 时还有其他注意事项，但这是一个简化的示例。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2009-07-28T16:13:06.173

正如每个人所说，唯一真正的区别是默认访问。但是当我不希望使用简单的数据类进行任何形式的封装时，我特别使用 struct，即使我实现了一些辅助方法。例如，当我需要这样的东西时：

```
struct myvec {
    int x;
    int y;
    int z;

    int length() {return x+y+z;}
}; 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-09-10T16:36:00.037

对于 C++，结构和类之间确实没有太大区别。主要的功能区别是结构的成员默认是公共的，而它们在类中默认是私有的。否则，就语言而言，它们是等价的。

也就是说，我倾向于在 C++ 中使用结构，就像在 C# 中一样，类似于 Brian 所说的。结构体是简单的数据容器，而类用于除了保持数据之外还需要对数据进行操作的对象。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-09-10T16:50:18.130

回答我自己的问题（无耻），如前所述，访问权限是 C++ 中它们之间的唯一区别。

我倾向于仅将结构用于数据存储。如果它可以更轻松地处理数据，我将允许它获得一些辅助函数。然而，一旦数据需要流控制（即维护或保护内部状态的 getter/setter）或开始获取任何主要功能（基本上更像对象），它将“升级”到一个类以更好地传达意图。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2008-09-10T17:46:48.837

当您为 C++ 实现提供与 C 兼容的接口时，结构（更一般地说是[POD ）很方便，因为它们可以跨语言边界和链接器格式移植。](http://www.fnal.gov/docs/working-groups/fpcltf/Pkg/ISOcxx/doc/POD.html)

如果这不是您关心的问题，那么我认为使用“结构”而不是“类”是一个很好的意图沟通者（正如上面的@ZeroSignal 所说）。结构还具有更可预测的复制语义，因此它们对于您打算写入外部媒体或通过网络发送的数据很有用。

结构体对于各种元编程任务也很方便，比如仅仅暴露一堆依赖类型定义的特征模板：

```
template <typename T> struct type_traits {
  typedef T type;
  typedef T::iterator_type iterator_type;
  ...
}; 
```

...但这实际上只是利用了结构的默认保护级别是公开的...

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2018-09-17T11:05:27.507

正如其他人指出的那样

*   除了默认可见性之外，两者都是等效的
*   无论出于何种原因，都可能有理由被迫使用其中一个或另一个

Stroustrup/Sutter 给出了关于何时使用 which 的明确建议：

> [如果类具有不变量，则使用类；如果数据成员可以独立变化，则使用 struct](http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#c2-use-class-if-the-class-has-an-invariant-use-struct-if-the-data-members-can-vary-independently)

但是，请记住，转发声明某事是不明智的。作为一个类 ( `class X;`) 并将其定义为 struct ( `struct X { ... }`)。它可能适用于某些链接器（例如，g++）并且可能在其他链接器（例如，MSVC）上失败，因此您会发现自己陷入了开发者的地狱。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-10T16:36:17.633

它们几乎是一样的。由于 C++ 的魔力，结构可以像类一样保存函数、使用继承、使用“new”创建等等

唯一的功能区别是类以私有访问权限开头，而结构以公共访问权限开头。这是保持与 C 的向后兼容性。

在实践中，我一直将结构用作数据持有者，将类用作对象。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2017-11-14T21:08:34.533

`struct`over的一个优点`class`是它节省了一行代码，如果坚持“首先是公共成员，然后是私有的”。在这种情况下，我发现关键字`class`没用。

`struct`这是使用 only和 never的另一个原因`class`。一些 C++ 代码风格指南建议对函数宏使用小写字母，其基本原理是当宏转换为内联函数时，不需要更改名称。同样在这里。你有你漂亮的 C 风格的结构，有一天，你发现你需要添加一个构造函数，或者一些方便的方法。你把它改成`class`? 到处？

区分`struct`s 和`class`es 实在是太麻烦了，进入我们应该做的事情的方式——编程。就像 C++ 的许多问题一样，它源于对向后兼容性的强烈渴望。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2019-11-20T02:37:14.117

两者`struct`和`class`在引擎盖下都是相同的，尽管在可见性方面具有不同的默认值，`struct`默认值是公共的，`class`默认值是私有的。`private`您可以通过适当使用和将其中一个更改为另一个`public`。它们都允许继承、方法、构造函数、析构函数以及面向对象语言的所有其他优点。

然而，两者之间的一个巨大区别是，`struct`在 C 中支持关键字，`class`而不支持。这意味着可以在包含文件中使用 a `struct`，该包含文件可以`#include`是 C++ 或 C，只要它`struct`是纯 C 样式`struct`并且包含文件中的所有其他内容都与 C 兼容，即没有 C++ 特定的关键字，例如`private`, `public`, no方法，没有继承，等等等等等等。

AC 样式`struct`可以与其他支持使用 C 样式`struct`在接口上来回传输数据的接口一起使用。

AC 样式`struct`是一种描述内存区域布局的模板（不是 C++ 模板，而是模式或模板）。多年来，已经创建了可从 C 和 C 插件（这里介绍 Java、Python 和 Visual Basic）使用的接口，其中一些使用 C 风格`struct`。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-11-07T22:41:55.080

### 班级。

默认情况下，类成员是私有的。

```
class test_one {
    int main_one();
}; 
```

相当于

```
class test_one {
  private:
    int main_one();
}; 
```

所以如果你尝试

```
int two = one.main_one(); 
```

我们会得到一个错误：`main_one is private`因为它不可访问。我们可以通过将其指定为公共来初始化它来解决它，即

```
class test_one {
  public:
    int main_one();
}; 
```

### 结构。

结构是一个类，其中成员默认是公共的。

```
struct test_one {
    int main_one;
}; 
```

手段`main_one`是私人的，即

```
class test_one {
  public:
    int main_one;
}; 
```

我将结构用于成员可以取任何值的数据结构，这样更容易。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-07-28T03:49:00.170

它们是相同的，具有不同的默认值（默认情况下是私有的，默认情况下是`class`公共的`struct`），所以理论上它们是完全可以互换的。

所以，如果我只是想打包一些信息来移动，我会使用一个结构，即使我在那里放了一些方法（但不是很多）。如果它是一个大部分不透明的东西，主要用途是通过方法，而不是直接对数据成员，我使用一个完整的类。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-07-28T03:51:02.133

默认情况下，结构具有公共访问权限，而类默认情况下具有私有访问权限。

我个人将结构用于数据传输对象或值对象。当这样使用时，我将所有成员声明为 const 以防止其他代码修改。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2021-01-28T20:15:16.830

只是从 C++20 标准的角度解决这个问题（从[N4860](https://isocpp.org/files/papers/N4860.pdf)工作）......

类是一种*类型*。关键字“ `class`”和“ `struct`”（和“ `union`”）是——在C++语法中——class *-key*，选择`class`or的唯一功能意义`struct`是：

> *class-key*确定 ... 访问默认是公共的还是私有的 (11.9) 。

## 数据成员默认可访问性

11.9.1 中的示例记录了`class`关键字导致默认私有成员，而 `struct 关键字导致默认公开成员：

> 类 X { int a; // X::a 默认是私有的：使用的类

……对……

> 结构 S { int a; // S::a 默认是公共的：使用的结构体

## 基类默认可访问性

1.9 还说：

> 在基类没有*访问说明符*`public`的情况下，当派生类使用 class-key 定义时假定，并且在使用*class-key* `struct`定义*类*`private`时假定。 *`class`*

 *## 需要一致使用结构或类的情况......

有一个要求：

> 在类模板的重新声明、部分特化、显式特化或显式实例化中，*类键*应与原始类模板声明（9.2.8.3）在种类上一致。

> ...在任何*详细的类型说明符*中，`enum`关键字应用于指代枚举（9.7.1），`union` *类键*应用于指代`union`（11.5），`class`或`struct` *类键*应用于指代非联合类（11.1）。

提供了以下示例（不需要一致性*时*）：

> 结构 S { } s; 类 S* p = &s; // 好的

尽管如此，一些编译器可能会对此提出警告。

* * *

有趣的是，虽然您使用和创建`struct`的类型都称为“类”，但我们有...`class``union`

> *标准布局结构*是使用 class-key 或 class-key 定义的*标准* `struct`布局*类* `class`。

...所以在标准语言中，当谈到*标准布局结构*时，它使用“结构”来暗示“不是联合”。

我很好奇在其他术语中是否有类似的“结构”使用，但是对标准进行详尽的搜索是一项太大的工作。欢迎评论。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2021-10-17T21:00:19.883

经过多年使用我的主要语言 C++ 进行编程，我得出一个死结论，即这是 C++ 的另一个愚蠢特性。

两者之间没有真正的区别，也没有理由我应该花额外的时间来决定我应该将我的实体定义为结构还是类。

要回答这个问题，请随时将您的实体定义为结构。默认情况下，成员将是公开的，这是常态。但更重要的是，默认情况下继承是公开的。受保护的继承，甚至更糟糕的是私有继承，都是例外。

我从来没有遇到过私人继承是正确做法的案例。是的，我试图发明使用私有继承的问题，但没有奏效。而Java，如果不使用访问器关键字，面向对象编程的角色模型默认为公共继承。顺便说一句，Java 不允许在继承类上使用访问器关键字，它们只能被公开继承。所以你可以看到，cpp团队真的在这里倒下了。

另一个令人沮丧的事情是，如果你定义为一个类并声明为一个结构，你会收到编译警告。好像这会影响程序的性能或准确性。一个答案还指出，MSVC 可能会传播编译器错误。

那些在下雨时使用课程，在阳光下使用结构的人是根据他们所教的内容这样做的。他们发现这不是真的。Java 没有一对类的名称，只有 class 关键字。如果你想要一个数据结构，只需将所有成员公开，不要添加函数。这在 Java 中有效，我没有看到任何问题。有什么问题？您需要 4 或 5 个 BOM 代码字符来确定如何解释类​​实体的上下文。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-07-28T04:42:17.613

从技术上讲，两者在 C++ 中是相同的 - 例如，结构可能具有重载运算符等。

然而 ：

当我希望同时传递多种类型的信息时，我使用结构。当我处理“功能”对象时，我使用类。

希望能帮助到你。

```
#include <string>
#include <map>
using namespace std;

struct student
{
    int age;
    string name;
    map<string, int> grades
};

class ClassRoom
{
    typedef map<string, student> student_map;
  public :
    student getStudentByName(string name) const 
    { student_map::const_iterator m_it = students.find(name); return m_it->second; }
  private :
    student_map students;
}; 
```

例如，我在这里的 get...() 方法中返回了一个 struct student - 享受吧。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-07-28T20:40:22.217

> 在 C++ 中，您何时选择使用 struct 以及何时使用 class？

我`struct`在定义`functors`and时使用`POD`。否则我使用`class`.

```
// '()' is public by default!
struct mycompare : public std::binary_function<int, int, bool>
{
    bool operator()(int first, int second)
    { return first < second; }
};

class mycompare : public std::binary_function<int, int, bool>
{
public:
    bool operator()(int first, int second)
    { return first < second; }
}; 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-09-15T09:30:25.323

当我需要创建 POD 类型或仿函数时，我会使用结构。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-10-15T16:32:02.213

默认情况下，所有类成员都是私有的，默认情况下所有结构成员都是公共的。类具有默认的私有基础，而 Struct 具有默认的公共基础。在 C 的情况下，结构不能具有成员函数，而在 C++ 的情况下，我们可以将成员函数添加到结构中。除了这些差异之外，我没有发现任何令人惊讶的地方。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-07-28T04:29:10.167

仅当我需要保存一些数据而没有任何关联的成员函数（对成员数据进行操作）并直接访问数据变量时，我才使用 struct。

例如：从文件和套接字流等读取/写入数据。在函数参数太多且函数语法看起来太冗长的结构中传递函数参数。

从技术上讲，除了默认可访问性之外，类和结构之间没有太大区别。更重要的是，它取决于您如何使用它的编程风格。

* * *

## 回答 #26

> 赞同：-5
> 
> 时间：2009-07-28T04:07:59.977

我认为 Structs 旨在作为一种数据结构（如信息的多数据类型数组），而类则用于代码打包（如子例程和函数的集合）。

:(

* * *

## 回答 #27

> 赞同：-8
> 
> 时间：2008-09-10T18:02:25.977

我从不在 C++ 中使用“结构”。

我无法想象当你想要私有成员时你会使用结构的场景，除非你故意试图混淆。

似乎使用结构更多地是对如何使用数据的句法指示，但我宁愿只创建一个类并尝试以类的名称或通过注释来明确说明。

例如

```
class PublicInputData {
    //data members
 }; 
```

# windows - linux和windows下emacs中webdev的可靠配置？

> ID：54586
> 
> 赞同：3
> 
> 时间：2008-09-10T16:30:43.123
> 
> 标签：windows, linux, emacs, cross-platform

我有一台 Windows 笔记本电脑（thinkpad）和最近重新发现的 emacs，当箭头键位于你右腋窝附近的某个地方时，所有这些古怪的快捷方式都可以带来好处。

在 php-mode、css-mode 等，在 mmm-mode 下不一致、有错误并且拒绝正确解释我的某些文件后，我感到气馁。（平心而论，我很可能做错了）所以我最终找到了运行良好的 nxhtml 包。

但是，nxhtml 会导致奇怪的错误，并且实际上会在 linux 下的某些文件（我认为的嵌套模式的某些组合）上崩溃！（使用 Ubuntu 7.10 和 Kubuntu 8.04）

我希望能够在笔记本电脑和家用 linux pc 上工作，而不必处理不应该这么难的东西的不一致实现。我用谷歌搜索并环顾四周，很有可能我是地球上唯一遇到这些问题的人......有人有什么建议吗？

（代替emacs解决方案，我想一个足够好的具有开发功能的跨平台轻量级文本编辑器也可以工作......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T16:59:30.063

就个人而言，我喜欢[`mumamo-mode`](http://www.emacswiki.org/cgi-bin/wiki/MuMaMo). 我不确定您是否将其包含在问题描述中，因为它确实依赖（并且通常与`nxhtml-mode`. 所以我不知道您是否正在使用`mumamo`或者只是其中的某个方面`nxhtml`让您可以使用多种模式。

如果您不使用`mumamo-mode`，那么我建议您尝试一下。它不会解决您的`nxhtml`问题，但它是编辑多模式文件的一种非常简单的方法（对我来说非常有用，适用于 HTML、CSS、JS、PHP 等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-11T20:34:41.063

尽管我在必要时使用 emacs（即，当我在命令行时），但我使用[Eclipse](http://www.eclipse.org/)进行所有真正的开发工作。如果您获得了[Web Standards Toolkit](http://www.eclipse.org/webtools/wst/main.php)插件，它可以进行语法着色、标签自动完成和其他有趣的事情。

或者，如果 Eclipse 对您来说“重”，[jEdit](http://www.jedit.org/)是另一个用于进行 Web 开发的优秀程序（它内置了大部分 Web 开发支持，但您也可以获得一些额外的插件来实现 HTML Tidy 等功能）。

这两个程序都是开源和基于 Java 的，这意味着它们都是免费的并且可以在（几乎）任何平台上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T14:00:27.617

您可以尝试 mmm-mode 和 multi-mode。我还没有尝试过：我现在对 nxhtml 很满意。你遇到过什么样的问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-10T20:28:51.760

OP 五年后，让我推荐 Emacs [web-mode](http://web-mode.org)。

它对组合 Web 文档（html+php+css+js+asp+jsp...）有很好的支持。片段。语法高亮。自动完成。css 着色。自动工作压痕。自动关闭标签。

对于我的日常开发，web-mode 已经完全取代了 php-mode/html 等。

通过[MELPA](http://melpa.milkbox.net/#/web-mode)轻松安装。

有一个用于报告问题的[Github 页面](https://github.com/fxbois/web-mode)，开发人员很快就修复了该页面。

# linux - 快速磁盘克隆

> ID：54612
> 
> 赞同：7
> 
> 时间：2008-09-10T16:39:14.600
> 
> 标签：linux, storage, dd, parallel-io

克隆磁盘时有没有办法让 Linux 提前读取？我使用名为“dd”的程序来克隆磁盘。上次我这样做时，操作系统似乎是在读取然后写入，但从来没有同时进行。理想情况下，如果源磁盘可以跟上，目标磁盘将不断写入而无需等待。

更新：我通常在克隆时选择较大的块大小（例如 16M 或 32MB）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-11T04:14:15.023

Commodore Jaeger 是正确的：

```
dd if=/dev/sda of=/dev/sdb bs=1M 
```

此外，调整驱动器上的“预读”通常会提高性能。默认值可能是 256 和最佳值 1024。每个设置都不同，因此您必须运行基准测试才能找到最佳值。

```
# blockdev --getra /dev/sda
256
# blockdev --setra 1024 /dev/sda
# blockdev --getra /dev/sda
1024
# blockdev --help
Usage:
  blockdev -V
  blockdev --report [devices]
  blockdev [-v|-q] commands devices
Available commands:
    --getsz (get size in 512-byte sectors)
    --setro (set read-only)
    --setrw (set read-write)
    --getro (get read-only)
    --getss (get sectorsize)
    --getbsz    (get blocksize)
    --setbsz BLOCKSIZE  (set blocksize)
    --getsize   (get 32-bit sector count)
    --getsize64 (get size in bytes)
    --setra READAHEAD   (set readahead)
    --getra (get readahead)
    --flushbufs (flush buffers)
    --rereadpt  (reread partition table)
    --rmpart PARTNO (disable partition)
    --rmparts   (disable all partitions)
# 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-10T16:46:00.417

您可以尝试使用 bs 参数增加块大小；默认情况下，我相信 dd 使用的块大小等于磁盘的首选块大小，这意味着要复制整个磁盘需要更多的读写操作。Linux 的 dd 支持人类可读的后缀：

```
dd if=/dev/sda of=/dev/sdb bs=1M 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-06T11:07:13.147

对我来说最快的：

```
dd if=/dev/sda bs=1M iflag=direct | dd of=/dev/sdb bs=1M oflag=direct 
```

达到 ~100MiB/s，而其他选项（单进程，无直接，默认 512b 块大小，...）甚至没有达到 30MiB/s...

要查看进度，请在另一个控制台中运行：

```
watch -n 60 killall -USR1 dd 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-15T13:05:17.227

如果两个磁盘使用不同的通道（例如 SATA），您可以使用 fastDD 等高性能工具。作者声称：

> “在这项工作中，我们回顾了可靠和有效地复制数据的问题，回顾了干预和干扰复制过程的所有硬件和软件机制。我们的考虑已经被编码为 fastdd，一个能够非常有效地复制数据的 C++ 程序，正如我们在测试中所展示的那样。”

此外，该工具的语法与旧的`dd`.

[http://www.dei.unipd.it/~zagonico/fastdd/](http://www.dei.unipd.it/~zagonico/fastdd/)

[https://github.com/zagonico86/fastdd](https://github.com/zagonico86/fastdd)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T16:43:23.700

也许你可以使用两个进程

```
dd if=indevfile | dd of=outdevfile 
```

我假设您可以根据需要设置其他 dd 选项。这有一些开销，但应该允许读取一个磁盘和写入另一个磁盘之间的异步。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T16:45:07.097

你确定它不是同时做的吗？我希望磁盘缓存能够确保它发生。如果没有，非阻塞甚至异步读/写可能会有所帮助，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T16:56:16.417

关于您的更新：您的 HD 的缓存有多大？（特别是写作）。这可能太多了，您可能需要减少它以防止不必要的阻塞。

# javascript - 如何在 Prototype.js 中使用 Ajax 将 XML 文件作为 XML（而不是字符串）获取？

> ID：54626
> 
> 赞同：0
> 
> 时间：2008-09-10T16:42:35.700
> 
> 标签：javascript, xml, prototypejs

此代码来自*Prototype.js*。我已经查看了大概 20 个不同的教程，但我无法弄清楚为什么这不起作用。我得到的响应是空的。

```
new Ajax.Request(/path/to / xml / file.xml, {
   method: "get",
   contentType: "application/xml",
   onSuccess: function(transport) {
      alert(transport.responseXML);
   }
}); 
```

如果我将 更改`responseXML`为`responseText`，那么它会以字符串形式向我提醒 XML 文件。这不是一个提供 XML 的 PHP 页面，而是一个实际的 XML 文件，所以我知道它不是响应标头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T16:44:39.720

如果 transport.responseXML 为 null 但您有 transport.responseText 的值，那么我相信这是因为它不是有效的 XML 文件。

**编辑：** 我刚刚注意到，在我们的代码中，每当我们请求 XML 文件时，我们都会将内容类型设置为“text/xml”。我不知道这是否有所作为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T04:23:42.457

只是想分享我下午在**responseXML**响应的 NULL 结果中处理该问题。我的结果与问题中描述的完全一样：responseText 填充了 XML 文件，responseXML 为 NULL。因为我完全确定我的文件是有效的 XML 格式，所以错误一定是不同的。

如**Prototype v1.7**文档中所述，我将内容类型设置为**"application/xml"**。无论如何，发送的响应总是“text/html”。

简而言之，我遇到的问题是，我的 XML 文件以**“.gpx”**结尾，因为它是 GPS 坐标的事实上的标准。我的本地 XAMPP Apache 安装的 mime-types 集合仅预见到结尾“xml”和“xsl”。添加“gpx”并重新启动服务器后，程序运行顺利，因为它应该是。

就我而言，有三种解决方案：

1）编辑Apache的“mime.types”文件。使用 XAMPP 安装，您可能会在“C:\xampp\apache\conf\mime.types”下找到它。搜索“application/xml”记录，修改如下：

```
application/xml xml xsl gpx 
```

不要忘记重新启动服务器！

2)在相应文件夹的**.htaccess**中添加 mime 类型。打开或创建一个 .htaccess 文件并添加以下行：

```
AddType application/xml xml xsl gpx 
```

3）在上传过程中，将文件类型更改为“xml”而不是您拥有的任何文件

希望我能安全一些时间给你们中的一个人。

# development-environment - 在编程环境方面需要帮助

> ID：54652
> 
> 赞同：-4
> 
> 时间：2008-09-10T16:48:46.807
> 
> 标签：development-environment

我是一名 .net 开发人员（目前使用 Visual Studio 2008）。我想买一台新电脑，我不想在未来 3 年内更换。

在我的选择中，我在想双核 3GHz 的机器会更好，还是 2.4GHz 四核的机器更好？

请帮忙。

更新：这就是我最终得到的：Intel Q9550（四核，12 M 缓存）4 GB RAM 10K rpm 硬盘

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T16:50:52.607

目前，时钟频率更高的双核系统与 Visual Studio 一起使用可能更快。

但是，这种情况在未来三年内可能会发生变化，**如果您希望能够测试自己的多线程代码**，四核系统可能是更好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T16:52:10.730

我不相信 VS 2008 会利用多个内核，因此在内核上使用 GHz 将是可靠的举措。另一方面......您可以在其他核心上运行更多实例。

鉴于我仍然可能会在内核上选择 GHz，因为没有多少东西真正利用多余的内核。当然，这很可能在未来发生变化。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T16:53:43.007

我们杰出的 Jeff Attwood 实际上有一篇关于这个主题的博文：

*   [选择双核或四核](http://www.codinghorror.com/blog/archives/000942.html)

但是，我会得到一个四边形。不妨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T16:56:38.427

对于编程任务，**硬盘速度**是比 CPU 时钟速度更大的瓶颈。

我相信 Jeff 在他的[Building a PC 系列](http://www.codinghorror.com/blog/archives/000905.html)以及 Scott Hanselman 的[Ultimate Developer 钻机系列中提到了这一点](http://www.hanselman.com/blog/TheCodingHorrorUltimateDeveloperRigThrowdownPart1.aspx)

这 2 个系列的博客文章提供了大量有用的信息，您可能想看看

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T17:02:24.933

三年时间很长，我会选择四核。原因是：今天，Visual Studio 不会使用它，但三年后……你不知道。鉴于您的目标是一个可能持续大约三年的系统，这将是 IMO 最明智的决定。

另一方面，单核上 2.4 和 3.0 之间的速度差异可能很明显。但正如其他人所提到的，获得一个 10.000rpm 的硬盘驱动器，你会更快乐。

祝你的系统好运！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T17:17:40.810

最大化你的内存。链接器是 RAM 密集型的，Visual Studio 也是如此。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-13T04:14:01.747

我会更担心 RAM 和 HDD 的速度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T16:58:24.757

我说去四核。然后你可以将它 OC 到 3GHz。然后它是两全其美的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T05:56:15.987

Visual Studio 非常占用磁盘空间。这是您的第一个问题。另外，如果您使用的是 MSBuild，则可以通过从命令行编译来使用任意数量的内核。

提示 1：获得四边形。技巧 2：获得 10k RPM 引导驱动器 技巧 3：将 Windows 和 VS 放在一个磁盘上，将所有代码放在另一个磁盘上 技巧 4：运行 64 位 Vista 和 4+ Gigs 的 RAM。

这一切都可以在 1000 美元以下完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-13T04:48:16.000

我肯定会使用尽可能多的内核，即使每个内核都小一些。

作为开发人员（以及一般的计算机用户）的大多数挫败感不是来自于进行操作所花费的时间，而是来自于在进行主要操作时其他事情的缓慢变化，或者来自于紧张不安流畅运动的开始和停止。

考虑到大多数 IDE 运行大量线程，并且您可能还使用其他应用程序，更多的内核会更好，并减少计算机上的切换负载。

例如，我通常运行：1) Eclipse IDE，它为正在运行的程序保留控制台 2) Eclipse IDE 或我正在测试的应用程序的另一个副本 3) 数据库服务器 4) 其他一些守护进程。

我宁愿让所有四个同时运行，然后让它们运行得更快但必须切换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-13T04:53:59.777

考虑到我对两核机器的挫败感并看到 CPU 使用率很高，我认为我的血压在 4 处理器的机器上不会上升......

那还有更多的内存。

# asp.net - 是否有与 CSS 等效的 ClientScriptManager.RegisterClientScriptInclude

> ID：54658
> 
> 赞同：13
> 
> 时间：2008-09-10T16:50:57.800
> 
> 标签：asp.net, css

[ClientScriptManager.RegisterClientScriptInclude](http://msdn.microsoft.com/en-us/library/kx145dw2.aspx)方法允许您向Page 对象注册 JavaScript 引用（检查重复项）。

CSS引用是否有与此方法等效的方法？

类似的问题适用于[ClientScriptManager.RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptblock.aspx)和[ClientScriptManager.RegisterClientScriptResource](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerclientscriptresource.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-21T21:11:14.517

您可以将标题链接添加到 ASP.Net 代码隐藏类中的 CSS 文件，如下所示：

```
HtmlLink link = new HtmlLink();
link.Href = "Cases/EditStyles.css";
link.Attributes.Add("type", "text/css");
link.Attributes.Add("rel", "stylesheet");
this.Header.Controls.Add(link); 
```

您可以事先遍历标题控件以查看它是否已经存在。显示的示例来自我的一个项目中的 Page_Load，并且位于一个条件表达式中，如果页面应该处于“编辑”模式，则该条件表达式仅添加 EditStyles.css。

对于ClientScriptManager.RegisterClientScriptBlock 和ClientScriptManager.RegisterClientScriptResource，它们具有用于检查它们是否已经被注册的等效函数（例如，IsClientScriptrResourceRegistered）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-22T01:08:38.597

简短的回答：没有。您当然可以滚动自己的函数（如 CMPalmer 所建议的那样）来获取 CSS 嵌入资源（如 Gulzar 所建议的那样）并将它们嵌入到页面中。

但是，作为最佳实践，我不确定您为什么要这样做。如果您正在制作一个具有大量 CSS 样式的可重用控件，我的建议是将类名称硬编码到您的控件的符合标准的输出中，并附带一个建议的样式表来发送控件。这使您的用户/客户可以选择覆盖您建议的样式以满足他们的需求，并且通常允许他们管理他们认为合适的 CSS 设置。

将样式与标记分开是一件好事——您已经走上了正确的道路，可以避免各种内置的 ASP.NET 样式属性，但您应该一直这样做，并将 CSS 排除在 .dll 之外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T17:03:02.407

我使用 css 文件作为[嵌入式资源](http://aspalliance.com/726)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-19T14:32:22.507

只需检查是否存在已注册的脚本，如果您发现它不存在，那么您将知道这是您的控件第一次被创建。此时，您只需将文字控件拖放到指向所需 css 文件的页面中即可。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    With Page.ClientScript
        If Not .IsClientScriptIncludeRegistered("JQuery") Then 
            .RegisterClientScriptInclude("JQuery", "Scripts/jquery-1.4.2.min.js")
            Dim l As New Literal()
            l.Text = "<link href='Uploadify/uploadify.css' rel='stylesheet' type='text/css' />"
            sender.controls.add(l)
        End If
    End With
End Sub 
```

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T01:10:38.763

再想一想：您可能需要考虑“命名空间”您的类名，以避免与您的消费者可能已经在使用的常见类名发生冲突。例如

```
<div class="SmillerControls_Toolbar">
    <a class="SmillerControls_Button" ...>...</a>
    ...
</div> 
```

或者您可以将整个内容包装在一个“命名空间”类中，然后将您的 CSS 写入其中：

```
 <div class="SmillerControls">
     <div class="Toolbar">
          <a class="Button" ...>...</a>
     </div>
 </div> 
```

你的 CSS 就像

```
 div.SmillerControls div.Toolbar
 {
     ...
 }

 div.SmillerControls div.Toolbar a.Button
 {
     ...
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-13T20:17:21.387

我所做的是使用

```
<asp:Literal id="cssliteral" runat="server" /> 
```

在 head 中，然后是包含动态 css 脚本的 PageLoad 上的 StringBuilder。

```
StingBuilder str = new StringBuilder();
str.Append("<style type="text/css">");
str.Append(".myclass {background-color:#" + mycolor);
str.Append("</style>");

cssLiteral.Text = str.ToString(); 
```

# php - Apache 下载：确保在下载之前查看了该页面

> ID：54669
> 
> 赞同：1
> 
> 时间：2008-09-10T16:53:16.983
> 
> 标签：php, apache, cookies, protection, download

手头的工作：

我想确保我网站的用户在开始下载之前查看页面。如果他们没有查看页面但尝试直接热链接到文件，他们应该在允许下载之前转到网页。

有什么建议比我发送 cookie 的想法更好 - 在下载开始之前 - 检查 cookie 是否存在（通过 .htaccess）？

网页和下载文件将位于不同的服务器上。

环境：

*   所有机器上的 Apache 2
*   所有机器上的 PHP 5
*   MySQL 5 在“网页”服务器上可用（不能从下载服务器访问）

内森问我试图解决什么问题，事实上我想防止来自论坛的热链接。如果人们使用我们的带宽从我们的服务器下载，我想在下载开始之前向他们展示一个带有广告的页面。它不需要完全安全，但我们需要赚一些钱来资助服务器，对吧？:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T17:08:36.447

与其允许对文件进行热链接，不如将它们存储在 Web 可访问路径之外。而是将下载请求转到启动下载的 php 脚本。您可以进行检查以确保请求页面是您想要阅读的页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T17:39:59.773

Apache mod_rewrite RewriteRule 可以做到这一点。

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://www.example.com/page.html$
RewriteRule file.exe http://www.example.com/page.html [R=301,L] 
```

`file.exe`基本上，如果没有作为推荐人的请求`page.html`，它将 301 将用户重定向到`page.html`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T17:05:27.673

您可以使用[分布式服务器端](http://r.schuil.googlepages.com/phpdsm.html)会话而不是 cookie，但这可能比它的价值更麻烦。

您还可以[禁止访问](http://rewrite.drbacchus.com/rewritewiki/ImageTheft)没有引荐来源网址或错误引荐来源网址的请求。但这比饼干还要假。

那得看你有多在乎了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T14:02:21.293

此处的解决方案取决于您要解决的问题。如果您只是想确保直接链接不会发布在论坛等上，那么只需使用 .htaccess 检查引荐来源网址就足够了。当然，推荐人很容易被伪造，所以如果有人这样做的风险是一个问题，那么你需要做其他事情。

如果您需要更安全的东西，cookie 应该可以解决问题。我们不能只使用 php 会话，因为文件服务器和网络服务器位于不同的盒子上。但是我们可以根据时间的哈希值和一些秘密值创建一个 cookie。

```
cookievalue = sha1('secretvalue'.date('z-H')); 
```

当用户请求实际文件时，文件服务器会再次生成此 cookie 并确保它与用户匹配。这意味着，即使用户伪造了cookie，一个小时后它也会失效，所以谁在乎，他们也无法生成自己的新cookie，因为他们不知道秘密值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-11T21:25:06.510

我正要建议使用 .htaccess 推荐技巧，但这不是一种非常安全的方法。制作一个 PHP 脚本很容易，并添加了一个自定义的 http-referral。如果你在那里进入下载页面，它会认为你来自那个页面。

这是一个相关的问题吗？你能谈谈你的下载页面的上下文吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-17T13:55:33.830

我将使用[mod_auth_token](http://www.synd.info/downloads/releases/)来确保用户拥有“最近的链接”。

使用 mod_auth_token 您可以创建过期链接，即如果有人决定使用现有链接并将其发布到另一个网站上，该链接将在指定时间后过期。这将导致 403 FORBIDDEN，我可以捕获并将用户重定向到我希望他访问的 HTML 页面。

# c++ - 有什么好的 C++ 项目构建工具可以替代 make 吗？

> ID：54674
> 
> 赞同：22
> 
> 时间：2008-09-10T16:54:04.907
> 
> 标签：c++, build-process, makefile

我想知道是否有任何漂亮而简洁的工具来替换 GNU Autotools 或 Make 来构建一个非常大的 C++ 项目，这些项目使用起来非常复杂。

如果项目很小，生成de Autotools所需的所有文件很简单，但如果源代码分为许多目录，有多个第三方库和许多依赖项，你就会陷入“Autotools地狱”。

感谢您的任何建议

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-10T17:00:36.950

[制作](http://www.cmake.org/)？（生成makefile，因此从技术上讲不是替代品）。

我最近还看到“ [SCons](http://www.scons.org/) ”出现在一些地方。不过，我自己并没有用它创造任何东西。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-10T17:14:33.640

[Google V8 JavaScript 引擎](http://code.google.com/p/v8/)是用 C++ 编写的并使用SCons [，](http://www.scons.org/)所以我猜这是对它的一票。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-11T00:01:05.177

看看[waf](http://code.google.com/p/waf/)。

我认为您可以将其视为 make 和 autotools 的完全替代品。它基于python。我喜欢 waf 的一件事是 waf 脚本本身是 ~100kb 独立的，您可以将其放置在项目根目录中。这与必须先安装构建系统的 make 或 rake 和朋友形成对比。不过，您必须安装 python >=2.3。

```
~$ ./waf configure && ./waf && ./waf install 
```

Waf 相当于 Makefiles 是 wscript 文件。它是一个 waf 读取的 python 脚本，它定义了至少 3 个函数： `set_options()`,`configure(conf)`和`build(bld)`. 你可以猜到他们每个人的作用。

为了快速入门，我建议查看源代码分发中的 demos/cpp/* 文件。另请查看 doc/ [waf.pdf](http://code.google.com/p/waf/source/browse/trunk/doc/old/waf.pdf)文件；这是一个 12 页的文档，可以让您快速启动并运行。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-12T00:08:42.847

对于各种 C++ 构建工具的速度比较，你可以看看这个基准： [https ://psycledelics.github.io/wonderbuild/benchmarks/time.xml](https://psycledelics.github.io/wonderbuild/benchmarks/time.xml)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-10T17:20:05.750

我们将 Jam 用于复杂的 C++ 项目 - 一个好处是它很好地跨平台。与其说我的好处，不如快速浏览一下这个链接： [http ://www.perforce.com/jam/jam.html](http://www.perforce.com/jam/jam.html)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-07T21:57:15.640

Noel Llopis 写了几篇比较构建系统的文章。“追求完美构建系统”的第 1 部分位于[http://gamesfromwithin.com/the-quest-for-the-perfect-build-system](http://gamesfromwithin.com/the-quest-for-the-perfect-build-system)。第 2 部分在同一站点上进行。在[http://gamesfromwithin.com/?p=104](http://gamesfromwithin.com/?p=104)报告了 Scons 的重试。

结论：SCons 太慢了…… Jam 是赢家。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T17:02:24.827

Cook 是另一个可以用来代替 make 的工具。我见过几家大公司在使用它。因此，即使网站看起来相当过时，它也已为企业做好准备。

[http://miller.emu.id.au/pmiller/software/cook/](http://miller.emu.id.au/pmiller/software/cook/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-09T19:37:59.087

我在一个大型 c++ 项目（在 Linux 和 Windows 上）上使用了 SCons，它运行得非常好。

`scons all -j8` （并行编译目标文件）非常酷！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T03:18:12.460

我在构建过程中使用[bakefile](http://www.bakefile.org/index.html)，我成为了忠实粉丝！

我再也不用自己编写 Makefile 了，更不用说可怕的 GNU autotools 脚本了。我所要做的就是提供一个`XML`描述构建目标的文件。Bakefile 可以将其转换为获取所有（头文件）依赖项等的 Makefile，其中可以选择不同的 Makefile 格式（粘贴文档中的列表）：

```
available formats are:
    autoconf      GNU autoconf Makefile.in files
    borland       Borland C/C++ makefiles
    dmars         Digital Mars makefiles
    dmars_smake   Digital Mars makefiles for SMAKE
    gnu           GNU toolchain makefiles (Unix)
    mingw         MinGW makefiles (mingw32-make)
    msevc4prj     MS eMbedded Visual C++ 4 project files
    msvc          MS Visual C++ nmake makefiles
    msvc6prj      MS Visual C++ 6.0 project files
    msvs2003prj   MS Visual Studio 2003 project files
    msvs2005prj   MS Visual Studio 2005 project files
    symbian       Symbian development files
    watcom        OpenWatcom makefiles
    xcode2        Xcode 2.4 project files 
```

我通常使用*autoconf*选项，它为我编写烦人的 GNU autotools 脚本。我确实必须调整`configure.ac`脚本，以便 configure 在任何系统上找到某个库。但这还不错。以这种方式获取 autoconf 脚本很好，因为我不必自己编写它们，当我分发我的项目时，它看起来就像我写的一样，用户仍然可以在上帝中构建我的项目-让位，与

```
./configure && make && make install 
```

# xml - 如何将 XML 插入现有 XML 节点

> ID：54683
> 
> 赞同：22
> 
> 时间：2008-09-10T16:56:37.647
> 
> 标签：xml, xslt

我什至不确定这是否可能，但我说我有一些 XML：

```
 <source>
        <list>
            <element id="1"/>
        </list>
    </source> 
```

我想插入列表：

```
<element id="2"/> 
```

我可以编写一个 XSLT 来执行此操作吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-10T17:00:23.440

将这 2 个模板定义添加到 XSLT 文件中：

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>
<xsl:template match="list">
  <list>
     <xsl:apply-templates select="@* | *"/>
     <element id="2"/>
  </list>
</xsl:template> 
```

# java - 如何使用 Java 获取当前打开的窗口/进程的列表？

> ID：54686
> 
> 赞同：102
> 
> 时间：2008-09-10T16:56:43.060
> 
> 标签：java, process

有谁知道如何使用 Java 获取本地机器当前打开的窗口或进程？

我想要做的是：列出当前打开的任务、窗口或进程打开，就像在 Windows 任务管理器中一样，但使用多平台方法 - 如果可能的话，只使用 Java。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2008-09-10T18:30:12.680

**这是从命令“ ps -e** ”解析进程列表的另一种方法：

```
try {
    String line;
    Process p = Runtime.getRuntime().exec("ps -e");
    BufferedReader input =
            new BufferedReader(new InputStreamReader(p.getInputStream()));
    while ((line = input.readLine()) != null) {
        System.out.println(line); //<-- Parse data here.
    }
    input.close();
} catch (Exception err) {
    err.printStackTrace();
} 
```

如果您使用的是 Windows，那么您应该更改以下行：“Process p = Runtime.getRun...”等...（第 3 行），如下所示：

```
Process p = Runtime.getRuntime().exec
    (System.getenv("windir") +"\\system32\\"+"tasklist.exe"); 
```

希望信息有所帮助！

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2017-07-12T21:46:33.973

最后，使用 Java 9+ 可以使用[`ProcessHandle`](https://docs.oracle.com/javase/9/docs/api/java/lang/ProcessHandle.html)：

```
public static void main(String[] args) {
    ProcessHandle.allProcesses()
            .forEach(process -> System.out.println(processDetails(process)));
}

private static String processDetails(ProcessHandle process) {
    return String.format("%8d %8s %10s %26s %-40s",
            process.pid(),
            text(process.parent().map(ProcessHandle::pid)),
            text(process.info().user()),
            text(process.info().startInstant()),
            text(process.info().commandLine()));
}

private static String text(Optional<?> optional) {
    return optional.map(Object::toString).orElse("-");
} 
```

输出：

```
 1        -       root   2017-11-19T18:01:13.100Z /sbin/init
  ...
  639     1325   www-data   2018-12-04T06:35:58.680Z /usr/sbin/apache2 -k start
  ...
23082    11054    huguesm   2018-12-04T10:24:22.100Z /.../java ProcessListDemo 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-02-27T09:53:35.280

[在 Windows 上，有一个使用JNA](https://github.com/twall/jna)的替代方法：

```
import com.sun.jna.Native;
import com.sun.jna.platform.win32.*;
import com.sun.jna.win32.W32APIOptions;

public class ProcessList {

    public static void main(String[] args) {
        WinNT winNT = (WinNT) Native.loadLibrary(WinNT.class, W32APIOptions.UNICODE_OPTIONS);

        WinNT.HANDLE snapshot = winNT.CreateToolhelp32Snapshot(Tlhelp32.TH32CS_SNAPPROCESS, new WinDef.DWORD(0));

        Tlhelp32.PROCESSENTRY32.ByReference processEntry = new Tlhelp32.PROCESSENTRY32.ByReference();

        while (winNT.Process32Next(snapshot, processEntry)) {
            System.out.println(processEntry.th32ProcessID + "\t" + Native.toString(processEntry.szExeFile));
        }

        winNT.CloseHandle(snapshot);
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-10T17:00:32.240

我能想到的唯一方法是调用一个为您完成工作的命令行应用程序，然后对输出进行屏幕截图（如 Linux 的 ps 和 Window 的任务列表）。

不幸的是，这意味着您必须编写一些解析例程才能从两者中读取数据。

```
Process proc = Runtime.getRuntime().exec ("tasklist.exe");
InputStream procOutput = proc.getInputStream ();
if (0 == proc.waitFor ()) {
    // TODO scan the procOutput for your data
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-12-16T21:40:45.320

[YAJSW](http://yajsw.sourceforge.net/)（Yet Another Java Service Wrapper）看起来像它的 org.rzo.yajsw.os.TaskList 接口的基于 JNA 的实现，适用于 win32、linux、bsd 和 solaris，并且在 LGPL 许可下。我没试过直接调用这段代码，但是我以前用过YAJSW确实很好用，不用太担心。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-02-14T09:27:29.807

[您可以使用jProcesses](https://github.com/profesorfalken/jProcesses)轻松检索正在运行的进程列表

```
List<ProcessInfo> processesList = JProcesses.getProcessList();

for (final ProcessInfo processInfo : processesList) {
    System.out.println("Process PID: " + processInfo.getPid());
    System.out.println("Process Name: " + processInfo.getName());
    System.out.println("Process Used Time: " + processInfo.getTime());
    System.out.println("Full command: " + processInfo.getCommand());
    System.out.println("------------------");
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-10T18:48:46.677

没有平台中立的方法可以做到这一点。在 Java 的 1.6 版本中，添加了一个“[桌面](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html)”类，允许以可移植的方式浏览、编辑、邮寄、打开和打印 URI。有可能有一天这个类可能会扩展到支持流程，但我对此表示怀疑。

如果您只对 Java 进程感兴趣，可以使用[java.lang.management](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/ManagementFactory.html) api 获取 JVM 上的线程/内存信息。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-01-13T12:44:39.297

对于 Windows，我使用以下内容：

```
Process process = new ProcessBuilder("tasklist.exe", "/fo", "csv", "/nh").start();
new Thread(() -> {
    Scanner sc = new Scanner(process.getInputStream());
    if (sc.hasNextLine()) sc.nextLine();
    while (sc.hasNextLine()) {
        String line = sc.nextLine();
        String[] parts = line.split(",");
        String unq = parts[0].substring(1).replaceFirst(".$", "");
        String pid = parts[1].substring(1).replaceFirst(".$", "");
        System.out.println(unq + " " + pid);
    }
}).start();
process.waitFor();
System.out.println("Done"); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-07-17T10:32:46.827

这对于具有捆绑 JRE 的应用程序可能很有用：我扫描我正在运行应用程序的文件夹名称：因此，如果您的应用程序正在从以下位置执行：

```
C:\Dev\build\SomeJavaApp\jre-9.0.1\bin\javaw.exe 
```

那么您可以通过以下方式查找它是否已经在 J​​9 中运行：

```
public static void main(String[] args) {
    AtomicBoolean isRunning = new AtomicBoolean(false);
    ProcessHandle.allProcesses()
            .filter(ph -> ph.info().command().isPresent() && ph.info().command().get().contains("SomeJavaApp"))
            .forEach((process) -> {
                isRunning.set(true);
            });
    if (isRunning.get()) System.out.println("SomeJavaApp is running already");
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-05-17T15:16:53.003

使用代码来解析`ps aux`linux 和`tasklist`windows 是您最好的选择，直到出现更通用的东西。

对于windows，可以参考：[http ://www.rgagnon.com/javadetails/java-0593.html](http://www.rgagnon.com/javadetails/java-0593.html)

Linux 也可以`ps aux`通过管道传输结果`grep`，这将使处理/搜索变得快速和容易。我相信你也可以为 Windows 找到类似的东西。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-11-01T17:50:40.020

以下程序仅与**Java 9+**版本兼容...

要获取 CurrentProcess 信息，

```
public class CurrentProcess {
    public static void main(String[] args) {
        ProcessHandle handle = ProcessHandle.current();
        System.out.println("Current Running Process Id: "+handle.pid());
        ProcessHandle.Info info = handle.info();
        System.out.println("ProcessHandle.Info : "+info);
    }
} 
```

对于所有正在运行的进程，

```
import java.util.List;
import java.util.stream.Collectors;

public class AllProcesses {
    public static void main(String[] args) {
        ProcessHandle.allProcesses().forEach(processHandle -> {
            System.out.println(processHandle.pid()+" "+processHandle.info());
        });
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-02-24T15:17:57.233

```
 String line;
    Process process = Runtime.getRuntime().exec("ps -e");
    process.getOutputStream().close();
    BufferedReader input =
            new BufferedReader(new InputStreamReader(process.getInputStream()));
    while ((line = input.readLine()) != null) {
        System.out.println(line); //<-- Parse data here.
    }
    input.close();
```

我们必须使用，`process.getOutputStream.close()`否则它将被锁定在 while 循环中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-30T05:22:34.453

```
package com.vipul;

import java.applet.Applet;
import java.awt.Checkbox;
import java.awt.Choice;
import java.awt.Font;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class BatchExecuteService extends Applet {
    public Choice choice;

    public void init() 
    {
        setFont(new Font("Helvetica", Font.BOLD, 36));
        choice = new Choice();
    }

    public static void main(String[] args) {
        BatchExecuteService batchExecuteService = new BatchExecuteService();
        batchExecuteService.run();
    }

    List<String> processList = new ArrayList<String>();

    public void run() {
        try {
            Runtime runtime = Runtime.getRuntime();
            Process process = runtime.exec("D:\\server.bat");
            process.getOutputStream().close();
            InputStream inputStream = process.getInputStream();
            InputStreamReader inputstreamreader = new InputStreamReader(
                    inputStream);
            BufferedReader bufferedrReader = new BufferedReader(
                    inputstreamreader);
            BufferedReader bufferedrReader1 = new BufferedReader(
                    inputstreamreader);

            String strLine = "";
            String x[]=new String[100];
            int i=0;
            int t=0;
            while ((strLine = bufferedrReader.readLine()) != null) 
            {
        //      System.out.println(strLine);
                String[] a=strLine.split(",");
                x[i++]=a[0];
            }
    //      System.out.println("Length : "+i);

            for(int j=2;j<i;j++)
            {
                System.out.println(x[j]);
            }
        }
        catch (IOException ioException) 
        {
            ioException.printStackTrace();
        }

    }
} 
```

> ```
>  You can create batch file like 
> ```
> 
> TASKLIST /v /FI "STATUS eq running" /FO "CSV" /FI "用户名 eq LHPL002\soft" /FI "MEMUSAGE gt 10000" /FI "Windowtitle ne N/A" /NH

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-12-29T01:51:54.520

这是我获取任务并获取其名称的函数的代码，还将它们添加到列表中以从列表中访问。它使用数据创建临时文件，读取文件并获取带有 .exe 后缀的任务名称，并在程序以 System.exit(0) 退出时安排要删除的文件，它还隐藏用于获取任务和 java.exe，这样用户就不会意外地杀死一起运行程序的进程。

```
private static final DefaultListModel tasks = new DefaultListModel();

public static void getTasks()
{
    new Thread()
    {
        @Override
        public void run()
        {
            try 
            {
                File batchFile = File.createTempFile("batchFile", ".bat");
                File logFile = File.createTempFile("log", ".txt");
                String logFilePath = logFile.getAbsolutePath();
                try (PrintWriter fileCreator = new PrintWriter(batchFile)) 
                {
                    String[] linesToPrint = {"@echo off", "tasklist.exe >>" + logFilePath, "exit"};
                    for(String string:linesToPrint)
                    {
                        fileCreator.println(string);
                    }
                    fileCreator.close();
                }
                int task = Runtime.getRuntime().exec(batchFile.getAbsolutePath()).waitFor();
                if(task == 0)
                {
                    FileReader fileOpener = new FileReader(logFile);
                    try (BufferedReader reader = new BufferedReader(fileOpener))
                    {
                        String line;
                        while(true)
                        {
                            line = reader.readLine();
                            if(line != null)
                            {
                                if(line.endsWith("K"))
                                {
                                    if(line.contains(".exe"))
                                    {
                                        int index = line.lastIndexOf(".exe", line.length());
                                        String taskName = line.substring(0, index + 4);
                                        if(! taskName.equals("tasklist.exe") && ! taskName.equals("cmd.exe") && ! taskName.equals("java.exe"))
                                        {
                                            tasks.addElement(taskName);
                                        }
                                    }
                                }
                            }
                            else
                            {
                                reader.close();
                                break;
                            }
                        }
                    }
                }
                batchFile.deleteOnExit();
                logFile.deleteOnExit();
            } 
            catch (FileNotFoundException ex) 
            {
                Logger.getLogger(Functions.class.getName()).log(Level.SEVERE, null, ex);
            } 
            catch (IOException | InterruptedException ex) 
            {
                Logger.getLogger(Functions.class.getName()).log(Level.SEVERE, null, ex);
            }
            catch (NullPointerException ex)
            {
                // This stops errors from being thrown on an empty line
            }
        }
    }.start();
}

public static void killTask(String taskName)
{
    new Thread()
    {
        @Override
        public void run()
        {
            try 
            {
                Runtime.getRuntime().exec("taskkill.exe /IM " + taskName);
            } 
            catch (IOException ex) 
            {
                Logger.getLogger(Functions.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }.start();
} 
```

# asp.net - 修改 AJAX 控件工具包下拉扩展程序

> ID：54702
> 
> 赞同：3
> 
> 时间：2008-09-10T17:02:00.707
> 
> 标签：asp.net, asp.net-ajax, ajaxcontroltoolkit

我将 AJAX 网站上的示例用于[`DropDownExtender`](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/DropDown/DropDown.aspx). 我希望使目标控件（标签）始终显示 DropDown 图像，而不仅仅是当我将鼠标悬停在它上面时。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-11T03:19:07.947

这可以使用以下脚本标签来完成：

```
 <script>
    function pageLoad()
    {
        $find('TextBox1_DropDownExtender')._dropWrapperHoverBehavior_onhover();
        $find('TextBox1_DropDownExtender').unhover = VisibleMe;
    }  

    function VisibleMe()
    {
        $find('TextBox1_DropDownExtender')._dropWrapperHoverBehavior_onhover();
    }
</script> 
```

[我在这个 dot net curry example](http://www.dotnetcurry.com/ShowArticle.aspx?ID=167)中找到了这个和其他一些技巧。

它可以工作，但我也会考虑编写一个基于下拉扩展器的新控件，该控件公开一个属性以设置您想要打开或关闭的行为。

编写一个新的 AJAX 控件并不难，比什么都复杂。

# testing - 我应该为小任务选择脚本还是编译代码？

> ID：54703
> 
> 赞同：6
> 
> 时间：2008-09-10T17:02:03.500
> 
> 标签：testing, scripting

我是一名 Java 程序员，我喜欢我的编译器、静态分析工具和单元测试框架，这些工具可以帮助我快速交付健壮和高效的代码。JRE 也几乎无处不在。

鉴于这种情况，我看不出为什么我会选择使用 shell 脚本、vb 脚本等，无论任务多么小，如果我戴上我的其他帽子，比如我很酷的黑色系统管理员 fedora。

我不经常戴其他帽子，**在什么情况下我应该选择脚本而不是编写编译代码？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T17:06:00.510

如果您对 Java 感到满意，并且 JRE 无处不在，那么我会说继续使用它。然而，像 perl 和 python 这样的语言特别适合快速解决问题。我建议学习 perl 或 python，然后根据您的判断何时使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T17:13:15.720

如果我想快速解决一个小问题，我倾向于使用脚本语言。代码税更小，而且，至少对我来说，结果来得更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T17:16:07.053

任何你认为对你最有效的东西！

我有一个同事，似乎每项任务都使用不同的语言。Perl 用于快速文本处理，PHP 用于小型内部 Web 应用程序，.NET 用于我们的主要产品，cygwin 用于文件系统。他更喜欢使用最适合手头任务的技术。

就个人而言，我发现技术之间的上下文切换很痛苦。我的日常工作是在 .NET 中进行的，所以这几乎就是我认为的术语。对于大多数任务，我发现使用 SnippetCompiler 在 C# 中敲击某些东西比在 PowerShell 或脚本环境中破解更有效.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T17:06:00.370

我会说哪里有意义。如果您打开 IDE、编译脚本等比编辑脚本文件并完成它比使用脚本文件花费更长的时间。如果您不打算经常更改内容并且在 Java 编码方面更快，那么请走那条路 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T17:06:50.633

编写脚本通常比编译程序更快。您不必担心不同平台和环境之间的可移植性。shell 脚本几乎可以在大多数平台上的任何地方运行。因为您是一名 java 开发人员，并且您提到您在任何地方都有 java，您可能会看到 groovy ( [http://groovy.codehaus.org/](http://groovy.codehaus.org/) )。它是一种用 java 编写的脚本语言，能够使用 java 库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T17:10:18.957

我看到它的方式（其他人不同意）你的所有代码都需要可维护。最小的有用代码集合是由一个人维护的。即使这也受益于您提到的语言和工具。

但是，显然在某些任务中，专门的语言比单一的通用语言更有优势。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T17:13:48.743

如果你可以用 Java 更快地编写它，那就去吧。

只需尝试并了解各种脚本语言可以做什么。

例如，当您可以使用 bash 单行代码做同样的事情时，不要制作完整的 Java 应用程序。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T17:15:41.470

权衡工具对弹出打开文本编辑器以进行快速编辑与打开 IDE、重新编译、重新部署等的重要性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T17:26:58.167

当然，首要指令应该是“使用任何你喜欢的东西”。如果 Java 能够按时正确完成工作，请坚持下去。但是许多脚本语言可以为您节省一些时间，因为它们适应不同的问题。如果您使用正则表达式，那么脚本语言非常适合。如果您要使用 shell 命令，那么脚本很好。

每当我写一些小的东西时，我都倾向于使用 Ruby 脚本，因为它写起来很快，易于维护，并且（使用 Gems）很容易在不需要使用 JAR 或任何东西的情况下添加额外的功能。当然，您的里程会有所不同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-10T17:29:44.103

归根结底，这是一个只有您自己才能回答的问题。基于您说“我看不出为什么我会选择使用 shell 脚本，......”的事实，那么您现在可能永远不应该选择它。

但如果我是你，我会选择一种脚本语言，如 python、ruby 或 perl，并开始尝试用这种语言解决其中的一些小问题。随着时间的推移，您会开始感觉到什么时候编写一个快速脚本比构建一个完整的解决方案更合适。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-10T17:45:46.953

我使用脚本语言编写程序，这些程序预计不会在几次执行之后被维护。这些语言中的大多数都使用样板语法，并且确实具有 REPL。这两个特性都支持快速原型制作。

由于您已经了解 Java，因此您可以尝试像 Groovy、JRuby、BeanShell 等 JVM 语言。Scala 的语法比 Java 轻得多，有一个 REPL，是静态类型的并在 JVM 上运行——您也可以尝试一下。

# asp.net - 以编程方式访问 ASP.NET 2.0 中继器中的数据

> ID：54708
> 
> 赞同：4
> 
> 时间：2008-09-10T17:03:10.470
> 
> 标签：asp.net, repeater, data-access

这是一个 ASP.Net 2.0 网络应用程序。Item 模板如下所示，供参考：

```
<ItemTemplate>
  <tr>
    <td class="class1" align=center><a href='url'><img src="img.gif"></a></td>
    <td class="class1"><%# DataBinder.Eval(Container.DataItem,"field1") %></td>
    <td class="class1"><%# DataBinder.Eval(Container.DataItem,"field2") %></td>
    <td class="class1"><%# DataBinder.Eval(Container.DataItem,"field3") %></td>
    <td class="class1"><%# DataBinder.Eval(Container.DataItem,"field4") %></td>
  </tr>
</ItemTemplate> 
```

在代码隐藏中使用它：

```
foreach (RepeaterItem item in rptrFollowupSummary.Items)
{
    string val = ((DataBoundLiteralControl)item.Controls[0]).Text;
    Trace.Write(val);
} 
```

我制作这个：

```
<tr>
  <td class="class1" align=center><a href='url'><img src="img.gif"></a></td>
  <td class="class1">23</td>
  <td class="class1">1/1/2000</td>
  <td class="class1">-2</td>
  <td class="class1">11</td>
</tr> 
```

我需要的是来自 Field1 和 Field4 的数据

我似乎无法以 DataList 或 GridView 的方式获取数据，而且我似乎无法在 Google 上提出任何其他内容或快速利用这个来做我想做的事。我能看到获取数据的唯一方法是使用正则表达式来获取它（因为一个人拿走了他想要的东西。他拿走了一切。我是男人，不是吗？Aren不是吗？）。

我是否走在正确的轨道上（不是在寻找特定的正则表达式来执行此操作；伪造这可能是一个后续问题；）），还是我错过了什么？

* * *

在这种情况下，中继器是一成不变的，所以我无法切换到更优雅的东西。曾几何时，我做了一些类似于 Alison Zhou 建议使用 DataLists 的事情，但已经有一段时间了（2 年多），我完全忘记了这样做。是的，谈论忽略一些明显的东西。. .

所以我按照艾莉森的建议做了，效果很好。我不认为这里的视图状态是一个问题，即使这个转发器可以获得几十行。如果这样做与使用相反，我真的无法回答这个问题（但这对我来说似乎是一个很好的解决方案）。显然后者不是一个视图状态足迹，但我没有足够的经验来说明什么时候一种方法可能比另一种方法更可取，而我面前没有一个极端的例子。艾莉森，一个问题：为什么是文字而不是标签？

Euro Micelli，我试图避免返回数据库。由于相对于开发世界的其他人来说，我仍然有点陌生，我承认我不一定很好地掌握有多少数据库旅行是“恰到好处”的。这里不会有性能问题（我知道应用程序的负载足以知道这一点），但我想我是出于习惯试图避免它，因为我的老板倾向于尽可能减少旅行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T17:15:19.223

在我的脑海中，你可以尝试这样的事情：

```
<ItemTemplate>
  <tr>
    <td "class1"><asp:Literal ID="litField1" runat="server" Text='<%# Bind("Field1") %>'/></td>
    <td "class1"><asp:Literal ID="litField2" runat="server" Text='<%# Bind("Field2") %>'/></td>
    <td "class1"><asp:Literal ID="litField3" runat="server" Text='<%# Bind("Field3") %>'/></td>
    <td "class1"><asp:Literal ID="litField4" runat="server" Text='<%# Bind("Field4") %>'/></td>
  </tr>
</ItemTemplate> 
```

然后，在您后面的代码中，您可以按如下方式访问每个 Literal 控件：

```
foreach (RepeaterItem item in rptrFollowupSummary.Items)
{   
    Literal lit1 = (Literal)item.FindControl("litField1");
    string value1 = lit1.Text;
    Literal lit4 = (Literal)item.FindControl("litField4");
    string value4 = lit4.Text;
} 
```

这将添加到您的 ViewState 中，但它可以很容易地找到您的控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T17:12:55.610

由于您使用的是表格数据，因此我建议您使用 GridView 控件。然后，您将能够访问单个单元格。

否则，您可以将 Field1 和 Field4 的 td 设置为`runat="server"`并给它们 ID。然后在代码隐藏中，访问`InnerText`每个 td 的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T17:15:03.127

如果您可以在生成过程中承担更多开销，请选择 DataList 并使用 DataKeys 属性，这将保存您需要的数据字段。

您还可以在每个表格单元格中使用标签，并能够使用 e.Item.FindControl("LabelID") 引用项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T17:41:06.790

<%#DataBinder.Eval(...) %> 机制不是“严格”意义上的数据绑定。这是一种将文本放在模板中特定位置的单向技术。

如果您需要取回数据，您必须：

1.  从源数据中获取
2.  使用不同的机制填充中继器

请注意，Repeater 不会在回发之间保存 DataSource，您不能只要求它稍后再给您数据。

第一种方法通常更容易使用。不要以为从源头重新获取数据太昂贵，除非您通过测量向自己证明；它通常很快。这种技术的最大问题是源数据是否会在调用之间发生变化。

对于第二种方法，一种常见的技术是使用 Literal 控件。有关如何执行此操作的示例，请参阅[Alison Zhou的帖子。](https://stackoverflow.com/questions/54708/programmatically-accessing-data-in-an-aspnet-20-repeater#54745)我个人通常更喜欢在 OnItemDataBound 内填充 Literal 控件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T18:23:24.333

[@和平狗](https://stackoverflow.com/questions/54708/programmatically-accessing-data-in-an-aspnet-20-repeater#54860)：

正确的; 艾莉森的方法是完全可以接受的。

数据库往返的技巧：它们显然不是免费的，但是 Web 服务器往往与数据库非常“接近”（快速、低延迟的连接），而您的用户可能“远离”（缓慢、高延迟的连接）联系）。

因此，通过 cookie、ViewState、隐藏字段或任何其他方法向浏览器发送数据或从浏览器发送数据实际上可能比从数据库中再次读取数据“更糟糕”。还需要牢记安全隐患（“邪恶”用户可以伪造从浏览器返回的数据吗？他们这样做有关系吗？）。

但很多时候它对性能没有任何影响。**这就是为什么你应该为你的特定问题做更自然的事情，并且只有在**性能开始成为现实问题时才担心它。

祝你好运！

# c# - 与 Rhino Mocks 一起使用的最佳样式/语法是什么？

> ID：54709
> 
> 赞同：9
> 
> 时间：2008-09-10T17:03:20.547
> 
> 标签：c#, unit-testing, syntax, rhino-mocks, mocking

使用 Rhino Mocks 时，存在多种编写单元测试的方法：

*   标准语法
*   记录/重播语法
*   流利的语法

什么是最理想最无摩擦的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T18:06:49.677

对于 .NET 2.0，我推荐使用记录/回放模型。我们喜欢这样，因为它清楚地将您的期望与您的验证区分开来。

```
using(mocks.Record())
{
    Expect.Call(foo.Bar());
}
using(mocks.Playback())
{
    MakeItAllHappen();
} 
```

如果您使用的是 .NET 3.5 和 C# 3，那么我建议您使用流利的语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T17:43:47.317

有趣的问题！我自己的偏好是基于反射的语法（我猜你的意思是标准语法）。我认为这是最顺畅的，因为它不会添加太多额外的代码：您可以直接在接口上引用存根，就好像它们已正确实现一样。

我也很喜欢 Fluent 语法，虽然这很麻烦。Record/Replay 语法和 Fluent 语法一样麻烦（如果不是更麻烦的话，看起来），但不太直观（至少对我来说）。我只使用过 NMock2，所以 Record/Replay 语法对我来说有点陌生，而 Fluent 语法却很熟悉。

但是，正如[这篇文章](https://yellowduckguy.wordpress.com/2007/10/06/rhino-mocks-v3-2-new-syntax/)所建议的，如果您希望将您的期望与您的验证/断言分开，您应该选择 Fluent 语法。最终，这完全取决于风格和个人喜好:-)

# unix - 更改 Unix“邮件”中的“发件人：”地址

> ID：54725
> 
> 赞同：96
> 
> 时间：2008-09-10T17:08:37.867
> 
> 标签：unix, email

使用来自 Unix 命令行的结果从 Unix 命令行发送消息`mail TO_ADDR`会产生一封电子邮件`$USER@$HOSTNAME`。有没有办法更改插入的“发件人：”地址`mail`？

作为记录，我在 Ubuntu 上使用 GNU Mailutils 1.1/1.2（但我在 Fedora 和 RHEL 上看到了相同的行为）。

[编辑]

```
$ mail -s 测试 chris@example.org                                                                  
抄送：
来自：foo@bar.org

测试
.

```

产量

```
主题：测试
致：<chris@example.org>
X-Mailer：邮件（GNU Mailutils 1.1）
消息 ID：<E1KdTJj-00025z-RK@localhost>
来自：<chris@localhost>
日期：2008 年 9 月 10 日，星期三 13:17:23 -0400

来自：foo@bar.org

测试

```

“发件人：foo@bar.org”行是邮件正文的一部分，而不是标题的一部分。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-12-19T10:09:18.020

在我的邮件版本（Debian linux 4.0）中，以下选项用于控制源/回复地址

*   **-a**开关，用于应用附加标头，在命令行上提供 From: 标头，该标头将附加到外发邮件标头
*   **$REPLYTO**环境变量指定一个回复：标题

所以下面的序列

```
export REPLYTO=cms-replies@example.com
mail -aFrom:cms-sends@example.com -s 'Testing' 
```

结果，在我的邮件客户端中，是来自 cms-sends@example.com 的邮件，任何回复都将默认为 cms-replies@example.com

*注意：* Mac OS 用户：你没有 -a ，但你有**$REPLYTO**

*NB(2)：* CentOS 用户，很多评论者补充说你需要使用`-r`not`-a`

*注意（3）：*这个答案至少有十年的历史（1），当你从谷歌进来时请记住这一点。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-01-13T18:04:57.533

在 Centos 5.3 上，我可以做到：

```
mail -s "Subject" user@address.com -- -f from@address.com < body 
```

双破折号阻止邮件解析 -f 参数并将其传递给 sendmail 本身。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-12-23T13:53:34.180

GNU mailutils 的'mail' 命令不允许你这样做（至少很容易）。但是如果你安装'heirloom-mailx'，它的邮件命令（mailx）有'-r'选项来覆盖字段中的默认'$USER@$HOSTNAME'。

```
echo "Hello there" | mail -s "testing" -r sender@company.com recipient@company.com 
```

适用于“mailx”但不适用于“邮件”。

```
$ ls -l /usr/bin/mail
lrwxrwxrwx 1 root root 22 2010-12-23 08:33 /usr/bin/mail -> /etc/alternatives/mail
$ ls -l /etc/alternatives/mail
lrwxrwxrwx 1 root root 23 2010-12-23 08:33 /etc/alternatives/mail -> /usr/bin/heirloom-mailx

```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-07-25T18:35:55.493

```
mail -s "$(echo -e "This is the subject\nFrom: Paula <johny@paula.com>\n
Reply-to: 1232564@yourserver.com\nContent-Type: text/html\n")" 
milas.josh@gmail.com < htmlFileMessage.txt 
```

以上是我的解决方案....任何额外的标题都可以在 from 之后和回复之前添加...只需确保在添加它们之前了解您的标题语法....这对我来说非常有效。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-12-13T01:21:44.450

另外，最好使用`-F option`指定发件人的姓名。

像这样的东西：

```
mail -s "$SUBJECT" $MAILTO -- -F $MAILFROM -f ${MAILFROM}@somedomain.com 
```

或者只是看看可用的选项： http: [//www.courier-mta.org/sendmail.html](http://www.courier-mta.org/sendmail.html)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-09-25T14:16:32.917

也可以使用以下方式设置发件人名称和发件人地址：

```
 echo test | mail -s "test" example@example.com -- -F'Some Name<example2@example.com>' -t 
```

出于某种原因，传递`-F'Some Name'`并`-fexample2@example.com`不起作用，但传递`-t`到 sendmail 工作并且“容易”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-10T17:16:29.627

以下是一些选项：

*   如果您有足够的权限，请配置 sendmail 以使用泛型表进行重写

*   自己写整个报头（或者邮寄给自己，用所有报头保存整条消息，重新编辑，从命令行用rmail发送

*   使用 sendmail 直接发送，使用“-f”命令行标志，并且不要在邮件中包含“发件人：”行

这些并不完全相同，但我会留给你进一步研究。

在我的便携式设备上，我将 sendmail 作为客户端身份验证到外发邮件服务器，并且我使用泛型将返回的邮件发送到另一个帐户。它就像一个魅力。我用 fetchmail 汇总收到的邮件。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-09-30T07:04:29.087

我从上述所有答案中得出这一点。当我尝试每一个时，没有什么对我有用。通过结合上述所有答案并得出结论，我做了很多尝试和错误。我不确定这是否适合您，但它适用于 Ununtu 12.04 和 RHEL 5.4。

```
echo "This is the body of the mail" | mail -s 'This is the subject' '<receiver-id1@email.com>,<receiver-id2@email.com>' -- -F '<SenderName>' -f '<from-id@email.com>' 
```

可以通过添加任意数量的接收者 ID 将邮件发送给任意数量的人，并且邮件由来自**from-id@email.com的****SenderName发送**

希望这可以帮助。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-05-25T02:27:47.733

谢谢博

```
mail -s "Subject" user@address.com -- -f from@address.com 
```

我刚刚找到了这个，它对我有用。CentOS 5 上 mail 8.1 的手册页没有提到这一点。对于`-f`选项，手册页说：

> -f 从文件操作数命名的文件而不是系统邮箱中读取消息。（另请参见文件夹。）如果未指定文件操作数，则从 mbox 而不是系统邮箱读取消息。

所以无论如何这很好找到，谢谢。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-05-25T12:31:21.470

我不知道它是否与其他操作系统相同，但在 OpenBSD 中，邮件命令具有以下语法：

```
mail to-addr ... -sendmail-options ... 
```

sendmail 有 -f 选项，您可以在其中指定 FROM: 字段的电子邮件地址。以下命令对我有用。

```
mail recepient@example.com -f from@example.com 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-03-01T01:11:10.317

在 Debian 7 上，我仍然无法使用此问题的答案正确设置发件人地址（始终是服务器的主机名），但以这种方式解决了它。

安装**传家宝-mailx**

```
apt-get install heirloom-mailx 
```

确保它是默认值。

```
update-alternatives --config mailx 
```

撰写消息。

```
mail -s "Testing from & replyto" -r "sender <sender@example.com>" -S replyto="sender@example.com" recipient@example.net < <(echo "Test message") 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-02-18T14:13:15.743

在 CentOS 上，这对我有用：

```
echo "email body" | mail -s "Subject here" -r from_email_address email_address_to 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-04-15T09:09:55.013

`echo "body" | mail -S from=address@foo.com "Hello"`

-S 允许您指定许多字符串选项，这是迄今为止修改标题等最简单的方法。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-07-20T13:55:25.673

回声“测试” | mailx -r fake@example.com -s 'test' email@example.com

它适用于 OpenBSD。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-30T07:33:44.103

这对我有用

```
echo "hi root"|mail -rsawrub@testingdomain.org -s'testinggg' root 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-10T23:15:22.790

在 CentOS 5.5 上，我发现从域设置默认值的最简单方法是修改主机文件。如果您的主机文件包含您的 WAN/公共 IP 地址，只需修改为其列出的第一个主机名。例如，您的主机文件可能如下所示：

> ...
> 11.22.33.44 localhost 默认域**whatever-else.com**
> ...

要使其从whatever-else.com 发送，只需对其进行修改，以便首先列出whatever-else.com，例如：

> ...
> 11.22.33.44**不管什么**-else.com本地主机默认域
> ...

我不能代表任何其他发行版（甚至是 CentOS 的版本），但在我的特定情况下，上述内容完美无缺。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-07-03T14:43:17.450

是什么让我在`Ubuntu 16.04`带有`UTF-8`编码和文件附件的情况下拥有自定义回复地址：

安装邮件客户端：

```
sudo apt-get install heirloom-mailx 
```

编辑 SMTP 配置：

```
sudo vim /etc/ssmtp/ssmtp.conf
mailhub=smtp.gmail.com:587
FromLineOverride=YES
AuthUser=???@gmail.com
AuthPass=???
UseSTARTTLS=YES 
```

发送邮件：

```
sender='send@domain.com'
recipient='recipient@domain.com'
zipfile="results/file.zip"
today=`date +\%d-\%m-\%Y`
mailSubject='My subject on the '$today
read -r -d '' mailBody << EOM
Find attached the zip file.

Regards,
EOM
mail -s "$mailSubject" -r "Name <$sender>" -S replyto="$sender" -a $zipfile $recipient < <(echo $mailBody) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-01-16T11:11:22.173

以上解决方案都不适合我...

```
#!/bin/bash

# Message
echo "My message" > message.txt

# Mail
subject="Test"
mail_header="From: John Smith <john.smith@example.com>"
recipients="recipient@example.com"

#######################################################################
cat message.txt | mail -s "$subject" -a "$mail_header" -t "$recipients" 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-05-12T14:18:30.860

我最近的[GNU mailutils`mail`](https://mailutils.org/manual/html_section/mail.html)版本很简单`mail -r foo@bar.com`。

查看原始发送的邮件，似乎同时设置了`Return-Path: <foo@bar.com>`和`From: foo@bar.com`。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2014-06-04T08:54:01.177

之前提供的答案在 CentOS5 上对我不起作用。我安装了笨蛋。它有很多选择。使用 mutt 你可以这样做：

```
export EMAIL=myfrom@example.com
export REPLYTO=myreplyto@example.com
mutt -s Testing chris@example.org 
```

# methodology - 质量与投资回报率 - 什么时候足够好，足够好？

> ID：54737
> 
> 赞同：0
> 
> 时间：2008-09-10T17:12:30.120
> 
> 标签：methodology, roi

更新：我是从**开发的角度**问这个问题，但是为了说明，我想到的一个典型的*非开发*示例是，如果保持 99% 的正常运行时间率需要花费 10,000 美元，那么理论上可以花费 100,000 美元保持 99.9% 的利率，可能需要 1,000,000 美元来保持 99.99% 的利率。

有点像微积分接近 0，当我们接近 100% 时，成本会成倍增加。因此，作为开发人员或 PM，在时间和金钱限制的情况下，您如何确定可交付成果“足够好”，例如：您是否获得了 99%、99.9%、99.99% 的良好投资回报率？

我使用的是非开发示例，因为我不确定开发的可靠指标。也许在上面的示例中，“正常运行时间”可以替换为“功能点与缺陷比率”，或者一些这样合理的错误率与代码复杂性的度量。我也欢迎就软件开发生命周期的所有阶段提供意见。

牢记经典的[项目三角](http://en.wikipedia.org/wiki/Project_triangle)约束（质量、速度和成本）。让我们假设客户希望在原始预算的情况*下能够提供最好的质量。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T17:41:44.403

如果不知道*应用程序出现故障时会发生什么，*就无法回答这个问题。

*   如果在您的应用程序出现故障时有人死亡，那么正常运行时间值得花费数百万甚至数十亿美元购买（航空航天、医疗设备）。
*   如果您的软件出现故障可能有人受伤，正常运行时间价值数十万或数百万美元（工业控制系统、汽车安全设备）
*   如果有人在您的软件出现故障时损失数百万美元，那么正常运行时间值得花费数百万美元（金融服务、大型电子商务应用程序）。
*   如果有人在您的软件出现故障时损失数千美元，那么正常运行时间值得花费数千美元（零售、小型电子商务应用程序）。
*   如果有人会在您的软件出现故障时对计算机发誓并在重新启动时降低生产力，那么正常运行时间值得花费数千美元（大多数内部软件）。
*   等等

基本上拿（宕机成本）x（软件宕机次数），你就知道在正常运行时间上要花多少钱。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T01:39:01.933

我见过的质量与足够好的讨论在 95% 的缺陷修复时具有实际的投资回报率。显然，显示塞子/严重缺陷是固定的（并且总是有例外，如飞机自动驾驶仪等，不需要有这么多缺陷）。

我似乎找不到对 95% 缺陷修复的参考，它要么在 Rapid Development 中，要么在 Caper Jones 的 Applied Software Measurement 中。

以下是攻击代码质量的有用策略的链接： [http ://www.gamedev.net/reference/articles/article1050.asp](http://www.gamedev.net/reference/articles/article1050.asp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-12T21:53:55.857

**当然，客户可能会对这个数字犹豫不决，并可能会说每年不超过 1 小时的停机时间是可以接受的。那是稳定的 12 倍。您是告诉客户，抱歉，我们不能以 100,000 美元的价格做到这一点，还是您尽了最大努力，希望您的分析是保守的？**

直截了当地告诉客户他们想要什么是不合理的。为了获得这种正常运行时间，需要大量资金，而实际上，持续达到正常运行时间百分比的机会是不可能的。

我个人会回到客户那里，告诉他们您将为他们提供 100k 的最佳设置，并设置停机报告指南。例如，对于您遇到的每一次中断，我们都会完成一次关于为什么会发生这种中断的调查，以及我们将如何使再次发生这种情况的机会几乎不存在。

我认为提供 SLA 只是一个错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T17:17:08.067

我认为这个问题的答案完全取决于个人申请。

对人类安全有影响的软件与 RSS 提要阅读器的要求大不相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T17:45:33.770

项目三角形是一个粗略的简化。在很多情况下，您实际上可以通过提高质量来节省时间。例如，通过减少维修和避免维护成本。这不仅在软件开发中是正确的。丰田精益生产证明这在制造中也适用。

软件开发的整个过程过于复杂，无法对成本与质量进行概括。质量是一个由多个因素组成的模糊概念。可测试代码是否比高性能代码质量更高？可维护代码是否比可测试代码质量更高？您需要 RSS 阅读器的可测试代码还是高性能代码？而对于电传操纵 F16？

根据具体情况做出明智的决定会更有成效。不要害怕在质量上过度投资。它通常比投资不足更便宜、更安全。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T17:50:11.513

以同样简单的方式回答.. ..当您停止听取客户的意见时（而不是因为他们停止使用您的产品）.. 除了增强请求和花束 :)

而且它不是三角形，它有 4 个角 - 成本时间质量和范围。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T17:21:31.050

为了扩展“17 of 26”所说的内容，答案取决于对客户的价值。在关键软件的情况下，如飞机控制器应用程序，无论他们使用什么衡量标准，高质量评级对客户的价值都非常高。对于 RSS 提要阅读器的用户来说，高质量的价值要低得多。

一切都与*客户*有关（注意我没有说用户 - 有时它们是相同的，有时它们不是）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T17:54:07.260

追“质”二字，犹如追天涯。我从未见过任何（在 IT 世界或外部）100% 质量的东西。总是有改进的余地。

其次，“质量”是一个过于宽泛的术语。它对每个人都意味着不同的东西，并且在实施程度方面是主观的。

话虽如此，每一项努力都归结为“工程”的含义——做出正确的选择以平衡成本、时间和关键特性（即速度、尺寸、形状、重量等）。这些都是限制因素。

# debugging - 调试生成文件的工具

> ID：54753
> 
> 赞同：82
> 
> 时间：2008-09-10T17:16:45.850
> 
> 标签：debugging, makefile

我有一个大型遗留代码库，其中包含非常复杂的生成文件，并且有很多变量。有时我需要更改它们，我发现很难弄清楚为什么更改没有按我预期的方式进行。我想找到的是一个工具，它基本上可以对“make”过程进行逐步调试，我会给它一个目录，我将能够在不同点看到不同变量的值过程。没有一个调试标志似乎向我展示了我想要的东西，尽管我可能遗漏了一些东西。有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-09-10T17:22:44.107

您是否一直在查看运行`make -n`and`make -np`和 biggie的输出`make -nd`？

您使用的是相当新的版本`gmake`吗？

您是否查看过O'Reilly 网站上关于[调试 Makefile的免费章节，以获取他们的优秀著作“使用 GNU Make 管理项目”（](http://oreilly.com/catalog/make3/book/index.csp)[亚马​​逊链接](https://rads.stackoverflow.com/amzn/click/com/0596006101)）。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-11-24T09:45:26.847

我敢肯定，[翻拍](http://bashdb.sourceforge.net/remake/)是你正在寻找的。

从主页：

> **remake**是 GNU make 实用程序的补丁和现代化版本，它增加了改进的错误报告、以可理解的方式跟踪执行的能力以及调试器。

它具有类似 gdb 的界面，并受 (x)emacs 中的 mdb-mode 支持，这意味着断点、监视等。 如果您不喜欢 (x)emacs，则可以使用[DDD](http://www.gnu.org/software/ddd/)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-03-20T11:33:55.003

从 make 命令行选项的手册页：

```
-n, --just-print, --dry-run, --recon  
Print the commands that would be executed, but do not execute them.  

-d  Print debugging information in addition to normal processing.  
The debugging information says  
which files are being considered for remaking,  
which file-times are being compared and with what results,  
which files actually need  to  be  remade,  
which implicit  rules are considered and which are applied---  
everything interesting about how make decides what to do.  

--debug[=FLAGS] Print debugging information in addition to normal processing.  
If the FLAGS are omitted, then the behaviour is the same as if -d was specified.  
FLAGS may be:  
'a' for all debugging output same as using -d,  
'b' for basic debugging,  
'v' for more verbose basic debugging,  
'i' for showing implicit rules,  
'j' for details on invocation of commands, and  
'm' for debugging while remaking makefiles. 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-10T17:28:45.497

我不知道有任何特定标志可以完全满足您的要求，但是

```
--打印数据库
```

听起来它可能有用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-09-11T08:12:50.850

```
remake --debugger all
```

更多信息[https://vimeo.com/97397484](https://vimeo.com/97397484)

[https://github.com/rocky/remake/wiki/Installing](https://github.com/rocky/remake/wiki/Installing)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-14T15:22:44.327

[http://gmd.sf.net](http://gmd.sf.net)上有一个 GNU make 调试器项目，看起来非常有用。gmd 支持的主要功能是断点，它可能比单步更有用。要使用它，您从 http://gmd.sf.net 下载 gmd 并从[http://gmsl.sf.net](http://gmsl.sf.net)下载[gmsl](http://gmd.sf.net)，然后在您的 makefile 中执行“包含 gmd”。

# .net - 您如何使用 NHibernate 进行分页？

> ID：54754
> 
> 赞同：108
> 
> 时间：2008-09-10T17:16:53.230
> 
> 标签：.net, nhibernate, orm, pagination

例如，我想在 ASP.NET 网页中填充一个 gridview 控件，其中仅包含显示的行数所需的数据。NHibernate 如何支持这一点？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-10T17:27:33.860

`ICriteria`有一个`SetFirstResult(int i)`方法，它指示您希望获取的第一项的索引（基本上是您页面中的第一个数据行）。

它还有一个`SetMaxResults(int i)`方法，表示您希望获得的行数（即您的页面大小）。

例如，此条件对象获取数据网格的前 10 个结果：

```
criteria.SetFirstResult(0).SetMaxResults(10); 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-08-25T15:34:18.343

您还可以利用 NHibernate 中的 Futures 功能来执行查询以获取总记录数以及单个查询中的实际结果。

**例子**

```
 // Get the total row count in the database.
var rowCount = this.Session.CreateCriteria(typeof(EventLogEntry))
    .Add(Expression.Between("Timestamp", startDate, endDate))
    .SetProjection(Projections.RowCount()).FutureValue<Int32>();

// Get the actual log entries, respecting the paging.
var results = this.Session.CreateCriteria(typeof(EventLogEntry))
    .Add(Expression.Between("Timestamp", startDate, endDate))
    .SetFirstResult(pageIndex * pageSize)
    .SetMaxResults(pageSize)
    .Future<EventLogEntry>(); 
```

要获取总记录数，请执行以下操作：

```
int iRowCount = rowCount.Value; 
```

关于 Futures 给你的内容的一个很好的讨论在[这里](http://ayende.com/Blog/archive/2009/04/27/nhibernate-futures.aspx)。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2011-02-22T02:48:25.510

从 NHibernate 3 及更高版本，您可以使用`QueryOver<T>`：

```
var pageRecords = nhSession.QueryOver<TEntity>()
            .Skip((PageNumber - 1) * PageSize)
            .Take(PageSize)
            .List(); 
```

您可能还想像这样明确地对结果进行排序：

```
var pageRecords = nhSession.QueryOver<TEntity>()
            .OrderBy(t => t.AnOrderFieldLikeDate).Desc
            .Skip((PageNumber - 1) * PageSize)
            .Take(PageSize)
            .List(); 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-01-11T17:01:29.620

```
public IList<Customer> GetPagedData(int page, int pageSize, out long count)
        {
            try
            {
                var all = new List<Customer>();

                ISession s = NHibernateHttpModule.CurrentSession;
                IList results = s.CreateMultiCriteria()
                                    .Add(s.CreateCriteria(typeof(Customer)).SetFirstResult(page * pageSize).SetMaxResults(pageSize))
                                    .Add(s.CreateCriteria(typeof(Customer)).SetProjection(Projections.RowCountInt64()))
                                    .List();

                foreach (var o in (IList)results[0])
                    all.Add((Customer)o);

                count = (long)((IList)results[1])[0];
                return all;
            }
            catch (Exception ex) { throw new Exception("GetPagedData Customer da hata", ex); }
      } 
```

当分页数据时，是否有另一种方法可以从 MultiCriteria 获取键入的结果，或者每个人都像我一样做同样的事情？

谢谢

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2008-09-10T17:26:22.317

如Ayende的[这篇博](http://www.ayende.com/Blog/archive/2007/03/20/Linq-For-NHibernate-Orderring-and-Paging.aspx)文中所讨论的那样，使用 Linq to NHibernate 怎么样？

代码示例：

```
(from c in nwnd.Customers select c.CustomerID)
        .Skip(10).Take(10).ToList(); 
```

这里是 NHibernate 团队博客上关于[使用 NHibernate 进行数据访问](http://www.nhforge.org/blogs/nhibernate/archive/2008/08/31/data-access-with-nhibernate.aspx)的详细文章，包括实现分页。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-26T06:23:26.510

很可能在 GridView 中，您将希望显示一个数据片段加上与您的查询匹配的数据总量的总行数（行数）。

您应该使用 MultiQuery 在一次调用中将 Select count(*) 查询和 .SetFirstResult(n).SetMaxResult(m) 查询发送到您的数据库。

请注意，结果将是一个包含 2 个列表的列表，一个用于数据切片，一个用于计数。

例子：

```
IMultiQuery multiQuery = s.CreateMultiQuery()
    .Add(s.CreateQuery("from Item i where i.Id > ?")
            .SetInt32(0, 50).SetFirstResult(10))
    .Add(s.CreateQuery("select count(*) from Item i where i.Id > ?")
            .SetInt32(0, 50));
IList results = multiQuery.List();
IList items = (IList)results[0];
long count = (long)((IList)results[1])[0]; 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-10T17:57:27.453

我建议您创建一个特定的结构来处理分页。类似的东西（我是一名 Java 程序员，但这应该很容易映射）：

```
public class Page {

   private List results;
   private int pageSize;
   private int page;

   public Page(Query query, int page, int pageSize) {

       this.page = page;
       this.pageSize = pageSize;
       results = query.setFirstResult(page * pageSize)
           .setMaxResults(pageSize+1)
           .list();

   }

   public List getNextPage()

   public List getPreviousPage()

   public int getPageCount()

   public int getCurrentPage()

   public void setPageSize()

} 
```

我没有提供实现，但您可以使用[@Jon](https://stackoverflow.com/questions/54754/how-can-you-do-paging-with-nhibernate#54777)建议的方法。这是一个[很好的讨论](http://in.relation.to/Bloggers/PaginationInHibernateAndEJB3)，供您查看。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-15T08:37:04.817

您不需要定义 2 个标准，您可以定义一个并克隆它。要克隆 nHibernate 标准，您可以使用简单的代码：

```
var criteria = ... (your criteria initializations)...;
var countCrit = (ICriteria)criteria.Clone(); 
```

# c# - 获取 WebBrowser 控件的 back/fwd 历史记录

> ID：54758
> 
> 赞同：5
> 
> 时间：2008-09-10T17:17:21.530
> 
> 标签：c#, .net, winforms, navigation, webbrowser-control

在 C# WinForms 中，获取 System.Windows.Forms.WebBrowser 的向后/向前历史堆栈的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-21T02:20:47.637

查看[http://www.bsalsa.com/downloads.html](http://www.bsalsa.com/downloads.html)。这是一系列 Delphi 组件（免费源代码，您可以在这里看到一个示例：http: [//staruml.cvs.sourceforge.net/staruml/staruml/staruml/components/plastic-components/src/embeddedwb.pas ?revision=1.1&view=markup](http://staruml.cvs.sourceforge.net/staruml/staruml/staruml/components/plastic-components/src/embeddedwb.pas?revision=1.1&view=markup) - 这是starUML 项目代码），除其他外，他们有一种使用IE MSHTML 界面获取历史记录、收藏夹等的方法。它是用 Object Pascal 编写的，但应该不难弄清楚发生了什么。如果您下载“嵌入式 Web 浏览器组件包”，请查看 EmbeddedWB_D2005\Source 中的内容 - 那里有各种各样的好东西。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-11T09:01:23.663

看起来不可能。

我的建议是捕捉**Navigated**事件并维护您自己的列表。一个可能的问题是当用户在浏览器中单击*返回*时，您不知道展开堆栈。

# cocoa - 取消过滤 NSPasteboard

> ID：54760
> 
> 赞同：5
> 
> 时间：2008-09-10T17:20:03.597
> 
> 标签：cocoa, filtering, pasteboard

有没有办法为源应用程序特别声明它将提供的内容取消过滤 NSPasteboard？

我正在尝试在我的应用程序中序列化粘贴板数据。当另一个应用程序将 RTF 文件放在粘贴板上，然后我询问可用类型时，我会得到十一种不同风格的 RTF，从原始 RTF 到纯字符串再到 dyn.* 值。

将所有数据保存到磁盘上的 plist 或原始数据通常不是问题，因为它非常小，但是当在粘贴板上放置任何相当大的图像时，生成的输出可能比源大几十倍数据（通过过滤提供多种类型的 TIFF 和 PICT 数据）。

如果可能的话，我希望能够保存原始应用程序提供的内容。

* * *

约翰，你比我自己或与我一起工作的那位自恐龙在地球上漫游以来一直在做 Mac 编程的绅士要敏锐得多。我们都没有注意到你突出显示的文字......我不知道为什么。显然，在这个问题上开始时间太长了。

虽然我接受了您的答案作为正确答案，但它并不能完全回答我原来的问题。我一直在寻找一种方法来识别可以变成其他口味的口味，只需将它们放在粘贴板上**，**并知道这些类型中的哪些最初是由供应商提供的。虽然遍历类型列表会给我提供提供它们的应用程序的首选顺序，但它不会告诉我可以安全地忽略哪些，因为稍后我重新填充粘贴板时会重新创建它们。

我得出的结论是，没有“好”的方法可以做到这一点。 `[NSPasteboard declaredTypesFromOwner]`会很棒，但它不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-11T22:06:49.657

`-[NSPasteboard types]`将返回剪贴板上数据的所有可用类型，但它应该[“按照它们被声明的顺序”返回它们。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSPasteboard_Class/Reference/Reference.html#//apple_ref/occ/instm/NSPasteboard/types)

的文档`-[NSPasteboard declareTypes:owner:]`说[“应根据源应用程序的偏好对类型进行排序”。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSPasteboard_Class/Reference/Reference.html#//apple_ref/occ/instm/NSPasteboard/declareTypes:owner:)

因此，正确实施的粘贴板所有者应将内容的最丰富表示（可能是原始内容）声明为第一种类型；所以一个合理的单一表示应该是：

```
[pb dataForType:[[pb types] objectAtIndex:0]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T18:32:25.840

您也许可以从[`+[NSPasteboard typesFilterableTo:]`](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSPasteboard_Class/Reference/Reference.html#//apple_ref/occ/clm/NSPasteboard/typesFilterableTo:). 我正在描绘这样的片段：

```
NSArray *allTypes = [pb types];
NSAssert([allTypes count] > 0, @"expected at least one type");

// We always require the first declared type, as a starting point.
NSMutableSet *requiredTypes = [NSMutableSet setWithObject:[allTypes objectAtIndex:0]];

for (NSUInteger index = 1; index < [allTypes count]; index++) {
    NSString *aType = [allTypes objectAtIndex:index];
    NSSet *filtersFrom = [NSSet setWithArray:[NSPasteboard typesFilterableTo:aType]];

    // If this type can't be re-created with a filter we already use, add it to the
    // set of required types.
    if (![requiredTypes intersectsSet:filtersFrom])
        [requiredTypes addObject:aType];
} 
```

但是，我不确定这在选择好的类型方面有多有效。

# clickonce - ClickOnce 部署，需要系统更新 Microsoft.mshtml

> ID：54770
> 
> 赞同：1
> 
> 时间：2008-09-10T17:24:56.067
> 
> 标签：clickonce, microsoft.mshtml

我们有一个与 MS Office 配合使用并使用 Microsoft.mshtml.dll 的应用程序。我们使用 ClickOnce 来部署应用程序。该应用程序在大多数机器上部署都没有问题，但有时我们会收到错误消息“需要系统更新，Microsoft.mshtl.dll 应该在 GAC 中”。

我们尝试安装 PIA for Office，但没有成功。由于 Microsoft.mshtml.dll 是一个系统相关文件，我们不能将它包含在包中并重新分发它。部署应用程序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T17:40:48.040

您知道您的目标是哪个版本的 MS Office？这些 PIA 非常特定于 Office 版本。我记得当我们构建一个智能客户端应用程序时，我们曾经有 Build VM 机器，每台机器都针对特定版本的 Outlook。

另一个障碍是无法将这些 PIA 指定为先决条件或将它们与应用程序捆绑在一起。这些 PIA 需要使用 Office CD（[至少对于 2003 版本](http://msdn.microsoft.com/en-us/library/aa159923.aspx)）安装在客户端上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T17:35:23.497

您可以[在 clickonce 应用程序中设置先决条件](http://msdn.microsoft.com/en-us/library/h4k032e1.aspx)，这将在允许用户安装之前检查 GAC 中的特定程序集。您仍然需要在 ClickOnce 之外手动安装包含所需 office dll 的应用程序，但至少可以避免引发错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T18:15:18.707

我们的目标是 Office 2003 和 Office 2007，但使用 Office 11 (2003) dll 作为 Office 2007 是向后兼容的。

该问题仅发生在 Microsoft.mshtml.dll 文件中。此文件设置为 ClickOnce 应用程序中的先决条件。

在此特定安装中，我们尝试同时安装 Office 2003 和 Office 2007 PIA，但均无济于事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-17T16:26:32.890

我也有这个问题。

解决方案是转到解决方案资源管理器中的 References 文件夹，然后右键单击 Microsoft.mshtml，然后单击 Properties。

在“属性”页面中，将“复制本地”标记为 True。这应该有效。

# monitoring - 网站监控库

> ID：54771
> 
> 赞同：6
> 
> 时间：2008-09-10T17:25:19.950
> 
> 标签：monitoring, web, polling

在 stackoverflow 上有一些关于网站性能监控工具和服务的讨论，但是，它们的实际工作似乎相当昂贵。是否有任何好的开源库可以自动检查/监控网站的可用性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T17:27:42.753

如果您只想知道您的服务器是否在提供内容，请查看[Montastic](http://www.montastic.com/)。我使用它，并且很高兴。加上它的免费！

它会定期 ping 你的站点，如果它没有得到 200 状态，它会让你知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T21:26:49.267

通过模拟人类用户进行智能网站监控是使用 Sahi + OMD 完成的。 [http://www.nagios-wiki.de/_media/workshop/2012/sahi2omd_simon_meggle_monitoring_workshop_2012.pdf](http://www.nagios-wiki.de/_media/workshop/2012/sahi2omd_simon_meggle_monitoring_workshop_2012.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T18:40:38.600

我一直使用[Zabbix](http://www.zabbix.com/)，尤其是用于关键网站。它使用 MySql 作为数据库，并且有一个 PHP 前端。当然它是开源的，而且非常灵活。它使用服务器将数据粘贴到数据库中，代理收集数据并将其发送到服务器。在这方面它是非常可扩展的。我不能足够推荐这个软件。我正在进行各种监控，而不仅仅是 Web 服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:03:56.827

也可以查看 mon.itor.us。

# c# - 尝试将重复对象插入集合时抛出的正确 .NET 异常是什么？

> ID：54789
> 
> 赞同：6
> 
> 时间：2008-09-10T17:35:36.460
> 
> 标签：c#, exception, collections

我有一个 Asset 对象，它有一个属性 AssignedSoftware，它是一个集合。

我想确保同一软件不会多次分配给资产。在 Add 方法中，我检查软件是否已经存在，如果存在，我想抛出异常。

我应该抛出一个标准的 .NET 异常吗？还是最佳实践要求我创建自己的自定义异常？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-11T05:31:17.457

为什么`InvalidOperationException`被接受为答案？！应该是一个`ArgumentException`？！

`InvalidOperationException`如果具有针对它的方法/属性调用的对象由于未初始化状态等而无法处理请求，则应该使用。这里的问题**不是要添加到的对象，而是要传递给对象的对象（这是一个骗局）。**想一想，如果这个 Add 调用从未发生过，该对象是否仍能正常工作，是的！

这应该是**ArgumentException**。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-10T17:42:59.347

如果您尝试将具有相同键值的项目两次添加到哈希表中，.Net 将引发 System.ArgumentException，因此看起来没有更具体的内容。如果您需要更具体的内容，您可能需要编写自己的异常。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T17:39:12.427

您可能应该抛出 ArgumentException，因为这是基础库类所做的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-10T17:43:01.700

来自错误的类库设计指南（[http://msdn.microsoft.com/en-us/library/8ey5ey87(VS.71).aspx](http://msdn.microsoft.com/en-us/library/8ey5ey87(VS.71).aspx)）：

> 在大多数情况下，使用预定义的异常类型。只为编程场景定义新的异常类型，您希望类库的用户捕获这种新类型的异常并根据异常类型本身执行编程操作。这代替了解析异常字符串，这会对性能和维护产生负面影响。
> 
> ...
> 
> 如果传递或检测到无效参数，则抛出 ArgumentException 或创建从此类派生的异常。
> 
> 如果在给定对象的当前状态的情况下对属性集访问器或方法的调用不合适，则引发 InvalidOperationException 异常。

对我来说，这似乎是一个“对象状态无效”的场景，所以我会选择 InvalidOperationException 而不是 ArgumentException：参数是有效的，但在对象生命的这一点上不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T17:41:23.157

好吧，如果你真的想要一个包含唯一项的集合，你可能想看看[HashSet 对象](http://msdn.microsoft.com/en-us/library/bb359438.aspx)（在 C# 3.0 中可用）。

否则，您可以采取两种方法：

*   正如您所说，为您的操作创建一个自定义异常
*   实现一个返回布尔结果的 Add() 方法：如果项目已添加，则为 true；如果该项目在集合中已有重复项，则为 false

任何一种方法都可以被认为是最佳实践，只要您在使用它时保持一致即可。

# msbuild - 是否可以从 Mono 的命令行构建 MSBuild 文件（visual studio sln）？

> ID：54790
> 
> 赞同：67
> 
> 时间：2008-09-10T17:36:00.110
> 
> 标签：msbuild, mono

是否可以构建 Visual Studio 解决方案而无需启动 MonoDevelop？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-09-11T09:19:47.753

当前状态（Mono 2.10，2011）：xbuild 现在能够构建所有版本的 Visual Studio / MSBuild 项目，包括 .sln 文件。`xbuild`就像`msbuild`在 Microsoft .Net Framework 上执行一样简单地运行。你不需要安装 Monodevelop，xbuild 带有标准的 Mono 安装。

如果您的构建使用自定义任务，如果它们不依赖于 Windows 可执行文件（例如`rmdir`或`xcopy`），它们应该仍然可以工作。

当您编辑项目文件时，请使用标准 Windows 路径语法 - 如果需要，它们将由 xbuild 转换。此规则的一个重要警告是区分大小写 - 不要混合相同文件名的不同大小写。如果您有一个这样做的项目，您可以通过调用`MONO_IOMAP=case xbuild foo.sln`（或尝试`MONO_IOMAP=all`）来启用兼容模式。Mono 有一个页面描述了更高级的[MSBuild 项目移植](http://www.mono-project.com/Porting_MSBuild_Projects_To_XBuild)技术。

Mono 2.0 答案（2008）：~~[xbuild](http://www.mono-project.com/Microsoft.Build)尚未完成（它与 VS2005 .csproj 文件配合得很好，与 VS2008 .csproj 有问题并且不处理 .sln）。Mono 2.1 计划将 mdtool（MonoDevelop 命令行构建引擎）的代码库合并到其中，但目前[mdtool](http://www.monodevelop.com/MonoDevelop_1.0_Released#Command_line_tools)是更好的选择。`mdtool build -f:project.sln`或者[`man mdtool`](http://ubuntu.dustinkirkland.com/manpages/intrepid/man1/mdtool.html)如果您安装了 MonoDevelop。~~

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-08-02T09:56:46.923

现在根据 2017 年 8 月，我们可以使用

## 构建

命令作为 xbuild 已折旧。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-10-11T12:34:27.473

xbuild 现在支持解决方案和项目，包括 VS2005 和 VS2008。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T17:38:02.650

我认为您正在寻找 xbuild： [http ://www.mono-project.com/Microsoft.Build](http://www.mono-project.com/Microsoft.Build)

# architecture - 建筑师的会议和培训，最佳实践，

> ID：54791
> 
> 赞同：2
> 
> 时间：2008-09-10T17:36:30.093
> 
> 标签：architecture

我需要提交培训和旅行申请的时间越来越近了。我正在寻找未来 12 个月内旨在改进编码和软件开发、最佳实践、系统架构等的会议和课程。他们需要在美国或加拿大举行，因为我永远不会获得任何其他方面的批准.

这是我发现的一些，但我正在寻找其他建议。也将不胜感激对其中任何一个的反馈：
[软件过程研讨会](http://www.spsymposium.com/agenda.html)
[软件开发最佳实践](http://sdbestpractices.com/index.php?option=com_frontpage&Itemid=1)
[更好的软件会议](http://www.sqe.com/bettersoftwareconf/)
[IASA 连接](http://www.iasaconnections.com/shows/iasa2008fall/default.asp?s=119)

IASA 活动对我来说似乎是最接近的比赛，但没有给我足够的提前时间来请求和安排它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T17:41:39.910

如果您正在使用 Microsoft 技术，那么[模式与实践峰会](http://www.pnpsummit.com/)是一个很好的活动——但是，如果您没有 100% 地在 Microsoft .NET 领域工作，那么它的用处就会减少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T10:31:17.150

我强烈推荐 Nothin' but .NET Developer Boot Camp 更多信息[http://www.jpboodhoo.com/training.oo](http://www.jpboodhoo.com/training.oo)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T05:56:14.190

位于宾夕法尼亚州匹兹堡的卡内基梅隆大学软件工程学院拥有软件架构方面的认证计划和培训：

*   [http://www.sei.cmu.edu/architecture/certificate_program.html](http://www.sei.cmu.edu/architecture/certificate_program.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T19:37:30.850

我也找到了这个，但目前没有安排课程：
[Agile Boot Camp for .NET Journeyman to Master Series](http://www.agileuniversity.org/course_details.jsp?courseid=157)

这是一个看起来可能实际上是同一件事的计划：
[Headspring Agile Boot Camp](http://www.headspringsystems.com/services/training/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:41:36.083

[InfoQ](http://infoq.com/)'s conferences seem to be valuable. Some parts of their materials is available online.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T12:53:41.503

如果您没有成功获得预算，也许您可​​以考虑参加本地用户组，​​例如 OWASP。我参加了[OWASP 哈特福德](http://www.owasp.org/index.php/Hartford)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-27T07:17:25.163

[您可以从 .NET http://www.soaschool.com/certifications/net](http://www.soaschool.com/certifications/net)的其他来源进行 IASA 在线培训和认证，类似地

# c++ - 限制分析的 CPU 速度

> ID：54795
> 
> 赞同：11
> 
> 时间：2008-09-10T17:37:57.547
> 
> 标签：c++, profiling, cpu

我正在尝试优化应用程序上的几个瓶颈，该应用程序应该在非常广泛的 CPU 和架构上运行（其中一些非常接近嵌入式设备）。

然而，由于我的 CPU 的速度，我的分析器的结果并不是很重要。有什么方法（最好在 Windows 或 Mac OS X 下）来限制我的 CPU 的速度以进行分析？

我曾考虑过使用虚拟机，但还没有找到具有此类功能的虚拟机。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-11T04:30:27.777

这很好用并且支持多核。 [http://www.cpukiller.com/](http://www.cpukiller.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-07T21:04:29.080

一个常见的误解是，您需要知道代码有多快才能知道性能问题出在哪里。这混淆了问题发现和问题测量。

[这是我使用的方法。](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

如果程序中有一些浪费的逻辑，不管用什么CPU运行都是浪费的。

你需要知道的是它在哪里。对于测量，您不需要知道它有多大；您只需要知道它大到需要修复即可。

通常有许多不同大小的问题。您可能会首先找到最大的那些，但无论您以什么顺序修复它们，您修复的每个都会更容易找到剩余的，因为它们会占更大的百分比。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T14:03:25.300

恐怕除了开始在您所在地区四处寻找旧硬件之外，我不知道任何答案。CPU 不是唯一可以（通常）影响事物的变量。L1/L2 缓存大小、内存总线速度、内存速度/延迟、硬盘驱动器速度等都是许多应用程序中的重要因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-30T13:51:06.960

> 我曾考虑过使用虚拟机，但还没有找到具有此类功能的虚拟机。

为什么需要一个明确提供该功能的 VM？只需限制主机操作系统中虚拟机的 CPU 使用率（它只是一个常规进程）。那应该具有完全相同的效果。

您可以这样做，例如在 Linux 上使用[cpulimit](http://cpulimit.sourceforge.net/)；MS Windows 也存在类似的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T13:56:33.867

许多分析器（例如 oprofile - 但仅限于 linux）允许您设置它们收集数据的频率。看看您的分析器是否支持这一点，如果不支持，请尝试其他支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T17:41:55.417

最近在 Downloadsquad.com 上有一个应用程序。我不记得它的名字，但它做了一些有趣的僵硬的处理器和任务管理器。它可能只是管理什么应用程序在什么 cpu 上，但也许它会给你这个。今天下午我会尝试寻找它，如果找到它会回复。

# algorithm - 你如何在 Delphi 中实现 Levenshtein 距离？

> ID：54797
> 
> 赞同：20
> 
> 时间：2008-09-10T17:38:05.193
> 
> 标签：algorithm, delphi, levenshtein-distance, edit-distance

我本着回答您自己的问题的精神发布此消息。

我的问题是：如何在 Delphi 中实现 Levenshtein 算法来计算两个字符串之间的编辑距离，如此处[所述？](http://en.wikipedia.org/wiki/Levenshtein_distance)

只是关于性能的说明：这东西非常快。在我的台式机（2.33 Ghz 双核、2GB 内存、WinXP）上，我可以在不到一秒的时间内运行 100K 字符串数组。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-10T17:38:15.987

```
function EditDistance(s, t: string): integer;
var
  d : array of array of integer;
  i,j,cost : integer;
begin
  {
  Compute the edit-distance between two strings.
  Algorithm and description may be found at either of these two links:
  http://en.wikipedia.org/wiki/Levenshtein_distance
  http://www.google.com/search?q=Levenshtein+distance
  }

  //initialize our cost array
  SetLength(d,Length(s)+1);
  for i := Low(d) to High(d) do begin
    SetLength(d[i],Length(t)+1);
  end;

  for i := Low(d) to High(d) do begin
    d[i,0] := i;
    for j := Low(d[i]) to High(d[i]) do begin
      d[0,j] := j;
    end;
  end;

  //store our costs in a 2-d grid  
  for i := Low(d)+1 to High(d) do begin
    for j := Low(d[i])+1 to High(d[i]) do begin
      if s[i] = t[j] then begin
        cost := 0;
      end
      else begin
        cost := 1;
      end;

      //to use "Min", add "Math" to your uses clause!
      d[i,j] := Min(Min(
                 d[i-1,j]+1,      //deletion
                 d[i,j-1]+1),     //insertion
                 d[i-1,j-1]+cost  //substitution
                 );
    end;  //for j
  end;  //for i

  //now that we've stored the costs, return the final one
  Result := d[Length(s),Length(t)];

  //dynamic arrays are reference counted.
  //no need to deallocate them
end; 
```

# .net - 如何在服务器上最好地将信息合并为“表单”，生成 PDF 作为最终输出

> ID：54808
> 
> 赞同：3
> 
> 时间：2008-09-10T17:41:28.570
> 
> 标签：.net, forms, pdf, pdf-generation

**背景**：

我有一个“继承”的 VB6 应用程序，它生成 PDF 供用户使用不受支持的 Acrobat Reader OCX 集成进行查看。该程序使用数据生成一个 FDF 文件，然后在 FDF 与 PDF 合并时呈现合并结果。它仅适用于 Acrobat Reader 4 :-(。安装较新版本的 Acrobat Reader 会破坏此应用程序，使用户非常不满意。

我想重新设计这个应用程序，以便它将要合并的数据发送到 PDF 输出生成服务器。该服务器会将传递给它的数据合并到表单中，生成一个 PDF 图像并存储它，以便任何希望查看最终结果的用户都可以简单地获取 PDF（它只生成一次）。如果基础数据发生更改，则 PDF 将在下次请求时被删除并重新生成。然后，客户端程序可以拥有他们想要的任何 Acrobat Reader 版本，因为它将专门用于显示 PDF 文件（如预期的那样）。服务器很可能是用 Visual Studio 2005 用 .NET (C#) 编写的，可能作为 Web 服务...

**问题**：

其他人会如何建议我这样做？我应该在服务器上使用 Adob​​e 的 Acrobat 9 来执行此操作，将数据放入 FDF 或 Adob​​e 的 XML 格式，然后让 Acrobat 进行合并吗？“将数据合并到表单并输出 PDF”领域是否有强大的竞争对手？其他人如何做到这一点？它必须是基于 API 的，服务​​器上没有 GUI，当然......

虽然某些输出是通过 FDF/PDF 生成的，但应用程序的另一部分实际上将线条、图形和文本发送到打印机（或用于预览目的的表单）一次一页，提供正确的 x/y 坐标、字体、每个的大小等，知道它何时在页面末尾等。此代码当前在显示此供用户查看的程序中，并且也在将最终表单打印到打印机。为了审阅者和打印机之间的一致性，我也想将此输出生成逻辑移动到服务器，或者使用良好的 PDF 生成 API 工具，或者按原样使用代码并使用 PDF 打印机生成 PDF……并保存此 PDF 供客户展示。

谷歌搜索“表单软件”或“填写表单软件”或类似搜索会返回很多不相关的材料，主要与用户填写表单的 UI 相关，我只是不知道如何正确缩小搜索范围。该站点似乎是提出此类问题的理想场所，因为其他程序员也必须生成类似的输出，并且已经尝试了一些很棒的工具。

**编辑：**

我添加了 PDF 标签以及 PDF 生成。此外，我当前的客户坚持使用 PDF 输出，但我很欣赏其他建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-11T04:24:58.867

无法使用 VB6 解决方案，可以帮助使用服务器上的 .net 或 java 解决方案。[从http://www.lowagie.com/iText/](http://www.lowagie.com/iText/)
获取 iText 或 iTextSharp 。 它有一个 PdfStamper 类，可以合并 PDF 和 FDF FDFReader/FDFWriter 类以生成 FDF 文件，从 PDF 文件中获取字段名称等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T17:48:46.197

接受我的建议。为 XPS 抛弃 PDF。我正在开发两个基于服务器的应用程序。一种是在浏览器中将基于图像的文档显示为 PDF。第二种使用 FixedPage 模板来构造绑定到数据源的 XPS 文档。

在完成这两个项目之后，我的结论是 PDF 很糟糕。XPS 文档就更少了。你必须为一个像样的 PDF 库支付现金，而 XPS 是框架自带的。PDF 文档生成占用大量内存，有很多坑洞，而且对服务器不是很友好。XPS 文档的占用空间要小得多，而且射中自己脚的机会也更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T17:53:08.480

我在使用 Microsoft Word 方面取得了巨大成功。该表单是用 Word 设计的，并与 XML 数据复合。该文档通过 PDF 转换器（在这种情况下为 Neevia，但有更好的）运行以生成 PDF。

所有这些都是在 C# 中完成的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T05:30:48.337

同一条船。我们目前正在以这种方式制作 pdf：vb6 应用程序将一条记录放入 sql 中（带有文件名、创建日期、用户和最终目的地），然后 xls（或 doc）被移动到服务器目录（共享）中，服务器有一个vb.net 服务具有监视该目录的文件监视器。文件显示，该服务启动 excel（word）以通过 adobe pdf 文件，查看 sql 以找出在制作 PDF 时如何处理，并记录完成时间。

This was the cheap solution- it only took about a day to do the code and another day to debug both ends and roll the build out.

**This is not the way to do it.** Adobe crashes at random times when trying to make the pdfs. it will run for two weeks with no issues at all, and then (like today) it will crash every 5 minutes. or every other hour. or at 11:07, 2:43, 3:05, and 6:11\.

We're going to convert the stuff out of excel and word and drop the data directly into pdfs using PDFTron in the next revision. Yes, PDFTron costs money, (we bought the 1-kilobuck-per-processor license) but it will do the job, and nicely. XPS are *nice* but I, like you, have to provide PDFs. It is the way of things.

Check out pdfTron (google it) and see if it will do what you want. Then you just got to figure out which license you need and how you gonna pay for it. If someone comes up with something better, hope they'll vote it to the top of the list!!!

# c# - 防止 Multi-Line ASP:Textbox 修剪换行符

> ID：54833
> 
> 赞同：2
> 
> 时间：2008-09-10T17:48:28.023
> 
> 标签：c#, asp.net, textbox, postback

我有以下网络表单：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" 
    Inherits="TestWebApp.Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox ID="txtMultiLine" runat="server" 
            Width="400px" Height="300px" TextMode="MultiLine"></asp:TextBox>
        <br />
        <asp:Button ID="btnSubmit" runat="server" 
            Text="Do A Postback" OnClick="btnSubmitClick" />
    </div>
    </form>
</body>
</html> 
```

并且每次我回发时，文本框中的前导换行符都会被删除。有什么办法可以防止这种行为吗？

我正在考虑创建一个从文本框继承的自定义控件，但我想先在这里进行健全性检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T18:05:45.423

我最终在 btnSubmitClick()

```
public void btnSubmitClick(object sender, EventArgs e)
{
    if (this.txtMultiLine.Text.StartsWith("\r\n"))
    {
        this.txtMultiLine.Text = "\r\n" + this.txtMultiLine.Text;
    }
} 
```

我一定是真的累了或者生病了或者别的什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T17:36:55.740

我认为这里的问题在于浏览器呈现文本区域内容的方式，而不是 ASP.NET 本身。这样做：

```
public void btnSubmitClick(object sender, EventArgs e) {
  this.txtMultiLine.Text = "\r\n" + this.txtMultiLine.Text;
} 
```

将使您达到所需的屏幕输出，但您将在用户未输入的文本中添加一个额外的换行符。

理想的解决方案是 ASP.NET 中的 TextBox 控件始终在写入打开标记之后和在写入 Text 内容之前写入换行符。这样，您就可以在不超过文本框内容的情况下达到所需的效果。

我们可以从 TextBox 继承并通过覆盖 RenderBeginTag 来解决这个问题：

```
public override void RenderBeginTag(HtmlTextWriter writer) {
  base.RenderBeginTag(writer);
  if (this.TextMode == TextBoxMode.MultiLine) {
    writer.Write("\r\n"); // or Environment.NewLine
  }
} 
```

现在，为这个小问题创建一个新类似乎真的有点过头了，所以你的务实方法是完全可以接受的。但是，我会将其更改为在页面的 PreRender 事件中运行，这在页面生命周期中非常晚，并且不会干扰按钮的 OnSubmit 事件中提交的文本的处理：

```
protected void Page_Load(object sender, EventArgs e) {
  this.PreRender += Page_OnPreRender;
}
protected void Page_OnPreRender(object sender, EventArgs e) {
  this.txtMultiLine.Text = "\r\n" + this.txtMultiLine.Text;
} 
```

# .net - 如何监控 .Net 应用程序的跟踪输出？

> ID：54836
> 
> 赞同：5
> 
> 时间：2008-09-10T17:48:49.877
> 
> 标签：.net, windows, visual-studio

我正在处理一些使用 System.Diagnostics.Trace 类的代码，我想知道在 Visual Studio 中以调试模式运行时以及在调试器外部运行时如何监视通过调用 Trace.WriteLine() 写入的内容.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-10T17:50:19.670

尝试[调试视图](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)。它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T17:55:42.497

我使用了一个名为“ [BareTail](http://www.baremetalsoft.com/baretail/) ”的简单小程序，它显示纯文本文件，在文件被写入并跟随（或换行）到文件底部时更新它的显示。

在调试器外部运行时，您需要附加一个文件编写器来写出跟踪信息，您可以通过[在 .exe.config 文件中添加几行来完成](http://www.thescarms.com/dotnet/DebugTrace.aspx)

希望有帮助;o）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T19:42:45.020

看看[DevTracer](http://www.devtracer.com)。它还允许远程监控 .NET 应用程序。

免责声明：我是 DevTracer 的开发人员，因此我的意见可能不是中立的。

# .net - 是否有一个很好的库来处理 .NET 中的 Modbus 协议？

> ID：54837
> 
> 赞同：18
> 
> 时间：2008-09-10T17:49:24.743
> 
> 标签：.net, open-source, protocols, plc, modbus

有谁知道处理 Modbus 协议的好（最好是开源）库？我看过一些图书馆，但我正在寻找一些人的个人经历，而不仅仅是谷歌前十名。我认为必须至少有一个其他人像我一样处理 PLC 和自动化硬件。

对可能对您有帮助的任何其他材料开放......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-10T18:08:23.857

自从我在一家家庭自动化公司工作以来，过去几年我与设备进行了很多通信，但我们不使用 Modbus。我们使用设备的 Web 服务 (WSD) 以标准和开放的方式进行通信，这也称为[Web 服务的设备配置文件 (DPWS)](http://en.wikipedia.org/wiki/Devices_Profile_for_Web_Services)。

在此期间，我确实听说过一个名为[NModbus](http://code.google.com/p/nmodbus/)的项目。它是一个用于使用 modbus 的开源库。我没有使用过它，但是查看网站和 Google Code 上的[变更集](http://code.google.com/p/nmodbus/source/list)，它看起来非常活跃。您可能想看看它，甚至参与其中。这是我听说的唯一一个以 .Net 为目标的库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-23T22:07:01.417

Modbus 是一个非常容易实现的协议。您需要的所有信息都可以轻松地在 Internet 上免费找到。

如果您选择自己实现它，我将很乐意回答您在此过程中遇到的任何问题。

如果您选择使用 modbus 主库，我会寻找：

*   Modbust TCP 支持。
*   基于 TCP/UDP 和 COM 端口的 Modbus RTU。
*   可配置的字节交换、字交换
*   可配置的“基本”地址，因此您可以选择地址 1 实际上是地址 0（听起来很愚蠢，但我更喜欢始终以与记录相同的方式指定地址）
*   它必须支持读取多个地址作为一个块，但它需要灵活，如果块中的任何地址未使用/保留，一些modbus从站将返回错误）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-05T15:24:39.200

AdvancedHMI 包含一个驱动程序包，它几乎适用于任何通信，但如果你想要的只是 Modbus，它可能有点重。AdvancedHMI 也在积极开发中，拥有强大的用户群。 [http://sourceforge.net/projects/advancedhmi/](http://sourceforge.net/projects/advancedhmi/)

NModbus 似乎是最有可能继续发展的，并且有许多示例项目分散在互联网上。 [https://code.google.com/p/nmodbus/](https://code.google.com/p/nmodbus/)

我过去喜欢使用这个（通过 TCP 的 Modbus）： http: [//www.codeproject.com/Tips/16260/Modbus-TCP-class](http://www.codeproject.com/Tips/16260/Modbus-TCP-class)

Modbus 到 Siemens Logo PLC 有点不同。我有一个示例项目，我可以根据要求发送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-21T20:05:42.123

查看 Colway Solutions [http://www.colwaysolutions.com](http://www.colwaysolutions.com)提供的产品。他们有一个独特的许可方案，您可以为每个想要使用的 Modbus 功能代码付费。它不是免费的，但价格似乎很低。我还看到了该库的一些端口，用于一些流行的微控制器和 RTOS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-29T12:24:36.253

FieldTalk Modbus 库 - 处理所有 Modbus 功能

# c# - 创建我自己的自定义异常有哪些最佳实践？

> ID：54851
> 
> 赞同：24
> 
> 时间：2008-09-10T17:55:01.063
> 
> 标签：c#, .net, exception

[在上一个关于异常的问题](https://stackoverflow.com/questions/54789/what-is-the-correct-net-exception-to-throw-when-try-to-insert-a-duplicate-objec)的后续行动中，在 .NET 中创建自定义异常的最佳实践是什么？

更具体地说，您应该继承 System.Exception、System.ApplicationException 还是其他一些基本异常？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-10T18:27:35.680

在 C# IDE 中，键入“exception”并按 TAB。这将扩展以帮助您开始编写新的异常类型。有一些评论和一些关于异常实践的讨论的链接。

就个人而言，我非常喜欢创建大量的小类，这些小类扩展到异常类型。例如，在编写 Foo 类时，我可以选择：

1.  `throw new Exception("Bar happened in Foo");`
2.  `throw new FooException("Bar happened");`
3.  `throw new FooBarException();`

在哪里

```
class FooException : Exception 
{
    public FooException(string message) ... 
} 
```

和

```
class FooBarException : FooException 
{
    public FooBarException() 
        : base ("Bar happened") 
    {
    }
} 
```

我更喜欢第三个选项，因为我认为它是一个面向对象的解决方案。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-10T17:57:04.413

继承自`System.Exception`。`System.ApplicationException`是没用的，设计指南说“**不要**抛出或派生自`System.ApplicationException`.”

请参阅[http://blogs.msdn.com/kcwalina/archive/2006/06/23/644822.aspx](http://blogs.msdn.com/kcwalina/archive/2006/06/23/644822.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T17:58:48.543

有一个代码片段。用那个。另外，事后检查你的代码分析；该片段遗漏了您应该实现的构造函数之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T17:56:36.893

我认为在处理任何级别的异常（自定义、抛出、捕获）时要记住的最重要的一点是，异常仅适用于异常情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T17:57:31.510

所有其他异常都继承自的基本异常是 System.Exception，这就是您应该继承的，除非您当然可以使用诸如更具体异常的默认消息之类的东西。

# java - 从 Java 打开文档的更好方法？

> ID：54861
> 
> 赞同：2
> 
> 时间：2008-09-10T17:58:19.370
> 
> 标签：java, windows, process

我一直在使用以下代码在我的 Windows 机器上使用 Java 打开 Office 文档、PDF 等，它工作正常，除了文件名将其嵌入多个连续空格（如“文件 [SPACE] [空间]Test.doc"。

我怎样才能使这项工作？我不反对将整段代码封装起来……但我不想用调用 JNI 的第三方库来替换它。

```
public static void openDocument(String path) throws IOException {
    // Make forward slashes backslashes (for windows)
    // Double quote any path segments with spaces in them
    path = path.replace("/", "\\").replaceAll(
            "\\\\([^\\\\\\\\\"]* [^\\\\\\\\\"]*)", "\\\\\\\"$1\"");

    String command = "C:\\Windows\\System32\\cmd.exe /c start " + path + "";

    Runtime.getRuntime().exec(command);            
} 
```

**编辑：**当我用错误的文件运行它时，窗口抱怨找不到文件。但是......当我直接从命令行运行命令行时，它运行得很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T18:36:43.727

如果您使用的是 Java 6，您可以使用[java.awt.Desktop 的 open 方法](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#open(java.io.File))使用当前平台的默认应用程序启动文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T18:52:49.803

不确定这是否对您有很大帮助...我使用 java 1.5+ 的[ProcessBuilder](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html) 在 java 程序中启动外部 shell 脚本。基本上我执行以下操作：（尽管这可能不适用，因为您不想捕获命令输出；您实际上想启动文档 - 但是，也许这会激发您可以使用的东西）

```
List<String> command = new ArrayList<String>();
command.add(someExecutable);
command.add(someArguemnt0);
command.add(someArgument1);
command.add(someArgument2);
ProcessBuilder builder = new ProcessBuilder(command);
try {
final Process process = builder.start();
...    
} catch (IOException ioe) {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T19:09:38.857

问题可能是您正在使用的“开始”命令，而不是您的文件名解析。例如，这似乎在我的 WinXP 机器上运行良好（使用 JDK 1.5）

```
import java.io.IOException;
import java.io.File;

public class test {

    public static void openDocument(String path) throws IOException {
        path = "\"" + path + "\"";
        File f = new File( path );
        String command = "C:\\Windows\\System32\\cmd.exe /c " + f.getPath() + "";
            Runtime.getRuntime().exec(command);          
    }

    public static void main( String[] argv ) {
        test thisApp = new test();
        try {
            thisApp.openDocument( "c:\\so\\My Doc.doc");
        }
        catch( IOException e ) {
            e.printStackTrace();
        }
    }
} 
```

# .net - .NET 的扩展性如何？

> ID：54864
> 
> 赞同：15
> 
> 时间：2008-09-10T17:59:25.857
> 
> 标签：.net, architecture, web-applications, scalability

（首先我要明确一点，我不是 .NET 开发人员，并且不依赖于任何其他环境。）

最近，我听说伦敦证券交易所下跌了一整天。我还听说该软件是用 .NET 编写的。到目前为止，他们在忙碌的日子里会遇到性能下降。人们似乎在指责 .NET。

我不想讨论这个故事，但它让我想起了 .NET 如何扩展的问题？.NET 有多大？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-10T18:08:04.730

老实说，我认为它归结为代码优化，而不仅仅是基础设施。

在[StackOverflow 播客 19](https://blog.stackoverflow.com/2008/08/podcast-19/)中，Jeff 讨论了他们必须如何调整 SQL Server 以处理 StackOverflow 的负载类型；请注意，这里需要调整的不是 .NET。

还必须注意，[MySpace.com，最大的社交网络之一，运行在 ASP.NET 上](http://weblogs.asp.net/scottgu/archive/2006/03/25/Handling-1.5-Billion-Page-Views-Per-Day-Using-ASP.NET-2.0.aspx)。

MySpace 单独使用 ASP.NET 就证明了它的可伸缩性。它将归结为开发人员将如何以最能利用该功能的方式编写他们的应用程序。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-10T18:01:43.480

不幸的是，还有很多其他问题可能会导致项目随着规模的扩大而失败，在你归咎于一个框架之前，你需要经历很多事情。除非你能看到并彻底分析源代码，否则很难说出根本原因是什么。我愿意打赌这不是框架。

不，我不是每天都使用 .NET。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-10T18:03:20.390

许多大型网站，如[MySpace](http://highscalability.com/myspace-architecture)、Dell.com 都在 asp.net 上运行。另外，请查看这篇[MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc500561.aspx)，它提供了专家的良好视角。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-10T20:08:24.503

您可以编写无法在任何语言中扩展的糟糕代码。

.Net 非常有能力扩展到任何规模的系统，但与任何其他技术堆栈一样，您必须在构建系统时考虑到可扩展性。

伦敦证交所在最糟糕的一天下跌，但无论出于何种原因，我怀疑问题在于底层堆栈。我怀疑这是一个可怜的工人指责他们的工具的案例。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-10T19:35:09.340

这是一本关于这个主题的厚书供您阅读：

[提高 .NET 应用程序性能和可扩展性](http://msdn.microsoft.com/en-us/library/ms998530.aspx)（微软出版社）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-10T20:30:33.030

实际上，LSE 的停机时间与它的 .NET 交易平台完全无关：

> 伦敦证交所表示，该系统受到“连接问题”的影响，并坚称问题不在于其旗舰交易平台 TradElect。

[http://www.itworld.com/networking/54760/london-stock-exchange-trading-stops-network-fails](http://www.itworld.com/networking/54760/london-stock-exchange-trading-stops-network-fails)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T19:27:14.010

点网可很好地扩展。我们有运行 IIS 服务器和 asp.net 网站和应用程序的服务器集群，当我们的用户负载增加时，我们可以（轻松地）添加服务器以增加容量。这发生在某些事件中，.net 架构的可扩展性并没有让我们失望。

我会冒险猜测（就像其他人一样）这不是 .net 问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T18:34:06.493

也许是交易量拉低了交易所。

尽管到目前为止给出的许多示例都很好，但它们只是大型网站。（你讨厌我说“只是”）他们向用户分发页面和偶尔的应用程序（即乱七八糟的）。证券交易所处理买卖并匹配买家/卖家。对于应用服务器来说，这将是几个数量级的工作量。

我可以看到数据库下降了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-10T21:38:08.290

这一切都归结为三件事：

*   应用程序计划得如何
*   建造者最初的规模目标是什么
*   正在进行的维修工作以改进和扩展解决方案。

MySpace 之前提到过，这是一个众所周知的事实，当他们达到新的扩展步骤（用户数/页面浏览量等）时，他们已经多次重写了他们的应用程序。如果他们一开始就选择构建最后一个版本，那么维护成本太高而且成本效益不高——可扩展性应该基于当前位置和下一个扩展目标。

最后一件事——尽管它通常被认为是回避性的，但可靠的压力测试可以让您很好地了解您的应用程序如何在用户体验它和灾难发生之前处理您的目标负载。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-10T21:43:45.127

正如其他人所说 - 这不是平台问题。

重要的是您的应用程序的架构 - 负载平衡、状态管理、分区等......这些不是特定于平台的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-09-21T17:29:21.577

后来的消息...

“TradElect 是该集团的交易平台技术，将于今年晚些时候被 LSE 拥有的斯里兰卡技术供应商 MillenniumIT 开发的软件所取代。” ...

[http://www.efinancialnews.com/story/2010-09-13/ex-lse-tech-chief-joins-green-investment-company](http://www.efinancialnews.com/story/2010-09-13/ex-lse-tech-chief-joins-green-investment-company)

“这项交易使集团能够为我们未来的业务发展实施一种新的、更敏捷、创新和高效的 IT 能力，并运行一个新的现金交易平台，该平台将提供显着降低的延迟、显着更高的容量和改进的可扩展性。” ...

[http://www.computerworlduk.com/news/it-business/16590/london-stock-exchange-buys-millennium-it-trading-platform-supplier/](http://www.computerworlduk.com/news/it-business/16590/london-stock-exchange-buys-millennium-it-trading-platform-supplier/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-17T00:55:40.167

我运行着一个相对较大的 asp.net 网站，并且发现它可以很好地扩展。当然，这很大程度上归功于拥有一些出色的工具来诊断和修复代码中的瓶颈。我敢猜测，编码问题会导致人们在*任何*框架中遇到的 99.99% 的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-10T18:02:43.213

为什么.NET 会有其他平台没有的大小限制？我无法想象在任何情况下您都会对 .NET 变得“太大”。但是，您应该真正指定您是在谈论 .NET winforms 应用程序还是 ASP.NET 以及其他相关因素。这个问题太模糊了，无法详细回答。

顺便说一句，你的名字是“Dr Unix”确实暗示了一些偏见。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-10T18:03:23.477

如果做得好，该架构会将大多数瞬态状态卸载到客户端，这使得集群更容易，这使得它具有惊人的可扩展性。所以这是系统作为一个整体的问题，而不是直接在这一点上的 ASP.NET。

我的 2 美分。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-10T18:05:22.677

好吧，我认为这个网站是在.net 框架上的。微软网站也建立在它之上。所以我认为，如果做得好，.net 网站将会扩展。看看 Jeff 对这个站点所做的一些评论，问题往往来自编码错误或架构问题。

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2009-09-17T00:25:03.520

当人们说 .NET 是一个首选平台时，我真的很困扰，因为它“可扩展”，它的可扩展性不亚于任何其他平台：PHP、ColdFusion、JSP 或带有 C++/Delphi 等的本机编译应用程序......这不是框架的一个特性，它是应用程序设计的一个特性。

MySpace 肯定不提倡可扩展性，而是看看 Google 搜索背后的技术或 SETI@home 项目。

.NET 实际上是我最不喜欢使用的平台，因为它在尝试简化软件方面做得太过分了，以至于我想做的事情却做不到，因此试图克服 .NET 的限制会浪费时间使用 C++ 或 PHP 可以轻松快速地实现它。.NET 之于软件开发就像 duplo 积木之于机械工程 - 自尊心强的机械工程师不会希望只使用英寸宽的方块。

如果应用程序需要可扩展，您需要考虑需要在服务器之间共享哪些数据，以及应用程序运行和服务于其目的所需的最少数据是多少。通常可以通过首先使用超高效代码（例如，不是 .NET 或 Java）来避免扩展应用程序的需要，但这通常需要至少对汇编有基本的了解，以及您选择的语言是如何翻译成机器的代码。

# c# - 解析空格分隔文本的最佳方法

> ID：54866
> 
> 赞同：7
> 
> 时间：2008-09-10T18:00:12.143
> 
> 标签：c#, string, tokenize

我有这样的字符串

```
 /c SomeText\MoreText "Some Text\More Text\Lol" SomeText 
```

我想标记它，但是我不能只在空格上分割。我想出了一些丑陋的解析器，但我想知道是否有人有更优雅的设计。

这是在 C# 中。

**编辑：**我丑陋的版本，虽然丑陋，是 O(N) 并且实际上可能比使用 RegEx 更快。

```
private string[] tokenize(string input)
{
    string[] tokens = input.Split(' ');
    List<String> output = new List<String>();

    for (int i = 0; i < tokens.Length; i++)
    {
        if (tokens[i].StartsWith("\""))
        {
            string temp = tokens[i];
            int k = 0;
            for (k = i + 1; k < tokens.Length; k++)
            {
                if (tokens[k].EndsWith("\""))
                {
                    temp += " " + tokens[k];
                    break;
                }
                else
                {
                    temp += " " + tokens[k];
                }
            }
            output.Add(temp);
            i = k + 1;
        }
        else
        {
            output.Add(tokens[i]);
        }
    }

    return output.ToArray();            
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-10T18:20:11.923

您正在做的计算机术语是[词法分析](http://en.wikipedia.org/wiki/Lexical_analysis)；阅读它以获得对这个常见任务的一个很好的总结。

根据您的示例，我猜您希望空格来分隔您的单词，但引号中的内容应该被视为没有引号的“单词”。

最简单的方法是将单词定义为正则表达式：

```
([^"^\s]+)\s*|"([^"]+)"\s* 
```

此表达式表明“单词”是 (1) 非引号、由空格包围的非空格文本，或 (2) 由引号包围的非引号文本（后跟一些空格）。请注意使用捕获括号来突出显示所需的文本。

使用该正则表达式，您的算法很简单：在文本中搜索由捕获括号定义的下一个“单词”，然后返回它。重复此操作，直到用完“单词”。

这是我能想到的最简单的工作代码，在 VB.NET 中。请注意，我们必须检查*两组*数据，因为有两组捕获括号。

```
Dim token As String
Dim r As Regex = New Regex("([^""^\s]+)\s*|""([^""]+)""\s*")
Dim m As Match = r.Match("this is a ""test string""")

While m.Success
    token = m.Groups(1).ToString
    If token.length = 0 And m.Groups.Count > 1 Then
        token = m.Groups(2).ToString
    End If
    m = m.NextMatch
End While 
```

注 1：上述[威尔的](https://stackoverflow.com/users/1228/will)答案与此相同。希望这个答案能更好地解释幕后的细节:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-10T18:03:08.547

Microsoft.VisualBasic.FileIO 命名空间（在 Microsoft.VisualBasic.dll 中）有一个 TextFieldParser，可用于拆分空格分隔的文本。它可以很好地处理引号内的字符串（即“这是一个标记”thisistokentwo）。

注意，仅仅因为 DLL 说 VisualBasic 并不意味着您只能在 VB 项目中使用它。它是整个框架的一部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T20:12:41.450

有状态机方法。

```
 private enum State
    {
        None = 0,
        InTokin,
        InQuote
    }

    private static IEnumerable<string> Tokinize(string input)
    {
        input += ' '; // ensure we end on whitespace
        State state = State.None;
        State? next = null; // setting the next state implies that we have found a tokin
        StringBuilder sb = new StringBuilder();
        foreach (char c in input)
        {
            switch (state)
            {
                default:
                case State.None:
                    if (char.IsWhiteSpace(c))
                        continue;
                    else if (c == '"')
                    {
                        state = State.InQuote;
                        continue;
                    }
                    else
                        state = State.InTokin;
                    break;
                case State.InTokin:
                    if (char.IsWhiteSpace(c))
                        next = State.None;
                    else if (c == '"')
                        next = State.InQuote;
                    break;
                case State.InQuote:
                    if (c == '"')
                        next = State.None;
                    break;
            }
            if (next.HasValue)
            {
                yield return sb.ToString();
                sb = new StringBuilder();
                state = next.Value;
                next = null;
            }
            else
                sb.Append(c);
        }
    } 
```

它可以很容易地扩展到嵌套引号和转义等内容。返回 as`IEnumerable<string>`允许你的代码只解析你需要的部分。这种惰性方法没有任何真正的缺点，因为字符串是不可变的，因此您知道`input`在解析整个内容之前它不会改变。

参见：[http ://en.wikipedia.org/wiki/Automata-Based_Programming](http://en.wikipedia.org/wiki/Automata-Based_Programming)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T18:03:47.720

您可能还想研究正则表达式。这可能会帮助你。这是从 MSDN 中窃取的示例...

```
using System;
using System.Text.RegularExpressions;

public class Test
{

    public static void Main ()
    {

        // Define a regular expression for repeated words.
        Regex rx = new Regex(@"\b(?<word>\w+)\s+(\k<word>)\b",
          RegexOptions.Compiled | RegexOptions.IgnoreCase);

        // Define a test string.        
        string text = "The the quick brown fox  fox jumped over the lazy dog dog.";

        // Find matches.
        MatchCollection matches = rx.Matches(text);

        // Report the number of matches found.
        Console.WriteLine("{0} matches found in:\n   {1}", 
                          matches.Count, 
                          text);

        // Report on each match.
        foreach (Match match in matches)
        {
            GroupCollection groups = match.Groups;
            Console.WriteLine("'{0}' repeated at positions {1} and {2}",  
                              groups["word"].Value, 
                              groups[0].Index, 
                              groups[1].Index);
        }

    }

}
// The example produces the following output to the console:
//       3 matches found in:
//          The the quick brown fox  fox jumped over the lazy dog dog.
//       'The' repeated at positions 0 and 4
//       'fox' repeated at positions 20 and 25
//       'dog' repeated at positions 50 and 54 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-10T18:15:33.650

[Craig](https://stackoverflow.com/questions/54866/best-way-to-parse-space-seperated-text#54880)是对的——使用正则表达式。 [Regex.Split](http://msdn.microsoft.com/en-us/library/8yttk7sy.aspx)可能更简洁以满足您的需求。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-10T19:12:17.523

> [^\t]+\t|"[^"]+"\t

使用正则表达式绝对是最好的选择，但是这个只是返回整个字符串。我正在尝试对其进行调整，但到目前为止运气不佳。

```
string[] tokens = System.Text.RegularExpressions.Regex.Split(this.BuildArgs, @"[^\t]+\t|""[^""]+""\t"); 
```

# python - Python中的旧样式类和新样式类有什么区别？

> ID：54867
> 
> 赞同：1074
> 
> 时间：2008-09-10T18:01:27.163
> 
> 标签：python, class, oop, types, new-style-class

Python中的旧样式类和新样式类有什么区别？我什么时候应该使用其中一种？

* * *

## 回答 #1

> 赞同：600
> 
> 时间：2008-09-10T18:02:43.743

从*[新式和经典类](http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes)*：

> **直到 Python 2.1，旧式类是用户唯一可用的风格。**
> 
> （旧式）类的概念与类型的概念无关：如果`x`是旧式类的实例，则`x.__class__` 指定 的类`x`，但`type(x)`始终是`<type 'instance'>`。
> 
> 这反映了一个事实，即所有老式实例，独立于它们的类，都是用一个称为实例的内置类型实现的。
> 
> **Python 2.2 引入了新式类，以统一类和类型的概念**。新式类只是用户定义的类型，不多也不少。
> 
> 如果 x 是新式类的实例，则`type(x)`通常与 相同`x.__class__`（尽管不能保证 - 允许新式类实例覆盖 的返回值`x.__class__`）。
> 
> **引入新型类的主要动机是提供具有完整元模型的统一对象模型**。
> 
> 它还具有许多直接的好处，例如能够对大多数内置类型进行子类化，或者引入启用计算属性的“描述符”。
> 
> **出于兼容性原因，默认情况下类仍然是老式的**。
> 
> 新样式类是通过指定另一个新样式类（即类型）作为父类来创建的，或者如果不需要其他父类，则指定“顶级类型”对象。
> 
> 除了返回的类型外，新式类的行为在许多重要细节上与旧式类的行为不同。
> 
> 其中一些更改是新对象模型的基础，例如调用特殊方法的方式。其他是出于兼容性问题之前无法实现的“修复”，例如多重继承情况下的方法解析顺序。
> 
> **Python 3 只有新式类**。
> 
> 无论您是否从子类`object`化，类都是 Python 3 中的新样式。

* * *

## 回答 #2

> 赞同：326
> 
> 时间：2009-07-30T01:21:59.097

**声明方面：**

新式类继承自*object*或另一个新式类。

```
class NewStyleClass(object):
    pass

class AnotherNewStyleClass(NewStyleClass):
    pass 
```

旧式课程没有。

```
class OldStyleClass():
    pass 
```

**Python 3 注意：**

Python 3 不支持旧样式类，因此上述任何一种形式都会产生新样式类。

* * *

## 回答 #3

> 赞同：237
> 
> 时间：2013-11-13T09:36:59.783

**新旧样式类之间的重要行为变化**

*   [超级](https://stackoverflow.com/questions/576169/understanding-python-super-and-init-methods)添加
*   MRO 更改（解释如下）
*   添加[的描述符](http://docs.python.org/2/howto/descriptor.html)
*   `Exception`除非派生自（下面的示例），否则不能引发新的样式类对象
*   [`__slots__`](http://docs.python.org/2/reference/datamodel.html#slots)添加

## MRO（方法解析顺序）已更改

在其他答案中提到过，但这里有一个具体的例子来说明经典 MRO 和 C3 MRO 之间的区别（用于新样式类）。

问题是在多重继承中搜索属性（包括方法和成员变量）的顺序。

**经典类**从左到右进行深度优先搜索。停在第一场比赛。他们没有`__mro__`属性。

```
class C: i = 0
class C1(C): pass
class C2(C): i = 2
class C12(C1, C2): pass
class C21(C2, C1): pass

assert C12().i == 0
assert C21().i == 2

try:
    C12.__mro__
except AttributeError:
    pass
else:
    assert False 
```

**新式类**MRO 在单个英语句子中合成起来更加复杂。[这里](http://www.python.org/download/releases/2.3/mro/)有详细解释。它的属性之一是基类仅在其所有派生类都被搜索后才被搜索。它们具有`__mro__`显示搜索顺序的属性。

```
class C(object): i = 0
class C1(C): pass
class C2(C): i = 2
class C12(C1, C2): pass
class C21(C2, C1): pass

assert C12().i == 2
assert C21().i == 2

assert C12.__mro__ == (C12, C1, C2, C, object)
assert C21.__mro__ == (C21, C2, C1, C, object) 
```

## 除非派生自，否则不能引发新的样式类对象`Exception`

在 Python 2.5 前后，可以提出许多类，而在 Python 2.6 前后，这已被删除。在 Python 2.7.3 上：

```
# OK, old:
class Old: pass
try:
    raise Old()
except Old:
    pass
else:
    assert False

# TypeError, new not derived from `Exception`.
class New(object): pass
try:
    raise New()
except TypeError:
    pass
else:
    assert False

# OK, derived from `Exception`.
class New(Exception): pass
try:
    raise New()
except New:
    pass
else:
    assert False

# `'str'` is a new style object, so you can't raise it:
try:
    raise 'str'
except TypeError:
    pass
else:
    assert False 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2010-07-12T11:26:52.043

对于属性查找，旧样式类仍然稍微快一些。这通常并不重要，但在性能敏感的 Python 2.x 代码中可能很有用：

```
[3] 中：A 类：
   ...：定义__init__（自我）：
   ...: self.a = '你好'
   ...：

在 [4] 中：B 类（对象）：
   ...：定义__init__（自我）：
   ...: self.a = '你好'
   ...：

在[6]中：aobj = A()
在 [7] 中：bobj = B()

在 [8] 中：%timeit aobj.a
10000000 次循环，3 次中的最佳：每个循环 78.7 ns

在 [10] 中：%timeit bobj.a
10000000 次循环，3 次中的最佳：每个循环 86.9 ns

```

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2013-04-24T13:41:26.200

Guido 写*[了 The Inside Story on New-Style Classes](http://python-history.blogspot.com/2010/06/inside-story-on-new-style-classes.html)*，这是一篇关于 Python 中新式和旧式类的非常棒的文章。

Python 3 只有新式类。即使您编写了一个“旧式类”，它也隐式地派生自`object`.

新式类具有旧式类所缺乏的一些高级特性，例如`super`新的[C3 mro](http://en.wikipedia.org/wiki/C3_linearization)，一些神奇的方法等。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2013-10-09T13:40:29.397

这是一个非常实用的真/假区别。以下代码的两个版本之间的唯一区别是在第二个版本中*Person*继承自*object*。除此之外，这两个版本是相同的，但结果不同：

1.  旧式课程

    ```
    class Person():
        _names_cache = {}
        def __init__(self,name):
            self.name = name
        def __new__(cls,name):
            return cls._names_cache.setdefault(name,object.__new__(cls,name))

    ahmed1 = Person("Ahmed")
    ahmed2 = Person("Ahmed")
    print ahmed1 is ahmed2
    print ahmed1
    print ahmed2

    >>> False
    <__main__.Person instance at 0xb74acf8c>
    <__main__.Person instance at 0xb74ac6cc>
    >>> 
    ```

2.  新式班

    ```
    class Person(object):
        _names_cache = {}
        def __init__(self,name):
            self.name = name
        def __new__(cls,name):
            return cls._names_cache.setdefault(name,object.__new__(cls,name))

    ahmed1 = Person("Ahmed")
    ahmed2 = Person("Ahmed")
    print ahmed2 is ahmed1
    print ahmed1
    print ahmed2

    >>> True
    <__main__.Person object at 0xb74ac66c>
    <__main__.Person object at 0xb74ac66c>
    >>> 
    ```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-28T09:54:30.437

新式类继承自`object`Python 2.2 及以后的版本，并且必须这样编写（即`class Classname(object):`，而不是`class Classname:`）。核心变化是统一类型和类，这样做的好处是它允许您从内置类型继承。

阅读[说明](http://www.python.org/download/releases/2.2.3/descrintro/)以获取更多详细信息。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-04-30T08:28:52.780

新样式类可以使用`super(Foo, self)`where `Foo`is a class and `self`is the instance。

> `super(type[, object-or-type])`
> 
> 返回一个代理对象，它将方法调用委托给类型的父类或同级类。这对于访问已在类中重写的继承方法很有用。搜索顺序与 getattr() 使用的相同，只是跳过了类型本身。

而在 Python 3.x 中，您可以简单地`super()`在类中使用而无需任何参数。

# jquery - 如何使用 JQuery“后”选择器

> ID：54877
> 
> 赞同：8
> 
> 时间：2008-09-10T18:03:12.777
> 
> 标签：jquery, dom, css-selectors

我似乎无法找到一个好的方法来做到这一点，但它似乎应该很简单。我有一个我想要的元素`append a div`。然后我有另一个元素，我想克隆并推入该中间 div。这是我希望做的：

```
$("#somediv > ul").after("<div id='xxx'></div>").append($("#someotherdiv").clone()); 
```

这似乎很接近，但并不完全在那里。问题在于“附加”似乎在原始`#somediv > ul`选择器上运行。这有点道理，但这不是我想要的。如何最有效地选择我添加的中间 div 并将其`after`放入`#someotherdiv`其中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T18:37:39.010

反过来使用`insertAfter()`.

```
$("<div id='xxx'></div>")
    .append($("#someotherdiv").clone())
    .insertAfter("#somediv > ul") 
```

仅在完成工作后尝试将生成的 DOM 节点添加到文档中。

一旦将节点添加到显示的文档中，浏览器就会开始监听任何更改以刷新视图。在将节点添加到显示的文档之前完成所有工作确实可以提高浏览器性能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T18:30:07.767

使用插入后（）：

```
$("<div id='xxx'></div>").insertAfter("#somediv > ul").append($("#someotherdiv").clone()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T18:07:29.707

> 我怎样才能最有效地选择我用“之后”添加的中间 div 并将我的“#someotherdiv”放入其中？

@Vincent 的解决方案可能是获得相同结果的最快方法。但是，如果出于某种原因您需要添加 div`after()`然后需要选择它并对其进行操作，您可以使用

> `.nextAll( [expr] )`
> 
> `Find all sibling elements after the current element.
> Use an optional expression to filter the matched set.`

所以你的js变成：

```
$("#somediv > ul")
    .after("<div id='xxx'></div>")
    .nextAll('#xxx')
    .append($("#someotherdiv").clone()); 
```

# java - 我如何在 java 中将堆栈跟踪添加到我的调试打印输出中

> ID：54882
> 
> 赞同：12
> 
> 时间：2008-09-10T18:04:26.033
> 
> 标签：java, debugging

从调试打印输出中打印堆栈跟踪的最简单方法是什么？通常在测试期间，您想知道导致引发调试消息的情况的调用堆栈。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-12T19:07:34.600

如果您使用的是 log4j

```
Exception e = new Exception();
log.error("error here", e); 
```

会将堆栈跟踪打印到您的日志中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-10T18:27:42.670

[Thread.dumpStack();](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#dumpStack())

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-11T11:20:31.987

如果要将堆栈跟踪保存到字符串中，可以这样做；

```
String exception = "";
for (StackTraceElement element : e.getStackTrace())
   exception += element.toString() + "\n"; 
```

其中 e 显然是一个例外。

此外，自动生成自己的异常只是为了找到调试的堆栈跟踪，这听起来很奇怪。获取 Eclipse 并使用它的调试模式，真是太棒了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T18:06:44.703

只需创建一个任意异常对我来说就可以了：

```
System.out.println("Oops, the bad thing happened");
new IllegalStateException().printStackTrace(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-10T18:07:18.913

和@jjnguy 说的一样，如果没有异常，也可以调用Thread.getStackTrace()。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T18:05:41.333

您应该在 try-catch 块中捕获异常。

```
e.getStackTrace(); 
```

这将返回 StackTraceElement[] ，然后您可以对其进行解释。

还：

```
e.printStackTrace() 
```

将...打印堆栈跟踪。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-06T00:19:41.823

要简单地将当前堆栈跟踪打印到 stderr，您可以调用：

```
Thread.dumpStack(); 
```

它本身只是调用：

```
new Exception("Stack trace").printStackTrace(); 
```

要输出到**stdout**而不是 stderr，请传递`System.out`给`printStackTrace()`：

```
new Exception("Stack trace").printStackTrace(System.out); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-16T14:51:05.010

只是因为我自己需要它：

受答案启发[如何使用堆栈跟踪或反射找到方法的调用者？](https://stackoverflow.com/questions/421280/in-java-how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection)，您可以使用检索调用堆栈

```
StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace() 
```

然后你处理和打印/记录你感兴趣的任何东西。比使用更多的工作`Thread.dumpStack()`，但更灵活。

# java - Eclipse 的隐藏特性

> ID：54886
> 
> 赞同：97
> 
> 时间：2008-09-10T18:05:39.977
> 
> 标签：java, eclipse, ide

好吧，这可能是一个蹩脚的问题，但每个人使用这些东西的方式都不同。这个 IDE 有哪些最好的节省时间的方法。

汤姆

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-09-11T12:19:44.997

Don't forget `Ctrl`+`Shift`+`L`, which displays a list of all the keyboard shortcut combinations (just in case you forget any of those listed here).

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2009-03-10T03:01:42.623

# Ctrl-2 东西

似乎没有人提到 Ctrl-2 L（分配给新的局部变量）和 Ctrl-2 F（分配给新的字段），这些改变了我编写代码的方式。

以前，我在输入，比如说（| 是光标位置）：

```
Display display = new | 
```

然后我按下 Ctrl-Space 来完成构造函数调用。现在我输入：

```
new Display()| 
```

然后按 Ctrl-2 L，结果是：

```
Display display = new Display()| 
```

这确实加快了速度。（Ctrl-2 F 做同样的事情，但分配给一个新字段而不是一个新变量。）

另一个不错的快捷方式是 Ctrl-2 R：在文件中重命名。在重命名局部变量等内容时，它比重命名重构 (Alt-Shift-R) 快得多。

实际上，我去了 Keys 自定义首选项页面，并为 Ctrl-2-something 分配了各种额外的快速修复。例如，我现在按 Ctrl-2 J 拆分/加入变量声明，Ctrl-2 C 将内部类提取到顶层，Ctrl-2 T 向函数添加 throws 声明等。有很多可分配的快速修复，选择你最喜欢的并将它们分配给 Ctrl-2 快捷键。

# 模板

我的“npe”模板中另一个我最喜欢的，定义为：

```
if (${arg:localVar} == null)
    throw new ${exception:link(NullPointerException,IllegalArgumentException)}("${arg:localVar} is null"); 
```

这使我可以在每个函数的开头快速添加空参数检查（尤其是那些仅将参数保存到字段或将其添加到集合中的函数，尤其是构造函数），这对于早期检测错误非常有用。

[在www.tarantsov.com/eclipse/templates/](http://www.tarantsov.com/eclipse/templates/)上查看更多有用的模板。我不会在这里一一列出，因为有很多，而且我经常添加新的。

# 完成

一些代码完成技巧：

*   另一个答案中提到的骆驼案例支持：输入 cTM，获取 currentTimeMillis
*   默认构造函数：在没有默认构造函数的类声明中按下 Ctrl-Space，第一个选择是创建一个
*   重载：在类声明开始输入可以重载的方法的名称，Ctrl-Space，选择一个
*   getter/setter 创建：输入“get”，Ctrl-Space，选择要创建的getter；与“is”和“set”相同</li>

# 分配给新字段

这就是我添加字段的方式。

1.  如果您还没有构造函数，请添加一个。（在类声明中的任意位置按 Ctrl-Space，选择第一个提议。）

2.  添加一个参数（| 是光标位置）：

    ```
    public class MyClass {
        public MyClass(int something|) {
        }
    } 
    ```

3.  按 Ctrl-1，选择“分配给新字段”。你得到：

    ```
    public class MyClass {
        private final Object something;
        public MyClass(Object something) {
            this.something = something;
        }
    } 
    ```

4.  如果合适，添加一个空指针检查（参见上面的“npe”模板）：

    ```
    public class MyClass {
        private final Object something;
        public MyClass(Object something) {
            npe|
            this.something = something;
        }
    } 
    ```

    按 Ctrl-空格键，得到：

    ```
    public class MyClass {
        private final Object something;
        public MyClass(Object something) {
            if (something == null)
                throw new NullPointerException("something is null");
            this.something = something;
        }
    } 
    ```

一个伟大的节省时间！

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-09-10T18:21:07.367

ctrl-shift-r 及其伙伴 ctrl-shift-t 分别打开资源或类型。Resources 包括您打开的项目中的所有文件（包括非 java 文件），并且 types 包括您的项目中或项目中包含的库中的 java 类型。

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2008-09-10T18:06:59.333

`Crtl`+`1`是我的最爱。红色曲线的快速修复。

它也位于编辑菜单 -> 快速修复中。

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2008-09-10T18:17:07.640

`Ctrl`++`Shift`来`O`组织导入，这将很好地格式化它们，删除不需要的导入，并添加缺少的导入。

* * *

## 回答 #6

> 赞同：48
> 
> 时间：2008-09-12T05:05:59.447

Ctrl-J 开始增量查找。

点击 Ctrl-J，然后开始输入。使用向上/向下查找您键入的内容的上一个/下一个实例。

Ctrl-Shift-J 向后搜索。

* * *

## 回答 #7

> 赞同：37
> 
> 时间：2008-09-16T09:29:29.573

键入“syso”，然后按`Ctrl`+`Space`将其展开为 System.out.println()。

Tres 得心应手。

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2008-09-12T19:24:59.583

`CTRL`+`3`显示任何菜单命令的预先输入列表。

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2008-09-10T18:43:28.793

*   CTRL-SHIFT-g ：查找光标下的方法或字段的用法，对于理解代码绝对必要
*   CTRL-F6 ：在打开的编辑器窗口列表之间导航，如果您只键入一次并松开，您将切换回上一个编辑器窗口，连续执行此操作是来回跳转的好方法
*   CTRL-t ：在类或方法上将显示类型层次结构，对于查找接口方法的实现非常有用，例如

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2009-09-02T18:26:41.093

单击方法声明中的返回类型会突出显示该方法的所有退出点。

例如：

```
1: public void foo()
2: {
3:   somecode();
4:    if ( blah ) return;
5:
6:    bar();
7: } 
```

单击**void**将突出显示第 4 行的**return**和第 7 行的 close **}**。

**更新**：它甚至适用于 try{} catch 块。如果您将光标放在 catch 块中的异常上，eclipse 将突出显示可能引发该异常的可能方法。

* * *

## 回答 #11

> 赞同：24
> 
> 时间：2008-09-25T15:02:24.713

代码完成支持 CamelCase，例如，键入`CWAR`将显示`ClassWithAReallyLongName`. 开始使用此功能，您将永远不会再输入另一个长类名。

（从另一个答案复制的部分，因为我认为只有一个提示/提示的答案最适合轮询）

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2008-09-10T21:09:28.490

Alt-Up Arrow 将当前选择向上移动一行，Alt-Down Arrow 将其向下移动。我也一直使用 Alt-Shift-Up/Down Arrow。Ctrl-K 和 Ctrl-Shift-K 非常方便，查找当前选择的下一个/上一个出现（或最后一个查找，如果没有选择）。

* * *

## 回答 #13

> 赞同：22
> 
> 时间：2008-09-19T19:01:08.027

可以选择将左大括号和分号自动放置在“正确”位置。您必须启用此功能 - 选择 Window/Preferences 并在搜索框中键入“brace” - 应该很容易找到（这台计算机上没有 eclipse）。效果：

*   在该行的任意位置键入分号会将其放置在该行的末尾（如 word/openoffice: Backspace，如果您想将其放在原始位置）
*   当您刚刚在另一对大括号内时键入一个左大括号会将其放在该行的末尾 - 就像在这个例子中一样

（“|”是光标）：

```
if(i==0|) 
```

现在输入“{”将导致

```
if(i==0) {| 
```

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2008-09-12T10:51:26.213

Hippie expand/Word Complete，受 Emacs 启发的 afaik：将根据该文件中的其他单词自动完成任何编辑器中的任何单词。在 Java 代码、xml 文件中，随处可见的字符串文字内部自动完成。

`Alt`+`/`

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2008-09-12T16:13:36.720

**Alt-Shift-R**代表*rename*，而不是重构。重构是一个[更笼统的术语](http://en.wikipedia.org/wiki/Refactoring)（由[本书](https://rads.stackoverflow.com/amzn/click/com/0201485672)定义）。

尽管如此，它是我最喜欢的重构之一。其他包括：

*   **Alt-Shift-M**：[提取方法](http://www.refactoring.com/catalog/extractMethod.html)（选择代码块或表达式时）

*   **Alt-Shift-L**：[提取局部变量](http://www.refactoring.com/catalog/introduceExplainingVariable.html)（选择表达式时）

当我不记得（或不想​​输入）方法的结果类型时，提取局部变量特别有用。假设您`JdbcTemplate createJdbcTemplate()`的类中有一个方法，请编写如下代码：

```
void someQuery() {
    createJdbcTemplate()
} 
```

选择表达式`createJdbcTemplate()`，单击 Alt-Shift-L，键入变量名称并按 Enter。

```
void someQuery() {
    JdbcTemplate myTemplate = createJdbcTemplate();
} 
```

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2009-02-27T16:07:18.240

当然，`Ctrl`+`Q`转到最后一个编辑位置。在被电话、老板或其他人打断后非常有用。

* * *

## 回答 #17

> 赞同：17
> 
> 时间：2008-10-14T17:16:57.593

`CTRL`+ `D`- 删除当前行

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2008-09-10T18:50:24.143

`Alt`++`Shift`箭头`Up`进行升级选择。`Alt`++`Shift`则`Down`相反。

* * *

## 回答 #19

> 赞同：15
> 
> 时间：2008-09-11T03:33:33.590

`Alt`+`Up`或`Alt`+`Down`移动线条

* * *

## 回答 #20

> 赞同：15
> 
> 时间：2010-06-10T12:15:27.710

`Ctrl`++ `Shift`：`M`将类的静态方法或静态属性引用更改为静态导入。

前

```
import X;

...
X.callSomething(); 
```

后

```
import static X.callSomething;

...
callSomething(); 
```

* * *

## 回答 #21

> 赞同：14
> 
> 时间：2008-09-18T19:36:30.503

还没有人提到最好的。单击类或方法名称，然后按`Ctrl`+ `T`。

你得到一个快速的类型层次结构。对于类名，您可以看到整个类层次结构。对于方法名称，您将获得显示超类和子类的层次结构，该方法的实现与抽象提及或未提及该方法的类区分开来。

当您在一个抽象方法声明中并且很快想要查看它的实现位置时，这是巨大的。

* * *

## 回答 #22

> 赞同：13
> 
> 时间：2008-09-12T05:28:59.780

`F3`一直是我的最爱，打开所选项目的定义。

`Ctrl`++有一个有趣的功能，您可以在搜索时只使用类中的大写骆驼字母（例如键入 CWAR 将显示 ClassWithAReallyLongName 的结果）`Shift`。`R`

`Alt`+ `Shift`+ `W`> 包资源管理器让浏览大型项目时更轻松。

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2009-02-26T16:37:34.010

**[异常断点](http://blogs.bytecode.com.au/glen/2007/04/06/eclipse-tip--breakpoint-on-exception.html)**

Eclipse 允许您根据发生异常的位置设置断点。
您可以通过**“j！”访问该选项** [替代文本 http://help.eclipse.org/stable/topic/org.eclipse.jdt.doc.user/images/org.eclipse.jdt.debug.ui/elcl16/exc_catch.png](http://help.eclipse.org/stable/topic/org.eclipse.jdt.doc.user/images/org.eclipse.jdt.debug.ui/elcl16/exc_catch.png)调试窗口中的图标。

[替代文字 http://blogs.bytecode.com.au/glen/2007/04/06/images/2007/AddExceptionWindow.png](http://blogs.bytecode.com.au/glen/2007/04/06/images/2007/AddExceptionWindow.png)

官方帮助主题“**[添加 Java 异常断点](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/views/breakpoints/ref-addexception_viewaction.htm)**”对此有更多说明。

*   Uncaught Exception 选项是在未捕获位置抛出与断点相同类型的异常时暂停执行。
*   Caught Exception 选项是在捕获位置抛出与断点相同类型的异常时暂停执行。
*   不要忘记此**[异常的子类上的异常断点暂停](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/breakpoints/ref-suspendsubclass_option.htm)**：
    在遇到异常类型的子类时暂停执行。
    例如，**如果一个异常断点`RuntimeException`被配置为在子类上挂起，它也会被`NullPointerException`**.

[替代文本 http://help.eclipse.org/stable/topic/org.eclipse.jdt.doc.user/reference/breakpoints/images/ref-breakpoint_suspendsubclass.PNG](http://help.eclipse.org/stable/topic/org.eclipse.jdt.doc.user/reference/breakpoints/images/ref-breakpoint_suspendsubclass.PNG)

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2008-09-12T05:08:22.480

一个非键盘快捷键技巧是在您的 Team->Synchronise 视图中使用提交集来组织您的更改，然后再提交。

将更改集设置为默认值，您对文件所做的所有更改都将放在该集中，从而可以轻松查看您在处理特定缺陷/功能时所做的更改，以及您在测试时所做的其他更改等。

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2008-09-16T06:07:36.363

CTRL+SPACE，任何地方，任何地方。

生成 getter 和 setter。

使用字段创建构造函数

提取方法...

重构->重命名

CTRL+O 用于快速大纲。CTRL+O+CTRL+O 用于继承的大纲。

F4 显示类型层次结构

打开调用层次结构以显示调用方法的位置。

CTRL+SHIFT+T 打开一个 Java 类型

CTRL+SHIFT+R 打开任何资源。

ALT + 向左或向右可在文档中的编辑位置前进或后退（轻松导航）

如果您知道要执行很多方法，则覆盖/实施方法（否则，CTRL+SPACE 一次选择一个会更好。

重构->提取接口

重构->上拉

重构->下推

CTRL+SHIFT+O 用于组织导入（当输入通用类名称如 Map 时，按 CTRL+SPACE 然后选择适当的类将直接为您导入）。

CTRL+SHIFT+F 用于格式化（尽管 Eclipse 的内置格式化程序对于长行代码可能有点脑残）

编辑：哦，是的，一些调试：

F5：进入（告诉我细节！）

F6：跳过（我相信你，进入下一部分......）

F7：走出去（我以为我在乎这个方法，但事实证明我不在乎，让我离开这里！）

F8：继续（直到到达下一个断点）

CTRL+SHIFT+I：检查表达式。CTRL+SHIFT+I+CTRL+SHIFT+I：在被检查的表达式上创建一个监视表达式。

条件断点：右键单击断点，您可以设置一个触发其中断程序执行的条件（上下文辅助，使用 Ctrl+Space，在此处可用！）

F11 - 调试上次启动（应用程序）

CTRL+F11 - 运行上次启动（应用程序）

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2008-09-11T03:31:35.873

`Ctrl`+ `Alt`+`UP`或`Ctrl`+ `Alt`+`DOWN`复制行

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2008-09-12T12:50:17.630

`Ctrl`++`Alt`在`H`方法上获取它的调用层次结构。快速查看从哪里调用它的方法。

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2008-09-10T18:14:18.863

`Alt`++重构和重命名`Shift`。`R`

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2009-03-25T13:22:07.713

Here is my collection of the most useful keyboard shortcuts for Eclipse 3:

```
Eclipse 3 Favorite Keyboard Shortcuts. 
by -=MaGGuS=-

Navigate:

•   Ctrl + Shift + L – Shows useful keyboard shortcuts in popup window 
•   Ctrl + H – Search.
•   Ctrl + K – Goes to next search match in a single file. Shift + Ctrl + K – goes to previous match.
•   F3 - Goes to ‘declaration’ of something. Same as Ctrl + Click.
•   Ctrl + Shift + G - Use this on a method name or variable. It will search for references in the code (all the code) to that item.
•   Ctrl + O – Shows outline view of the current class or interface.
•   Ctrl + T – Shows class hierarchy of the current class or interface. F4 – shows the same in separate tab.
•   Ctrl + Shift + T - Open Type. Search for any type globally in the workspace.
•   Ctrl + Shift + R – Open Resource. Search for any file inside workspace.
•   Ctrl + J – Incremental search. Similar to the search in firefox. It shows you results as you type. Shift + Ctrl +J - Reverse incremental search.
•   Ctrl + Q – Goes to the last edit location.
•   Ctrl + Left|Right – Go Back/Forward in history.
•   Ctrl + L – Go to line number.
•   Ctrl + E – This will give you a list of all the source code windows that are currently open. You can arrow up or down on the items to go to a tab.
•   Ctrl +PgUp|PgDown – Cycles through editor tabs.
•   Ctrl + Shift + Up|Down - Bounces you up and down through the methods in the source code.
•   Ctrl + F7 – Switches between panes (views).
•   Ctrl + ,|. – Go to the previous/next error. Great in combination with Ctrl + 1.
•   Ctrl + 1 on an error – Brings up suggestions for fixing the error. The suggestions can be clicked.
•   Ctrl + F4 – Close one source window.

Edit:

•   Ctrl + Space – Auto-completion.
•   Ctrl + / – Toggle comment selected lines.
•   Ctrl + Shift + /|\ – Block comment/uncomment selected lines.
•   Ctrl + Shift + F – Quickly ‘formats’ your java code based on your preferences set up under Window –&gt; Preferences.
•   Ctrl + I – Correct indentations.
•   Alt + Up|Down – move the highlighted code up/down one line. If nothing is selected, selects the current line.
•   Ctrl + D – Delete row.
•   Alt + Shift + Up|Down|Left|Right – select increasing semantic units.
•   Ctrl + Shift + O – Organize Imports.
•   Alt + Shift + S – Brings up “Source” menu.
o   Shift + Alt + S, R – Generate getter/setter.
o   Shift + Alt + S, O – Generate constructor using fields.
o   Shift + Alt + S, C – Generate constructor from superclass.
•   Alt + Shift + T – Brings up “Refactor” menu.
•   Alt + Shift + J – Insert javadoc comment.
•   F2 – Display javadoc popup for current item. Shift + F2 – Display javadoc in external browser.

Run/Debug:

•   F11 / Ctrl + F11 – Execute/debug.
•   Ctrl + Shift +B – Toggle breakpoint.
•   When paused: F5 – Step into, F6 – Step over, F7 – Step out, F8 – Resume.
•   Ctrl + F2 – Terminate.

EOF 
```

* * *

## 回答 #30

> 赞同：7
> 
> 时间：2008-09-12T05:06:36.387

`Ctrl`+ `Shift`+`L`将显示所有当前可用的键盘快捷键

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2010-07-02T08:08:00.147

不是那么隐藏，但 IMO 是最好的把戏。

假设默认设置（并且您还没有添加新的片段）

突出显示（或选择）文本（字符串或变量）...按 Ctrl+空格。点击结束+回车。“sysout”片段被触发，它将选择作为其参数包装起来。

例如。

```
 "hello world!"

becomes
System.out.println("hello world!"); 
```

我非常喜欢它，以至于我在手动调试期间为 Android 的 Toast 和 Log.i() 实现了一个类似的代码段。

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2009-03-02T11:41:38.337

隐藏的宝石是条件断点。对于跳过部分循环、如果某些内容为空或满足某个值等时暂停等**非常**`Breakpoint Properties`有用...只需右键单击断点--> `Enable Condition`。文本框中甚至还有代码辅助！

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2008-12-31T18:27:55.333

Ctrl-Alt-h 打开所选方法的调用层次结构。

在大型代码库或未知代码库上非常有用

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2009-02-27T06:37:22.227

**Ctrl+**和**Ctrl+。**将文本光标移动到源中的下一个和上一个错误或警告（红色或黄色曲线）。如果您在重构或粘贴的深度中处理大量脏或损坏的代码，这将非常有用。结合**Ctrl+1**建议修复，您可以快速修复代码，而无需将手移到鼠标上。

事实上，您几乎不需要将手指从 Ctrl 上移开...

* * *

## 回答 #35

> 赞同：4
> 
> 时间：2008-09-10T19:13:21.033

保存动作摇滚。在那里，您可以组织导入 (Ctrl+Shift+o) 和代码格式 (CTRL + SHIFT + f)。除此之外，我喜欢 ALT + Shift + R 进行重构。

不过，我最喜欢的是插件：它们可能会导致您使用更多时间，但大多数时候它们会提供质量（我知道这是主观的）

*   代码覆盖率 (ECLEMMA)
*   源静态分析（PMD）
*   字节码静态分析(FindBugs)
*   检查样式
*   SpringIDE。

然后你开始使用强制性的源代码控制插件和 maven 2 插件。

摇滚吧！

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2008-09-22T18:56:48.230

ctrl + O 是一个弹出大纲视图，可让您开始输入以过滤名称

Ctrl + F3 的作用类似，但它可以根据光标所在的位置打开其他类型的轮廓。

打开保存操作以清理您的代码，每次保存时它都会自动格式化和导入优化。要轻松访问此选项，请选择“Windows|Preferences”开始，在过滤器框中键入“Save Act”并打开该选项。

在新的 3.4 版本中，打开编辑器窗口顶部的“Breadcrumb trail”。为此有一个新的工具栏按钮。

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2009-03-17T06:07:51.677

Ctrl + Shift + P 查找匹配的大括号。在处理长代码时非常有用。

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2008-09-11T12:50:02.600

If you want to put a System.out.println("anything"); to your code you can simply do as follows: Only write ", then mark the "" and press Crtl-Space Up-Arrow and enter (you should land on "sysout").

Voila, there it is :)

* * *

## 回答 #39

> 赞同：3
> 
> 时间：2010-07-01T17:30:56.683

您可以按住 CTRL 键单击几乎任何类型、字段、方法或变量，eclipse 将带您进入该项目的声明：

IE：

*   在局部变量上 - 将您带到函数中的声明语句
*   在成员变量上 - 将您带到声明成员的类文件中的定义（或父类，如果它没有在子类中被覆盖
*   on a class - 将您带到该类的类文件的顶部

您还可以将 CTRL 悬停在类型上以调出查找实现的选项。如果您正在使用接口并想查看哪些类实现了该接口，这将很有用。它还可以查看哪些超类和子类可能实现/覆盖某个功能。

* * *

## 回答 #40

> 赞同：3
> 
> 时间：2009-05-18T19:12:27.517

怎么样：

Ctrl-PgUp 和 Ctrl-PgDn 在编辑器中浏览打开的文件（包括溢出部分，如果你 Ctrl-PgDn 一直向右）。

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2009-03-25T13:01:23.287

One combination to rules them all.

CTL+SHFT+L

Get the list of all these "hidden" features.

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2010-03-06T17:24:17.643

Ctrl + H 搜索/替换整个工作区或项目。

* * *

## 回答 #43

> 赞同：2
> 
> 时间：2008-09-10T18:10:52.943

Ctrl+f 然后勾选“正则表达式”复选框。从此，您可以使用正则表达式进行搜索，但更强大的是，您可以在替换字符串中包含组匹配项（$1、$2 等，或 $0 表示整个匹配项）。

* * *

## 回答 #44

> 赞同：2
> 
> 时间：2008-10-22T14:07:50.467

ctrl-alt-up/down 向上（或向下）复制一行。接下来是 alt-up/down 通常比复制粘贴快得多

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2008-10-22T14:09:22.227

不知道它的键盘快捷键，但在方法中选择一个局部变量，然后右键单击。重构下是“将局部变量转换为字段”。在某些场合非常有用。只希望有一条捷径！

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2009-02-27T16:22:56.687

Java 编辑器中的 Ctrl-Shift-Up 或 Down 跳转到该方向上最近的方法或字段声明。

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2009-05-28T22:15:56.223

如果这是重复的，我很抱歉，但我认为我没有看到这里提到的这个，我浏览了所有的帖子：

单词补全：

```
Alt + / 
```

是 Ctrl+Space 的一个非常好的替代品。它并不能完全取代 Ctrl+Space，但*要快得多*。并且不要害怕多次按下它，它会不断循环选择可能的选项。

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2009-11-29T16:00:47.850

alt+shift+z - 激活“环绕”子菜单。当必须用 try catch 块包围时很方便。

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2009-11-04T15:17:08.670

如果您使用 F3 键导航到方法的源代码，您通常会浪费时间切换到接口而不是直接转到实现类（对于 DAO，Service，通常只有一个。 .. 例如）

使用 Ctrl+Mouse 指针指向代码的一种方法，您将能够在直接转到直接转到实现（类）或声明（接口）之间进行选择

此处有关此提示的更多信息：

[http://www.ibm.com/developerworks/opensource/library/os-eclipse-galnav/index.html](http://www.ibm.com/developerworks/opensource/library/os-eclipse-galnav/index.html)

这仅在 Galileo 中可用，您也可以使用 Ctrl + T 。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2008-09-19T02:34:59.030

调试时，我发现“显示”视图非常有用。它允许您键入代码（使用自动完成）并允许您运行/显示您编写的任何内容的结果。

试试看！

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2008-09-11T03:45:24.063

Ctrl+Shift+Enter 将当前行下移一位并开始在其上方输入。
Ctrl+Shift+X 将当前选择大写，Ctrl-Shift-Y 将其更改为小写。
Ctrl+。自动完成当前单词。这适用于变量和字符串（例如，这对于数组键来说是一个巨大的节省时间）

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2008-10-06T17:16:12.760

快速辅助：Ctrl + 2，然后是 F（分配给字段）、L（分配给局部变量）和 R（在文件中重命名）

最后编辑位置：Ctrl+Q

查看这篇文章：[http ://dmy999.com/article/29/using-eclipse-efficiently](http://dmy999.com/article/29/using-eclipse-efficiently)

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2008-10-14T00:17:29.477

ALT+Shift+X + T

这会将您当前的文件作为单元测试运行。

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2008-10-14T17:25:37.840

Ctrl-1 to convert if to conditional expression and back, split an assignment or join it back or do other such small manipulations. There is a list of these in the help.

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2009-06-16T21:32:03.173

CTRL-MouseClick（左）作为 F3 进入声明的替代方法。

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2010-01-28T10:34:08.913

双击左括号旁边将突出显示所有代码，直到右括号，反之亦然。

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2009-05-31T23:11:06.240

Shift-F2 转到任何方法的 Javadoc。

经常使用它。对于库，您需要配置位置，但对于标准类，它们是由 Eclipse 预定义的

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2010-06-08T11:45:34.210

不是那么隐藏的功能，但很少有人使用它并且不探索它 [模板](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/preferences/java/editor/ref-preferences-templates.htm) [键盘快捷键](http://wiki.eclipse.org/FAQ_How_do_I_provide_a_keyboard_shortcut_for_my_action%3F)

亚历克斯解释了[成员排序](http://www.eclipsezone.com/eclipse/forums/t88299.rhtml)

[移动线](http://blog.empiregpservices.com/post.cfm/eclipse-ide-shortcut-move-code-up-down)

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2009-02-14T00:50:31.633

取决于节省时间对您意味着什么...

在注释中添加 TODO 和 FIXME 会自动将任务添加到 Eclipse 中的任务列表中。因此，如果您想返回某个代码，例如您正在调试并需要进行一些研究，您可以...

FIXME 表示紧急，表示红色！在任务窗口
TODO是正常的紧迫

```
//FIXME: This accidentally deletes user accounts
user.account().delete();

//TODO: Add some validation before assigning everyone as admin
user.setPrivilege("Admin"); 
```

然后会自动构建 setter/getter。如果您正在创建 bean 或其他东西，这很棒。假设您已经声明了一个类，例如：

```
public class SomeBean {
    private static int FIRST_VALUE = 0;
    private static int SECOND_VALUE = 1;
    ...
    private static int THOUSANDTH_VALUE = 1000;
} 
```

您可以创建所有变量，然后在编辑器中右键单击，转到 Source，然后选择 Generate Setters & Getters。这将自动为您创建它们。

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2009-06-22T04:48:36.547

ctrl+d 删除当前行

alt+up/down 向上或向下移动所选文本的当前行或块

ctrl+alt+up/down 向上或向下复制/复制所选文本的当前行或块

ctrl+alt+c SVN 提交（带有颠覆性）

ctrl+alt+u SVN更新（带有颠覆性）

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2009-08-11T01:34:47.150

我最近将 alt-enter 映射到与 ctrl-1 相同的命令。它只是更容易到达。

我也使用 alt+shift+x &t 一堆，但我不喜欢集成测试运行器的工作方式。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2010-03-30T19:36:35.577

安装[MouseFeed](http://www.mousefeed.com/) Eclipse 插件。安装后，每当您单击与快捷方式关联的按钮或菜单项时，它都会显示带有键盘快捷方式的弹出窗口。

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2010-03-30T20:34:33.450

Ctrl-F6 在打开的编辑器窗口中循环焦点（使用 Ctrl-Shift-F6 向后循环）

Ctrl-F7 在 Eclipse 视图中循环焦点

Ctrl-F8 循环 Eclipse 透视图

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2008-09-10T18:45:38.697

CTRL + b：在c++下构建项目

CTRL + SHIFT + f: 格式化你的代码 (c++)

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2010-02-08T23:29:00.813

eclipse 帮助包含很多有用的资源。只需搜索“提示和技巧”。特别是我发现“提示和技巧（JDT）”非常有用。

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2009-02-15T05:14:30.710

如果您使用 Ant 构建项目，您可以为“运行上次启动的外部工具”分配一个快捷方式，例如 Ctrl+Enter，它将重复您的上次构建。它比标准的 Alt+Shift+X,Q 容易得多，它还有助于解决最新 Eclipse 中无法在项目中找到 ant 构建文件的错误。

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2008-10-14T00:06:54.240

当然，如果您找不到您正在寻找的绑定，或者不喜欢当前的绑定 Window -> Preferences -> General -> Keys 将允许您更改、添加和删除组合键的映射。

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2009-05-18T19:43:23.947

我很惊讶没有人提到 Eclipse 中可用的 Emacs 键绑定设置。这是我最喜欢的小功能之一；它允许我从 Emacs 过渡到 Eclipse，而无需对我的导航首选项进行一些调整。

Windows->首选项->常规->键->方案。

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2008-09-11T15:18:56.673

当然，所有这些快捷方式都可以在菜单中使用，但是当您处于“区域”时，谁有时间这样做。

我喜欢代码热交换。

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2009-05-14T23:38:34.667

在比较/补丁设置中启用“忽略空白”可以节省实时！

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2010-01-28T10:51:47.170

在

> Windows/首选项/常规/键

定义

> Alt + C

对于 SVN 提交

> Alt + U

用于 SVN 更新

> Shift + Ctrl + N

对于新类对话框。

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2009-02-27T06:27:08.337

我真的有偏见，这是公然的广告......

不过，我认为我的新 Eclipse 插件[nWire](http://www.nwiresoftware.com/)是您可以为 Eclipse 节省的最佳时间。我在使用 Eclipse 多年后开发了它，我刚刚得出的结论是，我需要一个工具来向我展示我的代码的所有关联，而不是学习不同的工具和视图。

[在我的网站上](http://www.nwiresoftware.com/)查看演示。

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2009-05-18T19:25:57.007

经常按 CTRL+S。它是 CTRL+1 最好的朋友。

# asp.net - 作为 ASP.NET 程序员，我是否需要担心电子邮件注入攻击？

> ID：54889
> 
> 赞同：7
> 
> 时间：2008-09-10T18:05:54.500
> 
> 标签：asp.net, security, email

有很多关于这个主题的 PHP 文章，所以这是一个 PHP 唯一的问题。当然，经过一些正则表达式检查后，我正在使用 System.Net.Mail 发送电子邮件。类似于[http://weblogs.asp.net/scottgu/archive/2005/12/10/432854.aspx](http://weblogs.asp.net/scottgu/archive/2005/12/10/432854.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T18:11:07.843

由于 PHP Mail() 函数的弱点，PHP 电子邮件注入攻击有效。作为 .net 开发人员，您不必担心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-10T18:11:05.767

我在 ASP.NET 中从未听说过这个问题。但是，您应该信任用户输入，就像信任使用钱包的妓女一样多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T18:17:32.943

只要您使用[MailAddress](http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddress.aspx)对象，我认为您没问题，因为注入只会设法为指定地址抛出 FormatExceptions。

如何正确使用 System.Net.Mail 组件的示例包含在该 MSDN 页面中；一定要跟着他们，你会没事的。

# java - 如何在 Java 中克隆通用列表？

> ID：54909
> 
> 赞同：169
> 
> 时间：2008-09-10T18:11:50.947
> 
> 标签：java, generics, arraylist, clone

我有一个`ArrayList<String>`我想退回的副本。 `ArrayList`有一个具有以下签名的克隆方法：

```
public Object clone() 
```

调用此方法后，如何将返回的 Object 转换回`ArrayList<String>`？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2008-09-11T12:10:33.567

为什么要克隆？创建一个新列表通常更有意义。

```
List<String> strs;
...
List<String> newStrs = new ArrayList<>(strs); 
```

任务完成。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2008-09-10T18:13:19.663

```
ArrayList newArrayList = (ArrayList) oldArrayList.clone(); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-04-20T18:38:56.303

这是我使用的代码：

```
ArrayList copy = new ArrayList (original.size());
Collections.copy(copy, original); 
```

希望对你有用

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-01-26T13:01:38.390

使用 Java 8，它可以用流克隆。

```
import static java.util.stream.Collectors.toList; 
```

...

```
List<AnObject> clone = myList.stream().collect(toList()); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-12-08T17:54:29.490

请注意，Object.clone() 存在一些重大问题，并且在大多数情况下不鼓励使用它。请参阅 Joshua Bloch 的“ [Effective Java](http://java.sun.com/docs/books/effective/) ”中的第 11 条以获得完整答案。我相信您可以在原始类型数组上安全地使用 Object.clone()，但除此之外，您需要谨慎地正确使用和覆盖克隆。您最好定义一个复制构造函数或根据您的语义显式克隆对象的静态工厂方法。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-09-10T19:48:59.777

我认为这应该使用 Collections API 来解决问题：

**注意**：复制方法以线性时间运行。

```
//assume oldList exists and has data in it.
List<String> newList = new ArrayList<String>();
Collections.copy(newList, oldList); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-10T18:15:56.800

我发现使用 addAll 效果很好。

```
ArrayList<String> copy = new ArrayList<String>();
copy.addAll(original); 
```

使用括号而不是泛型语法

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-02-16T11:09:42.643

如果您希望这样做以便能够在吸气剂中返回列表，最好这样做：

```
ImmutableList.copyOf(list); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-01-04T14:31:46.590

```
List<String> shallowClonedList = new ArrayList<>(listOfStrings); 
```

请记住，这只是浅拷贝而不是深拷贝，即。您会得到一个新列表，但条目是相同的。这对于简单的字符串来说没有问题。当列表条目本身是对象时，变得更加棘手。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-09-11T10:39:26.897

要克隆一个像`java.util.List`你这样的通用接口，只需要强制转换它。这是一个例子：

```
List list = new ArrayList();
List list2 = ((List) ( (ArrayList) list).clone()); 
```

这有点棘手，但它可以工作，如果你被限制返回一个`List`接口，那么你之后的任何人都可以随时实现你的列表。

我知道这个答案接近最终答案，但我的答案回答了在您使用`List`通用父级时如何做所有这些事情，而不是`ArrayList`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-10T18:17:37.967

这也应该有效：

```
ArrayList<String> orig = new ArrayList<String>();
ArrayList<String> copy = (ArrayList<String>) orig.clone() 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-01T02:52:59.737

克隆 ArrayList 时要非常小心。java中的克隆很浅。这意味着它只会克隆 Arraylist 本身而不是其成员。因此，如果您有一个 ArrayList X1 并将其克隆到 X2 中，则 X2 中的任何更改也将体现在 X1 中，反之亦然。克隆时，您只会生成一个新的 ArrayList，其中包含指向原始元素中相同元素的指针。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-10T18:13:17.183

```
ArrayList first = new ArrayList ();
ArrayList copy = (ArrayList) first.clone (); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-23T12:19:06.727

我不是java专业人士，但我有同样的问题，我试图通过这种方法解决。（假设 T 有一个复制构造函数）。

```
 public static <T extends Object> List<T> clone(List<T> list) {
      try {
           List<T> c = list.getClass().newInstance();
           for(T t: list) {
             T copy = (T) t.getClass().getDeclaredConstructor(t.getclass()).newInstance(t);
             c.add(copy);
           }
           return c;
      } catch(Exception e) {
           throw new RuntimeException("List cloning unsupported",e);
      }
} 
```

# java - 使 JPanel 不绘制其背景（透明）

> ID：54926
> 
> 赞同：26
> 
> 时间：2008-09-10T18:18:28.060
> 
> 标签：java, user-interface

在 Java 中，是否有可能`JPanel`跳过绘制其背景，从而除了其上的组件之外是透明的？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-10T18:19:21.130

`setOpaque(false)`

它会将背景绘制传递给其父级，后者可能会绘制自己的背景。

您可以进行屏幕捕获，然后使用它来绘制面板的背景。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T18:22:47.160

这篇文章似乎有一些关于如何在 Java 中创建形状和透明窗口的方便信息：

[https://docs.oracle.com/javase/tutorial/uiswing/misc/trans_shape_windows.html](https://docs.oracle.com/javase/tutorial/uiswing/misc/trans_shaped_windows.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-11T12:46:34.667

从技术上讲，JPanel 可能一开始是不透明的。这对于 1.5（或 1.4？）中的 Gtk 外观和感觉是正确的，但据我所知，没有其他 PL&F。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-06T13:49:26.403

如果您使用的是 NetBeans，请执行以下步骤：-

1.  右键单击`JPanel`。
2.  向下滚动并搜索 (( Opaque ))。它必须在那里。
3.  取消选中它。
4.  Now your `JPanel` background will be removed and what will appear in `JPanel` Background is your Background of `JFrame`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-28T12:32:49.207

```
class TransparentJPanel extends JPanel
{
    TransparentJPanel()
    {
        super() ;
        this.setOpaque( false ) ; // this will make the JPanel transparent 
                                  // but not its components (JLabel, TextField etc.)
        this.setLayout( null ) ;
    }
} 
```

# asp.net - ASP.NET 的隐藏特性

> ID：54929
> 
> 赞同：292
> 
> 时间：2008-09-10T18:20:47.570
> 
> 标签：asp.net, .net

> 这个问题的存在是因为它具有历史意义，但它不被认为是本网站的一个好的、主题性的问题，**所以请不要将它作为你可以在这里提出类似问题的证据。**
> 
> 更多信息：[https ://stackoverflow.com/faq](https://stackoverflow.com/faq)

* * *

总有一些功能在边缘场景中很有用，但正因为如此，大多数人并不了解它们。我要求的是教科书通常不教授的功能。

你知道的有哪些？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2008-09-16T18:04:09.073

测试时，您可以将电子邮件发送到计算机上的文件夹，而不是 SMTP 服务器。把它放在你的 web.config 中：

```
<system.net>
    <mailSettings>
        <smtp deliveryMethod="SpecifiedPickupDirectory">
            <specifiedPickupDirectory pickupDirectoryLocation="c:\Temp\" />
        </smtp>
    </mailSettings>
</system.net> 
```

* * *

## 回答 #2

> 赞同：210
> 
> 时间：2008-09-10T20:58:16.193

如果将名为***app_offline.htm***的文件 放在 Web 应用程序目录的根目录中，ASP.NET 2.0+ 将关闭应用程序并停止正常处理该应用程序的任何新传入请求，仅显示 app_offline.htm 的内容*所有新请求的*文件。

这是在将更改重新部署（或回滚）到生产服务器时显示“站点暂时不可用”通知的最快和最简单的方法。

[此外，正如marxidad](https://stackoverflow.com/users/1659/marxidad)所指出的，确保文件中至少有 512 字节的内容，以便 IE6 可以正确呈现它。

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2008-09-10T20:22:33.970

```
throw new HttpException(404, "Article not found"); 
```

这将被 ASP.NET 捕获，并返回 customErrors 页面。[在最近的 .NET Tip of the Day Post](http://dotnettipoftheday.org/tips/how-to-respond-with-code-404-not-found-in-aspnet.aspx?discussion=1)中了解了这一点

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2009-07-03T08:45:22.783

这是最好的一个。将此添加到您的 web.config 以加快编译速度。[这是通过此 QFE](http://support.microsoft.com/kb/961884)发布的 3.5SP1 。

```
<compilation optimizeCompilations="true"> 
```

> 快速总结：我们在 ASP.NET 中引入了一个新的 optimizeCompilations 开关，可以在某些场景下大大提高编译速度。有一些问题，请继续阅读以获取更多详细信息。此开关目前可用作 3.5SP1 的 QFE，并将成为 VS 2010 的一部分。
> 
> ASP.NET 编译系统采用一种非常保守的方法，这会导致它在“顶级”文件更改时清除之前所做的任何工作。“顶级”文件包括 bin 和 App_Code 以及 global.asax 中的任何内容。虽然这适用于小型应用程序，但它对于非常大的应用程序几乎无法使用。例如，客户遇到这样一种情况，即在对“bin”程序集进行任何更改后，刷新页面需要 10 分钟。
> 
> 为了减轻痛苦，我们添加了一种“优化”编译模式，它采用了一种不那么保守的重新编译方法。

通过[这里](http://blogs.msdn.com/davidebb/archive/2009/04/15/a-new-flag-to-optimize-asp-net-compilation-behavior.aspx)：

* * *

## 回答 #5

> 赞同：73
> 
> 时间：2008-09-10T20:11:14.403

*   **HttpContext.Current**将始终让您访问当前上下文的请求/响应等，即使您无权访问页面的属性（例如，从松散耦合的辅助类）。

*   **通过调用Response.Redirect( *url* ,** false **)**将用户重定向到另一个页面后，您可以继续在同一页面上执行代码

***   如果您想要的只是一个已编译的**Page**（或任何**IHttpHandler**），则不需要*.ASPX文件。*只需将路径和 HTTP 方法设置为指向web.config 文件中[元素中的类。](http://msdn.microsoft.com/en-us/library/aa903367%28VS.71%29.aspx)****[*`<httpHandlers>`*](http://msdn.microsoft.com/en-us/library/aa903367%28VS.71%29.aspx)****

    *****   可以通过调用**PageParser.GetCompiledPageInstance(virtualPath,aspxFileName,Context)以编程方式从***.ASPX*文件中检索**Page**对象****** 

 ******** * *

## 回答 #6

> 赞同：70
> 
> 时间：2009-05-03T23:50:50.657

machine.config 级别的零售模式：

```
<configuration>
  <system.web>
    <deployment retail="true"/>
  </system.web>
</configuration> 
```

覆盖 web.config 设置以强制调试为 false，打开自定义错误并禁用跟踪。不再忘记在发布之前更改属性 - 只需将它们全部配置为开发或测试环境并更新生产零售设置。

* * *

## 回答 #7

> 赞同：59
> 
> 时间：2009-01-29T11:23:17.957

Enabling **intellisense for MasterPages** in the content pages
I am sure this is a very little known hack

Most of the time you have to use the findcontrol method and cast the controls in master page from the content pages when you want to use them, the **MasterType** directive will enable intellisense in visual studio once you to this

just add one more directive to the page

```
<%@ MasterType VirtualPath="~/Masters/MyMainMasterPage.master" %> 
```

If you do not want to use the Virtual Path and use the class name instead then

```
<%@ MasterType TypeName="MyMainMasterPage" %> 
```

Get the full article [here](http://www.simple-talk.com/content/print.aspx?article=398)

* * *

## 回答 #8

> 赞同：58
> 
> 时间：2008-09-10T18:23:37.423

HttpContext.Items 作为请求级缓存工具

* * *

## 回答 #9

> 赞同：52
> 
> 时间：2008-09-10T19:36:28.183

有两件事在我脑海中突出：

1）您可以从代码中打开和关闭 Trace：

```
#ifdef DEBUG 
   if (Context.Request.QueryString["DoTrace"] == "true")
                {
                    Trace.IsEnabled = true;
                    Trace.Write("Application:TraceStarted");
                }
#endif 
```

2) 您可以只使用一个共享的“代码隐藏”文件来构建多个 .aspx 页面。

构建一个类 .cs 文件：

```
public class Class1:System.Web.UI.Page
    {
        public TextBox tbLogin;

        protected void Page_Load(object sender, EventArgs e)
        {

          if (tbLogin!=null)
            tbLogin.Text = "Hello World";
        }
    } 
```

然后您可以拥有任意数量的 .aspx 页面（在您删除 VS 生成的 .designer.cs 和 .cs 代码隐藏之后）：

```
 <%@ Page Language="C#"  AutoEventWireup="true"  Inherits="Namespace.Class1" %>
     <form id="form1" runat="server">
     <div>
     <asp:TextBox  ID="tbLogin" runat="server"></asp: TextBox  >
     </div>
     </form> 
```

您可以在 ASPX 中拥有未出现在 Class1 中的控件，反之亦然，但您需要记住检查控件是否为空。

* * *

## 回答 #10

> 赞同：48
> 
> 时间：2008-09-10T20:04:23.890

您可以使用：

```
 Request.Params[Control.UniqueId] 
```

在初始化视图状态之前获取控件的值（此时 Control.Text 等将为空）。

这对于 Init 中的代码很有用。

* * *

## 回答 #11

> 赞同：46
> 
> 时间：2009-07-21T21:33:28.177

**网络方法。**

您可以对放置在 ASPX 页面中的 Web 方法使用 ASP.NET AJAX 回调。您可以使用 [WebMethod()] 和 [ScriptMethod()] 属性来装饰静态方法。例如：

```
[System.Web.Services.WebMethod()] 
[System.Web.Script.Services.ScriptMethod()] 
public static List<string> GetFruitBeginingWith(string letter)
{
    List<string> products = new List<string>() 
    { 
        "Apple", "Banana", "Blackberry", "Blueberries", "Orange", "Mango", "Melon", "Peach"
    };

    return products.Where(p => p.StartsWith(letter)).ToList();
} 
```

现在，在您的 ASPX 页面中，您可以执行以下操作：

```
<form id="form1" runat="server">
    <div>
        <asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" />
        <input type="button" value="Get Fruit" onclick="GetFruit('B')" />
    </div>
</form> 
```

并使用以下方法通过 JavaScript 调用您的服务器端方法：

```
 <script type="text/javascript">
    function GetFruit(l)
    {
        PageMethods.GetFruitBeginingWith(l, OnGetFruitComplete);
    }

    function OnGetFruitComplete(result)
    {
        alert("You got fruit: " + result);
    }
</script> 
```

* * *

## 回答 #12

> 赞同：45
> 
> 时间：2009-11-15T16:35:23.847

在开始长时间运行的任务之前检查客户端是否仍然连接：

```
if (this.Response.IsClientConnected)
{
  // long-running task
} 
```

* * *

## 回答 #13

> 赞同：44
> 
> 时间：2009-07-30T10:24:22.410

ASP.NET 的一个鲜为人知且很少使用的特性是：

[标签映射](http://madskristensen.net/post/Tag-mapping-in-ASPNET.aspx)

它很少使用，因为只有在特定情况下您才需要它，但是当您需要它时，它*非常*方便。

关于这个鲜为人知的功能的一些文章：

[ASP.NET 中的](http://madskristensen.net/post/Tag-mapping-in-ASPNET.aspx)
[标记映射 在 ASP.NET 2.0 中使用标记映射](http://www.fmsinc.com/free/NewTips/NET/tag_mapping.html)

从上一篇文章中：

> 标签映射允许您在编译时在 Web 应用程序的每个页面上交换兼容的控件。一个有用的示例是，如果您有一个常用的 ASP.NET 控件，例如 DropDownList，并且您希望将其替换为从 DropDownList 派生的自定义控件。这可能是一个经过定制的控件，可提供更优化的查找数据缓存。无需编辑每个 Web 表单并将内置的 DropDownLists 替换为您的自定义版本，您可以通过修改 web.config 让 ASP.NET 实际上为您执行此操作：

```
<pages>
 <tagMapping>
   <clear />
   <add tagType="System.Web.UI.WebControls.DropDownList"
        mappedTagType="SmartDropDown"/>
  </tagMapping>
</pages> 
```

* * *

## 回答 #14

> 赞同：43
> 
> 时间：2008-09-10T18:22:05.663

[HttpModules](http://msdn.microsoft.com/en-us/library/ms227673.aspx)。建筑非常优雅。也许不是隐藏功能，但仍然很酷。

* * *

## 回答 #15

> 赞同：34
> 
> 时间：2009-02-21T04:28:43.990

**代码表达式生成器**

示例标记：

```
Text = '<%$ Code: GetText() %>'
Text = '<%$ Code: MyStaticClass.MyStaticProperty %>'
Text = '<%$ Code: DateTime.Now.ToShortDateString() %>'
MaxLenth = '<%$ Code: 30 + 40 %>' 
```

代码表达式构建器的真正美妙之处在于，您可以在非数据绑定情况下使用类似表达式的数据绑定。您还可以创建执行其他功能的其他表达式生成器。

网络配置：

```
<system.web>    
    <compilation debug="true">
        <expressionBuilders>
            <add expressionPrefix="Code" type="CodeExpressionBuilder" /> 
```

使这一切发生的cs类：

```
[ExpressionPrefix("Code")]
public class CodeExpressionBuilder : ExpressionBuilder
{
    public override CodeExpression GetCodeExpression(
        BoundPropertyEntry entry,
        object parsedData,
        ExpressionBuilderContext context)
    {            
        return new CodeSnippetExpression(entry.Expression);
    }
} 
```

* * *

## 回答 #16

> 赞同：34
> 
> 时间：2008-10-11T14:41:30.340

您可以在 .aspx 页面中使用 ASP.NET 注释来注释掉页面的完整部分，包括服务器控件。并且被注释掉的内容永远不会发送给客户端。

```
<%--
    <div>
        <asp:Button runat="server" id="btnOne"/>
    </div>
--%> 
```

* * *

## 回答 #17

> 赞同：33
> 
> 时间：2009-01-29T11:06:23.747

ASHX 文件类型的用法：
如果您只想输出一些基本的 html 或 xml 而不通过页面事件处理程序，那么您可以以简单的方式实现 HttpModule

将页面命名为 SomeHandlerPage.ashx 并将以下代码（仅一行）放入其中

```
<%@ webhandler language="C#" class="MyNamespace.MyHandler" %> 
```

然后是代码文件

```
using System;
using System.IO;
using System.Web;

namespace MyNamespace
{
    public class MyHandler: IHttpHandler
    {
        public void ProcessRequest (HttpContext context)
        {   
            context.Response.ContentType = "text/xml";
            string myString = SomeLibrary.SomeClass.SomeMethod();
            context.Response.Write(myString);
        }

        public bool IsReusable
        {
            get { return true; }
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：27
> 
> 时间：2008-09-12T07:25:26.020

[基于目标浏览器设置服务器控制](http://ryanfarley.com/blog/archive/2008/08/14/set-browser-specific-asp.net-server-control-properties-and-taking-an.aspx)[属性](http://ryanfarley.com/blog/archive/2008/08/14/more-on-device-filtering-with-asp.net-server-control-properties.aspx)等。

> ```
> <asp:Label runat="server" ID="labelText" 
>     ie:Text="This is IE text" 
>     mozilla:Text="This is Firefox text" 
>     Text="This is general text" 
> /> 
> ```

这让我有点意外。

* * *

## 回答 #19

> 赞同：26
> 
> 时间：2008-10-10T14:14:19.477

[System.Web.VirtualPathUtility](http://msdn.microsoft.com/en-us/library/system.web.virtualpathutility_methods.aspx)

* * *

## 回答 #20

> 赞同：26
> 
> 时间：2008-12-21T21:22:41.353

我在一个 asp.net 应用程序上工作，该应用程序通过了一家领先的安全公司的安全审计，我学会了这个简单的技巧来防止一个鲜为人知但重要的安全漏洞。

以下解释来自： [http ://www.guidanceshare.com/wiki/ASP.NET_2.0_Security_Guidelines_-_Parameter_Manipulation#Consider_Using_Page.ViewStateUserKey_to_Counter_One-Click_Attacks](http://www.guidanceshare.com/wiki/ASP.NET_2.0_Security_Guidelines_-_Parameter_Manipulation#Consider_Using_Page.ViewStateUserKey_to_Counter_One-Click_Attacks)

考虑使用 Page.ViewStateUserKey 来应对一键式攻击。如果您对调用者进行身份验证并使用 ViewState，请在 Page_Init 事件处理程序中设置 Page.ViewStateUserKey 属性以防止一键式攻击。

```
void Page_Init (object sender, EventArgs e) {
  ViewStateUserKey = Session.SessionID;
} 
```

将该属性设置为您知道每个用户唯一的值，例如会话 ID、用户名或用户标识符。

当攻击者创建的网页（.htm 或 .aspx）包含一个名为 __VIEWSTATE 的隐藏表单字段，该字段已被 ViewState 数据填充时，就会发生一键式攻击。ViewState 可以从攻击者之前创建的页面生成，例如包含 100 件商品的购物车页面。攻击者引诱毫无戒心的用户浏览页面，然后攻击者将页面发送到 ViewState 有效的服务器。服务器无法知道 ViewState 来自攻击者。ViewState 验证和 HMAC 不应对这种攻击，因为 ViewState 是有效的并且页面是在用户的安全上下文下执行的。

通过设置 ViewStateUserKey 属性，当攻击者浏览到一个页面来创建 ViewState 时，该属性被初始化为他或她的名字。当合法用户向服务器提交页面时，它会被初始化为攻击者的名字。因此，ViewState HMAC 检查失败并生成异常。

* * *

## 回答 #21

> 赞同：25
> 
> 时间：2008-10-07T02:54:18.053

[HttpContext.Current.IsDebuggingEnabled](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.isdebuggingenabled.aspx)

这对于确定要输出哪些脚本（最小版本或完整版本）或您在开发中可能想要的任何其他内容非常有用，但不是实时的。

* * *

## 回答 #22

> 赞同：20
> 
> 时间：2009-08-31T11:55:40.160

[面板中的DefaultButton](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton.aspx)属性。

它为特定面板设置默认按钮。

* * *

## 回答 #23

> 赞同：20
> 
> 时间：2008-09-16T18:03:26.530

包含在 ASP.NET 3.5 SP1 中：

*   customErrors 现在支持值为“ResponseRewrite”的“redirectMode”属性。显示错误页面而不更改 URL。
*   form 标签现在可以识别 action 属性。非常适合使用 URL 重写

* * *

## 回答 #24

> 赞同：19
> 
> 时间：2008-09-10T21:02:25.187

ScottGu 在[http://weblogs.asp.net/scottgu/archive/2006/04/03/441787.aspx有很多技巧](http://weblogs.asp.net/scottgu/archive/2006/04/03/441787.aspx)

* * *

## 回答 #25

> 赞同：19
> 
> 时间：2010-12-10T20:21:43.710

**使用 configSource 拆分配置文件。**

您可以使用 web.config 文件中的 configSource 属性将配置元素推送到其他 .config 文件，例如，而不是：

```
 <appSettings>
        <add key="webServiceURL" value="https://some/ws.url" />
        <!-- some more keys -->
    </appSettings> 
```

...您可以将整个 appSettings 部分存储在另一个配置文件中。这是新的`web.config`：

```
 <appSettings configSource="myAppSettings.config" /> 
```

`myAppSettings.config`文件：

```
 <appSettings>        
        <add key="webServiceURL" value="https://some/ws.url" />
        <!-- some more keys -->
    </appSettings> 
```

这对于您将应用程序部署到客户并且不希望他们干扰 web.config 文件本身并且只希望他们能够仅更改一些设置的情况非常有用。

参考：[http ://weblogs.asp.net/fmarguerie/archive/2007/04/26/using-configsource-to-split-configuration-files.aspx](http://weblogs.asp.net/fmarguerie/archive/2007/04/26/using-configsource-to-split-configuration-files.aspx)

* * *

## 回答 #26

> 赞同：17
> 
> 时间：2009-08-31T11:59:39.513

[Page 指令中的MaintainScrollPositionOnPostback](http://msdn.microsoft.com/en-us/library/system.web.ui.page.maintainscrollpositiononpostback.aspx)属性。它用于在回发中保持 aspx 页面的滚动位置。

* * *

## 回答 #27

> 赞同：16
> 
> 时间：2008-09-10T18:34:27.303

HttpContext.IsCustomErrorEnabled 是一个很酷的功能。我发现它不止一次有用。这是一篇关于它的[简短文章](http://weblogs.asp.net/leftslipper/archive/2008/07/13/httpcontext-iscustomerrorenabled-one-of-asp-net-s-hidden-gems.aspx)。

* * *

## 回答 #28

> 赞同：16
> 
> 时间：2008-09-10T20:35:19.667

默认情况下，自定义控件的标签之间的任何内容都作为子控件添加。这可以在**AddParsedSubObject()**覆盖中被截获以进行过滤或附加解析（例如，LiteralControls 中的文本内容）：

```
 protected override void AddParsedSubObject(object obj)
     { var literal = obj as LiteralControl;
       if (literal != null) Controls.Add(parseControl(literal.Text));
       else base.AddParsedSubObject(obj);
     } 
```

...

```
 <uc:MyControl runat='server'>
     ...this text is parsed as a LiteralControl...
  </uc:MyControl> 
```

* * *

## 回答 #29

> 赞同：13
> 
> 时间：2008-09-10T21:19:18.967

如果您让 ASP.NET 生成 RSS 提要，它有时会在页面顶部添加一行。这不会使用常见的 RSS 验证器进行验证。您可以通过将 page 指令放在页面`<@Page>`底部来解决它。

* * *

## 回答 #30

> 赞同：12
> 
> 时间：2008-09-14T03:27:38.697

在 ASP.NET v3.5 添加路由之前，您可以创建自己的友好 URL，只需在页面管道的早期写入 HTTPModule 并重写请求（如 BeginRequest 事件）。

像[http://servername/page/Param1/SomeParams1/Param2/SomeParams2](http://servername/page/Param1/SomeParams1/Param2/SomeParams2)这样的 URL会被映射到像下面这样的另一个页面（通常使用正则表达式）。

```
HttpContext.RewritePath("PageHandler.aspx?Param1=SomeParms1&Param2=SomeParams2"); 
```

DotNetNuke 有一个非常好的 HttpModule 可以为他们友好的 url 做到这一点。对于无法部署 .NET v3.5 的机器仍然有用。

* * *

## 回答 #31

> 赞同：12
> 
> 时间：2009-07-01T15:20:37.903

我的团队经常使用它作为 hack：

```
WebRequest myRequest = WebRequest.Create("http://www.google.com");
WebResponse myResponse = myRequest.GetResponse();
StreamReader sr = new StreamReader(myResponse.GetResponseStream());

// here's page's response loaded into a string for further use

String thisReturn = sr.ReadToEnd().Trim(); 
```

它将网页的响应加载为字符串。您也可以发送帖子参数。

当我们需要便宜又快速的东西时，我们会使用它来代替 ASCX/AJAX/WebServices。基本上，它是一种跨服务器访问 Web 可用内容的快速方法。事实上，我们昨天刚刚称它为“Redneck Web Service”。

* * *

## 回答 #32

> 赞同：11
> 
> 时间：2010-01-26T08:10:20.533

您知道可以在 IIS 或 Visual Studio 之外运行 ASP.Net 吗？

整个运行时已打包并准备好托管在任何想要尝试它的进程中。使用`ApplicationHost`,`HttpRuntime`和`HttpApplication`类，您也可以打磨这些 .aspx 页面并从中获得闪亮的 HTML 输出。

```
HostingClass host = ApplicationHost.CreateApplicationHost(typeof(HostingClass), 
                                            "/virtualpath", "physicalPath");
host.ProcessPage(urlToAspxFile); 
```

还有你的托管班：

```
public class HostingClass : MarshalByRefObject
{
    public void ProcessPage(string url)
    {
        using (StreamWriter sw = new StreamWriter("C:\temp.html"))
        {
            SimpleWorkerRequest worker = new SimpleWorkerRequest(url, null, sw);
            HttpRuntime.ProcessRequest(worker);
        }
                    // Ta-dah!  C:\temp.html has some html for you.
    }
} 
```

* * *

## 回答 #33

> 赞同：10
> 
> 时间：2011-01-25T18:44:07.100

[CompilationMode="Never"](http://www.webpronews.com/expertarticles/2006/11/06/using-the-compilationmode-attribute-to-boost-performance)是一项在某些 ASP.NET 站点中可能至关重要的功能。

如果您的 ASP.NET 应用程序经常通过 CMS 或其他发布系统生成和更新 ASPX 页面，则使用 CompilationMode="Never" 很重要。

如果没有此设置，ASPX 文件更改将触发重新编译，这将快速使您的 appdomain 重新启动。这可以清除会话状态和 httpruntime 缓存，更不用说重新编译造成的延迟。

（为了防止重新编译，您*可以*增加[numRecompilesBeforeAppRestart](http://msdn.microsoft.com/en-us/library/s10awwz0.aspx)设置，但这并不理想，因为它会消耗更多内存。）

对此功能的一个警告是 ASPX 页面不能包含任何代码块。为了解决这个问题，可以将代码放在自定义控件和/或基类中。

在 ASPX 页面不经常更改的情况下，此功能几乎无关紧要。

* * *

## 回答 #34

> 赞同：9
> 
> 时间：2009-06-12T21:46:51.590

我想到了一个功能，有时您需要向爬虫隐藏页面的某些部分。您可以使用**javascript**或使用以下简单代码来完成：

```
if (Request.Browser.Crawler){
        HideArticleComments(); 
```

* * *

## 回答 #35

> 赞同：9
> 
> 时间：2008-10-11T14:50:37.030

VS 阻塞的有效语法：

```
<input type="checkbox" name="roles" value='<%# Eval("Name") %>' 
  <%# ((bool) Eval("InRole")) ? "checked" : "" %> 
  <%# ViewData.Model.IsInRole("Admin") ? "" : "disabled" %> /> 
```

* * *

## 回答 #36

> 赞同：9
> 
> 时间：2009-02-22T00:33:52.033

[System.Web.Hosting.HostingEnvironment.MapPath](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.mappath.aspx)

* * *

## 回答 #37

> 赞同：8
> 
> 时间：2009-11-27T22:59:22.150

**与 optimizeCompilations=”true” 解决方案类似，这里还有一个可以加快您在构建之间等待的时间**（非常好，尤其是在您处理大型项目时）： **创建一个基于 ram 的驱动器（即使用 RamDisk）和将您的默认“临时 ASP.NET 文件”更改为此基于内存的驱动器。**

如何做到这一点的完整细节在我的博客上：[http ://www.wagnerdanda.me/2009/11/speeding-up-build-times-in-asp-net-with-ramdisk/](http://www.wagnerdanda.me/2009/11/speeding-up-build-times-in-asp-net-with-ramdisk/)

基本上你首先配置一个 RamDisk（同样，在我的博客中有一个免费 ramdisk 的链接），然后你根据这个更改你的 web.config：

```
 <system.web>
 ....
     <compilation debug="true" tempDirectory="R:\ASP_NET_TempFiles\">
     ....
     </compilation>
 ....
 </system.web> 
```

它大大增加了我的开发时间，你只需要为你的电脑投资内存:)

快乐编程！

瓦格纳丹达

* * *

## 回答 #38

> 赞同：7
> 
> 时间：2009-08-31T05:44:28.613

**[Request.IsLocal 属性：](http://msdn.microsoft.com/en-us/library/system.web.httprequest.islocal.aspx)**

它指示当前请求是否来自本地计算机。

```
if( Request.IsLocal )
{
   LoadLocalAdminMailSettings();
}
else
{
   LoadServerAdminMailSettings();
} 
```

* * *

## 回答 #39

> 赞同：7
> 
> 时间：2008-09-10T21:25:13.353

当我将 xmlDocument() 转储到标签中并使用它的 xsl 转换显示时，我认为它很整洁。

* * *

## 回答 #40

> 赞同：6
> 
> 时间：2011-09-27T19:26:13.993

默认情况下，任何 Web 表单页面都继承自`System.Web.UI.Page`类。如果您希望您的页面从继承自的自定义基类继承`System.Web.UI.Page`怎么办？

有一种方法可以限制任何页面从您自己的基类继承。`web.config`只需在您的:上添加一个新行

```
<system.web>
    <pages pageBaseType="MyBasePageClass" />
</system.web> 
```

注意：这仅在您的班级是独立班级时才有效。我的意思是一个没有代码隐藏的类，看起来像`<%@ Page Language="C#" AutoEventWireup="true" %>`

* * *

## 回答 #41

> 赞同：5
> 
> 时间：2008-09-23T20:47:44.853

将位于 App_Code 文件夹中的类附加到全局应用程序类文件。

[ASP.NET 2.0-Global.asax-代码隐藏文件](http://aspadvice.com/blogs/kiran/archive/2005/12/11/14301.aspx)。

这也适用于 Visual Studio 2008。

* * *

## 回答 #42

> 赞同：5
> 
> 时间：2009-06-16T10:10:20.130

[EnsureChildControls 方法](http://msdn.microsoft.com/en-us/library/system.web.ui.control.ensurechildcontrols.aspx)：它检查子控件是否已启动。如果子控件未启动，则调用 CreateChildControls 方法。

* * *

## 回答 #43

> 赞同：4
> 
> 时间：2008-10-04T10:27:02.197

您可以使用其[UniqueID](http://msdn.microsoft.com/en-us/library/system.web.ui.control.uniqueid.aspx)属性找到任何控件：

```
Label label = (Label)Page.FindControl("UserControl1$Label1"); 
```

* * *

## 回答 #44

> 赞同：4
> 
> 时间：2010-06-09T02:23:10.780

很多人提到如何在重新编译时优化代码。最近我发现我可以在 aspx 页面中完成大部分开发（代码隐藏的东西）并完全跳过构建步骤。只需保存文件并刷新您的页面。您所要做的就是将您的代码包装在以下标签中：

```
<script runat="server">

   Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
     Response.Write("Look Ma', I didn't even had to build!")
   End Sub

</script> 
```

完成后，只需将所有内容移至代码隐藏，构建，测试一切正常，瞧！

-D

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2010-12-27T03:57:18.010

web.config 中 appsettings 元素上[的“文件”属性。](http://msdn.microsoft.com/en-us/library/ms228154.aspx)

*指定包含自定义应用程序配置设置的外部文件的相对路径。*

如果您在许多需要在不同环境（产品）上修改的应用程序设置中只有很少的应用程序设置，那么这是一个很好的选择。

*由于对 Web.config 文件的任何更改都会导致应用程序重新启动，因此使用单独的文件允许用户修改 appSettings 部分中的值，而不会导致应用程序重新启动。单独文件的内容与 Web.config 文件中的 appSettings 部分合并。*

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2010-03-24T19:01:04.157

如果您使用 Web 服务而不是 WCF 服务，您仍然可以使用标准的 .Net 成员身份在一组 Web 服务上强制执行身份验证和登录会话行为，类似于使用成员身份表单身份验证保护网站的方式，并且无需特殊会话和/或soap头实现，只需调用 System.Web.Security.FormsAuthentication.SetAuthCookie(userName, false) [当然在调用 Membership.ValidateUser(userName, password) 之后] 在响应中创建 cookie，就好像用户已经登录一样通过网络表格。然后，您可以使用 Response.Cookies[].Value 检索此身份验证 cookie，并将其作为字符串返回给用户，通过提取
cookie 方法从 Request.InputStream 调用参数，并在成员身份验证请求之前重新创建 auth cookie，这样成员身份提供者就会被欺骗，并且会知道请求已通过身份验证并强制执行其所有规则。

将此 cookie 返回给用户的示例 Web 方法签名将是：string Login(userName,password)

示例后续 Web 方法调用将是： string DoSomething(string authcookie,string methodParam1,int methodParam2 etc,etc) 您需要从 Request.InputStreamis 中提取 authcookie（这是从 Login 方法获得的值）参数

这也模拟了登录会话，并在这样的 Web 方法中调用 FormsAuthentication.SignOut Logout(authcookie) 会使用户需要再次登录。

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2009-02-05T08:40:17.690

[Page 对象上的ClientScript](http://msdn.microsoft.com/en-us/library/3hc29e2a.aspx)属性。

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2010-12-14T12:04:24.783

Application variables can be used with web application for communicating across the whole application. It is initialized in Global.asax file and used over the pages in that web application by all the user independent of the session they create.

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2011-06-22T04:36:24.283

可以将 ASPX 页面打包到库 (.dll) 中，并使用 ASP.NET 引擎为它们提供服务。

您将需要实现自己的[VirtualPathProvider](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx)，它将通过 Relfection 特定的 DLL 加载，或者您可以在路径名中包含 DLL 名称。由你决定。

当重写[VirtualFile.Open](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualfile.open.aspx)方法时会发生神奇的事情，在该方法中，您将 ASPX 文件作为来自 Assembly 类的资源返回：[Assembly.GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/xc4235zt.aspx)。ASP.NET 引擎将处理资源，因为它是通过 VirtualPathProvider 提供的。

这允许插件页面，或者像我一样，使用它来包含一个带有控件的 HttpHandler。

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2011-12-11T02:08:50.460

[模板化的用户控件](http://msdn.microsoft.com/en-us/library/36574bf6%28v=VS.100%29.aspx)。一旦你知道它们是如何工作的，你就会看到各种各样的可能性。这是最简单的实现：

**模板控件.ascx**

这里的好处是使用简单而熟悉的用户控件构建块，并且能够使用 HTML 和一些占位符来布局 UI 的不同部分。

```
<%@ Control Language="C#" CodeFile="TemplatedControl.ascx.cs" Inherits="TemplatedControl" %>

<div class="header">
    <asp:PlaceHolder ID="HeaderPlaceHolder" runat="server" />
</div>
<div class="body">
    <asp:PlaceHolder ID="BodyPlaceHolder" runat="server" />
</div> 
```

**模板控制.ascx.cs**

这里的“秘密”是使用类型的公共属性`ITemplate`并了解[`[ParseChildren]`](http://msdn.microsoft.com/en-us/library/system.web.ui.parsechildrenattribute.aspx)and[`[PersistenceMode]`](http://msdn.microsoft.com/en-us/library/system.web.ui.persistencemodeattribute.aspx)属性。

```
using System.Web.UI;

[ParseChildren(true)]
public partial class TemplatedControl : System.Web.UI.UserControl
{
    [PersistenceMode(PersistenceMode.InnerProperty)]
    public ITemplate Header { get; set; }

    [PersistenceMode(PersistenceMode.InnerProperty)]
    public ITemplate Body { get; set; }

    void Page_Init()
    {
        if (Header != null)
            Header.InstantiateIn(HeaderPlaceHolder);

        if (Body != null)
            Body.InstantiateIn(BodyPlaceHolder);
    }
} 
```

**默认.aspx**

```
<%@ Register TagPrefix="uc" TagName="TemplatedControl" Src="TemplatedControl.ascx" %>

<uc:TemplatedControl runat="server">
    <Header>Lorem ipsum</Header>
    <Body>
        // You can add literal text, HTML and server controls to the templates
        <p>Hello <asp:Label runat="server" Text="world" />!</p>
    </Body>
</uc:TemplatedControl> 
```

您甚至可以获得内部模板属性的 IntelliSense。因此，如果您在一个团队中工作，您可以快速创建可重用的 UI，以实现您的团队已经从内置 ASP.NET 服务器控件中获得的相同可组合性。

[MSDN 示例](http://msdn.microsoft.com/en-us/library/36574bf6.aspx)（与开头的链接相同）添加了一些额外的控件和命名容器，但只有在您想要支持“中继器类型”控件时才需要这样做。

* * *

## 回答 #51

> 赞同：-3
> 
> 时间：2010-06-10T05:32:12.840

我使用的与 VB、VBScript 和 VB.NET 的多个版本一起使用的方法之一是将记录集值转换为字符串，以消除对 NULL 或空白的多重测试。即`Trim(rsData("FieldName").Value & " ")`
在整数值的情况下，这将是：`CLng("0" & Trim(rsData("FieldName").Value & " "))`

* * *

## 回答 #52

> 赞同：-6
> 
> 时间：2010-07-02T07:11:52.620

网站发布并部署到生产服务器后，如果我们需要对服务器端的按钮点击事件做一些修改。`new`我们可以通过使用aspx 页面本身的关键字来覆盖现有的点击事件。

例子

**方法背后的代码**

```
 Protected void button_click(sender object, e System.EventArgs) 
  {
     Response.Write("Look Ma', I Am code behind code!")  
  } 
```

**重写方法：**

```
<script runat="server">   
   Protected void new button_click(sender object, e System.EventArgs) 
  {
     Response.Write("Look Ma', I am overrided method!")  
  }

</script 
```

通过这种方式，我们可以轻松修复生产服务器错误，而无需重新部署。

* * *

## 回答 #53

> 赞同：-6
> 
> 时间：2008-09-10T18:21:56.617

这似乎是一个巨大的、模糊的问题……但我会提出反射，因为它允许我做一些非常强大的事情，比如可插拔 DAL 等。

# unit-testing - 我如何知道何时使用基于状态的测试和模拟测试？

> ID：54943
> 
> 赞同：4
> 
> 时间：2008-09-10T18:27:38.897
> 
> 标签：unit-testing

与使用模拟对象相比，哪些场景、应用程序/系统的区域等最适合基于“经典”状态的测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T08:10:54.150

我将从 TDD/BDD 的角度来解决它，测试驱动设计。

首先，这取决于您购买的设计风格，因为请记住这是关于设计的第一。正如 Martin Fowler 在这篇出色的文章[Mocks Aren't Stubs](http://www.martinfowler.com/articles/mocksArentStubs.html)中所讨论的，有两种思想流派，它们确实产生了不同类型的设计。

如果你想接受 mockist 方法，那么我强烈建议你从[mockobjects 网站](http://mockobjects.com/)和他们的文章[Mock Roles, Not Objects](http://www.mockobjects.com/book/index.html)开始。他们还出版了一[本书](http://www.mockobjects.com/book/index.html)。

事实是，即使您确实认为 mock-first 设计风格不适合您，或者您不想直接通过您的应用程序（例如，不是在测试您的域/服务层时），那么您仍然会想使用测试替身。[xUnit 测试模式](http://xunitpatterns.com/)解释了不同类型的测试替身及其用途。

就我个人而言，我从不模拟域类，所以从不模拟[实体/值对象](http://jbrains.ca/permalink/90). 然而我最近一直在尝试模拟对象风格的方法，它确实改变了我的设计，我觉得工作风格很舒服。在 MVC 应用程序中以这种风格工作我可能会从一个自动化的验收测试开始，然后我将编写一个模拟任何非域对象（例如存储库/服务）的控制器测试，然后我将继续进行测试这些存储库/服务再次模拟了它们的依赖关系。当我到达一个没有麻烦依赖关系的类（例如域实体/值对象）时，我会停下来。我可以继续测试特定的角色接口，然后由我的域类实现，这是 mockobjects 家伙推荐的，但我目前没有看到这种方法有很多价值。

显然值得补充的是，测试设计在这里很重要，但请记住，尽管 90% 的 IoC/mocking/DIP 示例显示[接口-实现对](http://martinfowler.com/bliki/InterfaceImplementationPair.html)（ICustomerRepository/CustomerRepository），但寻找[角色接口](http://martinfowler.com/bliki/RoleInterface.html)有很多价值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T18:29:10.450

您应该对依赖项使用模拟。我不认为这是非此即彼的；通常，您将为依赖项创建模拟，对它们设置期望（无论是调用还是状态），然后运行被测单元。然后你会检查它的状态，然后验证对模拟的期望。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T18:39:09.773

使用模拟对象并不意味着您没有进行基于状态的测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-19T16:23:33.940

在使用服务时，无论是我自己的还是第三方的，我理所当然地设计接口，所以我倾向于关注那里的交互。这鼓励我设计最小的界面。

我检查任何关注值对象的状态，就像简单的计算、查找等。

下次您发现自己设计的东西通常遵循模型/视图/控制器或演示者时，我强烈建议您尝试使用模型和视图接口的演示者优先方法（谷歌搜索）。这将使您对如何有效地使用存根/模拟有一个很好的感觉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T19:26:23.637

它的风格问题.. Mockist vs Classic TDDers。
就个人而言..我会尽可能地测试真实的课程。尽可能淡化 Mocks；仅用于解耦诸如 IO（文件系统、数据库连接、网络）、第三方组件等缓慢/难以测试的事物。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-11T22:38:05.400

作为一名经验丰富的 TDD'er，这是我经常被其他开发人员问到的问题。对我来说，卷入 Mockist 与 Classicist 的辩论是错误的，因为这样的讨论具有误导性。基于状态和基于行为的单元测试是您工具箱中的两种不同工具，它们没有理由相互排斥。

当您想在与对象的外部接口交谈后查询对象的内部属性时，基于状态的单元测试是合适的。如果它的一个或多个协作者涉及对其他对象的潜在昂贵调用，那么无论如何都要存根这些调用并简单地忽略协作者。

当您想要考虑单元测试的“如何”并专注于发现对象之间的关系时，基于行为的单元测试是一个好主意，而不是基于状态的单元测试的传统“什么”问题。如果您希望断言以某种方式和/或顺序使用协作者，请使用模拟 - 提供断言的存根。

我建议您专注于标准单元测试实践——尽可能少地使用生产代码，并且每次测试都有*一个*断言。这将迫使你思考“我想在这个测试中练习和断言的究竟是什么？”，这个问题的答案将帮助你选择正确的单元测试工具。

# java - Java、UTF-8 和 Windows 控制台

> ID：54952
> 
> 赞同：14
> 
> 时间：2008-09-10T18:30:55.253
> 
> 标签：java, windows, utf-8, console

我们尝试在 Windows 上使用 Java 和 UTF-8。应用程序在控制台上写入日志，我们希望将 UTF-8 用于日志，因为我们的应用程序具有国际化日志。

可以配置 JVM，使其生成 UTF-8，`-Dfile.encoding=UTF-8`用作 JVM 的参数。它工作正常，但 Windows 控制台上的输出是乱码。

然后，我们可以将控制台的代码页设置为 65001 ( `chcp 65001`)，但在这种情况下，`.bat`文件不起作用。这意味着当我们尝试通过我们的脚本（名为 start.bat）启动我们的应用程序时，绝对没有任何反应。命令简单返回：

```
C:\Application> chcp 65001
Activated code page: 65001
C:\Application> start.bat

C:\Application> 
```

但是没有`chcp 65001`，就没有问题，可以启动应用程序。

有什么提示吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T20:55:48.570

尝试`chcp 65001 && start.bat`

该`chcp`命令更改代码页，65001 是 Windows 7 及更高版本下 UTF-8 的 Win32 代码页标识符。代码页或字符编码指定如何将 Unicode 代码点转换为字节序列或再次转换回来。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-01-19T05:35:31.453

Windows 上的 Java 默认不支持 unicode 输出。我通过使用 JNA 库调用 Native API 编写了一个解决方法。该方法将调用 WriteConsoleW 以在控制台上输出 unicode。

```
import com.sun.jna.Native;
import com.sun.jna.Pointer;
import com.sun.jna.ptr.IntByReference;
import com.sun.jna.win32.StdCallLibrary;

/** For unicode output on windows platform
 * @author Sandy_Yin
 * 
 */
public class Console {
    private static Kernel32 INSTANCE = null;

    public interface Kernel32 extends StdCallLibrary {
        public Pointer GetStdHandle(int nStdHandle);

        public boolean WriteConsoleW(Pointer hConsoleOutput, char[] lpBuffer,
                int nNumberOfCharsToWrite,
                IntByReference lpNumberOfCharsWritten, Pointer lpReserved);
    }

    static {
        String os = System.getProperty("os.name").toLowerCase();
        if (os.startsWith("win")) {
            INSTANCE = (Kernel32) Native
                    .loadLibrary("kernel32", Kernel32.class);
        }
    }

    public static void println(String message) {
        boolean successful = false;
        if (INSTANCE != null) {
            Pointer handle = INSTANCE.GetStdHandle(-11);
            char[] buffer = message.toCharArray();
            IntByReference lpNumberOfCharsWritten = new IntByReference();
            successful = INSTANCE.WriteConsoleW(handle, buffer, buffer.length,
                    lpNumberOfCharsWritten, null);
            if(successful){
                System.out.println();
            }
        }
        if (!successful) {
            System.out.println(message);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:32:56.770

我们在 Linux 中遇到了一些类似的问题。我们的代码采用 ISO-8859-1（大部分与 cp-1252 兼容），但控制台是 UTF-8，导致代码无法编译。只需将控制台更改为 ISO-8859-1 就会使 UTF-8 中的构建脚本中断。我们找到了几个选择：
1- 定义一些标准编码并坚持下去。那是我们的选择。我们选择将所有内容保留在 ISO-8859-1 中，修改构建脚本。
2- 在开始任何任务之前设置编码，即使在构建脚本中也是如此。像埃里克森所说的一些代码。在 Linux 中就像：

```
lang=pt_BR.ISO-8859-1 /usr/local/xxxx 
```

我的eclipse还是这样。两者都运作良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-30T13:01:32.300

Windows 不支持 65001 代码页：[http ://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/chcp.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/chcp.mspx?mfr=true)

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-09-10T20:36:51.657

您是否尝试过[PowerShell](http://en.wikipedia.org/wiki/PowerShell)而不是旧的 cmd.exe。

# xml - 计算与 XmlSpy 中给定 XPath 表达式匹配的节点数

> ID：54953
> 
> 赞同：4
> 
> 时间：2008-09-10T18:31:37.870
> 
> 标签：xml, xpath, xmlspy

我正在使用 XmlSpy 分析 xml 文件，并且我想快速计算与给定 xpath 匹配的节点数。我知道如何输入 XPath 并获取节点列表，但我真的只是对计数感兴趣。有可能得到这个吗？

我正在使用 XmlSpy 专业版 2007 sp2，如果重要的话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T18:50:34.580

我刚刚想通了。我只需要将 count() 放在我的 xpath 周围，如下所示：

```
count(//my/node) 
```

# postgresql - 什么是准备好的陈述？

> ID：54955
> 
> 赞同：3
> 
> 时间：2008-09-10T18:32:18.540
> 
> 标签：postgresql

我在 postgres pg_log 目录中的 .log 文件中看到一堆行，内容如下：

> 错误：准备好的语句“pdo_pgsql_stmt_09e097f4”不存在

什么是准备好的语句，什么样的事情会导致显示这些错误消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T18:37:08.093

从[文档中](http://www.postgresql.org/docs/8.1/interactive/sql-prepare.html)：

> 准备好的语句是可用于优化性能的服务器端对象。当 PREPARE 语句被执行时，sp​​ecifie 语句被解析、重写和计划。当随后发出 EXECUTE 命令时，只需要执行准备好的语句。因此，解析、重写和计划阶段只执行一次，而不是每次执行语句。

在网上搜索，我发现“pdo_pgsql_stmt”命令来自某种 PHP 连接到您的数据库。也许[这个链接](http://www.phpbuilder.com/manual/en/ref.pdo-pgsql.php)可以帮助您找到一个合适的邮件列表或问题跟踪器，您可以将您的错误消息发送到？

* * *

编辑：我想我在这里找到了你的错误：

[http://bugs.php.net/bug.php?id=37870](http://bugs.php.net/bug.php?id=37870)

# data-visualization - 什么是数据可视化的好平台（环境/语言/可重用组件）？

> ID：54957
> 
> 赞同：3
> 
> 时间：2008-09-10T18:33:08.740
> 
> 标签：data-visualization

我有很多不同结构的数据。除了 Excel 图表，还有什么更好的平台可以帮助我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T23:21:31.057

[http://services.alphaworks.ibm.com/manyeyes/browse/visualizations](http://services.alphaworks.ibm.com/manyeyes/browse/visualizations)

在这里您可以上传数据集并获得不同的在线可视化，您的数据将很难公开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T18:35:00.907

[谷歌图表](http://code.google.com/apis/chart/)呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T02:38:46.610

## 一个起点

目前，数据可视化领域正在迅速发展。Microsoft Excel 等传统工具链通过强大的可视化解决方案得到增强，这是上一波 ERP 带来的仪表板热潮的一部分。我们现在更加宠坏了，因为编程社区已经加入了传统的分析来探索 java、javascript 和任何你能想到的语言。

使用开源和基于云的解决方案，故事会变得更好。跟上是一项艰苦的工作，但我在最近一轮的研究中发现了一些很好的起点。如果您花一个晚上花几分钟时间使用这篇出色的计算机世界文章中列出的每个工具，您肯定会找到一个立即吸引您的偏好和技能的工具。

[22 个免费的数据可视化和分析工具](http://www.computerworld.com/s/article/9215504/22_free_tools_for_data_visualization_and_analysis)

如果坐下来有点难以消化，请先浏览[一下方便的图表](http://www.computerworld.com/s/article/9214755/Chart_and_image_gallery_30_free_tools_for_data_visualization_and_analysis)，以大致了解其中的一些内容。

## 奖金

不在该列表中的一个很棒的是[d3.js](http://mbostock.github.com/d3/)，它是当前维护的 protovis 项目的继任者，我相信它不再活跃。[你可以在github](http://mbostock.github.com/d3/)上找到 d3.js ，这再次表明我们是多么幸运能够在开源这些强大的可视化解决方案方面付出如此巨大的努力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-08T02:31:56.200

取决于您的目标是什么以及您愿意获得的技术水平。

[Incanter](http://incanter.org/)是一个很棒的工具集，我可以衷心推荐（我在自己的项目中使用它来进行可视化）。它是 Clojure 的统计计算和可视化库——它又是一种非常灵活和动态的语言，非常适合交互式实验。

我特别喜欢用于创建图表的 DSL，例如，从正态分布中创建 1000 个样本的直方图，您可以这样做：

```
(view (histogram (sample-normal 1000))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T00:21:38.010

看看[R](http://www.r-project.org/)的故事。它拥有强大的社区和生态系统。如果您喜欢从控制台工作，您可能会喜欢从 CSV 到各种数据可视化是多么容易。

我发现[Code School的这个](http://www.codeschool.com/)[交互式教程](http://tryr.codeschool.com/)对入门非常有帮助。

# c# - 您将如何重构此 LINQ 代码？

> ID：54963
> 
> 赞同：2
> 
> 时间：2008-09-10T18:34:57.973
> 
> 标签：c#, .net, linq, linq-to-sql

我有很多看起来像这样的丑陋代码：

```
if (!string.IsNullOrEmpty(ddlFileName.SelectedItem.Text))
    results = results.Where(x => x.FileName.Contains(ddlFileName.SelectedValue));
if (chkFileName.Checked)
    results = results.Where(x => x.FileName == null);

if (!string.IsNullOrEmpty(ddlIPAddress.SelectedItem.Text))
    results = results.Where(x => x.IpAddress.Contains(ddlIPAddress.SelectedValue));
if (chkIPAddress.Checked)
    results = results.Where(x => x.IpAddress == null);

...etc. 
```

`results`是一个`IQueryable<MyObject>`。
这个想法是，对于这些无数下拉列表和复选框中的每一个，如果下拉列表中选择了某些内容，则用户希望匹配该项目。如果选中该复选框，则用户特别想要该字段为空或空字符串的那些记录。（UI 不允许同时选择两者。）这一切都添加到 LINQ 表达式中，在我们添加了所有条件之后，该表达式将在最后执行。

似乎应该有某种方法可以抽出一两个，以便我可以将重复的部分放入一个方法中，然后传递更改的内容*。*`Expression<Func<MyObject, bool>>`我在其他地方做过这个，但是这组代码让我受阻。（另外，我想避免“动态 LINQ”，因为如果可能的话，我想保持类型安全。）有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T19:13:48.627

我会将其转换为单个 Linq 语句：

```
var results =
    //get your inital results
    from x in GetInitialResults()
    //either we don't need to check, or the check passes
    where string.IsNullOrEmpty(ddlFileName.SelectedItem.Text) ||
       x.FileName.Contains(ddlFileName.SelectedValue)
    where !chkFileName.Checked ||
       string.IsNullOrEmpty(x.FileName)
    where string.IsNullOrEmpty(ddlIPAddress.SelectedItem.Text) ||
       x.FileName.Contains(ddlIPAddress.SelectedValue)
    where !chkIPAddress.Checked ||
       string.IsNullOrEmpty(x. IpAddress)
    select x; 
```

它并不短，但我发现这个逻辑更清晰。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-11T07:35:45.240

在这种情况下：

```
//list of predicate functions to check
var conditions = new List<Predicate<MyClass>> 
{
    x => string.IsNullOrEmpty(ddlFileName.SelectedItem.Text) ||
         x.FileName.Contains(ddlFileName.SelectedValue),
    x => !chkFileName.Checked ||
         string.IsNullOrEmpty(x.FileName),
    x => string.IsNullOrEmpty(ddlIPAddress.SelectedItem.Text) ||
         x.IpAddress.Contains(ddlIPAddress.SelectedValue),
    x => !chkIPAddress.Checked ||
         string.IsNullOrEmpty(x.IpAddress)
}

//now get results
var results =
    from x in GetInitialResults()
    //all the condition functions need checking against x
    where conditions.All( cond => cond(x) )
    select x; 
```

我刚刚明确声明了谓词列表，但可以生成这些，例如：

```
ListBoxControl lbc;
CheckBoxControl cbc;
foreach( Control c in this.Controls)
    if( (lbc = c as ListBoxControl ) != null )
         conditions.Add( ... );
    else if ( (cbc = c as CheckBoxControl ) != null )
         conditions.Add( ... ); 
```

您需要某种方法来检查您需要检查的 MyClass 的属性，为此您必须使用反射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T01:18:27.320

如果它影响可读性，请不要使用 LINQ。将各个测试分解为布尔方法，可用作您的 where 表达式。

```
IQueryable<MyObject> results = ...;

results = results
    .Where(TestFileNameText)
    .Where(TestFileNameChecked)
    .Where(TestIPAddressText)
    .Where(TestIPAddressChecked); 
```

因此，单个测试是类上的简单方法。它们甚至可以单独进行单元测试。

```
bool TestFileNameText(MyObject x)
{
    return string.IsNullOrEmpty(ddlFileName.SelectedItem.Text) ||
           x.FileName.Contains(ddlFileName.SelectedValue);
}

bool TestIPAddressChecked(MyObject x)
{
    return !chkIPAddress.Checked ||
        x.IpAddress == null;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-11T08:20:44.400

你见过[LINQKit](http://www.albahari.com/nutshell/linqkit.html)吗？AsExpandable 听起来像您所追求的（尽管您可能想阅读TomasP.NET 的[LINQ 查询](http://tomasp.net/blog/linq-expand.aspx)中的调用函数以获得更深入的了解）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T00:37:55.420

您可能会考虑的一件事是通过消除复选框并在下拉列表中使用“ `<empty>`”或“ ”项来简化 UI。`<null>`这将减少占用窗口空间的控件数量，消除对复杂的“仅在未选中 Y 时启用 X”逻辑的需要，并且将启用一个很好的每个查询字段一个控件。

继续您的结果查询逻辑，我将首先创建一个简单的对象来表示您的域对象上的过滤器：

```
interface IDomainObjectFilter {
  bool ShouldInclude( DomainObject o, string target );
} 
```

您可以将过滤器的适当实例与您的每个 UI 控件相关联，然后在用户启动查询时检索它：

```
sealed class FileNameFilter : IDomainObjectFilter {
  public bool ShouldInclude( DomainObject o, string target ) {
    return string.IsNullOrEmpty( target )
        || o.FileName.Contains( target );
  }
}

...
ddlFileName.Tag = new FileNameFilter( ); 
```

然后，您可以通过简单地枚举控件并执行关联的过滤器来概括您的结果过滤（感谢[hurst](https://stackoverflow.com/questions/54963/how-would-you-refactor-this-linq-code#132157)的聚合想法）：

```
var finalResults = ddlControls.Aggregate( initialResults, ( c, r ) => {
  var filter = c.Tag as IDomainObjectFilter;
  var target = c.SelectedValue;
  return r.Where( o => filter.ShouldInclude( o, target ) );
} ); 
```

由于您的查询非常常规，您可以通过使用带有成员选择器的单个过滤器类来进一步简化实现：

```
sealed class DomainObjectFilter {
  private readonly Func<DomainObject,string> memberSelector_;
  public DomainObjectFilter( Func<DomainObject,string> memberSelector ) {
    this.memberSelector_ = memberSelector;
  }

  public bool ShouldInclude( DomainObject o, string target ) {
    string member = this.memberSelector_( o );
    return string.IsNullOrEmpty( target )
        || member.Contains( target );
  }
}

...
ddlFileName.Tag = new DomainObjectFilter( o => o.FileName ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T18:41:32.450

```
results = results.Where(x => 
    (string.IsNullOrEmpty(ddlFileName.SelectedItem.Text) || x.FileName.Contains(ddlFileName.SelectedValue))
    && (!chkFileName.Checked || string.IsNullOrEmpty(x.FileName))
    && ...); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T22:37:06.580

到目前为止，这些答案都不是我想要的。为了举例说明我的目标（我也不认为这是一个完整的答案），我采用了上面的代码并创建了几个扩展方法：

```
static public IQueryable<Activity> AddCondition(
    this IQueryable<Activity> results,
    DropDownList ddl, 
    Expression<Func<Activity, bool>> containsCondition)
{
    if (!string.IsNullOrEmpty(ddl.SelectedItem.Text))
        results = results.Where(containsCondition);
    return results;
}
static public IQueryable<Activity> AddCondition(
    this IQueryable<Activity> results,
    CheckBox chk, 
    Expression<Func<Activity, bool>> emptyCondition)
{
    if (chk.Checked)
        results = results.Where(emptyCondition);
    return results;
} 
```

这使我可以将上面的代码重构为：

```
results = results.AddCondition(ddlFileName, x => x.FileName.Contains(ddlFileName.SelectedValue));
results = results.AddCondition(chkFileName, x => x.FileName == null || x.FileName.Equals(string.Empty));

results = results.AddCondition(ddlIPAddress, x => x.IpAddress.Contains(ddlIPAddress.SelectedValue));
results = results.AddCondition(chkIPAddress, x => x.IpAddress == null || x.IpAddress.Equals(string.Empty)); 
```

这不是*那么*难看，但它仍然比我想要的要长。每组中的 lambda 表达式对显然非常相似，但我想不出一种进一步压缩它们的方法……至少在不求助于动态 LINQ 的情况下是这样，这让我牺牲了类型安全。

还有其他想法吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T23:28:44.427

@Kyralessa，

您可以为接受 Control 类型的参数加上 lambda 表达式并返回组合表达式的谓词创建扩展方法 AddCondition。然后，您可以使用流畅的接口组合条件并重用您的谓词。要查看如何实现它的示例，请参阅我对这个问题的回答：

[如何编写现有的 Linq 表达式](https://stackoverflow.com/questions/53597/how-do-i-compose-existing-linq-expressions)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T00:27:47.217

我会警惕以下形式的解决方案：

```
// from Keith
from x in GetInitialResults()
    //either we don't need to check, or the check passes
    where string.IsNullOrEmpty(ddlFileName.SelectedItem.Text) ||
       x.FileName.Contains(ddlFileName.SelectedValue) 
```

我的推理是变量捕获。如果您立即执行一次，您可能不会注意到差异。但是，在 linq 中，评估不是立即的，而是在每次迭代发生时发生。代表可以捕获变量并在您想要的范围之外使用它们。

感觉就像您查询的 UI 离用户界面太近了。查询是向下的一层，而 linq 不是 UI 向下通信的方式。

您最好执行以下操作。将搜索逻辑与表示分离——它更灵活和可重用——OO 的基础。

```
// my search parameters encapsulate all valid ways of searching.
public class MySearchParameter
{
    public string FileName { get; private set; }
    public bool FindNullFileNames { get; private set; }
    public void ConditionallySearchFileName(bool getNullFileNames, string fileName)
    {
        FindNullFileNames = getNullFileNames;
        FileName = null;

        // enforce either/or and disallow empty string
        if(!getNullFileNames && !string.IsNullOrEmpty(fileName) )
        {
            FileName = fileName;
        }
    }
    // ...
}

// search method in a business logic layer.
public IQueryable<MyClass> Search(MySearchParameter searchParameter)
{
    IQueryable<MyClass> result = ...; // something to get the initial list.

    // search on Filename.
    if (searchParameter.FindNullFileNames)
    {
        result = result.Where(o => o.FileName == null);
    }
    else if( searchParameter.FileName != null )
    {   // intermixing a different style, just to show an alternative.
        result = from o in result
                 where o.FileName.Contains(searchParameter.FileName)
                 select o;
    }
    // search on other stuff...

    return result;
}

// code in the UI ... 
MySearchParameter searchParameter = new MySearchParameter();
searchParameter.ConditionallySearchFileName(chkFileNames.Checked, drpFileNames.SelectedItem.Text);
searchParameter.ConditionallySearchIPAddress(chkIPAddress.Checked, drpIPAddress.SelectedItem.Text);

IQueryable<MyClass> result = Search(searchParameter);

// inform control to display results.
searchResults.Display( result ); 
```

是的，它需要更多的打字，但是你阅读的代码比你写的多 10 倍。您的 UI 更清晰，搜索参数类自行处理并确保互斥选项不会发生冲突，并且搜索代码从任何 UI 中抽象出来，甚至根本不关心您是否使用 Linq。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T08:40:52.070

由于您希望使用无数过滤器反复减少原始结果查询，因此可以使用**Aggregate()**（对应于函数式语言中的 reduce() ）。

根据我从您的帖子中收集的信息，过滤器具有可预测的形式，由 MyObject 的每个成员的两个值组成。如果要比较的每个成员都是一个字符串，可能为 null，那么我建议使用扩展方法，它允许将空引用关联到其预期类型的​​扩展方法。

```
public static class MyObjectExtensions
{
    public static bool IsMatchFor(this string property, string ddlText, bool chkValue)
    {
        if(ddlText!=null && ddlText!="")
        {
            return property!=null && property.Contains(ddlText);
        }
        else if(chkValue==true)
        {
            return property==null || property=="";
        }
        // no filtering selected
        return true;
    }
} 
```

我们现在需要在一个集合中安排属性过滤器，以允许迭代多个。它们表示为与 IQueryable 兼容的表达式。

```
var filters = new List<Expression<Func<MyObject,bool>>>
{
    x=>x.Filename.IsMatchFor(ddlFileName.SelectedItem.Text,chkFileName.Checked),
    x=>x.IPAddress.IsMatchFor(ddlIPAddress.SelectedItem.Text,chkIPAddress.Checked),
    x=>x.Other.IsMatchFor(ddlOther.SelectedItem.Text,chkOther.Checked),
    // ... innumerable associations
}; 
```

现在我们将无数过滤器聚合到初始结果查询中：

```
var filteredResults = filters.Aggregate(results, (r,f) => r.Where(f)); 
```

我在带有模拟测试值的控制台应用程序中运行它，它按预期工作。我认为这至少说明了这个原则。

# windows - 用第三方工具替换 Windows Explorer

> ID：54966
> 
> 赞同：4
> 
> 时间：2008-09-10T18:35:47.330
> 
> 标签：windows, windows-vista, file-management

我将如何用第三方工具（如 TotalCommander、explorer++ 等）替换 Windows Explorer？

当我在运行窗口中键入“C:\directoryName”时，我希望加载其中一个而不是 win explorer。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T18:53:47.833

从对第一个 LifeHacker 链接的评论中，

### 如何使 x² 成为您的默认文件夹应用程序

作为安装过程的一部分，x² 在文件系统文件夹的上下文菜单中添加了“使用 xplorer2 打开”。

如果您想将此作为默认操作（以便在单击文件夹时始终以 x2 打开），请确保这是默认动词，使用文件夹选项（“文件夹”类型）或编辑注册表：

```
[HKEY_CLASSES_ROOT\Directory\shell]
@="open_x2" 
```

如果您想要一些稍微不同的命令行选项，您可以通过编辑以下注册表项来添加任何受支持的选项：

```
[HKEY_CLASSES_ROOT\Directory\shell\open\command]
@="C:\Program files\zabkat\xplorer2\xplorer2_UC.exe" /T /1 "%1" 
```

笔记：

1.  请先检查您的安装文件夹：您的安装路径可能不同。其次，`xplorer2.exe`如果它是非 Unicode 版本，您的可执行文件可能会被调用。

2.  请注意，这`"%1"`是必需的（包括引号），并替换为您尝试打开的文件夹路径。

3.  该`/T`开关导致不恢复任何选项卡，并且该`/1`开关将 x² 置于单窗格模式。（您不必使用这些开关，但它们是有意义的）。

*（以上来自xplorer2用户手册）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T18:57:05.283

如果您转到控制面板-> 文件夹选项并转到文件类型选项卡。您可以转到“文件夹”文件类型（以“（无）”作为扩展名）。转到高级，创建一个使用您的程序的新操作（我用 FreeCommander 尝试过）。确保将其设置为默认值。

那应该这样做。

# performance - 分析可视化工具？

> ID：54971
> 
> 赞同：19
> 
> 时间：2008-09-10T18:37:57.077
> 
> 标签：performance

我需要显示从深度嵌入式 CPU 中提取的分析信息，并以我团队中的其他开发人员能够采取行动的方式呈现它。分析数据是每个函数入口和出口处的循环计数器的快照，因此我们有一个以亚微秒计时精度注释的调用图。我不希望像 gprof 那样只转储函数名称和时间，我正在寻找更容易理解和采取行动的东西。

有没有人使用过特别好的分析工具（在任何平台上），它可以很容易地识别要钻取的代码区域？我正在寻找一个鼓舞人心的例子来说明如何显示调用图，但如果有一个输入格式的好工具，我可以按摩我的数据，我会使用它。我可以使用 Windows、Linux 或 MacOS X 来运行可视化工具。

[IBM DeveloperWorks](http://www.ibm.com/developerworks/library/l-graphvis/)上的一篇分析文章将我带到了[GraphViz](http://www.graphviz.org/)，在他们的网站上有一个[分析](http://www.graphviz.org/Gallery/directed/profile.html)示例。除非这里有另一个建议，否则我将使用 GraphViz 并模仿他们的分析示例。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-13T14:52:31.737

另一个可视化分析数据的简洁工具是[gprof2dot.py python 脚本](http://code.google.com/p/jrfonseca/wiki/Gprof2Dot)。它可用于可视化几种不同的格式：“这是一个 Python 脚本，用于将 prof、gprof、oprofile、Shark、AQtime 和 python 分析器的输出转换为点图。” 这是输出的样子：

[![](https://i.stack.imgur.com/KGYNv.png)](https://i.stack.imgur.com/KGYNv.png)
[（来源：[googlecode.com](http://jrfonseca.googlecode.com/svn/wiki/gprof2dot_small.png)）]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-14T17:09:30.573

我使用 Kprof [http://kprof.sourceforge.net/](http://kprof.sourceforge.net/)

它很旧，但我从来没有找到更好的工具来检查 gprof 的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-14T13:13:09.777

[Valgrind](http://valgrind.org/)进行分析（以及更多），并且有用于可视化的[GUI 。](http://valgrind.org/downloads/guis.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T18:23:14.943

“GTKWave”怎么样？但是您必须在代码中插入探针。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T19:33:59.187

我建议你放弃 gprof+graphviz 为[OProfileUI](http://labs.o-hand.com/oprofileui/)，除非你别无选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T19:34:49.607

IE 8b2 提供了一个[简单](http://blogs.msdn.com/ronang/archive/2008/08/28/javascript-profiling-in-ie-8-beta-2.aspx)的 javascript 调用树显示，我认为它比 GraphViz 图表有用得多。

GraphViz 图表非常适合可视化调用树，但很难可视化时序问题（恕我直言，更重要的数据）。

**编辑：我认为值得指出的是，所有建议的工具都使用基于网格的树来可视化调用树。这使您可以查看调用结构，而无需像我相信您对 GraphViz 图表所做的那样淡化时序数据。*

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-11T04:43:06.013

[JetBrains dotTrace](http://www.jetbrains.com/profiler/index.html)（有一个可以玩的试用演示）。它组织调用堆栈，可以轻松找到问题点。还有很多过滤功能。非常容易导航并找到您要查找的内容。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-03-20T17:47:44.080

您可以使用[Senseo](http://scg.unibe.ch/research/senseo)，一个 Eclipse 插件。它向您展示了性能、内存分配、创建的对象、花费的时间、调用的实际方法、悬停在方法签名或调用上、调用上下文树、包资源管理器等等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-17T06:05:47.060

我编写了一个基于浏览器的可视化工具[profile_eye](https://pypi.python.org/pypi/ProfileEye/)，它对[gprof2dot](https://github.com/jrfonseca/gprof2dot)的输出进行操作。

gprof2dot 擅长挖掘许多分析工具的输出，并且在图形元素放置方面做得很好。最终呈现的是静态图形，通常非常杂乱。

使用[d3.js](http://d3js.org/)可以通过相对淡化未聚焦的元素、工具提示和[鱼眼失真](http://bost.ocks.org/mike/fisheye/)来消除大部分杂乱。

为了进行比较，请参阅[profile_eye 对](http://pythonhosted.org//ProfileEye/gprof.html)[gprof2dot 使用](https://github.com/jrfonseca/gprof2dot)的规范示例的可视化。

# ms-access - 如何防止“请告诉 Microsoft 这个问题”对话框

> ID：54972
> 
> 赞同：3
> 
> 时间：2008-09-10T18:38:07.077
> 
> 标签：ms-access, dialog, windows-server-2003

我们有一个错误，我们似乎无法找到，也没有必要/资源来尝试追踪它。我们需要做的只是防止“请告诉微软这个问题”对话框弄乱服务器。

它来自 MS-Access 错误（我们认为），但我找不到 Access 的安装位置（我认为不是）；任何驱动器上都没有 MS Office 目录。

如果我们可以阻止对话框出现，那就太好了。

谢谢。

规格：Window Server 2003 sp2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-10T18:43:04.803

从[http://www.codeproject.com/KB/exception/UnhandledExceptionClass.aspx](http://www.codeproject.com/KB/exception/UnhandledExceptionClass.aspx)：

> 如果您还想禁用计算机上的 Windows“发送错误报告”对话框，请右键单击“我的电脑”图标，选择“属性”，切换到“高级”选项卡，然后单击“错误报告”按钮。在“选项”对话框中，选择“禁用错误报告”单选按钮：
> ![](https://i.stack.imgur.com/1bjZg.png)

比较[http://www.codeproject.com/KB/exception/ExceptionHandling.aspx](http://www.codeproject.com/KB/exception/ExceptionHandling.aspx)以获得一般的 .NET 异常处理理智。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-10T19:48:34.160

我认为您没有意识到这个错误可能**有多严重。**这些错误在缓冲区溢出、空指针取消引用、除以零错误等严重条件下弹出。鉴于您提到它在服务器上运行，您可能（取决于您的情况）拥有一个**面向网络的、易于利用的程序**！

正如其他人所建议的那样，您可以在系统范围内关闭错误报告，或者您可以使用[SetErrorMode](http://msdn.microsoft.com/en-us/library/ms680621(VS.85).aspx) API 仅为您的应用程序禁用它，但**我再次强烈建议您从根本上调查并解决问题**！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T18:41:44.463

好吧，我会尝试找出正在使用 Access 的应用程序。不知道正在运行什么是一个真正的问题，尤其是当它有未处理的异常时！

至于只是禁用？尝试：

右键单击“我的电脑”

左键单击“属性”

左键单击“高级”选项卡

左键单击“错误报告”（靠近底部）

左键单击“禁用错误报告”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T18:43:43.443

它被称为 Windows 错误报告对话框。您可以按照以下说明禁用它：

[http://www.windowsnetworking.com/articles_tutorials/Disable-Error-Reporting-Windows-XP-Server-2003.html](http://www.windowsnetworking.com/articles_tutorials/Disable-Error-Reporting-Windows-XP-Server-2003.html)

但是，我会担心您收到这些错误消息的原因。你只是在隐瞒一个可能非常糟糕的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T18:47:53.807

*由于我看到三个不同的人发布了有关如何在他们自己的机器上禁用对话框的说明，因此我将再次发布此作为答案，而不仅仅是评论：*

他们不想在客户的机器上这样做，因为这将禁止*任何*应用程序使用该对话框。他们只是想阻止它出现在*他们的*应用程序中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-25T04:09:32.137

它没有隐藏任何东西，如果程序崩溃，窗口仍然会告诉你。不同之处在于它不会编译核心转储并尝试将其发送给微软。禁用此垃圾非常有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-04T18:50:19.620

在 .net 中工作时，您可以捕获所有未处理的异常（这就是导致此消息的原因）。但我不知道有一种方法可以在 Access 中做同样的事情。

[http://devcity.net/Articles/60/1/unhandled_exceptions.aspx](http://devcity.net/Articles/60/1/unhandled_exceptions.aspx)

# .net - 采用标准库

> ID：54978
> 
> 赞同：2
> 
> 时间：2008-09-10T18:40:33.233
> 
> 标签：.net

我的团队有一个控制台应用程序的命令解析库。我们周围的每个团队也有自己的团队。BCL 中没有任何内容，所以我认为这是自然的。

我看过 Mono 中的模块，它看起来很可靠，CodePlex 上的模块看起来也不错。可能还有其他人可以使用（我很想听听您的建议）。

真正的问题是：我如何让我的团队和我们周围的其他人承诺只使用一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T18:56:52.820

老实说，你**不能**让每个人都选择一种解决方案。您可以提出一个解决方案并指出它的好处，但最终的好处必须大于他们使用现有库建立的惯性。

为了让他们选择一个图书馆，您需要进行管理变更，直到找到管理所有相关组的人。说服那个人为什么每个人都应该使用一个库，然后让它过滤掉。

既然我已经说了，那为什么重要呢？您的团队是否经常需要处理其他团队的代码？其他团队是否使用会导致代码出现问题的库？这种标准化纯粹是为了标准化，还是存在一些不标准化导致的特定问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T18:52:28.010

一旦找到解决方案，就开始在代码审查中强制执行它。如果它没有在新代码中实现，请告诉他们，对不起，但你必须回去再做一次。如果您已经制定了标准和审查，这将更容易实施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T19:09:28.983

EBGreen，好点子，我应该提到我*为什么*要这样做。我们的团队经常阅读和编辑周围团队的代码。我指的是功能团队，而不仅仅是开发/测试/pm 部门。

这只是让每个人都慢下来的小事之一。处理 Team C 的代码？必须追踪他们的库，神秘地不在夜间构建中（另一个问题，但与此无关）。审查另一个开发人员的工作？需要弄清楚他们的解析器是如何工作的。开始一个新项目？需要决定要导入哪个库。

我认为您的回答确实表明了解决方案：将库放在非常方便的地方，以便新项目可以使用它（我怀疑许多现有的项目会被修改，如果它们工作正常也不应该被修改），并明确使用它的优点。

谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T19:15:34.943

@fatcat1111，在这种情况下，标准化库无论如何都是有利的。至于如何说服其他团队，我可以想到两种方法。首先指出，跨组的标准化总是会减少编码工作量（对于刚接触标准化库的人来说，最初的增加打折）。其次，尝试在功能上说服他们。希望您会选择功能最完整的库，因此它会优于其他人正在使用的库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T20:22:03.957

PowerShell 免费提供出色的命令行解析选项。创建 cmdlet 时，您可以定义属性并使用特性来确定命令行选项。然后，PowerShell 运行时为您处理输入解析。

此外，由于 PowerShell 使用 .NET 对象，您的命令的结果可以是具有属性和方法的丰富对象。

[这](http://blog.cumps.be/using-powershell-writing-and-debugging-cmdlets/)是一篇很好的博客文章，展示了编写和调试 cmdlet。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T18:02:17.963

我推荐 NDesk.Options。它利用了 Lambda 函数/.NET 3.5，非常好：

[http://www.ndesk.org/Options](http://www.ndesk.org/Options) 你基本上做的是：

```
var p = new OptionSet () {
    { "file=",      v => data = v },<br>
    { "v|verbose",  v => { ++verbose } },<br>
    { "h|?|help",   v => help = v != null },<br>
};
List<string> extra = p.Parse (args); 
```

你完成了。

它支持带有自定义分隔符、列表、单值选项和切换选项的键/值对

你不会后悔使用它。

# php - 准备好的语句如何工作？

> ID：54980
> 
> 赞同：5
> 
> 时间：2008-09-10T18:41:19.393
> 
> 标签：php, sql, pdo

我正在编写一些数据库例程，并且正在使用准备好的语句。我的环境是带有 PHP5 的 PDO。

我理解准备好的语句主要提供性能优势，以及一些辅助奖励，例如不必手动 SQL 转义输入数据。

我的问题是关于性能部分。

我在下面有两个 getPrice 函数的实现，它接受一个产品 id 并返回它的价格。

getPrice_A 在同一脚本执行中的后续调用中重用相同的 PDOStatement 对象。这是必要的还是推荐的？如果是这样，有没有办法避免在每个模型中的每个 get*() 中重复这个额外的代码？

getPrice_B 在每次调用时都会创建一个新的 PDOStatement 对象。DBMS 是否会认识到该语句已经准备好并且仍然可以跳过一些工作？换句话说，这个实现是否正确地利用了准备好的语句的性能优势？

写完所有这些并仔细阅读后，我想 getPrice_B 很好，而 getPrice_A 提供的好处可以忽略不计，这可能值得也可能不值得额外的复杂性。

不过，我仍然希望从更有知识的人那里得到肯定的消息。

假设`$pdo`在下面的示例中它是一个有效的连接 PDO 对象。

```
<?php
class Product {
    static function &getPrice_A($id) {
        static $stmt;
        if (!$stmt) {
            $stmt = $pdo->prepare('SELECT price FROM products WHERE id = ?');
        }
        $stmt->execute(array($id));
        return $stmt->fetchColumn(0);
    }

    static function &getPrice_B($id) {
        $stmt = $pdo->prepare('SELECT price FROM products WHERE id = ?');
        $stmt->execute(array($id));
        return $stmt->fetchColumn(0);
    }
}

// example usage:
$price = Product::getPrice(4982);
echo "Product 4982 costs $price\n"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T19:02:42.663

据我了解，如果是相同的语句，准备好的语句将重用生成的 SQL 计划，因此数据库将看到相同的准备好的语句，而不必做工作来弄清楚如何查询数据库。我会说保存准备好的语句的额外工作`Product::getPrice_A`通常不是很有帮助，更多的是因为它可能会混淆代码而不是性能问题。在处理性能时，我认为最好始终关注代码的清晰度，然后当您有表明存在问题的真实统计数据时再关注性能。

我会说“是的，额外的工作是不必要的”（不管它是否真的提高了性能）。另外，我不是一个非常大的数据库专家，但是预编译语句的性能提升是我从其他人那里听到的，它是在数据库级别，而不是代码级别（所以如果代码实际上是在调用参数化语句实际的数据库，然后数据库可以执行这些执行计划缓存......虽然取决于数据库，即使没有参数化语句，您也可以获得好处）。

无论如何，如果您真的担心（并看到）数据库性能问题，您应该研究缓存解决方案......我强烈推荐[memcached](http://www.danga.com/memcached/)。使用这样的解决方案，您可以缓存查询结果，甚至无需访问数据库来查找您经常访问的内容。

# windows - 从命令行更改 Windows 主机名

> ID：54989
> 
> 赞同：33
> 
> 时间：2008-09-10T18:45:04.097
> 
> 标签：windows, command-line

是否可以使用开箱即用的工具从命令行更改 Windows 2003 中的主机名？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-09-17T20:05:05.220

前面提到`wmic`的命令是要走的路，因为它默认安装在最新版本的 Windows 中。

这是我通过从环境中检索当前名称来概括它的小改进：

```
wmic computersystem where name="%COMPUTERNAME%" 
     call rename name="NEW-NAME" 
```

注意：该命令必须在一行中给出，但我将其分成两行以使滚动变得不必要。正如@rbeede 提到的，您必须重新启动才能完成更新。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-11-20T05:15:58.587

cmd（命令）：

```
netdom renamecomputer %COMPUTERNAME% /Newname "NEW-NAME" 
```

PowerShell（Windows 2008/2012）：

```
netdom renamecomputer "$env:COMPUTERNAME" /Newname "NEW-NAME" 
```

之后，您需要重新启动计算机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T18:50:11.993

我不知道执行此操作的命令，但您可以在 VBScript 或类似的东西中执行此操作。像：

```
sNewName = "put new name here" 

Set oShell = CreateObject ("WSCript.shell" ) 

sCCS = "HKLM\SYSTEM\CurrentControlSet\" 
sTcpipParamsRegPath = sCCS & "Services\Tcpip\Parameters\" 
sCompNameRegPath = sCCS & "Control\ComputerName\" 

With oShell 
.RegDelete sTcpipParamsRegPath & "Hostname" 
.RegDelete sTcpipParamsRegPath & "NV Hostname" 

.RegWrite sCompNameRegPath & "ComputerName\ComputerName", sNewName 
.RegWrite sCompNameRegPath & "ActiveComputerName\ComputerName", sNewName 
.RegWrite sTcpipParamsRegPath & "Hostname", sNewName 
.RegWrite sTcpipParamsRegPath & "NV Hostname", sNewName 
End With ' oShell 

MsgBox "Computer name changed, please reboot your computer" 
```

[原来的](http://www.tomshardware.com/forum/26545-45-change-computer-name-command-line-registry)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T20:15:41.193

可以使用 netdom.exe 命令行程序。这可从 Windows XP 支持工具或 Server 2003 支持工具（都在安装 CD 上）获得。

使用指南[在这里](https://web.archive.org/web/20170928171940/https://support.microsoft.com/en-us/help/298593/how-to-use-the-netdom-exe-utility-to-rename-a-computer-in-windows-xp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T20:15:46.950

这是使用 WHS 脚本的另一种方法：

```
Set objWMIService = GetObject("Winmgmts:root\cimv2")

For Each objComputer in _
    objWMIService.InstancesOf("Win32_ComputerSystem")

    objComputer.rename "NewComputerName", NULL, NULL 
Next 
```

[来源](http://msdn.microsoft.com/en-us/library/aa393056(VS.85).aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-05T14:17:28.920

使用以下命令远程更改计算机主机名，更改后需要重新启动系统..

`psexec.exe -h -e \\\IPADDRESS -u USERNAME -p PASSWORD netdom renamecomputer CurrentComputerName /newname:NewComputerName /force`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-07T12:59:06.847

当事情可能很复杂时，为什么要容易？当正确的询问是正确的方式时，为什么要使用像 netdom.exe 这样的第三方应用程序？尝试 2 次询问：

**wmic computersystem where caption='%computername%' get caption, UserName, Domain /format:value**

**wmic computersystem where "caption like '%%%computername%%%'" get caption, UserName, Domain /format:value**

或在批处理文件中使用循环

**for /f "tokens=2 delims==" %%i in ('wmic computersystem where "Caption like '%%%currentname%%%'" get UserName /format:value') do (echo.UserName- %%i )**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-30T21:20:43.383

如果您希望从 Windows 10 IoT 执行此操作，则可以使用一个内置命令：

`setcomputername [newname]`

不幸的是，此命令在 Windows 10 的完整版本中*不存在*。

# c# - 生成随机密码

> ID：54991
> 
> 赞同：270
> 
> 时间：2008-09-10T18:45:15.437
> 
> 标签：c#, passwords, random

当我们网站上的用户丢失密码并前往“丢失密码”页面时，我们需要给他一个新的临时密码。我真的不介意这是多么随机，或者如果它符合所有“需要”的强密码规则，我想做的就是给他们一个密码，他们以后可以更改。

该应用程序是用 C# 编写的 Web 应用程序。所以我想变得刻薄，并采用简单的方法来使用 Guid 的一部分。IE

```
Guid.NewGuid().ToString("d").Substring(1,8) 
```

建议？想法？

* * *

## 回答 #1

> 赞同：643
> 
> 时间：2008-09-10T22:44:45.250

总是有[`System.Web.Security.Membership.GeneratePassword(int length, int numberOfNonAlphanumericCharacters`）](http://msdn.microsoft.com/en-us/library/system.web.security.membership.generatepassword.aspx)。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2008-09-10T18:47:55.103

```
public string CreatePassword(int length)
{
        const string valid = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
        StringBuilder res = new StringBuilder();
        Random rnd = new Random();
        while (0 < length--)
        {
            res.Append(valid[rnd.Next(valid.Length)]);
        }
        return res.ToString();
} 
```

这样做的好处是可以从可用字符列表中为生成的密码进行选择（例如，仅数字、仅大写或仅小写等）

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-09-28T14:42:15.977

我的代码的主要目标是：

1.  字符串的分布几乎是均匀的（不关心微小的偏差，只要它们很小）
2.  它为每个参数集输出超过几十亿个字符串。如果您的 PRNG 只生成 20 亿（31 位熵）不同的值，那么生成 8 个字符串（约 47 位熵）是没有意义的。
3.  它是安全的，因为我希望人们将它用于密码或其他安全令牌。

第一个属性是通过以字母大小为模取一个 64 位值来实现的。对于小字母（例如问题中的 62 个字符），这会导致可忽略的偏差。第二个和第三个属性是通过使用[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)代替来实现的[`System.Random`](http://msdn.microsoft.com/en-us/library/system.random.aspx)。

```
using System;
using System.Security.Cryptography;

public static string GetRandomAlphanumericString(int length)
{
    const string alphanumericCharacters =
        "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
        "abcdefghijklmnopqrstuvwxyz" +
        "0123456789";
    return GetRandomString(length, alphanumericCharacters);
}

public static string GetRandomString(int length, IEnumerable<char> characterSet)
{
    if (length < 0)
        throw new ArgumentException("length must not be negative", "length");
    if (length > int.MaxValue / 8) // 250 million chars ought to be enough for anybody
        throw new ArgumentException("length is too big", "length");
    if (characterSet == null)
        throw new ArgumentNullException("characterSet");
    var characterArray = characterSet.Distinct().ToArray();
    if (characterArray.Length == 0)
        throw new ArgumentException("characterSet must not be empty", "characterSet");

    var bytes = new byte[length * 8];
    new RNGCryptoServiceProvider().GetBytes(bytes);
    var result = new char[length];
    for (int i = 0; i < length; i++)
    {
        ulong value = BitConverter.ToUInt64(bytes, i * 8);
        result[i] = characterArray[value % (uint)characterArray.Length];
    }
    return new string(result);
} 
```

*[（这是我对如何在 C# 中生成随机 8 个字符、字母数字字符串的](https://stackoverflow.com/questions/1344221/how-can-i-generate-random-8-character-alphanumeric-strings-in-c/13416143#13416143)答案的副本？ ）*

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-07-12T09:24:08.800

```
public string GenerateToken(int length)
{
    using (RNGCryptoServiceProvider cryptRNG = new RNGCryptoServiceProvider())
    {
        byte[] tokenBuffer = new byte[length];
        cryptRNG.GetBytes(tokenBuffer);
        return Convert.ToBase64String(tokenBuffer);
    }
} 
```

*（你也可以让这个方法所在的类实现 IDisposable，持有对 的引用`RNGCryptoServiceProvider`，并正确处理它，以避免重复实例化它。）*

值得注意的是，由于这会返回一个 base-64 字符串，因此输出长度始终是 4 的倍数，额外的空格`=`用作填充字符。该`length`参数指定字节缓冲区的长度，而不是输出字符串（因此可能不是该参数的最佳名称，现在我考虑一下）。这控制密码将具有多少字节的[熵。](http://en.wikipedia.org/wiki/Password_strength#Entropy_as_a_measure_of_password_strength)但是，因为 base-64 使用 4 字符块来编码每 3 个字节的输入，如果您要求的长度不是 3 的倍数，将会有一些额外的“空间”，它会`=`用来填充额外的。

如果您出于任何原因不喜欢使用 base-64 字符串，您可以将`Convert.ToBase64String()`调用替换为转换为常规字符串或任何`Encoding`方法；例如。`Encoding.UTF8.GetString(tokenBuffer)`- 只需确保您选择的字符集可以代表来自 RNG 的全部值范围，并且生成的字符与您发送或存储的任何地方都兼容。例如，使用 Unicode 往往会给出很多汉字。使用 base-64 保证了广泛兼容的字符集，并且只要您使用体面的散列算法，这样的字符串的特性就不会降低它的安全性。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-09-10T18:47:24.370

这要大得多，但我认为它看起来更全面： [http ://www.obviex.com/Samples/Password.aspx](http://www.obviex.com/Samples/Password.aspx)

```
///////////////////////////////////////////////////////////////////////////////
// SAMPLE: Generates random password, which complies with the strong password
//         rules and does not contain ambiguous characters.
//
// To run this sample, create a new Visual C# project using the Console
// Application template and replace the contents of the Class1.cs file with
// the code below.
//
// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND,
// EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
// 
// Copyright (C) 2004 Obviex(TM). All rights reserved.
// 
using System;
using System.Security.Cryptography;

/// <summary>
/// This class can generate random passwords, which do not include ambiguous 
/// characters, such as I, l, and 1\. The generated password will be made of
/// 7-bit ASCII symbols. Every four characters will include one lower case
/// character, one upper case character, one number, and one special symbol
/// (such as '%') in a random order. The password will always start with an
/// alpha-numeric character; it will not start with a special symbol (we do
/// this because some back-end systems do not like certain special
/// characters in the first position).
/// </summary>
public class RandomPassword
{
    // Define default min and max password lengths.
    private static int DEFAULT_MIN_PASSWORD_LENGTH  = 8;
    private static int DEFAULT_MAX_PASSWORD_LENGTH  = 10;

    // Define supported password characters divided into groups.
    // You can add (or remove) characters to (from) these groups.
    private static string PASSWORD_CHARS_LCASE  = "abcdefgijkmnopqrstwxyz";
    private static string PASSWORD_CHARS_UCASE  = "ABCDEFGHJKLMNPQRSTWXYZ";
    private static string PASSWORD_CHARS_NUMERIC= "23456789";
    private static string PASSWORD_CHARS_SPECIAL= "*$-+?_&=!%{}/";

    /// <summary>
    /// Generates a random password.
    /// </summary>
    /// <returns>
    /// Randomly generated password.
    /// </returns>
    /// <remarks>
    /// The length of the generated password will be determined at
    /// random. It will be no shorter than the minimum default and
    /// no longer than maximum default.
    /// </remarks>
    public static string Generate()
    {
        return Generate(DEFAULT_MIN_PASSWORD_LENGTH, 
                        DEFAULT_MAX_PASSWORD_LENGTH);
    }

    /// <summary>
    /// Generates a random password of the exact length.
    /// </summary>
    /// <param name="length">
    /// Exact password length.
    /// </param>
    /// <returns>
    /// Randomly generated password.
    /// </returns>
    public static string Generate(int length)
    {
        return Generate(length, length);
    }

    /// <summary>
    /// Generates a random password.
    /// </summary>
    /// <param name="minLength">
    /// Minimum password length.
    /// </param>
    /// <param name="maxLength">
    /// Maximum password length.
    /// </param>
    /// <returns>
    /// Randomly generated password.
    /// </returns>
    /// <remarks>
    /// The length of the generated password will be determined at
    /// random and it will fall with the range determined by the
    /// function parameters.
    /// </remarks>
    public static string Generate(int   minLength,
                                  int   maxLength)
    {
        // Make sure that input parameters are valid.
        if (minLength <= 0 || maxLength <= 0 || minLength > maxLength)
            return null;

        // Create a local array containing supported password characters
        // grouped by types. You can remove character groups from this
        // array, but doing so will weaken the password strength.
        char[][] charGroups = new char[][] 
        {
            PASSWORD_CHARS_LCASE.ToCharArray(),
            PASSWORD_CHARS_UCASE.ToCharArray(),
            PASSWORD_CHARS_NUMERIC.ToCharArray(),
            PASSWORD_CHARS_SPECIAL.ToCharArray()
        };

        // Use this array to track the number of unused characters in each
        // character group.
        int[] charsLeftInGroup = new int[charGroups.Length];

        // Initially, all characters in each group are not used.
        for (int i=0; i<charsLeftInGroup.Length; i++)
            charsLeftInGroup[i] = charGroups[i].Length;

        // Use this array to track (iterate through) unused character groups.
        int[] leftGroupsOrder = new int[charGroups.Length];

        // Initially, all character groups are not used.
        for (int i=0; i<leftGroupsOrder.Length; i++)
            leftGroupsOrder[i] = i;

        // Because we cannot use the default randomizer, which is based on the
        // current time (it will produce the same "random" number within a
        // second), we will use a random number generator to seed the
        // randomizer.

        // Use a 4-byte array to fill it with random bytes and convert it then
        // to an integer value.
        byte[] randomBytes = new byte[4];

        // Generate 4 random bytes.
        RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
        rng.GetBytes(randomBytes);

        // Convert 4 bytes into a 32-bit integer value.
        int seed = BitConverter.ToInt32(randomBytes, 0);

        // Now, this is real randomization.
        Random  random  = new Random(seed);

        // This array will hold password characters.
        char[] password = null;

        // Allocate appropriate memory for the password.
        if (minLength < maxLength)
            password = new char[random.Next(minLength, maxLength+1)];
        else
            password = new char[minLength];

        // Index of the next character to be added to password.
        int nextCharIdx;

        // Index of the next character group to be processed.
        int nextGroupIdx;

        // Index which will be used to track not processed character groups.
        int nextLeftGroupsOrderIdx;

        // Index of the last non-processed character in a group.
        int lastCharIdx;

        // Index of the last non-processed group.
        int lastLeftGroupsOrderIdx = leftGroupsOrder.Length - 1;

        // Generate password characters one at a time.
        for (int i=0; i<password.Length; i++)
        {
            // If only one character group remained unprocessed, process it;
            // otherwise, pick a random character group from the unprocessed
            // group list. To allow a special character to appear in the
            // first position, increment the second parameter of the Next
            // function call by one, i.e. lastLeftGroupsOrderIdx + 1.
            if (lastLeftGroupsOrderIdx == 0)
                nextLeftGroupsOrderIdx = 0;
            else
                nextLeftGroupsOrderIdx = random.Next(0, 
                                                     lastLeftGroupsOrderIdx);

            // Get the actual index of the character group, from which we will
            // pick the next character.
            nextGroupIdx = leftGroupsOrder[nextLeftGroupsOrderIdx];

            // Get the index of the last unprocessed characters in this group.
            lastCharIdx = charsLeftInGroup[nextGroupIdx] - 1;

            // If only one unprocessed character is left, pick it; otherwise,
            // get a random character from the unused character list.
            if (lastCharIdx == 0)
                nextCharIdx = 0;
            else
                nextCharIdx = random.Next(0, lastCharIdx+1);

            // Add this character to the password.
            password[i] = charGroups[nextGroupIdx][nextCharIdx];

            // If we processed the last character in this group, start over.
            if (lastCharIdx == 0)
                charsLeftInGroup[nextGroupIdx] = 
                                          charGroups[nextGroupIdx].Length;
            // There are more unprocessed characters left.
            else
            {
                // Swap processed character with the last unprocessed character
                // so that we don't pick it until we process all characters in
                // this group.
                if (lastCharIdx != nextCharIdx)
                {
                    char temp = charGroups[nextGroupIdx][lastCharIdx];
                    charGroups[nextGroupIdx][lastCharIdx] = 
                                charGroups[nextGroupIdx][nextCharIdx];
                    charGroups[nextGroupIdx][nextCharIdx] = temp;
                }
                // Decrement the number of unprocessed characters in
                // this group.
                charsLeftInGroup[nextGroupIdx]--;
            }

            // If we processed the last group, start all over.
            if (lastLeftGroupsOrderIdx == 0)
                lastLeftGroupsOrderIdx = leftGroupsOrder.Length - 1;
            // There are more unprocessed groups left.
            else
            {
                // Swap processed group with the last unprocessed group
                // so that we don't pick it until we process all groups.
                if (lastLeftGroupsOrderIdx != nextLeftGroupsOrderIdx)
                {
                    int temp = leftGroupsOrder[lastLeftGroupsOrderIdx];
                    leftGroupsOrder[lastLeftGroupsOrderIdx] = 
                                leftGroupsOrder[nextLeftGroupsOrderIdx];
                    leftGroupsOrder[nextLeftGroupsOrderIdx] = temp;
                }
                // Decrement the number of unprocessed groups.
                lastLeftGroupsOrderIdx--;
            }
        }

        // Convert password characters into a string and return the result.
        return new string(password);
     }
}

/// <summary>
/// Illustrates the use of the RandomPassword class.
/// </summary>
public class RandomPasswordTest
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main(string[] args)
    {
        // Print 100 randomly generated passwords (8-to-10 char long).
        for (int i=0; i<100; i++)
            Console.WriteLine(RandomPassword.Generate(8, 10));
    }
}
//
// END OF FILE
/////////////////////////////////////////////////////////////////////////////// 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-01-11T21:57:49.087

我知道这是一个旧线程，但我有可能是一个相当简单的解决方案供某人使用。易于实施、易于理解和易于验证。

考虑以下要求：

> 我需要生成一个随机密码，其中至少有 2 个小写字母、2 个大写字母和 2 个数字。密码的长度也必须至少为 8 个字符。

以下正则表达式可以验证这种情况：

```
^(?=\b\w*[a-z].*[a-z]\w*\b)(?=\b\w*[A-Z].*[A-Z]\w*\b)(?=\b\w*[0-9].*[0-9]\w*\b)[a-zA-Z0-9]{8,}$ 
```

它超出了这个问题的范围 - 但正则表达式基于[lookahead/lookbehind](http://www.regular-expressions.info/lookaround.html)和[lookaround](http://www.regular-expressions.info/lookaround.html)。

以下代码将创建一组符合此要求的随机字符：

```
public static string GeneratePassword(int lowercase, int uppercase, int numerics) {
    string lowers = "abcdefghijklmnopqrstuvwxyz";
    string uppers = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    string number = "0123456789";

    Random random = new Random();

    string generated = "!";
    for (int i = 1; i <= lowercase; i++)
        generated = generated.Insert(
            random.Next(generated.Length), 
            lowers[random.Next(lowers.Length - 1)].ToString()
        );

    for (int i = 1; i <= uppercase; i++)
        generated = generated.Insert(
            random.Next(generated.Length), 
            uppers[random.Next(uppers.Length - 1)].ToString()
        );

    for (int i = 1; i <= numerics; i++)
        generated = generated.Insert(
            random.Next(generated.Length), 
            number[random.Next(number.Length - 1)].ToString()
        );

    return generated.Replace("!", string.Empty);

} 
```

要满足上述要求，只需调用以下命令：

```
String randomPassword = GeneratePassword(3, 3, 3); 
```

代码以无效字符 ( `"!"`) 开头 - 以便字符串具有可以注入新字符的长度。

然后它从 1 循环到所需的 # 个小写字符，并且在每次迭代中，从小写列表中抓取一个随机项，并将其注入字符串中的随机位置。

然后它对大写字母和数字重复循环。

这将为您返回长度 = 的字符串，`lowercase + uppercase + numerics`其中您想要的计数的小写、大写和数字字符已按随机顺序放置。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-05-31T19:02:59.297

我创建了[这个](https://www.siepman.nl/blog/random-password-generator-with-numbers-and-special-characters)使用 RNGCryptoServiceProvider 的类，它很灵活。例子：

```
var generator = new PasswordGenerator(minimumLengthPassword: 8,
                                      maximumLengthPassword: 15,
                                      minimumUpperCaseChars: 2,
                                      minimumNumericChars: 3,
                                      minimumSpecialChars: 2);
string password = generator.Generate(); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-03-12T21:18:52.427

我将在锅中添加另一个不明智的答案。

我有一个用例，我需要随机密码进行机机通信，所以我对人类可读性没有任何要求。我也无权访问`Membership.GeneratePassword`我的项目，也不想添加依赖项。

我相当肯定`Membership.GeneratePassword`正在做类似的事情，但在这里你可以调整要从中提取的字符池。

```
public static class PasswordGenerator
{
    private readonly static Random _rand = new Random();

    public static string Generate(int length = 24)
    {
        const string lower = "abcdefghijklmnopqrstuvwxyz";
        const string upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const string number = "1234567890";
        const string special = "!@#$%^&*_-=+";

        // Get cryptographically random sequence of bytes
        var bytes = new byte[length];
        new RNGCryptoServiceProvider().GetBytes(bytes);

        // Build up a string using random bytes and character classes
        var res = new StringBuilder();
        foreach(byte b in bytes)
        {
            // Randomly select a character class for each byte
            switch (_rand.Next(4))
            {
                // In each case use mod to project byte b to the correct range
                case 0:
                    res.Append(lower[b % lower.Count()]);
                    break;
                case 1:
                    res.Append(upper[b % upper.Count()]);
                    break;
                case 2:
                    res.Append(number[b % number.Count()]);
                    break;
                case 3:
                    res.Append(special[b % special.Count()]);
                    break;
            }
        }
        return res.ToString();
    }
} 
```

还有一些示例输出：

```
PasswordGenerator.Generate(12)
"pzY=64@-ChS$"
"BG0OsyLbYnI_"
"l9#5^2&adj_i"
"#++Ws9d$%O%X"
"IWhdIN-#&O^s" 
```

抢先抱怨使用`Random`: 随机性的主要来源仍然是加密 RNG。即使您可以确定性地预先确定来自的序列`Random`（比如说它只产生`1`），您仍然不会知道将选择的下一个字符（尽管这*会*限制可能性的范围）。

一个简单的扩展是为不同的字符集添加权重，这可以像增加最大值并添加失败案例以增加权重一样简单。

```
switch (_rand.Next(6))
{
    // Prefer letters 2:1
    case 0:
    case 1:
        res.Append(lower[b % lower.Count()]);
        break;
    case 2:
    case 3:
        res.Append(upper[b % upper.Count()]);
        break;
    case 4:
        res.Append(number[b % number.Count()]);
        break;
    case 5:
        res.Append(special[b % special.Count()]);
        break;
} 
```

为了更人性化的随机密码生成器，我曾经使用[EFF dice-word list](https://www.eff.org/deeplinks/2016/07/new-wordlists-random-passphrases)实现了一个提示系统。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-10T18:53:56.540

对于这种密码，我倾向于使用可能生成更容易“使用”密码的系统。简短，通常由可发音的片段和一些数字组成，并且没有字符间的歧义（是 0 还是 O？A 1 还是 I？）。就像是

```
string[] words = { 'bur', 'ler', 'meh', 'ree' };
string word = "";

Random rnd = new Random();
for (i = 0; i < 3; i++)
   word += words[rnd.Next(words.length)]

int numbCount = rnd.Next(4);
for (i = 0; i < numbCount; i++)
  word += (2 + rnd.Next(7)).ToString();

return word; 
```

（直接在浏览器中输入，因此仅用作指南。另外，添加更多单词）。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-01-21T10:09:57.707

我不喜欢 Membership.GeneratePassword() 创建的密码，因为它们太难看并且有太多特殊字符。

此代码生成一个 10 位不太难看的密码。

```
string password = Guid.NewGuid().ToString("N").ToLower()
                      .Replace("1", "").Replace("o", "").Replace("0","")
                      .Substring(0,10); 
```

当然，我可以使用正则表达式进行所有替换，但这更具可读性和可维护性 IMO。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-05-15T12:00:03.120

我创建了这个方法，类似于会员提供程序中的可用方法。如果您不想在某些应用程序中添加 Web 引用，这很有用。

它工作得很好。

```
public static string GeneratePassword(int Length, int NonAlphaNumericChars)
    {
        string allowedChars = "abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ0123456789";
        string allowedNonAlphaNum = "!@#$%^&*()_-+=[{]};:<>|./?";
        Random rd = new Random();

        if (NonAlphaNumericChars > Length || Length <= 0 || NonAlphaNumericChars < 0)
            throw new ArgumentOutOfRangeException();

            char[] pass = new char[Length];
            int[] pos = new int[Length];
            int i = 0, j = 0, temp = 0;
            bool flag = false;

            //Random the position values of the pos array for the string Pass
            while (i < Length - 1)
            {
                j = 0;
                flag = false;
                temp = rd.Next(0, Length);
                for (j = 0; j < Length; j++)
                    if (temp == pos[j])
                    {
                        flag = true;
                        j = Length;
                    }

                if (!flag)
                {
                    pos[i] = temp;
                    i++;
                }
            }

            //Random the AlphaNumericChars
            for (i = 0; i < Length - NonAlphaNumericChars; i++)
                pass[i] = allowedChars[rd.Next(0, allowedChars.Length)];

            //Random the NonAlphaNumericChars
            for (i = Length - NonAlphaNumericChars; i < Length; i++)
                pass[i] = allowedNonAlphaNum[rd.Next(0, allowedNonAlphaNum.Length)];

            //Set the sorted array values by the pos array for the rigth posistion
            char[] sorted = new char[Length];
            for (i = 0; i < Length; i++)
                sorted[i] = pass[pos[i]];

            string Pass = new String(sorted);

            return Pass;
    } 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-06-14T15:02:55.167

我一直对 KeePass 内置的密码生成器非常满意。由于 KeePass 是一个 .Net 程序并且是开源的，所以我决定深入研究一下代码。我最终只是引用了标准应用程序安装中提供的副本 KeePass.exe，作为我项目中的参考，并编写了下面的代码。借助 KeePass，您可以看到它的灵活性。您可以指定长度、要包含/不包含的字符等...

```
using KeePassLib.Cryptography.PasswordGenerator;
using KeePassLib.Security;

public static string GeneratePassword(int passwordLength, bool lowerCase, bool upperCase, bool digits,
        bool punctuation, bool brackets, bool specialAscii, bool excludeLookAlike)
    {
        var ps = new ProtectedString();
        var profile = new PwProfile();
        profile.CharSet = new PwCharSet();
        profile.CharSet.Clear();

        if (lowerCase)
            profile.CharSet.AddCharSet('l');
        if(upperCase)
            profile.CharSet.AddCharSet('u');
        if(digits)
            profile.CharSet.AddCharSet('d');
        if (punctuation)
            profile.CharSet.AddCharSet('p');
        if (brackets)
            profile.CharSet.AddCharSet('b');
        if (specialAscii)
            profile.CharSet.AddCharSet('s');

        profile.ExcludeLookAlike = excludeLookAlike;
        profile.Length = (uint)passwordLength;
        profile.NoRepeatingCharacters = true;

        KeePassLib.Cryptography.PasswordGenerator.PwGenerator.Generate(out ps, profile, null, _pool);

        return ps.ReadString();
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-10T18:54:37.550

我喜欢看生成密码，就像生成软件密钥一样。您应该从遵循良好实践的字符数组中进行选择。采用[@Radu094 的回答](https://stackoverflow.com/questions/54991/generating-random-passwords#54997)并修改它以遵循良好的做法。不要将每个字母都放在字符数组中。有些信件在电话里很难说或理解。

您还应该考虑对生成的密码使用校验和，以确保它是由您生成的。实现此目的的一个好方法是使用[LUHN 算法](http://en.wikipedia.org/wiki/Luhn_algorithm)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-06-25T12:16:27.767

```
public static string GeneratePassword(int passLength) {
        var chars = "abcdefghijklmnopqrstuvwxyz@#$&ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        var random = new Random();
        var result = new string(
            Enumerable.Repeat(chars, passLength)
                      .Select(s => s[random.Next(s.Length)])
                      .ToArray());
        return result;
    } 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-01-27T14:24:25.413

这个包允许您生成一个随机密码，同时流畅地指示它应该包含哪些字符（如果需要）：

[https://github.com/prjseal/PasswordGenerator/](https://github.com/prjseal/PasswordGenerator/)

例子：

```
var pwd = new Password().IncludeLowercase().IncludeUppercase().IncludeSpecial();
var password = pwd.Next(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-03-29T21:05:59.450

在我的网站上，我使用这种方法：

```
 //Symb array
    private const string _SymbolsAll = "~`!@#$%^&*()_+=-\\|[{]}'\";:/?.>,<";

    //Random symb
    public string GetSymbol(int Length)
    {
        Random Rand = new Random(DateTime.Now.Millisecond);
        StringBuilder result = new StringBuilder();
        for (int i = 0; i < Length; i++)
            result.Append(_SymbolsAll[Rand.Next(0, _SymbolsAll.Length)]);
        return result.ToString();
    } 
```

编辑数组列表的字符串`_SymbolsAll`。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-12-03T08:10:42.467

这是我快速整理的内容。

```
 public string GeneratePassword(int len)
    {
        string res = "";
        Random rnd = new Random();
        while (res.Length < len) res += (new Func<Random, string>((r) => {
            char c = (char)((r.Next(123) * DateTime.Now.Millisecond % 123)); 
            return (Char.IsLetterOrDigit(c)) ? c.ToString() : ""; 
        }))(rnd);
        return res;
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-01-03T17:55:43.407

在接受的答案中添加了一些补充代码。它仅使用 Random 改进了答案，并允许一些密码选项。我也喜欢 KeePass 答案中的一些选项，但不想在我的解决方案中包含可执行文件。

```
private string RandomPassword(int length, bool includeCharacters, bool includeNumbers, bool includeUppercase, bool includeNonAlphaNumericCharacters, bool includeLookAlikes)
{
    if (length < 8 || length > 128) throw new ArgumentOutOfRangeException("length");
    if (!includeCharacters && !includeNumbers && !includeNonAlphaNumericCharacters) throw new ArgumentException("RandomPassword-Key arguments all false, no values would be returned");

    string pw = "";
    do
    {
        pw += System.Web.Security.Membership.GeneratePassword(128, 25);
        pw = RemoveCharacters(pw, includeCharacters, includeNumbers, includeUppercase, includeNonAlphaNumericCharacters, includeLookAlikes);
    } while (pw.Length < length);

    return pw.Substring(0, length);
}

private string RemoveCharacters(string passwordString, bool includeCharacters, bool includeNumbers, bool includeUppercase, bool includeNonAlphaNumericCharacters, bool includeLookAlikes)
{
    if (!includeCharacters)
    {
        var remove = new string[] { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z" };
        foreach (string r in remove)
        {
            passwordString = passwordString.Replace(r, string.Empty);
            passwordString = passwordString.Replace(r.ToUpper(), string.Empty);
        }
    }

    if (!includeNumbers)
    {
        var remove = new string[] { "0", "1", "2", "3", "4", "5", "6", "7", "8", "9" };
        foreach (string r in remove)
            passwordString = passwordString.Replace(r, string.Empty);
    }

    if (!includeUppercase)
        passwordString = passwordString.ToLower();

    if (!includeNonAlphaNumericCharacters)
    {
        var remove = new string[] { "!", "@", "#", "$", "%", "^", "&", "*", "(", ")", "-", "_", "+", "=", "{", "}", "[", "]", "|", "\\", ":", ";", "<", ">", "/", "?", "." };
        foreach (string r in remove)
            passwordString = passwordString.Replace(r, string.Empty);
    }

    if (!includeLookAlikes)
    {
        var remove = new string[] { "(", ")", "0", "O", "o", "1", "i", "I", "l", "|", "!", ":", ";" };
        foreach (string r in remove)
            passwordString = passwordString.Replace(r, string.Empty);
    }

    return passwordString;
} 
```

这是我搜索生成随机密码时的第一个链接，以下内容超出了当前问题的范围，但可能需要考虑。

*   基于`System.Web.Security.Membership.GeneratePassword`加密安全的假设，至少 20% 的字符是非字母数字的。
*   不确定在这种情况下删除字符和附加字符串是否被认为是好的做法并提供足够的熵。
*   可能需要考虑以某种方式使用[SecureString](https://msdn.microsoft.com/en-us/library/system.security.securestring(v=vs.110).aspx)实现内存中的安全密码存储。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-03T18:11:39.383

validChars 可以是任何构造，但我决定根据删除控制字符的 ascii 代码范围进行选择。在本例中，它是一个 12 个字符的字符串。

```
string validChars = String.Join("", Enumerable.Range(33, (126 - 33)).Where(i => !(new int[] { 34, 38, 39, 44, 60, 62, 96 }).Contains(i)).Select(i => { return (char)i; }));
string.Join("", Enumerable.Range(1, 12).Select(i => { return validChars[(new Random(Guid.NewGuid().GetHashCode())).Next(0, validChars.Length - 1)]; })) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-02-24T19:02:09.880

如果您想利用 System.Web.Security.Membership.GeneratePassword 使用的加密安全随机数生成，但又想将字符集限制为字母数字字符，则可以使用正则表达式过滤结果：

```
static string GeneratePassword(int characterCount)
{
    string password = String.Empty;
    while(password.Length < characterCount)
        password += Regex.Replace(System.Web.Security.Membership.GeneratePassword(128, 0), "[^a-zA-Z0-9]", string.Empty);
    return password.Substring(0, characterCount);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-02-23T13:48:13.983

检查此代码...我添加了 .remove(length) 以改善[anaximander](https://stackoverflow.com/users/1448943/anaximander)的响应

```
 public string GeneratePassword(int length)
            {
                using(RNGCryptoServiceProvider cryptRNG = new RNGCryptoServiceProvider();)
               {
                      byte[] tokenBuffer = new byte[length];
                      cryptRNG.GetBytes(tokenBuffer);
                      return Convert.ToBase64String(tokenBuffer).Remove(length);
                }

            } 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-04-15T05:01:55.427

如何在 C# 中生成随机密码。
输出：（[https://prnt.sc/11fac8v](https://prnt.sc/11fac8v)）
运行：[https ://onlinegdb.com/HJe5OHBLu](https://onlinegdb.com/HJe5OHBLu)

```
using System;
using System.Linq;

public class Program
{
    private static Random random = new Random();
    public static void Main()
    {
        Console.WriteLine("Random password with length of 8 character.");
        Console.WriteLine("===========================================");
        Console.WriteLine("Capital latters : 2");
        Console.WriteLine("Number latters : 2");
        Console.WriteLine("Special latters : 2");
        Console.WriteLine("Small latters : 2");
        Console.WriteLine("===========================================");
        Console.Write("The Random Password : ");
        Console.WriteLine(RandomStringCap(2) + RandomStringNum(2) + RandomStringSpe(2) + RandomStringSml(2));
        Console.WriteLine("===========================================");
    }
    public static string RandomStringCap(int length)
    {
        const string chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        return new string(Enumerable.Repeat(chars, length)
                         .Select(s => s[random.Next(s.Length)]).ToArray());
    }
    public static string RandomStringNum(int length)
    {
        const string chars = "0123456789";
        return new string(Enumerable.Repeat(chars, length)
                         .Select(s => s[random.Next(s.Length)]).ToArray());
    }
    public static string RandomStringSml(int length)
    {
        const string chars = "abcdefghijklmnopqrstuvwxyz";
        return new string(Enumerable.Repeat(chars, length)
                         .Select(s => s[random.Next(s.Length)]).ToArray());
    }
    public static string RandomStringSpe(int length)
    {
        const string chars = "!@#$%^&*_-=+";
        return new string(Enumerable.Repeat(chars, length)
                         .Select(s => s[random.Next(s.Length)]).ToArray());
    }
} 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-10-27T00:59:56.977

这很短，对我很有用。

```
public static string GenerateRandomCode(int length)
{
    Random rdm = new Random();
    StringBuilder sb = new StringBuilder();

    for(int i = 0; i < length; i++)
        sb.Append(Convert.ToChar(rdm.Next(101,132)));

    return sb.ToString();
} 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2018-02-09T08:38:53.020

```
 Generate random password of specified length with 
  - Special characters   
  - Number
  - Lowecase
  - Uppercase

  public static string CreatePassword(int length = 12)
    {
        const string lower = "abcdefghijklmnopqrstuvwxyz";
        const string upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const string number = "1234567890";
        const string special = "!@#$%^&*";

        var middle = length / 2;
        StringBuilder res = new StringBuilder();
        Random rnd = new Random();
        while (0 < length--)
        {
            if (middle == length)
            {
                res.Append(number[rnd.Next(number.Length)]);
            }
            else if (middle - 1 == length)
            {
                res.Append(special[rnd.Next(special.Length)]);
            }
            else
            {
                if (length % 2 == 0)
                {
                    res.Append(lower[rnd.Next(lower.Length)]);
                }
                else
                {
                    res.Append(upper[rnd.Next(upper.Length)]);
                }
            }
        }
        return res.ToString();
    } 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2019-08-02T17:48:35.630

我使用此代码生成具有字母、数字和 non_alpha_numeric 字符的平衡组成的密码。

```
public static string GeneratePassword(int Length, int NonAlphaNumericChars)
    {
        string allowedChars = "abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ0123456789";
        string allowedNonAlphaNum = "!@#$%^&*()_-+=[{]};:<>|./?";
        string pass = "";
        Random rd = new Random(DateTime.Now.Millisecond);
        for (int i = 0; i < Length; i++)
        {
            if (rd.Next(1) > 0 && NonAlphaNumericChars > 0)
            {
                pass += allowedNonAlphaNum[rd.Next(allowedNonAlphaNum.Length)];
                NonAlphaNumericChars--;
            }
            else
            {
                pass += allowedChars[rd.Next(allowedChars.Length)];
            }
        }
        return pass;
    } 
```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2016-03-01T12:04:49.417

```
public string Sifre_Uret(int boy, int noalfa)
{

    //  01.03.2016   
    // Genel amaçlı şifre üretme fonksiyonu

    //Fonskiyon 128 den büyük olmasına izin vermiyor.
    if (boy > 128 ) { boy = 128; }
    if (noalfa > 128) { noalfa = 128; }
    if (noalfa > boy) { noalfa = boy; }

    string passch = System.Web.Security.Membership.GeneratePassword(boy, noalfa);

    //URL encoding ve Url Pass + json sorunu yaratabilecekler pass ediliyor.
    //Microsoft Garanti etmiyor. Alfa Sayısallar Olabiliyorimiş . !@#$%^&*()_-+=[{]};:<>|./?.
    //https://msdn.microsoft.com/tr-tr/library/system.web.security.membership.generatepassword(v=vs.110).aspx

    //URL ve Json ajax lar için filtreleme
    passch = passch.Replace(":", "z");
    passch = passch.Replace(";", "W");
    passch = passch.Replace("'", "t");
    passch = passch.Replace("\"", "r");
    passch = passch.Replace("/", "+");
    passch = passch.Replace("\\", "e");

    passch = passch.Replace("?", "9");
    passch = passch.Replace("&", "8");
    passch = passch.Replace("#", "D");
    passch = passch.Replace("%", "u");
    passch = passch.Replace("=", "4");
    passch = passch.Replace("~", "1");

    passch = passch.Replace("[", "2");
    passch = passch.Replace("]", "3");
    passch = passch.Replace("{", "g");
    passch = passch.Replace("}", "J");

    //passch = passch.Replace("(", "6");
    //passch = passch.Replace(")", "0");
    //passch = passch.Replace("|", "p");
    //passch = passch.Replace("@", "4");
    //passch = passch.Replace("!", "u");
    //passch = passch.Replace("$", "Z");
    //passch = passch.Replace("*", "5");
    //passch = passch.Replace("_", "a");

    passch = passch.Replace(",", "V");
    passch = passch.Replace(".", "N");
    passch = passch.Replace("+", "w");
    passch = passch.Replace("-", "7");

    return passch;

} 
```

* * *

## 回答 #27

> 赞同：-5
> 
> 时间：2013-09-28T14:03:33.880

插入一个计时器：timer1、2 个按钮：button1、button2、1 个文本框：textBox1 和一个组合框：comboBox1。确保您声明：

```
int count = 0; 
```

* * *

源代码：

```
 private void button1_Click(object sender, EventArgs e)
    {
    // This clears the textBox, resets the count, and starts the timer
        count = 0;
        textBox1.Clear();
        timer1.Start();
    }

    private void timer1_Tick(object sender, EventArgs e)
    {
    // This generates the password, and types it in the textBox
        count += 1;
            string possible = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
            string psw = "";
            Random rnd = new Random { };
            psw += possible[rnd.Next(possible.Length)];
            textBox1.Text += psw;
            if (count == (comboBox1.SelectedIndex + 1))
            {
                timer1.Stop();
            }
    }
    private void Form1_Load(object sender, EventArgs e)
    {
        // This adds password lengths to the comboBox to choose from.
        comboBox1.Items.Add("1");
        comboBox1.Items.Add("2");
        comboBox1.Items.Add("3");
        comboBox1.Items.Add("4");
        comboBox1.Items.Add("5");
        comboBox1.Items.Add("6");
        comboBox1.Items.Add("7");
        comboBox1.Items.Add("8");
        comboBox1.Items.Add("9");
        comboBox1.Items.Add("10");
        comboBox1.Items.Add("11");
        comboBox1.Items.Add("12");
    }
    private void button2_click(object sender, EventArgs e)
    {
        // This encrypts the password
        tochar = textBox1.Text;
        textBox1.Clear();
        char[] carray = tochar.ToCharArray();
        for (int i = 0; i < carray.Length; i++)
        {
            int num = Convert.ToInt32(carray[i]) + 10;
            string cvrt = Convert.ToChar(num).ToString();
            textBox1.Text += cvrt;
        }
    } 
```

# sqlite - SQLite 的可扩展性如何？

> ID：54998
> 
> 赞同：187
> 
> 时间：2008-09-10T18:47:58.067
> 
> 标签：sqlite, scalability

我最近阅读了这个关于[SQLite vs MySQL](https://stackoverflow.com/questions/3630/sqlite-vs-mysql)的问题，答案指出 SQLite 不能很好地扩展，但是官方网站[也证实了这一点](http://www.sqlite.org/whentouse.html)。

SQLite 的可扩展性如何，它的最高限制是什么？

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2008-09-15T11:42:11.557

昨天我发布了一个小网站^*跟踪为所有访问者使用共享 SQLite 数据库的代表。不幸的是，即使它给我的主机带来了适度的负载，它的运行速度也很慢。这是因为每次有人查看该页面时整个数据库都被锁定，因为它包含更新/插入。我很快切换到 MySQL，虽然我没有太多时间来测试它，但它似乎比 SQLite 更具可扩展性。我只记得在 sqlite 中尝试从 shell 执行查询时，页面加载速度很慢，偶尔会出现数据库锁定错误。也就是说，我正在从 SQLite 运行另一个站点就好了。不同之处在于该站点是静态的（即我是唯一可以更改数据库的站点），因此对于并发读取来说它工作得很好。故事的道德启示：

**编辑**：我刚刚意识到我可能对 SQLite 不公平——当我从网页提供 SQLite 数据库时，我没有索引 SQLite 数据库中的任何列。这部分导致了我正在经历的放缓。然而，数据库锁定的观察结果——如果你有特别繁重的更新，SQLite 的性能将无法与 MySQL 或 Postgres 相提并论。

**另一个编辑：**自从我将近 3 个月前发布了这篇文章以来，我有机会仔细检查 SQLite 的可伸缩性，并且通过一些技巧，它可以具有相当大的可伸缩性。正如我在第一次编辑中提到的，数据库索引大大减少了查询时间，但这更多的是对数据库的一般观察，而不是对 SQLite 的观察。但是，您可以使用另一个技巧来加速 SQLite：[事务](http://www.sqlite.org/lang_transaction.html)。每当您必须执行多个数据库写入时，请将它们放在事务中。而不是每次发出写入查询时都写入（并锁定）文件，写入只会在事务完成时发生一次。

我在第一段中提到我发​​布的网站已经切换回 SQLite，一旦我在几个地方调整了我的代码，它就运行得非常顺利。

^(* 该网站不再可用)

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2008-09-15T10:38:28.623

Sqlite 在单用户方面是可扩展的，我有性能非常好的数 GB 数据库，而且我没有遇到太多问题。

但它*是*单用户的，所以这取决于你在谈论什么样的扩展。

回应评论。请注意，没有什么可以阻止在多用户环境中使用 Sqlite 数据库，但是每个事务（实际上是修改数据库的每个 SQL 语句）都会对*文件**进行*锁定，这将阻止其他用户访问数据库*所有*.

因此，如果您对数据库进行了大量修改，您基本上会很快遇到扩展问题。另一方面，如果与写访问相比，你有很多读访问，那可能还不错。

但是 Sqlite 当然会在多用户环境中*运行*，但它不会*表现*良好。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2010-12-15T15:12:07.450

SQLite 驱动 sqlite.org 网站和其他拥有大量流量的网站。他们建议，如果您每天的点击次数[少于 100k ，SQLite 应该可以正常工作。](http://www.sqlite.org/whentouse.html)这是在他们提供“Writeahead Logging”功能之前编写的。

如果您想使用 SQLite 加快速度，请执行以下操作：

*   升级到 SQLite 3.7.x
*   启用[预写日志记录](http://www.sqlite.org/draft/releaselog/3_7_0.html)
*   运行以下 pragma：“PRAGMA cache_size = Number-of-pages;” 默认大小（页数）为 2000 页，但如果提高该数字，则会增加直接耗尽内存的数据量。

您可能想看一下我在 YouTube 上名为“[使用 Writeahead Logging 提高 SQLite 性能](http://www.youtube.com/watch?v=hRu86mcRk5Y)”的视频，该视频展示了如何使用 write-ahead logging 并演示了 5 倍的写入速度改进。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-09-10T18:51:32.690

Sqlite 是一个*桌面*或*进程内*数据库。SQL Server、MySQL、Oracle 和它们的兄弟都是*服务器*。

对于需要支持对数据存储的并发写入访问的*任何*应用程序，桌面数据库本质上不是一个好的选择。这在某种程度上包括大多数曾经创建的网站。如果您甚至必须登录进行任何操作，您可能需要对数据库的写访问权。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-05-05T22:27:36.937

你读过这个 SQLite 文档 - [http://www.sqlite.org/whentouse.html](http://www.sqlite.org/whentouse.html)吗？

> SQLite 通常可以很好地作为中低流量网站（也就是说，所有网站的 99.9%）的数据库引擎。当然，SQLite 可以处理的网络流量取决于网站使用其数据库的程度。一般来说，任何每天点击量少于 100K 的网站都可以使用 SQLite。10 万次点击/天的数字是保守估计，而不是硬性上限。SQLite 已被证明可以处理 10 倍的流量。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-08-24T05:02:06.830

SQLite 可扩展性将高度依赖于所使用的数据及其格式。我在超长表（GPS 记录，每秒一条记录）方面有过一些艰难的经历。经验表明，SQLite 会分阶段减速，部分原因是不断重新平衡不断增长的持有索引的二叉树（并且使用带时间戳的索引，您只*知道*树会得到很多重新平衡，但这对您至关重要）搜索）。所以最终大约 1GB（我知道，非常接近），在我的情况下查询变得迟缓。您的里程会有所不同。

有一件事要记住，尽管吹牛，SQLite 不是为数据仓库而生的。SQLite有各种[不推荐的用途。](http://sqlite.org/whentouse.html)SQLite 背后的优秀人士自己说：

> 另一种看待 SQLite 的方式是：SQLite 并非旨在取代 Oracle。它旨在取代 fopen()。

这导致了主要论点（不是定量的，抱歉，而是定性的），SQLite 并不适用于所有用途，而 MySQL 可以涵盖许多不同的用途，即使不是很理想。例如，您可以让 MySQL 存储 Firefox cookie（而不是 SQLite），但您需要始终运行该服务。另一方面，您可以在 SQLite（正如许多人所做的那样）而不是 MySQL 上运行事务性网站，但预计会有很多停机时间。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-15T20:41:07.830

这样想吧。每次有人使用 SQL Lite 时都会被锁定（SQLite 不会锁定读取）。因此，如果您提供一个网页或一个有多个并发用户的应用程序，那么一次只有一个用户可以通过 SQLLite 使用您的应用程序。所以就存在缩放问题。如果它是一个人的应用程序，比如一个音乐库，其中您拥有数百个标题、评级、信息、使用、播放、播放时间，那么 SQL Lite 将完美地扩展保存数千甚至数百万条记录（硬盘愿意）

另一方面，MySQL 非常适用于人们同时使用它的服务器应用程序。它不锁定，而且尺寸相当大。因此，对于您的音乐库，MySql 将被过度杀死，因为只有一个人会看到它，除非这是一个共享音乐库，成千上万的人添加或更新它。然后 MYSQL 将是使用的。

所以理论上 MySQL 的扩展性比 Sqllite 更好，因为它可以处理多个用户，但对于单个用户的应用程序来说太过分了。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-31T11:33:32.470

我认为一个（数量为 1）为数百个客户端提供服务的网络服务器出现在后端，与数据库的单个连接，不是吗？

因此数据库中没有并发访问，因此我们可以说数据库正在“单用户模式”下工作。在这种情况下讨论多用户访问是没有意义的，因此 SQLite 与任何其他基于服务器的数据库一样工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T14:51:06.930

SQLite 的网站（您引用的部分）表明它可以用于各种多用户情况。

我会说它可以处理很多。根据我的经验，它一直非常快。当然，您需要索引您的表，并且在针对它进行编码时，您需要确保使用参数化查询等。基本上与您对任何数据库执行的操作相同，以提高性能。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-11T22:19:17.263

可能值得一试[REAL SQL Server](http://realsoftware.com/realsqlserver/)，它是基于 SQLite 构建的数据库服务器。************