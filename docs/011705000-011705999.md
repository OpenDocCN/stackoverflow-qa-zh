# StackOverflow 问答 11705000-11705999

# android - Android url.openstream 提供了太多重定向 IOException

> ID：11705000
> 
> 赞同：1
> 
> 时间：2012-07-28T22:02:16.220
> 
> 标签：android, url, ioexception

我似乎无法弄清楚这一点。我正在加载一个具有单个重定向的 URL，当只有一个重定向并且它在浏览器中工作时，Android 会抛出“重定向过多”。这是一个简化的代码片段：

```
URL url = null;
InputStream in;
String pic_url = "http://www.cdn.sherdog.com/image_crop/200/300/_images/fighter/20100221121302_bader.JPG";
try { url = new URL(pic_url); }
catch (MalformedURLException e1) { Log.d("iTrackMMA","URL had exception malformedURLEx on: " + pic_url); }

try { in = url.openStream(); }
catch (IOException ioe) { Log.d("iTrackMMA","URL had IOException on: " + pic_url + " with error: " + ioe.getMessage()); } 
```

错误：

```
07-28 21:57:38.017: URL had IOException on: http://www.cdn.sherdog.com/image_crop/200/300/_images/fighter/20100221121302_bader.JPG with error: Too many redirects 
```

如果我使用此重定向到的 URL 来删除任何重定向，我仍然会收到相同的错误，即使似乎没有任何重定向？

```
URL url = null;
InputStream in;
String pic_url = "http://m.sherdog.com/image_crop.php?image=http://www.cdn.sherdog.com/_images/fighter/20100221121302_bader.JPG&&width=200&&height=300";
try { url = new URL(pic_url); }
catch (MalformedURLException e1) { Log.d("iTrackMMA","URL had exception malformedURLEx on: " + pic_url); }

try { in = url.openStream(); }
catch (IOException ioe) { Log.d("iTrackMMA","URL had IOException on: " + pic_url + " with error: " + ioe.getMessage()); } 
```

错误：

```
07-28 21:48:31.337: URL had IOException on: http://m.sherdog.com/image_crop.php?image=http://www.cdn.sherdog.com/_images/fighter/20100221121302_bader.JPG&&width=200&&height=300 with error: Too many redirects 
```

我错过了什么？它对其他人也这样做吗？我想知道这个 URL 是否有一些不符合 HTML 的东西，如果是这样，我希望找到一种解决方法，以便 Android 可以很好地使用它。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:04:08.450

由于服务器正在发送重定向，它显然正在运行某种请求过滤 - 这可能质量有问题（很有可能）。

仅仅因为它可以在浏览器中工作并不意味着它可以直接工作`URL#openStream()`- 您可能不得不欺骗服务，您实际上是一个普通的网络浏览器。

在您的情况下，请尝试执行以下操作：

```
try {
    URL url = new URL(pic_url);
    URLConnection conn = url.openConnection();
    // Spoof the User-Agent of a known web browser
    conn.setRequestProperty("User-Agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2");
    in = conn.getInputStream();
} catch (MalformedURLException e) {
    // Error handling goes here
} catch (IOException e) {
    // Error handling goes here
} 
```

# php - 以多种格式输出数据库信息

> ID：11705002
> 
> 赞同：0
> 
> 时间：2012-07-28T22:02:24.467
> 
> 标签：php, sql, xml, csv, datafeed

我目前正在创建一个 CMS，CMS 的主要功能之一是数据馈送系统。该网站将其数据库之一的内容传输到大量列表站点。每个站点都有自己的信息格式规范，我的任务是创建一个后端，该后端可用于为非程序员轻松修改和添加数据馈送。

到目前为止，在我收到的三种文件类型中，XML、CSV 和 TXT。即使在这些文件类型中，也有不同的格式化标准，不同的字段顺序，有些有引号，有些没有，等等。我一直对此感到困惑，这是我的解决方案：

*   每个提要都有一个模板存储在单独的数据库表中。模板将包含提要所需的任何结构（XML、CSV、TXT）和占位符值（例如 {{NAME}}）。然后脚本将遍历每个数据库条目，用变量值替换占位符，并使用正确的文件扩展名保存完成的文档。

我的问题是弄清楚如何使用一个 PHP 文件保存多个文件（可能从另一个 PHP 文件多次调用同一个文件？），此外，如何保存不同的文件类型。基本上，如何设置扩展名并保存文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:00:53.810

我会推荐一种面向对象的方法来解决所有这些问题：

**1)**为需要将每个对象转换成的每种数据类型创建接口

```
interface xmlSerializable {
    public function toXML();
}

interface csvSerializable {
    public function toCSV();
}

interface txtSeriablizable() {
    public function toTXT();
} 
```

**2）**创建一个类来表示您需要为您的客户端和`implement`每个接口序列化为不同格式的数据类型

```
class Data implements xmlSerializeable { // I only implemented one for brevity
    private $id         = null;
    private $stuff      = null;
    private $otherStuff = null;
    private $stuffArray = array();

    public __construct($id, $stuff, $otherStuff, $stuffArray) {
        $this->id         = $id;
        $this->stuff      = $stuff;
        $this->otherStuff = $otherStuff;
        $this->stuffArray = $stuffArray;
    }

    public function getId() { return $this->id; }

    public function toXML() {
        $output = '<?xml version="1.0" encoding="UTF-8"?>'."\n".
                  '<data>'."\n\t".
                  '<id>'.$this->id.'</id>'."\n\t".
                  '<stuff>'.$this->stuff.'</stuff>'."\n\t".
                  '<otherStuff>'.$this->otherStuff.'</otherStuff>'."\n\t".
                  '<stuffArray>'."\n\t\t";

        foreach($this->stuffArray as $stuff) {
            $output .= '<stuff>'.$stuff.'</stuff>'."\n\t\t";
        }

        $output .= '</stuffArray>'."\n".
                   '</data>';

        return $output;
    }
} 
```

现在，您可以通过创建接受 SQL 查询并返回对象数组的`Data`a 来从数据库中创建对象。要序列化它们，只需调用您为每种格式实现的方法：`DataFactory``Data`

```
$df    = new DataFactory($pdo);
$datas = $df->query('SELECT * FROM Data');

foreach($datas as $data) {
    file_put_contents('/data/xml/'.$data->getId().'.xml', $data->toXML());
    // You can add other formats here in the above fashion
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:12:20.887

您可以像保存第一个文件一样保存多个文件。

如果您有 中的文件内容`$filecontent`，以及要使用的文件名（带有适当的扩展名）`$filepath`，您可以使用

```
file_put_contents($filename, $filecontent) 
```

在你的循环中这样做，你就完成了。

有关[file_put_contents 的详细信息，请参阅其 php 手册页](http://de2.php.net/manual/en/function.file-put-contents.php)。

# php - Drupal 7，如何在提交元素中跨越 html/标记？

> ID：11705003
> 
> 赞同：0
> 
> 时间：2012-07-28T22:03:01.907
> 
> 标签：php, drupal, drupal-theming

我创建了一个按钮

```
$form['submit'] = array(
 '#type' => 'submit',
 '#value' => 'verify',
 '#tree' => TRUE,
); 
```

我添加了一些标记代码

```
 $form['submit']['verify'] array(
 '#markup' => 'example text',
 ); 
```

按钮和标记文本正确显示为单独的元素。

但我想用标记文本替换提交元素中的验证值。我不能只更改文本，因为标记将包含 html。

我尝试将标记设为变量，尝试将其设为子元素。我能想到的一切。但我只是不能让按钮跨越标记。

任何建议都适用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T07:01:49.473

```
$form['submit'] = array(
 '#type' => 'submit',
 '#value' => 'verify',
 '#tree' => TRUE,
 '#prefix' => '<div class="fancy-submit">',
 '#suffix' => '</div>',
); 
```

我想知道为什么您不使用带有默认类的 css 来实现样式。

# c# - 我可以在 Web 服务方法名称中使用点号吗？

> ID：11705005
> 
> 赞同：0
> 
> 时间：2012-07-28T22:03:17.857
> 
> 标签：c#, web-services

我必须使用包含“。”的方法创建 Web 服务。登录它的名字。有什么办法可以在 c# webservice 中做到这一点？

我必须创建其他公司将使用的 Web 服务，他们的要求是调用具有指定名称的方法，例如“some.function”。我尝试过使用带有 WebMethod 属性的 MessageName，如下所示：

```
[WebMethod(MessageName="some.function")]
public string MyFunction(){
  return "something";
} 
```

但是肥皂客户端仍然必须调用 MyFunction，而不是 some.function（我尝试用 php、ruby、c# 编写客户端）。

# android - 没有互联网电话帐户错误

> ID：11705016
> 
> 赞同：0
> 
> 时间：2012-07-28T22:05:04.493
> 
> 标签：android

我在 Google Groups 上发布了这个图，我也会在这里做，看看我是否可以得到更多的问题：

我正在编写一段代码，每次运行时都会出错，说明：-没有可用的互联网通话帐户

我想知道这是否涉及某种权限或我缺少的其他东西。

有代码！

```
 case R.id.loadBtnWidgetConfig:
        someData = getSharedPreferences(filename, 0);
        String dataReturned = someData.getString("sharedString", "Can't Load....Sorry!");
        dataResults.setText(dataReturned);
        break; 
```

还有原木猫

```
07-28 16:51:45.189: E/AndroidRuntime(2249): FATAL EXCEPTION: main
07-28 16:51:45.189: E/AndroidRuntime(2249): java.lang.NullPointerException
07-28 16:51:45.189: E/AndroidRuntime(2249):     at this.file.app.Settings.onClick(Settings.java:49)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.view.View.performClick(View.java:2485)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.view.View$PerformClick.run(View.java:9080)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.os.Handler.handleCallback(Handler.java:587)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.os.Looper.loop(Looper.java:130)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at android.app.ActivityThread.main(ActivityThread.java:3683)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at java.lang.reflect.Method.invokeNative(Native Method)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at java.lang.reflect.Method.invoke(Method.java:507)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
07-28 16:51:45.189: E/AndroidRuntime(2249):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:11:12.607

是的，您必须在 AndroidManifest.xml 中声明权限。如果您使用的是 eclipse，您可以转到权限选项卡并以这种方式添加它，或者这里有一个 xml 语句可以帮助您：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# java - 干净的 API 设计

> ID：11705022
> 
> 赞同：5
> 
> 时间：2012-07-28T22:05:19.147
> 
> 标签：java, coding-style

这将是设计 API 的更好方法：

```
Example A:
public class UserService {
  public void addUser(final User user);
  public void addUserToIndex(final User user, final int index);
  public User lookUpUser(final User user);
  public User getUserByIndex(final int index );
  public void removeUser(final User user);
  public List<User> getAllUsers();
}

Example B:
public class UserService {
  public void add(final User user);
  public void add(final User user, final int index);
  public User lookUp(final User user);
  public User get(final int index);
  public void remove(final User user);
  public List<User> getAll();
} 
```

显然这段代码不会运行 - 它应该只是显示问题。我更喜欢第二种方法。方法名称可能有点通用，但上下文（类名、参数、返回类型）使其非常清楚。第二种方法可能存在的一个问题是，如果我需要另一个具有相同类型的 get 方法会发生什么。例如，如果我想按年龄获取用户。提前感谢您的帮助。

库库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T05:02:17.533

您需要回答两个主要问题才能使您的选择更容易：

1.  **您是否绝对 100% 确定您永远不会与多个实体进行此服务交易？**

    换句话说，是否存在一种情况，其中`UserService`会有其他方法，例如`getRoles()`？如果答案是肯定的，那么您肯定会**选择选项 A**。

2.  **如果您肯定要为每个服务拥有一个实体，您甚至需要每个服务的接口还是更愿意使用通用的通用接口**？

    所以，你可以有类似的东西，而不是你的选项 B

    ```
    public class Service<T> {
        public void add(final T entity);
        public void add(final T entity, final int index);
        public T lookUp(final T entity);
        public T get(final int index);
        public void remove(final T entity);
        public List<T> getAll();
    } 
    ```

    然后，需要更具体功能的具体服务可以扩展此通用服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T04:30:41.340

鉴于当今的现代 IDE，我同意 Tomasz 的观点，这是一个相当主观的问题。

您必须考虑代码最终会是什么样子（以及 API 的可能扩展）。

```
a.add(b); // :P this would make no sense at all
a.addUser(b) // is at least more descriptive 
```

支持和反对冗长的方法名称都有一个论据。就个人而言，凭借现代 IDE 的能力，我认为反对的论点正在慢慢减肥。

就个人而言，我更喜欢示例 A，它更清楚每种方法的意图

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T04:47:38.977

您的问题是“变得冗长”与“变得困惑”。由于变得冗长使客户端通过查看*方法名称*来猜测功能来编写代码。但是，我更喜欢第二个版本，因为*方法签名*（和*返回类型*）清楚地表明了它的作用。有了 IDE 支持和适当的注释/文档，第二版更加简洁且同样方便。

除了;没有其他方法可以解释`UserService#add(User)`会做任何事情。`adding user`其他方法也是如此。代码看起来很小，打字也更少。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-29T05:18:45.937

第一种方法似乎更干净。预先提供更多信息。阅读代码的人会立即知道代码的含义，这在调试或维护别人的代码时很重要。

以下是 2 个示例，它们与您在 2 个最佳设计框架中所做的工作相近：

JDK7

```
package java.security.acl

public interface Group extends Principal
{

   public boolean addMember(Principal user);
   public boolean removeMember(Principal user);
   public boolean isMember(Principal member);
   public Enumeration<? extends Principal> members();
} 
```

春天：

```
public interface GroupManager {

   List<String> findAllGroups();
   List<String> findUsersInGroup(String groupName);
   void createGroup(String groupName, List<GrantedAuthority> authorities);
   void deleteGroup(String groupName);
   void renameGroup(String oldName, String newName);
   void addUserToGroup(String username, String group);
   void removeUserFromGroup(String username, String groupName);
   List<GrantedAuthority> findGroupAuthorities(String groupName);
   void addGroupAuthority(String groupName, GrantedAuthority authority);
   void removeGroupAuthority(String groupName, GrantedAuthority authority);
} 
```

从这些界面可以看出，如果我正在阅读代码，就可以立即知道代码在做什么，而无需返回查看对象的类型。

我投票支持您的示例 A。它只是让每个人的生活更简单。

# c# - 调试因拖放而崩溃的控制台应用程序

> ID：11705030
> 
> 赞同：2
> 
> 时间：2012-07-28T22:07:07.523
> 
> 标签：c#, visual-studio-2008, console-application

我构建了一个控制台应用程序，允许用户将文件拖放到它上面，它会处理它。但是，它在处理文件时崩溃了，我不知道发生了什么。

我该如何调试呢？控制台关闭得太快，我看不到问题所在，当我通过命令行调用它并在那里指定一些参数时，我无法重现错误。

程序如下

*   在 Windows 资源管理器中，我将输入文件（图像）拖到 exe 上
*   然后exe将读取图像并对其进行处理
*   然后我将图像保存在一个新文件中

保存期间发生崩溃，但我对问题出在哪里不太感兴趣，但事实上我无法想出一种方法来正确调试它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:37:14.793

如果您的应用程序由其他程序（如资源管理器）自动启动 - 配置[Launch debugger on process start](http://msdn.microsoft.com/en-us/library/a329t4ed.aspx)。

另一种简单的方法（当无法调整注册表时）是在代码中添加[Debugger.Break](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)以便有机会附加调试器。甚至是 Thread.Sleep(10000) 让你有机会抓住它。

拖放没有什么特别的（与通常需要远程调试的焦点问题不同）。

使用正确的参数启动应用程序表单 VS 或附加到正在运行的应用程序。您可能希望为 CLR 异常打开“Debug->Exception->break when throw”（可能需要禁用“Tools->Options->Debug->My code only”）。

在附加到任何可疑痕迹的过程中观察输出窗口。

如果 VS 有问题，您可以以同样的方式使用 WinDbg ......但之前先尝试 VS route。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T22:12:10.283

您可以在项目属性中指定您正在调试命令行，就像

![带有调试时间事件参数的 Visual Studio 2012](../Images/f9a2b8713ae2c843d91da657a0bf41a6.png)

然后你可以像往常一样放置断点并调试你的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T22:41:40.423

首先确保您尝试了 Alexei Levenkov 提到的所有内容，如果这对您不起作用（这可能只会在您以某种方式做错时才会发生）您也可以使用**简单的日志文件**来跟踪错误，但我*总是*会选择VS调试器，因为那更舒服。

# java - 如何在 JUnit @Parameters 中将 null 作为参数传递？

> ID：11705033
> 
> 赞同：3
> 
> 时间：2012-07-28T22:07:32.397
> 
> 标签：java, parameters, null, junit4

嗨，我正在使用 @Parameters 注释将 3 个参数传递给测试用例。可以将其中任何一个设为空并进行测试吗？请帮忙..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T22:53:01.850

您使用的是哪个版本的 JUnit？如果您只是尝试从带有 @Parameters 注释的方法中返回 null，会出现什么问题？它是 NullPointerException 吗？因为如果是这样，我记得 4.10 中有这样一个错误，不知道他们是否已经修复了它。

您只是尝试返回`new Object[] {null, someObject1, someObject2}`吗？这应该有效。如果没有，请提供有关您的测试外观/问题所在的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T15:46:18.497

最近我开始了[zohhak](https://github.com/piotrturski/zohhak)项目。它可以让你写：

```
@TestWith({
   "25 USD, 7",
   "38 GBP, 2",
   "null,   0"
})
public void testMethod(Money money, int anotherParameter) {
   ...
} 
```

# jquery - jquery hover、mouseenter 和 mouseleave 在 .appendTo 之后不起作用

> ID：11705035
> 
> 赞同：7
> 
> 时间：2012-07-28T22:07:50.080
> 
> 标签：jquery

我在 $document.ready() 中绑定 mouseenter 和 mouseleave 事件，如下所示：

```
$( ".collection_add_to" ).hover(
    function() { $(this).find( ".playlists" ).fadeIn("fast"); },
    function() { $(this).find( ".playlists" ).fadeOut("fast"); }
); 
```

用户可以请求更多具有“.collection_add_to”类的搜索结果。它们被附加到现有的搜索结果中，如下所示：

```
$.get("context/collection/", $data, function(result) {
    $( result ).appendTo( "#collection_song_items" );
    // rebind_hover();
}); 
```

我仔细检查了返回的结果是否具有“.collection_add_to”类。我还尝试在额外的例程中重新绑定它：

```
function rebind_hover() {
    $( ".collection_add_to" ).hover(
        function() { $(this).find( ".playlists" ).fadeIn("fast"); },
        function() { $(this).find( ".playlists" ).fadeOut("fast"); }
    );
} 
```

没有任何效果，悬停事件不再适用于新添加的项目。使用 $load() 函数时，它可以工作。如何使悬停事件再次对动态加载的内容起作用，尤其是在使用 append() 或 appendTo() 添加内容时？

**编辑**

感谢 irc 和 Raminson 上的 sacho：

```
$(document).on("mouseenter", ".collection_add_to", function() {
           console.log("MOUSEENTER");
});
$(document).on("mouseleave", ".collection_add_to", function() {
           console.log("MOUSELEAVE");
}); 
```

我不清楚事件委托应该从**DOM 中应该高于**目标元素的节点完成。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-28T22:10:19.480

您应该*委托*事件，您可以使用`on()`方法，尝试以下操作：

```
$(document).on('mouseenter', ".collection_add_to", function() { 
     $(this).find( ".playlists" ).fadeIn("fast"); 
}).on('mouseleave', ".collection_add_to", function() { 
     $(this).find( ".playlists" ).fadeOut("fast"); 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T22:25:06.423

您需要使用事件委托，例如。

```
$( document ).on('hover', ".collection_add_to", function(e){
    if (e.type == "mouseover") { 
        $(this).find( ".playlists" ).fadeIn("fast"); 
    }
    else if (e.type == "mouseout") { 
        $(this).find( ".playlists" ).fadeOut("fast"); 
    }
); 
```

或者

```
$( document ).on( "mouseover", ".collection_add_to" ,
    function() { $(this).find( ".playlists" ).fadeIn("fast"); })
  .on( "mouseout", ".collection_add_to", 
    function() { $(this).find( ".playlists" ).fadeOut("fast"); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T22:14:29.357

jQuery 只能在原始渲染中起作用，而`DOM`不是`DOM`稍后添加的 -element 。

您可以尝试[jQuery.delegate()](http://api.jquery.com/delegate/)或[jQuery.on()](http://api.jquery.com/on/)。

# sencha-touch-2 - 将控制从一个控制器重定向到另一个控制器

> ID：11705042
> 
> 赞同：0
> 
> 时间：2012-07-28T22:08:46.737
> 
> 标签：sencha-touch-2

如何将控制从一个控制器“重定向”到另一个控制器？是通过事件/听众吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T05:39:41.047

是的，事件/侦听器是一种方法。或者，您可以通过以下方式从应用程序中的任何位置调用任何控制器的任何方法：

```
Ext.getApplication().getController("your_target_controller").method_name() 
```

# ruby-on-rails - 如何使用 youtube_it gem 在播放列表中获取超过 25 个项目

> ID：11705045
> 
> 赞同：1
> 
> 时间：2012-07-28T22:09:14.070
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, youtube

我正在尝试使用 Youtube_it gem 来提取视频列表并存储 url，但内置对象每次最多只能给我 25 个项目。有谁知道如何使用这个宝石来做到这一点？

代码如下所示：

```
playlist = client.playlist(playlist_id)
playlist.videos
puts playlist.videos.length 
```

同时，我认为我需要进行自定义搜索才能完成此操作。欢迎任何其他对我有用的建议和/或宝石。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:18:41.523

我对 youtube_it 不太熟悉，但听起来您返回 25 个结果的原因是，这是可以在结果集中返回的[默认最大结果。](https://developers.google.com/youtube/2.0/developers_guide_protocol#Retrieving_and_searching_for_videos)根据[youtube_it 的帮助页面](https://github.com/kylejginavan/youtube_it/)，您是否尝试过设置参数 max-results...

```
$ client.videos_by(:query => "penguin", :max_results => 50) 
```

请注意，max_results 的数量有时会受到 YouTube API 本身的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T03:10:10.603

好吧，我很确定你不再遇到这个问题，但我找到了解决方案，我只想分享它。

如果您有播放列表的 ID，则可以执行以下操作

```
@xml = open("http://gdata.youtube.com/feeds/api/playlists/#{playlist_id}?max-results=50&start-index=1")
    @result = YouTubeIt::Parser::VideosFeedParser.new(@xml).parse_videos 
```

在这个例子中，我最多只检索 50 个视频，但正如您所见，调整起来非常容易。

现在，@result 将成为一个包含视频对象的数组，因此您可以通过以下方式查看它：

```
@result.each do |video|
end 
```

有一个小错误，由于某种原因 unique_id 属性为空，但您可以通过以下方式获取它：

```
str1_markerstring = "/v/"
str2_markerstring = "&"
@result.each do |video|
   unique_id = video.embed_url[/#{str1_markerstring}(.*?)#{str2_markerstring}/m, 1]
end 
```

我希望这可以帮助与我有同样问题的其他人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-20T13:18:36.787

基于 Uriel 的回答，我写了一个有用的方法`fetch_all_videos_from_playlist`。

```
def fetch_videos_from_playlist(playlist_id, start_index = 1)
  xml = open("http://gdata.youtube.com/feeds/api/playlists/#{playlist_id}?max-results=50&start-index=#{start_index}")
  YouTubeIt::Parser::VideosFeedParser.new(xml).parse_videos
end

def fetch_all_videos_from_playlist(playlist_id)
  all_videos = []
  offset = 1
  while (videos = fetch_videos_from_playlist(playlist_id, offset)).length > 0
    all_videos += videos
    offset += videos.length
  end
  all_videos
end 
```

它一次获取 50 个视频，这似乎是当前 YouTube 支持的最大数量。显然，一个播放列表最多可以容纳 200 个视频。因此，该方法最多需要 4 次获取来获取所有视频。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-21T23:57:29.270

在 GitHub 上的 youtube_it 问题中心找到了这个解决方案：

```
playlists_first_page = @client.playlists('sbnation', {'start-index' => 1, 'max-results' => 25})
playlists_second_page = @client.playlists('sbnation', {'start-index' => 26, 'max-results' => 25}) 
```

来源：[https ://github.com/kylejginavan/youtube_it/issues/111](https://github.com/kylejginavan/youtube_it/issues/111)

# c# - C# 应用程序清单被忽略/不工作

> ID：11705047
> 
> 赞同：5
> 
> 时间：2012-07-28T22:09:23.850
> 
> 标签：c#, manifest, x86-64, windows-7-x64, administrator

当我尝试在 C# 中创建自定义设置应用程序时，我需要 requireAdministrator 权限。

我需要 requireAministrator 权限来防止“此程序可能未正确安装”消息。

通常这是通过将以下行添加到您的应用程序清单来完成的，如此处[所述](https://stackoverflow.com/questions/3598824/how-to-force-my-c-sharp-winforms-program-run-as-administrator-on-any-computer)。

但问题并没有解决。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-28T22:09:23.850

经过几个小时的搜索，我找到[了这个](http://social.msdn.microsoft.com/Forums/en/windowscompatibility/thread/fcebe7a4-2841-4898-9621-2e638de83fa6)。

简而言之：在构建 x86 应用程序时，Windows 7 x64 中的应用程序清单可能会被忽略。

当我将平台目标更改为 x64 时，清单不再被忽略。我的问题就解决了。

# node.js - 带有身份验证分支的流星应用程序中允许的集合

> ID：11705050
> 
> 赞同：1
> 
> 时间：2012-07-28T22:09:28.507
> 
> 标签：node.js, mongodb, meteor

我正在尝试更新我的流星应用程序中的集合并收到以下错误：

更新失败：403 -- 访问被拒绝。无法替换受限集合中的文档。

在服务器中，我有以下代码：

```
 Songs = new Meteor.Collection("songs");
    PlayLists = new Meteor.Collection('playlists');
    PlayChannels = new Meteor.Collection('playchannels');

    Meteor.publish('songs', function () {
      return Songs.find();
    });
    Meteor.publish('playlists', function () {
      return PlayLists.find();
    });
    Meteor.publish('playchannels', function () {
      return PlayChannels.find();
    });

    Meteor.startup(function () {
      Songs.allow({
        insert: function () { return true; },
        update: function () { return true; },
        remove: function () { return true; },
        fetch: function () { return true; }
      });
      PlayChannels.allow({
        insert: function () { return true; },
        update: function () { return true; },
        remove: function () { return true; },
        fetch: function () { return true; }
      });
      PlayLists.allow({
        insert: function () { return true; },
        update: function () { return true; },
        remove: function () { return true; },
        fetch: function () { return true; }
      });  
    }); 
```

我正在拨打电话如下：

```
 PlayChannels.update({_id: Session.get('playchannel')},{current:Session.get('current')}); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:40:21.157

出了问题的是电话。正确的做法是：

```
PlayChannels.update({
    _id: Session.get('playchannel')
}, {
    $set: {
        current: Session.get('current')
    }
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T17:04:20.457

allow 的 fetch 选项应该返回一个数组，而不是布尔值，或者完全删除它。我认为这应该可以解决它，因为在相同的情况下，我允许失败，因为 fetch 返回一个布尔值，因此没有考虑更新的余量。

```
Songs.allow({
        insert: function () { return true; },
        update: function () { return true; },
        remove: function () { return true; } 
      }); 
```

# python - 获取完整的包模块名称

> ID：11705055
> 
> 赞同：33
> 
> 时间：2012-07-28T22:10:25.603
> 
> 标签：python, inspect

对于我的应用程序中的详细调试消息，我使用了一个返回有用前缀的函数。考虑以下示例：

```
import inspect

def get_verbose_prefix():
    """Returns an informative prefix for verbose debug output messages"""
    s = inspect.stack()
    module_name = inspect.getmodulename(s[1][1])
    func_name = s[1][3]

    return '%s->%s' % (module_name, func_name)

def awesome_function_name():
    print "%s: Doing some awesome stuff right here" % get_verbose_prefix()

if __name__ == '__main__':
    awesome_function_name() 
```

这输出：

```
test->awesome_function_name：在这里做一些很棒的事情
```

* * *

**我的问题是：**当我在包中有一个模块时，例如“myproject.utilities.input”，返回的模块名称`get_verbose_prefix`仍然只是“input”，而不是“myproject.utilities.input”。当不同的子模块中可能有多个“输入”模块一起工作时，这大大降低了前缀在大型项目中的有用性。

**所以我的问题是：**有没有一种简单的方法可以在 Python 的包中检索完整的模块名称？我计划扩展该`get_verbose_prefix`功能以检查模块父目录中的“__init__.py”文件以推断它的全名，但首先我想知道是否有更简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-28T22:18:24.287

`__name__`总是包含模块的全名。（当然，除了`__main__`主要的。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-28T22:17:33.663

尝试使用`__name__`模块的属性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-27T06:48:42.970

在其包中检索完整模块名称的简单方法：

```
print(__file__) 
```

# jquery - jQuery Dialog 中的 Django 表单

> ID：11705058
> 
> 赞同：1
> 
> 时间：2012-07-28T22:10:48.570
> 
> 标签：jquery, python, ajax, django

我有一个带有主模板的站点（称为 base.html），以及一些由分离视图呈现的附加子页面。在 base.html 我有菜单，单击其中一个选项会显示一个 jquery 对话框。我想在这个对话框中放置一个 djangos 表单。我还希望，无论加载什么视图，此对话框都可以发送数据。我认为我应该使用一些装饰器来从表单中恢复数据，并且这个装饰器应该包含一些依赖于 ajax 的代码？

* * *

我会澄清我的问题。

我有一个 base.html 模板，其中包含 jQuery 对话框窗口，我想放一个 django 表单。我还有分别由 view1、view2 渲染的 template1.html、template2.html 等。template1.html、template2.html 扩展 base.html。所以我必须将表单处理代码放在渲染继承base.html的模板的每个视图中。我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T09:12:08.917

只需使用模板的继承，就像这样：

```
# base.html
...
<div id="dialog">
 {% block dialog %}
   {% form_for_base.as_table %}
 {% endblock %}
</div>
... 
```

并覆盖`dialog`另一个模板中的块：

```
# template.html
{% extends "base.html" %}

{% block dialog %}
  {% form_for_template.as_table %}
{% endblock %} 
```

# php - JSON.parse 错误 #1132：无效的 JSON 解析输入（Flex / Actionscript / PHP）

> ID：11705060
> 
> 赞同：3
> 
> 时间：2012-07-28T22:10:53.200
> 
> 标签：php, json, actionscript-3, apache-flex, parsing

我收到“错误 #1132：无效的 JSON 解析输入”并且不明白为什么。

我的 json 是由 php 生成的：json_encode($x)。如果在 TextArea(flex) 中显示，则输出 json 显示如下：

```
{
   "title":"The Incredibles",
   "year":"2004",
   "type":"movie",
   "id":"9806",
   "imdb_id":"tt0317705",
   "rating":8.6,
   "tagline":"No gut, no glory",
   "overview":"Bob Parr has given up his superhero days to log in time as an insurance adjuster and raise his three children with his formerly heroic wife in suburbia. But when he receives a mysterious assignment, it\\'s time to get back into costume.",
   "runtime":115,
   "budget":92000000,
   "image":"http:\/\/cf2.imgobject.com\/t\/p\/w185\/jjAgMfj0TAPvdC8E5AqDm2BBeYz.jpg",
   "trailer":"rMfrFG_69zM"
} 
```

我用几个验证器进行了验证，他们都说它是有效的 json。

在 flex 方面，我正在尝试使用以下代码访问 json：

```
JSON.parse(event.result.toString()); 
```

但得到错误。有人遇到过这个问题吗？

编辑1：

似乎概述行是问题所在，但我不明白为什么，因为我使用了 php json_encode 应该正确转义的东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:44:50.240

的转义序列`\\'`似乎终止了 JSON。

`it\\'s``it\'s`如果你想要“它是”，应该是。

由于此 JSON`"`用于字符串，因此它可能只是：`it's`.

JSON：

```
{
   "title":"The Incredibles",
   "year":"2004",
   "type":"movie",
   "id":"9806",
   "imdb_id":"tt0317705",
   "rating":8.6,
   "tagline":"No gut, no glory",
   "overview":"Bob Parr has given up his superhero days to log in time as an insurance adjuster and raise his three children with his formerly heroic wife in suburbia. But when he receives a mysterious assignment, it\'s time to get back into costume.",
   "runtime":115,
   "budget":92000000,
   "image":"http:\/\/cf2.imgobject.com\/t\/p\/w185\/jjAgMfj0TAPvdC8E5AqDm2BBeYz.jpg",
   "trailer":"rMfrFG_69zM"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T13:51:42.200

不知道你有没有解决问题，不过我也遇到了同样的问题，今天终于解决了，问题是服务器端，返回json字符串的文件是**UTF8**编码的，我已经**转换**了（通过notepad++) 到**ANSI**，一切正常 )))。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-04T16:56:19.717

JSON没有问题，我知道这个问题已经有了答案，但是这个答案是给那些仍然面临以下错误信息的人：

> 语法错误：错误 #1132：无效的 JSON 解析输入。

当涉及到`HTTPService`选项时，可能是结果格式不合适的问题：尝试`text`or`e4x`格式（它们是最方便的`xml`格式）并避免可能会在 JSON 输出中引入一些额外字符而触发一些错误的格式。

使用以下方法解析您的数据：

```
var temp_obj:Object = JSON.parse(event.result as String); 
```

`HTTPService`并通过使用正确的调用来触发 JSON 输出`resultFormat`：

```
resultFormat="text" 
```

或者

```
resultFormat="e4x" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-23T12:53:48.703

您的 JSON 是有效的，并且没有任何问题。可能这会对你有所帮助。在您的结果事件中，使用下面的参考更新您的代码。

```
 // Code
    var result:Object = JSON.parse( String(event.result) );
    trace( result['title'] ); 
```

# clearcase - 在 Rational ClearCase 中检测“邪恶双胞胎”的最简单方法是什么？

> ID：11705061
> 
> 赞同：3
> 
> 时间：2012-07-28T22:10:58.310
> 
> 标签：clearcase

我正在使用 ClearCase 7.1

我怀疑我们有一些邪恶的双胞胎。我正在寻找通过扫描 VOB 或任何其他方式找到它们的最有效方法。有没有应用它的脚本？

对于下一个即将到来的邪恶双胞胎，我们将使用阻止它的触发器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:17:48.313

除非您从 ClearCase 8.0 的集成邪恶孪生检测中受益，否则唯一的方法仍然是[`cleartool find`](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_find.htm)命令：

有关示例，请参阅“[关于 Evil Twins，“定位”部分：](http://www-01.ibm.com/support/docview.wss?uid=swg21125072#locate)

您从两个视图运行以下命令并比较输出（oid 和 pname），您可以验证文件级别是否存在邪恶孪生情况：

> Windows 语法示例：

```
cleartool find . -type f -exec "cleartool describe -fmt \"%On, %n\n\" \"%CLEARCASE_PN%@@\"" 
```

> Unix 语法示例：

```
cleartool find . -type f -exec 'cleartool describe -fmt "%On, %En\\n" $CLEARCASE_PN@@' 
```

# r - 使用协变量生成 Beta-Binomial 响应

> ID：11705062
> 
> 赞同：3
> 
> 时间：2012-07-28T22:11:01.713
> 
> 标签：r

我正在尝试使用 R 生成带有回归量的 Beta-Binomial 数据。我使用以下代码生成 Beta-Binomial 数据。现在我想在方程中添加一个协变量。感谢任何帮助。

```
set.seed(111) 
k<-20
n<-60
x<-NULL

p<-rbeta(k,3,3)# so that the mean nausea rate is alpha/(alpha+beta)
for(i in 1:k)
x<-cbind(x,rbinom(300,n,p[i])) 
```

谢谢安娜米卡

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:00:14.890

我的*猜测*是，您想从结果概率（在您的情况下是恶心）是协变量的函数的模型中生成数据。执行此操作的最标准（尽管不是唯一）方法是根据其均值`(alpha/(alpha+beta))`和形状或过度离散度参数化基础 Beta 分布，该参数决定方差（通常等效于`alpha+beta`；较大的 theta 意味着*较小的*方差）。此外，将均值设为协变量的逻辑函数可能是最简单的方法（如果需要，可以替换为不同的反向链接函数）。

包里的`rbetabinom`函数`emdbook`已经这样参数化了（可以看代码——不是很复杂）。

```
set.seed(111)
beta0 <- 0 ## logit rate at x=0
beta1 <- 2 ## increase in logit-prob(nausea) per unit x
k <- 20
n <- 60
theta <- 6  ## shape parameter, equivalent to alpha+beta
x <- runif(k)  ## distribution of covariates 
               ## (you might want something different)

library(emdbook)
eta <- beta0+beta1*x  ## linear predictor
prob <- plogis(eta)   ## logistic transform
y <- rbetabinom(k, prob=prob, size=n, theta=6) 
```

如果您设置`beta1`为零，您*应该*得到与以前相同的结果（logistic(0)=0.5，与您的平均值相同），但我还没有实际检查过。

**编辑**：要获得此数据集的 300 个副本，

```
Y <- replicate(300,rbetabinom(k, prob=prob, size=n, theta=6)) 
```

似乎工作（给出一个 20 x 300 矩阵）。替换`plyr::raply`和`replicate`转置（`r*ply`比 提供更多的一致性和控制`replicate`）也是如此。

# web-services - 通过.Net webservice从android连接MS Access DB

> ID：11705067
> 
> 赞同：0
> 
> 时间：2012-07-28T22:12:09.533
> 
> 标签：web-services, ms-access-2007

我有一个连接到 MS Access 2007 的 Web 服务。Web 服务在 localhost 上运行。Android 应用程序使用此服务。当调用将检索数据的方法时，会发生一些错误：

> System.Web.Services.Protocols.SoapException：服务器无法处理请求。---> System.InvalidOperationException: 'Microsoft.ACE.OLEDB.12.0' 提供程序未在本地计算机上注册。

该服务的其他方法，没有连接到db，在android上运行良好。此外，所有方法都适用于资源管理器。

有什么建议可以解决这个问题吗？

问候..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T16:32:25.083

您很可能需要安装 Microsoft Access 可再发行组件，您可以试试这个[http://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

# c# - 为什么有些页面需要访问令牌而其他页面不需要 Graph API？

> ID：11705071
> 
> 赞同：0
> 
> 时间：2012-07-28T22:12:40.353
> 
> 标签：c#, facebook-graph-api, facebook-c#-sdk

你可以这样做（怪物史莱克电影页面）：[https](https://graph.facebook.com/355374000182) ://graph.facebook.com/355374000182没有访问令牌（继续点击并亲自查看）。

但你不能为宿醉电影页面做到这一点：[https](https://graph.facebook.com/74089565764) ://graph.facebook.com/74089565764 。它返回假。

为什么两者之间的差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T15:41:22.740

宿醉页面上必须有年龄和/或国家/地区限制，而史瑞克页面上没有。具有任何限制的页面只能由经过身份验证的用户查看。这包括 API 调用。

更有趣的是，如果您尝试通过访问[https://www.facebook.com/74089565764](https://www.facebook.com/74089565764)来访问宿醉页面。如果我登录 FB，我会得到该页面。如果没有，我会得到一个“未找到”页面。即使访问[https://facebook.com/TheHangover](https://facebook.com/TheHangover)也只会让我在标准的 FB 登录屏幕上转储。

这不是典型的行为。通常，您会收到页面的封面照片和“您必须登录才能与 [X] 连接，因为页面所有者将此页面限制为 [Y]”的消息。

宿醉页面可能存在某种错误。我在以前管理的一些页面上看到过类似的奇怪事情。

# php - 以 PDF 格式作为附件填写的电子邮件数据

> ID：11705072
> 
> 赞同：1
> 
> 时间：2012-07-28T22:12:53.247
> 
> 标签：php, pdf, mime-types, acrobat, email-attachments

我有一个填充的 PDF 文件，提交时通过 Adob​​e Acrobat X 中的发送完成的 pdf 选项将完成的 pdf 文件发送到 processpdf.php 文件（参见下面的代码），代码使用 $HTTP_RAW_POST_DATA 获取原始数据并通过电子邮件发送它。它可以通过电子邮件发送，我收到了 pdf，但 PDF 无法在 chrome/acrobat 或任何东西中打开，因为它说它已损坏。我在这里做错了什么？

我正在使用 PHP5、Adobe Acrobat X、Safari 6

```
 <?php
    error_reporting(E_ALL);
    ini_set("display_errors", 1);

    if(!isset($HTTP_RAW_POST_DATA)) {
        echo "The Application could not be sent. Please save the PDF and email it manually.";
        exit;
    }

    $email_from = "xxx@xxx.com";
    $email_subject = "Subject";
    $email_txt = "A Form has been sent from xxx.com. See
    attachment.";

    $email_to = "xxx@xxxxx.com";

    $headers = "From: ".$email_from;

    $semi_rand = md5(time());
    $mime_boundary = "----=_NextPart_x{$semi_rand}x";

    $headers .= "\nMIME-Version: 1.0\n" .
    "Content-Type: multipart/mixed;\n" .
    " boundary=\"{$mime_boundary}\"";

    $email_message = "This is a multi-part message in MIME format.\n\n" .
    "--{$mime_boundary}\n" .
    "Content-Type:text/plain; charset=\"iso-8859-1\"\n" .
    "Content-Transfer-Encoding: 7bit\n\n"
    .$email_txt. "\n\n";

    // This uses the function above as the Version of PHP on the server
    //does not have
    // it available.

    $pdf = $HTTP_RAW_POST_DATA;

    $data = chunk_split($pdf);

    $email_message .= "--{$mime_boundary}\n" .
    "Content-type: application/pdf;\n name=\"App.pdf\"\n" .
    "Content-Transfer-Encoding: quoted-printable\n" .
    "Content-Disposition: attachment;\n filename=\"App.pdf\"\n\n" .
    $data . "\n\n" .
    "--{$mime_boundary}--\n";

    $ok = mail($email_to, $email_subject, $email_message, $headers);

    if($ok) {
    echo ("The file was successfully sent!");
    } else {
    die("Sorry but the email could not be sent. Please go back and try
    again!");
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T00:05:18.243

我得到它的工作！感谢您似乎解决了问题的phpmailer的建议。

工作代码。希望这对我花了 8 个多小时试图解决这个问题的人们有所帮助！我不敢相信关于使用 PHP 处理可填充 PDF 的文档很少。使用[PHPmailer](http://sourceforge.net/projects/phpmailer/)类和下面的代码

```
<?php
if(!isset($HTTP_RAW_POST_DATA)) {
    echo "The Application could not be sent. Please save the PDF and email it manually.";
    exit;
}
echo "<html><head></head><body><img src='loading.gif'>"; //Loading image

//Create PDF file with the filled data
$semi_rand = md5(time());
$pdf = $HTTP_RAW_POST_DATA;

 $file = $semi_rand . ".pdf"; 
 $handle = fopen($file, 'w+');
 fwrite($handle, $pdf);   
 fclose($handle);
//

require_once('class.phpmailer.php');

$mail = new PHPMailer(true); // the true param means it will throw exceptions on errors, which we need to catch

$mail->IsSMTP(); // telling the class to use SMTP

try {
  $mail->Host       = "mail.xxxxx.com"; // SMTP server
  $mail->SMTPDebug  = 2;                     // enables SMTP debug information (for testing)
  $mail->SMTPAuth   = true;                  // enable SMTP authentication
  $mail->SMTPSecure = "ssl";                 // sets the prefix to the servier
  $mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
  $mail->Port       = 465;                   // set the SMTP port for the GMAIL server
  $mail->Username   = "XXXX@XXXXXX.com";     // GMAIL username
  $mail->Password   = "XXXXX";               // GMAIL password
  $mail->AddAddress('XXXX@XXXX.com', 'First last');
  $mail->SetFrom('XXXX@XXXXXX.com', 'Application ');
  $mail->Subject = 'Subject';
  $mail->Body = 'Body of the e-mail';
  $mail->AddAttachment($file); // attachment
  ob_start(); $mail->Send(); ob_get_clean(); //Prevents SMTP responses

  unlink($file);  //delete the temporary pdf file then redirect to the success page
  echo '<META HTTP-EQUIV="Refresh" Content="0; URL=success.php">';    
  exit; 

//otherwise show errors
} catch (phpmailerException $e) {
  echo $e->errorMessage(); //Pretty error messages from PHPMailer
} catch (Exception $e) {
  echo $e->getMessage(); //Boring error messages from anything else!
}
  unlink($file);  //doubley make sure the temp pdf gets deleted
?> 
```

# php - PHP - HTTP 身份验证和下载文件（标头）

> ID：11705075
> 
> 赞同：0
> 
> 时间：2012-07-28T22:13:38.143
> 
> 标签：php, http, authentication, download

当目录受 http 摘要身份验证保护时，我想了解有关下载文件的更多信息。

实际上，当我使用更改标头的 PHP 脚本直接下载此文件时，我可以下载此文件而无需使用 HTTP 身份验证进行身份验证。为什么是这样？我在 Debian 上运行 Apache 2.2 和 PHP 5.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:18:53.030

问题是 http 身份验证是由 apache 设置的，但是 php 脚本可以访问您服务器上的任何文件，因为它是本地读取，而不是远程读取。

如果您不希望您的脚本在未经身份验证的情况下访问该文件，则您也应该在脚本上实施身份验证，而不仅仅是文件。

# ruby-on-rails-3 - 使用 Google Cloud Storage 时不要在浏览器中显示文件：始终下载

> ID：11705077
> 
> 赞同：0
> 
> 时间：2012-07-28T22:13:48.740
> 
> 标签：ruby-on-rails-3, carrierwave, google-cloud-storage

我刚开始使用带有 Rails 3 应用程序的 Google Cloud Storage。我可以使用 Carrierwave 成功地将文件上传到我的存储桶，但我希望在单击链接时始终下载文件并且永远不要直接在浏览器中呈现。

我知道使用 Dropbox，您只需将“?dl=1”添加到下载链接的末尾，它就会一直下载。Google Cloud Storage 是否有任何此类 URL 约定？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:11:08.547

在做了一些进一步的研究之后，您似乎必须自己修改 HTTP 标头以进行 Content-Disposition。

[https://developers.google.com/storage/docs/reference-headers#contentdisposition](https://developers.google.com/storage/docs/reference-headers#contentdisposition)

# ios - 自定义键盘将文本放入多个文本框中

> ID：11705078
> 
> 赞同：0
> 
> 时间：2012-07-28T22:13:58.587
> 
> 标签：ios, xcode, textbox, keyboard

问这个问题我感觉不好。我在 SO 上看过几次，但我不明白答案。我有一个在单独视图中制作的自定义键盘。它适用于一个文本框。但是现在我想要多个文本框，键盘将在其中输入数字。我已将视图控制器设置为文本字段委托，并且当您输入任一文本框时，我的自定义键盘会弹出。但是，我必须设置数字的代码仅适用于其中一个文本框。所以我想检查一下选择了哪个文本框，所以我将在那个框中进行编辑。我使用了方法 - (BOOL)textFieldShouldBeginEditing:(UITextField *)textField 并尝试了以下代码...

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
if ([numberOne isFirstResponder]) 
{
    [self.numberOne = currentTextField];    
}
else if ([numberTwo isFirstResponder])
{
    [self.numberTwo = currentTextField];
}    
} 
```

currentTextField 是一个 UItextField。然后我想在下面的代码中替换 currentTextField 来替换 numberOne。

```
- (IBAction)buttonPressed:(UIButton *)sender 
{
NSString *button = [sender currentTitle];
NSRange decimalpoint = [self.numberOne.text rangeOfString:@"."];
if (self.userIsEnteringANumber)
{
    if ([button isEqualToString:@"."] && decimalpoint.location != NSNotFound)
    {
        self.numberOne.text = self.numberOne.text;
    }else 
        self.numberOne.text = [self.numberOne.text stringByAppendingString:button];
}else 
{
    self.numberOne.text = button;
    self.userIsEnteringANumber = YES;
}
} 
```

但是，编译器不喜欢我的行 [self.numberOne = currentTextField]; 我尝试遵循其他一些建议，但不幸的是我不明白他们在说什么。有没有人给我新手指导？提前非常感谢。

我在宽敞的帮助下修复了编译器问题。谢谢。我的 textFieldShouldBeginEditing 方法现在是...

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
if ([numberOne isFirstResponder]) 
{
    self.currentTextField = self.numberOne;    
}
else if ([numberTwo isFirstResponder])
{
    self.currentTextField = self.numberTwo;
}
return YES;
} 
```

我将 IBAction buttonPressed 更改为以下...

```
- (IBAction)buttonPressed:(UIButton *)sender 
{
NSString *button = [sender currentTitle];
NSRange decimalpoint = [self.currentTextField.text rangeOfString:@"."];
if (self.userIsEnteringANumber)
{
    if ([button isEqualToString:@"."] && decimalpoint.location != NSNotFound)
    {
        self.currentTextField.text = self.currentTextField.text;
    }else 
        self.currentTextField.text = [self.currentTextField.text stringByAppendingString:button];
}else 
{
    self.currentTextField.text = button;
    self.userIsEnteringANumber = YES;
}
} 
```

现在发生了一些奇怪的事情。当我单击第一个文本字段时，键盘出现但没有任何反应，然后我点击第二个文本字段并在第一个文本字段中开始编辑。如果我单击第一个文本字段，编辑将从第二个开始。任何帮助，将不胜感激！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:26:07.520

好吧，我可以回答您的编译器问题-

要分配对 currentTextField 的引用，它应该是：

currentTextField = self.numberOne;

发送消息（调用对象的方法）时使用括号。

您将作业包裹在括号中，并且作业的方式错误。

（您目前正在用 currentTextField 覆盖您对 textFields 的引用）

我需要查看更多代码才能进一步诊断！祝你好运

编辑：（这些是未经测试的更改，但你会明白的）

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
if ([numberOne isFirstResponder] ) 
{
    self.currentTextField = self.numberOne;
    self.userIsEnteringANumber = NO;
}
else if ([numberTwo isFirstResponder])
{
    self.currentTextField = self.numberTwo;
    self.userIsEnteringANumber = NO;

}    
} 
```

# java - UML 在类图中表示一个匿名类？

> ID：11705079
> 
> 赞同：7
> 
> 时间：2012-07-28T22:14:23.643
> 
> 标签：java, oop, uml

如何在 UML 类图中表示 Java 匿名类？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-28T22:25:20.510

> 内部（嵌套）类在 UML 中用一个用交叉圆圈装饰的关联来表示。

### 插图：

![UML 内部类](../Images/307032e08a0932ba3ed52cca5f0aee91.png)

### 来源：

*   [*Java 程序员的 UML 类图*](http://www.informit.com/articles/article.aspx?p=336264&seqNum=3)，由*InformIT*上*的Robert C. Martin*撰写。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-11T11:49:06.403

Java中有两个真正的匿名类首先是无名内部类。如：

```
class BGThread<T>{...}
...
class TitleEditDlg{
    new BGThread<Props>(cont, true) {
        @Override
        public Props run() {
            ...
        }
    }
 } 
```

来自 UML 标准 2.5 (p.149) 的引用：

> 未命名分类器的匿名 InstanceSpecification 的标准符号是带下划线的冒号 (':')。

因此，对于匿名 java 类，您应该创建一个仅`:`作为名称的类块，并将容器类连接到它两次 - 通过容器关系和不带点的单向箭头。另一方面，`:`块应该连接到父类。

* * *

根据同一来源，an`Anonymous Bound Class`是我们在 Java 中遇到的第二个匿名类，但当您使用模板/泛型类时，通常不会注意到它，如

```
class BGThread<T>{...}
...
class TitleEditDlg{
   BGThread<String> newThread= new BGThread<String>();
} 
```

可以通过两种方式显示：

*   作为`bind`依赖项，对其进行替换。
*   作为中间类，带有父类的名称并在尖括号中替换。注意，这里的类是匿名的，但属性有一个名字。因此，通过这种方式，您可以显示更多信息。

* * *

![在此处输入图像描述](../Images/cea7d3eaa0b363864fc9e4515d40d64e.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T11:59:07.943

我正在寻找一种在类图中表示 JavaScript 对象文字的方法（我知道这没有多大意义……），我找到了这篇文章。

我会为此链接和图像做出贡献。再见。

[http://www.uml-diagrams.org/class-diagrams.html](http://www.uml-diagrams.org/class-diagrams.html)

![在此处输入图像描述](../Images/34ba6c1a9636c20cc44c0fb02236138c.png)*

# ios - ios - 对于可以选择的项目列表，我应该使用pickerview还是listview？

> ID：11705081
> 
> 赞同：0
> 
> 时间：2012-07-28T22:14:32.693
> 
> 标签：ios, ios5

如果我只想创建一个项目列表并给它一些默认值，应该使用什么 ui 元素？

另外，如果可以找到一些值，有没有办法让它只显示在屏幕上？意思...有没有办法让它在代码中的一些逻辑表明它应该显示之后才显示？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T03:47:14.107

你的问题很模糊。

如果您使用情节提要，您可以创建带有静态内容的 UITableViews，您可以通过将 UITableViewCells 拖到 UITableView 上，然后编辑其 textLabel 值或将其他视图/控件拖到单元格上，在情节提要编辑器中定义这些内容。

您可以通过定义 IBOutlet 属性、在情节提要中将其链接起来并更改其隐藏属性来切换 UITableView 的可见性。

# java - 如何提高由 ComponentColorModel 用 Ja va 语言创建的 BufferedImage 的绘制性能？

> ID：11705082
> 
> 赞同：1
> 
> 时间：2012-07-28T22:14:53.930
> 
> 标签：java, performance, bufferedimage, drawimage

我正在开发一个 Java 应用程序，它从 dvi 图像采集卡捕获视频。我想实时渲染从这个图像采集卡获取的帧。但是我遇到了生产力问题——渲染速度很慢，我的电脑每秒只能渲染 5-6 帧。尽管该设备每秒最多可以捕获 40 帧。我分析了我的代码，发现 drawImage 方法相对较慢。如果我用 BMP 图像调用 drawImage 方法，我通过 ImageIO.readImage 加载，而不是使用 drawImage 绘制它需要 20 毫秒。有了图像，我从图像采集卡中得到，绘制它们需要 100 多毫秒。我研究了图像采集卡库的代码，发现 BufferedImage 是通过以下方式创建的——

```
 ColorModel cm;
    if (format == PixelFormat.RGB24) {
       cm = new ComponentColorModel(
            ColorSpace.getInstance(ColorSpace.CS_sRGB), new int[] {8,8,8},
            false, false, Transparency.OPAQUE, DataBuffer.TYPE_BYTE);
    } else {
        throw new UnsupportedOperationException();
    }
    SampleModel sm = cm.createCompatibleSampleModel(width, height);
    DataBuffer db = new DataBufferByte(pixels, length);
    WritableRaster raster = Raster.createWritableRaster(sm, db, null);
    return new BufferedImage(cm, raster, false, null); 
```

像素是一个字节数组，由图像采集卡提供。有什么方法可以不同地创建 BufferedImage，以更快地调用 drawImage 方法。我知道 ColorSpaces，我不需要保留正确的颜色空间。速度更重要。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T05:39:20.343

我对 jai 的 ImageIO API 的 tiff 实现有一个问题，听起来很相似（我不知道这是否有帮助）。

基本上，它将颜色模型转换为“单像素打包样本模型”：P

这不是我的代码，我不相信它，我前段时间在网上找到它，恐怕我不记得在哪里（我确实尝试搜索它，但没有找到合适的参考。

```
/*******************************************************************************
 *
 * It seems that SinglePixelPackedSampleModel is the only fast mode when a
 * color profile is converted. This is probably a bug (that has nothing to do
 * with bugs 4886071 and 4705399).
 * Note that grayscale images (TYPE_GRAY) are not converted.
 *
 ******************************************************************************/
public static BufferedImage convertToSinglePixelPackedSampleModel(BufferedImage image) {

    long time = System.currentTimeMillis();

    WritableRaster sourceRaster = image.getRaster();
    ColorModel colorModel = image.getColorModel();
    ICC_ColorSpace colorSpace = (ICC_ColorSpace) colorModel.getColorSpace();
    final SampleModel ssmd = sourceRaster.getSampleModel();

    if (colorSpace.getType() == ColorSpace.TYPE_GRAY) {

        logger.info(">>>> TYPE_GRAY, not converting");

    } else if (!(ssmd instanceof PixelInterleavedSampleModel)) {

        logger.info(">>>> sourceSampleModel is " + ssmd.getClass() + ", not converting");

    } else {

        PixelInterleavedSampleModel sourceSampleModel = (PixelInterleavedSampleModel) ssmd;
        int[] bitMasks = new int[]{0x00ff0000, 0x0000ff00, 0x000000ff};

        SinglePixelPackedSampleModel sampleModel = new SinglePixelPackedSampleModel(DataBuffer.TYPE_INT, image.getWidth(),
                image.getHeight(), bitMasks);

        WritableRaster destRaster = Raster.createWritableRaster(sampleModel, null);
        DataBufferInt destDataBuffer = (DataBufferInt) destRaster.getDataBuffer();
        int[] destBuffer = destDataBuffer.getData();
        int[] bandOffsets = sourceSampleModel.getBandOffsets();

        for (int i = 0; i < bandOffsets.length; i++) {
            bandOffsets[i] += ((-sourceRaster.getSampleModelTranslateX() * sourceSampleModel.getPixelStride())
                    - (sourceRaster.getSampleModelTranslateY() * sourceSampleModel.getScanlineStride()));
        }

        DataBuffer sourceDataBuffer = sourceRaster.getDataBuffer();

        if (sourceDataBuffer instanceof DataBufferUShort) {

            convertUShortDataBuffer(image, (DataBufferUShort) sourceDataBuffer, sourceSampleModel, bandOffsets, destBuffer);

        } else if (sourceDataBuffer instanceof DataBufferByte) {

            convertByteDataBuffer(image, (DataBufferByte) sourceDataBuffer, sourceSampleModel, bandOffsets, destBuffer);

        } else {

            throw new IllegalArgumentException("Cannot deal with " + sourceDataBuffer.getClass());

        }

        String sourceProfileName = getICCProfileName(colorSpace.getProfile());

        if (sourceProfileName.equals("Nikon sRGB 4.0.0.3001")) {
            logger.warn(">>>> Workaround #1094403: using sRGB instead of " + sourceProfileName);
            colorSpace = new ICC_ColorSpace(ICC_Profile.getInstance(ColorSpace.CS_LINEAR_RGB));
        }

        colorModel = new DirectColorModel(colorSpace, 24, bitMasks[0], bitMasks[1], bitMasks[2], 0, false, DataBuffer.TYPE_INT);
        image = new BufferedImage(colorModel, destRaster, false, null);
    }

    time = System.currentTimeMillis() - time;
    logger.info(">>>> convertToSinglePixelPackedSampleModel() completed ok in " + time + " msec");

    return image;
}

/**
 * @param image
 * @param sourceDataBuffer
 * @param sourceSampleModel
 * @param bandOffsets
 * @param destBuffer
 */
protected static void convertByteDataBuffer(BufferedImage image, DataBufferByte sourceDataBuffer,
        PixelInterleavedSampleModel sourceSampleModel, int[] bandOffsets, int[] destBuffer) {
    int base = 0;
    int i = 0;
    byte[] sourceBuffer = sourceDataBuffer.getData();
    int pixelStride = sourceSampleModel.getPixelStride();

    for (int y = 0; y < image.getHeight(); y++) {
        int j = base;

        for (int x = 0; x < image.getWidth(); x++) {
            int r = (sourceBuffer[j + bandOffsets[0]] & 0xff);
            int g = (sourceBuffer[j + bandOffsets[1]] & 0xff);
            int b = (sourceBuffer[j + bandOffsets[2]] & 0xff);

            destBuffer[i++] = (r << 16) | (g << 8) | b;
            j += pixelStride;
        }

        base += sourceSampleModel.getScanlineStride();
    }
}

protected static void convertUShortDataBuffer(BufferedImage image, DataBufferUShort sourceDataBuffer,
        PixelInterleavedSampleModel sourceSampleModel, int[] bandOffsets, int[] destBuffer) {
    int base = 0;
    int i = 0;
    short[] sourceBuffer = sourceDataBuffer.getData();

    for (int y = 0; y < image.getHeight(); y++) {
        int j = base;

        for (int x = 0; x < image.getWidth(); x++) {
            int r = (sourceBuffer[j + bandOffsets[0]] & 0xffff) >> 8;
            int g = (sourceBuffer[j + bandOffsets[1]] & 0xffff) >> 8;
            int b = (sourceBuffer[j + bandOffsets[2]] & 0xffff) >> 8;

            destBuffer[i++] = (r << 16) | (g << 8) | b;
            j += 3;
        }

        base += sourceSampleModel.getScanlineStride();
    }
}

//    public static ICC_Profile getICCProfile(RenderedImage image) {
//
//        ColorSpace colorSpace = image.getColorModel().getColorSpace();
//
//        if (colorSpace instanceof ICC_ColorSpace) {
//
//            ICC_ColorSpace iccColorSpace = (ICC_ColorSpace) colorSpace;
//
//            return iccColorSpace.getProfile();
//
//        }
//
//        return null;
//
//    }

public static String getICCProfileName(ICC_Profile profile) {

    if (profile == null) {
        return null;
    }

    byte[] xx = profile.getData(ICC_Profile.icSigProfileDescriptionTag);
    int offset = 12;
    int count;

    for (count = 1; xx[offset + count] != 0; count++) {
        ;
    }

    return new String(xx, 0, offset, count);

} 
```

基本上，只需调用`.convertToSinglePixelPackedSampleModel(image)`.

我将（相对较大的 TIFF 图像）的渲染时间从几分钟缩短到几秒钟：P

ps - 我认为这是我找到原始代码的地方[http://www.koders.com/java/fidFE1D69AFE6930A514D5E189310AB10A3DFD43F78.aspx](http://www.koders.com/java/fidFE1D69AFE6930A514D5E189310AB10A3DFD43F78.aspx)

# ruby-on-rails - 重新编码，不能在模型中使用辅助方法

> ID：11705084
> 
> 赞同：0
> 
> 时间：2012-07-28T22:15:44.253
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

根据 MVC 进行编码的更好（正确）方法是什么？情况如下：

我的表单中有一个 collection_select，它工作正常，但是我想做这样的事情（注意选项的文本，第 4 个参数）

```
#Form.html.haml
= form_for(@payment) do |f|
 = f.collection_select(:invoice_id, Invoice.due, :id, :number + ' ' + money(:amount_due)) 
```

那行不通，因为据我所知，您无法连接符号。所以，我求助于这个：

```
#Form.html.haml
= form_for(@payment) do |f|
  = f.collection_select(:invoice_id, Invoice.due, :id, :number_with_amount_due)

#Invoice.rb
def number_with_amount_due
  "##{number} (#{money(amount_due)})"
end 
```

如果我不尝试在模型中调用辅助方法，这将起作用。

所以我该怎么做？能够在视图中连接选择文本会很好，但如果不可能，我怎样才能在 Rails 中保留正确的 MVC 的同时实现我想要做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T22:29:19.143

很大程度上编辑了我的答案，因为我弄错了。

使用 f.select，您将能够提供一个包含您需要的内容的数组。假设 Invoice.due 返回您想要的 Invoice 集合

开始 ：

```
f.select(:invoice_id, Invoice.due.map {|i| ["#{i.number} #{money(i.amount_due)}", i.id]}) 
```

我认为 collection_select 无法实现您想要做的事情，除非您将包含的帮助器添加`money`到您的模型中。

# android - 取消异步任务

> ID：11705086
> 
> 赞同：2
> 
> 时间：2012-07-28T22:16:23.407
> 
> 标签：android, android-asynctask

正在运行的 AsyncTask 的 .cancel(boolean) 方法如何工作？这是文档：

> 尝试取消此任务的执行。如果任务已完成、已被取消或由于其他原因无法取消，则此尝试将失败。如果成功，并且在调用取消时此任务尚未启动，则此任务不应该运行。如果任务已经开始，则 mayInterruptIfRunning 参数确定是否应该中断执行该任务的线程以尝试停止该任务。
> 
> 调用此方法将导致在 doInBackground(Object[]) 返回后在 UI 线程上调用 onCancelled(Object)。调用此方法可确保永远不会调用 onPostExecute(Object)。调用此方法后，应定期从 doInBackground(Object[]) 中检查 isCancelled() 返回的值，以尽早完成任务。

第二段暗示程序员在调用取消后尽快从 doInBackground 方法返回（通过定期检查 isCancelled() ）。但是在测试中，即使我不这样做，我的 AsyncTask （doInBackground 方法）似乎也会在调用取消之后立即停止。谁能解释一下？（顺便说一句，当调用取消时，Logcat 没有显示任何发生的事情）。

```
protected Void doInBackground(Void... V) {
            for (int v=3;v>0;v--){
                publishProgress(v);
                try {Thread.sleep(1500);} catch (InterruptedException e) {}
            } 
            return null;
         } 
```

此外，无论提供的 mayInrerruptIfRunning 值如何，都会发生这种情况，因此如果可以解释该值的来源，那也将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:22:18.647

有一些核心方法（“阻塞方法”），例如`Thread.sleep()`，它们本身检查线程中断并抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T22:25:00.090

您可以`isRunning()`在 AsyncTask 的 doInBackground 中进行检查，如果是，则返回 null。否则，您只能在 doInBackground 运行后取消它。

# iphone - iAd“没有委托或委托未实现 didFailToReceiveAdWithError：”

> ID：11705090
> 
> 赞同：3
> 
> 时间：2012-07-28T22:16:44.257
> 
> 标签：iphone, xcode, storyboard, iad

我在禁用 wifi 的情况下运行我的应用程序，我总是在调试器中得到空白和这条消息：

ADBannerView：未处理的错误（没有委托或委托未实现 didFailToReceiveAdWithError:)：错误域 = ADErrorDomain Code = 5“操作无法完成。横幅视图可见但没有内容” UserInfo = 0x9632d30 {ADInternalErrorCode = 5， NSLocalizedFailureReason=横幅视图可见但没有内容}

请帮我修复我的代码：.h

```
#import <iAd/iAd.h>
@interface ViewController : UIViewController  <GKAchievementViewControllerDelegate, GameCenterManagerDelegate , ADBannerViewDelegate> {

//iAD
ADBannerView *banner;  
 }

//iAD
@property (nonatomic, assign) BOOL bannerIsVisible;
@property (nonatomic, retain) IBOutlet ADBannerView *banner; 
```

.m

```
@synthesize  banner , bannerIsVisible;
-(void)bannerViewDidLoadAd:(ADBannerView *)abanner {
if (!self.bannerIsVisible) {
    [UIView beginAnimations:@"animatedAdBannerOn" context:NULL];
    banner.frame = CGRectOffset(banner.frame, 0.0, 50.0);
    [UIView commitAnimations];
    self.bannerIsVisible = YES;
}}

-(void)bannerView:(ADBannerView *)aBanner didFailToReceiveAdWithError:(NSError *)error {
if (!self.bannerIsVisible) {
    [UIView beginAnimations:@"animatedAdBannerOff" context:NULL];
    banner.frame = CGRectOffset(banner.frame, 0.0, -50.0);
    [UIView commitAnimations];
    self.bannerIsVisible = NO;
}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-28T22:53:54.370

根据错误的委托部分。在您的 viewDidLoad（或您初始化的任何地方）方法集中`banner.delegate = self;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-06T20:59:33.947

对 iOS 开发完全陌生，但我相信您需要在情节提要中设置 adBanner 视图委托。为此，请右键单击广告横幅并拖动到文件所有者。然后选择委托。这为我解决了这个问题:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-03T22:42:46.993

您可能需要在接口 Builder (IB) 中设置委托。否则，当视图加载时，没有分配委托，您将收到此错误消息。

# c - 在动态数组传递给函数期间更改变量的类型

> ID：11705091
> 
> 赞同：0
> 
> 时间：2012-07-28T22:16:57.940
> 
> 标签：c, pointers

伙计们，我的问题很简单，但我对它背后的理论感到困惑。如果有人能澄清一下，那就太好了。

我想传递某种类型的变量的动态数组，并让一个函数将该类型的变量转换为另一种类型的变量，并在以该新变量的变量数组的形式返回它之前对其进行更多的工作。

这是我不太实用的代码，向您展示我在做什么

```
#include <stdio.h>

//takes in unsigned char array, and returns unsigned short array

unsigned short foo( unsigned char *array, int size) 
{
    int i;
    unsigned short *LeArray = NULL;
    LeArray = (unsigned short*) malloc(size*sizeof(unsigned short));
    for ( i = 0; i < size; ++i ) &LeArray[i] = (unsigned char)&array[i];
    //do more stuff to that array here before returning it
    return *LeArray;

}
int main()
{

    int i, ArraySize;
    unsigned char *before = NULL;
    unsigned short *after = NULL;
    ArraySize = 9;
    before = (unsigned char*) malloc(ArraySize*sizeof(unsigned char));
    for(i = 0; i<ArraySize; i++) before[i] = i+5; //to get some values in
    for (i = 0 ; i<ArraySize; i++) printf("\npre:%d\n",before[i]);
    after = foo( before, ArraySize ); 
    for (i = 0 ; i<ArraySize; i++) printf("\npost:%d\n",after[i]);
    return 0;

} 
```

任何帮助提示或解释都会对我有很大帮助！非常感谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:22:17.010

这是一个函数，其中所有奇怪的地方都固定为您期望它做的事情：

```
unsigned short* foo( unsigned char *array, int size) 
// notice the return type - it's a pointer
{
    int i;
    unsigned short *LeArray = NULL;
    LeArray = (unsigned short*) malloc(size*sizeof(unsigned short));
    for ( i = 0; i < size; ++i ) LeArray[i] = (unsigned short)(array[i]);
    //do more stuff to that array here before returning it
    return LeArray; // notice NO DEREFERENCING here
} 
```

基本上这是您遇到的问题：

*   函数的返回类型不是指针（不是数组）
*   您正在做一个奇怪的指针杂技（我猜您正在更改代码，直到编译器停止抱怨）
*   您在返回时取消引用了一个指针，本质上是返回数组第一个元素的值（而不是整个数组，如预期的那样）

当然，还有更多。即：

*   看起来你的“in”数组没有改变 -在函数的签名中表达它是一个很好的*做法*`const unsigned char* array`
*   您可以进一步更改函数的接口以获取结果数组的输入参数

在这种情况下，您可以执行以下操作：

```
void foo(const unsigned char *array, unsigned short* LeArray, int size) 
{
    int i;
    // no malloc as the LeArray is passed-in
    for ( i = 0; i < size; ++i ) LeArray[i] = (unsigned short)(array[i]);
    //do more stuff to that array here before returning it
    return; // void return
} 
```

当然，假设数组是在调用函数中预先创建的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:21:40.257

你快到了。

但是您应该返回 LeArray 本身（这是内存中的地址），而不是 *LeArray（这是第一个元素）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T06:37:34.990

`after = foo( before, ArraySize );`- 在这里，您正在调用函数`foo`并期望返回类型为`unsigned short *`，但函数`foo`正在返回`unsigned short`值。之后，您将访问指向函数内部`unsigned short`变量的指针，这可能会导致崩溃（意外行为）。`after``main`

所以改变你的函数原型，`unsigned short* foo( unsigned char *array, int size)`然后做`return LeArray;`

# javascript - 创建列表时创建多个项目，例如在 Ranker.com 上

> ID：11705093
> 
> 赞同：2
> 
> 时间：2012-07-28T22:17:35.100
> 
> 标签：javascript, jquery, list

我需要在[Ranker.com](http://www.ranker.com/)上创建一个用户可以创建列表的表单。我的问题是我不能添加多个项目。

我尝试`.clone().appendTo()`使用 div，但是当他们创建新 div 时，我在“新项目”输入中插入的标题重复，并且我有 2-3 个 div，标题来自第一个 + 另一个文本。 [这是 Jsfiddle.net 的链接](http://jsfiddle.net/bLsYS/)

[我找到了解决这个问题的方法。请参阅[jsfiddle.net](http://jsfiddle.net/br_v/eGWpX/1/)]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:23:27.070

您可能只想生成一个新文本框而不是使用 clone()，因为 clone 会克隆整个内容（文本框的值、名称、id 和您能想到的任何属性）。要生成一个新的文本框，您可以使用以下代码：

```
var new_txt = $('<input>').attr({'type' : 'text'}); 
```

您可以通过用逗号分隔每个属性来为输入分配更多属性：

```
$('<input>').attr({'type' : 'text', 'name' : 'something'}); 
```

为了实现您想要做的事情，您需要一个容器，您将在其中附加新生成的文本框。

```
<div id="container">
    <input type="text" id="txt_item"/>
</div> 
```

然后只需使用 live() 方法，以便每次用户在文本框上按 enter 时都会生成一个新文本框：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
$('input[type=text]').live('keydown', function(e){
    var new_txt = $('<input>').attr({'type' : 'text'});
    if(e.keyCode == 13){//If user press enter
        new_txt.appendTo('#container').focus(); //append then focus to new textbox
    }
});
</script> 
```

如您所见，这是一个非常简单的示例，但您可能可以从这里获取它。祝你好运！

# sql-server - MVC 和 SQL Server Compact

> ID：11705094
> 
> 赞同：1
> 
> 时间：2012-07-28T22:17:37.403
> 
> 标签：sql-server, asp.net-mvc

我已右键单击 App_Data 并添加了一个新的 SQL Server Compact 本地数据库。我现在创建了一个名为 Customer 的表，其中包含一个字段 - 名称。

在 MVC 应用程序的哪个部分，即控制器、模型或视图中，我将数据发送到 SQL Server 以及我如何实际发送数据本身？如何连接到新建的数据库？

我已经调用了数据库 MyDB.sdf

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T18:38:32.387

我使用 App.config 文件使用 connectionString 指定数据库名称。这连接到我在 SQL Server Management Studio 中创建的 SQL Server 数据库。

# php - 如何将连接对象传递给闭包

> ID：11705105
> 
> 赞同：0
> 
> 时间：2012-07-28T22:18:40.153
> 
> 标签：php, mysql

我有以下代码来转义发布的数据：

```
if (isset($_POST['submitted'])) {
    $trimmed_post = array_map('trim', $_POST);

    $bk = mysqli_real_escape_string($dbc, $trimmed_post['bk_id']);
    $ad = mysqli_real_escape_string($dbc, $trimmed_post['address']);
    $ti = mysqli_real_escape_string($dbc, $trimmed_post['bkTitle']);
    $ta = mysqli_real_escape_string($dbc, $trimmed_post['tags']);
    $de = mysqli_real_escape_string($dbc, $trimmed_post['description']); 
```

但我更愿意这样做 - 它更整洁：

```
list($bk, $ad, $ti, $ta, $de) = array_map(function ($x) {
    return mysqli_real_escape_string($dbc, $x);
}, $trimmed_post); 
```

我正在使用 MySql 5.5.16，但它返回“未定义的变量：dbc”。

我怀疑这是一个“关闭”问题。如何将 $dbc 传递给我的 lambda pl？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T22:20:05.060

您可以使用`use`关键字。

```
list($bk, $ad, $ti, $ta, $de) = array_map(function ($x) use ($dbc) {
    return mysqli_real_escape_string($dbc, $x);
}, $trimmed_post); 
```

但老实说，您应该使用**[Prepared Statements](http://il.php.net/manual/en/mysqli.quickstart.prepared-statements.php)**。

# cakephp - Cakephp 路由前缀

> ID：11705107
> 
> 赞同：0
> 
> 时间：2012-07-28T22:18:43.563
> 
> 标签：cakephp, routes

我的应用程序有 3 种与内容不同部分相关的不同布局。我想定义我的 url-s，这样他们就可以在开头的 ex 中扮演角色。“mypage.com/part1/controller/...”。我不知道如何改变路线以使这成为可能。

PS我不想要普通的前缀路由，我的控制器操作的名称会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:03:01.913

阅读以下网址

对于 CakePHP 2.x [http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing](http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing)

对于 CakePHP 1.x [http://bakery.cakephp.org/articles/Frank/2009/11/02/cakephp-s-routing-explained](http://bakery.cakephp.org/articles/Frank/2009/11/02/cakephp-s-routing-explained)

或者

```
Configure::write('Routing.prefixes', array('admin', 'manager'));

$this->connect("/{$prefix}/:plugin/:controller", array('action' => 'index', 'prefix' => $prefix, $prefix => true));
$this->connect("/{$prefix}/:plugin/:controller/:action/*", array('prefix' => $prefix, $prefix => true));
Router::connect("/{$prefix}/:controller", array('action' => 'index', 'prefix' => $prefix, $prefix => true));
Router::connect("/{$prefix}/:controller/:action/*", array('prefix' => $prefix, $prefix => true)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-13T05:52:20.963

在 cakephp 中将多个前缀与路由集成非常容易

在 cakephp 2.x 中，您必须执行以下步骤

1.  转到 app/Config/core.php 并添加以下行 Configure::write('Routing.prefixes', array('admin','manager'));
2.  现在你必须为此编写路由到 app/Config/routes.php 添加以下行
3.  Router::connect("admin/:controller",array('action'=>'index','admin'=>true));
4.  Router::connect("admin/:controller/:action/*",array('admin'=>true));
5.  Router::connect("manager/:controller",array('action'=>'index','manager'=>true));
6.  Router::connect("manager/:controller/:action",array('manager'=>true));

有关更多信息，请参阅以下链接 [http://book.cakephp.org/2.0/en/development/routing.html](http://book.cakephp.org/2.0/en/development/routing.html) [http://miftyisbored.com/complete-tutorial-admin-routing-cakephp/](http://miftyisbored.com/complete-tutorial-admin-routing-cakephp/)

# java - 标点符号的正则表达式

> ID：11705112
> 
> 赞同：30
> 
> 时间：2012-07-28T22:19:45.583
> 
> 标签：java, regex, string

所以我对*正则表达式*完全陌生，我正在尝试使用 Java`java.util.regex`在输入字符串中查找标点符号。我不知道我可能会提前得到什么样的标点符号，除了 (1) !, ?, ., ... 都是有效的标点符号，以及 (2) "<" 和 ">" 意味着一些特殊的东西，并且不要算作标点符号。程序本身会伪随机地构建短语，我想在它通过随机过程之前去掉句子末尾的标点符号。

我可以用任何标点符号匹配整个单词，但匹配器只给我那个单词的索引。换句话说：

```
Pattern p = Pattern.compile("(.*\\!)*?");
Matcher m = p.matcher([some input string]); 
```

将抓住任何以 a`"!"`结尾的单词。例如：

```
String inputString = "It is a warm Summer day!";
Pattern p = Pattern.compile("(.*\\!)*?");
Matcher m = p.matcher(inputString);
String match = inputString.substring(m.start(), m.end()); 
```

结果 --> 字符串匹配 ~ "day!"

但我只想有`Matcher`索引`"!"`，所以我可以把它分开。

我可能会提出案例，并使用`String.substring(...)`我可能得到的每种标点符号，但我希望我在使用正则表达式时会出现一些错误。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-28T23:12:39.373

Java 确实以迂回的方式支持 POSIX 字符类。对于标点符号，**[:punct:]**的 Java 等价物是**\p{Punct}**。

详情请参阅以下[链接](http://www.regular-expressions.info/posixbrackets.html)。

这是一个使用评论中的表达式的具体工作示例

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RegexFindPunctuation {

    public static void main(String[] args) {
        Pattern p = Pattern.compile("\\p{Punct}");

        Matcher m = p.matcher("One day! when I was walking. I found your pants? just kidding...");
        int count = 0;
        while (m.find()) {
            count++;
            System.out.println("\nMatch number: " + count);
            System.out.println("start() : " + m.start());
            System.out.println("end()   : " + m.end());
            System.out.println("group() : " + m.group());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-07-28T22:24:12.937

我会尝试类似的字符类正则表达式

```
"[.!?\\-]" 
```

`[]`在s中添加您希望匹配的任何字符。小心转义任何可能对正则表达式解析器具有特殊含义的字符。

然后，您必须使用 using 遍历匹配项，`Matcher.find()`直到它返回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-11T13:29:14.563

我会尝试

> `\W`

它匹配任何非单词字符。这包括空格和标点符号，但不包括下划线。相当于 [^A-Za-z0-9_]

# python - 输出文件中的垃圾字符（智能引号等）

> ID：11705114
> 
> 赞同：1
> 
> 时间：2012-07-28T22:20:09.287
> 
> 标签：python, mysql, vim, encoding, smart-quotes

我正在使用 python 从 mysql 数据库中读取一堆字符串，经过一些处理后，将它们写入 CSV 文件。但是，我看到 csv 文件中出现了一些完全垃圾的字符。例如，当我使用 gvim 打开 csv 时，我会看到`<92>`、`<89>`等字符`<94>`。

有什么想法吗？我尝试在写入 csv 之前执行 string.encode('utf-8') 但这给出了一个错误`UnicodeDecodeError: 'ascii' codec can't decode byte 0x93 in position 905: ordinal not in range(128)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:30:09.667

`UnicodeDecodeError`意味着您正在尝试对字节进行编码，即 Python 2 首先尝试将其解码为 Unicode，然后使用指定的编码对其进行编码：

```
>>> b"€".encode('utf-8')
Traceback (most recent call last):
  File "<input>", line 1, in <module>
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 0: 
ordinal not in range(128) 
```

如果数据是文本（不是图像等固有的二进制数据）；您应该使用 Unicode 来处理它。如果您的数据库驱动程序不返回 Unicode，则在收到字节后立即将它们转换为 Unicode。

Python 2 上的 csv 模块仅适用于字节。您可以使用`UnicodeWriter`示例[或](http://docs.python.org/library/csv#examples)类似内容来编写 Unicode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:55:15.730

我最终解决了它。我正在使用 MySQLdb python 模块连接到 mysql。我刚刚使用`charset=utf8`并`use_unicode = True`在创建数据库连接时使用它。此外，我将 MySQL 表的排序规则更改为`utf8_unicode_ci`. 最后，当我将字符串写入 csv 文件时，我使用了：

```
file_pointer.write(my_string.encode('ascii', 'ignore')) 
```

我不知道逻辑有多合理，但这是我在谷歌搜索几个小时后发现的，它似乎对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T17:08:41.760

所有这些“垃圾”字符都在 <80> 到 <9F> 范围内吗？如果是这样，它们很可能是 Microsoft“智能引号”（Windows-125x 编码）。有人在 Word 或 Outlook 中编写文本，然后将其复制/粘贴到 Web 应用程序中。Latin-1 和 UTF-8 都将这些字符视为控制字符，通常的效果是文本显示被截断 (Latin-1) 或者您看到 ?-in-black-diamond-invalid-character (UTF- 8）。

请注意，Word 和 Outlook 以及其他一些 MS 产品提供了 UTF-8 版本的文本供剪贴板使用。代替 <80> 到 <9F> 代码，智能引号字符将是正确的多字节 UTF-8 序列。如果您的网页是 UTF-8 格式，您通常应该得到一个正确的 UTF-8 字符，而不是 Windows-125x 编码中的智能引号。另请注意，这不是保证行为，但“似乎非常一致地工作”。这一切都取决于文本的 UTF-8 版本是否可用，并且处理得当（例如，您没有粘贴到 PC 上的 gvim 中，然后复制/粘贴到 Web 文本表单中）。这也适用于各种 PC 应用程序，只要它们正在寻找 UTF-8 编码的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-20T21:06:08.580

您可以在 vim 中修复这些问题。例如，要处理 <92> （这是单引号），做

```
:1,$s/CNTRL-V x 92/'/g 
```

所以你输入 CNTRL 然后 V 然后 x 然后 92 （没有空格）。你会看到它就像

```
:1,$s/<92>/'/g 
```

# arrays - NodeJS - 如何从模块返回数组

> ID：11705115
> 
> 赞同：0
> 
> 时间：2012-07-28T22:20:28.203
> 
> 标签：arrays, node.js, module, export, return

我有一个名为“userinfo.js”的模块，用于从数据库中检索有关用户的信息。这是代码：

```
exports.getUserInfo = function(id){
db.collection("users", function (err, collection) {
    var obj_id = BSON.ObjectID.createFromHexString(String(id));
    collection.findOne({ _id: obj_id }, function (err, doc) {
        if (doc) {
            var profile = new Array();
            profile['username']=doc.username;
            return profile;
        } else {
            return false;
        }
    });
});
} 
```

从 index.js（索引页面的控制器，我试图从中访问用户信息）以这种方式：

```
var userinfo = require('../userinfo.js');

var profile = userinfo.getUserInfo(req.currentUser._id);
console.log(profile['username']); 
```

节点返回给我这样一个错误：

```
console.log(profile['username']);   -->     TypeError: Cannot read property 'username' of undefined 
```

我做错了什么？提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-28T22:37:12.407

您返回`profile['username']`的不是`profile`数组本身。

你也可以 return `false`，所以你应该`profile`在访问它之前检查。

编辑。再看一遍，你的 return 语句在回调闭包中。所以你的函数返回未定义。一种可能的解决方案，（保持节点的异步性质）：

```
exports.getUserInfo = function(id,cb){
db.collection("users", function (err, collection) {
    var obj_id = BSON.ObjectID.createFromHexString(String(id));
    collection.findOne({ _id: obj_id }, function (err, doc) {
        if (doc) {
            var profile = new Array();
            profile['username']=doc.username;
            cb(err,profile);
        } else {
            cb(err,null);
        }
    }); 
```

}); }

```
 var userinfo = require('../userinfo.js');

    userinfo.getUserInfo(req.currentUser._id, function(err,profile){

      if(profile){
       console.log(profile['username']);
      }else{
       console.log(err);
      }
}); 
```

# php - 使用mysql计算大表的最快方法是什么

> ID：11705124
> 
> 赞同：0
> 
> 时间：2012-07-28T22:22:26.787
> 
> 标签：php, mysql

我发现很难确定什么是从由 where 语句过滤的表中计算某些特定记录的最快方法是我的代码，以下是查询：

```
$type_mo3ln_malk = mysql_num_rows(mysql_query("SELECT * FROM `tableshow` $weress AND mo3ln_type='malk'"));
$type_mo3ln_mswg = mysql_num_rows(mysql_query("SELECT * FROM `tableshow` $weress AND mo3ln_type='mswg'"));
$type_mo3ln_mktb = mysql_num_rows(mysql_query("SELECT * FROM `tableshow` $weress AND mo3ln_type='mktb'"));
$type_mo3ln_wkeel = mysql_num_rows(mysql_query("SELECT * FROM `tableshow` $weress AND mo3ln_type='wkeel'"));
$type_mo3ln_no = mysql_num_rows(mysql_query("SELECT * FROM `tableshow` $weress AND mo3ln_type='0'")); 
```

进行计数的函数是在 php 中预定义的函数

我正在考虑使用 count() 函数，但我想知道是否可以将 Sum 函数仅用于某些特定行，正如 Mr.Hates 在此处建议的那样 [Get record counts for all tables in MySQL database](https://stackoverflow.com/questions/286039/get-record-counts-for-all-tables-in-mysql-database)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T22:24:42.027

```
SELECT COUNT(*) FROM `table` WHERE `whatever`='whatever'; 
```

将返回一行（而不是超过 9000 行），其中包含基于您设置的规则的正确计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:44:51.890

这应该更快：

```
SELECT COUNT(CASE mo3ln_type WHEN 'malk'  THEN 1 END) AS cnt_mo3ln_malk,
       COUNT(CASE mo3ln_type WHEN 'mswg'  THEN 1 END) AS cnt_mo3ln_mswg,
       COUNT(CASE mo3ln_type WHEN 'mktb'  THEN 1 END) AS cnt_mo3ln_mktb,
       COUNT(CASE mo3ln_type WHEN 'wkeel' THEN 1 END) AS cnt_mo3ln_wkeel,
       COUNT(CASE mo3ln_type WHEN '0'     THEN 1 END) AS cnt_mo3ln_no
FROM   tableshow
WHERE  mo3ln_type IN ('malk', 'mswg', 'mktb', 'wkeel', '0') 
```

`SELECT`这将在一个单独的语句中而不是五个单独的语句中获得所有计数。

`mo3ln_type`如果您在列上设置了索引，则该`WHERE`子句应该会很快缩小您的行，然后只需有条件地在`COUNT()`.

如果将每个都表示`mo3ln_type`为整数而不是字符串，则速度会更快，因为对数字的比较要快得多。也许您可以创建另一个表来存储不同的`mo3ln_types`和在`tableshow`表中，只是有一个对 INT 主键的外键引用，`mo3ln_types`而不是实际的文本字符串。（例如`WHERE mo3ln_type_id IN (1, 2, ...)`，而不是`WHERE mo3ln_type IN 'malk', 'mswg', ...)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-28T22:47:56.553

您可以使用`count(*)`：

```
SELECT COUNT(*) FROM <table_name> WHERE <where_clause>; 
```

或者（例如，如果您进行分页）使用`SQL_CALC_FOUND_ROWS`，如果您还想进行查询：

```
SELECT SQL_CALC_FOUND_ROWS * FROM <table_name> WHERE <clause> LIMIT 0, 10;
SELECT FOUND_ROWS(); 
```

更多信息：[MySql 信息函数 -> FOUND_ROWS()](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

如果您只想获取计数，请使用 SUM 函数：

```
SELECT SUM(CASE WHEN mo3ln_type = 'malk'  THEN 1 ELSE 0 END) AS malk,
       SUM(CASE WHEN mo3ln_type = 'mswg'  THEN 1 ELSE 0 END) AS mswg,
       SUM(CASE WHEN mo3ln_type = 'mktb'  THEN 1 ELSE 0 END) AS mktb,
       SUM(CASE WHEN mo3ln_type = 'wkeel' THEN 1 ELSE 0 END) AS wkeel,
       SUM(CASE WHEN mo3ln_type = '0'     THEN 1 ELSE 0 END) AS no_type
FROM   tableshow
WHERE  <where_clausw> 
```

更多信息：[MySql 控制流函数 -> CASE 运算符](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#operator_case)，MySql 聚合函数 -> SUM 函数 *

*   dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_sum

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-28T22:30:16.320

数据库的执行工作总是比应用程序层快得多，因此使用`Count(*)`命令从数据库返回计数效率更高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T22:31:32.183

要求数据库计算行数，而不是 PHP。在 SQL 语句中使用 COUNT(*)。

```
function f_count_rows($table, $where='') {
  $result = mysql_query("SELECT COUNT(*) AS nbr FROM `".$table."` ".$where);
  $row = mysql_fetch_assoc($result);
  return $row['nbr'];
}

$type_mo3ln_malk  = f_count_rows("tableshow", $weress." AND mo3ln_type='malk'");
$type_mo3ln_mswg  = f_count_rows("tableshow", $weress." AND mo3ln_type='mswg'");
$type_mo3ln_mktb  = f_count_rows("tableshow", $weress." AND mo3ln_type='mktb'");
$type_mo3ln_wkeel = f_count_rows("tableshow", $weress." AND mo3ln_type='wkeel'");
$type_mo3ln_no    = f_count_rows("tableshow", $weress." AND mo3ln_type='0'"); 
```

# ruby-on-rails - 使用 modal twitter bootstrap 更新表单

> ID：11705128
> 
> 赞同：0
> 
> 时间：2012-07-28T22:23:05.073
> 
> 标签：ruby-on-rails, twitter-bootstrap

我在页面中呈现数据，当我想使用 twitter 引导模式编辑数据并呈现表单时，一切正常，但是当我单击提交按钮时，页面完全刷新。所以我希望当我单击提交按钮时模式关闭并刷新即时渲染的数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:28:57.870

你需要ajax。通常，您附加`:remote => true`到您的表单

为此： <%= form_for(@post, :remote => true) do |f| %> ... <% 结束 %>

请查看[FormHelper](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html)的 API 。

# objective-c - Apple Macho 链接器错误 Xcode

> ID：11705129
> 
> 赞同：1
> 
> 时间：2012-07-28T22:23:16.590
> 
> 标签：objective-c, xcode, class, linker, mach-o

您好我正在创建一个动态表视图，并尝试从存储在其他文件中的方法上传信息。当我尝试测试我是否获得信息时，我得到了 Macho Linker Error

架构 i386 的未定义符号：“_OBJC_CLASS_$_FlickrFetcher”，引用自：MyTableViewController.old 中的 objc-class-ref：未找到架构 i386 的符号

这是我添加的导致问题的代码。

FlickerFetcher.h 这有我的 tableViewController 调用 topPlaces 的方法

```
@interface FlickrFetcher : NSObject

+ (NSArray *)topPlaces;
+ (NSArray *)photosInPlace:(NSDictionary *)place maxResults:(int)maxResults;
+ (NSURL *)urlForPhoto:(NSDictionary *)photo format:(FlickrPhotoFormat)format;

@end 
```

表视图控制器文件。我认为当我懒惰地实例化它时，问题出现在 setter Brain 中，因为代码在我添加它之前工作正常，NSlog 返回 NUll 因为没有对象但它正在工作，然后当我添加 setter 以实例化它时，我得到了男子气概链接器错误。

```
#import "MyTableViewController.h"
#import "FlickrFetcher.h"

@interface MyTableViewController ()
@property (nonatomic, strong) FlickrFetcher* brain;
@end

@implementation MyTableViewController
@synthesize brain= _brain;

 //Error occured after I added this setter
-(FlickrFetcher*) brain
  {
  if (!_brain) _brain= [[FlickrFetcher alloc] init];
   return _brain;
}

- (id)initWithStyle:(UITableViewStyle)style
{
self = [super initWithStyle:style];
if (self) {
    // Custom initialization
    }
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];

//use a class method call since this is a class method
NSLog(@"Class = %@", [self.brain class]);
NSLog(@"Array = %@", [[self.brain class] topPlaces]);

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T00:38:12.530

我发现了这个错误，原来文件 FlickrFetcher 没有编译或在编译列表中，我通过在导航菜单中单击我的项目、在目标下并单击我的应用程序、进入构建阶段然后添加文件来解决此问题在编译源。希望能帮助任何人解决这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-21T15:28:05.073

`objc-class-ref`部分包括您的应用程序使用的类信息。它可以找到`MyTableViewController`，但找不到`FlickrFetcher`课程信息。所以问题是`FlickrFetcher`该类没有添加到编译拱门中。

# unix - 如何从 linux 连接到“winscp only”服务器

> ID：11705130
> 
> 赞同：3
> 
> 时间：2012-07-28T22:23:16.817
> 
> 标签：unix, ssh, ftp, scp, winscp

我收到了对客户服务器的“winscp”访问权限，以检查一些文件。我尝试通过 ssh 连接，但是，我从服务器得到的唯一响应是：

WinSCP：这是文件结尾：0

我尝试使用午夜指挥官 shell 链接、ftp、sftp。我该怎么做才能连接到服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T06:46:53.480

[WinSCP](http://winscp.net/eng/index.php)似乎只支持[安全拷贝](http://en.wikipedia.org/wiki/Secure_copy)、[SFTP](http://en.wikipedia.org/wiki/SSH_file_transfer_protocol)和[FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol)协议。此外，您的[SSH](http://en.wikipedia.org/wiki/Secure_shell)连接结果表明对该服务器的 shell 访问已被禁用。

按可能性排序：

1.  尝试使用正确的客户端（例如[`sftp`](http://linux.die.net/man/1/sftp), [`lftp`](http://linux.die.net/man/1/lftp), [`ftp`](http://linux.die.net/man/1/ftp)），而不是 Midnight Commander - 根据我的经验，`mc`它不像远程服务的正确客户端那样稳定、有用或兼容。

2.  你没有提到尝试过[`scp`](http://linux.die.net/man/1/scp)。`scp`您应该尝试一下，尽管如果仅启用任何服务器我会觉得很奇怪，因为`scp`不允许浏览远程文件-只是复制。

3.  WinSCP 似乎与最新版本的[WINE](http://winehq.com/)[配合得很好](http://appdb.winehq.org/objectManager.php?sClass=application&iId=1285)，该版本可用于大多数 Linux 发行版......

4.  如果一切都失败了，您可以从 Windows 虚拟机甚至真正的 Windows 系统尝试 WinSCP...

# knockout.js - 使用 Slickgrid 淘汰赛的正确方法是什么

> ID：11705131
> 
> 赞同：3
> 
> 时间：2012-07-28T22:23:17.430
> 
> 标签：knockout.js, slickgrid

将 Knockout 与 slickgrid 一起使用，我可以添加一行以正常工作，但我无法让单个属性编辑工作。它抛出这个错误：

```
Uncaught TypeError: Property 'ProductName' of object #<Product> is not a function 
```

所以它与我的 bindingHandler 有关，因为我在我的对象属性上使用 observables，如果我打开并重新评估数据，我只能获得正确的值来显示：

```
 var data = ko.utils.unwrapObservable(settings.data);
    $.each(data, function(index, item) {
        var prop;

        for (prop in item) {
            if (item.hasOwnProperty(prop)) {
                data[index][prop] = ko.utils.unwrapObservable(data[index][prop]);
            }
        }

    });

    var columns = ko.utils.unwrapObservable(settings.columns);
    var options = ko.utils.unwrapObservable(settings.options) || {};
    grid = new Slick.Grid(element, data, columns, options); 
```

编辑功能位于我的 viewModel 上：

```
function ViewModel(data) {
var self = this;

self.gridData = ko.observableArray(data);
self.columns = [
    {
    name: 'Product ID',
    id: 'ProductId',
    field: 'ProductId'},
{
    name: 'Color',
    id: 'ColorName',
    field: 'ColorName'},
{
    name: 'Sku',
    id: 'Sku',
    field: 'Sku'},
{
    name: 'Product Name',
    id: 'ProductName',
    field: 'ProductName'}
];

self.fnTestClickEdit = function() {
    self.gridData()[0].ProductName("Product has been Edited " + new Date());
}; 
```

}

但是看到我在这方面的死胡同，我在这里的实施中是否做了一些公然错误的事情？

这是所有放在一起的jsFiddle：

[http://jsfiddle.net/sbrqB/3/](http://jsfiddle.net/sbrqB/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T19:20:46.037

您可以[查看 KoGrid](https://github.com/ericmbarnard/KoGrid)

根据他们的页面：

> KoGrid 的出现是为了满足我们对为 MVVM/Knockout 风格开发而构建的体面数据网格的需求。它从 SlickGrid 中汲取了大量灵感和架构，但始终是 KO。

我还没有尝试过（并且该项目仍被标记为 alpha），但我想将它集成到您​​的 KO 应用程序中会容易得多。

# css - 我试图解决 CSS 过渡的一个棘手问题。任何人？

> ID：11705132
> 
> 赞同：1
> 
> 时间：2012-07-28T22:23:18.143
> 
> 标签：css, background, css-transitions

我尝试添加 transition:background 1s; 但菜单背景图像由于某种原因没有转换。我在那里做错了什么？

```
#menu{
    padding-top:18px;
    transition:background 1s;
    -moz-transition:background 1s;
}
#menu > li{
    float:left;
    padding-right:5px
}
#menu .last{
    padding-right:0;
}
#menu > li > a{
    width:188px;
    display:block;
    font-size:17px;
    color:#000;
    background:#fff;
    text-transform:uppercase;
    font-weight:400;
    background: url('../images/IMAGE_A.jpg');;
    height:70px;
    line-height:64px;
    border-top:1px solid #555;
    text-align:center;
    border-radius:4px 4px 0 0;
    -moz-border-radius:4px 4px 0 0;
    -webkit-border-radius:4px 4px 0 0;
}
#menu > li > a:hover,#menu > .active > a{
    background:#fff;
    background: url('../images/IMAGE_B.jpg');;
    background-repeat:no-repeat;
    border-color:#7DB112;
}
#menu > li > a span{
    display:block;
    position:relative;
    color:#000;
    font-family:Arial, Helvetica, sans-serif;
    font-size:17px
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:45:27.073

背景尚不支持过渡。图像过渡计划用于 CSS4。现在你只能转换所有谨慎的子属性，如背景颜色、背景大小、背景位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:00:57.600

制作一个精灵图像（通过组合 image_a 和 image_b）并使用图像位置。就像是：

```
#menu{
    padding-top:18px;
}
#menu > li{
    float:left;
    padding-right:5px
}
#menu .last{
    padding-right:0;
}
#menu > li > a{
    transition:background-position 1s;
    -moz-transition:background-position 1s;
    width:188px;
    display:block;
    font-size:17px;
    color:#000;
    text-transform:uppercase;
    font-weight:400;
    background: url('../images/Sprite.jpg');;
    background-position: -200px 0px;
    height:70px;
    line-height:64px;
    border-top:1px solid #555;
    text-align:center;
    border-radius:4px 4px 0 0;
    -moz-border-radius:4px 4px 0 0;
    -webkit-border-radius:4px 4px 0 0;
}
#menu > li > a:hover,#menu > .active > a{
    background:#fff;
    background-position: -600px 0px;
    background-repeat:no-repeat;
    border-color:#7DB112;
}
#menu > li > a span{
    display:block;
    position:relative;
    color:#000;
    font-family:Arial, Helvetica, sans-serif;
    font-size:17px
} 
```

另外，请确保您在与背景图像相同的选择器上设置了过渡属性。

希望能帮助到你。

# java - Effective Java item 19 - 只使用接口定义类型

> ID：11705137
> 
> 赞同：0
> 
> 时间：2012-07-28T22:24:22.137
> 
> 标签：java, interface, dynamic-binding

我有一个实现两个接口的抽象类。我的想法是否正确因为我使用了两个接口，我不能使用任何一个接口来实现动态绑定？原因是如果我要使用其中一个接口，我显然无法从另一个接口调用方法，因为类型系统只允许子类型调用由我用来声明多态变量的接口定义的方法？

因此，我的实际问题是，我只真正使用接口来确保我的抽象类（或子类）肯定提供方法的实现是否可以？这似乎与第 19 条所说的相矛盾——你应该只对类型使用接口（我认为这意味着多态性）。

例子：

```
public interface A{
    public void meth1();
}

public interface B{
    public void meth2();
}

public abstract class C implements A,B{

}

public void DynamicBinding(A aobject){
  //Can only call aobject.meth1();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T22:43:18.943

您可以使用泛型让您的方法采用 A 和 B 类型的参数：

```
public <T extends A & B> void method(T param) {
  param.meth1(); // fine
  param.meth2(); // also fine
} 
```

相关问题[在这里](https://stackoverflow.com/a/1142019/8681)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:39:05.573

当您需要方法时，才`A`可以`A`将其用作对象的类型，如您所说明的那样。同样对于`B`。如果您需要两者的方法，请创建一个新接口：

```
public interface C extends A, B {
} 
```

接口允许`extend`多个接口。

然后，如果您愿意，可以添加一个具有默认实现的抽象类：

```
public abstract class D implements C {
  // implementation details
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T22:57:35.097

你可以做

```
public void DynamicBinding(C cobject){
  c.meth1();
  c.meth2();
} 
```

或更糟糕的变体

```
public void DynamicBinding(A aobject){
if(aobject instanceof C)
      {
          C myC=(C)aobject;
          myC.meth1();
          myC.meth2();

      }
} 
```

无论如何，我喜欢乔恩做得更好。

# javascript - WebKit 及其遗留前缀

> ID：11705144
> 
> 赞同：4
> 
> 时间：2012-07-28T22:25:10.453
> 
> 标签：javascript, css, webkit, vendor-prefix

我正在尝试编译以 WebKit为前缀的**属性，***以及*WebKit 支持/支持的属性，`-apple-`以及它们最终被删除或引入的**版本。** 对他们施加的限制是什么？例如，你能在 中找到它们吗？`-khtml-` ***`document.body.style`***

 ***我想只有像[这个 bug](https://bugs.webkit.org/show_bug.cgi?id=83256)的报告者这样的知情人士才能为我们提供准确的列表。但我更喜欢先在这里问，这样每个人都会从中受益……</p>

开始您的调查的一个好地方是[这个版本](http://trac.webkit.org/changeset/64071)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T12:35:10.380

## 介绍

问题并不像你想象的那么简单。比较受支持的 CSS 属性的“官方”列表的修订版并确定引入或停用它们的修订版是很容易的；但是，对*使用*遗留前缀的支持也取决于 CSS 解析器实现的处理方式。因此，您应该参考下面的时间线和遗留前缀属性的完整列表，以确定在给定的 WebKit 修订中如何处理支持。

## 与遗留属性支持相关的解析器更改时间表

*   [2003 年 5 月 5 日 (r9101)](http://trac.webkit.org/browser/trunk/WebCore/khtml/css/parser.y?rev=9101)：（`-apple`并且简短地说`-moz`！）将被标准化为`-khtml`幕后。
*   [2005 年 8 月 30 日 (r10397)](http://trac.webkit.org/browser/trunk/WebCore/khtml/css/parser.y?rev=10397)：`-webkit`添加为`-khtml`.
*   [2006 年 6 月 14 日 (r13874)](http://trac.webkit.org/browser/trunk/WebCore/css/CSSGrammar.y?rev=13874)：**所有`-webkit` 属性**都将使用旧前缀（即`-apple`并`-khtml`标准化为`-webkit`）。`-webkit`在此版本中，所有剩余的旧前缀都已更新。
*   [2008 年 2 月 19 日 (r30393)](http://trac.webkit.org/browser/trunk/WebCore/css/CSSParser.cpp?rev=30393)：遗留前缀处理从`CSSGrammar.y`.`CSSParser.cpp`
*   [2010 年 7 月 21 日 (r63854)](http://trac.webkit.org/browser/trunk/WebCore/css/CSSParser.cpp?rev=63854)：**不**支持旧前缀，除了`-apple-dashboard-region`和 `-apple-line-clamp`。
*   [2010 年 7 月 26 日 (r64071)](http://trac.webkit.org/browser/trunk/WebCore/css/CSSParser.cpp?rev=64071)：**所有`-webkit` 属性**再次使用旧前缀。（先前的更改已还原。）
*   [2012 年 4 月 10 日 (r113795)](http://trac.webkit.org/browser/trunk/Source/WebCore/css/CSSParser.cpp?rev=113795)：**不**支持旧前缀，除非特别启用。

## 引入/停用的遗留属性和修订列表

[下面的列表是从受支持属性列表](http://trac.webkit.org/log/trunk/Source/WebCore/css/CSSPropertyNames.in?action=follow_copy&mode=follow_copy&rev=&stop_rev=&limit=500)的提交历史记录中收集的。第一个数字是对该属性的支持添加到列表中的版本；第二个是删除它的修订版。属性被重命名和被彻底删除之间没有区别。

[r13874](http://trac.webkit.org/browser/trunk/WebCore/css/CSSPropertyNames.in?rev=13874)中删除的属性在前缀下存在了一段时间`-webkit`，因此遗留前缀可能会继续工作，具体取决于解析器如何处理它们。（有关更多详细信息，请参阅上面的时间线。）

*   **-apple-dashboard-region:** r7588 到 r9101
*   **-苹果线夹：** r6391 到 r9101
*   **-apple-text-size-adjust:** r6805 到 r9101
*   **-khtml-外观：** r9828 到 r13874
*   **-khtml 绑定：** r5967 到 r13874
*   **-khtml-border-horizo​​ntal-spacing：** r5212 到 r13874
*   **-khtml-border-vertical-spacing：** r5212 到 r13874
*   **-khtml-box-align:** r4704 到 r13874
*   **-khtml-box-direction：** r4704 到 r13874
*   **-khtml-box-flex：** r4704 到 r13874
*   **-khtml-box-flex-group:** r4704 到 r13874
*   **-khtml-box-flex-group-transition：** r6758 到 r6802
*   **-khtml-box-lines:** r4704 到 r13874
*   **-khtml-box-ordinal-group：** r4704 到 r13874
*   **-khtml-box-orient：** r4704 到 r13874
*   **-khtml-box-pack：** r4704 到 r13874
*   **-khtml-dashboard-region:** r9101 到 r13874
*   **-khtml-流模式：** r4704 到 r8041
*   **-khtml-font-size-delta：** r8382 到 r13874
*   **-khtml-水平边框间距：** r5200 到 r5212
*   **-khtml-line-break:** r7763 到 r13874
*   **-khtml-line-clamp：** r9101 到 r13874
*   **-khtml-margin-bottom-collapse：** r7362 到 r13874
*   **-khtml-margin-collapse：** r7362 到 r13874
*   **-khtml-margin-start：** r7708 到 r13874
*   **-khtml-margin-top-collapse：** r7362 到 r13874
*   **-khtml-选框：** r5301 到 r13874
*   **-khtml-选框方向：** r5301 到 r13874
*   **-khtml-marquee-increment：** r5301 到 r13874
*   **-khtml-marquee-repetition：** r5301 到 r13874
*   **-khtml-marquee-speed：** r5301 到 r13874
*   **-khtml-选框样式：** r5301 到 r13874
*   **-khtml-match-nearest-mail-blockquote-color:** r8642 到 r13874
*   **-khtml-nbsp-mode:** r7763 到 r13874
*   **-khtml-不透明度：** r4704 到 r5340 *****
*   **-khtml-padding-start：** r7708 到 r13874
*   **-khtml-rtl-ordering：** r12027 到 r13874
*   **-khtml-text-decorations-in-effect:** r8466 到 r13874
*   **-khtml-text-size-adjust:** r9101 到 r13874
*   **-khtml-用户拖动：** r6728 到 r13874
*   **-khtml-user-modify：** r5970 到 r13874
*   **-khtml-user-select：** r6728 到 r13874
*   **-khtml-vertical-border-spacing：** r5200 到 r5212

*****虽然已被弃用，但`-khtml-opacity`- 以及后来`-webkit-opacity`- 直到 CSSProperties.in 在 r85212 中引入对别名的支持之前，解析器才接受[它](http://trac.webkit.org/changeset/85212)`-webkit-opacity`，并且在最新版本中仍然可用。

`-konq`在很早的版本中支持几个前缀属性：

*   **-konq 流模式：** r4 到 r4704
*   **-konq-js-clip：** r798 到 r3695

## 今天的故事

从 r13874 开始，WebKit CSS 解析器简单地将任何遗留前缀规范化为`-webkit`. 本质上，所有`-webkit`带前缀的属性都使用`-apple`or`-khtml`前缀：

```
// If the prefix is -apple- or -khtml-, change it to -webkit-.
// This makes the string one character longer.
if (hasPrefix(buffer, length, "-apple-") || hasPrefix(buffer, length, "-khtml-")) {
    memmove(buffer + 7, buffer + 6, length + 1 - 6);
    memcpy(buffer, "-webkit", 7);
    ++length;
} 
```

（这也解释了为什么你不能遍历这些属性——`document.body.style`那些属性已经被解析器替换为相应的`-webkit`属性。）

Peter Beverloo 建议应该[删除或逐步淘汰](https://bugs.webkit.org/show_bug.cgi?id=42093)对这些属性的支持在短时间内，[所有遗留属性都被禁用](http://trac.webkit.org/browser/trunk/WebCore/css/CSSParser.cpp?rev=63854)，除了`-apple-dashboard-region`and `-apple-line-clamp`，但由于无数的兼容性问题，这在[几天后被恢复了。](http://trac.webkit.org/browser/trunk/WebCore/css/CSSParser.cpp?rev=64071)在较新的[版本](http://trac.webkit.org/browser/trunk/Source/WebCore/css/CSSParser.cpp?rev=113795)中，除非[使用](https://bugs.webkit.org/show_bug.cgi?id=83256). 启用此功能标志后，解析器将允许上述旧行为。`-apple``-khtml`[`ENABLE(LEGACY_CSS_VENDOR_PREFIXES)`](https://bugs.webkit.org/show_bug.cgi?id=83256)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T04:26:01.497

```
if("WebkitAppearance" in document.body.style) {}
if("KhtmlAppearance" in document.body.style) {}
if("MozAppearance" in document.body.style) {} 
```***

# c# - 如何复制列表 无需克隆

> ID：11705146
> 
> 赞同：7
> 
> 时间：2012-07-28T22:25:32.340
> 
> 标签：c#, .net, copy, clone, generic-list

也许我错过了一些微不足道的东西。我有几个`List<T>`s，我需要他们的一个大列表，它是所有其他列表的联合。但我确实希望他们在那个大列表中的引用，而不仅仅是值/副本（不像我通常在 SO 上找到的许多问题）。

例如我有这个，

```
List<string> list1 = new List<string> { "a", "b", "c" };
List<string> list2 = new List<string> { "1", "2", "3" };

var unionList = GetThatList(list1, list2); 
```

假设我得到了我想要的列表`unionList`，那么这应该发生：

```
unionList.Remove("a"); => list1.Remove("a");
unionList.Remove("1"); => list2.Remove("1");

//in other words
//
//unionList.Count = 4;
//list1.Count = 2;
//list2.Count = 2; 
```

为了清楚起见，这通常发生在

```
unionList = list1; //got the reference copy. 
```

但是我该如何处理第二个列表，`list2`添加到`unionList`？

我试过了`Add`，`AddRange`但他们显然是克隆而不是复制。

```
unionList = list1;
unionList.AddRange(list2); //-- error, clones, not copies here. 
```

和

```
foreach (var item in list2)
{
    unionList.Add(item); //-- error, clones, not copies here.
} 
```

**更新：**我想我在问一些没有意义的东西，以及在语言中本质上不可能的东西..

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-28T22:30:46.257

我认为不存在这样的课程。你可以自己实现它。这是一个开始：

```
class CombinedLists<T> : IEnumerable<T> // Add more interfaces here.
                                        // Maybe IList<T>, but how should it work?
{
    private List<List<T>> lists = new List<List<T>>();

    public void AddList(List<T> list)
    {
        lists.Add(list);
    }

    public IEnumerator<T> GetEnumerator()
    {
        return lists.SelectMany(x => x).GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public bool Remove(T t)
    {
        foreach (List<T> list in lists)
        {
            if (list.Remove(t)) { return true; }
        }
        return false;
    }

    // Implement the other methods.
} 
```

下面是一些你可以用来测试它的代码：

```
List<string> list1 = new List<string> { "a", "b", "c" };
List<string> list2 = new List<string> { "1", "2", "3" };
CombinedLists<string> c = new CombinedLists<string>();
c.AddList(list1);
c.AddList(list2);

c.Remove("a");
c.Remove("1");

foreach (var x in c) { Console.WriteLine(x); }
Console.WriteLine(list1.Count);
Console.WriteLine(list2.Count); 
```

删除项目相当简单。但是，如果您尝试将项目插入组合列表中，您可能会遇到问题。并不总是明确定义哪个列表应该接收插入的项目。例如，如果您有一个包含两个空列表的组合列表，并且您在索引 0 处插入一个项目，该项目应该添加到第一个还是第二个空列表？

# html - #! 是什么意思？在一个网站链接中的意思是什么意思？

> ID：11705148
> 
> 赞同：2
> 
> 时间：2012-07-28T22:26:06.313
> 
> 标签：html

> **可能重复：**
> [Facebook 和新 Twitter URL 中的 shebang/hashbang (#!) 是什么？](https://stackoverflow.com/questions/3009380/whats-the-shebang-hashbang-in-facebook-and-new-twitter-urls-for)
> [Hashbang 与 URI 解析](https://stackoverflow.com/questions/6523140/hashbang-versus-uri-parse)

[example.com/index.html 和http://www.example.com/#!stories](http://www.example.com/#!stories)之间有什么区别？我很想了解 #! 的意义是什么！是？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T22:30:44.013

这是一个[URL 片段](http://en.wikipedia.org/wiki/Fragment_identifier)。客户端使用它来指示应如何处理此 URL 上的内容。在大多数情况下，它告诉浏览器寻找页面上某个命名的锚点。有时，使用 Javascript，它用于重新加载页面并允许某些脚本重新运行。在某些情况下，它用于[使 AJAX 应用程序可被 google 抓取](https://developers.google.com/webmasters/ajax-crawling/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T22:29:44.387

in链接`#`是指向.`HTML`

有时这种链接被[jquery](http://jquery.com/)之类的 javascript 框架使用。

# jquery - Jquery 验证插件 - 重置表单的特定部分

> ID：11705153
> 
> 赞同：1
> 
> 时间：2012-07-28T22:26:21.687
> 
> 标签：jquery, knockout.js, jquery-validate

使用淘汰赛，我需要重置某些模板，而不是整个表单。`resetForm()`重置一切。以前有人遇到过这个吗？

我看过[这个帖子](https://stackoverflow.com/questions/5998042/is-there-a-function-in-jquery-validate-that-will-reset-a-single-field-like-reset)。我可能会做类似的事情。看起来它会很快变得非常混乱，有这么多不同的字段和验证规则。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T03:34:29.663

我目前正在开发一个带有淘汰赛和 jquery validate 的项目。我已经确定的一件事是将用户输入分成小节，本质上在同一页面上有多个表单。将它们全部组合在一起，这就是用户看到的总“形式”。

（旁白：我这样做是因为我提交给的 API 与表单/UI/营销部门对用户体验的期望不同。每个`<form>`部分本质上都是不同的 API 输入部分，但营销部门想要能够任意订购用户输入，所以我按类收集它们：

```
<form class="api1">
     ... some inputs
</form>
<form class="api2">
    ... some different inputs
</form>
<form class="api1">
    ... some more inputs
</form> 
```

我通过 Ajax 提交这些（它是一个单页应用程序），所以这样做我并没有真正从标准表单/操作/提交/发布模型中丢失任何东西。但是将其应用于您的情况，您基本上可以去：

```
$("#sectionId form.api1").each(function() {
    $(this).validate().reset();
}); 
```

我可能弄错了语法，我没有在 jQuery validate 上使用重置功能。但是现在我想起来了，如果我这样做的话，我可能可以节省一些代码......

随意发布一些代码，我可以更好地调整我的解决方案来解决您的问题。

# delphi - D7中如何使用CPU窗口进行调试

> ID：11705155
> 
> 赞同：2
> 
> 时间：2012-07-28T22:26:56.277
> 
> 标签：delphi, debugging, delphi-7

我有一个导致 CPU 窗口出现的未知问题。我已经在源中进行了跟踪，以将问题定位到对 MMSYSTEM 的调用：

```
FError := midioutClose(FMidiHandle); 

function midiOutClose; external mmsyst name 'midiOutClose'; 
```

我从来没有精通 CPU 调试器。没有符号，我无法知道它在告诉我什么。

任何人都可以向我指出如何使用调试器的 CPU 窗口来查找此类问题的教程吗？

# ruby-on-rails-3 - rails3-jquery-自动完成

> ID：11705158
> 
> 赞同：2
> 
> 时间：2012-07-28T22:27:34.113
> 
> 标签：ruby-on-rails-3, autocomplete

我在这里关注关于rails3 jquery自动完成的教程[https://github.com/crowdint/rails3-jquery-autocomplete-app 。](https://github.com/crowdint/rails3-jquery-autocomplete-app)一切正常，除了自动完成！

以下是我使用的程序。

1.  在 gemfile 中，我添加了“gem 'rails3-jquery-autocomplete'”
2.  我使用“rails g autocomplete:install”生成了自动完成文件
3.  我下载了 Javascript 文件
4.  我通过 <%= javascript_include_tag 'jquery-1.4.2.min.js', 'jquery-ui-1.8.4.custom.min.js', 'autocomplete-rails.js', ' 在布局中包含了 Javascript 文件rails.js' %> <%= stylesheet_link_tag 'jquery-ui-1.8.4.custom.css' %>
5.  通过 "rails g model Brand name:string" 创建了一个名称为字符串的 Brand 模型，并通过 Brand.create(:name => 'Alpha') 将几个项目添加到 Brand 中。
6.  创建了一个控制器“rails g controller welcome show”，并通过get“welcome/show”root :to =>“welcome#show”编辑了routes.rb
7.  在 app/controllers/welcome_controller.rb 中添加了“autocomplete:brand,:name”
8.  在 config/routes.rb 中添加了“get 'welcome/autocomplete_brand_name'”
9.  在 app/views/welcome/show.html.erb: <%= form_tag do %> <%=autocomplete_field_tag 'name', '', welcome_autocomplete_brand_name_path %> <% end %>

基本上我按照教程中的每一步，除了最后一步（我发现它应该是 autocomplete_field_tag 而不是 text_field_tag 'name）。但是，自动完成功能不起作用。我是 Rails 的新手，为此苦苦挣扎了好几天。任何人都可以对这个问题有所了解吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T12:55:10.640

我遇到了完全相同的问题（Rails 3.2.1 和使用演示应用教程）。我也有更多关于正在发生的事情的信息，这使我找到了解决方案。希望这对你有用！

我的控制台日志显示以下错误：

```
Started GET "/%7B:autocomplete=%3E%22/welcome/autocomplete_brand_name%22%7D?term=Al" for 127.0.0.1 at 2012-09-04 21:38:14 +1000
ActionController::RoutingError (No route matches [GET] "/%7B:autocomplete=%3E%22/welcome/autocomplete_brand_name%22%7D"): 
```

对于ASCII挑战（即我）的代码是

```
%7B {  
%3E >  
%22 "  
%7D } 
```

所以它试图获取的 URI 是

```
/{:autocomplete=>"/welcome/autocomplete_brand_name"}?term=Al 
```

路由器对此不满意。

当您查看呈现的页面 HTML 源代码时，它看起来像：

```
<input data-autocomplete="{:autocomplete=&gt;&quot;/welcome/autocomplete_brand_name&quot;}" id="name" name="name" type="text" value="" /> 
```

这表明 .erb 文件中的参数正在泄漏。我将表单的内容修改为：

```
<%= form_tag do %>
  <%= autocomplete_field_tag 'name', '', welcome_autocomplete_brand_name_path %>
<% end %> 
```

**没有教程中建议的:autocomplete =>**的 IE ，现在它对我有用。您的示例代码显示您已经拥有此功能，因此您可能会遇到以下我也更改过的问题：

在我设法专注于前面的几点之前，我的控制台日志发出了各种关于找不到 .css 和 .js 文件的抱怨。我最终将所有文件从**public/javascripts**和**public/stylesheets**转移到新的**app/assets/javascripts**和**app/assets/stylesheets**，然后修改主**application.js**和**application.css**文件的内容，并且还有主要布局：

*应用程序/资产/样式表/application.css：*

```
*= require_self
*= require jquery-ui-1.8.23.custom
*= require_tree . 
```

*应用程序/资产/javascripts/application.js：*

```
//= require jquery-1.8.0.min
//= require jquery-ui-1.8.23.custom.min
//= require autocomplete-rails
//= require rails
//= require_tree . 
```

如果您的 .js 和 .css 的确切版本号不同，请不要忘记更改我示例中的数字。

最后的更改是删除对**application.html.erb**的建议添加并依赖资产管道（即上述所有要求）。我在主布局中拥有的 .css 和 .js 文件的唯一项目是

*应用程序/视图/布局/application.html.erb：*

```
<%= stylesheet_link_tag 'application' %>
<%= javascript_include_tag 'application' %> 
```

现在我已经掌握了基础知识，我可以重新尝试将它与 HAML、Formtastic 和 nested_forms gem 一起使用！希望这不会影响我的生活。

干杯

PS-教程还说要放

```
gem 'rails', '3.0.0' 
```

但由于您使用的是 Rails 3.2.1，请将其保留为原始版本：

```
gem 'rails', '3.2.1' 
```

最后，漂亮的脚手架生成器并没有完全按照 3.2.1 标准把东西放在正确的位置；将它的文件从 public/javascripts 和 public/stylesheets 转移到 app/assets 子目录中。您必须编辑漂亮的 .css 并将其合并到您可以在 app/assets/stylesheets 中找到的默认文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:11:36.347

我有类似的经历，在 OSX 上使用 Rails 3.2.8，在 Windows 上使用 3.2.9，并在此处遵循自动完成应用程序的教程：

> [https://github.com/crowdint/rails3-jquery-autocomplete-app](https://github.com/crowdint/rails3-jquery-autocomplete-app)

如果我从 github 下载了示例应用程序，它编译并运行良好。如果我按照这些步骤操作，我将无法正常工作。示例应用程序中有很多其他的东西，所以我想要最精简的方式来与之交互。挖掘后，我发现除了按照步骤使事情正常工作之外，还需要进行以下更改。

*   教程要求您将 jquery 和其他 js 文件复制到 public/javascript 中。不。将它们复制到 app/assets/javascript 和 app/assets/stylesheets 下。这个版本的 Rails 正在那里寻找它们，否则你会失败。

*   去除

> `<%= javascript_include_tag :defaults %>`

application.html.erb 文件中的行。它不存在，并且会在加载过程中导致错误。

*   rails 版本是 3.2.9 或 3.2.8，请确保您明确调用它。

> ```
> gem 'rails', '3.2.9' 
> ```

*   确保您将 rails3-jquery-autocomplete 显式版本化为版本 0.6.0，如下所示。

> ```
> source 'https://rubygems.org'
> 
> gem 'rails', '3.2.9'
> 
> # Bundle edge Rails instead:
> # gem 'rails', :git => 'git://github.com/rails/rails.git'
> 
> gem 'sqlite3'
> gem 'rails3-jquery-autocomplete', '0.6.0'
> gem 'nifty-generators'
> 
> # Gems used only for assets and not required
> # in production environments by default.
> group :assets do
>   gem 'sass-rails',   '~> 3.2.3'
>   gem 'coffee-rails', '~> 3.2.1'
> 
>   # See https://github.com/sstephenson/execjs#readme for more supported runtimes
>   # gem 'therubyracer', :platforms => :ruby
> 
>   gem 'uglifier', '>= 1.0.3'
> end
> 
> gem 'jquery-rails' 
> ```

我根本不需要更改 application.js 文件。

> ```
> //
> //= require jquery
> //= require jquery-ui
> //= require jquery_ujs
> //= require_tree .
> // 
> ```

application.html.erb 文件头部分与我从 jqueryui.com 下载的最新 jquery 文件看起来像这样

> ```
>  <head>
>     <title><%= content_for?(:title) ? yield(:title) : "Untitled" %></title>
>     <%= stylesheet_link_tag "application" %>
> 
> <%= javascript_include_tag 'jquery-1.8.2.js', 'jquery-ui-1.9.1.custom.min.js', 'autocomplete-rails.js', 'rails.js' %>
> <%= stylesheet_link_tag 'jquery-ui-1.9.1.custom.css' %>
>     <%= csrf_meta_tag %>
>     <%= yield(:head) %>
>   </head> 
> ```

我遇到的一件小事是 sqlite3 没有在 64 位 Windows 上加载。解决方案是将 sqlite3.dll 复制到 windows/system 目录中。不是 windows 或 windows/system32，也不是路径上的任何地方，不是 ruby​​/bin。

最后，在早期版本的 rails3-jquery-autocomplete 中，支持 text_field_tag。github上的示例使用0.6.0作为这个gem的版本，使用了text_field_tag。对于像 1.0.10 这样的最新版本，支持 autocomplete_field_tag。它们不一样，尽管输入字段的呈现方式相同，但使用错误标签时自动完成功能不起作用。

# sockets - Chrome Socket API：如何创建半开 TCP Socket

> ID：11705160
> 
> 赞同：1
> 
> 时间：2012-07-28T22:28:05.010
> 
> 标签：sockets, google-chrome, tcp, google-chrome-extension, chromium

[Chrome](http://developer.chrome.com/trunk/apps/api_index.html) [Socket API](http://developer.chrome.com/trunk/apps/socket.html)允许*我们*从一个[`disconnect()`](http://developer.chrome.com/trunk/apps/socket.html#method-disconnect)TCP 套接字。*但是，在对方*发送数据包后，我如何决定是否要让套接字**保持半开状态**？谢谢。*`FIN`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T05:16:44.690

如果您收到了一个 FIN 数据包，它充其量是半开的。您只能从您的一端发送数据，而不能接收它，如果对等方完全关闭，您甚至可能无法发送。你必须尝试一下。请注意，由此产生的错误（对等方重置连接）可能会由于缓冲而延迟。*

# xml - ColdFusion - 如何循环通过 XML 输出并添加到结构或数组？

> ID：11705162
> 
> 赞同：1
> 
> 时间：2012-07-28T22:28:12.617
> 
> 标签：xml, loops, coldfusion, struct

我正在尝试创建分会官员及其各自职位的列表。数据来自通过 Web 服务访问的一系列 XML 键/值对（键：Member_Name，值：Joe Member。键：Position_Name，值：总统，等等。）给定章节的每个官员都有自己的 Member_Name 和位置_名称。

我正在使用的 API 只会返回整个对象，因此我设置了一个数组来转换 XML 名称并保存所有内容：

```
<cfset keyValue = xmlSearch(soapBody,"//*[local-name()='KeyValueOfstringanyType']") /> 
```

我的想法是遍历该数组，并且对于键 Member_Name 和 Position_Name 的每个实例，将值添加到结构中：

```
<cfset chapterOfficers=structNew()>
<cfloop index="i" from="1" to="#arrayLen(keyValue)#">
    <cfif keyValue[i].Key.xmlText EQ 'Member_Name'>
        <cfset chapterOfficers.Name=keyValue[i].Value.xmlText>
    </cfif>
    <cfif keyValue[i].Key.xmlText EQ 'Position_Name'>
        <cfset chapterOfficers.Position = keyValue[i].Value.xmlText>
    </cfif>
    <cfif keyValue[i].Key.xmlText EQ 'Term_Name'>
        <cfset chapterOfficers.Term = keyValue[i].Value.xmlText>
    </cfif>
</cfloop> 
```

转储这个结构给我一个漂亮整洁的小表格，上面有一个人的名字、那个人的职位和他们的任期——但只有那个（恰好是 XML 文件中的最后一个条目）。即使添加 i=i+1 也没有任何效果——这几乎就像循环从最后开始，而不是继续。

我尝试了其他向结构添加内容的方法，它*确实*循环遍历所有内容，但键/值对以不相关的顺序出现。我知道结构无论如何都没有排序，但我需要有一些方法来对 XML 输出中的数据进行排序。我还尝试了各种其他循环，尝试将一系列像这样的小结构添加到数组中。它起作用了，但同样，只针对那个人——似乎没有发生实际的“循环”！我可以同时看到我需要的所有信息——所以也许是为了让我做错事？

提前谢谢大家，我很感激任何正确方向的建议或推动！

更新：不知道这是否有帮助，但刚才我在我正在使用的循环中交换了 To 和 From 的值，并将 step 设置为 -1，它给了我列表中的第一个人。但还是没有循环。

更新：谢谢彼得，这是我正在使用的 XML 的一个示例：

```
<b:KeyValueOfstringanyType>
                    <b:Key>Member_Guid</b:Key>
                    <b:Value i:type="d:string">006e1c09-25f9-4178-86de-13c3e63200ce</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Member_Type</b:Key>
                    <b:Value i:type="d:string">Entity</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Member_Name</b:Key>
                    <b:Value i:type="d:string">Member, Joe</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Position_Guid</b:Key>
                    <b:Value i:type="d:string">02ae1c09-5779-4891-8cd1-05cf475cf5af</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Position_Type</b:Key>
                    <b:Value i:type="d:string">CommitteePosition</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Position_Name</b:Key>
                    <b:Value i:type="d:string">President</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Term_Guid</b:Key>
                    <b:Value i:type="d:string">044e1c09-a90b-495f-891f-afa13e653dee</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Term_Type</b:Key>
                    <b:Value i:type="d:string">CommitteeTerm</b:Value>
                 </b:KeyValueOfstringanyType>
                 <b:KeyValueOfstringanyType>
                    <b:Key>Term_Name</b:Key>
                    <b:Value i:type="d:string">2011-2012</b:Value>
                 </b:KeyValueOfstringanyType> 
```

对存档的每个分会官员重复。

更新：这是我想出的代码。它做我想做的事，但是有更好的方法可以做到，我敢肯定......

首先，我从 SOAP 响应中获取结果，“向下钻取”到我需要的级别，然后去掉特定于 xml 的内容并将数据放入一个可用的数组中：

```
<cfset soapBody = xmlParse(cfhttp.fileContent)>
<cfset soapBody = soapBody['s:Envelope']['s:Body'].QueryResponse.QueryResult.Objects.anyType.Fields />
<cfset keyValue = xmlSearch(soapBody,"//*[local-name()='KeyValueOfstringanyType']") /> 
```

然后

```
<cfset chapterOfficers=arrayNew(2)>
<cfset x=1>
<cfset y=1>

<cfloop index="i" from="1" to="#arrayLen(keyValue)#">
    <cfif keyValue[i].Key.xmlText EQ 'Member_Name'>
        <cfset memberName = keyValue[i].Value.xmlText>
        <cfset chapterOfficers[x][y]=#memberName#>
        <cfset y=y+1>
    </cfif>
    <cfif keyValue[i].Key.xmlText EQ 'Position_Name'>
        <cfset positionName = keyValue[i].Value.xmlText>
        <cfset chapterOfficers[x][y]=#positionName#>
        <cfset x=x+1>
        <cfset y=1>
    </cfif>
    <cfif keyValue[i].Key.xmlText EQ 'Member_Guid'>
        <cfset memberGuid = keyValue[i].Value.xmlText>
        <cfset chapterOfficers[x][3]=#memberGuid#>
    </cfif>
</cfloop> 
```

我做了一些其他处理，检查变量的存在等，然后输出官员的姓名和他们各自的职位

```
<cfloop from="1" to="#arrayLen(chapterOfficers)#" index="x">
    <p>
        <cfoutput><a href="OfficerDetail.cfm?sessionGuid=<cfoutput>#URL.sessionGuid#</cfoutput>&memberGuid=<cfoutput>#chapterOfficers[x][3]#</cfoutput>">#chapterOfficers[x][1]#</a></cfoutput><br />
        <cfoutput>#chapterOfficers[x][2]#</cfoutput><br />
    </p>
</cfloop> 
```

我能够将 Member_Guid 添加到数组中并使用它，以便站点访问者可以单击一个人的姓名以查看更多详细信息（公司、电子邮件地址等）。就是这样！你怎么看？再次，非常感谢您抽出宝贵的时间，我真的很感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T16:40:42.487

以下是我可能会如何解决这个问题：

```
<cfset var ChapterOfficers = StructNew()>
<cfset var CurMemberGuid = '' />

<cfloop index="local.CurPair" array=#keyValue#>

    <cfif CurPair.Key.XmlText EQ 'Member_Guid' >
        <cfset CurMemberGuid = CurPair.Value.XmlText />
        <cfset ChapterOfficers[CurMemberGuid] = StructNew() />
    <cfelse>
        <cfset ChapterOfficers[CurMemberGuid][CurPair.Key.XmlText] = CurPair.Value.XmlText />
    </cfif>

</cfloop> 
```

它使用您已完成的现有 XmlSearch，并假定`Member_Guid`始终是第一个键/值对。我使用 var/local 范围假设这是在一个函数内部（它可能应该是），但如果不只是删除它们。

它使用结构，因此特定 GUID 的查找很容易，但不会保留顺序（尽管如有必要，您可以保留一个单独的数组来执行此操作），并且您不必记住哪个数组位置与哪个键匹配。

如果您想根据其他字段进行查找，您还可以将数据转换为查询，如下所示：

```
<cfset var ChapterOfficers = QueryNew('Member_Guid,Member_Type,Member_Name,Position_Guid,Position_Type,Position_Name,Term_Guid,Term_Type,Term_Name')>
<cfset var CurRow = 1 />

<cfloop index="local.CurPair" array=#keyValue#>

    <cfif CurPair.Key.XmlText EQ 'Member_Guid' >
        <cfset QueryAddRow(ChapterOfficers) />
    </cfif>

    <cfset QuerySetCell(ChapterOfficers,CurPair.Key.XmlText,CurPair.Value.XmlText) />

</cfloop> 
```

这样可以维护顺序并使更一般的查找更容易，如果您的主要用途是直接输出到 HTML，也可以使其更容易。

我已经在那里对列键进行了硬编码，但是如果它们可能会更改，您也可以先进行预循环来整理它们。

希望这一切都有意义吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T05:33:44.530

在 Coldfusion 10 或 Railo 4 中，您可以使用[Underscore.cfc 库](http://russplaysguitar.github.com/UnderscoreCF/)来帮助清理您的解决方案：

```
<cfscript>
    soapBody = XmlParse(cfhttp.filecontent);
    fields = xmlSearch(soapBody,"//*[local-name()='Fields']");
    chapterOfficers = _.map(fields, function (field) {
        var officer = {};
        _.each(field.xmlChildren, function (KeyValueOfstringanyType) {
            var key = KeyValueOfstringanyType['b:Key'].xmlText;
            var value = KeyValueOfstringanyType['b:Value'].xmlText;
            officer[key] = value;
        });
        return officer;
    });
</cfscript>

<cfoutput>
<cfloop array="#chapterOfficers#" index="officer">
    <a href="OfficerDetail.cfm?sessionGuid=#URL.sessionGuid#&memberGuid=#officer.Member_Guid#">#officer.Member_Name#</a> 
    #officer.Position_Name#<br />
</cfloop>
</cfoutput> 
```

现在不是更好吗？我不确定您的 SOAP 响应是什么样的，但您应该能够调整 xmlSearch() 以匹配 KeyValueOfstringanyType 的父元素。我还为您删除了所有不必要的 cfoutputs。另外，我建议切换到 JSON 而不是 XML。解析起来要容易得多。

（免责声明：我编写了 Underscore.cfc 库）

# arrays - 如何从每个字符串具有不同长度的数组中获取字符串的特定部分？

> ID：11705165
> 
> 赞同：0
> 
> 时间：2012-07-28T22:28:59.487
> 
> 标签：arrays, string, substr

我有一个字符串数组，它们包含有关对象在 3D 空间中位置的信息。位置用逗号分隔。逗号前的第一个是 x 位置，第二个是 y，第三个是 z。其中一些字符串是：

`string a = "0.95,2.34,0"` `string b = "18.05,5,0"` `string c ="112.1,10,3"` 我想将 0.95 分配给 float xPos，将 2.34 分配给 yPos，将 0 分配给 zPos 等。

我想在 for 循环中为数组中的每个字符串一一做这些。

我不能使用 substr 因为它们的长度不同。如何获取逗号之间的子字符串并将它们放入变量中？

-我使用 C++

PS对不起我的英语不好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:34:11.760

通常`Split()`在大多数语言中都有一种方法。您将在传入字符串上调用该方法，并将其拆分为逗号，然后您将得到一个包含两个字符串的结果数组，每个值一个。将第一个值放在 X 中，将第二个值放在 Y 中。您可能需要一个辅助方法来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:34:22.457

您可以使用正则表达式获取 x、y 和 z 字符串值。然后您可以使用 TryParse 方法将值转换为加倍。

# javascript - 不能修改 DOM 元素的类

> ID：11705171
> 
> 赞同：1
> 
> 时间：2012-07-28T22:30:00.257
> 
> 标签：javascript, html, dom

我在页面中有以下元素：

```
<div class="cl1 cl2"></div>
<div class="cl1 cl2"></div>
<div class="cl1 cl2"></div> 
```

当我运行此代码时：

```
<script>
    var elems = document.getElementsByClassName("cl1");
    for (var i = 0; i < elems.length; i++) {
        console.log(i + ": " + elems[i].className);
    }
</script> 
```

我可以看到：

```
0 cl1 cl2
1 cl1 cl2
2 cl1 cl2 
```

在控制台中。

但是这段代码：

```
<script>
    var elems = document.getElementsByClassName("cl1");
    for (var i = 0; i < elems.length; i++) {
        console.log(i + ": " + elems[i].className);
        elems[i].className = 'cl3'; // or = '' (removing all classes)
    }
</script> 
```

给出：

```
0 cl1 cl2
1 cl1 cl2 
```

在第一次运行时，并且：

```
0 cl1 cl2 
```

在第二次运行。

不修改所有元素的原因是什么？我可以看到`elems.length`当我们触摸时它正在减少`elems[i].className`，但原因是什么？

如果我们放置`var n = elems.length`并更改 for 循环，`i < n`我们将得到`Cannot read property 'className' of undefined`错误。

问题是如何从第一次修改所有类？

因为我相信下面的代码看起来很傻：

```
var elems = document.getElementsByClassName("cl1");
while (elems.length) {
    for (var i = 0; i < elems.length; i++) {
        console.log(i + ": " + elems[i].className);
        elems[i].className = 'cl3';
    }
    elems = document.getElementsByClassName("cl1");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:34:05.200

问题是 items 是一个活动的 NodeList，这意味着每当您访问 items.length 时，都会重新评估该列表。当您删除元素时，列表会变短，但您会保留索引。

您可以先将 NodeList 转换为数组

```
 var items = [].slice.call(doc.getElementsByClassName('foo')); 
```

删除 DOM 元素时，数组大小不会改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:33:30.367

该`getElementsByClassName`函数返回一个 NodeList，而不是一个数组。NodeList 对象是**实时**的——它们跟踪 DOM 的变化。（*编辑*——事实证明，并非所有 NodeList 对象都是活动的，但从该函数返回的对象却是活动的。）

当您更改第一个元素的类时，它不再是元素列表的一部分。因此，当您增加“i”时，您会跳过一个。

您可以将 NodeList 对象转换为数组（请参阅@ama2 的答案），或者您不能更改“i”，因为您正在从选定的集合中删除元素。

# iphone - 在 NSArray 中访问 NSDictionary 的成员项

> ID：11705177
> 
> 赞同：0
> 
> 时间：2012-07-28T22:30:57.023
> 
> 标签：iphone, objective-c, xcode

我对 Flickr API 进行了查询，它返回给我一个包含字典的 NSArray。我想知道我如何能够访问让返回给我的数组的 _content 项。

```
 NSArray *topPlaces = [FlickrFetcher topPlaces];
NSLog(@"%@",topPlaces);

(
    {
    "_content" = "London, England, United Kingdom";
    latitude = "51.506";
    longitude = "-0.127";
    "photo_count" = 3061;
    "place_id" = "hP_s5s9VVr5Qcg";
    "place_type" = locality;
    "place_type_id" = 7;
    "place_url" = "/United+Kingdom/England/London";
    timezone = "Europe/London";
    woeid = 44418;
},
    {
    "_content" = "New York, NY, United States";
    latitude = "40.714";
    longitude = "-74.007";
    "photo_count" = 1886;
    "place_id" = ".skCPTpTVr.Q3WKW";
    "place_type" = locality;
    "place_type_id" = 7;
    "place_url" = "/United+States/New+York/New+York";
    timezone = "America/New_York";
    woeid = 2459115;
},
    {
    "_content" = "Weston-Super-Mare, England, United Kingdom";
    latitude = "51.346";
    longitude = "-2.977";
    "photo_count" = 945;
    "place_id" = HWdHmQdVUrptMA;
    "place_type" = locality;
    "place_type_id" = 7;
    "place_url" = "/United+Kingdom/England/Weston-Super-Mare";
    timezone = "Europe/London";
    woeid = 40016;
}, 
```

)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:34:43.127

像这样遍历 NSArray

```
for (NSDictionary *dictionary in topPlaces) {
    NSLog(@"%@", [dictionary objectForKey:@"_content"]);
} 
```

# wicket - 在检票口中处理视觉富文本编辑器上的 onchange 事件

> ID：11705181
> 
> 赞同：0
> 
> 时间：2012-07-28T22:31:57.260
> 
> 标签：wicket

出于某种原因，我无法处理 wicket 中视觉 Richetexteditor 组件的 onchange 事件，我在 textarea 上做同样的事情，但同样不适用于 rte，请有人帮忙。

registerInstitutionPanel.getrteInstitutionForm().getRte() .add(new AjaxFormComponentUpdatingBehavior("onchange") {

```
 @Override
                protected void onUpdate(AjaxRequestTarget target) {
                    message = registerInstitutionPanel.getInstDescription();
                    dynamicDisplay.setOutputMarkupId(true);
                    target.addComponent(dynamicDisplay);
                }
            }); 
```

我正在使用消息作为字符串来使标签动态化，当我将数据输入到我的 Richtexteditor 中时，我应该在 div 中包含的标签（aspan）中看到它（dynamicDisplay）是一个 webmarkupcontainer，其中包含我的显示跨度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T11:04:02.527

这里是 visural-wicket 的作者 - 不幸的是，当前版本的库中的 RTE 组件不支持此功能。大多数富文本编辑器组件隐藏底层文本区域并用新组件（富文本编辑器）替换它，并且内容仅在表单提交时与占位符组件同步。

我只能建议您考虑集成您自己的 Javascript 编辑器。我使用的库是[http://nicedit.com/](http://nicedit.com/)

鉴于 visural-wicket 是根据 Apache 2.0 许可证获得许可的，欢迎您将其用作起点，如果您添加诸如此之类的有用功能，请务必回馈。

# objective-c - 分配时如何使用字符串变量代替类名

> ID：11705183
> 
> 赞同：0
> 
> 时间：2012-07-28T22:32:04.980
> 
> 标签：objective-c, ios

我的应用程序在界面中声明了大量视图控制器，例如：

```
ViewController_1_0 *viewController_1_0
ViewController_1_1 *viewController_1_1
ViewController_1_2 *viewController_1_2
etc ... 
```

（我意识到下划线对于类名来说不是一个好的 Cocoa 编码约定，并且会改变它。）

我的意图是根据当前的 UIStepper 值呈现适当的控制器视图。

而不是对每个步进器值进行条件测试，然后使用“硬编码”视图控制器执行控制器对象的单独延迟实例化，我试图让代码出现一次，使用基于当前步进器值构造的字符串。

我已经弄清楚（在[使用存储在变量中的类名来调用类方法的帮助下？](https://stackoverflow.com/questions/10050517/use-a-class-name-stored-in-a-variable-to-call-a-class-method)）如何设置类名：我已经声明了一个属性：

```
@property(strong, nonatomic) Class classStringClass; 
```

然后在为类构造变量字符串之后，我这样做：

```
classStringClass = NSClassFromString(classString); 
```

其中 classString 是使用 stepper 值构造的字符串，例如等效于 ViewController_1_0。

我还为 ivar 声明了一个属性：

```
@property (strong, nonatomic) NSString *classInstanceString; 
```

因此我这样做：

```
if(!classInstanceString) {
   classInstanceString = [[classStringClass alloc] initWithNibName:classString bundle:nil];
} 
```

我被卡住的地方是如何为控制器的 ivar 编写代码，即 classInstanceString 构造为与接口中声明的 ivar viewController_1_0 （或任何基于步进值的值）等效。一旦我摆脱了惰性实例化 if 语句，然后代码访问 classInstanceString 的属性，例如：

```
classInstanceString.view.hidden = NO; 
```

可以理解，classInstanceString 会收到错误“在 'NSString' 类型的对象上找不到属性 'view'”。

如何声明“classInstanceString”（或另一个变量，比如包含 classInstanceString 值的“classInstanceVariable”），以便在实例化它时，它是 classStringClass 的 ivar 并且可以访问类属性，以便在类的实例化之后使用？我推测它应该是与 NSString 不同的类型，但那会是什么类型，或者有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:47:24.030

如果你只需要基本的 UIViewController 变量，你总是可以将它转换为 UIViewController。

```
UIViewController *vc = (UIViewController *)[[classStringClass alloc] initWithNibName:classString bundle:nil];

[vc view];// works! 
```

或者，如果您需要自定义 ivars，最好将它们都扩展为这样的基类（或协议）：

```
MyBaseViewController *vc = (MyBaseViewController *)[[classStringClass alloc] initWithNibName:classString bundle:nil];

[vc customVar]; //works 
```

# java - 使用动态上下文更新挂毯区域

> ID：11705192
> 
> 赞同：0
> 
> 时间：2012-07-28T22:33:03.497
> 
> 标签：java, ajax, tapestry, zone

我试图弄清楚如何使用动态的、客户端驱动的“上下文”来更新挂毯区域。我对挂毯相当陌生，我现在坚持使用 5.0。

这样做的主要原因是重用另一个 Tapestry 组件作为 jquery 对话框的子组件，而不必重写 Tapestry 组件。

一个障碍是该区域以及控制它的任何元素最终都在一个 jquery 对话框中。$jquery(...).dailog() 倾向于将元素的 html 剪切/粘贴到另一个位置，这可能会破坏某些东西。但是，即使在 jquery 对话框之外，我也无法让事情正常进行。

这是我尝试过的，似乎没有用（也许我做错了）：

*   创建一个绑定到区域的事件链接，并修改 href。Tapestry 似乎使用存储在某处的变量而不是*sigh*。
*   创建 at:form 绑定到区域。当我尝试更新它时，我可以知道正在发生服务器端事件，但挂毯区域没有按应有的方式更改或更新。该区域位于外部并与表格分开。更新区域时，我什至看不到典型的黄色闪烁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:34:48.957

我找到了一些几乎可以解决我的问题的示例代码；它没有工作，但是当我在这里输入问题时，我看到了问题所在。因为很可能其他人也遇到了这个问题，所以我在这里发布一个答案：

```
 var zoneId = "itemZone"; // tml was <t:zone id="itemZone"...>
        var zoneObject = Tapestry.findZoneManagerForZone(zoneId);
        zoneObject.updateFromURL(url); 
```

要解决 jquery .dialog() 移动 html 的问题，我还必须像这样复制和保存区域管理器：（其中 $J(...) 是我对 jquery 的缩写，以避免原型冲突）

```
 prototypeStorageObj = $T("itemZone");
    zoneManager = prototypeStorageObj.zoneManager;
    // jquery stuff that kills the prototype data storage.
    emailForm = $J("#myDialog");
    emailForm.dialog({ autoOpen: false, modal:true });
    emailForm.dialog('open');
    // restore the zone manager so the zone works again:
    $T("itemZone").zoneManager = zoneManager; 
```

# iis-7 - 请求 Sitecore 页面返回 IIS 404

> ID：11705194
> 
> 赞同：1
> 
> 时间：2012-07-28T22:33:07.027
> 
> 标签：iis-7, sitecore, sitecore6

我在 Sitecore 中请求一个页面，然后我从 IIS 得到一个 404。该网站适用于我的开发环境和登台。这是在生产机器上，这是一个新安装。我从来没有真正看到过它的工作。它给我一个 IIS 404（而不是 Sitecore 404）这一事实似乎表明 Sitecore 使用的任何处理程序都没有被识别或没有正确设置。对于从哪里开始寻找或问题可能是什么，我将不胜感激。

我们在 II7 中以经典模式运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T08:04:47.373

这听起来像是权限问题，请检查网络服务（或应用程序池标识）是否具有对所有 Sitecore 文件夹的正确访问权限。

这看起来像是一个相当不错的指南：

[Sitecore 文件夹和 IIS 权限](https://stackoverflow.com/questions/5156374/sitecore-folder-iis-permissions)

您还可以尝试导出用于生产和暂存的 IIS 设置，并比较两者以确保设置没有任何异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T18:04:24.393

您是否尝试过运行安装程序？如果您正在清理其他人的安装，则不知道他们做了什么……重新开始要容易得多。您可以轻松连接到现有数据库，或者在您拥有一个运行良好的 Sitecore 实例后安装包含所有内容的软件包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T07:37:55.130

如果我在经典模式下运行 Sitecore，我也会遇到同样的问题。为什么不尝试在集成模式下运行，让所有处理程序正常工作？您的 Sitecore 登录页面正常工作，这表明您已正确解压缩 Sitecore 文件夹。我建议您尝试集成模式。

# c++ - 类成员容器迭代器在成员函数 std::find 中不兼容，但为什么不兼容呢？

> ID：11705199
> 
> 赞同：1
> 
> 时间：2012-07-28T22:33:42.793
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012

我遇到了一些我似乎无法理解的行为。假设我有一个定义如下的类（一个简单的示例）：

```
class some_class
{
   public:
        some_class()
        {
            x_["0"] = "0";
            x_["1"] = "1";

            y_[0] = x_.find("0");
            y_[1] = x_.find("1");
        }

        int some_function(int i)
        {
            if(std::find(y_.begin(), y_.end(), x_.find("1")) != y_.end())
            {
                std::cout << "Found!" << std::endl;

                return 1001;
            }

            return -1001;
        }

   private:
       std::unordered_map<string, string> x_;
       std::array<unordered_map<string, string>::iterator, 2> y_;
}; 
```

*代码在调试模式下*使用 Visual Studio 2012 RC 编译（其他模式未测试），但在调用**some_function**期间程序失败并显示以下断言消息

> ... 微软视觉工作室 11.0\vc\include\list 行：289
> 
> 表达式：列表迭代器不兼容...

调用代码如下所示

```
auto vector<int> as;
as.push_back(1);   

auto vector<int> bs;   
auto some = some_class();

std::transform(as.begin(), as.end(), std::inserter(bs, bs.begin()), [=](int i) { return  some.some_function(i); }); 
```

### 问题：

这种安排会有什么问题？如果我在**some_function中声明****x_**和**y_**而不是作为成员变量，我可以让代码运行良好。**该类在std::transform**之类的情况下被调用/使用，如果这应该考虑到这种情况的话。

 ****^(顺便说一句，看起来下面的声明将被编译器拒绝，它应该被拒绝吗？)

```
std::unordered_map<string, string> x_;
std::array<decltype(x_.begin()), 2> y_; 
```

错误信息是

> 错误 C2228：'.begin' 左侧必须有类/结构/联合

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:56:27.060

你的情况。

```
#include <unordered_map>
#include <array>
#include <iostream>
#include <string>

class some_class
{
   public:
        some_class()
        {
            x_["0"] = "0";
            x_["1"] = "1";

            y_[0] = x_.find("0");
            y_[1] = x_.find("1");
        }

        int some_function()
        {
            if(std::find(y_.begin(), y_.end(), x_.find("1")) != y_.end())
            {
                std::cout << "Found!" << std::endl;

                return 1001;
            }

            return -1001;
        }

   private:
       std::unordered_map<std::string, std::string> x_;
       std::array<std::unordered_map<std::string, std::string>::iterator, 2> y_;
};

void function(some_class cl)
{
    cl.some_function();
}

int main()
{
    some_class c;
    function(c);
} 
```

您`iterators`对 another 元素的积分`map`，存储在`this`after`copy-ctor`中，并且在`find`里面进行比较。

```
 bool operator==(const _Myiter& _Right) const
        {   // test for iterator equality
 #if _ITERATOR_DEBUG_LEVEL == 2
        if (this->_Getcont() == 0
            || this->_Getcont() != _Right._Getcont())
            {   // report error
            _DEBUG_ERROR("list iterators incompatible");
            _SCL_SECURE_INVALID_ARGUMENT;
            } 
```

对于 decltype -

```
std::unordered_map<string, string> x_;
std::array<decltype(x_.begin()), 2> y_; 
```

中不正确`class-block`，因为没有对象。如果`x_`会，这将有效`static`。****

# ruby-on-rails - rails3 在视图末尾显示所有记录

> ID：11705202
> 
> 赞同：1
> 
> 时间：2012-07-28T22:33:52.283
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的 rails 3.2.6(ruby 1.9.3) 应用程序中有一个索引操作。在视图中，我只是循环遍历数据库中的所有记录。当我在浏览器中点击索引操作时，它会将数据库中存在的所有记录显示为页面末尾的数组，任何指针可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:39:44.480

查看您的视图的代码将有很大帮助。我的猜测，您可能会打印出`each`调用的值。`each`在遍历所有元素后返回数组。如果您使用的是 erb，下面应该可以工作：

改变

`<%= @records.each do |record| %>`

到

`<% @records.each do |record| %>`

# android - 在 Android 原生活动中绘制文本

> ID：11705206
> 
> 赞同：0
> 
> 时间：2012-07-28T22:34:25.980
> 
> 标签：android, opengl-es, android-ndk, native-activity

大家好，

我做了本地活动，我想画一些文字。最简单的方法是什么？我可以通过使用openGL来做到这一点吗？如果可以的话怎么做？

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T15:29:20.953

最简单的方法是使用文本创建纹理并将其渲染（或不渲染）场景。您也可以创建自己的文本引擎，但它更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T06:19:26.147

您将需要在 OpenGL 中编写自己的文本渲染器。如果您有一个有限的字符串列表，则可能更容易将它们全部预先准备在一个纹理中，并将它们渲染为每个单词的单个四边形，否则您可以拥有一个字符图集并且每个字符有一个四边形。或者，您可以利用库来呈现在运行时将文本绘制到缓冲区中，然后将其呈现到四边形。

如果这些都没有意义，我建议你去做一些基本的 OpenGL 教程。谷歌是你的朋友。一个功能非常丰富的字体库是 FreeType： http: [//freetype.sourceforge.net/index2.html](http://freetype.sourceforge.net/index2.html)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-29T02:42:07.357

```
 @Override protected void onDraw(Canvas canvas) {    
    canvas.drawColor(0xffffffff);
    Paint p = new Paint();        
    p.setColor(Color.BLACK);
    p.setTextSize(25);
    int left = 100;
    int top = 200;
    // draws text beginning at pixel 100,200 
    canvas.drawText(" some text ", left, top, p); 
```

# objective-c - 计数 NSMutableArray 时崩溃

> ID：11705216
> 
> 赞同：1
> 
> 时间：2012-07-28T22:37:00.940
> 
> 标签：objective-c, ios, cocoa-touch

我有一个 NSDictionary 包含多个具有相同名称的键。这是结构：

```
Dictionary {

    "Text" => "Blah",
    "Text" => "Blah 2",
    "Text" => "Blah 3"

} 
```

所以有三个同名的键`Text`。我将 的值`Text`放入`NSMutableArray`using 中：

```
NSDictionary *notes = [d objectForKey:@"notes"]; //dictionary above
NSMutableArray *notesA = [notes valueForKey:@"Text"];
NSLog(@"%i", notesA.count); 
```

但是，当我尝试获取数组中的项目数时，它会崩溃并出现以下错误：

```
-[__NSCFString count]: unrecognized selector sent to instance 0x856c110 
```

知道为什么会这样吗？我能够输出`NSMutableArray`并查看它们的值，但无法计算它们。

* * *

这是 XML 文件：

```
<tickets>
 <text>Blah</text>
 <text>Blah 2</text>
 <text>Blah 3</text>
</tickets> 
```

笔记字典输出：

```
(
        {
        text = "Blah";
    },
        {
        text = "Blah 1";
    },
        {
        text = "Blah 2";
    }
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T22:38:27.930

您将 NSStrings 添加为对象，而不是 NSArray。

```
NSDictionary *notes = [NSDictionray dictionaryWithObjectsAndKeys:[NSMutableArray arrayWithObjetcs:@"Blah",@"Blah 2", @"Blah3"],@"Text",nil];

NSMutableArray *notesA = [notes objectForKey:@"Text"];
NSLog(@"%i", [notesA count]); 
```

当我们使用 NSMutableArray 时，这也是有效的：

```
NSDictionary *notes = [NSDictionray dictionaryWithObjectsAndKeys:[NSMutableArray array],@"Text",nil];

NSMutableArray *notesA = [notes objectForKey:@"Text"];
[notesA addObject:@"Blah"];
[notesA addObject:@"Blah 2"];
[notesA addObject:@"Blah 3"];
NSLog(@"%i", [notesA count]); 
```

* * *

顺便提一句：

```
Dictionary {

    "Text" => "Blah",
    "Text" => "Blah 2",
    "Text" => "Blah 3"

} 
```

这不是一个有效的 NSDictionary 结构，因为键必须是唯一的。

你想要的是：

```
Dictionary {
    "Text" => ["Blah", "Blah 2","Blah 3"]    
} 
```

如果您为同一个键设置了多个对象，则较旧的对象将被较新的对象替换。

* * *

当解析器解析门票标签时，它应该创建一个数组，用于添加单个文本。

* * *

```
(
        {
        text = "Blah";
    },
        {
        text = "Blah 1";
    },
        {
        text = "Blah 2";
    }
) 
```

您的笔记对象不是字典。它是一个包含 3 个字典的数组。每个都有一个关键文本和一些 blah 值。

# heroku - Heroku 的计费限制

> ID：11705217
> 
> 赞同：7
> 
> 时间：2012-07-28T22:37:11.160
> 
> 标签：heroku, limit, billing

我开始使用 Heroku，并担心它是否会因为我犯的错误而向我收费。例如，填满超过 5MB 的数据库。那么，有没有办法为 Heroku 或通知系统设置计费限制，以便在我超过价格限制时发送通知？

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:07:07.873

不要这么想。但是heroku只有在你真的注册了一些东西时才会向你收费，比如一个插件，那是非免费的。如果您用完 5 兆的数据库，他们会向您发送一封电子邮件，告诉您您超出了限制，并且会简单地停止对数据库的所有 INSERT 操作。

另一件需要注意的事情是不要让 heroku 控制台超过必要的时间，因为这需要另一个工人并且是计费的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-29T08:59:30.293

所有限制都是软限制。如果超出对数据库计划施加的新行限制，将触发电子邮件通知让您采取行动。

# objective-c - 使用“或”的objective-c

> ID：11705220
> 
> 赞同：-3
> 
> 时间：2012-07-28T22:37:40.817
> 
> 标签：objective-c

如何使用和“或”或你会怎么称呼它

喜欢：

```
 if (n1 'or' n2 'or' n3 'or' n4 'or' n5 == 1){
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:41:55.243

Objective-C中“或”的符号是“||” 所以你的陈述看起来像：

```
if((n1==1) || (n2==1) || (n3==1) || (n4==1) || (n5 == 1))
{
    // do something
} 
```

# c# - 两个模型之间的多重关系

> ID：11705223
> 
> 赞同：4
> 
> 时间：2012-07-28T22:37:54.073
> 
> 标签：c#, entity-framework

我首先使用代码，EF 4.1 是我的 MVC3 应用程序，并且有两个模型，
它们之间有两种关系。以下是引用这些模型的类：

```
 public class Cattle
    {
        public int CattleID { get; set; }
        public int FarmID { get; set; }
        public int SituationID { get; set; }
        public int DiscardID { get; set; }
        public int Stamp { get; set; }
        public string Sex { get; set; }
        public string Condition { get; set; }
        public virtual Farm Farm { get; set; }
        [InverseProperty("Cattles2")]
        public virtual ICollection<Farm> Farms { get; set; }
    }

 public class Farm
 {
    public int FarmID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Cattle> Cattles { get; set; }
    public virtual ICollection<Cattle> Cattles2 { get; set; }
 } 
```

一种关系是一对一或多的，因为一头牛只能在农场中，而一个农场可以包含许多牛。另一个关系是多对多的，牛可以在农场之间转移，我会生成第三个表来使用 Fluent API 存储转移。我还想在新表中插入一个 Date 属性，但不知道该怎么做。这是 OnModelCreating 方法中 FarmContext 中的代码：

```
 modelBuilder.Entity<Catle>()
         .HasMany(c => c.Farms).WithMany(i => i.Catles)
         .Map(t => t.MapLeftKey("CatleID")
             .MapRightKey("FarmID")
             .ToTable("CatleTransfer")); 
```

当我构建项目时，它似乎工作正常，生成的表 Catle 和 Farm 由 FarmInitializer 提供，但在 Catle 的索引页面中缺少一些指向这种关系的信息。它对我来说是空白的。这是获取信息的代码：

```
@Html.DisplayFor(modelItem => item.Farm.Name) 
```

我需要知道我做错了什么，或者是否有更合适的方法来解决该问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T14:25:34.993

在处理多个联接时，您可能需要具体说明关系。

尝试将外键属性添加到您的农场导航属性。

```
[ForeignKey("FarmID")]
public virtual Farm Farm { get; set; } 
```

# android - 匹配两个音频文件

> ID：11705224
> 
> 赞同：7
> 
> 时间：2012-07-28T22:38:16.457
> 
> 标签：android, audio, comparison

我想记录一次狗吠，保存文件并与包含不同类型吠声（警告吠声、哭泣吠声等）的几个文件进行比较。

我怎样才能进行比较以获得匹配？在此类应用程序中要遵循什么流程？

感谢您的小费。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T23:36:44.563

您的问题没有简单的答案。但是，对于初学者，您可能会研究音频指纹识别的工作原理。这篇论文是 shazam 的创建者写的一个很好的开始：

[http://www.ee.columbia.edu/~dpwe/papers/Wang03-shazam.pdf](http://www.ee.columbia.edu/~dpwe/papers/Wang03-shazam.pdf)

我不确定这种方法对狗吠的效果如何，但那里有一些概念可能会被证明是有用的。

要研究的另一件事是 FFT 的工作原理。这是我为音高跟踪编写的代码教程，这是使用 FFT 的一种方法。您正在更多地关注音调和音高如何与给定狗的共振峰结构相互作用。因此，您要导出的参数可能包括基本音高（仅此一项就足以区分呜呜声和其他类型的树皮），以及基本音高与高次谐波的比率，这将有助于确定树皮的攻击性（我我在这里猜测一下）：

[http://blog.bjornroche.com/2012/07/frequency-detection-using-fft-aka-pitch.html](http://blog.bjornroche.com/2012/07/frequency-detection-using-fft-aka-pitch.html)

最后，您可能想对基本的语音识别和语音处理进行一些研究，因为会有一些重叠。维基百科可能足以让您入门。

编辑：哦，此外，一旦您确定了一些用于比较的参数，您将需要一种方法来将您的多个参数与具有多个参数的声音数据库进行比较。我认为 shazam 文章中的技术行不通。您可以尝试的一件事是[Logistic Regression](http://en.wikipedia.org/wiki/Logistic_regression)。还有其他选择，但这可能是最简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T22:24:23.647

我会查看 Google 的开源 lib musicg API：[http ://code.google.com/p/musicg/](http://code.google.com/p/musicg/)

它是 Java，所以它可以在 Android 中运行，它提供了两个音频文件的相似度指标。

# php - 用 PHP 显示多张图片

> ID：11705229
> 
> 赞同：0
> 
> 时间：2012-07-28T22:38:45.417
> 
> 标签：php, mysql, html

我有这个从数据库返回图片的 PHP 脚本。我现在使用循环一次返回 5 张图片，但我认为它们都是重叠的，所以我只看到一张。如何将每张图片移动几个像素以便我可以看到其他图片？

```
<?php
    $mysqli=mysqli_connect('localhost','root','','draftdb');
    if (!$mysqli)
    die("Can't connect to MySQL: ".mysqli_connect_error());

    $param = isset($_GET['rarity']) ? $_GET['loopcount'] :null;

    $stmt = $mysqli->prepare("SELECT display.PICTURE_ID 
    FROM cards  
    INNER JOIN display ON cards.DISPLAY_ID = display.DISPLAY_ID 
    WHERE display.DISPLAY_ID=? AND cards.CARD_TYPE =?" );

    $cardtype='Rare';

    for ($i=0; $i<=5; $i++) 
    {
      $num[$i] = rand(16,30);
       for ($j=0; $j<$i; $j++) 
       {            
          while ($num[$j] == $num[$i])
          {              
             $num[$i] = rand(16,30);   
          }          

                   $displayid= array_shift($num);   

       }   

    $stmt->bind_param("si", $displayid, $cardtype);
    $stmt->execute();
    $stmt->bind_result($image);
    $stmt->fetch();
    header("Content-Type: image/jpeg");
    echo $image; 
    }

    ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:44:23.180

您不能使用 php.ini 来“显示”图像。您可以使用`<img>`标签对 HTML 执行此操作。你所做的是打印原始图像数据，然后告诉浏览器这是一张图片。我不确定如果你这样做并打印多张图像会发生什么，但这取决于浏览器它应该如何处理这个问题。

例如，如果您将它们作为 blob 存储在数据库中，则有时会使用*一张图像完成此操作。*但不是为了展示它们。

如果要合并图像，可以使用 PHP 中的 GD 库来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T22:52:31.320

您只能将一张图片发送到浏览器`Content-Type: image/jpeg`。我可以想到两种发送多张图片的方法。

1.使用[GD](http://php.net/manual/en/book.image.php)制作一张包含所有其他图片的新图片并发送。

2.发送HTML页面而不是图片：

```
<?php 
//some code which gets the images and puts them in an array - $images
?>
<!DOCTYPE HTML>
<html>
<body>
<?php foreach($images as $image):?>
    <img src="data:image/jpeg;base64,<?php echo base64_encode($image);?>"/><br/>
<?php endforeach;?>
</body>
</html> 
```

编辑：似乎浏览器很难快速解析非常大的 HTML 文档，因此如果您有大量或大量图像，最好将它们加载到单独的 HTTP 请求中（`src="image.php?image=xxxx"`）。

# iphone - iOS：覆盖 NSLocale 语言

> ID：11705231
> 
> 赞同：1
> 
> 时间：2012-07-28T22:39:04.087
> 
> 标签：iphone, ios, ios5, nslocalizedstring, nslocale

如果您的应用程序有多种语言的本地化版本，但如果用户未使用任何语言，则应用程序已本地化。
如何设置默认语言？或者在这种情况下定义默认语言的最佳实践是什么？

以下是我试图解决的场景：

*   该应用程序已在 en/fr/es 中本地化，但如果语言区域设置不是 en/fr/es，您如何定义默认值？

*   如果语言区域设置是此 en/fr/es 之一，并且用户想在 NSUserDefaults 上使用不同的语言定义。假设使用英语作为 NSUserDefaults 但想使用应用程序的 fr 本地化版本。有一种方法可以覆盖 NSUserDefaults 上的语言吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T03:59:49.477

在应用程序启动之前编写 NSUserDefaults

问题1：您可以设置您喜欢的顺序如下。

```
[[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@"de", @"en", @"fr", nil] forKey:@"AppleLanguages"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

问题2：强制使用fr

```
[[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@"de", nil] forKey:@"AppleLanguages"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-01T19:10:08.733

我发现这不再适用于 iOS 9（可能是 10）。我们的代码库中有几个目标。对于其中一些人，我总是希望它以英语出现，即使包中可能存在本地化字符串。

```
[[NSUserDefaults standardUserDefaults] setObject:[NSArray arrayWithObjects:@"en", nil] forKey:@"AppleLanguages"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

我在 main() 中添加了上面的代码。应用程序第一次运行时，它会以用户选择的语言出现。在随后的运行中，它将根据需要以英语显示。

谁能确认这在 iOS 9 中不起作用并提出替代方案？如果没有必要，我宁愿不删除其他 lproj 条目。

# linux - 从文件列表变量中删除所有非目录

> ID：11705232
> 
> 赞同：1
> 
> 时间：2012-07-28T22:39:03.450
> 
> 标签：linux, bash, shell

下面是一个较大脚本的片段，该脚本导出用户指定目录的子目录列表，并在另一个用户指定目录中创建具有相同名称的目录之前提示用户。

```
COPY_DIR=${1:-/}
DEST_DIR=${2}
export DIRS="`ls --hide="*.*" -m ${COPY_DIR}`"
export DIRS="`echo $DIRS | sed "s/\,//g"`"
if [ \( -z "${DIRS}" -a "${1}" != "/" \) ]; then 
  echo -e "Error: Invalid Input: No Subdirectories To Output\n"&&exit
elif [ -z "${DEST_DIR}" ]; then 
  echo "${DIRS}"&&exit
else
  echo "${DIRS}"
  read -p "Create these subdirectories in ${DEST_DIR}?" ANS
  if [ ${ANS} = "n|no|N|No|NO|nO" ]; then
    exit
  elif [ ${ANS} = "y|ye|yes|Y|Ye|Yes|YE|YES|yES|yeS|yEs|YeS" ]; then
    if [ ${COPYDIR} = ${DEST_DIR} ]; then
      echo "Error: Invalid Target: Source and Destination are the same"&&exit
    fi
    cd "${DEST_DIR}"
    mkdir ${DIRS}
  else 
    exit
  fi
fi 
```

但是，该命令`ls --hide="*.*" -m ${COPY_DIR}`也会打印列表中的文件。有没有办法改写这个命令，使它只打印出目录？我试过`ls -d`了，但这也不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T03:00:28.703

您永远不应该依赖 的输出`ls`来提供文件名。有关不解析的原因，请参阅以下内容：http `ls`: [//mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)

您可以使用 GNU find 的 -print0 选项安全地构建目录列表并将结果附加到数组中。

```
dirs=() # create an empty array
while read -r -d $'\0' dir; do # read up to the next \0 and store the value in "dir"
   dirs+=("$dir") # append the value in "dir" to the array
done < <(find "$COPY_DIR" -type d -maxdepth 1 -mindepth 1 ! -name '*.*') # find directories that do not match *.* 
```

`-mindepth 1`阻止 find 匹配 $COPY_DIR 本身。

# database - 使用 Paypal API 的原子性

> ID：11705234
> 
> 赞同：0
> 
> 时间：2012-07-28T22:39:08.487
> 
> 标签：database, paypal, atomic

在 Paypal API 中，流程允许在 API 调用之前进行记录，有时在中间进行记录，例如在 Express Checkout 的情况下，以及在成功支付/交易之后。我担心收到呼叫成功确认但可能无法记录的最后一步。我一直在查看 API，但没有找到检查先前付款/交易结果的方法。有这样的电话吗？在这种情况下如何确保原子性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T13:28:52.993

`DoExpressCheckoutPayment`API 调用在任何 > 76.0 的版本中都是幂等的；如果您想验证交易是否真的完成，您可以简单地再次调用它。

或者，您还可以使用 PayPal[即时付款通知](https://www.paypal.com/ipn)来获取服务器到服务器的 POST，其中包含您帐户上发生的每笔交易的数据。

# html - CSS中的图像映射？

> ID：11705235
> 
> 赞同：1
> 
> 时间：2012-07-28T22:39:28.523
> 
> 标签：html, css, image, hyperlink, imagemap

我的图片也是链接，编码如下：

```
 <a href="../www.google.com"><img src="pages/squirrely.png" /></a> 
```

他们工作得很好，但我希望它是一个链接，只有当你点击照片的一般中间时。如果您单击图像的外部区域，我不希望发生任何链接。我尝试更改 lin 的宽度和高度，但没有成功。我的CSS是：

```
#magazine a {
width: 100px;
height: 100px;
border: 5px solid #fff; 
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:30:57.083

在这种情况下，我不会使用图像映射，但可以执行以下操作：

的HTML：

```
<div class='container'>
 <img .../>
 <a ... ></a>
</div> 
```

CSS：

```
.container {
 position: relative;
}
.container img {
 width: 100px;
 height: 100px;
 border: 5px solid #fff;
}
.container a {
 display: block;
 width: 60px;
 height: 60px;
 position: absolute;
 top: 25px;
 left: 25px;
} 
```

基本上，这会将您的链接置于图像之上。我发现以这种方式使用链接的定位和尺寸要容易得多。（我没有测试代码，但我认为它应该可以工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T22:44:21.293

有几个 Web 应用程序允许您选择映射的坐标。我已经成功地尝试了这个：

[http://www.maschek.hu/imagemap/imgmap](http://www.maschek.hu/imagemap/imgmap)

我希望这对您的项目有所帮助！

# java - 正则表达式使用 ? java中的运算符

> ID：11705237
> 
> 赞同：0
> 
> 时间：2012-07-28T22:39:44.933
> 
> 标签：java, regex

我有一个要匹配的示例字符串：`"a123456.java,a12344*javaaaaaaaaaaaaa"`

我使用以下正则表达式模式：`Pattern p=Pattern.compile("a[0-9]+[.]?[a-zA-Z]+");`

现在 ？运算符表示 0 次或多次出现`"."`。为什么这个字符串`"a12344*javaaaaaaaaaaaaa"`没有被拾起？为什么`*`字符不计为 0 次出现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-28T22:42:05.667

如果您的意思是您希望 * 被 the 拾取，`.`因为这意味着“任何东西”：

在字符类中，`.`变成文字`.`，而不是表示“任何东西”的字符。

如果您想匹配任何内容，请使用`.?`而不是`[.]?`

* * *

如果您的意思`*`是不是`.`，那么零次出现`.`：

你是对的，但是在你的正则表达式中，`.`后面必须跟一个字母（`[a-zA-Z]`），并且`*`显然不是一个字母。

为了澄清，你有：

```
a -> "a"
[0-9]+ -> "12344"
[.]? -> ""
[a-zA-Z]+ -> Cannot match "*" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T22:45:43.717

正确的正则表达式：`a[0-9]+.*[a-zA-Z]+`

`[.]`平均符号`.`

`?`表示 0 或 1

# php - phpmailer 类和重音字符

> ID：11705238
> 
> 赞同：0
> 
> 时间：2012-07-28T22:40:10.890
> 
> 标签：php, forms, class, character-encoding, phpmailer

我正在使用 phpmailer 类发送电子邮件。现在，我来自欧洲，所以我们使用了重音字符...但是从我的 php 脚本中处理不好，我不知道为什么..我尝试将很多次从 utf-8 更改为 iso-8859- 1 从我的 html 表单、script.php 和 class.phpmailer.php 反之亦然。（class.phpmailer.php 默认为 iso-8859-1）

```
//My form.html
...
  <form action="script.php" name="contatti" method="POST" accept-charset="ISO-8859-1">

  </form>
...

//My script.php
...
  require "phpmailer/class.phpmailer.php";

  $messaggio = new PHPmailer();
  $messaggio->CharSet = "ISO-8859-1";
...

//class.phpmailer.php
...
    public $CharSet           = 'utf-8';
... 
```

对不起我的英语不好。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T22:44:57.770

编码应该在所有地方保持一致。所以让我们坚持使用 utf-8。首先检查您的网站是否是 UTF-8 编码的。你应该在你的 HTML 中寻找这样的东西：

```
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
```

然后将您的“ISO-8859-1”替换为 utf-8 并查看您现在拥有的内容。

# ajax - IE历史推送状态

> ID：11705241
> 
> 赞同：5
> 
> 时间：2012-07-28T22:40:49.987
> 
> 标签：ajax, internet-explorer, history, pushstate, new-window

我有一个网页，用户可以通过 AJAX 显示条款和条件而无需重新加载页面。这本身没有问题，但是，我也在尝试推动历史状态。

这在大多数浏览器中都可以正常工作，除了 IE。出于某种莫名其妙的原因，内容是通过 AJAX 加载的，而且还会在前一页中打开一个新选项卡。我怎样才能解决这个问题？

您可以在此网页 ( [http://galaxy-battle.de](http://galaxy-battle.de) ) 上查看示例，尝试单击“加入”框中的“T&Cs”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-01T12:59:33.230

IE9 及以下[不支持 pushState](https://stackoverflow.com/questions/3722815/does-internet-explorer-support-pushstate-and-replacestate)。调用以下行时出现异常

window.history.pushState(null, null, pathFullPage);

SCRIPT438：对象不支持属性或方法“pushState”？terms_and_conditions，第 62 行字符 21

您可能会对[在 IE 中的 Emulate/polyfill history.pushstate() 中讨论的一些解决方法感兴趣](https://stackoverflow.com/questions/6622449/why-is-history-pushstate-not-supported-in-ie-are-there-some-other-ways-to-ach)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-02T11:08:54.937

旧但仍然是当前的问题。我只想说我建议**不要**尝试在 IE 上模拟 pushState。

取而代之的是，您可以使用特征检测：

1.  如果`history.pushState`不为空（浏览器支持 pushState），您可以使用它并使用漂亮的 javascript 加载您的内容

2.  如果`history.pushState`为 null（浏览器不支持 pushState），则更改 url / 跟随链接并进行整页更改

当然，这意味着 IE<=9 用户不会拥有其他用户拥有的所有炫酷动画。但我想问的问题是：你想在网上看到你网站的链接包含`#`吗？

用户可能认为您的应用很有用，并在网络上粘贴指向它的链接。这很酷，因为它为您带来了一些谷歌果汁。现在，如果该用户使用 IE 而您使用 history.js，用户将粘贴包含哈希的链接。

这将破坏应用程序公共页面的正确索引，并且看起来也很丑陋。我个人的看法是，为 IE 用户提供 js 动画或灯箱不值得这些折衷。

# actionscript-3 - 如何检测 Flash 运行时错误？

> ID：11705242
> 
> 赞同：1
> 
> 时间：2012-07-28T22:40:50.347
> 
> 标签：actionscript-3, flash, apache-flex

我正在使用 Flex SDK 中的命令行工具开发一个 AS3 应用程序。我的工作流程是：

1.  写代码
2.  编译`mxmlc`
3.  在最喜欢的网络浏览器中运行 SWF 文件
4.  重复

第二步捕获编译时错误，但运行时错误和警告呢？和`trace()`输出？我怎么能看到呢？

我没有使用任何具有调试功能的 IDE。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T23:01:36.000

获取 Firefox 的 Flash 播放器和 Firebug 的调试版本，然后您可以在控制台中看到跟踪和错误。

当异常处理程序未捕获的运行时错误发生时，您将收到一个弹出窗口，告诉您有关该错误的信息。

为什么不获取[http://www.flashdevelop.org/](http://www.flashdevelop.org/)？它是免费的，它具有调试、分析和所有其他您可以从 IDE 获得的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T13:32:20.840

Although the Flash debugger is a pretty good choice. I would personally suggest [Monster Debugger](http://www.monsterdebugger.com/). It is a great debugger with a very intuitive user interface and it has a plethora of features that make debugging extremely easy.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T05:58:51.220

Flash 播放器调试器将输出写入`trace()`flashlog.txt 文件。它的位置是硬编码的，并且在不同的系统上是不同的。在 Linux 上，它位于 ~/.macromedia/Flash_Player/Logs/flashlog.txt。为了让调试器实际写入该文件，您需要另一个文件 mm.cfg，它的位置和名称再次被硬编码。它应该在 ~/mm.cfg 中。它可能包含许多不同的选项，但您感兴趣的是`ErrorReportingEnable=1`.

然后，您可以`$ tail -f ~/.macromedia/Flash_Player/Logs/flashlog.txt`查看文件写入的进度。

请注意，目录和文件必须可由运行播放器的用户写入。如果不是这种情况，Flash 播放器将不会发出任何警告，并且会静默失败。

Also note that if you are happened to be on Linux, then there isn't a 64-bit version of a debugger player... However, the player runs fairly well under Wine, the Windows version that is.

You may debug using commandline debugger found in SDK. it's called fdb (fdb.exe or in Apache Flex fdb.bat on Windows). It has similar to gdb interface, can do breakpoints, some runtime code evaluation, disassemble functions, look up stack frames and their variables and most of the other stuff you'd expect a debugger to do. I'm usually running it from Emacs, but I would imagine that running it from Vi[m] or whatever editor you are using shouldn't be a problem...

If you were using Emacs, it is actually possible to hook up Flymake to a part of the SDK that does syntax checking while you type. You can find more info on how to do that here: [http://www.flashdevelop.org/community/viewtopic.php?f=13&t=9238](http://www.flashdevelop.org/community/viewtopic.php?f=13&t=9238) (thanks Philippe).

# android - facebook 分享中的错误图片 - 使用分享意图时

> ID：11705243
> 
> 赞同：1
> 
> 时间：2012-07-28T22:41:03.267
> 
> 标签：android, facebook, android-intent, share

我正在使用下一个代码来支持我的应用程序中的共享：

```
//create the send intent  
Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);  

//set the type  
shareIntent.setType("text/plain");  

//add a subject  
shareIntent.putExtra(android.content.Intent.EXTRA_SUBJECT,"subject");  

String msg = https://play.google.com/store/apps/detailsid=com.rovio.amazingalex.premium

//add the message  
shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, msg);  

//start the chooser for sharing  
startActivity(Intent.createChooser(shareIntent, "Sharing...")); 
```

即使没有任何额外的图像从我身边，

facebook 采用随机图像，这不是我的应用程序的一部分，但有点与它相关联。

例如，当尝试分享“Amazing Alex”时，这是附上的图片：

![在此处输入图像描述](../Images/d7eeb08c7146db9cb2483696d6f5f7a1.png)

如何更改此图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-26T06:10:07.300

代替

字符串味精 = [https://play.google.com/store/apps/detailsid=com.rovio.amazingalex.premium](https://play.google.com/store/apps/detailsid=com.rovio.amazingalex.premium)

您应该使用以下内容

字符串味精 = [https://market.android.com/search?q=pname:com.rovio.amazingalex.premium](https://market.android.com/search?q=pname:com.rovio.amazingalex.premium)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T12:04:26.837

我不知道如何更改图片，Facebook 正在使用，但另一种解决方案可能是将链接发布到您自己的网页，其中只有您的应用程序的图片，Facebook 将在帖子中使用，您可以在哪里定义HTML 元标记中的重定向到您的 Google Play 网站。

```
<head>
<meta http-equiv="refresh" content="0; URL=https://play.google.com/store/apps/details?id=com.rovio.amazingalex.premium&feature=banner#?t=W251bGwsMSwyLDIwMSwiY29tLnJvdmlvLmFtYXppbmdhbGV4LnByZW1pdW0iXQ../">
</head> 
```

所以上面的标签会立即将您的访问者重定向到 google play 的页面。我刚刚用我的主页对其进行了测试，Facebook 正在使用上面的图片，但链接重定向到 google play。请注意：您提供的页面会在浏览器重定向之前不久显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-03T06:40:48.960

您可以使用[Facebook URL linter](https://developers.facebook.com/tools/debug/og/object?q=https://play.google.com/store/apps/details?id=net.jessechen.instawifi)查看 Facebook 在抓取 URL 时看到的内容。如您所见，我的 Android 应用程序也有同样的问题，图片是“查看过此内容的用户也查看过”部分下的应用程序。

不幸的是，如果您必须直接链接到 Android Market，则无法更改图像，因此，除非 Google 决定实施[OG 标签](http://davidwalsh.name/facebook-meta-tags)，否则您的问题没有真正的解决方案。您可以将您自己的 url（当我尝试它时您的不工作）放入 URL linter 以查看 Facebook 如何抓取您的链接。

# ruby - Ruby 初学者 - 在单个项目中使用/修改现有 gem

> ID：11705246
> 
> 赞同：2
> 
> 时间：2012-07-28T22:41:41.153
> 
> 标签：ruby, gem

正如标题所述，我是 Ruby 的初学者。

我的项目使用 2 个现有的 gem - 我想修改它们。我已经在 GitHub 上分叉了这些 gem，并将它们作为模块放在我的 repo 中，它们显示为一个子目录。

我试过研究这个，但我一直迷路 - 我想我在这里遗漏了一些基本概念/知识。

我的问题：

1.  我在做这件事对/错吗？
2.  是否可以在我的实际项目中包含那些（分叉的）gem 的代码，或者我应该单独更新它们并将它们用作实际的 gem `require`（这看起来很麻烦）
3.  如果这些宝石是我项目的一部分，我该如何正确使用它们，我假设我不需要这`require`件作品？如果没有，我如何访问/使用它们？

谢谢！

顺便说一句，在 Ubuntu 上使用 Ruby 1.9.2-p194 和 RubyMine 作为 IDE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:08:47.600

1.  Probably wrong. Ruby is a very flexible language, and has what are called *open classes*. This means that you can open up and change classes at run-time. Doing this on an external library is called *monkey patching*. So instead of having to replicate all of the code you want to stay consistent, you can just modify the classes and override any methods you want. A simple example:

    ```
    class Fixnum
      def is_multiple_of_three?
        self % 3 == 0
      end
    end 
    ```

    However, if the changes you want are really significant, it could make sense to fork the gem.

2.  I recommend the `bundler` gem. This will let you make a `Gemfile` which lists all of your dependencies. You can list a github repository as a source for the gem, like so:

    `gem 'gem_name_here', :git => 'git://github.com/username_here/gem_name_here.git'`

    and then run `bundle install` to install your dependencies.

3.  If you install the gems with bundler, it acts just like any other gem you have installed.

# ruby-on-rails - 乘客错误“在任何来源中都找不到 activesupport-3.2.1”

> ID：11705247
> 
> 赞同：0
> 
> 时间：2012-07-28T22:41:46.820
> 
> 标签：ruby-on-rails, amazon-ec2, capistrano, activesupport

我刚刚设法通过 capistrano 将我的 rails 应用程序文件上传到我的 ec2 实例中，但是现在当我尝试访问网页时遇到了一些错误：

**Ruby (Rack) 应用程序无法启动**

```
Error message:
    Could not find activesupport-3.2.1 in any of the sources (Bundler::GemNotFound)
Exception class:
    PhusionPassenger::UnknownError 
```

我安装了activesupport并将其重新部署到服务器中...问题仍然存在...有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:42:20.690

您是否将 gem 添加到 Gemfile 中？

您是否检查了 Gemfile.lock 到您的存储库？

你告诉你的capfile执行`bundle install --deployment`还是`bundle install`？

# php - jQuery 和 Ci 没有正确处理注销功能

> ID：11705248
> 
> 赞同：0
> 
> 时间：2012-07-28T22:41:52.030
> 
> 标签：php, javascript, jquery, codeigniter

我对以下代码做错了吗？当 Ci 会话到期时，我似乎无法让 alert("success") 进行处理。下面是我的 jquery 和 Ci 代码：

```
setInterval(function() {
    jQuery.getJSON("<?=base_url()?>index.php/regUserDash/sessionExpire", function(data) {
        var sessionState = jQuery.parseJSON('{"sessionExpired":"true","sessionExpired":"false"}');
        if(sessionState.sessionExpired === "true") { // if session is expired run the following code
            var dataString = 'true';
            jQuery.ajax({   // send the expired signal to Ci so that it knows the session has expired
                type: 'POST',
                dataType: 'JSON',
                url: '<?=base_url()?>index.php/regUserDash/extendSession',
                data: {'dataString': true},
                success: function(data) {
                    if (data.extendedSession == true) {
                        alert('success');
                    } else {
                        return false;
                    }
                }
            });
        } else if(sessionState.sessionExpired == "false") {
            return;
        }
    });
}, 120000); // loop through every 2 minutes 
```

CodeIgniter 代码：

```
public function sessionExpire() {
        if ($this->session->userdata("logged") == "1") {
            echo json_encode(array("sessionExpired" => false));
        } elseif($this->session->userdata("logged") == "0") {
            echo json_encode(array("sessionExpire" => true));
        }
    } public function extendSession() {
        // set loggedIn session var
        $this->session->set_userdata('logged', '1');
        // return json to ajax call
        echo json_encode(array("extendedSession" => true));
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:58:40.837

`jQuery.parseJSON('{"sessionExpired":"true","sessionExpired":"false"}');`返回 first`sessionExpired = true`和 second `sessionExpired = false`，覆盖第一个。

因此，这是执行此操作的一种方法（需要测试）：

```
setInterval(function() {
    jQuery.getJSON("<?=base_url()?>index.php/regUserDash/sessionExpire", function(data) {
        if(data.sessionExpired == "true") { // if session is expired run the following code
            // var dataString = 'true'; // Remove this
            jQuery.ajax({   // send the expired signal to Ci so that it knows the session has expired
                type: 'POST',
                dataType: 'JSON',
                url: '<?=base_url()?>index.php/regUserDash/extendSession',
                data: {'dataString': true},
                success: function(data) {
                    //if (data.extendedSession == true) {
                        alert('success');
                    //} else {
                    //    return false;
                    //}
                    // Remove commented code, because extendSession() always return true
                }
            });
        } else {
            return 'Session not expired!';
        }
    });
}, 120000); // loop through every 2 minutes 
```

和 CI 功能：

```
public function sessionExpire()
{
    if ($this->session->userdata("logged") == "1") {
        echo json_encode(array("sessionExpired" => false));
    } elseif ($this->session->userdata("logged") == "0") {
        echo json_encode(array("sessionExpired" => true));
    }
}

public function extendSession()
{
    // set loggedIn session var
    $this->session->set_userdata('logged', '1');
    // return json to ajax call
    echo json_encode(array("extendedSession" => true));
} 
```

# ios - iOS：在不创建自定义单元格的情况下向 UITableViewCell 添加第三个标签？

> ID：11705250
> 
> 赞同：2
> 
> 时间：2012-07-28T22:42:03.280
> 
> 标签：ios, uitableview, custom-cell

我以前使用过自定义单元格，但我只是想知道添加第三个标签（仅此而已！）是否有更简单的解决方案？我要做的就是显示标题、内容和日期。我已经将前两个设置为 textLabels 和 detailTextLabels 但我当然需要第三个作为日期。

那么，有没有更简单的解决方案而不制作自定义单元格？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T23:03:31.030

请参阅[A Closer Look at Table-View Cells](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7-SW1)，名为以编程方式将子视图添加到单元格的内容视图的部分。

```
mainLabel = [[[UILabel alloc] initWithFrame:CGRectMake(0.0, 0.0, 220.0, 15.0)] autorelease];
mainLabel.tag = MAINLABEL_TAG;
mainLabel.font = [UIFont systemFontOfSize:14.0];
mainLabel.textAlignment = UITextAlignmentRight;
mainLabel.textColor = [UIColor blackColor];
[cell.contentView addSubview:mainLabel]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T22:56:08.710

尝试设置到 cellForRowAtIndexPath （每次创建新单元格时）修改 textLabel 和 detailTextLabel 框架并向 cell.contentView 添加日期的新标签...但我认为正确的方法是继承 UItableViewCell 类并创建自定义细胞

# ios5 - 带有水平 UITableView 的 UITableViewCell

> ID：11705251
> 
> 赞同：0
> 
> 时间：2012-07-28T22:42:03.947
> 
> 标签：ios5, uitableview, horizontal-scrolling

我想实现一个垂直的 UITableView，它的单元格包含水平滚动的表格视图。它的行为应该非常类似于 Pulse 应用程序中的表格视图。正如开发人员在斯坦福演讲中提到的那样，每个单元格中都包含水平表格视图。

我读过 Ray Wenderlich 的博客文章，但他提到在 iOS 5 中它可以比他的教程更容易完成，并且该过程将在 iOS 5 发布时描述（已经有将近一年了，没有博客有关此事的帖子已发布）。

有人可以给我一个提示如何去做吗？我正在向我的单元格添加一个表格视图，并通过 -M_PI_2 旋转它。单元格的宽度设置为主表中单元格的高度。水平表的高度设置为 320。但是，当我开始在其上移动手指时它不会滚动，我真的不知道为什么。

索林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T22:09:22.863

我找到了答案（关于此事的 Ray Wenderlich 教程）

[http://www.raywenderlich.com/4723/how-to-make-an-interface-with-horizo​​ntal-tables-like-the-pulse-news-app-part-2](http://www.raywenderlich.com/4723/how-to-make-an-interface-with-horizontal-tables-like-the-pulse-news-app-part-2)

# ios - 使用 NSNotification defaultCenter 响应缓慢

> ID：11705252
> 
> 赞同：0
> 
> 时间：2012-07-28T22:42:04.407
> 
> 标签：ios, performance, uitableview, uibutton, nsnotificationcenter

嗨，我正在使用 NSNotificationCenter defaultCenter 在我的应用程序中实现“喜欢”和“评论”功能。

```
//In Answer Table View
@implementation AnswerTableView

- (id)initWithParentController:(UIViewController *)pController andResourcePath:(NSString *)thisResourcePath {

    ....
    // Notification to reload table when a comment is submitted
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(reloadTable)
                                                 name:@"Comment Submitted"
                                               object:nil];

    // Notification to reload table when an answer is liked
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(reloadTable)
                                                 name:@"Answer Liked"
                                               object:nil];

}

- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [super dealloc];
}

//In custom button implementation - THIS BUTTON IS CREATED IN EVERY CELL OF THE TABLEVIEW
@implementation UICustomButton

-(id)initWithButtonType:(NSString *)type {
    self = [super init];
    if (self) {
       //Initialization done here
    }
    return self;
}

- (void)buttonPressed {
    if ([btnType isEqualToString:@"like"]) {
       [[NSNotificationCenter defaultCenter] postNotificationName:@"Answer Liked" object:nil];
    }
    else if ([btnType isEqualToString:@"comment"]) {
       [[NSNotificationCenter defaultCenter] postNotificationName:@"Comment Submitted" object:nil];
    }
} 
```

但是，我意识到在使用这些功能一段时间后，表重新加载的响应速度越来越慢（到了崩溃的地步）。

我是否错过了实现中的任何内容，即解除分配等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-16T06:30:38.390

Sometimes its good to queue the event with Grand Central Dispatch to make sure its running on the main thread.

```
dispatch_async(dispatch_get_main_queue() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T11:44:14.833

您反复添加观察者并且速度变慢是因为通知代码必须循环越来越多的观察者来发送通知。您可能正在崩溃，因为您泄漏了这么多这些视图。

在您的 dealloc 中放置一条日志语句，以查看这些实例是否被清理过。此外，dealloc 方法中的 removeObserver 也可能存在时间问题。如果可以，请尝试在 dealloc 之前删除观察者。

# sql - 逗号分隔列表上的 T-SQL LIKE 条件

> ID：11705255
> 
> 赞同：0
> 
> 时间：2012-07-28T22:42:38.540
> 
> 标签：sql, tsql, sql-server-ce

是否可以在 T-SQL 中编写`LIKE`条件以匹配包含通配符的逗号分隔列表到字符串。让我用一个例子进一步解释：

假设您在字段中有以下命令分隔的 url 列表：

```
'/, /news/%, /about/' 
```

现在这里有一些我想与上面的字符串匹配的字符串示例：

1.  '/'
2.  '/消息/'
3.  '/新闻/2/'
4.  '/关于/'

这是一些不匹配的字符串：

1.  '/接触/'
2.  '/关于我/'

我过去通过编写一个拆分函数然后对每个函数做一个类似的操作来实现这一点。但是，我试图让我的查询在不支持函数的 SQL Server CE 中工作。

如果您想知道我是如何使用 split 函数实现它的：

```
SELECT Widgets.Id 
FROM Widgets 
WHERE (SELECT COUNT(*) FROM [dbo].[Split](Urls, ',') WHERE @Input LIKE Data) > 0 
```

这是拆分功能：

```
CREATE FUNCTION [dbo].[Split]
(    
    @RowData NVARCHAR(MAX),
    @Separator NVARCHAR(MAX)
)
RETURNS @RtnValue TABLE 
(
    [Id] INT IDENTITY(1,1),
    [Data] NVARCHAR(MAX)
) 
AS
BEGIN 
    DECLARE @Iterator INT
    SET @Iterator = 1

    DECLARE @FoundIndex INT
    SET @FoundIndex = CHARINDEX(@Separator, @RowData)

    WHILE (@FoundIndex > 0)
    BEGIN
        INSERT INTO @RtnValue ([Data])
        SELECT Data = LTRIM(RTRIM(SUBSTRING(@RowData, 1, @FoundIndex - 1)))

        SET @RowData = SUBSTRING(@RowData, @FoundIndex + DATALENGTH(@Separator) / 2, LEN(@RowData))
        SET @Iterator = @Iterator + 1
        SET @FoundIndex = CHARINDEX(@Separator, @RowData)
    END

    INSERT INTO @RtnValue ([Data])
    SELECT Data = LTRIM(RTRIM(@RowData))

    RETURN
END 
```

如果有人可以提供帮助，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T07:24:00.770

我可以想到几个选择：

1.  使用会话键控表：删除与当前 spid 匹配的行，使用当前 spid 插入所需的行，从 SP 中的表中读取，从表中删除（再次）。

2.  让您的客户提交包含许多 OR ... LIKE ... 子句的查询。

3.  编写一个与您的函数执行相同操作并返回记录集的 SP。`INSERT YourTable EXEC SP @Strings`你就完成了！

4.  在拆分字符串的派生表方法中使用 numbers-table-charindex-into-string。

**例子**

让我通过结合想法#3 和#4 的示例为您详细说明这一点。当然，您的函数代码也可以进行调整。

建立一个单独的`Numbers`表。这是示例创建脚本：

```
--Numbers Table with 8192 elements (keeping it small for CE)
CREATE TABLE Numbers (
   N smallint NOT NULL CONSTRAINT PK_Numbers PRIMARY KEY CLUSTERED
);
INSERT Numbers VALUES (1);
WHILE @@RowCount < 4096
   INSERT Numbers SELECT N + (SELECT Max(N) FROM Numbers) FROM Numbers; 
```

SP：

```
CREATE PROCEDURE dbo.StringSplitRowset
   @String varchar(8000)
AS
SELECT Substring(@String, l.StartPos, l.Chars) Item
FROM (
   SELECT
      S.StartPos,
      IsNull(NullIf(CharIndex(',', @String, S.StartPos), 0) - S.StartPos, 8000)
   FROM (
      SELECT 1 UNION ALL
      SELECT N.N + 1 FROM Numbers N WHERE Substring(@String, N.N, 1) = ','
   ) S (StartPos)
) L (StartPos, Chars); 
```

和用法一样简单：

```
DECLARE @String varchar(8000);
SET @String = 'abc,def,ghi,jkl';
CREATE TABLE #Split (S varchar(8000));
INSERT #Split EXEC dbo.StringSplitRowset @String;
SELECT * FROM #Split; 
```

结果：

```
abc
def
ghi
jkl 
```

最后，如果你不想建立一个数字表，你可以使用这个 SP。我想你会发现这两个 SP 中的一个对你来说表现得足够好。字符串拆分的其他实现也可以工作。

```
ALTER PROCEDURE dbo.StringSplitRowset
  @String varchar(8000)
AS
SELECT Substring(@String, l.StartPos, l.Chars) Item
FROM (
   SELECT
      S.StartPos,
      IsNull(NullIf(CharIndex(',', @String, S.StartPos), 0) - S.StartPos, 8000)
   FROM (
      SELECT 1 UNION ALL
      SELECT N.N + 1
      FROM (
         SELECT A.A * 4096 + B.B * 1024 + C.C * 256 + D.D * 64 + E.E * 16 + F.F * 4 + G.G N
         FROM
            (SELECT 0 UNION ALL SELECT 1) A (A),
            (SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4) G (G),
            (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) F (F),
            (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) E (E),
            (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) D (D),
            (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) C (C),
            (SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) B (B)
      ) N (N)
      WHERE Substring(@String, N.N, 1) = ','
   ) S (StartPos)
) L (StartPos, Chars) 
```

任何认真理解以不同方式拆分字符串的性能影响的 SQL 编写者都应该查看[Aaron Bertrand 的关于拆分字符串的博客文章](http://sqlperformance.com/2012/07/t-sql-queries/split-strings)。

此外，任何认真的 SQL Server 数据库学生都应该[阅读 Erland Sommarskog 的如何在存储过程之间共享数据](http://www.sommarskog.se/share_data.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:08:28.497

SQL Server CE 是否允许您使用 XML 函数拆分并使用 CROSS APPLY？如果是这样，您可以执行以下操作：

```
SELECT DISTINCT T1.id
FROM (
      SELECT id,  CAST(('<X>'+
                        REPLACE(REPLACE(urls,' ',''),',','</X><X>')+
                        '</X>'
                       ) AS xml
                      ) as URLsXML
      FROM dbo.Widgets
     ) AS T1
CROSS APPLY(
            SELECT N.value('.', 'varchar(50)') AS URLPattern 
            FROM URLsXML.nodes('X') AS S(N)
           ) AS T2
WHERE @Input LIKE T2.URLPattern 
```

**更新**：我刚刚检查过。看起来 SQL Server CE 不支持 XML 数据类型或 CROSS APPLY。我认为您将不得不使用 ID 和模式填充另一个表来加入。

# css - CSS3：制作重叠的 div

> ID：11705258
> 
> 赞同：0
> 
> 时间：2012-07-28T22:43:18.530
> 
> 标签：css, overlapping

我试图通过在 iOS 的 UIWebView 控件中使用 HTML来创建[这种效果。](http://i49.tinypic.com/22c3du.jpg)目标是在列表上创建进度条的效果。到目前为止，我尝试[了这个](http://jsfiddle.net/tFn78/4/)，但正如你所见，通过在 diV 上添加填充会使一切都搞砸了。我怎样才能达到类似的效果？我没有使用表格的问题，但似乎会更困难。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:52:55.610

为什么不只使用嵌套 div 并给内部 Div 一个百分比宽度。

```
<div><div class="inner"></div></div> 
```

和 CSS：

```
div {
    background-color: blue;
    height: 30px;
}
.inner {
    width: 50%;
    background-color: skyblue;
} 
```

由于 div 是块级元素，默认情况下它们具有 100% 的宽度，因此如果足够的话，您不需要为外部 div 显式指定它。

另一种可能性是使用背景渐变并移动改变背景位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T22:48:31.160

在您提供的代码中，您有这个 div：

```
<div style='position:absolute;left:0%; background-color: hsl(30,100%,59%);width:30%;z-index:10;'>&nbsp;</div> 
```

只需添加“顶部：0px；” 让它变成

```
<div style='position:absolute;left:0%; top: 0px; background-color: hsl(30,100%,59%);width:30%;z-index:10;'>&nbsp;</div> 
```

它看起来是正确的。

编辑：然后给 LI 元素`position: relative`以使其与多个元素一起使用。见[http://jsfiddle.net/tFn78/9](http://jsfiddle.net/tFn78/9)

另一个更干净的版本：http: [//jsfiddle.net/v7zNn/](http://jsfiddle.net/v7zNn/)并调整为标题的可变高度。

# html - 动画可重新配置画廊 (html/css)

> ID：11705266
> 
> 赞同：0
> 
> 时间：2012-07-28T22:43:56.963
> 
> 标签：html, css, gallery, animated

我希望创建一个 html/css 画廊，每个画廊元素之间没有间距。仅在某些情况下，所有画廊元素的大小都相同，并且是 div 内的 ul 中包含的列表项。我已经设置了媒体查询来重新调整网站的其余部分和图库图像的大小。然而，实际元素是内联块，因此它们会自行调整。我想知道如何制作元素，以便它们动画到它们的新位置，而不是仅仅捕捉它们。将标准转换值添加到任何与画廊相关的项目的 css 似乎都不起作用。我不确定是否需要更改标记才能使其正常工作，但我们将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:36:45.683

单独用css是无法实现动画的。您将需要一些 javascript。我建议你看看jquery。

# python - Big-O 符号和优化功能包括记忆？

> ID：11705276
> 
> 赞同：2
> 
> 时间：2012-07-28T22:45:40.907
> 
> 标签：python, optimization, big-o, memoization

我试图找到能被每个整数 1-20（含）整除的最小数字。这只是我试图改进我以前做过的练习。

我写了一个函数，它接受一个参数并返回可以被每个小于参数（包括它自己）的正整数整除的最小数字，但是它没有优化并且随着数字变大运行相对缓慢。

我想知道这个函数的 Big-O 符号是什么以及为什么。那么，如果有的话，有没有办法加快这个速度，也许我不确定记忆？

```
def divide_by_all(x):
    ## the 'pos' variable will be matched up against the argument to keep track of how many of the numbers in ##
    ## the arguments range are dividing evenly. ##
    pos = 0
    ## the 'count' variable will be set to equal the input argument, possibly
    count = x
    ## create the range of integers for the argument ##
    divs = [i for i in range(1,x + 1)]
    while pos != x:
        for i in divs:
            ## check if each 'i' in the divs list is evenly divisible ##
            ## if 'i' is not evenly divisible the 'count'(answer) is incremented, the 'pos' is set back to zero to show ##
            ## the next 'count' has no evenly divisible in numbers div yet, and then loop over the divs list starts again ##
            if count % i != 0:
                count += 1
                pos = 0
                break
            ## if 'i' is evenly divides into current 'count' increment 'pos' ##
            if count % i == 0:
                pos += 1
            ## if 'pos' == the argument 'x', meaning every number in range(x) is evenly divisible ##
            ## return 'count' ##
            if pos == x:
                return count 
```

欢迎任何提示和建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:21:35.680

要对这个算法的渐近运行时间给出一个好的估计实际上并不容易。作为一个大概的估计，它可能略小于 n！（即非常慢）。问题很简单，答案随着 n 快速增长：它是小于 n 的素数的最高幂的乘积（对于 n=20，即 2^4 * 3^2 *5*7*11*13 *17*19=232792560)。当您检查所有数字直至答案时，您的运行时间显然比这更长（确定需要做多少工作）。

记忆在这里不相关，因为您的算法不是递归的。

基本上，这是一个数学问题，而不是算法问题。

# php - PHP包含和相对/绝对路径不起作用

> ID：11705282
> 
> 赞同：0
> 
> 时间：2012-07-28T22:47:14.730
> 
> 标签：php, html

在我的站点中，index.php 位于 /director 中，然后我还有其他几个位于 /episodes/10/ 中的 .php 文件（10 是剧集编号）。

我在 index.php 中包含的路径很简单`<?php include "includes/head.php"; ?>`。这些路径在位于 episodes/10/ 文件夹中的 .php 文件中不起作用。所以我做了路径`<?php include "../../includes/head.php"; ?>`，但无济于事。我已经尝试通过使用使它们成为所有绝对路径，`<?php include "/includes/head.php"; ?>`但这也不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T22:53:12.820

无论从哪个子目录运行都可以使用的解决方案：

```
include($_SERVER['DOCUMENT_ROOT'] . 'includes/head.php'); 
```

# java - 未收集 AsyncTask 导致其他 AsyncTask 无法运行

> ID：11705285
> 
> 赞同：2
> 
> 时间：2012-07-28T22:47:24.290
> 
> 标签：java, android, garbage-collection, android-asynctask, threadpool

我的应用程序使用了很多 AsyncTasks。毕竟它是一个网络应用程序。当我跟踪 Debug 选项卡时，我注意到每个 AsyncTask 都说在它后面运行，并且在 5 个 AsyncTasks 之后，我无法启动任何 AsyncTasks。我通过更改`THREAD_POOL_EXECUTOR`允许 15 个线程池化的执行程序来修复它。但是 AsyncTasks 仍然显示为正在运行。

AsyncTasks 中都有 InputStreams 和 BufferedReaders 来读取 JSON，但我从未`close()`在 Streamers 和 Readers 上调用该方法。可能是这样，还是无论如何都会在完成后收集AsyncTask？

如果是这样，那为什么我不能在我的应用程序中运行超过 5 个 AsyncTasks？

## ***看到我悬赏它，我将更明确地解释这一点***

所有人都通过他们的`AsyncTasks`方法。除了使用不同的`BasicNameValuePairs`. 我 100% 确定代码中没有简单的错误。

以下是其中一个 AsyncTask 的示例：

```
private class RunningEvent extends AsyncTask<Void, Void, Response> {

    @Override
    protected void onPreExecute() {
        if (Constants.isOnline(getApplicationContext())) {
            super.onPreExecute();
        } else {
            Toast.makeText(getApplicationContext(),
                    "No internet connection", Toast.LENGTH_LONG).show();
            return;
        }
    }

    @Override
    protected Response doInBackground(Void... empty) {
        HttpClient client = new DefaultHttpClient();
        HttpPost post = new HttpPost(URL);

        try {
            List<NameValuePair> values = new ArrayList<NameValuePair>(5);
            values.add(new BasicNameValuePair("tag", "eventRunning"));
            values.add(new BasicNameValuePair("userid", String
                    .valueOf(response.user.userid)));
            post.setEntity(new UrlEncodedFormEntity(values));

            HttpResponse httpresponse = client.execute(post);
            HttpEntity entity = httpresponse.getEntity();
            InputStream stream = entity.getContent();

            Log.i("MenuActivity",
                    "Input streamed, parsing Gson for existing events");
            Gson gson = new Gson();
            Reader reader = new InputStreamReader(stream);

            eventresponse = gson.fromJson(reader, Response.class);
            return eventresponse;
        } catch (Exception e) {
            e.printStackTrace();
            Log.e("RunningEvent", "Error sending data to Server");
        }
        return null;
    }

    @Override
    protected void onPostExecute(Response result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        Log.i("MenuActivity", "Binding button");
        if (eventresponse != null) {
            if (eventresponse.success == 1) {
                eventresponse.user = response.user;
                bActivity.setOnClickListener(new OnClickListener() {

                    public void onClick(View arg0) {
                        Intent i = new Intent("com.xxx.xxx.EVENT");
                        i.putExtra("response", eventresponse);
                        running = false;
                        switcher.cancel(true);
                        MenuActivity.this.finish();
                        startActivity(i);
                    }

                });
            } else {
                bActivity.setText("Nieuw activity");
                bActivity.setOnClickListener(new OnClickListener() {

                    public void onClick(View arg0) {
                        Intent i = new Intent("com.xxx.xxx.NEWEVENT");
                        i.putExtra("response", response);
                        running = false;
                        switcher.cancel(true);
                        MenuActivity.this.finish();
                        startActivity(i);
                    }

                });
            }
        } else {
            Log.i("RunningEvent", "Response is null");
        }
    }

} 
```

上面的例子是有时会作为第 6 次`AsyncTask`运行，它永远不会进入`doInBackground()`方法。我相信这是 5 的`Thread`限制`SERIAL_EXECUTOR`。我通过投入大部分`AsyncTasks`来“解决”问题`THREAD_POOL_EXECUTOR`，但这只是在避免它。

`AsyncTasks`这些永远不会停止运行和堵塞的原因可能是什么`Executor`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T23:56:57.947

[android.os.AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)自带两个内置的执行器。如果使用 SERIAL_EXECUTOR，则没有线程池，所有 AsyncTask 都按串行顺序一次执行一个。如果使用 THREAD_POOL_EXECUTOR （我想这就是您在问题中所指的），这最多允许 128 个 AsyncTask 并行执行。

您在调试中看到的数字 5 是底层线程池的 corePoolSize（AKA. THREAD_POOL_EXECUTOR），它与 maximumPoolSize 不同。查看[AsyncTask 源代码](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/os/AsyncTask.java)，看看线程池是如何实现的：

```
private static final int CORE_POOL_SIZE = 5;
private static final int MAXIMUM_POOL_SIZE = 128;
private static final int KEEP_ALIVE = 1;

... ...

/**
 * An {@link Executor} that can be used to execute tasks in parallel.
 */
public static final Executor THREAD_POOL_EXECUTOR
        = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE,
                TimeUnit.SECONDS, sPoolWorkQueue, sThreadFactory); 
```

查看[ThreadPoolExecutor API](http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html#ThreadPoolExecutor%28int,%20int,%20long,%20java.util.concurrent.TimeUnit,%20java.util.concurrent.BlockingQueue%3Cjava.lang.Runnable%3E,%20java.util.concurrent.ThreadFactory%29)以查看调用此构造函数创建的默认线程池行为是什么。一般来说，**corePoolSize 是保留在池中的线​​程数，即使它们是空闲的，除非设置了 allowCoreThreadTimeOut**。

您在调试中看到的那 5 个 AsyncTask 实际上是在核心线程上，这些线程已完成并变得空闲但从未终止，您可以通过调用[ThreadPoolExecutor.allowCoreThreadTimeOut(boolean)](http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html#allowCoreThreadTimeOut%28boolean%29)来更改此行为。

* * *

### 更多关于 SERIAL_EXECUTOR 的故事

我说SERIAL_EXECUTOR 不使用线程池，这不是真的。SERIAL_EXECUTOR 确实是把真正的工作委托给 THREAD_POOL_EXECUTOR，但是使用 ArrayDeque 来控制下一个任务的提交（如果上一个任务完成就提交下一个任务），查看源码：

```
private static class SerialExecutor implements Executor {
    final ArrayDeque<Runnable> mTasks = new ArrayDeque<Runnable>();
    Runnable mActive;

    public synchronized void execute(final Runnable r) {
        mTasks.offer(new Runnable() {
            public void run() {
                try {
                    r.run();
                } finally {
                    scheduleNext();
                }
            }
        });
        if (mActive == null) {
            scheduleNext();
        }
    }

    protected synchronized void scheduleNext() {
        if ((mActive = mTasks.poll()) != null) {
            THREAD_POOL_EXECUTOR.execute(mActive);
        }
    }
} 
```

因此，无论您使用 SERIAL_EXECUTOR 或 THREAD_POOL_EXECUTOR，线程池中始终显示 5 个核心线程，即使它们已完成并变得空闲。但是，核心线程数（由 corePoolSize 配置）并不是线程池中当前运行的线程数（由 maximumPoolSize 配置）。

# iphone - 动画效果：将按钮分成几部分

> ID：11705286
> 
> 赞同：0
> 
> 时间：2012-07-28T22:47:26.087
> 
> 标签：iphone, objective-c, ios

我需要一个动画效果，类似于在按下按钮时小部分破坏按钮。有没有一种简单的方法可以用 Quartz 等来做到这一点？它的外观非常灵活。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:48:45.967

我会将您的按钮图像带入图形程序并准备不同版本的它，每个版本都有一个 Alpha 通道，全部被一小块遮挡，以这样的方式图案化，如果所有图像都堆叠起来，它们看起来像整个按钮。（为了更好的效果，你可以在“碎片”的边缘画一点，这样它们就有了一些造型。）

您需要对应该使用的文件格式进行一些研究。可能 png 是最好的，但 jpeg 也可以。

回到 Xcode，为每个“片段”制作 CALayers，并将您创建的图形文件设置为 CALayer 的内容。当需要制作“分解”动画时，将新的 CALayers 作为子层添加到视图层：

```
 [self.view.layer addSublayer:layerPiece]; // do this for each layer 
```

并为每一层创建一个 CAKeyframeAnimations 的 CAAnimationGroup——可能是 transform.translate、transform.rotation 和 opacity。你可以在那里找到例子。有用的提示：旋转必须以弧度为单位。您需要设置您的值以使图层旋转并彼此分开，并可能在最后淡出。下面是一个淡出动画的例子：

```
CAKeyframeAnimation *animFadeOut = [CAKeyframeAnimation animationWithKeyPath:@"opacity"];
animFadeOut.values = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0], [NSNumber numberWithFloat:1.0], nil];
animFadeOut.keyTimes = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.4f], [NSNumber numberWithFloat:1.0f], nil]; 
```

最后，对于每一层，您可以像这样设置动画：

```
[layerPiece3 addAnimation:animGroup3 forKey:@"arbitraryAnimPropertyString"]; 
```

这是很多工作。或者，如果您可以访问 Adob​​e After Effects 之类的合成程序，则可以准备动画电影（仍然需要大量工作，但比盲目设置关键帧编号要容易得多），然后只需通过按钮播放即可。我没有在 iOS 中播放电影，但我假设您将其设置为 CALayer 的内容并将图层添加到视图以显示和播放电影。

理想情况下，您会使用 3D 软件对按钮进行建模、纹理和照明，使用粒子效果将其分开，渲染一个短片，然后将该片应用*到*图层。

# javascript - Grails：更改img src的JS函数没有响应

> ID：11705288
> 
> 赞同：2
> 
> 时间：2012-07-28T22:47:41.383
> 
> 标签：javascript, html, ajax, grails

我正在尝试在特定条件下更改 img 的 src。我知道条件适当地返回 true，因为我之前在 alert() 中写过。由于某种原因，该函数不会更改 img 的 src 并动态更新页面。这可能与我使用 jquery 库的事实有关吗？我认为您仍然可以使用 stand js 语法。这是我的代码片段和来自谷歌浏览器的相应源代码。

.gsp：

```
<script type="text/javascript">
function onSuccess(data){
    if(data.hasHearted){
        document.getElementById("changer${user.id}").src = "${resource(dir: "images/images", file: "heart_red.png")}";
    }       
} 
```

```
<figcaption id="secondcap" onClick="${remoteFunction(controller:'user', action:'heart', onSuccess: 'onSuccess(data)', params:[userID:user.id])}">               
            <img id="changer${user.id}" src="${resource(dir: "images/images", file: "heart.png")}" alt="heart">
</figcaption> 
```

Chrome 源代码（出于隐私考虑，我省略了一些内容）：

```
<script type="text/javascript">
function onSuccess(data){
    if(data.hasHearted){
        $('#changer3').attr('src','/Personably/static/images/images/heart_red.png');
    }       
}
</script>

<div class="persons">   
<figure class="user_image">         
    <img class="user_profile_pic" src="omitted for privacy..." onmouseover="jQuery.ajax({type:'POST',data:{'userID': '3'}, url:'/Personably/user/hasHearted',success:function(data,textStatus){onSuccess(data);},error:function(XMLHttpRequest,textStatus,errorThrown){}});"/>  
    <figcaption id="firstcap">
            Omitted for privacy...
    </figcaption>               
    <figcaption id="secondcap" onClick="jQuery.ajax({type:'POST',data:{'userID': '3'}, url:'/Personably/user/heart',success:function(data,textStatus){onSuccess(data);},error:function(XMLHttpRequest,textStatus,errorThrown){}});">                
            <img id="changer3" src="/Personably/static/images/images/heart.png" alt="heart">
    </figcaption>
</figure>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T20:47:59.293

由于您使用的是 jquery，您是否尝试过使用 jquery id 选择器 $(“#id”) 和/或 jquery .attr 函数？

[http://api.jquery.com/id-selector/](http://api.jquery.com/id-selector/)

[http://api.jquery.com/attr/#attr2](http://api.jquery.com/attr/#attr2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T01:34:34.977

我不确定在加载页面后更改 src 属性会改变用户看到的内容，即使它更改了代码，因为文档已经加载。

相反，您可能应该将两个图像（heart.png 和 heart_red.png）都放在页面上，然后根据控制器操作的输出使用样式隐藏/取消隐藏它们。jquery .toggle(Boolean) 方法对于这样的东西非常有用。[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

在你的 JavaScript 函数中，你可以有类似的东西：

```
$('#heart3').toggle(!data.hearted);
$('#heart_red3').toggle(data.hearted); 
```

然后，当 data.hearted 为 true 时，红色的心会显示，而普通的心会隐藏。

# ios - 在 Cocoa 中读取 iOS 上的图片

> ID：11705292
> 
> 赞同：0
> 
> 时间：2012-07-28T22:48:36.013
> 
> 标签：ios, cocoa-touch

我在 iPad 上得到这样的图片 URL：

assets-library://asset/asset.JPG?id=00000000-0000-0000-0000-000000000BC4&ext=JPG

如何读取图片内容的二进制文件？
例如，使用 stringFromFileAtURL 打开文件会给我找不到路径。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T02:34:38.430

您不能随意从那里读取内容，因为它在您的应用程序的沙箱之外。

这不会像您希望的那样简单。首先，您必须获取实际的图像文件。这涉及获取一个 ALAsset 对象（你可以在[这个问题](https://stackoverflow.com/questions/3837115/display-image-from-url-retrieved-from-alasset-in-iphone)中看到这个过程。然后，你得到那个资产`defaultRepresentation`，然后你得到表示的`fullResolutionImage`。然后你有一个 CGImageRef，你可以通过获取数据提供者`CGImageGetDataProvider`，然后是像素的副本数据通过`CGDataProviderCopyData`which is a `CFDataRef`（您可以将其转换为`NSData *`）。

你真的需要二进制文件吗？还是 UIImage 足够好？不确定你的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T11:39:34.770

不需要使用资产库，UIImage 是二进制表示。如果您只想将图像另存为文件，请使用

[UIImagePNGRepresentation(image) writeToFile:pngPath atomically:YES];

# java - 为什么 readBoolean 会阻塞而 readObject 不会？

> ID：11705300
> 
> 赞同：0
> 
> 时间：2012-07-28T22:50:55.547
> 
> 标签：java, stream

我的客户端有以下方法：

```
 public boolean save() {
    this.ostream.writeObject(Command.SAVE); // write to socket
    return this.istream.readBoolean();
  } 
```

在我的服务器中：

```
 Object o = this.istream.readObject();
    if (o == Command.SAVE) {
      boolean isSaved = save(); // save to database
      this.ostream.writeBoolean(isSaved);
    } 
```

如果我使用`readBoolean`and `writeBoolean`，`readBoolean`客户端中的方法会阻塞，但如果我使用`readObject`and `writeObject`，我的应用程序可以正常工作。`readBoolean`该方法是否有阻塞的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:18:29.877

（*它更像是评论，但代码示例很难阅读，所以我将其发布为答案......希望它不会打扰任何人*）

你确定？我刚刚通过此代码对其进行了测试

```
ObjectOutputStream out=new ObjectOutputStream(new FileOutputStream("d:/objects.obj"));
System.out.println("writeObject(true)");
out.writeObject(true);
System.out.println("writeBoolean(true)");
out.writeBoolean(true);
System.out.println("writeBoolean(true)");
out.writeBoolean(true);
out.close();//or flush
System.out.println("------------------");

ObjectInputStream in=new ObjectInputStream(new FileInputStream("d:/objects.obj"));
System.out.println("readObject="+in.readObject());
System.out.println("readBoolean="+in.readBoolean());
System.out.println("readObject="+in.readObject());//<- readObject stored by writeBoolean 
```

它接缝工作正常。我遇到的唯一问题是当我尝试`readObject`存储时，`writeBoolean`反之亦然。`readBoolean``writeObject`

也许您只需要刷新输出流。

# javascript - 设置超时不起作用

> ID：11705306
> 
> 赞同：0
> 
> 时间：2012-07-28T22:52:23.893
> 
> 标签：javascript, jquery, settimeout

我的 setTimeout 似乎可以用于登录，但不能用于提交数据。：

```
<script type="text/javascript" src="../scripts/jquery.js"></script>
<script type="text/javascript">

$.ajaxSetup({async:false});

function Validate_submit(form) {
    var Address1_input = form.address1.value;
    var Address2_input = form.address2.value;
    var City_input = form.city.value;
    var State_input = form.state.value;

    $.post('../scripts/submit_check.php', {address1php: Address1_input, address2php: Address2_input, cityphp: City_input, statephp: State_input}, 
    function(output) {
            $('#submit_msg').html(output).fadeIn(500);
            if (output == 'Submitting...') {
        var timeoutID = window.setTimeout(function () {location.reload();}, 1000);
            } else {
                $('#submit_msg').html('something went wrong').fadeIn(500);
            }
        }
        );

} 
```

相同的代码在我的登录弹出窗口中有效：

```
<script type="text/javascript" src="../scripts/jquery.js"></script>
<script type="text/javascript">
$.ajaxSetup({async:false}); 

function Validate_login(form) {
    var Email_input = form.email.value;
    var Password_input = form.password.value;
    var Rememberme_input = form.remember_me.checked;

    $.post('../scripts/login_check.php', { emailphp: Email_input, passwordphp: Password_input, rememberphp: Rememberme_input},
        function(output) {
            $('#login_msg').html(output).fadeIn(500);
            if (output == 'Logging in...') {

                var timeoutID = window.setTimeout(function () {location.reload();}, 1000);
            }
        }
        );  
} 
```

当我单击提交表单中的提交按钮时，它会在一瞬间显示“正在提交...”，但不会显示一整秒（就像在登录弹出窗口中一样）。有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T22:55:42.410

您可能需要取消实际`<form>`的提交。`return false`在`onsubmit`您调用`Validate_submit`.

# ruby - 如何将实例变量添加到类以支持添加的方法？

> ID：11705315
> 
> 赞同：0
> 
> 时间：2012-07-28T22:53:31.537
> 
> 标签：ruby, metaprogramming

我是 Ruby 新手，对如何创建`Class`类似于的方法感到困惑`:attr_accessor`，因为它将方法添加到用户类，但是这些添加的方法可以访问预初始化的实例变量。我很难解释，所以这里是我努力的一个大大简化的示例：

```
class Class
    def super_accessor_wow(attr_name)
        attr_name = attr_name.to_s 
        new_var_name = "@crazy_var_name"

        instance_variable_set(new_var_name, ["hi", "everyone"])

        module_eval(%Q/
            def super_#{attr_name}()
                return @#{attr_name}
            end

            def super_#{attr_name}=(value)
                @#{attr_name} = value
            end

            def greetings
                return #{new_var_name}
            end
        /)
    end
end 
```

这就是我尝试使用新方法`Class`修改我自己的类的方式：

```
class Foo
    super_accessor_wow(:bar)
end

foo1 = Foo.new()
foo1.super_bar = 1000

puts foo1.super_bar
puts foo1.greetings.inspect 
```

第一个放版画`'1000'`

第二个 puts prints `'nil'`，所以我的`instance_variable_set`调用`super_accessor_wow`似乎没有效果。

我预计第二个 puts 会`'['hi', 'everyone']'`顺便打印出来。所有这些代码都包含在一个 Ruby 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:26:14.580

您在类定义期间`instance_variable_set`调用时调用。`super_accessor_wow`该类的实例尚不存在。当您调用`new`. 您可以将`@crazy_var_name`初始化添加到构造函数中，也可以在`greetings`方法中定义它：

将默认值放在类变量中，并在构造函数中初始化实例变量（请注意，这会为您的类创建一个构造函数，如果您随后创建自己的构造函数，它将覆盖该构造函数）：

```
class Class
    def super_accessor_wow(attr_name)
        attr_name = attr_name.to_s
        new_var_name = "@crazy_var_name"
        new_var_name_default = "@#{new_var_name}"

        module_eval(%Q/
            #{new_var_name_default} = ["hi", "everyone"]

            def initialize()
              #{new_var_name} = #{new_var_name_default}
            end

            def super_#{attr_name}()
                return @#{attr_name}
            end

            def super_#{attr_name}=(value)
                @#{attr_name} = value
            end

            def greetings
                return #{new_var_name}
            end
        /)
    end
end

class Foo
    super_accessor_wow(:bar)
end

foo1 = Foo.new()
foo1.super_bar = 1000

puts foo1.super_bar
puts foo1.greetings.inspect
puts Foo.class_variable_get('@@crazy_var_name').inspect
puts foo1.instance_variable_get('@crazy_var_name').inspect 
```

输出：

```
1000
["hi", "everyone"]
["hi", "everyone"]
["hi", "everyone"] 
```

在`greetings`方法中定义它：

```
class Class
    def super_accessor_wow(attr_name)
        attr_name = attr_name.to_s
        new_var_name = "@crazy_var_name"

        module_eval(%Q/
            def super_#{attr_name}()
                return @#{attr_name}
            end

            def super_#{attr_name}=(value)
                @#{attr_name} = value
            end

            def greetings
                #{new_var_name} = ["hi", "everyone"] unless #{new_var_name}
                return #{new_var_name}
            end
        /)
    end
end

class Foo
    super_accessor_wow(:bar)
end

foo1 = Foo.new()
foo1.super_bar = 1000

puts foo1.super_bar
puts foo1.greetings.inspect 
```

输出

```
1000
["hi", "everyone"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:26:55.453

如评论中所述， instance_variable_set 采用符号，而不是字符串，因此我们将首先修复它。

```
instance_variable_set(new_var_name.to_sym, ["hi", "everyone"]) 
```

但最大的问题是 instance_variable_set 不是由 Foo 的实例调用的，而是由 Foo 类本身调用的。因此，正在设置一个实例变量，但不是您所期望的。

```
Foo.instance_variable_get(:@crazy_var_name).inspect
# ["hi", "everyone"] 
```

# emacs - 防止emacs完成后自动关闭窗口

> ID：11705318
> 
> 赞同：5
> 
> 时间：2012-07-28T22:54:50.413
> 
> 标签：emacs

这是已经提到的问题的一些变体，但我无法弄清楚究竟是什么。

我的框架分为三个窗口：

```
----------------
|       |      |
|       |------|
|       |shell |
---------------- 
```

当我输入 shell 时，我会使用“tab”来完成。它们出现在左侧的窗口中。然后emacs不会关闭缓冲区，而是关闭整个窗口，我只剩下一个水平分割的屏幕：

```
----------------
|              |
|--------------|
| shell        |
---------------- 
```

我不确定我是否了解如何阻止这种情况发生，而且我记得这不是一个问题。我的拙劣尝试设法达到了 emacs 根本不会关闭完成建议缓冲区的状态，但这也不理想。

我该怎么做才能让emacs正常关闭完成缓冲区，但不理会我的窗口？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T23:21:33.457

`M-x` [专用模式](https://bitbucket.org/jek/dot-emacs/src/31c6d525e006/el/emacs-goodies-el/dedicated.el)

```
;; This minor mode allows you to toggle a window's "dedicated" flag.
;; When a window is "dedicated", Emacs will not select files into that
;; window. This can be quite handy since many commands will use
;; another window to show results (e.g., compilation mode, starting
;; info, etc.) A dedicated window won't be used for such a purpose.
;;
;; Dedicated buffers will have "D" shown in the mode line. 
```

# android - 是否可以缩放 ImageView 使其下方的 LinearLayout 始终完全可见？

> ID：11705319
> 
> 赞同：0
> 
> 时间：2012-07-28T22:55:10.163
> 
> 标签：android, android-layout

我的布局如下。在某些 mdpi 屏幕上，内部 LinearLayout 被截断。我想要做的是确保内部的 LinearLayout 总是显示它的所有内容。我希望 ImageView 缩小到它需要确保它下面的 LinearLayout 显示它的所有内容。在大屏幕上，ImageView 应该和它的图像一样大（即`wrap_content`）。

我尝试将 ImageView a设为`layout_weight`0.1，LinearLayout a设为`layout_weight`0.9（并将它们`layout_height`都设为 0dp），但随后在较大的屏幕上，ImageView 最终位于布局的顶部。我希望根 LinearLayout 的内容居中。

那么是否可以仅在需要时使 ImageView 缩小，使其下方的 LinearLayout 始终完全可见？我试图在没有为不同的屏幕尺寸/分辨率创建多个布局文件的情况下完成此任务。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    style="@style/tab_fragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    tools:context=".messages.MessagesHomeFragment"
    >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="40dp"
        android:src="@drawable/elephant_large" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="vertical"
        >

        <Button
            android:id="@+id/button_send_voice_message"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Send a Voice Message" />

        <Button
            android:id="@+id/button_send_sms_message"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Send an SMS" />

        <Button
            android:id="@+id/button_view_messages"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Manage Messages" />

        <Button
            android:id="@+id/button_invite_sms_recipients"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Invite SMS Recipients" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:05:01.167

我不确定这是否可能......如果有的话，我会尝试类似下面描述的布局（我没有尝试过，我担心图像会尽可能多地增长）。我只更改了 ImageView 的布局属性

如果这仍然不起作用，那么基于 ImageView 定义您自己的小部件应该不会太难，您只需要覆盖 onLayout 方法以缩小只有当您获得的 measureSpec 小于图像时...

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    style="@style/tab_fragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    tools:context=".messages.MessagesHomeFragment"
    >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:scaleType="centerInside"
        android:layout_marginBottom="40dp"
        android:src="@drawable/elephant_large" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="vertical"
        >

        <Button
            android:id="@+id/button_send_voice_message"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Send a Voice Message" />

        <Button
            android:id="@+id/button_send_sms_message"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Send an SMS" />

        <Button
            android:id="@+id/button_view_messages"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Manage Messages" />

        <Button
            android:id="@+id/button_invite_sms_recipients"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Invite SMS Recipients" />
    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:29:24.000

通过使用下面的布局，我能够完成我想做的事情。关键是将根 LinearLayout 的高度`wrap_content`设置`layout_weight`为并将 ImageView 的高度设置为 1。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    style="@style/tab_fragment"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:gravity="center"
    android:orientation="vertical"
    >

    <ImageView
        android:id="@+id/elephantImageView"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:scaleType="fitCenter"
        android:layout_marginBottom="20dp"
        android:src="@drawable/elephant_large"
        />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:orientation="vertical"
        >

        <Button
            android:id="@+id/button_send_voice_message"
            android:layout_width="239dp"
            android:layout_height="wrap_content"
            android:text="Send a Voice Message" />

        ...
    </LinearLayout>
</LinearLayout> 
```

# jquery - 为什么 JQuery .Resize() 给我带来麻烦？

> ID：11705321
> 
> 赞同：0
> 
> 时间：2012-07-28T22:55:33.230
> 
> 标签：jquery, css

`content`当用户调整页面大小时，我试图让页面上的div 自行修复。我在顶部和底部都有静态 div，使`content`div 成为唯一可以调整大小以随页面流动的 div。

```
$(window).resize(function() {
    var height = $("#content").height();
    newheight = (height-136)+"px";
    $("#content").css("height",newheight);
});
function test() {
    var height = $("#content").height();
    newheight = (height-136)+"px";
    $("#content").css("height",newheight);
} 
```

我从高度中减去 136px，以便它适合我的两个静态 div 之间。

在页面加载时，我运行该`test()`函数，它会调整内容 div 的大小。但是，当我使用大小调整手柄调整窗口大小时，它会一直缩小到内容的大小（现在只有几个词）。

这是页面本身：[spynsycle.com/ttr](http://spynsycle.com/ttr) （忽略丑陋的绿色，它仅用于调试目的）

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:09:22.893

As stated by @JaredFarris, you need to be taking `$(window).height()`. For example if you go to the site in Chrome or Firefox (with Firebug) and put the following in the console, it resizes perfectly as you want it to:

```
$(window).resize(function() {
    var height = $(window).height();
    newheight = (height-136)+"px";
    $("#content").css("height",newheight);
}); 
```

# gcc - 不允许创建一个没有 .c 文件的静态库吗？

> ID：11705324
> 
> 赞同：1
> 
> 时间：2012-07-28T22:56:03.037
> 
> 标签：gcc, static-libraries, unix-ar

我有两个文件->`fact.h`和文件夹中`main.c`。具有调用函数的 main 函数。我正在使用 ar 命令创建存档 ->`/home/snyp1/new``main.c``fact(int x)``fact.h``.a`

```
snyp1@Snyp:~/new$ ar -r -s libfact.a fact.o
ar: creating libfact.a
fact.h  fact.o  libfact.a  main.c
snyp1@Snyp:~/new$ gcc main.c -L/home/snyp1/new -lfact -o main
/home/snyp1/new/libfact.a: could not read symbols: Archive has no index; run ranlib to add one
collect2: ld returned 1 exit status
snyp1@Snyp:~/new$ ranlib libfact.a
snyp1@Snyp:~/new$ gcc main.c -L/home/snyp1/new -lfact -o main
/home/snyp1/new/libfact.a: could not read symbols: Archive has no index; run ranlib to add one
collect2: ld returned 1 exit status 
```

我在 ubuntu 12.04 上。请让我知道有什么问题。（另外，如果我不使用`-L/.../new`，gcc 会说它找不到“lfact”，可能是因为它不在`/usr/local/lib`）

编辑：好的，我找到了原因。这是由于我`fact.h`用来构建`fact.o`然后将其放入库中的事实，它没有按预期工作。所以我现在把它改成了`file.c`现在工作正常。我应该提供这些信息，对不起。虽然我不知道为什么会出现这种问题。如果没有至少一个`.c`文件，就不能制作库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:29:06.680

> 我正在使用 fact.h 来构建 fact.o，然后将其放入库中，但它没有按预期工作。

你的意思是你正在编译`fact.h`生产`fact.o`？

如果是这样，那并没有达到您的预期。当您调用`gcc`头文件时，它会生成预编译的头文件，**而不是**目标文件。因此，尽管您有一个名为`foo.o`它的文件，但它不是有效的目标文件。如果你刚刚运行`gcc -c fact.h`它会产生一个预编译的头文件`fact.gch`，但可能你运行`gcc -c fact.h -o fact.o`了导致文件被调用`fact.o`，即使它仍然是一个预编译的头文件。 `file fact.o`会表明：

```
$ file fact.o
fact.o: GCC precompiled header (version 013) for C 
```

您可以通过运行强制 GCC 将文件视为 C 代码，而不是标头`gcc -x c -c fact.h -o fact.o`（`-x c`说将输入视为 C 代码，而不是从文件扩展名中推断类型），但仅命名您的文件可能更简单且更容易混淆文件正确，而不是尝试编译头文件。

> 如果没有至少一个 .c 文件，就不能制作库吗？

他们至少需要一个目标文件（即`.o`文件），但您没有有效的对象，您有一个被误导性命名为的预编译头文件`.o`，但它实际上不是目标文件。

> 如果我不使用`-L/.../new`，gcc 会说它找不到“lfact”，可能是因为它不在`/usr/local/lib`

链接器不仅会查看 in `/usr/local/lib`，还会查看其他默认位置，但是是的，这基本上就是问题所在。请注意，您也可以说`-L.`库是否在当前目录中，这比提供绝对路径更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T23:27:12.783

`ar`除了第一个选项之外，我不确定是否支持破折号。尝试

```
ar -rs libfact.a fact.o 
```

要不就

```
ar rs libfact.a fact.o 
```

请注意，我不知道为什么跑步`ranlib`不起作用。

# apache - Apache Jboss SSL 身份验证

> ID：11705335
> 
> 赞同：0
> 
> 时间：2012-07-28T22:59:10.737
> 
> 标签：apache, ssl, jboss, reverse-proxy

总结我的问题：

我有一个面向 Jboss 的 Apache Web 服务器。下面是 Httpd conf 的 ssl 部分

```
ProxyRequests Off
SSLProxyEngine on

SSLCertificateFile 
/FinMgmt/deploy/https/certs/webserver/fm.insurance.co.uk_a_cert.pem
SSLCertificateKeyFile
/FinMgmt/deploy/https/certs/webserver/fm.insurance.co.uk_a_key.pem

SSLCACertificateFile       
/FinMgmt/deploy/https/certs/fm.insurance.co.uk_CA_cert.pem
SSLVerifyClient optional_no_ca
SSLOptions +ExportCertData
ProxyPass /webapp1 https://fm.insurance.co.uk:8443/webapp1
ProxyPassReverse /webapp1 https://fm.insurance.co.uk:8443/webapp1
ProxyPass /webapp2 https://fm.insurance.co.uk:8443/webapp2
ProxyPassReverse /webapp2 https://fm.insurance.co.uk:8443/webapp2 
```

下面是来自 jboss server.xml 的 ssl 部分：

```
 <!-- SSL/TLS Connector configuration using the admin devl guide keystore clientAuth=false -->
    <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
    maxThreads="500" scheme="https" secure="true"
    clientAuth="false" sslProtocol="TLS"
    keystoreFile="${jboss.server.home.dir}/conf/server.keystore"
    keystorePass="glamdev"
    truststoreFile="${jboss.server.home.dir}/conf/server.truststore"

    truststorePass="passwd"/> 
```

据我了解，Apache 配置为使用 SSLVerifyClient optional_no_ca 的 2 路相互身份验证，这意味着客户端可能提供也可能不提供证书。

现在 jboss 被配置为一种方式的 SSL 身份验证。现在我的理解是，当浏览器发送请求 apache 时，apache 将响应证书，浏览器将尝试使用其根 CA 进行身份验证或抛出异常，要求用户存储它。

当 apache 将请求路由到 jboss 时，这里 apache 将充当客户端，jboss 作为 SSL 服务器，jboss 将从密钥库发送其证书，该证书将由 Apache 使用 SSLCACertificateFile 指令进行验证

如果 jboss 必须重定向到自己，它必须通过反向代理，因为我们设置了 proxyPassReverse。在这种情况下，jboss 将充当 SSL 客户端，Apache http 作为 SSL 服务器，Apache 将发送 jboss 验证使用的证书信任库中的 CA 证书。我在解释配置文件方面是对的吗？

另外我不完全理解在 SSLVerifyClient 中使用 optional_no_ca。apache 是否会从浏览器请求证书，或者它取决于浏览器？

实际上，我继承了这个应用程序而没有任何文档，我正在努力理解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T19:40:44.533

我假设您所追求的是在您的 JBoss 应用程序中使用客户端证书身份验证来验证浏览器（而不是 Apache Httpd 作为 JBoss 的客户端）。

如果你想让 Apache Httpd 作为 JBoss 容器前面的反向代理，你需要配置 Apache Httpd 来请求和处理客户端证书身份验证。特别是，您应该使用它的`SSLCA*`和`SSLVerifyClient`指令，它是[`mod_ssl`](http://httpd.apache.org/docs/2.2/mod/mod_ssl.html).

在 Apache Httpd 和 JBoss 工作节点之间配置 SSL/TLS 是独立的。如果您当时在受信任的网络上，通常没有必要这样做。如果您确实需要 SSL/TLS，请使用 Apache Httpd 的`SSLProxy*`指令来配置要信任的 CA。话虽如此，这样做肯定会在您的应用程序中造成更多混乱，因为客户端证书信息的来源会产生歧义：JBoss 容器级别的真实客户端证书身份验证或中继证书，由 Apache Httpd 处理。

实际上，您需要将客户端证书信息传递给您的容器以获取更多信息，如[本答案](https://stackoverflow.com/a/11697582/372643)中所述。

* * *

相反，如果您追求的是 Apache Httpd 和 JBoss 之间的客户端证书身份验证，您需要使用 SSL/TLS 保护此连接并确保是否来自反向代理（将提供其证书），您应该能够使用[`SSLProxyMachineCertificateFile`](http://httpd.apache.org/docs/2.4/mod/mod_ssl.html#sslproxymachinecertificatefile)Apache Httpd 2.4 中的可用功能。（这种配置当然不寻常。）

* * *

**编辑：（**随着问题的变化。）

> 据我了解，Apache 配置为使用 SSLVerifyClient optional_no_ca 的 2 路相互身份验证，这意味着客户端可能提供也可能不提供证书。

`SSLVerifyClient optional_no_ca`意味着 Apache Httpd 只会检查客户端是否拥有它提供的证书的私钥：它不会验证证书是否受信任（变得`SSLCACertificateFile`无用）。如果您希望证书的显示是可选的，但仍要根据您的 PKI 进行验证，请使用`SSLVerifyClient optional`(with `SSLCACertificateFile`)。

> 现在 jboss 被配置为一种方式的 SSL 身份验证。现在我的理解是，当浏览器发送请求 apache 时，apache 将响应证书，浏览器将尝试使用其根 CA 进行身份验证或抛出异常，要求用户存储它。

是的，而且浏览器与 Apache Httpd 的连接与 JBoss 无关。

> 当 apache 将请求路由到 jboss 时，这里 apache 将充当客户端，jboss 作为 SSL 服务器，jboss 将从密钥库发送其证书，该证书将由 Apache 使用 SSLCACertificateFile 指令进行验证

不，它是`SSLProxyCACertificateFile`（或`...Path`）

> 如果 jboss 必须重定向到自己，它必须通过反向代理，因为我们设置了 proxyPassReverse。在这种情况下，jboss 将充当 SSL 客户端，Apache http 作为 SSL 服务器，Apache 将发送 jboss 验证使用的证书信任库中的 CA 证书。我在解释配置文件方面是对的吗？

我不确定在哪种情况下 JBoss 会“重定向到自己”（或者您的意思是什么）。没有任何迹象表明 JBoss 在这里扮演了客户的角色。这[不是](http://www.humboldt.co.uk/2009/02/the-mystery-of-proxypassreverse.html)[什么`ProxyPassReverse`](http://www.humboldt.co.uk/2009/02/the-mystery-of-proxypassreverse.html)。

> 另外我不完全理解在 SSLVerifyClient 中使用 optional_no_ca。apache 是否会从浏览器请求证书，或者它取决于浏览器？

当您设置`SSLVerifyClient`为`optional`、`optional_no_ca`或`require`时，服务器将请求证书。使用`require`，如果客户端不发送（它信任的）连接，它将终止连接。

就您的配置而言，没有任何迹象表明将客户端证书传送到 JBoss 容器。它没有在 Apache Httpd 级别以任何方式进行验证（任何拥有自签名客户端证书的人都可以在此处连接）。原则上，您可以使用`optional_no_ca`, 让任何证书通过，并且仅在它们到达 Java 容器后对其进行验证，但您肯定需要一些额外的自定义代码才能在 JBoss 应用程序中执行此操作。您还需要以某种方式传达证书本身（例如，通过`mod_header`自定义标头或更直接使用`mod_proxy_ajp`.

# php - 使用带有 unicode 消息的 PHP API 发送 SMS

> ID：11705336
> 
> 赞同：2
> 
> 时间：2012-07-28T22:59:41.367
> 
> 标签：php, string, function, unicode

我试图通过 RoutoMessaging PHP API 发送短信。我阅读了我能找到的所有文档和示例。他们有用于以 unicode 格式发送 SMS 的 PHP 示例脚本：

```
<?php  
// include RoutoSMS class  
include("RoutoTelecomSMS.php");  
// creating object  
$sms = new RoutoTelecomSMS;  
// setting login parameters  
$sms->SetUssms->SetOwnNum("44792838383838");  
$sms->SetType("unicode"); 
// get values entered from FORM  
$sms->SetNumber($number);  
$message="04220432043E04580435002004370435043B0435043D04350020043E0
44704380020044104430020043C04380020043F0430043C043504420020043F043E
043C044304420438043B0435002E002E002E"; 
$sms->SetMessage($message);  
// send SMS and print result  
$smsresult = $sms->Send();  
print $smsresult;  
?> 
```

我不明白的是如何将文本从提交的字符串转换为包含在 $message 中所需的代码。任何人都可以建议将文本转换为 $message 的功能吗？我目前使用 PHP 版本 5.3.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:14:40.863

您发送的消息是 Cryllic 文本。应该是塞尔维亚语吧。它读作“ **Твојезеленеочисумипаметпомутиле...** ”

解码

```
header('Content-Type: text/html; charset=utf-8');
$str = "04220432043E04580435002004370435043B0435043D04350020043E044704380020044104430020043C04380020043F0430043C043504420020043F043E043C044304420438043B0435002E002E002E";
foreach(str_split($str, 4) as $char) echo "&#x{$char};"; 
```

这就是您对消息进行编码的方式

```
$string = "Твоје зелене очи су ми памет помутиле...";
$string = mb_convert_encoding($string, 'UCS-2', 'utf8');
for($i =0; $i < strlen($string); $i++)
    echo strtoupper(bin2hex($string[$i])); 
```

# javascript - javascript/jquery 禁用点击提交按钮，防止重复提交

> ID：11705337
> 
> 赞同：8
> 
> 时间：2012-07-28T22:59:49.200
> 
> 标签：javascript, jquery, double-submit-prevention

所以我有一个看起来像这样的提交按钮：

```
<a href="#" id="submitbutton" 
onClick="document.getElementById('UploaderSWF').submit();">
<img src="../images/user/create-product.png" border="0" /></a> 
```

当我双击它时，显然是双重提交，问题是我将信息保存在数据库中，所以我将在那里有重复的信息，我不希望那样。这个上传者使用 flash 和 javscript，这里有一小段与提交相关的代码（如果有帮助的话）

```
$.fn.agileUploaderSubmit = function() {
    if($.browser.msie && $.browser.version == '6.0') {
        window.document.agileUploaderSWF.submit();
    } else {
        document.getElementById('agileUploaderSWF').submit();
        return false;
    }
} 
```

感谢你们。我感谢您的帮助。这真的是我自己做不到的事情，因为我对 js 有一点经验，而且我真的不知道该怎么做。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-28T23:04:17.240

试试这个剪断：

```
$('#your_submit_id').click(function(){
    $(this).attr('disabled');
}); 
```

**编辑 1**

哦，在你的情况下，它是一个链接，没有提交按钮......

```
var submitted = false;

$.fn.agileUploaderSubmit = function() {
    if ( false == submitted )
    {
        submitted = true;

        if($.browser.msie && $.browser.version == '6.0') {
            window.document.agileUploaderSWF.submit();
        } else {
            document.getElementById('agileUploaderSWF').submit();
        }
    }

    return false;
} 
```

**编辑 2**

为了简化这一点，试试这个：

```
<!doctype html>

<html dir="ltr" lang="en">

<head>

<meta charset="utf-8" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
<!--//--><![CDATA[//><!--
    $(document).ready(function()
    {
        $('#yourSubmitId').click(function()
        {
            $(this).attr('disabled',true);

            /* your submit stuff here */

            return false;
        });
    });
//--><!]]>
</script>

</head>
<body>

<form id="yourFormId" name="yourFormId" method="post" action="#">
    <input type="image" id="yourSubmitId" name="yourSubmitId" src="yourImage.png" alt="Submit" />
</form>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

</body>
</html> 
```

使用表单元素，如`<input type="image" />`，提交表单不是正常的链接。

这很好用！

查看[jQuery.post()](http://api.jquery.com/jQuery.post/)以提交您的表单。

祝你好运。

**编辑 3**

这对我也很有效：

```
<!doctype html>

<html dir="ltr" lang="en">

<head>

<meta charset="utf-8" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
<!--//--><![CDATA[//><!--
    $(document).ready(function()
    {
        var agileUploaderSWFsubmitted = false;

        $('#submitbutton').click(function()
        {
            if ( false == agileUploaderSWFsubmitted )
            {
                agileUploaderSWFsubmitted = true;

                //console.log( 'click event triggered' );

                if ( $.browser.msie && $.browser.version == '6.0' )
                {
                    window.document.agileUploaderSWF.submit();
                }
                else
                {
                    document.getElementById( 'agileUploaderSWF' ).submit();
                }
            }

            return false;
        });
    });
//--><!]]>
</script>

</head>
<body>

<form id="agileUploaderSWF" name="agileUploaderSWF" method="post" action="http://your.action/script.php">
    <input type="text" id="agileUploaderSWF_text" name="agileUploaderSWF_text" />
</form>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

<a href="#" id="submitbutton"><img src="../images/user/create-product.png" border="0" /></a>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​

</body>
</html> 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-28T23:06:25.580

Add the following to the `onclick`:

```
onclick="document.getElementById('submitbutton').disabled = true;document.getElementById('UploaderSWF').submit();" 
```

That said, you will have to handle this double submit prevention on the server side also.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T03:16:14.010

如果单击，这将禁用所有提交按钮和带有类 submit 或属性 data-submit 的表单中的链接：

```
$(document).ready(function() {
    $('form').submit(function() {
        $(this).find('input[type="submit"]').attr('disabled', true);
        $(this).find('a[data-submit], a.submit').click(function() {
            return false;
        });
    }
}); 
```

顺便说一句，这自动适用于每种形式。如果您只想要某个，请使用 id 而不是表单。不过，您很可能已经知道这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-27T19:39:42.177

根据[http://api.jquery.com/prop/](http://api.jquery.com/prop/) 您可以使用 .prop() 函数添加和删除禁用的属性，而不是 .attr() 和 .removeAttr() 函数。

要添加属性：

```
.prop("disabled", true); 
```

要删除该属性：

```
.prop("disabled", false); 
```

希望这会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-14T10:50:52.860

如此处提议[的](https://stackoverflow.com/questions/11556571/prevent-click-event-from-firing-multiple-times-issue-with-fading/58854220#58854220)（带有示例）：

如果你想确保注册的事件只被触发一次，你应该使用 jQuery 的 [one][1] ：

> .one( events [, data ], handler ) 返回：jQuery
> 
> 描述：将处理程序附加到元素的事件。每个事件类型的每个元素最多执行一次处理程序。

# iphone - UITableView 的固定高度

> ID：11705339
> 
> 赞同：0
> 
> 时间：2012-07-28T23:00:05.830
> 
> 标签：iphone, ios, uitableview

我在另一个视图中有一个 UITableView。我想让 UITbeView 的高度保持不变。我有可变数量的行，但我想要 UITableView 常量的高度，以便当行增加时它不会隐藏它下面的视图。我该怎么做呢？我尝试设置 autoresizingmask 但这没有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:07:01.697

[EPyLEpSY](https://stackoverflow.com/users/1039901/epylepsy) is correct.

```
CGRect tbFrame = [myTableView frame];
tbFrame.size.height = 100;
[myTableView setFrame:tbFrame]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:01:44.773

您可以使用以下方法：

```
- (id)initWithFrame:(CGRect)frame style:(UITableViewStyle)style 
```

并使用您想要的宽度和高度初始化框架。

样式可以是以下选项之一： UITableViewStylePlain UITableViewStyleGrouped

我建议查看[UITableView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)以获取更多信息

# c# - Response.End 和 handler.ashx

> ID：11705340
> 
> 赞同：1
> 
> 时间：2012-07-28T23:00:26.163
> 
> 标签：c#, asp.net, csv, handler

我有一个处理程序，它生成一个 csv 文件并提供下载，这个处理程序由我的 defoult.aasp 上的代码隐藏中的按钮调用，如下所示：

```
 Response.Redirect("~/Handler.ashx?startDate="+tbStartDate.Text.Trim()+"&endDate="+tbEndDate.Text+"&isCheck="+chkDuplication.Checked.ToString()); 
```

现在我在上面的代码之后有另一行应该更新我的列表视图，但列表视图没有更新，有什么方法可以在 csv 下载后更新列表视图。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:13:24.793

问题在于您的重定向。从[微软文档](http://msdn.microsoft.com/en-us/library/ms524309%28v=vs.90%29.aspx)：

> 原始 URL 指示的页面中的任何响应正文内容（例如显示的 HTML 文本或 Response.Write 文本）都将被忽略。

根据需要进行的处理，您有几个选项：

1.  如果您不需要发回页面即可打开文件，您可以使用 ashx 页面（包括其查询字符串）作为 URL 在 javascript 中打开一个新窗口（window.open，目标为“_blank”） .

2.  如果您的页面需要回发，您可以在服务器端生成 javascript，并在页面首次使用[Page.ClientScript.RegisterStartupScript](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx)重新加载到浏览器时执行。

我们实际上根据具体要求使用这两种方法。一般来说，我们更喜欢第一种方法，即使这意味着在 javascript 中需要做更多的工作，但有时回发是不可避免的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T00:23:04.943

尝试使用 endResponse 属性，该属性指示当前页面的执行是否应该终止，将其设为 false 以便执行 Response.End 下面的行。

当您在 HTTP 处理程序中调用 Response.Redirect 方法并且想要重定向到另一个页面而不终止请求时，请将 endResponse 设置为 false。索鲁斯 - [http://msdn.microsoft.com/en-us/library/a8wa7sdt(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/a8wa7sdt(v=vs.90).aspx)

```
 Response.Redirect("url",false);
   // code to update your list view 
```

# php - 为什么 Eclipse PDT 将这些行标记为错误？

> ID：11705348
> 
> 赞同：0
> 
> 时间：2012-07-28T23:01:30.210
> 
> 标签：php, eclipse, eclipse-pdt

Eclipse PDT 将两行标记为错误。我的网站在浏览器中运行良好，没有错误，但是 Eclipse 中的红色“x”让我很烦。这是两行：

```
<?xml-stylesheet type="text/xsl" media="screen" href="<?php echo HOME ?>css/xsl/template.xsl" ?>
<?xml-stylesheet type="text/css" media="screen" href="<?php echo HOME ?>css/xsl/style.css" ?> 
```

我已经禁用了短标签，所以我不知道为什么它仍然被认为是一个错误。

顺便说一句，错误消息是：

> 处理指令未关闭。

**编辑：**我更改了这两行以使 PHP 回显这些行。这解决了问题，但我仍然想知道为什么会发生这种情况。在选择正确答案之前，我会等待一两天的新答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:09:23.447

我认为这是他解析器中的一个错误。我猜如果你删除红色标记会消失`<?php echo HOME ?>`。如果这是真的，你可以忽略这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T12:19:09.047

Eclipse 设置的“PHP > PHP Interpreter”部分中有一个“使用短标签”复选框。

# c# - 复杂场景的参考跟踪失败

> ID：11705351
> 
> 赞同：1
> 
> 时间：2012-07-28T23:01:50.910
> 
> 标签：c#, .net, protobuf-net

使用 R556，以下复杂场景的引用跟踪失败，请参阅测试中的断言。使用 shim 类而不是自定义集合的代理不会改变问题。

显然 SO 不喜欢我的描述，所以也许这个无用的文本会让我的问题通过机器人的集合。

```
using System.Collections.Generic;
using System.IO;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using ProtoBuf;
using ProtoBuf.Meta;

[TestClass]
public class UnitTest
{
    [ProtoContract]
    public class Whole
    {
        public Whole() { this.Parts = new PartCollection { Whole = this }; }
        [ProtoMember(1)]
        public readonly PartCollection Parts;
    }

    [ProtoContract]
    public class Part
    {
        [ProtoMember(1, AsReference = true)]
        public Whole Whole { get; set; }
    }

    public class PartCollection : List<Part>
    {
        public Whole Whole { get; set; }
    }

    [ProtoContract]
    public class Assemblage
    {
        [ProtoMember(1)]
        public readonly PartCollection Parts = new PartCollection();
    }

    [ProtoContract]
    public class PartCollectionSurrogate
    {
        [ProtoMember(1)]
        private PartCollection Collection { get; set; }

        [ProtoMember(2)]
        private Whole Whole { get; set; }

        public static implicit operator PartCollectionSurrogate(PartCollection value)
        {
            if (value == null) return null;
            return new PartCollectionSurrogate { Collection = value, Whole = value.Whole };
        }

        public static implicit operator PartCollection(PartCollectionSurrogate value)
        {
            if (value == null) return new PartCollection();
            value.Collection.Whole = value.Whole;
            return value.Collection;
        }
    }

    [TestMethod]
    public void TestMethod1()
    {
        RuntimeTypeModel.Default.Add(typeof(PartCollection), false).SetSurrogate(typeof(PartCollectionSurrogate));
        using (var stream = new MemoryStream())
        {
            {
                var whole = new Whole();
                var part = new Part { Whole = whole };
                whole.Parts.Add(part);
                var assemblage = new Assemblage();
                assemblage.Parts.Add(part);
                Serializer.Serialize(stream, assemblage);
            }

            stream.Position = 0;

            var obj = Serializer.Deserialize<Assemblage>(stream);
            {
                var assemblage = obj;
                var whole = assemblage.Parts[0].Whole;
                var referenceEqual = ReferenceEquals(assemblage.Parts[0], whole.Parts[0]);

                // The following assertion fails.
                Assert.IsTrue(referenceEqual);
            }
        }
    }
} 
```

这是使用 shim 类而不是有效的代理的固定代码。

```
using System.Collections.Generic;
using System.IO;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using ProtoBuf;

[TestClass]
public class UnitTest2
{
    [ProtoContract]
    public class Whole
    {
        public Whole() { this.Parts = new PartCollection { Whole = this }; }

        public PartCollection Parts;

        [ProtoMember(1)]
        public PartCollectionData PartsData
        {
            get { return PartCollectionData.ToData(Parts); }
            set { Parts = PartCollectionData.FromData(value); }
        }
    }

    [ProtoContract]
    public class Part
    {
        [ProtoMember(1, AsReference = true)]
        public Whole Whole { get; set; }
    }

    [ProtoContract(IgnoreListHandling = true)]
    public class PartCollection : List<Part>
    {
        public Whole Whole { get; set; }
    }

    [ProtoContract]
    public class Assemblage
    {
        public PartCollection Parts = new PartCollection();

        [ProtoMember(1)]
        public PartCollectionData PartsData
        {
            get { return PartCollectionData.ToData(Parts); }
            set { Parts = PartCollectionData.FromData(value); }
        }
    }

    [ProtoContract]
    public class PartCollectionData
    {
        [ProtoMember(1, AsReference = true)]
        public List<Part> Collection { get; set; }

        [ProtoMember(2, AsReference = true)]
        public Whole Whole { get; set; }

        public static PartCollectionData ToData(PartCollection value)
        {
            if (value == null) return null;
            return new PartCollectionData { Collection = value, Whole = value.Whole };
        }

        public static PartCollection FromData(PartCollectionData value)
        {
            if (value == null) return null;

            PartCollection result = new PartCollection { Whole = value.Whole };
            if (value.Collection != null)
                result.AddRange(value.Collection);
            return result;
        }
    }

    [TestMethod]
    public void TestMethod1()
    {
        using (var stream = new MemoryStream())
        {
            {
                var whole = new Whole();
                var part = new Part { Whole = whole };
                whole.Parts.Add(part);
                var assemblage = new Assemblage();
                assemblage.Parts.Add(part);
                Serializer.Serialize(stream, assemblage);
            }

            stream.Position = 0;

            var obj = Serializer.Deserialize<Assemblage>(stream);
            {
                var assemblage = obj;
                var whole = assemblage.Parts[0].Whole;
                Assert.AreSame(assemblage.Parts[0].Whole, whole.Parts[0].Whole, "Whole");
                Assert.AreSame(assemblage.Parts[0], whole.Parts[0], "Part");
            }
        }
    }
} 
```

这是有效的固定代理代码。

```
using System.Collections.Generic;
using System.IO;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using ProtoBuf;
using ProtoBuf.Meta;

[TestClass]
public class UnitTest
{
    [ProtoContract]
    public class Whole
    {
        public Whole() { this.Parts = new PartCollection { Whole = this }; }

        [ProtoMember(1)]
        public PartCollection Parts;
    }

    [ProtoContract]
    public class Part
    {
        [ProtoMember(1, AsReference = true)]
        public Whole Whole { get; set; }
    }

    [ProtoContract(IgnoreListHandling = true)]
    public class PartCollection : List<Part>
    {
        public Whole Whole { get; set; }
    }

    [ProtoContract]
    public class Assemblage
    {
        [ProtoMember(1)]
        public PartCollection Parts = new PartCollection();
    }

    [ProtoContract]
    public class PartCollectionSurrogate
    {
        [ProtoMember(1, AsReference = true)]
        public List<Part> Collection { get; set; }

        [ProtoMember(2, AsReference = true)]
        public Whole Whole { get; set; }

        public static implicit operator PartCollectionSurrogate(PartCollection value)
        {
            if (value == null) return null;
            return new PartCollectionSurrogate { Collection = value, Whole = value.Whole };
        }

        public static implicit operator PartCollection(PartCollectionSurrogate value)
        {
            if (value == null) return null;
            PartCollection result = new PartCollection { Whole = value.Whole };
            if (value.Collection != null)
                result.AddRange(value.Collection);
            return result;
        }
    }

    [TestMethod]
    public void TestMethod1()
    {
        RuntimeTypeModel.Default.Add(typeof(PartCollection), true).SetSurrogate(typeof(PartCollectionSurrogate));
        using (var stream = new MemoryStream())
        {
            {
                var whole = new Whole();
                var part = new Part { Whole = whole };
                whole.Parts.Add(part);
                var assemblage = new Assemblage();
                assemblage.Parts.Add(part);
                Serializer.Serialize(stream, assemblage);
            }

            stream.Position = 0;

            var obj = Serializer.Deserialize<Assemblage>(stream);
            {
                var assemblage = obj;
                var whole = assemblage.Parts[0].Whole;
                Assert.AreSame(assemblage.Parts[0].Whole, whole.Parts[0].Whole, "Whole");
                Assert.AreSame(assemblage.Parts[0], whole.Parts[0], "Part"); 
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T08:01:08.080

好的; 这里发生了很多事情。

首先要注意的是，您的代理人目前没有被使用；列表优先。我们可以通过以下方式进行调整：

```
[ProtoContract(IgnoreListHandling = true)]
public class PartCollection : List<Part>
{
    public Whole Whole { get; set; }
} 
```

（尽管请注意，在这种*特殊*情况下，它还需要进行内部调整（r558）-这可能应该立即警告您正在做一些粗糙的事情）

完成此操作后，我们得到一个异常：

> 测试“Examples.Issues.SO11705351.TestMethod1”失败：ProtoBuf.ProtoException：检测到可能的递归（偏移量：1 级）：Examples.Issues.SO11705351+PartCollection

这是完全正确的；您的代理`PartCollection`包括它试图代表的确切内容。这是一个明显的无限循环；所以让我们解决这个问题 - 也解决您似乎想要成为参考跟踪的事实`Whole`，但您没有在代理项上指定这一点：

```
[ProtoContract]
public class PartCollectionSurrogate
{
    [ProtoMember(1)]
    private List<Part> Collection { get; set; }

    [ProtoMember(2, AsReference = true)]
    private Whole Whole { get; set; }

    public static implicit operator PartCollectionSurrogate(PartCollection value)
    {
        if (value == null) return null;
        return new PartCollectionSurrogate { Collection = value, Whole = value.Whole };
    }

    public static implicit operator PartCollection(PartCollectionSurrogate value)
    {
        if (value == null) return null;

        PartCollection result = new PartCollection {Whole = value.Whole};
        if(value.Collection != null)
        { // add the data we colated
            result.AddRange(value.Collection);
        }
        return result;
    }
} 
```

好的; 所以现在我们正在序列化诸如正确数据之类的东西。

我们注意到单元测试仍然没有通过；它正在比较`assemblage.Parts[0]`和 `whole.Parts[0]`。现在，我们知道这`assemblage`与 不是同一个实例`whole`，因为它们是不同的类型，而且我们没有在任何地方说过它`Part`应该被引用跟踪，所以我们没有理由期望它通过。请注意，这`Whole` **是**跟踪的，因此以下通过：

```
Assert.AreSame(assemblage.Parts[0].Whole, whole.Parts[0].Whole, "Whole"); 
```

如果我们想引用-跟踪`Part`，我们*需要告诉它*（引用-跟踪不是默认的）；幸运的是，应用于`AsReference`列表*意味着*：“引用跟踪项目”，而不是“引用跟踪列表”，所以进一步调整我们的代理：

```
 [ProtoMember(1, AsReference = true)]
        private List<Part> Collection { get; set; } 
```

现在这两个都通过了：

```
Assert.AreSame(assemblage.Parts[0].Whole, whole.Parts[0].Whole, "Whole");
Assert.AreSame(assemblage.Parts[0], whole.Parts[0], "Part"); 
```

然而！！！！！！

我必须说：这变得微妙而复杂；每当这种情况开始发生时，我总是建议：考虑序列化一个更简单的 DTO 模型，并根据需要在它和复杂的域模型之间进行映射。

# php - 如何通过 stream_get_contents() 连续监听多个 TCP 流？

> ID：11705357
> 
> 赞同：3
> 
> 时间：2012-07-28T23:03:56.570
> 
> 标签：php, sockets, stream, network-programming, streaming

默认`stream_get_contents`情况下等待并侦听 60 秒。如果我有多个流并且想要连续收听所有流。

如果我正在听一个流，则在 foreach 内部，我无法听其他流。

连续监听和捕获所有流的流输出的解决方案是什么？

```
while(true){
   //$streamArray is an array of streams obtained by stream_socket_client("tcp://..);
   foreach($streamArray as $stream){
        fputs($stream,$command);
        stream_get_contents($stream);  // and update file/DB (Blocking call)
        }
    } 
```

注意：对于我已经完成的每个流`stream_set_blocking( $stream , true );`

更新：

我的要求是听一段时间的所有流，比如 30 分钟。同时我不能听 2 流。如果我有 5 个流，我的代码就是`time division multiplexing`，在 30 分钟内，每个单独的流将仅记录 6 分钟

我有一种解决方案可以对单个流发出 AJAX 请求并独立记录。当然我不想做这种多重 AJAX 调用方法，因为它会导致更多的代码以及更多的 CPU。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-28T23:50:35.613

随着您开始*同步*`stream_set_blocking($resource, true)`读取流，这意味着每次调用都会等待直到有数据要读取。然后调用，它从阻塞流中读取，直到到达 EOF（关闭）。结果是您一个接一个地读取流，而不是“同时”读取。*`fread()``stream_get_contents()`*

 *以这种方式读取流很常见并且最容易编码，但是当您想要同时处理多个流时，您必须自己处理缓冲区、计时和“流结束”检测。使用您当前的代码，这部分通过阻塞流和`stream_get_contents()`.

要同时读取多个流，您应该重写代码以*异步*读取流。

```
// $streamArray is an array of streams obtained by stream_socket_client("..");

$buffers = array();
$num_streams = 0;
foreach($streamArray as $stream) {
    // set streams non-blocking for asynchroneous reading
    stream_set_blocking($stream, false);
    // write command to all streams - multiplexing
    fputs($stream, $command);
    // initialize buffers
    $buffers[$stream] = '';
    $num_streams++;
}
while($num_streams > 0) {
    // use stream_select() to wait for new data and not use CPU at 100%.
    // note that the stream arrays are passed by reference and are modified
    // by stream_select() to reflect which streams are modified / have a
    // new event. Because of this we use a copy of the original stream array.
    // also note that due to a limitation in ZE you can not pass NULL directly
    // for more info: read the manual    https://php.net/stream_select
    $no_stream = NULL;
    $select_read = $streamArray;
    stream_select($select_read, $no_stream, $no_stream, null);

    // if there is new data, read into the buffer(s)
    foreach($select_read as $stream) {
        $buffers[$stream] .= fread($stream, 4096);
        // check if the stream reached end
        if (feof($stream)) {
            $key = array_search($stream, $streamArray);
            // close stream properly
            $num_streams--;
            fclose($stream);
            // remove stream from array of open streams
            unset($streamArray[$key]);
        }
    }
}
// do something with your buffers - our use them inside the while() loop already
print_r($buffers); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T23:44:06.303

> 连续监听和捕获所有流的流输出的解决方案是什么？

[这个问题](http://www.kegel.com/c10k.html)一直困扰着程序员很长一段时间。W. Richard Stevens 写的一本名为[UNIX Network Programming](http://www.unpbook.com/)的书将是一个很好的起点，如果您想为您的问题找到一个体面的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-28T23:40:37.090

PHP 在服务器上作为单个进程运行。执行此类操作的“最佳”方法是为每个流生成一个线程。每个线程都会有一个单独的流来收听。多线程自动利用多个 CPU 并允许它们并行运行。

不幸的是，PHP*不允许*您创建线程。但是，有几种解决方法（注意：[这个问题](https://stackoverflow.com/questions/2585656/threads-in-php)可能对您有一些好处）。

**选项 1：克隆进程**

PHP*确实允许您使用诸如*[pcntl_fork](http://us.php.net/pcntl_fork)之类的函数来克隆当前进程。基本上，您可以创建当前 PHP 进程的副本，该进程将接管并开始运行。只需对需要收听的每个流执行此操作即可。复杂之处在于确保每个进程都监听正确的流。（*提示*：有一个流列表，并对列表中的下一个流使用标志。然后执行 fork [克隆进程]。子进程将开始监听该流。但是，在父进程中，更新标志到列表中的下一个流，并创建另一个孩子，等等......）

**选项 2：多个 PHP 实例**

您可以使用 Cronjob、多个调用或其他一些服务（甚至是命令行调用）来调用每个 PHP 脚本，或者将参数传递给脚本以识别要侦听的流。这将并行运行每个 PHP 脚本/文件，并实现您想要的。

**选项 3：不要使用 PHP**

PHP 在技术上并不是为这样的东西而构建的，而这很可能在 C、C++ 或 Java 中很容易实现。你应该重新考虑你的设置。

**选项 4：创建 PHP 或 Apache 模块**

您可以用 C 语言为 PHP 或 Apache 编写一个模块，然后在 PHP 中使用您的函数调用。这可能会很复杂，我不推荐它。

总而言之，我建议重新考虑您的设置，而不是使用 PHP。但是，如果您仅限于 PHP，则可以使用多个 AJAX 调用。*

# mysql - 插入前触发器的语法

> ID：11705358
> 
> 赞同：0
> 
> 时间：2012-07-28T23:04:02.753
> 
> 标签：mysql, triggers, schema, constraints, mysql-error-1170

好的，所以我[看到](https://stackoverflow.com/a/4744926/262852)这是错误的方法：

```
mysql> 
mysql> show tables;
+---------------------+
| Tables_in_nntp      |
+---------------------+
| articles            |
| newsgroups          |
| newsgroups_articles |
+---------------------+
3 rows in set (0.00 sec)

mysql> describe newsgroups;
+-----------+----------+------+-----+---------+----------------+
| Field     | Type     | Null | Key | Default | Extra          |
+-----------+----------+------+-----+---------+----------------+
| id        | int(11)  | NO   | PRI | NULL    | auto_increment |
| newsgroup | longtext | NO   |     | NULL    |                |
+-----------+----------+------+-----+---------+----------------+
2 rows in set (0.00 sec)

mysql> show create table newsgroups;
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table      | Create Table                                                                                                                                                                      |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| newsgroups | CREATE TABLE `newsgroups` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `newsgroup` longtext NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1 |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> ALTER TABLE newsgroups ADD UNIQUE (newsgroup);
ERROR 1170 (42000): BLOB/TEXT column 'newsgroup' used in key specification without a key length
mysql> 
```

has 应该填充[触发器](https://stackoverflow.com/a/11024249/262852)吗？

好的，作为 root 我做了一个触发器：

```
mysql> 
mysql> show tables;
+---------------------+
| Tables_in_nntp      |
+---------------------+
| articles            |
| newsgroups          |
| newsgroups_articles |
+---------------------+
3 rows in set (0.00 sec)

mysql> 
mysql> delimiter |
mysql> CREATE TRIGGER make_hash BEFORE INSERT ON newsgroups
    ->   FOR EACH ROW BEGIN
    ->       INSERT INTO hash values ('0');
    ->   END;
    -> |
Query OK, 0 rows affected (0.18 sec)

mysql> 
```

但是，这只是虚拟数据。如何使该触发器实际创建哈希？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:15:04.850

我认为你应该保持你的主键不变。
您可以添加一个哈希列

```
ALTER TABLE `newsgroups` ADD COLUMN `hash` CHAR(32) NOT NULL DEFAULT ''; 
```

然后用

```
UPDATE newsgroups SET hash = MD5(newsgroup); 
```

然后删除重复项并添加您的唯一约束。

您还可以添加`BEFORE INSERT`和`BEFORE UPDATE`触发器来设置`hash`值

```
CREATE DEFINER=`root`@`localhost` 
TRIGGER `before_insert_newsgroups` 
BEFORE INSERT ON `newsgroups` 
FOR EACH ROW BEGIN

    set new.hash = md5(new.newsgroup);

END 
```

根据您使用的 SQL 客户端，您可能不想[在创建触发器语句之前和之后更改 DELIMITER](https://stackoverflow.com/questions/469784/creating-trigger-for-table-in-mysql-database-syntax-error)

# ruby-on-rails - Modifying Bootstrap variables when using bootstrap-sass

> ID：11705360
> 
> 赞同：7
> 
> 时间：2012-07-28T23:04:21.417
> 
> 标签：ruby-on-rails, twitter-bootstrap, sass

Here are all the less bootstrap variables: [http://twitter.github.com/bootstrap/less.html](http://twitter.github.com/bootstrap/less.html)

I've used the bootstrap-sass gem to add twitter bootstrap to my rails app which means I'm using sass. How do I modify/edit these less variables in my bootstrap_and_overrides.css.scss file?

When I try to do something like this:

```
@navbarBackground: #3D368B; 
```

I get:

> Sass::SyntaxError in Pages#home
> 
> Showing /Users/justme/myproject/app/views/layouts/application.html.erb where line #5 raised:
> 
> Invalid CSS after "@navbarBackground:": expected pseudoclass or pseudoelement, was " #3D368B;"

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T21:43:15.820

Sass 中的变量以美元符号 ($) 开头，而不是在 Less 中使用的 at 符号 (@)。

尝试这个：

```
$navbarBackground: #3D368B;
@import "bootstrap";
@import "bootstrap-responsive"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-28T23:31:42.973

修改saas中的变量，在导入bootstrap之前修改

```
.alert{
  margin-top:-40px;
}

@import "bootstrap";
@import "bootstrap-responsive"; 
```

这是我的应用程序中的一个示例

# c++ - Accessing C++ vector elements without casting

> ID：11705361
> 
> 赞同：0
> 
> 时间：2012-07-28T23:04:29.123
> 
> 标签：c++, mosync

I'm using MoSync / MAUI to create an mobile application prototype, but I'm facing a problem with the class inheritance:

The class hierarchy for the standard MAUI widgets is:

```
Widget
    EditBox
    Label
    ListBox
    ... 
```

Then, because I want to add an standard behavior to all the widgets, I made an separate class to define that behavior:

```
class xFocusControl:
public:
    void method1() {};
    void method2() {};
    int member1; 
    .... 
```

and subclass each widget type:

```
class xEditBox: public xFocusCtrl, public EditBox 
{
public:
    ...
}

class xLabel: public xFocusCtrl, public Label 
{
public:
    ...
}

... 
```

Then, in several places I need to access to all the widgets using the MoSync getChildren() function, defined as:

```
const Vector<Widget*>& MAUI::Widget::getChildren() 
```

My problem is: given this hierarchy, I can iterate over all the childrens as but cannot access to the new behavior (e.g: widget->member1) without casting. But, how can I generically cast each widget to its class? So far, I'm testing each possible widget class with some code like

```
member1 = 0;
if (isType <xLabel*> (widget)) {
    member1 = ((xLabel*) (widget))->member1; 
}

if (isType <xEditBox*> (widget)) {
    member1 = ((xEditBox*) (widget))->member1; 
}
... 
```

but it looks bad to me: I'm a C++ newbie, and **much** more proficient in dynamic languages as Python, so maybe I'm taking a wrong approach.

Do you mind a better way to do this?

As noted in the comments, I'm using regular cast instead of dynamic_cast because MoSync don't supports dynamic_cast so far

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:10:27.017

You should use `dynamic_cast`

```
xLabel* label = dynamic_cast<xLabel*>(widget);
if (label)
{
    member1 = label->member1;
}
// dynamic cast failed
else
{
} 
```

# php - Facebook SDK getAccessToken() 问题

> ID：11705363
> 
> 赞同：3
> 
> 时间：2012-07-28T23:04:43.723
> 
> 标签：php, facebook, sdk, access-token

我在使用 facebook SDK 时遇到了一些问题，特别是检索访问令牌。该应用程序已在 Facebook 上正确设置并已获得许可。据我所知，代码是正确的，我不确定 getAccessToken() 出了什么问题。

**$facebook->getAccessToken();** 正在返回*"12345678|abcdefghijklmnop"*，基本上是某种由 App ID 和 Secret ID 分隔的变量 |

**$facebook->getUser();** 正在返回“ *0* ”

```
<?php
     require_once("facebook.php"); //Up-to-date SDK files from Git

     $app_id = "12345678"; //replaced with fake
     $app_secret = "abcdefghijklmnop"; //replaced with fake

     $facebook = new Facebook(array(
         'appId' => $app_id,
         'secret' => $app_secret,
         'cookie' => true; //I have tried 'false' here as well
     ));

     $token = $facebook->getAccessToken();
?> 
```

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T09:36:22.573

`$facebook->getAccessToken();`正在返回`"12345678|abcdefghijklmnop"`，基本上是某种由 App ID 和 Secret ID 组成的变量，由 | 分隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T23:16:39.923

来自 Facebook SDK：

```
 public function getAccessToken() {
    if ($this->accessToken !== null) {
      return $this->accessToken;
    }

    $this->setAccessToken($this->getApplicationAccessToken());
    $user_access_token = $this->getUserAccessToken();
    if ($user_access_token) {
      $this->setAccessToken($user_access_token);
    }

    return $this->accessToken;
  }

  protected function getApplicationAccessToken() {
    return $this->appId.'|'.$this->appSecret;
  } 
```

当您有用户签名时，您的访问令牌将`APP ID|APP SECRET`是应用程序令牌，或者是用户访问令牌：`A RANDOM TOKEN HERE`

```
$facebook->getUser(); 
```

`getUser()`返回时`0`（与 相同`false`，并且用户未签名），您需要为您的应用程序请求登录和授权（如果尚未授权）：

```
if (!$facebook->getUser())
{
    $login_url = $facebook->getLoginUrl(array(
            'scope' => 'publish_stream' // Permissions goes here
        ) 
    );
?>
    <script type="text/javascript">
        top.location.href = " <?php echo $login_url; ?>";
    </script>
<?php
    exit;
} 
```

在此处查看可用的权限类型：[https ://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

# python - Traversing a deque in python?

> ID：11705365
> 
> 赞同：-3
> 
> 时间：2012-07-28T23:05:16.740
> 
> 标签：python

It must be possible to traverse a list removing elements and adding some new to the begining in an efficient fashion. In C I would use a linked list,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:11:03.017

Python中有很多LinkedList实现的例子。不久前我遇到了一个很好的... [Python Linked List](https://stackoverflow.com/questions/280243/python-linked-list)。如果您向下滚动一点，其他一些用户可以遵循一些很好的实现。

# java - Consuming different mediatype for root path of webservice

> ID：11705367
> 
> 赞同：-1
> 
> 时间：2012-07-28T23:06:10.240
> 
> 标签：java, web-services, rest, jersey

I have following code

```
@Path("/hello")
public class Hello {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    @Consumes(MediaType.TEXT_XML)
    public String sayPlainTextHello(@Context UriInfo wsContext) 
    {
        return "hello from xml";
    }
} 
```

This will result in a path `http://localhost:8080/WSTest/rest/hello`. Now i want to have 2 different method so that when a user calls `http://localhost:8080/WSTest/rest/hello.xml` it goes to XML method and when it calls `http://localhost:8080/WSTest/rest/hello.json` it goes to JSON method. With current implementation, if i add `.xml` or `.json` at the end of the path, the server returns `not found` error.

**EDIT** here is my web.xml. Please note that if add a subpath lets say `@Path("{name}.xml")` which means the `web.xml` is fine.

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>WSTest</display-name>
  <servlet>
    <servlet-name>Jersey REST Service</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
      <param-name>com.sun.jersey.config.property.packages</param-name>
      <param-value>com.personal.ws.test</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Jersey REST Service</servlet-name>
    <url-pattern>/rest/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

P.S: I can't change the path, we want to keep the root path as `http://localhost:8080/WSTest/rest/hello` it is.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:21:19.190

您需要在`@Path`方法中添加注释：

```
@Path("/rest")
public class Hello {

    @Path("/hello.xml")
    @GET
    @Produces(MediaType.TEXT_PLAIN)
    @Consumes(MediaType.TEXT_XML)
    public String sayXmlHello(@Context UriInfo wsContext) {
        return "hello from xml";
    }

    @Path("/hello.json")
    @GET
    @Produces(MediaType.TEXT_PLAIN)
    @Consumes(MediaType.APPLICATION_JSON)
    public String sayJsonHello(@Context UriInfo wsContext) {
        return "hello from json";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T18:53:12.137

您可以按照@Ali 的建议通过让客户端请求正确的编码来执行此操作。

您可以通过添加扩展支持来增强此功能。这样，无法设置他们想要的响应格式（无论出于何种原因）的 Web 浏览器和客户端仍然可以切换媒体类型。你可以通过扩展来做到这一点`PackagesResourceConfig`：

```
public class CommonResourceConfig extends PackagesResourceConfig {

  public CommonResourceConfig(Map<String, Object> props) {
    super(props);
  }

  public CommonResourceConfig(String... packages) {
    super(packages);
  }

  @Override
  public Map<String, MediaType> getMediaTypeMappings() {
    Map<String, MediaType> map = new HashMap<String, MediaType>();
    map.put("xml", MediaType.APPLICATION_XML_TYPE);
    map.put("json", MediaType.APPLICATION_JSON_TYPE);
    return map;
  }
} 
```

然后告诉 Jersey 通过将`javax.ws.rs.Application`属性设置为该类的完全限定名称来查找此配置（在您的 web.xml 中，除非您使用某些 DI 机制）。此外，您还需要更新方法上的 @Produces 注释以支持您要处理的所有媒体类型。这样，您不必为了更改服务的媒体类型而在方法之间复制功能。

**编辑：** Hello.java 与您所拥有的完全一样，CommonResourceConfig 如上所述（全部在 中`src/main/java/com/personal/ws/test/`）。这是我的其余配置（至少在本地）：

`pom.xml`：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.example</groupId>
    <artifactId>jersey</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
    <name>jerseyTest</name>

    <build>
        <plugins>
            <plugin>
                <groupId>org.mortbay.jetty</groupId>
                <artifactId>jetty-maven-plugin</artifactId>
                <version>8.0.3.v20111011</version>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>com.sun.jersey</groupId>
            <artifactId>jersey-server</artifactId>
            <version>1.13</version>
        </dependency>
        <dependency>
            <groupId>com.sun.jersey</groupId>
            <artifactId>jersey-json</artifactId>
            <version>1.13</version>
        </dependency>
        <dependency>
            <groupId>com.sun.jersey.contribs</groupId>
            <artifactId>jersey-guice</artifactId>
            <version>1.13</version>
        </dependency>
    </dependencies>
</project> 
```

`src/main/webapp/WEB-INF/web.xml`：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
    version="2.4">
    <display-name>WSTest</display-name>

    <servlet>
        <servlet-name>Jersey REST Service</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <init-param>
            <param-name>com.sun.jersey.config.property.packages</param-name>
            <param-value>com.personal.ws.test</param-value>
        </init-param>
        <init-param>
            <param-name>javax.ws.rs.Application</param-name>
            <param-value>com.personal.ws.test.CommonResourceConfig</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Jersey REST Service</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>

</web-app> 
```

运行 a`mvn jetty:run`然后 wget 或使用浏览器 for `http://localhost:8080/rest/hello.json`and `http://localhost:8080/rest/hello.xml`。我得到了正确的结果......也许只是一些小的配置问题？

# bash - Installation script for multiple operating systems

> ID：11705368
> 
> 赞同：0
> 
> 时间：2012-07-28T23:06:18.380
> 
> 标签：bash, shell, environment-variables

I have to install a `C compiler` with `cilkplus` branch which is recently added to the `GCC`. Since it is recent so I ave to install it manually and there are no direct methods available to that. I plan to install it at custom location. I installed it on a `redhat 6` and `ubuntu 12.04` successfully but I found that the settings of environment variables are different on both operating systems ( not a surprise ).

For example to install the compiler on `ubuntu 12.04` you would need `C_INCLUDE_PATH=/usr/lib/x86_64-linux-gnu` a directory which does not exist on `redhat 6`.

I plan to write a single script for installation of this compiler on many systems(different distributions of linux). How can I do it.

One way I can think of is to check which OS and version you are running and set `environment variables` accordingly but here also I do not know how to do it.

Any other suggestions are also valueable. Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:34:12.117

我会使用 cmake 进行简单的依赖检查和处理

# python - Python: Sort custom class without use of `key` argument?

> ID：11705371
> 
> 赞同：13
> 
> 时间：2012-07-28T23:06:42.293
> 
> 标签：python

You can sort an array of `myclass` by using the `key` argument to the `sorted` function:

```
sortedlist = sorted(myclasses, key=lambda obj: obj.myproperty) 
```

Is there a way to define a natural ordering for our class? Perhaps some magic method so that we don't have to pass in a key each time?

e.g.,

```
class myclass:
    def __init__(self,a,b):
        self.key1 = a
        self.key2 = b

    def __sortkey__(self):
        return self.key2 
```

Or will it naturally work if we define `__le__` perhaps?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-28T23:12:55.080

除此之外`__cmp__`，您还可以使用所谓的“丰富的比较运算符” `__eq__`、、、、`__le__`和。您可以在 2.7+/3.1+ 中使用类装饰器，而不是定义所有这些。在 3.x 中消失了。`__lt__``__gt__``__ge__`[`functools.total_ordering`](http://docs.python.org/library/functools.html#functools.total_ordering)`__cmp__`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-28T23:09:21.497

I'd do it by overriding [`__cmp__`](http://docs.python.org/reference/datamodel.html#object.__cmp__)

```
class myclass:
    def __init__(self,a,b):
        self.key1 = a
        self.key2 = b

    def __cmp__(self, other):
        return cmp(self.key2, other.key2) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-28T23:13:34.940

请参阅[上一个问题](https://stackoverflow.com/questions/8796886/is-it-safe-to-just-implement-lt-for-a-class-that-will-be-sorted)。答案是你可以只使用`__lt__`，但最好使用[`functools.total_ordering`](http://docs.python.org/library/functools.html#functools.total_ordering)。

# c# - Creating a Pie Chart in C# - not working for some strange reason

> ID：11705379
> 
> 赞同：0
> 
> 时间：2012-07-28T23:08:21.297
> 
> 标签：c#, graph, charts, pie-chart

I'm new to C# but I've been practicing with making charts and graphs. I made a pie chart for a prior program and I pretty much just copied and pasted the format into my new program, however it doesn't work. Here's the function that sets up the Pie Chart. I probably did something stupid and haven't realized it. lol

```
 public void setup_pieChart()
    {
        float total_count = 0;
        for (int k = 0; k < referrals.Count(); k++)
        {
            total_count += referrals[k].count;
        }
        if (total_count > 0)
        {
            Array.Sort(referrals);
            // ----------------------- CREATE PIE CHART ---------------------//

            Graphics g = this.CreateGraphics();
            Pen pen = new Pen(Color.Black, 2);
            Rectangle rec = new Rectangle(referralBox.Location.X + referralBox.Size.Width + 10, 25, 200, 200);

            g.Clear(Color.White);
            float degreeSum = 0;

            for (int k = 0; k < referrals.Count(); k++)
            {
                referrals[k].degrees = (referrals[k].count / total_count) * 360;
                g.DrawPie(pen, rec, degreeSum, referrals[k].degrees);
                g.FillPie(new SolidBrush(referrals[k].color), rec, degreeSum, referrals[k].degrees);
                degreeSum += referrals[k].degrees;
                Console.WriteLine("count " + referrals[k].count);
                Console.WriteLine("degree " + referrals[k].degrees);
                Console.WriteLine("color " + referrals[k].color.ToString());
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-10T22:00:07.350

这是在 C# 中创建饼图的示例程序

```
// PieChartForm.Designer.cs
namespace CSharpPieChart
{
    partial class PieChartForm
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.SuspendLayout();
            //
            // PieChartForm
            //
            this.ClientSize = new System.Drawing.Size(323, 273);
            this.Name = "PieChartForm";
            this.Text = "C# Pie Chart - softwareandfinance.com";
            this.Paint += new System.Windows.Forms.PaintEventHandler(this.Form1_Paint);
            this.ResumeLayout(false);

        }

        #endregion
    }
}

// MainProgram.cs

using System;
using System.Collections.Generic;
using System.Windows.Forms;

namespace CSharpPieChart
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new PieChartForm());
        }
    }
} 
```

请参阅[http://www.softwareandfinance.com/CSharp/Pie_Chart.html](http://www.softwareandfinance.com/CSharp/Pie_Chart.html)下载可执行文件和源代码。

# java - Better way to generate Armstrong Numbers recursively

> ID：11705381
> 
> 赞同：2
> 
> 时间：2012-07-28T23:08:33.977
> 
> 标签：java, recursion

Is there a more elegant way to write this recursively? Armstrong Numbers

PS: been out of school for 15 years this is not homework, just some code I am trying to convert from iterative to recursively.

```
import java.util.Scanner;

public class RecArmstrong {
public static void main(String[] args) {
    Scanner keyboard = new Scanner(System.in);

    System.out.print("Enter a number: ");
    int number = keyboard.nextInt();

    //Error checking
    while(number < 0 || number > 100000){
        System.out.print("Enter a number: ");
        number = keyboard.nextInt();
    }

    if(arm(number) == number)
        System.out.println(number + " is an armstrong number");
    else
        System.out.println(number + " is not an armstrong number.");

}

public static long arm(long n){

    long temp, sum, digits = 0;
    long remainder;
    temp = n;
    sum = 0;

    if (temp == 0)
        return 0; //base case
    else{
        while (temp != 0){
        digits++; //number of digits for exponent
        temp = temp / 10;
    }
    temp = n; //set temp back to original number
    while (temp != 0){
        remainder = temp % 10;
        sum += Math.pow(remainder, digits);
        temp = temp / 10;
    }
        return sum + arm(temp);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T23:28:03.397

也许我弄错了（这里是凌晨 1 点..），但据我所知，您的实现实际上根本不是递归。和

> ```
> while (temp != 0){
>         remainder = temp % 10;
>         sum += Math.pow(remainder, digits);
>         temp = temp / 10;
>     } 
> ```

您迭代地进行整个计算，直到 tmp 为 0。因此在下一行

> 返回总和 + 臂（温度）；

arm(temp) 将始终返回 0！

我拼凑了一个我自己的快速递归，它从最后一个开始逐位工作。函数重载是必要的，因为每个递归调用都需要原始数字的总长度。

```
public static long arm(long n){
   return arm(n, Integer.toString(n).length());
}
public static long arm(long n, int num_digits){

   if(n==0) //recursion finished
      return;
   // n%10 gives last digit
   return java.lang.Math.pow(n%10,num_digits) + arm(n/10, num_digits);
} 
```

我希望你喜欢它 ;-）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-23T15:06:04.487

如果你想使用 java 流来做，你可以这样做。

```
public boolean isArmstrongNumber(String number) {
    int exponent = number.length();
    if (Integer.parseInt(number) == number.chars()
            .map(n -> n - '0')
            .map(n ->(int) Math.pow(Integer.parseInt("" + n),exponent))
            .sum())
        return true;
    else return false;
} 
```

# jquery - 附加到正文的 Chrome 扩展内容脚本无法正常工作

> ID：11705383
> 
> 赞同：0
> 
> 时间：2012-07-28T23:09:13.433
> 
> 标签：jquery, css, google-chrome-extension

我有一个我正在开发的 google chrome 浏览器扩展的内容脚本，它会在用户所在的任何网页的顶部注入一个水平条。问题是当我导航到 google.com 时，谷歌导航栏出现在我的栏上。这是前置代码

```
$("body").prepend("<iframe class='toolbar' src='http://localhost/toolbar.php' />"); 
```

这是它的外观：

![工具栏适用的网站](../Images/2eb80d12d075fea8f82c4ee7d36dcc3b.png)

这是它在 google.com 上的外观 ![当内容在谷歌之前出现时出现的问题。 如您所见，谷歌导航栏与我的栏重叠](../Images/402fedeced3d6f864a73065db72cc4cc.png)

我正在尝试不同的方法，如果我在其他人之前解决问题，我会发布它。非常感谢任何帮助/指导。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T20:15:32.420

```
$(function(){
    setTimeout(function(){
        $("your html").prependTo('body');
        $("body > :not('#panDiv')").css({position:'relative',top:'23px'});
    },1000);
}); //end $ 
```

我希望这个是好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:34:26.710

尝试以下操作：

```
//select the body
$("body")
//wrap the content in a div
.wrapInner("<div class='website'></div>")
//prepend the iframe to the body
.prepend("<iframe class='toolbar' src='http://localhost/toolbar.php'></iframe>"); 
```

让我知道如果你不能让这个工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T20:20:07.590

将 bar 的 z-index css 属性设置为一个大数字：

```
<iframe style="z-index:999999;"></iframe> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T22:44:25.547

```
 enter code here

var v = document.getElementsByTagName('html')[0].style.top.toString().substring(0, 2);

            if (parseInt(v, 10) > 0) {

                var pxx = (v + 35).toString();
                document.getElementsByTagName('html')[0].style.position = "relative"
                document.getElementsByTagName('html')[0].style.top = pxx + "px";

            }
            else {

                document.getElementsByTagName('html')[0].style.position = "relative"
                document.getElementsByTagName('html')[0].style.top = "35px";
            }

  var url = chrome.extension.getURL('docz/links.html');
  var fRame =  $(document.createElement('iframe'));
  var wrapDiv = $(document.createElement('div'));

    wrapDiv.attr('id','wDiv');
    wrapDiv.css('width','100%');  
    wrapDiv.css('height','35px' );
    wrapDiv.css('position','fixed' );
    wrapDiv.css('top','0 !important');
    wrapDiv.css('z-index','2147482637');   

  fRame.attr('id','fr1');
  fRame.attr('scrolling','no');
  fRame.attr('src',url);
  fRame.attr('frameborder','0');
  fRame.css('position','absolute');
  fRame.css('top', '0 !important');

  fRame.css('width','100%');
  fRame.css('height','35px');
  fRame.css('border','none'); 
  fRame.css('border-radius','10px 10px 10px 10px');
  fRame.css('background-color','silver'); 
  fRame.appendTo(wrapDiv);
  wrapDiv.prependTo(document.body);

try this... before was more crude approach put this code int  $(function(){}); 
```

# file - flock 正确使用以防止边读边写

> ID：11705393
> 
> 赞同：0
> 
> 时间：2012-07-28T23:11:50.497
> 
> 标签：file, locking, mutex, flock

`*/10 * * * * /usr/bin/flock -x -w 10 /tmp/craigslist.lock /usr/bin/lynx -width=120 -dump "http://sfbay.craigslist.org/search/roo/sfc?query=&srchType=A&minAsk=&maxAsk=1100&nh=6&nh=8&nh=16&nh=24&nh=17&nh=21&nh=22&nh=23&nh=27" | grep "sort by most recent" -A 53 > /home/winchell/apartments.txt`

`*/10 * * * * /usr/bin/flock -x -w 10 /tmp/craigslist.lock /usr/bin/php /home/winchell/apartments.php`

这是一项计划任务。即使 lynx 正在写入 apartments.txt，第二行 php 命令似乎也在执行，我看不出原因。假设我在 lynx/grep 正在写入时试图阻止从 apartments.txt 中读取，这是正确的用法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T19:22:44.667

你的用法不正确。请注意您的第一个 cron 作业是如何由两个命令组成的管道：

```
/usr/bin/flock -x -w 10 /tmp/craigslist.lock /usr/bin/lynx -width=120 -dump
    "http://sfbay.craigslist.org/search/roo/sfc?query=&srchType=A&minAsk=&maxAsk=1100&nh=6&nh=8&nh=16&nh=24&nh=17&nh=21&nh=22&nh=23&nh=27" 
```

然后通过管道传输到：

```
grep "sort by most recent" -A 53 > /home/winchell/apartments.txt 
```

所以第一个命令是锁定一个文件，但它是第二个命令写入该文件！第二个命令将愉快地执行而无需等待锁。

解决此问题的一种方法是在持有锁的同时写入文件：

```
lynx etc... | grep etc.. |
    flock -x -w 10 /tmp/craigslist.lock tee /home/winchell/apartments.txt 
```

这种方法的缺点是即使文件被锁定也能运行`lynx`。`grep`为了防止这种情况，你必须在锁下运行整个事情：

```
flock -x -w 10 /tmp/craigslock.lock sh -c "lynx etc... | grep etc... >thefile" 
```

使用这种方法，您必须特别注意引用作为 lynx 的 URL 参数，因为它需要双引号。

最后：考虑使用`curl`or`wget`代替`lynx`. `lynx`用于交互式使用！

# ios - RedPark 串行电缆部分数据

> ID：11705397
> 
> 赞同：1
> 
> 时间：2012-07-28T23:12:33.937
> 
> 标签：ios, serial-port

我有一个 RFID 扫描仪连接到连接到 iPad 应用程序的 RedPark 串行电缆。当人们扫描他们的 RFID 卡时，我会收到带有 -readBytesAvailable: 的回调。然而，有时它并没有在一个电话中给我整个 RFID。有时它会分两次发送。

如何确定我是否已收到所有内容？当我的代码获取第一个回调的数据并尝试使用它时，我收到一个错误，因为假设 RFID 是“123456789”，有时我会收到一个带有@“12”的调用，第二个带有@“3456789”的调用。所以我尝试处理@“12”并得到一个未找到用户的错误，然后我尝试处理@“3456789”并得到一个未找到用户的错误。

如何判断我是否已完成读取数据？RFID 的长度可能因供应商而异，所以我不能假设我需要读取一定数量的数字。

这是我用来通过 RedPark 从扫描仪接收数据的方法：

```
- (void) readBytesAvailable:(UInt32)length {
    NSLog(@"readBytesAvailable: %lu", length);

    UInt8 rxLoopBuff[LOOPBACK_TEST_LEN];
    [self.rfidManager read:rxLoopBuff Length:length];

    NSString *rfid = [[NSString alloc] initWithBytes:rxLoopBuff length:length encoding:NSUTF8StringEncoding];

    NSLog(@"rfid=%@", rfid);

    [self receivedScanOfRFID:rfid];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T15:02:25.493

串行端口使您无法控制打包。数据只是一个字节流，无法预测每个读取调用中出现哪些字节。您必须解析数据流本身以解释内容并了解消息的开始/结束。您要么需要寻找可靠的终止字符，要么可能使用超时方法进行多次读取，直到在一段时间内没有更多数据。我不推荐超时方法。

# grails - 实例化了一个类，但它似乎引用了 null

> ID：11705399
> 
> 赞同：0
> 
> 时间：2012-07-28T23:12:46.003
> 
> 标签：grails, groovy, grails-2.0, groovy-2

我正在尝试实例化一个对象并在其上设置一个属性，该属性来自请求参数，如下所示：

```
println "Question text from the request :" + params.question

def question = new SurveyQuestion()
question.question = params.question

println "this is our question" + question 
```

这是我在控制台中的输出：

> 请求中的问题文本：测试这是我们的 questionroosearch.SurveyQuestion：null

这是`SurveyQuestion`课程：

```
class SurveyQuestion {

    String question

    static hasMany = [responses : SurveyQuestionResponse]
    static belongsTo = [survey: Survey]

    static constraints = {
    }
} 
```

以上似乎可以编译，但是当我在操作结束时进行重定向时，我得到了更多的类转换异常，我相信这是由于实例化和设置 that `SurveyQuestion`，好像我注释掉上面我没有得到这种失败行为。

我是否正确实例化了 SurveyQuestion 对象？为什么当我将它打印到控制台时它显示为空？这是正常的行为吗？至少我希望它像 Java 那样打印对象引用？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:45:44.317

域实例上的默认`toString()`方法将返回一个类似于`class.name: id`. 由于您新创建的域实例没有`id`设置显示`null`。

尝试`toString()`在您的`SurveyQuestion`域中覆盖：

```
String toString() {
    return question
} 
```

# java - Java 中的某些 BigDecimal 数字在除时会导致引发 ArithmeticException

> ID：11705406
> 
> 赞同：1
> 
> 时间：2012-07-28T23:14:22.143
> 
> 标签：java, bigdecimal, arithmeticexception

以下将两个`BegDecimal`数字相除的方法效果很好。

```
BigDecimal a=new BigDecimal(5);
BigDecimal b=new BigDecimal(2);
System.out.println(a.divide(b)); 
```

输出 ：`2.5`

* * *

然而，以下相同的方法失败了`java.lang.ArithmeticException`

```
BigDecimal c=new BigDecimal(361);
BigDecimal d=new BigDecimal(6);
System.out.println(c.divide(d)); 
```

以下是完整的异常堆栈跟踪。

```
Exception in thread "main" java.lang.ArithmeticException:
Non-terminating decimal expansion; no exact representable decimal result.
    at java.math.BigDecimal.divide(BigDecimal.java:1603)
    at currenttime.Main.main(Main.java:15)
Java Result: 1 
```

解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:21:05.620

这符合 Java 规范的预期。您没有提供任何比例，并且由于 361/6 = 60.1(6) 它应该抛出该异常。如果你想要一些四舍五入，你应该提供一个比例，这意味着要返回小数点后多少位，或者你可能需要 dedeAndReminder 来除以提醒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T23:25:24.343

你可以说四舍五入到小数点后 5 位：

```
BigDecimal c=new BigDecimal(361);
BigDecimal d=new BigDecimal(6);
System.out.println(c.divide(d, 5, BigDecimal.ROUND_HALF_EVEN)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-28T23:19:11.123

如果商是非终止小数（361/6 是 60.1666666...） ，则一个参数[`BigDecimal.Divide`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#divide%28java.math.BigDecimal%29)会抛出一个：`ArithmeticException`

> 抛出：
> **ArithmeticException** - 如果精确商没有终止的小数扩展

为了避免这种情况，请使用[`overload`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#divide%28java.math.BigDecimal,%20java.math.RoundingMode%29)第二个[`RoundingMode`](http://docs.oracle.com/javase/6/docs/api/java/math/RoundingMode.html)参数。

即，您准确地告诉 BigDecimal 您对除法结果的期望。

# c++ - 通过 typedef 显式模板实例化

> ID：11705407
> 
> 赞同：12
> 
> 时间：2012-07-28T23:14:26.863
> 
> 标签：c++, templates

如果我有

```
typedef Foo<float> Foof; 
```

为什么我不能像这样显式实例化模板

```
template class Foof; 
```

除了打字之外还有其他解决方法`Foo<float>`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-28T23:25:51.223

> 除了键入 Foo 之外还有其他解决方法吗？

不，不幸的是没有。你必须输入`Foo<float>`. 至于为什么，请参阅规则的 C++ 标准的 14.7.2 第 3 条（虽然我不知道规则背后的基本原理）。

# java - 安卓上的图像分割

> ID：11705408
> 
> 赞同：3
> 
> 时间：2012-07-28T23:14:28.913
> 
> 标签：java, android, image

我正在android平台上开发一个应用程序。该应用程序基本上需要使用相机捕获图像（已经完成），然后分析捕获的图像以查看一种颜色的结束位置和下一种颜色的开始位置（假设图像始终具有 2 或 3 种主色并且非常简单）。有任何想法吗？

PS我已经尝试过OpenCV，但有两个问题：1.该库需要事先安装在您的手机上才能使您的应用程序工作，我不能拥有它，因为它将是一个商业应用程序（我不确定这种依赖关系） 2\. 其次，我的应用程序的 min-sdk 是 android 2.2 而对于 OpenCV 它是 2.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:35:50.777

OpenCV 虽然是一个很好的通用库，但它只是处理像素的实用程序的集合。如果许可证和最小 SDK 有问题，请自己编写。分割是选择图像中的起始 x,y 位置并沿每个方向遍历，直到遇到满足或超过“不同”阈值的像素。使用堆栈来记录您在 x 和 y 中的位置，然后通过从堆栈中弹出索引来回溯，并在您回到原来的位置时遵循另一个方向。当您踏入 x 或 y 时，将索引压入堆栈。这并不难，只是相当乏味，但这就是人们编写库来做这些事情的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-24T05:37:31.390

我刚刚开始使用 OpenCv，您提到的问题（安装库）也是我面临的主要问题之一。但是，我通过将 OpenCv 初始化声明为静态找到了解决此问题的方法。当您将初始化设置为静态时，就不需要预先安装这些库。

好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T23:23:19.950

要执行此类操作，您需要进行图像处理。一个非常流行的 C++/Java 库当然可以处理这个问题是[OpenCV](http://ubaa.net/shared/processing/opencv/)。

# assembly - 如果协处理器不存在，arm asm 中的条件协处理器操作是否有效？

> ID：11705412
> 
> 赞同：2
> 
> 时间：2012-07-28T23:15:03.513
> 
> 标签：assembly, arm, fpu

指令是否像

```
fstmiaxne ip!, {d8-d15} 
```

当必要的协处理器可能不存在时，在 ARM 汇编中使用是否有效/安全，如果当前条件代码确保除非协处理器存在，否则不会执行操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T11:41:53.563

这取决于架构版本和变体。来自 ARM 架构参考手册 (DDI 0406B)：

> ## 有条件地执行未定义的指令
> 
> 第 A8-8 页的条件执行中描述的条件执行规则适用于所有指令。这包括未定义指令和其他会导致进入未定义指令异常的指令。
> 
> 如果此类指令未能通过其条件检查，则行为取决于体系结构配置文件和进入未定义指令异常的潜在原因，如下所示：
> 
> *   在 ARMv7-A 配置文件中：
>     
>     
>     
>     — 如果潜在原因是指令本身的执行并且取决于指令读取的数据值，则指令作为 NOP 执行并且不会导致未定义指令异常。
>     
>     
>     
>     — 如果潜在原因是执行较早的协处理器指令，或执行指令本身但不依赖于指令读取的数据值，则由实现定义指令是作为 NOP 执行还是导致未定义指令异常。实现必须以相同的方式处理所有此类情况。
>     
>     
> *   在 ARMv7-R 配置文件中，指令作为 NOP 执行，不会导致未定义指令异常。
> 
> ## 笔记
> 
> 在 ARMv7 之前，所有实现都将任何未能通过条件检查的指令作为 NOP 执行，即使否则它会导致未定义指令异常。为这些实现编写的未定义指令处理程序可能会假设未检查未定义指令是否通过了其条件检查。此类未定义指令处理程序可能需要重写，以检查条件是否通过，然后才能在所有 ARMv7-A 实现上正常运行

* * *

由于您使用已弃用的 VFP 指令作为示例，我假设您正在处理 ARMv7 之前的拱门，因此您似乎可以假设它将被视为 NOP。

编辑：对于 ARMv7-M（来自 DDI 0403D）：

> ## 有条件地执行未定义的指令
> 
> 如果未定义的指令未能通过 ARMv7-M 中的条件检查，则该指令将表现为 NOP 并且不会导致异常。
> 
> ## 笔记
> 
> 条件字段为“1110”的分支 (B) 指令是 UNDEFINED 并接受异常，除非 IT 指令的条件检查失败合格。

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:26:19.233

这个网站似乎有一个答案：

[http://www.peter-cockerell.net/aalp/html/app-a.html](http://www.peter-cockerell.net/aalp/html/app-a.html)

> 另请注意，如果一条指令由于其条件代码导致它被 ARM 忽略而未执行，则它永远不会被“提供”给协处理器，或者作为未定义的指令被捕获。这意味着如果一条指令由于其条件代码为“从不”而为“无操作”，则其余指令可以是任何东西——它永远不会导致陷阱发生。

但是，如果没有权威的声明来源，我有点犹豫要不要相信它。

# java - 更改操作栏图标

> ID：11705414
> 
> 赞同：8
> 
> 时间：2012-07-28T23:15:23.303
> 
> 标签：java, android, android-actionbar, icons, themes

我目前正在为我的应用程序实现主题支持，其中一部分是更改操作栏应用程序图标。我想在选择 Holo Light 时使用深色图标。除了设置操作栏应用程序图标的部分外，其他所有操作都在该方法中完成。我尝试使用的代码是：

```
getActionBar();
ActionBar.setIcon(R.drawable.my_icon); 
```

“这里没有这样的参考资料”是我得到的错误。这应该如何正确完成？

顺便说一句，我`minSdkVersion`的`14`Sherlock 没有动作吧。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-28T23:32:00.947

```
getActionBar(); 
```

您正在将操作栏扔在那里。`getActionBar()`返回 的实例`ActionBar`，然后您需要调用`setIcon()`它。像这样：

```
ActionBar actionBar = getActionBar();
actionBar.setIcon(R.drawable.my_icon); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-05-11T05:02:42.017

虽然答案有点晚，但我认为它可能有用。

**从活动内部：** 对于 API 级别 14 或更高级别：

```
getActionBar().setIcon(R.drawable.my_icon); 
```

对于较低的 API 级别，我们必须扩展 ActionBarActivity，然后：

```
getSupportActionBar().setIcon(R.drawable.my_icon); 
```

**从片段内部：** 对于 API 级别 14 或更高级别：

```
getActivity().getActionBar().setIcon(R.drawable.my_icon); 
```

对于较低的 API 级别，我们可以使用（活动必须扩展 ActionBarActivity）：

```
((ActionBarActivity)getActivity()).getSupportActionBar().setIcon(R.drawable.my_icon); 
```

在这两种情况下，我们都必须在设置图标或徽标之前调用 setDisplayShowHomeEnabled(true)。

```
((ActionBarActivity)getActivity()).getSupportActionBar().setDisplayShowHomeEnabled(true);

((ActionBarActivity)getActivity()).getSupportActionBar().setIcon(R.drawable.my_icon); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-07T07:49:41.783

我正在使用它，它对我有用。希望这对大家有帮助

```
actionBar.setDisplayHomeAsUpEnabled(true);
actionBar.setHomeAsUpIndicator(R.drawable.icon); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-25T10:15:39.420

现有的答案是非常正确的。然而，还有一个替代方案。一种最小的方法是使用

`getActionBar().setIcon(R.drawable.my_icon);`

Gets your work right away。:)

**技术细节**：由于 getActionBar() 默认返回一个对象，因此您可以直接操作它，而无需显式在范围内的对象中接收它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T23:20:31.153

您需要将要引用的可绘制对象添加`drawable/`到`res/`.

编辑：在您的 Android 安装文件夹中，有很多图片可供使用。你大概可以在那里找到它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-06T09:48:38.323

打电话给`setIcon`我是不够的。

在此之前，我必须将显示从活动标志切换到活动图标：

```
actionBar.setDisplayUseLogoEnabled(false); 
```

有关活动图标和徽标之间的区别，请参阅[Android 图标与徽标](https://stackoverflow.com/questions/6735649/android-icon-vs-logo)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-22T08:19:02.443

尝试这个

```
 setSupportActionBar(toolbar);
    if (getSupportActionBar() != null)
    getSupportActionBar().setIcon(R.drawable.your_icon); 
```

# php - 如何调用属于 PHP 类的自定义函数（wordpress do_action 样式）？

> ID：11705417
> 
> 赞同：1
> 
> 时间：2012-07-28T23:16:07.843
> 
> 标签：php, wordpress, oop, closures

Wordpress 使用钩子和操作来实现可扩展性。插件可能看起来像这样：

```
class myLightbox
{
    function __construct()
    {
        add_action('wp_footer',array($this,'my_footer'));
    }

    function my_footer()
    {
        echo '<script src="http://external-site.com/lightbox.js" ></script>';
    }
} 
```

如果我在 Wordpress 之外运行该代码，我希望它`add_action`能够工作——即使它只是立即调用该函数。

我读了这些：

*   [call_user_func(array($this, $method), $par) 从父的构造函数？](https://stackoverflow.com/questions/3939692/call-user-funcarraythis-method-par-from-parents-constructor)**

*   [将函数入队（如 wordpress add_action）](https://stackoverflow.com/questions/8870387/enqueue-a-function-like-wordpress-add-action)

第二个与我想做的非常接近，但我认为它不是为使用作为类的一部分的函数而设计的。

我尝试使用`call_user_function`，但我不知道如何给它的`array($this,'my_footer')`东西：

```
function add_action($whenToCall,$contextAndFunction=array())
{
    call_user_func($contextAndFunction);
} 
```

我也试过这个，但你可以说我的 OOP 不是很好，所以我很挣扎：

```
function add_action($whenToCall,$contextAndFunction=array())
{
    $function = array_pop($contextAndFunction);
    $context = array_pop($contextAndFunction);

    $context->$function();

} 
```

### `minitech`使用的建议测试失败：

```
class myLightbox
{
    function __construct()
    {
        add_action('wp_footer',array($this,'my_footer'));
    }

    function my_footer()
    {
        echo '<script src="http://external-site.com/lightbox.js" ></script>';
    }
}

function add_action($whenToCall,$contextAndFunction=array())
{
    $contextAndFunction();
}

$myLightbox = new myLightbox(); 
```

产生：

```
Fatal error: Function name must be a string 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:17:53.473

如果您使用的是 PHP 5.4，它已经是一个可调用的：

```
$contextAndFunction(); 
```

[这是一个演示。](http://codepad.viper-7.com/UWdDNJ)

否则，`call_user_func`将按原样工作。

```
call_user_func($contextAndFunction); 
```

[还有一个演示。](http://codepad.viper-7.com/giBwgw)

# scala - Scala - 运算符定义

> ID：11705418
> 
> 赞同：0
> 
> 时间：2012-07-28T23:16:16.107
> 
> 标签：scala, operators

> **可能重复：**
> [Scala 的 apply() 方法是如何工作的？](https://stackoverflow.com/questions/1223834/how-does-scalas-apply-method-magic-work)

我是 Scala 的绝对初学者，在阅读了一本 Scala 书籍后，应用函数就像“重载 () 运算符”，我开始想知道 tha 是如何定义的。也就是说，运算符 () 将采用括号本身之间的参数，而不是传统的中缀 a () b 表示法。在 Scala 中是否可以定义这种运算符，如果可以，定义语法是什么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T23:28:09.160

正如您在问题中已经说过的那样，您只需通过定义一个名为 的方法（*而不是*函数）来定义它`apply`。

```
foo(bar, baz) 
```

被翻译成

```
foo.apply(bar, baz) 
```

所以，只要`foo`有`apply`正确的数量和类型的方法，这将起作用。

`apply`该方法的一些实现示例是伴生对象，它允许您通过调用（实际上只是）和类`Array`来构造一个数组，它允许您通过调用（实际上是只是）来访问数组元素。`Array(1, 2, 3)``Array.apply(1, 2, 3)``Array``anArray(i)``anArray.apply(i)`

这类似于 Python，其中函数调用被转换为对`__call__`运算符的调用或 Ruby，其中表单的表达式`foo.(bar, baz)`被转换为`foo.call(bar, baz)`.

类似的方法是`update`：

```
foo(bar) = baz 
```

被翻译成

```
foo.update(bar, baz) 
```

# android - 为什么对象必须在传递给android中的活动之前进行序列化？

> ID：11705419
> 
> 赞同：1
> 
> 时间：2012-07-28T23:16:26.810
> 
> 标签：android, data-structures, android-intent

为了将对象传递给`Activity`，对象必须实现`Parcelable`/ `Serializable`（或 JSON 编码，或将对象转换为标量的任何方法）。

（我知道使用单例、静态等的[替代方法。）](http://developer.android.com/guide/faq/framework.html#3)

为什么不能给我的 POJO`Activity`类似`new Intent( ... , myObject)`or的东西`startActivity(intent, myObject)`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T12:55:59.747

我把@Jens 的评论变成了一个社区维基：

您对 to 的调用`startActivity`被传递到`ActivityManagerNative`- 反过来，它与在完全不同的进程中运行的活动管理器服务通信 - 从而强制您输入的任何内容`Intent`成为`Parcelable`或`Serializable`

# solr - Solr 作为地理编码器

> ID：11705424
> 
> 赞同：2
> 
> 时间：2012-07-28T23:16:59.730
> 
> 标签：solr, lucene, geocode, google-geocoder

我正在为我的搜索服务器使用 SOLR。我想知道是否可以或建议将其用于地理编码。我打算将它用于邮政编码、城市和城镇。我希望有这样的结构：

名称：伦敦经度/纬度：1.1/-1.2 国家：英国

名称：Manchester Long/Lat：1.1/-1.2 国家：英国

名称：SN5 3PW 经纬度：1.1/-1.2 国家：英国

像这样的东西会起作用吗？然后，我可以有无限的请求，而不必像使用谷歌和其他人那样使用地图或品牌搜索框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T22:50:17.397

Checkout [Spatial4J 或 Lucene-Spatial playground](http://code.google.com/p/lucene-spatial-playground/)，它也致力于 lucene spatial（第 4 版），相当不错。Google for RecursivePrefixTreeStrategy 和 GeohashPrefixTree by David Smiley。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T11:41:18.523

您可能想阅读[这篇](http://www.ibm.com/developerworks/java/library/j-spatial/)解释类似设计的文章。

谷歌`geospatial Lucene`了解更多。

# macos - 更喜欢我的 QuickLook 插件

> ID：11705425
> 
> 赞同：10
> 
> 时间：2012-07-28T23:17:37.893
> 
> 标签：macos, quicklook

我正在制作一个 QuickLook 插件，它将包含在我的应用程序中。它将用于预览其他应用程序也具有 QuickLook 插件的文件类型。每次我尝试使用我的插件进行测试（我将其放入 ~/Library/QuickLook/）时，它都会使用另一个应用程序的插件进行预览。我正在使用 qlmanage 进行预览。有没有办法强制它使用我的，至少用于测试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T06:33:02.203

嵌入在应用程序中的生成器总是优先于 ~/Library/QuickLook 中的插件（它们优于 /Library/QuickLook 中的插件，后者优于 /System/Library/QuickLook 中的插件）。

无法更改此优先级。此外，如果同一级别的 2 个生成器声明相同类型的文件，则 Quick Look 将优先选择一个而不是另一个，无论您无法控制哪个。

至少对于您的测试，您可以通过使用选项强制 qlmanage 使用您想要的插件`-g`（但您还必须使用 -c 指定内容类型）。

尝试`qlmanage -h`为您的测试获取所有选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-16T21:30:06.987

虽然@julien 描述的优先顺序是准确的，但仍然可以覆盖特定应用程序的 QL 提供程序。只需在有问题的应用程序中编辑`Info.plist`文件。`.qlgenerator`例如，我喜欢某个 QL 提供程序处理 markdown 的方式，但我安装的其中一个文本编辑器包含（恕我直言）少于一流的 markdown 支持。我喜欢的捆绑包丢失了......直到我编辑：

```
/Applications/BadMarkdown.app/Contents/Library/QuickLook/BadMarkdownQL.qlgenerator/Contents/Info.plist 
```

并删除

```
<string>net.daringfireball.markdown</string> 
```

在较新版本的 OS X 中，您甚至不需要重新启动 QL 守护程序。首选的 QL 工具刚刚接管。=D

# java - 在 Java 中使用 ListSelectionListener 打印 JList 选择的字符串

> ID：11705428
> 
> 赞同：0
> 
> 时间：2012-07-28T23:18:22.773
> 
> 标签：java, swing

对这里的java来说相当新。我正在编写一个 GUI 程序，我希望能够使用 JButton 将所选列表项的字符串（而不是索引号）附加到文本区域。我不知道哪种 java 方法可以让我这样做。当我使用 getSelectedIndex 方法时，它只允许我将索引号而不是列表项的字符串值附加到我的文本区域。如果仍然不清楚我在问什么，这是我的代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;

public class FantasyInterface extends JFrame implements ActionListener{

private JList list1;
private JList list2;
private JLabel runningbacks;
private JButton addPlayer1;
private JButton addPlayer2;
private JTextArea text;
String lineSeparator = System.getProperty("line.separator");
private String[] rbs = {"Matt Forte", "Arian Foster", "Maurice Jones-Drew", "Adrian Peterson", "Ray Rice"};
FantasyTeam team1 = new FantasyTeam(5);
FantasyTeam team2 = new FantasyTeam(5);

public FantasyInterface(){
    super("Fantasy Football Simulator");

    // Set up listsPanel
    JPanel listsPanel = new JPanel();

    runningbacks = new JLabel("Running Backs:");
    listsPanel.add(runningbacks);
    list1 = new JList(rbs);
    list1.setVisibleRowCount(5);
    list1.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
    listsPanel.add(list1);

    addPlayer1 = new JButton("Add To Team 1");
    listsPanel.add(addPlayer1);

    list2 = new JList(rbs);
    list2.setVisibleRowCount(5);
    list2.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
    listsPanel.add(list2);

    addPlayer2 = new JButton("Add To Team 2");
    listsPanel.add(addPlayer2);
    // Add formatted JPanels to Content Pane
    getContentPane().add(listsPanel, BorderLayout.NORTH);

    // Set up textPanel, where info will appear
    JPanel textPanel = new JPanel();
    text = new JTextArea(20, 20);
    textPanel.add(text);
    // Add formatted JPanels to Content Pane
    getContentPane().add(text, BorderLayout.SOUTH);

    ListSelectionListener listSelectionListener = new ListSelectionListener() {
          public void valueChanged(ListSelectionEvent listSelectionEvent) {
            //System.out.println("First index: " + listSelectionEvent.getFirstIndex());
            //System.out.println(", Last index: " + listSelectionEvent.getLastIndex());
            boolean adjust = listSelectionEvent.getValueIsAdjusting();
            //System.out.println(", Adjusting? " + adjust);
            if (!adjust) {
              JList list = (JList) listSelectionEvent.getSource();
              int selections[] = list.getSelectedIndices();
              Object selectionValues[] = list.getSelectedValues();
              for (int i = 0, n = selections.length; i < n; i++) {
                if (i == 0) {
                  System.out.println(" Selections: ");
                }
                System.out.println(selections[i] + "/" + selectionValues[i] + " ");
              }
            }
          }
        };
     list1.addListSelectionListener(listSelectionListener);
     addPlayer1.addActionListener(this);
}

public void actionPerformed(ActionEvent event){
    Object srcObj = event.getSource();

    if (srcObj == addPlayer1){
        text.append(lineSeparator + list1.getSelectedIndex());
    }
} 
```

}

最后一部分，

```
if (srcObj == addPlayer1){
        text.append(lineSeparator + list1.getSelectedIndex());
    } 
```

是我想知道是否有一种方法可以以字符串形式获取所选索引。感谢任何帮助的人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:39:08.757

采用：

```
if (!list1.isSelectionEmpty()) {
   text.append(lineSeparator + list1.getModel().getElementAt(list1.getSelectedIndex()));
} 
```

# drupal - RapidWeaver 主题到 Drupal6 主题

> ID：11705430
> 
> 赞同：0
> 
> 时间：2012-07-28T23:18:57.263
> 
> 标签：drupal, drupal-6, drupal-theming, drupal-themes

我正在一个具有 RapidWeaver 主题 ( f_fusion ) 的网站上工作。但我更像是一名开发人员，而不是一名设计师。我们有什么方法可以轻松地将 RapidWeaver 主题转换为 Drupal6 主题，以便所有样式保持不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:57:42.187

是的，这是可能的，特别是如果您是开发人员，因为这实际上是从 RapidWeaver 主题中获取 HTML 和 CSS 并将 Drupal 变量放入其中的问题。

[从检查此链接开始，以了解有关Drupal 主题](http://drupal.org/theme-guide/6-7)的总体思路

当你知道如何创建一个基本的主题结构时，你应该学习如何修改 page.tpl.php 文件开始，之后它当然取决于你的网站的具体情况，但你绝对应该在你的路上。

如果您想更深入地挖掘，请查看这本书：[Pro Drupal Development](http://www.apress.com/9781590597552/)

# python - 消除冗余元组

> ID：11705436
> 
> 赞同：5
> 
> 时间：2012-07-28T23:20:38.010
> 
> 标签：python, tuples

如果我有一个元组列表，其中每个元组代表变量、`a`和`b`，`c`如何消除冗余元组？

冗余元组是那些简单`a`地`b`互换，但`c`相同的元组。所以对于这个例子：

```
tups = [(30, 40, 50), (40, 30, 50), (20, 48, 52), (48, 20, 52)] 
```

我的最终名单应该只包含一半的条目。一种可能的输出：

```
tups = [(30, 40, 50), (20, 48, 52)] 
```

其他

```
tups = [(40, 30, 50), (20, 48, 52)] 
```

等等

有没有一种简单的 Pythonic 方法可以做到这一点？

我尝试使用集合，但`(30, 40, 50)`与 不同`(40, 30, 50)`，但对我来说这些是多余的，我只想保留其中一个（没关系，但如果我可以选择，我更喜欢低价值订单） . 如果有办法对元组的前 2 个元素进行排序，那么使用集合就可以了。

我确信我可以拼凑出一个可行的解决方案（也许将元组转换为列表作为中间步骤），但我只是想看看是否有一种我不熟悉的简单而明显的方法来做到这一点。

PS：这个问题部分是由[PE #39](http://projecteuler.net/problem=39)引起的。但即使抛开这个 PE 问题，我现在也很好奇如何轻松地（或是否）做到这一点。

**编辑**：

只是为那些不熟悉 PE #39 - 的人提供一些背景信息 - `a`, `b`, 并`c`表示直角三角形的边，所以我正在检查 if `a**2 + b**2 == c**2`，清楚的顺序`a`和`b`无关紧要。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-28T23:32:44.543

```
set([(a,b,c) if a<b else (b,a,c) for a,b,c in tups]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-28T23:27:38.920

```
tups = [(30, 40, 50), (40, 30, 50), (20, 48, 52), (48, 20, 52)] 
no_duplicates = list(set(tuple(sorted(tup)) for tup in tups)) 
```

当然这是假设每个元组的第三个元素总是每个元组中最大的元素，否则，这样做：

```
no_duplicates = list(set(tuple(sorted(tup[:2])) + (tup[2],) for tup in tups)) 
```

正如 WolframH 建议的那样，表达式`tuple(sorted(tup[:2])) + (tup[2],)`可以写为`tuple(sorted(tup[:2])) + tup[2:]`，这是有利的，因为它可以推广到`tuple(sorted(tup[:i])) + tup[i:]`，其中`i`可以是任何想要将已排序元素与未排序元素分开的点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-28T23:29:13.167

从您的问题来看，您的元组的前两个元素似乎在元组中形成了一个子单元。因此，将数据重组为一个元组和第三个数字的元组似乎是有意义的，其中第一个元组是按排序顺序排列的前两个数字。然后你自然可以使用集合：

```
>>> newTups = [(tuple(sorted([a, b])), c) for a, b, c in tups]
>>> newTups
[((30, 40), 50), ((30, 40), 50), ((20, 48), 52), ((20, 48), 52)]
>>> set(newTups)
set([((20, 48), 52), ((30, 40), 50)]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-28T23:46:25.707

将您的每个元组转换为 a`frozenset`并创建`set`这些frozensets。

```
tups = [(30, 40, 50), (40, 30, 50), (20, 48, 52), (48, 20, 52)]

frozen_sets = { frozenset(x) for x in tups }

tups2 = [tuple(x) for x in frozen_sets] 
```

这是有效`frozenset([1,2,3]) == frozenset([3,1,2])`的，因为与元组相比，其中`(1,2,3) != (3,1,2)`.

您必须将元组转换为`frozenset`s 而不是 simple `set`s，因为当您尝试使一个集合成为另一个集合的成员时会出现以下错误：

```
TypeError: unhashable type: 'set' 
```

`frozenset`s 是可散列的，因此避免了这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-28T23:27:42.040

如果您不关心前两个元素的顺序，那么您真的不想使用 3-uples ：只需转换为丢弃您不需要的信息的新数据结构。

```
result = {({x[0],x[1]},x[2]) for x in tups} 
```

# spring - 测试 Spring Webflow 动作类

> ID：11705438
> 
> 赞同：1
> 
> 时间：2012-07-28T23:20:47.607
> 
> 标签：spring, unit-testing, spring-webflow, easymock

我正在使用为我的 webflow 编写测试用例`org.springframework.webflow.test.execution.AbstractXmlFlowExecutionTests`

```
public class MyFlowExecutionTests extends AbstractXmlFlowExecutionTests {
} 
```

在某些情况下，我的逻辑很简单，所以我直接从 Spring webflow 调用我的服务层。在某些情况下，我使用 org.springframework.webflow.action.MultiAction 类的扩展，并从操作类调用我的服务层。

在第一种情况下，编写测试用例是直截了当的。在第二种情况下，我发现使用 org.springframework.webflow.test.execution.AbstractXmlFlowExecutionTests 为 Action 类编写测试用例非常复杂。在第一个场景中，我可以模拟我的流程中使用的所有服务类。在第二种情况下，使用简单的模拟类扩展，我可以模拟动作类。但是我需要模拟里面使用的服务层，我认为模拟不能很好地处理。

我现在正在考虑以某种方式将 Action 类代码移至 Spring EL。或者有人对测试动作类代码和 webflow 代码有更好的想法吗？

# c - C - DLL 需要是 __stdcall 并导入 __cdecl lib

> ID：11705439
> 
> 赞同：0
> 
> 时间：2012-07-28T23:20:57.840
> 
> 标签：c, vb.net, dll, portaudio, stdcall

我正在编译一个需要使用 portaudio 的 DLL。它也为套接字等使用各种 Windows 库，但链接器无法识别 portaudio 库。然后我记得 portaudio 使用 __cdcel 而不是 __stdcall。通常我只会使用 __cdcel 并完成它，但我正在编译的 DLL 需要使用 __stdcall，因为我将在 Visual Basic 中使用它。

如果这个项目对你来说听起来有点杂乱无章，那就是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:36:56.897

愚蠢的我！我所要做的就是使用 __cdcel 并将导出的函数声明为 __stdcall！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:51:16.097

我想你需要使用 __cdecl 因为 portaudio 会调用你的一些函数？然后创建一个声明为 __cdecl 的内部函数，将此函数传递给 portaudio，并提供一个调用您的内部函数的导出函数（声明为 __stdcall）。

但我有点猜测你想要做什么，你应该提供更多信息。

# iphone - 触摸时更大的触摸

> ID：11705447
> 
> 赞同：0
> 
> 时间：2012-07-28T23:22:35.883
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我需要一种方法让用户在按下按钮时有更大的触感。这样，用户可能会错过按钮但仍会单击它。有没有办法做到这一点？我不想只更改用户单击的区域的按钮类..

谢谢！！！ps 我很擅长逻辑思维...我只需要一些代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:14:45.907

1）你可以使用 [yourButtonType setBackgroundImage:yourImage forState:UIControlStateNormal]; 你可以让你的形象像这样，

```
-------------------------------------------
| transparent, transparent, transparent   |
| transparent,yourOpaqueImage, transparent|
| transparent, transparent, transparent   |
|------------------------------------------ 
```

实际上按钮框架更大，但用户无法察觉

2）你可以使用touchesEnded，像这样

```
- (void)touchesEnded:(UITouch *)touch withEvent:(UIEvent *)event
{
    CGPoint location = [touch locationInView:self];
    CGRect btnRect = CGRectMake(btn.frame.origon.x-10,btn.frame.origon.y-10 , btn.frame.size.width+20, btn.frame.size.height+20);
    if (CGRectContainsPoint(btnRect, location)) {
         //sender your button
    }
} 
```

# android - 你能用安卓设备转发吗

> ID：11705448
> 
> 赞同：0
> 
> 时间：2012-07-28T23:22:37.410
> 
> 标签：android, networking

我目前通过 wifi 系绳为 root 用户将我的 Galaxy nexus 系在我的计算机上，我想知道是否有办法让我在 android 设备本身或通过运行 Windows 7 和 Ubuntu Linux 的 PC 上进行端口转发。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:40:11.583

[ADB 确实有一个端口转发命令](http://developer.android.com/tools/help/adb.html#forwardports)，请参阅：

```
adb forward tcp:6100 tcp:7100 
```

尽管对您的问题进行更多澄清可能有助于为您找到解决方案。

# python - SQL 查询在控制台中有效，但在 python 中无效

> ID：11705450
> 
> 赞同：1
> 
> 时间：2012-07-28T23:23:02.083
> 
> 标签：python, mysql, sql

嗨，我在使用 sql 查询时遇到问题，它在控制台中可以完美运行，但是当我在 python 中实现时，它似乎可以完美运行，没有错误，但是当我检查数据库时它没有工作，但是使用控制台它确实可以正常工作，没有错误我检查 db 数据在那里......我使用的查询完全相同。

有任何想法吗？

```
UPDATE ex SET fbsiteurl = stringvarible, fbsitesource = '' WHERE id = 23123; 
```

在蟒蛇中：

```
 cur = con.cursor()
 sqlquery = "UPDATE ex SET fbsiteurl = '"+somevarible+"', fbsitesource =        '"+somevarible+"' WHERE id = %d;" % recordid                                
 print sqlquery
 cur.execute(sqlquery) 
```

查询在打印中显示正常没有问题，如果我复制打印出来并将其粘贴到 mysql 控制台中，它每次都能完美运行，只是来 python 它就像它一样工作，但 dosnt 真的是 0_o

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T23:49:36.703

connection.autocommit()，或者你需要做 connection.commit()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T23:27:40.577

去过那里:) 你需要关闭光标

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-23T13:10:34.747

这个小问题一直持续到今天。为了澄清起见，我不得不使用上述两个答案，如：

```
 cur = self.db.cursor()
        try:
            cur.execute(sqlcommand)
            self.db.commit()
            res = cur.fetchall()
        except res is not None:
            print(res)
        finally:
            cur.close() 
```

# python - 如何从解释器堆栈中获取绑定方法的类的名称？

> ID：11705451
> 
> 赞同：5
> 
> 时间：2012-07-28T23:23:11.137
> 
> 标签：python, class, callstack

我有一个很棒的小功能，看起来像这样：

```
def verbose_print(message, *args, **kwargs):
    """Prints `message` with a helpful prefix when in verbose mode

    Args:
        message (str): The message to print. Can be a format string, e.g.
            `A %s with some %s in it`
        *args: Variables for the message format
        **kwargs: Keyword variables for the message format
    """

    # Only print when in verbose mode
    if not config.verbose:
        return

    # Ready a prefix for the message
    try:
        s = inspect.stack()
        module_name = inspect.getmodule(s[1][0]).__name__
        func_name = s[1][3]
        prefix = '### %s->%s' % (module_name, func_name)
    except Exception as e:
        prefix = '### [stack unavailable]'

    if args:
        message = message % args
    elif kwargs:
        message = message % kwargs

    print '%s: %s' % (prefix, message) 
```

该函数的重点是我可以从任何地方通过消息调用它，如果我的项目配置文件设置为详细模式，所有消息都将打印一个有用的前缀以显示它被调用的位置。这是一些输出的示例：

```
### avesta.webserver->check_login: 检查客户端在 127.0.0.1 的登录
### avesta.webserver->check_login：找到用户名：tomas，令牌：blablabla 的凭据 cookie
### avesta.webserver->check_login: 登录有效，刷新会话
### avesta.webserver->get_flash_memory：获取的闪存数据：无
### avesta.webserver->get：从空路径（'previous_values'，'name'）获取数据，返回''
### avesta.webserver->get：从空路径（'previous_values'，'description'）获取数据，返回''
### avesta.webserver->get：从空路径（'validation_errors'，'name'）获取数据，返回''

```

格式为*"### module->function: message"*。

现在大多数时候这**确实**很有帮助，但并不完美。在上面的例子中，“get”函数实际上是一个类的绑定方法，但它是不可见的。我想要完成的是，当一个函数是一个绑定方法时，我用这种格式打印：

*“### 模块->ClassName.function”*

但问题是：

1.  我只从堆栈中获取函数**名**，所以我无法真正检查它是否是绑定方法
2.  即使我有函数引用，我将如何推断它绑定的类名？

感谢您提供任何可以帮助我解决这个问题的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T00:23:31.963

我以为这会很容易，但结果有点复杂。如果你有对绑定方法的引用，你可以通过`boundMethod.im_class.__name__`. 但是，当你抓取堆栈时，你不能轻易获得对绑定方法的引用，只是为了堆栈帧。

然而，一切都没有丢失！该`inspect`模块可以使用该`getargvalues`函数从堆栈框架中获取函数参数。您确实必须通过依赖方法总是将其第一个参数命名为“self”的约定来作弊。你可以检查一下，然后从函数的`locals`字典中获取“self”值，然后从那里很容易得到类名。尝试用他的代码替换你当前的`try`块：

```
s = inspect.stack()
module_name = inspect.getmodule(s[1][0]).__name__
func_name = s[1][3]
arginfo = inspect.getargvalues(s[1][0])
if len(arginfo.args) > 0 and arginfo.args[0] == "self":
    func_name = "%s.%s" (arginfo.locals["self"].__class__.__name__, func_name)
prefix = '### %s->%s' % (module_name, func_name) 
```

# javascript - JavaScript/HTML：更改图像边框 onclick

> ID：11705454
> 
> 赞同：2
> 
> 时间：2012-07-28T23:23:48.113
> 
> 标签：javascript, html

我想编写一个函数，每次单击它时都会用边框包围图像。联合国教科文组织 我不能让它工作。否认任何拼写错误，因为我没有复制粘贴它。该功能有效。但是单击图像时不会对图像产生任何影响。我是否访问了边框属性？

我的功能：

```
<script>

function mark(imageId) {
    document.getElementById(imageId).style.border = "1";
}

</script> 
```

我的html正文：

```
<input id="imageId" src="\images\image1.png" onclick="mark(imageId)"/> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-28T23:32:12.230

您的标记*不太*有意义，但是：

```
<input id="imageId" type="image" src="http://goo.gl/UohAz" onclick="mark(this)"/>

function mark(el) {
    el.style.border = "1px solid blue";
} 
```

[http://jsfiddle.net/8QGkq/](http://jsfiddle.net/8QGkq/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T23:25:17.540

你不想`getParameter()`。你想要`getElementById()`。

您也不希望在`imageId`函数声明中用引号将变量名括起来，`mark()`因为这会将其更改为字符串。

正如@John Girata 指出的那样，您希望为边框值指定的不仅仅是“1”。

```
document.getElementById(imageId).style.border = "1px solid black"; 
```

此外，您需要在 onclick 属性中引用“imageId”：

```
<input id="imageId" src="\images\image1.png" onclick="mark('imageId')"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-28T23:27:55.390

将边框设置为“1”对我不起作用。试试这个：

```
<script>

function mark(imageId) {
    document.getElementById(imageId).style.border = "1px solid black";
}

</script> 
```

您还需要用引号将 HTML 中的 imageId 括起来（不确定这是否是拼写错误）：

```
<input id="imageId" src="\images\image1.png" onclick="mark('imageId')"/> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-09T06:02:37.417

这是该问题的代码。

```
<html>
<head>
<title></title>
</head>
<body>
<script type="text/javascript">
    function sayHello() {
        var boyElement = document.getElementById("boy");
        boyElement.style.border = "3px solid red";
    }
</script>
<img src="C:\Users\Acer\Desktop\new web site\js\images\boy.png" id="boy" 
onclick="sayHello()">
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T23:41:45.037

为了澄清，使用 DOM 元素设置边框，您需要提供宽度、颜色、样式，例如：

```
document.getElementById("ex1").style.border="1px solid #0000FF"; 
```

w3Schools**实际上**说：[http ://www.w3schools.com/jsref/prop_style_border.asp](http://www.w3schools.com/jsref/prop_style_border.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-21T20:50:48.587

看这个 ：

`<img id="CN" src="CN.png" onclick="fnChangeBorder('CN')">`

并定义您的功能：

`function fnChangeBorder(imageId)`

`{document.getElementById(imageId).style.border = "solid #AA00FF";}`

# php - 使用 jQuery Heartbeat（或 PHP）计算在线用户数

> ID：11705457
> 
> 赞同：0
> 
> 时间：2012-07-28T23:24:39.597
> 
> 标签：php, jquery, heartbeat

我目前正在使用此 php 代码来计算当前在线的用户数：

```
$session_id = session_id();
$time_stamp = time();
$time_limit = $time_stamp - 300;        //   We give the session only 5 minutes if it exists
$result = $this->select("SELECT * FROM `online_visitors` WHERE `session_id`='$session_id' LIMIT 1");
if (!mysql_num_rows($result)) {
    $tb_col[0] = "visitor_ip";
    $tb_col[1] = "country";
    $tb_col[2] = "session_id";
    $tb_col[3] = "time_stamp";
    $tb_col[4] = "last_time_stamp";
    $tb_data[0] = "'" . $this->visitor_ip . "'";
    $tb_data[1] = "'" . $this->visitor_country . "'";
    $tb_data[2] = "'" . $session_id . "'";
    $tb_data[3] = "'" . $time_stamp . "'";
    $tb_data[4] = "'" . $time_stamp . "'";
    $this->insert("`online_visitors`", $tb_col, $tb_data);
} else {
    $this->update("`online_visitors`", "`visitor_ip`='$this->visitor_ip', `country`='$this->visitor_country', `last_time_stamp`='$time_stamp'", "`session_id`='$session_id'");
}

$this->delete("`online_visitors`", "`last_time_stamp`<'$time_limit'"); 
```

但它不会实时更新。我想每 30 秒检查一次用户数。我可能还想将此表连接到 jQuery 心跳功能，以便更可靠地知道当前有多少用户在线。

我是否正确地接近这个？关于如何在 jQuery 中实现这一点的任何提示（我不太擅长）？或者我的方法可以改进吗？

我也想改进我的php代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:03:54.943

您也可以通过其他方式执行此操作：不是通过 ajax 更新时间，而是假设用户在线，直到他离开页面或关闭浏览器。在这种情况下，您使用 ajax 将用户设置为离线并在浏览器触发 onbeforeunload 时执行它。在极少数情况下（断电、系统崩溃），不会触发此事件，因此最好检查最后一次更新的时间，以防您有浮动用户。

# playn - 在绘制方法期间无法渲染 SurfaceLayer

> ID：11705458
> 
> 赞同：1
> 
> 时间：2012-07-28T23:24:58.427
> 
> 标签：playn

**编辑**这是一个已在[https://github.com/threerings/playn/commit/137ce50dddd2716f84c38ec1568d7ae5a368434b](https://github.com/threerings/playn/commit/137ce50dddd2716f84c38ec1568d7ae5a368434b)中修复的错误。有关详细信息，请参阅 Par Eklund 的答案。

开始之前：我一般是游戏编程的新手，所以我很可能对我正在使用的工具有根本的误解。不过我会继续我的问题...

每当我尝试在该`paint`方法期间在我的表面层上绘制一些东西时，我都会出现黑屏。如果我在该方法期间绘制`init`它显示正常。

我正在尝试在[此处复制](https://developers.google.com/playn/devguide/rendering)*Surface Layer*横幅下的代码。有问题的代码是这样的：

```
public void paint() {
  // Draw 100 random peas imperatively.
  surf.clear(0);
  for (int i = 0; i < 100; ++i) {
    int x = (int)(random() * WIDTH);
    int y = (int)(random() * HEIGHT);
    surf.drawImage(pea, x, y);
  }
} 
```

我使用的是 PlayN 1.4，因此虽然该代码与我正在编写的代码不直接匹配，但我认为我至少具有等效的（除了我正在绘制白色矩形）：

```
public void paint(final float alpha) {
  surfaceLayer.surface().clear();
  surfaceLayer.surface().setFillColor(Color.rgb(255, 255, 255));
  for (int i = 0; i < 100; ++i) {
    int x = (int) (Math.random() * width);
    int y = (int) (Math.random() * height);
    surfaceLayer.surface().fillRect(x, y, 5, 5);
  }
} 
```

没有任何东西被渲染到屏幕上。如果我将该代码移动到`init`它按预期呈现的方法中。

现在**有趣**的是，如果我制作 PlayN 1.3.1 项目并使用*完全相同的代码*，它在绘制方法期间渲染得很好（鉴于我仍在使用完全相同的代码，我不确定 PlayN 网站在其示例中使用的是哪个版本代码...）。

我在这里错过了什么？1.4 改变了与表面层有关的东西，我现在必须以不同的方式使用它吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T18:48:10.480

我自己基本上是一个游戏编程的新手，我在 PlayN 1.5-SNAPSHOT 中遇到了与您相同的问题（至少相同的症状）。我在这里提交了一个问题：[http ://code.google.com/p/playn/issues/detail?id=205](http://code.google.com/p/playn/issues/detail?id=205)

另外，我的经验是，它似乎与渲染是在 init 方法还是在 paint 方法中完成无关。相反，似乎渲染只成功了_first_time_（发生第一帧渲染）。请参阅问题中的附件以获取（有点）最小的示例。

就像我在问题中所说的那样，我怀疑这与 GL20 实现以及如何管理帧缓冲区有关，但鉴于我对 OpenGL 更是一个新手，你应该对我的猜测持怀疑态度。

不过，PlayN 的主要贡献者应该能够很快回答并解决这个问题。让我们希望我们能尽快得到他们的关注。:)

# php - php mysql在另一行中包含一个行ID

> ID：11705464
> 
> 赞同：0
> 
> 时间：2012-07-28T23:25:58.900
> 
> 标签：php, mysql

我有一个 mysql 数据库，我想在另一行中包含一行的内容。我所有行的内容都是静态 html。我正在寻找类似于“包含”命令的东西。

这是一个例子：

```
Row 1=A
Row 2=fast
Row 3=red 
```

在第 4 行，我有内容“汽车”。我需要在第 4 行的内容之前包含第 1、2 和 3 行的内容。因此输出将是 A fast red car。

这可能吗？我只有一个数据库，所以没有外部参考。

我的mysql知识接近于零。我的程序员很懒惰，将所有相同的 html 复制到每一行。所以现在当我更新时，我必须更新多行中的静态 html。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:29:23.693

你可以简单地做这样的事情：

```
$query = mysqli_query($database_connection, "SELECT * FROM table_name LIMIT 4");
while ($row = mysqli_fetch_array($query)) {

echo $row['column_name']; } 
```

我希望这就是你的意思。

# objective-c - TableView 不推送到 WebView

> ID：11705466
> 
> 赞同：0
> 
> 时间：2012-07-28T23:26:38.183
> 
> 标签：objective-c, xcode, uitableview, uiviewcontroller, uiwebview

我正在尝试在应用程序内为我的网站制作 RSS 提要。我正在努力做到这一点，以便当用户单击我的 TableView 中的一个单元格时，它会将您带到已解析的特定帖子的链接。正在解析链接，但控制台给了我这个错误：

应用程序试图在 target 上推送一个 nil 视图控制器。

这是我的代码：

**WebViewController.h**

```
#import <Foundation/Foundation.h>

@interface WebViewController : UIViewController

@property (nonatomic, readonly) UIWebView *webView;

@end 
```

**WebViewController.m**

```
#import "WebViewController.h"

@implementation WebViewController

-(void)loadView
{
    CGRect screenFrame = [[UIScreen mainScreen] applicationFrame];
    UIWebView *wv = [[UIWebView alloc] initWithFrame:screenFrame];
    [wv setScalesPageToFit:YES];

    [self setView:wv];
}

-(UIWebView *)webView
{
    return (UIWebView *)[self view];
}

@end 
```

**MasterViewController.h**我的 TableView

```
#import <UIKit/UIKit.h>

// A forward declaration; we'll import the header in the .m
@class RSSChannel;
@class WebViewController;

@interface MasterViewController : UITableViewController
<NSXMLParserDelegate>
{
    NSURLConnection *connection;
    NSMutableData *xmlData;

    RSSChannel *channel;
}
@property (strong, nonatomic) IBOutlet UITableView *tableView;
@property (strong, nonatomic) IBOutlet UINavigationItem *navigationBar;
@property (nonatomic, strong) WebViewController *webViewController;

- (void)fetchEntries;

@end 
```

**主视图控制器.m**

```
#import "MasterViewController.h"
#import "WebViewController.h"
#import "RSSChannel.h"
#import "RSSItem.h"

@interface MasterViewController () {
    NSMutableArray *_objects;
}
@end

@implementation MasterViewController
@synthesize tableView = _tableView;
@synthesize navigationBar;
@synthesize webViewController;

- (void)awakeFromNib
{
    [super awakeFromNib];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self fetchEntries];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

#pragma mark - Table View

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

    UIImage *myImage = [UIImage imageNamed:@"SephardiJewsHeader.png"];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:myImage];
    imageView.frame = CGRectMake(0,-1,320,93);

    return imageView;

}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    return 93;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"The amount of items in the table: %u", [[channel items] count]);
    return [[channel items] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"UITableViewCell"];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle
                                      reuseIdentifier:@"UITableViewCell"];

    }
     RSSItem *item = [[channel items] objectAtIndex:[indexPath row]];

    [[cell textLabel] setText:[item title]];
    [[cell detailTextLabel] setText:[item date]];
    return cell;

}

- (void)fetchEntries
{
    // Create a new data container for the stuff that comes back from the service
    xmlData = [[NSMutableData alloc] init];

    // Construct a URL that will ask the service for what you want -
    // Note we can concatenate literal strings together on multiple lines in this way it 
    // results in a single NSString instance
    NSURL *url = [NSURL URLWithString:
                  @"http://sephardijews.com/feed/"];

    // Putting the URL we made into an NSURLRequest, so we can connect to the url data that we specifed
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Creating a connecting that will exchange this request for the data from the URL we specifed
    connection = [[NSURLConnection alloc] initWithRequest:req
                                                 delegate:self 
                                         startImmediately:YES];
}

- (void)parser:(NSXMLParser *)parser
    didStartElement:(NSString *)elementName 
    namespaceURI:(NSString *)namespaceURI
   qualifiedName:(NSString *)qualifedName 
    attributes:(NSDictionary *)attributeDict
{
    NSLog(@"%@ found a %@ element", self, elementName);
    if ([elementName isEqual:@"channel"]) {

        // If the parser saw a channel, create new instance, store in our ivar
        channel = [[RSSChannel alloc] init];

        // Give the channel object a pointer back to ourselves for later
        [channel setParentParserDelegate:self];

        // Set the parser's delegate to the channel object
        [parser setDelegate:channel];
    }
}

// This method will be called several times as the data arrives
- (void)connection:(NSURLConnection *)conn didReceiveData:(NSData *)data
{
    // Add the incoming chunk of data to the container we are keeping
    // The data always comes in the correct order
    [xmlData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)conn
{
    // Create the parser object with the data received from the web service
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:xmlData];

    // Give it a delegate - don't worry about the warning
    [parser setDelegate:self];

    // Tell it to start parsing - the documet will be parsed and the delegate of NSXMLParser will get all of its delegate messages sent to it before this line finishes execution - it is blocking
    [parser parse];

    // Get rid of the XML data as we no longer need it
    xmlData = nil;

    // Get rid of the connection, no longer need it
    connection = nil;

    // Reload the table
    [[self tableView] reloadData];
    NSLog(@"%@\n %@\n %@\n", channel, [channel title], [channel infoString]);

}

- (void)connection:(NSURLConnection *)conn didFailWithError:(NSError *)error
{
    // Release the connection object, we are done with it cause' there is no connection
    // Setting the connection to nil will stop the connection because it is nothing/0
    connection = nil;

    // Release the xmlData object. We stopped to connection to put the data in the xmlData object, so we set it to nil also
    xmlData = nil;

    // Grab the description of the error object passed to us, so we can tell the user
    NSString *errorString = [NSString stringWithFormat:@"Fetch failed: %@", [error localizedDescription]];

    // Create and show an alert view to the user with the error string to tell them the error in the process of the connection
    UIAlertView *av = [[UIAlertView alloc] initWithTitle:@"Error" 
                                                 message:errorString
                                                delegate:nil 
                                       cancelButtonTitle:@"OK"
                                       otherButtonTitles:nil];

    [av show];
}
/*  - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    WebViewController *aWebViewController = [[WebViewController alloc] init];
    self.webViewController = aWebViewController;
    [self.navigationController pushViewController:self.webViewController animated:YES];
    RSSItem *entry = [[channel items] objectAtIndex:[indexPath row]];
    NSURL *url = [NSURL URLWithString:[entry link]];
    NSURLRequest *req = [NSURLRequest requestWithURL:url];
    [[webViewController webView] loadRequest:req];
    [[webViewController navigationItem] setTitle:[entry title]];

} */

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"showPost"]) {
        WebViewController *awebViewController = [segue destinationViewController];
        self.webViewController = awebViewController;
        NSIndexPath *selectedRow = [self.tableView indexPathForSelectedRow];
        RSSItem *entry = [[channel items] objectAtIndex:[selectedRow row]];
        NSURL *url = [NSURL URLWithString:[entry link]];
        NSURLRequest *req = [NSURLRequest requestWithURL:url];
        [[webViewController webView] loadRequest:req];
        [[webViewController navigationItem] setTitle:[entry title]];
    }
}
@end 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:54:06.467

您的 WebViewController 没有在任何地方初始化。在你的试试这个`tableView:didSelectRowAtIndexPath:`：

```
WebViewController *aWebViewController = [WebViewController alloc] init];
self.webViewController = aWebViewController;
[self.navigationController pushViewController:self.webViewController animated:YES];
[aWebViewController release]; 
```

* * *

如果您使用 Storyboard，请添加一个视图控制器并将其类更改为 WebViewController。在 Storyboard 中的 MasterViewController 中，右键单击一个单元格并将 push segue 连接到 WebViewController。单击 push segue 并将其标识符更改为“showPost”之类的东西。

返回**MasterViewController.m**并从中删除您的代码`tableView:didSelectRowAtIndexPath:`并添加以下内容：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"showPost"]) {
        WebViewController *aWebViewController = [segue destinationViewController];
        NSIndexPath *selectedRow = [self.tableView indexPathForSelectedRow];
        RSSItem *entry = [[channel items] objectAtIndex:[selectedRow row]];
        NSURL *url = [NSURL URLWithString:[entry link]];
        NSURLRequest *req = [NSURLRequest requestWithURL:url];
        [aWebViewController.webView loadRequest:req];
        aWebViewController.title = entry.title
    }
} 
```

# jakarta-ee - 如何检查servlet名称是否存在？

> ID：11705467
> 
> 赞同：1
> 
> 时间：2012-07-28T23:26:37.873
> 
> 标签：jakarta-ee, servlets

在转发请求之前，我需要知道 servlet 是否存在！我怎么能做到这一点（最好的方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T12:23:10.347

如果您使用的是 Servlet 3.0，只需检查是否[`ServletContext#getServletRegistration()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getServletRegistration%28java.lang.String%29)不返回`null`给定的 servlet 名称。

如果您还没有使用 Servlet 3.0，请自行解析`web.xml`。

也就是说，这是一个相当奇怪的要求。servlet 是否基于某种条件以动态/编程方式添加？在转发之前准确检查该条件可能会更容易。

# java - JNI 异常访问冲突

> ID：11705486
> 
> 赞同：0
> 
> 时间：2012-07-28T23:29:31.180
> 
> 标签：java, c, jvm, java-native-interface, access-violation

目前我正在尝试使用 JNI。

我的 Java 代码：

```
public class test{
static{

    System.loadLibrary("wakeup64");

}

public static native boolean setWakeupTime(Date date);

public static void set(){
    Date d = new Date();
    setWakeupTime(d);

}

} 
```

C代码：

```
#include <jni.h>
#include "cpp_interface.h"
#include <stdio.h>

JNIEXPORT void JNICALL Java_test_setWakeupTime
  (JNIEnv *env, jclass cl, jobject date){

    printf("test");

  }

  int main(){

  } 
```

代码编译得很好，但是如果我运行我的 java 类，我会得到一个 exception_access_violation：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x000000000000c038, pid=7456, tid=4640
#
# JRE version: 7.0_03-b05
# Java VM: Java HotSpot(TM) 64-Bit Server VM (22.1-b02 mixed mode windows-amd64     compressed oops)
# Problematic frame:
# C  0x000000000000c038
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of     Windows
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.sun.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x000000000211b000):  JavaThread "main" [_thread_in_native, id=4640,     stack(0x0000000002290000,0x0000000002390000)]

siginfo: ExceptionCode=0xc0000005, ExceptionInformation=0x0000000000000008 0x000000000000c038

Registers:
RAX=0x0000000000000000, RBX=0x0000000000000015, RCX=0x00000000fffffff4,     RDX=0x000000014000d040
RSP=0x000000000238f668, RBP=0x000000000238f858, RSI=0x0000000000000001, RDI=0x00000000000000fc
R8 =0x000000000238f878, R9 =0x00000000065cc490, R10=0x00000000023a21bc, R11=0x000000005b958940
R12=0x0000000000000000, R13=0x000000073b0739e0, R14=0x000000014000d570, R15=0x000000000211b000
RIP=0x000000000000c038, EFLAGS=0x0000000000010246

Top of Stack: (sp=0x000000000238f668)
0x000000000238f668:   0000000140002cd9 000000000238f7c0
0x000000000238f678:   000000005b922181 000000000211bd88
0x000000000238f688:   000000000211b000 0000000000000003
0x000000000238f698:   000000000211ba90 000000000238f878
0x000000000238f6a8:   0000000140002d60 0000000000000011
0x000000000238f6b8:   000000000211b000 000000014000d750
0x000000000238f6c8:   000000073b0739e0 000000000211b990
0x000000000238f6d8:   0000000140004374 000000000211bd88
0x000000000238f6e8:   0000000000000004 000000000238f7c0
0x000000000238f6f8:   00000000023ad623 000000073b0739e0
0x000000000238f708:   0000000140004453 0000000000000022
0x000000000238f718:   000000073b073730 000000014000d750
0x000000000238f728:   000000000211b000 000000000238f7c8
0x000000000238f738:   00000001400015e2 000000014000d040
0x000000000238f748:   0000000140001000 000000000238f858
0x000000000238f758:   0000000000000000 000000073b0739e0 

Instructions: (pc=0x000000000000c038)
0x000000000000c018:   
[error occurred during error reporting (printing registers, top of stack, instructions near pc), id 0xc0000005]

Register to memory mapping:

RAX=0x0000000000000000 is an unknown value
RBX=0x0000000000000015 is an unknown value
RCX=0x00000000fffffff4 is an unknown value
RDX=0x000000014000d040 is an unknown value
RSP=0x000000000238f668 is pointing into the stack for thread: 0x000000000211b000
RBP=0x000000000238f858 is pointing into the stack for thread: 0x000000000211b000
RSI=0x0000000000000001 is an unknown value
RDI=0x00000000000000fc is an unknown value
R8 =0x000000000238f878 is pointing into the stack for thread: 0x000000000211b000
R9 =0x00000000065cc490 is an unknown value
R10=0x00000000023a21bc is an Interpreter codelet
method entry point (kind = native)  [0x00000000023a1f40, 0x00000000023a27c0]  2176     bytes
R11=0x000000005b958940 is an unknown value
R12=0x0000000000000000 is an unknown value
R13=0x000000073b0739e0 is an oop
{method} 
 - klass: {other class}
R14=0x000000014000d570 is an unknown value
R15=0x000000000211b000 is a thread

Stack: [0x0000000002290000,0x0000000002390000],  sp=0x000000000238f668,  free space=1021k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  0x000000000000c038
j  test.print()V+9
j  Main.main([Ljava/lang/String;)V+10
v  ~StubRoutines::call_stub

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  wecker.setWakeupTime(Ljava/util/Date;)Z+0
j  wecker.print()V+9
j  Main.main([Ljava/lang/String;)V+10
v  ~StubRoutines::call_stub

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x00000000065a9000 JavaThread "Service Thread" daemon [_thread_blocked, id=5300,     stack(0x0000000007840000,0x0000000007940000)]
  0x00000000065a7800 JavaThread "C2 CompilerThread1" daemon [_thread_blocked, id=7416,     stack(0x0000000007690000,0x0000000007790000)]
  0x0000000006594000 JavaThread "C2 CompilerThread0" daemon [_thread_blocked, id=4656, stack(0x00000000074d0000,0x00000000075d0000)]
  0x0000000006591000 JavaThread "Attach Listener" daemon [_thread_blocked, id=5864, stack(0x00000000073b0000,0x00000000074b0000)]
  0x000000000658c000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=7252, stack(0x0000000007260000,0x0000000007360000)]
  0x0000000002067000 JavaThread "Finalizer" daemon [_thread_blocked, id=2840, stack(0x0000000007060000,0x0000000007160000)]
  0x000000000205e800 JavaThread "Reference Handler" daemon [_thread_blocked, id=8056,     stack(0x0000000006e30000,0x0000000006f30000)]
=>0x000000000211b000 JavaThread "main" [_thread_in_native, id=4640,     stack(0x0000000002290000,0x0000000002390000)]

Other Threads:
  0x0000000002055000 VMThread [stack: 0x0000000006c00000,0x0000000006d00000] [id=8016]
  0x00000000065c2000 WatcherThread [stack: 0x0000000007a70000,0x0000000007b70000] [id=6884]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 PSYoungGen      total 57344K, used 983K [0x00000007c0000000, 0x00000007c4000000,     0x0000000800000000)
  eden space 49152K, 2% used [0x00000007c0000000,0x00000007c00f5c98,0x00000007c3000000)
  from space 8192K, 0% used [0x00000007c3800000,0x00000007c3800000,0x00000007c4000000)
  to   space 8192K, 0% used [0x00000007c3000000,0x00000007c3000000,0x00000007c3800000)
 PSOldGen        total 131072K, used 0K [0x0000000740000000, 0x0000000748000000, 0x00000007c0000000)
  object space 131072K, 0% used [0x0000000740000000,0x0000000740000000,0x0000000748000000)
 PSPermGen       total 21248K, used 2569K [0x000000073ae00000, 0x000000073c2c0000, 0x0000000740000000)
  object space 21248K, 12% used [0x000000073ae00000,0x000000073b0827c8,0x000000073c2c0000)

Code Cache  [0x0000000002390000, 0x0000000002600000, 0x0000000005390000)
 total_blobs=169 nmethods=0 adapters=136 free_code_cache=48773Kb     largest_free_block=49943680

Dynamic libraries:
0x000000013f530000 - 0x000000013f563000     C:\Windows\system32\java.exe
0x0000000077730000 - 0x00000000778d9000     C:\Windows\SYSTEM32\ntdll.dll
0x0000000077610000 - 0x000000007772f000     C:\Windows\system32\kernel32.dll
0x000007fefde10000 - 0x000007fefde7c000     C:\Windows\system32\KERNELBASE.dll
0x00000000707d0000 - 0x000000007081a000     D:\Program Files\AVAST     Software\Avast\snxhk64.dll
0x000007feff7f0000 - 0x000007feff8cb000     C:\Windows\system32\ADVAPI32.dll
0x000007fefe7b0000 - 0x000007fefe84f000     C:\Windows\system32\msvcrt.dll
0x000007feff970000 - 0x000007feff98f000     C:\Windows\SYSTEM32\sechost.dll
0x000007fefe3e0000 - 0x000007fefe50d000     C:\Windows\system32\RPCRT4.dll
0x0000000077510000 - 0x000000007760a000     C:\Windows\system32\USER32.dll
0x000007fefe360000 - 0x000007fefe3c7000     C:\Windows\system32\GDI32.dll
0x000007fefe3d0000 - 0x000007fefe3de000     C:\Windows\system32\LPK.dll
0x000007fefe900000 - 0x000007fefe9c9000     C:\Windows\system32\USP10.dll
0x000007fefc360000 - 0x000007fefc554000         C:\Windows\WinSxS\amd64_microsoft.windows.common-    controls_6595b64144ccf1df_6.0.7601.17514_none_fa396087175ac9ac\COMCTL32.dll
0x000007fefe9d0000 - 0x000007fefea41000     C:\Windows\system32\SHLWAPI.dll
0x000007feffa10000 - 0x000007feffa3e000     C:\Windows\system32\IMM32.DLL
0x000007fefe250000 - 0x000007fefe359000     C:\Windows\system32\MSCTF.dll
0x0000000062860000 - 0x0000000062931000     D:\Program Files\Java\jre7\bin\msvcr100.dll
0x000000005b7a0000 - 0x000000005be7a000     D:\Program     Files\Java\jre7\bin\server\jvm.dll
0x000007fefabf0000 - 0x000007fefabf9000     C:\Windows\system32\WSOCK32.dll
0x000007fefe850000 - 0x000007fefe89d000     C:\Windows\system32\WS2_32.dll
0x000007feff7e0000 - 0x000007feff7e8000     C:\Windows\system32\NSI.dll
0x000007fefbc40000 - 0x000007fefbc7b000     C:\Windows\system32\WINMM.dll
0x0000000077900000 - 0x0000000077907000     C:\Windows\system32\PSAPI.DLL
0x0000000062a10000 - 0x0000000062a1f000     D:\Program Files\Java\jre7\bin\verify.dll
0x00000000629e0000 - 0x0000000062a08000     D:\Program Files\Java\jre7\bin\java.dll
0x00000000629c0000 - 0x00000000629d5000     D:\Program Files\Java\jre7\bin\zip.dll
0x0000000140000000 - 0x0000000140012000             C:\Users\xx\workspace\test\src\wakeup64.dll

VM Arguments:
java_command: Main
Launcher Type: SUN_STANDARD

Environment Variables:
PATH=C:\Program Files (x86)\AMD APP\bin\x86_64;C:\Program Files (x86)\AMD     APP\bin\x86;D:\Program Files\Common Files\Microsoft Shared\Windows Live;D:\Program Files     (x86)\Common Files\Microsoft Shared\Windows     Live;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPow    erShell\v1.0\;C:\Program Files (x86)\ATI Technologies\ATI.ACE\Core-Static;C:\Program     Files (x86)\Windows Live\Shared;D:\Program Files(x86)\Android\android-sdk\platform-    tools\;C:\Program Files\ATI Technologies\ATI.ACE\Core-Static;D:\Program     Files\Java\jdk1.7.0_02\bin;D:\MinGW\bin;D:\Program Files (x86)\Microsoft Visual Studio     9.0\VC\bin
USERNAME=xx
OS=Windows_NT
PROCESSOR_IDENTIFIER=AMD64 Family 16 Model 5 Stepping 2, AuthenticAMD

---------------  S Y S T E M  ---------------

OS: Windows 7 , 64 bit Build 7601 Service Pack 1

CPU:total 4 (4 cores per cpu, 1 threads per core) family 16 model 5 stepping 2, cmov, cx8, fxsr, mmx, sse, sse2, sse3, popcnt, mmxext, 3dnowpref, lzcnt, sse4a

Memory: 4k page, physical 12581048k(7862816k free), swap 25160244k(19112368k free)

vm_info: Java HotSpot(TM) 64-Bit Server VM (22.1-b02) for windows-amd64 JRE (1.7.0_03-b05), built on Feb  3 2012 20:43:56 by "java_re" with unknown MS VC++:1600

time: Sun Jul 29 01:02:23 2012
elapsed time: 0 seconds 
```

有人遇到过这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T06:58:29.080

使用 javah 重新生成头文件，并相应地修复 .c 文件。您已在 Java 本机方法声明中将返回类型从 void 更改为 boolean，而无需调整本机代码。

并摆脱 main()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T20:21:14.570

@technomage：我将其编译为 .dll 而不是 exe

通过使用 Visual Studio 2012 中的预配置 shell 而不是普通的 cmd，半解决了我的问题。似乎是我的环境配置中的错误

谢谢大家

# jquery - 在 JQM 中刷新页面，然后触发 pageinit

> ID：11705488
> 
> 赞同：0
> 
> 时间：2012-07-28T23:29:46.687
> 
> 标签：jquery, jquery-mobile

我有以下设置：

`Page1`有：

**更新**

*   **更新：（`input type="date"`在页面初始化设置为今天）**
*   一个链接到另一个页面（`Page2`）的按钮，带有列表视图
*   根据从列表视图页面中选择的用户获取更新的 div

`Page2`有：

*   一堆链接的列表视图。

当用户单击它的链接时，`Page2`会根据日期检查选择是否有效`Page1`。如果是，那么它会返回`Page1`并更新`div`一堆关于选择的信息。如果选择无效，则会弹出一个带有消息和按钮的对话框`Start Over`。

这一切都很好，除了我想做的是当用户点击`Start Over`重新加载并重定向到`Page1`

我就是这样做的：

```
<input type="button" class="reload" value="Start Over" />
$('.reload').live( "click", function()
{
    $.mobile.changePage( "#Page1", {
        transition: "slide",
        reverse: true,
        changeHash: true,
        reloadPage: true
    });
}); 
```

这有效，但是一旦重新加载页面，它就不会调用`pageinit`

```
$('#Page1').live( 'pageinit',function(event){
  setTodaysDate();
}); 
```

因此日期不会显示在`Page1`

该页面需要重新加载，因为我必须休息，`div`所以它不会显示任何有关宝贵成功选择的信息。知道如何完成这项任务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:44:01.887

你为什么不`$('#Page1').on('pageshow', ...);`改用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:44:42.627

尝试将以下代码放在第 1 页，

```
$(document)
  .unbind("pageshow.initializedate")
  .bind("pageshow.initializedate",
    function(event){
      setTodaysDate();
    }
  ); 
```

请注意，页面初始化事件（例如 pageinit）只会在每个“页面”触发一次，而显示/隐藏事件则在每次显示和隐藏页面时触发。请注意，在 jQuery mobile 中，页面默认通过 ajax 加载并缓存。每页一次意味着它只会在页面第一次加载时触发，一旦页面被缓存并再次显示，页面初始化事件将不再执行。

# ruby-on-rails-3 - 在显示长值/字符串后，rails 控制台 pry/irb “卡住”

> ID：11705489
> 
> 赞同：11
> 
> 时间：2012-07-28T23:29:48.607
> 
> 标签：ruby-on-rails-3, irb, pry

我正在通过 pry/irb 使用 rails 控制台在 mac 上使用 rails 进行开发。

当我在控制台中显示长结果时，即。Model.all 或 .really_long_string，我似乎无法超越显示的字符串或值，并且控制台在控制台末尾显示“（END）”。

我使用什么命令来解决这个问题，这样我就可以继续在控制台上输入 ruby​​ 语句而不必关闭终端窗口？

我最近发现 Ctrl Z 可以关闭控制台，但我认为有更好的方法

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-29T01:03:51.603

看起来END是由寻呼机制作的。你试过输入“q”吗？

# java - 阅读输入流

> ID：11705491
> 
> 赞同：0
> 
> 时间：2012-07-28T23:30:28.013
> 
> 标签：java, android, io, bluetooth

我正在尝试通过蓝牙通信将整数发送到 Android 设备。我的问题是如何从输入流中读取字符数组？

这是我的服务器代码 Java 的一部分：

```
try {
    outStream = connection.openOutputStream();  
    int numbers = (int) (Math.random() * 10);
    outStream.write(numbers);
    System.out.println(numbers);

} catch (IOException e) {
    e.printStackTrace();
} 
```

目标是让 Android 读取服务器发送的整数。我也尝试使用 PrintWriter 方法发送数据（随机数），如下所示：

```
outStream = connection.openOutputStream();
pWriter = new PrintWriter(new OutputStreamWriter(outStream));

int numbers = (int) (Math.random() * 10);
pWriter.write(numbers);
System.out.println(numbers);
pWriter.flush();
pWriter.close(); 
```

如果使用此方法 print.write，我知道它只发送单个字符，所以我的问题是如何将字符数组发送到 Android？

这是我的 Android 代码的一部分：

```
public void run() {
    int data = in.read(buffer);

    while (true) {
        try {
            byte[] buffer = new byte[1024];
            int data;

            data = in.read(buffer);
            data = in.read(buffer, 0, buffer.length);

        } catch (IOException ex) {
            Log.e(TAG_IOThread, "disconnected", ex);
            break;
        }
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T17:06:49.897

确实是 DataOutpustream，我使用 writeInt() 方法，在服务器上我更改为 readInt(); 我认为使用 OutputStream 发送整数和 InputStream 接收它是可能的。

# flash - 警告用户需要 Flash

> ID：11705492
> 
> 赞同：0
> 
> 时间：2012-07-28T23:30:40.910
> 
> 标签：flash

我的网站中嵌入了 Flash 视频。我想警告任何没有 Flash 或使用不支持 Flash 的设备的用户。怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:48:01.373

将警告放在 Flash 视频`<object>`标签内，例如：

```
<object> <p> This is a warning </p> </object> 
```

或者

```
<object> <image src = "warning.jpg" /> </object> 
```

请记住，在大多数情况下，当用户的设备上没有安装 Flash 时，系统会自动通知他必须安装 Flash 才能观看视频：

![在此处输入图像描述](../Images/8730f0c65fd15ce106c6b2c177b6664b.png) ![在此处输入图像描述](../Images/2aaa2ead267201ea99f9da4e45de6644.png)

# django - django 从表单字段中获取值/变量名

> ID：11705494
> 
> 赞同：1
> 
> 时间：2012-07-28T23:31:05.720
> 
> 标签：django, forms, field, django-class-based-views

我是 django 的新手，我正在尝试制作一个基于类的视图，我可以在其中选择我想要使用的模型或表单（或不使用表单），例如：

视图.py：

```
class Foo(object):
    #some code here

    def get_query(self):
        if self.form.is_valid():
            return self.form.cleaned_data['field_name']

        return '' 
```

假设我有两种形式：

表格.py：

```
class Bar(forms.Form):
    title = forms.CharField(max_length = 200)
    content = forms.CharField(max_length = 200) 
```

表格.py：

```
 class Baz(Bar):
        date = DateField() 
```

从上面的视图中，我得到了 get_query 方法，我从字段名称中获取值，但问题不是所有表单都相同，Bar 有 2 个字段，Baz 有 3 个字段，也许我想要 100 个字段（只是可能），我在想使用循环，那么有没有办法从字段中获取所有值？是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:43:35.803

您正在寻找的是 self.fields ，我认为它是一个 dict(?) 并包含所有表单字段和名称等。有关如何动态提取未知大表单字段的任何详细信息，只需查看 BaseForm._clean_fields 中的代码即可大致了解如何访问它们。

# dart - 无法从文本区域获取文本

> ID：11705499
> 
> 赞同：2
> 
> 时间：2012-07-28T23:32:15.107
> 
> 标签：dart

我无法从我的 textarea 获取文本：

非常简单的文本区域：

```
<textarea id="message" placeholder="Type your text here..."></textarea> 
```

我的飞镖代码：

```
var area = document.query('#message');
document.query("#send").on.click.add((e) { 
   print('send ${area.text}');
}); 
```

当我在区域中写消息并按发送时，只需显示：

```
send 
```

我不明白为什么我的消息没有打印出来。“文本”不是正确的字段？（与 innerHtml 相同的问题）当我添加

```
area.text = 'Hello'; 
```

该消息在 textarea 中可见并且打印效果很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-28T23:37:26.057

使用`area.value`而不是`area.text`. `area.value`是`TextAreaElement`获取显示的实际值`area.text`的属性，而 是`Node`获取或设置`area`文本节点内容的属性。

# php - 插入在 MYSQL 中不起作用

> ID：11705505
> 
> 赞同：0
> 
> 时间：2012-07-28T23:33:01.917
> 
> 标签：php, mysql, ajax

我正在尝试使用 jquery 函数编写新记录。

```
$.post("insertuser.php",$("#rohanStart").serialize(),function(data){ 
    alert(data);
}); 
```

这似乎有效，我确实收到了带有回显状态的警报。问题是值没有被写入数据库。查询语句有问题吗？

```
mysql_query("INSERT INTO ajax_demo1( FirstName,LastName,Unit,Group,photo)
        VALUES (
            '".$arr['FirstName']."',
            '".$arr['LastName']."',
            '".$arr['Unit']."',
            '".$arr['Group']."',
            '".$arr['photo']."'
        )");

echo $arr['Group']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:55:19.723

首先不要使用 jQuery 或任何框架，它们依赖于专有的 Microsoft JScript innerHTML 方法，该方法不能与 DOM 一起正常工作，从而在脚本中增加了大量的歧义。

其次，您没有正确地将进入数据库的数据转义，这是一个严重的安全问题。

第三，您的数据库查询方法没有考虑错误处理，您只是直接将查询转储并希望获得最好的结果。

您应该始终对您的查询进行编号并将其附上，如下所示。请注意，除了错误之外，最好预先失败条件，但是对于数据库结构，如果首先成功，则应该执行然后不能增加缩进（通过一个空格，而不是在您有五个屏幕可以水平滚动的情况下浪费此选项卡）所以您可以在自己的代码中可视化您所在的位置。

```
$query1 = "SELECT * FROM table_name WHERE something='value'";
$result1 = mysql_query($query1);

if ($result1)
{
 $row1 = mysql_fetch_assoc($result1);
}
else {mysql_error_report($query1,mysql_error(),__FUNCTION__);} 
```

如果您的主标头包含（您确实为除 AJAX 之外的所有请求都包含主标头正确吗？）您应该有一个通用的 MySQL 错误处理功能，您可以使用它来记录 SQL 错误。

以下是通用数据库错误处理程序。您应该有 HTTP、JavaScript、PHP 和 SQL 错误的管理错误日志，这样您就可以查看和纠正访问者遇到的问题，而不是仅仅因为它们给您带来不便。

```
function mysql_error_report($q,$e,$f)
{
 if (isset($_SESSION['database']))
 {
  if (isset($_SESSION['id_member'])) {$id = $_SESSION['id_member'];} else {$id = 0;}
  if (isset($_SESSION)) {$session = mysql_real_escape_string(session_id());} else {$session = 0;}
  $ip = mysql_real_escape_string(getenv('REMOTE_ADDR'));

  $query = mysql_real_escape_string($q);
  $error = mysql_real_escape_string($e);
  $function = mysql_real_escape_string($f);
  if (isset($_SESSION['type'])) {$type = mysql_real_escape_string($_SESSION['type']);} else if (isset($_SESSION['cms_browser'])) {$type = 'Browser';} else {$type = 'Unknown';}
  if (isset($_SERVER['REQUEST_URI'])) {$url = $_SERVER['REQUEST_URI'];} else {$url = '';}
  if (isset($_SERVER['HTTP_USER_AGENT'])) {$ua = mysql_real_escape_string($_SERVER['HTTP_USER_AGENT']);} else {$ua = '';}

  $query1 = "INSERT INTO log_errors_sql (id_session, type, id_user, date, ip, function, mysql_error, mysql_query, url, user_agent) VALUES ('$session', '$type', '$id', NOW(), INET_ATON('$ip'), '$function', '$error', '$query', '$url', '$ua')";
  $result1 = mysql_query($query1);

  if (!$result1) {mysql_error_report_mail($q,$e,$f,$ua);}
 }
 else {mysql_error_report_mail($q,$e,$f);}
} 
```

通过使用这种方法，您将加强您的编码实践，使其更加严格。您不希望模棱两可，您希望对您的代码完全严格，因为您的编码中的主观性越少，您的代码就越能处理。

你的空白也很松散。

这...

```
INSERT INTO ajax_demo1( FirstName,LastName,Unit,Group,photo) 
```

应该是这样的格式...

```
INSERT INTO ajax_demo1(FirstName, LastName, Unit, Group, photo) 
```

你可能会问为什么保持这样的空白很重要，如果你没有花很多时间在查找和替换上（查看“高级查找和替换”，它适用于 wine/Linux 并且把废话吹走本机 Linux 控制台命令性能明智，而且非常便宜，支持正则表达式等）您会发现自己在眨眼间进行大规模站点范围的编辑，因为即使您的空白空间也是同样严格的方法。

如果您听从我的建议，请使用 AFR（高级查找和替换）来搜索（但不替换）“mysql_query”的所有实例并更正您编写的所有内容的格式。混合一些 AJAX 通知，当您仍在浏览器中时，您可以立即看到错误，而无需单个 alt-tab。我就是这样滚动的。

...当然，这样做会使您的调试更加容易。这不是鱼，这是钓鱼，希望对您有所帮助。

# php - PHP：验证美国电话号码

> ID：11705507
> 
> 赞同：2
> 
> 时间：2012-07-28T23:33:22.097
> 
> 标签：php

我目前正在验证美国电话号码。问题是下面的代码总是在有效或无效输入之后回显`Please enter a valid phone number`。我的代码的基本逻辑是我正在检查 preg_match 以查看是否有匹配的有效数字。[**例子**](http://webprolearner.ueuo.com/dropdown-menu/test1.php)

我该如何解决这个问题，或者有更好的方法来验证电话号码？此外，是否可以回显格式如下的数字：`(123)456-7890`？

**PHP**：

```
if (isset($_POST['phone'])) {
    if(preg_match('/^(\({1}\d{3}\){1}|\d{3})(\s|-|.)\d{3}(\s|-|.)\d{4}$/',$phone)) {
        echo ('<div id="phone_input"><span id="resultval">'.$phone.'</span></div>');
    }
    else {
        echo '<div id="phone_input"><span id="resultval">Please enter a valid phone number</span></div>';
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T23:37:10.227

尝试这个

```
<?php
class Validation {
    public $default_filters = array(

        'phone' => array(
            'regex'=>'/^\(?(\d{3})\)?[-\. ]?(\d{3})[-\. ]?(\d{4})$/',
            'message' => 'is not a valid US phone number format.'
        )
    );
    public $filter_list = array();

    function Validation($filters=false) {
        if(is_array($filters)) {
            $this->filters = $filters;
        } else {
            $this->filters = array();
        }
    }

    function validate($filter,$value) {
        if(in_array($filter,$this->filters)) {
            if(in_array('default_filter',$this->filters[$filter])) {
                $f = $this->default_filters[$this->filters[$filter]['default_filter']];
                if(in_array('message',$this->filters[$filter])) {
                    $f['message'] = $this->filters[$filter]['message'];
                }
            } else {
                $f = $this->filters[$filter];
            }
        } else {
            $f = $this->default_filters[$filter];
        }
        if(!preg_match($f['regex'],$value)) {
            $ret = array();
            $ret[$filter] = $f['message'];
            return $ret;
        }
        return true;
    }
}

//example usage
$validation = new Validation();
echo nl2br(print_r($validation->validate('phone','555-555-1212'),true));
echo nl2br(print_r($validation->validate('phone','(555)-555-1212'),true));
echo nl2br(print_r($validation->validate('phone','555 555 1212'),true));
echo nl2br(print_r($validation->validate('phone','555.555.1212'),true));
echo nl2br(print_r($validation->validate('phone','(555).555.1212'),true));
echo nl2br(print_r($validation->validate('phone','(555)---555.1212'),true));//will not match
?> 
```

# objective-c - NSButton 的子类：动作调用方法崩溃

> ID：11705508
> 
> 赞同：1
> 
> 时间：2012-07-28T23:33:42.440
> 
> 标签：objective-c, action, target, nsbutton, nswindowcontroller

在我的应用程序中有一个`NSWindowController`. 在`- (void)awakeFromNib`我创建一个`NSView`子类的实例以创建底部放置的按钮栏：

```
self.buttonBar = [[CNButtonBar alloc] initWithSize:NSMakeSize(tableViewRect.size.width-1, 25)]; 
```

这个`CNButtonBar`东西有一个方法可以给自己添加按钮。我创建了两个：

```
[buttonBar addButtonWithTitle:nil
                        image:[NSImage imageNamed:NSImageNameAddTemplate]
                       target:self
                       action:@selector(btnAccountAddAction:)
                    alignment:CNBarButtonAlignLeft];

[buttonBar addButtonWithTitle:nil
                        image:[NSImage imageNamed:NSImageNameRemoveTemplate]
                       target:self
                       action:@selector(btnAccountRemoveAction:)
                    alignment:CNBarButtonAlignLeft]; 
```

`NSViewController`这两个操作方法是在我发送这两个`addButtonWithTitle:...`消息的同一实例中定义的。

用于设置动作的方法定义如下：

```
- (void)btnAccountAddAction:(id)sender
{
    ....
}

- (void)btnAccountRemoveAction:(id)sender
{
    ....
} 
```

但是，它不起作用。每次如果我单击这两个按钮之一，我的应用程序就会崩溃并抛出如下异常：

```
-[__NSArrayM btnAccountAddAction:]: unrecognized selector sent to instance 0x1001454e0 
```

检查过这个异常是绝对正确的。`NSArray`没有我想调用的这种方法。但是，有时抛出此异常的对象会发生变化。有时有一个`__NSData`对象，有时有一个`__NSDictionary`等等。似乎接收器不是我的`NSWindowController`子类。但是给定的实例 ID`0x1001454e0`与我的相同`NSWindowController`。

它让我想把头发扯下来！这里出了什么问题……？谢谢。

* * *

**更新**

我不得不说，`CNButtonBar`和`CNButtonBarButton`都是完全由代码绘制的。的完整方法在`addButtonWithTitle:image:target:action:alignment:`这里（请记住，这发生在`CNButtonBar`的子类中`NSView`（我应该使用`NSViewController`它来代替它吗？），`CNButtonBarButton`是 的子类`NSButton`）：

```
- (void)addButtonWithTitle:(NSString*)title image:(NSImage*)image target:(id)target action:(SEL)action alignment:(CNBarButtonAlign)align
{
    if (self.buttons == nil)
        self.buttons = [[NSMutableArray alloc] init];

    CNButtonBarButton *button = [[CNButtonBarButton alloc] init];
    [self.buttons addObject:button];

    button.title = title;
    button.image = image;
    button.target = target;
    button.action = action;
    button.align = align;

    NSRect buttonRect;
    NSSize titleSize = NSMakeSize(0, 0);
    if (button.title.length > 0) {
        NSMutableParagraphStyle* textStyle = [[NSMutableParagraphStyle defaultParagraphStyle] mutableCopy];
        [textStyle setAlignment: NSCenterTextAlignment];

        NSColor *textColor = [[NSColor blackColor] colorWithAlphaComponent:0.9];
        NSShadow* textShadow = [[NSShadow alloc] init];
        [textShadow setShadowColor: [NSColor whiteColor]];
        [textShadow setShadowOffset: NSMakeSize(0, -1)];
        [textShadow setShadowBlurRadius: 0];

        button.titleTextAttributes = [NSDictionary dictionaryWithObjectsAndKeys:
                                      [NSFont fontWithName:@"Helvetica Neue" size:11.0], NSFontAttributeName,
                                      textShadow,                     NSShadowAttributeName,
                                      textColor,                      NSForegroundColorAttributeName,
                                      textStyle,                      NSParagraphStyleAttributeName,
                                      nil];
        titleSize = [title sizeWithAttributes:button.titleTextAttributes];
        buttonRect = NSMakeRect(0, 0, roundf(titleSize.width) + kTextInset * 2, NSHeight(self.frame) - 1);

    }

    if (button.image != nil) {
        NSSize imageSize = [image size];
        if (button.title.length == 0) {
            buttonRect = NSMakeRect(0, 0, imageSize.width + kImageInset * 2, NSHeight(self.frame) - 1);

        } else {
            buttonRect = NSMakeRect(0, 0,
                                    (imageSize.width + kImageInset * 2) + (roundf(titleSize.width) + kTextInset),
                                    NSHeight(self.frame) - 1);
        }
    }

    switch (self.align) {
        case CNButtonBarAlignNormal: {
            switch (button.align) {
                case CNButtonBarButtonAlignLeft: {
                    button.frame = NSMakeRect(offsetLeft, 0, NSWidth(buttonRect), NSHeight(buttonRect));
                    offsetLeft += 1 * [self.buttons indexOfObject:button] + NSWidth(button.frame);
                    break;
                }

                case CNButtonBarButtonAlignRight: {
                    button.frame = NSMakeRect(offsetRight - NSWidth(buttonRect), 0, NSWidth(buttonRect), NSHeight(buttonRect));
                    offsetRight -= 1 * [self.buttons indexOfObject:button] + NSWidth(button.frame);
                    break;
                }
            }
            break;
        }

        case CNButtonBarAlignCentered: {
            break;
        }
    }
    [self addSubview:button];
} 
```

* * *

**更新 2**

问题已经解决了。经过一些调试，我发现这一定是 ARC 自动保留/释放的问题。我是对的。但问题是我的`NSViewController`子类。由于将实例作为局部变量（没有强指针）而泄漏。感谢[Sean D.](https://stackoverflow.com/users/1411506/sean-d)，这为我指明了正确的方向。(-;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T03:42:01.610

Looks like one of two things is happening. The first possibility is that your CNButtonBar object is getting released while the buttons are still around. If the buttons are still there, they'll try to send those selectors to whatever happens to occupy the memory the CNButtonBar used to be in. I'd say make sure it isn't autoreleasing itself anywhere, and that you're not accidentally autoreleasing it in the window controller's `-awakeFromNib` method. (If you're anything like me, that's the most likely culprit.)

The second possibility is that your `-addButtonWithTitle:image:target:action:alignment:` method is setting the buttons' actions but not their targets. Make sure your implementation of that method calls `-setTarget:` as well as `-setAction:` on the button.

# php - facebook喜欢按钮：更改宽度和高度

> ID：11705510
> 
> 赞同：0
> 
> 时间：2012-07-28T23:35:01.023
> 
> 标签：php, facebook-like, width

我有一个插件，其中显示了一些带有类似 facebook 按钮的新闻。我会在这个网站上改变它的宽度：（见右侧边栏） [http://www.fanpage.it/moody-s-boccia-anche-la-germania-e-la-prima-volta-per-拉默克尔/](http://www.fanpage.it/moody-s-boccia-anche-la-germania-e-la-prima-volta-per-la-merkel/)

这是我的网站： [http ://www.clouderize.it/michele/](http://www.clouderize.it/michele/)

对于我的按钮，我使用这个 url，但无论我设置什么宽度值，按钮尺寸都不会改变！我能怎么做 ？

```
<iframe 
        src="http://www.facebook.com/widgets/like.php?href=<? the_permalink(); ?>&layout=button_count&width=450&action=like&colorscheme=light&font&show_faces=false&height=64"
                            scrolling="no" frameborder="0" 
                            style="border:none;">
</iframe> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:43:56.243

试试这个

```
#fb-bar iframe{min-height:80px !important;}

<div id="fb-bar">
  <fb:like href="link"></fb:like>
</div> 
```

或者

```
<div id="fb-bar">
<iframe 
        src="http://www.facebook.com/widgets/like.php?href=<? the_permalink(); ?>&layout=button_count&width=450&action=like&colorscheme=light&font&show_faces=false&height=64"
                            scrolling="no" frameborder="0" 
                            style="border:none;">
</iframe>
</div> 
```

# android - 从用相机拍摄的图像中检索像素阵列

> ID：11705513
> 
> 赞同：1
> 
> 时间：2012-07-28T23:36:31.267
> 
> 标签：android, android-camera

我正在开发一个应用程序，该应用程序需要在拍摄后从图片中访问像素数组。主要活动如下。我有大量的 java 经验，但在屏幕上显示图像的经验非常有限。我看到字节数组被传递给图片回调方法，但我不知道它是如何格式化的。如何从捕获的图像中获取包含 RGB 分量的像素阵列？我试图通过堆栈溢出论坛找到这个，但是我得到了几百页的结果，并且只搜索了前 10 个左右，所以很抱歉，如果已经问过这个问题而我只是没有看到它。

```
 public class ConverterActivity extends Activity 
{
    private Camera mCamera;
    private CameraPreview mPreview;
private PictureCallback mPicture = new PictureCallback() {
private String TAG;
@Override
public void onPictureTaken(byte[] data, Camera camera) {
File pictureFile = getOutputMediaFile(MEDIA_TYPE_IMAGE);
if (pictureFile == null){
// Log.d(TAG, "Error creating media file, check storage permissions: " +
//  e.getMessage());
return;
}
try {
FileOutputStream fos = new FileOutputStream(pictureFile);
fos.write(data);
fos.close();
} catch (FileNotFoundException e) {
Log.d(TAG, "File not found: " + e.getMessage());
} catch (IOException e) {
Log.d(TAG, "Error accessing file: " + e.getMessage());
}
}
};

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

// Add a listener to the Capture button
Button captureButton = (Button) findViewById(R.id.button_capture);
captureButton.setOnClickListener(
new View.OnClickListener() {
@Override
public void onClick(View v) {
// get an image from the camera
mCamera.takePicture(null, null, mPicture);
}
}
);
        // Create an instance of Camera
        mCamera = Camera.open(this.getBackCamera());
        // Create our Preview view and set it as the content of our activity.
        mPreview = new CameraPreview(this, mCamera);
        FrameLayout preview = (FrameLayout) findViewById(R.id.camera_preview);
        preview.addView(mPreview);
}
@Override
    protected void onPause()
    {
        super.onPause();
        releaseCamera();              // release the camera immediately on pause event
    }
    private void releaseCamera(){
        if (mCamera != null){
            mCamera.release();        // release the camera for other applications
            mCamera = null;
        }
    }
public static final int MEDIA_TYPE_IMAGE = 1;
public static final int MEDIA_TYPE_VIDEO = 2;
/** Create a file Uri for saving an image or video */
private static Uri getOutputMediaFileUri(int type){
return Uri.fromFile(getOutputMediaFile(type));
}
/** Create a File for saving an image or video */
private static File getOutputMediaFile(int type){
// To be safe, you should check that the SDCard is mounted
// using Environment.getExternalStorageState() before doing this.
File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
Environment.DIRECTORY_PICTURES), "MyCameraApp");
// This location works best if you want the created images to be shared
// between applications and persist after your app has been uninstalled.
// Create the storage directory if it does not exist
if (! mediaStorageDir.exists()){
if (! mediaStorageDir.mkdirs()){
Log.d("MyCameraApp", "failed to create directory");
return null;
}
}
// Create a media file name
String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
File mediaFile;
if (type == MEDIA_TYPE_IMAGE){
mediaFile = new File(mediaStorageDir.getPath() + File.separator +
"IMG_"+ timeStamp + ".jpg");
} else if(type == MEDIA_TYPE_VIDEO) {
mediaFile = new File(mediaStorageDir.getPath() + File.separator +
"VID_"+ timeStamp + ".mp4");
} else {
return null;
}
return mediaFile;
}
public int getBackCamera()
{
int numCameras = Camera.getNumberOfCameras();
CameraInfo cInfo = new CameraInfo();
for (int i = 0; i < numCameras; i++)
{
Camera.getCameraInfo(i, cInfo);
if (cInfo.facing == CameraInfo.CAMERA_FACING_BACK)
{
return i;
}
}
return -1;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:29:33.477

如果你使用这样的代码拍照：

```
 imgFile = new File(Environment.getExternalStorageDirectory () + "/somefolder/" + name + ".jpg");

    String fileName = imgFile.getAbsolutePath();

    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(fileName)));

    startActivityForResult(intent, REQUEST_FROM_CAMERA); 
```

然后你应该能够，当你从这个意图中得到结果时，使用这样的代码来访问位图

```
 if (imgFile.exists()) {
        String fileName = file.getAbsolutePath();
        BitmapFactory.Options opts = new BitmapFactory.Options();
        Bitmap bm;

        opts.inJustDecodeBounds = false;

        bm = BitmapFactory.decodeFile(fileName, opts);
        return bm;
    }
    else return null; 
```

然后可以使用bitmapfactory工具，比如compress to stream再转换为byte[]

```
 ByteArrayOutputStream stream = new ByteArrayOutputStream();
  bm.compress(Bitmap.CompressFormat.JPEG, 100, stream);  // 100 = max quality
  byte[] byteArray = stream.toByteArray(); 
```

# c - Linux内核container_of宏示例编译错误

> ID：11705514
> 
> 赞同：1
> 
> 时间：2012-07-28T23:36:36.850
> 
> 标签：c, macros, compilation, linux-kernel

有人能告诉我这段代码有什么问题吗：

```
#include <stdio.h>
#include <stdlib.h>

#define offsetof(TYPE, MEMBER) ((size_t) &((TYPE *)0)->MEMBER)
#define container_of(ptr, type, member) ({                                     \
                        const typeof( ((type *)0)->member ) *__mptr = (ptr);   \
                        (type *)( (char *)__mptr - offsetof(type,member) );})
typedef struct _elem {
        int     a;
        float   b;
        double  c;
} elem;

int main(int argc, char **argv)
{
        elem    *my_elem = (elem *)malloc(sizeof *elem);

        my_elem->a = 1;
        my_elem->b = 2;
        my_elem->c = 3;
        elem     *new_elem_a = container_of(&(my_elem->a), struct _elem, int);
        fprintf(stdout, "container_of(&(my_elem->a), struct _elem, int) = %p", new_elem_a);

        return 0;
} 
```

当我编译我得到这个错误：

```
evariste@UnixServer:~$ gcc -Wall container_of_test.c -o container_of_test
container_of_test.c: In function ‘main’:
container_of_test.c:16:51: erreur: expected expression before ‘elem’
container_of_test.c:21:32: erreur: expected identifier before ‘int’
container_of_test.c:21:32: erreur: expected identifier before ‘int’ 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T23:55:24.897

这里有2个错误

1.  该 container_of 宏期望最后一个参数是成员名称。所以应该是

    `elem *new_elem_a = container_of(&(my_elem->a), struct _elem, a);`

2.  `elem *my_elem = (elem *)malloc(sizeof *elem)`

    sizeof 的操作数错误，应该是

    `elem *my_elem = (elem *)malloc(sizeof *my_elem)`

# php - Ajax、PHP、MySQL 检索数据

> ID：11705518
> 
> 赞同：0
> 
> 时间：2012-07-28T23:37:04.000
> 
> 标签：php, jquery, mysql, ajax, scripting

我正在尝试从特定 DIV 中的 mysql 服务器自动检索数据，而无需手动刷新网页。

我的 PHP 代码是：

```
function lastCodes(){
    include('mysql.php');
    include('config.php');

echo "<div id='content_data'>";

    $get = mysql_query("SELECT * FROM scripts ORDER by date_added DESC");
    if(mysql_num_rows($get)>0){
        while($row = mysql_fetch_assoc($get)){

            $get2 = mysql_query("SELECT * FROM accounts WHERE username = '$row[s_owner]'");
                while($red = mysql_fetch_assoc($get2)){

            echo "<table>
                        <tr>
                                <td width='22px'>";
                        if(!empty($red['avatar'])){
                            echo "<center>
                                        <img src='$red[avatar]' style='width: 52px; height: 52px; margin-left: -30px; border: 2px solid #fff;' title='$row[s_owner]'/>
                                    </center>
                                </td>";
                        } else {
                            echo "<td width='22px'>
                                        <center>
                                            <img src='/theme/$tema/icons/empty_avatar.png' style='width: 52px; height: 52px;' title='$row[s_owner]'/>
                                        </center>
                                    </td>";
                        }       

            echo "<td>
                        <a style='font-family: IndexName; color: #000; font-size: 14px; margin-left: 5px;'><b>$row[s_owner]</b> написа <a title='$row[s_name], Категория: $row[s_category].' href='#' style='text-decoration: none;'>нов код</a> <a style='font-family: IndexName; color: #000; font-size: 14px; margin-right: 10px;'>в $row[date_added]</a>
                    </td>
                    </tr>
                    </table>";

        }

        }

    }

echo "</div>";

} 
```

如果我想以 5 秒的间隔在名为“content_data”的 DIV 中检索此信息，那么 jquery/ajax 代码应该是什么？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:09:03.520

您可以将 lastCodes() 函数的内容放在一个空的 PHP 文件中，我们称之为 lastCodes.php。

然后在要检索数据的页面上使用 JQuery 的加载功能

```
<div id="divTarget"></div>
<script type="text/javascript">
    $("#divTarget").load("lastCodes.php");
</script> 
```

但请记住，这种编码方式很快就会变得一团糟。我建议您尝试许多可用的出色模板系统中的任何一个。干净的代码不是必需的，但没有它，您将需要一些纪律，将逻辑排除在您的视图代码之外。

当您对其中一个感到满意时，您可以更进一步，在前端使用 Javascript 尝试模板系统，例如 Handlebars。使用其中之一，您将能够编写干净的代码并使用 JSON 发送数据，这将降低 HTTP 响应的大小，同时使数据更适用于其他场景，而不是简单地将其呈现为 HTML。

编辑：每 5 秒更新一次数据：

```
<script type="text/javascript">
  window.setInterval(function() {    
     $("#divTarget").load("lastCodes.php");
  }, 5000);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T01:13:22.847

您只需使用 setInterval() 函数每 5 秒（5000 毫秒）加载页面内容

```
</div>

<script src="jquery.js"></script>
<script>
setInterval(function(){
   $('#container').load('page.php');
}, 5000);
</script> 
```

我可以看到你有一个函数，所以你不妨调用它。如果这不起作用，请尝试将您的代码放在函数之外。

```
lastCodes(); 
```

确保它实际上改变了它的内容并且你调用的页面确实有效，你可以通过访问页面本身来测试它，看看它是否有任何输出。

# vb.net - 使用 VB.NET 查询 MongoDB - 可空类型

> ID：11705522
> 
> 赞同：1
> 
> 时间：2012-07-28T23:38:03.043
> 
> 标签：vb.net, mongodb, nullable

根据此 Jira 票证，MongoDB C# 驱动程序支持对 Nullable(Of T) 的查询： [https ://jira.mongodb.org/browse/CSHARP-483](https://jira.mongodb.org/browse/CSHARP-483)

但是，我在让它工作时遇到问题。

```
mycol.AsQueryable.Where(Function(p) p.MyNullableInteger = 3) 
```

按照指示，我`.Value`从查询中删除了该属性，但是这破坏了严格的类型，所以我不得不删除我的`Option Strict On`子句。然后它编译成功，但理想情况下我希望该子句重新加入。

PredicateTranslator 抛出异常如下：

**不支持的 where 子句：(Boolean)(p.MyNullableInteger == (Nullable)3)**

.NET 生成的实际 Where 子句表达式是：

**p => Convert((p.MyNullableInteger == ConvertChecked(3)))**

我正在使用驱动程序 1.5。我的 POCO 类确实注册了一个类映射，但映射在这里没有引用该属性（它只是为我的 Id 属性设置从 String 到 ObjectId 的表示形式）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T15:01:18.440

原来这只是 Visual Basic 中的一个错误。它在 C# 中运行良好。我在这里创建了一个 Jira：[https](https://jira.mongodb.org/browse/CSHARP-542) ://jira.mongodb.org/browse/CSHARP-542 。

我还将编辑您的问题标签以包含 VB 而不是 c#。

# clojure - 如何使用名称作为键从一组绑定中创建映射？

> ID：11705525
> 
> 赞同：3
> 
> 时间：2012-07-28T23:38:34.417
> 
> 标签：clojure

我想要类似`{:keys [...]}`构造逆的东西：

`(let [x 1 y 2 z 3] (create-map x y z))`

...应该返回`{:x 1 :y 2 :z 3}`。

换句话说，我想避免在`{:x x :y y :z z}`.

我想要这个功能的一个例子：

```
(defn create-some-service-handle [user-id password api-key] 
    { :api-key api-key 
      :user-id user-id 
      :connection (obtain-connection user-id password) }) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-29T00:25:42.340

如果您正在寻找能够准确定位的东西`create-map`，那么您将需要一个宏，因为您需要对这些符号进行未评估。这将是一个非常简单的宏：

```
(defmacro create-map
  [& syms]
  (zipmap (map keyword syms) syms)) 
```

`map`这只是取未评估的符号，`keyword`将它们向下传递以获得关键字序列，然后`zipmap`是原始符号的键序列。由于它是一个宏，因此在此之后将评估结果形式，产生关键字到值（符号所指的值）的映射。

所以如果你去做：

```
(let [x 1 y 2 z 3] (create-map x y z)) 
```

...它将返回：

```
{:x 1 y 2 :z 3} 
```

这是你想要的？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-30T20:41:48.013

固定点：虽然您正在寻求的解决方案会起作用，但尚不清楚为什么您“要避免两次键入每个变量的名称”。如果这是“个人偏好”，那么这看起来像是对宏工具的滥用，因为与使用 {:x 1 :y 2 :z 3} 或 (hash-map :xx : yx :zx)。您似乎购买了太少的便利来换取代码的复杂性。

宏可以使您的代码更难维护（其他人可能不理解它们），引入符号捕获之类的复杂性（您的代码可能会做的不仅仅是简单的哈希映射创建）并且不能像更高的那样使用/传递-订单函数（除非你包装它们）。

摘自“Joy Of Clojure”（第 8.8 节）：“在掌握宏观的道路上，您可以学习的最重要的技能是识别何时避免使用它们的能力。一般的答案当然是无论何时，只要你可以。”

# javascript - JavaScript：XMLSerializer 对象检测 IE8 和现代浏览器

> ID：11705526
> 
> 赞同：1
> 
> 时间：2012-07-28T23:38:59.820
> 
> 标签：javascript, serialization

我正在尝试进行对象检测以防止 IE8 在没有的情况下抛出错误，`new XMLSerializer()`但是我未能找到解决问题的跨浏览器方法。我通常使用`object!='undefined'`但是我还没有找到一种跨浏览器的实现方式。

以下是我在 Firefox 10 和 IE8 中测试过的一些方法...

```
if (typeof new XMLSerializer!='undefined') {alert('unsupported, 1');}

if (typeof new XMLSerializer()!='undefined') {alert('unsupported, 2');}

if (new XMLSerializer!='undefined') {alert('unsupported, 3');}

if (XMLSerializer!='undefined') {alert('unsupported, 4');}

if (window.XMLSerializer!='undefined') {alert('unsupported, 5');}

if (typeof XMLSerializer !== 'undefined') {alert('unsupported, 6');} 
```

那么我们如何`XMLSerializer`在不支持的浏览器（例如 IE8）中实现对象检测而不触发错误呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:06:43.953

You should be testing if it has it by this:

```
if (typeof window.XMLSerializer !== 'undefined') {
    alert('Has XMLSerializer');
} else {
    alert('No has XMLSerializer');
} 
```

Here's a fiddle demonstrating: [http://jsfiddle.net/fGZbL/1/](http://jsfiddle.net/fGZbL/1/)

Or the original fiddle I posted should work too (this tests truthiness of `window.XMLSerializer`): [http://jsfiddle.net/fGZbL/](http://jsfiddle.net/fGZbL/)

# javascript - div活动状态不坚持onclick

> ID：11705527
> 
> 赞同：0
> 
> 时间：2012-07-28T23:39:01.577
> 
> 标签：javascript, jquery, html, css

我有一个 div，当单击它时，它下面的另一个 div 通过一个切换向上滑动，如果再次单击它可以向下滑动。我还想做的是向`:active`div 按钮添加一个状态，以便在切换打开的 div 时它会更改图像，但是当您单击 div 按钮时，您会快速闪烁活动状态图像，然后它会返回为默认值。由于某种原因，`:active`状态没有坚持下去，我找不到原因。

这是javascript

```
 $(function()
{

    $(".server_status_button").click(function(event) {
        event.preventDefault();

        if($(".server_status_button").is(":visible").length > 0){

            $(this).removeClass("active");
        }
        else{

            $(this).addClass("active");
        }
        $("#status1").slideToggle();

    });

    $("#status1").click(function(event) {
        event.preventDefault();
        $("#status1").slideToggle();
    });

}); 
```

这是整个事情的html

```
 <div id="server_status">
            <div class="server_status_button"></div><!---end server_status_button--->
            <div id="status1">
                <div class="status1_content" style="margin-bottom: 5px;">You are on:</div><!---end status1_content--->
                <div class="status1_content" style="font-size:12px;"><span style="font-weight: bold; font-color: #222;">Alnitak</span> - Status: <span style="color: #090;">Good</span></div><!---end status1_content--->
                <div class="status1_content"><span style="font-weight: bold; margin-bottom: 10px;">1300/10000</span> Players</div><!---end status1_content--->
                <div class="status1_content_link" onclick="location.href='servers.php';">List Servers</div><!---end status1_content--->
            </div><!---end status1--->
        </div><!---end server_status---> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:51:28.787

`:active`和添加一个类`active`是两件非常不同的事情。`:active`是在元素处于活动状态时（鼠标按下时）添加到元素的伪类。而您正在添加一个普通的 css 类`active`。您很可能有一些 CSS，例如：

`.server_status_button:active { ... }`

如果您将其更改为：

`.server_status_button.active { ... }`

那么它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:51:14.650

`:active`CSS 选择器选择当前被点击的元素以及它的所有祖先。只要按住鼠标按钮，它就会持续。您的代码正在做的是添加一个类，该类是使用`.active`CSS 中的细微差别选择的。

# c# - 按字符串（名称）按字母顺序排列对象数组

> ID：11705529
> 
> 赞同：0
> 
> 时间：2012-07-28T23:39:17.660
> 
> 标签：c#, sorting

我对编程很陌生，并且正在学习 C#。第 4 周！

编写程序要求用户输入：

*   朋友的名字
*   电话
*   出生月份
*   天
*   出生年份。

创建为对象数组并使用 IComparable 启用对象比较。需要按字符串按字母顺序对对象进行排序，我认为除了获取要比较的字符串之外，我还有所有其余的代码。这是我所拥有的`IComparable.CompareTo(Object o)`：

```
int IComparable.CompareTo(Object o)
{
    int returnVal;

    Friend temp = (Friend)o;
    if(this.Name > temp.Name)
        returnVal = 1;
    else
        if(this.Name < temp.Name)
            returnVal = -1;
        else returnVal = 0;
    return returnVal;
} 
```

我在编译时收到的错误是：

> CS0019 运算符'>' 不能应用于“字符串”和“字符串”类型的操作数。

教官帮不上什么忙，文字没有综合这种偶然性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T23:41:29.703

只需委托给`String.CompareTo`：

```
int IComparable.CompareTo(Object o) {
    Friend temp = (Friend)o;

    return this.Name.CompareTo(temp.Name);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:49:16.010

这使用了一些您可能不习惯的语言功能，但确实使您更容易一些：

```
people = people.OrderBy(person => person.Name).ToList(); 
```

像这样使用：

```
var rnd = new Random();
var people = new List<Person>();
for (int i = 0; i < 10; i++)
    people.Add(new Person { Name = rnd.Next().ToString() });

//remember, this provides an alphabetical, not numerical ordering,
//because name is a string, not numerical in this example.
people = people.OrderBy(person => person.Name).ToList();

people.ForEach(person => Console.WriteLine(person.Name));
Console.ReadLine(); 
```

Google LINQ [并记得添加'使用 System.Linq;'] 和 Lambda。

# xcode - 向 Xcode 添加 Flash 动画？

> ID：11705530
> 
> 赞同：1
> 
> 时间：2012-07-28T23:40:01.607
> 
> 标签：xcode, flash, animation

对于我的应用程序，有许多功能需要包含动画。例如，在加载 ViewController 时，我需要出现在屏幕上的图像和按钮以及在 Xcode 中无法完成的复杂动画。到目前为止，我只通过 Xcode 制作了简单的动画，例如缩小图像、移动到 CGPoint 的按钮等。简单的事情。如果我在 Adob​​e Flash 或其他动画软件中制作这些复杂的动画，是否可以将其合并到我的应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:07:23.337

根据应用程序的性质，您可以考虑使用 Flash 编写应用程序，然后使用 Adob​​e AIR 编译它以在 iPhone 和 iPad 上本地运行。最重要的是，Adobe AIR 还可以编译它以在 Android、Blackberry Playbook 以及传统的 Windows 和 Mac 上运行，因此您可以编写一次并在任何地方运行。通过这样做，您还可以利用 Flash 的动画功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:44:39.587

Apple 不支持在 iphone 或 ipad 上使用 flash。只能播放 youtube。如果您想使用任何动画制作 gif 或使用 HTML5。

# jquery - iframe + jquery + 绑定点击功能

> ID：11705532
> 
> 赞同：0
> 
> 时间：2012-07-28T23:40:24.980
> 
> 标签：jquery, html, iframe

我有一个按用户请求加载的 iframe，因此它在第一页加载时不可用。

我希望能够使用以下两种类型的代码设置事件侦听器：

```
$('iframe#joinIframe').contents().find('img#closePopUp').bind('click', function () {
    console.log('iframe baby');
}); 
```

和

```
$('iframe#joinIframe img#closePopUp').bind('click', function() {
    console.log('iframe baby');
}); 
```

但是我没有得到答复。

有没有办法加载初始页面，稍后打开 iframe 并从原始页面绑定事件 - 我想从底层页面获得一些控制/功能。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:02:44.207

尝试以下操作：

```
$(document).on('click', '#joinIframe #closePopUp', function (){
        console.log('iframe baby');
}); 
```

# facebook - Facebook 以独特的方式向非粉丝隐藏内容

> ID：11705534
> 
> 赞同：-2
> 
> 时间：2012-07-28T23:40:54.873
> 
> 标签：facebook, tabs, hide

我需要建立一个看起来像这样的标签： [https ://www.facebook.com/auto.co.il/app_134594493332806](https://www.facebook.com/auto.co.il/app_134594493332806)

我知道如何添加图像和评论框，并且我知道几种“简单”的方法可以向非粉丝隐藏内容，但是我遇到了上面的标签，我真的很喜欢它向你展示内容的方式，但你无法参与直到你按下like按钮。

请问有什么帮助吗？

提前致谢。

奥伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T04:12:08.107

您的链接对我不起作用，但您可以在其余内容上方放置一个具有高 z-index 的绝对定位 div，以防止用户点击任何内容。

**更新：**现在链接已经更新，我看到他们正在做我上面描述的事情。在 chrome 中，如果您右键单击背景并选择“检查元素”，您将看到 div 的以下计算样式：

```
rgba(0,0,0,0.796);
display:block;
height:1612px;
width:810px; 
```

内容被一个黑色背景和一些不透明度的 div 简单地涂黑。只是为了好玩，您可以通过 chrome 的 JS 控制台通过选择 iframe 上下文然后输入以下内容来克服他们的喜欢门（不喜欢）：

`$('.like_float_c').detach();`

...现在称自己为“黑客”；）

# javascript - 围绕 Web 存储的 Javascript API 包装器？

> ID：11705541
> 
> 赞同：8
> 
> 时间：2012-07-28T23:42:11.203
> 
> 标签：javascript, web-sql, indexeddb, web-storage

[在各种可用的 Web 存储系统](http://csimms.botonomy.com/2011/05/html5-storage-wars-localstorage-vs-indexeddb-vs-web-sql.html)上是否有像包装 API 抽象这样的跨浏览器 jquery ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-29T05:24:51.783

localStorage（又名“网络存储”）无法与 Web SQL 或 IndexedDB 相比，因为它在空间上受到严格限制并且是同步的（阅读：冻结浏览器的 UI，因为它确实很糟糕）。因此，我在其余帖子中忽略了 localStorage。但是如果你只需要一点存储空间，你可以直接使用 localStorage，因为它得到了相当广泛的支持，或者像其他帖子建议的那样使用草地椅，这得到了更广泛的支持。

所以我们只剩下 Web SQL 和 IndexedDB。无论好坏，Web SQL 都是一种死胡同。没有人在研究规范，没有人在研究新的实现。IE 和 Firefox 永远不会支持它，并且它在其他浏览器中已被弃用，最终可能会被删除。但是目前有一些浏览器支持它（Chrome、Opera、Safari），所以理论上它可以在库中使用，如果其他不支持 Web SQL 的浏览器有替代方案的话。

不幸的是，IndexedDB 在浏览器中没有得到很好的支持。Firefox 有很好的实现；Chrome 有点落后，但正在迎头赶上。您可以使用[这个 IndexedDB Polyfill](http://nparashuram.com/IndexedDBShim/)在任何支持 Web SQL 的浏览器中获得 IndexedDB 支持，理论上应该涵盖除 IE 之外的所有最近/流行的浏览器。

啊，IE。它总是归结为 IE，不是吗？事实上，在 IE 中没有像 IndexedDB 或 Web SQL 这样的本地存储的合理方法。IE 10 将支持 IndexedDB。每当人们停止使用 IE 9 及更低版本时，IndexedDB 可能会在所有其他浏览器中获得极好的支持，因此您将能够使用 IndexedDB API 或在它之上的一些库。在那之前……好吧，你运气不好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-19T02:06:17.803

**支持多种存储实现的包装器**

[袋装数据库](https://github.com/pouchdb/pouchdb)

[本地饲料](https://github.com/mozilla/localForage)

[草坪椅](http://brian.io/lawnchair/)

[YDN-数据库](https://bitbucket.org/ytkyaw/ydn-db/wiki/Home)

**基于 WebSQL 的 IndexedDB polyfill**

[索引数据库垫片](https://github.com/axemclion/IndexedDBShim)

[IndexedDB Polyfill](https://github.com/facebookarchive/IndexedDB-polyfill/)

如果您只想存储少量数据，任何这些或更简单的仅用于 Web 存储的包装器就足够了。如果您需要更多存储空间，则需要放弃 Web 存储的想法并使用 indexedDB polyfill。但是这种 polyfills 的缺点是索引可能并不总是很好地工作，尤其是在使用多个索引时，并且在没有原生 indexedDB (iOS) 的移动浏览器中性能可能会很差。如果索引很重要，Pouch DB 看起来是一个很好的解决方案，它的二级索引。如果 iOS 不是目标，您可以继续使用本机索引数据库，因为它在苹果园之外的[几乎所有其他地方都受支持。](http://caniuse.com/indexeddb)

* * *

## 网络存储

**模式：** 键值对 **大小：** 2.5MB – 5MB **可扩展性：** 大型/复杂数据的 性能不佳 搜索**：**没有索引或其他方式的搜索性能不佳 **索引：** 没有可用的索引 **兼容性：** 在包括移动浏览器在内的所有现代浏览器中 均受支持**未来证明：** 支持应该保持很长时间。该规范与 w3c 是分开的，并且作为自己的规范存在。W3c 可能会用索引数据库做所有事情

* * *

## WebSQL

**模式：** 关系数据库 **大小：** 默认 ~5MB 要求用户扩展至 10、50、100、500 MB **可扩展性：** 使用关系数据库概念，因此可以很好地扩展。与 Web 存储相比，大数据的性能良好。 **搜索：** RDBMS 中的索引具有良好的搜索性能。 **索引：** RDBMS 中可用的索引 **兼容性：** 支持基于 webkit 的浏览器，包括 Chrome、Safari 和 iOS Safari 等移动浏览器。Microsoft 和 Firefox 不支持，并决定从不支持，因为规范依赖于非标准 SQL lite。同时，Web SQL 恰好是 iOS 设备和 Safari 中唯一可用的可扩展解决方案。 **未来证明：** Web SQL 不是面向未来的。自 2011 年起，该规范不再被维护和弃用。此外，除了 Apple 之外的大多数供应商已经开始转向索引数据库。

* * *

## 索引数据库

**模式：** 索引表系统 **大小：** 默认 ~5-50MB 要求用户扩展。 **可扩展性：** 每个数据库可以有尽可能多的数据库和存储。可以轻松缩放。 **搜索：**基于索引的技术具有非常好的搜索性能。 **索引：** 基于索引进行设计。 **兼容性：** 在 Chrome、Firefox、IE 10 等现代浏览器中受支持。缺少的供应商只是苹果。Apple 仍然没有在 Safari 和 iOS Safari 上实现索引数据库。 **未来证明：** 索引数据库规范是专为客户端存储设计的 Web 持久性的当前方向。这应该很快就会淘汰 Web SQL 和本地存储，因为它具有这两个规范的强大功能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-19T04:28:34.797

[Store.js](https://github.com/marcuswestin/store.js)应该适合你。它在可用的地方使用 localStorage。对于 IE6 和 IE7 它，使用 userData 行为。

它的 API 很好很简单：

```
store.set('myage', 24)
store.get('myage') === 24 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-28T23:53:22.953

有草坪椅......我已经建议过几次但没有长时间使用它：

[http://brian.io/lawnchair/](http://brian.io/lawnchair/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-20T06:10:00.287

有，[YDN-DB](https://bitbucket.org/ytkyaw/ydn-db)，它为 IndexedDB、WebSQL 和 localStorage 提供跨浏览器 API。它也有 JQuery 插件。

# javascript - 动态接收时无法解析Json（使用socket.io）

> ID：11705542
> 
> 赞同：1
> 
> 时间：2012-07-28T23:42:54.950
> 
> 标签：javascript, jquery, json, socket.io

我正在接收 json-datas，它是 100% 正确格式化的 json 数据。

我的问题是，

当我运行以下代码时，它可以工作：

```
var data = {"datas":[{"matts":{"active":"1","status":"off"},"config":null,"adapters":[]}}]};

console.dir(data); // it works. 
```

但是当我在 socket.io 上收到与以下代码相同的数据时，它不起作用：

```
_liveSock.on('sm', function(data)
{
    console.log(data); // I am receiving the data correctly. 
    console.dir(data); // But I cant display the data.
}); 
```

两个代码几乎是相同的逻辑，只有第二个是动态接收的。

当我尝试使用 console.dir(data); 在第二个代码上，它给出了这个错误：

```
there is no kind object 
```

（顺便说一句。我正在使用 Firefox/Firebug）

是否有另一种方法或方式来使用动态接收的 json 数据？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T23:49:50.593

**在解析**值`console.dir()`之前，您不能使用。

 **```
console.dir(JSON.parse(data)); 
```

该`JSON`工具在旧版浏览器中不可用。[您可以在线](http://json.org)找到解析器。**

# python - 从 Python 中的字符串列表处理函数

> ID：11705546
> 
> 赞同：5
> 
> 时间：2012-07-28T23:43:27.900
> 
> 标签：python, string, function, exec

我有一个模块，我将它导入到名为 pageprocs.py 的主应用程序中，其中包含一组函数，这些函数生成不同的内容并以字符串的形式返回。pageprocs 应该是一种允许经过身份验证的用户为不同的内容类型创建插件的方法。

然后我有一个字符串列表： ['check_stats', 'build_table', 'build_ace'] 这是 pageprocs 中某些函数的名称。我需要按照它们在列表中的顺序执行函数，并且在不使用 exec() 的情况下找不到执行此操作的方法：

```
for i in list_of_funcs:
    exec('pageprocs.%s()' % i) 
```

这对我来说似乎是一个非常糟糕的主意，并且不容易在用户代码中捕获任何异常。有没有以这种方式运行代码的替代方法，或者是否有人对用户定义的内容生成有建议（我问这个是因为我可能错误地处理了整个情况）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-28T23:46:33.507

```
for i in list_of_stats:
    getattr(pageprocs, i, lambda: None)() 
```

该`lambda: None`部分是可选的，但`AttributeError`如果指定的函数不存在（它是一个匿名的无操作函数），将阻止被引发。

# arrays - Perl循环遍历单个元素的数组哈希

> ID：11705547
> 
> 赞同：3
> 
> 时间：2012-07-28T23:43:32.577
> 
> 标签：arrays, perl, loops, hash

我有一个数组哈希，如图所示：

```
my %hash = (
  234 => ["aa", "bb", "aa", "ab", "aa"],
  235 => ["aa", "ab", "aa", "bb", "aa"],
  236 => ["bb", "aa", "aa", "aa", "bb"],
  ...
) 
```

我正在尝试遍历每个值的第一个元素并计算`bb`.

例如，在上面的哈希中，我对`bb`显示的所有第一个元素都出现了一次。我需要将该数字（所有数组的第 0 个元素中的“bb”数）推入一个新数组，然后移动到下一组元素。

对于上面的示例，我将遍历数组的所有 4 个元素并获得一个带有`(1, 1, 0, 1, 1)`.

我在正确编写代码时遇到了很多麻烦，还没有找到类似的问题。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T00:02:23.070

一个简单的解决方案：迭代哈希值。对于每个值，遍历数组的成员并在需要时将 1 添加到结果数组：

```
#!/usr/bin/perl
use warnings;
use strict;

my %hash = (234 => [qw/aa bb aa ab aa/],
            235 => [qw/aa ab aa bb aa/],
            236 => [qw/bb aa aa aa bb/],
           );

my @result;

for my $value (values %hash) {
    my $i = 0;
    for (@$value) {
        $result[$i++] += 'bb' eq $_;
    }
}

print "@result\n"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T05:31:35.183

[`grep`运算符](http://perldoc.perl.org/functions/grep.html)是计算列表中符合特定条件的值的最佳工具。只需遍历哈希值列表的每个条目即可获得每个元素的计数。

此代码假定每个哈希值数组具有相同的长度，并使用第一个元素的长度作为所有它们的大小。

```
use strict;
use warnings;

my %data = (
  234 => [ qw/aa bb aa ab aa/ ],
  235 => [ qw/aa ab aa bb aa/ ],
  236 => [ qw/bb aa aa aa bb/ ],
);

my @count_bb;
for my $i ( 0 .. $#{(values %data)[0]} ) {
  $count_bb[$i] = grep { $_->[$i] eq 'bb' } values %data;
} 

print "@count_bb\n"; 
```

**输出**

```
1 1 0 1 1 
```

此替代方法将创建一个散列，其中包含散列值数组中*每个不同值的计数。*第一步初始化散列以在每个元素中具有正确数量的零，第二步增加数据中遇到的每个值的计数，最后循环打印结果`%counts`散列的内容。

```
use strict;
use warnings;

my %data = (
  234 => [ qw/aa bb aa ab aa/ ],
  235 => [ qw/aa ab aa bb aa/ ],
  236 => [ qw/bb aa aa aa bb/ ],
);

my %counts;
$counts{$_} = [ (0) x @{(values %data)[0]} ] for map @$_, values %data;

for my $i ( 0 .. $#{(values %data)[0]} ) {
  $counts{$_}[$i]++ for map $_->[$i], values %data;
} 

while (my ($k, $v) = each %counts) {
    printf "%s => (%s)\n", $k, join ', ', @$v;
} 
```

**输出**

```
ab => (0, 1, 0, 1, 0)
bb => (1, 1, 0, 1, 1)
aa => (2, 1, 3, 1, 2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T02:58:26.363

```
use Data::Dumper;

%hash = (234 => [aa, bb, aa, ab, aa],
         235 => [aa, ab, aa, bb, aa],
         236 => [bb, aa, aa, aa, bb],
        );

do { $i = 0; $element{$i++}->{$_}++ for @{$_}; } for (values %hash);

print Dumper(\%element); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-29T04:43:28.140

这是一种更加 perl-ish（不一定更好）的做事方式。除非那些维护代码的人非常了解 perl，否则它会不太清楚。尽管如此，学习 map 和 grep 并不是一个坏主意。一旦你熟悉了它们，它们可以帮助你的代码的意图更加清晰。我建议查看每个解决方案并尝试弄清楚每个解决方案的工作原理。

此解决方案将处理太短的数组，尽管这可能是也可能不是您正在寻找的内容，具体取决于应用程序。

```
use warnings;
use strict;

use Data::Dumper;

my %hash = (
    '234' => [qw(aa bb aa ab aa)],
    '235' => [qw(aa ab aa bb aa)],
    '236' => [qw(bb aa aa aa bb)],
);

my @result = ();

while ( grep {scalar @{$_}} values %hash ) {
    push @result, scalar @{[
        grep {$_ eq 'bb'}
            map {shift @{$_}}
                values %hash
    ]};
}

print Dumper \@result; 
```

# vim - 使用 Intel Fortran 使用 vim 制作

> ID：11705554
> 
> 赞同：1
> 
> 时间：2012-07-28T23:44:07.927
> 
> 标签：vim, makefile, fortran, debian

我有一个 Fortran 项目，我使用 gvim 作为我的编辑器。当我在 makefile 中使用 gfortran 作为编译器时，我没有遇到任何问题。我还有一个使用 intel fortran 的 makefile 版本，并且从终端调用时该 makefile 也可以正常工作。

我的问题在 gvim 内。我的 makefile 的 Gfortran 版本在 vim 中使用 :make 调用时效果很好，它向我显示错误并跳转到它们等。但是，当我使用 ifort 版本时，vim 中的 :make 命令给我一个错误，说他找不到 ifort .

ifort 在终端上运行良好。我对 ~/.bashrc 和 /etc/bash.bashrc 都进行了编辑，以便它获取英特尔编译器的来源。我使用 Crunchbang Waldorf（阅读：Debian 测试），我记得在 LMDE 中遇到过同样的问题。

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T14:13:13.983

将 PATH 修改从`.bashrc`/移动`/etc/bash/bashrc`到`.profile`/ `/etc/profile`。这样你就不需要像@ib 这样的交互式 shell。建议（顺便说一下，您只需要修改一个文件，而不是两个）。

如果您的发行版使用`/etc/env.d`它可能是有意义的

```
echo 'PATH=/path/to/ifc/binaries' >> /etc/env.d/99ifort
env-update 
```

. 但这应该是特定于发行版的。

# php - 如何在 cakePHP 中进行查询连接？

> ID：11705557
> 
> 赞同：0
> 
> 时间：2012-07-28T23:44:33.183
> 
> 标签：php, join, model, cakephp-2.1

我只是想问一下如何按照这个 SQL 语法在 CakePHP 中进行查询连接

```
SELECT a.id, SUM( r.jumlah_realisasi) AS jumlah_realisasi, SUM(b.jumlah_budget) AS jumlah_budget, SUM(c.jumlah_contrapos)
FROM accountposts a
LEFT JOIN
(
SELECT accountpost_id, agency_id, SUM(budget_after_changes) AS jumlah_budget
FROM budgets
GROUP BY accountpost_id
) b
ON a.id = b.accountpost_id
LEFT JOIN
(
SELECT accountpost_id, agency_id, SUM(realisation_value) AS jumlah_realisasi
FROM realisations
GROUP BY accountpost_id
) r
ON a.id = r.accountpost_id
LEFT JOIN
(
SELECT accountpost_id, agency_id, SUM(contrapos_value) AS jumlah_contrapos
FROM contraposts
GROUP BY accountpost_id
) c
ON a.id = c.accountpost_id
GROUP BY
a.id 
```

我尝试了这种语法（我使用的是 CakePHP 2.x）：

```
$joins = array(
               array(
                  'table' => 'budgets',
                  'alias' => 'Budget',
                  'type' => 'LEFT',
                  'conditions' => array('Accountpost.id = Budget.accountpost_id')
                ),
                array(
                  'table' => 'realisations',
                  'alias' => 'Realisation',
                  'type' => 'LEFT',
                  'conditions' => array('Accountpost.id = Realisation.accountpost_id')
                ),
                array(
                   'table' => 'contraposts',
                   'alias' => 'Contrapost',
                   'type' => 'LEFT',
                   'conditions' => array('Accountpost.id = Contrapost.accountpost_id')
                ),
         );

        $this->paginate = array(
            'limit' => 60,
            'joins' => $joins,
            'fields' => array('Accountpost.id','Accountpost.explanation','Accountpost.account_code',
                              'SUM(Budget.budget_after_changes) AS jumlah_budget','SUM(Realisation.realisation_value) AS jumlah_realisasi','SUM(Contrapost.contrapos_value) AS jumlah_contrapos'),
            'group' => array('Accountpost.id'),
            'order' => array('Accountpost.id' => 'ASC'),
        ); 
```

这是来自 CakePHP 的 SQL 转储：

```
SELECT `Accountpost`.`id`, `Accountpost`.`explanation`, `Accountpost`.`account_code`, SUM(`Budget`.`budget_after_changes`), `Budget`.`budget_after_changes`, `Realisation`.`realisation_value`, `Contrapost`.`contrapos_value` FROM `realisasi_anggaran`.`accountposts` AS `Accountpost` LEFT JOIN `realisasi_anggaran`.`budgets` AS `Budget` ON (`Accountpost`.`id` = `Budget`.`accountpost_id`) LEFT JOIN `realisasi_anggaran`.`realisations` AS `Realisation` ON (`Accountpost`.`id` = `Realisation`.`accountpost_id`) LEFT JOIN `realisasi_anggaran`.`contraposts` AS `Contrapost` ON (`Accountpost`.`id` = `Contrapost`.`accountpost_id`) WHERE 1 = 1 GROUP BY `Accountpost`.`id` ORDER BY `Accountpost`.`id` ASC LIMIT 60 
```

但是 SQL 语法版本和 CakePHP 版本的结果不同，SQL 语法在检查 SUM 时没有重复值，但在 CakePHP 版本中，检查 SUM 时有重复值。如何以正确的方式实现我的 SQL 语法到 cakePHP？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T13:26:30.057

您的`$options`数组构造不正确。这样，数组就有了两个嵌套的命名键`joins`，Cake 不会构造正确的 SQL 连接。

数组应如下所示：

```
$joins = array(
  array(
    'table' => 'budgets',
    'alias' => 'Budget',
    'type' => 'LEFT',
    'conditions' => array('Accountpost.id = Budget.accountpost_id')
  )
);

$this->paginate = array(
  'limit' => 60,
  'joins' => $joins,
  'fields' => array('Accountpost.id','Accountpost.explanation','Accountpost.account_code',
                                  'SUM(Budget.budget_after_changes) AS jumlah_budget'),
  'group' => array('Accountpost.id'),
  'order' => array('Accountpost.id' => 'ASC'),
); 
```

或者构造如下：

```
$options = array(
  'limit' => 60,
  'fields' => array('Accountpost.id','Accountpost.explanation','Accountpost.account_code',
                                  'SUM(Budget.budget_after_changes) AS jumlah_budget'),
  'group' => array('Accountpost.id'),
  'order' => array('Accountpost.id' => 'ASC'),
);

$options['joins'] = array(
  array(
    'table' => 'budgets',
    'alias' => 'Budget',
    'type' => 'LEFT',
    'conditions' => array('Accountpost.id = Budget.accountpost_id')
  )
);

$this->paginate = $options; 
```

# hadoop - Hive over HBase vs Hive over HDFS

> ID：11705562
> 
> 赞同：2
> 
> 时间：2012-07-28T23:45:14.507
> 
> 标签：hadoop, mapreduce, hbase, hive

我的数据不需要实时加载，所以我不必使用 HBASE，但我想知道在 MR Jobs 中使用 HBASE 是否有任何性能优势，由于索引数据，连接不应该更快吗？

有人有任何基准吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:37:04.357

一般来说，hive/hdfs 会比 HBase 快很多。HBase 位于 HDFS 之上，因此它增加了另一层。如果您正在查找单个记录，HBase 会更快，但您不会为此使用 MR 作业。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-24T14:58:21.450

HBase 与 Hive 的性能：

基于 HBase、Hive 和 Hive on Hbase 的结果：看起来两种方法之间的性能相当。

[Hive 上的 HBase 性能](https://web.archive.org/web/20140609114243/http://hadoopstack.com/hive-on-hbase-part-1/ "来自 Wayback Machine 的缓存文章")

![在此处输入图像描述](../Images/4f3d5f48abfbe29741b9da08b01795e3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T04:01:18.470

尊敬的 :) 我想告诉您，如果您的数据不是真实的，并且您也在考虑使用 mapreduce 作业，那么只能通过 hdfs 进行配置，因为 Weblog 可以由 Hadoop MapReduce 程序处理并存储在 HDFS 中。同时，Hive支持HDFS位置数据的快速读取、基础SQL、join、批量数据加载到Hive数据库。
由于 hive 还为我们提供
批量处理/实时（如果可能）
以及类似 SQL 的接口
内置优化的 map-reduce
大数据分区，与 hdfs 更兼容，有助于减少 HBase 层，否则如果您在此处添加 HBase那么这对您来说将是多余的功能:)

# python - 在 python 中处理 Utf-8 数据

> ID：11705563
> 
> 赞同：2
> 
> 时间：2012-07-28T23:45:51.243
> 
> 标签：python, utf-8, ascii

我正在使用 python 模块`requests`从一些 API 获取数据，它们都返回 json 数据，这些数据被转换为 dicts。我想要做的是从这些 dicts 中获取一些信息，然后将它们全部转换为 python 字符串，我可以在其中使用`stemming`and`string.translate()`模块，或者将整个内容转换为这些模块可识别的数据。我不能用 UTF-8 数据做到这一点，而且它正在我的头脑中。有什么解决方案吗？我可以遍历字典并将其转换为 ASCII 吗？

奇怪的是，我正在将 ASCII 字符串与其他函数中的 UTF 数据进行比较`(if ASCII-word is in UTF dict: do something)`，并且效果很好。ASCII 值始终与 UTF-8 数据匹配。我根本无法理解这些编码的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T23:52:06.873

UTF-8 是 ASCII 的扩展，因为有效的 7 位 ASCII 文本也是有效的 UTF-8 文本，所以如果所有数据实际上都可以用 ASCII 表示，那么无论是 ASCII 还是 UTF-8 都没有任何区别。

如果传入的数据是 UTF-8 编码的，最好的方法是将其解码为 un​​icode 对象。例如，如果您从某个来源读取字符串并将其存储在变量`utf8str`中，您可以这样做`utf8str.decode('utf-8')`。然后传递这个 unicode 对象并对 unicode 对象执行所有操作。而不是`string.translate`你可以使用`unicode.translate`（假设你指的是那里称为“翻译”的字符串方法）。

如果您的模块无法处理 unicode 字符串，您需要考虑如何处理它。如果您的输入包含无法用 ASCII 表示的字符，您必须决定该怎么做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T23:51:10.880

当您确定该函数不支持 Unicode 时，您始终可以转换为 ASCII 近似值：

```
ascii_string = unicodedata.normalize('NFKD', unicode_string).encode('ascii','ignore') 
```

# javascript - 元素事件处理程序进入 EXT.js 面板

> ID：11705564
> 
> 赞同：0
> 
> 时间：2012-07-28T23:46:00.860
> 
> 标签：javascript, extjs

在我的应用程序中，我需要一个具有 HTML 元素的面板，例如单选按钮和复选框。

对于使用 EXT 面板包装元素（单选按钮等），我将这些元素放入一个变量中，并将此变量放入 EXT 面板的 HTML 功能中。

**代码**

```
var p = new Ext.Panel({
    title: 'OptionsPanel',
    collapsible:true,
    preventBodyReset: true,
    renderTo: 'options',
    width:400,
    html: html.join('')
});
var html = [
'<ul id="controlToggle">',
'<li>',
        '<input type="radio" name="type" value="none" id="noneToggle" class="toggle"  checked="checked"  >',
        '<label for="noneToggle">navigate</label>',
    '</li>',

    '<li>',
        '<input type="radio" name="type" value="polygon" id="polygonToggle" class="toggle"  >',
        '<label for="polygonToggle">draw polygon</label>',
    '</li>',

    '<li>',
        '<input type="radio" name="type" value="modify" id="modifyToggle" class="toggle"  >',
        '<label for="modifyToggle">modify feature</label>',
    '</li>',
        '<ul>',
            '<li>',
                '<input id="createVertices" type="checkbox" checked="" name="createVertices" class="update">',
                '<label for="createVertices">allow vertices creation</label>',
            '</li>',
            '<li>',
                '<input id="rotate" type="checkbox" name="rotate" class="update">',
                '<label for="rotate">allow rotation</label>',
            '</li>',
            '<li>',
                '<input id="resize" type="checkbox" name="resize" class="update">',
                '<label for="resize">allow resizing</label>',
                '(<input id="keepAspectRatio" type="checkbox" name="keepAspectRatio" class="update" checked="checked">',
                '<label for="keepAspectRatio">keep aspect ratio</label>)',
            '</li>',
            '<li>',
                '<input id="drag" type="checkbox" name="drag" class="update">',
                '<label for="drag">allow dragging</label>',
            '</li>',
        '</ul>',
    '</li>',
    '</ul>'
]; 
```

我在 EXT 面板中使用这个 HTML 元素控制我的地图行为。出于这个原因，当用户单击单选按钮时，我使用 jQuery 来了解它被单击了。

**jQuery**

```
$(".toggle").click(function(){
    for(key in controls) {
        var control = controls[key];
        if($(this).val() == key && $(this).is(":checked")) {
            control.activate();
        } else {
            control.deactivate();
        }
    }
}); 
```

但是 jQuery 无法选择切换类，因为它位于 EXT 面板中的 Javascript 变量中。

我的问题是，如何将 Javascript 变量中的 HTML 元素选择到 EXT 面板中？换句话说，我如何使用事件处理程序将 HTML 元素放入 EXT 面板。

处理函数在 Javascript 代码中定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T23:58:33.153

需要考虑的几件事：

1.  为什么不使用 ExtJs 视觉元素，例如 Ext.form.field.Radio [http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.field.Radio](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.field.Radio)和 Ext。 form.field.Checkbox [http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.field.Checkbox](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.field.Checkbox)

2.  如果你真的想在 ExtJs 中使用纯 HTML 元素 - 那也很好。但是为了订阅他们的事件，您实际上需要等到它们被渲染。因此，您首先需要订阅`render`面板的事件。并在处理程序中找到 HTML 元素（通过它们的 Id 或任何类型）并将侦听器添加到它们的事件中。但我建议选择#1。

# perl - 有人可以解释这里的实际错误是什么以及如何解决它吗？

> ID：11705565
> 
> 赞同：2
> 
> 时间：2012-07-28T22:08:25.650
> 
> 标签：perl, hash, loops

我正在尝试在嵌套的 for/foreach 循环中使用哈希。[见来源](http://pastebin.com/KYQmLaPD)

用`strict`它说

```
Global symbol "$mapping" requires explicit package name at ./test2.pl line 39\. 
Execution of ./test2.pl aborted due to compilation errors. 
```

没有`strict`，

```
Use of uninitialized value $mapping in hash element at ./test2.pl line 46, <$fh> line 8\. 
Use of uninitialized value in concatenation (.) or string at ./test2.pl line 46, <$fh> line 8. 
```

`print $hashref->{$mapping}`输出中为空。

错误是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-29T00:41:58.483

您正在尝试使用一个`$mapping`不存在的名为的变量。有一个被称为`%mapping`有一个元素被称为`$mapping{$outlook}`但`$mapping`如果它存在将是一个不相关的标量，而不是散列的一部分。

看起来你应该使用`$hashref->{$mapping{$outlook}}`

# entity-framework - 使用条目 ().CurrentValues.SetValues() 不更新集合

> ID：11705569
> 
> 赞同：25
> 
> 时间：2012-07-28T23:46:50.263
> 
> 标签：entity-framework, entity-framework-4.1

我以前没有遇到过这种情况，因为我通常由他们自己处理集合，而不是直接在实体上修改它们。

```
public class Schedule: BaseEntity
        {
            public Guid Id {get;set;}
            public virtual int? DayOfTheWeekTypeId { get; set; }
            public virtual DayOfTheWeekType DayOfTheWeekType { get; set; }
            public virtual ICollection<Instructor> Instructors { get; set; }
            public DateTime? StartDateTime { get; set; }
            public DateTime? EndDateTime { get; set; }
            public string SpecialInstructions { get; set; }
        } 
```

映射类：

```
 public ScheduleMapping()
            {
                HasMany(c => c.Instructors).WithMany().Map(m => { m.MapLeftKey("ScheduleId");
m.MapRightKey("InstructorId"); 
m.ToTable("Schedule_Instructors");
                });
                HasOptional(s => s.DayOfTheWeekType).WithMany().HasForeignKey(s => s.DayOfTheWeekTypeId).WillCascadeOnDelete(false);
                Property(s => s.SpecialInstructions).IsMaxLength();
            } 
```

这是我的更新方法：

```
public virtual void Update(TEntity entity)
        {
            if (entity == null)
                throw new ArgumentNullException("entity");
            //this is the original persisted entity
            var persistedEntity = _repository.GetById(entity.Id);
            if(originalEntity != null)
            {
                entity.Id = persistedEntity.Id;                
                UnitOfWork.ApplyCurrentValues<TEntity>(originalEntity,entity);
                UnitOfWork.Commit();
            }
        } 
```

这是处理“合并”的方法

```
public void ApplyCurrentValues<TEntity>(TEntity original, TEntity current) where TEntity : class
        {
            base.Entry<TEntity>(original).CurrentValues.SetValues(current);
        } 
```

如果我修改 Instructors 集合然后尝试应用更新，它似乎保留了我的原始值。我曾尝试在更新之前加载 Schedule 实体并进行更改，但有时这会导致实体框架中的 PK 错误（在 Instructors 集合上）。好像它正在尝试添加具有相同键的实体。因此，我改为手动重建 Schedule 实体（包括 ID），然后对其进行更新。但是，当我这样做时，我不会再收到任何错误，Instructors 集合不会改变。我在想是因为 CurrentValues。SetValues 是基于持久化实体而不是我的更新版本应用的。我应该以不同的方式处理我的更新还是我需要手动

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-29T16:18:50.290

`SetValues`从不更新导航属性。当您执行代码时，它只知道传递给您的`Update`方法的实体的简单/复杂属性的变化。EF 甚至不知道传递给您的`Update`方法的实体的相关实体。

您必须手动告诉 EF 您的对象图中的每个更改 - EF 没有对象图的任何[解析机制](https://stackoverflow.com/questions/3635071/update-relationships-when-saving-changes-of-ef4-poco-objects/3635326#3635326)。

# ios - 使用 NSMutableString 和 stringByReplacingOccurrencesOfString 时出现不兼容的指针类型错误

> ID：11705570
> 
> 赞同：0
> 
> 时间：2012-07-28T23:46:50.860
> 
> 标签：ios

下面显示的代码的目的是从文本字段中获取一个字符串并删除逗号和左括号，以准备将内容转换为浮点数。例如，它采用数字 1,234,567 并将其更改为 1234567。

代码片段有效，但返回信息错误“不兼容的指针类型分配给 NSMutableString * from String *”

当我使用 NSString 而不是 NSMutableString 时，我没有收到任何错误，但返回的值是一个空字符串。

使用 NSMutableString 方法，有什么问题以及如何更改它以消除“不兼容的指针类型”错误。

```
NSMutableString *cleanedDataCellTest = [[NSMutableString alloc] initWithString:datacellR2C2.text];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@"," withString:@""];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@")" withString:@""];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@"(" withString:@"-"];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@" " withString:@""]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T00:43:55.813

是NSString的`stringByReplacingOccurrencesOfString`一个方法，返回值也是一个NSString。因此，您不能将返回值分配给`NSMutableString`变量。

相反，您可以使用以下方法`replaceOccurrencesOfString:withString:options:range:`：`NSMutableString`

```
NSMutableString *cleanedDataCellTest = [[NSMutableString alloc] initWithString:@"1,234,567"];
[cleanedDataCellTest replaceOccurrencesOfString:@"," withString:@"" options:0 range:NSMakeRange(0, cleanedDataCellTest.length)];
[cleanedDataCellTest replaceOccurrencesOfString:@")" withString:@"" options:0 range:NSMakeRange(0, cleanedDataCellTest.length)];
[cleanedDataCellTest replaceOccurrencesOfString:@"(" withString:@"-" options:0 range:NSMakeRange(0, cleanedDataCellTest.length)];
[cleanedDataCellTest replaceOccurrencesOfString:@" " withString:@"" options:0 range:NSMakeRange(0, cleanedDataCellTest.length)]; 
```

~~但是，出于性能的考虑，我认为使用 NSString 及其方法`stringByReplacingOccurrencesOfString`更有效。~~

**更新：** 对不起，昨天我没有测试“性能”。我刚才做了一个测试，通过替换字符串中的一些东西（大约 26KB），使用 NSMutableString**更有效**`replaceOccurrencesOfString:withString:options:range:`一点。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T00:06:15.690

```
NSMutableString *cleanedDataCellTest = [[NSMutableString alloc] initWithString:datacellR2C2.text];
[cleanedDataCellTest replaceOccurrencesOfString:@"," withString:@"" options:0 range:NSMakeRange(0, cleanedDataCellTest.length)]; 
```

参考：[https ://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsmutablestring_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableString/replaceOccurrencesOfString:withString:options ：范围](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsmutablestring_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableString/replaceOccurrencesOfString:withString:options:range)：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T00:09:44.713

切换到 NSString 对我有用...：

```
NSString *cleanedDataCellTest = [[NSString alloc] initWithString:@"1,234,098"];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@"," withString:@""];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@")" withString:@""];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@"(" withString:@"-"];
cleanedDataCellTest =  [cleanedDataCellTest stringByReplacingOccurrencesOfString:@" " withString:@""];
NSLog(@"cleanedDataCellTest = %@", cleanedDataCellTest); 
```

显示：

```
cleanedDataCellTest = 1234098 
```**

# html5-canvas - 使用表面法线的正交 3D 背面剔除

> ID：11705572
> 
> 赞同：1
> 
> 时间：2012-07-28T23:47:55.213
> 
> 标签：html5-canvas, webgl, linear-algebra, culling, 3d-rendering

我正在创建一个 HTML5 画布 3D 渲染器，我想说没有 SO 的帮助我已经走了很远，但我遇到了各种各样的阻碍。我正在尝试借助一些法线计算在立方体上实现背面剔除。此外，我已将其标记为 WebGL，因为这是一个足够普遍的问题，它既适用于我的用例，也适用于 3D 加速的用例。

无论如何，当我旋转立方体时，我发现隐藏了错误的面孔。例子：

![立方体的背面剔除问题](../Images/310edb263c82827698210bb6e263d299.png)

我正在使用以下顶点： [https ://developer.mozilla.org/en/WebGL/Creating_3D_objects_using_WebGL#Define_the_positions_of_the_cube%27s_vertices](https://developer.mozilla.org/en/WebGL/Creating_3D_objects_using_WebGL#Define_the_positions_of_the_cube%27s_vertices)

我使用的一般程序是：

1.  创建一个变换矩阵，用来变换立方体的顶点

2.  对于每个面，以及每个面上的每个点，我将它们转换为 vec3，然后将它们乘以在步骤 1 中生成的矩阵。

3.  然后我使用 Newell 的方法获得面部的表面法线，然后从该法线和一些组成的 vec3 中获得点积，例如 [-1, 1, 1]，因为我想不出一个好的值放在这里。我见过一些人为此使用相机的位置，但是......

4.  跳过使用相机矩阵的通常步骤，我从结果向量中提取 x 和 y 值以发送到我的线和面渲染器，但前提是它们的点积大于 0。我意识到我是相当随意的拉，真的。

我想知道两件事；如果我在步骤 3 中的程序是正确的（很可能不是），并且我在脸上绘制的点的顺序不正确（很可能）。如果后者是真的，我不太确定如何可视化问题。我见过人们说法线无关紧要，它是画线的方向，但是……我很难理解这一点，或者这是否是我问题的根源。

可能没关系，但我使用的矩阵库是gl-matrix：

[https://github.com/toji/gl-matrix](https://github.com/toji/gl-matrix)

此外，我正在使用的开源代码库中的特定文件在这里：

[http://code.google.com/p/nanoblok/source/browse/nb11/app/render.js](http://code.google.com/p/nanoblok/source/browse/nb11/app/render.js)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:36:33.323

我还没有审查过你的整个系统，但是“组成的 vec3”不应该是任意的；它应该是“屏幕外”向量，（因为您的投影是 ⟨<em>x, *y* , *z* ⟩ → ⟨<em>x, *y* ⟩）是 ⟨0, 0, -1⟩ 或 ⟨ 0, 0, 1⟩ 取决于您的坐标系的惯用手和屏幕轴。您没有明确的“相机矩阵”（通常称为视图矩阵），但您的相机（视图和投影）由您的第 4 步投影隐式定义！

但是，请注意，这种方法仅适用于正交投影，而不适用于透视投影（考虑屏幕左侧的面，面向右侧并与视图方向平行；点积将为 0，但它应该是可见的）。在实际 3D 硬件中使用的常用方法是首先进行所有变换（包括投影），然后检查生成的 2D 三角形是逆时针还是顺时针缠绕，并根据该条件保留或丢弃。

# ruby-on-rails - 散列密码并要求它执行删除操作

> ID：11705574
> 
> 赞同：0
> 
> 时间：2012-07-28T23:48:14.460
> 
> 标签：ruby-on-rails, ruby

我对 ruby​​ on rails 很陌生，所以我不确定如何实现它。我有一张表，里面有一个“password_hash”字段的条目。当用户创建新条目时，他们输入密码。我想（显然）将该密码的哈希值放在“password_hash”字段中。执行此操作的哈希命令在哪里？在模型中？

其次，当有人使用“销毁”方法删除条目时，我希望他们必须输入密码，并且只有在条目的哈希值与为该条目存储的哈希值匹配时才销毁条目。我猜这个在控制器中的destroy方法中，但我不知道如何进行检查。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:51:57.947

对于密码散列部分，请查看此 sreencast [http://railscasts.com/episodes/250-authentication-from-scratch](http://railscasts.com/episodes/250-authentication-from-scratch)。

在同一个截屏视频中，您可以看到如何对用户进行身份验证。在您的情况下，您只想使用密码进行身份验证。

```
class SomeModelWithPassword < ActiveRecord::Base
  attr_accessible :password

  attr_accessor :password
  before_save :encrypt_password

  validates_presence_of :password, :on => :create

  def correct_password?(password_try)
    password_hash == BCrypt::Engine.hash_secret(password_try, password_salt)
  end

  def encrypt_password
    if password.present?
      self.password_salt = BCrypt::Engine.generate_salt
      self.password_hash = BCrypt::Engine.hash_secret(password, password_salt)
    end
  end
end 
```

在您的销毁操作中，您只需检查它是否是正确的密码

```
def destroy
  @model = SomeModelWithPassword.find(params[:id])
  if @model.correct_password? params[:password]
    @model.destroy
  else
    ...
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T04:12:06.233

以下是做你想做的事情的要素。您可以在模型上创建一个 attr_accessor，让它自动生成密码哈希，然后使用您的控件检查删除。BCrypt ( [http://bcrypt-ruby.rubyforge.org/](http://bcrypt-ruby.rubyforge.org/) ) 将处理散列。

您的型号：

```
require 'bcrypt'

class Entry < ActiveRecord::Base
  include BCrypt

  def password
    @password ||= Password.new(password_hash)
  end

  def password=(new_password)
    @password = Password.create(new_password)
    self.password_hash = @password
  end
end 
```

你的控制器：

```
class EntriesController < ApplicationController

...
  def destroy
    @entry = Entry.find(params[:id])
    if @entry.password == params[:password]
      @entry.destroy
    else
      redirect_to @entry, :notice => 'You must enter a valid password to destroy an entry'
    end
  end
end
  end

end 
```

# android - Android - 使用 Spinner 从 Asset 加载 WebView

> ID：11705578
> 
> 赞同：0
> 
> 时间：2012-07-28T23:49:32.587
> 
> 标签：android, html, webview, spinner, assets

所以我有一个微调器，它需要使用位于 assets 文件夹中的 HTML 文件来填充 WebView。我的代码看起来很血统，但显然不起作用。我将附上Java和错误。

我知道我在这里犯了错误，需要了解我做错了什么。

```
public class atcSectionWeb extends Activity {

public static final int DIALOG_DOWNLOAD_PROGRESS = 0;
private ProgressDialog mProgressDialog;

Spinner spLoadFrom;
private ArrayAdapter<CharSequence> spinnerArrayAdapter;

String name[] = { "1.html", "2.html", "3.html", "etc.html" };
String displayName[] = {"1st Name", "2nd Name", "3rd name", "And So On" };

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.atcsectionweb);

    mProgressDialog = new ProgressDialog(atcSectionWeb.this);
    mProgressDialog.setIndeterminate(false);
    mProgressDialog.setMax(100);
    mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);

    spLoadFrom = (Spinner) findViewById(R.id.Spinner02);

    spinnerArrayAdapter = new ArrayAdapter<CharSequence>(this,
            android.R.layout.simple_spinner_item, displayName);
    spinnerArrayAdapter
            .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spLoadFrom.setAdapter(spinnerArrayAdapter);

    SpinnerListener spListener = new SpinnerListener();
    spLoadFrom.setOnItemSelectedListener(spListener);

    Button atcBack = (Button) findViewById(R.id.atcBacksecweb);
    atcBack.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            setResult(RESULT_OK);
            finish();
        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu2, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.atcAbout2:
        Intent atcAboutWeb = new Intent(atcSectionWeb.this,
                atcAboutWeb.class);
        startActivity(atcAboutWeb);
        break;
    case R.id.atcContact2:
        emailme();
        break;
    }
    return true;
}

private void emailme() {
    // TODO Auto-generated method stub
    try{
    String domsEmail = "";
    String message = "Insert Message Here";
    String myemail[] = { domsEmail };
    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, myemail);
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "");
    emailIntent.setType("plain/text");
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message);
    startActivity(emailIntent);
    }catch (Exception  e) {
        Toast.makeText(
                atcSectionWeb.this,
                "No email application is available, please download one from Play store.",
                Toast.LENGTH_LONG).show();

    }
}

public class SpinnerListener implements OnItemSelectedListener {
    public SpinnerListener() {
    }

    public void onItemSelected(AdapterView<?> arg0, View arg1,
            final int position, long arg2) {

        Button atcSection = (Button) findViewById(R.id.atcSubmitweb);
        atcSection.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                WebView wv = (WebView)findViewById(R.id.ctiWebView);
                wv.setWebViewClient(new WebViewClient() {  
                      @Override  
                      public boolean shouldOverrideUrlLoading(WebView view, String url)  
                      {  
                        view.loadUrl(url);
                        return true;
                      }  
                    });         
                wv.loadUrl("file:///android_asset/" + position); 

            }
        });

    }

    public void onNothingSelected(AdapterView<?> arg0) {

    }
}
} 
```

日志猫：

```
07-28 23:40:09.438: E/AndroidRuntime(584): FATAL EXCEPTION: main
07-28 23:40:09.438: E/AndroidRuntime(584): java.lang.NullPointerException
07-28 23:40:09.438: E/AndroidRuntime(584):  at com.assistant.atcSectionWeb$SpinnerListener$1.onClick(atcSectionWeb.java:240)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.view.View.performClick(View.java:2485)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.view.View$PerformClick.run(View.java:9080)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.os.Handler.handleCallback(Handler.java:587)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.os.Looper.loop(Looper.java:123)
07-28 23:40:09.438: E/AndroidRuntime(584):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-28 23:40:09.438: E/AndroidRuntime(584):  at java.lang.reflect.Method.invokeNative(Native Method)
07-28 23:40:09.438: E/AndroidRuntime(584):  at java.lang.reflect.Method.invoke(Method.java:507)
07-28 23:40:09.438: E/AndroidRuntime(584):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-28 23:40:09.438: E/AndroidRuntime(584):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-28 23:40:09.438: E/AndroidRuntime(584):  at dalvik.system.NativeStart.main(Native Method) 
```

复制 SALMAN 的代码后出错：

```
07-29 01:04:58.290: E/AndroidRuntime(532): FATAL EXCEPTION: main
07-29 01:04:58.290: E/AndroidRuntime(532): java.lang.NullPointerException
07-29 01:04:58.290: E/AndroidRuntime(532):  at com.assistant.atcSectionWeb$SpinnerListener.onItemSelected(atcSectionWeb.java:236)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.widget.AdapterView.fireOnSelected(AdapterView.java:871)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.widget.AdapterView.access$200(AdapterView.java:42)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:837)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.os.Handler.handleCallback(Handler.java:587)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.os.Looper.loop(Looper.java:123)
07-29 01:04:58.290: E/AndroidRuntime(532):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-29 01:04:58.290: E/AndroidRuntime(532):  at java.lang.reflect.Method.invokeNative(Native Method)
07-29 01:04:58.290: E/AndroidRuntime(532):  at java.lang.reflect.Method.invoke(Method.java:507)
07-29 01:04:58.290: E/AndroidRuntime(532):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-29 01:04:58.290: E/AndroidRuntime(532):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-29 01:04:58.290: E/AndroidRuntime(532):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:41:49.793

粘贴应用程序的整个代码只是为了您的目的。

```
 package asdasd.adasd.ad;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Spinner;
import android.widget.Toast;

public class AsdasdasActivity extends Activity {

public static final int DIALOG_DOWNLOAD_PROGRESS = 0;
private ProgressDialog mProgressDialog;

Spinner spLoadFrom;
private ArrayAdapter<CharSequence> spinnerArrayAdapter;

String name[] = { "1.html", "2.html", "3.html"};
String displayName[] = {"1st Name", "2nd Name", "3rd name" };

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mProgressDialog = new ProgressDialog(AsdasdasActivity.this);
    mProgressDialog.setIndeterminate(false);
    mProgressDialog.setMax(100);
    mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);

    spLoadFrom = (Spinner) findViewById(R.id.Spinner02);

    spinnerArrayAdapter = new ArrayAdapter<CharSequence>(this,
            android.R.layout.simple_spinner_item, displayName);
    spinnerArrayAdapter
            .setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spLoadFrom.setAdapter(spinnerArrayAdapter);

    SpinnerListener spListener = new SpinnerListener();
    spLoadFrom.setOnItemSelectedListener(spListener);

    WebView wv = (WebView)findViewById(R.id.webView1);

    wv.getSettings().setJavaScriptEnabled(true);
 /*   wv.setWebViewClient(new WebViewClient() {  
          @Override  
          public boolean shouldOverrideUrlLoading(WebView view, String url)  
          {  
            view.loadUrl(url);
            return true;
          }  
        });    
        */     
    wv.loadUrl("file:///android_asset/htmlfileMine.html"); 

    Button atcBack = (Button) findViewById(R.id.atcBacksecweb);
    atcBack.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            setResult(RESULT_OK);
            finish();
        }
    });

}

private void emailme() {
    // TODO Auto-generated method stub
    try{
    String domsEmail = "";
    String message = "Insert Message Here";
    String myemail[] = { domsEmail };
    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, myemail);
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "");
    emailIntent.setType("plain/text");
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, message);
    startActivity(emailIntent);
    }catch (Exception  e) {
        Toast.makeText(
                AsdasdasActivity.this,
                "No email application is available, please download one from Play store.",
                Toast.LENGTH_LONG).show();

    }
}

public class SpinnerListener implements OnItemSelectedListener {
    public SpinnerListener() {
    }

    public void onItemSelected(AdapterView<?> arg0, View arg1,
            final int position, long arg2) {

                WebView wv = (WebView)findViewById(R.id.webView1);

                wv.getSettings().setJavaScriptEnabled(true);
               wv.setWebViewClient(new WebViewClient() {  
                      @Override  
                      public boolean shouldOverrideUrlLoading(WebView view, String url)  
                      {  
                        view.loadUrl(url);
                        return true;
                      }  
                    });    

                wv.loadUrl("file:///android_asset/"+name[position]); 

    }

    public void onNothingSelected(AdapterView<?> arg0) {

    }
}
} 
```

/// XML 布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <Spinner
        android:id="@+id/Spinner02"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />

    <ProgressBar
        android:id="@+id/progressBar1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <Button
        android:id="@+id/atcSubmitweb"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/atcBacksecweb"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <WebView
        android:id="@+id/webView1"
        android:layout_width="300dp"
        android:layout_height="300dp" />

</LinearLayout> 
```

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T11:24:02.053

```
//call that class on button click evevnt
WebDialog dialog =new WebDialog(this,"file:///android_asset/index.html");
        dialog.show();

//Put this class into your package
public class WebDialog extends Dialog
{

    static final int                      BLUE                  = 0xFF6D84B4;
    static final float[]                  DIMENSIONS_DIFF_LANDSCAPE =
                                                                    { 20, 60 };
    static final float[]                  DIMENSIONS_DIFF_PORTRAIT  =
                                                                    { 40, 60 };
    static final FrameLayout.LayoutParams   FILL                    = new FrameLayout.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.FILL_PARENT);
    static final int                      MARGIN                    = 4;
    static final int                      PADDING                   = 2;
    static final String                   DISPLAY_STRING            = "touch";

    private String                        mUrl;
//  private DialogListener                mListener;
    private ProgressDialog                mSpinner;
    private WebView                       mWebView;
    private LinearLayout                  mContent;
    private TextView                      mTitle;

    public WebDialog(Context context, String url)
    {
        super(context);
        mUrl = url;
    }

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        mSpinner = new ProgressDialog(getContext());
        mSpinner.requestWindowFeature(Window.FEATURE_NO_TITLE);
        mSpinner.setMessage("Loading...");

        mContent = new LinearLayout(getContext());
        mContent.setOrientation(LinearLayout.VERTICAL);
        setUpTitle();
        setUpWebView();
        Display display = getWindow().getWindowManager().getDefaultDisplay();
        final float scale = getContext().getResources().getDisplayMetrics().density;
        int orientation = getContext().getResources().getConfiguration().orientation;
        float[] dimensions = (orientation == Configuration.ORIENTATION_LANDSCAPE) ? DIMENSIONS_DIFF_LANDSCAPE : DIMENSIONS_DIFF_PORTRAIT;
        addContentView(mContent, new LinearLayout.LayoutParams(display.getWidth() - ((int) (dimensions[0] * scale + 0.5f)), display.getHeight() - ((int) (dimensions[1] * scale + 0.5f))));
    }

    private void setUpTitle()
    {
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        Drawable icon = getContext().getResources().getDrawable(R.drawable.ic_launcher);
        mTitle = new TextView(getContext());
        mTitle.setText("Website");
        mTitle.setTextColor(Color.WHITE);
        mTitle.setTypeface(Typeface.DEFAULT_BOLD);
        mTitle.setBackgroundColor(BLUE);
        mTitle.setPadding(MARGIN + PADDING, MARGIN, MARGIN, MARGIN);
//      mTitle.setCompoundDrawablePadding(MARGIN + PADDING);
//      mTitle.setCompoundDrawablesWithIntrinsicBounds(icon, null, null, null);
        mContent.addView(mTitle);
    }

    private void setUpWebView()
    {
        mWebView = new WebView(getContext());
        mWebView.setVerticalScrollBarEnabled(false);
        mWebView.setHorizontalScrollBarEnabled(false);
        mWebView.setWebViewClient(new WebDialog.DialogWebViewClient());
        mWebView.getSettings().setJavaScriptEnabled(true);

        System.out.println(" mURL = "+mUrl);

        mWebView.loadUrl(mUrl);
        mWebView.setLayoutParams(FILL);
        mContent.addView(mWebView);
    }

    private class DialogWebViewClient extends WebViewClient
    {

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);

            return true;
        }

        @Override
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
        {
            super.onReceivedError(view, errorCode, description, failingUrl);
            WebDialog.this.dismiss();
        }

        @Override
        public void onPageStarted(WebView view, String url, Bitmap favicon)
        {
            super.onPageStarted(view, url, favicon);
            mSpinner.show();
        }

        @Override
        public void onPageFinished(WebView view, String url)
        {
            super.onPageFinished(view, url);
            String title = mWebView.getTitle();
            if (title != null && title.length() > 0)
            {
                mTitle.setText(title);
            }
            mSpinner.dismiss();
        }

    }
} 
```

# javascript - 使用 URL 中的变量使选择框重新加载页面的最简单方法？

> ID：11705589
> 
> 赞同：0
> 
> 时间：2012-07-28T23:51:17.250
> 
> 标签：javascript, html, onchange, drop-down-menu

我已经阅读了关于同一主题的一些问答，但其中大多数似乎有点复杂并且倾向于使用 jQuery。由于我不知道如何使用 jQuery，并且正在寻找一个简单的解决方案，希望我不会因为提出关于这个主题的另一个问题而被激怒:-)

我在类似于以下的页面上有一个选择框：

```
<select>
<option>Option 1</option>
<option>Option 2</option>
<option>Option 3</option>
<option>Option 4</option>
</select> 
```

选择新选项后，我希望重新加载当前页面，但在 URL 中附加一个指定所选选项的变量。

有效地做到这一点的最简单的非jQuery方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:02:09.840

如果我理解正确，我认为这样的事情会起作用：

```
<form>
    <select name="my_select" onchange="submit()">
        <option>Option 1</option>
        <option>Option 2</option>
        <option>Option 3</option>
        <option>Option 4</option>
    </select>
</form> 
```

action="#" 将重新加载当前页面，method="get" 指定将选择的值放入 URL。onchange="submit()" 告诉表单在选择的值更改时提交。

如果您在页面 foo.html，更改值将加载 foo.html?my_select=Option+3#。

如果 URL 中有其他参数，则不会保留它们。也就是说，如果您在 foo.html?a=1 上并更改值，新页面仍将是 foo.html?my_select=Option+3#。

# node.js - Jade mixin 麻烦

> ID：11705591
> 
> 赞同：0
> 
> 时间：2012-07-28T23:51:41.343
> 
> 标签：node.js, express, pug

我正在使用jade的mixin并遇到了一些麻烦：

代码：

```
 mixin renderLink(linkName,linkUrl,linkClass,other)
    - var active = req.url==linkUrl?'active':''
    li(class=[active,linkClass])
      a(href=linkUrl) #{linkName}
      #{other}

  ....
  .nav-collapse
    ul.nav
      +renderLink('HOME','/')
      +renderLink('CHAT','/chat',null,'span.badge.badge-warning 2') 
```

我想要的是：

```
li
  a(href="#") 
    CHAT
    span.badge.badge-warning 2 
```

如何修改 #{other} 以获得我想要的？谢谢

**---谢谢，使用这个：**

```
 mixin renderLink(linkName,linkUrl,linkClass)
    - var active = req.url==linkUrl?'active':''
    li(class=[active,linkClass])
      a(href=linkUrl) #{linkName}
        block 
```

并得到了我想要的：

```
<li class=" ">
  <a href="/chat">消息<span class="badge badge-warning">2</span></a>
</li> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T08:14:12.193

首先，我假设你想要`CHAT`在同一行，`a`因为你不想要一个`<chat></chat>`元素。

它没有记录（在官方文档中），但你想要的是使用一个块。试试这个：

```
mixin renderLink(linkName,linkUrl,linkClass,other)
  - var active = req.url==linkUrl?'active':''
  li(class=[active,linkClass])
    a(href=linkUrl) #{linkName}
      if block
        block

....
.nav-collapse
  ul.nav
    +renderLink('HOME','/')
    +renderLink('CHAT','/chat')
      span.badge.badge-warning 2 
```

我不确定该`if block`声明是否有必要。

# android - 自动部署到 Android 开发者控制台

> ID：11705596
> 
> 赞同：7
> 
> 时间：2012-07-28T23:52:27.997
> 
> 标签：android, automation, google-play

是否有任何库可以帮助我部署到 Google Play Android 开发者控制台？

我想自动：

1.  上传新的 APK
2.  更新“最近更改”的文本
3.  发布表格，即点击“保存”

我正在使用 Python 进行自动化，但任何其他语言都会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-29T14:39:58.233

我们正在开发一个开源工具，用于自动将应用程序部署到 Google Play： [https ://github.com/onepf/AppDF/tree/master/tools/uploader](https://github.com/onepf/AppDF/tree/master/tools/uploader)

您可以通过封装 webkit 控件并使用它来检查它的代码是否完全符合您的需要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-01T10:39:13.733

Google 于 2014 年 7 月发布了一个新的 API，用于自动部署到 Alpha/Beta 和生产渠道！

看看[这里](https://developers.google.com/android-publisher/?rd=1)

api特点：

*   上传应用程序的新版本发布应用程序，通过将 APK 分配到各种轨道（alpha、beta、分阶段推出或生产）
*   创建和修改 Google Play 商店列表，包括本地化文本和图形以及多设备屏幕截图

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-20T09:30:53.060

如果您使用的是 Android Studio 或 IntelliJ IDEA，我已经为它构建了一个开源插件。[机器人车道](https://github.com/Jintin/DroidLane)

它使用 google api 上传 apk 以及最近的更改文本。您可以一键定义多个配置文件或组 apk。最近更改的文本也支持多种语言。所有证书都通过您给定的密码以 AES 加密。这很安全。

您可以在 IDE 中搜索插件或在[JetBrains 站点](https://plugins.jetbrains.com/plugin/8068)下载。

See [https://github.com/Jintin/DroidLane](https://github.com/Jintin/DroidLane) for more information. You are always welcome if you have any question or want feature. Thank you.

# ruby-on-rails - Rails：simple_form 的问题

> ID：11705597
> 
> 赞同：0
> 
> 时间：2012-07-28T23:52:47.240
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, simple-form

我在 Rails 应用程序中构建了一个 simple_form 表单，一切顺利：

```
<%= simple_form_for([@folha, @servico], html: {class: 'well form-horizontal'}) do |f| %>
<%= f.association :pessoa, label: 'Funcionário' %>
<%= f.input :funcao, label: 'Função',collection: @funcoes %>
<%= f.input :modulos, label: 'Módulos', input_html: {class: 'span4'} %>
<%= f.input :valor, label: 'Valor por hora', as: :string ,input_html: {class: 'span1'} %>
<%= f.input :horas, as: :string, input_html: {class: 'span1'} %>
<%= f.button :submit, 'Incluir', class: 'btn btn-primary' %>
<% end %> 
```

要更改 f.association 下拉列表中的订单列表，我已经覆盖了 Pessoa.rb 中的默认 .all 方法：

```
def self.all
  order :nome
end 
```

然后在尝试渲染视图时出现此错误：

```
wrong number of arguments (1 for 0)
Extracted source (around line #5):

2:  <h1>Preencher Pagamentos - Folha <%= "#{@folha.mes}/#{@folha.ano}" %> <small> <%= @folha.obs %> </small> </h1>
3: </div>
4: <%= simple_form_for([@folha, @servico], html: {class: 'well form-horizontal'}) do |f| %>
5: <%= f.association :pessoa, label: 'Funcionário' %>
6: <%= f.input :funcao, label: 'Função',collection: @funcoes %>
7: <%= f.input :modulos, label: 'Módulos', input_html: {class: 'span4'} %> 
```

我认为最好找到一种在视图中对列表进行排序的方法。但我很好奇发生了什么
……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:20:17.510

您不应该首先覆盖这些方法。

这是使用 simple_form 的方法

```
f.association : pessoa, :collection => Pessoa.order(:nome).all 
```

[https://github.com/plataformatec/simple_form/#associations](https://github.com/plataformatec/simple_form/#associations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-08T10:30:50.130

[您可以使用这里](http://apidock.com/rails/ActiveRecord/Base/default_scope/class)描述的 default_scope 。

> 在模型中使用此宏为模型上的所有操作设置默认范围。

在你的情况下`default_scope order(:nome)`。

# vi - 如何在vi中滚动'n'行？

> ID：11705601
> 
> 赞同：1
> 
> 时间：2012-07-28T23:53:50.827
> 
> 标签：vi

假设您正在扫描一个巨大的日志并且`CTRL-F`根本不切割它。你可以向下移动预定义的行数，比如 500 行吗？你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T00:02:21.260

类型`500j`

j 向下移动一行，像往常一样，您可以通过数字前缀重复命令 N 次

# r - 使用 XML 包处理 R 中的 HTML 网页抓取错误

> ID：11705602
> 
> 赞同：0
> 
> 时间：2012-07-28T23:54:00.747
> 
> 标签：r, xml-parsing, web-scraping

我正在尝试像这样抓取一个网页[http://www.weatheroffice.gc.ca/city/pages/on-135_metric_e.html](http://www.weatheroffice.gc.ca/city/pages/on-135_metric_e.html)，并使用以下代码，我收到一个错误，提示 HTML 不正确：

```
library(RCurl)
library(XML)
weather <- getURL("http://www.weatheroffice.gc.ca/city/pages/on-135_metric_e.html")
doc <- htmlParse(weather) 
```

我看过[这篇](https://stackoverflow.com/questions/10956480/error-using-xml-package-in-r)文章，它演示了如何使用 Internet Explorer 和`rcom`包来修复格式不正确的 HTML，然后将其提供给解析器。然而，有问题的 HTML 通过了[http://validator.w3.org](http://validator.w3.org)的验证。

还有哪些其他方法可以使用 XML 包处理与 HTML 解析相关的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:11:03.490

Give this a whirl and see if it does what you're after:

```
library(RCurl)
library(XML)
url   <- "http://www.weatheroffice.gc.ca/city/pages/on-135_metric_e.html"
doc   <- htmlTreeParse(url, useInternalNodes=TRUE) 
```

I also suggest you check out these resources:

1.  [talkstats.com thread on web scraping (great beginner examples)](http://www.talkstats.com/showthread.php/26153-Still-trying-to-learn-to-scrape)
2.  [w3schools.com site on html stuff (very helpful)](http://www.w3schools.com/xpath/xpath_nodes.asp)

# java - 我的应用程序在打开时崩溃？

> ID：11705603
> 
> 赞同：-2
> 
> 时间：2012-07-28T23:54:04.820
> 
> 标签：java, android, android-emulator, android-sdk-2.3

我有这个应用程序，当我打开它时它说它意外关闭，这里是主要的 java ......大部分工作已经完成，我真的需要尽可能多的帮助提前谢谢大家

```
package geezer.quiz.app;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.TextView;
import geezer.quiz.app.score;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //---------------
        final TextView aText;
        final TextView bText;
        final TextView cText;
        final TextView dText;
        final TextView question;
        final CheckBox a1;
        final CheckBox b1;
        final CheckBox c1;
        final CheckBox d1;
        final TextView result;
        Button next;

        a1 = (CheckBox) findViewById(R.id.checkBox1);
        b1 = (CheckBox) findViewById(R.id.checkBox2);
        c1 = (CheckBox) findViewById(R.id.checkBox3);
        d1 = (CheckBox) findViewById(R.id.checkBox4);

        result = (EditText) findViewById(R.id.result);

        aText = (EditText) findViewById(R.id.textView1);
        bText = (EditText) findViewById(R.id.textView1);
        cText = (EditText) findViewById(R.id.textView1);
        dText = (EditText) findViewById(R.id.textView1);
        question = (EditText)findViewById(R.id.questionText);
        next = (Button) findViewById(R.id.button1);

        final String a[] = new String[5]; 
        final String b[] = new String[5];
        final String c[] = new String[5];
        final String d[] = new String[5];
        final String questions[]= new String [5];

        a[0] = "Bell Bottoms";
        a[1] = "Far Out";
        a[2] = "Insanity";
        a[3] = "Tye Dye";
        a[4] = "Yes";

        b[0] = "Speedos";
        b[1] = "Solid";
        b[2] = "Calvin Harris";
        b[3] = "Love Beads";
        b[4] = "Maybe";

        c[0] = "Plaid";
        c[1] = "Norm";
        c[2] = "Cobra Starship";
        c[3] = "Bell Bottoms";
        c[4] = "Later";

        d[0] = "Flannel";
        d[1] = "Radical";
        d[2] = "David Guetta";
        d[3] = "Granny Glasses";
        d[4] = "Never";

        questions[0] = "Which is the most in style?";
        questions[1] = "Which term is used most?";
        questions[2] = "Four musical artists are listed, which is fake?";
        questions[3] = "Which of these is the most embarrasing?";
        questions[4] = "If someone proposed you join a Golly Gee club how would you respond?";

         next.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

            score.q ++;

            boolean q1a = false;
            boolean q1b = false;
            boolean q1c = false;
            boolean q1d = false;
            boolean q2a = false;
            boolean q2b = false;
            boolean q2c = false;
            boolean q2d = false;
            boolean q3a = false;
            boolean q3b = false;
            boolean q3c = false;
            boolean q3d = false;
            boolean q4a = false;
            boolean q4b = false;
            boolean q4c = false;
            boolean q4d = false;
            boolean q5a = false;
            boolean q5b = false;
            boolean q5c = false;
            boolean q5d = false;

                    aText.setText(a[score.q]); 
                    bText.setText(b[score.q]);
                    cText.setText(c[score.q]);
                    dText.setText(d[score.q]);

                    question.setText(questions[score.q]); 

                    if(d1.isChecked() && score.q == 0) {
                        q1d = true;
                        score.score++;
                    }

                    if(c1.isChecked() && score.q == 1) {
                        q2c = true;
                        score.score++;
                    }

                    if(a1.isChecked() && score.q == 2) {
                        q3a = true;
                        score.score++;
                    }

                    if(d1.isChecked() && score.q == 3) {
                        q4d = true;
                        score.score++;
                    }

                    if(d1.isChecked() && score.q == 4) {
                        q5d = true;
                        score.score++;

                        if( score.score >2 && score.q == 4){
                             result.setText("You are not a geezer");
                         }
                        if( score.score <3 && score.q == 4){
                             result.setText("You are indeed a geezer");
                         }

                }
            }

         });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

这是第二个java文件（分数）......我这里只有两个变量

```
package geezer.quiz.app;

import geezer.quiz.app.MainActivity;

public class score {

    protected static int score = 0;
    protected static int q =-1;

    /**
     * @param args
     */
    public static void main(String[] args) {

    }

} 
```

这是logcat，我不知道这意味着什么......我打算提供这个，很抱歉我忘记了......

```
07-28 23:45:23.542: D/AndroidRuntime(411): Shutting down VM
07-28 23:45:23.542: W/dalvikvm(411): threadid=1: thread exiting with uncaught exception (group=0x40014760)
07-28 23:45:23.576: E/AndroidRuntime(411): FATAL EXCEPTION: main
07-28 23:45:23.576: E/AndroidRuntime(411): java.lang.RuntimeException: Unable to start activity ComponentInfo{geezer.quiz.app/geezer.quiz.app.MainActivity}: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1815)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread.access$500(ActivityThread.java:122)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.os.Looper.loop(Looper.java:132)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread.main(ActivityThread.java:4123)
07-28 23:45:23.576: E/AndroidRuntime(411):  at java.lang.reflect.Method.invokeNative(Native Method)
07-28 23:45:23.576: E/AndroidRuntime(411):  at java.lang.reflect.Method.invoke(Method.java:491)
07-28 23:45:23.576: E/AndroidRuntime(411):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
07-28 23:45:23.576: E/AndroidRuntime(411):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
07-28 23:45:23.576: E/AndroidRuntime(411):  at dalvik.system.NativeStart.main(Native Method)
07-28 23:45:23.576: E/AndroidRuntime(411): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
07-28 23:45:23.576: E/AndroidRuntime(411):  at geezer.quiz.app.MainActivity.onCreate(MainActivity.java:40)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.Activity.performCreate(Activity.java:4397)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1048)
07-28 23:45:23.576: E/AndroidRuntime(411):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1779)
07-28 23:45:23.576: E/AndroidRuntime(411):  ... 11 more
07-28 23:46:32.822: I/Process(411): Sending signal. PID: 411 SIG: 9
07-28 23:48:24.712: D/AndroidRuntime(420): Shutting down VM
07-28 23:48:24.722: W/dalvikvm(420): threadid=1: thread exiting with uncaught exception (group=0x40014760)
07-28 23:48:24.742: E/AndroidRuntime(420): FATAL EXCEPTION: main
07-28 23:48:24.742: E/AndroidRuntime(420): java.lang.RuntimeException: Unable to start activity ComponentInfo{geezer.quiz.app/geezer.quiz.app.MainActivity}: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1815)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread.access$500(ActivityThread.java:122)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.os.Looper.loop(Looper.java:132)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread.main(ActivityThread.java:4123)
07-28 23:48:24.742: E/AndroidRuntime(420):  at java.lang.reflect.Method.invokeNative(Native Method)
07-28 23:48:24.742: E/AndroidRuntime(420):  at java.lang.reflect.Method.invoke(Method.java:491)
07-28 23:48:24.742: E/AndroidRuntime(420):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
07-28 23:48:24.742: E/AndroidRuntime(420):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
07-28 23:48:24.742: E/AndroidRuntime(420):  at dalvik.system.NativeStart.main(Native Method)
07-28 23:48:24.742: E/AndroidRuntime(420): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText
07-28 23:48:24.742: E/AndroidRuntime(420):  at geezer.quiz.app.MainActivity.onCreate(MainActivity.java:40)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.Activity.performCreate(Activity.java:4397)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1048)
07-28 23:48:24.742: E/AndroidRuntime(420):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1779)
07-28 23:48:24.742: E/AndroidRuntime(420):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:04:11.913

堆栈跟踪**准确地**告诉您问题所在：

```
android.widget.TextView cannot be cast to android.widget.EditText 
```

...这意味着其中一个强制转换无效，因为您*尝试*强制转换为an的视图`EditText`实际上是 a `TextView`：

```
result = (EditText) findViewById(R.id.result);

aText = (EditText) findViewById(R.id.textView1);
bText = (EditText) findViewById(R.id.textView1);
cText = (EditText) findViewById(R.id.textView1);
dText = (EditText) findViewById(R.id.textView1);
question = (EditText)findViewById(R.id.questionText); 
```

再次在`MainActivity.java`第 40 行，堆栈 strace 告诉您：

```
07-28 23:45:23.576: E/AndroidRuntime(411):  at geezer.quiz.app.MainActivity.onCreate(MainActivity.java:40) 
```

# ruby-on-rails - 浏览我的 Rails 应用程序数据库的工具？

> ID：11705605
> 
> 赞同：0
> 
> 时间：2012-07-28T23:54:11.963
> 
> 标签：ruby-on-rails, database, activerecord

我想要一种全面查看的方法：

```
1\. what's going on in my database
2\. what the schema looks like 
```

有没有一个好的工具可以让你做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:12:20.473

有一个 gem Active Admin 可以让你这样做：[http ://activeadmin.info/documentation.html](http://activeadmin.info/documentation.html)

当然，您可以使用任何其他允许您连接到数据库的管理工具，例如 Squirrel [http://squirrel-sql.sourceforge.net/](http://squirrel-sql.sourceforge.net/)，它连接到各种 sql 数据库，其中包括 sqlite。

对于开发和测试，我想说了解数据的首选方法是使用 FactoryGirl 或 Faker 等工具自动生成数据，并查看 schema.rb 的架构。

# excel - Excel添加多行

> ID：11705606
> 
> 赞同：1
> 
> 时间：2012-07-28T23:54:15.007
> 
> 标签：excel, range, rows

有没有快速的方法来做到这一点？

例如我有两行

AB

34 5
56 6
34 3
25 2

我想逐行进行以下计算。

A1 = A1+B1
A2 = A2+B2
A3 = A3+B3 ..
..

现在我可以用一个循环遍历行的宏来做到这一点

```
for x = 1 to 500
sheet1.cells(x,1).vlaue = sheet1.cells(x,1).vlaue + sheet1.cells(x,2).vlaue
next x 
```

但是通过使用范围或可以作为单个步骤执行的东西，是否有更有效的方法？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T11:26:05.263

一种快速的方法是从即时窗口输入：

```
[a1:a500]=[a1:a500+b1:b500] 
```

方括号是`Evaluate`函数的快捷方式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T01:14:32.697

我可以想到两个选择：

### 选项1

使用`Copy`, `Paste Special`,`Add`

```
Sub AddStep()
    Dim rng1 As Range, rng2 As Range

    Set rng1 = Range([A1], [A1].End(xlDown))
    Set rng2 = rng1.Offset(, 1)
    rng2.Copy
    rng1.PasteSpecial xlPasteValues, xlPasteSpecialOperationAdd
    Application.CutCopyMode = False

End Sub 
```

### 选项 2

循环一个变体数组。这比在一个范围内循环*要*快得多

```
Sub AddStep()
    Dim rng As Range
    Dim dat As Variant
    Dim i As Long

    Set rng = Range([B1], [A1].End(xlDown))
    dat = rng
    For i = LBound(dat, 1) To UBound(dat, 1)
        dat(i, 1) = dat(i, 1) + dat(i, 2)
    Next
    rng = dat
End Sub 
```

选项 1 更快，但在某些情况下最好避免使用剪贴板。
对 1,000,000 行样本进行测试：
选项 1 - 435 毫秒
选项 2 - 2589 毫秒

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T00:02:35.673

The way I would do it is create a formula for the first row, then just select all the rows after and press `Ctrl+D`. Isn't this what you are after? Unless I misunderstood the question.

# php - codeigniter 是否自动加载

> ID：11705607
> 
> 赞同：1
> 
> 时间：2012-07-28T23:54:40.457
> 
> 标签：php, mysql, codeigniter

我**禁用**自动加载数据库只是因为我网站的许多页面不需要数据库连接或处理。如果我需要数据库处理，我会`$this->load->database();`在我的页面需要数据库支持时手动执行。

现在，我想知道的是：我将**启用**自动加载并`$db['default']['autoinit'] = FALSE;`在配置文件中进行设置。这会像上面的方式一样工作吗？我的意思是，当相关页面（不是在每个页面调用中）只需要 db 时，是否会加载 db，这就是我想要的？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:36:52.933

其实答案是`NO`。

如果您启用，`auto-loading`那么它将自动加载到您的控制器中，但如果您设置`autoinit=false`，则在加载库时它不会连接到数据库，因为默认情况下会在`db library`加载时连接到数据库。

> autoinit - 加载库时是否自动连接到数据库。如果设置为 false，则连接将在执行第一个查询之前进行。

当`autoinit=false`连接将在第一次`query`发生之前建立但它会自动加载并在每个控制器中可用。

[**在这里阅读**](http://codeigniter.com/user_guide/database/configuration.html)。

# ruby-on-rails - act_as_taggable_on Tag_counts_on() 方法

> ID：11705611
> 
> 赞同：0
> 
> 时间：2012-07-28T23:55:56.877
> 
> 标签：ruby-on-rails, ruby, acts-as-taggable-on

我目前在 Rails 的acts_as_taggable_on 插件中的 Model.tag_counts_on() 方法上遇到了一些问题。我找不到有关该方法的真实文档，我想了解更多有关它接受的参数的信息。我正在尝试获取标签**子集的**标签计数，而不是我的应用程序上的整个标签集，我将如何去做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:38:35.480

假设您正在使用`mbleigh/acts-as-taggable-on`

这是该方法出现的 gem的[master 分支。](https://github.com/mbleigh/acts-as-taggable-on/blob/master/lib/acts_as_taggable_on/acts_as_taggable_on/collection.rb)

我会检查条件和参数。

```
def tag_counts_on(context, options = {})
  all_tag_counts(options.merge({:on => context.to_s}))
end

##
# Calculate the tag counts for all tags.
#
# @param [Hash] options Options:
# * :start_at   - Restrict the tags to those created after a certain time
# * :end_at     - Restrict the tags to those created before a certain time
# * :conditions - A piece of SQL conditions to add to the query
# * :limit      - The maximum number of tags to return
# * :order      - A piece of SQL to order by. Eg 'tags.count desc' or 'taggings.created_at desc'
# * :at_least   - Exclude tags with a frequency less than the given value
# * :at_most    - Exclude tags with a frequency greater than the given value
# * :on         - Scope the find to only include a certain context
def all_tag_counts(options = {})..end 
```

# c# - 正则表达式边界

> ID：11705612
> 
> 赞同：0
> 
> 时间：2012-07-28T23:56:46.987
> 
> 标签：c#, .net, regex

请帮我找到匹配项：

```
 <ptext>Any Sentence/tags goes here</ptext> 
```

我目前的正则表达式是：

```
 \<ptext\>\b.+\b\</ptext\> 
```

但是，如果我将例如加倍：

```
<ptext>Any Sentence/tags goes here</ptext> <ptext>Any Sentence/tags goes here</ptext> 
```

我的正则表达式会将 ptext 匹配到最后一个 ptext

如何将其分开，以便在我给出的示例中匹配两（2）个匹配项。感谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:04:37.330

这就是一对`( )`和一个`.+?`会派上用场的地方。尝试...

```
\<ptext\>\b(.+?)\b\</ptext\> 
```

这有两件事。首先，自己使用的括号，不要与 OR 语句混淆`(like|this)`，将在括号内专门返回，不一定是所有内容。其次，“懒惰”`.+?`将匹配 1 个或多个字符，直到第一个匹配，而不是最后一个匹配，才有效。这样，它应该只捕获每组项目而不是整个文件。

也不确定`\b`您的情况是否正确，仅供参考。因此，我会推荐...

`\<ptext\>(.+?)\</ptext\>`

例如，此代码应返回...

```
Array[0] = "This is a sentence"
Array[1] = "Here's another one." 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T00:01:30.553

使用非贪婪量词：

```
<ptext>.+?</ptext> 
```

# android - 获取整个 Google 地图网页源，而不仅仅是生成的 KML 文件进行解析

> ID：11705619
> 
> 赞同：1
> 
> 时间：2012-07-28T23:59:31.777
> 
> 标签：android, google-maps, sax, kml

我开发了一个使用谷歌地图并在地图上绘制从 A 点到 B 点的路线路径的 Android 应用程序。[我已经使用了这篇](https://stackoverflow.com/questions/11389995/directional-arrow-from-source-to-destination-driving-directions)文章中提到的方法，一切正常。这几天在模拟器和手机上测试了结果，路由路径绘制成功。

然而，在没有修改任何代码的情况下，今天我意识到路线路径绘制失败并且应用程序崩溃了。正如我所期望的那样，我使用以下代码来“构建”用于 KML 文件生成的 uri 链接：

```
public static String getUrl(double fromLat, double fromLon, double toLat,
        double toLon) {// connect to map web service
    StringBuffer urlString = new StringBuffer();
    urlString.append("http://maps.google.com/maps?f=d&hl=en");
    urlString.append("&saddr=");// from
    urlString.append(Double.toString(fromLat));
    urlString.append(",");
    urlString.append(Double.toString(fromLon));
    urlString.append("&daddr=");// to
    urlString.append(Double.toString(toLat));
    urlString.append(",");
    urlString.append(Double.toString(toLon));
    urlString.append("&ie=UTF8&0&om=0&output=kml");
    return urlString.toString();
} 
```

此函数为 kml 文件返回类似“ **[http://maps.google.com/maps?f=d&hl=en&saddr=35.5133804,24.0421933&daddr=35.511732,23.974715&ie=UTF8&0&om=0&output=kml ”的 Uri。](http://maps.google.com/maps?f=d&hl=en&saddr=35.5133804,24.0421933&daddr=35.511732,23.974715&ie=UTF8&0&om=0&output=kml)**然而，经过实验，我意识到现在使用与上面完全相同的 KML 链接，SAX 解析器会尝试解析**整个 Google 地图网页源代码**！当我的应用程序运行时，我正在下载生成的 kml 文件并在本地成功解析，格式如下：

```
?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.0">
    <Document>
    ...
    </Document>
</kml> 
```

相比之下，现在下载的文件是整个谷歌地图网页，格式如下：

```
<!DOCTYPE html><html xmlns:v="urn:schemas-microsoft-com:vml"> 
    <head> 
        <meta content="text/html;charset=ISO-8859-1" http-equiv="content-type"/>   
        <meta content="Find local businesses, view maps and get driving directions in 
        Google Maps" name="description"/> <link href="//maps.gstatic.com/favicon.ico" 
        rel="shortcut icon"/>   
        <noscript> <meta content="0; URL=/m/directions?dirflg=&amp;saddr=35.5133804,24.0421933&amp;daddr=35.511732,23.974715&
        amp;hl=en&amp;oi=nojs" http-equiv="refresh"/> </noscript> <title>
        ...

tick('ua');var id = 'none';if (event.target){id =  
closestParentId(event.target);}else if (event.srcElement){
id = closestParentId(event.srcElement);}
var firstUserAction = event.type + '-' + id; 
```

当然，这是字面的 Google 地图网页源，当我从我的 PC 上查看页面时，它会显示路线路径。所以我的问题是，是否有人遇到过像这样开始发生的同样非常奇怪的问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T13:06:34.057

这里也一样，但我现在也使用 api：“http://maps.googleapis.com/maps/api/directions/json?origin=" + startAdd+ "&destination=" + endAdd + "&sensor=true";

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T12:56:33.757

我会回答上面提到的原始问题，但我没有足够的声望点。所以，我在这里说明一下：

我将我的应用程序从使用 KML 迁移到 JSON 的一种快速方法是关注[这篇](http://blog.synyx.de/2010/06/routing-driving-directions-on-android-part-1-get-the-route/)文章。正如帖子中提到的，我将输出从 kml 更改为 dragdir 并使用提供的算法来解密从 Goole 地图下载的文件。通过这种方式，我可以获得所有路由点并将它们应用到我的应用程序以进行进一步处理。

希望这可以帮助需要快速迁移项目的人。

# ruby-on-rails-3 - 小时和分钟之间的 Rails AR 查询

> ID：11705620
> 
> 赞同：1
> 
> 时间：2012-07-28T23:59:32.500
> 
> 标签：ruby-on-rails-3, postgresql, activerecord

Rails 3 应用程序，pg 适配器，我的架构如下所示：

```
create_table "events", :force => true do |t|
 t.integer  "event_type_id"
 t.datetime "start_at"
 #...
end 
```

一些示例数据包括：

```
p.events.each{|e| puts e.start_at }; 1
2009-03-23 08:30:00 UTC
2009-05-20 07:45:00 UTC
2009-05-20 07:45:00 UTC
2009-03-23 16:00:00 UTC
2009-05-20 10:00:00 UTC
2009-03-23 19:30:00 UTC
2009-03-23 11:30:00 UTC
2009-05-20 07:45:00 UTC
2009-05-20 07:45:00 UTC
2009-05-20 09:00:00 UTC
2009-05-20 07:45:00 UTC 
```

我想在接下来的 3 个小时之间进行搜索，但忽略了这一天！**小时和分钟**对我来说很重要..
可以在 Postgres 中完成吗？我一直在尝试使用[pg EXTRACT()](http://www.postgresql.org/docs/8.0/static/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)，但到目前为止没有成功

我不想过滤 ruby​​ 代码中的所有日期:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T09:01:59.183

我只介绍一种如何在 PostgreSQL 中完成此操作的方法。我没有 RoR 经验，所以在这方面我无法为您提供帮助。

下面的基本思想是将所有时间戳转换为同一天，以便可以比较小时和分钟：

1.  将时间戳转换为仅包含几小时一分钟的字符串
2.  将该字符串转换回时间戳会导致日期部分为第 1 年的 1 月 1 日

* * *

```
create table test (id serial, start_at timestamp);

insert into test(start_at)
select * from generate_series('2008-03-01 00:00'::timestamp,
                              '2008-03-15 12:00', '5 hours');

with 
hh24mi_now as (select to_timestamp(to_char(current_timestamp, 'HH24:MI'), 'HH24:MI'))
select * from test where id in (
  select id
    from test
   where to_timestamp(to_char(start_at, 'HH24:MI'), 'HH24:MI') >= (select * from hh24mi_now)
     and to_timestamp(to_char(start_at, 'HH24:MI'), 'HH24:MI') < (select * from hh24mi_now) + interval '3 hours'
  )
order by id
; 
```

示例运行的结果：

```
 id |      start_at       
----+---------------------
 13 | 2008-03-03 12:00:00
 18 | 2008-03-04 13:00:00
 23 | 2008-03-05 14:00:00
 37 | 2008-03-08 12:00:00
 42 | 2008-03-09 13:00:00
 47 | 2008-03-10 14:00:00
 61 | 2008-03-13 12:00:00
 66 | 2008-03-14 13:00:00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T01:38:57.640

忽略分钟，只考虑小时：

```
#On my model    
scope :next_3_hours, ->(h){
  where( [" date_part( 'hour', \"start_at\") = ? OR date_part( 'hour', \"start_at\") = ? OR date_part( 'hour', \"start_at\") = ? ",h,h+1,h+2])
    .order("date_part( 'hour', \"start_at\") ASC, date_part( 'minute', \"start_at\")")
} 
```

结果：

```
# on SQL (considering now to be 17:00)
SELECT "events".* FROM "events"
WHERE ( date_part( 'hour', "start_at") = 17 
        OR date_part( 'hour', "start_at") = 18
        OR date_part( 'hour', "start_at") = 19 )
ORDER BY date_part( 'hour', "start_at") ASC, date_part( 'minute', "start_at") 
```

# python - 表单中的 Django 数组值

> ID：11705621
> 
> 赞同：6
> 
> 时间：2012-07-28T23:59:36.173
> 
> 标签：python, django, forms

我有能力在表单中提交标签。提交表单后，我看到：

`tags=['3','4','5']`

标签值是用户选择的 ID。我能够从`request.POST`对象中获取值，一切都很好。问题是用户必须选择至少一个标签。我想在 Django 表单中进行验证，但我不确定在 django 表单中提供什么样的表单字段值？通常我使用`CharField`,`DateField`等。但是获取数组值的存在是什么？然后我可以`clean`为它提供一个函数。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:05:09.540

试试`django.forms.MultipleChoiceField()`。见[https://docs.djangoproject.com/en/dev/ref/forms/fields/#multiplechoicefield](https://docs.djangoproject.com/en/dev/ref/forms/fields/#multiplechoicefield)

```
known_tags = (
    (1, 'Choice 1'), (2, 'Choice 2'), (3, 'Choice 3'),
    (4, 'Choice 4'), (5, 'Choice 5'))

class MyForm(django.forms.Form):
    tags = django.forms.MultipleChoiceField(choices=known_tags, required=True) 
```

**编辑1：**

如果您要做的是将文本字段转换为数组...

```
class MyForm(django.forms.Form):
    tags = django.forms.CharField(required=True)

    def clean_tags(self):
        """Split the tags string on whitespace and return a list"""
        return self.cleaned_data['tags'].strip().split() 
```

# grails - grails gorm hasMany 基于来自 gsp 页面的选择选项的查询

> ID：11705623
> 
> 赞同：0
> 
> 时间：2012-07-28T23:59:46.690
> 
> 标签：grails, hql, grails-orm

我有以下情况，

```
Domain class A which hasMany B's
Domain class B which hasMany C's and belongsTo A
Domain class C which belongsTo B

Class E {
 A a
 B b
 C c

 }
 Class C {
  String name
 } 
```

我想查询 E 值，即获取一些 E 属性的列表，例如在这种情况下 c.name 基于用户在选择框中选择的值，即用户从多个选择框中选择 A 和 B 并基于此条件，a获得名称列表。

换句话说，我想在 c 中找到满足 a 和 b 设置的条件的所有名称

试图弄清楚 GORM 查询无济于事。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:47:05.460

我通过使用原始 SQL 连接解决了这个问题。不确定这是否是最好的方法，但它对我有用。我从A和B得到参数，即

```
def fromA = params.someCriteriaValueInA
def fromB = params.someCriteriaValueInB 
```

请注意，这些是从 gsp 中获取的。此外，将使用链式选择基于**fromA值加载****fromB值。**

在 grails 控制器/服务中...

```
def db = new Sql(dataSource)
def result = db.rows("your sql to go here") 
```

然后你可以对结果做任何你想做的事情，例如在模板中操作它

```
render(template: "myResults", model:[result :result]) 
```

不要忘记在控制器/服务中注入**dataSource** bean，并进行必要的导入

```
import groovy.sql.Sql 
```

请注意，这涉及遍历许多域类实例，对于喜欢原始 SQL 的人来说，这似乎更容易。希望采用不同的方法，也许使用 GORM 的标准。

# css - 设置字体大小 孩子们

> ID：11705627
> 
> 赞同：0
> 
> 时间：2012-07-29T00:00:37.080
> 
> 标签：css

```
<div class="pluginTitle"><h2>Latest Posts</h2></div> 
```

如何使用 CSS 设置属于类`font-size:11px`的`<h2>`子元素的元素？`.pluginTitle`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T00:06:23.877

使用子选择器[`>`](http://www.w3.org/TR/CSS2/selector.html#child-selectors)选择子项

```
.pluginTitle > h2 { font-size:11px } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T00:03:35.250

```
.pluginTitle h2 { font-size: 11px; } 
```

# c# - 如何使用 AsEnumerable().OrderBy 按多个条件对 DataTable 进行排序？

> ID：11705629
> 
> 赞同：0
> 
> 时间：2012-07-29T00:00:57.667
> 
> 标签：c#, .net, vb.net, linq, datatable

就像在 TSQL 中一样：

```
select * from aTable where (aCondition) order by AnIntegerField desc, ADateField 
```

如何使用以下方法对 DataTable 进行排序：

```
dt.AsEnumerable().OrderBy(--two conditions --) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:05:04.610

您将首先使用 OrderBy，然后使用[ThenBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenby)（升序）或[ThenByDescending](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenbydescending)（降序）。

从微软文档：

```
 string[] fruits = { "grape", "passionfruit", "banana", "mango", 
                          "orange", "raspberry", "apple", "blueberry" };

    // Sort the strings first by their length and then 
    //alphabetically by passing the identity selector function.
    IEnumerable<string> query =
        fruits.OrderBy(fruit => fruit.Length).ThenBy(fruit => fruit); 
```

或对于 VB（因为问题被标记为两者）：

```
 ' Create an array of strings.
    Dim fruits() As String = _
        {"grape", "passionfruit", "banana", "mango", _
         "orange", "raspberry", "apple", "blueberry"}

    ' Sort the strings first by their length and then 
    ' alphabetically by passing the identity function.
    Dim query As IEnumerable(Of String) = _
        fruits _
        .OrderBy(Function(fruit) fruit.Length) _
        .ThenBy(Function(fruit) fruit) 
```

# ruby-on-rails - 模板错误-rails 3中的ajax

> ID：11705632
> 
> 赞同：0
> 
> 时间：2012-07-29T00:01:50.870
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

`show.html.erb`我在文件中有一个导航菜单，其中包含 2 个选项卡/链接`UsersController.rb`，我想使用 ajax 为选项卡呈现不同的部分。

在`show.html.erb`我有一个名为`profile-data`我想显示内容的 div 中。所以我做这样的事情：

**链接结构：**

```
<li><%= link_to "College friends", college_friends_path, :remote => true %></li>
<li><%= link_to "Highschool friends", highschool_friends_path, :remote => true %></li> 
```

**我定义了路线：**

```
match "college_friends" => "users#college_friends", :as => "college_friends"
match "highschool_friends" => "users#highschool_friends, :as => "highschool_friends" 
```

**我在我的 UserController.rb 中定义了必要的方法：**

```
class UsersController < ApplicationController
  def show
    @user = User.find(params[:id])
  end

  def college_friends
    respond_to do |format|
      format.js
    end
  end

  def highschool_friends
    respond_to do |format|
      format.js
    end
  end
end 
```

**最后一件事是我们有 JS 文件：**

*college_friends.js.erb*

```
$('#profile-data').html("<%= escape_javascript(render(:partial => 'college_friends')) %>"); 
```

*highschool_friends.js.erb*

```
$('#profile-data').html("<%= escape_javascript(render(:partial => 'highschool_friends')) %>"); 
```

**部分代码：_college_friends.html.erb**

```
<% groups = @user.friends.group_by(&:college_name) %>
<% sorted_groups = groups.sort_by{|key, values| values.count}.reverse %>
<% sorted_groups.each do |collegename, friends| %>
<% next if collegename.blank? %>
<div class="contentbox">
    <div class="box-header">
        <h3><%= collegename %></h3>
        <div class="meta-info">
            <p><i class="icon-map-marker"></i> Malmö</p>
            <p><i class="icon-user"></i><span class="count"> <%= friends.count %></span> vänner</p>
        </div>
    </div>
    <ul class="friends-list">
        <% friends.map do |friend| %>
        <li><%= image_tag(friend.image) %>
            <% end %> 
        </ul> 
    </div>
<% end %> 
```

**当我单击链接时没有任何反应，并在控制台中收到此错误：**

```
Started GET "/universitet_friends" for 127.0.0.1 at 2012-07-29 01:53:39 +0200
Processing by UsersController#universitet_friends as JS
  Rendered users/_universitet_friends.html.erb (1.6ms)
  Rendered users/universitet_friends.js.erb (3.1ms)
Completed 500 Internal Server Error in 7ms

ActionView::Template::Error (undefined method `friends' for nil:NilClass):
    1: <% groups = @user.friends.group_by(&:college_name) %>
    2: <% sorted_groups = groups.sort_by{|key, values| values.count}.reverse %>
    3: <% sorted_groups.each do |collegename, friends| %>
    4: <% next if collegename.blank? %>
  app/views/users/_universitet_friends.html.erb:1:in `_app_views_users__universitet_friends_html_erb___1983680250475155079_70236040373720'
  app/views/users/universitet_friends.js.erb:1:in `_app_views_users_universitet_friends_js_erb__1317362850668628869_70236044930260'
  app/controllers/users_controller.rb:19:in `universitet_friends 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:17:37.570

> ActionView::Template::Error（nil:NilClass 的未定义方法 `friends'）：

这告诉您您的 @user 变量为零。发生这种情况是因为当您返回控制器进行 AJAX 请求时，您从未真正设置过 @user 变量。它不会在请求之间持续存在。您需要在 ajax 请求期间传递该变量。一种方法是将 user_id 参数添加到 ajax URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T08:45:05.567

也许你也可以做这样的事情

`<%=link_to "Highschool friends", college_friends_path(:user_id => @user.id), :remote => true %>`

然而，最好的方法是将 user_id 参数传递给 ajax url..您可以在链接“点击”事件上触发 ajax 请求。

# android - Android 字体不工作

> ID：11705635
> 
> 赞同：1
> 
> 时间：2012-07-29T00:02:14.633
> 
> 标签：android, typeface

我正在尝试在 Android 2.2.2 上使用 AndroidClock 字体，因为它看起来不错，但是当我使用它时，只设置了一些文本。

![安卓时钟.ttf](../Images/20131cc0dabc08b3bfaa96264a3e6b9e.png)

它非常奇怪。有人知道吗？

我正在使用它来设置字体

```
mCountdown.setTypeface(Typeface.createFromAsset(getAssets(), "AndroidClock.ttf")); 
```

这就是它通常的样子

![倒数](../Images/e2388e5fb1ef6d4079bf60fde5d293f3.png)

这是字体查看器中的字体或您想调用的任何字体

![字体](../Images/88b1470d9609f5d5ba6c98fcd299df88.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:38:53.867

它不工作的原因......我使用的字体实际上只使用了字母`A, P and M`、for`AM`和`PM`数字，原因很明显。

# django - South: How to rename a model with a name containing uppercase letters?

> ID：11705642
> 
> 赞同：0
> 
> 时间：2012-07-29T00:02:49.603
> 
> 标签：django, django-models, django-south

Thanks to the nice docs provided by the amazing app South, I managed to successfully rename a model using the code below:

```
def forwards(self, orm):
    db.rename_table('myapp_a_model', 'myapp_another_model')

def backwards(self, orm):
    db.rename_table('myapp_another_model','myapp_a_model') 
```

However, the real name of the model contains upper-case letters, i.e. myapp_A_Model, and I want to rename myapp_A_Model to myapp_Another_Model. The uppercase letters matter to me. The challenge is that the code below:

```
db.rename_table('myapp_A_Model', 'myapp_Another_Model') 
```

doesn't work. How do you rename a model into one with uppercase letters?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T09:58:49.657

事实证明，我对此有些困惑。

Django 模型名称可以是大写，而 PostGres 表名称都可以是小写。

# javascript - 在 MooTools 中，.implement 和 .prototype 有什么区别

> ID：11705645
> 
> 赞同：0
> 
> 时间：2012-07-29T00:03:27.673
> 
> 标签：javascript, mootools

实现改变原型，那么为什么不只是用'some class'.prototype来改变目录......，这似乎很没用或废话

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T00:42:51.950

您可以查看 MooTools 源代码或检查控制台中的 MooTools 对象，以查看它在`implement()`被调用时在后台执行的操作。

在 MooTools 1.4.5 中，它是这样做的：

```
function (key, value){

    if ($type(key) == 'object'){
        for (var p in key) this.implement(p, key[p]);
        return this;
    }

    var mutator = Class.Mutators[key];

    if (mutator){
        value = mutator.call(this, value);
        if (value == null) return this;
    }

    var proto = this.prototype;

    switch ($type(value)){

        case 'function':
            if (value._hidden) return this;
            proto[key] = Class.wrap(this, key, value);
        break;

        case 'object':
            var previous = proto[key];
            if ($type(previous) == 'object') $mixin(previous, value);
            else proto[key] = $unlink(value);
        break;

        case 'array':
            proto[key] = $unlink(value);
        break;

        default: proto[key] = value;

    }

    return this;

} 
```

如您所见，其中肯定有一些额外的逻辑。例如，您似乎可以传递具有相应属性名称的对象，`key`并`value`让它在一次调用中向对象原型添加多个东西。

`implement()`除非您非常确定自己知道自己在做什么，否则我会使用并避免将内容直接添加到原型链中。毫无疑问，这些额外的东西是有原因的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T12:39:43.547

有两个方面要实施。在类上下文和对象（类型/本地）上。

## 共同利益

它们之间的共同点是，它们是 API。因为它是 API，所以 MooTools 可以添加一些方法来确保您不会（意外）覆盖受各种 Native 类型保护的原型方法。请参阅强制保护许多本机方法的这一位：[https ://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L238-282](https://github.com/mootools/mootools-core/blob/master/Source/Core/Core.js#L238-282)

此外，implement 是重载的——这意味着您可以传递一个同时实现多个方法的对象，而不是中断并为每个原型调用创建一个新行。

类中的函数方法被包装。

这些装饰器可用：

```
Function.implement({

    hide: function(){
        this.$hidden = true;
        return this;
    },

    protect: function(){
        this.$protected = true;
        return this;
    }

}); 
```

这意味着你可以做

```
Obj.implement({
   foo: foo.hide(),
   bar: bar.protect()
}); 
```

这允许您通过`.hide()`添加未包装的属性来使用未包装的方法：

```
Number.prototype.$family = function(){
    return isFinite(this) ? 'number' : 'null';
}.hide(); 
```

`.protect()`由 Class 使用，见下文。

这并不意味着你不能做`Number.prototype.$family = somethingElse`——你可以。

## 类的细节

在类构造函数上使用`implement`时，请注意对 的引用`$hidden`和调用`wrap()`：

```
var implement = function(key, value, retain){
    if (Class.Mutators.hasOwnProperty(key)){
        value = Class.Mutators[key].call(this, value);
        if (value == null) return this;
    }

    if (typeOf(value) == 'function'){
        if (value.$hidden) return this;
        this.prototype[key] = (retain) ? value : wrap(this, key, value);
    } else {
        Object.merge(this.prototype, key, value);
    }

    return this;
}; 
```

这意味着当你传递一个函数时，它会被自动包装 - 包装使你可以通过`.protect()`装饰器拥有私有方法或通过`.hide()`

它还支持 Class Mutators - 你应该检查这个，但它能够定义可以修改构造函数的特殊键，而不是仅仅添加到原型中。

再一次，您可以轻松地做到：

```
ClassConstructor.prototype.foo = someFn; 
```

这将起作用。

```
// but:
ClassConstructor.prototype.foo = someFn.protect();

// however...
instanceOfClassconstructor.foo(); // works also. 
```

看到这个：

```
// generic method.
var foo = function() {
    console.log('hi');
};

var ClassConstructor = new Class({});

// implement the foo method as private.
ClassConstructor.implement({
    foo: foo.protect()
});

var instance = new ClassConstructor();

// try to call it, will throw.
try {
    instance.foo();
}
catch(e) {
    console.warn(e);
}

// do it directly on the prototype
ClassConstructor.prototype.foo = foo.protect();

var instance2 = new ClassConstructor();
instance2.foo(); // works. 
```

# msbuild - 在 MSBuild 中获取 NuGet 包文件夹

> ID：11705650
> 
> 赞同：14
> 
> 时间：2012-07-29T00:04:10.447
> 
> 标签：msbuild, build-automation, nuget, nuget-package

我想调用我通过 MSBuild 中的 NuGet 管理的 NUnit 等可执行工具：

```
<Target Name="Test">
  <CreateItem Include="$(BuildCompileDirectory)\*.Tests.*dll">
    <Output TaskParameter="Include" ItemName="TestAssemblies" />
  </CreateItem>
  <NUnit
    Assemblies="@(TestAssemblies)"
    ToolPath="$(PackagesDirectory)\NUnit.2.5.10.11092\tools"
    WorkingDirectory="$(BuildCompileDirectory)"
    OutputXmlFile="$(BuildDirectory)\$(SolutionName).Tests.xml" />
</Target> 
```

问题是 NuGet 包的文件夹包含包的版本号。例如`nunit-console.exe`在文件夹中`packages\NUnit.2.5.10.11092\tools`。如果我更新 NUnit 包，这条路径将会改变，我必须更新我的 MSBuild 脚本。这是不可接受的。

MSBuild 不允许在目录中使用通配符，因此这不起作用：

```
ToolPath="$(PackagesDirectory)\NUnit.*\tools" 
```

如何在更新 NuGet 包时调用 MSBuild 中的工具而无需更新构建脚本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-29T00:04:10.447

您可以使用[MSBuild Transforms](https://docs.microsoft.com/en-us/visualstudio/msbuild/msbuild-transforms?view=vs-2019)来获取特定工具的相对目录：

```
<ItemGroup>
  <NunitPackage Include="$(PackagesDirectory)\NUnit.*\tools\nunit-console.exe"/>
</ItemGroup>

<Target Name="Test">
  <CreateItem Include="$(BuildCompileDirectory)\*.Tests.*dll">
    <Output TaskParameter="Include" ItemName="TestAssemblies" />
  </CreateItem>
  <NUnit
    Assemblies="@(TestAssemblies)"
    ToolPath="@(NunitPackage->'%(relativedir)')"
    WorkingDirectory="$(BuildCompileDirectory)"
    OutputXmlFile="$(BuildDirectory)\$(SolutionName).Tests.xml" />
</Target> 
```

# android - Anchor Android Dialog to a View

> ID：11705660
> 
> 赞同：17
> 
> 时间：2012-07-29T00:07:14.030
> 
> 标签：android, dialog

I wanted to know if it is possible to anchor a Dialog to a View in Android, or in general: just to display the dialog at a certain location on the screen.

P.S. I don't want to use a PopupMenu because it is my understanding that one cannot customize the items displayed in the menu-- I'm ultimately trying to have text and put an image next to it to alert the user that they have a message or something new to see here.

Thanks for your time-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-15T02:24:22.280

使用窗口参数。

```
 WindowManager.LayoutParams params = new WindowManager.LayoutParams();
    params.copyFrom(getDialog().getWindow().getAttributes());
    params.gravity = Gravity.BOTTOM;
    params.y = YOUR_ANCHOR_VIEW.getHeight();
    getDialog().getWindow().setAttributes(params); 
```

我使用 Gravity.BOTTOM 和视图高度将对话框锚定在锚视图之上。

Gravity.TOP 将使 y 从顶部应用，反之亦然。

我在 onActivityCreated() 上使用了这段代码。

# oracle - Issue installing Oracle SQL Developer on my MacBookPro - Am I missing a component?

> ID：11705661
> 
> 赞同：1
> 
> 时间：2012-07-29T00:07:32.890
> 
> 标签：oracle, oracle-sqldeveloper

I had to recently re-install OS X on my MBP and am in the process of re-installing all of my apps. One app that worked just fine in the past, but is now giving me errors is Oracle SQL Developer and I can't for the life of me figure out what I am missing.

Here's what I have tried:

1.  Downloaded and installed SQL Developer on my machine.
2.  Downloaded the Instant Client related files - [http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html](http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html) (I installed all of the 64 bit related stuff on this page - Im on a 64 bit machine), combined it into one folder and moved it my /usr folder using this guide: [installing Oracle Instantclient on Mac OS/X without setting environment variables?](https://stackoverflow.com/questions/684352/installing-oracle-instantclient-on-mac-os-x-without-setting-environment-variable)
3.  I also installed this the JDK: [http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)
4.  I also set up my TNSNames.ora file and copied it to my /etc folder (This is required on a mac)

**Here's my problem - If I attempt to connect to my Oracle instance using the above, it throws this error:**

*An error was encountered performing the requested operation: no ocijdbc11 in java.library.path Vendor code 0*

This occurs whether I use basic or the TNS connection type.

So my question to my fellow developers is - Am I missing something in terms of the install above? I have tried googling for that particular error message and not found anything useful. At first glance, it seems like SQL Developer is looking for some file.

Thanks in advance for your answers!

***EDIT - The version of SQL Developer that I am trying to install is 3.1.07 and I am trying to connect to an 11G instance.***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:40:34.873

转到工具 > 首选项 > 数据库 > 高级，并确保未选中使用 OCI/Thick 驱动程序。

![Mac OS X 中的 SQL 开发人员](../Images/2764125d7f7525629c88fa459769ea34.png)

完成后，尝试创建连接并进行测试。我还认为您可能在新安装的 OS X 中运行了不兼容的 Java 版本，因此如果解决方案不起作用，请尝试安装 JDK 1.6.0_11 或更高版本。

# javascript - How to reset/clear form within my create.js.erb?

> ID：11705662
> 
> 赞同：4
> 
> 时间：2012-07-29T00:08:03.890
> 
> 标签：javascript, ruby-on-rails, ajax, ruby-on-rails-3, ruby-on-rails-3.1

I can't get my form to reset correctly. It submits and it goes to the database but everything remains on the form.

Here is my code:

**DogsController**

```
def create
  @dog = current_user.dogs.new(params[:dog])
  if @dog.save
    format.js
  else
    format.js
  end
end 
```

**dog/create.js.erb**

```
$('.add-dog-form').html('<%= escape_javascript(render(:partial => 'dogs/form', locals: { dog: @dog })) %>');
$('.add-dog-form > form')[0].reset(); // doesn't work 
```

**dog/new.js.erb**

```
$('.add-dog-form').html('<%= escape_javascript(render(:partial => 'dogs/form', locals: { dog: @dog })) %>'); 
```

**dogs/_form**

```
<%= form_for(@dog, :remote => true) do |f| %>
   <%= f.label :name, "Name" %>
   <%= f.text_field :name %>
   <%= f.submit "Add Dog" %>
<% end %> 
```

* * *

I create dogs at the Pets view instead of the dogs.

**PetsController**

```
 def add
    @dog = Dog.new
    @cat = Cat.new
    @bird = Bird.new
  end 
```

**pets/add.html.erb**

I click on the tab which changes it to the Dog Tab using [Twitter Bootstraps Tabbable Nav ability](http://twitter.github.com/bootstrap/components.html#navs)

```
<div class="tabbable">
   <ul class="nav nav-tabs">
      <li class="active">
         <a href="#tab1" data-toggle="tab">Cat</a>
      </li>
      <li>
         <a href="#tab2" data-toggle="tab">Dog</a>
      </li>
      <li>
         <a href="#tab3" data-toggle="tab">Bird</a>
      </li>
   </ul>
   <div class="tab-content">
      <div class="tab-pane active add-cat-form" id="tab1">
         <%= render "cats/form" %>
      </div>
      <div class="tab-pane add-dog-form" id="tab2">
         <%= render "dogs/form" %>
      </div>
      <div class="tab-pane add-bird-form" id="tab3">
         <%= render "birds/form" %>
      </div>
   </div>
</div> 
```

How can I reset the form if it gets created?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-29T12:19:59.247

尝试给表单一个 id：

```
<%= form_for(@dog, :remote => true, :html => { :id => 'dog_form' } ) do |f| %> 
```

和`$('#dog_form')[0].reset();`。

或者，您可以执行`$(":input:not(input[type=submit])").val("");`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T18:10:57.797

好吧，看来我的错误在于我的文件本身。我已将 js 文件创建为部分而不是常规页面。即`_create.js.erb`应该是`create.js.erb`。我还必须添加`respond_to do |format|`控制器`create`动作。现在我让一切正常工作。

# macos - Can font sizes be changed in C (in the shell)?

> ID：11705663
> 
> 赞同：0
> 
> 时间：2012-07-29T00:08:04.003
> 
> 标签：macos, bash, shell, fonts

I'm writing a C program out of the shell (Macintosh Terminal, to be specific), and would like to know if you can change font sizes within the program so it would look like:

# Hello world!

### Hello world!

Thanks!

P.S. The question isn't platform-specific. I'd love to hear if this is possible on another platform.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:11:23.360

In general, terminals do not support varying the font. Very faithful emulators of some of the VT100-family terminals may provide double-width and/or double-height font mode (you may have seen these modes used on some old green- or orange-screen retail cash register terminals), but I think they're unlikely to be supported on modern terminal emulators.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T00:21:43.367

尽管您通常无法更改字体大小，但有一些方法可以通过 ASCII 艺术来模仿。查看一些使用 ASCII 艺术字体生成文本以获取想法的 FIGlet 服务器。这是我在 Google 上找到的第一个：http: [//patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something](http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something)

有许多不同大小的不同字体，但这里有一些例子

```
_________ _______          _________
\__   __/(  ____ \|\     /|\__   __/
   ) (   | (    \/( \   / )   ) (   
   | |   | (__     \ (_) /    | |   
   | |   |  __)     ) _ (     | |   
   | |   | (       / ( ) \    | |   
   | |   | (____/\( /   \ )   | |   
   )_(   (_______/|/     \|   )_( 
```

从那里开始将其中一种字体嵌入您的程序并使用它来显示您想要的任何内容并不难。

# mysql - 如何将 LEFT JOIN 限制为一个结果并从结果集中返回最小值？

> ID：11705665
> 
> 赞同：1
> 
> 时间：2012-07-29T00:08:22.827
> 
> 标签：mysql

假设我有这样的查询：

```
SELECT t1.name, t2.likes
FROM table_1 t1
LEFT JOIN table_2 t2 ON t1.name = t2.name 
```

如何修改左连接以使其执行以下操作：

```
SELECT likes FROM table_2 WHERE name = [name from table 1] ORDER BY likes ASC 
```

我尝试编写子查询，但它不起作用，因为（我假设）您不能在子查询内部使用子查询外部的变量（例如名称）（名称不是常量，作为查询的结果集将不止一个）。

那有可能吗？

编辑：表格将是这样的：

表格1：

```
+------+--------+
| id   |  name  |
+------+--------+
|  0   |  cat   |
|  1   |  dog   |
+------+--------+ 
```

表2：

```
+------+--------+---------+
| id   |  name  |  likes  |
+------+--------+---------+
|  0   |  cat   |   23    |
|  1   |  cat   |   2     |
|  2   |  cat   |   53    |
|  3   |  dog   |   25    |
|  4   |  dog   |   12    |
+------+--------+---------+ 
```

所以，我想要的是：

```
+--------+---------+
|  name  |  likes  |
+--------+---------+
|  cat   |   2     |
|  dog   |   12    |
+--------+---------+ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T00:14:12.493

```
SELECT 
    t1.name, t2.likes
FROM table_1 t1
LEFT JOIN (
    SELECT
    name,
    MIN(likes) as likes 
    FROM table_2 
    GROUP BY name
) as t2 ON t1.name = t2.name 
```

您也可以使用子查询来做到这一点，但我认为这会更慢：

```
SELECT 
    t1.name,
    (SELECT MIN(likes) FROM table_2 WHERE table_2.name = t1.name)
FROM table_1 t1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T00:17:30.533

`likes`每个名字的最低要求：

```
SELECT   name, MIN(likes) AS likes
FROM     table_2
GROUP BY name 
```

如果您需要有关 的更多信息`name`，请连接到`table_1`表，将上述查询合并到子选择中：

```
SELECT a.name, b.likes
FROM   table_1 a
LEFT JOIN
(
    SELECT   name, MIN(likes) AS likes
    FROM     table_2
    GROUP BY name
) b ON a.name = b.name 
```

# javascript - 全局 JSON 变量

> ID：11705668
> 
> 赞同：1
> 
> 时间：2012-07-29T00:09:02.207
> 
> 标签：javascript, variables, dom, global-variables

如果您通过单击下面的链接查看到目前为止我所拥有的内容的来源，您会看到我遇到的问题。

*   我从包含游戏数据的 Ricky.json 获取 JSON 数据。
*   然后我尝试用一​​段 JSON 数据在文本字段中设置皮卡丘的名字，但它却说它是`undefined`.

我在 Chrome 上的控制台说对象“皮卡丘”存在，因为当我在控制台中警告它时，它返回“对象对象”。我还可以通过控制台使用 JSON.stringify() 对其进行字符串化。

为什么它在功能本身上不是全局的`main()`，而是在其他任何地方呢？？？

[养一只皮卡丘](http://nos.heliohost.org/games/RaisePikachu/)

```
function ChangeName(){
    var n=prompt("What would you like to rename your Pikachu?",""+pikachu.pikaname+"");
    pikachu.pikaname=n;
}

function main(){
    try{
        ajaxObj=new XMLHttpRequest();
        pikaname=document.getElementById("pikaname");
        age=document.getElementById("age");pikachu="";
        ajaxObj.onreadystatechange=function(){
            if(ajaxObj.readyState>=4&&ajaxObj.status==200){
                pikachu=JSON.parse(ajaxObj.responseText);
            }
        }
        ajaxObj.open("GET","players/Ricky.json",true);
        ajaxObj.send();
        pikaname.value=pikachu.pikaname;
    }
    catch(e){
        alert(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T00:17:42.997

AJAX 调用异步运行。在该行`pikaname.value = pikachu.pikaname;`执行时，JSON 实际上还不可用。相反，您需要在`onreadystatechange`事件内部进行设置：

```
 ajaxObj.onreadystatechange=function(){
        if(ajaxObj.readyState>=4&&ajaxObj.status==200){
            pikachu=JSON.parse(ajaxObj.responseText);
            // Set the value in the onreadystatechange...
            pikaname.value = pikachu.pikaname;
        }
    } 
```

现在，我还要指出，您可能不应该依赖于`pikaname`没有`var`. 相反，使用`var`outisde 任何函数定义它，或者检索它并`var`在使用它的函数内部定义它。

```
// Define at global scope
var pikachu;
function ChangeName(){
    var n=prompt("What would you like to rename your Pikachu?",""+pikachu.pikaname+"");
    pikachu.pikaname=n;
}

function main(){
    try{
        // Define with var in this function
        var ajaxObj=new XMLHttpRequest();
        var pikaname=document.getElementById("pikaname");
        var age=document.getElementById("age");
        pikachu="";

        ajaxObj.onreadystatechange=function(){
            if(ajaxObj.readyState>=4&&ajaxObj.status==200){
                pikachu=JSON.parse(ajaxObj.responseText);
            }
        }
        ajaxObj.open("GET","players/Ricky.json",true);
        ajaxObj.send();
        pikaname.value=pikachu.pikaname;
    }
    catch(e){
        alert(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:18:43.137

您的问题似乎在这里：

```
 age=document.getElementById("age");pikachu="";
    ajaxObj.onreadystatechange=function(){
        if(ajaxObj.readyState>=4&&ajaxObj.status==200){
            pikachu=JSON.parse(ajaxObj.responseText);
        }
    }
    ajaxObj.open("GET","players/Ricky.json",true);
    ajaxObj.send();
    pikaname.value=pikachu.pikaname; 
```

第一行将一个空字符串分配给`pikachu`. （顺便说一句，我不会在这样的一行上放置多个作业。）

几行之后，您将`pikachu`通过异步调用再次分配一个值。但它是异步的。`pikachu`因此，当您到达您期望成为具有属性的对象的最后一行时，不能保证分配会发生`pikaname`。

到那时，可能`pikachu`仍然是一个空字符串。

# java - 为什么 String 和 wrapper 类可以很好地作为哈希表中的键？

> ID：11705670
> 
> 赞同：-5
> 
> 时间：2012-07-29T00:09:08.777
> 
> 标签：java, oop, hashtable

为什么更喜欢使用代表哈希表中特定对象的字符串和包装器而不是使用实际对象本身？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T00:13:26.060

这个问题有点含糊，但也许这会有所帮助：

*   密钥必须是不可变的。String (Integer, Long) 非常适合这个。（当然，如果您稍后将对象更改为不再匹配键，这将无济于事）。

*   密钥必须实现 hashCode/equals 合约。String (Integer, Long) 已经这样做了。

*   您可以按键查找，而无需创建自定义对象的实例。

因此，如果您正在键入自定义对象的属性或计算值，则使用“原始”内置类来表示该派生值是方便（且安全）的。

事实上，很少需要或建议使用自定义类作为哈希表*键*，您可以使用字符串、整数和长整数来覆盖几乎所有内容（常见的例外：元组，Java 没有好的内置类，而数组则没有t 用作哈希键）。

# java - JList 的自定义组件，而不仅仅是字符串

> ID：11705672
> 
> 赞同：5
> 
> 时间：2012-07-29T00:09:34.050
> 
> 标签：java, swing

我一直在努力更新我的 Java 知识，并且我一直在构建一个小型 GUI 程序，但我遇到了一些问题。

基本上，我有一个`JList`我目前正在用来自我的一个类的对象的字符串填充它，该类实现`AbstractListModel`了我们可以调用我的`ItemList`类。它包含一个实现`ArrayList`类型的对象。`Item``Serializable`

但是，我想做的不是`JList`用一堆字符串填充我，而是用某种字符串+`JTextField`组合填充它，这样我就可以看到每个`Item`对象的一个​​属性，同时还能够更新另一个属性通过改变`JTextField`.

现在，我正在寻找的是最简单的方法，并且我假设有一种（相对）简单的方法可以做到这一点，因为在 GUI 应用程序中想要做的事情很常见（尽管我不会不要把它放在 Java 和 Swing 之后，让它变得复杂和复杂）。

那么，这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-29T01:08:06.130

无需使用`String`对象。反而：

*   将`Item`对象放入`JList`.
*   将一个添加`ListCellRenderer`到列表中，以`Item`最用户友好的方式显示对象。
*   当用户选择一个项目时，在**不同的地方**显示详细信息（我在想一个有 2 列标签和文本字段的面板，以及两行 - 每个属性一个，也许还有一个按钮`Save`）

编辑控件最好封装在一个面板中，然后可以在不需要时隐藏，并放在各种地方，例如

*   在列表下方
*   在 GUI 的主要部分
*   以 a`JOptionPane`或 a 显示（模态或非模态）`JDialog`

这是[将“查看/编辑面板”（文件详细信息）放置在选择组件（表格）下方的示例](https://codereview.stackexchange.com/questions/4446/file-browser-gui)。

![](../Images/23cdb3ac31746680c2928b202bef1f23.png)

# java - How can I JAR up my classes before uploading to Google App Engine

> ID：11705674
> 
> 赞同：0
> 
> 时间：2012-07-29T00:10:09.650
> 
> 标签：java, eclipse, performance, google-app-engine, jar

I have read that JARing up Java classes before uploading them to App Engine improves performance. Can anyone explain how that is done? Can that be achieved from within Eclipse?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:25:22.840

您可以轻松使用 Ant 制作 jar

```
<property name="staging.dir" value="war"/>
<property name="classes.dir" value="${staging.dir}/WEB-INF/classes"/>

<target name="jarClasses">
    <delete file="${staging.dir}/WEB-INF/lib/classes.jar" />
    <echo> ${staging.dir}/WEB-INF/lib/classes.jar DELETED </echo>
    <jar destfile="${staging.dir}/WEB-INF/lib/classes.jar" basedir="${classes.dir}" />
    <echo> ${staging.dir}/WEB-INF/lib/classes.jar JARRED </echo>
    <delete dir="${classes.dir}" />
    <echo> ${classes.dir} DELETED </echo>
</target> 
```

我的布局是这样的：

```
/war
/build.xml 
```

或者，您可以使用 Ant 任务进行部署

[配置 Eclipse 以将 App Engine 类预捆绑到单个 JAR 中以加快预热](https://stackoverflow.com/questions/9397101/configure-eclipse-to-pre-bundle-app-engine-classes-into-a-single-jar-for-faster)

我没有这样做，因为我不确定如何处理密码验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:16:12.743

Take a look at [Google Plugin for Eclipse](https://developers.google.com/appengine/docs/java/tools/eclipse).

It assembles all components required to build WAR files. Deployment must be done manually though.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-04T22:20:31.927

我不确定这是否是您在谈论的内容，但是您可以通过右键单击项目，然后选择导出 -> Java -> Jar 文件来从 Eclipse 项目中创建一个 JAR。一定要选择入门类/主类，不然不行！

# sftp - PHPStorm - Link external SFTP-folders into project

> ID：11705681
> 
> 赞同：2
> 
> 时间：2012-07-29T00:12:26.850
> 
> 标签：sftp, symlink, phpstorm

the issue i am fighting through is a bit complicated. Ill explain the setup envoironment to you first.

1.  I am using PHPStorm to work on a Symony2 Project.
2.  My Apache is hosted on a Debian-VM connected to PHPStorm via "Deployment Tool".
    /* So far: I can edit code and update the server automaticaly on save. Works*/

My problem now is, that i am using the composer, which is ment do get me the right bundles into the vendor folder.
I WANT to create kind of a symlink from the server directly into the project.
I DONT WANT to download the vendor folder from the server hard into the project.

COMPACT:
I want to create a symbolic link within a PHPStorm project. Linking a folder from a server into the Project. The linked in folder should be unidirectional updated on source change. The Classes and Namespaces should be known to the Project.

Is there any native way to get this done?
Or does anyone know a plugin which could handle such affairs?

I hope i expressed my point clearly :/ Please ask, if anything is unclear.

Greetings and thanks upfront.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T08:23:31.197

无法直接从 PhpStorm 执行，[请参阅相关问题](http://youtrack.jetbrains.net/issue/WI-1398)。您可以使用 ExpanDrive 等第三方工具通过 SFTP 将服务器目录映射到驱动器号，然后将此本地目录作为内容根添加到您的 PhpStorm 项目中。请注意，它可能会显着影响性能。

# mysql - MySQL 1,000 条 OR 语句（好主意？）

> ID：11705682
> 
> 赞同：5
> 
> 时间：2012-07-29T00:12:32.393
> 
> 标签：mysql, sql

我正在构建一个 Twitter 应用程序来获取用户的全部关注并获取他们的特定 ID*例如：1223455*

我还有一个巨大的数据库，其中包含包含特定 Twitter id 的行...查看行中的示例...

```
|1| 122345   |
|2| 2232144  |
|3| 99653222 |
|4| 123232   |
|5| 2321323  |
|6| 3121322  | 
```

问题是我们都知道 Twitter 的关注者越来越多（1000 个），我想知道这是一个很好的 MySQL 查询，在一个脚本运行中可能运行多达 20 次......

```
SELECT * FROM table WHERE twitterID='132323' OR twitterId='23123' OR twitterId='23123' OR twitterId='23123' OR twitterId='23123' OR twitterId='23123' OR twitterId='23123' OR twitterId='23123 
```

等等等等……一个查询中可能有超过 1,000 个 OR 语句（类似的查询可能会被调用 20 次）

这似乎不是一个很好的编程实践，但我还没有听说过另一种方式......？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T00:14:27.820

使用说明`in`符：

```
Select * from table where twitterid in (123,456,789,...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-29T00:16:49.640

这确实是一个非常糟糕的主意。MySQL 在优化 OR 语句方面做得不好。

使用 JOIN 或类似的东西会*好得多*

```
WHERE twitterId IN (
      select * 
        from followers
       where followee = whatever
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T00:17:25.677

试试这个：

```
SELECT * 
FROM table t1
WHERE twitterID 
      IN (select twitterID 
            from twitterIDsTable t2
           where t1.twitterID = t2.twitterID)--for performance 
```

# javascript - How to handle specific HTTP error for all AJAX calls?

> ID：11705684
> 
> 赞同：6
> 
> 时间：2012-07-29T00:13:16.527
> 
> 标签：javascript, jquery, ajax, http, http-status-codes

I have a web app, requesting and sending data via AJAX, and as a response, my server-side sends HTTP status codes, depending on the situation. so for example if a user tries to login while he's logged I probably return a `400 HTTP status code`. And eventually i handle it with an alert, etc.

But handling these HTTP Status codes gets too heavy, since I'm making heavy use of AJAX. that means I'll be handling HTTP status code repeatedly with every AJAX request, which will result in duplicated code, and that's a bad practice.

So, **what I'm looking for** is a way to handle all these errors in one place, so I just handle all `400`, `401`, etc with the same code.

**What i'm currently doing:**

Handling the errors manually for each AJAX call. By using the `statusCode` in`$.ajax()`.

```
 statusCode: {
        500: function(data) {
            alert('Some friendly error message goes here.');
        } 
```

It seems like an overkill for me, as my web app develops, and as I create more ajax calls. I'll be repeating this piece of code again and again.

Currently, the only idea I have in mind is creating a function that will work on top of AJAX, something like:

```
 function doAjax(type,url, data, moreVars) {
//this function is just a SIMPLE example, could be more complex and flexible.
        $.ajax({
            type: type,
            url: url,
            data: data,
            moreOptions:moreVars,
            //now handling all status code.
            statusCode: {
                //handle all HTTP errors from one place.
            }
        });
    }

    doAjax("POST", 'mydomain.com/login.php', dataObj); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-29T00:15:16.540

You can use [`$.ajaxSetup()`](http://api.jquery.com/jQuery.ajaxSetup/) to register global error state handlers.

> ***Description****: Set default values for future Ajax requests.*

Example:

```
$.ajaxSetup({
    statusCode: {
        500: function(data) {
            alert('Some friendly error message goes here.');
        } 
    }   
}); 
```

# html - 如何使 :after 箭头只是一个轮廓？

> ID：11705689
> 
> 赞同：9
> 
> 时间：2012-07-29T00:15:31.250
> 
> 标签：html, css, border

我看过大约一年半前在一个问题上发布的小提琴，我正在寻找一些帮助来完成对它的定制，使其符合我的要求。

[http://jsfiddle.net/hyH48/641/](http://jsfiddle.net/hyH48/641/)

有没有办法让底部的三角形只是三角形的边框而不是实心？还是我必须采取另一种方法才能达到这种效果。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-29T00:37:17.960

看看我做了什么：[**jsFiddle**](http://jsfiddle.net/hyH48/693/)。

您可以使用 :before 伪元素来执行三角形的边框，并使用 :after 来填充三角形。您只需对 :after 元素的位置和边框值进行一些调整，使其更小。

```
#mybox {
    width:200px;   
    height:30px;
    border-style:solid;
    border-width:thin;
    border-color:#000066;
    border-radius: 4px; 
    position:relative;
}

#mybox:after{ // Our small triangle to fill the space
    content:"";
    border-color: #fff transparent transparent;
    border-style:solid;
    border-width:9px; 
    width:0;
    height:0;
    position:absolute;
    bottom:-18px;
    left:21px
}

#mybox:before{
    content:"";
    border-color: #000066 transparent transparent;
    border-style:solid;
    border-width:10px;
    width:0;
    height:0;
    position:absolute;
    bottom:-20px;
    left:20px
}
​ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-29T00:32:48.807

看看这个小提琴 - [http://jsfiddle.net/hyH48/688/](http://jsfiddle.net/hyH48/688/)

我添加了另一个伪元素。我给了它与元素背景颜色相同的边框颜色，并放置在已经存在的元素之上。

这是 HTML 和 CSS，以防您看不到它：

HTML：

```
<div id="mybox">
    This will be my tooltip
</div>​ 
```

CSS：

```
#mybox {
    position: relative;
    width: XXXpx;   
    height: YYYpx;
    border: 1px solid #000;
    border-radius: 4px; 
    background-color: #fff;
}

#mybox:after,
#mybox:before {
    content: "";
    border-style: solid;
    border-width: 10px;
    width: 0;
    height: 0;
    position: absolute;
    top: 100%;
    left: 20px
}

#mybox:before {
    border-color: #000 transparent transparent; /*non transparent color same as #mybox's border-color*/
}

#mybox:after {
    margin-top: -2px;
    border-color: #fff transparent transparent; /*non transparent color same as #mybox's background-color*/
} 
```

# android - Android 如何从已知的 URI 中获取一首歌曲的 ID 信息

> ID：11705692
> 
> 赞同：6
> 
> 时间：2012-07-29T00:16:30.330
> 
> 标签：android, media-player, uri

我知道一首歌曲的URI。如何获取歌曲信息、主打歌等。

抱歉，我能找到的所有帖子都提供了一种索引整个库的方法，而不是如何获取单个已知 URI 歌曲的信息。这就是我用来获取 URI 的方法。audioID 存储在 SharedPrefs 中。谢谢

```
int REQUEST_MEDIA = 0;
String audioID;

Intent i = new Intent(Intent.ACTION_PICK, MediaStore.Audio.Media.EXTERNAL_CONTENT_URI);
        startActivityForResult(i, REQUEST_MEDIA);//REQUEST_MEDIA is some const int to operate with in onActivityResult
 if (requestCode == REQUEST_MEDIA && resultCode == RESULT_OK) {
        audioID = data.getDataString(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T19:10:56.150

我回答了自己的问题，希望这对将来的其他人有所帮助。

```
int REQUEST_MEDIA = 0;

SharedPreferences prefs;
String prefName = "MyPref";
String audioID, artist_name, artist_band;
Uri MyUri;

private OnClickListener startListener = new OnClickListener() {
    public void onClick(View v) {
        Intent i = new Intent(Intent.ACTION_PICK, MediaStore.Audio.Media.EXTERNAL_CONTENT_URI);
        startActivityForResult(i, REQUEST_MEDIA);//REQUEST_MEDIA is some const int to operate with in onActivityResult

    }
};

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == REQUEST_MEDIA && resultCode == RESULT_OK) {
        audioID = data.getDataString();
        MyUri = Uri.parse(audioID);
        String[] proj = { MediaStore.Audio.Media._ID,
                MediaStore.Audio.Media.DATA,
                MediaStore.Audio.Media.TITLE,
                MediaStore.Audio.Artists.ARTIST };

                Cursor tempCursor = managedQuery(MrUri,
                                            proj, null, null, null);

                tempCursor.moveToFirst(); //reset the cursor
                int col_index=-1;
                int numSongs=tempCursor.getCount();
                int currentNum=0;
                do{
                  col_index = tempCursor.getColumnIndexOrThrow(MediaStore.Audio.Media.TITLE);
                  artist_name = tempCursor.getString(col_index);
                  col_index = tempCursor.getColumnIndexOrThrow(MediaStore.Audio.Artists.ARTIST);
                  artist_band = tempCursor.getString(col_index);
                  //do something with artist name here
                  //we can also move into different columns to fetch the other values

                  currentNum++;
                }while(tempCursor.moveToNext());

  prefs = getSharedPreferences(prefName, MODE_PRIVATE);
SharedPreferences.Editor editor = prefs.edit();
editor.putString("alarm_selected", audioID);
editor.putString("alarm_name", artist_name);
editor.putString("alarm_band", artist_band);
editor.commit();    

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T12:54:40.803

不幸的是，上面的答案无法让我明白，但是我为仍在寻找的任何人发现了这一点。

```
//Some audio may be explicitly marked as not being music
String selection = MediaStore.Audio.Media.IS_MUSIC + " != 0";

String[] projection = {
    MediaStore.Audio.Media._ID,
    MediaStore.Audio.Media.ARTIST,
    MediaStore.Audio.Media.TITLE,
    MediaStore.Audio.Media.DATA,
    MediaStore.Audio.Media.DISPLAY_NAME,
    MediaStore.Audio.Media.DURATION
};

Cursor cursor = this.managedQuery(
    MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
    projection,
    selection,
    null,
    null);

private List<String> songs = new ArrayList<String>();
while(cursor.moveToNext()) {
    songs.add(cursor.getString(0) + "||" 
                + cursor.getString(1) + "||" 
                + cursor.getString(2) + "||"
                + cursor.getString(3) + "||"
                + cursor.getString(4) + "||" 
                + cursor.getString(5));

    //TO DISPLAY IN LISTVIEW 
    ListView lv = (ListView) findViewById(R.id.song_list);
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, songs);
    lv.setAdapter(adapter);

    cursor.close(); 
```

这段代码是来自这篇文章的礼貌在[这里:-)](https://stackoverflow.com/questions/13568798/list-all-music-in-mediastore-with-the-paths/13580655#13580655)

# php - Magento：为什么在这个变量中重复订购的项目？

> ID：11705694
> 
> 赞同：0
> 
> 时间：2012-07-29T00:16:45.490
> 
> 标签：php, magento

当我按订单号加载订单时，返回的数组包含两次相同的项目。

```
$order = Mage::getModel('sales/order')->loadByIncrementId(12345);
$orderItems = $order->getItemsCollection(); 
```

如果订单包含一项，则`count($orderItems)`2 并且每个数组索引中的内容都是相同的。这是怎么回事？

我也尝试了以下方法来加载订单，但它甚至无法在 Magento Enterprise 1.11.2.0 上运行。

```
$order = Mage::getModel('sales/order')->load(12345);
$orderItems = $order->getAllItems() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-27T09:54:17.863

如果您使用的是可配置产品，magento 会在 sales_flat_order_item 的数据库表中复制订单项目。

如果你使用 $order->getAllVisibleItems() 你会得到你想要的。

# javascript - 用函数覆盖 Javascript 属性

> ID：11705697
> 
> 赞同：1
> 
> 时间：2012-07-29T00:17:19.437
> 
> 标签：javascript

我想用一个函数覆盖一个对象属性，这样每当调用对象的属性时，它就会调用该函数并返回结果。

当然，这应该可以在动态语言（如 JS）中实现吗？

*语境：*

我正在尝试将一些仅限 IE 的代码移植到其他浏览器。该代码广泛使用“Microsoft.XMLDOM”对象来解析和查询 XML 文档。我想在非 IE 浏览器中使用标准的 DOMParser。问题是 Microsoft 实现为 XML 元素公开了一个非标准的“文本”属性，并且该属性在代码库中被广泛使用，我想在 Element 原型上添加一个等效函数。

```
Element.prototype.text = function() {...} 
```

不起作用，因为当代码库执行“myelem.text”时，它实际上并没有运行该函数，它只是返回一个指向它的指针。

我应该怎么做才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:36:22.640

在足够现代的 Javascript（例如 IE 以外的任何东西）中，[`Object.defineProperty`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperty)可以做到这一点。

```
Object.defineProperty(Element.prototype, 'text', {
    'get': function() {
        return this.getText();
    },
    'enumerable': true
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:49:44.703

如果您不需要函数的外部参数，您可以在定义它之后执行，如下所示：

```
Element.prototype.text = (function() {...})(); 
```

然后，调用后

```
Element.text 
```

您将从函数中获取返回值。

# wpf - 更改扩展器文本展开/折叠并具有不同的字体大小

> ID：11705706
> 
> 赞同：0
> 
> 时间：2012-07-29T00:20:34.507
> 
> 标签：wpf, xaml, collapse, expander

所以以下是第一部分：

```
<Expander>
<Expander.Style>
    <Style TargetType="Expander">
        <Setter Property="IsExpanded" Value="False" />
        <Setter Property="Header" Value="See More" />

        <Style.Triggers>
            <DataTrigger Binding="{Binding IsExpanded,RelativeSource={RelativeSource Self}}" Value="True">
                <Setter Property="Header" Value="See Less" />
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Expander.Style>
</Expander> 
```

但是如果我希望标题大小也为 16pt 怎么办？想不出正确的语法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:27:38.513

没有直接修改标头的方法。您只需要创建自定义模板来更改标题的属性。

但是我使用了一个简单的解决方法。您可以在触发器中更改完整扩展器的字体大小，例如`<Setter Property="FontSize" Value="16"/>`. 并将子字体大小显式设置为 12（或默认值），或者也可以将子字体大小绑定到扩展器的父字体大小。这将使扩展器子级保持为 12 或扩展器的父级字体大小，触发器不会对它们产生任何影响，因此只有标题会发生变化。

# sencha-touch-2 - 如何在视图中提供参数以查看和检索

> ID：11705710
> 
> 赞同：2
> 
> 时间：2012-07-29T00:21:46.783
> 
> 标签：sencha-touch-2

我在 Ext 中看到了一些示例（现在无法再次找到它），应该可以像我在下面的 push 函数中那样为视图提供参数。如果这在 Sencha 2 中也是可能的，我如何在视图中检索这个值？

```
var saveResponse = account.save({
      success: function(model, operation) {
          console.log('The Account was created, response: '+model);
          loginview.push({
              xtype: 'adultmenulist',
              adult: model
          });
      },
      failure: function(model, operation) {
          ....
      }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T15:13:08.187

我通常在我的自定义对象中创建一个函数，称为：`updateWithRecord`. 每当我推送对象时，我都会调用此方法，然后像这样继续推送它：

```
var record = Ext.create('MyApp.model.Adult', { firstName: 'Thomas', lastName: 'Vervik' });
this.getAdultMenuList().updateWithRecord(record);
this.getNav().push(this.getAdultMenuList()); 
```

请注意我如何将 MVC 引用用于我的详细信息页面和 NavigationView：

```
refs: {
    nav: {
        selector: 'mainnavigation',
        xtype: 'mainnavigation',
        autoCreate: true
    },
    adultMenuList: {
       selector: 'adultmenulist',
       xtype: 'adultmenulist',
       autoCreate: true
   }
} 
```

我的页面看起来像这样：

```
Ext.define('MyApp.view.AdultMenuList, {
   extend: 'Ext.Container',
   config: {
     items: [
        { xtype: 'label', name: 'firstName' }, { xtype: 'label', name: 'lastName' }
      ]
    },
    updateWithRecord: function(record) {
       this.down('label[name="firstName"]').setHtml(record.get('firstName'));
       this.down('label[name="lastName"]').setHtml(record.get('lastName'));
    }    
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:06:56.527

在您的任何控制器中，您只需要创建对您的视图的引用：

```
refs: {
    adultMenuList:'adultmenulist'
} 
```

然后，无论您想在控制器中的哪个位置，您都可以执行以下操作：

```
this.getAdultMenuList().getAdult(); 
```

为此，您`adultmenulist`需要添加`adult`在其配置中定义的参数：

```
Ext.define('MyApp.view.AdultMenuList, {
  extend: 'Ext.Container',
  config: {
    ...
    adult:null
  }    
}); 
```

希望这有帮助

# objective-c - 从启动服务中删除 URL 方案处理程序

> ID：11705712
> 
> 赞同：4
> 
> 时间：2012-07-29T00:21:48.033
> 
> 标签：objective-c, cocoa, plist, url-scheme, launch-services

我正在开发一个 Cocoa Mac 应用程序，它可以动态生成并注册自己的 URL 方案。但是，当应用程序注册自己以处理新生成的 URL 方案（例如 myscheme1423://）时，我想阻止应用程序响应任何以前注册的 URL 方案。

我`LSSetDefaultHandlerForURLScheme()`用于注册 URL 方案的目的；同时，应用程序会自动覆盖它的 Info.plist 以包含新方案。您可能知道，该`LSSetDefaultHandlerForURLScheme()`函数将给定的 bundleID/scheme 添加到 Launch Services 数据库中。但是，我找不到等效的启动服务函数来从数据库中删除相同的 bundleID/scheme 对。

我知道我可以简单地忽略源自 URL 方案的任何外部事件，而不是应用程序主动注册的那个，但我觉得应该有一种简单的方法来完全消除系统对以前的知识方案。如果我的应用程序通过数百次注册新方案的过程，就会出现一个点，即大量无意义的部分在磁盘上占用大量空间（至少对于 Plist 而言）数据（即旧的启动服务条目）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-01-17T04:13:32.787

我刚刚启动了一个操场并开始玩。这是完全没有记录的，但它似乎有效。

尝试传递`("None" as CFString)`的第二个参数

```
LSSetDefaultHandlerForURLScheme() 
```

# objective-c - 正在编辑不正确的 UITextfield

> ID：11705714
> 
> 赞同：1
> 
> 时间：2012-07-29T00:22:55.743
> 
> 标签：objective-c, ios, xcode, keyboard, uitextfield

我刚刚完成了制作自己的键盘的教程。所以我利用这些知识，制作了一个真正简单的应用程序，用我自己的键盘添加两个数字。这只是两个数字。但是当我点击一个文本字段时，另一个文本字段会被编辑！我已经附上了我的代码，任何帮助将不胜感激。感谢@spacious 之前的所有帮助。

```
#import "KeyPad2ViewController.h"

@interface KeyPad2ViewController ()
@property (nonatomic) BOOL userIsEnteringANumber;
@end

@implementation KeyPad2ViewController
@synthesize numberOne;
@synthesize numberTwo;
@synthesize result;
@synthesize keyPad;
@synthesize userIsEnteringANumber;
@synthesize currentTextField;

- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
if ([numberOne isFirstResponder]) 
{
    self.currentTextField = self.numberOne;
    self.userIsEnteringANumber = NO;
}
else if ([numberTwo isFirstResponder])
{
    self.currentTextField = self.numberTwo;
    self.userIsEnteringANumber = NO;
}
return YES;

}    

- (void)viewDidLoad
{
[super viewDidLoad];
[numberOne setInputView:keyPad];
[numberTwo setInputView:keyPad];
numberOne.delegate = self;
numberTwo.delegate = self;
// Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
[self setNumberOne:nil];
[self setNumberTwo:nil];
[self setResult:nil];
[self setKeyPad:nil];
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
} else {
    return YES;
}
}

- (IBAction)buttonPressed:(UIButton *)sender 
{
NSString *button = [sender currentTitle];
NSRange decimalpoint = [self.currentTextField.text rangeOfString:@"."];
if (self.userIsEnteringANumber)
{
    if ([button isEqualToString:@"."] && decimalpoint.location != NSNotFound)
    {
        self.currentTextField.text = self.currentTextField.text;
    }else 
        self.currentTextField.text = [self.currentTextField.text stringByAppendingString:button];
}else 
{
    self.currentTextField.text = button;
    self.userIsEnteringANumber = YES;
}
}

- (IBAction)backspacePressed:(UIButton *)sender 
{
if (self.userIsEnteringANumber)
{
    int positionOfDigitBeforeLastOne = self.currentTextField.text.length -1;
    if (self.currentTextField.text.length > 0)
    {
        self.currentTextField.text = [self.currentTextField.text substringToIndex:positionOfDigitBeforeLastOne];
    }
    if (self.currentTextField.text.length == 0)
        self.currentTextField.text = @"";
}
}

- (IBAction)clearPressed:(id)sender 
{
currentTextField.text = [NSString stringWithFormat:@""];
}

- (IBAction)enterPressed:(UIButton *)sender 
{
[self hideKeyPad];
}

- (IBAction)signPressed:(UIButton *)sender 
{
NSString *negativeNumber = @"-";
NSString *firstCharInDisplay = @"";
if (self.userIsEnteringANumber)
{
    firstCharInDisplay = [self.currentTextField.text substringToIndex:1];
    if ([firstCharInDisplay isEqualToString:@"-"])
    {
        self.currentTextField.text = [self.currentTextField.text substringFromIndex:1];
    }else {
        negativeNumber = [negativeNumber stringByAppendingString:self.currentTextField.text];
        self.currentTextField.text = negativeNumber;
    }
}
}

- (IBAction)add:(UIButton *)sender 
{
float a = [[numberOne text] floatValue];
float b = [[numberTwo text] floatValue];

float c = a + b;

[result setText:[NSString stringWithFormat:@"%.2f", c]];
}

- (void)showKeyPad
{
[UIView beginAnimations:@"animateView" context:nil];
[UIView setAnimationDuration:0.3];
CGRect keypadview = CGRectMake(0, 270, 320, 190); // puts keyboard on screen
keyPad.frame = keypadview;
keyPad.alpha = 1.0;
[UIView commitAnimations];

}

- (void)hideKeyPad
{
[UIView beginAnimations:@"animateView" context:nil];
[UIView setAnimationDuration:0.3];
CGRect keypadview = CGRectMake(0, 640, 320, 190);  // puts keyboard off screen
keyPad.frame = keypadview;
keyPad.alpha = 1.0;
[UIView commitAnimations];
}

@end 
```

我的 .h 文件是

```
#import <UIKit/UIKit.h>

@interface KeyPad2ViewController : UIViewController <UITextFieldDelegate>

@property (weak, nonatomic) IBOutlet UITextField *numberOne;
@property (weak, nonatomic) IBOutlet UITextField *numberTwo;
@property (weak, nonatomic) IBOutlet UILabel *result;
@property (strong, nonatomic) IBOutlet UIView *keyPad;
@property (weak, nonatomic) UITextField *currentTextField;

- (IBAction)buttonPressed:(UIButton *)sender;
- (IBAction)backspacePressed:(UIButton *)sender;
- (IBAction)clearPressed:(UIButton *)sender;
- (IBAction)enterPressed:(UIButton *)sender;
- (IBAction)octopusPressed:(UIButton *)sender;
- (IBAction)signPressed:(UIButton *)sender;
- (IBAction)add:(UIButton *)sender;

@end 
```

感谢任何和所有的帮助。这个网站真的是最好的！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T12:36:12.917

调用您的`textFieldShouldBeginEditing:`方法时，尚未将第一响应者设置为正确的字段。替换`textFieldShouldBeginEditing:`为`textFieldDidBeginEditing:`解决此问题。

# hadoop - 错误：失败的地图任务数超出了允许的限制。FailedCount: 1\. 关于在 Hadoop 上运行 Lucene 搜索

> ID：11705716
> 
> 赞同：0
> 
> 时间：2012-07-29T00:23:21.400
> 
> 标签：hadoop, lucene, hadoop-streaming

我使用一个大文本文件中的每条记录对 Lucene 的索引执行搜索，然后根据我的需要处理结果并写入输出。

我试图通过将大输入文本文件和预先创建的 Lucene 索引放到 Hadoop 的文件系统中来使用 Hadoop。然后我更改了执行文件处理（读取文件记录、在 Lucene 上搜索、写入输出）的 java 程序，以从 Hadoop 文件系统读取记录，并在内存中创建 Lucene 索引。我启动 Hadoop 作业的命令如下：

```
hadoop jar $HADOOP_HOME/contrib/streaming/hadoop-streaming-1.0.3.jar  
          -libjars lucene-core-3.6.0.jar,hadoop-core-1.0.3.jar,concept.jar 
          -mapper "java concept.HadoopConceptRunner" 
          -input myBigInputFile 
          -output myOutput  
          -reducer NONE 
```

请注意，“concept.jar”包含 concept.HadoopConceptRunner 类，这是由我编写的。

我的问题是我无法让这个 Hadoop 作业正确运行 =.="。我遇到了如下异常，我找不到任何其他有意义的东西可以帮助我解决这个问题。

```
Error: # of failed Map Tasks exceeded allowed limit. FailedCount: 1. 
```

和

```
java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T08:30:05.067

我认为您不应该调用 java 命令，而只提供要作为映射器运行的完全限定类名。如果映射器称为“java concept.HadoopConceptRunner”，我想它会出错，因为未定义类路径，因此找不到该类；）

所以简而言之，再试一次：

```
hadoop jar $HADOOP_HOME/contrib/streaming/hadoop-streaming-1.0.3.jar  
       -libjars lucene-core-3.6.0.jar,hadoop-core-1.0.3.jar,concept.jar 
       -mapper "concept.HadoopConceptRunner" 
       -input myBigInputFile 
       -output myOutput  
       -reducer NONE 
```

另外，我认为以下内容不太可能奏效

```
-reducer NONE 
```

你可以试试：

```
 -jobconf mapred.reduce.tasks=0 
```

# curl - 系统找不到 CURL 上指定的文件

> ID：11705717
> 
> 赞同：0
> 
> 时间：2012-07-29T00:23:26.180
> 
> 标签：curl

ALL，我正在尝试调查以下问题：

我尝试按如下方式运行 curl：

```
c:\libcurl\src\LIB-Debug>curl --verbose http://xxx.xxx.xxx.xxx/Default.aspx -F "MyFile=@11262716351.bmp;type=image/bitmap" 
```

我得到的回应是：“系统找不到指定的文件”。该文件肯定存在于当前目录中：

```
c:\libcurl\src\LIB-Debug>dir *.bmp
 Volume in drive C is Acer
 Volume Serial Number is 3613-CC24

 Directory of c:\libcurl\src\LIB-Debug

27.07.2012  16:03           129 222 11262716351.bmp
               1 File(s)        129 222 bytes
               0 Dir(s)  88 206 827 520 bytes free 
```

我究竟做错了什么？尝试谷歌并没有帮助，因为所有链接都涉及不同的问题。

谢谢你。

PS：我可以在pastebin中发布详细的输出以供审查...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:16:34.447

原来服务器上的服务已关闭。

谢谢你的聆听。

# ruby-on-rails - 模拟验证唯一性回调

> ID：11705719
> 
> 赞同：0
> 
> 时间：2012-07-29T00:23:38.157
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, rr

你如何模拟`validates :name, uniqueness: true`一个属性的回调？

我想它会像这样工作：

```
describe "with duplicate name" do
  before { mock(subject.name).unique? { false } }

  it "should be invalid" do
    subject.should have(1).error_on(:name)
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T13:05:06.410

为什么不使用[shoulda 匹配器](https://github.com/thoughtbot/shoulda-matchers/)？有了它，您可以使用诸如`it { should validate_uniqueness_of(:name) }`. 我发现它更具可读性，并且无需模拟回调和准备测试用例

# ruby-on-rails - 删除图标不做确认对话框

> ID：11705720
> 
> 赞同：1
> 
> 时间：2012-07-29T00:24:06.180
> 
> 标签：ruby-on-rails, ruby, destroy, button-to

我无法出现“确认”对话框。记录被删除，页面被更新，但没有确认对话框:(

```
= button_to('- - -', sched_set_path(sched_set_id), 
  :confirm => 'Are you sure you want to delete this schedule?', 
  :method => :delete, 
  :action => :delete, 
  :class=> 'delete_icon') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T19:48:56.150

请确保它`jquery_ujs.js`包含在您编译的 javascript 资产中。

# firefox - 如何在带有 Selenium 的 Firefox 中抑制“检查加载项的兼容性”对话框？

> ID：11705722
> 
> 赞同：4
> 
> 时间：2012-07-29T00:25:36.613
> 
> 标签：firefox, selenium, firefox-addon

自从更新到 Firefox 12 后，每次我使用 Selenium（在 python 和 Mac OS 10.7 中）启动具有特定配置文件的 Firefox 时，它都会弹出“检查加载项的兼容性”对话框，有时这个对话框会永远存在，我有强制退出它。强制退出后，Firefox 的新实例将继续启动并成功完成 Selenium 脚本的其余部分。

我尝试设置`extensions.checkCompatibility`为`false`. 如果我正常启动 Firefox，这会修复它，但如果我用 Selenium 启动它则不会。关于如何抑制此对话框的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T06:49:08.493

每当 Firefox 更新时，此对话框只会显示一次。每次都为您显示它的原因可能是 Selenium 每次都会创建一个新的配置文件。如果您将`extensions.lastAppVersion`首选项设置为`"12.0"`（或任何当前的 Firefox 版本），那么 Firefox 将不再认为它已更新并且不会显示此对话框。`extensions.showMismatchUI`但是，添加首选项并将其设置为应该更容易`false`，这将抑制此对话框（但不会抑制其他升级操作）。

*旁注*：`extensions.checkCompatibility`从 Firefox 3.6 开始，首选项不再做任何事情，它是当前 Firefox 版本中特定于版本的首选项。因此，您必须改为设置`extensions.checkCompatibility.12.0`首选项。但是，这会完全禁用扩展的兼容性检查，而不仅仅是您关心的对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T19:30:33.047

> 我尝试将 extensions.checkCompatibility 设置为 false。如果我正常启动 Firefox，这会修复它，但如果我用 Selenium 启动它则不会。

当您使用 Selenium 启动它时它不会的原因是 Firefox 驱动程序将在临时文件目录中创建一个临时配置文件，从而减慢测试速度并占用不必要的空间。

为您的测试目的创建配置文件并设置您需要的内容。创建 SeleniumProfile 的完整说明可以在[https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles找到](https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles)

在Java中，我有以下内容：

```
protected WebDriver createFirefoxDriver() {     
    File proFile = new File("C:\\Users\\<username>\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\xxxxxx42.SeleniumProfile");
    FirefoxProfile ffProfile = new FirefoxProfile(proFile);
    WebDriver ffDriver = new FirefoxDriver(ffProfile);

    return ffDriver;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T05:24:15.560

Do this to remove the **"checking for addon's compatibility"** Dialog. This is based on the Windows operating system..

Create a temporary FF Profile and start the server with that profileas shown below.

```
java -jar selenium-server-x.x.x.jar -firefoxProfileTemplate "/path/to/the/temp/profile" 
```

Now use the following code.

```
import com.thoughtworks.selenium.*;
public class Test {

public static void main(String ar[]) {

Selenium sel = new DefaultSelenium("localhost", 4444, "*firefox", "http://www.google.com/");

sel.start();
}
} 
```

Now in the Run command type "%TEMP%" and you can see there a folder with same name as the selenium session. Copy the folder contents and replace them with your temp profile Contents.

Follow the steps below to remove the Addons compatibility.
1 . Create a new FF Profile
2 . Set the FF Profile as per required settings
3 . Just run a sample program of selenium such that it invokes firefox.
4 . Now you can find a folder with the same name as Selenium Session created somewhere in your sytsem. ( Most probably in the directory where the Temporary Content is saved)
5 . Copy the folder contents and replace them with the newly created profile.

Now you can use the newly created profile whenever required. Whenever FF is updated , always check whether the existing addons are compatible with the Existing version by once invoking firefox with the Profile.

# javascript - .Net windows 应用程序 WebBrowser / Google Maps API v3

> ID：11705729
> 
> 赞同：3
> 
> 时间：2012-07-29T00:27:34.410
> 
> 标签：javascript, .net, visual-studio, maps, browser

我正在开发一个应用程序，用户可以在其中输入所需的地址，然后按下按钮。此地址将`WebBrowser`在 .net windows 应用程序的控件上找到。我知道您可以`WebBrowser`使用运行 javascripts，并通过...`WebBrowser1.DocumentText`调用脚本`WebBrowser1.Document.InvokeScript`

我对此有一些小问题，我想知道是否有人可以向我展示正确的方法来做到这一点。

**代码：**

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

  Dim AddressMap As String

  AddressMap = AddressM.Text

  WebBrowser1.DocumentText = "<html><head><meta name='viewport' content='initial-scale=1.0, user-scalable=no' />" & _
    "<script type='text/javascript' src='http://maps.google.com.mx/maps/api/js?sensor=true&language;=es'></script>" & _
    "<script type='text/javascript'>" & _
    "var geocoder; var map;" & _
    "function initialize() " & _
    "{geocoder = new google.maps.Geocoder(); var myOptions = { zoom: 16, mapTypeId: google.maps.MapTypeId.ROADMAP()" & _
    "} var(address = " & AddressMap & ")" & _
    "geocoder.geocode({ 'address': address }, function (results, status) {" & _
                    "if (status == google.maps.GeocoderStatus.OK) {" & _
                        "map.setCenter(results[0].geometry.location);" & _
                        "var marker = new google.maps.Marker({" & _
                           " map: map," & _
                            "position: results[0].geometry.location });" & _
                    "} else {" & _
                    "}});" & _
     "map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);}" & _
     "</script></head><div id='map_canvas' style='width:100%; height:100%'></div></body></html>"

   WebBrowser1.Document.InvokeScript("Initialize")

End Sub 
```

下面是我认为应该可以工作的另一段代码，但我仍然收到脚本错误“此页面上的脚本中发生错误”第 1 行字符 124 错误预期';' 代码 0 URL about.blank

```
 WebBrowser1.DocumentText = "<html><head><script type='text/javascript' src='http://maps.google.com.mx/maps/api/js?sensor=false&language;=es'></script> " +
                           "<script type='text/javascript'> " +
                           "var geocoder; " +
                           "var map; " +
                           "function initialize(address) { " +
                           "geocoder = new google.maps.Geocoder(); " +
                           "var myOptions = { zoom: 16 } " +
                           "geocoder.geocode({ 'address': address }, function (results, status) { map.setCenter(results[0].geometry.location); " +
                           "var marker = new google.maps.Marker({ map: map, position: results[0].geometry.location }); " +
                           "map = new google.maps.Map(document.getElementById('map_canvas'), myOptions); " +
                           "} " +
                           "</script> " +
                           "</head> " +
                           "<body> <div id='map_canvas' style='width:100%; height:100%'></div> </body> </html>"

WebBrowser1.Document.InvokeScript("initialize", New String() {AddressM.Text}) 
```

我非常感谢帮助

里奥·P。

这是另一段与前两段稍有不同的代码，它包括从实际运行谷歌地图脚本的 html 中提取的 if else 语句。

```
WebBrowser1.DocumentText = "<html><head><script type='text/javascript' src='http://maps.google.com.mx/maps/api/js?sensor=false&language;=es'></script> " +
                       "<script type='text/javascript'> " +
                       "var geocoder; " +
                       "var map; " +
                       "function initialize() { " +
                       "geocoder = new google.maps.Geocoder(); " +
                       "var myOptions = { zoom: 16, mapTypeId: google.maps.MapTypeId.ROADMAP } " +
                       "var(address = 'Miami Beach, Flordia') " +
                       "geocoder.geocode({ 'address': address }, " +
                       "function (results, status) { " +
                       "if (status == google.maps.GeocoderStatus.OK) { map.setCenter(results[0].geometry.location); " +
                       "var marker = new google.maps.Marker({ map: map, position: results[0].geometry.location }); " +
                       "} else { alert('Geocode was not successful !);}}); " +
                       "map = new google.maps.Map(document.getElementById('map_canvas'), myOptions); } " +
                       "</script> " +
                       "</head> " +
                       "<body> <div id='map_canvas' style='width:100%; height:100%'></div> </body> </html>"

        WebBrowser1.Document.InvokeScript("initialize") 
```

html代码如下

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<script type="text/javascript" src="http://maps.google.com.mx/maps/api/js?sensor=true&language=es"></script>
<script type="text/javascript">

    var geocoder;
    var map;

    function initialize() {

        geocoder = new google.maps.Geocoder();

        var myOptions = {
            zoom: 16,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        //var address = document.getElementById("address").value;
        var address = "Miami Beach, Flordia" //change the address in order to search the google maps

        geocoder.geocode({ 'address': address }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });
            } else {
                alert("Geocode was not successful for the following reason: " + status);
            }
        });

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    }

    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>

  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:42:08.780

放置解决方案

**HTML**

在 C:\page.html 中创建页面 html 并使用此代码

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<script type="text/javascript" src="http://maps.google.com.mx/maps/api/js?sensor=true&language=es"></script>
<script type="text/javascript">

    var geocoder;
    var map;

    function initialize(address) {

        geocoder = new google.maps.Geocoder();

        var myOptions = {
            zoom: 16,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }

        geocoder.geocode({ 'address': (address ? address : "Miami Beach, Flordia")}, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location
                });
            } else {
                alert("Geocode was not successful for the following reason: " + status);
            }
        });

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    }

    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>

  </body>
</html> 
```

**Windows 窗体 - C#**

```
private void Form1_Load(object sender, EventArgs e)
{
    // Put uri (http://www.example.com/page.html and c:\page.html is valid address)
    webBrowser1.Url = new Uri(@"C:\page.html");
}

private void button1_Click(object sender, EventArgs e)
{
    webBrowser1.Document.InvokeScript("initialize", 
            new string[] { textBox1.Text });
} 
```

并且需要具有此名称的组件的表单`textBox1`：`button1`和`webBrowser1`。

# python - 计算吸收马尔可夫链的基本矩阵的最佳方法？

> ID：11705733
> 
> 赞同：12
> 
> 时间：2012-07-29T00:29:51.760
> 
> 标签：python, algorithm, math, sparse-matrix, markov-chains

我有一个非常大的吸收马尔可夫链（扩展到问题规模——从 10 个状态到数百万个）非常稀疏（大多数状态只能对 4 或 5 个其他状态做出反应）。

我需要计算该链的基本矩阵的一行（给定一个起始状态的每个状态的平均频率）。

通常，我会通过计算来做到这一点`(I - Q)^(-1)`，但我一直无法找到一个实现稀疏矩阵逆算法的好库！我看过一些关于它的论文，其中大多数是博士水平的工作。

我的大部分谷歌结果都指向我的帖子，这些帖子讨论了在求解线性（或非线性）方程组时如何不应该使用矩阵逆......我觉得这不是特别有用。基本矩阵的计算是否类似于求解方程组，而我根本不知道如何以另一种形式表示？

所以，我提出两个具体问题：

**计算稀疏矩阵逆矩阵的一行（或所有行）的最佳方法是什么？**

或者

**计算大型吸收马尔可夫链的基本矩阵行的最佳方法是什么？**

Python 解决方案会很棒（因为我的项目目前仍然是一个概念验证），但是如果我不得不用一些好的 Fortran 或 C 来弄脏我的手，那不是问题。

编辑：我刚刚意识到矩阵 A 的逆 B 可以定义为 AB=I，其中 I 是单位矩阵。这可能允许我使用一些标准的稀疏矩阵求解器来计算逆......我必须跑掉，所以请随意完成我的思路，我开始认为这可能只需要一个真正的基本矩阵财产...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-15T13:38:02.380

假设您要做的是计算出[吸收之前的预期步数](http://en.wikipedia.org/wiki/Absorbing_Markov_chain#Expected_number_of_steps)，那么维基百科上转载的“有限马尔可夫链”（Kemeny 和 Snell）的方程式是：

![t=N1](../Images/62b6c00644cf6cfd73c8c87e9f778624.png)

或扩展基本矩阵

![t=(智商)^-1 1](../Images/43e47af042b49f44c4268cbebba1d865.png)

重新排列：

![(智商) t = 1](../Images/e7175be91e55ee944af5695e919c638d.png)

这是使用函数求解线性方程组的标准格式

![A x = b](../Images/f3169d55bc0367a50afcb5d23f95d57a.png)

将其付诸实践以展示性能差异（即使对于比您描述的系统小得多的系统）。

```
import networkx as nx
import numpy

def example(n):
    """Generate a very simple transition matrix from a directed graph
    """
    g = nx.DiGraph()
    for i in xrange(n-1):
        g.add_edge(i+1, i)
        g.add_edge(i, i+1)
    g.add_edge(n-1, n)
    g.add_edge(n, n)
    m = nx.to_numpy_matrix(g)
    # normalize rows to ensure m is a valid right stochastic matrix
    m = m / numpy.sum(m, axis=1)
    return m 
```

介绍计算预期步数的两种替代方法。

```
def expected_steps_fundamental(Q):
    I = numpy.identity(Q.shape[0])
    N = numpy.linalg.inv(I - Q)
    o = numpy.ones(Q.shape[0])
    numpy.dot(N,o)

def expected_steps_fast(Q):
    I = numpy.identity(Q.shape[0])
    o = numpy.ones(Q.shape[0])
    numpy.linalg.solve(I-Q, o) 
```

选择一个足够大的示例来演示计算基本矩阵时出现的问题类型：

```
P = example(2000)
# drop the absorbing state
Q = P[:-1,:-1] 
```

产生以下时序：

```
%timeit expected_steps_fundamental(Q)
1 loops, best of 3: 7.27 s per loop 
```

和：

```
%timeit expected_steps_fast(Q)
10 loops, best of 3: 83.6 ms per loop 
```

需要进一步的实验来测试稀疏矩阵的性能影响，但很明显，计算逆矩阵比您预期的要慢得多。

与此处介绍的方法类似的方法也可用于步骤数的方差

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T15:34:01.150

您得到建议不要使用矩阵求逆来求解方程的原因是因为数值稳定性。当您的矩阵具有零或接近零的特征值时，您会因缺乏逆（如果为零）或数值稳定性（如果接近零）而遇到问题。那么，解决这个问题的方法是使用一种不需要逆存在的算法。解决方法是使用[高斯消元](http://en.wikipedia.org/wiki/Gaussian_elimination)法。这并没有提供完整的逆，而是让您进入行梯形形式，即上三角形形式的推广。如果矩阵是可逆的，则结果矩阵的最后一行包含逆矩阵。因此，只需安排您消除的最后一行是您想要的行。

我会让你明白为什么`I-Q`总是可逆的。

# mysql - mysql_result()：提供的参数不是有效的 MySQL 结果资源

> ID：11705736
> 
> 赞同：-1
> 
> 时间：2012-07-29T00:30:11.763
> 
> 标签：mysql

> **可能重复：**
> [警告：mysql_fetch_array()：提供的参数不是有效的 MySQL 结果](https://stackoverflow.com/questions/795746/warning-mysql-fetch-array-supplied-argument-is-not-a-valid-mysql-result)

```
return (mysql_result(mysql_query("SELECT COUNT (`user_id`) FROM `users` WHERE `user_id` = $user_id AND `type` = 1"), 0) == 1) ? true :false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:36:24.683

尝试这个：

```
<?php
$result = mysql_query("SELECT COUNT (`user_id`) FROM `users` WHERE `user_id` = $user_id AND `type` = 1");

if (!$result) {
 die(mysql_error());
}

return (mysql_result($result, 0) == 1) ? true :false; 
```

至少你会看到错误。

不要假设查询总是运行正常，检查错误。不要将所有内容放在一行中，这会使代码难以阅读。另外：请务必在您的情况下使用[mysql_real_escape_string正确转义输入。](http://php.net/manual/es/function.mysql-real-escape-string.php)

另外，[检查这里](https://stackoverflow.com/questions/1756743/how-to-loop-through-a-mysql-result-set/1756799#1756799)

# parsing - 使用柠檬解析器生成器的“预期令牌”

> ID：11705737
> 
> 赞同：5
> 
> 时间：2012-07-29T00:30:22.147
> 
> 标签：parsing, generator, lemon

发生语法错误时，是否有一种已知的方法可以生成“预期令牌”列表？我使用 Lemon 作为解析器生成器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-22T11:04:18.857

这似乎有效：

```
%syntax_error { 
        int n = sizeof(yyTokenName) / sizeof(yyTokenName[0]);
        for (int i = 0; i < n; ++i) {
                int a = yy_find_shift_action(yypParser, (YYCODETYPE)i);
                if (a < YYNSTATE + YYNRULE) {
                        printf("possible token: %s\n", yyTokenName[i]);
                }
        }
} 
```

它尝试所有可能的标记并打印那些适用于当前解析器状态的标记。

请注意，当出现不正确的标记时，解析器不会立即调用 syntax_error，但它会尝试减少堆栈上的内容，希望之后可以移动标记。只有当没有其他东西可以减少并且当前标记不能移动时，解析器才会调用syntax_error。缩减将更改解析器状态，这意味着您可能会看到比缩减之前适用的令牌更少。不过，它应该足以用于错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T13:13:45.313

在 Lemon 中没有直接的方法来生成这样的列表。但是您可以尝试使用 Lemon 工具的调试输出和生成的解析器的调试跟踪来执行此操作。在调用 ParseTrace 函数生成解析器打印 Shift 和 Reduces 列表后，它适用于输入流。语法错误之前的最后一个 Shift 包含错误之前的当前状态数。在您的解析器的 *.out 文件中找到此状态，并查看它的预期标记列表。

# java - EMR - Hive 和 Java 结合在一起

> ID：11705739
> 
> 赞同：1
> 
> 时间：2012-07-29T00:30:56.210
> 
> 标签：java, hive, emr

我正在使用 Amazon Elastic-Map-Reduce。是否可以运行使用 java 代码（使用转换功能）的 HIVE 查询？

当我创建一个新的工作流程时，我需要在自定义 jar 和配置单元程序之间进行选择，而我需要两者...

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:40:47.763

是的，通过编写您自己的 UDF（用户定义函数）。只需扩展一个[org.apache.hadoop.hive.ql.udf.generic](http://hive.apache.org/docs/current/api/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.html)类并像使用任何其他 UDF JAR 一样使用您的 JAR（在顶部导入，调用函数）。

有关教程，请参阅[http://dev.bizo.com/2009/06/custom-udfs-and-hive.html](http://dev.bizo.com/2009/06/custom-udfs-and-hive.html)。

# api - 如何在api中更改windows皮肤

> ID：11705740
> 
> 赞同：-1
> 
> 时间：2012-07-29T00:31:23.167
> 
> 标签：api, skinning

我真的很想知道winamp是怎么做到的。我试图更改绘图代码以在 ncpaint 的标题栏上绘图。它运行良好，但它很复杂并且没有绘制，选择另一个窗口。我搜索了一些源代码或文章，但他们使用了其他方式......我该怎么做？......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T00:40:15.860

好吧，Winamp 只是创建了一个无边框、无装饰的窗口，并自己绘制所有内容。重要的是，您仍然可以将系统菜单附加到窗口，以便右键单击任务栏按钮提供通常的选项。

如果你想变得花哨，你可以处理 WM_NCPAINT 消息以在装饰窗口上自己执行框架和标题绘制：http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd145212(v=vs. 85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145212(v=vs.85).aspx)

但实际上更简单的解决方案是模拟标准的 Windows 装饰并合成标准按钮执行的事件。

# reference - 在 Lua 中使用 Metatables 时，我有没有办法确定该值是被设置还是被检索？

> ID：11705742
> 
> 赞同：0
> 
> 时间：2012-07-29T00:32:09.813
> 
> 标签：reference, lua, metatable

我在脚本中设置了一个“psuedo-oop”系统，让我可以更好地与应用程序中的 UserData 进行交互。我的系统工作得非常好，只是它不传递引用，而是传递值。因此，如果我这样说：

`World.Body.Parent=World.Body2`

实际上什么都没有发生，因为它实际上从未将`Body`s 父级设置为另一个主体。相反，它有点简化为：

`World=World.Body2`

（因为它是返回`World`的父级`Body`）。现在，如果我做这样的事情，另一方面：

`print(World.Body.Parent.Type)`

==>`World`

因为它正确地获得了`World`对象（作为 的父级`Body`）。

现在考虑到这一切，是否有某种方法可以确保它通过引用传递而不是实际发送对象？任何想法，将不胜感激！

这是我正在使用的相关源代码：

```
local target=_G

function AddService(service)
    Blank=(function(...) return end)
    CreateTemporaryIndex=(function(obj)
        local env_meta={
            __index=(function(this, key)
                if obj[key]~=nil and obj[key]~=key then
                    if type(obj[key]) ~= "userdata" then
                        return obj[key]
                    else
                        local r,i=pcall(function() Blank(obj[key].Type) end)
                        if r then
                            return CreateTemporaryIndex(obj[key])
                        else
                            return (function(...) local arg={...} table.remove(arg,1) return obj[key](obj,unpack(arg)) end)
                        end
                    end
                else
                    local ofObj=obj:Child(key)
                    if ofObj~=nil then
                        return CreateTemporaryIndex(ofObj)
                    end
                end
                return nil
            end)
        }
        local nRe={}
        setmetatable(nRe,env_meta)
        return nRe
    end)
    target[service.Name]=CreateTemporaryIndex(service)
end

AddService(__Environment.World)
AddService(__Environment.Players)
AddService(__Environment.Lighting)
AddService(__Environment.Environment) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T04:53:05.943

__index 元[方法仅在访问属性时被调用](http://www.lua.org/manual/5.2/manual.html#2.4)。为了实现自定义设置器，您还需要定义**__newindex**元方法。您可以在我链接到的 Lua 手册部分找到更多信息。

也就是说，如果我是你，我会再次考虑是否真的需要所有这些代理表复杂性。对于您可能没有涵盖的小角落案例之一的示例，除非您也添加 __ipairs 和 __pairs 元方法，否则使用对和 ipairs 迭代您的环境将失败。

# php - 正则表达式php解析文件

> ID：11705743
> 
> 赞同：1
> 
> 时间：2012-07-29T00:32:11.723
> 
> 标签：php, regex

我想解析一个文件，并将其存储到一个`Array`in 中`PHP`。但是，有一些规则应该遵守：

*   (p="value") 应该被忽略，但`"value"`应该保留。
*   `-`应该被忽略。
*   应该忽略空格。
*   `\t`由和分割`\n`。

示例字符串是：

```
NPD4196-2a_5_0
Geldanamycin - 0.166516 (p = 0.0068)    Alamethicin - 0.158302 (p = 0.0206)     4-Hydroxytamoxifen - 0.1429 (p = 0.0183)        Abietic acid - 0.133045 (p = 0.0203)    Caspofungin - 0.130885 (p = 0.0432)     Extract 00-303C - 0.12858 (p = 0.0356)  U73122 - 0.113274 (p = 0.0482)  Radicicol - 0.10213 (p = 0.0356)        Calcium ionophore - 0.096183 (p = 0.0262) 
```

因此，目标是生成如下数据结构：

```
Array('NPD4196-2a_5_0' => Array(Array( 0 => 'Geldanamycin', 1 => '0.166516', 2 => '0.0068'), Array( ... )); 
```

到目前为止我已经写了这个...

```
while(($line = fgets($fp)) !== false){
        $args = preg_split( '/[\t\n (=) ]+/', $line, -1, PREG_SPLIT_NO_EMPTY );
        if(count($args)){
           print_r($args);
           print "\n";
        }
} 
```

为了实现我的目标，我在其他方面缺少什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:45:33.937

`(.+?)-\s*([\d\.]+)\s*\(p\s*=\s*([\d\.]+)\)`

这将获取第 1 组中的元素（例如**格尔德霉素**）、第 2 组中的相关值和第 3 组中的 p 值。

[在这里玩正则表达式](http://regexr.com?31lsn)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T00:58:20.523

这似乎适用于一个键值对（假设 NPD4196-2a_5_0 是您示例中的键，第二行是值）。

```
<?php

$fp = fopen('foo.txt', 'r');
$regex = '/(\w*)\s*-\s*([\d\.]+)\s*\(p\s*=\s*([\d\.]+)\)/';
$id = "NO ID";
$result = Array();

while(($line = fgets($fp)) !== false){
    if (!preg_match($regex, $line)) {
        $id = chop($line);
    } else {
        $all = Array();

        while (preg_match($regex, $line, $matches, PREG_OFFSET_CAPTURE)) {
            $last = end($matches);
            $line = substr($line, $last[1] + strlen($last[0]) + 1);

            $strings = Array();

            for ($i = 1; $i < 4; $i++) {
                array_push($strings, $matches[$i][0]);
            }

            array_push($all, $strings);
        }

        $result[$id] = $all;
    }
}

print_r($result);
?> 
```

（这是 David B 的正则表达式的略微编辑版本。）

如果该行与那个长 RegEx 模式不匹配，它将将该行存储为 ID。否则，它将匹配正则表达式，然后将匹配的部分切掉。内部 while 循环的每次迭代都将匹配一个条目。由于我正在获取匹配项的索引，因此 for 循环仅用于将字符串添加到结果中。

这打印：

```
Array
(
    [NPD4196-2a_5_0] => Array
        (
            [0] => Array
                (
                    [0] => Geldanamycin
                    [1] => 0.166516
                    [2] => 0.0068
                )

            [1] => Array
                (
                    [0] => Alamethicin
                    [1] => 0.158302
                    [2] => 0.0206
                )

            [2] => Array
                (
                    [0] => Hydroxytamoxifen
                    [1] => 0.1429
                    [2] => 0.0183
                )
... 
```

# php - 在 php/wordpress 中将锚点 href 与 img src 交换

> ID：11705744
> 
> 赞同：0
> 
> 时间：2012-07-29T00:32:26.497
> 
> 标签：php, regex, image, wordpress, anchor

我有一个非常图像重的 wordpress 主题。图像被包裹在我需要直接链接到文件的锚标记中。这是一个示例图像的标记：

```
<a href="Link_to_attachment_page" ><img src="Direct_link_to_file"></a> 
```

我需要的是它的格式如下：

```
 <a href="Direct_link_to_file" rel="shadowbox"><img src="Direct_link_to_file"></a> 
```

编辑：没有写完就意外发表了。

到目前为止，我有一个 preg_match_all 获取页面上每个图像的 src 并将其存储在一个数组中。像这样：

```
preg_match_all("/<img .*?(?=src)src=\"([^\"]+)\"/si", $content, $m); 
```

我接下来做的是在循环中使用 preg_replace 将每个锚标记的 href 更改为数组中相应的 src：

```
for($k = 0; $k <$length; $k++){
   $pattern ="/<a(.*?)href=('|\")(.*?).(bmp|gif|jpeg|jpg|png)('|\")(.*?)>/i";
   $replacement = '<a$1 rel="shadowbox" href="'.$m[1][$k].'"$2$3.$4$5>';
   $content = preg_replace($pattern, $replacement, $content);
   } 
```

现在，这成功地将 href 设置为存储在数组中的值。但是它将每个href设置为相同的图像（最后一个）。所以这就是我卡住的地方。现在怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T02:05:26.227

不知道我是否在这里说明了显而易见的事情，但你知道为什么它将它设置为数组中的最后一个吗？问题是这一行：

```
$content = preg_replace($pattern, $replacement, $content); 
```

每次您在循环中调用它时，它都会将您的所有 href 标记替换为 $m[1][$k] 的当前值。因此，在循环的每次迭代结束时，您的 href 都将设置为与循环的该迭代相对应的图像。因此，为什么最终结果都包含与循环的最后一次迭代相对应的图像。

可能的解决方案：

preg_replace 有一个“限制”参数，您可以将其设置为 1，以确保每次仅进行 1 次替换。如果您可以使您的 $pattern 与已替换的 href 不匹配，那么这应该可以解决您的问题。

如果没有，mario 的 'preg_replace_callback' 解决方案应该可以工作。要查看如何在 preg_replace_callback 中检查您要替换的实例，请参阅以下问题：[我能否以某种方式知道在 preg_replace_callback 的回调中发生了哪个替换？](https://stackoverflow.com/questions/2482493/can-i-somehow-know-which-replacement-is-taking-place-from-within-a-callback-of-p)

知道了这一点，您可以访问 $m 数组中的适当元素。

# asp.net-mvc - MVC 未定义键

> ID：11705750
> 
> 赞同：1
> 
> 时间：2012-07-29T00:33:39.570
> 
> 标签：asp.net-mvc

我在我的 MVC 应用程序中收到此错误：

`One or more validation errors were detected during model generation:`

```
System.Data.Edm.EdmEntityType: : EntityType 'CustomerModel' has no key defined. Define the key for this EntityType.
System.Data.Edm.EdmEntitySet: EntityType: EntitySet �Customer� is based on type �CustomerModel� that has no keys defined. 
```

我的客户模型如下所示：

```
public class CustomerModel
{
    public string Name { get; set; }
    public int CustomerID { get; set; }
    public string Address { get; set; }
}

public class CustomerContext : DbContext
{
    public DbSet<CustomerModel> Customer { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-29T00:43:29.183

默认情况下，Entity Framework 假定模型类中存在一个名为 Id 的关键属性。您的关键属性称为 CustomerID，因此实体框架找不到它。

将您的关键属性的名称从 CustomerID 更改为 Id，或者使用**Key**属性装饰 CustomerID属性：

```
public class CustomerModel
{
    public string Name { get; set; }

    [Key]
    public int CustomerID { get; set; }

    public string Address { get; set; }
}

public class CustomerContext : DbContext
{
    public DbSet<CustomerModel> Customer { get; set; }
} 
```

# java - SharedPreferences 变量无法正常工作

> ID：11705752
> 
> 赞同：0
> 
> 时间：2012-07-29T00:35:06.037
> 
> 标签：java, android, eclipse

每次在名为 GameActivity 的类中重新创建活动时，我都会尝试存储一个值以保持分数。我将以下代码放入我的`onCreate()`方法中：

```
SharedPreferences settings = getSharedPreferences("Score", 0);
    int lastscore = settings.getInt("Score", 0 );
    score=lastscore;
    mScoreView.setText("Score: "+ score); 
```

`mScoreView`是一个 TextView 对象，假设每次重新创建活动时都会使用当前分数进行更新，`score`是一个实例变量。我有一个按钮，它会在每个游戏结束时弹出，让用户通过重新创建活动来继续玩。这是该按钮的点击监听器：

```
private class MyButtonListener2 implements OnClickListener {

    public void onClick(View v) {
        State player = mGameView.getCurrentPlayer();
        Bundle myBundle=new Bundle();
          firstGame=false;

        if (player == State.WIN) {
            if(player==State.WIN){
                SharedPreferences scoreSaved = getSharedPreferences("Score",0);
                SharedPreferences.Editor edit = scoreSaved.edit();
                edit.putInt("Score", score++);
                edit.commit();
                //onCreate(myBundle);
        }
            else{
                myBundle.putInt("score1", 0);
                //onCreate(myBundle);
            }
                 GameActivity.this.recreate();
                 onCreate(myBundle);
}} 
```

假设每次游戏以人类玩家获胜（State.WIN）结束时，分数就会增加一。但是，分数没有正确更新。我无法捕捉到错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:03:32.360

采用：

```
edit.putInt("Score", ++score); 
```

或者

```
edit.putInt("Score", score + 1); 
```

# android - 禁用 HOME 按钮

> ID：11705753
> 
> 赞同：-1
> 
> 时间：2012-07-29T00:35:19.600
> 
> 标签：android, android-homebutton

我有一个输入密码对话框，它是 Theme.Dialog 主题中的一个活动，所以它实际上看起来像一个 AlertDialog，因为我必须在广播接收器中使用它，但问题是我想阻止 HOME 按钮，因为我需要它安全应用程序，当我使用它时阻止 HOME 按钮起作用

```
@Override
public void onAttachedToWindow()
{  
    this.getWindow().setType(WindowManager.LayoutParams.TYPE_KEYGUARD);
    super.onAttachedToWindow();  
} 
```

但是如果单击按钮后密码错误，它不会重新启动我的 PasswordDialog 活动，有什么建议吗？

验证码：

```
login.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {

        password = inputPassword.getText().toString();               
        final String SHA1hash = PhysicalTheftPassword.getSHA1(password); 

        if (correctSHA1.equals(SHA1hash)) {

            //SharedPreferences sp = getSharedPreferences("isPhysicalTheftEnabled", MODE_WORLD_READABLE);
            //SharedPreferences.Editor ed = sp.edit();
            //ed.putBoolean("isPhysicalTheftEnabled", false);
            //ed.commit();

            Toast.makeText(PhysicalTheftDialog.this, "Correct", Toast.LENGTH_LONG).show();
            finish();   
            stopService(new Intent(PhysicalTheftDialog.this, MyService.class));
            Log.v(TAG, "SHA1 Hash:" + SHA1hash);
            Log.v(TAG, "Correct SHA1:" + correctSHA1);
        }
        else {
            Toast.makeText(PhysicalTheftDialog.this, "Wrong", Toast.LENGTH_LONG).show();
            Intent Act2Intent = new Intent(PhysicalTheftDialog.this, PhysicalTheftDialog.class);              
            finish();
            startActivity(Act2Intent);
            Log.v(TAG, "SHA1 Hash:" + SHA1hash);
            Log.v(TAG, "Correct SHA1:" + correctSHA1);

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:50:51.640

这似乎更像是您在对话框输入按钮上使用的验证问题。而不是在标题状态下无法按下主页按钮。

如果您发布您正在使用的代码，也许我们可以提供帮助。理想情况下，如果密码不正确，您想要做的不是关闭对话框，这样就不需要重新显示它，因为它仍然会显示。

同样提醒一下，没有官方支持的方式来抑制公共 API 中的主页按钮。您用来执行此操作的方法已在较新版本的 Android 中修复，并且不再有效。

**编辑：** 我有两个建议

如果删除这 3 行：

```
Intent Act2Intent = new Intent(PhysicalTheftDialog.this, PhysicalTheftDialog.class);              
finish();
startActivity(Act2Intent); 
```

在`Wrong`if 语句的分支内，对话框应在屏幕上保持可见，等待用户重试。你可以做这样的事情而不是这 3 行：

```
password.setText(""); 
```

这将为他们清除密码 EditText，因此他们在重试时不必退格以清除旧的（不正确的）密码。

我的另一个建议是，尝试将这 3 行的顺序更改为：

```
Intent Act2Intent = new Intent(PhysicalTheftDialog.this, PhysicalTheftDialog.class);              
startActivity(Act2Intent);
finish(); 
```

老实说，即使没有主页按钮抑制位，如果这确实适用于您拥有它们的顺序，我会感到有点惊讶。调用完成将（我认为）不允许执行之后发生的任何代码（在这种情况下为），因为一旦您调用通过*在完成之前*`startActivity();`调用，您的活动就会消失，它应该允许它正确执行。`finish()``startActivity()`

 *如果是我，我会努力让它按照我作为第一个建议发布的方式工作。简单地让当前密码对话框显示等待另一次尝试，而不是隐藏它，然后显示同一事物的新实例。*

# javascript - 使用 Javascript 下载 .wav 或 .mp3

> ID：11705754
> 
> 赞同：2
> 
> 时间：2012-07-29T00:35:22.347
> 
> 标签：javascript, download, wav

我需要在我的网站页面上有一个链接来下载声音文件。我知道，如果您将链接指向一个 .doc 文件，它将打开一个空白页面并下载该文件（因为浏览器无法读取该文件），但这不适用于声音文件 - 它们是用浏览器中的媒体播放器。如何自动下载此文件而不是在浏览器中打开它？

这是在 Chrome 中，如果这有所作为。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-08-30T11:46:07.333

```
<a href='file.mp3' download='Very-Very-Good.mp3'>download</a> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-07-29T01:04:37.030

```
<a href="javascript:window.open('song.mp3')">DownLoad Song</a> 
```

# c# - 在 Visual Studio C# 中，如何将桌面背景更改为资源中的图像

> ID：11705755
> 
> 赞同：1
> 
> 时间：2012-07-29T00:35:22.077
> 
> 标签：c#, image, desktop

我正在尝试学习 C#，我想知道如何制作一个小程序来将桌面背景更改为我嵌入资源中的图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:45:29.297

**首先**从您的资源中获取图像：

```
var bmp = new Bitmap(
                   System.Reflection.Assembly.GetEntryAssembly().
                   GetManifestResourceStream("MyProject.Resources.myimage.png")); 
```

或者

```
var bmp = new Bitmap(WindowsFormsApplication1.Properties.Resources.myimage); 
```

**第二个**保存图像以使用[`Image.Save`](http://msdn.microsoft.com/en-us/library/9t4syfhh.aspx).

**最后**使用 SO 帖子中的此代码更改桌面背景：

*   [使用 .NET 中的代码更改桌面墙纸](https://stackoverflow.com/a/1061682/1495442)

# ios - iOS：解析框架和 Facebook OpenGraph

> ID：11705756
> 
> 赞同：0
> 
> 时间：2012-07-29T00:35:30.173
> 
> 标签：ios, facebook, facebook-opengraph, parse-framework

有没有人使用 Parse (www.parse.com) 框架作为后端将 Facebook OpenGraph 集成到您的 iOS 应用程序中？

**我的目标只是使用 OpenGraph 从我的 iPhone 应用程序将图像发布到 Facebook**。据我所知，FB 不会自己托管照片——令人惊讶的是——所以我假设我需要自己的后端（或者在这种情况下是 Parse）。（如果我对此有误解，请纠正我！）

我在最后一天的大部分时间都在试验 Facebook 框架，**我计划在应用程序中将 Parse 用于我的大部分 Web 服务，所以理想情况下我会同时利用这两者，**而**不是引入单独的后端/Web**服务（例如 Heroku/ Rails）仅用于简单的图像托管。

..但无论哪种方式，我都担心可能会在试图实施一些永远不会奏效的东西时迷失方向——网络技术不是我的强项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T22:55:51.630

实际上，我在旧金山的 Parse.com 公司活动中得到了这个答案，从那时起，我也学到了很多关于 Facebook 集成和发布的知识。

**长话短说：如果您想发布 Facebook Open Graph Stories，Parse.com 不能作为您网络堆栈中的唯一对象。**

除了简单地托管图像外，Facebook Open Graph Stories 还需要两件事：

1.  Facebook 服务器可以访问的公共 HTML 页面。此页面提供 Facebook 元数据，Facebook 使用这些元数据来确定如何呈现您的图像对象。
2.  指向包含您的图像对象的登录页面的点击链接。

我最终使用 Tumblr 博客来托管我的照片，因为您可以“破解”他们的主题以包含您自己的支持 FB OG Stories 的 HTML 标题。它并不完美，但对于没有网络堆栈的人来说，它可以完成工作！

# iphone - UIScrollView 转场

> ID：11705757
> 
> 赞同：0
> 
> 时间：2012-07-29T00:35:59.190
> 
> 标签：iphone, objective-c, ios, cocoa-touch, ipad

我已经用 UIPageControl 和 UIViewController 实现了一个 UIScrollView ，它有一个带有 segue 的 UIButton ，当我单击 UIButton 时出现 segue 但在 ScrollView 内部没有填满全屏的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T02:32:17.773

声明您有一个具有 UIButton 的 UIViewController 和另一个具有 UIScrollView 的 UIViewController 是否正确？当您在第一个视图上按下按钮时，segue 会激活并出现带有 scrollView 的第二个视图，但 scrollView 没有占据全屏？如果是这种情况，请将 IBOutlet 变量连接到 UIScrollView 并将其框架设置为屏幕的完整大小。 `-(void)viewDidLoad{ self.mainScrollView.frame = CGRectMake(0,0,self.view.frame.size.width,self.view.frame.size.height); }`

# r - 数据框上的区间搜索

> ID：11705765
> 
> 赞同：4
> 
> 时间：2012-07-29T00:37:36.640
> 
> 标签：r

我有一个时间序列和值的数据框。时间序列是从纪元开始的秒数。这是该数据框中前几个元素的样子

```
val = seq(1,19)
ts = seq(1342980888,1342982000,by=60)
x = data.frame(ts = ts,val = val)
head(x)

      ts val
1 1342980888   1
2 1342980948   2
3 1342981008   3
4 1342981068   4
5 1342981128   5
6 1342981188   6 
```

我想要某种间隔搜索函数，它以时间戳为输入，比如 1342980889（+1 第一行中的 ts），它应该返回 1,2（行号）作为输出。基本上，我想找到具有将输入时间戳 1342980889 括起来的时间戳的两行。虽然使用“which”相对容易做到这一点，但我怀疑“which”进行矢量扫描，因为真实的数据帧相当大我想用二进制搜索来做。非常感谢提前

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T00:45:07.613

您应该使用该`findInterval`功能。它将为您提供`x$ts`立即小于您正在查找的值的行的索引（您只需添加一个即可获得另一个索引）

```
findInterval(1342980889, x$ts)
# [1] 1 
```

另请注意，该函数是矢量化的，即第一个参数可以是要查找的值的向量：

```
findInterval(c(1342980889, 1342981483), x$ts)
# [1]  1 10 
```

# objective-c - NSViewController 子类的烦恼

> ID：11705767
> 
> 赞同：0
> 
> 时间：2012-07-29T00:39:00.550
> 
> 标签：objective-c, osx-mountain-lion, xcode4.4

我创建了一个`NSCollectionViewItem`子类，称为`TSCollectionViewController`. 它覆盖*了一种*方法，`setRepresentedObject:`. 我打算在我的`NSView`,中使用它`TSTopChartView`。奇怪的是，当我将它添加到`TSTopChartView.h`文件时出现错误（如下图所示）。 ![在此处输入图像描述](../Images/bf6c8ed30244ca30a682bdd04a124c2c.png) ![在此处输入图像描述](../Images/17122c81f520faec03f200e6850cee7d.png)

显然，Xcode 不喜欢`TSCollectionViewController`这个文件。我就是想不通为什么！我已经导入了文件，所以它不应该是未知的类型名称。有任何想法吗？感谢您的时间！

这是 TSCollectionViewController.h：

```
#import <Cocoa/Cocoa.h>
#import "TSTopChartCell.h"
#import "TSPodcastEpisodeCell.h"
#import "TSDetailView.h"

@interface TSCollectionViewController : NSCollectionViewItem
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:01:56.037

您在 TSCollectionViewController.h 和 TSTopChartView.h 之间存在循环 #import 依赖关系。`#import "TSTopChartCell.h"`在您的情况下，您可以通过从 TSCollectionViewController.h 中删除来轻松打破它。

如果您最终需要`TSTopChartCell`在 TSCollectionViewController.h 中声明该类，您可以通过添加`@class TSTopChartCell`而不是`#import "TSTopChartCell.h"`. 然后你可以`#import "TSTopChartCell.h"`在实现文件中，TSCollectionViewController.m。

# ruby-on-rails - Rails：由于外键验证，一对多关联失败

> ID：11705772
> 
> 赞同：5
> 
> 时间：2012-07-29T00:41:02.363
> 
> 标签：ruby-on-rails, migration, associations, one-to-many

我已经在 Rails 中建立了一对多关联，但由于外键设置不正确，我的测试一直失败。我想知道是否有人有任何建议。

我有两个模型 - rota 和 user。我希望用户“创建”一个轮班表。一个用户可以创建多个列表。

**测试失败**

*在 rota_spec 中：*

```
it {should belong_to :creator}
Expected Rota to have a belongs_to association called creator (Rota does not have a creator_id foreign key.) 
```

*在用户规范中：*

```
it {should have_many :created_rotas}
Expected User to have a has_many association called created_rotas (Rota does not have a creator_id foreign key.) 
```

* * *

**Rota.rb**

```
 belongs_to :creator, :class_name => "User" 
```

**用户.rb**

```
 has_many :created_rotas, :class_name => "Rota", :foreign_key => "creator_id" 
```

**移民**

```
class AddCreatorToRotas < ActiveRecord::Migration
  def change
    add_column :rotas, :creator_id, :string
  end
end 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-29T01:10:03.660

你必须跑

```
rake db:test:prepare 
```

# java - 数组列表的快速排序 I seem to be having some problems witn my quicksort method. I am trying to sort an ArrayList of objects using my quicksort method. I am using the Apache POI library to extract data from an excel file and I am adding thi 问问题 问问题 2012-07-29T00:44:51.770 6014 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I seem to be having some problems witn my quicksort method. I am trying to sort an ArrayList of objects using my quicksort method. I am using the Apache POI library to extract data from an excel file and I am adding this data to my arraylist. I have confirmed that my arraylist is not empty by printing out the arraylist before applying the quicksort method. My problem seems to be that after passing in my arraylist of objects it gets reset to null and the size of the arraylist becomes 0\. I got a java IndexOutOfBounds Exception within my quicksort method while trying get an object from the arraylist. Any help would be appreciated, thanks ! Here is my main class : EDIT I solved my problem using the given solution below, but I still don't understand why my quicksort function doesn't work. I would appreciate it if someone could look at the quicksort function and tell me where I am going wrong. Thanks ! public class Test { private static ArrayList incom = new ArrayList(); private static int period; private static String termination = "yes"; private static int pivotVal; private static ArrayList <string>treatment_name = new ArrayList(); private static ArrayList <integer>treatment_cstart = new ArrayList(); private static ArrayList <integer>treatment_cend = new ArrayList(); private static ArrayList <integer>treatment_cost = new ArrayList(); private static ArrayList <integer>bridge_part = new ArrayList(); private static ArrayList <integer>budget = new ArrayList(); private static Scanner input = new Scanner(System.in); private static Scanner alt = new Scanner(System.in).useDelimiter("\n"); public static void main(String[] args) { processFile(); } public static void processFile(){ try { POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream("Book2.xls")); HSSFWorkbook wb = new HSSFWorkbook(fs); HSSFSheet sheet =wb.getSheet("Table0"); RowProcessor ip = IncomeProcessor.getInstance(); Object [] incomes = ip.process(sheet); for (int i=0; i <incomes.length; i++)="" incom.add(incomes[i]);="" for="" (int="" i="0;" i<incom.size();="" {="" income="" system.out.println(income.getbridgeid()="" +="" "="" income.getdeckstate());="" }="" incom="quicksort(incom);" catch="" (filenotfoundexception="" e)="" todo="" auto-generated="" block="" e.printstacktrace();="" (exception="" public="" static="" arraylist<object="">quicksort(ArrayList income){ int pivot = income.size()/2; int samePivotVal = 0; ArrayList greater = new ArrayList(); ArrayList lesser = new ArrayList(); Income pivotIncome = (Income) income.get(pivot); pivotVal = pivotIncome.getDeckState(); Income in; for(int i=0; i <income.size() ;i++){="" in="(Income)income.get(i);" if(in.getdeckstate()="">pivotVal) greater.add(in); else if(in.getDeckState() < pivotVal) lesser.add(in); else samePivotVal++; } lesser = quicksort(lesser); for(int i=0; i <samepivotval; i++)="" lesser.add(pivotincome);="" greater="quicksort(greater);" arraylist<object="">sorted = new ArrayList(); for(Object result : lesser) sorted.add(result); for(Object result : greater) sorted.add(result); return sorted; } } It will be a lot easier (and better) if you use Java's builtin sorting methods. public static void processFile(){ //... Collections.sort(incom, new IncomComparator()); //... } class IncomComparator implements Comparator { @Override public int compare(Object o1, Object o2) { /* compare logic goes here return a negative number when o1 < o2 a positive number when o1 > o2 0 when o1 == o2 */ return 0; } } or in a more simple way public static void processFile(){ //... Collections.sort(incom, new Comparator() { @Override public int compare(Object o1, Object o2) { /* compare logic goes here return a negative number when o1 < o2 a positive number when o1 > o2 0 when o1 == o2 */ return 0; } }); //... } You can see some more examples here. javaoopsortingarraylistquicksort 4 1 回答 1 This answer is useful 6 如果您使用 Java 的内置排序方法，将会更容易（并且更好）。 public static void processFile(){ //... Collections.sort(incom, new IncomComparator()); //... } class IncomComparator implements Comparator { @Override public int compare(Object o1, Object o2) { /* compare logic goes here return a negative number when o1 < o2 a positive number when o1 > o2 0 when o1 == o2 */ return 0; } } 或者以更简单的方式 public static void processFile(){ //... Collections.sort(incom, new Comparator() { @Override public int compare(Object o1, Object o2) { /* compare logic goes here return a negative number when o1 < o2 a positive number when o1 > o2 0 when o1 == o2 */ return 0; } }); //... } 您可以在此处查看更多示例。 于 2012-07-29T01:13:36.333 回答 Related 2 php - php substr 被忽略 1 html - Jquery 移动页脚中的问题 2 android - 恢复到 SurfaceView 显示黑屏 1 c++ - VStudio C++ 的类似 Eclipse 的注释栏 1 objective-c - 控制 MapKit 引脚注释抽头选择 1 android - 使用 Mupdf 库进行 pdfrenderer 不起作用 1 ruby-on-rails - FreeBSD 9.0 上的 Rails 2.3.14/Rails 1.9.3p125 失败 7 android - 如何在 Android 设备上运行 Linux 命令？ 1 hibernate - Hibernate 抛出空指针异常 1 javascript - 单选按钮如何使用函数中确定的值预先选择值 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11705783
> 
> 赞同：1
> 
> 时间：
> 
> 标签：java, oop, sorting, arraylist, quicksort

I seem to be having some problems witn my quicksort method. I am trying to sort an ArrayList of objects using my quicksort method. I am using the Apache POI library to extract data from an excel file and I am adding this data to my arraylist. I have confirmed that my arraylist is not empty by printing out the arraylist before applying the quicksort method.

My problem seems to be that after passing in my arraylist of objects it gets reset to null and the size of the arraylist becomes 0\. I got a java IndexOutOfBounds Exception within my quicksort method while trying get an object from the arraylist. Any help would be appreciated, thanks !

Here is my main class :

**EDIT** I solved my problem using the given solution below, but I still don't understand why my quicksort function doesn't work. I would appreciate it if someone could look at the quicksort function and tell me where I am going wrong. Thanks !

```
public class Test {

private static ArrayList<Object> incom = new ArrayList<Object>();

private static int period;
private static String termination = "yes";
private static int pivotVal;

private static ArrayList<String> treatment_name = new ArrayList();
private static ArrayList<Integer> treatment_cstart = new ArrayList();
private static ArrayList<Integer> treatment_cend = new ArrayList();
private static ArrayList<Integer> treatment_cost = new ArrayList();
private static ArrayList<Integer> bridge_part = new ArrayList();
private static ArrayList<Integer> budget = new ArrayList();

private static Scanner input = new Scanner(System.in);
private static Scanner alt = new Scanner(System.in).useDelimiter("\n");

public static void main(String[] args) 
{   

    processFile();

}

public static void processFile(){
    try {
        POIFSFileSystem fs      =
            new POIFSFileSystem(new FileInputStream("Book2.xls"));
        HSSFWorkbook wb = new HSSFWorkbook(fs);

        HSSFSheet sheet =wb.getSheet("Table0");
        RowProcessor ip = IncomeProcessor.getInstance();
        Object [] incomes = ip.process(sheet);

        for (int i=0; i<incomes.length; i++)
          incom.add(incomes[i]);

        for (int i=0; i<incom.size(); i++)
        {
            Income income = (Income)incom.get(i);
            System.out.println(income.getBridgeID() + " " + income.getDeckState());
        }

          incom = quicksort(incom);

    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

public static ArrayList<Object> quicksort(ArrayList<Object> income){

    int pivot = income.size()/2;
    int samePivotVal = 0;
    ArrayList<Object> greater = new ArrayList<Object>();
    ArrayList<Object> lesser = new ArrayList<Object>();

    Income pivotIncome = (Income) income.get(pivot);
    pivotVal = pivotIncome.getDeckState();

    Income in;
    for(int i=0; i<income.size() ;i++){
        in = (Income)income.get(i);
        if(in.getDeckState() > pivotVal)
            greater.add(in);
        else if(in.getDeckState() < pivotVal)
            lesser.add(in);
        else 
            samePivotVal++;
    }

    lesser = quicksort(lesser);
    for(int i=0; i<samePivotVal; i++)
        lesser.add(pivotIncome);

    greater = quicksort(greater);

    ArrayList<Object> sorted = new ArrayList<Object>();

    for(Object result : lesser)
        sorted.add(result);

    for(Object result : greater)
        sorted.add(result);

    return sorted;
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T01:13:36.333

如果您使用 Java 的内置排序方法，将会更容易（并且更好）。

```
public static void processFile(){ 
    //...

    Collections.sort(incom, new IncomComparator());
    //...
}

class IncomComparator implements Comparator<Object> {
    @Override
    public int compare(Object o1, Object o2) {
        /* compare logic goes here
           return a negative number when o1 < o2
                  a positive number when o1 > o2
                  0 when o1 == o2
        */ 
        return 0;
    }

} 
```

或者以更简单的方式

```
public static void processFile(){ 
    //...

    Collections.sort(incom, new Comparator<Object>() {
        @Override
        public int compare(Object o1, Object o2) {
           /* compare logic goes here
               return a negative number when o1 < o2
                  a positive number when o1 > o2
                  0 when o1 == o2
           */ 
           return 0;
        }
    });
    //...
} 
```

[您可以在此处](http://www.mkyong.com/java/java-object-sorting-example-comparable-and-comparator/)查看更多示例。</samepivotval;></income.size()></incomes.length;></integer></integer></integer></integer></integer></string>

# batch-file - 无法用批处理文件覆盖主机文件

> ID：11705789
> 
> 赞同：0
> 
> 时间：2012-07-29T00:45:53.827
> 
> 标签：batch-file, hosts

我正在尝试使用批处理脚本清除主机文件的所有内容

这是我的代码：

```
@echo off 
cd %SYSTEMDRIVE%:\Windows\System32\drivers\etc
takeown /f hosts
icacls hosts /grant %username%:w
echo > hosts 
```

批处理执行后，hosts 文件似乎不受影响。我应该改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:05:29.583

这是我找到的解决方案。不太确定它为什么有效，但它确实有效，主要是

```
@echo off 
takeown /f C:\Windows\System32\drivers\etc\hosts
icacls C:\Windows\System32\drivers\etc\hosts /grant %username%:w
echo # > C:\Windows\System32\drivers\etc\hosts
echo.
echo.
ipconfig /flushdns
echo.
echo.
echo All sites restored!
pause 
```

如果我尝试打开一个新的浏览器，效果很好。如果我当前打开了浏览器，它不起作用。对此有什么建议吗？

（使用铬）

# wordpress - WordPress 自定义帖子编辑器？

> ID：11705797
> 
> 赞同：0
> 
> 时间：2012-07-29T00:48:03.260
> 
> 标签：wordpress, wordpress-theming

我有一系列以“竞赛”为特色的页面，艺术家将使用短代码链接到基于给定主题的 youtube 视频表演，用户将能够评论和判断视频以确定获胜者。

我正在使用模板来展示比赛规则，并且在该内容的底部，我需要允许用户创建帖子并链接到视频。我需要将帖子“强制”到一个特定的标签，我将使用它来显示所有条目及其评论。

1.  是否可以从页面添加“新帖子”？
2.  是否可以根据页面上的自定义字段强制标记？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:37:20.340

1.  是的，这是可能的。看看这两个指南：http: [//voodoopress.com/how-to-post-from-your-front-end-with-no-plugin/](http://voodoopress.com/how-to-post-from-your-front-end-with-no-plugin/)和[http://wpshout.com/ wordpress-submit-posts-from-frontend/](http://wpshout.com/wordpress-submit-posts-from-frontend/)

2.  你应该可以做到，虽然我自己没有做到。但是，如果标签的目的只是将这些用户提交的帖子与其他帖子分开，那么您最好使用自定义帖子类型，并以这种方式将它们分开。是的，您可以按照上述链接中提到的方式提交自定义帖子类型。只需将'post_type'=>$customposttype（其中$customposttype 是您的自定义帖子类型的名称）添加到您输入wp_insert_post 的$post 数组中。

# string - 在 TCL 中检查字符串是否以某个字符开头的最有效方法是什么？

> ID：11705802
> 
> 赞同：8
> 
> 时间：2012-07-29T00:49:47.707
> 
> 标签：string, performance, comparison, tcl

我有一个字符串，我想检查它是否以某个字符开头（在本例中为 #）。我想知道最有效的方法！

我在想的是`if {[string compare -length 1 $string "#"]}`，因为它可能使用 strcmp() 这可能是实现这一目标的最快方法之一。

我认为也可能是`if {[string index $string 1] == "#"}`，因为它可能会执行 *string == '#' ，这可能也会非常快。

你怎么看？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-29T14:51:54.907

检查字符串是否以特定字符开头的最快方法是`string match`：

```
if {[string match "#*" $string]} { ... } 
```

进行匹配的代码发现在第一个字符之后和字符串末尾有一个星号，因此停止检查其余的`$string`. 它也不需要任何结果分配（布尔值除外，这是一种特殊情况，因为`string match`也是字节码编译的）。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2014-10-30T10:29:27.623

是的 [string match "*" $string_name] 这对我有用。与正则表达式或任何其他实用程序相比，这真的很快。

# javascript - 在 HTTP 请求中了解引用者/引用者的安全方法是什么？

> ID：11705804
> 
> 赞同：6
> 
> 时间：2012-07-29T00:50:06.617
> 
> 标签：javascript, http, node.js, cross-domain

我正在使用 nodejs 编写图像上传服务。付费客户将能够将图像文件发送到我在服务器上设置的端点。但是，当每个请求进来时，我需要确认它实际上是一个付费客户发出请求。我想过让客户给我他们的域名，我会检查引用标题。但是，有人可以轻松地欺骗引荐来源标头并使用我的服务而无需付费。SaaS 开发人员如何面对这个技术问题？是否可以在不要求我的客户拥有一些服务器端代码的情况下解决此问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T06:18:19.923

您是在为网站构建外部图像托管服务，还是要共享必须**私密**且**安全**的内容？如果是前者，请提前阅读。

当然，标头可以被欺骗。这就是您不必担心的原因：

1.  替代方案是丑陋的：要构建安全的供应服务，您必须开发某种令牌系统，网站所有者也在他的最后实施。很有可能，他不会和你签约，因为有更简单的选择。

2.  欺骗必须在客户端完成。很少有“用户”会真正做到这一点。两个极客在他们自己的机器上欺骗标题不会对你有很大的影响。如果他们编写了一些代理或中间件来自动完成这项工作并且许多人开始使用它，那么这可能是一个问题。然而，这不太可能。

猜猜你已经知道了，但既然你没有提到 - 它被称为`Hotlinking`. 谷歌这个主题以找到更多资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T02:25:31.407

您无法使用引用者标头对浏览器进行身份验证。

如果您想对个人进行身份验证，那么您可能需要一个登录系统，他们向（用户名/密码）提供凭据，并根据您允许的用户群检查这些凭据。如果他们通过了，那么您在浏览器中设置了某种类型的 cookie，表明他们是合法用户。该用户的后续请求将包含该 cookie，您可以检查每个请求。

cookie 必须是您创建的、您可以验证且不易被猜测或伪造的东西（如会话或来自服务器的加密令牌）。您通常会在一段时间后对 cookie 设置过期时间，以便用户必须再次登录。

# android - Android - 创建变量对象类型数组

> ID：11705806
> 
> 赞同：0
> 
> 时间：2012-07-29T00:50:30.380
> 
> 标签：android, arrays, class, object, extends

如何创建不同类型的数组？如果每个类都是该类的扩展`_object`，我可以只制作一个`_object`数组并将扩展添加到其中吗？

例子：

```
class _object {
    int type = 1;
    public _object() {
        type = 2;
    }

    public doSomething() {
    }
}

class tree extends _object {
    public tree() {
    }
}

class apple extends _object {
    public apple() {
    }
}

public tree aTree = new tree();
public apple anApple = new apple();

public _object[] objects = new _object[] { aTree, anApple }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T02:47:43.697

您问题中的示例有效。这被称为多态性。

[http://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html](http://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html)

[http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T02:16:00.827

上面的代码在android中设置成工程并调试后，其实是可以的，只要调用基础对象的方法即可。

# node.js - 在 NodeJS 中，如果我不响应请求，我的服务器会发生任何负面影响吗？

> ID：11705808
> 
> 赞同：5
> 
> 时间：2012-07-29T00:51:10.270
> 
> 标签：node.js

我有一个 nodeJS 服务器正在运行。服务器将收到一些不需要响应的请求（只是在服务器中更新）。如果更新失败，客户无需担心。为了节省带宽，我不想回复上述请求。无法响应请求会以某种方式影响我的服务器性能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:57:55.880

假设您使用的是 http，您至少必须返回一个 http 响应代码。如果你不这样做，你就违反了http——客户端将等待响应，并且会在尝试中死掉（即一段时间后会超时）。

根据[end 的文档](http://nodejs.org/api/http.html#http_response_end_data_encoding)，您**必须**调用`end`每个响应。如果您未指定响应代码，它将为您发送响应代码。所以是的，需要回应。

# c# - RichTextBox 上的 URL 请求？

> ID：11705809
> 
> 赞同：-2
> 
> 时间：2012-07-29T00:51:12.650
> 
> 标签：c#, wpf, richtextbox

我想让 HTML 代码显示在 RichTextBox 中。我正在使用代码

```
WebClient client = new WebClient();
byte[] data = client.DownloadData("http://www.google.com");
richTextBox1.Text = data.ToString(); 
```

我怎样才能做到这一点？

另外：我不知道为什么，但这在 RichTextBox 上显示了“System.Byte []”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T01:13:44.413

使用[`WebClient.DownloadString`](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadstring.aspx)它将指定的资源下载为 a`String`或 a `Uri`：

```
var contents = new System.Net.WebClient().DownloadString(url); 
```

**请注意**：`RTF`编码不同于`HTML`. 你不能马上这样做。我建议`WebBrowser`控制。

或尝试以下方法：

*   [http://www.codeproject.com/KB/HTML/XHTML2RTF.aspx](http://www.codeproject.com/KB/HTML/XHTML2RTF.aspx)
*   [http://www.codeproject.com/KB/edit/htmlrichtextbox.aspx](http://www.codeproject.com/KB/edit/htmlrichtextbox.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T01:20:34.467

它显示`System.Byte[]`因为它显示的是 的描述`data`，而不是`data`的内容。为此，请执行以下操作：

```
 WebClient client = new WebClient();
        byte[] file = client.DownloadData("example.com");

        File.WriteAllBytes(@"example.txt", file);

        string[] lines = File.ReadAllLines("example.txt");

        richTextBox1.Text = lines; 
```

查看实际内容

**编辑**

或者你可以`WebClient.DownloadString`像@Ria 建议的那样做。只有我会这样实现它：

```
WebClient client = new WebClient();
var data = client.DownloadString("example.com");
richTextBox1.Text = data.ToString(); 
```

或者甚至更有效率

```
richTextBox1.Text = client.DownloadString("example.com"); 
```

# algorithm - 如何在未排序的数组中找到 2 个数字及其总和

> ID：11705811
> 
> 赞同：2
> 
> 时间：2012-07-29T00:51:56.170
> 
> 标签：algorithm

这是我被要求解决的一个面试问题：给定一个未排序的数组，找出 2 个数字及其在数组中的总和。（也就是说，在数组中找到三个数字，其中一个是另外两个的总和。）请注意，我已经看到了关于在给定总和 (int k) 时找到 2 个数字的问题。但是，这个问题希望您找出数组中的数字和总和。是否可以在 O(n)、O(log n) 或 O(nlogn) 中求解

有一个标准的解决方案是遍历每个整数，然后对其进行二进制搜索。有更好的解决方案吗？

```
public static void findNumsAndSum(int[] l) {
    // sort the array
    if (l == null || l.length < 2) {
        return;
    }
    BinarySearch bs = new BinarySearch();
    for (int i = 0; i < l.length; i++) {
        for (int j = 1; j < l.length; j++) {
            int sum = l[i] + l[j];
            if (l[l.length - 1] < sum) {
                continue;
            }
            if (bs.binarySearch(l, sum, j + 1, l.length)) {
                System.out.println("Found the sum: " + l[i] + "+" + l[j]
                        + "=" + sum);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:01:49.480

这与标准问题非常相似，[`3SUM`](http://en.wikipedia.org/wiki/3SUM)右侧的许多相关问题都与该问题有关。

您的解决方案是`O(n^2 lg n)`；有一些[基于对数组进行排序的](http://en.wikipedia.org/wiki/3SUM#Quadratic_algorithm)`O(n^2)`算法，这些算法对这个变体进行了轻微的修改。最有名的下限是（因为你可以用它来执行比较排序，如果你很聪明的话）。如果你能找到一个二次算法或更严格的下限，你会从中得到一些出版物。:)`O(n lg n)`

请注意，如果您愿意将整数限制在范围内，则可以使用[快速傅里叶变换](http://en.wikipedia.org/wiki/FFT)`[-u, u]`及时解决该`a + b + c = 0`问题。不过，如何调整它以适应问题对我来说并不是很明显。`O(n + u lg u)``a + b = c`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-02T23:31:28.813

您可以按以下方式解决它`O(nlog(n))`：

按升序对数组进行排序`O(nlog(n))`。您需要 2 个指向数组左/右端的索引。让我们称它们为`i`and `j`，`i`分别是左边的和`j`右边的。

现在计算 的总和`array[i] + array[j]`。

*   如果这个和大于`k`，则减`j`一。
*   如果这个和小于`k`。增加`i`一。

重复直到总和等于`k`。

因此，使用此算法，您可以找到解决方案，`O(nlog(n))`并且实现起来非常简单

对不起。看来我没有仔细阅读您的帖子；）

# magento - 为什么我的块没有显示？

> ID：11705812
> 
> 赞同：3
> 
> 时间：2012-07-29T00:52:34.227
> 
> 标签：magento

我不知道为什么我的块没有出现。它没有出现在任何页面上，我清除了缓存。有人可以帮我弄清楚我错过了什么吗？然而，`var_dump('test')`出现了！

应用程序/设计/前端/默认/默认/模板/justin/head.phtml

```
testing this block 
```

贾斯汀/比伯/块/Sings.php

```
class Justin_Bieber_Block_Sings extends Mage_Core_Block_Template
{
    protected function _construct()
    {
        parent::_construct();
        var_dump("test");
    }
} 
```

配置文件

```
<frontend>
       ...
    <layout>
        <updates>
            <bieber>
                <file>justin.xml</file>
            </bieber>
        </updates>
    </layout>
</frontend>
<global>
    <blocks>
        <bieber>
            <class>Justin_Bieber_Block</class>
        </bieber>
    </blocks>
    ...
</global> 
```

应用程序/设计/前端/默认/默认/布局/justin.xml

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
        <reference name="head">
            <block type="bieber/bieber" name="justin_bieber">
                 <action method="setTemplate">
                    <template>justin/head.phtml</template>
                </action>
            </block>
        </reference>
    </default>
</layout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:42:02.333

在你的 justin.xml 块类型应该是

```
 <block type="bieber/sings" name="justin_bieber"> 
```

在这种情况下，“bieber”是您的模块别名，“sings”是类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T05:52:06.857

你的代码对我来说似乎很好。
关于 justin.xml 尝试将其更改为以下内容：

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
        <reference name="head">
            <block type="bieber/sings" name="justin_bieber" as="justin_bieber" template="justin/head.phtml" /> 
        </reference>
    </default>
</layout> 
```

让我知道这是否有效！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:08:58.963

符号链接是问题所在。如果文件位于符号链接目录中，Magento 将无法获取该文件。

打开它！ [Magento/Zend 不允许符号链接](https://stackoverflow.com/questions/4473654/magento-zend-not-allowing-symbolic-links)

另一件事是打开模板提示！

# java - java编译报错取决于静态变量名是否合格？

> ID：11705814
> 
> 赞同：9
> 
> 时间：2012-07-29T00:53:29.313
> 
> 标签：java, javac

为什么这个java程序不能编译：

```
public class xx {
    public static final Object obj;
    static {
//        obj = null;       // this compiles
        xx.obj = null;      // this doesn't
    }
} 
```

出现此错误：

```
$ javac xx.java
xx.java:5: cannot assign a value to final variable obj
        xx.obj = null;      // this doesn't
          ^
1 error
$ javac -version
javac 1.6.0_33 
```

什么时候，如果我替换`xx.obj = null`为`obj = null`（正如评论中提到的那样）它会编译。

我认为`xx.`类名前缀或多或少只是语法......这是编译器或语言规范中的错误？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-29T01:11:21.730

当你这样做时`xx.obj`，这意味着该类已经初始化。所以`final obj`无法再次初始化。这是一个编译时错误。编译器可以检查`obj`尚未初始化。很难检查，但理论上是可能的。但这不是 Java 编译器的工作方式。

# c++ - 使用 ssl c/c++ 的客户端和服务器通信 - SSL 协议不起作用

> ID：11705815
> 
> 赞同：21
> 
> 时间：2012-07-29T00:53:42.783
> 
> 标签：c++, c, sockets, openssl, ssl-certificate

我正在尝试使用来自以下网址的 SSL 客户端/服务器示例：[http](http://simplestcodings.blogspot.com.br/2010/08/secure-server-client-using-openssl-in-c.html) ://simplestcodings.blogspot.com.br/2010/08/secure-server-client-using-openssl-in-c.html使用以下方式创建安全连接SSLv3。我对在服务器端请求证书进行了一些更改，通信工作正常并且双方都理解。因此，我的问题是，当客户端连接到服务器时，协议通信 SSLv3 不起作用，我使用 wirkeshark 进行了验证，并且在协议字段中只显示 TCP，或者 IPA（RSL Malformed Packet）有人可以帮助我吗？谢谢！

我按照教程[https://help.ubuntu.com/community/OpenSSL](https://help.ubuntu.com/community/OpenSSL)创建了我的证书。

这是我的客户代码：

```
//SSL-Client.c
#include <stdio.h>
#include <errno.h>
#include <unistd.h>
#include <malloc.h>
#include <string.h>
#include <sys/socket.h>
#include <resolv.h>
#include <netdb.h>
#include <openssl/ssl.h>
#include <openssl/err.h>

#define FAIL    -1

    //Added the LoadCertificates how in the server-side makes.    
void LoadCertificates(SSL_CTX* ctx, char* CertFile, char* KeyFile)
{
 /* set the local certificate from CertFile */
    if ( SSL_CTX_use_certificate_file(ctx, CertFile, SSL_FILETYPE_PEM) <= 0 )
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    /* set the private key from KeyFile (may be the same as CertFile) */
    if ( SSL_CTX_use_PrivateKey_file(ctx, KeyFile, SSL_FILETYPE_PEM) <= 0 )
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    /* verify private key */
    if ( !SSL_CTX_check_private_key(ctx) )
    {
        fprintf(stderr, "Private key does not match the public certificate\n");
        abort();
    }
}

int OpenConnection(const char *hostname, int port)
{   int sd;
    struct hostent *host;
    struct sockaddr_in addr;

    if ( (host = gethostbyname(hostname)) == NULL )
    {
        perror(hostname);
        abort();
    }
    sd = socket(PF_INET, SOCK_STREAM, 0);
    bzero(&addr, sizeof(addr));
    addr.sin_family = AF_INET;
    addr.sin_port = htons(port);
    addr.sin_addr.s_addr = *(long*)(host->h_addr);
    if ( connect(sd, (struct sockaddr*)&addr, sizeof(addr)) != 0 )
    {
        close(sd);
        perror(hostname);
        abort();
    }
    return sd;
}

SSL_CTX* InitCTX(void)
{   SSL_METHOD *method;
    SSL_CTX *ctx;

    OpenSSL_add_all_algorithms();  /* Load cryptos, et.al. */
    SSL_load_error_strings();   /* Bring in and register error messages */
    method = SSLv3_client_method();  /* Create new client-method instance */
    ctx = SSL_CTX_new(method);   /* Create new context */
    if ( ctx == NULL )
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    return ctx;
}

void ShowCerts(SSL* ssl)
{   X509 *cert;
    char *line;

    cert = SSL_get_peer_certificate(ssl); /* get the server's certificate */
    if ( cert != NULL )
    {
        printf("Server certificates:\n");
        line = X509_NAME_oneline(X509_get_subject_name(cert), 0, 0);
        printf("Subject: %s\n", line);
        free(line);       /* free the malloc'ed string */
        line = X509_NAME_oneline(X509_get_issuer_name(cert), 0, 0);
        printf("Issuer: %s\n", line);
        free(line);       /* free the malloc'ed string */
        X509_free(cert);     /* free the malloc'ed certificate copy */
    }
    else
        printf("No certificates.\n");
}

int main()
{   SSL_CTX *ctx;
    int server;
    SSL *ssl;
    char buf[1024];
    int bytes;
    char hostname[]="127.0.0.1";
    char portnum[]="5000";
    char CertFile[] = "/home/myCA/cacert.pem";
    char KeyFile[] = "/home/myCA/private/cakey.pem";

    SSL_library_init();

    ctx = InitCTX();
    LoadCertificates(ctx, CertFile, KeyFile);
    server = OpenConnection(hostname, atoi(portnum));
    ssl = SSL_new(ctx);      /* create new SSL connection state */
    SSL_set_fd(ssl, server);    /* attach the socket descriptor */
    if ( SSL_connect(ssl) == FAIL )   /* perform the connection */
        ERR_print_errors_fp(stderr);
    else
    {   char *msg = "Hello???";

        printf("Connected with %s encryption\n", SSL_get_cipher(ssl));
        ShowCerts(ssl);        /* get any certs */
        SSL_write(ssl, msg, strlen(msg));   /* encrypt & send message */
        bytes = SSL_read(ssl, buf, sizeof(buf)); /* get reply & decrypt */
        buf[bytes] = 0;
        printf("Received: \"%s\"\n", buf);
        SSL_free(ssl);        /* release connection state */
    }
    close(server);         /* close socket */
    SSL_CTX_free(ctx);        /* release context */
    return 0;
} 
```

和服务器：

```
//SSL-Server.c
#include <errno.h>
#include <unistd.h>
#include <malloc.h>
#include <string.h>
#include <arpa/inet.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <resolv.h>
#include "openssl/ssl.h"
#include "openssl/err.h"

#define FAIL    -1

int OpenListener(int port)
{   int sd;
    struct sockaddr_in addr;

    sd = socket(PF_INET, SOCK_STREAM, 0);
    bzero(&addr, sizeof(addr));
    addr.sin_family = AF_INET;
    addr.sin_port = htons(port);
    addr.sin_addr.s_addr = INADDR_ANY;
    if ( bind(sd, (struct sockaddr*)&addr, sizeof(addr)) != 0 )
    {
        perror("can't bind port");
        abort();
    }
    if ( listen(sd, 10) != 0 )
    {
        perror("Can't configure listening port");
        abort();
    }
    return sd;
}

SSL_CTX* InitServerCTX(void)
{   SSL_METHOD *method;
    SSL_CTX *ctx;

    OpenSSL_add_all_algorithms();  /* load & register all cryptos, etc. */
    SSL_load_error_strings();   /* load all error messages */
    method = SSLv3_server_method();  /* create new server-method instance */
    ctx = SSL_CTX_new(method);   /* create new context from method */
    if ( ctx == NULL )
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    return ctx;
}

void LoadCertificates(SSL_CTX* ctx, char* CertFile, char* KeyFile)
{
    //New lines 
    if (SSL_CTX_load_verify_locations(ctx, CertFile, KeyFile) != 1)
        ERR_print_errors_fp(stderr);

    if (SSL_CTX_set_default_verify_paths(ctx) != 1)
        ERR_print_errors_fp(stderr);
    //End new lines

    /* set the local certificate from CertFile */
    if (SSL_CTX_use_certificate_file(ctx, CertFile, SSL_FILETYPE_PEM) <= 0)
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    /* set the private key from KeyFile (may be the same as CertFile) */
    if (SSL_CTX_use_PrivateKey_file(ctx, KeyFile, SSL_FILETYPE_PEM) <= 0)
    {
        ERR_print_errors_fp(stderr);
        abort();
    }
    /* verify private key */
    if (!SSL_CTX_check_private_key(ctx))
    {
        fprintf(stderr, "Private key does not match the public certificate\n");
        abort();
    }

    //New lines - Force the client-side have a certificate
    SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER | SSL_VERIFY_FAIL_IF_NO_PEER_CERT, NULL);
    SSL_CTX_set_verify_depth(ctx, 4);
    //End new lines
}

void ShowCerts(SSL* ssl)
{   X509 *cert;
    char *line;

    cert = SSL_get_peer_certificate(ssl); /* Get certificates (if available) */
    if ( cert != NULL )
    {
        printf("Server certificates:\n");
        line = X509_NAME_oneline(X509_get_subject_name(cert), 0, 0);
        printf("Subject: %s\n", line);
        free(line);
        line = X509_NAME_oneline(X509_get_issuer_name(cert), 0, 0);
        printf("Issuer: %s\n", line);
        free(line);
        X509_free(cert);
    }
    else
        printf("No certificates.\n");
}

void Servlet(SSL* ssl) /* Serve the connection -- threadable */
{   char buf[1024];
    char reply[1024];
    int sd, bytes;
    const char* HTMLecho="<html><body><pre>%s</pre></body></html>\n\n";

    if ( SSL_accept(ssl) == FAIL )     /* do SSL-protocol accept */
        ERR_print_errors_fp(stderr);
    else
    {
        ShowCerts(ssl);        /* get any certificates */
        bytes = SSL_read(ssl, buf, sizeof(buf)); /* get request */
        if ( bytes > 0 )
        {
            buf[bytes] = 0;
            printf("Client msg: \"%s\"\n", buf);
            sprintf(reply, HTMLecho, buf);   /* construct reply */
            SSL_write(ssl, reply, strlen(reply)); /* send reply */
        }
        else
            ERR_print_errors_fp(stderr);
    }
    sd = SSL_get_fd(ssl);       /* get socket connection */
    SSL_free(ssl);         /* release SSL state */
    close(sd);          /* close connection */
}

int main()
{   SSL_CTX *ctx;
    int server;
    char portnum[]="5000";

        char CertFile[] = "/home/myCA/mycert.pem";
        char KeyFile[] = "/home/myCA/mycert.pem";

    SSL_library_init();

    ctx = InitServerCTX();        /* initialize SSL */
    LoadCertificates(ctx, CertFile, KeyFile); /* load certs */
    server = OpenListener(atoi(portnum));    /* create server socket */
    while (1)
    {   struct sockaddr_in addr;
        socklen_t len = sizeof(addr);
        SSL *ssl;

        int client = accept(server, (struct sockaddr*)&addr, &len);  /* accept connection as usual */
        printf("Connection: %s:%d\n",inet_ntoa(addr.sin_addr), ntohs(addr.sin_port));
        ssl = SSL_new(ctx);              /* get new SSL state with context */
        SSL_set_fd(ssl, client);      /* set connection socket to SSL state */
        Servlet(ssl);         /* service connection */
    }
    close(server);          /* close server socket */
    SSL_CTX_free(ctx);         /* release context */
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-25T07:13:25.553

使用上述服务器和客户端程序，我收到以下错误：

140671281543104：错误：140890B2：SSL 例程：SSL3_GET_CLIENT_CERTIFICATE：未返回证书：s3_srvr.c:3292：

[我使用https://help.ubuntu.com/community/OpenSSL](https://help.ubuntu.com/community/OpenSSL)中提到的过程生成了自签名证书。

折腾了一天的错误，我发现错误是因为自己生成的CA不在我使用的机器的信任链中。

要将 CA 添加到 RHEL-7 中的信任链中，可以遵循以下过程：

```
 To add a certificate in the simple PEM or DER file formats to the
        list of CAs trusted on the system:

        Copy it to the
                /etc/pki/ca-trust/source/anchors/
        subdirectory, and run the
                update-ca-trust
        command.

        If your certificate is in the extended BEGIN TRUSTED file format,
        then place it into the main source/ directory instead. 
```

我认为fedora也可以遵循上述程序。如果这不起作用，探索诸如“update-ca-certificates”之类的命令可能会很有用。希望这对某人有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-29T01:37:18.667

您必须修改您的代码（服务器端）：您的代码：

```
int main()
{   SSL_CTX *ctx;
    int server;
    **char portnum[]="5000";**

        char CertFile[] = "/home/myCA/mycert.pem";
        char KeyFile[] = "/home/myCA/mycert.pem";

    SSL_library_init();

    **portnum = strings[1];** 
```

相反，你应该使用这个：

```
int main(int argc, char **argv)
{   SSL_CTX *ctx;
    int server;
    //char portnum[]="5000"; ---> You can pass it as an argument

        char CertFile[] = "/home/myCA/mycert.pem";
        char KeyFile[] = "/home/myCA/mycert.pem";

    SSL_library_init();

    //portnum = strings[1]; 
    portnum = argv[1];  // ---> You can pass port number here, instead of put it in the code 
```

我得到了这个输出（客户端）：

```
toc@UnixServer:~$ ./ssl_client 
Connected with AES256-SHA encryption
Server certificates:
Subject: /C=FR/ST=Some-State/L=PARIS/O=TOC/OU=TOC/CN=TOC/emailAddress=toc@toc.com
Issuer: /C=FR/ST=Some-State/L=PARIS/O=TOC/OU=TOC/CN=TOC/emailAddress=toc@toc.com
Received: "<html><body><pre>Hello???</pre></body></html>

" 
```

这个输出（服务器）：

```
Connection: 127.0.0.1:59066
Server certificates:
Subject: /C=FR/ST=Some-State/L=PARIS/O=TOC/OU=TOC/CN=TOC/emailAddress=toc@toc.com
Issuer: /C=FR/ST=Some-State/L=PARIS/O=TOC/OU=TOC/CN=TOC/emailAddress=toc@toc.com
Client msg: "Hello???" 
```

当您使用 ssldump (http://www.rtfm.com/ssldump/) 之类的工具（在 unix 机器上）时，您可以清楚地看到发生了什么：

```
toc@UnixServer:~$sudo ssldump -i lo port 5000
New TCP connection #1: localhost(59071) <-> localhost(5000)
1 1  0.0012 (0.0012)  C>S  Handshake
      ClientHello
        Version 3.0 
        cipher suites
        Unknown value 0xc014
        Unknown value 0xc00a
        SSL_DHE_RSA_WITH_AES_256_CBC_SHA
        SSL_DHE_DSS_WITH_AES_256_CBC_SHA
        Unknown value 0x88
        Unknown value 0x87
        Unknown value 0xc00f
        Unknown value 0xc005
        SSL_RSA_WITH_AES_256_CBC_SHA
        Unknown value 0x84
        Unknown value 0xc012
        Unknown value 0xc008
        SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA
        SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA
        Unknown value 0xc00d
        Unknown value 0xc003
        SSL_RSA_WITH_3DES_EDE_CBC_SHA
        Unknown value 0xc013
        Unknown value 0xc009
        SSL_DHE_RSA_WITH_AES_128_CBC_SHA
        SSL_DHE_DSS_WITH_AES_128_CBC_SHA
        Unknown value 0x9a
        Unknown value 0x99
        Unknown value 0x45
        Unknown value 0x44
        Unknown value 0xc00e
        Unknown value 0xc004
        SSL_RSA_WITH_AES_128_CBC_SHA
        Unknown value 0x96
        Unknown value 0x41
        Unknown value 0xc011
        Unknown value 0xc007
        Unknown value 0xc00c
        Unknown value 0xc002
        SSL_RSA_WITH_RC4_128_SHA
        SSL_RSA_WITH_RC4_128_MD5
        SSL_DHE_RSA_WITH_DES_CBC_SHA
        SSL_DHE_DSS_WITH_DES_CBC_SHA
        SSL_RSA_WITH_DES_CBC_SHA
        SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
        SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA
        SSL_RSA_EXPORT_WITH_DES40_CBC_SHA
        SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5
        SSL_RSA_EXPORT_WITH_RC4_40_MD5
        Unknown value 0xff
        compression methods
                unknown value
                  NULL
1 2  0.0019 (0.0006)  S>C  Handshake
      ServerHello
        Version 3.0 
        session_id[32]=
          13 e2 5a f0 10 93 18 56 c8 66 54 94 29 ab 8b 2d 
          7b c6 9c 3b 7b ea c7 54 e6 86 7d 3a 56 8c 96 14 
        cipherSuite         SSL_RSA_WITH_AES_256_CBC_SHA
        compressionMethod                 unknown value
1 3  0.0019 (0.0000)  S>C  Handshake
      Certificate
1 4  0.0019 (0.0000)  S>C  Handshake
      CertificateRequest
        certificate_types                   rsa_sign
        certificate_types                   dss_sign
      ServerHelloDone
1 5  0.0155 (0.0136)  C>S  Handshake
      Certificate
1 6  0.0155 (0.0000)  C>S  Handshake
      ClientKeyExchange
1 7  0.0155 (0.0000)  C>S  Handshake
      CertificateVerify
        Signature[128]=
          ac 94 31 89 64 75 20 5f 4f 00 73 4e e8 de 51 b7 
          f1 bb 16 da 63 b1 8d e9 15 9b af f8 32 d7 84 f5 
          b5 7d 4f 48 1c 2b 41 58 81 d3 a8 50 40 25 90 95 
          44 de 9d bb c4 79 5c 64 a8 a9 28 f4 16 7c 0e 17 
          b2 77 cf b0 8c a9 90 50 34 a5 76 a2 57 39 8d 37 
          12 d8 a5 8d f4 08 3a 1e 83 7e 6c 0a e9 75 ec 85 
          3d 56 f2 2e 4a 7d 71 88 29 26 99 40 43 4e f3 29 
          26 bf eb 15 be 36 22 72 f3 d9 be 4a e3 c9 0b cc 
1 8  0.0155 (0.0000)  C>S  ChangeCipherSpec
1 9  0.0155 (0.0000)  C>S  Handshake
1 10 0.0245 (0.0089)  S>C  ChangeCipherSpec
1 11 0.0245 (0.0000)  S>C  Handshake
1 12 0.0250 (0.0005)  C>S  application_data
1 13 0.0250 (0.0000)  C>S  application_data
1 14 0.0258 (0.0007)  S>C  application_data
1 15 0.0258 (0.0000)  S>C  application_data
1    0.0261 (0.0002)  C>S  TCP FIN
1    0.0275 (0.0013)  S>C  TCP FIN 
```

问候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T14:47:42.683

正如我在[对您之前的一个问题](https://stackoverflow.com/q/11678392/372643)的评论中所说的那样，您收到“*格式错误的数据包：IP 上的 GSM* ”或这里有些奇怪的事实是正常的。

您正在使用端口 5000，通常为协议保留`commplex-main`。因此，在没有任何额外信息的情况下，Wireshark 会尝试使用`commplex-main`解码器分析它看到的流量。

当然，由于您在该端口上交换的数据实际上是 SSL/TLS（因为您使用的是通常不用于该端口的端口），因此对其进行解码就好像它`commplex-main`会导致许多关于格式错误的奇怪消息数据包。

Wireshark 仅使用它看到的端口号来猜测协议。如果您没有使用该协议的标准端口，您必须告诉它尝试不同的解码器。

更具体地说，**右键单击一个数据包并选择*Decode As... -> Transport -> SSL***。

# php - PHP 友好的 url .htaccess - 搜索页面

> ID：11705816
> 
> 赞同：1
> 
> 时间：2012-07-29T00:54:08.207
> 
> 标签：php, apache, .htaccess, mod-rewrite

我的 .htaccess 文件适用于以下网址

```
http://www.mywebsite.com/product/category/Girls-Clothes 
```

**.htaccess 文件：**

```
RewriteEngine On

RewriteRule ^product/category/([a-zA-Z0-9-/]+)$ /product/category/category.php?cid=$1
RewriteRule ^product/category/([a-zA-Z0-9-/]+)/$ /product/category/category.php?cid=$1 
```

**但是当我使用页码和友好的 url 时，它不起作用**

```
http://www.mywebsite.com/product/category/Girls-Clothes?pno=2 
```

我有两个变量**cid**和**pno**，.htaccess 中提到了 CID 但是当我 wtore “pno”时它给了我 sql 错误。

```
RewriteRule ^uk/category/([a-zA-Z0-9-/]+)$ /uk/category/category.php?cid=$1?pno=$1
RewriteRule ^uk/category/([a-zA-Z0-9-/]+)/$ /uk/category/category.php?cid=$1?pno=$1 
```

请让我知道我在哪里做错了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T00:56:14.040

在您当前的尝试中，您正在用“Girls-Clothes”`pno`中的相同值替换 的值`cid`，我怀疑这不是您想要的。

只需使用该`QSA`标志将现有查询字符串附加到请求上，这样就`pno=`可以通过重写与`cid`您添加的参数一起传递。

```
RewriteRule ^uk/category/([a-zA-Z0-9-]+)/?$ /uk/category/category.php?cid=$1 [L,QSA] 
```

`/?`另请注意，我通过添加和删除`/`来将其减少为一行，`[]`以使尾部斜杠可选。

# javascript - 在对象内完成 ajax 调用后触发 Javascript 回调

> ID：11705817
> 
> 赞同：1
> 
> 时间：2012-07-29T00:54:09.330
> 
> 标签：javascript, jquery, jquery-deferred

我试图在通过 AJAX 调用创建 Javascript 对象后触发操作。我的对象看起来像这样：

```
function API(uid,accessToken){      
        $.ajax("path/to/file", {
            type: "POST",
            data: { user: uid, auth: accessToken },
            dataType: "json",
            success: function(jsonData) {
                arrayname = jsonData[values]
            }
        });
} 
```

我尝试在对象设置完成后使用 JQuery 的 $.when 函数进行回调（即数组填充了 ajax 响应），如下所示：

```
 $.when( API = new API(uid, accessToken) ).then(function() {
                ...success function...
        }); 
```

...但该`$.when`函数触发的数组名称值仍未定义。从函数的角度来看，即使对象值尚未设置，延迟对象也会被解析。从那以后，我尝试了多种方法来根据整个 ajax 调用的完成和变量的设置来延迟 API 对象，但我有点坚持这样做的最佳方法。

任何指针将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:25:53.133

您可以在创建对象时传递回调函数，如下所示：

```
function API(uid,accessToken, callback){      
        $.ajax("path/to/file", {
            type: "POST",
            data: { user: uid, auth: accessToken },
            dataType: "json",
            success: function(jsonData) {
                arrayname = jsonData[values]
                callback(jsonData[values])
            }
        });
} 
```

然后像这样实例化对象

```
var api = new API(uid, accessToken, function(array) {
    // success function
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T01:30:30.923

如果问题是由于在“then”回调之后运行的“success”回调，您也可以尝试将成功回调转换为 then 回调。我不使用 JQuery，但我想它看起来像：

```
function API(uid,accessToken){      
    return $.ajax("path/to/file", {
        type: "POST",
        data: { user: uid, auth: accessToken },
        dataType: "json",
    }).then(function(jsondata){
        arrayname = jsondata[values]
    });
}

$.when( API = new API(uid, accessToken) ).then(function() {
    // ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T02:32:30.137

您使用的原因`$.when`是当您关联多个 Promise、异步任务等的回调时。从 jQuery 1.5 开始，所有调用`$.ajax`和所有包装器（`$.get`和`$.post`）都返回[Promise](http://api.jquery.com/promise/)。`$.when`因此，除非您想这样做，否则您不需要用语句包装此调用`$.when(ajaxCall1, ajaxCall2)`。

由于要过滤来自服务器的结果，因此应该使用 promise 的[pipe](http://api.jquery.com/deferred.pipe/)方法：

```
function API(uid, accessToken)
  return $.post(
    type: 'POST'
    ,data: { user: uid, auth: accessToken }
    ,dataType: 'json'
  )
    .pipe(function(json) {
      return json[values];
    })
  ;
} 
```

这使您可以按照自己的方式编写代码：

```
API(uid, token)
  .then(
    // success state (same as promise.done)
    function(arrayname /* named from your sample script*/) {
      alert('success! ' + arrayname);
    }
    // error state (same as promise.fail)
    ,function(jqXHR, status, error) {
      console.warn('oh noes!', error);
    }
  )
  .done(function() { /* done #2 */ })
  .fail(function() { /* fail #2 */ })
; 
```

注意：`promise.pipe()`还允许您过滤（更改传递给的数据）错误回调。

# c++ - Eclipse 4.2 cdt 与 ubuntu 12.04 配置

> ID：11705819
> 
> 赞同：0
> 
> 时间：2012-07-29T00:54:34.910
> 
> 标签：c++, eclipse, eclipse-cdt, ubuntu-12.04

我在 Ubuntu 12.04 上运行 Eclipse CDT (Eclipse v. 4.2)。当我创建一个 C++ 项目（在项目类型 -> 可执行文件 -> Hello World C++ 项目下）并选择 Linux GCC 工具链时，标准的 hello world 应用程序编译并运行得很好。当我尝试创建一个空项目（从与以前相同的菜单中），同时选择 Linux GCC 工具链时，它会带来几个构建错误：

```
 make:***[tst] Error 1
   Symbol 'cout' could not be resolved
   Symbol 'endl' could not be resolved
   Symbol 'std' could not be resolved
   undefined reference to 'main' 
```

当我比较“Hello World C++ 项目”生成的 .cpp 文件和添加到“空项目”中的 .cpp 文件的路径设置（属性 -> C/C++ 构建和 C/C++ 常规）时，他们有相同的配置和设置，所以我不确定为什么空项目没有检测到标准库和编译。包含文件夹中的所有文件也是相同的。这也发生在我的 Windows 7（MingW 编译器）安装和我的 MacOS X 安装上。现在我可以将我的项目创建为“Hello World C++ 项目”，摆脱我想要的文本和代码，但我真的很好奇如何从头开始设置它，特别是因为我的理解是创建一个“空项目”

CDT 控制台的实际构建错误是：

```
 20:49:26 **** Incremental Build of configuration Debug for project tst ****
    make all 
    Building target: tst
    Invoking: GCC C++ Linker
    g++  -o "tst"  ./src/test.o   
    /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o: In function `_start':
    (.text+0x20): undefined reference to `main'
    collect2: ld returned 1 exit status
    make: *** [tst] Error 1

    20:49:26 Build Finished (took 62ms) 
```

我试图运行的代码只是 eclipse 生成的默认 hello world 代码：

```
 #include <iostream>
   using namespace std;

   int main() {
   cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
   return 0;
   } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T13:50:12.393

我已经看到杂志上出售的一些 Ubuntu 12.04 DVD 默认不安装 gnu G++。转到 Ubuntu 软件中心并安装 G++（GNU C++ 编译器工具链）。安装后，在 IDE 左侧的 Eclipse Project Explorer 中右键单击您的项目名称。在索引项下选择重建。这应该可以解决 iostream 包含等问题。

# opengl - 从 Cg 顶点着色器获取 GlProgram 二进制文件

> ID：11705824
> 
> 赞同：0
> 
> 时间：2012-07-29T00:55:37.763
> 
> 标签：opengl, binary, cg, vertex-shader

我有一些 Cg 顶点着色器，并希望从中获取已编译的二进制文件以进行缓存。

我加载 Cg 顶点的方式是使用 glProgramStringARB，问题是我无法从 glGetProgramiv 和 glGetProgramBinary 检索任何值。

这是我正在做的示例代码：

```
CGprogram program = cgCreateProgram(context, CG_SOURCE, source, ...);
const char* programARB = static_cast<char*>(cgGetProgramString(program,
  CG_COMPILED_PROGRAM));
GLuint id;
glGenProgramsARB(1, id);
glBindProgramARB(GL_VERTEX_PROGRAM_ARB, id);
glProgramStringARB(GL_VERTEX_PROGRAM_ARB, GL_PROGRAM_FORMAT_ASCII_ARB,
  static_cast<GLsizei>(strlen(programARB)), programARB);
GLint length = -10;
glGetProgramiv(GL_VERTEX_PROGRAM_ARB, GL_PROGRAM_BINARY_LENGTH, &lenght);
printf("LENGTH: %d\n", length); 
```

我用 -10 初始化长度只是为了看看变量是否会随着 glGetProgramiv 调用而改变，但我总是得到 -10 作为结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T21:00:51.783

> 问题是我无法从 glGetProgramiv 和 glGetProgramBinary 检索任何值。

你当然不能。您将 ARB_vertex_program 与*GLSL 程序*混淆了。他们*不是*一回事。

[`glGetProgramiv`](http://www.opengl.org/wiki/GLAPI/glGetProgram)接受一个 GLSL 程序对象（除其他外）。OpenGL 给你一个`GL_INVALID_VALUE`错误的可能性很大，因为第一个参数几乎肯定不是由[`glCreateProgram`](http://www.opengl.org/wiki/GLAPI/glCreateProgram).

您无法获得 ARB_vertex_program 的程序二进制文件。您需要将 Cg 着色器编译为 GLSL，然后使用[标准 GLSL 编译/链接过程](http://www.opengl.org/wiki/GLSL_Object)，并从中获取二进制*文件*。

# node.js - Meteor 中的持久会话

> ID：11705825
> 
> 赞同：8
> 
> 时间：2012-07-29T00:55:48.840
> 
> 标签：node.js, session-state, meteor, state-machine-workflow, user-identification

因此，我一直在使用 Meteor 观察到的一个更令人困惑的方面是每次刷新都会清除会话。由于它不是一个持久存储，我应该把用户 ID 之类的东西放在哪里，或者人们在我的应用程序的状态机中的什么位置？

这些场景的模式是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T05:56:15.277

实际上，您可以做的是创建 Session 的“子类”，在调用 set() 时将值存储在 Amplify 的本地存储中。您将自动继承 Session 的所有反应属性。这是代码，它对我有用：

```
SessionAmplify = _.extend({}, Session, {
  keys: _.object(_.map(amplify.store(), function(value, key) {
    return [key, JSON.stringify(value)]
  })),
  set: function (key, value) {
    Session.set.apply(this, arguments);
    amplify.store(key, value);
  },
}); 
```

只需将所有 Session.set/get 调用替换为 SessionAmplify.set/get 调用即可。调用 set() 时，会调用父 Session 方法，以及 amplify.store()。当“子类”第一次创建时，它会在其键中加载 amplify 存储中的所有内容，以便可以使用 get() 立即检索它们。

您可以在此处测试排行榜示例的工作变体：[https ://github.com/sebastienbarre/meteor-leaderboard](https://github.com/sebastienbarre/meteor-leaderboard)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T07:29:58.743

好吧，首先我会使用[Auth 中内置的](https://github.com/meteor/meteor/wiki/Getting-Started-with-Auth)流星来存储用户 ID。我认为他们默认使用本地存储，但是AFAIK没有简单的方法可以解决这个问题。

但是，我想如果你想让东西在刷新后仍然存在，你应该将它存储在 mongo 中或使用 URL 来指示它们在“状态机”中的位置。您可以使用引导路由器（例如）`pushState`来更改 URL。

# java - jasper report/ireport 有没有办法从多个平面文件中查询数据并将它们显示在报告中？

> ID：11705827
> 
> 赞同：1
> 
> 时间：2012-07-29T00:56:26.220
> 
> 标签：java, jasper-reports, ireport, business-intelligence

我尝试通过这个搜索并没有结果，它看起来像 jasper 报告让你只传递一个 csv/平面文件作为它的数据源。有没有办法为它提供多个平面文件并像普通的 db 表一样查询它们？我不想先将这些数据保留在 db 中，因为它们有很多并且将这些数据存储在 db 中看起来没有必要

谢谢你的回答:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T04:19:38.603

我建议您必须编写自己的数据源，以便能够从所需的文件中读取。

或者，您自己读取所有数据并作为`List`

# php - htmlspecialchars 导致文本消失

> ID：11705829
> 
> 赞同：2
> 
> 时间：2012-07-29T00:56:42.210
> 
> 标签：php, htmlspecialchars, html-sanitizing

我遇到了一个导致 htmlspecialchars() 返回零长度字符串的特定字符串（它不是完全可打印的，但您可以在下面看到它）。有什么办法可以解决这个问题吗？

```
$Stmnt = 'SELECT subject_name FROM bans WHERE id = 2321';
$Fetch = $Conn->query($Stmnt);
if(!$Fetch)
    die('Could not query DB');
while($Row = $Fetch->fetch_array(MYSQLI_ASSOC))
{
    $RawName = $Row['subject_name'];
    $RawLen = strlen($RawName);
    echo('RAW NAME: ['.$RawName.']'.', LENGTH: ['.$RawLen.']'.'<br />');
    for($i = 0; $i < $RawLen; $i++)
        echo('CHAR '.$i.' = ['.$RawName[$i].'] (ORD: '.ord($RawName[$i]).')<br />');

    $CleanName = htmlspecialchars($RawName, ENT_QUOTES, 'UTF-8');
    $CleanLen = strlen($CleanName);
    echo('CLEAN NAME: ['.$CleanName.']'.', LENGTH: ['.$CleanLen.']'.'<br />');
    for($i = 0; $i < $CleanLen; $i++)
        echo('CHAR '.$i.' = ['.$CleanName[$i].'] (ORD: '.ord($CleanName[$i]).')<br />');
}
$Fetch->close();
echo('DONE'); 
```

输出：

```
RAW NAME: [━═★ Coммander Fι5н �], LENGTH: [31]
CHAR 0 = [�] (ORD: 226)
CHAR 1 = [�] (ORD: 148)
CHAR 2 = [�] (ORD: 129)
CHAR 3 = [�] (ORD: 226)
CHAR 4 = [�] (ORD: 149)
CHAR 5 = [�] (ORD: 144)
CHAR 6 = [�] (ORD: 226)
CHAR 7 = [�] (ORD: 152)
CHAR 8 = [�] (ORD: 133)
CHAR 9 = [ ] (ORD: 32)
CHAR 10 = [C] (ORD: 67)
CHAR 11 = [o] (ORD: 111)
CHAR 12 = [�] (ORD: 208)
CHAR 13 = [�] (ORD: 188)
CHAR 14 = [�] (ORD: 208)
CHAR 15 = [�] (ORD: 188)
CHAR 16 = [a] (ORD: 97)
CHAR 17 = [n] (ORD: 110)
CHAR 18 = [d] (ORD: 100)
CHAR 19 = [e] (ORD: 101)
CHAR 20 = [r] (ORD: 114)
CHAR 21 = [ ] (ORD: 32)
CHAR 22 = [F] (ORD: 70)
CHAR 23 = [�] (ORD: 206)
CHAR 24 = [�] (ORD: 185)
CHAR 25 = [5] (ORD: 53)
CHAR 26 = [�] (ORD: 208)
CHAR 27 = [�] (ORD: 189)
CHAR 28 = [ ] (ORD: 32)
CHAR 29 = [�] (ORD: 226)
CHAR 30 = [�] (ORD: 148)
CLEAN NAME: [], LENGTH: [0]
DONE 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-29T01:38:44.310

我现在明白为什么它返回一个零长度的字符串。很抱歉问这个问题。我应该在发布之前进行更多研究。无论如何，答案如下：

[在htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)的 PHP 手册页上：

> 如果输入字符串在给定编码中包含无效的代码单元序列，则将返回空字符串，除非设置了 ENT_IGNORE 或 ENT_SUBSTITUTE 标志。

然后我问自己这个字符串是什么“无效”？在 UTF-8 的 Wiki[页面上，](http://en.wikipedia.org/wiki/UTF-8#Description)它提供了一个很好的 UTF-8 编码图表。表示“纯文本 ASCII”的所有代码点都是 0-127（字节中的 MSB 始终为 0）。

如果一个字节的 MSB 为 1（十进制 128 到 255），它会告诉 UTF-8 兼容解析器该代码点由多字节链组成。 **并且*下一个*字节的前两个 Most-Significant-Bits 必须是 1，后跟 0。**

显然在这个字符串中，存在一个字节超过 127 而后面的字节不是以 1 和 0 开头的情况。因此它是无效的 UTF-8 编码。

感谢[这篇 SO 帖子](https://stackoverflow.com/questions/8205729/unicode-replacement-characters-in-the-php-htmlspecialchars-function?rq=1)的解决方案，在我看来，该解决方案是使用 ENT_SUBSTITUTE 标志（或者我认为 ENT_IGNORE 如果您确定删除这些不合格字节不会是[安全问题](http://unicode.org/reports/tr36/#Deletion_of_Noncharacters)）。

# javascript - 按位交叉两个整数

> ID：11705830
> 
> 赞同：7
> 
> 时间：2012-07-29T00:56:43.990
> 
> 标签：javascript, bit-manipulation, genetic-algorithm

我目前正在尝试实现一个非常简单的遗传算法示例。

有一次，你必须用两个数字（父母）做一个“交叉”（生物学）才能得到一个“孩子”。

你可以在这里找到 CrossOver 的解释：

[如何“交叉”两个字符串（1234 & abcd -> 12cd & ab34）](https://stackoverflow.com/questions/5189168/how-to-crossover-two-strings-1234-abcd-12cd-ab34)

（第二个插图，更简单的“单点”交叉是我想要做的。）

染色体（父母和孩子）是数字，但“交叉”将是一个位操作。

我找到了一个“染色体”的解决方案，如下所示：

*   将位 X 向右移动（`>>>`运算符）
*   然后将位再次移动 X 位置，但这次向左移动（`<<`运算符）

所以这将保留一条染色体的末端，并用 0 填充开头。

但我真的不知道如何解决另一条染色体的问题，然后也做交叉。

（一旦我保留染色体的开头/结尾并用 0 填充其余部分，可能是 XOR。）

或者我什至应该从另一个角度解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:11:24.740

如果交叉的分数是 p（例如，p = .25），那么这应该有效：

```
mask1 = ((0xffff >> 16*p) << 16*p)
mask2 = 0xffff ^ mask1
output1 = (input1 & mask1) ^ (input2 & mask2)
output2 = (input1 & mask2) ^ (input2 & mask1) 
```

几点注意事项：

*   这只是伪代码。你可能想要一些演员表。
*   这对 p 的处理与您在上面的评论中对它的处理不同。（只需将 p 替换为 1-p 即可得到您对 p 的定义。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T01:16:10.873

一种天真的方法是使用 4 个局部变量：

```
int chromatid1Start;
int chromatid1End;
int chromatid2Start;
int chromatid2End; 
```

然后，将输入分配给`chromatid1`前两个变量和`chromatid2`后两个变量。

```
chromatid1Start = chromatid1;
chromatid1End = chromatid1;
chromatid2Start = chromatid2;
chromatid2End = chromatid2; 
```

对染色单体变量执行右移`Start`直到交叉点，然后左移完全相同的量。在`End`染色单体变量上，左移到交叉点，然后右移完全相同的量。

```
chromatid1Start = (chromatid1Start >> 16 * crossoverPercent) << 16 * crossoverPercent;
chromatid1End = (chromatid1End << 16 * (1 - crossoverPercent)) >> 16 * (1 - crossoverPercent);
chromatid2Start = (chromatid2Start >> 16 * crossoverPercent) << 16 * crossoverPercent;
chromatid2End = (chromatid2End << 16 * (1 - crossoverPercent)) >> 16 * (1 - crossoverPercent); 
```

这样，您可以将一个的开头与另一个的结尾交叉：

```
int daughterChromatid1 = chromatid1Start + chromatid2End;
int daughterChromatid2 = chromatid2Start + chromatid1End; 
```

# javascript - 将参数从 javascript 传递到 JSP

> ID：11705831
> 
> 赞同：1
> 
> 时间：2012-07-29T00:56:56.343
> 
> 标签：javascript, html, jsp

我正在尝试编写下一个代码。我有一个图像和一个按钮。单击图像时，我想更改按钮的值（标题）。谁能告诉我这里有什么问题？（如果你发现愚蠢的错别字忽略它，我不会复制粘贴所有内容）。

还有另一个关于脚本部分的问题（可能与我的问题有关）：方法 request.getParameter(imageId) 真的返回函数的上述参数吗？

JSP：

```
<%

String messageButton = "Click me!";

%>

<%!

public void changeStatusButton(String i_MessageButton)
{
    i_MessageButton = "You Clicked The Image!";
}

%> 
```

html头：

```
<script>

    button imageClicked(imageId) {

        <% changeStatusButton(request.getParameter(imageId)) %>    

    }

</script> 
```

html正文：

```
<input type="image" id="greatimage" onclick="imageClicked(id)"/>
<input id="mybutton" type="button" value="<%=messageButton%>"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:39:33.563

脚本中的所有代码都将在服务器端执行。没有 java 代码从服务器输出，输出的只是 HTML，即使它们都在同一个 JSP 中。您的 JSP 代码应如下所示 -

```
<% String messageButton = "Click me!"; %> // server-side code
<script type="text/javascript"> // client side code
    function imageClicked() {
        document.getElementById("mybutton").value = "You Clicked The Image!";
    }

</script>

<input type="image" id="greatimage" onclick="imageClicked();"/> // client side code
<input id="mybutton" type="button" value="<%=messageButton%>"/> // client side code with <%=messageButton%> evaluated at server side. 
```

因此，当生成 HTML 代码时，从服务器输出并在浏览器中呈现的内容是：

```
<script type="text/javascript">
    function imageClicked() {
        document.getElementById("mybutton").value = "You Clicked The Image!";
    }

</script>

<input type="image" id="greatimage" onclick="imageClicked();"/>
<input id="mybutton" type="button" value="Click me!"/> 
```

甚至您的变量也`messageButton`不会到达客户端，因为那是在 scriptlet 中。

# shopify - Shopify - 用订单填充测试商店

> ID：11705832
> 
> 赞同：2
> 
> 时间：2012-07-29T00:57:13.877
> 
> 标签：shopify

我正在构建一个使用商店订单信息的 shopify 应用程序。为了正确测试它，我需要一个测试店，里面有很多订单（1000+）。

有没有一种简单的方法可以用 1000 多个订单填充测试商店？

据我所知，没有API，需要手动输入订单。我希望有办法填充这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T12:30:19.973

目前没有通过 API 或其他方式人工创建订单以进行测试的规定。

要针对大量订单进行测试，您可以模拟它们或通过将应用提交到[Shopify 应用商店](http://apps.shopify.com/categories/beta?filter=all)来向 beta 测试人员开放应用。

# javascript - 三.JS、Amazon S3 和托管 JS 文件的访问控制源错误

> ID：11705833
> 
> 赞同：3
> 
> 时间：2012-07-29T00:57:25.710
> 
> 标签：javascript, amazon-s3, xss, three.js

## 背景

我们使用 Javascript 库 Three.JS 来可视化存储在 Amazon S3 上的模型。

我对所有模型都使用 JSONLoader。其他格式缺乏我们团队需要的工具链支持，而 COLLADA 或 OBJ 等常见格式似乎是包含加载程序库的二等公民（例如，在“示例”下的源代码树中可以找到它们。 . JSONLoader 位于核心加载程序文件夹中）。

我有大型模型文件，因此将它们及其相关资产存储在 Amazon S3 存储中，那里的带宽和空间相对便宜。目的是使用 Three.JS 的 Web 应用程序从我们在 Amazon 上的存储中加载模型，一切正常。

## 问题

不幸的是，这些模型是 Javascript 文件（例如“modelBlah.js”），当它们被 JSONLoader 加载时，任何理智的浏览器都会立即抱怨我们违反了脚本的同源策略这一事实——例如，我们'正在加载并尝试评估来自与调用脚本（这是应用程序的主要工具）不同域的脚本。

因此，我们似乎已经面对多年的网络安全最佳实践。

## 到目前为止的解决方案

*   *自己托管模型？*我们现在正在使用 Heroku，理想情况下，我们希望使用专门标榜为“比特和带宽的大桶”的服务，而不是自己做。

*   *使用 DNAME 记录来欺骗资源的来源？*不幸的是，这似乎不足以欺骗浏览器，因为用于媒体托管的子域仍然会激怒浏览器的安全性。

*   *使用 CORS，特别是 Access-Control-Allow-Origin 标头？*Amazon S3 的简短浏览似乎不允许这样做，尽管我希望是错误的。即便如此，这样就够了吗？

* * *

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:27:31.450

您现在终于可以在 Amazon 上使用 CORS：http: [//docs.amazonwebservices.com/AmazonS3/latest/dev/cors.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/cors.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T01:46:28.373

你肯定需要 CORS，我认为 S3 允许它。否则，这个周末我不得不在启用了 CORS 的谷歌云存储上设置一个存储桶，这相当容易（使用 gsutil）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T20:00:48.830

S3 还不允许您设置 COR。为了解决这个确切的问题，我最终运行了一个 EC2 实例来充当下载模型的代理服务器。代理（当前只是运行节点）从 S3 获取文件，设置 CORs 标头并将其传递给应用程序。节点设置有很多选项，包括 knox 或 bufferjs。

# python - 将正则表达式与斜纹一起使用

> ID：11705835
> 
> 赞同：3
> 
> 时间：2012-07-29T00:57:40.280
> 
> 标签：python, regex, beautifulsoup, twill

我目前正在使用 urllib2 和 BeautifulSoup 来打开和解析 html 数据。但是，我遇到了一个在页面呈现后使用 javascript 加载图像的网站的问题（我试图在页面上找到某个图像的图像源）。

我在想 Twill 可能是一个解决方案，并且正在尝试打开页面并使用带有“find”的正则表达式来返回我正在寻找的 html 字符串。我在让它工作时遇到了一些麻烦，而且似乎找不到任何关于如何将正则表达式与斜纹一起使用的文档或示例。

任何有关如何执行此操作或解决此问题的帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T21:24:20.250

斜纹不适用于 javascript（请参阅[http://twill.idyll.org/browsing.html](http://twill.idyll.org/browsing.html)）

如果要处理 javascript，请使用 webdriver

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T20:50:13.703

我宁愿在页面源代码上使用 CSS 选择器或“真实”正则表达式。斜纹布是 AFAIK 尚未开发。您是否尝试过使用 CSS 选择器的 BS 或 PyQuery？

# html - 精灵的 HTML

> ID：11705840
> 
> 赞同：1
> 
> 时间：2012-07-29T00:58:42.933
> 
> 标签：html, css

所以我已经设置`Compass`了使用`SCSS`. 一切顺利，它为我生成了一些不错的 CSS :-

```
.icons-sprite, .actions-new, .actions-edit, .actions-save, .actions-delete, .actions-refresh {
  background: url('/content/themes/admin/images/icons-s0336d5eb89.png') no-repeat;
}

.actions-new {
  background-position: 0 -48px;
}

... ... ... 
```

现在我正在创建一个表，在该表中有一个“操作列”，您可以在其中对行执行功能（删除或编辑）。

使用精灵显示这些按钮的普遍接受的方式（在 html 5 中）是什么？

我探索了一些选择并遇到了一些问题

*   `span`除非我将它置于模式下，否则我无法显示它，`display: block`如果我这样做，它会在项目之后插入新行，我不想让所有东西都浮动

*   `div`由于某种原因，这个甚至没有显示

*   `img`我看到的最大问题是对`src`字段的要求，这意味着我需要一遍又一遍地复制网址。

其他人在链接内使用什么精灵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:04:04.880

使用跨度和`display: inline-block`. 这将使跨度表现得像一个图像，所以你可以应用`vertical-align: middle`. 如果您在内联元素上使用它，则支持一直追溯到 IE6。

# c++ - 为什么 eclips 在我的代码中不知道 cout 和 cin？

> ID：11705843
> 
> 赞同：0
> 
> 时间：2012-07-29T01:00:29.493
> 
> 标签：c++

我是 C++ 新手，我想用 eclips 编写我的程序，但它不知道 cout 和 cin 但是我添加了 include 这是我的代码：

```
class READY {
public:
READY();
virtual ~READY();
#include <iostream.h>
int main (){
cout<<"hello";
 }

 };

#endif /* READY_H_ */ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T01:01:38.353

将包含和`main`移出类并符合`cout`条件`std::`：

```
#include <iostream>

class READY {
public:
  READY();
  virtual ~READY();
};

int main (){
  std::cout<<"hello";
} 
```

C++ 不是 Java，`main`驻留在全局范围内，而不是作为类成员。

此外，它是`<iostream>`，不是`<iostream.h>`。

无论您遵循什么教程或书籍……它都没有任何好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T01:02:02.463

您需要将其放在`#include`文件的顶部；在班级中间包含标题会做奇怪的事情！至少，它会将标题中的所有名称嵌入到您的类中；最有可能的是，它根本无法编译。

此外，现代 C++ 将`cout`标准库中定义的所有其他符号放入名为 的命名空间`std`中，因此您需要编写`std::cout`或放入“使用命名空间 std;” 在你的类定义之前，但之后`#include.`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T01:07:50.370

您的代码有几个问题：

*   #include 语句必须在类声明之外。将它们放在文件顶部而不是将它们分散在文件中是一种很好的做法，因为这样可以更容易地通过查看文件顶部而不是在整个文件中搜索#includes来检查代码中的依赖关系。
*   您的 main() 函数也必须在类之外声明和定义。与 Jave 相比，C 和 C++ 中的 main() 是一个独立函数。
*   如前所述，cin 和 cout 位于 std 命名空间中。我建议使用完全限定名称（即 std::cin 和 std::cout）来引用它们，尽管您可以在函数内部或在您的实现文件中使用`using std::cin;`and*毕竟*包含`using std::cout;`
**   您正在包括 iostream.h - 这是旧 iostreams 库的“错误”文件。符合标准的 iostream 的正确包含是`<iostream>`*

# c++ - Win32 从设备上下文创建位图到文件和/或 BLOB

> ID：11705844
> 
> 赞同：2
> 
> 时间：2012-07-29T01:01:07.577
> 
> 标签：c++, winapi, bitmap, gdi+, gdi

我想把我的窗口的上下文变成一个位图。我使用窗口通过触摸绘制基本线条。我遇到的问题是我的位图是黑色的。这可能是因为我没有正确获取设备上下文或做错了其他事情。

**函数`CreateBitmapInfoStruct`和`CreateBMPFile`来自[这个 MSDN 示例](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145119%28v=vs.85%29.aspx)。**

**另请注意，这`g_hWnd`是一个全局变量，它具有我要为其保存图片的窗口句柄。**

我的最终目标是能够将位图保存到我拥有的 mysql 字段 (BLOB) 中。这就是我原来的问题。无论如何，我首先尝试创建一个 BMP 文件。

我已经在这里和其他地方搜索过。[在此 MSDN 示例](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145119%28v=vs.85%29.aspx)之后，我在这里推荐了我找到的最佳解决方案。但是，它不起作用。

对于这个特定问题和/或将位图写入 mysql 表中的 blob 的任何帮助，将不胜感激。

这是我的代码：

```
HDC hDC = GetDC(g_hWnd); 

LPRECT rect = (LPRECT)malloc(sizeof(RECT)); 
GetWindowRect(g_hWnd,rect); 
int h = rect->right - rect->left;
int w = rect->bottom - rect->top; 
LPRECT rect = (LPRECT)malloc(sizeof(RECT)); 
GetWindowRect(g_hWnd,rect); 
HBITMAP hBmp = CreateCompatibleBitmap(hDC,w,h); 
PBITMAPINFO pbmi;
pbmi = CreateBitmapInfoStruct(g_hWnd,hBmp); 

CreateBMPFile(g_hWnd, TEXT("c:\\TEMPO\\TestG2.bmp"), pbmi, 
              hBmp, hDC) ;

ReleaseDC(g_hWnd,hDC); 

DeleteObject(hBmp); 
DeleteObject(pbmi); 
if (rect != nullptr)
    free(rect); 
```

编辑：

捕获屏幕 (getDC) 的实际答案是在 MSDN 中修改[此示例](http://msdn.microsoft.com/en-us/library/dd183402%28v=vs.85%29)。

我已经修改了这里的示例（删除拉伸）请注意，仍然使用 goto，我将删除它。
关于 GOTO 的注释...虽然我不使用它，但我也不认为它是一个问题。我认为关于 GOTO 声明已经做了太多......就像如果在汇编中，我们不会做 goto (JUMPS)

这是代码：

```
void saveBitmap()
{
    HDC hdcScreen;
    HDC hdcWindow;
    HDC hdcMemDC = NULL;
    HBITMAP hbmScreen = NULL;
    BITMAP bmpScreen;

    // Retrieve the handle to a display device context for the client 
    // area of the window. 
    hdcScreen = GetDC(NULL);
    hdcWindow = GetDC(g_hWnd);

    // Create a compatible DC which is used in a BitBlt from the window DC
    hdcMemDC = CreateCompatibleDC(hdcWindow); 
    if(!hdcMemDC)
    {
    goto done;
    }
    RECT rcClient;
    GetClientRect(g_hWnd, &rcClient);
    hbmScreen = CreateCompatibleBitmap(hdcWindow, rcClient.right-rcClient.left, 
                                       rcClient.bottom-rcClient.top);
    if(!hbmScreen)
    {
        goto done;
    }

    SelectObject(hdcMemDC,hbmScreen);

    if(!BitBlt(hdcMemDC, 
               0,0, 
               rcClient.right-rcClient.left, rcClient.bottom-rcClient.top, 
               hdcWindow, 
               0,0,
               SRCCOPY))
    {
        goto done;
    }
GetObject(hbmScreen,sizeof(BITMAP),&bmpScreen);

    BITMAPFILEHEADER   bmfHeader;    
    BITMAPINFOHEADER   bi;

    bi.biSize = sizeof(BITMAPINFOHEADER);    
    bi.biWidth = bmpScreen.bmWidth;    
    bi.biHeight = bmpScreen.bmHeight;  
    bi.biPlanes = 1;    
    bi.biBitCount = 32;    
    bi.biCompression = BI_RGB;    
    bi.biSizeImage = 0;  
    bi.biXPelsPerMeter = 0;    
    bi.biYPelsPerMeter = 0;    
    bi.biClrUsed = 0;    
    bi.biClrImportant = 0;

    DWORD dwBmpSize = ((bmpScreen.bmWidth * bi.biBitCount + 31) / 32) * 4 * 
                      bmpScreen.bmHeight;

    // Starting with 32-bit Windows, GlobalAlloc and LocalAlloc are implemented as wrapper functions that 
    // call HeapAlloc using a handle to the process's default heap. Therefore, GlobalAlloc and LocalAlloc 
    // have greater overhead than HeapAlloc.
    HANDLE hDIB = GlobalAlloc(GHND,dwBmpSize); 
    char *lpbitmap = (char *)GlobalLock(hDIB);    

    // Gets the "bits" from the bitmap and copies them into a buffer 
    // which is pointed to by lpbitmap.
    GetDIBits(hdcWindow, hbmScreen, 0,
              (UINT)bmpScreen.bmHeight,
              lpbitmap,
              (BITMAPINFO *)&bi, DIB_RGB_COLORS);

    // A file is created, this is where we will save the screen capture.
    HANDLE hFile = CreateFile(L"c:\\tempo\\captureqwsx.bmp",
                              GENERIC_WRITE,
                              0,
                              NULL,
                              CREATE_ALWAYS,
                              FILE_ATTRIBUTE_NORMAL, NULL);   

    // Add the size of the headers to the size of the bitmap to get the total file size
    DWORD dwSizeofDIB = dwBmpSize + sizeof(BITMAPFILEHEADER) + 
                        sizeof(BITMAPINFOHEADER);

    //Offset to where the actual bitmap bits start.
    bmfHeader.bfOffBits = (DWORD)sizeof(BITMAPFILEHEADER) + 
                          (DWORD)sizeof(BITMAPINFOHEADER); 

    //Size of the file
    bmfHeader.bfSize = dwSizeofDIB; 

    //bfType must always be BM for Bitmaps
    bmfHeader.bfType = 0x4D42; //BM   

    DWORD dwBytesWritten = 0;
    WriteFile(hFile, (LPSTR)&bmfHeader, sizeof(BITMAPFILEHEADER), &dwBytesWritten,  NULL);
    WriteFile(hFile, (LPSTR)&bi, sizeof(BITMAPINFOHEADER), &dwBytesWritten, NULL);
    WriteFile(hFile, (LPSTR)lpbitmap, dwBmpSize, &dwBytesWritten, NULL);

    //Unlock and Free the DIB from the heap
    GlobalUnlock(hDIB);    
    GlobalFree(hDIB);

    //Close the handle for the file that was created
    CloseHandle(hFile);

    //Clean up
done:
    DeleteObject(hbmScreen);
    DeleteObject(hdcMemDC);
    ReleaseDC(NULL,hdcScreen);
    ReleaseDC(g_hWnd,hdcWindow);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T03:32:50.263

你可以使用[GetDIBits](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144879%28v=vs.85%29.aspx) ()。此函数将图像像素数据复制到您自己分配的内存中。

有关更多详细信息和解释，请参阅[GetDIBits 并使用 X、Y 循环像素。](https://stackoverflow.com/questions/3688409/getdibits-and-loop-through-pixels-using-x-y)

# objective-c - Objective-C 运算符 (?) 和 (:)

> ID：11705848
> 
> 赞同：4
> 
> 时间：2012-07-29T01:01:38.340
> 
> 标签：objective-c, operators

`?`和在这里表示什么`:`？

```
#define MAX(a,b) ( ((a) > (b)) ? (a) : (b) ) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-29T01:10:05.833

这是一个[*三元运算符*](http://en.wikipedia.org/wiki/Ternary_operation)（在 C 中也可用，Objective C 是它的超集，以及从它借用的其他语言）。

先计算前面的表达式`?`；如果它的计算结果为非零，则将之前的子表达式`:`作为整体结果；否则，取冒号后的子表达式`:`。

请注意，两边的子表达式`:`需要具有相同的类型。

另请注意，`MAX`如果参数有副作用，使用宏进行计算可能会产生意想不到的结果。例如，`MAX(++a, --b)`将对其中一个操作数产生双倍的副作用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-29T01:09:51.190

正如 Kjuly 所说，它应该大于符号，这只是一个 if 语句。

```
(a > b) ? a : b 
```

如果`a`大于`b`则将`a`从`MAX(a,b)`函数返回，或者如果`b`大于则 if 语句将为 false 并`b`返回。

[C中的三元（条件）运算符](https://stackoverflow.com/questions/758849/the-ternary-conditional-operator-in-c)

检查埃文的答案

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-29T01:10:23.547

`?:`是三元运算符。`((a) > (b)) ? (a) : (b)`代表的是：

```
if (a > b)
  return a
else
  return b 
```

请在[此处](http://en.wikipedia.org/wiki/%3F:)参考。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-29T01:08:49.710

这是一种条件的简写符号。一种 ？乙：丙。

如果 a 为真，则为 b，否则为 c。

我相信这应该是：#define MAX(a,b) ( ((a) > (b)) ? (a) : (b) )

所以基本上，如果a大于b，那么a，否则b

# python-requests - 请求模块 Python

> ID：11705850
> 
> 赞同：1
> 
> 时间：2012-07-29T01:01:51.480
> 
> 标签：python-requests

我有一个使用 PHP 和 CURL 运行的应用程序。我的想法是将应用程序移动到 Python-Django-Requests。我一直无法工作，希望您能帮帮我。该应用程序的工作原理如下： 收集：一个号码、一条消息并通过 API 发送一条短信。

PHP 代码。 [http://pastebin.com/PqpBgstD](http://pastebin.com/PqpBgstD)

```
import requests
import cookielib
posdata = "p_num_text=00513015924048&smstemplate=&message=message_sending&txtcount=8
           +char+%3A+1+Sms&hiddcount=152"
jar = cookielib.CookieJar()
user = 'xxx'
pass = 'xxx'
values = {'app': 'page', 'inc': 'login', 'op': 'auth_login',
           'username': user, 'password': pass} # data login
r = requests.post(url, data=values, cookies=jar) # Login
values = {'app': 'menu', 'inc': 'send_sms',
           'op': 'sendsmstopv_yes'}# values ​​to enter to send the sms 
r = requests.post(url, data=values, params=posdata, cookies=jar)# enter the area sms
print r.content 
```

如何将 CURL 中的代码传递给请求？

上面的代码可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:47:34.280

您的代码将不起作用，我在下面附上了更正的代码，请注意您不需要使用`cookielib`as将生成对象。`Requests``cookie``CookieJar`

```
import requests

url = "http://dominio.com/subdominio/index.php"

username = 'xxx'
password = 'xxx'

payload = {
    'app': 'page',
    'inc': 'login',
    'op': 'auth_login',
    'username': username,
    'password': password}

r = requests.post(url, data=payload)  # Login

cSMS = "Sms"

payload = {
    'p_num_text': '00513015924048',
    'smstemplate': '',
    'message': 'message_sending',
    'txtcount': '8',
    'char': cSMS,   # your php code seems to be off for this one, double check it
    'hiddcount': '153'}

url = "http://dominio.com/subdominio/index.php?app=menu&inc=send_sms&op=sendsmstopv_yes"

r = requests.post(url, data=payload, cookies=r.cookies)  # enter the area sms

print r.text 
```

# jquery - 沿父 div 高度跟踪的浮动 div 内容

> ID：11705855
> 
> 赞同：3
> 
> 时间：2012-07-29T01:03:04.970
> 
> 标签：jquery, html, menu, css-float

我正在寻找一种 HTML5 / jquery 解决方案来将浮动 div（让我们称之为 div“A”）附加到父 div 的右侧（称之为“B”），并让 div A 在滚动期间停留在屏幕上但停止时它达到 div B 高度的顶部或底部。如果您已经看到留在屏幕上的浮动/绝对定位的社交媒体按钮（这是正确的概念），但我想将浮动限制为仅与 div B 的高度一样高或低。

下面是我制作的 [概念动画Concept Animation](http://dl.dropbox.com/u/20618553/floating%20div%20concept%20animation.swf)

如果您查看 div B，我的目标是让浮动菜单在屏幕上沿其右侧上下滚动 div B 的高度，而不是高于或低于 div B。

非常欢迎任何建议/帮助/代码片段。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:38:34.483

好的，这是我实现的脚本。我一直想把它做成一个插件，但我一直忘记这样做，但它很容易定制。

```
 $(window).scroll(function () {
            var ntMin = 130;
            var newTop = $(window).scrollTop();
            if (newTop <= ntMin){
                newTop = ntMin;
            }
            $("#navPane").stop()
                .animate({'top': newTop}, "slow");
    }); 
```

所以这里发生的事情是您正在向 WINDOW OBJECT 添加一个事件处理程序（为什么？因为这样如果有人在页面完全加载之前开始滚动，则移动的 div 将在页面完成时赶上，因此动画将保持流畅并在那里不会有任何样式故障）。然后，您声明一个变量 ，`ntMin`您将其设置为您希望移动 div 移动到的最小距离值（从窗口顶部测量）。接下来，您要声明一个变量 ，`newTop`并在页面上的当前滚动位置对其进行初始化。接下来，检查窗口是否移动到足以要求 div 移动。然后执行动画。

我会尽快给你发演示。我将尝试看看我是否可以先向您发送一个 html 版本。

如果您有任何问题，请告诉我。

编辑：

好吧，我不只是向您发送演示，而是将页面保存为 htm 页面，用 Lorem Ipsum 替换内容，并将结果添加到我的新开发站点上的页面中（它根本不完整 - 提前道歉）。这是[演示的链接](http://development.zacharykniebel.com/moving-side-nav-demo/demo-about-me.htm)。

出于某种原因，我似乎遇到了一些权限问题，阻止了我的徽标出现在网站上（网站根本不完整哈哈），并且它导致了一个小故障，因为导航开始低于应有的水平，但是作为一旦您移动页面，它应该返回到正确的位置。同样的错误导致它的结束也比它应该的低一点，但是，作为一个整体，它仍然可以达到它的目的。如果您有任何问题，请告诉我，祝您好运！:)

更新：我没有机会为你创建插件，但我为你写了你需要的规范。请注意，我给您的规范不一定会产生最简单的解决方案——这是故意的。我设计它们的方式是让您可以轻松地编写脚本、测试它并自定义/扩展它，以便在将其转换为插件之前添加您需要的任何其他功能。他们来了：

*   (I) 制作一个变量来保存滑动元素的当前（将是前一个）位置
    *   每当窗口滚动时，此值将在代码末尾更新
    *   该值将用于帮助确定滚动方向
*   （二）制作一个管理滑动元素CSS变化的功能
    *   此函数将从窗口滚动处理程序中调用
    *   此函数将采用一组值 { scrollTop, direction, topStop, bottomStop, ele }
        *   ele 将是滑动元素的选择器
        *   可能想要设计一个可重用的对象来保存这些值
        *   可以采用这些值和在滚动函数中创建的局部变量
            *   可以防止某些功能被多次执行
            *   从长远来看，可以让事情变得更容易
        *   对象将存储在 document.ready 处理程序的变量中
    *   函数将确定是否移动元素
        *   如果元素的方向是“向下”并且它还没有到达 (bottomStop - ele.height()) 移动
        *   如果它已经到达bottomStop 然后不要移动（使用ele.css（top：scrollTop））
        *   还必须检查以确保 ele.css("top") 是 > topStop
    *   将上述反转为向上方向
*   （三）创建窗口滚动功能：
    *   创建局部变量来保存 scrollTop 的值
    *   创建局部变量以保存布尔方向值
    *   将 scrollTop 的值与滑动元素的前一个位置进行比较
        *   如果值 scrollTop 更大，则将方向设置为指示“向下”的布尔值
        *   否则，将方向设置为指示“向上”方向的布尔值
    *   调用在 II 中创建的函数

# haskell - 出现错误时如何解决问题：不在范围内

> ID：11705856
> 
> 赞同：1
> 
> 时间：2012-07-29T01:03:25.457
> 
> 标签：haskell, emacs, haskell-platform, haskell-mode, haskell-prelude

```
*Main> :t putStrn

<交互式>:1:1:
不在范围内：`putStrn'
也许您的意思是其中之一：  
  `putStr'（从 Prelude 导入），  
  `putStrLn'（从 Prelude 导入）
```

请注意，我正在使用 haskell 模式在 emacs 中练习 haskell 编程。

即使在使用终端时，我也会收到以下错误：

```
optimight@optimight:~$ ghci  
GHCi，版本 7.4.1：http://www.haskell.org/ghc/ :? 求助  
加载包 ghc-prim ... 链接 ... 完成。
加载包 integer-gmp ... 链接 ... 完成。  
正在加载包库...链接...完成。  
Prelude> :set prompt ghci>  
ghci>:t putStrln   

<交互式>:1:1:  
    不在范围内：`putStrln'  
    也许您的意思是其中之一：  
      `putStrLn'（从 Prelude 导入），  
      `putStr'（从 Prelude 导入）
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:20:11.730

您要查找的 I/O 操作是[`putStrLn`](http://hackage.haskell.org/packages/archive/haskell2010/latest/doc/html/Prelude.html#v%3aputStrLn). 注意大写的 L——Haskell 符号区分大小写——就在最后的 n 之前，如“将字符串放在自己的*行*上”。

# magento - 更改 Magento 文件路径

> ID：11705863
> 
> 赞同：0
> 
> 时间：2012-07-29T01:04:27.313
> 
> 标签：magento, filepath

我被传下来了一个修改过的 Magento 应用程序来做一些修改，这是我第一次使用这种应用程序。在痛苦了一两天之后，我终于设法迁移了数据库。当我试图修改一些 CSS 文件时，我惊呆了，发现它没有任何效果，然后在元素检查后出现了

```
<script type="text/javascript" src="http://kicartonne.fr/js/mage/translate.js" ></script>
<script type="text/javascript" src="http://kicartonne.fr/js/mage/cookies.js" ></script>
<link rel="stylesheet" type="text/css" href="http://kicartonne.fr/skin/frontend/default/ki_cartonn/css/reset.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://kicartonne.fr/skin/frontend/default/ki_cartonn/css/boxes.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://kicartonne.fr/skin/frontend/default/ki_cartonn/css/menu.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://kicartonne.fr/skin/frontend/default/default/css/clears.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://kicartonne.fr/skin/frontend/default/default/css/print.css" media="print" /> 
```

所有文件路径都是绝对的！我怎样才能解决这个问题？我什么也找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T03:08:13.980

在 System->Configuration->Web(pretty sure) 下将基本 url 更改为您想要的站点。如果你正在检查它上面的元素，当然它是绝对的，这就是 HTML 的工作方式。内容是在运行时动态生成的。

# file-io - 如何在 Windows 8 Metro 中读取应用程序附带的文件

> ID：11705866
> 
> 赞同：0
> 
> 时间：2012-07-29T01:05:00.873
> 
> 标签：file-io, windows-8, microsoft-metro

我的应用程序附带了一个文本文件，我想在屏幕上显示它的内容。有谁知道该怎么做？通常的文件 IO 似乎不适用于 Metro。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T01:42:37.027

不确定您尝试了什么，但请查看以下内容：

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.package.installedlocation.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.package.installedlocation.aspx)

有了 StorageFolder，您就拥有了读取/写入文件的一整套功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T05:35:31.387

在我的应用程序中，我正在读取应用程序附带的 XML 文件，您可以对其进行调整以读取任何类型的文件

```
public class LocalStorage
{
    private const string SyndicationFeedCategoriesFileName = "FeedCategories.xml";

    private StorageFile _storageFile;
    private StorageFolder _storageFolder;
    public async Task<XmlDocument> Read_categories_from_disk()
    {

        try
        {
            _storageFolder = await Windows.ApplicationModel.Package.Current.InstalledLocation.GetFolderAsync("Xml");
            _storageFile = await _storageFolder.GetFileAsync(SyndicationFeedCategoriesFileName);

            var loadSettings = new XmlLoadSettings
                                   {ProhibitDtd = false, ResolveExternals = false};
            return await XmlDocument.LoadFromFileAsync(_storageFile, loadSettings);
        }
        catch (Exception)
        {
            return null;
        }
    }
} 
```

在此处查看完整的源代码[http://metrorssreader.codeplex.com/SourceControl/changeset/view/18233#263004](http://metrorssreader.codeplex.com/SourceControl/changeset/view/18233#263004)

希望有帮助

# json - 使用 HttpConnection POST 与 BlackBerry 发送 JSONObject

> ID：11705871
> 
> 赞同：3
> 
> 时间：2012-07-29T01:07:47.613
> 
> 标签：json, post, blackberry, httpconnection

我正在尝试做一个可以`JSONObject`通过`HttpConnection`POST 请求发送的 blackbery 应用程序。JSON对象是

```
{ 
   "Contrasena" : "hy1tSPQc3K4IlSZLvd7U7g==", 
   "Plataforma" : "A", 
   "Usuario" : "user2323" 
} 
```

有谁知道怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T02:20:59.003

您可以为此使用[URLEncodedPostData](http://www.blackberry.com/developers/docs/4.1api/net/rim/blackberry/api/browser/URLEncodedPostData.html)类。使用喜欢

```
 httpConn.setRequestMethod(HttpConnection.POST);

  httpConn.setRequestProperty("Content-Type", "application/json");

  URLEncodedPostData encPostData = new URLEncodedPostData("UTF-8", false);

  encPostData.setData(JsonString);//set your jsonstring

  byte[] postData = encPostData.toString().getBytes("UTF-8");   

  httpConn.setRequestProperty("Content-Length", String.valueOf(postData.length)); 

  httpConn.openOutputStream().write(encPostData.getBytes()); 

  int Response = httpConn.getResponseCode(); 
```

# python - Django 上下文列表键

> ID：11705873
> 
> 赞同：3
> 
> 时间：2012-07-29T01:08:04.930
> 
> 标签：python, django, django-testing

有没有办法在运行测试工具时获取返回的 ContextList 对象的键？

如果我有：

```
return render_to_response('x.html', 
                              {
                               'one' : 1,
                               'two' : 2,
                               'three' : 3
                               },
                              context_instance=RequestContext(request)) 
```

有没有办法循环遍历键一、二和三？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T17:33:23.690

```
keys = []
for subcontext in response.context:
  for d in subcontext.dicts:
    for k in d.keys():
      if k not in keys:
        keys.append(k)

print keys 
```

# macos - Basename 在变量周围加上单引号

> ID：11705875
> 
> 赞同：2
> 
> 时间：2012-07-29T01:08:09.523
> 
> 标签：macos, bash, quotes

我正在编写一个简单的 shell 脚本来进行自动备份，我正在尝试使用 basename 创建一个目录列表，然后他们解析这个列表以获取列表中的第一个和最后一个目录。

问题是：当我在终端中使用 basename 时，一切正常，它给了我想要的列表。例如：

```
basename -a /var/*/ 
```

给我一个 /var 中所有目录的列表，名称末尾没有 /，每行一个。但是，当我在脚本中使用它并将变量传递给 basename 时，它​​会在变量周围加上单引号：

```
while read line; do
dir_name=$(echo $line)
basename -a $dir_name/*/ > dir_list.tmp
done < file_with_list.txt 
```

使用 +x 运行时：

```
+ basename -a '/Volumes/OUTROS/backup/test/*/' 
```

因此，结果不是我需要的。

现在，我知道必须有一千种方法可以解决基本名称问题，但是我什么也学不到，对吧？;)

如何摆脱单引号？如果我的目录名称中有空格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T15:18:29.253

假设您的目标是填充`dir_list.tmp`在 中列出的每个目录下找到的目录列表`file_with_list.txt`，这可能会做到。

```
#!/bin/bash

inputfile=file_with_list.txt
outputfile=dir_list.tmp
rm -f "$outputfile"        # the -f makes rm fail silently if file does not exist

while read line; do

  # basic syntax checking
  if [[ ! ${line} =~ ^/[a-z][a-z0-9/-]*$ ]]; then
    continue
  fi

  # collect targets using globbing
  for target in "$line"/*; do
    if [[ -d "$target" ]]; then
      printf "%s\n" "$target" >> $outputfile
    fi
  done

done < $inputfile 
```

当您开发任何工具来处理您的`dir_list.tmp`文件时，请注意该文件中的特殊字符（包括空格）。

请注意，我使用`printf`而不是`echo`这样，第一个字符是连字符的目标不会导致错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T01:23:19.800

如果您的目录名称可能包含空格，则需要引用的值`dir_name`（这对于任何变量扩展都是一个好主意，无论您是否需要空格）。

```
while read line; do
  dir_name=$line
  basename -a "$dir_name"/*/ > dir_list.tmp
done < file_with_list.txt 
```

（正如 jordanm 指出的那样，您不需要引用变量赋值的 RHS。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T02:23:59.700

这可能有效

```
while read; do
  find "$REPLY" >> dir_list.tmp
done < file_with_list.txt 
```

# objective-c - 向山狮通知中心发送通知

> ID：11705880
> 
> 赞同：1
> 
> 时间：2012-07-29T01:09:32.380
> 
> 标签：objective-c, macos, notifications

我如何能够在我的 mac 应用程序中从 Objective-c 向 Mountain Lion 的通知中心发送通知？（不要与 nsnotificationcenter 混淆）。我想要一个示例项目的链接或发布的示例代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:20:34.307

看看`NSUserNotification`课堂。设置完成后，您可以通过`NSUserNotificationCenter`课程安排它，然后该课程将处理向用户的演示。

# c++ - 从编译时构建的函数数量中构建运行时 c++ 的函数

> ID：11705881
> 
> 赞同：0
> 
> 时间：2012-07-29T01:09:40.427
> 
> 标签：c++, code-generation, bytecode

我正在创建脚本语言，它首先解析代码，然后将函数（执行代码）复制到一个缓冲区\内存作为解析的代码。

有没有办法将函数的二进制代码复制到缓冲区然后执行整个缓冲区？我需要一次执行所有功能以获得更好的性能。

为了最好地理解我的问题，我想做这样的事情：

```
#include <vector>
using namespace std;

class RuntimeFunction; //The buffer to my runtime function

enum ByteCodeType {
    Return,
    None
};

class ByteCode {
    ByteCodeType type;
}

void ReturnRuntime() {
    return;
}

RuntimeFunction GetExecutableData(vector<ByteCode> function) {
    RuntimeFunction runtimeFunction=RuntimeFunction(sizeof(int)); //Returns int
    for (int i = 0 ; i < function.size() ; i++ ) {
        #define CurrentByteCode function[i]
        if (CurrentByteCode.Type==Return) {
            runtimeFunction.Append(&ReturnRuntime);
        } //etc.
        #undef
    }
    return runtimeFunction;
}

void* CallFunc(RuntimeFunction runtimeFunction,vector<void*> custom_parameters) {
    for (int i=custom_parameters-1;i>=0;--i) { //Invert parameters loop
        __asm {
            push custom_parameters[i]
        }
    }
    __asm {
        call runtimeFunction.pHandle
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T03:15:54.117

有多种方法可以做到这一点，具体取决于您希望在运行时生成代码的深度，但一种相对简单的方法是使用线程代码和线程代码解释器。

基本上，线程代码由函数指针数组组成，解释器通过数组调用每个指向的函数。棘手的部分是，您通常让每个函数返回数组元素的地址，其中包含指向要调用的下一个函数的指针，这使您无需在解释器中进行任何努力就可以实现分支和调用之类的东西

通常你使用类似的东西：

```
typedef void *(*tc_func_t)(void *, runtime_state_t *);

void *interp(tc_func_t **entry, runtime_state_t *state) {
    tc_func_t *pc = *entry;
    while (pc) pc = (*pc)(pc+1, state);
    return entry+1;
} 
```

这就是整个解释器。 `runtime_state_t`是某种包含一些运行时状态（通常是一个或多个堆栈）的数据结构。您可以通过创建一个函数指针数组`tc_func_t`并用函数指针（可能还有数据）填充它们来调用它，以空指针结尾，然后`interp`使用包含数组开头的变量的地址进行调用。所以你可能有类似的东西：

```
void *add(tc_func_t *pc, runtime_state_t *state) {
    int v1 = state->data.pop();
    int v2 = state->data.pop();
    state->data.push(v1 + v2);
    return pc; }
void *push_int(tc_func_t *pc, runtime_state_t *state) {
    state->data.push((int)*pc);
    return pc+1; }
void *print(tc_func_t *pc, runtime_state_t *state) {
    cout << state->data.pop();
    return pc; }

tc_func_t program[] = {
    (tc_func_t)push_int,
    (tc_func_t)2,
    (tc_func_t)push_int,
    (tc_func_t)2,
    (tc_func_t)add,
    (tc_func_t)print,
    0
};

void run_prgram() {
    runtime_state_t  state;
    tc_func_t *entry = program;
    interp(&entry, &state);
} 
```

调用`run_program`运行添加 2+2 并打印结果的小程序。

现在你可能会被稍微奇怪的调用设置弄糊涂了，在参数`interp`上有一个额外的间接级别。`entry`这样您就可以将`interp`自身用作线程代码数组中的函数，后跟指向另一个数组的指针，它将执行线程代码调用。

**编辑**

像这样的线程代码的最大问题与性能有关——线程编码的解释器对分支预测器*极其*不友好，因此性能几乎被锁定在每个分支预测错误恢复时间的一个线程指令调用上。

如果您想要更高的性能，您几乎必须进行全面的运行时代码生成。 [LLVM](http://llvm.org/)提供了一个很好的、与机器无关的接口来执行此操作，以及用于公共平台的非常好的优化器，这些优化器将在运行时生成非常好的代码。

# c++ - 如何避免错误：在抛出 'std::logic_error' 实例后调用终止 what(): basic_string::_S_construct null not valid

> ID：11705886
> 
> 赞同：23
> 
> 时间：2012-07-29T01:10:51.790
> 
> 标签：c++, libstdc++

```
if(player!=NULL)
    player->shuffled(); 
```

我这样做是为了避免将空引用传递给字符串构造函数，但是在编译时仍然会出错。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-07-29T01:29:59.497

在某个地方，不知何故，您正在调用值为 NULL的`std::string`构造函数。`const char*`

为了避免问题。不要那样做。

# php - PHP post 数组和 curl 提交

> ID：11705891
> 
> 赞同：2
> 
> 时间：2012-07-29T01:12:13.210
> 
> 标签：php, arrays, forms, post

我已经构建了一个包含大约 90 个值的表单提交。表单需要提交到另一个页面，该页面具有处理最后一部分的 curl 会话。我的问题是，当我提交该表单时，如何将 $_Post[] 数据作为一个**整体**访问，以便我可以将其作为 curl post 数组提交？

需要得到

```
<form name="send" action="process.php" method="post">
<input 1>
<inpit 2>
...
<input 90>
</form> 
```

到

*进程.php*：

```
curl_setopt( $ch, CURLOPT_POSTFIELDS, $_Post[] ); 
```

还是像放 $Post[] 一样简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:23:02.553

从[手册](http://php.net/manual/en/function.curl-setopt.php)中，该`CURLOPT_POSTFIELDS`值可以是查询字符串格式，`var1=value1&var2=value2...`也可以是数组格式，键是字段名称，例如您使用`$_POST`.

您当前`$_POST[]`在您的示例中使用；放下`[]`它，它应该可以正常工作：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, $_POST); 
```

# ios - 避免纹理切换（openGL es 2.0）

> ID：11705892
> 
> 赞同：2
> 
> 时间：2012-07-29T01:12:16.270
> 
> 标签：ios, opengl-es, rendering, glsl

我正在为 IOS 开发小型 2d 渲染引擎。我想渲染许多位于不同纹理中的精灵。现在听起来很简单......只需渲染属于相同纹理的所有精灵并移动到下一个......但是如何处理具有不同纹理的图元的重叠？

![问题](../Images/295c8290498496b1bfdb9581771b04d7.png)

我想以与图片完全相同的方式渲染它们（重叠）。这意味着我需要切换纹理三次。如果我有数百个这样的混合精灵怎么办？避免在客户端上切换纹理并一次性渲染所有精灵。我在片段着色器中使用以下代码：

```
if(txt >= 0.5)
    gl_FragColor = texture2D(texture1, texCoords)* clr;

if (txt >= 1.5)
    gl_FragColor = texture2D(texture2, texCoords)* clr;

if (txt >= 2.5)
    gl_FragColor= texture2D(texture3, texCoords)* clr;

if (txt >= 3.5)
    gl_FragColor = texture2D(texture4, texCoords)* clr;

if (txt >= 4.5)
    gl_FragColor = texture2D(texture5, texCoords) * clr; 
```

由于动态分支，我在设备上运行时遇到性能问题。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T20:37:54.673

假设你有一个真正的性能问题的证据（除非你这样做，否则你不应该为此烦恼），解决方案很简单：使用你的深度缓冲区。

使用正交投影，这样精灵在向前移动时不会变大/变小。给每个精灵一个深度值，让深度测试去除精灵中不需要的部分。

# core-plot - 如何在Coreplot中获取图框

> ID：11705893
> 
> 赞同：0
> 
> 时间：2012-07-29T01:12:28.620
> 
> 标签：core-plot

我想得到一个情节的情节框架（下图中的橙色区域），

![情节框架](../Images/575554029cc7f3314314473dd4d4ca58.png)

但是，`graph.plotAreaFrame.frame`似乎正在返回图像中紫色区域的 NSRect（即窗口坐标中 CPTGraphHostingView 的框架）。无论我尝试什么，我似乎都无法访问对应于橙色矩形的框架矩形。

我想将橙色矩形内的一些自定义绘图与绘图数据混合。对于自定义绘图，我希望直接在图层坐标系中绘制，而不是转换为绘图点。为此，我将 CPTScatterPlot 子类化。我知道我可以使用注释层，但这似乎没有我需要的灵活性。

最良好的祝愿，

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T16:38:51.570

橙色区域称为“地块区域”。您可以使用`graph.plotAreaFrame.plotArea`.

# c - 外部变量 C

> ID：11705894
> 
> 赞同：1
> 
> 时间：2012-07-29T01:12:43.383
> 
> 标签：c

产生的错误是：分段错误

我的头文件

```
#ifndef datest
#define datest
struct date{
    char c;
    FILE* gestor;
};

typedef struct date dateStruct;
extern dateStruct date_Struct;

void loadLine();
#endif 
```

我的主程序

```
#include "myheader.h"
...

dateStruct date_Struct;

int main(int argc,char* argv[]){
        date_Struct.gestor = fopen(argv[1],"r");
        loadLine();
} 
```

我的头文件.c

```
#include "myheader.h"

void loadLine(){
    char* TEXT;
    fscanf(date_Struct.gestor, "%s\n", TEXT);  //ERROR! why?
    ...

} 
```

我无法解决这个问题，我也需要在 myheader.c 中声明 extern var 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:17:02.617

```
fscanf(date_Struct.gestor, "%s\n", TEXT);  //ERROR! why? 
```

TEXT 未初始化；它很可能指向垃圾，因此您的程序在尝试写入时会出现段错误。

您需要预先为 TEXT 分配内存，无论是在堆栈中还是使用`malloc()`（或其朋友）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T01:16:58.627

可能会发生分段错误，因为文件未成功打开并且`date_Struct.gestor`是 NULL 指针。

检查返回值`fopen()`——**总是！** 它可能会失败，如果使用空指针，则会出现分段错误。

另一个问题是`TEXT`（不要对变量使用全大写；使用小写或驼峰式并为宏保留全大写）。

指针 TEXT 不指向任何地方；它没有被初始化。当您阅读使用它时，一切都变得松散了。（指针可能指向任何地方；在最坏的情况下，它指向某个有效但出乎意料的`fscanf()`“工作”，但是您践踏了一些数据并且您不知道它是如何损坏的。分段错误是幸运的；它告诉您某些事情显然是错误的。）这更有可能是您的问题。

```
void loadLine()
{
     char TEXT[4096];
     if (fscanf(date_Struct.gestore, "%s\n", TEXT) != 1)
         ...process error... 
```

检查返回值`fscanf()`；它会告诉您它是否按预期工作。习惯于检查错误返回。总是有必要知道如何处理错误，并且通常有很多代码专门用于这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T01:18:03.283

当您尝试访问您无法访问的内容时，会发生“分段错误”，或者通常称为段错误。在您的情况下，`fscanf(date_Struct.gestor, "%s\n", TEXT);`您使用`TEXT`变量而不初始化它。

您需要首先为`TEXT`变量分配一些内存。

# javascript - 向 javascript 函数提供可能包含特殊字符的字符串参数

> ID：11705896
> 
> 赞同：3
> 
> 时间：2012-07-29T01:12:54.603
> 
> 标签：javascript, escaping

我需要将**可能**包含特殊字符的字符串传递给 Javascript 函数，如下所示。

```
function setEditMode(countryName, countryCode)
{
    document.getElementById("txtCountryName").value=countryName;
    document.getElementById("txtCountryCode").value=countryCode;        
}

<input id="txtCountryName" name="txtCountryName" type="text" maxlength="50"/><br/>

<input id="txtCountryCode" name="txtCountryCode" type="text" maxlength="2"/><br/>               

<input type="button" value="Submit" id="btnEdit" name="btnEdit" onclick="setEditMode('&#039;xx&#039; &#034;yy&#034; # $', '&#034;&#039;');" /> 
```

单击按钮时，需要将两个包含特殊字符的字符串类型参数提供给`setEditMode()`Javascript 函数。字符串需要转义。我尝试过使用该`escape()`功能，但没有奏效。有没有办法将这些参数传递给函数？（我正在处理 JSP）。

[函数的那些参数分别`setEditMode()`对应`'xx' "yy" # $`和`"'` ]。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:32:40.660

您在示例中显示的参数包含 html 实体。你想解码它们吗？Javascript 中没有本地方法可以做到这一点，但您可以使用以下代码片段（需要 jQuery）：

```
 $("<div>").html("&#034;").html(); 
```

在你的情况下：

```
 var countryName = $("<div>").html(countryName).html();
 var countryCode = $("<div>").html(countryCode).html(); 
```

或使用通用函数：

```
function decodeHtmlEntities(value)
{
   return $("<div>").html(value).html();
} 
```

和

```
function setEditMode(countryName, countryCode)
{
    document.getElementById("txtCountryName").value=decodeHtmlEntities(countryName);
    document.getElementById("txtCountryCode").value=decodeHtmlEntities(countryCode);        
} 
```

或者使用这个函数：[http](http://phpjs.org/functions/html_entity_decode:424) ://phpjs.org/functions/html_entity_decode:424 如果你不想用 jQuery 创建 div 标签。

编辑：根据您的评论。似乎是内联脚本中的实体的`"`问题`'`。您可以通过调用这样的方法来解决它：

```
<input type="button" value="Submit" id="btnEdit" name="btnEdit" onclick="setEditModeWrapper()" />
<script type="text/javascript">
    function setEditModeWrapper()
    {
        setEditMode('&#039;xx&#039; &#034;yy&#034; # $', '&#034;&#039;');
    }
</script> 
```

如果您希望在输入字段中对这些 ' 进行解码，请将此解决方案与上述解码功能结合使用。

或者更优雅：

```
<input type="button" value="Submit" class="submitBtn" id="btnEdit" name="btnEdit" data-countryname="&#039;xx&#039; &#034;yy&#034; # $" data-countrycode="&#034;&#039;" />

<script tyoe="text/javascript">
$(".submitBtn").on("click", function(e)
{
    var btn = $(e.currentTarget);
    var countryName = btn.attr("data-countryname");
    var countryCode = btn.attr("data-countrycode");
    setEditMode(countryName, countryCode);
});
</script> 
```

将脚本标签放在页面底部，它将根据其 data-countryname 和 data-countrycode 属性处理所有提交按钮。以与在 onclick 处理程序中呈现数据相同的方式呈现它们。

# java - 以编程方式获取 Android 设备的 MAC

> ID：11705906
> 
> 赞同：100
> 
> 时间：2012-07-29T01:17:01.277
> 
> 标签：java, android, mac-address

我需要使用 Java 获取我的 android 设备的 MAC 地址。我在网上搜索过，但没有找到任何有用的东西。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-07-29T01:32:42.057

正如评论中已经指出的那样，可以通过[WifiManager](http://developer.android.com/reference/android/net/wifi/WifiManager.html)接收 MAC 地址。

```
WifiManager manager = (WifiManager) getSystemService(Context.WIFI_SERVICE);
WifiInfo info = manager.getConnectionInfo();
String address = info.getMacAddress(); 
```

也不要忘记将适当的权限添加到您的`AndroidManifest.xml`

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/> 
```

请参阅[Android 6.0 更改](https://developer.android.com/about/versions/marshmallow/android-6.0-changes.html#behavior-hardware-id)。

> 为了给用户提供更好的数据保护，从这个版本开始，Android 移除了对使用 Wi-Fi 和蓝牙 API 的应用程序的设备本地硬件标识符的编程访问。WifiInfo.getMacAddress() 和 BluetoothAdapter.getAddress() 方法现在返回 02:00:00:00:00:00 的常量值。
> 
> 要通过蓝牙和 Wi-Fi 扫描访问附近外部设备的硬件标识符，您的应用现在必须具有 ACCESS_FINE_LOCATION 或 ACCESS_COARSE_LOCATION 权限。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2016-02-25T23:03:54.587

通过获取 MAC 地址[`WifiInfo.getMacAddress()`](https://developer.android.com/reference/android/net/wifi/WifiInfo.html#getMacAddress())在 Marshmallow 及更高版本上不起作用，它已被禁用并将[返回`02:00:00:00:00:00`](https://developer.android.com/about/versions/marshmallow/android-6.0-changes.html#behavior-hardware-id).

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-09-30T12:53:55.197

```
public static String getMacAddr() {
    try {
        List<NetworkInterface> all = Collections.list(NetworkInterface.getNetworkInterfaces());
        for (NetworkInterface nif : all) {
            if (!nif.getName().equalsIgnoreCase("wlan0")) continue;

            byte[] macBytes = nif.getHardwareAddress();
            if (macBytes == null) {
                return "";
            }

            StringBuilder res1 = new StringBuilder();
            for (byte b : macBytes) {
                res1.append(String.format("%02X:",b));
            }

            if (res1.length() > 0) {
                res1.deleteCharAt(res1.length() - 1);
            }
            return res1.toString();
        }
    } catch (Exception ex) {
    }
    return "02:00:00:00:00:00";
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2017-06-06T10:35:10.247

[我从http://robinhenniges.com/en/android6-get-mac-address-programmatically](http://robinhenniges.com/en/android6-get-mac-address-programmatically)创建了这个解决方案，它对我有用！希望有所帮助！

```
public static String getMacAddr() {
    try {
        List<NetworkInterface> all = Collections.list(NetworkInterface.getNetworkInterfaces());
        for (NetworkInterface nif : all) {
            if (!nif.getName().equalsIgnoreCase("wlan0")) continue;

            byte[] macBytes = nif.getHardwareAddress();
            if (macBytes == null) {
                return "";
            }

            StringBuilder res1 = new StringBuilder();
            for (byte b : macBytes) {
                String hex = Integer.toHexString(b & 0xFF);
                if (hex.length() == 1)
                    hex = "0".concat(hex);
                res1.append(hex.concat(":"));
            }

            if (res1.length() > 0) {
                res1.deleteCharAt(res1.length() - 1);
            }
            return res1.toString();
        }
    } catch (Exception ex) {
    }
    return "";
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-04T14:35:45.413

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />

public String getMacAddress(Context context) {
    WifiManager wimanager = (WifiManager) context.getSystemService(Context.WIFI_SERVICE);
    String macAddress = wimanager.getConnectionInfo().getMacAddress();
    if (macAddress == null) {
        macAddress = "Device don't have mac address or wi-fi is disabled";
    }
    return macAddress;
} 
```

[这里](https://stackoverflow.com/questions/6191832/get-mac-address-of-android-device-without-wifi/15183653#comment21394080_15183653)有其他方式

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-06-15T12:09:00.750

**它与棉花糖一起工作**

```
package com.keshav.fetchmacaddress;

import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;

import java.net.InetAddress;
import java.net.NetworkInterface;
import java.net.SocketException;
import java.net.UnknownHostException;
import java.util.Collections;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Log.e("keshav","getMacAddr -> " +getMacAddr());
    }

    public static String getMacAddr() {
        try {
            List<NetworkInterface> all = Collections.list(NetworkInterface.getNetworkInterfaces());
            for (NetworkInterface nif : all) {
                if (!nif.getName().equalsIgnoreCase("wlan0")) continue;

                byte[] macBytes = nif.getHardwareAddress();
                if (macBytes == null) {
                    return "";
                }

                StringBuilder res1 = new StringBuilder();
                for (byte b : macBytes) {
                    res1.append(Integer.toHexString(b & 0xFF) + ":");
                }

                if (res1.length() > 0) {
                    res1.deleteCharAt(res1.length() - 1);
                }
                return res1.toString();
            }
        } catch (Exception ex) {
            //handle exception
        }
        return "";
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-09-02T11:25:38.853

您无法再获取 android 设备的硬件 MAC 地址。WifiInfo.getMacAddress() 和 BluetoothAdapter.getAddress() 方法将返回 02:00:00:00:00:00。此限制是在 Android 6.0 中引入的。

但是 Rob Anderson 找到了一个适用于 < Marshmallow 的解决方案：[https ://stackoverflow.com/a/35830358](https://stackoverflow.com/a/35830358)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-07-16T11:10:33.930

你可以得到mac地址：

```
WifiManager wifiManager = (WifiManager) getSystemService(Context.WIFI_SERVICE);
WifiInfo wInfo = wifiManager.getConnectionInfo();
String mac = wInfo.getMacAddress(); 
```

在 Menifest.xml 中设置权限

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"></uses-permission> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-04-04T07:25:16.417

使用这个简单的方法

```
WifiManager wm = (WifiManager) getApplicationContext().getSystemService(Context.WIFI_SERVICE);
            String WLANMAC = wm.getConnectionInfo().getMacAddress(); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-12-11T15:41:56.273

取自[这里](https://github.com/android/platform_packages_apps_settings/blob/master/src/com/android/settings/wifi/AdvancedWifiSettings.java#L253-L265)的 Android 资源。这是在系统设置应用程序中显示您的 MAC 地址的实际代码。

```
private void refreshWifiInfo() {
    WifiInfo wifiInfo = mWifiManager.getConnectionInfo();

    Preference wifiMacAddressPref = findPreference(KEY_MAC_ADDRESS);
    String macAddress = wifiInfo == null ? null : wifiInfo.getMacAddress();
    wifiMacAddressPref.setSummary(!TextUtils.isEmpty(macAddress) ? macAddress
            : getActivity().getString(R.string.status_unavailable));

    Preference wifiIpAddressPref = findPreference(KEY_CURRENT_IP_ADDRESS);
    String ipAddress = Utils.getWifiIpAddresses(getActivity());
    wifiIpAddressPref.setSummary(ipAddress == null ?
            getActivity().getString(R.string.status_unavailable) : ipAddress);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-13T17:20:12.470

我知道这是一个非常古老的问题，但还有另一种方法可以做到这一点。下面的代码可以编译，但我还没有尝试过。您可以编写一些 C 代码并使用 JNI（Java Native Interface）来获取 MAC 地址。这是示例主要活动代码：

```
package com.example.getmymac;

import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

import androidx.appcompat.app.AppCompatActivity;

public class GetMyMacActivity extends AppCompatActivity {
    static { // here we are importing native library.
        // name of the library is libnet-utils.so, in cmake and java code
        // we just use name "net-utils".
        System.loadLibrary("net-utils");
    }

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_screen);

        // some debug text and a TextView.
        Log.d(NetUtilsActivity.class.getSimpleName(), "Starting app...");
        TextView text = findViewById(R.id.sample_text);

        // the get_mac_addr native function, implemented in C code.
        byte[] macArr = get_mac_addr(null);
        // since it is a byte array, we format it and convert to string.
        String val = String.format("%02x:%02x:%02x:%02x:%02x:%02x",
                macArr[0], macArr[1], macArr[2],
                macArr[3], macArr[4], macArr[5]);
        // print it to log and TextView.
        Log.d(NetUtilsActivity.class.getSimpleName(), val);
        text.setText(val);
    }

    // here is the prototype of the native function.
    // use native keyword to indicate it is a native function,
    // implemented in C code.
    private native byte[] get_mac_addr(String interface_name);
} 
```

以及布局文件 main_screen.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:id="@+id/sample_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/app_name"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintRight_toRightOf="parent"
        app:layout_constraintLeft_toLeftOf="parent"
        app:layout_constraintTop_toTopOf="parent"/>

</androidx.constraintlayout.widget.ConstraintLayout> 
```

清单文件，我不知道要添加什么权限，所以我添加了一些。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.getmymac">

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity android:name=".GetMyMacActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

get_mac_addr 函数的 C 实现。

```
/* length of array that MAC address is stored. */
#define MAC_ARR_LEN 6

#define BUF_SIZE 256

#include <jni.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <net/if.h>
#include <sys/ioctl.h>
#include <unistd.h>

#define ERROR_IOCTL 1
#define ERROR_SOCKT 2

static jboolean
cstr_eq_jstr(JNIEnv *env, const char *cstr, jstring jstr) {
    /* see [this](https://stackoverflow.com/a/38204842) */

    jstring cstr_as_jstr = (*env)->NewStringUTF(env, cstr);
    jclass cls = (*env)->GetObjectClass(env, jstr);
    jmethodID method_id = (*env)->GetMethodID(env, cls, "equals", "(Ljava/lang/Object;)Z");
    jboolean equal = (*env)->CallBooleanMethod(env, jstr, method_id, cstr_as_jstr);
    return equal;
}

static void
get_mac_by_ifname(jchar *ifname, JNIEnv *env, jbyteArray arr, int *error) {
    /* see [this](https://stackoverflow.com/a/1779758) */

    struct ifreq ir;
    struct ifconf ic;
    char buf[BUF_SIZE];
    int ret = 0, sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_IP);

    if (sock == -1) {
        *error = ERROR_SOCKT;
        return;
    }

    ic.ifc_len = BUF_SIZE;
    ic.ifc_buf = buf;

    ret = ioctl(sock, SIOCGIFCONF, &ic);
    if (ret) {
        *error = ERROR_IOCTL;
        goto err_cleanup;
    }

    struct ifreq *it = ic.ifc_req; /* iterator */
    struct ifreq *end = it + (ic.ifc_len / sizeof(struct ifreq));

    int found = 0; /* found interface named `ifname' */

    /* while we find an interface named `ifname' or arrive end */
    while (it < end && found == 0) {
        strcpy(ir.ifr_name, it->ifr_name);
        ret = ioctl(sock, SIOCGIFFLAGS, &ir);
        if (ret == 0) {
            if (!(ir.ifr_flags & IFF_LOOPBACK)) {
                ret = ioctl(sock, SIOCGIFHWADDR, &ir);
                if (ret) {
                    *error = ERROR_IOCTL;
                    goto err_cleanup;
                }

                if (ifname != NULL) {
                    if (cstr_eq_jstr(env, ir.ifr_name, ifname)) {
                        found = 1;
                    }
                }
            }
        } else {
            *error = ERROR_IOCTL;
            goto err_cleanup;
        }
        ++it;
    }

    /* copy the MAC address to byte array */
    (*env)->SetByteArrayRegion(env, arr, 0, 6, ir.ifr_hwaddr.sa_data);
    /* cleanup, close the socket connection */
    err_cleanup: close(sock);
}

JNIEXPORT jbyteArray JNICALL
Java_com_example_getmymac_GetMyMacActivity_get_1mac_1addr(JNIEnv *env, jobject thiz,
                                                          jstring interface_name) {
    /* first, allocate space for the MAC address. */
    jbyteArray mac_addr = (*env)->NewByteArray(env, MAC_ARR_LEN);
    int error = 0;

    /* then just call `get_mac_by_ifname' function */
    get_mac_by_ifname(interface_name, env, mac_addr, &error);

    return mac_addr;
} 
```

最后，CMakeLists.txt 文件

```
cmake_minimum_required(VERSION 3.4.1)
add_library(net-utils SHARED src/main/cpp/net-utils.c)
target_link_libraries(net-utils android log) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-12-19T09:18:26.047

此`ip link | grep -A1 wlan0`命令适用于 Android 9，来自[如何在 Termux 中确定 wifi 硬件地址](https://stackoverflow.com/questions/58463658/how-to-determine-wifi-hardware-address-in-termux)

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2018-01-19T08:14:28.133

我想我刚刚找到了一种无需 LOCATION 权限即可读取 MAC 地址的方法：运行`ip link`并解析其输出。（您可能可以通过查看此二进制文件的源代码来做类似的事情）

# python - 用python安排预订（不是餐厅）

> ID：11705908
> 
> 赞同：6
> 
> 时间：2012-07-29T01:17:06.060
> 
> 标签：python, sqlalchemy, scheduling, bottle

我正在编写一个 python 应用程序，它使用 OpenStack 为学生提供对有限数量的虚拟机的访问。

学生可以现在或将来进行预订。

我需要将随时安排的虚拟机数量限制为 X，同时在插槽/预留可用的情况下仍允许学生预留 vm。

保留对象如下所示（sqlalchemy）。我会知道所请求的预订的开始时间和时长，此时我需要检查现有的预订，看看在所请求的时间段内是否有太多的预订。*_job 字段是 APScheduler 作业的名称。

```
class Reservation(Entity):
    student = ManyToOne('Student', required=True)
    class_id = ManyToOne('Class', required=True)
    image = ManyToOne('Image', required=True)
    # openstack image id filled in once the instance is started
    instance_id = Field(UnicodeText)

    # apscheduler jobs
    stop_instance_job = Field(UnicodeText)
    start_instance_job = Field(UnicodeText)
    warn_reservation_ending_job = Field(UnicodeText)
    check_instance_job = Field(UnicodeText) 
```

关于在哪里寻找调度算法或类似的例子的任何指针？我什至不清楚要搜索什么...

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T18:05:28.757

您应该查找基于网格的调度程序。通常调度程序不知道真正的执行时间（或资源使用时间），并且使用复杂的启发式方法来猜测问题需要多长时间（请参阅网格调度程序上的此类启发式方法，网址为：[PDF 下载 描述基于网格的调度](https://www.google.com/search?sugexp=chrome,mod=13&sourceid=chrome&ie=UTF-8&q=grid%20based%20scheduler)）。使用基本网格来表示一段时间内的工作负载的更简单方法很可能满足您的需求。Python 没有我所知道的任何很棒的网格对象库（虽然我之前在 C++ 和 Python 中实现了一些，但它们并不太难）。您应该查看 numpy 包，以便更轻松地解释多维对象——它可以很容易地模拟或实现网格。

Msw 提到了 Dijkstra 的银行家算法，这是一种作业调度形式 - 但是您的问题更关心未来状态而不是当前状态，并且您可以准确预测（知道真正的价值）任务时间。因此，您在注册作业时填写的 T（时间步长）乘 N（资源数量 - 可能只是 1）乘 M（最大资源保留）网格就足够了。确定是否可以在特定时隙中安排特定作业是 O(task_length * M) 检查网格的子部分 (start, stop)x(required_resources)x(1,M) 是否有空时隙。

为特定工作（选择开始时间）找到合适的位置是一项更困难的任务，可以通过修改后的 Dijkstra 算法或任何标准调度程序来实现（msw 的评论对于此任务比对时间段能力检查更有帮助） . 请注意，许多在线调度程序内容是特定于操作系统进程调度的，它更关心操作类型（I/O 与否）以及花费比预期更长的时间而不是抽象资源使用的惩罚。因此，谷歌搜索调度程序通常会为您提供 Linux 调度程序实现，而不是针对任意数据的技术。尝试查找最短作业调度程序，当解释时，这些调度程序通常更简单且对操作系统任务的依赖程度更低。

# xcode - 升级到 Mountain Lion 和 XCode 4 破坏了我的“品牌”？

> ID：11705912
> 
> 赞同：25
> 
> 时间：2012-07-29T01:18:22.090
> 
> 标签：xcode, xcode4, makefile, osx-mountain-lion, bin

TL/DR：我升级了东西，现在我不能运行“make”-wtf？

我刚刚从 Mac OS X 10.6 升级到 10.8 Mountain Lion，然后安装了 XCode 4（以前我有 Developer/Applications/Xcode (3.something)。XCode 4 通过 App Store 应用程序安装到 /Applications。一路走来，我不能再运行“make”命令。我已经尝试在所有常用的 /bins 中查找，但找不到“make”。

有人知道如何找回我的“make”命令吗？

升级Apple的东西总是会破坏一些东西......（它也破坏了我的“git”命令，但我得到了那个）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-29T01:20:48.117

您需要按照[在 Mac 上安装“make”](https://stackoverflow.com/questions/11494522/installing-make-on-mac/11494872#11494872)中所述安装命令行工具。Xcode 4 中默认不安装它们。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-09T10:42:29.600

最简单的安装方法：

1.  启动 XCode
2.  转到首选项 > 下载 > 组件
3.  单击“命令行工具”旁边的“安装”

# ruby-on-rails - 在 Engine 内为 ActiveAdmin 注册资源

> ID：11705915
> 
> 赞同：0
> 
> 时间：2012-07-29T01:19:58.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeadmin

如果有可能，那就太好了：

*   创建引擎
*   在此引擎中创建模型（使用迁移和种子）
*   为该引擎中的每个模型创建 ActiveAdmin 资源

后来......在每个新应用程序中使用它就像包括新宝石'activeadmin_addons'一样简单

例如，我必须在每次 AdminUser 资源时手动克隆，通常是目录、用户、文章和其他一些

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:02:10.887

查看活动的管理员 wiki 条目：

[https://github.com/gregbell/active_admin/wiki/Define-a-resource-inside-an-engine](https://github.com/gregbell/active_admin/wiki/Define-a-resource-inside-an-engine)

# android - PhoneGap 联系人选择器

> ID：11705920
> 
> 赞同：3
> 
> 时间：2012-07-29T01:20:39.453
> 
> 标签：android, iphone, cordova, contacts

现在 PhoneGap 是 2.0 版，是否有（可能未记录的）方法来拥有联系人选择器？

这些文档看起来好像我必须通过请求所有用户的联系人来用 JavaScript 编写自己的，然后构建我自己的应用内联系人选择器。

[http://docs.phonegap.com/en/2.0.0/cordova_contacts_contacts.md.html#Contacts](http://docs.phonegap.com/en/2.0.0/cordova_contacts_contacts.md.html#Contacts)

我找到了适用于 Android 的一次性插件，但如果没有适用于 iPhone 的插件，那将无济于事，因为我仍然必须自己编写。我正在寻找一种与设备无关的方法，它说“让用户去选择一个联系人，然后用那个联系信息把他们发回这里”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T17:27:07.563

I don't know whether you can use this solution for Android as well but for iPhone you can use the `.chooseContact()` method.

Example:

```
 <a href="#" onclick="contactChooser()">Choose a contact</a>

    function contactChooser(){

    //The chooseContact method will open a new window with all you contacts
    navigator.contacts.chooseContact(

        //After picking a name you will receive the id of the chosen contact
        function(id){

            //In an options variable you can set some filter parameters
            //In this example we will use the Id to receive the data of the chosen contact
            var options = {
                filter: ""+id
            }

            //In the fields variable we're going to set the fields we want to receive
            //'*' = every data. More field values are explained
            // here: http://bit.ly/T8YyuE
            var fields = ['*'];

            navigator.contacts.find(fields, onPickContactSuccess, onPickContactError, options);
        }, null);
    }

    function onPickContactSuccess(contacts){
        //contacts contains all data you've requested

        var _name = contacts[0].name

        alert('Last: '+_name.familyName+' First: '+_name.givenName);
    } 
```

# mpi - 在 MPI_Bcast 中排名

> ID：11705922
> 
> 赞同：2
> 
> 时间：2012-07-29T01:21:01.040
> 
> 标签：mpi

```
MPI_Bcast(void *buffer,  int count,  MPI_Datatype datatype,  int root,  MPI_Comm comm) 
```

此函数不需要 rank 参数。它如何知道每个进程的等级？

我们应该调用`MPI_COMM_RANK()`之前的广播，是否有任何数据结构（如通信器）存储进程的等级？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T18:18:06.607

也许您认为这不可能，但 MPI 库中的函数可以在内部进行与您用来获取进程等级或通信器大小相同的 MPI 调用。这就是为什么`MPI_Bcast()`不需要调用进程的等级，因为它只是调用内部实现`MPI_Comm_rank()`来获取它。以下是 Open MPI 中的一个实现中的一个小示例（更具体地说，这是来自提供实现集体操作的算法的框架的模块`MPI_Bcast()`中的拆分二叉树实现）：`tuned``coll`

```
int
ompi_coll_tuned_bcast_intra_split_bintree ( void* buffer,
                                            int count, 
                                            struct ompi_datatype_t* datatype, 
                                            int root,
                                            struct ompi_communicator_t* comm,
                                            mca_coll_base_module_t *module,
                                            uint32_t segsize )
{
    ...
    int rank, size;
    ...

    size = ompi_comm_size(comm);
    rank = ompi_comm_rank(comm);

    ...
} 
```

如您所见，它调用了`MPI_Comm_size()`and的内部实现`MPI_Comm_rank()`。这些是 Open MPI 中非常便宜的调用。进程的等级存储在与通信器关联的*进程组*中，并在创建通信器期间复制到通信器结构中的一个字段（以节省一些 CPU 周期来取消引用组的指针）（更多信息）信息参考`openmpi-source/ompi/communicator/communicator.h`和`openmpi-source/ompi/group/group.h`）。

事实上，没有任何 MPI 通信原语明确地占据调用进程的等级——它总是在内部解决。您只需指定从哪里发送数据（例如 in `MPI_SEND`）或从哪里接收数据（例如 in `MPI_RECV`）或在具有一个的集合操作中的数据根。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T02:06:15.557

考虑三种可能的实现`MPI_Bcast()`：

1.  根发送到，然后发送到*，*然后发送到，等等。这是一个线性数量级`root+1``root+2``root+3`
2.  从*根*开始，在迭代时拥有数据副本的每个进程都将数据`N`转发到`rank xor 2^N`. 这是对数数量级。
3.  *root*使用路由器对网络上的每个进程执行多播。这是一个恒定的数量级。

在这些场景中的每一个中，`MPI_Bcast()`函数都知道哪个进程将获得下一条消息。在第一种和第三种情况下，任何*非根*进程都将简单地接收数据；第二，每个进程收到数据后会继续转发过程。但是，在所有实现中，发送和接收的顺序是确定的，基于哪个进程是*根*。（这就是为什么所有进程都必须调用`MPI_Bcast()`，无论是否为*root*。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T06:20:26.843

你是对的，排名存储在通信器中，并且可以在`MPI_Bcast`内部实现。创建通信器时分配等级。例如，`MPI_COMM_WORLD`由`MPI_Init`.

`MPI_Comm_rank`只需从通信器获取排名值。无需在广播前调用它。然而，知道排名通常是进行任何有意义的编程所必需的。

请注意，由于`MPI_Bcast`是集体调用，因此需要由通信器中的所有进程执行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-29T01:55:06.093

`int root`, 是广播根的等级，本质上是 MPI 广播从等级根向所有其他等级发送消息

我也认为在 MPI_Init 之后调用以下内容是“最佳实践”

```
 MPI_Comm_rank(MPI_COMM_WORLD, &rank); 
```

这将为每个处理器或内核分配一个从 0 到 n-1 的 int rank 值

和

```
MPI_Comm_size( MPI_COMM_WORLD, &Numprocs); 
```

这将创建一个 int，其中 Numproces 是处理器的总数

# facebook - Facebook 照片宽度，高度 0

> ID：11705923
> 
> 赞同：0
> 
> 时间：2012-07-29T01:21:10.203
> 
> 标签：facebook

有时 Facebook 的照片 JSON 数据很奇怪。

[https://developers.facebook.com/docs/reference/api/photo/](https://developers.facebook.com/docs/reference/api/photo/)

1.  有时没有定义宽度或高度，即使它应该是
2.  有时宽度或高度为0，这时照片显然不是

有谁知道这可能会发生什么？

# c++ - GLSL - GLSL 1.2 中的统一位置和着色器中的深度测试

> ID：11705924
> 
> 赞同：2
> 
> 时间：2012-07-29T01:21:13.313
> 
> 标签：c++, opengl, glsl, shader

两个问题：

1.  我正在使用不同着色器的大型 VBO 中渲染元素。在 GLSL 1.2 中，如果我是正确的，我必须使用它，因为它是 OSX 上的最新版本不支持统一位置，我认为这意味着您的属性的位置是编译器决定的任何位置。有没有办法解决？例如，当我的 VBO 使用交错 (x,y,z,nx,ny,nz,texU,texV) 时，我需要多个着色器才能每次都在同一个地方访问这些属性。然而，我发现编译器给了它们不同的位置，导致该位置成为法线，依此类推。我需要它们的位置与我的 VBO 属性位置一致。

2.  我刚刚完成了我的第一个 GLSL 渲染，看起来就像我忘记启用深度测试一样，各种多边形相互叠加。我启用了深度测试：

    ```
    glEnable(GL_DEPTH_TEST); 
    ```

    问题仍然存在。是否有不同的方法可以使用着色器启用它们？我以为深度缓冲区会解决这个问题？

    问题 2 已解决。原来是一个 SFML 问题，我需要在创建窗口时指定 OpenGL 设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T20:48:23.183

属性位置指定在 3 个位置之一，从最高优先级到最低优先级：

1.  通过使用 GLSL 3.30（或更好）或 ARB_explicit_attrib_location 扩展语法`layout(location = #)`，其中`#`是属性索引。因此，如果我有一个名为 的输入`position`，我会给它索引 3，如下所示：

    ```
    layout(location = 3) in vec4 position; 
    ```

    这是我首选的处理方法。Explicit_attrib_location 可用于几乎所有仍受支持的硬件（不是英特尔）。

2.  通过 显式关联[`glBindVertexAttrib`](http://www.opengl.org/wiki/GLAPI/glBindAttribLocation)。在链接程序*之前*调用此函数。要做到以上几点，我们会这样做：

    ```
    GLuint program = glCreateProgram();
    glAttachShader(program, some_shader);
    glBindVertexAttrib(program, 3, "position");
    glLinkProgram(program); 
    ```

    您可以设置多个属性。实际上，您可以将多个属性名称设置为同一个索引。这样做的想法是能够自动设置一堆映射并让 OpenGL 找出哪个与实际的着色器代码一起使用。因此，您可以将“位置”和“轴”映射到索引 3，只要您不将着色器放入具有这两个输入的系统中，就可以了。

    请注意，您还可以设置*不存在*的属性。您可以给“正常”一个未在着色器中指定的属性。*那很好*；链接器只关心实际存在的属性。因此，您可以为此类事情建立一个复杂的约定，并在链接之前运行每个程序：

    ```
    void AttribConvention(GLuint prog)
    {
      glBindVertexAttrib(program, 0, "position");
      glBindVertexAttrib(program, 1, "color");
      glBindVertexAttrib(program, 2, "normal");
      glBindVertexAttrib(program, 3, "tangent");
      glBindVertexAttrib(program, 4, "bitangent");
      glBindVertexAttrib(program, 5, "texCoord");
    }

    GLuint program = glCreateProgram();
    glAttachShader(program, some_shader);
    AttribConvention(program);
    glLinkProgram(program); 
    ```

    即使一个特定的着色器没有所有这些属性，它仍然可以工作。

3.  让OpenGL分配它。如果您没有以其他方式之一为属性分配属性索引，则 GLSL 链接器将为您分配它。您可以使用[`glGetAttribLocation`](http://www.opengl.org/wiki/GLAPI/glGetAttribLocation).

    我真的不建议这样做，因为 OpenGL 会*任意*分配索引。因此，每个使用命名属性的着色器都`position`可能在不同的索引中具有位置。我不认为这是一个好主意。因此，如果您不能在着色器中显式设置它，那么至少在链接之前在您的 OpenGL 代码中显式设置它。这样，您可以对属性索引 0 的含义、索引 1 的含义等有一个约定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T01:35:53.440

在 OpenGL 3.3+ 上，您有 VAO，当您使用它们时，您确实将 VBO 绑定到它，并且您可以按自定义顺序定义属性：[http](http://www.opengl.org/sdk/docs/man3/xhtml/glEnableVertexAttribArray.xml) ://www.opengl.org/sdk/docs/man3/xhtml/glEnableVertexAttribArray.xml （记住属性必须是连续的）

可以在 XNA 上找到一个很好/简单的实现：[VertexDeclaration](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.vertexdeclaration.aspx)，您可能还想查看所有 Vertex* 类型。

关于让 v3 与 SFML 一起工作的一些提示： [http ://en.sfml-dev.org/forums/index.php?topic=6314.0](http://en.sfml-dev.org/forums/index.php?topic=6314.0)

关于如何创建和使用 VAO 的示例：[http ://www.opentk.com/files/issues/HelloGL3.cs](http://www.opentk.com/files/issues/HelloGL3.cs)

（这是 C# 但我想你会明白的）

**更新 ：**

在 v2.1 上，您也拥有它[http://www.opengl.org/sdk/docs/man/xhtml/glEnableVertexAttribArray.xml](http://www.opengl.org/sdk/docs/man/xhtml/glEnableVertexAttribArray.xml)，尽管您无法创建 VAO。可以实现几乎相同的功能，但您每次都必须绑定属性，因为它将位于固定管道上。

# objective-c - 目标 C：关于时间和数组的问题

> ID：11705925
> 
> 赞同：0
> 
> 时间：2012-07-29T01:22:02.103
> 
> 标签：objective-c, xcode

Q1。NSDate *now = [NSDate 日期]；
NSLog(@"当前日期：%@",now);

显示的时间比系统时间早 4 小时。我想知道为什么会这样，我该如何纠正它？

Q2.. 在 C/C++ 中，字符串被视为字符数组。在 Objective-C 中也是这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T01:24:42.827

```
NSDate *now = [NSDate date];
NSLog(@"Current date:%@",now); 
```

是“现在”而不是“日期”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T03:17:59.863

A1：`NSLog(@"%@", now)`实际上与 相同`NSLog(@"%@", [now description])`。NSDate 对象不关心时区是什么，因此它的`description`方法只会为您提供 UTC 时间。如果您需要使用正确的时区和语言环境进行格式化，则需要先使用 NSDateFormatter 对象将其转换为格式良好的字符串。

A2：有也没有，但大多没有。你可以这样做：

`char *cString = "I am a C string";`

创建一个 C 字符串，您可以像在 C 中一样对待它。不过，这在 Objective-C 中很少见，除非绝对必要。使用字符串的“正常”方式是使用 NSString 或 NSMutableString 的实例，它们是成熟的对象：

`NSString *normalString = @"I'm above all that.";`（注意`@`符号）

# python - python字符计数请帮助我我是nooob

> ID：11705928
> 
> 赞同：-2
> 
> 时间：2012-07-29T01:23:03.537
> 
> 标签：python

嗨，伙计们，python 有点麻烦，对它很陌生，我试图计算某组字符在一行中出现的次数，无论如何我可以让它计数，但它计数为 4，即。

```
a = raw_input('insert pirate bob speak line line 1 - ')
b = raw_input('insert pirate bob speak line line 2 - ')
c = raw_input('insert pirate bob speak line line 3 - ') 
```

我试图让 t 计算一个句子中有多少次 rr 但只有当我使用**1.yarrrr harrr** me hearties**和一瓶 rrrrum** **的必要输入启动完整代码时才会出现双重问题amout of double rs 我只想知道有多少句子包含 double r**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:16:16.213

如果您希望每行找到一个 rr：

```
import re
myline = 'harrrr!'
matches = re.findall('(rr+)',myline)
if matches: 
    print "exactly",len(matches)," rr was found" 
```

解释：

要了解有关正则表达式的更多信息，请键入 help(re)

这个特殊的正则表达式表示：搜索一行中的所有组，包含两个或多个 'r's

如果要搜索 rr-s 而不是 rrrs，请使用：

```
re.findall('(?:[^|[^r])(rr)(?:[^r]|$)', 'harrrarrr') 
```

哪个稍微困难一些（搜索所有那些'rr'，它们前面有一个不是r的字符或行从那里开始，然后是一个不是r的字符，或者行在那里结束，虽然不关心这些后面和前面的字符）

一般来说，您可以通过以下方式改进“控制流”：

```
import re
while True: #forever or at least until break-[up], you know, love-style forever;)
    line = raw_input("Howdy? ")
    if line: # if the user actually typed in something
        matches = re.findall('(rr+)',line)
        if matches: 
            print "exactly",len(matches)," rr was found"
        else:
            print "you'rrre NOT a pirrate!"
    else:
        break #quit 
```

# android - 应用程序意外停止，显示错误

> ID：11705934
> 
> 赞同：-1
> 
> 时间：2012-07-29T01:26:31.930
> 
> 标签：android

我正在开发文本到语音应用程序。我已经给出了一个输入字符串并通过按钮进行转换。当我单击按钮时，应用程序意外关闭。当输入被硬编码时，应用程序运行良好。

```
EditText text;
String[] texts ;
TextToSpeech tts;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    texts = new String[3];
    text = (EditText)findViewById(R.id.ttexttovoice);
    //Editable debug = text.getText();
    texts[0] = text.getText().toString();
    Button b = (Button)findViewById(R.id.btexttovoice);
    b.setOnClickListener(this);
    tts = new TextToSpeech(textvoice.this,new TextToSpeech.OnInitListener(){

        @Override
        public void onInit(int status) {
            // TODO Auto-generated method stub
            if(status!= TextToSpeech.ERROR)
            {
                tts.setLanguage(Locale.US);

            }
            }
    });

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    if(tts!= null)
    {
        tts.stop();
        tts.shutdown();
    }
    super.onPause();
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    Random r = new Random();
    String rn = texts[r.nextInt(3)];
    tts.speak(rn, TextToSpeech.QUEUE_FLUSH, null);
} 
```

这里是日志猫：

```
07-29 07:18:52.635: ERROR/AndroidRuntime(246): Uncaught handler: thread main exiting due to uncaught exception
07-29 07:18:52.665: ERROR/AndroidRuntime(246): java.lang.NullPointerException: println needs a message
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.util.Log.println(Native Method)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.util.Log.i(Log.java:136)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.speech.tts.TextToSpeech.speak(TextToSpeech.java:673)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at org.textvoice.textvoice.onClick(textvoice.java:64)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.View.performClick(View.java:2364)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.View.onTouchEvent(View.java:4179)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.widget.TextView.onTouchEvent(TextView.java:6541)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.View.dispatchTouchEvent(View.java:3709)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1659)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.app.Activity.dispatchTouchEvent(Activity.java:2061)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1643)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1691)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.os.Looper.loop(Looper.java:123)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at android.app.ActivityThread.main(ActivityThread.java:4363)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at java.lang.reflect.Method.invokeNative(Native Method)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at java.lang.reflect.Method.invoke(Method.java:521)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
07-29 07:18:52.665: ERROR/AndroidRuntime(246):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:40:35.013

我认为 texts[r.nextInt(3)] 是 null.pls 保证 texts[0]~text[2] 有值字符串。

# python - 具有动态深度和仅叶子中的数据的树结构

> ID：11705935
> 
> 赞同：2
> 
> 时间：2012-07-29T01:27:25.270
> 
> 标签：python, data-structures, tree

我有以下层次结构：

```
- A
    - X : [1, 2, 3]
    - Y : [4, 5]
    - Z : [10, 11]
- B
    - X : [6, 7]
    - Y : [8] 
```

我想要的是以下查询给我以下结果：

```
get(A) ==> [1,2,3,4,5,10,11]
get(A,Y) ==> [4,5]
get(B) ==> [6,7,8]
get(B,X) ==> [6,7] 
```

到目前为止，这似乎很容易。我可以通过拥有一个*Dictionary>*来实现这一点，它可以是 Python 中的*defaultdict(lambda : defaultdict(list))*。但是，如果我需要使其更通用并具有另一个级别或另外 2 个级别怎么办？就像是 ：

```
- A
    - X
        - i  : [1]
        - ii : [2,3]
    - Y
        - i  : [4, 5]
    - Z
        - ii : [10, 11]
- B
    - X
        - ii  : [6]
        - iii : [7]
    - Y
        - i   : [8] 
```

在此示例中，第一个层次结构是第二个层次结构的“投影”，其中最后一个级别合并到父级中。因此，第一个层次结构的所有查询都应该给出相同的结果。

新级别的一些示例查询：

```
get(B, X, ii) ==> [6]
get(B,X) ==> [6,7]          (same query and result as before) 
```

请注意，数据仅在叶节点中。因此，对于插入，必须给出整个路径：

```
insert(A, X, i, 20) 
```

这也意味着，我们可以在数据结构的构造函数中给出树的深度。

编辑：我意识到我需要验证深度：

*   插入操作：必须给出整个路径，并且 len(path) 必须等于深度
*   获取操作：不允许比结构深度“更深”的路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T13:35:15.907

```
from collections import defaultdict
def tree(): return defaultdict(tree)

def get_(t):
    L = []
    if isinstance(t, list):
            L.extend(x for x in t)
    else:
        for k in t:
            L.extend(get_(t[k]))
    return sorted(L)

t = tree()
t['A']['X']['i'] = [1]
t['A']['X']['ii'] = [2,3]
t['A']['Y']['i'] = [4,5]
t['A']['Z']['ii'] = [10,11]

t['B']['X']['ii'] = [6]
t['B']['X']['iii'] = [7]
t['B']['Y']['i'] = [8]

print get_(t)
print get_(t['A'])
print get_(t['A']['X'])
print get_(t['A']['X']['i'])
print get_(t['B']['Y']['i'])

>>> 
[1, 2, 3, 4, 5, 6, 7, 8, 10, 11]
[1, 2, 3, 4, 5, 10, 11]
[1, 2, 3]
[1]
[8]
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T11:37:15.247

看看这个：

```
>>> A = Tree()
>>> B = Tree()
>>> A.insert_subtree("x", Leaf([1, 2, 3]))
>>> A.insert_subtree("y", Leaf([10, 20, 30]))
>>> B.insert_subtree("y", Leaf([100, 101, 102]))
>>> root = Tree({'A': A, 'B': B})
>>> root.get("A")
[1, 2, 3, 10, 20, 30]
>>> root.get("A", "x")
[1, 2, 3]
>>> root.insert("A", "x", 4)
>>> root.get("A", "x")
[1, 2, 3, 4]
>>> root.get("A")
[1, 2, 3, 4, 10, 20, 30]
>>> root.get("B")
[100, 101, 102] 
```

这是使其工作的代码：

```
class Leaf(object):
    def __init__(self, data=None):
        self.data = data[:] if data else []

    def __iter__(self):
        for item in self.data:
            yield item

    def insert(self, value):
        self.data.append(value)

class Tree(object):
    def __init__(self, trees=None):
        self.trees = dict(trees) if trees else {}

    def insert_subtree(self, name, tree):
        if name in self.trees:
            raise TreeAlreadyExists()

        self.trees[name] = tree

    def get(self, *args):
        child_name, rest = args[0], args[1:]
        child = self._get_child(child_name)

        if len(rest):
            return child.get(*rest)
        else:
            return [item for item in child]

    def _get_child(self, name):
        if name not in self.trees:
            raise KeyError("Child %s does not exist" % name)
        return self.trees[name]

    def insert(self, *args):
        child_name, rest = args[0], args[1:]
        child = self._get_child(child_name)
        child.insert(*rest)

    def __iter__(self):
        for key in sorted(self.trees.keys()):
            for item in self.trees[key]:
                yield item

class TreeAlreadyExists(Exception):
    pass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T16:13:25.450

我基于@black_dragon 的思想编写了[这个类，并支持深度验证。](https://github.com/aliok/trnltk/blob/8c5ef3c33cfa4fca06d621e7eb1bba537c6fe757/trnltk/treebank/model.py)以下是如何使用它（从[测试用例](https://github.com/aliok/trnltk/blob/8c5ef3c33cfa4fca06d621e7eb1bba537c6fe757/trnltk/treebank/test/test_model.py)复制）：

```
def test_index_with_sample_case_for_depth_2(self):
    idx = HierarchicalIndex(2)

    # A
    idx.insert(1, 'A', 'X')
    idx.insert(2, 'A', 'X')
    idx.insert(3, 'A', 'X')

    idx.insert(4, 'A', 'Y')
    idx.insert(5, 'A', 'Y')

    idx.insert(10, 'A', 'Z')
    idx.insert(11, 'A', 'Z')

    #B
    idx.insert(6, 'B', 'X')
    idx.insert(7, 'B', 'X')

    idx.insert(8, 'B', 'Y')

    assert_that(idx.get('A'), equal_to([1, 2, 3, 4, 5, 10, 11]))
    assert_that(idx.get('A', 'Y'), equal_to([4, 5]))
    assert_that(idx.get('B'), equal_to([6, 7, 8]))
    assert_that(idx.get('B', 'X'), equal_to([6, 7]))

def test_index_with_sample_case_for_depth_3(self):
    idx = HierarchicalIndex(3)

    # A
    idx.insert(1, 'A', 'X', 'i')
    idx.insert(2, 'A', 'X', 'ii')
    idx.insert(3, 'A', 'X', 'ii')

    idx.insert(4, 'A', 'Y', 'i')
    idx.insert(5, 'A', 'Y', 'ii')

    idx.insert(10, 'A', 'Z', 'ii')
    idx.insert(11, 'A', 'Z', 'iii')

    #B
    idx.insert(6, 'B', 'X', 'ii')
    idx.insert(7, 'B', 'X', 'iii')

    idx.insert(8, 'B', 'Y', 'i')

    #same queries with case for depth 2
    assert_that(idx.get('A'), equal_to([1, 2, 3, 4, 5, 10, 11]))
    assert_that(idx.get('A', 'Y'), equal_to([4, 5]))
    assert_that(idx.get('B'), equal_to([6, 7, 8]))
    assert_that(idx.get('B', 'X'), equal_to([6, 7]))

    #new queries
    assert_that(idx.get('B', 'X', 'ii'), equal_to([6]))
    assert_that(idx.get('A', 'X', 'ii'), equal_to([2, 3])) 
```

并验证深度：

```
def test_index_should_validate_depth_in_operations(self):
    # ....
    # depth=3
    idx = HierarchicalIndex(3)

    assert_that(idx.get('A'), has_length(0))
    assert_that(idx.get('A', 'X'), has_length(0))
    assert_that(idx.get('A', 'X', 'i'), has_length(0))
    self.assertRaises(AssertionError, lambda: idx.get('A', 'X', 'i', '1'))

    self.assertRaises(AssertionError, lambda: idx.insert(1))
    self.assertRaises(AssertionError, lambda: idx.insert(1, 'A'))
    self.assertRaises(AssertionError, lambda: idx.insert(1, 'A', 'X'))
    idx.insert(1, 'A', 'X', 'i')        # should not raise anything
    self.assertRaises(AssertionError, lambda: idx.insert(1, 'A', 'X', 'i', 'a'))

    assert_that(idx.get('A', 'X', 'i'), equal_to([1])) 
```

# ruby-on-rails - Rails 3 超大型模型验证

> ID：11705937
> 
> 赞同：0
> 
> 时间：2012-07-29T01:28:47.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我目前正在开发一个 Rails 3 应用程序，该应用程序具有一个表单，该表单采用一个父对象，该对象具有从相当大的数组中选择的几个预定义属性。每个父对象都有几个子对象，根据您在父对象中选择的预定义属性，可以有非常不同的最小-最大值，每个都有自己独立的通常独特的限制。

我很快意识到验证这些对象将导致一个非常大的模型文件。我想知道是否有适当的方法从模型中删除这种类型的大规模验证（或者至少让模型指向其他地方）。

还有一个更高级的问题，有发言权是否正常... 1000 行代码来验证对象数据的完整性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:43:03.713

1）您可以创建一个自定义验证器类，这涉及从 ActiveModel::Validator 继承并实现一个 validate 方法来验证记录：

```
class Report > ActiveRecord::Base
  validates with MyValidator
end

class MyValidator < ActiveModel::Validator
 def validate(record)
    record.errors[:base] = << "Error" unless is_valid(record)
  end
end 
```

2) 在 rails 3 中，还有验证宏，这意味着扩展 ActiveModel::EachValidator：

```
class Report < ActiveRecord::Base
  validates :name :report_like => true
end

class ReportLikeValidator < ActiveModel::EachValidator
  def validate_each(record, attribute, value)
    unless value["Report"]
      record.errors.add attribute, "Does not appear to be a ..."
  end
end 
```

# performance - 切换着色器和纹理的 webgl 性能成本

> ID：11705940
> 
> 赞同：6
> 
> 时间：2012-07-29T01:30:26.257
> 
> 标签：performance, webgl

一、切换着色器效果哪种方式更好？1.使用大型着色器程序，并在着色器程序中统一使用if/else子句来使用差异效果。2.在调用之间切换程序。

二、用大纹理好还是用几个小纹理好？并且上传纹理成本很贵，绑定纹理怎么样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-29T18:52:12.483

好吧，最好写一些性能测试并尝试一下，但总的来说。

*   小着色器比大着色器快。
*   1 纹理比许多纹理更快
*   上传纹理很慢
*   绑定纹理很快
*   切换程序很慢，但通常比将 2 个小程序合并为 1 个大程序要快得多。

特别是片段着色器每帧执行数百万次。1920x1080 显示器有 200 万像素，因此没有过度绘制仍然意味着您的着色器每帧执行 200 万次。对于每帧执行 200 万次或每秒执行 1.2 亿次的任何事情，您的目标是每秒 60 帧，越小越好。

至于纹理，mips 比没有 mips 快，因为 GPU 有一个纹理缓存，如果它接下来需要的像素接近它之前读取的像素，它们很可能已经在缓存中。如果它们离得很远，它们就不会在缓存中。这也意味着从纹理中随机读取特别慢。但大多数应用程序通过纹理相当线性地读取。

切换程序的速度很慢，以至于按照它们使用的程序对模型进行排序，以便您首先绘制所有使用程序 A 的模型，然后是使用程序 B 的所有模型，这通常比以随机顺序绘制它们要快。但是还有其他的效果表现。例如，如果一个大模型遮挡了一个小模型，最好先绘制大模型，因为小模型将无法通过深度测试（z 缓冲区）并且不会对任何像素执行其片段着色器。所以这是一个权衡。您真正能做的就是测试您的特定应用程序。

此外，以正确的方式进行测试也很重要。 [http://updates.html5rocks.com/2012/07/How-to-measure-browser-graphics-performance](http://updates.html5rocks.com/2012/07/How-to-measure-browser-graphics-performance)

# r - 如何在 /etc/profile 中设置 R 环境？

> ID：11705942
> 
> 赞同：2
> 
> 时间：2012-07-29T01:30:38.747
> 
> 标签：r, environment

我的操作系统是debian6，编译安装R后有一个libR.pc

```
root@debian:/home/tiger# cat /home/tiger/R-2.15.1/lib/pkgconfig/libR.pc  
rhome=/home/tiger/R-2.15.1/lib/R  
rlibdir=${rhome}/lib  
rincludedir=/home/tiger/R-2.15.1/lib/R/include  
Name: libR  
Description: R as a library  
Version: 2.15.1  
Libs: -L${rlibdir} -lR  
Cflags: -I${rincludedir} -I${rincludedir}  
Libs.private: 
```

在 /etc/profile 中设置 R 环境时：
R_HOME= /home/tiger/R-2.15.1
或
R_HOME= /home/tiger/R-2.15.1/lib/R
我将选择在 /etc/ 中写入哪一行轮廓？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T05:09:12.080

在 Debian（或衍生产品，如 Ubuntu 系统）上，您必须`/etc/R/`设置 R 使用的变量：

```
edd@max:~$ ls -l /etc/R/
total 28
-rw-r--r-- 1 root root  602 Jun 17 20:29 ldpaths
-rw-r--r-- 1 root root 5461 Jun 17 20:29 Makeconf
-rw-r--r-- 1 root root 1868 Mar 31 13:50 Renviron
-rw-r--r-- 1 root root  608 Sep 25  2009 Renviron.site
-rw-r--r-- 1 root root 1159 Mar 31 08:03 repositories
-rw-r--r-- 1 root root  792 Oct 28  2009 Rprofile.site
edd@max:~$ 
```

并且其中的文件`R_HOME/etc/`应该是软链接——至少如果您使用预构建的二进制文件。如果您构建自己的二进制文件，那是您的问题。

您引用的文件安装`/usr/lib/pkgconfig/libR.pc`在 Debian / Ubuntu 系统上。*不需要*设置`R_HOME`，因为会找到自己的值（请参阅@flodel 的答案）。*`R`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T02:15:08.073

在我的系统上：

```
cat $R_HOME 
```

什么都不提供，但在 R 会话中，我得到：

```
> Sys.getenv("R_HOME")
[1] "/usr/lib/R" 
```

这应该告诉你两件事：

1.  这`R_HOME`是在 R 的启动时设置的，所以除非你确切地知道你在做什么，否则你可能不需要在你的`/etc/profile`.
2.  您可以使用它`Sys.getenv`来找出您的`R_HOME`.*

# python - 可以执行 Appengine urlfetch 或 urllib2 HEAD 请求吗？

> ID：11705943
> 
> 赞同：1
> 
> 时间：2012-07-29T01:31:49.720
> 
> 标签：python, google-app-engine, urllib2, urlfetch

你好堆栈溢出！

我了解 Python 的 urllib2 库可以执行 HEAD 请求：[How do you send a HEAD HTTP request in Python 2?](https://stackoverflow.com/questions/107405/how-do-you-send-a-head-http-request-in-python)

这是否意味着如果我想做一个 HEAD 请求，我需要使用 urllib2？此外，appengine 上的 urlli2 是否可以执行 HEAD 请求（可疑，因为 urlfetch 似乎无法[https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction](https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction)）

非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:33:51.433

弄清楚了。urllib2 不能做任何 urlfetch 不能做的事情。“在 App Engine 中运行时，这些库使用 App Engine 的 URL 获取服务执行 HTTP 请求，该服务在 Google 的可扩展 HTTP 请求基础架构上运行。”

但！“URL 获取服务支持五种 HTTP 方法：GET、POST、HEAD、PUT 和 DELETE。”

只是没有在 urlfetch 参考文档中看到它。

*   来源：[https ://developers.google.com/appengine/docs/python/urlfetch/overview](https://developers.google.com/appengine/docs/python/urlfetch/overview)

# javascript - JSP和HTML参数的关系

> ID：11705944
> 
> 赞同：0
> 
> 时间：2012-07-29T01:32:23.420
> 
> 标签：javascript, html, jsp

一个理论上的问题：我的按钮从我的 JSP 文件开头定义的 var "message" 中获取其初始值。可以说“消息”的值稍后会发生变化。我怎样才能让我的按钮的值标签也更新？

JSP：

```
<%

String message = "Hello!"

%> 
```

html正文：

```
<input id="mybutton" type="button" value="<%=message%>/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:42:31.493

scriptlet 甚至在 Javascript 执行之前运行。所以你会做的是

`var message = <% "Hello" %>`

因此，这一行创建了一个**Javascript 变量**，`message`该变量具有在评估 jsp 时设置的值。

显然，这个例子很愚蠢，但如果你用 Java 领域的一些变量替换 hello，它会更有用。

另请注意，在呈现页面后，您无法使用 scriptlet 更新值。您将不得不使用 Ajax。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T01:47:51.507

在呈现变量之前，您必须将变量更改为其最终值。如果您想在呈现后使用服务器数据更新网页上的值，您可以刷新页面或向服务器发出 ajax 请求以检索最新数据。在 Google 上搜索 jQuery 和 Ajax 以获取有关如何执行此操作的更多信息。

这里有一篇文章可以帮助你：

使用 JQuery 在 Java Web 应用程序中实现 Ajax [http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=438#start](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=438#start)

# python - 如何检查主机的 DNS TXT 记录的值？

> ID：11705946
> 
> 赞同：14
> 
> 时间：2012-07-29T01:32:31.797
> 
> 标签：python, dns

我希望通过脚本（特别是 Python 脚本）验证域所有权，并且想知道如何查找 DNS TXT 条目的值。我知道有这方面的服务和网站，但我想用脚本来做。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-29T03:17:37.650

这很容易使用[dnspython](http://www.dnspython.org/)。这是一个例子：

```
import dns.resolver
print dns.resolver.query("aaa.asdflkjsadf.notatallsuspicio.us","TXT").response.answer[0][-1].strings[0] 
```

这给出了以下输出：

```
PnCcKpPiGlLfApDbDoEcBbPjIfBnLpFaAaObAaAaMhNgNbIfPbHkMiEfPpGgJfOcPnLdDjBeHkOjFjIbPbIoKhIjHfJlAhAhFgGbGgNlMgKmFkLgNfBjMbCoBeNbGeOnAeHgLmKoFlLhLmDcKlEdEbDpFeHkFaBlGnHiOnChIoMlIhBgOnFfKoEhDnFkKfDaMgHbJhMgPgMjGiAoJpKjKkPaIcAdGiMbIbBbAfEiKjNbCeFoElKgOePmGjJaImL 
```

另一种选择是`dig`在子流程中使用：

```
import subprocess

print subprocess.Popen(["dig","-t","txt","aaa.asdflkjsadf.notatallsuspicio.us","+short"], stdout=subprocess.PIPE).communicate()[0] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-15T13:46:21.320

这可能过于简化了，但如果您只想快速阅读 TXT 记录并且不介意单独处理解析结果：

```
nslookup -q=txt somedomain.com 
```

我发现这可以满足我的需要，又短又甜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-20T11:58:25.423

找到了另一种使用[dnspython](https://www.dnspython.org/)获取域的所有 TXT 记录列表的方法。

```
import dns.resolver
[dns_record.to_text() for dns_record in dns.resolver.resolve("your-domain-here", "TXT").rrset] 
```

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2012-07-29T01:52:56.997

像这样的东西至少应该可以获取 URL 的值，我以 google.com 为例。

```
import pycurl
import StringIO
url = "whatsmyip.us/dns_txt.php?host=google.com"
c = pycurl.Curl()
c.setopt(pycurl.URL, url)
c.setopt(pycurl.HTTPHEADER, ["Accept:"])
txtcurl = StringIO.StringIO()
c.setopt(pycurl.WRITEFUNCTION, txtcurl.write)
c.perform

data = txtcurl.getvalue()
data = data.replace("Done!", "")
print data 
```

我没有对此进行任何测试，而是从以前的项目中提取了它。

祝你好运！

# php - $file->eof() 在使用 PHP 的 SplFileObject 时总是返回 false

> ID：11705950
> 
> 赞同：0
> 
> 时间：2012-07-29T01:32:49.980
> 
> 标签：php, fwrite, eof, splfileobject

为什么我的 PHP 脚本挂起？

```
$path = tempnam(sys_get_temp_dir(), '').'.txt';
$fileInfo = new \SplFileInfo($path);
$fileObject = $fileInfo->openFile('a');
$fileObject->fwrite("test line\n");
var_dump(file_exists($path));          // bool(true)
var_dump(file_get_contents($path));    // string(10) "test line
                                       // "
var_dump(iterator_count($fileObject)); // Hangs on this 
```

如果我删除最后一行 ( `iterator_count(...`) 并将其替换为：

```
$i = 0;
$fileObject->rewind();
while (!$fileObject->eof()) {
    var_dump($fileObject->eof());
    var_dump($i++);
    $fileObject->next();
}
// Output:
// bool(false)
// int(0)
// bool(false)
// int(1)
// bool(false)
// int(2)
// bool(false)
// int(3)
// bool(false)
// int(4)
// ... 
```

总是返回 false所以`$fileObject->eof()`我得到一个无限循环。

为什么会发生这些事情？我需要计算行数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T02:18:06.727

根据我在您的代码中看到的，您`a`在这一行使用模式打开文件：

```
$fileObject = $fileInfo->openFile('a'); 
```

当你这样做时，它只写：

`$fileObject->eof()`需要读取文件，您应该打开文件`a+`以允许读/写：

```
$fileObject = $fileInfo->openFile('a+'); 
```

* * *

Ps：无论是`a`还是`a+`，指针都指向文件末尾。

# php - 即使我删除了空格，标题也不会重定向

> ID：11705951
> 
> 赞同：1
> 
> 时间：2012-07-29T01:33:07.723
> 
> 标签：php

我在我的代码中包含了一个 header() 但它不会重定向。我知道在发送 header() 之前不应该有任何空白，但它仍然不起作用。有人可以帮忙吗？提前致谢。

```
<?php 
    session_start();
    if(isset($_SESSION["owner"])){
        header("Location:index.php");
        exit();
    }
?>
<?php
require_once("includes/connection.php");
if(isset($_POST["username"]) && isset($_POST["password"])){
$owner = $_POST["username"];
$password = $_POST["password"];
$query = "SELECT id FROM users WHERE username = '$owner' AND password ='$password' LIMIT 1";
 $sql = mysql_query($query,$connection);
 $existCount = mysql_num_rows($sql);
        if($existCount == 1){   
        while($row = mysql_fetch_array($sql)){
        $id = $row["id"];
        }
        $_SESSION["id"] =$id;
        $_SESSION["owner"] = $owner; 
        $_SESSION["password"] =$password;
        header("Location:list.php");
        exit();
        }else{
        header("Location:login.php");
        exit();
        }
}
require_once("includes/header.php");?>
<div class="cBoth"></div>
<div id="sep"></div>

<div class="Calign">
<div id="formcontent">

<div class="flotr">
 <h2>Learn More</h2> 
 <p class="widthis">Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and going through the cites of the word in classical literature, discovered the undoubtable source.</p>
</div><!-- end of flotr div text --->

<div class="flotr">
   <fieldset class="spacing">
   <form method="post" action="admin/formProc/formproc.php">
     <h2>New to MaalHouse?</h2>
     <p class="widthis">A Maalhouse account is required to continue.</p> 
     <p class="formsp">Name</p>
     <p><label><input type="text" name="username" height="15px"/><label></p>
     <p class="formsp">Email</p>
     <p><label><input type="text" name="email"/><label></p>
     <p class="formsp">Re-email</p>
     <p><label><input type="text" name="reemail"/><label></p>
     <p class="formsp">Password</p> 
     <p><label><input type="password" name="password"/><label></p>
     <p class="formsp">Re-password</p>
     <p><label><input type="password" name="repassword"/><label></p>
     <p class="formsp"><label><input type="submit" name="newuser" value="SING ME UP"/><label></p>
   </form>
  </fieldset>
</div><!-- end of flotr div sign up--->

<div class="flotl">
   <fieldset class="spacing">
   <form method="post" action="login.php">
   <h2>New to MaalHouse?</h2>
   <p class="widthis">A Maalhouse account is required to continue.</p> 
   <p class="formsp">Username</p>
   <p><input type="text" name="username"/></p>
   <p class="formsp">Password</p>
   <p><input type="password" name="password"/></p>
   <p></p>
   <p class="formsp"><label><input type="submit" name="login" value="Login"/><label></p>   
   </form>
   </fieldset>
</div><!-- end of flotl div login--->

 </div>
</div>

<div class="cBoth"><!-- clear Both--></div> 
<?php require_once("includes/footer.php"); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T12:27:27.287

在 PHP 的结束块和开始块之间有一个换行符：

```
?>
<?php 
```

不需要这些标签。删除它们。

# mysql - 字段列表中的列“id”不明确

> ID：11705952
> 
> 赞同：0
> 
> 时间：2012-07-29T01:33:25.473
> 
> 标签：mysql

我收到以下错误，字段列表中的列“id”不明确。我怎样才能从这个语句中唯一地获取正确的 ID

```
function data () {
if($at = mysql_real_escape_string(@$_GET['id'])){$at = mysql_real_escape_string(@$_GET['id']);

$arg = func_get_args();
unset($arg[0]);
$fields = '`'.implode('`,`', $arg).'`';
$query = mysql_query("SELECT $fields FROM `list` LEFT JOIN fruits ON location.id =  
fruits.fid     
LEFT JOIN store ON store.id = location.catid WHERE location.link = '$at'")or die(mysql_error());
$query_result = mysql_fetch_assoc($query);
$query_row = mysql_num_rows($query);
if($query_row==0){
return false;
}else{
foreach ($arg as $field){
$arg[$field] = $query_result[$field];
}return $arg;
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:44:59.473

```
$fields = '`list`.'.implode('`, `list`.`', $arg).'`'; 
```

但我强烈推荐[Doctrine](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/in-ten-quick-steps.html)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:17:10.713

转而只更改表中 id 的名称更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T01:43:11.227

似乎是您的 mysql 查询中的问题。指定表的名称以及您的字段名称将是我猜想的最简单的解决方案：

```
$fields = 'tablename'.$fields; 
```

# php - PHP条件打印请求问题

> ID：11705953
> 
> 赞同：1
> 
> 时间：2012-07-29T01:33:28.140
> 
> 标签：php, wordpress, wordpress-theming

我正在尝试实现下面的脚本以在假定的页面上打印图像，但它仍然不打印图像，而是将其显示为死图像链接。我尝试更改图像路径，但它不起作用。

```
<?php
    if ($currentpage == '/services/')
        print('<img src="path/to/services.png" alt=""/>');
    elseif ($currentpage == 'contact.php')
        print('<img src="path/to/image.png" alt=""/>');
    else
        print('<img src="path/to/image.png" alt=""/>');
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T01:58:08.320

只有一种解释，那就是路径是错误的。右键单击死图像并在新窗口中打开它，然后查看链接是什么。然后，您可能会弄清楚应该如何更改路径以使其正确。

# vb.net - 如何在我的网络浏览器上单击此按钮？

> ID：11705954
> 
> 赞同：0
> 
> 时间：2012-07-29T01:33:49.250
> 
> 标签：vb.net, button, click, browser

```
<input type="submit" class="btn"> 
```

我似乎无法让它使用 vb.net 点击它。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:57:52.520

您使用的是 .NET WebBrowser 控件吗？如果是这样，请尝试类似...

```
For Each element As HtmlElement In WebBrowser1.Document.GetElementsByTagName("input")
        If element.GetAttribute("class") = "btn" Then 
            element.InvokeMember("click")
        End If
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-16T09:27:53.413

你可以简单地使用

```
WebBrowser.Document.GetElementById("btn").InvokeMember("Click") 
```

# html - 属性的标签标签可以与普通的 div 相关联吗？

> ID：11705956
> 
> 赞同：28
> 
> 时间：2012-07-29T01:34:36.073
> 
> 标签：html, label, specifications

在 html5 定义下使用标签的“for”值作为普通 div 元素的 id 是否有效（例如，我制作了一个包含在 div 中的自定义下拉列表实现）

如果可能的话请让我知道，

托马斯

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-29T01:37:18.760

不符合规范：

> 一些元素（并非所有元素都与表单相关）被归类为可标记元素。这些是可以与标签元素相关联的元素。
> 
> "button" "input" (如果 type 属性没有处于隐藏状态) "keygen" "meter" "output" "progress" "select" "textarea"

[http://www.w3.org/TR/html5/forms.html#category-label](http://www.w3.org/TR/html5/forms.html#category-label)

也可以看看：

> 可以指定 for 属性以指示与标题关联的表单控件。如果指定了属性，则属性的值必须是与标签元素在同一文档中的可标记元素的 ID。如果指定了属性并且 Document 中有一个元素的 ID 等于 for 属性的值，并且第一个这样的元素是可标记元素，则该元素是标签元素的标记控件。

[http://www.w3.org/TR/html5/the-label-element.html#attr-label-for](http://www.w3.org/TR/html5/the-label-element.html#attr-label-for)

我确实认为这个问题提出了一个有效的用例。我不确定这种情况下推荐的模式是什么，尽管 ARIA 属性可能有助于使标记更易于访问：

[https://developer.mozilla.org/en/Accessibility/ARIA/forms/Basic_form_hints](https://developer.mozilla.org/en/Accessibility/ARIA/forms/Basic_form_hints) [https://developer.mozilla.org/Special:Tags?tag=ARIA](https://developer.mozilla.org/Special:Tags?tag=ARIA)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T01:46:05.670

As Tim noted it is not possible to do it natively, however with a little bit of javascript you can simulate it

```
jQuery(document).delegate('[for]','click',function(e){
    var targetEl = jQuery('#'+jQuery(this).attr('for'));
    if(targetEl.is('div.your-custom-dropdown-class')) { //if targetEl is one of your dropdowns
        e.preventDefault();
        targetEl.trigger('click'); //open the drop down
    }
}); 
```

# python-2.7 - 如何防止导入的模块“导入”sys.argv[1:]

> ID：11705961
> 
> 赞同：0
> 
> 时间：2012-07-29T01:36:40.493
> 
> 标签：python-2.7, command-line-arguments, python-module

我是蟒蛇新手。为了以易于理解的方式提出我的问题，我创建了两个脚本。一个脚本名为：calling_script.py 另一个脚本名为：calling_script.py

以下两行是 called_script.py 中的代码

```
 import sys
 print str(sys.argv[1]) + '\n\n' + str(dir(sys.argv[1])) 
```

以下两行是calling_script.py中的代码

```
 import sys
 import called_script 
```

如果我将“foo”作为命令行参数提供给“calling_script.py”，则 foo 将在“calling_script.py”中显示为 sys.argv[1]

是否有任何代码可以添加到“called_script.py”，以便“called_script.py”可以确定 sys.argv[1] 是否从命令行传递给它，或者 sys.argv[1] 是否传递给它它来自'**主要**'？

另外，我很想知道是否有可能阻止例如 sys.argv[1] 从**main**传递到导入的模块，以及在哪里可以找到有关该主题的一些读物。

感谢您的任何帮助。非常感谢。

```
 Marc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T02:06:36.343

> 是否有任何代码可以添加到“called_script.py”，以便“called_script.py”可以确定 sys.argv[1] 是否从命令行传递给它，或者 sys.argv[1] 是否传递给它它来自“主要”？

从根本上说，不，因为命令行参数没有传递给*modules*，它们被传递给 Python，Python 将它们放入`sys.argv`. 由于所有的模块都共享相同的`sys`，他们都会看到相同`sys.argv`的，就是这样。

也就是说，您可以利用`__name__`设置为`__main__`仅用于主脚本的 ：

```
~/coding$ python calling_script.py fred
called_script says __name__ is: called_script
calling_script says __name__ is: __main__ 
```

所以你可以使用类似的东西

```
args = sys.argv if __name__ == '__main__' else [whatever_you_want] 
```

然后用于`args`获取模块特定的等价物`sys.argv`。同样，您可以在stash`__name__`的一开始就进行分支，然后修改(ick) 中的那个。`calling_script.py``sys.argv``sys`

但一般来说，`sys.argv`无论如何，您都不需要在主程序之外的任何地方使用。如果您需要`sys.argv`在多个地方访问，您的界面可能与您的例程没有足够的分离。

# android - 强制使用不同的语言环境仅适用于后台堆栈中的顶部活动

> ID：11705963
> 
> 赞同：4
> 
> 时间：2012-07-29T01:37:00.850
> 
> 标签：android, configuration, locale

我遇到了一个关于应用本地化的小问题：

情况就是这样——我为我的用户提供了一个选项，无论系统语言如何，我都可以*始终*以挪威语使用该应用程序。

它在大多数情况下都可以正常工作（我进入设置，选中该框以强制使用挪威语，按“返回”，之前的活动以挪威语显示 - 同样的事情“相反”），但是 - 仅更改语言似乎为我的“后台堆栈”中的第一个活动正确更新（重新加载资源）。

举例说明一个典型场景：

> 用户启动应用程序，并显示主要活动（英文）。从那里，他选择了第二个活动（也是英语）。然后他进入设置（从第二个活动的菜单中）并设置偏好以强制使用挪威语。
> 
> 然后当他导航回来时，第二个活动被正确更新并以挪威语显示（到目前为止一切都很好）。但是，当他再次按“返回”返回主活动时，*它*仍然显示为英文......
> 
> 如果他退出并再次启动应用程序，主要活动将以挪威语正确显示...

这里有没有聪明人对我应该做什么提出建议？

# 相关源代码：

每个活动中包含设置显示语言的代码：

在 onCreate 中：`Globals.locale_default = Locale.getDefault().getDisplayLanguage();`

```
public void onStart() {
    super.onStart();
    forceNorwegian = settings.getBoolean(getString(R.string.pref_key_forceNorwegian).toString(), false);
       if (forceNorwegian) {
           languageCheck("no");
       } else {
            Globals.locale = null;
            languageCheck(Globals.locale_default);
       }
}

public void languageCheck(String lang) {
    Globals.locale = new Locale( lang );
    // Check the current system locale and change it to Norwegian if it's not already the default
    Globals.checkLocale( this );
    if (Globals.language_changed) {
        // Restart activity
        Intent restart = getIntent();
        finish();
        Globals.language_changed = false;
        startActivity(restart);
    }
} 
```

全局.java：

```
public class Globals {

public static Locale locale = null;
    public static String locale_default = null;
    public static boolean language_changed = false;

    public static void checkLocale( Activity a ) {
        if( locale == null )
            return;

        Configuration config = a.getBaseContext().getResources().getConfiguration();
        if( !config.locale.equals( locale ) )
        {  // Change to the new locale.  Everything will need to be closed or reloaded.
            config.locale = locale;
            a.getBaseContext().getResources().updateConfiguration( config, null );
            language_changed = true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T14:28:07.790

问题可能来自布尔值 Globals.language_changed 是静态的，因此当从顶部活动调用 languageCheck 时，在从后面的活动调用 languageCheck 之前，此布尔值变为假。您可能会进行一些检查以查看层次结构中较早的 Activit(ies) 是否打开，如果打开，请将布尔值设置为 true，以防用户按下后退按钮。另一种选择是在选择新语言环境时立即重新加载所有打开的活动的一些逻辑。

--**编辑**-- 进一步检查，我认为这不是你的问题，因为你也在为每个活动更新 onStart 中的布尔值（我第一次阅读时错过了这部分）。当堆栈中较高的活动之一更改它时，可能会更改语言环境，但堆栈中较低的活动只需要刷新。较低活动之一的方向更改是否将其从英语更改为挪威语？

--**编辑 2** -- 检查这是否是问题的最简单方法是将一些日志记录添加到 Globals.checkLocale 以查看此条件语句是否为真：

```
if( !config.locale.equals( locale ) ) 
```

如果这是问题所在，那么一种可能的解决方案是在每个 Activity 中保存一个本地 Locale 实例而不是全局实例，然后与该实例进行比较。例如，您可以在每个 Activity 的 onCreate 方法中获取一个 Locale 实例：

```
myLocale = getBaseContext().getResources().getConfiguration().locale; 
```

然后，不用调用 Globals.checkLocal，只需执行以下条件语句（在每个 Activity 的 languageCheck 方法中）：

```
if( Globals.locale != null && !Globals.locale.equals( myLocale ) )
{
    Configuration config = getBaseContext().getResources().getConfiguration();
    config.locale = Globals.locale;
    getBaseContext().getResources().updateConfiguration( config, null );
    Intent restart = getIntent();
    finish();
    startActivity( restart );
} 
```

重新启动后，将再次调用 Activity 的 onCreate 方法，这会将 myLocale 更新为正确的值。这只是一个快速的解决方案，不一定是最好的解决方案。例如，如果需要，您可以扩展它以将一些代码移动到 Globals 中的方法中，或者使用与 onCreate 不同的位置来获取本地 Locale 实例每个活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T01:48:37.980

我认为它的线

```
 Configuration config = a.getBaseContext().getResources().getConfiguration(); 
```

`getBaseContext()`只会让您从另一个 Acitivty 内部获得对 Activity 的引用。因此，这就是为什么**当您返回到前一个 Activity 而不是主应用程序时，它会反映更改**

使用`getApplicationConext()`它来**反映整个应用程序的变化**。这会将更改与应用程序的整个生命周期联系起来，因此应用程序中的每个 Activity

# php - PHP 错误的正则表达式

> ID：11705969
> 
> 赞同：1
> 
> 时间：2012-07-29T01:38:09.537
> 
> 标签：php, regex

嘿，我在以下行中收到了一个非常描述性的 REG_BADRPT 错误：

```
if(ereg('(?=^.{8,20}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$', $_POST['password'])) 
```

任何人都可以看到问题是什么？

我在 javascript 中使用了相同的正则表达式，它工作正常，所以不确定问题出在哪里。

我在这里想要实现的是设置一个正则表达式来验证包含以下内容的字符串：

*   至少一个小写字母
*   至少有一个大写字母
*   至少一个数字或符号
*   长度应在 8 到 20 个字符之间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-29T01:42:12.147

Ereg 在 php 5.3 中已弃用。尝试使用`preg_match('/(?=^.{8,20}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/', $string)`并查看是否仍然出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:13:48.543

好吧，我最终用这个更改了正则表达式，它工作正常：

```
if(preg_match("#.*^(?=.{8,20})(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9]).*$#", $_POST['password'])) 
```

仍然不知道之前的问题是什么

# c# - 当我尝试保存图像时，我收到错误“GDI+ 中发生一般错误”。

> ID：11705970
> 
> 赞同：2
> 
> 时间：2012-07-29T01:38:09.667
> 
> 标签：c#, bitmap, gif, save

当我运行此代码时，在我评论的那一行中，我总是收到“GDI+ 中发生一般错误”。运行时错误

```
 private void ConstructFromResourceSaveAsGif()
    {
        Bitmap bmp1 = new Bitmap(typeof(Button), "Button.bmp");

        //This line
        bmp1.Save("c:\\button.gif", System.Drawing.Imaging.ImageFormat.Gif);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T01:47:31.947

你可以只使用代码

```
private void ConstructFromResourceSaveAsGif()
{
    Bitmap bmp1 = new Bitmap("Button.bmp");

    bmp1.Save("c:\\button.gif", System.Drawing.Imaging.ImageFormat.Gif);
} 
```

它仍然可以工作，除非你试图完成@DanF 所说的。

**编辑**

这是我用来测试它的一个快速应用程序：

```
class Program
{
    static void Main(string[] args)
    {
        Bitmap bmp1 = new Bitmap("C:/donut.jpg");

        bmp1.Save("c:\\button.gif", System.Drawing.Imaging.ImageFormat.Gif);

        Console.WriteLine("Save Success");
        Console.Read();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T02:14:58.373

> 此构造函数将给定类型的命名空间与资源的字符串名称相结合，并在程序集清单中查找匹配项。例如，您可以将 Button 类型和 Button.bmp 传递给此构造函数，它将**查找名为 System.Windows.Forms.Button.bmp 的资源。**

你有一个名为那个的资源吗？如果没有，那将是你的问题。“发生了一般性错误……”是 GDI+ 不太友好的举手方式并说“它坏了，但我不会告诉你为什么”

# android - ICS 主屏幕小部件显示在 Pre-ics 设备中

> ID：11705975
> 
> 赞同：4
> 
> 时间：2012-07-29T01:38:46.060
> 
> 标签：android, android-4.0-ice-cream-sandwich, android-2.3-gingerbread

我将如何防止我的仅 ICS 小部件出现在旧手机上，同时仍然保持我的应用向后兼容。目前我的任务管理器在 froyo 及更高版本上运行，但我有一个 ICS 和 up 小部件，我只想向兼容的用户显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T01:55:31.130

您可以使用诸如

```
Build.VERSION.RELEASE 
```

查询它是哪个android版本。一旦确定，您可以使小部件仅适用于该版本级别或更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T00:05:12.180

目前Android上没有办法做到这一点。只需制作两个版本。

# actionscript-3 - AS3 错误代码 1009 - 无法访问空对象引用的属性或方法

> ID：11705977
> 
> 赞同：0
> 
> 时间：2012-07-29T01:39:27.080
> 
> 标签：actionscript-3, flash, apache-flex, object, dynamic

是的，我确信在 SO 上有数百万个这样的问题，但这个问题难倒了我。观察下面的代码示例：

```
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
     xmlns:s="library://ns.adobe.com/flex/spark" 
     xmlns:mx="library://ns.adobe.com/flex/mx"
     creationComplete="init(event)">

<fx:Script>
    <![CDATA[
        import mx.events.FlexEvent;

        [Bindable]
        private var data:Object;

        private function init(e:FlexEvent):void {
            this.data.item = new Array();
        }
    ]]>
</fx:Script>
</s:Group> 
```

为什么我不能`item`在对象上创建数组`data`？我认为`Object`该类天生就被宣布为动态的？这是我在运行时遇到的错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference. 
```

有人可以帮我弄清楚如何在这个对象上创建我自己的属性。通常这很容易。哈哈

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T02:08:52.480

问题是`data`尚未实例化并且为空。

```
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
     xmlns:s="library://ns.adobe.com/flex/spark" 
     xmlns:mx="library://ns.adobe.com/flex/mx"
     creationComplete="init(event)">

<fx:Script>
    <![CDATA[
        import mx.events.FlexEvent;

        [Bindable]
        private var data:Object;

        private function init(e:FlexEvent):void {
            this.data = {};
            this.data.item = new Array();
        }
    ]]>
</fx:Script>
</s:Group> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T02:08:32.167

首先确保数据存在。

```
private function init(e:FlexEvent):void {
   this.data = {};
   this.data.item = new Array();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-29T05:02:24.517

更好的是，您可以这样做：

```
private function init(e:FlexEvent):void {
    if(this.data == null) 
        this.data = {};
    this.data.item = new Array();
} 
```

这样，每当调用 init 时，如果数据存在，它就不会被空白对象覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-29T02:11:56.547

您混淆了数据类型和数据实例。`object`尽管并非所有对象都是动态 的，但所有类都派生自。

换句话说，如果 data 是非动态的数据类型，那么您不能设置该`item`属性。`dynamic`AS3 中的类使用关键字定义为动态的。匿名对象默认是动态的：

因此，如果您设置，`this.data = {}`那么您将能够设置该`item`属性。

# php - Magento set_include_path()

> ID：11705982
> 
> 赞同：1
> 
> 时间：2012-07-29T01:41:30.020
> 
> 标签：php, magento-1.6

服务器管理员正在阻止执行 magento “set_include_path”；管理员坚持不启用此功能！有没有办法解决这个问题？例如：用静态值替换这一行？

这会导致以下错误：

```
Warning: set_include_path() has been disabled for security reasons in /home/bluerose/public_html/app/Mage.php on line 48

Warning: include_once(Mage/Core/functions.php) [function.include-once]: failed to open stream: No such file or directory in /home/bluerose/public_html/app/Mage.php on line 49

Warning: include_once() [function.include]: Failed opening 'Mage/Core/functions.php' for inclusion (include_path='.:/usr/lib/php:/usr/local/lib/php') in /home/bluerose/public_html/app/Mage.php on line 49

Warning: include_once(Varien/Autoload.php) [function.include-once]: failed to open stream: No such file or directory in /home/bluerose/public_html/app/Mage.php on line 50

Warning: include_once() [function.include]: Failed opening 'Varien/Autoload.php' for inclusion (include_path='.:/usr/lib/php:/usr/local/lib/php') in /home/bluerose/public_html/app/Mage.php on line 50

Fatal error: Class 'Varien_Autoload' not found in /home/bluerose/public_html/app/Mage.php on line 53 
```

# hash - 访问考拉好友连接返回的数据

> ID：11705985
> 
> 赞同：0
> 
> 时间：2012-07-29T01:42:01.627
> 
> 标签：hash, koala

所以，我正在尝试使用 Koala 获取用户朋友的姓名：

```
 @graph = Koala::Facebook::API.new(self.authentication_token)
        @graph.get_connections("me", "friends").each do |friend|
            puts friend['name']
        end 
```

但是，这会输出整个哈希值，ala：

```
{"name"=>"Tad Luedtke", "id"=>"17212478"}, {"name"=>"Harrison Hoffman", "id"=>"17212694"}, {"name"=>"Greg Nelson", "id"=>"17212720"} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T19:29:51.703

我是否正确假设您在控制台中执行此操作？尝试向上滚动。在执行完代码块后，它会输出整个散列，如果你有几个朋友，散列会非常大，所以你必须向上滚动才能看到 puts 语句。我只是在rails控制台中做了这个并且它有效。

如果您正在使用 rails 控制台并想禁用它（关闭 IRB），请尝试使用命令

```
conf.echo = false 
```

然后运行你的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T23:08:48.883

您需要先将这些哈希转换为数组，您只需尝试这些代码即可

```
@graph = Koala::Facebook::API.new(self.authentication_token)
@friends =@graph.get_connections("me", "friends").to_a
@friends.each do |friend|
puts friend["name"]
end 
```

# sql - 可以使用 HAVING 子句进行删除吗？

> ID：11705996
> 
> 赞同：41
> 
> 时间：2012-07-29T01:44:51.380
> 
> 标签：sql, sql-server, sql-server-2008

我想做如下的事情：

```
DELETE UserPredictions
  GROUP BY UserId
  HAVING COUNT(*) < 500 
```

但我收到语法错误。甚至可以在 SQL Server 中使用 HAVING 子句进行删除，还是我必须将计数汇总到 CTE 并使用连接进行删除？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-29T01:52:29.273

并不真地。have 子句意味着聚合，这意味着您不再拥有原始行。

我认为您想要以下内容：

```
DELETE from UserPredictions
where UserId in (select UserId from UserPredictions group by UserId having count(*) < 500) 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-29T02:57:33.247

`DELETE`您可以在语句中使用连接子选择：

```
DELETE a
FROM   UserPredictions a
JOIN
(
    SELECT   UserId
    FROM     UserPredictions
    GROUP BY UserId
    HAVING   COUNT(1) < 500
) b ON a.UserId = b.UserId 
```

* * *

## [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/e39fc/2/1)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-07-29T01:53:16.660

试试这个嵌套查询：

```
DELETE FROM UserPredictions  
WHERE UserId IN (SELECT UserId
                 FROM UserPredictions 
                 GROUP BY UserId
                 HAVING COUNT(*) < 500) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-23T19:34:16.117

您可以使用和 CTE 做很多事情`row_number() OVER (partition by )`，但前提是您的 RDBMS 支持它。

例子：

```
WITH CTE AS 
(
    SELECT UserId,
    ROW_NUMBER() OVER (PARTITION BY UserId ORDER BY UserId) AS rowcount    
    FROM UserPredictions
)
DELETE FROM CTE
WHERE rowcount < 500 
```

有关行计数功能的附加信息：

[https://docs.microsoft.com/en-us/sql/t-sql/functions/row-number-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/functions/row-number-transact-sql?view=sql-server-2017)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-29T01:55:04.140

我认为这是不可能的，但是你可以试试这个

更新：`In`也`inner join`可以使用

```
Declare @Sample table 
(
UserID int,
col2 int
)
INSERT INTO @Sample
SELECT 1,50 UNION ALL
SELECT 1,100 UNION ALL
SELECT 2,150 UNION ALL
SELECT 2,200 union all
Select 4,500

DeLETE FROM @Sample  
WHERE UserID IN (SELECT UserID
             FROM @Sample 
             GROUP BY UserID
             HAVING COUNT(*) > 1)

 Delete O
 FROM @Sample O
 INNER JOIN 
 (
  SELECT UserID 
  FROM @Sample  
  GROUP BY UserID
 HAVING COUNT(*) >1
 ) X
ON O.UserID = X.UserID 
```

我最初发布的答案：

```
Delete O
FROM UserPredictions O
INNER JOIN 
(
 SELECT UserID 
 FROM UserPredictions  
 GROUP BY UserID
 HAVING COUNT(*) <500
 ) X
ON O.UserID = X.UserID 
```

# clojure - Clojure：“=”比较集合中的值，为什么在这种情况下不能比较两个列表？

> ID：11705998
> 
> 赞同：6
> 
> 时间：2012-07-29T01:45:26.833
> 
> 标签：clojure, lisp

看这个例子：

```
Clojure 1.4.0
user=> (def a 1)
#'user/a
user=> (def b 2)
#'user/b
user=> (= [1 2] [a b])
true
user=> (= '(1 2) '(1 2))
true
user=> (= '(1 2) '(a b))
false 
```

为什么最后一个案例不起作用，以及如何使最后一个案例工作而无需将列表转换为向量？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-29T01:56:18.387

您正在将包含 1 和 2 的列表与包含符号 a 和 b 的列表进行比较。符号是 Clojure 中的合法值。'(ab) 等价于 (list 'a 'b)*而不是*(list ab)。

```
 (= '(1 2) (list a b)) 
```

可能是您想要的比较。