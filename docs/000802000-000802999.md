# StackOverflow 问答 000802000-000802999

# asp.net - 不使用 ~ 查找应用程序根 URL

> ID：802001
> 
> 赞同：7
> 
> 时间：2009-04-29T11:52:06.627
> 
> 标签：asp.net

我需要在字符串中构造页面的 URL，以向其发送电子邮件（作为电子邮件验证系统的一部分）。如果我使用 ~ 符号来表示应用程序根目录，那么它就是字面意思。

该应用程序将部署在三个不同站点（在不同端口上）的服务器上，每个站点都可以通过 2 个不同的 URL 访问（一个用于 LAN，一个用于 Internet）。

所以硬编码 URL 是没有问题的。我想在我的应用程序中构造 url 来验证.aspx

请帮忙

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-29T12:07:32.440

你需要这个：

```
HttpContext.Current.Request.ApplicationPath 
```

它相当于 URL 中的“~”。

[http://msdn.microsoft.com/en-us/library/system.web.httprequest.applicationpath.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.applicationpath.aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-30T04:00:25.410

不幸的是，列出的方法都没有生成从[http://---](http://---)开始的完整 url 。

所以我不得不从 request.url 中提取这些。像这样的东西

```
Uri url=HttpContext.Current.Request.Url;
StringBuilder urlString = new StringBuilder();
urlString.Append(url.Scheme);
urlString.Append("://");
urlString.Append(url.Authority);
urlString.Append("/MyDesiredPath"); 
```

有人可以发现任何潜在的问题吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T08:21:45.110

尝试：

```
HttpRequest req = HttpContext.Current.Request;
string url = req.Url.GetComponents(UriComponents.SchemeAndServer, UriFormat.SafeUnescaped)
    + ((req.ApplicationPath.Length > 1) ? req.ApplicationPath : ""); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T12:01:08.617

您需要将 URL 作为 Web 应用程序配置的一部分。Web 应用程序不知道如何从外部世界访问它。

例如，考虑一个场景，在您的 Web 服务器前面有多个代理和负载平衡器...... Web 服务器如何知道除了它自己的 IP 之外的任何内容？

因此，您需要通过添加基本 URL 来配置 Web 应用程序的每个实例，例如在其 web.config 中作为应用程序设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-06T14:27:04.870

我结束了这个。我获取请求 url，并使用 Request.ApplicationRoot 的位置来发现 uri 的左侧部分。应该与托管在虚拟目录“/example”或根目录“/”中的应用程序一起使用。

```
 private string GetFullUrl(string relativeUrl)
    {
        if (string.IsNullOrWhiteSpace(relativeUrl)) 
            throw new ArgumentNullException("relativeUrl");

        if (!relativeUrl.StartsWith("/"))
            throw new ArgumentException("url should start with /", "relativeUrl");

        string current = Request.Url.ToString();
        string applicationPath = Request.ApplicationPath;
        int applicationPathIndex = current.IndexOf(applicationPath, 10, StringComparison.InvariantCultureIgnoreCase);

        // should not be possible
        if (applicationPathIndex == -1) throw new InvalidOperationException("Unable to derive root path");

        string basePath = current.Substring(0, applicationPathIndex);
        string fullRoot = string.Concat(
            basePath,
            (applicationPath == "/") ? string.Empty : applicationPath,
            relativeUrl);

        return fullRoot;
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T12:02:56.680

您可以使用（[此处](http://msdn.microsoft.com/en-us/library/system.web.httprequest_properties.aspx)`HttpRequest.RawURL`的文档）属性并将您的 URL 建立在此基础上，但如果您在任何类型的重定向之后，RawURL 可能不会反映您的应用程序的实际 URL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-28T14:52:25.293

这一直对我有用：

```
string root = Request.Url.AbsoluteUri.Replace(Request.Url.PathAndQuery, ""); 
```

# c# - List的流利排序 使用扩展方法的多个标准？

> ID：802002
> 
> 赞同：3
> 
> 时间：2009-04-29T11:52:12.570
> 
> 标签：c#, sorting, extension-methods

要根据多个条件对列表进行排序，我目前正在执行以下操作：

```
collection.Sort((f1, f2) =>
{
    var comp = f1.FirstCriteria.CompareTo(f2.FirstCriteria);
    return comp != 0 ? comp : f1.SecondCriteria.CompareTo(f2\. SecondCriteria);
}); 
```

但是能够做这样的事情不是很好吗：

```
collection.MultipleSort(f1.FirstCriteria, f2.FirstCriteria)
          .Then(f1.SecondCriteria, f2.SecondCriteria) 
```

有什么想法可以很好地实现流利的排序接口吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T11:56:59.283

你的意思是像下面这样的吗？

```
using System.Linq;

collection.OrderBy(t => t.FirstCriteria).ThenBy(t => t.SecondCriteria); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:01:34.997

这里的问题是听起来你想做一个*就地*排序；在这种情况下，您需要知道（使用流利的 API）何时完成添加条件。这与 LINQ 方法形成对比，因为它使用延迟执行。

对于单一条件排序，您可以使用以下内容：

```
public static void Sort<TSource, TValue>(this List<TSource> source,
        Func<TSource, TValue> selector) {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x,y)=>comparer.Compare(selector(x),selector(y)));
}
public static void SortDescending<TSource, TValue>(this List<TSource> source,
        Func<TSource, TValue> selector) {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x,y)=>comparer.Compare(selector(y),selector(x)));
} 
```

多种分类会更难；你不能使用`params`，因为每个`TValue`可能不同。您可能需要使用终结器步骤和中间“构建器”类（本质上是编写 DSL），或者您需要先单独构建比较器。

# c# - 如何处理来自用户提交的正则表达式的无休止匹配

> ID：802003
> 
> 赞同：3
> 
> 时间：2009-04-29T11:52:13.367
> 
> 标签：c#, .net, regex, user-input

让我们考虑 C# 中的以下两行（使用框架 .NET 3.5）

```
Regex regex = new Regex(@"^((E|e)t )?(M|m)oi (?<NewName>[A-Za-z]\.?\w*((\-|\s)?[A-Za-z]?\w{1,})+)$", RegexOptions.Compiled | RegexOptions.IgnoreCase);
Match m = regex.Match("moi aussi jaimerai etre un ordinateur pour pas m'énnerver "); 
```

（对不起，这是一个法语节目 :)）

当它们被执行时，进程会卡在`Match()`方法中并且永远不会退出。我想正则表达式模式中的空白存在一些问题，但我想做的不是改变模式（实际上它是由我的工具的最终用户在程序之外设置的）但能够停止该过程（例如超时）。

有人知道这是否是 .NET 正则表达式的众所周知的问题，是否有一种简单的方法可以解决它，或者我是否必须线程化这些行并在需要时中止它们（当然我不想这样做）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T12:21:59.473

如果我在 Regexbuddy 中输入表达式，它会显示以下消息

> 由于正则表达式太复杂，匹配尝试被提前中止。您计划使用它的正则表达式引擎可能根本无法处理它并崩溃。在帮助文件中查找“灾难性回溯”以了解如何避免这种情况。

查找**灾难性回溯**给出以下解释

> **失控的正则表达式：灾难性回溯**
> 考虑正则表达式 (x+x+)+y。在你惊恐地尖叫并说这个人为的例子应该写成 xx+y 以完全匹配没有那些可怕的嵌套量词之前：假设每个“x”代表更复杂的东西，某些字符串被两个“x”匹配. 请参阅下面有关 HTML 文件的部分以获取真实示例。
> 
> 让我们看看当您将此正则表达式应用于 xxxxxxxxxxy 时会发生什么。第一个 x+ 将匹配所有 10 个 x 字符。第二个 x+ 失败。第一个 x+ 然后回溯到 9 个匹配，第二个拾取剩余的 x。该组现已匹配一次。该组重复，但在第一个 x+ 处失败。由于重复一次就足够了，因此小组匹配。y 匹配 y 并找到整体匹配。正则表达式被声明为有效，代码被发送给客户，他的计算机爆炸了。几乎。
> 
> 当主题字符串中缺少 y 时，上述正则表达式变得难看。当 y 失败时，正则表达式引擎回溯。该组有一个可以回溯到的迭代。第二个 x+ 只匹配一个 x，所以它不能回溯。但是第一个 x+ 可以放弃一个 x。第二个 x+ 立即匹配 xx。该组再次进行一次迭代，下一次失败，并且 y 失败。再次回溯，第二个 x+ 现在有一个回溯位置，减少自身以匹配 x。该小组尝试第二次迭代。第一个 x+ 匹配，但第二个被卡在字符串的末尾。再次回溯，该组第一次迭代中的第一个 x+ 将自身减少到 7 个字符。第二个 x+ 匹配 xxx。如果 y 失败，则第二个 x+ 减少为 xx，然后是 x。现在，该组可以匹配第二次迭代，每个 x+ 一个 x。但是这个 (7,1),(1,1) 组合也失败了。所以它去 (6,4) 然后是 (6,2)(1,1) 然后是 (6,1),(2,1) 然后是 (6,1),(1,2) 然后我认为你开始得到漂移。
> 
> 如果您在 RegexBuddy 的调试器中对 10x 字符串尝试此正则表达式，则需要 2558 步才能确定最后的 y 缺失。对于 11x 字符串，它需要 5118 步。对于 12，它需要 10238 步。显然，我们这里的指数复杂度为 O(2^n)。在 21 倍时，调试器以 280 万步退出，诊断出灾难性回溯的不良情况。
> 
> **RegexBuddy 是宽容的，因为它检测到它正在转圈**，并中止匹配尝试。**其他正则表达式引擎（如 .NET）将永远运行**，而其他正则表达式引擎将因堆栈溢出而崩溃（如 Perl，版本 5.10 之前）。堆栈溢出在 Windows 上尤其令人讨厌，因为它们往往会使您的应用程序消失得无影无踪。如果您运行允许用户提供自己的正则表达式的 Web 服务，请务必小心。很少有正则表达式经验的人在提出指数级复杂的正则表达式方面有着惊人的技巧。

我假设您将不得不在代码中处理它。我建议你联系[Regexbuddy](http://www.regexbuddy.com/)的作者，询问检测这种情况需要什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:35:54.743

我认为您应该简单地在单独的线程上启动正则表达式匹配，并在达到某个最大时间限制时允许中止它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-29T12:00:22.130

通常，正则表达式可能需要比您预期的更长的时间。您应该使用 Regulator 之类的工具来试验正则表达式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T12:11:13.553

问题是您在正则表达式中嵌套了“循环”，这使得它非常低效（因此由于表达式的复杂性，它基本上需要很长时间）。

如果你说你想匹配什么，我可以尝试找出一个更有效的正则表达式。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-11-07T14:11:53.370

在我看来，正则表达式匹配呈指数增长。请参阅[BCL 博客](http://blogs.msdn.com/b/bclteam/archive/2005/02/10/370690.aspx)。

最好的解决方案是在正则表达式上设置一个超时，不要搞乱线程。

请参阅此处如何[使用 timeout 去除字符串](http://msdn.microsoft.com/en-us/library/844skk0h%28v=vs.110%29.aspx)。

# apache-flex - itemClick 中的问题

> ID：802006
> 
> 赞同：0
> 
> 时间：2009-04-29T11:53:17.140
> 
> 标签：apache-flex, actionscript-3, scope

```
if (theData.hasOwnProperty("@id1")) {
    var myObj:Hello = new Hello();
    textArea.visible = false;               
    panel.addChild(myObj);
} else if (theData.hasOwnProperty("@id2")) {
    textArea.visible = false;
    var vijay:MCQ = new MCQ();
    panel.addChild(vijay);
} 
```

当我单击下一个项目时，上一个窗口仍然可见。我怎样才能摧毁 myObj。我无法通过 removeChild 做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:15:42.200

如果面板只包含一个对象，您可以在添加新对象之前使用以下内容：

```
panel.removeAllChildren(); 
```

如果面板中有已知数量的“静态”子级，您可以有条件地删除其他子级：

```
while (panel.numChildren > EXPECTED) {
    panel.removeChildAt(panel.numChildren - 1);
} 
```

最好的选择是保存对您添加的对象的引用，以便您可以使用 removeChild() 显式删除它。如果这些替代方案不起作用，也许您可​​以解释您的限制。

# delphi - 泛型类型的大小

> ID：802011
> 
> 赞同：4
> 
> 时间：2009-04-29T11:54:56.370
> 
> 标签：delphi, generics, delphi-2009, specialization

有什么方法可以确定类似的大小（以字节为单位）

```
TItem <T> = record
  Data : T;
end; 
```

我可以写类似的东西吗

```
function TItem <T>.GetByteSize : Integer;
begin
if (T = String) then
  Result := GetStringByteSize (Data as String)
else
  Result := SizeOf (Data);
end; 
```

或者也许在专业化的帮助下？

```
function TItem <String>.GetByteSize : Integer;
begin
  Result := GetStringByteSize (Data)
end;

function TItem <T>.GetByteSize : Integer;
begin
  Result := SizeOf (Data);
end; 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T12:44:47.700

取实例化类型的大小有什么问题吗？

```
SizeOf(TItem<string>) 
```

或者您可以像这样定义 GetByteSize：

```
function TItem <T>.GetByteSize : Integer;
begin
  Result := SizeOf(TItem<T>);
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T12:15:59.860

不，据我所知，您不能根据类型进行专业化

# javascript - 矩形点测试

> ID：802013
> 
> 赞同：4
> 
> 时间：2009-04-29T11:55:19.007
> 
> 标签：javascript

我有这个矩阵

```
/// as if the create a rectangle
int [][] loc = {
  {5, 15},//(x1, y1)
  {5, 30}, // (x1, y2)
  {20, 15},// (x2, y1)
  {20, 30}, // (x2, y2)
}

// this are the point that i want to check if they are in the rectangular range or not
int [] [] point = {
  {6, 16}, //(x, y)
  {3, 17}, //(x, y)
} 
```

我想要 i 方法可以通过使用 `x1<x<x2`and来获取点并搜索它是否在 loc 范围内`y1<y<y2`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T12:00:50.037

如果点 (x, y) 在矩形 (x1,y1) - (x2, y2) 内

(x1 <= x <= x2)**和**(y1 <= y <= y2)

您的代码应如下所示（这实际上是 C 代码，但 JavaScript 应该没有太大不同）：

```
 x1 = loc[0][0];
 x2 = loc[2][0];
 y1 = loc[0][1];
 y2 = loc[2][1];
 for (int i = 0; i < num_points; i++) {
   if ((x1 <= point[i][0]) && (point[i][0] <= x2) && 
       (y1 <= point[i][1]) && (point[i][1] <= y2)) {
     // This point is inside the rectangle - insert code here
   } else {
     // This point is not inside the rectangle - insert code here
   }
 } 
```

请注意，这仅在 (x1 <= x2) 和 (y1 <= y2) 时有效，因此您可能会确保使用它而不是上面的前四行：

```
x1 = Math.Min(loc[0][0], loc[2][0]);
x2 = Math.Max(loc[0][0], loc[2][0]);
y1 = Math.Min(loc[0][1], loc[2][1]);
y2 = Math.Max(loc[0][1], loc[2][1]); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-28T14:08:28.020

虽然这个问题已经得到了广泛的回答，但我想分享我的一段代码，因为它看起来更直观，看起来更像我在高中时的数学。以防万一人们因为家庭工作而查找这个问题:)

```
function between(min, p, max){
  result = false;

  if ( min < max ){
    if ( p > min && p < max ){
      result = true;
    }
  }

  if ( min > max ){
    if ( p > max && p < min){
      result = true
    }
  }

  if ( p == min || p == max ){
    result = true;
  }

  return result;
}

function point_in_rectagnle( x, y, left, top, right, bottom){
  result = false;

  if ( between(left,x,right) && between(top,y,bottom ) ){
    result = true;
  }
  return result;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-03T17:02:10.580

问题中的代码是 Java 或 C 或其他一些用 {} 定义数组文字的语言，但由于标签是 Javascript 并且这在 Google 上显示为 Javascript，因此这是在 JS 中进行点矩形交集的合理方法。

```
function pointRectangleIntersection(p, r) {
    return p.x > r.x1 && p.x < r.x2 && p.y > r.y1 && p.y < r.y2;
}

var point = {x: 1, y: 2};
var rectangle = {x1: 0, x2: 10, y1: 1, y2: 7};
pointRectangleIntersection(point, rectangle); 
```

如评论中所述，更改`>`为`>=`和/或`<`进行`<=`包含矩形边界的交集。

# c# - NHibernate：in() 的反向版本？

> ID：802022
> 
> 赞同：2
> 
> 时间：2009-04-29T11:58:23.617
> 
> 标签：c#, sql, nhibernate, hql

我正在尝试使用 Nhibernate Criteria 执行我只能描述为 IN() 的反向版本..

而不是说存储在属性中的值在列表/集合中 X

我想说，这个值 X（一个 ID）在作为对象属性的列表中。

任何帮助表示赞赏，如果这没有意义，我可以尝试更好地解释。

*编辑*向人们道歉，因为我知道这没有足够的意义......

我的系统中有一个事件项目，它可以有一个适用于它的受众（项目）列表。如果管理员想要删除受众项目，我想检查该项目是否未被任何事件引用。（AudienceList 存储为 Audiences 的 ID 字符串列表）。

我当时的想法是这样的：

var results = SessionInstance.Session.CreateCriteria(typeof(EventItem.Items.EventItem)) .Add(Restrictions.In("AudienceList", myAudience.ID)) .List();

但是我需要 AudienceList 和 myAudience.ID 反过来不是吗？我有观众 ID，但需要检查它是否在其他 ID 列表中。

再次感谢。

*编辑 2*

EventItem 的定义是它的属性之一是受众 ID 的 DetailCollection，它们作为 ID 的字符串列表保存到数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:58:14.750

编辑：废弃了我之前的答案。

好吧，听起来这里没有真正的关系模型，所以事情不会那么漂亮。如果没有外键之类的，我不确定 NHibernate 在这种情况下会有多大用处（至少可以生成一个不错的查询）。

如果单个事件记录的所有受众 ID 都存储在单个字段中，则您必须使用 SQL LIKE 或在代码中执行此操作。获取所有 EventItems 并遍历它们，检查他们的 AudienceList 集合以获取您正在寻找的 ID。如果你走这条路，最好创建一个 DTO 以最大限度地减少你移动的数据量。就像是

```
session.CreateQuery("select new AudienceListDTO(e.AudienceList) from EventItems e").List(); 
```

假设您只需要通知用户“此受众类型仍在使用中”，而不是指出具体实例。否则，您将不得不添加更多数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T12:34:59.533

你的意思是这样的吗？

```
class YourClass {
    List<int> theList;
}

IQueryable<YourClass> query = ...;
var result = from c in query where c.theList.Contains(value); 
```

# c# - 努力想出一个比较不同类型的数字对象的通用 C# 方法

> ID：802024
> 
> 赞同：1
> 
> 时间：2009-04-29T11:59:01.663
> 
> 标签：c#, generics, infragistics

我在表单上有一个 Infragistics UltraNumericEditor（版本 5.3，相当旧）控件。

如果我将 .Value 字段设置为小于 .MinValue 或大于 .MaxValue 的值，则会收到 System.Exception 并引发以下消息：

> 'Value' 属性不能设置为由 'MinValue' 和 'MaxValue' 属性确定的范围之外的值

UltraNumericEditor上相关字段的签名如下：

```
public object MinValue { get; set; }
public object MaxValue { get; set; }    
public object Value { get; set; } 
```

这有可能在我们的代码库中发生数百次，所以不是*每次都*检查 MinValue 和 MaxValue 与我们尝试设置的值，我想我会将控件子类化并将检查放在那里：

```
public class OurNumericEditor : Infragistics.Win.UltraWinEditors.UltraNumericEditor  
{  
    public object Value  
    {
        get
        {
            return base.Value;
        }
        set
        {
            // make sure what we're setting isn't outside the min or max
            // if it is, set value to the min or max instead

            double min = (double)base.MinValue;
            double max = (double)base.MaxValue;
            double attempted = (double)value;

            if (attempted > max)
                base.Value = max;
            else if (attempted < min)
                base.Value = min;
            else
                base.Value = value;
        }
    }
} 
```

显然，当值的类型 MinValue 和 MaxValue 可以转换为双精度值时，这可以正常工作，但我希望在不可能的情况下出现 InvalidCastException。

现在我可能只是在这里度过了一个金发碧眼的时刻，但我认为应该可以编写一种利用泛型进行比较的方法，但我正在努力想象这可能是什么样子。

有什么想法或意见吗？

谢谢
汤姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T12:03:56.880

您可以简单地将所有内容转换为[IComparable](http://msdn.microsoft.com/en-us/library/system.icomparable.aspx)并使用该接口进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:09:16.960

您无法充分利用泛型，因为您在编译时不知道数据类型。

只需使用`Convert`该类将任何类型的数字数据转换为`double`值：

```
double min = Convert.ToDouble(base.MinValue);
double max = Convert.ToDouble(base.MaxValue);
double attempted = Convert.ToDouble(value); 
```

这样做的好处是它还可以处理混合数据类型的情况，例如 when `MinValue`is an`int`和`value`is a `double`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T12:05:58.527

泛型在这里对您没有帮助，因为控件的 Value 属性也不是通用的。但是您可以使用[`IConvertible`](http://msdn.microsoft.com/en-us/library/system.iconvertible.aspx)界面将数字转换为比较所需的数字（例如双精度数）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T12:11:28.140

这在这里可能有点矫枉过正，而 IComparable 可能会在您的情况下发挥作用。

但是，如果您真的想强烈键入控件接受的值，您可能应该编写如下内容：

```
public OurNumericEditor<T> : Infragistics.Win.UltraWinEditors.UltraNumericEditor  

 public T Value  
    {
        get
        {
            return (T) base.Value;
        }
        set
        {
            // make sure what we're setting isn't outside the min or max
            // if it is, set value to the min or max instead

            double min = (double)MinValue;
            double max = (double)MaxValue;
            double attempted = // explicit conversion code goes here

            if (attempted > max)
                base.Value = max;
            else if (attempted < min)
                base.Value = min;
            else
                base.Value = value;
        }
    }
} 
```

# javascript - 如何在添加选项时保持 HTML 选择展开

> ID：802026
> 
> 赞同：0
> 
> 时间：2009-04-29T11:59:20.570
> 
> 标签：javascript, html, internet-explorer

我正在尝试在其`onclick`事件中为选择添加选项，并且在 Firefox 和 IE 中工作正常，但是...... IE 在填充列表后关闭列表，尽管 Mozilla 保持列表扩展

¿ 有没有办法在 IE 中保持展开列表（或用 JavaScript 重新展开列表）？（我使用的是 IE 7.0）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:38:35.720

不，据我所知。IE 重新绘制更改的部分，因此重置“设计”表面。这就是为什么会发生这种情况。您可以做什么，在 onMouseOver 事件上添加选项。这应该发生在`onClick`.

IE 的所有事件的一个很好的参考在图书馆。 [http://msdn.microsoft.com/en-us/library/ms535893%28VS.85%29.aspx#](http://msdn.microsoft.com/en-us/library/ms535893%28VS.85%29.aspx#)

# sql - 在 SQL 中，如何获取按某列排序的前 N 行？

> ID：802027
> 
> 赞同：3
> 
> 时间：2009-04-29T11:59:24.300
> 
> 标签：sql, mysql, database, relational

我想选择表格的前 N ​​行，按其中一列中的数字高低排列。

我已经有了：

`SELECT * FROM movie ORDER BY worldwide_gross DESC;`

我怎样才能得到前二十个？

如果这有什么不同，我正在使用 MySQL。

干杯!

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T12:02:28.037

定义：限制用于将您的 MySQL 查询结果限制在指定范围内。您可以使用它来显示前 X 个结果，或显示 X - Y 结果的范围。它被表述为限制 X、Y，并包含在查询的末尾。X 是起点（记住第一条记录是 0），Y 是持续时间（要显示多少条记录）。也称为：范围结果示例：

```
SELECT * FROM `your_table` LIMIT 0, 10 
```

这将显示数据库中的前 10 个结果。

```
SELECT * FROM `your_table` LIMIT 5, 5 
```

这将显示记录 6、7、8、9 和 10

更多来自[About.com](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:02:38.473

我相信：

```
SELECT * 
FROM movie 
ORDER BY worldwide_gross DESC
LIMIT 20 
```

应该做的伎俩。另请参阅[此链接](http://dev.mysql.com/doc/refman/5.1/en/select.html)。

# .net - 过滤 .NET 中的非法 XML 字符

> ID：802029
> 
> 赞同：6
> 
> 时间：2009-04-29T12:00:16.357
> 
> 标签：.net, sql, xml

我在 MS SQL 2005 中有一个 XML 存储过程，我使用 SqlCommand.ExecuteXmlReader 获取 XmlReader，然后解析数据并形成 XML 文档。问题是 SQL 中的数据包含一些二进制字符，这些字符在 UTF-8 XML 文档中是非法的，因此会引发异常。

有没有其他人处理过这个问题？我考虑过将输入数据过滤到数据库中，但是我必须将过滤放在任何地方，并且每个字符都需要检查。

还有其他建议吗？

**编辑：** 数据通常存储在各种长度的 varchar 列中。数据实际上是用户在 Web 表单（ASP .NET 应用程序）上输入的。所以有时他们从 MS Word 或其他东西中复制粘贴，然后将这些奇怪的二进制字符放入其中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T19:27:56.607

我已经看到 DotNet SqlClient 从数据库中的 nvarchar 列中“争夺”数据，我们的**理论**是它与“代理代码点”有关，请参阅：

[http://www.siao2.com/2005/07/27/444101.aspx](http://www.siao2.com/2005/07/27/444101.aspx)

[http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=rzaaxsurrogate.htm](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/ifs/rzaaxsurrogate.htm)

[http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/c0004816.htm](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/c0004816.htm)

SqlClient 似乎“解释”了一些表示我们的 Xml 格式不再正确的字节，转换为 nvarchar(max) 似乎停止了这种情况（尽管这确实对性能产生了影响）：

```
SELECT CONVERT(NVARCHAR(MAX), MyValue) FROM ... 
```

请注意，您需要使用 NVARCHAR(MAX)，NVARCHAR(N) 不起作用。

我们还发现 OleDB 提供程序也可以正常工作（尽管它比 SqlClient 慢）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T12:04:04.337

不良数据是如何进入数据库的？您使用的是 XML 列吗？

您可以将过滤（实际上称为“验证”）放入用于将数据输入数据库的存储过程中，或者您可以添加触发器来检查数据，无论数据来自何处。

一般来说，不要让不良数据进入数据库！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:26:22.287

这是编码的问题吗？还是xml格式错误？如果格式不正确，我无能为力。但是对于编码......不幸的是，`ExecuteXmlReader`不允许您指定编码，但您可以将数据视为 BLOB，并使用您自己的编码单独处理它，并且`XmlReader`？

如果数据很大，您可能希望使用`ExecuteReader`with`CommandBehavior.SequentialAccess`并将其写入临时文件 ( `Path.GetTempFileName()`) - 然后将该文件作为`Stream`with 处理`XmlReader`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:38:50.060

我已经抽象了应用程序中各处的 SqlParameter 对象的制作，因此我将在此时清理输入。我的抽象方法创建并返回一个 SqlParameter 对象以在存储过程调用中使用。如果它是调用者想要的 varchar，我将遍历他们想要生成的字符串的每个字符到 SqlParameter 对象中，并过滤掉那些非法的二进制 XML 字符。这将首先消除进入数据库的不良数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T18:38:34.637

您的存储过程如何生成 XML？如果您在 SQL Server 中使用任何 FOR XML 选项，文本字段中的二进制字符将被正确转义：

```
CREATE TABLE test (
   id int identity(1,1) not null primary key, 
   data nvarchar(50))
INSERT INTO test (data) values (char(0))
SELECT * FROM test FOR XML RAW 
```

产生：

```
<row ID="1" data="&#x0;" /> 
```

# asp.net-mvc - 如何从 FormCollection 中获取复选框？

> ID：802032
> 
> 赞同：2
> 
> 时间：2009-04-29T12:00:30.960
> 
> 标签：asp.net-mvc

我正在使用 asp.net MVC。

我有一些表的强类型视图（列表），例如索引方法

现在我为每一行放置**了四个复选框，**

喜欢[替代文字 http://img411.imageshack.us/img411/7140/24296349.png](http://img411.imageshack.us/img411/7140/24296349.png)

现在我提交表格。

在控制器中有一个方法叫做

```
[AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Index(FormCollection result) 
```

问题：每个复选框的 name 和 id 属性是什么，以便我可以轻松地操作它们？

假设我得到二维复选框数组，那么很容易为每条记录存储选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T13:22:00.780

这个问题不是特别清楚，但据我了解，您希望从表单集合中检索与复选框关联的值并将这些值传递给控制器​​。

```
int[] checkboxIndecies=new int[] { /* checkbox indecies*/ }
bool[] checkboxValues=new bool[checkboxIndecies.Length];

for (int i=0; i < index_of_last_checkbox.Length; i++)
{
checkboxValues[i]=Convert.ToBoolean(FormsCollection[checkboxIndecies]);

} 
```

这应该从表单集合中获取每个复选框的值，将它们转换为 bool 并将它们放置在 checkboxValues

如果这不清楚或只是简单的错误代码，请随时纠正我

# algorithm - 消息代码验证算法

> ID：802039
> 
> 赞同：0
> 
> 时间：2009-04-29T12:01:29.083
> 
> 标签：algorithm, language-agnostic, checksum, adler32, luhn

**如果你以前读过这个帖子——忘记我写的一切**，我写它的时候一定是喝醉了。我重新开始：

我目前正在做一个项目，我们将使用某种算法来验证用户输入。需要考虑三个方面；

客户 - 浏览我们的网页

公司 - 我们，处理客户的请求

第 3 方公司 - 处理客户消息

在我们的网页上，我们将向客户展示有关产品的一些信息。如果他/她想了解有关产品的更多信息，他必须联系第 3 方公司并说明产品代码（本身不是唯一的，但也不常见）。作为回报，客户将收到来自第三方公司的一些其他代码，他应该在我们的网页上输入这些代码，我们将在其中验证代码以供批准。

如果我们公司与第三方公司没有任何互动，那就最好不过了。纯加密是不可能的，因为它会生成一个太长的字符串。我们通过 SMS 进行此操作，因此代码必须简短。

**到目前为止我想出了什么：**

对于每件产品，我都会在 base 16 (0-f) 中生成一个有点独特的代码（它是否唯一并不重要）。想要了解有关产品的更多信息的客户向第三方公司发送一条短信，说明产品代码。作为回报，客户端收到相同的代码，但数字被乘以（可能乘以 2）并转换为基数 36。除此之外，最后一个字符被添加到代码中，即控制号，以使代码对 Luhn 有效以 36 为基数的算法。用户输入收到的代码，我们公司在服务器端根据产品代码验证它（根据 Luhn 验证，除以 2 并切换回基数 16）。

这听起来相当安全和适当吗？当其中两个不需要通信时，它是由三方发送消息的有效方式吗？

很抱歉编辑，但当我写第一篇文章时，我的想法一定在别处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:24:58.420

我认为您在混淆事物，例如，如果您使用 Luhn 算法，它只会在校验和上返回**True**或**False**。您提供的示例代码似乎表明您想要一些可以从两个不同值散列的校验和结果（例如 12345）。这个问题会更难。

第三方将如何创造这个价值？你会给他们一些 Javascript 代码让他们执行，还是其他语言？难道你不能有一个共享的密钥，他们可以用那个密钥对称地加密值，你可以让他们在他们加密的部分前面加上一些已知的值，这样你就可以快速验证它。

他们的代码：

```
 to_send = encrypted(shared_key, 'check' + code) 
```

你的代码：

```
 unencrypted = decrypt(shared_key, to_send)
  if not unencrypted.startswith('check'):
    return False # failed check 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:51:22.320

好的，所以您希望其他应用程序和您的应用程序之间没有交互。并且您想将代码限制为 6 个字符。以下是我的想法：

*   使用 10 个字符，这将使暴力攻击更加困难；
*   使用所有拉丁字母和数字 - 这将为您提供 36 个可能的字符值；
*   为什么不使用一些大数字库并简单地将您的代码（作为 Base36 数字）乘以一些可笑的大值（例如，2048 个随机位）。然后将其转换为 Base36 并取最后 10 位数字。或者可能是前 5 个和后 5 个。或者可能是依赖于原始代码的其他组合。我不知道这在密码学上会有多强（可能不多），但破解代码的努力无疑会比简单地为服务付费要小。
*   或者，您可以加盐（添加一些秘密字符串）您的代码，然后计算它的 MD5。将 MD5（或其中的一些 N 个字符）作为您的代码返回给用户。尽管我不是专家，但这在密码学上应该是可以的。通过将 MD5 结果转换为 Base36，您可以提高该算法的强度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T21:48:25.350

为什么是“校验和”？第三方不能运行你给他们的任何小工具吗？您只需要一个 5 位数的加密器，第三方可以在他们的计算机上运行，​​将产品代码输入，并将 5 位数的结果作为密钥代码发送给客户端。

加密器总是从相同的输入产生相同的结果。

然后，客户将产品代码和密钥代码发送给您。您通过该加密器的精确副本运行产品代码，并将该结果与密钥代码进行比较。

该系统的安全性可以在不改变基本架构的情况下得到增强。

-阿尔。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T21:37:35.960

**一些澄清后编辑**：

我仍然认为产品代码和匹配的第 3 方响应不能保持不变 - 否则可以将其共享给其他用户，从而能够在不去第 3 方的情况下提供响应代码。

如果产品代码是不变的，一种可能的方法是第三方响应取决于代码**和**用户的电话号码，您的验证也是如此。这样，每个响应都是产品和用户特定的。

在我看来，Luhn 算法的特定排列并不太重要——如果有人能破解一种变体，他可能也能破解另一种。

**原答案**：

简而言之，我认为你可以使用 Luhn 算法，如果你给用户一张一次性票，在有限的时间内有效。

*   首先，如果我正确理解问题，您的产品代码不能保持不变 - 否则第 3 方创建的响应对于该产品将始终相同。这意味着用户以后可以再次使用此代码，甚至可以将其提供给其他用户。
*   因此，我认为您应该根据用户对信息/访问产品的请求生成并给他一个随机的新代码。此代码应在有限的时间段内（一小时，一天，取决于您的需要）对该产品有效。
*   第三方发送给用户的响应只有在与您提供给用户的代码一起输入时才有效。
*   验证后，此代码在指定时间段结束之前无法使用。
*   作为一种选择，我认为您和第 3 方可以在计算期间将当前日期之类的内容附加到代码和响应对中，因此它们并不总是相同的对。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T10:08:50.887

经过与 3 方公司的长期辩论，我们得出结论，最好的解决方案是，如果他们将客户 SMS 传递给我，我会生成一个新代码并将其发回给他们，然后他们再将新 SMS 发送给客户我生成的代码。从我的角度来看不是最佳的，但至少我现在可以以任何我想要的方式做到这一点。

感谢您的输入。

# asp.net - Javascript：在页面加载之前引用控件

> ID：802049
> 
> 赞同：3
> 
> 时间：2009-04-29T12:02:49.283
> 
> 标签：asp.net, javascript

我在 ASPX 页面上有一个复合控件。在控件之前加载的 ASPX 页面上有 Javascript。现在，由于脚本引用了加载脚本时不存在的控件元素，因此会抛出“未定义对象”的 Javascript 错误。将脚本附加到控件的 onload 事件会给出“未定义系统”。

任何的想法？

该脚本位于外部文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T12:04:51.900

您需要将 Javascript 函数移到控件创建下方，或者将其添加到`window.load`事件处理程序中（jQuery 和 Prototype 可以帮助您），因此您可以保证在页面加载时调用 Javascript，而不是之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:15:24.497

您可以将脚本保留在控件的加载方法中，尽管实际上它应该放在**PreRender**中，因为您可以根据控件的状态包含或不包含它。这将使您免于将来出现“找不到对象”的 javascript 错误，因为您已使控件不可见。

您收到“未定义 Sys”的原因是因为您的脚本是在加载 MicrosoftAjax.js 文件之前放置的。尝试这样的事情：

```
Dim yourScript as String = "Sys.Application.add_load(function() { /*code here*/ } )"
ScriptManager.RegisterStartupScript(Page, Me.GetType(), "ScriptKey", yourScript, true) 
```

否则，如果不需要使用 Sys 命名空间，您可以使用[Page.ClientScript](http://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript.aspx)挂钩到[文档就绪事件](http://www.learningjquery.com/2006/09/introducing-document-ready)，但这听起来像您的问题。

编辑：

您可能正在寻找 RegisterClientScriptBlock 而不是 RegisterStartupScript，抱歉，两者具有不同的功能。

# architecture - 什么是自以为是的软件？

> ID：802050
> 
> 赞同：200
> 
> 时间：2009-04-29T12:02:55.353
> 
> 标签：architecture, language-agnostic, terminology

我经常看到人们说某些软件“非常固执”，或者微软倾向于编写“不固执”的框架。这实际上意味着什么？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2009-04-29T12:06:41.943

如果一个框架是固执己见的，它会锁定或引导你进入他们的做事方式。

例如：有些人认为模板系统不应该提供对用户定义的方法和函数的访问，因为它使系统可以返回原始 HTML。因此，固执己见的框架开发人员只允许访问数据结构。通过设计，软件限制并鼓励设计师按照他们的方式做事。

另一个例子（[取自信号链接](http://gettingreal.37signals.com/ch04_Make_Opinionated_Software.php)）是[wiki](http://c2.com/cgi/wiki)。wiki的设计者有很多意见。他们认为 HTML 对人们来说太复杂了，所以他们想出了一种他们认为更自然的更新内容的方法。他们还去掉了花哨的设计，因为他们认为应该更多地关注内容而不是设计。

苹果在设计产品时有强烈的意见。

***无主见的软件设计***更像是 PERL/PHP。它允许开发人员并信任开发人员做出正确的决定并将更多的控制权交给他们。

我也会将微软放在非自以为是的专栏中。Microsoft 框架的一个很好的例子，它是 unopininated `.NET`：. 通过打开 CLR 和规范，它向各种语言和实现风格开放。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-04-29T12:16:03.090

自以为是的软件意味着基本上只有一种方法（**正确的方法**™）来做事，而尝试以不同的方式做事将是困难和令人沮丧的。另一方面，以**正确​​的方式做事**™ 可以使使用软件进行开发变得非常容易，因为您必须做出的决策数量减少了，并且软件设计人员专注于使软件工作的能力增加了。如果你的问题很好地映射到解决方案上，如果做得好，自以为是的软件可以很好地使用。解决问题中未映射到所提供工具的那些部分可能会非常痛苦。这里的一个例子是 Ruby on Rails。

另一方面，非自以为是的软件为用户（开发人员）留下了很大的灵活性。它没有限制解决问题的一种方法，而是提供了灵活的工具，可用于以多种方式解决问题。这样做的缺点可能是因为这些工具非常灵活，开发任何解决方案可能相对困难。更多的解决方案可能必须由用户（开发人员）手动编码，因为框架没有提供足够的帮助。您还必须更多地考虑如何提供解决方案，而平庸的开发人员最终可能会得到比购买一些自以为是的软件更差的解决方案。PERL 可能是无主见软件的经典例子。

我的理想是一个没有意见的框架，但有很强的约定。我会把 ASP.NET MVC 放在这个类别中。实际上，所有软件在某种程度上都是固执己见的（尽管可能不是 PERL）。MVC 在选择模型时有很强的约定，但提供了许多不同的方法来解决这些约定中的问题。其中一些方法甚至可能会破坏模型。然而，按照在这样一个框架中开发的惯例正确使用可能是一种真正的乐趣。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-29T12:07:17.790

它基本上是按照作者认为应该工作的方式工作的软件，而不是试图取悦所有人。这意味着很多人不会喜欢它，但喜欢它的人会喜欢它。

Rails 可能是一个自以为是的框架的典型例子：你按照他们的方式做事，一切都很顺利。如果你不这样做，你就会受到一些痛苦。但这没关系——如果你不想按照他们的方式做事，你就不想使用 Rails。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-29T12:42:01.513

为了平衡起见，我将提供一个（相当固执的）描述，该描述对固执的方法更有利（与其他一些答案相比）。

自以为是的框架提供了一条“黄金之路”，这应该是大多数人和大多数场景（在作者眼中）的最佳实践。

然而，这并不一定意味着锁定。这意味着它可能需要一些额外的努力才能以不同的方式做事。

不那么固执己见的框架提供了许多不同的选项，并由您决定。

自以为是的框架通常会减轻开发人员重新发明轮子或一次又一次地重新思考同一个问题的负担，从而有助于专注于手头的真正问题。

在开源世界中，您可以找到许多固执己见但相互竞争的框架，因此您仍然有选择的余地。你只需要选择你自己的黄金之路。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-06-15T16:38:29.310

自以为是的软件的构建和设计方式使得以某种方式做事变得容易。它比其他设计模式更偏爱某些设计模式。在此过程中，很难偏离其开发的软件开发风格。另一种说法是它支持“约定优于配置”。即配置选项非常有限，因为软件承担了许多配置方面。一旦理解了假设，自以为是的软件通常可以更快地掌握。

另一方面，无主见的软件很少做假设。因此，无主见的软件/软件开发框架往往有很多配置选项。开发人员通常必须就软件的各个方面做出很多决定。通常，会开发各种工具，以便更轻松地处理这些巨大的选项。例如，用于 .NET 的 Visual Studio .NET、用于 Java 的 Eclipse IDE 等。非自以为是的软件通常比自以为是的软件需要更长的时间来掌握。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-08-17T16:17:28.567

**tl;博士**：

*   **自以为是**：例如*Ruby on Rails*。有一种特别受欢迎的做事方式，您会得到很多支持。以其他方式做事很难，或者对于某些系统来说是不可能的（想到 Cassandra）。
*   **无主见**：例如*Perl 5*。你可以做任何你喜欢的事情，以任何你喜欢的方式，以任何风格。所有样式都同样开放、有效和受支持。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-29T13:18:01.787

很多人都将 ASP.NET MVC 称为“无主见”的框架，我只是想对此发表一些看法。

确实，ASP.NET MVC 并没有要求太多。您可以使用任何您喜欢的持久性解决方案，无论是 Linq-to-SQL、ADO.NET Entities、NHibernate 等。

另一方面，MVC 框架确实倾向于“约定优于配置”，引用 Phil Haack 的话，他强烈建议遵循预定义的模式来定位控制器、视图、模型和其他代码。虽然你可以改变这种行为，但顺流而下更容易，而且对于大多数人来说，这样做没有问题。

围绕 ASP.NET MVC 的还有很多固执己见的人，我发现这导致了很多偏颇的教程坚持要涵盖，例如单元测试和依赖注入；我完全支持良好的测试和关注点分离，但我确实认为这些主题有点被扼杀了，通常在覆盖更有用的基础知识之前。

再一次，我必须承认，在这些领域，框架本身完全可以采用你想要的任何单元测试解决方案，以及你想要使用的任何依赖注入和模拟框架，所以我想这提供了另一个例子灵活性，甚至在单元测试的“圣经抨击”等似乎正在发生的情况下。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T12:13:58.087

这是在框架中实施的约定的数量和已做出的决定的数量。

例如，如果有 5 种（或更多）不同的方式将表单数据提交给控制器操作（在 ASP.NET MVC 中就是这种情况），那么该框架似乎是相当“无主见的”——决定权在给你！

但是，如果框架仅启用（通过直接禁用其他方式，或通过强烈鼓励）仅以一种方式来做那件事（Fubu MVC 就是这种情况），您可以说该决定已由框架做出，从而使框架固执己见。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-29T12:17:16.270

目前你会看到很多的例子是 ASP.NET MVC 框架。它具有惊人的可扩展性，但这在某些方面是它的失败之处，它没有任何肉。想做数据访问？你必须自己写。想要一些 AJAX 吗？同上。

然而，由于它是高度可扩展的，如果你在它之上构建，你可以把它变成一个固执己见的框架。这就是[MVCContrib](http://www.codeplex.com/MVCContrib)之类的东西，它们为您提供了特定的做事方法，这意味着您必须编写更少的代码。

这确实意味着，如果你想打破这种观点，通常比你在开发香草版本时要做更多的工作。不过，这是一个 80/20 的情况。如果你正确地选择了你的固执己见的框架，你只会想在 20% 的时间里打破意见，而在另外 80% 的时间里你会很有效率。

# msbuild - 如何使用 msbuild 检查项目列表中是否存在任何文件？

> ID：802070
> 
> 赞同：7
> 
> 时间：2009-04-29T12:08:57.303
> 
> 标签：msbuild

如果项目列表中的任何文件丢失，我想运行一个任务。我怎么做？

我当前的脚本有一个“源”文件列表@（MyComFiles），我使用以下任务翻译另一个“目标”文件列表@（MyInteropLibs）：

```
<CombinePath BasePath="$(MyPath)\interop" 
             Paths="@(MyComFiles->'%(filename).%(extension)')">
    <Output TaskParameter="CombinedPaths" 
            ItemName="MyInteropLibs" />
</CombinePath> 
```

我想检查 @(MyInteropLibs) 中的任何文件是否丢失并运行将创建它们的任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T13:20:43.870

如果您只需要创建丢失的文件，而不是获取丢失文件的列表，您可以使用[touch 任务](http://msdn.microsoft.com/en-us/library/37fwbyt5.aspx)，如果文件不存在，它将创建。

```
<Touch Files="@(MyInteropLibs)" AlwaysCreate="True" /> 
```

如果您只想创建丢失的文件，并避免更改现有文件的时间戳，那么批处理可以提供帮助

```
<Touch Files="%(MyInteropLibs.FullPath)" AlwaysCreate="True" 
       Condition=" ! Exists(%(MyInteropLibs.FullPath)) "/> 
```

如果您想要创建的文件列表，那么

```
<Touch Files="%(MyInteropLibs.FullPath)" AlwaysCreate="True" 
       Condition=" ! Exists(%(MyInteropLibs.FullPath)) ">
    <Output TaskParameter="TouchedFiles" ItemName="CreatedFiles"/>
</Touch>
<Message Text="Created files = @(CreatedFiles)"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T12:39:06.670

我对 MSBuild 不是很有经验，因此可能有比这更好的解决方案，但是您可以编写一个 FilesExist 任务，该任务获取文件列表并将每个文件传递给 File.Exists，如果它们确实存在则返回 true，否则返回 false，然后根据结果

抱歉，我无法提供代码来帮忙，我对 MSBuild 语法的了解并不强

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-30T21:04:59.527

您可以使用 Exec 轻松找到。

测试一组文件是否全部存在： DOS FOR /D 命令接受一个以分号分隔的文件列表 - 即一个扁平的项目数组。

```
<!-- All exist -->
<Exec
  Command="for /D %%i in (@(MyFiles)) do if not exist %%i exit 1"
  IgnoreExitCode="true">
  <Output TaskParameter="ExitCode" PropertyName="ExistExitCode"/>
</Exec> 
```

测试是否存在任何一组文件： DOS DIR 命令接受以分号分隔的文件列表。如果在列表中找到任何文件，它将 %ERRORLEVEL% 设置为 0，如果没有找到，则设置为非零。（这是更简单的情况，但它*没有*解决原始问题......）

```
<!-- Any exists -->
<Exec Command="dir /B @(MyFiles)" IgnoreExitCode="true">
  <Output TaskParameter="ExitCode" PropertyName="DirExitCode"/>
</Exec> 
```

然后很可能您会希望根据输出定义一个布尔属性。

**编辑**：顺便说一句，这是一种代码气味。通常，当您发现自己想要执行此操作时，这表明您应该设置目标的 Outputs 属性，以便它循环遍历项目。

# asp.net-mvc - ASP.NET MVC 如何应用基于角色或基于身份验证的视图呈现？

> ID：802073
> 
> 赞同：6
> 
> 时间：2009-04-29T12:10:21.403
> 
> 标签：asp.net-mvc, view, custom-attributes

我想根据身份验证状态或角色显示/隐藏视图的某些部分。对于我的控制器动作，我扩展了 ActionFilterAttribute，因此我可以为某些动作赋予属性。

```
<RequiresRole(Role:="Admin")> _
Function Action() as ActionResult
    Return View()
End Function 
```

我可以在视图中使用类似的方式（归因）吗**？**（所以不是这样：[如何根据用户的角色创建具有不同显示的视图？](https://stackoverflow.com/questions/409213/asp-net-mvc-roles-views))

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T23:10:41.737

您可以像这样从视图访问用户的登录角色：

```
<% if (Page.User.IsInRole("Admin")) { %>
        <td>
          <%= Html.DeleteButton("delete", model.ID) %>
        </td>
<% } %> 
```

也许你的扩展方法类似于：

```
public static string DeleteButton(this HtmlHelper html, 
    string linkText, int id)
{
    return html.RouteLink(linkText,
     new { ID = id, action = "Delete" },
     new { onclick = "$.delete(this.href, deleteCompleted()); return false;" });
} 
```

显然，我正在使用 JavaScript 对我的控制器操作执行 HTTP DELETE，以防止页面爬虫意外删除数据以获取我的页面。在我的例子中，我使用 delete() 方法扩展 JQuery 来补充 HTTP 动词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-25T18:28:27.913

我新这个存在，但花了一段时间才找到。这是我正在使用的：

```
<asp:LoginView runat="server">
    <AnonymousTemplate>
        You are not logged in yet. Please log in.
    </AnonymousTemplate>
    <RoleGroups>
        <asp:RoleGroup Roles="Admin">
            <ContentTemplate>
                You are an Admin.
            </ContentTemplate>
        </asp:RoleGroup>
        <asp:RoleGroup Roles="Customers">
            <ContentTemplate>
                You are a customer.
            </ContentTemplate>
        </asp:RoleGroup>
    </RoleGroups>
    <LoggedInTemplate>
        Simple Log in check
    </LoggedInTemplate>
</asp:LoginView> 
```

这允许您根据登录状态或凭据向不同用户显示不同的内容。

# opengl - 每次画东西时我应该调用 glEnable 和 glDisable 吗？

> ID：802079
> 
> 赞同：19
> 
> 时间：2009-04-29T12:12:42.317
> 
> 标签：opengl

我应该多久调用一次 OpenGL 函数，如`glEnable()`or`glEnableClientState()`及其对应的函数`glDisable`？它们是在应用程序开始时被调用一次，还是我应该禁用它们并只启用我立即需要的那些功能来绘制某些东西？有性能差异吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T13:04:00.340

**警告：glPushAttrib / glPopAttrib 在现代 OpenGL 可编程管道中已弃用。**

如果您发现您经常检查状态变量的值并随后调用 glEnable/glDisable，您可以使用属性堆栈 (glPushAttrib / glPopAttrib) 稍微清理一下。

属性堆栈允许您隔离代码的各个区域，这样对一个部分中的属性的更改不会影响其他部分中的属性状态。

```
void drawObject1(){
  glPushAttrib(GL_ENABLE_BIT);

  glEnable(GL_DEPTH_TEST);
  glEnable(GL_LIGHTING);    

  /* Isolated Region 1 */

  glPopAttrib();
}        

void drawObject2(){
  glPushAttrib(GL_ENABLE_BIT);

  glEnable(GL_FOG);
  glEnable(GL_GL_POINT_SMOOTH);    

   /* Isolated Region 2 */

  glPopAttrib();
}    

void drawScene(){
  drawObject1();
  drawObject2();
} 
```

虽然`GL_LIGHTING`和`GL_DEPTH_TEST`在 drawObject1 中设置，但它们的状态不会保留到 drawObject2。在没有 glPushAttrib 的情况下，情况并非如此。另外 - 请注意，在函数调用结束时不需要调用 glDisable，glPopAttrib 可以完成这项工作。

就性能而言，对 glEnable/glDisable 的单个函数调用的开销是最小的。如果您需要处理大量状态，您可能需要创建自己的状态管理器或多次调用 glGetInteger... 然后采取相应措施。增加的机器和控制流可能会使代码不那么透明、更难调试和更难维护。这些问题可能会使其他更富有成效的优化变得更加困难。

归因堆栈可以帮助维护抽象层并创建隔离区域。

[glPushAttrib 手册页](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/pushattrib.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-29T12:15:34.590

“那要看”。

如果您的整个应用程序仅使用启用/禁用状态的一种组合，那么无论如何只需在开始时进行设置即可。

大多数现实世界的应用程序需要混合，然后您被迫调用`glEnable()`以启用某些特定状态，进行绘图调用，然后`glDisable()`在您完成“清理舞台”时再次调用它们。

状态排序、状态跟踪和许多优化方案都源于此，因为状态切换有时很昂贵。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-30T06:20:45.340

首先，您使用哪个 OpenGL 版本？您的目标群体拥有哪一代图形硬件？知道这一点将更容易给出更正确的答案。我的回答假设 OpenGL 2.1。

OpenGL 是一个状态机，这意味着无论何时更改状态，该状态都会变为“当前”状态，直到程序员通过新的 OpenGL API 调用再次显式更改。存在此规则的例外情况，例如客户端状态数组调用使当前顶点颜色未定义。但这些是定义规则的例外。

“*在应用程序开始时一次*”没有多大意义，因为有时您需要在应用程序仍在运行时销毁 OpenGL 上下文。我假设您的意思是在每个窗口创建之后。这适用于您以后不需要更改的状态。示例：如果您的所有绘图调用都使用相同的顶点数组数据，则无需在之后使用 glDisableClientState 禁用它们。

有很多与旧的固定功能管道相关的启用/禁用状态。对此的简单救赎是：使用着色器！如果您的目标是最多使用五年的一代卡，它可能会模仿带有着色器的固定功能管道。通过使用着色器，您可以或多或少地完全控制变换和光栅化阶段发生的事情，并且您可以使用制服制作自己的“状态”，更改/更新非常便宜。

知道 OpenGL 是我上面所说的状态机应该清楚地表明，只要有可能，就应该努力将状态变化保持在最低限度。但是，很可能还有其他因素对性能的影响远大于启用/禁用状态调用。如果您想了解它们，请仔细阅读。

* * *

国家费用*不*与旧的固定功能状态调用相关联并且不是简单的启用/禁用状态可能在成本上有很大差异。值得注意的是，链接着色器和绑定名称（纹理、程序、缓冲区对象的“名称”）通常相当昂贵。这就是为什么很多游戏和应用程序会根据纹理对网格的绘制顺序进行排序。这样，他们就不必绑定相同的纹理两次。然而，如今，这同样适用于着色器程序。如果你不需要，你不想绑定同一个着色器程序两次。此外，并非特定 OpenGL 版本中的所有功能都在所有卡上都进行了硬件加速，即使这些卡的供应商声称它们与 OpenGL 兼容。合规意味着它们遵循规范，而不是它们必须有效地运行所有功能。

* * *

结论：除非有明显的理由不使用，否则使用着色器！由于您可以使用制服，因此它可以使您免于许多不必要的状态调用。你知道，OpenGL 着色器已经存在了大约六年。此外，启用/禁用状态更改的开销*可能*是一个问题，但通常可以从优化其他更昂贵的状态更改中获得更多收益，例如 glUseProgram、glCompileShader、glLinkprogram、glBindBuffer 和 glBindTexture。

PS：OpenGL 3.0 删除了客户端状态启用/禁用调用。它们被隐式启用，因为绘制数组是此版本中绘制的唯一方法。立即模式已删除。gl..Pointer 调用也被删除，因为真的只需要 glVertexAttribPointer。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T16:42:16.460

我被教导的一条经验法则说，随意启用/禁用几乎总是更便宜，而不是检查当前状态并仅在需要时进行更改。

也就是说，Marc 的回答绝对应该有效。

# objective-c - NSOuputStream 多次写入

> ID：802096
> 
> 赞同：4
> 
> 时间：2009-04-29T12:16:24.977
> 
> 标签：objective-c, iphone, cocoa-touch, sockets

我正在尝试使用 NSStream 对象打开，然后在套接字上读写，但我遇到了问题。

打开套接字后，我不知道如何在套接字上写字。

这是我的做法

1）首先打开套接字：

```
 NSURL *website = [NSURL URLWithString:urlStr]; 
        if (!website) { 
            NSLog(@"%@ is not a valid URL"); 
            return; 
        } 
        NSHost *host = [NSHost hostWithName:urlStr]; 
        // iStream and oStream are instance variables 
        [NSStream getStreamsToHost:host port:6667 inputStream:&iStream 
                      outputStream:&oStream]; 
        [iStream retain]; 
        [oStream retain]; 
        [iStream setDelegate:self]; 
        [oStream setDelegate:self]; 
        [iStream scheduleInRunLoop:[NSRunLoop currentRunLoop] 
                           forMode:NSDefaultRunLoopMode]; 
        [oStream scheduleInRunLoop:[NSRunLoop currentRunLoop] 
                           forMode:NSDefaultRunLoopMode]; 
        [iStream open]; 
        [oStream open]; 
```

2）设置循环：

```
- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent
{
    NSString *io;

    if (theStream == iStream) io = @">>";
    else io = @"<<";
    NSLog(@"stream : %@",theStream);

    NSString *event;
    switch (streamEvent)
    {
        case NSStreamEventNone:
            event = @"NSStreamEventNone";
            break;
        case NSStreamEventOpenCompleted:
            event = @"NSStreamEventOpenCompleted";
            break;
        case NSStreamEventHasBytesAvailable:{
            event = @"NSStreamEventHasBytesAvailables";
            if (theStream == iStream)
            {
                if(!_data) { 
                    _data = [[NSMutableData data] retain]; 
                } 
                uint8_t buf[1024]; 
                unsigned int len = 0; 
                len = [iStream read:buf maxLength:1024]; 
                NSLog(@"Lenght data read : %d", len);
                if(len) { 
                    NSData * dataReceived= [[NSString stringWithFormat:@"%s\n", (char *)buf] dataUsingEncoding:NSUTF8StringEncoding];
                    NSString *s = [[NSString alloc] initWithData:dataReceived encoding:NSUTF8StringEncoding];
                    NSLog(@"Received _data: \"%@\"\n",s);

                } else { 
                    NSLog(@"nothing to read!"); 
                } 
            }else {
                NSLog(@"Not the good stream");
            }

            break;
        }

        case NSStreamEventHasSpaceAvailable:{
            event = @"NSStreamEventHasSpaceAvailable";
            if (theStream == oStream )
            {
                if(isConnexionCommandSent == NO){
                    [self sendCommand:@"My connection command"];    
                    isConnexionCommandSent = YES;
                }

            }

            break;
        }

        case NSStreamEventErrorOccurred:
            event = @"NSStreamEventErrorOccurred";
            NSError *theError = [theStream streamError]; 
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:[theError localizedDescription]
                                                           delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
            [alert show];
            [alert release];
            break;
        case NSStreamEventEndEncountered:
            event = @"NSStreamEventEndEncountered";

            break;
        default:
            event = @"** Unknown";
    }

    NSLog(@"%@ : %@", io, event);
} 
```

3）然后我有一个在我触摸按钮时调用的函数

```
- (IBAction)join:(id)sender{
    if([oStream hasSpaceAvailable]){
        NSLog(@"iStream Status : %d",[iStream streamStatus]);
        NSLog(@"oStream Status : %d",[oStream streamStatus]);
        [self sendCommand:@"join"];

    }else{
        NSLog(@"Error command can't be sent");      
    }
}

-(void) sendCommand:(NSString *) command{
    NSLog(@"space : %d",[oStream hasSpaceAvailable]);
    if ([oStream hasSpaceAvailable])
    {
        NSLog(@"Command writen : %s\n",[command cStringUsingEncoding:NSASCIIStringEncoding]);
        NSInteger i=[oStream write:(const uint8_t *)[command cStringUsingEncoding:NSASCIIStringEncoding] maxLength:(NSInteger)[command lengthOfBytesUsingEncoding:NSASCIIStringEncoding]];
        if (i<0)
        {
            NSLog(@"erreur lors de l'envoi, status:%i, erreur:%@", [oStream streamStatus], [oStream streamError]);
        }
        isReadyToSend = NO;
    }

    else
    {
        NSLog(@"impossible d'envoyer, status:%i, erreur:%@", [oStream streamStatus], [oStream streamError]);
    }
} 
```

但问题是，当调用函数 join 时，一切正常，但服务器什么也没收到......

上

```
NSInteger i=[oStream write:(const uint8_t *)[command cStringUsingEncoding:NSASCIIStringEncoding] maxLength:(NSInteger)[command lengthOfBytesUsingEncoding:NSASCIIStringEncoding]]; 
```

i > 0，所以我假设写作进展顺利，但在服务器上没有收到任何内容......我不知道为什么......

你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-16T19:06:25.007

嘿@Ptitaw 看到[这篇文章](https://stackoverflow.com/questions/6356857/how-do-i-know-if-my-client-ios-app-is-connected-to-the-server)。我相信在那里你可能会找到你的答案和一种更简单的方法来连接和自动访问所有事件（阅读、写作等）。希望我能提供帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-27T09:00:59.533

但是，一个非常晚的答案可能对遇到类似问题的人有所帮助。

我认为这可能是由于数据编码机制。您的服务器可能正在使用 UTF-8 编码，而您正在使用 NSASCIIStringEncoding 发送数据。尝试这个：

```
NSInteger i=[oStream write:(const uint8_t *)[command cStringUsingEncoding:NSUTF8StringEncoding] maxLength:(NSInteger)[command lengthOfBytesUsingEncoding:NSUTF8StringEncoding]]; 
```

# visual-studio - 如何在 Visual Studio / SQL Server 2005 中中断插入

> ID：802100
> 
> 赞同：1
> 
> 时间：2009-04-29T12:18:53.083
> 
> 标签：visual-studio, sql-server-2005, debugging

每当将记录插入某个表时，我想使用 Visual Studio 中断，这样我就可以看到插入的值和从那一刻起的调用堆栈。这可能吗，还是我只坚持存储过程调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:22:36.757

好吧，既然您使用的是 SqlServer，为什么不直接使用 Profiler 呢？设置跟踪，您可以观察插入的值...。您可以在 Visual Studio 中设置断点，也可以将其设置为回滚的事务，然后通过跟踪查找将已经进去了。

如果您以前没有使用过分析器，那么它非常容易并且应该做我认为您想要完成的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:23:44.773

根据您编写实际执行数据库插入的代码的方式，您可以在被调用的函数/子上设置一个断点并单步执行它以查看正在传递的值，但我们可能需要更具体地了解您是如何在代码中实际执行数据库操作的。

**编辑**：如前所述，如果您不使用 Visual Studio，则使用 SQL Server Profiler 可能是您的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:38:54.563

比它值得的更多努力，但可能，可能会在表上创建一个触发器并使用此方法[http://support.microsoft.com/kb/316549](http://support.microsoft.com/kb/316549)

但是就像每个人都建议的那样，中断执行插入或使用 sql profiler 的 .net 代码要容易得多且可靠得多。

# c# - 滚动查看器中的 WPF/C# Textwrapping 使窗口大小调整滞后

> ID：802103
> 
> 赞同：2
> 
> 时间：2009-04-29T12:20:18.307
> 
> 标签：c#, .net, wpf, listbox, word-wrap

海。

我有一个带有滚动查看器的 ListBox。列表框的每一项（40++ 项）都包含一个文本块和一个小图像。当我调整窗口大小时，调整大小非常滞后。如果我将项目的文本块可见性设置为“折叠”，则调整大小是可以的。我的第一种方法是将滚动查看器中未显示的每个项目的可见性设置为“折叠”，但是当用户可见项目时我找不到指示符。

有没有人有想法让调整大小的过程不那么滞后，也许是其他一些控件而不是文本块？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T14:08:28.700

以下指定给定偏移量处的项目是否可见：

```
public bool IsItemVisible(ListBox listBox, int index)
{
    if (listBox.Items.Count != 0)
    {
        VirtualizingStackPanel vsp = (VirtualizingStackPanel)VisualTreeHelper.GetParent(listBox.ItemContainerGenerator.ContainerFromIndex(0));
        int FirstVisibleItem = (int)vsp.VerticalOffset, VisibleItemCount = (int)vsp.ViewportHeight;
        return index >= FirstVisibleItem && index <= FirstVisibleItem + VisibleItemCount;
    }

    return false;
} 
```

你可以像这样使用它：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    for (int i = listbox1.Items.Count - 1; i >= 0; i--)
        if (!IsItemVisible(listbox1, i))
            ((ListBoxItem)listbox1.Items[i]).Visibility = Visibility.Collapsed;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T09:14:34.043

提高调整大小性能的最佳方法是在 ScrollContentPresenter中使用**VirtualizingStackPanel 。**您可以在例如您的 ListBox 或通常的 ItemsPanel 的数据模板中覆盖它。

与普通的 StackPanel 相比，它不会呈现不可见的项目，后者始终呈现所有项目，无论它们是否对用户可见。

对我来说效果很好。

# perl - 如何检查是否安装了 Perl 模块？

> ID：802107
> 
> 赞同：11
> 
> 时间：2009-04-29T12:21:59.627
> 
> 标签：perl, module

我正在编写一个小的 Perl 脚本，它依赖于一些可能可用的模块，所以在安装过程中我必须检查那里是否有所有东西。我可以写信`use some::module`看看是否出现错误，但是像“你需要安装一些::模块”这样的短消息对最终用户会更有帮助。

我也可以只搜索 中的每个目录`@INC`，但是因为它是 Perl，所以必须有一个更简单的方法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-29T12:26:38.197

```
perl -MSome::Module -e ';' 
```

哎呀，误读了这个问题。我以为你想一次性知道，而不是以可恢复的方式发现它。我总是使用这样的东西：

```
sub try_load {
  my $mod = shift;

  eval("use $mod");

  if ($@) {
    #print "\$@ = $@\n";
    return(0);
  } else {
    return(1);
  }
} 
```

你像这样使用它：

```
$module = 'Some::Module';
if (try_load($module)) {
  print "loaded\n";
} else {
  print "not loaded\n";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T12:28:51.390

怎么样：

```
die "Some::Module missing!" unless(eval{require Some::Module}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T15:54:12.723

你是如何安装你的脚本的？如果您使用标准的 Makefile.PL 或 Build.PL，列出依赖项是微不足道的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T19:05:48.160

我有一个小脚本，列出了我系统上的所有 Perl 模块；

```
#!/usr/bin/perl

use ExtUtils::Installed;
my $instmod = ExtUtils::Installed->new();
foreach my $module ($instmod->modules()) {
    my $version = $instmod->version($module) || "???";
    print "$module -- $version\n";
} 
```

在该 foreach 循环中，您可能想做一些事情，例如；

```
my $match;
if ($module =~ /$match/) {
  print "Found $match: $module\n";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T14:36:16.170

我使用这样的东西：

```
BEGIN { 
    my $module_name    = shift; # @ARGV
    our $module_exp = $module_name;
    eval "use $module_name;";
}

$module_exp =~ s{::}{/}g;
foreach my $key ( grep { m/^$module_exp\./ } keys %INC ) { 
    print "$key => $INC{$key}\n";
} 
```

但我更多地以 korn shell 函数的形式使用它：

```
function wherperl
{
     perl -M$1 <<EX_DOC
     my \$module = '$1';
     \$module =~ s/::/\\//g;

     for ( keys %INC ) {
         next unless m/^\$module\./;
         print \$_ . ' => ' . \$INC{\$_} . "\n";
     }
EX_DOC
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-01T16:26:21.950

我喜欢使用该`cpan`实用程序：

```
% cpan -D YAML
YAML
-------------------------------------------------------------------------
    YAML Ain't Markup Language (tm)
    A/AD/ADAMK/YAML-0.70.tar.gz
    /usr/local/perls/perl-5.10.0/lib/site_perl/5.10.0/YAML.pm
    Installed: 0.68
    CPAN:      0.70  Not up to date
    Ingy dot Net (INGY)
    ingy@cpan.org 
```

This can be a little slow since it has to connect to a CPAN mirror to fetch some of the data, but I also have a local CPAN mirror. :)

# iphone - iPhone 上的 Objective-C 发布问题

> ID：802110
> 
> 赞同：0
> 
> 时间：2009-04-29T12:23:16.847
> 
> 标签：iphone, objective-c, memory-management

我有一个问题，当我在 iPhone 上的 dealloc 中调用 NSStream 对象上的 release 时，我得到了 EX_BAD_ACCESS。

以下代码

```
- (void)dealloc {
    DLog(@"dealloc started for: %@",self);
    @synchronized(self) {
        lookupCount--;
    if (lookupCount==0) {
        UIApplication* app = [UIApplication sharedApplication];
        app.networkActivityIndicatorVisible = NO;
        }
    }
    DLog(@"inStream retain count before release: %d",[inStream retainCount]);
    [inStream release];
    DLog(@"outStream retain count before release: %d",[outStream retainCount]);
    [outStream release];
    [queryToSend release];
    [resultString release];
    [data release];
    [super dealloc];
    NSLog(@"dealloc finsihed for : %@",self);
    } 
```

在 [outstream release] 上使用 EX_BAD_ACCESS 崩溃；线。

日志输出如下

```
2009-04-29 13:16:28.547 App[30580:20b] -[SimpleQuery dealloc] [Line 160] dealloc started for: <SimpleQuery: 0x56e540>
2009-04-29 13:16:28.547 App[30580:20b] -[SimpleQuery dealloc] [Line 168] inStream retain count before release: 1
2009-04-29 13:16:28.548 App[30580:20b] -[SimpleQuery dealloc] [Line 170] outStream retain count before release: 1 
```

想知道是否有人知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:55:33.763

在评论中你说这个`outstream`

> 它是通过调用 getStreamsToHostNamed:port:inputStream:outputStream: 创建的，它不应该返回我不认为的自动释放对象。

事实上，它是自动发布的。除非您将该对象保留在代码中的某个位置，否则您不负责它的内存管理。

您应该查看[Apple 内存管理指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。

> 许多类提供 +className... 形式的方法，您可以使用这些方法来获取该类的新实例。通常被称为“便利构造函数”，这些方法创建一个类的新实例，初始化它，然后返回给你使用。尽管您可能认为您有责任释放以这种方式创建的对象，但根据 Cocoa 集的策略，情况并非如此——方法名称不包含“alloc”或“copy”，或者以“new”开头。因为类创建了新对象，所以它负责处理新对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T12:34:08.490

一些潜在的问题：

*   您正在锁定 self 以执行 lookupCount 递减循环，我认为这意味着您希望此代码从不同的线程运行。那应该是一个危险信号，因为如果您同时从两个线程释放一个实例，那么其中一个线程最终会尝试释放一个已经释放的实例。
*   最后的`NSLog`调用将尝试打印`self`已经被释放的内容。

我知道这些都不是专门与相关的`[outStream release]`，但它们可能是相关的。您可能想尝试使用[NSZombieEnabled](http://www.cocoadev.com/index.pl?NSZombieEnabled)进行调试以获取更多信息。

另外，请确保`inStream`release 也不会隐式 release`outStream`等。

# caching - 将大结构指针传递给函数缓存是否有效？

> ID：802112
> 
> 赞同：1
> 
> 时间：2009-04-29T12:24:36.143
> 
> 标签：caching, performance

如果一个结构很大，有很多成员变量。某些函数需要访问结构中的 4-5 个元素才能正常工作，因此以下哪种情况可能是缓存有效的（更少的缓存未命中）-

1.）将指向结构的指针作为参数传递给函数，依次访问所需的元素。（假设元素在结构声明中不连续并且它们是分开的）

2.) 将单个结构成员变量作为参数传递给函数。

首先，这种情况是否会首先从缓存的角度影响代码的性能？

谢谢。

-广告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:28:10.050

忽略缓存问题，传递指针总是最快的，因为复制感兴趣的字段没有开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:29:43.120

**好吧......如果访问的成员相隔许多缓存行，那么如果**函数进行多次访问，那么将它们全部收集（在堆栈上，或者甚至在可能的寄存器中）作为参数可能会有所帮助。如果没有，读取参数和设置调用的额外开销可能会消耗掉好处。

我认为这是一个微优化，您应该对这两种情况进行分析，然后记录由于所述分析而对代码所做的任何更改（因为稍后对偶然的观察者来说并不明显） .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T03:18:21.373

内存访问是内存访问。它是否发生在调用者或被调用者中并不重要。忽略缓存，传递指针（按引用传递）有几个原因。

*   关注点分离要求被调用者应该决定它想要访问什么。
*   传递更多参数可能会增加寄存器文件的压力和/或导致对堆栈的更多访问。
*   传递单个参数比传递多个参数更具可读性。（可以说与关注点分离有关。）

提高缓存性能的唯一方法是提高局部性。`struct`在（或其他）定义中将变量排列为连续的。安排算法只访问每个结构一次。如果这些不是简单的更改，并且程序是缓存绑定的，那么性能将只需要这么多的编程工作。

# c# - 使用生成的 DAL 代码进行单元测试

> ID：802113
> 
> 赞同：0
> 
> 时间：2009-04-29T12:24:55.457
> 
> 标签：c#, unit-testing, mocking, .nettiers

我使用代码生成器（带有 .NetTiers 模板的 CodeSmith）来生成所有 DAL 代码。我为我的代码（业务层）编写单元测试，而这些测试运行起来非常缓慢。问题是对于每个测试，我都将数据库重置为干净的状态。此外，当我进行大量测试时，似乎数据库操作的延迟加起来有点延迟。

所有 DB 操作都是`DataRepository`通过 .NetTiers 生成的类执行的。您是否知道是否有一种方法可以生成（或自己编写代码）一个使用内存存储而不是使用数据库的模拟数据存储库？

这样，我就可以在我的单元测试中使用这个模拟存储库，大大加快它们的速度，而无需对我当前的代码进行任何实际更改！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T21:08:59.190

看看依赖注入 (DI) 和控制反转容器 (IOC)。本质上，您将创建一个新的模拟数据库对象可以实现的接口，然后 DI 框架将在运行测试时注入您的模拟数据库，并在运行您的应用程序时注入真实数据库。

您可以使用许多免费和开源库来帮助您。[由于您使用的是 C#，因此Ninject](http://ninject.org/)是新的和即将推出的 DI 库之一。还有很多其他的。查看此[Wikipedia 文章](http://en.wikipedia.org/wiki/Dependency_injection#Existing_frameworks)以了解其他内容和高级描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-03T17:53:45.533

从问题的描述来看，我认为您正在执行集成测试，因为您的测试正在使用业务、DAL 和实时数据库。

对于单元测试，您需要处理一层代码以及所有其他依赖项，无论是模拟的还是存根的。使用这种方法，您的单元测试将非常快速地在每次增量代码更改时执行。

您可以使用各种模拟框架，例如 Rhino Mock、Moq、typemock 等等。（在我的项目中，我使用 Rhino mock 来模拟 DAL 层并在 Isolation 中对业务层进行单元测试）

哈沙

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:32:58.337

我们的一些单元测试使用从数据库生成的 XML 获取的数据来模拟数据库访问。DAL 类被模拟类取代，因为它们都存储在 DI 容器中。

xml 的生成是自定义代码，如果您为此找到开源解决方案，那么我很高兴听到它。

在 Stefan 的回答之后编辑：我记得另一个团队使用[SQL CE](http://en.wikipedia.org/wiki/SQL_Server_Compact)作为他们的测试数据库

# windows-services - Windows命令获取服务状态？

> ID：802121
> 
> 赞同：25
> 
> 时间：2009-04-29T12:26:47.883
> 
> 标签：windows-services, batch-file, windows-server-2003

我需要在我的批处理脚本结束时知道服务的状态，该脚本使用“net stop thingie”和“net start thingie”重新启动服务。

在我最喜欢的理想世界中，我想将状态通过电子邮件发送给自己，在寒冷的冬夜阅读，用我知道运行正常的服务器的温暖和舒适来安慰自己。

请注意，我使用的是 Windows server 2003 平台，批处理文件似乎是最佳选择。我不介意使用其他东西，并且非常愿意接受建议，但只是为了知识（作为僵尸渴望大脑，我想，为什么不给我自己的大脑充气），是否有一个命令可以让我检查在命令行中的服务状态？

我应该将命令的输出重定向到文件吗？

我的裤子在哪里？（天哪，我真的希望插入其中的幽默不会侮辱任何人。现在是星期三早上，我也需要幽默：P）

[编辑：]我使用的解决方案（不再）可从--link redacted--下载

它被用作在夜间执行的任务集，并在早上检查我的电子邮件，我查看服务是否已正确重新启动。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-29T12:44:09.480

你试过`sc.exe`吗？

```
C:\> for /f "tokens=2*" %a in ('sc query audiosrv ^| findstr STATE') do echo %b
4  RUNNING

C:\> for /f "tokens=2*" %a in ('sc query sharedaccess ^| findstr STATE') do echo %b
1  STOPPED 
```

请注意，在批处理文件中，您将每个百分号加倍。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-29T12:47:44.090

您可以致电`net start "service name"`您的服务。如果它没有启动，它会启动它并返回errorlevel=0，如果它已经启动它会返回errorlevel=2。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-29T12:30:33.897

使用[pstools](http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx) - 特别是[psservice](http://technet.microsoft.com/en-us/sysinternals/bb897542.aspx)和“查询” - 例如：

```
psservice query "serviceName" 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-10-03T08:07:30.990

也看看他：

网络开始 | FIND "Service name" > nul IF errorlevel 1 ECHO 服务没有运行

刚刚复制自： [http ://ss64.com/nt/sc.html](http://ss64.com/nt/sc.html)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-29T13:37:49.307

如果您可以使用 PowerShell...

```
Get-Service -DisplayName *Network* | ForEach-Object{Write-Host $_.Status : $_.Name} 
```

会给你...

```
Stopped : napagent
Stopped : NetDDE
Stopped : NetDDEdsdm
Running : Netman
Running : Nla
Stopped : WMPNetworkSvc
Stopped : xmlprov 
```

如果您只需要检查一项服务，则可以将 ****Network**** 替换为特定的服务名称。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-29T12:30:57.517

使用 Windows 脚本：

```
Set ComputerObj = GetObject("WinNT://MYCOMPUTER")    
ComputerObj.Filter = Array("Service")    
For Each Service in ComputerObj    
    WScript.Echo "Service display name = " & Service.DisplayName    
    WScript.Echo "Service account name = " & Service.ServiceAccountName    
    WScript.Echo "Service executable   = " & Service.Path    
    WScript.Echo "Current status       = " & Service.Status    
Next 
```

您可以轻松过滤上述内容以获取所需的特定服务。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-08T11:45:38.680

也许这可能是启动服务并检查结果的最佳方式

当然，从像 File.BAT 这样的 Batch 中放置类似此示例的内容，但只需将“NameOfServive”替换为您想要的服务名称，然后将 REM 行替换为您自己的代码：

```
@ECHO OFF

REM Put whatever your Batch may do before trying to start the service

net start NameOfSercive 2>nul
if errorlevel 2 goto AlreadyRunning
if errorlevel 1 goto Error

REM Put Whatever you want in case Service was not running and start correctly

GOTO ContinueWithBatch

:AlreadyRunning
REM Put Whatever you want in case Service was already running
GOTO ContinueWithBatch

:Error
REM Put Whatever you want in case Service fail to start
GOTO ContinueWithBatch

:ContinueWithBatch

REM Put whatever else your Batch may do 
```

另一件事是在不更改状态的情况下检查其状态，因为有一种更简单的方法可以做到这一点，只需运行：

```
net start 
```

因此，如果没有参数，它将显示一个包含所有已启动服务的列表......

因此，一个简单的 grep 或在管道上查找它会适合......

当然，从像 File.BAT 这样的 Batch 中放置类似此示例的内容，但只需将“NameOfServive”替换为您想要的服务名称，然后将 REM 行替换为您自己的代码：

```
@ECHO OFF

REM Put here any code to be run before check for Service

SET TemporalFile=TemporalFile.TXT
NET START | FIND /N "NameOfSercive" > %TemporalFile%
SET CountLines=0
FOR /F %%X IN (%TemporalFile%) DO SET /A CountLines=1+CountLines
IF 0==%CountLines% GOTO ServiceIsNotRunning

REM Put here any code to be run if Service Is Running

GOTO ContinueWithBatch

:ServiceIsNotRunning

REM Put here any code to be run if Service Is Not Running

GOTO ContinueWithBatch
:ContinueWithBatch
DEL -P %TemporalFile% 2>nul
SET TemporalFile=

REM Put here any code to be run after check for Service 
```

希望这可以帮助！这是我通常使用的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-02-08T11:54:51.920

好吧，我看到“Nick Kavadias”这样说：

> “根据这个[http://www.computerhope.com/nethlp.htm](http://www.computerhope.com/nethlp.htm)它应该是 NET START /LIST ...”

如果您在 Windows XP 中键入：

```
NET START /LIST 
```

你会得到一个错误，只需输入

```
NET START 
```

/LIST 仅适用于 Windows 2000... 如果您完全阅读此类网页，您会看到 /LIST 仅适用于 Windows 2000 部分。

希望这可以帮助！！！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-11T17:07:14.347

我的意图是创建一个脚本来打开和关闭服务（在 1 个脚本中）

> ```
> net start NameOfSercive 2>nul
> if errorlevel 2 goto AlreadyRunning
> if errorlevel 1 goto Error 
> ```
> 
> ...

帮助很大！！TYVM z666

但是当例如服务被禁用时（也错误级别= 2？）它会进入“AlreadyRuning”并且永远不会出现

> ```
> if errorlevel 1 goto Error  ?!! 
> ```

我想要那个案例的输出......

> ```
>  :AlreadyRunning
>  net stop NameOfSercive
>  if errorlevel 1 goto Error
> 
>  :Error
>  Echo ERROR!!1!
>  Pause 
> ```

我的 2 美分，希望这会有所帮助

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-29T13:12:07.683

好吧，我不确定您是否可以通过电子邮件发送批处理文件中的结果。如果我可以提出可以解决您的问题 vbscript 的替代建议。我对 vbscript 还不够好，但您可以使用它来查询在本地机器上运行的服务。下面的脚本将通过电子邮件向您发送运行该脚本的机器上运行的所有服务的状态。您显然想要替换 smtp 服务器和电子邮件地址。如果您是域的一部分并且以特权用户身份运行此脚本（他们必须是远程计算机上的管理员），您也可以通过将 localhost 替换为 fqdn 来查询远程计算机。

```
Dim objComputer, objMessage
Dim strEmail

' If there is an error getting the status of a service it will attempt to move on to the next one
On Error Resume Next

' Email Setup
Set objMessage = CreateObject("CDO.Message")
objMessage.Subject = "Service Status Report"
objMessage.From = "service_report@noreply.net"
objMessage.To = "youraddress@example.net"
objMessage.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2

'Name or IP of Remote SMTP Server
objMessage.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "smtp.example.net"

'Server port (typically 25)
objMessage.Configuration.Fields.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25

Set objComputer = GetObject("WinNT://localhost")
objComputer.Filter = Array("Service")

For Each aService In objComputer
strEmail = strEmail &chr(10) & aService.Name & "=" & aService.Status
Next

objMessage.TextBody = strEmail
objMessage.Configuration.Fields.Update
objMessage.Send 
```

希望这对你有帮助！享受！

编辑：还有一件事，服务状态为 4 表示服务正在运行，服务状态为 1 表示没有。我不确定 2 或 3 是什么意思，但我敢打赌他们正在停止/开始。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T12:43:52.790

根据这个[http://www.computerhope.com/nethlp.htm](http://www.computerhope.com/nethlp.htm)它应该是 NET START /LIST 但我不能让它通过 XP 框工作。我确信有一些 WMI 会给你这个列表。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-02-08T12:52:37.427

Ros 我发布的代码也是为了知道有多少服务正在运行......

想象一下，您想知道有多少服务类似于 Oracle*，然后您使用 Oracle 而不是 NameOfSercive...，然后您会获得在变量 %CountLines% 上运行的 Oracle* 等服务的数量，如果您想做某事，如果只有4 你可以这样做：

IF 4==%CountLines% GOTO FourServicesAreRunning

那更强大...并且您的代码不会让您知道所需的服务是否正在运行...如果有另一个以相同名称开头的服务...想象一下：-ServiceOne -ServiceOnePersonal

如果您搜索 ServiceOne，但它只运行 ServiceOnePersonal，您的代码将告诉 ServiceOne 正在运行...

我的代码可以轻松更改，因为它读取文件的所有行并逐行读取它还可以对每个服务执行任何您想要的操作......请参阅：

```
@ECHO OFF
REM Put here any code to be run before check for Services

SET TemporalFile=TemporalFile.TXT
NET START > %TemporalFile%
SET CountLines=0
FOR /F "delims=" %%X IN (%TemporalFile%) DO SET /A CountLines=1+CountLines
SETLOCAL EnableDelayedExpansion
SET CountLine=0
FOR /F "delims=" %%X IN (%TemporalFile%) DO @(
 SET /A CountLine=1+CountLine

 REM Do whatever you want to each line here, remember first and last are special not service names

 IF 1==!CountLine! (

   REM Do whatever you want with special first line, not a service.

 ) ELSE IF %CountLines%==!CountLine! (

   REM Do whatever you want with special last line, not a service.

 ) ELSE (

   REM Do whatever you want with rest lines, for each service.
   REM    For example echo its position number and name:

   echo !CountLine! - %%X

   REM    Or filter by exact name (do not forget to not remove the three spaces at begining):
   IF "   NameOfService"=="%%X" (

     REM Do whatever you want with Service filtered.

   )
 )

 REM Do whatever more you want to all lines here, remember two first are special as last one

)

DEL -P %TemporalFile% 2>nul
SET TemporalFile=

REM Put here any code to be run after check for Services 
```

当然它只列出正在运行的服务，我不知道网络可以列出未运行的服务...

希望这可以帮助！！！

# java - 从 Java 中读取 COBOL 数据结构

> ID：802122
> 
> 赞同：23
> 
> 时间：2009-04-29T12:28:03.747
> 
> 标签：java, data-structures, cobol, copybook

有没有办法在 Java 程序中读取 COBOL 数据？更具体地说，我遇到了以下情况：

我有一个包含固定长度数据记录的文件。数据定义是作为 COBOL 副本完成的。我想到了一个图书馆，它考虑了抄写本，并且能够阅读这些记录。

理想情况下，应该可以根据字帖信息生成基本的 Java 类和结构。在稍后的步骤中，将解析数据记录并将数据填充到这些生成的类的对象中。

是否有任何其他技术来应对读取 COBOL 数据的问题？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-04T08:59:27.200

您可以查看[JRecord](http://sourceforge.net/projects/jrecord/)或[cb2java](http://sourceforge.net/projects/cb2java/)。两者都允许您访问 COBOL 文件，但都不会生成完整的类。

* * *

2011 年 1 月更新

由于原始答案：

*   JRecord 继续被开发。现在有一个`JRecord Code generator`作为独立程序或在[Recordeditor](https://sourceforge.net/projects/record-editor/)中可用。这将从COBOL Copybook`Code Generator`构建代码。`JRecord JRecord`见[RecordEditor Jrecord CodeGen](https://stackoverflow.com/questions/46313332/how-do-you-generate-javajrecord-code-for-a-cobol-copybook) )
*   **cb2java**的开发已停止
*   [cobol2j](https://sourceforge.net/projects/cobol2j)已经写好了。一年没有更新了。
*   还有[Legstar](http://www.legsem.com/legstar/)又几年没发表了

### 2017 年 8 月更新

RecordEditor有一个 Generate 选项，用于从 COBOL Copybook 生成[Java](https://sourceforge.net/projects/record-editor/) / **JRecord代码。**有关详细信息，请参阅[RecordEditor 代码生成说明](http://record-editor.sourceforge.net/RecordEditorGenerate.htm)。

### 2018 年 1 月更新

在这个问题/答案中有一些关于生成*Java~JRecord代码的信息：*

*[你如何为 Cobol 字帖生成 java~jrecord 代码](https://stackoverflow.com/questions/46313332/how-do-you-generate-javajrecord-code-fror-a-cobol-copybook)*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T12:37:09.013

是的。我以前做过。我使用 ODBC 连接到 COBOL 文件，然后使用 jdbc:odbc 桥接，我使用元数据信息生成类、读取数据并将其全部移植到 Oracle。

[这](http://www.java2s.com/Code/Java/Database-SQL-JDBC/Metadata-DB-Info.htm)是一个关于如何使用 JDBC 访问元数据信息的不错的教程。[这](http://www.tutorialized.com/tutorial/Database-Metadata-with-JDBC/13753)是另一个。

请记住，您不需要 JDBC:ODBC 桥接方法。如果你能得到一个原生的 JDBC 驱动来连接你的 Cobol 数据源，那就更好了。在这方面，我也使用了 IBM 原生驱动程序。不过不记得名字了。那是很久以前。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T12:39:31.787

对此似乎有一些[商业解决方案](https://ssl.kundenserver.de/shop.softproject.de/en/products/COBOL-Copybook-Toolkit/)。或者，您可以使用[cb2xml](http://cb2xml.sourceforge.net/)将字帖转换为 XML，然后使用您需要的任何机制将 XML 导入 Java。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-18T13:50:44.733

我在我的项目中使用了 Bruce 的 JRecord（来自 sourceforge）包。只花了几天时间就学会了使用它，并且节省了我几个月的工作量，我自己推出了一个不太通用的解决方案。我强烈推荐它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T20:01:35.560

[Microfocus](http://supportline.microfocus.com/documentation/books/nx40/dicofj.htm)提供了一种从 Java 调用 OO COBOL 的方法。

“您可以在 OO COBOL 中编写可以从 Java 程序调用的类，就好像它们是 Java 类一样。您可以通过提供 Java 包装类来做到这一点，该类为 OO COBOL 类中的每个方法提供一个函数。Net Express 类和通过在生成 COBOL 代码的同时生成 Java 代码，方法向导为您简化了这一过程。”

他们还提供了一个名为 Enterprise Server 的工具，它允许 COBOL 与 Web 服务进行交互。

如果您有一个 COBOL 程序 A，该工具允许您将 A 的接口部分公开为 Web 服务。

当然，因为 A 现在有了 Web 服务，任何其他类型的程序（命令行、Windows 应用程序、Java、ASP 等）现在也可以调用它，从而将 COBOL 数据传递给 Java 程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T15:32:19.043

BEA 曾经有一个名为 JAM 的产品，用于与大型机 COBOL 程序进行通信。它包括一个工具，可以读取字帖并生成相应的 Java POD 类和数据转换代码。

我不知道这是否仍然可用，当我离开 BEA 时我失去了它的踪迹。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-06T11:42:52.423

看看[Javolution 结构](http://javolution.org/apidocs/javolution/io/Struct.html)。

然后，您可以使用宏将您的 COBOL 数据转换为`Struct`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-10T18:27:14.297

Rational Application Developer 可以阅读 COBOL 源代码并生成 Java 类。生成的类具有访问 COBOL 数据结构各个部分的方法。生成的类与[J2EE 连接器体系结构](http://java.sun.com/j2ee/connector/)兼容。要在您的项目中创建一个类，请选择 File、New、Other，然后选择 J2C 下的 CICS/IMS Java Data Binding 向导。点击下一步。选择 COBOL 到 Java 进行映射。选择您的 COBOL 文件。选择您希望为其生成 Java 类的结构，然后单击 Finish 就可以了。当然，您可以选择许多我没有提到的选项。有关更多信息，请搜索 J2C 的帮助。

# asp.net-mvc - WCF 排序和过滤

> ID：802131
> 
> 赞同：0
> 
> 时间：2009-04-29T12:30:52.587
> 
> 标签：asp.net-mvc, wcf

我正在对 wcf 和 mvc 进行概念验证。我有一些问题：

是否已经有用于处理 WCF 中的排序/过滤的内置解决方案？还是我必须做这样的事情，可选的排序类：

 `````
[OperationContract]
Invoice GetInvoices(SortingClass criteria); 
````  `WCF 中是否有用于延迟加载的内置解决方案，或者使用延迟加载模式？

我想在服务器端进行所有排序/过滤，以获得更多的控制和单元测试友好的环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:36:52.167

排序和过滤与 WCF 无关。WCF 是关于进程之间的通信。从 WCF 的角度来看，您交流的内容并不有趣。

所以你必须自己实现排序和过滤（在大多数情况下）。提供一个指定排序标准的参数并没有错。

至于延迟加载，我想你会想做这样的事情吗？

*   `a`从 Web 服务获取对象并加载所有原始属性
*   在客户电话上`a.ListOfObjects`
*   `ListOfObjects`例如`a`从 Web 服务自动加载

这也是你必须自己做的事情。您可以为此查看 ADO.NET 数据服务。没有延迟加载，但有类似的模式。

# user-interface - 哪个是黑莓应用程序开发的更好工具？

> ID：802133
> 
> 赞同：6
> 
> 时间：2009-04-29T12:32:35.127
> 
> 标签：user-interface, blackberry, java-me

哪个 gui 开发选项为 Blackberry 应用程序提供了优化和更快的 gui？BB 工具、J2ME 工具或任何其他 UI 工具包，如 LWUIT ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T13:52:43.420

毫无疑问，BlackBerry UI 类。您可以访问所有 BlackBerry 特定的 UI 内容 - BB 键码、特殊键、事件、更好地控制应用程序的菜单、Storm 的触摸屏内容、与 BlackBerry 上的所有组件（浏览器、地图、主屏幕图标）的集成. 更好的应用程序生命周期支持，包括在后台运行。

如果您对移植到另一个 J2ME 平台非常感兴趣，您可能会想使用 J2ME 类或 LWUIT，但相信我，您以后会为此而努力的。如果可移植性是一个问题，最好将应用程序中更多独立于平台的部分（业务逻辑、网络）分离到单独的包中并构建两个 UI。此外，如果你和其他人一样，无论如何你都希望在任何其他 J2ME 平台之前移植到 iPhone :)

编辑：记得我不久前还写了[一篇](http://www.thinkingblackberry.com/archives/140)关于这个的博客文章——很多相同的信息，但更多的细节可能会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-11T01:59:04.867

我目前正在处理这个问题，我有一个针对 J2ME 的应用程序，使用 LWUIT 并将 LWUIT 移植到黑莓，性能并不令人鼓舞，我认为分离业务逻辑是要走的路。现在研究 RIM UI。

# python - 更改 urllib2.urlopen 上的用户代理

> ID：802134
> 
> 赞同：101
> 
> 时间：2009-04-29T12:32:36.437
> 
> 标签：python, urllib2, user-agent

我如何下载带有除 urllib2.urlopen 上的默认用户代理以外的用户代理的网页？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-04-29T12:56:46.987

几周前我[回答](https://stackoverflow.com/a/762007/3790126)了一个[类似的问题。](https://stackoverflow.com/questions/761978/send-headers-along-in-python)

该问题中有示例代码，但基本上您可以执行以下操作：（请注意`User-Agent`as of [RFC 2616](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)的大写，第 14.43 节。）

```
opener = urllib2.build_opener()
opener.addheaders = [('User-Agent', 'Mozilla/5.0')]
response = opener.open('http://www.stackoverflow.com') 
```

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2011-03-04T15:58:58.463

```
headers = { 'User-Agent' : 'Mozilla/5.0' }
req = urllib2.Request('www.example.com', None, headers)
html = urllib2.urlopen(req).read() 
```

或者，更短一点：

```
req = urllib2.Request('www.example.com', headers={ 'User-Agent': 'Mozilla/5.0' })
html = urllib2.urlopen(req).read() 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-04-29T12:34:30.393

从每个人最喜欢的[Dive Into Python中](https://diveinto.org/python3/table-of-contents.html)[设置 User-Agent](http://www.diveintopython.net/http_web_services/user_agent.html)。

简短的故事：您可以使用[Request.add_header](http://docs.python.org/library/urllib2.html#urllib2.Request.add_header)来做到这一点。

您还可以在创建请求本身时将标头作为字典传递，[如文档注释](http://docs.python.org/library/urllib2.html#urllib2.Request)：

> *headers*应该是一个字典，并且将被视为`add_header()`使用每个键和值作为参数调用。这通常用于“欺骗”`User-Agent`标头，浏览器使用该标头来标识自己——一些 HTTP 服务器只允许来自普通浏览器的请求，而不是脚本。例如，Mozilla Firefox 可能将自己标识为`"Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11"`，而`urllib2`的默认用户代理字符串是`"Python-urllib/2.6"`（在 Python 2.6 上）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-05-06T07:19:05.313

对于 python 3，urllib 分为 3 个模块...

```
import urllib.request
req = urllib.request.Request(url="http://localhost/", headers={'User-Agent':' Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0'})
handler = urllib.request.urlopen(req) 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-01-24T21:32:26.163

所有这些在理论上都应该有效，但是（至少在 Windows 上使用 Python 2.7.2）任何时候发送自定义的 User-agent 标头，urllib2 都不会发送该标头。如果您不尝试发送 User-agent 标头，它会发送默认的 Python / urllib2

这些方法似乎都不适用于添加用户代理，但它们适用于其他标头：

```
opener = urllib2.build_opener(proxy)
opener.addheaders = {'User-agent':'Custom user agent'}
urllib2.install_opener(opener)

request = urllib2.Request(url, headers={'User-agent':'Custom user agent'})

request.headers['User-agent'] = 'Custom user agent'

request.add_header('User-agent', 'Custom user agent') 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-03-20T08:01:49.040

因为`urllib`你可以使用：

```
from urllib import FancyURLopener

class MyOpener(FancyURLopener, object):
    version = 'Mozilla/5.0 (Windows; U; Windows NT 5.1; it; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11'

myopener = MyOpener()
myopener.retrieve('https://www.google.com/search?q=test', 'useragent.html') 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-01-14T18:54:25.390

`urllib2`Python 2.7中的另一个解决方案：

```
req = urllib2.Request('http://www.example.com/')
req.add_unredirected_header('User-Agent', 'Custom User-Agent')
urllib2.urlopen(req) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-08-07T05:19:00.613

有两个属性，`urllib.URLopener()`即：
`addheaders = [('User-Agent', 'Python-urllib/1.17'), ('Accept', '*/*')]`和
`version = 'Python-urllib/1.17'`。
要欺骗网站，您需要将这两个值都更改为可接受的用户代理。例如
Chrome 浏览器：`'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.149 Safari/537.36'`
Google bot：`'Googlebot/2.1'`
像这样

```
import urllib
page_extractor=urllib.URLopener()  
page_extractor.addheaders = [('User-Agent', 'Googlebot/2.1'), ('Accept', '*/*')]  
page_extractor.version = 'Googlebot/2.1'
page_extractor.retrieve(<url>, <file_path>) 
```

仅更改一项属性不起作用，因为该网站将其标记为可疑请求。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-07-29T07:30:42.040

试试这个 ：

```
html_source_code = requests.get("http://www.example.com/",
                   headers={'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.107 Safari/537.36',
                            'Upgrade-Insecure-Requests': '1',
                            'x-runtime': '148ms'}, 
                   allow_redirects=True).content 
```

# linq - linq子列表问题

> ID：802135
> 
> 赞同：2
> 
> 时间：2009-04-29T12:32:45.077
> 
> 标签：linq

我对 Linq 很陌生，我无法将以下内容转换为 linq 表达式：

```
 Dim returnedInstructions As List(Of Integer) = New List(Of Integer)
        For Each j As Job In response.Jobs
            For Each i As Instruction In j.Instructions
                returnedInstructions.Add(i.InstructionId)
            Next
        Next 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:39:33.407

我对 VB 不太熟悉，如果这与 C# 语法有些混淆，我深表歉意。

```
returnedInstructions  = 
(from j in response.Jobs _
from i in j.Instructions _
select i.InstructionId).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T12:39:53.500

像这样的东西应该工作：

```
 Dim returnedInstructions As New List(Of Integer)
    Dim q = From j In response.Jobs, i In j.Instructions Select i.InstructionID
    returnedInstructions.AddRange(q) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T12:40:25.933

你想要[SelectMany](http://msdn.microsoft.com/en-us/library/bb534336.aspx)。

```
List<int> returnedInstructions = response.Jobs
  .SelectMany(j => j.Instructions
    .Select(i => i.InstructionID))
  .ToList(); 
```

（现在在VB中，我不知道这是否编译）

```
Dim returnedInstructions = response.Jobs _
  .SelectMany( Function(j) j.Instructions _
    .Select( Function(i) i.InstructionID) ) _
  .ToList() 
```

# c++ - 您应该如何使用 shared_ptr 返回 *this？

> ID：802138
> 
> 赞同：6
> 
> 时间：2009-04-29T12:33:19.820
> 
> 标签：c++, shared-ptr

另见：[类似问题](https://stackoverflow.com/questions/382166/smart-pointers-this-considered-harmful)

下面的代码显然很危险。问题是：您如何跟踪对 *this 的引用？

```
using namespace boost;

// MyClass Definition
class MyClass {

public:
   shared_ptr< OtherClass > createOtherClass() {
      return shared_ptr< OtherClass > OtherClass( this ); // baaad
   }
   MyClass();
   ~MyClass();
};

// OtherClass Definition
class OtherClass {

public:
   OtherClass( const *MyClass myClass );
   ~OtherClass();
};

// Call; pMyClass refcount = 1
shared_ptr< MyClass > pMyClass( new MyClass() );

// Call; pMyClass refcount = 1 => dangerous
pMyClass->createOtherClass(); 
```

我有答案（发布在下面），我只是希望它出现在 stackoverflow 上（如果我错了，每个人都可以纠正我。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T12:33:58.990

关键是扩展`enable_shared_from_this<T>`和使用`shared_from_this()`方法来获取一个shared_ptr到`*this`

[详细信息](http://www.ddj.com/cpp/184402026)

```
using namespace boost;    

// MyClass Definition
class MyClass : public enable_shared_from_this< MyClass > {

public:
   shared_ptr< OtherClass> createOtherClass() {
      return shared_ptr< OtherClass > OtherClass( shared_from_this() );
   }
   MyClass();
   ~MyClass();
};

// OtherClass Definition
class OtherClass {

public:
   OtherClass( shared_ptr< const MyClass > myClass );
   ~OtherClass();
};

// Call; pMyClass refcount = 1
shared_ptr< MyClass > pMyClass( new MyClass() );

// Call; pMyClass refcount = 2
pMyClass->createOtherClass(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:56:22.857

几个问题：
您的代码无法编译！

您的代码并非以阻止滥用/不正确使用的方式设计：

```
MyClass            x;
SharedPtr<MyClass> y = x.createOtherClass(); 
```

怎么办？
这似乎是一个非常好的用例！

# excel - 为单元格分配变量而不删除其原始内容

> ID：802139
> 
> 赞同：0
> 
> 时间：2009-04-29T12:33:24.687
> 
> 标签：excel, vba

我在 excel 中设置了一些 VBA 来比较两个日期，看看它们是否相同。我遇到的问题是，在将单元格的变量分配给“ActualStartDate”之后，它会从单元格中删除所有内容。因此“ActualStartDate”被正确分配，但同时被删除。

这是我的代码，任何帮助都会很棒。（这个activecell的东西是因为它都是相对引用）

```
Dim ActualStartDate, ProjectedStartDate
ActiveCell.Offset(-1, -1).Range("A1").Select
ActiveCell.FormulaR1C1 = ActualStartDate
ActiveCell.Offset(1, 0).Range("A1").Select
ActiveCell.FormulaR1C1 = ProjectedStartDate
If ActualStartDate = ProjectedStartDate Then
    ActiveCell.Offset(-1, -1).Range("A1").Interior.Color = RGB(0, 0, 255)
End If 
```

当它运行时，它会识别出我的测试日期是相同的并为单元格着色。它只是删除包含“ActualStartDate”的单元格的内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T12:44:10.853

所有这一切都是向上移动一个单元格，向左移动一个单元格，然后将该单元格的值替换为空。

```
Dim ActualStartDate
ActiveCell.Offset(-1, -1).Range("A1").Select
ActiveCell.FormulaR1C1 = ActualStartDate 
```

您创建 ActualStartDate 变量，但从不为其分配任何内容。因此，当您将 ActualStartDate 变量值应用于单元格时，它会“删除”现有日期。

您可能想做更多类似的事情，但我不确定偏移量，因为我不知道您是如何设计电子表格的。

```
Sub Button1_Click()
    Dim ActualStartDate, ProjectedStartDate
    ActiveCell.Offset(-1, -1).Select
    ActualStartDate = ActiveCell.FormulaR1C1
    ActiveCell.Offset(1, 0).Select
    ProjectedStartDate = ActiveCell.FormulaR1C1
    If ActualStartDate = ProjectedStartDate Then
        ActiveCell.Offset(-1, -1).Interior.Color = RGB(0, 0, 255)
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:20:59.263

在更改其值之前选择单元格是不必要的，并且`FormulaR1C1`是多余的，因为您没有在公式中输入范围。以下应该完全一样，但我认为更容易理解和调试。

> ** 与 Jim 关于偏移量的警告相同，它们看起来有点奇怪，但可能是预期的 **

 ````
 Dim ActualStartDate, ProjectedStartDate

    ActualStartDate = ActiveCell.Offset(-1, -1)
    ProjectedStartDate = ActiveCell.Offset(1, 0)

    If ActualStartDate = ProjectedStartDate Then
        ActiveCell.Offset(-1, -1).Interior.Color = RGB(0, 0, 255)
    End If
```

明确声明变量的类型`Date`也是一个好主意，因为它们在内部存储为`Variant`需要更多内存的数据类型，并且可能导致意外后果，因为 Excel 负责决定如何处理数据。

```
 Dim ActualStartDate as Date
    Dim ProjectedStartDate as Date

    ActualStartDate = ActiveCell.Offset(-1, -1)
    ProjectedStartDate = ActiveCell.Offset(1, 0)

    If ActualStartDate = ProjectedStartDate Then
        ActiveCell.Offset(-1, -1).Interior.Color = RGB(0, 0, 255)
    End If 
```

# asp.net - 如何从 ASP.NET 打印外部文件（XLS、PDF、DOCX 等）？

> ID：802144
> 
> 赞同：0
> 
> 时间：2009-04-29T12:34:10.800
> 
> 标签：asp.net, printing, file-handling

我们有一个经典 ASP 中的应用程序，它允许用户将文件“附加”到信息上。这些可以是 PDF、电子表格、Word 文档等。

在新的 ASP.NET 版本中，一个请求的选项是“全部打印”（一位用户的情况是有 34 个附加文件，在当前系统中，她必须单独打开并打印每个文件）。

这些文件保存在单独的目录中 - 未嵌入数据库中。该数据库只包含一个 ID 号和文件的扩展名，因此如果用户想要查看它，应用程序会出去并打开“2182.xls”（在这种情况下会打开一个 Excel 窗口）。

当您只有完全限定的文件名时，有没有办法将文件发送到打印机？（在上面的例子中我大概可以重复 34 次）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:15:11.090

请记住，您的 asp.net 代码在 Web 服务器上运行。它不在客户端计算机上运行，​​也不知道那里安装了哪些打印机（如果有的话！）。这就是网络的工作方式；按照设计，Web 应用程序所能做的就是打开当前页面的打印对话框。除此之外，黑客会使用我们的网络浏览器来处理您在传真机上收到的相同类型的垃圾邮件。

也就是说，您可能可以做一些事情：

*   添加 activex 控件、flash 应用程序、silverlight 应用程序、firefox 插件或其他插件代码以支持该功能。
*   将服务器上的所有附件呈现为具有适当样式和 javascript 的 html 文档，以便正确打印并在加载时提示用户。
*   如果对于本地 Intranet 站点（而不是公共 Internet），您特别了解当前用户可以使用哪些打印机，则可以在您的服务器上设置所有打印机，并代表其打印到正确的位置用户。

# c# - AutoEventWireup 在具有许多控件的页面上为 false (C#)

> ID：802145
> 
> 赞同：3
> 
> 时间：2009-04-29T12:34:12.873
> 
> 标签：c#, event-handling, autoeventwireup

使用 C#，有一个带有许多控件的 Web 表单，其中 AutoEventWireup 设置为 false。这会强制您在 ctor 中或通过覆盖 OnInit 来初始化所需的处理程序。

页面上的控件所需的处理呢？为下拉列表和列表框添加按钮 Click 和 SelectedIndexChanged，而不是多个 GridView 事件等。

如果 AutoEventWireup 设置为 true，它会影响性能，因为所有控件（包括页面）的所有事件都会在幕后连接起来，甚至是您不需要的所有事件。

将 AutoEventWireup 设置为 false 时，在 ctor/OnInit 中有十几个或两个事件订阅是否合适？（this.Load+=...this.GridView1.Sorted+=...this.Button1.Click+=...等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T12:38:30.790

`AutoEventWireup`是的，如果您设置为，您将需要自己手动连接所有事件`false`。该`OnInit`方法是连接这些事件处理程序的好地方，并且您应该在其中拥有尽可能多的事件订阅，因为您需要页面上的控件。

`AutoEventWireup`是个好主意，但速度很慢，而且有点神奇。我发现自己明确地进行接线要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:43:54.723

AutoEventWireUp 仅自动连接某些内置页面或控件级别事件，而不是页面上每个控件的每个事件。

有关列表，请参阅[Simon](https://stackoverflow.com/questions/680878/what-does-autoeventwireup-page-property-mean/680978#680978)对此[问题](https://stackoverflow.com/questions/680878/what-does-autoeventwireup-page-property-mean/)的回答。

# c - c 中的溢出

> ID：802153
> 
> 赞同：2
> 
> 时间：2009-04-29T12:36:26.973
> 
> 标签：c, overflow, integer-overflow

我有个疑问

当两个 16 位值加上最大值时，16 位机器会溢出吗？

我会详细说明

```
unsigned short a;
unsigned short b;
unsigned long  c;

c=(unsigned long)(a+b); 
```

谈到 16 位处理器，累加器将是 16 位大小。上面的语句会不会有溢出？请说清楚。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-29T12:44:13.100

使用这些定义并假设`unsigned short`== 16 位和`int`== 16 位和`unsigned long`== 32 位（请注意，大小`int`很重要）：

```
unsigned short a, b;
unsigned long  c; 
```

这两个语句将做不同的事情：

```
c = (unsigned long)(a + b);
c = (unsigned long)a + b; 
```

第一个——你展示的那个——将首先将数字添加为无符号短裤，丢弃任何溢出——*然后*扩展为无符号长。这可能就是你问的原因。第二个将`a`转换为无符号长整数，然后将两个数字相加，`b`在进行加法之前也扩展为无符号长整数。

你也可以这样做：

```
c = (unsigned long)a + (unsigned long)b; 
```

但这是不必要的，因为计算中存在一个 unsigned long 会导致另一个自动从 short 提升到 long 大小。

因此：

```
a = 0x8001;
b = 0x8001;
c = (unsigned long)(a + b);   /* c is assigned 0x00000002 */
c = (unsigned long)a + b;     /* c is assigned 0x00010002 */ 
```

所有这些都取决于您的特定编译器及其变量的大小。它具体取决于`int`编译器的大小，因为所有值都会自动提升到计算中`int`或`unsigned int`在计算期间。您提到了具有 16 位累加器的硬件，而 C 编译器通常（但并非总是）使用本机寄存器大小作为 的大小`int`，这就是我假设 a`int`为 16 位的原因。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-29T12:41:35.930

是的，会有溢出。子表达式 a + b 的类型为 short，只有在它被求值后才会将结果转换为 long。做这个：

```
c = (unsigned long)a + b; 
```

这将导致 a在加法发生*之前*被强制转换为 long ，这反过来也会导致 b 也被强制转换为 long。因此，发生了两个 long 的相加，并且不会发生溢出。

# ios - 在 iPhone 模拟器上测试 CoreLocation

> ID：802156
> 
> 赞同：29
> 
> 时间：2009-04-29T12:37:02.057
> 
> 标签：ios, iphone, cocoa-touch, core-location

**更新：**从 iOS 5 和 Xcode 4.1 开始，现在可以在模拟器中测试位置，甚至定义路线。有关详细信息，请参阅[http://developer.apple.com 。](http://developer.apple.com)

## 遗留问题

无论如何要在 iPhone 模拟器上测试 CoreLocation 吗？

我所需要的只是能够自己设置位置并让 CoreLocation 返回它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-07-21T22:24:46.797

这是我的简单技巧，它强制 CLLocationMager 仅在模拟器上返回鲍威尔科技书店的地理坐标：

```
#ifdef TARGET_IPHONE_SIMULATOR 

@interface CLLocationManager (Simulator)
@end

@implementation CLLocationManager (Simulator)

-(void)startUpdatingLocation {
    CLLocation *powellsTech = [[[CLLocation alloc] initWithLatitude:45.523450 longitude:-122.678897] autorelease];
    [self.delegate locationManager:self
               didUpdateToLocation:powellsTech
                      fromLocation:powellsTech];    
}

@end

#endif // TARGET_IPHONE_SIMULATOR 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-01T17:39:22.017

感谢您的反馈，它促使我找到了一个强大的解决方案。

所有代码都可以在这里找到：

[http://code.google.com/p/dlocation/](http://code.google.com/p/dlocation/)

它***非常***凌乱，但是当我使用它时，它会变得更好。

解决方案是子类化`CLLocationManager`并定义一个新的委托`@protocol`，称为`DLocationManagerDelegate`.

它被设计为一个简单的替代品，当部署在实际设备上时，`CLLocationManagerDelegate`它可以编译成一个*非常薄的层。*

在设备上运行时，它将使用 正常返回数据`CoreLocation`，但在模拟器中，它将从文本文件（在 DLocationManager.h 文件中定义）读取纬度和经度。

我希望这会有所帮助，实现很简单，您必须`startUpdatingLocation`更新`stopUpdatingLocation`显示。

评论和反馈将不胜感激。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-29T17:41:22.263

在模拟器上运行时，使用过滤功能交换测试实例。无论您以前在哪里收到位置（代表呼叫等），都可以通过以下方式传递：

```
+ (CLLocation *) wakkawakka: (CLLocation*) loc {
#ifdef TARGET_IPHONE_SIMULATOR
    /* replace with a test instance */
    return [[CLLocation alloc] initWithLatitude:10.0 longitude:20.0];
#else
    return loc;
#endif
} 
```

除了内存管理问题...

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-01-13T21:12:50.847

我认为这里有另一种（更好的恕我直言）方法，而不是像在

[http://code.google.com/p/dlocation/](http://code.google.com/p/dlocation/)

在 ObjectiveC 中，似乎可以在不覆盖类的情况下**替换**现有方法。这通常被称为“方法调配”：您为现有类定义自己的类别并在其中实现现有方法。

从客户的角度来看，一切都是透明**的：他觉得他在处理真实的事情`CLLocationManager`，但实际上，你“从中获得了控制权”**。这样他就不需要处理任何特殊的子类或任何特殊的委托协议：他继续使用与 CoreLocation 相同的类/协议。

这是一个控制客户端将注入的委托的示例：

```
 @implementation CLLocationManager (simulator) `-(void) setDelegate:(id)delegate {
    //your own implementation of the setDelegate...
}
-(id)delegate  {
    //your own implementation of the delegate....
}
-(void)startUpdatingLocation {
}
-(void)stopUpdatingLocation {
}
//....
//same for the rest of any method available in the standard CLLocationManager
@end` 

```

然后在这个实现中，您可以自由地处理一组预定义的坐标（来自任何文件），这些坐标将使用标准`CLLocationManagerDelegate`协议“推送”到委托。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T15:04:08.397

如果您需要设置模拟器提供给您的位置以外的位置，请从测试类触发核心位置回调。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-11T18:43:07.730

在iphone 模拟器中永远不会调用*locationManager:didUpdateToLocation*和*locationManager:didFailedWithError*重载回调，这有点奇怪，我得到的只是 0.0000 经纬度和 0.0000 经度。作为位置。在您开发某些东西的情况下，仅使用模拟器环境很难实现位置处理期间可能发生的所有可能情况。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-27T08:36:45.080

如果您有兴趣使用模拟位置更新更新 MKMapView 中的蓝色 userLocation 点，请查看我的 FTLocationSimulator，网址为[http://github.com/futuretap/FTLocationSimulator](http://github.com/futuretap/FTLocationSimulator)

它读取由 Google Earth 生成的 KML 文件以提供持续的位置更新。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-30T10:36:48.770

**在 iPhone 模拟器上测试 CoreLocation**

1) 要在模拟器中测试位置，最好的方法是使用 GPX 文件，只需转到**文件 -> 新建 -> 资源 -> GPX 文件。**

2) 添加 GPX 文件后，根据需要更新位置坐标。

3）将GPX文件添加到项目后，选择**Scheme -> Edit Scheme -> Run -> Allow Location Simulation**。勾选位置模拟并选择您刚刚创建的GPX文件的名称。

这种方式模拟器将始终选择您想要的坐标，我们已添加到我们的 GPX 文件中。

[![创建 GPX 文件](https://i.stack.imgur.com/1dOQd.png)](https://i.stack.imgur.com/1dOQd.png)

# asp.net-mvc - ASP.NET MVC 中的 Ajax 表单

> ID：802158
> 
> 赞同：0
> 
> 时间：2009-04-29T12:37:09.420
> 
> 标签：asp.net-mvc, asp.net-ajax

我有一个使用 ASP.NET MVC 收集数据的表单。它看起来像这样：

```
 [AcceptVerbs(HttpVerbs.Post)]  
[AutoValidate]  
public ActionResult Contact(ContactMessage msg)  
{  
    if(ModelState.IsValid)  
    {  
        try  
        {  
            this.messengerService.SendMail(msg);  
            RedirectToAction("Index");  
        }
        catch (Exception ex)
        {
            ModelState.AddUnhandledError(ex);
        }
    }

    return View(msg);
} 

```

我正在使用 asp.net mvc 验证和模型状态验证来处理显示的无效规则消息。一切正常。

现在我想使用 ajax 表单提交操作，并在操作成功完成时显示成功消息。我尝试使用下面的代码，它在操作成功时工作，但是当它失败时（模型有错误），整个页面在显示成功消息的 DIV 中再次呈现！这可能吗？

```
 [AcceptVerbs(HttpVerbs.Post)]
[AutoValidate]
public ActionResult Contact(ContactMessage msg)
{
    if(ModelState.IsValid)
    {
        try
        {
            this.messengerService.SendMail(msg);
            return Content("Message sent");
        }
        catch (Exception ex)
        {
            ModelState.AddUnhandledError(ex);
        }
    }

    return View(msg);
} 

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:42:58.783

您的问题是返回正常视图的最后一行。

尝试这个：

```
[AcceptVerbs(HttpVerbs.Post)]
[AutoValidate]
public JsonResult Contact(ContactMessage msg)
{
    if(ModelState.IsValid)
    {
        try
        {
            this.messengerService.SendMail(msg);
            return Json("Message sent");
        }
        catch (Exception ex)
        {
            ModelState.AddUnhandledError(ex);
        }
    }

    return Json("There were model errors");
} 
```

# c# - LINQ to Entity：在“选择”部分中使用包含会引发意外错误

> ID：802159
> 
> 赞同：1
> 
> 时间：2009-04-29T12:37:11.963
> 
> 标签：c#, entity-framework, linq-to-entities

我有一个针对实体框架对象的 LINQ 查询。以下是查询的摘要：

```
//a list of my allies
List<int> allianceMembers = new List<int>() { 1,5,10 };

//query for fleets in my area, including any allies (and mark them as such)
var fleets = from af in FleetSource
             select new Fleet 
             {
                 fleetID = af.fleetID,
                 fleetName = af.fleetName,
                 isAllied = (allianceMembers.Contains(af.userID) ? true : false)
             }; 
```

基本上，我正在做的是获得一组舰队。AllianceMembers 列表包含与我结盟的所有用户的 INT。如果舰队的所有者是该列表的一部分，我想设置 isAllied = true ，否则设置为 false 。

当我这样做时，我看到一个异常：“LINQ to Entities 无法识别方法 'Boolean Contains(Int32)' 方法”

如果我在查询的 where 部分中使用了 contains，我可以理解得到这个错误，但为什么我会在 select 中得到它？至此，我假设查询已经执行并返回了结果。这段小代码完全没有限制我的数据。

关于我如何通过设置 isAllied 标志来完成我需要的任何提示？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T12:40:49.490

这是从以前的答案中挖出来的......

不支持包含。

IN 和 JOIN 不是同一个运算符（按 IN 过滤永远不会改变查询的基数）。

不要那样做，而是使用 join 方法。不使用查询运算符有点难以理解，但是一旦你得到它，你就明白了。

```
var foo = 
model.entitySet.Join(  //Start the join
values, //Join to the list of strings
e => e.Name, // on entity.Name
value => value, //equal to the string
(ModelItem ent, String str) => ent);//select the entity 
```

这里使用查询运算符

```
var foo = from e in model.entitySet
join val in values on
e.Name equals val
select e; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:47:16.010

基本上，实体框架尝试将您的 LINQ 查询转换为 SQL 语句，但不知道如何处理`Contains`.

您可以做的是从数据库中检索您的舰队并稍后设置 isAllied 属性：

```
var fleets = (from af in FleetSource
              select new Fleet 
              {
                  fleetID = af.fleetID,
                  fleetName = af.fleetName,
                  userId = af.userId
              }).AsEnumerable();

foreach (var fleet in fleets)
{
    fleet.isAllied = (allianceMembers.Contains(fleet.userID) ? true : false);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T14:01:10.157

我上面的人都错了！！！（无意冒犯...）它不起作用，因为您使用的是“包含”的 IList 重载，而不是“包含”的 IEnumerable 重载。只需更改为：

```
allianceMembers.Contains<int>(af.userID) 
```

通过添加`<int>`，您告诉编译器使用 IEnumerable 重载而不是 IList 重载。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-29T13:30:30.760

```
var fleets = from af in FleetSource;

var x = from u in fleets.ToList()
                         select new Fleet
                         {
                            fleetID = u.fleetID,
                            fleetName = u.fleetName,
                            isAllied = (allianceMembers.Contains(u.userID) ? true : false)
                         } 
```

调用`ToList()`舰队查询被执行，稍后你可以使用`Contains()`.

# wpf - 为什么这个 View 没有正确绑定到这个 ViewModel？

> ID：802162
> 
> 赞同：1
> 
> 时间：2009-04-29T12:38:35.640
> 
> 标签：wpf, xaml, data-binding, mvvm, viewmodel

我正在尝试将我的视图绑定到没有 DataObjectProvider 的视图模型。

下面的**代码运行没有错误**，但我的 ListBox 是**空**的。

据我所知，我是正确的：

*   将 View 的 DataContext 设置为 ViewModel 本身 ( `DataContext = new CustomersViewModel();`)
*   在 ViewModel ( `public static ObservableCollection<Customer> GetAll()`)中公开客户对象
*   将 ListBox 绑定到客户对象 ( `ItemsSource="{Binding GetAll}"`)

**我在这里缺少什么小语法？**

**客户视图.xaml：**

```
<UserControl x:Class="TestDynamicForm123.View.CustomersView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <Style x:Key="allCustomersListBox" TargetType="ListBox">
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <DataTemplate x:Key="allCustomersDataTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding FirstName}"/>
                <TextBlock Text=" "/>
                <TextBlock Text="{Binding LastName}"/>
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <StackPanel Style="{StaticResource viewWrappingStackPanel}">
        <ListBox ItemsSource="{Binding GetAll}"
                 ItemTemplate="{StaticResource allCustomersDataTemplate}"
                 Style="{StaticResource allCustomersListBox}">
        </ListBox>
    </StackPanel>
</UserControl> 
```

**客户视图.xaml.cs：**

```
using System.Windows.Controls;
using TestDynamicForm123.ViewModel;

namespace TestDynamicForm123.View
{
    public partial class CustomersView : UserControl
    {
        public CustomersView()
        {
            InitializeComponent();

            DataContext = new CustomersViewModel();
        }
    }
} 
```

**客户视图模型.cs：**

```
using System.Collections.ObjectModel;

namespace TestDynamicForm123.ViewModel
{
    public class CustomersViewModel
    {
        public static ObservableCollection<Customer> GetAll()
        {
            return Customer.GetAll();
        }
    }
} 
```

**Customer.cs：（**模型）

```
using System.Collections.ObjectModel;

namespace TestDynamicForm123.ViewModel
{
    public class Customer
    {
        public int Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int Age { get; set; }

        public static ObservableCollection<Customer> GetAll()
        {
            ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
            customers.Add(new Customer() { FirstName = "Jay", LastName = "Anders", Age = 34 });
            customers.Add(new Customer() { FirstName = "Jim", LastName = "Smith", Age = 23 });
            customers.Add(new Customer() { FirstName = "John", LastName = "Jones", Age = 22 });
            customers.Add(new Customer() { FirstName = "Sue", LastName = "Anders", Age = 21 });
            customers.Add(new Customer() { FirstName = "Chet", LastName = "Rogers", Age = 35 });
            customers.Add(new Customer() { FirstName = "James", LastName = "Anders", Age = 37 });
            return customers;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:48:05.727

问题是这`CustomersViewModel .GetAll()`是一个静态方法。绑定仅适用于实例属性。您应该将实现`GetAll()`移至构造函数，然后将集合作为类的实例属性公开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T12:48:09.317

问题是您试图绑定到 CustomerViewModel.GetAll()，而 CustomerViewModel 中的 GetAll 是静态函数而不是实例属性。

将静态函数更改为如下所示（在 CustomerViewModel 中）：

```
public ObservableCollection<Customer> GetAll
{
    get { return Customer.GetAll(); }
} 
```

# c++ - 如何使用 WMI 添加 IP 路由？

> ID：802170
> 
> 赞同：0
> 
> 时间：2009-04-29T12:39:38.680
> 
> 标签：c++, networking, wmi

我需要在 windows xp 上的 IP4 路由表中添加一个路由。

但是，Win32_IP4RouteTable 类似乎只能查询现有路由。

基本上我需要与以下相同的功能：

```
route ADD 192.168.127.254 MASK 255.255.255.255 192.168.1.10 
```

是否可以使用 WMI 将条目添加到 IP4 路由表中？

我可以改用 CreateProcess 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:46:35.967

您只需要 WMI 上的解决方案吗？我通常使用[IPHelper](http://msdn.microsoft.com/en-us/library/aa366073(VS.85).aspx)。具体来说，您需要[CreateIpForwardEntry 函数](http://msdn.microsoft.com/en-us/library/aa365860(VS.85).aspx)。

# jsf - 关于 Icefaces 和 valueChangeListener 的问题

> ID：802172
> 
> 赞同：0
> 
> 时间：2009-04-29T12:39:58.900
> 
> 标签：jsf, icefaces

我使用了 icefaces 1.7.1，并且我使用了 ice:inputText 和 valueChangeListener，如下所示：

```
<ice:inputText value="#{myBean.name}" valueChangeListener="#{myBean.nameChangedListener}"/> 
```

在 MyBean.java 我有：

```
public void nameChangedListener(ValueChangeEvent event){
   // test the new value : if it's ok continue but if it is not ok i need it to keep the old value.
   // I know that the valueChangeListener invoked before the old value is replaced by the newValue, is it ok?, and if ok : what to do to keep the oldValue if the newValue is worng
} 
```

再次感谢任何帮助.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:49:42.147

值更改侦听器不能用于更改正在更改的值（仅供参考：它们在验证阶段被调用）。看看[转换器](http://java.sun.com/javaee/5/docs/tutorial/doc/bnaqd.html#bnaqi)和[验证器](http://java.sun.com/javaee/5/docs/tutorial/doc/bnaqd.html#bnaqk)——它们可以防止垃圾数据进入你的模型。

```
 /** validator="#{myBean.checkThreeCharsLong}" */
  public void checkThreeCharsLong(FacesContext context,
      UIComponent component, Object value) {
    boolean failedValidation = (value == null)
        || (value.toString().trim().length() < 3);
    if (failedValidation) {
      ((EditableValueHolder) component).setValid(false);
      // message to user
      String clientId = component.getClientId(context);
      FacesMessage message = new FacesMessage(
          "value should be at least three characters long");
      context.addMessage(clientId, message);
    }
  } 
```

让很多人感到困惑的一个方面是，提交的包含无效数据的表单将阻止操作触发。这是设计使然 - 它可以防止业务逻辑对错误数据进行操作。如果即使请求中有无效数据也需要触发操作，则不能使用 JSF 验证模型，并且必须将验证合并到操作逻辑中。

# max - 为多行texbox中的每一行设置maxlength

> ID：802173
> 
> 赞同：0
> 
> 时间：2009-04-29T12:40:04.093
> 
> 标签：max, rows, multiline

我想为多行文本框中的每一行设置 maxlength 为 5 个字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T12:59:35.560

如果您正在谈论 asp.net 文本框控件，则可以通过将 columns 属性设置为 5 来完成

# css - 用 CSS 截断长字符串：可行吗？

> ID：802175
> 
> 赞同：212
> 
> 时间：2009-04-29T12:40:44.560
> 
> 标签：css, text, layout, cross-browser, truncate

有没有什么好的方法可以用纯 HTML 和 CSS 截断文本，以便动态内容适合固定宽度和高度的布局？

我一直在按*逻辑*宽度（即盲目猜测的字符数）截断服务器端，但由于“w”比“i”宽，这往往不是最佳的，还需要我重新猜测（并不断调整）每个固定宽度的字符数。理想情况下，截断发生在浏览器中，它知道渲染文本的*物理*宽度。

我发现 IE 有一个`text-overflow: ellipsis`完全符合我要求的属性，但我需要它是跨浏览器的。此属性[似乎（有点？）标准](http://www.quirksmode.org/css/textoverflow.html)，但 Firefox 不支持。我找到了基于 的[各种](http://www.jide.fr/emulate-text-overflowellipsis-in-firefox-with-css) [解决方法](https://stackoverflow.com/questions/480722/how-can-i-set-a-td-width-to-visually-truncate-its-displayed-contents)`overflow: hidden`，但它们要么不显示省略号（我希望用户知道内容被截断），要么一直显示它（即使内容没有被截断）。

有没有人有一种在固定布局中拟合动态文本的好方法，或者服务器端截断逻辑宽度和我现在要得到的一样好？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2009-07-09T03:27:03.677

**更新：** [`text-overflow: ellipsis`现在支持](http://hacks.mozilla.org/2011/09/whats-new-for-web-developers-in-firefox-7/)Firefox 7（2011 年 9 月 27 日发布）。耶！我的原始答案作为历史记录如下。

Justin Maxwell 有跨浏览器 CSS 解决方案。但它确实有一个缺点，就是不允许在 Firefox 中选择文本。查看[他在 Matt Snider 博客上的客座帖子，](http://mattsnider.com/css/css-string-truncation-with-ellipsis/)了解有关其工作原理的完整详细信息。

`innerHTML`请注意，此技术还可以防止使用Firefox中的属性在 JavaScript 中更新节点的内容。请参阅本文末尾的解决方法。

**CSS**

```
.ellipsis {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    -o-text-overflow: ellipsis;
    -moz-binding: url('assets/xml/ellipsis.xml#ellipsis');
} 
```

**`ellipsis.xml`文件内容**

```
<?xml version="1.0"?>
<bindings
  xmlns="http://www.mozilla.org/xbl"
  xmlns:xbl="http://www.mozilla.org/xbl"
  xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
>
    <binding id="ellipsis">
        <content>
            <xul:window>
                <xul:description crop="end" xbl:inherits="value=xbl:text"><children/></xul:description>
            </xul:window>
        </content>
    </binding>
</bindings> 
```

**更新节点内容**

要以适用于 Firefox 的方式更新节点的内容，请使用以下命令：

```
var replaceEllipsis(node, content) {
    node.innerHTML = content;
    // use your favorite framework to detect the gecko browser
    if (YAHOO.env.ua.gecko) {
        var pnode = node.parentNode,
            newNode = node.cloneNode(true);

        pnode.replaceChild(newNode, node);
    }
}; 
```

请参阅[Matt Snider 的帖子以了解其工作原理](http://mattsnider.com/javascript/dynamically-updating-content-of-firefox-ellipsis-hack/)。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2014-04-02T12:32:20.147

**2014 年 3 月：使用 CSS 截断长字符串：关注浏览器支持的新答案**

[在http://jsbin.com/leyukama/1/](http://jsbin.com/leyukama/1/)上演示（我使用 jsbin，因为它支持旧版本的 IE）。

```
<style type="text/css">
    span {
        display: inline-block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;     /** IE6+, Firefox 7+, Opera 11+, Chrome, Safari **/
        -o-text-overflow: ellipsis;  /** Opera 9 & 10 **/
        width: 370px; /* note that this width will have to be smaller to see the effect */
    }
</style>

<span>Some very long text that should be cut off at some point coz it's a bit too long and the text overflow ellipsis feature is used</span> 
```

-ms-text-overflow CSS 属性不是必需的：它是 text-overflow CSS 属性的同义词，但 IE 6 到 11 的版本已经支持 text-overflow CSS 属性。

在 Windows 操作系统上针对 Web 浏览器成功测试（在 Browserstack.com 上）：

*   IE6 到 IE11
*   歌剧 10.6、歌剧 11.1、歌剧 15.0、歌剧 20.0
*   铬 14、铬 20、铬 25
*   野生动物园 4.0、野生动物园 5.0、野生动物园 5.1
*   火狐 7.0、火狐 15

Firefox：正如 Simon Lieschke 所指出的（在另一个答案中），Firefox 仅支持从 Firefox 7 开始的 text-overflow CSS 属性（2011 年 9 月 27 日发布）。

我在 Firefox 3.0 和 Firefox 6.0 上仔细检查了这种行为（不支持文本溢出）。

需要在 Mac OS 网络浏览器上进行一些进一步的测试。

注意：您可能希望在应用省略号时在鼠标悬停时显示工具提示，这可以通过 javascript 完成，请参阅以下问题：[HTML text-overflow ellipsis detection](https://stackoverflow.com/questions/7738117/html-text-overflow-ellipsis-detection) and [HTML - How can I show tooltip ONLY when ellipsis isactivated](https://stackoverflow.com/questions/5474871/html-how-can-i-show-tooltip-only-when-ellipsis-is-activated)

资源：

*   [https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow#Browser_compatibility](https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow#Browser_compatibility)
*   [http://css-tricks.com/snippets/css/truncate-string-with-ellipsis/](http://css-tricks.com/snippets/css/truncate-string-with-ellipsis/)
*   [https://stackoverflow.com/a/1101702/759452](https://stackoverflow.com/a/1101702/759452)
*   [http://www.browsersupport.net/CSS/text-overflow](http://www.browsersupport.net/CSS/text-overflow)
*   [http://caniuse.com/text-overflow](http://caniuse.com/text-overflow)
*   [http://msdn.microsoft.com/en-us/library/ie/ms531174(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms531174(v=vs.85).aspx)
*   [http://hacks.mozilla.org/2011/09/whats-new-for-web-developers-in-firefox-7/](http://hacks.mozilla.org/2011/09/whats-new-for-web-developers-in-firefox-7/)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-29T12:45:04.173

如果您对 JavaScript 解决方案感到满意，可以使用 jQuery 插件以跨浏览器的方式执行此操作 - 请参阅[http://azgtech.wordpress.com/2009/07/26/text-overflow-ellipsis-for -firefox-通过-jquery/](http://azgtech.wordpress.com/2009/07/26/text-overflow-ellipsis-for-firefox-via-jquery/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-07-09T16:10:52.337

好的，Firefox 7`text-overflow: ellipsis`和`text-overflow: "string"`. 最终版本计划于 2011 年 9 月 27 日发布。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-04-09T23:59:04.793

该问题的另一个解决方案可能是以下 CSS 规则集：

```
.ellipsis{
 white-space:nowrap;
 overflow:hidden;
}

.ellipsis:after{
  content:'...';
} 
```

上述 CSS 的唯一缺点是，无论文本是否溢出容器，它都会添加“...”。尽管如此，如果您有一堆元素并且确定内容会溢出，那么这将是一组更简单的规则。

我的两分钱。向 Justin Maxwell 的原创技术致敬

# c# - C# 对桌面的引用

> ID：802179
> 
> 赞同：11
> 
> 时间：2009-04-29T12:41:56.320
> 
> 标签：c#

我正在使用文件流写出文件。

我希望能够将文件写入桌面。

如果我有类似的东西

```
tw = new StreamWriter("NameOflog file.txt"); 
```

我希望能够在文件名前面标识某种@desktop，它会自动插入桌面的路径。这在 C# 中存在吗？还是我必须逐个计算机（逐个操作系统）查看并查看计算机上的桌面是什么。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-29T12:43:36.613

快速谷歌搜索揭示了这一点：

```
string strPath = Environment.GetFolderPath(
                         System.Environment.SpecialFolder.DesktopDirectory); 
```

**编辑**：这适用于 Windows，但[Mono](http://www.go-mono.com/docs/index.aspx?link=T%3ASystem.Environment.SpecialFolder)也支持它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T12:44:40.337

您想使用[Environment.GetFolderPath](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)，传入[`SpecialFolder.DesktopDirectory`](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx).

还有`SpecialFolder.Desktop`代表*逻辑*桌面位置的那个 - 虽然不清楚两者之间的区别是什么。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-29T12:47:25.027

就像是：

```
 string logPath = Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.Desktop),
        "NameOflog file.txt");
    tw = new StreamWriter(logPath); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T12:52:30.507

你想要 Environment.SpecialFolder

```
string fileName = "NameOflog file.txt";
path = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), fileName);
tw = new StreamWriter(path); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T12:47:36.010

是的。您可以使用环境变量。喜欢

```
tw = new StreamWriter("%USERPROFILE%\Desktop\mylogfile.txt"); 
```

但我不建议自动将日志文件写入用户桌面。您应该将文件的链接添加到您的开始菜单文件夹。甚至将它们填充到事件日志中。（好多了）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T12:45:04.410

```
Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory)) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-23T00:25:59.000

我也使用上面提到的方法。

但这里有几个不同的选项也有效（只是为了有一个更全面的列表）：

```
using System;
using System.Runtime.InteropServices;
using System.Text;

class Program
{
  // 1st way
  private const int MAX_PATH = 260;
  private const int CSIDL_DESKTOP = 0x0000;
  private const int CSIDL_COMMON_DESKTOPDIRECTORY = 0x0019; // Can get to All Users desktop even on .NET 2.0,
                                                            // where Environment.SpecialFolder.CommonDesktopDirectory is not available
  [DllImport("shell32.dll")]
  private static extern bool SHGetSpecialFolderPath(IntPtr hwndOwner, StringBuilder lpszPath, int nFolder, bool fCreate);
  static string GetDesktopPath()
  {
    StringBuilder currentUserDesktop = new StringBuilder(MAX_PATH);
    SHGetSpecialFolderPath((IntPtr)0, currentUserDesktop, CSIDL_DESKTOP, false);
    return currentUserDesktop.ToString();
  }

  // 2nd way
  static string YetAnotherGetDesktopPath()
  {
    Guid PublicDesktop = new Guid("C4AA340D-F20F-4863-AFEF-F87EF2E6BA25");
    IntPtr pPath;

    if (SHGetKnownFolderPath(PublicDesktop, 0, IntPtr.Zero, out pPath) == 0)
    {
      return System.Runtime.InteropServices.Marshal.PtrToStringUni(pPath);
    }

    return string.Empty;
  }
} 
```

然后：

```
string fileName = Path.Combine(GetDesktopPath(), "NameOfLogFile.txt"); 
```

# windows - 将应用程序的 64 位和 32 位版本滚动到同一个二进制文件中？

> ID：802192
> 
> 赞同：5
> 
> 时间：2009-04-29T12:44:31.557
> 
> 标签：windows, windows-xp, 64-bit, cross-platform, fat-binaries

我们有一个正在尝试在 64 位和 32 位平台上部署的应用程序。有没有办法将代码的两个编译版本放在同一个二进制文件中，比如 Apple 和 NeXT 的[胖二进制文件](http://en.wikipedia.org/wiki/Fat_binary)？

理想情况下，我们可以发布一个 .exe 来决定执行哪个版本的代码。我们的目标是 Windows XP 及更高版本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T12:57:39.277

Process Explorer（以前是 sysinternals，现在归 Microsoft 所有）就是这样做的。它是一个 32 位应用程序，它检测 64 位环境，写出另一个二进制文件并在退出时将其删除。[http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T12:52:10.180

一种方法可能是提供一个引导应用程序，该应用程序确定架构并选择适当的可执行文件来运行。所以基本上你的应用程序的快捷方式或你有什么只是启动引导程序，然后启动适当的应用程序。如果您的应用程序是 Windows 服务，这可能会有点棘手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:01:16.977

最简单的方法是由安装程序处理这个问题 - 每个二进制文件都有两个版本，并根据目标机器上的系统位数复制必要的版本。

# c# - CheckedListBox 项目的工具提示？

> ID：802213
> 
> 赞同：16
> 
> 时间：2009-04-29T12:48:41.140
> 
> 标签：c#, winforms, user-interface, tooltip, checkedlistbox

当用户的鼠标悬停在 CheckedListBox 中的项目上时，是否有一种直接的方法来设置附加文本以显示在工具提示中？

我*希望*能够在代码中做的是：

```
uiChkLstTables.DisplayOnHoverMember = "DisplayOnHoverProperty"; //Property contains extended details 
```

谁能指出我正确的方向来做到这一点？我已经找到了几篇文章，其中涉及检测鼠标当前在哪个项目上并创建一个新的工具提示实例，但这听起来有点做作，不是最好的方法。

提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-29T13:10:28.560

将 Tooltip 对象添加到您的表单，然后为 CheckedListBox.MouseHover 添加一个事件处理程序，该处理程序调用方法 ShowToolTip(); 添加具有以下代码的 CheckedListBox 的 MouseMove 事件：

```
//Make ttIndex a global integer variable to store index of item currently showing tooltip.
//Check if current location is different from item having tooltip, if so call method
if (ttIndex != checkedListBox1.IndexFromPoint(e.Location))
                ShowToolTip(); 
```

然后创建 ShowToolTip 方法：

```
private void ShowToolTip()
    {
        ttIndex = checkedListBox1.IndexFromPoint(checkedListBox1.PointToClient(MousePosition));
        if (ttIndex > -1)
        {
            Point p = PointToClient(MousePosition);
            toolTip1.ToolTipTitle = "Tooltip Title";
            toolTip1.SetToolTip(checkedListBox1, checkedListBox1.Items[ttIndex].ToString());

        }
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T13:15:18.940

或者，您可以使用[`ListView`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)带有复选框的选项。此控件具有 对*工具提示的**内置*支持。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:00:13.233

做作与否；就是这样……

我不知道比您已经描述的更简单的方法（尽管我可能会重新使用工具提示实例，而不是一直创建新的）。如果您有显示此内容的文章，请使用它们 - 或使用本机支持此内容的 3rd 方控件（没有想到）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-22T20:58:50.210

我想扩展费尔明的答案，以便让他的奇妙解决方案更加清晰。

在您正在使用的表单中（可能在 .Designer.cs 文件中），您需要向 CheckedListBox 添加一个 MouseMove 事件处理程序（Fermin 最初建议使用 MouseHover 事件处理程序，但这对我不起作用）。

```
this.checkedListBox.MouseMove += new System.Windows.Forms.MouseEventHandler(this.showCheckBoxToolTip); 
```

接下来，向表单添加两个类属性，一个 ToolTip 对象和一个整数，以跟踪显示工具提示的最后一个复选框

```
private ToolTip toolTip1;
private int toolTipIndex; 
```

最后，您需要实现 showCheckBoxToolTip() 方法。这个方法和 Fermin 的回答很相似，只是我把事件回调方法和 ShowToolTip() 方法结合起来了。此外，请注意方法参数之一是 MouseEventArgs。这是因为 MouseMove 属性需要一个 MouseEventHandler，然后它提供 MouseEventArgs。

```
private void showCheckBoxToolTip(object sender, MouseEventArgs e)
{
    if (toolTipIndex != this.checkedListBox.IndexFromPoint(e.Location))
    {
        toolTipIndex = checkedListBox.IndexFromPoint(checkedListBox.PointToClient(MousePosition));
        if (toolTipIndex > -1)
        {
            toolTip1.SetToolTip(checkedListBox, checkedListBox.Items[toolTipIndex].ToString());
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-06T00:29:43.373

在您的复选框项目列表中运行您的 ListItems 并将适当的文本设置为项目的“标题”属性，它将在悬停时显示...

```
foreach (ListItem item in checkBoxList.Items)
                { 
                    //Find your item here...maybe a switch statement or
                    //a bunch of if()'s
                    if(item.Value.ToString() == "item 1")
                    {
                        item.Attributes["title"] = "This tooltip will display when I hover over item 1 now, thats it!!!";
                    }
                    if(item.Value.ToString() == "item 2")
                    {
                        item.Attributes["title"] = "This tooltip will display when I hover over item 2 now, thats it!!!";
                    }
                } 
```

# asp.net-mvc - 为什么 ASP.NET MVC 必须是 Web 应用程序？

> ID：802215
> 
> 赞同：1
> 
> 时间：2009-04-29T12:48:50.577
> 
> 标签：asp.net-mvc

我想知道是否有人对为什么必须在 Visual Studio 中将 ASP.NET MVC 站点创建为 Web 应用程序（编译为单个 .dll）而不是网站（每个页面都是一个 .dll）有任何见解？我怀疑它与路由有关。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:53:56.740

Web 应用程序有一个 .csproj 文件，与网站项目相比，它可以更好地控制构建过程，据我所知，网站项目实际上只是一组文件和文件夹，构建完全由 VS IDE 管理。

您可能对路由是正确的，但另一个可能的原因与项目结构以及 MVC 应用程序项目与其测试项目之间的关系有关。

Web 应用程序和网站之间的主要区别之一是网站是一个独立实体，它不存在于解决方案中，这使得很难表达测试项目与应用程序项目的关系，而如果一个使用 web 应用程序，然后使用网站，它的测试可以被视为一个通用解决方案中的两个项目，同时还可以获得使用 MSBuild 的所有好处

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:31:00.483

好的，我想通了。ASP.NET MVC 应用程序是 Web 应用程序而不是网站的唯一原因与单元测试有关。您可以通过很少的更改将 ASP.NET MVC 应用程序“转换”为网站，但单元测试将无法工作，因为它们没有对网站的引用。但是，如果您开始将应用程序逻辑（控制器等）拉入单独的类库，然后在网站和单元测试中引用该类库，我很确定您可以让单元测试工作。

# openlayers - 平移后的 OpenLayers .containsPoint

> ID：802218
> 
> 赞同：0
> 
> 时间：2009-04-29T12:49:07.380
> 
> 标签：openlayers

我似乎遇到了一个错误，或者我忽略了一些东西。

我编写了一些代码来枚举 OpenLayers 矢量图层上的所有矢量特征 - 检查鼠标是否在矢量特征内 - 如果是，那么它会根据该特征显示一些信息。

我必须编写自己的方法来执行此操作，因为现有的 OpenLayers 控件（选择等）在找到鼠标下的功能后会停止，并且有可能将多个功能堆叠在一起。

我的问题是 .containsPoint 方法似乎使用了“平移”之前的坐标。放大或缩小后，几何图形似乎在正确的位置，当我在地图上挥动鼠标时 .containsPoint 工作正常。

平移地图以更新某些内容（要素的几何图形）后，我是否需要做某事

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-06T03:45:55.797

我意识到这个问题几乎过了它的第一个生日，它可能不再有效，但无论如何我都会尝试回答它。

完成平移后，OpenLayers.Control.DragPan 会调用地图。如果你检查 OpenLayers.Map 平移功能，你会在里面看到这个注释：

```
// only call setCenter if not dragging or there has been a change 
```

函数中的以下逻辑反映了此注释。

所以是的，每次完成平移时，您都需要执行以下操作：

```
dragpan.handler.up = function(evt)
{
    dx = dragpan.handler.last.x - evt.x;
    dy = dragpan.handler.last.y - evt.y;
    var centerPx = map.getViewPortPxFromLonLat(map.getCenter());
    var newCenterPx = centerPx.add(dx, dy);
    var newCenterLonLat = map.getLonLatFromViewPortPx(newCenterPx);
    map.setCenter(map.getCenter() + dragpan.handler.xy);
} 
```

......事情应该为你神奇地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T16:47:41.010

如果没有示例代码片段，很难回答这个问题。OpenLayers 能够通过鼠标单击选择多个对象。您是否已经尝试过 OpenLayers 2.8？

# asp.net - 如何测试查询字符串

> ID：802222
> 
> 赞同：3
> 
> 时间：2009-04-29T12:51:06.237
> 
> 标签：asp.net, vb.net

我有一个名为 propID 的查询字符串，我想检查其中传递的值是否是合法整数，以避免引发可能泄露有关我的数据库信息的错误，我该怎么做？

换句话说，我想要 -but in vb.net- 之类的东西：

```
IF QueryString("propID").Content.Type = "int32" Then Proceed 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T12:53:35.013

您可以使用[TryParse](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)：

```
Dim myInt As Integer
If Int32.TryParse(QueryString("propID").Content, myInt) Then Proceed 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T12:53:59.613

```
Dim result as boolean
result = integer.tryparse(QueryString("propID"), myintegervariable) 
```

如果解析正确（将值放入 myinteger 变量），布尔值将返回 true，如果解析失败，则返回 false。

你也可以写为

```
if integer.tryparse(QueryString("propID"), myintegervariable) then
    //continue going along with myintegervariable
else
   //parsing didn't work
end if 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T12:54:19.817

您可以只使用 Int32.TryParse。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T13:01:26.507

您可以尝试使用“is”关键字来检查对象的类型。

```
If QueryString("propID").Content.Type Is Int32 Then Proceed 
```

否则 Int32.TryParse 也可以。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T13:12:04.453

C#版本：

```
int _PropID;
if (int.TryParse(QueryString["propID"], out _PropID))
{
    //Proceed with _PropID
} 
```

# javascript - 如何使用 Mechanize 处理 JavaScript？

> ID：802225
> 
> 赞同：28
> 
> 时间：2009-04-29T12:51:41.443
> 
> 标签：javascript, html, ruby, mechanize

我正在连接到一个网站，正在登录。

该网站将我重定向到新页面，Mechanize 处理所有 cookie 和重定向作业，但是，我无法获得最后一页。我使用了 Firebug 并再次完成了相同的工作，发现我还必须通过 Mechanize 传递两页。

我快速浏览了这些页面，发现有一些 JavaScript 和 HTML 代码但无法理解，因为它看起来不像正常的页面代码。这些页面是做什么用的？他们如何重定向到其他页面？我该怎么做才能通过这些？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-29T13:05:13.173

如果您需要使用 Javascript 处理页面，请尝试[WATIR](http://watir.com/)或[Selenium](http://docs.seleniumhq.org/) - 它们驱动真正的 Web 浏览器，因此可以处理任何 Javascript。WATIR Classic 需要安装了特定扩展的 IE 或 Firefox，您会看到页面在屏幕上闪烁。

您的另一个选择是了解违规页面上的 Javascript 的作用并手动绕过它，但这似乎很麻烦。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-29T13:11:52.503

目前，Mechanize 不处理 JavaScript。有人说最终将[Johnson](http://wiki.github.com/jbarnette/johnson)的功能合并到 Mechanize 中，但在此之前，您有两种选择：

1.  弄清楚 JavaScript 足以理解如何遍历这些页面。
2.  [使用Watir](http://wtr.rubyforge.org/)自动化一个能够理解 JavaScript的实际浏览*器*。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-29T15:48:23.533

> 这些页面是做什么用的？他们如何重定向到其他页面。我该怎么做才能通过这些？

有时工作是在这些页面上完成的。有时，JavaScript 会阻止自动访问，就像您尝试做的那样:)。许多网站都有不必要的检查以确保您拥有“良好”的浏览器，因此请确保您的浏览器`user_agent`设置为常见的，例如 IE。有时将 设置`user_agent`为看起来像旧浏览器会让您在没有 JavaScript 的情况下通过。

网站自动化很有趣，因为您必须使用多种策略来超越网站及其软件开发人员。正如其他人所说，Watir 是目前超越 JavaScript 的最佳工具。

# windows - 如何调试regsvr32后编译DLL注册异常？

> ID：802238
> 
> 赞同：5
> 
> 时间：2009-04-29T12:54:16.133
> 
> 标签：windows, com, dll, registration

我正在使用 Visual Studio 2008（在 Windows 2003 Server/32 位上）编译库，并在生成 DLL 后，“自定义构建步骤”->“常规”执行命令行：

> regsvr32 /s /c "($TargetPath)"

这会产生异常：

> regsvr32.exe [212] 中出现未处理的 win32 异常。

这会引发一个调试会话，其中显示的信息非常少。

在 cmd 窗口中从命令行运行 regsvr32 会引发异常（尽管末尾的数字不同）。

任何指针表示赞赏！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T12:56:54.130

在调试器中运行 dll，将 regsvr32 设置为调试目标。

您需要在 DllRegisterServer 函数中放置一个断点。

# java - 适用于 Java 或 Python 的人脸跟踪库

> ID：802243
> 
> 赞同：9
> 
> 时间：2009-04-29T12:55:12.980
> 
> 标签：java, python, face-detection

我正在寻找一种方法来识别面孔（不是特定的人，只是面孔所在的位置）并在他们穿过房间时跟踪他们。

我们正在尝试测量人们的步行速度，我认为这将是识别一个人的最简单方法。我们将为该项目配备一个相当快的相机，所以我可以使用一些逻辑来查看“frame00 中的 face1 == frame01 中的 face1”。

理想情况下，这样的软件会返回一个人脸列表（如 x,y 位置）及其大小。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T13:32:51.703

签[出 OpenCV Python 接口](http://opencv.willowgarage.com/wiki/PythonInterface)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T13:04:58.260

“faint”（人脸注释界面）可能是您正在寻找的。

[http://faint.sourceforge.net/](http://faint.sourceforge.net/)

[http://technoroy.blogspot.com/2008/06/faint-search-for-faces.html](http://technoroy.blogspot.com/2008/06/faint-search-for-faces.html)

我自己从来没有用过。但是，我玩的是捆绑了微弱的应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T13:07:05.853

德语“Linux Magazin”中有[一篇关于此的文章。](http://www.linux-magazin.de/heft_abo/ausgaben/2008/02/ins_gesicht_geblickt)

他们使用了[开放计算机视觉库](http://sourceforge.net/projects/opencvlibrary/)，它提供了一大堆算法来以各种方式处理图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-16T12:44:44.383

[CodeProject 有大量各种语言的文章。](http://www.codeproject.com/info/search.aspx?artkw=face+recognition)

# asp.net-mvc - ASP.NET MVC 中的本地化

> ID：802250
> 
> 赞同：4
> 
> 时间：2009-04-29T12:57:58.077
> 
> 标签：asp.net-mvc, visual-studio-2008

视觉工作室 2008

我想在我的 ASP.NET MVC 站点中加入一些本地化。

有人建议创建一个资源文件“Strings.resx”作为公共强类型资源，它运行良好并且允许我编写

```
<title><%= Strings.MyView_Title %></title> 
```

然后我继续添加一个文件“Strings.da.resx”。该文件在第一个文件旁边创建，默认为“访问修饰符：无编译”，而第一个（没有语言修饰符的）默认为“内部”。

我可以在 bin 目录中看到已使用 resource.dll 创建了一个目录（“da”），但是，我在我的网站上看不到任何翻译文本。

我用浏览器检查了唯一首选的语言是丹麦语（da-DK），但我只看到英文文本。

问题：1）我需要在 web.config 中启用某些东西吗？2）我是否创建了正确的文件，具有正确的类型（即＃2应该是“无编译”）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T12:59:07.370

在您看来，您有页面指令吗？如果是这样，你有 UICulture="Auto" 和 Culture="Auto" 吗？

例如...

```
<%@ Page Language="C#" Inherits="..." 
    culture="auto" uiculture="auto" %> 
```

这将确保浏览器在请求中传递的 Accept-Language 标头用于设置线程文化。UICulture 会影响选择哪个资源文件。

有关 ASP.NET i18n 的更多信息，这本书非常好...

[http://www.amazon.co.uk/NET-Internationalization-Developers-Guide-Building/dp/0321341384/ref=sr_1_1?ie=UTF8&s=books&qid=1241010151&sr=8-1](http://www.amazon.co.uk/NET-Internationalization-Developers-Guide-Building/dp/0321341384/ref=sr_1_1?ie=UTF8&s=books&qid=1241010151&sr=8-1)

它不涵盖 MVC，但涵盖 ASP.NET，因此，许多事情仍然是相关的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T13:11:27.013

首先，您必须创建将切换请求线程文化的操作过滤器。或将您的[全球化](http://msdn.microsoft.com/en-us/library/hy4kkhe0(VS.71).aspx)元素设置为 UICulture="Auto" 和 Culture="Auto"

查看此[截屏视频](http://www.techdays.ru/videos/1281.html)，它是俄语的，但代码示例是可以理解的。

# nhibernate - 使用 NHibernate 延迟加载记录的一部分

> ID：802251
> 
> 赞同：1
> 
> 时间：2009-04-29T12:58:08.747
> 
> 标签：nhibernate

我不确定如何解释这一点。所以这里...

[我正在尝试使用此处](https://web.archive.org/web/20100711074950/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/11/17/lazy-loading-blobs-and-the-like-in-nhibernate.aspx?)描述的延迟加载 blob 的方法，但我只能使用一张表。

我有一个看起来像这样的模式（固定，在遗留系统中）：

```
MyTable
   ID int
   Name char(50)
   image byte 
```

这是在 Informix 上，字节列是一个简单的大对象。现在通常我会查询表`"SELECT ID, Name, (image is not null) as imageexists..."`并稍后处理 blob 加载。

我可以将我的对象模型构造为具有两个不同的类（因此有两个不同的映射定义）来处理这种关系，但是我怎样才能“愚弄”nhibernate 使用同一个表来显示这种一对一的关系呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:02:14.353

简短的回答：你不能。

您要么需要映射它两次，要么（我的偏好）创建一个包含所需字段的 DTO。在 HQL 中，您会执行以下操作：

```
select new MyTableDTO(t.ID, t.name) from MyTable t 
```

# asp.net-mvc - ASP.NET MVC 如何在应用程序作为域的子项目发布时使用路由？

> ID：802253
> 
> 赞同：3
> 
> 时间：2009-04-29T12:58:17.857
> 
> 标签：asp.net-mvc, routing, subproject

我有一个在本地调试和测试时完美运行的 web 应用程序。但是，当我将站点发布到生产服务器时，路由就搞砸了。这是因为它在生产服务器上作为子项目运行。

```
测试：http://localhost:xxx/
生产：http://remotehost/webapp/

```

**我应该如何设置路由？**

这是我当前的路由设置（大部分是默认设置）。当我访问[http://remotehost/webapp/](http://remotehost/webapp/)时，服务器会显示默认的 Controller 操作。但是当我对控制器进行硬编码时（[http://remotehost/webapp/Project/](http://remotehost/webapp/Project/)它不起作用......

```
Shared Sub RegisterRoutes(ByVal routes As RouteCollection)
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}")

    routes.MapRoute("ProjectsByCategory", "Project/Category/{id}", _
                    New With {.controller = "Project", .action = "ListByCategory", .id = ""}, _
                    New With {.id = "^[0-9]+"})

    routes.MapRoute( _
        "Default", _
        "{controller}/{action}/{id}", _
        New With {.controller = "Project", .action = "Index", .id = ""} _
    )

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T20:16:18.193

对我来说，这听起来可能与在 iis 6 上发布有关。这里有一篇[关于](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)此的文章。

对我来说，通过添加“通配符应用程序地图”解决了类似的问题：

*   在 IIS 中，右键单击并选择相关虚拟目录的属性
*   选择虚拟目录选项卡
*   选择配置
*   单击插入
*   输入 aspnet-isapi.dll 的路径（通常为 c:\windows\microsoft.net\framework\v2.0.50727\aspnet_isapi.dll）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T14:04:13.827

顺便说一句，路由似乎在应用程序级别上工作。无需打扰您的域名或更高的目录名称。

# c# - 如何在 LINQ 中将匿名类型转换为强类型？

> ID：802256
> 
> 赞同：18
> 
> 时间：2009-04-29T12:58:34.157
> 
> 标签：c#, linq, .net-3.5

我有一个 ListViewItems ( ) 数组，我在每个 ListViewItem.Tag 中`ListViewItem[]`存储一个对象以供以后参考。`SalesOrderMaster`

我现在有一些代码，通过每个`ListViewItem`安全地将 .Tag 属性转换为 SalesOrderMaster 对象，然后将该对象添加到 SalesOrders 集合中，只有在检查以确保该集合中不存在该订单之后。

**比较**销售订单的过程很昂贵，为了清晰和性能，我想将其转换为 LINQ 表达式。（我还安装了[.NET Framework 3.5 的并行扩展，](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)因此我可以使用它来进一步提高 LINQ 性能）

所以事不宜迟：这就是我所拥有的，然后是我想要的。（我想要的不会编译，所以我知道我做错了什么，但我希望它能说明这一点）

我有什么：（慢）

```
foreach (ListViewItem item in e.Argument as ListViewItem[])
            {
                SalesOrderMaster order = item.Tag as SalesOrderMaster;
                if ( order == null )
                {
                    return;
                }
                if (!All_SalesOrders.Contains(order))
                {
                    All_SalesOrders.Add(order);
                }
            } 
```

我想要什么：（理论）

```
 List<SalesOrderMaster> orders = 
(from item in (e.Argument as ListViewItem[]).AsParallel() 
select new { ((SalesOrderMaster)item.Tag) }).Distinct(); 
```

编辑：我知道演员表很便宜，我说“比较”，在这种情况下翻译为 .Contains(order) 操作

编辑：每个人的回答都很棒！我希望我可以标记多个答案，但最后我必须选择一个。

编辑：这就是我最终得到的：

```
List<SalesOrderMaster> orders = 
(from item in (e.Argument as ListViewItem[]) select (SalesOrderMaster) item.Tag).GroupBy(item => item.Number).Select(x => x.First()).ToList(); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-29T13:32:29.910

我看到没有人解决您将匿名类型显式转换为命名类型的需求，所以这里......通过使用“ `select new { }`”，您正在创建一个匿名类型，但您不需要。您可以这样编写查询：

```
List<SalesOrderMaster> orders = 
    (from item in (e.Argument as ListViewItem[]).AsParallel() 
    select (SalesOrderMaster)item.Tag)
    .Distinct()
    .ToList(); 
```

请注意，查询选择`(SalesOrderMaster)item.Tag`不带`new { }`，因此它不会创建匿名类型。另请注意，我添加了`ToList()`因为您想要一个`List<SalesOrderMaster>`.

这解决了您的匿名类型问题。但是，我同意 Mark 和 Guffa 的观点，即在这里使用并行查询不是您的最佳选择。要`HashSet<SalesOrderMaster>`按照 Guffa 的建议使用，您可以这样做：

```
IEnumerable<SalesOrderMaster> query = 
    from item in (ListViewItem[])e.Argument
    select (SalesOrderMaster)item.Tag;

HashSet<SalesOrderMaster> orders = new HashSet<SalesOrderMaster>(query); 
```

（我避免使用`var`，因此返回的类型在示例中很清楚。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T13:18:48.307

该代码中昂贵的部分是调用`Contains`列表中的方法。由于它是 O(n) 操作，因此添加到列表中的对象越多，它的速度就越慢。

只需将 a`HashSet<SalesOrderMaster>`用于对象而不是 a `List<SalesOrderMaster>`。的`Contains`方法`HashSet`是 O(1) 操作，因此您的循环将是 O(n) 操作而不是 O(n*n) 操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T13:20:11.377

就像 Marc Gravell 所说，您不应该`Tag`从不同的线程访问该属性，而且演员阵容非常便宜，所以您有：

```
var items = (e.Argument as ListViewItem[]).Select(x=>x.Tag)
         .OfType<SalesOrderMaster>().ToList(); 
```

但是，您想找到不同的项目 - 在这里您可以尝试使用`AsParallel`：

```
var orders = items.AsParallel().Distinct(); 
```

# itextsharp - 使用 iTextSharp 提取图像

> ID：802269
> 
> 赞同：22
> 
> 时间：2009-04-29T13:02:23.667
> 
> 标签：itextsharp

我一直在使用此代码非常成功地提取出 PDF 每一页中的第一张图片。但是，由于未知原因，它现在无法处理一些新的 PDF。我使用了其他工具（Datalogics 等），这些工具可以很好地使用这些新的 PDF 提取图像。但是，如果我可以使用 iTextSharp，我不想购买 Datalogics 或任何工具。谁能告诉我为什么这段代码在 PDF 中找不到图像？

已知：我的 PDF 每页只有 1 张图片，没有别的。

```
using iTextSharp.text;
using iTextSharp.text.pdf;
...
public static void ExtractImagesFromPDF(string sourcePdf, string outputPath)
{
    // NOTE:  This will only get the first image it finds per page.
    PdfReader pdf = new PdfReader(sourcePdf);
    RandomAccessFileOrArray raf = new iTextSharp.text.pdf.RandomAccessFileOrArray(sourcePdf);

    try
    {
        for (int pageNumber = 1; pageNumber <= pdf.NumberOfPages; pageNumber++)
        {
            PdfDictionary pg = pdf.GetPageN(pageNumber);
            PdfDictionary res = (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));

            PdfDictionary xobj = (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
            if (xobj != null)
            {
                foreach (PdfName name in xobj.Keys)
                {
                    PdfObject obj = xobj.Get(name);
                    if (obj.IsIndirect())
                    {
                        PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);
                        PdfName type = (PdfName)PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE));
                        if (PdfName.IMAGE.Equals(type))
                        {
                            int XrefIndex = Convert.ToInt32(((PRIndirectReference)obj).Number.ToString(System.Globalization.CultureInfo.InvariantCulture));
                            PdfObject pdfObj = pdf.GetPdfObject(XrefIndex);
                            PdfStream pdfStrem = (PdfStream)pdfObj;
                            byte[] bytes = PdfReader.GetStreamBytesRaw((PRStream)pdfStrem);
                            if ((bytes != null))
                            {
                                using (System.IO.MemoryStream memStream = new System.IO.MemoryStream(bytes))
                                {
                                    memStream.Position = 0;
                                    System.Drawing.Image img = System.Drawing.Image.FromStream(memStream);
                                    // must save the file while stream is open.
                                    if (!Directory.Exists(outputPath))
                                        Directory.CreateDirectory(outputPath);

                                    string path = Path.Combine(outputPath, String.Format(@"{0}.jpg", pageNumber));
                                    System.Drawing.Imaging.EncoderParameters parms = new System.Drawing.Imaging.EncoderParameters(1);
                                    parms.Param[0] = new System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Compression, 0);
                                    System.Drawing.Imaging.ImageCodecInfo jpegEncoder = Utilities.GetImageEncoder("JPEG");
                                    img.Save(path, jpegEncoder, parms);
                                    break;
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    catch
    {
        throw;
    }
    finally
    {
        pdf.Close();
        raf.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-07T01:25:34.757

我发现我的问题是我没有在表单和组中递归搜索图像。基本上，原始代码只会找到嵌入在 pdf 文档根目录中的图像。这是修改后的方法加上一个递归搜索页面中图像的新方法 (FindImageInPDFDictionary)。注意：仅支持 JPEG 和非压缩图像的缺陷仍然存在。有关修复这些缺陷的选项，请参阅 R Ubben 的代码。某人。

```
 public static void ExtractImagesFromPDF(string sourcePdf, string outputPath)
    {
        // NOTE:  This will only get the first image it finds per page.
        PdfReader pdf = new PdfReader(sourcePdf);
        RandomAccessFileOrArray raf = new iTextSharp.text.pdf.RandomAccessFileOrArray(sourcePdf);

        try
        {
            for (int pageNumber = 1; pageNumber <= pdf.NumberOfPages; pageNumber++)
            {
                PdfDictionary pg = pdf.GetPageN(pageNumber);

                // recursively search pages, forms and groups for images.
                PdfObject obj = FindImageInPDFDictionary(pg);
                if (obj != null)
                {

                    int XrefIndex = Convert.ToInt32(((PRIndirectReference)obj).Number.ToString(System.Globalization.CultureInfo.InvariantCulture));
                    PdfObject pdfObj = pdf.GetPdfObject(XrefIndex);
                    PdfStream pdfStrem = (PdfStream)pdfObj;
                    byte[] bytes = PdfReader.GetStreamBytesRaw((PRStream)pdfStrem);
                    if ((bytes != null))
                    {
                        using (System.IO.MemoryStream memStream = new System.IO.MemoryStream(bytes))
                        {
                            memStream.Position = 0;
                            System.Drawing.Image img = System.Drawing.Image.FromStream(memStream);
                            // must save the file while stream is open.
                            if (!Directory.Exists(outputPath))
                                Directory.CreateDirectory(outputPath);

                            string path = Path.Combine(outputPath, String.Format(@"{0}.jpg", pageNumber));
                            System.Drawing.Imaging.EncoderParameters parms = new System.Drawing.Imaging.EncoderParameters(1);
                            parms.Param[0] = new System.Drawing.Imaging.EncoderParameter(System.Drawing.Imaging.Encoder.Compression, 0);
                            System.Drawing.Imaging.ImageCodecInfo jpegEncoder = Utilities.GetImageEncoder("JPEG");
                            img.Save(path, jpegEncoder, parms);
                        }
                    }
                }
            }
        }
        catch
        {
            throw;
        }
        finally
        {
            pdf.Close();
            raf.Close();
        }

    }

     private static PdfObject FindImageInPDFDictionary(PdfDictionary pg)
    {
        PdfDictionary res =
            (PdfDictionary)PdfReader.GetPdfObject(pg.Get(PdfName.RESOURCES));

        PdfDictionary xobj =
          (PdfDictionary)PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT));
        if (xobj != null)
        {
            foreach (PdfName name in xobj.Keys)
            {

                PdfObject obj = xobj.Get(name);
                if (obj.IsIndirect())
                {
                    PdfDictionary tg = (PdfDictionary)PdfReader.GetPdfObject(obj);

                    PdfName type =
                      (PdfName)PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE));

                    //image at the root of the pdf
                    if (PdfName.IMAGE.Equals(type))
                    {
                        return obj;
                    }// image inside a form
                    else if (PdfName.FORM.Equals(type))
                    {
                        return FindImageInPDFDictionary(tg);
                    } //image inside a group
                    else if (PdfName.GROUP.Equals(type))
                    {
                        return FindImageInPDFDictionary(tg);
                    }

                }
            }
        }

        return null;

    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-11-03T13:30:11.377

这是一个更简单的解决方案：

```
iTextSharp.text.pdf.parser.PdfImageObject pdfImage = 
                            new iTextSharp.text.pdf.parser.PdfImageObject(imgPRStream);
                        System.Drawing.Image img = pdfImage.GetDrawingImage(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-08-03T06:55:15.517

下面的代码结合了 Dave 和 R Ubben 上面的所有想法，此外它还返回了所有图像的完整列表，并且还处理了多个位深度。我不得不将它转换为我正在从事的项目的VB，对此感到抱歉......

```
Private Sub getAllImages(ByVal dict As pdf.PdfDictionary, ByVal images As List(Of Byte()), ByVal doc As pdf.PdfReader)
    Dim res As pdf.PdfDictionary = CType(pdf.PdfReader.GetPdfObject(dict.Get(pdf.PdfName.RESOURCES)), pdf.PdfDictionary)
    Dim xobj As pdf.PdfDictionary = CType(pdf.PdfReader.GetPdfObject(res.Get(pdf.PdfName.XOBJECT)), pdf.PdfDictionary)

    If xobj IsNot Nothing Then
        For Each name As pdf.PdfName In xobj.Keys
            Dim obj As pdf.PdfObject = xobj.Get(name)
            If (obj.IsIndirect) Then
                Dim tg As pdf.PdfDictionary = CType(pdf.PdfReader.GetPdfObject(obj), pdf.PdfDictionary)
                Dim subtype As pdf.PdfName = CType(pdf.PdfReader.GetPdfObject(tg.Get(pdf.PdfName.SUBTYPE)), pdf.PdfName)
                If pdf.PdfName.IMAGE.Equals(subtype) Then
                    Dim xrefIdx As Integer = CType(obj, pdf.PRIndirectReference).Number
                    Dim pdfObj As pdf.PdfObject = doc.GetPdfObject(xrefIdx)
                    Dim str As pdf.PdfStream = CType(pdfObj, pdf.PdfStream)
                    Dim bytes As Byte() = pdf.PdfReader.GetStreamBytesRaw(CType(str, pdf.PRStream))

                    Dim filter As String = tg.Get(pdf.PdfName.FILTER).ToString
                    Dim width As String = tg.Get(pdf.PdfName.WIDTH).ToString
                    Dim height As String = tg.Get(pdf.PdfName.HEIGHT).ToString
                    Dim bpp As String = tg.Get(pdf.PdfName.BITSPERCOMPONENT).ToString

                    If filter = "/FlateDecode" Then
                        bytes = pdf.PdfReader.FlateDecode(bytes, True)
                        Dim pixelFormat As System.Drawing.Imaging.PixelFormat
                        Select Case Integer.Parse(bpp)
                            Case 1
                                pixelFormat = Drawing.Imaging.PixelFormat.Format1bppIndexed
                            Case 24
                                pixelFormat = Drawing.Imaging.PixelFormat.Format24bppRgb
                            Case Else
                                Throw New Exception("Unknown pixel format " + bpp)
                        End Select
                        Dim bmp As New System.Drawing.Bitmap(Int32.Parse(width), Int32.Parse(height), pixelFormat)
                        Dim bmd As System.Drawing.Imaging.BitmapData = bmp.LockBits(New System.Drawing.Rectangle(0, 0, Int32.Parse(width), Int32.Parse(height)), System.Drawing.Imaging.ImageLockMode.WriteOnly, pixelFormat)
                        Marshal.Copy(bytes, 0, bmd.Scan0, bytes.Length)
                        bmp.UnlockBits(bmd)
                        Using ms As New MemoryStream
                            bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png)
                            bytes = ms.GetBuffer
                        End Using
                    End If
                    images.Add(bytes)
                ElseIf pdf.PdfName.FORM.Equals(subtype) Or pdf.PdfName.GROUP.Equals(subtype) Then
                    getAllImages(tg, images, doc)
                End If
            End If
        Next
    End If
End Sub 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-06-03T15:58:47.597

这只是其他人想法的又一次重述，但对我有用。在这里，我使用 @Malco 的图像抓取片段和 R Ubben 的循环：

```
private IList<System.Drawing.Image> GetImagesFromPdfDict(PdfDictionary dict, PdfReader doc)
{
    List<System.Drawing.Image> images = new List<System.Drawing.Image>();
    PdfDictionary res = (PdfDictionary)(PdfReader.GetPdfObject(dict.Get(PdfName.RESOURCES)));
    PdfDictionary xobj = (PdfDictionary)(PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT)));

    if (xobj != null)
    {
        foreach (PdfName name in xobj.Keys)
        {
            PdfObject obj = xobj.Get(name);
            if (obj.IsIndirect())
            {
                PdfDictionary tg = (PdfDictionary)(PdfReader.GetPdfObject(obj));
                PdfName subtype = (PdfName)(PdfReader.GetPdfObject(tg.Get(PdfName.SUBTYPE)));
                if (PdfName.IMAGE.Equals(subtype))
                {
                    int xrefIdx = ((PRIndirectReference)obj).Number;
                    PdfObject pdfObj = doc.GetPdfObject(xrefIdx);
                    PdfStream str = (PdfStream)(pdfObj);

                    iTextSharp.text.pdf.parser.PdfImageObject pdfImage =
                        new iTextSharp.text.pdf.parser.PdfImageObject((PRStream)str);
                    System.Drawing.Image img = pdfImage.GetDrawingImage();

                    images.Add(img);
                }
                else if (PdfName.FORM.Equals(subtype) || PdfName.GROUP.Equals(subtype))
                {
                    images.AddRange(GetImagesFromPdfDict(tg, doc));
                }
            }
        }
    }

    return images;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-11-03T10:17:05.023

de c# 版本：

```
private IList<System.Drawing.Image> GetImagesFromPdfDict(PdfDictionary dict, PdfReader doc){
        List<System.Drawing.Image> images = new List<System.Drawing.Image>();
        PdfDictionary res = (PdfDictionary)(PdfReader.GetPdfObject(dict.Get(PdfName.RESOURCES)));
        PdfDictionary xobj = (PdfDictionary)(PdfReader.GetPdfObject(res.Get(PdfName.XOBJECT)));

        if (xobj != null)
        {
            foreach (PdfName name in xobj.Keys)
            {
                PdfObject obj = xobj.Get(name);
                if (obj.IsIndirect())
                {
                    PdfDictionary tg = (PdfDictionary)(PdfReader.GetPdfObject(obj));
                    pdf.PdfName subtype = (pdf.PdfName)(pdf.PdfReader.GetPdfObject(tg.Get(pdf.PdfName.SUBTYPE)));
                    if (pdf.PdfName.IMAGE.Equals(subtype))
                    {
                        int xrefIdx = ((pdf.PRIndirectReference)obj).Number;
                        pdf.PdfObject pdfObj = doc.GetPdfObject(xrefIdx);
                        pdf.PdfStream str = (pdf.PdfStream)(pdfObj);
                        byte[] bytes = pdf.PdfReader.GetStreamBytesRaw((pdf.PRStream)str);

                        string filter = tg.Get(pdf.PdfName.FILTER).ToString();
                        string width = tg.Get(pdf.PdfName.WIDTH).ToString();
                        string height = tg.Get(pdf.PdfName.HEIGHT).ToString();
                        string bpp = tg.Get(pdf.PdfName.BITSPERCOMPONENT).ToString();

                        if (filter == "/FlateDecode")
                        {
                            bytes = pdf.PdfReader.FlateDecode(bytes, true);
                            System.Drawing.Imaging.PixelFormat pixelFormat;
                            switch (int.Parse(bpp))
                            {
                                case 1:
                                    pixelFormat = System.Drawing.Imaging.PixelFormat.Format1bppIndexed;
                                    break;
                                case 24:
                                    pixelFormat = System.Drawing.Imaging.PixelFormat.Format24bppRgb;
                                    break;
                                default:
                                    throw new Exception("Unknown pixel format " + bpp);
                            }
                            var bmp = new System.Drawing.Bitmap(Int32.Parse(width), Int32.Parse(height), pixelFormat);
                            System.Drawing.Imaging.BitmapData bmd = bmp.LockBits(new System.Drawing.Rectangle(0, 0, Int32.Parse(width),
                                Int32.Parse(height)), System.Drawing.Imaging.ImageLockMode.WriteOnly, pixelFormat);
                            Marshal.Copy(bytes, 0, bmd.Scan0, bytes.Length);
                            bmp.UnlockBits(bmd);
                            using (var ms = new MemoryStream())
                            {
                                bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
                                bytes = ms.GetBuffer();
                            }
                        }
                        images.Add(System.Drawing.Image.FromStream(new MemoryStream(bytes)));
                    }
                    else if (pdf.PdfName.FORM.Equals(subtype) || pdf.PdfName.GROUP.Equals(subtype))
                    {
                        images.AddRange(GetImagesFromPdfDict(tg, doc));
                    }
                }
            }
        }
        return images;
     } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-29T21:39:50.817

以上仅适用于JPEG。排除内联图像和嵌入文件，您需要遍历子类型 IMAGE 的对象，然后查看过滤器并采取适当的操作。这是一个示例，假设我们有一个 IMAGE 子类型的 PdfObject：

```
 PdfReader pdf = new PdfReader("c:\\temp\\exp0.pdf");
        int xo=pdf.XrefSize;
        for (int i=0;i<xo;i++)
        {
            PdfObject obj=pdf.GetPdfObject(i);
            if (obj!=null && obj.IsStream())
            {
                PdfDictionary pd=(PdfDictionary)obj;
                if (pd.Contains(PdfName.SUBTYPE) && pd.Get(PdfName.SUBTYPE).ToString()=="/Image")
                {
                    string filter=pd.Get(PdfName.FILTER).ToString();
                    string width=pd.Get(PdfName.WIDTH).ToString();
                    string height=pd.Get(PdfName.HEIGHT).ToString();
                    string bpp=pd.Get(PdfName.BITSPERCOMPONENT).ToString();
                    string extent=".";
                    byte [] img=null;
                    switch (filter)
                    {
                        case "/FlateDecode":
                            byte[] arr=PdfReader.FlateDecode(PdfReader.GetStreamBytesRaw((PRStream)obj),true);
                            Bitmap bmp=new Bitmap(Int32.Parse(width),Int32.Parse(height),PixelFormat.Format24bppRgb);
                            BitmapData bmd=bmp.LockBits(new Rectangle(0,0,Int32.Parse(width),Int32.Parse(height)),ImageLockMode.WriteOnly,
                                PixelFormat.Format24bppRgb);
                            Marshal.Copy(arr,0,bmd.Scan0,arr.Length);
                            bmp.UnlockBits(bmd);
                            bmp.Save("c:\\temp\\bmp1.png",ImageFormat.Png);
                            break;
                        default:
                            break;
                    }
                }
            }
        } 
```

当然，由于 Microsoft BGR，这会弄乱颜色，但我想保持简短。为“/CCITTFaxDecode”等做类似的事情。

# objective-c - 如何打印出变量的内存地址？

> ID：802270
> 
> 赞同：15
> 
> 时间：2009-04-29T13:02:41.497
> 
> 标签：objective-c

我想打印 &myVariable 背后的内容。我试过 NSLog(&myIntVar); 但它不会工作。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-29T13:06:12.673

NSLog 的参数需要是一个 NSString，所以你想要

```
NSLog(@"%p", &myIntVar); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T13:06:52.140

尝试：

```
NSLog(@"%p", &myIntVar); 
```

或者

```
NSLog(@"%lx", (long)&myIntVar); 
```

第一个版本使用特定于指针的打印格式，它假定传递的参数是一个指针，但在内部将其视为一个 long。

第二个版本获取地址，然后将其转换为长整数。这对于 64 位平台上的可移植性是必要的，因为如果没有 " `l`" 格式限定符，它将假定提供的值是一个整数，通常只有 32 位长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-28T12:19:54.427

nslog(@"%x",&myIntVar); %x 是 long int 或者你可以像 Nslog(@"%p",&myIntVar); %p 用于指针

# apache-flex - 如何使用 flex 在面板标题的右上角插入图像？

> ID：802273
> 
> 赞同：1
> 
> 时间：2009-04-29T13:03:28.373
> 
> 标签：apache-flex, flash, actionscript-3, image, air

任何人帮助我

如何使用 flex 或 action script 在面板的右上角插入图像。我用了

-`<mx:Panel x="38.5" y="28" titleIcon="@Embed('image/logo.png')" id="register" width="375" height="534" layout="absolute" title="Registration Form ">`

titleIcon 属性但不使用 . 那么如何插入呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T11:56:00.547

诀窍是继承 Panel 并在 createChildren() 方法中添加您的按钮：

```
protected override function createChildren():void
{
     super.createChildren();

     mybtn = new Button();
     mybtn.label = "I am a button";
     mybtn.visible = true;
     mybtn.includeInLayout = true;
     mybtn.addEventListener( MouseEvent.CLICK, buttonClickHandler );
     rawChildren.addChild( mybtn );
} 
```

要使扩展面板更有用，请为按钮添加样式并使用 getStyle() 获取要使用的图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T18:56:35.070

您是要在面板标题中还是在面板本身的主体中显示图像？

# asp.net - 自动辅助功能测试/屏幕阅读器模拟器

> ID：802276
> 
> 赞同：4
> 
> 时间：2009-04-29T13:04:07.280
> 
> 标签：asp.net, accessibility

除了 IE 的 Web 辅助工具栏和 WAVE 工具。有谁知道任何其他工具可以帮助进行 Web 可访问性测试。

我也在寻找屏幕阅读器模拟器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:50:46.273

[有一个名为Fangs](http://www.standards-schmandards.com/projects/fangs/)的 Firefox 插件屏幕阅读器模拟器。它实际上并不像 JAWS 那样阅读文本并提供音频，但它确实显示了屏​​幕阅读器如何阅读它的文本。

[![替代文字](https://i.stack.imgur.com/T5Gfy.gif "獠牙示例截图")](https://i.stack.imgur.com/T5Gfy.gif "獠牙示例截图")
[（来源：[standards-schmandards.com](http://www.standards-schmandards.com/exhibits/fangs/fangs-sample.gif)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T19:51:15.183

伊利诺伊[州信息技术和 Web 可访问性中心](http://www.cita.uiuc.edu/)制作了一个很棒的[Firefox 插件，](https://addons.mozilla.org/en-US/firefox/addon/5809)称为功能性 Web 可访问性评估器 (FAE)。它分析您的 HTML 并发现潜在的可访问性问题。覆盖范围包括导航元素（标题、标题、链接、表格等）、文本等价物、脚本甚至颜色对比分析。

他们还有一个[支持 ARIA](http://en.wikipedia.org/wiki/Aria)的 beta 版本，并希望很快开始开发 Firebug 扩展。

总体而言，这是一个非常酷的插件，可以添加到您的工具箱中！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T19:05:55.320

我相信下颚演示将无限期地以 40 分钟模式运行，但由于我是盲人，我不得不购买完整版。有关屏幕阅读器列表以及我对它们的意见和经验，请参阅[此问题](https://stackoverflow.com/questions/796887/screen-readers-for-testing-website-accessibility)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:34:03.317

屏幕阅读器模拟器将是......屏幕阅读器。下载[JAWS](http://www.freedomscientific.com/products/fs/jaws-product-page.asp)并使用试用版。

# sql - “%%DatabaseEx”在 TSQL 中做了什么？

> ID：802277
> 
> 赞同：9
> 
> 时间：2009-04-29T13:04:46.030
> 
> 标签：sql, sql-server, sql-server-2005, tsql, stored-procedures

我正在查看SQL Server 2005中[sys.sp_dbcmptlevel的来源。](http://msdn.microsoft.com/en-us/library/ms178653.aspx)

在源代码中，有这条线我不明白它是如何工作的。

```
EXEC %%DatabaseEx(Name = @dbname).SetCompatibility(Level = @input_cmptlevel) 
```

它似乎不是`DatabaseEx`一个存储过程。

```
-- does not return any result
select  *
from    sys.procedures
where   [name] like '%DatabaseEx%' 
```

所以我的问题是

*   它是`DatabaseEx`什么，它有什么作用？
*   **%%**之前是什么`DatabaseEx`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T10:48:26.710

我认为这里最好的答案是它没有记录，也不受支持，所以不要依赖它。虽然了解 SQL Server 内部的工作方式很有趣，但您利用这些知识所做的任何事情都有可能在未来的修补程序、服务包或版本中中断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T13:41:18.237

有趣的发现。

系统 SP 还指 %%Object、%%Relation、%%ColumnEx、%%LinkedServer、%%Owner、%%CurrentDatabase()、%%ErrorMessage、%%Module、%%DatabaseRef、%%LocalLogin、%%Alias , %%ServerConfiguration, %%IndexOrStats, %%ScalarType (等)

我的解释是 %%() 根据过滤条件检索某种（COM？）对象，然后是方法调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T13:39:20.720

```
-- Note: database @dbname may not exist anymore
-- Change compatibility level
-- If invoke gets error, exception will abort this proc.
EXEC %%DatabaseEx(Name = @dbname).SetCompatibility(Level = @input_cmptlevel) 
```

它看起来像是一种将变量数据库作为对象引用并进行配置更改的方法

# windows - 多个应用程序窗口激活无法正常工作

> ID：802279
> 
> 赞同：3
> 
> 时间：2009-04-29T13:04:59.913
> 
> 标签：windows, delphi, focus

我有一个以文档浏览器为主要窗体的 Delphi 应用程序。当用户打开一个文档时，我们会打开一个编辑器窗口。我们希望每个编辑器在任务栏以及主窗体上都有一个按钮。我已经应用了普通代码来执行此操作（如下），但是当我在使用编辑器窗口后单击主窗体时，编辑器被留在顶部，而焦点在主窗体上。我无法弄清楚是什么导致了这种行为。

舞台设置：我打开主窗体和一个文档窗体。

1.  单击另一个应用程序，单击主窗体，主窗体保持焦点。（行为符合预期。）

2.  单击文档表单，单击主表单，文档表单回到前面，但显示为非活动状态。（图片显示结果）

[替代文字 http://www.matthew-jones.com/temp_xfer/titlebarfailure.jpg](http://www.matthew-jones.com/temp_xfer/titlebarfailure.jpg)

第一步，这是Delphi 2007，我在项目中有：

```
Application.MainFormOnTaskBar := True; 
```

对于主窗体，我没有额外的代码。

对于文件形式，我有

```
procedure TCommonEditForm.CreateParams(var params: TCreateParams);
begin
  inherited;
  params.WndParent := 0; // GetDeskTopWindow; no diff
end; 
```

我试图弄清楚是否有消息导致这种情况发生，但找不到任何合适的东西。我已经在代码中搜索了与“激活”有关的任何内容。欢迎提供线索！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T14:48:26.517

我的应用程序按照您描述的方式工作。这是我采取的方法。我本来想找到一种更简单的方法，但从来没有。

我从阅读这些文章开始。这第一个是彼得下面的一篇很棒的文章：

[http://groups-beta.google.com/group/borland.public.delphi.winapi/msg/e9f75ff48ce960eb?hl=en](http://groups-beta.google.com/group/borland.public.delphi.winapi/msg/e9f75ff48ce960eb?hl=en)

其他信息也在这里找到，但这并没有证明是一个有效的解决方案：供我使用：http: [//blogs.teamb.com/DeepakShenoy/archive/2005/04/26/4050.aspx](http://blogs.teamb.com/DeepakShenoy/archive/2005/04/26/4050.aspx)

最终这就是我的结局。

我的启动画面兼作应用程序主窗体。主窗体与应用程序对象有特殊的联系。使用所有辅助形式可以让我获得我正在寻找的行为。

在任务栏上我想要的每个表单中，我都会覆盖 CreateParams。我在我的编辑表单上执行此操作，用户将其视为“主要表单”

```
procedure TUaarSalesMain.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  Params.ExStyle := Params.ExStyle or WS_EX_APPWINDOW;
  Params.WndParent := GetDesktopWindow;
end; 
```

就 Delphi 而言，我的“主”表单在其 Activitate 函数中加载真正的主表单。我使用一个成员变量来跟踪第一次激活。然后在函数结束时隐藏启动表单，但不要关闭它。这对我来说很重要，因为如果用户正在编辑文档并关闭主窗体，我不希望同时强制关闭编辑屏幕。通过这种方式，所有可见形式都被视为相同。

```
 if FFirstActivate = false then
      exit;

    FFristActivate := false;

    /* 
       Main Load code here 
       Update Splash label, repaint
       Application.CreateForm
       etc.
    */

    // I can't change visible here but I can change the size of the window
    Self.Height := 0;
    Self.Width := 0;
    Self.Enabled := false;

    //  It is tempting to set Self.Visible := false here but that is not
    // possible because you can't change the Visible status inside this
    // function.  So we need to send a message instead.
    ShowWindow(Self.Handle, SW_HIDE);

  end; 
```

但是还有一个问题。当所有其他表单关闭时，您需要关闭主/启动窗口。我在关闭例程中对 Parent <> nil 进行了额外检查，因为我使用表单作为插件（形成我的目的，它们比框架更有效）。

我不太喜欢使用 Idle 事件，但我没有注意到这会拖累 CPU。

```
{
  TApplicationManager.ApplicationEventsIdle
  ---------------------------------------------------------------------------
}
procedure TApplicationManager.ApplicationEventsIdle(Sender: TObject;
  var Done: Boolean);
begin

  if Screen.FormCount < 2 then
    Close;
end;

{
  TApplicationManager.FormCloseQuery
  ---------------------------------------------------------------------------
}
procedure TApplicationManager.FormCloseQuery(Sender: TObject;
  var CanClose: Boolean);
var
  i: integer;
begin

  for i := 0 to Screen.FormCount - 1 do
  begin
    if Screen.Forms[i] <> self then
    begin
      // Forms that have a parent will be cleaned up by that parent so
      // ignore them here and only attempt to close the parent forms
      if Screen.Forms[i].Parent = nil then
      begin
        if Screen.Forms[i].CloseQuery = false then
        begin
          CanClose := false;
          break;
        end;
      end;
    end;
  end;

end;

{
  TApplicationManager.FormClose
  ---------------------------------------------------------------------------
}
procedure TApplicationManager.FormClose(Sender: TObject;
  var Action: TCloseAction);
var
  i: integer;
begin

  for i := Screen.FormCount - 1 downto 0 do
  begin
    if Screen.Forms[i] <> self then
    begin
      // Forms that have a parent will be cleaned up by that parent so
      // ignore them here and only attempt to close the parent forms
      if Screen.Forms[i].Parent = nil then
      begin
        Screen.Forms[i].Close;
      end;
    end;
  end;

end; 
```

到目前为止，这对我很有帮助。我确实为 Vista 做了一个小改动，因为我的“主/启动”屏幕的图标仍在显示。我不记得那是什么了。我可能不需要在初始屏幕上设置宽度、高度、启用和发送隐藏消息。我只是想确保它没有出现:-)。

处理关闭事件是必要的。如果我没记错的话，Windows 发送关闭消息时需要这样做。我认为只有主表单才能收到该信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T13:08:27.660

抱歉，如果这真的很愚蠢，但是您没有将 formstyle 设置为 fsStayOnTop 吗？这可以解释这种行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:08:11.697

也许在 createparams 中添加这个

```
Params.ExStyle := Params.ExStyle OR WS_EX_APPWINDOW; 
```

或者在代码中的任何地方尝试这个。我在表单 .OnCreate 事件中使用它。

```
SetWindowLong(Wnd, GWL_EXSTYLE, 
  GetWindowLong(Wnd, GWL_EXSTYLE) or WS_EX_APPWINDOW) ; 
```

这样做的缺点是，如果主窗体被最小化，其他窗体也会隐藏，但在主窗体出现时恢复。

# jsp - 改善 jsp 的外观？

> ID：802288
> 
> 赞同：0
> 
> 时间：2009-04-29T13:06:52.233
> 
> 标签：jsp

我正在使用带有 struts 的 jsp。我想改善外观（用户界面/网页外观）。我该怎么走。我现在正在使用样式表。但我不是一个好的 HTML 设计师。谁能给我一个漂亮的样式表。我正在做一个课程管理系统项目，我是一名学生。请帮助 jsp 是否支持对此的任何内置支持？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:12:08.477

JSP 本身不会直接影响网页的外观。

设计取决于您的 jsp 页面的 html 输出和您使用的样式表。

如果您正在寻找一个现成的设计 css 模板，有几个网页

即[http://www.freecsstemplates.org/](http://www.freecsstemplates.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T13:11:43.707

我认为你最好阅读一些关于可用设计、使用空白、使用字体、使用颜色等的基础知识，以提高你的设计技能。大多数东西都是常识，一旦你学会了它。你有没有用铅笔和纸坐下来为网站外观制作一些用户旅程故事板？

# actionscript - 在 AS1 中动态更改颜色

> ID：802293
> 
> 赞同：0
> 
> 时间：2009-04-29T13:08:28.317
> 
> 标签：actionscript, colors

我无法让它在我的 AS1 应用程序中工作。我正在使用 Color.setTransform 方法。

我认为以下对象创建应该导致将颜色转换为白色是否正确？

var AColorTransform = {ra:100, rb:255, ga:100, gb:255, ba:100, bb:255, aa:100, ab:255};

而这个要黑？

AColorTransform = {ra:100, rb:-255, ga:100, gb:-255, ba:100, bb:-255, aa:100, ab:-255};

我在一些网站上读到，当您正在执行操作的对象具有某种动态行为时，调用 setRGB 或 setTransform 可能不会导致实际更改显示颜色。有谁更了解这些情况？以及如何在所有情况下更改颜色？

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:36:28.570

很久以来我不得不做任何事情是AS1，但我会尽力而为。

color.setTransform() 的基本代码如下所示...

```
var AColorTransform = {ra:100, rb:255, ga:100, gb:255, ba:100, bb:255, aa:100, ab:255};
var myColor = new Color(mc);
myColor.setTransform(AColorTransform); 
```

...其中 mc 是舞台上某处的 MovieClip。

请记住，您询问的是*transform*，它本质上旨在将颜色*从*它们的本来面目转换*为*其他颜色。如果您想可靠地绘制特定颜色（例如黑色或白色），通常最好使用 setRGB，它看起来像这样：

```
var myColor = new Color(mc);
//set to black
myColor.setRGB(0x000000);
//or set to white
myColor.setRGB(0xFFFFFF); 
```

这些工作可靠，但可能存在一些问题。一般来说，只要记住颜色附加到特定的影片剪辑...所以如果该影片剪辑超出范围（即，它从时间轴上消失），您的颜色将被删除。

* * *

如果您想更好地了解颜色变换，请进一步阅读：

让我们看看颜色变换的组成部分。

```
 a (multiplier 0 > 100%)   b(offset -255 > 255)
r       ra                       rb

g       ga                       gb

b       ba                       bb

a       aa                       bb 
```

有四个通道（r、g、b 和 a）。前三个用于红色、绿色和蓝色，最后一个用于 alpha（透明度）。每个通道都有一个“a”分量和一个“b”分量，即 ra、rb、ga、gb 等。“a”分量是一个百分比乘数。也就是说，它将任何现有渠道乘以该值的百分比。'b' 组件是一个偏移量。所以'ra'乘以现有的红色通道。'rb' 抵消它。如果您的红色通道以“FF”开始（红色全亮），则设置 ra:100 将无效，因为将 FF 乘以 100% 不会导致任何变化。同样，如果红色从 '00' 开始（根本没有红色），则 'ra' 的任何值都不会产生任何影响，因为（如果你还记得你的莎士比亚的话）两次什么都没有。中间的事情会如你所料那样成倍增加。

乘法后添加偏移量。所以你可以乘以某个值，然后抵消它：

```
r (result red color) = (RR * ra%) + rb
g (result green color) = (GG * ga%) + gb
b (result blue color) = (BB * ba%) + bb
a (result alpha) = (AA * aa%) + ab 
```

示例：RR = 128（十六进制 0x80），ra = 50（50% 或 .5），rb = -20

结果红色通道：(128 * .5) + (-20) = 44 (hex 0x2C)

坦率地说，这一切都变得如此混乱，以至于我倾向于完全避免转换并使用更简单的 setRGB()。

# gtk - GTK 应用程序无法启动 - 需要 xfs 重新启动选项

> ID：802296
> 
> 赞同：0
> 
> 时间：2009-04-29T13:09:44.443
> 
> 标签：gtk, debian, x11, xorg

对不起，不是真正的编程问题，但我不确定我还能在哪里找到一些帮助。

在最近一次更新之后（Xorg 也被更新了），GTK 应用程序停止在我的 kde4 中运行。我有一个不稳定的 Debian，4 月 22 日左右更新。当我尝试运行它们时，出现以下错误：

```
ga@grzes:~$ iceweasel 
The program 'firefox-bin' received an X Window System error. 
This probably reflects a bug in the program. 
The error was 'BadName (named color or font does not exist)'. 
  (Details: serial 888 error_code 15 request_code 45 minor_code 0) 
  (Note to programmers: normally, X errors are reported asynchronously; 
   that is, you will receive the error a while after causing it. 
   To debug your program, run it with the --sync command line 
   option to change this behavior. You can then get a meaningful 
   backtrace from your debugger if you break on the gdk_x_error() function.) 
ga@grzes:~$ gimp The program 'gimp' received an X Window 
System error. 
This probably reflects a bug in the program. 
The error was 'BadName (named color or font does not exist)'. 
  (Details: serial 6955 error_code 15 request_code 45 minor_code 0) 
  (Note to programmers: normally, X errors are reported asynchronously; 
   that is, you will receive the error a while after causing it. 
   To debug your program, run it with the --sync command line 
   option to change this behavior. You can then get a meaningful 
   backtrace from your debugger if you break on the gdk_x_error() function.) 

(script-fu:4643): LibGimpBase-WARNING **: script-fu: gimp_wire_read(): 
error 
```

我必须手动重新启动字体服务器才能修复它：

```
ga@grzes:~$ su 
Password: 
grzes:/home/ga# /etc/init.d/xfs restart 
Stopping X font server: xfs. 
Setting up X font server socket directory /tmp/.font-unix...done. 
Starting X font server: xfs. 
```

有什么想法可能是错的吗？是配置问题吗？我的系统已经更新了 7 年，所以我可以有一些旧的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T20:19:05.257

Debian 不稳定现在非常...不稳定，因为不久前发布了一个版本。正在发生重大变化和包迁移。Xorg（以及所有与 X 相关的东西）是该过程中的关键包之一。我的建议是执行新的更新/升级，以获取可能解决此问题的新版本。

更新后某些东西会以莫名其妙的方式被破坏是非常常见的，这仅仅是因为开发人员正在上传新的、没有经过太多测试的应用程序版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:26:35.323

我终于想通了：似乎 xfs 目前与其他组件不兼容，幸运的是从系统中删除它完全解决了问题。

# java - 从版本 95 之前的 Excel 文件中读取数据

> ID：802299
> 
> 赞同：4
> 
> 时间：2009-04-29T13:10:16.203
> 
> 标签：java, excel, parsing, excel-4.0

显然 Excel 4.0 仍在使用，我必须用 Java 阅读它。

[poi](http://poi.apache.org/)和jExcelAPI[都](http://jexcelapi.sourceforge.net/)无法解析它们。我在他们身上找不到任何东西，尤其是 Java。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T15:13:01.090

查看使用 OpenOffice 的**[JODconverter](http://www.artofsolving.com/opensource/jodconverter)**，其中[支持文档列表](http://wiki.services.openoffice.org/wiki/Framework/Article/Filter/FilterList_OOo_3_0)包括 MS Excel 4。

如果您不能直接使用它，也许您可​​以转换为适合您的中间格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:24:13.793

如果我没记错的话，Excel 4 对通过 DDE 进行读写有很好的支持。如果你要回去，你还不如*回去*。我自己没有使用过，但 Google 显示了几个 Java DDE 支持列表。如果没有更好的弹出窗口，您可以尝试一下。

# iphone - iPhone 应用程序名称可用性

> ID：802313
> 
> 赞同：37
> 
> 时间：2009-04-29T13:12:37.807
> 
> 标签：iphone, naming

有没有办法检查 iphone 应用程序名称是否可用？在 iTunes 上搜索并检查是否已经存在现有应用程序是否表明 iphone 应用程序名称可以使用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T15:54:02.630

正如[这里所指出的](http://carpeaqua.com/2009/04/11/appstore-stake-your-claim/)，即使您搜索传统渠道，仍然可能有人声称同名但尚未提交申请。如果您想真正测试一下，听起来您可以开始在 iTunes Connect 上提交应用程序，填写新应用程序的名称，但不要完成提交。您应该会收到有关其他人是否具有相同商店名称的指示。如果没有，您现在似乎拥有该名称的所有权。

在任何情况下，因为您可以在商店中使用与 iPhone 上显示的名称不同的名称，所以您可以对商店提交的名称和您在 iPhone 应用程序本身中的所需名称进行轻微排列。

但是，我会同意 sgmeyer 的建议，即在使用名称之前先进行 USPTO 商标搜索。商标侵权以后会给您带来麻烦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T13:57:11.850

我建议在应用商店中搜索您希望使用的名称。此外，您可能需要查看美国专利商标局[www.uspto.gov/](http://www.uspto.gov/)以确保您选择的名称上不存在商标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T09:55:05.410

您必须从 iTunes Connect 进行搜索，就像您正在添加一个新应用程序一样，只是在 Google 上搜索不会显示已经是 iphone 4 的应用程序名称

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-29T14:21:04.070

搜索应用商店，然后搜索谷歌。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-29T14:28:40.040

我会说，如果您想使用的名称没有出现在 iTunes 上的搜索中，那么您应该清楚地获取该名称。我假设所有应用程序名称都需要得到 Apple 的批准，因此请确保选择不称为“iBabyShake”的名称。

# java - 在编译时强制存在无参数构造函数（Java）

> ID：802315
> 
> 赞同：2
> 
> 时间：2009-04-29T13:13:10.660
> 
> 标签：java

我有一个有点像这样的课程：

```
public class Test {

    private final List<ISomeType> things = new LinkedList<ISomeType>();

    public <T extends ISomeType> Test(Class<T> clazz, int order) {
        for (int i = 0; i < order; i++) {
            try {
                this.things.add(clazz.newInstance());
            } catch (Exception e) { 
                // stackoverflowers use your imagination
            }
        }
    }
} 
```

我期望并希望 Class clazz 有一个可访问的无参数构造函数。有什么办法可以在编译时强制它的存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T13:22:51.680

无法在编译时强制执行构造函数要求。在运行时，您可以检查 class.getConstructors() 并确保有一个没有 args（或者像在示例代码中一样捕获异常）。

通常，无参数构造函数要求只是在基类或接口的 Javadoc 中列出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T13:43:52.990

有一些用于代码样式验证的工具可以扩展以检查此类需求。对于 eclipse（和其他），[PMD](http://pmd.sourceforge.net/howtowritearule.html)可能会帮助你。通过查看教程，我认为您应该能够编写一个特定的规则来检查没有任何参数的构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T14:35:08.373

那这个呢？

```
interface Provider<T> {
   T get();
}

public class Test {

    private final List<ISomeType> things = new LinkedList<ISomeType>();

    public <T extends ISomeType> Test(Provider<T> provider, int order) {
        for (int i = 0; i < order; i++) {
            try {
                this.things.add(provider.get());
            } catch (Exception e) { 
                // stackoverflowers use your imagination
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T13:28:46.770

您最好的选择是创建一个单元测试来检查您关心的每个类，然后在构建时运行单元测试。或者，您可以创建一个测试类——不与您的代码一起分发——它只执行您关心的类的无参数构造函数。不是一个很好的选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T17:30:21.883

下面的链接显示了如何使用 Java 6 和 Annotation Processing Tool 来解决类似的情况（检查特定类的子类是否都有无参数构造函数）：

[注释处理工具](http://www.javaspecialists.eu/archive/Issue167.html)

也许您可以调整他们的解决方案来解决您的问题。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-29T13:18:13.550

反射是关于在运行时而不是编译时做事。如果您希望代码正常工作，请不要使用反射。

# c++ - C++ - 绕道 WinSock Hooking

> ID：802316
> 
> 赞同：5
> 
> 时间：2009-04-29T13:13:11.067
> 
> 标签：c++, winsock, recv, hook, detours

我想要做的是使用[Detours 库](http://research.microsoft.com/en-us/projects/detours/ "弯路 - 微软研究院")挂钩到应用程序 WinSock2 send() 和 recv() 函数（数据包记录器）。

虽然它适用于 send() 函数，但它不适用于 recv() 函数。

这是我的相关代码：

```
#include <cstdio>
#include <ctime>
#include <fstream>
#include <iomanip>
#include <string>
#include <windows.h>
#include <detours.h>

#pragma comment( lib, "Ws2_32.lib" )
#pragma comment( lib, "detours.lib" )
#pragma comment( lib, "detoured.lib" )
#pragma comment( lib, "Mswsock.lib" )

std::ofstream Logger;

std::string NowToString() {
    time_t rawtime;
    tm *timeinfo = new tm();
    char buffer[32];

    time( &rawtime );
    localtime_s( timeinfo, &rawtime );

    strftime( buffer, 32, "%m/%d/%Y %I:%M:%S %p", timeinfo );

    delete timeinfo;

    return std::string( buffer );
}

std::string TimeToString() {
    time_t rawtime;
    tm *timeinfo = new tm();
    char buffer[32];

    time( &rawtime );
    localtime_s( timeinfo, &rawtime );

    strftime( buffer, 32, "%I:%M:%S %p", timeinfo );

    delete timeinfo;

    return std::string( buffer );
}

void LogPacket( const char *buf, int len ) {
    Logger << "        0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F\n";
    Logger << "       -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --\n";
    Logger << "0000   ";

    for ( int i = 0; i < len; ++i ) {
        if ( i != 0 && i % 16 == 0 ) {
            Logger << "  ";

            int line = ( i / 16 ) - 1;

            for ( int j = 0; j < 16; ++j ) {
                char c = buf[line * 16 + j];

                if ( c >= 32 && c <= 126 ) {
                    Logger << c;
                } else {
                    Logger << '.';
                }
            }

            Logger << "\n" << std::hex << std::setw( 4 ) << std::setfill( '0' ) << i << std::dec << std::setw( 0 ) << "   ";
        } else if ( i % 16 == 8 ) {
            Logger << ' ';
        }

        Logger << std::hex << std::setw( 2 ) << std::setfill( '0' ) << ( int( buf[i] ) & 0xFF ) << ' ';
        Logger << std::dec << std::setw( 0 );

        if ( i == len - 1 ) {
            int remaining = 16 - ( len % 16 );
            int fill = ( remaining * 3 ) + 2;

            if ( remaining >= 8 ) {
                ++fill;
            }

            for ( int j = 0; j < fill; ++j ) {
                Logger << ' ';
            }

            int line = ( i - ( ( len % 16 ) - 1 ) ) / 16 ;

            for ( int k = 0; k < ( len % 16 ); ++k ) {
                char c = buf[line * 16 + k];

                if ( c >= 32 && c <= 126 ) {
                    Logger << c;
                } else {
                    Logger << '.';
                }
            }
        }
    }

    Logger << "\n\n";
}

int ( WINAPI *Real_Send )( SOCKET s, const char *buf, int len, int flags ) = send;
int ( WINAPI *Real_Recv )( SOCKET s, char *buf, int len, int flags ) = recv;
int ( WINAPI *Real_RecvFrom )( SOCKET s, char *buf, int len, int flags, sockaddr *from, int *fromlen ) = recvfrom;
int ( WINAPI *Real_WSARecvEx )( SOCKET s, char *buf, int len, int *flags ) = WSARecvEx;

int WINAPI Mine_Send( SOCKET s, const char* buf, int len, int flags );
int WINAPI Mine_Recv( SOCKET s, char *buf, int len, int flags );
int WINAPI Mine_RecvFrom( SOCKET s, char *buf, int len, int flags, sockaddr *from, int *fromlen );
int WINAPI Mine_WSARecvEx( SOCKET s, char *buf, int len, int *flags );

int WINAPI Mine_Send( SOCKET s, const char *buf, int len, int flags ) {
    Logger << TimeToString() << ": Client -> Server (Length: " << len << " bytes)\n\n";
    LogPacket( buf, len );
    Logger << std::endl;

    return Real_Send( s, buf, len, flags );
}

int WINAPI Mine_Recv( SOCKET s, char *buf, int len, int flags ) {
    Logger << TimeToString() << ": Server -> Client (Length: " << len << " bytes)\n\n";
    LogPacket( buf, len );
    Logger << std::endl;

    return Real_Recv( s, buf, len, flags );
}

int WINAPI Mine_RecvFrom( SOCKET s, char *buf, int len, int flags, sockaddr *from, int *fromlen ) {
    Logger << TimeToString() << ": Server -> Client (Length: " << len << " bytes)*\n\n";
    LogPacket( buf, len );
    Logger << std::endl;

    return Real_RecvFrom( s, buf, len, flags, from, fromlen );
}

int WINAPI Mine_WSARecvEx( SOCKET s, char *buf, int len, int *flags ) {
    Logger << TimeToString() << ": Server -> Client (Length: " << len << " bytes)**\n\n";
    LogPacket( buf, len );
    Logger << std::endl;

    return Real_WSARecvEx( s, buf, len, flags );
}

BOOL WINAPI DllMain( HINSTANCE, DWORD dwReason, LPVOID ) {
    switch ( dwReason ) {
        case DLL_PROCESS_ATTACH:    
            Logger.open( "C:\\Packets.txt", std::ios::out | std::ios::app | std::ios::ate );

            if ( Logger.tellp() > 0 ) {
                Logger << "\n\n\n";
            }

            Logger << "##\n## Logging Started (" << NowToString() << ")\n##\n\n\n";

            DetourTransactionBegin();
            DetourUpdateThread( GetCurrentThread() );
            DetourAttach( &(PVOID &)Real_Send, Mine_Send );
            DetourAttach( &(PVOID &)Real_Recv, Mine_Recv );
            DetourAttach( &(PVOID &)Real_RecvFrom, Mine_RecvFrom );
            DetourAttach( &(PVOID &)Real_WSARecvEx, Mine_WSARecvEx );
            DetourTransactionCommit();

            break;

        case DLL_PROCESS_DETACH:
            Logger << "##\n## Logging Stopped (" << NowToString() << ")\n##";
            Logger.close();

            DetourTransactionBegin();
            DetourUpdateThread( GetCurrentThread() );
            DetourDetach( &(PVOID &)Real_Send, Mine_Send );
            DetourDetach( &(PVOID &)Real_Recv, Mine_Recv );
            DetourDetach( &(PVOID &)Real_RecvFrom, Mine_RecvFrom );
            DetourDetach( &(PVOID &)Real_WSARecvEx, Mine_WSARecvEx );
            DetourTransactionCommit();

            break;
    }

    return TRUE;
} 
```

有任何想法吗？

**编辑：**所以我也连接了 recvfrom() 和 WSARecvEx()，但它仍然没有记录传出的数据包！我已经用我的确切代码更新了我的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T13:20:54.680

要有效地使用挂钩，您需要确保真正挂钩所有相关端点或至少确保最终从所有端点调用的公分母。
在`recv()`我认为应用程序实际调用的情况下`WSARecv()`。
您可以使用[depends.exe](http://www.dependencywalker.com/)准确找出应用程序/库从Ws2_32.dll 导入哪些函数，以了解您需要挂钩哪些函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-03T02:09:03.130

好吧，几个月后我想通了：当我应该挂钩 WinSock 1.1 的 send()/recv() 时，我正在挂钩 WinSock 2 函数！

# c# - 构造函数初始化器不允许我使用“this”

> ID：802317
> 
> 赞同：0
> 
> 时间：2009-04-29T13:13:12.873
> 
> 标签：c#, inheritance, constructor

编译器错误关键字“this”在当前上下文中不可用

```
delegate void CallBack(int i);
class A
{
    public A(CallBack cb) { }
}
class B : A
{        
    public B() : base(new CallBack(this.f)){}

    private void f(int i) { }
} 
```

为什么会出现这个错误？作为一种解决方案，我想在 A() 中提供一个无参数的受保护 ctor 并拥有

```
class B : A
{
     public B() : base()   // inherit the new A() ctor
     {
          base.cb = new CallBack(this.f); //this is allowed here
     }
     //...
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T13:15:15.273

这是因为在基类构造函数运行之前还没有创建“this”。在您的第二个示例中，基本构造函数已经完成，现在“this”有了意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:16:13.350

在第一个示例中，B 实例尚未初始化。在第二个，它是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:16:15.987

由于对象尚未（完全）构造，即基本构造函数尚未运行，`this`因此在那里不可用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T13:27:07.520

您应该使用抽象/虚拟方法。

```
abstract class A {
    A() {
        this.Initialize();
    }

    abstract void Initialize() { }
}

class B : A {
    string Text;

    B() { }

    override void Initialize() {
        this.Text = "Hello world";
    }
} 
```

# c# - Wpf DataGrid：在运行时更改 XML 字段绑定

> ID：802322
> 
> 赞同：1
> 
> 时间：2009-04-29T13:14:17.520
> 
> 标签：c#, wpf, data-binding, datagrid

我正在开发一个用于显示部分 XML 文件的**WPF 用户控件。**我试图使用户控件灵活，以便我可以从控件外部分配列标题和字段数据绑定。

我发现我可以轻松更改列标题，但是虽然以下代码似乎有希望，但 SertMemberPath 不会更改字段绑定

```
public void ChangeColumnDefinitions ( List<XmlGridColumnDefinition> columns )
{
     int columnnum = 0;

     foreach ( XmlGridColumnDefinition column in columns )
     {
         this.datagrid.Columns[columnnum].Header = column.Heading;
         this.datagrid.Columns[columnnum].SortMemberPath = string.Format ( "Element[{0}].Value", column.FieldName );
            ++columnnum;
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:00:18.130

环顾四周后，我[在 SO 上找到了@Generic_Error 的这个问题和答案](https://stackoverflow.com/questions/320089/how-do-i-bind-a-wpf-datagrid-to-a-variable-number-of-columns/343447#343447)。我稍微修改了他的代码，这是我想出的，我可以进一步定制。

```
public void ChangeColumnDefinitions ( IEnumerable<XmlGridColumnDefinition> columns )
{
    this.datagrid.Columns.Clear ();

    foreach ( var column in columns )
    {
            DataGridTextColumn coldef = new DataGridTextColumn
            {
                    Header = column.Heading,
                    Binding = new Binding ( string.Format ( "Element[{0}].Value", column.FieldName ) )
            };

            this.datagrid.Columns.Add ( coldef );
    }
} 
```

# linq - 如何在 LINQ 中结合 Where 子句和 group by

> ID：802329
> 
> 赞同：15
> 
> 时间：2009-04-29T13:16:33.087
> 
> 标签：linq

谁能帮我将以下代码转换为 LINQ？

```
Select Catg,Count(*)  From Mycatg  where IsPublic=1 or FirstName='XXX' Group By Catg  . 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-29T13:19:59.410

在 C# 中，类似：

```
var query = from category in mycatg
            where category.IsPublic == 1
               || category.FirstName == "XXX"
            group 1 by category.Catg into grouped
            select new { Catg = grouped.Key,
                         Count = grouped.Count() }; 
```

“1”的投影清楚地表明，我们所需要的只是分组的键和计数——每个分组中的单个条目是不相关的。

使用 lambda 语法和点表示法：

```
var query = mycatg.Where(category => category.IsPublic == 1
                         || category.FirstName == "XXX")
                  .GroupBy(category => category.Catg,
                           category => 1)
                  .Select(grouped => new { Catg = grouped.Key,
                                           Count = grouped.Count() }); 
```

# asp.net - 第三方组件对文件系统进行无证使用是否司空见惯/合适？

> ID：802330
> 
> 赞同：0
> 
> 时间：2009-04-29T13:16:51.167
> 
> 标签：asp.net, pdf, components

我一直在使用两个第三方组件来生成 PDF 文档（在 .NET 中，但我认为这是一个独立于平台的主题）。我暂时不会提及公司的名称，但我会说，他们**并不是**非常知名的供应商。

我发现这两种产品都对文件系统进行了**无证**使用（即将临时文件放在磁盘上）。这在我的 ASP.NET Web 应用程序中给我带来了一个问题，因为我现在必须识别文件位置并根据需要设置它们的权限。由于我的 Web 应用程序设置为使用 Windows 身份验证进行模拟，这实际上意味着我必须为我的 Web 服务器上的几个文件位置分配写权限。

没什么大不了的，一旦我弄清楚组件出现故障的原因，但是......我认为这是一个维护问题。当我们将服务器升级到某些更改临时文件位置之一的操作系统时会发生什么？如果供应商决定更改临时文件位置会怎样？我们的应用程序将“中断”而不更改我们的代码行。相关，但是如果我们必须在“新”机器（无论环境如何）中运行此应用程序，我们必须了解此问题并适当地设置权限。

不幸的是，这些组件没有提供使这个临时文件路径“可配置”的方法，这肯定至少可以更明确地说明幕后发生的事情。

这不是我需要回答的问题，而是更多地开始讨论这些组件供应商的做法是否合适，应该如何记录/传达给用户等。

想法？意见？注释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:25:20.630

首先，我想问一下这些 PDF 生成工具是否设计为在 ASP.NET 应用程序中运行。他们是否声称这是他们支持的东西？如果是这样，那么他们应该提供有关他们如何使用文件系统以及他们需要什么权限的文档。

如果没有，那么您可能使用了不合适的工具集。我来过这里并做到了。我参与了一个使用“众所周知的地址查找工具”的项目，但我们使用的版本是为桌面应用程序设计的。因此，它不是为处理 100 个请求而编写的——许多请求是同时发生的——并且它导致了各种难以重现的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:29:27.920

平凡？是的。合适的？通常不会。

临时文件是恕我直言的适当用途之一，只要它们使用正确的 %TEMP% 文件夹，甚至更好，使用集成的 Path.GetTempPath/Path.GetTempFileName 函数。

在理想的世界中，每个第三方组件都附带一个代码访问安全描述，详细列出需要什么（以及用于什么目的），但 CAS 可能是 .net 中最被忽视的功能之一......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:30:22.240

写入临时文件不会被视为超出任何软件的正常功能。除非它正在将临时文件写入一个非常奇怪的地方，否则这似乎更有可能是他们从未想过要记录的东西，而不是特意给你带来麻烦。我会简单地联系供应商解释你在做什么，并询问他们是否可以提供文件。

Martin 还提出了一个很好的观点，即它是应该与 Asp.net 一起运行的应用程序还是桌面应用程序。

# java - 在将大类重构为小类之前，您是否查看方法使用了哪些变量？

> ID：802339
> 
> 赞同：3
> 
> 时间：2009-04-29T13:20:31.173
> 
> 标签：java, eclipse-plugin, refactoring

我有兴趣探索方法和它们使用的成员变量之间的关系可以暗示如何将类分解成更小的部分。这个想法是一组变量将与一个职责密切相关，并且应该根据 SRP 包含在一个类中。

举一个简单的例子，一个类，例如：

```
public class Rectangle {
  private int width; 
  private int height;
  private int red,green,blue;
  public int area() { return width * height; }
//just an example, didn't check the api.
  public Color color () { return new Color (red, green, blue); } 
} 
```

应该重构为：

```
public class Rectangle {
  private Dimension size;
  private Color color;
  ...
} 
```

因为分解将是：

面积：宽、高颜色：红、绿、蓝

由于这些变量在相同的方法中使用，它们显然是相关的，并且可以成为自己的一个类。我知道这个例子可能太微不足道了，但请耐心等待并尝试在这里思考更大的问题。如果其他方法也使用这些变量，它们很可能也是相关的，也可以移动到新类中。

只是为了好玩，我[为 Eclipse 创建了一个小插件来](http://willcodejavaforfood.com/vu.html)尝试这样做。它将分解方法->变量，变量->方法，并尝试将方法组合在一起，然后直接或间接使用变量。

这是您在编码时所做的事情，它真的有用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:50:00.133

我不能说这是我在编码时考虑过的事情。是的，它可能会带来一些改进，但我认为你会发现自己在实践中所做的是创建大量的类，这些类会更难处理。

不过，作为“代码气味”，它可能有一些优点。如果您看到一个包含大量成员变量的类，并且大多数仅由少数方法使用，那么这通常是一个不好的迹象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:25:22.780

我可以想象一种情况，这是一种合理的代码气味。我们示例中的简单 setter/getter 并不太有说服力。例如，重构只会产生一个更复杂的对象，其中包含 a 和 b：

```
public class A {
  private String a1;
  public void aMeth () {
     print(a1);
  }
}
public class B {
  private String b1;
  public void bMeth () {
     print(b1);
  }
}

public class A { 
  private A a;
  private B b;
  ... insert infinite regress 
} 
```

但是，我可以将此视为指南，其中您将变量集纠缠到大怪物类中，其中变量分组对应于概念分解。你想更多这样的事情吗？

```
public class Rectangle {
  private int width; 
  private int height;
  private int red,green,blue;
  public int area() { return width * height; }
//just an example, didn't check the api.
  public Color color () { return new Color (red, green, blue); } 
} 
```

矩形应该有尺寸和颜色。在我看来，如果您可以清楚地找到仅相互纠缠的私有变量集，那将是一件有用的事情，只要您省略非纠缠变量（即，如果您将变量视为图形顶点，我认为您想检测连接的子图，但忽略大小为 1 的子图）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:15:46.483

我认为每个类都应该按照它的作用来组织，而不是它会使用什么变量。我建议让每个班级都有一个目的（单一责任原则）。不是根据变量的使用来分解事物，而是根据它们的职责或目的来分离类。

在我看来，编写干净的代码不仅在于代码看起来有多好，而且在于它是否易于阅读。代码应按逻辑分组并具有一致的风格。请记住，某些类不会使用所有变量。在 java 中，你有 mutator 和 accessor 方法。这些方法用于获取或设置单个变量。

例子：

```
public class Rectangle {

    private int lenght = 0;
    private int width = 0;

    public Rectangle (int length, width)
        {
        this.length = length;
        this.width = width;
    }

    public int getLength(int length)
    {
        return length;
    }

    public int getWidth(int width)
    {
        return wdith;
    }

    public void setLength(int length)
    {
        this.length = length;
    }

    public void setWidth(int width)
    {
        this.width = width;
    }
} 
```

我不会把这个类分成一个 RectangleLength 和 RectangleWidth 类。这些方法有一个单一的职责，那就是表示一个矩形。如果此类包含数学函数，您可能希望将其分解为 RectangleGeometry 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T14:26:21.997

我已经做到了。甚至创建了一个表，方法在第一列下方，实例变量在顶部，用 X 表示哪个使用哪个。然后排序 - 有点像热图排序，但更随意，更手动 - 查看哪些变量和哪些方法一起跟踪。它有效并且很有帮助。但这在我的花招中很深；我只是很少使用它。我得看看你的插件；如果这样做的工作更少，我可能会做得更多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-04T16:05:53.917

This is certainly a good refactoring approach. In *[Working Effectively With Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0131177052)*, Michael Feathers describes a technique for this in a section called **Seeing Responsibilities**:

> **Heuristic #4 Look for Internal Relationships**
> 
> Look for relationships between instance variables and methods. Are certain instance variables used by some methods and not others?

He then goes on to describe a method where you draw a diagram called a *feature sketch*, which is a graph showing the methods of a class and internal method calls. From the diagram, you can easily visually identify clusters of interconnected method calls which are candidates for refactoring into a new, more cohesive class.

It would be very cool if your Eclipse plugin could quickly generate a graph as described in the book - I could see that as being a useful refactoring tool.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T13:24:48.027

听起来有人读过[得墨忒耳法则，](http://en.wikipedia.org/wiki/Law_of_Demeter)并试图将其发挥到极致。不得不说，我对“解耦”的狂热者总是怀有一定的戒心，尤其是因为有些人在设计上确实提倡“零耦合”，而忽略了一个事实，那就是没有任何耦合，一个系统是没有用的。

尽管如此，减少代码中的依赖关系使得测试更容易，并且对其他重构更有弹性，而且我发现它往往会导致更简单、更明显的代码。健康的平衡是努力的目标。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-29T14:13:17.193

总体而言，这似乎是一个坏主意。

首先，一个类表示相关数据和/或方法的集合。它根本不需要任何方法来仍然是一个有用的类。为了获得良好的封装，您可能需要 getter 和 setter；根据定义，这些方法不会访问多个变量。这并不意味着这些变量是否属于同一类。

最后，如果方法提供了一种方法来操作类、计算有关自身的一些信息、构造类等，则该方法属于该类；一个方法可能属于一个类但不能访问大多数成员变量的原因有很多。然后是静态方法；根据定义，这些应该在其他类中吗？

如果一个类中的概念太多，则应将其拆分。但这些概念只是松散地映射到方法和变量。计算变量使用是一种使您的类层次结构过于复杂而没有任何好处的可靠方法。

# algorithm - 如何编写自定义漂亮的打印机

> ID：802340
> 
> 赞同：13
> 
> 时间：2009-04-29T13:20:35.760
> 
> 标签：algorithm, pretty-print

在我的职业生涯中经常出现的一个问题是我有某种数据结构（可能是 s 表达式），我想以人类可读的形式打印它，并带有合理的缩进选择。

是否有书籍或博客文章描述了如何优雅地做到这一点？我对算法感兴趣的不仅仅是一个特定的库。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-29T13:31:50.007

S-Exps 等价于树结构，如果你可以漂亮地打印一棵树，你就可以漂亮地打印一个 s-exp。

例如，比较：

```
(tree
    (value 89)
    (tree
        (value 9)
        nil
        nil)
    (tree
        (value 456)
        nil
        nil)) 
```

到：

```
89
 +- 9
 +- 456 
```

该算法是相同的，唯一的区别是您要打印的周围数据的数量。

[本文](http://homepages.inf.ed.ac.uk/wadler/papers/prettier/prettier.pdf)描述了一种用于漂亮打印树的算法

[这个](ftp://reports.stanford.edu/pub/cstr/reports/cs/tr/79/770/CS-TR-79-770.pdf)描述了一种用于编程语言的漂亮打印机

# svn - Subversion：即使所有开发人员都运行相同的 svn 版本，也会出现“客户端太旧”

> ID：802348
> 
> 赞同：7
> 
> 时间：2009-04-29T13:22:09.373
> 
> 标签：svn, tortoisesvn

我们正在使用 Subversion 来跟踪我们的代码。作为构建过程的一部分，一些 AssemblyInfo.cs 文件由构建脚本临时编辑，并且在构建完成后它们被恢复（也由构建脚本）。但是，我们的一位开发人员在尝试还原时收到此消息：

> 客户端太旧，无法使用工作副本“路径”。您需要获得更新的 Subversion 客户端，或降级此工作副本。

我们都在运行相同版本的 Subversion (1.5.1)。开发人员设置之间的唯一区别是遇到问题的用户使用的是更高版本的 TortoiseSVN（1.6.0，而不是其他版本的 1.5.x），而我们一直在运行 Subversion 1.5.1存储库已存在。

您对问题可能是什么有任何暗示？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T13:32:22.470

每当任何颠覆客户端触及工作副本时，它所做的第一件事就是将该工作副本静默更新到其版本。

TortoiseSVN 会做到这一点，使其他 subversion 客户端无法可靠地读取工作副本。

这适用于所有版本中的所有颠覆客户端（到目前为止）。命令行、乌龟、subclipse、ankh、rapidsvn - 都表现相同。

有一个 python 脚本可以降级工作副本，或者您可以将其废弃并重新开始新的结帐。请参阅[发行说明的兼容性部分](http://subversion.tigris.org/svn_1.6_releasenotes.html)。

Tortoise 通常遵循它使用的 subversion 客户端的主要版本号。

编辑：

在您的情况下，您使用 2 个客户端 - 乌龟和构建脚本中的命令行。在更新到最新版本之前，构建脚本将无法工作。

我们自己也有这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T13:25:20.583

TortoiseSVN 1.6 使用比 1.5 更新版本的 subversion 客户端。这可能是导致您的错误的原因。

另一种可能性是构建脚本正在使用不同的客户端。

# winforms - Windows 窗体：带有历史记录的文本框

> ID：802357
> 
> 赞同：4
> 
> 时间：2009-04-29T13:27:09.237
> 
> 标签：winforms, textbox, history, edit

有人知道像浏览器地址栏一样的 Windows 窗体控件吗？

它就像一个文本框，但右侧有一个下拉菜单，显示以前输入的文本的历史记录。

多谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T13:34:29.703

查看 TextBox 类的属性“AutoCompleteCustomSource”、“AutoCompleteMode”和“AutoCompletesource”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:29:49.777

您可以为此使用 ComboBox。只需将以前的条目添加到项目列表中。如果您真正想要的是 AutoComplete，WinForms TextBox 控件本身就支持它。

# objective-c - 说指针的值是内存地址对吗？

> ID：802363
> 
> 赞同：0
> 
> 时间：2009-04-29T13:29:13.680
> 
> 标签：objective-c, pointers

据我了解（或认为我了解），作为指针的变量仅在其值中存储一个内存地址。

让我们说：

```
int x = 5;
NSString *str1 = [NSString stringWithCString:"one"]; 
```

那么 x 的值为 5。这就是我在调试器中放置断点时看到的内容。

但：

str1 的值不是“一”。这是一个类似 bfffd3d0 的内存地址。当我停在那里时，这就是我在调试器的“值”字段中看到的内容。所以在这个 bfffd3d0 内存地址后面是 NSString 对象，它具有巨大的数据结构（假设它是巨大的）、大量的实例变量、值等等。这几乎是对的吗？

我不是在谈论变量名本身的内存，而是关于变量“引用”或指向、或存储或其他任何内容的值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T13:30:13.193

你是绝对正确的，是的。

“在这个 bfffd3d0 内存地址后面是 NSString”可能更好地说是“**在**这个 bfffd3d0 内存地址......”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:07:02.713

或多或少，我会在这里迂腐。就像你说的，值`str1`是存储“一”的位置，而不是“一”本身。

但是，由于几个原因，它并不完全是内存地址。首先，您的应用程序在虚拟内存上工作的硬件原因，因此它甚至从未看到实际的内存地址。该值（比如`0xbfffd3d0`）只是实际内存地址已映射到的虚拟内存地址。它甚至可能根本不对应于内存地址。它可能未映射（因此访问此地址会给您带来分段错误/访问冲突，或者它可能是内存映射并由文件或硬件设备支持。写入此“地址”可能实际上并不将数据写入内存，而是向 GPU 发送信号。

其次，语言律师的原因：指针不是地址。有些操作对地址有效，但对指针未定义。NULL 指针可能指向除 0 以外的其他地址。不指向同一数组的指针可能不会进行相等性比较，即使在内存地址上这样做非常有意义。

[此链接](http://ventspace.wordpress.com/2008/10/06/c-versus-reality/)更详细地介绍了这种情况（特别是对于 C++，但对于 C 和 obj-C 基本相同。）

但简短的回答是，指针被设计成可以由编译器*实现为（虚拟）内存地址。*因此在实践中，它们的行为往往相同，但存在*差异*，并且假设指针*只是*一个内存地址会在某些时候导致错误。

在您询问的情况下，您是完全正确的，指针变量存储可以找到数据的位置，而不是数据本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T13:33:28.177

是的，这是一个足够接近的描述。

关于你的[另一个问题](https://stackoverflow.com/questions/802270/how-can-i-print-out-the-memory-adress-of-an-variable)，有效地调用`NSLog`将变量的地址传递到堆栈上，但是`@"%x"`告诉`NSLog`将该地址解释为整数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T13:34:21.060

您将其标记为objective-c，但“指针”不仅仅特定于objective-c。其他语言（如 C++）也有指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T13:35:51.963

如果内存地址是指 RAM，那么它并不完全正确。指针可以包含映射设备（例如视频卡、网卡等）的地址。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T14:09:28.857

据我了解，指针指向内存地址，可以通过取消引用指针来获得在该地址保存的值

```
int number = 14;
int* ptrNumber = &number; //the value of the pointer is now the address of number

int n=*ptrNumber; //pointer was dereferenced, so n is now the value at the address of ptrNumber (n = 14) 
```

# asp.net - 在构建时防止 UNC Share 错误

> ID：802372
> 
> 赞同：2
> 
> 时间：2009-04-29T13:31:30.460
> 
> 标签：asp.net, visual-studio-2008, hosting, unc

在工作中，我们的开发服务器上托管了一堆站点。包含所有这些站点的文件夹被映射为网络驱动器。

在 VisualStudio 中，我将站点的根目录作为网站打开，当我构建站点时，我总是会收到此错误。

> 错误 4 加载配置文件时出错：无法开始监视对“I:\Sitename\wwwroot\”的更改，因为已达到网络 BIOS 命令限制。有关此错误的详细信息，请参阅 Microsoft 知识库文章 810886。Windows XP 平台不支持在 UNC 共享上托管。我：\站点名\wwwroot\web.config

我已经查看了知识库文章并进行了它建议的注册表更改，但这并没有帮助。

有谁知道对此的修复或解决方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-24T23:19:18.193

不要使用映射驱动器，而是使用完整的 UNC 路径，并让您当前登录的用户访问该路径： `\\MachineName\Sitename\wwwroot\web.config`

很有可能你会得到不同的效果，特别是如果映射的驱动器正在使用不同的凭据进行映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-10T21:06:49.710

看看这个修补程序：http: [//support.microsoft.com/kb/911272](http://support.microsoft.com/kb/911272)

它解决了问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-21T05:32:52.900

使用该修补程序更改 FCNMode 并不总能解决问题。

我在这里对这个问题做了一个非常详细的回答：[https ://stackoverflow.com/a/20710473/705198](https://stackoverflow.com/a/20710473/705198)

这个答案是我能找到的关于这个主题的所有 technet、msdn 和博客参考资料的积累，以及我们最终必须做些什么来解决这个问题。禁用巨型帧（HP 服务器 NIC 问题导致另一个错误）和 SMB2+ 结合注册表编辑最终为我们节省了高流量 IIS 站点。仅注册表编辑就可以做到这一点，因此网络 BIOS 限制错误在正常负载下不会显示得那么快。

# php - 如何在MYSQL中对单个查询中的记录进行计数和限制？

> ID：802373
> 
> 赞同：18
> 
> 时间：2009-04-29T13:31:33.533
> 
> 标签：php, mysql, count

我正在搜索表中的记录，如下所示：

```
SELECT Id, Name FROM my_table WHERE Name LIKE '%prashant%' LIMIT 0, 10; 
```

现在，我添加 LIMIT 来维护我的分页。但是当用户搜索“prashant”这个词时，我拥有的“prashant”的总记录是 124 条。但是由于对查询的限制，所以它只在我的 PHP 脚本中获取 10 条记录，当我计算 PHP 代码中的 mysql 变量时，它返回的总记录数是 10。

所以基本上我想使用单个查询来计算和限制，通过在上面的查询中进行一些修改，我想要记录的总数（124）。我不想运行单独的 count(*) 查询来计算查询找到的总结果。

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-29T13:35:37.720

```
SELECT SQL_CALC_FOUND_ROWS
  Id, Name
FROM my_table
WHERE
  Name LIKE '%prashant%'
LIMIT 0, 10;

# Find total rows
SELECT FOUND_ROWS(); 
```

[更多信息](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T13:38:29.583

[`SQL_CALC_FOUND_ROWS`](https://dev.mysql.com/doc/refman/5.6/en/information-functions.html#function_found-rows)MySQL 支持使用Ionut 提到的执行此操作。然而，事实证明，[在许多情况下](http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/)，使用两个语句（其中一个是常规的`count()`. 然而，这确实要求可以使用索引扫描来完成计数，对于这个查询来说，情况并非如此，但我想我还是会提到它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-05T22:39:04.787

这是为其他有同样需要的人准备的（考虑到这个问题已经过去了 3 年）。

我有一个类似的问题，我不想创建 2 个查询。所以我所做的是为总数创建一个额外的列，并在最后移动`LIMIT`and`OFFSET`子句：

```
SELECT SQL_CALC_FOUND_ROWS * FROM (
    SELECT `id`, `name`
    FROM `my_table`
    WHERE `name` LIKE '%prashant%'
) res,
(SELECT /*CEIL(FOUND_ROWS()/10) AS 'pages',*/ FOUND_ROWS() AS 'total') tot
LIMIT 0, 10 
```

所以结果是这样的

```
| id  |      name      | total |
+-----+----------------+-------+
|  1  | Jason Prashant |  124  |
|  2  | Bob Prashant   |  124  |
|  3  | Sam Prashant   |  124  |
|  4  | etc. prashant  |  124  | 
```

我认为这个解决方案在时间上没有缺点，因为它只获取一次结果，然后将**已经计算**的行数用于附加列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-07T12:43:50.433

如果表很大并选择多个字段（不仅仅是您的示例中的 ID、名称），我建议使用 2 个查询。首先使用所有这些 WHERE 子句选择 count(0)，然后才构建分页、选择数据等。例如，它在一些流行的电子商务网站上会运行得更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-13T03:35:27.380

不要使用 SQL_CALC_FOUND_ROWS 和 FOUND_ROWS()

1.  这里报告了错误
    ： https://bugs.mysql.com/bug.php?id=18454 和这里：[https :](https://bugs.mysql.com/bug.php?id=18454) [//bugs.mysql.com/bug.php?id=19553](https://bugs.mysql.com/bug.php?id=19553)

2.  而在小表上，BENCHMARK 更多地依赖于其他事物，因此您的 SELECT 所花费的时间将与 COUNT(0) 大致相同 - SQL_CALC_FOUND_ROWS 仍然限制 LIMIT 和 ORDER BY 数据库优化，因此如果您依赖它们**，请不要使用**SQL_CALC_FOUND_ROWS

3.  在大型表上，BENCHMARK 差异变得很大，其中 COUNT(0) 可能需要 0.003 秒相同的 SQL_CALC_FOUND_ROWS 现在可能需要 20 秒

从所有指标来看，COUNT(0) 是最佳选择

计数(0) 语法：

```
(SELECT COUNT(0) FROM tableNames WHERE condition) AS alias
// alias is optional but needed if you need to use the result later 
```

所以你的总查询看起来像这样

```
(SELECT COUNT(0) FROM my_table WHERE name LIKE '%prashant%') AS countResults;

SELECT Id, Name FROM my_table WHERE Name LIKE '%prashant%' LIMIT 0, 10; 
```

然后只需在其他地方需要它的任何地方调用 countResults ......

使用 COUNT(0) 的另一个优点是您可以使用它来搜索与此处相同的表，也可以使用它来搜索不同的表...

因此，例如，如果找到的每个人也分别有 3、2、1、5 个不同的工作......你可以添加一个

```
(SELECT COUNT(0) FROM my_jobs_table WHERE name = name_row_in_jobs_table) AS jobs 
```

像这样在你原来的 SELECT 里面

```
SELECT Id, Name (SELECT COUNT(0) FROM my_jobs_table WHERE name = name_row_in_jobs_table) AS jobs FROM my_table WHERE Name LIKE '%prashant%' LIMIT 0, 10; 
```

给你：

```
--------------------
| id | Name | jobs |
--------------------
| 1  | Alice| 3    |
--------------------
| 2  | John | 2    |
--------------------
| 3  | Bob  | 1    |
--------------------
| 4  | Jill | 5    |
-------------------- 
```

因此，当显示 name[3]（即 Bob）时，您还可以通过调用 jobs[3] 来显示 Bob 有 1 份工作...

# xslt - How to limit string word count in XSLT 1.0?

> ID：802374
> 
> 赞同：3
> 
> 时间：2009-04-29T13:31:40.240
> 
> 标签：xslt, string

How can I limit a string's word count in XSLT 1.0?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T13:42:27.580

How about something like:

```
 <xsl:template match="data"> <!-- your data element or whatever -->
    <xsl:call-template name="firstWords">
      <xsl:with-param name="value" select="."/>
      <xsl:with-param name="count" select="4"/>
    </xsl:call-template>
  </xsl:template>

  <xsl:template name="firstWords">
    <xsl:param name="value"/>
    <xsl:param name="count"/>

    <xsl:if test="number($count) >= 1">
      <xsl:value-of select="concat(substring-before($value,' '),' ')"/>
    </xsl:if>
    <xsl:if test="number($count) > 1">
      <xsl:variable name="remaining" select="substring-after($value,' ')"/>
      <xsl:if test="string-length($remaining) > 0">
        <xsl:call-template name="firstWords">
          <xsl:with-param name="value" select="$remaining"/>
          <xsl:with-param name="count" select="number($count)-1"/>
        </xsl:call-template>
      </xsl:if>
    </xsl:if>
  </xsl:template> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T17:04:25.877

**This is an XSLT 1.0 solution**:

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>

   <xsl:import href="strSplit-to-Words.xsl"/>

   <xsl:output indent="yes" omit-xml-declaration="yes"/>

    <xsl:template match="/">
      <xsl:variable name="vwordNodes">
        <xsl:call-template name="str-split-to-words">
          <xsl:with-param name="pStr" select="/"/>
          <xsl:with-param name="pDelimiters" 
                          select="', &#9;&#10;&#13;()-'"/>
        </xsl:call-template>
      </xsl:variable>

      <xsl:call-template name="strTakeWords">
        <xsl:with-param name="pN" select="10"/>
        <xsl:with-param name="pText" select="/*"/>
        <xsl:with-param name="pWords"
             select="ext:node-set($vwordNodes)/*"/>
      </xsl:call-template>
    </xsl:template>

    <xsl:template match="word" priority="10">
      <xsl:value-of select="concat(position(), ' ', ., '&#10;')"/>
    </xsl:template>

    <xsl:template name="strTakeWords">
      <xsl:param name="pN" select="10"/>
      <xsl:param name="pText"/>
      <xsl:param name="pWords"/>
      <xsl:param name="pResult"/>

      <xsl:choose>
          <xsl:when test="not($pN > 0)">
            <xsl:value-of select="$pResult"/>
          </xsl:when>
          <xsl:otherwise>
            <xsl:variable name="vWord" select="$pWords[1]"/>
            <xsl:variable name="vprecDelims" select=
               "substring-before($pText,$pWords[1])"/>

            <xsl:variable name="vnewText" select=
                "concat($vprecDelims, $vWord)"/>

              <xsl:call-template name="strTakeWords">
                <xsl:with-param name="pN" select="$pN -1"/>
                <xsl:with-param name="pText" select=
                      "substring-after($pText, $vnewText)"/>
                <xsl:with-param name="pWords" select=
                     "$pWords[position() > 1]"/>
                <xsl:with-param name="pResult" select=
                 "concat($pResult, $vnewText)"/>
              </xsl:call-template>
          </xsl:otherwise>
      </xsl:choose>
    </xsl:template>

</xsl:stylesheet> 
```

**when this transformation is applied on the following XML document:**

```
<t>
(CNN) -- Behind closed doors in recent days,
senior White House aides have been saying that
measuring President Obama's first 100 days
is the journalistic equivalent of a Hallmark holiday.
</t> 
```

***the wanted result is returned*:**

**`(CNN) -- Behind closed doors in recent days, senior White House`**

**Do note**:

1.  **The** [**`str-split-to-words`**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/strSplit-to-Words.xsl?view=markup) **template from** [**FXSL**](http://fxsl.sf.net) **is used** for tokenization.

2.  This template accepts a parameter `pDelimiters` which is a string consisting of all characters that should be treated as delimiters. Thus, **in contrast with other solutions, it is possible to specify every delimiter** (and not just a "space") -- in this case 8 of them.

3.  **The named template `strTakeWords` calls itself recursively to accumulate the text before and including every word from the wordlist** produced by the tokenization, until the specified number of words has been processed.

# vba - 使用 VBA 从 Office 2007 功能区读取值

> ID：802376
> 
> 赞同：1
> 
> 时间：2009-04-29T13:31:52.033
> 
> 标签：vba, ms-word, ribbon, office-2007

使用 VBA，我可以找出 Word 2007 功能区上的文本（组合框）控件的值吗？

假设我想在“主页”选项卡中阅读当前选择的字体名称。

我见过一个使用[`IAccessible`](http://msdn.microsoft.com/en-us/library/accessibility.iaccessible.aspx)接口与功能区*进行*交互的示例（即枚举它），但似乎无法读取控件值。有没有其他方法可以做到这一点，或者 VBA 是否完全被锁定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-16T14:49:12.323

我认为您无法在功能区上阅读内置属性。对于您的字体名称的具体示例，您可以使用以下内容。

`Msgbox Application.Commandbars.Findcontrol(ID:=1728).Text`

您也许可以调整该方法以获取其他信息。

# javascript - 将 JQuery UI Datepicker 与来自 Jquery UI 主题的图标一起使用

> ID：802379
> 
> 赞同：30
> 
> 时间：2009-04-29T13:32:40.130
> 
> 标签：javascript, css, jquery-ui

我有一个使用 JQuery UI 的 datepicker 控件设置，我还使用了 JQuery UI 主题，它提供了一堆我想要使用的默认图标。

DatePicker 允许指定特定图像，即：

```
<script type="text/javascript">
  $(document).ready(function() {
    $("#DateFrom").datepicker({ showOn: 'button', buttonImageOnly: true, buttonImage: 'images/ui-icon-calendar.png' });
  });
</script> 
```

要显示图标集中的图标，您可以使用以下内容：

```
<span class="ui-icon ui-icon-calendar"></span> 
```

是否可以轻松地将两者结合起来，或者我只需要手动修改样式/图像？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-10-06T14:24:28.340

我这样做了

```
$("#DateFrom").datepicker({
    showOn: 'button'
}).next('button').button({
    icons: {
        primary: 'ui-icon-calendar'
    }, text:false
}); 
```

只需修改它在日历输入旁边插入的按钮。默认情况下，它们会在文本中抛出三个省略号，因此我也将其删除。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-01-05T09:48:29.247

我建议将图像放入输入

```
input.date_picker {
  text-align: center;
  background-image: url("images/ui-icon-calendar.png");
  background-position: right center;
  background-repeat: no-repeat;
  padding-right: 18px;
  width: 78px;
} 
```

像

![date_picker_example](https://i.stack.imgur.com/ERt2h.png)

*我使用了来自漂亮[探戈图标](http://commons.wikimedia.org/wiki/Tango_icons)项目的[这个图标，也可以在](http://upload.wikimedia.org/wikipedia/commons/7/71/X-office-calendar.svg)[png中找到](http://upload.wikimedia.org/wikipedia/commons/thumb/7/71/X-office-calendar.svg/200px-X-office-calendar.svg.png)*

好处：

*   独立于javascript
*   立即使用 DOM 加载
*   未来日期输入易于添加

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-29T13:55:03.977

恐怕您必须手动执行此操作。默认情况下，Datepicker 插件使用以下 HTML 插入指定的`buttonImage`:

```
<img title="..." alt="..." src="images/ui-icon-calendar.png" class="ui-datepicker-trigger"> 
```

顺便说一句，您可能想使用...

```
$(function() {
 // your code here
}); 
```

...代替...

```
$(document).ready(function() {
 // your code here
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T03:58:27.420

最好的方法是；

首先使用您已经使用过的javascript。

```
 <script type="text/javascript">
   $(document).ready(function() {
        $("#DateFrom").datepicker({ showOn: 'button', buttonImageOnly: true, buttonImage: 'images/ui-icon-calendar.png' });
   });
 </script> 
```

然后，添加以下css代码；

```
<style type="text/css">
.ui-datepicker-trigger
{
        padding:0px;
        padding-left:5px;
        vertical-align:baseline;

        position:relative;
        top:4px;
        height:18px;
}
</style> 
```

此 CSS 将帮助您根据需要正确对齐日历图像。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T21:00:23.183

只是对 Evs 的回答稍作跟进......（很大的帮助，谢谢 Evs ！）。

它也适用于 IE8，我添加了 CSS 来更改悬停时的光标：

```
button.date-picker-button-hidden:hover
{
    cursor: pointer; 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-24T14:52:30.583

[http://jqueryui.com/demos/datepicker/#icon-trigger](http://jqueryui.com/demos/datepicker/#icon-trigger)

提供了一个非常好的示例代码示例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-01T06:04:58.440

借用并扩展 Loktar 的答案，你可以尝试这样的事情，注意我只在 FF10 中测试过，但我不明白为什么它在其他浏览器中不起作用。

```
$('.date-picker').datepicker({showOn: 'button'})
    .next('button').addClass('date-picker-button-hidden')
    .after($('<span/>')
        .addClass('ui-icon').addClass('ui-icon-calendar').addClass('date-picker-icon')); 
```

请注意，在此示例中，*date-picker-button-hidden*和*date-picker-icon*是我自己的类，因为我不喜欢直接设置 jQuery CSS 类的样式。应用以下 CSS：

```
span.date-picker-icon
{
    display: inline-block;
    z-index: -1;
    position: relative;
    left: -16px;
}

button.date-picker-button-hidden
{
    opacity: 0.0;
    filter: alpha(opacity=0);
    height: 16px;
    width: 16px;
    margin: 0;
    padding: 0;
} 
```

这实际上是在按钮后面放置了一个常规的 jQuery span 图标。该按钮是完全透明/不透明的（通过 CSS），但是因为它仍然在图标的顶部，所以单击图标会触发按钮单击事件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-23T12:27:04.257

我使用这个 jquery 代码来获取一个文本输入字段的日期选择器和一个 jquery UI 图标作为日期选择器按钮上的图像。

```
// Apply jQuery UI DatePicker to all controls with class = datepicker
    $('.datepicker').datepicker({
        showWeek: true,
        dateFormat: "yy-mm-dd",
        buttonImage: "ui-icon-calendar",
        regional: "sv",
        minDate: "-10Y",
        maxDate: "+10Y",
        showButtonPanel: true,
        buttonImageOnly: false,
        showWeekNumber: true,
        firstDay: 1,
        showOtherMonths: true,
        selectOtherMonths: true,
        changeMonth: true,
        changeYear: true,
        showOn: "both"

    }).next('button').text('Show calendar').button({ icons: { primary: 'ui-icon-calendar' }, text: false }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-09T22:53:01.503

更改：显示在：“两者”，//按钮

```
<input type="text" name="date_from" id="date_from" />        
<input type="text" name="date_to" id="date_to" />

$(function() {
$("#date_from").datepicker({
    changeMonth: true,
    changeYear: true,
    numberOfMonths: 1,
    showOn: "both",//button
    buttonImageOnly: false,
    showAnim: "slideDown",
    dateFormat: "yy-mm-dd",
    onClose: function(selectedDate) {
        $("#date_to").datepicker("option", "minDate", selectedDate);
    }
});
$("#date_to").datepicker({
    changeMonth: true,
    changeYear: true,
    numberOfMonths: 1,
    showOn: "both",//button
    buttonImageOnly: false,
    showAnim: "slideDown",
    dateFormat: "yy-mm-dd",
    onClose: function(selectedDate) {
        $("#date_from").datepicker("option", "maxDate", selectedDate);
    }
});
}); 
```

[http://jsfiddle.net/wimarbueno/fpT6q/](http://jsfiddle.net/wimarbueno/fpT6q/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-04T02:36:20.303

在手动设置按钮/图标的过程中，您可以使用[How to combine the jQueryUI DatePicker's Icon Trigger with Bootstrap 3's Input Groups](https://stackoverflow.com/questions/19444512/how-to-combine-the-jqueryui-datepickers-icon-trigger-with-bootstrap-3s-input-g#answer-19448982)中的这个示例，让 JS 点击事件将焦点设置在相关日期输入字段上，从而触发要出现的 jQueryUI 日期功能。

或者，如[文档](http://api.jqueryui.com/datepicker/#method-show)所述，您可以使用该`show`方法显示日期选择器（请注意，“如果日期选择器附加到输入，则输入必须对显示日期选择器可见。”）。

`$( ".selector" ).datepicker( "show" );`

这允许您使用输入字段旁边的任何按钮/图像/图标，并且能够单击按钮/图像/图标来触发输入字段的日期功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-19T21:50:03.453

我通过将我的图标按钮的 HTML 直接添加到`buttonText`选项中并禁用该`buttonImage`选项来实现此功能。

```
$('.datepicker').datepicker({
    showOn: "both",
    buttonText: '<i class="icon-calendar"></i>',
    dateFormat : "DD, MM d"
}); 
```

# c# - resharper 对 asp.net mvc 有问题吗？

> ID：802385
> 
> 赞同：4
> 
> 时间：2009-04-29T13:33:38.550
> 
> 标签：c#, asp.net-mvc, resharper

我正在使用最新版本的 resharper。上周刚刚下载并安装，所以我是新手。我遇到的问题是，在我的 ASP.NET MVC 应用程序中，我所有的控制器都说它们从未使用过，而控制器中的所有方法都说它们从未使用过。

有没有办法抑制消息或让更清晰的人了解它们的使用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T13:40:56.427

您可以打开/关闭 Resharper 为您提供的各种警告和提示。

但是，如果您编写单元测试，那么它们将被使用并且 Resharper 会很高兴。

**更新**

您可以考虑通过在控制器类的顶部和底部执行此操作来告诉 Resharper 忽略控制器中未使用的成员......

```
public class MyController: Controller
{
    // ReSharper disable UnusedMember.Global

    ...        

    // ReSharper restore UnusedMember.Global
} 
```

...或者，至少将这些注释放在控制器上的公共方法周围（我使用 StyleCop，因此所有公共方法无论如何都会组合在一起。这是相当不引人注目的，并且会摆脱来自 Resharper 的警告。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T04:10:30.860

是的，当前的 ReSharper 版本没有在 MVC 控制器上放置引用（虽然，下一个会）。

同时，您可以使用 ImplicitUse 属性标记控制器类和操作方法。您可以在 JetBrains.Annotations 程序集中找到它。如果你不想要外部依赖，你可以在你的项目中添加必要的 annotations 属性，你会在 ReSharper->Options->Code Inspection->Code Annotation->Copy default implementation 中找到它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T18:04:25.890

我不知道这会迫使 Resharper “知道”使用了一种方法（我从未遇到过 Resharper 的这个问题）。

如果您不想全局打开/关闭各种检查选项，您可以选择使用注释隐藏特定检查消息。像这样...

```
// ReSharper disable UnusedPrivateMember
private void NotUsed ()
{
    // ... Code ...
}
// ReSharper restore UnusedPrivateMember 
```

# grails - Grails 中的帮助气球

> ID：802391
> 
> 赞同：3
> 
> 时间：2009-04-29T13:34:35.990
> 
> 标签：grails, groovy, gsp, help-balloon

我正在使用帮助气球插件，我想将其参数化。我的意思是，消息应该来自属性文件。在文档中出现以下内容：

```
 <g:helpBalloon code="user.name" suffix=".help"/> 
```

*在最后一个示例中，代码属性用于在消息包中查找气球的标题，然后将后缀添加到代码中（在我们的示例中生成 user.name.help）作为用于查找气球的内容。*

我的问题是：

此属性文件（消息包）应位于何处？

每个控制器可以有一个消息包吗？

路易斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T13:14:56.747

如果您查看了帮助气球标记的源代码，它实际上使用 grails 国际化代码在给定键的情况下呈现消息。[http://fisheye.codehaus.org/browse/grails-plugins/grails-help-balloons/trunk/grails-app/taglib/HelpBalloonTagLib.groovy?r=45243](http://fisheye.codehaus.org/browse/grails-plugins/grails-help-balloons/trunk/grails-app/taglib/HelpBalloonTagLib.groovy?r=45243)

查看此页面[http://www.grails.org/doc/1.0.x/guide/10.%20Internationalization.html](http://www.grails.org/doc/1.0.x/guide/10.%20Internationalization.html)它告诉您在何处以及如何命名消息包的文件。

至于每个控制器的消息包，您似乎不能（至少从文档中看不出来）。但是您可以通过在消息键前面加上控制器名称来破解它，从而使用相同的消息包文件（message.properties_ 但仍然能够命名每条消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:06:20.640

**资源包在哪里：**

**grails-app**下有一个名为**i18n**的目录，其中放置了所有生成的资源文件，开始查看那里并查看它们在应用程序中的使用方式。

您可能可以将多个消息文件放置在其中以供您的控制器进行组织，只是要小心重用密钥，因为我不确定如何立即处理。

**如何访问它们：**

也许这会有所帮助，我希望：

[http://www.nabble.com/Organizing-message-bundles-tt16169280.html#a16169280](http://www.nabble.com/Organizing-message-bundles-tt16169280.html#a16169280)

# jquery - 这个 jquery 可调整大小的函数有什么问题？

> ID：802393
> 
> 赞同：1
> 
> 时间：2009-04-29T13:35:19.950
> 
> 标签：jquery

我一直在尝试使用新的 jquery-ui，除了可调整大小的功能外，所有功能似乎都可以工作。手柄似乎没有出现在任何地方。谁能弄清楚为什么？

[http://victor.hwanger.com/test.html](http://victor.hwanger.com/test.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T13:39:44.120

我相信您需要包含 jQuery-UI CSS 参考：

[http://jqueryui.com/latest/themes/base/ui.all.css](http://jqueryui.com/latest/themes/base/ui.all.css)

# sql-server - 如何让 Sql Server 2005 从 DDL 触发器异步调用 DOS 批处理文件？

> ID：802398
> 
> 赞同：1
> 
> 时间：2009-04-29T13:36:06.830
> 
> 标签：sql-server, sql-server-2005, triggers, event-triggers

我创建了一个批处理文件来运行 SqlMetal 并生成 Linq2Sql 数据类，签入触发构建的源代码控制等...我希望在 Sql Server 2005 中发生 DDL 更改时运行此脚本。

通过 xp_cmdshell 运行批处理文件可以在触发器之外正常工作，如下所示：

```
exec master..xp_cmdshell 'd:\dev\db_triggers\generatedataclasses.bat', no_output 
```

但是当它作为触发器运行时，连接数据库总是超时，导致所有DDL失败。这是我的触发器：

```
CREATE TRIGGER [Trig_SqlMetal]
ON DATABASE
FOR DDL_DATABASE_LEVEL_EVENTS 
AS
exec master..xp_cmdshell 'd:\dev\db_triggers\generatedataclasses.bat', no_output 
```

我正在寻找关于两点的建议：

1.  完成这项工作。出于某种原因，它在触发器中时总是失败，而不是在触发器中时不会。似乎与安全无关，因为它在两种情况下都作为 LocalSystem 运行。
2.  使这种情况异步发生，以便 SqlMetal 中的故障和超时不会导致 DDL 更新失败。我试过用另一个和“start cmd.exe /c otherbatch.bat”包装批处理文件，但是当通过sql server运行时，它似乎忽略了开始（在DOS下工作正常）。我当然可以编写一个轮询过程来查看一些表和拾取事件，但我希望这是基于触发器的，以使其不那么复杂（或者我是否在做相反的事情:)）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T13:46:10.503

您的批处理可能被阻止，因为它尝试查询有关正在创建的表的数据，但它们仍被锁定在事务中（触发器是 SQL Server 为任何 DDL/DML 语句启动的隐式事务的一部分），这只会完成触发器完成后。我所知道的在 SQL Server 2005 或更高版本中异步执行的唯一“几乎”实用的方法是 Service Broker。查找“Service Broker 内部激活”。实际上，正确设置它有点复杂，因此您可能会选择使用池选项。

# php - PHP file() 生成错误：无法打开流

> ID：802399
> 
> 赞同：1
> 
> 时间：2009-04-29T13:36:13.163
> 
> 标签：php

我有一个脚本：

```
$id = strtolower(implode('',file($ip_service . $ip))); 
```

执行时文件功能将像文件（[http://www.url.com/filename.php?119.160.120.38](http://www.url.com/filename.php?119.160.120.38)）

在服务器 A 上它工作正常，但在服务器 B 上它给出以下错误：

`file(http://www.url.com/filename.php?xxx.xxx.xxx.xxx) [function.file]: failed to open stream: Connection timed out in /home/path/filename.php on line 22`

第 22 行是上面的代码行。

服务器 A 有 PHP 4.4.6，服务器 B 有 4.4.8

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T13:55:13.943

使用 file() 和/或 file_get_contents() 通过 Internet 访问文件非常容易出错。例如，我认为他们不遵循重定向。超时时间也很短，不是典型的网络超时。进行错误捕获以查看失败的原因也很困难。我总是使用 CURL 通过网络访问文件。它需要多几行代码，但更可靠。请注意，您的设置中可能未安装 PHP CURL 支持。

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
curl_setopt($ch, CURLOPT_URL, 'http://www.url.com/filename.php?119.160.120.38');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
$result = curl_exec($ch);
if ( $result==false ) {
  echo curl_errno($ch).' '.curl_error($ch);
}
curl_close($ch); 
```

显然，如果出现错误，除了回显错误消息之外，您还想做一些事情。如果成功，$result 变量将具有文件的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:40:58.800

您的服务器无法在给定的时间段内（20 秒？30 秒？默认值或您指定的超时）与托管 www.url.com 的服务器建立 tcp/ip 连接。另一台服务器甚至没有主动拒绝连接，根本没有任何响应。例如，可能是防火墙问题，您或其他服务器的部分或全部数据包被静默丢弃。

# java - 有人使用 SpringSource tc 服务器作为 Tomcat 替代品吗？

> ID：802400
> 
> 赞同：31
> 
> 时间：2009-04-29T13:36:20.557
> 
> 标签：java, spring, tomcat, jakarta-ee

看起来 SpringSource[刚刚发布了](http://www.springsource.org/node/1385)他们的[tc Server](http://www.springsource.com/products/tcserver)应用服务器的 GA 版本。

从他们的描述中听起来，它是 Apache Tomcat 的直接替代品，具有更好的“企业能力”，例如“高级诊断”、更好的运营管理、部署等（当然，还有他们想要的支持）将您作为他们的主要商业模式出售）。

所以我很好奇（我不确定这是否真的是一个 SO 问题），但是今天有人以任何形式或方式使用 tc Server 吗？对你来说效果好吗？您是否发现他们为 Tomcat 添加的任何功能都值得？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-01T07:32:19.167

在我看来，tcServer 的主要优势在于管理大型负载平衡 tomcat 集群。除了管理/监控层（顺便说一句，这很酷），它还具有更快的数据库连接池机制，以及针对大容量优化的一般调整配置。除此之外，它只是Tomcat。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-27T08:22:41.370

他们刚刚发布了[开发者版](http://www.springsource.com/products/tcserver/devedition)。看看这个[截屏视频](http://s3.springsource.com/MRKT/spring-metrics/Spring_Insight_Preview-final2.mov)，它演示了他们的诊断是如何工作的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-09T07:38:24.037

MuleSoft 发布了[Tcat Server](http://www.mulesoft.com/tcat-server-enterprise-tomcat-application-server)，它提供高级配置、Tomcat 和 webapp 特定诊断。与 tcserver 的一些主要区别在于，Tcat Server 是 100% 未经修改的 Apache Tomcat，并且诊断功能直接内置在产品中。

披露：我在 MuleSoft 工作，很乐意回答有关 Tcat Server 的任何问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-19T03:04:55.467

我还要补充一点，“高级监控”功能实际上在 java 1.5 中可用（查看 JDK 的 SNMP/JMX 文档）。多年来一直使用 rrdtool 并最近移植到使用 highcharts+mongo。

# wiki - Web 2.0 和拨号：如何使其尽可能轻松？

> ID：802401
> 
> 赞同：0
> 
> 时间：2009-04-29T13:36:35.113
> 
> 标签：wiki, forum, dial-up

我正在尝试为一个可以真正充分利用论坛和维基的慈善机构制定一个可行的计划，但其运作的关键部分发生在拨号连接占主导地位的世界部分地区，并且可能会继续在可预见的未来这样做。

该站点被推荐为即使在拨号连接上也表现良好的站点，所以我想我会在这里寻求帮助！

我想将其连接到的站点正在使用 Drupal。有这样的经历的人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:00:05.353

在拨号时表现良好包括坐下来优化您的 HTML、CSS 和图像，使其尽可能小，然后确保您的服务器发送合理的 HTTP 标头进行缓存。确保您的 CSS 样式表是外部的，并且在所有页面之间共享。如果拨号是一个主要问题，那么您将尽可能坚持使用单个样式表。避免使用 JavaScript，因为这些计算机通常也没有处理能力。如果你必须使用 JavaScript，jQuery 非常小而且速度非常快，强烈推荐，但我怀疑对于大多数面向内容的网站来说，它不是必需的。

老实说，如果您生成有效的 XHTML/HTML5、有效的 CSS，并且遵循基于标准的网页设计的所有常见最佳实践（没有表格布局、语义标记等），那么拨号真的不会是问题。它会起作用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:07:18.610

要调整站点的最大性能，您可能需要安装它并在完成初始开发后在您的站点上使用它- [ySlow](http://developer.yahoo.com/yslow/) - 这将分析您的页面并突出显示您可以改进的所有领域。它确实是优化网站下载速度的好工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:15:50.883

已经有一些关于如何降低页面大小和加载时间的提示。

为了补充这一点，您可以使用模拟有限带宽的软件。这有助于您在拨号时测试站点的速度。

有几个可用的（只是谷歌“模拟拨号”）。 [Sloppy](http://www.dallaway.com/sloppy/) eg 似乎非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T14:21:31.917

您也可以像 Google 为 Gmail 所做的那样，即提供 2 个版本的视图，一种用于使用普通旧 HTML 的慢速连接，另一种用于更快的连接。您可以将默认设置设为慢速设置，但提供链接以启用较快的设置。

Gmail 还具有内置机制，可检测您何时加载页面是否速度快，如果速度太慢，它会自动恢复为纯 HTML 视图，这是另一种更好的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T13:59:06.120

您应该能够做到这一点，但老实说，通过创建一个拨号友好的站点，您将在用户体验方面失去很多。这基本上意味着您必须执行以下操作来优化体验：

1.  将 JS 保持在最低限度
2.  确保 JS 被缩小。
3.  使用 CSS 和一些优化的布局规划减少大图像需求
4.  确保在标头中启用缓存，以便仅在需要时才下载新文件。

如果你做了所有这些，你应该有一个可以接受拨号的站点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T14:25:54.510

您的主要目标应该是最小页面大小（仅在页面中保留 HTML，所有样式信息都应该在 css 文件中外部化以进行缓存，对于 js 文件中的 JavaScript 也是如此）和最少往返服务器（完整请求和回发）。与流行的看法相反，如果您执行大量繁重的客户端并以所需的最少数据量保持服务器往返清洁（想想 JQuery 和 AJAX，这里有少量的部分渲染），那么 JS 繁重的网站可以像魅力一样工作。

PS 如果你使用 .NET 把 ViewState 扔掉。

# sharepoint - Sharepoint 列表视图的多个副本

> ID：802402
> 
> 赞同：1
> 
> 时间：2009-04-29T13:36:42.320
> 
> 标签：sharepoint, listview, sharepoint-2007

我们有一个 Sharepoint 网站，其中每个产品都有一个不同的页面，另一个页面显示我们所有产品发布日期的列表。您可以更改此列表中的视图，以便仅显示特定产品的发布日期。

是否可以在专用于该产品的页面上显示显示一种产品的发布日期的列表视图？我们希望每个产品页面显示其自己的发布日期，但如果有人更新主列表，则每个单独的产品列表也应该更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T22:06:21.313

您可能希望使用[dataview webpart](http://ari.provoke.co.nz/archive/2007/04/17/data-view-web-part-introduction-1.aspx)查看“主”列表。您将能够为每个 Web 部件定义不同的过滤器。使用 XSLT，您还可以完全自定义 HTML 的输出，但我更喜欢只使用一个来避免所有工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T20:44:26.707

使主列表在产品页面上可用的一种简单方法是将主列表的内容同步到产品页面上的隐藏列表中，您可以为此使用事件接收器。此解决方案将需要一些自定义代码，但它非常简单。

# php - 如何说服其他程序员使用 Gettext？

> ID：802405
> 
> 赞同：5
> 
> 时间：2009-04-29T13:37:42.503
> 
> 标签：php, javascript, gettext

我在我参与过的许多项目中都成功地使用了 GNU Gettext，但在我最近的工作中，我突然发现自己被迫使用一个非常尴尬的本地化系统。

当前系统将翻译存储在数据库中，添加新翻译的过程如下：

*   将带有翻译键的函数调用添加到源代码，例如`print translate('foo');`
*   `translations.sql`向文件中添加一些 SQL INSERT 语句。
*   用名字创建文件`(current revision nr + 1).sql`
*   在数据库中执行 .sql 文件。
*   提交您的更改（在其他人设法提交和更改当前修订号之前）。

所有这些过程都是完全手动的，即使您需要修复一个小错字，您也必须重复几乎所有的过程。不支持复数形式。整个翻译数据库非常混乱，因为翻译几乎从未被删除 - 只是添加和更新。

我尝试了几种论点来说服其他开发人员（尤其是一个特定的开发人员）：

*   我已经谈到 Gettext 正在成为标准，并且有许多工具可用于处理 PO 文件。
*   我试图解释在数据库中存储翻译与将它们存储到文本文件相比没有任何好处——我们只是通过密钥从数据库中检索翻译，仅此而已。
*   另一位开发人员正在开发我们应用程序的 PHP 部分，PHP 内置了 Gettext。我在 JavaScript 方面工作，它不支持 Gettext，但我过去已经为它构建了自己的工具。
*   我们的应用程序不是很大，即使手动完成从旧系统转换到 Gettext 也需要很长时间，我很确定它可以很容易地自动化。
*   我什至成功地将 Gettext 用于我们公司的一个较小的应用程序。

但人们仍然不相信。我可能做错了什么？

### 编辑：

在发布这个问题几个月后，我们现在终于过渡到 Gettext。当我们需要支持两种以上的语言时，我们当前系统的缺点对那些迄今为止抵制它的人来说更加明显。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T13:46:56.710

你做错了什么是告诉他们如何解决他们认为不存在的问题。

你需要让他们看到这实际上是一个需要解决的问题。

**编辑：**
很高兴看到你最终到达那里，第二语言似乎让他们认出了房间里的大象！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T13:45:35.853

我可以为您看到几个选项：

*   您可以尝试使用您的方法估算节省的时间（金钱）。
*   你可以展示（演示？）它是多么容易维护（减少头痛）。
*   您可以继续使用已经存在的系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T13:54:17.847

几个问题可能是：

缺乏对 Gettext 的认识。如果开发人员不了解该库，他们将不会使用它。

与 GPL 不兼容的许可证。不能使用它可能有法律原因。

看到不需要重写。如果开发人员对当前系统足够满意，那么他们可能会认为迁移到 Gettext 没有任何优势。

# c - 为什么 Eclipse CDT 说：'syntax error'，但编译没问题

> ID：802410
> 
> 赞同：15
> 
> 时间：2009-04-29T13:38:54.577
> 
> 标签：c, indexing, eclipse-cdt

我正在使用现有的 C 代码，其中有几行与此类似的语句：

```
struct collect_conn *tc = (struct collect_conn *) 
     ((char *)c - offsetof(struct collect_conn, runicast_conn)); 
```

结构 collect_conn 遵循以下几行：

```
struct collect_conn {
  struct runicast_conn runicast_conn;
  struct announcement announcement;
  const struct collect_callbacks *cb;
  struct ctimer t;
  uint16_t rtmetric;
  uint8_t forwarding;
  uint8_t seqno;
}; 
```

我正在使用 Eclipse CDT，它将带有橙色波浪线的行标记为“语法错误”。我认为它是由 CDT 索引器标记的。但是，编译（在终端中手动）没有问题。

然而，这有点不方便，因为行上的元素没有被索引（因此调用层次结构树并不总是正确的，或者元素的突出显示等）

为什么 Ecipse 不喜欢这条线？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-07T14:35:15.293

Eclipse CDT 包含自己的预处理器/解析器，用于分析代码和构建索引。但是，当您调用构建 CDT 时，会调用您的系统编译器，例如 gcc。CDT 解析器接受的语法与编译器接受的语法之间可能存在细微差别。当这种情况发生时，CDT 解析器可能会感到困惑。

在我的系统上，`offsetof`宏扩展为使用`__offsetof__`关键字的表达式。CDT 无法识别此关键字，因此存在语法错误。为了解决这个问题，CDT 解析器内置了一个宏来处理，`__offsetof__`如下所示：

```
#define __offsetof__(x) (x) 
```

这似乎不正确，至少在我的系统上，结果是`__offsetof__`从源中删除了关键字，这仍然会导致语法错误。

`__offsetof__`通过转到“路径和符号”属性页面并添加一个映射到“foo”的宏，我能够摆脱语法错误。这会诱使解析器认为它只是对以前从未见过的函数的调用，而不是语法错误。

或者，您可以通过转到 Window > Preferences > General > Editors > Text Editors > Annotations 并取消选中 C/C++ Indexer Markers 的所有复选框来关闭编辑器中的语法错误报告。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-05T16:06:00.867

我已经使用 Preferences->C/C++->Language Mappings 修复了 Eclipse CDT 中的问题：添加内容类型：C-header 语言：C++

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-05-02T06:05:23.787

有时，虽然代码编译没有错误，但 eclipse CDT 的实时代码分析器会在 C/C++ 文件中显示一些错误（例如，'函数 xxx 无法解析）。这是因为 eclipse CDT 使用自己的预处理器/解析器来分析代码和构建索引，而不是 MinGW 的（或任何其他 GNU 编译器）。**要为工作区中的所有 Eclipse 项目全局修复此问题，请执行以下步骤：（要仅针对特定项目修复此问题，请执行菜单“项目->首选项**”中的步骤 1、2 和 4 ）

1-在菜单' **Window->Preferences->C/C++->Language Mappings** '中，添加正确的映射，如下所示：（例如，对于内容类型：C++ Source/Header File，使用 GNU C++ 语言等） [![全局语言映射设置](https://i.stack.imgur.com/dKOYy.png)](https://i.stack.imgur.com/dKOYy.png)

2-在菜单“ **Window->Preferences->C/C++->Indexer** ”中，通过选中所有复选框（但不是“跳过”复选框）设置完整索引，如下所示： [![全局索引器设置](https://i.stack.imgur.com/c2h7E.png)](https://i.stack.imgur.com/c2h7E.png)

3-在每个项目的具体属性中，菜单' **Project->Properties->C/C++ general->Indexer** '，取消勾选'Enable project specific settings'，如下图： [![项目索引器设置](https://i.stack.imgur.com/uNhFX.png)](https://i.stack.imgur.com/uNhFX.png)

4-重建索引，菜单' **Project->C/C++ Index->​​Rebuild** '。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-29T13:56:52.723

似乎 CDT 解析器不喜欢 offsetof(struct ...) 部分。如果您使用 typedef 声明 collect_conn 错误就会消失。至少对我来说，以下代码有效：

```
typedef struct  {
   struct runicast_conn runicast_conn;
   struct announcement announcement;
   const struct collect_callbacks *cb;
   struct ctimer t;
   uint16_t rtmetric;
   uint8_t forwarding;
   uint8_t seqno;
} collect_conn;
...
struct collect_conn *tc = (struct collect_conn *)
     ((char *)c - offsetof(collect_conn, runicast_conn)); 
```

如果您无法更改原始声明，请执行以下操作：

```
typedef struct collect_conn collect_conn_t; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T13:47:07.193

可能会感到困惑，`[offsetof](http://linux.die.net/man/3/offsetof)`例如，检查您是否有范围内的定义。`#define`否则，您可能会尝试简化表达式，使用例如 a和`offset`of 或其他东西来分解它。

我认为编译器可能会提供内置版本`offsetof`，而 Eclipses 的编译器/代码解析器可能不会。如果是这样，您需要确保您有定义，以便 Eclipse 能够正确解析您的代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-26T17:18:12.283

尝试在 Preferences->c/C++ -> indexer 中将索引器切换到“Full c/C++ indexer (complete parse)”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T21:44:05.563

我有同样的问题。offsetof 有两种定义（一种用于 C，一种用于 C++）。IMO的问题来自于此

例如，如果我输入

```
#ifndef __cplusplus
#endif 
```

Eclipse 会将其变灰。这意味着 __cplusplus 已定义，但我的项目是 C

不幸的是我没有找到解决办法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-06T02:36:35.700

我最终解决了这样的问题。首先我打开项目属性，然后是 C/C++ 通用->路径和符号类别。在 Symbols 选项卡下，我添加了这个条目：

```
Symbol: offsetof(TYPE,MEMBER)
Value: ((ssize_t) &((TYPE *)0)->MEMBER) 
```

这些符号被索引器使用但不会传递给编译器（至少在 Makefile 项目中，我没有在其他类型的 C 项目中尝试过），因此它不会覆盖 GCC 的内置 offsetof

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-10T12:30:11.563

在检查新 CDT 项目向导的 Makefile 项目中的选项卡错误解析器后，我修复了类似的问题，删除了 CDT Visual C 错误解析器（我正在使用 gcc）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T13:51:11.583

我已经看到 Eclipse 多次这样做了，我将它用于 Java。通常关闭并再次打开文件会为我修复它（重置任何错误）。通常似乎是一个错误，但已修复，并且“错误缓存”未正确更新。

# nhibernate - 使用 JoinType.LeftOuterJoin 和 Projections 时，Nhibernate 条件查询按表达式插入额外的顺序

> ID：802417
> 
> 赞同：1
> 
> 时间：2009-04-29T13:41:12.120
> 
> 标签：nhibernate, criteria

为什么这个休眠条件查询会产生下面的 sql 查询？

```
return Session.CreateCriteria(typeof(FundingCategory), "fc")
    .CreateCriteria("FundingPrograms", "fp")
    .CreateCriteria("Projects", "p", JoinType.LeftOuterJoin)
    .Add(Restrictions.Disjunction()
        .Add(Restrictions.Eq("fp.Recipient.Id", recipientId))
        .Add(Restrictions.Eq("p.Recipient.Id", recipientId))
    )
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.GroupProperty("fc.Name"), "fcn")
        .Add(Projections.Sum("fp.ObligatedAmount"), "fpo")
        .Add(Projections.Sum("p.ObligatedAmount"), "po")
    )
    .AddOrder(Order.Desc("fpo"))
    .AddOrder(Order.Desc("po"))
    .AddOrder(Order.Asc("fcn"))
    .List<object[]>(); 
```

```
SELECT   this_.Name                as y0_,
         sum(fp1_.ObligatedAmount) as y1_,
         sum(p2_.ObligatedAmount)  as y2_
FROM     fundingCategories this_
         inner join fundingPrograms fp1_
           on this_.fundingCategoryId = fp1_.fundingCategoryId
         left outer join projects p2_
           on fp1_.fundingProgramId = p2_.fundingProgramId
WHERE    (fp1_.recipientId = 6 /* @p0 */
           or p2_.recipientId = 6 /* @p1 */)
GROUP BY this_.Name
ORDER BY p2_.name asc,
         y1_ desc,
         y2_ desc,
         y0_ asc 
```

它错误地将 p2_name asc 放入 ORDER BY 语句中，并导致它崩溃。这只发生在我对我的项目标准使用 JoinType.LeftOuterJoin 时。这是一个已知的休眠错误吗？我正在使用休眠 2.0.1.4000。感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T17:49:15.057

我已将此作为错误发布在 nh jira 论坛上。

[https://nhibernate.jira.com/browse/NH-1761](https://nhibernate.jira.com/browse/NH-1761)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T08:07:01.003

我知道它很旧，但我遇到了同样的问题。

排序是在集合映射中定义的。在您的情况下，可能是`FundingPrograms`. 你不能通过调用来清除它`.ClearOrders()`

我的解决方案是在您尝试排序的属性上添加一个分组 `.Add(Projections.Group(() => p.name))`

# c# - Winforms 创建下拉样式面板

> ID：802426
> 
> 赞同：2
> 
> 时间：2009-04-29T13:44:56.950
> 
> 标签：c#, winforms, .net-2.0, popup

我正在尝试在 c# .net2.0 中创建自己的自定义自动完成样式下拉控件。为了加快开发速度，我将控件构建为 UserControl，但遇到了这样做的问题。

当自定义绘制的下拉列表被绘制时，我必须调整 UserControl 区域的大小才能显示选项列表。

理想情况下，我希望能够模仿 drodpown 列表行为，因为选项列表是“浮动”绘制的，并且不受 UserControls 高度和宽度的限制（甚至父窗体边界也不受限制）。工具提示是我想要的不受约束的“浮动”的另一个例子。

我能想到的唯一方法是动态创建一个没有边框或标题栏的新表单，并在需要弹出窗口时显示它。

有没有更好（但也更快）的方法来做到这一点？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:18:13.890

您需要使用 Form 或 NativeWindow 来允许控件正确浮动。要使表单遵循控件很容易，但实现和处理所有聚焦/隐藏问题更加困难，尤其是在您需要无缝制表符/键导航时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:23:29.263

您可以尝试创建一个基于 ToolStrip 下拉按钮控件的控件。我相信这个控件具有您正在寻找的功能。我找到了这个参考来创建基于 ToolStrip 的控件，你可以尝试从这个开始。

[http://blogs.msdn.com/jfoscoding/attachment/1335869.ashx](http://blogs.msdn.com/jfoscoding/attachment/1335869.ashx)

# .net - 用于单点登录的 SharePoint 集成

> ID：802428
> 
> 赞同：2
> 
> 时间：2009-04-29T13:45:25.030
> 
> 标签：.net, sharepoint, integration

让我以我是一位经验丰富的 .NET 开发人员作为开头——但我还没有使用过 SharePoint，所以这个问题与 SharePoint 及其功能直接相关。

我正在开发一个项目，该项目需要与 SharePoint 集成，用户可以单击某种重定向链接，使他们能够对我的应用程序进行身份验证，而无需每次都登录。

我需要能够指定哪些 SharePoint 用户可以访问我的应用程序，然后向这些用户显示登录信息。（所以也许 2 个 Web 部件，一个用于管理员将 SharePoint 用户分配给我的应用程序，1 个用于实际应用程序链接？）

对于那里的 SharePoint 经验丰富的开发人员，您对如何以最简单、非侵入性的方式执行此操作有何想法？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T17:19:28.960

这可能是一个难以破解的难题......

我使用 Microsoft Single Sign-on 来集成 SharePoint 和 Confluence。我们所做的是让我们的 Web 部件可以选择通过向其他系统（在我们的例子中是 Confluence）执行包含 SSO 凭据的客户端 HTTP 请求来对 Confluence 进行预身份验证。这将允许浏览器拥有必要的 cookie，以便从外部系统中提取任何图像，而不会显示为损坏，并允许指向其他系统的链接在不被重定向到登录页面的情况下工作。

如果您决定执行此预身份验证，您需要意识到这会导致来自客户端的额外网络请求。我们没有找到一种方法来知道我们是否需要发出这个额外的请求，所以如果他们使用 SSO，我们总是在包含我们的 Web 部件的每个页面请求上都这样做（我知道，这并不理想）。

从安全的角度来看，我们要做的一件事是只在页面源中拥有 SSO 令牌，并让客户端代码请求密码，以便将其传递给其他系统。我们还进行了一些额外的验证，以确保没有人试图欺骗令牌。查看[此链接](http://confluence.atlassian.com/display/CONFEXT/SharePoint+Connector+Security+Review)了解更多详细信息（“使用 Microsoft SSO 时的 Confluence 凭据”部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T13:57:24.297

我不是 100% 确定我是否在遵循您想要做的事情，但是这样做...

使用 SharePoint Portal Server 实施单点登录 (SSO)

[http://blogs.msdn.com/roberdan/archive/2005/02/19/376629.aspx](http://blogs.msdn.com/roberdan/archive/2005/02/19/376629.aspx)

......有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:58:45.637

您可以构建集成到 SharePoint 中的 ASP.NET 应用程序。请参阅此处有关如何完成的详细说明[http://rshelton.com/archive/2007/10/05/free-sharepoint-document-workflow-workshop---part-2-asp.net-workflow.aspx。](http://rshelton.com/archive/2007/10/05/free-sharepoint-document-workflow-workshop---part-2-asp.net-workflow.aspx.)忽略工作流程部分。看看如何构建和部署“关联表单”。这将为您提供有关如何构建自己的 SharePoint 集成 Web 表单的好主意。

# mysql - MySQL：在结果中保持列在一起？

> ID：802430
> 
> 赞同：1
> 
> 时间：2009-04-29T13:45:59.130
> 
> 标签：mysql

好的，当我提出请求时，我希望所有具有相同 group_id 的项目都“在一起”，例如 117,117,134,111 很好，但 117,134,117,111 不好，因为 group_id 117 并非全部“一起”。我希望这是有道理的。我知道如何做到这一点的唯一方法是按 group_id 对我的结果进行排序，但是如果我想按类似价格或其他方式排序，有没有办法在将所有匹配的 group_id 保持在一起的同时做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T13:48:35.910

是的，您只需按两者订购，因此您`ORDER BY`应该如下所示：

```
ORDER BY group_id, price 
```

这将首先按 group_id 排序，然后按价格排序。所以所有相同的 group_id 都会在一起，但只要有多个具有相同 group_id 的，它们就会按价格排序。

不过，您的问题有点模棱两可，所以只是为了解释一下，以防万一这是您真正想要的-没有简单的方法可以“主要”按价格排序并将相同的 group_ids 保持在一起，这实际上没有任何意义。我的意思是，如果您有以下数据：

```
group_id  price
117       2.00
117       5.00
111       4.00
134       1.00 
```

您不能按此顺序轻松选择它：

```
group_id  price
134       1.00
117       2.00
117       5.00
111       4.00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:48:54.707

然后你必须按多列排序，所以：

```
SELECT group_id, price, name
FROM groups
ORDER BY group_id, price; 
```

这样，所有的 groupid 都在一起，并且在这些 groupid 的“组”中，所有内容都按价格排序。还是我误解了你的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:53:20.360

我会做：

```
SELECT price, group_id
FROM groups
WHERE 1=1
ORDER BY group_id, price DESC 
```

用于连续显示组，然后按后代顺序显示价格。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-29T13:49:06.207

你为什么不按价格和 group_id 订购？？？

```
SELECT price, group_id, ...
FROM products
WHERE 1=1
ORDER BY price DESC, group_id 
```

这将首先显示最大的价格，对于相同的价格，它将连续显示 group_id

# silverlight - silverlight - 重用组件

> ID：802436
> 
> 赞同：0
> 
> 时间：2009-04-29T13:47:22.653
> 
> 标签：silverlight, templates, components, styles, reusability

我正在尝试在**Silverlight2**中创建一些可重用的组件。当我的组件使用与其他组件共享的模板/样式时，困难就来了。

*   据我所知，在silverlight 中，您可以在组件本身（由于重复样式而不够好）或在主应用程序文件中添加样式/模板（这无助于在其他silverlight 项目中重用组件）。

*   我刚刚阅读了有关在 silverlight 工具包（3 月发布）中添加的模板，但是......该模板不允许我定义命名样式（例如，我有多个按钮样式）

我的问题：是否可以创建具有在一个地方定义的样式/模板的可重用组件？（通过可重用我的意思是在其他项目中重用）

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:04:48.020

这是 Silverlight 3 中的一项功能 - 将于今年晚些时候（2009 年）推出。“增强的控件皮肤。Silverlight 3 通过在应用程序外部保留一组通用控件来提供更简单的皮肤功能。这允许在不同应用程序之间共享样式和控件皮肤。” [Silverlight.net](http://silverlight.net/getstarted/silverlight3/default.aspx)

# php - 如何在 PHP/MYSQL 中将两个 mysql 查询作为一个执行？

> ID：802437
> 
> 赞同：29
> 
> 时间：2009-04-29T13:47:28.143
> 
> 标签：php, mysql, loops

我有两个查询，如下：

```
SELECT SQL_CALC_FOUND_ROWS Id, Name FROM my_table WHERE Name LIKE '%prashant%' LIMIT 0, 10;
SELECT FOUND_ROWS(); 
```

我想一次尝试执行这两个查询。

```
$result = mysql_query($query); 
```

但是然后告诉我我将如何处理单独设置的每个表。实际上在 ASP.NET 中，我们使用数据集来处理两个查询

```
ds.Tables[0];
ds.Tables[1]; .. etc 
```

如何使用 PHP/MYSQL 做同样的事情？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-29T13:55:39.857

**更新：**显然可以通过将标志传递给`mysql_connect()`. 请参阅[使用 PHP 在一条语句中执行多个 SQL 查询](https://stackoverflow.com/questions/13980803/executing-multiple-sql-queries-in-one-statement-with-php/13982705#13982705)然而，任何当前的读者都应该避免使用`mysql_`-class 函数并更喜欢 PDO。

你不能在 PHP 中使用常规的 mysql-api 来做到这一点。只需执行两个查询。第二个将如此之快，以至于无关紧要。这是微优化的典型例子。别担心。

作为记录，可以使用 mysqli 和[mysqli_multi_query](http://se2.php.net/manual/en/mysqli.multi-query.php) -函数来完成。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-04T05:48:40.757

正如其他人回答的那样，mysqli API 可以使用 msyqli_multi_query() 函数执行多查询。

值得一提的是，PDO 默认支持多查询，您可以迭代多个查询的多个结果集：

```
$stmt = $dbh->prepare("
    select sql_calc_found_rows * from foo limit 1 ; 
    select found_rows()");
$stmt->execute();
do {
  while ($row = $stmt->fetch()) {
    print_r($row);
  }
} while ($stmt->nextRowset()); 
```

但是，出于安全原因，多查询被广泛认为是一个**坏主意。**如果您对如何构造查询字符串不小心，您实际上可以得到[经典的“小鲍比表”XKCD 卡通](http://xkcd.com/327/)中显示的确切类型的 SQL 注入漏洞。当使用限制您进行单一查询的 API 时，这是不会发生的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T14:09:24.580

如果您不想执行两次查询，则必须使用 MySQLi 扩展：

```
if (mysqli_multi_query($link, $query))
{
    $result1 = mysqli_store_result($link);
    $result2 = null;

    if (mysqli_more_results($link))
    {
        mysqli_next_result($link);
        $result2 = mysqli_store_result($link);
    }

    // do something with both result sets.

    if ($result1)
        mysqli_free_result($result1);

    if ($result2)
        mysqli_free_result($result2);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-04T05:11:57.257

你必须使用 MySQLi，下面的代码效果很好

```
<?php
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query  = "SELECT CURRENT_USER();";
$query .= "SELECT Name FROM City ORDER BY ID LIMIT 20, 5";

/* execute multi query */
if ($mysqli->multi_query($query)) {
    do {
        /* store first result set */
        if ($result = $mysqli->store_result()) {
            while ($row = $result->fetch_row()) {
                printf("%s\n", $row[0]);
            }
            $result->free();
        }
        /* print divider */
        if ($mysqli->more_results()) {
            printf("-----------------\n");
        }
    } while ($mysqli->next_result());
}

/* close connection */
$mysqli->close();
?> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T13:54:58.920

使用`SQL_CALC_FOUND_ROWS`你不能。

> 通过 FOUND_ROWS() 可用的行数是暂时的，并且不打算在 SELECT SQL_CALC_FOUND_ROWS 语句之后的语句之后可用。

正如有人在您之前的问题中指出的那样，使用`SQL_CALC_FOUND_ROWS`通常比计数要慢。

也许你最好把它作为子查询来做：

```
SELECT 
 (select count(*) from my_table WHERE Name LIKE '%prashant%') 
as total_rows,
Id, Name FROM my_table WHERE Name LIKE '%prashant%' LIMIT 0, 10; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T13:51:50.490

像这样：

```
$result1 = mysql_query($query1);
$result2 = mysql_query($query2);

// do something with the 2 result sets...

if ($result1)
    mysql_free_result($result1);

if ($result2)
    mysql_free_result($result2); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T13:54:47.313

它在 PHP 站点上说[不允许多个查询](http://www.php.net/manual/en/function.mysql-query.php)（编辑：这仅适用于 mysql 扩展。mysqli 和 PDO 允许多个查询）。所以你不能在 PHP 中做到这一点，但是，为什么你不能在另一个 mysql_query 调用中执行该查询（如 Jon 的示例）？如果您使用相同的连接，它仍然应该给您正确的结果。此外，[mysql_num_rows](http://www.php.net/mysql_num_rows)也可能有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-11T10:37:02.190

是的，**可以**不使用 MySQLi 扩展。

只需使用`CLIENT_MULTI_STATEMENTS`in`mysql_connect`的第 5 个参数。

有关更多信息，请参阅[Husni 帖子](https://stackoverflow.com/a/13982705/632951)下方的评论。

# visual-studio - 调试 ActiveX

> ID：802438
> 
> 赞同：4
> 
> 时间：2009-04-29T13:48:08.017
> 
> 标签：visual-studio, debugging, activex

我正在尝试修复 ActiveX 控件上的错误。是否可以从 Visual Studio 2008 中对其进行调试？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T14:22:31.523

如果附加到进程是一个问题，只需将 DebugBreak() 扔到您要调试的代码中。如果 VS 是您的 JIT 调试器，一旦执行 debug break 命令，系统将询问您是否要调试该进程。只要说是，你就进去了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T13:49:52.100

您应该将调试器附加到加载 ActiveX 组件的进程。如果后者有调试信息，您将能够像调试普通应用程序一样对其进行调试。

如果宿主应用程序拒绝加载它，并且您怀疑负责 ActiveX 初始化的某些代码已损坏，您可以提前附加到该进程，它们会执行使宿主应用程序加载 ActiveX 的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-17T06:27:17.390

ActiveX 不是一个独立的应用程序。通常，它在容器应用程序中使用。

我建议使用`Message Boxes`and `alerts`。

希望这会有所帮助。

# testing - 可以发送 PUT/DELETE 方法的负载测试工具

> ID：802455
> 
> 赞同：1
> 
> 时间：2009-04-29T13:52:00.783
> 
> 标签：testing, rest, load-testing

我正在寻找可以发送 PUT/DELETE 请求的负载测试工具。
ApacheBench 和 JMeter 都不支持这些方法。

经过几个小时的谷歌搜索，我发现[SoapUI](http://www.soapui.org)看起来不错。

你还有什么建议吗？
像 ApacheBench 这样的命令行工具对我来说会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:47:15.483

[Grinder](http://grinder.sourceforge.net/)是一个不错的负载测试框架，还支持 PUT 和 DELETE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:31:54.690

Jmeter 支持从 > 到 2.5 版本的 put 和 delete 方法（不检查其他方法）

# sql-server - SqlCeResultSet 和 SQL 注入

> ID：802459
> 
> 赞同：2
> 
> 时间：2009-04-29T13:52:48.800
> 
> 标签：sql-server, compact-framework, sql-injection

使用此代码插入带有 SqlCeResultSet 的行时，

```
SqlCeResultSet resultSet = DataAccess.OpenResultSet("MyTable");
SqlCeUpdatableRecord record = resultSet.CreateRecord();
record.SetString(1,TextBox1.Text);
resultSet.Insert(record); 
```

它可以防止 SQL 注入攻击吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:10:15.903

是的，它将防止注入攻击。SetString 会将字符串放入传入的列中。无需转义字符串等。

# php - 确保 http 出现在网址中

> ID：802469
> 
> 赞同：1
> 
> 时间：2009-04-29T13:55:02.057
> 
> 标签：php, http, hyperlink, href

我有人发布他们的网站地址，但发布了变体，例如：

*   他们的网站
*   www.theirsite.com
*   [http://theirsite.com](http://theirsite.com)
*   [http://www.theirsite.com](http://www.theirsite.com)

当我链接到没有 http:// 的地址时，它会将链接作为内部链接

```
<a href="theirsite.com">their site</a> 
```

将人们发送到类似的东西：http: [//mysite.com/thiersite.com](http://mysite.com/thiersite.com)

我尝试过的另一个选项是链接到 mysite.com/?link=theirsite.com 之类的东西 - 这样我可以进行一些链接跟踪等，然后将人们重定向到链接，但它有同样的问题：

```
//do some tracking etc here
$link =$_GET['link'];
header("Location: $link"); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T14:43:12.550

这里不需要使用正则表达式。PHP 内置了 URL 验证。

[过滤器变量](http://uk.php.net/manual/en/function.filter-var.php)

```
var_dump((bool) filter_var('http://www.website.com', FILTER_VALIDATE_URL, FILTER_FLAG_HOST_REQUIRED));
var_dump((bool) filter_var('http://website.com', FILTER_VALIDATE_URL, FILTER_FLAG_HOST_REQUIRED));
var_dump((bool) filter_var('www.website.com', FILTER_VALIDATE_URL, FILTER_FLAG_HOST_REQUIRED));
var_dump((bool) filter_var('website.com', FILTER_VALIDATE_URL, FILTER_FLAG_HOST_REQUIRED)); 
```

输出

```
bool(true)
bool(true)
bool(false)
bool(false) 
```

请不要直接跳到正则表达式进行验证，PHP 内置了很多方法来处理这些场景。

-马修

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:02:12.337

默认情况下将“http://”放在字段中，然后使用类似的内容验证 URL

```
if(eregi("^((http|https)://)?([[:alnum:]-])+(\.)([[:alnum:]]){2,4}([[:alnum:]/+=%&_.~?-]*)$", stripslashes(trim($_POST['link'])))){
    //link is valid
} 
```

如果链接无效，只需打印一条消息“您输入的链接无效，请确保它以'http://'开头”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T14:05:41.830

我会使用这样的东西：

```
$link = str_replace(array("\r", "\n"), '', trim($link));
if (!preg_match('/^https?:\/\//', $link)) {
    $link = 'http://'.$link;
}
header('Location: '.$link); 
```

另一种方法是解析给定 URL 的[`parse_url`函数](http://docs.php.net/parse_url)，查看缺少哪些部分并添加它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T14:07:05.553

`www.site.com`请注意，和之间存在真正的区别`site.com`，通常两者都有效，但是在某些网站上，每个网站都会导致不同的路径（例如，某些定义不正确的网站将无法正常工作`www`）。所以你不能总是在输入前加上“www”。

另一个注意事项，请处理前置空间，这样`' http://'`就不会在前面加上额外`http://`的 .

我的基于 Javascript 正则表达式的解决方案

```
'http://'+field.replace(/^ *http:\/\//,'') 
```

您可以验证客户端大小，只需在`onSubmit`表单上添加类似精神的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T13:57:08.777

我会提供一些验证或卫生。使用正则表达式查看 http:// 是否以它开头。如果不是，则抛出验证错误或将 http:// 放在开头。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T13:57:53.673

```
if not "://" in users_url:
    users_url = "http://" + users_url 
```

...或同等语言，使用您选择的语言。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T13:58:02.050

您可以使用正则表达式来测试输入

```
Regex exp = new Regex(
    @"http://(www\.)?([^\.]+)\.com",
    RegexOptions.IgnoreCase); 
```

# c# - 停止程序执行，直到线程完成

> ID：802478
> 
> 赞同：2
> 
> 时间：2009-04-29T13:57:09.663
> 
> 标签：c#, multithreading, concurrency

我有一个控制台应用程序，它启动了 4 个线程来执行一项长期任务。我希望我的程序等到线程完成，然后完成程序执行。有没有办法阻止程序执行，让线程完成它们的工作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-29T13:58:19.367

[Threading.Thread.Join](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)是您正在寻找的。

[编辑：这里的](http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx)例子

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-02T09:32:51.423

在这些线程加入后加载您的应用程序，例如：

```
Thread1.join();
Thread2.join();
Thread3.join();
Thread4.join();

startApplication(); 
```

如果您能提供更详细的信息，我可以为您提供更好的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T13:59:05.637

根据您启动 4 个线程的方式，WaitHandle.WaitAll 可能是一个不错的起点...

[http://msdn.microsoft.com/en-us/library/z6w25xa6.aspx](http://msdn.microsoft.com/en-us/library/z6w25xa6.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T13:59:27.053

Thread.Join 是你想要的。

# java - EJB3 - 处理非标准链接表

> ID：802485
> 
> 赞同：0
> 
> 时间：2009-04-29T13:58:37.383
> 
> 标签：java, jpa, ejb-3.0, java-ee-5

我有一种情况，我正在使用 EJB3 和遗留数据库。我有一种情况，两个表 A 和 B 之间存在多对多关系，通过第三个（链接）表 L 定义。

复杂之处在于链接表中除了表 A 和 B 的 PK 之外还有其他字段。这些列是标准时间戳和用户列，用于记录谁生成了链接。这两个附加列阻止我使用连接表注释定义多对多关系，因为它们不可为空，因此必须填充。

有谁知道绕过这个限制的方法？我可以定义从链接表到关系中的每个其他表的一对多关系，但这不是很优雅。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T16:47:48.070

是的，但你需要让它优雅。以下超类可用于将任意多对多关系定义为实体：

```
@MappedSuperclass
public abstract class ModelBaseRelationship {

    @Embeddable
    public static class Id implements Serializable {

        public Long entityId1;
        public Long entityId2;

        @Column(name = "ENTITY1_ID")
        public Long getEntityId1() {
            return entityId1;
        }

        @Column(name = "ENTITY2_ID")
        public Long getEntityId2() {
            return entityId2;
        }

        public Id() {
        }

        public Id(Long entityId1, Long entityId2) {
            this.entityId1 = entityId1;
            this.entityId2 = entityId2;
        }

        @Override
        public boolean equals(Object other) {
            if (other == null)
                return false;
            if (this == other)
                return true;
            if (!(other instanceof Id))
                return false;
            final Id that = (Id) other;
            return new EqualsBuilder().append(this.entityId1, that.getEntityId1()).append(this.entityId1, that.getEntityId2()).isEquals();
        }

        @Override
        public int hashCode() {
            return new HashCodeBuilder(11, 111).append(this.entityId1).append(this.entityId2).toHashCode();
        }

        protected void setEntityId1(Long theEntityId1) {
            entityId1 = theEntityId1;
        }

        protected void setEntityId2(Long theEntityId2) {
            entityId2 = theEntityId2;
        }
    }

    protected Id id = new Id();

    public ModelBaseRelationship() {
        super();
    }

    public ModelBaseRelationship(ModelBaseEntity entity1, ModelBaseEntity entity2) {
        this();
        this.id.entityId1 = entity1.getId();
        this.id.entityId2 = entity2.getId();
        setVersion(0);
    }

    @EmbeddedId
    public Id getId() {
        return id;
    }

    protected void setId(Id theId) {
        id = theId;
    }

} 
```

基于该超类（片段）的实体示例：

```
@Entity(name = "myRealEntity")
@Table(name = "REAL_TABLE_NAME", uniqueConstraints = { @UniqueConstraint(columnNames = {
 "FIRST_FK_ID", "SECOND_FK_ID" }) })
@AttributeOverrides( {
@AttributeOverride(name = "entityId1", column = @Column(name = "FIRST_FK_ID")),
@AttributeOverride(name = "entityId2", column = @Column(name = "SECOND_FK_ID"))    
})
public class ModelBaseRelationshipReferenceImpl extends ModelBaseRelationship {

  private Entity1OfManyToManyRelationship entity1;
  private Entity2OfManyToManyRelationship entity2;
  ...
  @ManyToOne
  @JoinColumn(name = "FIRST_FK_ID", insertable = false, updatable = false)
  public Entity1OfManyToManyRelationship getEntity1OfManyToManyRelationship() {
    return entity1;
  }

  @ManyToOne
  @JoinColumn(name = "SECOND_FK_ID", insertable = false, updatable = false)
  public Entity2OfManyToManyRelationship getEntity2OfManyToManyRelationship () {
    return entity2;
  }
...
} 
```

# c++ - 如何枚举/列出 Windows XP 中所有已安装的应用程序？

> ID：802499
> 
> 赞同：9
> 
> 时间：2009-04-29T14:02:12.447
> 
> 标签：c++, python, winapi, enumeration

当我说“已安装的应用程序”时，我基本上是指在[控制面板]->[添加/删除程序]中可见的任何应用程序。

我更喜欢用 Python 来做，但 C 或 C++ 也可以。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T14:06:25.900

如果您指的是控制面板中添加\删除程序中显示的已安装应用程序列表，您可以在注册表项中找到它：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall 
```

[可以在此处找到有关注册表树结构的更多信息](http://support.microsoft.com/kb/247501)。

您需要在 python 中使用[winreg API](http://docs.python.org/3.0/library/winreg.html)从注册表中读取值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T14:05:59.643

查看[Win32_Product](http://msdn.microsoft.com/en-us/library/aa394378(VS.85).aspx) WMI（Windows 管理规范）类。[这是在 Python 中使用 WMI 的教程](http://timgolden.me.uk/python/wmi.html)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-29T15:57:31.497

控制面板使用 Win32 COM api，这是官方的方法（参见 Google Groups，Win32）
从不依赖注册表。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-29T22:23:37.730

Microsoft Script Repository 有一个用于列出所有已安装软件的脚本。

```
import win32com.client
strComputer = "."
objWMIService = win32com.client.Dispatch("WbemScripting.SWbemLocator")
objSWbemServices = objWMIService.ConnectServer(strComputer,"root\cimv2")
colItems = objSWbemServices.ExecQuery("Select * from Win32_Product")
for objItem in colItems:
    print "Caption: ", objItem.Caption
    print "Description: ", objItem.Description
    print "Identifying Number: ", objItem.IdentifyingNumber
    print "Install Date: ", objItem.InstallDate
    print "Install Date 2: ", objItem.InstallDate2
    print "Install Location: ", objItem.InstallLocation
    print "Install State: ", objItem.InstallState
    print "Name: ", objItem.Name
    print "Package Cache: ", objItem.PackageCache
    print "SKU Number: ", objItem.SKUNumber
    print "Vendor: ", objItem.Vendor
    print "Version: ", objItem.Version 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-03-18T08:30:37.160

我见过的最好的基于注册表的实现是由 Chris Wright (chris128) 编写的，发布在[http://www.vbforums.com/showthread.php?t=598355](http://www.vbforums.com/showthread.php?t=598355)。它使用多个注册表项，并且比当前在此处发布的任何答案都复杂得多。它似乎产生了与添加/删除程序应用程序相同的结果，并且与 ARP 应用程序一样，它也提供了包含更新的选项。

虽然它是在 VB.NET 中实现的，但它应该很容易转换为其他 .NET 语言，如 C# 或 IronPython。我想如果你想要的话，首先转换到 IronPython 应该可以很容易地移植到常规 Python，但我只是自己将它转换为 C#，然后稍微清理了代码。

只有一个小错误需要指出：GetUserInstallerKeyPrograms() 不会将用户程序的版本添加到列表中，即使它提取了它。不过，这很容易解决。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-08-18T11:43:00.353

xp和win7中使用wmi获取已安装软件列表的c#.net代码（wmi是win7中唯一的方法）

```
 WqlObjectQuery wqlQuery =
      new WqlObjectQuery("SELECT * FROM Win32_Product");
        ManagementObjectSearcher searcher =
            new ManagementObjectSearcher(wqlQuery);

        foreach (ManagementObject software in searcher.Get()) {
            Console.WriteLine(software["Caption"]);
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-15T07:39:01.643

OP提到了XP，也提到了Python、C或C++，但我发现网上很多关于这个话题的信息要么不完整，要么不正确。后者的一个例子是使用 WMI 的建议——特别是`Win32_Product`类；然而，正如其他地方所指出的那样，这种方法很*慢*，部分原因是，不管你信不信，发现的每个 MSI 都实际运行了它的修复。我称该解决方案不正确，因为它的速度非常缓慢，并且具有令人讨厌的副作用。例如，您已经选择禁用程序的 Windows 服务，但调用`select * from Win32_Product`，作为确保 MSI 修复运行的一部分，显然会重新启用该服务。

对于它的价值，下面是我认为是迄今为止最完整的示例，尽管是在 C# 中（我根据 Framework 4.6.1 编译它，但较低版本也可能工作。）它列出了 32 位和 64 位安装程式; 它处理它使用的注册表项，并在一秒钟内运行，至少在缓存启动之后。欢迎改进。

它仍然缺少的一件事*是一些更新。*例如，当我在 Windows 10 系统上运行它并将其与控制面板 | 进行比较时 程序和功能 | 安装更新，我注意到它`Security Update for Adobe Flash Player`由于某种原因没有显示。

我对匿名方法没有任何充分的理由，这正是我当时的想法——一种方法中的方法解决方案。

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;
using Microsoft.Win32;

class Program
{
    static void Main(string[] args)
    {
        var result = InstalledProgram.GetAllInstalledPrograms();

        result.Sort((a, b) => a.DisplayName.CompareTo(b.DisplayName));

        foreach(var program in result)
        {
            if(!program.IsSystemComponent && !program.IsKB) Console.WriteLine(program.Dump());
        }
    }
}

public enum PlatformTypes
{
    x86,
    amd64
}

public class InstalledProgram
{
    [DllImport("advapi32.dll")]
    extern public static int RegQueryInfoKey(
        Microsoft.Win32.SafeHandles.SafeRegistryHandle hkey,
        StringBuilder lpClass,
        ref uint lpcbClass,
        IntPtr lpReserved,
        IntPtr lpcSubKeys,
        IntPtr lpcbMaxSubKeyLen,
        IntPtr lpcbMaxClassLen,
        IntPtr lpcValues,
        IntPtr lpcbMaxValueNameLen,
        IntPtr lpcbMaxValueLen,
        IntPtr lpcbSecurityDescriptor,
        out long lpftLastWriteTime
    );

    public string DisplayName { get; private set; }
    public string UninstallString { get; private set; }
    public string KBNumber { get; private set; }
    public string DisplayIcon { get; private set; }
    public string Version { get; private set; }
    public DateTime InstallDate { get; private set; }
    public PlatformTypes Platform { get; private set; }
    public bool IsSystemComponent { get; private set; }
    public bool IsKB { get { return !string.IsNullOrWhiteSpace(KBNumber); } }

    public static List<InstalledProgram> GetAllInstalledPrograms()
    {
        var result = new List<InstalledProgram>();

        Action<PlatformTypes, RegistryKey, string> getRegKeysForRegPath = (platform, regBase, path) =>
        {
            using(var baseKey = regBase.OpenSubKey(path))
            {
                if(baseKey != null)
                {
                    string[] subKeyNames = baseKey.GetSubKeyNames();
                    foreach(string subkeyName in subKeyNames)
                    {
                        using(var subKey = baseKey.OpenSubKey(subkeyName))
                        {
                            object o;

                            o = subKey.GetValue("DisplayName");
                            string displayName = o != null ? o.ToString() : "";
                            o = subKey.GetValue("UninstallString");
                            string uninstallString = o != null ? o.ToString() : "";
                            o = subKey.GetValue("KBNumber");
                            string kbNumber = o != null ? o.ToString() : "";
                            o = subKey.GetValue("DisplayIcon");
                            string displayIcon = o != null ? o.ToString() : "";
                            o = subKey.GetValue("DisplayVersion");
                            string version = o != null ? o.ToString() : "";
                            o = subKey.GetValue("InstallDate");
                            DateTime installDate = o != null ? parseInstallDate(o.ToString()) : default(DateTime);
                            o = subKey.GetValue("SystemComponent");
                            bool isSystemComponent = o != null ? o.ToString() == "1" : false;

                            // Sometimes, you need to get the KB number another way.
                            if(kbNumber == "")
                            {
                                var match = Regex.Match(displayName, @".*?\((KB\d+?)\).*");
                                if(match.Success) kbNumber = match.Groups[1].ToString();
                            }

                            // Sometimes, the only way you can get install date is from the last write
                            // time on the registry key.
                            if(installDate == default(DateTime))
                            {
                                string keyFull = baseKey + "\\" + subkeyName + "\\DisplayVersion";
                                var sb = new StringBuilder(64);
                                uint sbLen = 65;

                                RegQueryInfoKey(
                                        subKey.Handle
                                        , sb
                                        , ref sbLen
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , IntPtr.Zero
                                        , out long lastWriteTime);

                                installDate = DateTime.FromFileTime(lastWriteTime);
                            }

                            if(displayName != "" && uninstallString != "")
                            {
                                result.Add(new InstalledProgram
                                {
                                    DisplayName = displayName,
                                    UninstallString = uninstallString,
                                    KBNumber = kbNumber,
                                    DisplayIcon = displayIcon,
                                    Version = version,
                                    InstallDate = installDate,
                                    Platform = platform,
                                    IsSystemComponent = isSystemComponent
                                });
                            }
                        }
                    }
                }
            }
        };

        getRegKeysForRegPath(PlatformTypes.amd64, Registry.LocalMachine, @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall");
        getRegKeysForRegPath(PlatformTypes.amd64, Registry.CurrentUser, @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall");
        if(Environment.Is64BitOperatingSystem)
        {
            getRegKeysForRegPath(PlatformTypes.x86, Registry.LocalMachine, @"SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall");
            getRegKeysForRegPath(PlatformTypes.x86, Registry.CurrentUser, @"SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall");
        }

        return result;
    }

    public string Dump()
    {
        return Platform + "\t" + DisplayName + "\t" + InstallDate + "\t" + DisplayIcon + "\t" + Version + "\t" + KBNumber + "\t" + UninstallString;
    }

    private static DateTime parseInstallDate(string installDateStr)
    {
        DateTime.TryParseExact(
                installDateStr
                , format: "yyyyMMdd"
                , provider: new System.Globalization.CultureInfo("en-US")
                , style: System.Globalization.DateTimeStyles.None
                , result: out DateTime result);

        return result;
    }

    public override string ToString()
    {
        return DisplayName;
    }
} 
```

[叹气] 然后我看到了@PolyTekPatrick 的回答。我怎么错过了？

# version-control - 是否有任何可以理解代码的源代码控制合并工具？

> ID：802504
> 
> 赞同：11
> 
> 时间：2009-04-29T14:03:04.440
> 
> 标签：version-control, merge

我最近一直在研究大型代码库，重构并总体改进设计以增加覆盖率。此外，在相当多的文件中，我删除了多余的 using 语句，移动了方法以使相似的功能靠近在一起，添加了区域等，但实际上并没有改变文件中代码的功能。

同时，团队其他地方的其他开发人员正在修复错误并到处更改代码行。显然，在合并时这可能是一个问题，因为行号不再匹配并且方法可能已经移动。

现在，我了解了一般规则，即在源代码控制的环境中，移动方法可能是一件危险的事情，我们认为收益大于成本。然而，我不明白为什么它应该是这样的。

假设我的初始文件是一个简单的计算器：

```
public class Calculator
{
    public int Subtract(int a, int b)
    {
        return a + b;
    }

    public int Add(int a, int b)
    {
        return a + b;
    }
} 
```

我决定让这些方法按字母顺序排列：

```
public class Calculator
{
    public int Add(int a, int b)
    {
        return a + b;
    }

    public int Subtract(int a, int b)
    {
        return a + b;
    }        
} 
```

而另一位开发人员修复了减法中的错误

```
public class Calculator
{
    public int Subtract(int a, int b)
    {
        return a - b;
    }

    public int Add(int a, int b)
    {
        return a + b;
    }
} 
```

标准的合并工具可能需要您手动合并这两个文件，但是了解代码*功能*的工具很容易协调这两个更改。这同样适用于删除或添加其他方法、注释、区域或 using 语句。

So, to (finally!) get to the question: Are there any merge tools out there that have an intelligent understanding of the functionality of code and could merge the two files above without any human intervention? If not, why not? Are there any complications which make this an unsolvable problem (of course a understand it isn't as simple as I'm implying - but is it impossible for some reason that I can't see?)

I uses C# in my source code and would love something that worked with that, but I'm interested in if this exists anywhere in the world of programming...

* * *

I'm already really concerned about the length of this question, but edited to add how I would expect the intelligent source system to work:

When the initial calculator file was checked in the system would parse the file and create a hierarchy of the class:

```
File: Calculator.cs
|
|--Class[0]: Calculator
    |
    |--Method[0]: Subtract
         |
         |--Line[0]: return a + b;
    |
    |--Method[1]: Add
         |
         |--Line[0]: return a +b; 
```

(With extra lines in there for braces etc...)

When I check in my code (making the methods alphabetical) it updates the hierarchy above so that Subtract becomes Method[1] and Add becomes Method[0].

The second developer checks in his code (which obviously the source control system knows was based of the original) and notices the change to the first line in subtract. Now, rather than finding that line by line number in the overall file it knows that it can find it a Calculator.cs/Calculator/Subtract/0 and the fact that the method has changed location doesn't matter, it can still make the merge work.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T20:07:00.330

Our approach with Plastic SCM is still far from being "complete", but it's already released and can help in this kind of situations. Take a look at [Xmerge](http://codicesoftware.blogspot.com/2008/08/xmerge-tool-to-handle-refactors.html). Of course, feedback will be more than welcome and will grant some free licenses ;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T14:28:48.247

I think that [Source Code in Database](http://en.wikipedia.org/wiki/Source_Code_in_Database) is one potential answer to your question. The general idea is that you don't version files, you version blocks of code. The versioning system knows about the code DOM, and lets you query on the code DOM in order to check out functions, classes, what-have-you, for editing, compiling, etc.

Since the order of the methods doesn't necessarily matter, they're not stored in the Database with any order in mind. When you check out the class, you can specify the order that you like best (alphabetical, public/protected/private, etc). The only changes that matter are the ones like where you switch the `+` to a `-`. You won't have a conflict due to reordering the methods.

Unfortunately, SCID is still VERY young and there aren't many tools out there for it. However, it is quite an interesting evolution in the way one views and edits code.

**Edit:** [Here's another reference for SCID](http://www.scribd.com/doc/3010319/Source-Code-in-Database-SCID)

# c# - 无法让嵌套在 UpdatePanel 中的 WebControl 中的 ScriptManager.RegisterStartupScript 工作

> ID：802506
> 
> 赞同：33
> 
> 时间：2009-04-29T14:04:36.433
> 
> 标签：c#, asp.net, ajax, updatepanel, scriptmanager

我遇到了我认为应该是一个相当简单的问题，但是对于我的生活，我看不到我的问题。问题与 ScriptManager.RegisterStartupScript 有关，我以前使用过很多次。

我的情况是我有一个已插入页面的自定义 Web 控件。控件（以及一两个其他控件）嵌套在 UpdatePanel 中。它们被插入到页面上的 PlaceHolder 上：

```
<asp:UpdatePanel ID="pnlAjax" runat="server">
  <ContentTemplate>
    <asp:PlaceHolder ID="placeholder" runat="server">
    </asp:PlaceHolder>
    ...

protected override void OnInit(EventArgs e){
  placeholder.Controls.Add(Factory.CreateControl());
  base.OnInit(e);
} 
```

这是页面上唯一的更新面板。

该控件需要运行一些初始 javascript 才能正常工作。控制调用：

```
ScriptManager.RegisterStartupScript(this, GetType(), 
                                    Guid.NewGuid().ToString(), script, true); 
```

我也试过：

```
ScriptManager.RegisterStartupScript(Page, Page.GetType(), 
                                    Guid.NewGuid().ToString(), script, true); 
```

问题是脚本在页面首次显示时正确运行，但在部分回发后没有重新运行。我尝试了以下方法：

1.  从 CreateChildControls 调用 RegisterStartupScript
2.  从 OnLoad / OnPreRender 调用 RegisterStartupScript
3.  对前两个参数使用不同的参数组合（在上面的示例中，Control 是 Page，Type 是 GetType()，但我尝试过使用控件本身等）。
4.  我尝试过使用持久性和新的 id（并不是说我认为这两种方式都会产生重大影响）。
5.  我使用了一些断点，因此验证了 Register 行被正确调用。

我唯一没有尝试过的是将 UpdatePanel 本身用作控件和类型，因为我不认为控件应该知道更新面板（无论如何似乎都不是获取更新的好方法控制板？）。

谁能看到我在上面做错了什么？

谢谢 ：）

* * *

好吧，回答上面的查询 - 它确实看起来好像占位符以某种方式弄乱了 ScriptManager.RegisterStartupScript。

当我将控件从占位符中拉出并将其直接编码到页面上时，Register 脚本可以正常工作（我也将控件本身用作参数）。

```
ScriptManager.RegisterStartupScript(this, GetType(), Guid.NewGuid().ToString(), script, true);

```

任何人都可以解释为什么注入到 PlaceHolder 上的控件会阻止 ScriptManager 正确注册脚本吗？我猜这可能与动态控件的生命周期有关，但如果上述过程有正确的过程，我将不胜感激（据我所知）。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-11-09T16:27:35.260

我在用户控件中使用它时遇到了问题（在一个工作正常的页面中）；Button1 位于 内部`updatepanel`，而`scriptmanager`位于`usercontrol`.

```
protected void Button1_Click(object sender, EventArgs e)  
{  
    string scriptstring = "alert('Welcome');";  
    ScriptManager.RegisterStartupScript(this, this.GetType(), "alertscript", scriptstring, true);  
} 
```

现在看来您必须小心前两个参数，它们需要引用您的页面，而不是您的控件

```
ScriptManager.RegisterStartupScript(this.Page, this.Page.GetType(), "alertscript", scriptstring, true); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-29T22:03:07.423

我认为您确实应该使用 RegisterStartupScript 的[Control 重载](http://msdn.microsoft.com/en-us/library/bb359558.aspx)。

我在服务器控件中尝试了以下代码：

```
[ToolboxData("<{0}:AlertControl runat=server></{0}:AlertControl>")]
public class AlertControl : Control{
    protected override void OnInit(EventArgs e){
        base.OnInit(e);
        string script = "alert(\"Hello!\");";
        ScriptManager.RegisterStartupScript(this, GetType(), 
                      "ServerControlScript", script, true);
    }
} 
```

然后在我的页面中，我有：

```
protected override void OnInit(EventArgs e){
    base.OnInit(e);
    Placeholder1.Controls.Add(new AlertControl());
} 
```

其中 Placeholder1 是更新面板中的占位符。占位符中有几个其他控件，包括按钮。

这与您预期的完全一样，每次我加载页面或导致更新面板更新时，我都会收到一条警告说“你好”。

您可以查看的另一件事是挂钩在更新面板请求期间触发的一些页面生命周期事件：

```
Sys.WebForms.PageRequestManager.getInstance()
   .add_endRequest(EndRequestHandler); 
```

[每次更新面板完成更新时都会触发PageRequestManager endRequestHandler](http://msdn.microsoft.com/en-us/library/bb383810.aspx)事件 -这将允许您调用一个方法来设置您的控件。

我唯一的其他问题是：

*   你的脚本实际上在做什么？
*   大概您可以在页面底部的 HTML 中看到脚本（就在结束 </form> 标记之前）？
*   你试过放几个“alert(“Here”);” 在您的启动脚本中调用以查看它是否被正确调用？
*   您是否尝试过 Firefox 和[Firebug](http://getfirebug.com/) - 是否报告任何脚本错误？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-29T14:35:57.357

当您调用 ScriptManager.RegisterStartupScript 时，“Control”参数必须是要更新的 UpdatePanel 中的控件。您需要将其更改为：

```
ScriptManager.RegisterStartupScript(this, this.GetType(), Guid.NewGuid().ToString(), script, true); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T20:42:48.300

解决方案是将脚本放在外部 js 文件中（让我们称为“yourDynamic.js”），并在每次刷新更新面板时重新注册 de 文件。

我在 updatepanel_prerender 事件中使用它：

```
ScriptManager.RegisterClientScriptBlock(UpdatePanel1, UpdatePanel1.GetType(), "UpdatePanel1_PreRender", _
                   "<script type='text/javascript' id='UpdatePanel1_PreRender'>" & _
                   "include('yourDynamic.js');" & _
                   "removeDuplicatedScript('UpdatePanel1_PreRender');</script>" _
                   , False) 
```

在页面或其他一些包含中，您将需要此 javascript：

```
// Include a javascript file inside another one.
function include(filename)
{
    var head = document.getElementsByTagName('head')[0];

    var scripts = document.getElementsByTagName('script');
    for(var x=0;x<scripts.length;>    {
        if (scripts[x].getAttribute('src'))
        {
            if(scripts[x].getAttribute('src').indexOf(filename) != -1)
            {
                head.removeChild(scripts[x]);
                break;
            }
        }
    }

    script = document.createElement('script');
    script.src = filename;
    script.type = 'text/javascript';
    head.appendChild(script)
}

// Removes duplicated scripts.
function removeDuplicatedScript(id)
{
    var count = 0;
    var head = document.getElementsByTagName('head')[0];

    var scripts = document.getElementsByTagName('script');
    var firstScript;
    for(var x=0;x<scripts.length;>    {
        if (scripts[x].getAttribute('id'))
        {
            if(scripts[x].getAttribute('id').indexOf(id) != -1)
            {
                if (count == 0)
                {
                    firstScript = scripts[x];
                    count++;
                }
                else
                {
                    head.removeChild(firstScript);
                    firstScript = scripts[x];
                    count = 1;
                }
            }
        }
    }
    clearAjaxNetJunk();
}
// Evoids the update panel auto generated scripts to grow to inifity. X-(
function clearAjaxNetJunk()
{
    var knowJunk = 'Sys.Application.add_init(function() {';
    var count = 0;
    var head = document.getElementsByTagName('head')[0];

    var scripts = document.getElementsByTagName('script');
    var firstScript;
    for(var x=0;x<scripts.length;>    {
        if (scripts[x].textContent)
        {
            if(scripts[x].textContent.indexOf(knowJunk) != -1)
            {
                if (count == 0)
                {
                    firstScript = scripts[x];
                    count++;
                }
                else
                {
                    head.removeChild(firstScript);
                    firstScript = scripts[x];
                    count = 1;
                }
            }
        }
    }
} 
```

很酷，啊...jejeje 这部分是我前段时间[在这里](http://www.codeproject.com/KB/aspnet/scriptregister.aspx?fid=31175&select=2882280&fr=1#xx2882280xx)发布的。

希望这有帮助... :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T20:55:11.097

我遇到了 Page.ClientScript.RegisterStartUpScript 的问题 - 我没有使用更新面板，但控件已被缓存。这意味着我必须将脚本插入到 Literal 中（或者可以使用 PlaceHolder），因此当从缓存中渲染时，脚本会被包含在内。

类似的解决方案可能对您有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-25T05:11:23.690

不要将 GUID 用于密钥

```
ScriptManager.RegisterClientScriptBlock(this.Page, typeof(UpdatePanel) 
       Guid.NewGuid().ToString(), myScript, true); 
```

如果你想这样做，调用Something Like this function

```
 public static string GetGuidClear(string x)
 {
      return x.Replace("-", "").Replace("0", "").Replace("1", "")
              .Replace("2",  "").Replace("3", "").Replace("4", "")
              .Replace("5", "").Replace("6", "").Replace("7", "")
              .Replace("8", "").Replace("9", "");
 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T19:07:54.667

我尝试了很多东西，最后发现最后一个参数一定是假的，你必须`<SCRIPT>`在java脚本中添加标签：

```
string script = "< SCRIPT >alert('hello!');< /SCRIPT>";

ScriptManager.RegisterClientScriptBlock(Page, Page.GetType(), key, script, **false**); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-22T11:46:33.090

对我有用的是在页面上注册它，同时将类型指定为 UpdatePanel 的类型，如下所示：

```
ScriptManager.RegisterClientScriptBlock(this.Page, typeof(UpdatePanel) Guid.NewGuid().ToString(), myScript, true); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-20T07:45:41.547

有时当脚本有一些语法错误时它不会触发，请确保脚本和 javascript 语法正确。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-02T15:59:44.467

```
ScriptManager.RegisterStartupScript(this, this.GetType(), Guid.NewGuid().ToString(),script,  true ); 
```

ScriptManager.RegisterStartupScript 末尾的“true”参数值将在您的页面内添加一个 JavaScript 标记：

```
<script language='javascript' defer='defer'>your script</script > 
```

如果该值为“false”，它将仅注入没有 --script-- 标签的脚本。

# asp.net - 什么可能导致 ASP.NET 在调试中跳过行？

> ID：802507
> 
> 赞同：3
> 
> 时间：2009-04-29T14:05:36.603
> 
> 标签：asp.net, visual-studio, visual-studio-2008, debugging

我以前从未遇到过这个问题，但我最近重新安装了我的计算机，Visual Studio 在调试 ASP.NET 站点时表现不佳。

我将 Visual Studio 2008 附加到 w3wp 进程以调试网站。当我用F10逐行调试方法时，有时Visual Studio会决定它继续直到遇到断点......这几乎就像我按下F5让它继续，但我按下F10。例如，如果多次调用方法调用并且开头有断点，而我在方法内逐行调试时，有时执行会无缘无故地继续到开头的断点，所以我失去了所有调试...

以前有人遇到过这个问题吗？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-10T10:06:10.257

我有同样的问题，每当我按下步进或步进时，它都会继续执行，就像我按下 F5 一样。仅当我在要评估的每一行上放置一个断点时，调试才有效。除了我和海报还有其他人经历过吗？

我试过重新安装 VS 和一切，但这没有帮助。此外，调试在其他一些项目中确实有效，特别是特定的 WinForms 项目，当我按下 web 服务调用并“附加”时，调试仍然可以正常工作。

* * *

好的，更新...我发现我的问题在于编译中的优化。我在调试配置中打开了优化。

## 确保取消选中所有项目及其引用的调试配置。

也试试：[http ://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/f3fcb4fb-8a08-4fa0-8d58-9ed6f3eb1193](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/f3fcb4fb-8a08-4fa0-8d58-9ed6f3eb1193)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-26T18:28:31.783

这个问题的补丁在这里：[http ://code.msdn.microsoft.com/KB957912/Release/ProjectReleases.aspx?ReleaseId=1796](http://code.msdn.microsoft.com/KB957912/Release/ProjectReleases.aspx?ReleaseId=1796)

KB957912 - Visual Studio 2008 SP1 调试和断点更新

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T14:11:21.520

Cehck 以确保您的构建模式设置为调试而不是发布。在发布模式下，优化器被打开，代码可以重新排列或删除。从实际代码的角度来看，您的断点可能没有意义。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-29T14:13:35.367

您可能正在调试带有过期 PDB 文件的程序集，或者代码可能已更改且未重新编译。

无论如何，听起来您之间的某个地方不匹配：

*   代码
*   dll
*   数据库

（正如另一个人指出的那样，确保您是在 Debug 中构建，而不是在 Release 中构建）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-14T15:47:52.450

重建计算机后，我遇到了同样的问题。在寻找答案后，我找到了这个线程。对我来说，**解决方案**是在 MSDN 上找到的修补程序，由该线程中的用户指出。

[http://code.msdn.microsoft.com/KB957912/Release/ProjectReleases.aspx?ReleaseId=1796](http://code.msdn.microsoft.com/KB957912/Release/ProjectReleases.aspx?ReleaseId=1796)

--值得注意的讨论--

MSDN 也有一个很棒的主题讨论，用户在这个线程中也注意到了，其中包含一些解决方法和补丁链接。

social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/f3fcb4fb-8a08-4fa0-8d58-9ed6f3eb1193

我看过一篇文章，其中将以下代码行放在 Page_Load(...) 方法的开头。就我个人而言，这对我来说不是一个选择，但如果你对这是一个解决你的问题的方法感到满意并且它可以工作......

Response.Cache.SetCacheability(HttpCacheability.NoCache);

我的设置： - Windows XP pro - Pentium 4 3.0GHz 超线程 - VS 2008 专业版 - .NET Framework 3.5 SP1 - SQL Server 2008 - 开发语言：c#

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T14:12:14.293

这几乎听起来就像您在调试时遇到的行为，同时有多个线程或请求并行进行，或者如果您的方法进行递归调用。你确定这不是发生的事情吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-19T13:46:07.613

对我来说，它只有在清理和重建解决方案后才开始工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-10T17:37:45.923

确保你的行尾是一致的。Windows 喜欢 CR/LF。有时，如果它们不一致，它会混淆它在哪条线上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T20:54:09.943

解决方法在这里[http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/f3fcb4fb-8a08-4fa0-8d58-9ed6f3eb1193](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/f3fcb4fb-8a08-4fa0-8d58-9ed6f3eb1193)：

1) 打开 Visual Studio 但不要打开任何项目。

2) 启动任务管理器 (Ctrl+Shift+Esc) 并导航到“进程”选项卡。

3) 右键单击​​ devenv.exe 并选择“Set Affinity...”（此选项仅在多处理器或多核机器上可用）。

4) 取消选中除一个以外的所有 CPU，然后单击确定。

5）打开您的项目并正常调试。

Silverlight 工具并没有解决这个问题，而且这个论坛帖子中提供的其他补丁也没有。这是我发现的唯一可行的解​​决方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-29T14:15:22.430

逐行调试是F11（Step Into），而不是F10（Step Over）。

Step Over 将跳过对您调用的任何方法的调试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-29T14:16:39.853

另一种想法-您是否尝试过使用 step into (F11) 而不是 step over (F10)。如果您发现方法调用似乎被“跳过”了，那么您可能正在执行下一行而没有实际进入它......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-29T14:13:11.500

您没有使用多个线程是吗？这可能会导致这种行为。

你是在不同的项目中遇到这个问题，还是在一个项目中？

# wcf - 通过浏览器调用 WCF 服务方法

> ID：802518
> 
> 赞同：29
> 
> 时间：2009-04-29T14:07:09.423
> 
> 标签：wcf, web-services

我有一个使用基本 http 绑定的 WCF 服务。如何通过浏览器调用其操作/方法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-15T10:32:38.153

您需要将 WebGetAttribute 添加到您的方法中，如以下示例

```
[OperationContract]
[WebGet(UriTemplate = "/placesList/{userId}",
ResponseFormat = WebMessageFormat.Xml)]
List<Places> GetAllPlacesForUser(String userId)
{
  string xml = "";
  // build xml here
  return xml;
} 
```

现在在浏览器中，您可以像这样调用该方法

> [http://localhost:8085/GeoPlacesDataService/placesList/10](http://localhost:8085/GeoPlacesDataService/placesList/10)
> 其中 10 是 userId 参数。

注意：*为了添加 WebGetAttribute，您必须引用 System.ServiceModel.Web 命名空间，该命名空间位于单独的程序集中*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T18:58:10.923

我建议为服务设置多个端点。使用 webHttpBinding 添加端点以获取服务的 XML 版本。如果正确执行此操作，您将从服务获得的响应与 basicHttpBinding 端点相同，但没有 SOAP 开销。

除此之外，您不能直接从浏览器调用 SOAP Web 服务，因为它需要表单发布。不过，您可以使用一个工具来使用 SOAP 对其进行测试，我推荐[Soap UI](http://www.soapui.org/)。它是用 Java 编写的，但我尽量不反对它。:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-09-02T16:32:31.373

添加上述代码后，必须在**web.config**中修改 endpoint 属性，`binding="webHttpBinding"`并且`behaviorConfiguration="webHttp"`.

# asp.net - 跟踪母版页中选定的列表项

> ID：802531
> 
> 赞同：1
> 
> 时间：2009-04-29T14:11:48.960
> 
> 标签：asp.net, javascript

根据 stackoverflow 中标题的功能（问题、标签、用户、徽章等），我想跟踪用户在 ASP.NET MVC 视图中选择的列表项，以便我可以应用不同的样式或图像。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T14:25:14.870

如果您仔细查看 Stack Overflow，您会注意到这些链接中的每一个都指向不同的控制器，这很可能（我猜）只是通过公共母版页重用一些 UI 元素来呈现不同的视图。所以没有必要“记住”任何东西，返回页面的外观是在该页面的视图中定义的。

# mysql - 为什么我们的查询会卡在 MySql 中的“Writing to net”状态？

> ID：802534
> 
> 赞同：5
> 
> 时间：2009-04-29T14:13:05.507
> 
> 标签：mysql

我们有很多疑问

```
select * from tbl_message 
```

卡在“写入网络”状态。该表有 98k 行。

问题是......我们甚至没有从我们的应用程序中执行任何类似的查询，所以我想问题是：

*   什么可能会生成查询？
*   ...以及为什么它会卡在*“写入网络”状态*

问这个问题我觉得很愚蠢，但我 99,99% 确信我们的应用程序没有对我们的数据库执行这样的查询……但是，我们正在使用 WHERE 语句对该表执行几个查询：

```
 SELECT Count(*) as StrCount FROM tbl_message WHERE m_to=1960412 AND m_restid=948

 SELECT Count(m_id) AS NrUnreadMail FROM tbl_message WHERE m_to=2019422 AND m_restid=440 AND m_read=1

 SELECT * FROM tbl_message WHERE m_to=2036390 AND m_restid=994 ORDER BY m_id DESC 
```

我已经多次搜索我们的应用程序`select * from tbl_message`但没有找到任何东西......但是我们的 mysql 服务器上的查询日志仍然充满了`Select * from tbl_message`查询

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T14:42:43.423

由于应用程序不会像他们喜欢的那样神奇地生成查询，我认为很可能是您的应用程序中的某个错误导致了这种情况。这里有一些建议，您可以使用它来追踪它。我猜你使用的是 PHP，因为你使用的是 MySQL，所以我将在我的示例中使用它。

尝试在应用程序中的所有查询前添加注释，如下所示：

```
$sqlSelect  = "/* file.php, class::method() */";
$sqlSelect .= "SELECT * FROM foo ";
$sqlSelect .= "WHERE criteria"; 
```

该评论将显示在您的查询日志中。如果您使用某种数据库 api 包装器，您可能会自动添加这些消息：

```
function query($sql)
{
    $backtrace = debug_backtrace();
    // The function that executed the query
    $prev = $backtrace[1];
    $newSql = sprintf("/* %s */ ", $prev["function"]);
    $newSql .= $sql;

    mysql_query($newSql) or handle_error();
} 
```

如果您不使用包装器，而是直接执行查询，则可以使用 runkit 扩展和函数[runkit_function_rename](http://se2.php.net/manual/en/function.runkit-function-rename.php)重命名 mysql_query（或您正在使用的任何内容）并拦截查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:43:44.140

mysql 有（至少）两种数据检索模式。使用 c api，您可以调用[mysql_store_result()](http://dev.mysql.com/doc/refman/5.0/en/mysql-store-result.html)或[mysql_use_result()](http://dev.mysql.com/doc/refman/5.0/en/mysql-use-result.html)。
当所有结果数据从 MySQL 服务器传输到进程的内存时，mysql_store_result() 返回，即无需传输任何数据以进一步调用 mysql_fetch_row()。

*但是，通过使用 mysql_use_result()，如果*调用 mysql_fetch_row()，则必须单独获取每条记录。如果您的应用程序在两次调用 mysql_fetch_row() 之间进行的某些计算花费的时间超过[net_write_timeout](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_net_read_timeout)中指定的时间段，则 MySQL 服务器认为您的连接超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:50:55.277

通过放置临时启用查询日志

```
log= 
```

进入您的 my.cnf 文件，重新启动 mysql 并查看查询日志以查找那些神秘查询（您不必为日志命名，它会假定主机值中的一个）。

# c# - 是否有将元素 T 添加到 IEnumerable 的语句

> ID：802537
> 
> 赞同：23
> 
> 时间：2009-04-29T14:13:23.650
> 
> 标签：c#, linq

例如：

```
string element = 'a';
IEnumerable<string> list = new List<string>{ 'b', 'c', 'd' };

IEnumerable<string> singleList = ???; //singleList yields 'a', 'b', 'c', 'd' 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-29T14:16:28.947

我认为您不能只`Insert`进入现有列表吗？

好吧，你可以使用`new[] {element}.Concat(list)`.

否则，您可以编写自己的扩展方法：

```
 public static IEnumerable<T> Prepend<T>(
            this IEnumerable<T> values, T value) {
        yield return value;
        foreach (T item in values) {
            yield return item;
        }
    }
    ...

    var singleList = list.Prepend("a"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-11-02T11:50:07.593

由于 .NET 框架 4.7.1 有 LINQ 方法：

```
list.Prepend("a"); 
```

[https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.prepend?view=netframework-4.7.1](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.prepend?view=netframework-4.7.1)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-29T14:21:38.420

您可以自己滚动：

```
static IEnumerable<T> Prepend<T>(this IEnumerable<T> seq, T val) {
 yield return val;
 foreach (T t in seq) {
  yield return t;
 }
} 
```

然后使用它：

```
IEnumerable<string> singleList = list.Prepend(element); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-29T14:23:07.810

```
public static class IEnumerableExtensions
{
    public static IEnumerable<T> Prepend<T>(this IEnumerable<T> ie, T item)
    {
         return new T[] { item }.Concat(ie);
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T14:24:03.360

这样就可以了...

```
IEnumerable<string> singleList = new[] {element}.Concat(list); 
```

如果您希望 singleList 成为 List 那么...

```
IEnumerable<string> singleList = new List<string>() {element}.Concat(list); 
```

...也可以。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-29T14:28:33.070

还：

```
IEnumerable<string> items = Enumerable.Repeat(item, 1).Concat(list); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-05-14T15:45:39.200

我发现能够以可链接的方式预先添加多个项目很方便。这个版本利用了扩展方法和`params`.

请注意，此版本隐式允许，但如果这是所需的行为，`null`也很容易将其更改为。`throw new NullReferenceException()`

```
public static class IEnumerableExtensions
{
    public static IEnumerable<T> Prepend<T>(this IEnumerable<T> source, params T[] items)
    {
        return items.Concat(source ?? new T[0]);
    }
} 
```

允许对单个项目使用非常易读的语法：

```
GetItems().Prepend(first, second, third); 
```

...对于项目集合：

```
GetItems().Prepend(GetMoreItems()); 
```

* * *

完成问题中的示例会导致：

```
string element = "a";
IEnumerable<string> list = new List<string>{ "b", "c", "d" };

IEnumerable<string> singleList = list.Prepend(element); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T14:20:03.230

不，没有这样的内置语句，语句，但是实现这样的功能是微不足道的：

```
IEnumerable<T> PrependTo<T>(IEnumerable<T> underlyingEnumerable, params T[] values)
{
    foreach(T value in values)
        yield return value;

    foreach(T value in underlyingEnumerable)
        yield return value;
}

IEnumerable<string> singleList = PrependTo(list, element); 
```

如果 C# 版本允许，您甚至可以将其作为扩展方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-09T04:41:59.500

提醒一下 - *List< T >*不是唯一的容器类型。如果你发现自己经常在列表的前面添加元素，你也可以考虑使用*Stack<T>*来实现你的容器。一旦你有一个堆栈

```
var container = new Stack<string>(new string[] { "b", "c", "d" }); 
```

你总是可以通过“前置”一个元素

```
container.Push("a"); 
```

并且仍然使用集合作为*IEnumerable< T >*就像在

```
foreach (var s in container)
    // do sth with s 
```

除了所有其他典型的堆栈方法，如 Pop()、Peek()、...

上面的一些解决方案遍历整个*IEnumeration< T >*只是为了添加一个元素（或在一种情况下多于一个）。如果您的集合包含大量元素并且前置频率相对较高，这可能是一项非常昂贵的操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-22T00:03:25.883

查看一些示例，我想我更愿意将扩展名反转以应用于对象。

```
public static IEnumerable<T> PrependTo<T>(this T value, IEnumerable<T> values) {
    return new[] { value }.Concat(values);
} 
```

像这样使用

```
var singleList = element.PrependTo(list); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-09T17:33:00.107

正如 Niklas 和 NetMage 在评论中指出的那样。

C# 中有一个新的内置 Prepend 方法。

[![在此处输入图像描述](https://i.stack.imgur.com/cieSH.png)](https://i.stack.imgur.com/cieSH.png)

# javascript - 有没有什么好的插件可以在Eclipse中开发javascript

> ID：802539
> 
> 赞同：0
> 
> 时间：2009-04-29T14:14:38.640
> 
> 标签：javascript, eclipse-plugin

**复制：**

> [Eclipse 最好的 Javascript 插件是什么？](https://stackoverflow.com/questions/613988/what-is-the-best-javascript-plugin-for-eclipse)

日食？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:19:05.447

您是否正在寻找更多，因为[JSEclipse](http://www.interaktonline.com/products/eclipse/jseclipse/overview/) 是一个很好的插件。

如果要寻找更多，那么[SourceForge](http://sourceforge.net/project/showfiles.php?group_id=71174)有一些您可以查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:26:37.097

[Aptana Studio](http://www.aptana.com/)插件中固有的 JavaScript 支持非常好，尽管并非没有问题。

它是免费的，当然值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:20:32.370

JSEclipse 是（据我所知）Eclipse 的首屈一指和几乎唯一的 JavaScript 编辑器，但它不是免费的，有些人可能会对此感到不快。同样麻烦的是，其网站上提供的论坛链接现在似乎已失效：也许是一个垂死社区的迹象？

# c# - 在 C# 中创建一个空文件

> ID：802541
> 
> 赞同：210
> 
> 时间：2009-04-29T14:14:42.073
> 
> 标签：c#, .net

在 C#/.NET 中创建空文件的最简单/规范的方法是什么？

到目前为止我能找到的最简单的方法是：

```
System.IO.File.WriteAllLines(filename, new string[0]); 
```

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2009-04-29T14:23:06.687

使用 just`File.Create`会使文件保持打开状态，这可能不是您想要的。

你可以使用：

```
using (File.Create(filename)) ; 
```

请注意，这看起来有点奇怪。您可以改用大括号：

```
using (File.Create(filename)) {} 
```

或者直接调用`Dispose`：

```
File.Create(filename).Dispose(); 
```

无论哪种方式，如果您要在多个地方使用它，您可能应该考虑将其包装在辅助方法中，例如

```
public static void CreateEmptyFile(string filename)
{
    File.Create(filename).Dispose();
} 
```

请注意，据我所知，`Dispose`直接调用而不是使用`using`语句在这里并没有太大的区别——唯一*可以*`File.Create`产生影响的方法是线程在调用和调用之间中止`Dispose`。如果存在该竞争条件，我怀疑它*也会*存在于`using`版本中，如果线程在`File.Create`方法的最后中止，就在返回值之前......

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-29T14:18:50.283

```
File.WriteAllText("path", String.Empty); 
```

或者

```
File.CreateText("path").Close(); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-29T14:16:27.747

```
System.IO.File.Create(@"C:\Temp.txt"); 
```

正如其他人指出的那样，您应该处置此对象或将其包装在一个空的 using 语句中。

```
using (System.IO.File.Create(@"C:\Temp.txt")); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-11-23T04:49:47.220

为避免意外覆盖现有文件，请使用：

```
using (new FileStream(filename, FileMode.CreateNew)) {} 
```

...并处理文件已存在时将发生的 IOException。

`File.Create`，在其他答案中建议，如果文件已经存在，它将覆盖文件的内容。在简单的情况下，您可以使用`File.Exists()`. 然而，在多个线程和/或进程试图同时在同一个文件夹中创建文件的情况下，需要更强大的东西。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-29T18:37:26.777

您可以将方法链接到返回的对象，这样您就可以立即关闭刚刚在单个语句中打开的文件。

```
File.Open("filename", FileMode.Create).Close(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-30T20:50:22.740

创建空文件的一个常见用例是在没有更复杂的进程通信的情况下触发不同进程中发生的其他事情。在这种情况下，从外部世界的角度来看，让文件创建是原子的会有所帮助（特别是如果被触发的事物将删除文件以“使用”触发器）。

因此，它可以帮助在与您要创建的文件相同的目录中创建一个垃圾名称 (Guid.NewGuid.ToString())，然后从临时名称执行 File.Move 到您想要的名称。否则，检查文件是否存在然后删除触发器的触发代码可能会遇到竞争条件，即文件在完全关闭之前被删除。

将临时文件放在同一目录（和文件系统）中可为您提供您可能想要的原子性。这给出了类似的东西。

```
public void CreateEmptyFile(string path)
{
    string tempFilePath = Path.Combine(Path.GetDirectoryName(path),
        Guid.NewGuid.ToString());
    using (File.Create(tempFilePath)) {}
    File.Move(tempFilePath, path);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T14:22:11.133

Path.GetTempFileName() 将创建一个唯一命名的空文件并返回它的路径。

如果您想控制路径但获得一个随机文件名，您可以使用 GetRandomFileName 只返回一个文件名字符串并将其与 Create 一起使用

例如：

```
string fileName=Path.GetRandomFileName();
File.Create("custom\\path\\" + fileName); 
```

# sql - SQL Server - SQL 游标与 ADO.NET

> ID：802549
> 
> 赞同：2
> 
> 时间：2009-04-29T14:16:01.600
> 
> 标签：sql, ado.net, cursors

我必须计算一个涉及来自多个表的数据的值。我想知道与将数据读入数据集（使用简单的选择存储过程）然后循环遍历记录相比，使用带有游标的存储过程是否会提供性能优势？数据集并不大，它由 6 个表组成，每个表大约有 10 条记录，主要是 GUID、几个 nvarchar(100) 字段、一个浮点列和一个 nvarchar(max)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T14:19:49.720

这可能取决于您可能要检索的数据集（集合越大，在 SQL Server 内部执行而不是传递它可能越合乎逻辑），但我倾向于认为，如果您要执行计算，在您的代码中执行此操作，并远离您的存储过程。如果您需要使用游标将数据拉到一起，就这样吧，但我认为应该避免使用它们进行计算和其他非检索功能。

**编辑**：这个对另一个相关问题的[回答](https://stackoverflow.com/questions/139843/cursor-vs-while-loop-what-are-advantage-disadvantages-of-cursors-mssql/139905#139905)会给游标与循环带来一些利弊。这个答案似乎与我之前关于缩放的断言（见上文）相冲突。似乎表明你得到的越大，你可能越想将它移到你的代码而不是存储过程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:33:01.780

游标应该更快，但如果你有很多用户运行它，它会消耗你的服务器资源。请记住，在 .Net 而不是 SQL 中编写循环时，您拥有更强大的编码语言。

很少有游标无法使用基于标准集的 SQL 替换的情况。如果您在服务器上执行此操作，则可以使用基于集合的操作。关于你在做什么的更多细节？

如果您决定使用游标，请记住 FAST_FORWARD 只读游标将为您提供最佳性能，并确保您使用 deallocate 语句来释放它。有关光标提示，请参见[此处](http://www.mssqlcity.com/Tips/tipCursor.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:56:59.210

光标的替代品

```
declare @table table (Fields int)
declare @count int
declare @i

insert inot @table (Fields)
select Fields
from Table

select @count = count(*) from @table

while (@i<=@count)
begin

--whatever you need to do
set @i = @i + 1

end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T14:18:39.223

游标应该更快（除非您在 SQL 而不是在 ADO.NET 中做一些奇怪的事情）。

也就是说，我经常发现游标可以通过一点点跑腿来消除。你需要做什么手续？

干杯，
埃里克

# project-management - 曾经不得不或多或少地让自己完全退出一个项目吗？

> ID：802551
> 
> 赞同：2
> 
> 时间：2009-04-29T14:16:17.683
> 
> 标签：project-management

我最近有一个项目几乎惨败。对我来说，这是一次彻底的失败，但不知何故它过去了，不应该，只是过去了。各方都有很多善意，责任平分。但是现在我将项目文件放入“冷库”，我想知道“最坏的情况”会发生什么。你在一艘正在下沉的船上，复杂性正在爆炸，因为规范中有一个（不是那么）微小的漏洞，客户完全崩溃了，这根本无法完成

曾经不得不在中途完全说服自己退出项目吗？效果如何？
你的反应是什么，你做了什么（或打算做什么）来避免将来发生此类事情？就像“从现在开始就是混乱或破产”，“该死，我再也不会做 xyz”，“嗯，我的保险是否涵盖*了*”，或者甚至可能是“狗屎发生，停止抱怨并克服它”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T16:12:22.320

我们有一个项目，其中一个要求是保证响应时间。经过几个月的开发，我们无法兑现这一承诺。更糟糕的是，我们将问题隐藏得太久了。演示文稿是这样的：这是最后一个里程碑，顺便说一句，我们错过了响应时间。彻底的灾难。我没有参与接下来的谈判，但据我所知，这很丑陋。毫无疑问，必须解决技术问题和设计缺陷。但在我看来，最关键的后果是：我们现在更加重视状态报告。不是以微观管理的方式，但至少更简洁。问题必须以更快的速度冒泡。现在内部和外部的演示周期比以前短了很多。仅此而已 t 当然解决了这个问题。但我们本可以在这个问题上投入更多的时间。而且客户的反应可能没有他那么强烈。我认为您无法将失败的概率降至零，所以是的，“狗屎发生了，克服它”。但是你可以努力让它尽可能低。你可以研究你可能称之为失败的程度。因此：尽早进行状态检查，及早解决问题，不要让裂缝成为船体破裂。你可以研究你可能称之为失败的程度。因此：尽早进行状态检查，及早解决问题，不要让裂缝成为船体破裂。你可以研究你可能称之为失败的程度。因此：尽早进行状态检查，及早解决问题，不要让裂缝成为船体破裂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T23:09:26.983

我有一次中途退出了一个项目，我不能说我是在逃避问题，主要是另一个项目让我更感兴趣。我去见了我的老板，向他解释了如何在我对目前的项目不太满意的情况下为另一个项目做出贡献。对你的老板诚实，这是让你真正快乐的最好方式。

我经常做的一件事是被迫转移到一个陷入困境的项目。因为别人的错误而疯狂地工作并不是最好的激励。更糟糕的是，你在保存这样的项目方面做得越好，你就越容易再次被分配到这个项目，因为你“非常擅长这个”。

# c# - Mono 对 .Net 框架开发人员的限制

> ID：802559
> 
> 赞同：9
> 
> 时间：2009-04-29T14:17:13.347
> 
> 标签：c#, visual-studio-2008, mono

我想从 .Net 切换到 Mono（加上 Visual Studio 到 Mono 中的任何 IDE）。这真的很难吗？

我会面临哪些问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:29:31.117

正如其他人指出的那样，我假设您的意思是从 .Net 框架迁移到 Mono。话虽如此，您将面临的困难在很大程度上取决于您尝试移动的代码类型以及您使用框架的哪些部分。例如，如果您的代码中充斥着 P/Invoke 调用，那么您将度过一段艰难的时光。如果它是简单的 .Net 代码，您可能会*相对*顺利。

您将需要花一些时间使用[Mono Migration Analyzer](http://mono-project.com/MoMA) (MoMA)。你会遇到工具无法捕捉到的东西，但它会捕捉到很多基础知识，让你可以自由地处理更大的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T00:09:15.153

我相信 Mono 并没有完全赶上所有的 .Net 3.5 库，因此没有或部分实现它们。Mono 总是会落后于微软，但它是一项了不起的成就，也是一项出色的工作。

看看[Mono 路线图](http://mono-project.com/Roadmap#Partial_Implementations)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T16:44:07.243

澄清一下，您可以使用 visual-studio 在 Windows 中编译，并在 Linux 中运行您的应用程序。有很多关于这个或那个没有在单声道中实现的喋喋不休，但老实说，我没有发现任何遗漏。

现在，如果你想在 Linux 中调试（最终你需要），那么 MonoDevelop 是一个不错的选择，但我在 RedHat 上运行时遇到了麻烦，所以它真的取决于你的目标 linux 系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T14:26:13.137

我认为你在这里混淆了。

Visual Studio 是一个 IDE，而 Mono 是一个 .net CLR 的实现。

我猜你真正想做的是切换到 SharpDevelop 或其他 IDE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T09:45:14.443

这可能就像从 Windows 切换到 Linux 一样艰难。这是一个不同的环境，切换总是会涉及到一些事情会感觉有点不合适的时期。这同样适用于 .Net -> Mono 开关。第一个也是最明显的区别是 IDE。与 MonoDevelop 一样伟大（或最近得到）它不是 VS。它没有那么多功能（最重要的是没有 Windows 窗体或 ASP 设计器），整体质量可能没有那么高，但它肯定足以让您入门。此外，我们不应该忘记 Mono 拥有的东西，而 .Net 不喜欢 C# 交互式编译器或参与平台创建的自由。所有考虑切换到 Mono 的事情都需要付出一定的努力，但这是非常值得的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:17:56.710

Visual Studio 是一种比 MonoDevelop 更好的 IDE，它可以自动化许多事情，使 MD 看起来只是一个编辑器（有些类似）。您还可以使用 VS 并以 Mono 为目标，这是一个不错的选择。对于虚拟操作系统，它在 Mono 支持的任何主机操作系统上都得到了很好的支持。

Mono 很接近，但总是会稍微落后于 .NET Framework。Mono 也有它自己的 API，比核心 .NET 中的任何东西都好。但基本上 .NET == Mono 在二进制级别没有一些缺失或额外的 API。

# oracle - ADO.NET OracleCommandBuilder 性能问题

> ID：802564
> 
> 赞同：1
> 
> 时间：2009-04-29T14:18:39.050
> 
> 标签：oracle, ado.net

我目前正在调查 .NET/Oracle 应用程序中的一些性能问题。

我运行了一个 oracle 跟踪文件，我注意到以下查询被调用了很多并且使用了很多资源：

```
select ac.constraint_name key_name, acc.column_name key_col,1 
from all_cons_columns acc, all_constraints ac 
where acc.owner = ac.owner 
and acc.constraint_name = ac.constraint_name 
and acc.table_name = ac.table_name 
and ac.constraint_type = 'P' 
and ac.owner = user 
and ac.table_name = :TableName 
order by acc.constraint_name 
```

我已经确定这个查询不是从应用程序代码中调用的，它可以由 ADO.NET 生成吗？该应用程序使用 OracleCommandBuilders。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T11:51:35.887

是的，我希望是 OracleCommandBuilders 正在这样做：它正在找出哪些列构成给定表的主键。它需要这样做（和其他元数据选择）来为您的应用程序生成 SQL 语句。

# asp.net - 无效的页面重定向

> ID：802567
> 
> 赞同：0
> 
> 时间：2009-04-29T14:18:51.767
> 
> 标签：asp.net, request, redirect

我正在请求一个页面（我们称之为页面 A）。但是，请求被重定向到另一个页面（页面 B）。请求处理一开始，服务器上 Request 对象的 URL 属性就指向页面 B（但是，RawURL 仍然指向页面 A）。

我无法在应用程序中找到将任何内容显式重定向到页面 B 的任何代码。我猜它发生在 asp.net 的某些请求预处理期间，但我不知道幕后实际发生了什么。

所以我需要一个关于如何继续调试这个问题的建议:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:23:19.930

这听起来像一个 Server.Transfer，可能需要搜索代码库。

[http://msdn.microsoft.com/en-us/library/ms525800.aspx](http://msdn.microsoft.com/en-us/library/ms525800.aspx)
[http://www.developer.com/net/asp/article.php/3299641](http://www.developer.com/net/asp/article.php/3299641)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T10:15:08.410

我会在调用问题页面的页面上放置一个断点，然后查看控制权在哪一点传递到页面 B。

此外，您可以通过查看发送的 http 标头轻松查看重定向是使用 Response.Redirect 还是 Server.Transfer。Response.Redirect 向客户端发送 302 重定向标头，而 Server.Transfer 不会。

# iphone - 在 iPhone/Mac OSX 上“刷新”XML 提要

> ID：802571
> 
> 赞同：0
> 
> 时间：2009-04-29T14:19:31.560
> 
> 标签：iphone, objective-c, xml, cocoa, rest

我很好奇你们这些基于 REST/SOAP/XML-RPC 构建 iPhone 应用程序或只是拉取动态 XML 提要的人，当用户说“刷新”提要时，这对您意味着什么？

直接的方法是填充一些集合，比如 NSMutableArray，用你从提要中下载的任何内容。如果 UI 上的小部件可以刷新，我通常会执行以下操作：

```
[myMutableArray removeAllObjects];
// follow steps to repopulate myMutableArray 
```

看来这是刷新 XML 提要效率最低的算法。例如，许多正在构建 Twitter 客户端的人正在将更改附加到他们现有的提要中，而不是再次以完整的形式关闭整个提要。

在与服务器端数据源对话时，您使用什么样的算法来“刷新”您的模型？

谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T23:52:45.410

如果您需要 OS X 10.5，您应该考虑使用 PubSub 框架。它明确设计用于获取和更新 RSS/Atom 提要。

（免责声明：我在 Apple 时写了很多这样的框架 :)

您的问题的答案是提要本质上是低效的。您可以通过以下方式将其最小化

1.  使用 HTTP“条件 GET”，因此如果服务器上的提要没有更改，您只会得到一个微小的 304 响应。这为服务器和您节省了时间。（如果你不使用条件获取，一些提要服务器，比如 slashdot，会禁止你！）

2.  检查响应上的“上次修改时间：”日期。是的，即使您使用条件 GET。有些服务器不能正确处理它们。如果日期未更改，请忽略提要。

3.  将响应的原始数据与您获得的最后一个原始响应进行比较。如果相同，请忽略提要。（某些服务器不支持条件获取或发送最后修改日期...）

4.  现在您必须解析 XML。

5.  检查提要本身的顶级 mod 日期（这在 Atom 和不同风格的 RSS 之间有所不同。）同样，如果它与上次相同，请忽略提要。

6.  如果你到了这里，很可能已经更新了提要。最简单的做法是丢弃所有保存的旧条目并用新条目替换它们。但这意味着您不能保留从提要末尾掉下来的“历史”条目。如果你想这样做，你必须遍历刚刚解析的提要中的每个条目，将其与持久存储中的相应条目匹配，并根据新条目更新持久条目。如果找不到持久的，请将其添加为新条目。（在不包含每个条目的唯一 GUID 的蹩脚 RSS 提要中匹配条目可能很困难。您必须尝试比较永久链接和标题。呸。）

这整件事真的是一团糟。需要大量工作才能使一切正常运行并处理所有损坏的提要和服务器；如果可以的话，利用我的痛苦并使用 PubSub :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:01:32.083

一种方法是在后台线程中使用内置的 NSXML 拉解析器，并将流中的条目与内存中的条目进行比较，仅更新已更改的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-15T19:51:18.467

[我刚刚发布了一个适用于 iPhone](http://bit.ly/mwfeedparser)的开源RSS/Atom Parser ，希望它可能会有用。

我也很想听听你的想法！

# git - GIT 和 CVS 的区别

> ID：802573
> 
> 赞同：138
> 
> 时间：2009-04-29T14:19:56.443
> 
> 标签：git, version-control, cvs

Git 和 CVS 版本控制系统有什么区别？

我已经愉快地使用 CVS 超过 10 年了，现在我被告知 Git 要好得多。有人可以解释一下两者之间的区别是什么，为什么一个比另一个更好？

* * *

## 回答 #1

> 赞同：355
> 
> 时间：2009-05-05T10:20:16.483

主要区别在于（正如在其他回复中已经说过的）CVS 是（旧的）集中式版本控制系统，而 Git 是分布式的。

但是即使你对单个开发者使用版本控制，在单机（单个帐户）上，Git 和 CVS 之间也存在一些差异：

*   **设置存储库**。Git 将存储库存储在`.git`项目顶层目录的目录中；CVS 需要设置 CVSROOT，它是存储不同项目（模块）版本控制信息的中心位置。这种设计对用户的结果是，将现有源导入版本控制就像 Git 中的“git init && git add . && git commit”一样简单，而在 CVS中[则更复杂。](http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs_3.html#SEC38 "CVS 手册：3\. 使用 CVS 启动项目")

*   **原子操作**。因为一开始 CVS 是一组围绕每个文件的 RCS 版本控制系统的脚本，所以提交（和其他操作）在 CVS 中不是原子的；如果对存储库的操作中途中断，则可以使存储库处于不一致状态。在 Git 中，所有操作都是原子的：它们要么整体成功，要么失败而没有任何改变。

*   **变更集**。CVS 中的更改是针对每个文件的，而 Git 中的更改（提交）总是指整个项目。这是非常重要的*范式转变*。这样做的后果之一是在 Git 中很容易恢复（创建撤消的更改）或撤消*整个*更改。另一个结果是，在 CVS 中很容易进行部分检查，而目前在 Git 中几乎是不可能的。更改是每个文件的，组合在一起的事实导致了 GNU Changelog 格式的发明，用于 CVS 中的提交消息；Git 用户使用（并且一些 Git 工具期望）不同的约定，单行描述（总结）更改，然后是空行，然后是更详细的更改描述。

*   **命名修订/版本号**。还有一个问题与 CVS 中每个文件的更改有关：版本号（有时在*关键字扩展*中可以看到，见下文）如 1.4 反映了给定文件已更改的时间。在 Git 中，项目的每个版本作为一个整体（每个提交）都有其唯一的名称，由 SHA-1 id 给出；通常前 7-8 个字符足以识别提交（您不能对分布式版本控制系统中的版本使用简单的编号方案——这需要中央编号权限）。在 CVS 中有版本号或符号名称来引用整个项目的状态，您使用**标签**; 如果您想为项目的某些版本使用像“v1.5.6-rc2”这样的名称，那么在 Git 中也是如此……但 Git 中的标签更容易使用。

*   **容易分枝**。在我看来，CVS 中的分支过于复杂且难以处理。您必须标记分支以获得整个存储库分支的名称（如果我没记错的话，由于每个文件的处理，即使在某些情况下也会失败）。再加上 CVS 没有*合并跟踪*这一事实，因此您必须记住，或手动标记合并和分支点，并手动为“cvs update -j”提供正确的信息以合并分支，从而实现分支是不必要的难以使用。在 Git 中创建和合并分支非常容易；Git 自己记住所有需要的信息（所以合并一个分支就像“git merge *branchname* ”一样简单）......它必须这样做，因为分布式开发自然会导致多个分支。

    这意味着您可以使用*主题分支*，即在单独的功能分支中分多个步骤开发单独的功能。

*   **重命名（和复制）跟踪**。CVS 不支持文件重命名，手动重命名可能会将历史记录一分为二，或者导致无效的历史记录，您无法在重命名之前正确恢复项目的状态。Git 使用启发式重命名检测，基于内容和文件名的相似性（此解决方案在实践中运行良好）。您还可以请求检测文件的复制。这意味着：

    *   在检查指定的提交时，你会得到一些文件被重命名的信息，
    *   正确合并会考虑重命名（例如，如果文件仅在一个分支中重命名）
    *   “git blame”，“cvs annotate”的（更好）等价物，一种显示文件内容的逐行历史记录的工具，也可以跨重命名跟踪代码移动
*   **二进制文件**。CVS 对二进制文件（例如图像）的支持非常有限，要求用户在添加时明确标记二进制文件（或稍后使用“cvs admin”，或通过包装器根据文件名自动执行此操作），以避免损坏二进制文件通过行尾转换和关键字扩展。Git 自动根据内容检测二进制文件，方式与 CNU diff 和其他工具相同；您可以使用 gitattributes 机制覆盖此检测。此外，由于“safecrlf”的默认设置（以及您必须请求行尾转换的事实，尽管这可能在默认情况下根据发行版打开）和那个（有限的）关键字，二进制文件对不可恢复的修改是安全的扩展是 Git 中严格的“选择加入”。

*   **关键字扩展**。与 CVS 相比，Git 提供了非常非常有限的一组关键字（默认情况下）。这是因为两个事实：Git 中的更改是针对每个存储库而不是针对每个文件的，并且 Git 会避免修改在切换到其他分支或回退到其他历史记录时未更改的文件。如果您想使用 Git 嵌入修订号，您应该使用您的构建系统执行此操作，例如在 Linux 内核源代码和 Git 源代码中的 GIT-VERSION-GEN 脚本示例。

*   **修改提交**。因为在分布式 VCS（例如 Git）中，*发布*行为与创建提交是分开的，因此可以更改（编辑、重写）历史的未发布部分，而不会给其他用户带来不便。特别是如果您注意到提交消息中的拼写错误（或其他错误）或提交中的错误，您可以简单地使用“git commit --amend”。这在 CVS 中是不可能的（至少在没有大量黑客攻击的情况下是不可能的）。

*   **更多工具**。Git 提供的工具比 CVS 多得多。其中一个更重要的是“ [git bisect](http://www.kernel.org/pub/software/scm/git/docs/git-bisect.html "git-bisect(1) 手册页") ”，它可用于查找引入错误的提交（修订）；如果您的提交很小且独立，那么应该很容易发现错误在哪里。

* * *

如果您与至少一位其他开发人员合作，您还会发现 Git 和 CVS 之间的以下差异：

*   **在合并之前提交**Git 使用*commit-before-merge*而不是像 CVS 那样的*merge-before-commit*（或*update-then-commit*）。如果在您编辑文件、准备创建新提交（新修订）时，其他人在同一分支上创建了新提交并且它现在位于存储库中，CVS 会强制您首先更新工作目录并解决冲突，然后再允许您提交。这不是 Git 的情况。您首先提交，将您的状态保存在版本控制中，然后合并其他开发人员的更改。您还可以要求其他开发人员进行合并并解决冲突。

    如果您更喜欢线性历史记录并避免合并，您始终可以通过“git rebase”（和“git pull --rebase”）使用*commit-merge-recommit*工作流程，这与 CVS 类似，因为您可以在顶部重放您的更改的更新状态。但你总是先承诺。

*   **无需中央存储库**使用 Git，您无需使用单一的中央位置来提交更改。每个开发人员都可以拥有自己的存储库（或更好的存储库：他/她在其中进行开发的私有存储库，以及他/她发布准备好的部分的公共裸存储库），并且他们可以从彼此的存储库中提取/获取，在对称时尚。另一方面，大型项目通常拥有*社会*定义/指定的中央存储库，每个人都可以从中提取（从中获取更改）。

* * *

最后，当需要与大量开发人员协作时，Git 提供了更多可能性。下面是 Git 中 CVS 在项目中不同阶段的兴趣和位置的差异（在使用 CVS 或 Git 的版本控制下）：

*   **潜伏者**。如果您只对从项目中获取最新更改（**不传播您的更改**）或进行*私人*开发（不回馈原始项目）感兴趣；或者您使用外国项目作为您自己项目的基础（更改是本地的，发布它们没有意义）。

    Git 通过自定义高效协议支持***匿名未经身份验证***的只读访问`git://`，或者如果您在防火墙阻止`DEFAULT_GIT_PORT`(9418) 之后，您可以使用纯 HTTP。

    对于 CVS 来说，只读访问的最常见解决方案（据我所知）是(2401)上的“pserver”协议的***访客帐户***`CVS_AUTH_PORT`，通常称为“匿名”，密码为空。凭据默认存储在`$HOME/.cvspass`文件中，因此您只需提供一次；尽管如此，这还是有点障碍（您必须知道来宾帐户的名称，或者注意 CVS 服务器消息）和烦恼。

*   **边缘开发者（叶子贡献者）**。在 OSS 中传播您的更改的一种方法是**通过电子邮件发送补丁**。如果您（或多或少）是偶然的开发人员，发送单个更改或单个错误修复，这是最常见的解决方案。顺便提一句。发送补丁可能是通过审查委员会（补丁审查系统）或类似方式，而不仅仅是通过电子邮件。

    Git 在这里提供了一些工具，这些工具有助于发送者（客户端）和维护者（服务器）的这种传播（发布）机制。对于想要通过电子邮件发送更改的人，有“ [git rebase](http://git-scm.com/docs/git-rebase "git-rebase(1) 手册页") ”（或“git pull --rebase”）工具可以在当前上游版本之上重播您自己的更改，因此您的更改位于当前版本之上（是新鲜的）和“ [git format-patch](http://www.kernel.org/pub/software/scm/git/docs/git-format-patch.html "git-format-patch(1) 手册页") ”来创建带有提交消息（和作者身份）的电子邮件，以（扩展）统一差异格式的形式进行更改（加上 diffstat 以便于查看）。[维护者可以使用“ git am](http://www.kernel.org/pub/software/scm/git/docs/git-am.html "git-am(1) 手册页") ”将此类电子邮件直接转换为保留所有信息（包括提交消息）的提交。

    CVS 不提供这样的工具：您可以使用“cvs diff”/“cvs rdiff”来生成更改，并使用 GNU 补丁来应用更改，但据我所知，没有办法自动应用提交消息。CVS 旨在以客户端 <-> 服务器方式使用...

*   **中尉**。如果您是项目（子系统）的单独部分的维护者，或者如果您的项目开发遵循 Linux 内核开发中使用的“信任网络”工作流程......或者只是如果您拥有自己的公共存储库，并且您所做的更改想要发布的太大而无法通过电子邮件作为*补丁系列*发送，您可以将**拉取请求**发送给项目的（主要）维护者。

    这是特定于*分布式*版本控制系统的解决方案，因此 CVS 当然不支持这种协作方式。甚至还有一个名为“git request-pull”的工具，它可以帮助准备电子邮件以发送给维护者，请求从您的存储库中提取。感谢“git bundle”，即使没有公共存储库，您也可以使用此机制，通过电子邮件或运动鞋网发送更改包。一些 Git 托管站点（例如[GitHub](http://github.com)）支持通知某人正在您的项目上工作（发布了一些工作）（前提是他/她使用相同的 Git 托管站点），并支持 PM-ing 一种拉取请求。

*   **主要开发人员**，即**直接发布**他/她的更改（到主/规范存储库）的人。这个类别对于分布式版本控制系统来说更广泛，因为拥有多个对中央存储库具有写访问权限的开发人员不仅是可能的工作流程（您可以让单个维护者***将***更改推送到规范存储库，一组副手/子系统维护者，他/她从中拉，以及广泛的叶子开发人员，他们通过邮件将补丁发送到维护者/项目邮件列表或副维护者/子维护者之一）。

    使用 Git，您可以选择使用**SSH 协议**（包含在 SSH 中的 git 协议）来发布更改，使用诸如“git shell”（帮助安全，限制 shell 帐户的访问）或[Gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way "托管 Git 存储库，简单（且安全）的方式")（无需单独的 shell 帐户来管理访问）等工具)，以及带有 WebDAV 的**HTTPS**，带有普通的 HTTP 身份验证。

    使用 CVS 可以选择自定义*未加密（纯文本）* **pserver**协议，或使用**远程 shell**（您真正应该使用**SSH**的地方）来发布您的更改，这对于*集中式*版本控制系统意味着提交您的更改（创建提交）。好吧，您也可以使用 SSH 隧道“pserver”协议，并且有第三方工具可以自动执行此操作……但我认为这不像 Gitosis 那样简单。

一般来说，分布式版本控制系统，如 Git，提供了更广泛的可能工作流选择。使用集中式版本控制系统（例如 CVS），您必须区分对存储库具有提交访问权限的人和没有...提交访问。

Karl Fogel 在[生产开源软件](http://producingoss.com/ "生产开源软件。 如何运行一个成功的自由软件项目。 卡尔·福格尔")中关于版本控制的部分指出，最好不要对允许对公共存储库进行更改的区域提供过于严格、严格和严格的控制；（为此）依靠社会限制（例如代码审查）比依靠技术限制要好得多；分布式版本控制系统进一步减少了恕我直言......

HTH *（希望有帮助）*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T14:22:35.533

[Git 网站](http://git.or.cz/gitwiki/GitSvnComparsion)可能最好地解释了这一点。

我的宠物功能是能够在离线时进行提交。还有速度，除了推和拉之外的一切都以惊人的速度发生。（并且这些操作在设计上是非破坏性的，因此如果您的中央存储库滞后，您可以在去喝咖啡时推/拉。）另一个好处是它包含电池：内置`gitk`是一个足够好的历史查看器；`git gui`是一个足够好的提交工具；输出着色，，，，`git add -i`是`git add -p`足够`git rebase -i`好的交互界面；如果您不想/不能摆弄您的中央存储库，那么对于临时协作来说已经足够了`git daemon`。`git instaweb`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T14:23:52.860

Git 是一个[DVCS](http://en.wikipedia.org/wiki/Distributed_revision_control)，而 CVS 是一个集中式的。简单的描述是：当您没有连接到多个可能的存储库中的*任何一个时，您可以获得版本控制的所有好处，而且操作更快。*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T01:38:17.227

我也是 cvs 的 10 多年最满意的用户，虽然我也喜欢 git，并且随着时间的推移会喜欢它，尽管我目前从事的大多数项目都使用 cvs 或 svn，我们似乎不能说服我工作的官僚机构让我们在防火墙上打一个 git 洞。

让 cvs 变得更好的一些东西是 cvsps，另一个是 Andrew Morton 的补丁脚本或被子。Cvsps 允许您将提交的多个文件重组为单个补丁（从而从 CVS 中提取“变更集”），而 quilt 或 Andrew Morton 的补丁脚本允许您非常轻松舒适地将明智的“变更集”提交到 cvs，允许您同时处理多个事情，同时在提交之前将它们分开。CVS 有其怪癖，但我已经习惯了其中的大部分。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T10:59:03.990

“愉快地使用 CVS 超过 x 年”，是一个有趣的想法 :-) 与保留大量副本相比，这是一个巨大的进步，但是......

我猜你已经习惯了它的所有怪癖，或者不做太多的分支和合并。有更糟的可能性；

您组织中的人员已经习惯了 cvs 的限制，并且您的工作实践也相应地进行了调整；

例如，一次不能有超过一个开发人员在一个包上工作，只在紧急情况下使用分支等。

基本原则是越难的事情，做的人越少。

# java - Python中变量的“final”关键字等效？

> ID：802578
> 
> 赞同：76
> 
> 时间：2009-04-29T14:21:07.547
> 
> 标签：java, python, keyword, final

我在 Python 中找不到与 Java 等效的文档`final`，有这样的东西吗？

我正在创建一个对象的快照（如果出现任何故障，用于恢复）；一旦分配了此备份变量，就不应对其进行修改——Python 中的类似 final 的功能对此会很好。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-04-29T14:32:44.383

在Java中拥有一个变量`final`基本上意味着一旦您分配给一个变量，您可能不会重新分配该变量以指向另一个对象。这实际上并不意味着该对象不能被修改。例如，以下 Java 代码运行良好：

```
public final List<String> messages = new LinkedList<String>();

public void addMessage()
{
    messages.add("Hello World!");  // this mutates the messages list
} 
```

但以下甚至不会编译：

```
public final List<String> messages = new LinkedList<String>();

public void changeMessages()
{
    messages = new ArrayList<String>();  // can't change a final variable
} 
```

所以你的问题是关于 Python 中是否`final`存在。它不是。

但是，Python 确实具有不可变的数据结构。例如，虽然您可以改变 a `list`，但不能改变 a `tuple`。您可以改变 a`set`但不能改变 a`frozenset`等。

我的建议是不要担心在语言级别强制执行非变异，而只需专注于确保您不会编写任何代码在分配这些对象后对其进行变异。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-04-29T14:30:34.640

`final`Python 中没有等价物。

但是，要创建类实例的只读字段，您可以使用[属性](http://docs.python.org/3.0/library/functions.html#property)函数。

**编辑**：也许你想要这样的东西：

```
class WriteOnceReadWhenever:
    def __setattr__(self, attr, value):
        if hasattr(self, attr):
            raise Exception("Attempting to alter read-only value")

        self.__dict__[attr] = value 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2019-10-14T22:20:11.027

[Python 3.8](https://docs.python.org/3.9/whatsnew/3.8.html#typing)（通过[PEP 591](https://www.python.org/dev/peps/pep-0591/)）添加了`Final`变量、函数、方法和类。以下是一些使用它的方法：

**`@final`装饰器（类、方法）**

```
from typing import final

@final
class Base:
    # Cannot inherit from Base

class Base:
    @final
    def foo(self):
        # Cannot override foo in subclass 
```

**`Final`注解**

```
from typing import Final

PI: Final[float] = 3.14159     # Cannot set PI to another value
KM_IN_MILES: Final = 0.621371  # Type annotation is optional

class Foo:
    def __init__(self):
        self.bar: Final = "baz"   # Final instance attributes only allowed in __init__ 
```

请注意，与其他类型提示一样，这些提示不会阻止您覆盖类型，但它们确实有助于 linter 或 IDE 警告您有关不正确的类型使用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-29T14:41:33.397

一次赋值变量是一个设计问题。您设计应用程序的方式是只设置一次变量。

但是，如果您想要对您的设计进行运行时检查，您可以使用对象周围的包装器来完成。

```
class OnePingOnlyPleaseVassily(object):
    def __init__(self):
        self.value = None
    def set(self, value):
        if self.value is not None:
            raise Exception("Already set.")
        self.value = value

someStateMemo = OnePingOnlyPleaseVassily()
someStateMemo.set(aValue) # works
someStateMemo.set(aValue) # fails 
```

这很笨重，但它会在运行时检测设计问题。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-29T14:29:04.690

哪有这回事。总的来说，Python 的态度是“如果你不想修改，就不要修改它”。无论如何，API 的客户不太可能只是在您未记录的内部结构中闲逛。

我想，您可以通过对模型的相关位使用元组或命名元组来解决此问题，这些位本质上是不可变的。当然，这仍然无助于模型中必须可变的任何部分。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-29T14:28:29.950

Python 没有“final”的等价物。除了命名约定外，它也没有“公共”和“受保护”。这不是那种“束缚和纪律”。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-30T10:41:27.897

您可以通过[描述符协议](http://docs.python.org/reference/datamodel.html#customizing-attribute-access)模拟类似的东西，因为它允许以您希望的方式定义读取和设置变量。

```
class Foo(object):

  @property
  def myvar(self):
     # return value here

  @myvar.setter
  def myvar(self, newvalue):
     # do nothing if some condition is met

a = Foo()
print a.myvar
a.myvar = 5 # does nothing if you don't want to 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-09-03T14:59:31.853

截至 2019 年和[PEP 591](https://www.python.org/dev/peps/pep-0591/)，Python 有一个`Final`类型。在 Python 3.8 发布之前，它不会在标准库中可用，但在此之前，您可以通过[类型扩展](https://pypi.org/project/typing-extensions/)库使用它。`final`尽管 Python 仍然是一种动态类型语言，但它不会像在 Java 中那样工作。但是如果你将它与像[mypy](http://mypy-lang.org/)这样的静态类型检查器一起使用，它会给你带来非常相似的好处。

还有一个`final`装饰器可用于将类方法标记为最终方法并防止被覆盖。同样，这仅在“编译时”进行检查，因此您需要在工作流程中包含静态类型检查器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-29T14:29:05.500

[http://code.activestate.com/recipes/576527/](http://code.activestate.com/recipes/576527/)定义了一个冻结功能，虽然它不能完美地工作。

不过，我会考虑让它保持可变。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-08-10T12:20:36.873

Python 确实没有最终类型，它确实具有不可变类型，例如元组，但那是另一回事。

这里的其他一些答案使类充满了伪最终变量，我更喜欢我的类只有几个最终类型，所以我建议使用描述符来创建最终类型：

```
from typing import TypeVar, Generic, Type

T = TypeVar('T')

class FinalProperty(Generic[T]):
    def __init__(self, value: T):
        self.__value = value
    def __get__(self, instance: Type, owner) -> T:
        return self.__value
    def __set__(self, instance: Type, value: T) -> None:
        raise ValueError("Final types can't be set") 
```

如果你像这样使用这个类：

```
class SomeJob:
    FAILED = FinalProperty[str]("Failed") 
```

那么您将无法在该类的任何实例中设置该变量。不幸的是，与 WriteOnceReadWhenever 答案一样，您仍然可以设置类变量。

```
job = SomeJob()
job.FAILED = "Error, this will trigger the ValueError"
SomeJob.FAILED = "However this still works and breaks the protection afterwards" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-07T05:29:23.090

虽然这是一个老问题，但我想我会添加另一个可能的选项：您还可以使用`assert`来验证变量是否设置为您最初打算设置的内容 - 如果您愿意，请仔细检查。虽然这与 Java 中的不一样`final`，但它可以用来创建类似的效果：

```
PI = 3.14
radius = 3

try:
    assert PI == 3.14
    print PI * radius**2
except AssertionError:
    print "Yikes." 
```

如上所示，如果`PI`由于某种原因未设置为`3.14`，`AssertionError`则会抛出 an ，因此`try/except`块可能是明智的添加。无论如何，根据您的情况，它可能会派上用场。

# .net - Visual Studio 2008 中的 .NET 2.0 安装项目

> ID：802579
> 
> 赞同：4
> 
> 时间：2009-04-29T14:21:14.787
> 
> 标签：.net, visual-studio, .net-3.5, .net-2.0, installation

我开发了一个针对 .net 2.0 的 win forms 应用程序。所有这些都在 Visual Studio 2008 sp1 中。

我这样做是因为我真的不需要应用程序中的 3.0+ 功能。而且我不希望客户必须安装一个巨大的框架，而他们只能安装一个半巨大的框架。

好吧，当我为应用程序创建一个安装项目时，构建它，安装它，它要我安装 .net 3.5。我在 Windows 应用程序和安装项目中都针对 2.0。

是否可以在 VS 2008 中仅使用 2.0 的先决条件来制作安装项目？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-29T14:23:53.250

是的。默认情况下，VS2008 中的安装项目需要包含 3.5 可再发行组件。您需要将其切换到 2.0 可再发行组件。尝试以下

在解决方案资源管理器中查看时，您的安装项目应该有一个名为“Detected Dependencies”的文件夹。其中一个值是“Microsoft .Net Framework”。双击该节点将打开“启动条件”页面。树中将有一个名为“.Net Framework”的节点。选择它并按 F4 以显示属性窗口。

在“属性”窗口中将有一个名为“版本”的行，其值为 3.5.XXX。这是一个组合框。将其切换为 2.0.50727 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:24:22.127

当然。右键单击安装项目，选择属性。在属性窗口中，单击“先决条件”按钮并选择您喜欢的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:28:27.857

从 .NET 3.5 SP1 开始，您还可以使用**.NET 客户端配置**文件仅在 .NET Framework 中部署那些通常用于客户端应用程序方案的程序集和文件。这样可以更小、更快、更简单地安装 .NET 客户端应用程序。

此[博客文章](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)中提供了更多信息。

# asp.net - 跟踪 SOAP 请求的主机

> ID：802595
> 
> 赞同：0
> 
> 时间：2009-04-29T14:24:02.830
> 
> 标签：asp.net, web-services, soap, trace

我公司使用的软件有一个网络服务，其签名或多或少是这样的：

```
[WebMethod]
public DataSet MakeQuery(string sql) {
} 
```

注意 1：我没有此代码。

最近，我们注意到 Sql Server 在没有死的情况下获得了很多进程，所以我想跟踪这个 webMethod 的输入。

我有什么办法可以做到这一点？

我在考虑 SoapExtension，但我没有 Web 服务的源代码。基本上我想知道发送 SOAP 请求的机器的名称。

注意 2：SQL Server 的进程将服务器报告为主机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:25:40.157

尝试使用[Wireshark](http://www.wireshark.org/)来查看通过网络传输的内容。

# c# - 使用 Visual Studio 开发单声道应用程序

> ID：802605
> 
> 赞同：28
> 
> 时间：2009-04-29T14:25:41.110
> 
> 标签：c#, visual-studio, visual-studio-2008, mono

如何使用 Visual Studio 在 Mono 上开发应用程序？这可能吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-29T14:28:23.770

您只需在 Visual Studio 中构建应用程序，然后在 Mono 下而不是在 .NET 下运行它们。二进制文件应该是兼容的......但您需要确保不使用 Mono 中不可用的任何库 - 请参阅[Mono Application Compatibility Guidelines](http://mono-project.com/Guidelines:Application_Portability)。

（根据该页面，您需要在 Visual Studio 中关闭增量构建 - 我之前不知道这一点 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T14:28:25.517

请参阅[这篇](http://tirania.org/blog/archive/2006/Feb-25.html)文章，了解如何在针对 VS 的单声道框架的同时运行您的应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T14:30:42.890

Miguel 不久前发布[了此条目](http://tirania.org/blog/archive/2006/Feb-25.html)，所以它已经过时了。你也可以试试[这个](https://web.archive.org/web/20100612182331/http://chriscyvas.com/2009/02/16/getting-mono-and-visual-studio-to-play-nice-together/)和[这个](https://web.archive.org/web/20101114015029/http://chriscyvas.com/2009/03/12/getting-mono-and-visual-studio-to-play-nice-together-part-2/)（万岁 Web Archive！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T21:24:54.680

从 2.0 版开始，MonoDevelop 支持 VisualStudio 项目/解决方案文件格式。这意味着您可以在带有 VS 和 .Net 的 Windows 上以及带有 MonoDevelop 和 Mono 的 Linux 上使用相同的代码库。在我看来，这是最好的方法。在 Windows 上在 Mono 中运行应用程序没有主要原因，除了出于测试目的，为此我宁愿设置一个虚拟机来在本机环境中测试软件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-23T21:19:47.773

我在这里发布了一篇关于如何将 Mono 2.8（.Net 4.0 的构建）集成到 Visual Studio 2010中的文章- 如果这就是您的目标，那么[这里](http://greghurlman.com/visual-studio-2010-client-profile-for-mono-2-8/)有一个指向为 Mono 2.4（.Net 3.5）构建的另一个配置文件的链接.

您可以通过 3 个简单的步骤集成新的 Mono 2.8 配置文件：

1.  [从这里](http://greghurlman.com/wp-content/uploads/2010/10/monoprofile2_8.zip)下载配置文件本身。
2.  将配置文件 Zip 的内容解压缩到以下目录之一：

    *   32 位系统：`C:\Program Files\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\Profile`
    *   `64-bit systems: C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\Profile`
3.  ZIP 中的“Mono”文件夹应直接位于“Profile”目录下。

4.  如果 Visual Studio 正在运行，请重新启动它，打开要与 Mono 一起使用的项目的属性，然后选择 Mono Profile for 2.8：

**注意：**您将无法直接从 New Project 对话框中选择 Mono Profile；由于某种原因，该配置文件列表不匹配。首先将您的项目创建为 .Net Framework 4.0 项目，然后在创建后将项目属性设置为 Mono。

如果您已将 MonoDevelop 安装升级到最新版本（无论如何，从今天开始），此 Visual Studio 解决方案和项目文件将毫无问题地打开 - 根本不需要任何更改。

如果您遇到`.NETFramework,Version=v4.0,Profile=Mono`运行应用程序所需的问题，诀窍就是创建注册表项。

对于运行**Windows 7 x64**，它是：`HKEY\_LOCAL\_MACHINESOFTWAREWow6432NodeMicrosoft .NETFrameworkv4.0.30319SKUs .NETFramework,Version=v4.0,Profile=Mono`

我想对于**x86**它是`HKEY\_LOCAL\_MACHINESOFTWAREMicrosoft.NETFramework v4.0.30319SKUs.NETFramework,Version=v4.0,Profile=Mono`

（其中 v4.0.30319 是当前安装的 4.0 框架的版本。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-12T12:44:08.357

### 是的，您可以在 Visual Studio 上开发并以 Mono（x86 的 Mono）为目标。

**这是我对在 Windows 上针对 Mono**进行编译的所有可用替代方案所做[的回答](https://stackoverflow.com/a/35362534/5328150)。但是，它专注于**Mono x86**。作为总结，让我们列出 VS 开发的可能选择：

*   **MonoHelper 插件**
*   **单声道配置文件**

对于**Android/Ios ，您还可以在****Visual Studio**中使用**[Xamarin addin](https://xamarin.com/)**进行交叉编译和调试。虽然它对于大型商业应用程序不是免费的，但有一个免费版本可用于制作小型应用程序。

**注意：**对于那些想知道为什么我想在 Windows 上使用 Visual Studio 而不是 Unix 上的 MonoDevelop 开发的人，可以说 MonoDevelop 的开发人员体验无法与 VS 相比（尤其是在调试器/重构方面，最后一个归功于 Resharper 而不是 VS 本身）。

# java - 未连接调试器时 jvmti 的性能影响？

> ID：802607
> 
> 赞同：5
> 
> 时间：2009-04-29T14:26:04.323
> 
> 标签：java, performance, debugging

我们最近将一个 Web 应用程序（tomcat 5.5.x Web 应用程序）投入生产，它今天开始表现出奇怪的行为。我们在任何开发或预生产环境中都看不到这种行为。

我们在运行时查看生产系统的唯一视图是日志记录。尽管他们可以告诉我们发生了什么，但他们并不能真正帮助我们诊断为什么会发生。

我们昨天不得不重新加载上下文两次来解决这个问题。

我正在考虑启动 jpda 活动的生产 tomcat 服务器。如果问题再次发生（在从服务用户请求的服务器池中删除 tomcat 之后），这将允许我将调试器连接到应用程序。

连接调试器时，您显然会为 jpda 付出性能损失。但是，我想知道未连接调试器时的“成本”是多少？我怀疑与调试器“侦听”相关的开销可能非常小。在我花几个小时进行性能测量之前，我希望有人可以指出我可能会澄清这一点的文档？

java 版本 "1.5.0_17" Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_17-b04) Java HotSpot(TM) 64-Bit Server VM (build 1.5.0_17-b04, 混合模式)

在 RHEL 5.3 上

谢谢！

卡洛斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:22:26.043

我没有定量的答案，但是对性能的影响很小；它在架构上与 DTrace 非常相似，基本上如果您不连接外部工具并激活事件，测试点只需做很少的工作；他们也为不活跃的事件类做很少的工作。

# java - 如何在纯 SQL 中编写空安全比较“<=>”？

> ID：802612
> 
> 赞同：9
> 
> 时间：2009-04-29T14:27:44.553
> 
> 标签：java, sql, mysql, null, h2

在 Mysql 中有一个 null 安全的比较运算符：<=>。在创建这样的准备好的语句时，我在我的 Java 程序中使用它：

```
String routerAddress = getSomeValue();
String sql = "SELECT * FROM ROUTERS WHERE ROUTER_ADDRESS <=> ? ";
PreparedStatement stmt = connection.prepareStatement(sql);
stmt.setString(1, routerAddress); 
```

现在我想切换到 H2 数据库。如何在纯 SQL 中编写 <=> 运算符（例如使用 IS NULL 和 IS NOT NULL）？我想只使用**一次**stmt.setString 操作。列名可以多写几遍。

相关问题是[Get null == null in SQL](https://stackoverflow.com/questions/191640/get-null-null-in-sql)。但是那个答案需要将搜索值写入2次（即：我的PreparedStatement中的2个问号）！？

参考： [http ://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_equal-to](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_equal-to)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T14:38:09.783

> 相关问题是在 SQL 中获取 null == null。但是那个答案需要将搜索值写入2次（即：我的PreparedStatement中的2个问号）！？

排名第二的和随后的答案提供了一种方法来执行此操作，而无需两次绑定搜索值：

```
SELECT * FROM ROUTERS 
WHERE coalesce(ROUTER_ADDRESS, '') = coalesce( ?, ''); 
```

请注意，这需要一个永远不会是有效列值的虚拟值（即“带外”）；我正在使用空字符串。如果您没有任何此类值，则必须忍受两次绑定该值：

```
SELECT * FROM ROUTERS 
WHERE ROUTER_ADDRESS = ? or (ROUTER_ADDRESS is null and ? is null); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-30T13:28:14.820

SQL 中标准的 NULL 安全相等运算符是`IS DISTINCT FROM`和`IS NOT DISTINCT FROM`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T14:47:29.060

在 SQL 中，NULL 不等于自身。所以你可以：

1 - 将其替换为虚拟值并进行比较，如下所示：

```
SELECT * FROM ROUTERS WHERE ISNULL(ROUTER_ADDRESS,'xxx') <=> ISNULL(?,'xxx') 
```

或者

2 - 用更复杂的逻辑测试替换它，如：

```
SELECT *
FROM ROUTERS 
WHERE (
       (ROUTER_ADDRESS IS NULL AND ? IS NOT NULL)
       OR
       (ROUTER_ADDRESS IS NOT NULL AND ? IS NULL)
       OR
       (ROUTER_ADDRESS IS NOT NULL AND ? IS NOT NULL AND ROUTER_ADDRESS <> ?
      ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:05:30.360

如果您想要 ROUTERS 的 ROUTER_ADDRESS 何时为空？为空，那么这可能会起作用：

```
SELECT * 
FROM ROUTERS 
WHERE ROUTER_ADDRESS = (case when ROUTER_ADDRESS is null and ? is null then null 
                             else ? end) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-18T12:49:51.967

用纯 SQL 重写 <=> 的正确答案（因为你没有使用 MySQL）是

“没有区别”

假设您的数据库引擎支持它。（MySQL 没有，但许多其他人有）

如果做不到这一点，许多其他数据库系统都有自己的专有技巧。

如果两者都没有，则需要合并到 where 子句中的无效数据。

```
COALESCE (a, "__NULL__") 
```

应该适用于字符或文本字段。（我的意思是那个确切的字符串，它永远不应该在真实数据中显示）。非文本字段比较棘手，因为 sql 喜欢进行隐式转换，这使得合并到带外数据变得非常困难。如果一个字段只包含过去的日期，您可以将空值合并到遥远的未来。如果一个字段只包含某个日期之后的日期，您可以合并到遥远的过去。对于无符号数，您可以将它们合并为 -1（比较仍然有效，即使该字段不能包含负 1）。

如果这不是一个选项，您必须进行非常愚蠢的长时间检查。

如果您实际上不需要考虑 null 与空的不同，则可以合并到它，但这仅适用于文本/字符。

# sql - TSQL 等效于 MS Access 交叉表查询

> ID：802630
> 
> 赞同：4
> 
> 时间：2009-04-29T14:30:33.873
> 
> 标签：sql, sql-server, tsql, ms-access

TSQL 中的 MS-Access 交叉表查询相当于什么？还有更好的方法吗？

我有一个这样组织的数据：

```
Fish
ID   Name
---- ---------
1    Jack
2    Trout
3    Bass
4    Cat

FishProperty
ID   FishID Property Value
---- ------ -------- -----
1    1      Length   10
2    1      Girth    6
3    1      Weight   4
4    2      Length   6
5    2      Weight   2
6    3      Girth    12 
```

我有许多用户需要对数据进行报告，并且（显然）如果他们能像这样看到它会更容易：

```
Fish
ID   Name      Length Girth Weight
---- --------- ------ ----- ------
1    Jack      10     6     4
2    Trout     6            2
3    Bass             12 
```

我的计划是创建一个他们可以直接报告的类似交叉表的视图。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T14:32:44.960

您在寻找[PIVOT](http://www.databasejournal.com/features/mssql/article.php/3516331/SQL-Pivot-and-Cross-Tab.htm)吗？

**编辑**：在看到 PIVOT 语法的用法之前，您可能必须进入第二页。

**编辑 2**： 另一个[例子](http://www.mssqltips.com/tip.asp?tip=1019)。

**示例**：

```
SELECT SalesPerson, [Oranges] AS Oranges, [Pickles] AS Pickles
FROM
(SELECT SalesPerson, Product, SalesAmount
FROM ProductSales ) ps
PIVOT
(
SUM (SalesAmount)
FOR Product IN
( [Oranges], [Pickles])
) AS pvt 
```

**编辑 3** CodeSlave，查看此[博客条目](http://sqlserver-qa.net/blogs/t-sql/archive/2008/08/27/4809.aspx)以获取有关动态数据透视查询的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:51:30.813

作为 PIVOT 查询的替代方法，您可以创建如下视图：

```
create view dbo.myview
as
select 
    fish.ID
,   fish.Name
,   len.Value as Length
,   gir.Value as Girth
,   wei.Value as Weight
from fish
left join fishproperty len 
    on len.fishid = fish.id 
    and len.property = 'Length'
left join fishproperty gir 
    on gir.fishid = fish.id 
    and gir.property = 'Girth'
left join fishproperty wei 
    on wei.fishid = fish.id 
    and wei.property = 'Weight' 
```

如果您不提前知道列，我能想到的唯一解决方案是动态生成查询并使用“exec sp_executesql”来运行它。例如：

```
declare @query nvarchar(4000)
set @query = 'select ... from fish'
-- For each column
set @query = @query + ' left join fishproperty ' +
    propname + ' on ' + propname + '.fishid = fish.id ' +
    'and ' + propname + '.property = ''' + propname + ''' '
exec sp_executesql @query 
```

警告：动态查询可能是一个令人头疼的维护问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:59:48.267

这是这个问题的重复：[SQL2005 中 Dynamic Pivoting 需要帮助](https://stackoverflow.com/questions/801635/help-needed-with-dynamic-pivoting-in-sql2005)，是的，可以使用动态 sql，通过一些技巧，您甚至可以对返回的结果进行选择或为其创建视图，但是如果你的表有超过 1000 条记录，我不推荐这种方法，因为性能充其量是很差的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:08:42.160

您也可以使用[CASE](https://stackoverflow.com/questions/17194/sql-query-to-compare-product-sales-by-month/17290#17290)语句，但您的报告工具应该能够使用 matrix/pivot/crosstab 模板为您执行此操作（动态！）。

# c++ - 在非 C++ 异常情况下解锁临界区

> ID：802636
> 
> 赞同：0
> 
> 时间：2009-04-29T14:31:20.923
> 
> 标签：c++, multithreading, exception, mfc

我的类中有一个 CCriticalSection 对象，用于将异常同步到方法。我将它与 CSingleLock 对象一起使用，如下所示：

```
void f()
{
  try
   {
     CSingleLock lock(&m_synchronizer, TRUE);
     .....
     .....

   }

  catch(SomeException )
  {
  }

  catch(...)
  {
  }

} 
```

如果任何语句引发 C++ 异常，则临界区对象已正确解锁，但是如果我遇到任何其他类型的异常（例如访问冲突），有什么方法可以解锁我的临界区吗？我认为 RAII 在这里不会有帮助，因为堆栈展开不会发生。在退出函数 f 后，我可以做些什么来防止关键部分处于锁定状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:33:18.033

**编辑**更新

CSingleLock 的析构函数确实会解锁底层的临界区。访问冲突等称为 SEH 异常。至于析构函数是否会在遇到 SEH 异常时运行是非常特定于环境的。您可以采取一些技巧来使这种场景发挥作用。

例如，一种选择是将所有 SEH 异常转换为相应的 C++ 异常。我最近写了一篇关于实现这一点的技术的博客。一旦它们都是 C++ 异常，那么就可以保证调用的析构函数。

*   [http://blogs.msdn.com/jaredpar/archive/2008/01/11/mixing-seh-and-c-exceptions.aspx](http://blogs.msdn.com/jaredpar/archive/2008/01/11/mixing-seh-and-c-exceptions.aspx)

但另一个问题是为什么要这样做呢？一旦您遇到访问冲突，您的程序唯一可以可靠地做的就是崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:42:03.583

假设您使用的是 MSVC，请尝试使用`/EHa`将 Windows 的结构化异常映射到 C++ 异常的命令行选项进行编译（C++ 文档有时称它们为“异步”异常）。

您应该阅读此内容的含义 - 我自己不使用该选项，而且我不确定可能有什么缺点。

您也可以尝试使用`__try`, `__except`,`__finally`关键字自己处理 SEH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:32:43.777

RAII 在这里确实有帮助。不在这里最重要的是“超出范围”不一定只是堆栈展开。当 try 块退出时，无论是正常退出还是通过异常退出，都会调用析构函数。每当您的变量超出范围时，都会调用其析构函数。

**编辑**

嗯，看来问题已被编辑为关注 SEH（非 C++ 异常）。在这种情况下，析构函数代码可能不会被触发。但是，正如其他人所指出的，大多数非 C++ 异常都等同于应用程序崩溃。除了崩溃之外，以任何理智的方式对这些异常做出反应可能是不合理的。在这种情况下，您的应用程序将退出，并且您的关键部分将被销毁。

有关将 C SEH 异常转换为 Windows 的 C++ 异常的良好解决方案，请参阅@JaredPar 的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:01:32.927

如果您确实需要您的应用程序在特定区域的代码执行访问冲突时继续存在，您应该考虑将该代码放在一个单独的进程中。

如果代码试图读取或写入不允许的地方，有什么办法阻止它写入应用程序内存的其他部分，从而导致各种讨厌的问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T15:07:57.370

AFAIK，你[永远不](http://www.flounder.com/avoid_mfc_syncrhonization.htm)应该使用 CCriticalSection 或任何 MFC 同步对象。

# asp.net-mvc - 在 asp.net 中扩展 MVC 的 DataAnnotations 属性

> ID：802639
> 
> 赞同：0
> 
> 时间：2009-04-29T14:32:35.493
> 
> 标签：asp.net-mvc

Brad Willson 有一篇很棒的文章描述了如何使用 DataAnnotations。 [http://bradwilson.typepad.com/blog/2009/04/dataannotations-and-aspnet-mvc.html](http://bradwilson.typepad.com/blog/2009/04/dataannotations-and-aspnet-mvc.html)我想做的是扩展我可以使用的可用属性。类似 [ PastDate（您必须输入过去的日期）] 或 [InvoiceNumber（所有发票以 INV 开头并以 002 结尾）] 之类的东西。我知道我可以使用正则表达式属性来完成此操作。但是，具有更多描述性属性将是一个更清洁的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:42:43.017

您需要创建一个继承自的类，`System.ComponentModel.DataAnnotations.ValidationAttribute`然后像这样使用该属性：

```
public class yourModel {
    [CustomValidation(typeof(yourClass), "yourMethod")]
    public int yourProperty { get; set; }
} 
```

没有尝试过，但它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-23T15:33:40.267

我的项目中有一些这样的——有些仍然使用正则表达式，但至少这样它们只在一个地方：

```
public class TelephoneAttribute : RegularExpressionAttribute
{
    public TelephoneAttribute()
        : base(@"^\(?(\d{3}\)?)((-| )?\d{3})(-?\d{4})$") { }
} 
```

更像你的例子：

```
public class MinimumDateAttribute : RangeAttribute
{
    public MinimumDateAttribute(string MinimumDate)
        : base(typeof(DateTime), MinimumDate, DateTime.MaxValue.ToShortDateString()) { }
} 
```

# asp.net - Asp.net GridView - 如何在绑定数据之前访问数据源？

> ID：802645
> 
> 赞同：2
> 
> 时间：2009-04-29T14:33:11.513
> 
> 标签：asp.net, data-binding, gridview

我试图在将数据源绑定到网格之前访问它。我怎么做？我猜我应该看看像 Grid.DataBinding 这样的事件之一

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:52:19.063

是的，GridView.DataBinding 事件将在绑定控件之前引发。您可以在该事件中访问 DataSource 控件并根据需要进行修改（例如，修改参数）。

```
protected void Grid_DataBinding(object sender, EventArgs e)
{
  mySqlDataSource.SelectCommand = "Select * from Stars";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:52:42.310

一种方法是不在网格本身上定义数据源。在 page_load 中，创建并填充您的数据源，然后将其动态绑定到您的数据网格。这样你就可以访问它了。

希望能帮助到你！

# .net - 为什么我的 Lucene 索引中的这种编码策略不起作用？

> ID：802647
> 
> 赞同：0
> 
> 时间：2009-04-29T14:33:20.920
> 
> 标签：.net, lucene

在我的数据源中有很多特殊字符，如正斜杠、减号、加号等。很多这些字符给 lucene 带来了问题。
这就是为什么我决定对我放入索引中的所有字符串进行编码。

例如 apple/pear 会变成 apple%2Fpear
我想搜索相同的字符串会返回给我这个文档。

但我空手而归。怎么了？

**--EDIT--**
在胡闹之后，我注意到我在 Luke 中使用 StandardAnalyzer（与任何分析器相关的）创建的查询改变了我在空间中的 %2。因此没有结果。我可以以某种方式使 queryAnalyzer 不转换这些吗？也许我应该使用不同的转义方法然后 %XX？

**--更多信息--**
我使用 StandardAnalyzer 进行索引和查询。
我没有编码空间。这就是我快速推出自己的编码而不是使用默认 URL 编码器的原因之一。把*苹果/梨*做成*苹果梨*是有道理的，但在我的真实数据中，它并不总是（使用水果来保护无辜者）并且建立关于何时插入空格以及何时不插入空格的智能会带来太多风险。使用 Luke 我可以看到我的字段包含*appel%2Fpear*。搜索*fruitName:appel*有效。搜索*fruitName:appel%2Fpear*不会， *fruitName* :appel%2fpear 也不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T17:37:20.180

查询时需要[转义特殊字符](http://lucene.apache.org/java/2_3_2/queryparsersyntax.html#Escaping%20Special%20Characters)。特殊字符列表中缺少正斜杠。我想，你不需要处理那个角色。

但是您需要验证索引时创建的标记是否也具有这些特殊字符。例如，“apple/pear”应该有一个标记。

# c# - C#：ManualResetEvent 崩溃

> ID：802650
> 
> 赞同：0
> 
> 时间：2009-04-29T14:33:51.947
> 
> 标签：c#, multithreading, tcp, manualresetevent

[我使用msdn 上的这篇文章](http://msdn.microsoft.com/en-us/library/fx6588te.aspx)作为主要助手编写了我的代码

我的代码：

```
 private ManualResetEvent _AllDone = new ManualResetEvent(false);

    internal void Initialize(int port,string IP)
    {
        IPEndPoint _Point = new IPEndPoint(IPAddress.Parse(IP), port);
        Socket _Accpt = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        _Accpt.Bind(_Point);
        _Accpt.Listen(2);

        while (true)
        {
            _AllDone.Reset();
            _Accpt.BeginAccept(null, 0, new AsyncCallback(Accept), _Accpt);
            _AllDone.WaitOne(); <<crash here
        }

    } 
```

这就是发生的情况，我在 BeginAccept 处设置了一个断点（我认为有问题），但它正常执行。但是，当我尝试执行“_AllDone.WaitOne()”时 - 服务器崩溃。

如果 _allDone 不能在 win32 表单应用程序中使用 - 我如何制作我的项目？

**编辑**

我忘了提到我在Accept()中写了_AllDone.Reset()，但它没有去那里，我在那里设置了一个断点，但它不会去。

```
 private void Accept(IAsyncResult async)
    {
        _AllDone.Set();
        Socket _Accpt = (Socket)async.AsyncState;
        Socket _Handler = _Accpt.EndAccept(async);

        StateObject _State = new StateObject();
        _State.workSocket = _Handler;

        _Handler.BeginReceive(_State.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), _State);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:55:37.043

因此，如果我做对了，您希望在收到套接字连接后立即重新启动`Accept`，而不是等到`Accept`完成，这就是为什么您不使用同步版本的`Accept`.

所以您是说当您将套接字连接到指定的地址和端口时它不会触发您的 Accept 方法？因为这就是 Accept 所做的：它接受一个新的传入连接，等待客户端连接。因此，这可能就是您认为它“崩溃”以及它永远不会在您的 Accept 方法中到达您的代码的原因。

提示：也许也看看[`Socket.AcceptAsync`](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.acceptasync.aspx)

**编辑：**要设置一个监听传入连接的异步服务器，您不需要任何 ManualWaitEvent：

```
internal void Initialize(int port,string IP) {
    IPEndPoint _Point = new IPEndPoint(IPAddress.Parse(IP), port);
    Socket _Accpt = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
    _Accpt.Bind(_Point);
    _Accpt.Listen(2);
    _Accpt.BeginAccept(null, 0, new AsyncCallback(Accept), _Accpt);
}

private void Accept(IAsyncResult async) {
    Socket _Accpt = (Socket)async.AsyncState;
    Socket _Handler;
    try {
        _Handler = _Accpt.EndAccept(async);
    } finally {
        _Accpt.BeginAccept(null, 0, new AsyncCallback(Accept), _Accpt);
    }

    StateObject _State = new StateObject();
    _State.workSocket = _Handler;

    _Handler.BeginReceive(_State.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReadCallback), _State);
} 
```

**注意：**您还需要一个退出条件，以便不调用 BeginAccept（例如，当您想要关闭服务器时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T17:15:32.660

我认为 Lucero 想说的是，该应用程序运行正常，您可能会问为什么。

好吧，当您使用服务器端套接字应用程序时，您基本上要做的就是要求服务器侦听端口并等待连接到达。当连接到达时，您将执行其余的代码。

Lucero 的意思是，当没有消息到达服务器时，服务器会一直等待和等待，这可能会像冻结一样寻找您。

您的代码中是否存在这种情况？

# asp.net - ASP Net - 带有 Active Directory 问题的表单身份验证

> ID：802654
> 
> 赞同：0
> 
> 时间：2009-04-29T14:35:52.193
> 
> 标签：asp.net, active-directory

我有一个错误...

连接字符串中指定的容器不存在

基本上，我在 ASP.NET 中使用 Active Directory 身份验证。

我已经设置了我的连接字符串。

我对 AD 还是很陌生。

我感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:46:06.613

您最好在连接中指定根 NC 名称。

LDAP://YourADServer/DC=cene,DC=edc,DC=CompName,DC=com

除非有充分的理由不希望在域范围内进行搜索，否则我会这样设置。

您可以尝试 ldp.exe 连接到您在路径中指定的 AD 服务器，看看是否有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:49:36.620

您可能需要注意的一件事是 Active Directory 和表单身份验证不是一回事。您将使用其中一种来进行身份验证和授权。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T21:15:08.713

我认为您的 LDAP 字符串应该这样格式化：

`"LDAP://DCServer.BUSINESSPLUSPLUS.com/CN=Users,DC=BUSINESSPLUSPLUS,DC=com"`

# c++ - 运行时堆栈是否保存在内存的数据段中？

> ID：802656
> 
> 赞同：2
> 
> 时间：2009-04-29T14:35:59.680
> 
> 标签：c++, c, memory, stack, segments

在我对后台发生的事情进行实验后，我对堆栈内存组织非常好奇，并且显然看到它与我从书本上获得的微小知识相匹配。只是想检查一下我的理解是否正确。

我有一个基本程序——有 2 个函数，第一个是 foo，另一个是 main（入口点）。

```
void foo(){
    // do something here or dont
}

int main(){

    int i = 0;

    printf("%p %p %p\n",foo, &i, main);

    system("PAUSE");
    return EXIT_SUCCESS;
}; 
```

程序的输出如下图所示，main 的局部变量 i 完全位于不相关的位置。integer 是一种值类型，但使用 char * 本地指针再次检查它并获得类似的结果。

```
00401390 0022FF44 00401396
Press any key to continue . . . 
```

我主要了解代码和变量被分配到不同的内存段（代码段/数据段）。所以基本上可以说调用堆栈折叠有关函数执行的基本信息（它们的局部变量、参数、返回点）并将它们保存在数据段中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:39:49.980

一开始有一点警告：所有这些答案都受到操作系统和硬件架构的影响。Windows 所做的事情与类 UNIX 语言、实时操作系统和旧的小型系统 UNIX 完全不同。

但正如@Richie 和@Paul 所说，基本答案是“是的”。当您的编译器和链接器处理完代码时，它在 UNIX 中被分解为所谓的“文本”和“数据”段。一个*文本段*包含指令和一些静态数据；数据段包含数据。

然后为堆栈和堆空间分配一大块数据段。其他块可以分配给静态或外部数据结构之类的东西。

所以是的，当程序运行时，程序计数器正忙于从与数据不同的段中获取指令。现在我们进入一些架构依赖关系，但一般来说，如果你有分段内存，你的指令的构造方式是从段中获取一个字节尽可能高效，在旧的 360 架构中，它们有*基址寄存器*，在 x86随着地址空间从旧的 8080 到现代处理器，有一堆头发变长了，但是所有指令都经过非常仔细的优化，因为正如您可以想象的那样，获取指令及其操作数的使用非常密集。

现在我们使用虚拟内存和*内存管理单元*来了解更现代的架构。现在机器有了特定的硬件，让程序将地址空间视为一个大的平坦地址范围；各个段只需放置在该位虚拟地址空间中。MMU 的工作是获取一个虚拟地址并将其转换为一个物理地址，包括如果该虚拟地址目前根本不在物理内存中该怎么办。同样，MMU 硬件经过高度优化，但这并不意味着**没有**相关的性能成本。但是随着处理器变得越来越快，程序越来越大，它变得越来越不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:38:39.423

是的，完全正确。代码和数据存在于内存的不同部分，具有不同的权限。堆栈保存参数、返回地址和本地（“自动”）变量，并与数据一起存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:47:23.273

是的。

想象一下，你的代码存储器是 ROM，而你的数据存储器是 RAM（一种常见的小芯片架构）。然后你看到堆栈*必须*在数据存储器中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:44:32.263

您的程序表现出未定义的行为，具体是因为：

*   您没有包含`<stdio.h>`或`<cstdio>`取决于您将代码编译为的语言
*   `printf`并且所有可变参数函数都没有能力对其参数进行类型检查。因此，您必须传递正确键入的参数。你真的应该这样做：
*   `system()`范围内没有声明。包括`<stdlib.h>`或`<cstdlib>`视情况而定。

将您的代码编写为：

```
 #include <stdio.h>

   int main() {
      /* ... */
      printf("%p %p %p\n", (void *)foo, (void *)&i, (void *)main);
      /* ... */
   } 
```

另请注意：

*   的定义`void foo()`不是 C 中的原型，而是 C++ 中的。但是，如果您要编写`void foo(void)` ，您将获得两种语言的原型。
*   `system()`是依赖于实现的——你的代码在不同平台上的行为可能不符合预期。

语言本身（C 或 C++）对如何组织内存没有任何限制。它甚至没有堆栈或堆的概念。这些是由它们认为合适的实现定义的。理想情况下，您应该查阅实现提供的文档，以公平地了解它们的作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T15:46:33.020

好吧，我可以代表 SPARC：

是的。运行程序时，程序会被读取两次（至少在 SPARC 中）。程序被加载到内存中，然后任何数组/堆栈分配都会被加载。在程序的第二遍中，堆栈被分配到单独的内存中。

我不确定基于 CISC 的处理器，但我怀疑它变化不大。

# wpf - 您能否为一种 XAML 样式定义多个 TargetType？

> ID：802658
> 
> 赞同：73
> 
> 时间：2009-04-29T14:36:20.680
> 
> 标签：wpf, xaml, styles

在 HTML/CSS 中，您可以定义一种可应用于多种元素的样式，例如：

```
.highlight {
    color:red;
} 
```

可以同时应用于 P 和 DIV，例如：

```
<p class="highlight">this will be highlighted</p>
<div class="highlight">this will also be highlighted</div> 
```

但在 XAML 中，您似乎必须为样式定义 TargetType，否则会出现错误：

```
<Style x:Key="formRowLabel" TargetType="TextBlock"> 
```

有没有办法让 XAML 样式应用于多个元素，甚至像在 CSS 中一样保持打开状态？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-29T14:47:39.107

WPF 样式中的设置器在编译时检查；CSS 样式是动态应用的。

您必须指定一个类型，以便 WPF 可以将设置器中的属性解析为该类型的依赖项属性。

您可以将目标类型设置为包含所需属性的基类，然后将该样式应用于派生类。例如，您可以为 Control 对象创建样式，然后将其应用于多种类型的控件（按钮、文本框、复选框等）

```
<Style x:Key="Highlight" TargetType="{x:Type Control}">
    <Setter Property="Foreground" Value="Red"/>
</Style> 
```

...

```
<Button Style="{StaticResource Highlight}" Content="Test"/>
<TextBox Style="{StaticResource Highlight}" Text="Test"/>
<CheckBox Style="{StaticResource Highlight}" Content="Test"/> 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-10-15T05:57:27.800

```
<!-- Header text style -->
<Style x:Key="headerTextStyle">
    <Setter Property="Label.VerticalAlignment" Value="Center"></Setter>
    <Setter Property="Label.FontFamily" Value="Trebuchet MS"></Setter>
    <Setter Property="Label.FontWeight" Value="Bold"></Setter>
    <Setter Property="Label.FontSize" Value="18"></Setter>
    <Setter Property="Label.Foreground" Value="#0066cc"></Setter>
</Style>

<!-- Label style -->
<Style x:Key="labelStyle" TargetType="{x:Type Label}">
    <Setter Property="VerticalAlignment" Value="Top" />
    <Setter Property="HorizontalAlignment" Value="Left" />
    <Setter Property="FontWeight" Value="Bold" />
    <Setter Property="Margin" Value="0,0,0,5" />
</Style> 
```

我认为这两种声明风格的方法都可以回答你的问题。在第一个中，没有指定 TargetType，但属性名称以“Label”为前缀。在第二个中，为 Label 对象创建样式。

另一种方法是：

```
<UserControl.Resources>
  <Style x:Key="commonStyle" TargetType="Control">
     <Setter Property="FontSize" Value="24"/>
  </Style>
  <Style BasedOn="{StaticResource commonStyle}" TargetType="ListBox"/>
  <Style BasedOn="{StaticResource commonStyle}" TargetType="ComboBox"/>
</UserControl.Resources> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-13T18:26:41.897

我想将样式应用于 Textblock 和 TextBox 但所选答案对我不起作用，因为 Textblock 不继承自 Control，在我的情况下，我想影响 Visibility 属性，所以我使用了**FrameworkElement**

```
<Style x:Key="ShowIfRequiredStyle" TargetType="{x:Type FrameworkElement}">
        <Setter Property="Visibility" Value="Collapsed"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding ShowIfRequiredStyle, UpdateSourceTrigger=PropertyChanged}" Value="true">
                <Setter Property="Visibility" Value="Visible"/>
            </DataTrigger>
        </Style.Triggers>
</Style>

<TextBlock Style="{StaticResource ResourceKey=ShowIfRequiredStyle}"/>
<TextBox Style="{StaticResource ResourceKey=ShowIfRequiredStyle}"/> 
```

这适用于 Visibility 属性，因为这两个项目都继承自 Frameworkelement 并且该属性是在那里定义的。当然，这不适用于仅在 Control 中定义的属性，您可以搜索层次结构树并尝试找到一个基类，无论如何我认为这可以帮助某人，因为这是一个热门搜索结果，并且选择的答案有点不完整。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-02T15:31:48.110

这个问题有一个替代答案。您可以完全将 TargetType 参数从样式中移除，这将允许它应用于各种不同的控件，但前提是您必须在属性名称前加上“Control”。

```
<Style x:Key="Highlight">
    <Setter Property="Control.Foreground" Value="Red"/> 
</Style> 
```

显然，这只适用于基本控件类的属性。如果您尝试设置 ItemsSource 说，它会失败，因为没有 Control.ItemsSource

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-11-15T13:49:37.003

我得到了这个工作

```
<Style x:Key="HeaderStyleThin"  TargetType="{x:Type Border}">
    <Setter Property="Background" Value="Black" />

    <Style.Resources>
        <Style TargetType="{x:Type TextBlock}">
               <Setter Property="Background=" Value="Red" />
        </Style>
        </Style.Resources>

</Style> 
```

# queue - MSMQ 如何管理消息？

> ID：802661
> 
> 赞同：4
> 
> 时间：2009-04-29T14:36:43.267
> 
> 标签：queue, msmq

似乎 MSMQ 不使用任何数据库管理系统来管理消息。
MSMQ 如何管理消息？
它是否将消息存储在平面文件中？

我正在尝试实现一个消息管理系统。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-29T14:40:34.180

MSMQ 使用位于 %windir%\system32\msmq 中的平面文件。

如果你想实现自己的排队，我建议你看看[Ayende 的关于排队的博客文章](http://ayende.com/Blog/archive/2008/08/01/Rhino-Queues.aspx "犀牛队列")

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T14:38:29.317

它将它们作为文件存储在磁盘上。

如果您想管理它们，请使用 System.Messaging API

# asp.net - 从 Web 部件查看远程 FTP 文件夹中的文件

> ID：802662
> 
> 赞同：1
> 
> 时间：2009-04-29T14:36:59.803
> 
> 标签：asp.net, sharepoint, ftp, moss

我们希望在 SharePoint 门户中集成 FTP 共享的文件/文件夹视图。我们认为最好的解决方案是创建一个 Web 部件来读取 FTP 共享的内容并将其显示在门户中。

是否有任何第三方解决方案？以前有没有人做过这样的事情……也许能给我们一些注意事项的指示？

干杯!

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-29T14:47:54.300

linux下可以： 1\. 像网盘一样挂载ftp，浏览本地目录 2\. 可以调用外部ftp

# sql - Reporting Services 2000 中的临时表问题

> ID：802674
> 
> 赞同：2
> 
> 时间：2009-04-29T14:40:54.303
> 
> 标签：sql, sql-server, report

我刚刚使用使用临时表的存储过程在报表管理器中创建了一个报表。

我收到错误“无法为查询生成字段列表。无效的对象名称'#xxxx'”

我读到这是因为当 Report Manager 尝试 PrepareQuery 时遇到困难，因为临时表还不存在，这是正确的吗？如果是这样，您有任何解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:58:11.610

我曾经遇到过这个……实际上是一模一样的东西。在创建任何临时表之前，我通过将此行放入我的 SP 来修复它：

```
SET FMTONLY OFF 
```

那应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:46:41.607

唯一的方法是显而易见的，使您的临时表成为永久表并自己进行管理（使用后删除行等）。这可能更快且可索引，您可以根据需要添加密钥以确保完整性。它还可以充当长时间运行查询的缓存。

如果您确定只有一个用户调用 sp，那么您可以使用 truncate 而不是 delete 从表中转储数据。

没有多大帮助，但我从来没有找到任何其他方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T14:52:26.023

我对报告服务了解不多，但这对我来说听起来很准确。

在我看来，您可能无法使用临时表来存储数据。您可能需要改用永久表。

我会问自己为什么要使用单独的表格。数据是否已经存在于其他表中？我可以从那里得到它吗？有时您无法选择使用单独的表格，只需确保。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T14:53:00.310

我不知道究竟是什么导致了问题，但您可以尝试使用变量表。

```
declare @table table (Field int) 
```

# ant - 从 Groovy 启动 canoo webtest 的工作示例？

> ID：802676
> 
> 赞同：2
> 
> 时间：2009-04-29T14:41:03.273
> 
> 标签：ant, groovy, webtest, canoo

我想用 Canoo 从 Groovy 开始一个简单的 webtest。示例[Canoo 示例](http://webtest.canoo.com/webtest/manual/groovyTesting.html)不起作用。我想我在 Antbuilder 类中遗漏了一些东西。特别是“配置”部分，其中传递了属性的 HashMap。我尝试了不同的方法来传递属性，但我最基本的方法是：

config_map = ['host':'www.google.com', 'port':'80', 'protocol':'http', 'basepath':'']

它们都导致相同的错误消息。groovy.lang.MissingMethodException：没有方法签名：groovy.util.ConfigObject.call() 适用于参数类型：(java.util.LinkedHashMap) 值：[[host:www.google.com, port:80, protocol ：http，基本路径：]]

或者，我正在查看 grails，但不知道是否可以使用 grails 项目对非 grails 应用程序进行网络测试。当我尝试从 Grails 复制类时，ant 再次挂起在配置行上。

有人有一个地方可以找到 canoo-groovy webtest 的工作示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-14T17:41:22.963

可能想看看这篇博文：[WebTest with Groovy, Maven and Eclipse](http://mguillem.wordpress.com/2009/04/30/webtest-with-groovy-maven-and-eclipse/)

# maven-2 - 使用 Maven2 过滤添加当前日期

> ID：802677
> 
> 赞同：50
> 
> 时间：2009-04-29T14:41:18.263
> 
> 标签：maven-2, filtering

我有一个 Maven2 项目，我需要在属性文件中添加当前版本和当前日期。

对于当前版本，我使用了`${project.version}`，它可以正常工作。

我的问题是如何在我的属性文件中设置当前日期（即构建由 Maven2 完成的日期）：

```
client.version=Version ${project.version}
client.build=??? 
```

（另外，如果我能指定日期的格式，那就太好了）

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2010-01-16T15:37:42.990

特性不适用于 maven 2.2.1 资源过滤。

请参阅：[https ://issues.apache.org/jira/browse/MRESOURCES-99](https://issues.apache.org/jira/browse/MRESOURCES-99)

但是你可以在父 pom 中创建一个自定义属性：

```
<properties>
    <maven.build.timestamp.format>yyMMdd_HHmm</maven.build.timestamp.format>
    <buildNumber>${maven.build.timestamp}</buildNumber>
</properties> 
```

其中 buildNumber 是可以过滤到资源中的新属性。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-05T16:20:14.607

您可以为此使用[Maven Buildnumber 插件](https://www.mojohaus.org/buildnumber-maven-plugin/)：

```
<build>
  <plugins>
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>buildnumber-maven-plugin</artifactId>
      <executions>
        <execution>
          <phase>initialize</phase>
          <goals>
            <goal>create</goal>
          </goals>
        </execution>
      </executions>
      <configuration>
        <doCheck>false</doCheck>
        <doUpdate>false</doUpdate>
        <timestampFormat>{0,date,yyyy-MM-dd HH:mm:ss}</timestampFormat>
      </configuration>
    </plugin>
  </plugins>
</build> 
```

然后，日期在属性 ${buildNumber} 中可用。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-07-06T07:17:19.390

从 Maven 2.1 M1 开始，你现在可以做，`${maven.build.timestamp}`只要你还定义`${maven.build.timestamp.format}`

```
<properties>
    ...
    <maven.build.timestamp.format>yyyyMMdd-HHmm</maven.build.timestamp.format>
    ...
</properties> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-05-21T16:57:24.403

Thomas Marti 的回答是朝着正确方向迈出的一步，但是有一种更简单的方法，不需要`<scm>`在 POM 中进行虚拟声明。使用`buildnumber-maven-plugin`，但使用`create-timestamp`目标。文档不清楚；以下是获取`YYYY-MM-DD`格式日期并将其放入`build.date`属性中的样子：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>buildnumber-maven-plugin</artifactId>
    <version>1.2</version>
    <executions>
        <execution>
            <phase>validate</phase>
            <goals>
                <goal>create-timestamp</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <timestampFormat>yyyy-MM-dd</timestampFormat>
        <timestampPropertyName>build.date</timestampPropertyName>
    </configuration>
</plugin> 
```

开箱即用，这在带有 m2e 的 Eclipse 中不起作用，因此您必须在 POM`<build>`部分中添加以下内容：

```
<pluginManagement>
    <plugins>
        <plugin>
            <groupId>org.eclipse.m2e</groupId>
            <artifactId>lifecycle-mapping</artifactId>
            <version>1.0.0</version>
            <configuration>
                <lifecycleMappingMetadata>
                    <pluginExecutions>
                        <pluginExecution>
                            <pluginExecutionFilter>
                                <groupId>org.codehaus.mojo</groupId>
                                <artifactId>buildnumber-maven-plugin</artifactId>
                                <versionRange>[1.2,)</versionRange>
                                <goals>
                                    <goal>create-timestamp</goal>
                                </goals>
                            </pluginExecutionFilter>
                            <action>
                                <execute>
                                    <runOnConfiguration>true</runOnConfiguration>
                                    <runOnIncremental>true</runOnIncremental>
                                </execute>
                            </action>
                        </pluginExecution>
                    </pluginExecutions>
                </lifecycleMappingMetadata>
            </configuration>
        </plugin>
    </plugins>
</pluginManagement> 
```

这告诉 m2e 您希望它在 Eclipse 中构建时继续运行插件。

现在，当您在 Eclipse 内部或外部构建时，时间戳会正确生成并与资源过滤一起使用！

可惜这么简单的功能居然这么难……

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-14T15:54:09.853

另一种解决方案是在 pom.xml 中使用 Groovy（可能不如 Thomas Marti 提出的解决方案合适）：

```
 <build>
      <resources>
         <resource>
            <directory>src/main/resources</directory>
            <filtering>true</filtering>
         </resource>
      </resources>
      <plugins>
         <plugin>
            <groupId>org.codehaus.groovy.maven</groupId>
            <artifactId>gmaven-plugin</artifactId>
            <executions>
               <execution>
                  <phase>validate</phase>
                  <goals>
                     <goal>execute</goal>
                  </goals>
                  <configuration>
                     <source>
                     import java.util.Date 
                     import java.text.MessageFormat 
                     def vartimestamp = MessageFormat.format("{0,date,yyyyMMdd-HH:mm:ss}", new Date()) 
                     project.properties['buildtimestamp'] = vartimestamp
                     </source>
                  </configuration>
               </execution>
            </executions>
         </plugin>
      </plugins>
   </build> 
```

然后使用`buildtimestamp`属性：

```
client.version=${pom.version}
client.build=${buildtimestamp} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-04-19T16:41:40.640

这对我有用。我想要的只是时间戳。

在聚...

```
<properties>
    <maven.build.timestamp.format>yyyyMMdd-HHmm</maven.build.timestamp.format>
    <dev.build.timestamp>${maven.build.timestamp}</dev.build.timestamp>
</properties>
...
<overlay>
   <groupId>mystuff</groupId>
   <artifactId>mystuff.web</artifactId>
   <filtered>true</filtered>
</overlay> 
```

在 JSP 文件中...

```
<div>Built: ${dev.build.timestamp}</div> 
```

示例结果是...

```
<div>Built: 20130419-0835</div> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-05-22T20:17:54.117

坚持`${build.time}`一个属性文件和以下内容`pom.xml`：

```
<build>
   <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>buildnumber-maven-plugin</artifactId>
        <version>1.3</version>
        <configuration>
          <timestampFormat>yyyy-MM-dd HH:mm:ss</timestampFormat>
          <timestampPropertyName>build.time</timestampPropertyName>
        </configuration>
        <executions>
          <execution>
            <phase>initialize</phase>
            <goals>
              <goal>create-timestamp</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
   </plugins>
</build> 
```

另请参阅[buildnumber-maven-plugin 文档](http://mojo.codehaus.org/buildnumber-maven-plugin/create-timestamp-mojo.html)。

* * *

（其他答案让我很接近，尤其是 Garret Wilson，但他的 Eclipse 配置对我来说不是必需的，这导致我忽略了他的答案，所以我发布的正是对我有用的内容。）

作为**奖励**，如果您想获得两个属性，一个用于日期，一个用于时间，您可以这样做：

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>buildnumber-maven-plugin</artifactId>
  <version>1.3</version>
  <executions>
    <execution>
      <id>build.date</id>
      <phase>initialize</phase>
      <goals>
        <goal>create-timestamp</goal>
      </goals>
      <configuration>
        <timestampFormat>yyyy-MM-dd</timestampFormat>
        <timestampPropertyName>build.date</timestampPropertyName>
      </configuration>
    </execution>
    <execution>
      <id>build.time</id>
      <phase>initialize</phase>
      <goals>
        <goal>create-timestamp</goal>
      </goals>
      <configuration>
        <timestampFormat>yyyy-MM-dd HH:mm:ss</timestampFormat>
        <timestampPropertyName>build.time</timestampPropertyName>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-05-24T18:28:02.860

它在 maven 2.1.0 对我有用

${maven.build.timestamp}

# winapi - 在 Windows 防火墙中打开端口涉及哪些 API 调用？

> ID：802687
> 
> 赞同：0
> 
> 时间：2009-04-29T14:44:00.457
> 
> 标签：winapi, windows-firewall

我有一个批处理文件，它可以在大约 1 秒内安装 WinVNC 并启动服务。但是，我仍然必须手动进入 Windows 防火墙并打开一个端口以允许连接。我怎样才能以编程方式做到这一点？

如果我可以从批处理文件中执行此操作，那将是理想的，但如果有必要，我可以编写一个 EXE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T01:09:37.523

Windows 防火墙为此提供了自己的 API：[Windows 防火墙和具有高级安全性的 Windows 防火墙](http://msdn.microsoft.com/en-us/library/aa366453.aspx)。查看 INetFwOpenPorts::Add() 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:50:27.370

让我为您[搜索一下：http:](http://www.google.com/search?hl=en&safe=off&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=KPB&q=batch+%22windows+firewall%22&btnG=Search)
[//www.windowsecurity.com/articles/Customizing-Windows-Firewall.html](http://www.windowsecurity.com/articles/Customizing-Windows-Firewall.html)

此页面包含多种自定义防火墙的方法，其中使用这些方法`netsh.exe`似乎可以让命令行访问 Windows 防火墙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:56:06.230

这是一个很好的资源，我过去曾多次使用过。我知道这是典型的“指向 RTFM 站点”，但实际上，它是一个很好的资源，我已经成功使用它。

[http://msdn.microsoft.com/en-us/library/aa366415(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366415(VS.85).aspx)

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T16:07:00.243

shoosh 帮我搜索了一下，我想出了这个，效果很好。

```
netsh firewall add portopening tcp #### "VNC" 
```

用端口替换####。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T16:24:32.430

查看Windows防火墙的源代码（发布在google groups，Win32上）

# php - Selecting random entry in MySQL with WHERE clause problem

> ID：802701
> 
> 赞同：0
> 
> 时间：2009-04-29T14:47:35.627
> 
> 标签：php, mysql

I'm running the following code to get a random entry from a dictionary:

```
SELECT * FROM tbl_dict WHERE 1 ORDER BY RAND() LIMIT 1 
```

This works great, but as soon as I expand there WHERE clause the query fails. What I need is something like...

```
SELECT * FROM tbl_dict WHERE 1 and lock='0' ORDER BY RAND() LIMIT 1 
```

Can anyone point out to me where I'm going wrong? My mind has turned to peanut butter.

Thank you!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T14:53:51.837

lock is a [reserved word](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html) for MySQL. You have to put it in backticks (`) or double-quotes (in ansi mode) if you want to use it as an identifier.

You might also be interested in [http://jan.kneschke.de/projects/mysql/order-by-rand](http://jan.kneschke.de/projects/mysql/order-by-rand).
ORDER BY Rand() might or might not be a bit too suboptimal in your case when it comes to speed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T14:52:17.973

Never mind, this is wrong for what you're trying to do.

You do have a synthetic auto_incremented id column on your table, right?

if so, then why not:

```
 select * from tbl_dict where id 
   = (select floor( rand() * ( max(b.id) + 1) ) from tabl_dict b ); 
```

# wpf - 应用程序启动期间的键盘修饰符

> ID：802703
> 
> 赞同：2
> 
> 时间：2009-04-29T14:47:46.203
> 
> 标签：wpf, keyboard

我想捕获在应用程序启动期间是否按下了修改键（以确定全屏还是窗口）。

在主窗口构造函数中，我尝试检查[Keyboard.Modifiers](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.modifiers.aspx)枚举以查看 Shift 是否关闭。它总是显示“无”。

所以我尝试了一种不同的方法，启动[DispatcherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)并检查其 Tick 事件中的转变。那似乎工作正常。

问题是，这是最好的（唯一）方法吗？以及为什么修饰符没有在窗口构造函数中返回正确的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T14:57:46.460

`Keyboard.Modifiers`是要使用的正确类/属性。

我建议检查`FrameworkElement.Loaded`事件处理程序中的修饰符。

在`Window`构造函数之后`InitializeComponent()`：

```
this.Loaded += new RoutedEventHandler(Window_Loaded); 
```

和：

```
void Window_Loaded(object sender, RoutedEventArgs e)
{
    // Examine Keyboard.Modifiers and set fullscreen/windowed
    if ((Keyboard.Modifiers & ModifierKeys.Shift) > 0)
    {
        //SetFullscreen();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:26:37.343

我敢打赌`Keyboard.Modifiers`，`GetKeyState`在您的消息循环发送第一条消息之前，它可能无法正常工作。 `GetAsyncKeyState`会为你工作（我猜是通过 P/Invoke，除非有一种我不知道的 .net 调用方式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-05T20:36:38.453

很好的[总结](https://stackoverflow.com/a/7917277/2440976)......第二个链接有很好的代码在这个过程中显示它......只需添加 Josh G 的代码（从这个问题的答案到第二个链接中的项目）：

在 InitializeComponent() 之后的 Window 构造函数中：

```
this.Loaded += new RoutedEventHandler(Window_Loaded); 
```

和：

```
void Window_Loaded(object sender, RoutedEventArgs e)
{
    // Examine Keyboard.Modifiers and set fullscreen/windowed
    if ((Keyboard.Modifiers & ModifierKeys.Shift) > 0)
    {
        MessageBox.Show("The Window is Shifty...");
    }
} 
```

# c++ - 在 C++ 中实现对象模型的库/方法

> ID：802706
> 
> 赞同：2
> 
> 时间：2009-04-29T14:48:40.337
> 
> 标签：c++, oop, memory-management

抱歉，如果以前有人问过这个问题，我不太确定术语或如何提出问题。

我想知道是否有在 C++ 中实现对象模型的库或最佳实践。如果我有一组类，其中这些类的实例可以相互关联并且可以通过各种方法相互访问，那么我想选择一组好的底层数据结构来管理这些实例及其相互关系。这在 Java 中很容易，因为它为我处理内存分配和垃圾收集，但在 C++ 中我必须自己做。

HTML 的[文档对象模型](http://en.wikipedia.org/wiki/Document_Object_Model)(DOM) 就是一个例子；作为另一个（人为的）示例，假设我有这些类：

*   `Entity`
*   `Person`（的子类`Entity`）
*   `Couple`（的子类`Entity`）
*   `Property`
*   `House` （的子类`Property`）
*   `Pet` （的子类`Property`）
*   `Car` （的子类`Property`）

以及这些关系：

*   `Entity`
    *   有 1`home`个班级`House`
    *   有 0 个或多个`pets`类`Pet`
    *   有 0 个或多个`cars`类`Car`
    *   有 0 个或多个`children`类`Person`
*   `Person`
    *   有 0 或 1`spouse`个类`Person`
    *   有 0 或 1`marriage`个类`Couple`
    *   有 0 或 1`parents`个班级`Entity`（在这个模型中，如果父母不存在，他们就不存在！）
*   `Couple`
    *   有 2`members`个班级`Person`
*   `Property`
    *   有 1`owner`个班级`Entity`

现在我已经考虑了这些对象及其关系，我想开始制作数据结构、方法和字段来处理它们，这就是我迷失的地方，因为我必须处理内存分配和生命周期管理以及所有这些东西. 您可能会遇到以下问题：我可能想将一个对象放入 a`std::map`或 a`std::vector`中，但如果这样做，我将无法存储指向这些对象的指针，因为它们可以在地图或矢量增长或缩小时重新定位。

我经常使用 COM 时使用的一种方法是创建一个包含所有内容的隐藏集合。集合中的每个对象都有一个唯一的 ID（数字或名称），通过它可以从集合中查找它，并且每个对象都有一个指向集合的指针。这样，如果您有一个对象想要指向另一个对象，而不是字面上持有指向另一个对象的指针，我存储 ID 并可以通过隐藏集合查找它。我可以使用引用计数来自动处理生命周期问题（除了不相交的周期，有时这不是问题）。

还有其他方法吗？或者是否有库可以在 C++ 中使这种东西更容易？

**编辑：**那么您还有其他问题，例如对象之间的关系在许多情况下可能是可变的，您必须提前考虑应该如何存储对对象的引用，以及应该提供哪些方法来相互访问对象. 例如，如果我有一个句柄`Person`X，我想表示“找到X的孩子叫乔治”的概念，那么我必须存储名字“乔治”而不是孩子号码：孩子可能存储在一个向量中，我可以调用X.getChildCount() 和 X.getChild(0)，但“George”可能并不总是第 0 个孩子，因为其他孩子可能会在孩子向量中的“George”之前插入。或者 X 可能有两个或三个或四个其他孩子也叫“乔治”。或者“乔治”可能会将他的名字改为“安东尼”或“乔治娜”。在所有这些情况下，最好使用某种唯一的不可变 ID。

**编辑 2 ：（**一旦我理顺了这个问题，我会稍微清理一下我的问题）我可以处理方法和属性名称的选择，我可以处理是否使用地图、列表或向量。这很简单。我试图具体处理的问题是：

*   当这些对象可能是重新分配的数据结构的一部分时，如何让一个对象存储对另一个对象的引用
*   当对象之间存在互惠关系时，如何处理对象生命周期管理

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T16:39:02.677

您写了关于将对象模型中的对象存储在 std::vector 等中以及使用指向它们的指针的问题。这提醒我，最好将 C++ 类分为两类（我不确定这里的术语）：

1.  **代表对象模型一部分的**实体类。**它们通常是多态的，或者将来可能是多态的。它们是在堆上创建的，并且总是被指针或智能指针引用。你永远不会直接在堆栈上创建它们，作为类/结构成员，也不会直接将它们放在像 std::vectors 这样的容器中。他们没有复制构造函数，也没有 operator=（您可以使用某些 Clone 方法制作新副本）。如果对您有意义，您可以比较它们（它们的状态），但它们不可互换，因为它们具有同一性。每两个对象都是不同的。**

***   **实现原始用户定义类型的值类**（如字符串、复数、大数、智能指针、句柄包装器等）。它们直接在堆栈上创建或作为类/结构成员创建。它们可以通过复制构造函数和 operator= 复制。它们不是多态的（多态和 operator= 不能很好地协同工作）。您经常将他们的副本放在 stl 容器中。您很少将指向它们的指针存储在独立的位置。它们是可以互换的。当两个实例具有相同的值时，您可以将它们视为相同。（不过，包含它们的变量是不同的东西。）** 

 **打破规则有很多很好的理由。但我观察到，从一开始就忽略它们会导致程序不可读、不可靠（尤其是在内存管理方面）并且难以维护。

* * *

现在回到你的问题。

如果您想存储一个具有复杂关系的数据模型，并且可以轻松地执行诸如“查找 X 的名为 George 的孩子”之类的查询，为什么不考虑一些内存中的关系数据库呢？

请注意，当您要有效地实现 a) 更复杂的双向关系和 b) 基于不同对象属性的查询时，您可能需要创建与关系数据库内部所做的非常相似的索引数据结构。你的实现（因为会有很多，在单个项目中）真的会更有效和更健壮吗？

“一切的集合”和对象 ID 也是如此。您需要跟踪对象之间的关系以避免没有对象的 id。它与指针有何不同？其他然后得到有意义的错误而不是在内存中发疯，那就是;-)

* * *

内存管理的一些想法：

*   强所有权：当您可以声明某个实体仅与其所有者一样长并且不可能独立存在指向它的指针时，您可以在所有者的析构函数中（或使用 scoped_ptr）将其删除。

*   有人已经提出了 smart_ptr。它们很棒，可以与 stl 容器一起使用。它们是基于引用的，所以不要创建循环:-(。我不知道有任何广泛使用的可以处理循环的 c++ 自动指针。

*   也许有一些顶级对象拥有所有其他对象。例如。通常你可以说所有的片段都属于一个文档、一个算法或一个事务。它们可以在顶级对象的上下文中创建，然后在删除它们的顶级对象时自动删除（当您从内存中删除文档或完成算法执行时）。当然，您不能在顶级对象之间共享片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T14:56:24.313

对此有大约一百万种（保守估计）方法。你真的在问“我如何用 C++ 设计软件”。答案是，恐怕，“你的软件要做什么？” - 仅仅知道你想处理 Persons 和 Houses 是不够的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:06:49.747

这不是 OOP 的重点吗？你问的是一个实现细节，你隐藏在这些类的公共接口后面，因此不必担心，因为你可以在不改变接口的情况下改变它？所以继续，按照你建议的方式尝试。然后，如果存在性能、内存或其他问题，您可以在不破坏其余代码的情况下修复实现。

在我看来，将数据存储在数据库中并使用某种对象关系映射可能是另一种选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:07:40.930

Jason，我最喜欢的资源是[C++ FAQ Book](https://rads.stackoverflow.com/amzn/click/com/0201309831)。问题是您实际上是在问“我如何使用 C++ 进行面向对象编程？”

我在 SO 答案中能说的最好的答案是：

所有这些东西都将成为 C++ 中的类，并且关系等看起来很像你习惯的垃圾收集语言：如果你需要一个 Person 和他的名为“george”的孩子之间的关系，你选择一个数据结构可以存储按名称索引的 Persons 或 Childs。

如果遵循一些规则，内存管理实际上比直接 C 更容易：确保所有需要它们的对象都有析构函数，确保析构函数清理对象拥有的所有内容，然后确保始终放置这些动态构造的对象在不再需要它们时超出范围的情况下。这些不会涵盖所有情况，但它们可以帮助您避免大约 80% 的内存分配错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T15:09:23.937

您可以使用 boost::shared_ptr 来解决内存问题。然后，您可以自由复制 shared_ptr，从函数中返回它，将其用作局部变量等。

然后A`Person`可以有 a `std::map< string, boost::shared_ptr<Person> >`，因此`X.getChild("George")`只需在地图中查找孩子并返回指针。我想你明白了这个概念，所以我会把剩下的留给你练习；）

# scripting - 是否有可能 - 仅使用 windows 脚本 - 合并文本文件和图像？

> ID：802707
> 
> 赞同：0
> 
> 时间：2009-04-29T14:48:43.550
> 
> 标签：scripting, fax, banking

我们的 FI 交易应用程序生成以纯文本字母形式出现的交易确认。（。文本文件）

*   我需要将这些以编程方式（仅使用 Windows 脚本）覆盖到有头纸上，然后复制到传真输出目录。
*   该脚本将每 n 分钟检查一次目录中的这些文件。
*   我想保持依赖倒计时，因为脚本将在服务器上运行，所以如果可能的话，我想避免引用 Office 库。

将文本文件叠加到位图上的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:48:29.460

我知道这不能回答您的问题，但是，由于我怀疑您是否会获得基于纯脚本的图像叠加解决方案，因此我建议使用[ImageMagick](http://www.imagemagick.org/script/index.php)。它有一个强大的、可编写脚本的命令行界面并[处理文本到图像的转换](http://www.imagemagick.org/Usage/text/)。

# c# - 序列化私有成员数据

> ID：802711
> 
> 赞同：75
> 
> 时间：2009-04-29T14:49:17.963
> 
> 标签：c#, .net, xml, serialization, serializable

我正在尝试将一个对象序列化为具有许多属性的 XML，其中一些属性是只读的。

```
public Guid Id { get; private set; } 
```

我已经标记了类 [Serializable] 并且我已经实现了 ISerializable 接口。

下面是我用来序列化对象的代码。

```
public void SaveMyObject(MyObject obj)
{
    XmlSerializer serializer = new XmlSerializer(typeof(MyObject));
    TextWriter tw = new StreamWriter(_location);
    serializer.Serialize(tw, obj);
    tw.Close();
} 
```

不幸的是，它在这条消息的第一行发生了变化。

> InvalidOperationException 未处理：无法生成临时类 (result=1)。错误 CS0200：无法将属性或索引器“MyObject.Id”分配给 -- 它是只读的

如果我将 Id 属性设置为 public 它工作正常。有人可以告诉我我是否正在做某事，或者至少是否有可能？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-04-29T14:57:00.520

您可以使用`DataContractSerializer`（但请注意，您不能使用 xml 属性 - 只能使用 xml 元素）：

```
using System;
using System.Runtime.Serialization;
using System.Xml;
[DataContract]
class MyObject {
    public MyObject(Guid id) { this.id = id; }
    [DataMember(Name="Id")]
    private Guid id;
    public Guid Id { get {return id;}}
}
static class Program {
    static void Main() {
        var ser = new DataContractSerializer(typeof(MyObject));
        var obj = new MyObject(Guid.NewGuid());
        using(XmlWriter xw = XmlWriter.Create(Console.Out)) {
            ser.WriteObject(xw, obj);
        }
    }
} 
```

或者，您可以自己实现`IXmlSerializable`和做所有事情 - 但这`XmlSerializer`至少适用于 .

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T14:51:53.997

你可以使用`System.Runtime.Serialization.NetDataContractSerializer`. 它更强大，并修复了经典 Xml 序列化器的一些问题。

请注意，此属性有不同的属性。

```
[DataContract]
public class X
{
  [DataMember]
  public Guid Id { get; private set; }
}

NetDataContractSerializer serializer = new NetDataContractSerializer();
TextWriter tw = new StreamWriter(_location);
serializer.Serialize(tw, obj); 
```

**编辑：**

根据 Marc 的评论进行更新：您可能应该使用`System.Runtime.Serialization.DataContractSerializer`您的案例来获得干净的 XML。其余代码相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T14:59:45.630

只读字段不会使用 序列化`XmlSerializer`，这是由于`readonly`关键字的性质

来自 MSDN：

> *readonly*关键字是可以在字段上使用的修饰符。当字段声明包含 readonly 修饰符时，对声明引入的字段的赋值只能作为声明的一部分或在同一类的构造函数中发生。

所以...您几乎需要在默认构造函数中设置字段值...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T15:14:15.267

使用特定的序列化模式是不可能的（有关变通方法，请参阅其他评论）。如果你真的想保持你的序列化模式不变，你必须解决这个框架的限制。看这个[例子](http://en.allexperts.com/q/VB-NET-3306/Class-Serialization.htm)

本质上，标记属性`public`，但如果在反序列化以外的任何时间访问它，则抛出异常。

# c++ - 变量、指针、对象和内存地址：为什么我会得到这个奇怪的结果？

> ID：802717
> 
> 赞同：3
> 
> 时间：2009-04-29T14:51:20.313
> 
> 标签：c++, c, objective-c, pointers

在我认为我已经理解了它们的工作原理之后，我尝试了这个：

```
NSString *str1 = [NSString stringWithCString:"one"];
NSString *str2 = [NSString stringWithCString:"two"];
NSLog(@"str1: %x, %@", &str1, str1); //bfffd3cc, one
NSLog(@"str2: %x, %@", &str2, str2); //bfffd3c8, two

str1 = str2;
NSLog(@"str1: %x, %@", &str1, str1); //bfffd3cc, two 
```

指针（如 str1、str2）的值是内存地址。当您转到该地址时，您将到达内存中存储对象的“区域”。

但是：当我将 str2 分配给 str1 时，str1 的值应该是 str2 引用的同一对象的内存地址，对吧？这里奇怪的是，指针的值保持不变（bfffd3cc 内存地址），地址后面的东西发生了变化。这对我来说实际上完全不合逻辑；）因为我认为内存地址是对象（或者内存砖中对象的家，无论如何）。所以我期待这个：

```
NSString *str1 = [NSString stringWithCString:"one"];
NSString *str2 = [NSString stringWithCString:"two"];
NSLog(@"str1: %x, %@", &str1, str1); //bfffd3cc, one
NSLog(@"str2: %x, %@", &str2, str2); //bfffd3c8, two

str1 = str2;
NSLog(@"str1: %x, %@", &str1, str1); //bfffd3c8, two 
```

否则，我仍然没有明白这一点。“指针变量”的值和“实际值”之间的关系，可以说是位于该内存地址后面的对象。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-29T14:57:14.467

请记住，指针变量本身就是一个变量，所以它有一个地址。所以`&str1`导致指针变量的地址，并且`str1`是一个表达式，导致指针变量持有的任何内容 - 它指向的对象的地址。

假使，假设：

*   持有 NSString "one" 的对象位于地址 0x00000100
*   持有 NSString "two" 的对象位于地址 0x00000200

然后你的指针可能看起来像这样：

初始化时：

```
str1
0xbfffd3c8  +---------------+
            |               |
            |  0x00000100   |
            |    ("one")    |
            +---------------+

str2
0xbfffd3cc  +---------------+
            |               |
            |  0x00000200   |
            |    ("two")    |
            +---------------+ 
```

========================================

`str1 = str2;`分配后：

```
str1
0xbfffd3c8  +---------------+
            |               |
            |  0x00000200   |
            |    ("two")    |
            +---------------+

str2
0xbfffd3cc  +---------------+
            |               |
            |  0x00000200   |
            |    ("two")    |
            +---------------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T14:57:48.130

您正在打印指针的引用，它是指针的地址，而不是指针的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T15:01:30.697

`&str1`获取指针的地址。

好的，还记得我们说过所有事物都“生活”在内存中的某个地址吗？指针就是数字，数字就是地址？

好吧，指针也是事物，因此*它们*具有地址。

当您 print out 时`&str1`，您将打印出指针占用的内存。当您打印出时`str1`，您将打印出指针的值，即它*指向*的内存地址。

当您打印出来时，`*str1`您将取消引用指针，并打印*打印*指向的值。

* * *

顺便说一句，干得好：我已经阅读了您的最后两个问题，并且您得到了它，并且以您的信誉编写代码来证明或反驳您的理解是正确的。这正是你应该做的，而且你在正确的轨道上。

您遇到的部分问题是字符串是有趣的东西，因为字符串实际上是（const）字符的数组，而像 NSLog 这样的函数被编写为使用指向 char 的指针来执行通常的操作，即打印细绳。给定一个指向字符串的指针，它实际上是在循环：取消引用指针，打印指向的字符，给指针加一，打印下一个字符，直到指向的字符是一个值为 0 的特殊字符，此时它已找到字符串的结尾并停止打印字符。

如果您使用诸如整数和指向整数的指针之类的东西，您可能会发现所有这些都更容易理解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T14:58:22.217

`str1`是一个指向`NSString`值的指针。

`&str1`表示：`str1`变量的地址。这是一个双重间接。

我猜你想要值的地址，即`str1`它本身，而不是`&str1`.

让我们假设`NSString`包含的对象值`@"one"`位于 address`0x12345678`并且`@"two"`位于`0x1234ABC0`。

最初是 的值`str1`和`0x12345678`的`str2`值`0x1234ABC0`。这两个值分别存储在内存中的地址`0xbfffd3cc`和处`0xbfffd3c8`。这些是`str1`和`str2`变量的地址，即 和 的`&str1`值`&str2`。

当您编写`str1 = str2`时，赋值将 的值更改为`str1`与 的值相同`str2`，即 的值`str1`是 then `0x1234ABC0`。这是`@"two"`对象的地址。但是`str1`变量 ( `0xbfffd3cc`) 的地址没有改变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T15:00:16.847

实际上，指针是具有专用算术的整数（IIRC，保证 sizeof(int) == sizeof(void*)）

如果您引用指针，您将获得存储它的地址；如果变量是自动的，那么您将在堆栈中获得存储指针的地址：这就是您获得这些结果的原因。

赋值行为类似于整数之间的赋值；实际上：

```
#include <stdio.h>

int main() {
        char *str1 = "Ciao";
        char *str2 = "Mondo";
        printf("%x\n", str1);
        printf("%x\n", str2);
        str1 = str2;
        printf("%x\n", str1);
} 
```

印刷：

```
:~$ ./a.out
80484f8
80484fd
80484fd 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T15:40:19.853

Objective-C 中的对象是使用指针来处理的。因此，为了处理您的 NSString 对象，您必须获取指向它的指针。这就是 str1 是一个指向 NSString 对象的指针。

如果你想向你的 NSString 发送消息，你可以使用语法 [str1 doSomething]。

如果要打印字符串，则必须将指针传递给 NSLog 并告诉 NSLog 指针指向 NSString，这是由格式化规则“%@”完成的。

现在，如果您只想打印 str1 指向的地址，您仍然必须传递指针 str1 但您必须告诉 NSLog 您正在使用格式化规则“%x”将其打印为十六进制值。

类似的东西应该打印你想要的东西：

```
// First print str1 as an hexadecimal value
// Then print the content of the NSString object str1 points to
NSLog(@"str1: %x, %@", str1, str1); 
```

# php - PLESK 8.4 中的 PHP safe_mode 默认值为 ON。为什么？

> ID：802721
> 
> 赞同：0
> 
> 时间：2009-04-29T14:51:55.273
> 
> 标签：php, plesk, php-safe-mode

我想知道为什么 PLESK 中 PHP safe_mode 的默认值是 ON。我怀疑这是一个安全问题，但这到底有什么用？

ps 作为一个没有经验的 web 开发人员，我花了几个小时想知道为什么 .php 文件被下载而不是在我的服务器上运行。原因是这个 php 默认的 safe_mode 是开启的，我通过对 plesk 控制面板的设置进行随机合理的外观更改找到了解决方案。通过问这个问题，我想为我在这个荒谬的问题上失去的令人沮丧的时间找到安慰。对我来说，默认情况下不运行 .php 文件并且没有明确解释为什么它们不起作用只是愚蠢的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:22:19.833

文件显示而不是执行的问题与`safe_mode`.

`safe_mode`对于确保您的脚本不能执行可能允许黑客侵入您的服务器的潜在不安全操作至关重要。

听起来你已经设法随机更改了实际链接`.php`文件的设置，`mod_perl`以便它们正确运行，但如果你不知道你在做什么，你真的应该`safe_mode`重新打开。

此外，作为调试问题时的一般经验法则：**一次只更改一件事，然后在每次更改之间进行测试**。这将有助于消除关于哪些更改实际上解决了问题的虚假假设......

# .net - Control.Select() 和 Control.Focus() 有什么区别？

> ID：802722
> 
> 赞同：55
> 
> 时间：2009-04-29T14:52:08.143
> 
> 标签：.net, winforms, user-interface, behavior

在 WinForms 中，要将焦点设置到特定控件，我似乎总是最终调用`Control.Select()` **并** `Control.Focus()`让它工作。

有什么区别，这是正确的方法吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-08-05T10:06:49.427

Focus() 是实际设置焦点的低级函数。

Select() 是一个更高级别的方法。它首先在控件的父层次结构中向上迭代查找，直到找到容器控件。然后它设置该容器的 ActiveControl 属性（到被调用的控件）。然而，这些方法中的逻辑并不简单，并且对 UserControl 容器进行了特殊处理。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-29T14:54:23.070

> Focus 是一种低级方法，主要用于自定义控件作者。相反，应用程序程序员应该对子控件使用 Select 方法或 ActiveControl 属性，或对窗体使用 Activate 方法。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.focus.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.focus.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-11T18:12:05.123

例如，如果您尝试将 Forms App 的控件设置为打开它时的默认焦点，则在 InitializeComponent() 之后在构造函数中调用时，只有 Select() 将起作用。Focus() 不会。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-30T12:06:29.720

只是为了添加到该线程中，我发现在编写将其他控件从一个窗体移动到另一个窗体（新创建的窗体）的用户控件时。原始表单无法再选择控件，但使用焦点允许它这样做。我认为这强调了有关这些方法工作水平的答案。但这也意味着说在更高级别使用 Select 不够简单，因为 select 在原始表单上不再按预期工作（不是我应该将它放入不同的表单 - 我接受）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-05T12:11:08.987

在某些情况下，如果没有焦点，Focus() 可能会导致拥有该控件的窗口获得焦点。Select() 不会引起窗口的焦点抓取。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-13T06:25:26.610

根据个人经验，我编写了一个继承 Windows ComboBox 的用户控件。我必须编写代码来覆盖该`OnEnter`事件，并且我在那里有一个声明说

```
If Me.Focused Then ... Else ... 
```

然而，不幸的是它返回了意想不到的结果。如果我调用`MyCustomerComboControl.Select`（在 Load、Shown 或 Activated 事件中）它调用该`OnEnter`方法但未能注册它有焦点（即 Focused 为 False）但如果我调用 Focus 它工作。此外`Select`，如果表单是打开的，即如果我选择了另一个控件然后重新选择了原始控件，一切都很好。因此，在我的场景以外的任何其他情况下，请使用，`Select`因为上面是这样说的。

# openid - 认证？，开放ID？两者都不？我的网站应该支持哪一个？

> ID：802729
> 
> 赞同：21
> 
> 时间：2009-04-29T14:53:31.760
> 
> 标签：openid, oauth, registration

我在一个新网站上工作，想要一些关于 OAuth、OpenID 和标准网站拥有的用户名/密码的建议/反馈。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-29T14:56:53.780

您可能想阅读Malcom Tredinnick 的[这篇文章](http://web.archive.org/web/20080318052514/http://www.pointy-stick.com/blog/2008/03/13/explanation-difference-between-openid-and-oauth/)，它解释了 openid 和 oauth 是什么以及做什么。它们服务于不同的目的。

总之，openid 将用于唯一标识用户 - 这是一种身份解决方案。oAuth 将通过允许用户授予您的站点对外部服务（例如他们的 flickr 帐户）的临时访问权限来提供一种与您站点的用户可以访问的数据进行交互的方法——它是一种授权工具。

当然，仅提供标准的特定于站点的帐户始终是一种选择，但恕我直言，支持 openid 对您的用户和网络来说更好。许多实现 openid 的网站允许用户使用 openid（如果有），但也允许用户登录并创建没有 openid 的帐户。因此，它不一定是非此即彼的命题。你可以两者都做！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T02:10:55.897

请记住，即使您的网站不需要访问您用户在其他网站上的私人数据，如果您的网站有用户可能希望通过 API 或其他网站访问的数据，OAuth 仍可能适用。使用 OAuth，任一端或两者都可能适用于您的站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:55:35.000

我对 OAuth 的印象是，它更多的是允许对 API 进行安全、经过身份验证的访问，而不是一般用户访问。

就个人而言，我希望看到更多网站支持 OpenID。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-18T00:25:49.360

我赞成支持使用 OpenID、Facebook 和任何其他身份验证器集成用户授权。给用户一个选择。

还给他们不使用它们的选项。特别是在面向成人的网站中，您的用户可能会选择不使用不像简单注册您的网站那样匿名的东西。只需在存储密码时使用最佳实践。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T13:27:46.170

JanRain 让您几乎接受[一切](https://rpxnow.com/)。鉴于大玩家总是想成为提供者而不是消费者，这可能是唯一现实的“通用”选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T13:37:47.430

您可以将所有这些结合起来并充分利用它，但这取决于您的设计选择。

例如，如果您使用 Java，您可以配置 Acegi(Spring Security) 以允许 openID 以及您的正常身份验证机制。

openID 具有 OAuth 扩展

OAuth 具有 openID 扩展

由你决定...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-06T14:39:46.057

[这](http://hueniverse.com/oauth/guide/intro/)是非常清晰的解释。直接来自 OAuth 文档。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-18T00:22:10.917

截至 2011 年 11 月，开发人员预览版中有一个名为[OpenID Connect](http://openid.net/connect/)的新标准。它建立在 OAuth 2.0 之上，据我所知，它标准化了 Facebook 做事的方式，它也是建立在 OAuth 2.0 之上的。它看起来很有希望，因为在 Facebook 身份验证协议方面有很多经验，它可能是许多 Web 开发人员正在寻找*的解决方案。*虽然我还没有深入研究它，所以我可能会误解它，但这是我在阅读[这篇关于它的博客文章后](http://softwareforallseasons.blogspot.com/2011/10/oauth-vs-openid-connect.html)理解它的方式。

# asp.net - 是否可以实现自更新的 ASP.NET Web 应用程序？

> ID：802736
> 
> 赞同：4
> 
> 时间：2009-04-29T14:54:36.483
> 
> 标签：asp.net, auto-update, self-updating

Wordpress 具有自我更新的能力（根据管理员用户的请求）。

是否可以使用 ASP.NET 实现类似的东西？

我可以看到导致问题的 web.config 和 bin 文件夹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T14:59:24.337

除了这对安全的影响之外，是的，它应该是可能的。但是您所说的是让 asp.net 进程有权修改其目录中的所有数据。

这对我来说听起来有点危险。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T15:16:06.823

web.config 和 bin 文件夹应该不是问题，实际上您可以在 ASP.Net 应用程序运行时编辑它们。现有会话继续查看“旧”配置或 bin，新会话获取新会话。

**编辑**：这个链接描述了我的意思：[http ://technet.microsoft.com/en-us/library/cc759560.aspx](http://technet.microsoft.com/en-us/library/cc759560.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T15:21:50.040

ASP.NET 在您的 bin 文件夹中使用 dll 的 shadowcopy 来允许您将一组新的 dll 和内容复制到服务器，而不会锁定这些文件。因此，dll 和 web.config 不是问题。

问题在于让运行 ASP.NET 站点的进程对文件系统具有写入权限。这通常是一个坏主意。您应该考虑将这种“自动更新”功能交给可能在您的 Web 服务器上运行的服务。

看看这个...

[http://www.odetocode.com/articles/305.aspx](http://www.odetocode.com/articles/305.aspx)

... 对于“ASP.NET 程序员应该了解的应用程序域”，但要认真考虑您所建议的安全含义。您将如何阻止某人将恶意代码上传到您的网站？

# html - 为什么 html 将表格单元格称为“td”而不是“tc”？

> ID：802737
> 
> 赞同：47
> 
> 时间：2009-04-29T14:55:27.700
> 
> 标签：html

我没有浏览过规范，但我怀疑那里有任何信息。它代表表格数据吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-04-29T14:58:00.110

表格单元格有两个选项：TD 或 TH。

TH = 表头

TD = 表数据。

两者都是表格单元格。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-29T14:56:50.677

简短的回答：是的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T14:58:40.593

表格数据单元：[http ://htmlhelp.com/reference/html40/tables/td.html](http://htmlhelp.com/reference/html40/tables/td.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T14:57:35.790

来自[维基百科](http://en.wikipedia.org/wiki/Html_table#Tables)：

> ```
> <td>...</td> 
> ```
> 
> 一个`<table>`数据单元格。
> 
> 在 HTML 3.0 草案中提出；在 HTML 3.2 中标准化；仍然是最新的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-29T14:58:05.633

是的，它代表“表格数据单元格”

[http://www.december.com/html/4/element/td.html](http://www.december.com/html/4/element/td.html)

# sharepoint - 用于创建 Web 应用程序的 STSADM 命令

> ID：802749
> 
> 赞同：2
> 
> 时间：2009-04-29T14:57:28.943
> 
> 标签：sharepoint, sharepoint-2007, stsadm

我正在编写（尽可能多地）MOSS 2007 环境迁移。我可以使用 STSADM 命令的批处理文件完成大部分工作，但是，我无法找到创建 Web 应用程序的 STSADM 命令。一个存在吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:48:13.360

PowerShell 可能是一个不错的选择。我相信它将在下一版本的 SharePoint 中取代 stsadm。这是一篇不错的博客文章，其中包含几个用于 SharePoint 的 PowerShell 链接：[http](http://masteringsharepoint.com/blogs/bobmixon/archive/2008/08/15/powershell-and-sharepoint.aspx) ://masteringsharepoint.com/blogs/bobmixon/archive/2008/08/15/powershell-and-sharepoint.aspx 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T17:08:18.880

[stsadm -o 扩展](http://technet.microsoft.com/en-us/library/cc263040.aspx)

extendvs 扩展现有的 Web 应用程序，或者如果 Web 应用程序不存在，则创建一个新的 Web 应用程序。

我在构建脚本中使用此操作来创建我的 Web 应用程序。

例子：

```
stsadm.exe -o extendvs -url %urlintranet% -ownerlogin %actintranet% -owneremail %intranetowner% -exclusivelyusentlm -databasename %dbcintranet% -donotcreatesite -apcreatenew -apidname %apintranet% -apidtype configurableid -apidlogin %actapintranet% -apidpwd %pwdapintranet% -description %intranetdesc% 
```

要创建您的网站集，请使用[stsadm -o createsite](http://technet.microsoft.com/en-us/library/cc262594.aspx)

# typo3 - 列表模块中的动态数据库记录图标？

> ID：802750
> 
> 赞同：1
> 
> 时间：2009-04-29T14:57:30.363
> 
> 标签：typo3

在 TYPO3 中，有没有办法将扩展表中包含的图像的缩略图渲染为 **列表**模块中记录的图标？TCA 文档似乎没有说你可以！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-03-27T07:19:16.780

是的，这可以通过使用`typeicon_column`and来实现`typeicons`。例子：

```
$TCA['tx_mytable'] = array (
    'ctrl' => array (
        'iconfile' => t3lib_extMgm::extPath($_EXTKEY) . 'Resources/Private/Icons/default.png',
        'typeicon_column' => 'mime_type',
        'typeicons' => array (
            'application/msword'                => 'gfx/fileicons/doc.gif',
            'application/msexcel'               => 'gfx/fileicons/xls.gif',
            'application/mspowerpoint'  => 'gfx/fileicons/ppt.gif',
            'application/pdf'                       => 'gfx/fileicons/pdf.gif',
            'application/zip'                       => 'gfx/fileicons/zip.gif',
            'image/bmp'                                 => 'gfx/fileicons/bmp.gif',
            'image/gif'                                 => 'gfx/fileicons/gif.gif',
            'image/jpeg'                                => 'gfx/fileicons/jpg.gif',
            'image/jpg'                                 => 'gfx/fileicons/jpg.gif',
        ),
    )
); 
```

=> [http://typo3.org/documentation/document-library/core-documentation/doc_core_api/4.2.0/view/4/2/](http://typo3.org/documentation/document-library/core-documentation/doc_core_api/4.2.0/view/4/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T05:52:37.877

可以为 Typo3 后端导入几种不同的皮肤，这些皮肤会更改“列表模块”中使用的图标。例如 t3skin 和[t3skin_improved](http://typo3.org/documentation/document-library/extension-manuals/t3skin_improved/current/)。

我不能说生成缩略图并将它们用作图标需要什么，但是有几个扩展使用 GraphicsMagick/ImageMagick 来呈现缩略图。

# .net - Boo 是编写单元测试的好选择吗？

> ID：802763
> 
> 赞同：2
> 
> 时间：2009-04-29T14:58:48.207
> 
> 标签：.net, unit-testing, boo

我正在 Castle 堆栈上使用 C# 进行开发。我是单元测试的新手，我听说更灵活的语言（比 C#）可能会使编写测试更容易。

你认为仅仅为了编写单元测试而学习 Boo 值得吗？

我们使用 SharpDevelop IDE，因此提供了 Boo 支持，我一直在寻找学习新 CLR 语言的借口，但我只是不希望它妨碍学习单元测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T23:19:10.890

为了*真正*利用 Boo 作为一种测试语言，请看一下[Spectre](http://specter.sourceforge.net/)（一个实现为 Boo DSL 的 BDD 框架）。否则，它只是另一种使用[xUnit](http://en.wikipedia.org/wiki/XUnit)的 CLR 语言。

如果您刚开始进行单元测试，我同意 Esko，只需使用 C# + NUnit，您会发现更多信息和示例代码。

这是一个网络项目吗？学习 Boo 的另一个好借口是使用[Brail](http://www.castleproject.org/monorail/documentation/trunk/viewengines/brail/index.html)视图引擎（最初来自 Monorail，但现在[也可用于 ASP.NET MVC](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=Brail&referringTitle=Documentation)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:23:57.973

如果您不熟悉单元测试，最好至少在您掌握基本知识之前使用熟悉的语言（可能是几周）。当您觉得您使用的语言/框架过于冗长或限制时，请尝试其他方法。

我主要使用 Java 进行开发，但我计划转向 Scala。将来我可能仍会用 Java 编写应用程序代码的某些部分，但对于测试，我更喜欢使用 Scala、Ruby、Groovy 或类似的语法更灵活的语言。例如，对于 Java/C#，您需要为测试使用长描述性方法名称，但对于更灵活的语言，您可以只使用纯字符串，这使得测试名称更具可读性： http: [//www.codecommit.com /blog/java/the-brilliance-of-bdd](http://www.codecommit.com/blog/java/the-brilliance-of-bdd)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:05:56.473

如果它在您的公司在政治上可行，可能。测试代码通常比生产代码具有更少的耦合，让您可以轻松地使用和探索所使用的语言。这将为您提供学习新语言的良好环境。

# sql - PostgreSQL "IF" 语法错误

> ID：802764
> 
> 赞同：12
> 
> 时间：2009-04-29T14:58:57.643
> 
> 标签：sql, postgresql, syntax, if-statement

我是 PostgreSQL 新手，我已经遇到了第一个问题。

我写了一些代码来了解事务是如何工作的，按照手册一步一步来。

简而言之，我创建了 2 个表，用户和移动：第一个表中包含名称、电子邮件和信用列，第二个表中包含 from、to、import 列。

所以，我正在尝试这种方式：

```
BEGIN;
INSERT INTO movements (from, to, import) VALUES ('mary', 'steve', 600);
UPDATE users SET credit = credit - 600 WHERE name = 'mary';
UPDATE users SET credit = credit + 600 WHERE name = 'steve';
--here comes the problem!
IF (SELECT credit FROM users WHERE name = 'mary') < 0 THEN
 ROLLBACK;
END IF
COMMIT; 
```

我总是得到错误：

> 错误：“IF”处或附近的语法错误

我错在哪里？

PS：不要专注于示例功能，这只是我理解交易的尝试......现在，IF子句......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T15:16:19.380

正如 Johannes 已经说过的：您将常规 SQL 与存储过程语言 PL/pgSQL 混合在一起。Johannes 提供的链接应该向您解释存储过程的概念。

我认为你这样做是作为一个脚本？执行一个又一个语句？恐怕您只能在存储过程或函数中做您想做的事情，正如您所说的那样。这是因为当您以这种方式执行语句时，每个语句都是独立的，与其他语句没有任何关系或信息。

此外，您可以查看以下链接以获取有关如何使用 IF ... THEN ... ELSE ... END IF 的更多信息；plpgsql 中的条件：[链接](http://www.postgresql.org/docs/8.3/static/plpgsql-control-structures.html#PLPGSQL-CONDITIONALS)。

* * *

**编辑：**

[我不知道此时是否允许 ROLLBACK（因为每个存储过程都已经在它自己的事务中），但是您必须能够使用大量文档 @ http://www.postgresql.org](http://www.postgresql.org)自己弄清楚. 这是一个包含您的代码的示例函数，还演示了一些其他语法：

```
CREATE OR REPLACE FUNCTION public.test()
RETURNS integer AS
$$
DECLARE
tempvar integer;

BEGIN    
     tempvar := 1;

     INSERT INTO movements (from, to, import) VALUES ('mary', 'steve', 600);
     UPDATE users SET credit = credit - 600 WHERE name = 'mary';
     UPDATE users SET credit = credit + 600 WHERE name = 'steve';

     --here comes the problem!
     IF (SELECT credit FROM users WHERE name = 'mary') < 0 THEN
        ROLLBACK;
     END IF;

     RETURN tempvar;
END
$$
LANGUAGE 'plpgsql'
VOLATILE
CALLED ON NULL INPUT
SECURITY INVOKER; 
```

但是，如果您真的要走这条路，我建议您使用 GUI DB 管理器。学习这一切更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T15:02:50.223

您似乎使用plain `SQL`，但该`IF`语句是[`PL/pgSQL`](http://www.postgresql.org/docs/current/static/plpgsql.html)PostgreSQL一部分的过程语言的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T15:17:23.793

如果您想避免这种情况，您可以将代码重写为：

```
BEGIN;

    INSERT INTO movements (from, to, import)    
    SELECT 'mary', 'steve', CASE credit < 600 WHEN TRUE THEN 0 ELSE 600 END;

    UPDATE users SET credit = credit - CASE credit < 600 WHEN TRUE THEN 0 ELSE 600 END    
    WHERE name = 'mary';

    UPDATE users u SET u.credit = u.credit + CASE v.credit < 600 WHEN TRUE THEN 0 ELSE 600 END    
    FROM users v    
    WHERE u.name = 'steve' and v.name = 'mary'

COMMIT; 
```

是的，这很愚蠢:)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T04:50:32.530

您可以尝试修改 IF 部分，从：

```
IF (SELECT credit FROM users WHERE name = 'mary') < 0 THEN
 ROLLBACK;
END IF 
```

到

```
SELECT SUM(credit) INTO v_credit FROM users WHERE name = 'mary';
IF (v_credit) < 0 THEN
 ROLLBACK;
END IF 
```

假设 v_credit 是您之前定义的变量。恕我直言，Postgre 假设 SELECT 查询返回多个结果，即使您非常确定它是唯一的。因此，我认为您可以尝试先将值分配给变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T16:46:22.377

与 Microsoft 的 SQL 和 T/SQL 类似，如果它们的顺序正确，您应该能够将常规 SQL 与 PL/pgSQL 混合使用。这是一个示例，其中序列在混合 SQL/PL 存储过程中很重要：

您不能将条件语句包装在游标内——您必须将游标放在条件语句内。如果您以相反的方式执行序列，您将得到与您看到的相同的错误，“错误：在“IF”或附近出现语法错误”：

```
CREATE OR REPLACE FUNCTION getSubsystemFaultListCount(_bunoid integer, _subsystem text, _starttime timestamp without time zone, _stoptime timestamp without time zone)
      RETURNS refcursor AS
    $BODY$
    DECLARE mycurs refcursor;
    BEGIN 
        IF _subsystem = 'ALL' THEN
            OPEN mycurs FOR
            SELECT  count(*), fs_fault.faultcode, fs_fault.downloadtime
            FROM    fs_fault
            WHERE   fs_fault.bunoid = _bunoid
                AND fs_fault.statusid IN(2, 4)
                AND fs_fault.downloadtime BETWEEN _starttime AND _stoptime
            GROUP BY fs_fault.faultcode, fs_fault.downloadtime;
            RETURN mycurs;
        ELSE
            OPEN mycurs FOR
            SELECT  count(*), fs_fault.faultcode, fs_fault.downloadtime
            FROM    fs_fault
            WHERE   fs_fault.bunoid = _bunoid
                AND fs_fault.subsystemid 
                    IN(SELECT id FROM fs_subsystem WHERE type = _subsystem)
                AND fs_fault.statusid IN(2, 4)
                AND fs_fault.downloadtime BETWEEN _starttime AND _stoptime
            GROUP BY fs_fault.faultcode, fs_fault.downloadtime;
            RETURN mycurs;
        END IF;

    END;
    $BODY$ 
```

我是 PostGresSQL 的初学者；这个函数只是一个例子。

# php - 在 PHP5 中查找语言环境日期表示

> ID：802765
> 
> 赞同：0
> 
> 时间：2009-04-29T14:59:06.943
> 
> 标签：php, date-formatting

我的网站根据用户设置或浏览器设置（用户尚未设置偏好）更改其区域设置。我正在使用 amline 图表，特别是股票图表，它需要 'MM/DD/YYYY' 或 'DD-MM-YYYY' 中的日期格式，我想图表知道如何理解日期。有很多方法可以根据计算机区域设置格式化日期，但是我找不到获取区域设置格式的方法（如上所述）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T18:35:18.340

[Zend 框架](http://framework.zend.com)带有一个类，`Zend_Locale`该类依次访问[Unicode 区域设置数据标记语言 (LDML)](http://unicode.org/reports/tr35/)中的一堆 XML 文件。其中包含许多其他内容，本地化日期格式。查看[Unicode Common Locale Data Repository (CLDR)](http://cldr.unicode.org/)了解更多信息。

例如，德语的 XML 文件将包含类似

```
<dateFormats>
    <dateFormatLength type="full">
        <dateFormat>
            <pattern>EEEE, d. MMMM yyyy</pattern>
        </dateFormat>
    </dateFormatLength>
    <dateFormatLength type="long">
        <dateFormat>
            <pattern>d. MMMM yyyy</pattern>
        </dateFormat>
    </dateFormatLength>
    <dateFormatLength type="medium">
        <dateFormat>
            <pattern>dd.MM.yyyy</pattern>
        </dateFormat>
    </dateFormatLength>
    <dateFormatLength type="short">
        <dateFormat>
            <pattern>dd.MM.yy</pattern>
        </dateFormat>
    </dateFormatLength>
</dateFormats> 
```

现在，我自己还没有使用过它，但是通过简要浏览它，我猜这`Zend_Locale_Data::getContent()`是您的朋友，应该为您提供所需的所有信息。

如果您不想使用 ZF，您可以使用您选择的 XML 解析器直接访问这些文件（您可能可以在`unicode.org`.

# c# - C# - 将 json 格式的数据解析为嵌套的哈希表

> ID：802766
> 
> 赞同：6
> 
> 时间：2009-04-29T14:59:07.410
> 
> 标签：c#, json, hashtable

我正在尝试在 C# 中使用一些 json 格式的数据，但是，我在确定解决问题的正确方法时遇到了一些问题。我的问题是 json 格式的数据将采用未知格式（我知道这听起来很奇怪……请继续阅读）。基本上，json 格式的数据将是一些名称/值对的集合，其中的值可能是也可能不是嵌套的名称/值对的数组。为了让事情变得更有趣，名称/值对数组的嵌套可以无限地继续下去。

例如：我可能有一些数据看起来像……</p>

```
{
    "1": {
        "1.1": {
            "1.1.1": "value1",
            "1.1.2": "value2",
            "1.1.3": "value3"
        },
        "1.2": "value4",
        "1.3": {
            "1.3.1": {
                "1.3.1.1": "value5",
                "1.3.1.2": "value6"
            },
            "1.3.1.2": "value7",
            "1.3.1.3": "value8"
        }
    }
} 
```

不幸的是，我不知道会发生多少嵌套，从技术上讲，我不知道任何给定消息中会出现哪些名称/值对。

C# 中是否有任何受支持的机制可以让我轻松地将其解析为一组嵌套的 hastables？

我想做一些类似的事情（请注意，这段代码在语法上不是 100% 正确的，最好通过递归来完成……但它的想法很明确）。

```
Hashtable ht = [deserialize data method](jsonformattedstring);
foreach (Hashtable nested in ht)
{
    If (nested.count > 1)
        {
        Foreach (hashtable next in nested)
        …
        }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T15:08:39.213

在 .NET 中，您有[JsonArray](http://msdn.microsoft.com/en-us/library/system.json.jsonarray(VS.95).aspx)，它允许您加载和解析 JSON 数据。它创建了一个 JsonValue 数组，它基于它解析的 JSON 数据完全嵌套。

如果您特别需要 Hashtable，则可以从 JsonArray 转换数据，尽管 Hastable 几乎已被弃用，取而代之的是 Dictionary。

Josh Holmes 有一篇关于 .NET 中 JSON 的非常好的“入门”帖子：http: [//www.joshholmes.com/blog/2009/01/20/PlayingWithJSON.aspx](http://www.joshholmes.com/blog/2009/01/20/PlayingWithJSON.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T15:16:45.137

我不喜欢.Net Json 解析......它偶尔会做一些奇怪的事情。我已经切换到[Json.NET](http://james.newtonking.com/projects/json-net.aspx)，一个开源库。它有一个很好的 JObject 对象，可以满足您的需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-15T06:47:09.367

你可能想看看[http://techblog.procurios.nl/k/n618/news/view/14605/14863/How-do-I-write-my-own-parser-for-JSON.html](http://techblog.procurios.nl/k/n618/news/view/14605/14863/How-do-I-write-my-own-parser-for-JSON.html)这是一个将 JSON 字符串解析为 Hashtables 和 ArrayLists 的简单库。它还可以将这些结构再次转换为 JSON。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T20:02:50.187

这是我用 C# 编写的用于解析 JSON 并返回字典的方法。当然，它并不适用于所有用例，但这样的事情会给你一个很好的 JSON 一次性解析：

```
/*
     * This method takes in JSON in the form returned by javascript's
     * JSON.stringify(Object) and returns a string->string dictionary.
     * This method may be of use when the format of the json is unknown.
     * You can modify the delimiters, etc pretty easily in the source
     * (sorry I didn't abstract it--I have a very specific use).
     */ 
    public static Dictionary<string, string> jsonParse(string rawjson)
    {
        Dictionary<string, string> outdict = new Dictionary<string, string>();
        StringBuilder keybufferbuilder = new StringBuilder();
        StringBuilder valuebufferbuilder = new StringBuilder();
        StringReader bufferreader = new StringReader(rawjson);

        int s = 0;
        bool reading = false;
        bool inside_string = false;
        bool reading_value = false;
        //break at end (returns -1)
        while (s >= 0)
        {
            s = bufferreader.Read();
            //opening of json
            if (!reading)
            {
                if ((char)s == '{' && !inside_string && !reading) reading = true;
                continue;
            }
            else
            {
                //if we find a quote and we are not yet inside a string, advance and get inside
                if (!inside_string)
                {
                    //read past the quote
                    if ((char)s == '\"') inside_string = true;
                    continue;
                }
                if (inside_string)
                {
                    //if we reached the end of the string
                    if ((char)s == '\"')
                    {
                        inside_string = false;
                        s = bufferreader.Read(); //advance pointer
                        if ((char)s == ':')
                        {
                            reading_value = true;
                            continue;
                        }
                        if (reading_value && (char)s == ',')
                        {
                            //we know we just ended the line, so put itin our dictionary
                            if (!outdict.ContainsKey(keybufferbuilder.ToString())) outdict.Add(keybufferbuilder.ToString(), valuebufferbuilder.ToString());
                            //and clear the buffers
                            keybufferbuilder.Clear();
                            valuebufferbuilder.Clear();
                            reading_value = false;
                        }
                        if (reading_value && (char)s == '}')
                        {
                            //we know we just ended the line, so put itin our dictionary
                            if (!outdict.ContainsKey(keybufferbuilder.ToString())) outdict.Add(keybufferbuilder.ToString(), valuebufferbuilder.ToString());
                            //and clear the buffers
                            keybufferbuilder.Clear();
                            valuebufferbuilder.Clear();
                            reading_value = false;
                            reading = false;
                            break;
                        }
                    }
                    else
                    {
                        if (reading_value)
                        {
                            valuebufferbuilder.Append((char)s);
                            continue;
                        }
                        else
                        {
                            keybufferbuilder.Append((char)s);
                            continue;
                        }
                    }
                }
                else
                {
                    switch ((char)s)
                    {
                        case ':':
                            reading_value = true;
                            break;
                        default:
                            if (reading_value)
                            {
                                valuebufferbuilder.Append((char)s);
                            }
                            else
                            {
                                keybufferbuilder.Append((char)s);
                            }
                            break;
                    }
                }
            }
        }
        return outdict;
    } 
```

# subsonic - SubSonic 2.1 SqlQuery 多个 Where()s？

> ID：802780
> 
> 赞同：0
> 
> 时间：2009-04-29T15:01:42.397
> 
> 标签：subsonic, where, sql

我正在构建一个 SqlQuery 来支持临时查询屏幕。

我想要这样的东西：

```
SqlQuery q = new Select().From<VwInstitutes>();
if (!string.IsNullOrEmpty(username))
{
    q.Where(VwInstitutes.Columns.AssignedUser).IsEqualTo(username); 
}

if (!string.IsNullOrEmpty(stage))
{
    q.Where(VwInstitutes.Columns.Stage).IsEqualTo(stage); 
} 
```

我的问题是——附加多个 Where() 似乎不起作用——对吗？

所以现在我正在写这个，但它很丑陋。

```
if (!string.IsNullOrEmpty(username)) 
{ 
    if (q.HasWhere) q.And(VwInstitutes.Columns.AssignedUser).IsEqualTo(username); 
    else q.Where(VwInstitutes.Columns.AssignedUser).IsEqualTo(username); 
}

if (!string.IsNullOrEmpty(stage))
{
    if (q.HasWhere) q.And(VwInstitutes.Columns.Stage).IsEqualTo(stage); 
    else q.Where(VwInstitutes.Columns.Stage).IsEqualTo(stage);
} 
```

请告诉我，这种情况有更好的成语。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:14:37.327

从始终评估为 true 的 where 开始查询。

```
new Select().From().Where("1").IsEqualTo("1"); 
```

然后使用 q.And 构建查询的其余部分。也请参阅[此线程](http://forums.subsonicproject.com/forums/t/4020.aspx)。

# iphone - UINavigationItem 的持久 rightBarButtonItem 属性

> ID：802781
> 
> 赞同：8
> 
> 时间：2009-04-29T15:01:48.713
> 
> 标签：iphone, uibutton, uinavigationbar, uibarbuttonitem

`UIBarButtonItem`这可能是一个愚蠢的问题，但是否有可能在由 a 管理的多个视图中保持权限`UINavigationController`？我有一系列经常共享相同权限的视图`UIBarButtonItem`，但是当我向我的 推送新视图时`UINavigationController`，我每次都必须重新定义按钮，即使它没有改变。大多数情况下，从一个视图到下一个视图的明显过渡动画让我感到困扰，因为完全相同的按钮会短暂地淡出然后又回来，这是不必要的，因为没有实际的视觉变化。我是否应该考虑只添加一个`UIButton`作为我的子视图`UINavigationBar`并以这种方式完成“右栏按钮”效果？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T03:09:18.420

我们在我们的应用程序中做到了这一点。我们创建了一个 UIBarButtonItem，当用户导航时我们从一个 UIViewController 交换到另一个。诀窍是使用 UINavigationControllerDelegate、navigationController:willShowViewController:animated: 方法。我们将传出的 UIViewController 的 rightBarButtonItem 设置为 nil，将传入的控制器的 rightBarButtonItem 设置为您的按钮。管理起来很痛苦，但它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-01T09:50:36.933

UIBarButtonItems 可以在 nib/xib 文件中创建为独立实例。如果没有什么特别的事情阻止您在界面构建器中构建按钮，您应该为每个需要重用按钮的视图控制器将其连接到 UINavigationItem 的 rightBarButtonItem 属性。不需要目标c。

# django - Django 用户组

> ID：802782
> 
> 赞同：1
> 
> 时间：2009-04-29T15:01:59.493
> 
> 标签：django, usergroups

经过身份验证的用户可以添加组（如果有权限）、添加用户（添加到他创建的组中的用户）以及为组或用户添加权限。

解决该任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:30:52.920

尽管 django 的用户/组模型没有以限制用户的方式设置，以便他们只能修改他们创建的用户/组，但可以实现。

[这是一个 django 片段](http://www.djangosnippets.org/snippets/1054/)，它提供了对象级权限的示例。

也许您可以详细说明您要解决的问题。

# c++ - 参考资料和 auto_ptr

> ID：802784
> 
> 赞同：1
> 
> 时间：2009-04-29T15:02:20.460
> 
> 标签：c++, reference, auto-ptr

如果我有一个 auto_ptr，我可以通过它作为参考吗？比如：

```
auto_ptr<MyClass>Class(new MyClass);
void SetOponent(MyClass& oponent);
//So I pass SetOponent(Class) 
```

auto_ptrs 的奇数复制行为是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T15:04:51.077

不，你不能，你必须取消引用它：

```
SetOponent( * Class ) 
```

至于复制行为，我建议您阅读一本关于 C++ 的好书，例如 Scott Meyers 的《Effective C++》。auto_ptr 的复制行为非常不直观，可能超出了 SO 答案的范围。然而，什么都不敢冒险……

当一个 auto_ptr 被复制时，所有权从原件转移到副本。例如：

```
auto_ptr <Foo> p1( new Foo ); 
```

此时 p1 拥有指向 Foo 对象的指针。

```
auto_ptr <Foo> p2( p1 ); 
```

复制后，p2 拥有指针，**p1 被更改**，因此它现在拥有一个 NULL 指针。这很重要，因为在 C++ 中的很多地方都发生了复制。例如，您不应该将 auto_ptrs 按值传递给函数，或尝试将它们存储在标准库容器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:10:01.970

奇怪的复制行为是您无法复制并仍然拥有原件。为此使用`shared_ptr`(在 boost:: 或 std::tr1::) 中。这意味着您不能拥有 的 STL 容器`auto_ptrs`等。 `auto_ptr<>`当您将拥有一个对象的一个​​副本且生命周期有限时，这非常有用。如果您复制到另一个`auto_ptr<>`，您将丢失第一个。如果你传递了指针，你就有很大的机会尝试使用一个已经被删除的对象。

您可以根据需要调用`SetOponent(*Class);`，因为这将传递实际项目（您将对象而不是指针传递给引用）。如果传递给指针，则可以调用 with `SetOpponent(Class.get())`。当 Class 超出范围时，您仍然会遇到 MyClass 将被删除的问题。

# sql-server - NHibernate 加入子类

> ID：802785
> 
> 赞同：3
> 
> 时间：2009-04-29T15:02:22.877
> 
> 标签：sql-server, nhibernate, inheritance, nhibernate-mapping

我正在尝试使用 NHibernate 和 SQL 服务器实现类继承层次结构。我使它适用于每个层次结构策略的表（映射文件中的一个表和几个子类元素）。

但是，每个子类的表策略（一个映射文件中的 N + 1 个表和 N 个连接子类元素）在我的情况下更有意义，因为我想对子类表施加一些约束。我正在为应该在主类表（Persons）和子类表（ContactPersons）上放置什么样的 PK/FK 关联而苦苦挣扎。根据 NHibernate 文档，表之间应该有一个主键关联。我试图将 FK 约束从子类 PK 放到主类 PK，但它仍然不起作用。我得到以下异常：

NHibernate.Exceptions.GenericADOException: 无法插入：[Jobflow.Models.Entities.ContactPerson][SQL: INSERT INTO ContactPersons (Email, Company, PersonID) VALUES (?, ?, ?)] ---> System.Data.SqlClient .SqlException：当 IDENTITY_INSERT 设置为 OFF 时，无法在表“ContactPersons”中插入标识列的显式值。

我确实尝试将 IDENTITY_INSERT 设置为 ON 但这似乎没有帮助......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T15:06:58.373

您需要将 Persons 中的列声明为 int 标识，但在 ContactPersons 中声明为 int - 只有一个表需要跟踪标识值。您的外键/主键很好，这是您需要解决的唯一问题。

NHibernate 将插入 Persons，使用 SCOPE_IDENTITY() 获取新的身份值，然后显式使用该值插入 ContactPersons。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:07:38.340

我正在使用 NH 的 SchemaExport 创建模式。它在子类主键上创建一个外键：

```
alter table ContactPersons 
add constraint FK81E543E94B3FF9C3 
foreign key (Persons_FK) 
references Persons 
```

Persons_FK 在映射文件中声明

```
<joined-subclass name="ContactPersons">
  <key column="Persons_FK"/>
  ... 
```

# web-services - 测试 Web 服务的工具

> ID：802786
> 
> 赞同：1
> 
> 时间：2009-04-29T15:02:24.860
> 
> 标签：web-services

我正在寻找一种工具来测试我所有的网络服务，无论它们是启动还是关闭。有时你运行你的应用程序，你会得到异常。稍后您通过查看日志文件发现 abc 或 def webservice 已关闭。因此，我想事先运行该工具，以了解我的应用程序使用的所有 Web 服务是启动还是关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:06:17.940

最好有一个像 Nagios 这样的自动化工具来检查您的主机、Web 服务器、Web 服务、网站等是否已启动并运行，并在它们未启动时向您发送电子邮件。它还可以检查您的日志文件中是否存在严重错误，并将它们通过电子邮件发送给您，这样您就不必担心，直到发生不好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T11:59:38.847

您可以尝试[Jmeter ，它比](http://jmeter.apache.org/)[SoapUI](http://www.soapui.org/)更复杂，并且可以轻松使用[Rest](http://en.wikipedia.org/wiki/Representational_state_transfer)服务。

# c# - 在父对象中对列表进行排序的扩展方法

> ID：802789
> 
> 赞同：1
> 
> 时间：2009-04-29T15:03:16.060
> 
> 标签：c#, list, sorting

```
public class Person
{
    public string name { get; set; }
    public Email email { get; set; }

}

public class Email
{
    public string desc { get; set; }
}

public static IEnumerable<T> Sort<T>(this IEnumerable<T> source, string sortExpression, bool desc)
{            
    var param = Expression.Parameter(typeof(T), string.Empty);
    try
    {
        var property   = Expression.Property(param, sortExpression);
        var sortLambda = Expression.Lambda<Func<T, object>>(Expression.Convert(property, typeof(object)), param);

        if (desc)
        {
            return source.AsQueryable<T>().OrderByDescending<T, object>(sortLambda);
        }

        return source.AsQueryable<T>().OrderBy<T, object>(sortLambda);
    }
    catch (ArgumentException)
    {
        return source;
    }
}

        List<Person> vet = new List<Person>();

        Person p = new Person { name = "aaa", email = new Email { desc = "bbb@aaa.com" } };
        Person pp = new Person { name = "bbb", email = new Email { desc = "aaa@aaa.com" } };
        vet.Add(p);
        vet.Add(pp);

        vet.Sort("name",true); //works
        vet.Sort("email.desc",true) // doesnt work 
```

* * *

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:07:11.930

您可能需要考虑另一种方法，该方法采用自定义的 Comparer 对象进行比较。然后，您可以为 Person 编写一个自定义的比较器，根据他们的电子邮件地址进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:16:47.617

如果您想要此功能，请查看 ScottGu 关于[Dynamic Linq Library](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)的文章。我相信它会做你想要的。

虽然 Lambda 是类型安全的，但有时您可能希望动态生成查询，而不是拥有用户可以排序的所有可能组合。

**编辑**

我修正了你的方法。基本上，您需要为每个成员访问创建一个表达式。

```
 public static IEnumerable<T> Sort<T>(this IEnumerable<T> source, string sortExpression, bool desc)
    {
        var param = Expression.Parameter(typeof(T), string.Empty);
        try
        {
            var fields = sortExpression.Split('.');
            Expression property = null;
            Expression parentParam = param;
            foreach (var field in fields)
            {
                property = Expression.Property(parentParam, field);
                parentParam = property;

            }

            var sortLambda = 
                Expression.Lambda<Func<T, object>>(
                  Expression.Convert(property, typeof(object)), param);

            if (desc)
            {
                return source.AsQueryable<T>().
                     OrderByDescending<T, object>(sortLambda);
            }

            return source.AsQueryable<T>().
                 OrderBy<T, object>(sortLambda);
        }
        catch (ArgumentException)
        {
            throw;
        }
    } 
```

# sql - 使用 SQL 查询检查序列

> ID：802802
> 
> 赞同：2
> 
> 时间：2009-04-29T15:06:01.793
> 
> 标签：sql, sql-server, ms-access, sequence

我有一张桌子，可以保存我们所有商店的所有订单。我写了一个查询来检查每个商店的顺序订单。看起来是这样的。

```
select WebStoreID, min(webordernumber), max(webordernumber), count(webordernumber) 
from orders
where ordertype = 'WEB' 
group by WebStoreID 
```

我可以通过此查询检查所有订单是否存在。网络订单号是 1...n 中的数字。

如何在不加入临时/不同表的情况下编写查询以查找丢失的订单？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T15:22:55.513

您可以自行加入表以检测没有前一行的行：

```
select cur.*
from orders cur
left join orders prev 
    on cur.webordernumber = prev.webordernumber + 1
    and cur.webstoreid = prev.webstoreid
where cur.webordernumber <> 1
and prev.webordernumer is null 
```

这将检测 1...n 序列中的间隙，但不会检测到重复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T15:17:30.830

我会制作一个“从 1 到 n 的所有整数”的辅助表（有关使用 SQL Server 函数制作它的一些方法，请参见[http://www.sql-server-helper.com/functions/integer-table.aspx](http://www.sql-server-helper.com/functions/integer-table.aspx) ，但是因为它是你一遍又一遍需要的东西，无论如何我都会把它变成一个真正的表，并且使用任何 SQL 引擎很容易做到这一点，只需一次）然后使用嵌套查询，`SELECT value FROM integers WHERE value NOT IN (SELECT webordernumber FROM orders)`&c。另请参阅[http://www.sqlmag.com/Article/ArticleID/99797/sql_server_99797.html](http://www.sqlmag.com/Article/ArticleID/99797/sql_server_99797.html)以了解与您类似的问题，“检测数字序列中的间隙”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-19T13:00:09.247

如果你有 rank() 函数但没有 lag() 函数（换句话说，SQL Server），你可以使用它（由[http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server建议-programming/10594/Return-gaps-in-a-sequence](http://www.sqlmonster.com/Uwe/Forum.aspx/sql-server-programming/10594/Return-gaps-in-a-sequence)）：

```
create table test_gaps_in_sequence (x int)
insert into test_gaps_in_sequence values ( 1 )
insert into test_gaps_in_sequence values ( 2 )
insert into test_gaps_in_sequence values ( 4 )
insert into test_gaps_in_sequence values ( 5 )
insert into test_gaps_in_sequence values ( 8 )
insert into test_gaps_in_sequence values ( 9 )
insert into test_gaps_in_sequence values ( 12)
insert into test_gaps_in_sequence values ( 13)
insert into test_gaps_in_sequence values ( 14)
insert into test_gaps_in_sequence values ( 29) 
```

...

```
 select lower_bound
         , upper_bound
      from (select upper_bound
                 , rank () over (order by upper_bound) - 1 as upper_rank
              from (SELECT x+n as upper_bound
                      from test_gaps_in_sequence
                         , (SELECT 0 n
                            UNION
                            SELECT -1
                           ) T
                     GROUP BY x+n
                    HAVING MAX(n) = -1
                    ) upper_1
            ) upper_2
         , (select lower_bound
                 , rank () over (order by lower_bound) as lower_rank
              from (SELECT x+n as lower_bound
                      from test_gaps_in_sequence
                         , (SELECT 0 n
                            UNION
                            SELECT 1
                           ) T
                     GROUP BY x+n
                    HAVING MIN(n) = 1
                    ) lower_1
            ) lower_2
      where upper_2.upper_rank = lower_2.lower_rank
      order by lower_bound 
```

...或者，包括“外部限制”：

```
select lower_bound
     , upper_bound
  from (select upper_bound
             , rank () over (order by upper_bound) - 1 as upper_rank
          from (SELECT x+n as upper_bound
                  from test_gaps_in_sequence
                     , (SELECT 0 n
                        UNION
                        SELECT -1
                       ) T
                 GROUP BY x+n
                HAVING MAX(n) = -1
                ) upper_1
        ) upper_2
   full join (select lower_bound
             , rank () over (order by lower_bound) as lower_rank
          from (SELECT x+n as lower_bound
                  from test_gaps_in_sequence
                     , (SELECT 0 n
                        UNION
                        SELECT 1
                       ) T
                 GROUP BY x+n
                HAVING MIN(n) = 1
                ) lower_1
        ) lower_2
   on upper_2.upper_rank  = lower_2.lower_rank
     order by coalesce (lower_bound, upper_bound) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T15:17:48.987

**如果**您的数据库支持分析函数，那么您可以使用如下查询：

```
select prev+1, curr-1 from
( select webordernumber curr,
         coalesce (lag(webordernumber) over (order by webordernumber), 0) prev
  from   orders
)
where prev != curr-1; 
```

输出将显示差距，例如

```
prev+1 curr-1
------ ------
     3      7 
```

意味着缺少 3 到 7 的数字。

# python - Python - 无论try/except块都可能强制引发异常吗？

> ID：802804
> 
> 赞同：5
> 
> 时间：2009-04-29T15:06:40.950
> 
> 标签：python, exception

在 Python 中，是否有任何语言（或解释器）功能强制 Python 解释器始终引发异常，即使异常违规代码位于 try/except 块内？

我刚刚继承了一个用 python 编写的更大和更旧的代码库，其目的是与我们也开发的一些定制设计的硬件进行通信。由于以下（简化的）代码模式，许多通信错误和超时被屏蔽/遗漏：

```
try:
    serialport.write(MSG)
except:
    some_logging_function_mostly_not_working_that_might_be_here_or_not()
    #or just:
    #pass 
```

为了避免“从头开始重写整个事情”的典型场景，我目前正在尝试修复所有异常错误/超时。我通过手动禁用所有异常处理代码来做到这一点，一次一个。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-29T15:12:16.660

“所有异常”`except:`块是一件非常糟糕的事情，必须简单地找到并替换为合理的除外处理。

在这种情况下`grep`是你的朋友。一个好的 IDE 可以帮助处理这些令人不快的琐事。

但是 Python 中没有“忽略编写的代码”选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T15:15:44.563

不，不是。您最好的选择是将代码更改为更像这样的内容：

```
try:
    serialport.write(MSG)
except:
    some_logging_function_mostly_not_working_that_might_be_here_or_not()
    raise 
```

这将使它重新引发确切的异常。您需要了解的主要内容是，如果有办法让所有异常退出系统，您将无法使用 for 循环（迭代器引发 StopIteration 异常）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-20T13:24:52.687

我猜你想忽略，除非你在调试和应用它。

一种好方法是让一个全局变量说 debug=True 并有条件地调用 raise：

```
debug=True

def foo:
   try:
       # do some code
   except:
       if debug: raise #put this in all excepts 
```

现在将 debug 设置为 False 每当 raise 被静音时

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-29T15:10:59.300

您可以使用多个异常处理程序来处理多个异常。

```
try:
    serialport.write(MSG)
except Handler1:
    some_logging_function_mostly_not_working_that_might_be_here_or_not()
    #or just:
    #pass
except Handler2:
    some_logging_function_mostly_not_working_that_might_be_here_or_not2()
    #or just:
    #pass 
```

# wpf - 如何让 ScrollViewer 在 StackPanel 中工作？

> ID：802821
> 
> 赞同：75
> 
> 时间：2009-04-29T15:10:20.800
> 
> 标签：wpf, xaml, scrollviewer, stackpanel

在以下 WPF XAML 中，ScrollViewer 不起作用（它显示滚动条，但您无法滚动，并且内容从窗口移到底部）。

我可以将外部 StackPanel 更改为 Grid，它会起作用。

但是，在我复制以下代码的应用程序中，我需要有一个外部 StackPanel。**我必须对 StackPanel 做什么才能使 ScrollViewer 显示可用的滚动条？**例如 VerticalAlignment="Stretch" Height="Auto" 不起作用。

```
 <StackPanel>
        <ScrollViewer>
            <StackPanel>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
            </StackPanel>
        </ScrollViewer>
 </StackPanel> 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2010-07-08T10:53:07.037

这也困扰了我一段时间，诀窍是将您的堆栈面板放在滚动查看器中。

此外，您需要确保将滚动查看器的 CanContentScroll 属性设置为 True，这是一个示例：

```
 <ScrollViewer Grid.Row="1" Margin="299,12,34,54" Name="ScrollViewer1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Height="195" CanContentScroll="True">
        <StackPanel Name="StackPanel1" OverridesDefaultStyle="False"  Height="193" Width="376" VerticalAlignment="Top" HorizontalAlignment="Left"></StackPanel>
  </ScrollViewer> 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-04-29T15:13:48.700

你不能不固定`StackPanel`. 它旨在无限期地向一个方向增长。我建议使用不同的`Panel`. 为什么你“需要”有一个外层`StackPanel`？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-09-16T07:56:56.357

请注意，有时您可能在没有意识到的情况下拥有 StackPanel。就我而言，我有这个代码

```
<ScrollViewer>
  <ItemsControl ItemsSource="{Binding Pages}"/>
</ScrollViewer> 
```

效果很好。绑定引用的“页面”确实不同，复杂的用户控件，我希望其中一些只有滚动条。所以我删除了滚动查看器：

```
 <ItemsControl ItemsSource="{Binding Pages}"/> 
```

然后我把 ScrollViewer 作为我想要的那些用户控件的顶部元素。然而，这并没有奏效。内容刚刚从页面流出。起初我不认为这个问题/答案可以帮助我，但我意识到 ItemsControl 的默认 ItemPanel 是 StackPanel。所以我通过指定一个不是 StackPanel 的 ItemsPanel 解决了我的问题：

```
<ItemsControl ItemsSource="{Binding Pages}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Grid/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-13T09:50:29.270

事实上，我解决这个问题的方法是移除外部堆栈面板，而是将滚动查看器设置在我想要在主网格内的位置。

```
 <Grid Style="{StaticResource LayoutRootStyle}">
    <Grid.RowDefinitions>
        <RowDefinition Height="160"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>        

    <!-- Vertical scrolling grid used in most view states -->    

        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto">
            <StackPanel Orientation="Horizontal">
                <GridView>
                ...
                </GridView>
            </StackPanel>
        </ScrollViewer> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-09T13:16:01.263

这是它的工作原理：

```
<Window x:Class="TabControl.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"        
    xmlns:local="clr-namespace:TabControl"
    Title="MainWindow"    Height="300"   
    DataContext="{Binding RelativeSource={RelativeSource Self}}"         
    >    
<StackPanel>
    <ScrollViewer Height="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type Border}},Path=ActualHeight}" >
        <StackPanel >
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
            <TextBlock Text="This is a test"/>                <TextBlock Text="This is a test"/>
        </StackPanel>
    </ScrollViewer>
</StackPanel> 
```

**通过将 ScrollViewer 的高度绑定到窗口的内部高度。**

调整大小的逻辑是我们需要给任何元素固定高度或设计视图以使用渲染高度。

**输出：**

[![Stackpanel 中的滚动条](https://i.stack.imgur.com/3KhwZ.jpg)](https://i.stack.imgur.com/3KhwZ.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-22T03:00:43.507

如果您的堆栈面板位于网格内，我会这样做：

```
<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
    <StackPanel MaxHeight="{Binding Path=Height,RelativeSource={RelativeSource 
              AncestorType=Grid}}">
    </StackPanel>
</ScrollViewer> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-11T08:43:48.433

将 Grid.Row="1" 从 StackPanel 移动到 ScrollViewer 完全为我解决了这个问题。

我有一个长长的列表，其中包含大约 40 个项目要在 StackPanel 中显示，但只有前 20 个显示。

```
 <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
        <StackPanel x:Name="ContentPanel" Margin="12,0,12,0">
        <TextBlock Text="{Binding Line1}" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        <TextBlock Text="" Margin="10,-2,10,0" Style="{StaticResource PhoneTextNormalStyle}" />
        ...
        </StackPanel>
    </ScrollViewer> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-19T16:06:12.537

```
<WrapPanel Orientation="Vertical">
        <ScrollViewer>
            <WrapPanel Orientation="Vertical">
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
                <TextBlock Text="This is a test"/>
            </WrapPanel>
        </ScrollViewer>
    </WrapPanel> 
```

# azure - 在云中部署非基于 http 的服务

> ID：802824
> 
> 赞同：2
> 
> 时间：2009-04-29T15:12:08.237
> 
> 标签：azure, cloud

是否可以在不使用标准http协议提供服务的云中部署服务？基本上我需要编写不使用http在客户端/服务器之间交换消息的服务。它是传统的客户端服务器应用程序，它使用非标准协议运行在端口 80 以外的端口上。我们可以在云中部署这种应用程序吗？

这种服务的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T15:22:16.683

当然，只要没有防火墙阻碍“云”本身就不需要端口 80，也不需要 HTTP。例如，部署 DNS 服务（通过端口 53 上的 UDP 或 TCP）是很常见的。您需要做的就是与您的“云供应商”核实可以使用哪些端口范围（通过移除任何可能阻碍的防火墙）；不同的供应商会有不同的政策。

顺便说一句，这并不是真正的编程问题：严格来说是系统/网络管理问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:19:18.860

XML-RPC 可能是您正在寻找的。

# java - 让 Eclipse equals() / hashCode() 使用 getter

> ID：802825
> 
> 赞同：7
> 
> 时间：2009-04-29T15:12:08.330
> 
> 标签：java, eclipse, hibernate

是否可以使默认的 Eclipse“生成 hashCode() 和 equals()”使用 getter 而不是字段引用？- IE。我可以得到它使用的模板吗？

我正在使用 Hibernate，并且代理对象仅在使用 getter 时才被延迟加载，而不是来自字段引用。不断地改变它是一件烦人的事。

显而易见的解决方法是自己创建一个模板或编写一个插件——这感觉有点矫枉过正。

编辑：看起来这些是不可配置的。我将把这个问题作为 JBoss Tools Group 的一个问题（他们为 Hibernate 制作了一些插件）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T16:17:52.943

这不是解决方案，而是解决方法 - 但您可以尝试 generate `equals()`，然后使用“封装字段”重构来替换所有字段访问以使用 getter/setter（它也适用于类内部）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T15:48:40.437

[哦，小心代理： http](http://blog.xebia.com/2008/03/08/advanced-hibernate-proxy-pitfalls/) ://blog.xebia.com/2008/03/08/advanced-hibernate-proxy-pitfalls/ ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T20:49:20.837

我使用[插件](http://commonclipse.sourceforge.net/index.html)生成`hashCode()`并`equals()`使用[apache commons lang](http://commons.apache.org/lang/)

# c# - 为什么 C# 使用不同的命名约定？

> ID：802836
> 
> 赞同：6
> 
> 时间：2009-04-29T15:15:29.790
> 
> 标签：c#, naming-conventions, uml, conventions

我最近开始使用 C#，我注意到约定似乎是变量以大写字母开头以及方法。

这是唯一这样做的语言吗？为什么？例如：

```
Page Page = new Page();
Page.Action(); 
```

在其他语言中，您会看到：

```
Page page = new Page();
page.action(); 
```

由于我使用 UML、Ruby、C++ 和 Java 进行了大量工作，因此还有其他一些令人困惑的示例。

我的问题是，当其他语言没有时，为什么 C# 会这样做？

### 编辑

> 其他 Stack Overflow 用户注意到 C# 不遵循此约定，这只是我的一个错误。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-29T15:18:10.267

实际上，不：C# 中的约定是针对 camelCased 变量（和字段）名称和 PascalCase 方法：

```
Page page = new Page();
page.Action(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-29T15:19:38.110

不，这是相当非标准的 C# 代码。第 2.6 节中的 .Net Framework 设计指南建议对局部变量名使用驼峰式大小写。

*   [http://blogs.msdn.com/brada/articles/361363.aspx](http://blogs.msdn.com/brada/articles/361363.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-29T15:20:07.063

公共成员使用`PascalCase`，私人成员使用`camelCase`。

我认为这使得哪些方法支持一个类与哪些方法定义一个类更清楚。

```
public class Foo
{
    private Bar bar;
    public Bar Bar { get; set; }

    public void DoFoo()
    {
        makeFoo();
    }

    private void makeFoo()
    {
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T15:18:50.733

我编写或使用的每组 C# 约定都会为变量指定驼峰式大小写，因此：

```
Page page = new Page();
MyClass myClass = new MyClass(); 
```

不确定您在哪里看到使用 Pascal 大小写，但它肯定不是 C# 固有的或标准的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-29T15:19:09.267

C# 中的变量通常不以大写字母开头（尽管这显然取决于开发人员自己的实现）。您可能对[Property](http://msdn.microsoft.com/en-us/library/bzwdh01d(VS.71).aspx#cpconpropertyusageguidelinesanchor1)的概念感到困惑。C# 中的属性在语法上与变量一样使用（因为它们可以被检索或分配，而不仅仅是像函数一样执行），但可以封装两种操作的业务逻辑。

但是，要回答您问题的更广泛部分，根据[Microsoft 指南](http://msdn.microsoft.com/en-us/library/xzf533w0(VS.71).aspx)，属性和方法/函数通常都以大写字母开头。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-29T15:21:09.650

PascalCase 早在 .NET 之前就已成为 Microsoft 的惯例。（在 Win32 API 等中）

在单个环境中使用约定也很有意义。.NET 本身就是一个综合环境，而微软公司又是另一个，采用其他人的环境确实没有意义。

此外，我强烈怀疑 UML 有命名约定，或者甚至 UML 有命名约定的想法是否有意义。UML 为您的软件建模，并且应该遵循该软件的约定。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-29T15:23:17.180

Public = PascalCase，我只倾向于将 camelCase 用于私有字段和参数参数。

阅读这个[编码标准，虽然](http://www.tiobe.com/content/paperinfo/gemrcsharpcs.pdf)很容易在谷歌上搜索，但不是一个糟糕的起点。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T15:25:07.410

通过使用以下两个工具，您可以找到很多关于应采用哪些约定的信息。

FxCop： http: [//msdn.microsoft.com/en-us/library/bb429476 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/bb429476(VS.80).aspx)

StyleCop：[http ://code.msdn.microsoft.com/sourceanalysis](http://code.msdn.microsoft.com/sourceanalysis)

# html - 锚链接内的按钮在 Firefox 中有效，但在 Internet Explorer 中无效？

> ID：802839
> 
> 赞同：72
> 
> 时间：2009-04-29T15:15:59.180
> 
> 标签：html, internet-explorer, firefox, button, cross-browser

除了我的链接之外，我网站中的所有其他内容似乎都与所有浏览器兼容。它们出现在页面上，但不起作用。我的链接代码如下 -

```
<td bgcolor="#ffffff" height="370" valign="top" width="165">
    <p>
        <a href="sc3.html">
            <button style="width:120;height:25">Super Chem #3</button>
        </a> 
        <a href="91hollywood.html">
            <button style="width:120;height:25">91 Hollywood</button>
        </a> 
        <a href="sbubba.html">
            <button style="width:120;height:25">Super Bubba</button>
        </a> 
        <a href="afgoohash.html">
            <button style="width:120;height:25">Afgoo Hash</button>
        </a> 
        <a href="superjack.html">
            <button style="width:120;height:25">Super Jack</button>
        </a> 
        <a href="sog.html">
            <button style="width:120;height:25">Sugar OG</button>
        </a> 
        <a href="91pk91.html">
            <button style="width:120;height:25">91 x PK</button>
        </a> 
        <a href="jedi1.html">
            <button style="width:120;height:25">Jedi</button>
        </a>
    </p>
    <p>&nbsp;</p>
    <a href="http://indynile99.blogspot.com">
        <button style="width:120;height:25">Blog</button>
    </a>
    <p>&nbsp;</p>
</td> 
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-04-29T15:22:52.860

你不能有一个`<button>`内部`<a>`元素。正如[W3](https://www.w3.org/TR/2011/WD-html5-20110525/text-level-semantics.html#the-a-element)对`<a>`元素的内容模型描述所述：

> “必须没有交互式内容后代。”

（a[`<button>`](https://www.w3.org/TR/2011/WD-html5-20110525/the-button-element.html#the-button-element)被认为是[交互式内容](https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#interactive-content)）

为了获得您正在寻找的效果，您可以放弃`<a>`标签并为每个按钮添加一个简单的事件处理程序，将浏览器导航到所需位置，例如

```
<input type="button" value="stackoverflow.com" onClick="javascript:location.href = 'http://stackoverflow.com';" /> 
```

但是，请考虑**不**要这样做；常规链接可以正常工作是有原因的：

*   用户可以立即识别链接并了解他们导航到其他页面
*   搜索引擎可以将它们识别为链接并关注它们
*   屏幕阅读器可以将它们识别为链接并适当地建议用户

您还添加了一个完全不必要的要求，即启用 JavaScript 只是为了执行基本导航；这是网络的一个基本方面，我认为这种依赖是不可接受的。

如果需要，您可以使用背景图像或背景颜色、边框和其他技术来设置链接的样式，使它们**看起来**像按钮，但实际上它们应该是普通链接。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-10-28T06:06:51.290

请注意：
W3C 对链接标签内的按钮没有问题，因此它只是另一个 MS 子标准。

**答案**：
使用代理按钮，除非您想获得完整的图像。

代理按钮可以放入标签中（如果您使用跨度而不是 div，则更安全）。

它可以被设计成看起来像按钮或其他任何东西。

它是通用的——一段 css 代码为所有实例提供动力——只需定义一次 CSS，然后在任何需要的地方复制和粘贴 html 实例。

每个按钮都可以有自己的标签 - 非常适合多语言页面（我认为更容易为每种语言制作图片） - 还可以更轻松地在整个脚本中传播实例。

将其宽度调整为标签长度 - 如果您想要的话，也可以采用固定宽度。
IE7 是上面的一个例外 - 它必须有宽度，或者会使这个按钮从一个边缘到另一个边缘 - 或者给它宽度，你可以让按钮向左浮动
- IE7 的 css：
一个。.宽度：150像素；（注意属性前的点，我通常通过添加这样的点来定位 IE7 - 删除点和属性将被所有浏览器读取）
b。文本对齐：居中；- 如果你有固定的宽度，你必须让这个居中文本/标签
c。光标：指针；- 所有 IE 都必须有这个才能正确显示链接指针 - 好的浏览器不需要它

你可以继续使用这段代码并使用 CSS3 来设置它的样式，而不是使用图像
：圆角的半径（限制：IE 将显示为正方形）
b。渐变使其“像按钮一样”（限制：Opera 不支持渐变，因此请记住为该浏览器设置标准背景颜色）
C。使用 :hover pclass 根据鼠标指针位置等更改按钮状态 - 您可以将其仅应用于文本标签或整个按钮

## **下面的CSS代码**：

```
.button_surrogate span { margin:0; display:block; height:25px; text-align:center; cursor:pointer; .width:150px; background:url(left_button_edge.png) left top no-repeat; }

.button_surrogate span span { display:block; padding:0 14px; height:25px; background:url(right_button_edge.png) right top no-repeat; }

.button_surrogate span span span { display:block; overflow:hidden; padding:5px 0 0 0; background:url(button_connector.png) left top repeat-x; } 
```

**下面的 HTML 代码（按钮实例）**：

```
<a href="#">
  <span class="button_surrogate">
     <span><span><span>YOUR_BUTTON_LABEL</span></span></span>
  </span>
</a> 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-11-17T12:50:58.090

```
$("a > button").live('click', function() { 
    location.href = $(this).closest("a").attr("href");
}); // fixed 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-07-07T23:32:38.220

下面的代码在所有浏览器中都可以正常工作：

```
<button onClick="location.href = 'http://www.google.com'">Go to Google</button> 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-29T15:17:19.753

`a`标签内不能有按钮。但是，您可以执行一些 javascript 来使其正常工作。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-10-25T19:18:52.863

如果您使用的是 Twitter bootstrap 之类的框架，您可以简单地将类“btn”添加到 a 标签——我刚刚接到一个用户关于这个问题的电话，显然我的结帐按钮不起作用，因为我在 a 中有一个按钮标记...相反，我只是向其中添加了 btn 类，它现在可以正常工作了。大错误，可能会让客户付出代价-有时我忘记对 IE 中的所有内容进行代码检查...

例如 `<a href="link.com" class="btn" >Checkout</a>`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-11-28T20:52:42.683

由于这只是 IE 中的一个问题，为了解决这个问题，我首先检测浏览器是否为 IE，如果是，则使用 jquery click 事件。我将此代码放入一个全局文件中，以便在整个站点中对其进行修复。

```
if (navigator.appName === 'Microsoft Internet Explorer')
{
    $('a input.button').click(function()
    {
        window.location = $(this).closest('a').attr('href');
    });
} 
```

这样，我们只需将点击事件分配给 IE 的链接输入按钮的开销。注意：上面的代码在一个文档就绪函数中，以确保在分配点击事件之前页面已完全加载。

我还为我的输入按钮分配了类名，以节省使用 IE 时的一些开销，以便我可以搜索

```
$('a input.button') 
```

代替

```
$('a input[type=button]') 
```

.

```
<a href="some_link"><input type="button" class="button" value="some value" /></a> 
```

最重要的是，当鼠标悬停在按钮上时，我还利用 CSS 使按钮看起来可点击：

```
input.button {cursor: pointer} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-03-01T15:22:31.930

我发现这对我有用

```
<input type="button" value="click me" onclick="window.open('http://someurl', 'targetname');"> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-10T05:52:04.807

`<form:form method="GET" action="home.do"> <input id="Back" class="sub_but" type="submit" value="Back" /> </form:form>`

这很好用，我在 IE9 上测试过。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-16T05:52:58.597

这里的问题是链接位于按钮后面，即使在更改 z-index 时也是如此。此标记也是无效[的（阅读规范](http://dev.w3.org/html5/markup/button.button.html#button.button)）。所以链接不起作用的原因是因为您实际上是单击按钮而不是链接。解决方案是更改您的标记。

```
<button type="button"><a href="yourlink">Link</a></button> 
```

然后根据需要设计样式。演示在[这里](http://codepen.io/lukeocom/pen/LpdKz)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-22T01:36:02.723

这实际上非常简单，不需要 javascript。

首先，将锚点放在按钮内

```
<button><a href="#">Bar</a></button> 
```

然后，把anchor标签变成块类型的元素，填充它的容器

```
button a {
  display:block;
  height:100%;
  width:100%;
} 
```

最后，根据需要添加其他样式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-06-09T10:17:11.600

只需将此 jquery 代码插入 HTML 的头部：

```
<!--[if lt IE 9 ]>
     <script>
        $(document).ready(function(){
            $('a > button').click(function(){
                window.location.href = $(this).parent().attr('href');
            });
        });
    </script>
<![endif]--> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-02-11T23:41:17.133

为什么不直接将所有转换`<button>`为`<span>`with`type="button"`然后使用您的普通 css 按钮类设置样式？刚刚确认这在 IE11 中有效。

# javascript - 为什么 document.write 被认为是“坏习惯”？

> ID：802854
> 
> 赞同：379
> 
> 时间：2009-04-29T15:18:16.507
> 
> 标签：javascript

我知道[`document.write`](https://developer.mozilla.org/en-US/docs/DOM/document.write)这被认为是不好的做法；我希望编制一份提交给第三方供应商的理由列表，说明他们为什么不应该`document.write`在他们的分析代码的实现中使用。

`document.write`请在下方注明您声称是不良做法的原因。

* * *

## 回答 #1

> 赞同：254
> 
> 时间：2009-04-29T15:36:54.293

几个比较严重的问题：

*   document.write（以下称为 DW）在 XHTML 中不起作用

*   ~~DW 不直接修改 DOM，防止进一步的操作~~ *（试图找到这方面的证据，但它充其量是情境）*

*   页面加载完成后执行的DW会覆盖页面，或者写一个新页面，或者不起作用

*   DW在遇到的地方执行：它不能在给定的节点点注入

*   DW 正在有效地编写序列化文本，这不是 DOM 在概念上的工作方式，并且是创建错误的简单方法（.innerHTML 有同样的问题）

[使用安全且对 DOM 友好的DOM 操作方法](https://developer.mozilla.org/en-US/docs/Web/API/Document)要好得多

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-04-29T15:26:28.077

`document.write`本身并没有什么问题。问题是它真的很容易被滥用。粗略地说，甚至。

就供应商提供分析代码（如 Google Analytics）而言，这实际上是他们分发此类代码段的最简单方法

1.  它使脚本保持小
2.  他们不必担心覆盖已经建立的加载事件或包括必要的抽象来安全地添加加载事件
3.  它非常兼容

***只要您在文件加载后不尝试使用它***`document.write`，在我看来，它本质上并不是邪恶的。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2011-07-14T17:19:05.133

**它可以阻止您的页面**

`document.write`仅在页面加载时有效；如果在页面加载完成后调用它，它将覆盖整个页面。

这实际上意味着您必须从内联脚本块中调用它 - 这将阻止浏览器处理随后的页面部分。在写入块完成之前，不会下载脚本和图像。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2011-09-08T20:49:48.170

另一个合法使用`document.write`来自 HTML5 Boilerplate [index.html](https://github.com/h5bp/html5-boilerplate/blob/master/src/index.html)示例。

```
<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.6.3.min.js"><\/script>')</script> 
```

我还看到了使用[json2.js](https://github.com/douglascrockford/JSON-js) JSON parse/stringify polyfill（[IE7 及以下版本需要](http://caniuse.com/#search=JSON)）的相同技术。

```
<script>window.JSON || document.write('<script src="json2.js"><\/script>')</script> 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2009-04-29T16:19:26.937

**临：**

*   这是从外部（到您的主机/域）脚本嵌入内联内容的最简单方法。
*   您可以覆盖框架/iframe 中的全部内容。在更现代的 Ajax 技术被广泛使用之前（1998-2002），我曾经经常将这种技术用于菜单/导航片段。

**缺点：**

*   它将渲染引擎序列化以暂停，直到加载所述外部脚本，这可能比内部脚本花费更长的时间。
*   它通常以将脚本放置在内容中的方式使用，这被认为是不良格式。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-10-13T13:23:21.227

这是我的两便士价值，一般来说你不应该用它来做`document.write`繁重的工作，但有一个例子绝对有用：

[http://www.quirksmode.org/blog/archives/2005/06/three_javascrip_1.html](http://www.quirksmode.org/blog/archives/2005/06/three_javascrip_1.html)

我最近在尝试创建 AJAX 滑块库时发现了这一点。我创建了两个嵌套的 div，并使用 JS将`width`/`height`和应用`overflow: hidden`到外部。`<div>`这样一来，在浏览器禁用 JS 的情况下，div 会浮动以容纳图库中的图像 - 一些不错的优雅降级。

问题是，与上面的文章一样，这种对 CSS 的 JS 劫持直到页面加载后才开始，在加载 div 时导致瞬间闪烁。所以我需要在页面加载时编写一个 CSS 规则，或者包含一个工作表。

显然，这在 XHTML 中不起作用，但由于 XHTML 似乎是一只死鸭子（并在 IE 中呈现为标签汤），因此可能值得重新评估您对 DOCTYPE 的选择......

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-29T15:29:36.433

它会覆盖页面上的内容，这是最明显的原因，但我不会称其为“坏”。

除非您使用 JavaScript 创建整个文档，否则它没有太多用处，在这种情况下，您可以从 document.write 开始。

即便如此，当您使用 document.write 时，您并没有真正利用 DOM ——您只是将一团文本转储到文档中，所以我会说这是一种糟糕的形式。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-04-29T15:31:55.273

在我的头顶上：

1.  `document.write`需要在页面加载或正文加载中使用。因此，如果您想在任何其他时间使用脚本来更新您的页面内容，document.write 几乎没有用处。

2.  从技术上讲`document.write`，只会更新 HTML 页面而不是 XHTML/XML。IE 似乎很宽容这个事实，但其他浏览器不会。

[http://www.w3.org/MarkUp/2004/xhtml-faq#docwrite](http://www.w3.org/MarkUp/2004/xhtml-faq#docwrite)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-04-29T15:44:53.477

它使用 XML 呈现（如 XHTML 页面）打破页面。

**最好**的：一些浏览器切换回 HTML 渲染，一切正常。

**可能**：某些浏览器在 XML 呈现模式下禁用了 document.write() 函数。

**最糟糕**的是：某些浏览器在使用 document.write() 函数时会触发 XML 错误。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-02-01T23:03:10.863

在某些情况下， Chrome 可能会阻止`document.write`插入脚本。发生这种情况时，它将在控制台中显示此警告：

> 通过 document.write 调用 Parser-blocking、跨域脚本 ...。如果设备的网络连接不佳，浏览器可能会阻止此操作。

### 参考：

*   [developer.google.com 上的这篇文章](https://developers.google.com/web/updates/2016/08/removing-document-write)更详细地介绍了这一点。
*   [https://www.chromestatus.com/feature/5718547946799104](https://www.chromestatus.com/feature/5718547946799104)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-02-22T08:58:33.510

根据 Google-Chrome Dev Tools 的[Lighthouse Audit](https://developers.google.com/web/tools/lighthouse/)所做的分析，

> 对于连接速度较慢的用户，通过动态注入的外部脚本`document.write()`会使页面加载延迟数十秒。

[![在此处输入图像描述](https://i.stack.imgur.com/OIwAV.png)](https://i.stack.imgur.com/OIwAV.png)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-11-20T01:19:57.017

# 浏览器违规

`.write`被认为是浏览器违规，因为它会阻止解析器呈现页面。解析器接收到文档正在被修改的消息；因此，它会被阻塞，直到 JS 完成它的进程。只有在这个时候解析器才会恢复。

## 表现

采用这种方法的最大后果是性能下降。浏览器将需要更长的时间来加载页面内容。对加载时间的不利反应取决于写入文档的内容。如果您向`<p>`DOM 添加标签，而不是向 JavaScript 库传递一个包含 50 个引用的数组（我在工作代码中看到并导致 11 秒延迟 -当然，这也取决于您的硬件）。

总而言之，如果你能提供帮助，最好避开这种方法。

有关更多信息，请参阅[针对 document.write() 进行干预](https://developers.google.com/web/updates/2016/08/removing-document-write)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-09-09T19:37:41.140

*   不好的做法的一个简单原因`document.write`是您无法想出一个找不到更好替代方案的场景。
*   另一个原因是您正在处理字符串而不是对象（它非常原始）。
*   它只附加到文档。
*   它没有例如[MVC（模型-视图-控制器）](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)模式的美妙之处。
*   [使用ajax+jQuery](https://jquery.com/)或[angularJS](https://angularjs.org/)呈现动态内容要强大得多。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-10-17T23:34:46.810

我认为使用 document.write 根本不是一个坏习惯。简而言之，对于没有经验的人来说，它就像一个高压。如果你用错了方法，你就会被煮熟。有许多开发人员至少使用过一次这种和其他危险的方法，但他们从未真正深入挖掘他们的失败。相反，当出现问题时，他们只是退出，并使用更安全的东西。那些对所谓的“不良做法”发表此类声明的人。

这就像格式化硬盘一样，当您只需要删除几个文件时，然后说“格式化驱动器是一种不好的做法”。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-02-12T17:48:23.760

可以将 document.write()（和 .innerHTML）视为评估源代码字符串。这对于许多应用程序来说非常方便。例如，如果您从某个来源获取 HTML 代码作为字符串，那么只需“评估”它就很方便。

在 Lisp 的上下文中，DOM 操作就像操作列表结构，例如，通过执行以下操作创建列表（橙色）：

```
(cons 'orange '()) 
```

document.write() 就像评估一个字符串，例如通过评估一个源代码字符串来创建一个列表，如下所示：

```
(eval-string "(cons 'orange '())") 
```

Lisp 还具有使用列表操作创建代码的非常有用的能力（例如使用“DOM 样式”创建 JS 解析树）。这意味着您可以使用“DOM 样式”而不是“字符串样式”来构建列表结构，然后运行该代码，例如：

```
(eval '(cons 'orange '())) 
```

如果您实现编码工具，例如简单的实时编辑器，那么能够快速评估字符串非常方便，例如使用 document.write() 或 .innerHTML。从这个意义上说，Lisp 是理想的，但你也可以在 JS 中做一些很酷的事情，而且很多人都在这样做，比如[http://jsbin.com/](http://jsbin.com/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-12-09T05:13:46.417

document.write 的缺点主要取决于这 3 个因素：

a) 实施

document.write() 主要用于在需要内容时将内容写入屏幕。这意味着它发生在任何地方，无论是在 JavaScript 文件中还是在 HTML 文件中的脚本标记内。由于脚本标签被放置在这样的 HTML 文件中的任何位置，因此在与网页中的 HTML 交织在一起的脚本块中包含 document.write() 语句是一个坏主意。

b) 渲染

设计良好的代码通常会获取任何动态生成的内容，将其存储在内存中，并在它通过代码时不断对其进行操作，然后最终将其吐出到屏幕上。因此，重申上一节的最后一点，就地渲染内容可能比可能依赖的其他内容渲染得更快，但它可能不适用于其他需要渲染内容以进行处理的代码。为了解决这个难题，我们需要摆脱 document.write() 并以正确的方式实现它。

c) 不可能的操纵

写完就完事了。如果不利用 DOM，我们就无法回去操作它。

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2009-04-29T15:31:14.620

我认为最大的问题是通过 document.write 编写的任何元素都会添加到页面元素的末尾。这很少是现代页面布局和 AJAX 所期望的效果。（您必须记住，DOM 中的元素是临时的，脚本运行的时间可能会影响其行为）。

最好在页面上设置一个占位符元素，然后操作它的innerHTML。

# iphone - iPhone 和加密库

> ID：802879
> 
> 赞同：9
> 
> 时间：2009-04-29T15:23:21.017
> 
> 标签：iphone, objective-c, security, encryption, hash

我想我将不得不在我的 iPhone 应用程序中使用 Crypto 库。我想问您有关 Apple 应用的加密货币出口政策的影响。我是否需要做一些额外的事情（例如填写表格等）

1）如果我使用 MD5 散列。

2）如果我使用对称加密。

谢谢，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-30T14:18:29.340

**编辑**

2009 年 12 月，在写完这个答案后，EAR 被修改了。从那时起，我就没有参加过出口合规评估。我对相关文件的粗略阅读表明，过去的“辅助计算”豁免现在更窄了，但在 ERN 的要求中仍有一些豁免。有关 iTunesConnect 上常见问题解答的位置，请参阅 @JosephH 的回答。最重要的是阅读BIS 的[使用加密的项目的 EAR 控件](http://www.bis.doc.gov/encryption/default.htm)常见问题解答，以了解“分类为 EAR 第 2 部分第 5 类”的短语。

在 2009 年 12 月之后，下面的答案可能不再提供信息。

* * *

*我不是律师，也不是全职处理出口合规问题，但我不得不广泛处理这些问题，并且可以为您指出原始材料，以便您自己查看。如果您有疑虑，您应该联系熟悉出口合规部的律师。*

美国出口限制与出口商有关，与作者无关。在这种情况下，Apple 是出口商，这就是为什么他们希望作者向他们提供有关他们正在出口的信息的原因。

如果您使用的是系统库，那么您和 Apple 在下载您的应用程序时都不会导出密码学。系统库是在 iPhone 本身出售或 Apple 提供软件更新时导出的。那与你无关。

您正在讨论的课程的密码学仅在出口到国家组 E:1 国家（古巴、伊朗、利比亚、朝鲜、叙利亚和苏丹）时受到限制。这些国家/地区被 Apple 排除在外。

如果您的产品属于“辅助密码学”类别，则您明确免于审查。这被定义为“主要对计算（包括‘数字计算机’的操作）、通信、网络（包括操作、管理、管理和供应）或‘信息安全’有用”，并包括以下示例：

*   软件、音乐等的盗版和防盗
*   游戏和游戏
*   家庭公用事业和电器
*   打印、复制、成像和视频录制或回放
*   业务流程建模和自动化（例如，供应链管理、库存、调度和交付）
*   工业、制造或机械系统（例如机器人、重型设备、火灾报警器、HVAC 等设施系统）
*   汽车、航空和其他交通系统

“辅助密码学”在这里可能被解读为“您的程序使用了密码学，但加密不是它的重点。” 美国出口法规对可以重新用于可能用于对抗美国政府的新产品的技术感兴趣。

开源密码库有广泛的豁免，只要它们不是故意出口到 E:1 类国家。

这是一种非常冗长（尽管仍然非常粗略）的说法，即“不用担心；单击 Apple 提供的适用选项”。

有关完整的血腥细节，请访问美国 BIS 的[商业加密出口管制](http://www.bis.doc.gov/encryption/default.htm)网站。特别感兴趣的是[加密检查表说明](http://www.bis.doc.gov/encryption/checklistinstr.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-30T17:10:26.093

Apple 在 iTunes Connect 中有很多关于此的信息，这似乎与 Rob Napier 的答案直接冲突，而普遍接受的答案似乎是，如果您使用标准密码学，则需要申请 ERN，如果您使用 CCATS正在使用非标准密码学（除非您属于大多数人没有的豁免）。

去：

[https://itunesconnect.apple.com/](https://itunesconnect.apple.com/)

登录，点击“常见问题解答”，然后点击“App Store 的全球贸易合规性”。

（抱歉，似乎没有直接链接到该页面的方法。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:42:55.870

当您提交应用程序时，iTunes Connect 中有一个关于加密的问题。您的答案很可能决定了您必须填写哪些表格。我的应用程序曾经有 MD5 散列。我只需要在几个复选框中选择正确的答案。

我不清楚在操作系统中使用代码是否真的意味着我正在导出加密（这是否意味着只有我编写或包含额外的代码？）但我认为最好还是谨慎行事。

# .net - FileSystemWatcher Changed 事件未引发

> ID：802889
> 
> 赞同：1
> 
> 时间：2009-04-29T15:25:08.253
> 
> 标签：.net, vb.net, filesystemwatcher

我正在开发一个 Windows 服务，它监视一些文件夹的更改、创建和删除。除了一个观察者监视单个文件（带有配置设置的 XML 文件）以进行细微更改之外，这一切都运行良好。

我尝试获取 Windows 服务代码并将其放入一个简单的 Windows 应用程序中，并为文件系统观察者提供启动/停止按钮并逐步完成它。它从不检测 XML 配置文件的文件更改。确实发生了更改，并且文件的“修改日期”正在更新。

```
XmlEventReferences = New System.IO.FileSystemWatcher()
XmlEventReferences.Path = "C:\XmlReferences\"
XmlEventReferences.Filter = "*.xml"
XmlEventReferences.NotifyFilter = IO.NotifyFilters.FileName
AddHandler XmlEventReferences.Changed, AddressOf ReloadEventReferences
AddHandler XmlEventReferences.Created, AddressOf ReloadEventReferences
AddHandler XmlEventReferences., AddressOf ReloadEventReferences
XmlEventReferences.EnableRaisingEvents = True 
```

这是一些代码，这是 XML 文件的示例：

```
<EventReference>
    <ER_EL_NUMBER>1</ER_EL_NUMBER>
    <ER_SEND_TO_DATABASE>true</ER_SEND_TO_DATABASE>
    <ER_ACTIVATE_ALARM>true</ER_ACTIVATE_ALARM>
    <ER_DESCRIPTION />
</EventReference> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-29T15:30:13.047

我认为问题在于`NotifyFilter`. 您实际上只告诉了`FileSystemWatcher`查找文件名更改。要让它也引发`Changed`文件修改事件，您还需要指定`LastWrite`标志。

即适当的代码行应更改为：

```
XmlEventReferences.NotifyFilter = IO.NotifyFilters.FileName |
    IO.NotifyFilters.LastWrite; 
```

有关详细信息，请参阅[`NotifyFilters`](http://msdn.microsoft.com/en-us/library/system.io.notifyfilters.aspx)MSDN 上的页面。

注意：正如 Joshua Belden 所指出的，您甚至根本不需要设置该`NotifyFilter`属性，因为正如[MSDN](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.notifyfilter.aspx)所述：“默认值是 LastWrite、FileName 和 DirectoryName 的按位或组合。” 但是，我会争辩说，在这种情况下，最好是明确的——这样就可以非常清楚地了解`FileSystemWatcher`正在观看和*不*观看的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T15:29:32.673

我相信你需要改变你`.NotifyFilter`的东西`LastWrite`来接受改变。

MSDN链接[在这里](http://msdn.microsoft.com/en-us/library/system.io.notifyfilters.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:35:42.690

这段代码似乎对我有用，对 test.xml 文件进行了编辑。是

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Dim XmlEventReferences = New System.IO.FileSystemWatcher()
    XmlEventReferences.Path = "C:\"
    XmlEventReferences.Filter = "*.xml"
    XmlEventReferences.EnableRaisingEvents = True
    AddHandler XmlEventReferences.Changed, AddressOf Watch
End Sub

Private Sub Watch(ByVal sender As Object, ByVal e As FileSystemEventArgs)
    Dim s As String = e.FullPath
End Sub 
```

将通知过滤器一起转储。

# java - 为什么这个缓冲的阅读器没有收到任何数据？

> ID：802898
> 
> 赞同：1
> 
> 时间：2009-04-29T15:28:26.607
> 
> 标签：java, sockets

我有一个线程应该监听消息的确认并处理它们，但似乎该线程永远不会收到确认。

这是线程中的相关代码：

```
private class TcpReader extends Thread {

    BufferedReader reader;
    boolean running = false;
    public TcpReader(BufferedReader reader)
    {
        this.reader = reader;
    }

    public void run() {
        running = true;

        while (running) {
            try {
                String line = reader.readLine();
                logger.debug("TCP READER RECIEVED MESSAGE ["+ line + "]");
                // Do stuff
            } catch (Exception e) {
            }
        }
    }
} 
```

该线程是在以下代码中创建的，该代码发生在不同的类中：

```
sock = new Socket(hostName, port);
out = new PrintWriter(sock.getOutputStream(), true);
isConnected = true;
BufferedReader reader =
        new BufferedReader(new InputStreamReader(sock.getInputStream()));
tcpReader = new TcpReader(reader);
tcpReader.start(); 
```

变量在 as 成员变量中实例化：

```
Socket sock;
PrintWriter out;
BufferedReader in; 
```

执行流程是我的服务器类接收一条消息，然后回复一个客户端应该接收的 ACK。但是，由于客户端不等待 ack 继续一个单独的线程等待所有响应。

readline 代码从不读取任何内容。

消息是从我的服务器发送的，它们的最后两个字符是“\r\n”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:33:04.083

是否正在从服务器传输行尾字符，即它是否在另一端刷新输出流？您可以使用`telnet`或简单的数据包嗅探器来检查正在发送的内容。

附带说明一下，`running`可能应该标记为易失性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T15:34:23.427

如果 an`Exception`由 引发`readLine`，则不记录任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:36:06.323

没有足够的信息。猜测您没有刷新输出缓冲区。

另请注意，您尚未指定字符编码。

# stored-procedures - 如何对存储过程使用 asutime 限制？

> ID：802901
> 
> 赞同：1
> 
> 时间：2009-04-29T15:29:03.970
> 
> 标签：stored-procedures, db2

我们需要限制存储过程可以运行多长时间，目前我们根据输入参数时间戳检查当前时间戳以结束进程。但是有没有人使用过asutime limit，它的效果/优势是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-08-29T20:37:55.383

LUW 上没有现成的功能，至少对于 9.7 及更低版本。但是，您可以尝试从外部查询长时间运行的查询

```
SELECT SUBSTR(STMT_TEXT, 1, 50) AS STMT_TEXT, AGENT_ID, 
   ELAPSED_TIME_MIN, APPL_STATUS, DBPARTITIONNUM 
   FROM SYSIBMADM.LONG_RUNNING_SQL ORDER BY DBPARTITIONNUM 
```

并查看 ELAPSED_TIME_MIN 和例如 STMT_TEXT 以确定要杀死的应用程序。您必须定期针对数据库运行逻辑以终止（“强制应用程序”）长时间运行的应用程序。

# data-migration - 导出/导入具有不同 RRA 的 RRDtool 数据库

> ID：802902
> 
> 赞同：2
> 
> 时间：2009-04-29T15:29:08.180
> 
> 标签：data-migration, rrdtool

我有一个 RRDTool 数据库，其中包含数据，我希望能够将这些数据导入另一个 RRDTool 数据库，该数据库仅与 RRA 不同。

我想提高历史数据的精度，所以我尝试了如何通过[rrdresize](http://oss.oetiker.ch/rrdtool/doc/rrdresize.en.html)增加 RRA，但它不会重新计算添加的行。这意味着当绘制各种“缩放级别”时我会得到奇怪的结果：当以较低的精度绘制图形时，该图有数据，但当我提高精度时为空，因为 RRDTool 自动选择最佳精度级别，并且新添加的 RRA 行是空的（*未知*）。

我也不能使用[rrdrestore](http://oss.oetiker.ch/rrdtool/doc/rrdrestore.en.html)，因为这也会创建 RRD（并且不只是填充已经存在的 RRD）。

我知道我无法重新创建丢失的数据，但我想至少将数据从较低精度的 RRA 复制到新的高精度 RRA。

我确实编写了一个简单的工具[rrdmove](http://code.google.com/p/pmptools/source/browse/trunk/rrd/rrdmove "RRD 数据移动")，它只是在每个步骤上循环以执行 rrdfetch/rrdupdate 循环，以便 RRDTool 只是重新计算新数据库中的所有 RRA，但它似乎效率不高。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-08T14:02:39.700

你还有你提到的那个脚本/工具吗？我正在寻找同样的东西，但我可以接受效率较低的东西。

编辑：我发现了一个非常酷的（我认为）工具： [http](http://docs.cacti.net/manual:087:8_rrdtool.04_resize) ://docs.cacti.net/manual:087:8_rrdtool.04_resize 但我仍然需要让它工作。

# c - C：函数调用不同模块后传递的参数为 NULL 的原因

> ID：802903
> 
> 赞同：1
> 
> 时间：2009-04-29T15:29:24.997
> 
> 标签：c, null, callstack

我在 C 程序中有一个奇怪的行为。我在名为 foo.c 的文件中将一些参数传递给具有以下签名的函数：

```
foo (char *first, size_t a, size_t b, size_t c, char *last); 
```

现在，当我从另一个包含 foo.h 的 C 文件中调用此函数时，例如：

```
foo("first value", 1, 2, 3, "last value"); 
```

在 foo first 中，a、b、c 是正确的，但 last 始终为 NULL。我使用哪种类型作为最后一个参数或从哪里调用此函数（即使直接在 main 中没有任何先前的操作）都没有关系。这些文件在一个可执行文件中编译并链接在一起。当我将 foo () 放在同一个源文件中时，一切正常。

有谁知道当函数外包时最后一个参数为 NULL 的原因可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T15:35:45.357

如果没有看到代码，我的猜测是您的函数声明（在标题中）与定义（在源文件中）不符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:47:36.437

感谢您的快速回复，

litb 的提示是正确的。在另一个头文件中，我错过了重新定义包含 size_t 的内容。所以基本上一个源文件使用 32 位，另一个使用 64 位 size_t 数据类型。

（无法发布任何代码，因为客户对此有点讨厌）

# .net - 新安装后 IIS 中的 ASP.NET 下拉列表中缺少 .NET 3.5

> ID：802910
> 
> 赞同：5
> 
> 时间：2009-04-29T15:30:23.810
> 
> 标签：.net, asp.net, iis

我刚刚将 .NET 3.5 Framework 安装到我的 Windows 2003 服务器上，当我尝试创建一个新网站时，我无法从 IIS 的网站属性 ASP.NET 选项卡中选择 3.5。

这适用于 1.0、1.1 和 2.0。

我知道框架安装过程与 3.5 完全不同，但我认为它应该在下拉列表中可用。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-29T15:32:36.283

这是因为 ASP.NET 3.5 仍然使用 2.0 中的 CLR。CLR 在 3.5 中没有改变，它更像是对 2.0 的扩展。（我希望我说的是正确的）

因此，虽然您不能选择 3.5，但您**可以**运行用 3.5 编写的 Web 应用程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-29T15:33:09.310

.NET Framework v3.5 本质上是 2.0 核心之上的“功能增强”。从 2.0 版出来就一直这样。在 IIS 进行基本核心转变之前，您不会在 IIS 中看到新版本，或者在这些方面做出重大改变以保证您的 ASP.NET 站点被配置为这样。

但不用担心，您的 .NET 3.5 应用程序将在 2.0 配置列表下正常运行。您会注意到在您的 web.config 文件中会有重定向，以指向某些更新的库的 3.5 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-29T15:33:53.973

这可能会回答您的问题：

[http://blogs.msdn.com/vijaysk/archive/2008/03/20/running-asp-net-3-5-on-iis.aspx](http://blogs.msdn.com/vijaysk/archive/2008/03/20/running-asp-net-3-5-on-iis.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T15:32:00.153

将其设置为 2.0。3.5 作为 2.0 的一组扩展有效地运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T15:32:23.227

我认为它不应该出现。3.5 基本上是一个 2.0 应用程序，其中包含通过 web.config 包含的 3.5 扩展。选择2.0

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T15:32:36.767

没有 3.5 选项。您仍然在 2.0 框架之上运行。它运行正常。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T15:32:42.463

ASP.NET 仍然是 2.0 版，但它将在 .NET 3.5 库上运行。这是令人困惑的，但唉。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-29T15:38:26.643

你在 IIS 上找不到 3.5，你会找到 2.0。但是，如果您想确保安装顺利，请转到

```
%windir%\Microsoft.NET\Framework 
```

（在大多数系统上是 C:\Windows\Microsoft.NET\Framework）

并查找名为 3.5 的文件夹。

# asp.net - System.Web.Configuration.MachineKeySection.GetDecodedData 中的“无法验证数据”异常表示什么

> ID：802921
> 
> 赞同：10
> 
> 时间：2009-04-29T15:33:03.023
> 
> 标签：asp.net, exception

我在 localhost Cassini 上开发了一个网站测试，它一直运行良好，现在当我部署到我的网络服务器时，我间歇性地收到以下错误：

> Global.Application_Error 错误：请求期间发生异常： [http://....blah.aspx](http://....blah.aspx)无法验证数据。在 System.Web.Configuration.MachineKeySection.GetDecodedData(Byte[] buf, Byte[] 修饰符, Int32 开始, Int32 长度, Int32& dataLength) 在 System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) HttpApplication.RaiseOnError => EventHandler .Invoke => Global.Application_Error

这被我的 global.asax 捕获。我四处寻找，但找不到原因。这个异常是在极其简单和小型的网络表单中抛出的。该站点未托管在网络场中。

2 个页面似乎间歇性地导致此错误，其中一个页面在 ViewState 中存储了一个布尔值，但除此之外它没有被修改。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-29T15:36:05.340

[http://dotnetcoderoom.wordpress.com/2008/11/07/unable-to-validate-data-aspnet-error/](http://dotnetcoderoom.wordpress.com/2008/11/07/unable-to-validate-data-aspnet-error/)

原因：根本原因是viewstate数据加解密时key的不同。假设一个asp.net用key1渲染了一个页面并将页面状态保存在view state中，同时asp.net的key更改为key2，现在当页面上发生一些服务器端事件时，viewstate会被解密，这个错误会发生为由于不同的加密密钥，旧视图状态现在无效。

当您长时间打开页面并在此之后执行一些事件时，可能会发生这种情况。

解决方案 修复 web.config 文件中的密钥，以便仅使用一个密钥来加密和解密视图状态数据。

欲了解更多信息，请访问：

[http://www.experts-exchange.com/Programming/Programming_Languages/Dot_Net/ASP_DOT_NET/Q_21321364.html](http://www.experts-exchange.com/Programming/Programming_Languages/Dot_Net/ASP_DOT_NET/Q_21321364.html)

[http://support.microsoft.com/default.aspx?scid=kb;en-us;Q312906](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q312906)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-07-19T19:53:56.987

我在我的 asp.net Web 应用程序中出现“无法验证数据 System.Web.Configuration.MachineKeySection.EncryptOrDecryptData”。我清除了我的 cookie，异常停止了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-29T15:38:09.453

尝试将机器密钥添加到您的 web.config 以查看是否可以修复错误

[http://aspnetresources.com/tools/keycreator.aspx](http://aspnetresources.com/tools/keycreator.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-11T19:39:24.003

在我的例子中，我有两个 Web 应用程序（一个非常旧，另一个是我刚刚创建的），尽管在一个应用程序中生成了相同的机器密钥设置票证，但在另一个应用程序中无法使用。这已通过在较新的应用程序中添加`compatibilityMode="Framework20SP2"`作为`machineKey`node in的参数来解决`web.config`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-14T14:49:43.760

有同样的错误。machinekey 和 decryptionKey 在所有 web.config 中都是相同的，但有些 web.config 有

```
 <add key="aspnet:UseLegacyEncryption" value="true" />
    <add key="aspnet:UseLegacyFormsAuthenticationTicketCompatibility" value="true" /> 
```

而其他没有。从所有 web.config 中删除了此密钥。我认为解决方案不是删除密钥，而是在所有 web.config 中都相同

# hosting - 亚马逊 EC2 元数据

> ID：802926
> 
> 赞同：2
> 
> 时间：2009-04-29T15:33:57.763
> 
> 标签：hosting, amazon-ec2, cloud

我们正在从数据中心迁移到亚马逊。我们是一家小公司，与其升级我们的硬件，我们发现迁移到“云”是很诱人的。我们从头开始整合自定义 AMI，目前正在决定如何配置环境。

我一直在使用 Amazon 的管理控制台和 Elasticfox 来管理资源，但我遇到了长期管理的问题。当我们有多个服务器在运行时，很难分辨哪个是哪个。EBS 资源及其快照也存在同样的问题。似乎没有任何方法可以通过 AMI 工具将元数据添加到资源中，以使用漂亮的别名来区分它们。我阅读了对另一个问题的回复，其中安全组用于“命名” AMI 实例，但这仍然让我有 EBS/快照管理。

我知道有像 RightScale 和 Scalr 这样的服务，我相信它们会添加这些功能，但我想知道其他人是如何自己处理这个问题的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T13:01:34.887

您可能已经找到了解决方案，但我想我会回答以防万一。

几个月前，我启动了一个开源项目来帮助组织 EC2 基础架构。它将元数据存储在 SimpleDB 中。

您在 Ruby DSL 中创建机器配置，其中所有内容都组织成环境和角色。这是一个典型的配置：

```
env :stage do
  size 'm1.small'                # Default EC2 machine type for the 'stage'

  role :app do
    positions 1                  # Only 1 machine
    addresses '11.22.33.44'      # Define an elastic IP

    disks do                     # Define EBS volumes
      path "/rudy/disk1" do      # The path to mount
        size 100                 # The size in GB
        device "/dev/sdr"        # The unique disk device
      end
    end
  end
  role :db do
    size 'm1.large'              # Use more powerful machine for db
    ami 'ami-dc1038a8'           # A 64-bit debian
  end
end 
```

然后，您可以从命令行启动环境：

```
$ rudy startup
The following machines were started:
m-us-east-1b-stage-app-01  ec2-11-22-33-44.us-east-1.compute.amazonaws.com

$ rudy -r db startup
The following machines were started:
m-us-east-1b-stage-db-01  ec2-79-125-50-26.us-east-1.compute.amazonaws.com

$ rudy machines
m-us-east-1b-stage-app-01  ec2-11-22-33-44.us-east-1.compute.amazonaws.com
m-us-east-1b-stage-db-01  ec2-79-125-50-26.us-east-1.compute.amazonaws.com

$ rudy disks 
disk-us-east-1b-stage-app-01-rudy-disk1  vol-eee10486;  100GB; /dev/sdr; mounted 
```

您可以使用以下方式登录：

```
$ rudy -u root ssh 
```

该项目称为鲁迪。以下是更多信息的几个链接，如果您有任何问题，请随时直接与我联系：

*   [入门](http://wiki.github.com/solutious/rudy/getting-started)
*   [GitHub 项目](http://github.com/solutious/rudy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T18:17:57.323

命名您的服务器和 EBS 卷/快照的最简单方法是使用 RightScale 的免费服务来管理您的实例；这使您可以为每个正在运行的 EC2 实例、EBS 卷或快照创建一个别名。

如果您不想使用 RightScale，您可以在启动时将用户数据传递给您的实例，并使用它来设置主机名或其他可以让您唯一标识实例的值。不过，我不确定您会为 EBS 卷做什么。[在这里](http://docs.amazonwebservices.com/AWSEC2/latest/DeveloperGuide/)查看更多详细信息（AWS 文档似乎使用 URL 掩码，因此请转到使用 Amazon EC2/启动和使用实例/实例元数据）

# php - Javascript 和 PHP5 中的换行符

> ID：802932
> 
> 赞同：0
> 
> 时间：2009-04-29T15:34:26.747
> 
> 标签：php, javascript, xml, csv, newline

我有一个嵌入在 XML 文档中的 CSV 字符串，这是使用 XML 的闪存图表所必需的。问题是图表通过 javascript 片段从 HTML 文件中获取设置，如下所示：

```
<script type="text/javascript">
        // <![CDATA[        
        var so = new SWFObject("/gr/amstock.swf", "line", "100%", "100%", "8", "#FFFFFF");
        //so.addVariable("path", "../amline/");
        so.addVariable("chart_settings", escape('<settings><number_format><thousands_separator></thousands_separator><decimals_separator><![CDATA[.]]></decimals_separator></number_format><number_format><thousands_separator></thousands_separator><decimals_separator><![CDATA[.]]></decimals_separator></number_format><redraw><![CDATA[true]]></redraw><data_sets><data_set did="0"><color><![CDATA[#00688B]]></color><csv><separator><![CDATA[,]]></separator><date_format><![CDATA[MM/DD/YYYY]]></date_format><data><![CDATA[03/29/09,0
03/30/09,0
03/31/09,0
04/01/09,0
04/02/09,0</data><columns>... 
```

因此，显然换行符会破坏 javascript（由 PHP 变量回显）。无论如何要删除换行符（或至少停止破坏javascript的换行符），但仍然可以让闪存图表正确地将其读取为CSV文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:37:20.923

试试这个。如果它不起作用，我有另一个想法。

```
<?php

// assumes *nix style newlines
echo str_replace( "\n", "\\n", $jsCode ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T15:37:43.010

```
stringObj.replace("\n",""); 
```

stringObj 在哪里

```
<script type="text/javascript">
        // <![CDATA[            
        var so = new SWFObject("/gr/amstock.swf", "line", "100%", "100%", "8", "#FFFFFF");
        //so.addVariable("path", "../amline/");
        so.addVariable("chart_settings", escape('<settings><number_format><thousands_separator></thousands_separator><decimals_separator><![CDATA[.]]></decimals_separator></number_format><number_format><thousands_separator></thousands_separator><decimals_separator><![CDATA[.]]></decimals_separator></number_format><redraw><![CDATA[true]]></redraw><data_sets><data_set did="0"><color><![CDATA[#00688B]]></color><csv><separator><![CDATA[,]]></separator><date_format><![CDATA[MM/DD/YYYY]]></date_format><data><![CDATA[03/29/09,0
03/30/09,0
03/31/09,0
04/01/09,0
04/02/09,0</data><columns>... 
```

# nhibernate - 为什么我不能在 Fluent NHibernate References() 映射上设置 ReadOnly？

> ID：802940
> 
> 赞同：4
> 
> 时间：2009-04-29T15:36:08.443
> 
> 标签：nhibernate, fluent-nhibernate

在 Fluent NHibernate 中，References() 返回一个不支持“ReadOnly()”方法的对象。

我正在尝试创建这种映射（即不将更新传播到被引用项目的映射）：

```
<many-to-one update="false" insert="false" 
name="DestinationSheet" column="DestinationSheetNumber" /> 
```

在普通 (map()) 映射中，可以使用 ReadOnly() 设置这两个属性。

我想做这样的事情：

```
References(x => x.DestinationSheet).
       ColumnName("DestinationSheetNumber").ReadOnly(); 
```

我可以使用 SetAttributes() 手动添加更新和插入属性，效果很好，但我担心 ReadOnly() 不存在于 References() 上的事实是我不应该尝试这样做的线索.

有谁知道为什么 ReadOnly() 在这种情况下不可用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T17:01:57.130

它根本还没有实施。随着时间的推移，我们将支持 NHibernate 的所有功能，但在此之前，`SetAttribute`您可以继续使用该方法。

顺便说一句，我们接受补丁！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T16:09:32.733

References 创建了一个多对一映射，并且[根据文档](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-5/1nr4enxv3dpeq/8#5(2E)1(2E)10(2E)(C2)(A0)many(2D)to(2D)one)，此映射不支持只读。您将 update 和 insert 设置为 false 的方法对我来说是正确的。AFAIK，Fluent NHibernate 项目计划支持 NHibernate 的所有映射功能，但在此之前您将不得不使用 SetAttributes。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-30T16:25:22.077

詹姆斯格雷戈里提供的答案的实现是

```
References(x => x.Store).TheColumnNameIs("StoreId").SetAttribute("update","false"); 
```

# javascript - 源于 IFrame 的 JavaScript 权限错误

> ID：802963
> 
> 赞同：0
> 
> 时间：2009-04-29T15:41:03.130
> 
> 标签：javascript, jakarta-ee

我有一个`.jsp`包含一个 IFrame 的页面，该页面具有一些嵌入式 JavaScript。此 JavaScript 访问父页面（包含 IFrame 的页面）中的一些 DOM 元素。

嵌入页面将位于与父页面不同的子域上，我意识到存在一些安全隐患。我的印象是，`document.domain`嵌入在 IFrame 中的任何页面都必须与父页面的 document.domain 匹配，才能允许跨 IFrame 访问。嵌入页面当前包含以下代码到`broaden`其安全范围：

```
document.domain = 'domain.com'; //where domain.com is my domain 
```

然后它继续访问父文档中的 DOM 元素。

我目前正在对此进行测试，并已使用以下条目修改了为父页面提供服务的 Windows 机器上的 hosts 文件：

```
127.0.0.1 domain.com 
```

目标是欺骗父页面上的 JavaScript 使其相信嵌入页面中的文档是从同一个域提供的。

如果我然后浏览到同一台机器上的页面。尽管通过 Firebug 观察到在我的父页面和嵌入页面中都`document.domain`显示，`domain.com`但在尝试从嵌入页面中运行的 JavaScript 获取或设置 DOM 属性时，我收到“权限被拒绝”错误。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T16:31:01.870

即使“document.domain”属性看起来相同，但从[MSDN 文档](http://msdn.microsoft.com/en-us/library/cc196989(VS.85).aspx)中听起来您仍然必须明确地将它们设置为相同：

> 不同主机上的所有页面必须将 domain 属性显式设置为相同的值才能成功地相互通信。例如，主机 microsoft.com 上某个页面的 domain 属性的值默认为“microsoft.com”。如果将另一个名为 msdn.microsoft.com 的主机上的页面的域属性设置为“microsoft.com”，这两个页面可以相互通信，这似乎是合乎逻辑的。但是，情况并非如此，**除非您将 microsoft.com 上页面的域属性显式设置为“microsoft.com”。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T18:20:19.063

您可以放置​​一个代理将请求重定向`<iframe src="http://domain.com/fake/">`到正确的位置。

这只是一个想法...

问候。

# text - 短信归档解决方案

> ID：802964
> 
> 赞同：1
> 
> 时间：2009-04-29T15:41:10.913
> 
> 标签：text, sms, message, archive

有谁知道那里是否有任何 SMS 存档解决方案？这个想法是将您的短信从您的手机存档到一个中心位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-12T20:26:10.920

[也许不像你希望的那样自动，但你可以用AT](http://www.3gpp.org/ftp/Specs/html-info/27005.htm) [命令](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)读出所有的短信。我经常备份我的手机。跑步

```
at+cscs="UTF-8"
at+cgmi;+cgmr
at+cpms="SM","SM"; +cmgl=4
at+cpms="ME","ME"; +cmgl=4 
```

将转储（可能在 PDU 模式下）存储在 sim 卡和手机内存中的所有消息。当您使用它时，备份电话簿和已拨/未接/已接电话列表也很不错：

```
at+cpbs="SM"; +cpbr=1,200
at+cpbs="ME"; +cpbr=1,2500
at+cpbs="DC"; +cpbr=1,30
at+cpbs="MC"; +cpbr=1,30
at+cpbs="RC"; +cpbr=1,30 
```

将终端程序的输出捕获到文本文件中，您可以以任何您喜欢的方式分发该文件。

更新：上述命令中的最大范围数字是针对我的 sim 卡和我的手机的，你的可能会有点不同。您可以通过发出`test operation`AT+CPBR 查询范围（AT 命令有三个基本操作，`set/execute`（例如 AT+CPBS="ME"）、`read`（例如 AT+CPBS?）和`test`（例如 AT+CPBS=?），有关详细信息，请参见[V.250 ）：](http://www.itu.int/rec/T-REC-V.250-200307-I/en)

```
at+cpbs="SM"; +cpbr=?
at+cpbs="ME"; +cpbr=?
at+cpbs="DC"; +cpbr=?
at+cpbs="MC"; +cpbr=?
at+cpbs="RC"; +cpbr=? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T16:57:42.647

如果它只是一部手机，那么有 USB 密钥/软件包可以从 sim 卡读取和存档数据

例如[http://www.iwantoneofthose.com/usb-sim-card-reader/index.html](http://www.iwantoneofthose.com/usb-sim-card-reader/index.html)

如果它有很多电话；您可能需要与电话公司交谈，因为他们可能会提供解决方案。

# java - 为什么 HttpServlet 会抛出 IOException？

> ID：802967
> 
> 赞同：2
> 
> 时间：2009-04-29T15:42:12.813
> 
> 标签：java, servlets

我明白为什么 HttpServlet 会抛出 ServletException，但为什么会抛出 IOException？这背后的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T15:47:37.077

从文档：

> IOException - 如果在 servlet 处理 GET 请求时检测到输入或输出错误

当您打印 servlet 输出时，可能会发生这种情况：

response.getWriter().print() - 这个方法抛出 IOException

可以在响应完成之前关闭套接字以打印输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T15:46:58.840

我建议 an`IOException`表示处理输入/输出的问题，例如从请求输入读取或写入响应的问题，而 a`ServletException`更多地与特定于 servlet 的问题有关，例如有关 servlet 配置/初始化的错误，以及处理请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:46:30.573

如果 servlet 通过 I/O 接口写入输出流（即页面），任何 I/O 错误都将报告为`IOException`.

也许 API 不应该直接使用 I/O 接口。使用 RMI 的 WebApp 允许`RMIException`通过 servlet 接口（`IOException`由于某种原因它是子类）的情况并不少见。

# c++ - 如何为 Linux 构建 Visual C++ 项目？

> ID：802970
> 
> 赞同：40
> 
> 时间：2009-04-29T15:42:31.033
> 
> 标签：c++, visual-studio, linux, visual-c++

构建（对于 Linux）用 Visual Studio 编写的 C++ 应用程序的最佳和最简单的方法是什么？代码本身已经准备好了——我只使用了跨平台库。

是否可以在 Visual Studio 中在 Windows 下准备好所有东西，然后在 Linux 下使用 CLI 工具构建它？有没有描述这个的文档？

**编辑：**更多信息：

*   使用的库：stl、wxwidgets、boost、asio、cryptlib。

*   很少有 Linux 知识。

**编辑#2：**我选择了以下解决方案：使用 kdevelop 创建新项目并在那里编译所有内容。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-29T15:49:24.917

我们正在为 Linux 项目使用 CMake。CMake 可以生成 KDevelop 和 Visual Studio 项目文件，因此您只需将 CMake 文件创建为特定于平台的 IDE 文件的来源。KDevelop 生成器很好，因此您可以在 KDevelop 中进行编辑和编译（这又会调用 Make）。

另一方面，如果你没有什么花哨的东西，你可以使用 CMake 或者只是 Make 在 Linux 上构建东西，如果你想保留你的解决方案文件（这是我目前正在为带有测试应用程序的库所做的） . 当您的构建过程不仅仅是“将这些文件扔给编译器并让我们看看它做了什么”时，这种方法会变得复杂，因此我认为 CMake 解决方案对于跨平台开发来说是一件好事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-02-07T23:34:33.177

8年后...

我今天偶然发现了这个问题，并认为您可能想看看[Visual C++ for Linux](https://blogs.msdn.microsoft.com/vcblog/2016/03/30/visual-c-for-linux-development/)。

VC++ for Linux 于 2016 年 3 月发布，允许您在 VC++ 中创建项目，然后使用本机 Linux 工具在 Linux 机器/VM 中构建它。此外，您还可以在 VS 中**调试**您的应用程序，因为 Linux 工具允许 VS 调试器通过 SSH 在您的 Linux 机器/VM 中驱动 GDB！

看起来这几乎正是@mspoerr 所要求的:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-30T23:29:00.733

以下是如何在 Linux 下手动编译 C 代码**而无需额外的构建工具**：

```
gcc -s -O2 -o prog -I. -Iincludedir1 -Iincludedir2 -Llibdir1 -Llibdir2 code1.c code2.c -luse1 -luse2 
```

但是，如果您的项目大于几个文件，**您可能希望使用构建工具**（例如 CMake，请参阅 OregonGhost 的答案）来自动编译许多文件并使其增量。如果您使用构建工具，它将在引擎盖下运行 gcc，并具有上述类似的参数。了解上述论点很有用，因此您可以在自动构建失败时进行故障排除。

这会将 code1.c 和 code2.c 编译为可执行二进制 prog，从 .、includedir1 和 includedir2 加载 .h 文件，从目录 libdir1 和 libdir2 加载库（例如 libuse1.so* 和 libuse2.so*），使用库 use1（对应于文件名 libuse1.so*) 和 use2。

如果在 .c 文件中出现未定义的符号错误，则必须指定更多`-I`标志。如果在 .o 文件中出现未定义的符号错误，则必须指定更多`-l`标志。如果`cannot find -l...`出现错误，则必须指定更多`-L`标志。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-29T15:47:33.533

> 为 Linux 构建使用 Visual Studio 编写的 c++ 应用程序的最佳和最简单的方法是什么？代码本身已经准备好了——我只使用了跨平台库。

*   检查是否有任何不属于标准 C++ 的内容
*   冲洗并重复
*   创建 makefile 或 KDevelop 项目

*瞧！*

# asp.net - Asp.net Datasource - 通过查看数据源对象查看 sql 数据？

> ID：802975
> 
> 赞同：1
> 
> 时间：2009-04-29T15:43:45.477
> 
> 标签：asp.net, datasource, datasourceview

有没有办法通过查看代码隐藏中的 DataSource 或 DataSourceView 对象来查看从 db 返回的数据？我正在尝试在调试中查看 DataSourceView，但没有看到返回的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-29T15:48:58.850

使用您的数据源填充数据表或数据集，您可以遍历记录和列，但是如果您正在寻找可以为您提供 sql 结果的直截了当表示的东西，您最好的选择是将它绑定到一个数据表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T16:54:41.237

```
DataView dv = (DataView) YourDataSourceObject.Select(DataSourceSelectArguments.Empty);
for (int i = 0; i < dv.Table.Rows.Count; i++)
{
    string c = dv.Table.Rows[i]["c"].ToString();
} 
```

# php - PHP5 中的语言环境日期格式

> ID：802978
> 
> 赞同：0
> 
> 时间：2009-04-29T15:44:29.000
> 
> 标签：php, date, format, locale

我的网站根据用户设置或浏览器设置（用户尚未设置偏好）更改其区域设置。我正在使用 amline 图表，特别是股票图表，它需要 'MM/DD/YYYY' 或 'DD-MM-YYYY' 中的日期格式，我想图表知道如何理解日期。有很多方法可以根据计算机区域设置格式化日期，但是我找不到获取区域设置格式的方法（如上所述）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T15:47:59.850

有什么问题？

```
date('m/d/Y') 
```

或者

```
date('d-m-Y') 
```

# c# - C# 反射属性类型

> ID：802981
> 
> 赞同：3
> 
> 时间：2009-04-29T15:45:50.950
> 
> 标签：c#, reflection

我正在使用反射从匿名类型中获取值：

```
object value = property.GetValue(item, null); 
```

当基础值是可空类型（T？）时，当值为空时如何获取基础类型？

给定

```
int? i = null;

type = FunctionX(i);
type == typeof(int); // true 
```

寻找 FunctionX()。希望这是有道理的。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-29T15:52:51.227

你可以这样做：

```
if(type.IsgenericType)
{
   Type genericType = type.GetGenericArguments()[0];
} 
```

编辑：一般用途：

```
public Type GetTypeOrUnderlyingType(object o)
{
   Type type = o.GetType();
   if(!type.IsGenericType){return type;}
   return type.GetGenericArguments()[0];
} 
```

用法：

```
int? i = null;

type = GetTypeOrUnderlyingType(i);
type == typeof(int); //true 
```

这适用于任何泛型类型，而不仅仅是 Nullable。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T15:56:46.210

如果你知道那是`Nullable<T>`，你可以`GetUnderlyingType(Type)`在`Nullable`.

```
int? i = null;

type = Nullable.GetUnderlyingType(i.GetType());
type == typeof(int); // true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T15:55:20.427

根据我对[http://blogs.msdn.com/haibo_luo/archive/2005/08/23/455241.aspx](http://blogs.msdn.com/haibo_luo/archive/2005/08/23/455241.aspx)的了解，您只会得到返回类型的 Nullable 版本。

# c# - 协变和逆变有什么好处？

> ID：802987
> 
> 赞同：16
> 
> 时间：2009-04-29T15:47:11.553
> 
> 标签：c#, covariance, contravariance

C# 4.0 将支持协变和逆变。但我并不清楚这个新功能的好处。你能解释一下（清楚地）我们为什么需要它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T15:55:08.897

它们只是允许您做一些在概念上有效且形式上可接受的事情，但由于语言限制，目前不允许。例如：

```
IEnumerable<int> ints = new List<int> { 1, 2, 3 };

Action<IEnumerable<object>> PrintThings =
    x => { foreach(var thing in x) Console.WriteLine(thing); };

PrintThings(ints); // doesn't compile right now :(  will compile in 4.0 
```

没有根本原因为什么这不起作用或不应该起作用；它只是碰巧在语言中是不允许的。通过允许它，您可以让程序员的生活更轻松，因为这样的操作对他们来说是很自然的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-29T16:01:17.010

对于 4.0 中的工作方式和内容存在很多误解。到目前为止，我读过的最好的解释是我的 Marc Gravell 写的。在此处查看他的博客文章：

[http://marcgravell.blogspot.com/2009/02/what-c​​-40-covariance-doesn-do.html](http://marcgravell.blogspot.com/2009/02/what-c-40-covariance-doesn-do.html)

重申一下，很多人认为这将在 4.0 中起作用：

```
public class Base{}
public class Derived : Base {} 
```

..在其他班级

```
List<Derived> derived....

public void Method(List<Base> b){} 
```

**即使在 4.0 中，您也无法将 List 传递给此方法。正如 Marc 指出的那样，这就是通用约束的用途，并且可以从 2.0 开始**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T16:04:11.763

在我看来，*协方差*将有很大帮助的好处之一是*泛型*。

我遇到了几种需要显式使用`Cast`将特定类型转换为其基类型的情况*。*

```
class Foo { }
class Bar : Foo { }

// ...

IEnumerable<Foo> foos = new List<Foo>();
IEnumerable<Bar> bars = new List<Bar>();

foos = bars.Cast<Foo>();

// C# 4.0
foos = bars; 
```

这是关于这个主题的一个[很好的参考](http://www.buunguyen.net/blog/new-features-of-csharp-4.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T15:59:25.033

[有一篇很好的文章在这里](http://www.buunguyen.net/blog/new-features-of-csharp-4.html)讨论了这个问题。***```