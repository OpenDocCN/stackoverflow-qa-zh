# StackOverflow 问答 10723000-10723999

# c# - SetCursorPos 不工作

> ID：10723000
> 
> 赞同：5
> 
> 时间：2012-05-23T15:20:15.147
> 
> 标签：c#, winapi, dll

我正在使用以下库：[http ://www.codeproject.com/Articles/28064/Global-Mouse-and-Keyboard-Library?fid=1518257&df=90&mpp=25&noise=3&prof=False&sort=Position&view=Quick&fr=51# xx0xx](http://www.codeproject.com/Articles/28064/Global-Mouse-and-Keyboard-Library?fid=1518257&df=90&mpp=25&noise=3&prof=False&sort=Position&view=Quick&fr=51#xx0xx)

为了帮助我在 Windows 7 中使用低级鼠标挂钩。我创建了一个计时器来检查上次触发鼠标移动事件的时间，如果它比给定时间长，我将鼠标移动到屏幕的左上角使用 SetCursorPos(0,0)

在移动鼠标之前，我取了它的旧坐标，并保存了它们。这样当我收到下一个 MouseMove 事件时，我就可以将鼠标替换到原来的位置。但是，在调用 SetCursorPos(oldPos.x, oldPos.y) 时，鼠标不会移动。

我确定 oldPos 值是正确的，但是光标拒绝移动。这可能是由于我正在使用的图书馆吗？请帮忙。

```
[DllImport("user32.dll", SetLastError = true)]
    public static extern bool SetCursorPos(int X, int Y);
        [DllImport("user32.dll")]
    public static extern bool GetCursorPos(out POINT lpPoint);
void mouseHook_MouseMove(object sender, MouseEventArgs e)
    {
        //If the mouse was not visible, move it back to it's original position
        if (!mouseVisible)
        {
            mouseVisible = true;

            SetCursorPos(cursorPosition.x, cursorPosition.y);
        }

        //Update the last moved time.
        lastMoved = DateTime.Now;
    }

private void hideMouse(object sender, EventArgs e)
    {
        if (mouseVisible && (DateTime.Now - lastMoved) > new TimeSpan(0, 0, 0, mouseControl.timeTrackBar.Value))
        {
            log.Debug("Hiding mouse.");

            //Store the current mouse position.
            GetCursorPos(out cursorPosition);

            //Hide the mouse.
            SetCursorPos(0, 0);
            log.Debug("Moving cursor to 0,0");

            mouseVisible = false;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:33:39.567

我的猜测是会发生这种情况：

1.  使用 SetCursor 将鼠标移动到 0,0。
2.  调用 SetCursor 的行为会从您的钩子中生成一个鼠标移动事件。
3.  您通过再次显示光标并将其放回原来的位置来响应鼠标移动。

# ios - 预处理 Root.plist 类似于 Info.plist

> ID：10723003
> 
> 赞同：1
> 
> 时间：2012-05-23T15:20:24.793
> 
> 标签：ios, xcode, xcode4

我在 Xcode 构建设置中启用了 Info.plist 的预处理，以将 CFBundleVersion 中表示版本号的键替换为 version.h 中的相应值。这很好用：VERSION_NUMBER 被 1.0 替换为 version.h 中相应的#define VERSION_NUMBER 1.0。我想在 Root.plist 中做同样的事情，其中​​ plist 在放入 .app/.ipa 时会更新。

现在我有一个脚本可以在每次编译时自动更新 Root.plist，但这会更新实际的 Root.plist，这意味着我将不得不重新提交给版本控制等。我想在编译的应用程序中生成一个 Root.plist，但不要碰“真正的”plist。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:39:35.860

据我所知，唯一的方法是像你一样使用构建时脚本。您可以通过以下技巧解决版本控制问题：

*   将您的“模板” Root.plist（即具有预处理器指令的那个）重命名为 Root-template.plist
*   从脚本调用预处理器并将其输出到 Root.plist
*   将 Root-template.plist 提交到您的版本控制
*   将 Root.plist 添加到版本控制的忽略列表中（例如，如果您使用 svn，则必须将 Root.plist 添加到包含该文件的目录的 svn:ignore 属性中）

# sql - 从 plpgsql 函数返回一个选择

> ID：10723006
> 
> 赞同：4
> 
> 时间：2012-05-23T15:20:39.457
> 
> 标签：sql, postgresql, plpgsql

我需要从 plpgsql 函数返回动态生成的选择语句。这是我到目前为止所拥有的：

```
CREATE OR REPLACE FUNCTION qa_scf(cname character varying, tname character varying)
RETURNS text AS
$BODY$
BEGIN
return '* from ' ||tname|| 'where ' ||cname ||' != ''AL''';
end;
$BODY$
LANGUAGE plpgsql VOLATILE
COST 100; 
```

调用者从批处理文件中运行：

```
select qa_scf('state', 'testtable') 
```

这将返回文字文本“qa_scf * from testtable where state != 'AL'”。我需要从 sql 批处理文件运行这个查询，但我似乎找不到正确的返回语句让这个函数返回一个字符串，然后让 sql 批处理执行它。我正在使用 Postgres 9.0。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T16:05:47.480

返回类型应为 SETOF RECORD。执行并返回 SQL 将变为 RETURN QUERY EXECUTE。您的查询缺少 SELECT。在 where 之前也缺少空格。

```
CREATE OR REPLACE FUNCTION qa_scf(cname character varying, tname character varying)
RETURNS SETOF RECORD AS
$BODY$
BEGIN
    RETURN QUERY EXECUTE 'SELECT * from ' ||tname|| ' where ' ||cname ||' != ''AL''';
END;
$BODY$
LANGUAGE plpgsql; 
```

调用此函数会有点复杂，因为您必须在结果中指定您期望的列。像这样：

```
SELECT *
FROM qa_scf('foo', 'bar') AS t(col1_name col1_type, ...); 
```

# extract - 根据最后一个字符提取字段

> ID：10723014
> 
> 赞同：1
> 
> 时间：2012-05-23T15:21:10.393
> 
> 标签：extract, cut

我想根据最后一个字符 K 提取部分字段。每个字段都以 K 结尾，而我要提取的字段只有 4 个字符。

我有这样的东西

```
fromdata.set.days/john001.00.K 

fromdata.set.days/bian001.00.K

fromdata.set.days/aluo001.00.K

fromdata.set.days/mark001.00.K 
```

我想从上面提取以下4个字符名称

```
john

bian

aluo

mark 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T04:44:40.680

一种方法`awk`：

```
awk -F/ '{for (i=1;i<=NF;i++) if(substr($i,length($i))=="K") print substr($i,1,4) }' file 
```

它分隔文件`/`，然后在每列上查找最后一个字符。如果它以`K`then 结尾，则打印该列的前 4 个字符。

### 测试：

```
$ cat file
fromdata.set.days/john001.00.K
fromdata.set.days/bian001.00.K
fromdata.set.days/aluo001.00.K
fromdata.set.days/mark001.00.K

$ awk -F/ '{for (i=1;i<=NF;i++) if(substr($i,length($i))=="K") print substr($i,1,4) }' file
john
bian
aluo
mark 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T15:04:15.817

由于您在上面的评论中声明您希望将此列表分配给一个变量并在循环中迭代名称，因此无需使用`awk`或其他外部工具 - 只需使用[参数扩展](http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)：

```
$ cat foo.txt
fromdata.set.days/john001.00.K
fromdata.set.days/bian001.00.K
fromdata.set.days/aluo001.00.K
fromdata.set.days/mark001.00.K

$ cat test.sh
#!/bin/bash

while read line; do
        name=${line#*/}
        name=${name:0:4}
        echo "${name}"
done < foo.txt 
```

示例运行：

```
$ ./test.sh
john
bian
aluo
mark 
```

# android - 在顶部绘制选择器 - 用于基本的线性布局？

> ID：10723015
> 
> 赞同：8
> 
> 时间：2012-05-23T15:21:10.643
> 
> 标签：android

我想要一个简单布局的选择器单击状态以在其子级之上绘制。我认为这类似于 ListView 中的“drawSelectorOnTop”属性。示例布局：

```
<LinearLayout
  android:background="@drawable/my_click_selector">
    <LinearLayout
      android:background="#F00" />
</LinearLayout>

---------------
|             |
| ----------- |
| ----------- |
|             |
--------------- 
```

所以这里我们有一个父线性布局和一个具有纯色背景颜色（红色）的内部子级。当我单击父级时，资产的背景颜色会按照我的选择器中的定义发生变化，但由于子级在 z 顺序中更靠近用户，因此它保持不变。

有没有办法让选择器的选定状态绘制在所有子项之上而不是之下？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-30T09:24:12.083

我遇到了这个问题，我之前看过你的问题，这里我做了什么并且工作得很好：

您可以使用该`FrameLayout` `android:foreground`属性为您完成工作

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:clickable="true"
    android:descendantFocusability="afterDescendants"
    android:duplicateParentState="true"
    android:focusable="true">

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:clickable="true"
        android:descendantFocusability="beforeDescendants"
        android:focusable="true"
        android:focusableInTouchMode="true"
        android:foreground="@drawable/draw_on_top_selector">

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:background="#282828"
            android:paddingBottom="5dp">

            <ImageView
                android:layout_width="160dp"
                android:layout_height="90dp"
                android:layout_alignParentLeft="true"
                android:layout_alignParentRight="true"
                android:layout_gravity="center_vertical|center_horizontal"
                android:adjustViewBounds="true"
                android:contentDescription="@string/app_name"
                android:scaleType="centerCrop"
                android:src="@drawable/video_blank" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignBottom="@id/episodeImage"
                android:layout_alignLeft="@id/episodeImage"
                android:background="@android:color/black"
                android:gravity="right"
                android:padding="2dp"
                android:textColor="#FFFFFF"
                android:textSize="11sp" />

        </RelativeLayout>
    </FrameLayout>
</LinearLayout> 
```

draw_on_top_selector.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/show_cell_background_selected" android:state_pressed="true"/>
    <item android:drawable="@drawable/show_cell_background"/>
</selector> 
```

show_cell_background_selected.xml

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item>
        <shape android:shape="rectangle" >
            <stroke
                android:width="4dp"
                android:color="#FFD900" >
            </stroke>

            <solid android:color="@android:color/transparent" />
        </shape>
    </item>

</layer-list> 
```

show_cell_background.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item>
        <shape android:shape="rectangle" >
            <stroke
                android:width="2dp"
                android:color="#20000000" >
            </stroke>

            <solid android:color="@android:color/transparent" />
        </shape>
    </item>

</layer-list> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-23T15:56:20.170

我最近[发表了一篇](http://castorflex.github.io/blog/2013/07/17/adding-a-foreground-selector-to-a-view/)关于在任何视图上绘制前景选择器的帖子。它可以让你避免嵌套布局。

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T06:10:51.030

尝试使用 ForegroundLinearLayout [https://gist.github.com/chrisbanes/9091754](https://gist.github.com/chrisbanes/9091754)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-26T16:05:49.270

您可以使用[ForegroundView](https://github.com/baole/ForegroundView)库

# java - 摇摆卡布局

> ID：10723016
> 
> 赞同：0
> 
> 时间：2012-05-23T15:21:14.367
> 
> 标签：java, swing, indexing, cardlayout

当您添加两张具有相同标识符的卡片时，卡片布局的默认行为是什么。例如，如果`panel1`添加了哪个。稍后在程序中，我添加`panel2`了相同的字符串标识符。卡组中的默认行为是要替换`panel1`的吗？`panel2`谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:56:49.687

下面是由 执行的`CardLayout's`实现。`addLayoutComponent()``addLayoutComponent(Component comp, Object constraints)`

```
public void addLayoutComponent(String name, Component comp) {
    synchronized (comp.getTreeLock()) {
        if (!vector.isEmpty()) {
            comp.setVisible(false);
        }
        for (int i=0; i < vector.size(); i++) {
            if (((Card)vector.get(i)).name.equals(name)) {
                ((Card)vector.get(i)).comp = comp;
                return;
            }
        }
        vector.add(new Card(name, comp));
    }
} 
```

`CardLayout`维护一个`Card`对象向量（见下文）。看起来当检测到名称冲突时，`Component`具有`Card`相同名称的名称被替换为新`Component`添加的名称。因此，`show()`使用特定名称将显示使用该名称添加的***最后一个***组件。

```
class Card implements Serializable {
    static final long serialVersionUID = 6640330810709497518L;
    public String name;
    public Component comp;
    public Card(String cardName, Component cardComponent) {
        name = cardName;
        comp = cardComponent;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:29:53.377

您*可以*添加多张具有相同标识符的卡片。您只能 [edit]***仍然***~~[~~ /edit] 导航到~~两者~~。 `show(Container, String)`显示面板添加 [edit] ~~first~~ ***last*** [/edit]。

卡斯帕

# ffmpeg - 如何通过 UDP 发送 MPEGTS 流

> ID：10723017
> 
> 赞同：6
> 
> 时间：2012-05-23T15:21:18.283
> 
> 标签：ffmpeg, udp, video-streaming, vlc, mpeg2-ts

我正在开发一个实时视频流系统，它基本上由一个服务器和几个客户端组成。

现在，让我们忽略数据包是如何在服务器和客户端之间转发的，让我们只关注**服务器如何通过 UDP 数据包发送 MPEGTS 流**。

流以 MPEGTS 格式编码。

我要做的是读取一些数据包（主要问题是“多少？”）并将它们封装在 UDP 数据包中。目的地（客户端）读取这些 UDP 数据包，然后将它们转发给 VLC，VLC 能够通过读取 UDP 数据包来播放 MPEGTS 网络流。

**如果我只发送视频数据包，一切正常**，相反，如果我尝试将一些视频数据包和一些音频数据包封装在同一个 UDP 数据包中，VLC 将无法解码和播放流。我在某处读到每个 UDP 数据包应包含 7 个 TS 数据包，但不幸的是，即使我遵守此规则，VLC 也无法正确解码流。

这是我的程序的示例代码：http: [//pastebin.com/evMi6FkY](http://pastebin.com/evMi6FkY)

**我应该如何将 MPEGTS 数据包封装在 UDP 数据包中？**

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T19:29:28.397

您的问题是：“让我们忽略数据包在服务器和客户端之间的转发方式”。

UDP 要求您处理网络传输的所有问题，包括流量控制、错误检测和恢复、路径最大传输单元大小、打包、缓冲、序列化、重复数据删除等。

即使您将数据分成大小合适的数据包并以合适的速率发送，一些数据仍然会丢失、重复或乱序传送。你的代码必须处理所有这些条件，否则你不能相信你收到的就是你发送的。

在这种特殊情况下，我猜你的数据包已经变得太大，导致碎片和高丢弃率。一般来说，每个数据包最好不要超过 1400 字节左右。但是不正确的排序、丢失和重复也都是可能的，并且当您尝试发送大量数据时，所有这些都变得更有可能。

*免责声明：我在一家生产商业 UDP 数据传输软件的公司工作。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-24T06:56:38.770

您可以尝试[https://github.com/KwikFlixTV/kwik-udp-send](https://github.com/KwikFlixTV/kwik-udp-send) 它使用 ts 或 FIFO 文件并发送恒定比特率流。

重要功能列表：

*   将 ts 文件作为 ts udp 流发送

*   如果没有要发送的文件，则发送空包

*   与实时进程/线程优先级一起使用以提供流的稳定性

*   适用于 FIFO 文件

*   将文件读取到带有累积部分的缓存缓冲区以提供流的稳定性

# java - @RequiredStringValidator 使用表达式

> ID：10723020
> 
> 赞同：0
> 
> 时间：2012-05-23T15:21:23.010
> 
> 标签：java, jakarta-ee, struts2, annotations

我正在使用 struts 2 和验证注释。如果另一个是真或假，我需要验证一个必需的字段。我正在使用@RequiredStringValidator，但我意识到这个注释没有表达式属性。

```
 @Validations(requiredStrings =
{@RequiredStringValidator(type = ValidatorType.SIMPLE, fieldName = "username", message = "El Usuario es requerido",key="security.admin.user.username.required"),
 @RequiredStringValidator( type = ValidatorType.SIMPLE, fieldName = "password", message = "El Password es requerido",key="security.admin.user.password.required")}... 
```

要验证的字段是“password”，但仅当“autoGeneratePassword”字段为 false 时才需要。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:50:03.467

对于需要表达式评估的验证，不要使用 Simple`RequiredStringValidation`而是可以使用[`FieldExpressionValidator`](http://struts.apache.org/2.0.8/struts2-core/apidocs/com/opensymphony/xwork2/validator/validators/FieldExpressionValidator.html)或[`ExpressionValidator`](http://struts.apache.org/2.0.14/struts2-core/apidocs/com/opensymphony/xwork2/validator/annotations/ExpressionValidator.html)

一种使用方式：

```
@FieldExpressionValidator(fieldName="password",key="security.admin.user.password.required",message="El Password es requerido",expression="checkAutoPassword()")

private boolean checkAutoPassword(){
  return false;
} 
```

您可以使用 OGNL 表达式来执行相同的操作。

# android - 用于 Droid 的 Mono：缺少 __ANDROID__ 符号

> ID：10723029
> 
> 赞同：2
> 
> 时间：2012-05-23T15:21:57.430
> 
> 标签：android, compilation, mono, conditional, symbols

在这个有趣的网络研讨会中：

[http://www.youtube.com/watch?v=WkNbRUqnSSc](http://www.youtube.com/watch?v=WkNbRUqnSSc)

演讲者谈到了可以帮助开发人员编写更清晰的跨平台代码的`__ANDROID__`符号（*以及更具体的每个操作系统版本的其他符号）。*

我已经使用 MonoDevelop 2.8（在 MacOS X 下）创建了一个项目，并且该符号似乎没有在项目中定义。

调查这个问题时，我注意到定义符号（*使用项目属性面板*）在 MonoDevelop 中并不总是有效，而且它们经常用颜色编码创建奇怪的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T14:20:58.307

这是当前 MonoDevelop 环境中的一个小故障。__ANDROID__ 是在低级构建过程中定义的，而不是在 csproj 中定义的。所以代码会编译OK，但是编辑器会很糊涂。

我用 Xamarin 创建了一个[错误/增强请求](https://bugzilla.xamarin.com/show_bug.cgi?id=7397)，因为这可能会绊倒新手（它让我！）。

monodroid 邮件列表中的这个[线程有更多信息。](http://mono-for-android.1047100.n5.nabble.com/Conditional-Compilation-Symbols-td5711427.html)

由于每个平台都有唯一的 csproj 文件——即使是共享代码——我只需创建自己的符号来解决这个问题。在 MonoDevelop 中：项目属性，Build->Compiler，Define Symbols。

# javascript - JQuery 函数绑定到 body 节点的单击事件，并立即执行另一个单击事件

> ID：10723031
> 
> 赞同：0
> 
> 时间：2012-05-23T15:22:02.737
> 
> 标签：javascript, jquery, click, bind

```
$().ready(function(){
    $("#move-to").click(function(){
        $("body").bind("click",function(){
            alert("foo");
        });
    }); 
}); 
```

为什么单击“移动到”后立即看到警报（“foo”）？
当我在文档中的某个 div 上绑定“警报”时，一切正常。
可以来人帮忙吗？
我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:24:03.367

处理程序运行后`#move-to`，单击事件会冒泡到`<body>`，触发您刚刚绑定的处理程序。

您可以通过调用来防止这种情况发生`e.stopPropagation()`。

`<body>`或者，您可以在此事件循环之后通过将 移动`bind()`到`setTimeout`调用来绑定单击事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:25:21.423

```
$().ready(function(){
    $("#move-to").click(function(e){
      e.stopPropagation();
      $("body").bind("click",function(){
       alert("foo");
      });      
    }); 
}); 
```

但是我认为您在单击时一次又一次地对单击事件进行代码绑定，`#move-to`如果您不在其他地方取消绑定该单击事件，这并不好。

# sql-server-2008 - 如何加快 SQL 脚本的更新速度

> ID：10723033
> 
> 赞同：1
> 
> 时间：2012-05-23T15:22:07.430
> 
> 标签：sql-server-2008, sql-update

我在下面编写了一个 SQL 脚本，但我在运行速度方面遇到了问题。在“使用销售数据更新购买”部分之前都可以。更新@Results 表需要很长时间。有什么办法可以加快速度吗？

```
USE [IV7]
GO
/*-------------------------------------------------------------------------------------    -----------------
Declare all variables
---------------------------------------------------------------------------------------    ---------------*/
DECLARE @StartDateTime  DATETIME
DECLARE @EndDateTime    DATETIME
DECLARE @l_Section      VARCHAR(100)
DECLARE @Debug          CHAR(1)

DECLARE @Worktable  TABLE
(
    PortfolioID     VARCHAR(20)
,   SettlementDate  DATETIME
,   ContractDate    DATETIME
,   BrokerCode      VARCHAR(100)
,   [Broker]        VARCHAR(100)
,   Currency        CHAR(3)
,   TransCode       CHAR(3)
,   TransactionType CHAR(3)
,   Nominal         DECIMAL(22,3)
,   ForwardRate     DECIMAL(22,8)
,   SpotRate        DECIMAl(22,8)
,   DealID          VARCHAR(20)     -- ThinkFolio ID
,   TranID          VARCHAR(20)      
,   TranType        CHAR(3)
,   RKSTranID       VARCHAR(16)     -- This is the RKS transaction number.  It is unique per transaction in RKS, but multi-leg transactions will have same value, allowing us to link them together (e.g. FX's, etc)
,   USDSPOTRate     FLOAT
,   BuyNominalUSD   DECIMAL(22,3)
)

DECLARE @Results    TABLE
(
    PortfolioID     VARCHAR(20)
,   SettlementDate  DATETIME
,   ContractDate    DATETIME
,   BrokerCode      VARCHAR(100)
,   [Broker]        VARCHAR(100)
,   BuyCurrency     CHAR(3)
,   BuyNominal      DECIMAL(22,3)
,   SellCurrency    CHAR(3)
,   SellNominal     DECIMAL(22,3)
,   MarketValue     DECIMAL(22,3)
,   ForwardRate     DECIMAL(22,8)
,   SpotRate        DECIMAL(22,8)
,   DealID          VARCHAR(20)     
,   RKSTranID       VARCHAR(16)         -- Not used for final output
,   BuyNominalUSD   DECIMAL(22,3)       
)

DECLARE @FX TABLE 
(   
    RateDate        DATETIME
,   BaseCCY         CHAR(3)
,   RateCCY         CHAR(3)
,   MDInd           CHAR(1)
,   Rate            FLOAT
,   RateType        VARCHAR(10)     
)
/*--------------------------------------------------------------------------------------------------------------------------------
Set default values
--------------------------------------------------------------------------------------------------------------------------------*/
SET @l_Section = 'Setting Default Values'
SET @StartDateTime = '2011-04-01 00:00:00.000'
SET @EndDateTime = '2012-03-31 23:59:59.000'
SET @Debug = 'Y'

IF @Debug = 'Y'
BEGIN
    SELECT @l_Section
    SELECT @StartDateTime AS StartDate, @EndDateTime AS EndDate
END
/*--------------------------------------------------------------------------------------------------------------------------------
Insert into FX
--------------------------------------------------------------------------------------------------------------------------------*/  
INSERT INTO @FX 
SELECT * FROM fn_Generic_FXRates ('2011-04-01','2012-03-31','D','SPOT','USD','999')
/*--------------------------------------------------------------------------------------------------------------------------------
Insert values into @WorkTable
--------------------------------------------------------------------------------------------------------------------------------*/
SET @l_Section = 'Insert values into @WorkTable'

BEGIN
INSERT INTO @WorkTable
SELECT 
    t.acct_id                                   AS PortfolioID
,   t.cntrct_pay_tms                            AS SettlementDate
,   t.trd_ex_eff_tms                            AS ContractDate
,   t.trd_brkr_mnem                             AS BrokerCode
,   t.trd_brkr_nme                              AS Broker
,   t.local_curr_cde                            AS Currency
,   t.trn_cl_cde                                AS TransCode
,   t.trn_cde                                   AS TransactionType
,   t.quantity                                  AS Nominal
,   CASE
        WHEN t.trn_cde IN ( 'FFB','FFS') THEN 
        t.fld4_rte  ELSE NULL
    END                                         AS ForwardRate
,   CASE
        WHEN t.trn_cde IN ( 'FSB','FSS') THEN 
        t.fld4_rte  ELSE NULL
    END                                         AS Spot
,   t.exec_trd_id                               AS DealID
,   t.actg_trn_id                               AS TranID
,   t.trn_cde                                   AS TranType
,   t.deal_id                                   AS RKSTranID
,   fx.rate                                     AS USDSPOTRate
,   CASE
        WHEN t.trn_cde IN ('FFB','FSB') THEN t.quantity * fx.rate
        ELSE 0
    END                                         AS BuyNominalUSD

FROM tranevent_dg AS t

INNER JOIN issue_dg AS i
     ON i.instr_id = t.instr_id
    AND i.iss_typ = 'FFX'

INNER JOIN @FX AS fx
            ON fx.RateCCY = t.local_curr_cde
            AND fx.RateDate = t.trd_ex_eff_tms

WHERE t.exec_trd_id IS NULL
  AND t.inq_basis_num = 1
  AND t.trd_ex_eff_tms BETWEEN @StartDateTime AND @EndDateTime

ORDER BY t.deal_id

END

IF @Debug = 'Y'
BEGIN
    SELECT @l_Section
    SELECT * FROM @WorkTable
    ORDER BY RKSTranID 
END
/*--------------------------------------------------------------------------------------------------------------------------------
Insert Buy values into @Results
--------------------------------------------------------------------------------------------------------------------------------*/
SET @l_Section = 'Insert Buy values into @Results'

BEGIN
INSERT INTO @Results
SELECT 
    w.PortfolioID       AS PortfolioID
,   CONVERT(VARCHAR(10),w.SettlementDate,112)   AS SettlementDate
,   CONVERT(VARCHAR(10),w.ContractDate,112)     AS ContractDate
,   w.BrokerCode        AS BrokerCode
,   w.Broker            AS Broker
,   w.Currency          AS BuyCurrency
,   w.Nominal           AS BuyNominal
,   NULL                AS SellCurrency
,   NULL                AS SellNominal
,   NULL                AS MarketValue
,   w.ForwardRate       AS ForwardRate
,   w.SpotRate          AS SpotRate
,   w.DealID            AS DealID
,   w.RKSTranID         AS RKSTranID
,   w.BuyNominalUSD     AS BuyNominalUSD

FROM @WorkTable AS w
WHERE w.TranType IN ('FFB','FSB')
ORDER BY w.RKSTranID

END

IF @Debug = 'Y'
BEGIN
    SELECT @l_Section
    SELECT * FROM @Results
    ORDER BY RKSTranID
END

/*--------------------------------------------------------------------------------------------------------------------------------
Update Buys with sales data
--------------------------------------------------------------------------------------------------------------------------------*/  
SET @l_Section = 'Update Buys with sales data'

BEGIN
UPDATE @Results
SET
    SellCurrency = wtSell.Currency
,   SellNominal = wtSell.Nominal

FROM @Results AS r

LEFT OUTER JOIN @WorkTable AS wtSell
 ON wtSell.PortfolioID = r.PortfolioID
AND wtSell.RKSTranID = r.RKSTranID
AND wtSell.TranType IN ('FFS','FSS')

END

IF @Debug = 'Y'
BEGIN
    SELECT @l_Section
    SELECT * FROM @Results
    ORDER BY RKSTranID
END
/*--------------------------------------------------------------------------------------------------------------------------------
Final Select
--------------------------------------------------------------------------------------------------------------------------------*/  
SET @l_Section = 'Final Output Select'

SELECT  
PortfolioID     AS [Portfolio ID]
,   SettlementDate  AS [Settlement Date]
,   ContractDate    AS [Contract Date]
,   BrokerCode      AS [BrokerCode]
,   Broker          AS [Broker]
,   BuyCurrency     AS [Buy Ccy]
,   BuyNominal      AS [Buy Nominal]
,   BuyNominalUSD   AS [Buy Nominal USD]
,   SellCurrency    AS [Sell Ccy]
,   SellNominal     AS [Sell Nominal]
,   MarketValue     AS [Market Value]
,   ForwardRate     AS [Forward Rate]
,   SpotRate        AS [Spot Rate]
,   DealID          As [Deal ID]

 FROM @Results

ORDER BY DealID 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:24:02.380

只是为了好玩 - 看看如果你在 INSERT、UPDATE、SELECT 语句中删除每一次出现的 ORDER BY 子句会发生什么。

正如所评论的那样，您应该真正尝试放松表变量并使用添加了适当索引的适当（临时）表。

或者

这个怎么样？我基本上将您所有的 SQL 合二为一。显然我无法测试它的准确性，但也许这会给你一些想法。您比我们更了解您的表和数据，也许您可​​以酌情删除不必要的 SQL。

```
SELECT 
    w.PortfolioID       AS PortfolioID
    ,   CONVERT(VARCHAR(10),w.SettlementDate,112)   AS SettlementDate
    ,   CONVERT(VARCHAR(10),w.ContractDate,112)     AS ContractDate
    ,   w.BrokerCode        AS BrokerCode
    ,   w.Broker            AS Broker
    ,   w.Currency          AS BuyCurrency
    ,   w.Nominal           AS BuyNominal
    ,   wtSell.Currency     AS SellCurrency -- wtSell 
    ,   wtSell.Nominal      AS SellNominal -- wtSell
    ,   NULL                AS MarketValue
    ,   w.ForwardRate       AS ForwardRate
    ,   w.SpotRate          AS SpotRate
    ,   w.DealID            AS DealID
    ,   w.RKSTranID         AS RKSTranID
    ,   w.BuyNominalUSD     AS BuyNominalUSD
FROM 
(
    SELECT 
        t.acct_id                                   AS PortfolioID
        ,   t.cntrct_pay_tms                            AS SettlementDate
        ,   t.trd_ex_eff_tms                            AS ContractDate
        ,   t.trd_brkr_mnem                             AS BrokerCode
        ,   t.trd_brkr_nme                              AS Broker
        ,   t.local_curr_cde                            AS Currency
        ,   t.trn_cl_cde                                AS TransCode
        ,   t.trn_cde                                   AS TransactionType
        ,   t.quantity                                  AS Nominal
        ,   CASE WHEN t.trn_cde IN ('FFB','FFS') THEN t.fld4_rte ELSE NULL END AS ForwardRate
        ,   CASE WHEN t.trn_cde IN ('FSB','FSS') THEN t.fld4_rte ELSE NULL END AS Spot
        ,   t.exec_trd_id                               AS DealID
        ,   t.actg_trn_id                               AS TranID
        ,   t.trn_cde                                   AS TranType
        ,   t.deal_id                                   AS RKSTranID
        ,   fx.rate                                     AS USDSPOTRate
        ,   CASE WHEN t.trn_cde IN ('FFB','FSB') THEN t.quantity * fx.rate ELSE 0 END AS BuyNominalUSD
    FROM 
        tranevent_dg AS t
    INNER JOIN 
        issue_dg AS i ON i.instr_id = t.instr_id AND i.iss_typ = 'FFX'
    INNER JOIN 
        @FX AS fx ON fx.RateCCY = t.local_curr_cde AND fx.RateDate = t.trd_ex_eff_tms
    WHERE 
        t.exec_trd_id IS NULL
    AND 
        t.inq_basis_num = 1
    AND 
        t.trd_ex_eff_tms BETWEEN @StartDateTime AND @EndDateTime
) AS w
LEFT JOIN
(
    SELECT 
        t.acct_id                                   AS PortfolioID
        ,   t.cntrct_pay_tms                            AS SettlementDate
        ,   t.trd_ex_eff_tms                            AS ContractDate
        ,   t.trd_brkr_mnem                             AS BrokerCode
        ,   t.trd_brkr_nme                              AS Broker
        ,   t.local_curr_cde                            AS Currency
        ,   t.trn_cl_cde                                AS TransCode
        ,   t.trn_cde                                   AS TransactionType
        ,   t.quantity                                  AS Nominal
        ,   CASE WHEN t.trn_cde IN ('FFB','FFS') THEN t.fld4_rte ELSE NULL END AS ForwardRate
        ,   CASE WHEN t.trn_cde IN ('FSB','FSS') THEN t.fld4_rte ELSE NULL END AS Spot
        ,   t.exec_trd_id                               AS DealID
        ,   t.actg_trn_id                               AS TranID
        ,   t.trn_cde                                   AS TranType
        ,   t.deal_id                                   AS RKSTranID
        ,   fx.rate                                     AS USDSPOTRate
        ,   CASE WHEN t.trn_cde IN ('FFB','FSB') THEN t.quantity * fx.rate ELSE 0 END AS BuyNominalUSD
    FROM 
        tranevent_dg AS t
    INNER JOIN 
        issue_dg AS i ON i.instr_id = t.instr_id AND i.iss_typ = 'FFX'
    INNER JOIN 
        @FX AS fx ON fx.RateCCY = t.local_curr_cde AND fx.RateDate = t.trd_ex_eff_tms
    WHERE 
        t.exec_trd_id IS NULL
    AND 
        t.inq_basis_num = 1
    AND 
        t.trd_ex_eff_tms BETWEEN @StartDateTime AND @EndDateTime
) wtSell ON wtSell.PortfolioID = r.PortfolioID AND wtSell.RKSTranID = r.RKSTranID AND wtSell.TranType IN ('FFS','FSS')
WHERE 
    w.TranType IN ('FFB','FSB')
order by 
    w.DealID 
```

您可以通过简单地将 SQL 的输出与此组合语句进行比较来测试其准确性。

# java - Java：在运行全屏应用程序时使用机器人

> ID：10723034
> 
> 赞同：4
> 
> 时间：2012-05-23T15:22:10.920
> 
> 标签：java, awt, fullscreen, awtrobot

我在 Java 中遇到了 Robot 类的问题：当我运行全屏游戏时，它有时不起作用。这是我的代码：

```
Toolkit tlkt = Toolkit.getDefaultToolkit();
Robot bot = new Robot();
while(true) {
    Thread.sleep(3000);
    tlkt.beep(); //make sure that program still runs
    bot.mousePress(MouseEvent.BUTTON1_DOWN_MASK);
    bot.mouseRelease(MouseEvent.BUTTON1_DOWN_MASK);
} 
```

我想每 3 秒左击一次并确定发出哔哔声。它工作正常，但是当我运行一些全屏应用程序时，它只是发出哔哔声但没有点击。

我已经尝试将 Robot 声明移动到循环中，因此每次都会创建新的 Robot，但没有成功。

我已经在 5 款不同的游戏上尝试过，其中 3 款即使在全屏下也能正常工作，但在 2 款上却没有用，只是发出哔哔声。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T17:33:59.130

假设您在 Windows 机器上，对调用的`java.awt.Robot`调用被重定向到`sun.awt.windows.WRobotPeer`，而后者又调用`awt_Robot.cpp`. 您可以在这里查看源代码`awt_Robot.cpp`：[http ://www.koders.com/cpp/fidFFE004659A9CAB3DA2B3302C457E624AF6F3EEDF.aspx?s=GetDIBits#L232](http://www.koders.com/cpp/fidFFE004659A9CAB3DA2B3302C457E624AF6F3EEDF.aspx?s=GetDIBits#L232)

这里可以看到鼠标事件是通过win32调用实现的`mouse_event(...)`（在winuser.h中定义）

因此，您的机器人鼠标点击调用受到`mouse_event(...)`.

然后在谷歌上搜索一下，发现有些游戏有某种宏观保护机制。他们忽略`mouse_event(...)`路由方法并直接与驱动程序对话。例如，Hackshield 为许多游戏提供了这种保护机制。所以这就是为什么有些游戏没有收到你的机器人鼠标点击的原因。

# android - 在动画期间查看隐藏

> ID：10723038
> 
> 赞同：1
> 
> 时间：2012-05-23T15:22:19.450
> 
> 标签：android, animation

我有一个包含两个 FrameLayouts（f1 和 f2）的 xml 布局。F1 填满屏幕的所有区域， f2 通过使用 android:layout_marginBottom="-900dp" 隐藏在屏幕下方。布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/llMainLayout" 
    android:orientation="vertical">
    <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical">
        <FrameLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
            android:id="@+id/f1" android:background="@color/white">

            <fragment
                android:id="@+id/leftsidefragment"
                android:name="de.com.fragments.ChapterDescriptionPageFragment"
                android:layout_width="match_parent"
                android:layout_height="fill_parent"/>

        </FrameLayout>

        <FrameLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:id="@+id/flRightWindowPart" 
            android:background="@android:color/transparent"
            android:layout_gravity="bottom">

            <fragment
                android:id="@+id/f2"
                android:name="de.com.fragments.ChapterSubchaptersListFragmentWithHeader"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"/>

        </FrameLayout>
    </FrameLayout>
</LinearLayout> 
```

然后我做平移动画：f2 上升。一切正常，除了一个问题 - f2 在动画期间是不可见的。构造动画的方法代码：

```
public Animation constructSlideUpAnimation(boolean inverse){
    if (inverse)
        return new TranslateAnimation(
                  Animation.ABSOLUTE, 0.0f, Animation.ABSOLUTE, 0.0f,
                  Animation.ABSOLUTE, 0.0f, Animation.ABSOLUTE, 900
              );
    else
        return new TranslateAnimation(
                  Animation.ABSOLUTE, 0.0f, Animation.ABSOLUTE, 0.0f,
                  Animation.ABSOLUTE, 0.0f, Animation.ABSOLUTE, -900
              );
} 
```

如果您需要其他一些代码块，请编写。我真的很感激任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T08:54:11.133

通过添加将第二个片段（f2）的高度设置为值的代码解决了这个问题，这将在动画完成后

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:30:39.883

我不确定，但您必须以毫秒为单位设置动画对象的持续时间。

# css - 智能手机网页设计 - 像素大小

> ID：10723039
> 
> 赞同：11
> 
> 时间：2012-05-23T15:22:25.887
> 
> 标签：css, mobile, pixel

我需要有人帮助澄清我对高密度屏幕新手机像素大小的理解。因为，它在我的网页设计中加入了一个曲线球。

我对智能手机的最初理解是像素大小大约为 480 x 320，这使得设计变得容易，因为像素仍然是相同的像素。

然而，一些智能手机是这个的两倍（或更多）。我相信 iPhone 确实是 960 x 640 的两倍。我的 Galaxy Nexus 是 1280 x 720。

现在，这在使用 %'s 时工作得很好。但是，有很多事情我想使用修复像素值。例如，许多高度值不需要在 %s 中。另外，如果高度是固定的，一些项目，比如标志、图标、一些图片，我不想在宽度变宽时被拉伸……所以这些需要一个一致的值。

但是，当像素不是真正一致的物理测量时，我该如何处理？

使用示例时更容易，因此如果有人可以向我解释，请以图标为例。

当我在手机上登录 Facebook 时，我会在导航栏中看到这三个通知图标（好友请求、消息和其他内容）。这些是固定的。无论我的手机是直立的还是侧放的，它们的尺寸都是一样的。唯一随宽度变化的是......之间的空间......基本上是我正在工作的东西。

这些图标的尺寸是多少？一方面，我知道标准图标通常是 16x16。那么，这些高密度智能手机是否需要 32x32？但是，它们似乎也与我在桌面上看到的 16x16 图标大小不同。它们看起来可能更像 12x12。所以，不确定，但我认为智能手机和台式机的“标准”图标大小不同（那会是什么？）。

无论如何，我已经有 CSS 标识正在使用手机来实现我的移动布局。但是，我必须更进一步让它识别像素密度，然后将我的固定值调整为，在这种情况下，加倍吗？还是有另一种/更好的方法？

任何和所有的帮助表示赞赏。我有点难过，关于这方面的信息并不多。感谢和抱歉冗长的帖子！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T15:48:21.630

设备的像素密度列表：http: [//www.binvisions.com/articles/tablet-smartphone-resolutions-screen-size-list/](http://www.binvisions.com/articles/tablet-smartphone-resolutions-screen-size-list/)您的问题可能是比率的变化。

这是一篇不错的文章，涵盖了我个人喜欢参考的一些响应式研究

[http://coding.smashingmagazine.com/2011/01/12/guidelines-for-responsive-web-design/](http://coding.smashingmagazine.com/2011/01/12/guidelines-for-responsive-web-design/)

跳到最后；例如，iPhone 4 Retina 显示屏是像素密度的两倍，这是上面针对它的文章中的一个示例（尚未测试） [http://thomasmaier.me/blog/2010/06/23/css-for- iphone-4-视网膜显示/](http://thomasmaier.me/blog/2010/06/23/css-for-iphone-4-retina-display/)

另一篇文章提供了一些关于必须使用不同 ppi 制作 2 张图像的信息 [http://bjango.com/articles/designingforretina/](http://bjango.com/articles/designingforretina/)

我个人使用 Twitter 的 Bootstrap 及其响应式插件来使用 CSS 进行设计布局：http: [//twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

# javascript - 帮我在 Facebook Javascript SDK 中构建一个函数

> ID：10723042
> 
> 赞同：0
> 
> 时间：2012-05-23T15:22:29.443
> 
> 标签：javascript, facebook, facebook-graph-api, dom-events

我正在尝试构建一个 Facebook 应用程序，我需要在其中提取不喜欢某个页面的朋友的 id。

到目前为止，我已经使用下面的函数提取了我所有的朋友 ID。

我需要生成一个代码来构建另一个 API，该 API 使用我朋友的 id 来获得他们的喜欢..

```
function loadFriends()
{
    //get array of friends
    FB.api('/me/friends', function(response) {
        console.log(response);
 var testdiv = document.getElementById("test");
        for(i=0;i<response.data.length;i++)
            {
                 testdiv.innerHTML +=  response.data[i].id + '<br/>' ;
            }
    });
} 
```

我需要得到类似的东西：

```
 FB.api('/response.data[i].id/likes', function(response) { 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:26:23.480

你可以这样做

```
FB.api({
            method: 'fql.query',
            query: 'SELECT first_name, last_name, pic_big FROM USER WHERE uid IN ( SELECT uid FROM page_fan WHERE page_id=' + page_id + ' AND uid IN ( SELECT uid2 FROM friend WHERE uid1 = me() ) )'
        }, function(response){

//you get the friends who liked this page. now you can remove these ids from friends lists to get you result.
}); 
```

# javascript - blur() 不能以编程方式工作 | 但是当从用户发起时

> ID：10723043
> 
> 赞同：4
> 
> 时间：2012-05-23T15:22:31.073
> 
> 标签：javascript

这适用于在用户通过 ajax 在单个输入表单上提交后清除输入。

```
var tweet_input = document.getElementById( 'tweet_input' );
tweet_input.value='';
tweet_input.blur(); 
```

但是，在 3 个输入字段 orm 上，这不会：

```
var input_url = document.getElementById( 'bookmark_input_url' );
    input_url.value='';
var input_title = document.getElementById( 'bookmark_input_title' );
    input_title.value='';
var input_tag = document.getElementById( 'bookmark_input_tag' );
    input_tag.value='';

input_title.blur();
input_url.blur();
input_tag.blur(); 
```

只有最后一个元素实际上是模糊的。不确定其他两个发生了什么或如何进行故障排除。

基本上我有在 blur() 上触发的事件侦听器，它们在实际用户 blur() 上工作正常，但是当我尝试以编程方式启动它们时，只有一个有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T15:29:30.233

需要先有重点。

```
input_title.focus();
input_title.blur();
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-27T08:48:28.487

这在我的情况下很好用：

```
const fireEvent = (element, eventType="blur") => element && element.dispatchEvent(new Event(eventType)); 
```

现在我们可以从任何我们想要触发附加到任何元素的事件的地方调用这个函数。

```
fireEvent(input_title) 
```

[参考](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent)

# .net - NancyFX：反序列化 JSON

> ID：10723044
> 
> 赞同：7
> 
> 时间：2012-05-23T15:22:32.920
> 
> 标签：.net, json, rest, nancy

该文档建议 NancyFx 帮助我完成 json 请求正文的 WRT 反序列化，但我不确定如何。请参阅下面的测试以演示：

```
[TestFixture]
public class ScratchNancy
{
    [Test]
    public void RootTest()
    {
        var result = new Browser(new DefaultNancyBootstrapper()).Post(
            "/",
            with =>
                {
                    with.HttpRequest();
                    with.JsonBody(JsonConvert.SerializeObject(new DTO {Name = "Dto", Value = 9}));
                });

        Assert.AreEqual(HttpStatusCode.OK, result.StatusCode);
    }

    public class RootModule : NancyModule
    {
        public RootModule()
        {
            Post["/"] = Root;
        }

        private Response Root(dynamic o)
        {
            DTO dto = null;//how do I get the dto from the body of the request without reading the stream and deserializing myself?

            return HttpStatusCode.OK;
        }
    }

    public class DTO
    {
        public string Name { get; set; }
        public int Value { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-23T15:38:41.433

[模型绑定](https://github.com/NancyFx/Nancy/wiki/Model-binding)

```
var f = this.Bind<Foo>(); 
```

编辑（为了这个问题的其他读者的利益，把上面放在上下文中）

```
public class RootModule : NancyModule
{
    public RootModule()
    {
        Post["/"] = Root;
    }

    private Response Root(dynamic o)
    {
        DTO dto = this.Bind<DTO>(); //Bind is an extension method defined in Nancy.ModelBinding

        return HttpStatusCode.OK;
    }
} 
```

# .net - 取消 BackgroundWorker - Windows 窗体 (C++/CLI)

> ID：10723045
> 
> 赞同：0
> 
> 时间：2012-05-23T15:22:33.343
> 
> 标签：.net, winforms, c++-cli, backgroundworker

我`CancelAsync()`在按钮单击事件上触发方法以在我的 Windows 窗体代码中停止后台工作人员。以下是示例代码，

```
// Windows Form

private: System::Void startButton_Click(System::Object^  sender, System::EventArgs^  e) {
        testBgWorker->RunWorkerAsync();
        }

private: System::Void testBgWorker_DoWork(System::Object^  sender, System::ComponentModel::DoWorkEventArgs^  e) {

            CalculateDistance* calcDistance = new CalculateDistance();
        calcDistance->doCalculations();
         }

private: System::Void stopButton_Click(System::Object^  sender, System::EventArgs^  e) {

            testBgWorker->CancelAsync();
         }

// CalculateDistance.cpp   

void CalculateDistance::doCalculations() {
    for (int i=0; i<1000, i++) 
    {
        // some calculations here
    }
} 
```

如何取消 BackgroundWorker（退出`for`循环）？`CancelAsync()`似乎没有做这项工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T18:43:21.930

您需要在 CalulateDistance 循环中检查取消。在 C# 中，它看起来像这样。msdn.microsoft.com 上有一些很好的例子。并且您需要将 backgoundworker 标记为支持取消。

```
 if (worker.CancellationPending)
        {
            e.Cancel = true;
            return "cancelled";
        } 
```

# matlab - 在 for 循环中计算（求和）错误 - MATLAB

> ID：10723046
> 
> 赞同：0
> 
> 时间：2012-05-23T15:22:34.430
> 
> 标签：matlab, loops, for-loop

我在比较两个函数，一个是解析解（直接出自教科书），另一个是使用我收集的实验数据。

我需要计算两者之间的误差。这是我的方法：

```
 voltage_experimental_offset = xlsread('R21_C19_L21.xlsx','H118:H259'); 
trigger_experimental = xlsread('R21_C19_L21.xlsx','D118:D259'); 
t_experimental = xlsread('R21_C19_L21.xlsx','G118:G259'); 

ii = length(voltage_experimental_offset);   
total = 0;

for i = 1:ii
error = (voltage_experimental_offset(i) - V_C(i)').^2;  % compute error
total = sum(error(:))                                   % sum error

end 
```

问题是“总数”每次都显示“错误”。 **我想为每次迭代添加错误**

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:28:16.757

您需要索引错误

```
error = zeros(size(voltage_experimental_offset));
for i = 1:ii
error(i) = (voltage_experimental_offset(i) - V_C(i)').^2;  % compute error
total = sum(error(:))                                   % sum error

end 
```

# iphone - startMonitoringForRegion 并不总是有效

> ID：10723048
> 
> 赞同：1
> 
> 时间：2012-05-23T15:22:35.917
> 
> 标签：iphone, objective-c, ios, ios5, location

我有一个需要使用 StartMonitoringForRegion 的应用程序。当我将以下代码放入应用程序 didFinishLaunchingWithOptions 时，它可以工作。

```
[loc startUpdatingLocation];
CLLocationCoordinate2D coord = CLLocationCoordinate2DMake(21.456372,39.287972);
CLRegion* region = [[CLRegion alloc] initCircularRegionWithCenter:coord radius:200 identifier:@"C"];
[self.locationManager startMonitoringForRegion:region desiredAccuracy:50]; 
```

但是当我在另一个视图中使用相同的代码时，它不起作用！我尝试使用以下代码在主线程上执行代码：

```
if (![NSThread isMainThread])
{
    [self performSelectorOnMainThread:@selector(MonitorRegion:) withObject:pr waitUntilDone:NO];
    return;
} 
```

但它仍然不起作用！

为什么代码会在 didFinishLaunchingWithOptions 而不是其他视图中工作！

是否存在区域监视器可能无法工作的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T08:53:12.710

经过搜索和不同的试验，我想出了如何解决它。

只是为了使 didEnterRegion 和 didExitRegion 工作，该视图必须始终可见并运行。

我将所有内容都移到了 appDelegate，现在它可以工作了。

# django - 在保存之前更改表单实例 Django

> ID：10723054
> 
> 赞同：2
> 
> 时间：2012-05-23T15:22:56.853
> 
> 标签：django, django-models, django-forms

我正在尝试在保存表单之前更改它的实例。我需要在视图中设置某些信息，如下所示：

```
 class UploadedFile(models.Model):

     file = models.FileField(storage=s3store, upload_to=custom_upload_to)
     slug = models.SlugField(max_length=50, blank=True)
     bucket = models.ForeignKey(S3Bucket, blank=False)
     uploaded_by = models.ForeignKey(User, related_name='uploaded_by', blank=False)
     company = models.ForeignKey(Company, blank=False) 
```

--

```
class UploadForm(ModelForm):

    class Meta:
        model = UploadedFile 
```

--

```
form = UploadForm(request.POST, request.FILES)
form.instance.company_id = r_user.company.id
form.instance.uploaded_by_id = r_user.id
form.instance.bucket_id = r_user.company.s3_bucket_id
if form.is_valid():
     form_object = form.save() 
```

现在，我知道该表单无效，因为公司/上传/存储桶是空的：

错误表格：

*   公司*   这是必填栏。*   桶*   这是必填栏。*   上传者*   这是必填栏。

但我确实设置了它们！我是否需要将它们设为空白=True，然后保存（提交=false），更改它们，然后重新保存？如果是，为什么会这样？我确实改变了表格....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T18:23:02.780

尝试这个：

```
data = request.POST.copy()
data['company_id'] = r_user.company.id
data['uploaded_by_id'] = r_user.id
data['bucket_id'] = r_user.company.s3_bucket_id

form = UploadForm(data, request.FILES)
if form.is_valid():
     form_object = form.save() 
```

这样您就可以在创建表单之前设置数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:38:54.030

作业迟到了。在`__init__()`of`ModelForm`或您的代码中：`form = UploadForm(request.POST, request.FILES)`行中，[已创建一个实例并将其填充到`initial`form](https://github.com/django/django/blob/master/django/forms/models.py#L246)。以后对实例的修改不会影响`form.initial`.

此外，如果您想在后端自动填写某些字段，请不要将它们呈现给用户。

因此，是的，您可以制作它们`blank=True`或[将它们从表单中排除，](https://docs.djangoproject.com/en/1.4/topics/forms/modelforms/#using-a-subset-of-fields-on-the-form)然后按照[建议的方式](https://docs.djangoproject.com/en/1.4/topics/forms/modelforms/#the-save-method)进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-17T12:09:55.413

实际上，您在这里做了一些奇怪的事情。

第一：你为什么分配给`company_id`和`uploaded_by_id`？`bucket_id`但是，您的模型中有这些字段-它是为此模型创建的表中的列的名称-您应该在此处直接使用 ORM 功能，例如`form.instance.company = r_user.company`。

第二：表单验证应用于 form.fields 而不是它的实例属性，一旦创建表单并将其绑定到提供的值，您就无法更改它们。

向 Django 中的表单创建的模型实例添加一些字段值的推荐方法（正如我一直认为的那样）是像您一样创建自定义 ModelForm 并在`Meta`类中指定您希望允许用户编辑的所有字段。对于您的情况：

```
class UploadForm(ModelForm):

    class Meta:
        model = UploadedFile
        fields = ('file', 'slug') 
```

然后，而不是打电话给`form_object = form.save()`你 call `form_object = form.save(commit=False)`。现在您的模型实例已经填写了表单中的所有字段，因此您可以添加您想要的内容：例如`form_object.company = r_user.company`。最后不要忘记调用`save()`模型实例本身将其存储在您的数据库中。

该解决方案在[此处的 Django 文档中进行了描述](https://docs.djangoproject.com/en/3.1/topics/forms/modelforms/#selecting-the-fields-to-use)

# android - 在 Android 中的导航堆栈顶部启动活动

> ID：10723058
> 
> 赞同：1
> 
> 时间：2012-05-23T15:23:06.477
> 
> 标签：android, android-intent, android-activity

我正在为[http://ericharlow.blogspot.com/2010/09/experience-multiple-android-activities.html](http://ericharlow.blogspot.com/2010/09/experience-multiple-android-activities.html)中描述的`TabActivity`活动实施解决方案。我意识到这是次优的，但我已经在这条路上走了很远，只剩下一个小问题。我需要弹出到我正在管理的堆栈顶部（使用活动 ID 列表），并且我知道我可以使用以下方法获取此活动：`TabHost``String`

```
Activity current = getLocalActivityManager().getActivity(mIdList.get(0)); 
```

但是，我不知道“显示”的方法`current`。

我知道我可以这样做：

```
Activity current = getLocalActivityManager().getActivity(mIdList.get(1))
current.finish(); 
```

如果堆栈上至少有两个活动，这将产生预期的结果。但是，当只有一个时，它会因`ArrayOutOfBoundsException`.

我如何“显示”给定的活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:57:20.980

尝试以这种方式启动一个始终位于 Activity Stack 顶部的 Activity：

```
List<ActivityManager.RunningTaskInfo> processes1 = activityManager.getRunningTasks(1);
ComponentName componentInfo = processes1.get(0).topActivity;
String classname =processes1.get(0).topActivity.getClassName(); 
String packagename = processes1.get(0).topActivity.getPackageName();
if(classname.equalsIgnoreCase("com.YOUR_PACKAGE_NAME..YOURACTIVITY_NAME"))
    {
        Intent intent24 = new Intent(Intent.ACTION_MAIN).addCategory(
        Intent.CATEGORY_LAUNCHER).setClassName("YOUR_PACKAGE_NAME",
        "com.YOUR_PACKAGE_NAME..YOURACTIVITY_NAME").addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
        .addFlags(Intent.FLAG_FROM_BACKGROUND).setComponent(new ComponentName("YOUR_PACKAGE_NAME",
        "com.YOUR_PACKAGE_NAME..YOURACTIVITY_NAME"));
        getApplicationContext().startActivity(intent24);
    }
    else
    {
     //DONE SOMETHING HERE...
    } 
```

# c++ - 在 VS2010 中加载外部符号

> ID：10723059
> 
> 赞同：1
> 
> 时间：2012-05-23T15:23:10.097
> 
> 标签：c++, visual-studio-2010, openni

我正在尝试调试 OpenNI，所以我下载了源代码，编译，将 OpenNI 项目添加到我现有的解决方案中，包含新的头文件，链接到新编译的库，将 OpenNI 项目引用添加到我现有的项目中，并添加了 .pdb位置到我的 VS 符号位置。

毕竟，我仍然只能在头文件中打断点。每当我在源代码中添加断点时，VS 都会说未加载符号。有什么我没有做/做错的吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:43:03.723

我猜想这些库的 PDB 实际上并没有被加载，或者与您正在加载的 DLL 不匹配。检查 VS10 的输出面板。加载 DLL 时，是否显示“已加载符号”？如果不是，则说明没有找到 PDB，或者找到了错误的 PDB。

（最初是一条评论，应 OP 的要求作为答案发布）。

# java - 使用 Jackson 将 json 转换为 java 对象

> ID：10723060
> 
> 赞同：-1
> 
> 时间：2012-05-23T15:23:10.653
> 
> 标签：java, json, jackson

基于这段 json 需要什么 Jackson POJO 结构？

就像是 ？：

```
class POJO {

    private List<ToAddList> toAdd;
    private List<ToRemoveList> toRemove

}

class ToAddList(){
String name;
int pos;
}

class ToRemoveList(){
String name
}

///////////////////////JSON///////////////////////////
    {
        "toAdd": [
            {
                "name": "test",
                "pos": 0,
            },
            {
                "name": "test",
                "pos": 1,
            },
        ],
        "toRemove": [
            {
                "name": "test"
            },
            {
                "name": "test"
            }
        ]
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:43:40.150

你有一个简单的 bean，它有两个字段，一个字符串和一个数字。此 bean 用于列表中，列表包含在另一个 bean 中：

```
@JsonSerialize(include = JsonSerialize.Inclusion.NON_NULL)
@JsonIgnoreProperties(ignoreUnknown = true)
public class SimpleBean implements Serializable {
    private String name;
    private Integer pos;

    // constructors, getters, setters
}

@JsonSerialize(include = JsonSerialize.Inclusion.NON_NULL)
@JsonIgnoreProperties(ignoreUnknown = true)
public class RequestBean implements Serializable {
    private List<SimpleBean> toAdd;
    private List<SimpleBean> toRemove;

    // constructors, getters, setters
} 
```

而已。

# ruby-on-rails - M. Hartl 的 RoR 书中的练习

> ID：10723061
> 
> 赞同：4
> 
> 时间：2012-05-23T15:23:16.770
> 
> 标签：ruby-on-rails, ruby

我一直在学习 M. Hartl的[Ruby-on-Rails 教程中的练习。](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)我已经完成了第 4 章中的所有练习，但仍然坚持这一点：

> `person1`创建三个名为、`person2`和的散列，在键和`person3`下使用名字和姓氏。然后创建一个散列，即is 、is和is 。例如，验证是否具有正确的值。`:first``:last``params``params[:father]``person1``params[:mother]``person2``params[:child]``person3``params[:father][:first]`

谁能建议如何解决这个问题？在我解决这个问题之前，我不想继续下一章。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-23T15:27:33.270

```
person1 = {:first => 'Al',    :last => 'Bundy'}
person2 = {:first => 'Peggy', :last => 'Bundy'}
person3 = {:first => 'Kelly', :last => 'Bundy'}
params = {
 :father => person1,
 :mother => person2,
 :child  => person3
}
params[:father][:first] #=> 'Al' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-08T20:15:45.337

这是另一种设置参数哈希的方法。我发现来自 javascript 背景的感觉更熟悉：

```
person1 = {first: "Papa", last: "Bear"}
person2 = {first: "Mama", last: "Bear"}
person3 = {first: "Baby", last: "Bear"}
params = {father: person1, mother: person2, child: person3} 
```

# jquery - Uploadify - 更好的上传选择用户体验？

> ID：10723062
> 
> 赞同：0
> 
> 时间：2012-05-23T15:23:19.723
> 
> 标签：jquery, uploadify

我正在尝试为我的用户更好地上传单个文件。我目前使用[Uploadify](http://uploadify.com/)进行所有图像上传。我有一个弹出对话框，其中包含一个 Uploadify 控件和一个文本框，用户可以在其中为图像添加评论。

我已经设置`multi=false`并将`queueSizeLimit=1`Uploadify 限制为每次上传一个文件。因此，如果队列中存在一个文件并且用户尝试选择另一个文件，他/她会收到一条警报消息：`The number of files selected exceeds the remaining upload limit (0)`

我想覆盖此默认行为并替换队列中的文件。（如果当前未上传）。这将是我的用户想要的便利功能。这将防止他们不得不手动取消队列中的文件。

有谁知道如何实现这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T10:52:45.170

这是我的解决方案：

```
var selectedFile = null;
$('#example').uploadify({       
    'swf'           : 'uploadify.swf',
    'uploader'      : 'uploadify.php',
    'cancelImg'     : 'cancel.png',
    'multi'         : false,
    'auto'          : false,
    'onSelect'      : function(file) {
        if(selectedFile !== null) {
            $('#example').uploadify("cancel",selectedFile.id);
        }
        selectedFile = file;
    },
    'onCancel' : function(file) {
        $("#" + file.id).hide();
    }

}); 
```

首先，您在外部范围内设置一个 var 以跟踪选定的一个文件，最初将其设置为 null。

您设置`multi`为 false 以便一次只能选择一个文件，然后`onSelect`在取消上一个排队文件（如果有一个）后使用该函数设置 selectedFile var。

我还在`onCancel`这里设置了函数，因为取消文件默认情况下会将文件标记为已取消，然后在短暂延迟后将其淡出。相反，我们直接隐藏该文件的上传栏，以使文件看起来好像已被换出，而实际上我们正在做的是将另一个文件添加到队列中，然后删除前一个文件。

# javascript - 查找（）不工作

> ID：10723063
> 
> 赞同：0
> 
> 时间：2012-05-23T15:23:21.190
> 
> 标签：javascript, jquery

我正在动态创建一堆`li`元素

```
$.each(data.attributes.listingImages, function (i, obj){
if(i == 1){
   $('#js-carousel-menu').append('<li media class="active"><a media-frame><img class="js-carousel-item" src=" '+obj.thumbnail+ ' " /></a></li>' );
 }else{
   $('#js-carousel-menu').append('<li media><a media-frame><img class="js-carousel-item" src=" '+obj.thumbnail+ ' " /></a></li>' );
} 
```

然后当我尝试搜索“活动”时，`li`它没有找到它

```
$gallery = $(this.el).find('#js-carousel-menu');
var _this = $gallery.find('li.active'); 
```

但是，如果我找出`$gallery`它给我：

```
<ul>
 <li media>...</li>
 <li media class="active">...</li>
 <li media>...</li>
 ...
 <li media>...</li>
</ul> 
```

我错过了什么吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:28:22.200

既然`#js-carousel-menu`是ID，就不用找了，直接选择就行了。检查选择器是否成功。

```
alert($(this.el).find('#js-carousel-menu').length) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:27:42.943

因为 ID 必须是唯一的，`$(this.el).find('#js-carousel-menu');`所以没有用（并且可能是您的问题的原因）：只能有一个`#js-carousel-menu`.

所以，试试：

```
var _this = $('#js-carousel-menu').find('li.active'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:29:28.900

为什么不直接使用 as

> $('#js-carousel-menu>li.active');

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:30:00.937

您正在将活动类添加到**第二个**li 元素（索引 1）。所以我假设你只添加一个 li，这是你没有 li 的方式。积极的

# ios - 有没有办法以编程方式删除/更新 iBooks 中的 pdf？

> ID：10723064
> 
> 赞同：0
> 
> 时间：2012-05-23T15:23:21.213
> 
> 标签：ios, ipad, pdf, ibooks

这里不是很有希望，但我不得不问......如果用户通过我的 iPad 应用程序下载了 pdf 并选择在 iBooks 中打开它（通过应用程序中的一个方便的按钮），有没有一种方法可以以编程方式删除或更新 iBooks 中的 pdf？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T05:16:38.563

不，您无法从 ibook 访问任何信息，因为它处于沙盒模式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-23T15:26:29.707

我相信您正在寻找的是右上角的编辑按钮。

然后选择要删除的那些，然后点击删除按钮。

# asp.net-mvc-3 - ASP.NET MVC 3、实体框架、存储过程和验证

> ID：10723067
> 
> 赞同：1
> 
> 时间：2012-05-23T15:23:31.657
> 
> 标签：asp.net-mvc-3, stored-procedures, entity-framework-4, validation, poco

我是一名 ASP.NET Web 窗体开发人员。我的经理刚刚决定所有未来的项目都将使用 ASP.NET MVC 开发，所以我有很多东西要学得很快！

我们所有的数据操作都是通过内部 DBA 编写的存储过程处理的，我们将使用 EF。我之前在 Web 窗体项目中使用过 EF 来处理这种情况，并且没问题。我为 SP 结果生成复杂类型，并使用 Web 表单验证控件处理验证。

我一直在阅读的 ASP.NET MVC 3 教程和指南使用 EF Code First 并使用数据注释来处理验证，这一切看起来都非常好，但我没有那么奢侈。我查看了一些 Database First 指南，但它们并没有专注于存储过程的独占使用，也不是很有帮助。

我主要担心的是，如果可以避免的话，我不想编写服务器和客户端验证逻辑。我也不断看到很多关于 POCO 类的讨论，但我不确定它们是否适合这种情况，或者它们是否是“代码优先”。

我即将使用 ASP.NET MVC 3 开始我的第一个项目，我有几个问题。

有没有办法可以使用数据注释来处理我的客户端和服务器端验证，如果没有，我最好的选择是什么？

以这种方式使用 EF 时，POCO 类是否有用/相关？

任何人都可以指出一个好的教程/指南的方向和/或给我一些建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:25:42.597

您不必将 EF 与 MVC 一起使用。这只是最常见的情况。如果您打算使用 EF，那么您可能会从使用 EF（使用 ObjectContext，而不是 DbContext）和 DatabaseFirst 方法中获益更多。您的数据库优先方法只需将所有存储过程拖放到设计器中，然后使用存储过程生成对象上下文。您不需要 POCO，因为您不与实体打交道。

您确实需要数据传输对象。EF 将为您生成返回结果（尽管在某些情况下 EF 会感到困惑，您需要帮助它）。它将生成调用查询的方法和传递给查询的参数。

如果您选择不使用 EF，那么您可以使用普通的旧 ADO.NET 并创建一个数据访问层，或者您可以使用 Enterprise Framework Data Access Application Blocks 之类的东西。

关键是，即使教程都使用 EF，您也不必这样做。你可以使用任何你想要的技术。MVC 与数据无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:56:02.807

一般来说，data annotations + jquery.validate 就足够了，如果没有，你可以试试 DataAnotaions.Extensions，如果你喜欢保持验证逻辑和 POCO 类分开，FluentValidation 是一个不错的选择。

教程：

```
 http://www.asp.net/mvc
 search mvcmusicstore  at codeplex.com
 search nerddinner at codeplex.com 
```

# matlab - 在 Matlab 中调整绘图的大小，使图形不会被绘图窗口的边缘截断

> ID：10723072
> 
> 赞同：2
> 
> 时间：2012-05-23T15:23:53.337
> 
> 标签：matlab, user-interface, matlab-figure

我在 Matlab 中创建了一个绘图，但不幸的是绘图的一侧被绘图窗口切断了。这是我用来创建情节的代码：

```
% create a plot with dots and with bold sides
point = num(:, 1);
depth = num(:, 2);
hfig = plot(point, depth, '-s', 'Color', 'k', 'MarkerFaceColor', 'k', 'MarkerEdgeColor', 'k', 'MarkerSize', 10);

% make the outside of the graph bold
set(gca, 'LineWidth', axis_size);
set(gca,'FontSize', ticksize, 'FontName', fontname);
set(gca, 'Position', [0.2 0.2 0.8 0.4])
xlabel('Point Number')
ylabel('Depth (cm)') 
```

这是输出：

![截止图像](../Images/6b230dccb42afcaba2a85fb0a2361c99.png)

注意情节的一侧是如何被切断的。或者，这是一张显示我想要实现的目标的图片：

![我想要达到的目标](../Images/c33bf85afbabeb82de6d1022a90f17c3.png)

我只是在没有调用的情况下创建了绘图`set(gca, 'Position', [0.2 0.2 0.8 0.4])`，然后通过调整窗口大小来调整绘图的大小。

但是我如何在代码中做到这一点？我还想确保我可以将绘图保存为具有相同尺寸的 PNG 文件。我一直在玩弄该`set()`功能的各种组合，但一直无法达到我想要的效果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:33:23.080

尝试设置`OuterPosition`情节。

```
set(gca,'OuterPosition',[0.2 0.2 0.8 0.4]); 
```

下图显示了两者之间的区别：

![在此处输入图像描述](../Images/0897727b6eed526dd7abc6988456a33e.png)

[这](http://www.mathworks.com/help/techdoc/ref/axes_props.html#OuterPosition)是相关的 MathWorks 帮助页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T05:35:38.313

安德烈有最简单的答案，但或者（从长远来看）你可以去文件交换并下载 subaxis.m，它取代了 subplot，甚至对于单轴图也非常棒（你可以定义 LeftMargin 和 RightMargin 等属性和PaddingTop 和 PaddingBottom)

[http://www.mathworks.com/matlabcentral/fileexchange/3696-subaxis-subplot](http://www.mathworks.com/matlabcentral/fileexchange/3696-subaxis-subplot)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:38:16.130

以下文档（[如何使用 Matlab 生成打印时具有正确尺寸的图形](http://itb.biologie.hu-berlin.de/~schaette/HomeFiles/MatlabPlots.pdf)）提供了一些示例代码，可用于以适当的方式调整绘图的大小。

使用了以下代码：

```
point = num(:, 1);
depth = num(:, 2);

hfig = plot(point, depth, '-s', 'Color', 'k', 'MarkerFaceColor', 'k', 'MarkerEdgeColor', 'k', 'MarkerSize', 10);
set(gca, 'LineWidth', axis_size);
set(gca,'FontSize', ticksize, 'FontName', fontname);
set(gcf,'PaperUnits','centimeters')
xSize = 30; ySize = 5;
xLeft = (21-xSize)/2; yTop = (30-ySize)/2;
set(gcf,'PaperPosition',[xLeft yTop xSize ySize])
set(gcf,'Position',[300 600 xSize*50 ySize*50])

xlabel('Point Number');
ylabel('Depth (cm)'); 
```

这是结果的图片。这看起来类似于我在上面的问题中发布的那个。我不知道这是否取决于显示器尺寸和/或屏幕分辨率。

![预期结果](../Images/25d965dcb8c56279eba9d81e0c8c1a60.png)

# dynamics-crm - 将合同行添加到合同 CRM 2011

> ID：10723074
> 
> 赞同：2
> 
> 时间：2012-05-23T15:24:00.637
> 
> 标签：dynamics-crm, dynamics-crm-2011

我希望有人能进一步帮助我，因为我真的很困在这里。我试图从创建后插件向我的合同实体添加合同行。我的代码：

```
Guid c_Id = (Guid)entity.Attributes["contractid"];
DateTime start = (DateTime)entity["activeon"];
DateTime end = (DateTime)entity["expireson"];
Money money = new Money();
money.Value = 0;

//Set Instance for Contract Line 
Entity ContractLine = new Entity();
ContractLine.LogicalName = "contractdetail";

//Create Contract Line for the Contract
ContractLine["title"] = "PLUGIN FIRED";
ContractLine["activeon"] = start;
ContractLine["expireson"] = end;
ContractLine["totalallotments"] = 1;
//ContractLine["customerid"] = entity["customerid"];  
//ContractLine["productid"] = entity["productid"];
ContractLine["price"] = money;
ContractLine["contractid"] = c_Id;

service.Create(ContractLine); 
```

出于某种原因，我收到“属性：contractid 不能设置为 NULL”的错误，这真的很奇怪，因为它实际上确实获得了 contractid 的 GUID，因为我在另一个实体的另一个字段上检查了它。如果有人能在这里帮助我，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:10:25.400

应该`ContractLine["contractid"]`= c_Id; 是`ContractLine["contractid"] = new EntityReference("contract", c_Id);`吗？

c_Id 也应该是 EntityReference 而不是 GUID？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:35:02.943

任何机会你有另一个插件因为你的抛出异常而被触发。这似乎总是在咬我。尝试禁用除您正在使用的插件之外的所有其他插件...

# database - 数据库多选Questi0n表关系

> ID：10723080
> 
> 赞同：0
> 
> 时间：2012-05-23T15:24:36.213
> 
> 标签：database, database-design, relationship

我有一个问答系统。一个问题有 4 个选项和 1 个答案（没有正确答案，只是用户的答案）。那么我应该如何建立这三个表之间的关系呢？我在下面所做的是否正确？就像问题表中缺少某些东西一样，因为我有 4 个选择（我将如何插入它们？）

```
Question Table: QuestionId, QuestionText
Choice Table: ChoiceId, ChoiceText, QuestionId
Answer Table: AnswerId, ChoiceId, QuestionId, UserId 
```

先感谢您。这是我在stackoverflow中的第一个问题:)

祝你今天过得愉快，

阿尔珀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:27:28.167

既然`ChoiceId`已经确定了 a ，那么如果你想对你的数据进行完全规范化，你 `QuestionId`可以摆脱table 。`QuestionId``Answer`

我会使用以下结构：

```
create table questions (
    question_id number primary key,
    question_text text
);
create table questions_choices (
    question_id number references questions(question_id),
    choice_number number,
    choice_text text,
    primary key(question_id, choice_number)
);
create table answers (
    answer_id number primary key,
    user_id number references users(user_id),
    question_id number,
    choice_number number,
    foreign key (question_id, choice_number) references questions_choices(question_id, choice_number)
); 
```

这与您所拥有的类似，但在`questions_choices`桌子上没有代理键。

# git - 从 Github 克隆的问题

> ID：10723081
> 
> 赞同：1
> 
> 时间：2012-05-23T15:24:40.520
> 
> 标签：git, github, clone

尝试从 git 克隆或拉取时收到此奇怪的错误消息。奇怪的是，我和一位同事以前对此没有任何问题。然后我们让另外两个团队成员克隆存储库，现在突然我和以前的同事继续收到这些错误。这两个新人在拉/推和克隆方面没有问题。一时之间，原本的两名队员也无能为力了。

我无法想象这两个新成员可能会修改或改变什么，我们现在只是在做一些简单的事情。GitHub 和以前的团队成员帐户是否可能存在问题？

```
Cloning into test...
Enter passphrase for key '/c/Users/Rob/.ssh/id_rsa':
remote: Counting objects: 8685, done.
remote: Compressing objects: 100% (3737/3737), done.
remote: Total 8685 (delta 5005), reused 8490 (delta 4810)
Receiving objects: 100% (8685/8685), 239.92 MiB | 158 KiB/s, done.
Resolving deltas: 100% (5005/5005), done.
error: refs/remotes/origin/master does not point to a valid object!
error: Trying to write ref refs/heads/master with nonexistant object 3cad1d0fb95b397ae8ed4826e29073362e135e2f
fatal: Cannot update the ref 'HEAD'.
Unlink of file 'test/.git/objects/pack/pack-9bca633d2527e271701b07f92128b15a6396277a.idx' failed. Should I try again? (y/n) 
```

更新：我刚刚尝试在 github 上设置一个新帐户并尝试再次克隆，但同样的问题，我想这将其缩小到我在 github 上可能拥有的某种全局设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T12:20:25.530

我有这个确切的问题，最初找不到一个好的答案。在桌子上敲了很多头之后，对我来说这很简单——我正在运行一个较旧的 git 客户端。

*   我使用 git 进行部署的服务器正在运行 git 1.7.1（撰写本文时 Centos6 的默认发行版）
*   git 现在到 1.7.12
*   很明显，我的其他一些客户承诺使用不向后兼容的功能。

我在服务器上升级了 git 客户端。问题消失了。希望对遇到同样问题的人有所帮助。

（作为记录，[在 Centos6 上从源代码安装 git](http://www.miketmoore.com/blog/2012/02/26/installing-git-on-centos-6/)非常有用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T23:11:02.943

这最终成为 git 客户端的一个奇怪错误，我重新安装，之后一切正常。

# google-app-engine - 在 Google App Engine 中迭代 20,000 多个实体并导出到文本文件的最简单方法是什么？

> ID：10723083
> 
> 赞同：1
> 
> 时间：2012-05-23T15:24:45.663
> 
> 标签：google-app-engine

我在 Google App Engine 中有一个模型，它有 50,000 多个实体。我想创建一个 mapreduce 或其他操作来迭代所有 50,000 多个实体并将模型上的方法的结果导出到文本文件。完成后，我想下载文本文件。

在 Google App Engine 中执行此操作的最简单方法是什么？我只需要遍历所有实体并将expert_data() 的结果写到一个公共文件中。

```
#Example model
class Car(db.Model):
    color = db.StringProperty()

    def export_data(self):
        return self.color 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:20:32.533

使用 mapreduce API：[https](https://developers.google.com/appengine/docs/python/dataprocessing/) ://developers.google.com/appengine/docs/python/dataprocessing/ 。它还有一个 BlobstoreOutputWriter，您可以使用它来创建一个 blob，然后下载该 blob。

根据戴夫的建议，这里是一个例子：[http ://code.google.com/p/appengine-mapreduce/source/browse/trunk/python/demo/main.py#264](http://code.google.com/p/appengine-mapreduce/source/browse/trunk/python/demo/main.py#264)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:02:29.783

我发现使用远程 api 做这种事情是最容易的，否则你将不得不将数据存储在 blobstore 中，然后在完成后将其导出。

远程处理 api 不如在 appengine 本身上运行它快，但它肯定要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T23:17:32.377

我会以不同的方式做到这一点 - 有人请告诉我这里是否有弱点。

我会使用任务队列和游标。查询前 1000 个左右的结果，使用实验性 blobstore 编程写入 API 将数据输出到 blobstore 文件。然后，使用光标重新安排 self 并在每次后续迭代中继续附加到文件并在光标处提取查询，直到完成。

这可能很慢 - 但它不会明显影响正在运行的应用程序，并且与 mapreduce 不同，它不会产生大量实例并可能花费您实际的金钱。它甚至可能不会产生一个额外的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T04:24:58.653

如果您只需要导出到文件并且想要所有实体，则可以使用 appengine 批量加载器

请参阅 appcfg.py 下载数据

还有 [https://developers.google.com/appengine/docs/python/tools/uploadingdata](https://developers.google.com/appengine/docs/python/tools/uploadingdata)

它处理重试限制线程等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T00:09:49.070

通过 Datastore Backups 导出到 Google Cloud Storage，然后下载：

[http://gbayer.com/big-data/app-engine-datastore-how-to-efficiently-export-your-data/](http://gbayer.com/big-data/app-engine-datastore-how-to-efficiently-export-your-data/)

这看起来比其他方法快得多。我自己没试过。

# iis-7.5 - 启用 Windows 身份验证的 IIS 中的 CORS 请求的 401 响应

> ID：10723088
> 
> 赞同：50
> 
> 时间：2012-05-23T15:25:16.157
> 
> 标签：iis-7.5, windows-authentication, asp.net-web-api, ntlm, cors

我正在尝试在我的 WebAPI 项目中启用 CORS 支持，如果我启用匿名身份验证，那么一切正常，但是在 Windows Auth +禁用匿名身份验证的情况下，发送的 OPTIONS 请求总是返回 401 未经授权的响应。请求它的站点位于 DOMAIN 上，因此应该能够拨打电话，有没有办法在不禁用 Windows 身份验证的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-09-15T09:09:40.503

You can allow only OPTIONS verb for anonymous users.

```
<system.web>
  <authentication mode="Windows" />
    <authorization>
      <allow verbs="OPTIONS" users="*"/>
      <deny users="?" />
  </authorization>
</system.web> 
```

According W3C specifications, browser excludes user credentials from CORS preflight: [https://dvcs.w3.org/hg/cors/raw-file/tip/Overview.html#preflight-request](https://dvcs.w3.org/hg/cors/raw-file/tip/Overview.html#preflight-request)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-09-02T10:56:56.373

Several years later, but through the answer from @dariusriggins and @lex-li I have managed to add the following code to my Global.asax:

```
 public void Application_BeginRequest(object sender, EventArgs e)
    {
        string httpOrigin = Request.Params["HTTP_ORIGIN"];
        if (httpOrigin == null) httpOrigin = "*";
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", httpOrigin);
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS");
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept, X-Token");
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Credentials", "true");

        if (Request.HttpMethod == "OPTIONS")
        {
            HttpContext.Current.Response.StatusCode = 200;
            var httpApplication = sender as HttpApplication;
            httpApplication.CompleteRequest();
        }
    } 
```

the httpOrigin is actually looked up in a list of allowed hosts but that just complicated things. This means that all other requests are validated but options just returns.

Thanks for this question, I would have been lost without it!

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-05-30T16:25:23.500

来自女士：

如果您禁用匿名身份验证，IIS 会根据设计向任何请求返回 401。如果他们启用了 Windows 身份验证，则在这种情况下的 401 响应将具有 WWW-Authenticate 标头以允许客户端启动身份验证握手。那么问题就变成了客户正在使用的客户端是否可以进行 Windows 身份验证。

最后，似乎可能存在一个潜在的问题，即是否可以配置一个 URL，以便允许一个动词（在本例中为 OPTIONS）匿名访问，但需要对其他动词进行 Windows 身份验证。IIS 通过简单的配置不支持这一点。通过启用匿名和 Windows 身份验证，在拒绝匿名用户访问的内容上设置 ACL，然后为相关 URL 配置处理程序映射，使其不会验证是否存在与 URL 关联的文件。但是要确认这一点需要一些时间。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-01-21T09:56:53.740

解决此问题的最简单方法是使用条件 request_method = ^OPTIONS$ 创建重写规则。然后将操作设置为自定义响应，将其设置为 200 OK。然后所有选项请求将响应 200 而不是 401。这将解决 CORS 问题。

当然，您仍然需要确保您拥有正确的跨源请求标头。

当启用集成身份验证时，这将停止以 401 响应的选项请求（没有任何凭据）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-18T09:40:16.983

接受的答案是正确的，但是我在一段时间内使用“带有 iisnode 和 npm cors 模块的节点”设置对 rest api 进行故障排除，并且对只为所有用户启用匿名身份验证感到不舒服。由于它是一个节点应用程序，system.web 标签并没有做太多的事情。我最终在 web.config 中添加了以下内容：

```
<system.webServer>
<security>
  <requestFiltering>
    <hiddenSegments>
      <add segment="node_modules" />
    </hiddenSegments>
  </requestFiltering>
  <authorization>
    <add accessType="Allow" verbs="OPTIONS" users="?" />
    <add accessType="Deny" verbs="GET, PUT, POST, DELETE" users="?" />
  </authorization>
</security>
</system.webServer> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-02-05T23:20:05.297

[相关问题：IIS 劫持 CORS Preflight OPTIONS 请求](https://stackoverflow.com/questions/22495240/iis-hijacks-cors-preflight-options-request)

合并来自多个地方的答案的信息。如果您需要在 Intranet 上使用 Windows 身份验证在 ASP.net 页面方法上启用 CORS，这似乎可行。没有对 的更改`web.config`，这是行不通的。

您需要将此添加到`Global.asax`

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        string httpOrigin = HttpContext.Current.Request.Params["HTTP_ORIGIN"] ?? HttpContext.Current.Request.Params["ORIGIN"] ?? "*";
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", httpOrigin);
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS");
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept, X-Token");
        HttpContext.Current.Response.AddHeader("Access-Control-Allow-Credentials", "true");

        if (HttpContext.Current.Request.HttpMethod == "OPTIONS")
        {
            HttpContext.Current.Response.StatusCode = 200;
            var httpApplication = sender as HttpApplication;
            httpApplication.CompleteRequest();
        }
    } 
```

而这`web.config`

```
 <system.webServer>
    <handlers>
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <remove name="OPTIONSVerbHandler" />
      <remove name="TRACEVerbHandler" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." 
           verb="*" type="System.Web.Handlers.TransferRequestHandler" 
           preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-08-16T16:43:15.380

扩展@dariusriggins 提供的答案。查看这篇文章：[微软 | 开发人员：将所有内容放在一起 – CORS 教程](https://blogs.msdn.microsoft.com/friis/2017/11/24/putting-it-all-together-cors-tutorial/)

对于 IIS 配置：

授权规则

[![授权规则](../Images/1022dfccb6e566b00d32e1b3fd222fb6.png)](https://i.stack.imgur.com/7SEWy.png)

授权阶段（或授权事件），我们需要确保只允许来自 CORS 预检的匿名请求，并要求所有其他传入请求都提供身份验证凭据。我们可以通过授权规则来实现这一点。授予所有用户访问站点的默认授权规则已经存在，并且默认由 IIS 提供。我们将首先修改此规则以仅允许匿名用户发送使用 OPTIONS http 动词的请求。以下是 IIS 中此授权规则的目标配置：

编辑授权规则

[![编辑授权规则](../Images/eb36398fb339eb3603b6eb855fcd2321.png)](https://i.stack.imgur.com/UqRZJ.png)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-05-14T19:11:56.603

[由于IE 10 和 11](https://connect.microsoft.com/IE/feedback/details/773478/ie-10-on-win8-does-not-assign-the-correct-httpstatus-to-xmlhttprequest-when-the-result-is-401)中的错误，我今天遇到了同样的问题，我使用的是 ServiceStack 而不是 WebApi，但该方法也适用于您。

1.  在 IIS 网站上启用 Windows 集成和匿名身份验证。
2.  在 ServiceStack Pipeline 上有一系列过滤器，
    *   为了处理 Cors 和 OPTIONS 请求，在 Options 请求中，我添加了必要的标头并结束请求，
    *   用于检查的过滤器包括 HttpRequest 是否已通过身份验证？，
    *   等过滤器，

通过所有过滤器后，它执行服务。

[CorsFeature.cs](https://gist.github.com/SathishN/e0f298b8679d028def0b)

[验证过滤器](https://gist.github.com/SathishN/50c5c717028b6bcaf405)

在我的 AppHost 中，

```
appHost.Plugins.Add(new CorsFeature());

appHost.RequestFilters.Add(AuthenticateFilter.Authenticate); 
```

除了添加标头之外，我还修改了 CorsFeature 以处理 OptionsRequest，Authenticate Filter 以检查经过身份验证的请求！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-23T14:43:36.710

对我有用的（使用 AngularJS 或 JQuery 时）是将 withCredentials:true 添加到客户端的每个请求中：

```
$http.get("http://localhost:88/api/tests", {withCredentials :true}) 
```

并在服务器上启用 CORS，这是使用 nuget 中的 Microsoft.Owin.Cors 完成的，并将其添加到 Startup 中，如下所示：

```
public void Configuration(IAppBuilder app)
    {
        HttpConfiguration config = new HttpConfiguration();

        ConfigureOAuth(app);

        WebApiConfig.Register(config);
        app.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll);
        app.UseWebApi(config);

    } 
```

参考：

*   服务器上的 CORS（参见步骤 11）：[http ://bitoftech.net/2014/06/01/token-based-authentication-asp-net-web-api-2-owin-asp-net-identity/](http://bitoftech.net/2014/06/01/token-based-authentication-asp-net-web-api-2-owin-asp-net-identity/)
*   客户端上的 CORS：http: [//brockallen.com/2012/12/15/cors-and-windows-authentication/](http://brockallen.com/2012/12/15/cors-and-windows-authentication/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-08-30T20:20:41.307

我知道这是一个老问题，有几个可能的解决方案（以及更多问题），但万一其他人遇到这个问题，IIS CORS 1.0 于 17 年 11 月可用：

[https://blogs.iis.net/iisteam/introducing-iis-cors-1-0](https://blogs.iis.net/iisteam/introducing-iis-cors-1-0)

[https://docs.microsoft.com/en-us/iis/extensions/cors-module/cors-module-configuration-reference](https://docs.microsoft.com/en-us/iis/extensions/cors-module/cors-module-configuration-reference)

您可以通过 IIS Windows 平台安装程序 (WPI) 下载它。这应该可以解决您的许多 CORS 身份验证问题。享受！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-04-04T09:56:31.763

这个 IIS 扩展（[IIS CORS 模块](https://www.iis.net/downloads/microsoft/iis-cors-module)）帮助我解决了对启用了 Windows 身份验证的 IIS 托管应用程序的 401-未经授权的预检请求。安装此模块后，我执行了 IISRESET 并在我的 Web 应用程序的 Web.config 文件中添加了以下内容：

```
<configuration>
    <configSections>
        <!-- ... (configSections must be the first element!) -->
    </configSections>
    <system.webServer>
        <cors enabled="true">
            <add origin="http://localhost:3000" allowCredentials="true" maxAge="120">
                <allowHeaders allowAllRequestedHeaders="true"/>
                <!-- Added 'allowMethods' just in case. -->
                <allowMethods>
                    <add method="HEAD"/>
                    <add method="GET"/>
                    <add method="POST"/>
                    <add method="PUT"/>
                    <add method="DELETE"/>
                    <add method="OPTIONS"/>
                </allowMethods>
            </add>
        </cors>
    </system.webServer>
</configuration> 
```

您可以在此处找到有关如何配置 IIS CORS 模块的更多信息：IIS CORS 模块 [入门](https://blogs.iis.net/iisteam/getting-started-with-the-iis-cors-module)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-04-19T12:10:00.653

我正在使用 Web API 和 OWIN，我尝试了所有建议的解决方案，但唯一有效的是以下

```
//use it in your startup class
app.Use((context, next) =>
{
    if (context.Request.Headers.Any(k => k.Key.Contains("Origin")) && context.Request.Method == "OPTIONS")
    {
        context.Response.StatusCode = 200;
        context.Response.Headers.Add("Access-Control-Allow-Origin", new string[1] { "ALLOWED_ORIGIN" });
        context.Response.Headers.Add("Access-Control-Allow-Headers", new string[4] { "Origin", "X-Requested-With", "Content-Type", "Accept" });
        context.Response.Headers.Add("Access-Control-Allow-Methods", new string[5] { "GET", "POST", "PUT", "DELETE", "OPTIONS" });
        context.Response.Headers.Add("Access-Control-Allow-Credentials", new string[1] { "true" });

        return context.Response.WriteAsync("");
    }

    return next.Invoke();
});

//this is important! Without it, it didn't work (probably because the middleware was too late)
app.UseStageMarker(PipelineStage.Authenticate); 
```

您需要将此代码插入您的 OWIN 启动类之一中的某个位置。打电话很重要，`app.UseStageMarker(PipelineStage.Authenticate)`否则预检检查失败。UseStageMarker 的更多信息-> [https://docs.microsoft.com/en-us/aspnet/aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline](https://docs.microsoft.com/en-us/aspnet/aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline)

您需要明确定义允许的标头也很重要。`*`如果您用作占位符，它将失败。

也许它可以帮助某人。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-07T07:13:22.490

*   在您的 iis 上安装 iis cors[模块](https://www.iis.net/downloads/microsoft/iis-cors-module)。

*   如果是 WebApi 添加：

```
public static void Register(HttpConfiguration config)
{
    var cors = new EnableCorsAttribute("*", "*", "*");
    cors.SupportsCredentials = true;
    config.EnableCors(cors);
} 
```

*   将此行添加到您的 web.config：

```
 <configuration>
    <system.webServer>
        <cors enabled="true" failUnlistedOrigins="true">
            <add origin="*">
               <allowHeaders allowAllRequestedHeaders="true">
                    <add header="Access-Control-Allow-Origin" />
                    <add header="Access-Control-Allow-Headers" />
                    <add header="Access-Control-Allow-Methods" />
                </allowHeaders>
            </add>
        </cors>
    </system.webServer>
  </configuration> 
```

更多信息。在[这篇](https://docs.microsoft.com/en-us/iis/extensions/cors-module/cors-module-configuration-reference)文章中。

*   添加`xhrFields: {withCredentials: true}`到您的 ajax 调用。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-11-24T14:21:56.357

在 WebApiConfig.cs 中的 EnableCorsAttribute 上启用 SupportCredentials 对我有用：

```
public static void Register(HttpConfiguration config)
{        
    //enable cors request just from localhost:15136 
    var cors = new EnableCorsAttribute("http://localhost:15136", "*", "*");
    cors.SupportsCredentials = true;
    config.EnableCors(cors);

    //other stuff
} 
```

[https://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api](https://www.asp.net/web-api/overview/security/enabling-cross-origin-requests-in-web-api)

`{withCredentials :true}`确保从 javascript ( )调用时发送凭据

# sql - SSIS 包上 uri 和 WebClient 类的奇怪行为

> ID：10723092
> 
> 赞同：5
> 
> 时间：2012-05-23T15:25:21.867
> 
> 标签：sql, sql-server-2005, ssis, webclient, ssis-2005

我有一个很奇怪的情况。

我有这个非常简单的包：

![在此处输入图像描述](../Images/6016b423e7b3fcbe9a9902038d043a0e.png)

*   任务“获取列表”从程序集中检索数据表，其中包含一列和要运行到对象变量中的 URL 列表。
*   “foreach”循环遍历对象变量并将 URL 加载到 url 字符串变量中
*   “运行”，使用此代码调用 url（它的 2005 年，所以我坚持使用 VB）：

    ```
    Dim myURI As New Uri("http://" + Dts.Variables("URL").Value.ToString())
    Dim myWebClient As New System.Net.WebClient
    myWebClient.OpenReadAsync(myURI) 
    ```

被调用的 URL 是内部的，只是读取参数并执行一系列需要一些时间的操作，这就是我使用“OpenReadAsync”的原因

我的问题是：如果我要运行 4 个 URL，则程序包只运行其中的 2 个。循环 lops 4 次，脚本被调用 4 次（我可以看看我是否调试它），该行`myWebClient.OpenReadAsync(myURI)`使用 4 个不同的值执行 4 次，但只对 URL 进行了 2 次调用。

如果我再次运行该程序包，现在会调用其他 2 个 URL，这证明该 URL 没有任何问题，并且如果我在浏览器上（例如在 4 个选项卡上）一个接一个地手动调用 4 个 URL，它们都产生了预期的结果，这证明了解析 URL 的代码没有任何问题。

所以我留下了 VB 代码，这是我第一次使用 uri 和 WebClient，所以我想知道我是否做错了什么。我还尝试在通话之间添加 5 秒的睡眠时间，但没有运气。

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:36:54.823

所有浏览器都应将自己限制为每个主机 2 个请求，以避免主机过载。.NET 遵循此规则，并且只允许与主机建立 2 个并发连接。您可以通过修改应用程序的配置文件或通过代码来更改此限制。

*   要更改配置文件中的限制，请更改[system.net/connectionManagement](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)元素中的 maxConnection 属性。
*   要通过代码更改限制，请更改静态[ServicePointManager.DefaultConnectionLimit](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx)属性。

您添加到脚本的延迟不起作用，因为您没有在 WebClient 实例上调用 Dispose。WebClient 类保持其连接打开，直到您将其处置以读取响应流。否则，在垃圾收集器收集客户端之前，您将无法再次连接到同一主机。

此外，OpenReadAsync 会向客户端打开流并确保它保持打开状态，除非您关闭它或它被收集。您应该使用其中一个 DownloadXXXAsync 来避免无缘无故打开流。

更好的解决方案是调用 DownloadStringAsync 并在 DownloadStringAsyncCompleted 事件中处理客户端。

**更新：**

ServicePointManager.DefaultConnectionLimit 存储在一个静态字段中，这意味着它的范围是整个 AppDomain。SSIS 对每个包执行使用单个 AppDomain，因此该值将影响整个包。

如果您只想使用[FindServicePoint](http://msdn.microsoft.com/en-us/library/c5f0atwd)修改单个主机的连接限制，您可以为主机地址创建一个 ServicePoint 并仅为该地址设置限制：

```
var myTarget= ServicePointManager.FindServicePoint(new Uri("http://www.google.com"));
myTarget.ConnectionLimit = 10; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T20:58:50.897

1.  尝试延长每个任务和子任务的超时时间。

2.  我没有被问到，但我会硬编码这样的任务而不是使用 SSIS。SSIS 非常适合 ETL，但仅此而已！

# doxygen - 如何更改 Doxygen 中的函数签名？

> ID：10723097
> 
> 赞同：1
> 
> 时间：2012-05-23T15:25:34.060
> 
> 标签：doxygen

在其他文档系统中，例如 LuaDoc，有一个`@brief`指令允许您为每个使用的令牌定义一个自定义名称，该名称与实际令牌名称相结合。

例如，您可以实现一个函数`foo`，如`bar`文档中所示。

如果您的源代码在编译之前通过某种非标准预处理器，这将非常方便。

或者，如果您想将 Doxygen 与 Doxygen 不支持的语言一起使用，并且您必须使用过滤器脚本将其转换为 Doxygen 可以解析的内容。

有没有办法在 Doxygen 中实现这种行为（仅重命名文档的令牌）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:25:21.870

您可以使用`INPUT_FILTER`（所有文件的相同过滤器）或`FILTER_PATTERNS`（特定扩展名的过滤器）过滤输入文件。

`SOURCE_BROWSER=YES`通常不会处理源代码视图（即），但是如果您想对源代码使用与文档不同的过滤器，您可以使用它来更改它`FILTER_SOURCE_FILES=YES`并结合使用它。`FILTER_SOURCE_PATTERNS`

如果您对源使用传递过滤器并为文档使用令牌重命名过滤器，您应该能够获得您正在寻找的效果。

# java - Hibernate：通过@AttributeOverride 覆盖@Pattern

> ID：10723100
> 
> 赞同：0
> 
> 时间：2012-05-23T15:25:37.350
> 
> 标签：java, hibernate

有一个`@MappedSuperClass SomeClass`（参见下面的最小示例），是否可以覆盖扩展中的`@Pattern`通孔？`@AttributeOverride``SomeOtherclass``SomeClass`

```
@MappedSuperClass
public abstract class SomeClass {

@Column(name = "NAME", length = 255, unique = false, nullable = true)
@Pattern(regex = "([a-zA-Z0-9]+_)*([a-zA-Z0-9]+)")
        private String name;
    …
}

@AttributeOverride(name = "name", column = @Column(name = "NAME", length = 20, unique = false, nullable = false))
public class SomeOtherClass extends SomeClass {

    ….

} 
```

或者有没有其他方法可以`@Pattern`为继承的类定义一个新的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:55:27.990

这是不可能的。@AttributeOverride 和 @Pattern 注释不是同一规范的一部分。

*@AttributeOverride*是 JPA 规范的一部分，允许您覆盖实体子类中属性的列定义。

*@Pattern*是 bean 验证 (JSR 303) 规范的一部分，允许您指定正则表达式来匹配带注释的成员。您不能覆盖 @Pattern 注释，但可以在子类中累积应用新模式，假设您正在注释您的方法而不是您的字段。

看到这个[有点相关的答案](https://stackoverflow.com/questions/9067420/can-i-override-a-jsr-303-validation-annotation)。

# sql - postgres 上的这个延迟作业查询的最佳索引是什么？

> ID：10723102
> 
> 赞同：6
> 
> 时间：2012-05-23T15:25:38.453
> 
> 标签：sql, postgresql, delayed-job, multiple-columns, database-indexes

delay_job 定期执行这样的查询：

```
SELECT  "delayed_jobs".*
FROM "delayed_jobs"
WHERE ((run_at <= '2012-05-23 15:16:43.180810' AND (locked_at IS NULL OR locked_at < '2012-05-23 11:16:43.180841') OR locked_by = 'host:foo pid:1') AND failed_at IS NULL)
ORDER BY priority ASC, run_at ASC LIMIT 5 
```

我在我相当大的数据库机器上的日志报告说它需要四分之一秒才能运行。我可以在所有被选中的列上添加一些索引，但我可能可以从多列索引中获得更多性能。

我可以为此查询创建的最佳多列索引是什么？有什么工具可以为我计算这个吗？

**更新**

postgres 版本：9.1.3

一个现有索引：priority, run_at（名为“delayed_jobs_priority”）

出`explain analyze`：

```
Limit  (cost=0.00..219.65 rows=5 width=1154) (actual time=0.727..0.727 rows=0 loops=1)
   ->  Index Scan using delayed_jobs_priority on delayed_jobs  (cost=0.00..351.43 rows=8 width=1154) (actual time=0.725..0.725 rows=0 loops=1)
         Filter: ((failed_at IS NULL) AND (((run_at <= '2012-05-23 18:11:03.980113'::timestamp without time zone) AND ((locked_at IS NULL) OR (locked_at < '2012-05-23 14:11:03.98014'::timestamp without time zone))) OR ((locked_by)::text = 'host:foo pid:1'::text)))
 Total runtime: 0.754 ms
(4 rows) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:48:00.590

由于您有一个`LIMIT`子句，因此您可能需要一个排序索引而不是过滤索引， on `(priority, run_at)`。

表中满足`WHERE`条件的记录的百分比是多少？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:16:55.523

在这种情况下，我认为多列索引没有多大用处。使用多个单列索引。

# android - 如何删除返回的数据库 sqlite 中的错误：错误代码 = 1，msg = 表 Customer_details_table 没有名为“卡号”的列

> ID：10723110
> 
> 赞同：1
> 
> 时间：2012-05-23T15:25:52.240
> 
> 标签：android, sqlite

String sqlQueryToCreateUndergraduateDetailsTable = "如果不存在则创建表" + TABLE_NAME_GPA + " (" + BaseColumns._ID +" 整数主键自动增量，" +"COLUMN_NAME" +" 文本不为空，" +"COLUMN_SURNAME" +" 文本不为空，" +“COLUMN_DATE_OF_BIRTH”+“文本不为空，+“COLUMN_ADDRESS”+“文本不为空”，+“COLUMN_EMAIL”+“文本不为空”，+“COLUMN_PHONE_NUMBER”+“文本不为空”，+“COLUMN_CITY”+“文本不为空，"+"COLUMN_PTYE_PAYMENT"+"text not null," +"COLUMN_SHIPPING_TYPE" +"text not null," +"COLUMN_CARD_NUMBER" + "text not null," +"COLUMN_Password" +"text not null);";

我正在尝试保存到数据库，但它给了我一个错误说.....错误代码 = 1，味精 = 表 Customer_details_table 没有名为“卡号”的列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:56:11.343

另外我认为您不想将常量放入“”中，或者您没有将它们作为常量吗？

它应该看起来像：

```
String sqlQueryToCreateUndergraduateDetailsTable = "create table if not exists  "
        + TABLE_CREDENTIALS + " ( " + BaseColumns._ID
        + " integer primary key autoincrement, " + COLUMN_NAME
        + " text not null, " + COLUMN_PASSWORD + " text not null);"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:52:29.170

表名或列名中不能有空格。

将其更改为`Card_Number`or `CardNumber`，它应该可以工作。

**编辑**

查看错误以及您最初所说的内容，我认为您发布了错误的SQL。

您向我们展示了您的表创建 SQL，但您说“我正在尝试保存**到**数据库”......并且错误消息似乎表明它正在寻找一列，而不是尝试创建一列。

我认为您需要查看您的插入或更新方法 SQL，您可能在其中手动输入它而不是使用常量并不小心在其中放置了一个空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:28:01.503

你的查询搞砸了。您需要在列名及其属性之间留出空格。

例如，以下内容：

```
... +"COLUMN_CARD_NUMBER" + "text not null," + ... 
```

应该是这样的：

```
... +"COLUMN_CARD_NUMBER " + "text not null," + ... 
```

*注意列名后面的空格*

# javascript - json数组内的数组

> ID：10723112
> 
> 赞同：0
> 
> 时间：2012-05-23T15:25:57.850
> 
> 标签：javascript, jquery, ajax, json

我得到了像

```
{"ID":1022,"Type":"type1","Name":"name1","Values":[{"ID":3540,"Name":"1"},{"ID":3541,"Name":"2"},{"ID":3542,"Name":"cb"}]} 
```

所以成功我得到了这样的功能

```
 success: function(data) {
            $.each(data, function() {
                $('#properties').append(
                this.ID + "," +
                this.Name + "," +

                this.type + "," +
                    this.values
                );
            });
        } 
```

但是“值”是另一个数组，那么如何显示呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:29:18.437

我相信`this.Values[0].ID`应该正确地从第一个元素返回 ID。

您还可以遍历数组中的每个项目并以相同的方式访问它。

```
for (var i = 0; i < this.Values.length; i++) {
    alert(this.Values[i].ID); //Show an alert for each ID.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:32:06.467

```
//get the total length of values array.
this.Values.length;

for (  var i = 0 ; i < this.Values.length; i++ ){
 var resultId= this.Values[i].ID;
 var resultName = this.Values[i].Name;
} 
```

这行得通。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:35:56.777

我不太确定 this 在最里面的函数中的值是什么，但它可能不是你想要的。为了在创建时将变量传递给函数，而不是在调用它时，您应该用另一个函数包装它，如下所示：

```
{
    success: function(data) {
        $.each(data, (function(dat) { return function(index, value) {
            $('#properties').append(
               value.ID + "," +
               value.Name + "," +
               dat.type + "," +
               dat.values
            );
        }; ) (data));
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:29:02.740

`this.values[0].ID`可能有效，但是，我不完全确定。不过，我想尝试并没有什么坏处。

# sql - 在一个请求中发出多个请求

> ID：10723113
> 
> 赞同：0
> 
> 时间：2012-05-23T15:25:58.207
> 
> 标签：sql, oracle, request

我有多个请求，我想做一个简单的请求

```
INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT CLIENT_ID, 160 AS TYPE_DONNEES
FROM    REFERENTIEL r, CLIENT_APPLICATIF ca
WHERE r.ID = ca.ID_REFERENTIEL
AND r.TYPE=1
AND NOT EXISTS (
    SELECT * FROM SERVICEPAYANT_CLIENT sp
    WHERE sp.RE_ID = CLIENT_ID AND TYPE_DONNEES = 160)
GROUP BY CLIENT_ID
HAVING COUNT(*)>0;

INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT CLIENT_ID, 161 AS TYPE_DONNEES
FROM    REFERENTIEL r, CLIENT_APPLICATIF ca
WHERE r.ID = ca.ID_REFERENTIEL
AND r.TYPE=1
AND NOT EXISTS (
    SELECT * FROM SERVICEPAYANT_CLIENT sp
    WHERE sp.RE_ID = CLIENT_ID AND TYPE_DONNEES = 161)
GROUP BY CLIENT_ID
HAVING COUNT(*)>0;

INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT CLIENT_ID, 162 AS TYPE_DONNEES
FROM    REFERENTIEL r, CLIENT_APPLICATIF ca
WHERE r.ID = ca.ID_REFERENTIEL
AND r.TYPE=1
AND NOT EXISTS (
    SELECT * FROM SERVICEPAYANT_CLIENT sp
    WHERE sp.RE_ID = CLIENT_ID AND TYPE_DONNEES = 162)
GROUP BY CLIENT_ID
HAVING COUNT(*)>0;

INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT CLIENT_ID, 163 AS TYPE_DONNEES
FROM    REFERENTIEL r, CLIENT_APPLICATIF ca
WHERE r.ID = ca.ID_REFERENTIEL
AND r.TYPE=1
AND NOT EXISTS (
    SELECT * FROM SERVICEPAYANT_CLIENT sp
    WHERE sp.RE_ID = CLIENT_ID AND TYPE_DONNEES = 163)
GROUP BY CLIENT_ID
HAVING COUNT(*)>0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:49:34.930

单个插入应该可以工作：

```
INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT CLIENT_ID, T.TYPE_DONNEES
  FROM (SELECT 160 TYPE_DONNEES FROM dual UNION ALL
        SELECT 161 FROM dual UNION ALL
        SELECT 162 FROM dual UNION ALL
        SELECT 163 FROM dual) t,
       REFERENTIEL r,
       CLIENT_APPLICATIF ca
 WHERE r.ID = ca.ID_REFERENTIEL
   AND r.TYPE = 1
   AND NOT EXISTS (SELECT *
                     FROM SERVICEPAYANT_CLIENT sp
                    WHERE sp.RE_ID = CLIENT_ID
                      AND TYPE_DONNEES = T.TYPE_DONNEES)
 GROUP BY T.TYPE_DONNEES, CLIENT_ID
/* HAVING COUNT(*) > 0 (unnecessary) */; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:49:51.730

我认为这可以简化为：

```
INSERT INTO SERVICEPAYANT_CLIENT (RE_ID, TYPE_DONNEES)
SELECT  DISTINCT 
        CLIENT_ID, 
        t.TYPE_DONNEES
FROM    REFERENTIEL r, 
        CLIENT_APPLICATIF ca,
        (   SELECT  160 AS Type_Donnees FROM Dual UNION ALL
            SELECT  161 AS Type_Donnees FROM Dual UNION ALL
            SELECT  162 AS Type_Donnees FROM Dual UNION ALL
            SELECT  163 AS Type_Donnees FROM Dual 
        ) t
WHERE   r.ID = ca.ID_REFERENTIEL
AND     r.TYPE = 1
AND     NOT EXISTS 
        (   SELECT  1
            FROM    SERVICEPAYANT_CLIENT sp
            WHERE   sp.RE_ID = CLIENT_ID 
            AND     t.TYPE_DONNEES = sp.TYPE_DONNEES
        ) 
```

# java - 在 Java 中更改颜色选择器按钮的背景颜色

> ID：10723115
> 
> 赞同：3
> 
> 时间：2012-05-23T15:25:59.377
> 
> 标签：java, swing, jbutton, jcolorchooser

我有一个打开 JColorChooser 对话框的 Java 按钮。我希望按钮的颜色根据对话框中选择的颜色进行更改。我试过调用按钮的 setBackgroundColor() 方法，但在我的情况下它没有效果（按钮在 Winsows 7 中的 JToolBar 上）。此外，[这个](https://stackoverflow.com/questions/6256483/how-to-set-the-button-color-of-a-jbutton-not-background-color)问题表明更改按钮的背景与平台无关。

也许这个问题的答案是首先不要使用按钮。所以，我的问题是：有没有一种方法可以在 Java 中显示反映所选择颜色的“颜色选择器”控件？有点像 MS Paint 如何在“填充颜色”按钮上显示选择的颜色。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:37:10.933

从上下文中不确定，你的意思是这种方式（代码示例）`setBackground`还是[JColorChooser](http://docs.oracle.com/javase/tutorial/uiswing/components/colorchooser.html)或其`JComponents`在`JColorChooser`

![在此处输入图像描述](../Images/4a41f5c263a6ec308963134c847c1c81.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ComboBoxEditor;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JButton;
import javax.swing.JColorChooser;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.ListCellRenderer;
import javax.swing.border.LineBorder;
import javax.swing.event.EventListenerList;

class ColorComboBoxEditor implements ComboBoxEditor {

    final protected JButton editor;
    private EventListenerList listenerList = new EventListenerList();

    ColorComboBoxEditor(Color initialColor) {
        editor = new JButton("");
        editor.setBackground(initialColor);
        ActionListener actionListener = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                Color currentBackground = editor.getBackground();
                Color color = JColorChooser.showDialog(editor, "Color Chooser", currentBackground);
                if ((color != null) && (currentBackground != color)) {
                    editor.setBackground(color);
                    fireActionEvent(color);
                }
            }
        };
        editor.addActionListener(actionListener);
    }

    @Override
    public void addActionListener(ActionListener l) {
        listenerList.add(ActionListener.class, l);
    }

    @Override
    public Component getEditorComponent() {
        return editor;
    }

    @Override
    public Object getItem() {
        return editor.getBackground();
    }

    @Override
    public void removeActionListener(ActionListener l) {
        listenerList.remove(ActionListener.class, l);
    }

    @Override
    public void selectAll() {
    }

    @Override
    public void setItem(Object newValue) {
        if (newValue instanceof Color) {
            Color color = (Color) newValue;
            editor.setBackground(color);
        } else {
            try {
                Color color = Color.decode(newValue.toString());
                editor.setBackground(color);
            } catch (NumberFormatException e) {
            }
        }
    }

    protected void fireActionEvent(Color color) {
        Object listeners[] = listenerList.getListenerList();
        for (int i = listeners.length - 2; i >= 0; i -= 2) {
            if (listeners[i] == ActionListener.class) {
                ActionEvent actionEvent = new ActionEvent(editor, ActionEvent.ACTION_PERFORMED, color.toString());
                ((ActionListener) listeners[i + 1]).actionPerformed(actionEvent);
            }
        }
    }
}

class ColorCellRenderer implements ListCellRenderer {

    private DefaultListCellRenderer defaultRenderer = new DefaultListCellRenderer();
    private final static Dimension preferredSize = new Dimension(0, 20);

    @Override
    public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
        JLabel renderer = (JLabel) defaultRenderer.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
        if (value instanceof Color) {
            renderer.setBackground((Color) value);
        }
        if (cellHasFocus || isSelected) {
            renderer.setBorder(new LineBorder(Color.DARK_GRAY));
        } else {
            renderer.setBorder(null);
        }
        renderer.setPreferredSize(preferredSize);
        return renderer;
    }
}

class ColorComboBoxEditorRendererDemo {

    public ColorComboBoxEditorRendererDemo() {
        Color colors[] = {Color.BLACK, Color.BLUE, Color.GREEN, Color.RED, Color.WHITE, Color.YELLOW};
        JFrame frame = new JFrame("Color JComboBox");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JComboBox comboBox = new JComboBox(colors);
        comboBox.setEditable(true);
        comboBox.setRenderer(new ColorCellRenderer());
        Color color = (Color) comboBox.getSelectedItem();
        ComboBoxEditor editor = new ColorComboBoxEditor(color);
        comboBox.setEditor(editor);
        frame.add(comboBox, BorderLayout.NORTH);
        final JLabel label = new JLabel();
        label.setOpaque(true);
        label.setBackground((Color) comboBox.getSelectedItem());
        frame.add(label, BorderLayout.CENTER);
        ActionListener actionListener = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent actionEvent) {
                Color selectedColor = (Color) comboBox.getSelectedItem();
                label.setBackground(selectedColor);
            }
        };
        comboBox.addActionListener(actionListener);
        frame.setSize(300, 200);
        frame.setVisible(true);
    }

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                ColorComboBoxEditorRendererDemo colorComboBoxEditorRendererDemo = new ColorComboBoxEditorRendererDemo();
            }
        });
    } 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T18:14:27.480

你有几个选择：

*   更改相关组件的背景，如@mKorbel 的[答案](https://stackoverflow.com/a/10723340/230513)所示。

*   按照@Robin [here](https://stackoverflow.com/a/9852024/230513)的建议，使按钮[不透明](http://java.sun.com/products/jfc/tsc/articles/painting/index.html#props)。

*   修改包含按钮的面板的背景，如下[所示](https://stackoverflow.com/a/3420431/230513)。

*   实现`Icon`接口并将实例应用到（或附近）您的按钮，如此[处所示](https://sites.google.com/site/drjohnbmatthews/graphpanel)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-07T03:19:31.637

从[这里开始](https://stackoverflow.com/a/30433662/1201614)，一个颜色选择按钮类：

*   显示当前选择的颜色
*   按下时打开一个 JColorChooser 对话框
*   选择颜色时触发事件

[![在此处输入图像描述](../Images/a79a33d3465a77b88692410a9701df52.png)](https://i.stack.imgur.com/lg1Gk.png)

# python - 如何自动将类变量添加到某些子类

> ID：10723117
> 
> 赞同：2
> 
> 时间：2012-05-23T15:26:13.537
> 
> 标签：python, python-2.7

```
class A(object):
    _all = set()

    def __new__(cls):
        obj = super(A,cls).__new__(cls)
        cls._all.add(obj)
        return obj

class B(A):
    pass

class C(A):
    pass

b = B()
c = C() 
```

这将创建所有实例并将它们放入`A._all`. 我想要的是放置的实例`C`（`C._all`对于 C 也是如此）。

我可以这样`B`定义`C`：

```
class B(A):
    _all = set()

class C(A):
    _all = set() 
```

这会奏效。然而，这感觉就像是重复代码，如果我在下一个`_all`子类时忘记添加`A`，或者拼写错误`_alll`，我可能很难调试错误。

我该如何做好这件事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:30:26.233

设置`_all`并在if still`None`中创建您的设置，为每个班级提供自己的副本：`__new__``None`

```
class A(object):
    _all = None

    def __new__(cls):
        obj = super(A,cls).__new__(cls)
        if cls._all is None:
            cls._all = set()
        cls._all.add(cls)
        return obj 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T15:54:00.143

这是它的元类：

```
class make_all_meta(type):
   def __init__(cls, name, bases, dic):
       type.__init__(cls, name, bases, dic)
       cls._all = set()

class A(object):
    __metaclass__ = make_all_meta 
```

在 Python 3 中， for 的定义`A`必须是：

```
class A(metaclass=make_all_meta):
    pass 
```

# java - MongoDB 的 JMX 注册错误

> ID：10723120
> 
> 赞同：2
> 
> 时间：2012-05-23T15:26:21.790
> 
> 标签：java, mongodb, permissions, jmx, accesscontrolexception

我已经在我的服务器上安装了 MongoDB，并编写了一个非常小的 Java 程序来连接它：

```
Mongo mongo = new Mongo("localhost");
db = mongo.getDB("testdb"); // testdb doesn't exist, will be created 
```

当我运行程序时，我得到这个错误：

```
WARNING: jmx registration error: java.security.AccessControlException:
    access denied (javax.management.MBeanTrustPermission register) continuing... 
```

什么可能导致此错误？我正在使用 MongoDB 提供的 MongoDB 数据库驱动程序 2.7.3。自安装以来，我已经更改了 MongoDB 的配置文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:10:18.847

在我看来，您的安全策略不允许 MongoDB 注册其 JMX 方法。看到这个问题：[尝试使用 Netbeans 将 webapp 重新部署到 Tomcat 时出现 AccessControlException](https://stackoverflow.com/questions/2416812/accesscontrolexception-when-trying-to-redeploy-webapp-to-tomcat-using-netbeans)

它建议编辑您的`security.policy`文件以添加以下行：

```
grant { permission javax.management.MBeanTrustPermission "register"; }; 
```

然后将以下内容添加到您的 VM 命令行参数中：

```
-Djava.security.policy= <path to security.policy> 
```

# objective-c - NSURLConnection MVC 最佳实践

> ID：10723124
> 
> 赞同：1
> 
> 时间：2012-05-23T15:26:30.330
> 
> 标签：objective-c, model-view-controller, nsurlconnection

我试图找出在我的应用程序中实现 MVC 设计的最佳方法。现在，当用户进入 UITableViewController 时，我向我的模型发送请求以访问互联网并下载一些数据。当数据返回时，我希望它更新数据，即使我的 UITableViewController 被释放（通过用户关闭视图或退出视图）。所以目前我更新模型，然后在模型上有一个委托来在 UITableViewController 上“更新 UI”。基本上在数据返回后，我希望模型调用 [tableView reloadData] 并通过委托实现此目的。

我的问题：

1.  这一定是正确的方法吗？我的模型还有其他方法可以调用 UIViewController 上的方法吗？

2.  如果我希望在更改模型时通知多个 ViewController 怎么办……例如，如果我退出 UITableViewController1 然后导航到 UITableViewController2 并使用相同的模型/数据怎么办。我应该在我的模型上创建多个代表吗？

只是在寻找一些最佳实践，并想知道我是否正确地这样做了。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:37:44.477

您可以使用[NSNotification](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/Reference/Reference.html)来提醒监听[器更改，或者使用键值观察](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html#//apple_ref/doc/uid/10000177i)(KVO)。两者都是[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)的风格，它将帮助您消除模型与视图的耦合，并且作为奖励，允许任意数量的观察者找出模型的变化，而无需单独告诉他们。

有自动和手动更改通知。 [这解释了差异](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueObserving/Articles/KVOCompliance.html)。

我打赌你会做手动通知，所以你会这样做：

```
[self willChangeValueForKey:@"something"];
... // update 'something' here
[self didChangeValueForKey:@"something"]; 
```

观察者会收到通知。自动方法需要使用您可能不会在内部使用的属性方法。通常 KVO 适用于模型的单个属性，当然模型内可能有很多发送通知。如果你正在做更多“我刚刚完成流程 X”的事情，它可能更像是一个 NSNotification。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:34:40.417

回答问题 2 - 如果您有一些对象，应该通知某些事件，您应该使用 NSNotifications（观察者模式）。这可以帮助您以简单的方式使这些对象做出反应、更新它们的视图等

# doctrine-orm - 教义 2 - PHP 致命错误：找不到类 'Doctrine\\ORM\\EntityRepository'

> ID：10723125
> 
> 赞同：1
> 
> 时间：2012-05-23T15:26:31.727
> 
> 标签：doctrine-orm, repository

不是在这里搜索解决方案后，我才决定提出这个问题。其他一些“提问者”已经在这里完成了，虽然我已经尝试了一些可能提供的解决方案，但我一直遇到同样的错误。

PHP 似乎无法找到 EntityRepository 类，尽管我逐字遵循 Doctrine 的教程。

这是我的设置：

存储库/UserRepository.php

```
use Doctrine\ORM\EntityRepository;

class UsersRepository extends Doctrine\ORM\EntityRepository {

    public function getAllUsers(){
        $dql = 'SELECT u.id, u.name FROM Users u';
        $query = $this->getEntityManager()->createQuery($dql);
        return $query->getResult();

    }     

} 
```

实体/Users.php

```
// This tells Doctrin which table to use from the schema
/**
 * @Entity(repositoryClass="UsersRepository")
 * @Table(name="users")
 **/    

class Users {

    /**
     * @Id @Column(type="integer") @GeneratedValue
     **/        
    protected $id;

    /**
     * @Column(type="string")
     **/        
    protected $name;    

    public function __construct() {

    }

    public function setUserName($name)
    {
        $this->name = $name;
    }

    public function getUserName()
    {
        return $this->name;
    }

} 
```

并在引导文件 - /bootstrap.php - 我添加

```
// including all repositories
require_once 'repositories/UsersRepository.php'; 
```

当我运行 /getUsers.php

```
require_once 'bootstrap.php';

echo '<p>fetching all users</p>';

$allUsers = $b->entityManager->getRepository('Users')->getAllUsers(); 
```

那是我在我的 apache 错误日志中收到错误的时候。如果有人遇到过同样的情况，请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T11:08:54.583

打开你的 bootstrap.php 文件并在 bootstrap_doctrine.php 的 require_once**下**切换 require_once 代码：

```
if (!class_exists("Doctrine\Common\Version", false))
{
    require_once ("bootstrap_doctrine.php");
}

require_once "repositories/UsersRepository.php"; 
```

# android - Android loadURL 只加载一半的 html 页面

> ID：10723128
> 
> 赞同：0
> 
> 时间：2012-05-23T15:26:37.443
> 
> 标签：android, android-webview

**已解决：问题是第二张图片真的很大！**

我对此有点困惑......可能我错过了一些非常基本的东西。

我正在尝试将这个简单的 html 页面显示为我的 UI 的一部分（那里有很多元素，而不仅仅是 webview）

```
<html>
<head>
</head>

<body bgcolor="black">

    <div align="center">
    <h2>Blabla</h2>
    <p>
        <img src="images/image1.jpg" width="300" />
    </p>
    <p>
        <img src="images/image2.jpg" width="300" />
    </p>
    <h3>tralala</h3>
    </div>
</body>

</html> 
```

这就是我尝试显示内容的方式（网址是真实的网址，而不是资产！）：

```
WebView mWebView = (WebView) findViewById(R.id.webview);
mWebView.getSettings().setJavaScriptEnabled(true);
mWebView.loadUrl("url"); 
```

这是 main.xml 文件的相关部分：

```
<WebView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/webview"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
 /> 
```

发生的情况是它加载了第一个图像和文本 blabla，但没有加载 tralala 和第二个图像。就像它停止加载一样。我怎样才能解决这个问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:44:00.460

检查 url 的格式如下

> “文件：///android_asset/index.html”

如果 index.html 在资产文件夹下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:33:16.893

image2.jpg 真的很大，这似乎导致了问题。负责html网站的人现在调整了图片的大小，现在工作正常。

# symfony - 动态更改 SwiftMailer 中的 smtp 设置

> ID：10723129
> 
> 赞同：8
> 
> 时间：2012-05-23T15:26:37.843
> 
> 标签：symfony, swiftmailer

我在 Symfony 2 中使用 SwiftMailer 包。我在 config.yml 文件中传递了我的 smtp 用户/密码设置，效果很好，但是当我发送邮件时，我需要从数据库中获取这些设置。我可以访问这个参数：

```
$mailer = $this->getContainer()->get('mailer')->getTransport(); 
```

但是是否可以在运行时更改它们？我没有看到任何设置方法。非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T14:21:33.883

非常感谢，但这不是我正在寻找的解决方案，根据内核请求，我不知道我将使用哪个帐户。我需要更改发送邮件循环中的设置。我找到了很酷的解决方案：

```
foreach ($locations as $location) {
    // get settings for account
    $user = $location->getSmtpUser();
    $pass = $location->getSmtpPass();

    // switch to new settings
    $transport = $this->getContainer()->get('mailer')->getTransport();            
    $ext = $transport->getExtensionHandlers();
    $auth_handler = $ext[0];            
    $auth_handler->setUserName($user);
    $auth_handler->setPassword($pass);

    // send message using new settings
    $message = \Swift_Message::newInstance()
         ->setSubject( $subject )
         ->setFrom( $from )
         ->setTo( $email )
         ->setBody( $body )
         ->setContentType('text/html');

       $this->getContainer()->get('mailer')->send( $message );    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T17:25:43.370

您可以创建一个`kernel.request`事件侦听器，注入`swiftmailer.transport.real`并设置 smpt 信息，例如

监听类

```
namespace Namespace\Of\YourListener;

use Symfony\Component\EventDispatcher\EventSubscriberInterface;
use Symfony\Component\HttpKernel\Event\GetResponseEvent;

class YourListener implements EventSubscriberInterface
{

    /**
     * @var Swift_Transport_EsmtpTransport
     */
    private $transport;

    /**
     * @var Doctrine\ORM\EntityManager
     */
    private $em;

    public function __construct($transport, $em)
    {
        $this->transport = $transport;
        $this->em = $em;
    }

    public function onKernelRequest(GetResponseEvent $event)
    {
        //fetch info from db
        $this->transport->setHost("host");
        $this->transport->setPort("port");
        $this->transport->setUserName("username");
        $this->transport->setPassword("pass");
    }

    static public function getSubscribedEvents()
    {
        return array(
            KernelEvents::REQUEST => array('onKernelRequest', 0)
        );
    }

} 
```

服务减速，

```
your_listener:
    class: FQCN\Of\YourListener
    tags:
        - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }
    arguments: [@swiftmailer.transport.real, @doctrine.orm.entity_manager] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-12T00:11:51.890

I know this is a bit old, but I wanted to get an answer in in-case it helps somebody else. We are using the file spooler with an SMTP transport and needed to have customized SMTP server connections depending on site.

Our solution was to modify Swiftmailer to allow for some additional data on each message as well as tying it into Symfony2's Event Dispatcher. This allowed us to extract the connection info from each message at the time of the spool flushing.

We made it into a bundle so it can be leveraged by others. You can read about it [here](http://westinpigott.wordpress.com/2013/07/12/dynamic-smtp-settings-per-message-in-symfony2/).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-28T18:38:36.513

实际上，您应该调用`$transport->stop();` ，因为在其他方式 Swift Mailer 不会重新连接，并且在 1 个脚本执行期间将使用旧设置

# c# - 循环遍历列表并执行函数

> ID：10723132
> 
> 赞同：0
> 
> 时间：2012-05-23T15:26:55.440
> 
> 标签：c#

我有一个对象模型，其中包含几个其他对象的列表。我想循环考虑列表中的每个对象并在它们上执行一个方法。该方法称为 MyMethod，列表中的每个对象在其类定义中都有此方法。

这就是我所拥有的：

```
public class MyObject
{
  public List<NestedObject1> ListNestedObject1 { get; set; }
  public List<NestedObject2> ListNestedObject2 { get; set; }

  public void ExecuteMethodsOfNestedObjectLists()
  {
    if (ListNestedObject1.Count > 0) { from a in ListNestedObject1 a.MyMethod();}
    if (ListNestedObject2.Count > 0) { from a in ListNestedObject2 a.MyMethod();}
  }
} 
```

我正在寻找测试每个嵌套对象列表的长度并在每个元素上执行 MyMethod 。我知道我可以做一个 foreach 循环，但我想看看如何使用 linq 语法来保持简短。

我如何重写它以使其工作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:34:28.060

所以你问如何为每个嵌套对象执行这个方法？

```
ListNestedObject1.ForEach(obj => obj.MyMethod());
ListNestedObject2.ForEach(obj => obj.MyMethod()); 
```

注意：[`List.ForEach`](http://msdn.microsoft.com/en-us/library/bwabdf9z%28v=vs.80%29.aspx)不是 LINQ（尽管它具有相似的外观）并且是在 .NET 2.0 中引入的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:32:17.267

您应该使用 foreach 循环。这就是它的用途。

Linq 专为查询数据而设计，并非旨在用于产生副作用。看来您正在寻找的是一种 Linq`ForEach`扩展方法。如果您有兴趣， Eric Lippert会更详细地[解释](http://blogs.msdn.com/b/ericlippert/archive/2009/05/18/foreach-vs-foreach.aspx)为什么有意从语言中*省略了这一点。*

当然，您可以自由地忽略这些哲学问题并编写自己的`ForEach`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:34:15.063

您可以使用[ForEach](http://msdn.microsoft.com/en-us/library/bwabdf9z.aspx)扩展方法 from `List<T>`，这实际上与`foreach`循环相同。请注意，这在 上不可用`IEnumerable<T>`，并且一般来说，是否应该使用它来代替`foreach`循环存在很大争议。

```
MyObject.ListNestedObject1.ForEach(MyMethod);
MyObject.ListNestedObject2.ForEach(MyMethod); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:32:10.200

代替

```
 if (ListNestedObject1.Count > 0) { from a in ListNestedObject1 a.MyMethod(); } 
```

利用

```
 if (ListNestedObject1.Count > 0)
    { 
        ListNestedObject1.Select(
        a=>
            { 
                a.MyMethod(); 
                return a;
            } 
    } 
```

类似地替换查询`ListNestedObject2`

# java - 验证错误后，后续 ajax 请求从 UI 组件而不是 Beans 获取值

> ID：10723133
> 
> 赞同：6
> 
> 时间：2012-05-23T15:27:05.470
> 
> 标签：java, ajax, validation, jsf, omnifaces

在我的基于 JSF 2 的应用程序中，我有一个包含（在其他 UI 组件中）一些复选框的表单。

在复选框上，我注册了 ajax 请求，它们在被选中时触发。ajax 请求实际上只会更新支持 bean 中另一个复选框的值。结果，另一个复选框也将被选中（当它重新渲染时 - 因为它将在渲染响应阶段从支持 bean 获取更新的值）。

在整个表单被提交并发生验证错误之前，这可以正常工作。然后，ajax 请求仍然有效并更改支持 bean 上的值，但在重新呈现更新后的复选框的阶段，它的值不是从支持 bean 中获取，而是来自从`ComponentStateHelper`类中获取的缓存值。

据我了解，这用于 JSF 2 的新功能，仅存储对组件树的部分更改。

我不明白的是：这与验证阶段有什么关系？`StateHelper`当验证发现错误时，为什么我的复选框的类中有缓存值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:58:32.687

[这是一个已知问题，并在此答案](https://stackoverflow.com/questions/6642242/how-can-i-populate-a-text-field-using-primefaces-ajax-after-validation-errors-oc/6845800#6845800)中进行了深入解释。简而言之，问题是因为要渲染`<f:ajax render>`但未被执行的无效组件`<f:ajax execute>`与原始提交的值一起保持无效状态。当 JSF 渲染输入组件时，JSF 会先检查提交的值是不是`null`然后显示，否则显示模型值。您基本上需要重置要呈现但未由 ajax 执行的输入组件的提交值。

为此，您可以使用[`ActionListener`](http://docs.oracle.com/javaee/6/api/javax/faces/event/ActionListener.html)基本上执行以下操作的*an*：

```
UIViewRoot viewRoot = context.getViewRoot();
PartialViewContext partialViewContext = facesContext.getPartialViewContext();
Set<EditableValueHolder> inputs = new HashSet<EditableValueHolder>();

// First find all to be rendered inputs and add them to the set.
findAndAddEditableValueHolders(partialViewContext.getRenderIds(), inputs);

// Then find all executed inputs and remove them from the set.
findAndRemoveEditableValueHolders(partialViewContext.getExecuteIds(), inputs);

// The set now contains inputs which are to be rendered, but which are not been executed. Reset them.
for (EditableValueHolder input : inputs) {
    input.resetValue();
} 
```

这已被报告为[JSF 问题 1060](http://java.net/jira/browse/JAVASERVERFACES_SPEC_PUBLIC-1060)，并且已在[OmniFaces](http://omnifaces.org)库中实现了一个完整且可重用的解决方案（[此处](http://showcase.omnifaces.org/eventlisteners/ResetInputAjaxActionListener)[`ResetInputAjaxActionListener`](http://omnifaces.org/docs/javadoc/current/org/omnifaces/eventlistener/ResetInputAjaxActionListener.html)为源代码[，此处](https://github.com/omnifaces/omnifaces/blob/master/src/main/java/org/omnifaces/eventlistener/ResetInputAjaxActionListener.java)展示演示）。

# android - Mobfox 广告失败，不显示任何广告

> ID：10723134
> 
> 赞同：2
> 
> 时间：2012-05-23T15:27:05.597
> 
> 标签：android, ads

我已经在我的应用程序中实现了 MobFox。

我有两个问题。

1.  即使在测试模式下，起初广告无法加载（bannerLoadFailed）然后我看到它（bannerLoadSucceeded）。这是由 onResume() 方法引起的。没有它，加载就不会失败。为什么？

2.  它不显示任何广告。在测试模式下，它会在模拟器中和从市场下载的测试广告中显示，但在实时模式下，该`noAdFound()`方法处于活动状态，在 toast 中显示“未找到 MobFox 广告”。根据文档

> noAdFound 表示当前没有可用于广告请求的广告

我来自匈牙利，但朋友在 MobFox 总部所在的奥地利下载了该应用程序，所以我怀疑奥地利没有广告请求...

MobFox 仪表板显示 3 次展示，我不知道它们是否来自测试广告。如果它们来自真实广告，则问题 2 可以忽略，但我仍然不知道为什么我的朋友看不到任何广告。

请您看一下代码以查看可能导致问题的原因（是否存在）？

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
            MobFoxlayout = (RelativeLayout)findViewById(R.id.mobfoxContent);
            mobfoxView = new MobFoxView(Main.this, "211bcbf66f79c0355e43e849aec76b6c", Mode.LIVE, true, true);
            mobfoxView.setBannerListener(new BannerListener() {

            @Override
            public void bannerLoadFailed(RequestException cause) {
                Toast.makeText(getApplicationContext(), "Mobfox ad failed ", Toast.LENGTH_SHORT).show();
            }

            @Override
            public void noAdFound() {
                Toast.makeText(getApplicationContext(), "No MobFox ad Found", Toast.LENGTH_SHORT).show();
            }
            @Override
            public void bannerLoadSucceeded() {
                Toast.makeText(getApplicationContext(), "MobFox Ad loaded successfully", Toast.LENGTH_SHORT).show();    
            }

            @Override
            public void adClicked() {
                Toast.makeText(getApplicationContext(), "MobFox Ad clicked", Toast.LENGTH_SHORT).show();
            }
            });
            MobFoxlayout.addView(mobfoxView);
    }
    @Override
    protected void onResume() {  //ad fails to load
        super.onResume();
        mobfoxView.resume();
    }

    @Override
    protected void onPause() {
        super.onPause();
        mobfoxView.pause();
    }

@Override
public void onConfigurationChanged(Configuration newConfig) {
super.onConfigurationChanged(newConfig);
mobfoxView.pause();
mobfoxView.resume();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-27T14:41:59.817

我不知道出了什么问题，但它有效。我正在发布整个代码以供其他人帮助。这段代码最重要的部分是，当 MobFox 广告失败时，我设法展示了 admob 广告！

重要的是，如果您将 MobFox 广告切换到测试模式，您将在模拟器中看到测试广告。在我的手机上，我没有看到任何实时或测试广告，但我在 MobFox 仪表板上看到了很多展示。有时我也看不到任何 admob 广告。在我的手机上，我曾经见过他们，在我兄弟的手机上，我们从未见过他们。但考虑到我从他们那里赚钱，他们就在那里。

```
public class MainActivity extends Activity {

//MOBFOX----------------------------
private RelativeLayout rlayout;
private MobFoxView mobfoxView;

//ADMOB-----------------------------
private AdView adView;

@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main2);
final Handler updateHandler = new Handler();
        rlayout = (RelativeLayout) findViewById(R.id.mobfoxContent);
        mobfoxView = new MobFoxView(MainActivity.this, "37a12617ccdc6bd4bafdded4e8441bca", Mode.LIVE, false, false);
        mobfoxView.setBannerListener(new BannerListener() {
        @Override
        public void bannerLoadFailed(RequestException cause) {
            //Toast.makeText(getApplicationContext(), "MobFox failed", Toast.LENGTH_LONG).show();
              adView = new AdView(MainActivity.this, AdSize.BANNER, MY_AD_UNIT_ID);
              LinearLayout layout = (LinearLayout)findViewById(R.id.admobContent);
              layout.addView(adView);
              adView.loadAd(new AdRequest());

        }
        @Override
        public void noAdFound() {
            //Toast.makeText(getApplicationContext(), "MobFox noAd", Toast.LENGTH_LONG).show();
              adView = new AdView(MainActivity.this, AdSize.BANNER, MY_AD_UNIT_ID);
              LinearLayout layout = (LinearLayout)findViewById(R.id.admobContent);
              layout.addView(adView);
              adView.loadAd(new AdRequest());

        }
        @Override
        public void adClicked() {
            //Toast.makeText(getApplicationContext(), "MobFox clicked", Toast.LENGTH_LONG).show();
            // TODO Auto-generated method stub

        }
        @Override
        public void bannerLoadSucceeded() {
            //Toast.makeText(getApplicationContext(), "MobFox success", Toast.LENGTH_LONG).show();
            // TODO Auto-generated method stub

        }
        });

        mobfoxView.setVisibility(View.VISIBLE);
        mobfoxView.setOnClickListener(new android.view.View.OnClickListener(){

            @Override
            public void onClick(View v) {
                updateHandler.post(new Runnable() {
                    public void run() {
                        //Toast.makeText(getApplicationContext(), "MobFox clicked2", Toast.LENGTH_LONG).show();
                    }
                });

            }});

        rlayout.addView(mobfoxView);

}

    @Override
    protected void onDestroy() {

        if (adView != null) {
                adView.destroy();
        }
        super.onDestroy();
        //mManager.release();
    }
    @Override
    protected void onPause() {
        super.onPause();
        mobfoxView.pause();
    }

    @Override
    protected void onResume() {
        super.onResume();
        mobfoxView.resume();
    }
} 
```

xml:

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/bg_selector"
    android:orientation="vertical" >

<!-- objects -->

     <LinearLayout 
        android:id="@+id/admobContent"
        android:layout_alignParentBottom="true"
        android:layout_width="fill_parent"
        android:layout_height="50dp">
    </LinearLayout>

   <RelativeLayout 
        android:id="@+id/mobfoxContent"
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:layout_centerHorizontal="true"
        android:layout_alignParentBottom="true" />

</RelativeLayout> 
```

并且不要忘记这些到所有布局文件夹！

# jquery - jquery 重新声明 $(this)

> ID：10723135
> 
> 赞同：3
> 
> 时间：2012-05-23T15:27:07.687
> 
> 标签：jquery, variables, this

函数`$.(this)`后不能重新声明吗？`$.click()`因为这些似乎都不起作用：

```
$(this) = $(this).find('span');
var $(this) = $(this).find('span'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:28:58.373

您只能声明`var foo`when`foo`是合法*标识符*。

`$(this)`是*调用*`$`以参数命名的函数的结果，`this`因此它在声明中是不合法的。

你也不应该覆盖`this`- 它会在未来引起很多头疼！

如果你想要一个用于存储 jQuery 版本的局部变量，`this`那么一个常见的约定是：

```
var $this = $(this);
var $span = $this.find('span'); 
```

其中（完全合法，但有时不赞成）`$`前缀让您记住该变量是一个 jQuery 对象，而不是一个普通的 DOM 元素。

该约定还允许您发现这样做的浪费（但常见）错误：

```
var jqobj = $(myobj) 
```

when*已经*`myobj`是一个 jQuery 对象。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T15:29:12.590

该表达式`$(this)`不是一个变量声明，而是一个表达式。如果要重新声明某些内容，则需要将其存储在变量中

```
var saved = $(this);
saved = $(this).find('span'); 
```

最终版本有效的原因是您将其分配给实际标识符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T15:29:15.150

```
$('some').on('click', function() {
  var refrence = $(this);
  var span = refrence.find('span')
  // to override the $this you can use
  refrence = refrence.find('span');
}); 
```*

# c# - 在 MVC 视图中显示可变文本

> ID：10723136
> 
> 赞同：0
> 
> 时间：2012-05-23T15:27:13.800
> 
> 标签：c#, asp.net-mvc, resx

我正在为以下问题寻找一个好的解决方案：

我有一个 ASP.NET MVC Web 应用程序，由我的几个客户使用。在应用程序中，客户可以登录、查看包含信息的多个页面并填写多个表格。这一切都很好。

但是，我想要的是在视图中显示不同的文本，具体取决于客户端的属性（在这种情况下为 A 类型）。这些文本可以是多语言的，用户可以在应用程序中更改语言。

我为此提出了几种解决方案，但我不确定最好的主意是什么。到目前为止，这些是我的想法：

**在数据库中保存信息**

在这种情况下，我会创建一个表（例如“ProgramTexts”），其中包含一个键、客户端的类型、语言和它自己的文本。然后，在我的控制器中，我将检索该视图中使用的键，将它们设置在 ViewModel 中并将该视图模型传递给视图。在视图中，我可以轻松地在 ViewModel 中显示给定变量的值。

我认为这对于小型站点非常有用，但是对于许多不同的控制器和视图来说似乎有点笨拙。我宁愿直接从视图中“调用”文本，但是从视图中调用数据库也好不到哪里去。

**资源文件**

由于本地化功能的内置，我的另一个想法是使用资源文件。但是，我不确定如何根据额外的变量（本例中的类型）从资源中检索变量。

有没有人对如何实现这一目标有其他想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:31:55.623

我会选择资源文件选项。是否可以为这些类型提供不同的资源文件？或者是否可以为不同的类型使用不同的变量名？

例如

```
Message1_TypeA
Message2_TypeB 
```

ETC

然后，您可以使用一些聪明的技巧来根据类型读取正确的消息，也许是反射之类的聪明技巧。

另一种选择可能是这样分隔字符串

消息 1 = "A|B|C|D";

这样您就可以检索所有类型的消息，然后在您的代码中您可以检索当前类型的正确消息。我解释得好吗？我不认为我做到了。

# java - 我在哪里可以找到“j_security_check”？

> ID：10723138
> 
> 赞同：21
> 
> 时间：2012-05-23T15:27:19.620
> 
> 标签：java, jsp, tomcat, servlets

是否有“j_security_check”的标准位置以便我可以查看？

搜索我的电脑没有找到该文件，只是引用它。那么它是出于安全原因隐藏还是不是文件？

我已被锁定在应用程序之外，这是我首先考虑寻找解决方案的地方。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-23T15:29:36.520

它是[Servlet API](http://jcp.org/aboutJava/communityprocess/final/jsr315/index.html)的一部分，由 servletcontainer 实现。在您的情况下，它是由 Tomcat 实现的。更具体地说，[`org.apache.catalina.authenticator.FormAuthenticator`](https://github.com/apache/tomcat/blob/7.0.0/java/org/apache/catalina/authenticator/FormAuthenticator.java)类。

```
227        // Is this the action request from the login page?
228        boolean loginAction =
229            requestURI.startsWith(contextPath) &&
230            requestURI.endsWith(Constants.FORM_ACTION);
231
232        // No -- Save this request and redirect to the form login page
233        if (!loginAction) {
234            session = request.getSessionInternal(true);
235            if (log.isDebugEnabled())
236                log.debug("Save request in session '" + session.getIdInternal() + "'");
237            try {
238                saveRequest(request, session);
239            } catch (IOException ioe) {
240                log.debug("Request body too big to save during authentication");
241                response.sendError(HttpServletResponse.SC_FORBIDDEN,
242                        sm.getString("authenticator.requestBodyTooBig"));
243                return (false);
244            }
245            forwardToLoginPage(request, response, config);
246            return (false);
247        }
248
249        // Yes -- Validate the specified credentials and redirect
250        // to the error page if they are not correct
251        Realm realm = context.getRealm();
252        if (characterEncoding != null) {
253            request.setCharacterEncoding(characterEncoding);
254        }
255        String username = request.getParameter(Constants.FORM_USERNAME);
256        String password = request.getParameter(Constants.FORM_PASSWORD);
257        if (log.isDebugEnabled())
258            log.debug("Authenticating username '" + username + "'");
259        principal = realm.authenticate(username, password);
260        if (principal == null) {
261            forwardToErrorPage(request, response, config);
262            return (false);
263        } 
```

[`Constants.FORM_ACTION`](https://github.com/apache/tomcat/blob/7.0.0/java/org/apache/catalina/authenticator/Constants.java)是`/j_security_check`。_

至于您被锁定的具体问题，请确保您提供正确的用户名和密码。用户数据库通常由[领域](https://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html)配置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T15:29:30.807

这不是文件，这是基于容器的身份验证的别名：

[http://docs.oracle.com/javaee/1.4/tutorial/doc/Security5.html](http://docs.oracle.com/javaee/1.4/tutorial/doc/Security5.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-12-30T10:36:31.400

您无需对 j_security_check 执行任何操作。问题出在其他地方：

例如：

连接到数据库（或者在您的情况下，如果您使用的是 Tomcat，则为 tomcat-users.xml 文件），密码加密，web.xml 中的某些内容， context.xml 中的某些内容。对于 Glassfish，它也可以是 pool 和 realm 或者 glassfish-web.xml 中的东西。

仔细检查日志。对于 GF，您需要像这样启用 Finest： (a) 转到此页面：[http://localhost:4848/common/monitor/serverInstMonitoringServerPage.jsf](http://localhost:4848/common/monitor/serverInstMonitoringServerPage.jsf)。(b) 将此属性设置为 Finest：javax.enterprise.system.core.security

# core-animation - 为什么 CABasicAnimation 显示两点移动？

> ID：10723139
> 
> 赞同：-1
> 
> 时间：2012-05-23T15:27:23.180
> 
> 标签：core-animation, quartz-graphics, cabasicanimation

我试图展示一个简单的点移动。我设置了一个图层，设置了边界、位置和颜色，然后使用 CAAnimation 显示它在移动

```
 CALayer *l = [CALayer layer];

    l.bounds = CGRectMake(0,0,20,20);
    l.position = CGPointMake(x,y);
    l.cornerRadius = 10;
    l.backgroundColor = [UIColor blueColor].CGColor;

    [self.theView.layer addSublayer:l];

    CABasicAnimation *anim1 = [CABasicAnimation animationWithKeyPath:@"position"];
    anim1.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
    CGPoint to = CGPointMake(x+dx, y+dy);
    anim1.fromValue = [l valueForKey:@"position"];
    anim1.toValue = [NSValue valueWithCGPoint:to];
    l.position = to;
    anim1.duration = 3.0; 
```

当我运行它时，我看到两个蓝色圆圈在移动。我想看到一个圆圈从 (x,y) 移动到 (x+dx,y+dy)。有人可以告诉我我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:50:35.337

它只为我显示一个圆圈，但我将动画添加到图层（您的代码示例没有这样做），如下所示（在您的最后一行代码之后）：

```
[l addAnimation:anim1 forKey:@"myNumberOneAnimation"]; 
```

如果没有那行代码，您将通过设置图层的位置获得**隐式**动画。更改与视图无关的图层的动画属性会导致隐式动画。另一方面，当您通过将动画添加到图层来显式地为位置设置动画时，它将显示而不是隐式动画。

您还可以通过更改 fillMode 来配置动画开始之前和结束之后的外观，如下所示：

```
anim1.fillMode = kCAFillModeBoth; 
```

如果添加这些行不能解决问题，那么它在您的代码中的其他地方。如果是这样，请在您设置动画或更改“l”层属性的位置发布更多代码。

# html - Emacs org-mode：为 HTML 导出器指定原始区域

> ID：10723143
> 
> 赞同：3
> 
> 时间：2012-05-23T15:27:32.873
> 
> 标签：html, emacs, org-mode

将 org-mode 缓冲区导出到 html 时出现问题。下表未正确导出：

```
|-------+----------------+----------|
| HOST  | DB             | COMMENTS |
|-------+----------------+----------|
| rhea  | numbering_test |          |
| rhea  | phones         |          |
| dione | phonenumbers   |          |
| dione | numbering_test |          |
|-------+----------------+----------| 
```

问题是下划线告诉导出的 HTML 使用下标。这不是我想要的。我想`numbering_test`看起来像普通文本。

使用嵌入在普通文本中的那些标识符时，同样的问题，如下所示：

```
The numbering_test database is too big. 
```

HTML 导出器再次出现同样的问题。

有没有办法告诉 HTML 导出器按照提供的方式将一些文本置于原始模式，而不向其中添加额外的 HTML 格式？

Markdown（在 StackOverflow 中使用）具有非常有用的反引号，可以将原始代码嵌入到普通文本中。对于 org-mode，我需要类似的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T16:50:52.427

org-export 有指令，因此它忽略下划线作为下标。

[http://orgmode.org/manual/Export-options.html#Export-options](http://orgmode.org/manual/Export-options.html#Export-options)

你感兴趣的是

```
#+OPTIONS:     ^:nil 
```

它指示导出器仅在显式`{...}`括号内使用子/上标文本。

您可以通过导出调度程序插入整个模板：`C-c C-e t`. 然后您随意更改/删除，并`C-c C-c`刷新设置。

# mysql - MySQL：SQL 语法错误

> ID：10723145
> 
> 赞同：0
> 
> 时间：2012-05-23T15:27:36.420
> 
> 标签：mysql, csv, import

我正在尝试从 MySQL 表中收集/选择数据，以根据 cSV 文件中的新数据对其进行检查，然后对其进行更新。我坚持选择脚本的数据部分。

这是错误消息：

> /home/atkelect/public_html/test/ap/import_list.php 1064 中的第 44 行错误 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“FROM products WHERE products_model = 'A040503'' 附近使用正确的语法

```
SELECT products_id, list_price, FROM products WHERE products_model = 'A040503' 
```

[急停]

这是第 44 行：

```
 $product_query = tep_db_query("SELECT products_id, list_price, FROM ".TABLE_PRODUCTS." WHERE     products_model = '".tep_db_input($line[0])."'"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T15:28:50.703

去掉list_price后面的逗号，应该是这样的

```
SELECT products_id, list_price FROM... 
```

# javascript - 如何使用微模板

> ID：10723154
> 
> 赞同：0
> 
> 时间：2012-05-23T15:28:06.153
> 
> 标签：javascript, jquery, json, jquery-templates

出于某种原因，我无法让[John Resig 微模板](http://ejohn.org/blog/javascript-micro-templating/)工作。我读过[这里](https://stackoverflow.com/a/1775085/1252748)，并且可以让这个例子工作，但它是一个非常简单的对象。（即`var data = { fname : "fred" };`），但是，当我尝试使用我更复杂的对象时

```
{"order":{"name":"TRADEMARK WHEEL COMPANY","sales_order_id":"18278","order_date":"05 \u2044 15 \u2044 2012","due_date":"05 \u2044 21 \u2044 2012","order_number":"1213140","reference":"21192D\/35546","order_description":"BICICLETTE","ship_name":"ADAMS","ship_address1":"1919 W RANDOLPH ST.","ship_address2":"","ship_city":"CHICAGO","ship_state":"IL","ship_postal_code":"60606","ship_country":null,"ship_via":"FEDEX GROUND","tracking_number":null,"package_contents":null,"freight":"0.00","taxable":"0.00","nontaxable":"748.88","sales_tax":"0.00"},"line_item":[{"description":"RED ONE","quantity":"2.00","sell_price":"349.44"},{"description":"FRONT GEAR","quantity":"2.00","sell_price":"15.00"},{"description":"5th GEAR","quantity":"2.00","sell_price":"10.00"}]} 
```

并尝试像这样访问它

```
<script>
(function () {

  var submitStr="test string of data";

  $.ajax({
    type: "POST",
    url: "getJSON.php",
    data: submitStr,
    success: function (data) {
    console.log(data);
    var generatedText = tmpl("order_detail", data);
    var elem = document.getElementById("elemId");
    elem.innerHTML = generatedText;
    }
    });

}());
</script>
<script id="order_detail" type="text/html">
        <div>
Name:<%=data.order.name%> ID:<%=data.order.sales_order_id%><hr/>

<%for(var i=0;i<data.line_item.length;i++) {%>

      description: <%= data.line_item[i].description %><br/>
      quantity: <%= data.line_item[i].quantity %><br/>
      price: <%= data.line_item[i].sell_price %><hr/>

<%}%>
</div> 

 </script> 
```

我得到`data`未定义的错误。我已经尝试过`data.`，只是尝试直接访问对象的值，但这也不起作用。

我很感激使用这个东西的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:34:38.400

1.在`$.ajax`成功回调`success: function (data)`中，您将获得`data`JSON 字符串，您必须先将其解析为对象，然后再将其传递给`tmpl`函数。

```
$.ajax({
    type: "POST",
    url: "getJSON.php",
    data: submitStr,
    success: function (data) {
        console.log(data);

        data = JSON.parse(data);

        var generatedText = tmpl("order_detail", data);
        var elem = document.getElementById("elemId");
        elem.innerHTML = generatedText;
    }
}); 
```

2.删除模板中的所有`data`前缀。

# c# - 如何在新对话框中显示主从信息 c# wpf

> ID：10723157
> 
> 赞同：1
> 
> 时间：2012-05-23T15:28:10.710
> 
> 标签：c#, wpf, visual-studio, datagrid, master-detail

我有一个带有“JobItem”对象列表的数据网格，当我从这个列表中选择一个项目时，我希望能够在新窗口中打开它并能够编辑它的属性并保存它。我有它的数据绑定部分，我只是不明白如何传递从数据网格中选择的对象实例，并在新窗口中填充其信息。我在 codeproject 中找到了我想做的确切项目并查看了代码，但我仍然无法弄清楚这个对象实例是谁传递的。文章是：

[http://www.codeproject.com/Articles/332615/WPF-Master-Details-MVVM-Application](http://www.codeproject.com/Articles/332615/WPF-Master-Details-MVVM-Application)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:35:10.460

将 投射`ListViewItem`到对象上。

```
`(ObjectType)YourListView.SelectedItem` 
```

会给你一个类的实例，如果这就是你要问的。

然后，您可以通过它的构造函数将其传递给编辑表单。如果按值传递它，则必须以原始形式编写一些更新代码来“合并”更改。

我**认为**如果您通过引用传递它，如果您使用 INotifyPropertyChanged 正确设置它，它将更新它的列表视图。不过，您可能需要对其进行测试以确保。我不是 100% 的。

# php - PHP 会话处理程序 - 在写入会话数据之前更改当前工作目录

> ID：10723162
> 
> 赞同：0
> 
> 时间：2012-05-23T15:28:22.550
> 
> 标签：php, session, working-directory

我正在使用该`session_set_save_handler()`功能将会话保存到数据库，我还有一个自动加载器，它依赖于将工作目录设置为应用程序目录，即`chdir('C:\Some\App\Directory')`.

写入会话时，工作目录已更改为我的 php 安装目录，即`C:\PHP`. 这会导致自动加载器在尝试要求与数据库持久性相关的类时出现致命错误。反正有这个吗？

我正在使用 Zend Framework 1 和 Doctrine 2，尽管我认为这是一个普遍的 PHP 问题，而不是库本身。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T06:24:50.233

我最终只是将自动加载器的路径设为绝对路径

# c# - DragDropEffects.Scroll的解释

> ID：10723164
> 
> 赞同：2
> 
> 时间：2012-05-23T15:28:34.430
> 
> 标签：c#

好的，所以在我的 DragDropManager 中我设置了：

```
DragDropEffects.Scroll 
```

作为一种允许的效果，但由于某种原因它不能正常工作。当我尝试滚动时，它仍然根本不滚动。有人可以正确地向我解释这一点。

我试图在拖动我的类别时使用它。

我已经检查了 MSDN，但对于该功能的实际作用以及如何使用它确实没有提供任何信息。

如果这个问题很愚蠢，我很抱歉，但我希望有人能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T23:26:24.213

在这里可以找到两种解决方案。一种是使用`SendMessage`.NET 代码，另一种是纯 .NET 代码。
[http://www.dotnet247.com/247reference/msgs/16/81341.aspx](http://www.dotnet247.com/247reference/msgs/16/81341.aspx)
（[该网站似乎已关闭，存档页面可以在这里找到](http://web.archive.org/web/20090618072124/http://www.dotnet247.com/247reference/msgs/16/81341.aspx)）

相关的windows消息代码描述在这里：
[ListView onScroll event](https://stackoverflow.com/questions/1176703/listview-onscroll-event)

我的结果代码如下。虽然在这方面我希望它能够检测垂直和水平滚动条的存在并相应地调整底部和右侧滚动触发区域，但它是不完整的。

```
private void treeView_DragOver(object sender, DragEventArgs e)
{
    TreeView senderTree = sender as TreeView;

    TreeNode destinationNode;
    TreeNode newNode = GetDragTreeNode(out destinationNode, sender, e);

    if (newNode == null)
    {
        e.Effect = DragDropEffects.None;
        return;
    }

    int scrollDetectRangeU = 10;
    int scrollDetectRangeL = 10;
    int scrollDetectRangeB = 10 + 20;
    int scrollDetectRangeR = 10 + 20;
    Point treeCoord = CoordToTreeCoord(senderTree, e);

    if (treeCoord.Y < scrollDetectRangeU 
        && (destinationNode == null || destinationNode.PrevVisibleNode != null))
    {
        SendMessage(senderTree.Handle, WindowsMessages.WM_VSCROLL, ScrollBarCommands.SB_LINEUP, IntPtr.Zero);    //scroll up
        Thread.Sleep(10);   //slow down the scrolling a bit
    }
    else if (treeCoord.Y >= senderTree.Height - scrollDetectRangeB 
        && (destinationNode == null || destinationNode.NextVisibleNode != null))
    {
        SendMessage(senderTree.Handle, WindowsMessages.WM_VSCROLL, ScrollBarCommands.SB_LINEDOWN, IntPtr.Zero);    //scroll down
        Thread.Sleep(10);   //slow down the scrolling a bit
    }

    if (treeCoord.X < scrollDetectRangeL)
    {
        SendMessage(senderTree.Handle, WindowsMessages.WM_HSCROLL, ScrollBarCommands.SB_LINELEFT, IntPtr.Zero);     //scroll left
    }
    else if (treeCoord.X >= senderTree.Width - scrollDetectRangeR)
    {
        SendMessage(senderTree.Handle, WindowsMessages.WM_HSCROLL, ScrollBarCommands.SB_LINERIGHT, IntPtr.Zero);     //scroll right
    }

}

private static TreeNode GetDragTreeNode(out TreeNode destinationNode, object sender, DragEventArgs e)
{
    TreeNode newNode = null;

    if (e.Data.GetDataPresent("System.Windows.Forms.TreeNode", false))  
    {
        newNode = (TreeNode)e.Data.GetData("System.Windows.Forms.TreeNode");
    }

    if (newNode != null)
    {
        destinationNode = CoordToTreeNode(sender, e);    
    }
    else
    {
        destinationNode = null;
    }

    return newNode;
}

public static Point CoordToTreeCoord(object senderTree, DragEventArgs e)
{
    return CoordToTreeCoord(senderTree as TreeView, e.X, e.Y, true);
}

public static Point CoordToTreeCoord(TreeView senderTree, int x, int y, bool usePointToClient)
{
    Point pt = usePointToClient ? senderTree.PointToClient(new Point(x, y)) : new Point(x, y);

    return pt;
}

public static TreeNode CoordToTreeNode(object senderTree, DragEventArgs e)
{
    return CoordToTreeNode(senderTree as TreeView, e.X, e.Y, true);
}

public static TreeNode CoordToTreeNode(TreeView senderTree, int x, int y, bool usePointToClient)
{
    Point pt = CoordToTreeCoord(senderTree, x, y, usePointToClient);
    TreeNode destinationNode = senderTree.GetNodeAt(pt);

    return destinationNode;
}

[DllImport("user32.dll")]
static extern IntPtr SendMessage(IntPtr hWnd, Int32 Msg, ScrollBarCommands wParam, IntPtr lParam);  

public enum ScrollBarCommands : int
{
    SB_LINEUP = 0,
    SB_LINELEFT = 0,
    SB_LINEDOWN = 1,
    SB_LINERIGHT = 1,
    SB_PAGEUP = 2,
    SB_PAGELEFT = 2,
    SB_PAGEDOWN = 3,
    SB_PAGERIGHT = 3,
    SB_THUMBPOSITION = 4,
    SB_THUMBTRACK = 5,
    SB_TOP = 6,
    SB_LEFT = 6,
    SB_BOTTOM = 7,
    SB_RIGHT = 7,
    SB_ENDSCROLL = 8
}

public static class WindowsMessages
{
    // Windows messages 
    public const int WM_PAINT = 0x000F;
    public const int WM_HSCROLL = 0x0114;
    public const int WM_VSCROLL = 0x0115;
    public const int WM_MOUSEWHEEL = 0x020A;
    public const int WM_KEYDOWN = 0x0100;
    public const int WM_LBUTTONUP = 0x0202;

    // ScrollBar types 
    public const int SB_HORZ = 0;
    public const int SB_VERT = 1;

    // ScrollBar interfaces 
    public const int SIF_TRACKPOS = 0x10;
    public const int SIF_RANGE = 0x01;
    public const int SIF_POS = 0x04;
    public const int SIF_PAGE = 0x02;
    public const int SIF_ALL = SIF_RANGE | SIF_PAGE | SIF_POS | SIF_TRACKPOS;

    // ListView messages 
    public const uint LVM_SCROLL = 0x1014;
    public const int LVM_FIRST = 0x1000;
    public const int LVM_SETGROUPINFO = (LVM_FIRST + 147);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T13:59:34.050

由于已接受答案中的链接似乎已损坏（再次？）我想知道是否有人浏览此问题可能会对涵盖 Drag & Drop 的博客感兴趣，该博客有一些演示代码管理在 GitHub 上拖动链接时的滚动。

[mikeoncode.blogspot.co.uk](http://mikeoncode.blogspot.co.uk/2016/05/drag-and-drop.html)

一方面是拖动事件参数提供的 XY 坐标是基于屏幕的，并且（如果您要使用它们）您需要使用这些坐标计算（和跟踪）可滚动区域的位置。一旦确定，只需测量拖动光标的相对位置并在光标接近相关边界​​时启动滚动条的更改。[GitHub上的源代码](https://github.com/MikeGWem/DragDropDemo)

# c# - 将 Visual C++ 与 R 结合使用

> ID：10723165
> 
> 赞同：1
> 
> 时间：2012-05-23T15:28:39.060
> 
> 标签：c#, c++, r, visual-c++

我想知道是否有在 Visual Studio 的 Visual C++ 项目中使用 R 包 Rcpp 的解决方法。根据 Rcpp FAQ，这是不可能的。我还遇到了另一个名为 R.NET 的 R 包。这只能与 C# 一起使用，但在 Visual C++ 中似乎没有示例？我错过了另一种选择吗？即使我被迫使用 C#，任何人都可以想象高频交易环境的延迟问题吗？感谢您的任何反馈

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T16:18:07.397

我们在 Rcpp 常见问题解答中清楚地解决了这个问题（包中的小插图，位于 CRAN 站点及其镜像，以及我的网站上）。

简而言之，Rcpp 支持与 R 完全相同的工具链。在 Windows 上，由 Rtools 包为 R 提供的 MinGW（gcc 到 Windows 的端口）。

R Core 只支持 MinGW，我们也是这样做的。如果可以使用 Visual Studio 编译 R，事情会更容易，但由于 Rcpp 位于 R 之上，我们正在玩我们正在处理的手。

很抱歉，Visual Studio 的答案是“不”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:10:16.387

问题是你真正想与什么联系起来。如果您想在 C++ 中使用 R`Rcpp`似乎是错误的决定，因为它将 C++ 连接到 R （而不是像您的问题暗示的那样反过来。）。

如果您想将 R 连接到 C++ 并使用 Visual C++ 仅创建 C++ 代码（而不是将 R 连接到 C++），您可能需要查看[这篇最近的博客文章](http://lejeunedirichlet.wordpress.com/2012/05/18/my-experiences-with-rcpp/)（通过 R-bloggers.com 找到）。它告诉你一种可能的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-06T03:48:17.867

Visual Studio 与 Rcpp 配合得很好。已经做了很多年了。我不同意 Dirk Eddelbuettel。

这是一个重要的事实——例如，有一些非常重要的库（Intels MKL、QT 图形框架）*实际上与 minGW 不*兼容。

[我在 github ( https://github.com/rohan-shah/Rcpp](https://github.com/rohan-shah/Rcpp) )上维护了一个 Rcpp 的（已修补和缩减的）分支，适用于使用 Visual Studio 和 cmake 进行编译。补丁大概是五行，我相信。

免责声明：使用起来很繁琐，您必须知道自己在做什么。如果您*确实*知道自己在做什么，那么我已经为您完成了相当多的工作。有关如何在 Visual Studio 中使用修补 Rcpp 的示例，请参阅[https://github.com/rohan-shah/mpMap2 。](https://github.com/rohan-shah/mpMap2)

# java - 在 Java 中生成真值表

> ID：10723168
> 
> 赞同：9
> 
> 时间：2012-05-23T15:28:48.730
> 
> 标签：java, truthtable

我正在尝试打印一些真值表作为学校作业的一部分。如何在 Java 中生成动态大小真值表？

所以`printTruthTable(1)`打印：

```
0
1 
```

`printTruthTable(3)`印刷：

```
0 0 0
0 0 1
0 1 0
0 1 1
1 0 0
1 0 1
1 1 0
1 1 1 
```

等等。我一直在尝试使用递归来实现它，但我就是做错了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-25T21:02:44.777

这是我对你的问题的看法，在一个小班里写得很好，很紧凑，只需复制/粘贴

请注意我如何使用 modulo2（% 符号）从循环索引中获取 0 和 1

```
public class TruthTable {
    private static void printTruthTable(int n) {
        int rows = (int) Math.pow(2,n);

        for (int i=0; i<rows; i++) {
            for (int j=n-1; j>=0; j--) {
                System.out.print((i/(int) Math.pow(2, j))%2 + " ");
            }
            System.out.println();
        }
    }
    public static void main(String[] args) {
        printTruthTable(3); //enter any natural int
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-23T15:31:25.367

这不是*真值表*，而是二进制数表。您可以使用 Java 的`Integer.toBinaryString`方法来生成您需要的零和一；插入空格应该是微不足道的。

```
int n = 3;
for (int i = 0 ; i != (1<<n) ; i++) {
    String s = Integer.toBinaryString(i);
    while (s.length() != 3) {
        s = '0'+s;
    }
    System.out.println(s);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T15:34:08.780

递归的魔力：

```
public static void main(String args[]) {
    int size = 3;
    generateTable(0, size, new int[size]);
}

private static void generateTable(int index, int size, int[] current) {
    if(index == size) { // generated a full "solution"
        for(int i = 0; i < size; i++) {
            System.out.print(current[i] + " ");
        }
        System.out.println();
    } else {
        for(int i = 0; i < 2; i++) {
            current[index] = i;
            generateTable(index + 1, size, current);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T15:31:22.043

如果您查看正在生成的内容，它似乎是以二进制计数的。你将数到二进制的 2^(n) - 1 并吐出这些位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-16T20:02:23.340

真值表基于数字的二进制表示，但不删除前导零，所以你要做的是从 0 循环到 (1<

```
public void  generate(int n){
    for (int i=0 ;i!=(1<<n);i++) {
        String binaryRep = Integer.toBinaryString(i);
        while (s.length() != n) {
            binaryRep = '0'+binaryRep;
        }
        System.out.println(s);
    }
} 
```

您也可以使用递归来实现：

```
public void generateRecursively(int i , int n){
    if(i==(1<<n))
        return;
    else{
        String temp = Integer.toBinaryString(i);
        while(temp.length()<n){
            temp = '0'+temp;
        }
        System.out.println(temp);
        generateRecursively(i+1,n);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-04T11:48:53.573

这个简单的程序将任何给定数量的输入的真值表存储在一个 int 数组中并打印出来。

```
import java.util.Scanner;

public class Main{

public static class TruthTable {
    public static int rows;
    public static int nodes;
    public static int[][] tt = new int[0][0];

    TruthTable(int n) {
        this.nodes = n;
        this.rows = (int) Math.pow(2,n);
        tt = new int[rows][nodes];

        for (int i=0; i<rows; i++) {
            for (int j=n-1; j>=0; j--) {
                tt[i][j] = (i/(int) Math.pow(2, j))%2;
            }  
        }
    }   

    void printTable(){
        for (int i=0; i<rows; i++) {
            for (int j=nodes-1; j>=0; j--) {
                System.out.printf("%d ", tt[i][j]);
            }
            System.out.println();

        }

    }
}
public static void main(String[] args) {
    Scanner myObj = new Scanner(System.in);
    System.out.println("Enter Size of Population: ");
    int numberOfNodes = myObj.nextInt();
    TruthTable myTable = new TruthTable(numberOfNodes);
    //TruthTable.printTruthTable(3);
    System.out.println();

    myTable.printTable();

} 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-20T06:50:07.580

更长的时间来解决您的问题

```
import java.util.Scanner;
    public class tt{
        boolean arr[][];
        boolean b=false;
        boolean[][] printtt(int n){
            for(int i=0;i<n;i++){
                for(int j=0;j<(Math.pow(2,n));j++){

                        if(j<Math.pow(2,n-1)){
                            arr[j][i]=b;
                        }
                        else{
                            arr[j][i]=!b;
                        }
                }
                }
                return(arr);
            }

        public static void main(String args[]){
            Scanner sc=new Scanner(System.in);
            System.out.println("Input values count");
            tt ob=new tt();
            int num=sc.nextInt();int pownum=(int)Math.pow(2,num);
            boolean array[][]=new boolean[pownum][num];
            array=ob.printtt(num);
            for(int i=0;i<num;i++){
            for(int j=0;j<(Math.pow(2,num));j++){

                    System.out.println(array[j][i]);
                }
        }
    }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-13T03:37:27.250

我最近不得不做一些类似的事情，除了这个项目是为给定的逻辑表达式生成一个真值表。这就是我想出的为自变量分配真值的方法。

```
 column = 0;

    while (column < numVariables)
    {
        state = false;
        toggle = (short) Math.pow(2, numVariables - column - 1);

        row = 1;
        while (row < rows)
        {
            if ((row -1)%toggle == 0)
                state = !state;

            if (state)
                truthTable[row][column] = 'T';
            else
                truthTable[row][column] = 'F';

            row++;
        }

        column++;
    } 
```

这是假设您的第一行填充了变量名称和子表达式。如果您想从第 0 行开始，数学可能会略有变化。

这一点……

如果（（行-1）％切换== 0）

会成为....

if (row%toggle == 0)

# xcode - Xcode Scheme Post-Actions 的日志文件在哪里？

> ID：10723174
> 
> 赞同：45
> 
> 时间：2012-05-23T15:29:02.747
> 
> 标签：xcode, logging, post-build, xcode-scheme

我在我的 Xcode 项目中运行一个脚本，位于 Scheme 的 Build->Post-actions “Run Script”中。它运行良好，但我想查看该脚本的控制台输出。它似乎没有包含在 Log Navigator 选项卡中，我在哪里可以找到此日志？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-10-09T09:36:44.727

默认情况下，这些脚本的输出似乎没有记录在任何地方。最好的办法是手动将脚本的输出重定向到已知位置。例如，将以下内容添加为脚本的第一行：

```
exec > /tmp/my_log_file.txt 2>&1 
```

这会将所有以下输出重定向到 stdout 和 stderr 到您指定的日志文件。

# canvas - 是否可以在 reportlab 文档中使用工具提示或悬停效果？

> ID：10723177
> 
> 赞同：4
> 
> 时间：2012-05-23T15:29:09.320
> 
> 标签：canvas, hyperlink, hover, tooltip, reportlab

我正在使用reportlab 制作交互式图表。图表中的每个条形图都是指向与该条形图表示的数据相关的信息的链接，此功能运行良好。

当我将鼠标悬停在一个栏上时，我会看到该栏链接到的 url。我想在这个“工具提示”中添加一些文本，例如我链接到的网页的标题。

我查看了一些邮件列表线程，并搜索了 reportlab 用户指南，但我找不到任何给出明确答案的内容。这可能吗？

```
from reportlab.pdfgen import canvas
from reportlab.lib.units import inch

c = canvas.Canvas("hover.pdf")

#  This square links to google.com.
#  How do I make the message "Go to google" appear when the user
#    hovers over this square?
c.rect(0*inch, 0*inch, 1*inch, 1*inch, fill=1)
c.linkURL('http://google.com', (0*inch, 0*inch, 1*inch, 1*inch), relative=1)

c.showPage()
c.save() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:59:20.477

PDF 本身支持此功能，请参阅[http://indesignsecrets.com/showing-and-hiding-objects-in-interactive-pdf.php](http://indesignsecrets.com/showing-and-hiding-objects-in-interactive-pdf.php)

但 ReportLab 不支持。您可以尝试在 ReportLab 邮件列表中再次提出此功能，一年前有人在这里要求同样的事情[http://permalink.gmane.org/gmane.comp.python.reportlab.user/10225](http://permalink.gmane.org/gmane.comp.python.reportlab.user/10225)

# javascript - 健全性检查：Rhino 没有 require 函数，对吧？

> ID：10723180
> 
> 赞同：3
> 
> 时间：2012-05-23T15:29:12.647
> 
> 标签：javascript, jvm, rhino

我正在使用带有 jaxax.script 接口的 JVM 中的 rhino。我正在尝试评估包含“require”调用的 JavaScript。这不起作用，因为没有“要求”的定义。只需要一个 v8 的东西吗？或者可能只是一个 node.js 的东西？JVM上有没有办法解决这个问题？我能想到的选项是

*   通过手动包含所需的代码来重写 js 文件
*   调用一个单独的 node.js 进程

（我不一定推荐这些方法。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:47:11.577

`require`是node.js（和其他框架，如[RingoJS](http://ringojs.org/)）使用的[CommonJS规范。](http://www.commonjs.org/)最新版本的 Rhino 确实支持，但 JVM 附带的版本不支持。`require`

要解决这个问题，您可以直接使用 Rhino 代替`javax.script`接口，或者自己实现 CommonJS 模块系统。您也许可以使用较新的 Rhino 版本来代替 JVM，但我不知道这是否可行。

不过，您可能需要使用像 RingoJS 这样的东西，因为可能假定存在其他 CommonJS 规范，但 Rhino 本身并不支持这些规范。当然，依赖于 node.js 特定功能的库仍然存在问题。

# c++ - 如何在 C++ 中的 X、Y 位置启动 CMD 屏幕

> ID：10723183
> 
> 赞同：0
> 
> 时间：2012-05-23T15:29:16.647
> 
> 标签：c++, winapi

我想知道如何设置 c++ cmd 屏幕的坐标，比如从 windows 0,0 像素开始。

可能与系统有关（“”）；但我不知道

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:32:33.997

使用`CreateProcess`API，并通过,字段`STARTUPINFO`中的坐标传递结构。`dwX``dwY`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T17:03:16.743

您还可以创建该过程，然后使用 SetWindowPos

# java - java键/值对对象，不是数组/映射

> ID：10723186
> 
> 赞同：1
> 
> 时间：2012-05-23T15:29:25.070
> 
> 标签：java, object, hashmap, key-value

我想要一个键值对对象。只有两根弦

所以`Object<String, String>`

在我重新发明轮子之前，java中是否有一个现有的对象来促进这一点？

这次我没有立即关注 Hash/Map 的唯一原因是因为一个对象被用来存储多个键/值对。是否有一个设计为只保存一个键/值对，如果我愿意的话，我可以把它变成一个数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:32:58.340

您将需要创建自己的。这样做（AFAIK）是为了从类名中获得更好的语义含义，而不是一般`Pair<>`或`KeyValuePair<>`会

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:33:18.167

[http://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html](http://docs.oracle.com/javase/7/docs/api/java/util/Map.Entry.html)

以及来自 SO [Java 的实现 - 如何创建新条目（键、值）](https://stackoverflow.com/questions/3110547/java-how-to-create-new-entry-key-value)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-09T01:50:44.920

您可以尝试配对的链接列表。

基本结构

(0) --> <-- ((0)(Pair < 1, "Stud" >)(2)) --> <-- (1)(Pair < 2, "Sexy" >)(3)。 ...

结构中的每个节点在哪里 (prev. < K,V >, this < K,V >, next < K,V >) 但是允许重复键...

如果 Linked-List 为空，则 Head & Tail 为 null；

# java - GWT - 当基础列表更改时，CellList 不会更新

> ID：10723194
> 
> 赞同：1
> 
> 时间：2012-05-23T15:29:41.310
> 
> 标签：java, gwt, uibinder, celllist

我有 2 个要在交替时间显示的 ArrayList。我有一个按钮，单击该按钮应将第一个列表换成第二个列表。

我尝试了两种方法，但收效甚微。

第一种方法是创建一个 ListDataProvider 并将其绑定到列表和表格，但是当单击按钮并且列表结构发生变化时，什么也没发生。/

我的第二种方法是坚持使用正常的 CellList 并简单地重置行数和行数据。如果我点击我的按钮两次，这种方法就有效。

我可以忽略什么？任何帮助都感激不尽！

代码如下：

这是当我尝试将 ArrayList 重新添加到 CellList

```
public void refreshTable()
{
    systemTable.setRowCount(SYSTEMS.size(), true);
    systemTable.setRowData(0, SYSTEMS);
} 
```

我使用 ListDataProvider 进行了如下尝试：

```
 private ListDataProvider<String> listDataProvider = new ListDataProvider<String>(SYSTEMS);

public void refreshTable()
{
    listDataProvider.refresh();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T11:24:29.840

您可能遇到了这个[问题](http://code.google.com/p/google-web-toolkit/issues/detail?id=7114)。

两个版本都应该工作。对于第一个解决方案，尝试反转调用（先调用`setRowData()`，然后调用`setRowCount()`）：

```
public void refreshTable()
{
    systemTable.setRowData(0, SYSTEMS);
    systemTable.setRowCount(SYSTEMS.size(), true);
} 
```

对于第二个解决方案，我想你忘了打电话`addDataDisplay`。以下是一些更改基础数据的方法：

1.）创建一个新的 ListDataProvider 并设置`DataDisplay`（你不需要调用刷新）：

```
private ListDataProvider<String> listDataProvider = new ListDataProvider<String>(SYSTEMS);
listDataProvider.addDataDisplay(systemTable); 
```

2.) 设置现有 ListDataProvider 的新列表：

```
 listDataProvider.setList(SYSTEMS); 
```

3.) 修改现有列表：

```
 listDataProvider.getList().add/remove etc 
```

# php - 嵌入在html中的Javascript未加载

> ID：10723196
> 
> 赞同：1
> 
> 时间：2012-05-23T15:29:51.910
> 
> 标签：php, javascript, html

我正在尝试设置的这个网站似乎没有加载 js。我已经安装了 json 和 php-pear 并重新启动了 apache 等等。当我进入页面时，我看到的只是背景和横幅。

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="../resources/css/ext-all.css" />
<script type="text/javascript" src="../adapter/ext/ext-base.js"></script>
<script type="text/javascript" src="../ext-all.js"></script>
<style type="text/css">
body
{
font-family: Arial, Verdana, sans-serif;
background-image: url(graphics/background_gradient.png);
background-repeat: repeat-x;
background-color: #374d5b;
margin: 0;
padding: 0 0 20px 0;
font-size: 13px;
color: #333;
text-align: center;
}
.root
{
width: 410px;
margin: 0 auto;
text-align: left;
background-color: #e6e6e6;
position: relative;
}

#header
{
background: #0e1d2f url(graphics/banner.png) no-repeat left;
height: 90px;
}
</style> 
</head>
<body>
    <div class="root">
        <div id="header"></div>
    </div>
    <script type="text/javascript" src="login.js"></script> 
</body>
</html> 
```

我正在运行 CentOS 5

登录.js：

```
Ext.onReady(function(){
Ext.QuickTips.init(); 
var login = new Ext.FormPanel({ 
    labelWidth:80,
    url:'login.php', 
    frame:true, 
    title:'Please Login', 
    defaultType:'textfield',
monitorValid:true,
    items:[{ 
            fieldLabel:'Username', 
            name:'loginUsername', 
            allowBlank:false 
        },{ 
            fieldLabel:'Password', 
            name:'loginPassword', 
            inputType:'password', 
            allowBlank:false 
        }],

    buttons:[{ 
            text:'Login',
            formBind: true,  
            handler:function(){ 
                login.getForm().submit({ 
                    method:'POST', 
                    waitTitle:'Connecting', 
                    waitMsg:'Sending data...',
                    success:function(){ 
                        Ext.Msg.alert('Status', 'Login Successful!', function(btn, text){
                            if (btn == 'ok'){
                                var redirect = './panel.php'; 
                                window.location = redirect;
                            }
                       });
                    },
                    failure:function(form, action){ 
                        if(action.failureType == 'server'){ 
                            obj = Ext.util.JSON.decode(action.response.responseText); 
                            Ext.Msg.alert('Login Failed!', obj.errors.reason); 
                        }else{ 
                            Ext.Msg.alert('Warning!', 'Authentication server is unreachable : ' + action.response.responseText); 
                        } 
                        login.getForm().reset(); 
                    } 
                }); 
            } 
        }] 
});

var win = new Ext.Window({
    layout:'fit',
    width:300,
    height:150,
    closable: false,
    resizable: false,
    plain: true,
    border: false,
    items: [login]
});
win.show();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:31:28.033

`url()`语法特定于 CSS 。对于在 HTML 中加载 JS，它与`<img>`标签相同。

```
<script type="text/javascript" src="login.js"></script> 
```

这将假设 login.js 与您的页面位于同一目录中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-27T21:17:55.300

原来我没有上传正确的文件（ext-base.js）上传了那个和更多的依赖项，它工作得很好。感谢所有的帮助，尽管伙计们 xD

# c# - 列表框在 SelectedIndexChanged 事件上返回空字符串

> ID：10723198
> 
> 赞同：3
> 
> 时间：2012-05-23T15:29:53.853
> 
> 标签：c#, asp.net, listbox, selectedindexchanged

上述错误发生在列表框上的 SelectedIndexChanged 单击事件上。

在调试中返回的值为“”，但是当您查看网页源代码时，肯定有值。

这是我的列表框：

```
<asp:ListBox ID="lstBxMyList" runat="server" CssClass="binorderlst1"
     DataTextField="myName" 
     DataValueField="myID" 
     OnSelectedIndexChanged ="lstBxMyList_SelectedIndexChanged"
     AutoPostBack="true" Rows="10">
</asp:ListBox> 
```

这是事件：

```
protected void lstBxMyList_SelectedIndexChanged(object sender, EventArgs e)
{
    myID = Convert.ToInt32(lstBxSiteList.SelectedValue.ToString());

    ... rest of code
} 
```

为了完整起见，这里是数据绑定：

```
private void BindLstBxMyList(int myOtherID)
    {
        DataTable dt = new DataTable();
        SqlConnection conn;
        SqlCommand comm;

        using (conn = new SqlConnection(aSHconns.aconn))
        {
            comm = new SqlCommand("myStoredProc", conn);
            comm.CommandType = CommandType.StoredProcedure;
            comm.Parameters.Add(new SqlParameter("@myOtherID", SqlDbType.Int));
            comm.Parameters["@myOtherID"].Value = myOtherID;
            SqlDataAdapter sqlDa = new SqlDataAdapter(comm);

            try
            {
                conn.Open();
                 sqlDa.Fill(dt);
                 if (dt.Rows.Count > 0)
                 {
                     lstBxMyList.DataSource = dt;
                     lstBxMyList.DataTextField = "myName";
                     lstBxMyList.DataValueField = "myID";
                     lstBxMyList.DataBind();
                 }

            }

            finally 
            {
                conn.Close();
            }
        }

    } 
```

如果我恢复到 SqlDataSource，则列表框会返回值。Bt 我需要重新填充列表，所以我需要数据绑定背后的代码（除非当然有更好的方法）

那么为什么列表框选择的值返回一个空字符串呢？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T15:35:00.980

您有属性 AutoPostBack = "True" 这将对每个选定的索引进行回发更改。因此，在它进入 Selected index changed 事件之前，它必须在绑定列表框的地方点击页面加载。因此，当它点击页面加载时，选定的索引将更改为默认项。所以，试试下面的代码。

```
 protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
             //Bind your listbox here
            }
         } 
```

# jmenu - 禁用 JMenu 流动

> ID：10723204
> 
> 赞同：0
> 
> 时间：2012-05-23T15:30:16.787
> 
> 标签：jmenu, jmenubar

在摇摆中制作一些小应用程序时，我遇到了一个小问题。我有一个 JMenuBar，其中有几个 JMenu，其中一些添加了 MenuListener，它们的作用类似于普通按钮（menuSelected 打开一个对话框）。问题是，当我单击“普通”菜单并且 JMenuItems 列表展开然后将光标移到“按钮”菜单上时，MenuListener 认为它已被单击并启动适当的方法。如何禁用它？这是清除自定义名称的代码的一部分：

```
 JMenuBar bar = new JMenuBar();

 addPlayerButton = new JMenu("Button");

 addPlayerButton.addMenuListener(new MenuListener() {

     @Override
     public void menuSelected(MenuEvent e) {
         addPlayerButton.setSelected(false);
         //here comes my method to show custom dialog
     }

     @Override
     public void menuDeselected(MenuEvent e) {
     }

     @Override
     public void menuCanceled(MenuEvent e) {
     }
 });

 bar.add(addPlayerButton);

 JMenu menu = new JMenu("Menu");
 bar.add(menu); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:53:55.260

我认为您可以使用 actionListener 而没有 MenuListener，因为当鼠标悬停在 menuItem 上时 menuSelected 调用。我不确定，但请尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T20:48:28.763

也许我以过于复杂的方式呈现它。

想象一下，您有一个带有 MenuBar 和两个菜单的框架。您单击其中一个，它会显示它的内容。现在将光标移到第二个菜单上，第一个关闭，第二个打开。我只是想在这种情况下不要打开第二个。

# ios - 点击时更改 UITableViewCell 的文本

> ID：10723207
> 
> 赞同：1
> 
> 时间：2012-05-23T15:30:27.623
> 
> 标签：ios, uitableview

我正在尝试更新 UITableViewCell 当它被点击以获得一些反馈时，如下所示：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    if ([[self.menuItems objectAtIndex:aPath.row] isEqualToString:@"AirPrint Order"]) {

        UITableViewCell *cell = (UITableViewCell *)[tableView cellForRowAtIndexPath:indexPath];
        cell.textLabel.text=@"Generating Order Receipt";
        NSArray *nsa = [[NSArray alloc] initWithObjects:indexPath, nil];
        [tableView reloadRowsAtIndexPaths:nsa withRowAnimation:UITableViewRowAnimationNone];
    }
} 
```

这段代码似乎什么也没做，即使在调试器中它确实在我的 if 语句中，但单元格文本没有发生任何事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T15:32:56.280

当您调用`reloadRowsAtIndexPaths`它时，它实际上会`cellForRowAtIndexPath:`再次调用并重新加载单元格，删除您在`didSelectRowAtIndexPath`. 我建议您做的是：在`didSelectRowAtIndexPath`方法中更新您的数据并将其读入`cellForRowAtIndexPath`.

# c# - 使用 c# xaml 在 Metrostyle 应用程序中更改背景

> ID：10723208
> 
> 赞同：1
> 
> 时间：2012-05-23T15:30:27.957
> 
> 标签：c#, xaml, windows-runtime, windows-store-apps, winrt-xaml

我使用 c# 创建了一个 Metrostyle 应用程序，当我开始时我选择了网格选项，但我需要将应用程序的背景更改为图像或其他颜色。

我跟着微软教程[链接](http://msdn.microsoft.com/en-us/library/windows/apps/br211380.aspx)

我输入了 common/standarStyle 下一个代码但不起作用，我知道这很简单但对我不起作用。

```
<Grid Background="{StaticResource WindowsBlogBackgroundBrush}">
// Add this brush to the resource dictionary in App.xaml.
<SolidColorBrush x:Key="WindowsBlogBackgroundBrush" Color="#FF0A2562"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:50:09.660

你可以试试这个：

```
<Grid>
    <Grid.Background>
        <SolidColorBrush
            Color="#FF0A2562" />
    </Grid.Background>

    ...
</Grid> 
```

如果它没有帮助，那么您的网格可能不可见-它的内容可能具有不同的颜色并完全填充网格-然后您将看不到它的颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-09T09:02:20.790

将网格的背景属性设置为

```
 grid.Background = new SolidColorBrush(Windows.UI.Color.FromArgb(1,10,37,98)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:59:28.957

最简单的方法是：使用程序搅拌器，（在微软网站的开发人员包中）打开一个新项目（并打开我们在vs中制作的新项目）左键，它打开工具设计器，你可以选择纯色画笔或渐变画笔选项。

# visual-studio-2010 - Visual Studio 2010 上的空白属性

> ID：10723209
> 
> 赞同：3
> 
> 时间：2012-05-23T15:30:37.627
> 
> 标签：visual-studio-2010

显然，在为 WP7.1 安装了 WP7 开发工具后，VS 2010 以一种非常奇怪的方式崩溃了，当我选择一个引用时，属性选项卡是空白的，在所有其他情况下它显然都在工作。我不确定这是 WP7.1 工具设置，但这些天我的安装发生了一件事情。有人有同样的问题吗？修复？

**不幸的是卸载/更新不起作用！**

# jquery - jQuery如何反转remove()事件

> ID：10723219
> 
> 赞同：4
> 
> 时间：2012-05-23T15:31:03.633
> 
> 标签：jquery, reverse

我有这个代码：

```
$(window).resize(function() {
        if($(window).height() < 768) {
            $('div#navigation ul li br').remove()
        } else {
}
    }) 
```

是否可以在 else 上反转删除事件？我需要将这些
标签放在与操作之前相同的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:34:06.420

```
$(window).resize(function() {
  $('div#navigation ul li br').toggle( $(this).height() >= 768 );
}); 
```

`.toggle()`接受一个布尔参数，该参数定义选择的元素是隐藏（jQuery 使用 CSS `display: none;`）还是显示。

在这种情况下，窗口高度用于计算布尔值。

* * *

过早的优化：如果由于某种原因上面的操作很慢，您*可以*通过预先选择中断并记住状态来首先决定是否有任何事情要做来优化它：

```
$(window).resize( (function () {
  var $window = $(window),
      $navigationBreaks = $('div#navigation ul li br'),
      prevState = isLargeWindow();

  function isLargeWindow() {
    return $window.height() >= 768;
  }

  return function () {
    var newState = isLargeWindow();

    if (newState == prevState) return;

    $navigationBreaks.toggle(newState);
    prevState = newState;
  };
})() ); 
```

这是更多的代码，更复杂，并且可能比单行方法快几毫秒。带上一粒盐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:32:44.143

最好的方法是使用`toggle`(or `hide`and `show`) 而**不是** `remove`：

```
$(window).resize(function() {
    if($(window).height() < 768) {
        $('div#navigation ul li br').toggle();
    } else {
        $('div#navigation ul li br').toggle();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:36:20.677

没有单一的方法可以在 jQuery（或一般的 JavaScript）中“重新附加”一个 DOM 元素。相反，您需要做的是创建一个新元素以稍后使用通常的附加方法附加，或者存储`.remove`d / `.detach`ed 元素，然后稍后附加该元素：

```
$br = $('div#navigation ul li br').remove();
//...
$('div#navigation ul li').append($br); 
```

但是，您只能`.append`、`.prepend`、`.wrap`等。如果它在其他子元素之间，则不能将其插入到之前的位置，除非您有某种占位符，或者您知道要在之前/之后插入的子元素。

如果您删除元素的唯一原因是隐藏它，那么您可以使用各种显示/隐藏方法使其在视觉上消失，而无需将其从 DOM 中删除。

# java - Servlet 请求和 window.location.href

> ID：10723223
> 
> 赞同：0
> 
> 时间：2012-05-23T15:31:15.917
> 
> 标签：java, servlets, http-request

我有一个 java servlet，它设置为特定页面提供的请求属性。在该页面上，有一些 javascript 可以重定向到带有 window.location.href= 的新页面 ...

request 属性在重定向页面中是否可用？我意识到这个问题有点令人困惑，对此我深表歉意，我不确定如何更好地解释它，但我提前感谢您的耐心等待！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:39:20.853

将为重定向创建一个新请求，您将丢失请求范围的属性。如果要保留数据，请考虑将其存储在会话中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:40:12.550

请求属性仅在设置它们的请求的期间/范围内有效。您应该使用会话范围的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:01:06.970

每次重定向到一个新页面时，它都是一个全新的请求，并创建了一个新的请求对象。因此，您之前的请求对象中的任何内容都将被丢弃。尝试将数据保存在会话或应用程序范围内。这应该解决它。

# c# - Castle.Windsor 每个类有多个拦截器

> ID：10723226
> 
> 赞同：0
> 
> 时间：2012-05-23T15:31:17.800
> 
> 标签：c#, .net-3.5, castle-windsor

[文档](http://docs.castleproject.org/%28X%281%29S%28faqxvazfuvdoeq55231oyo45%29%29/Windsor.Interceptors.ashx)说我可以`Interceptor`为每个类应用多个属性。不过，我收到语法错误*重复属性*。[这篇](https://stackoverflow.com/questions/10155555/aop-caching-with-castle-windsor)文章还建议我可以将拦截器应用于方法，但我不能！我的测试只有在我将它们应用到类时才能通过，如果我希望拦截器只对某些方法执行，那就更烦人了。

```
[Interceptor (typeof (CastleWindsorAspect))]
[Interceptor (typeof (AnotherCastleWindsorAspect))]
public class CastleWindsorDomainType { } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:32:43.147

您确实可以将多个拦截器应用于一个组件。您可以使用流畅的注册 API 和 XML 配置来完成。

您还应该能够通过自定义属性来做到这一点，就像您演示的那样，但似乎 Windsor 中有一个错误，不允许您多次指定它（因此您看到的错误）。我建议将此报告为错误并同时使用注册 API 附加多个拦截器。

至于将拦截器应用于方法，您可以这样做，但不能以声明方式。相反，您需要指定`IProxyGenerationHook`或`IInterceptorsSelector`控制应代理哪些方法和/或应将哪些拦截器应用于哪些代理方法。

# python - python中的SFTP方法获取文件的基本名称和完整路径

> ID：10723229
> 
> 赞同：1
> 
> 时间：2012-05-23T15:31:26.077
> 
> 标签：python, sftp, paramiko

我想用 Python 从 SFTP 站点下载文件，但我想先对文件应用过滤器，例如。只下载符合特定模式的文件。我只想将过滤器应用于文件名，而不是完整路径。但是当我想下载文件时，我需要完整路径。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T19:11:19.383

我想我明白你在这里问什么。我附加了一个获取远程文件列表的代码块，然后是本地文件，然后我使用它来提供要传输的文件列表（这意味着文件在远程目录中而不是在本地目录中这与放置文件的功能相反）。然后它循环并仅传输满足文件过滤器的文件。

```
def getFiles ( remotePath, filterValue, hostname, user, pwd, pathShare, remove ):
    srv = sftpfunc (hostname,user,pwd)
    retFiles = []
    srv.chdir(remotePath)
    remoteFiles = srv.listdir()
    localFiles = os.listdir(pathShare)
    files = srv.listdir()
    removeMe = ""
    if (len(remoteFiles) > 0):
            tranFiles = list(set(remoteFiles) - set(localFiles))
            print ('File Transfer List: ')
            for fileName in tranFiles:
                    if not filterValue in fileName: continue
                    print ('Transfering:  ',fileName)
                    srv.get(fileName, pathShare+fileName)
                    if (remove):
                            try:
                                    srv.rmfiles(fileName)
                            finally:
                                    print('Could not remove files')

                    retFiles.append(fileName)
    srv.close()
    return retFiles 
```

# objective-c - 当我的应用程序进入后台时，如何暂停游戏？

> ID：10723233
> 
> 赞同：0
> 
> 时间：2012-05-23T15:31:32.013
> 
> 标签：objective-c, ios

我有一个俄罗斯方块游戏，当游戏正在玩并且应用程序进入后台后，它会继续工作，这样玩家会在一段时间后输掉游戏。当应用程序逐步减少时，我想让我的游戏暂停。

如何响应应用程序状态（后台或前台）的变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:15:09.183

让您的应用委托实现`-applicationWillResignActive:`并暂停游戏。

# ios - 在 iOS 上组合相交的 CGPath

> ID：10723237
> 
> 赞同：5
> 
> 时间：2012-05-23T15:31:53.010
> 
> 标签：ios, drawing, quartz-2d, cgpath

我正在开发的应用程序有问题。假设我有两个相当复杂的 CGPath，我将它们都添加到 CGMutablePath 中（从而将它们组合起来）。好吧，两条路径相交的地方将有彼此内部的点。我想消除那些内部点并基本上绘制路径的外部或轮廓。我很难弄清楚我将如何去做。

**编辑：**这是我正在谈论的一个例子。蓝色和红色框表示沿 CGPath 的点。红色框是两条路径内的点。我想以某种方式消除红点并仅重绘路径的轮廓。

![在此处输入图像描述](../Images/8232d0387a34e2c7e8380c6ba8847682.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-25T03:23:29.667

您所描述的是路径内部的结合。

如果您的路径包含曲线，这是一个难题。

但是，您的示例仅显示直线段，因此我假设您只关心仅包含直线段的路径。

在这种情况下，您需要一个多边形联合函数。这种算法在称为“计算几何”的领域中非常基础。我不知道多边形联合的任何特定于 Objective-C 的实现。您可能能够找到一个纯 C 库，但找到 C++ 库要容易得多。如果将文件扩展名从 更改为 ，则可以使用 C `.m`++ `.mm`。以下是一些可以计算多边形并集的 C++ 库：

*   [快船](http://www.angusj.com/delphi/clipper.php)
*   [GEOS](http://trac.osgeo.org/geos/) - 见[`Polygon::Union`](http://geos.osgeo.org/doxygen/classgeos_1_1geom_1_1Geometry.html#a1102ded58685400a4f144fe0dd8f430d)
*   [CGAL](http://www.cgal.org/) - 见[2D 正则化布尔集操作](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Boolean_set_operations_2/Chapter_main.html)
*   [增强](http://www.boost.org/)几何 - 见[`union_`](http://www.boost.org/doc/libs/1_54_0/libs/geometry/doc/html/geometry/reference/algorithms/union_.html)

`CGPathApply`请注意，在所有情况下，如果您还没有其他格式的顶点，您都需要使用它来提取路径的顶点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T23:53:22.647

多边形问题中的经典点。删除每个多边形中引用另一个多边形返回 1 的所有点：

```
int pnpoly(int npol, float *xp, float *yp, float x, float y)
{
  int i, j, c = 0;
  for (i = 0, j = npol-1; i < npol; j = i++) {
    if ((((yp[i] <= y) && (y < yp[j])) ||
         ((yp[j] <= y) && (y < yp[i]))) &&
        (x < (xp[j] - xp[i]) * (y - yp[i]) / (yp[j] - yp[i]) + xp[i]))
      c = !c;
  }
  return c;
} 
```

将两条路径与删除的点结合起来。

整个过程的伪代码：

```
define starPoly with 10 points
define simplePoly with 7 points

for each point in starPoly
    if ( pnpoly( 7, simplePoly.Xs[], simplePoly.Ys[], point.x, point.y ) == 0 )
        clipedStarPoly += point;

for each point in simplePoly
    if ( pnpoly( 10, starPoly.Xs[], starPoly.Ys[], point.x, point.y ) == 0 )
        clipedSimplePoly += point;

for each point in clipedStarPoly
    solutionPoly += point;

for each point in clipedSimplePoly
    solutionPoly += point;

solutionPoly += solutionPoly.point[0] 
```

如果您认为不必使用剪裁多边形的端点，您可以直接从点测试中构建解决方案多边形。

您可能希望在 poly 测试中对点使用光线追踪，请尝试查看此[页面](http://local.wasp.uwa.edu.au/~pbourke/geometry/insidepoly/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-25T03:00:02.737

使用[CGPathAddPath](http://developer.apple.com/library/ios/#documentation/graphicsimaging/Reference/CGPath/Reference/reference.html#//apple_ref/c/func/CGPathAddPath "CGPathAddPath")。超级容易使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-08T09:24:32.410

简单地合并两组点是不够的。为了确定组合多边形，您需要执行以下操作。对不起，我只有伪代码，我才刚刚开始研究这个问题。

我们将考虑这两个多边形是 A 和 B。哪个是哪个都没有关系。

*   在多边形 A 周围移动，寻找不在多边形 B 内的任何点。
*   将此点添加到多边形。
*   继续围绕多边形，依次测试和添加每个点。
*   当您发现一个位于多边形 B 内的点时，请查看它与前一个点之间的线。
*   找出多边形 B 上的哪条线与这条线相交。
*   确定这两条线之间的交点并将其添加到多边形中。
*   确定定义属于多边形 B 的相交线的两个点中的哪一个不在多边形 A 内，并将其添加到新多边形中。
*   确定您需要围绕多边形 B 的哪个方向，以便下一个点不会是相交线另一端的那个点并添加它。
*   从 3 开始重复，除了使用多边形 B 而不是多边形 A
*   继续直到到达起点，必要时在多边形之间交换。

请注意，此解决方案仅适用于直边多边形。就贝塞尔路径而言，计算交点变得更加困难，更不用说将平滑角与尖角或曲线与直线段相结合的复杂性。

# c# - WCF REST 错误处理 - 输入不正确

> ID：10723248
> 
> 赞同：4
> 
> 时间：2012-05-23T15:32:36.153
> 
> 标签：c#, wcf, rest

**概括：**

在 WCF REST 服务中，如何使用我自己的自定义故障响应来处理不正确的输入参数？

**细节：**

我在 WCF REST 服务中有以下接口方法：

```
[OperationContract]
[WebGet(UriTemplate = "getitem?id={itemId}", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare)]
[FaultContract(typeof(DataModel.Fault))]
DataModel.Item GetItem(int itemId); 
```

在 GetItem 方法的实现中，我捕获了任何错误条件（即项目不存在）并创建了 WebFaultException。这工作没有任何问题。

但是，假设调用客户端调用以下 url：

[http://myserver.com/itemservice/getitem?id=abc](http://myserver.com/itemservice/getitem?id=abc)

即 id 的输入值不能按照 GetItem 方法的要求强制转换为 int

此调用正确地失败了，因为给定的 id 值不能转换为 int，但是此失败发生在我的任何代码执行之前，因此我无法`DataModel.Fault`根据分配给接口方法的 FaultContract 返回我的对象​​。

所以问题是，我如何挂钩一个高级错误处理程序来捕获这种类型的错误并随后返回我自己的错误结构而不是 WCF 生成的 HTML 错误：

> 请求错误 服务器在处理请求时遇到错误。有关更多详细信息，请参阅服务器日志。

作为同一问题的延续，如果客户调用以下命令，我也希望能够做同样的事情：

[http://myserver.com/itemservice/gettiitem?id=abc](http://myserver.com/itemservice/gettitem?id=abc)

注意 URI 中的拼写错误，gettitem（两个 t）而不是 getitem

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:28:53.880

使用`IErrorHandler`接口来扩展您的服务。

这将允许您为任何异常提供适当的故障。 [这篇文章](http://blogs.msdn.com/b/carlosfigueira/archive/2011/06/07/wcf-extensibility-ierrorhandler.aspx)展示了如何将您自己的错误处理程序连接到您的服务行为。

我个人使用单个类来实现所有必要的元素，如下所示：

```
public class ErrorSavingServiceBahavior : BehaviorExtensionElement, IServiceBehavior, IErrorHandler
{
    private string m_sHostName;

    public void AddBindingParameters(ServiceDescription serviceDescription, System.ServiceModel.ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, System.ServiceModel.Channels.BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, System.ServiceModel.ServiceHostBase serviceHostBase)
    {
        this.m_sHostName = serviceHostBase.Description.Name;
        foreach (ChannelDispatcher chanDisp in serviceHostBase.ChannelDispatchers)
        {
            if (!chanDisp.ErrorHandlers.Contains(this))
            {
                chanDisp.ErrorHandlers.Add(this);
            }
        }
    }

    public void Validate(ServiceDescription serviceDescription, System.ServiceModel.ServiceHostBase serviceHostBase)
    {
    }

    public bool HandleError(Exception error)
    {
        //my custom code
    }

    public void ProvideFault(Exception error, System.ServiceModel.Channels.MessageVersion version, ref System.ServiceModel.Channels.Message fault)
    {
        //my custom code
    }

    public override Type BehaviorType
    {
        get { return this.GetType(); }
    }

    protected override object CreateBehavior()
    {
        return this;
    }
} 
```

和 web.config 我扩展：

```
<behaviors>
  <serviceBehaviors>
    <behavior name="BehaviorName">
      <serviceMetadata httpGetEnabled="true"/>
      <serviceDebug includeExceptionDetailInFaults="true" httpHelpPageEnabled="true"/>
      <saveExceptions />
    </behavior>
  </serviceBehaviors>
</behaviors>
<extensions>
  <behaviorExtensions>
    <add
      name="saveExceptions"
      type="Namespace.Class, DLLName, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"
    />
  </behaviorExtensions>
</extensions> 
```

# c# - 如何从类型 bool 数组中添加设置？

> ID：10723256
> 
> 赞同：1
> 
> 时间：2012-05-23T15:32:58.417
> 
> 标签：c#, wpf, arrays, boolean

如何在 c# settings.settings 中添加布尔数组类型的设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:42:21.050

```
<Setting Name="SettingName" Type="System.Boolean[]" Scope="User">
  ...

</Setting> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:44:04.347

您不能设置任何类型的数组类型。如果要使用数组值，则必须将其存储为 XML 文件或字符串，然后在运行时必须解析 XML 文件或字符串以获得确切的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:48:49.937

您可以创建类：

```
public class BoolList : List<bool>
{
} 
```

然后使用这种类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:53:44.603

这是另一种选择，转到您的设置并创建类型的新设置`StringCollection`，然后单击省略号按钮 (...) 并在新行中输入每个值，例如 true 或 false。然后在您的代码中，您可以像这样阅读它：

```
List<string> list = Settings1.Default.StringArray.Cast<string>().ToList();
bool[] b_array = list.Select(x => x == "true").ToArray(); 
```

在我的示例中，我将 StringCollection 属性称为“StringArray”

您的 StringCollection 设置将存储为 XML：

```
<?xml version="1.0" encoding="utf-16"?>
<ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <string>true</string>
  <string>false</string>
  <string>true</string>
  <string>false</string>
  <string>false</string>
</ArrayOfString> 
```

希望这可以帮助

# c# - asp.net 文本框多行，后面的代码中有不同的换行符

> ID：10723260
> 
> 赞同：1
> 
> 时间：2012-05-23T15:33:17.930
> 
> 标签：c#, asp.net, textbox, newline, multiline

我在 asp.net 上有一个应用程序，我有 2 个带有 texmode="multiline" 的文本框控件的页面如下：

**在第一页：**

```
<asp:TextBox ID="txtQuestion" runat="server" Rows="2" Columns="20" TextMode="MultiLine"></asp:TextBox> 
```

和

**在第 2 页：**

```
<asp:TextBox ID="txtMessage" runat="server" TextMode="MultiLine"></asp:TextBox> 
```

当我从这些输入文本中编写用户输入文本时，如果用户按下“Enter”键，则每个换行页面的结果都不同。例如，用户输入“John”，然后点击“Enter”键和“Doe”我在这 2 个页面的 .cs 文件中有不同的换行符：

**在 .cs 文件的第一页 txtQuestion.text 等于：**

```
John\nDoe 
```

**在 .cs 文件的第二页 txtMessage.text 等于：**

```
John\r\nDoe 
```

我不知道是什么原因导致了这种情况，我找不到任何解决方案来从这些输入中获得相同的结果

任何人都可以帮忙吗？

谢谢

# c# - Powershell/C#：异步调用管道并显示结果

> ID：10723264
> 
> 赞同：0
> 
> 时间：2012-05-23T15:33:30.430
> 
> 标签：c#, powershell, powershell-2.0

根据此示例 - [http://msdn.microsoft.com/en-us/library/windows/desktop/ee706590(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee706590(v=vs.85).aspx)，

我正在尝试以异步方式调用我的脚本。但是，与此同时，我想就发生的一组操作向 GUI 提供反馈，即想在 GUI 上并行地吐出幕后发生的写详细内容。

我对实现这一点感到困惑 - 因为我看到 PipelineReader 对象上有一个[DataReady](http://msdn.microsoft.com/en-us/library/windows/desktop/ms567691%28v=vs.85%29.aspx)事件？是否有可能以某种方式使用**上面的 MSDN 示例，**以便我可以在 GUI 上显示反馈？

> 从概念上讲，我无法***[将此示例](http://msdn.microsoft.com/en-us/library/windows/desktop/ee706590%28v=vs.85%29.aspx)***与[***DataReady***](http://msdn.microsoft.com/en-us/library/windows/desktop/ms567691%28v=vs.85%29.aspx)事件相关联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:57:29.227

> *知道了 ！这是完整的代码...*

**首先在表单上添加富文本框 = txtOutput** 并**添加对**

> C:\Program Files (x86)\Reference Assemblies\Microsoft\WindowsPowerShell\v1.0\System.Management.Automation.dll

```
 IAsyncResult _invokeResult; 

    PowerShell _ps = PowerShell.Create();

    delegate void SetOutput(string value);

    // Monitor the DataAdded
    _ps.Streams.Verbose.DataAdded += new EventHandler<DataAddedEventArgs>(Verbose_DataAdded);

    var sr = new StreamReader(@"C:\MyScript.ps1");
    _ps.AddScript(sr.ReadToEnd());
    _invokeResult = _ps.BeginInvoke<PSObject>(null, null, AsyncInvoke, null);

   void Verbose_DataAdded(object sender, DataAddedEventArgs e)
   {
       System.Diagnostics.Debug.Print( ((PSDataCollection<VerboseRecord>) sender)[e.Index].ToString()) ;

       if (txtOutput.InvokeRequired)
       {
           string msg = ((PSDataCollection<VerboseRecord>) sender)[e.Index].ToString();
           txtOutput.Invoke(new SetOutput(Execute), new object[] { msg} );
       }
   }

   void AsyncInvoke(IAsyncResult ar)
   {
       // end
       try
       {
           _ps.EndInvoke(ar);
       }
       catch (Exception ex)
       {
             // do something with the error...
       }
  }

private void Execute(string msg)
        {
            txtOutput.SelectionFont = new Font(txtOutput.SelectionFont.FontFamily, 9.0f);
            txtOutput.AppendText(msg);
            txtOutput.ScrollToCaret();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T18:37:56.603

如果您只想将 Write-Verbose 输出输出到 GUI，那么在 InvokeAsync 之后监视[Streams.Verbose](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144532%28v=vs.85%29.aspx)集合会更容易。如果要扫描所有输出，请使用 PipelineReader。订阅其 DataReady 事件并在该事件处理程序中执行 NonBlockingRead 以获取数据。

# javascript - HTML，Javascript - 比 iFrame 更宽的拆分词，而不是生成滚动条

> ID：10723265
> 
> 赞同：1
> 
> 时间：2012-05-23T15:33:44.127
> 
> 标签：javascript, html, iframe, designmode, execcommand

我正在使用 ExecCommand 制作一个非常基本的 WYSIWYG 编辑器，因为未来的项目将需要我制作一个（因此请不要告诉我使用 CKEditor 或 tinyMCE 之类的东西）。正常使用时一切正常。但是，如果您输入的词比 iFrame 宽，则该词不会拆分。相反，滚动条只是添加到 iFrame 中。这是一个显示我的问题的视频：[https](https://vimeo.com/42699618) ://vimeo.com/42699618 所以我想知道防止这种情况的最简单方法是什么？

这是代码：

```
 <script language="JavaScript">
$(document).ready(function(e) { 
    textArea.document.designMode = 'On'; 

    $("#bold").click(makeBold);
    $("#italic").click(makeItalic);

    function makeBold() {
        textArea.document.execCommand('bold', true, null);
        $("#textArea").focus();
    }
    function makeItalic() {
        textArea.document.execCommand('italic', false, null);
        $("#textArea").focus();
    }
});
</script>
<body>

    <iframe id="textArea" style="width: 700px; height:400px;"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:31:45.637

从本质上讲，您现有的系统会处理第一部分，将单词放在新行上。你选择了更简单的版本:)

渲染单词时，需要根据单词的长度和字段的宽度将字符串拆分为多个字符串。

确保您只拆分视图中的单词，而不是数据中的单词！如果用户调整视图大小，您不会想尝试将数据重新组合在一起：p

步骤：每次渲染时，检查每个单词是否超过视图的宽度，如果超过，将其拆分，按顺序渲染碎片，然后继续。

# iphone - 开发像 webapp.to 这样的移动应用程序

> ID：10723267
> 
> 赞同：1
> 
> 时间：2012-05-23T15:33:45.537
> 
> 标签：iphone, ios, mobile

*好吧，我知道标题看起来像是将要讨论的一般问题。*

## **但请先阅读。**

有一个销售移动网站的网站，但如果我们从我们的 iphone`webapp.to`打开/下载他们的作品/作品集之一。`webapp.to/schoolofsurf`然后该网站将在 safari 上打开。然后我们打开的网站也会提示我们`Add to Home Screen`，然后图标出现在主屏幕上，就像一个正常的应用程序一样，当我们打开它时，它是正常打开的 safari 并转到该网站。

但是，真正发生的是该应用程序看起来像是在没有 safari 的情况下独立打开的。
**他们是怎么做到的？**

请查看下面的屏幕截图以获取更多图形说明：
![在此处输入图像描述](../Images/3fb6be04b248d8e1fd3b37b2bf19036f.png)
![在此处输入图像描述](../Images/42206034b255edde0635288c17f3c300.png)
![在此处输入图像描述](../Images/aae5ebd1d3e9fc3feed84f5942e117a2.png)
![在此处输入图像描述](../Images/8cd93eca304a8f647eed82ea852dbe0c.png)
![在此处输入图像描述](../Images/35f70349f9a4e9763e8e9f5275f2e539.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:48:51.440

当您的站点被添加到主屏幕时，有几个 iphone/safari 特定的 HTML 元标记允许您设置图标、启动屏幕和位置栏的可见性。您可以在本[文档](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html)中阅读更多相关信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:52:02.033

您需要添加一个元标记，告诉 Safari 您的网络应用程序是“应用程序能力”。看看这里[https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)。

您可以使用一组“链接”标签指定主屏幕图标。请参阅此处[https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html)。

# c# - 在 XmlText 节点中转换字符时出现问题（从 ' 到 '）

> ID：10723269
> 
> 赞同：1
> 
> 时间：2012-05-23T15:33:51.597
> 
> 标签：c#, xml, vb.net

我在将一些字符串附加到某些 XML 节点时遇到问题。为了更好地解释这一点，我做了一个简单的例子......想象一下我有这个 XML 代码：

```
<song>
    <title>
        Surfin&#39; USA
    </title>
</song> 
```

请注意，我明确使用`&#39;`的不是单引号字符，而是简单地写“Surfin' USA”。XML 代码是有效的——或者至少我在网上找到并测试过的一些工具认为它是有效的。

我的问题是，当我尝试将该字符串放入 XmlText 对象时，这样：

```
Dim xmlDoc As New XmlDocument()
Dim xmlMyText As XmlText

xmlMyText = xmlDoc.CreateTextNode("Surfin&#39; USA") 
```

我希望在 XmlText 对象中具有完全相同的字符串值，但它得到的值略有不同：

```
MsgBox(xmlMyText.OuterXml)  ' OUTPUTS: Surfin&amp;39; USA 
```

简而言之，＆符号被转换为`&amp;`因为AFAIK“＆符号不能不转义”。但在我看来，在这种情况下它不是未转义的，因为它与 #39 和分号一起使用，我错了吗？

您能帮我解释一下如何避免这种转换吗？
非常感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:26:08.583

在您发送的转义通行证数量与您尝试在输出数据上使用的转义通行证数量之间存在不匹配是一个常见问题。

在这里，OuterXml 完全按照它的设计目的去做：为您提供它以转义（存储的 XML）形式提供的数据。这是一件好事，因为如果您保存此 XML，然后将其加载回 XML 文档，您可以导航到节点并在节点上请求 .InnerText() 并获取原始值，这正是您所期望的. 否则它会破坏合同。

但是，通过请求 OuterXml（返回标记）而不是获取 InnerText 值（返回存储的数据），您在转义序列上“减一”。您可以手动对数据运行取消转义或使用 .InnerText() 自动转换回您的源数据。

```
using System;
using System.Text;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Xml;       

namespace TestProject1
{
    [TestClass]
    public class UnitTest1
    {
        private const string testString = "Surfin&#39; USA";
        [TestMethod]
        public void TestMethod1()
        {
            XmlDocument xmlDoc = new XmlDocument();
            XmlText xmlMyText;

            xmlMyText = xmlDoc.CreateTextNode(testString);

            Assert.AreEqual(testString, xmlMyText.InnerText);

        }
    }
} 
```

此单元测试通过。请原谅我使用 C#，但那是我的手指输入的。

# task - 如何设置定时任务？

> ID：10723271
> 
> 赞同：1
> 
> 时间：2012-05-23T15:33:54.463
> 
> 标签：task, wso2

在此之前，我问了一个问题。我的服务配置是：

```
<proxy xmlns="http://ws.apache.org/ns/synapse"
       name="UnpayBilling_Task"
       transports="https,http"
       statistics="disable"
       trace="disable"
       startOnLoad="true">
   <target>
      <inSequence>
         <class name="com.coship.mediator.UnpayBillingMediator"></class>
         <log level="full" />
      </inSequence>
      <outSequence>
         <log level="full" />
         <send />
      </outSequence>
      <endpoint>
         <address uri="http://172.21.13.153:18080/aaa/services/receiveMsg" />
      </endpoint>
   </target>
</proxy> 
```

我写了一个扩展调解`UnpayBillingMediator`器交易文件。该类返回文件名并向服务发送请求`http://172.21.13.153:18080/aaa/services/receiveMsg`。该服务没有输入消息。我希望每天 13:30 运行服务。我尝试添加新的计划任务。 `soapAction:urn:mediate,to:http://localhost:8280/services/UnpayBilling?wsdl, Cron: 30 13 * * *.`但它不能工作吗？谁能告诉我如何设置这个计划任务？

```
SimpleQuartz Server name not in pinned servers list. Not starting Task 
```

我也不知道如何设置“固定服务器”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T09:31:46.040

让我解释一下默认消息注入器任务在 WSO2 ESB 中是如何工作的。

它基本上创建具有给定属性的消息（例如：消息有效负载，地址等），并以配置的间隔将其注入主序列。

因此，在您的情况下，您将不得不更改主序列，以便过滤带有给定`To`地址或您的特定消息正文的消息并将其转发。

最简单的做法是更改 WSO2ESB 主序列中的默认过滤器，以便它过滤您的地址并将其发送到后端服务。

例如：将过滤器更改为：

```
<filter xmlns:ns="http://org.apache.synapse/xsd
        xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope"
        xmlns:ns3="http://org.apache.synapse/xsd"
        source="get-property('To')"
        regex="http://localhost:8280/services/UnpayBilling.*" >
        ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T14:52:54.263

请看下面的 ESB 配置

其中有一个名为 Test 的代理和一个名为 MyTask 的任务，当 MyTask 将消息注入主序列时，我们过滤“To”属性，如果它是我们从 Task 设置的值，那么我们将其发送到代理服务。

配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://ws.apache.org/ns/synapse">
    <registry provider="org.wso2.carbon.mediation.registry.WSO2Registry">
        <parameter name="cachableDuration">15000</parameter>
    </registry>
    <proxy name="Test" transports="https http" startOnLoad="true" trace="disable">
        <target>
            <inSequence>
                <log level="full">
                    <property name="IN" value="IN"/>
                </log>
                <drop/>
            </inSequence>
        </target>
    </proxy>
    <sequence name="fault">
        <log level="full">
            <property name="MESSAGE" value="Executing default 'fault' sequence"/>
            <property xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://org.apache.synapse/xsd" xmlns:ns3="http://org.apache.synapse/xsd" name="ERROR_CODE" expression="get-property('ERROR_CODE')"/>
            <property xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://org.apache.synapse/xsd" xmlns:ns3="http://org.apache.synapse/xsd" name="ERROR_MESSAGE" expression="get-property('ERROR_MESSAGE')"/>
        </log>
        <drop/>
    </sequence>
    <sequence name="main">
        <in>
            <filter xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:ns="http://org.apache.synapse/xsd" xmlns:ns3="http://org.apache.synapse/xsd" source="get-property('To')" regex="http://localhost:8280/services/Test">
                <then>
                    <send>
                        <endpoint>
                            <address uri="http://localhost:8280/services/Test"/>
                        </endpoint>
                    </send>
                </then>
                <else/>
            </filter>
        </in>
        <out>
            <drop/>
        </out>
        <description>The main sequence for the message mediation</description>
    </sequence>
    <task name="MyTask" class="org.apache.synapse.startup.tasks.MessageInjector" group="synapse.simple.quartz">
        <trigger count="1" interval="4"/>
        <property xmlns:task="http://www.wso2.org/products/wso2commons/tasks" name="to" value="http://localhost:8280/services/Test"/>
        <property xmlns:task="http://www.wso2.org/products/wso2commons/tasks" name="message">
            <msg xmlns="">FROM_TASK</msg>
        </property>
    </task>
</definitions> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T04:17:50.767

您的 cron 表达式存在问题。请参考[http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger](http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger)

# javascript - 使用基于年龄的循环计算

> ID：10723273
> 
> 赞同：1
> 
> 时间：2012-05-23T15:34:06.040
> 
> 标签：javascript, loops

我正在编写代码来计算直到 65 岁生日的保险费。

到目前为止，我已经想出了这个，但我陷入了困境：

```
function showQuote(bday,bmonth,byear)
{

    var DoB = new Date(byear,bmonth,bday) 
    var todayDate = new Date();
    todayYear = todayDate.getFullYear();
    todayMonth = todayDate.getMonth();
    todayDay = todayDate.getDate();
    var userAge;

    userAge = todayYear - byear;

    if(todayMonth < (bmonth - 1 ))
    {

    userAge--;

    }

    else if (((bmonth - 1) == todayMonth) && (todayDay < bday))

    {

    userAge--;

    }

document.getElementById("ageResult").innerHTML = "You are currently: " 
+ userAge;

var displayQuote = 0;

    for (Age = userAge; Age <= 65; Age--)

    {
    displayQuote = 500-(500*(65-Age)/100);
    return displayQuote;
    }
} 
```

我想做的是显示前 3 年，然后是第 65 年。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:18:42.227

```
for (Age = userAge; Age <= 65; Age--)

{
displayQuote = 500-(500*(65-Age)/100);
return displayQuote;
} 
```

}

我相信您的问题都在于您的代码的这一部分。

1）年龄 - 会减少，所以除非您的用户年龄超过 65 岁，否则您的循环将永远不会结束

2）当您使用 return 关键字时，它将该值返回给调用它的任何内容并退出函数

3）目前您正在运行循环，直到用户达到 65。

```
for (Age =userAge ; Age <= 65; Age++) {
   if ((Age<(userAge+3))|| (Age==65)){
       displayQuote = 500-(500*(65-Age)/100);
       alert(displayQuote);
   }
} 
```

@Mike Samuel 如果您说 Age<3 它只会在用户为 0-2 时给出

```
 var Age = 65-userAge
 displayQuote = new Array(4);
 for (var i=0; i<3; i++)//first 3 years
     displayQuote[i] = 500-(500*(65+i)/100);
 displayQuote[3]= 500-(500*(65)/100);//65th year

    document.getElementById("quoteResult").innerHTML = "Your quote is: " + document.getElementById("quoteResult").innerHTML + "<br/> year 1 " + " : £" + displayQuote[0] + " " + "Year 2: £" + displayQuote[1] + " " + "Year 3: £" + displayQuote[2]+"<br />"; 
```

我不确定当它是第 65 年时你想如何显示。你会使用 displayQuote[3]; 您之前所拥有的是读取相同的变量 3 次。这就是你遇到麻烦的原因。

# android - 统计发送的 SMS 消息

> ID：10723275
> 
> 赞同：0
> 
> 时间：2012-05-23T15:34:07.280
> 
> 标签：android

我必须计算用户或其他应用程序发送的所有短信（SMS）。

我的应用程序将作为服务（在后台）运行并计算发送的消息。

最后，当发送消息的数量大于某个值时，我会触发一个动作。

对此有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:46:05.557

Yoc 可以通过使用 ContentObserver 来计算用户或设备上任何其他应用程序发送的 SMS 从 侦听[SMS](http://developer.android.com/reference/android/database/ContentObserver.html) ***ContentProvider***

有关如何注册*SMS ContentProvider*`ContentObserver`的完整示例， 请在[这篇文章](https://stackoverflow.com/questions/9520277/practical-way-to-find-out-if-sms-has-been-sent/9659025#9659025)中查看我的答案

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:46:15.873

这将由 broadCastReceiver 检查这个 [Android - SMS 广播接收器](https://stackoverflow.com/questions/4117701/android-sms-broadcast-receiver)*

# silverlight - 制作一个可以包含子元素的用户控件（如 Border-Element）

> ID：10723278
> 
> 赞同：1
> 
> 时间：2012-05-23T15:34:22.400
> 
> 标签：silverlight, user-controls, contentpresenter

在我的 Silverlight 4 应用程序中，我想创建一个简单的用户控件，除了其他东西之外，它还可以包含另一个控件。我想要的一个例子是边境控制。您可以将任何其他控件（确切地说是一个其他控件）“放入”Border-Control，以便 Border-Control 包含其他用户控件并显示其内容。我需要做什么来创建具有该功能的用户控件？这个想法是将另一个控件放在我的用户控件中的**ContentPresenter中，例如：**

```
<Grid x:Name="LayoutRoot">
  <Grid.RowDefinitions>
    <RowDefinition Height="Auto" />
    <RowDefinition />
  </Grid.RowDefinitions>

  <TextBlock x:Name="TextBlockHeader" Text="{Binding Title, ElementName=userControl}" HorizontalAlignment="Left" Foreground="White" Margin="5,0"/>
  <ContentPresenter x:Name="ContentPresenterObject" Grid.Row="1" />
</Grid> 
```

现在，如何才能将子控件（在 Expression Blend 中）添加到我的 UserControl 以及如何将其绑定到 ContentPresenter？或者这是一个错误的方法？

提前致谢，
弗兰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T17:02:03.727

我建议创建一个继承自 ContentControl 的自定义控件。[这是一篇关于 UserControls 和自定义控件](http://www.sharpgis.net/post/2012/02/06/Why-Custom-Controls-are-underrated.aspx)的不错的博客文章

您需要创建一个“Generic.xaml”来定义您的 xaml，以及一个 cs 类来定义您的类。

```
public class CustomControl: ContentControl
{
    public CustomControl()
    {
        this.DefaultStyleKey = typeof(CustomControl);
    }
} 
```

你的 xaml 类看起来像：

```
<ResourceDictionary
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyApp">

<Style TargetType="local:CustomControl">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:CustomControl">
                <Grid x:Name="LayoutRoot">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBlock x:Name="TextBlockHeader" Text="{Binding Title,
                               ElementName=userControl}" HorizontalAlignment="Left" 
                               Foreground="White" Margin="5,0"/>
                    <ContentPresenter x:Name="ContentPresenter" Grid.Row="1"
                                      Content="{TemplateBinding Content}"
                                      ContentTemplate="{TemplateBinding ContentTemplate}"
                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# ruby-on-rails - Ruby on Rails - 创建后分配 HABTM

> ID：10723284
> 
> 赞同：0
> 
> 时间：2012-05-23T15:34:37.013
> 
> 标签：ruby-on-rails, orm, has-and-belongs-to-many

我正在使用 rails 3.2.3 并且无法在我的 HABTM 关系中分配值。

基本上我有 2 个模型，产品和用户。当我创建一个新产品时，我想在 Products_Users 中间表中插入插入的值。

它必须是 HABTM，因为将来我希望能够说“用户 x 也可以编辑该产品”，而不仅仅是产品的原始创建者。

我的模型：（为简单起见省略了其他关系）

```
product.rb
class Product < ActiveRecord::Base
has_and_belongs_to_many :users
accepts_nested_attributes_for :users

attr_accessible <product attributes>, :user_ids, :user_id #it says cant mass assign user_ids so I also added the :user_id, but then it says unknown attribute :user_id
end 
```

* * *

```
user.rb

class User < ActiveRecord::Base
has_and_belongs_to_many :products
attr_accessible :user_id <plus the user attributes>
end 
```

我的产品控制器具有来自脚手架的默认操作和代码。

问题也可能出在我的观点上。我在产品和类别之间也有 HABTM 关系，一切都很好（我从复选框列表中选择类别）

但是，在已登录的用户创建新产品后，如何在 Products_Users 表中插入新行？

我试图在表单中使用我的视图：

<%= f.hidden_​​field :product_id, :value => params[:id]%> #如果产品不是技术上创建的，这里放什么？

<%= f.hidden_​​field :user_id, :value => current_user.id%>#这个“current_user.id”在其他视图中有效。

这不起作用，也没有什么意义，是否有可能实现我想要做的事情？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T11:48:02.927

我删除了`hidden fields`并在保存后添加了这个：

```
user=current_user
@product.users << user 
```

希望它可以帮助某人。

问候

# php - 生成验证码图片失败，内容已输出

> ID：10723285
> 
> 赞同：0
> 
> 时间：2012-05-23T15:34:37.230
> 
> 标签：php, apache, google-chrome, captcha

我使用[secureimage](http://www.phpcaptcha.org/)解决方案生成验证码

我在 chrom 控制台上有这个错误

> 资源解释为图像，但使用 MIME 类型 text/html 传输

并在此 url 上输入时直接用作图像 src

> securimage_show.php?sid=fa5e1eb19c3a534885632e

我有这个错误

> 生成验证码图片失败，内容已输出。这很可能是由于配置错误或向浏览器发送了 PHP 错误

有人知道吗？

注意：它适用于本地主机 wampserver 但不适用于远程服务器

编辑：

验证码开源代码中的代码生成 php 错误：

```
 protected function output()
{
    if ($this->canSendHeaders() || $this->send_headers == false) {
        if ($this->send_headers) {
            // only send the content-type headers if no headers have been output
            // this will ease debugging on misconfigured servers where warnings
            // may have been output which break the image and prevent easily viewing
            // source to see the error.
            header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
            header("Last-Modified: " . gmdate("D, d M Y H:i:s") . "GMT");
            header("Cache-Control: no-store, no-cache, must-revalidate");
            header("Cache-Control: post-check=0, pre-check=0", false);
            header("Pragma: no-cache");
        }

        switch ($this->image_type) {
            case self::SI_IMAGE_JPEG:
                if ($this->send_headers) header("Content-Type: image/jpeg");
                imagejpeg($this->im, null, 90);
                break;
            case self::SI_IMAGE_GIF:
                if ($this->send_headers) header("Content-Type: image/gif");
                imagegif($this->im);
                break;
            default:
                if ($this->send_headers) header("Content-Type: image/png");
                imagepng($this->im);
                break;
        }
    } else {
        echo '<hr /><strong>'
            .'Failed to generate captcha image, content has already been '
            .'output.<br />This is most likely due to misconfiguration or '
            .'a PHP error was sent to the browser.</strong>';
    }

    imagedestroy($this->im);
    restore_error_handler();

    if (!$this->no_exit) exit;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-11T08:25:25.890

快速解决：

只需替换 securimage.php 文件中的 canSendHeaders 函数

从

```
protected function canSendHeaders() {

    if (headers_sent()) {

        // output has been flushed and headers have already been sent
        return false;
    } else if (strlen((string) ob_get_contents()) > 0) {
        // headers haven't been sent, but there is data in the buffer that will break image and audio data
        return false;
    }

    return true;
} 
```

至

```
protected function canSendHeaders() {

    ob_get_clean();

    if (headers_sent()) {

        // output has been flushed and headers have already been sent
        return false;
    } else if (strlen((string) ob_get_contents()) > 0) {
        // headers haven't been sent, but there is data in the buffer that will break image and audio data
        return false;
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:55:25.613

> 生成验证码图片失败，内容已输出。这很可能是由于配置错误或向浏览器发送了 PHP 错误

我认为您在 web.config 中缺少对 dll 的引用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T07:13:34.170

今天早上我在一个月前完成的开发中遇到了同样的问题，今天部署时我忘记了我在 securimage.php 的顶部放置了一个回声，希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T16:37:26.780

从这个评估为`false`：

```
if ($this->canSendHeaders() || $this->send_headers == false) { 
```

`output`在调用该函数之前，您已经将内容发送到浏览器。

为了能够使用该功能，您必须确保没有向浏览器发送任何内容；`<?php`在开始标签之前没有空行或空格，没有`echo`语句等。

# jquery - 下拉列表单击事件 - jQuery

> ID：10723286
> 
> 赞同：3
> 
> 时间：2012-05-23T15:34:39.823
> 
> 标签：jquery

我认为这对于任何使用 jQuery 的人来说都是一件非常容易的事情，但是我的页面上有动态生成的下拉列表，并且我在类上设置了一个点击事件，正如预期的那样会触发一个点击事件为他们所有人。的 ID`select`是动态生成的，因此我不能将其用作选择器。我只想`select`为实际更改的事件触发事件。

我需要在函数中使用所选值的 id - 有人知道这是怎么做的吗？

我到目前为止的代码：

```
$(document).ready(function () {
    $(".boxItem").change(function () {
        var str = $(this).attr('id');
        var num = $(this).val();
        alert(num);
        var url = "/Search/GetBoxChangeInfo";
        var vmData = { json : @Html.Raw(Json.Encode(Model)),
                        id : str,
                        boxNo : num };
        $.post(url, vmData, function (data) {
            $("#column-1").html(data);
        });
    });
}); 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:44:09.503

如果它是动态的，您需要委托：

```
$(document).on('change', '.boxItem', function () {
    var str = this.id;
    var num = this.value;
    ...... 
```

`this`将使用已更改的类引用选择`.boxitem`，并且获取 ID 和值应该按预期工作，也用最接近的非动态父级替换文档！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:37:12.010

```
$(".boxItem").on("change", function () {

    // to get the value and id of selected option
    var str = $('option:selected', this).attr('id');
    var value = $('option:selected', this).attr('value');

    // or to get value and id of select box use
    var str = this.id; 
    var value = this.value;
    ......
}); 
```

如果你`select`是在 DOM 准备好之后创建的，那么你应该尝试

```
 $("body").on("change", ".boxItem", function () {

    // to get the value and id of selected option
    var str = $('option:selected', this).attr('id');
    var value = $('option:selected', this).attr('value');

    // or to get value and id of select box use
    var str = this.id; 
    var value = this.value;
    ......
}); 
```

# javascript - 标准菜单栏/详细信息页面移动 UI 的主干视图设计

> ID：10723289
> 
> 赞同：3
> 
> 时间：2012-05-23T15:34:44.797
> 
> 标签：javascript, backbone.js, backbone-views

我正在构建一个移动网络应用程序，并且一直在为我的主干视图的设计和布线而苦苦挣扎。

让我说明我想要实现的目标。

![在此处输入图像描述](../Images/9ce8c60ce107785a0b138bc69f459185.png)

如您所见，上图标识了几个 UI 组件：

*   带有返回、搜索和菜单按钮的工具栏视图
*   带有列表的选项卡式视图
*   详细视图
*   菜单视图

关于行为的一些注意事项：

*   点击菜单按钮覆盖并动画菜单。
*   列表和详细信息视图可通过主题标签永久访问

现在我已经为工具栏、菜单、列表和细节创建了视图。但显然视图之间必须有一些交互，我不知道如何处理它。

要解决的问题：

1.  转到详细信息或列表时是否渲染所有视图？如果没有，如何更新工具栏并处理这种关系
2.  当从选项卡 2 转到详细信息并返回列表时，如何记住显示了哪个选项卡。记住带有主题标签的可见选项卡不是一种选择，因为不应记住仅在选项卡之间切换。

我一直在研究[tbranyen layoutmanager](https://github.com/tbranyen/backbone.layoutmanager)，但它似乎仍然假设完全独立的视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:09:17.747

我在使用[Backbone.Marionette](https://github.com/derickbailey/backbone.marionette)做这类事情时取得了一些成功。它允许您在应用程序中定义区域，然后独立管理在这些区域中显示的视图。

所以工具栏是一个区域，主区域是一个区域。然后在列表和详细信息之间切换时，您只需将列表/详细信息视图插入主区域，单独留下工具栏区域。然后，Backbone Marionette 将负责确保呈现正确的视图并从 DOM 中删除元素等。

至于记住可见选项卡是什么，您能否不将其存储在选项卡视图上的变量中？或者在一些顶级应用程序对象上？

# algorithm - 在 O(1) 中计算数字中的位数

> ID：10723295
> 
> 赞同：3
> 
> 时间：2012-05-23T15:34:56.693
> 
> 标签：algorithm, x86, numbers, glibc

我需要计算一个数字中的小数位数（例如：4 表示 1002）。我想以 O(1) 的时间复杂度执行此操作，因为代码应在大量数字上进行迭代，从而显着节省 cpu 时间。

我想出了两个解决方案：

1.  循环除以 10，直到数字变为零。循环计数就是答案。但是，这显然是 O(n) 时间。
2.  `log_base_10(num) + 1`

问题：log10 是 O(1) 解决方案吗？我在 x86 机器上使用 glibc 运行代码。这是如何在幕后实现的？并且，有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:56:17.333

假设无符号整数和 Intel 平台（BSR 指令），您可以获得最高设置位。然后你知道：

```
2^i <= num < 2^(i+1) 
```

`i`的最高设置位在哪里`num`。如此简单的查找表（`i`由

但是你真的使用这么大的数字需要这种不可移植的优化吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:56:53.460

这看起来像是[Bit Twiddling Hacks的案例](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLog10Obvious)

```
unsigned int v; // non-zero 32-bit integer value to compute the log base 10 of 
int r;          // result goes here

r = (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 : 
    (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 : 
    (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0; 
```

“当输入均匀分布在 32 位值上时，这种方法效果很好，因为 76% 的输入被第一次比较捕获，21% 被第二次比较捕获，2% 被第三次捕获，依此类推（每次比较都减少 90%）。因此，平均需要少于 2.6 次操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T15:48:37.590

我不会使用 log 来解决这个问题，因为它涉及双重计算，并且可能会比除以 10 的周期慢。牺牲一些内存和一些时间进行预计算，您可能会在一些整数指令中得到答案。例如，预先计算最多 10 000 的数字的位数：

```
int num_digits[10000];
for (int i = 0; i < 10000; ++i) {
  if (i < 10) {
    num_digits[i] = 1;
  } else if (i < 100) {
    num_digits[i] = 2;
  } else if (i < 1000) {
    num_digits[i] = 3;
  }
} 
```

现在这里是你如何在大约 4 个整数运算中得到一个数字的位数：

```
int get(int n) {
  int result = 0;
  while (n > 10000) {
    result += 4;
    n /= 10000;
  }
  return result + num_digits[n];
} 
```

这当然会为了速度而牺牲记忆，但正如我们所知[，没有免费的午餐](http://en.wikipedia.org/wiki/No_free_lunch_in_search_and_optimization)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T15:39:39.387

您需要做的就是：

```
1 + floor(log(N)/log(10)) 
```

（这不适用于 0。如果输入浮点数，它将返回小数点左侧的位数，并且仅适用于大于 0.1 的浮点数。）

几乎可以肯定有一条 FPU 指令，不是在原始 x86 中，而是在您的 CPU 支持的扩展中。`log(N)`您可以通过在循环中多次评估来测试这一点。

这是假设您将数字存储为 int 或 float。如果您使用某个库将数字存储为可变长度数组，如果库预先计算数组的长度（正确的做法），这是 O(1) 时间，否则是 O(N) 时间（坏库）。

与所有浮动操作一样，如果您真的接近过渡 99-100、999-1000 等，则准确性可能是一个问题。正如史蒂夫杰索普在此答案的评论中指出的那样，您可以根据到所需的语义。我什至可以说你有一点余地：你可以从 N 中添加/减去 0.1 之类的东西，如果这些转换数字以某种方式失败（没有那么多数字：你可以自己手动测试它们，看看这是否是必要的）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-07-07T15:04:41.670

```
import java.util.*;
import java.lang.*;
class Main
{
  public static void main (String args[])
  {
    Scanner in = new Scanner (System.in);
    System.out.print ("Enter the number : ");
    int n = in.nextInt ();
    double ans = 1 + Math.floor (Math.log (n) / Math.log (10));
    int intANS = (int) (ans);
    System.out.println ("No. of digits in " + n + " = " + intANS);
  }
} 
```

// 在 JAVA 中

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2020-07-16T09:25:13.757

```
class NumberOfDigits{

    public static void main(String ar[]){
        int n=99;
        System.out.println(""+(1+Math.floor(Math.log10(n))));
    }
} 
```

# php - 使用 exec 命令输出空

> ID：10723296
> 
> 赞同：1
> 
> 时间：2012-05-23T15:34:58.463
> 
> 标签：php, exec

我正在尝试使用不起作用的 exec 启动 PHP 文件。这是代码：

```
$output =NULL; 
exec("php /path/server/public/php/reports/templates/1.php > /dev/null &", $output);
echo "<pre>" . var_export($output, TRUE) . "</pre>\\n"; 
```

该网站托管在 OVH 上。$output 为空且 exec 未启动。如果有人知道出了什么问题.. 非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:49:11.017

你为什么指向/dev/null？这会将输出重定向到您的会话之外。& 在这种情况下也可能没有用，因为 exec 需要等待您的第二个脚本完成才能打印输出。

```
exec("/path/to/script.php", $output); 
```

应该只要：

*   权限设置正确（文件夹和脚本可执行文件）
*   您的主机允许使用 exec

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:38:23.280

尝试以下操作：

```
passthru("php /path/server/public/php/reports/templates/1.php > /dev/null &", $output); 
```

# vim - Vim，如何自动删除空行到“_？

> ID：10723299
> 
> 赞同：2
> 
> 时间：2012-05-23T15:35:04.110
> 
> 标签：vim

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:18:12.373

从我的`~/.vimrc`：

```
nnoremap <leader>d "_d
vnoremap <leader>d "_d 
```

只需将第一个`d`替换`dd`为`<leader>d`. 那少了一把钥匙。

例子：

```
4,dd
,dt:
Vjj,d 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T09:38:42.820

这是一个有趣的想法。基本上，你想要一个“聪明”的删除。这意味着您需要定义一个新的运算符。

如何定义一个新的操作符在 Vim 帮助中描述[`:h :map-operator`](http://vimdoc.sourceforge.net/htmldoc/map.html#%3amap-operator)。

巧妙删除的代码将包括以下内容：

```
nnoremap <silent> d :<C-U>set opfunc=CleverDelete<CR>g@
function! CleverDelete(type)
  let reg_save = @@
  if a:type ==# 'line'
    normal! '[V']ygv
    if @@ =~ '\%^\_s*\%$'
      normal! "_d
      let @@ = reg_save
    else
      normal! d
    endif
  elseif a:type ==# 'char'
    " ...
    " TODO
  else
    " TODO
  endif
endfunction 
```

这适用于逐行删除：如果它只删除空格，则`dj`变为。`"_dj`

现在您需要实现按字符删除、可视模式映射、`v:count`处理、逐行映射`dd`等。这只是一个开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:19:33.347

使用以下命令重新映射`d`到：`"_d`

```
nnoremap d "_d
vnoremap d "_d 
```

这将重新映射`d`正常和可视模式。请注意，如果您有任何其他映射或调用该`d`命令的函数，则必须进行调整，否则它将调用 default `d`，而不是新`"_d`映射。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T16:39:19.713

另一种解决方案是使用`"0`寄存器。您抽出的东西以及默认寄存器都存储在那里，因此您可以在删除行后使用它来放置。

所以你会做这样的事情：

```
yy  # Yank your line
p   # put the yank
dd  # delete a line
"0p # put the yank 
```

对于一些更用户友好的 yanking 和 put 功能，您可以使用[YankRing 插件](https://github.com/vim-scripts/YankRing.vim)之类的东西。我想有可能更新 YankRing 以实现您正在寻找的那种功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T16:53:37.330

所以基本上，你想重复`"_dd`而不必`"_`再次按下？

只需使用`.`，它将重复整个最后一个编辑序列。例如，这会将两个“Hello”行删除到`_`：

```
/Hello
"_dd
N. 
```

要回答您问题的第一部分，`"_d$`（删除到行尾，进入黑洞寄存器）是完全有效的，就像`"_d/foo<enter>`“从光标删除到'foo'第一次出现的开头，进入黑色保持寄存器”。

# c# - 如何将包含的对象/属性序列化为根？

> ID：10723302
> 
> 赞同：0
> 
> 时间：2012-05-23T15:35:11.883
> 
> 标签：c#, xml, serialization, xml-serialization

我有一个棘手的问题。假设我有一个名为的类，它`ObjectHost`包含一个 type 的属性`BusinessObject`，它本身包含一些属性（假设 a`Name`和 a`Town`作为字符串）。代码是：

```
public class ObjectHost
{
    public BusinessObject Data { get; set; }

    public ObjectHost()
    {
        Data = null;
    }

    public ObjectHost(BusinessObject ei)
    {
        Data = ei;
    }

    public override string ToString()
    {
        return (Data == null) ? "null" : Data.ToString();
    }
} 
```

序列化时，它将产生如下内容：

```
<ObjectHost>
  <Data>
    <Name>My name</Name>
    <Town>London</Town>
  </Data>
</ObjectHost> 
```

我希望它在哪里：

```
<Name>My name</Name>
<Town>London</Town> 
```

因为它只是我特定用途中的封装对象（用于某些其他目的）。

我尝试使用`XmlRoot`和`XmlElement`属性，但我没有达到我的目标。

有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:49:13.827

据我了解，您正在使用 XmlSerializer 序列化对象。

您正在传递 ObjectHost 并且只希望发出 ObjectHost.BusinessObject 的属性。

您可以使用以下方法之一

1.  序列化数据的后处理 -> 使用 XPath 查询获取所需数据

    ```
    /ObjectHost/Data 
    ```

2.  自定义序列化过程：（这有点棘手）
    a）实现 IXmlSerializable
    b）自定义 ReadXml、WriteXml 和 GetSchema

    在 WriteXml 中，使用 XPath 查询或其他 Xml 方法（以获取 XmlNodes）并仅写入所需的属性。
    这种方法将绑定到特定的数据结构，并且不能用于不兼容的数据结构。

# c# - 使用 Lambda 表达式会导致类类型发生变化

> ID：10723310
> 
> 赞同：2
> 
> 时间：2012-05-23T15:35:32.977
> 
> 标签：c#, .net, reflection, lambda, abstract

好吧，这让我很困惑。我有一个名为 Testbase 的抽象基类，它有一个名为 RunTest 的抽象函数。在一个文件夹中，我有一组继承这个抽象类的类。在测试控制器中，我调用以下代码来创建这些测试类的实例列表。

```
 String ns = "HCTCommon.Tests";
        var query = from t in Assembly.GetExecutingAssembly().GetTypes()
                    where t.Namespace == ns
                    select t;

        foreach (object t in query)
        {
            TestBase test = (TestBase)Activator.CreateInstance(t as Type);
            testList.Add(test);
        } 
```

在其中一个类 RunTest 函数中，我正在清理代码并决定使用 lambda 表达式并尝试了各种版本。

```
pullservice = ServiceController.GetServices().FirstOrDefault(s => s.ServiceName == serviceName); 
```

和

```
pullservice = ServiceController.GetServices().Where(s => s.DisplayName.Equals("Pull Service")).ToList()[0]; 
```

是我记得的，但是每当我使用 lambda 而不是运行一些复杂的 foreach 循环时，我都会在代码行上得到一个 invalidcastexception

```
TestBase test = (TestBase)Activator.CreateInstance(t as Type); 
```

例外：

```
Unable to cast object of type '<>c__DisplayClass4' to type 'HCTCommon.TestBase'.

Stack Trace:

   at HCTCommon.TestController.populateTestList()
   at HCTCommon.TestController..ctor(RegistryKey Key)
   at HealthCheck.HealthCheckForm.InitializeTestPanels() in C:\Users\bkoch.ESI911\documents\visual studio 2010\Projects\HCTCommon\HealthCheck\HealthCheckForm.cs:line 55
   at HealthCheck.HealthCheckForm..ctor() in C:\Users\bkoch.ESI911\documents\visual studio 2010\Projects\HCTCommon\HealthCheck\HealthCheckForm.cs:line 26
   at HealthCheck.Program.registrycheck() in C:\Users\bkoch.ESI911\documents\visual studio 2010\Projects\HCTCommon\HealthCheck\Program.cs:line 63
   at HealthCheck.Program.Main() in C:\Users\bkoch.ESI911\documents\visual studio 2010\Projects\HCTCommon\HealthCheck\Program.cs:line 34
   at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:38:34.103

lambda 表达式生成一个匿名闭包类来保存局部变量。
您的代码错误地选择了此类。

你应该添加

```
where typeof(TestBase).IsAssignableFrom(t) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:40:06.237

您需要检查 Type 是否实际扩展`Testbase`：

```
var testList = (from t in Assembly.GetExecutingAssembly().GetTypes()
                where t.Namespace == ns && typeof(TestBase).IsAssignableFrom(t)
                select (TestBase)Activator.CreateInstance(t)
               ).ToList(); 
```

# css - 线性渐变背景上的 CSS 图像蒙版叠加

> ID：10723315
> 
> 赞同：0
> 
> 时间：2012-05-23T15:35:55.190
> 
> 标签：css, image, gradient, mask

我正在尝试在背景包含浏览器生成的线性渐变的图像上设置蒙版。在一种填充颜色上制作 mak 相对简单（例如：[http](http://css-tricks.com/webkit-image-wipes/) ://css-tricks.com/webkit-image-wipes/ ）。

但是当背景是线性渐变时，我不知道如何在 Internet Explorer 7 和 8 版本中做到这一点。

在 IE 9 中我可以使用画布，但 IE 7 和 8 不支持画布。有谁知道我该怎么做？窗口，在哪里是背景，可以是不同的大小，并使用 CSS 生成线性渐变（对于 IE 他们的过滤器）。

# javascript - 我的站点中是否需要非缩小版的 jQuery 脚本？

> ID：10723318
> 
> 赞同：2
> 
> 时间：2012-05-23T15:35:59.360
> 
> 标签：javascript, jquery, asp.net, deployment, minify

[这个问题](https://stackoverflow.com/q/3475024/57428)的答案解释说，例如`jquery-1.5.1.min.js`是一个缩小版本，`jquery-1.5.1.js`而后者是存在的，以便我可以阅读和分析脚本，而前者是供实际使用的。

现在，如果我创建一个 MVC3 ASP.NET 应用程序并将其添加到 Azure 角色中，则两者（以及`jquery-1.5.1-vsdoc.js`）都将被复制到站点和服务包的 Scripts 子文件夹中。

在调试时和运行时我的 Azure 角色中，我是否真的需要`jquery-1.5.1.js`和文件？`jquery-1.5.1-vsdoc.js`我可能需要它们的场景是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:40:43.513

在调试时，我发现在单步执行代码时使用非缩小版本的 jQuery 很有用。

它有助于查看 jQuery 中发生的可能导致错误的情况。只有当 jQuery 本身存在错误时，它才会真正发挥作用（我发现并报告了几个）。如果您对单步执行 jQuery 代码不感兴趣，那么不必担心冗长的版本，并坚持使用缩小的参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:43:43.697

> **在调试时我是否真的需要我的站点中**的 jquery-1.5.1.js 和 jquery-1.5.1-vsdoc.js 文件，并且在运行时我的 Azure 角色中是否需要这些文件？

不，有更好的选择：

*   在您的 PC 中保留一份副本
*   将该 jQuery 版本的众多镜像之一的 URL 加入书签
*   需要时重新下载（不是很推荐，但比~~浪费~~使用您网站中的空间）

这假设将来需要它们的唯一目的是调试

# mongodb - 通过 mongodb 中的 morphia 对类中对象列表的字段访问

> ID：10723320
> 
> 赞同：0
> 
> 时间：2012-05-23T15:36:09.027
> 
> 标签：mongodb, entity, field, morphia

我在使用 morphia POJO 映射器在 mongodb 中实现过滤器时遇到了一些问题。

在我的类（例如`SampleClass`）中，当我尝试访问`@Entity`类的字段（在我们的例子中是`Person`）时，我发现字段访问工作正常，对 int、string、maps 或直接嵌入对象等一般字段使用点表示法。

问题是我无法理解它在`Person`类中引用的“对象列表”的情况下是如何工作的。（假设在这里，一个人可以有很多地址，所以这个`Person`类有一个`addresses`包含对象列表的字段`Address`）

```
@Entity
Class Person
{
    String name;
    int age;
    String type;
    private Map<String, String> personalInfo= new HashMap<String, String>();
    @Reference
    List<Address> addresses = new ArrayList<Address>;
}

@Entity
Class Address
{
    String streetName;
    int doorNo;
} 
```

例如，我想对列表`streetName`中的`Address`对象应用过滤器`addresses`

```
public class SampleClass
{  
    private Datastore ds;
    Query<Node>              query;
    CriteriaContainer        container;

    // connections params etc....
    public List<Person> sampleMethod()
    {
        query = ds.find( Person.class ).field( "type" ).equal( "GOOD");                              

        container.add( query.criteria( "name" ).containsIgnoreCase("jo" ));   
        // general String field in the Person Class ---- OKAY, Work's Fine

        container.add( query.criteria( "personalInfo.telephone" ).containsIgnoreCase( "458" ) ); 
        // Map field in the Person Class, accessing telephone key value in the map --- OKAY, Work's Fine

        container.add( query.criteria( "addresses.streetname").containsIgnoreCase( "mainstreet" ) ); 
        // List of address object in the Person Class, name of the field is 'addresses'
        // ----NOT OKAY   ????????? -- Here is the problem it returns nothing, even though some value exists

        return readTopography( query.asList() );
    }
} 
```

访问列表中的对象时我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T09:11:51.183

“addresses”字段是一个@Reference，我们不能将“addresses.name”用作条件中的字段。它应该是地址字段在 "List< Key< Address >>" 中的条件：

```
 Query<Person> personQuery = ds.createQuery(Person.class);
    Query<Address> addressQuery = ds.createQuery(Address.class);
    addressQuery.criteria("streetName").containsIgnoreCase("mainstreet");
    container.add(personQuery.criteria("addresses").in(addressQuery.asKeyList()));

    System.out.println(personQuery.asList()); 
```

问候，悲伤

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:59:26.060

您实际尝试的查询将查询`addresses`带有字段的子文档`streetname`。因此，您只会获得地址为具体地址而不是地址列表的文档。要匹配包含至少一个地址匹配的所有人员，请使用`$elemMatch` [http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-ValueinanArray](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-ValueinanArray)。但我不确定 Morphia 是否能够使用您的模式执行此类查询。请记住，您的实际 Document 不包含嵌入的这些地址，而是仅包含 dbrefs [http://www.mongodb.org/display/DOCS/Database+References](http://www.mongodb.org/display/DOCS/Database+References)。因此，如果 morphia 不够聪明，无法转换您的查询，它将不会成功，因为 mongoDB 根本不知道 DBRefs（因为这只是一些驱动程序约定）。

因此，对于 morphia 不提供此功能的情况，您需要查询不同的内容。首先，您需要查询您的地址集合以查找符合您的条件的地址。`$elemMatch`收集这些 ObjectId并在您的 Person Collection 查询中使用它们`$in`，以过滤掉所有没有此类地址的人，以及您的进一步过滤选项。您需要记住，您没有一些关系系统可以为您加入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T19:08:33.383

对我来说它看起来像打字错误`container.add( query.criteria( "addresses.streetname").containsIgnoreCase( "mainstreet" ) );`。

我认为`streetname`需要更改为`streetName`.

我已经使用吗啡一年了。AFAIK，`container.add( query.criteria( "addresses.streetName").containsIgnoreCase( "mainstreet" ) );`应该可以正常工作。

# linux-kernel - 任何类似于 wait_on_page_bit

> ID：10723323
> 
> 赞同：1
> 
> 时间：2012-05-23T15:36:14.177
> 
> 标签：linux-kernel

任何人都可以告诉我是否有任何 API 或我可以使用的其他方式

```
 void wait_on_page_bit(struct page *page, int bit_nr) 
```

到目前为止，wait_on_page_bit() 期望设置 nr_bit 并使线程休眠，当该位即 bit_nr 被清除时它会唤醒线程。

就我而言，它是 PG_Uptodate 位。默认情况下它被清除，我需要让我的线程休眠，告诉它已设置，并且线程应该唤醒。

谢谢，卡皮尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:02:14.510

在锁定页面中设置的假设下，`PG_Uptodate`您可以执行以下操作：

```
do {
    wait_on_page_locked(page);
} while (PageUptodate(page); 
```

# twitter-bootstrap - 下拉菜单不重叠

> ID：10723332
> 
> 赞同：0
> 
> 时间：2012-05-23T15:36:42.410
> 
> 标签：twitter-bootstrap

正如您从标题中看到的那样，我的问题是重叠的。我的代码正在运行，但是当我将下拉列表放入导航栏容器时，单击它时它不会下拉。这是我的代码：

```
 <div class="navbar-inner">

     <div class="container">
  <%= link_to "Print- it- Green", root_path, id: "logo" %>

  <nav>
    <ul class="nav nav-tabs custom">
      <li class="active"><%= link_to "Overview", '#'  %>           
      </li>

      <li><%= link_to "About",    '#' %></li>
      <li><%= link_to "What we do", '#' %></li>
      <li><%= link_to "Partners", '#' %></li>
      <li><%= link_to "Contact", '#' %></li>
      <li><%= link_to "Support", '#' %></li>
      <ul class="nav nav-pills pull-right">
        <li class="dropdown">
          <a class="dropdown-toggle"
             data-toggle="dropdown"
             href="#">
        <%#= current_user.email %>
            <b class="caret"></b>dfghdfdfh
          </a>
          <ul class="dropdown-menu">
            <li><%= link_to "add website", new_website_path %></li>
            <li><%#= link_to "account settings", edit_registration_path %></li>
          </ul>
        </li>
      </ul>

    </ul>
  </nav>   
</div> 
```

请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:06:14.590

您是否在标头中包含 dropdown.js 文件并对其进行初始化？这是我在周围看到的一个常见问题。

# c# - 类似于 StackOverflow 的 WPF Alert 控件

> ID：10723333
> 
> 赞同：0
> 
> 时间：2012-05-23T15:36:49.227
> 
> 标签：c#, .net, wpf

寻找类似于 SO 如何使用 Javascript 在浏览器顶部显示警报的 WPF 控件（如此处所述[通知警报类似于 stackoverflow 的功能](https://stackoverflow.com/questions/3718125/notification-alert-similar-to-how-stackoverflow-functions)）

系统托盘上方显示了一堆用于通知的 WPF 控件

[http://www.hardcodet.net/projects/wpf-notifyicon](http://www.hardcodet.net/projects/wpf-notifyicon)

[http://nickeandersson.blogs.com/blog/2007/12/a-wpf-desktop-a.html](http://nickeandersson.blogs.com/blog/2007/12/a-wpf-desktop-a.html)

但是我希望在当前窗口或用户控件的顶部显示消息，并带有定时淡出以保持消息本地/相关

我是 WPF 新手，所以不知道如何将上面链接的控件定位到当前窗口/用户控件的顶部 - 任何提示/指针都值得赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:26:33.800

使用 DockPanel 作为窗口内的基本面板。将用户控件设置为 DockPanel.Dock=Top。使用另一个面板填充剩余空间。

至于淡出，您可以根据计时器为整个用户控件的不透明度设置动画，当不透明度达到 0 时，将可见性设置为折叠，这样它就不会再占用空间了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:30:45.087

试试这个。

后面的代码。

```
public partial class dtfromdataset : Window
    {
        public dtfromdataset()
        {
            InitializeComponent();

            this.DataContext = this;

            time.Interval = 5000;
            time.Elapsed += new ElapsedEventHandler(time_Elapsed);
            time.Start();
        }
        Timer time = new Timer();

        void time_Elapsed(object sender, ElapsedEventArgs e)
        {
            Dispatcher.BeginInvoke(new Action(() =>
            {
                StatusBarText = "Time is " + DateTime.Now.ToString("ddd-MM-yy HH:mm:ss tt");
            }));
        }

        private DataTable dt = new DataTable();

        public string StatusBarText
        {
            get { return (string)GetValue(StatusBarTextProperty); }
            set { SetValue(StatusBarTextProperty, value); }
        }

        // Using a DependencyProperty as the backing store for StatusBarText.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty StatusBarTextProperty =
            DependencyProperty.Register("StatusBarText", typeof(string), typeof(dtfromdataset), new UIPropertyMetadata(""));

} 
```

Xaml

```
 <Grid Name="stackPanel1">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="224*" />
        </Grid.RowDefinitions>
        <TextBlock Name="statusText"
                   Grid.Row="0"
                   HorizontalAlignment="Stretch"
                   Background="Silver"
                   FontSize="20"
                   Text="{Binding Path=StatusBarText,
                                  NotifyOnTargetUpdated=True}"
                   TextAlignment="Center">
            <TextBlock.Triggers>
                <EventTrigger RoutedEvent="Binding.TargetUpdated">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="Opacity">
                                <EasingDoubleKeyFrame KeyTime="0" Value="0" />
                                <EasingDoubleKeyFrame KeyTime="0:0:0.25" Value="1" />
                                <EasingDoubleKeyFrame KeyTime="0:0:4" Value="1" />
                                <EasingDoubleKeyFrame KeyTime="0:0:5" Value="0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </TextBlock.Triggers>
        </TextBlock>
</Grid> 
```

# windows-7 - 在 Windows 7 中通过注册表而不是控制面板更改电源方案设置

> ID：10723339
> 
> 赞同：4
> 
> 时间：2012-05-23T15:37:07.517
> 
> 标签：windows-7, registry, controlpanel, control-panel

我想在 Windows 7 中通过注册表而不是控制面板更改电源方案的设置（例如，在 45 分钟后进入睡眠状态而不是 30 分钟）。我还想关闭热键同样的方法。

有什么建议我该怎么做吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-02-27T19:03:36.583

我知道这是一个老问题，但如果将来有人再次遇到它，这是我遇到类似问题时必须工作的代码示例。

请注意，我同意之前对使用和抽象 API 的评估，但万一这对任何人都有帮助：

```
::Set the 'Power Management' to Balanced
powercfg -SETACTIVE 381b4222-f694-41f0-9685-ff5bb260df2e

::Set the unplugged settings to 'Never'
powercfg.exe -change -monitor-timeout-dc 0
powercfg.exe -change -standby-timeout-dc 0
powercfg.exe -change -hibernate-timeout-dc 0

::Set the plugged in settings to 'Never'
powercfg.exe -change -monitor-timeout-ac 0
powercfg.exe -change -standby-timeout-ac 0
powercfg.exe -change -hibernate-timeout-ac 0

::Set the 'Dim Timeout' to Never
powercfg -SETDCVALUEINDEX 381b4222-f694-41f0-9685-ff5bb260df2e 7516b95f-f776-4464-8c53-06167f40cc99 17aaa29b-8b43-4b94-aafe-35f64daaf1ee 0
powercfg -SETACVALUEINDEX 381b4222-f694-41f0-9685-ff5bb260df2e 7516b95f-f776-4464-8c53-06167f40cc99 17aaa29b-8b43-4b94-aafe-35f64daaf1ee 0 
```

参考来源：[http ://ss64.com/nt/powercfg.html](http://ss64.com/nt/powercfg.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T15:50:35.083

我怀疑由于电源管理架构（方案等）的复杂性，这将是不平凡的，并且通过抽象的[API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373170%28v=vs.85%29.aspx)而不是摆弄底层配置数据**总是更好。**

如果您不想使用 API，可以使用[`powercfg`](http://technet.microsoft.com/en-us/library/cc748940%28v=ws.10%29.aspx)命令行工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-21T16:55:25.183

powercfg /q 将列出所有配置参数，此外，对于每个 guid（计划除外）都有一个别名。

例如 powercfg /setacvalueindex 381b4222-f694-41f0-9685-ff5bb260df2e SUB_SLEEP UNATTENDSLEEP 1800

这是 /q 子组 GUID 的缩写输出：238c9fa8-0aad-41ed-83f4-97be242c8f20（睡眠） **GUID 别名：SUB_SLEEP** 电源设置 GUID：7bc4a2f9-d8fc-4469-b07b-33eb785aaca0（系统无人值守睡眠超时） **GUID 别名：无人值守睡眠**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-22T15:09:04.300

查看 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Power\PowerSettings

但我建议您使用“ [PowerSettingsExplorer](https://forums.guru3d.com/threads/windows-power-plan-settings-explorer-utility.416058/) ”。它有 GUI，所以它比注册表更直观。

# c - 作用域通常如何影响嵌套函数的使用？

> ID：10723345
> 
> 赞同：5
> 
> 时间：2012-05-23T15:37:23.240
> 
> 标签：c, scope, lisp, gnu

我想我有这个问题，但我想确认一下。

1.  使用动态范围，使用嵌套函数还是单独的函数都没有关系，因为变量只依赖于调用堆栈。

2.  仅涉及纯函数，使用嵌套函数或单独函数也无关紧要。无论作用域的类型如何，这都是正确的。

3.  对于词法范围，嵌套函数大致模仿调用具有动态范围的函数。

4.  在词法范围内，完全由纯函数编写的程序（可能允许对标准输出进行一次不纯打印）不需要垃圾收集。如果它有所作为，我会特别考虑带有嵌套函数扩展的 GNU C 来解决这个问题。

注意：纯函数是指完全纯函数：唯一“读取”的是参数，唯一“写入”的是函数返回。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:30:26.023

你说得对。不过，我不会尝试将其作为逐个案例的助记符放在我的脑海中——尝试理解其中的原因，你会遇到更少的惊喜。

有关该主题的文档（位于[http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html](http://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html)）非常好。如果你知道堆栈在 C 中是如何工作的，你应该马上就明白了。

此外，鉴于您的问题，我在互联网上找到的一份礼物可能有用：

```
#define lambda(type, body) ({ \
    type __anon_func__ body \
    __anon_func__; \
})

int (*foo) (double) = lambda(int, (double x) { return (int) x; }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:28:36.400

如果您有一种特定的语言，即使您用 C 和 Lisp 标记了它，这也会有所帮助，如果没有一些具体的例子，这将无济于事，因为两者是完全不同的。我不认为 C 是动态作用域的，并且有许多 Lisp 支持动态和词法作用域的许多组合和变体。

1.  这是正确的，但是某些语言通过支持动态和词法范围使这一点复杂化，允许程序员指定使用哪个（例如 Clojure 和 Common Lisp）。

2.  这也是正确的。在这种情况下，您所说的是一个没有副作用且没有任何**自由变量**的函数。

3.  这并不完全正确，它比这更复杂。在具有支持一流函数和闭包的词法范围的语言中，嵌套函数将**关闭**绑定在它定义的环境中的自由变量，并且您可以将该函数返回到外部范围，以及那些关闭的变量将可访问并引用它们定义的原始范围。同样，如果没有来自特定编程语言的具体示例，这很难在抽象中谈论，所以如果你有什么想法，你应该用代码示例编辑你的问题。

4.  我不确定您所说的“垃圾清理”是什么意思？如果您指的是自动内存管理中的垃圾收集，这通常是不正确的，但我不会评论带有嵌套函数的 GNU C 的具体情况，因为我不知道它是如何工作的。

# java - 为什么要避免在 java 中使用 Runtime.exec()？

> ID：10723346
> 
> 赞同：15
> 
> 时间：2012-05-23T15:37:28.793
> 
> 标签：java

```
 Process p = Runtime.getRuntime().exec(command);
   is = p.getInputStream();
   byte[] userbytes = new byte[1024];
   is.read(userbytes); 
```

我想从 java 在 linux os 中执行一个 shell 命令。但是 pmd 报告说不要使用 java Runtime.exec()。为什么？是什么原因 ？Runtime.exec() 有什么替代方案吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-23T15:40:23.413

除非您被困在一个古老的 JVM 上，[`java.lang.ProcessBuilder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ProcessBuilder.html)否则它可以更容易地指定一个进程、设置其环境、生成它并处理它的文件描述符。

> 此类用于创建操作系统进程。
> 
> 每个`ProcessBuilder`实例管理一个流程属性的集合。该方法使用这些属性`start()`创建一个新实例。可以从同一实例重复调用`Process`该方法，以创建具有相同或相关属性的新子流程。`start()`
> 
> ...
> 
> 启动一个使用默认工作目录和环境的新进程很容易：
> 
> ```
>  Process p = new ProcessBuilder("myCommand", "myArg").start(); 
> ```
> 
> 这是一个使用修改后的工作目录和环境启动进程的示例：
> 
> ```
>  ProcessBuilder pb = new ProcessBuilder("myCommand", "myArg1", "myArg2");
>  Map<String, String> env = pb.environment();
>  env.put("VAR1", "myValue");
>  env.remove("OTHERVAR");
>  env.put("VAR2", env.get("VAR1") + "suffix");
>  pb.directory(new File("myDir"));
>  Process p = pb.start(); 
> ```

# php - 调用颠覆（svn ) 使用 shell_exec

> ID：10723348
> 
> 赞同：0
> 
> 时间：2012-05-23T15:37:31.557
> 
> 标签：php

我正在尝试对一个项目做很多 svn 责备，并且我已经为它做了一个 PHP 脚本。

问题是，虽然 echo shell_exec( 'ls' ) 显示了执行文件所在的（svn-versioned）目录的文件`shell_exec( 'svn info' )`，但返回 NULL。知道为什么吗？当然，它可以从终端运行。

我在 OSX Leopard 上。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:48:39.507

在 OSX Lion 上运行良好：

```
<?php
echo shell_exec('svn info');
?> 
```

当我跑`php test.php`过去时。

您可以尝试添加`2>&1`到字符串的末尾以查看 stderr 是否遗漏了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:52:24.493

可能是几件事：数据量，svn 命令的权限......

也试试：

```
exec('svn info',$execOut);
print_r($execOut); 
```

# asp.net-mvc-3 - 将 JQGrid 绑定到复杂类型

> ID：10723355
> 
> 赞同：1
> 
> 时间：2012-05-23T15:37:50.147
> 
> 标签：asp.net-mvc-3, jqgrid

我的每一列都是复杂的类型。

使用自定义格式，我希望能够显示一个属性的文本，然后根据另一个属性为单元格着色（或真正做任何事情）。

例如：

```
public class MyRowObject
{
    public MyCellObject Cell1 { get; set; }
    public MyCellObject Cell2 { get; set; }
    public SomeOtherCellObject Cell3 { get; set; }

}

public class MyCellObject
{
    public string MyDisplayText { get; set; }
    public int MyNumber { get; set; }
} 
```

然后使用自定义格式化程序 javascript 函数来做一些事情，例如：

```
function formatCourseData(cellValue, options, rowObject) {

    var linkHTML = cellValue.MyDisplayText;
    if (cellValue.MyNumber > 10) {

        //format the html in some way

    }

    return linkHTML;
} 
```

现在我知道我不能做 cellValue.MyDisplayText 但这个或类似的事情是我想要做的。

这可能吗？

它在任何地方都有记录吗？（我看过，但找不到任何东西）。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:46:42.393

您可以做的是将复杂对象的每个字段作为其自己的列传递，然后在您的格式化程序中，您可以使用格式化程序的`rowObject`参数来访问其他值以执行您需要的任何操作，例如着色。

或者，如果每个数字表示相同的显示文本，您可能不需要使用第二列。您可以只使用选择格式化程序（或自定义版本），或查找表等。

无论如何，这里有一个示例，说明如何使用它`rowObject`来访问行数据：[access-row-data-in-jqgrid-custom-formatter](https://stackoverflow.com/questions/4036751/access-row-data-in-jqgrid-custom-formatter)

这有帮助吗？

# c# - 如何在 C#/XNA 的游戏中将玩家移动到我的鼠标被点击的位置？

> ID：10723356
> 
> 赞同：1
> 
> 时间：2012-05-23T15:37:54.333
> 
> 标签：c#, xna, mouse

我现在知道如何让船用键盘和游戏手柄移动，但我想弄清楚如何用鼠标移动它（例如，当我点击屏幕上的某个地方时，玩家会移动到那个位置） . 我已经在游戏中显示了鼠标，但是如何让它跟踪它并接受点击等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:41:55.643

您需要将鼠标光标的屏幕坐标转换为世界坐标，然后将玩家移动到该世界坐标

运动取决于您的情况（游戏），但最简单的情况是

1.  计算连接玩家当前位置和所需新位置的向量，
2.  将向量归一化为表示单位时间内运动的大小，
3.  然后通过归一化向量更新玩家的坐标，直到到达目的地

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:12:42.043

使用类似的东西，获取鼠标状态并从中获取坐标。然后在你的游戏中使用瓷砖的大小（如果你的玩家移动到瓷砖，否则忽略它）

```
 MouseState ms = Mouse.GetState();
    double x = Math.Floor(((double)ms.X  / (double)TILE WIDTH);
    double y = Math.Floor(((double)ms.Y  / (double)TILE HEIGHT);

        if (ms.RightButton == ButtonState.Pressed)
        {

            //Player.Position = new Vector2(x,y)... or something like that

        }
        if (ms.LeftButton == ButtonState.Pressed)
        {
            //And so on...

        } 
```

# java - 自动完成 JComboBox/JTextField 每个单词的任何地方

> ID：10723360
> 
> 赞同：4
> 
> 时间：2012-05-23T15:37:59.343
> 
> 标签：java, swing, autocomplete, jcombobox

我找到了在 JComboBox 上添加自动完成功能的不同解决方案，但它们都从一开始就通过自动完成功能工作。我正在寻找类似于[JQueryUI AutoComplete](http://jqueryui.com/demos/autocomplete/)的解决方案（如果您在文本字段中输入*av*，它会弹出*Java*和*JavaScript*）。

例如，如果我有以下物品：

*   “红色的”
*   “蓝色的”
*   “绿色的”

如果我输入*n*，我想与*Green*匹配，因为它包含一个*n*。

这是我之前测试过的解决方案，它只从一开始就匹配：

*   [来自SwingX](http://swingx.java.net/)的 AutoCompleteDecorator.decorate(comboBox)
*   AutoCompleteSupport.install(comboBox, GlazedLists.eventListOf(elements)); 来自[GlazedLists](http://www.glazedlists.com/)
*   来自 jautocomp 的[jautocomp](http://sourceforge.net/projects/jautocomp/)
*   Java2sAutoComboBox.java

上面所有的解决方案都是从一开始就匹配的（都使用 startWith 方法），这不是我要找的。

你知道其他类似于 JQueryUI 实现的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:47:54.397

您可以通过向它们提供子字符串而不是完整字符串来使用上述方法：

```
1\. check against the full string
2\. check against the substring starting at position 1
...
n. check against the substring starting at position `n-1` 
```

受整个字符串长度的限制

因此，对于您的示例，您将执行以下操作：

> 1.  “Green”是否与开头的“n”匹配？否 -> 下一个位置
> 2.  “reen”在开头匹配“n”吗？否 -> 下一个位置
> 3.  “een”是否与开头的“n”匹配？否 -> 下一个位置
> 4.  “en”是否匹配开头的“n”？否 -> 下一个位置
> 5.  “n”是否与开头的“n”匹配？是 -> 选择完整的单词（“绿色”）作为匹配项

# c# - 取消排序 Windows 窗体 DataGridView

> ID：10723361
> 
> 赞同：0
> 
> 时间：2012-05-23T15:38:01.707
> 
> 标签：c#, datagridview

这个功能：

```
dataGridView.Sort(this.dataGridView.Columns[1], ListSortDirection.Descending); 
```

`DataGridView`让我对 a及其作品进行排序。

但随着故事的发展，用户可以取消排序这个视图。

没有数据绑定。视图得到 a`List`并逐行添加它。

那么我该如何取消排序`DataGridView`呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:41:25.610

使用以下代码取消排序：

```
 this.dataGridView1.Columns[1].SortMode = DataGridViewColumnSortMode.NotSortable; 
```

# jstree - jstree dnd 防止节点删除

> ID：10723363
> 
> 赞同：0
> 
> 时间：2012-05-23T15:38:21.557
> 
> 标签：jstree, drag-and-drop

我已经通过拖放设置了一个 jstree。现在我可以将一个节点拖到一个预定义的 div 中。但是树中的节点被删除了。如何拖出一个节点并让该节点仍然保留在树中？

[带有 dnd 插件的 JsTree，总是复制](https://stackoverflow.com/questions/3734680/jstree-with-dnd-plugin-always-copy)对我不起作用。我认为这是因为我会下降到一个 div 而不是另一棵树。

编辑：添加代码

```
$(function () {
$("#tree").jstree({ 
    "crrm" : {
        "move" : { 
            "check_move" : function (m) { //do not allow messing up the tree!
                    return false;
                },
            "always_copy" : "true"
        }
    },
    "json_data" : {
        "progressive_render" : true,
        "ajax" : { 
            "url" : "lookupInstruments.php", 
            "data": function(n) {
                // the result is fed to the AJAX request 'data' option
                return {"id": n.attr ? n.attr("id") : "root_null_null_-1"};
                }
        }
    },
    "dnd" : {
        "drop_finish" : function (data) { 
            //alert(data.o.attr("ptype"));
            drop(data.o); 
        },
        "drop_check" : function (data) {
            if(data.o.attr("dragable") == "0") {
                return false;
            } else {
                return true; 
            };
        },
    },
    "plugins" : [ "themes", "json_data", "crrm", "dnd" ]
}); 
```

});

编辑2：已解决，希望这对其他人有帮助：

问题解决了，我不得不在 drop 函数中克隆 drop 对象。

```
function drop(dObj) {
var dropObj = dObj.clone();
    ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:04:51.203

问题解决了。我不得不在 drop 函数中克隆 drop 对象。

```
function drop(dObj) {
var dropObj = dObj.clone();
    ...
} 
```

# php - PHP - 为上传脚本预加载“请稍候”消息

> ID：10723366
> 
> 赞同：0
> 
> 时间：2012-05-23T15:38:38.793
> 
> 标签：php, forms, post, upload

我设计了一个有效的 PHP 上传脚本，用于通过 POST 命令和 FTP 将文件存放在服务器上。它工作得很好——唯一的问题是我花了很长时间弄清楚如何在文件上传时显示“请稍候”消息。我尝试在脚本上方添加 HTML，但仅在文件已上传（或发生错误）后才会显示文本。唯一可行的（某种）方法是使用 onClick html 表单设置添加一个 Javascript 弹出窗口……但这真的不理想，我担心那些使用该脚本的人可能会被弹出窗口弄糊涂-在 POST/FTP 进程仍在进行时，向上并尝试离开主窗口。

我对 PHP 比较陌生，我觉得有一个明显的解决方案......不幸的是，到目前为止，我似乎找不到一个。有任何想法吗？请原谅我的无知！:)

谢谢-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:40:11.907

您需要在客户端执行此操作。在上传完整文件之前，不会调用 PHP 解释器。因此，如果您有一个 2mb 的文件，您的脚本在通过请求完全发送并保存到临时文件之前不会启动。

我建议使用一些 javascript 来监视您的表单提交以显示您的消息。像这样使用 jquery 的东西：

```
$('form').on('submit', function() {
  $('#loading').show();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:45:07.950

如果您使用的是 PHP 5.4，您可以尝试添加新的文件上传进度。这是一篇很好的文章：

[http://chemicaloliver.net/programming/php-5-4-file-upload-progress-and-html5-progress-bars/](http://chemicaloliver.net/programming/php-5-4-file-upload-progress-and-html5-progress-bars/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:45:01.857

对于 PHP 5.4，现在内置了会话上传进度功能。它最初是在 php 5.3 中修补的。这是它的手册[http://php.net/manual/en/session.upload-progress.php](http://php.net/manual/en/session.upload-progress.php)。

当 session.upload_progress.enabled 为真（在 PHP 5.4 和可能更高版本中默认为真）并且在上传期间发送 $_POST[session.upload_progress.name] 时，有关文件传输的信息在 $_SESSION 超全局中可用大批。

这是一个很好的教程，它使用 $_SESSION 超全局和 javascript 来呈现上传文件的进度条：http: [//phpmaster.com/tracking-upload-progress-with-php-and-javascript/](http://phpmaster.com/tracking-upload-progress-with-php-and-javascript/)

# iphone - iOS XMPP 群聊实现

> ID：10723368
> 
> 赞同：4
> 
> 时间：2012-05-23T15:38:45.870
> 
> 标签：iphone, ios, xmppframework

我正在尝试使用 robbiehanson XMPPframework 创建聊天室。

由于我没有得到任何示例代码或文档，我自己尝试发起一个聊天室，如下所示：

```
 XMPPRoomMemoryStorage *rosterstorage = [[XMPPRoomMemoryStorage alloc] init];
    XMPPRoom *xmppRoom = [[XMPPRoom alloc] initWithRoomStorage:rosterstorage jid:[XMPPJID jidWithString:@"test@mycompany.com/room"] dispatchQueue:dispatch_get_main_queue()];    
    [xmppRoom configureRoomUsingOptions:nil];
    [xmppRoom activate:[UIAppDelegate xmppStream]];
    [xmppRoom addDelegate:UIAppDelegate
            delegateQueue:dispatch_get_main_queue()];
   [xmppRoom inviteUser:[XMPPJID jidWithString:jabberID] withMessage:@"Hi join room"]; 
```

但我在控制台中得到的响应为：

```
 RECV: <message xmlns="jabber:client" from="test@mycompany.com" to="user1@mycompany.com/42512304551337785705750233" type="error"><x xmlns="http://jabber.org/protocol/muc#user"><invite to="user2@mycompany.com"><reason>Hi join room</reason></invite></x><error code="503" type="cancel"><service-unavailable xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"/></error></message> 
```

有人知道启动 MUC 吗？有没有示例代码？任何帮助将不胜感激..在此先感谢..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-21T08:22:32.653

最后我想通了。它可能会帮助某人。创建或加入会议室时，格式应为**yourRoomName@conference.YourDomainName.com**。**“会议”**是这里的关键词。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-25T08:02:27.717

每个房间都被标识为“房间 JID”（例如 ），其中“房间”是 MUC 房间的名称，“服务”是运行多用户聊天服务的主机名。[参考 XEP-0045](http://xmpp.org/extensions/xep-0045.html)

为了使用 XMPP 客户端开始群聊，必须使用关键字“**会议”。**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T09:57:32.703

据我所知，使用 facebook XMPP 服务器无法实现 MUC，因为它是一个精简的服务器。他们没有明确说出来，但我在 pidgin wiki（它是德语）中找到了一些提示：[http](http://wiki.pidgin-im.de/index.php/Facebook) ://wiki.pidgin-im.de/index.php/Facebook 。我也一直在为这个话题而苦苦挣扎......

# javascript - 如何在javascript中接受未签名的证书

> ID：10723369
> 
> 赞同：2
> 
> 时间：2012-05-23T15:38:47.687
> 
> 标签：javascript, ssl

我正在从 javascript 调用启用 SSL 的 Web 服务器上的 Web 服务，并为其提供未签名的证书。

我想知道，有没有办法接受来自 javascript 的未签名证书？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:39:56.103

不，没有办法。

这违反了[XSS 跨站调用](http://en.wikipedia.org/wiki/Cross-site_scripting)。

# jquery - next() 在 IE7 中没有使用“display: none”获取内部 UL

> ID：10723372
> 
> 赞同：1
> 
> 时间：2012-05-23T15:39:15.033
> 
> 标签：jquery, css, internet-explorer-7, html-lists

这是通过以下标记发生的：

```
<ul id="sideMenu" class="menuFontStyle">
<li class="category">Test</li>
<ul class="secondLevel" style="display: none;">
<li></li>
</ul>
... 
```

在 FF 和 Chrome 中，内部 UL 正在被拾取，但 IE7 似乎正在跳到下一个 li。什么可以作为解决方法？这是使用自定义手风琴脚本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:41:44.707

你`ul`不在里面，因为你在打开之前`li`已经关闭了。我不认为这是你想要的。`li``ul`

然后，要访问，`<ul>`你会更好地使用`.find`它，`$("li").find("ul")`因为这将访问唯一的`<ul>`内部`<li>`。

```
<ul id="sideMenu" class="menuFontStyle">
    <li class="category">Test
        <ul class="secondLevel" style="display: none;">
            <li></li>
        </ul>
    </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:43:17.573

那是无效的 HTML，所以你不应该对奇怪的结果感到惊讶。`ul`元素可能没有其他`ul`元素作为直接子元素；它们可能只包含`li`元素。IE7 大概将其包装`ul`在另一个`li`或类似的东西中以使其有效。

使您的 HTML 有效：这将帮助浏览器将其转换为您想要的 DOM 结构，并且您的 JS 编码将更加容易。

# ios - UIButton 上的 TouchDragOutside 直到触摸距离大约 5-10 像素时才会触发

> ID：10723387
> 
> 赞同：0
> 
> 时间：2012-05-23T15:40:05.050
> 
> 标签：ios, xcode, interface-builder, uibutton, touch-event

我在放置在 IB 中的 UIButton 上使用 TouchDragOutside，但直到我垂直移动 8px 和水平移动 2 后它才会触发。按钮尺寸（从 IB 检查器读取）为 50 宽和 35 高。我真的不明白！

有没有办法检查/设置按钮的实际边界是什么？我是否需要为 touchdragoutside 设置不同的边界？

有没有其他人遇到过这个问题，或者这是 touchdragoutside 设计工作方式的一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:52:33.247

这可能是设计使然，下次您使用导航栏时，请尝试在您想要的按钮之外稍微点击一下，您会注意到即使您在按钮之外，它仍然是可点击的。Apple 这样做是为了让用户交互更容易，我敢打赌，您所体验的是相同设计概念的一部分，为用户提供了一个“缓冲区”，可以`TouchDragOutside`在它触发之前决定取消它。

# node.js - NodeJS ping 端口

> ID：10723393
> 
> 赞同：13
> 
> 时间：2012-05-23T15:40:28.727
> 
> 标签：node.js

我正在为我工​​作的一家托管公司编写状态检查器，我们想知道如果可能的话，我们如何使用 nodejs 检查端口的状态。如果没有，您能否提出任何其他想法，例如使用 PHP 和阅读 STDOUT？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-23T15:52:41.113

是的，使用该[`net`](http://nodejs.org/docs/latest/api/net.html)模块很容易做到这一点。这是一个简短的例子。

```
var net = require('net');
var hosts = [['google.com', 80], ['stackoverflow.com', 80], ['google.com', 444]];
hosts.forEach(function(item) {
    var sock = new net.Socket();
    sock.setTimeout(2500);
    sock.on('connect', function() {
        console.log(item[0]+':'+item[1]+' is up.');
        sock.destroy();
    }).on('error', function(e) {
        console.log(item[0]+':'+item[1]+' is down: ' + e.message);
    }).on('timeout', function(e) {
        console.log(item[0]+':'+item[1]+' is down: timeout');
    }).connect(item[1], item[0]);
}); 
```

显然可以改进。例如，如果无法解析主机，它当前会中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-29T10:07:22.200

```
 class ServiceMonitor {
    constructor( services){
        this.services = services
    }
    async monitor  () {
        let status = {
            url  : {},
            alias: {}
        }
        for ( let service of this.services ) {
            let isAlive = await this.ping ( service )
            status.url  [ `${service.address}:${service.port}` ] = isAlive
            status.alias[ service.service                      ] = isAlive
        }
        return status
    }
    ping ( connection ) {
        return new Promise ( ( resolve, reject )=>{
            const tcpp = require('tcp-ping');
            tcpp.ping( connection,( err, data)=> {
                let error = data.results [0].err            
                if ( !error ) {
                    resolve ( true )
                }
                if ( error ) {
                    resolve ( false )
                }
            });
        })        
    }
}

( async function test () {
    let services = [
        {
            service : "redis_local",
            address : "localhost",
            port    : 6379,
            timeout : 1000,
            attempts: 1
        },
        {
            service : "redis_prod",
            address : "192.168.7.136",
            port    : 6379,
            timeout : 1000,
            attempts: 1
        },
        {
            service : "ussd_prod",
            address : "192.168.7.136",
            port    : 1989,
            timeout : 1000,
            attempts: 1
        },
        {
            service : "fraud_guard_prod",
            address : "192.168.7.136",
            port    : 1900,
            timeout : 1000,
            attempts: 1
        }
    ],
    status = await new ServiceMonitor ( services ).monitor ()
    console.log ( status )
}()) 
```

返回：

```
{ url:   { 'localhost:6379': true,     '192.168.7.136:6379': true,     '192.168.7.136:1989': true,     '192.168.7.136:1900': true },  alias:   { redis_local: true,     redis_prod: true,     ussd_prod: true,     fraud_guard_prod: true } } 
```

# php - WordPress 画廊最后一行

> ID：10723396
> 
> 赞同：0
> 
> 时间：2012-05-23T15:40:33.083
> 
> 标签：php, wordpress, wordpress-theming

这是html：

```
<div id="gallery-1" class="gallery galleryid-429 gallery-columns-5 gallery-size-thumbnail"> 
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
<br style="clear: both">
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
<dl class="gallery-item"></dl>
</div> 
```

所以我在每第五个项目之后都有 br style="clear: both" 。有人可以帮助如何在第五项中添加我的 CSS 类吗？

这是php wp函数：

```
$i = 0;
foreach ( $attachments as $id => $attachment ) {
    $link = isset($attr['link']) && 'file' == $attr['link'] ? wp_get_attachment_link($id, $size, false, false) : wp_get_attachment_link($id, $size, true, false);

    $output .= "<{$itemtag} class='gallery-item'>";
    $output .= "
        <{$icontag} class='gallery-icon'>
            $link
        </{$icontag}>";
    if ( $captiontag && trim($attachment->post_excerpt) ) {
        $output .= "
            <{$captiontag} class='wp-caption-text gallery-caption'>
            " . wptexturize($attachment->post_excerpt) . "
            </{$captiontag}>";
    }
    $output .= "</{$itemtag}>";
    if ( $columns > 0 && ++$i % $columns == 0 )
        $output .= '<br style="clear: both" />';
}

$output .= "
    </div>\n";

return $output; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:49:22.043

您可以使用以下 CSS 定位每五个元素：

```
.gallery-item:nth-child(5n+5) {
  /* css */
} 
```

# jquery - rails flash 通知不适用于远程 => true

> ID：10723398
> 
> 赞同：0
> 
> 时间：2012-05-23T15:40:40.713
> 
> 标签：jquery, ruby-on-rails, tabs

我在一个视图页面上有三个选项卡。其中一个选项卡是用于更新用户帐户的表单。由于此页面使用 jquery，因此每当我刷新页面时，它都会返回到第一个活动选项卡而不是当前选项卡。我通过添加`:remote=> true`到这行代码来解决这个问题`<%= semantic_form_for @user, :remote => true do |f| %>`。这会更新表单而不返回到第一个活动选项卡。

问题是我有一个没有显示的快速通知。如果我删除它，`:remote => true`那么它工作正常，但它让我回到主活动选项卡。

有什么建议么？提前致谢。

JS在这里切换标签：

```
<script type="text/javascript">
$(document).ready(function() {

$('.tabs a').click(function(){
    switch_tabs($(this));
});

switch_tabs($('.active'));

});

function switch_tabs(obj)
{
$('.tab-content').hide();
$('.tabs a').removeClass("active");
var id = obj.attr("rel");

$('#'+id).show();
obj.addClass("active");
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:47:23.150

那么你在这里有两个不同的问题：

*   您的 JS 代码确实打开了点击事件。当您的页面首次加载时，没有点击，因此不会更改选项卡。您需要以某种方式指示哪个选项卡处于活动状态。我通常在服务器端通过向`active`HTML 元素添加类然后使用 CSS 突出显示/选择它来完成此操作。

*   `remote=>true`将执行 ajax 调用，这将返回给你一些东西。通常返回 xml 或 json 而不是 HTML。我认为在您的情况下，您返回的 HTML 将包含 Flash 消息，但您的浏览器不会显示它，因为您的页面没有刷新。

# java - Java parse 获取 jquery 发送的参数

> ID：10723400
> 
> 赞同：2
> 
> 时间：2012-05-23T15:40:45.127
> 
> 标签：java, jquery, ajax, post, get

**编辑**也许这是更好的解释（对不起，我比英语更了解javascript......而且我不太了解javascript :-)

我需要通过我的servlet 在java bean 中映射一个用jquery $.ajax 发送的复杂javascript 对象。

这是一个使用 jQuery 完成并使用 Firebug 嗅探的真实示例。这是js代码：

```
$("#test").click(function(){
    $.ajax({
        url: "/server", 
        data: { "data1": [{key:1, val:2},{key:3, val:4}] }, 
        type: "post",               
        }
    });
}); 
```

正如你所看到的，我在 $.ajax 数据中发送了一个复杂的对象，而不是一个简单的地图。如果我检查如何使用 firebug 嗅探器发送 http 请求，我会得到这个 POST 参数：

```
Parameters application/x-www-form-urlencoded
data1[0][key]   1
data1[0][val]   2
data1[1][key]   3
data1[1][val]   4 
```

这就是 jquery 将复杂对象转换为简单映射的方式。我想在 java bean 中获取这个对象。谢谢。

**EDIT2** 这：[Java 将 JSONObject 转换为 URL 参数](https://stackoverflow.com/questions/4518323/java-convert-jsonobject-to-url-parameter)似乎与我的需求完全相反。但它没有答案...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:42:09.850

这是 JSON，您可以使用[Gson](http://code.google.com/p/google-gson/)库将其映射到 POJO。看[这个教程](http://www.mkyong.com/java/how-do-convert-java-object-to-from-json-format-gson-api/)

**读取 HttpServletRequest**

```
Gson gson = new Gson();
SomeClass someClass = gson.fromJson(
        new InputStreamReader(httpServletRequest.getInputStream()), SomeClass.class); 
```

**编辑**

您可能想查看[这个主题](https://stackoverflow.com/questions/2779251/convert-json-to-hashmap-using-gson-in-java)，它可以帮助您将 JSON 映射到 POJO（或您所说的 Java bean）。

**编辑 2**

尝试添加`processData`参数并将其设置为`false`. 这应该可以防止将给定的 JSON 转换为查询字符串。

```
$("#test").click(function(){
  $.ajax({
      url: "/server", 
      data: { "data1": [{key:1, val:2},{key:3, val:4}] }, 
      type: "post", 
      processData: false
  });
}); 
```

# c++ - 字符数组到十六进制字符串 C++

> ID：10723403
> 
> 赞同：32
> 
> 时间：2012-05-23T15:41:00.700
> 
> 标签：c++, hex, buffer, byte

我之前搜索`char*`过`hex`字符串，但我发现实现时在字符串末尾添加了一些不存在的垃圾`hex`。我从套接字接收数据包，我需要将它们转换`hex`为日志字符串（空终止缓冲区）。有人可以建议我一个好的实施`C++`吗？

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-03-20T09:44:41.737

假设数据是 char*。使用 std::hex 的工作示例：

```
for(int i=0; i<data_length; ++i)
    std::cout << std::hex << (int)data[i]; 
```

或者，如果您想将其全部保存在一个字符串中：

```
std::stringstream ss;
for(int i=0; i<data_length; ++i)
    ss << std::hex << (int)data[i];
std::string mystr = ss.str(); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-23T15:44:21.017

这里有一些东西：

```
char const hex_chars[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };

for( int i = data; i < data_length; ++i )
{
    char const byte = data[i];

    string += hex_chars[ ( byte & 0xF0 ) >> 4 ];
    string += hex_chars[ ( byte & 0x0F ) >> 0 ];
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-23T16:06:27.603

最简单的：

```
int main()
{
    const char* str = "hello";
    for (const char* p = str; *p; ++p)
    {
        printf("%02x", *p);
    }
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-09-10T14:48:14.830

我在这里找到了很好的例子[Display-char-as-Hexadecimal-String-in-C++](https://dev-notes.eu/2019/07/Display-char-as-Hexadecimal-String-in-C++/)：

```
 std::vector<char> randomBytes(n);
  file.read(&randomBytes[0], n);

  // Displaying bytes: method 1
  // --------------------------
  for (auto& el : randomBytes)
    std::cout << std::setfill('0') << std::setw(2) << std::hex << (0xff & (unsigned int)el);
  std::cout << '\n';

  // Displaying bytes: method 2
  // --------------------------
  for (auto& el : randomBytes)
    printf("%02hhx", el);
  std::cout << '\n';
  return 0; 
```

> 如上所示的方法1可能是更C++的方式：
> 
> 强制转换为无符号整数
> 用于`std::hex`将值表示为十六进制数字
> 使用`std::setw`和`std::setfill`from`<iomanip>`格式化
> 请注意，您需要屏蔽强制转换的 int`0xff`以显示最低有效字节：
> `(0xff & (unsigned int)el)`。
> 
> 否则，如果设置了最高位，则强制转换将导致三个最高有效字节设置为`ff`。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-06-19T20:16:21.717

上面的代码片段在字符串中提供了不正确的字节顺序，所以我对其进行了一些修复。

```
char const hex[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A',   'B','C','D','E','F'};

std::string byte_2_str(char* bytes, int size) {
  std::string str;
  for (int i = 0; i < size; ++i) {
    const char ch = bytes[i];
    str.append(&hex[(ch  & 0xF0) >> 4], 1);
    str.append(&hex[ch & 0xF], 1);
  }
  return str;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-03-08T22:19:23.460

使用提升：

```
#include <boost/algorithm/hex.hpp>

std::string s("tralalalala");
std::string result;
boost::algorithm::hex(s.begin(), s.end(), std::back_inserter(result)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-19T10:58:52.570

您可以尝试使用此代码将字节从数据包转换为以空字符结尾的字符串并存储到“字符串”变量以进行处理。

```
const int buffer_size = 2048;
// variable for storing buffer as printable HEX string
char data[buffer_size*2];
// receive message from socket
int ret = recvfrom(sock, buffer, sizeofbuffer, 0, reinterpret_cast<SOCKADDR *>(&from), &size);
// bytes converting cycle
for (int i=0,j=0; i<ret; i++,j+=2){ 
    char res[2]; 
    itoa((buffer[i] & 0xFF), res, 16);
        if (res[1] == 0) {
            data[j] = 0x30; data[j+1] = res[0];
        }else {
            data[j] = res[0]; data[j + 1] = res[1];
        }
}
// Null-Terminating the string with converted buffer
data[(ret * 2)] = 0; 
```

当我们发送带有十六进制字节 0x01020E0F 的消息时，变量“data”具有字符串“01020e0f”的 char 数组。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2012-05-23T15:57:33.137

你可以使用[std::hex](http://www.cplusplus.com/reference/iostream/manipulators/hex/)

例如。

```
std::cout << std::hex << packet; 
```

# php - mediatemple - 无法使用 codeigniter 发送电子邮件

> ID：10723404
> 
> 赞同：0
> 
> 时间：2012-05-23T15:41:01.383
> 
> 标签：php, email, codeigniter, smtp

我无法在 codeigniter 中使用 mediatemple 发送电子邮件。我检查了电子邮件密码和 smtp 主机，它们是正确的。

这是错误：

```
Severity: Notice

Message: fwrite() [function.fwrite]: send of 12 bytes failed with errno=10054 An existing connection was forcibly closed by the remote host.

Filename: libraries/Email.php

Line Number: 1846 
```

这是我的代码：我已将 sxxxxx.gridserver.com 替换为正确的 smtp。

```
function _sendEmail($from,$fromname,$to,$subject,$message){
            $config = array(
            'protocol' => 'smtp',
            'smtp_host' => 'sxxxxx.gridserver.com',
            'smtp_port' => 465,
            'smtp_user' => 'noreply@mywebsite.com',
            'smtp_pass' => 'mypass'
        );

        $this->load->library('email',$config);
        $this->email->set_newline("\r\n");

        $this->email->from($from,$fromname);
        $this->email->to($to);
        $this->email->subject($subject);
        $this->email->message($message);
        $this->email->send();
    } 
```

任何帮助，将不胜感激。

**编辑：我已经使用端口 25 解决了这个问题。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-02-03T11:25:42.627

```
'smtp_crypto'   => 'ssl', 
```

将此添加到您的配置中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:13:59.527

您需要初始化配置，请参阅[电子邮件类的 codeigniter 文档](http://codeigniter.com/user_guide/libraries/email.html)。

这是我的例子，效果很好......

```
 function send_email($attributes) {

        $this->load->library('email');

        $this->email->set_newline("\r\n");

        $config['protocol'] = 'smtp';
        $config['smtp_host'] = 'host';
        $config['smtp_port'] = '465';
        $config['smtp_user'] = 'user@smtp.com';
        $config['smtp_from_name'] = 'FROM NAME';
        $config['smtp_pass'] = 'XXX';
        $config['wordwrap'] = TRUE;
        $config['newline'] = "\r\n";
        $config['mailtype'] = 'html';                       

        $this->email->initialize($config);

        $this->email->from($config['smtp_user'], $config['smtp_from_name']);
        $this->email->to($attributes['to']);
        $this->email->cc($attributes['cc']);
        $this->email->bcc($attributes['cc']);
        $this->email->subject($attributes['subject']);

        $this->email->message($attributes['message']);

        if($this->email->send()) {
            return true;        
        } else {
            return false;
        }       

} 
```

# c - 这个 GCC 内联汇编中的参数列表有什么问题？

> ID：10723408
> 
> 赞同：1
> 
> 时间：2012-05-23T15:41:12.967
> 
> 标签：c, gcc, assembly, inline-assembly

我正在尝试使用 GCC 的扩展 asm 语法嵌入以下汇编指令（类似于 ARM 的架构）：

```
__asm__("lsr  %[xj], %[xj], %[xn]" : 
            [xj] "=r" (j) : 
            [xi] "[xj]" (j) , [xn] "[xn]" (n)); // j = j >> n 
```

`i`, `j`, 和`n`被声明为整数`int i, j, n;`

（请注意，`j`它同时用作*in*和*out*参数）

编译器生成错误：

```
../src/fft2dlib.c:55:5: error: matching constraint references invalid operand number
../src/fft2dlib.c:53:3: error: matching constraint references invalid operand number 
```

其中第 53 行和第 55 行是上述 asm 代码的第一行和第三行。

当我`n`在汇编指令中用显式常量替换输入参数时，它编译得很好：

```
__asm__("lsr  %[xj], %[xj], 27" : 
            [xj] "=r" (j) : 
            [xi] "[xj]" (j)); // j = j >> 27 
```

我正在遵循[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#Extended-Asm)中的示例，但我无法找出问题所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:58:07.673

中的约束`"[xn]"`实际上`[xn] "[xn]" (n)`没有任何意义。使用参数名称或编号作为约束意味着“将此操作数放在与命名操作数相同的位置”。所以在这种情况下，你告诉 GCC 放在`[xn]`与 相同的位置`[xn]`，这是没有意义的，实际上并没有提供有关操作数类型的信息。

您需要使用另一种约束类型，例如`"r"`寄存器操作数，具体取决于汇编指令允许的内容。

# jqgrid - 用于 jqgrid 的 ajaxfileupload.js 在哪里？

> ID：10723409
> 
> 赞同：1
> 
> 时间：2012-05-23T15:41:13.593
> 
> 标签：jqgrid

我正在寻找这个问题中使用的 ajaxfileupload.js 文件：
[File upload with jqgrid in PHP](https://stackoverflow.com/questions/2931468/file-upload-with-jqgrid-in-php?answertab=active#tab-top)
The referenced website (www.phpletter.com) 似乎不再存在。
谁能给我一个参考？
提前谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:51:29.833

@fbfcn 提供了您正在寻找的项目的直接链接。

但是，[这里](https://gist.github.com/2776054)是 JS 文件的副本，以防您在直接访问该站点时遇到问题。

# javascript - 仅在禁用 Flash 时显示颜色框关闭按钮

> ID：10723411
> 
> 赞同：1
> 
> 时间：2012-05-23T15:41:18.577
> 
> 标签：javascript, jquery, html, colorbox

我希望仅在窗口上禁用（未安装/卸载）Flash 时显示 js.colorbox 关闭按钮。启用 Flash 时，我不需要显示关闭按钮，因为 swf 对象上有一个关闭按钮。

任何帮助将不胜感激，因为我被卡住了。

干杯楼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:42:02.050

您可以创建一个包含您的 Flash 文件的 HTML 文件。要嵌入它，请使用 SWFObject。

SWFObject 有一个回调函数，可以判断 Flash 对象是否已成功嵌入。

所以您的代码可能与此类似：

```
swfobject.embedSWF(
                    "fileName.swf", 
                    replaceElemIdStr, 
                    widthStr, 
                    heightStr, 
                    swfVersionStr, 
                    xiSwfUrlStr, 
                    flashvarsObj, 
                    parObj, 
                    attObj, 
                    callbackFn);

function callbackFn(e)
{
    if (e.success)
    {
        //flash is there
        //do not show close button
        //use jQuery to alter css
    }
    else
    {
        //ooops, no flash file
        //do show close button
    }
} 
```

# python - 通过 python 的 matplotlib.pyplot.contourf 分散 x,y,z

> ID：10723413
> 
> 赞同：2
> 
> 时间：2012-05-23T15:41:20.183
> 
> 标签：python, matplotlib

大多数 pyplot 示例都使用线性数据，但如果数据分散怎么办？
`x = 3,7,9
y = 1,4,5
z = 20,3,7`

更好的轮廓网格网格
`xi = np.linspace(min(x)-1, max(x)+1, 9)
yi = np.linspace(min(y)-1, max(y)+1, 9)
X, Y = np.meshgrid(xi, yi)`

现在“z”数据必须被插值到网格网格上。
`numpy.interp`在这里没有什么帮助，而*线性*和*nn*插值
`zi = matplotlib.mlab.griddata(x,y,z,xi,yi,interp="linear")` 返回相当奇怪的结果

`scipy.interpolate.griddata` *下面第二个答案的立方*需要其他东西来返回数据而不是 nils

预计自定义级别数据看起来[像这样](http://www.emhi.ee/ilma_andmed/input/tuleoht/tuleohukaart.gif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:12:59.117

这就是发生的事情： ![在此处输入图像描述](../Images/47f6a44e824f92e5dd0553cbc002eaf3.png)

虽然`contour`需要网格数据，但我们可以将分散数据转换为网格，然后使用`masked arrays`屏蔽掉空白区域。我在下面的代码中对此进行了模拟，方法是创建一个随机数组，然后使用它来屏蔽测试数据集（显示在底部）。大部分代码取自[这个 matplotlib 演示页面](http://matplotlib.sourceforge.net/api/axes_api.html?highlight=contour#matplotlib.axes.Axes.contour)。

```
import matplotlib
import numpy as np
import matplotlib.mlab as mlab
import matplotlib.pyplot as plt

matplotlib.rcParams['xtick.direction'] = 'out'
matplotlib.rcParams['ytick.direction'] = 'out'

delta = 0.025
x = np.arange(-3.0, 3.0, delta)
y = np.arange(-2.0, 2.0, delta)
X, Y = np.meshgrid(x, y)
Z1 = mlab.bivariate_normal(X, Y, 1.0, 1.0, 0.0, 0.0)
Z2 = mlab.bivariate_normal(X, Y, 1.5, 0.5, 1, 1)
# difference of Gaussians
Z = 10.0 * (Z2 - Z1)

from numpy.random import *
import numpy.ma as ma

J = random_sample(X.shape)
mask = J > 0.7
X = ma.masked_array(X, mask=mask)
Y = ma.masked_array(Y, mask=mask)
Z = ma.masked_array(Z, mask=mask)

plt.figure()
CS = plt.contour(X, Y, Z, 20)
plt.clabel(CS, inline=1, fontsize=10)
plt.title('Simplest default with labels')
plt.savefig('cat.png')
plt.show() 
```

![在此处输入图像描述](../Images/c5e9368a05b059597790a34bb384eb8c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:07:27.450

`countourf`仅适用于数据网格。如果您的数据是分散的，那么您需要创建一个与您的数据匹配的插值网格，如下所示：（注意您需要 scipy 来执行插值）

```
import numpy as np
from scipy.interpolate import griddata
import matplotlib.pyplot as plt
import numpy.ma as ma
from numpy.random import uniform, seed

# your data
x = [3,7,9]
y = [1,4,5]
z = [20,3,7]

# define grid.
xi = np.linspace(0,10,300)
yi = np.linspace(0,6,300)
# grid the data.
zi = griddata((x, y), z, (xi[None,:], yi[:,None]), method='cubic')
# contour the gridded data, plotting dots at the randomly spaced data points.
CS = plt.contour(xi,yi,zi,15,linewidths=0.5,colors='k')
CS = plt.contourf(xi,yi,zi,15,cmap=plt.cm.jet)
plt.colorbar() # draw colorbar
# plot data points.
plt.scatter(x,y,marker='o',c='b',s=5)
plt.xlim(min(x),max(x))
plt.ylim(min(y),max(y))
plt.title('griddata test (%d points)' % len(x))
plt.show() 
```

有关该代码的来源，请参见[此处](http://www.scipy.org/Cookbook/Matplotlib/Gridding_irregularly_spaced_data)。

# c# - 需要帮助理解 WPF 中的事件冒泡代码

> ID：10723419
> 
> 赞同：0
> 
> 时间：2012-05-23T15:41:34.193
> 
> 标签：c#, wpf, events, event-bubbling

由于事件冒泡，以下代码应该在其中一个按钮单击时将表单中存在的所有按钮变为绿色，但在我的 Visual Studio 2008 机器上，它只将单击的按钮变为绿色，请您帮忙帮助找出问题？

XAML 代码（window1.xaml）：

```
<Window x:Class="EventRouting.Window1" Title="Event Routing" Height="300" Width="300"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Border Margin="15" BorderBrush="Blue" BorderThickness="5" Padding="15"
            CornerRadius="12" x:Name="myBorder" Background="Transparent">
<StackPanel x:Name="myPanel" Background="Transparent">
  <Ellipse x:Name="myEllipse" Margin="3" Fill="Green" Height="40" />
  <Rectangle x:Name="myRectangle" Margin="3" Fill="Cyan" Height="40" RadiusX="10" RadiusY="10" />
</StackPanel> 
```

CS 代码 (window1.xaml.cs)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Diagnostics;

namespace EventRouting
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            this.MouseEnter += MouseEnterHandler;
        myBorder.MouseEnter += MouseEnterHandler;
        myPanel.MouseEnter += MouseEnterHandler;
        myEllipse.MouseEnter += MouseEnterHandler;
        myRectangle.MouseEnter += MouseEnterHandler;

        this.MouseDown += MouseDownHandler;
        myBorder.MouseDown += MouseDownHandler;
        myPanel.MouseDown += MouseDownHandler;
        myEllipse.MouseDown += MouseDownHandler;
        myRectangle.MouseDown += MouseDownHandler;

        for (int i = 1; i <= 5; ++i)
        {
            Button btn = new Button();
            btn.Content = "Button " + i;
            myPanel.Children.Add(btn);

            //btn.Click += new RoutedEventHandler(btn_Click);
        }

        myPanel.AddHandler(Button.ClickEvent, new RoutedEventHandler(btn_Click));
    }

    void btn_Click(object sender, RoutedEventArgs e)
    {
        Button btn = (Button) e.Source;
        btn.Background = Brushes.Green;
    }

    void MouseEnterHandler(object sender, MouseEventArgs e)
    {
        Debug.WriteLine("MouseEnter: " + sender);
    }
    void MouseDownHandler(object sender, MouseButtonEventArgs e)
    {
        Debug.WriteLine("MouseDown: " + sender);
        e.Handled = true;
    }

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:19:05.310

路由事件在可视化树中冒泡，直到它们被处理。使用您的 XAML，尝试此代码。

```
 public MainWindow()
    {
        InitializeComponent();
        myEllipse.AddHandler(UIElement.MouseDownEvent, new RoutedEventHandler(OnMouseDown));
        myPanel.AddHandler(UIElement.MouseDownEvent, new RoutedEventHandler(OnMouseDown));
        myBorder.AddHandler(UIElement.MouseDownEvent, new RoutedEventHandler(OnMouseDown));
    }

    void OnMouseDown(object sender, RoutedEventArgs e)
    {
        UIElement uiElement = sender as UIElement;
        Debug.WriteLine(uiElement.GetType().ToString());
        e.Handled = true;
    } 
```

如果您注释掉 e.Handled = true 行，该事件将冒泡到父元素。这是一个很好的[链接](http://msdn.microsoft.com/en-us/magazine/cc785480.aspx#id0190038)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:20:14.220

如果我了解您想要的是从根（面板）到每个孩子（按钮）的隧道事件。路由隧道事件不会这样做，它们只会从根元素遍历到源元素，而不是兄弟元素。请参阅[WPF 中的路由事件概述，](http://joshsmithonwpf.wordpress.com/2007/06/22/overview-of-routed-events-in-wpf/)其中有一个很好的说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:07:14.233

因为事件处理程序 btn_Click(object sender, MouseEventArgs e) 正在发送您单击的按钮，所以您不能单独使用 sender 对象将文本更改为绿色。

你应该做一些事情，比如`foreach (Button btn in myPanel.Children)`循环遍历所有按钮并更改循环中的颜色。

# android - 在 Google 地图上查找我的位置

> ID：10723420
> 
> 赞同：0
> 
> 时间：2012-05-23T15:41:37.833
> 
> 标签：android, google-maps, location

我试图让应用程序在谷歌地图上显示我的位置，但在我的手机上打开应用程序时它总是打开同一个地方，这是我在代码中添加的值作为测试的初始值编译器。我怎样才能让它显示我的位置（让它根据我的位置改变纬度和经度）？

这是代码：

公共类 AndroidGoogleMapsActivity 扩展 MapActivity {

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // Displaying Zooming controls
    MapView mapView = (MapView) findViewById(R.id.mapView);
    mapView.setBuiltInZoomControls(true);

    /**
     * Changing Map Type
     * */
     mapView.setSatellite(true); // Satellite View
    // mapView.setStreetView(true); // Street View
     mapView.setTraffic(true); // Traffic view

    /**
     * showing location by Latitude and Longitude
     * */        
    MapController mc = mapView.getController();
    double lat = Double.parseDouble("31.894178");
    double lon = Double.parseDouble("35.872694");
    GeoPoint geoPoint = new GeoPoint((int)(lat * 1E6), (int)(lon * 1E6));
    mc.animateTo(geoPoint);
    mc.setZoom(15);
    mapView.invalidate(); 

    /**
     * Placing Marker
     * */
    List<Overlay> mapOverlays = mapView.getOverlays();
    Drawable drawable = this.getResources().getDrawable(R.drawable.mark_red);
    AddItemizedOverlay itemizedOverlay = 
         new AddItemizedOverlay(drawable, this);

    OverlayItem overlayitem = new OverlayItem(geoPoint, "Hello", "Sample Overlay item");

    itemizedOverlay.addOverlay(overlayitem);
    mapOverlays.add(itemizedOverlay);

}

@Override
protected boolean isRouteDisplayed() {
    return false;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:45:48.667

你永远不会调用实际的 GPS，这就是它恢复到你编程的那些的原因。这在其他地方有很好的记录，但这里是一个很好的起点：[http ://about-android.blogspot.com/2010 /04/find-current-location-in-android-gps.html](http://about-android.blogspot.com/2010/04/find-current-location-in-android-gps.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T18:41:08.297

见[位置检测](https://stackoverflow.com/questions/10109644/location-detection)；这是afaik的简单方法，它对我有用。干杯!

# objective-c - 将视图作为子视图添加到我的应用程序窗口，但未显示

> ID：10723428
> 
> 赞同：0
> 
> 时间：2012-05-23T15:41:53.123
> 
> 标签：objective-c, cocoa-touch, uiview, uiwindow

我正在将视图控制器的视图添加到我的窗口中，`application:didFinishLaunchingWithOptions:`但该视图不可见。我不确定出了什么问题。

这是我的应用程序委托代码：

```
@class ToolBar;
@class MainViewController;

@interface AppDelegate : UIResponder <UIApplicationDelegate>

{
    UIWindow *Window;
    //UIToolbar *toolbar; 
}

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) MainViewController *mainViewController;
@property (strong, nonatomic) ToolBar *toolbar;

@end 
```

* * *

```
#import "AppDelegate.h"
#import "MainViewController.h"
#import "ToolBar.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize mainViewController = _mainViewController;
@synthesize toolbar =toolbar;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]autorelease];
    self.mainViewController = [[[MainViewController alloc]init]autorelease];
    [self.window addSubview:self.mainViewController.view];
    //[self.window makeKeyAndVisible];
    self.toolbar = [[[ToolBar alloc]init]autorelease];
    [self.window addSubview:toolbar.view];    
    [self.window makeKeyAndVisible];
    return YES;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:25:01.223

好吧，首先您没有为工具栏设置框架。

但是为什么要在应用程序的主窗口中添加工具栏？我希望它是您的 mainViewController 视图的子视图。

# ios - 如何将 JCMSegmentPageController 与情节提要一起使用？

> ID：10723434
> 
> 赞同：1
> 
> 时间：2012-05-23T15:42:14.720
> 
> 标签：ios, uitabbarcontroller, storyboard, relationship

我最近发现[了 JCMSegmentPageController](https://github.com/jcmendez/JCMSegmentPageController)，它提供了 UITabBarController 的功能，使用顶部的分段控件而不是底部的选项卡栏。

我打算在即将到来的项目中使用它，但发现无法将它连接到故事板中。

我已经考虑过解决问题的不同可能性，因为目前无法创建关系序列：

*   使用 UITabBarController 子类的包装对象来“窃取”视图控制器关系
*   使用 IBOutletCollection 和占位符对象
*   使用自定义 segue，它不会在控制器之间切换，而是将视图转换为适合“父级”并将其提供给嵌入

但是，所有这些对我来说似乎或多或少有点骇人听闻，我想要求一个更优雅的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:06:50.833

帕特里克

我将它与情节提要一起使用的方式如下所示：

![在情节提要中使用 JCMSegmentPageController](../Images/029f51de7be8d60c9abf6dba4a060ec6.png)

我创建了包含的视图控制器，并且不设置 segue 关系。在下图中，最左边的 VC 是一个 JCMSegmentPageController 子类。右边的另外两个是包含的 VC。

然后我为每个包含的 VC 分配一个唯一的 ID，在本例中为 EvstEveryJourneyTableView 和 EvstFollowingJourneyTableView。

![设置 ViewController 的标识符](../Images/6b2ee5f1411c7837f0289c1be10b024a.png)

最后我用instantiateViewControllerWithIdentifier来实例化它们，如下图：

```
- (void) viewDidLoad {
  EvstEverybodyJourneyTableViewController *jvc = [self.storyboard instantiateViewControllerWithIdentifier:@"EvstEveryJourneyTableView"];
    EvstEverybodyJourneyTableViewController *dvc = [self.storyboard instantiateViewControllerWithIdentifier:@"EvstFollowingJourneyTableView"];
  self.delegate = self;
    self.viewControllers = [NSArray arrayWithObjects:jvc, dvc, nil];
  [super viewDidLoad];
} 
```

# qt - 从哪里获得 MongoDB Qt 驱动程序

> ID：10723436
> 
> 赞同：1
> 
> 时间：2012-05-23T15:42:20.867
> 
> 标签：qt, mongodb

我目前正在寻找一种在 Qt 中连接到 MongoDB 的方法。到目前为止，尽管 MongoDB 网站上有一个 c++ 库，但我还没有遇到我可以用来连接到 MongoDB 的驱动程序。有没有人能够将 Qt 与 MongoDB 一起使用。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:45:04.583

C++ 驱动程序是要使用的驱动程序。

# c# - Linq-to-entities，在一次查询中获取结果 + 行数

> ID：10723439
> 
> 赞同：5
> 
> 时间：2012-05-23T15:42:29.817
> 
> 标签：c#, sql, linq-to-entities

我已经看到有关此问题的多个问题，但是它们已经 2 年（或更长时间）了，所以我想知道这是否有任何变化。

基本思想是填充网格视图并创建自定义分页。所以，我也需要结果和行数。

在 SQL 中，这将类似于：

```
SELECT COUNT(id), Id, Name... FROM ... WHERE ... 
```

在一个很好的简单查询中获取所有内容。但是，我想保持一致并使用 Linq2Entities。

到目前为止，我正在使用带有两个查询的方法（针对 sql server），因为它可以正常工作。我想优化它并改用单个查询。

我试过这个：

```
var query = from o in _db.Products
                        select o;

var prods = from o in query
            select new
            {
                 Count = query.Count(),
                 Products = query
            }; 
```

这会产生一个非常讨厌且冗长的查询，其中包含真正不必要的交叉连接和其他我并不真正需要或不想要的东西。

有没有办法在一个简单的查询中获取分页结果+所有实体的计数？这里推荐的方法是什么？

**更新：**

刚刚尝试了 FutureQueries 并且要么我做错了什么，要么它实际上执行了两个查询。这显示了我的 sql 探查器：

```
-- Query #1

SELECT 
[GroupBy1].[A1] AS [C1]
FROM ( SELECT 
    COUNT(1) AS [A1]
    FROM [dbo].[Products] AS [Extent1]
    WHERE 1 = [Extent1].[CategoryID]
)  AS [GroupBy1]; 
```

下一行：

```
-- Query #1

SELECT 
[Extent1].[ID] AS [ID], 
[Extent1].[Name] AS [Name], 
[Extent1].[Price] AS [Price], 
[Extent1].[CategoryID] AS [CategoryID]
FROM [dbo].[Products] AS [Extent1]
WHERE 1 = [Extent1].[CategoryID]; 
```

C# 代码：

```
internal static List<Product> GetProducts(out int _count)
{
    DatabaseEntities _db = new DatabaseEntities();

    var query = from o in _db.Products
                where o.CategoryID == 1
                select o;

    var count = query.FutureCount();

    _count = count.Value;
    return query.Future().ToList();
} 
```

我错过了什么？根据我的分析器，它的作用完全相同，只是在查询中添加了行（--查询 #1）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:17:16.617

[在EntityFramework.Extended](https://github.com/loresoft/EntityFramework.Extended/wiki/Future-Queries)中查看 Future Queries 以执行此操作。该链接页面上的第二个示例`FutureCount()`用于执行您想要的操作。改编于此：

```
var q = db.Products.Where(p => ...);
var qCount = q.FutureCount();
var qPage  = q.Skip((pageNumber-1)*pageSize).Take(pageSize).Future();

int total = qCount.Value;     // Both queries are sent to the DB here.
var tasks = qPage.ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-11T11:56:32.010

不再支持此“EntityFramework.Extended”库，请改用此库： [entityframework-plus](https://entityframework-plus.net/download)并转到此处： [https](https://entityframework-plus.net/query-future) ://entityframework-plus.net/query-future以查看如何在同一查询中获取计数和记录。

# cookies - 将 oauth 令牌存储在 cookie 中是不安全的吗？

> ID：10723440
> 
> 赞同：2
> 
> 时间：2012-05-23T15:42:29.963
> 
> 标签：cookies, oauth

我正在构建一个不依赖于登录系统（无数据库）的应用程序，它将用户的数据保存在 dropbox/google 驱动器和其他设备上

因此，当用户打开应用程序时，他使用云服务“登录”。

由于我不打算使用任何数据库，我想知道将用户 oauth 令牌（不是应用程序令牌）存储在 cookie 中是否安全。

如果有人可以访问 cookie，他可以访问我的应用程序上的用户数据，它还需要应用程序令牌吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:51:15.427

这取决于使用的 OAuth 版本和使用的 OAuth 流程。通常，只有在可以保护 OAuth 访问令牌的情况下才能存储 OAuth 访问令牌，例如存储在 iPhone 上的密钥链中，只有授予访问权限的应用程序/用户才能获取它。同样适用`refresh token`于 OAuth2

# mysql - 单个数据库的最大表数

> ID：10723442
> 
> 赞同：2
> 
> 时间：2012-05-23T15:42:41.297
> 
> 标签：mysql

> **可能重复：**
> [MySQL 中的最大表数](https://stackoverflow.com/questions/2137516/maximum-number-of-tables-in-mysql)

单个数据库应包含推荐数量的表。此外，在您的应用程序中打开多个连接是否有任何缺点。

我目前正在开发的应用程序可以访问很多表，或者有可能访问很多表。我想将表拆分到不同的数据库中，因为我没有这方面的经验，我希望有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T17:03:55.510

在所有可能的情况下，最好在需要时处理将表拆分为单独数据库的必要性。

你说很多表有多少？100、200、1000 - 也许最后一个可能需要单独的数据库，但前提是它具有明确的优势。

我的建议是你看看为什么你需要这么多表，首先，你可以用更少的表和更多的行来做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:48:16.247

如果您使用的是 MyISAM，则表的最大数量受操作系统/文件系统的限制。这是操作系统在目录中允许的最大文件数，因为这些表在文件系统上存储为单独的文件。

对于 InnoDB，限制似乎是[40 亿](http://lists.mysql.com/mysql/118623)。

拥有多个打开的连接有利有弊。你想做什么？要记住的一件事是 MySQL 服务器将接受的连接数是有限制的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T17:40:40.930

单个连接中的所有查询都被序列化。这通常使编程更简单，特别是如果一个命令需要完成前一个命令。如果您添加多个连接，您最终可能会在相同情况下出现竞争条件。

由于 MySQL 不支持嵌套事务，因此有时需要创建另一个连接才能完成事务中的事务。

# java - @Category 注释中的多个类型

> ID：10723443
> 
> 赞同：1
> 
> 时间：2012-05-23T15:42:48.683
> 
> 标签：java, gwt, annotations, autobean

GWT [AutoBean 页面](http://code.google.com/p/google-web-toolkit/wiki/AutoBean#Categories)说：

> @Category 注释可以指定多个类别类型。

以下语法给出**了标记 ",", / 预期的语法错误**：

```
@Category(FooCategory.class, BarCategory.class)
public interface FooBarFactory extends AutoBeanFactory { 
    ...
} 
```

指定多个类别类的语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:08:52.143

`{`用and包裹参数`}`

```
@Category({FooCategory.class, BarCategory.class})
public interface FooBarFactory extends AutoBeanFactory { 
    ...
} 
```

# pdf - 获取 PDF 中图像的裁剪和旋转信息

> ID：10723445
> 
> 赞同：0
> 
> 时间：2012-05-23T15:42:51.297
> 
> 标签：pdf, rotation, itextsharp, itext, crop

我有一个带有图像页面的 PDF。我正在使用命令行工具来提取此图像。PDF 中的页面仅显示图像的一部分，因为提取的图像作为更多“内容”并且它们略微旋转。我认为发生这种情况是因为在构建 PDF 时对图像应用了某种裁剪和/或旋转。

无论如何，使用 iText 来计算应用于图像的偏移和旋转？这将允许我以相同的方式裁剪提取的图像，并最终得到类似于 PDF 页面上可见的内容。

# c++ - 简单的嵌套循环问题。* 形状 *

> ID：10723447
> 
> 赞同：0
> 
> 时间：2012-05-23T15:43:00.553
> 
> 标签：c++, nested-loops, shapes

我现在脑震荡，所以我想问一个非常简单的问题。

目前，我正在尝试打印出这样的开始

当输入为 7 时，输出为

```
* 
** 
* 
** 
* 
** 
* 
```

这里我的代码是，它打印 14 次而不是 7 次，或者当我放`N/2`它时不打印奇数。

```
#include <iostream>
using namespace std;

int main () {

    int N;
    cout << " Please enter N " ;
    cin >> N;

    for (int i = 0; i < N ; i++) {

        cout << "*" << endl;

        for (int j = 0; j < 2; j++) {

            cout << "*" ;
        }
        cout << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:46:38.430

对于每个`N`，您都打印两行，单行`*`，另一行打印两行`*`。相反，只需根据行是奇数还是偶数打印带有一颗*或两颗星的单行。*

```
#include <iostream>

int main ()
{
  unsigned int N;
  cout << " Please enter N " ;
  cin >> N;

  for(unsigned int i = 0; i < N; ++i)
  {
    if(i%2 == 0)
    {
      std::cout << "*" << std::endl;
    }
    else
    {
      std::cout << "**" << std::endl;
    }
  }
} 
```

（未经测试的代码）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:49:16.543

你就不能这样：

```
for (int i = 0; i < N ; i++) {

    if (i%2 == 0)
    {
        cout << "**" << endl;
    }
    else
    {
        cout << "*" << endl;
    }
} 
```

在您的情况下，对于您的 N 次迭代中的每一次，您 print *，跳转到新行， print **，然后跳转到新的迭代。所以当 N 为 7 时有 14 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T15:47:29.493

这是因为每次第一个`for`循环运行时，第二个循环也会运行。您不能同时打印`*`并`**`期望它打印`N`时间（它总是会打印`2 * N`时间）。您需要打印`*`或`**`，但不能同时打印两者。简单的例子：

```
bool alternate = false;
for (int i = 0; i < N ; i++) {

    if (alternate) {
        cout << "*" << endl;
    } else {
        cout << "**" << endl;
    }

    alternate = !alternate;
} 
```

您可以删除`alternate`变量并检查`i`是偶数还是奇数（使用类似的东西`i & 1`），但我使用`alternate`变量来帮助使其更清晰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:48:47.247

对于外部循环的每次完整迭代，都会打印以下内容：

```
*
** 
```

如果您运行该循环 7 次，那么您将获得 14 行。试试这个，不需要内循环：

```
for (int i = 0; i < N ; i++) {          
    cout << "*" << endl;          
    cout << "**" << endl;     
} 
```

# cocoa - 如何捕捉 NSComboBox 中的 NSTextView 何时获得第一响应者状态

> ID：10723448
> 
> 赞同：1
> 
> 时间：2012-05-23T15:43:00.677
> 
> 标签：cocoa, nstextview, first-responder, nscombobox

当 NSComboBox 失去第一响应者状态并因此获得“resignFirstResponder”时，我尝试进行一些处理，但是我的处理应该只在组合框真正失去第一响应者状态时发生，而不是当内部 NSTextView 用于实现组合框的文本时本身获得第一响应者状态。

是否有官方方法可以检测到第一响应者状态从 NSComboBox 转到其内部 NSTextView？我可以获得指向该 NSTextView 的指针吗？也许设置它的代表？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T11:58:26.420

实际上，没有“内部 NSTextView”，每个 NSWindow 都有一个这样的 NSTextView，它可以随意重新分配给需要它的编辑控件（文本、组合框），这就是所谓的“字段编辑器”。有可能通过`windowWillReturnFieldEditor`在 NSWindow 委托中覆盖它。

实际的答案是我们可以`becomeFirstResponder`在组合上检测到然后`textDidEndEditing`。

参考：Apple 开发人员文档中“文本编辑编程指南”中的“使用字段编辑器”。

# c# - 必应地图新地图方案

> ID：10723449
> 
> 赞同：0
> 
> 时间：2012-05-23T15:43:02.377
> 
> 标签：c#, windows-phone-7

如何在我的 Windows Phone 应用程序中使用 Bing 地图的新地图方案

正如你在这里看到的：http: [//pocketnow.com/phones/bing-maps-on-windows-phone-7-is-using-new-map-scheme](http://pocketnow.com/phones/bing-maps-on-windows-phone-7-is-using-new-map-scheme)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:53:00.730

您将需要适当的 MapTileSource，但我不认为它是公开的。

# clojure - Clojure 中的一级序列展平功能是什么？

> ID：10723451
> 
> 赞同：40
> 
> 时间：2012-05-23T15:43:08.107
> 
> 标签：clojure, functional-programming

Clojure 中的一级序列展平功能是什么？我现在正在使用`apply concat`，但我想知道在标准库或 clojure-contrib 中是否有内置函数。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-24T09:46:50.953

我的一般首选是`apply concat`. 此外，不要忽视`(for [subcoll coll, item subcoll] item)`- 根据更广泛的上下文，这可能会导致更清晰的代码。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-24T02:54:13.897

没有标准功能。`apply concat`在很多情况下是一个很好的解决方案。或者您可以等效地使用`mapcat seq`.

问题`apply concat`在于，当集合/序列以外的任何其他内容位于第一级时，它会失败：

```
(apply concat [1 [2 3] [4 [5]]])
=> IllegalArgumentException Don't know how to create ISeq from: java.lang.Long... 
```

因此，您可能想要执行以下操作：

```
(defn flatten-one-level [coll]  
  (mapcat  #(if (sequential? %) % [%]) coll))

(flatten-one-level [1 [2 3] [4 [5]]])
=> (1 2 3 4 [5]) 
```

作为更一般的观点，缺少内置函数通常不应该阻止您定义自己的:-)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-23T15:48:00.973

我`apply concat`也使用 - 我认为核心中没有其他任何东西。

`flatten`是多个级别（并且通过树遍历定义，而不是根据重复的单级扩展来定义）

另请参阅[Clojure：半展平嵌套序列](https://stackoverflow.com/questions/5232350/clojure-semi-flattening-a-nested-sequence)，其中包含`flatten-1`来自[clojure mvc](https://github.com/michelvollebregt/clojuremvc/blob/master/src/org/clojuremvc/list_util.clj#L4)的嵌套序列（并且比我预期的要复杂得多）。

*更新*以澄清懒惰：

```
user=> (take 3 (apply concat (for [i (range 1e6)] (do (print i) [i]))))
012345678910111213141516171819202122232425262728293031(0 1 2) 
```

您可以看到它对参数进行了 32 次评估——这是为了提高效率而分块，否则是懒惰的（它不会评估整个列表）。[有关分块的讨论，请参见http://isti.bitbucket.org/2012/04/01/pipes-clojure-choco-1.html](http://isti.bitbucket.org/2012/04/01/pipes-clojure-choco-1.html)末尾的评论

# javascript - JQuery：用另一组元素替换一组元素的优雅方式？

> ID：10723452
> 
> 赞同：7
> 
> 时间：2012-05-23T15:43:16.033
> 
> 标签：javascript, jquery, html

我有一堆像

```
<div>
    <div class="stuff"/>
    <div class="stuff"/>
    <div class="stuff"/>
</div> 
```

我想用一套新的东西来代替它

```
<div>
    <div class="stuff"/>
    <p class="stuff"/>
    <ul class="stuff"/>
    <a class="stuff"/>
</div> 
```

这将通过 Ajax 获取。我的问题是：最好的方法是什么？

`$.replaceWith`并没有完全按照我的意愿行事，因为我最终得到了多个新的`stuff`.

我可以保证所有的`stuff`都将在一个连续的块中，所以大概我可以在 old 的最后一个元素（或第一个元素之前）之后放置一些占位符`stuff`，删除 old `stuff`，并用 new 替换占位符`stuff`。

然而，这似乎相当迂回和不雅。有什么聪明的方法可以一次性删除所有旧的`stuff`并放入一个新的副本`stuff`吗？

编辑：我也想在不使用任何容器 div 的情况下执行此操作。在上述情况下，使用容器 div 可以工作，但在某些情况下会失败，例如当`stuff`a 位于内部时`<table>`：

```
<table>
    <head/>
    <body>
        <tr/>
        <tr class="stuff"/>
        <tr class="stuff"/>
        <tr class="stuff"/>
        <tr/>
    </body>
</table> 
```

如果我想`stuff`用另一组行替换标记的行，可能更多，可能更少，我无法在不破坏 HTML 的情况下很好地将它们放入容器中，因为`<body>`只能包含`<tr>`s (IIRC)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-23T15:48:10.190

```
$('#outerdiv').empty().append(newContent); 
```

与 不同的是`.html()`，无论`newContent`是 HTML 字符串还是现有的 DOM 结构，这都会起作用。

如果有多个元素要替换，但您需要保留它们的兄弟姐妹，您可以这样做：

```
$('.stuff').first().before(newContent).end().remove(); 
```

即取第一个`.stuff`元素，在它之前添加新内容，然后删除所有`.stuff`元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T15:45:57.620

是的：`$('#tagetDiv').html(newContent)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T15:48:30.863

一种方法是使用[`wrapAll`](http://api.jquery.com/wrapAll/)：

```
$('.stuff').wrapAll('<div/>').parent().replaceWith('<div class="stuff"/>'); 
```

我不确定这是否通过了“优雅”测试，但无论包含元素中是否有任何其他内容，它都可以工作。

尽管如此，这似乎是一个简单问题的非常复杂的解决方案。简单的解决方案是将元素包装在包含元素中；这不应该是一个问题，如你所说，你可以保证他们将永远在一起。

# wix - 如何在 WiX 中自定义标准对话框文本？

> ID：10723454
> 
> 赞同：2
> 
> 时间：2012-05-23T15:43:19.160
> 
> 标签：wix, customization

我在让 WiX 3.6beta2 以我认为应该的方式运行时遇到了一些麻烦。我就这样轻车熟路：

```
light -loc strings.wxl 
```

其中 strings.wxl 有这条线

```
<String Id="InstallDirDlgDescription>Click Next to install.</String> 
```

我希望将标题下“目标文件夹”中的文本更改为我的文本，但事实并非如此。根据文档，添加该行

```
<String Id="WelcomeDlgDescription">This is a custom welcome message. Click Next to continue or Cancel to exit.</String> 
```

到 strings.wxl 应该更改欢迎对话框上的描述性文本，但我也没有看到。我错过了什么？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:20:57.560

事实证明，如果您确实希望 WiX 使用本地化值，那么指向*正确的 .wxl 文件非常有帮助。*PEBKAC。:P

# php - 正则表达式：检测特定字符串

> ID：10723455
> 
> 赞同：1
> 
> 时间：2012-05-23T15:43:19.293
> 
> 标签：php, regex, preg-match

我正在尝试使用 , 在 PHP 中搜索一个字符串`preg_match()`，以返回一个采用“xdr”格式的字符串，其中 x 是一个数字。

否则字符串由字符、数字、'.' 组成。句号和空格。

我对正则表达式毫无希望，有人可以帮助我吗？

我已经尝试过`^([a-zA-Z0-9]+)\s2dr$`，但它不起作用

例如，字符串可能看起来像`A really big 2.0 was 3dr once`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T17:36:38.587

据我了解您的需求，此正则表达式将用于匹配包含一些数字的字符串，后跟`dr`：

```
 /\b\d+dr\b/ 
```

在行动中`preg_match`：

```
preg_match('/\b\d+dr\b/', $string); 
```

**解释：**

```
/      : regex delim
  \b   : word boundary
  \d+  : one or more digit
  dr   : literaly dr
  \b   : word boundary
/      : regex delim 
```

如果您希望其他字符仅`characters, numbers, '.' full stops and spaces`使用此：

```
preg_match('/^[\w\d. ]*\b\d+dr\b[\w\d. ]*$/', $string); 
```

并且，要兼容 unicode：

```
preg_match('/^[\pL\pN. ]*\b\pN+dr\b[\pL\pN. ]*$/', $string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:45:21.330

你很近。

以下正则表达式将匹配一个数字，后跟*一个或多个*字母字符、数字、句号和空格，并以`dr`.

```
^\d[a-zA-Z0-9\. ]+dr$ 
```

**注意**：不确定是否需要文字`dr`，如果没有，请从末尾删除。

# wordpress - WordPress 重定向 Post_ID

> ID：10723456
> 
> 赞同：0
> 
> 时间：2012-05-23T15:43:19.533
> 
> 标签：wordpress, .htaccess, redirect

我将 WordPress 安装移动到我网站上的子文件夹 (/wp) 中。我现在需要创建一个重写规则，将所有链接指向该规则。示例： http: [//www.domain.com/1234](http://www.domain.com/1234) --> [http://www.domain.com/wp/1234](http://www.domain.com/wp/1234)（其中 1234 是 post_id）。当然，我有超过 15000 个帖子，所以我不能每个都重写，所以我需要一个可以做通用“1”、“2”等的规则，并添加帖子的其他数字并适当地重定向它们。

我整天都在研究重写规则，但没有运气。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:45:22.720

在根目录下的 .htaccess 文件中尝试这样的操作：

```
RewriteRule ^(\d+)$ wp/$1 [L,R,QSA] 
```

# jquery - ASP MVC 3 客户端日期本地化验证

> ID：10723457
> 
> 赞同：0
> 
> 时间：2012-05-23T15:43:30.510
> 
> 标签：jquery, asp.net-mvc-3, validation

我目前正忙于一个 Asp.net MVC 3 网站。我有一个设置文化的下拉菜单（nl-BE // en-US）

当我尝试使用 nl-BE 文化解析格式为“dd/mm/yyyy”的日期时，在服务器上，一切正常，但在客户端上，我的浏览器（chrome）一直说日期格式“dd/mm/yyyy " 不是正确的日期格式。（客户端验证）

我已经尝试过使用 jquery 的“globalize.js”，但仍然没有成功。

我可以欺骗我的浏览器的唯一方法是手动添加我自己的验证器 jQuery.validator.addMethod( 'date', function (value, element, params) { return Date.parseExact(value, "d/M/yyyy"); });

但是当我为 nl-BE 输入以下日期：25/05/2012 时，浏览器说好的，但我的服务器抛出一个错误，（因为这种错误的格式）所以它不是防错的。

有人可以帮助进行可以处理 dd/mm/yyyy 或 mm/dd/yyyy 的防错客户端验证吗

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T09:21:32.520

你可以在你的 Object 属性中强制它。

```
[DisplayFormat(DataFormatString = "{0:dd-MM-yyyy}", ApplyFormatInEditMode = true)] 
```

如果你将它与 jQuery UI 日期选择器结合起来，这样网站访问者就不会键入日期，而是选择一个日期，它应该是可靠的。

您需要的最后一件事是在您的共享文件夹中，一个新文件夹：带有新视图的 EditorTemplates：DateTime.cshtml：

```
@model System.DateTime 
@Html.TextBox("", ViewData.TemplateInfo.FormattedModelValue, 
                    new { data_datepicker=true }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T12:20:21.003

这是 Chrome 中的一个错误，我在这里找到了解决方案））

[http://geekswithblogs.net/EltonStoneman/archive/2009/10/29/jquery-date-validation-in-chrome.aspx](http://geekswithblogs.net/EltonStoneman/archive/2009/10/29/jquery-date-validation-in-chrome.aspx)

也许有些人也会得到错误；）

# c# - 在 .NET 中，null 的哈希码是否应该始终为零

> ID：10723458
> 
> 赞同：89
> 
> 时间：2012-05-23T15:43:32.873
> 
> 标签：c#, .net, hash, null

鉴于像`System.Collections.Generic.HashSet<>`接受`null`作为集合成员这样的集合，人们可以询问哈希码`null`应该是什么。看起来框架使用`0`：

```
// nullable struct type
int? i = null;
i.GetHashCode();  // gives 0
EqualityComparer<int?>.Default.GetHashCode(i);  // gives 0

// class type
CultureInfo c = null;
EqualityComparer<CultureInfo>.Default.GetHashCode(c);  // gives 0 
```

对于可为空的枚举，这可能（有点）问题。如果我们定义

```
enum Season
{
  Spring,
  Summer,
  Autumn,
  Winter,
} 
```

那么`Nullable<Season>`（也称为`Season?`）只能取五个值，但其中两个，即`null`和`Season.Spring`，具有相同的哈希码。

像这样写一个“更好”的相等比较器是很诱人的：

```
class NewNullEnumEqComp<T> : EqualityComparer<T?> where T : struct
{
  public override bool Equals(T? x, T? y)
  {
    return Default.Equals(x, y);
  }
  public override int GetHashCode(T? x)
  {
    return x.HasValue ? Default.GetHashCode(x) : -1;
  }
} 
```

但是有什么理由为什么`null`应该是的哈希码`0`？

**编辑/添加：**

有些人似乎认为这是关于压倒一切`Object.GetHashCode()`的。事实上，事实并非如此。（.NET 的作者确实`GetHashCode()`在`Nullable<>`结构中**覆盖了**`GetHashCode()`（不过， .NET在相关`null`了

这是关于实现抽象方法[`EqualityComparer<T>.GetHashCode(T)`](http://msdn.microsoft.com/en-us/library/ms132131)或以其他方式实现接口方法[`IEqualityComparer<T>.GetHashCode(T)`](http://msdn.microsoft.com/en-us/library/ms132155)。现在，在创建这些指向 MSDN 的链接时，我看到它在那里说这些方法会抛出一个`ArgumentNullException`if 它们的唯一参数是`null`. 这肯定是MSDN上的一个错误？.NET 自己的实现都不会引发异常。在这种情况下投掷将有效地破坏任何添加`null`到`HashSet<>`. 除非`HashSet<>`在处理一个`null`项目时做了一些特别的事情（我将不得不对此进行测试）。

**新编辑/添加：**

现在我尝试调试。使用`HashSet<>`，我可以确认使用默认的相等比较器，值`Season.Spring`和`null` **将**在同一个存储桶中结束。这可以通过非常仔细地检查私有数组成员来确定`m_buckets`和`m_slots`. 请注意，根据设计，索引始终偏移 1。

然而，我上面给出的代码并没有解决这个问题。事实证明，`HashSet<>`当值为 . 时，甚至永远不会询问相等比较器`null`。这是来自的源代码`HashSet<>`：

```
 // Workaround Comparers that throw ArgumentNullException for GetHashCode(null).
    private int InternalGetHashCode(T item) {
        if (item == null) { 
            return 0;
        } 
        return m_comparer.GetHashCode(item) & Lower31BitMask; 
    } 
```

这意味着，**至少对于 来说`HashSet<>`，甚至不可能更改 的哈希值`null`。**相反，一个解决方案是更改所有其他值的哈希，如下所示：

```
class NewerNullEnumEqComp<T> : EqualityComparer<T?> where T : struct
{
  public override bool Equals(T? x, T? y)
  {
    return Default.Equals(x, y);
  }
  public override int GetHashCode(T? x)
  {
    return x.HasValue ? 1 + Default.GetHashCode(x) : /* not seen by HashSet: */ 0;
  }
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-23T15:50:15.740

只要为空值返回的哈希码与类型*一致*，就可以了。哈希码的唯一要求是被认为相等的两个对象共享相同的哈希码。

为 null 返回 0 或 -1，只要您选择一个并一直返回它，就可以了。显然，非空哈希码不应该返回您用于空的任何值。

~~类似的问题：~~

[空字段上的GetHashCode？](https://stackoverflow.com/questions/2444748/gethashcode-on-null-fields)

[当对象的标识符为空时，GetHashCode 应该返回什么？](https://stackoverflow.com/questions/5078149/what-should-gethashcode-return-when-objects-identifier-is-null)

~~[此MSDN 条目](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)的“备注”围绕哈希码进行了更详细的说明。令人痛心的是，该文档根本没有提供任何关于空值*的*报道或讨论——甚至在社区内容中也没有。~~

要解决您的枚举问题，要么重新实现哈希码以返回非零，添加一个默认的“未知”枚举条目，相当于 null，或者干脆不使用可为空的枚举。

顺便说一句，有趣的发现。

我通常看到的另一个问题是哈希码**不能**表示一个 4 字节或更大的类型，该类型在没有***至少一次冲突***的情况下可以为空（随着类型大小的增加更多）。例如，一个 int 的哈希码就是 int，所以它使用整个 int 范围。您为 null 选择该范围内的什么值？无论您选择什么，都会与值的哈希码本身发生冲突。

碰撞本身并不一定是问题，但您需要知道它们的存在。哈希码仅在某些情况下使用。正如 MSDN 上的文档中所述，不保证哈希码会为不同的对象返回不同的值，因此不应期望如此。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T16:15:43.143

**它不一定*是*零**——如果你愿意，你可以把它设为 42。

*重要的是程序执行期间的**一致性。***

这只是最明显的表示，因为`null`通常在内部表示为零。这意味着，在调试时，如果您看到哈希码为零，它可能会提示您：“嗯……这是一个空引用问题吗？”

请注意，如果您使用类似 的数字`0xDEADBEEF`，那么有人可能会说您使用的是幻数……您会这样。（你也可以说零也是一个神奇的数字，而且你是对的……只是它被广泛使用，以至于在某种程度上是规则的例外。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-24T09:02:21.320

请记住，哈希码仅用作确定相等性的第一步，并且[是/应该]永远不要（被）用作关于两个对象是否相等的事实上的确定。

如果两个对象的哈希码不相等，那么它们将被视为不相等（因为我们假设不正确的实现是正确的 - 即我们不会事后猜测）。如果它们具有相同的哈希码，则应检查它们的*实际*相等性，在您的情况下，`null`枚举值将失败。

结果 - 在一般情况下，使用零与任何其他值一样好。

当然，在某些情况下，例如您的枚举，此零与*实际*值的哈希码共享。问题是，对您来说，额外比较的微小开销是否会导致问题。

如果是这样，那么为您的特定类型的可为空的情况定义您自己的比较器，并确保空值始终产生始终相同的哈希码（当然！）*和*底层无法产生的值类型自己的哈希码算法。对于您自己的类型，这是可行的。对于其他人-祝你好运:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-12T13:29:47.737

> 但是为什么 null 的哈希码应该为 0 有什么原因吗？

它本来可以是任何东西。我倾向于同意 0 不一定是最佳选择，但它可能会导致最少的错误。

散列函数绝对**必须**为相同的值返回相同的散列。一旦存在执行此操作*的*组件，这实际上是 .h 的哈希的唯一有效值`null`。如果对此有一个常数，例如 hm, `object.HashOfNull`，那么实现 an 的`IEqualityComparer`人必须知道使用该值。我认为，如果他们不考虑这一点，他们使用 0 的机会会略高于其他所有值。

> 至少对于HashSet<>，甚至不可能改变null的hash

如上所述，我认为完全不可能完全停止，因为存在已经遵循 null 哈希为 0 的约定的类型。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-23T15:50:02.907

好问题。

我只是尝试编写此代码：

```
enum Season
{
  Spring,
  Summer,
  Autumn,
  Winter,
} 
```

并像这样执行：

```
Season? v = null;
Console.WriteLine(v); 
```

它返回`null`

如果我这样做，而不是正常

```
Season? v = Season.Spring;
Console.WriteLine((int)v); 
```

如果我们避免强制`0`转换*为*`int`.

所以..如果您执行以下操作：

```
Season? v = Season.Spring;  
Season? vnull = null;   
if(vnull == v) // never TRUE 
```

**编辑**

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)

如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。**但是，如果两个对象比较不相等，则两个对象的 GetHashCode 方法不必返回不同的值**

换句话说：如果两个对象具有相同的哈希码，但这并不意味着它们相等，因为 *真正的*相等性由*Equals*确定。

再次来自 MSDN：

> 只要确定对象的 Equals 方法的返回值的对象状态没有修改，对象的 GetHashCode 方法就必须始终返回相同的哈希码。请注意，这仅适用于应用程序的当前执行，并且如果再次运行应用程序，则可以返回不同的哈希码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-23T15:54:09.157

为简单起见，它为 0。没有这么硬的要求。您只需要保证哈希编码的一般要求。

例如，您需要确保如果两个对象相等，则它们的哈希码也*必须*始终相等。因此，不同的哈希码必须始终代表不同的对象（但反之亦然：两个不同的对象可能具有相同的哈希码，即使这种情况经常发生，那么这也不是一个高质量的哈希函数——它没有良好的抗碰撞性）。

当然，我的回答仅限于数学性质的要求。还有 .NET 特定的技术条件，您可以[在此处](http://msdn.microsoft.com/en-us/library/system.object.gethashcode%28v=vs.71%29.aspx)阅读。0 表示空值不在其中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-29T19:24:19.713

就我个人而言，我发现使用可空值有点尴尬，并尽可能避免使用它们。你的问题只是另一个原因。虽然有时它们非常方便，但我的经验法则是尽可能不要将值类型与 null 混合，因为它们来自两个不同的世界。在 .NET 框架中，它们似乎做同样的事情 - 许多值类型提供`TryParse`方法，这是一种将值与无值 ( `null`) 分离的方法。

在您的特定情况下，很容易摆脱问题，因为您处理自己的`Season`类型。

`(Season?)null`对我来说意味着“未指定季节”，例如当您有一个不需要某些字段的网络表单时。在我看来，最好在本身中指定特殊的“价值”，`enum`而不是使用有点笨重的`Nullable<T>`。它会更快（没有装箱）更容易阅读（`Season.NotSpecified`vs `null`），并将解决您的哈希码问题。

当然，对于其他类型，例如`int`您不能扩展值域并将其中一个值命名为*特殊*值并不总是可行的。但是`int?`，如果有的话，哈希码冲突的问题要小得多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-23T16:06:09.327

所以这可以通过使用枚举值来避免（尽管 a未知`Unknown`似乎有点奇怪）。`Season`所以这样的事情会否定这个问题：

```
public enum Season
{
   Unknown = 0,
   Spring,
   Summer,
   Autumn,
   Winter
}

Season some_season = Season.Unknown;
int code = some_season.GetHashCode(); // 0
some_season = Season.Autumn;
code = some_season.GetHashCode(); // 3 
```

然后，您将拥有每个季节的唯一哈希码值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-06T18:55:19.350

```
Tuple.Create( (object) null! ).GetHashCode() // 0
Tuple.Create( 0 ).GetHashCode() // 0
Tuple.Create( 1 ).GetHashCode() // 1
Tuple.Create( 2 ).GetHashCode() // 2 
```

# c# - 如何将 xml 存储在服务器上的某个位置以避免在用户发出的每个请求上与服务器通信？

> ID：10723460
> 
> 赞同：0
> 
> 时间：2012-05-23T15:43:36.323
> 
> 标签：c#, asp.net, xml, linq, linq-to-xml

我正在使用 Adlib api 来获取 XML 格式的数据。我决定使用 LINQ to XML，这样我就可以轻松地在 xml 中查询我需要的元素的值。但是我不想每次用户的搜索会话正在进行时都发送新请求。相反，我无法找到一种方法将我的 xml 存储在会话状态或应用程序状态或“某处”的某个地方，以便我可以将该 xml 用于用户的特定会话。

如果用户正在搜索关键字，则上述条件有效，然后我得到一堆 xml 格式的结果。

我应该如何处理 xml 的存储以避免每个请求都与服务器对话！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:58:17.880

尝试使用会话状态，它将对当前用户的会话处于活动状态，例如

`Session["AdlibXmlData"] = your xml data`

然后，您可以访问`Session["AdlibXmlData"]`您网站的其他位置。

# jquery - jQuery 表单验证：为错误定义容器

> ID：10723462
> 
> 赞同：15
> 
> 时间：2012-05-23T15:43:42.360
> 
> 标签：jquery, validation, error-handling, jquery-validate

我正在使用 jQuery 验证插件来验证我的表单。它可以工作（将错误消息放在无效输入旁边，这搞砸了我的设计），但我想为每个输入字段指定错误容器。我找到了errorLabelContainer，但这会将所有错误都放在一个容器中。

假设我有 2 个输入，一个带有 id `name`，一个带有`firstname`. 并且我们还假设我有 2 个错误跨度，带有 ids`errorName`和`errorFirstname`. 我如何告诉 jQuery 将验证错误写入`name`带有 id 的 span 中`errorName`。

这是我当前的 jQuery：

```
$("#form").validate({
    errorLabelContainer: "#errors",
        rules: {
            name: {
                required: true
            },
            firstname: {
                required: true
            }
        },
        messages: {
            name: {
                required: "Enter name"
            },
            firstname: {
                required: "Enter firstname"
            }
        }
    }) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-24T02:11:46.087

我认为该`errorPlacement`选项适合您的需求：

> 自定义创建的错误标签的位置。第一个参数：作为 jQuery 对象创建的错误标签。第二个参数：作为 jQuery 对象的无效元素。

您可以根据无效元素确定要放置错误的元素：

```
$("#form").validate({
    rules: {
        name: {
            required: true
        },
        firstname: {
            required: true
        }
    },
    messages: {
        name: {
            required: "Enter name"
        },
        firstname: {
            required: "Enter firstname"
        }
    },
    errorPlacement: function ($error, $element) {
        var name = $element.attr("name");

        $("#error" + name).append($error);
    }
}); 
```

**示例：http:** [//jsfiddle.net/R3aEQ/](http://jsfiddle.net/R3aEQ/)

# bison - bison/lex YYSTYPE 声明为结构

> ID：10723464
> 
> 赞同：3
> 
> 时间：2012-05-23T15:43:51.010
> 
> 标签：bison, yacc, lex

我已经尝试了一段时间，通过使用 bison 和 lex 来实现语法解析器。

我对 yylval 的类型重新声明有疑问，我自己解释一下。

我有 4 个文件：lexico.l、parser.y、funcionesTabla.c、funcionesTabla.h

第一个，包含 lex 的规范 第二个，bison/yacc 的规范 最后两个，是一堆处理符号表的方法。

我有funcionesTabla.h：

```
typedef enum {
entero,
real,
caracter,
arrayEntero,
arrayReal,
arrayCaracter,
matrizEntero,
matrizReal,
matrizCaracter,
desconocido,
no_asignado
} dtipo ;

typedef struct{
int    atrib ;
char  *lexema ;
dtipo  tipo ;
} atributos;

#define YYSTYPE atributos 
```

我试过下一个：

从parser.y，在一个规则内，尝试访问yylval.tipo，没问题。

从 lexico.l，在令牌规则中，尝试访问 yylval.lexema （或任何属性），gcc 告诉我：

```
 lexico.l: In function ‘yylex’:
 lexico.l:93: error: request for member ‘lexema’ in something not a structure or union
 make: *** [lex.yy.o] Error 1 
```

有什么建议吗？

提前非常感谢，对不起我的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T06:19:03.777

大卫是对的，默认情况下 yacc 会给你一个`%union`指令，但是看到它被翻译成纯 C，你可以把你的结构嵌套在那里：

```
%union {
    struct {
        int atrib;
        char *lexema;
        dtipo tipo;
    };
} 
```

在支持联合内部匿名结构（例如 C99）的 C 方言中，这将像您期望的那样简单地工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T02:00:43.413

我不完全了解您如何使用 struct `atributos`，但我会猜测一下。

查看您生成的`y.tab.h`文件：我想您会看到生成的代码`yylval`与您想要使用它的方式不兼容。

通常，我认为`YYSTYPE`定义为联合，而不是结构。查看 bison`%union`指令的文档以定义语义值的数据类型。我想你想要这样的东西：

```
%union {
    int    atrib;
    char  *lexema;
    dtipo  tipo;
} 
```

# java - 无法在 PLAY 2.0 中使用外键创建复合主键

> ID：10723465
> 
> 赞同：4
> 
> 时间：2012-05-23T15:43:51.220
> 
> 标签：java, jpa, playframework-2.0, ebean

这是我想在我的 PLAY 项目中表示的情况：

```
table clients {
     client_id (pk),
     description
}

table items {
     client_id (fk, pk),
     item_id (pk)
} 
```

在“项目”表中，我想要一个复合主键，它将由组合的 client_id 和 item_id 组成。我已阅读 JPA 文档以及有关该主题的许多帖子，但一切都一次又一次地失败。这是我尝试过的众多版本之一 - 最接近 JPA 文档。

```
@Entity
@Table(name = "items")
public class Items extends Model {
    ItemsPK primaryKey;

    public Items() {
    }

    @EmbeddedId
    public ItemsPK getPrimaryKey() {
        return primaryKey;
    }

    public void setPrimaryKey(ItemsPK pk) {
        primaryKey = pk;
    }
}

@Embeddable
public class ItemsPK implements Serializable {
    private long itemId;
    private Client client;

    public ItemsPK() {
    }

    @Column(name = "item_id")
    @GeneratedValue(strategy = GenerationType.AUTO)
    public long getItemId() {
        return itemId;
    }

    public void setItemId(long itemId) {
        this.itemId = itemId;
    }

    @ManyToOne
    @JoinColumn(name = "client_id", nullable = false)
    public Client getClient() {
        return client;
    }

    public void setClient(Client client) {
        this.client = client;
    }

    //public int hashCode() {...
    //public boolean equals(Object obj) {...
} 
```

上面的代码（以及许多其他不同的设置）在播放启动期间产生以下错误：

> java.lang.RuntimeException：在 com.avaje.ebeaninternal.server.deploy.parse.ReadAnnotations.readAssociations(ReadAnnotations.java:73) ~[ebean.jar:na] 在 com.avaje.ebeaninternal 读取 models.ItemsPK 的注释时出错.server.deploy.BeanDescriptorManager.readDeployAssociations(BeanDescriptorManager.java:1100) ~[ebean.jar:na]

我不知道我的代码可能有什么问题。我开始认为这是一个 PLAY 错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:54:07.820

根据我的经验，您不能在 EmbeddedId 中使用 GeneratedValue，必须分配复合键中的值。请参阅下面的摘录。

> 仅需要简单主键支持使用 GeneratedValue 注释。派生的主键不支持使用 GeneratedValue 注释。

[http://docs.oracle.com/javaee/6/api/javax/persistence/GeneratedValue.html](http://docs.oracle.com/javaee/6/api/javax/persistence/GeneratedValue.html)

[http://www.objectdb.com/api/java/jpa/GeneratedValue](http://www.objectdb.com/api/java/jpa/GeneratedValue)

我建议不要为此使用复合键，因为这`itemId`足以生成唯一标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T18:42:14.693

切希奇，

这不是答案，而是建议。你能告诉我在你的情况下使用复合 PK 的主要目标是什么？使用 Ebean ORM，您的两个模型都将非常小且容易

模型/Client.java

```
package models;

import play.db.ebean.Model;
import javax.persistence.Entity;
import javax.persistence.Id;

@Entity
public class Client extends Model {
    @Id
    public Long id;
    public String description;
} 
```

模型/Item.java

```
package models;

import play.db.ebean.Model;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.ManyToOne;

@Entity
public class Item extends Model {
    @Id
    public Long id;

    @ManyToOne
    public Client client;
} 
```

就这样。除了复合 PK 之外，它为您提供所需的一切

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T07:42:29.860

我认为您没有禁用 Ebean。Ebean 是 Play 2 的默认 ORM。如果你想使用 JPA，你必须禁用 Ebean。

所以在你的 Build.scala 中，添加这个：

```
val main = PlayProject(appName, appVersion, appDependencies, mainLang = JAVA).settings(
    ebeanEnabled := false
) 
```

在你的 application.conf 中编辑这一行：

```
ebean.default="models.*" 
```

# safari - MVC4、WebSocket、Safari 上下文。IsWebSocketRequest 为假

> ID：10723473
> 
> 赞同：0
> 
> 时间：2012-05-23T15:44:16.920
> 
> 标签：safari, websocket, asp.net-mvc-4

我正在使用带有 IIS8 和 MVC4 的 Windows 8 来建立 websocketconnection。这适用于 Firefox、IE10 和 Chrome。Safari 仍然不允许我建立 websocketconnection。我的处理程序代码如下所示：

```
<!-- language: c# -->
public void ProcessRequest(HttpContext context)
{
if (context.IsWebSocketRequest)
{
Client client = new Client();
context.AcceptWebSocketRequest(client.HoldConnection);
}
} 
```

问题是 context.IsWebSocketRequest 在通过 Safari 连接时总是错误的。我的 JavaScript 代码很简单`this.socket = new WebSocket(window.WebSocketUrl);`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:28:18.350

使用了两个不兼容的 websocket 协议版本。Safari 使用原始（现已弃用）[Hixie](https://datatracker.ietf.org/doc/html/draft-hixie-thewebsocketprotocol-76)变体；Firefox、IE10 和 Chrome 使用较新的[Hybi](https://www.rfc-editor.org/rfc/rfc6455)变体

构建一个支持两个版本的 websocket 服务器是完全可能的，但听起来 MVC4 只支持 Hybi 客户端。

Safari 最终会迎头赶上。如果您等不及了，您可以考虑使用支持两种 websocket 变体的替代服务器，或者重新设计您的客户端以进行轮询（作为标准或 websocket 连接失败时的后备）。

# c++ - 同一端口套接字C ++上的多个连接

> ID：10723476
> 
> 赞同：5
> 
> 时间：2012-05-23T15:44:21.820
> 
> 标签：c++, multithreading, sockets

我需要接受到同一个端口的多个连接。我在 C++ 中使用套接字，我想做一些类似于 SSH 的事情。我可以执行 ssh user@machine "ls -lathrR /" 并在同一台机器上运行另一个命令，即使第一个命令仍在运行。

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T16:10:31.703

你想要的是一个多线程套接字服务器。

为此，您需要一个主线程来打开一个套接字来监听（并等待传入​​的客户端连接）。这必须进入某种while循环。

然后，当客户端连接到它时，该`accept()`函数将解除阻塞，此时您需要通过将请求传递给将处理它的线程来服务客户端请求。

服务器端将循环返回并等待另一个连接，而前一个线程继续执行其任务。

您可以根据需要创建线程，也可以使用可能更高效的线程池（节省初始化新线程的时间）。

[在这里](http://www.codeproject.com/Articles/2477/Multi-threaded-Client-Server-Socket-Class)查看更多详细信息。在网络上寻找多线程服务器套接字，特别是`bind()`从服务器端。`listen()``accept()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:53:04.867

你需要阅读`::listen()`和`::accept()`。

前者将设置您的套接字进行侦听。然后，您需要一个循环（可能在它自己的线程中），它使用`::accept()`它将在每次新连接到达时返回。

然后该循环应该生成一个新线程，您应该将接收到的文件描述符传递给该线程，`::accept()`然后从那里处理该套接字上的所有 I/O。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T14:31:54.113

老问题很老，但我觉得没有人回答理解OP的问题。

您误解了 ssh 的工作原理。当您通过 ssh 向服务器发送多个命令/多个连接时，实际上您要连接的服务器上只有一个程序正在接收所有这些命令。

sshd（ssh 守护进程）在服务器上运行，是一个多线程套接字服务器（参见 fduff 的回答）。这是唯一侦听端口 22 并自行处理所有传入 ssh 连接的程序。

# velocity - 在 Velocity 中包含文字 JSON 内容（避免 HTML 转义）

> ID：10723477
> 
> 赞同：4
> 
> 时间：2012-05-23T15:44:22.367
> 
> 标签：velocity, vtl

我正在尝试使用嵌入在 Atlassian 产品中的 Velocity 引擎（并通过 com.atlassian.templaterenderer 公开）将 JSON 值替换为模板。

在模板中，这看起来有点像以下内容：

```
<script>
  foo = $foo
</script> 
```

但是，当我使用映射到字符串`["bar", "baz"]`的“foo”渲染模板时，输出如下：

```
<script>
  foo = [&quot;bar&quot;, &quot;baz&quot;]
</script> 
```

如何避免这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T23:13:56.813

Atlassian 有一个事件处理程序，它对名称不以`WithHtml`.

因此：

```
<script>
foo = $fooWithHtml
</script> 
```

根据需要扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:58:11.450

这不是默认行为，看起来您已经在您的或 java 初始化中`EscapeHtmlReference`注册了事件处理程序。`velocity.properties`有关事件处理程序的更多详细信息，请[点击此处](http://velocity.apache.org/engine/releases/velocity-1.7/developer-guide.html#Configuring_Event_Handlers)。

# ios - 如果用户在 iOS 设备上创建的数据用完手机上的所有内存会怎样？

> ID：10723479
> 
> 赞同：0
> 
> 时间：2012-05-23T15:44:54.113
> 
> 标签：ios, memory

换句话说，假设我有一个允许用户创建自己的数据的应用程序（如相机应用程序），当拍摄的照片超过设备上的剩余内存时会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:58:55.067

这取决于操作系统来处理这些情况。请记住，电话、智能手机的工作原理与计算机非常相似。与您的计算机通知您可用空间不足...或无法复制的错误...查看开发人员API的方式相同，应该有一种方法来处理此异常。

# javascript - 如何使用 ajax 与单独页面上的 div 标签链接

> ID：10723480
> 
> 赞同：0
> 
> 时间：2012-05-23T15:44:54.347
> 
> 标签：javascript, jquery, html, ajax

我只需要一些使用 ajax 的帮助。我现在拥有的是一个加号的按钮图像。现在，当用户单击按钮图像时，它将打开一个模型窗口。目前模态窗口是空白的。

模式窗口为空白的原因是因为我没有正确地将其与 div 标签“previouslink”链接起来，因为它位于单独的页面上。(previousquestions.php)。我希望模态窗口在“previousquestions.php”页面的“previouslink”div 标记中显示详细信息，但是如何使用 ajax 来实现呢？

下面是模态窗口和页面中图片按钮的代码（QandATable.php）：

```
 <script>

      function plusbutton()
        {

        $(".previouslink").modal("previousquestions.php");          
        return false;
    }

    </script>

    <body>

    <h1>CREATING QUESTIONS AND ANSWERS</h1>

    <table id="plus" align="center">
    <tr>
    <th>
    <a onclick="return plusbutton();">
    <img src="Images/plussign.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage"/>
    </a>
    <span id="plussignmsg">(Click Plus Sign to look <br/> up Previous Questions)</span>
    </th>
    </tr>
    </table>

<div class="previouslink">
</div>

    </body> 
```

以下是“previousquestions.php”页面中的“previouslink”div 标签：

```
<button type="button" id="close" onclick="return closewindow();">Close</button>
<h1>PREVIOUS QUESTIONS</h1>

<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
      <p>Search: <input type="text" name="questioncontent" /></p>
      <p><input id="searchquestion" name="searchQuestion" type="submit" value="Search" /></p>
      </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:01:38.973

您使用哪个模态插件？我建议您查看它的文档，因为其中大多数已经能够通过 AJAX 加载内容。

但不管怎样，我认为这里有一个误解：你基本上告诉 jQuery *“将具有类 'previouslink' 的元素，并使其成为模式窗口”* - 但是当前页面上没有该类的元素（ QandATable.php）。

编辑：对于 simpleModal，它应该像这样工作：

```
$.modal( $('<div />').load('previousquestions.php .previouslink') ); 
```

# asp.net - 使用 Active Reports 6 的 Asp.NET MVC3 应用程序错误

> ID：10723490
> 
> 赞同：1
> 
> 时间：2012-05-23T15:45:10.900
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-3-areas

我有一个 MVC3 应用程序，它在 localhost 上 100% 运行，但是，当我部署应用程序并访问报告时（顺便说一下，我使用的是 ActiveReports 6），我得到“抱歉，处理您的请求时发生错误”。有什么帮助吗？这与身份验证或文件夹权限有关吗？

编辑：我有一个没有 WebViewer 的 Active Report 标准许可证。因此，我将报告导出为 PDF，然后通过 Response.BinaryWrite(memStream); 将其发送到浏览器；

# javascript - 为什么不能为 document.getElementById() 设置别名？

> ID：10723496
> 
> 赞同：4
> 
> 时间：2012-05-23T15:45:42.903
> 
> 标签：javascript

> **可能重复：**
> [JavaScript 函数别名似乎不起作用](https://stackoverflow.com/questions/1007340/javascript-function-aliasing-doesnt-seem-to-work)
> [将 document.getElementById 设置为变量](https://stackoverflow.com/questions/9804828/set-document-getelementbyid-to-variable)

如果可能的话，代码会更有效率：

```
var min = document.getElementById; 
```

然后调用`document.getElementById()`使用`min().`

不尝试编写缩小代码，但在这种特殊情况下，可以减少范围查找并缩短一些行。

这是语法问题还是对语言的限制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T16:28:48.320

当你调用`foo.bar()`then时`this`设置为`foo`inside`bar` 当你复制`foo.bar`到`window.bar`then 调用`window.bar()`时，`this`设置为`window`。

`getElementById`必须对 DOM 文档对象进行操作。

# javascript - 调用对象内部函数的区间，该函数也调用该对象内部的函数

> ID：10723497
> 
> 赞同：1
> 
> 时间：2012-05-23T15:45:44.200
> 
> 标签：javascript, function, scope, this, setinterval

```
function airEngineJS (canvasArg, properties) {

    this.canvas = (canvasArg == "undefined")? trace("Failed to set up canvas for airEngineJS") : canvasArg;
    this.cameras = [];
    this.displayObjects = [];
    this.hudDisplayObjects = [];
    this.fps = (properties == "undefined" || properties.fps == "undefined")? 30 : properties.fps;

    if (properties == "undefined" || properties.autoinit == "undefined" || properties.autoinit == true){
      this.keyboard = new keyboardJS();
      this.keyboard.init();
      this.cameras.push(new airCameraJS(this));
    }
    this.enterframe = setInterval(this.intervalCaller, 1000/this.fps);
    trace("A new airEngineJS has been created");
  }
  airEngineJS.prototype = {
    intervalCaller : function () {
      this.mainLoop();
    },
    logic : function () {
      for (var i = 0; i < this.displayObjects.length; ++i){
        this.displayObjects[i].logic();
      }
      for (var j = 0; j < this.cameras.length; ++j){
        this.cameras[j].logic();
      }
    },
    render : function () {
      for (var i = 0; i < this.cameras.length; ++i){
        for (var j = 0; j < this.displayObjects.length; ++j){
          this.displayObjects[j].renderOn(this.cameras[i]);
        }
      }
      for (var i = 0; i < this.hudDisplayObjects.length; ++i){
        this.hudDisplayObjects[i].renderOn(this.canvas);
      }
    },
    mainLoop : function () {
      this.logic();
      this.render();
    }
  } 
```

区间 [this.enterframe = setInterval(this.intervalCaller, 1000/this.fps);] 正确调用 (this.intervalCaller)，但 this 尝试在 DOM 中调用 (this.mainLoop())。

关于我应该如何做的任何建议？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:52:33.137

您可以像这样关闭实际的函数调用：

```
var self = this;
this.enterframe = setInterval(function() {
    self.intervalCaller();
}, 1000/this.fps); 
```

它首先创建对新实例的引用，然后在传递给的闭包中使用该引用`setInterval`。

# vim - 如何在评论中禁用 AutoComplPop 完成？

> ID：10723499
> 
> 赞同：0
> 
> 时间：2012-05-23T15:45:57.043
> 
> 标签：vim, autocomplete

我最近开始使用[AutoComplPop](http://www.vim.org/scripts/script.php?script_id=1879)，但是当我写评论时我发现弹出窗口很烦人（因为我在写评论时通常不需要自动完成）。

当插入点在评论中时，是否有配置选项或快速破解可以有效地禁用 AutoComplPop？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:19:56.570

您需要通过挂钩检查`CursorMovedI`您当前是否在评论中，然后可以使用 AutoComplPop`:AcpLock`暂时禁用它。（撤消`:AcpUnlock`评论后撤消。）

最好通过查询语法高亮来检测各种文件类型的注释；这样，您就可以从现有文件类型的语法定义中受益。

这是一个片段：

```
function! IsOnSyntaxItem( syntaxItemPattern )
    " Taking the example of comments:
    " Other syntax groups (e.g. Todo) may be embedded in comments. We must thus
    " check whole stack of syntax items at the cursor position for comments.
    " Comments are detected via the translated, effective syntax name. (E.g. in
    " Vimscript, 'vimLineComment' is linked to 'Comment'.)
    for l:id in synstack(line('.'), col('.'))
        let l:actualSyntaxItemName = synIDattr(l:id, 'name')
        let l:effectiveSyntaxItemName = synIDattr(synIDtrans(l:id), 'name')
        if l:actualSyntaxItemName =~# a:syntaxItemPattern || l:effectiveSyntaxItemName =~# a:syntaxItemPattern
            return 1
        endif
    endfor
    return 0
endfunction 
```

有了这个，你应该能够拼凑出一个解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T20:28:11.143

为了回答在每次光标移动时检查语法时的性能问题，我必须自己实现它，并将其放入[OnSyntaxChange](http://www.vim.org/scripts/script.php?script_id=4085)插件中。

使用这个插件，只需三行即可完成设置（例如在 .vimrc 中）：

```
call OnSyntaxChange#Install('Comment', '^Comment$', 0, 'i')
autocmd User SyntaxCommentEnterI silent! AcpLock
autocmd User SyntaxCommentLeaveI silent! AcpUnlock 
```

对我来说，性能影响是显而易见的（取决于文件类型和语法），但可以容忍。自己试试吧！

# jquery - Jquery Ajax IE 响应慢

> ID：10723502
> 
> 赞同：2
> 
> 时间：2012-05-23T15:46:02.993
> 
> 标签：jquery, ajax, internet-explorer, crash, response

另一个 IE 问题 - 这次是 ajax 响应数据太大。

使用 FF 和 Chrome 几乎可以立即显示结果。然而，在显示结果之前，IE 会冻结一段时间。格式是从简单的 db 查询返回的 HTML，在某些情况下响应数据有 900 行长。

说真的，我能做些什么来加速 IE？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T09:01:56.653

问题解决了！

我在结果上使用了 tableSorter.js。这会向 DOM 中注入大量 IE 不喜欢的代码。我已经禁用了 IE 的排序功能，现在它的运行速度要快得多。

尽管如此，仍然非常令人沮丧 - 其他所有浏览器都可以完美运行，IE 像往常一样阻碍了世界。

# single-sign-on - OpenID 和单点登录 (sso)

> ID：10723508
> 
> 赞同：0
> 
> 时间：2012-05-23T15:46:53.697
> 
> 标签：single-sign-on, openid-provider

我有一些关于 Openid 1 的基本问题。任何人都可以成为 openid 提供者吗？2\. 如果有人注册了我们的网站，他们是否可以在任何其他使用 open id 的网站上使用该 id？例如谷歌应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T13:10:05.530

大多数使用 OpenID 的网站只是消费者。如果您成为提供者，您将决定谁可以成为消费者。许多站点仅配置为接受特定的 OpenID 提供程序，但那些接受任何 OpenID 提供程序（例如 SourceForge）的站点将与您的提供程序一起使用。

对于 Google Apps，这篇文章可能有用：

[您如何将您的 OpenId 委托给 Google Apps](https://stackoverflow.com/questions/436829/how-do-you-delegate-your-openid-to-google-apps)

听起来您必须向 Google 支付费用才能使用该功能，但三年内可能会发生很多变化。

如果您只是在寻找通用 SSO 系统，我建议您查看：

[http://barebonescms.com/documentation/sso/](http://barebonescms.com/documentation/sso/)

目前它是“仅限消费者”。

# wix - 应用程序找不到 SysWOW64 中的 dll

> ID：10723511
> 
> 赞同：1
> 
> 时间：2012-05-23T15:46:59.820
> 
> 标签：wix, windows-installer, 32bit-64bit, dllimport, syswow64

我正在开发一个使用一些自定义 32 位 dll 与 USB 设备通信的 C#/WPF 应用程序。它是作为 x86 应用程序开发的，并与 WIX 一起安装。当我在 64 位机器上安装软件包时，程序文件会按照我的预期安装到 Program Files (x86)。

使用 WIX 将 dll 安装到 SystemFolder。在 32 位机器上，这意味着 C:\Windows\System32。在 64 位上，它们最终位于 C:\Windows\SysWOW64。这没关系，但是当我运行我的应用程序时，它无法找到 dll（它通过 [DllImport...] 使用它们）。

那么，让我的应用程序找到 dll 的正确方法是什么，无论它们是在 System32 还是 SysWOW64 中？

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T09:12:38.180

如果它是默认的 C# 应用程序，它将自动成为 64 位 Windows 上的 64 位应用程序（C3 在 32 位 Windows 上默认为 32 位）。进入您的开发应用程序中的项目属性，并将架构（我认为；我现在没有 Studio）显式设置为 32 位。如果它作为 64 位应用程序运行，它将无法使用您的 32 位 DLL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-06T11:35:33.467

请根据您的windows版本检查应用程序中的dll是否与sys32或wow64文件夹中的dll版本相同。

您可以从 dll 的文件大小中进行检查。

例如：我遇到了这个问题，因为我在 system32 中的 libeay.dll 文件与我在 openssl 应用程序中的 libeay.dll 文件具有不同的 dll。我将 sys32 中的那个复制到 openssl 中，一切正常。

# php - PHP SoapClient 无法在 XML 中正确包含函数参数

> ID：10723513
> 
> 赞同：0
> 
> 时间：2012-05-23T15:47:11.973
> 
> 标签：php, xml, soap-client

我尝试向名为 GetPeriodicValues 的 .NET WSDL 函数发出请求。该函数需要一些参数，问题是 SoapClient 创建了不正确的 XML。

这个 PHP 代码...

```
$client = new SoapClient(self::URL , array('trace' => 1,  'encoding' => 'UTF-8', 'soap_version' => SOAP_1_1));
$params = array('name' => 'myname', 'address' => 'myaddress');
$result = $client->__soapCall('GetPeriodicValues', array('parameters' => $params), array()); 
```

...生成以下请求-XML（我已经排除了一些不相关的内容）：

```
<SOAP-ENV:Body>
   <ns1:RequestOf_GetPeriodicValuesParameters/>
</SOAP-ENV:Body> 
```

但我希望它能够创造这个

```
<SOAP-ENV:Body>
   <ns1:RequestOf_GetPeriodicValuesParameters>
      <ns1:name>myname</ns1:name>
      <ns1:address>myaddress</ns1:address>
   </ns1:RequestOf_GetPeriodicValuesParameters>
</SOAP-ENV:Body> 
```

我应该如何在函数调用中包含参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:38:21.733

问题解决了。我学到的是 XML 输出依赖于 WSDL，在我的情况下，它希望我将参数放在一个带有键“Params”的数组中。但是，查看 WSDL 返回的 XML，我发现没有这样的信息，而是看起来应该使用关键的“参数”。我不确定，但也许服务有问题。

# soap - 使用带有 MTOM 附件的 wsdl2cpp 客户端生成 wso2 cpp 代码

> ID：10723516
> 
> 赞同：0
> 
> 时间：2012-05-23T15:47:23.137
> 
> 标签：soap, attachment, wso2, mtom

我有一个使用axis2（Java）公开的soap Web服务，它将POJO序列化，例如具有名称的Person等，作为动作响应。此外，我有一个动作，它使用了一个序列化的 DataHandler，以便将二进制附件放入响应中，使用`<xop:Include ...></xop:Include>`

我已经使用 wso2 wsfcpp 提供的 wsdl2cpp 在 c++ 中生成了客户端代码。getPerson(personId) 操作工作正常，结果符合预期。但是，尽管生成的代码似乎无法正常工作，但 getFile(someId) 操作是成功的。

在axis2.xml 以及客户端中设置为enableMTOM=true 的服务。我什至添加了 Options.setEnableMTOM(true) 以确保在客户端的主要部分。

我认为问题在于从 wsdl 生成的代码，因为 getFile(someId) 响应的信封是有效的（我已经使用axis2c api手动测试了它，我可以按预期检索文件）。

以下是响应的 wsdl（从 axis2 Java 生成）中包含的模式：

```
<xs:element name="getFileResponse">
   <xs:complexType>
      <xs:sequence>
         <xs:element minOccurs="0" name="return" nillable="true" type="xs:base64Binary"/>
      </xs:sequence>
   </xs:complexType>
</xs:element> 
```

这是用于生成客户端代码的命令行：

```
WSDL2CPP -uri MyService.xml -g -d adb -u -f 
```

这是从服务收到的响应：

```
<ns:getFileResponse xmlns:ns="http://services.myplace.com">
   <ns:return>
      <xop:Include xmlns:xop="http://www.w3.org/2004/08/xop/include" href="cid:1.3ad8fc0571509f196559ee5312c14d23250854e4c9c8383e@apache.org"></xop:Include>
   </ns:return>
</ns:getFileResponse> 
```

wsdl 中是否缺少某些内容，或者该功能（带有 MTOM 客户端代码生成的肥皂）是否由 wsfcpp 实现？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:55:55.600

我用 gSoap 尝试过同样的事情，但我遇到了同样的问题。我认为axis2会自动检测二进制文件是否经过优化。另外，我发现无论哪种情况，wsdl 公开的返回元素类型都是 type="xs:base64Binary"。

我发现的唯一解决方法是通过用 xop:Include 替换 xs:base64Binary 来修补 WSDL，使用 python（或其他）脚本，然后生成代码。

这解决了问题，但产生了可维护性问题。

# javascript - jCarousel 自动滚动不工作，没有错误

> ID：10723523
> 
> 赞同：1
> 
> 时间：2012-05-23T15:47:58.417
> 
> 标签：javascript, slider, jcarousel

我试图让 jcarousel 自动滚动浏览我的一些幻灯片，这是 HTML：

```
 <div id="slider">
    <ul>
      <li><img src="img/slides/slide_1.jpg" width="939" height="476" alt="" /></li>
      <li><img src="img/slides/slide_2.jpg" width="939" height="476" alt="" /></li>
    </ul>
  </div><!-- #slider --> 
```

这是javascript：

```
<script>
jQuery(document).ready(function() {
    jQuery('#slider').jcarousel({
        scroll: 1,
        auto: 2,
        wrap: 'circular'
    });
});
</script> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T12:47:18.987

通过更新 jcarousel 并仔细按照他们的示例解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T12:11:43.247

我遇到了上述问题，但我搜索了解决方案。我在我的工作网站上使用了这个滑块，我遇到了你上面描述的同样的问题，我通过尝试不同的东西来解决它。

我使用了以下代码：

```
jQuery(document).ready(function() {
    $('#slider').jcarousel({
        scroll: 1,
        auto: 2,
        wrap: 'last',
        initCallback: _init_carousel,
        buttonNextHTML: null,
        buttonPrevHTML: null
    });
}); 
```

# php - 缩短此功能

> ID：10723531
> 
> 赞同：0
> 
> 时间：2012-05-23T15:48:19.913
> 
> 标签：php, regex, url

我编写了这段代码来为链接准备一个标题，但我认为它有点笨重，我想知道是否有人对正则表达式有更好的理解，是否能够减少以下函数（通过合并相关的 preg_replaces）。我需要它来去除所有当前的连字符，去除多个空格，确保除了替换空格的连字符之外它只是字母数字，用单个连字符替换所有空格并确保字符串不以连字符开头：

```
function prepareURLTitle($title)
{

return preg_replace("/\A-/", "", str_replace(" ", "-", preg_replace("/[^a-zA-Z0-9\s]/", "", preg_replace('/\s\s+/', ' ', preg_replace('/\s?-/', '', $title)))));

} 
```

输入示例及其输出：

输入：

> 全新 - 手套，2 件装//此处有多个空格，但块引用不允许我显示它们

输出：

> 全新手套 2 件装

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:52:12.760

```
trim(preg_replace('`[^a-z0-9]+`i','-',str_replace("'",'',$title)),'-') 
```

我还用任何内容替换了引号，因此像“The cat's meow”这样的字符串不会变成“The-cat-s-meow”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T15:59:04.103

```
function prepareURLTitle($title)
{
   return preg_replace("[^A-Za-z0-9]+", "-", $title);
} 
```

这应该有效。您需要用单个“-”替换**多个**非字母数字字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:00:10.820

```
preg_replace('~[^a-z\d]+~i','-',preg_replace('~^[^a-z\d]+(.*?)[^a-z\d]+$~i','$1',$title));
// or
preg_replace(array('~^[^a-z\d]+(.*?)[^a-z\d]+$~i','~[^a-z\d]+~i'),array('$1','-'),$title); 
```

举个例子……</p>

```
$title = '  BRAND   NEW -   Gloves, 2 pack -  ';
echo preg_replace(array('~^[^a-z\d]+(.*?)[^a-z\d]+$~i','~[^a-z\d]+~i'),array('$1','-'),$title); 
```

将返回

> 全新手套 2 件装

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-23T15:51:44.040

```
function prepareURLTitle($title)
{
   return preg_replace( "/[^a-zA-Z0-9]/", "-",str_replace("-", "",  $title));
} 
```

演示：[http ://codepad.org/lPSQQBys](http://codepad.org/lPSQQBys)

输出：

> 全新--手套--2 件装

# r - R 中 50 个最近条目的平均值

> ID：10723533
> 
> 赞同：2
> 
> 时间：2012-05-23T15:48:22.690
> 
> 标签：r, mean

我有一个显示日期、项目和值的数据框，我想添加一列显示其先前 50 个条目的平均值（如果没有 50 个则为 NA），例如该表可能是

```
 data
date     item value  
01/01/01 a    2  
01/01/01 b    1.5  
04/01/01 c    1.7  
05/01/01 a    1.9  
...... 
```

它的一部分可能变成

```
date     item value last_50_mean   
........ 
11/09/01 a    1.2   1.1638
12/09/01 b    1.9   1.5843 
12/09/01 a    1.4   1.1621
13/09/01 c    0.9   NA
........ 
```

因此，在这种情况下，a 在 11/09/01 之前的 50 个条目中的平均值是 1.1638，而 c 在 13/09/01 之前没有 50 个条目，因此返回 NA

我目前正在使用以下功能执行此操作

```
 data[, 'last_50_mean'] <- sapply(1:nrow(data), function(i){
        prevDates <- data[data$date < data$date[i] & data$item == data$item[i], ]
        num       <- nrow(prevGames)
        if(nGames >= 50){
          round(mean(prevDates[(num- 49):num, ]$value), 4)
        }
      }
  ) 
```

但是我的数据框很大，而且需要很长时间（事实上，我不能 100% 确定它是否有效，因为它仍在运行……有谁知道最好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:25:11.917

N 个观测值的平均值可以通过累积总和以及第一个值和最后一个值之间的差值来计算`diff(cumsum(x), lag=N - 1)`。您的问题想要填充前 N - 1 个值，所以

```
meanN <- function(x, N=50)
    ## mean of last N observations, padded in front with NA
{
    x0 <- x[seq_len(length(x) - N + 1)]
    x1 <- (x0 + diff(cumsum(x), lag=N-1)) / N
    c(rep(NA, N - 1), x1)
} 
```

您想为多个组执行此操作。对于一个`data.frame`喜欢

```
df <- data.frame(item=sample(letters[1:3], 1000, TRUE),
                 value=runif(1000, 1, 3),
                 last_50_mean=NA) 
```

一种方法是

```
split(df$last_50_mean, df$item) <- lapply(split(df$value, df$item), meanN) 
```

导致例如

```
> tail(df)
     item    value last_50_mean
995     c 1.191486     2.037707
996     c 2.899214     2.073022
997     c 2.019375     2.054914
998     c 2.737043     2.066389
999     a 1.703752     1.923234
1000    c 1.602442     2.043517 
```

这假设您的数据框是按时间排序的。一个潜在的问题是当长向量溢出时`cumsum`；可以通过居中来解决这个问题，`value`因此期望`cumsum`不会偏离零太远。最近的一个问题解决[`split<-`](https://stackoverflow.com/questions/10645100/apply-a-function-to-groups-within-a-data-frame-in-r)了最后 N 个观察的替代方案和删除。

# visual-studio-2010 - 在实体框架设计器中创建标签和区域的东西？

> ID：10723534
> 
> 赞同：0
> 
> 时间：2012-05-23T15:48:28.297
> 
> 标签：visual-studio-2010, entity-framework-4.1, edmx-designer

我有这个关于 Visual Studio 2010 实体框架设计器的问题。是否有工具可以允许用户在实体设计器中创建区域或注释或类似的东西？我问这个是因为我有一个非常大的模型，并且有像彩色区域或带有注释的区域这样的东西会很有用，这样用户可以更好地阅读模型。

问候，贡萨洛。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:02:46.237

不。VS 11 有更好的设计器，它允许您将模型的不同部分分离为单独的图表并更改实体的颜色，但可能仍然无法添加标签。

# entity-framework - 无法转换 IQueryable AsEnumerable 因为 T 有一个 Guid 属性

> ID：10723536
> 
> 赞同：1
> 
> 时间：2012-05-23T15:48:34.423
> 
> 标签：entity-framework, linq, guid

我有以下 EF 课程：

```
class Product
{
   public Guid ProductGuid { get; set; }
   public string ProductName { get; set; }
} 
```

派生自 DB 类，其中`ProductGuid`是**uniqueidentifier**并且`ProductName`是**nvarchar**。

考虑`productContext`作为上下文：

```
var products = productContext.Products;
productList = products.ToList(); 

OR

productList = products.AsEnumerable(); 
```

第一条指令正确执行，第二条（两者）在运行时启动异常（它编译正确）：

> 无法将类型“System.Guid”转换为类型“System.Object”。LINQ to Entities 仅支持转换实体数据模型基元类型。

我尝试了一切它不起作用。我有其他带有 Guid 字段的表，但它从不启动此类异常。可能是什么原因？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-23T15:53:47.423

您真的需要在该属性中使用 GUID 类型吗？无论如何，字符串不会为你做吗？

尝试更换 GUID。改用字符串。

# android - 将内容包裹在盒子内

> ID：10723544
> 
> 赞同：0
> 
> 时间：2012-05-23T15:48:59.500
> 
> 标签：android, user-interface

如何将内容包装在盒子中？就像推特一样。

检查 Twitter 怎么样，我的怎么样：

[http://img17.imageshack.us/img17/8241/stackoverflow.png](http://img17.imageshack.us/img17/8241/stackoverflow.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:54:06.603

为了获得你想要走得更远的效果，你将不得不使用 9patch png 作为 ListView 的背景图像，并在 ListView 上设置填充以匹配 9patch 上边框的大小。9patch 应该看起来与 Twitter 示例中显示的背景完全相同。

[您可以在此处了解有关 9patches 的更多信息。](http://developer.android.com/guide/developing/tools/draw9patch.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T18:38:49.373

这是一种视错觉。您真的想创建三个 9 补丁 - 顶部项目、中间项目、底部项目。然后根据每个项目在列表中的位置动态设置其背景可绘制对象。只需确保您的边框在可绘制对象之间正确对齐，就可以了。

# php - 如何摆脱 PHP 脚本输出中的“Content-type: text/html”？

> ID：10723546
> 
> 赞同：3
> 
> 时间：2012-05-23T15:49:11.963
> 
> 标签：php

我将 PHP 脚本作为 cron 作业运行。如果脚本生成输出，则会触发一封电子邮件。不幸的是，即使它没有输出任何内容，也会触发一封电子邮件：

```
Content-type: text/html 
```

我怎样才能摆脱这种`Content-type: text/html`触发电子邮件的自动生成？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T15:53:06.727

使用`-q`php 命令上的开关：

```
php -q whatever.php 
```

这代表“安静”，并且会阻止 php 像通常那样输出 Web 标头。

或者，如果您想要更明确和更详细，您可以使用`--no-header`：

```
php --no-header whatever.php 
```

来源：[PHP 手册：命令行选项](http://php.net/manual/en/features.commandline.options.php)

# asp.net - 使用 sql 语句数据绑定 gridview edititemtemplate 下拉列表

> ID：10723553
> 
> 赞同：0
> 
> 时间：2012-05-23T15:49:27.847
> 
> 标签：asp.net, sql, gridview, drop-down-menu, templatefield

我有一个带有以下代码的gridview：

```
<asp:TemplateField HeaderText="Column1">
    <EditItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%# Bind("Column1") %>'></asp:Label>
    </EditItemTemplate>
    <ItemTemplate>
        <asp:DropDownList ID="DropDownList1" runat="server" Width="125px">
    </asp:DropDownList>
    </ItemTemplate>
</asp:TemplateField> 
```

我想绑定一个 sql 语句来填充下拉列表...

```
select Column1 from Table1 
```

我会通过后面的代码来做到这一点吗？任何信息表示赞赏？同样基于用户对此下拉列表所做的选择，我想用相应的数据填充下一列（column2）......也需要帮助......

我不熟悉模板字段，我可以在代码后面和通过 html 使用 gridview 绑定，但模板字段就像另一种语言......我感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:54:02.283

您的问题的答案有几个部分，我做了一些假设（您使用 Visual Studio 作为您的 IDE，您可以使用 VB 作为您的代码隐藏语言）：

> 我想绑定一个 sql 语句来填充下拉列表...

您可以在代码隐藏中或通过 Visual Studio GUI 执行此操作。虽然您可以为下拉列表使用绑定字段，但模板字段最终为您提供了更大的灵活性。我已经阅读了模板字段（[此处](http://msdn.microsoft.com/en-us/library/bb288032.aspx)），因为它将成为您使用 Gridview 进行基本数据显示之外的任何事情的朋友。使用 GUI，选择下拉列表应该会给您一个指向右上角的小箭头，这将允许您创建数据连接和数据源以绑定到您的下拉列表。

> 同样基于用户使用此下拉列表所做的选择，我想用相应的数据填充下一列（column2）

这有点复杂，因为您需要在 Dropdownlist 上触发 PostBack（使用 AutoPostBack），处理 Dropdownlist 的 SelectedIndexChanged 事件，在第二列中找到要更新的控件，并根据 selectedindex/item/ 更新该控件下拉列表中的值。有几种方法可以做到这一点，但这是我发现的最快的（使用 asp.net winforms）。我正在使用 SQL Adventureworks 数据库，在第 1 列的模板字段中使用employeeID 填充下拉菜单，并使用选定的employeeID 在第2 列中使用该employeeID 的managerID 填充标签。

```
<asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1" 
    EnableModelValidation="True" AutoGenerateColumns="False" 
    DataKeyNames="EmployeeID">
    <Columns>
        <asp:BoundField DataField="EmployeeID" HeaderText="EmployeeID" 
            InsertVisible="False" ReadOnly="True" SortExpression="EmployeeID" />
        <asp:TemplateField>
            <ItemTemplate>
                Select EmployeeID
                <asp:DropDownList ID="ddEmpID" runat="server" OnSelectedIndexChanged="ddEmpID_SelectedIndexChanged" 
                    DataSourceID="SqlDataSource1" DataTextField="EmployeeID" 
                    DataValueField="EmployeeID" AutoPostBack="True">
                </asp:DropDownList>
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Label ID="labManagerID" runat="server" Text="ManagerID"></asp:Label>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="Data Source=MyServer\Instance;Initial Catalog=AdventureWorks;Integrated Security=True" 
    ProviderName="System.Data.SqlClient" 
    SelectCommand="SELECT TOP(10) EmployeeID, ManagerID FROM HumanResources.Employee">
</asp:SqlDataSource> 
```

以及来自代码隐藏的 SelectedIndexChanged 事件：

```
Protected Sub ddEmpID_SelectedIndexChanged(sender As Object, e As EventArgs)
    Dim myDDList As DropDownList = CType(sender, DropDownList)
    Dim gvRow As GridViewRow = CType(myDDList.NamingContainer, GridViewRow)
    Dim myLabel As Label = CType(gvRow.FindControl("labManagerID"), Label)

    ' Create your sql query here to populate a data object and assign values throughout your row
        Dim myConnection As SqlConnection = New SqlConnection("Data Source=MyServer\Instance;Initial Catalog=AdventureWorks;Integrated Security=True")
        Dim myCmd As SqlCommand = New SqlCommand("Select ManagerID FROM HumanResources.Employee WHERE EmployeeID='" + myDDList.SelectedValue + "'", myConnection)

        If myConnection.State = ConnectionState.Closed Then myConnection.Open()
        myLabel.Text = myCmd.ExecuteScalar
        If myConnection.State = ConnectionState.Open Then myConnection.Close()

End Sub 
```

而且由于使用 Gridview 有时是一种自我鞭挞的练习，我建议手头有一些好的[演练教程](http://msdn.microsoft.com/en-us/library/aa479339)：

-J

# java - 从java中的URL读取UTF-8编码的XML

> ID：10723554
> 
> 赞同：1
> 
> 时间：2012-05-23T15:49:30.157
> 
> 标签：java, url, utf-8

我正在尝试从 Google 天气网络服务读取 XML 数据。响应包含一些西班牙语字符。问题是这些字符没有正确显示。我试图将所有内容都转换为 UTF-8，但这似乎没有帮助。代码如下

```
public static void main(String[] args) {
    try {
    URL url = new URL("http://www.google.com/ig/api?weather=Noja&hl=es");
    HttpURLConnection con = (HttpURLConnection) url.openConnection();

    BufferedReader in = new BufferedReader(new InputStreamReader(
    con.getInputStream(), "UTF-8"));
    String str = in.readLine();
    //this does not work even                        
    //String str = new String(in.readLine().getBytes("UTF-8"),"UTF-8");
    System.out.println(str);

    in.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
    }
} 
```

输出如下（修剪以使帖子保持在限制范围内）。注意“mi�”和s�b

修剪以保持最大字符限制

```
<day_of_week data="mi�"/><day_of_week data="s�b"/><low data="11"/><high data="16"/><icon data="/ig/images/weather/chance_of_rain.gif"/><condition data="Posibilidad de lluvia"/></forecast_conditions></weather></xml_api_reply> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:01:19.403

您的输入可能是正确的，尽管我会使用 XML 解析器来读取 XML，而不是尝试将其解释为逐行提要。但是，您的输出可能不正确。

1.  JVM 的默认字符编码是什么？检查（并设置）混淆命名的属性 `-Dfile.encoding=UTF-8`
2.  您的系统上是否存在必需的字体等？你能检查你输出的实际字符代码而不依赖你的终端设置吗？我怀疑可能是这种情况，因为编码/解码似乎有效，而您只是缺少那些单独的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:13:28.887

如果该页面是 xml，那么您通常应该将 InputStream 直接传递给 xml 解析器并让它自动检测编码。否则，您应该查看[内容类型响应标头](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html#getContentType%28%29)的 charset 参数以确定正确的编码并创建适当的 InputStreamReader。

**编辑：**该服务器确实以不同的编码响应浏览器和 java 客户端，可能取决于`Accept-Charset`请求标头。对于 Firefox，此标头具有值

```
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n 
```

这意味着两个字符集都被接受，没有一个偏好。服务器`Content-Type`以`text/xml; charset=UTF-8`. java 客户端不发送此标头，服务器以`text/xml; charset=ISO-8859-1`.

要使用服务器提供的字符集，您可以使用如下代码：

```
Matcher matcher = Pattern.compile("charset\\s*=\\s*([^ ;]+)").matcher(contentType);
String charset = "utf-8"; // default
if (matcher.find()) {
    charset = matcher.group(1);
}
System.out.println(con.getContentType());

BufferedReader in = new BufferedReader(new InputStreamReader(
    con.getInputStream(), charset)); 
```

**编辑2：**原来服务器根据用户代理标头决定要使用的字符集。如果添加以下行，它将以 utf-8 字符集响应。

```
con.setRequestProperty("User-Agent", "Mozilla/5.0"); 
```

无论如何，`Content-Type`响应标头包含要使用的正确字符集。

# c# - 从 IDbConnection 实例实例化 IDataAdapter

> ID：10723558
> 
> 赞同：16
> 
> 时间：2012-05-23T15:49:38.863
> 
> 标签：c#

我有一个 IDbConnection 实例，它可以是任何连接、Sql、OleDb 等。我想做一个通用包装器，这样我就可以向包装器发送一个连接并获得一组很好的方法以便于操作。我有一个 Query 方法，我希望它返回一个 DataTable，所以我可以这样做

```
IDataAdapter adapter = new OleDbDataAdapter();
adapter.SelectCommand = myCommand;
DataSet ds = new DataSet();
adapter.Fill(ds); 
```

问题是我必须使用 OleDbAdapter 并且它不适用于 SQL，我真的不想编写“驱动程序特定”代码。有没有办法从我实例化的 IDbConnection 对象中获取 IDataAdapter 实例？我知道我可以创建一个命令

```
IDbCommand command = _connection.CreateCommand(); 
```

认为必须有一些简单的方法来对 IDataAdapter 执行相同操作是合乎逻辑的。

编辑：

```
using (var reader = command.ExecuteReader())
{
    var dataTable = new DataTable();
    dataTable.Load(reader);
} 
```

嗯，不完全是我要求的，而是一个很好的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T17:06:04.633

这是一个粗略的示例，说明如何使用反射获取适配器。

```
IDataAdapter GetAdapter(IDbConnection connection) {
    var assembly = connection.GetType().Assembly;
    var @namespace = connection.GetType().Namespace;    

    // Assumes the factory is in the same namespace
    var factoryType = assembly.GetTypes()
                        .Where (x => x.Namespace == @namespace)
                        .Where (x => x.IsSubclassOf(typeof(DbProviderFactory)))
                        .Single();

    // SqlClientFactory and OleDbFactory both have an Instance field.
    var instanceFieldInfo = factoryType.GetField("Instance", BindingFlags.Static | BindingFlags.Public);
    var factory = (DbProviderFactory) instanceFieldInfo.GetValue(null);

    return factory.CreateDataAdapter();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-13T17:39:34.917

我有同样的问题。这就是我解决它的方法

```
private DataSet executeDataQuery(string query, string connection, string provider, out Exception ex) {
        DataSet ds = new DataSet();
        ex = null;
        DbProviderFactory dbFactory = DbProviderFactories.GetFactory(provider);
        IDbConnection dbConnection = dbFactory.CreateConnection();
        dbConnection.ConnectionString = connection;
        using (dbConnection) {
            try {
                IDbDataAdapter dbAdapter = dbFactory.CreateDataAdapter();
                IDbCommand dbCommand = dbConnection.CreateCommand();
                dbCommand.CommandText = query;
                dbCommand.CommandType = CommandType.Text;
                dbAdapter.SelectCommand = dbCommand;
                dbAdapter.Fill(ds);
            }
            catch (Exception exc) {
                ex = exc;
            }
            finally {
                if (dbConnection.State == ConnectionState.Open) {
                    dbConnection.Close();
                }
            }
        }
        return ds;
    } 
```

# java - 如何从其他应用程序调用警报？

> ID：10723562
> 
> 赞同：-1
> 
> 时间：2012-05-23T15:49:57.073
> 
> 标签：java, android, alarm, provider

我正在创建 Android 应用程序，它将在给定时间通知用户阅读书籍，我需要创建什么以便警报和应用程序将在给定时间触发此警报，可能有超过 1 个警报，当出现对话框时它应该显示我2 个选项，如 Read（这应该直接转到 MyApp）和 Cancel，所以我的问题是如何在 Android 中做到这一点。任何想法将不胜感激。预先感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:52:52.327

你可能想看看这个：

[http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html)

这是关于如何在 Android 上安排活动的一个很好的示例：

[http://justcallmebrian.com/?p=129](http://justcallmebrian.com/?p=129)

# objective-c - Cocoa Mac App - 在哪里保存令牌？

> ID：10723564
> 
> 赞同：1
> 
> 时间：2012-05-23T15:50:01.877
> 
> 标签：objective-c, macos, cocoa

我有一个带有 GitHub 登录名的 Cocoa Mac 应用程序。

问题很简单：我应该在哪里存储访问令牌？我希望应用程序在退出后恢复并且需要一个存储令牌的好地方。

另一个好问题：如何将登录信息存储在我的钥匙串中？

# joomla - 标题旁边的铅笔图标不会出现在 Joomla 网站中

> ID：10723568
> 
> 赞同：0
> 
> 时间：2012-05-23T15:50:12.783
> 
> 标签：joomla

嗨，我在一个 Joomla 网站中遇到了一个问题，我是编辑。

当我登录时，我看不到允许我更改 Joomla 网站内容的小铅笔。我有权更改内容，但似乎我不能。

还有一个问题......

如何在该网站上查看我的帐户设置以便更改编辑器？它确实向我显示了帐户设置，但我似乎再也看不到了。

附言。我无权访问 joomla 的管理员页面，他们只是让我在网站上编辑。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:41:36.257

他们必须让您访问前端编辑器 - 询问您的管理员。他们可能已将其关闭。

如果他们允许您查看您的个人资料页面，您也许可以设置编辑器……这又是一个管理员问题。

# iphone - 如何在 iPhone 中启动应用程序之前检查特定站点的网络连接是否可用？

> ID：10723578
> 
> 赞同：1
> 
> 时间：2012-05-23T15:51:19.953
> 
> 标签：iphone, networking

我正在开发一个基于 Web 的应用程序，只有在我的服务器为特定主机启动时才需要启动该应用程序。如果网络连接不可用，我计划显示警报视图以重新启动应用程序。我正在使用这个：

```
 NSURL *scriptUrl = [NSURL URLWithString:@"http://lmsstaging.2xprime.com"];
    NSData *data = [NSData dataWithContentsOfURL:scriptUrl];

    if (data != nil) {
//Launch my application
}
else {
//show an alert
} 
```

但问题是，当我单击警报视图中的“确定”按钮时，我希望我的应用程序退出。这是正确的方法吗？有人可以建议任何其他选择来克服这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:04:14.923

没有“官方”的退出方式。Apple 建议您在警报中这样说：“此应用程序需要网络连接。按主页按钮退出。”

# c# - 肥皂请求中的 SCF 服务消息合同命名空间

> ID：10723581
> 
> 赞同：0
> 
> 时间：2012-05-23T15:51:22.760
> 
> 标签：c#, wcf, soap

我有 WCF 服务，并且有类似的标签

```
<DataAttributes>
   <DataAttribute>
      -- Some Data Here --
   </DataAttribute>
   <DataAttribute>
      -- Some Data Here --
   </DataAttribute>
</DataAttributes> 
```

我在 SoapUI 中测试了我的服务，但它显示的合同有一些扩展：

```
<MyServiceNS:DataAttributes>
   <MyServiceNS:DataAttribute>
      -- Some Data Here --
   </DataAttribute>
   <MyServiceNS:DataAttribute>
      -- Some Data Here --
   </DataAttribute>
</DataAttributes> 
```

但我希望我的合同显示为合同中的样子。如果有人可以提供解决方案，请提前致谢。

我正在使用 [MessageContract]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:59:58.690

两个样本都是相同的（假设第一个样本之前有一个默认命名空间）。前缀与默认命名空间应该无关紧要。

# php - 在php中忽略大小写

> ID：10723589
> 
> 赞同：0
> 
> 时间：2012-05-23T15:51:54.700
> 
> 标签：php, arrays

我正在使用 in_array() 函数从正在获取数据库值的数组中搜索文本

$value 是数组值。

我怎么能忽略这种情况。

```
if(in_array($exp[$i],$value)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:54:07.460

在比较中将其转换为所有大写/小写

```
if(in_array($exp[$i], strtoupper($value))) 
```

编辑：我猜这个 $exp[$i] 也需要不区分大小写，那么

```
if(in_array(strtoupper($exp[$i]), strtoupper($value))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:55:19.423

使用[preg_grep()](http://php.net/manual/en/function.preg-grep.php)代替：

```
if( preg_grep( "/" . $exp [$i] . "/i" , $value ) ) 
```

（在`i`之后添加的修饰符`/`使其不区分大小写）

但是，由于它似乎不是数组值，因此您不应该使用[in_array()](http://php.net/manual/en/function.in-array.php)，而是[stristr()](http://php.net/manual/en/function.stristr.php)：

```
if ( stristr ($value, $exp [$i])) 
```

（[strstr()是](http://php.net/manual/en/function.stristr.php)[strstr()](http://php.net/manual/en/function.strstr.php)的不区分大小写版本，它在另一个字符串中查找一个字符串的第一次出现）

# php - 会话目录的权限

> ID：10723599
> 
> 赞同：2
> 
> 时间：2012-05-23T15:52:34.857
> 
> 标签：php, session, permissions

我的服务器面临一个问题，即 php 会话无法存储数据。现在，我将会话目录权限更改为 777。任何人都可以确认此权限是正确且安全的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:05:14.430

正如用户 prehfeldt 所说，“正确和安全”取决于上下文。重要的是，正如我从您的问题中了解到的那样，您已经自定义了保存 php 会话的目录。这是一个很好的做法，尤其是在您使用共享主机的情况下。由于会话目录未放置在您的公用文件夹中（使其可供任何人访问），因此您设置的权限应该不是问题。

无论如何，所需的最低权限是代表服务器的用户的读/写权限（通常对于 apache apache 使用所有者和组 www-data 运行，但这可能并非所有 linux 服务器发行版的情况）。

# zope - gunicorn + zope 错误处理

> ID：10723604
> 
> 赞同：2
> 
> 时间：2012-05-23T15:52:51.340
> 
> 标签：zope, gunicorn

我们正在尝试设置 gunicorn + plone。到目前为止它运行良好，但无法处理错误（404、500 等）并抛出“内部服务器错误”，而它应该返回 plone 的错误页面。

下面粘贴了请求一个不存在的页面的示例。问题是应该如何设置 gunicorn，以便 zope/plone 自己处理错误，就像其他请求一样？

欢呼和问候

```
==> var/log/gunicorn-stdout---supervisor-JhaTfg.log <==
2012-05-24 01:41:16 [15137] [ERROR] Error handling request
Traceback (most recent call last):
  File "/home/user/testing/eggs/gunicorn-0.14.3-py2.6.egg/gunicorn/workers/sync.py", line 100, in handle_request
    respiter = self.wsgi(environ, resp.start_response)
  File "/home/user/testing/eggs/repoze.retry-1.0-py2.6.egg/repoze/retry/__init__.py", line 90, in __call__
    app_iter = self.application(environ, replace_start_response)
  File "/home/user/testing/eggs/repoze.tm2-1.0b2-py2.6.egg/repoze/tm/__init__.py", line 24, in __call__
    result = self.application(environ, save_status_and_headers)
  File "/home/user/testing/eggs/repoze.vhm-0.14-py2.6.egg/repoze/vhm/middleware.py", line 106, in __call__
    return self.application(environ, start_response)
  File "/home/user/testing/eggs/Zope2-2.13.13-py2.6.egg/ZPublisher/WSGIPublisher.py", line 255, in publish_module
    response = _publish(request, 'Zope2')
  File "/home/user/testing/eggs/Zope2-2.13.13-py2.6.egg/ZPublisher/WSGIPublisher.py", line 185, in publish
    object = request.traverse(path, validated_hook=validated_hook)
  File "/home/user/testing/eggs/Zope2-2.13.13-py2.6.egg/ZPublisher/BaseRequest.py", line 518, in traverse
    return response.notFoundError(URL)
  File "/home/user/testing/eggs/Zope2-2.13.13-py2.6.egg/ZPublisher/HTTPResponse.py", line 718, in notFoundError
    "<p><b>Resource:</b> %s</p>" % escape(entry))
NotFound:   <h2>Site Error</h2>
  <p>An error was encountered while publishing this resource.
  </p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:40:06.730

关于我的问题，我忘了提到我们正在使用 WSGI Zope 和 gunicorn。

在我们的场景中，我们修补了 ZPublisher/WSGIPublisher.py 以正确处理 NotFound 异常 (404)，而不是抛出 500 Internal Server Error。

结果表明 Zope + Wsgi 还没有那么成熟（至少在错误处理方面）。

# javascript - JSON 日期中的一小时偏移量

> ID：10723607
> 
> 赞同：1
> 
> 时间：2012-05-23T15:52:56.837
> 
> 标签：javascript, json, datetime, date

为什么会这样？

```
 new Date(2013, 5, 30).toJSON()
"2013-06-29T23:00:00.000Z" 
```

它看起来像一个小时的偏移量。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:57:28.597

在进行调查后，我恢复了这个答案。

您看到的`toJSON()`日期是 Z(ULU) 时区，也就是 UTC，而`Date`使用您的本地时区。

执行此操作时很容易发现差异：

```
new Date().getTimezoneOffset(); // should return -60 (minutes) in your case 
```

顺便说一句，夏令时会影响您所看到的，但这不是原因。

# c# - HttpWebRequest 和失去连接

> ID：10723611
> 
> 赞同：0
> 
> 时间：2012-05-23T15:53:05.260
> 
> 标签：c#, .net, httpwebrequest

我正在使用 HttpWebRequest.BeginGetRequestStream 向远程服务器发出 POST 请求。我们假设在这个过程中网络连接丢失并且没有收到响应。有什么方法可以检测请求是否发送到远程服务器？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:58:42.007

没有任何响应，就无法知道服务器接收和处理了什么。您需要在应用程序层处理此问题，并使用您确实收到其响应的另一个请求。

也就是说，您将检测到连接丢失并且您没有收到响应，因此您的应用程序发送另一个请求，或者重复相同的请求（服务器必须正确处理）或发送查询“您收到了吗？使用事务 ID XYZ 处理该请求？”。

# ruby - 如何从 ruby 中的字符串中检索 GUID 和值

> ID：10723615
> 
> 赞同：0
> 
> 时间：2012-05-23T15:53:19.423
> 
> 标签：ruby, regex

我在Ruby中有一个这样的字符串

```
word=0 id=891efc9a-2210-4beb-a19a-5e86b2f8a49f 
```

如何从该字符串中获取 word 和 id 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:01:36.373

这是一种可行的方法 - 通过空格和等号字符 ( ) 将目标字符串拆分为标记，并从中`tokens=str.split(/[= ]/)`创建一个哈希 ( `Hash[*tokens]`)。结果[是 a`Hash`](http://www.ruby-doc.org/core-1.9.3/Hash.html)，其键是等号之前的标记，值是等号之后的标记：

```
s = 'word=0 id=891efc9a-2210-4beb-a19a-5e86b2f8a49f'
h = Hash[*s.split(/[= ]/)]
h # => {"word"=>"0", "id"=>"891efc9a-2210-4beb-a19a-5e86b2f8a49f"}
h['word'] # => "0"
h['id'] # => "891efc9a-2210-4beb-a19a-5e86b2f8a49f" 
```

当然，如果您的“键”或“值”包含等号或空格，它会中断，但它适用于您的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:57:20.620

这应该有帮助！

```
s = "word=0 id=891efc9a-2210-4beb-a19a-5e86b2f8a49f"

data = {}

s.scan(/(\w+)(?=\=)\=([^\s]+)/).each do |pair|
  key, value = pair
  data[key.to_sym] = value
end

puts data.inspect    
#=> {"word"=>"0", "id"=>"891efc9a-2210-4beb-a19a-5e86b2f8a49f"}

puts data[:word]
#=> 0

puts data[:id]
#=> 891efc9a-2210-4beb-a19a-5e86b2f8a49f 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T15:59:09.263

```
string="word=0 id=891efc9a-2210-4beb-a19a-5e86b2f8a49f"

word,id = string.match(/word=(.*) id=(.*)/).captures 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-20T22:38:51.627

我会使用一些简单的东西，例如：

```
str = 'word=0 id=891efc9a-2210-4beb-a19a-5e86b2f8a49f'
word, id = str.scan(/=(\S+)/).flatten # => ["0", "891efc9a-2210-4beb-a19a-5e86b2f8a49f"] 
```

您想要的每个值前面都有，`=`因此请使用它作为值的占位符。`(...)`在正则表达式中使用捕获告诉`scan`创建一个新的子数组，因此`flatten`将子数组提升回标准数组元素：

```
'foo'.scan(/(o)/) # => [["o"], ["o"]]
'foo'.scan(/(o)/).flatten # => ["o", "o"] 
```

# jquery - 使用隐藏字段防止通过表单提交垃圾邮件

> ID：10723616
> 
> 赞同：1
> 
> 时间：2012-05-23T15:53:19.997
> 
> 标签：jquery, forms, spam

我的老板讨厌验证码，而且我也讨厌验证码，即使他们工作。相反，她建议使用隐藏字段，以便如果 [由机器人] 填写，则不应提交表单。这种方法有缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T22:52:31.467

您描述的方法通常称为[蜜罐](http://en.wikipedia.org/wiki/Honeypot_%28computing%29)。虽然过去有些网站已经取得了成功，但您的结果将根据向您的网站发送垃圾邮件的价值而有所不同。此外，随着蜜罐的广泛采用，垃圾邮件发送者正在使用更智能的软件来绕过这些类型的陷阱。我建议你看看这个[工作量证明服务](https://www.spamcaptcher.com/captcha/faq.jsp#what_is_proof_of_work)，它可以让你使用更好的机器人对抗技术，这些技术对你的用户来说仍然是不可见的。也就是说，对于具有严重安全隐患的事情（例如忘记密码），我强烈建议您使用 CAPTCHA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:47:33.660

您可以通过交换提交按钮和取消按钮的功能来欺骗任何机器人：

```
$('form').submit(function(e){
    e.preventDefault();
    // remove user values
});
$('button').click(function(e){
    e.preventDefault();
    var data = $('form').serializeArray();
    data['human'] = true; // hidden value
    $.post('example.com', data);
}); 
```

# c# - ListView 所有者绘图和列自动调整大小

> ID：10723619
> 
> 赞同：0
> 
> 时间：2012-05-23T15:53:28.627
> 
> 标签：c#, listview, autoresize

我有一个[`ListView`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)使用所有者绘图为某些子项目绘制附加内容的方法。

我发现因为这个额外的内容占用了一些额外的空间，所以列表视图现在错误地计算了列“自动调整大小”的宽度，因此当有人自动调整某些列的大小（例如，通过双击列调整大小句柄）时，列已调整大小以使其太小，并且该列表视图中的文本在末尾用括号 (...) 呈现。

有没有一种方法可以提示列表视图询问我在自动调整大小期间列的大小应该是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:08:47.383

没有一条消息可以告诉您何时要自动调整列的大小。但正如您所提到的，用户只能通过两种方式触发它：双击分隔线和`Ctrl-Shift-+`. 你可以拦截这两个，然后做任何你喜欢的事情。

步骤#1：要拦截双击，您需要子类`ListView`化并监听`HDN_DIVIDERDBLCLICK`通知：

```
protected override void WndProc(ref Message m) {
    switch (m.Msg) {
        case 0x4E: // WM_NOTIFY
            if (!this.HandleNotify(ref m))
                base.WndProc(ref m);
            break;
        default:
            base.WndProc(ref m);
            break;
    }
}

protected bool HandleNotify(ref Message m) {

    const int HDN_DIVIDERDBLCLICKW = (HDN_FIRST - 25);

    NativeMethods.NMHEADER nmheader = (NativeMethods.NMHEADER)m.GetLParam(typeof(NativeMethods.NMHEADER));

    switch (nmheader.nhdr.code) {

        case HDN_DIVIDERDBLCLICKW:
            if (nmheader.iItem >= 0 && nmheader.iItem < this.Columns.Count) {
                this.AutoResizeColumn(nmheader.iItem);
                m.Result = (IntPtr)1; // prevent the change from happening
                return true;
            }
            break;

        default:
            break;
    }

    return false;
} 
```

当然，您必须实施`AutoResizeColumn()`才能做您想做的事。

第2步。要拦截 Ctrl-Shift-+，您需要覆盖`ProcessKeyPreview`. [本文](http://www.codeproject.com/Articles/22570/Overriding-Keydown-in-a-User-Control-using-Process "本文")将向您展示如何做到这一点。在您的覆盖中，您将调用`AutoResizeColumn()`每一列。

## 替代方法

如果您构造您`ListViewItems`的每个子项是一个与您想要拥有的数据相同长度的“W”字符串，则控件将使用这些字符串来自动计算该列。这可能是一种更简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:20:45.320

***您可以在以下两个场景中手动执行此操作：***

* * *

*   **如果你想修复 a`minimumWidth`和`maximumWidth`,**

    在以下情况下使用`ColumnWidthChanging`它`ListView`：

```
 int minimumWidth = 200;
   int maximumWidth = 500;
   if (e.NewWidth  maximumWidth)
   {
      e.Cancel = true;
      e.NewWidth = maximumWidth;
   }
```

* * *

*   **如果要修复 a `ColumnWidth`，请`ListViewColumn`设置所需的`ColumnWidth`**

    在以下情况下使用`ColumnWidthChanging`它`ListView`：

```
 ListView ColumnList = sender as ListView;
   e.Cancel = true;
   e.NewWidth = ColumnList.Columns[e.ColumnIndex].Width;
```

# android - android合并2张图片

> ID：10723621
> 
> 赞同：0
> 
> 时间：2012-05-23T15:53:41.887
> 
> 标签：android, xml, merge

我正在为此工作几个小时，但无法解决。我想在一个 XML 文件中合并 2 个图像 - 所以这将是我的形状的基本 xml 文件。我希望这个形状包括一个作为框架的 png 和一个作为框架内的图片的 png。那幅画会动态变化。

我尝试使用标签来构建我的形状，但是当我将它包含到我的主 xml 文件中时它失败了，因为我只能以 root 身份使用合并。尝试做同样的事情，但仍然没有得到我想要的......

我该怎么做才能合并这两个 png，并能够在框架 png 内设置内部 png 位置？

编辑：一些代码：

```
<ImageView  
    android:layout_width="match_parent" 
    android:layout_height="match_parent"             
    android:src="@drawable/userprofilepicture"
    android:scaleType="fitXY" 
    android:contentDescription="@string/SmallLogo" />

<ImageView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:contentDescription="@string/SmallLogo"
    android:scaleType="fitXY"
    android:padding="30dp"
    android:src="@drawable/questionmark" />

</FrameLayout> 
```

这是我的框架和内部图片 xml 源.. 在图形布局中查看它时看起来不错。当将它包含在我的主 xml 文件中时，由于某种原因它会翻转图像...... ???

这是我的主要 xml 的一部分：

```
 <TableRow>

        <ImageView
            android:layout_gravity="center_vertical"
            android:layout_marginTop="2.5dp"
            android:contentDescription="@string/SmallLogo"
            android:src="@drawable/logosmall" />

        <ImageView
            android:layout_gravity="center_vertical"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="2.5dp"
            android:contentDescription="@string/slogen"
            android:src="@drawable/slogen" />

        <include layout="@drawable/userprofilepicture"
            android:layout_width="30dp"
            android:layout_height="30dp"/>

    </TableRow> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:08:41.553

您是否考虑过使用[9-patch](http://developer.android.com/reference/android/graphics/NinePatch.html)和自定义布局？这是一个[例子](https://stackoverflow.com/a/7767410/843859)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:10:02.883

创建一个 FrameLayout 自定义类。此类将具有框架布局的所有 XML 属性。

```
com.package.example;

public class PictureFrame extends FrameLayout {

    public PictureFrame(Context c, AttributeSet attrs) {
        super(c, attrs);
        LayoutInflater inflater = (LayoutInflater) c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        //This adds the image views as you've styled them in the XML file
        inflater.inflate(R.layout.myFrameImages, this);
    }

    public void setInnerImage(int resource) {
        ImageView ivInner = (ImageView) findViewById(R.id.innerImage);
        ivInner.setImageResource(resource);
    }

} 
```

您的 XML 文件看起来像

```
<ImageView
     android:src="@drawable/myFrameImage"
     android:layout_height="fill_parent"
     android:layout_width="fill_parent"
     android:scaleType="fitXY"/>
<ImageView
     android:src="@drawable/myInnerImage"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:scaleType="fitXY"
     android:layout_margin="10dp"
     android:id="@+id/innerImage"/> 
```

您也可以在 XML 中声明时创建自己的 XML 属性，因此可以直接在 xml 中声明内部图像。如果您需要帮助，您必须与我联系或发布另一个问题。

# c# - 自定义地图路线

> ID：10723628
> 
> 赞同：8
> 
> 时间：2012-05-23T15:53:52.807
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-routing, maproute

我正在尝试创建一些自定义地图路线，但无法使其正常工作。

我的最终目标是能够指定如下内容。在哪里，我基本上用“id”和“name”的值对构造了我的 URL。该名称无关紧要，仅用于取悦用户，尽管我需要控制器中的 ID。

> /dashboards/5-My-Estate-name/89-My-subgroup-name/133-Maybe-even-another-subgroup

对于初学者，我正在研究第一部分并且遇到了麻烦。

在使用以下路由时浏览到“http://localhost:53933/dashboards/109-building-xyz”会产生错误`A public action method '109-building-xyz' was not found on controller 'MyInterfaceInterface.Controllers.DashboardsController'.`

```
routes.MapRoute(
  "Dashboard",
  "dashboards/{id}-{name}", // URL pattern
   new { controller = "Dashboards", action = "Index" },
   new { id = @"\d+", name = UrlParameter.Optional }
); 
```

显然，我希望将其路由到带有参数的 Index 函数。

我究竟做错了什么？我是否正确地构建了这个？我来自 web-PHP 背景并使用 htaccess 来实现这样的事情。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T16:10:13.903

路线的顺序很重要。MVC 将使用与 URL 模式匹配的模式匹配第一个声明的路由。

所以如果你有这个：

```
routes.MapRoute(
  "Default",
  "{controller}/{action}/{id}", // URL pattern
   new { controller = "Home", action = "Index" },
   new { id = UrlParameter.Optional }
);
routes.MapRoute(
  "Dashboard",
  "dashboards/{id}-{name}", // URL pattern
   new { controller = "Dashboards", action = "Index" },
   new { id = @"\d+", name = UrlParameter.Optional }
); 
```

然后 URL 会发生什么`http://localhost:53933/dashboards/109-building-xyz`，MVC 会将“仪表板”匹配到控制器，将“109-building-xyz”匹配到操作。

您需要始终先声明最具体的路线，然后再声明更一般的路线，如下所示：

```
routes.MapRoute(
  "Dashboard",
  "dashboards/{id}-{name}", // URL pattern
   new { controller = "Dashboards", action = "Index" },
   new { id = @"\d+", name = UrlParameter.Optional }
);
routes.MapRoute(
  "Default",
  "{controller}/{action}/{id}", // URL pattern
   new { controller = "Home", action = "Index" },
   new { id = UrlParameter.Optional }
); 
```

然而，Morten Mertner 在他的评论中是正确的——我认为你不能有 2 个不被正斜杠分隔的路由参数。您需要将您的 URL 模式更改为类似这样，以便将其与默认路由引擎一起使用：

```
"dashboards/{id}/{name}" 
```

# c++ - 将 Qt 与 Eclipse 一起使用，#include 导致找不到文件

> ID：10723632
> 
> 赞同：0
> 
> 时间：2012-05-23T15:54:04.647
> 
> 标签：c++, eclipse, qt, include, qmake

所以我开始了一个新的Qt控制台项目；

到目前为止一切正常。我已经使用集成设置了 Eclipse，但我实际上并没有使用它，我只是包含了相关的 Qt 目录，以便我的`#include <QtGui>`调用工作。

到目前为止，这些都运行良好。

我可以使用 eclipse 的构建选项编译它，或者通过做

```
qmake -project
qmake
make 
```

从命令行。两者都有效。

我拥有的包含语句；是：

```
#include <QtGui>
#include <QApplication> 
```

在两个不同的文件中。

如果我添加另一个，即`#include <QSqlDatabase>`Eclipse 识别包含，并让我初始化新变量，并使用 QSqlDatabase 类。一切似乎都很好 -[见这里 - 日食截图](http://i.imgur.com/WlhTq.jpg)

但是，当我构建项目时，它决定它看不到文件[，即使它们都在那里](http://i.imgur.com/g0jZj.jpg)，也[可以在终端中看到它们](http://i.imgur.com/5ZJSe.jpg)。然后[eclipse到处都放红线](http://i.imgur.com/IKEbk.jpg)。

如果我进入目录，并尝试通过终端完成所有操作，使用`qmake -project; qmake; make`然后我会得到相同的错误。

但是，如果我进入由`.pro`创建的文件`qmake -project`，并添加行`QT += sql`，然后执行`qmake; make`，那么一切都很好并且可以正常工作。

为什么`qmake -project`要从项目文件中遗漏这些文件？我真的不想每次构建它时都必须进入并手动添加该行......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:35:19.683

> 为什么 qmake -project 从项目文件中遗漏了这些文件？

据我所知，qmake 不应该取代人类程序员。如果你想知道为什么它没有检测到 SQL 依赖，你可以阅读 qmake 源代码。

> 我真的不想每次构建它时都必须进入并手动添加该行......

听起来你想在这里做一些奇怪的事情。您无需在每次构建之前调用 qmake -project。

`qmake -project`生成**初始**项目 - *pro 文件。生成初始项目后，您可以对其进行调整，并根据需要添加选项或一些宏魔术。然后，使用 *.pro 文件为构建系统生成脚本（用于 windows 的 vcproj、用于 windows/*nix 的 makefile、nmake make 文件等）。

工作流程是这样的：

1.  `qmake -project`.
2.  永远重复：
    2.1。根据您的喜好修改生成的 *.pro 文件。
    2.2 `qmake`
    2.3 使用您的构建系统构建。（nmake、make、visual studio等）

要简单地“构建”，您所要做的就是#2.3。仅当您修改 *.pro 文件时才调用`qmake`（不带 -project）开关。

有关更多信息，请参阅 qt[文档](http://doc.qt.nokia.com/)和教程。

# javascript - Date 对象是否曾经使用过非公历？

> ID：10723638
> 
> 赞同：10
> 
> 时间：2012-05-23T15:54:12.633
> 
> 标签：javascript, date, calendar

Javascript 中的对象是否`Date`曾经使用过非公历？

[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)和[MSDN](http://en.wikipedia.org/wiki/UTC)文档概述了对象上的方法并`Date`参考[UTC](http://en.wikipedia.org/wiki/UTC)和[IETF 兼容的 RFC 2822 时间戳](https://www.rfc-editor.org/rfc/rfc2822#page-14)。

维基百科文章提到

> 日期通常使用公历来标识，但也可以使用儒略日数。

MDN 和 MSDN 文档只是说非 UTC 方法是指“本地时间”，但没有定义“本地时间”是什么。

我正在与一个 web 服务接口，它给我一些数据，其中包括一年中的一天字段，我需要将其与当前的一年中的一天进行比较。我很清楚依赖用户机器上的准确时间的缺陷，并且对由错误的时区和虚假日期设置导致的任何问题都很好。

不过，我担心不使用公历的语言环境中的用户，以及如果我使用 、 和 方法计算一年中的日期，他们的浏览器会`.getDate()`返回`.getMonth()`什么`.getFullYear()`。

那么，在实践中，Javascript 中的“本地时间”是否曾经指代非公历系统，例如希伯来历或波斯历？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:46:30.987

我刚刚通过将我的计算机 (Mac OS X 10.7.4) 设置为使用希伯来日历进行了测试，并且 Date 对象的行为在 Safari、Firefox 或 Chrome 中没有受到影响。看起来它总是使用公历。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:46:39.663

Re: Javascript 中的 Date 对象是否曾经使用过非公历？

不。我没有看到任何关于 Javascript 日期对象可以使用儒略历系统的说法的备份。

但是，您可以将 Javascript 日期对象（公历日期）转换为[Julian Day](http://javascript.about.com/library/bljulday.htm)或[Julian Date](http://javascript.about.com/library/bljuldate.htm)。

**朱利安日**

> > 儒略日用于天文学界科学使用的儒略日期 (JD) 时间测量系统，表示自公元前 4713 年 1 月 1 日格林威治中午以来的时间间隔（以天和一天的分数为单位）。朱利安日期被国际天文学联合会推荐用于天文学。

**朱利安日期**

> > 儒略日期一词被广泛用于指一年中的某一天（序数日期），尽管这种用法并不严格符合某些国际组织制定的标准。

*以上引用的来源是维基百科文章，[Julian_day](http://en.wikipedia.org/wiki/Julian_day)

请注意，这两种格式都不涉及月份，因为“儒略日”和“儒略日”是公历中一天的特定表示形式。您可以通过儒略日定义使用公历日期来说明这一点：“4713 BC Greenwich noon”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T20:37:36.070

从[ECMAScript](http://www.ecmascript.org/)规范（[第 3 版](http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf)和[第 5 版](http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262%205th%20edition%20December%202009.pdf)在这方面几乎相同，但我引用第 5 版）：

> **15.9.1.9 当地时间**
> 
> 从 UTC 到本地时间的
> 
> `LocalTime(t) = t + LocalTZA + DaylightSavingTA(t)`
> 
> 转换由 定义 从本地时间到 UTC 的转换由
> 
> `UTC(t) = t – LocalTZA – DaylightSavingTA(t – LocalTZA)`
> 
> Note定义，`UTC(LocalTime(t))`不一定总是等于`t`。

`LocalTZA`指本地时区调整，`DaylightSavingTA`是针对夏令时的调整。

我没有发现任何浏览器（当前或历史）的证据，当在用户的机器上启用非公历时会做任何不同的事情。

# c# - 使用列表作为gridview的数据源时，如何在列表中设置列名？

> ID：10723643
> 
> 赞同：0
> 
> 时间：2012-05-23T15:54:25.800
> 
> 标签：c#, asp.net

基本上我有一个使用列表作为数据源的gridview。如何告诉gridview列表中的哪一列是哪一列？

```
 // Regions
        Dictionary<int, string> regions = (Master as SiteMaster).getCustomerRegions((Master as SiteMaster).userBasic_XsiteCustomerID);
        List<List<string>> regionsList = new List<List<string>>();
        foreach (int curRegionID in regions.Keys)
        {
            List<string> curRegion = new List<string>();
            Dictionary<string, string> curRegionDetail = (Master as SiteMaster).getRegionDetail(curRegionID);
            curRegion.Add(curRegionID.ToString());
            curRegion.Add(curRegionDetail["regionName"]);
            regionsList.Add(curRegion);
        }
        grv_regionManagement.DataSource = regionsList;
        grv_regionManagement.DataBind(); 
```

所以它给我一个错误，说 regionID 没有定义，这是有道理的，因为没有地方告诉 gridview 第一列实际上是 regionID。

这是 ASP.NET 中用于定义 regionID 字段的代码：

```
 <asp:TemplateField HeaderText="regionID" InsertVisible="False" 
                SortExpression="regionID" Visible="False">
                <EditItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# Bind("regionID") %>'></asp:Label>
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label2" runat="server" Text='<%# Bind("regionID") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:43:42.020

而不是字符串列表的列表，而是具有将列作为属性的对象列表。您可以将这些属性用作每列的数据源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T17:52:35.143

如果您愿意放弃列表，则从您的列表中形成一个 DataTable，然后将 DataTable 分配为 DataSource。请参阅[此 SO 帖子](https://stackoverflow.com/questions/10588329/how-to-set-a-gridview-columns-text-depending-on-other-columns-which-are-binded/10588405#10588405)并对其进行修改以填充列表中的 DataTable。

这样，您就不必担心告诉您的 gridview 任何内容。

# mysql - UNIQUE 索引如何在多个列上工作？

> ID：10723645
> 
> 赞同：1
> 
> 时间：2012-05-23T15:54:36.113
> 
> 标签：mysql, indexing, unique

如果我在列上添加唯一索引`email,password`，索引是否会检查：

1.  是`email`唯一`AND`的就是`password`唯一的，或者
2.  的组合`email,password`是独一无二的，因为它允许`u1@mail.com, 123`并且`u2@mail.com, 123`

抱歉，如果我的想法在这里显得很突然，由于某种原因，我今天很难表达出来。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:56:07.313

你的第二个答案是正确的。这两个字段的组合必须是唯一的。

对于#1，您需要在每列上单独使用唯一索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:08:54.297

我同意@redFilter 的组合是一个更好的选择。但请记住，UNIQUE 与主键不同。如果您想在创建表时避免在每个数据类型的末尾使用“NOT NULL”，则可以在 UNIQUE 中包含空值。

# facebook - 将应用程序从个人帐户链接到 FB 页面

> ID：10723646
> 
> 赞同：0
> 
> 时间：2012-05-23T15:54:37.430
> 
> 标签：facebook, facebook-graph-api

我正在尝试将应用程序 ID 放入我的 wordpress 博客中，这样我就可以获取 facebook 评论、喜欢等。我想要的评论位于完善的 facebook 页面上。

环顾四周，我了解到您不能通过 Page 帐户直接添加开发者应用程序，只能通过个人帐户。

所以我通过我的个人帐户创建了该应用程序，在我的 WP 博客中获得了 ID 和它的两种方式都很好用……但它显然与我的个人帐户相关联。我在哪里可以将应用程序重新链接到我在第一段中提到的原始 Facebook 页面？可能吗？我的个人帐户在所需页面上列为管理员。我注意到应用程序的高级选项中有一个选项可以“创建页面”，但我不想从头开始创建社区页面。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:15:16.003

您不能将应用 ID 链接到现有页面；不过，如果需要，您可以在应用程序的高级设置中为该应用程序创建一个新页面。

# html - 应用 CSS 变换时影响其他元素：缩放

> ID：10723647
> 
> 赞同：6
> 
> 时间：2012-05-23T15:54:40.590
> 
> 标签：html, css, scale, css-transforms

我在一个页面上有三个 div，全部并排浮动。使用 css scale 方法，我将最中间的 div 缩放到 0.5。这很好用。

唯一的问题是缩放 div 不会影响其他 div 的位置。似乎缩放的 div 仍然具有原始比例的不可见容器。期望的结果是缩放后边距保持不变。

我添加了一个示例： http: [//jsfiddle.net/yxYdd/3/](http://jsfiddle.net/yxYdd/3/)（实际上，最中间的 div 充满了许多其他元素）

有没有一种简洁的方法，不会弄乱边距等，这样缩放会影响其他 div 的定位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:46:32.440

不幸的是，这就是 CSS 2D 转换按设计工作的方式。

您真正想要做的是**避免**在此示例中使用 CSS 转换，而是使用另一个更简单的实现。

我在这里为你做了这个：http: [//jsfiddle.net/yxYdd/4/](http://jsfiddle.net/yxYdd/4/)

您真正需要的唯一更改是：

```
.scaleDiv{
    width:75px;
} 
```

这确实产生了你想要的效果。这不是很好笑吗？:)​</p>

# python - Python functools.namedtuple

> ID：10723648
> 
> 赞同：6
> 
> 时间：2012-05-23T15:54:43.040
> 
> 标签：python, python-idle

我知道 的存在和目的`collections.namedtuple`，但我注意到，至少在 IDLE（3.2.2）中，这个工厂函数也在`functools`：

```
>>> import functools
>>> functools.namedtuple
<function namedtuple at 0x024B41E0> 
```

它也`collections`按预期存在，并且是相同的功能：

```
>>> import collections
>>> collections.namedtuple is functools.namedtuple
True 
```

我找不到任何文档提到`namedtuple`除了集合之外的任何地方。那么：这个标准，还是只是一个空闲的怪异？如果它只是空闲，它是一个错误还是一个为什么会`namedtuple`在两个地方 - 事实上，在谁扭曲的头脑中，它在`functools`所有地方都有意义？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T15:58:02.773

在 Python 3.2.2 中，`functools.py`包含以下导入：

```
from collections import OrderedDict, namedtuple 
```

很明显，它只是模块实现的一个方便导入，而不是它的公共接口的一部分。

# magento - 结帐 magento 1.5 中的小计和总计加倍

> ID：10723649
> 
> 赞同：0
> 
> 时间：2012-05-23T15:54:45.443
> 
> 标签：magento, checkout, subtotal

在购物车中添加产品后，转到结帐页面。当点击返回链接或顶部菜单购物车项目链接再次返回购物车页面时，小计和总价将翻倍。

当再次将新产品添加到购物车时，小计和总价会翻倍。

早些时候它工作正常，当移动到云服务器时，出现了这个问题。

我正在使用 magento 1.5

请任何人帮助我，这个问题即将出现在现场。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T12:39:31.647

I had a similar problem. Check this post out: [http://www.magentocommerce.com/boards/viewthread/227560/P15/](http://www.magentocommerce.com/boards/viewthread/227560/P15/). And check the sales_flat_quote_address table if there are to much address entries for the quote_id. I don't know how that happens but if there are more addreses it could happen that the quote is been doubled or trippled

chreers

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-23T17:42:01.637

您没有提供足够的信息。

首先，magento 1.5 没有这个bug。您面临的错误可能来自在项目中完成的自定义工作。

该网站是否使用 ajax 购物车？如果是这样，请按照它使用的添加到购物车方法。

购物车控制器是否有任何自定义工作？

除此之外，您确实没有提供足够的信息让人们尝试回答这个问题。

# javascript - 关于 onSubmit 以及我应该如何使用它

> ID：10723650
> 
> 赞同：-1
> 
> 时间：2012-05-23T15:54:49.067
> 
> 标签：javascript, select, onsubmit

所以我试图在一个表单中创建四个选择菜单，为用户提供几个项目选项/组合。

所以基本上他们可以从所有四个选择菜单中选择不同的值，并且 onSubmit 用户将被带到正确的 URL。示例（Agra -- Blue/Aqua -- Traditional -- $99-$199）和该过滤器的 url 将引导用户。

我的问题是我应该如何为这样的东西定义一个函数？

我基本上需要表单（我们已经拥有每个组合的 URL），以便在用户单击提交时将其引导到适当的 url。我的一部分认为这是一种非常低效的做事方式，我应该使用 jQuery 或其他东西。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:13:42.070

使用下拉选项时，每个列表都包含一个值。根据您设置的值，您可以创建一个过滤器来定位正确的 URL。

此外，根据您的 URL，您可以使用下拉菜单的值创建它们。

您可能需要考虑添加一个搜索按钮，以便您知道用户何时选择了所有选项。

# ruby-on-rails - “heroku db:push”给了我：“点击加载错误：没有要加载的文件--sqlite3 ...”

> ID：10723651
> 
> 赞同：3
> 
> 时间：2012-05-23T15:55:08.460
> 
> 标签：ruby-on-rails, heroku

通过做这个：

```
bundle exec heroku db:push 
```

我懂了：

```
 !    Taps Load Error: no such file to load -- sqlite3
 !    You may need to install or update the taps gem to use db commands.
 !    On most systems this will be:
 !    
 !    sudo gem install taps 
```

这是我的 database.yml 文件：

```
development:
  adapter: mysql2
  encoding: utf8
  database: g_dev
  pool: 5
  username: root
  password: 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T09:13:19.937

我调试了它。

我需要将 gem 'sqlite3' 放入 gemfile 中。

由于 cli.rb (taps-0.3.24) 中的第 10 行：

```
require 'optparse'
require 'tempfile'
require 'taps/monkey'
require 'taps/config'
require 'taps/log'
require 'vendor/okjson'

Taps::Config.taps_database_url = ENV['TAPS_DATABASE_URL'] || begin
  # this is dirty but it solves a weird problem where the tempfile disappears mid-process
  require 'sqlite3' 
```

它在水龙头源代码中...... :(我别无选择

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T07:03:29.993

我遇到了这个问题，但只需这样做就足够了：

```
gem install sqlite3 
```

使其在本地可用。也就是说，你不需要用 sqlite 污染你的 gemfile。

（根据您的环境使用 sudo。）

# jquery - MVC4 jQuery 脚本

> ID：10723652
> 
> 赞同：3
> 
> 时间：2012-05-23T15:55:09.250
> 
> 标签：jquery, asp.net-mvc-4

我习惯了 MVC2 ...您只需将链接添加到脚本和源代码到视图，然后调用 jquery 函数和中提琴...您有工作的 Jquery 代码。但我无法让我的 jqGrid tableToGrid 函数工作。我猜是因为我根本没有正确加载 jquery 库，或者我没有在正确的位置运行脚本。你能看看我的代码，看看可能有什么问题吗？

```
<html>
<head>
<meta name="viewport" content="width=device-width" />
<title>ShowAllEncounters</title>
 <link href="@Url.Content("~/Content/jquery.jqGrid/ui.jqgrid.css")" rel="Stylesheet" type="text/css"/>
</head> 
```

这将是头......我以前也有我的脚本链接在那里......但这不起作用......所以我把标签放在外面......就像这样......

```
</html>
<script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"/>
<script type="text/javascript">
$(document).ready(function () {
...}); 
```

我错过了什么吗？如何在 MVC4 站点中编写 jquery 脚本？

我什至不能得到一个可怕的警报出现！！！！！！！！！！！！！

```
@model IEnumerable<FocusedReadMissionsRedux.Models.TemplateModel>
<!DOCTYPE html>

<html>
<head>
<script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"/>
<link href="@Url.Content("~/Content/jquery.jqGrid/ui.jqgrid.css")" rel="Stylesheet" type="text/css"/>
   <script type="text/javascript">
       $(document).ready(function () {
        alert("what is going on");
       });
   </script>
   <title>ShowAllEncounters</title>
</head> 
```

更新：似乎我在加载 jquery 库时遇到了问题。这肯定是个问题。我需要一个可靠的模式来将这些脚本添加到项目中吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T00:55:02.953

在“新”MVC4 模板中，jquery 脚本通过 Bundles 添加到 _layout.cshtml 的“底部”。

在 _layout.cshtml 块中移动 @Scripts.Render("~/bundles/jquery")。

我不确定为什么模板将此脚本包含在 html 文件的末尾...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T14:55:38.733

除了帕特里斯的回答（只是为了向未来的访客澄清）。

可以在 /App_Start/BundleConfig.cs 中自定义 Bundle。

正如 NoProblemBabe 所说，带有 Javascript 内容的 Bundles 放在 html 文件的末尾，以确保在第一次访问时加载 Javascript 文件不会卡住其余的 HTML 文件加载，它将更快地将页面呈现给客户端。

由于 jQuery 启动函数放在 $(document).ready 中（在良好的编码实践中），因此没什么大不了的。另外，要记住 JS 文件的浏览器缓存。（这可能会在几乎所有浏览器中启用）。

# python - 总结python中的列表 - 有没有更好的方法？

> ID：10723659
> 
> 赞同：5
> 
> 时间：2012-05-23T15:55:36.977
> 
> 标签：python, list, sum

有没有更明智的方法来做到这一点？我想通过对许多其他列表的索引求和来制作一个新列表。我对编程相当陌生，这似乎是一种非常笨拙的方法！

```
list1 = [1,2,3,4,5]
list2 = [1,1,1,4,1]
list3 = [1,22,3,1,5]
list4 = [1,2,5,4,5]
...
list100 = [4,5,6,7,8]

i = 0
while i < len(list1):
    mynewlist[i] = list1[i]+list2[i]+list3[i]+list4[i]+...list100[i]
    i = i+1 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-23T15:58:58.623

这是一个非常好的用例[`zip`](http://docs.python.org/library/functions.html#zip)。

```
>>> list1 = [1,2,3,4,5]
>>> list2 = [1,1,1,4,1]
>>> list3 = [1,22,3,1,5]
>>> list4 = [1,2,5,4,5]
>>> [sum(x) for x in zip(list1, list2, list3, list4)]
[4, 27, 12, 13, 16] 
```

或者，如果您将数据作为列表列表而不是单独的列表：

```
>>> data = [[1,2,3,4,5], [1,1,1,4,1], [1,22,3,1,5], [1,2,5,4,5]]
>>> [sum(x) for x in zip(*data)]
[4, 27, 12, 13, 16] 
```

同样，如果您将数据存储为`dict`列表，您可以使用[`dict.itervalues()`](http://docs.python.org/library/stdtypes.html#dict.itervalues)或[`dict.values()`](http://docs.python.org/library/stdtypes.html#dict.values)检索列表值并以类似的方式使用它：

```
>>> data = {"a":[1,2,3], "b":[3,4,4]}
>>> [sum(x) for x in zip(*data.itervalues())]
[4, 6, 7] 
```

* * *

请注意，如果您的列表长度不等，`zip`将一直工作到最短的列表长度。例如：

```
>>> data = [[1,2,3,4,5], [1,1], [1,22], [1,2,5]]
>>> [sum(x) for x in zip(*data)]
[4, 27] 
```

如果您希望获得包含所有数据的结果，您可以使用[`itertools.izip_longest`](http://docs.python.org/library/itertools.html#itertools.izip_longest)（带有适当的`fillvalue`）。例子：

```
>>> data = [[1,2,3,4,5], [1,1], [1,22], [1,2,5]]
>>> [sum(x) for x in izip_longest(*data, fillvalue=0)]
[4, 27, 8, 4, 5] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T16:03:45.007

虽然@Shawn 的回答是正确的，但我认为这种情况`map`可能比列表推导更优雅：

```
>>> list1 = [1,2,3,4,5]
>>> list2 = [1,1,1,4,1]
>>> list3 = [1,22,3,1,5]
>>> list4 = [1,2,5,4,5]
>>> map(sum, zip(list1, list2, list3, list4))
[4, 27, 12, 13, 16] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:11:47.290

首先的问题是：你的代码中*永远不*应该有 100 个变量。

```
list1 = [1,2,3,4,5]
list2 = [1,1,1,4,1]
list3 = [1,22,3,1,5]
list4 = [1,2,5,4,5]
...
list100 = [4,5,6,7,8] 
```

相反，你应该有类似的东西

```
list_of_lists = []
list_of_lists.append([1,2,3,4,5])
list_of_lists.append([1,1,1,4,1])
list_of_lists.append([1,22,3,1,5])
list_of_lists.append([1,2,5,4,5])
... 
```

然后你会像这样计算所需的结果：

```
[sum(x) for x in zip(*list_of_lists)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T16:09:04.833

你真的需要阅读 python 教程。

1.  `sum(list1)`将为您提供该列表的总和。
2.  你需要了解`for`循环
3.  您的列表本身应该存储在列表中
4.  旋转列表集合的方法是使用`zip`：

    ```
    list1 = [1,2,3,4,5]
    list2 = [1,1,1,4,1]
    list3 = [1,22,3,1,5]
    zip(list1,list2,list3)
    # matches up element n of each list with element n of the other lists
    #=> [(1, 1, 1), (2, 1, 22), (3, 1, 3), (4, 4, 1), (5, 1, 5)]
    # now you want to add up each of those tuples:
    [sum(t) for t in zip(list1,list2,list3)]
    #=> [3, 25, 7, 9, 11] 
    ```

要使用这样的列表列表`zip`，请查看`itertools`模块，或了解`*args`语法。

# c# - 如何在 .NET 中将十六进制“字符串”转换为实际的十六进制值？

> ID：10723660
> 
> 赞同：4
> 
> 时间：2012-05-23T15:55:39.957
> 
> 标签：c#, .net, string, hex, type-conversion

> **可能重复：**
> [如何在 C# 中转换十六进制和十进制之间的数字？](https://stackoverflow.com/questions/74148/how-to-convert-numbers-between-hexadecimal-and-decimal-in-c)

我需要能够获取一个十六进制字符串并将其转换为 .NET 中的实际十六进制值。我该怎么做呢？

例如，在 Delphi 中，您可以获取字符串“FF”并添加美元符号，如下所示。

```
tmpstr := '$'+ 'FF'; 
```

然后，将`tmpstr`字符串变量转换为整数以获得实际的十六进制。结果将是`255`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T15:58:28.810

假设您正在尝试将您的转换`string`为`int`：

```
var i = Int32.Parse("FF", System.Globalization.NumberStyles.HexNumber) 
```

但是，您的示例`1847504890`不适合`int`。请改用更长的类型。

```
var i = Int64.Parse("1847504890", System.Globalization.NumberStyles.HexNumber) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T16:02:48.720

您可以按照以下方式进行

```
string tmpstr = "FF";
int num = Int32.Parse(tmpstr, System.Globalization.NumberStyles.HexNumber); 
```

您还可以查看[将字符串转换为十六进制的链接](http://msdn.microsoft.com/en-us/library/bb311038.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T16:01:57.363

很简单：

`int value = Convert.ToInt32("DEADBEEF", 16);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T16:00:04.290

```
int hexval = Convert.ToInt32("FF", 16); 
```

# css - Susy：susy-grid-background 总是显示 12 列，无论 $total-cols 否

> ID：10723665
> 
> 赞同：1
> 
> 时间：2012-05-23T15:56:05.957
> 
> 标签：css, compass-sass, sass, susy-compass

来自 Susy 文档：[http ://susy.oddbird.net/guides/reference/#ref-grid-background](http://susy.oddbird.net/guides/reference/#ref-grid-background)

> SUSY 网格背景
> 将 Susy 网格显示为任何容器上的背景图像。
> 
> // susy-grid-background(); .page { @include susy-grid-background; }
> 
> 如果您将元素用作容器，则需要为元素应用背景以使此网格背景正确调整大小。

我的CSS片段：

```
$total-cols     : 16;
$column-width   : 4em;
$gutter-width   : 1em;
$grid-padding   : $gutter-width;

html { background: #fff no-repeat left top; }    

.standard {
  @include container; 
  @include susy-grid-background; /* Susy */ 
```

在我的 Haml 中：

```
%body.standard 
```

无论我尝试过什么，网格总是显示 12 列。有人会好心地指出我需要去让这个调试工具工作的方向吗？

苏西 (1.0.rc.1) 指南针 (0.13.alpha.0)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T02:39:07.173

如果您有一些断点，您还需要直接解决这些问题以更改`$susy-grid-background`显示的列数：

```
.page {
  @include container ($total-columns, $break1, $break2);

  @include susy-grid-background;

  @include at-breakpoint($break1)  {
    @include susy-grid-background;
  }
  @include at-breakpoint($break2)  {
    @include susy-grid-background;    
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T07:54:20.223

`$total-cols`应该叫`$total-columns`。该变量的名称在 1.0 中更改。默认设置是 12 列，您实际上并没有在任何地方覆盖它。

# android - 如何在不弹出对话框获得用户许可的情况下实现 Android 蓝牙配对？

> ID：10723674
> 
> 赞同：0
> 
> 时间：2012-05-23T15:56:52.353
> 
> 标签：android, bluetooth

这几天，我在android平台上实现了一个蓝牙配对功能，详细说一下：主设备是谷歌电视（3.2），从设备是蓝牙键盘，都是HID设备。键盘可以很容易地进入可发现状态，当电视第一次启动时，在电视设置指南中，我需要让电视与键盘配对，如你所知，一般来说，在电视端启用蓝牙我们需要用户许可，然后可以连接。然后我的问题是我不想弹出一个对话框来获得许可，有没有人可以告诉我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:28:14.873

我找到了一个简单的方法 - 在 Android 代码树中，在`external\bluetooth\bluez\src\device.c`：

```
/* If our IO capability is NoInputNoOutput use medium security
 * level (i.e. don't require MITM protection) else use high
 * security level */
if (capability == 0x03)
    sec_level = BT_IO_SEC_MEDIUM;
else
    sec_level = BT_IO_SEC_HIGH;

//david10000 add 
if (device_is_david10000_BTDEV(device)) {
    sec_level = BT_IO_SEC_MEDIUM;
} 
```

这意味着我们可以降低安全级别，让您的特殊设备自动连接。

另一种方法是，当您收到 Android 配对请求时，您可以对其进行编程以自动填充密码/密码等。
如果你有这个问题，试试这个，它对我有用。

# javascript - 单击以隐藏会话的 div

> ID：10723677
> 
> 赞同：0
> 
> 时间：2012-05-23T15:57:06.237
> 
> 标签：javascript, css

我在我的页面上放了一个小框，当有人来时我想显示它，但是当他们单击“关闭”时，它会在他们的会话中消失。现在我有...

```
<script language="JavaScript">
function setVisibility(id, visibility) {
document.getElementById(id).style.display = visibility;
}
</script> 
```

然后只需关闭 div ...

```
onclick="setVisibility('divname', 'none'); 
```

但这是每页。我可以添加或更改什么来设置它，这样一旦他们单击关闭，它就不会回来，直到他们清除与站点的会话？

谢谢

编辑：我正在使用 php。感谢到目前为止的答案，有人能指出我添加cookie的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:08:16.477

使用此功能创建一个 cookie。每当用户隐藏 div 时调用它。

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
} 
```

然后在每一页上，添加这个：

```
function checkCookie()
{
var username=getCookie("username");
  if (username!=null && username!="")
  {
  alert("Welcome again " + username);
  }
else
  {
  username=prompt("Please enter your name:","");
  if (username!=null && username!="")
    {
    setCookie("username",username,365);
    }
  }
} 
```

并检查他们是否关闭了 div。这些是直接摘录。您必须进行修改以满足您的要求。这只是可以使用的流程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:59:56.483

当他们单击关闭时，您可以在 Javascript 中设置会话 cookie，并始终检查 cookie 的存在（或值）。

（在这种情况下不需要服务器端）

# algorithm - 查找 BST 平均高度的递归关系/时间复杂度

> ID：10723679
> 
> 赞同：2
> 
> 时间：2012-05-23T15:57:13.060
> 
> 标签：algorithm, time-complexity, binary-search-tree, recurrence

假设我们有一个最初为空的 BST，我在其中执行 n 次任意插入，我如何找到这个 BST 的平均高度？表达式/伪代码将是（如果我没记错的话）：

```
H(T) = 1 + max(H(T.left), H(T.right)) 
```

我对此的递归关系的猜测是`T(n) = 1 + 2*T(n/2)`，但我不确定这是否正确。

现在这是我的困境，如果我的递归关系是正确的，我如何计算我的平均高度算法的平均复杂度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-29T17:23:33.970

T(n/2)+c 其中 c 是某个常数，我们将数组分成两部分，但我们只使用单个部分进行搜索。如果 out ans 大于中间值，那么我们只搜索 (mid+1 .....j) 如果它小于中间值，那么我们只在(i.....mid) 中搜索，所以，有时我们只使用单个子数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T17:34:31.590

一般来说，平均情况分析更复杂，您不能真正使用在正常最坏情况证明中使用的相同大 O 技术。虽然您对高度的定义是正确的，但将其转换为递归可能会比这更复杂。首先，您可能的意思是`T(n) = 1 + T(n/2)`（这将给出 O(log n) 高度，而您的版本给出 O(n)）然后，没有任何东西可以保证值在左右之间均匀分割为 50-50。

如果你[稍微搜索一下](https://duckduckgo.com/?q=average+height+of+a+binary+search+tree)，你会发现在 BST 的平均高度上有很多材料。例如，[我得到的一个结果是](http://luc.devroye.org/devroye_1986_univ_a_note_on_the_height_of_binary_search_trees.pdf)，随着 n 的增长，BST 的预期高度趋向于 4.3 * (log n)，但要经过大量复杂的数学运算才能到达那里。

# android - getSelectedItemPosition() 总是返回 -1

> ID：10723685
> 
> 赞同：1
> 
> 时间：2012-05-23T15:57:31.603
> 
> 标签：android, listactivity

我有一个扩展 ListActivity 的类，它工作正常

然后在 onListItemClick() 我使用 getSelectedItemPosition() 并且它总是返回 -1

PS getSelectedItemId() 返回一些长数字，如 994393434

```
public class TasksShowActivity  extends ListActivity {

    private Cursor mCursor; 
    private ListAdapter mAdapter;

    private static final String[] mContent = new String[] {
        TasksDbHelper._ID, TasksDbHelper.NAME,
        TasksDbHelper.USER};

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     

        mCursor = managedQuery(
                TasksProvider.CONTENT_URI, mContent, null, null, null);

        mAdapter = new SimpleCursorAdapter(this, 
                    R.layout.tasks, mCursor, 
                    new String[] {TasksDbHelper.NAME, TasksDbHelper.USER}, 
                    new int[] {R.id.name, R.id.date});

        setListAdapter(mAdapter);
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, final long id) {
        super.onListItemClick(l, v, position, id);

      Toast toast = Toast.makeText(this, "Position: "+this.getSelectedItemPosition() , Toast.LENGTH_SHORT);
            toast.setGravity(Gravity.CENTER, 0, 0);
            toast.show();
    }
} 
```

布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/tasks_root_element">

    <TextView
        android:id="@+id/name"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true" 
        android:textSize="18sp"
        />
    <TextView
        android:id="@+id/date"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:layout_alignParentRight="true"
        android:textSize="18sp" 
        android:paddingRight="10px"
        />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T17:07:13.307

> 然后在 onListItemClick() 我使用 getSelectedItemPosition() 并且它总是返回 -1

那是因为没有选择任何内容。“点击”和“选择”是不同的东西。a 中的“选择”`ListView`是通过指点设备（方向键、轨迹球、箭头键等）完成的。

# css - 元素的内联块

> ID：10723689
> 
> 赞同：0
> 
> 时间：2012-05-23T15:57:51.540
> 
> 标签：css, internet-explorer-9

我目前有一个位于文本框侧面的搜索“按钮”，如下图所示，这在 chrome 和 firefox 中呈现良好。

![在此处输入图像描述](../Images/624f104639af04a07af4a3a4194480cc.png)

在 IE9 中是这样渲染的。

![IE 渲染](../Images/a8ac46d869c73eb4cde3de2ea211706b.png)

有没有人遇到过类似的问题？我怎样才能解决这个问题？

搜索按钮的 CSS 是：

```
 .txtSearchBtn
{
    display: inline-block;
    width: 16px;
    height: 16px;
    position: relative;
    left: -20px;
    top: 5px;
    cursor: hand;
    cursor: pointer;
    background-image: url(../Images/magnifier.png);
} 
```

编辑：该错误似乎与我的页面在花式框内呈现有关。IE9 并没有在花式框之外以相同的方式处理内联块。

编辑2：找出问题所在。我的最大宽度设置没有足够的空间容纳文本框和图像，即使我将图像向左移动 -20px，所以 IE 将它呈现在上面的行中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:03:48.300

IE 对 inline-block 的支持在 IE8+ 中得到了更好的支持。这听起来像您正在以兼容模式呈现，这基本上意味着像 IE7 一样呈现此页面（或更糟 - 怪癖模式）。

你是在声明 DOCTYPE 吗？尝试将此添加到您的 html 文件的顶部：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

这应该迫使它使用可以正确执行内联块的 IE9 渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:02:07.030

这是一个问题，因为 IE 无法识别属性

```
display: inline-block; 
```

IE 资源管理器将内联显示它，为了达到预期的效果，您需要使用“布局”来赋予内容

```
zoom: 1;
display: inline; 
```

或类似的。

这篇文章对我很有帮助，请查看它以完全理解我要说的内容！

[http://flipc.blogspot.co.uk/2009/02/damn-ie7-and-inline-block.html](http://flipc.blogspot.co.uk/2009/02/damn-ie7-and-inline-block.html)

编辑：如果你只是想把你的背部覆盖到 IE9 并且不少于，那么@Porco 已经覆盖了正确的 DOCTYPE 声明。

# php - 非字母数字字符替换为单个空格

> ID：10723694
> 
> 赞同：-1
> 
> 时间：2012-05-23T15:58:21.383
> 
> 标签：php

这是我试图让搜索引擎获取输入为 Doe J 而不是 Doe, J 的名称。

这是我的代码：

```
$sql_where = array();

if (isset($_GET['name'])) {

    echo "Searched: {$_GET['name']}<br>";

    $names = explode(' ', trim(preg_replace('/ +/', ' ', $_GET['name'])));
    $names_cnt = count($names);

    if (2 == $names_cnt) {

        foreach ($names as $name_idx => $name) {

            if (($name_idx+1) == $names_cnt) {
                // last one
                $sql_where[] = "
                    (full_name like '% {$name}%')
                    ";
            } else {
                // first one
                $sql_where[] = "
                    (full_name like '{$name}%')
                    ";
            }
        }
    } else {

        $sql_where[] = "
            (full_name like '" . $DB->cleanString($_GET['name']) . "%')
            "; 
```

我已经尝试过`/[^a-zA-Z0-9 ]/`以及其他一些不成功的变体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:00:23.893

```
echo preg_replace( "`[^a-zA-Z0-9]+`", " ", $string); 
//replaces all non alpha numeric characters as " " 
//(and will not have duplicate spaces) 
```

演示：[http ://codepad.org/7Ltx3kcr](http://codepad.org/7Ltx3kcr)

# vim - 粘贴所选文本时，vim如何保留寄存器的内容？

> ID：10723700
> 
> 赞同：39
> 
> 时间：2012-05-23T15:58:44.973
> 
> 标签：vim, copy-paste

我有一行被拉出的文本`yy`。现在我想用这个文本来替换其他几个地方的行。麻烦的是，当我选择`V`要替换的行并粘贴`p`时，被选中的文本会被自动拉出！那是我不想要的。

更改寄存器不起作用，因为粘贴和拉动都是使用新选择的寄存器完成的。

粘贴选定文本时保留寄存器内容的命令是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-23T16:06:09.513

您的原始选择应保留在寄存器中`0`。因此，您可以使用以下命令浏览文件并将您的拉线粘贴到其他行上：`V"0p`

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-05-23T16:08:04.907

每次您`p`超过某些内容时，它都会进入默认寄存器。

要解决此功能，您必须先使用`"_`“黑洞寄存器” `p`。这是我的自定义映射`~/.vimrc`：

```
vnoremap <leader>p "_dP 
```

它删除选定的内容并将其放入黑洞寄存器中（这意味着选定的文本将永远消失）并将默认寄存器的内容放置在先前选定的文本的位置，同时保持默认寄存器不变。

当我需要用另一个 looooooong url 替换几个地方的 loooooooong url 并且制作 a`s//`太麻烦时，我经常使用它。

# c# - 在为此场景创建正则表达式时需要帮助

> ID：10723701
> 
> 赞同：2
> 
> 时间：2012-05-23T15:58:46.147
> 
> 标签：c#, regex

我需要从遵循某种格式布局的文本行中解析一些信息。这是文本文件外观的示例：

```
A. This is option a              C. This is option c
B. This is option b              D. This is option d 
```

归根结底，我想要的是，在解析了上述两行之后，我将拥有我的 C# 代码：

```
string OptionA = "This is option a";
string OptionB = "This is option b";
string OptionC = "This is option c";
string OptionD = "This is option d"; 
```

A. 和 C.（或 B. 和 D.）之间的空格可以是制表符 (\t) 或随机数量的空格。单步执行代码并读取该行时，它的外观如下：

```
"A.\tThis is option a\tC. This is option c" 
```

或者它可能看起来像这样

```
"A.\tThis is option a        C. This is option c" 
```

我可能需要一些帮助，根据“\t”或“C”之前的一些空格来拆分这一行。就像上面的例子一样。

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:13:04.650

以下正则表达式应该这样做，

```
@"^([A-Z])[.](.+[^\s])\s+([A-Z])[.](.+)$" 
```

每行在哪里

*   Groups[0] 是整行
*   Groups[1] 是第一个字母（例如 A）
*   Groups[2] 是第一个选项（例如，这是选项 a）
*   Groups[3] 是第二个字母（例如 C）
*   Groups[4] 是第二个选项（例如，这是选项 c）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:10:44.763

试一试：

```
[A-Z]\..*((\s){2,}|\t) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:16:04.050

```
[a-zA-Z][.]\s[\w\s]*\s 
```

将为您提供类似的结果`A. This is option a`，然后您可以对其进行解析以获取选项字母和结果文本。您还可能希望从以下行中删除尾随空格`.Trim()`

# mysql - 在mysql中浮动日期

> ID：10723705
> 
> 赞同：0
> 
> 时间：2012-05-23T15:59:06.580
> 
> 标签：mysql, ruby, date

我们有一个脚本可以在表格中保存一些行，其中一个用`Time.now.to_f`. 所以我们有如下价值观：

1330017921.1065 1330018520.80347

有没有办法直接在 MySQL 中将其转换为日期，我现在可以使用`Time.at`，但我需要一个行 mysql 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:02:19.830

我想这是一个微型时间。

如果你不需要毫秒，你可以查询类似

```
SELECT * FROM table WHERE datefield = FROM_UNIXTIME(rounded_unixtime) 
```

在你的情况下 rounded_unixtime 是 1330017921

# html - 是否可以更改检票口输出？

> ID：10723707
> 
> 赞同：2
> 
> 时间：2012-05-23T15:59:18.407
> 
> 标签：html, components, wicket

*您好，我想知道是否可以更改检票口输出 html 代码。例如，对于组件“CheckBoxMultipleChoice”，您将获得以下 html 输出。*

```
<span wicket:id="letters">
<input name="letters" type="checkbox" value="0" id="letters_0"/><label for="letters_0">fff</label><br/>
<input name="letters" type="checkbox" value="1" id="letters_1"/><label for="letters_1">aaa</label><br/>
<input name="letters" type="checkbox" value="2" id="letters_2"/><label for="letters_2">bbb</label><br/>
<input name="letters" type="checkbox" value="3" id="letters_3"/><label for="letters_3">ccc</label><br/>
<input name="letters" type="checkbox" value="4" id="letters_4"/><label for="letters_4">ddd</label><br/>
</span> 
```

*如果我不想要`<br/>`标签，我该怎么办？问候*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T18:51:40.560

这取决于组件。

对于任何`Panel`基于任何事物，您始终可以子类化组件 ( `MyPanel.java`) 并提供不同的标记文件 ( `MyPanel.html`)。只要你`wicket:id`在那里有相同的 s，它就可以正常工作。

对于在其源代码中嵌入了标记元素的内置 Wicket 组件，例如`CheckBoxMultipleChoice`，您将受制于组件的自定义 API。在您的情况下，您似乎想要[CheckBoxMultipleChoice#setSuffix](http://wicket.apache.org/apidocs/1.4/org/apache/wicket/markup/html/form/CheckBoxMultipleChoice.html#setSuffix%28java.lang.String%29)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T16:18:36.787

不，从[文档中提取](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/MarkupContainer.html)

> 组件可以更改它们的引用标签、替换标签的正文或在标签后插入标记。但是组件不能从标记流中删除标签。这是一个重要的保证，因为图形设计师可能会在影响视觉呈现的组件标签上设置属性。

但是，如果您想在组件之间添加/删除新的行间距，您可以将组件的显示更改为块/内联

```
@Override
protected void onComponentTag(ComponentTag tag) {
    super.onComponentTag(tag);
    //block or inline 
    tag.put("style", "display:block");
} 
```

或使用 CSS 类

# android - 带有 proguard 的 NullPointerException

> ID：10723709
> 
> 赞同：0
> 
> 时间：2012-05-23T15:59:20.917
> 
> 标签：android, obfuscation, admob, proguard, adview

我正在将 Proguard 与我的应用程序一起使用，并且我会被`NullPointerExceptions`随机发送到我的开发者控制台。当我进行 ReTrace 时，这似乎是`AdView`我正在使用的问题。令人困惑的是，错误发生在我`Service`的显然不使用广告的地方。不知道`Proguard`是对代码做些什么还是什么。这是去混淆的堆栈跟踪：

```
java.lang.NullPointerException
at com.google.ads.internal.AdWebView$1.a(Unknown Source)
at com.app.base.MainService.onHandleIntent(Unknown Source)
at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:59)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.os.HandlerThread.run(HandlerThread.java:60) 
```

`MainService`是我的服务，据我所知，它显示了`NullPointerException`与`com.google.ads.internal.AdView`.

我最近意识到我没有调用`destroy()`我的 AdView，所以我将它添加到`Activities`正在使用它的那些：

```
 @Override
 public void onDestroy() 
 {
    if (adView != null)
      adView.destroy();

    super.onDestroy();
  } 
```

不确定这是否会导致问题。

这是我的`proguard.cfg`文件：

```
-optimizationpasses 5
-dontusemixedcaseclassnames
-dontskipnonpubliclibraryclasses
-dontpreverify
-verbose
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-libraryjars C:\Workspace\JARs\GoogleAdMobAdsSdk-6.0.0.jar
-libraryjars C:\Workspace\JARs\android-support-v4.jar

-repackageclasses ''
-allowaccessmodification
-optimizations !code/simplification/arithmetic
-keepattributes *Annotation*

-dontwarn **CompatHoneycomb
-dontwarn **CompatHoneycombMR2
-dontwarn **CompatCreatorHoneycombMR2

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.Fragment

-keep class android.support.v4.app.** { *; }
-keep interface android.support.v4.app.** { *; }
-keep class com.actionbarsherlock.** { *; }
-keep interface com.actionbarsherlock.** { *; }
-keep class com.app.base.KeywordsFragment
-keep class com.app.base.ListingFragment

-keep public class * extends android.view.View {
    public <init>(android.content.Context);
    public <init>(android.content.Context, android.util.AttributeSet);
    public <init>(android.content.Context, android.util.AttributeSet, int);
    public void set*(...);
}

# This will avoid all the onClick listeners referenced from XML Layouts from being removed
-keepclassmembers class * extends android.app.Activity { 
       public void *(android.view.View); 
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers class * implements android.os.Parcelable {
    static android.os.Parcelable$Creator CREATOR;
}

-keepclassmembers class **.R$* {
    public static <fields>;
}

-dontwarn android.support.** 
```

**更新：**

在查看 Proguard 手册后，我发现这是在故障排除部分：

“MissingResourceException 或 NullPointerException 您处理的代码可能无法找到某些资源文件。ProGuard 只是将资源文件从输入 jar 复制到输出 jar。”

想知道我是否需要使用`keepdirectories`

**更新 2：**

我想知道添加它是否会解决我的问题。我无法对此进行测试，因为我自己无法重新创建错误。它只发生在随机用户身上：

```
 -keep class com.google.ads.** {*;} 
```

**更新 3：**

在追溯我在开发者控制台中遇到的其他错误后，它们似乎都与 com.google.ads 有关，例如：

```
 java.lang.NullPointerException
 at com.google.ads.InterstitialAd.a(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:57:13.240

我认为使用以下内容应该有效：

```
-keepattributes *Annotation*
-keep public class com.google.ads.** 
```

注释片可能已经在那里了。我认为问题在于 SDK 有它自己的 proguard，并且依赖于它的公共类不被开发人员保护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T21:04:30.503

第二个 proguard 声明应该是：

```
-keep public class com.google.ads.** {*;} 
```

没有`{*;}`它对我不起作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-30T06:13:02.487

我花了一个晚上弄清楚内省可能会导致带有 proguard 的 NullPointerException。回想起来很明显。

例如，我必须删除该行：

```
Log.i(TAG, new Object(){}.getClass().getEnclosingMethod().getName()); 
```

# php - 使用 PHP 将时间添加到现有时间

> ID：10723710
> 
> 赞同：0
> 
> 时间：2012-05-23T15:59:24.333
> 
> 标签：php, time

> **可能重复：**
> [在 PHP 中添加时间](https://stackoverflow.com/questions/1456886/adding-time-in-php)

我想使用 php 将时间添加到上午 9:00。我无法让它正确转换。这是我正在使用的：

```
date("g:i A",mktime("9:00 AM +1 hours")); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:59:52.887

你需要使用[`strtotime()`](http://php.net/manual/en/function.strtotime.php)

```
date("g:i A",strtotime("9:00 AM +1 hours")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:36:00.730

如果你有一个`DateTime`对象，你可以像这样添加时间：

```
$dt->add(new DateInterval('PT1H')); 
```

# git - jenkins 抱怨主机密钥验证失败，尽管密钥已生成

> ID：10723711
> 
> 赞同：3
> 
> 时间：2012-05-23T15:59:32.273
> 
> 标签：git, ubuntu, github, hudson, jenkins

```
Error:
Fetching upstream changes from git@github.com:....../.........git
    ERROR: Problem fetching from origin / origin - could be unavailable. Continuing anyway
    hudson.plugins.git.GitException: Error performing command: git fetch -t git@github.com:....../......git +refs/heads/*:refs/remotes/origin/*
    Command "git fetch -t git@github.com:...../......git +refs/heads/*:refs/remotes/origin/*" returned status code 128: Host key verification failed.
    fatal: The remote end hung up unexpectedly 
```

我的评论：

1.  我发现詹金斯构建在执行时失败

    ```
    git fetch -t git@github.com:...../......git +refs/heads/*:refs/remotes/origin/* 
    ```

2.  然后我将相同的命令粘贴到它成功执行的命令行上，很奇怪！

3.  执行以下操作以确保密钥正常工作：

    ```
    ssh -T git@github.com
    Hi [username]! You've successfully authenticated, but GitHub does not provide shell access. 
    ```

    建议在[http://help.github.com/ssh-issues/](http://help.github.com/ssh-issues/)

4.  我确实尝试将生成的私有 ssh 密钥复制到 Jenkins 下的 .ssh 文件夹中

    ```
    cp -rf /root/.ssh /var/lib/jenkins/.ssh 
    ```

    并将 .gitconfig 文件复制到 /var/lib/jenkins

    建议于：[Jenkins 因 github “git clone”而失败](https://stackoverflow.com/questions/6103684/jenkins-fails-with-github-git-clone)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:14:39.047

固定的：

但是我在项目中没有任何密集的配置可以放松。所以删除它并重新创建另一个。而这一次............我刚刚登录系统并**** DID NOT SUDO ****创建 git config 。相反，只需执行 git config user.email "emailid@abc.com" 和 git config user.name "User name" 。jenkins 构建成功！

替代解决方案： .git 归 root 所有，而其他归 jenkins 所有。解决方法是：happy-coding.com/…</p>

# facebook - 仅通过 Facebook 提供应用程序

> ID：10723720
> 
> 赞同：0
> 
> 时间：2012-05-23T16:00:18.547
> 
> 标签：facebook, facebook-apps

我在[http://noupei.com/other/createfbapps/index.php](http://noupei.com/other/createfbapps/index.php)有一个应用程序，我希望这个应用程序只能通过[https://apps.facebook.com/takeflights/](https://apps.facebook.com/takeflights/)上的 Facebook 获得。

简而言之，我希望该应用程序只能通过 facebook 使用。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T18:27:26.217

是的，有可能。看看下面的例子：

[https://component-factory.com/component/fbhelper/demo/](https://component-factory.com/component/fbhelper/demo/)

每次他从 facebook 调用应用程序时，它将重定向用户。诀窍是处理Referer、Facebook Linter 调用等。

# spring - 如果没有尾部斜杠，将 Spring MVC 中的 POST 请求方法映射到应用程序的根是行不通的。

> ID：10723721
> 
> 赞同：0
> 
> 时间：2012-05-23T16:00:21.180
> 
> 标签：spring, spring-mvc, jboss

**网页.xml：**

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

**控制器方法签名：**

```
@RequestMapping(value = {"","/"}, method = RequestMethod.POST)
public ModelAndView index(Model model, @RequestParam("someParam") String someParam) 
```

问题是，当我用尾部斜杠击中根目录时，它工作正常，但是当我在没有尾部斜杠的情况下击中根目录时，JBoss（或浏览器）正在接收请求，并通过带有尾部斜杠的 GET 转发它. 然后我得到以下信息：

> HTTP 状态 405 - 不支持请求方法“GET”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T03:50:01.270

事实证明，这是如何配置 Apache 和 Tomcat 的上下文的问题。以上工作正常。

# unix - 在 Unix 中加入连字符索引字段

> ID：10723724
> 
> 赞同：1
> 
> 时间：2012-05-23T16:00:34.427
> 
> 标签：unix, join, merge, awk

我是 Unix 新手，并且在基于具有连字符索引的字段连接两个制表符分隔的文本文件时遇到了麻烦。例如：

```
file1.txt
33-47   10      22      -99     10
33-48   15      22      165     456
33-101  10      22      -99     15.8
33-126  10      22      -99     15.5
34-133  10      22      -99     13
40-109  10      22      -99     12
41-102  88      21      -99     20
45-169  54      214     -99     4
100-11  652     524     87      5
101-25  45      54      153     8
101-26  1285    12      155     9.5 
```

和

```
file2.txt
1       5432    545     33-101
1       5524    5420    33-126
0       855520  52220   33-47
0       5463    5420    34-133
0       5563    5423    40-109
1       6098    -99     40-109 
```

本质上，文件 1 是一个查找表，我想将文件 1 的匹配行附加到文件 2 以创建一个完整的变量表，即：

```
file3.txt (expected)
1       5432    545     33-101  10      22      -99     15.8
1       5524    5420    33-126  10      22      -99     15.5
0       855520  52220   33-47   10      22      -99     10
0       5463    5420    34-133  10      22      -99     13
0       5563    5423    40-109  10      22      -99     12
1       6098    -99     40-109  10      22      -99     12 
```

我正在使用 Cygwin，并尝试首先以数字方式对字段进行排序，通常使用 LC_COLLATE=C 语言环境以及许多 awk NR==FNR 命令，但我仍然得到一个空白文件。

这都是新的，非常令人沮丧。如果可以的话请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T18:35:58.617

这对我有用，但我不在 Cygwin 上：

```
awk 'NR==FNR{info[$1]=gensub(/[^\t]*\t/,"",1)} NR!=FNR{printf"%s\t%s\n",$0,info[$NF]}' file1.txt file2.txt 
```

我相信有人可以改进...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:10:57.710

我很想知道你是怎么***工作***`join`的。

这是一个非常丑陋的方式：

```
a='{split($f, a, /-/); $f = sprintf("%05d%05d", a[1], a[2]); print}'
join -1 4 -2 1 -o 1.1 1.2 1.3 0 2.2 2.3 2.4 2.5 2.6 2.7 2.8 \
    <(awk -v f=4 "$a" file2.txt | sort -k4,4) | 
    <(awk -v f=1 "$a" file1.txt | sort) \
    awk 'BEGIN {OFS = "\t"} {$4 = substr($4, 1, 5) + 0 "-" substr($4, 6, 5) + 0; print}' 
```

输出：

```
0       855520  52220   33-47   10      22      -99     10
1       5432    545     33-101  10      22      -99     15.8
1       5524    5420    33-126  10      22      -99     15.5
0       5463    5420    34-133  10      22      -99     13
0       5563    5423    40-109  10      22      -99     12
1       6098    -99     40-109  10      22      -99     12 
```

如果您省略了`-o`输出规范（并在 final中将字段从更改为`$4`to ），从而缩短了命令，则输出将如下所示（公共字段优先）：`$1``awk`

```
33-47   0       855520  52220   10      22      -99     10
33-101  1       5432    545     10      22      -99     15.8
33-126  1       5524    5420    10      22      -99     15.5
34-133  0       5463    5420    10      22      -99     13
40-109  0       5563    5423    10      22      -99     12
40-109  1       6098    -99     10      22      -99     12 
```

上面的方法是在键字段中左填充数字并删除连字符，然后再撤消它。这允许进行简单的词法排序。

我很想使用`sort -V`（版本排序）而不是使用填充技术。它给出了正确的排序顺序，但`join`不同意。

# php - 如何使用对 PHP 脚本的 jQuery AJAX 调用基于表单选择生成 JSON 以构建 SQL 语句

> ID：10723725
> 
> 赞同：1
> 
> 时间：2012-05-23T16:00:39.020
> 
> 标签：php, jquery, sql, ajax, json

我有一个 HTML 表单（2 个列表框和一个复选框），我想用它来过滤页面上的结果。

我怎样才能做到这一点，当我按下`Submit`按钮（`.onclick(function(){})`）时，它会在我的本地服务器上执行对 PHP 脚本的 jQuery AJAX 调用，首先，检查列表框中是否选择了任何内容以及复选框是否为检查然后在此基础上构建一个 SQL 语句来查询我的数据库并将结果作为 JSON 检索。

理论上你会怎么做。我已经有了 PHP 脚本，可以简单地从表中获取所有内容并将其保存为 JSON：

```
<?php
// databse connection info
require("dbinfo.inc.php");

// try to open a connection to a MySQL server
$connection=mysql_connect($host, $username, $password);
if (!$connection) {
  die('Not connected : ' . mysql_error());
}

// select the active MySQL database to work with
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
  die ('Can\'t use db : ' . mysql_error());
}

// grab data about every campus and which instituion they belong to
$query = 'select statement to grab all the data from a table';
$result = mysql_query($query);

// check if $results has anything
if (!$result) {
  die('Invalid query: ' . mysql_error());
}

// time to start generating our huge XML
while ($row = @mysql_fetch_assoc($result)){
    $finalarray[] = $row;
    $main_arr['products'] = $finalarray;
}
//  close connection to the database
mysql_close($connection);

//  echo, save and write the file
// print json_encode($main_arr);

$fp = fopen('results.json', 'w');
fwrite($fp, json_encode($main_arr));
fclose($fp);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:50:20.040

这是发布到 php 文件并使用 ajax 获取数据的示例。结果将登录到控制台。我假设您知道在检索到 json 后如何使用 js 处理它？

```
//the php
<?php

    //bla bla connect to database etc

    //if form has been submitted with ajax
    if(isset($_POST["ajax_request"])){

        //build query
        $id    = $_POST["id"];
        $fruit = $_POST["fruit"];
        $query = "SELECT * FROM fruits WHERE id=$id AND fruit='$fruit'";

        //fetch from db
        $result = mysql_query($query);

        //send out json
        die(json_encode($result));

    }

?>

//the jquery
<script type="text/javascript">

$(document).ready(function(){

    //on submit
    $("#ajaxForm").submit(function(e){

        //stop default page refresh
        e.preventDefault();

        //define the form
        var form = $(this);

        //get the form data
        var data = form.serialize();

        //send it via ajax
        $.ajax({
           type      : "post",
           dataType  : "json",
           url       : "url to your php here",
           data      : data+"&ajax_request=1",
           success   : function(json){
               console.log(json);
           },
           error     : function(a,b,c){
               console.log(a,b,c);
           }
        });

    });

});

</script>

//the html
<form id="ajaxForm" method="post" action="">
    <input type="text" name="id" required="required" placeholder="enter id"/>
    <input type="text" name="fruit" required="required" placeholder="enter fruit"/>
    <input type="submit" name="submit"/>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:19:57.007

首先使用 ajax 从表单发送数据：

```
$('form').on('submit', function(e) {
    e.preventDefault();
    $.ajax({
        type: 'POST',
        url : 'myPHPfile.php',
        data: {form : $('form').serialize()}
    }).done(function(data) {
         var myJSONresult = data;
    });
}); 
```

在您的 PHP 文件中，您将获得以下表格

```
$form = $_POST['form']; 
```

并且无需保存到文件，只需通过回显将其发送回来

```
echo json_encode($main_arr); 
```

# visual-c++ - 在 directshow 中使用 VC++ 进行捕获的最佳调度实践

> ID：10723726
> 
> 赞同：0
> 
> 时间：2012-05-23T16:00:42.077
> 
> 标签：visual-c++, video, directshow, video-capture, timing

我有一个捕获应用程序，它执行`MP4`捕获。我需要安排此捕获应用程序以每 30 分钟（或某个动态值）捕获视频。

`IReferenceClock::AdviseTime`我从我不确定的文章中阅读了 MSDN 文章，但我认为会在结束时间过去时触发事件。但它似乎不起作用。如果我的理解不正确，请告诉我。或者是否有任何其他击球手方式可以在 30 分钟内重复计划以捕获视频？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:01:00.217

`IReferenceClock::AdviseTime`是什么让我们关闭日程设置一个事件。过滤器可能会在内部利用这一点作为流操作的一部分。然而，对你来说，这种方法是没有用的。有多种方法可以每 30 分钟触发一次操作。在正在运行的应用程序上，您通常会使用`SetTimer`+ `WM_TIMER`API。如果您希望您的应用程序每 30 分钟启动一次，任务计划程序就在这里为您服务。

# android - APK 扩展文件本地化？

> ID：10723729
> 
> 赞同：5
> 
> 时间：2012-05-23T16:00:46.873
> 
> 标签：android

我在大约 4 个不同的语言环境中有一些非常大 (650MB) 的内容文件（视频、音频）。

我想使用 APK 扩展文件，但它们似乎不支持本地化。

似乎我们可以在 Google Play 中拥有单独的应用程序列表，只要它们具有不同的应用程序名称（按区域设置过滤的应用程序列表）。

我不明白的是，如果您上传相同的应用程序（在不同的应用程序列表中，相同的二进制文件，相同的版本），设备如何知道从哪里获取扩展文件？

例如，假设我有 2 个具有单独应用程序列表的本地化应用程序：-

我的应用程序（英国）+ 扩展文件（英国） 我的应用程序（德国）+ 扩展文件（德国）

如果我为两个列表上传的应用程序是相同的二进制文件，相同的版本，我看不出 Google Play 将如何知道如何将安装的应用程序与这些列表中的任何一个关联？

我在测试期间使用相同的 APK 草案为 DE 和 UK 设置 2 个列表时出现了这个问题。

有没有人有这方面的经验，有没有推荐的方法？任何建议将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:32:19.590

为了让您将其作为两个单独的列表上传，每个应用程序都需要具有不同的包名称。否则，当您尝试上传第二个时，您会收到错误消息。

当您上传 APK 时，您还上传了扩展文件，该文件随后与该特定 APK 相关联（通过包名称）。设备从跟踪该关联的 Google Play 获取扩展文件。

综上所述，上传两个相同的 APK 有一些缺点——例如，您的评分将分散到两个应用程序中，并且排名会受到影响，因为没有一个应用程序会获得与您只有一个 APK 涵盖这两种情况一样多的评分。

# asp.net - asp.net：有没有办法在使用 runat="server" 时抑制“ID”属性的 HTML 输出？

> ID：10723730
> 
> 赞同：0
> 
> 时间：2012-05-23T16:01:01.400
> 
> 标签：asp.net, html

新的 .NET v4 提供了一些很好的方法来自定义控件 ID 的输出，因此它们干净且更易于与 JavaScript 一起使用。

但是，有时我想完全抑制 HTML 中控件 ID 的输出。在每个控制的基础上，这可能吗？

例如：

```
<div class="myclass" id="mycontrol" runat="server">
  ... some HTML
</div> 
```

我想有条件地控制代码隐藏中“mycontrol”的输出（可见性）。但是，当它*可见*时，我希望 HTML 输出简单：

```
<div class="myclass">
  ... some HTML
</div> 
```

我们在 .NET 4 中有这种级别的控制吗？我的意思是*直接和容易*，即。无需将其包装在占位符中或进行自定义渲染。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:10:57.057

你可以使用asp的组合。net 和 jquery 用于您的顶部，如果您使用的是 .net 4.0，您可以执行此操作

```
<div class="myclass" ClientIDMode="Static" id="mycontrol" runat="server">
  ... some HTML
</div> 
```

并且使用 jquery 你可以

```
$(".myclass").removeAttr("id") 
```

并移除更多不必要的属性

```
<div class="myclass">
  ... some HTML
</div> 
```

# c# - 无法从 XML 反序列化

> ID：10723732
> 
> 赞同：3
> 
> 时间：2012-05-23T16:01:11.983
> 
> 标签：c#, xml, serialization

我有一个固定的、有效的 XML 文档。我试图反序列化它以获得对象层次结构。但是有一个异常被抛出。

这是我的 XML 文档：

```
<ROWSET>
   <ROW>
      <LOT>LOT1234</LOT>
      <DATE_TRANS>2012-05-20</DATE_TRANS>
      <NUMERO_AA227>AA227_001</NUMERO_AA227>
      <NUMERO_ETUI>ETUI_001</NUMERO_ETUI>   
      <IDENTITE_BOITE_1>Boite1_1</IDENTITE_BOITE_1>
      <IDENTITE_BOITE_2>Boite1_2</IDENTITE_BOITE_2>
      <IDENTITE_BOITE_3>Boite1_3</IDENTITE_BOITE_3>
      <IDENTITE_BOITE_4>Boite1_5</IDENTITE_BOITE_4>
      <IDENTITE_BOITE_5>Boite1_5</IDENTITE_BOITE_5>
   </ROW>
   <ROW>
      <LOT>LOT5678</LOT>
      <DATE_TRANS>2012-05-20</DATE_TRANS>
      <NUMERO_AA227>AA227_001</NUMERO_AA227>
      <NUMERO_ETUI>ETUI_001</NUMERO_ETUI>   
      <IDENTITE_BOITE_1>Boite1_1</IDENTITE_BOITE_1>
      <IDENTITE_BOITE_2>Boite1_2</IDENTITE_BOITE_2>
      <IDENTITE_BOITE_3>Boite1_3</IDENTITE_BOITE_3>
      <IDENTITE_BOITE_4>Boite1_5</IDENTITE_BOITE_4>
      <IDENTITE_BOITE_5>Boite1_5</IDENTITE_BOITE_5>
   </ROW>
</ROWSET> 
```

这是我的对象模型：

```
[Serializable]
[System.Xml.Serialization.XmlRoot("DTOFournitureListeImporter")]
public class DTOFournitureListeImporter
{
   [XmlArray("ROWSET")]
   [XmlArrayItem("ROW", typeof(DTOFournitureImporter))]
   public DTOFournitureImporter[] dtoFournitureImporter { get; set; }
}

[Serializable]
public class DTOFournitureImporter
{
   [System.Xml.Serialization.XmlElement("lot")]
   public string lot { get; set; }

   [System.Xml.Serialization.XmlElement("date_trans")]
   public DateTime date_trans { get; set; }

   [System.Xml.Serialization.XmlElement("numero_aa227")]
   public string numero_aa227 { get; set; }

   [System.Xml.Serialization.XmlElement("numero_etui")]
   public string numero_etui { get; set; }

   [System.Xml.Serialization.XmlElement("identite_boite_1")]
   public string identite_boite_1 { get; set; }

   [System.Xml.Serialization.XmlElement("identite_boite_2")]
   public string identite_boite_2 { get; set; }

   [System.Xml.Serialization.XmlElement("identite_boite_3")]
   public string identite_boite_3 { get; set; }

   [System.Xml.Serialization.XmlElement("identite_boite_4")]
   public string identite_boite_4 { get; set; }

   [System.Xml.Serialization.XmlElement("identite_boite_5")]
   public string identite_boite_5 { get; set; }
} 
```

我如何反序列化：

```
XmlSerializer serializer = new XmlSerializer(typeof(DTOFournitureListeImporter));
TextReader textReader = new StreamReader(model.cheminFichierXML);
DTOFournitureListeImporter dTOFournitureListeImporter = (DTOFournitureListeImporter)serializer.Deserialize(textReader);
textReader.Close(); 
```

和错误：

> XML 文档中存在错误 (2, 2)。- System.InvalidOperationException：不是预期的。Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationReaderDTOFournitureListeImporter.Read4_DTOFournitureListeImporter()

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:12:02.267

问题可能是 XML 文件中的所有标记都是大写字母，但您的类中的属性建议它们应该是小写字母。

此外，您在属性中说 XML 根是`DTOFournitureListeImporter`，但事实并非如此。XML 根是`ROWSET`.

总而言之：您尝试创建的结构与 XML 文件不匹配。

# ios - 将视频保存到相机胶卷的 iOS 缩略图问题

> ID：10723737
> 
> 赞同：2
> 
> 时间：2012-05-23T16:01:23.927
> 
> 标签：ios, avfoundation

我们有一个问题，即由我们的应用程序生成并保存到相机胶卷（来自用户操作）的视频将在 iOS 照片库上显示为黑色缩略图，而不是帧的缩略图。选择视频后，它将在 iOS 设备或任何其他设备（导出到您的 mac 或 pc...）上毫无问题地播放。

iPhone模拟器上不会出现此问题，仅在iOS设备上出现。

我们使用 AVFoundation 生成视频（非常类似于这个[How do I export UIImage array as a movie?](https://stackoverflow.com/questions/3741323/how-do-i-export-uiimage-array-as-a-movie/3742212#3742212)）

然后，我们使用 AVMutableVideoComposition 将视频与 mp3 文件结合起来。如果我提取所有视频帧，第一帧不是黑色的。

照片库中的缩略图将显示为黑色方块，缩略图上不显示时间跨度（在 iOS4 上）。我们使用 UISaveVideoAtPathToSavedPhotosAlbum 将视频保存到相机胶卷...

我们多次更改了视频压缩类型和设置，但都没有成功。输出是 H264 QuickTimeMovie。

有任何想法吗 ？

谢谢你。

# api - HornetQ 核心 API 与 JMS 的性能对比

> ID：10723738
> 
> 赞同：2
> 
> 时间：2012-05-23T16:01:25.477
> 
> 标签：api, jms, core, hornetq

HornetQ 核心 API 的性能是否优于 JMS？我在这个论坛中发现的唯一一个与我的问题相似的问题是在[这篇文章](https://stackoverflow.com/questions/8041249/hornetq-core-api-and-jms)中，但它只讨论了核心 API 具有更多功能，并没有讨论任何一个选项的性能优势。

我之所以问这个问题是因为在 HornetQ 用户手册（[第 5.1 节](http://docs.jboss.org/hornetq/2.2.5.Final/user-manual/en/html_single/index.html#d0e552)）中写道： *当用户在客户端使用 JMS API 时，**所有 JMS 交互都将转换为 HornetQ 核心客户端 API 上的操作，**然后再通过网络传输使用HornetQ 有线格式。*

请注意，在我们的应用程序中，我们在同一个队列上使用多个消费者的队列，并且我们有多个队列。Queue 包含 HornetQ 的 ClientMessages，每个 ClientMessage 包含序列化的 POJO，序列化为 String 并作为 String 属性添加到消息中。我们使用 Apache ObjectPool 汇集消费者、消息和生产者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:14:38.153

hornetq-core 之上的 JMS 开销非常小。

唯一的问题是，如果您使用 core-api，您可能会更好地调整您的需求，例如异步确认、更好地控制刷新 ACK 的时间以及其他 JMS 实现上的隐式行为。

# mysql - 通过命令提示符使用本地计算机 SQL 更新在线 MySQL？

> ID：10723742
> 
> 赞同：0
> 
> 时间：2012-05-23T16:01:41.147
> 
> 标签：mysql, sql, database, command-line

我有一个 PHP 网络脚本使用的在线 sql 数据库。

我正在与在他们的计算机上管理本地数据库的人一起工作。

我需要一种方法来用计算机上的更新版本替换我的在线 sql 数据库的内容，最好使用 Windows 命令行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T17:08:53.083

您可以使用 mysql 实用程序来执行此操作。mysqldump 将创建更新数据库的备份，然后您可以使用 mysql 实用程序将其输入在线数据库。

```
C:>mysqldump -uUSER -pPASSWORD DATABASE > database.sql
C:>mysql -hHOST -pPORT -uUSER -pPASSWORD DATABASE < database.sql 
```

# asp.net - 上传大量文件后 SharePoint 2010 错误 0x80131904

> ID：10723746
> 
> 赞同：2
> 
> 时间：2012-05-23T16:01:57.077
> 
> 标签：asp.net, sql-server-2008, sharepoint-2010

使用窗口浏览器（不通过 SharePoint 网站上传）将大量文档拖放到服务器（大约 6gbs）后，我无法删除文件、创建网站，甚至无法编辑......什么也没有！但是，我可以像什么都没发生一样浏览该网站。如何删除我最近上传的文件？

当我这样做时，我收到了这条消息......

我尝试将数据库设置为已满，但不是，所以我不确定该怎么办？ ![DB 在我看来并不完整](../Images/66a631efa86558ec5e706edf5c4336ff.png)

当我尝试删除该网站时... ![在此处输入图像描述](../Images/c45f7ac2bc4368f1643b51a7effda7f5.png)

======================错误=========================== ===========

“/”应用程序中的服务器错误。

```
Error: 0x80131904 
```

**说明：**执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

**异常详情：**

System.Runtime.InteropServices.COMException：0x80131904

**源错误：**

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

**堆栈跟踪：**

```
[COMException (0x80131904): <nativehr>0x80131904</nativehr><nativestack></nativestack>]
   Microsoft.SharePoint.Library.SPRequestInternalClass.SetGhostedFile(String setupPath, Byte setupPathVersion, Int32 iVersion, Guid& pguidListId, Guid& pguidDocId, Int32 lDoclibRowId, Int32 iAuthorId, String authorLogin, String serverRelativeUrl, String targetUrlWebRelative, Boolean isInDocLib, Boolean isMigration, Boolean isPublishing, Object varProperties) +0
   Microsoft.SharePoint.Library.SPRequest.SetGhostedFile(String setupPath, Byte setupPathVersion, Int32 iVersion, Guid& pguidListId, Guid& pguidDocId, Int32 lDoclibRowId, Int32 iAuthorId, String authorLogin, String serverRelativeUrl, String targetUrlWebRelative, Boolean isInDocLib, Boolean isMigration, Boolean isPublishing, Object varProperties) +268 
```

**[SP异常]**

```
 Microsoft.SharePoint.SPGlobal.HandleComException(COMException comEx) +27713762
   Microsoft.SharePoint.Library.SPRequest.SetGhostedFile(String setupPath, Byte setupPathVersion, Int32 iVersion, Guid& pguidListId, Guid& pguidDocId, Int32 lDoclibRowId, Int32 iAuthorId, String authorLogin, String serverRelativeUrl, String targetUrlWebRelative, Boolean isInDocLib, Boolean isMigration, Boolean isPublishing, Object varProperties) +28110127
   Microsoft.SharePoint.SPFileCollection.AddGhosted(String sourceFilePath, String targetFilePath, Boolean bIsPublishing) +26702334
   Microsoft.SharePoint.Utilities.SPUtility.CreateNewWikiPage(SPList wikiList, String url) +109
   Microsoft.SharePoint.ApplicationPages.CreateWebPage.SubmitBtn_Click(Object sender, EventArgs e) +715
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +115
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +140
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +29
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2981 
```

版本信息：Microsoft .NET Framework 版本：2.0.50727.5456；ASP.NET 版本：2.0.50727.5456

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:14:57.390

可能是造成这种情况的几个原因之一。检查以下内容：

[http://social.msdn.microsoft.com/Forums/en/sharepoint2010general/thread/d96eaefb-d519-4aef-bbe6-8afb19a4e835](http://social.msdn.microsoft.com/Forums/en/sharepoint2010general/thread/d96eaefb-d519-4aef-bbe6-8afb19a4e835)

[http://support.microsoft.com/kb/925425](http://support.microsoft.com/kb/925425)

如果您查看错误消息，它会提到创建新的 Wiki 页面...尝试删除它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T11:25:36.510

确保查看每个子站点的回收站！此外，即使看起来您正在 SQL FULL 上运行，也可能不是。

# javascript - Javascript将对象作为函数参数传递

> ID：10723749
> 
> 赞同：0
> 
> 时间：2012-05-23T16:02:10.687
> 
> 标签：javascript, function, object, parameter-passing

我对javascript很陌生，所以也许这是一个愚蠢的错误。我创建了一个像下面这样的对象：

```
function objA(){
    this.prop1;
    this.prop2;
    this.prop3;
    this.func1=function(){
        alert('func1');
    }
    this.func2=function(){
        alert('func2');
    }
} 
```

我现在有一个要传递对象的函数：

```
var foo=new objA;

function test(foo){....} 
```

问题是当我调用 test() 时，我执行了 objA（objA.func1 和 objA.func2）中的函数。我只想获取 objA 的属性值。我必须使用另一个函数和一个数组，用 objA 的属性填充数组，然后传递数组：

```
var arrayA={}

function fillArray(data){
    arrayA.prop1=data.prop1;
    arrayA.prop2=data.prop2;
    arrayA.prop3=data.prop3;
}

function test(arrayA){....} 
```

这是唯一的方法还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:09:48.240

函数*是*对象的属性（它们是一等值），因此它们`for (var propName in myObj)`像任何其他属性一样出现在循环中。您可以通过以下方式避免进一步检查它们：

```
for (var prop in myObj){
  if (!myObj.hasOwnProperty(prop)) continue; // Skip inherited properties
  var val = myObj[prop];
  if (typeof val === 'function'))  continue; // Skip functions

  // Must be my own, non-function property
} 
```

或者，在现代浏览器中，您可以将特定属性（如您的函数）*设为 non-enumerable*，这样它们就不会出现在`for ... in`循环中：

```
function objA(){
  this.prop1 = 42;
  Object.defineProperty(this,'func1',{
    value:function(){
     ...
    }
  });
} 
```

*有关这方面的更多信息，请参阅[`Object.defineProperty`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperty)或的文档[`Object.defineProperties`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperties)。*

最后，如果您不需要将函数定义为[*闭包*](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)，您可以在对象的原型上定义它们，在这种情况下，[`hasOwnProperty`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/HasOwnProperty)测试将导致它们被跳过：

```
function objA(){
  this.prop1 = 42;
}
objA.prototype.func1 = function(){
  // operate on the object generically
};

var a = new objA;
"func1" in a;              // true
a.hasOwnProperty("func1"); // false 
```

# delphi - 就 ADO 而言，nvarchar(max) 有多大？

> ID：10723757
> 
> 赞同：2
> 
> 时间：2012-05-23T16:02:36.150
> 
> 标签：delphi, ado, parameterized-query

我正在尝试[对 ADO 使用参数化查询](http://msdn.microsoft.com/en-us/library/windows/desktop/ms677209%28v=vs.85%29.aspx)：

> 插入 Foo（名称，值）值（@name，@value）

在 SQL Server 中，`Name`列是一种`varchar`类型。该`Value`列是一个`nvarchar(max)`.

当我不知道或想要指定大小时，我在创建参数时传递什么*大小？*

```
procedure SaveTheThing(Connection: TADOConnection);
var
   sql: WideString;
   cmd: _Command;
begin
   sql := 'INSERT INTO Foo (Name, Value) VALUES(@name, @value)';

   cmd := CoCommand.Create;
   cmd.Set_ActiveConnection(Connection.ConnectionObject);
   cmd.Set_CommandType(adCmdText);
   cmd.Set_CommandText(sql);

   //and now add the parameters
   cmd.Parameters.Append(
         cmd.CreateParameter('@name', adVarChar, adParamInput, -1, filename)
   );
   cmd.Parameters.Append(
         cmd.CreateParameter('@value', adVarWChar, adParamInput, -1, GetXmlToWideString)
   );

   cmd.Execute({out}recordsAffected, EmptyParam, adCmdSomeThatDoesntCauseAnExcetpion or adExecuteNoRecords);
end; 
```

简单的替代方案将是：

```
sql := 'INSERT INTO Foo (Name, Value)'#13#10+
       'VALUES (+QuotedStr(filename)+', '+QuotedStrW(GetXmlToWideString)+')'; 
```

并且已经完成了。但我想我会花几天时间尝试使参数化查询成为可行的解决方案，并且[避免编写`QuotedStrW`](https://stackoverflow.com/questions/9703491/wraptext-for-widestring-in-delphi).

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T18:34:00.733

您可以`-1`毫无问题地使用 ADO 参数大小中的值。

`Value`试试这个示例代码，它在列中插入一个 2MB 的字符串

```
var
   sql: WideString;
   cmd: _Command;
   recordsAffected : OleVariant;
begin
   sql := 'INSERT INTO Foo (Name, Value) VALUES(?, ?)';
   cmd := CoCommand.Create;
   cmd.Set_ActiveConnection(Connection.ConnectionObject);
   cmd.Set_CommandType(adCmdText);
   cmd.Set_CommandText(sql);

   //and now add the parameters
   cmd.Parameters.Append(cmd.CreateParameter('@name', adVarChar, adParamInput, -1, 'AfileName'));
   cmd.Parameters.Append(cmd.CreateParameter('@value', adVarWChar, adParamInput, -1, StringOfChar('#', 2*1024*1024)));
   cmd.Execute({out}recordsAffected, EmptyParam, adExecuteNoRecords);
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T10:28:28.123

您可以在您的其他帖子中使用我的答案：

> [ADO 参数化查询出现“必须声明变量 @myvariable”错误](https://stackoverflow.com/questions/10725222/must-declare-the-variable-myvariable-error-with-ado-parameterized-query)

按名称使用参数和参数。尽量避免使用`_Command`，而是使用，`TADOCommand`因为它更友好（并且代码也更简单）。您可以使用以下方法将参数分配给值：

```
Parameters.ParamByName('xxxx').value := someValue. 
```

当然`someValue`数据类型必须与你的 SQL Server 列数据类型定义相对应。

# ios - xmlSchemaValidateDoc 中的 ios libxml 恢复控制台消息

> ID：10723758
> 
> 赞同：1
> 
> 时间：2012-05-23T16:02:48.277
> 
> 标签：ios, libxml2

我在我的 ios 项目中使用 libxml。

我使用模式 XML 验证 XML 文档，一切顺利，酷！

我正在使用： int error = xmlSchemaValidateDoc(validityContext, doc);

我的问题是：这个错误（int）没关系，但是我的控制台向我显示了一条非常有趣的错误消息！有没有办法拦截这个消息？

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T11:11:24.550

libxml中有xmlSchemaSetValidErrors。收到消息很有用！

# ruby-on-rails - 设置具有多个 has_one 关系的外键

> ID：10723759
> 
> 赞同：0
> 
> 时间：2012-05-23T16:02:48.370
> 
> 标签：ruby-on-rails, foreign-keys

我正在设置一个应用程序来发布想要/可用/易货的物品。我有两个主要类，Post 和 Item。

每个帖子都包含一个 offer_item、一个 Want_item，或者两者都包含。以下是我目前的定义：

```
class Post < ActiveRecord::Base
  has_one :wanted_item, :class_name => 'Item', :dependent => :destroy
  has_one :offered_item, :class_name => 'Item', :dependent => :destroy
  has_one :location, :dependent => :destroy
end 
```

和

```
class Item < ActiveRecord::Base
  belongs_to :post

  attr_accessible :title, :description
end 
```

**关于我的问题：如何构建 Items 表中的外键，以便我可以分辨出哪个帖子（以及它是wanted_item 还是 offer_item）？** 这是在迁移文件中还是在模型中完成的？

就目前而言，当我尝试这样的查询时：

```
Post.find(:first).wanted_item 
```

我得到以下信息：

> SQLite3::SQLException: 没有这样的列: items.post_id: SELECT "items".* FROM "items" WHERE "items"."post_id" = 1 LIMIT 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:29:06.360

您可以设置关联条件，如下所示：

```
has_one :wanted_item, :class_name => 'Item', :conditions => ['kind = ?', 'wanted'] 
```

并添加一`kind`列`Item`（不要使用“类型”，它是保留字）。

编辑：再次阅读您的帖子，您的`Item`表似乎缺少外键。在创建表的迁移文件中`Item`，只需包含`t.references :post`让 rails 创建一个 post_id 外键列。

# django - 如何使用 Django 和 Apache 设置自定义域托管？

> ID：10723761
> 
> 赞同：0
> 
> 时间：2012-05-23T16:02:57.577
> 
> 标签：django, apache, hosting, subdomain

我现在想弄清楚的是设置自定义域托管，以便用户可以在他们选择的任何域上托管个人资料页面。我现在能够让它工作，但它需要大量的定制工作。

我当前的设置是让用户更改他们的 DNS 设置以重定向到我的域。然后在我的域上添加另一个虚拟主机来处理这个新域，然后更新我的 Django 中间件以查看请求中的 PATH_INFO 以选择要服务的页面。

有没有办法可以改变这个过程来自动化这个过程，这样就可以完全自动完成而不需要修改 Apache 或中间件？我正在考虑使用 mod_rewrite 将此信息传递到 Django 中的特定页面，然后在表中进行查找以查看此页面为该域显示的页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T17:27:21.690

您应该能够设置您的网络服务器，使其接受指向它的任何域。完成此操作后，用户只需创建一条 A 记录，将其域或子域指向您站点的 IP 地址，然后他们的域将显示您的站点。

然后，您只需要在视图中设置一些域检查 ( `request.get_host()`)。例如，您的索引视图应该在主机上分支，加载您的域的主页和任何其他域的用户配置文件。您可以让用户将他们的域添加到他们的个人资料中，然后使用它来查找正确的个人资料。您可能需要添加一些中间件来保护其他视图不被您的域以外的任何人访问，但这基本上是过程。

# .net - 有没有办法记录 Excel 加载项异常（无代码更改）？

> ID：10723763
> 
> 赞同：2
> 
> 时间：2012-05-23T16:03:05.920
> 
> 标签：.net, excel, logging, add-in

我们有一个用 C# 编写的旧 Excel COM 插件，它没有内置日志。现在一个客户遇到了一个问题，当他单击一个功能区按钮时，一个窗口窗体会显示半秒钟然后消失。但它应该留下来。在窗口窗体的初始化中，它进行两次 Web 服务调用以获取数据以填充窗体上的控件。
我猜初始化有问题。但没有日志就无法判断。所以我想知道是否有任何工具/方法可以记录 Excel 中发生的异常/错误？

非常感谢！

编辑我现在正在考虑 VBA，因为我没有找到完成此任务的工具

```
 On Error GoTo ERR_      
        Dim cmd As CommandBarButton
        Set cmd = Application.CommandBars("MyTab").Controls("MyRibbonButton")
        cmd.Execute       
        Exit 
ERR_:
    MsgBox ("Error " & Err.Number & " " & Err.Description & " LastDllError:" & Err.LastDllError & Err.Source) 
```

希望这会给我一些线索。在客户端运行它之前，我不确定我能得到多少信息。谢谢

# qt - 在两个或多个窗口之间拖放 QDockWidget

> ID：10723765
> 
> 赞同：2
> 
> 时间：2012-05-23T16:03:14.947
> 
> 标签：qt

我想知道是否有人知道是否可以将[QDockWidget](http://doc.qt.nokia.com/latest/qdockwidget.html)从一个窗口拖到另一个窗口。

我正在开发一个有很多窗口的应用程序。这些窗口中的每一个都有特定的用途。我想使用 QDockWidget 因为在主窗口中停靠小部件时会自动重新缩放。但我也希望有可能在新窗口中有一个新的停靠区，以便我可以将所有相互关联的小部件放在一起。

有人有建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:06:34.423

据我所知，`QDockWidget`如果它们是单独开发的，则不能将它们从一个应用程序拖到另一个应用程序。

另一方面，我认为您可以将 a重新设置为 another ，**前提**是它是同一应用程序的一部分。`QDockWidget``QMainWindow`

...aaaa并且您始终可以尝试**拦截**拖放事件并使用您自己的协议在两个窗口之间传递信息：为拖动定义新的 mime 类型并定义与`QDockWidget`. 然后，实现代码来分析数据并重建`QDockWidget`目标窗口中的内容......不是一件*容易*的事！

# mysql - “不在”查询失败

> ID：10723767
> 
> 赞同：4
> 
> 时间：2012-05-23T16:03:28.147
> 
> 标签：mysql

通过 openquery 从 MySQL 数据库中提取一些信息：

```
select *
from foo
where bar not in (select bar from foobar) 
```

现在，如果我用硬连线数字替换子查询，它工作正常，但我有近 1000 个数字需要排除。我无法弄清楚这一点；这两个查询本身运行良好。该错误总是告诉我“从 foobar 选择栏”中有语法错误

谢谢

编辑：

这是错误：

```
[MySQL][ODBC 3.51 Driver][mysqld-4.0.20-log]You have an error in your SQL syntax.  Check the manual that corresponds to your MySQL server version for the right syntax to use near 'select bar from foobar)' at line 3". 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:11:12.980

问题可能是以下一种或多种情况：

1.  foo 不是表
2.  bar 不是 foo 表中的列
3.  foob​​ar 不是表
4.  bar 不是 foobar 表中的列
5.  foo 表中的 bar 和 foobar 中的 bar 具有不同（不兼容）的数据类型

* * *

这*可能*是来自 MYSQL4.0 的 BUG（查看[此处](http://bugs.mysql.com/bug.php?id=5367)获取该信息）。

使用`NOT EXISTS`而不是`NOT IN`这样：

```
select *
from foo
where bar NOT EXISTS (select bar from foobar WHERE foobar.bar = foo.bar) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:11:48.980

您的 foobar 子查询中有任何 NULL 吗？这会弄乱你的方法。如果是这样，[SQL "select where not in subquery" 中的更多详细信息不返回任何结果](https://stackoverflow.com/questions/1406215/sql-select-where-not-in-subquery-returns-no-results)

# android - 迭代 Android 光标的最佳方法是什么？

> ID：10723770
> 
> 赞同：301
> 
> 时间：2012-05-23T16:03:33.377
> 
> 标签：android, android-cursor

我经常看到涉及迭代数据库查询结果的代码，对每一行做一些事情，然后移动到下一行。典型例子如下。

```
Cursor cursor = db.rawQuery(...);
cursor.moveToFirst();
while (cursor.isAfterLast() == false) 
{
    ...
    cursor.moveToNext();
} 
```

```
Cursor cursor = db.rawQuery(...);
for (boolean hasItem = cursor.moveToFirst(); 
     hasItem; 
     hasItem = cursor.moveToNext()) {
    ...
} 
```

```
Cursor cursor = db.rawQuery(...);
if (cursor.moveToFirst()) {
    do {
        ...                 
    } while (cursor.moveToNext());
} 
```

这些对我来说似乎都过于冗长，每个都对`Cursor`方法进行了多次调用。当然必须有一个更整洁的方法？

* * *

## 回答 #1

> 赞同：527
> 
> 时间：2012-05-23T16:03:33.520

最简单的方法是这样的：

```
while (cursor.moveToNext()) {
    ...
} 
```

游标在第一个结果行**之前**开始，因此在第一次迭代时，它会移动到第一个结果（**如果存在**）。如果游标为空，或者最后一行已经处理完毕，则循环退出。

当然，完成后不要忘记关闭光标，最好在`finally`子句中。

```
Cursor cursor = db.rawQuery(...);
try {
    while (cursor.moveToNext()) {
        ...
    }
} finally {
    cursor.close();
} 
```

如果你的目标是 API 19+，你可以使用 try-with-resources。

```
try (Cursor cursor = db.rawQuery(...)) {
    while (cursor.moveToNext()) {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2013-05-20T07:00:24.180

我发现通过光标的最佳方式如下：

```
Cursor cursor;
... //fill the cursor here

for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext()) {
    // do what you need with the cursor here
} 
```

之后不要忘记关闭光标

*编辑：*如果您需要迭代您不负责的游标，给定的解决方案非常好。一个很好的例子是，如果您将游标作为方法中的参数，并且您需要扫描游标以查找给定值，而不必担心游标的当前位置。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2014-03-14T23:08:26.067

我只想指出第三种选择，如果光标不在起始位置，它也可以工作：

```
if (cursor.moveToFirst()) {
    do {
        // do what you need with the cursor here
    } while (cursor.moveToNext());
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-01-24T11:38:05.747

下面可能是更好的方法：

```
if (cursor.moveToFirst()) {
   while (!cursor.isAfterLast()) {
         //your code to implement
         cursor.moveToNext();
    }
}
cursor.close(); 
```

上面的代码将确保它会经历整个迭代并且不会逃脱第一次和最后一次迭代。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-12-05T03:24:35.857

如何使用 foreach 循环：

```
Cursor cursor;
for (Cursor c : CursorUtils.iterate(cursor)) {
    //c.doSth()
} 
```

但是我的 CursorUtils 版本应该不那么难看，但它会自动关闭光标：

```
public class CursorUtils {
public static Iterable<Cursor> iterate(Cursor cursor) {
    return new IterableWithObject<Cursor>(cursor) {
        @Override
        public Iterator<Cursor> iterator() {
            return new IteratorWithObject<Cursor>(t) {
                @Override
                public boolean hasNext() {
                    t.moveToNext();
                    if (t.isAfterLast()) {
                        t.close();
                        return false;
                    }
                    return true;
                }
                @Override
                public Cursor next() {
                    return t;
                }
                @Override
                public void remove() {
                    throw new UnsupportedOperationException("CursorUtils : remove : ");
                }
                @Override
                protected void onCreate() {
                    t.moveToPosition(-1);
                }
            };
        }
    };
}

private static abstract class IteratorWithObject<T> implements Iterator<T> {
    protected T t;
    public IteratorWithObject(T t) {
        this.t = t;
        this.onCreate();
    }
    protected abstract void onCreate();
}

private static abstract class IterableWithObject<T> implements Iterable<T> {
    protected T t;
    public IterableWithObject(T t) {
        this.t = t;
    }
}
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-02-27T13:01:47.127

```
import java.util.Iterator;
import android.database.Cursor;

public class IterableCursor implements Iterable<Cursor>, Iterator<Cursor> {
    Cursor cursor;
    int toVisit;
    public IterableCursor(Cursor cursor) {
        this.cursor = cursor;
        toVisit = cursor.getCount();
    }
    public Iterator<Cursor> iterator() {
        cursor.moveToPosition(-1);
        return this;
    }
    public boolean hasNext() {
        return toVisit>0;
    }
    public Cursor next() {
    //  if (!hasNext()) {
    //      throw new NoSuchElementException();
    //  }
        cursor.moveToNext();
        toVisit--;
        return cursor;
    }
    public void remove() {
        throw new UnsupportedOperationException();
    }
} 
```

示例代码：

```
static void listAllPhones(Context context) {
    Cursor phones = context.getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null, null, null, null);
    for (Cursor phone : new IterableCursor(phones)) {
        String name = phone.getString(phone.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
        String phoneNumber = phone.getString(phone.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
        Log.d("name=" + name + " phoneNumber=" + phoneNumber);
    }
    phones.close();
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-12T20:41:03.817

Do/While 解决方案更优雅，但如果您只使用上面发布的 While 解决方案，没有 moveToPosition(-1) 您将错过第一个元素（至少在 Contact 查询中）。

我建议：

```
if (cursor.getCount() > 0) {
    cursor.moveToPosition(-1);
    while (cursor.moveToNext()) {
          <do stuff>
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-06-06T05:29:58.950

**游标**是表示`2-dimensional`任何数据库表的接口。

当您尝试使用`SELECT`语句检索一些数据时，数据库将首先创建一个**CURSOR 对象**并将其引用返回给您。

这个返回引用的指针指向**第 0 个位置**，否则在游标的第一个位置之前被称为，所以当你想从游标中检索数据时，你必须第一次移动到第一个记录，所以我们必须使用移至第一

当您在**Cursor**`moveToFirst()`上调用方法时，它会将光标指针指向第一个位置。现在您可以访问第一条记录中的数据

 **最好的观察方式：

光标光标

```
for (cursor.moveToFirst(); 
     !cursor.isAfterLast();  
     cursor.moveToNext()) {
                  .........
     } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-07-03T10:19:29.700

```
if (cursor.getCount() == 0)
  return;

cursor.moveToFirst();

while (!cursor.isAfterLast())
{
  // do something
  cursor.moveToNext();
}

cursor.close(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-02T07:36:24.737

最初光标不在第一行显示使用`moveToNext()`您可以在记录不存在时迭代光标然后它`return false`，除非它`return true`，

```
while (cursor.moveToNext()) {
    ...
} 
```**

# actionscript-3 - Actionscript 3：将 bytearray 转换为 PNG 并在场景中显示

> ID：10723772
> 
> 赞同：1
> 
> 时间：2012-05-23T16:03:41.200
> 
> 标签：actionscript-3, png, bytearray

我通过 WCF get 调用获取存储在 SQL 中的 PNG 图像。图像被编码为 base64 字符串并传递到我的 AS3 代码。我需要从数据中提取图像并将其显示在现场。
除此之外，我也尝试过这个......

```
 var imgArray:ByteArray = Base64.decodeToByteArray(responseXML.ImageObject);
var myRect:Rectangle = new Rectangle(100,100,200,200);
var bmd:BitmapData = new BitmapData(200,200,true,0xAAAAAAAA);
bmd.setPixels(myRect, imgArray);
var image:Bitmap = new Bitmap(bmd,"auto",true);
this.addChild(image); 
```

但无济于事。
帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T16:56:31.813

你为什么不使用加载器和加载字节？是原生的。

```
var loader:Loader = new Loader();
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, handleLoad)
loader.loadbytes(byteArray);

private function handleLoad(e:Event):void {
  var loader:Loader = e.currentTarget as Loader;
  // removelistener,etc

  trace(loader.content as Bitmap);
} 
```

您的代码的问题是 PNG 是压缩的，位图是未压缩的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T11:08:15.773

我使用 DanielH 的输入并将图像加载到我的舞台上。这是我在事件处理函数中所做的......

```
 function ImageLoaded(e:Event):void
    {
        var bmd:BitmapData = new BitmapData(imageLoader.ImageLoader.width,imageLoader.ImageLoader.height,true, 0xFFFFFF);
        bmd.draw(imageLoader.ImageLoader);
        var image:Bitmap = new Bitmap(bmd,"auto",true);
        image.width=40;
        image.height=40;
        if(!CheckAndStoreImageIDKey(imageLoader.ImageID))
        {
            Images[imageLoader.ImageID] = image;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:22:05.980

试试[PNGDecoder (http://www.ionsden.com/content/pngdecoder)](http://www.ionsden.com/content/pngdecoder)

```
import ion.utils.png.PNGDecoder;

var bmd:BitmapData = PNGDecoder.decodeImage(imgArray); 
```

# maven - 是否可以在主项目之后构建集成测试模块

> ID：10723777
> 
> 赞同：1
> 
> 时间：2012-05-23T16:04:01.077
> 
> 标签：maven, jenkins

我有一个集成测试模块的 Maven 项目，默认情况下不包含在主构建中，该模块未列在父 pom 的列表中。集成测试通常是在所有其他模块都准备好之后构建的。集成测试还使用位于其他模块中的资源（配置文件）并通过相对路径（如 ../common/src/main/..../config.xml）引用它们。问题是是否可以对詹金斯做同样的事情，最好是重用由“主”构建创建的工作区？

最好的问候，尤金。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:24:24.060

你可以做这两件事，这意味着要么在同一个模块中进行集成测试，但我建议有一个包含集成测试部分的单独模块。

如果您在当前模块中有该模块，则需要以这种方式进行设置。如果您在 src/it/java 中有集成测试

```
 <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>build-helper-maven-plugin</artifactId>
    <version>1.5</version>
    <executions>
      <execution>
        <id>add-test-source</id>
        <phase>process-resources</phase>
        <goals>
          <goal>add-test-source</goal>
        </goals>
        <configuration>
          <sources>
            <source>src/it/java</source>
          </sources>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

另一件重要的事情是像这样使用 maven-failsafe-plugin：

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>2.12</version>
    <executions>
      <execution>
        <id>integration-test</id>
        <goals>
          <goal>integration-test</goal>
        </goals>
      </execution>
      <execution>
        <id>verify</id>
        <goals>
          <goal>verify</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

但通常最好的方法是拥有一个单独的集成测试模块，其中包含集成测试的内容，如下结构：

```
 +-- root (pom.xml)
        +-- mod1 (pom.xml)
        +-- mod-it (pom.xml)
        +.. .. 
```

mod-it 中的配置与前面的示例大致相同，但您可以避免使用 buildhelper-plugin，因为您会将集成测试放入 src/test/java 中。重要的是要了解[maven-failsafe-plugin](http://maven.apache.org/plugins/maven-failsafe-plugin/)的约定，它假定 IT 的名称类似于 *IT.java 等。

此外，我可以推荐阅读[此](https://github.com/khmarbaise/maui/tree/master/src/main/resources/it-example-container)[文档和此处](http://khmarbaise.github.com/maui/it-example-1.html)的文档。

# struct - Apache Thrift：为封闭的结构分配默认值

> ID：10723778
> 
> 赞同：2
> 
> 时间：2012-05-23T16:04:05.083
> 
> 标签：struct, thrift, defaults

在 IDL 文件中，我有

```
struct CaseInfo {
    1: CaseID = '',
    2: EvID = 'foobar',
}

struct Case {
    1: CaseInfo CaseInfo,
    2: string key = '',
} 
```

创建 Case 对象的实例时，CaseInfo 只是 null；它不包含默认 CaseInfo 对象。设置此类对象的默认值的语法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T18:52:06.197

看起来您可以通过字段名称到值的 json 样式映射来初始化结构的默认值。例如

```
struct Case{
    1: CaseInfo CaseInfo = {"CaseID": "", "EvID": "foobar"},
    2: string key = ""
} 
```

# xpages - 如果 xpage 中包含要验证的文本，如何检查富文本字段？

> ID：10723780
> 
> 赞同：1
> 
> 时间：2012-05-23T16:04:24.167
> 
> 标签：xpages, xpages-ssjs

如果 xpage 中包含要验证的文本，如何检查富文本字段？在 ssjs 中需要这个。

想也许我可以做一个getComponent之类的东西，或者document1.getItemValue，然后检查一下

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T12:17:13.187

```
getComponent("inputRichText1").getValue(); 
```

如果您想获得控件当前持有的任何值（在任何转换器等之后），它将起作用

```
getComponent("inputRichText1").getSubmittedValue(); 
```

将在应用任何转换器之前获取已发布到服务器的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:07:10.537

将验证器添加到控件并简单地使用包含提交的 html 的 'value' ssjs 变量。在验证器之外使用 getComponent('body1').getSubmittedValue()

# php - 亚马逊简单的电子邮件服务并不总是有效

> ID：10723781
> 
> 赞同：0
> 
> 时间：2012-05-23T16:04:27.070
> 
> 标签：php, curl, amazon-web-services, amazon-ses

[我通过此处](http://www.orderingdisorder.com/aws/ses/)找到的 PHP 库一直在使用 Amazon SES ，现在我有了新的 EC2 Debian 实例，并且 SES 大部分时间都无法工作，有时当我重新启动 Apache 服务器时，SES 会发送电子邮件几个小时然后再次停止工作，我在服务器日志中收到以下错误：

```
[2012 年 5 月 23 日星期三 15:20:01] [错误] [客户端 xxxxxxxxxx] PHP 通知：未定义的属性：/path-to/library/aws/ses.php 中的 SimpleEmailServiceRequest::$resource 第 491 行
[2012 年 5 月 23 日星期三 15:20:01] [错误] [客户端 xxxxxxxxxx] PHP 警告：SimpleEmailService::sendEmail(): 6 无法解析 /path 中的主机 'email.us-east-1.amazonaws.com' -to/library/aws/ses.php 在第 357 行

```

服务器上启用了 ssl mod。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:34:50.787

唯一对我有用的解决方案是摆脱我正在使用的 EC2 实例并将其替换为不同的实例，因为我这样做了，一个多月前，我再也没有遇到过这个问题。

# sql - Hibernate分离标准问题

> ID：10723783
> 
> 赞同：1
> 
> 时间：2012-05-23T16:04:41.230
> 
> 标签：sql, hibernate, hibernate-criteria, detachedcriteria

我正在尝试使用休眠条件执行以下查询。但是，它没有给我正确的结果。

询问：

```
SELECT * 
FROM   TableA a 
WHERE  NOT EXISTS (SELECT * 
               FROM   TableB b 
               WHERE  b.col1 = a.col1 
                      AND b.flag = 'Y'); 
```

休眠：

```
Criteria criteria = session.createCriteria(TableA.class, "a");
DetachedCriteria dc = DetachedCriteria.forClass(TableB.class, "b");
dc.add(Property.forName("b.col1").eqProperty("a.col1"));

dc.add(Restrictions.eq("b.flag","Y"));
dc.setProjection(Property.forName("b.col1"));

criteria.add(Subqueries.notExists(dc)); 
```

* * *

它正在生成的查询是 -

```
select * from TableA a where not exists (select b.col1 from TableB b where **b.col1=b.col1** and b.flag='Y'); 
```

在这里，我不确定为什么将 b.col1 与 b.col1 进行比较。

有人可以帮助解决这个问题。提前致谢。

——泰迦。

# bash - 在 bash、csh 和 zsh 之间有共同的别名文件

> ID：10723784
> 
> 赞同：4
> 
> 时间：2012-05-23T16:04:44.633
> 
> 标签：bash, zsh, csh, tcsh

我在我的个人笔记本电脑上使用 zsh，在工作中使用 bash/tcsh，在学校使用 tcsh。我已经在所有位置设置了 git，这使得它们很容易保持同步。

我想知道是否可以为所有 3 个 shell 使用一个通用文件作为别名，并从各自的 rc 文件调用脚本以将其转换为特定于 shell 的语法。我该怎么做呢？这可能不是一个好方法；我愿意接受建议。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-06-03T08:38:33.683

正如您已经建议的那样，这*是*错误的方法。正确的方法是在所有系统上简单地使用 Bourne-heritage shell，无论是 zsh、ksh、bash、plain sh 甚至是busybox。这样，您的所有别名都采用 Bourne 语法，您唯一担心的是是否完全支持别名（古老的 sh 不支持）以及它们是否适用于您的 shell（zsh 具有`alias -g`其他 shell 没有的全局别名）。

在学校，您应该能够调用 Bourne-heritage shell，例如

```
 exec /bin/sh -l 
```

在提示符处或在您的`.cshrc`. 也许您的管理员甚至允许您选择您梦想中的外壳。

# .net - 显示目标元数据的工具提示

> ID：10723788
> 
> 赞同：1
> 
> 时间：2012-05-23T16:05:11.560
> 
> 标签：.net, html, sitefinity, sitefinity-5

我正在使用 Sitefinity CMS 构建我的网站；对于某些页面，我使用通过 Sitefinity 输入的标题和描述等元数据。如果有人将鼠标悬停在菜单项上并且它具有元数据，则它会显示在工具提示中。

我知道这样做的原因是，每当 Sitefinity 发布页面时，它都会在所有可能的位置关联所有可能的数据——在它生成标签的链接中，它有一个 title="" 元素。

我不知道如何关闭此功能。我无法手动从链接中删除元数据，我仍然想要与搜索引擎页面关联的元数据。有谁知道停止或修改此功能的简单方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T18:37:51.560

我最终通过使用解决了这个问题

```
$("document").ready(function() {
$(".rsmItem a").attr("title", "");
}); 
```

并事先链接到 jQuery。问题是 Sitefinity 更新页面的时间不够晚，删除标题的脚本会运行，但不会更新脚本运行后加载的任何内容。我希望如果其他人有类似的问题，这也可以帮助他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T11:25:27.063

> 在它生成标签的链接中有一个 title="" 元素

你指的是哪个链接？如果您谈论的是由导航小部件生成的 HTML - 呈现的链接取决于所使用的导航类型。您通常可以通过小部件模板编辑标记。对于导航小部件，唯一的方法是使用外部模板。您可以通过小部件属性指定： ![在此处输入图像描述](../Images/f1a3bcc592a9f31136ba02ed428d6610.png)

模板中的某些控件是必需的，因此您可能需要默认模板。您可以从 Sitefinity SDK 获得。所有默认小部件模板都包含在一个 zip 文件中，位于安装文件夹中的 /Content/Resources 下。

如果您没有使用导航小部件，请说出您要修改的页面链接。

# shared-hosting - 尝试在 Dev PC 上复制 Godaddy MS 共享主机环境

> ID：10723789
> 
> 赞同：0
> 
> 时间：2012-05-23T16:05:15.360
> 
> 标签：shared-hosting

我有一个独特的问题，我找不到解决方案。我从 Godaddy 共享 MS 托管包中管理托管在 IIS 6 上的网站。

在此托管包中，托管了多个网站，每个网站都有自己的域。

Godaddy 的设置方式是 ONE 域是“主”域。这必须托管在根目录中，例如 D:\hosting[USER]。当您浏览到 domain1.com 时，它指向该站点文件的根目录。

所有其他域必须指向该根目录中的**子文件夹。**例如 D:\hosting[USER]\site_2\，当您浏览 domain2.com 时，它指向该子目录。当您添加第二个域/网站时，它是通过一个似乎与 IIS 无关的 godaddy 控制面板完成的（例如，您输入域、子文件夹，然后单击“go”，就完成了。）

这是我无法在我的开发 PC 上复制的部分。在 Dev 机器上，我可以通过编辑我的 hosts 文件并将 domain1.com 指向我的本地机器来浏览根目录（包含 site1 的文件）。到目前为止，一切都很好。

我尝试创建一个“应用程序”，它指向根目录中的第二个站点的子文件夹，但我不能让 domain2.com 指向该子目录等。

我希望这是有道理的，我希望我只需要朝着正确的方向轻推。

谢谢，G

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T00:32:48.210

这个难题有几个部分。

我对 IIS 没有任何经验，所以我不能给你具体的提示，但是为了重新创建开发环境，你需要两件事。

1.  您的计算机需要认识到，为了服务器 domain2.com，它需要自己响应，而不是查询 DNS。因此，您需要“破解”DNS 查找以返回您自己的 IP，即 127.0.0.1（环回接口）。您可以在[此处找到说明](http://www.enterprisenetworkingplanet.com/netsysm/article.php/991281/Net-Tip-etchosts-for-Windows.htm)
2.  IIS 需要响应 domain2.com 地址请求，所以它需要知道 domain2.com 文件在哪里。据推测，您需要在 IIS UI/工具中的某处进行配置。

完成第 2 步后，无论您是在 /hosting/domain1/domain2 还是 /hosting/domain2 中托管域，从 Web 服务器的角度来看都是无关紧要的。

祝你好运。

# android - 执行异步请求时出现 OutOfMemoryException

> ID：10723792
> 
> 赞同：0
> 
> 时间：2012-05-23T16:05:26.270
> 
> 标签：android, facebook, asynchronous

我正在尝试将自己的图片/视频上传到 Facebook，但在尝试上传 2 张以上的图片、视频或任何组合时出现内存问题。我的设备是 HTC Desire：

发布视频

```
public void publishVideo( Bundle kParameters) {
final String kDataPath = kParameters.getString( "video");
kParameters.remove( "picture");
kParameters.remove( "video");

byte[] yData = null;
InputStream kInputStream = null;

try {
    kInputStream = new FileInputStream( kDataPath);
    yData = readBytes( kInputStream);
    kParameters.putString( "token",
                           ms_kFacebookClient.getAccessToken());
    kParameters.putByteArray( "video", yData);
    AsyncFacebookRunner kAsyncRunner = new AsyncFacebookRunner( m_kFacebookClient);
    kAsyncRunner.request( "me/videos",
                             kParameters,
                             "POST",
                             new RequestListener(),
                             null);
} catch ( FileNotFoundException e) {
    e.printStackTrace();
    FacebookX.ms_bIsUploading = false;
} catch ( IOException e) {
    e.printStackTrace();
    FacebookX.ms_bIsUploading = false;
} catch ( OutOfMemoryError e){
    e.printStackTrace();
    FacebookX.ms_bIsUploading = false;
}
 } 
```

图片：

```
public void publishLocalPicture( Bundle kParameters) {
byte[] yData = null;

final String kDataPath = kParameters.getString( "picture");
kParameters.remove( "picture");
kParameters.remove( "video");
kParameters.remove( "filename");

try {
    Bitmap kBitmap = BitmapFactory.decodeFile( kDataPath);
    ByteArrayOutputStream kByteArrayOutputStream = new ByteArrayOutputStream();
    kBitmap.compress( Bitmap.CompressFormat.JPEG,
                      100,
                      kByteArrayOutputStream);
    yData = kByteArrayOutputStream.toByteArray();

    kParameters.putString( "token",
                           ms_kFacebookClient.getAccessToken());
    kParameters.putByteArray( "picture", yData);

    AsyncFacebookRunner kAsyncRunner = new AsyncFacebookRunner( m_kFacebookClient);
    kAsyncRunner.request( "me/photos",
                             kParameters,
                             "POST",
                             new RequestListener(),
                             null);

} catch ( OutOfMemoryError e) {
    e.printStackTrace();
    FacebookX.ms_bIsUploading = false;
}
} 
```

读字节：

```
public byte[] readBytes( InputStream kInputStream) throws IOException {
ByteArrayOutputStream kByteBuffer = new ByteArrayOutputStream();

int iBufferSize = 1024;
byte[] yBuffer = new byte[iBufferSize];

int iLenght = 0;
while ( ( iLenght = kInputStream.read( yBuffer) ) != -1) {
    kByteBuffer.write( yBuffer, 0, iLenght);
}

return kByteBuffer.toByteArray();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T11:12:18.277

显然垃圾收集器在方法完成时没有清理资源，所以我在方法结束之前手动完成了。

```
yBuffer = null;
kBitmap.recycle();
kByteArrayOutputStream.close();
kInputStream.close(); 
```

永远不要相信垃圾收集器。

# ruby-on-rails - Ruby On Rails 添加将随机值插入特定列的脚本

> ID：10723793
> 
> 赞同：0
> 
> 时间：2012-05-23T16:05:27.667
> 
> 标签：ruby-on-rails

我有一个名为“Grades”的表，其中包含 2 列：“Name”和“Grade”。我已经手动填写了姓名字段（我有大约 150 条记录），现在我想为每个学生随机化一个成绩。

我不想使用 mysql 语法，我想使用 ruby​​ 代码。你能告诉我怎么做以及这个脚本应该放在红宝石目录树的什么地方吗？

稍后我计划用更复杂的计算成绩的代码替换随机化成绩的代码（这只是一个临时的实现）......

（我是 Ruby 新手，我想正确地做事）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:26:11.313

如果你想为你的开发环境创建测试数据，你应该使用种子。你可以在`db/seeds.rb`. 该文件包含一些示例。如果你想以正确的方式做你应该使用这样的语法

```
names = ['Mark', 'Paul', 'Alex', 'Phil']
150.times do |i|
  # create! throw exception if errors  
  Grade.create!(name: names.sample, grade: rand(6))
end 
```

如果您想通常执行此操作（更新成绩列），请使用 rake 任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:12:55.980

制作一个遍历所有记录并将随机数插入字段的 rake 任务。这样你就可以随时运行它。

[http://railscasts.com/episodes/66-custom-rake-tasks](http://railscasts.com/episodes/66-custom-rake-tasks)

# algorithm - 如何使用LIS解决10635 uva

> ID：10723794
> 
> 赞同：2
> 
> 时间：2012-05-23T16:05:37.980
> 
> 标签：algorithm, lcs

[对于问题10635 uva](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&category=&problem=1576&mosmsg=Submission%20received%20with%20ID%2010145813)，如何从最长公共子序列减少到 O(nlog n) 最长增加子序列。我需要一些有关解决问题的逻辑的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:14:08.560

对于两个角色之一的路线的每一步（假设是公主），在王子的序列中分配这一步的编号。

首先观察 - 王子序列中不存在的所有步骤都会立即删除 - 它们不能成为常见动作序列的一部分。

现在我们有一个数字序列，代表王子移动序列中的索引。我们应该选择该序列的最大长度的增加子序列（增加，因为我们应该以与王子相同的顺序访问细胞）。敲响任何铃铛？

希望这可以帮助。

# php - TinyMCe 内容未显示在编辑器上进行更新

> ID：10723797
> 
> 赞同：1
> 
> 时间：2012-05-23T16:05:49.530
> 
> 标签：php, tinymce

我在 PHP 中使用 tinyMCE

我有一个带有 tinyMCe 编辑器的页面。我正在尝试的是，当用户在编辑器上完成工作时，他单击保存按钮并提交表单，并且 tinyMCE 内容保存在数据库中，并且 tinyMCE 内容仍然保留在编辑。

现在我到目前为止所做的是。

我有一个包含编辑器的脚本 History_View.php。另一个脚本 History_Model.php 将 tinyMCE 文本插入数据库。

有两个问题正在发生。

1.  当我在我的 tinyMCE 编辑器中编辑后单击保存按钮时，文本成功转到我的 History_Model.php 但数据（即 tinyMCE 的内容）没有存储在数据库中。虽然 statments 看起来运行成功并且没有error.Here 是要插入 DB 的代码。$historyy 是这里的内容。

    ```
    public static function setHistory($id,$historyy)
    {
        self::$connection=DBCon::ConnectToDB();         
        mysql_query("call UpdateCompanyHistory($id,".utf8_encode($historyy).")");
        mysql_close(self::$connection);         
        header("Location:History_View.php?data=".$historyy);
        exit();
    } 
    ```

2.  查询工作后，我使用 php 标头将内容附加到 url 中并移回我的编辑器页面（即 History_View.php），我试图在编辑器中再次放置该文本。当我使用它放回

    ```
     echo"

     <script type='text/javascript'>

       function loadDefaultTinyMCEContent()
       {    
               tinyMCE.activeEditor.selection.setContent('".$_GET['editorData']."');
       }
     </script>

     "; 
    ```

![](../Images/af751035cbee9054bd6642d7cd36b8e7.png)

现在这就是我编辑我的tinymce的方式，问题是在所有过程之后图片再次出现在编辑器中，但不是红色文本，因为tinymce内容被切断，即它没有返回完整的文本。

```
 <p><img src="http://www.veryicon.com/icon/png/Folder/Hyperion/Games.png" alt="" width="256" height="256" /><strong><span style="color: 
```

现在我不知道它为什么要剪切内容以及为什么不将其插入到数据库中。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:03:32.860

在将数据发送到您的数据库之前尝试 SQL 转义数据。 [http://www.php.net/manual/en/function.mysql-real-escape-string.php](http://www.php.net/manual/en/function.mysql-real-escape-string.php)

此外，建议在较新的代码上使用 mysqli 而不是旧的 mysql。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T07:48:12.530

关于您的第二个问题：您永远不应该将内容附加到您的网址。url 的长度是有限的，因为您可以仔细查看内容：

```
<p><img src="http://www.veryicon.com/icon/png/Folder/Hyperion/Games.png" alt="" width="256" height="256" /><strong><span style="color: 
```

该内容明显被剥离。例如，您应该使用 ajax 工作。然后，您可以从响应中获取内容并将其设置为您的编辑器实例，即使不需要重新加载整个页面。

# javascript - 在 JavaScript 中对自定义对象数组进行排序

> ID：10723798
> 
> 赞同：5
> 
> 时间：2012-05-23T16:05:51.303
> 
> 标签：javascript, object

假设我有一个员工对象数组：

```
var Employee = function(fname, age) {
    this.fname = fname;
    this.age = age;
}

var employees = [
    new Employee("Jack", "32"),
    new Employee("Dave", "31"),
    new Employee("Rick", "35"),
    new Employee("Anna", "33")
]; 
```

此时，`employees.sort()`没有任何意义，因为解释器不知道如何对这些自定义对象进行排序。所以我传入了我的自定义排序函数。

```
employees.sort(function(employee1, employee2){
    return employee1.age > employee2.age;
}); 
```

现在`employees.sort()`工作花花公子。

**但是，如果我还想控制要对哪个字段进行排序，并在运行时以某种方式传递它呢？**我可以做这样的事情吗？

```
employees.sort(function(employee1, employee2, on){
    if(on === 'age') {
        return employee1.age > employee2.age;
    }
    return employee1.fname > employee2.fname;
}); 
```

我不能让它工作，所以建议？也许是基于设计模式的重构？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-23T16:08:51.877

```
function getSortFunction(fieldName) {
    return function(employee1, employee2) {
        return employee1[fieldName] > employee2[fieldName];
    }
}

employees.sort(getSortFunction("myField")); 
```

如果您不怕的话，另一个解决方案是使用[Function.prototype.bind :)](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)

```
function mySorter(fieldName, employee1, employee2) {
    return employee1[fieldName] > employee2[fieldName];
}

employees.sort(mySorter.bind(null, "myField")); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T16:14:42.943

您可以使用优秀的库[underscore.js](http://underscorejs.org/)的[sortBy](http://underscorejs.org/#sortBy)方法。

例如：

```
var arr = [
    { name:"a", age:100 },  
    { name:"b", age:90 },
    { name:"c", age:80 },
    { name:"d", age:70 }
];

var sorted = _.sortBy(arr, "age");
console.log( sorted ); 
```

或者在你的情况下：

```
_.sortBy(employees, "age"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T16:26:25.527

我为数组提供[了我自己的`sortBy`方法，该方法允许您使用](http://phrogz.net/JS/Array.prototype.sortBy.js)[Schwartzian 变换](http://en.wikipedia.org/wiki/Schwartzian_transform)指定要排序的任意数量的字段：

## 示例 1

```
var a=[ {c:"GK",age:37}, {c:"ZK",age:13}, {c:"TK",age:14}, {c:"AK",age:13} ];

a.sortBy( function(){ return this.age } );                                   
// [ {c:"ZK",age:13}, {c:"AK",age:13}, {c:"TK",age:14}, {c:"GK",age:37} ] 

a.sortBy( function(){ return [this.age,this.c] } );                          
// [ {c:"AK",age:13}, {c:"ZK",age:13}, {c:"TK",age:14}, {c:"GK",age:37} ] 

a.sortBy( function(){ return -this.age } );                                  
// [ {c:"GK",age:37}, {c:"TK",age:14}, {c:"ZK",age:13}, {c:"AK",age:13} ] 
```

## 示例 2：

```
var n=[ 1, 99, 15, "2", "100", 3, 34, "foo", "bar" ];                        

n.sort();                                                                    
// [ 1, "100", 15, "2", 3, 34, 99, "bar", "foo" ]                         

n.sortBy( function(){ return this*1 } );                                     
// [ "foo", "bar", 1, "2", 3, 15, 34, 99, "100" ]                         

n.sortBy( function(o){ return [typeof o,this] } );                           
// [1, 3, 15, 34, 99, "100", "2", "bar", "foo"]                           

n.sortBy(function(o){ return [typeof o, typeof o=="string" ? o.length : o] })
// [1, 3, 15, 34, 99, "2", "100", "bar", "foo"] 
```

## 编码

```
(function(){
  // This code is copyright 2012 by Gavin Kistner, !@phrogz.net
  // License: http://phrogz.net/JS/_ReuseLicense.txt
  if (typeof Object.defineProperty === 'function'){
    try{Object.defineProperty(Array.prototype,'sortBy',{value:sb}); }catch(e){}
  }
  if (!Array.prototype.sortBy) Array.prototype.sortBy = sb;

  function sb(f){
    for (var i=this.length;i;){
      var o = this[--i];
      this[i] = [].concat(f.call(o,o,i),o);
    }
    this.sort(function(a,b){
      for (var i=0,len=a.length;i<len;++i){
        if (a[i]!=b[i]) return a[i]<b[i]?-1:1;
      }
      return 0;
    });
    for (var i=this.length;i;){
      this[--i]=this[i][this[i].length-1];
    }
    return this;
  }
})(); 
```

# search - 获取 Plone 4 中可搜索内容类型的列表

> ID：10723799
> 
> 赞同：1
> 
> 时间：2012-05-23T16:05:54.367
> 
> 标签：search, plone, catalog

我正在使用 Products.AdvancedQuery 为我的网站构建替代 LiveSearch 机制。到目前为止一切正常，但标准查询对所有可用的内容类型执行搜索，包括在@@search-controlpanel 中标记为不可搜索的内容类型。

我希望 AdvancedQuery 根据@@search-controlpanel 中指定的内容动态过滤掉不可搜索的那些。我怎样才能做到这一点？

如果 AQ 做不到，我可以在查询目录后立即过滤结果。我需要一个标记为可搜索的内容类型名称（或接口）列表。我怎样才能获得这样的清单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T17:43:38.090

假设您可以获得控制面板以编程方式列入黑名单的类型的元组或列表，这可能就像（省略导入）一样简单：

```
>>> query = myquery & AdvancedQuery.Not(AdvancedQuery.In(MY_TYPE_BLACKLIST_HERE)) 
>>> result = getToolByName(context, 'portal_catalog').evalAdvancedQuery(query) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T09:01:33.157

好的，多亏了 sdupton 的建议，我找到了让它工作的方法。

这是解决方案（省略了明显的导入）：

```
from Products.AdvancedQuery import (Eq, Not, In, 
                                    RankByQueries_Sum, MatchGlob)

from my.product.interfaces import IQuery

class CatalogQuery(object):

    implements(IQuery)

    ...

    def _search(self, q, limit):
        """Perform the Catalog search on the 'SearchableText' index
        using phrase 'q', and filter any content types 
        blacklisted as 'unsearchable' in the '@@search-controlpanel'.
        """

        # ask the portal_properties tool for a list of names of
        # unsearchable content types
        ptool = getToolByName(self.context, 'portal_properties')
        types_not_searched = ptool.site_properties.types_not_searched

        # define the search ranking strategy
        rs = RankByQueries_Sum(
                (Eq('Title', q), 16),
                (Eq('Description', q), 8)
             )

        # tune the normalizer
        norm = 1 + rs.getQueryValueSum()

        # prepare the search glob
        glob = "".join((q, "*"))

        # build the query statement, filter using unsearchable list
        query = MatchGlob('SearchableText', glob) & Not(
                    In('portal_type', types_not_searched)
                )

        # perform the search using the portal catalog tool
        brains = self._ctool.evalAdvancedQuery(query, (rs,))

        return brains[:limit], norm 
```

# .net - .NET Jscript 中的 ElapsedTime 事件处理程序示例

> ID：10723802
> 
> 赞同：1
> 
> 时间：2012-05-23T16:06:07.240
> 
> 标签：.net, events, timer, handler, jscript.net

有没有人有这方面的例子，我已经尝试了几天，我无法弄清楚。

帮助...

这是我尝试过的事情之一：

```
var aTimer = new System.Timers.Timer(10000);
aTimer.add_Elapsed(handler);
}

public function handler(sender: Object, e : ElapsedEventArgs){ } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:25:57.183

您的`aTimer`对象似乎是函数中的局部变量，这意味着它可能会被垃圾收集。尝试将其移动到您班级的某个字段中。

此外，设置`Elapsed`属性后，您需要启动计时器：

```
aTimer.Start(); 
```

# node.js - 使用 Towerjs (coffeescript & mongodb) 的关系模型

> ID：10723805
> 
> 赞同：0
> 
> 时间：2012-05-23T16:06:16.477
> 
> 标签：node.js, mongodb, coffeescript, connect, towerjs

我需要从一个用户的所有交易中的所有股票中恢复 towerjs（与 mongodb 商店）报价股票。这段代码不起作用，while循环没有停止，但我不明白为什么

```
 App.Trade.where(userId: @currentUser.get('id')).order("date", "desc").all (error, trades) ->
      idst = {}
      i = 0
      len = trades.length          

      while i < len
        trade = trades[i]
        idst[trade.get('stockTicker')] = 1  if trade.get('stockId') and not idst[trade.get('stockId')]
        i++

      App.Stock.where({ticker: {$in: Object.keys(idst)}}).all (error, stocks) ->
        map = {}
        mapQuote = {}
        i = 0
        len = stocks.length

        while i < len
          stock = stocks[i]
          map[stock.get('ticker')] = stock
          App.QuoteStock.where(ticker: stock.get('ticker')).order("createdAt", "desc").limit(1).first (error, quoteStock) ->
            mapQuote[stock.get('ticker')] = quoteStock
            i++

        i = 0
        len = trades.length
        while i < len
          trade = trades[i]
          trade.stock = map[trade.get('stockTicker')]
          trade.quoteStock = mapQuote[trade.get('stockTicker')]
          i++

        _this.trades = trades 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:29:36.470

看起来有几个地方可能会出现问题。

在第一个`while`循环中，我不确定你是不是这个意思：

```
idst[trade.get('stockTicker')] = 1  if trade.get('stockId') and not idst[trade.get('stockId')] 
```

最后一点，`idst[trade.get('stockId')]`永远不会设置。但这不会中断while循环，所以可能不是问题。

主要的是，因为第二个和第三个`while`循环在异步`App.Trade.where`函数内部，它们不能正常工作。

此外，以下内容将不起作用，因为每次迭代都会调用异步代码：

```
while i < len
  stock = stocks[i]
  map[stock.get('ticker')] = stock
  App.QuoteStock.where(ticker: stock.get('ticker')).order("createdAt", "desc").limit(1).first (error, quoteStock) ->
    mapQuote[stock.get('ticker')] = quoteStock
    i++ 
```

相反，您需要使用异步循环：[https](https://github.com/caolan/async) ://github.com/caolan/async 。你可以这样做：

```
async = require('async')

stocksIterator = (stock, next) ->
  map[stock.get('ticker')] = stock
  App.QuoteStock.where(ticker: stock.get('ticker')).order("createdAt", "desc").limit(1).first (error, quoteStock) ->
    mapQuote[stock.get('ticker')] = quoteStock
    next()

async.forEachSeries stocks, stocksIterator, (error) ->
  tradesIterator = (trade, next) ->
    trade.stock = map[trade.get('stockTicker')]
    trade.quoteStock = mapQuote[trade.get('stockTicker')]
    next()

  async.forEachSeries trades, tradesIterator, (error) ->
    _this.trades = trades 
```

此外，如果我是你，我会将这些迭代器中的每一个放入单独的函数中，或者使用不同的索引变量（例如`i`, `j`） 。`k`它使精神上更容易处理这种异步性质。

让我知道这是否有效。干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T06:22:15.297

哦，我的上帝，你的代码看起来很糟糕......（在嵌套范围内有这么多`i++`, `i < length`，）请......不要这样写代码，闻起来太糟糕了。嵌套循环会导致您的代码难以阅读，尤其是存在影子变量。

所以，你遇到的问题是“影子变量”，它看起来像：

```
some_var = "I am normal"
shadow_it = -> 
  some_var = "this is the shadow"
  # blabla 
```

我建议你改进算法的实现，避免使用影子变量。

# mysql - 将分数分配给表值

> ID：10723808
> 
> 赞同：0
> 
> 时间：2012-05-23T16:06:28.843
> 
> 标签：mysql, triggers

使用以下查询：

```
SELECT sum(severity) as Score, DATE_FORMAT(LAST_UPDATE,"%Y-%m") as    
score_date 
FROM  missingpatches 
GROUP BY score_date 
```

查询中有没有办法为“严重性”列中的每个数字分配一个值，然后对这些新值求和？

例如现在我有：

严重性 Last_Update 1 2012 年 5 月 1 日 1 2012 年 5 月 1 日 2 2012 年 5 月 1 日 2 2012 年 5 月 1 日 3 2012 年 5 月 1 日 3 2012 年 5 月 1 日

我希望所有 1 的得分为 10，2 的得分为 9，3 的得分为 6

有没有办法在查询中做到这一点？或者有没有办法在每次输入新的严重性数字时使用触发器自动将每个严重性的分数插入表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:25:09.063

您可以尝试使用`CASE WHEN THEN`

```
SELECT sum(CASE severity WHEN 1 THEN 10 WHEN 2 THEN 9 WHEN 3 THEN 6 END) as Score, DATE_FORMAT(LAST_UPDATE,"%Y-%m") as    
score_date 
FROM  missingpatches 
GROUP BY score_date 
```

# ios - 使用 AFHTTPClient 和 Cookie 身份验证

> ID：10723809
> 
> 赞同：1
> 
> 时间：2012-05-23T16:06:30.090
> 
> 标签：ios, cocoa, authentication, nsurlconnection, afnetworking

我的应用程序从使用基于表单的身份验证的网站中提取数据。它需要透明地响应重定向到登录页面并通过 POST 请求提供请求的凭据。

我以前使用过 ASIHTTPREQUEST，然后通过检查 url 的过程来查看我是否已被重定向到身份验证页面，如果是，则使用登录表单变量发送 POST 请求，然后再次发出原始请求。它可以工作，但有点破解。

我目前正在将我的代码移至 AFNetworking 并想知道是否有更优雅的方式来实现这一点，也许注入一个 auth 标头？当重定向到身份验证页面时，让 AFHTTPClient 触发身份验证委托方法，然后发布表单。下面是一段伪代码：

```
- (void)requestFinished:(ASIHTTPRequest *)request {
if ([Connection isAuthURL:[request url]])
{
    // If so have we just tried to login ?
    if ( requestState == requestStateSendingLoginCredentials )
    {
        // Login Failed - tried to login & been redirected back to login page
        [self requestFailed:request];
    }
    else
    {
        // We have been directed to login page after a page request
        requestState = requestStateSendingLoginCredentials
        [self postLoginForm:request];
    }
}
else 
{ // Not the authentication page
    if ( requestState == requestStateSendingLoginCredentials )
    {   // We must have successfully logged in
        requestState = requestStateSuccessful;
        // If it was a form we need to post again now were logged in.
        if ([lastRequest isAForm])
        {
            // If original request that triggered the login was a POST request
            // we have to re-send it.
            [self requestURL:nil]; // This will send the last request again
            return;
        }
    }
    if (requestState == requestStateSuccessful)
    {
        [self processResponse:request];
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:11:18.663

让自己轻松自在，并使用 HTTP 为您提供的功能。

HTTP 定义[状态代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，告诉您请求是成功 (200) 还是需要授权 (401)。

将您的凭据存储在共享实例的`Authorized` [HTTP 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)`AFHTTPClient`中，您将获得所有后续调用的身份验证。

或者，如果没有这样做，您可以使用它`AFURLConnection -setAuthenticationChallengeBlock:`来响应身份验证挑战。

# http - 如果 HTTP/1.0 客户端请求 Connection: keep-alive，它会理解分块编码吗？

> ID：10723812
> 
> 赞同：6
> 
> 时间：2012-05-23T16:06:39.153
> 
> 标签：http, http-headers, chunked-encoding, http-content-length, http-chunked

如果我的 HTTP 服务器收到带有“Connection: keep-alive”标头的 HTTP/1.0 请求，那么客户端会理解“Transfer-Encoding: chunked”是否公平？

本质上，我正在尝试决定是否尊重来自 HTTP/1.0 客户端的“Connection: keep-alive”标头。如果我确实尊重它，那么我必须对回复使用分块编码，因为我无法缓冲整个回复以计算 Content-Length 标头。

如果期望请求“连接：保持活动”的 HTTP/1.0 客户端也能理解分块编码是不安全的，那么我将不得不在每次回复后关闭连接。（或者我错过了什么？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T17:45:59.730

这是一个明确的“不”。引用规范：

> 但是，与 HTTP/1.0 客户端的持久连接不能使用分块传输编码，因此必须使用 Content-Length 来标记每个消息的结束边界。

-- [RFC 2068 §19.7.1](https://www.rfc-editor.org/rfc/rfc2068#section-19.7.1.1 "19.7.1 与 HTTP/1.0 持久连接的兼容性（第 2 段到最后一段）")

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-01-24T06:40:34.567

在 HTTP 1.0 中不可能进行分块传输编码。具有分块传输编码的保持活动请求实际上是 HTTP 1.0 和 1.1 之间的定义差异之一。

为了使服务器能够使用并非所有客户端都支持的某些功能，例如保持活动或分块传输编码，它必须在开始响应之前知道客户端与该功能兼容，因为没有持续的初始请求后客户端和服务器之间的双向通信。

*   *在 HTTP 1.0中可以*支持Keep-alive 本身，因为客户端可以在请求中包含 Keep-Alive 标头，向服务器指示客户端支持它。

*   HTTP 1.0 客户端没有确定的方式来表明它们支持分块传输编码，因此服务器不可能向 HTTP 1.0 请求发送分块响应。如果您要向不理解它的客户端发送分块响应，则客户端将收到垃圾。

    当 HTTP 1.0 使用 keep-alive 时，它​​没有分块传输编码。

*   当 keep-alive 不能使用分块传输编码时，它必须为每个响应发送一个 Content-Length 标头。这意味着只有在服务器在响应开始时知道响应的内容长度以便生成有效的 Content-Length 标头时，才能在 HTTP 1.0 中保持活动。当响应由脚本生成并且服务器在发送之前未将其全部缓冲时，情况可能并非如此。

    如果服务器在开始发送响应之前不知道响应的内容长度，则服务器会简单地禁用该响应的 keep-alive。如果可以，服务器并不强制要求每个响应都成为保持活动的响应。

*   HTTP 1.1 客户端必须同时支持 keep-alive 和分块传输编码，因此在发出 HTTP 1.1 请求时，客户端只需将 HTTP/1.1 指定为协议，而不指定 Keep-Alive 标头。

    实际上，客户端可能仍会发送 keep-alive 标头，因此即使服务器仅支持 HTTP 1.0，它也可以使用 keep-alive。如果服务器支持 HTTP 1.1 或更高版本，则该标头将被忽略，并且 HTTP/1.1 协议指示符优先。注意：我相信今天的服务器很少支持 HTTP 1.1 或更高版本，但仍支持保持活动，因此发送它很少有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-23T16:38:44.350

绝对不是，因为它`Transfer-Encoding`仅在 HTTP 1.1 中。鉴于您的情况，我认为您不能真正支持`Connection: keep-alive`HTTP 1.0 客户端的标头（对于您的用例，HTTP 1.0 支持它）。您应该忽略它并关闭连接。这样做是安全的，因为它实际上只是一种优化。

# wcf - 如何手动序列化我的 POCO？

> ID：10723814
> 
> 赞同：1
> 
> 时间：2012-05-23T16:06:45.763
> 
> 标签：wcf, silverlight, serialization

我正在将 Silverlight 与 WCF 一起使用。我有一个相当复杂的对象，我想发送到服务器。该对象在多个服务之间共享，因此不能成为数据合约。我想知道是否有一种简单的方法可以自己进行序列化。一种适用于 .Net 4（服务器端）和 Silverlight 4（客户端）的方式。

请注意，我没有使用 RIA 服务，因为自从我开始使用 RIA 服务以来，它就一直困扰着我。

### 编辑：

我尝试使用`DataContractAttribute`and`DataMemberAttribute`无济于事。我从服务中得到以下异常：

> System.IO.FileNotFoundException：无法加载文件或程序集“System.Runtime.Serialization，Version=2.0.5.0，Culture=neutral，PublicKeyToken=7cec85d7bea7798e”或其依赖项之一。该系统找不到指定的文件。文件名：'System.Runtime.Serialization，版本=2.0.5.0，Culture=neutral，PublicKeyToken=7cec85d7bea7798e'

原因似乎很明显。我相信这是因为包含 POCO 的 DLL 是 Silverlight 类库。这是我知道在我的 WCF 服务和我的 Silverlight 客户端之间共享对象的唯一方法。我认为，问题在于 Silverlight DLL 使用的是 Silverlight 版本，`System.Runtime.Serialization`因此 POCO 不能在非 Silverlight 环境中使用。我必须在多个服务之间共享这个 POCO，所以它必须存在于一个单独的程序集中。

这就是为什么*我*想控制我如何序列化我的对象；在对象本身内部序列化它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T18:23:59.990

我会推荐 Json.NET。您可以下载支持 .Net 和 Silverlight的[NuGet 包。](http://nuget.org/packages/Newtonsoft.Json)

连载：

```
string json = JsonConvert.SerializeObject(myObj); 
```

反序列化：

```
var myObj = JsonConvert.DeserializeObject<MyObject>(json); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:20:56.950

`DataContractSerializer`支持 Silverlight 和 .NET 4.0 中的POCO 类型。您可以尝试一下，它应该可以正常工作。

*编辑后更新*：您不能从 .NET Framework 引用为 Silverlight 构建的库，它们引用不同的程序集。你有几个选择：

*   创建两个类库项目，一个用于 SL，另一个用于完整框架。在其中一个项目中添加文件，在另一个项目中添加指向它们的链接。我已经做了很多次并且工作正常。
*   创建便携式库 (PL) 程序集。我没有尝试过，但这正是 PL 的目标——在不同的 .NET 版本之间共享程序集。你可以试试看它是否有效。

# sql-server - 如何根据另一列的内容向 SQL Server 表中添加一列？

> ID：10723817
> 
> 赞同：1
> 
> 时间：2012-05-23T16:06:51.387
> 
> 标签：sql-server, regex, database, sql-server-2008, stored-procedures

我有两个包含以下信息的表：

*产品*

```
Name  |    ID   | 
```

Name 包含一个短字符串，指示行的名称和语言。

*语言*

```
Language   |   ID   | 
```

语言将是上面名称列中包含的相同子字符串。

我想做的是在我的 Products 表中添加一个名为 LanguageID 的列。

然后，我将从 Name 列中提取指示语言的子字符串，并对 Languages 表中的 Language 列进行不区分大小写的比较。在找到匹配项的地方，我想将 Languages 表中的 ID 值插入到新创建的 LanguageID 列中，从而创建外键关系。

因此，例如在我的产品表中，我有：

```
Name                  |   ID
Product 1 - enGlIsh   |   1 
```

在我的语言表中，我有：

```
Language    |   ID
English     |   77 
```

所以我想在我的 Products 表中得到的是：

```
Name                   |   ID   |   LanguageID
Product 1 - enGlIsh    |   1    |    77 
```

我已经编写了一个正则表达式来从我的子字符串中返回语言，但是我不确定如何使用它并在 SQL 服务器中构造这个查询。我怎样才能做到这一点 ？

这是正则表达式：

```
Regex regEx = new Regex(@"(.+\s*-\s*.+\s*-\s*.+)\s*-\s*(\w{1,3}\s*-\s*\w{1,3})\s*-\s*.+");
                string language = regEx.Match(   NAME   ).Groups[2].Value.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:19:30.517

不需要正则表达式；

```
create table Languages(id int identity(1,1), language varchar(32) ) 
```

获取语​​言列表（假设格式为`<anything><space><language_name>`）：

```
insert Languages
    select distinct 
       right(name,charindex(' ', reverse(name), 1)-1) as [language]
    from products 
```

然后，您可以使用相同的表达式返回并根据需要替换/更新以获取语言名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:17:21.677

你真的不需要正则表达式，只需在字符串上使用上面的命令，然后查看产品名称是否包含语言。像这样的东西

```
insert my_product_lang_table
select p.name, p.id, l.id
from product p, language l
where charindex(upper(l.name),upper(p.name)) != null 
```

# jquery - preventDefault 后无法提交

> ID：10723818
> 
> 赞同：0
> 
> 时间：2012-05-23T16:06:52.610
> 
> 标签：jquery, validation, submit, uploadify, preventdefault

我使用一个用于表单验证的脚本（validationEngine）和一个用于文件上传的脚本（uploadify）。

为了最好地管理我的表单提交：

*   validationEngine 检测是否可以发送我的表单。
*   如果我可以提交，我上传我的文件
*   一旦我所有上传的文件（`onQueueComplete`uploadify），我提交我的表格。

如果我`alert('foo');`在我的 onQueueComplete 中创建一个，它可以工作。但是，如果我提交我的`selector.submit()`……什么都不会发生。

```
$(function() {
    $('#file_upload').uploadify({
        'fileSizeLimit' : '2048KB',
        'auto': false,
        'swf'      : '<?php echo site_url('public/modules/uploadify/uploadify.swf')?>',
        'uploader' : '<?php echo site_url('public/modules/uploadify/uploadify.php')?>',
        'buttonText' : 'Ajouter...',
        'method' : 'post',
        'formData' : {'userMail' : '<?php echo $userMail ?>'},
        'onQueueComplete' : function(queueData) {
            $('#validator').submit();
        } 
    });
});

$(document).ready(function() {
    $("#validator").validationEngine();
    $('#validator').submit(function(event){
        event.preventDefault();
        var canSubmit = $("#validator").validationEngine('validate');
        if(canSubmit)
        {
            $('#file_upload').uploadify('upload','*');
        }
    });
}); 
```

使用此代码，所有工作，但提交不起作用。就好像事件不存在一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:10:46.783

两件事情：

(1) 您在其他地方的选择器是`#validator`，而您`validator`在非功能调用中使用。

(2) 您正在`preventDefault`处理源自 的每个`submit`事件`#validator`，因此即使该事件被正确触发，它也不会执行提交操作。您需要改为调用本机 DOM 元素的`submit`操作：

```
$('#validator')[0].submit(); 
```

`[0]`从选择中获取本机 DOM 元素，然后调用本机`submit`函数。这意味着没有运行 jQuery 处理程序，因此`event.preventDefault`您进行的调用也不会运行，因此事件将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:10:42.013

不应该是：

```
$('#validator').submit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T08:59:19.277

这种方法使我自己的任务复杂化。我决定更轻松地做一个新的例程。

我让文件自动加载。我刚刚创建了我删除的元素。

无论如何，要发送我的邮件，文件附件将被销毁。

这是我的新代码，它可以工作。

```
/**
 * uploadify
 * 
 * we add a onUploadStart event to manage the file. uploadify uploads directly our files, but maybe the user missclick
 * and wants to remove some file.
 * 
 * The send action (controller webmail) doesn't upload files, uploadify do that for us.
 * We just need in the post for the name of the file registered in a hidden input.
 */
$(function() {
    $('#file_upload').uploadify({
        'fileSizeLimit' : '2048KB',
        'swf'      : '<?php echo site_url('public/modules/uploadify/uploadify.swf')?>',
        'uploader' : '<?php echo site_url('public/modules/uploadify/uploadify.php')?>',
        'buttonText' : 'Ajouter...',
        'method' : 'post',
        'formData' : {'userMail' : '<?php echo $userMail ?>'},
        'onUploadStart' : function(file){
            $('#uploadList').append('<div class="file"><a href="#" class="deleteFile" rel="'+file.name+'">'+file.name+' - [x]</a><input type="hidden" name="files[]" value="'+file.name+'" /></div>');
        }

    });

    /**
     * the .deleteFile elements are added after domready. We have to attach event click.
     * We remove the parent block to remove a file of mail attachment
     */
    $('#uploadList').on('click','.deleteFile',function(){
        var rel = $(this).prop('rel');
        /*$('input[value="'+rel+'"]').remove();*/
        $(this).parents('div:first').remove();
    });
});

$(document).ready(function() {
    $("#message").cleditor()[0].focus();

    $("#validator").validationEngine();     
}); 
```

# c# - 调用定时器线程返回时线程不停止

> ID：10723819
> 
> 赞同：1
> 
> 时间：2012-05-23T16:06:55.620
> 
> 标签：c#, multithreading

我创建了这个测试程序，以了解当计时器回调线程返回但新创建的线程仍在运行时会发生什么。我将在下面看到 10 次“In Work”，即使当 timer_Elapsed 返回时本地线程变量不应再在范围内。将线程的“IsBackground”属性设置为 true 无效。

发生这种情况是因为 GC 还没有运行吗？因此假设以这种方式创建的线程将完成是否危险，因为 GC 可能随时运行并清理线程？

我知道这是一个愚蠢的例子，但我最感兴趣的是了解这里发生了什么，所以我知道要避免什么。谢谢！

```
public class Program
{
    static void Main(string[] args)
    {
        var timer = new Timer(500);
        timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);
        timer.AutoReset = false;
        timer.Start();
        Console.ReadLine();
    }

    static void timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        Console.WriteLine("In timer elapsed.  Kicking off a thread in new local thread and then immediately exiting.");
        var thread = new Thread(Work);
        thread.Start(); // but...this doesn't stop when the current thread exits!  
        Console.WriteLine("About to exit timer elapsed.");
    }

    static void Work()
    {
        for (int i = 0; i < 10; i++)
        {
            Console.WriteLine("In Work");
            Thread.Sleep(1000);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:12:09.960

正在执行的线程持有对自身的引用。GC 永远不会终止在其他地方超出范围的线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:14:52.423

[MSDN](http://msdn.microsoft.com/en-us/library/ts553s52.aspx)说一旦线程启动，就不需要保留对 Thread 对象的引用。

# csv - 问题通过 ColdFusion 将 CSV 附件发送给在 LotusNotes 中阅读电子邮件的用户

> ID：10723823
> 
> 赞同：1
> 
> 时间：2012-05-23T16:07:13.483
> 
> 标签：csv, coldfusion, mime-types, lotus-notes, email-attachments

我正在使用 ColdFusion 构建一个 CSV 文件，然后将其作为电子邮件附件发送给用户。

我在电子邮件中复制自己，在 Gmail 和 Outlook 中以 CSV 文件的形式接收附件，并且可以在 Microsoft Excel 中以 CSV 文件的形式打开附件。

我正在使用`CFMAILPARAM`标签附加文件。我尝试过两种方式发送：

```
<cfmailparam file="C:/temp/myfile.csv" type="text/plain" /> 
```

这导致用户看到一个`.txt`文件。当我收到电子邮件时，标题显示：

```
Content-Type: text/plain
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
filename*=myfile.csv 
```

使用：

```
<cfmailparam file="C:/temp/myfile.csv" type="text/csv" /> 
```

这会导致用户看到`.dat`无法在 Microsoft Excel 中打开的文件。当我收到电子邮件时，标题显示：

```
Content-Type: text/csv
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
filename*=myfile.csv 
```

知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T18:22:41.243

您是否通过 Microsoft Exchange 服务器向外发送消息，并且 Lotus Notes 收件人是否将其视为 winmail.dat 文件？如果是这样，那么问题在于您发送邮件的邮件服务器配置为以 TNEF 格式而不是本地 MIME 格式发送给外部收件人。TNEF 是 Microsoft 格式，而不是标准，尽管许多邮件服务器确实可以正确转换它——这可以解释为什么 gmail 收件人没有问题。最新的 Lotus Domino 版本也可以转换它，但可能没有配置该功能。

请参阅此[MS 知识库文章](http://support.microsoft.com/default.aspx?scid=KB;en-us;q138053)以防止它在发送端和/或此[IBM 技术说明](http://www-304.ibm.com/support/docview.wss?uid=swg21093342)以打开 Domino 服务器上对入站端的 TNEF 进行解码的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-29T17:53:17.657

事实证明，解决方案非常非常简单。正在发送的文件的文件名中有空格。当我从文件名中删除空格时，文件被正常接收。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T06:56:17.853

DAT 文件是 UUEncoded 吗？如果是这样，您的问题可能与此有关。

[http://support.microsoft.com/default.aspx?scid=KB;en-us;q138053](http://support.microsoft.com/default.aspx?scid=KB;en-us;q138053)

几年前有一个 OpenNTF 项目允许您读取 DAT 文件。

[http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/WinmailExtractor](http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/WinmailExtractor)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T09:11:22.307

请 Domino 管理员将以下内容添加到邮件服务器上的 notes.ini 中：

TNEFEnableConversion=1

这将确保 Domino 可以处理由 Exchange 服务器发送的电子邮件，并以 MS TNEF 格式封装。

# json - JSON：序列化番石榴可选

> ID：10723826
> 
> 赞同：4
> 
> 时间：2012-05-23T16:07:24.820
> 
> 标签：json, serialization, jackson, guava, optional

com.google.common.base.Optional 是否有 Json 序列化器/反序列化器？

开箱即用，这似乎不适用于杰克逊，见下文：

```
package com.example;

import java.io.IOException;

import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;

import com.google.common.base.Optional;

public class TestClass {

public Optional<String> myString;

public TestClass() {
    myString = Optional.of("testString");
}

public static void main(String[] args) throws JsonGenerationException, JsonMappingException, IOException {
    TestClass testClass = new TestClass();
    ObjectMapper objectMapper = new ObjectMapper();
    String jsonString = objectMapper.writeValueAsString(testClass);
    System.out.println(jsonString);
} 
```

}

-> {"myString":{"present":true}}

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T13:33:15.680

GitHub 上确实有Jackson 的[Guava 模块](https://github.com/FasterXML/jackson-datatype-guava)，但不支持 Optional（尚）。似乎是一个相当简单的序列化器/反序列化器来实现；该行为应该与@JsonUnwrapped 非常相似，因此对于您的简单测试，结果应该是：

{"myString":"testString"}

对于 Optional.absent，序列化形式应该是：

{"myString":null}

**更新**：看起来很简单，所以我刚刚实现了它并将其推送到 GitHub。您可以通过官方 repo 获取它并从源代码构建，或者等待下一个正式版本。享受！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T23:08:39.217

[这里](https://github.com/FasterXML/jackson-datatype-guava)有一个带有 Guava Jackson 序列化器/反序列化器的库。然而，没有人为`optional`. 但这是一个非常基础的课程，您可以按照那里的示例轻松自己编写一个。然后您可以将代码传递给[Tatu](http://www.linkedin.com/pub/tatu-saloranta/0/36/b2b)，以便他将其添加到库中，这将不胜感激。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-09T12:33:43.377

我有同样的问题，我通过使用 JsonSerializer 和 JsonDeserializer 作为[如何使用 JSON 序列化/反序列化 Option<> 类（函数式 Java）来解决我的问题？](https://stackoverflow.com/questions/22955495/how-to-serialize-deserialize-a-option-class-functional-java-with-json/22956094?noredirect=1#comment35052206_22956094). 希望这可以帮助。

# c# - WiX - 从磁盘启动程序？

> ID：10723828
> 
> 赞同：1
> 
> 时间：2012-05-23T16:07:28.583
> 
> 标签：c#, installation, wix

我有一个可用的 WiX 3.5 安装程序。成功安装后，我知道如何让 WiX 启动刚刚安装的应用程序。

但是，我还想在我的安装 CD 中附带一个从 CD 本身运行的小应用程序 - 我希望它在主应用程序安装结束时弹出。从 CD 运行第二个应用程序很重要。

我的第一次尝试——在安装结束时启动了主应用程序——是这样的：

```
<UI>
    <!--  <UIRef Id="WixUI_Minimal" />  -->
    <Publish Dialog="ExitDialog"
             Control="Finish"
             Event="DoAction"
             Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
</UI>
<Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch MyInstalledApp" />
<Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1" />

<Property Id="WixShellExecTarget" Value="[#MyInstalledApp.exe]" />
<CustomAction Id="LaunchApplication"
    BinaryKey="WixCA"
    DllEntry="WixShellExec"
    Impersonate="yes" /> 
```

但是，我想更改它以启动类似“D:\MyTinyApp.exe”的东西。如何使用 WiX 寻址源 CD？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:20:58.303

试一试。假设您要执行的文件与 MSI 文件位于同一位置，您必须先找到它：

```
<Property Id='WixShellExecTarget'>
    <DirectorySearch Id='DirSearch' Path='[SOURCEDIR]' Depth='0'>
        <FileSearch Id='FileSearch' Name='MyFileToRun.exe'/>
    </DirectorySearch>
</Property>
<CustomAction Id="LaunchApplication"
    BinaryKey="WixCA"
    DllEntry="WixShellExec"
    Impersonate="yes" /> 
```

[SourceDir] 是关键。它应该是 MSI 所在的位置。如果找不到文件，您也可以考虑添加一个条件来做一些有用的事情。

# java - 识别霍夫曼编码算法中的字符位置

> ID：10723829
> 
> 赞同：0
> 
> 时间：2012-05-23T16:07:29.560
> 
> 标签：java, algorithm, compression, huffman-code

我正在阅读 Huffman Coding Algorithm 来对字符串进行编码。我可以看到制作一棵树时考虑了字符的频率。

这是频率表：

```
a   b   d   e   f   h   i   k   n   o   r   s   t   u   v 
5   1   3   7   3   1   1   1   4   1   5   1   2   1   1   9

*space has frequency 9 
```

我可以看到有一棵树是用这个做的。但是我无法得出如何将元素放置在树中的规则。

书上说所有出现频率较高的字都应该在字根附近。但是如果两个以上的字符频率相同，那么它们必须位于词根的不同侧。

问题是，我们如何决定立场？

在我的书中`a`有代码`010`，`r`有`011`并且`e`有代码`100`。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:29:49.823

你试过[维基百科](http://en.wikipedia.org/wiki/Huffman_coding)吗？有一个关于霍夫曼编码的很好的演示。算法很简单：你需要一个[优先队列](http://en.wikipedia.org/wiki/Priority_queue)。

算法有点像这样：

```
1\. Create tree nodes with each character and their frequencies
2\. Put all the letters and their frequencies in a priority queue Q
3\. Do until Q contains only one element:
    3a. Pick two lowest-frequency items a, b
    3b. Create a tree node z with frequency(z) = frequency(a) + frequency(b)
    3c. Add a and b as left and right children of z
    3d. Put z in Q
4\. Pick up the only element from Q. This would be the root of the tree.
5\. Assign binary codes to each leaf node according to their root-to-leaf path. 
```

优先级队列应该设计成最小优先级队列，即频率最低的节点应该最先出来。对于处理相同频率的项目，使用一些其他标准（例如字母顺序）作为决胜局。与编码和解码的平局标准保持一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:24:03.443

一旦你有了你的树，那么如何将 0 和 1 分配给道路上每个岔路口的两个分支是一个任意选择。因此，如果没有使该分配规范化的方法，那么对于如何将位分配给每个符号就没有“正确答案”，例如，`r`必须是`011`. `r`可以是任何三位值。（尽管这组频率的长度必须是三位。）

重要的是解码器获得与编码器相同的 0 和 1 分配。您可以直接发送代码，也可以发送长度并以规范的方式分配 0 和 1。例如，在 zip、gzip、png 等中使用的压缩算法仅发送每个符号的位数。然后从最小长度开始，为该长度的所有符号分配从 0 开始的代码。符号按顺序分配代码，符号按其表示整数排序。例如，字符的 ASCII 排序顺序。对于下一个长度，在右侧添加位并且代码计数继续。这确保了正确的前缀码，从左到右解码。

所以在这种情况下，代码长度是：

```
2: _
3: a, e, r
4: d, f, n
5: b, h, t
6: i, k, o, s, u, v 
```

所以我们得到（每个长度内的符号按字母顺序排列）：

```
_: 00
a: 010
e: 011
r: 100
d: 1010
f: 1011
n: 1100
b: 11010
h: 11011
t: 11100
i: 111010
k: 111011
o: 111100
s: 111101
u: 111110
v: 111111 
```

这里的位分配与书中三个符号中的两个不同。作为其他非常好的规范前缀代码选择的示例，您可以反转所有位，或者您可以反转位列的任何子集。例如，您可以反转整个第一列。您可以更改每个长度的符号顺序。您可以颠倒位顺序。事实上，zip等以相反的顺序存储上面显示的位，因此解码是从最低有效位开始进行的，即从右到左。

# java - 如何在java中创建一个简单但结构良好的乐谱类（乐谱）？

> ID：10723832
> 
> 赞同：6
> 
> 时间：2012-05-23T16:07:49.957
> 
> 标签：java, oop, music-notation

我正在使用非常基本的声音合成在我的游戏中创建音频和效果。基本上，我有一些方法可以在给定频率、幅度和持续时间的情况下播放声音。

对于简短的短语和旋律，我想提出一个基本的符号，以便我可以轻松地重写或在代码中添加新的旋律（最后也许我可以从文件中读取，但这可能是矫枉过正）。

但是，我不确定如何实现这一点。

我首先创建了一个枚举 EqualTemperamentTuning，其中包含所有 88 个基本钢琴音符，带有一个 MIDI # 字段和一个频率字段。这至少意味着我可以处理音符名称而不是频率。

```
public enum EqualTemperamentTuning {
    A_0         (1, 27.5),
    A_SHARP_0   (2, 29.1352),
        ...
    C_8         (88, 4186.01);

    private int num;
    private double frequency;

    EqualTemperamentTuning(int num, double frequency){

        this.num = num;
        this.frequency = frequency;
    }

    public double getFrequency(){
        return frequency;
    }

    public double getNum(){
        return num;
    }
} 
```

然后我开始创建更多对象，首先是一个包含 EqualTemperamentTuning、振幅和长度的 Note：

```
public class Note {

    /** Note frequency */
    private double frequency;
    /** Note Amplitude */
    private double amplitude;
    /** Note length */
    private int length;     

    public Note(EqualTemperamentTuning tuning, double amplitude, int length){

        this.frequency = tuning.getFrequency();
        this.amplitude = amplitude;
        this.length = length;   
    }

    public double getFrequency(){
        return frequency;
    }

    public double getAmplitude(){
        return amplitude;
    }

    public int getLength(){
        return length;  
    }
} 
```

最后为了定义我想要演奏的旋律，我创建了一个 NotePhrase 类：

```
public class NotePhrase {

    /** The arrayList of notes*/
    private Note[] notes;

    public NotePhrase(Note[] notes){

        this.notes = notes;
    }

    public double getFrequency(int counter){

        // for each note in the array
        for (int i = 0; i< notes.length; i++){

            // for each unit of length per note
            for (int j=0; j<notes[i].getLength(); j++){

                counter--;

                // return the frequency at this point
                if (counter <= 0) return notes[i].getFrequency();

            }
        }
        return -1;  
    }
} 
```

然后在我的音频生成类中，我有一个循环（带计数器），它从波形发生器生成样本。每次我需要一个新的样本来播放时，它都会根据上面的 NotePhrase.getFrequency(int counter) 方法设置波形的频率。这应该（我还没有实际测试过！）只是根据频率和幅度（待添加）播放NotePhrase旋律。

问题是，它看起来不是很优雅，更具体地说，很难以任何清晰的方式“写”出旋律。我必须编写一大堆新的 Note 对象，然后用它们的数组构造一个 NotePhrase 对象……对我来说，如何硬编码这些旋律然后在它们之间轻松切换对我来说并不明显。

真的我想创建一个旋律的枚举或类似的东西，我可以很容易地为每个不同的旋律硬编码一个人类可读的配置，然后当我想使用它们时，只需将枚举类型传递给音频播放器.. .

我得到的最好的是：

```
private static enum Melody {
    NOKIA_RINGTONE ( new Note(EqualTemperamentTuning.E_5, 0.5, 1), new Note(EqualTemperamentTuning.D_5, 0.5, 1))
    ;

    private Note[] notes = new Note[2];

    Melody (Note note1, Note note2){
        this.notes[0] = note1;
        this.notes[1] = note2;
    }
} 
```

然后我会在运行时将其加载到 NotePhrase 对象中。这不太好，因为我必须为具有不同数量音符的旋律创建一个新的构造函数。如果我反过来用一系列音符构建枚举，那么我只是在别处和两部分“写”旋律，这似乎更令人困惑......

所以我不知道如何正确地构建它？即要创建什么类以及它们应该保存什么信息......我想得到这个“正确”，因为，我可能想在未来扩展符号以包括效果（回声等），我已经用我的非常很少的经验，正确的类、结构和关系（甚至名称）可以使我的程序非常容易或难以理解。

为这篇文章道歉，这可能不是一个很好的措辞（咳咳）问题，但作为一个 java 和 OOP 初学者，任何提示都会非常受欢迎！

编辑* ***

感谢您的回答和建议，非常有帮助。考虑在这种情况下给出的答案让我重新考虑了我的一般音频实现，这现在非常不稳定。不确定我应该将谁标记为正确，因为我真的只是将所有建议都纳入其中，然后尝试从那里开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:16:07.657

不要对旋律使用枚举，因为旋律并不代表真正的常数，而是音符数据的集合。我建议不要使用数组，而是使用`ArrayList<Note>`更灵活的数组。

在 Melody 中，我会将 Note 与 Measure 和 Beat 联系起来，并给 Melody 类添加一个 addNote(Note, int measure, int beatFraction)，与删除 Note 相同。

考虑将 12 个核心音符作为枚举，然后使用它们加上一个八度整数来创建一个 Note 对象。

...有很多方法可以玩这个练习。“关键”是不断尝试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T16:50:01.610

想到的是实现一个简单的内部[DSL](http://en.wikipedia.org/wiki/Domain-specific_language)，该 DSL 将尽可能接近您用来写下音符的符号。在java中它可能看起来像

```
MelodyTrack  track1 = MelodyTrack().create().setTiming(TimeSignature.C)
.eighth(Notes.E5)
.bar().half(Notes.B5).quarter(Notes.A5).quarter(Notes.B5).bar().half(Notes.C6) 
```

Martin Fowler 写的一[本关于 DSL 的好书](https://rads.stackoverflow.com/amzn/click/com/0321712943)

这只是它的外观示例，我不坚持使用一种或另一种形式 - 基本思想是程序员和领域专家（音乐家）都必须阅读您的 DSL。并且数据在您的音序器中表示的方式不应影响您写下旋律的方式，即使其更难。

PS 如果您正在做一些严肃的事情，您应该尝试使用外部 DSL 又名 midi 文件或类似的东西以及某种排序库，并将音乐存储在应用程序的单独资源文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T16:50:42.010

也许您可以将[Fluent 接口模式](http://en.wikipedia.org/wiki/Fluent_interface)与[Builder 模式](http://en.wikipedia.org/wiki/Builder_pattern)结合使用。然后你可以写：

```
new NotePhraseBuilder()
     .beat(120)
     .measure(fourQuarters)
     .E_5()
     .quarter()
     .D_5()
     .half()
     ...; 
```

NotePhraseBuilder 包含类似`beat()`, `measure()`,`E_5()`的方法，但没有类似`quarter()`,的方法`half()`：

```
class NotePhraseBuilder {
    ...
    public NoteBuilder E_5() {
        return new NoteBuilder(this, E_5);
    }
    ...
}

class NoteBuilder {
    private final NotePhraseBuilder parent;
    private final EqualTemperamentTuning tuning;

    public NoteBuilder(NotePhraseBuilder parent_, EqualTemperamentTuning tuning_) {
        this.parent = parent_;
        this.tuning = tuning_;
    }

    public NotePhraseBuilder quarter() {
        parent.add(new Note(tuning_, parent.getAmplitude(), parent.getTempo() / 4));
        return parent;
    }

    ...
} 
```

您可以将[Hovercraft Full Of Eels](https://stackoverflow.com/users/522444/hovercraft-full-of-eels)中的提示合并到此模式中。

*注意：方法`NotePhraseBuilder.E_5()`和其他类似的方法，以与其名称相同的方式调用`NoteBuilder`-constructor 。`EqualTemperamentTuning`写88个方法好像很浪费，这样可以做得更漂亮吗？*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-23T21:08:47.853

乐谱可以被认为是一系列事件，无论是音符还是音调和节奏的变化。

考虑事件的时间线并从那里构建可能对您来说更有成效。MIDI 协议可能会给你更多的想法。

# c# - 执行 Web 数据提取

> ID：10723837
> 
> 赞同：3
> 
> 时间：2012-05-23T16:08:03.107
> 
> 标签：c#, asp.net-mvc, xpath, web-scraping, html-agility-pack

我已经安装了`HTMLAgilityPack`，但是一旦捕获文档表，我就无法掌握如何提取第一个 td 元素包含格式中今天日期的行`dd-mmm-yy`。

任何人都可以用代码片段指出我正确的方向吗？

目前我有：

```
HtmlDocument doc = new HtmlDocument();
doc.Load("http://lbma.org.uk/pages/printerFriendly.cfm?thisURL=index.cfm&title=gold_fixings&page_id=53&show=2012&type=daily");
foreach(HtmlNode tr in doc.DocumentNode.SelectNodes("tr"))
{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:19:58.183

乐趣。该页面的 Html 格式非常错误，因此我可以看到您的问题。不过，我不会用 10 英尺长的杆子接触 XPath。Linq 让生活变得如此轻松。

```
HtmlWeb web = new HtmlWeb();
HtmlDocument doc = web.Load("http://lbma.org.uk/pages/printerFriendly.cfm?thisURL=index.cfm&title=gold_fixings&page_id=53&show=2012&type=daily");

HtmlNode todaysRow = doc.DocumentNode.Descendants("tr").Where(n => n.InnerText.StartsWith(string.Format("{0:dd-MMM-yy}", DateTime.Today), StringComparison.InvariantCultureIgnoreCase)).FirstOrDefault();
if (todaysRow != null)
{
    List<HtmlNode> cells = todaysRow.Descendants("td").ToList();
    decimal usd = decimal.Parse(cells[1].FirstChild.InnerText);
    decimal gbp = decimal.Parse(cells[2].FirstChild.InnerText);
    // ... etc 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T21:08:30.350

试试这个：

```
Dictionary<string, string> values = new Dictionary<string, string>();
string key, date;
HtmlDocument doc = Load(html);
HtmlNode node = doc.DocumentNode.SelectSingleNode(".//table[@class='pricing detail']");
//this will pull out only the dates, and store them in variable 'date'
foreach(HtmlNode child in node.SelectNodes(".//tr[@class='left']")
{
    date = child.GetInnerText;
}
//this will pull out the dates and the prices, and put them into a mapped data structure for easy (and quick!) referencing
foreach(HtmlNode child in node.SelectNodes(".//tr")
{
    if(child.Attributes.contains("class"))
    {
        key = child.GetInnerText;
    }
    else
    {
        values.Add(key, child.GetInnerText);
    }
} 
```

那么只需将文本放入字典中的数组或字符串中即可。

说明：基本上，这段`foreach()`代码只会在与属性匹配的表中寻找孩子`<tr>`。然后遍历节点集合，并检查节点是否是日期（即，节点是否与属性匹配`<table class="pricing detail">`。如果匹配，则将该节点的值（GetInnerText 位）用作字典键（即日期） 如果比较为假，则代码将后续子节点值添加到字典中，映射到日期键，直到日期键更改。

要将值从字典迁移到输出，我很肯定你可以轻松做到这一点

在格式化日期方面，请参阅[Jacob's answer](https://stackoverflow.com/a/10825627/738448)，他做得非常好，尽管看起来日期已经按照您希望的方式进行了格式化。

我在这里提供了两个 foreach 循环：第一个执行您希望它执行的操作（只需从网站上获取日期）。实际上，我在完全理解您的要求之前就写了第二个，但是如果您想使用它，我会保留它。

**注意** 我故意没有使这段代码灵活......它非常严格地附加到 HTML 的结构上。我这样做有几个原因……首先，学习如何有效刮擦的最好方法是被迫编写灵活的刮擦器，每次使用后不必完全退役。我知道我是站在一个肥皂盒上，但是一旦你真正掌握了一些抓取信息的原则，你会发现你的程序会更容易、更流畅，而且，我敢说……更有趣……编写和维护。第二个是，我想鼓励您真正探索 htmlagilitypack 必须提供的功能。它确实是一个令人印象深刻的库，非常值得花时间来玩弄它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:19:38.773

您需要阅读 XPath。我仍在学习自己，所以可能有比这更好的路径陈述，但你需要做一些类似的事情：

```
foreach(HtmlNode tr in doc.DocumentNode.SelectNodes("tr[td[1] = '03-Jan-12']"))
{

} 
```

# python - 接口和抽象类的 Python 命名约定？

> ID：10723839
> 
> 赞同：18
> 
> 时间：2012-05-23T16:08:10.293
> 
> 标签：python, naming-conventions

Python中命名接口和抽象类的约定是什么？[PEP 8](https://www.python.org/dev/peps/pep-0008/)没有讨论这个。例如，在 Java 中，接口通常以`I`前缀命名。在 PHP（在命名空间之前）中，抽象类通常使用`_Abstract`后缀命名。

（我意识到Pythonists并不热衷于接口，也许这就是我在这个话题上找不到太多共识的原因。但是接口和抽象类的使用不是我的问题。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T16:13:07.633

[除了PEP8](http://www.python.org/dev/peps/pep-0008/)之外，我不知道在这方面有任何社区范围的标准，它没有具体解决这个问题。

我建议做任何你的团队最舒服的事情，但最重要的*是要保持一致*。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-11-04T20:11:52.747

我会查看数字塔（来自[`numbers`](https://docs.python.org/3/library/numbers.html)）、集合 ABC（来自[`collections.abc`](https://docs.python.org/3/library/collections.abc.html)）或其他核心 ABC（例如[`importlib.abc`](https://docs.python.org/3/library/importlib.html#module-importlib.abc)），以获得最“Pythonic”的方式来执行此操作。

对此的共识是按原样命名它们，并让人类理解将它们识别为抽象的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-23T17:17:36.417

我认为用前缀命名接口`I`是完全可以接受的。

例如：

*   `IFoo`
*   `IPublishable`

几年前，我使用了 Zope Interfaces。我注意到大多数代码库都使用这种约定。我们的团队也这样做了。

我们更喜欢`IFoo`与`FooInterface`或`IFooInterface`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-13T10:04:40.933

## TL;博士

如果您不关心[类型提示](https://www.python.org/dev/peps/pep-0484/)，请随意命名它们。否则，[`ABC`s](https://docs.python.org/3/library/abc.html)是您为其他开发人员提供的 API。他们的名字应该是干净的，没有任何杂乱。具体的实现应该会告诉你为什么它很特别。

打电话给你的班级`User`，`ServerUser`和`LocalUser`

* * *

## 为什么我们首先需要这样的约定？

第一个应该问自己的是，我们为什么要关心类的命名？

在[静态类型语言](https://stackoverflow.com/a/1517670/4298200)（python 不是）中，您的接口名称代表一个 API，其他开发人员通过该 API 与您的代码进行交互。所以函数的调用者应该很快就能理解参数和返回类型的含义。Java 中的一个示例（[其中前缀 Interfaces 前段时间已经过时..](https://stackoverflow.com/a/542122/4298200)）将是：

```
public void signupUsers(Collection<User> users) {
    // TODO: do something with users
} 
```

在这里，我们希望名称尽可能纯净。我们接受任何`Collection`和任何`User`。它可能是`ArrayList`,或`HashSet`,我们不在乎。`LocalUser``ServerUser`

## 为什么 Python 中没有这样的标准？

这与 python 无关，因为它是一种[动态类型语言](https://stackoverflow.com/a/1517670/4298200)。在下面的代码中，你不需要关心类是如何被调用的：

```
def signup_users(users):
    pass  # TODO: do something with users 
```

你只会在创建一个类并检查它的类型时才有意义，这不足以证明一个完整的命名约定是合理的

## 为什么现在有人会关心 Python 中的类命名？

但是由于[引入了类型模块](https://www.python.org/dev/peps/pep-0484/)，事情正在发生变化。您现在可以显式声明类型。如果我们想接受这个新特性，我们应该考虑类的命名。

## 那么我们的类应该取什么名字呢？

按照与为什么其他语言放弃接口前缀的相同逻辑，我相信[`ABC`s](https://docs.python.org/3/library/abc.html)（如果它们与接口起类似的作用）应该有一个干净的名称。like 的名称比 .`User`好读得多`IUser`。如果您有用户的具体实现，那么该实现的名称应该告诉您它有什么特别之处。是使用来自服务器的数据更新数据的用户吗？调用它`ServerUser`。您是否在本地存储用户数据？调用它`LocalUser`。

```
def signup_users(users: Iterable[User]) -> None:
    pass  # TODO: do something with users 
```

关心实现细节的“丑陋”代码如下所示：

```
lovelace = LocalUser("Aida", "Lovelace", 1815)
babbage = ServerUser("htts://some_service.com/users/charles_babbage")
signup_users([aida, babbage]) 
```

这将处理复杂名称的负担放在必须处理实现的调用者身上——因为它应该

# iphone - 如何在一个滚动视图中有多个滚动视图

> ID：10723841
> 
> 赞同：3
> 
> 时间：2012-05-23T16:08:14.797
> 
> 标签：iphone, touch, scrollview, gesture

我想要一个启用水平滚动的大滚动视图。在这个滚动视图中，我想拥有（比方说）5 个其他可以垂直滚动的滚动视图。

谁能指出我如何处理触摸事件的正确方向？

我正在考虑制作两个手势识别器（1 个用于点击，1 个用于平移）并使用 X 和 Y 值的增量来计算水平或垂直滑动。检查方向后，我将大滚动条或其中一个滚动条设置为启用或禁用。这是正确的方法吗？

* * *

编辑：我没有使用上面的方法，而是通过将 5 个滚动视图添加为大滚动视图的子视图，将我的 5 个滚动视图（垂直滚动）添加到一个大滚动视图（水平）中。也许这段代码也可以帮助某人，因此也提供了示例代码。

```
for (int i = 0; i < NumberOfVerticalScrollers; i++) {
        CGRect frame;
        frame.origin.x = self.scrollView.frame.size.width * i;
        frame.origin.y = 0;
        frame.size = self.scrollView.frame.size;

        UIScrollView *scroller = [[UIScrollView alloc] initWithFrame:frame];
        scroller.directionalLockEnabled = YES;
        scroller.contentSize = CGSizeMake(320, 960);
        [self.scrollView addSubview:scroller];
}
self.scrollView.delegate = self;
self.scrollView.contentSize = CGSizeMake(self.scrollView.frame.size.width * NumberOfVerticalScrollers, self.scrollView.frame.size.height); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:33:30.930

为此，您只需制作 1 个水平滚动视图，在其中添加其他垂直滚动视图作为子视图。要处理的重要事情是当基本滚动视图将水平滚动时，您应该禁用垂直滚动视图上的滚动。

您可以收听：

```
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView 
```

当发生这种情况时，您可以禁用垂直滚动视图上的滚动

在以下您启用回滚：

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:48:02.730

您只需要创建一个可以水平滚动的主滚动视图，并且只需要使用`addSubView`方法在主滚动视图上添加其他滚动视图。iOS 处理所有必要的事件以正确处理滚动。您只需要为每个滚动视图分配正确的`content size`和`frame`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:30:37.660

我认为你不需要做任何花哨的事情。

[看到这个问题](https://stackoverflow.com/questions/8229940/triple-nested-uiscrollview-paging-issue)

在链接到该问题的示例中，如果您禁用缩放和弹跳，您应该会看到它可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T16:37:38.187

有一个名为“Pulse”的应用程序使用垂直表格视图，其中每个表格视图单元格都可以水平滚动并包含另一个表格视图。这负责缓存和 UI 事件。您需要找到一个示例并根据您的目的对其进行评估（可能将默认实现旋转 90 度）

[如何重新创建类似 Pulse 的 UI？](https://stackoverflow.com/questions/5850433/how-to-recreate-a-pulse-like-ui)

# ebay-api - eBay API findItemsAdvanced 请求为某些类别返回 0 个结果

> ID：10723845
> 
> 赞同：0
> 
> 时间：2012-05-23T16:08:25.830
> 
> 标签：ebay-api

这真是奇怪的行为。当我尝试`findItemsAdvanced`使用以下 XML 进行搜索以获取图书类别中的项目（编号为 267）时：

```
<findItemsAdvancedRequest xmlns="http://www.ebay.com/marketplace/search/v1/services">
<categoryId>267</categoryId>
<descriptionSearch>true</descriptionSearch>
<paginationInput><entriesPerPage>100</entriesPerPage><pageNumber>1</pageNumber></paginationInput>
<sortOrder>BestMatch</sortOrder>
</findItemsAdvancedRequest> 
```

我得到 0 个项目的结果响应。但是，如果我只是将类别编号更改为其他类别教科书教育（类别编号 2228），例如：

```
<findItemsAdvancedRequest xmlns="http://www.ebay.com/marketplace/search/v1/services">
<categoryId>2228</categoryId>
<descriptionSearch>true</descriptionSearch>
<paginationInput><entriesPerPage>100</entriesPerPage><pageNumber>1</pageNumber></paginationInput>
<sortOrder>BestMatch</sortOrder>
</findItemsAdvancedRequest> 
```

一切都很好，我得到了一个包含 100 个项目的响应搜索结果。这是什么原因？图书类别有我遗漏的任何细节吗？

任何人都可以测试看看这种罕见的行为是否不是我的应用程序独有的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:25:54.560

删除 true 解决问题。我真的不知道为什么 API 调用适用于某些类别而不适用于其他类别，但可以在[http://developer.ebay.com/devzone/finding/callref/findItemsAdvanced.html#Request 阅读。 descriptionSearch](http://developer.ebay.com/devzone/finding/callref/findItemsAdvanced.html#Request.descriptionSearch)对该请求 xml 标记的解释，确实，它与类别搜索无关。

Eswara Rajesh 的答案的学分。

# python - 打印出内系列

> ID：10723847
> 
> 赞同：0
> 
> 时间：2012-05-23T16:08:37.527
> 
> 标签：python, pandas

```
In [139]: pandas.__version__
Out[139]: '0.7.3' 
```

我有两个对齐的系列，`DataFrame`其中有几个无与伦比的“NaN”。我想打印它们之间的交集，删除所有“NaN”，但没有松散的对齐。也就是说，我想从两个系列中删除我在其中一个系列中找到“NaN”的行。这听起来很简单，但我没有在系列之间对 dropna 进行任何操作，并且不能单独从系列中 dropna。我无法找出正确的 df 函数来执行此操作 - 有几个没有记录。只是一个例子，我想拿这个：

```
10         NaN     -1.200
11         NaN     -1.324
12    0.000585        NaN
13    0.000573     -1.453
14         NaN     -2.006 
```

并打印：

```
13    0.000573     -1.453 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:23:19.543

正如我在上面的评论中所写，最好的答案是：

```
newdf = df1.dropna()[['S', 'JEXP']] 
```

那个dropan来自原始df的一部分，只保留了感兴趣的系列。卡梅尔建议：

```
newdf = df1.dropna(subset=['S', 'JEXP']) 
```

它也可以工作，并且基于子集列表的 dropan，但是，保留所有其他系列 - 它复制了您的数据集。

# zabbix - zabbix 报错字符串

> ID：10723849
> 
> 赞同：0
> 
> 时间：2012-05-23T16:08:41.837
> 
> 标签：zabbix

假设通过代理使用 zabbix 监控存储。我们希望当 zabbix 存储失败时通过某些脚本生成的错误描述通过电子邮件发送给我们。zabbix 是否有可能获取字符串输出（ala nagios）并报告它（不仅仅是字符串监控和报告找到/未找到）还是报告仅适用于整数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T18:37:38.230

使用 Zabbix 进行字符串或文本正则表达式检查非常容易。您可以通过简单的命令行检查来执行此操作，该检查将回显错误或“ok”消息。

例如，您想检查日志中的“驱动器故障”并发送电子邮件，我会在 Zabbix 中将其作为“密钥”执行类似的操作。

```
system.run[grep 'drive failure' /var/log/message || echo 'okay'] 
```

将检查设置为“文本”，它将报告 grepped 匹配或正常消息。然后，您可以在警报中使用正则表达式为任何与“OK”不匹配的内容发送电子邮件，例如：

```
{your_template:system.run[grep 'drive failure' /var/log/message || echo 'OK'].regexp(OK)}#1 
```

如果它收到除“OK”以外的任何文本行，这将发出警报。

在 Zabbix 中处理文本时有一些限制。首先是 Zabbix 只报告第一行。第二个是检查必须*始终*返回文本，无论是正常消息还是错误。如果你检查出来是空的，Zabbix 会认为它已经坏了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T10:36:49.240

您可以创建一个包含错误文本的文本或日志项目，并使用该项目创建一个触发器，例如检查单词“error”或某个值。为该触发器创建一个操作并将该项的值包含在通知中，请使用 {ITEM.LASTVALUE} 宏。

这是您可以在通知中使用的宏列表[http://www.zabbix.com/documentation/2.0/manual/appendix/macros/supported_by_location](http://www.zabbix.com/documentation/2.0/manual/appendix/macros/supported_by_location)。

# java - GWT - DialogBox.center() 无法正常工作

> ID：10723855
> 
> 赞同：3
> 
> 时间：2012-05-23T16:09:04.637
> 
> 标签：java, gwt

我的页面上有一个带有按钮的表格。按钮太多了，我有一个滚动条可以向下滚动我的表格。

按钮“onClick”生成一个带有滚动面板、内容和关闭此对话框的按钮的对话框。我使用 DialogBox.center() 将其居中。当我按下时，假设表格中的第一个按钮，对话框严格出现在中心......但是当我向下滚动页面并按下表格底部的按钮时，我的对话框仍然出现在“旧”中中心...几乎在我的视野之上。它根本不会根据我的滚动条位置向下移动。我尝试更改 setPopupPosition()、setPopupPositionAndShow() 等，但没有帮助。

有什么想法有什么问题吗？这是我的对话框的一些代码：

```
public class MyDialogBox extends DialogBox {

    public MyDialogBox(final String caption, final String text) {
        setText("Caption: " + caption);

        VerticalPanel inner = new VerticalPanel();
        Label msg = new Label(text);

        Button ok = new Button("Close");
        ok.addClickHandler(new ClickHandler() {
            public void onClick(ClickEvent event) {
                    MessageTextBox.this.hide();
                }
        });

        inner.add(msg);
        ScrollPanel scrollbar = new ScrollPanel(inner);
        scrollbar.setSize("640", "480");
        VerticalPanel outer = new VerticalPanel();
        outer.add(scrollbar);
        outer.add(ok);
        setWidget(outer);
    }
} 
```

这是我的按钮如何称呼它：

```
VerticalPanel mainPanel ... //MainPanel with a lot different elements, it contains panel with buttons
VerticalPanel panel ... //Panel with buttons
panel.setViewButtonHandler(new ClickHandler() {
    public void onClick(ClickEvent event) {
        MyDialogBox dialogBox = new MyDialogBox("Caption", "Some text");
        dialogBox.center();
        dialogBox.show();
     }
});
mainPanel.add(panel); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:08:22.797

上述问题的根源似乎很简单。Chrome 无法正确居中对话框。我检查了 FF，IE ......它按计划工作。

# hibernate - 在视图中具有重复主键的重复行

> ID：10723860
> 
> 赞同：0
> 
> 时间：2012-05-23T16:09:22.333
> 
> 标签：hibernate

我有我查看（2 个表和 1 个关联）并且我像这样映射它

```
@Id
@Column(name = "IDBQ", precision = 5, scale = 0)
public Integer getIdbq() {
    return this.idbq;
}

public void setIdbq(Integer idbq) {
    this.idbq = idbq;
}

@Column(name = "IDR", precision = 22, scale = 0)
public Integer getIdr() {
    return this.idr;
}

public void setIdr(Integer idr) {
    this.idr = idr;
}

@Column(name = "NOM_CLIENT",  length = 100)
public String getNomClient() {
    return this.nomClient;
}

public void setNomClient(String nomClient) {
    this.nomClient = nomClient;
}

@Column(name = "PRENOM_CLIENT",  length = 30)
public String getPrenomClient() {
    return this.prenomClient;
} 
```

并且因为它是一个视图，许多行中的主键**IDBQ**是重复的。当我从hibernate发出请求hql时，它返回的问题是：重复的行有重复的Id - > IDBQ

如果我有 ：

```
IDBQ -- IDR -- NOM_CLIENT -- PRENOM_CLIENT
1       1     xx            xxx
1       2     yy            yyy 
```

它在我的 hql 请求中返回我

```
1       1     xx            xxx
1       1     xx            xxx 
```

但 sql 请求工作正常！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:40:03.300

如果您的视图中有几行具有相同 ID，则表示您的 ID 不是 ID。从您发布的内容来看，它似乎`[IDBQ, IDR]`应该是实体的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-29T12:34:19.780

您看到重复行的原因是因为您有 2 条具有相同主键的记录（在您的情况下为 IDBQ）。从数据库中检索数据时，具有相同标识符的记录将引用相同的对象（取决于顺序）。这称为身份映射模式。[点击此链接了解更多信息！](https://en.wikipedia.org/wiki/Identity_map_pattern)

即使您的视图在查询编辑器上有 2 个具有相同标识符的不同行，您的实体框架也会产生不正确的输出。当从数据库加载 IDBQ 值为“1”的第一行时，将按预期检索它，但当检索到具有相同 IDBQ 值“1”的第二行时，返回相同的对象 (1 | 1 | xx | xxx)，因为已加载 PK '1' 的对象。希望你觉得这很有帮助。

# android - 如何在特定时间重新启动应用程序

> ID：10723862
> 
> 赞同：0
> 
> 时间：2012-05-23T16:09:26.993
> 
> 标签：android

我有一项服务和一些活动，我希望整个应用程序将在特定时间重新启动，例如（03:00 pm），你知道有什么方法可以做到这一点，所以在凌晨 3 点，整个应用程序重新启动？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:21:45.190

您可以使用 unix/linux 中流行的基于时间的调度程序 Cron。默认情况下它是不活动的。需要一些破解。但我认为你可以使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)这是一个系统服务。

```
AlarmManager myAlarmManager = Context.getSystemService(Context.ALARM_SERVICE). 
```

如果您需要在系统重新启动后保持活力。然后你必须在设备重启后安排他的警报。并且需要在你的 AndroidManifest.xml 中有 RECEIVE_BOOT_COMPLETED 权限

# apache - 对于特定链接，将进入端口 80 的请求转发到本地端口 8080

> ID：10723863
> 
> 赞同：0
> 
> 时间：2012-05-23T16:09:28.233
> 
> 标签：apache, reverse-proxy, wampserver

我有 2 个 Web 表单，一个在 glassfish（端口 8080）上使用 Java Servlet 编码，另一个在 apache（端口 80）上使用 PHP。但是我的办公室 IT 部门拒绝向外部流量开放 8080 端口。如何设置 Apache，以便将带有 servlet 的表单的请求定向到端口 8080？谢谢 TX PS：我正在使用 wamp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T00:43:13.660

使用[ProxyPass 指令](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypass)是通常的做法。

```
ProxyPass /url/ http://127.0.0.1:8080/url/ 
```

# jquery - 获取上一页控件的值

> ID：10723865
> 
> 赞同：0
> 
> 时间：2012-05-23T16:09:39.527
> 
> 标签：jquery, asp.net, query-string

我的页面包含 4 个选项卡（使用 Jquery Accordian）。

选项卡 1.) 用户选择设备制造商和型号（Default.aspx）

Tab 2.) 用户确认我们的回购价格（GetPrice.aspx 已加载到 Tab2）

选项卡 3.) 用户输入联系信息 (Default.aspx)

Tab 4.)显示用户信息的确认页面（Conf.aspx被加载到Tab3中）

出现问题是因为我需要我的 CodeBehind(on Conf.aspx) 才能访问用户的联系信息。如果我通过查询字符串传递值，它将使用户能够篡改它并将错误信息插入我的数据库。请记住，所有这些都是在没有回发的情况下完成的。

所以我需要：

1.）一种防篡改查询字符串的方法（保留在我的查询字符串中将包含电话号码、电子邮件地址、州、城市、邮编等）

或者

2.)获取前一个字段值的简单方法（来自 Conf.aspx CodeBehind: A Way to retreive the values on the controlls on Default.aspx）

对不起，很长的文字块，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:34:03.660

我不确定每个选项卡是否需要单独的网络表单。您可能会重新构建您的解决方案以面向服务。您的逻辑可以通过网络服务获得，并且您的选项卡都可以在同一个视图中。这样做的 webform 方式会更复杂。

# jquery - 如何使 DOM 元素不受 Jquery Mobile 自动设置 UI 类的影响？

> ID：10723872
> 
> 赞同：1
> 
> 时间：2012-05-23T16:10:11.773
> 
> 标签：jquery, jquery-mobile

也许我的问题有点混乱，让我澄清一下。

我正在使用 Jquery Mobile，我想要它的屏幕转换和其他东西，但我不希望所有这些 UI 样式自动应用于我的元素。

我当前的问题是应用于我的链接的**ui-link 。**其他的*ui-whatever*暂时不打扰我。

**我想以“友好的方式”避免这个问题（无需重写大量 CSS 或再次删除它们）。**

有什么方法可以使元素不受这些自动样式的影响？

我写的代码：

```
<div class="page" id="home" data-role="page">
   <a class="bt" href="#page2">Page Two</a>
</div> 
```

Jquery Mobile 生成的代码

```
<div id="home" class="page ui-page ui-body-c ui-page-active" data-role="page" data-url="home" tabindex="0" style="min-height: 361px;">
   <a class="bt ui-link" href="#page2">Page Two</a>
</div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:28:02.093

找到了！希望它可以帮助有同样问题的人。

只需应用于`data-role="none"`元素。

> 防止表单元素的自动初始化
> 
> 如果您希望 jQuery Mobile 不触及特定的表单控件，只需为该元素赋予属性 data-role="none"。例如：

```
<label for="foo">
<select name="foo" id="foo"  data-role="none">
    <option value="a" >A</option>
    <option value="b" >B</option>
    <option value="c" >C</option>
</select> 
```

[http://jquerymobile.com/demos/1.0b2/#/demos/1.0b2/docs/forms/docs-forms.html](http://jquerymobile.com/demos/1.0b2/#/demos/1.0b2/docs/forms/docs-forms.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:11:41.800

```
$(".ui-link").removeClass("ui-link"); 
```

那应该从所有拥有它的类中删除该类:-)

# blackberry - 如何获取安装在我的黑莓手机上的所有应用程序的指南。

> ID：10723880
> 
> 赞同：0
> 
> 时间：2012-05-23T16:10:29.850
> 
> 标签：blackberry, listener, guid

我是一名黑莓应用程序开发人员，不仅仅是初学者。我想构建一个应用程序，它可以确定打开哪个（第 3 方或本机）应用程序以及在什么时间打开？
我研究了很多，但没有发现任何有用的东西。我的应用程序会有一个界面，它会询问用户要跟踪哪些应用程序。那么是否可以以编程方式获取该应用程序的 guid，并通过在我的应用程序中使用全局事件侦听器，我可以比较存储的 guid 和通过全局事件侦听器获得的 guid。

***简而言之，如何获取我手机上安装的所有应用程序的 Guid。***

请帮助我，如果你曾经使用或研究过这样的东西。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T13:57:47.147

[http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800620/What_Is_-_System_Global_Events.html?nodeid=1163085&vernum=0](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800620/What_Is_-_System_Global_Events.html?nodeid=1163085&vernum=0)

我认为没有任何方法可以获取设备上所有应用程序的 GUID，无论它们是在后台/前台运行还是完全被杀死。GUID 只能通过某些 API 获得，您可以找到所有可能的 GUID 列表，您可以通过以下 URL 以编程方式获取这些 GUID：

[http://www.blackberry.com/developers/docs/6.0.0api/constant-values.html#net.rim.device.api.system.EventLogger.SYSTEM_LOG_GUID](http://www.blackberry.com/developers/docs/6.0.0api/constant-values.html#net.rim.device.api.system.EventLogger.SYSTEM_LOG_GUID)

希望这可以帮助..！

# perl - 如何使用 Perl 处理大数据文件？

> ID：10723889
> 
> 赞同：-1
> 
> 时间：2012-05-23T16:11:13.497
> 
> 标签：perl, bigdata

我有一个 300GB 的文件，我需要一些如下所示的行。从下面显示的行中，我只需要以 . 开头的行`>miR`。

我已经编写了一个 Perl 程序，它实际上打印了我想要的输出，但是当我将相同的代码应用于高达 300 GB 数据的更大文件（如下所示的类似行）时，如何进行呢？是否有任何替代方法可以在此代码中实现，因为如果代码运行，它就会被杀死。

```
#!/usr/bin/perl -w
$len=@ARGV;
if($len eq 0){
    print "Give file \n";
    exit;
}
$file=$ARGV[0];
open(FH,$file) || die "cant open file\n";
@lines=<FH>;
close FH;
while ($line=<FH>){
    chomp $line;
    if ($line =~ /^>miR/){
        $_=$line;
        s/>//g && s/,//g;
        print "$_\n";
        if($_=~ /(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)\s(\S+)/){
            print $1,"\t",$2,"\t",$7,"\t",$3,"\n";
        } 
```

.

```
Forward:    Score: 124.000000  Q:2 to 18  R:1 to 20 Align Len (17) (64.71%) (82.35%)

   Query:    3' gaauAUUCGUUAG-AAUGGUAa 5'
                    |:: :|||| || |||| 
   Ref:      5' --ctTGGTTAATCATTCCCATt 3'

   Energy:  -10.480000 kCal/Mol

Scores for this hit:
>miR844a    AT2G33810,  124.00  -10.48  2 18    1 20    17  64.71%  82.35%

   Forward: Score: 120.000000  Q:2 to 19  R:289 to 308 Align Len (17) (64.71%) (76.47%)

   Query:    3' gaaUAUUCGUUAGAAUGGUAa 5'
                   ||::| ||  || |||| 
   Ref:      5' ttgATGGG-AAAATTTCCATt 3'

   Energy:  -9.850000 kCal/Mol

Scores for this hit:
>miR844a    AT2G33810,  120.00  -9.85   2 19    289 308 17  64.71%  76.47%

   Forward: Score: 118.000000  Q:2 to 19  R:483 to 503 Align Len (17) (64.71%) (82.35%)

   Query:    3' gaaUAUUCGUUAGAAUGGUAa 5'
                   :||:  |||| ||:||| 
   Ref:      5' gggGTAGAAAATCATATCATa 3' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T17:03:52.670

我们可以设置`local $/ = '>'`（作为记录分隔符），然后使用如下：

```
use Modern::Perl;

{
    local $/ = '>';
    while (<DATA>){
        next if !/^miR/;
        s/,//g;
        my($var0, $var1, $var2, $var6) = (split ' ', $_, 8)[0..2, 6];
        say"$var0,\t$var1,\t$var6,\t$var2";
    }
}

__DATA__
>miR844a    AT2G33810,  124.00  -10.48  2 18    1 20    17  64.71%  82.35%

   Forward: Score: 120.000000  Q:2 to 19  R:289 to 308 Align Len (17) (64.71%) (76.47%)

   Query:    3' gaaUAUUCGUUAGAAUGGUAa 5'
                   ||::| ||  || |||| 
   Ref:      5' ttgATGGG-AAAATTTCCATt 3'

   Energy:  -9.850000 kCal/Mol

Scores for this hit:
>moR844a    AT2G33810,  120.00  -9.85   2 19    289 308 17  64.71%  76.47%

   Forward: Score: 118.000000  Q:2 to 19  R:483 to 503 Align Len (17) (64.71%) (82.35%)

   Query:    3' gaaUAUUCGUUAGAAUGGUAa 5'
                   :||:  |||| ||:||| 
   Ref:      5' gggGTAGAAAATCATATCATa 3'
>miR844a    AT2G33810,  120.00  -9.85   2 19    289 308 17  64.71%  76.47%

   Forward: Score: 118.000000  Q:2 to 19  R:483 to 503 Align Len (17) (64.71%) (82.35%)

   Query:    3' gaaUAUUCGUUAGAAUGGUAa 5'
                   :||:  |||| ||:||| 
   Ref:      5' gggGTAGAAAATCATATCATa 3' 
```

输出：

```
miR844a,    AT2G33810,  1,  124.00
miR844a,    AT2G33810,  289,    120.00 
```

如果当前记录不以“miR”开头，则请求下一条记录（以“>”开头的记录），否则删除任何逗号，然后拆分记录以获取您所追求的值（来自您的正则表达式）。

希望这可以帮助！

# android - 应用无法找到启动器活动

> ID：10723890
> 
> 赞同：1
> 
> 时间：2012-05-23T16:11:17.047
> 
> 标签：android, splash-screen

我刚刚开始开发一个全新的应用程序，我设置了两个活动，一个显示启动画面，另一个显示主屏幕。这是清单文件：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Splash"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.SPLASH" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

我尝试更改 android.intent.action 并从 Main 中删除 DEFAULT Category 行，并将 Splash Activity 设置放在 main 上方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:00:32.080

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".Splash"
        android:label="@string/app_name" >
    </activity>
</application> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:00:56.897

刚刚意识到 .MAIN in action 和 .LAUNCHER 应该在同一个活动中，它现在正在工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:14:59.503

检查此 [Android：未找到启动器活动！以前在工作](https://stackoverflow.com/questions/7397476/android-no-launcher-activity-found-was-working-before)

# c++ - 在 C++ 中隐藏 int 变量的名称

> ID：10723892
> 
> 赞同：7
> 
> 时间：2012-05-23T16:11:20.433
> 
> 标签：c++, scope, standards, copy-constructor

出于好奇，我尝试了这段代码，来自一个面试问题[*]

```
int main(int argc, char *argv[])
{
    int a = 1234;
    printf("Outer: %d\n", a);
    {
        int a(a);
        printf("Inner: %d\n", a);
    }
} 
```

在 Linux（g++ 4.6.3 和 clang++ 3.0）上编译时，它输出：

```
Outer: 1234
Inner: -1217375632 
```

但是在 Windows (VS2010) 上它会打印：

```
Outer: 1234
Inner: 1234 
```

基本原理是，在第二个“a”变量的复制构造函数完成之前，第一个“a”变量仍然可以访问。但是我不确定这是否是标准行为，或者只是（另一个）微软的怪癖。

任何的想法？

[*] 实际问题是：

> 如何在不使用临时变量或全局变量的情况下使用包含范围内的同名变量的值来初始化范围内的变量？

```
{
    // Not at global scope here
    int a = 1234;
    {
        int a;
        // how do you set this a to the value of the containing scope a ?
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T16:28:34.647

> 如何在不使用临时变量或全局变量的情况下使用包含范围内的同名变量的值来初始化范围内的变量？

除非可以显式命名外部范围，否则您不能这样做。您可以显式命名全局范围、命名空间范围和类范围，但不能显式命名函数或块语句范围。

* * *

C++11 [basic.scope.pdecl 3.3.2 p1 状态：

> 名称的*声明点*紧跟在它的完整声明符（第 8 条）之后和它的*初始化器*（如果有的话）之前，除非下面提到。[*示例：*
> 
> ```
> int x = 12;
> { int x = x; } 
> ```
> 
> *这里第二个 x 用它自己的（不确定的）值初始化。—结束示例*]

MSVC 正确地实现了这个例子，但是当初始化器使用括号而不是赋值语法时它没有正确地实现它。在 microsoft connect 上有[一个关于此的错误。](http://connect.microsoft.com/VisualStudio/feedback/details/695909/c-parser-places-point-of-declaration-incorrectly-for-some-initialization-syntaxes#details)

这是一个示例程序，由于此错误，VS 中的行为不正确。

```
#include <iostream>

int foo(char) { return 0; }
int foo(int) { return 1; } 

int main()
{
    char x = 'a';
    {
        int x = foo(static_cast<decltype(x)>(0));
        std::cout << "'=' initialization has correct behavior? " << (x?"Yes":"No") << ".\n";
    }
    {
        int x(foo(static_cast<decltype(x)>(0)));
        std::cout << "'()' initialization has correct behavior? " << (x?"Yes":"No") << ".\n";
    }
} 
```

C++ 包括以下注释。

> [*注意：涉及不确定值的操作可能会导致未定义的行为。——尾注*]

但是，此注释表明操作*可能会*导致未定义的行为，而不是它们一定*会这样做*。上面链接的错误报告包括来自 Microsoft 的确认，即这是一个错误，而不是程序触发未定义的行为。

**编辑：**现在我已经更改了示例，以便具有不确定值的对象仅在未评估的上下文中“使用”，我相信这绝对排除了任何平台上未定义行为的可能性，同时仍然展示了错误视觉工作室。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T17:44:38.760

> 如何在不使用临时变量或全局变量的情况下使用包含范围内的同名变量的值来初始化范围内的变量？

如果您想获得有关措辞的技术知识，那很容易。“临时”在 C++ 中具有特定含义（参见第 12.2 节）；您创建的任何命名变量都不是临时变量。因此，您可以创建一个使用正确值初始化的局部变量（*不是临时变量）：*

```
int a = 1234;
{ 
   int b = a;
   int a = b;
} 
```

一个更合理的可能性是在外部范围内使用对变量的引用：

```
int a = 1234;
{ 
    int &ref_a = a;
    int a = ref_a;
} 
```

这根本不会创建额外的变量——它只是在外部范围内创建变量的别名。由于别名有不同的名称，我们保留在外部范围内对变量的访问，而无需定义变量（临时或其他）来这样做。许多引用在内部实现为指针，但在这种情况下（至少在现代编译器和优化打开的情况下）我希望它不会 - 别名实际上只会被视为引用变量的不同名称在外部范围内（使用 VC++ 进行的快速测试表明它以这种方式工作——生成的汇编语言根本不使用`ref_a`）。

沿着相同思路的另一种可能性是这样的：

```
const int a = 10;
{ 
    enum { a_val = a };
    int a = a_val;
} 
```

这有点类似于参考，除了在这种情况下，甚至没有争论是否`a_val`可以称为变量的空间——它绝对*不是*变量。问题是枚举只能用常量表达式初始化，所以我们必须定义外部变量`const`才能使其工作。

我怀疑其中任何一个都是面试官真正想要的，但他们都回答了所陈述的问题。第一个是（诚然）关于术语定义的纯技术性。第二个可能仍然对某些论点持开放态度（许多人认为引用是变量）。虽然它限制了范围，但没有关于第三个问题或争论的余地。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T16:14:19.987

你正在做的，用它自己初始化一个变量，是未定义的行为。你所有的测试用例都做对了，这不是一个怪癖。一个实现也可以初始化`a`为`123456789`，它仍然是标准的。

**更新：**对此答案的评论指出，用自身初始化变量不是未定义的行为，但尝试读取此类变量是。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T16:49:29.033

> 如何在不使用临时变量或全局变量的情况下使用包含范围内的同名变量的值来初始化范围内的变量？

你不能。一旦声明了相同的名称，外部名称就无法在其余范围内访问。您需要外部变量的副本或别名，这意味着您需要一个临时变量。

我很惊讶，即使警告级别提高了，VC++ 也没有在这一行抱怨：

```
int a(a); 
```

Visual C++ 有时会警告您隐藏变量（可能只针对派生类的成员）。在初始化之前告诉你你正在使用一个值通常也很好，这里就是这种情况。

查看生成的代码，它恰好将内部 a 初始化为与外部 a 相同的值，因为那是寄存器中留下的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T09:24:12.707

我看了一下标准，它实际上是一个灰色区域，但这是我的 2 美分......

> 3.1 声明和定义 [basic.def]
> 
> 1.  声明将名称引入翻译单元或重新声明先前声明引入的名称。
>     
>     
> 2.  声明是一个定义，除非... [以下非相关情况]
>     
>     
> 
> 3.3.1 声明点
> 
> 1.  名称的声明点紧跟在它的完整声明符之后和它的初始化器（如果有的话）之前，除了下面提到的[自赋值示例]。
>     
>     
> 2.  非本地名称在声明隐藏它的本地名称之前一直可见。

现在，如果我们假设这是内部“a”的声明点（3.3.1/1）

```
int a (a);
     ^ 
```

那么外部 'a' 应该是可见的，直到定义了内部 'a' 的点 (3.3.1/2)。

问题是在这种情况下，根据 3.1/2，声明就是定义。这意味着应该创建内部“a”。在那之前，我无法从标准中了解外部“a”是否仍然可见。VS2010 假定它是，括号内的所有内容均指外部范围。然而，clang++ 和 g++ 将该行视为自赋值的情况，这会导致未定义的行为。

我不确定哪种方法是正确的，但我发现 VS2010 更加一致：在完全创建内部“a”之前，外部范围仍然可见。

# android - 防止 Android GL 上下文丢失

> ID：10723894
> 
> 赞同：2
> 
> 时间：2012-05-23T16:11:35.480
> 
> 标签：android, opengl-es-2.0

很抱歉再次提出这个问题，因为我确信它已经被做死了。:)

但是，我正在将一个完全原生的游戏转换为 Android，我现在正在研究处理 GL 上下文丢失。

当我们在我们的游戏中维护包含 GL 资产的“资源”列表时，我能够通过它们旋转并恢复 GL 上下文。然而，虽然这在一个简化的测试应用程序中有效，但我有点担心因为上下文丢失可能随时发生，我怀疑我必须修改其他游戏区域（开始线程资源处理），以确保我涵盖了所有内容。

在我的脑海里，我不禁感到，对于我需要支持的设备范围（所有设备都小于 2 年）和使用 API8，防止上下文丢失可能是一个更安全的选择。

作为第一次确定这是否真的可行，我只是在我的扩展*GLSurfaceView类实现中创建了一个静态**EGLContext*并在其中创建了上下文，（我们的原生 Android 应用程序基于 hello-gl2jni 示例安卓ndk）：

 *```
public EGLContext createContext(EGL10 egl, EGLDisplay display, EGLConfig eglConfig) {
  if (mEGLContext == null)
  {
    ...
    mEGLContext = egl.eglCreateContext(display, eglConfig, EGL10.EGL_NO_CONTEXT, attrib_list);
  }
  return mEGLContext;
} 
```

然后我简单地删除了销毁上下文调用：

```
public void destroyContext(EGL10 egl, EGLDisplay display, EGLContext context) {
  //egl.eglDestroyContext(display, context);
} 
```

然后在应用程序重新进入时，通过按主页然后从最近的应用程序列表按钮中选择应用程序，应用程序崩溃了。这是跟踪日志：

```
// home button pressed
05-23 17:04:26.784: W/GlContextTrace(11504): Activity State Change: 'onPause' (pausing)
05-23 17:04:26.808: W/GlContextTrace(11504): 'GLSurfaceView.EGLContextFactory::destroyContext' (doesn't actually call eglDestroyContext)
05-23 17:04:27.519: W/GlContextTrace(11504): Activity State Change: 'onStop'

// application re-entry
05-23 17:04:30.089: W/GlContextTrace(11504): Activity State Change: 'onRestart'
05-23 17:04:30.089: W/GlContextTrace(11504): Activity State Change: 'onStart'
05-23 17:04:30.089: W/GlContextTrace(11504): Activity State Change: 'onResume'
05-23 17:04:30.229: W/GlContextTrace(11504): 'GLSurfaceView.EGLContextFactory::createContext' (uses the  previously created GL context)

// which immediately invokes destroyContext and ends my application:
05-23 17:04:30.315: W/GlContextTrace(11504): 'GLSurfaceView.EGLContextFactory::destroyContext'
05-23 17:04:30.479: W/GlContextTrace(11504): Activity State Change: 'onPause'
05-23 17:04:30.636: W/GlContextTrace(11504): Activity State Change: 'onStop'
05-23 17:04:30.636: W/GlContextTrace(11504): Activity State Change: 'onDestroy' 
```

崩溃日志是：

```
05-23 17:04:30.401: W/dalvikvm(11504): threadid=11: thread exiting with uncaught exception (group=0x40a361f8)
05-23 17:04:30.409: E/AndroidRuntime(11504): FATAL EXCEPTION: GLThread 753
05-23 17:04:30.409: E/AndroidRuntime(11504): java.lang.RuntimeException: eglMakeCurrent failed: EGL_SUCCESS
05-23 17:04:30.409: E/AndroidRuntime(11504):    at android.opengl.GLSurfaceView$EglHelper.throwEglException(GLSurfaceView.java:1178)
05-23 17:04:30.409: E/AndroidRuntime(11504):    at android.opengl.GLSurfaceView$EglHelper.throwEglException(GLSurfaceView.java:1170)
05-23 17:04:30.409: E/AndroidRuntime(11504):    at android.opengl.GLSurfaceView$EglHelper.createSurface(GLSurfaceView.java:1081)
05-23 17:04:30.409: E/AndroidRuntime(11504):    at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1433)
05-23 17:04:30.409: E/AndroidRuntime(11504):    at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1216) 
```

虽然我认为这突显了我不完全理解这里的过程，但我对崩溃有点惊讶。

现在有谁可以修改我的*GLSurfaceView*类实现以防止 GL 上下文丢失并能够成功地重新进入应用程序而不会崩溃，所以我可以测试这个选项是否值得关注？

我应该说我正在尝试自己做这件事，所以如果我知道如何做，我会发布答案。:)

非常感谢，

安迪·斯莱特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T16:56:30.453

在 Android 上，您不应该强行保留 GL 上下文。在移动设备上，根据设备功能，您的应用程序被要求或期望释放上下文是正常的（稍后它会取回它）。

当 GL 上下文再次可用时，您应该重新加载游戏资源，而不是保留它。执行此操作的好地方是[Renderer.onSurfaceCreated](http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html#onSurfaceCreated%28javax.microedition.khronos.opengles.GL10,%20javax.microedition.khronos.egl.EGLConfig%29)事件。每当您的上下文被创建或重新创建时（即当您先前丢失的上下文被返回给您时），GL 渲染器线程都会调用此方法。

因此，您不必担心 GL 上下文丢失并且您不会知道：当重新获得上下文时，将始终调用 onSurfaceCreated，您可以确定这一点。

附带说明一下，在 Android 应用程序中，您应该在 Activity.onPause() 中暂停 GLSurfaceView，并在 Activity.onResume() 中恢复它。这些可以通过 GLSurfaceView.onPause() 和 onResume() 来完成。*

# sql - MS 访问记录集中的不同记录

> ID：10723903
> 
> 赞同：2
> 
> 时间：2012-05-23T16:12:19.713
> 
> 标签：sql, ms-access

因此，我似乎再次遇到了 MS Access 过于挑剔的问题，尽管在 SSMS (SQL Server Management Studio) 中尝试类似查询时似乎也是一个问题。

我有一组表，大致定义如下：

1.  表 widget_mfg { id (int), name (nvarchar) }
2.  表小部件 { id (int), name (nvarchar), mfg_id (int) }
3.  表 widget_component { id (int), name (nvarchar), widget_id (int), component_id }
4.  table component { id (int), name (nvarchar), ... } -- 这个表有 ~25 列

我想做的是查询数据库并获取特定制造商使用的所有组件的列表。我已经尝试了其中一些查询：

```
SELECT c.*, wc.widget_id, w.mfg_id
FROM ((widget_component wc INNER JOIN widget w ON wc.widget_id = w.id)
INNER JOIN widget_manufacturer wm on w.mfg_id = wm.id)
INNER JOIN component c on c.id = wc.component_id
WHERE wm.id = 1 
```

前面的示例显示了包含在不同小部件的多个 widget_component 列表中的任何部分的副本。

我也试过这样做：

```
SELECT DISTINCT c.id, c.name, wc.widget_id, w.mfg_id
FROM component c, widget_component wc, widget w, widget_manufacturer wm
WHERE wm.id=w.mfg_id AND wm.id = 1 
```

这根本不显示任何东西。我正在阅读有关子查询的信息，但我不明白它们是如何工作的，也不明白它们将如何应用于我当前的应用程序。

在这方面的任何帮助都是有益的。

顺便说一句，总的来说，我对 MS Access 或 SQL 都不是很好。我知道基础知识，但除此之外没有太多。

编辑：

我刚刚尝试了这段代码，它可以获取所有component.id，同时将它们限制为一个条目。如何使用此结果获取所有其余组件数据（component.*）的列表，其中第一部分的 id 用于选择此数据？

```
SELECT DISTINCT c.part_no
FROM component c, widget w, widget_component wc, widget_manufacturer wm
WHERE(((c.id=wc.component_id AND wc.widget_id=w.id AND w.mfg_id=wm.id AND wm.id=1))) 
```

（PS 这可能不是最好的方法，但我仍在学习 SQL。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:21:50.703

听起来您的组件与小部件的关系是一对多的。因此重复。（即，同一个组件被多个小部件使用）。

你的 Select 几乎没问题——

```
SELECT c.*, wc.widget_id, w.mfg_id 
```

但是`wc.widget_id`导致重复（根据上面的假设）。

所以`wc.widget_id`从 中删除`SELECT`，或者聚合它（`min`、`max`、`count`等）。删除更容易。如果你聚合，记得添加一个`group by`子句。

试试这个：

```
SELECT DISTINCT c.*, w.mfg_id 
```

另外 - FWIW，通常使用字段名称而不是 *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:21:52.113

> 我想做的是查询数据库并获取特定制造商使用的所有组件的列表

有几种方法可以做到这一点。IN 可能是最容易写的

```
SELECT c.* 
FROM   component c 
WHERE  c.id IN (SELECT c.component_id 
                FROM   widget w 
                       INNER JOIN widget_component c 
                         ON w.id = c.widget_id 
                WHERE  w.mfg_id = 123) 
```

IN 子查询查找特定制造商使用的所有组件 ID。然后，外部查询选择任何作为该结果的 component.id。不管它在那里一次还是 1000 次，它只会获得一次组件记录。

执行此操作的其他方法是使用 EXISTS 子查询或使用查询连接（但您确实需要对其进行重复数据删除）

# asp.net-mvc-3 - Jqgrid - 触发 JqGrid 重新加载后，多选行不再持续存在

> ID：10723904
> 
> 赞同：0
> 
> 时间：2012-05-23T16:12:22.000
> 
> 标签：asp.net-mvc-3, jqgrid, jqgrid-asp.net

我有一个多选的 Jqgrid。最初在使用来自服务器的 Json 响应加载网格时，当我从一个页面导航到另一个页面时，多选行正确保留。

所选行的 id 存储在一个数组中，并且该数组在分页时更新。我使用这个数组来检查返回页面时已经选择的行。排序工作正常，到目前为止我没有遇到任何问题。

在对特定字段应用过滤器时，会向服务器发送一个请求，该服务器在 Json 中返回新的过滤结果，然后用它重新加载网格。

第一页正确呈现，选中的行已选中，但在更改页面并返回时不再选择行。但是，该数组仍然包含 ID，并且还包含新添加的 ID。

重新加载后多选功能如何停止工作？？？或者甚至不是因为重新加载？

这是代码：

```
 <script type='text/javascript'>
var selectedFieldsMap={};
var selectedFieldsObjs = [];
var selectedFieldIds = [];
$(function() {
    //function called when applying a filter
    $('#ApplyFilterBtn').click(function() {
            saveGridState();
        $('#Grid').setGridParam({ url: getUrl() });
        $('#Grid').trigger('reloadGrid');
    });
});

function saveGridState() {
       var selectedIds = $('#Grid').getGridParam('selarrrow');
       $('#Grid').data(current_page, selectedIds);
       _.each(selectedIds, function(id) {
                selectedFieldIds.push(id);
            });
       var idsToBeAdded = _.difference(selectedIds, getExistingRowIdsForGrid('#list'));
       selectedFieldsMap[current_page] = idsToBeAdded;
       _.each(idsToBeAdded, function(id) {
       selectedFieldsObjs.push($('#Grid').getRowData(id));
                   });
}

function getExistingRowIdsForGrid(gridSelector) {
var existingFields = $(gridSelector).getRowData();
return  _.map(existingFields, function(obj) { return obj.Id; });    

function resetFilterValuesAndReloadGrid() {
    //reset filters and set grid param
    $('#Grid').setGridParam({
        sortname: 'Id',
        sortorder: 'asc',
        page: 1,
        url: getUrl()
    });
    $('#Grid').jqGrid('sortGrid', 'Id', true);
    $("#Grid").trigger('reloadGrid');
}

    $("#Grid").jqGrid({
        url: getUrl(),
        datatype: "json",
        edit: false,
        add: false,
        del: false,
        height: 330,
        mtype: 'GET',
        colNames: ['Id', 'Type', 'Category'],
        jsonReader: {
            root: "DataRoot",
            page: "CurrentPage",
            total: "TotalPages",
            records: "TotalRecords",
            repeatitems: false,
            cell: "",
            id: "0"
        },
        colModel: [
            { name: 'Id', index: 'Id', width: 95, align: 'center', sorttype: "int" },
            { name: 'Type', index: 'ValueTypeName', width: 110, align: 'left',sortable: true },
            { name: 'Category', index: 'Category', width: 72, align: 'left', sortable: true },
        ],

        pager: '#pager',
        rowNum: pageCount[0],
        rowList: pageCount,
        sortname: 'Id',
        sortorder: 'asc',
        viewrecords: true,
        gridview: true,
        multiselect: true,

        loadComplete: function () {
            if(selectedFieldIds) {   
         $.each(_.uniq(selectedFieldIds), function(index, value) {
                    $('#Grid').setSelection(value, true);
                });
            }
        } ,

        onPaging : function () {
            saveGridState();
        },

        loadBeforeSend: function() {
            current_page = $(this).getGridParam('page').toString();

        } ,
        onSortCol: function () {
            saveGridState();
        }
    });

}

function getUrl() {
//return url with the parameters and filtering
}
 </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T11:41:00.977

问题解决了，在重新加载网格时会调用检查行的函数，就像在 document.ready() 中一样，并且在网格 loadComplete 上调用相同的函数。发生切换并删除选择。我添加了一个 if 条件来查看是否选择了网格。

```
 loadComplete: function () {
            var selRowIds = jQuery('#Grid').jqGrid('getGridParam', 'selarrrow');
            if (selRowIds.length > 0) {
                return false;
            } else {
                var $this = $(this), i, count;
                for (i = 0, count = idsOfSelectedRows.length; i < count; i++) {
                    $this.jqGrid('setSelection', idsOfSelectedRows[i], false);
            }
            }
        } 
```

# macos - 应用程序使用的重新分发工具（OSX、imageMagick、TWAIN - SANE）

> ID：10723907
> 
> 赞同：0
> 
> 时间：2012-05-23T16:12:48.617
> 
> 标签：macos, redistributable

我有一个使用 twain 的 mac 应用程序（依赖于我必须安装的 3 个包：libusb、sane 后端和 twain sane 接口）和 imagemagick，我也使用了一个包来安装它，但我不确定如何去做重新分配它们。

我想我必须包含我依赖的每个包的源代码，例如 libusb 包的 libusb-1.0.9.tar.bz2，然后在 /use/local/bin 中配置和制作每个包（基于看到它是由二进制包完成的）。我想一旦完成，我将不得不将这些位置添加到 $PATH 中。

我自己尝试过，但遇到了这个错误：“配置：错误：在 $PATH 中找不到可接受的 C 编译器”，所以现在正在下载 xcode 开发人员工具。我想我的安装程序的最终用户也会遇到这个问题，尽管如果他们没有安装它，所以我现在不知道如何继续。

任何人都可以阐明如何正确分发您的应用程序所依赖的工具吗？我正在使用 FileStorm Pro，并计划使用 applescript shell 命令来执行命令行工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:18:58.343

除非您打算将应用程序作为源代码分发，否则您绝对不希望将其依赖项作为源代码分发。大多数 Mac 用户没有 Xcode 开发者工具，也不想要它们。

在您的机器上构建二进制文件（理想情况下，在干净的机器上使用您想要支持的最旧版本的 OS X，在该操作系统上运行的最新版本的 Xcode，并且没有安装其他任何东西）。然后将生成的二进制文件复制到您的 .app 包中。然后，不要以依赖 $PATH 的方式运行工具，而是通过相对于 argv[0] 或 [NSBundle mainBundle] 的显式路径启动它们。

（并确保检查您正在使用的每个第三方工具的许可证。）

# c# - 当原始水印图像可用时自动去除水印的方法

> ID：10723911
> 
> 赞同：0
> 
> 时间：2012-05-23T16:13:03.530
> 
> 标签：c#, image, watermark

我有很多我不久前创建的图像，并且所有图像在同一位置都有相同的水印。我没有原件。我也有应用于所有图片的原始水印图像。

我以前从未做过这种事情，他们有什么好的方法来完成这项任务吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:21:29.057

在图像上应用水印后，被水印覆盖的图像的原始数据将永远消失。您所能做的就是使用一些混合和插值技术来“猜测”原始数据。拥有原始水印可帮助您更轻松地在图像中识别它。也许您可以使用[AForge](http://www.aforgenet.com/framework/features/smoothing_filters.html) .NET 库来完成任务。

# django - Django：如何设计以下模型？

> ID：10723917
> 
> 赞同：0
> 
> 时间：2012-05-23T16:13:11.430
> 
> 标签：django, django-models, django-forms

我想知道如何设计我的 Django 模型以实现以下目标：

```
 Road -> Category (required): Highway (select list)

 Road -> Attribute (optional): Traffic -> Heavy + Moderate (checkboxes)

 Road -> Attribute (optional): Condition -> Smooth + Rough + Average(checkboxes) 
```

在 Road 类下包含 TRAFFIC_CHOICES、CONDITION_CHOICES 与为每组选择创建单独的类与创建通用 Attribute 类是否有意义？

如何将选项显示为复选框？

该模型的最终目标是能够创建诸如“*没有交通的高速公路*”之类的查询

这是我的尝试：

```
class Category(models.Model):

    CATEGORY_CHOICES = (
        ('highway', 'Highway'),
        ('parkway', 'Parkway'),
    )
    name = models.CharField(max_length=1, choices=CATEGORY_CHOICES, blank=False)

class Road(models.Model):

        name = models.TextField(blank=False)

        TRAFFIC_CHOICES = (
            ('moderate', 'Moderate'),
            ('busy', 'Busy'),
        )
        traffic = models.CharField(max_length=1, choices=TRAFFIC_CHOICES)

        CONDITION_CHOICES = (
            ('smooth', 'Smooth'),
            ('rough', 'Rough'),
            ('average', 'Average'),
        )
        condition = models.CharField(max_length=1, choices=CONDITION_CHOICES) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:22:24.563

首先，将第`models.TextField`一个更改为`CharField`与其他人一样。

Category 不必是单独的模型，除非您打算在应用程序完成后添加新的类别，在这种情况下，它必须是单独的模型，并且您应该使用从 Road 到 Category 的 ForeignKey 关系并放弃 CATEGORY_CHOICES。

假设您不打算添加新类别，您可以完全摆脱 Category 模型并将 CATEGORY_CHOICES 放入 Road。然后将 name = 更改为 category = 并将其也放入 Road。

所有这些字段的 max_length 都为 1，这很好，但在这种情况下，您需要将 CHOICES 映射到单个字符，以便它们适合该字段。例如：

```
CATEGORY_CHOICES = (
    ('H', 'Highway'),
    ('P', 'Parkway'),
) 
```

为什么要使用复选框来选择流量和条件？复选框意味着您可以选择多个答案，而不是被迫只选择一个。这在概念上对于道路状况或交通没有意义，并且与 CharField 不兼容（因为 CharField 只能存储一个值，没有一些非常人为的设置）。如果您更喜欢单选按钮而不是下拉菜单，则可以保留您拥有的系统并使用单选按钮，但是您不能在不摆脱选择的情况下使用复选框，而是将每个可能的复选框设置为自己的 BooleanField 或 NullBooleanField。

我通常把我的选择放在类定义之外。我不知道当它在里面时它是否能如你所愿地工作。对于我的示例，我将它们移到类定义之外；这可能不是必需的，因此请随意尝试。

总结一下（我将`name`字段更改为 a`CharField`因为`TextField`仅适用于非常大的块而不适用于名称）：

```
CATEGORY_CHOICES = (
    ('H', 'Highway'),
    ('P', 'Parkway'),
)
TRAFFIC_CHOICES = (
    ('M', 'Moderate'),
    ('B', 'Busy'),
)
CONDITION_CHOICES = (
    ('S', 'Smooth'),
    ('R', 'Rough'),
    ('V', 'Varying'),
)

class Road(models.Model):
    name = models.CharField(max_length=512, blank=False)
    category = models.CharField(max_length=1, choices=CATEGORY_CHOICES, blank=False)
    traffic = models.CharField(max_length=1, choices=TRAFFIC_CHOICES)
    condition = models.CharField(max_length=1, choices=CONDITION_CHOICES) 
```

编辑：如果你真的确定复选框是最合适的，那么你有两个主要选择。如上所述，如果您打算在应用程序完成后添加选项，那么您的策略是不同的（您需要使用 ManyToManyField）。否则你可以像这样实现它们：

```
class Road(models.Model):
    name = models.CharField(max_length=512, blank=False)
    category = models.CharField(max_length=1, choices=CATEGORY_CHOICES, blank=False)
    moderate_traffic = models.NullBooleanField()
    heavy_traffic = models.NullBooleanField()
    smooth_condition = models.NullBooleanField()
    rough_condition = models.NullBooleanField()
    varying_condition = models.NullBooleanField() 
```

您将它们显示为分组复选框的部分特别发生在您显示表单时，而不是在模型中。

您也可以使用某种位字段，但默认情况下 Django 中不包含该字段——您必须安装扩展。

# c# - 工具提示问题跳过 Datagrid 中的行

> ID：10723919
> 
> 赞同：0
> 
> 时间：2012-05-23T16:13:16.637
> 
> 标签：c#, datagrid, datatable, tooltip, c#-2.0

```
private void datagridSignal_MouseMove(object sender, MouseEventArgs e) 
{         this.toolTip.Hide(datagridSignal);         
this.toolTip.RemoveAll();         
DataTable dt = GetSignalTable();         
DataView dv = new DataView(dt);         
Point prop = new Point(e.X, e.Y);         
System.Windows.Forms.DataGrid.HitTestInfo myHitTest;                 
myHitTest = datagridSignal.HitTest(prop.X, prop.Y);         
this.toolTip.SetToolTip(datagridSignal, " ID = '" + (int)dv[myHitTest.Row][0] + "'  '" + myHitTest.Row + "'"); 
} 
```

到目前为止，这是我的代码，不幸的是它没有提供准确的结果..由于某种原因，即使显示了正确的索引，它也会随机混淆 ID 的顺序。

***使用数据网格，而不是数据网格视图

***Visualstudio2005环境下的visual C# 2.0

编辑：

```
private void dataGridSignal_MouseMove(object sender, MouseEventArgs e)
{
  this.toolTip.Hide(dataGridSignal); 
  this.toolTip.RemoveAll(); 
  System.Windows.Forms.DataGrid.HitTestInfo myHitTest;  
  myHitTest = dataGridSignal.HitTest(e.X, e.Y);
  this.toolTip.SetToolTip(dataGridSignal, " ID = " + ((int)this.GetTable().Rows[myHitTest.Row][0]).ToString() + " "+ myHitTest.Row.ToString());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:27:43.087

我无法复制它。这对我有用：

```
void dg_MouseMove(object sender, MouseEventArgs e) {
  this.toolTip1.Hide(dg);
  this.toolTip1.RemoveAll();

  System.Windows.Forms.DataGrid.HitTestInfo myHitTest = dg.HitTest(e.X, e.Y);

  if (myHitTest.Row > -1) {
    this.toolTip1.SetToolTip(dg, "Over " + dt.Rows[myHitTest.Row][0].ToString());
    this.Text = "Over " + dt.Rows[myHitTest.Row][0].ToString();
  }
} 
```

我只能猜测 DataGrid 使用的 DataSource 与来自的不同`GetSignalTable`。在我的示例中，`dt`是我的 DataGrid dg 正在使用的 DataTable。

# c# - 视图模型继承和重复模型引用

> ID：10723922
> 
> 赞同：1
> 
> 时间：2012-05-23T16:13:37.853
> 
> 标签：c#, wpf, inheritance, mvvm, viewmodel

我的问题是：如何管理视图模型的继承链？

我的情况：

我有一个仅实现 INotifyPropertyChanged 接口的标准**ViewModelBase 。**

此外，我有一个具有 Guid的**BusinessObjectViewModel** 、一个具有人员核心数据的**PersonBaseViewModel** 、一个具有客户相关内容的**CustomerViewModel和一个具有员工相关内容的****EmployeeViewModel**。

所有的视图模型都封装了一个模型对象（Customer、Employee、PersonBase）。

*   BusinessObjectViewModel 继承自 ViewModelBase
*   PersonBaseViewModel 继承自 BusinessObjectViewModel
*   CustomerViewModel 继承自 PersonBaseViewModel
*   EmployeeViewModel 继承自 PersonBaseViewModel

模型通过构造函数进入视图模型。

如果我使用构造函数链（每个视图模型都调用基本构造函数），每个视图模型都有它的模型来从模型返回封装的值。

但是我必须在每个视图模型中都有一个模型属性。在 CustomerViewModel 的情况下，我将在**CustomerViewModel**中有一个引用，在 PersonBaseViewModel 中有一个引用，在**BusinessObjectViewModel**中有一个引用，用于同一个对象。这对我来说听起来很愚蠢。

或者我必须在上层视图模型中转换每个属性访问。

ps 这只是我模型层次结构的一个小部分。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T18:24:48.763

IMO 最简单的答案是使用泛型，这可能很简单

```
public abstract class ViewModelBase<TModel>  TModel : class{
    public TModel Model { get; protected set; }
} 
```

.net 类型系统将知道您的 TModel 是 Person、Customer 或其他任何内容，无需强制转换。

让我知道您是否需要更多或是否想发布一些需要帮助的代码。是的，一开始要让你的超类型层次结构恰到好处可能会很棘手。

HTH，
绿柱石

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:28:12.473

如果 BusinessObject 和 Person 类（以及它们的 VM 对应物）是抽象的，那么您可以像这样访问正确的模型：

```
public abstract class BusinessObjectViewModel : ViewModelBase
{
    protected abstract BusinessObject BusinessObject { get; }

    protected BusinessObject Model { get { return this.BusinessObject; } }
}

public abstract class PersonViewModel : BusinessObjectViewModel
{
    protected abstract Person Person { get; }

    protected new Person Model { get { return this.Person; } }

    protected override sealed BusinessObject BusinessObject
    {
        get { return this.Model; }
    }
}

public class CustomerViewModel : PersonViewModel
{
    protected new Customer Model { get; set; }

    protected override sealed Person Person
    {
        get { return this.Model; }
    }
}

public class EmployeeViewModel : PersonViewModel
{
    protected new Employee Model { get; set; }

    protected override sealed Person Person
    {
        get { return this.Model; }
    }
} 
```

这样，每个派生的 VM 类通过实现抽象属性并隐藏基类 Model 属性为其基本 VM Model 属性提供值，因此每个 VM 都使用适当类型的 Model 属性（因此不需要强制转换）。

这种方法有其优点和缺点：

好处：

*   不涉及铸造。

缺点：

*   仅当基类（BusinessObjectViewModel 和 PersonViewModel）是抽象类时才有效，因为必须存在由派生类实现的抽象属性，并为这些基类提供模型实例。
*   不应在基类构造函数中访问模型属性，因为构造函数链接从基类到最派生的类。派生最多的类构造函数会设置模型，所以基类构造函数会被提前调用以查看它。这可以通过将 Model 作为参数传递给构造函数来避免。
*   派生类不需要看到 BusinessObject 和 Person 属性。EditorBrowsableAttribute 可能在此处对 Intellisense 有所帮助，但仅当代码由不同 Visual Studio 解决方案中的另一个程序集使用时（这是 Visual Studio 特定的行为）。
*   表现。当基类访问模型时，代码会经过一系列虚拟属性。但是由于实现的抽象属性被标记为密封，虚拟表查找不应该有太多的性能下降。
*   不能很好地扩展。对于深层类层次结构，代码将包含许多不必要的成员。

另一种方法是：

```
public class BusinessObjectViewModel : ViewModelBase
{
    protected BusinessObject Model { get; private set; }

    public BusinessObjectViewModel(BusinessObject model)
    {
        this.Model = model;
    }
}

public class PersonViewModel : BusinessObjectViewModel
{
    protected new Person Model { get { return (Person)base.Model; } }

    public PersonViewModel(Person model)
        : base(model)
    {
    }
}

public class CustomerViewModel : PersonViewModel
{
    protected new Customer Model { get { return (Customer)base.Model; } }

    public CustomerViewModel(Customer model)
        : base(model)
    {
    }
}

public class EmployeeViewModel : PersonViewModel
{
    protected new Employee Model { get { return (Employee)base.Model; } }

    public EmployeeViewModel(Employee model)
        : base(model)
    {
    }
} 
```

好处：

*   基类不需要是抽象的。
*   模型可以通过基类构造函数访问。
*   没有不必要的附加属性。

缺点：

*   铸件。

基于这个分析，我会选择第二个选项，因为修复它的唯一缺点，铸造性能，将是不必要的微优化，在 WPF 上下文中不会被注意到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:42:20.413

如果您只想在 ViewModel 中公开 Model 属性，则无需在 ViewModel 中重新声明 Model 属性即可公开它们。我通常将底层模型对象作为我的 ViewModel 中的属性公开。在您的情况下，例如在您的 EmployeeViewModel 中，您将拥有：

```
private Employee _MyEmployee;
public Employee MyEmployee {
get
{
return _MyEmployee;
}
set
{
_MyEmployee = value;
NotifyPropertyChanged(x=>x.MyEmployee);
} 
```

然后，您的 View 可以通过 ViewModel 中公开的 MyEmployee 属性绑定到您的 Employee 属性。据我了解，您想要在 VM 中重新声明或包装模型属性的唯一情况是您需要进行一些数据操作以呈现给您的视图。

# html - 如何在 iframe 中更改父窗口中的链接？

> ID：10723928
> 
> 赞同：0
> 
> 时间：2012-05-23T16:14:13.500
> 
> 标签：html, iframe, hyperlink

我有一页画廊格式的很多图像。当您单击图像时，iframe 会更改以包含有关该图像的信息以及将您带到另一个页面的链接（具有相同画廊样式格式的原始图像的更详细图片）。

我的问题是，由于链接在 iframe 中，因此新页面会在 iframe 中加载。有没有办法或 target="whatever" 命令使该链接成为父页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:18:34.873

在链接中添加`target=_parent`

# javascript - 在网站上抓取 Facebook 提要

> ID：10723929
> 
> 赞同：1
> 
> 时间：2012-05-23T16:14:17.980
> 
> 标签：javascript, facebook-graph-api, mobile, feed

我为我的客户开发移动网站。这个特定的客户希望在网站上显示一些 facebook 墙活动。我查看了 facebook graph api 并且对身份验证感到困惑。

[我需要https://graphs.facebook.com/clientsfacebookid/feed?access_token=blah](https://graphs.facebook.com/clientsfacebookid/feed?access_token=blah)中的 blah 来获取我想要的信息。我阅读了有关身份验证的所有内容，但它似乎不符合我的目的。例如，我阅读的很多关于获取令牌的内容都与创建应用程序和东西有关——这不是我想要的做。有很多方法来验证重定向用户以登录或授予对信息的访问权限，但这似乎也不适合我的场景。

我是否应该与我的客户交谈并让他们向我发送访问代码或设置一些流，以便我可以在需要时随时获取更新的访问代码，或者 API 中是否有一些我可以从使用中受益的内置功能。

有什么想法吗？

PS我正在尝试通过javascript中的ajax调用来实现这一点。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T11:33:24.737

It's actually far simpler if you just want to grab the data from the page. Create an App, but you don't need to add it to the actual page. You can generate an App Access Token by following the [instruction on the Facebook Developer Website](https://developers.facebook.com/docs/opengraph/using-app-tokens/).

Then, all you need to do is call the Graph API with the generated `access_token`. E.g.: `https://graph.facebook.com/{page_id}/feed?access_token={app_access_token}`

You can then use the data returned by Facebook to display selected posts from the page.

The Page Admin doesn't need to add the app to the page, and this method can be used to scrape any published page. The posts on Pages is public anyway, you just need an `access_token` to access the page.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T19:48:10.510

如果您想要一种简单的学习方法并拥有一个工作模型的示例，请尝试[fourgefeed.com](http://fourgefeed.com) ，它是一个简单的框架，带有一个易于实现的示例，有点像jquery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:36:17.637

您需要做的是创建一个 Facebook 应用程序并让您的客户将其添加到他们的页面。然后，您可以获取此应用程序的 OAuth 令牌并使用它来查询客户端的提要。有关详细信息，请参阅[作为应用程序进行身份验证的 Facebook 文档](https://developers.facebook.com/docs/authentication/applications/)。

# r - Spearman 在 R tie 中的 cor.test 是否得到纠正？

> ID：10723930
> 
> 赞同：2
> 
> 时间：2012-05-23T16:14:18.207
> 
> 标签：r, correlation

我想知道 R 中用于计算 Spearman 的 rho 的 cor.test 函数是否经过**平局校正**。[我在官方 R 文档](http://stat.ethz.ch/R-manual/R-devel/library/stats/html/cor.test.html)中找不到直接的答案。

平局校正的 Spearman 示例可在以下位置找到：

> Cureton, Edward E. 存在平局时的平均斯皮尔曼等级标准相关性。Psychometrika 23，没有。3（1958 年 9 月）：271-272。

感谢您的任何提示，穆龙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T16:31:45.850

“官方”文档就是代码本身。看看那里，人们看到有通过使用`pkendall()`.

```
stats:::cor.test.default 
```

您还将[在 SO 最近发布的关于 Spearman-rho 和三个 Kendall-tau 的帖子中获得背景信息](https://stackoverflow.com/questions/10711395/spearman-correlation-and-ties-in-r)

# php - 使用带有多维数组php的while循环

> ID：10723933
> 
> 赞同：0
> 
> 时间：2012-05-23T16:14:32.083
> 
> 标签：php, arrays, while-loop

我试图在我的多维数组中像这样：

```
$address = array();
while(!$res->EOF)
{
    $dataFromDB = array($res->fields['CODCLI'] => 
                     array(
                           "Address" => $res->fields['CIDCLI'].",".$res->fields['SIGUFS'].", USA", 
                           "Name"    => "SOMENAME")
                          );
    $address[]  = $dataFromDB;
    $res->MoveNext();
} 
```

结果是这样的：

```
Array
 (
   [0] => Array
      (
        [28947] => Array
            (
                [Address] => PIRIPIRI,PI,USA
                [Name] => SOMENAME
            )
      )
 ) 
```

但我真正需要的是这样：

```
Array
(
  [1] => Array
    (
        [Address] => PIRIPIRI,PI,USA
        [Name] => SOMENAME
    )
) 
```

我尝试了一些其他的东西，但没有任何帮助，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:18:20.983

删除第一步，只需执行以下操作：

```
$address[]  = array(
   "Address" => $res->fields['CIDCLI'].",".$res->fields['SIGUFS'].", USA", 
   "Name"    => "SOMENAME"
); 
```

# objective-c - iPhone iOS 开源基于陀螺仪的球坐标系统查看器，如 360 全景或旅游手腕

> ID：10723937
> 
> 赞同：1
> 
> 时间：2012-05-23T16:14:43.157
> 
> 标签：objective-c, ios5, trigonometry, iphone-4, panoramas

我正在寻找基于 iPhone，最好是带有 ARC 项目的 iOS5，该项目使用 iPhone4 的陀螺仪在球坐标系中环顾四周。手机位于球体的中心，通过查看传感器输出，它可以了解相机在球坐标中指向的位置。

**我不确定我的想法是否可以通过融合了 iPhone4 传感器的 iOS5 CMAttitude 来实现？**

我打算使用该项目来控制机器人炮塔，并使其能够“查看”球坐标系中的特定点。

我想到的是，360 度全景或类似旅游手腕的应用程序将是此类项目的良好起点。**有没有类似的、开源的并使用原生 iOS Core Motion 框架的东西？**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:32:00.717

如果您想获得 TourWrist 技术的许可，请告诉我。例如，我们授权 TourWrist 捕获和查看器 API/SDK。

Dan Smigrod 来自：support@TourWrist.com

# javascript - moomasonry 与新版本的 mootools 不兼容

> ID：10723938
> 
> 赞同：2
> 
> 时间：2012-05-23T16:14:46.353
> 
> 标签：javascript, mootools

我想在我正在处理的项目中使用[http://mootools.net/forge/p/moomasonry ，但该插件与 mootools 1.4.5（最新版本）不兼容。](http://mootools.net/forge/p/moomasonry)我很困惑我需要做什么才能使它工作。如果有人给我一个指针，我不介意更改代码。

错误是：

name.toLowerCase 不是函数

var getter = propertyGetters[name.toLowerCase()];

mootoo...mpat.js（第 3684 行）

# excel - Excel - 创建动态总和公式范围

> ID：10723941
> 
> 赞同：4
> 
> 时间：2012-05-23T16:14:54.050
> 
> 标签：excel, excel-formula, worksheet-function

我目前正在使用以下公式

```
=SUM(INDIRECT("'Net "&($A$2)&" "&RIGHT($A48,2)&"'!C4:C21")) 
```

这很完美，但我试图使它的范围部分（`C4:C21`）动态。

公式引用的`$A$2`是某人输入的内容，目前说“五月”。公式引用的 $A48 只是简单地提取年份的最后 2 位数字。

这些是文件的片段

共有 6 个重要的选项卡。有 4 个标签汇总了特定月份的往年销售额。所以我有 Net May 11、Net May 10、Net May 09、Net May 08。这些是 Indirect 公式找到的选项卡。

最后 2 个选项卡包括存在此公式的选项卡（Net May 12）和范围需要基于的选项卡（Cust May 12）。在 Cust May 12 选项卡中，A 列是日期，B 列是星期几，C 列是我们的销售数据。每天都有人进去，输入当天的销售额。例如，我目前有从 2012 年 5 月 1 日到 2012 年 5 月 18 日的销售数据。C 列中从 2012 年 5 月 19 日到 2012 年 5 月 31 日的所有内容都是空白的。当前存在的销售数据在 中`C4:C21`，`C22:C34`为空白。因为我将往年的销售额与今年的销售额进行比较，所以它们必须具有可比性，这就是为什么该公式仅`C4:C21`用于所有往年的销售额。

我尝试了一些方法，包括 CountA 和一些补偿来尝试帮助我，但我一直无法找到解决方案来使我之前几年的所有销售公式的范围动态化。`C4:C22`当有人在 Cust May 12 选项卡中输入第二天的销售数据时，我需要该公式简单地增加到之前所有年份的值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T17:48:14.177

你的问题并不完全清楚，但听起来你想要这样的东西：

```
=SUM(OFFSET(INDIRECT("'Net "&($A$2)&" "&RIGHT($A48,2)&"'!C4:C4"),0,0,COUNTA('Cust May 12'!$C$4:$C$34))) 
```

但是，您可能需要考虑重组数据以将其仅存储在一个工作表中，例如使用年、月、日和销售额等列。然后，像“2011 年 5 月至今的销售额是多少”这样的问题更容易回答（尤其是在 Excel 2007 中添加的 SUMIFS 函数），如下所示：

```
=SUMIFS(<Sales column>,<Year column>,2011,<Month column>,"May",<Date column>,"<="&DAY(NOW())) 
```

# matlab - MATLAB：查找图像中特定 RGB 像素值的索引/计数

> ID：10723943
> 
> 赞同：2
> 
> 时间：2012-05-23T16:14:59.287
> 
> 标签：matlab, image-processing

我正在使用 matlab 来获取图像中特定像素值的计数。

读入 matlab 时，图像为 RGBA <512x512x4 uint8>（尽管我们可以忽略 alpha 通道）。

以外;

```
[width, height, depth] = size(im);

for x = 1 : width;
    for y = 1: height;

        r = im(x,y,1);
        g = im(x,y,2);
        b = im(x,y,3);

        ...

    end
end 
```

有没有办法使用矩阵运算来做到这一点？类似于以下内容：

```
X = find(im(:,:,1) == 255 && im(:,:,2) == 255 && im(:,:,3) == 255);
count = length(X);
% Count being the number of pixels with RGB value (255,255,255) in the image. 
```

我猜有不止几种方法可以做到这一点（看相交，独特的功能），但我还没有足够聪明的matlab来做到这一点。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:36:56.797

其实很简单。像这样的东西

```
count = sum(im(:, :, 1) == 255 & im(:, :, 2) == 255 & im(:, :, 3) == 255); 
```

会给你这些像素的数量。如果需要，请替换`sum`为以获取这些像素的索引。`find`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:34:44.023

您可以通过多种方式做到这一点。一种方法是这样。假设您的图像是 HxWx3，使用您要搜索的 r 值创建一个 HxW 表，一个 HxW 用于 g，一个用于蓝色。您可以将所有这些表作为维度组合在 HxWx3 表 F 中。从 im 中减去 F 并使用 find() 函数获取零值的索引。

```
F(:,:,1)=R*ones(H,W); F(:,:,2)=G*ones(H,W); F(:,:,3)=B*ones(H,W); 
```

那么如果你做 im-F 你在想要的位置上得到零

```
d=F-im;    [r,c]=find((d(:,:,1))==0) 
```

这样，您还可以输入您希望 rgb 设置有多接近的阈值。

# android - Android - 适用于所有手机的 Eclipse 模拟器？

> ID：10723948
> 
> 赞同：0
> 
> 时间：2012-05-23T16:15:17.467
> 
> 标签：android

您好我想创建多个模拟器来测试我的应用程序，但我不确定每个模拟器的设置，我知道普通手机的分辨率，但我不确定其他设置，例如 DPI。

我相信“抽象 LCD 密度”选项适用于模拟器中的 DPI 吗？

Emulator1 (例如三星 Galaxy ace) Res: 320x480 抽象 LCD 密度 (DPI): ?

Emulator2（例如 Htc 渴望 S） Res：480x800 抽象 LCD 密度（DPI）：？

Emulator3（例如galaxy nexus）Res：640x960抽象LCD密度（DPI）：？

Emulator4（例如三星 Galaxy S III） 分辨率：720x1280 抽象 LCD 密度（DPI）：？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T10:13:09.793

我知道一个：

Emulator1（例如三星 Galaxy ace）Res：320x480 抽象 LCD 密度（DPI）：165

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T08:03:23.827

请参考以下链接。 [http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density](http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density)

# java - 通过反射 API 使 Java 类成为非最终类

> ID：10723952
> 
> 赞同：6
> 
> 时间：2012-05-23T16:15:38.430
> 
> 标签：java, reflection

我有一个类似于以下的 Java 类：

```
public final class Node {
    public Node() {}
} 
```

我已经学会了如何通过反射 API 更改“最终”字段的可访问性，但这也适用于类吗？我可以在运行时将最终类变成非最终类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:18:33.620

您可以使用 ASM 之类的库重新编写类文件。

在运行时更改类的状态可能没有意义`final`，因为它在编译时需要是非最终的才能编译子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:19:43.963

我不明白这是如何工作的，因为编译器会检查你试图在编译时创建的类是否非最终类。如果你试图继承它，你会得到一个错误。

如果你好奇，我认为问这个问题很好，但要问自己的更大问题是你为什么要这样做？反射允许你做很多事情来绕过 final、private 等，但这并不意味着它是一个好主意。如果第 3 方库的设计者认为 final 是一个好主意，那么建议您尊重这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-02T23:55:03.897

编辑：感谢@kriegaex 的评论。'accessFlags' 字段仅存在于 Android SDK 的 Class 类实现中。因此，除非您正在为 Android 开发，否则此解决方案将不适合您，因为首先不存在这样的字段。

以下是通过删除“final”修饰符使类可扩展的方法：

```
Class classClass = Class.class;

Field accessFlagsField = classClass.getDeclaredField("accessFlags");

accessFlagsField.setAccessible(true);

Class nodeClass = Node.class;

accessFlagsField.setInt(nodeClass, nodeClass.getModifiers() & ~Modifier.FINAL); 
```

我不同意上面的答案。有人可能想要删除“final”修饰符以在运行时通过使用“ASM”或“byte-buddy”等库来扩展类。我同意，如果它是最终类，这可能是有充分理由的，但自定义业务逻辑可能需要这样做。

# android - 无法在应用程序中从 XML 调用对象

> ID：10723953
> 
> 赞同：1
> 
> 时间：2012-05-23T16:15:39.447
> 
> 标签：android, xml, textview

在我的应用程序中，我似乎无法调用我的应用程序中的任何布局对象。如果我访问包含使用 XML 文件的代码的任何类，应用程序将崩溃。像这样的线条

```
mButton = (Button)findViewById(R.id.get);
cweight   = (EditText)findViewById(R.id.cweight);
nweight   = (EditText)findViewById(R.id.nweight);
t = (TextView)findViewById(R.id.out); 
```

这些代码行以前工作过，并且它们被称为布局文件存在。

用于此的 logcat 在下面，看着它我看不出问题出在哪里。特别是因为这段代码几天前就可以工作了。

```
05-23 16:12:43.790: E/AndroidRuntime(313): FATAL EXCEPTION: main
05-23 16:12:43.790: E/AndroidRuntime(313): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.b00348312.workout/com.b00348312.workout.WorkoutChoice}: java.lang.NullPointerException
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.os.Looper.loop(Looper.java:123)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-23 16:12:43.790: E/AndroidRuntime(313):  at java.lang.reflect.Method.invokeNative(Native Method)
05-23 16:12:43.790: E/AndroidRuntime(313):  at java.lang.reflect.Method.invoke(Method.java:521)
05-23 16:12:43.790: E/AndroidRuntime(313):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-23 16:12:43.790: E/AndroidRuntime(313):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-23 16:12:43.790: E/AndroidRuntime(313):  at dalvik.system.NativeStart.main(Native Method)
05-23 16:12:43.790: E/AndroidRuntime(313): Caused by: java.lang.NullPointerException
05-23 16:12:43.790: E/AndroidRuntime(313):  at com.b00348312.workout.WorkoutChoice.onCreate(WorkoutChoice.java:67)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-23 16:12:43.790: E/AndroidRuntime(313):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
05-23 16:12:43.790: E/AndroidRuntime(313):  ... 11 more 
```

好的，鉴于共识似乎是它在第 67 行的空指针异常，但这是我在上面给出的第一行。给出的另一个解决方案是使用我在 onCreate 方法开始时所做的 setContent(view view)。

当上面给出的行不存在并且它们以前工作过时，该类工作得非常好，所以我不确定问题出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:26:42.547

根据您`Activity`使用的内容，有几件事可能是错误的。[`setContentView(View view)`](http://developer.android.com/reference/android/app/Activity.html#setContentView%28android.view.View%29)如果您只是设置视图，您完成了吗？否则，如果您正在膨胀视图，则需要调用`view.findViewById(id)`. 这样它就会在你刚刚膨胀的视图上调用它，否则它不会找到它。

编辑：一个简短的说明，我相信你需要`setContentView(View view)`在寻找视图`setContentView(View view)`之前打电话，所以`findViewById(id)`如果你这样做的话，需要在打电话之前打电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:28:20.327

似乎问题出在`WorkoutChoice`第 67 行。您正在使用一个值为 null 的对象：

```
05-23 16:12:43.790: E/AndroidRuntime(313): Caused by: java.lang.NullPointerException
05-23 16:12:43.790: E/AndroidRuntime(313):  at com.b00348312.workout.WorkoutChoice.onCreate(WorkoutChoice.java:67) 
```

# ruby-on-rails - 在 Ruby on Rails 3 中制作通用模型时出现问题

> ID：10723955
> 
> 赞同：4
> 
> 时间：2012-05-23T16:15:56.367
> 
> 标签：ruby-on-rails, ruby, activerecord, rails-activerecord

我正在尝试制作一个“通用模型”，以便它可以连接到任何数据库的任何表。首先，我创建了这个连接到另一个指定数据库的类（不使用模式）

**D b**

```
class Db < ActiveRecord::Base

    self.abstract_class = true

    attr_accessor :error

    def initialize(item = nil)
        @error = ""
        connect
        super
    end

    def connect
        could_connect = true
        @error = ""

        begin
            ActiveRecord::Base.establish_connection(
              :adapter  => "mysql2",
              :host     => "localhost",
              :username => "root",
              :password => "",
              :database => "another_database", 
              :port => 3306,
              :encoding => "utf8"
            )
        rescue ActiveRecord::ConnectionNotEstablished
            @error = "Could not connect to database. The connection was not established"
            could_connect = false
        rescue Mysql2::Error
            @error = "Could not connect to database using MySQL2"
            could_connect = false
        rescue => e
            @error = "Could not connect to database. #{e.message}."
            could_connect = false
        end

        return could_connect
    end

end 
```

然后，我创建了这个继承自 Db 并指定表名的类

**模型**

```
class Gmodel < Db

    def initialize(new_table_name)
        ActiveRecord::Base.set_table_name(new_table_name)
        super
    end

end 
```

最后，在控制器中

**主控制器**

```
class MainController < ApplicationController

  def index
    @users = Gmodel.new("users")
  end

end 
```

但是，它给了我这个错误：

```
undefined method `stringify_keys' for "users":String 
```

有什么问题？有没有更好的方法来做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T16:38:21.740

为什么不简单地在运行时[创建一个`ActiveRecord::Base`子类](http://ruby-doc.org/core/Class.html#method-c-new)并避免所有麻烦呢？

```
t = 'some_table'
c = Class.new(ActiveRecord::Base) { self.table_name = t } 
```

然后`c`引用一个 AR 类`some_table`，你可以做通常的事情：

```
o = c.find(1)
# 'o' is now a wrapper for the row of some_table where 'id = 1'

cols = c.columns.map(&:name)
# 'cols' is now an array of some_table's column names 
```

这是 Ruby，其中类也是对象。

如果您需要连接到另一个数据库，那么您可以将`establish_connection`调用连同`self.table_name`：

```
t = 'some_table'
d = 'some_other_database'
c = Class.new(ActiveRecord::Base) do
    establish_connection(:adapter => 'mysql2', :database => d, ...)
    self.table_name = t
end 
```

# java - 单击 JCheckBox 禁用 JTable 中的 JComboBox

> ID：10723956
> 
> 赞同：0
> 
> 时间：2012-05-23T16:16:01.473
> 
> 标签：java, swing, jtable, jcombobox, jcheckbox

我有`JTable`，它在两个不同的列中有 a`JCheckBox`和 a 。`JComoboBox`当我选择`JCheckBox`与该行对应的一个时，`JComboBox`应该禁用。请帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T17:02:44.307

只需根据您的模型禁用对单元格的编辑。在您的 TableModel 中，覆盖/实现`isCellEditable()`返回复选框“值”的方法。

尽管以下示例不是基于 JComboBox，但它说明了如何根据行首复选框的值禁用单元格的编辑：

```
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingUtilities;
import javax.swing.table.DefaultTableModel;

public class TestTable {

    public JFrame f;
    private JTable table;

    public class TestTableModel extends DefaultTableModel {

        public TestTableModel() {
            super(new String[] { "Editable", "DATA" }, 3);
            for (int i = 0; i < 3; i++) {
                setValueAt(Boolean.TRUE, i, 0);
                setValueAt(Double.valueOf(i), i, 1);
            }
        }

        @Override
        public boolean isCellEditable(int row, int column) {
            if (column == 1) {
                return (Boolean) getValueAt(row, 0);
            }
            return super.isCellEditable(row, column);
        }

        @Override
        public Class<?> getColumnClass(int columnIndex) {
            if (columnIndex == 0) {
                return Boolean.class;
            } else if (columnIndex == 1) {
                return Double.class;
            }
            return super.getColumnClass(columnIndex);
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestTable().initUI();
            }
        });
    }

    protected void initUI() {
        table = new JTable(new TestTableModel());
        f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setSize(300, 300);
        f.setLocationRelativeTo(null);
        f.add(new JScrollPane(table));
        f.setVisible(true);
    }

} 
```

# android - 具有父大小的 XML 中的径向渐变

> ID：10723957
> 
> 赞同：7
> 
> 时间：2012-05-23T16:16:01.793
> 
> 标签：android, android-layout, android-xml

我试图实现一个组件来为按钮或其他组件制作自定义阴影，我知道使用 9patch 或带有阴影的 png 会更容易，但我想在其状态下也以编程方式更改它的颜色和大小（按下，等），所以我决定尝试使用 9 张图片，全部采用 XML 格式，以便阴影从组件的一侧开始渐变。

```
<!-- Left Shadow layer -->
<item>
    <shape android:shape="rectangle" >
        <gradient
            android:angle="0"
            android:endColor="#FFFF0000"
            android:startColor="#00FF0000" />
    </shape>
</item> 
```

看起来不错，问题出在拐角处，现在 android:gradientRadius 参数设置为固定大小，但在上下文帮助中据说可以设置为基本大小 10% 或父大小 10% 的百分比p，我希望它设置一个 100%p 的半径，这样渐变总是会从主色开始消失在正方形的边缘。

- 编辑 -

关于 gradientRadius [gradientRadius的 android 文档](http://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html#attr_android:gradientRadius)

```
<shape android:shape="rectangle" >
        <gradient
            android:endColor="#00FF0000"
            android:startColor="#FFFF0000"
            android:gradientRadius="18"
            android:centerX="100%"
            android:centerY="100%"
            android:type="radial" />
    </shape> 
```

这就是我现在的位置:(我不知道如何设置这个大小以适应它的父视图。

任何帮助将不胜感激，当我完成组件后，我会将代码放入答案中:) 因此典型按钮可以在 xml 中具有可自定义的阴影。

应得组件的图像。

- 编辑 -

我仍然对此感兴趣:) 没有人知道吗？

![具有辐射渐变的按钮](../Images/37f2fce4335db07df63d58a471af2cdd.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T10:48:21.197

我认为你应该放弃 xml 并在代码中实现 drawable。当您扩展 Drawable 类时，您可以使用 getBounds() 将大小设置为矩形。您也可以在 onBoundsChange 方法中动态重新计算。您还可以轻松构建渐变并在 Paint 对象中使用它们（setShader 方法）

# javascript - Flexcroll 和 innerHTML

> ID：10723961
> 
> 赞同：1
> 
> 时间：2012-05-23T16:16:20.903
> 
> 标签：javascript, scrollbar, innerhtml

我正在尝试从一组隐藏的（显示：无）div 中获取内容，以使用 innerHTML 显示在主“显示”div 上。那部分没有问题。但是，即使在调用 updateScrollBars 方法之后，当我使用 innerHTML 更改“显示”div 的内容时，flexcroll 似乎也不会加载。

这是有问题的代码：

```
function switchdis(IDS) {       
    caredet = document.getElementById('caredet');
    carednew = document.getElementById(IDS).innerHTML;
    caredet.innerHTML = carednew;
    fleXenv.updateScrollBars();
} 
```

我不太确定是什么问题。在我看来，该函数已被调用（我可以使用鼠标滚轮滚动），但滚动条根本没有出现。作为记录，我的自定义滚动条在其他页面上运行良好。在另一个页面上，我使用了隐藏和取消隐藏 div 的方法来更改页面内的内容；当我在取消隐藏 div 后调用 updateScrollBars() 方法时，该方法在那里工作。

但不知何故，innerHTML 似乎不起作用。有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:49:52.143

我解决了这个问题。

意识到我已应用 flexcroll 更新了 div 的 innerHTML。如果有人遇到类似问题，请不要这样做。相反，在 flexcroll 主 div 中创建另一个 div 并更改该 div 的 innerHTML。

此外，请记住更新您的 flexcroll 滚动条，并可选择在每次更改该内部 div 的 innerHTML 时将滚动位置移动到顶部。

# sql - 触发器为插入和更新构建逗号分隔的值列表

> ID：10723965
> 
> 赞同：1
> 
> 时间：2012-05-23T16:16:45.520
> 
> 标签：sql, sql-server

我有一个表，我想在其中存储对数据库执行的所有插入、更新和删除操作。该表应如下所示：

```
ID       Created          Operation
 1       2012-05-01       INSERT [SomeTable] (ID, Col1) VALUES (1, 'xyz')
 2       2012-05-01       UPDATE [SomeTable] SET Col1 - 'abc' WHERE ID = 1 
```

等等...

在每个表上使用触发器，如何构造操作查询？假设您并不总是知道表中导致触发器的列，因为您可能会在以后将列添加到表中，并且不希望返回并重建触发器。

这可能是它的开始：

```
CREATE TRIGGER tr_MyTable_RowInserted ON MyTable
FOR INSERT
AS

DECLARE @columnList nvarchar(4000)

SET @columnList = NULL
SELECT @columnList = COALESCE(@columnList + ', ', '') + [name] FROM sys.columns WHERE Object_ID = Object_ID(N'MyTable')
print @columnList

-- now we have the columns, need to spit out the values that are in the trigger's inserted table

-- then we need to concatenate all of that into a single, syntactically correct SQL string 
```

# c# - 从基类实例化派生类的通用工厂方法

> ID：10723967
> 
> 赞同：3
> 
> 时间：2012-05-23T16:16:50.730
> 
> 标签：c#, generics, reflection, factory-pattern

我正在创建一个工厂方法，该方法使用通用抽象类型参数来使用反射返回具体派生类型的实例。例如。

```
public abstract class ServiceClientBase : IServiceClient
{
}

public abstract class Channel : ServiceClientBase
{
}

public class ChannelImpl : Channel
{
}

public class ServiceClientFactory
{
    public T GetService<T>() where T : class, IServiceClient
    {
        // Use reflection to create the derived type instance
        T instance = typeof(T).GetConstructor(BindingFlags.NonPublic | BindingFlags.Instance, null, new Type[] { typeof(string) }, null).Invoke(new object[] { endPointUrl }) as T;
    }
} 
```

用法：

```
Channel channelService = factory.GetService<Channel>(); 
```

问题是我想不出任何优雅的方法让工厂方法实例化在方法中传递抽象基类型的派生类型。我唯一能想到的就是维护一个字典，其中包含抽象基和相应派生类之间的映射，但这在我看来就像代码异味。任何人都可以提出更好的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T16:29:42.980

虽然您确信只有一个实现，并且假设它在同一个程序集中，但您可以通过反射找到它。例如：

```
Type implementationType = typeof(T).Assembly.GetTypes()
                                   .Where(t => t.IsSubclassOf(typeof(T))
                                   .Single();
return (T) Activator.CreateInstance(implementationType); 
```

当然，出于性能原因，您可能希望将抽象类型缓存到具体类型。

如果有多个实现类，您将需要考虑一个替代方案 - 一个选项是抽象类上的一个属性，说明要使用哪个实现，如果可行的话。（如果没有更多的上下文，很难给出好的选择。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:34:37.097

您似乎正在尝试重新发明 IOC 容器。以[Autofac](http://code.google.com/p/autofac/)为例。您将使用 IOC 容器注册您的具体类型，然后通过接口请求它们。

# ios - 如何在真实设备上设置 Frank Automation？

> ID：10723968
> 
> 赞同：1
> 
> 时间：2012-05-23T16:16:52.503
> 
> 标签：ios, testing, automation, cucumber, frank

我在 iOS 模拟器上尝试过 frank。但是需要知道，如何在真实设备上运行测试，即在 iPhone 上？设备和 Mac 之间的连接如何？通过WIFI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T21:03:37.250

我现在正在尝试做同样的事情。 [本教程](http://testingwithfrank.com/device.html)列在弗兰克的网站上，但我一直遇到问题，因为我没有很多终端经验。您可能已经在上面找到了一些东西，但这可能对其他人有所帮助。

# c# - 外部应用程序使用共享内存接收消息但没有包含数据

> ID：10723973
> 
> 赞同：1
> 
> 时间：2012-05-23T16:17:12.373
> 
> 标签：c#, c++, interop, shared-memory, memory-mapped-files

我在我的 c# 应用程序中使用共享内存和 c++ 互操作。目前我正在将一个结构编组为一个指针并广播消息。我正在广播的程序使用调试消息正确打开，但不显示/引入我在结构中使用的数据。

谢谢！

我试图与之交谈的应用程序是用 c++ 编写的，我正在用 c# 编码。我正确使用了所有 DLLImports（我认为），它编译并运行无错误。

```
using System.Runtime.InteropServices;

[DllImport("user32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Unicode)]
public static extern uint RegisterWindowMessageW([In]string lpString);

[DllImport("user32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Ansi)]
public static extern uint RegisterWindowMessageA([In]string lpString);

[DllImport("kernel32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]
public static extern IntPtr OpenFileMapping(FileMapAccessRights dwDesiredAccess, int bInheritHandle, [In]String lpName);

[DllImport("kernel32", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]
public static extern IntPtr MapViewOfFile(IntPtr hFileMappingObject, FileMapAccessRights dwDesiredAccess, uint dwFileOffsetHigh, uint dwFileOffsetLow, UIntPtr dwNumberOfBytesToMap);

[DllImport("kernel32", CallingConvention = CallingConvention.StdCall)]
public static extern int UnmapViewOfFile(IntPtr lpBaseAddress);

[DllImport("kernel32", CallingConvention = CallingConvention.StdCall)]
public static extern int CloseHandle(IntPtr hObject);

[DllImport("user32.dll")]
public static extern IntPtr PostMessage(IntPtr hWnd, uint msg, int wParam, int lParam);

uint WM_ZOOM_XYZ = RegisterWindowMessageA("WM_ZOOM_XYZ");

int i = Broadcast_Zoom_Message(10000, 10000, 0, WM_ZOOM_XYZ);

public int Broadcast_Zoom_Message(double dbX, double dbY, double dbZ, uint uMessage) 
{
    string smSharedMemory = "COORDINATES";

    IntPtr hMem = OpenFileMapping(FileMapAccessRights.Write, FALSE, smSharedMemory);

    if (IntPtr.Zero == hMem)
    {
        return 0;
    }

    IntPtr pvHead = MapViewOfFile(hMem, FileMapAccessRights.Write, 0, 0, UIntPtr.Zero);

    if (IntPtr.Zero == pvHead)
    {
        CloseHandle(hMem);
        MessageBox.Show(
            "Unable to view " + smSharedMemory, 
            "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop);
        return 0;
    }

    CoordinatesStruct structCoords = new CoordinatesStruct();

    Marshal.PtrToStructure(pvHead, structCoords);

    int bVersionOk = FALSE;

    if (1 == structCoords.uMajorVersion)
    {
        if (WM_ZOOM_XYZ == uMessage)
        {
            structCoords.dbDesiredX = dbX;
            structCoords.dbDesiredY = dbY;
            structCoords.dbDesiredZ = dbZ;
        }
        bVersionOk = TRUE;
    }
    else
    {
        MessageBox.Show(
            "Unrecognized shared memory: " +
            structCoords.uMajorVersion.ToString() + "." + structCoords.uMinorVersion.ToString());
    }
    if (IntPtr.Zero != hMem)
    {
        CloseHandle(hMem);
    }
    UnmapViewOfFile(pvHead);

    IntPtr HWND_BROADCAST = (IntPtr)0xffff;

    if (bVersionOk == TRUE)
    {
        PostMessage(HWND_BROADCAST, uMessage, 0, 0);
        return 1;
    }
    else
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:14:56.803

我认为您的意图是将更改的`structCoords`内容放回映射文件。当我们使用时，`Marshal.PtrToStructure()`我们会收到一份非托管内存内容的副本。接收到的对象的变化不会反映在非托管内存中。当我们处理完数据后，我们应该使用`Marshal.StructureToPtr`.

这是我认为应该是的：

```
if (1 == structCoords.uMajorVersion)
{
    if (WM_ZOOM_XYZ == uMessage)
    {
        structCoords.dbDesiredX = dbX;
        structCoords.dbDesiredY = dbY;
        structCoords.dbDesiredZ = dbZ;
    }
    bVersionOk = TRUE;
    Marshal.StructureToPtr(structCoords , pvHead, false); // <-- this is what you (I) forgot!
} 
```

# mdx - 在 MDX 中选择层次结构中的所有级别作为元组

> ID：10723976
> 
> 赞同：1
> 
> 时间：2012-05-23T16:17:19.467
> 
> 标签：mdx

我昨天做了我的第一个立方体。我还是新手，所以请原谅任何术语的滥用。我的一个维度，我们称它`MyDimension1`有一个层次结构，我们称它为`MyHierarchy`，有两个级别，我们称它们为`Level1`和`Level2`。

我似乎能够做类似的事情：

```
SELECT 
{ [Measures].[Whatever] } ON 0,
{ ([MyDimension1].[Level1].[Level1], [MyDimension1].[Level2].[Level2]) } ON 1
FROM MyCube 
```

这给了我想要的结果。如果我理解正确，定义轴 1 的集合包含一个包含两个组件的元组（？）。我读过元组的每个组件（？）都应该来自不同的维度，但我似乎能够指定相同维度的组件，如上述查询所示。不过，我希望能够只按名称指定层次结构，然后让服务器为我创建元组。所以像：

```
SELECT 
{ [Measures].[Whatever] } ON 0,
{ AllLevelsToTuple([MyDimension1].[MyHierarchy]) } ON 1
FROM MyCube 
```

但我似乎无法弄清楚如何做到这一点。提前致谢！

**编辑（我的例子，应回答者的要求）：**

这在功能上做了我想要的，但不是我想要的语法：

```
SELECT [Measures].[Original] ON 0,
([Customer].[Customer].[Customer], [Customer].[Account ID].[Account ID]) ON 1 
```

结果（在 SSMS 中）：

```
 Original
---------  --  --------
CustomerA  15    306.03
CustomerA  16    754.20
...
CustomerB  17    524.43
...
CustomerC  22    760.42
... 
```

当我扩展维度时，它看起来像：

```
- Customer
    - Hierarchy
        + Members
        + Customer
        + Account ID 
```

当我做类似的事情时（我想在语法上做类似的事情）：

```
SELECT [Measures].[Original] ON 0,
([Customer].[Hierarchy].Members) ON 1 
```

我得到以下结果：

```
 Original
----------  --------
All         17638.15
CustomerA    2624.76
15
16
...
CustomerB    3113.67
17            524.43
...
CustomerC    3427.01
22            760.42
... 
```

我希望有 3 列，而不是 2，基本上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T00:31:34.290

您可能想阅读这个[MDX 温和的介绍](http://www.iccube.com/support/documentation/mdx_tutorial/gentle_introduction.html)。

> 我读过元组的每个组件（？）都应该来自不同的维度

相反，来自不同的**层次结构**。在 AS 中，我猜对于每个级别，您都有相应的平面层次结构；所以下面看起来你正在访问两个不同层次结构的级别：

```
{ ([MyDimension1].[Level1].[Level1], [MyDimension1].[Level2].[Level2]) } ON 1 
```

我不是 AS 的专家，但我猜是以下陈述：

```
SELECT [Measures].[Original] ON 0,
([Customer].[Customer].[Customer], [Customer].[Account ID].[Account ID]) ON 1 
```

实际上被解释为来自 2 个不同层次结构的级别成员的交叉连接；() 符号更有可能被解释为 () 运算符而不是元组符号，然后 {},{} 是 MDX 中的交叉连接：

```
SELECT [Measures].[Original] ON 0,
[Customer].[Customer].[Customer].members * [Customer].[Account ID].[Account ID].members ON 1 
```

因此，结果中度量值前面的两列。

> 我希望有 3 列，而不是 2，基本上。

您需要使用计算的度量；就像是 ：

```
with 
MEMBER Measures.HN as [Customer].Currentmember.Hierarchy.Name 
MEMBER Measures.LN as [Customer].Currentmember.Level.Name 
MEMBER Measures.MN as [Customer].Currentmember.Name 

SELECT { Measures.HN, Measures.LN, Measures.MN, [Measures].[Original] } ON 0,
([Customer].[Hierarchy].Members) ON 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T17:04:44.600

是的，您可以从不同的维度创建元组，您可以通过将成员放在括号之间并用逗号分隔来实现。

但是在这种情况下，你不需要一个元组，只需要一个集合。集合包含来自单个维度的成员，以逗号分隔并放置在大括号之间：{}。

看看[后代](http://msdn.microsoft.com/en-us/library/ms146075.aspx "子孙")函数。您可以使用此功能从您的层次结构中创建一个集合。

# facebook - Facebook 向我的好友列表中的随机用户发送应用程序邀请

> ID：10723983
> 
> 赞同：0
> 
> 时间：2012-05-23T16:17:53.280
> 
> 标签：facebook, facebook-opengraph, facebook-apps, invitation, facebook-app-requests

我想将我的应用程序邀请发送给我的朋友列表中的多个随机人，就像它在大多数应用程序中所做的那样。例如![在此处输入图像描述](../Images/bbf738bd35d48fcb6e0f476f479e9fdb.png)

一旦我接受该应用程序，就会出现此弹出窗口。我无法理解的是如何获取这些用户的 ID？在客户端？

```
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:fb="https://www.facebook.com/2008/fbml">
  <head>
    <title>Request Example</title>
  </head>

  <body>
    <div id="fb-root"></div>
    <script src="http://connect.facebook.net/en_US/all.js"></script>
    <p>
      <input type="button"
        onclick="sendRequestToRecipients(); return false;"
        value="Send Request to Users Directly"
      />
      <input type="text" value="User ID" name="user_ids" />
      </p>
    <p>
    <input type="button"
      onclick="sendRequestViaMultiFriendSelector(); return false;"
      value="Send Request to Many Users with MFS"
    />
    </p>

    <script>
      FB.init({
        appId  : '423165827708510',
        frictionlessRequests: true,
      });

      function sendRequestToRecipients() {
        var user_ids = document.getElementsByName("user_ids")[0].value;
        FB.ui({method: 'apprequests',
          message: 'My Great Request',
          to: user_ids,                        ///  How to Fill the ID's HERE ?
        }, requestCallback);
      }

      function sendRequestViaMultiFriendSelector() {
        FB.ui({method: 'apprequests',
          message: 'My Great Request'
        }, requestCallback);
      }

      function requestCallback(response) {
        // Handle callback here
      }
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T18:31:37.847

为什么要发送给随机用户？这没有任何意义——你肯定会邀请你认为会喜欢这个游戏的人吗？！

除了混淆之外，为了回答您的问题，“to”参数可以是一个数组，也可以是一个逗号分隔的用户 ID 列表。

这是一个 CSV 示例，取自[文档](https://developers.facebook.com/docs/reference/dialogs/requests/)：

```
function sendRequestToRecipients() {
  FB.ui({method: 'apprequests',
    message: 'My Great Request',
    to: '499802820,499802852'
  }, requestCallback);
} 
```

# asp.net - 隐藏 ListBox 中的重复结果？

> ID：10723984
> 
> 赞同：0
> 
> 时间：2012-05-23T16:17:58.743
> 
> 标签：asp.net, c#-4.0

我使用存储过程来获取结果，然后我有一个数据表来填充结果。从那里将结果填充到 ListBox 中。我收到重复的 ID，我想删除重复的结果。

```
private DataTable _dt = new DataTable();

ListBox1.DataSource = _dt;
ListBox1.DataValueField = "userId"; //column name in DT
ListBox1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:20:35.507

如果你使用 linq，你可以使用：

```
var source = _dt.Distinct();

ListBox1.DataSource = source;
ListBox1.DataValueField = "userId";
ListBox1.DataBind(); 
```

**编辑：** 好的，在更仔细的研究中，我发现`System.Data.DataRowCollection`IEnumerable 扩展方法的实现方式与典型的 IEnumerable （例如`List`. 为了使用`Distinct()`扩展方法，您首先需要将行集设置为更基本的 IEnumerable。

```
IEnumerable<System.Data.DataRow> rows = (IEnumerable<System.Data.DataRow>)_dt.Rows;
ListBox1.DataSource = rows.Distinct();
ListBox1.DataValueField = "userId";
ListBox1.DataBind(); 
```

虽然它有效，但它可能不像@Massimiliano 提供的答案那么简单或高效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:26:00.723

```
DataTable distinctTable = originalTable.DefaultView.ToTable( /*distinct*/ true);
ListBox1.DataSource = distinctTable ;
ListBox1.DataValueField = "userId";
ListBox1.DataBind(); 
```

[http://msdn.microsoft.com/en-us/library/wec2b2e6.aspx](http://msdn.microsoft.com/en-us/library/wec2b2e6.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T16:27:20.123

我认为乔尔的回答适用于您的情况。但是，我可能会首先尝试通过`DISTINCT`在存储过程中使用来避免返回重复项。这样，如果您或其他人再次需要相同的数据，他们就不必到处过滤重复数据。此外，您还可以获得第二个好处，即不在数据库和 Web 服务器之间通过网络发送不必要的数据。

# c# - 建立 SSL\TLS 连接 (X509Chain.Build()) 耗时过长

> ID：10723985
> 
> 赞同：8
> 
> 时间：2012-05-23T16:17:59.213
> 
> 标签：c#, .net, ssl, system.net.httpwebrequest

我发现当我使用 HttpWebRequest 建立 SSL\TLS 连接时，调用时需要将近 30s

```
 request.GetRequestStream() 
```

当我在启用堆栈跟踪的情况下启用跟踪时，我发现 2s 去寻找 poxy，所以我在 app.config 中禁用了它：

```
<system.net>
 <defaultProxy enabled="false" useDefaultCredentials="false">
  <proxy/>
  <bypasslist/>
  <module/>
 </defaultProxy>
</system.net> 
```

下一个需要 28 秒左右的时间点在

```
 at System.Net.Security.SecureChannel.AcquireClientCredentials(Byte[]& thumbPrint) 
```

在检查方法主体后，我发现调用 X509Chain.Build() 并且花了将近 25 秒来构建证书链。

有趣的是，当您构造新的 HttpWebReqest 并再次尝试（无需重新启动应用程序）时，执行请求需要几个毫秒。

谁能建议该怎么做？缓存请求不是一个选项，它应该从应用程序运行开始很快。

**更新**：

我在 X509Chain.BuildChain() 中发现需要 30 秒的调用，它是：

```
if (!CAPISafe.CertGetCertificateChain(hChainEngine, pCertContext, ref pTime, invalidHandle, ref cert_chain_para, dwFlags, IntPtr.Zero, ref ppChainContext)) 
```

CAPISafe 中声明的方法为：

```
[DllImport("crypt32.dll", CharSet = CharSet.Auto, SetLastError = true)]
internal static extern bool CertGetCertificateChain([In] IntPtr hChainEngine, [In] SafeCertContextHandle pCertContext, [In] ref System.Runtime.InteropServices.ComTypes.FILETIME pTime, [In] SafeCertStoreHandle hAdditionalStore, [In] ref CAPIBase.CERT_CHAIN_PARA pChainPara, [In] uint dwFlags, [In] IntPtr pvReserved, [In, Out] ref SafeCertChainHandle ppChainContext); 
```

所以，是 Crypto API 函数[CertGetCertificateChain](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376078%28v=vs.85%29.aspx) 还是不知道，接下来要做什么......

**更新：**

我试图禁用 CRL 和 OCSP 检查，仍然没有效果：

1.  添加到 App.config

    ```
    <runtime>
      <generatePublisherEvidence enabled="false"/>
    </runtime> 
    ```

2.  机器范围：控制面板 -> Internet 选项 -> 高级 -> 在安全下，取消选中检查发布者的证书吊销选项

3.  在注册表中：

    [HKEY_USERS\S-1-5-20\Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing] "状态"=dword:00023e00

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T21:56:19.847

终于找到了问题的根源。我在事件日志中启用了 CAPI2 日志记录，并在尝试从以下位置下载证书信任列表时发现了 NetworkTimeoutException：

[http://www.download.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab](http://www.download.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab)

所以，那是防火墙问题。您可以阅读有关调查过程和使用的技术的[博文。](http://code-clarity.blogspot.com/2012/06/how-to-troubleshoot-ssltsl-or-x509.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T16:49:19.713

通常，路径构建意味着构建一个*有效*的路径，这需要检查是否有任何证书自颁发以来已被[吊销](https://www.rfc-editor.org/rfc/rfc5280#section-3.3)。

为了检查当前的撤销状态，您需要来自 CRL 或 OCSP 响应者的最新信息。[如果在路径验证请求的设置过程中没有明确提供正确的 CRL，如果 CRL 的 URL 列在“CRL 分发点”扩展](https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.13)中，许多库将尝试获取它（通常通过 Internet） 。

如果您的网络很慢、路径很长或 CRL 很大，这可能需要一些时间。也许这就是你的情况需要这么长时间的原因。由于它在第一次之后运行速度很快，我猜测在第一次尝试期间会下载一些大型 CRL 并缓存以供后续使用。

或者，如果在[“Authority Information Access”扩展](https://www.rfc-editor.org/rfc/rfc5280#section-4.2.2.1)中宣传，图书馆*可能会*自动联系[OCSP 响应者。](https://www.rfc-editor.org/rfc/rfc2560)但是，某些库需要显式配置才能使用 OCSP，或者更喜欢它而不是 CRL。

如果您要验证来自许多不同颁发者中的每个颁发者的一些证书，请尝试在任何可用的地方使用 OCSP。该协议速度很快，响应很小，通常包含有关单个证书的信息，而不是颁发者曾经吊销的每个证书。

如果您要验证来自单个颁发者的多个证书，请在后台急切地下载该颁发者的 CRL 并保留它直到它过期。然后将 CRL 传递到路径构建过程中，这样就不必在用户等待时下载它。

# cocoa - 可可 NsView 不显示图像

> ID：10723986
> 
> 赞同：0
> 
> 时间：2012-05-23T16:18:04.873
> 
> 标签：cocoa, nsview, nsimage

我遇到了一个我无法解决的问题。我正在尝试在我的应用程序中显示一个小头像。我创建了一个 NSView 类，然后在界面生成器中添加一个自定义视图，并将其链接到该类。

它没有给我任何错误，但它不显示图像！

这是我的 .m NSView 类文件：

```
 #import "Avatar.h"

@implementation Avatar

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        NSRect rect = NSMakeRect(10, 10, 400, 300);
        imageView = [[NSImageView alloc]initWithFrame:rect];
        [imageView setImageScaling:NSScaleToFit];
        NSImage *theImage = [NSImage imageNamed:@"/Users/blabla/nonloso/prova.jpg"];
        [imageView setImage:theImage];
        [self addSubview:imageView];
    } 
    return self;
}

- (void)drawRect:(NSRect)dirtyRect
{
    // Drawing code here.
}

@end 
```

这是我的 .h NSView 类文件：

```
#import <Cocoa/Cocoa.h>

@interface Avatar : NSView {
@private 
    NSImageView *imageView;
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:43:04.130

`[-NSImage imageNamed]`不能那样工作 - 请参阅[它的文档](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/nsimage_Class/Reference/Reference.html#//apple_ref/occ/clm/NSImage/imageNamed%3a)。

你可能需要`-initWithContentsOfFile:`。

# sql - 如何使用 SQL Server 计算缺失数据的标准差

> ID：10723992
> 
> 赞同：1
> 
> 时间：2012-05-23T16:18:26.513
> 
> 标签：sql, sql-server-2008, tsql, statistics

我知道 SQL Server 作为 STDEV 和 STDEVP 的聚合函数。但是，在我的具体情况下，我的表缺少数据。表中显示了产品每小时的库存。当缺少一个小时时，表示库存为0。假设我想计算2012-01-01一整天的产品“香蕉”数量的标准差，我该怎么做？

谢谢！

数据

```
+---------------------+-------------+--------------+
|         Date        | ProductName | ProductCount |
+---------------------+-------------+--------------+
| 2012-01-01 00:00:00 |    Banana   |    15000     |
| 2012-01-01 01:00:00 |    Banana   |    16000     |
| 2012-01-01 02:00:00 |    Banana   |    17000     |
| 2012-01-01 05:00:00 |    Banana   |    12000     |
| 2012-01-01 00:00:00 |    Apple    |     5000     |
| 2012-01-01 05:00:00 |    Apple    |     6000     |
+---------------------+-------------+--------------+ 
```

SQL

```
CREATE TABLE ProductInventory (
    [Date]  DATETIME,
    [ProductName] NVARCHAR(50),
    [ProductCount] INT
)

INSERT INTO ProductInventory VALUES ('2012-01-01 00:00:00', 'Banana', 15000)
INSERT INTO ProductInventory VALUES ('2012-01-01 01:00:00', 'Banana', 16000)
INSERT INTO ProductInventory VALUES ('2012-01-01 02:00:00', 'Banana', 17000)
INSERT INTO ProductInventory VALUES ('2012-01-01 05:00:00', 'Banana', 12000)
INSERT INTO ProductInventory VALUES ('2012-01-01 00:00:00', 'Apple', 5000)
INSERT INTO ProductInventory VALUES ('2012-01-01 05:00:00', 'Apple', 6000) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:37:45.443

你可以使用 CTE 函数（我让你搜索那个）来获取从 1 到 24 的小时数。

但是创建一个值为 0 到 23 的“小时表”可能很容易。

假设您有一个带有小时字段的小时表

```
select stdev(coalesce(pi.ProductCount, 0))
from hours h
left join ProductInventory pi on DATEPART(hh, pi.Date) = h.hour
where coalesce(pi.ProductName, 'Banana') = 'Banana'
and (pi.Date is null or (Convert(char(8), pi.Date, 112))='20120101') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:28:04.147

```
STDEV( isnull( ProductCount , 0 ) ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T17:09:35.200

建立一个小时表和`LEFT JOIN`产品表：

```
DECLARE @h TABLE(hr DATETIME);
DECLARE @StartTime DATETIME='1/1/2012 00:00:00';
DECLARE @EndTime DATETIME='1/1/2012 23:00:00';
DECLARE @HourCount INT = DATEDIFF(HOUR,@StartTime,@EndTime)+1;
DECLARE @Product VARCHAR(30) = 'Banana';

INSERT INTO @h
SELECT TOP(@HourCount) DATEADD(HOUR,ROW_NUMBER()OVER(ORDER BY message_id)-1,@StartTime)
FROM sys.messages;

SELECT [ProductName]=ISNULL([ProductName],@Product)
, sd=STDEV(ISNULL([ProductCount],0))
FROM @h h
LEFT JOIN ProductInventory i ON h.hr = i.[Date]
WHERE ISNULL([ProductName],@Product)=@Product
GROUP BY ISNULL([ProductName],@Product); 
```

结果：

```
ProductName                                        sd
-------------------------------------------------- ----------------------
Banana                                             5763.45307123671 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-08T23:12:54.843

生成 0 记录的成本可能相当高，尤其是在使用大量数据时。您还可以使用此查询来运行计算，而无需为缺少的零创建其他记录：

```
select #ProductInventory.ProductName, 
    sqrt((sum(Power((DataSum / TotalDataPoints - ProductCount), 2)) + ZeroDataPoints * power(DataSum / TotalDataPoints, 2))/(TotalDataPoints-1)) stdDev,
    sqrt((sum(Power((DataSum / TotalDataPoints - ProductCount), 2)) + ZeroDataPoints * power(DataSum / TotalDataPoints, 2))/(TotalDataPoints)) stdDevP
from #ProductInventory
join
    (
    select ProductName, 
    convert(float,SUM(ProductCount)) DataSum,
    convert(float,datediff(hour, min(Date), MAX(date)) + 1) TotalDataPoints,
    convert(float,datediff(hour, min(Date), MAX(date)) + 1 - COUNT(ProductCount)) ZeroDataPoints
    from #ProductInventory
    group by ProductName
    ) Aggregates
on #ProductInventory.ProductName = Aggregates.ProductName
Group by #ProductInventory.ProductName, DataSum, TotalDataPoints, ZeroDataPoints 
```

这假设您的第一个和最后一个数据点都在集合中。因此，如果您想使用整个 24 小时的一天，则必须确保为第一个和最后一个值（如果不存在）至少添加一个 0 数据点。例如，在这种情况下，您可以在运行上面的查询之前使用此代码添加结束点：

```
INSERT INTO #ProductInventory VALUES ('2012-01-01 23:00:00', 'Banana', 0)
INSERT INTO #ProductInventory VALUES ('2012-01-01 23:00:00', 'Apple', 0) 
```

# ios - MapKit注释自定义图像不起作用

> ID：10723998
> 
> 赞同：0
> 
> 时间：2012-05-23T16:18:53.630
> 
> 标签：ios, annotations, mapkit

我对 MapKit 注释上的自定义图像有疑问。构建一个我正在执行相同测试的示例项目，它可以正常工作（尽管拖放效果和自定义图像不起作用）。

但是当我在我的地图视图项目中使用完全相同的功能时，自定义图像不会出现。我注意到颜色引脚更改功能 MKPinAnnotationColorPurple 也不起作用。它是否可能取决于某些项目属性？

代码是：

```
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
    static NSString *identifier = @"MyLocation";   

    if ([annotation isKindOfClass:[MyLocation class]]) {

        MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [_mapView dequeueReusableAnnotationViewWithIdentifier:identifier];

        if (annotationView == nil) {
            annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
        } else {
            annotationView.annotation = annotation;
        }
        annotationView.enabled = YES;
        annotationView.animatesDrop=    NO;
        annotationView.image=[UIImage imageNamed:@"arrest.png" ];//here we use a nice image instead of the default pins

        annotationView.canShowCallout = YES;
        UIButton *btnDetails = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
        //[btnDetails addTarget:self action:@selector(prova) forControlEvents:UIControlEventTouchUpInside]; 

        annotationView.rightCalloutAccessoryView=btnDetails;

        return annotationView;
    }

    return nil;
} 
```

UIButtonTypeDetailDisclosure 也不会出现（在其他项目中会出现）。