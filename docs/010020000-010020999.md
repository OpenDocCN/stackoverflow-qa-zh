# StackOverflow 问答 10020000-10020999

# linux - 从 bash 脚本停用 pythonbrew

> ID：10020004
> 
> 赞同：0
> 
> 时间：2012-04-04T22:13:01.800
> 
> 标签：linux, bash, pythonbrew

我正在尝试从 bash 脚本中停用 pythonbrew。在 shell 内键入时`pythonbrew off`可以正常工作。
在我的 bash 脚本`pythonbrew off`中只是被忽略了。使用回声时，我得到：

```
omer@omer-VirtualBox:~/Projects/devenv$ echo $("pythonbrew off")
pythonbrew off: command not found 
```

调用该函数会导致程序退出而不打印失败消息。
这是功能：

```
function deactivate_pythonbrew()
{
    echo "Detecting whether Pythonbrew is installed."
    pythonbrew_version="$(pythonbrew --version 2>&1)"
    if [ -n $pythonbrew_version ]
    then
        echo "Pythonbrew $pythonbrew_version found."

        if [ -n $pythonbrew ]
        then
            pythonbrew off || echo "Failed to deactivate pythonbrew. Aborting." && exit $?
        else
            echo "Pythonbrew is inactive. Skipping."
        fi
    else
        echo "Pythonbrew is not installed. Skipping."
    fi
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T07:16:31.317

事实证明，我必须这样做，`source $HOME/.bashrc/etc/bashrc`因为函数没有导入到脚本中。我`source $HOME/.bashrc/etc/bashrc`的 ~/.bashrc 文件中有，但据我了解，这些函数并未导入到子进程中。

# ruby-on-rails - 使用分叉的 formtastic-bootstrap gem 部署 Rails 应用程序时出现 403 错误

> ID：10020009
> 
> 赞同：1
> 
> 时间：2012-04-04T22:13:24.200
> 
> 标签：ruby-on-rails, deployment, capistrano, twitter-bootstrap, ruby-on-rails-3.2

我有一个工作的、可部署的 Rails 3.2.2 应用程序，我在其中使用了**formtastic**和**bootstrap-sass** gems（以及其他）。为了在我的表单中使用 Twitter 引导样式，我使用了cgunther fork 的*formtastic* [**-bootstrap**](https://github.com/cgunther/formtastic-bootstrap/tree/bootstrap2-rails3-2-formtastic-2-1) gem ，因为*mjbellantoni*的版本与 Rails 3.2 不兼容。

 **我的宝石文件：

```
gem 'formtastic-bootstrap', :git => 'https://github.com/cgunther/formtastic-bootstrap.git', :branch => 'bootstrap2-rails3-2-formtastic-2-1' 
```

在我的本地机器上，这按预期工作，但是当我使用 capistrano 部署我的应用程序时，出现错误：

```
Fetching https://github.com/cgunther/formtastic-bootstrap.git
error: The requested URL returned error: 403
fatal: Could not parse object '4e6a7f50153af805470d43a2bd2c9885a902e4a6'.
Git error: command `git reset --hard 4e6a7f50153af805470d43a2bd2c9885a902e4a6` in directory /var/www/[appname]/shared/bundle/ruby/1.9.1/bundler/gems/formtastic-bootstrap-4e6a7f50153a has failed.
If this error persists you could try removing the cache directory '/var/www/[appname]/shared/bundle/ruby/1.9.1/cache/bundler/git/formtastic-bootstrap-eabf0533be1e6746fb6d99b57db3fdd7c424275b' 
```

当我在安装 formtastic-bootstrap gem 时在服务器上运行 bundle install 命令时会发生同样的错误。

有人有线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T07:41:07.687

尝试在 Gemfile 中将“https”更改为“git”。它帮助我获得了另一个宝石。**

# php - 检查用户是否在兼容模式下使用 IE

> ID：10020011
> 
> 赞同：8
> 
> 时间：2012-04-04T22:13:28.943
> 
> 标签：php, javascript, internet-explorer, dom, ie8-compatibility-mode

我正在寻找一些代码（PHP 或 JavaScript）可以很好地检查查看页面的用户是否使用兼容模式。

然后我可以使用该代码来做一些条件语句，或者基本上给他们一个通知来关闭它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-04T22:16:27.367

强迫他们：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

这将禁用兼容性视图，除非用户然后通过进入开发工具并更改它来专门将其关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T22:06:36.960

我用：

```
try{ JSON } catch (e){ alert("Compatibility Mode Detected")  } 
```

# java - 跨项目共享休眠配置的最佳方式

> ID：10020013
> 
> 赞同：2
> 
> 时间：2012-04-04T22:13:41.190
> 
> 标签：java, hibernate

我们有几个不同的网络应用程序共享相同的数据库链接。每个 web 应用程序中的休眠层是“*.hbm.xml”和 java 文件的 jar 副本。随着时间的推移，我担心每个副本都会出现不一致，人们忘记创建 jar 文件。

有没有比创建 jar 文件更好的方法在多个项目之间共享相同的 db hibernate 信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:29:01.807

这完全是一个构建和部署问题。如果您的休眠实体位于不同的包中，那么您应该在应用程序之前构建该包，并将生成的 jar 与它们一起打包。

[Maven](http://maven.apache.org/)使这变得简单：

*   多模块项目
*   包含实体的 jar 打包模块
*   `<dependency>`jar 上有一个 war 打包的模块
*   所有模块的版本相同。

# php - 如何使用 php 脚本导出和导入 mysql 数据库及其数据？

> ID：10020022
> 
> 赞同：18
> 
> 时间：2012-04-04T22:13:57.883
> 
> 标签：php, mysql

我被要求使用 php 脚本而不是 phpmyadmin 创建一个导出和导入 mysql 数据库及其结构和数据到一个 .sql 文件中，以使用户能够备份他的数据？

有人知道怎么做吗？

提前致谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-01-22T13:36:03.443

**安全有效的解决方案**：

```
EXPORT_TABLES("localhost","user","pass","db_name"); 
// has 5th and 6th optional parameters too. 
```

最新版本在 github 上可用： [**Export.php**](https://github.com/tazotodua/useful-php-scripts/blob/master/my-sql-export%20(backup)%20database.php) + [**Import.php**](https://github.com/tazotodua/useful-php-scripts/blob/master/my-sql-import%20(restore)%20database.php)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-04T22:19:14.823

[http://www.php-mysql-tutorial.com/wikis/mysql-tutorials/using-php-to-backup-mysql-databases.aspx](http://www.php-mysql-tutorial.com/wikis/mysql-tutorials/using-php-to-backup-mysql-databases.aspx)

任何一个

```
$tableName  = 'mypet';
$backupFile = 'backup/mypet.sql';
$query      = "SELECT * INTO OUTFILE '$backupFile' FROM $tableName";
$result = mysql_query($query); 
```

或者

```
$backupFile = $dbname . date("Y-m-d-H-i-s") . '.gz';
$command = "mysqldump --opt -h $dbhost -u $dbuser -p $dbpass $dbname | gzip >     $backupFile";
system($command); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-25T12:21:21.033

这是一个很好的课程，对我来说效果很好。如果它说 fopen 访问被拒绝，请尝试更改文件夹权限。

[https://github.com/clouddueling/mysqldump-php](https://github.com/clouddueling/mysqldump-php)

# java - 使用信号量的生产者/消费者；陷入僵局

> ID：10020024
> 
> 赞同：0
> 
> 时间：2012-04-04T22:14:02.080
> 
> 标签：java, multithreading, mutex, semaphore

根据[http://en.wikipedia.org/wiki/Producer-consumer_problem](http://en.wikipedia.org/wiki/Producer-consumer_problem)我想使用信号量模拟 P/C 问题。我陷入僵局，我不知道有什么问题。

```
public static void main(String[] args) {
        CustomBlockingQueue blockingQueue = new CustomBlockingQueue();
        new Thread(new Producer(blockingQueue)).start();
        new Thread(new Consumer(blockingQueue)).start();
    }
}

@SuppressWarnings("serial")
class CustomBlockingQueue extends LinkedList<Object> {
    private static final int MAX_SIZE = 10;

    private Semaphore mutex = new Semaphore(1);
    private Semaphore fillCount = new Semaphore(0);
    private Semaphore emptyCount = new Semaphore(MAX_SIZE);

    @Override
    public boolean offer(Object e) {
        try {
            mutex.acquire();
        } catch (InterruptedException e2) {
            e2.printStackTrace();
        }
        boolean result = super.offer(e);
        System.out.println("offer " + size());
        try {
            fillCount.release();
            emptyCount.acquire();
            mutex.release();
        } catch (InterruptedException e1) {
            e1.printStackTrace();
        }
        return result;
    }

    @Override
    public Object poll() {
        try {
            mutex.acquire();
        } catch (InterruptedException e2) {
            e2.printStackTrace();
        }
        Object result = super.poll();
        System.out.println("poll  " + size());
        try {
            emptyCount.release();
            fillCount.acquire();
            mutex.release();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return result;
    }
}

class Producer implements Runnable {
    private CustomBlockingQueue blockingQueue;
    private Random random = new Random();

    public Producer(CustomBlockingQueue blockingQueue) {
        this.blockingQueue = blockingQueue;
    }

    @Override
    public void run() {
        while (!Thread.currentThread().isInterrupted()) {
            try {
                TimeUnit.SECONDS.sleep(random.nextInt(2));
                blockingQueue.offer(new Object());
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
}

class Consumer implements Runnable {
    private CustomBlockingQueue blockingQueue;
    private Random random = new Random();

    public Consumer(CustomBlockingQueue blockingQueue) {
        this.blockingQueue = blockingQueue;
    }

    @Override
    public void run() {
        while (!Thread.currentThread().isInterrupted()) {
            try {
                TimeUnit.SECONDS.sleep(random.nextInt(4));
                blockingQueue.poll();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    } 
```

使用信号量

信号量解决了丢失唤醒呼叫的问题。在下面的解决方案中，我们使用了两个信号量，fillCount 和 emptyCount，来解决这个问题。fillCount 是缓冲区中要读取的项目数，emptyCount 是缓冲区中可以写入项目的可用空间数。当新项目被放入缓冲区时，fillCount 会增加，而 emptyCount 会减少。如果生产者在其值为 0 时尝试减少 emptyCount，则生产者将进入睡眠状态。下次消费一个项目时，emptyCount 会增加，生产者会醒来。消费者的工作方式类似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:16:37.553

您可能会考虑使用 a 来代替[`BlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)互斥锁并等待您的情况。

另一方面，我有一个旧页面，它演示了生产者/消费者的竞争条件（与虚假中断相反）。但是我的实现不使用信号量，所以我不确定它会帮助你：

> [http://256stuff.com/gray/docs/misc/producer_consumer_race_conditions/](http://256stuff.com/gray/docs/misc/producer_consumer_race_conditions/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:18:01.427

您的锁定顺序错误：

需要提供：

```
 emptyCount.acquire();
        mutex.acquire();
        doModification();
        mutex.release();
        fillCount.release(); 
```

民意调查需要类似的更改：

```
 fillCount.acquire();
        mutex.acquire();
        doModification();
        mutex.release();
        emptyCount.release(); 
```

在您的实现中，您在等待信号量的同时持有互斥量，这会导致问题，因为其他线程可以等待互斥量以释放信号量。

# facebook-graph-api - 使用 Graph API Explorer 发布照片

> ID：10020025
> 
> 赞同：3
> 
> 时间：2012-04-04T22:14:10.283
> 
> 标签：facebook-graph-api, photo

我的最终目标是以编程方式执行此操作，但作为健全性检查，我试图使用 Facebook Graph API Explorer 将上传的照片（从我的计算机）发布到 Facebook 页面。我有访问令牌和 photo_upload 和 publish_stream 权限。

我只是不明白该怎么做才能表明照片的位置。我该怎么做？
谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:33:08.120

将 curl 与 -F 和 "source=" 标志一起使用，它应该可以工作。下面是我们的一个应用程序的代码片段（我们用 PHP 构建了这个 curl 命令）：

```
curl -F 'access_token=xxxxxx' -F 'source=@/path/to/image.jpg' 
-F 'message=' -F 'privacy={"value": "EVERYONE"}' 
https://graph.facebook.com/FB-ALBUM-ID/photos 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T01:00:57.607

我认为 Graph API explorer 工具不支持文件上传，因此您将无法使用它来检查您的上传。

Facebook 接受图片上传的 url 参数 - 指向完整的图片 url，Facebook 应该选择它。由于它只是一个字符串，因此您可以使用 Explorer。

但是，Facebook 应该会在上传照片时出现合理的错误——我会开始编码而不是担心浏览器工具！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-01T10:25:58.803

我设法使用[它](https://developers.facebook.com/docs/graph-api/photo-uploads)从 Graph API Explorer 发布图像！

[![使用图形浏览器发布](../Images/3654b07068eeef1a2c2046cd22790c45.png)](https://i.stack.imgur.com/t6uik.png) 希望这可以帮助。

# ruby-on-rails - 如何更改现有 Rails 应用程序的版本

> ID：10020035
> 
> 赞同：1
> 
> 时间：2012-04-04T22:15:07.087
> 
> 标签：ruby-on-rails

我有一个 rails 应用程序，我想将它部署在具有较低版本 rails 的服务器上。考虑到版本的差异，部署应用程序的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:22:11.497

可能最好的方法是：

1.  分支你的存储库
2.  安装[RVM（Ruby 版本管理器）](http://www.beginrescueend.com/)
3.  源 RVM/重启你的 shell[s]
4.  `.rvmrc`在服务器上为 Ruby 版本创建一个
5.  调整 Gemfile 以使用服务器上的 Rails 版本
6.  `bundle install`
7.  修复失败的规格/测试
8.  手动验证站点是否按预期工作

此时，如果您认为服务器上的 Rails 版本可能不会很快（或永远）升级，那么您可能希望将您的分支提升为新的 master。

# iphone - Iphone 上传字符串到 FTP 服务器

> ID：10020036
> 
> 赞同：0
> 
> 时间：2012-04-04T22:15:08.070
> 
> 标签：iphone, ios5

我需要简单地将字符串作为 txt 上传到我的 ftp 服务器，我搜索得很好，但没有任何效果。有没有简单地将字符串上传到 ftp 服务器？注意：我查看了 s7ftp 的东西 simpleftp 和苹果的 ftp 东西，我无法得到任何工作。

先谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:22:35.583

您可以创建一个服务器端脚本来解析 POST/GET 字符串吗？对于您可以在 3 行服务器端执行的操作，似乎上传文件可能需要大量繁重的工作/编码。只是一个想法。

**编辑添加**

这里有一些简单的 Objective-C，你可以随便看看：

```
// Create the request.
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.YOURDOMAIN.com/?string=YOURSTRINGORWHATEVER"]
                        cachePolicy:NSURLRequestUseProtocolCachePolicy
                    timeoutInterval:60.0];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    // Create the NSMutableData to hold the received data.
    // receivedData is an instance variable declared elsewhere.
    receivedData = [[NSMutableData data] retain];
} else {
    // Inform the user that the connection failed.
} 
```

[单击此处了解有关 URL 加载的更多信息](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)

如果您无法使用 ARC 或遇到问题，请尝试此课程。很方便：

[GitHub 上的 SMWebRequest 类](https://github.com/nfarina/webrequest)

希望这可以帮助。

# python - 使用带有安装参数的 setuptools

> ID：10020037
> 
> 赞同：2
> 
> 时间：2012-04-04T22:15:16.400
> 
> 标签：python, setuptools, pyamf

`install_requires`有没有办法在 setuptools中传递安装参数？

我想要做的是使用`--disable-ext`arg 安装 PyAMF。我尝试了以下变化：

```
from setuptools import setup

setup(
    install_requires=["pyamf[disable-ext]==0.6.1"]
) 
```

但是 args 似乎不是这样传递的（尽管我可能误解了`[]`上下文中`install_requires`的用法）。

**编辑：**

正如 Epic_orange 指出的那样，我当然可以使用 手动执行此操作`python setup.py --disable-ext`，但我正在尝试将其自动化。我当前的解决方案是脚本化的，但我对这个单个包的独立性不满意，我正在尝试找到一种方法将其与其他依赖项结合在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:18:50.147

从命令行使用它。例如：

`python setup.py --disable-ext`

编辑：

我不熟悉 PyAMF，但如果它没有那个参数，你可以让它从命令行再次运行，并带有一个参数：

```
 import subprocess,sys
   if len(sys.argv)==1: 
       subprocess.call('python setup.py --disable-ext')
       exit()
   #if it reaches here it will have that argument
   from setuptools import setup

   setup(
         install_requires=["pyamf[disable-ext]==0.6.1"]
   ) 
```

# spring - Spring @ContextConfiguration 注解、TestNG 和 IDEA

> ID：10020038
> 
> 赞同：2
> 
> 时间：2012-04-04T22:16:03.743
> 
> 标签：spring, intellij-idea, testng

我遇到了 IDEA 的问题，如果能帮助我解决这个问题，我将不胜感激。我有一个引用 DI 的 Spring (3.1) 配置文件的测试类 (TestNG)。这在通过 mvn 运行测试时工作正常。在 Eclipse 中运行它也可以正常工作。但是，当我尝试通过 IDEA 运行它时，似乎 DI 没有发生并且我的测试失败了。有趣的是，IDE 似乎可以正确解析我的测试类中的 bean。以下是代码的外观：

```
@ContextConfiguration("classpath:my-config.xml")
public BaseTest
{
   @Autowired
   private SomeType myVar;       

}

public Test1 extends BaseTest
{
    public void someTest()
    {
        // uses myVar but fails because it's null

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:05:24.160

xml 文件可能不会复制到您的类路径中。[这](http://jimbarritt.com/non-random/2010/07/02/intellij-compile-resources/)可能会有所帮助。

# jquery - 在 Grails REST 中使用参数获取 JSON 对象

> ID：10020040
> 
> 赞同：2
> 
> 时间：2012-04-04T22:16:14.077
> 
> 标签：jquery, json, grails, params

我是 Grails 的新手，所以这可能是一个愚蠢的......但是我正在尝试使用 Grails REST 从 Grails 中的 jquery 客户端获取 json 对象，但我得到了 null。可能是一个小问题，但它对我想要测试的前几个数据流造成了障碍

我的jQuery调用：

```
var jsonObjects = [{name: "IPAD", input: "IPAD", program: "IPAD", destination: "IPAD",    
priority: "IPAD", userData: "IPAD", email: "IPAD", webCallBackURL: "IPAD", copyToLocal:    
"IPAD", scriptPreProcess: "IPAD", deleteSource: "IPAD", moveToSource: "IPAD",    
scriptPostProcess: "IPAD", inputImage: "IPAD", leftImage: "IPAD", topImage: "IPAD", 
opacityImage: "IPAD", bImageAdAvBlanking: "IPAD"}] 

$.ajax({ 
    type: "POST", 
    url: 'http://localhost:8080/Medusa/jobControlREST/save', 
    data: {ipad: JSON.stringify(jsonObjects)}, 
    contentType: "application/json; charset=utf-8", 
    dataType: "json", 
    beforeSend: function(x) { 
        if (x && x.overrideMimeType) { 
            x.overrideMimeType("application/json;charset=UTF-8?"); 
        } 
    },
    success: function() { 
        alert('hi'); 
    } 
}); 
```

我的圣杯：

```
def save = { 
    def jsonString = params['ipad'] //returns null 
    def json = JSON.parse(jsonString) // returns null obviously 
    println "this is POST call" +json // gets printed but json is null...sign ( 
} 

urlmapping: 
    "/$controller/$action?/$id?"(parseRequest:true) {
        constraints { 
            action = [GET:"index", POST:"save", PUT:"update", DELETE:"remove"] 
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-01T23:43:48.827

用这个：

```
def jsonObject=request.JSON 
```

# vb.net - 查找窗口文本

> ID：10020042
> 
> 赞同：1
> 
> 时间：2012-04-04T22:16:29.050
> 
> 标签：vb.net, findwindow

嘿，我正在尝试从外部程序中获取一些文本。目前我正在使用此代码：

```
Dim lngHWND As Long
Dim lngHWNDF As Long
Dim lngID As Long
Dim lngChild As Long
Dim lngRet As Long

lngHWND = FindWindow(vbNullString, "Client - Main")

Do
   lngChild = FindWindowEx(lngHWND, 0&, "ThunderRT6Frame", vbNullString)

   If lngChild <> 0 Then
        lngID = GetWindowLong(lngChild, GWL_ID)
        MsgBox("Child HWND: " & Hex(lngChild) & " ID: " & lngID)
        lngRet = CloseHandle(lngChild)
   End If
Loop Until lngChild = 0

lngRet = CloseHandle(lngHWNDF)
lngRet = CloseHandle(lngHWND) 
```

我得到了 lngHWND、lngHWNDF 和 lngChild 的值。但是，它们只是值（数字）而不是文本本身。

这是我试图从中获取文本的程序的图像： ![前卫](../Images/d3823074fbac1eb989c07c06ea10ae5e.png)

我怎样才能从它找到的那些项目中获取文本？

大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:34:59.370

它实际上已经十多年了，但我很确定您可以使用`SendMessage`/`WM_GETTEXT`来处理您想要文本的子窗口的句柄。如果你走这条路，你必须准备 API 可以将结果写入的字符串缓冲区。

似乎还有一个使用`SendMessage`/`WM_GETTEXT`我在[这里](http://www.xtremedotnettalk.com/showthread.php?t=49583)找到的快捷方式：

```
Public Declare Ansi Function GetWindowText Lib "User32.dll" Alias "GetWindowTextA" ( _
    ByVal hwnd As Integer, _
    ByVal lpString As StringBuilder, _
    ByVal nMaxCount As Integer) As Integer

' example:
Dim s As New StringBuilder(256)
GetWindowText(hwnd, s, s.Capacity) 
```

# html - li 元素的全对齐

> ID：10020046
> 
> 赞同：8
> 
> 时间：2012-04-04T22:16:46.777
> 
> 标签：html, css

我们有一个自适应布局，其中一些列表元素水平显示：

```
| Li1 | Li2 | Li 3 | Li4 | 
```

显然我可以设置

```
ul {width:100%}
ul li {width:25%} 
```

随着浏览器改变大小，让 li 改变大小。然而，我们希望最左边 li 的左边缘与左边缘对齐，而最右边 li 的右边缘与右边缘对齐，即使在浏览器展开时也是如此。

```
Li1    Li2    Li3     Li4
|                       |

Li1      Li2      Li3       Li4
|                             |

Li1  Li2  Li3   Li4
|                 | 
```

有没有办法用纯css做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-04T23:17:03.353

使用[这个解决方案](https://stackoverflow.com/a/6633978/757830)（或[这个](https://stackoverflow.com/a/6460260/757830)）。将该答案转换为列表会导致：

标记：

```
<ul>
    <li>Item1</li>
    <li>Item2</li>
    <li>Item3</li>
    <li>Item4</li>
</ul> 
```

样式表：

```
ul {text-align: justify}
ul::after {width: 100%; display: inline-block; content: "."; visibility: hidden}
li {display: inline-block} 
```

这是一个 IE7+ 解决方案。对于 IE7，您需要一个与列表项相邻的额外元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-11T21:30:01.727

恕我直言，最好的方法是使用 CSS3 Flexboxes：

```
.menu {
    display: flex;
    justify-content: space-around;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T22:57:39.703

[http://jsfiddle.net/yUgYW/3/](http://jsfiddle.net/yUgYW/3/)

这就是我到目前为止所得到的......可能是你的开始

**HTML**

```
<div id="container">
<ul>
    <li class="fisrt">1</li>
</ul>
<ul class="center">
    <li>2</li>
    <li>3</li>
    <li>4</li>
</ul>
<ul>
    <li class="last">5</li>
</ul>
</div>​ 
```

**CSS**

```
#container
{
}

li
{float:left;
border:1px solid red;
width:120px;}
.fisrt
{
  float:left;
}
.last
{
  float:right;
}
.center
{
  width:400px;
  margin:auto;
}​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T06:19:35.453

嗨，您在您的 li 中定义文本对齐对齐，如下所示

**css**

```
ul {width:100%}

ul li {width:25%;
    list-style:none;
    display:inline-block;
    text-align:justify;
    margin:2px;
    background:yellow;
    word-wrap: break-word;

} 
```

**HTML**

```
<ul>
    <li>Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere </li>
    <li>Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere Demo text hrere </li>  <li>DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD</li>    
</ul> 
```

现场演示[http://jsfiddle.net/rohitazad/8UakC/8/](http://jsfiddle.net/rohitazad/8UakC/8/)

# mercurial - 如果 Mercurial 中有未提交的子仓库更改，我如何使“提交”中止？

> ID：10020047
> 
> 赞同：3
> 
> 时间：2012-04-04T22:16:47.120
> 
> 标签：mercurial, mercurial-subrepos

这似乎一直发生在我身上：我在父仓库工作。我在 subrepo 中找到并修复了一个错误。我继续进行父回购工作。我使用“添加的功能 X”之类的消息提交父仓库。我推。

在这一点上，我注意到 subrepo 错误修复也被提交和推送，提交消息与 subrepo 完全*无关*。

让自己成为“提交”替代品的最简单方法是什么，在这种情况下会拒绝做任何事情，指出子回购有未提交的更改？或者，也许我可以在我的`.hgrc`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T23:42:41.487

你有两个选择：

1.  将 Mercurial 安装升级到 2.0 或更高版本
2.  编辑您的`~/.hgrc`文件并将以下选项添加到该`[ui]`部分：

    ```
    commitsubrepos = false 
    ```

# php - 使用 PHP 和 PDO 和 MS SQL 从字符串转换日期时间时转换失败

> ID：10020049
> 
> 赞同：0
> 
> 时间：2012-04-04T22:16:52.340
> 
> 标签：php, sql-server, pdo, prepared-statement

这是我在这个网站上的第一篇文章，所以如果格式中有一些奇怪的地方，我很抱歉:)

在互联网上搜索这个问题的答案大约一周后，我想我会试试这个网站，因为它在过去帮助了我无数次。

无论如何，我最近开始在 PHP 中使用 PDO 与我一直在从事的项目中的 MS SQL 数据库进行交互。其中一个表的设置方式基本上是几乎所有数字、日期时间和字符字段。我的问题是日期字段。我正在编写的脚本是从一个表中复制一行并将其放入另一个具有自己 ID 的行 - 我收到错误，因为原始表具有 NULL 值，因为该表中的数据发生了很大变化，并且许多默认值的字段为 NULL。

为了解决这个问题，在尝试了很多不同的方法来让 NULL 值起作用之后，我编写了一个函数，用零替换所有的 null 值。除了日期值之外，这工作正常 - 在将它们注释掉之后，插入语句可以正常工作 - 但是在使用它们时，我得到“从字符串转换日期时间时转换失败”。错误，大概是因为数据库无法将“0”转换为日期时间值。

我将如何解决这个问题？

这是我替换 NULL 值的函数。我觉得我还应该注意，如果我只是将值保留为 NULL，则会收到将数据类型 nvarchar 转换为数字的错误。错误。

```
function check_empty($field, $slno){
try{
    require("assets/dbcnct.php");

    $stmt = $DBH->prepare(" select ". $field ." from timeticket where slno = :slno ");  

    $stmt->bindParam(':slno', $slno);

    $stmt ->execute();  

    $result = $stmt->fetch(PDO::FETCH_ASSOC);

    echo "<pre>";
    var_dump($result);
    echo "</pre>";

    foreach($result as $key=>$val){
            if(empty($val)){
                    $val = 0;
            }   
    }   
    return trim($val);

}
catch(PDOException $e) {  
    echo "<pre>";
    echo $e->getMessage();  
    echo "</pre>";
} 
```

}

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-04T22:33:22.000

欢迎来到 Stackoverflow！:-)

**设置值的默认`NULL`值**

你可以做

```
SELECT IFNULL(`myColumn`, 'default value for this column') as `myColumn` ... 
```

为列设置默认值，如果它是`NULL`. 这将返回`myColumn`如果不是`NULL`，`default value for this column`否则返回的值。

示例：如果表中的日期是，则获取当前日期`NULL`

```
SELECT IFNULL(`myDateColumn`, NOW()) as `myDateColumn` ... 
```

**在 MySQL 中的表之间复制元组**

我还认为您不需要 PHP 将元组从一个表复制到另一个表中。请参阅 MySQL 的[INSERT INTO SELECT](https://dev.mysql.com/doc/refman/5.0/en/insert-select.html)。

示例：假设您有`source`一个`destination`自动递增的主键`id`和一个`date`允许`NULL`值的列。

```
INSERT INTO `destination` (`id`, `date`) SELECT NULL, `date` FROM `source` 
```

这将从表中选择所有`date`s`source`并将它们插入到`destination`为每个新创建的元组创建一个新 ID 中。这也将保留 NULL 值。

这是在表之间复制元组的首选解决方案。因为在 MySQL 和 PHP 之间实际上没有数据传输，所以这将非常快，即使对于大量元组也是如此。

# c# - winform 中的线程 - Compact .NET Framework 3.5

> ID：10020056
> 
> 赞同：2
> 
> 时间：2012-04-04T22:17:11.500
> 
> 标签：c#, multithreading

我在启动实时监控的函数中有一个线程，它基本上打开串口并不断从串口读取数据。但是，如果我需要终止这个线程，我应该怎么做呢？因为如果我不终止打开特定串口并读取数据的正在运行的线程。当我关闭它并再次调用该函数时。同一个串口打不开。我怀疑串口没有正确关闭，并且仍在单独的线程中运行。所以我认为我必须终止该线程以便下次再次打开相同的串行端口。有谁知道如何实现这一目标？

我看过一些论坛说 Thread.Abort() 使用起来很危险。它应该只在最后的手段下使用。

感谢您的帮助。

查尔斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T22:37:18.883

通常，您设计在后台线程中运行的方法来侦听取消请求。这可以像布尔值一样简单：

```
//this simply provides a synchronized reference wrapper for the Boolean,
//and prevents trying to "un-cancel"
public class ThreadStatus
{
   private bool cancelled;

   private object syncObj = new Object();

   public void Cancel() {lock(syncObj){cancelled = true;}}

   public bool IsCancelPending{get{lock(syncObj){return cancelled;}}}
}

public void RunListener(object status)
{
   var threadStatus = (ThreadStatus)status;

   var listener = new SerialPort("COM1");

   listener.Open();

   //this will loop until we cancel it, the port closes, 
   //or DoSomethingWithData indicates we should get out
   while(!status.IsCancelPending 
         && listener.IsOpen 
         && DoSomethingWithData(listener.ReadExisting())
      Thread.Yield(); //avoid burning the CPU when there isn't anything for this thread

   listener.Dispose();
}

...

Thread backgroundThread = new Thread(RunListener);
ThreadStatus status = new ThreadStatus();
backgroundThread.Start(status);

...

//when you need to get out...
//signal the thread to stop looping
status.Cancel();
//and block this thread until the background thread ends normally.
backgroundThread.Join() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:23:02.903

首先认为您有线程并关闭所有线程，您应该在启动它们之前将它们全部设置为后台线程，然后当应用程序退出时它们将自动关闭。

然后尝试这种方式：

```
Thread somethread = new Thread(...);
someThread.IsBackground = true;
someThread.Start(...); 
```

请参阅[http://msdn.microsoft.com/en-us/library/aa457093.aspx](http://msdn.microsoft.com/en-us/library/aa457093.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:28:12.567

使用最初设置为 false 的布尔标志，当您希望线程退出时，将其设置为 true。显然，您的主线程循环需要监视该标志。当它看到它更改为 true 时，您的轮询，关闭端口并退出主线程循环。

您的主循环可能如下所示：

```
OpenPort();
while (!_Quit)
{
    ... check if some data arrived
    if (!_Quit)
    {
        ... process data
    }
}
ClosePort(); 
```

根据您等待新数据的方式，您可能希望使用事件（`ManualResetEvent`或`AutoResetEvent`）以便在您希望线程退出时唤醒您的线程。

# visual-studio - 使用 Visual C++ 2010 启动程序时无法指定相对文件路径

> ID：10020059
> 
> 赞同：1
> 
> 时间：2012-04-04T22:17:28.347
> 
> 标签：visual-studio, filepath

所以程序编译正常，可执行文件在$(SolutionDir)/Debug中生成。当我从调试文件夹本身运行可执行文件时，程序成功扫描放置在 dubug 目录中的文件夹以查找文件。但是，当我从 Visual Studio 执行程序时，除非我将该目录的全局路径输入到 FindFirstFile 函数，否则程序将失败。为什么？

例如：我必须这样做才能从 Visual Studio 调试程序：

```
#ifdef _DEBUG
#define FILEPATH L"C:/Users/Steven/Documents/Visual Studio 2010/Projects/$(SolutionDir)/Debug/Effects/*.dll"
#else
#define FILEPATH L"Effects/*.dll"
#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:00:14.120

可能是因为当您的应用程序在调试器下运行时，工作目录不是*项目的*目录，而是*调试器的*目录（或其他不包含您的 DLL 文件的任意目录）。

通过打开项目的属性并检查调试设置来检查（并修复）此问题。具体来说，属性 → 配置属性 → 调试。“工作目录”设置应设置为`$(TargetDir)`.

# javascript - jQuery 事件性能：在父级上绑定单个事件还是在每个子级上绑定单个事件？

> ID：10020061
> 
> 赞同：3
> 
> 时间：2012-04-04T22:17:38.833
> 
> 标签：javascript, javascript-events, jquery

我有一个包含大量子 div 的 div（大约 4k-5k！）。每个孩子都有一个`'mousedown'`和`'mouseup'`事件附加到它。

我应该将这些事件一次附加到父级并使用选择子级`$(e.target)`吗？会不会有任何性能优势，如果有，为什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T22:21:29.097

我想使用[jquery.on()](http://api.jquery.com/on/)会是理想的。

```
$("#divWithHugeAmountsOfChildDiv").on("mousedown", 
                                      ".childCLASSEStoMouseDown", 
                                      function()
{
  alert("Booya!");
}); 
```

您的 html 可能如下所示：

```
<body>
  <!-- lots of other elements -->
  <div id="divWithHugeAmountsOfChildDiv">
    <!-- lots of different type of elements -->
    <div class="childCLASSEStoMouseDown">Booya?</div>
    <!-- lots of different type of elements -->
  </div>
  <!-- lots of other elements -->
</body> 
```

根据需要更改 jQuery 选择器...

该方法的 jQuery 文档中很好地解释了原因`On`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T22:27:48.140

jQuery 的使用[`.on()`](http://api.jquery.com/on/)已经为您做到了。它将事件处理程序绑定到某个父级并检测子事件。它具有优于直接事件绑定之类的性能优势`.live()`，因为：`.bind()``.click()`

*   不像`.live()`, 它将事件绑定到`document`, , `.on()`, 你负责绑定哪个父级。

*   `.live()`绑定到`document`哪个是文档的根。冒泡的事件会走得更远。使用`.on()`，您可以找到最近的公共父级来绑定该事件。泡沫会减少 - 性能优势

*   使用`.on()`，您只需将一个处理程序绑定到父处理程序，`.bind()`这与直接事件绑定不同，后者在每个元素的基础上绑定事件 - 对很多元素不利。

*   `.on()`更容易记住。

*   获取目标时，在内部`.on()`，“this”始终是目标元素。不用担心跨浏览器甚至目标。jQuery 会为您做到这一点。

所以这段代码中的“this”：

```
$(element).on('click','someElement',function(){
    //the value of "this" in here is the DOM element target of the event
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T22:24:57.197

有了这么多子 div，你绝对应该使用 jQuery 的委托事件处理`.on()`。这将为您在父级上提供一个事件处理程序，而不是在子级上提供 4000 个事件处理程序。安装和初始化也会快得多。

如果您使用 的委托形式`.on()`，则不必检查`e.target`自己，因为 jQuery 会为您完成。

以这种方式使用的语法`.on()`是这样的：

```
$('parentSelector').on('mousedown', 'child selector', function(e) {
    // code here
    // "this" will be the object that initiated the event
}); 
```

更多信息在[jQuery 文档中`.on()`](http://api.jquery.com/on/)。

# iphone - UITableview dequeueReusableCellWithIdentifier 重复行

> ID：10020062
> 
> 赞同：2
> 
> 时间：2012-04-04T22:17:43.310
> 
> 标签：iphone, ios, uitableview, asynchronous

我知道这可能已经被问过，但我遇到了出队问题。基本上，我在某种网格的单元格中使用异步图像加载。

所以本质上，我为一个相当简单的 3 列表添加了 left 、 middle 和 right 图像。我将行数设置为 15（总共大约 45 个单元格），并从数组中为每个行设置图像 url。

由于某种原因，前 16 个单元格在底部重复，当异步图像加载开始时，它们被正确的图像替换。如果我替换删除出队的东西，它会加载正常并且不会重复前 16 个块大约 3 次。

```
if (!cell) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:MyIdentifier];
            cell.contentView.autoresizesSubviews = YES;
            cell.contentView.clipsToBounds = YES;
            cell.backgroundColor = [UIColor clearColor];

            Asynimage *leftImage;
            leftImage = [[Asynimage alloc] initWithFrame:CGRectMake(0,0,IMG_SIZE,IMG_SIZE)];

            leftImage.tag  = 10;
            [cell.contentView addSubview:leftImage];

            Asynimage *middleImage;
            middleImage = [[Asynimage alloc] initWithFrame:CGRectMake(IMG_SIZE,0,IMG_SIZE,IMG_SIZE)];
            middleImage.tag  = 20;

            [cell.contentView addSubview:middleImage];

            Asynimage *rightImage;
            rightImage = [[Asynimage alloc] initWithFrame:CGRectMake(IMG_SIZE*2,0,IMG_SIZE,IMG_SIZE)];
            rightImage.tag  = 30;

            [cell.contentView addSubview:rightImage];

        }

        Asynimage *leftImage=(Asynimage*)[cell.contentView viewWithTag:10];
        Asynimage *middleImage=(Asynimage*)[cell.contentView viewWithTag:20];
        Asynimage *rightImage=(Asynimage*)[cell.contentView viewWithTag:30];

        /*Set the urls on those 3 then do the loadimagefrom url*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:29:40.323

双端队列不会复制行，但它会触发重用单元格，这些单元格之前已为不再可见的行实例化，以优化内存使用。效果正是您所描述的重复。使用子视图填充重复使用的单元格，在它们被出队后。将异步图像存储在一个数组中，并使用行索引将它们放在正确的单元格中。

# javascript - 将 JSON 输入传递给 DataTables

> ID：10020068
> 
> 赞同：1
> 
> 时间：2012-04-04T22:18:05.400
> 
> 标签：javascript, jquery, json, datatables

```
...
// result is a JSON data passed to this function from outside
var result = getMyJSON();
var input = "{aaData: ["+result+"],"+'aoColumns':[
    { 'sTitle': 'Title', 'mDataProp': 'title' }]}";

$(document).ready(function() {
    $('#example').dataTable(input);
});
</script>

<table id='example' class='example' border='1'> 
```

我知道 .dataTable() 函数需要此处指定的初始化对象：http://datatables.net/ref#aaData[如果](http://datatables.net/ref#aaData) 在 dataTable 函数中我手动粘贴 JSON 数据 - 那么它显示一切正常。如何“准备”并作为初始化对象传递给 dataTables() 函数？现在这不能正常工作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:25:57.627

我不确定您为什么要将输入变量构建为字符串 - 它是一个对象。试试这个

```
var input = {
    "aaData" : [result],
    "aoColumns" : [{
        "sTitle" : "Title"
    }, {
        "mDataProp" : "title"
    }]
}; 
```

# c# - 找不到类型“MyType”的默认成员

> ID：10020069
> 
> 赞同：2
> 
> 时间：2012-04-04T22:18:05.633
> 
> 标签：c#, vb.net, gridview

我正在使用 ObjectDataSource 将对象绑定到 GridView。在 OnRowDataBound 事件处理程序中，我试图确定某个按钮是否应该可见。当运行时遇到此语句时，它会触发“No default member found for type 'Pledge'”。错误：

```
lbDel.Visible = Not (e.Row.DataItem("BillingReady")) 
```

我绑定到 GridView 的 Object 类：

```
public class Pledges : System.Collections.CollectionBase
{
    public Pledge this[int index]
    {
        get { return ((Pledge)(List[index])); }
        set { List[index] = value; }
    }

    public int Add(Pledge pledge)
    {
        return List.Add(pledge);
    }
} 
```

我的承诺课：

```
public class Pledge
{
    public int PledgeID { get; set; }
    public int EventID { get; set; }
    public int SponsorID { get; set; }
    public int StudentID { get; set; }
    public decimal Amount { get; set; }
    public string Type { get; set; }
    public bool IsPaid { get; set; }
    public string EventName { get; set; }
    public DateTime EventDate { get; set; }
    public bool BillingReady { get; set; }
    public string SponsorName { get; set; }
    public int Grade_level { get; set; }
    public string StudentName { get; set; }
    public string NickName { get; set; }
    public int Laps { get; set; }
    public decimal PledgeSubtotal { get; set; }
} 
```

我的 OnRowDataBound 事件处理程序：

```
Protected Sub PledgeGrid_OnRowDataBound(ByVal sender As Object, ByVal e As GridViewRowEventArgs)
    If (e.Row.RowType = DataControlRowType.DataRow) And _
      Not ((e.Row.RowState = DataControlRowState.Edit) Or ((e.Row.RowState = DataControlRowState.Alternate) And (e.Row.RowState = DataControlRowState.Edit))) Then
        Dim lbDel As LinkButton
        Dim lbEd As LinkButton
        lbDel = CType(e.Row.FindControl("lbDelete"), LinkButton)
        lbEd = CType(e.Row.FindControl("lbEdit"), LinkButton)

        If ((e.Row.RowState = DataControlRowState.Normal) Or (e.Row.RowState = DataControlRowState.Alternate)) Then
            lbDel.Visible = Not (e.Row.DataItem("BillingReady"))    '<-- Problem happens here
            lbEd.Visible = Not (e.Row.DataItem("BillingReady"))
        End If
    End If
End Sub 
```

是的，我不得不混合使用 VB 和 C#，但我认为这不是问题所在。如果我理解 VB 默认属性的 C# 等效项称为索引器。这不应该有资格作为索引器吗？

```
public Pledge this[int index]
{
    get { return ((Pledge)(List[index])); }
    set { List[index] = value; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T22:38:02.920

尝试投射`DataItem`到`Pledge`：

```
Dim pledge = DirectCast(e.Row.DataItem, Pledge)
lbDel.Visible = Not pledge.BillingReady 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-24T23:41:39.327

将 ac# 模型绑定到 VB DataGrid 时，我遇到了同样的问题。

通常在 aspx 文件中，DataGrid 会在模板列中显示一个字段：

```
 <asp:templatecolumn headertext="Reference">
            <itemtemplate>
                <%# Container.DataItem("Reference")%>
            </itemtemplate>
        </asp:templatecolumn> 
```

但是当使用我的 c# 模型时，DataGrid 需要一个模板列语法：

```
 <asp:templatecolumn headertext="Reference">
            <itemtemplate>
                <%# DataBinder.Eval(Container.DataItem, "Reference") %>
            </itemtemplate>
        </asp:templatecolumn> 
```

这是一个令人困惑的问题，因此希望答案能帮助您节省我解决这个问题的时间。

# c - AIX loadquery() 返回值解释（在 64 位模式下也是 SEGV）

> ID：10020070
> 
> 赞同：2
> 
> 时间：2012-04-04T22:18:06.807
> 
> 标签：c, aix, dynamic-linking

我正在尝试使用 xlc_r 在 AIX 5.3 上编译 Ruby 1.9.3-p125。我想使用 --enable-load-relative 但这依赖于 dladdr() 函数来获取 Ruby 共享库的路径名，并且 dladdr() 在 AIX 上不可用。我基于对 loadquery(L_GETINFO) 的调用在 AIX 的[root.cern.ch 上找到了 dladdr() 的实现。](http://root.cern.ch/drupal/content/aix-and-dladdr)

loadquery(L_GETINFO) 调用获取组成程序的二进制文件的列表。因此，为了实现 dladdr()，我正在检查传递给 dladdr 的函数地址是否介于 ldinfo_textorg 和 ldinfo_textorg+ldinfo_textsize 之间。*但是对于返回的任何*结构，函数的地址都不在此地址范围内。也许我没有正确解释 ld_info 结构。

我附上了我正在测试的代码。可以为这些问题提供的任何帮助将不胜感激。

```
#include <sys/types.h>
#include <sys/ldr.h>
#include <stdlib.h>
#include <stdio.h>

typedef struct {
  char* dli_fname;
} Dl_info;

int
dladdr(void* s, Dl_info* i) {
   size_t bufSize = 40960;
   struct ld_info* ldi;
   void *buf;
   int r;

   printf("sym at %lu\n", (ulong)s);
   buf = (void *)malloc(bufSize);
   if (!buf) {
     i->dli_fname = 0;
     return 0;
   }
   r = loadquery((int)L_GETINFO,  buf,  (int)bufSize);
   if (r == -1) {
     i->dli_fname = 0;
     return 0;
   }
   do {
     ldi = (struct ld_info*)buf;
     printf("checking %s, text %lu - %lu\n", ldi->ldinfo_filename, (ulong)ldi->ldinfo_textorg, (ulong)(ldi->ldinfo_textorg + ldi->ldinfo_textsize));
     if ((ldi->ldinfo_textorg <= s)
     &&  (s < (ldi->ldinfo_textorg + ldi->ldinfo_textsize))) {
       i->dli_fname = ldi->ldinfo_filename;
       return 1;
     }
     buf += ldi->ldinfo_next;
   } while (ldi->ldinfo_next);
   i->dli_fname = 0;
   return 0;
}

int
test_func() { 1; }

int
main() {
  Dl_info dli;
  int rc = dladdr((void *)test_func, &dli);
  printf("rc = %d\n", rc);
  if (rc) {
    printf("dli.dli_fname = %s\n", dli.dli_fname);
  }
} 
```

**2012 年 4 月 30 日更新：** 当我最初发布这个问题时，我还看到 loadquery(L_GETINFO) 从 64 位程序调用时会导致分段冲突。我不能没有 64 位，所以这对我来说是一个很好的选择。现在看起来这是编译器安装的问题；其他 AIX 机器可以在 64 位模式下编译和运行代码。

堆栈回溯如下所示：

```
.() at 0xf458
usl_getinfo_user(??, ??, ??, ??) at 0x9fffffff00096b8
uloadquery(??, ??, ??, ??, ??, ??, ??) at 0x9fffffff0009b40
loadquery(0x200000002, 0x1000b3f0, 0xa0000000a000, 0x0, 0x0, 0x0, 0x0, 0x0) at 0x900000000043874
dladdr(s = 0x0000000110000900, i = 0x0ffffffffffffa00), line 18 in "dladdr.c"
main(), line 11 in "test_dladdr.c" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T00:44:41.413

看起来您需要阅读更多关于 AIX 和 PowerPC 上的 Pointer Glue 的信息，[https://stackoverflow.com/a/1343437/89101](https://stackoverflow.com/a/1343437/89101)。如果您更改为：

```
int rc = dladdr((void*)*((ulong*)&test_func), &dli); 
```

这将获得的*实际*地址，`test_func`您将获得在主程序中找到它的预期输出。

我不确定为什么你会`loadquery`因为 64 位而崩溃。它适用于我的机器。看起来可疑的一件事是

```
loadquery(0x200000002, 0x1000b3f0, 0xa0000000a000, 0x0, 0x0, 0x0, 0x0, 0x0) at 0x900000000043874 
```

`0xa0000000a000`看起来太大了，十六`40960`进制应该只是`0x00000000a000`.

# php - 如何使用自定义 PHP 脚本添加产品？

> ID：10020071
> 
> 赞同：0
> 
> 时间：2012-04-04T22:18:08.070
> 
> 标签：php, magento

我的目标是制作一个自定义的“添加产品页面”，这样我就可以按照我想要的方式自定义所有内容。到目前为止，我已经设法创建了一个 .phtml 文件，我在后端菜单中为其创建了一个链接。

想象一下在后端查看的完全空白的 .phtml 文件——这就是我现在所处的位置。

1.  我如何制作一个表格，我可以在其中添加基本相同的东西，就像在默认的“添加产品页面”中一样 - 但通过。php？我这样做的原因是预定义一些值，因为大多数东西每次都是相同的东西。这引导我到我的..

2.  如何预定义一些值，使它们不需要更改，但可以更改？

3.  是否可以添加图片上传，所以我基本上有和默认一样的可能性？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:58:27.500

我使用了内置的 magento 导入工具。阅读并遵循它完全有效的指示。因此，如果您想创建自己的（我不建议这样做），请首先查看其导入的代码。我将我们所有的产品放在一个 MySql 数据库中，然后使用 php 脚本创建 csv 导出文件以发送到 magento。然后此脚本设置所有默认值。内置的导入可以处理图像...您将它们 ftp 到您的站点（可以在 php 中自动执行，我已经完成了），并且导入脚本会获取图像上传文件夹的位置。

我建议人们不要直接使用 Magento 的原因是它在数据库中的数据组织方式非常复杂。我从来没有见过这样的东西，而且我习惯于让 id 链接到 5 个表中的东西。在这里，他们使用一个表来执行许多功能，因此一个项目 ID 可能会显示 5 或 7 次。

此外，除非您真正了解它如何使用产品属性的架构以及其中的所有细微差别，否则谁知道结果会是什么。更糟糕的是，当更新到来时，他们会更改（或删除）您需要完成工作的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T22:46:06.510

老实说，我会使用[Magmi 之](http://sourceforge.net/apps/phpwebsite/magmi/)类的东西。

这将允许您导入包含所有数据的 csv 文件，而无需从头开始重新构建。

为了解决您的其他问题，由于要导入的文件是 csv，您基本上可以做您想做的事情。您可以复制并粘贴预定义的值。Magmi 还将导入图像并正确分配它们。

另一个好处是 Magmi 可以很好地扩展，我在我工作的网站上有 2500 多个项目，它将处理全部数据负载，或者只是非常快速地加载几个项目。

# django - 用户登录覆盖用户字段

> ID：10020073
> 
> 赞同：1
> 
> 时间：2012-04-04T22:18:31.763
> 
> 标签：django, ldap, django-authentication, python-ldap

我有一个使用 LDAP 作为身份验证后端的 Django 应用程序。

我不确定它是 LDAP 模块还是 Django 本身，但是，如果用户更改了他们的电子邮件地址、名字或姓氏，然后注销并重新登录，则这些值将恢复为其原始值（即那些从 LDAP 记录中获取）。

有没有人见过这种行为，有什么办法可以防止吗？

我遇到的问题是 LDAP 记录中的电子邮件地址不正确，需要更新，但我无法控制它们。我唯一能控制的是 Django 用户数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:50:58.163

对于那些感兴趣的人，解决方案是 LDAP 模块中有一个名为 AUTH_LDAP_ALWAYS_UPDATE_USER 的设置，您需要将其设置为 False 以确保它不会每次都更新。

# objective-c - 访问类方法中的属性？

> ID：10020082
> 
> 赞同：-1
> 
> 时间：2012-04-04T22:19:51.497
> 
> 标签：objective-c, ios, xcode

我认为这个问题是不言自明的。如果我声明一个类的属性，我似乎无法在类方法中访问该属性。有没有办法做到这一点？常规方法通常是： self.[property] 但是当我在类方法中调用它时，编译器会给我一个语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:23:43.787

问题在于它不是类的属性，而是使用该类作为模板创建的每个对象的属性。要访问该属性，您需要一个类的实例。一个常见的途径是使用**单例模式**，这样您就有一个对象和一种实现影响该对象的类方法的方法。

# objective-c - 在沙盒应用程序中使用 root 权限做某事的最佳方法是什么？

> ID：10020085
> 
> 赞同：1
> 
> 时间：2012-04-04T22:20:10.983
> 
> 标签：objective-c, ios, jailbreak

从挂钩到沙盒应用程序（应用商店应用程序）的 MobileSubstrate 调整中编辑需要 root 权限的文件的最佳方法是什么？

我看过 SandCastle 2，但是我找不到我应该如何实现它。

# android - 使用 monkeyrunner：如何在应用程序执行期间调用意图？

> ID：10020087
> 
> 赞同：0
> 
> 时间：2012-04-04T22:20:19.497
> 
> 标签：android, testing, android-intent, monkeyrunner

我有一个 android 应用程序，我想单独测试其意图功能。是否有可能与 monkeyrunner

1.  启动应用程序
2.  创建一个意图（基于一些已经建立的列表，并且可能有额外的）
3.  具有该意图的 startActivity() 或 startService()
4.  监控调用结果

自动地？我该怎么做呢？我已经看到monkeyrunner 使用python/jython，我对这些很不熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T04:13:02.907

如果您不熟悉 python（并且您不想尝试它），则不必使用 monkeyrunner，您可以访问相同的基本功能，该功能由 Java 的名为 chimpchat 的外部库提供。

血淋淋的细节可以在[http://dtmilano.blogspot.ca/2011/11/android-using-monkey-from-java.html](http://dtmilano.blogspot.ca/2011/11/android-using-monkey-from-java.html)找到。

如果您已经为 Android 应用程序使用 Java，那么您所描述的需求将相当容易实现。

# python - 使用 buildout 安装 Python c 扩展

> ID：10020089
> 
> 赞同：2
> 
> 时间：2012-04-04T22:20:39.657
> 
> 标签：python, dependency-management, buildout

我正在做的一个项目需要 avro，它需要 python-snappy，它需要 snappy。我很难想出正确的扩展咒语来真正让所有东西一起工作。

以下 buildout.cfg 构建成功，但它将 avro 安装到*develop-eggs*，并且尝试引用它的任何其他内容（例如在该`[test]`部分中）尝试再次构建它并失败。

## 构建.cfg

```
[buildout]
eggs-directory = eggs
extensions =
    buildout.dumppickedversions
eggs =
    avro
    httplib2
    pyramid
parts =
    avro
    test
    mongodb

[snappy]
# Dependency for avro
recipe = zc.recipe.cmmi
url = http://snappy.googlecode.com/files/snappy-1.0.5.tar.gz

[avro]
recipe = zc.recipe.egg:custom
egg = avro
include-dirs = ${snappy:location}/include
library-dirs = ${snappy:location}/lib

[test]
recipe = pbp.recipe.noserunner
script = runtests
eggs =
    ${buildout:eggs}
    pbp.recipe.noserunner
    WebTest

[mongodb]
recipe = rod.recipe.mongodb
base-url = http://downloads.mongodb.org
version = 2.0.4
darwin-32bit-url = ${mongodb:base-url}/osx/mongodb-osx-i386-${mongodb:version}.tgz
darwin-64bit-url = ${mongodb:base-url}/osx/mongodb-osx-x86_64-${mongodb:version}.tgz
linux2-32bit-url = ${mongodb:base-url}/linux/mongodb-linux-i686-${mongodb:version}.tgz
linux2-64bit-url = ${mongodb:base-url}/linux/mongodb-linux-x86_64-${mongodb:version}.tgz
logpath=${buildout:parts-directory}/mongodb/log
dbpath=${buildout:parts-directory}/mongodb/data
master=true
update=true 
```

## 输出

```
Uninstalling avro.
Updating snappy.
Installing avro.
zip_safe flag not set; analyzing archive contents...
Installing test.
Getting distribution for 'python-snappy'.
cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
snappymodule.cc:28:20: error: Python.h: No such file or directory
snappymodule.cc:31:22: error: snappy-c.h: No such file or directory
snappymodule.cc:36: error: ISO C++ forbids declaration of ‘PyObject’ with no type
snappymodule.cc:36: error: expected ‘;’ before ‘*’ token
snappymodule.cc:54: error: expected initializer before ‘*’ token
snappymodule.cc:59: error: expected initializer before ‘*’ token
snappymodule.cc:43: warning: ‘_state’ defined but not used
error: Setup script exited with error: command 'gcc' failed with exit status 1
An error occurred when trying to install python-snappy 0.4\. Look above this message for any errors that were output by easy_install.
While:
  Installing test.
  Getting distribution for 'python-snappy'.
Error: Couldn't install: python-snappy 0.4 
```

是否有一种直接的方法来处理扩展依赖项与构建？我应该在这里做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:53:30.143

此错误通常表示缺少开发库，可以通过以下方式解决：

> $ aptitude 安装 python-devel

换句话说，它似乎与扩建无关。

# rally - 只有叶子故事的拉力看板

> ID：10020090
> 
> 赞同：1
> 
> 时间：2012-04-04T22:20:58.923
> 
> 标签：rally, kanban

我想修改 Rally Kanban 板，使其仅显示叶子故事，就像常规积压一样。

如果我可以简单地更改查询以便它只返回没有孩子的故事，我就完成了。但不幸的是，我没有看到明显的方法来更改配置项中的查询来完成此操作，因为您无法查询用户故事的“儿童”属性。

最简单的方法是什么？我可以在之后进行后期处理并且很容易没有显示有孩子的卡片吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:11:59.693

您可能有兴趣查看我建议的添加回调/过滤器来完成此操作，作为对标准 Rally 应用程序目录看板的编辑，在[从看板过滤史诗的第二个答案中概述](https://stackoverflow.com/questions/9999975/filtering-epics-from-kanban-board)

# mercurial - 我可以让 Mercurial 大声指出我忘记“hg add”的文件吗？

> ID：10020092
> 
> 赞同：1
> 
> 时间：2012-04-04T22:21:15.843
> 
> 标签：mercurial

例如：

```
HG: Enter commit message.  Lines beginning with 'HG:' are removed.
HG: Leave message empty to abort commit.
HG: --
HG: user: romkyns
HG: branch 'default'
HG: UNTRACKED FILE: NewFile.xaml
HG: UNTRACKED FILE: NewFile.xaml.cs
HG: changed MainWindow.xaml.cs
HG: changed Settings.cs 
```

显然添加那些未跟踪的文件仍然是可选的，但希望这将显着减少我推送丢失文件的提交的次数。

有没有一些简单的方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:43:42.180

不容易，但你确实可以通过一些工作来做到这一点。

当您在`hg commit`没有给定消息的情况下运行时，Mercurial 将根据一些事情选择要使用的编辑器，主要是环境`HGEDITOR`变量和[`ui.editor`您的`hgrc`](http://www.selenic.com/mercurial/hgrc.5.html#ui).

如果您将其指向一个脚本，该脚本将在运行您选择的编辑器之前生成您想要的提交消息，您将获得预期的结果。Mercurial wiki 有[一篇关于如何使这项工作](http://mercurial.selenic.com/wiki/CommitMessageTemplate)的文章，但它只能在 Mac/Linux 上工作，除非你有`bash`（或其他一些 Unix shell）在 Windows 上运行。但是，如果您知道批处理脚本或 Powershell，那应该太难了。

# sql - SQL COUNT 和 GROUP BY Month 中没有给定月份的记录

> ID：10020094
> 
> 赞同：1
> 
> 时间：2012-04-04T22:21:29.210
> 
> 标签：sql, gaps-and-islands

我有以下一组数据：

```
ID  |  CREATED     |  USER
--------------------------
1   |  2012-01-14  |   XYZ
2   |  2012-03-14  |   XYZ
3   |  2012-03-15  |   XYZ
4   |  2012-03-24  |   ABC
5   |  2012-04-10  |   XYZ
6   |  2012-04-11  |   ABC 
```

我需要一份报告，显示给定用户的 COUNT，但在没有记录的月份中显示 0。

```
MTH  |  COUNT
-------------
JAN  |   1
FEB  |   0
MAR  |   2
APR  |   1 
```

我设法让它工作，但没有 0 几个月没有记录。到目前为止，我有这个抛出错误的语法..

```
SELECT Month(CREATED), COUNT(SELECT * FROM SEARCHES WHERE USER = 'XYZ')
FROM SEARCHES
GROUP BY Month(CREATED) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:29:37.487

您无法查询不存在的数据。因此，您需要加入列出（或模拟列出）您想要加入的所有月份的表。如何做到这一点取决于您使用的 rdbms。使用 rownum 生成可以转换为月份的列表是一种常见的方法。或者 Postgres 具有生成系列的功能。顺便说一句，我真的不明白为什么子选择在列子句中而不是将过滤器添加到主查询中。

也可以看看：

[SQL 频率分布查询使用 group-by 计算范围并包括 0 个计数](https://stackoverflow.com/questions/9677321/sql-frequency-distribution-query-to-count-ranges-with-group-by-and-include-0-cou)

[如何生成 sysdate-30 和 sysdate+30 之间的所有日期列表？](https://stackoverflow.com/questions/9166877/how-to-generate-list-of-all-dates-between-sysdate-30-and-sysdate30)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:05:59.120

这是按日期范围分组的一般查询。@startDate 和 @endDate 定义范围；您可以为用户或某个固定范围设置 min(created) 和 max(created)。

CTE 每月范围生成月份表 - 本月的第一天，下个月的第一天。Searches 稍后通过创建左连接到monthlyRanges。请注意，用户在连接中被过滤，因为这是左连接，并且在 where 子句中过滤将有效地将其转换为内连接。

```
declare @startDate datetime
declare @endDate datetime
set @startDate = '2012-01-01'
set @endDate = '2013-01-01'

; with monthlyRange (startMonth, startNextMonth) as (
  select dateadd (m, datediff (m, 0, @startDate), 0),
         dateadd (m, datediff (m, 0, @startDate) + 1, 0)
  union all
  select dateadd (m, 1, startMonth),
         dateadd (m, 1, startNextMonth)
    from monthlyRange
  where startNextMonth <= dateadd (m, datediff (m, 0, @endDate), 0)
)
SELECT Year(monthlyRange.startMonth) Year, 
       Month(monthlyRange.startMonth) Month, 
       COUNT(searches.Created) Count
  FROM monthlyRange 
  left join SEARCHES
    on monthlyRange.startMonth <= Searches.Created
   and monthlyRange.startNextMonth > Searches.Created
   and [USER] = 'XYZ'
GROUP BY Year(monthlyRange.startMonth), Month(monthlyRange.startMonth)
order by 1, 2 
```

[这是用于测试的 Sql Fiddle](http://sqlfiddle.com/#!3/aa46d/7)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:03:27.843

尝试这个：

```
CREATE TABLE #DaTable(
  ID    INT,
  CREATED   DATE,
  USER_ VARCHAR(10)
)
INSERT INTO #DaTable(ID, CREATED, USER_) VALUES
(1  , '2012-01-14', 'XYZ'),
(2   ,  '2012-03-14'  ,   'XYZ'),
(3   ,  '2012-03-15'  ,   'XYZ'),
(4   ,  '2012-03-24'  ,   'ABC'),
(5   ,  '2012-04-10'  ,   'XYZ'),
(6   ,  '2012-04-11'  ,   'ABC')

CREATE TABLE #DaMonths(
  Nr    INT,
  Name  VARCHAR(10)
)
INSERT INTO #DaMonths(Nr, Name) VALUES
(1, 'Jan'),
(2, 'Feb'),
(3, 'Mar'),
(4, 'Apr'),
(5, 'May'),
(6, 'Jun'),
(7, 'Jul'),
(8, 'Aug'),
(9, 'Sep'),
(10, 'Oct'),
(11, 'Nov'),
(12, 'Dec')

SELECT M.Nr, M.Name, COUNT(DT.ID) as Count_
FROM #DaMonths as M
  LEFT OUTER JOIN #DaTable as DT ON
    M.Nr = Month(DT.CREATED)
GROUP BY M.Nr, M.Name
ORDER BY M.Nr 
```

# node.js - Express.js 路由：可选的 splat 参数？

> ID：10020099
> 
> 赞同：86
> 
> 时间：2012-04-04T22:21:49.670
> 
> 标签：node.js, express

我有一条看起来像这样的路线：

```
app.all('/path/:namedParam/*splat?',function(req,res,next){
  if(!req.params.length){
    // do something when there is no splat
  } else {
    // do something with splat
  }
}); 
```

但是，这不起作用-如果我调用`path/foo/bar`它会到达路线，但是如果我调用`path/foo`它，它不会。

是否可以有一个可选的 splat 参数，还是我必须使用正则表达式来检测这个？

**编辑**：

更清楚地说，这是我要达到的要求：

*   第一个和第二个参数是**必需的**
*   第一个参数是静态的，第二个是命名参数。
*   可以附加任意数量的*可选*附加参数，并且仍然可以到达路线。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2015-04-09T21:13:15.060

这适用于 express 4 上的 /path 和 /path/foo，注意`*`之前的`?`.

```
router.get('/path/:id*?', function(req, res, next) {
    res.render('page', { title: req.params.id });
}); 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-01-23T13:42:01.593

我只是遇到了同样的问题并解决了。这是我使用的：

```
 app.get('path/:required/:optional*?', ...) 
```

这应该适用于`path/meow`, `path/meow/voof`, `path/meow/voof/moo/etc`...

似乎通过删除`/`between`?`和`*`，最后一个`/`也成为可选的，而`:optional?`仍然是可选的。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-04-04T22:30:51.720

这会做你所追求的吗？

```
app.all('/path/:namedParam/:optionalParam?',function(req,res,next){
  if(!req.params.optionalParam){
    // do something when there is no optionalParam
  } else {
    // do something with optionalParam
  }
}); 
```

更多关于 Express 的路由在这里，如果你还没有看过：[http ://expressjs.com/guide/routing.html](http://expressjs.com/guide/routing.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-05T19:23:17.803

这是我解决此问题的当前方法，似乎 express 不支持任意数量的带有可选命名参数的 splat 参数：

```
app.all(/\/path\/([^\/]+)\/?(.+)?/,function(req,res,next){
  // Note: this is all hacked together because express does not appear to support optional splats.
  var params = req.params[1] ? [req.params[1]] : [],
      name = req.params[0];
  if(!params.length){
    // do something when there is no splat
  } else {
    // do something with splat
  }
}); 
```

为了可读性和一致性，我很乐意将此使用命名为 params - 如果另一个答案表面允许这样做，我会接受它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-06T08:54:23.787

假设你有这个网址：`/api/readFile/c:/a/a.txt`

如果你想`req.params.path`成为`c:`：

```
'/api/readFile/:path* 
```

如果你想`req.params.path`成为`c:/a/a.txt`：

```
'/api/readFile/:path([^/]*)' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-17T18:14:13.523

上述使用 optional 的解决方案在 Express 4 中不起作用。我尝试了几种使用搜索模式的方法，但也不起作用。然后我找到了这个方法，似乎被无限嵌套路径解雇了，[http ://expressjs.com/api.html#router](http://expressjs.com/api.html#router)

```
// this will only be invoked if the path starts with /bar from the mount point
router.use('/bar', function(req, res, next) {
  // ... maybe some additional /bar logging ...

  // to get the url after bar, you can try
  var filepath = req.originalUrl.replace(req.baseUrl, "");

  next();
}); 
```

它匹配所有 /bar、/bar/z、/bar/a/b/c 等。然后，您可以阅读 req.originalUrl，因为未填充参数，例如。您可以尝试比较 baseUrl 和 originalUrl 以获取剩余路径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-15T04:48:32.720

我通过使用一个中间件的组合来解决这个问题，该中间件在 url 和 中添加尾部斜杠`router.get('/bar/*?', ...`，它将在之后拾取所有内容`/bar/`，`undefined`如果它只是`/bar/`. 如果访问者要求`/bar`，`express-slash`中间件将在请求中添加一个斜线并将请求转换为`/bar/`.

# java - 实现只有一个消费者和一个生产者的并发队列的绝对最快方法是什么？

> ID：10020101
> 
> 赞同：3
> 
> 时间：2012-04-04T22:21:54.977
> 
> 标签：java, multithreading, optimization, concurrency, real-time

`java.util.concurrent.ConcurrentLinkedQueue`想到了，但对于这种双线程场景来说，它真的是最优的吗？我正在寻找双方（生产者和消费者）可能的最小延迟。如果队列为空，您可以立即返回 null，如果队列已满，您可以立即丢弃您提供的条目。

ConcurrentLinkedQueue 是否使用超快速和轻量级的锁（AtomicBoolean）？有没有人对 ConcurrentLinkedQueue 进行基准测试或知道最终最快的方法？

**附加细节：**我想队列应该是一个公平的队列，这意味着消费者不应该让消费者等待超过它需要的时间（通过提前运行它），反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:31:02.930

对于我所知道的 Java 中的最低延迟，您可以使用 LMAX 开发的 Disruptor 模式。

基本上，他们正在减少所有延迟，这意味着许多相当独特的解决方案可以解决已确定的问题。例如，它们尽可能多地预分配并重用对象（以防止垃圾收集增加额外的延迟）。

他们的解决方案基于内存屏障，可防止代码表单越过某些检查点的乱序执行。通过这样做，他们可以确保一个生产者线程和多个消费者线程之间的正确同步。

[这是描述问题和 LMAX 解决方案的白皮书](http://disruptor.googlecode.com/files/Disruptor-1.0.pdf)，[以及最近的 youtube 视频](http://www.youtube.com/watch?v=DCdGlxBbKU4)，解释了解决方案的基本原理和设计细节。它需要大量的代码重组才能使用，但它目前是城里最快、最低延迟的东西。

# azure - 如何在现实生活场景中使用消息队列？

> ID：10020102
> 
> 赞同：8
> 
> 时间：2012-04-04T22:21:55.383
> 
> 标签：azure, message-queue, messaging, azure-queues

好的，所以我对消息队列感兴趣。我真的已经对这个主题进行了大量研究。我阅读了“programming windows azure”（关于 Azure 队列），阅读了大量有关 Azure 服务总线的教程和信息，还观看了有关消息传递模式的第 9 频道视频等。

但我只是不明白：在现实生活场景中如何使用它？所有示例都只是将单个字符串或带有一些数据的对象放入队列中，然后从“另一端”的队列中读取它。但是你怎么知道如何处理这些数据？例如：我可以尝试将一个客户、一个订单和一个地址保存到数据库中，所以我将这 3 个对象放在一个队列中以读取另一端并将它们放入我的数据库中。我怎么知道如何处理这些对象？

我有一些问题：

1.  将什么样的数据放入队列中。可能是一个命令，它在读取时执行，所以队列中的所有内容都具有相同的接口，并且对象本身知道要做什么？
2.  在哪一层之间使用队列？我正在考虑将内容放入服务层的队列中（在验证之后）并在数据访问层中读取它，以便将其放入数据库中。
3.  一个人应该排多少队？你想连接的层之间只有一个队列，或者它们之间有多个队列（可能出于不同的目的，虽然我想不出任何）？
4.  这种松散耦合形式允许我们对请求进行排队，以便稍后处理它们（例如：当我们想重新启动数据库时）。这很酷，但是如果我想读取数据而不是写入数据怎么办？那么数据库应该是在线的。我应该通过队列读取数据，还是我的服务层可以从数据访问层提取数据并将其传递给表示层？

我认为这是我脑海中嗡嗡作响的大部分问题。我希望任何人都可以为我解决这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T22:34:22.997

在最简单的示例中，假设您将要执行的操作序列化到队列中，然后是参数的序列化版本：

问：`Delete: User 5`

这很好，因为您的 Worker Role 可以阅读并采取相应的行动。在这个例子中似乎不是一个很大的好处，因为排队可能需要和删除一样长的时间，但是如果你想对所有用户执行 BI 怎么办？在等待同步请求进行处理时，您的网页或应用程序永远不会刷新。但是，如果您将该请求推送到队列中：

问：`RunSome2HourProcess: User *`

现在您可以返回您已将操作排队，然后继续您愉快的方式，而从队列中拉出的服务器将能够在闲暇时处理。

更重要的是，这可以实现更好的规模场景。如果最后一条消息被拆分怎么办？因此，您没有做所有用户，而是做了类似的事情：

问`RunSome2HourProcess: User A*-M*`

问`RunSome2HourProcess: User N*-Z*`

两个 azure worker 角色将分担负载并并行处理您的信息。

还有一些围绕重试、工作流、跨角色异步通信等的场景，但这应该为您提供一些理由，说明为什么在正确的场景中排队可以很好。

因此，在这些示例中： 1\. 我们将操作和标识符/查询放入队列项中。从队列中轮询的工作者角色将知道如何处理它。

1.  您可以在服务层和处理层之间使用队列。您可以在处理层之间使用队列。您可以在同一层中使用队列。天空是极限

2.  我通常为每个操作创建 1 个队列。所以在上面的例子中，我有 Run2HourProcess 队列，只需将参数写入它。并为任何其他进程类型创建一个新队列。但它们非常灵活，所以这取决于开发人员。

3.  除非它是长时间运行的读取（即示例中的缩略图生成示例或数据处理速度慢的结果），否则您访问数据库的速度也一样快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:12:30.693

1.  嗯，你可以放任何你想要的东西。这只是一个消息，所以无论你的层同意什么都会起作用。我们会在消息中注明何时应发送电子邮件、何时需要处理视频等。
2.  我不一定会考虑层之间的排队，就像在面向用户的实时进程（例如，Web 服务器）和后台处理之间排队一样。使用排队来做您不希望您的 Web 角色在用户等待时花时间做的事情。
3.  你可以随心所欲地制作，真的。如果队列消息有一个字段说明它们的含义，那么您可以假设将所有内容放在一个队列中，尽管我不一定建议这样做。我们有大约六个队列：一个用于发送通知，一个用于视频处理，一个用于报告生成请求等。
4.  我绝对不会使用队列作为数据存储和检索。这只是该工作的错误工具，例如尝试使用 TCP 存储数据。

请注意，单个工作实例（即 VM）可以读取任意数量的队列。您只需要以这种方式编写代码。如果您有很多没有看到太多流量的队列，那么这是降低成本的合理方法。另一种选择是将几种消息类型组合到一个队列中。这样，您只有一个地方可以查找消息。

或者，您可以让许多工作人员从同一个队列中读取，以便将工作平均分配给他们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:42:22.300

除了 Rob 提到的之外，消息队列还用于处理突发流量，这些流量可以等待（在队列中）直到有空闲的 worker 可用。

我相信 Azure 服务总线、队列和主题在幕后利用消息队列来完成同样的任务。我还看到 AppFabric 托管的 Workflow Foundation 也可能会这样做的提示。

# ios - 使我的 iOS 应用程序的用户能够发布到 Craigslist

> ID：10020104
> 
> 赞同：4
> 
> 时间：2012-04-04T22:22:02.300
> 
> 标签：ios, craigslist

这个问题与以下问题非常相似：

[是否可以通过我自己的网站在 Craigslist 上发帖？](https://stackoverflow.com/questions/7329478/is-it-possible-to-making-a-posting-to-craigslist-through-my-own-website)

我想做的是允许用户通过我自己的 iOS 应用程序向 Craiglist 发布帖子（也许使用 PHP curl？）。这不是一个自动发布系统，我只是希望用户能够通过我的应用程序发布到 Craigslist。如果允许用户上传图像，我什至会很乐意在我的应用程序中显示实际的 craigslist 站点（而不是构建自定义视图）。如果您尝试使用 iPhone 或 iPad 上的网络浏览器创建 craigslist 发布，它不会让您上传图像。有办法解决吗？

我已经阅读了有关 Craiglickr 工具的信息，尽管我找不到任何有关如何使用它的示例或文档。我不拘泥于 PHP curl 或 Craiglickr 工具，我有兴趣了解任何允许用户通过 iOS 应用程序发布到 Craigslist 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-23T11:51:16.687

不幸的是，无法通过您的应用向 Craigslist 发布内容。如果您愿意，您可以显示他们的网站`UIWebView`，但用户将无法上传照片。如果你真的想，你可以弄清楚网站是如何上传照片的，然后使用图像选择器让他们选择一张照片，将其转换为`NSData`，然后伪装成 Craigslist 上传到服务器 - 这是有风险的，因为如果他们改变了他们网站的工作方式，您的应用程序将停止工作，因此我不推荐该选项。

# objective-c - Objective C，鼠标事件方法放在哪里？

> ID：10020106
> 
> 赞同：0
> 
> 时间：2012-04-04T22:22:14.603
> 
> 标签：objective-c, cocoa, window, osx-lion, mouseevent

我正在创建我的第一个应用程序，并且我有一个由视图和窗口的多个子类组成的窗口。我有一个 NSWindowController 类、一个 NSWindow 子类和三个 NSView 子类来创建一个窗口。除了我需要使用鼠标事件但我不知道把它放在哪里之外，一切都运行良好并且看起来很完美。其实我试过把它放在每个类文件中，它仍然不起作用..

我想要做的是使我现有的窗口（它总是在顶部）在鼠标退出窗口时变为透明（不是完全透明但部分透明，我知道如何设置它），并且仅在鼠标退出窗口时变得不透明鼠标已进入窗口或当窗口成为关键窗口时。

以下是可能有助于理解发生了什么的代码部分：（我更改了一些变量和类名）

* * *

**应用代表**：

```
#import "AppDelegate.h"
#import "MainWindowController.h"

@implementation AppDelegate

@synthesize window = _window;

-(IBAction)showMainWindow:(id)sender
{
    mainWindowController = [[MainWindowController alloc] init];
    mainWindow = [mainWindowController window];
    [mainWindow makeKeyAndOrderFront:sender];
    [NSApp activateIgnoringOtherApps:YES];
}

..... 
```

* * *

**主窗口控制器**：

```
#import "MainWindowController.h"

-(id) init {
    self = [super initWithWindowNibName:@"MainWindow"];
    return self;
}

.....

// These don't work
-(void)mouseExited:(NSEvent *)theEvent
{
    if ([self.window level] == NSFloatingWindowLevel && ![self.window isKeyWindow]) {
        [self.window setOpaque:NO];
    }
}

-(void)mouseEntered:(NSEvent *)theEvent
{
    if ([self.window level] == NSFloatingWindowLevel) {
        [self.window setOpaque:YES];
    }
}

..... 
```

* * *

然后我只有三个 NSView 类和一个 NSWindow 子类来制作一个带有颜色的圆形矩形窗口。我应该修改/添加什么/在哪里获得我想要的结果？

我也尝试添加 [window setAcceptsMouseMovedEvents:YES] 但仍然没有工作。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:52:42.077

-mouseExited: 和 -mouseEntered: 方法应该放在 NSView 子类中。在视图中使用 NSTrackingArea(s) 来通知鼠标进入、移动和退出事件。有关详细信息，请参阅[NSTrackingArea 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSTrackingArea_class/Reference/Reference.html)。

# c++ - 从 COM PORT C++ 接收 NMEA0183 数据

> ID：10020112
> 
> 赞同：3
> 
> 时间：2012-04-04T22:22:46.403
> 
> 标签：c++, gps, nmea

大家好！

我用简单的 C++ 编写了一个小型 gps 应用程序，切换协议，向 gps 芯片发送命令......等等。对 GPS 端口的写入运行良好。但是当我尝试读取端口（检查接受的命令）时，我收到了很多愚蠢的字符。通常 NMEA 输出消息是这样的：

```
$GPGLL,4916.45,N,12311.12,W,225444,A 
```

我收到了类似的：

```
1C0CFC14 
```

我不知道出了什么问题...我的这部分代码是下一个：

```
LPCVOID buffer[100];
ReadFile(hSerial, buffer, 100, 0, 0); 
```

或者另一个用于记录一些数据：

```
LPCVOID buffer[100];
ReadFile(hSerial, buffer, 100, 0, 0);
ofstream log ("log.txt");
log << buffer;
log.close(); 
```

当然，Hserial 是在之前声明过的，并且它对写入很有用。当我声明 HANDLE 时，我也打开了 hSerial 文件进行读写。目标平台是 Windows Mobile 5.0 和 6.0。怎么了？非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:48:47.193

从 GPS 端口读取数据或从端口读取任何其他数据并不是一件简单的事情。

在尝试读取之前，您需要确保有一些数据在等待，并且 COM 端口没有任何先前的错误。然后，如果读取成功，则需要确保数据正确终止并包含完整的 NMEA 语句。有时你可能会读到下一个 NMEA 句子的开头，甚至是几个背靠背的句子，所以你必须处理它。

让我们把这一切留到另一天，专注于阅读本身。

ReadFile 的第四个参数应该是一个指向 DWORD 的指针，它将存储实际读取的字节数。您应该使用它，以确保您获得了一些真实数据。您还应该检查返回值是否有错误。

在检查确实有一些数据等待读取之后，我就是这样做的。

```
/**

  Read data from port

  @param[in] buffer pointer to location to store data
  @param[in] limit  maximum number of bytes to read

  @return  0 if error

*/
int cSerial::ReadData( void *buffer, int limit )
{

    if( !m_bOpened || m_hIDComDev == NULL ) return( 0 );

    BOOL bReadStatus;
    DWORD dwBytesRead, dwErrorFlags;
    COMSTAT ComStat;

    ClearCommError( m_hIDComDev, &dwErrorFlags, &ComStat );
    if( !ComStat.cbInQue ) return( 0 );

    dwBytesRead = (DWORD) ComStat.cbInQue;
    if( limit < (int) dwBytesRead ) dwBytesRead = (DWORD) limit;

    bReadStatus = ReadFile( m_hIDComDev, buffer, dwBytesRead, &dwBytesRead, &m_OverlappedRead );
    if( !bReadStatus ){
        if( ::GetLastError() == ERROR_IO_PENDING ){
            WaitForSingleObject( m_OverlappedRead.hEvent, 2000 );
            return( (int) dwBytesRead );
            }
        return( 0 );
        }

    return( (int) dwBytesRead );

} 
```

看起来一切都非常复杂，但是上面代码中的所有内容都被证明是必要的。没有它，您的应用程序可能会运行一段时间，但有时它会挂起或出现乱码。您可以保留其中一些检查，但随后您将不得不花费大量时间来调试您的应用程序出了什么问题——就像我在开发这段代码时所做的那样。

# text - 多行标签/文本视图中行高的 xib 控件

> ID：10020118
> 
> 赞同：0
> 
> 时间：2012-04-04T22:23:26.330
> 
> 标签：text, label, xib, css

如何在 xib 中编辑行高（如在多行标签或文本视图中的文本行的距离）？我正在 xib 工具集中寻找一些东西，但我开始相信它只能通过直接在代码中指定它来完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T07:10:24.417

没有用于调整行高的参数，但请查看建议子类化或使用第 3 方库的[设置 UILabel 行间距。](https://stackoverflow.com/questions/3880526/how-to-increase-a-space-between-two-lines-in-multiline-label)`UILabel`

# c# - Windows应用程序中的C#存款/取款按钮？

> ID：10020122
> 
> 赞同：0
> 
> 时间：2012-04-04T22:23:45.007
> 
> 标签：c#

好的，我有一个学校作业。该程序是一个有两个选项卡的 GUI。在第一个选项卡上有四个文本框，分别代表姓名、身份证、年龄和帐户余额。此选项卡上还有一个按钮，可将帐户添加到第二个选项卡上的组合框中。在第二个选项卡上，有名称、id、年龄和余额的组合框和四个文本框。当我从组合框中选择一个名称时，四个文本框会自动填写其信息。我遇到的问题是我必须有一个提款和一个存款按钮，用户可以输入一个金额并将其减去或添加到文本框中的余额中。有谁知道如何做到这一点？如果您想查看代码，请告诉我。

```
 class BankAccount
    {
        //attributes
        public string accountID;
        public string customerName;
        public int customerAge;
        public double balance;
        public const double DEFAULT_BALANCE = 500.00;

    //construct
    public BankAccount()
    {
    }

    public BankAccount(string anID, string aName, int anAge, double aBalance)
    {
        accountID = anID;
        customerName = aName;
        customerAge = anAge;
        balance = aBalance;
        if (aBalance == 0)
        {
            balance = DEFAULT_BALANCE;
        }
        else
        {
            balance = aBalance;
        }
    }

    public BankAccount(string anID, string aName, int anAge)
    {
        accountID = anID;
        customerName = aName;
        customerAge = anAge;
        balance = DEFAULT_BALANCE;
    }

     //accessors
    public void SetID(string anID)
    {
        accountID = anID;
    }

    public void SetName(string aName)
    {
        customerName = aName;
    }

    public void SetAge(int anAge)
    {
        customerAge = anAge;
    }

    public void SetBalance(double aBalance)
    {
        balance = aBalance;
    }

    public string GetID()
    {
        return accountID;
    }

    public string GetName()
    {
        return customerName;
    }

    public int GetAge()
    {
        return customerAge;
    }

    public double GetBalance()
    {
        return balance;
    } 
```

这是表格

```
public partial class Form1 : Form
    {

    //ArrayList account = new ArrayList();
    private List<BankAccount> account = new List<BankAccount>();

    public Form1()
    {
        InitializeComponent();
    }

    private void btnAddAccount_Click(object sender, EventArgs e)
    {
        BankAccount aBankAccount = new BankAccount(txtAccountID.Text, txtName.Text,
            int.Parse(txtAge.Text), double.Parse(txtBalance.Text));

        account.Add(aBankAccount);
        AddToComboBox();
        ClearText();

    }

    private void AddToComboBox()
    {
        cboAccount.Items.Clear();
        foreach (BankAccount person in account)
        {
            cboAccount.Items.Add(person.GetName());
            //cboAccount.Items.Add(person);               

        }

    }
    private void ClearText()
    {
        txtName.Clear();
        txtAccountID.Clear();
        txtBalance.Clear();
        txtAge.Clear();
        txtAccountID.Focus();

    }

    private void cboAccount_SelectedIndexChanged(object sender, EventArgs e)
    {

        //txtNameTab2.Text = cboAccount.SelectedItem.ToString();
        txtNameTab2.Text = account[cboAccount.SelectedIndex].customerName;
        txtAgeTab2.Text = account[cboAccount.SelectedIndex].customerAge.ToString();
        txtAccountIDTab2.Text = account[cboAccount.SelectedIndex].accountID.ToString();
        txtBalanceTab2.Text = account[cboAccount.SelectedIndex].balance.ToString();

    }

    private void btnWithdraw_Click(object sender, EventArgs e)
    {

    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:35:59.527

如果您使用如下对象代表您的帐户：

```
public class Account{

    public int Id { get; set; }

    public string Name { get; set; }

    public int Age { get; set; }

    public Decimal Balance { get; set; }

} 
```

然后考虑提款将涉及从余额中取出资金，而存款将涉及增加余额。您可以通过以下方式表示：

```
public class Account{

    public int Id { get; set; }

    public string Name { get; set; }

    public int Age { get; set; }

    public Decimal Balance { get; set; }

    public Decimal DepositMoney(Decimal amount)
    {
        Balance+=amount;
        return Balance;
    }

    public Decimal WithdrawMoney(Decimal amount)
    {
        Decimal moneyAfterWithdrawal = Balance-amount;

        if(moneyAfterWithdrawal >= 0)
        {
           Balance = moneyAfterWithdrawal;
           return Balance;
        }

        throw new Exception(String.Format("Withdrawing {0} would leave you overdrawn!", amount.ToString());

    }

} 
```

然后，您可以根据文本框中的值和您单击的按钮，根据需要调用 DepositMoney 和 WithdrawMoney。类似的函数`Decimal.TryParse`在将输入字符串转换为所需类型时很有用，您可能还想在存款或取款后更新屏幕上的余额状态。

在您的示例中，您需要一种 Double 类型来表示余额 - 在我的示例中只需将 Decimal 替换为 Double。

**编辑**：

好的，让我们看一下您的事件处理程序之一，btnWithdraw_Click：

```
private void btnWithdraw_Click(object sender, EventArgs e) 
{ 
    //First, it is necessary to get the amount to be withdrawn
    //Am assuming this is in a textbox, which I'll call txtAmount

    double amount = 0;

    //Check is a valid double
    if(Double.TryParse(txtAmount.Text, out amount))
    {
       //Lets ignore negative amounts as they are technically a deposit ;-)
       if(amount > 0)
       {
            BankAccount currentAccount = account[cboAccount.SelectedIndex];

            double currentBalance = currentAccount.GetBalance();

            double amountLeft = currentBalance - amount;

            if(amountLeft >= 0)
            {

                currentAccount.SetBalance(amountLeft);
                txtBalanceTab2.Text = amountLeft.ToString("D2");
            }
            else
            {
                //Warn user they would go overdrawn
            }

       }

    }

} 
```

但是请注意，我相信 Withdraw 和 Deposit 方法属于帐户本身，因为它们会更改类的状态，就像在我的 Account 示例中一样。保持这种逻辑的最佳位置是类本身。

我把押金留给读者练习；-)

# backbone.js - Backbone.js 获取更复杂的数据并用作集合

> ID：10020123
> 
> 赞同：13
> 
> 时间：2012-04-04T22:23:50.707
> 
> 标签：backbone.js

假设我有这样的 json 设置：

```
{
  page:1,   
  items:[
    {  
      name: 'item1', 
      id:1
    }, 
    {
      name: 'item1', 
      id:2
    }, 
    {
      name: 'item1', 
      id:3
    }
  ] 
} 
```

和这样的建模：

```
var Item = Backbone.Model.extend({
    defaults: {name:  "No name"}
});

var ItemCollection = Backbone.Collection.extend({
    model: Item,
    url: '/some/ajax/url',
}); 
```

获取此 json 后，如何将项目集映射为 ItemCollection 的集合并将页码作为属性添加到集合中？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-05T10:53:09.503

正如@asawyer 提到的，您必须重写 parse 方法，但您不需要实际实例化每个项目，如果您返回项目数组，Backbone 可以为您执行此操作。

请参阅[collection.parse的文档](http://documentcloud.github.com/backbone/#Collection-parse)

> **解析** `collection.parse(response)`
> 
> 每当服务器返回集合的模型时，Backbone 都会在 fetch 中调用 parse。该函数传递原始响应对象，并应*返回要添加*到集合中的模型属性数组。

你的代码可以写成

```
var ItemCollection = Backbone.Collection.extend({
    model: Item,
    url: '/some/ajax/url',

    parse: function(data) {
        this.page=data.page;
        return data.items;
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:37:53.253

您需要覆盖[解析](http://documentcloud.github.com/backbone/#Collection-parse)

它最终会看起来像这样：

```
class Item extends Backbone.Model
    defaults:
        name: "No name"

class ItemCollection extends Backbone.Collection
    model: Item
    url: '/some/ajax/url'
    parse: (data) ->
        items = []
        _.each data, (item) ->
            newItem = new Item
                id: item.id
                name: item.name
            items.push newitem
        items 
```

（Coffeescript，但很容易转换为直接的 javascript）

您的另一个选择是在以下位置找到的关系插件：

[https://github.com/PaulUithol/Backbone-relational](https://github.com/PaulUithol/Backbone-relational)

我从来没有使用过它，但我认为它应该为你做解析映射的东西。

# objective-c - Objective C如何通过多个视图添加到整数

> ID：10020125
> 
> 赞同：0
> 
> 时间：2012-04-04T22:24:06.507
> 
> 标签：objective-c

我真的很挣扎，我知道这很容易，但我只是没有让它发挥作用。

我对 Obj-C 很陌生...

基本上，这个应用程序非常简单。

它堆积在模态视图控制器上，一个在另一个之上，直到用户得到结果的最后，然后它们都被关闭，用户可以重新开始。

例如，在每个模态视图控制器中，我想将 1 添加到我在第一个屏幕中声明的 int 中。

这是第一个视图 controller.h 中的声明

```
int total; 
```

这就是我在第二个视图 controller.m 中所做的

```
FirstViewController *fvc = [[FirstViewController alloc] init];
[fvc setTotal:1]; //or the following, i can't see what the difference is
fvc.total = 1; 
```

这似乎起到了作用，它设置了我在另一个视图中声明的变量。

但是，在第三个视图 controller.m 中，我这样做：

```
FirstViewController *fvc = [[FirstViewController alloc] init];
NSLog(@"Current total: %x", fvc.total); 
```

这有效，因为我没有收到错误，但整数已重置为 0。理想情况下，它会说“1”，以表明它保留了该值...

我的问题是；如何在整个应用程序中重用和添加到这个整数？

也请提供与字符串相关的答案，因为我也想这样做。

对不起，我还在学习。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:30:16.997

每当您使用 alloc 时，您都在创建一个新对象。您的新对象**通常**不知道您之前对另一个对象做了什么，因为它是同一类型的对象。

一般的策略是：当你创建你的第二个视图控制器时，给它一个对你现有 fvc 的引用，当你创建你的第三个视图控制器时，给它同样的引用。

（更好的办法是将您的共享数据放在它自己的对象中并传递它，但让我们首先控制对象寿命的理论。:-)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T22:34:45.703

如果将变量定义为静态变量，它会在不同的实例中保留其值。你可以在你的课堂上这样做：

```
@interface FirstViewController : UIViewController

- (NSInteger)sharedValue;
- (void)setSharedValue:(NSInteger)value;

@end

@implementation FirstViewController

static NSInteger sharedValue = 0;

- (NSInteger)sharedValue
{
    return sharedValue;
}

- (void)setSharedValue:(NSInteger)value
{
    sharedValue = value;
}

@end 
```

现在，您创建的任何 FirstViewController 实例都将共享 sharedValue 的相同副本，如果您将其设置在一个实例上，然后从另一个实例中获取它，它将按照您想要的方式工作。相同的过程适用于字符串等，但如果您不使用 ARC，请注意保留和释放 sharedValue。

比在类上创建多个静态值更好的方法是创建一个共享类，您可以在该类上设置和获取多个属性。这些共享类有时被称为“单例”，因为它们是具有单个实例的类。

您可以看到 Apple 使用单例的许多地方，例如 [UIApplication sharedApplication]、[NSNotificationCenter defaultCenter]、[NSUserDefaults standardUserDefaults] - 这些都是在整个应用程序中重用单个实例的类的示例。

要创建单例，请创建一个类型为 NSObject 的新类，如下所示。然后，您可以添加您想要的任何属性，并通过 sharedInstance 在应用程序的任何位置访问它们：

```
@interface MyObject : NSObject

@property (nonatomic, assign) NSInteger someInteger;
@property (nonatomic, strong) NSString *someString;

+ (MyObject *)sharedInstance;

@end

@implementation MyObject

@synthesize someInteger, someString;

+ (MyObject *)sharedInstance
{
    static MyObject *sharedInstance = nil;
    if (sharedInstance == nil)
    {
        sharedInstance = [[self alloc] init];
    }
    return sharedInstance;
}

@end 
```

您现在可以通过说在应用程序的任何位置访问共享属性

```
[MyObject sharedInstance].someInteger = 5;

...

NSInteger value = [MyObject sharedInstance].someInteger; 
```

这绝对是在您的应用程序中存储全局数据的最佳方式。

# javascript - 使用 for 循环调用 setTimeout

> ID：10020127
> 
> 赞同：3
> 
> 时间：2012-04-04T22:24:19.210
> 
> 标签：javascript

我写了一个改变 div 的 css 定位的函数

我已经成功地使用 setTimeout 以特定的时间间隔调用该函数

现在我要做的是在同一页面上的 28 个不同的 div 上调用该函数，每个 div 都有自己的速度。

我的想法是我可以用这样的 for 循环来做到这一点：

```
for (var x = 0; x < 28; x++)
   { setInterval(function(){changeDirection(divlist[x])}, divs[divlist[x]].speed);} 
```

使用存储速度和 ID 的对象“divs”

我能让他们全部反对计时器的唯一方法就是像这样调用 setInterval 28次......

```
setInterval(function(){changeDirection(divlist[1])}, divs[divlist[1]].speed);
setInterval(function(){changeDirection(divlist[2])}, divs[divlist[2]].speed);
setInterval(function(){changeDirection(divlist[3])}, divs[divlist[3]].speed);
setInterval(function(){changeDirection(divlist[4])}, divs[divlist[4]].speed);....etc 
```

for 循环不起作用...

有谁知道为什么？有没有办法用这样的循环在许多不同的函数上调用 setInterval

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:27:15.630

您需要“锚定”循环迭代器的值，否则它会不断增加，并且所有间隔都会影响不存在的第 29 个间隔。

```
for(var x=0; x<28; x++) {
    (function(x) {
        // code goes here
    })(x);
} 
```

但是，一页上有 28 个计时器是一个非常糟糕的主意。考虑重写您的代码，以便您只有一个间隔来根据速度值计算新位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:35:02.093

我对这些自调用函数的方法。

```
var i = -1;
(function cssPositioning() {
  i++;
  if ( i < 28 ) {
            changeDirection(divlist[i]);
    setInterval(cssPositioning, divs[divlist[i]].speed);
  }
})(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:55:00.717

根据@Kolink 的解释，你可以试试

```
for (var x = 0; x < 28; x++){ 
   setInterval(function(){
     var local = x;  //anchor the variable  
     changeDirection(divlist[local])}, divs[divlist[local]].speed);
   });
} 
```

希望这可以帮助。

# javascript - 使用dojo/javascript触发点击事件？

> ID：10020128
> 
> 赞同：2
> 
> 时间：2012-04-04T22:24:40.593
> 
> 标签：javascript, dojo

我一直在使用 javascript 并做了类似的事情

```
​var div = document.getElementById("bob");
div.addEventListener("click", function(){alert('foo');});​​​​​​​​​​​

// all tests fail    
//div.click();
//div.onclick();
//div.onClick();

var div2 = document.getElementById("adam");
// works
//div2.onclick();

var div3 = document.getElementById("iris");
div3.onclick = function(){alert('wat');};
// works
//div3.onclick();

//How do I trigger the div (the first div, "bob") "click" event? 
```

代码在这里：http: [//jsfiddle.net/TVrfF/](http://jsfiddle.net/TVrfF/)，取消注释测试用例

那么如何使用dojo或纯javascript通过addEventListener（例如div“bob”）触发点击事件设置？

另外，由于我遇到的这个问题，我应该从现在开始放弃使用 addEventListener 并只使用 element.onclick = function(){} 吗？addEventListener 的优点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:35:00.033

尝试这个：

```
div.dispatchEvent("click"); 
```

此处的文档：

[https://developer.mozilla.org/en/DOM/element.dispatchEvent](https://developer.mozilla.org/en/DOM/element.dispatchEvent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T10:58:30.450

您是否有理由需要通过模拟点击而不是直接调用函数来调用函数？

```
var fnDoWork = function() {
    alert('do work');
}

var div = document.getElementById("bob");
dojo.connect(div, "onclick", fnDoWork);​​​​​​​​​​​

// some other code
fnDoWork(); 
```

您确实失去的是没有为您提供单击鼠标坐标的事件。大多数时候，这应该没什么大不了的。我只在使用 SVG 时才需要这些。

# c# - C# SVG（使用 device-cmyk() 或 icc-color()）到 PDF 转换

> ID：10020131
> 
> 赞同：2
> 
> 时间：2012-04-04T22:25:03.570
> 
> 标签：c#, pdf, svg

我正在尝试执行我认为是一项简单的任务。将 SVG 转换为 PDF。

唯一的规定是转换器需要使用 SVG 中指定的 device-color() 值或 icc-color() 值。

我已经搜索并搜索了没有运气的解决方案。我找到的解决方案将使用 SVG 的 sRGB 值而不是 cmyk 值进行转换。

我研究过 Batik、Inkscape、Scribus、IText 和 Cairo。

****更新*** *****

 **altSoft XML2PDF 看起来很有希望。他们的技术支持很好，他们说他们的新版本有这个功能。我们会看到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T17:56:00.390

我终于用 altsoft XML2PDF 的商业解决方案来解决这个问题。我们与他们的开发团队合作，并将此功能与许多其他功能集成在一起

[http://www.alt-soft.com/](http://www.alt-soft.com/)

感谢 Evgeny 和 alt-soft.com 的团队**

# php - 在我的购物车应用程序中跟踪访问者？

> ID：10020132
> 
> 赞同：0
> 
> 时间：2012-04-04T22:25:07.390
> 
> 标签：php

我正在编写一个简单的购物车应用程序并且遇到了障碍。目前，我的购物车应用程序将购物车（在数据库中）与网站上的用户 ID 相关联，但我也希望允许访问者将商品添加到购物车中。

不久前我在 stackoverflow 上问过这个问题，我得到的一个答案是“使用会话”。但是，在阅读了有关会话的内容后，似乎会话变量在用户关闭浏览器时被破坏，除此之外，它们可以持续多长时间是有时间限制的。此外，我读到有很多会话变量会“阻塞”服务器。

所以现在我回到第一方。我是否应该使用会话变量来跟踪想要将东西添加到购物车的访客（我希望访客购物车在几周内可供他们使用）？我也想过使用他们的 IP 地址，但我知道这取决于他们连接到互联网的位置（如果使用笔记本电脑）。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:27:57.673

您还可以使用保留一定数量的 cookie（如果用户允许接受 cookie）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:32:02.493

读完这篇文章，我可以想到一件事，用户身份验证，这样无论他们从哪里登录，都可以显示他们使用他们用来登录的电子邮件地址浏览过的项目。所以基本上你有一个带有字段的表`user_email`，并且每当他们浏览一个项目时`browsed_item_id`，`timestamp`你在该表中插入一个带有他们的电子邮件、项目 ID 和时间戳的新行，并且在你的 php 代码中你可以检查每次访问是否有任何用户的时间戳是比让我们说两周早，如果是你从数据库中删除它们。如果您需要进一步解释，请告诉我，我已经做过几次并且熟悉这个概念。

# performance - 中型阵列的互相关

> ID：10020138
> 
> 赞同：3
> 
> 时间：2012-04-04T22:25:25.637
> 
> 标签：performance, numpy, cross-correlation

我有 16 个一维数组，每个数组大约有 10-11 百万个双精度元素。我需要在它们之间执行互相关，即 1 与 2、1 与 3、...、1 与 16、2 与 3、2 与 4、...、2 与 16，等等。这在我的 MacBook Intel Core 2 duo 2.4 GHz 和 4GB RAM 上无法有效完成。我的问题是，如果不是人们用来克服这个问题或类似问题的蛮力（更快的处理器，更多的 RAM），那么典型的方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:43:56.470

如果您计算每个数组的傅立叶变换，您应该能够使用变换后的数组来有效地计算每对原始输入数组之间的[互相关。](http://en.wikipedia.org/wiki/Cross-correlation)请参阅我链接到的 Wikipedia 文章的“属性”部分，以了解要使用的身份。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T20:51:42.923

numpy 中的互相关函数非常慢。openCV 库有一个 numpy 友好的互相关函数可用。即使您尝试实现频域方法，也不会击败 openCV 库，因为有更多技巧可用于加速互相关计算。我之前发过这个：

[计算互相关函数？](https://stackoverflow.com/questions/6991471/computing-cross-correlation-function/7588117#7588117)

我相信代码是基于以下论文中详述的技巧：

JP Lewis，“快速模板匹配”，视觉界面，1995 年，第一卷。95，第 120-123 页。

# magento - Magento Adminhtml 包/主题（否）后备

> ID：10020139
> 
> 赞同：0
> 
> 时间：2012-04-04T22:25:32.820
> 
> 标签：magento, themes, package, fallback, adminhtml

有什么方法可以轻松**激活**关于自定义**管理主题****的回退层次机制**，因为它已经存在于前端区域？

 **目前尚不清楚用于“前端”区域的**Mage_Core_Model_Design_Package**类在何处以及如何实例化，我只是想知道我们是否可以重写和扩展它以使其也适用于后端。

目前，将 adminhtml/default/default/ 文件（用于设计和皮肤文件夹）复制到 adminhtml/package_name/theme_name 然后处理这些复制的文件并不是一种超级干净的方式，并且可能会因多个包而变得复杂和/或主题，与默认/默认相比，每个都只带来一些小的变化或改进。我认为它应该回退。

想法，有人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T13:57:14.043

Mage_Core_Model_Design_Package::_fallback 中有一个错误。它也使用基本包作为 adminhtml 区域的后备包。相反，它应该使用默认包，因为 adminhtml 不存在基本包。您可以为设计包模型创建重写并修改 _fallback() 函数：

```
 protected function _fallback($file, array &$params, array $fallbackScheme = array(array()))    
        ...
        $params['_package'] = self::BASE_PACKAGE;
        // otherwise no admin packages with fallback to default package possible
        if ($this->_area == 'adminhtml') {
            $params['_package'] = self::DEFAULT_PACKAGE;
        }
        ...
   } 
```

另一种解决方案是简单地将文件夹 app/design/adminhtml/default 重命名为 app/design/adminhtml/base。但是我不知道如果您要更新到更新的 magento 版本会发生什么。**

# bash - EOFD 是什么意思？

> ID：10020145
> 
> 赞同：4
> 
> 时间：2012-04-04T22:26:00.327
> 
> 标签：bash, definition, acronym

在浏览 SO 时，我有时会看到 EOFD，例如：

```
ftp -vn <$hostname> <<EOFD 
```

是的，我试过谷歌但没有运气，以防万一你想知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T22:48:56.880

[在您引用的问题](https://stackoverflow.com/q/10013151/85950)的上下文中，`EOFD`并不意味着什么特别，它只是 bash [here document](http://tldp.org/LDP/abs/html/here-docs.html)的开始。

来自[高级 Bash 脚本指南](http://tldp.org/LDP/abs/html/here-docs.html)：

> 这里的*文档*是一个特殊用途的代码块。它使用一种 I/O 重定向形式将命令列表提供给交互式程序或命令，例如 ftp、cat 或 ex 文本编辑器。
> 
> ```
> COMMAND <<InputComesFromHERE
> ...
> ...
> ...
> InputComesFromHERE 
> ```
> 
> *限制字符串*描述（框架）命令列表。特殊符号`<<`位于限制字符串之前。这具有将命令块的输出重定向到`stdin`程序或命令的效果。它类似于`interactive-program < command-file`，其中`command-file`包含
> 
> ```
> command #1
> command #2
> ... 
> ```
> 
> `here document`等效项如下所示：
> 
> ```
> interactive-program <<LimitString
> command #1
> command #2
> ...
> LimitString 
> ```
> 
> 选择一个`limit string`足够不寻常的，它不会出现在命令列表中的任何地方并混淆问题。

所以在那个问题中，作者正在发送命令，`ftp`就好像交互式地使用它一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T22:28:52.677

使用这些搜索词再试一次：[*here document*](https://duckduckgo.com/?q=here+document)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-04T22:32:59.150

该`<<EOFD`构造是一种特殊类型的 shell 脚本（Bourne、bash 和我不确定其他脚本）的重定向，它告诉 shell 将后面的行视为`stdin`流，直到看到包含的行`EOFD`。

该`EOFD`字符串是任意的 - 任何唯一标记（或至少一个不会出现在`stdin`输入流中的标记）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T01:15:17.033

既然这些词是任意的，为什么有人会写`EOFD`而不是习惯`EOF`呢？

（顺便说一句，还有使用这个`!`字符的传统：

```
cat <<!
Hello
world
! 
```

)

`EOFD`如果您使用 here 文档生成的文本本身是一个 shell 脚本，它本身包含 here 文档，并且这些 here 文档已经`EOF`用于分隔，则可能很有用：

```
cat <<EOFD
#!/bin/sh
# here doc script
cat <<EOF
Hello
World
EOF
EOFD 
```

:)

# actionscript-3 - Actionscript 三的直升机轨迹公式？

> ID：10020146
> 
> 赞同：0
> 
> 时间：2012-04-04T22:26:09.327
> 
> 标签：actionscript-3

对，我正在尝试实现这个游戏，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:46:02.327

该游戏使用非常简单的物理原理；基本上只是在按住鼠标时从属性中减去一个值`velocity`，否则添加到它。

直升飞机的`y`增加`velocity`（将要上升一次`velocity`低于 0）。这也会导致您看到的逐渐加速/减速效果。

# 示例代码：

## Game.as（这将是您的文档类）。

```
package
{
    import flash.display.MovieClip;
    import flash.events.Event;
    import flash.events.MouseEvent;

    public class Game extends MovieClip
    {

        // Properties.
        private var _updating:Array = [];
        private var _mouseDown:Boolean = false;

        // Objects.
        private var _helicopter:Helicopter;

        /**
         * Constructor.
         */
        public function Game()
        {
            // Listeners.
            stage.addEventListener(Event.ENTER_FRAME, _update);
            stage.addEventListener(MouseEvent.MOUSE_DOWN, _mouseAction);
            stage.addEventListener(MouseEvent.MOUSE_UP, _mouseAction);

            // Helicopter.
            _helicopter = new Helicopter();
            stage.addChild(_helicopter);
        }

        /**
         * Mouse action manager.
         * @param e MouseEvent instance.
         */
        private function _mouseAction(e:MouseEvent):void
        {
            switch(e.type)
            {
                default: _mouseDown = false; break;
                case MouseEvent.MOUSE_DOWN: _mouseDown = true; break;
            }
        }

        /**
         * Update the game.
         * @param e Event instance.
         */
        private function _update(e:Event):void
        {
            _helicopter.update(_mouseDown);
        }

    }
} 
```

## 直升机.as

```
package
{
    import flash.display.Sprite;

    public class Helicopter extends Sprite
    {

        // Properties.
        private var _velocity:Number = 0;

        /**
         * Constructor.
         */
        public function Helicopter()
        {
            // Temp graphics.
            graphics.beginFill(0x00FF00);
            graphics.drawRect(0, 0, 60, 35);
            graphics.endFill();
        }

        /**
         * Update the helicopter.
         * @param mouseDown Boolean representing whether the mouse is held down or not.
         */
        public function update(mouseDown:Boolean):void
        {
            if(mouseDown) _velocity -= 1;
            else _velocity += 1;

            y += _velocity;
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T09:26:41.090

我记得玩过那个游戏，所以我想我理解它实现的那种动作。以下是有关如何自己实现它的简要想法。

你需要的是一个简单的物理公式，这个简单的公式如下。

v = u+at；

对。这就是你的公式，其中 v = 最终速度 u = 初始速度 a = 加速度 t = 时间。

时间是你的每一步。每一步行进的距离可以使用以下公式计算

s = u*t+ (0.5 * a*t*t);

s = 以时间步长行驶的距离 u = 初始速度 t = 时间。a = 加速度（在您的情况下是重力 - 当您离开鼠标时会生效。）

每个进入帧你会看到鼠标是否按下，如果鼠标按下超过 20 帧，在第 20 帧之后加速度开始上升 1 个单位（你定义单位！）。

当您停止按住鼠标时，同样的逻辑也适用。20 帧后（或您定义的任何时间衰减！），加速度开始下降 1 个单位。

参考：[http ://en.wikipedia.org/wiki/Equations_of_motion](http://en.wikipedia.org/wiki/Equations_of_motion)

# arrays - Bash：从另一个数组中删除一个数组中存在的项目

> ID：10020148
> 
> 赞同：14
> 
> 时间：2012-04-04T22:26:30.030
> 
> 标签：arrays, bash, for-loop

这个条目似乎是我想做的大约 80%，但我想出的东西都没有工作： [bash: how to delete elements from an array based on a pattern](https://stackoverflow.com/questions/3578584/bash-how-to-delete-elements-from-an-array-based-on-a-pattern)

我有两个数组：

```
@tapes_in_drives=(SP1026,SP0995,SP0434)

@tapes=(SP0001,SP0002,SP0434,SP0995,SP1026,SP2000,SP3000) 
```

我需要一个 bash 解决方案，它可以从@tapes 中删除@tapes_in_drives 中存在的所有条目。

我正在构建一个脚本，以根据到期日期等自动从磁带库中弹出磁带。

我试过这个：

```
for i in "${tapes_in_drives[@]}"; do
        tapes=(${tapes[@]//*$i*})
done 
```

但它不起作用，没有任何东西被删除。

感谢您的任何帮助，您可以提供。

**编辑：**

这是我正在使用的代码，我最初是用 Perl 编写的，因此是 @variable 定义，当我写这个问题时我非常累。

**代码：**

```
#!/usr/bin/bash

# If media expires less than this many days, keep it
export days_expired="30"

# Set to 1 to get debug output to console
export debug="1"

# Get list of SPxxxxx tapes that are physically in the library
if [ $debug -eq 1 ]; then echo "Getting tape list"; fi
export tapes=`vmquery -rn 1 -b | tail +4 | awk '{print \$1}' && vmquery -rn 4 -b | tail +4 | awk '{print \$1}'`

if [ $debug -eq 1 ]; then echo ${tapes[@]}; fi

# Query tape drives for tapes
export tapes_in_drives=`ssh srv-reg-nbms-01 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}' && ssh srv-reg-nbms-02 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}'`

if [ $debug -eq 1 ]; then
    echo ""
    echo "Tapes in Drives:"
    echo ${tapes_in_drives[@]}
    echo "";
fi

# Remove tapes in drives from list of tapes
for i in "${tapes_in_drives[@]}"; do
    tapes=(${tapes[@]//*$i*})
done

echo "Tape List 2"
echo ${tapes[@]} 
```

**结果：**

获取磁带列表

SP0011 SP0039 SP0402 SP0434 SP0464 SP0516 SP0551 SP0600 SP0604 SP0726 SP0731 SP0765 SP0767 SP0779 SP0781 SP0787 SP0793 SP0794 SP0805 SP0828 SP0830 SP0832 SP0927 SP0928 SP0936 SP0983 SP0995 SP1001 SP1004 SP1008 SP1015 SP1017 SP1026 SP1033 SP1036 SP1038 SP0042 SP0049 SP0150 SP0462 SP0473 SP0517 SP0557 SP0560 SP0642 SP0659 SP0697 SP0712 SP0723 SP0766 SP0777 SP0786 SP0788 SP0792 SP0907 SP0910 SP0923 SP0925 SP0926 SP0940 SP0963 SP0981 SP0986 SP0989 SP0994 SP0999 SP1007 SP1020 SP1021 SP1027 SP1039

驱动器中的磁带：

SP1001 SP1038 SP0923 SP0926 SP0925

磁带清单 2

SP0011 SP0039 SP0402 SP0434 SP0464 SP0516 SP0551 SP0600 SP0604 SP0726 SP0731 SP0765 SP0767 SP0779 SP0781 SP0787 SP0793 SP0794 SP0805 SP0828 SP0830 SP0832 SP0927 SP0928 SP0936 SP0983 SP0995 SP1001 SP1004 SP1008 SP1015 SP1017 SP1026 SP1033 SP1036 SP1038 SP0042 SP0049 SP0150 SP0462 SP0473 SP0517 SP0557 SP0560 SP0642 SP0659 SP0697 SP0712 SP0723 SP0766 SP0777 SP0786 SP0788 SP0792 SP0907 SP0910 SP0923 SP0925 SP0926 SP0940 SP0963 SP0981 SP0986 SP0989 SP0994 SP0999 SP1007 SP1020 SP1021 SP1027 SP1039

如您所见，来自 tapes_in_drives 的磁带名称并未从磁带阵列中删除。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-04T22:53:03.653

正如评论所说，这只是语法错误。

空格分隔数组条目，不要使用`@`，并且该函数适用于您的示例数据。请注意，它会删除包含 in 中的条目的任何条目`tapes_in_drives`，而不仅仅是那些与它完全匹配的条目。

```
tapes=(SP0001 SP0002 SP0434 SP0995 SP1026 SP2000 SP3000)
tapes_in_drives=(SP1026 SP0995 SP0434)
for i in "${tapes_in_drives[@]}"; do
         tapes=(${tapes[@]//*$i*})
done 
```

结果：

```
$ echo ${tapes[0]}
SP0001
$ echo ${tapes[1]}
SP0002
$ echo ${tapes[2]}
SP2000
$ echo ${tapes[3]}
SP3000
$ echo ${tapes[4]}

$ 
```

**编辑**以回应问题中的编辑

这一行：

```
export tapes=`vmquery -rn 1 -b | tail +4 | awk '{print \$1}' && vmquery -rn 4 -b | tail +4 | awk '{print \$1}'` 
```

而这一行：

```
export tapes_in_drives=`ssh srv-reg-nbms-01 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}' && ssh srv-reg-nbms-02 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}'` 
```

初始化`tapes`和`tapes)in_drives`作为字符串，而不是数组。您需要在分配的值周围添加括号以使它们成为数组，否则循环将不起作用。您也可以删除`export`，除非您希望脚本生成的进程将这些 shell 变量作为环境变量继承，否则没有必要。

```
tapes=(`vmquery -rn 1 -b | tail +4 | awk '{print \$1}' && vmquery -rn 4 -b | tail +4 | awk '{print \$1}'`)

tapes_in_drives=(`ssh srv-reg-nbms-01 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}' && ssh srv-reg-nbms-02 "echo 's d q'|/usr/openv/volmgr/bin/tldtest -r /dev/smc0|grep 'Barcode'" | awk '{print $3}'`) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T09:27:29.150

另一种解决方案：

```
tapes_in_drives=( SP1026 SP0995 SP0434 )
tapes=(SP0001 SP0002 SP0434 SP0995 SP1026 SP2000 SP3000)

tps=" ${tapes[*]} "                     # stringify the array

for item in ${tapes_in_drives[@]}; do
  tps=${tps/ ${item} / }                # replace item
done
tapes=( $tps )                          # replace the array 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-07-24T14:25:40.477

从[这个答案](https://askubuntu.com/a/623220/8822)中窃取并适应您的变量：

```
tapes_in_drives=(SP1026 SP0995 SP0434)
tapes=(SP0001 SP0002 SP0434 SP0995 SP1026 SP2000 SP3000)

free_tapes=( $(printf "%s\n" "${tapes[@]}" "${tapes_in_drives[@]}" | sort | uniq -u) )

echo "${free_tapes[@]}" 
```

输出：

```
SP0001 SP0002 SP2000 SP3000 
```

`-u`切换到`uniq`使其“仅*打印唯一行*”，因此它排除了两个阵列中的磁带。

# java - Xstream 之后的变量初始化

> ID：10020156
> 
> 赞同：3
> 
> 时间：2012-04-04T22:27:22.740
> 
> 标签：java, xstream

考虑以下声明作为`SomeClass`

```
private Set<String> blah    = new HashSet<String>(); 
```

在一堂课上做的，这是后来的

```
XStream xstream = new XStream(new JettisonMappedXmlDriver());
xstream.setMode(XStream.NO_REFERENCES);

StringBuilder json = new StringBuilder(xstream.toXML(SomeClass));

rd = (SomeClass) xstream.fromXML(json.toString()); 
```

当我`@Test`

```
assertTrue(rd.getBlah().size() == 0); 
```

我得到`NPE`一个`rd.getBlah()`

当我不是预先初始化时，将初始化放置到的构造函数中`SomeClass`

```
public SomeClass() {
  blah = new HashSet<String>();
} 
```

同样的问题 -`NPE`上`rd.getBlah()`

当我修改 getter 以首先检查 null 时，它可以工作，但是..

```
public Set<String> getBlah() {
   if (blah == null)
      return new HashSet<Sgring>();
   return blah;
} 
```

**我很纳闷……为什么不`XStream`初始化变量，是否需要惰性实例化？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T22:34:11.110

XStream 使用与 JDK 序列化相同的机制。当使用优化反射 API 的增强模式时，它不会调用默认构造函数。解决方案是实现 readResolve 方法，如下所示：

```
public class SomeClass{
    private Set<String> blah;

    public SomeClass(){
        // do stuff
    }

    public Set<String> getBlah(){
        return blah;
    }

    private Object readResolve() {
        if(blah == null){
            blah = new HashSet<String>();
        }
        return this;
    }
} 
```

[参考](https://x-stream.github.io/faq.html)

# python - Django mysql错误

> ID：10020157
> 
> 赞同：3
> 
> 时间：2012-04-04T22:27:33.833
> 
> 标签：python, mysql, django

我正在使用`mysql-python`. 这是我的settings.py

```
import os, sys

abspath = lambda *p: os.path.abspath(os.path.join(*p))

PROJECT_ROOT = abspath(os.path.dirname(__file__))
USERENA_MODULE_PATH = abspath(PROJECT_ROOT, '..')
sys.path.insert(0, USERENA_MODULE_PATH)

DEBUG = True
TEMPLATE_DEBUG = DEBUG

ADMINS = (
    ('me', 'myemail@gmail.com'),
)

MANAGERS = ADMINS

DATABASES = {
    'default': {
        'ENGINE': 'mysql',
        'NAME': 'test',
        'DATABASE_USER': 'root',
        'DATABASE_PASSWORD': 'pass',
    }
}

if DEBUG:
    # Use the Python SMTP debugging server. You can run it with:
    # ``python -m smtpd -n -c DebuggingServer localhost:1025``.
    EMAIL_USE_TLS = True
    EMAIL_HOST = 'smtp.gmail.com'
    EMAIL_HOST_USER = 'mygmail@gmail.com'
    EMAIL_HOST_PASSWORD = '12345'
    EMAIL_PORT = 587

TIME_ZONE = 'America/Chicago'
LANGUAGE_CODE = 'en-us'

ugettext = lambda s: s
LANGUAGES = (
    ('en', ugettext('English')),
    ('nl', ugettext('Dutch')),
    ('fr', ugettext('French')),
    ('pl', ugettext('Polish')),
    ('pt', ugettext('Portugese')),
    ('es', ugettext('Spanish')),
)

SITE_ID = 1

USE_I18N = True
USE_L10N = True

MEDIA_ROOT = abspath(PROJECT_ROOT, 'media')
DOCUMENT_ROOT = abspath(PROJECT_ROOT, 'docs')

MEDIA_URL = '/media/'

ADMIN_MEDIA_PREFIX = '/media/admin/'

SECRET_KEY = 'sx405#tc)5m@s#^jh5l7$k#cl3ekg)jtbo2ds(n(kw@gp0t7x@'

TEMPLATE_LOADERS = (
    'django.template.loaders.filesystem.Loader',
    'django.template.loaders.app_directories.Loader',
)

MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'userena.middleware.UserenaLocaleMiddleware',
)
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.contrib.auth.context_processors.auth",
    "django.core.context_processors.debug",
    "django.core.context_processors.i18n",
    "django.core.context_processors.media",
    "django.contrib.messages.context_processors.messages",
    "django.core.context_processors.request",
)

AUTHENTICATION_BACKENDS = (
    'userena.backends.UserenaAuthenticationBackend',
    'guardian.backends.ObjectPermissionBackend',
    'django.contrib.auth.backends.ModelBackend',
)

ROOT_URLCONF = 'demo_project.urls'

TEMPLATE_DIRS = (
    abspath(PROJECT_ROOT, 'templates')
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.admin',
    'easy_thumbnails',
    'guardian',
    'south',
    'userena',
    'userena.contrib.umessages',
    'demo_project.profiles',
)

# Userena settings
LOGIN_REDIRECT_URL = '/accounts/%(username)s/'
LOGIN_URL = '/accounts/signin/'
LOGOUT_URL = '/accounts/signout/'
AUTH_PROFILE_MODULE = 'profiles.Profile'

USERENA_DISABLE_PROFILE_LIST = True
USERENA_MUGSHOT_SIZE = 140

# Test settings
TEST_RUNNER = 'django.test.simple.DjangoTestSuiteRunner'
SOUTH_TESTS_MIGRATE = False

# Guardian
ANONYMOUS_USER_ID = -1 
```

当我运行时，`syncdb`我看到了这个错误：

```
Traceback (most recent call last):
  File "manage.py", line 15, in <module>
    execute_manager(settings)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 459, in execute_manager
    utility.execute()
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 69, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/south/management/commands/__init__.py", line 10, in <module>
    import django.template.loaders.app_directories
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/template/loaders/app_directories.py", line 21, in <module>
    mod = import_module(app)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/contrib/admin/__init__.py", line 3, in <module>
    from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/contrib/admin/helpers.py", line 2, in <module>
    from django.contrib.admin.util import (flatten_fieldsets, lookup_field,
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/contrib/admin/util.py", line 1, in <module>
    from django.db import models
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/__init__.py", line 40, in <module>
    backend = load_backend(connection.settings_dict['ENGINE'])
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
    backend = load_backend(db['ENGINE'])
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/utils.py", line 51, in load_backend
    raise ImproperlyConfigured(error_msg)
django.core.exceptions.ImproperlyConfigured: 'mysql' isn't an available database backend.
Try using django.db.backends.mysql instead.
Error was: No module named mysql.base 
```

如果我替换`'ENGINE': 'mysql' with`django.db.backends.mysql` 我看到这个错误：

```
Traceback (most recent call last):
  File "manage.py", line 15, in <module>
    execute_manager(settings)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 459, in execute_manager
    utility.execute()
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/base.py", line 231, in execute
    self.validate()
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
    num_errors = get_validation_errors(s, app)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/core/management/validation.py", line 103, in get_validation_errors
    connection.validation.validate_field(e, opts, f)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/backends/mysql/validation.py", line 14, in validate_field
    db_version = self.connection.get_server_version()
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/backends/mysql/base.py", line 411, in get_server_version
    self.cursor()
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/backends/__init__.py", line 306, in cursor
    cursor = self.make_debug_cursor(self._cursor())
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/django/db/backends/mysql/base.py", line 387, in _cursor
    self.connection = Database.connect(**kwargs)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/MySQLdb/__init__.py", line 81, in Connect
    return Connection(*args, **kwargs)
  File "/home/myname/.django-projects/userena/local/lib/python2.7/site-packages/MySQLdb/connections.py", line 187, in __init__
    super(Connection, self).__init__(*args, **kwargs2)
_mysql_exceptions.OperationalError: (1045, "Access denied for user 'myname'@'localhost' (using password: NO)") 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T22:46:55.793

用 django.db.backends.mysql 替换 'ENGINE': 'mysql' 是正确的。

现在，你必须改变：

```
DATABASES = {
    'default': {
        'ENGINE': 'mysql',
        'NAME': 'test',
        'DATABASE_USER': 'root',
        'DATABASE_PASSWORD': 'pass',
    }
} 
```

至：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'test',
        'USER': 'root',
        'PASSWORD': 'pass',
    }
} 
```

# c# - 如何将图像和项目添加到 imageComboxBoxEdit

> ID：10020165
> 
> 赞同：2
> 
> 时间：2012-04-04T22:28:08.450
> 
> 标签：c#, winforms, user-controls, devexpress

我一直在尝试并寻找有关如何将图像和文本项添加到 imageComboBoxEdit 的方法/教程我什至阅读了文档，但这并没有真正帮助。我使用了一个 imageList 然后我添加了 Resource.Black; 到 imageList 但是当我尝试通过这个将它添加到文本中时

```
private void AddItems(ImageComboBoxEdit editor, ImageList imgList) 
{
    for(int i = 0; i < 10 ; i++) 
        editor.Properties.Items.Add(new ImageComboBoxItem("Item " + (i + 1).ToString(), i, i));
        editor.Properties.SmallImages = imgList;
} 
```

然后这样做`AddItems(imageComboBoxEdit1, imageList1);`对文本项目很好，但是如果我向其中添加一堆图像，`ImageList`它只会删除所有文本项目并且根本不显示其中的项目。

底线：我需要帮助！哈哈

任何和所有的帮助将不胜感激！:D 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:21:03.757

与设计师：

1.  将图像列表拖放到表单上并向其中添加图像。
2.  在 imageComboBoxEdit 的属性窗口中展开属性，将 SmallImages 设置为添加到表单的 ImageList。
3.  单击 Items 属性的浏览按钮
4.  单击添加，创建一个新项目，填写描述（要显示的文本）和图像列表中图像的图像索引，以及一个值。我通常使用与 imageIndex 相同的数字作为值。

或者在代码中，仍然假设图像列表已添加到表单中并且其中包含图像。

```
 ImageComboBoxItem someItem = new ImageComboBoxItem();
        someItem.Description = "Text To Display";
        someItem.ImageIndex = 0;
        someItem.Value = 0;

        imageComboBoxEdit1.Properties.Items.Add(someItem); 
```

对于此示例，我只是在表单加载期间执行此操作。

# iphone - 绘制到屏幕的线条的内阴影效果？

> ID：10020173
> 
> 赞同：0
> 
> 时间：2012-04-04T22:29:07.900
> 
> 标签：iphone, xcode, drawing

我制作了一个 iOS 程序，允许用户用手指在屏幕上画一条线。我使用了 touchesBegan、touchesMoved 和 touchesEnded 方法，同时创建了一个 CGContext 并以这种方式画线。我希望线条看起来像是斜切到屏幕上，几乎就像是雕刻出来的一样。这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:03:29.780

You can achieve a simple bevel by stroking your lines three times:

1.  first, with a color brighter than the background at points p(x-1, y-1) relative to the actual line
2.  then, your line color at the actual line position, points p(x, y)
3.  then, brighter than the line color, but darker than the background at p(x+1, y+1)

You can think of this as a light shining onto your lines from above and to the left, making the lower coordinates brighter, passing over the bevel and having a little shadow cast on the higher coordinates.

Once you get the hang of thinking through the pseudo-3D geometry this way, you can create prettier bevels, including details inside the line. Those will take more strokes.

# actionscript-3 - 有人有旧版 AS3 和 Flex API 文档的链接/下载吗？

> ID：10020174
> 
> 赞同：0
> 
> 时间：2012-04-04T22:29:07.777
> 
> 标签：actionscript-3, apache-flex

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/index.html)具有非常慢的搜索功能。我使用了一个速度更快的greasemonkey 搜索插件，并且可以使用标准样式的javadocs。任何人都有标准样式的旧版 AS3 API 文档的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:24:13.753

也许你正在寻找这样的东西？ [http://www.airdoc.be/](http://www.airdoc.be/)

# javascript - Jquery 验证器 - 表单被错误保存

> ID：10020177
> 
> 赞同：0
> 
> 时间：2012-04-04T22:29:18.867
> 
> 标签：javascript, jquery, forms, validation

我有一个带有 jquery 验证的表单。我有一些自定义规则，但它们都可以在其他表单上检出并正常工作。事实上，除了一种特定情况外，它在此表单上工作得很好。我们有一个 URL 的文本输入。我们编写了一个正则表达式来禁止脚本标签。它工作正常。

如果您填写有错误的表单并提交，则会收到错误消息。正如预期的那样。但是这个 URL 字段...如果您在失败之前输入了一个有效的 URL，然后将其更改为脚本标记并单击“保存”，则会立即出现错误消息，但无论如何都会提交表单。如果您首先离开该字段，您会看到错误消息。但单击“保存”仍会保存表单。

我尝试使用页面加载功能来禁用表单操作并用检查表单是否有效来替换该操作。如果您将表单留空并单击保存，则会出现错误。如果你填写它，你将一无所获。单击保存根本没有任何作用。

这是我的表单标签。字段并不重要。这里的问题是表单验证失败但仍然保存：

```
<form id="frmCreateNewAd" action="/some/path" method="post" enctype="multipart/form-data">
  <input class="btnSave" type="submit" value="Save" />
</form> 
```

这是我尝试更改提交操作以禁用默认操作，直到表单通过验证时单击它：

```
//bind custom form action
$('#frmCreateNewAd').bind("submit", function(e){
  //disable default action
  e.preventDefault();
  //remove previous validation data
  $('#frmCreateNewAd').removeData("previousValue");
  //check if form is valid
  if ($('#frmCreateNewAd').valid()) {
    //if form is valid, unbind the submit action and submit the form
    $('#frmCreateNewAd').unbind('submit').submit();
  }
}); 
```

我认为问题可能是试图从绑定中禁用绑定......但我也尝试了这个，结果完全相同

```
//bind custom form action
$('#frmCreateNewAd').bind("submit", function(e){
  //disable default action
  e.preventDefault();
  //remove previous validation data
  $('#frmCreateNewAd').removeData("previousValue");
  //validate form
  $('#frmCreateNewAd').valid();
});

//When user submits form
$('#frmCreateNewAd').submit(function (e) {
  //remove previous validation data
  $("#frmCreateNewAd").removeData("previousValue");
  //check if form is valid
  if($('#frmCreateNewAd').valid()) {
    //if valid, unbind custom submit and submit the default action
    $(this).unbind('submit').submit();
  }
  else {
    //if invalid, ensure default is still prevented
    e.preventDefault();
  }
}); 
```

我觉得也许我正在双重绑定提交操作？有没有其他人必须克服这个问题？

更新：

验证码：

从全局文件：

```
if ($.validator) {
    $.validator.messages.required = 'Required field';
    $.validator.addMethod("zipcode", function(postalcode, element) { return this.optional(element) || postalcode.match(/(^\d{5}(-\d{4})?$)|(^[ABCEGHJKLMNPRSTVXYabceghjklmnpstvxy]{1}\d{1}[A-Za-z]{1} ?\d{1}[A-Za-z]{1}\d{1})$/); }, 'A valid Zip code is required');
    //$.validator.addMethod("urlcustom", function isUrl(str){ var regex = new RegExp("^((http|https|ftp)\://){0,1}([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(/($|[a-zA-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*$"); return regex.test(str); }, 'A valid URL is required');
    $.validator.addMethod("alphanumspaces", function alphanumspaces(value, element) { return this.optional(element) || value.match(/^[A-Za-z0-9_\-]+(\s[A-Za-z0-9_\-]+)*$/); }, 'Only letters, numbers, underscores (_), hyphens (-), and single spaces are allowed.');
    $.validator.addMethod("alphanumspchars", function alphanumspchars(value, element) {return this.optional(element) || value.match(/^[A-Za-z0-9_\-,\.\#\/\'\"\?]+(\s[A-Za-z0-9_\-,\.\#\/\'\"\?]+)*$/); }, 'Only letters, numbers, single spaces, and simple punctuation (\'\"-,_.#/?) are allowed.' );
    $.validator.addMethod("alphaspaces", function alphaspaces(value, element) {return this.optional(element) || value.match(/^[A-Za-z]+(\s[A-Za-z]+)*$/); }, 'Only letters and single spaces are allowed.');
    $.validator.addMethod("alphaspspaces", function alphaspspaces(value, element) {return this.optional(element) || value.match(/^[A-Za-z\-\.\(\)]+(\s[A-Za-z0\-\.\(\)]+)*$/); }, 'Only letters, hyphens (-), periods (.), and single spaces allowed');
    $.validator.addMethod("numeric", function numeric(value, element) {return this.optional(element) || value.match(/^[0-9]+$/); }, 'Only numbers with no spaces are allowed.');                $.validator.addMethod("statecode", function statecode(value, element) {return this.optional(element) || value.match(/^(A[LKSZRAEP]|C[AOT]|D[EC]|F[LM]|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEHINOPST]|N[CDEHJMVY]|O[HKR]|P[ARW]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY]|alabama|alaska|arizona|arkansas|california|colorado|connecticut|delaware|florida|georgia|hawaii|idaho|illinois|indiana|iowa|kansas|kentucky|louisiana|maine|maryland|massachusetts|michigan|minnesota|mississippi|missouri|montana|nebraska|nevada|new\shampshire|new\sjersey|new\smexico|new\syork|north\scarolina|north\sdakota|ohio|oklahoma|oregon|pennsylvania|rhode\sisland|south\scarolina|south\sdakota|tennessee|texas|utah|vermont|virginia|washington|wyoming|d.c.)$/i); }, 'A valid state or two-letter state abbreviation is required.');
    $.validator.addMethod("isDollars", function isDollars(value, element) {return this.optional(element) || value.match(/[0-9]+(\.[0-9]{2})?$/); }, 'Must be a valid dollar amount, with or without decimal.');
    $.validator.addMethod("keywords", function keywords(value, element) {return this.optional(element) || value.match(/^[A-Za-z0-9]+(,?\s[A-Za-z0-9]+)*$/); }, 'Keywords may only contain letters, numbers, and single spaces. Keywords must be separated by a comma and single space (, )');
    $.validator.addMethod("notzero", function notzero(value, element) {return this.optional(element) || value.match(/(^[1-9]+[0-9]*$)|(^0+[1-9]$)/); }, 'Please enter a value greater than zero');
    $.validator.addMethod("urlOpt", function urlOpt(value, element) {return this.optional(element) || value.match(/^(((http|https|ftp)\:\/\/){0,1}([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(\/($|[a-zA-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*)*$/); }, 'Please enter a properly formatted URL');
    $.validator.addMethod("noQuoteWrap", function noQuotes(value, element) {return this.optional(element) || value.match(/^[^\'\"].*[^\'\"]$/); }, 'Please remove leading or trailing quotes');
    $.validator.addMethod("phoneNum", function phoneNum(value, element) {return this.optional(element) || value.match(/^(1-|1\.|1)?(\([0-9]{3}\)|[0-9]{3})[\.\-]?[0-9]{3}[\.\-]?[0-9]{4}$/); }, 'Please enter a valid phone number, with or without hyphens (-), periods (.), or parenthesis ().');
    $.validator.addMethod("spaceStrip", function spaceStrip(value, element) { return this.optional(element) || value.match(/^[.]*$/); }, 'Removing leading and trailing whitespace');
    $.validator.addMethod("noScript", function noScript(value, element) { return this.optional(element) || value.match(/^((?!<script).)*$/); }, 'Script tags are not allowed');

    // Create and hide error message DOM elements
    var errorWrap = document.createElement('div');
    $(errorWrap).addClass('errorWrap hideError');
    var errorTop = document.createElement('div');
    $(errorTop).addClass('errorTop');
    var topSpan = document.createElement('span');
    var errorContent = document.createElement('div');
    $(errorContent).addClass('errorContent');
    var errorBottom = document.createElement('div');
    $(errorBottom).addClass('errorBottom');
    var bottomSpan = document.createElement('span');

    $("dl > dd").append(errorWrap);
    $("div.errorWrap").append(errorTop)
            .append(errorContent)
            .append(errorBottom);
    $("div.errorTop").append(topSpan);
    $("div.errorBottom").append(bottomSpan);

    //Set custom placement, highlighting, and unhighlighting
    $.validator.setDefaults({
                errorPlacement: function(error, element) {
                    if ($(element).attr("name") == "remnantList") {
                        $(element).parent().nextAll('.errorWrap').children('.errorContent').append(error);
                      }
                    else {
                        $(element).nextAll('.errorWrap').children('.errorContent').append(error);
                    }
                },
                highlight: function(element) {
                    if ($(element).attr("name") == "remnantList") {
                        $(element).parent().nextAll('.errorWrap').removeClass('hideError');
                    }
                    else {
                        $(element).nextAll('.errorWrap').removeClass('hideError');
                    }
                },
                unhighlight: function(element) {
                    if ($(element).attr("name") == "remnantList") {
                        $(element).parent().nextAll('.errorWrap').addClass('hideError');
                      }
                    else {
                        $(element).nextAll('.errorWrap').addClass('hideError');
                    }
                },
                onkeyup: false

    }); 
```

从特定于页面的 js 文件：

```
$('form').validate({
            errorElement: 'span',
            onkeyup: true,
            onfocusout: true,
            rules: {
                    'adName': { required: true, spaceStrip: { depends:  function() { $(this).val($.trim($(this).val())); return false; } }, maxlength:200 },
                    'adText': { alphanumspchars: true, maxlength:1000, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'thirdPartyImpressionTrackingUrl': { noQuoteWrap: true, maxlength:1000, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'thirdPartyClickTrackingUrl': { noScript: true, noQuoteWrap: true, maxlength:1000, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.destinationUrlView': { required: { depends: destinationUrlRequired }, noQuoteWrap: { depends: isBannerAndFirstFieldIsUrl }, /*number: { depends: isBannerAndIsClickToCall },*/ minlength: function() { return isBannerAndIsClickToCall() ? 10 : false; }, maxlength:1000, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.destinationFile': { required: { depends: isBannerAndDestinationFile }, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[0].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[1].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[2].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[3].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[4].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[5].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[6].multipartFile': { required: { depends: requiredFileUpload }, accept:'jpg|gif|png', spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.interactions[0].destinationUrl': { required: { depends: isVideoAndVisible }, maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.interactions[1].destinationUrl': { required: { depends: isVideoAndVisible }, maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.interactions[2].destinationUrl': { required: { depends: isVideoAndVisible }, maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.interactions[3].destinationUrl': { required: { depends: isVideoAndVisible }, maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.interactions[4].destinationUrl': { required: { depends: isVideoAndVisible }, maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[0].destinationUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[1].destinationUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[2].destinationUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[3].destinationUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[4].destinationUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[0].thirdpartyImpressionUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[1].thirdpartyImpressionUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[2].thirdpartyImpressionUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[3].thirdpartyImpressionUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[4].thirdpartyImpressionUrl': { maxlength:1000, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[0].thirdpartyClickUrl': { maxlength:1000, noScript: true, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[1].thirdpartyClickUrl': { maxlength:1000, noScript: true, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[2].thirdpartyClickUrl': { maxlength:1000, noScript: true, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[3].thirdpartyClickUrl': { maxlength:1000, noScript: true, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'bannerAdCommand.bannerFiles[4].thirdpartyClickUrl': { maxlength:1000, noScript: true, noQuoteWrap: true, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.videoMultipartFile': { required: { depends: isVideoAndNoneExists }, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } },
                    'videoAdCommand.duration': { required: { depends: isVideo }, spaceStrip: { depends: function() { $(this).val($.trim($(this).val())); return false; } } }
            },
            messages: {
                    'bannerAdCommand.destinationUrlView': { url: 'Valid URL is required' },
                    'bannerAdCommand.bannerFiles[0].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[1].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[2].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[3].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[4].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[5].multipartFile': { required: bannerMissing, accept: bannerType },
                    'bannerAdCommand.bannerFiles[6].multipartFile': { required: bannerMissing, accept: bannerType },
                    'videoAdCommand.videoMultipartFile': { required: videoMissing, accept:'mov|mp4|wmv|avi' }
            }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:50:49.643

当表单不验证时返回 false 怎么样，这不会阻止表单被提交吗？.

如果我错了，请纠正我这是你想要做的：1）验证用户输入 2）如果所有输入都正确提交表单 3）其他显示错误

您的问题是即使它们是验证错误，它仍然会提交表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:02:53.500

您是使用 jQuery 插件进行验证还是使用自定义脚本？我想自己进行一些测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:03:57.403

这对我有用：

```
 $(document).ready(function () {
        $("#frmCreateNewA").validate();

        //bind custom form action
        $('#frmCreateNewAd').bind("submit", function (e) {
            //disable default action
            e.preventDefault();

            alert($('#frmCreateNewAd').valid());
            //remove previous validation data
            $('#frmCreateNewAd').removeData("previousValue");
            //check if form is valid
            if (!$('#frmCreateNewAd').valid()) {

                return false
            }

        });

    });

   <form id="frmCreateNewAd" action="javascript:alert('success!');">

 <input id="txttest" type="text" class="required checkUrl" />
 <input class="btnSave" type="submit" value="Save" />

 </form> 
```

其中“类”属性指定规则： [http ://docs.jquery.com/Plugins/Validation/rules](http://docs.jquery.com/Plugins/Validation/rules)

看看 docs.jquery.com/Plugins/Validation/valid

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T21:06:28.987

我最终通过添加一个中间层验证器方法来解决这个问题，以使用我在 jquery 验证器上使用的相同正则表达式拒绝来自服务器的值来拒绝脚本标签。这不是我希望解决这个问题的方式，但它确实有效。由于在某些极其特殊的情况下，问题似乎是 jquery 验证器的提交处理程序中的一些错误，我认为最好绕过并继续前进。非常感谢所有提供意见的人。

# c++ - Boost 库中的编译失败 (program_options)

> ID：10020179
> 
> 赞同：3
> 
> 时间：2012-04-04T22:29:31.080
> 
> 标签：c++, boost, c++11, g++, boost-program-options

今天我重建了我的 C++ 应用程序，但编译失败了。什么都没有改变。第一个错误是在我的类`List`中，它继承自`std::vector`（私有继承）这里：

```
template<typename T> void List<T>::append(const T& value)
{
    push_back(value);
} 
```

我之前必须添加`std::vector<T>::`，`push_back(value);`因为编译器没有找到任何声明。我真的不知道为什么会这样，但是 g++ 有一个更新，我现在在 Arch Linux 上使用 C++11 使用 g++ v4.7.0（预发行版）。

我解决了这个问题，但现在真正的问题是，由于 Boost library 中的问题，我无法编译应用程序的其余部分`program_options`。我包括图书馆：

```
#include <boost/config.hpp>
#include <boost/program_options/detail/config_file.hpp>
#include <boost/program_options/parsers.hpp> 
```

错误：

```
g++ -m64 -pipe -pedantic -Wextra -std=gnu++0x   -c -g -Wall -DDEBUG -DDEV -DMYSQL_SUPPORT -I. -IHeaders -MMD -MP -MF build/Debug/GNU-Linux-x86/Sources/Libs/Settings.o.d -o build/Debug/GNU-Linux-x86/Sources/Libs/Settings.o Sources/Libs/Settings.cpp
/usr/include/boost/program_options/detail/config_file.hpp: In instantiation of ‘bool boost::program_options::detail::basic_config_file_iterator<charT>::getline(std::string&) [with charT = char; std::string = std::basic_string<char>]’:
In file included from Sources/Libs/Settings.cpp:33:0:
Sources/Libs/Settings.cpp:69:24:   required from here
/usr/include/boost/program_options/detail/config_file.hpp:163:13: erreur: ‘to_internal’ was not declared in this scope, and no declarations were found by argument-dependent lookup at the point of instantiation [-fpermissive]
In file included from /usr/include/boost/program_options/detail/parsers.hpp:9:0,
                 from /usr/include/boost/program_options/parsers.hpp:265,
                 from Sources/Libs/Settings.cpp:34:
/usr/include/boost/program_options/detail/convert.hpp:75:34: note: ‘template<class T> std::vector<std::basic_string<char> > boost::program_options::to_internal(const std::vector<T>&)’ declared here, later in the translation unit 
```

与我的 List 类相同的错误......</p>

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T11:18:25.277

我怀疑你已经被 gcc 4.7 中模板实例化的两阶段查找规则的变化所困扰。

如果没有源代码，我无法给出任何更实用的建议，但[gcc4.7 更改](http://gcc.gnu.org/gcc-4.7/changes.html)（C++ 章）给出了两阶段查找的描述并建议了一些代码更正。

# iphone - iPhone 的 Objective-C 中的面向切面编程

> ID：10020180
> 
> 赞同：0
> 
> 时间：2012-04-04T22:29:35.767
> 
> 标签：iphone, objective-c, ios, aop

当我可以使用 AOP 时，任何人都可以先帮助我，以及在 iphone 编程中到底是什么。

我需要访问应用程序项目源代码并调用一些函数，并通知他们从外部加载的视图，如库。

到目前为止我发现了这些，但看起来很复杂。有些没有构建或源代码被删除。

[https://github.com/ndcube/AOP-for-Objective-C](https://github.com/ndcube/AOP-for-Objective-C)

[https://github.com/moszi/AOP-in-Objective-C](https://github.com/moszi/AOP-in-Objective-C)

cocoadev 上的 ACAspect

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:17:35.347

如果您在视图控制器中有一个特定的视图，并且希望在加载时收到通知，您可以在该实例变量（出口）更改时注册 KVO 通知。

您需要阅读 Cocoa 中的 Key Value Observing。您需要学习几种方法来学习如何使用。

在 XCode 文档中搜索“Key-Value Observing Programming Guide 简介”并阅读该部分。

确保平衡对 addObserver:forKeyPath:options:context: 的调用与对 removeObserver:forKeyPath: 的调用，否则您的应用程序可能会在观察对象被释放后崩溃。

# regex - Matlab 正则表达式 if 语句

> ID：10020181
> 
> 赞同：1
> 
> 时间：2012-04-04T22:29:36.860
> 
> 标签：regex, matlab, if-statement

我想让 matlab 接受用户输入，但同时接受字母的两种情况。例如我有：

```
function nothing = checkGC(gcfile)
if exist(gcfile)
    reply = input('file exists, would you like to overwrite? [Y/N]: ', 's');
    if (reply == [Yy])
        display('You have chosen to overwrite!')
    else
        $ Do nothing
    end
end 
```

if 语句显然不起作用，但基本上我想接受小写或大写的 Y。最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T22:36:19.463

使用函数[lower](http://www.mathworks.com/help/techdoc/ref/lower.html)或[upper](http://www.mathworks.com/help/techdoc/ref/upper.html)。例如：

```
if (lower(reply) == 'y') 
```

或者，[strcmpi](http://www.mathworks.com/help/techdoc/ref/strcmpi.html)将不区分大小写地比较字符串。例如：

```
if (strcmpi(reply, 'y')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:36:18.007

只需在您的情况下使用基本**或**运算符即可。在此处查看文档：http: [//www.mathworks.se/help/techdoc/ref/logicaloperatorselementwise.html](http://www.mathworks.se/help/techdoc/ref/logicaloperatorselementwise.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T23:23:34.897

[http://www.mathworks.de/help/techdoc/ref/regexpi.html](http://www.mathworks.de/help/techdoc/ref/regexpi.html)

```
if (regexpi(reply,'^y(es)?$'))
        display('You have chosen to overwrite!') 
```

# wix - WiX 主要升级在生成之前不会完成安装

> ID：10020186
> 
> 赞同：1
> 
> 时间：2012-04-04T22:30:06.767
> 
> 标签：wix, windows-installer, major-upgrade

我根据在[这里](http://blogs.technet.com/b/alexshev/archive/2008/02/15/from-msi-to-wix-part-8-major-upgrade.aspx "从 MSI 到 WiX，第 8 部分 - 主要升级")找到的代码创建了一个安装程序。如果存在应用程序的早期版本，我希望安装程序在安装新版本之前将其删除。

如果是全新安装，一切顺利。

如果是升级，就会发生奇怪的事情。正如预期的那样，旧版本被删除，注册表被更改，快捷方式被放置在桌面上。奇怪的是，安装程序完成后，应用程序文件夹中不存在主文件。

升级后启动时，会弹出一个小的安装程序消息框并指出“请稍候，Windows 正在配置 -app name-..”。在此快速消息之后，该文件应存在于应用程序文件夹中，并且应用程序启动。

但在发布之前，它不存在。我什至在启动应用程序之前尝试重新启动，看看如果文件卡在某种缓存中，是否会放置文件。

有人见过这种行为吗？这有点像[这个问题](https://stackoverflow.com/questions/1544990/wix-major-upgrade-doesnt-completely-install-app-on-downgrade "WiX“重大升级”在降级时未完全安装应用程序")，但每次升级都会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T08:27:46.513

> 奇怪的是，安装程序完成后，应用程序文件夹中不存在主文件。

如果组件管理不正确，这是 Windows 安装程序升级的常见问题。如果您从控制面板启动安装程序进入维护模式并进行“修复”，您通常会看到丢失的文件重新出现。在这种情况下，[Windows 会在您启动应用程序时自动修复](http://support.microsoft.com/kb/290997)它。

我头顶的一些可能的解释：

1.  新版本的安装程序将此文件安装在具有新 GUID 的组件中。这会导致问题，因为组件 GUID 应该保持稳定。

2.  您的安装程序会为每个组件安装多个文件。这会导致问题，因为是否应该安装组件是由[keypath](https://stackoverflow.com/questions/2003043/what-is-the-wix-keypath-attribute)决定的，并且只有一个文件可以是 keypath。[每个组件坚持一个文件](https://stackoverflow.com/questions/1602831/wix-one-file-per-component-or-several-files-per-component)。

3.  文件的“新版本”实际上具有较低的版本号。这样的“升级”[不能正常工作](https://stackoverflow.com/questions/4227456/windows-installer-deletes-versioned-file-during-product-upgrade-instead-of-down)。

# c# - FrameworkElement 的 VisualStateManager.GoToState

> ID：10020199
> 
> 赞同：4
> 
> 时间：2012-04-04T22:31:55.050
> 
> 标签：c#, silverlight, windows-phone-7, silverlight-3.0, frameworkelement

我在`StackPanel`用`VisualStateManager`.

`VisualStateManager.GoToState()`接受 a`Control`作为参数，但`StackPanel`类型为`UIElement`/ `FrameworkElement`。

我怎样才能调用`VisualStateManager.GoToState()`一个`StackPanel`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:50:42.157

您可以使用`VisualStateManager.GoToElementState`

这篇文章可能会对您有所帮助：[WPF using VisualStateManager to animate panel in & out](https://stackoverflow.com/questions/5084206/wpf-using-visualstatemanager-to-animate-panels-in-out)。

**编辑：**

上述方法仅适用于 WPF，在 Silverlight 中不可用。对于 Silverlight，`ExtendedVisualStateManager`来自 Blend SDK 的可能会有所帮助：

[http://msdn.microsoft.com/de-de/library/microsoft.expression.interactivity.core.extendedvisualstatemanager.gotoelementstate(v=expression.40).aspx](http://msdn.microsoft.com/de-de/library/microsoft.expression.interactivity.core.extendedvisualstatemanager.gotoelementstate(v=expression.40).aspx)

不过，您必须包括该`Microsoft.Expression.Interactions`程序集。

# c# - 时间：2019-04-10 标签：c#programminglyrebuildwindowsindex

> ID：10020201
> 
> 赞同：2
> 
> 时间：2012-04-04T22:32:25.123
> 
> 标签：c#, indexing

我想知道是否有人知道如何重建 Windows 索引缓存？

我不完全确定是否有任何 API 来控制 Windows 索引，并想知道是否有人在这方面有任何经验。

谢谢你们。

# jquery - jQuery 图片上传插件 - 单个页面上的多个实例 - ASP.net

> ID：10020204
> 
> 赞同：1
> 
> 时间：2012-04-04T22:32:44.797
> 
> 标签：jquery, asp.net, asynchronous, image-upload

我有一个 ASP.NET Web 应用程序，用户可以在特定页面上添加一个条目以及两个图像。到目前为止，我遇到了许多很棒的 jQuery 插件，它们可以很容易地集成并用于上传。我发现这个[http://pixelcone.com/jquery/ajax-file-upload-script/](http://pixelcone.com/jquery/ajax-file-upload-script/)非常适合我的需要，它只需要被克隆。

但问题是：如何创建同一个插件的多个实例（在这种情况下是两个）？为了清楚起见，我需要两个插件，每个插件将一个图像上传到它们的位置（插件1->位置1；插件2->位置2）。

PS 通过谈论“两个实例”，我的意思是两个单独的表格（不是一个包含多个文件的表格）。

任何意见将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:35:05.580

调用插件时使用两个不同的选择器。

例如

```
 $('.fileUploadOne, .fileUploadTwo').fileUploader();

<input type="file" name="file" class="fileUploadOne" multiple>
<input type="file" name="file" class="fileUploadTwo" multiple> 
```

并使用您想要文件转到的正确参数正确更新您的控制器。

# hashmap - 我可以在这个 if 语句中返回什么？

> ID：10020207
> 
> 赞同：0
> 
> 时间：2012-04-04T22:33:04.283
> 
> 标签：hashmap, return-value

我正在创建一个基于文本的冒险游戏，该游戏涉及多个房间、房间内的物品，以及在这些房间中来回移动。房间邻居存储在 HashMap 中，我对此完全没有经验。我有一个名为 getNeighbor 的方法，该方法旨在将房间的邻居返回到请求的方向，但我不知道该怎么做。这是代码：

```
public class Room
{
    private String roomDescript;
    private Item item;
    private HashMap <String, Room> myNeighbors;

    public Room (String pDescription){
        roomDescript = pDescription;
        item = null;
    }

    public Room (String pDescription, Item pItem){
        roomDescript = pDescription;
        item = pItem;
    }

    public String setRoomDescript(){
        return this.roomDescript;
    }
    public String getRoomDescript(){
        return this.roomDescript;
    }
    public Item setItem(){
        return this.item;
    }
    public Item getItem(){
        return this.item;
    }

    public void addItem (Item i){
        i = item;
    }

    public boolean hasItem(){
        if(item != null){
            return true;
        }else{
            return false;
        }
    }

    public void addNeighbor (String pDirection, Room r){
        myNeighbors.put(pDirection, r);
    }

    public Room getNeighbor (String pDirection){
        if(myNeighbors.containsKey(pDirection)){
            return ;
        }else{
            return null;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:34:57.357

听起来您可以将方法更改为：

```
public Room getNeighbor (String pDirection) {
    return myNeighbours.get(pDirection);
} 
```

毕竟，如果无论如何都找不到密钥，`Map.get()`它将返回。`null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T22:35:34.690

使用[`HashMap.get(pDirection)`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html#get%28java.lang.Object%29)：

```
public Room getNeighbor (String pDirection){
     return myNeighbors.get(pDirection);
} 
```

请注意，您不需要 if 语句，因为如果没有太多，则已经`get()`返回。`null`

# android - 为什么我的 DialogFragment 中的 ProgressBar 停止旋转？

> ID：10020210
> 
> 赞同：0
> 
> 时间：2012-04-04T22:33:27.960
> 
> 标签：android, android-dialogfragment

我有以下结构：

在 UIActivity1 中：

```
MyMyProgressDialogFragment progressDialog = MyMyProgressDialogFragment.newInstance();
progressDialog.show(getFragmentManager(),"dialog");
getFragmentManager().executePendingTransactions();
..do some heavy work and send messages to progressDialog 
```

DialogFragment被创建并且这个片段中的**ProgressBar****开始旋转**。

**但是，当我现在开始在创建对话框片段的活动中进行繁重的工作时，片段中的进度条会停止。**

在阅读片段文档时，我了解到片段有自己的活动 - 与 Ui Activity1 相同。并且 afaik 每个活动都在一个单独的线程中运行。

**那么为什么当 UIActivity1 开始繁重的工作时，对话框片段中的进度条会停止呢？**

他们不应该是独立的吗？

ps 当我再次在不同的任务中运行 UIActivity 之外的繁重工作时，进度条一直在旋转而没有问题。

我在这里理解的错误在哪里？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:41:55.887

从您共享的信息中不清楚，但是看起来您正在 UI 线程中执行所有繁重的操作。那是活动的主线程。您使用片段衍生的活动是否旨在完成这项工作是无关紧要的，UI 线程必须*仅*用于更新 UI 元素，并且通常避免花费超过 100 - 200 毫秒的任务。这是根据 android [Non-Responsive Application 文档](http://developer.android.com/guide/practices/design/responsiveness.html)。这可能是问题所在，任何长期存在或长期执行的任务都必须在后台线程中完成。

看看这个[在 Android 中使用进度条的例子](http://www.mkyong.com/android/android-progress-bar-example/)。

# java - 关于如何执行循环以删除第 n 个元素的任何建议？

> ID：10020212
> 
> 赞同：1
> 
> 时间：2012-04-04T22:33:36.577
> 
> 标签：java, sorting

编写一个方法，缩小，从员工姓名的 LinkedList 中删除每个第 n 个元素。

```
import java.util.LinkedList;
import java.util.ListIterator;

public class LinkedListDemo
{

   public static void main(String[] args)
   {
      LinkedList<String> staff = new LinkedList<String>();
      staff.add("John");
      staff.add("Bob");
      staff.add("Richard");
      staff.add("Alice");
      staff.add("Jane");
      staff.add("Carlos");
      staff.add("Jose");
      staff.add("Maria");

      downsize(staff, 3);
      System.out.println(staff);
      System.out.println("Expected: [John, Bob, Alice, Jane, Jose, Maria]");

   }

   public static void downsize(LinkedList<String> employeeNames, int n)
   {
      ListIterator<String> iter = employeeNames.listIterator();

      for(int i=n; i<employeeNames.size(); i++)
      {
         iter.next();
      }

      iter.remove();

   }

} 
```

我很难找到一个可以删除 ListIterator 中任何第 n 个元素的完美循环。谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T22:36:58.683

这将从employeeNames LinkedList 中删除每个第n 个元素：

```
for(int i=0; i<employeeNames.size(); i++)
  {
     iter.next();
     if (i % n == 0) iter.remove();
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:10:06.733

永远不要修改您当前正在迭代的列表。疯狂的谎言就是这样。

```
public static List<String> downsize(List<String> employeeNames, int n) {
    Set<String> employeesToRemove = new HashSet<String>();
    for (int index = n; index < employeeNames.size(); index += n) {
        employeesToRemove.add(employeeNames.get(index);
    }
    employeeNames.removeAll(employeesToRemove);
} 
```

但是，如果您绝对必须遍历数组，这也是一种疯狂。

```
public static List<String> downsize(List<String> employeeNames, int n) {
    for (int index = employeeNames.size() -  (n -(employeeNames.size()  % n))  ; index >= 0; index -= n) {
        employeeNames.remove(index);
    }
    return employeeNames;
} 
```

# java - 在JPanel上绘制然后保存到文件，但是保存的文件全是白色的

> ID：10020214
> 
> 赞同：0
> 
> 时间：2012-04-04T22:34:06.103
> 
> 标签：java, swing, awt, jpanel, bufferedimage

我是 stackoverflow 的新发帖者，但我一直在阅读这些帖子以获得灵感，我很高兴成为社区的一员。

我正在将图像绘制到 JPanel，然后我希望将该图像保存到文件中。JPanel 上的绘画很好，但是当我查看图像时，它不是全白就是全黑。我不知道为什么图像没有保存它在 JPanel 上的外观。我想在将图像绘制到缓冲区并保存时，我可能没有正确引用面板？它几乎就像 bufferedImage 是空白的。我对awt没有太多经验，所以我觉得我犯了一个非常愚蠢的错误。

我只覆盖paintComponent() 方法一次，并在其中进行绘图（它完美地显示在JPanel 上），然后在它的底部调用saveImage() 方法，该方法应该将图像保存到文件中. 但正如我之前提到的，它总是一个空白图像。我在构造函数中使用 repaint() 方法。

我不会用整个代码来阻止这篇文章。它是一个非常简单的代码，相关部分如下。

```
class drawingBarcode extends JPanel 

    public drawingBarcode(){
        repaint();
        try{
            Thread.sleep(999);

        }catch(InterruptedException e){
            e.printStackTrace();
        }

public void saveImage() {
    BufferedImage bi = new BufferedImage(350, 150, BufferedImage.TYPE_INT_RGB);    

      Graphics2D g2 = bi.createGraphics();//creates and returns a graphics 2d for drawing into buffer

     //  g2.setColor(color1);
       super.paintComponent(g2);

        g2.dispose();
       try
       {
            ImageIO.write(bi, "jpg", new File("test.jpg\\"));        
       }
       catch(IOException ioe)
       {
        System.out.println("Something went wrong");
            ioe.printStackTrace();
        }

public void paintComponent(Graphics g){
        Graphics2D g2D = (Graphics2D) g;

        super.paintComponent(g2D);

        setStrokeWithPen1(g2D);
        drawAsterix(g2D);//draw asterix(start digit) always

/* some drawing takes place here using g2D. */

        g2D.dispose();
        saveImage();
        }
} 
```

任何可以提供的帮助或建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:16:46.693

您的保存图像例程调用 super.paintComponent，在绘制图像图形时丢失了所有自定义绘制代码！我会重构您的代码-您不希望每次 UI 绘制时都保存文件吗？

# c# - 在 ASP.net MVC 3 c# 中处理来自 HTML 表单的文件上传

> ID：10020215
> 
> 赞同：0
> 
> 时间：2012-04-04T22:34:07.903
> 
> 标签：c#, html, asp.net-mvc-3, forms, upload

我在 PHP 方面有丰富的经验，但对 ASP.net 还是很陌生。我在网上找到了一些教程，这些教程让我走到了这一步，但我目前遇到了问题。

所以总结一下我想要完成的事情，我有一个页面，我希望用户在其中提交参赛作品。我使用 HTML 表单来收集条目标题、描述等内容，并希望他们能够提交代表其条目的图像。

当他们选择提供图像时，我希望它使用类似的路径上传：//entries//entry-image。

我的数据库将只保存一个表示图像路径的 varchar。我还想为文件上传添加一些明显的验证，例如限制文件大小，只允许某些文件扩展名。图像应该使用一些标准名称（如上面路径中的“entry-image”）保存，覆盖可能已经在该入口目录中的任何图像。

现在从我的 HTML 表单获取文本输入不是问题，但获取文件是。我目前还没有对表单进行验证，只是想让它在最基本的状态下工作。这是我的 HTML 的截断版本：

```
<form method="post" action="../Entry/Create">
            <input type="text" id="EntryTitle" name="EntryTitle" />
            <p id="char-remaining">(100 characters remaining)</p>

            <input type="text" id="EntryVideo" name="EntryVideo" />
            <p id="vid-desc">(URL of the Video to Embed)</p>

            <input type="file" id="ImageFile" name="ImageFile" />
            <p id="file-desc">(200x200px, jpeg, png, gif)</p>

            <textarea id="EntryDesc" name="EntryDesc"></textarea>
            <p id="entry-desc"></p>
            <button id="new-entry-save">save</button>
</form> 
```

现在，这是我的 EntryController 类中的 Create 操作：

```
public ActionResult Create(string EntryTitle, string EntryVideo, HttpPostedFileBase ImageFile, string EntryDesc)
    {
        if (Session["User"] != null)
        {
            User currentUser = (User)Session["User"];

            //string savedFileName = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, Path.GetFileName(ImageFile.FileName)); 
            //ImageFile.SaveAs(savedFileName);

            Entry newEntry = new Entry();

            newEntry.Title = EntryTitle;
            newEntry.EmbedURL = EntryVideo;
            newEntry.Description = EntryDesc;
            //newEntry.ImagePath = savedFileName;
            newEntry.UserId = currentUser.UserId;

            db.Entries.Add(newEntry);
            db.SaveChanges();

        }

        return RedirectToAction("MyPage", "User");
    } 
```

你会注意到我有几行注释掉了。当被注释掉时，文本输入值被很好地接收并存储在我的数据库中。但是，如果不加注释，则会在第一个注释掉的行上引发 NullReferenceException。

我在操作中使用的代码几乎只是从教程中复制和粘贴的，我意识到如果它确实有效，它将无法实现我上面写的目标，因为它不检查文件扩展名或将文件名更改为标准。

所以我的主要问题是：

1.) 当我实际上在 HTML 表单上提供文件时，为什么会收到 NullReferenceException？

2.) 我将如何验证提交的文件？（尺寸、扩展、尺寸等）

3.) 我将如何将文件名更改为“entry-image”之类的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:48:32.093

以下是对上面第 2 点的回答：

在该视图的提交操作上调用 JavaScript 函数

```
<input type="submit" id="thePageSubmit" value="Upload" onclick="return IsValidExtention();" /> 
```

然后在 Javascript 函数中执行类似的操作

```
 function IsValidExtention() {
        var it = document.forms[0].elements["ImageFile"].value;
        it = it.substring(it.lastIndexOf('\\') + 1);
        if (it.length > 0) {
            if (it.toLowerCase().indexOf(".exe")!=-1) {
                alert("We are unable to upload .exe files.");
                return false;
            }
            if (it.toLowerCase().indexOf(".js") != -1) {
                alert("We are unable to upload .js files.");
                return false;
            }
        }
        else{
            return false;
        } 
        return true;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:37:25.530

如果它不存在，请将`enctype="multipart/form-data"`属性添加到您的表单元素。

# javascript - JSON 响应中的非法字符

> ID：10020226
> 
> 赞同：15
> 
> 时间：2012-04-04T22:35:16.013
> 
> 标签：javascript, json, unicode, utf-8

我有一个 Sencha Touch 应用程序。我拥有的其中一家商店使用 ajax 代理和 json 阅读器。从我的 sinatra 应用程序返回的 JSON 中的某些字符串偶尔会包含此字符： [http ://www.fileformat.info/info/unicode/char/2028/index.htm](http://www.fileformat.info/info/unicode/char/2028/index.htm)

虽然它是不可见的，但该字符在此处的第二个字符串中出现了两次，在句点和结束引号之间：

```
"description": "Each of the levels requires logic, skill, and brute force to crush the enemy.  " 
```

尝试将“每个关卡都需要逻辑、技巧和蛮力来粉碎敌人。”复制并粘贴到您的 JavaScript 控制台中！它不会被解析为字符串，并且会以`SyntaxError: Unexpected token ILLEGAL`.

这会导致 JSON 响应失败。我已经卡在这个问题上很长时间了！有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T01:15:14.767

解决此问题的唯一可靠方法是服务器端。确保您的 JSON 生成器发出转义的字符，例如`\u2028`.

以我的经验，最简单的方法是简单地用纯 ASCII 编码你的 JSON，这将始终有效。缺点是它的效率较低，因为非 ASCII 字符会占用更多空间，因此根据这些字符的频率，您可能不希望这种权衡...

Perl 的 JSON::XS 的文档对问题有很好的解释，并就如何在 Perl 中修复它提出了建议： [http ://search.cpan.org/perldoc?JSON::XS#JSON_and_ECMAscript](http://search.cpan.org/perldoc?JSON::XS#JSON_and_ECMAscript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T11:35:38.220

从概念上讲，您只能通过适当的转义从服务器发送有效的 JavaScript 文字字符串。

如果你想在客户端解决这个问题，你需要一个额外的解决步骤（似乎只在 Firefox 中有效）：

```
var a = escape("Each of the levels requires logic, skill, and brute force to crush the enemy.");
alert(unescape(a)); 
```

**但是讨论已经过时了，因为你必须在服务器上逃跑。**

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-03T02:30:16.413

避免使用`eval`解析 JSON。

使用[`JSON.parse`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)或[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)。

```
JSON.parse('{}');  // where {} is your JSON String 
```

# ruby-on-rails - Rails 应用在 Heroku 中启动非常缓慢

> ID：10020227
> 
> 赞同：4
> 
> 时间：2012-04-04T22:35:19.143
> 
> 标签：ruby-on-rails, heroku

我有一个托管在 Heroku 中的 Rails 应用程序。如果我第一次访问该网站，启动应用程序需要 10 多秒。之后，一切正常且快速。

我应该怎么做才能提高首次加载？我应该添加更多的 Web Dynos，还是更多的 Worker Dynos，或者对我的配置做些什么？

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-04T22:44:12.920

如果您使用的是免费的 Heroku 1 dyno 设置，那么 dyno 将在 1 小时不活动后关闭。

如果您为 1 个或更多额外的 dynos 付费，那么你们中的任何一个 dynos 都不会结束，并且您只会在推送新版本时面临启动时间。

您可以选择安装免费的 New Relic 插件，并且可以将其设置为每 2 分钟 ping 您的应用程序。这将阻止它向下旋转。[http://addons.heroku.com/newrelic](http://addons.heroku.com/newrelic)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:41:18.253

如果您的应用程序处于非活动状态一段时间，Heroku 会从内存中卸载它。请参阅此答案以获取一些建议：[为什么我的基本 Heroku 应用程序需要两秒钟才能加载？](https://stackoverflow.com/questions/2606190/why-are-my-basic-heroku-apps-taking-2-seconds-to-load)

# ruby - 将 unicode 字符与 unicode 字符范围进行比较时的异常行为

> ID：10020230
> 
> 赞同：3
> 
> 时间：2012-04-04T22:35:47.670
> 
> 标签：ruby

出于某种原因，我在 unicode 字符的范围比较中得到了意想不到的结果。

总而言之，在我最小化的测试代码中，`("\u1000".."\u1200") === "\u1100"`is 是`false`我期望的——而针对的`true`相同测试与预期的一样。我觉得这完全无法理解。运算符的结果也很有趣——它们相互矛盾。`"\u1001"``true``<``===`

以下代码是一个很好的最小说明：

```
# encoding: utf-8

require 'pp'

a = "\u1000"
b = "\u1200"

r = (a..b)

x = "\u1001"
y = "\u1100"

pp a, b, r, x, y

puts "a < x = #{a < x}"
puts "b > x = #{b > x}"

puts "a < y = #{a < y}"
puts "b > y = #{b > y}"

puts "r === x = #{r === x}"
puts "r === y = #{r === y}" 
```

我天真地期望这两种`===`操作都会在这里产生“真实”。然而，运行这个程序的实际输出是：

```
ruby 1.9.3p125 (2012-02-16 revision 34643) [x86_64-darwin11.3.0]
"\u1000"
"\u1200"
"\u1000".."\u1200"
"\u1001"
"\u1100"
a < x = true
b > x = true
a < y = true
b > y = true
r === x = true
r === y = false 
```

有人可以启发我吗？

（注意我在 Mac OS X 上使用 1.9.3，并且我明确地将编码设置为 utf-8。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:41:43.800

行动：我已将此行为作为[错误 #6258 提交给 ruby​​-lang](http://bugs.ruby-lang.org/issues/6258)。

该字符范围内的整理顺序有些奇怪

```
irb(main):081:0> r.to_a.last.ord.to_s(16)
=> "1036"
irb(main):082:0> r.to_a.last.succ.ord.to_s(16)
=> "1000"
irb(main):083:0> r.min.ord.to_s(16)
=> "1000"
irb(main):084:0> r.max.ord.to_s(16)
=> "1200" 
```

范围的最小值和最大值是您输入的预期值，但如果我们将范围转换为数组，则最后一个元素是“\u1036”，它的后继元素是“\u1000”。在幕后， Range#=== 必须枚举[String#succ](http://ruby-doc.org/core-1.9.3/String.html#method-i-succ)序列，而不是对 min 和 max 进行简单的边界检查。

如果我们查看[Range#===](http://www.ruby-doc.org/core-1.9.3/Range.html#method-i-3D-3D-3D)的源代码（单击切换），我们会看到它调度到[Range#include?](http://www.ruby-doc.org/core-1.9.3/Range.html#method-i-include-3F) . 范围#包括？source 显示了对字符串的特殊处理——如果答案可以单独由字符串长度确定，或者所有 invloved 字符串都是 ASCII，我们得到简单的边界检查，否则我们分派给 super，这意味着 #include? 得到[Enumerable#include 的回答？](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-include-3F)它使用[Range#each](http://www.ruby-doc.org/core-1.9.3/Range.html#method-i-each)进行枚举，它再次对字符串进行特殊处理，并分派给使用[String#succ](http://ruby-doc.org/core-1.9.3/String.html#method-i-succ)枚举的[String#upto](http://ruby-doc.org/core-1.9.3/String.html#method-i-upto)。

[当字符串包含 is_alpha 或 is_digit 数字（对于U+1036](http://www.fileformat.info/info/unicode/char/1036/index.htm)不应为真）时，String#succ 有一堆特殊处理，否则它会使用`enc_succ_char`. 在这一点上，我失去了踪迹，但大概这会使用与字符串关联的编码和整理信息来计算后继者。

顺便说一句，作为一种解决方法，如果您只关心单个字符，您可以使用一系列整数序数并针对序数进行测试。例如：

```
r = (a.ord..b.ord)
r === x.ord
r === y.ord 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:17:10.480

看起来范围并不意味着我们认为它意味着什么。

我认为正在发生的是您正在创建的是一个试图包含字母、数字和标点符号的 Range。Ruby 无法做到这一点，并且不“理解”您本质上想要一个代码点数组。

这导致 Range#to_a 方法分崩离析：

```
("\u1000".."\u1099").to_a.size  #=> 55
("\u1100".."\u1199").to_a.size  #=> 154
("\u1200".."\u1299").to_a.size  #=> 73 
```

当您将所有三个放在一起时，最重要的是：

```
("\u1000".."\u1299").to_a.size  #=> 55 
```

Ruby 1.8.7 按预期工作——正如马特在评论中指出的那样，“\u1000”只是文字“u1000”，因为没有 Unicode。

string#succ C 源代码不仅返回下一个代码点：

```
Returns the successor to <i>str</i>. The successor is calculated by                                                                                                                                                                                                          
incrementing characters starting from the rightmost alphanumeric (or                                                                                                                                                                                                         
the rightmost character if there are no alphanumerics) in the                                                                                                                                                                                                                
string. Incrementing a digit always results in another digit, and                                                                                                                                                                                                            
incrementing a letter results in another letter of the same case.                                                                                                                                                                                                            
Incrementing nonalphanumerics uses the underlying character set's                                                                                                                                                                                                            
collating sequence. 
```

Range 正在做一些不同于下一个、下一个、下一个的事情。

具有这些字符的范围执行 ACSII 序列：

```
('8'..'A').to_a
=> ["8", "9", ":", ";", "<", "=", ">", "?", "@", "A"] 
```

但是使用#succ 完全不同：

```
'8'.succ
=> '9'

'9'.succ
=> '10'  # if we were in a Range.to_a, this would be ":" 
```

# c++ - 使用 Cmake 链接 libusb 时遇到问题

> ID：10020231
> 
> 赞同：2
> 
> 时间：2012-04-04T22:35:56.150
> 
> 标签：c++, linux, g++, cmake, libusb

我一直在尝试将 2 个程序“破解”在一起，其中一个（openTLD）使用 cmake。我一直在阅读并研究这个问题一段时间，但似乎无法对其进行排序。

当我“制作”没有 cpp 对象实例化的地方时，它编译得很好，当我有一个我入侵的对象（依赖于 libusb）时，我得到了链接（我认为）错误。

我的 CMakeLists（添加的位由 ** 或 CAPS 分隔）

```
#Set minimum version requered
cmake_minimum_required(VERSION 2.4.6)
#just to avoid the warning
if(COMMAND cmake_policy)
 cmake_policy(SET CMP0003 NEW)
endif(COMMAND cmake_policy)
#set project name
project(TLD)
#Append path to the module path
list(APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR})
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/../cmake/Modules/")
#OpenCV
find_package(OpenCV REQUIRED)

#** ADDED **
find_package(libusb-1.0 REQUIRED)

#set the default path for built executables to the "bin" directory
set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/../bin)
#set the default path for built libraries to the "lib" directory
set(LIBRARY_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/../lib)
#set the include directories **CHANGED** added libusb
include_directories (${PROJECT_SOURCE_DIR}/../include   ${LIBUSB_1_INCLUDE_DIRS}                ${OpenCV_INCLUDE_DIRS})

#** ADDED **
SET(CMAKE_CXX_FLAGS "-lusb-1.0")

#libraries
add_library(tld_utils tld_utils.cpp)
add_library(LKTracker LKTracker.cpp)
add_library(ferNN FerNNClassifier.cpp)
add_library(tld TLD.cpp)

# **CHANGED** THIS CLASS COMPILES
add_library(servo servo.cpp)

#executables
# ** WHEN I TRY TO ISTANTIATE 'SERVO' IN 'tld.cpp' THAT IS ISTANTIATED THIS CLASS I GET     PROBLEMS
add_executable(run_tld run_tld.cpp)

#link the libraries **CHANGED** added servo and libusb
target_link_libraries(run_tld tld LKTracker ferNN tld_utils servo ${libusb-1.0__LIBS}     ${OpenCV_LIBS})
#set optimization level 
set(CMAKE_BUILD_TYPE Release) 
```

终端的输出是：

```
lewis@lewis-desktop:~/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/build$ cmake ../src/
-- The C compiler identification is GNU
-- The CXX compiler identification is GNU
-- Check for working C compiler: /usr/bin/gcc
-- Check for working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Found libusb-1.0:
--  - Includes: /usr/include/libusb-1.0
--  - Libraries: /usr/lib/x86_64-linux-gnu/libusb-1.0.so
-- Configuring done
-- Generating done
-- Build files have been written to: /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/build
lewis@lewis-desktop:~/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/build$ make
Scanning dependencies of target LKTracker
[ 16%] Building CXX object CMakeFiles/LKTracker.dir/LKTracker.o
Linking CXX static library /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libLKTracker.a
[ 16%] Built target LKTracker
Scanning dependencies of target ferNN
[ 33%] Building CXX object CMakeFiles/ferNN.dir/FerNNClassifier.o
Linking CXX static library /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libferNN.a
[ 33%] Built target ferNN
Scanning dependencies of target tld_utils
[ 50%] Building CXX object CMakeFiles/tld_utils.dir/tld_utils.o
Linking CXX static library /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libtld_utils.a
[ 50%] Built target tld_utils
Scanning dependencies of target servo
[ 66%] Building CXX object CMakeFiles/servo.dir/servo.o
Linking CXX static library /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libservo.a
[ 66%] Built target servo
Scanning dependencies of target tld
[ 83%] Building CXX object CMakeFiles/tld.dir/TLD.o
Linking CXX static library /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libtld.a
[ 83%] Built target tld
Scanning dependencies of target run_tld
[100%] Building CXX object CMakeFiles/run_tld.dir/run_tld.o
Linking CXX executable /home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/bin/run_tld
/home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libservo.a(servo.o): In function `servo::servo()':
servo.cpp:(.text+0xa): undefined reference to `libusb_init'
servo.cpp:(.text+0x1b): undefined reference to `libusb_get_device_list'
/home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libservo.a(servo.o): In function `servo::deviceMatchesVendorProduct(libusb_device*, unsigned short, unsigned short)':
servo.cpp:(.text+0x49): undefined reference to `libusb_get_device_descriptor'
/home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/lib/libservo.a(servo.o): In function `servo::setTarget(int)':
servo.cpp:(.text+0xc1): undefined reference to `libusb_get_device_descriptor'
servo.cpp:(.text+0xe3): undefined reference to `libusb_get_device_descriptor'
servo.cpp:(.text+0x105): undefined reference to `libusb_get_device_descriptor'
servo.cpp:(.text+0x143): undefined reference to `libusb_get_device_descriptor'
servo.cpp:(.text+0x170): undefined reference to `libusb_open'
servo.cpp:(.text+0x19c): undefined reference to `libusb_control_transfer'
servo.cpp:(.text+0x1a6): undefined reference to `libusb_close'
servo.cpp:(.text+0x1c2): undefined reference to `libusb_free_device_list'
servo.cpp:(.text+0x1ce): undefined reference to `libusb_exit'
collect2: ld returned 1 exit status
make[2]: *** [/home/lewis/Desktop/mcleanlewis-OPENTLD_blackbox-ce389c3/bin/run_tld] Error 1
make[1]: *** [CMakeFiles/run_tld.dir/all] Error 2
make: *** [all] Error 2 
```

我的servo.cpp文件以防它出现问题（我不是cpp程序员，它被一起破解了）

```
#include <iostream>
#include <libusb-1.0/libusb.h>
#include "protocol.h"
#include "servo.h"

using namespace std;

 int count=0;
const unsigned short vendorId = 0x1ffb;
    unsigned short productIDArray[]={0x0089, 0x008a, 0x008b, 0x008c};
    libusb_context *ctx=0;
    libusb_device **device_list=0;

servo::servo(){
    libusb_init(&ctx);
    count=libusb_get_device_list(ctx, &device_list);
}

bool servo::deviceMatchesVendorProduct(libusb_device *device, unsigned short idVendor, unsigned short idProduct)
{
    libusb_device_descriptor desc;
    libusb_get_device_descriptor(device, &desc);
    return idVendor == desc.idVendor && idProduct == desc.idProduct;
}

void servo::setTarget(int position)
{
    for(int i=0;i<count;i++)
    {
        libusb_device *device=device_list[i];
        {
            for(int Id=0;Id<4;Id++)
            {
                if(deviceMatchesVendorProduct(device, vendorId, productIDArray[Id]))
                {
                    libusb_device_handle *device_handle;
                    libusb_open(device, &device_handle);
                    libusb_control_transfer(device_handle, 0x40, REQUEST_SET_TARGET, position*4, 0, 0, 0, (ushort)5000);
                    libusb_close(device_handle);
                    break;
                }
            }
        }
    }
    libusb_free_device_list(device_list, 0);
    libusb_exit(ctx);
} 
```

感谢您的任何帮助或指点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:47:09.443

这确实是一个链接器错误。看起来您可能为 libusb-1.0 库设置了错误的变量。尝试将您的`target_link_libraries`命令更改为：

```
target_link_libraries(run_tld tld LKTracker ferNN tld_utils servo ${LIBUSB_1_LIBRARIES} ${OpenCV_LIBS}) 
```

您可能还应该删除`SET(CMAKE_CXX_FLAGS "-lusb-1.0")`，因为链接将由`target_link_libraries`命令处理。

# django - django 和 direct_to_template 中的 url 模板标签

> ID：10020233
> 
> 赞同：0
> 
> 时间：2012-04-04T22:36:02.530
> 
> 标签：django, django-templates

我想`url`在 django 中使用 templatetag，但我要解析的 url 与通过 direct_to_template 呈现的内容相关联，因此我没有要传递给`url`. 在任何情况下都可以使用它，还是应该创建一个简单的视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:42:22.387

如果您在 urlconf 中命名 URL，则可以将其与`url`模板标签一起使用。在您的 urlconf 中：

```
urlpatterns += patterns('',
    url(
        r'^whatever/your/url/pattern/is/$',
        direct_to_template,
        { 'template': 'wherever/your/template/is.html' },
        name='name-of-url'
    ),
) 
```

在您的模板中：

```
{% url name-of-url %} 
```

这在 Django 文档中的[命名 URL 模式中有所介绍。](https://docs.djangoproject.com/en/dev/topics/http/urls/#id2)

# haskell - 如何知道表面上纯粹的 Haskell 接口何时隐藏了不安全的操作？

> ID：10020234
> 
> 赞同：7
> 
> 时间：2012-04-04T22:36:12.597
> 
> 标签：haskell, purely-functional, unsafe-perform-io

我最近一直在阅读`unsafePerformIO`，我想问你一些事情。我对真实语言应该能够与外部环境进行交互这一事实感到满意，因此`unsafePerformIO`在某种程度上是合理的。

但是，据我所知，我不知道有任何快速方法可以在不检查代码以搜索调用的情况下知道明显纯的（从类型判断）接口/库是否真的纯`unsafePerformIO`（文档可以省略提一下）。我知道只有在您确定可以保证引用透明度时才应该使用它，但我还是想知道它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T22:40:11.037

不检查源代码就没有办法。但这并不太难，因为 Haddock 提供了一个很好的链接，直接指向文档中的语法高亮定义。有关示例，请参见[本页](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Unique.html)定义右侧的“来源”链接。

[Safe Haskell](http://www.haskell.org/ghc/docs/latest/html/users_guide/safe-haskell.html)在这里是相关的；它用于在您希望禁止使用不安全功能的情况下编译 Haskell 代码。如果一个模块使用了一个不安全的模块（例如`System.IO.Unsafe`）并且没有特别标记为`Trustworthy`，它将继承其不安全状态。但是使用的模块`unsafePerformIO`通常会安全地使用它，从而声明自己`Trustworthy`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-04T22:41:44.553

在您认为的情况下，使用`unsafePerformIO`是不合理的。的[文档`unsafePerformIO`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/System-IO-Unsafe.html#v:unsafePerformIO)解释了这一点：它仅适用于实现者可以证明没有办法破坏**引用透明性**的情况，即“纯功能”语义。即，如果有人`unsafePerformIO`以纯函数式程序可以检测到的方式使用（例如，编写一个其结果不仅仅取决于其参数的函数），那么这是一种不允许的用法。

如果你遇到这样的情况，最有可能的是你发现了一个错误。

# android - 如何获取每个已安装应用程序/包的供应商名称？

> ID：10020237
> 
> 赞同：0
> 
> 时间：2012-04-04T22:36:19.277
> 
> 标签：android

我正在为 Android 编写一个应用程序，它会获取所有已安装应用程序及其详细信息的列表。我得到了我需要的大部分东西：

```
context.getPackageManager().getInstalledPackages(0); 
```

我似乎无法弄清楚在哪里可以获得创建包/应用程序的供应商的名称或 ID。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:53:27.470

我认为没有任何方法可以以编程方式访问该信息。事实上，我不认为供应商的名称存储在任何地方的 apk 文件中。在市场中显示为“开发者”的名称是与上传应用程序的 google 帐户关联的名称。我认为这个值是由市场基础设施存储的，而不是应用程序本身。不幸的是，目前没有授予访问市场数据的公共 API。

如果您不一定关心实际的人类可读名称，并且您的目标只是能够以编程方式判断设备是否具有来自同一开发人员的多个应用程序，您可以从PackageInfo 对象内的[签名](http://developer.android.com/reference/android/content/pm/PackageInfo.html#signatures)字段中收集到这一点，您可以虽然我对此的`pm.getPackageInfo(String packageName, int flags);`经验很少，但我可能是不正确的。

# javascript - 如何让事件使用 event.stopPropagation()？

> ID：10020239
> 
> 赞同：3
> 
> 时间：2012-04-04T22:36:22.130
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我正在为 Google Maps API V3使用[Markercluster 插件。](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js)当用户单击群集图标时，我想访问单击事件。我能到的最接近的是

**JS代码**

```
google.maps.event.addListener(mc, "clusterclick", function (cluster) {
    event.stopPropagation();
}); 
```

**问题：** `event.stopPropagation()`仅在 Chrome 中有效，在 Firefox 或 IE 中无效。它只有在传递一个`event`对象作为参数添加到函数时才能工作，如下所示：

```
$("#div").click(function(event) { 
    event.stopPropagation();
} 
```

但是，我不知道 MarkerClusterer 创建的集群图标的 DOM 元素，所以我无法选择它！我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T22:55:03.200

~~见这里：[https ://developers.google.com/maps/documentation/javascript/events#EventArguments](https://developers.google.com/maps/documentation/javascript/events#EventArguments)~~

 ~~> google.maps.event.addListener(map, 'click', function(event) { placeMarker(event.latLng); });~~ 

事件回调的第一个参数是事件对象。在您的情况下，它将是：

```
google.maps.event.addListener(mc, "clusterclick", function (cluster) {     
    cluster.stopPropagation();     
}); 
```

 ~~由于这是一个自定义事件并且程序员没有将事件对象作为参数传递，您的解决方案是自己实现它：

**来自[http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/markerclustererplus/src/markerclusterer.js?r=362的](http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/markerclustererplus/src/markerclusterer.js?r=362)**第 150 和 151 行**：**

 ****从：**

```
google.maps.event.trigger(mc, "click", cClusterIcon.cluster_);
google.maps.event.trigger(mc, "clusterclick", cClusterIcon.cluster_); // deprecated name 
```

**至：**

```
google.maps.event.trigger(mc, "click", e, cClusterIcon.cluster_);
google.maps.event.trigger(mc, "clusterclick", e, cClusterIcon.cluster_); // deprecated name 
```

注意`e`作为第三个参数。**这是在第 139**行调用这 2 行的原始事件中的事件对象：

```
google.maps.event.addDomListener(this.div_, "click", function (e) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:40:00.000

您可以尝试使用`return false;`. 尽管这都停止了事件冒泡以及默认行为。所以我不知道你是否可以在你的具体情况下使用它。

**更新**

[`clusterclick`事件已弃用](http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/markerclustererplus/src/markerclusterer.js?r=362#151)。您应该使用该`click`事件。

您是否已经尝试过做`.stopPropagtion`and `.cancelBubble = true`？**~~

# basic - 为什么我的 BASIC 项目会出现“意外 <”错误？

> ID：10020240
> 
> 赞同：2
> 
> 时间：2012-04-04T22:36:23.553
> 
> 标签：basic, gambas

```
' Gambas class file
' Math Drill by William Teder. Feel free to use parts of the code, but please give me credit.
' Declare Variables
' Define number of times user has pressed the Give Up button
PRIVATE givenuptimes AS Integer
' Define how many questions the user has answered
PRIVATE questionsanswered AS Integer
' Define what level the user is on
PRIVATE level AS Integer
' Define the number of points the user has
PRIVATE points AS Integer
' Define whether ot not addition, subtraction, multiplication, and division are enabled. This value is changed whrn the textboxes are togglrd.
PRIVATE additionenabled AS Boolean
PRIVATE subtractionenabled AS Boolean
PRIVATE multiplicationenabled AS Boolean
PRIVATE divisionenabled AS Boolean
'Set an integer for counting the number of times the program resets, for use in email.
PRIVATE resetcount AS Integer
' Define variable to help in detrmining the problem type
PRIVATE problemtype AS Integer
' Define number of numbers to add when using an addition problem
PRIVATE currentproblem AS String
PRIVATE currentanswer AS String
PRIVATE currentproblempointvalue AS Integer
PRIVATE add1 AS Integer
PRIVATE add2 AS Integer
PUBLIC SUB Form_Open()
'Set inital values

givenuptimes = 0
questionsanswered = 0
level = 1
points = 0
additionenabled = TRUE
subtractionenabled = TRUE
multiplicationenabled = TRUE
divisionenabled = TRUE
' GET RID OF THE FOLLOWING LINE WHEN USED IN BUILDING OR THE PROGRAM WILL NOT WORK!
' currentanswer = 0
makeproblem()

END

PUBLIC SUB btnClearAnswer_Click()
 'clear the contents of txtAnswer and give it the focus
  txtAnswer.Text = ""
  txtAnswer.SetFocus
END

PUBLIC SUB chkGiveUp_Click()

  ' Check to see if the Give Up button's visible property is set to true, and if it is, hide the button. If it is hidden, show it again.

IF btnGiveUp.Visible = FALSE THEN 
  btnGiveUp.visible = TRUE
      lblhGiveUp.visible = TRUE
  lblGivenUp.visible = TRUE
  expSettings.Raise
    RETURN 
END IF

IF btnClearAnswer.Visible THEN
  btnGiveUp.Visible = FALSE
    lblGivenUp.Visible = FALSE
      lblhGiveUp.Visible = FALSE
        expSettings.Raise
  RETURN  
END IF

END

PUBLIC SUB btnGiveUp_Click()
'Increment the counter that shows the number pf times the user has given up by 1
  givenuptimes = givenuptimes + 1
  lblGivenUp.Text = givenuptimes
  'Display the right answer
  txtAnswer.Text = currentanswer
  WAIT 2
  txtAnswer.Text = ""
  points = points - 10
  lblPoints.Text = points
  makeproblem()

END

PUBLIC SUB chkLevels_Click()

  ' Check to see if the Level label's visible property is set to true, and if it is, hide the label. If it is hidden, show it again.

IF lblLevel.Visible = FALSE THEN 
  lblhLevel.Visible = TRUE
      lblLevel.visible = TRUE
          'Move the answered section down one place, if it is not already
    lblhAnswered.Top = 150
    lblAnswered.Top = 143
      'For some odd reason, when the new objects appear they move themselves forward. Re-lowering the Settings container fixes this.
          IF lblGivenUp.Visible = FALSE OR lblAnswered.Visible = TRUE THEN

        lblhGiveUp.Top = 200
    lblGivenUp.Top = 193
    END IF
  expSettings.Raise
    RETURN 
END IF

IF lblLevel.Visible THEN
  lblLevel.Visible = FALSE
    lblhLevel.Visible = FALSE
    'Move the answered section up one place
    lblhAnswered.Top = 105
    lblAnswered.Top = 98
    'Check to see if the GiveUp section needs to be moved
    IF lblGivenUp.Visible = TRUE AND lblhLevel.Visible = FALSE THEN

        lblhGiveUp.Top = 150
    lblGivenUp.Top = 143
    END IF
        'See above comment
        expSettings.Raise
  RETURN  
END IF

END

PUBLIC SUB btnReset_Click()
' Notify user the program is working 
lblProblem.Text = "Resetting, please wait..."
'First, reset variables
givenuptimes = 0
questionsanswered = 0
level = 1
points = 0
'Clear the answer textbox.
txtAnswer.Text = ""
'Next, clear interface.
lblAnswered.Text = "0"
lblLevel.Text = "0"
lblPoints.Text = "0"
lblGivenUp.Text = "0"
' Notify user that the reset has finished and that the program is generating a new problem
lblProblem.Text = "Reset complete, generating new problem..."
makeproblem()

END

' These four subs are the same code with different variables. Changes state of variable the checkbox is assigned to, makes it the opposite of it's current state.
PUBLIC SUB chkAddition_Click()
IF divisionenabled = FALSE AND subtractionenabled = FALSE AND multiplicationenabled = FALSE THEN 
PRINT Message("You must select at least one option.")
additionenabled = TRUE
chkAddition.Value = TRUE
RETURN
END IF
' Set the boolean additionenabled to be true or false based on it's current state
  IF additionenabled = TRUE THEN 
  additionenabled = FALSE
  RETURN 
  END IF

  IF additionenabled = FALSE THEN 
  additionenabled = TRUE
  RETURN 
  END IF

END

PUBLIC SUB chkSubtraction_Click()
IF additionenabled = FALSE AND divisionenabled = FALSE AND multiplicationenabled = FALSE THEN 
PRINT Message("You must select at least one option.")
subtractionenabled = TRUE
chkSubtraction.Value = TRUE
RETURN
END IF
  ' Set the boolean subtractionenabled to be true or false based on it's current state
  IF subtractionenabled = TRUE THEN 
  subtractionenabled = FALSE
  RETURN 
  END IF

  IF subtractionenabled = FALSE THEN 
  subtractionenabled = TRUE
  RETURN 
  END IF

END

PUBLIC SUB chkMultiplication_Click()
IF additionenabled = FALSE AND subtractionenabled = FALSE AND divisionenabled = FALSE THEN 
PRINT Message("You must select at least one option.")
multiplicationenabled = TRUE
chkMultiplication.Value = TRUE
RETURN
END IF
  ' Set the boolean multiplicationenabled to be true or false based on it's current state
  IF multiplicationenabled = TRUE THEN 
  multiplicationenabled = FALSE
  RETURN 
  END IF

  IF multiplicationenabled = FALSE THEN 
  multiplicationenabled = TRUE
  RETURN 
  END IF

END

PUBLIC SUB chkDivision_Click()

IF additionenabled = FALSE AND subtractionenabled = FALSE AND multiplicationenabled = FALSE THEN 
PRINT Message("You must select at least one option.")
divisionenabled = TRUE
chkDivision.Value = TRUE
RETURN
END IF
  ' Set the boolean divisionenabled to be true or false based on it's current state
  IF divisionenabled = TRUE THEN 
  divisionenabled = FALSE
  RETURN 
  END IF

  IF divisionenabled = FALSE THEN 
  divisionenabled = TRUE
  RETURN 
  END IF

END

' Subroutine to make a problem
SUB makeproblem()
' This is the code that determines a new problem for the user based on a number of factors, including how many problems of that type they have done,
' whether or not the type is enabled or disabled, how quickly they can answer the question, thier points and level, and how many times they have
' given up on that type of problem. The rest is random. DO NOT MESS WITH THIS CODE UNLESS YOU KNOW WHAT YOU ARE DOING! It is very easy to mess up the program,
' as well as generate stack overflow errors.
' Engine version : 0.0.0.1
' Engine by William Teder
'  ------------------------------------
' Generates a random number for the Problem Type, 1 - 4
problemtype = Rnd(1, 5)
IF problemtype = 1 THEN 
' Problem Type: Addition
lblProblem.Text = "Problem Type: Addition"
' Determine the number of numbers to add together
IF level <= 5 THEN 
' Determine how high the number should be
IF points <= 200 THEN 
add1 = Rnd(1, 10)
add2 = Rnd(1, 10)
currentanswer = add1 + add2
currentproblem = add2 & " + " & add1
lblProblem.Text = currentproblem
RETURN
END IF
IF points > 200 AND < 400 THEN 
add1 = Rnd(1, 20)
add2 = Rnd(1, 20)
add1 + add2 = currentanswer
currentproblem = add2 & " + " & add1
lblProblem.Text = currentproblem
RETURN
END IF
IF points > 400 AND < 500 THEN 
add1 = Rnd(1, 30)
add2 = Rnd(1, 30)
add1 + add2 = currentanswer
currentproblem = add2 & " + " & add1
lblProblem.Text = currentproblem
RETURN
END IF
END IF
IF level <= 10 AND >= 6 THEN 
' Code for three numbers
END IF
IF level <= 15 AND >= 11 THEN 
'Code for 4 numbers
END IF
IF level <= 20 AND >= 16 THEN 
' Code for 5 numbers
END IF

IF problemtype = 2 THEN 
' Problem Type: Subtraction
lblProblem.Text = "Problem Type: Subtraction"
END IF

IF problemtype = 3 THEN 
' Problem Type: Multiplication
lblProblem.Text = "Problem Type: Multiplication"
END IF

IF problemtype = 4 THEN 
' Problem Type: Division
lblProblem.Text = "Problem Type: Division"
END IF

END

PUBLIC SUB gotright()
  ' Increment questions answered counter
  questionsanswered = questionsanswered + 1
  ' Increment Points
  points = points + currentproblempointvalue
  ' For every 100 points, increment the level counter by 1.
  IF level = 1 AND points = 200 THEN level = 2
  IF level = 2 AND points = 300 THEN level = 3
  IF level = 3 AND points = 400 THEN level = 4
  IF level = 4 AND points = 500 THEN level = 5
  IF level = 5 AND points = 600 THEN level = 6
  IF level = 6 AND points = 700 THEN level = 7 
  IF level = 7 AND points = 800 THEN level = 8
  IF level = 8 AND points = 900 THEN level = 9
  IF level = 9 AND points = 1000 THEN level = 10
  IF level = 10 AND points = 1100 THEN level = 11
  IF level = 11 AND points = 1200 THEN level = 12
  IF level = 12 AND points = 1300 THEN level = 13
  IF level = 13 AND points = 1400 THEN level = 14
  IF level = 14 AND points = 1500 THEN level = 15
  IF level = 15 AND points = 1600 THEN level = 16
  IF level = 16 AND points = 1700 THEN level = 17
  IF level = 17 AND points = 1800 THEN level = 18
  IF level = 18 AND points = 1900 THEN level = 19
  IF level = 19 AND points = 2000 THEN level = 20
  ' Change font color of the textbox to green to let the user know he/she got the problem right
  txtAnswer.Foreground = &H579524&
  ' Create delay to let the user know they got the answer right
  WAIT 1
  ' Change back to regular color
  txtAnswer.Foreground = &HFF004&
END

PUBLIC SUB txtAnswer_KeyRelease()

  IF txtAnswer.Text = currentanswer THEN 
    txtAnswer.Foreground = &H579524&
  questionsanswered = questionsanswered + 1
  lblAnswered.Text = questionsanswered
  WAIT 0.25
  txtAnswer.Text = ""
    ' Change back to regular color
  txtAnswer.Foreground = &HFF0004&
  lblPoints.text = points
  makeproblem()
  END IF

END

PUBLIC SUB Button1_Click()

  makeproblem()

END 
```

在第 251 行，有一个意外的 >。为什么编译失败？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:40:28.990

```
IF points > 400 AND < 500 THEN 
```

这对我来说看起来不太对劲，除非你的 BASIC*真的很*先进（而且[看起来](http://gambasdoc.org/help/cat/expressions)GAMBAS 还没有那么先进）。它应该是：

```
IF points > 400 AND points < 500 THEN 
```

您对这条线有正确的想法，例如：

```
IF lblGivenUp.Visible = TRUE AND lblhLevel.Visible = FALSE THEN 
```

对于您拥有的所有变体都相同，您还需要在右侧包含变量`and`）：

```
IF points > 200 AND < 400 THEN 
IF points > 400 AND < 500 THEN 
IF level <= 10 AND >= 6 THEN 
IF level <= 15 AND >= 11 THEN 
IF level <= 20 AND >= 16 THEN 
```

# f# - 在第三方库中扩展类型以进行序列化

> ID：10020242
> 
> 赞同：1
> 
> 时间：2012-04-04T22:36:34.527
> 
> 标签：f#

我需要一个函数将类型从第三方库转换为`IDictionary`s，以便它们可以轻松序列化（转换为 JSON）。类型之间存在依赖关系，因此字典有时是嵌套的。

现在我有一些像这样可怕的东西：

```
//Example type
type A(name) = 
  member __.Name  = name

//Example type
type B(name, alist) =
  member __.Name = name
  member __.AList : A list = alist

let rec ToSerializable x =
  match box x with
  | :? A as a -> dict ["Name", box a.Name]
  | :? B as b -> dict ["Name", box b.Name; "AList", box (List.map ToSerializable b.AList)]
  | _ -> failwith "wrong type" 
```

这会将所有内容转换为原始类型、`IEnumerable`此类类型或字典。

随着类型的添加，此功能将不断增长（呃）。它不是类型安全的（需要包罗万象的模式）。弄清楚支持哪些类型需要仔细阅读整体模式匹配。

我很想能够做到这一点：

```
type ThirdPartyType with
  member x.ToSerializable() = ...

let inline toSerializable x =
  (^T : (member ToSerializable : unit -> IDictionary<string,obj>) x)

let x = ThirdPartyType() |> toSerializable //type extensions don't satisfy static member constraints 
```

所以，我在这里寻找创意。有没有更好的方法来写这个来解决我的抱怨？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T01:30:29.847

这是解决类型安全问题的一种可能解决方案，但不一定是您的可扩展性问题：

```
// these types can appear in any assemblies
type A = { Name : string }
type B = { Name : string; AList : A list }
type C(name:string) =
    member x.Name = name
    static member Serialize(c:C) = dict ["Name", box c.Name] 
```

```
// all of the following code goes in one place
open System.Collections.Generic

type SerializationFunctions = class end

let inline serializationHelper< ^s, ^t when (^s or ^t) : (static member Serialize : ^t -> IDictionary<string,obj>)> t = 
    ((^s or ^t) : (static member Serialize : ^t -> IDictionary<string,obj>) t)
let inline serialize t = serializationHelper<SerializationFunctions,_> t

// overloads for each type that doesn't define its own Serialize method
type SerializationFunctions with
    static member Serialize (a:A) = dict ["Name", box a.Name]
    static member Serialize (b:B) = dict ["Name", box b.Name; "AList", box (List.map serialize b.AList)]

let d1 = serialize { A.Name = "a" }
let d2 = serialize { B.Name = "b"; AList = [{ A.Name = "a" }]}
let d3 = serialize (C "test") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T01:31:35.727

作为快速n-明显的想法：使用重载

```
//Example type
type A(name) = 
  member __.Name  = name

//Example type
type B(name, alist) =
  member __.Name = name
  member __.AList : A list = alist

type Converter =
    static member ToSerializable(a : A) = dict ["Name", box a.Name]
    static member ToSerializable(b : B) = dict ["Name", box b.Name; "AList", box (b.AList |> List.map Converter.ToSerializable)] 
```

# apache-flex - 来自 mxml 的类图 - flex 文件

> ID：10020244
> 
> 赞同：0
> 
> 时间：2012-04-04T22:36:49.633
> 
> 标签：apache-flex, flex4.5, diagrams

所以我正在为客户构建一个 flex 应用程序，他问我是否可以为他提供类图。我想知道是否有一种简单的方法可以像在 java 中那样使用程序（如 visio 或其他东西）来完成。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:40:34.937

[Grant Skinner 的](http://gskinner.com/) [gModeler](http://www.gskinner.com/gmodeler/)可能很有趣。

引用自 gModeler 网站：

> gModeler 是一个免费的在线 UML 图表和文档工具，面向使用 ECMA 262 语言（如 FlashMX 的 Actionscript 和 Javascript）的开发人员。除了图表功能之外，它还导出 HTML 文档、FlashMX XML 文档（用于操作面板和参考面板）和存根代码（类代码）。

# asp.net-mvc-3 - 在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。

> ID：10020246
> 
> 赞同：0
> 
> 时间：2012-04-04T22:36:59.623
> 
> 标签：asp.net-mvc-3, web-config, forms-authentication

你好

我在 web.config 中添加了表单身份验证标签，之后当我尝试在本地启动 MVC 应用程序时出现此错误。请任何帮助，所有其他帖子都是关于部署应用程序和这个错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T09:32:16.663

这是一个奇怪的错误 - 我有同样的错误 - 但很容易修复。

只需删除 obj 文件夹的内容并重建。达达！

[（我在下面的帖子](https://stackoverflow.com/questions/5161511/mvc3-strange-error-after-switching-on-compilation-of-views)中找到了答案）。

:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:38:24.327

当 obj 文件夹中有 Web 项目输出（模板化的 web.config 或临时发布文件）时，会出现此问题。使用的 ASP.NET 编译器不够智能，无法忽略 obj 文件夹中的内容，因此它会引发错误。

另一个解决方法是在调用 <AspNetCompiler> 之前对发布输出进行核对。打开你的 .csproj 并改变它：

```
<Target Name="MvcBuildViews" AfterTargets="AfterBuild" Condition="'$(MvcBuildViews)'=='true'">
  <AspNetCompiler VirtualPath="temp" PhysicalPath="$(WebProjectOutputDir)" />
</Target> 
```

对此：

```
<Target Name="MvcBuildViews" AfterTargets="AfterBuild" Condition="'$(MvcBuildViews)'=='true'">
  <ItemGroup>
    <ExtraWebConfigs Include="$(BaseIntermediateOutputPath)\**\web.config" />
    <ExtraPackageTmp Include="$([System.IO.Directory]::GetDirectories(&quot;$(BaseIntermediateOutputPath)&quot;, &quot;PackageTmp&quot;, System.IO.SearchOption.AllDirectories))" />
  </ItemGroup>
  <Delete Files="@(ExtraWebConfigs)" />
  <RemoveDir Directories="@(ExtraPackageTmp)" />
  <AspNetCompiler VirtualPath="temp" PhysicalPath="$(WebProjectOutputDir)" />
</Target> 
```

这将删除 \obj 下的所有 web.config，以及 \obj 下的所有 PackageTmp 文件夹。

# c - C 程序：如何使用循环解析 csv 字符串？

> ID：10020248
> 
> 赞同：1
> 
> 时间：2012-04-04T22:37:04.493
> 
> 标签：c

我正在使用带有`-std=c89`开关的 Linux gcc 对 C 进行编程。我有一个存储字符串的变量，例如：

```
10, 1, 2, 3 
```

我在上面的字符串中显示了 4 个整数，但实际数字并不提前知道。如何将这些值提取到整数数组中？例如，我们可以使用上限 8 来分配内存。但实际的整数个数总是 <= 8。

目前，我正在执行以下操作：

```
sscanf(csv_variable, "%i,%i,%i,%i,%i,%i,%i,%i",
&int_variable[0],
&int_variable[1],
&int_variable[2],
&int_variable[3],
&int_variable[4],
&int_variable[5],
&int_variable[6],
&int_variable[7]); 
```

但这适用于具有 8 个整数的输入字符串。希望以某种方式在循环内完成解析，以便它可以容纳任何数字，例如最多 8 个可能的整数（以便它适用于提供少于 8 个整数的情况）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T22:45:29.827

如果您想在循环中执行此操作，您可以使用标记字符串`strtok`

```
char *tok = strtok(csv_variable, ",");
int i = 0;
while(tok != NULL) {
  int_variable[i] = atoi(tok);
  i++;
  tok = strtok(NULL, ",");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:39:56.280

只需检查 return from`sscanf`即可了解成功读取的数量：

```
int values_read = sscanf(csv_variable, "%i,%i,%i,%i,%i,%i,%i,%i",
    &int_variable[0],
    &int_variable[1],
    &int_variable[2],
    &int_variable[3],
    &int_variable[4],
    &int_variable[5],
    &int_variable[6],
    &int_variable[7]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:45:00.093

考虑使用函数 strtok。它需要字符串，一个带有数据，另一个带有分隔符。它返回一个指向令牌的指针，因此您只需循环直到返回 NULL。[在http://www.elook.org/programming/c/strtok.html](http://www.elook.org/programming/c/strtok.html)有一个例子。

您只需将循环更改为有一个计数器，然后索引到您的数组中。您可能还想根据数组中可以容纳的数量检查项目数，以防止数组溢出并覆盖一些内存。

# firefox - 静默打印 + 指定非默认打印机

> ID：10020253
> 
> 赞同：5
> 
> 时间：2012-04-04T22:37:30.090
> 
> 标签：firefox, google-chrome, web-applications, printing

**要求**

Intranet web 应用程序需要每天打印数以亿计的收据。Chrome 或 Firefox 中的静默打印工作正常 --- 考虑这部分已解决。

**美中不足**

因此，我们在 chrome 或 firefox 中使用命令行选项来启用快速静默打印，但这些是常规工作站，而不是 POS。除了收据打印外，他们有常规的网络打印机。

在许多配置中，Firefox 和 Chrome 将使用“最后使用的打印机”，但这是不可靠的，并且在某些配置中不起作用……例如，Linux。Firefox 也不支持更改打印命令甚至指定 print_printer。

**问题**

是否可以在命令行上指定打印机：

例如。，

```
firefox -no-remote -P webapp --print-target receipt 
```

或者 -

```
chrome --kiosk --kiosk-printing receipt 
```

是否有插件、扩展程序或应用程序会强制 FF 或 Chrome 忽略某个配置文件（或站点）的系统默认打印机并使用指定的打印机？

是否有一个greasemonkey脚本来做到这一点？

我们不能依赖 Firefox 或 Chrome 来使用“最后使用的打印机”……有时他们会这样做，有时他们不会。有没有人想出一个骇人听闻的 shell 脚本来做到这一点......正如你所知道的那样，我已经束手无策，绝望了。~~我们会为此付出代价~~[更新：此时你已经为时已晚，我打败了你]。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-27T08:27:56.637

您可以使用FF 的[https://github.com/edabg/jsprintsetup](https://github.com/edabg/jsprintsetup)扩展。

其中的选项包括：setSilentPrint、setPrintersList - 返回可用打印机的逗号分隔列表、setPrinter - 设置当前打印机、getPrinter - 返回当前选定的打印机等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T02:37:56.320

我~~回答的问题在这里~~ **解决了问题**：

[https://superuser.com/questions/406857/debian-firefox-or-iceweasel-default-printer-for-pos-station-web-application](https://superuser.com/questions/406857/debian-firefox-or-iceweasel-default-printer-for-pos-station-web-application)

使用了一个单独的帐户、一些 sudo 魔法和一个共享文件夹。

两个提交的问题都是看待问题的不同方式——但从“必须使用浏览器功能”的角度来看——对可能的解决方案的假设略有不同。换句话说，所以不是完全重复的。

一是：我可以指定应用级打印机默认值吗？

另一个是：我可以通过 cli 选项告诉浏览器实例使用特定的打印机吗？

对两者来说，答案要么是**否定**的，要么被 SEO 污染的谷歌搜索结果所笼罩。

# mysql - InnoDB：与 NULLability 相关的 ALTER TABLE 性能？

> ID：10020258
> 
> 赞同：1
> 
> 时间：2012-04-04T22:37:48.010
> 
> 标签：mysql, innodb

我有一个有 10M 行的表，我正在尝试`ALTER TABLE`添加另一列（a `VARCHAR(80)`）。

从数据建模的角度来看，该列应该是`NOT NULL`- 但运行语句所花费的时间是一个考虑因素，`NULL`如果有必要，可以更改客户端代码以处理列。

我`NULL`尝试添加的列的能力是否会显着影响添加列所需的时间？

**更多信息**

我这样做的上下文是一个 Django 应用程序，由 South 生成迁移 - 添加三个单独的列，并在其中一个新添加的列上添加索引。查看 South 生成的 SQL，它将这个操作（添加三列和一个索引）分布在 15`ALTER TABLE`条语句上——这似乎会使这个操作花费比它应该的更长的时间。

我看到一些参考资料表明 InnoDB 实际上不必在磁盘文件中为可空字段创建字段`NULL`，而只需修改标头中的位字段。这会影响`ALTER TABLE`操作的速度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:47:33.997

我不认为该列的可空性与`ALTER TABLE`. 在大多数更改表操作中，必须（临时）复制整个表（包括所有索引），然后在副本上进行更改。有 1000 万行，这有点慢。来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/alter-table.html)：

> 存储、性能和并发性注意事项
> 
> 在大多数情况下，**`ALTER TABLE`制作原始表的临时副本**。MySQL 等待其他正在修改表的操作，然后继续。它将更改合并到副本中，删除原始表并重命名新表。在`ALTER TABLE`执行时，原始表可由其他会话读取。在操作开始后开始的对表的更新和写入`ALTER TABLE`会停止，直到新表准备好，然后自动重定向到新表，而不会出现任何失败的更新。在新表的数据库目录中创建临时表。对于将表重命名为不同数据库的操作，这可能与原始表的数据库目录`ALTER TABLE`不同。

* * *

如果要对表结构进行多项更改，通常最好在一次`ALTER TABLE`操作中完成。

* * *

允许客户端代码在表中进行更改可能不是最好的主意 - 您已经找到了不允许这样做的一个很好的理由。你为什么需要它？如果您不能这样做，出于性能原因，允许您的客户端代码创建一个表（使用新列和现有表的 PK）而不是添加列可能会更好。

# c++ - 从 wstring 到 SQLCHAR

> ID：10020261
> 
> 赞同：1
> 
> 时间：2012-04-04T22:37:56.070
> 
> 标签：c++, wstring

我需要做的是执行一个 SQL 查询：

```
wstring query = ( L "INSERT INTO database...........; 
```

然后我执行这个：

```
CHECK( SQLExecDirectA( hStmt, query, SQL_NTS ), "execute query" ); 
```

但它不能编译，因为变量查询必须是 SQLCHAR 否则函数 SQLExecDirectA 将不起作用。

有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:20:24.530

您尝试调用的函数称为 SQLExecDirect。（几乎）winapi 中的所有功能都存在于两个版本中——一个 ascii 版本和一个宽版本。根据您的项目设置（多字节字符集/Unicode），SQLExecDirect 是对 SQLExecDirectA 或 SQLExecDirectW 的定义（SQLExecDirectA 是 ascci 版本，SQLExecDirectW 是宽版本）。

SQLExecDirectA 意味着您使用宽字符串作为参数显式调用 ascii 版本。如果要使用宽字符串，请尝试调用 SQLExecDirectW 或 SQLExecDirect。

# jquery - jQuery .load 里面的 .each

> ID：10020262
> 
> 赞同：2
> 
> 时间：2012-04-04T22:38:00.390
> 
> 标签：jquery, load, each

试图搜索这个，虽然我什至不确定我在搜索什么。我的问题是这样的：

```
$.getJSON('process.countfiles.php?action=getfiles', function(data) {
    $.each(data, function(name, value){
        $("#displayfile").load("process.files.php?file="+value, function(){
        });
    });
}); 
```

好的，我有一个带有 2 个函数的脚本 (process.countfiles.php)，1 - 对文件进行计数并在 .dat 文件中构建一个文件列表。然后数字 2 打开 .dat 文件并单独处理文件。

第一部分效果很好，所以让我们转到第二部分......我有从 PHP 传递的数据，如下所示：

PHP代码：

```
$fh = fopen($dirdatafn, "r"); 
    while (!feof($fh)){ 
        $data_file_line[] .= fgets($fh); 
    } 
    @fclose ($fh); 
    echo json_encode($data_file_line); 
```

现在回到 JS（jQuery 是我为此使用的框架）数据是来自 PHP 的 $data_file_line 数组，它可以毫无问题地获取数据，然后它应该开始用 .each 分隔它们

问题是，当我希望它一次处理一个时，它会尝试同时加载所有 7,000 多个并将它们全部发送到 process.files.php。

任何帮助，将不胜感激。

谢谢你，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:55:46.487

`"process.files.php?file="`如果您使用更通用的 $.ajax() 方法而不是 $("selector").load(); ，则可以告诉 jQuery 同步调用

代替

```
$("#displayfile").load("process.files.php?file="+value, function(){
        }); 
```

和

```
$.ajax("process.files.php?file="+value, {
        async: false, // this is true by default
        success: function(data) {
            $("#displayfile").html(data); // this is what you were doing by calling $.load
            // do other stuff
        }
     }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:59:20.253

为您提供 JSON 返回一个数组，您可以执行此操作（我尚未测试过）。基本上要单独处理每个文件，您需要等到成功回调触发，然后再处理下一个文件：

```
 var data_arr;
    $(function() {
        $.getJSON('process.countfiles.php?action=getfiles', function(data) {
            data_arr = data;
            requestFiles(data_arr[0])
        });
        function requestFiles(i) {

            $("#displayfile").load("process.files.php?file=" + data_arr[i], function() {
                if(i < data_arr.length) {
                    requestFiles(i + 1);
                }
            });
        }

    }) 
```

# java - 选择哪个 getConstructor 方法的条件

> ID：10020269
> 
> 赞同：0
> 
> 时间：2012-04-04T22:39:20.693
> 
> 标签：java, choice

我有一个类，我在静态块中初始化了 hashmap。通过密钥，我检索了一个类的值。为了为这个类创建对象。我已经使用构造函数类来获取构造函数并传递参数和创建的对象。

我在哈希图中有两个班级。要为 EchoExpression 创建对象，我需要传递两个参数，而对于 OutExpression 类，我只需要传递一个参数（字符串）。

问题：

根据键返回的类，我需要执行要获取和实现的构造函数，无论是带有一个参数还是两个参数的构造函数。

```
public class ExampleFactory {

  private static HashMap<String,Class<?>> hmap = new HashMap<String,Class<?>>();

  static
  {                   
      hmap.put("echo", EchoExpression.class);         
      hmap.put("Out", OutExpression.class);                       
  }

  public void getExpo(String key,String expression)
  {
    Class aClass =map.get(key);

    //Constructor implementation for OutExpression where only one argument string is passed

    Constructor constructor = aClass.getConstructor(new Class[]{String.class});

    Object object= constructor.newInstance(expression);

    //constructor for passing two arguments string for EchoExpression

    Constructor constructor = aClass.getConstructor(new Class[]{String.class,Class.class});

    Object object= constructor.newInstance(expression, Boolean.class);

    return null;        
  }                
} 
```

如何在不使用 if else 的情况下从值（类）中选择要实现的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:02:40.420

使用枚举并打开它。这是一个可执行存根，没有深入了解示例的反射或语法：

```
package com.trip.test;

import java.util.HashMap;
import java.util.Map;

public class ExampleFactory {

    private static Map<String, Class<?>> hmap = new HashMap<String, Class<?>>();

    static {
        hmap.put("echo", EchoExpression.class);
        hmap.put("Out", OutExpression.class);
    }

    public static void getExpo(String key, String expression) {

        Class aClass = hmap.get(key);

        ClassMappingEnum myType = ClassMappingEnum.getClassMappingEnum(aClass);

        switch (myType) {
        case ECHO_EXPRESSION:{
            System.out.println(aClass.getName());
            // do something
            break;
        }
        case OUT_EXPRESSION:{
            System.out.println(aClass.getName());
            // do something
            break;          
        }
        case UNKNOWN:
        default:
            System.out.println("Bummer: " + aClass.getName());          
        }

    }

    public static void main(String[] args) {
        getExpo("echo", "B");
        getExpo("Out", "B");
    }   
}

enum ClassMappingEnum {
    ECHO_EXPRESSION(EchoExpression.class), OUT_EXPRESSION(OutExpression.class), UNKNOWN(null);

    private Class typeDes;

    private ClassMappingEnum(Class typeDes) {
        this.typeDes = typeDes;
    }

    public static ClassMappingEnum getClassMappingEnum(Class compare) {
        for (ClassMappingEnum cme : ClassMappingEnum.values()) {
            if (cme.typeDes.equals(compare)) {
                return cme;
            }
        }
        return UNKNOWN;
    }

}

class EchoExpression<T> {
    private String someString;
    private Class<T> someClass;
    public EchoExpression(String someString, Class<T> someClass) {
        super();
        this.someString = someString;
        this.someClass = someClass;
    }
    public String getSomeString() {
        return someString;
    }
    public void setSomeString(String someString) {
        this.someString = someString;
    }
    public Class<T> getSomeClass() {
        return someClass;
    }
    public void setSomeClass(Class<T> someClass) {
        this.someClass = someClass;
    }

}

class OutExpression {
    private String someString;

    public OutExpression(String someString) {
        super();
        this.someString = someString;
    }

    public String getSomeString() {
        return someString;
    }

    public void setSomeString(String someString) {
        this.someString = someString;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T22:47:56.190

如果您可以修改类，以便两个构造函数具有相同的签名（以相同的顺序接受相同数量/类型的参数），您可以这样做

```
Constructor constructor = aClass.getConstructor(new Class[]{String.class,Class.class});
Object object= constructor.newInstance(expression, Boolean.class); 
```

两个班级。

这当然意味着现在不需要额外参数的类将不得不在更改之后忽略它之前未使用的传入参数

更新：这是使用工厂类实现该想法的一种可能方法：

```
public interface ObjectFactory
{
  Object create(String expr, Class cls);
}

public class EchoExpressionFactory implements ObjectFactory
{
  public EchoExpression create(String expr, Class cls)
  {
    return new EchoExpression(expr, cls);
  }
}

public class OutExpressionFactory implements ObjectFactory
{
  public OutExpression create(String expr, Class cls)
  {
    return new OutExpression(expr);
  }
}

public class ExampleFactory { 

  private static HashMap<String,ObjectFactory> hmap = new HashMap<String,ObjectFactory>(); 

  static 
  {                    
      hmap.put("echo", new EchoExpressionFactory());          
      hmap.put("Out", new OutExpressionFactory());                        
  } 

  public void getExpo(String key,String expression) 
  { 
    ObjectFactory factory = map.get(key); 

    //Constructor implementation for Expression
    Object object = factory.create(expression); 

    Object object= constructor.newInstance(expression, Boolean.class); 

    return;
  }                 
} 
```

# c# - C#/XNA/HLSL - 如何创建景深？

> ID：10020271
> 
> 赞同：0
> 
> 时间：2012-04-04T22:39:38.033
> 
> 标签：c#, xna, hlsl

我正在尝试创建景深后期处理，但不知道从哪里开始（渲染深度图除外，我目前正在使用它）。它的所有教程要么是针对 XNA3.1，实际上不给你解释，要么是一本书的一部分。

那么，您能否详细介绍一下如何渲染 DOF 的分步过程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T00:36:41.623

这里描述了如何使用 XNA 在 Reach 配置文件中提供的“开箱即用”功能来实现它的基本近似。

一旦你了解了如何在 C# 中使用内置的东西来实现它，在 HLSL 中实现它希望会更加明显。

此外，如果您希望为 Windows Phone 7 制作游戏，您可以从哪里开始（因为 Windows Phone 7 目前不支持自定义着色器）。

首先，我们将定义一些实例级变量来保存我们需要生成外观的点点滴滴：

```
BasicEffect effect;
List<Matrix> projections;
List<RenderTarget2D> renderTargets;
SpriteBatch spriteBatch; 
```

接下来，在 LoadContent() 方法中，我们将开始加载它们。从我们将用于渲染最终场景的 SpriteBatch 开始：

```
spriteBatch = new SpriteBatch(GraphicsDevice); 
```

后面是 BasicEffect 的一个实例：

```
effect = new BasicEffect(GraphicsDevice);
effect.EnableDefaultLighting();
effect.DiffuseColor = Color.White.ToVector3();
effect.View = Matrix.CreateLookAt(
            Vector3.Backward * 9 + Vector3.Up * 9,
            Vector3.Zero,
            Vector3.Up);
effect.World = Matrix.Identity;

effect.Texture = Content.Load<Texture2D>("block");
effect.TextureEnabled = true;
effect.EnableDefaultLighting(); 
```

基本效果如何配置的细节在这里并不重要。仅仅是我们有一个效果来渲染。

接下来我们将需要一些投影矩阵：

```
projections = new List<Matrix>() {
        Matrix.CreatePerspectiveFieldOfView(
        MathHelper.ToRadians(60f),
        GraphicsDevice.Viewport.AspectRatio,
        9f,
        200f),
    Matrix.CreatePerspectiveFieldOfView(
        MathHelper.ToRadians(60f),
        GraphicsDevice.Viewport.AspectRatio,
        7f,
        10f),
    Matrix.CreatePerspectiveFieldOfView(
        MathHelper.ToRadians(60f),
        GraphicsDevice.Viewport.AspectRatio,
        0.2f,
        8f)}; 
```

如果您检查每个投影的最后两个参数，您会注意到我们在这里有效地做的是将世界分割成“块”，每个块覆盖与相机不同的距离范围。

例如，超过 9 个单位的所有内容，距离相机 7 和 10 个单位之间的任何内容，最后是接近 8 个单位的任何内容。

（您需要根据场景调整这些距离。请注意少量重叠）

接下来我们将创建一些渲染目标：

```
var pp = GraphicsDevice.PresentationParameters;

renderTargets = new List<RenderTarget2D>()
{
    new RenderTarget2D(GraphicsDevice,
        GraphicsDevice.Viewport.Width / 8,
        GraphicsDevice.Viewport.Height / 8,
        false, pp.BackBufferFormat, pp.DepthStencilFormat),

        new RenderTarget2D(GraphicsDevice,
        GraphicsDevice.Viewport.Width / 4,
        GraphicsDevice.Viewport.Height / 4,
        false, pp.BackBufferFormat, pp.DepthStencilFormat),

    new RenderTarget2D(GraphicsDevice,
        GraphicsDevice.Viewport.Width,
        GraphicsDevice.Viewport.Height,
        false, pp.BackBufferFormat, pp.DepthStencilFormat),
}; 
```

每个渲染目标对应于前面提到的“块”。为了实现真正简单的模糊效果，每个渲染目标都设置为不同的分辨率，“最远”的块是低分辨率，最近的块是高分辨率。

跳转到 Draw() 方法，我们可以渲染我们的场景块：（确保不要在每个块中渲染背景）

```
 effect.Projection = projections[0];
        GraphicsDevice.SetRenderTarget(renderTargets[0]);
        GraphicsDevice.Clear(Color.Transparent);
        // render scene here

        effect.Projection = projections[1];
        GraphicsDevice.SetRenderTarget(renderTargets[1]);
        GraphicsDevice.Clear(Color.Transparent);
        // render scene here

        effect.Projection = projections[2];
        GraphicsDevice.SetRenderTarget(renderTargets[2]);
        GraphicsDevice.Clear(Color.Transparent);
        // render scene here

        GraphicsDevice.SetRenderTarget(null); 
```

所以现在我们已经有了我们的场景，被距离分解和模糊，剩下的就是将它重新组合在一起以获得我们的最终图像。

第一步，渲染（很棒的）背景：

```
 GraphicsDevice.Clear(Color.CornflowerBlue); 
```

接下来渲染每个块，从更远到最近：

```
 spriteBatch.Begin(
        SpriteSortMode.Deferred, 
        BlendState.AlphaBlend, 
        SamplerState.AnisotropicClamp, 
        null, null);

    spriteBatch.Draw(renderTargets[0], GraphicsDevice.Viewport.Bounds, Color.White);
    spriteBatch.Draw(renderTargets[1], GraphicsDevice.Viewport.Bounds, Color.White);
    spriteBatch.Draw(renderTargets[2], GraphicsDevice.Viewport.Bounds, Color.White);

    spriteBatch.End(); 
```

还有中提琴！尽管在众所周知的边缘有点粗糙，但我们有一个景深的近似值。

现在，如果您打算保持在 Reach 配置文件的范围内，您可以通过以多种分辨率渲染每个块并使用 Additive BlendState 之类的东西将生成的图像组合在一起来改善模糊效果。

另一方面，如果您计划在 HiDef 配置文件中编写自定义着色器，则概念大致相同，只是执行方法发生了变化。

例如，将低分辨率渲染换成更真实的高斯风格模糊……或者……放弃粗粒度的块概念，转向基于深度图的相对细粒度的模糊方法。

# c# - C# 应用程序在对 COM 类的方法调用时崩溃

> ID：10020272
> 
> 赞同：2
> 
> 时间：2012-04-04T22:39:39.063
> 
> 标签：c#, c++, com

我有一个调用 COM 类的 C# Winforms 应用程序。使用 Visual Studio 进行调试时，它会进入 c++ 代码并返回 S_OK 但是当函数返回时，Visual Studio 挂起并且应用程序崩溃。我必须结束 VS 进程上的进程才能停止程序运行。如果我在 Visual Studio 之外运行应用程序，应用程序就会崩溃。

一切正常，我不知道我可能做了什么导致这个问题。

任何帮助表示赞赏。谢谢

Sj

这是接口定义

```
typedef struct
{
    long    ExpiryData
    BSTR    IssuedBy;
} LicenceData;

[
    object,
    uuid (5A734F95-EABE-440B-8B7E-0F73538A24AC), 
    pointer_default(unique),
    helpstring("ILicenceReader Interface"),
]
interface ILicenceReader : IDispatch
{
    HRESULT ReadLicenceFile ([in, out]LicenceData* plicenceData, LPCTSTR filePath);
};

[
    uuid(C2833A21-6586-4648-ABC8-D42BC3225699)      
]
coclass LicenceReader
{
    [default] interface ILicenceReader;
}; 
```

我已经引用了 COM dll 并允许 VS 生成 Interop 和 c# 应用程序中的用法：

```
LicenceData data = new LicenceData();

ILicenceReader reader = new LicenceReader();

reader.ReadLicenceFile(ref data, filePath); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:11:39.057

我敢打赌，COM 子系统正试图解组分配在堆栈上的 BSTR，或者可能使用堆栈上的智能指针分配。

BSTR 必须使用 SysAllocString 分配。这个结果可以按原样返回，因为它不在堆栈上，并且没有任何东西会尝试错误地释放它。

如果您使用智能指针 BSTR 类，例如 CComBSTR 或 _bstr_t，则需要通过 Detach 设置 IssuedBy 成员。CComBSTR::Detach() 将返回指向 BSTR 的指针，并且当 CComBSTR 的本地实例超出范围时不会尝试释放它。

```
plicenceData->IssuedBy = CComBSTR("Some Dude").Detach(); 
```

另一种可能性是您尝试在 COM 类中执行 plicenceData = new plicenceData 之类的操作，覆盖传入的实例。那是行不通的。

最后，COM 函数在完成并返回后失败的唯一原因几乎是由于编组问题。它是您的 C# 代码和被调用的 C++ 之间的层，它试图跨单元转换数据并可能跨进程边界。您需要确保严格遵守 COM 规则，以允许编组完成其工作。

所以，仔细检查你所有的指针。它们是在堆栈上还是在堆上？他们需要在堆上。是否所有 BSTR 都分配得当？使用智能 BSTR 类通常会有很大帮助，但请记住，您不能返回原始成员。按照预期使用这些类。

# ruby - Ruby 的 Marshall 格式架构和 Ruby 版本是否独立？

> ID：10020273
> 
> 赞同：1
> 
> 时间：2012-04-04T22:39:39.627
> 
> 标签：ruby, serialization

我正在考虑使用 Marshall 将对象序列化到缓存中，但我想确保相同的缓存可以跨架构（linux x86、linux x86-64、mac x86-64）和跨 Ruby 版本（1.8.7 , 1.9.3)。我会好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T22:49:20.953

marshal 格式是版本化的，这些版本与 ruby​​ 版本不对应。我相信它也是架构独立的。

碰巧的是，该版本在 1.8.7 中与今天（当前为 4.8）中的版本相同，所以理论上你很高兴。在实践中，我似乎记得一些粗糙的边缘，特别是在字符串周围，在 ruby​​ 1.9 中具有相关的编码，但在 1.8 中没有。

一个缺点是 marshal 可能非常冗长，因为它将所有实例变量转储到一个对象中。例如，对于 ActiveRecord 对象，有一些实例变量只跟踪一些缓存数据。

# android - ProgressDialog 轮不转

> ID：10020277
> 
> 赞同：0
> 
> 时间：2012-04-04T22:40:02.510
> 
> 标签：android, button, android-activity, progressdialog

这是我的按钮活动的代码，我设法添加了一个进度对话框，所以当活动科学技术正在加载它的显示加载时......只是它没有旋转，所以我想知道我做错了什么，也许有人可以寻找我的错误这是代码：

```
package net.thinkbin;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.widget.Button;

public class tutorial1 extends Activity{

private ProgressDialog progressDialog;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tutorial1);

    Button share = (Button) findViewById(R.id.button2);
    share.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
            // TODO Auto-generated method stub
            startActivity(new Intent("net.thinkbin.SHARE"));
            overridePendingTransition(0, 0);
            finish();
        }
    });

    Button menu = (Button) findViewById(R.id.buttonhome);
    menu.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(tutorial1.this, "",   "Loading...");  
            Thread th = new Thread(new Runnable() {
                public void run(){
                    startActivity(new  Intent("net.thinkbin.MENU"));
                    overridePendingTransition(0, 0);
                    progressDialog.dismiss();
                    finish();
                }

            });
            th.start();

        }
    });

    Button culture = (Button) findViewById(R.id.button3);
    culture.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(tutorial1.this, "", "Loading...");  
            Thread th = new Thread(new Runnable() {
                public void run(){
                    startActivity(new   Intent("net.thinkbin.CULTURE"));
                    overridePendingTransition(0, 0);
                    progressDialog.dismiss();
                    finish();
                }

            });
            th.start();

        }
    });

    Button entertainment = (Button) findViewById(R.id.button4);
    entertainment.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(tutorial1.this, "", "Loading...");  
            Thread th = new Thread(new Runnable() {
                public void run(){
                    startActivity(new Intent("net.thinkbin.ENTERTAINMENT"));
                    overridePendingTransition(0, 0);
                    progressDialog.dismiss();
                    finish();
                }

            });
            th.start();

        }
    });

    Button philosophy = (Button) findViewById(R.id.button5);
    philosophy.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(tutorial1.this, "", "Loading...");  
            Thread th = new Thread(new Runnable() {
                public void run(){
                    startActivity(new Intent("net.thinkbin.PHILOSOPHY"));
                    overridePendingTransition(0, 0);
                    progressDialog.dismiss();
                    finish();
                }

            });
            th.start();

        }
    });

    Button sciencetechnology = (Button) findViewById(R.id.button6);
    sciencetechnology.setOnClickListener(new View.OnClickListener() {

                    public void onClick(View v) {
            // TODO Auto-generated method stub
            progressDialog = ProgressDialog.show(tutorial1.this, "", "Loading...");  
            Thread th = new Thread(new Runnable() {
                public void run(){
                    startActivity(new Intent("net.thinkbin.SCIENCETECHNOLOGY"));
                    overridePendingTransition(0, 0);
                    progressDialog.dismiss();
                    finish();

                }

            });

            th.start();

        }
    });

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:52:02.700

我不能确定，但​​我只见过`Handler`或`AsyncTask`曾经运行过一个单独的线程。无论哪种方式，这是一个[在 android 中使用进度条的示例](http://www.mkyong.com/android/android-progress-bar-example/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T13:09:24.637

你目前的做法是非常规的。

要获得 ICS 之前的旋转式动作，您应该调用

```
showDialog(int); 
```

并覆盖

```
onCreateDialog(int); 
```

设置微调器样式。

发布 ICS 他们已经用 FragmentManager 替换了所有这些，所以你应该用它来创建旋转风格的动作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T06:41:31.600

你最好在 Android 中使用 AsynTask 而不是 Thread。

```
Button sciencetechnology = (Button) findViewById(R.id.button6);
sciencetechnology.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {
        // TODO Auto-generated method stub
       UrTask u=new UrTask ();
       u..execute();

    }
}); 
```

**异步任务**

```
public class UrTask extends
        AsyncTask<Void, Void, Void> {

    ProgressDialog pDialog;

    protected void onPreExecute() {
        pDialog = new ProgressDialog(ActivityName.this);
        pDialog.setMessage("Downloading Data...");
        pDialog.setCancelable(false);
        pDialog.show();

    }

    protected Void doInBackground(Void... unused) {

        // Do ur work

        return (null);
    }

    @Override
    protected void onProgressUpdate(Void... values) {
        // TODO Auto-generated method stub
        super.onProgressUpdate(values);
    }

    protected void onPostExecute(Void unused) {
        pDialog.dismiss();
    }

} 
```

# shell - 对文本文件进行排序，（可能的）前导“;” 应该被忽略，但保留在输出中

> ID：10020278
> 
> 赞同：1
> 
> 时间：2012-04-04T22:40:06.187
> 
> 标签：shell, sorting, sed, awk

需要的专家帮助请：

文件 1 ：
;1002 Desc1002
;1001 Desc1001
207 Desc207
205 Desc205
;6 Desc6
2010 Desc2010
;2011 Desc2011

输出应按**数字**排序：

;6 Desc6
205 Desc205
207 Desc207
;1001 Desc1001
;1002 Desc1002
2010 Desc2010
;2011 Desc2011

（如果**字符**排序更容易做到，产生以下输出，哦，好吧......它会做的）

;1001 Desc1001
;1002 Desc1002
2010 Desc2010
;2011 Desc2011
205 Desc205
207 Desc207
;6 Desc6

是否可以在输出中插入**前导零**？所以输出看起来像：

;000006 Desc6
000205 Desc205
000207 Desc207
;001001 Desc1001
;001002 Desc1002
002010 Desc2010
;002011 Desc2011

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:51:23.530

这可能对您有用：

```
sed 's/^;\?\([0-9]*\)/\1\t&/' file | sort -n | sed 's/.*\t//'
;6 Desc6
205 Desc205
207 Desc207
;1001 Desc1001
;1002 Desc1002
2010 Desc2010
;2011 Desc2011 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T22:52:15.143

```
awk -F";" '{print $1 $2 "|" $0}' fileName | sort -n | cut -d"|" -f2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T03:44:51.540

您可以插入前导零并保持`;`播放，如下所示：

`awk '$1 ~ /^;/ ? sub(/^;/, "", $1) && $1 = ";"sprintf( "%06d", $1 ) : $1 = sprintf( "%06d", $1 )' file.txt`

因此，为了给您所需的输出，（如果您不介意连续两次`awk`通话），您可以快速加入 amit_g 的答案：

`awk '$1 ~ /^;/ ? sub(/^;/, "", $1) && $1 = ";"sprintf( "%06d", $1 ) : $1 = sprintf( "%06d", $1 )' file.txt | awk -F";" '{print $1 $2 "|" $0}' | sort -n | cut -d "|" -f 2`

输出：

```
;000006 Desc6
000205 Desc205
000207 Desc207
;001001 Desc1001
;001002 Desc1002
002010 Desc2010
;002011 Desc2011 
```

高温高压

# jquery - 变量分配在函数中不起作用（Ajax，JS）

> ID：10020280
> 
> 赞同：1
> 
> 时间：2012-04-04T22:40:18.400
> 
> 标签：jquery, ajax, asynchronous

我无法理解为什么变量“s_return”不起作用

```
$('.codeinput').change(function() {
var s_return="";        
var to_check=this.value ;

        $.ajax({
  type: "POST",
  url: "check.php",
  data: "code="+to_check}).done(function( msg ) {
    s_return=msg; // msg - variable work fine

});

// here variable "s_return" is unset
this.value=s_return;
}); 
```

我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:42:49.433

```
s_return=msg; 
```

在异步函数中。当服务器响应时，它将被设置。

```
this.value=s_return; 
```

在请求被触发后立即运行。因此 s_return 尚未设置。

你需要这样做：

```
$('.codeinput').change(function() {
    var that = this;
    var s_return="";        
    var to_check=this.value ;

    $.ajax({

      type: "POST",
      url: "check.php",
      data: "code="+to_check

    }).done(function( msg ) {
        that.value=msg;
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:42:42.543

AJAX 调用异步运行。如果你单步执行它，你会看到它`this.value=s_return;`之前执行，所以当你做分配`s_return=msg;`时 s_return 仍然是空的。`this.value=s_return;`

# c++ - 在 SQL Server 和 Oracle 中使用相同的未修改查询连接字符串

> ID：10020284
> 
> 赞同：0
> 
> 时间：2012-04-04T22:40:31.393
> 
> 标签：c++, sql-server, oracle, qt

我有一个程序，它的数据库必须同时支持 Oracle 和 SQL Server。在某些时候，我必须执行一个查询，我想在 select 语句中连接 2 列。

在 SQL Server 中，这是使用 + 运算符完成的

```
select column1 + ' - ' + column2 from mytable 
```

而oracle这是用concat完成的

```
select concat(concat(column1, ' - '), column2) from mytable 
```

我正在寻找一种同时利用它们的方法，因此我的代码对两个数据库都有一个 SQL 查询文字字符串，并且我可以避免需要检查我连接到哪个 DBMS 的丑陋构造。

我的第一直觉是将不同的查询封装到一个存储过程中，这样每个 DBMS 都可以有自己的查询实现，但我无法在 Oracle 中创建像 SQL Server 那样返回记录集的过程。

更新：在 SQL Server 中创建 concat 函数不会使查询与 Oracle 兼容，因为 SQL Server 要求在调用函数时指定所有者：

```
select dbo.concat(dbo.concat(column1), ' - '), column2) from mytable 
```

在 SQL Server 中创建自己的 concat 函数后，我花了一段时间才弄清楚。

另一方面，看起来 Oracle 中的一个函数`SYS_REFCURSOR`不能用简单的方法调用

```
exec myfunction 
```

并像在 SQL Server 中一样返回表。

最后，解决方案是在两个 RDBM 上创建一个名称相同但实现不同的视图，然后我可以`select`在视图上做一个简单的操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:46:59.233

如果您想沿着创建存储过程的路径前进，那么您使用的任何框架都应该能够或多或少透明地处理带有`OUT`参数的 Oracle 存储过程，`SYS_REFCURSOR`并像 SQL Server 存储过程一样调用它这只是一个`SELECT`声明。

```
CREATE OR REPLACE PROCEDURE some_procedure( p_rc OUT sys_refcursor )
AS
BEGIN
  -- You could use the CONCAT function rather than Oracle's string concatenation
  -- operator || but I would prefer the double pipes.
  OPEN p_rc
   FOR SELECT column1 || ' - ' || column2
         FROM myTable;
END; 
```

`CONCAT`或者，您可以在 SQL Server 中定义自己的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:48:49.940

不，谢谢。

正如您所注意到的，字符串连接是在 SQL-Server`+`和 Oracle 中实现的`concat`or `||`。

我会避免在存储过程中进行一些讨厌的字符串操作，而只需在一个实例中创建自己的连接函数，或者在另一个使用相同语法的实例中创建连接函数。可能是 SQL-Server，因此您可以使用`concat`.

另一种方法是通过`+`或`||`取决于您连接到的 RDBMS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:49:42.653

显然，在 SQL Server 2012 中，它们包含了一个 CONCAT() 函数：

[http://msdn.microsoft.com/en-us/library/hh231515.aspx](http://msdn.microsoft.com/en-us/library/hh231515.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T22:52:39.037

如果您尝试创建与数据库无关的应用程序，您应该坚持

1.  坚持使用非常基本的 SQL 并在您的应用程序中执行类似的操作。

2.  为不同的数据库创建不同的抽象。如果您希望从您的应用程序中获得任何类型的扩展，那么这就是您可能需要采取的途径。

    我不会走存储过程路径，你可能可以让它工作，但是一周你会发现你需要支持“数据库 X”，然后你需要在那个数据库中重写你的存储过程为出色地。它是痛苦的秘诀。

# javascript - 防止 ASPX 表单被重命名

> ID：10020287
> 
> 赞同：0
> 
> 时间：2012-04-04T22:40:46.917
> 
> 标签：javascript, asp.net

我有一个 ASPX 页面，其中包含一个表单。该表格已被赋予名称和ID。aspx 页面还有一个与其链接的母版页。

提供页面时，表单的名称和 id 都不同。例如，名称从“uploadForm”更改为“Form1”

表格的动作似乎也发生了变化。

这是什么原因，我该如何预防？

因此，aspx 页面的开头行是：

```
<%@ Page Language="C#" MasterPageFile="~/Modal.Master" AutoEventWireup="true" CodeBehind="UploadPage.aspx.cs" Inherits="WebConnect.UploadPage" %> 
```

表单标签是：

```
<form id="uploadForm" name="uploadForm" enctype="multipart/form-data" action="Upload.ashx" method="post"> 
```

送达时，它显示为：

```
<form id="Form1" action="UploadPage.aspx" method="post"> 
```

* * *

**更新：**这是页面的整个正文：

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <form id="uploadForm" name="uploadForm" enctype="multipart/form-data" action="Upload.ashx" method="post">
        <div>
            File:
            <input id="file1" name="fileField" type="file" />
            <input id="objectID" name="objectID" type="hidden" />
            <input id="fieldID" name="fieldID" type="hidden" />
            <input id="submitType" name="submitType" type="hidden" />
            <progress id="uploadProgress" value="10" max="100" display="none"></progress>
            <button id="Html5Submit" type="button" onclick="AsyncSubmit()">Submit</button>
            <button id="Html4Submit" type="button" onclick= "SyncSubmit()">Submit</button>
        </div>
    </form>
    <div id="Html5Upload">
    </div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:49:26.813

长期以来，渲染控件重命名一直是 ASP.Net 中的一个众所周知的问题，在 WebForms 中您可以做很多事情来防止它发生。`ClientId`但是，您可以通过使用Asp.Net 元素上的属性来修改 JavaScript 搜索元素的方式。

```
var formId = '<%= uploadForm.ClientID %>'; 
```

资料来源：[如何阻止 ASP.NET 更改 ID 以使用 jQuery](https://stackoverflow.com/questions/497802)

在您的 JavaScript 中，只需使用该变量而不是`'uploadForm'`就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:52:00.737

我认为您有嵌套表单，这是不允许的。您看到的第一个表单是*MasterPage*中的表单，第二个表单 uploadForm 被浏览器删除（uploadForm 的结束标记成为 Form1 的结束标记）。

因此，您必须将*uploadForm移到**Form1*表单之外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T05:57:18.630

我认为第一个问题真的是你的意图是什么？我正在尝试关注评论/答案，但我认为这并不明显（但我可能错过了）。

如果您想在回发以外的其他地方提交到同一页面（默认 Web 表单行为）：

*   如果处理是服务器端的，您可以根据`runat="server"`需要拥有任意数量的按钮控件 ( )，每个控件都有自己的[postbackurl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.postbackurl.aspx)
*   如果您想使用服务器端控件进行客户端（Javascript）处理，可以使用@RobRodi 的答案
*   您可以使用标准的 html 按钮（html 按钮，n​​ot `runat="server"`）并完全通过客户端脚本处理其单击事件（与表单操作无关）。

# android - Android - 被驳回的电话是什么样的？

> ID：10020288
> 
> 赞同：0
> 
> 时间：2012-04-04T22:40:52.660
> 
> 标签：android

我希望我的应用程序能够判断是否有未接来电，或者只是被解雇（当有来电时点击红色结束按钮）。

我是否使用 CallLog.Calls NEW 常量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:41:13.287

在您的清单文件中添加：

```
<uses-permission android:name="android.permission.READ_CONTACTS" /> 
```

并在您的活动中添加：

```
Uri allCalls = Uri.parse("content://call_log/calls");

Cursor c = getContentResolver().query(allCalls, null,
                CallLog.Calls.NEW + " = ?", new String[] { "1" }, null);
c.moveToFirst();

String num= c.getString(c.getColumnIndex(CallLog.Calls.NUMBER));
String name= c.getString(c.getColumnIndex(CallLog.Calls.CACHED_NAME));
String duration = c.getString(c.getColumnIndex(CallLog.Calls.DURATION));
String type = c.getString(c.getColumnIndex(CallLog.Calls.TYPE));

Log.d("num", num);
Log.d("name", name);
Log.d("duration", duration);
Log.d("type", type); 
```

# jquery - 终于找到了一个 Jquery 滚动到 div(!)... 现在添加缓动...？

> ID：10020289
> 
> 赞同：1
> 
> 时间：2012-04-04T22:41:17.917
> 
> 标签：jquery

[http://subzerostudio.com/temp/verticalscroller/scroller/scroller.html](http://subzerostudio.com/temp/verticalscroller/scroller/scroller.html)

这是全屏垂直滚动站点..我只在FF中测试过它，所以很可能是错误的..

假设它确实有效，我现在想添加缓动和速度，我试过这个：

```
 $('html,body').animate({
        duration: 6000,
        easing: 'easeOutElastic',
        scrollTop: $("#"+id).offset().top}
        ); 
```

但持续时间没有效果，缓和似乎也不起作用..有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:54:09.953

您的动画语法不正确。

```
$('html body').animate({
    scrollTop: $("#"+id).offset().top
}, 6000, 'easeOutElastic'); 
```

正如您所拥有的那样，您是在告诉 jQuery 对不存在的 body的`duration`和属性进行动画处理。`easing`

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

# php - PHP - 如何访问深度数组的内容，动态构建它的路径

> ID：10020295
> 
> 赞同：6
> 
> 时间：2012-04-04T22:41:46.167
> 
> 标签：php, arrays, multidimensional-array, hierarchy, hierarchical-data

我正在尝试从使用闭包表存储的关系数据库内容中构建 PHP 中的分层数组。对于给定的结果，我将拥有`LEAF`节点的完整路径，下面看起来像我的结果集。

1~root~根节点

1~root~根节点>>>2~category1~第一类

1~root~根节点>>>3~category2~第二类

1~root~根节点>>>2~category1~第一类>>>4~subCatOfCategory1~Cat 1的SubCategory

无论如何，这些是我的数据库结果。所以我想遍历它们并在 PHP 中构建一个层次结构，这样我就可以将它转换为 JSON 并在 DOJO 中渲染一棵树

所以当我遍历每一行时，我正在为叶子构建一个“路径”，因为我只需要在元素是“叶子”时向树添加一个元素......沿着这个想法，我决定对每个结果进行标记，使用“>>>”作为分隔符，给我该行中的节点。然后我遍历这些节点，用“~”标记每个节点，这给了我每个节点的属性。

因此，我有一个 for 循环来处理每个 ROW，它基本上确定如果正在处理的节点不是叶子，则将其 ID 添加到一个数组中，该数组用于跟踪到达将要处理的最终叶子的路径。然后，当我最终到达 LEAF 时，我可以调用一个函数来插入一个节点，使用我一路编译的 PATH。

希望这一切都有意义.. 所以我已经包含了下面的代码.. 考虑上面的第二个结果。当我处理完整个结果并即将调用函数 insertNodeInTreeV2() 时，数组如下所示......

`$fullTree`是一个包含 1 个元素的数组，索引为 [1] 该元素包含一个包含四个元素的数组：`ID(1)`, `NAME(root)`, `Description(the root node)`,`CHILDREN(empty array)`

`$pathEntries`是一个只有一个元素 (1) 的数组。也就是说，要插入的 LEAF 节点的 PATH 是节点 [1]，它是根节点。

`$nodeToInsert`是一个包含四个元素的数组：`ID(2)`, `NAME(category1)`, `Description(First Category)`,`CHILDREN(empty array)`

`$treeRootPattern`是一个字符串，其中包含我用来存储整个数组/树的变量名称，在本例中为“fullTree”。

```
private function insertNodeInTreeV2( array &$fullTree, array $pathEntries, array $nodeToInsert, $treeRootPattern )
{
  $compiledPath = null;
  foreach ( $pathEntries as $path ) {
    $compiledPath .= $treeRootPattern . '[' . $path . '][\'CHILDREN\']';
  }
  // as this point $compiledPath = "fullTree[1]['CHILDREN']"
  $treeVar = $$compiledPath;
} 
```

因此，当我进行分配时，$treeVar = $$compiledPath;，我认为我将变量 $treeVar 设置为等于 $fullTree[1]['CHILDREN'] （我在调试器中验证了它是一个有效的数组指数）。即使我将 $compiledPath 的内容粘贴到 Eclipse 调试器中的新表达式中，它也会向我显示一个空数组，这是有道理的，因为它位于 $fullTree[1]['CHILDREN']

但相反，运行时告诉我以下错误......

> troller.php 第 85 行 - 未定义变量：fullTree[1]['CHILDREN']

对此的任何帮助将不胜感激......如果您有更好的方法让我从我描述的结果集中获得我正在尝试构建的分层数组，我会渴望采用更好的方法。

更新以添加调用上述函数的代码 - 如上所述的数据库结果的 FOR 循环处理行

```
foreach ( $ontologyEntries as $entry ) {

        // iterating over rows of  '1~~root~~The root node>>>2~~category1~~The first category
        $nodes = explode( '>>>', $entry['path'] );
        $numNodes = count( $nodes ) - 1 ;

        $pathToNewNode = null;  // this is the path, based on ID, to get to this *new* node
        for ( $level = 0; $level <= $numNodes; $level++ ) {

            // Parse the node out of the database search result
            $thisNode = array(
                'ID'          => strtok($nodes[$level], '~~'),  /*   1   */
                'NAME'        => strtok( '~~'),                 /*   Root   */
                'DESCRIPTION' => strtok( '~~'),                 /*   This is the root node   */
                'CHILDREN'    => array()
            );

            if ( $level < $numNodes ) {   // Not a leaf, add it to the pathToThisNodeArray
                $pathToNewNode[] = $thisNode['ID'];
            }
            else {
                // processing a leaf, add it to the array
                $this->insertNodeInTreeV2( $$treeRootPattern,  $pathToNewNode, $thisNode, $treeRootPattern );
            }

        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T23:30:18.617

请参阅我在您问题下方的评论以获取解释。

```
$paths = array(
    "1~root~the root node",
    "1~root~the root node>>>2~category1~First category",
    "1~root~the root node>>>3~category2~Second category",
    "1~root~the root node>>>2~category1~First category>>>4~subCatOfCategory1~SubCategory of Cat 1"
);

$tree = array();

foreach ($paths as $path)
{
    $currentNode = &$tree;

    $parts = explode(">>>", $path);

    foreach ($parts as $part)
    {
         $node = explode("~", $part);

         // create all nodes along this path
         if (!isset($currentNode[$node[0]]))
         {
              $currentNode[$node[0]] = array(
                "ID"            => $node[0],
                "NAME"          => $node[1],
                "DESCRIPTION"   => $node[2],
                "CHILDREN"      => array(),
              );
         }

         $currentNode = &$currentNode[$node[0]]["CHILDREN"];
    }
}

var_dump($tree); 
```

输出：

```
array
  1 => 
    array
      'ID' => string '1' (length=1)
      'NAME' => string 'root' (length=4)
      'DESCRIPTION' => string 'the root node' (length=13)
      'CHILDREN' => 
        array
          2 => 
            array
              'ID' => string '2' (length=1)
              'NAME' => string 'category1' (length=9)
              'DESCRIPTION' => string 'First category' (length=14)
              'CHILDREN' => 
                array
                  4 => 
                    array
                      'ID' => string '4' (length=1)
                      'NAME' => string 'subCatOfCategory1' (length=17)
                      'DESCRIPTION' => string 'SubCategory of Cat 1' (length=20)
                      'CHILDREN' => &
                        array
                          empty
          3 => 
            array
              'ID' => string '3' (length=1)
              'NAME' => string 'category2' (length=9)
              'DESCRIPTION' => string 'Second category' (length=15)
              'CHILDREN' => 
                array
                  empty 
```

`1~root~the root node`该循环将创建路径中包含的所有节点，因此如果您还 insert ，则不需要insert `1~root~the root node>>>2~category1~First category`。

如果节点是路径的最后一个节点，您可以通过仅创建节点来更改此设置。路径的长度是`count($parts)`，您可以计算您在内部 foreach 循环中所处的级别。

我希望这是你想要的。

# android - 带有android的xml解析器

> ID：10020296
> 
> 赞同：0
> 
> 时间：2012-04-04T22:41:49.530
> 
> 标签：android, xml

我有一些以 UTF-8 编码的 .xml 文件。但是每当我尝试在 Eclipse 上解析它时，我的应用程序就无法运行，

我的xml文件

```
<?xml version="1.0" encoding="UTF-8"?>
<music>
  <song>
    <id>1</id>
    <title>Someone Like You</title>
    <artist>Adele</artist>
    <duration>4:47</duration>
    <thumb_url>http://api.androidhive.info/music/images/adele.png</thumb_url>
  </song>
</music> 
```

我收到此错误：

> E/错误：（540）：意外令牌（位置：TEXT ï»¿1 in java.io.StringReader@412d05e0） E/AndroidRuntime（540）：致命异常：主要

虽然我已经在网上找到的另一个 xml 链接上进行了测试，但它工作得很好！

```
public XMLParser() {

}

/**
 * Getting XML from URL making HTTP request
 * @param url string
 * */
public String getXmlFromUrl(String url) {
  String xml = null

  try {
    // defaultHttpClient
    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpGet httpGet = new HttpGet(url);

    HttpResponse httpResponse = httpClient.execute(httpGet);
    HttpEntity httpEntity = httpResponse.getEntity();
    xml = EntityUtils.toString(httpEntity);

  } catch (UnsupportedEncodingException e) {
    e.printStackTrace();
  } catch (ClientProtocolException e) {
    e.printStackTrace();
  } catch (IOException e) {
    e.printStackTrace();
  }
  // return XML
  return xml;
} 
```

# python - 在Python中将文本打印到行和列坐标？

> ID：10020301
> 
> 赞同：3
> 
> 时间：2012-04-04T22:42:30.610
> 
> 标签：python, string, printing, coordinates

我还没有找到任何关于此的信息，但也许那是因为这是不可能的。但是有没有办法在 Python 中将文本打印到坐标？例如，如果我想在命令窗口的第 3 行第 5 列打印字符串“A”，我该怎么做？我找到了绕过它的方法，并在不同的坐标处打印两个不同的字符串，使用 \n 表示行并使用重复空格表示列，但是编写代码太乏味了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:46:29.270

这个有可能。curses 库是标准的，并[在此处](http://docs.python.org/library/curses.html)记录。可能还有其他人，但这会满足您的需求。特别是，`curses.getsyx()`可能是您需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-03T20:11:32.880

如果您想避免使用 curses 模块，您可以使用 ANSI 转义序列直接了解基础知识。可以在[此处](http://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html)找到相关光标移动代码的快速说明。这些在 Linux/Unix 上开箱即用，对于 Windows，你需要[coloroma](https://pypi.python.org/pypi/colorama)包。

有关将这种技术用于动画的可爱的跨平台示例，请参见[此处](https://gist.github.com/sontek/1508912)。

# python - ANSI 转义序列在 Cygwin 中失败

> ID：10020303
> 
> 赞同：4
> 
> 时间：2012-04-04T22:42:48.977
> 
> 标签：python, escaping, cygwin, ansi-escape, tui

我正在尝试使用 Python 2.7.2 中的 ANSI 转义序列为 CLI 程序创建一个“下拉菜单”。我使用 ANSI 转义序列将“选项”更改为红色并将它们显示在输入行下方，然后清除它们。

我能够在运行 Python 2.6.5 的 Ubuntu 10.04LTS 系统上运行代码，但无法让程序在运行 Cygwin minTTY 1.0.3 的 Windows XP 机器上运行。Windows 或 Cygwin 中的 sys.stdout.flush() 是否存在问题？它是 Python 2.6 到 2.7 的问题吗？真的不知道从哪里开始调试。

```
#!C:\Python27\python.exe
#!/usr/bin/python

import sys

table = {1:'foo', 2:'bar', 3:'foo'}
print '\n'
for item in table.keys() :
    sys.stdout.write('\033[1;31m    %s) %s\033[0m\n' % (item,table[item]))
    sys.stdout.flush()
sys.stdout.write('%s' %((item+1)*'\033M'))
sys.stdout.flush()
answer = raw_input("Select foobar: ")
sys.stdout.write('\033[J')
sys.stdout.flush()
print 'You have selected %s' % (table[answer]) 
```

问题是原始输入文本直到您在 minTTY 中做出选择后才会打印出来（同样，代码在 Ubuntu 上运行良好），这违背了提示文本的目的。在此先感谢 - 保罗

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-11-25T12:13:27.490

您无法执行此操作，因为 Windows 控制台根本不支持 ANSI。

回到 MSDOS 时代，有一个`ANSI.SYS`驱动程序可以加载以启用它们，但现在不行了。

我的印象是，如果您想构建 TUI 界面（文本用户界面），则需要调查使用[https://pypi.python.org/pypi/UniCurses之类的东西](https://pypi.python.org/pypi/UniCurses)

参考：

*   [如何让 win32 控制台识别 ANSI/VT100 转义序列？](https://stackoverflow.com/questions/16755142/how-to-make-win32-console-recognize-ansi-vt100-escape-sequences)

# internet-explorer-8 - Like 无法让 FB Like 按钮在 Dreamweaver 中工作

> ID：10020312
> 
> 赞同：0
> 
> 时间：2012-04-04T22:43:43.140
> 
> 标签：internet-explorer-8, facebook-like

我已按照步骤 1 和步骤 2 将“喜欢”按钮添加到我正在开发的网站。我正在使用 Dreamweaver (Cs5.5) 构建站点。对于我正在为其做网站的人来说，这个按钮是“必须拥有的”！

我完全按照说明状态插入代码，我无法让按钮出现......奇怪的是我正在使用模板并且没有 - 有 {body...}......我有在[https://developers.facebook.com/docs/reference/plugins](https://developers.facebook.com/docs/reference/plugins)使用类似按钮“builder”后插入代码

我已经多次尝试发布代码 - 它不会通过这个场地“翻译”。还尝试发送代码图像 - 我是新用户，我不允许。所以，让我知道我可以让你回答我的问题 - 非常令人沮丧。

我插入一切 - 什么都没有。我在 iexplorer 8 中查看 - 没有。请帮忙！谢谢！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:34:21.297

[https://developers.facebook.com/docs/reference/plugins/like-box/](https://developers.facebook.com/docs/reference/plugins/like-box/)

如果点击此链接，它将带您进入将为您生成代码的页面。在页面的代码生成器表单上，填写的第一步是标题为“Facebook 页面 URL (?)”。在下面的框中，将“平台”一词替换为要连接到您的网站的 Facebook 页面的名称。这真的有效。我也是一个新手，这是我第一次不得不这样做。我在一个名为“FaceBookFeed”的 div 中输入了代码。

# javascript - nodejs express应用程序不会返回json数组

> ID：10020315
> 
> 赞同：1
> 
> 时间：2012-04-04T22:44:00.127
> 
> 标签：javascript, node.js, redis

我有以下 express node.js 应用程序。它使用'redis' npm 包。

```
app.get("/test",function(req,res){
    var data = [];
    client.HGETALL("receipts",function(err,obj){
        for(var id in obj){
            data.push(JSON.parse(obj[id]));
        }
    });
    console.log(data);
    res.json(data);
});

app.listen(3000); 
```

代码运行没有错误；但是，该`data`变量是`[]`返回给浏览器的时间。 ![浏览器](../Images/97ccbb07ee42f2da7f6f00c6380cf190.png)

奇怪的是，当我从命令行运行相同的 redis 命令时，数组被填充了。

![在此处输入图像描述](../Images/3732842139777ace551141611216fc4d.png)

谁能告诉我这里发生了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-04T22:46:42.263

您的代码是异步的。你传递的回调直到*你*的`console.log`. 尝试：

```
app.get("/test",function(req,res){
    var data = [];
    client.HGETALL("receipts",function(err,obj){
        for(var id in obj){
            data.push(JSON.parse(obj[id]));
        }
        console.log(data);
        res.json(data);
    });
}); 
```

# oracle - 隐藏存储过程的主体？

> ID：10020323
> 
> 赞同：1
> 
> 时间：2012-04-04T22:45:04.577
> 
> 标签：oracle, security, stored-procedures, roles

我定义了一个角色并授予它仅连接到数据库并执行特定的存储过程。具有此角色的用户在执行此查询时可以看到程序的主体；

```
select * from  ALL_SOURCE where NAME = 'procedureName'; 
```

过程采用 VARCHAR2 参数并将其与选择查询一起使用。这是一个安全问题吗？我应该以某种方式隐藏它还是转义参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T22:51:27.187

通常，只有当您的过程受到 SQL 注入时，才会出现安全问题。您谈论转义参数的事实意味着您可能正在执行动态 SQL，并且可能容易受到 SQL 注入攻击。如果是这种情况，您需要修复程序，而不是隐藏源。

如果您的存储过程正在实现您认为专有的某些业务逻辑，您可能会[包装代码](http://docs.oracle.com/cd/B28359_01/appdev.111/b28370/wrap.htm)，以便在数据字典中对其进行模糊处理。但是，如果您这样做，请绝对确保您的源代码在源代码控制中，因为一旦打包代码就无法解包（严格来说，攻击者可以使用各种技术来恢复大部分如果他们真的想要包装源，但它是相当安全的）。

# css - 在 TouchPad 上的 webOS 浏览器中锁定屏幕平移

> ID：10020324
> 
> 赞同：2
> 
> 时间：2012-04-04T22:45:10.190
> 
> 标签：css, html, browser, webos, touchpad

在 TouchPad 上的 webOS 浏览器中向左或向右滑动时，如何防止网页向左或向右拉动？

示例：如果您在触摸板的浏览器中启动 google.com，然后向左或向右滑动，您会注意到页面向左或向右拉动并露出灰色背​​景。但是，如果您访问 maps.google.com 并向左或向右滑动，地图就会平移并且页面被锁定在适当的位置。这就是我想做的。我不希望页面超出浏览器边缘，露出灰色背​​景。

我创建了一个使用左右滑动来导航的轮播。它在我笔记本电脑上的 Safari 中完美运行，但是当我在 webOS 浏览器中运行它时，它并没有移动，而是整个页面移动。如何阻止页面移动并允许轮播接收我的拖动事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:37:11.997

如果您不希望屏幕可滚动并禁用反弹（这就是所谓的），您应该尝试：

```
document.ontouchmove = function(event){
    event.preventDefault();
} 
```

# python - 将换行符写入 sys.stdout 时，使 Python 停止发出回车符

> ID：10020325
> 
> 赞同：12
> 
> 时间：2012-04-04T22:45:21.000
> 
> 标签：python, windows, python-2.7

我在 Windows 上，Python （非常有效地）阻止我`'\n'`向 STDOUT 发送独立字符。例如，以下将输出`foo\r\nvar`：

```
sys.stdout.write("foo\nvar") 
```

如何关闭此“功能”？首先写入文件不是一种选择，因为输出是通过管道传输的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T22:53:46.867

在写任何东西之前尝试以下操作：

```
import sys

if sys.platform == "win32":
   import os, msvcrt
   msvcrt.setmode(sys.stdout.fileno(), os.O_BINARY) 
```

如果您只想暂时更改为二进制模式，您可以自己编写一个包装器：

```
import sys
from contextlib import contextmanager

@contextmanager
def binary_mode(f):
   if sys.platform != "win32":
      yield; return

   import msvcrt, os
   def setmode(mode):
      f.flush()
      msvcrt.setmode(f.fileno(), mode)

   setmode(os.O_BINARY)
   try:
      yield
   finally:
      setmode(os.O_TEXT)

with binary_mode(sys.stdout), binary_mode(sys.stderr):
   # code 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-04-06T22:55:29.117

[在字符串前添加“r”](http://docs.python.org/reference/lexical_analysis.html#literals)：

```
sys.stdout.write(r"foo\nvar") 
```

正如预期的那样，它也适用于打印。

# c# - 使用 Entity Framework 4 缓存表

> ID：10020330
> 
> 赞同：0
> 
> 时间：2012-04-04T22:45:47.603
> 
> 标签：c#, entity-framework, entity-framework-4

我有一个包含很多行的表，即产品表，当用户搜索网站时，我从该表中进行选择，并且我还在选择中使用了 Include 方法，我使用了分析器，我注意到 EF 生成了一个具有大量内连接、左连接等的查询。

我想要做的是使用这个选择查询并将结果插入到同一个数据库中的一个临时缓存表中，然后我可以创建一个服务来每 x 分钟更新一次这个表。

问题是，我如何让 EF 使用这个缓存表来选择行，这样我就可以只做一个 select * 而不是每次都用连接查询 products 表？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:14:10.580

我很确定 EF 不支持临时表 - 至少是开箱即用的 - 但它在不断变化。

你最好的选择是做这样的事情......

```
dbcontext.Database.ExecuteSqlCommand("...") 
```

...我猜你可以在那里运行任意 SQL（我知道大多数东西都可以传入，但我不确定限制，但你可以运行 SP、创建索引等） - 设置一个临时表。

然后下一步就是做这样的相反的事情..

```
dbcontext.MyTable.SqlQuery("...").ToList() 
```

...将 sql 结果映射回您的某个实体 - 或将未映射的实体映射到字符串或其他东西。( `dbcontext.MyTable.SqlQuery<T>("...").ToList()`)

问题是如何准确地做到这一点 - 不确定你的具体情况。但是您可以事先创建一个临时表并将其映射 - 并将其用于临时目的。

基本上，这是 DBA 的想法 - 但 EF 并不适合此类事情（请参阅此处类似的东西[Recommed usage of temp table or table variable in Entity Framework 4\. Update Performance Entity framework](https://stackoverflow.com/questions/5052053/recommed-usage-of-temp-table-or-table-variable-in-entity-framework-4-update-per)），但您可能会接受自定义运行查询，例如以上。

希望能帮助到你

编辑：这也可能对[EF 论坛](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/31223561-ad8a-42f2-8c56-e9c756fa120c)有所帮助，但它更具参与性。

# javascript - 查明用户是否使用上下文菜单打开链接

> ID：10020343
> 
> 赞同：0
> 
> 时间：2012-04-04T22:47:05.733
> 
> 标签：javascript, javascript-events

对于我的网站，我需要了解用户是否导航到我页面上的链接。可以轻松捕获“正常”点击，但是我还想了解用户是否使用`contextmenu`链接导航到 URL。

我知道我可以找出用户何时单击鼠标右键（上下文菜单），但我不知道如何确定用户是否在此之后导航到链接（例如单击“在新选项卡中打开”）。

甚至有可能做到吗？或者也许还有其他方法可以找出用户何时导航到页面上的 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:28:24.490

您可以做 facebook/google 和其他人做的事情，确保所有出站链接都通过您自己的内部引用/日志，即：

```
http://example.com/r=http://someSite.example.com/foobar... 
```

无法保证您可以使用 javascript 做任何比这更好的事情，但是您可以绑定一个函数以使用第二个鼠标按钮侦听链接点击，并设置一些骇人听闻的确保其他页面加载最终机制与服务器-side 代码，但这只是存在的方式，我强烈建议不要这样做。

只要坚持 google/facebook 所做的事情，其他一切都是廉价的不稳定黑客，不值得努力。

# java - 这个多部分表单有什么问题？安卓-Java

> ID：10020346
> 
> 赞同：1
> 
> 时间：2012-04-04T22:47:45.090
> 
> 标签：java, android, ruby-on-rails, multipart

我总是返回 Content Length Required 411，我在这里做错了什么？我发错了吗？我发送到 RoR 服务器。它基本上会根据天气是否存在图像在语句之间切换。多谢你们。

```
 public static void executeMultipartPost(Bitmap image, String topicid, String topost, Context c) throws Exception {
            String boundary = "------WebKitFormBoundary4QuqLuM1cE5lMwCy";

            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            image.compress(CompressFormat.JPEG, 45, bos);
            byte[] data = bos.toByteArray();
            try
            {

                URL post_url = new URL("https://myapi");
                HttpURLConnection feed_connection = (HttpURLConnection) post_url.openConnection();
                feed_connection.setChunkedStreamingMode(0);
                feed_connection.setDoOutput(true);//make a POST Method as defualt is GET
                feed_connection.setRequestMethod("POST");
                feed_connection.setRequestProperty("Content-Type", "multipart/form-data; boundary=" + boundary);

                //Now the actual composing of the multi part form
                String session_key = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"session_key\"\r\n\r\n" + key + "\r\n");
                String feed = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"feed\"\r\n\r\n" + topost + "\r\n");
                String sh_career = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"share_to_career_team\"\r\n\r\n" + 0 + "\r\n");
                String sh_friend = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"share_to_friend\"\r\n\r\n" + 0 + "\r\n");
                String url_t = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"url_title\"\r\n\r\n"+"\r\n");
                String url_d = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"url_description\"\r\n\r\n"+"\r\n");
                String url_a = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"url_address\"\r\n\r\n"+"\r\n");
                String topic_id = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"post_to\"\r\n\r\n" + topicid + "\r\n");

                if (data != null) {
                    String file_param_constant = "image";
                    Log.d("TAG","Image is here");
                    String image_part_1 = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"richmedia_type\"\r\n\r\n" + "1\r\n");
                    String image_part_2 = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"" + file_param_constant + "\"; filename=\"image.jpg\"\r\n" + "Content-Type: image/jpeg\r\n\r\n");
                    String missing_link = new String ("\r\n");
                    String image_part_3 = new String("--" + boundary + "--\r\n");
                    feed_connection.setRequestProperty("Content-Length", String.valueOf((session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + topic_id.length() + image_part_1.length() + image_part_2.length() + missing_link.length() + image_part_3.length())));
                    Log.d("TAG", "CONTENT LEGNTH WITH IMG:"+String.valueOf((session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + image.getByteCount() + topic_id.length())));
                    ByteArrayOutputStream form_output   = new ByteArrayOutputStream();
                    OutputStream form_stream            = new BufferedOutputStream(feed_connection.getOutputStream());
                    form_output.write(session_key.getBytes());
                    form_output.write(feed.getBytes());
                    form_output.write(sh_career.getBytes());
                    form_output.write(sh_friend.getBytes());
                    form_output.write(url_t.getBytes());
                    form_output.write(url_d.getBytes());
                    form_output.write(url_a.getBytes());
                    form_output.write(topic_id.getBytes());
                    form_output.write(image_part_1.getBytes());
                    form_output.write(image_part_2.getBytes());
                    form_output.write(data);
                    form_output.write(missing_link.getBytes());

                    form_output.write(image_part_3.getBytes());

                    form_stream.write(form_output.toByteArray());
                    Log.d("TAG","Feed-Connection content legnth :"+Integer.toString(feed_connection.getContentLength()));

                }else {
                    String image_part_1 = new String("--" + boundary + "\r\n" + "Content-Disposition: form-data; name=\"richmedia_type\"\r\n\r\n" + "0\r\n");
                    Log.d("TAG", "CONTENT LEGNTH:"+String.valueOf((session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + image.getByteCount() + topic_id.length())));
                    feed_connection.setRequestProperty("Content-Length NO IMG", String.valueOf((session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + image.getByteCount() + topic_id.length())));
                    ByteArrayOutputStream form_output   = new ByteArrayOutputStream();
                    OutputStream form_stream            = new BufferedOutputStream(feed_connection.getOutputStream());
                    form_output.write(session_key.getBytes());
                    form_output.write(feed.getBytes());
                    form_output.write(sh_career.getBytes());
                    form_output.write(sh_friend.getBytes());
                    form_output.write(url_t.getBytes());
                    form_output.write(url_d.getBytes());
                    form_output.write(url_a.getBytes());
                    form_output.write(topic_id.getBytes());
                    form_output.write(image_part_1.getBytes());
                    form_stream.write(form_output.toByteArray());
                    Log.d("TAG","Feed-Connection content legnth :"+ Integer.toString(feed_connection.getContentLength()));
                }
                //write form to connection

                if (feed_connection.getResponseCode() != HttpURLConnection.HTTP_OK)
                {
                    Log.d("TAG","CRAP BROKE MAN");
                    throw new Exception("Carp hit the fan an connection didnt get a OKAY Error Code: " + feed_connection.getResponseMessage() +  feed_connection.getResponseCode());
                }

                InputStream recieved_information = feed_connection.getInputStream();

            }
            catch (Exception the_e)
            {
                System.out.println("Not even" + the_e.getMessage());
                Log.d("TAG", "NOT EVEN" + the_e.getMessage());
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:42:07.163

内容长度是 Http 请求标头属性，而不是 http 请求属性。

这不会在 Http 请求标头中设置内容长度：

```
feed_connection.setRequestProperty("Content-Length", String.valueOf((session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + topic_id.length() + image_part_1.length() + image_part_2.length() + missing_link.length() + image_part_3.length()))); 
```

尝试使用[HttpURLConnection.setFixedLengthStreamingMode()](http://developer.android.com/reference/java/net/HttpURLConnection.html#setFixedLengthStreamingMode%28int%29)设置内容长度，例如：

```
feed_connection.setFixedLengthStreamingMode(session_key.length() + feed.length() + sh_career.length() + sh_friend.length() + url_t.length() + url_d.length() + url_a.length() + topic_id.length() + image_part_1.length() + image_part_2.length() + missing_link.length() + image_part_3.length()); 
```

希望这可以帮助。

# python - Python“类obj”错误

> ID：10020350
> 
> 赞同：1
> 
> 时间：2012-04-04T22:48:06.213
> 
> 标签：python

我有这段代码，但我无法运行它，因为我收到了这个错误：“TypeError：'classobj' object is not subscriptable”，这是我的代码：

```
import cgi
import customerlib

form=cgi.FieldStorage

history = customerlib.find(form["f_name"].value,form["l_name"].value)

print "Content-type: text/html"
print
print """<html>
  <head>
    <title>Purchase history</title>
  </head>
  <body>
    <h1>Purchase History</h1>"""

print "<p>you have a purchase history of:"
for i in history: "</p>"
   print"""  <body>
</html>""" 
```

我在这个文件旁边有 customerlib 文件。知道如何解决吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T22:51:12.153

```
form=cgi.FieldStorage 
```

`FieldStorage`是一个类，而不是一个对象。你需要实例化它来创建一个`FieldStorage`对象：

```
form=cgi.FieldStorage() 
```

这是错误的，`form["f_name"]`因为 form 当前是 的类的别名`FieldStorage`，而不是类型的对象`FieldStorage`。通过实例化它，它正在做你认为它应该做的事情。

查看[cgi 模块文档](http://docs.python.org/library/cgi.html)以获取有关如何使用 CGI 模块的更多详细信息。

# java - 无法从 struts.properties 读取某些字符串

> ID：10020352
> 
> 赞同：0
> 
> 时间：2012-04-04T22:48:26.050
> 
> 标签：java, javascript, struts2, struts

我在 struts.properties 中定义了变量错误，如下所示：

```
error=this is an error 
```

现在我可以按如下方式调用此错误：

```
ErrorMsg = "<s:property value='getText(\"error\")'/>"; 
```

它有效，结果是：ErrorMsg=this is an error

如何获取变量的文本而不是字符串？我尝试了以下方法：

```
var m="error";
  error1 = "<s:property value='getText(m)'/>";
  error2 = "<s:property value='getText(\"m\")'/>"; 
```

我使用 firebug 调试器，error1 和 error2 显示如下：

```
error1=""
error2="" 
```

任何的想法？先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:34:15.083

您似乎正在混合服务器端和客户端代码。

s:property 标记将首先在服务器端进行评估，早在任何 m 值有效之前，因为那是客户端 JavaScript 代码。

如果您发布您想要实现的目标，那么我或其他人可能会提供进一步的帮助。

高温高压

# android - 我使用什么音频流重要吗？

> ID：10020353
> 
> 赞同：0
> 
> 时间：2012-04-04T22:48:29.037
> 
> 标签：android, audio

android 音频管理器有大量不同的音频流可用，包括 DTMF、SYSTEM、RING 等。

并不是说我说这是个好主意，但是在 MUSIC 以外的流上播放音频有什么明显的缺点吗？标准似乎是在 MUSIC 流上播放，但例如，如果我想使用铃声音量，那么只在 RING 流上播放有什么缺点吗？

在许多情况下，除了我上面提供的情况之外，在音乐以外的流上播放还有一些优势，但如果我能提供帮助，我不想冒险破坏更重要的功能。

我很想知道是否有人有玩和/或操纵其他流的经验，以及他们遇到（或招致...）的副作用（如果有的话）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:57:03.790

你为什么需要它？我认为媒体流足以满足您的任何目的。

看，例如您使用环流。例如，您的程序控制它的音量。他设置“无音量”=> 这意味着他进入“振动模式”并且由于您的应用程序他无法听到传入的铃声

# c# - 生成随机位序列

> ID：10020362
> 
> 赞同：0
> 
> 时间：2012-04-04T22:49:32.513
> 
> 标签：c#, java, c++, c, random

我正在尝试生成一个包含具有给定长度的绝对随机密钥的文件，让我们说 100 位并将它们存储在一个文件中。最好的方法是什么？哪种语言提供最好的库？提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T22:56:27.527

随机性来自不同级别的“强度”；您可以获得*真正*的随机位或*伪*随机位。真正的随机位从现实世界的来源中获得熵。*伪*随机位产生*看似*随机但实际上是可预测的位序列。

在生成密钥时，您应该始终使用指定为具有**加密强度**的随机生成器。这些随机位生成器经过精心设计，真正不可预测。永远不要使用较弱的随机源来生成密钥。

在 C# 中，您可以通过创建一个恰当命名的[**随机数生成器加密服务提供程序**](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)的实例，然后调用[GetBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.getbytes.aspx)来获取所需长度的随机字节数组。

不用说：生成自己的加密密钥时要非常小心。密码学就​​是利用密钥的安全性来保证消息的安全性。如果您对如何生成、存储和传输密钥不是很小心，那么安全系统就会受到威胁。如果您自己不是专家，请考虑聘请密码学专家，而不是尝试推出自己的加密代码。

我还注意到，根据您的应用程序，100 位可能太小或太大。它可能太小了，因为您的算法可能容易受到如此小的密钥大小的攻击，并且它可能太大，因为某些国家/地区限制使用或出口具有过多位数的加密软件。考虑咨询律师。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:00:37.347

取决于你所说的绝对随机是什么意思。如果可以接受伪随机数生成器，那么 C++`<random>`库是一个不错的选择。

如果您需要比这更强大的保证，那么如果您的平台具有该功能，您仍然可以使用`std::random_device`which`<random>`提供非确定性随机数。它甚至可以提供对加密随机数生成器的访问。您必须检查平台的文档。

```
#include <random>
#include <iostream>

int main() {
    std::random_device r("/dev/random"); // Cryptographically secure RNG on Linux, OpenBSD, OSX, (using libc++)
    unsigned int completely_random_value = r();
    std::cout << completely_random_value << '\n';
} 
```

* * *

可能与您相关的一件事是 Microsoft 文档中关于他们在 VS11 中实现 random_device 的注释：“在此实现中，默认生成的值不是不确定的。” 这是 Visual Studio 的 C++11 库的另一个不幸的实现质量问题（至少伴随着他们的 chrono::high_resolution_clock 的低分辨率）

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-04T22:51:16.773

真正的随机数不能由确定性过程生成，因此语言的选择在某种意义上并不重要。既然您说“密钥”，您可能正在寻找加密密钥，而通过确定性过程生成这些密钥确实非常危险，并且会导致许多系统中断。

我会重新考虑整个事情——如果你自己生成加密密钥，你绝对应该重新考虑整个事情。业余爱好者，无论编程多么熟练，都不应该编写密码代码。这导致了比我数不清的更多系统错误。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-04T22:51:20.940

在 C/C++ 中相对容易，假设您了解没有随机数之类的东西，而只是伪随机数：

```
uint8_t *randomBytes(int length)
{
    uint8_t buffer = malloc(length);

    for (int i = 0; i < length; i++)
    {
        buffer[i] = arc4random_uniform(256); // or similar random function
    }

    return buffer; // don't forget to free buffer when done!
} 
```

在 Java 中，您将返回一个字节数组，如下所示：

```
byte[] randomBytes(int length)
{
    Random rand = new Random();
    byte[] buffer = new byte[length];

    for (int i = 0; i < length; i++)
    { 
        buffer[i] = (byte) rand.nextInt(256);
    }

    return buffer;
} 
```

在 C# 中，它与 Java 基本相同，但有一些不同之处：

```
byte[] randomBytes(int length)
{
    Random rand = new Random();
    byte[] buffer = new byte[length];

    for (int i = 0; i < length; i++)
    { 
        buffer[i] = (byte) rand.Next(256);
    }

    return buffer;
} 
```

# android - GLSurfaceView 和 EGL_BAD_ALLOC

> ID：10020363
> 
> 赞同：2
> 
> 时间：2012-04-04T22:49:37.977
> 
> 标签：android, opengl-es

我在我们的游戏中偶尔会遇到这个错误：

```
STACK_TRACE := java.lang.RuntimeException: eglSwapBuffers failed: EGL_BAD_ALLOC
at android.opengl.GLSurfaceView$EglHelper.throwEglException(GLSurfaceView.java:1079)
at android.opengl.GLSurfaceView$EglHelper.swap(GLSurfaceView.java:1037)
at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1342)
at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1118) 
```

现在，我已经阅读了有关此问题的其他实例是由于未在 GLSurfaceView 上调用 onPause 和 onResume 引起的，但我们确实如此。

但！我们的游戏工作方式有几个活动，其中大部分是弹出窗口。我们不希望渲染器在这些情况下暂停，因为我们希望绘图在菜单后面继续。

因此，我们在封闭活动的 onStop 方法中调用 onPause，在活动的 onStart/onRestart 方法中调用 onResume。

[Google 上](http://code.google.com/p/android/issues/detail?id=12378)的一篇文章提到了 onPause/onResume 问题以及“防止 GLThread 在生病时执行的代码”。还有什么我需要做的吗？

（我不是在绘制未绑定的纹理，但除此之外，这发生在帧的开头，不是吗？这不是绘制，而是交换缓冲区以绘制已缓冲的内容并设置空白下一帧的空间，不是吗？）

我将不胜感激任何见解。

# dotcloud - 你把 dotcloud.yml 文件放在哪里？

> ID：10020365
> 
> 赞同：0
> 
> 时间：2012-04-04T22:49:48.380
> 
> 标签：dotcloud

我不知道我在做什么 -

我将 dotcloud.yml 文件放在哪里？

对于不知道自己在做什么的人来说，这没有太多帮助。Insturcitons 只是说创建文件....你把它放在哪里？在我的照片里？在我的文件中？在我桌面上一个名为“mj 的图片”的新文件夹中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:42:14.207

该`dotcloud.yml`文件通常位于包含您要在 dotCloud 上部署的应用程序代码的目录中。

我建议查看 dotCloud 教程，例如[http://docs.dotcloud.com/firststeps/quickstart/](http://docs.dotcloud.com/firststeps/quickstart/)；我想它会解释你需要知道的一切:-)

如果您指的是特定的指南或教程，请毫不犹豫地提及哪个——如果它是由 dotCloud 维护的文档，他们肯定会更新它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T15:29:49.373

[dotcloud.yml 文档](http://docs.dotcloud.com/guides/build-file/#approot-specifying-the-root-directory-of-a-service)中有一个提示，但是您是对的，我们需要使位置更加明确。

该`dotcloud.yml`文件必须位于源代码树的根目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T22:54:39.800

可能在您的应用程序/项目目录的根目录中，这就是我在 Ruby 项目中拥有 config.yml 的位置。您可以在下面链接的 repo 中看到一个 yml 文件的示例。

[https://github.com/ramaze/ramaze](https://github.com/ramaze/ramaze)

不幸的是，我不熟悉那个部署平台？所以我不确定缩放命令在该提示中会做什么。

对于 ruby​​，deploy 命令似乎`dotcloud push [foldername]`在提示符中。

[http://docs.dotcloud.com/services/ruby/](http://docs.dotcloud.com/services/ruby/)

# objective-c - 动画 UIButton 变得隐藏和取消隐藏

> ID：10020366
> 
> 赞同：2
> 
> 时间：2012-04-04T22:50:22.497
> 
> 标签：objective-c, animation, uibutton

所以，我有一个`UIButton`，当 a`UITextField`处于编辑模式时，它会变得隐藏和不隐藏。问题是，它的变化非常好（从隐藏到不隐藏），但没有动画。我已经尝试过`setAlpha:`了，但这仅在将其 alpha 从 0 设置为 100，而不是从 100 设置为 0 时才有效。到目前为止，这是我的代码：

```
-(BOOL) textFieldShouldBeginEditing:(UITextField *)textField
{
negButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
negButton.frame = CGRectMake(textField.frame.origin.x, textField.frame.origin.y, 37, textField.frame.size.height);
[negButton setHidden:YES];

return YES;
}

-(void) textFieldDidBeginEditing:(UITextField *)textField
{
if ([textField isEditing])
{
    [UIView animateWithDuration:0.3 animations:^
     {
         CGRect frame = textField.frame;

         frame.size.width -= 40;
         frame.origin.x += 40;

         [negButton setHidden:NO];
         [textField setFrame:frame];
         [self.view addSubview:negButton];
     }];
}
}

-(void) textFieldDidEndEditing:(UITextField *)textField
{
    [UIView animateWithDuration:0.3 animations:^
     {

         CGRect frame = textField.frame;
         frame.size.width += 40;
         frame.origin.x -= 40;

         [negButton setHidden:YES];
         [negButton removeFromSuperview];

         [textField setFrame:frame];
     } 
     ];
} 
```

**编辑：我解决了这个问题。我只是不必调用该`removeFromSuperview`函数，我必须从隐藏切换到 alpha。（见下面@David的回答）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:59:49.647

你的动画有问题。将其更改为以下内容：

```
-(BOOL) textFieldShouldBeginEditing:(UITextField *)textField
{
negButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
negButton.frame = CGRectMake(textField.frame.origin.x, textField.frame.origin.y, 37, textField.frame.size.height);
[negButton setAlpha:0]; 
[self.view addSubView:negButton];

return YES;
}

-(void) textFieldDidBeginEditing:(UITextField *)textField
{
if ([textField isEditing])
    {
     CGRect frame = textField.frame;

     frame.size.width -= 40;
     frame.origin.x += 40;

     [UIView beginAnimations:nil context:nil];
     [UIView setAnimationDuration:0.3];
     [negButton setAlpha:1];
     [textField setFrame:frame];
     [UIView commitAnimations];
    }
}

-(void) textFieldDidEndEditing:(UITextField *)textField
{

     CGRect frame = textField.frame;
     frame.size.width += 40;
     frame.origin.x -= 40;

     [UIView beginAnimations:nil context:nil];
     [UIView setAnimationDuration:0.3];
     [negButton setAlpha:0];
     [textField setFrame:frame];
     [UIView commitAnimations];

     [self performSelector:@selector(removeBtn) withObject:negButton afterDelay:0.3];
}

- (void)removeBtn:(UIButton*)button
{
    [button removeFromSuperView];
} 
```

您正在立即从视图中删除该按钮，而不是在它消失后将其删除。

干杯!

# mysql - 将 SQL 查询写入下表中的 SELECT 项

> ID：10020369
> 
> 赞同：0
> 
> 时间：2012-04-04T22:50:53.840
> 
> 标签：mysql, sql, excel, ms-access

我很难编写一个 SELECT 查询来获取下表中的数据......

这是一张桌子的照片......

[http://i44.tinypic.com/29dxx81.png](http://i44.tinypic.com/29dxx81.png)

我正在尝试显示数量大于 10 的所有项目部件的部件名称（pname）......但是，数量似乎仅在子菜单展开时出现，并且我无法选择它...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T22:57:20.083

你有没有尝试过：

```
SELECT pname from [TableName] WHERE quantity >= 10 
```

编辑：

```
SELECT pname from Parts 
INNER JOIN Shipments
ON Parts.ForeignKey = Shipments.ForeignKey
WHERE quantity >= 10 
```

# android - Android中的Http Post请求不会返回适当的数据？

> ID：10020370
> 
> 赞同：0
> 
> 时间：2012-04-04T22:50:57.407
> 
> 标签：android, post, request, response

好的，所以我试图将 Http Post Requests 发送到这个站点，然后我用 wireshark 嗅探发送的请求，从而从该站点的 post 请求中获取文本数据。我在股票 Java 应用程序中使用了它，它工作得非常好。我可以定期使用 post 方法，没有任何问题，它会返回适当的网站。然后我试着用安卓做这个。在执行 post 请求后，它不会返回实际的 html 数据，而是返回未触及的常规页面 html 数据。它确实发送了一个发布请求（再次用wireshark嗅探），它似乎没有得到适当的响应。我采用了与我的另一个项目完全相同的方法，该方法在该项目中运行良好，并将其粘贴到我的新项目中。我在 Android 中添加了 INTERNET 用户权限，所以有' 没有错。唯一明显的区别是我在另一个（有效的）中使用了 NameValuePairs，而在这个中，我直接将字符串放入 StringEntity 中而不进行编码（尽管使用 UTF-8 编码搞砸了字符串）。就像我说的那样，我在常规 Java 中使用了完全相同的文本行，并且它在没有编码的情况下运行良好。那么可能是什么问题呢？这是代码：

```
public static String sendNamePostRequest(String urlString) {

    HttpClient client = new DefaultHttpClient();

    HttpPost post = new HttpPost(urlString);

    StringBuffer sb = new StringBuffer();

    try {

        post.setEntity(new StringEntity(
                "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE3NDM5MzMwMzRkZA%3D%3D&__EVENTVALIDATION=%2FwEWBAL%2B%2B4CfBgK52%2BLYCQK1gpH7BAL0w%2FPHAQ%3D%3D&_nameTextBox=John&_zoekButton=Zoek&numberOfLettersField=3"));

        HttpResponse response = client.execute(post);
        HttpEntity entity = response.getEntity();

        BufferedReader br = new BufferedReader(new InputStreamReader(
                entity.getContent()));
        String in = "";

        while ((in = br.readLine()) != null) {
            sb.append(in + "\n");
        }

        br.close();

    } catch (Exception e) {
        e.printStackTrace();
    }

    return sb.toString();
} 
```

你能看出这里有什么问题吗？

# java - 需要 GSON 返回一个 Java JSONArray

> ID：10020371
> 
> 赞同：4
> 
> 时间：2012-04-04T22:51:07.697
> 
> 标签：java, json, gson

我无法返回 JSONArray，而是我的对象似乎是一个字符串。*myArray*的值与*jsonString*的值相同。该对象是 String 对象而不是**JSONArray**。以及*jsonString*和*myArray* prnt：

```
[{"id":"100002930603211",
  "name":"Aardvark Jingleheimer",
  "picture":"shortenedExample.jpg" },
 {"id":"537815695",
   "name":"Aarn Mc",
   "picture":"shortendExample.jpg" },
 {"id":"658471072",
   "name":"Adrna opescu",
   "picture":"shortenedExample.jpg"
}] 
```

如何将其转换为实际的 Java **JSONArray**？谢谢！

```
 //arrPersons is an ArrayList

        Gson gson = new Gson();
        String jsonString = gson.toJson(arrPersons);

        JsonParser parser = new JsonParser();
        JsonElement myElement = parser.parse(jsonString);
        JsonArray myArray = myElement.getAsJsonArray(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T14:52:55.760

我认为你可以做你想做的事，而无需写出一个 json 字符串然后重新读取它：

```
List<Person> arrPersons = new ArrayList<Person>();

// populate your list

Gson gson = new Gson();
JsonElement element = gson.toJsonTree(arrPersons, new TypeToken<List<Person>>() {}.getType());

if (! element.isJsonArray()) {
// fail appropriately
    throw new SomeException();
}

JsonArray jsonArray = element.getAsJsonArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:53:03.063

```
 public JSONArray getMessage(String response){

    ArrayList<Person> arrPersons = new ArrayList<Person>();
    try {
        // obtain the response
        JSONObject jsonResponse = new JSONObject(response);
        // get the array
        JSONArray persons=jsonResponse.optJSONArray("data");

        // iterate over the array and retrieve single person instances
        for(int i=0;i<persons.length();i++){
            // get person object
            JSONObject person=persons.getJSONObject(i);
            // get picture url
            String picture=person.optString("picture");
            // get id
            String id=person.optString("id");
            // get name
            String name=person.optString("name");

            // construct the object and add it to the arraylist
            Person p=new Person();
            p.picture=picture;
            p.id=id;
            p.name=name;
            arrPersons.add(p);
        }
        //sort Arraylist
        Collections.sort(arrPersons, new PersonSortByName());

    Gson gson = new Gson();
    //gson.toJson(arrPersons);

    String jsonString = gson.toJson(arrPersons);

    sortedjsonArray = new JSONArray(jsonString);

    } catch (JSONException e) {

        e.printStackTrace();
    }

    return sortedjsonArray;

}

public class PersonSortByName implements Comparator<Person>{

    public int compare(Person o1, Person o2) {
    return o1.name.compareTo(o2.name);
    }
    }

  public class Person{
       public String picture;
       public String id;
       public String name;
  } 
```

# javascript - 在 HTML 页面上创建多个 google API 实例

> ID：10020376
> 
> 赞同：0
> 
> 时间：2012-04-04T22:51:23.480
> 
> 标签：javascript, google-maps-api-3, google-api

我正在创建一个网页，允许用户在文本框中输入开始位置和结束位置，并输出两个位置之间的距离（这是使用谷歌 API）。我已经成功地创建了一个可以按我想要的方式工作的单个实例。但是我的问题是我需要多行这样但是一旦我复制代码我似乎无法让它工作。这是我第一次真正尝试使用 javascript，所以我对它的理解不是很好。我意识到我需要更改变量等，但不确定要更改什么。抱歉，如果我不够清楚，但任何帮助都会很棒，谢谢。

这是我的代码：

```
<body onload="initialize()">

<script type="text/javascript">
var directionDisplay;
var directionsService = new google.maps.DirectionsService();
var map;

function initialize() {
    directionsDisplay = new google.maps.DirectionsRenderer();
    var belfast = new google.maps.LatLng(55, -5)
    var myOptions = {
        zoom:5,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        center: belfast,
    }

    map = new google.maps.Map(document.getElementById("map_canvas1"), myOptions);
        directionsDisplay.setMap(map);
    }

function calcRoute() {
    var start = document.getElementById("pc1").value;
    var end = document.getElementById("pc2").value;

    var distanceInput = document.getElementById("distance");
    var request = {
        origin:start, 
        destination:end,
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
            distanceInput.value = response.routes[0].legs[0].distance.value / 1000;
            }
        });
    } 
```

```
<td><input type="text" id="pc1" /></td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:04:08.000

如果您要创建多个 Google 地图实例，则需要确保没有混淆全局变量。您在全局级别声明的这些变量：

```
var directionDisplay;
var directionsService = new google.maps.DirectionsService();
var map; 
```

因此，如果您尝试创建第二个映射并将映射分配给`map`变量，这应该会破坏前一个映射。同样，您的 DirectionsService。因此，您需要为每个实例的每个变量创建一个变量。

# apache - 如何获取 mod_python 站点以允许客户端缓存选定的图像内容？

> ID：10020379
> 
> 赞同：0
> 
> 时间：2012-04-04T22:51:39.453
> 
> 标签：apache, http, caching, http-headers, mod-python

我有一个在`mod_python`. 我继承了这一点，虽然我已经成功地对其内容和逻辑进行了相对较小的更改，但使用 HTTP 缓存我已经超出了我的深度。该站点已经运行良好，因此这*不是*关于如何*禁用*动态站点缓存的“常见问题”。

我的问题是每个页面上都有一个大横幅图片（每个页面上来自相同 URL 的相同图片）占站点带宽的约 90%，但据我所知没有被缓存；当我每次点击新页面（或返回以前访问过的页面）时浏览该网站时，它会再次下载它。

如果我 wget 横幅的图像 URL（查看标题），我会看到：

```
$ wget -S http://example.com/site/gif?name=banner.gif
--2012-04-04 23:02:38--  http://example.com/site/gif?name=banner.gif
Resolving example.com... 127.0.0.1
Connecting to example.com|127.0.0.1|:80... connected.
HTTP request sent, awaiting response... 
  HTTP/1.1 200 OK
  Date: Wed, 04 Apr 2012 22:02:38 GMT
  Server: Apache/2.2.14 (Ubuntu)
  Content-Location: gif.py
  Vary: negotiate
  TCN: choice
  Set-Cookie: <blah blah blah>
  Connection: close
  Content-Type: image/gif
Length: unspecified [image/gif]
Saving to: `gif?name=banner.gif' 
```

并且提供它的代码只不过是

```
 req.content_type = 'image/gif'
    req.sendfile(fullname) 
```

其中 fullname 是从请求的名称参数修改的文件路径。

我的问题是：在图像的请求响应中设置 Expires: 或 Vary: 字段是否有一些快速修复会导致客户不太热衷于重复下载它？

该站点托管在 Ubuntu 10.04 上，除了 rewrite 之外，没有启用任何非默认 apache mods。

我注意到大多数（不是全部）网站页面的标题本身确实包含

```
Pragma: no-cache
Cache-Control: no-cache
Expires: -1
Vary: Accept-Encoding 
```

（并且原始站点作者​​已经清楚地考虑了这一点，因为 no-cache 被选择性地应用于非静态内容页面）。我对缓存知之甚少，不知道这是否会以某种方式毒化包含的 .gif IMG，使其每次都重新加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T07:46:22.003

不知道我的回答能不能帮到你，反正我发了。您可以在 apache（在同一台服务器上）中创建另一个虚拟主机，而不是从 python 应用程序中提供图像文件，以提供静态和图像文件。在您的 python 应用程序中，您可以嵌入这样的图像

```
<img src="http://img.yoursite.com/banner.gif" alt="banner" /> 
```

使用单独的虚拟主机，您可以使用模式标头将各种标头添加到各种内容类型，或者为您的静态文件添加另一个缓存层。

希望这有帮助。

# java - MDM - APNS 不工作

> ID：10020384
> 
> 赞同：7
> 
> 时间：2012-04-04T22:51:59.880
> 
> 标签：java, ios, apple-push-notifications, mdm

我们正在内部实施 MDM 解决方案。我们已注册为 MDM 供应商，并按照该[站点](http://www.softhinker.com/in-the-news/iosmdmvendorcsrsigning)的步骤操作并获得了最终的 APNS 证书。我们还在设备中安装了一个 MDM 配置文件，该配置文件指向我们的后端服务器，该服务器能够接收/发送有效负载到设备。

然后我们使用[java-apns](https://github.com/notnoop/java-apns)库来发送一个示例通知。下面是相同的示例代码。

```
 ApnsService service =
            APNS.newService()
            .withCert("test.p12", "xxxxxxx")
            .withProductionDestination()
            .build();
    String pushMagic = "xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx";

    String mdmPayload = APNS.newPayload().mdm(pushMagic).build();
    service.push(pushMagic, mdmPayload); 
```

以上执行成功。但设备没有收到任何通知。有人可以对此有所了解吗？提前致谢。

**更新：** 在我们的实施中发现了几个问题。push API 接受设备令牌和有效负载。我们在推送 API 中错误地使用了 pushmagic 作为令牌。此外，设备在初始签入期间以 base64 格式发送设备令牌。因此需要将其转换为 hexa 格式并在 push API 中使用。

有了这两个变化，我们就领先了一步。现在反馈服务正在返回一条消息，说明相应的设备处于非活动状态。我们尝试重新安装配置文件并使用最新的推送魔法和设备令牌。仍然反馈服务返回相同的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T04:06:45.267

如果您仍然面临问题，请非常仔细地遵循[MDM_Protocol 。](https://media.blackhat.com/bh-us-11/Schuetz/BH_US_11_Schuetz_InsideAppleMDM_WP.pdf)首先尝试使用生产 APNS。

如果有任何其他问题，请提供问题详细信息。

# jquery - 用 data() 分配的 jquery 数据可以存活多长时间？

> ID：10020388
> 
> 赞同：2
> 
> 时间：2012-04-04T22:52:08.723
> 
> 标签：jquery, object

我正在通过我正在创建的 jquery 将一些数据分配给 html 对象，问题是当我从插件调用方法时，我分配的数据不再在对象中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T23:01:46.433

了解如何`.data()`工作以了解数据的生存时间是有用的。当您使用 存储某些内容时`.data()`，它会进入 jQuery 中的内部 javascript 数据结构。因此，在这方面，它只是一个 javsacript 变量，它的存在时间与任何其他 javascript 变量的存在时间一样长。

这意味着一旦你离开页面，它就完全消失了——就像所有其他 javascript 变量一样。

可以删除数据的另一种方法是，如果某些 javascript 代码专门从数据结构中删除了数据。这通常只有在您使用有意处置 DOM 对象的 jQuery 方法时才会发生。这可以使用`$(elem).remove()`或使用`$(elem).html("some html)`任何其他从 DOM 中删除元素的 jQuery 方法来完成。由于这些方法会从 DOM 中删除对象，因此 jQuery 会“清理”`.data()`与这些元素相关的信息。一个特定的例外是`.detach()`从 DOM 中删除一个元素，但不删除它的`.data()`信息。这样做是为了让您可以将其从 DOM 中删除，但可能会保留其状态，以便您可以将其放回 DOM 中的其他地方或一段时间后。

注意：如果你从 DOM 中删除一个 DOM 元素而不使用jQuery函数（例如`.removeChild()`或通过分配给浪费内存空间。除了消耗一些额外的内存之外，它不会造成任何伤害。如果该信息包含对其他 javascript 或 DOM 元素的引用，则可能导致更大的内存泄漏。`.innerHTML``.data()``.data()`

如果您正在使用`.data()`它，则会创建一种情况，即您希望坚持使用 jQuery 方法来处理任何可能导致 DOM 元素被删除的事情。通常使用 jQuery，您可以自由混合/匹配纯 javascript 和 jQuery，但这是不应该的一种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:56:32.400

使用的数据`.data()`只要：

*   jQuery 仍在您的页面中。jQuery 使用[内部缓存](https://stackoverflow.com/a/10004655/575527)来存储数据，使用`.data()`. 它永远不会在 DOM 上。

*   只要您绑定数据的元素仍在附近，或者如果在 DOM 中被移除，它就会被[`.detach()`](http://api.jquery.com/detach/)

*   你不重新加载页面。存储在其中的数据`.data()`不会通过页面重新加载而持续存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:59:15.910

从[`jQuery.data()`](http://api.jquery.com/jQuery.data/)文档：

> 该`jQuery.data()`方法允许我们以一种安全的方式将任何类型的数据附加到 DOM 元素，从而避免循环引用，从而避免内存泄漏。**jQuery 确保在通过 jQuery 方法删除 DOM 元素以及用户离开页面时删除数据。**我们可以为单个元素设置几个不同的值并稍后检索它们：

# winapi - 使用 Python 3.2 完全锁定 Windows 7？

> ID：10020389
> 
> 赞同：0
> 
> 时间：2012-04-04T22:52:10.343
> 
> 标签：winapi, windows-7, python-3.x, block, pywin32

这可能是一个更困难的问题，因为我什至不知道如何在 Python 之外做到这一点......

我想编写一个终端程序，在输入密码之前完全锁定我的电脑。在锁定状态下，任何人都不能在终端*之外做任何事情。*在其中，用户可能会横冲直撞并编写愚蠢的命令，但他应该无法切换窗口，在其外部单击，打开任务管理器，使用*Ctrl + Alt Gr + Del*打开菜单等。

在寻找一种方法来实现这一点时，我想到了 Python 也能够做到的两种方法：

*   修改注册表**->**可以禁用任务管理器和其他一些功能，但不能禁用应用程序切换器和菜单
*   任务杀死 explorer.exe 和 dwm.exe **->**杀死 explorer.exe 刚刚删除了任务栏，杀死 dwm.exe 似乎是正确的方法，但由于它是窗口管理器，它一旦被杀死就会自动重新启动

我知道这是一个奇怪的问题，不包含*任何*代码片段，但是前端没问题，正如我所说的，我什至没有后端的工作方法。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-02-02T16:30:20.213

1.  写一个while循环
2.  进入while循环，将命令写入taskkill dwm.exe

这是一个糟糕的解决方案，但我知道的唯一一个。

问候！

# apache-pig - apache pig Java UDF - 更改属性中的值似乎并没有坚持

> ID：10020396
> 
> 赞同：2
> 
> 时间：2012-04-04T22:52:56.307
> 
> 标签：apache-pig

我正在尝试编写一个 Java UDF，它将使用 Java UDF 对包中的元组进行排名。元组具有作为排名标准的值列和初始设置为 0 的排名列。元组基于值列进行排序。所有的元组都放在一个袋子里，而那个袋子又放在一个传递给 UDF 的新元组中。

然而，UDF 正在修改排名列 - 一旦方法退出，值都再次变为 0。我不确定如何将值设置为“Stick”。

任何帮助将不胜感激。

这是我的java类

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import org.apache.pig.FilterFunc;
import org.apache.pig.EvalFunc;
import org.apache.pig.backend.executionengine.ExecException;
import org.apache.pig.data.DataType;
import org.apache.pig.data.Tuple;
import org.apache.pig.data.DataBag;
import org.apache.pig.impl.logicalLayer.FrontendException;
import java.util.Iterator;
import org.apache.pig.PigWarning;

/**
 *
 * @author Winter
 */
public class Ranker  extends EvalFunc<String>{
    @Override
    public String exec(Tuple tuple) throws IOException {
        if (tuple == null || tuple.size() == 0) {
            return null;
        }

        List<Object> list = tuple.getAll();
        DataBag db = (DataBag) list.get(0);
        Integer num = (Integer)list.get(1);

        Iterator<Tuple>itr = db.iterator();
        boolean containsNonNull = false;
        int i = 1;
        double previous=0;
        while (itr.hasNext()) {

            Tuple t= itr.next();
            double d = (Double)t.get(num.intValue());
            int rankCol = t.size()-1;
            Integer rankVal = (Integer)t.get(rankCol);
            if(i == 0){    
                System.out.println("i==0");
                previous = d;
                t.set(rankCol, i);
            } else {
                if(d == previous)
                    t.set(rankCol, i);
                else{
                    System.out.print("d!==previous|" + d + "|"+ previous+"|"+rankVal);
                    t.set(rankCol, ++i);
                    rankVal = (Integer)t.get(rankCol);
                     System.out.println("|now rank val" + rankVal);
                    previous = d;
                }
            }
        }

        return "Y";
    }
} 
```

这就是我如何称呼 Pig 中的所有内容 -

```
REGISTER /myJar.jar;
A = LOAD '/Users/Winter/milk-tea-coffee.tsv'  as (year:chararray, milk:double);
B = foreach A generate year, milk, 0 as rank;
C = order B by milk asc; 
D = group C by rank order C by milk;
E = foreach D generate D.C.year,D.C.milk,D.C.rank,  piglet3.evalFunctions.Ranker(D.C,1);
dump E; 
```

由于 UDF 中的打印语句，我可以告诉它在 UDF 中的工作 - d!==previous|21.2|0.0|0|now rank val2 d!==previous|21.6|21.2|0|now rank val3 d!= =previous|21.9|21.6|0|now rank val4 d!==previous|22.0|21.9|0|now rank val5 d!==previous|22.5|22.0|0|now rank val6 d!==previous|22.9| 22.5|0|now rank val7 d!==previous|23.0|22.9|0|now rank val8 d!==previous|23.4|23.0|0|now rank val9 d!==previous|23.8|23.4|0|now rank val10 d!==previous|23.9|23.8|0|now rank val11

但是当我转储 E 或 D 或 C 时，排名列仅包含 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:59:52.960

exec 函数必须从 UDF 返回您想要的输出。您当前正在修改传递给 exec 函数的元组，然后返回字符串“Y”——Pig 看到的所有 UDF 输出都是“Y”。在这种情况下，您应该返回元组而不是“Y”。

我认为以下代码接近您的意图，但我不太清楚您要做什么：

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import org.apache.pig.FilterFunc;
import org.apache.pig.EvalFunc;
import org.apache.pig.backend.executionengine.ExecException;
import org.apache.pig.data.DataType;
import org.apache.pig.data.Tuple;
import org.apache.pig.data.DataBag;
import org.apache.pig.impl.logicalLayer.FrontendException;
import java.util.Iterator;
import org.apache.pig.PigWarning;

/**
 *
 * @author Winter
 */
public class Ranker  extends EvalFunc<Tuple>{
    @Override
    public Tuple exec(Tuple tuple) throws IOException {
        if (tuple == null || tuple.size() == 0) {
            return null;
        }

        List<Object> list = tuple.getAll();
        DataBag db = (DataBag) list.get(0);
        Integer num = (Integer)list.get(1);

        Iterator<Tuple>itr = db.iterator();
        boolean containsNonNull = false;
        int i = 1;
        double previous=0;
        while (itr.hasNext()) {

            Tuple t= itr.next();
            double d = (Double)t.get(num.intValue());
            int rankCol = t.size()-1;
            Integer rankVal = (Integer)t.get(rankCol);
            if(i == 0){    
                System.out.println("i==0");
                previous = d;
                t.set(rankCol, i);
            } else {
                if(d == previous)
                    t.set(rankCol, i);
                else{
                    System.out.print("d!==previous|" + d + "|"+ previous+"|"+rankVal);
                    t.set(rankCol, ++i);
                    rankVal = (Integer)t.get(rankCol);
                     System.out.println("|now rank val" + rankVal);
                    previous = d;
                }
            }
        }

        return tuple;
    }
} 
```

# java - 迭代 NxN 矩阵的所有子矩阵的最佳/最快方法

> ID：10020403
> 
> 赞同：0
> 
> 时间：2012-04-04T22:53:40.313
> 
> 标签：java, algorithm, matrix

我有一个方板（NxN 矩阵）。每个正方形（单元格）都有与其相关的特定点。我的目标是找到具有最高点总和的最大子矩阵。我开始尝试找到所有子矩阵及其权重。但我被困在如何去做这件事上。

我想我可以有一个`HashMap<String,Integer>`存储初始行、列和子矩阵的大小。代码应如下所示：

```
int [][] mat = new int[10][10];

void countSubMatrix()
{
    for(int i = 0; i<mat.length; i++)
    {
        for(int j = 0; j<mat[i].length; j++)
        {
            storeSubMatrix(i,j);
        }
    }
}

void storeSubMatrix(int x, int y)
{
    int size = 0;
    int tempX = x;
    int tempY = y;
    while(tempX < board.length && tempY < board[x].length)
    {
        map.put(x.toString() + "," + y.toString(),size+1);
        tempX++;
        tempY++;
    }
} 
```

但我不知道这是否是正确的方法。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:55:19.203

最大的子矩阵，即它也可以是一个矩形，那么[这](http://www.algorithmist.com/index.php/UVa_108)可能对你有帮助。使用 kadane 的矩阵算法可以在`O(n^3)`.

# objective-c - 完成编辑文本字段后，按钮消失，但切换到另一个文本字段

> ID：10020408
> 
> 赞同：0
> 
> 时间：2012-04-04T22:54:09.983
> 
> 标签：objective-c, uibutton, uitextfield

`UIButton`每次我完成编辑时，我都会消失，`UITextField`我调用该`textFieldDidEndEditing:`方法，只是让按钮消失。这很好用，除非我切换到另一个文本字段而不单击第一个。因此，例如，我在文本字段 A 上，只需点击文本字段 B，键盘仍然保持不变，按钮也是如此。我不相信有一种方法可以覆盖这样的文本字段切换，只有在所有文本字段都完成编辑时。我错了吗？这是我的代码：

```
-(BOOL) textFieldShouldBeginEditing:(UITextField *)textField
{
negButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
negButton.frame = CGRectMake(textField.frame.origin.x, textField.frame.origin.y, 37, textField.frame.size.height);
[negButton setAlpha:0];

return YES;
}

-(void) textFieldDidBeginEditing:(UITextField *)textField
{
if ([textField isEditing])
{
    [UIView animateWithDuration:0.3 animations:^
     {
         field = textField;

         CGRect frame = textField.frame;

         frame.size.width -= 40;
         frame.origin.x += 40;

         [negButton setAlpha:1];
         [textField setFrame:frame];
         [self.view addSubview:negButton];
     }];
}
}

-(void) textFieldDidEndEditing:(UITextField *)textField
{
    [UIView animateWithDuration:0.3 animations:^
     {

         CGRect frame = textField.frame;
         frame.size.width += 40;
         frame.origin.x -= 40;

         [negButton setAlpha:0];

         [textField setFrame:frame];
     } 
     ];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:14:00.197

在我看来，您正在调用按钮以显示在

```
textFieldShouldBeginEditing 
```

方法，这很好，你正在删除它

```
textFieldDidEndEditing 
```

方法，也不错。为什么在切换到另一个文本框时按钮没有消失是因为当您点击该文本框时，在**endEditing**方法之后立即调用**shouldBeginEditing**方法，导致按钮在删除后立即重新出现。

这是它*应该工作*的方式，如果你希望它以不同的方式工作，你将不得不使代码特定于每个文本字段

前任：

```
- (BOOL)textFieldShouldBeginEditing:(UITextField*)textField
{
    if(textField == myField1)
    {
        //make button appear
    }
    else if(textField == myField2)
    {
        //Something else
    }
} 
```

瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:53:31.867

这里的问题是您的委托方法被调用的顺序。

假设您要从 textField1 转到 textField2。

一旦 textField1 已经处于活动状态并且您单击 textField2，它们就会像这样被调用：

```
textFieldShouldBeginEditing (textField2)
textFieldShouldEndEditing   (textField1)
textFieldDidEndEditing      (textField1)
textFieldDidBeginEditing    (textField2) 
```

您正在创建**新** `negButton`的，`textFieldShouldBeginEditing`其中通过在 textField2 旁边创建一个并存储它的引用来覆盖对“旧”按钮（在 textField1 旁边）的引用。接下来，您调用`textFieldDidEndEditing`和`textFieldDidBeginEditing`在新按钮上。

您要做的是将当前位于的代码移动`textFieldShouldBeginEditing`到开头，`textFieldDidBeginEditing`以便在创建新方法之前，前两种方法作用于适当的按钮。

# python - Python中的CSV列到数组

> ID：10020413
> 
> 赞同：4
> 
> 时间：2012-04-04T22:54:41.387
> 
> 标签：python, arrays, csv

我很难处理在我看来是一个简单的问题。我正在尝试导入 csv 并将其列拆分为可以运行不同操作的数组，然后将 zip() 重新组合在一起。

```
import csv

data = csv.reader(open('test.csv', 'rb'), delimiter=",", quotechar='|')
column1, column2 = [], []

for row in data:
    column1.extend(row[0])
    column2.extend(row[1])

print column1
print column2 
```

此代码打印两个数组，其中的元素是单独的字符而不是字符串。当我尝试对单个列执行此操作时， column1.extend(row) 会执行我想要的操作。

我对解决此特定问题或将其推广到 n 列的方法感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T22:57:25.063

您需要更改`column1.extend(row[0])`为`column1.append(row[0])`（很明显，对于第 2 列也是如此）。Extend 用于将一个列表的内容添加到另一个列表中，append 用于添加单个元素。Extend 告诉 python 将字符串视为其字符列表并附加每个字符。

```
>>> lst = []
>>> lst.extend("foo")
>>> lst
['f', 'o', 'o']
>>> lst.append("foo")
>>> lst
['f', 'o', 'o', 'foo'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T22:59:02.353

column1 和 column2 是**列表**。您要使用的方法是*append()*而不是*extend()*。

查看官方文档： [http ://docs.python.org/tutorial/datastructures.html](http://docs.python.org/tutorial/datastructures.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T22:59:33.270

每个`row`索引都是一个字符串，所以如果你想将它添加到你的列中，你可以这样做：

```
column1.append(row[0]) 
```

或这个：

```
column1.extend([row[0]]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-09T14:05:10.133

另外一个选项：

```
column1 = [row[0] for row in data] 
```

# python - ImportError：Google App Engine 上没有名为模板的模块，尽管 Web.py 已编译模板

> ID：10020419
> 
> 赞同：1
> 
> 时间：2012-04-04T22:55:06.763
> 
> 标签：python, google-app-engine, web.py

在 Windows 7 和最新的 webpy 上使用 Python26。

我复制了在 GAE 上设置 Web.py 的基本示例 (http://webpy.appspot.com/)，并按照说明编译模板以用于 GAE (http://webpy.org/cookbook/templates_on_gae) ，但这样做之后仍然有 ImportError: No module named templates。

明确一点：有很多人遇到过这个问题，解决方案是编译模板。我这样做了；仍然是同样的错误。

我的实现在这里：[https](https://bitbucket.org/rhiaro/gae-tutorial) ://bitbucket.org/rhiaro/gae-tutorial（在 webpyworld 目录中）。

我的主文件 code.py 是：

```
from google.appengine.ext import db
import web

urls = (
'/', 'index',
'/note', 'note',
'/crash', 'crash'
)

render = web.template.render('templates/')

class Note(db.Model):
content = db.StringProperty(multiline=True)
date = db.DateTimeProperty(auto_now_add=True)

class index:
def GET(self):
    notes = db.GqlQuery("SELECT * FROM Note ORDER BY date DESC LIMIT 10")
    return render.index(notes)

class note:
def POST(self):
    i = web.input('content')
    note = Note()
    note.content = i.content
    note.put()
    return web.seeother('/')

class crash:
def GET(self):
    import logging
    logging.error('test')
    crash

app = web.application(urls, globals())

def main():
app.cgirun()

if __name__ == '__main__':
  main() 
```

按照说明编译模板已在模板文件夹中生成正确的 __ init __.py。但它仍然不会将其识别为模块。

错误输出的最后一部分：

```
path\to\webpyworld\code.py in ()
8 )
9 
10 render = web.template.render('templates/')
11 
12 class Note(db.Model):
render undefined, web = <module 'web' from 'D:\gaeTut\webpyworld\web\__init__.pyc'>, web.template = <module 'web.template' from 'D:\gaeTut\webpyworld\web\template.py'>, web.template.render = <class web.template.GAE_Render>
path\to\webpyworld\web\template.py in __init__(self=<web.template.GAE_Render instance>, loc='templates/', *a=(), **kw={})
1031         else:
1032             name = loc.rstrip('/').replace('/', '.')
1033             self.mod = __import__(name, None, None, ['x'])
1034 
1035         self.mod.__dict__.update(kw.get('builtins', TEMPLATE_BUILTINS))
self = <web.template.GAE_Render instance>, self.mod undefined, builtin __import__ = <built-in function __import__>, name = 'templates', builtin None = None

<type 'exceptions.ImportError'>: No module named templates 
  args = ('No module named templates',) 
  message = 'No module named templates' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T11:44:49.943

您在 app.yaml 中将 templates/ 指定为 static_dir。

这意味着它不适用于应用程序代码，而只会直接响应用户对模板本身的直接请求而提供服务。

# visual-studio - 检测 Visual Studio 许可证类型/分发渠道

> ID：10020421
> 
> 赞同：6
> 
> 时间：2012-04-04T22:55:20.817
> 
> 标签：visual-studio, registry, licensing, msdn

整个网络上有大量关于如何使用 PID（可以在`HKLM\SYSTEM\Setup\Pid`注册表项中找到）和 ProductID（可以在 中找到`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion`）检测 Windows 许可证类型和分发渠道的信息。

但是，关于如何检测用于安装其他 Microsoft 产品的许可类型的信息非常少。

也就是说，我需要确定哪些是使用 MSDN 订阅许可证安装的，哪些是使用其他许可证类型安装的。

`Uninstall`通过分析产品 GUID（在注册表分支中找到），我设法找到了一些关于 Office 风格的信息：

*   [办公室2000](http://support.microsoft.com/kb/230848)
*   [办公室 XP](http://support.microsoft.com/kb/302663)
*   [办公室2003](http://support.microsoft.com/kb/832672)
*   [办公室 2007](http://support.microsoft.com/kb/928516)
*   [办公室 2010](http://support.microsoft.com/kb/2186281)

但是，所有这些文章仅区分这些版本类型：

*   0 批量许可证
*   1 零售/OEM
*   2 试用
*   5 下载

此外，我找不到任何关于其他产品的可行信息。即，Visual Studio ...（这是我最感兴趣的一个）。

澄清一下：我**不需要**获取**许可证密钥**（在寻找我需要的信息时我已经找到了几种检测方法），我的兴趣仅在于检测用于安装应用程序的**许可证类型。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T21:08:33.830

[http://blogs.msdn.com/b/heaths/archive/2010/05/04/detection-keys-for-net-framework-4-0-and-visual-studio-2010.aspx](http://blogs.msdn.com/b/heaths/archive/2010/05/04/detection-keys-for-net-framework-4-0-and-visual-studio-2010.aspx)

```
Visual Studio 2010
The detection keys for Visual Studio are used both to detect if the product is installed and what service pack level is installed. As with previous versions, these keys and values are under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing.

Key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing\10.0\$(var.ProductEdition)\$(var.LCID)
Name    Install
Type    REG_DWORD (32-bit integer)
Data    0x00000001 (1)
The values for $(var.ProductEdition) include the following table. The for other products, this value corresponds to the ProductEdition property in the Property table of the Windows Installer package for that product. The locale IDs for $(Var.LCID) are listed here.

Visual Studio 2010 Ultimate      VSTSCore
Visual Studio 2010 Premium       VSTDCore
Visual Studio 2010 Professional  PROCore
Visual Studio 2010 Shell (Integrated)   IntShell
For Dev10 we have also added detection values to the edition keys so that you do not have to detect every single language for ever edition.

Key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing\10.0\$(var.ProductEdition)
Name    Install
Type    REG_DWORD (32-bit integer)
Data    0x00000001 (1)
These registry keys and values are also used to detect the service pack level. Instead of checking for the Name registry value, check the SP registry value. Ignore SPIndex; Microsoft uses this internally. In addition to the registry keys above, we also set a version-dependent registry value listed below.

Key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing\10.0
Name    SP
Type    REG_DWORD (32-bit integer)
Data    0x00000001 (1)
Keep in mind, however, that as with all shared resources the more shared a resource is the less accurate it may be. This is because there is no version policy for registry values and other resources that do not have versions like text files. If two languages were installed at different servicing pack levels – which is unsupported but possible – the value would be set by the last product to be installed or reinstalled (repaired).

For more information, see the Visual Studio 2010 detection system requirements. This also includes information to use the CompLocator in your Windows Installer package as an alternative to registry detection. 
```

[http://www.mztools.com/articles/2008/MZ2008003.aspx](http://www.mztools.com/articles/2008/MZ2008003.aspx)

```
To detect which Visual Studio version a (multi-IDE) add-in is running under, you can use the EnvDTE.DTE.RegistryRoot property, which can return the following values:
For Visual Studio 2005: Software\Microsoft\VisualStudio\8.0
For Visual Studio 2008: Software\Microsoft\VisualStudio\9.0
To detect the edition and subedition of the Visual Studio IDE you can use the IVsShell interface, calling its GetProperty method with the Microsoft.VisualStudio.Shell.Interop.__VSSPROPID2.VSSPROPID_SKUEdition and Microsoft.VisualStudio.Shell.Interop.__VSSPROPID2.VSSPROPID_SubSKUEdition values.

Note: To get a service from an add-in, see HOWTO: Get a Visual Studio service from an add-in; and to know how to reference an assembly from the GAC (such as Microsoft.VisualStudio.Shell.Interop.dll), see HOWTO: Reference a Visual Studio assembly in the GAC from an add-in.

The returned results are not well documented but some values are provided in the following sample add-in:

Imports System
Imports Microsoft.VisualStudio.CommandBars
Imports Extensibility
Imports EnvDTE
Imports System.Runtime.InteropServices
Imports Microsoft.VisualStudio.Shell.Interop
Imports System.Windows.Forms

<ComVisible(True), ComImport(), Guid("6D5140C1-7436-11CE-8034-00AA006009FA"), _
InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)> _
Friend Interface IServiceProvider
   <PreserveSig()> _
   Function QueryService(<InAttribute()> ByRef guidService As Guid, _
      <InAttribute()> ByRef riid As Guid, <OutAttribute()> ByRef ppvObject As IntPtr) As Integer
End Interface

Public Class Connect
   Implements IDTExtensibility2

   Private Enum SKUEdition
      SKUEdition_None = 0
      SKUEdition_Express = 500
      SKUEdition_Standard = &H3E8
      SKUEdition_Professional = &H7D0
      SKUEdition_AcademicProfessional = &H834
      SKUEdition_AcademicStudent = &H834
      SKUEdition_AcademicStudentMSDNAA = &H898
      SKUEdition_AcademicEnterprise = &H8FC
      SKUEdition_Book = &H960
      SKUEdition_DownloadTrial = &H9C4
      SKUEdition_Enterprise = &HBB8
   End Enum

   Private Enum SubSKUEdition
      SubSKUEdition_None = &H0
      SubSKUEdition_VC = &H1
      SubSKUEdition_VB = &H2
      SubSKUEdition_CSharp = &H4
      SubSKUEdition_Architect = &H8
      SubSKUEdition_IDE = &H10
      SubSKUEdition_JSharp = &H20
      SubSKUEdition_Web = &H40
      SubSKUEdition_TeamEditionDevelopers = &H80
   End Enum

   Public Function GetService(ByVal serviceProvider As Object, ByVal type As System.Type) As Object
      Return GetService(serviceProvider, type.GUID)
   End Function

   Public Function GetService(ByVal serviceProvider As Object, ByVal guid As System.Guid) As Object

      Dim objService As Object = Nothing
      Dim objIServiceProvider As IServiceProvider
      Dim objIntPtr As IntPtr
      Dim hr As Integer
      Dim objSIDGuid As Guid
      Dim objIIDGuid As Guid

      objSIDGuid = guid
      objIIDGuid = objSIDGuid
      objIServiceProvider = CType(serviceProvider, IServiceProvider)

      hr = objIServiceProvider.QueryService(objSIDGuid, objIIDGuid, objIntPtr)
      If hr <> 0 Then
         System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(hr)
      ElseIf Not objIntPtr.Equals(IntPtr.Zero) Then
         objService = System.Runtime.InteropServices.Marshal.GetObjectForIUnknown(objIntPtr)
         System.Runtime.InteropServices.Marshal.Release(objIntPtr)
      End If

      Return objService

   End Function

   Public Sub OnConnection(ByVal Application As Object, ByVal ConnectMode As Extensibility.ext_ConnectMode, _
      ByVal AddInInst As Object, ByRef custom As System.Array) _
      Implements Extensibility.IDTExtensibility2.OnConnection

      Dim objDTE As DTE
      Dim objService As Object
      Dim objIVsShell As IVsShell
      Dim objValue As Object = Nothing
      Dim eSKUEdition As SKUEdition
      Dim eSubSKUEdition As SubSKUEdition

      Select Case ConnectMode

         Case ext_ConnectMode.ext_cm_AfterStartup, ext_ConnectMode.ext_cm_Startup

            objDTE = DirectCast(Application, DTE)
            objService = GetService(objDTE, GetType(IVsShell))
            objIVsShell = CType(objService, IVsShell)

            If objIVsShell.GetProperty(__VSSPROPID2.VSSPROPID_SKUEdition, objValue) = 0 Then
               eSKUEdition = CType(objValue, SKUEdition)
               MessageBox.Show(eSKUEdition.ToString)
            End If

            If objIVsShell.GetProperty(__VSSPROPID2.VSSPROPID_SubSKUEdition, objValue) = 0 Then
               eSubSKUEdition = CType(objValue, SubSKUEdition)
               MessageBox.Show(eSubSKUEdition.ToString)
            End If

      End Select

   End Sub

   Public Sub OnAddInsUpdate(ByRef custom As System.Array) _
      Implements Extensibility.IDTExtensibility2.OnAddInsUpdate

   End Sub

   Public Sub OnBeginShutdown(ByRef custom As System.Array) _
      Implements Extensibility.IDTExtensibility2.OnBeginShutdown

   End Sub

   Public Sub OnDisconnection(ByVal RemoveMode As Extensibility.ext_DisconnectMode, _
      ByRef custom As System.Array) Implements Extensibility.IDTExtensibility2.OnDisconnection

   End Sub

   Public Sub OnStartupComplete(ByRef custom As System.Array) _
      Implements Extensibility.IDTExtensibility2.OnStartupComplete

   End Sub

End Class
To detect whether a specific Visual Studio package is installed or not, you can use the IsPackageInstalled method of the IVsShell interface, which receives the Guid of the package.
Detecting installed Visual Studio Service Packs

Visual Studio uses the following Windows registry entries to track the installed service packs for the several versions (2005, 2008), editions (Standard, Professional, etc.) and languages (English, Spanish, etc.):

HKEY_LOCAL_MACHINE\Software\Microsoft\DevDiv\VS\Servicing\<version>\<edition>\<localeId>

where <version> and <edition> where explained in a previous section of this article and <localeId> is 1033 for English, 3082 for Spanish, etc.

For example, when Visual Studio 2005 Team Edition for Developers has SP1 installed, the value of the "SP" registry entry of HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\VS\Servicing\8.0\VSTD\1033 is set to 1.

To know the service at general level (without taking into account the edition and language) you can use the "SP" registry entry under the registry key:

HKEY_LOCAL_MACHINE\Software\Microsoft\DevDiv\VS\Servicing\<version> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T07:16:39.223

好的，所以我能看到的唯一方法是使用诸如[magicjellybeans key finder](http://www.magicaljellybean.com/keyfinder/)之类的工具，然后从您的msdn许可证中导出密钥并进行比较。

仅从软件本身来看，我很确定它们本身并没有被识别为 MSDN 版本，但是激活它们的许可证决定了这一点，所以我很确定你所要求的内容是不可能的，因为你描述它而不做比较这意味着您需要密钥。

尤其如此，因为 msdn 中的某些产品已经并且确实使用了软件的“零售版本”。

# javascript - 从 JSON 数组中删除行会留下“空”

> ID：10020422
> 
> 赞同：13
> 
> 时间：2012-04-04T22:55:27.130
> 
> 标签：javascript, jquery, json

[http://jsfiddle.net/J2KuY/](http://jsfiddle.net/J2KuY/)

在 test2 中，您可以看到它不是从数组中删除节点，而是将节点替换为“null”。

我做错了什么，我怎样才能完全删除它？

编辑：使用拼接而不是删除。在这里更新小提琴：http: [//jsfiddle.net/J2KuY/1/](http://jsfiddle.net/J2KuY/1/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T22:56:58.133

使用拼接：

[http://www.w3schools.com/jsref/jsref_splice.asp](http://www.w3schools.com/jsref/jsref_splice.asp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T23:18:48.270

[这是一个](http://jsfiddle.net/J2KuY/8/)带有链接的示例

```
//say you have these arrays
var test1 = [{
    "Country": "Spain",
    "info info1": 0.329235716,
    "info info2": 0.447683684,
    "info info3": 0.447683747},
{
    "Country": "Chile",
    "info info1": 1.302673893,
    "info info2": 1.357820775,
    "info info3": 1.35626442},
{
    "Country": "USA",
    "info info1": 7.78805016,
    "info info2": 26.59681951,
    "info info3": 9.200900779}];

var test2 = [{
    "Country": "Germany",
    "info info1": 0.329235716,
    "info info2": 0.447683684,
    "info info3": 0.447683747},
{
    "Country": "China",
    "info info1": 1.302673893,
    "info info2": 1.357820775,
    "info info3": 1.35626442},
{
    "Country": "France",
    "info info1": 7.78805016,
    "info info2": 26.59681951,
    "info info3": 9.200900779}];

//similar to jQuery, wrap them in an object
function $W(param) {
    var obj = {};

    //set data
    obj.data = param;

    //augment the object with a remove function
    obj.remove = function(key, val) {
        var i = 0;
        //loop through data
        while (this.data[i]) {
            if (this.data[i][key] === val) {
                //if we have that data, splice it
                //splice changes the array length so we don't increment
                this.data.splice(i, 1);
            } else {
                //else move on to the next item
                i++;
            }
        }
        //be sure to return the object so that the chain continues
        return this;
    }

    //return object for operation
    return obj
}

//the following will look strangely similar to jQuery

//remove chile, then USA
var result1 = $W(test1).remove('Country', 'Chile').remove('Country', 'USA');

//remove germany and china
var result2 = $W(test2).remove('Country', 'China').remove('Country', 'Germany');

//should only have spain and france
$('#test2').val(JSON.stringify(result1)+JSON.stringify(result2));​ 
```

# visual-studio - 我可以从 Visual Studio 的格式文档中排除部分代码吗

> ID：10020424
> 
> 赞同：3
> 
> 时间：2012-04-04T22:55:43.890
> 
> 标签：visual-studio, visual-studio-2010, code-formatting

我在代码中有一些音译表，这些表的格式便于查看对，简化示例：

```
 oldChar = new string[] { "Æ",  "æ",  "Å", "å", "Ä", "ä", "Ø", "ø", "Ö", "ö" };
  newChar = new string[] { "AE", "ae", "A", "a", "A", "a", "O", "o", "O", "o" }; 
```

作为一种习惯，我经常使用 Visual Studio Format Document 命令，自然而然地，该命令将这段代码变成了这样：

```
 oldChar = new string[] { "Æ", "æ", "Å", "å", "Ä", "ä", "Ø", "ø", "Ö", "ö" };
  newChar = new string[] { "AE", "ae", "A", "a", "A", "a", "O", "o", "O", "o" }; 
```

我可以告诉它不要管这部分，也许是为了地区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:03:20.550

不幸的是，你不能。格式命令对整个文档或文本选择起作用。不能告诉它格式化和排除特定部分。

我想到了几个非常老套的选择

*   注释掉行、格式、取消注释
*   编写一个宏来格式化上面的选择，然后在下面

# javascript - 如何使用 Mongoose/MongoDB 直接插入 JSON？

> ID：10020428
> 
> 赞同：1
> 
> 时间：2012-04-04T22:56:06.073
> 
> 标签：javascript, json, mongodb, mongoose

当我一直在处理 JSON 时，手动定义模式似乎有点令人费解。有没有办法将 JSON 转换为 BSON，从而减轻开发人员每次手动定义模式的需要？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T15:15:43.150

你看过 node-mongodb-native[1] 吗？听起来它可能更适合您的需求，因为它不需要预定义的架构。

[1] [https://github.com/christkv/node-mongodb-native](https://github.com/christkv/node-mongodb-native)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-22T22:38:11.107

有一个工具 mongoimport 可以做到这一点

[http://www.mongodb.org/display/DOCS/Import+Export+Tools](http://www.mongodb.org/display/DOCS/Import+Export+Tools)

# php - 如何隐藏url的参数

> ID：10020429
> 
> 赞同：1
> 
> 时间：2012-04-04T22:56:10.810
> 
> 标签：php, magento

我在网站上用一个简单的整数生成了 url，允许用户查看过去的订单。

`http://site.com/order_id/145323`

问题是很容易改变这个数字然后查看其他人的订单。我想知道在 url 中编码这个数字然后让 php 解码它以便它可以运行控制器的简单方法是什么？它不必是超级安全的，只要某些东西使某人仅仅更改数字即可查看数据就变得不那么容易了。我尝试做类似的事情：

`order_id/<?php echo base64_encode($theOrder); ?>`

然后在我尝试的控制器操作中：

```
if($orderId = (int) $this->getRequest()->getParam('order_id') && Mage::getSingleton('customer/session')->isLoggedIn()){         
        $orderId = (int) $this->getRequest()->getParam('order_id'); 
        $orderId = base64_decode($orderId); 
        $order = Mage::getModel('sales/order')->load($orderId);
        Mage::register('current_order', $order);
        $this->loadLayout();
        $this->renderLayout();
    } 
```

但这不起作用。什么是在 url 中隐藏此参数的好方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T22:57:49.017

**你做错了**。而不是试图掩盖`id`你只需要确保（检查后端）`id`属于用户。

如果 id 不属于该用户，则返回状态代码之一`403 Forbidden`或简单`404 Not Found`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:05:11.320

正如其他人所说，解决此问题的最佳方法是修改您访问数据的方式，并检查请求中的订单号是否与尝试访问它的用户相关联。

但如果您需要快速修复，您可以检查请求的 HTTP_REFERER 是否已设置。如果它已设置，并且它指向您网站上的某个页面，那么您可以合理地确定这是一个合法的请求。如果用户通过修改订单号修改了 URL，则 HTTP_REFERER 将为空。

这不是一个完美的解决方案，但它肯定会阻止人们浏览他们不应该浏览的订单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:58:02.763

当然，如果它是关于人员和订单的，您将有一个用户表或数据存储，当解析随机 url 时，检查该订单号是否属于当前登录的用户，如果是，则允许数据，如果不是，返回'未经授权，请登录'

**编辑**

我不确定你的系统需要什么，但纯粹假设运行，这可能很有用......

我假设用户下订单。所以我还假设有一个 ORDERS 表，所有订单都存储和获取。

在 ORDERS 表中，您应该存储下订单的用户，比如

```
USERS table
----------
user_id, username, password, full name, dob, etc

ORDERS table
----------
order_id, order_type, quantity, date_ordered, user_id 
```

因此，您可以使用 SQL 查询来获取与订单关联的用户。

就像是`SELECT username FROM users JOIN orders ON users.user_id = orders.uder_id`

然后根据当前登录的用户检查返回的用户名。

如果我侮辱了你的智商，我很抱歉，但我不确定你到底在追求什么！

# python - 在 python 中，检测类型，然后转换为该类型

> ID：10020430
> 
> 赞同：3
> 
> 时间：2012-04-04T22:56:20.773
> 
> 标签：python

为了支持一些遗留代码，我必须读取一个文本文件并将其解析为类似`x=102`和`file=foo.dat`可能用于覆盖默认值的语句。请注意，第二个没有`file='foo.dat'`；这些不是 python 语句，但它们很接近。

现在，我可以得到`type`默认对象的，所以我知道它`x`应该是一个 int 并且`file`应该是一个 str。因此，我需要一种将右侧转换为该类型的方法。我想以编程方式执行此操作，以便我可以调用一个简单的默认设置函数。特别是，我宁愿不必遍历所有内置类型。可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T23:00:13.057

```
# Get the type object from the default value
value_type = type(defaults[fieldname])

# Instantiate an object of that type, using the string from the input
new_value = value_type(override_value) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:02:55.283

其实很简单：

```
textfromfile = '102'
defaultobject = 101
value = (type(defaultobject))(textfromfile) 
```

现在，`value`是一个等于 102 的 int。

# iphone - 将值添加到我的 plist

> ID：10020431
> 
> 赞同：0
> 
> 时间：2012-04-04T22:56:22.167
> 
> 标签：iphone, ios, nsdictionary

我有我创建的这个 plist

![在此处输入图像描述](../Images/e17c544bb4f6d175a067bcab10824bfd.png)

我已经编写了我的大部分控制器类，它获取了这个 plist 并将其加载到文档目录中，因此它可以读取/写入。

目前我的阅读工作正常，而且我以前也有写作工作，但是我最近刚刚将其中一个对象（缓存值）更改为具有相关值的字典。现在，当我尝试写入此 plist 时，我的应用程序崩溃了。

这是我得到的错误。

> 2012-04-05 09:26:18.600 mycodeTest[874:f803] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** -[NSDictionary initWithObjects:forKeys:]：对象数 (4) 与keys (5)' *** First throw call stack: (0x12cc022 0x1884cd6 0x1248417 0x12685e2 0x19844 0x17e86 0x17669 0x13b67 0xe53a49 0xe51e84 0xe52ea7 0xe51e3f 0xe51fc5 0xd96f5a 0x1d2aa39 0x1df7596 0x1d21120 0x1df7117 0x1d20fbf 0x12a094f 0x1203b43 0x1203424 0x1202d84 0x1202c9b 0x21aa7d8 0x21aa88a 0x450626 0x77ed 0x1e35 0x1) terminate called throwing an exceptionCurrent语言：自动；目前客观-c

考虑到所有这些，我现在将向您展示我的方法，当它具有准备保存的值时，它会从另一个类中调用。

```
//This method gets called from another class when it has new values that need to be saved
- (void) saveData:(NSString *)methodName protocolSignature:(NSString *)pSignature protocolVersion:(NSNumber *)pVersion requestNumber:(NSNumber *)rNumber dataVersionReturned:(NSNumber *)dvReturned cacheValue:(NSMutableDictionary *)cValue
{
    // get paths from root direcory
    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    // get documents path
    NSString *documentsPath = [paths objectAtIndex:0];
    // get the path to our Data/plist file
    NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

    // set the variables to the values in the text fields that will be passed into the plist dictionary
    self.protocol = pSignature;
    self.Version = pVersion;
    self.request = rNumber;
    self.dataVersion = dvReturned;

    //if statment for the different types of cacheValues
    if (methodName == @"GetMan")
    {
        //cache value only returns the one cachevalue depending on which method name was used
        [self.cacheValue setValue:cValue forKey:@"Man"]; //do I need to have the other values of cacheValue dictionary in here? if so how do I do that.
        c
    }
    else if (methodName == @"GetMod")
    {
        [self.cacheValue setValue:cValue forKey:@"Mod"];
    }
    else if (methodName == @"GetSubs")
    {
        [self.cacheValue setValue:cValue forKey:@"Subs"];
    }

    // This is where  my app is falling over and giving the error message
    // create dictionary with values in UITextFields
    NSDictionary *plistDict = [NSDictionary dictionaryWithObjects: [NSArray arrayWithObjects: protocol, pVersion, rNumber, dvReturned, cacheValue, nil] forKeys:[NSArray arrayWithObjects: @"Signature", @"Version", @"Request", @"Data Version", @"Cache Value", nil]];

    NSString *error = nil;
    // create NSData from dictionary
    NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:plistDict format:NSPropertyListXMLFormat_v1_0 errorDescription:&error];

    // check is plistData exists
    if(plistData)
    {
        // write plistData to our Data.plist file
        [plistData writeToFile:plistPath atomically:YES];

        NSString *myString = [[NSString alloc] initWithData:plistData encoding:NSUTF8StringEncoding];
        NSLog(@"%@", myString);
    }
    else
    {
        NSLog(@"Error in saveData: %@", error);
//        [error release];
    }
} 
```

当错误说 4 个键与 5 个不同时，我有点迷失了，而据我所知，我正在将 5 个值应用于字典，任何帮助将不胜感激。

编辑**我在调试问题时注意到的另一件事是，我似乎没有正确设置我的 cacheValue 字典，因为它显示了 0 个键值对？？？这是对还是错？ ![在此处输入图像描述](../Images/3b39fbadf2a60f7647b0ed0d4e76500b.png)

这就是当我使用下面的建议在 xcode 中记录我的 plist 时发生的情况`[NSDictionary dictionaryWithObjectsAndKeys:..etc`

```
Check setup is everything there?
Temp Dic output = {
    Root =     {
        "Cache Value" =         {
            Manu = 0;
            Mod = 0;
            Sub = 0;
        };
        "Data Version returned" = 0;
        "Signature" = null;
        "Version" = 0;
        "Request Number" = 0;
    };

Run Man cache check results
Temp Dic output = {
    "Version returned" = 5;
    "Signature" = Happy;
    "Version" = 1;
    "Request Number" = 4; 
```

如您所见，在我运行请求后，缓存值完全丢失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:08:03.737

在这种情况下，分解你的代码。使用临时变量将每一部分放在单独的行上。

将您的键和值放入临时数组中。

批出所有内容的值，或在调试器中设置断点并检查所有值。Eli 几乎可以肯定 cacheValue 是 nil 是正确的。arrayWithObjects 方法在第一个 nil 处停止。

这段代码：

```
NSString *string1 = @"string 1";
NSString *string2 = @"string 2";
NSString *string3 = @"string 3";
NSString *string4 =  nil;
NSString *string5 = @"string 5";

NSArray *anArray = [NSArray arrayWithObjects:
  string1,
  string2,
  string3,
  string4,
  string5,
  nil];

NSLog(@"anArray has %d elements", [anArray count]); 
```

将仅显示数组中的 3 个元素，即使 arrayWithObjects 行似乎添加了 5 个元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:03:18.227

我猜`cacheValue`当崩溃发生时它是 nil ，导致你的`values`数组中只有 4 个对象，但`keys`.

尝试`[NSDictionary dictionaryWithObjectsAndKeys:]`改用。

# php - 在通过json发送之前转换unix时间戳

> ID：10020442
> 
> 赞同：1
> 
> 时间：2012-04-04T22:57:26.027
> 
> 标签：php, javascript, ajax, json, date

首先感谢您花时间研究这个问题。

我将日期作为unix时间戳存储在我的数据库中，当我使用以下方式获取所有信息时：

```
 while($row = mysql_fetch_assoc($result)) {
        $posts[] = $row;
    }
    /* return the posts in the JSON format */
    return json_encode($posts); 
```

当我尝试使用以下方法获取日期时，该日期仅作为 unix 时间戳提供：

```
var postHandler = function(postsJSON) {
 $.each(postsJSON,function(i,post) {
alert(post.date);
}
} 
```

有没有办法在通过 JSON 发送之前将其转换为可读日期？甚至之后？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:02:11.557

当然，从 PHP 方面你可以这样做：

```
while($row = mysql_fetch_assoc($result)) {
    $row['your_date_field'] = date('r', $row['your_date_field']);
    $posts[] = $row;
} 
```

（您可以随意自定义传递给的格式字符串`date()`；`'r'`这只是一个简单的默认值。）

* * *

从 Javascript 方面，您可以这样做：

```
new Date(post.date); 
```

当呈现为字符串时，它将格式化为默认日期格式，或者您可以在`Date`对象上使用其他方法来获取其他格式。

* * *

您使用哪种方法取决于您，但正如 dragon 指出的那样，在客户端执行通常更好，因为它既减少了传输的数据，又为您提供了更大的灵活性，而无需解析字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:02:38.453

在 JavaScript 中使用[Date对象。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)

```
alert(new Date(post.date)) 
```

注意：最好在渲染之前一直以 UNIX 时间戳格式传递它，因为：

1.  它使有效负载保持在较低水平，因为您传输的是整数而不是字符串。
2.  它使您可以在客户端以不同方式使用时间戳，而无需再次解析它。例如`Date.now()/1000 - post.date`，将为您提供自帖子创建以来的秒数，依此类推。
3.  UNIX 时间戳对时区不敏感。在客户端呈现时，它将采用本地时区和格式。如果您在服务器上渲染它，它将位于服务器的时区并使用服务器的区域设置。

# java - 带有 FTP 和线程的 Java

> ID：10020443
> 
> 赞同：0
> 
> 时间：2012-04-04T22:57:32.167
> 
> 标签：java

我想要一个 Java 类将文件从 Windows 机器下载到 Unix 服务器，并使用 FTP 将文件从 Unix 服务器上传到 Windows 机器。这两个作业应该同步运行以执行这些任务。我假设在这里我需要两个线程。

任何人都可以发布示例代码来执行上述任务吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T22:58:57.970

我建议使用[Apache Commons Net](http://commons.apache.org/net/)库。

# javascript - 有没有办法在构造对象后注入特权方法？

> ID：10020445
> 
> 赞同：4
> 
> 时间：2012-04-04T22:57:44.843
> 
> 标签：javascript, private-members, privileged-functions

我正在尝试用 JavaScript 编写完全自动化的单元测试，并且正在寻找一种方法来读取各种 JS 函数中的一些私有变量。我想我想起了一种将特权成员注入函数/对象的方法（并发现“在 JS 中没有私有这样的东西”），但我找不到任何说明如何的资源。

我正在尝试阅读的属性，`.prototype`但如果有办法，这里的人会比我自己找到的更快地知道在哪里指导我。

谢谢

## 更新

1.  特权是指可从对象外部使用并有权读取“私有”变量（否则无法从外部读取的变量）的函数。有关 Crockford 的解释，请参阅[http://javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)。

2.  我尝试注入的函数示例是`o2`，我需要验证的值`x`（这是一个简化的示例，实际代码进行了一些转换并将它们发送到我计划单独测试的其他函数）。

    ```
    var o2 = function() {
        var x = 'me';
    }; 
    ```

更新 2：感谢所有花时间回复的人。尽管我在其他 SA 问题中看到人们说“JS 中没有任何东西是私有的”，但我看到这里的压倒性反应是“私有的就是私有的”。我想这更像是修辞评论，而不是我希望的对我还不知道的潜在漏洞的某种洞察。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T14:10:05.990

## 正确回答你的问题

即使我们尽力帮助您，您的问题的正确答案也很简单：

## ……你不能

如果我们可以直接从闭包外部访问它们，那么闭包变量会有什么好处呢？

如果您有一个带有*私有*变量的对象，则它们将无法在函数闭包（即构造函数）之外访问。

```
var c = function() {
    var priv = "private";
    this.get = function() {
        return priv;
    };
}

var o = new c();
o.injected = function() {
    return priv; // ERROR!!!!!! priv doesn't exist in function scope
}; 
```

如果您将整个事物封装在一个函数闭包中当然是不同的事情，但是您不会有对象私有，而是函数闭包*内部*将在此闭包内的所有原型之间共享。

```
(function(){

    var intrn = "internal";

    // omit "var" to make it global
    c = function() {
        this.get = function() {
            return intrn;
        };
    };

    // omit "var" to make it global
    o = new c();
    o.injected = function() {
        return intrn; // WORKS
    };
})();

o.injected(); 
```

但这与对象私有不同...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-19T15:56:48.343

知道我参加聚会已经很晚了，但是是的，这是可能的。虽然 AFAIK 它需要使用`eval()`和辅助方法：

```
function foo(){
    var a = 'a';
    this.addMethod = function(prop, val){
        this[prop] = eval('(' + val.toString() + ')');
    }
}
var bar = new foo();
bar.b = 'b';
var Fn = function(){return a + this.b}
bar.addMethod('getValue', Fn);
bar.getValue(); //yields 'ab' 
```

在这种情况下，您可以`eval()`在闭包的上下文中重新定义函数。然而，使用`eval()`是危险的，特别是不要`eval()`任何用户输入，永远。但是，对于在测试套件/脚本中使用它应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:23:21.320

我建议您阅读[Crockford 关于](http://www.crockford.com/javascript/private.html)如何在 javascript 对象中实现特权和私有的论文。

如果通过特权，您的意思是在对象外部无法访问的方法，但可以被其他方法调用并且实际上是对象上的方法，那么实际上没有任何方法可以做到这一点，因为您在对象上放置了一个方法， javascript 让任何人都可以调用它。

如果您只想添加一个只能由方法调用的函数，您可以通过拥有一个作为对象的私有成员变量（请参阅 Crockford 如何实现它）来实现，您可以将方法放在该对象上。然后所有现有方法（按照 Crockford 在构造函数中建议访问私有成员数据的方式实现）可以调用这些方法。从技术上讲，它们是不同对象的成员，但如果需要，可以授予对对象实例数据的私有访问权限。

这一切都非常复杂，所以如果你描述了你真正想要解决的问题，你可能会得到一个更好的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T23:23:41.647

我不认为你能做到这一点。考虑以下代码：

```
function foo() {
    var privateVar = 10;            
    this.privilegedMethod = function() {
         return privateVar;   
    }
}
var obj = new foo(); 
```

在这里，`privilegedMethod`可以访问`privateVar`，因为它是定义方法时创建的闭包的一部分。当然，您总是可以在实例化后将新方法附加到对象：

```
obj.newMethod = function() { return "hello" };
alert(obj.newMethod()); // alerts "hello" 
```

但是这种新方法将无法访问`privateVar`.

# java - 在 JBoss 7.1.0 上部署 Primefaces 应用程序时出错

> ID：10020447
> 
> 赞同：3
> 
> 时间：2012-04-04T22:57:46.597
> 
> 标签：java, jsf, primefaces, jboss7.x

我正在尝试在 JBOSS 7.1.0 中部署 JSF (Primefaces) 应用程序。

我收到以下错误：

```
18:17:03,390 SEVERE [javax.enterprise.resource.webcontainer.jsf.config] (MSC 
service thread 1-8) Critical error during deployment: :  
com.sun.faces.config.ConfigurationException:Factory  
'javax.faces.context.PartialViewContextFactory' was not configured properly.
    at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactories
Exist(FactoryConfigProcessor.java:305) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAP
SHOT]
    at com.sun.faces.config.processor.FactoryConfigProcessor.process(Factory
ConfigProcessor.java:219) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:361)
[jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureLi
stener.java:225) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
    at org.apache.catalina.core.StandardContext.contextListenerStart(Standar
dContext.java:3392) [jbossweb-7.0.10.Final.jar:]
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:3
850) [jbossweb-7.0.10.Final.jar:]
    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentS
ervice.java:90) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(Se
rviceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceCont
rollerImpl.java:1746) 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T12:46:37.683

这表明与 webapp 的运行时类路径中的另一个 JSF 实现存在冲突。JBoss AS、Glassfish、WebSphere、Weblogic 等成熟的 Java EE 应用服务器已经捆绑了 JSF，因为这是 Java EE API 的一部分。如果你也在你的 webapp 中提供 JSF `/WEB-INF/lib`，它可能会与 appserver 捆绑的 JSF 冲突。JSF API 部分将从 appserver 提供的 JSF 库加载，但 JSF impl 部分将从 webapp 提供的 JSF 库加载。如果它们是不同的版本，那么您将收到这样的配置错误。

您有 2 个选项：

1.  移除 webapp-bundled JSF 并依赖 server-bundled JSF。

2.  告诉服务器改用 webapp 捆绑的 JSF。如何做到这一点取决于服务器的品牌/版本。在您使用 JBoss 7.x 的特定情况下，这将是将以下上下文参数添加到 webapp 的问题`web.xml`：

    ```
    <context-param>
        <param-name>org.jboss.jbossfaces.WAR_BUNDLES_JSF_IMPL</param-name>
        <param-value>true</param-value>
    </context-param> 
    ```

准系统 JSP/Servlet 容器（如 Tomcat、Jetty 等）没有捆绑 JSF，这就是为什么在`/WEB-INF/lib`针对此类容器时需要提供自己的 JSF 库的原因。

### 也可以看看：

*   [应用程序服务器中的 JSF 2 问题？](https://stackoverflow.com/questions/5815623/jsf-2-issues-in-application-servers)

# c - 位域在联合中未按预期工作

> ID：10020449
> 
> 赞同：2
> 
> 时间：2012-04-04T22:58:06.300
> 
> 标签：c, gcc, assert, bit-fields, unions

谁能告诉我为什么断言失败？

仅供参考：我在 64 位 linux 机器上使用 gcc 4.6.1 编译它。

```
typedef union cpu_register {
    uint64 _64;
    uint32 _32;
    uint16 _16;
    uint16 _8l : 8,
           _8h : 8;
} __attribute__((packed)) cpu_register;

int main()
{
    cpu_register reg;
    reg._64 = 1;
    assert(reg._8h != reg._8l);
    return 0;
} 
```

reg._8h 的预期值为 0，但与 reg._8l (== 1) 的值相同。

我得到了解决这个问题的解决方案，但我想知道出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:11:57.650

看起来你想要

```
uint16 _8l : 8,
       _8h : 8; 
```

为 16 位整数的低位和高位。

但是这些都在一个联合中，并且联合的每个元素实际上都代表整个联合。所以它们每个都引用相同的 8 位。

您需要将它们包装在一个结构中：

```
struct {
    uint16 _8l : 8,
           _8h : 8;
} 
```

然后把这个结构放入并集。

# c++ - 可怕的串行端口/USB 代码 (C++) - 修复建议？

> ID：10020450
> 
> 赞同：5
> 
> 时间：2012-04-04T22:58:13.117
> 
> 标签：c++, visual-c++, usb, serial-port, usbserial

我在串行 I/O 方面没有太多经验，但最近的任务是修复一些有严重缺陷的串行代码，因为最初的程序员已经离开了公司。

该应用程序是一个 Windows 程序，它通过在 USB 上运行的虚拟 COMM 端口与科学仪器进行串行通信。虚拟 COMM 端口 USB 驱动程序由 FTDI 提供，因为它们制造了我们在仪器上使用的 USB 芯片。

串行代码位于非托管 C++ DLL 中，由我们的旧 C++ 软件和新的 C# / .Net (WinForms) 软件共享。

有两个主要问题：

**在许多 XP 系统上失败**

当第一个命令发送到仪器时，没有响应。当您发出下一个命令时，您会得到第一个命令的响应。

这是一个典型的使用场景（调用方法的完整源代码如下）：

```
char szBuf [256];   

CloseConnection ();

if (OpenConnection ())
{   
    ClearBuffer ();

    // try to get a firmware version number
    WriteChar ((char) 'V');
    BOOL versionReadStatus1 = ReadString (szBuf, 100);
        ...
    } 
```

在失败的系统上，ReadString 调用将永远不会收到任何串行数据，并且会超时。但是，如果我们发出另一个不同的命令，并再次调用 ReadString，它将返回来自第一个命令的响应**，**而不是新命令！

但这只会发生在 Windows XP 系统的大部分子集上 - 而不会发生在 Windows 7 上。幸运的是，我们的 XP 开发机器工作正常，所以直到我们开始 beta 测试才发现问题。但我也可以通过在我的 XP 开发机器上运行 XP VM（VirtualBox）来重现该问题。此外，仅在将 DLL 与新的 C# 版本一起使用时才会出现问题 - 与旧的 C++ 应用程序一起工作正常。

当我在调用 ClearCommError 之前将 Sleep(21) 添加到低级 BytesInQue 方法时，这似乎得到了解决，但这加剧了另一个问题 - CPU 使用率。睡眠时间少于 21 毫秒会使故障模式重新出现。

**高 CPU 使用率**

进行串行 I/O 时 CPU 使用率过高 - 通常超过 90%。新的 C# 应用程序和旧的 C++ 应用程序都会发生这种情况，但在新应用程序中更糟。通常会使 UI 非常无响应，但并非总是如此。

下面是我们的 Port.cpp 类的代码，总之它是可怕的荣耀。对不起，这就是我正在使用的。最重要的方法可能是**OpenConnection、ReadString、ReadChar 和 BytesInQue。**

```
// 
// Port.cpp: Implements the CPort class, which is 
//               the class that controls the serial port. 
// 
// Copyright (C) 1997-1998 Microsoft Corporation 
// All rights reserved. 
// 
// This source code is only intended as a supplement to the 
// Broadcast Architecture Programmer's Reference. 
// For detailed information regarding Broadcast 
// Architecture, see the reference. 
// 
#include <windows.h> 
#include <stdio.h> 
#include <assert.h> 
#include "port.h" 

// Construction code to initialize the port handle to null. 
CPort::CPort() 
{ 
    m_hDevice = (HANDLE)0;

    // default parameters
    m_uPort = 1;
    m_uBaud = 9600;
    m_uDataBits = 8;
    m_uParity = 0;
    m_uStopBits = 0; // = 1 stop bit 
    m_chTerminator = '\n';
    m_bCommportOpen = FALSE;
    m_nTimeOut = 50;
    m_nBlockSizeMax = 2048;

} 

// Destruction code to close the connection if the port  
// handle was valid. 
CPort::~CPort() 
{ 
    if (m_hDevice) 
     CloseConnection(); 
} 

// Open a serial communication port for writing short  
// one-byte commands, that is, overlapped data transfer  
// is not necessary. 
BOOL CPort::OpenConnection() 
{ 
    char szPort[64]; 

    m_bCommportOpen = FALSE;

    // Build the COM port string as "COMx" where x is the port. 
    if (m_uPort > 9)
        wsprintf(szPort, "\\\\.\\COM%d", m_uPort); 
    else
        wsprintf(szPort, "COM%d", m_uPort); 

    // Open the serial port device. 
    m_hDevice = CreateFile(szPort, 
                            GENERIC_WRITE | GENERIC_READ, 
                            0, 
                            NULL,          // No security attributes 
                            OPEN_EXISTING, 
                            FILE_ATTRIBUTE_NORMAL,
                            NULL); 

    if (m_hDevice == INVALID_HANDLE_VALUE)
    { 
         SaveLastError ();
         m_hDevice = (HANDLE)0; 
         return FALSE; 
    } 

    return SetupConnection(); // After the port is open, set it up. 
} // end of OpenConnection() 

// Configure the serial port with the given settings. 
// The given settings enable the port to communicate 
// with the remote control. 
BOOL CPort::SetupConnection(void) 
{ 
    DCB dcb;  // The DCB structure differs betwwen Win16 and Win32\. 

    dcb.DCBlength = sizeof(DCB); 

    // Retrieve the DCB of the serial port. 
    BOOL bStatus = GetCommState(m_hDevice, (LPDCB)&dcb); 

    if (bStatus == 0)
    {   
         SaveLastError ();

         return FALSE;
    }

    // Assign the values that enable the port to communicate. 
    dcb.BaudRate          = m_uBaud;       // Baud rate 
    dcb.ByteSize          = m_uDataBits;   // Data bits per byte, 4-8 
    dcb.Parity            = m_uParity;     // Parity: 0-4 = no, odd, even, mark, space 
    dcb.StopBits          = m_uStopBits;   // 0,1,2 = 1, 1.5, 2 

    dcb.fBinary           = TRUE;        // Binary mode, no EOF check : Must use binary mode in NT 
    dcb.fParity           = dcb.Parity == 0 ? FALSE : TRUE;       // Enable parity checking 
    dcb.fOutX             = FALSE;       // XON/XOFF flow control used 
    dcb.fInX              = FALSE;       // XON/XOFF flow control used 
    dcb.fNull             = FALSE;       // Disable null stripping - want nulls 
    dcb.fOutxCtsFlow      = FALSE; 
    dcb.fOutxDsrFlow      = FALSE; 
    dcb.fDsrSensitivity = FALSE; 
    dcb.fDtrControl = DTR_CONTROL_ENABLE; 
    dcb.fRtsControl =  RTS_CONTROL_DISABLE ; 

    // Configure the serial port with the assigned settings. 
    // Return TRUE if the SetCommState call was not equal to zero.
    bStatus = SetCommState(m_hDevice, &dcb);

    if (bStatus == 0)
    {       
         SaveLastError ();
         return FALSE;   
    }

    DWORD dwSize;
    COMMPROP *commprop;
    DWORD dwError;

    dwSize = sizeof(COMMPROP) + sizeof(MODEMDEVCAPS) ;
    commprop = (COMMPROP *)malloc(dwSize);
    memset(commprop, 0, dwSize);

    if (!GetCommProperties(m_hDevice, commprop))
    {
        dwError = GetLastError();
    } 

    m_bCommportOpen = TRUE;

    return TRUE; 
} 

void CPort::SaveLastError ()
{
    DWORD dwLastError = GetLastError ();

    LPVOID lpMsgBuf;

    FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | 
                  FORMAT_MESSAGE_FROM_SYSTEM | 
                  FORMAT_MESSAGE_IGNORE_INSERTS,
                  NULL,
                  dwLastError,
                  MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), // Default language
                  (LPTSTR) &lpMsgBuf,
                  0,
                  NULL);

    strcpy (m_szLastError,(LPTSTR)lpMsgBuf);
    // Free the buffer.
    LocalFree( lpMsgBuf );

}

void CPort::SetTimeOut (int nTimeOut)
{
    m_nTimeOut = nTimeOut;

}

// Close the opened serial communication port. 

void CPort::CloseConnection(void)
{ 
   if (m_hDevice != NULL &&
       m_hDevice != INVALID_HANDLE_VALUE)
   {
        FlushFileBuffers(m_hDevice);
        CloseHandle(m_hDevice);  ///that the port has been closed. 
   }
   m_hDevice = (HANDLE)0; 

   // Set the device handle to NULL to confirm
   m_bCommportOpen = FALSE;
} 

int CPort::WriteChars(char * psz)
{ 
    int nCharWritten = 0;

    while (*psz)
    {
     nCharWritten +=WriteChar(*psz);
     psz++;
    }

    return nCharWritten;
}

// Write a one-byte value (char) to the serial port. 
int CPort::WriteChar(char c) 
{ 
    DWORD dwBytesInOutQue = BytesInOutQue ();

    if (dwBytesInOutQue > m_dwLargestBytesInOutQue)
        m_dwLargestBytesInOutQue = dwBytesInOutQue;

    static char szBuf[2]; 

    szBuf[0] = c; 
    szBuf[1] = '\0'; 

    DWORD dwBytesWritten; 

    DWORD dwTimeOut = m_nTimeOut; // 500 milli seconds

    DWORD start, now;

    start = GetTickCount();

    do
    {
         now = GetTickCount();
         if ((now - start) > dwTimeOut )
         {
              strcpy (m_szLastError, "Timed Out");

              return 0;
         }

         WriteFile(m_hDevice, szBuf, 1, &dwBytesWritten, NULL); 
    }
    while (dwBytesWritten == 0);

    OutputDebugString(TEXT(strcat(szBuf, "\r\n")));

    return dwBytesWritten; 
}

int CPort::WriteChars(char * psz, int n)
{ 

    DWORD dwBytesWritten; 

    WriteFile(m_hDevice, psz, n, &dwBytesWritten, NULL); 

    return dwBytesWritten; 
}

// Return number of bytes in RX queue
DWORD CPort::BytesInQue ()
{
    COMSTAT    ComStat ; 
    DWORD      dwErrorFlags; 
    DWORD      dwLength; 

    // check number of bytes in queue 
    ClearCommError(m_hDevice, &dwErrorFlags, &ComStat ) ; 

    dwLength = ComStat.cbInQue; 

    return dwLength;

}

DWORD CPort::BytesInOutQue ()
{
    COMSTAT    ComStat ; 
    DWORD      dwErrorFlags; 
    DWORD      dwLength; 

    // check number of bytes in queue 
    ClearCommError(m_hDevice, &dwErrorFlags, &ComStat ); 

    dwLength = ComStat.cbOutQue ; 

    return dwLength;

}

int CPort::ReadChars (char* szBuf, int nMaxChars)
{
    if (BytesInQue () == 0)
        return 0;

    DWORD dwBytesRead; 

    ReadFile(m_hDevice, szBuf, nMaxChars, &dwBytesRead, NULL); 

    return (dwBytesRead); 
}

// Read a one-byte value (char) from the serial port. 
int CPort::ReadChar (char& c)
{
    static char szBuf[2]; 

    szBuf[0] = '\0'; 
    szBuf[1] = '\0'; 

    if (BytesInQue () == 0)
        return 0;

    DWORD dwBytesRead; 

    ReadFile(m_hDevice, szBuf, 1, &dwBytesRead, NULL); 

    c = *szBuf; 

    if (dwBytesRead == 0)
        return 0;

    return dwBytesRead; 
}

BOOL CPort::ReadString (char *szStrBuf , int nMaxLength)
{
    char str [256];
    char str2 [256];

    DWORD dwTimeOut = m_nTimeOut; 

    DWORD start, now;

    int nBytesRead;
    int nTotalBytesRead = 0;

    char c = ' ';

    static char szCharBuf [2];

    szCharBuf [0]= '\0';
    szCharBuf [1]= '\0';

    szStrBuf [0] = '\0';

    start = GetTickCount();

    while (c != m_chTerminator)
    {        
         nBytesRead = ReadChar (c);
         nTotalBytesRead += nBytesRead;

         if (nBytesRead == 1 && c != '\r' && c != '\n')
         {             
              *szCharBuf = c;

              strncat (szStrBuf,szCharBuf,1);

              if (strlen (szStrBuf) == nMaxLength)
                    return TRUE;

              // restart timer for next char
              start = GetTickCount();
         }

         // check for time out
         now = GetTickCount();
         if ((now - start) > dwTimeOut )
         {
              strcpy (m_szLastError, "Timed Out");

              return FALSE;
         }
    } 

    return TRUE;
}         

int CPort::WaitForQueToFill (int nBytesToWaitFor)
{
    DWORD start = GetTickCount();

    do 
    {
         if (BytesInQue () >= nBytesToWaitFor)
            break;

         if (GetTickCount() - start > m_nTimeOut)
            return 0;

    } while (1);

    return BytesInQue ();
}

int CPort::BlockRead (char * pcInputBuffer, int nBytesToRead)
{
    int nBytesRead = 0;
    int charactersRead;

    while (nBytesToRead >= m_nBlockSizeMax)
    {
        if (WaitForQueToFill (m_nBlockSizeMax) < m_nBlockSizeMax)
            return nBytesRead;

        charactersRead = ReadChars (pcInputBuffer, m_nBlockSizeMax);
        pcInputBuffer += charactersRead;
        nBytesRead += charactersRead;
        nBytesToRead -= charactersRead;
    }

    if (nBytesToRead > 0)
    {
        if (WaitForQueToFill (nBytesToRead) < nBytesToRead)
            return nBytesRead;

        charactersRead = ReadChars (pcInputBuffer, nBytesToRead);
        nBytesRead += charactersRead;
        nBytesToRead -= charactersRead;

    }

    return nBytesRead;
} 
```

根据我的测试和阅读，我在这段代码中看到了几个可疑的地方：

1.  永远不会设置 COMMTIMEOUTS。MS 文档说“如果您未能设置超时值，可能会出现不可预测的结果”。但是我尝试设置这个，它没有帮助。

2.  许多方法（例如 ReadString）如果没有立即获得数据，就会进入一个紧密的循环并通过重复读取来敲击端口。这似乎可以解释高 CPU 使用率。

3.  许多方法都有自己的超时处理，使用 GetTickCount()。这不是 COMMTIMEOUTS 的用途吗？

4.  在新的 C# (WinForms) 程序中，所有这些串行例程都直接从主线程调用，来自 MultiMediaTimer 事件。也许应该在不同的线程中运行？

5.  BytesInQue 方法似乎是一个瓶颈。如果我在 CPU 使用率很高时中断调试器，那通常是程序停止的地方。此外，在调用 ClearCommError 之前向该方法添加 Sleep(21) 似乎可以解决 XP 问题，但会加剧 CPU 使用问题。

6.  代码似乎不必要地复杂。

**我的问题**

1.  谁能解释为什么这只适用于少数 XP 系统上的 C# 程序？

2.  关于如何重写这个有什么建议吗？指向良好示例代码的指针将是最受欢迎的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T23:32:09.857

这个类有一些严重的问题，而且它有微软的版权让事情变得更糟。

这门课没有什么特别之处。这让我想知道为什么它甚至存在，除了作为 Create/Read/WriteFile 上的适配器。如果您在 .NET Framework 中使用[SerialPort类，您甚至不需要这个类。](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)

您的 CPU 使用率是因为代码在等待设备有足够的可用数据时进入无限循环。代码还不如说`while(1);`如果您必须坚持使用 Win32 和 C++，您可以查看 Completion Ports 并在调用 CreateFile 时设置 OVERLAPPED 标志。这样您就可以在单独的工作线程中等待数据。

与多个 COM 端口通信时需要小心。自从我完成 C++ 以来已经有很长时间了，但我相信 Read 和 Write 方法中的静态缓冲区 szBuff 对于该类的所有实例都是静态的。这意味着如果您“同时”针对两个不同的 COM 端口调用 Read，您将得到意想不到的结果。

至于某些 XP 机器上的问题，如果您在每次读/写后检查 GetLastError 并记录结果，您肯定会找出问题所在。无论如何，它应该检查 GetLastError，因为它有时并不总是“错误”，而是来自子系统的请求以执行其他操作以获得您想要的结果。

`COMMTIMEOUTS`如果设置正确，您可以摆脱整个 while 循环进行阻塞。如果在执行读取之前有特定的`Read`操作超时使用。`SetCommTimeouts`

我设置`ReadIntervalTimeout`为最大超时以确保读取不会比 m_nTimeOut 更快地返回。如果任何两个字节之间的时间过去，此值将导致 Read 返回。如果它设置为 2 毫秒，第一个字节在 t 进入，第二个在 t+1 进入，第三个在 t+4 进入，ReadFile 将只返回前两个字节，因为字节之间的间隔被超过. ReadTotalTimeoutConstant 确保无论如何您都不会等待超过 m_nTimeOut。

`maxWait = BytesToRead * ReadTotalTimeoutMultiplier + ReadTotalTimeoutConstant`. 因此`(BytesToRead * 0) + m_nTimeout = m_nTimeout`

```
BOOL CPort::SetupConnection(void) 
{
      // Snip...
      COMMTIMEOUTS comTimeOut;                   
      comTimeOut.ReadIntervalTimeout = m_nTimeOut; // Ensure's we wait the max timeout
      comTimeOut.ReadTotalTimeoutMultiplier = 0;
      comTimeOut.ReadTotalTimeoutConstant = m_nTimeOut;
      comTimeOut.WriteTotalTimeoutMultiplier = 0;
      comTimeOut.WriteTotalTimeoutConstant = m_nTimeOut;
      SetCommTimeouts(m_hDevice,&comTimeOut);
}

// If return value != nBytesToRead check check GetLastError()
// Most likely Read timed out.
int CPort::BlockRead (char * pcInputBuffer, int nBytesToRead)
{
      DWORD dwBytesRead; 
      if (FALSE == ReadFile(
             m_hDevice, 
             pcInputBuffer, 
             nBytesToRead, 
             &dwBytesRead, 
             NULL))
      {
           // Check GetLastError
           return dwBytesRead;
      }
      return dwBytesRead;
} 
```

我不知道这是否完全正确，但它应该给你一个想法。如果您的程序依赖于同步的事物，请删除 ReadChar 和 ReadString 方法并使用它。还要小心设置高超时。通信速度很快，只需几毫秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:27:11.363

*这是我几年*前写的一个终端程序（现在我想起来可能至少是 15 年前）。我只是快速检查了一下，在 Windows 7 x64 下，它似乎仍然可以正常工作——连接到我的 GPS，读取并显示来自它的数据。

如果您查看代码，您会发现我没有花太多时间选择通信超时值。我将它们全部设置为 1，打算尝试更长的超时时间，直到 CPU 使用率可以忍受。长话短说，它使用的 CPU 时间非常少，我从来没有打扰过。例如，在任务管理器的 CPU 使用率图表上，我看不出它运行与不运行之间有*什么*区别。我让它一次运行从 GPS 收集数据几个小时，任务管理器仍然说它的总 CPU 使用率是 0:00:00。

底线：我很确定它可能会更有效率——但有时足够好就是足够好。考虑到我不再使用它的程度，以及添加文件传输协议之类的任何东西的机会，使其更高效可能永远不会成为最重要的事情。

```
#include <stdio.h>
#include <conio.h>
#include <string.h>

#define STRICT
#define WIN32_LEAN_AND_MEAN
#include <windows.h>

void system_error(char *name) {
// Retrieve, format, and print out a message from the last error.  The 
// `name' that's passed should be in the form of a present tense noun 
// (phrase) such as "opening file".
//
    char *ptr = NULL;
    FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER |
        FORMAT_MESSAGE_FROM_SYSTEM,
        0,
        GetLastError(),
        0,
        (char *)&ptr,
        1024,
        NULL);

    fprintf(stderr, "\nError %s: %s\n", name, ptr);
    LocalFree(ptr);
}

int main(int argc, char **argv) {

    int ch;
    char buffer[64];
    HANDLE file;
    COMMTIMEOUTS timeouts;
    DWORD read, written;
    DCB port;
    HANDLE keyboard = GetStdHandle(STD_INPUT_HANDLE);
    HANDLE screen = GetStdHandle(STD_OUTPUT_HANDLE);
    DWORD mode;
    char port_name[128] = "\\\\.\\COM3";
    char init[] = "";

    if ( argc > 2 )
        sprintf(port_name, "\\\\.\\COM%s", argv[1]);

    // open the comm port.
    file = CreateFile(port_name,
        GENERIC_READ | GENERIC_WRITE,
        0, 
        NULL, 
        OPEN_EXISTING,
        0,
        NULL);

    if ( INVALID_HANDLE_VALUE == file) {
        system_error("opening file");
        return 1;
    }

    // get the current DCB, and adjust a few bits to our liking.
    memset(&port, 0, sizeof(port));
    port.DCBlength = sizeof(port);
    if (!GetCommState(file, &port))
        system_error("getting comm state");
    if (!BuildCommDCB("baud=19200 parity=n data=8 stop=1", &port))
        system_error("building comm DCB");
    if (!SetCommState(file, &port))
        system_error("adjusting port settings");

    // set short timeouts on the comm port.
    timeouts.ReadIntervalTimeout = 1;
    timeouts.ReadTotalTimeoutMultiplier = 1;
    timeouts.ReadTotalTimeoutConstant = 1;
    timeouts.WriteTotalTimeoutMultiplier = 1;
    timeouts.WriteTotalTimeoutConstant = 1;
    if (!SetCommTimeouts(file, &timeouts))
        system_error("setting port time-outs.");

    // set keyboard to raw reading.
    if (!GetConsoleMode(keyboard, &mode))
        system_error("getting keyboard mode");
    mode &= ~ ENABLE_PROCESSED_INPUT;
    if (!SetConsoleMode(keyboard, mode))
        system_error("setting keyboard mode");

    if (!EscapeCommFunction(file, CLRDTR))
        system_error("clearing DTR");
    Sleep(200);
    if (!EscapeCommFunction(file, SETDTR))
        system_error("setting DTR");

    if (!WriteFile(file, init, sizeof(init), &written, NULL))
        system_error("writing data to port");

    if (written != sizeof(init))
        system_error("not all data written to port");

    // basic terminal loop:
    do {
        // check for data on port and display it on screen.
        ReadFile(file, buffer, sizeof(buffer), &read, NULL);
        if (read)
            WriteFile(screen, buffer, read, &written, NULL);

        // check for keypress, and write any out the port.
        if ( kbhit() ) {
            ch = getch();
            WriteFile(file, &ch, 1, &written, NULL);
        }
    // until user hits ctrl-backspace.
    } while ( ch != 127);

    // close up and go home.
    CloseHandle(keyboard);
    CloseHandle(file);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:32:52.887

我会补充

```
Sleep(2); 
```

到 CPort::WaitForQueToFill() 中的 while 循环

这将使操作系统有机会在队列中实际放置一些字节。

# nlp - 从复杂（混合）句子中提取简单句子的算法？

> ID：10020451
> 
> 赞同：4
> 
> 时间：2012-04-04T22:58:15.927
> 
> 标签：nlp, extraction, text-mining, text-extraction, information-extraction

有没有一种算法可以用来从段落中提取简单的句子？

我的最终目标是稍后对生成的简单句子运行另一个算法来确定作者的情绪。

我从 Chae-Deug Park 等来源对此进行了研究，但没有人讨论将简单的句子作为训练数据。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:16:38.580

看看[Apache OpenNLP](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.sentdetect)，它有一个 Sentence Detector 模块。该文档提供了如何从命令行和 API 使用它的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-26T11:13:18.137

我刚刚使用了openNLP。

```
public static List<String> breakIntoSentencesOpenNlp(String paragraph) throws FileNotFoundException, IOException,
        InvalidFormatException {

    InputStream is = new FileInputStream("resources/models/en-sent.bin");
    SentenceModel model = new SentenceModel(is);
    SentenceDetectorME sdetector = new SentenceDetectorME(model);

    String[] sentDetect = sdetector.sentDetect(paragraph);
    is.close();
    return Arrays.asList(sentDetect);
} 
```

例子

```
 //Failed at Hi.
    paragraph = "Hi. How are you? This is Mike.";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at Door.Noone
    paragraph = "Close the Door.Noone is out there";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence));//not able to break on noone

    paragraph = "Really!! I cant believe. Mr. Wilson can come any moment to receive mrs. watson.";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at dr.
    paragraph = "Radhika, Mohan, and Shaik went to meet dr. Kashyap to raise fund for poor patients.";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence));//breaking on dr.

    paragraph = "This is how I tried to split a paragraph into a sentence. But, there is a problem. My paragraph includes dates like Jan.13, 2014 , words like U.S. and numbers like 2.2\. They all got splitted by the above code.";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence));//breaking on dr.

    paragraph = "www.thinkzarahatke.com is the second site I developed. You can send mail to admin@thinkzarahatke.com";
    SentenceDetector.breakIntoSentencesOpenNlp(paragraph).forEach(sentence -> System.out.println(sentence)); 
```

只有在出现人为错误时才会失败。例如。“博士。” 缩写应大写 D，且 2 个句子之间应至少有 1 个空格。

您也可以通过以下方式使用[RE实现它；](https://stackoverflow.com/a/21430792/453767)

```
public static List<String> breakIntoSentencesCustomRESplitter(String paragraph){
    List<String> sentences = new ArrayList<String>();
    Pattern re = Pattern.compile("[^.!?\\s][^.!?]*(?:[.!?](?!['\"]?\\s|$)[^.!?]*)*[.!?]?['\"]?(?=\\s|$)", Pattern.MULTILINE | Pattern.COMMENTS);
    Matcher reMatcher = re.matcher(paragraph);
    while (reMatcher.find()) {
        sentences.add(reMatcher.group());
    }
    return sentences;

} 
```

例子

```
 paragraph = "Hi. How are you? This is Mike.";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at Door.Noone
    paragraph = "Close the Door.Noone is out there";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at Mr., mrs.
    paragraph = "Really!! I cant believe. Mr. Wilson can come any moment to receive mrs. watson.";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at dr.
    paragraph = "Radhika, Mohan, and Shaik went to meet dr. Kashyap to raise fund for poor patients.";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at U.S.
    paragraph = "This is how I tried to split a paragraph into a sentence. But, there is a problem. My paragraph includes dates like Jan.13, 2014 , words like U.S. and numbers like 2.2\. They all got splitted by the above code.";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence));

    paragraph = "www.thinkzarahatke.com is the second site I developed. You can send mail to admin@thinkzarahatke.com";
    SentenceDetector.breakIntoSentencesCustomRESplitter(paragraph).forEach(sentence -> System.out.println(sentence)); 
```

但是错误是有竞争力的。另一种方法是使用 BreakIterator；

```
public static List<String> breakIntoSentencesBreakIterator(String paragraph){
    List<String> sentences = new ArrayList<String>();
    BreakIterator sentenceIterator =
            BreakIterator.getSentenceInstance(Locale.ENGLISH);
    BreakIterator sentenceInstance = sentenceIterator.getSentenceInstance();
    sentenceInstance.setText(paragraph);

    int end = sentenceInstance.last();
     for (int start = sentenceInstance.previous();
          start != BreakIterator.DONE;
          end = start, start = sentenceInstance.previous()) {
         sentences.add(paragraph.substring(start,end));
     }

     return sentences;
} 
```

例子：

```
 paragraph = "Hi. How are you? This is Mike.";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at Door.Noone
    paragraph = "Close the Door.Noone is out there";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at Mr.
    paragraph = "Really!! I cant believe. Mr. Wilson can come any moment to receive mrs. watson.";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence));

    //Failed at dr.
    paragraph = "Radhika, Mohan, and Shaik went to meet dr. Kashyap to raise fund for poor patients.";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence));

    paragraph = "This is how I tried to split a paragraph into a sentence. But, there is a problem. My paragraph includes dates like Jan.13, 2014 , words like U.S. and numbers like 2.2\. They all got splitted by the above code.";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence));

    paragraph = "www.thinkzarahatke.com is the second site I developed. You can send mail to admin@thinkzarahatke.com";
    SentenceDetector.breakIntoSentencesBreakIterator(paragraph).forEach(sentence -> System.out.println(sentence)); 
```

**基准测试**：

*   自定义 RE：7 毫秒
*   中断迭代器：143 毫秒
*   openNlp：255 毫秒

# visual-studio-2010 - VS2010 Web部署包-防止App_Data被删除

> ID：10020456
> 
> 赞同：2
> 
> 时间：2012-04-04T22:58:48.297
> 
> 标签：visual-studio-2010

我想使用 VS2010 的 Web 部署功能将更新部署到网站，通常遵循以下指南：

[http://msdn.microsoft.com/en-us/library/dd465337.aspx](http://msdn.microsoft.com/en-us/library/dd465337.aspx)

生产网站使用某些数据文件，这些文件`App_Data`由单独的服务生成并存放在那里。

当我对更新进行测试部署时：

```
MyDeploymentPackage.cmd /T 
```

我收到一条消息，里面的所有内容都`App_Data`将被**删除**。如果我取消选中“从 App_Data 文件夹中排除文件”复选框，则会通知我这些文件将使用来自 QA 环境的文件的旧副本进行更新（如果所述文件包含在项目中），或者特定文件将被删除（如果项目中不包含 QA 副本）。

是否可以使用 Web 部署包，使其`App_Data`不受影响？

# android - Android 4.0 子标题（部分）标签样式

> ID：10020466
> 
> 赞同：65
> 
> 时间：2012-04-04T22:59:56.090
> 
> 标签：android, android-layout, styling

因此，我查看了 ICS 的[Android 开发设计网站](http://developer.android.com/design/index.html)，所有应用程序都有这些字幕/部分标题：

![ICS 部分标题](../Images/d56396706c51c432e4df6791a4fac50e.png)

我想知道是否有人知道自定义样式来实现看起来像这样的标签。我在 Android SDK 中找不到任何看起来像这样的标签视图，但我真的很喜欢它们的外观。

提前致谢！

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-04-12T02:34:13.513

所以这就是我最终使用的：

```
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    <style name="sectionHeader" parent="android:Widget.Holo.Light.TextView">
        <item name="android:drawableBottom">@drawable/section_header</item>
        <item name="android:drawablePadding">4dp</item>
        <item name="android:layout_marginTop">8dp</item>
        <item name="android:paddingLeft">4dp</item>
        <item name="android:textAllCaps">true</item>
        <item name="android:textColor">@color/emphasis</item>
        <item name="android:textSize">14sp</item>
    </style>
</resources> 
```

@drawable/section_header 在哪里：

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <size android:width="1000dp" android:height="2dp" />
    <solid 
        android:color="@color/emphasis"/>
</shape> 
```

和@color的：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="emphasis">#31b6e7</color>
    <color name="bg_gray">#cecbce</color>
</resources> 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-05-09T00:29:43.693

布兰登的权利；您现在需要进行自定义工作才能获得蓝色样式，这有点令人沮丧，因为它贯穿于新的设计指南中。

不幸的是，您不能将`Widget.Holo.Light.TextView.ListSeparator`其作为自定义样式的父级引用，因为它是私有的。

但如果您只对灰线感兴趣，您可以使用现有的 Android 样式内联：

```
style="?android:attr/listSeparatorTextViewStyle" 
```

这至少会让你进入灰线，所有大写风格：

![在此处输入图像描述](../Images/3a3145850f4619708a3789abaa49a998.png)

Brandon 的回答将带您进入定制的蓝色风格。

仅供参考，如果您想从当前 (v15) 的 Android 样式中完全继承列表分隔符，Android 中使用的组合样式`Widget.TextView.ListSeparator`以及`Widget.Holo.Light.TextView.ListSeparator`您可以复制到新样式的样式是：

```
<item name="android:background">@drawable/list_section_divider_holo_light</item>
<item name="android:textAllCaps">true</item>
<item name="android:layout_width">match_parent</item>
<item name="android:layout_height">wrap_content</item>
<item name="android:textStyle">bold</item>
<item name="android:textColor">?android:textColorSecondary</item>
<item name="android:textSize">14sp</item>
<item name="android:gravity">center_vertical</item>
<item name="android:paddingLeft">8dip</item> 
```

不过，您必须将可绘制对象复制到您自己的目录中，因为它们是私有的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T00:15:26.533

我不确定它到底是哪种风格，但首选项应用程序也使用它（或非常相似的东西）。这是一个节标题。此外，TextField 已`textAllCaps`设置为 true。如果您查找 textAllCaps，您可能可以在 SDK 的资源文件夹中找到它：)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T20:11:36.950

我说，画线只需使用一个视图，高度设置为 tu 1dp 左右。您可以使用背景属性设置颜色

# mysql - 三表连接问题与计数

> ID：10020468
> 
> 赞同：0
> 
> 时间：2012-04-04T23:00:17.493
> 
> 标签：mysql, join

我正在尝试生成产品列表（来自四个表），classid，optionid，'images'。每个产品可以有多个 ClassID（一对多），每个 ClassID 可以有多个 OptionID，每个 OptionID 可以有很多很多图片。最后，对于图像表（xcart_images_D），我想计算（）每个 productID 有多少图像。如何在不使用多个语句的情况下有效地查询所有这些信息？

这是每个表的基本信息

```
xcart_products
    + productid*
    + product
xcart_classes - 
    + classid*
    + productid (xcart_products.productid)
xcart_class_options -
    + optionid*
    + classid (xcart_classes.classid)
    + option_name
xcart_images_D - 
    + imageid*
    + optionid (xcart_class_options.optionid)
+ id (xcart_products.productid)

 * primary/foreign key 
```

我有三个表连接工作，但我无法让 xcart_images_D 表工作，我也不明白我将如何完成计数。谁能指出我正确的方向？

值得一提的是我的三表连接

```
SELECT xp.productid, xp.product, xc.classid, xco.optionid, xco.option_name
FROM xcart_products xp
JOIN xcart_classes xc ON xp.productid = xc.productid and xc.class = 'Color'
JOIN xcart_class_options xco ON xc.classid = xco.classid
WHERE xc.class = 'Color'
ORDER by xp.productid DESC 
```

当我尝试添加以下行时，结果数量减少了大约一半。

```
 JOIN xcart_images_D xi ON xi.optionid = xco.optionid
 GROUP BY xp.productid 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:07:32.753

```
SELECT xp.productid, count(xi.imageid)
FROM xcart_products xp 
INNER JOIN xcart_classes xc ON xp.productid = xc.productid AND xc.class = 'Color'
INNER JOIN xcart_class_options xco ON xc.classid = xco.classid 
INNER JOIN xcart_images_D xi ON xi.optionid = xco.optionid
GROUP BY xp.productid
ORDER by xp.productid DESC 
```

# android - 在 ScrollView 中使用 RelativeLayout 不会产生滚动

> ID：10020474
> 
> 赞同：5
> 
> 时间：2012-04-04T23:00:47.993
> 
> 标签：android, android-layout, scrollview, android-relativelayout

我试图让我的相对布局滚动。我将滚动视图添加为父视图，但是当我将手机或模拟器倾斜到水平位置时，它不会滚动。

我尝试了几种不同的解决方案，但似乎都没有奏效。一些包括： [在 scrollview 中没有滚动](https://stackoverflow.com/questions/7900842/no-scrolling-in-scrollview)、[ScrollView 不工作 - 相对布局](https://stackoverflow.com/questions/7349022/scrollview-not-working-relative-layout)和[具有滚动视图不滚动的 RelativeLayout](https://stackoverflow.com/questions/8321063/relativelayout-with-scrollview-not-scrolling)

代码如下：

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/ScrollView01"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:fillViewport="true"
    android:scrollbars="none">
<RelativeLayout

    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:orientation="vertical">

        <Button
            android:layout_width="200dp" 
            android:id="@+id/register_button"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:text="Register" />

        <EditText
            android:id="@+id/email2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/register_button"
            android:layout_alignLeft="@+id/register_button"
            android:layout_alignRight="@+id/register_button"
            android:hint="Re-Enter Email"
            android:inputType="textEmailAddress" />

        <EditText
            android:id="@+id/email1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/email2"
            android:layout_alignLeft="@+id/email2"
            android:layout_alignRight="@+id/email2"
            android:hint="Email"
            android:inputType="textEmailAddress" />

        <EditText
            android:id="@+id/password2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/email1"
            android:layout_alignLeft="@+id/email1"
            android:layout_alignRight="@+id/email1"
            android:hint="Repeat Password"
            android:inputType="textPassword" />

        <EditText
            android:id="@+id/password1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/password2"
            android:layout_alignLeft="@+id/password2"
            android:layout_alignRight="@+id/password2"
            android:hint="Password"
            android:inputType="textPassword" />

        <EditText
            android:id="@+id/lastName"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/password1"
            android:layout_alignLeft="@+id/password1"
            android:layout_alignRight="@+id/password1"
            android:hint="Last Name"
            android:imeOptions="actionNext"
            android:inputType="textPersonName" />

        <EditText
            android:id="@+id/firstName"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/lastName"
            android:layout_alignLeft="@+id/lastName"
            android:layout_alignRight="@+id/lastName"
            android:hint="First Name"
            android:imeOptions="actionNext"
            android:inputType="textPersonName" />

        <EditText
            android:id="@+id/userName"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/firstName"
            android:layout_alignLeft="@+id/firstName"
            android:layout_alignRight="@+id/firstName"
            android:hint="Username"
            android:imeOptions="actionNext"
            android:inputType="textPersonName" />

</RelativeLayout>
</ScrollView> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:06:19.273

您`RelativeLayout`的设置为`fill_parent`. 如果它的大小与`ScrollView`其父级相同，则没有可滚动的内容。改为使用它`wrap_content`并正确布局其子项以暗示高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-16T16:03:42.467

`android:fillViewport="true"`

将此行添加为您的滚动视图属性:)

# c - C 库代码的正确命名约定

> ID：10020475
> 
> 赞同：5
> 
> 时间：2012-04-04T23:00:57.260
> 
> 标签：c, naming-conventions, standards, naming

命名作为基于 C 的代码库/API 一部分的文件和函数的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T23:11:10.287

您*可以*（但*不应该*）做的是完全不小心，并且根本不使用系统的命名约定。这“有效”，但会让您的客户感到不舒服；他们没有简单的方法知道可以在自己的程序中使用哪些名称。（我遇到了一个库，它为其内部使用定义了一个未记录的函数，称为`error()`. 该名称与外部记录的命名空间的任何部分都不匹配。当时，我自己的一个标准错误报告函数也被调用`error()`了——尽管现在是`err_error()`；这意味着我不能在那个库中使用我自己的标准错误报告函数。结果是如果我不需要的话，我没有使用那个库；使用起来太麻烦了。）

所以，你不应该那样。你应该小心你暴露的名字。

您的公共标头应使用一个（或极少数）系统前缀，这些前缀已记录在案。通常，您会选择一个前缀，例如 PFX，并使用它：

*   枚举常量开始`PFX_`。
*   宏开始`PFX_`。
*   功能启动`pfx_`。
*   全局变量（你没有这些，是吗） start `pfx_`。
*   类型名称和结构或联合标记开始`pfx_`。
*   您在自己的源文件之外可见的私有变量和函数具有系统前缀（可能`pfx_`再次，或者可能`pfxp_`最后一个`p`是私有的，或者可能`pfx[A-Z]`私有名称是驼峰式的，但以 开头`pfx`）。

只有严格文件范围（无外部链接）的变量或函数不受这些规则的约束，但即便如此，还是建议使用命名约定（因此，如果一个函数需要稍后由两个文件使用，你不要'不必修改函数先前所在的代码中的调用`static`）。

这样，您可以简单地记录名称开始`PFX_`或`pfx_`由您的图书馆保留。用户仍然可以使用具有相同前缀的名称（您无法阻止它们），但这样做的风险自负，因为升级到库可能会添加保留的名称。他们可以清楚地知道您的姓名，因为您已经记录了他们，并且因为文档（相对）易于理解。

请注意，C 标准和 POSIX 标准都制定了保留名称的规则。但是，保留的 POSIX 和 C 名称的规则比单个前缀要复杂得多。他们也在扫地。例如，`_t`如果包含任何 POSIX 标头，则 POSIX 保留所有以作为类型名称结尾的名称。

# objective-c - iOS5：UITableView 滚动性能不佳

> ID：10020481
> 
> 赞同：4
> 
> 时间：2012-04-04T23:01:56.813
> 
> 标签：objective-c, ios, uitableview, storyboard

首先，我在滚动表格视图时遇到内存泄漏。[与此处](https://stackoverflow.com/questions/9880336/obj-c-memory-leak-of-malloc-48-bytes-in-strdup-frame)相同的问题。

此外，我的滚动速度足够快，但是当我滚动它时它“有点颤抖”。细胞可重复使用。

代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    Country *country=[[self.items objectAtIndex:[indexPath section]] objectAtIndex:[indexPath row]];
    CountryCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell.imageView.image=[UIImage imageNamed:country.countryFlag];
    cell.countryName.text=country.countryName;
    cell.currencyCode.text=country.code;
    cell.currencyOriginalName.text=country.originalUnitName;

    return cell;
} 
```

应用程序：iOS 5、ARC、Storyboard。

这种 tableView 行为的真正原因是什么以及如何解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T06:17:05.067

如果您在设备中的滚动效果不佳，那么您可能没有在原型中正确配置您的子视图。在上述方法中，您没有做任何昂贵的事情。

使用核心动画工具（仅限设备） - 在滚动时检查每秒帧数。您希望尽可能接近 60fps。

打开“颜色混合图层” - 任何绘制透明的东西都将以红色突出显示。如果可能，您希望从您的单元格中删除所有透明度，并将它们全部设为绿色。这可能只是在原型子视图中正确设置背景颜色和不透明标志的问题。

如果您的图像与图像视图的大小不同，那么每次出现单元格时您都会调整大小，这也是一项昂贵的操作。

# arrays - 如何在 Perl 中生成带有计数器的数组？

> ID：10020497
> 
> 赞同：0
> 
> 时间：2012-04-04T23:03:51.540
> 
> 标签：arrays, perl, while-loop, unique, counter

我想生成一个**唯一**ID 列表。因为有些 ID 是重复的，所以我需要在末尾添加一个数字以使其唯一，如下所示：

ID=exon00001
ID=exon00002
ID=exon00003
ID=exon00004

这是我到目前为止所拥有的。

```
 while (loop through the IDs) {
 # if $id is an exon, then increment the counter by one and add it 
 # to the end of the ID
    if ($id =~ m/exon/) {
    my $exon_count = 0;
    my @exon = $exon_count++; #3
    $number = pop @exon; # removes the first element of the list
    $id = $id.$number;
    print $id."/n"
    }
    } 
```

基本上我想动态生成一个带有计数器的数组。它应该为外显子的总数创建一个数组 (1, 2, 3, 4, ...)，然后删除元素并将其添加到字符串中。此代码无法正常工作。我认为第 3 行有问题。你们知道吗？有任何想法吗？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:26:40.967

正如我在评论中所指出的，您的代码无法编译，也无法正常工作。首先计算重复次数，然后根据找到的 id 打印正确的重复次数。使用`printf`将适合格式化您的号码。

```
my %seen;
my @ids = ( bunch of ids );

map $seen{$_}++, @ids;  # count the duplicates

for my $id (keys %seen) {
    for my $num (1 .. $seen{$id}) {
        printf "%s%05d\n", $id, $num;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:30:54.740

这是你需要的吗？计数器需要保留其值，因此您不能按原样继续重置它：

```
use v5.10;

my $exon_count = 0;
while( my $id = <DATA> ) {
    chomp $id;
    if( $id =~ m/exon/ ) {
        $id = sprintf "%s.%03d", $id, $exon_count++;
        }
    say $id;
    }

__END__
ID=exon00001
ID=exon00002
ID=exon00003
ID=exon00004 
```

输出如下所示：

```
ID=exon00001.000
ID=exon00002.001
ID=exon00003.002
ID=exon00004.003 
```

如果您使用的是 5.10 或更高版本，则可以使用[state](http://perldoc.perl.org/functions/state.html)在循环内声明变量，但让它保持其值：

```
use v5.10;

while( my $id = <DATA> ) {
    chomp $id;
    state $exon_count = 0;
    if( $id =~ m/exon/ ) {
        $id = sprintf "%s.%03d", $id, $exon_count++;
        }
    say $id;
    } 
```

我认为你是 Perl 的新手，因为你的代码看起来像是一堆不相关的东西，它们的作用可能与你想象的大不相同。有一个针对生物学家的 Perl 教程，[“Unix and Perl”](http://korflab.ucdavis.edu/Unix_and_Perl/)。还有我的*学习 Perl*书。

Joel 询问是否使用字符串作为附加标签。没关系; Perl 允许你[增加一个字符串](http://www.effectiveperlprogramming.com/blog/1220)，但仅限于范围`a-z`和`A-Z`。我们可以通过使用以 36 为基数的数字标签来混合数字和字母：

```
use v5.10;

use Math::Base36 'encode_base36';

while( my $id = <DATA> ) {
    chomp $id;
    state $exon_count = 30;
    if( $id =~ m/exon/ ) {
        $id = sprintf "%s.%-5s", $id, encode_base36($exon_count++);
        }
    say $id;
    } 
```

现在你有这样的标签：

```
ID=exon00003.1Q   
ID=exon00004.1R   
ID=exon00001.1S   
ID=exon00002.1T   
ID=exon00003.1U   
ID=exon00004.1V 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:35:03.163

您想为这些外显子生成一个唯一 ID 列表（输出到 GFF 文件中？）。

您必须确保在循环之外初始化计数器。我不确定你想用数组完成什么。但是，下面的程序将根据您发布的格式（exon00001 等）生成唯一的外显子 ID。

```
my $exon_count=0;

while(my $id=<SOMEINPUT>){
      if($id=~m/exon/){
            $exon_count++;
        my $num='0' x (5 - length $exon_count) . $exon_count;
            print "$id$num\n";
      }
} 
```

# css - html5 样板文件不包括 reset.css？

> ID：10020499
> 
> 赞同：0
> 
> 时间：2012-04-04T23:03:53.750
> 
> 标签：css, reset, html5boilerplate, normalize

我正在使用[HTML5 Boilerplate](http://html5boilerplate.com/)，但没有找到任何重置样式。所有 H1 元素都有 50px 的顶部和底部边距：S

我是否需要自己包含[重置](http://meyerweb.com/eric/tools/css/reset/)或[正常化之](http://necolas.github.com/normalize.css/)类的内容？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:06:17.450

默认包在 style.css 中使用 normalize.css（但显然不是全部）。如果要重置所有样式，则必须自己添加。

[http://html5boilerplate.com/docs/css/](http://html5boilerplate.com/docs/css/)

# c++ - libconfig 不是静态链接。如何编译成程序

> ID：10020500
> 
> 赞同：4
> 
> 时间：2012-04-04T23:03:53.960
> 
> 标签：c++, unix, gcc, config, libconfig

我使用 libconfig 下载存档，但我不会将其安装到系统中。我想将其编译为静态库并将其从程序目录中链接或**在程序编译时**直接将其链接到我的程序中？

任何想法如何使用 Makefile 做到这一点？(FreeBSD(UNIX), GCC) 或建议其他支持编译到程序中的 unix 配置库。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T23:51:31.647

在 linux 系统上 untar 然后配置并制作：

```
> ls
libconfig-1.4.8.tar.gz
> tar -zxvf libconfig-1.4.8.tar.gz
> cd libconfig-1.4.8
> ./configure prefix=/somewhere/in/your/homedir/doesnotmatter
> make
> ls -al lib/.libs
libconfig.a
libconfig++.a
...
other versions of lib 
```

然后将您的应用程序链接到静态`.a`库。

```
gcc -I/dir/with/libconfigheader -o yourapp main.cpp libconfig.a 
```

如果你不这样做`make install`将不会被**安装**，这些库将在输出目录中，你可以将它们复制到你需要的地方。

我希望这有帮助。

**注意**我没有尝试使用该库，我只是下载并编译了它...

# xml - 从 XMLNodeList 中检索链接

> ID：10020501
> 
> 赞同：0
> 
> 时间：2012-04-04T23:04:07.513
> 
> 标签：xml, r

如何从这些节点获取链接：

```
script <- getURL("www.r-bloggers.com")
doc <- htmlParse(script)
li <- getNodeSet(doc, "//ul[@class='xoxo blogroll']") 
```

提前感谢任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T03:47:47.530

您可以提取`a`元素并调用`xmlGetAttr`它们。

```
library(RCurl)
library(XML)
script <- getURL("www.r-bloggers.com")
doc <- htmlParse(script)
li <- getNodeSet(doc, "//ul[@class='xoxo blogroll']//a")
sapply(li, xmlGetAttr, "href") 
```

也可以`xpathApply`直接使用：

```
xpathSApply(doc, 
  "//ul[@class='xoxo blogroll']//a", 
  xmlGetAttr, "href"
) 
```

# python - pygame 不工作

> ID：10020504
> 
> 赞同：0
> 
> 时间：2012-04-04T23:04:49.273
> 
> 标签：python, pygame

我正在尝试用 pygame 播放歌曲，但它没有播放歌曲。

*我的代码：*

```
import pygame,time
pygame.init()
print "Mixer settings", pygame.mixer.get_init()
print "Mixer channels", pygame.mixer.get_num_channels()
pygame.mixer.music.set_volume(1.0)
pygame.mixer.music.load('C:/1.mp3')
print "Play"
pygame.mixer.music.play(0)
while pygame.mixer.music.get_busy():
   print "Playing", pygame.mixer.music.get_pos()
time.sleep(1)
print "Done" 
```

*我得到的输出为*

```
Mixer settings (22050, -16, 2)
Mixer channels 8
Play
Done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:15:43.517

您的代码适用于我，在运行 Python 2.7.2 的 Lubuntu 11.10 上，使用我从 Youtube 剪辑转换的 MP3。您是否检查过 mp3 不是零长度？你试过wav文件吗？

缺乏其他解释，我认为如果调用尚未完成启动其进程或线程，则`pygame.mixer.music.get_busy()`可能返回 false 。`play(0)`这将导致您的代码跳过 while 循环，打印“完成”并终止，删除音乐播放器对象并在您听到任何内容之前终止播放。如果这是问题所在，您可以在之后`play(0)`和之前尝试这样的事情`print Done`：

```
pygame.mixer.music.set_endevent(pygame.USEREVENT)
finishedPlaying = False

while not finishedPlaying:
    for event in pygame.event.get():
        if event.type == pygame.USEREVENT: 
            finishedPlaying = True
            break # only because we don't care about any other events
    print "Playing", pygame.mixer.music.get_pos() # will print -1 on the last iteration 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:27:19.220

在 pygame.mixer.music.play 的评论中我发现了这个：

```
November 18, 2010 7:30pm - Anonymous
Work Exmpl:

pygame.mixer.init(frequency=22050, size=-16, channels=2, buffer=4096)
sound = pygame.mixer.Sound('Time_to_coffee.wav').play() 
```

似乎您发送 0 作为您想要重复它的次数**感谢 Iskar Jarak**，-1 是无穷大。

[http://www.pygame.org/docs/ref/music.html#pygame.mixer.music.play](http://www.pygame.org/docs/ref/music.html#pygame.mixer.music.play)

# java - 如何覆盖 JLabel importData

> ID：10020505
> 
> 赞同：1
> 
> 时间：2012-04-04T23:05:00.913
> 
> 标签：java, swing, drag-and-drop, jlabel

我正在尝试一个非常简单的覆盖。我只想为“文本”TransferHandler 添加一行代码到 importData。我的问题是在我的一行代码之前找不到需要复制到覆盖方法中的代码！

```
public class JLabelTransferHandler extends TransferHandler
{
    private Logger logger;  // My error logging class

    public JLabelTransferHandler()
    {
        super("text");
        logger = LoggerFactory.getLogger(this.getClass());
    }

    public boolean importData(TransferSupport support) 
    {
        // WHAT GOES HERE?????
        logger.info("Data imported");           
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:46:17.867

根据本教程，您应该首先检查您的组件是否支持这种风味类型的传输，因此您将调用 canImport(...) 方法（您可能需要覆盖该方法），如果因此，从 TransferSupport 参数中提取 Transferable，获取其字符串数据，然后将其放入您的 JLabel。简单的。同样，上面的链接显示了所有内容。

# microcontroller - 读取 PIC18 上输入引脚的状态

> ID：10020506
> 
> 赞同：2
> 
> 时间：2012-04-04T23:05:05.470
> 
> 标签：microcontroller, pic, pic18, mplab

我已经能够让输出在我的 PIC 上工作，并且可以在我将各种输出锁存器设置为高/低时使一堆 LED 闪烁。但是，我在大头针状态下阅读时遇到了很多困难。

请参阅下面的代码。我设置了我的配置，并将 TRISC 定义为输入，将 TRISB 定义为输出。在一个无限循环中，我检查 RC6 是高还是低，并根据结果将整个 B 锁存器设置为高或低。

```
#include <htc.h>

__CONFIG(1, FOSC_IRC   & FCMEN_OFF & IESO_OFF);
__CONFIG(2, PWRTEN_OFF & BOREN_OFF & WDTEN_OFF);
__CONFIG(3, MCLRE_OFF);
__CONFIG(4, STVREN_ON  & LVP_OFF   & DEBUG_OFF);
__CONFIG(5, 0xFFFF);
__CONFIG(6, 0xFFFF);
__CONFIG(7, 0xFFFF);

void main(void)
{
  TRISC = 0xFF; // input
  TRISB = 0x00; // output

  while (1)
  {
    if (PORTCbits.RC6 == 0)
      LATB = 0b00000000;
    else
      LATB = 0b11111111;
  }

  return;
} 
```

代码编译良好，没有警告或错误。如果我的代码逻辑只是将锁存器设置为高电平和低电平，那么效果很好，但我无法成功读取引脚的状态。

有任何想法吗？

我正在使用 PIC18F14K50 和 MPLAB v8.43 以及 HiTech ANSI C 编译器。

我的连接是 +5V 到 VDD（引脚 1），VSS（引脚 20）到地。我有 +5V 到 C6（引脚 8），以及从 B7（引脚 10）到地的 100K 电阻和 LED。要切换 RC6，我将电线连接/断开连接到 C6。

```
 ┌────────┐
+5v -│ 01  20 │- gnd
    -│ 02  19 │-
    -│ 03  18 │-
    -│ 04  17 │-
    -│ 05  16 │-
    -│ 06  15 │-
    -│ 07  14 │-
+5v -│ 08  13 │-
    -│ 09  12 │-
led -│ 10  11 │-
     └────────┘ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T14:20:24.377

不幸的是，PIC 上的 ADC 引脚在上电时被配置为模拟输入。您需要禁用该引脚上的 ADC 功能才能将其用作数字输入。

清零 ANSELH 的位 0 会将 RC6 设置为数字输入。然后你的代码就可以工作了。

这在数据表第 9.4 节：端口模拟控制中有记录

[PIC18F/LF1XK50 数据表](http://ww1.microchip.com/downloads/en/DeviceDoc/41350E.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T00:35:00.607

环境...

```
TRISC = 1; // input 
```

...应仅将 PORTC 的引脚 RC0 设置为输入引脚，所有其他引脚定义为输出。所以`PORTCbits.RC6 == 0`不应该在 RC6 引脚返回正确的输入状态。

`TRISC = 255`应该将 PORTC 的所有引脚设置为输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-20T08:39:01.050

值得一提的是，其他一些 PIC18 变体的设置有所不同：

在**PIC18F4520**和**PIC18F4680**上，您需要通过**ADCON1**寄存器而不是 ANSELH 将引脚配置为数字引脚。

将**位设置为 1**将使引脚变为**数字**。

除此之外，您需要通过在相应的 TRIS 寄存器中将一个位设置为 1 来使它们成为输入引脚。

# c# - 相同的功能不适用于 Matlab .Net Assembly

> ID：10020507
> 
> 赞同：1
> 
> 时间：2012-04-04T23:05:06.907
> 
> 标签：c#, matlab, .net-assembly

我有一个关于神经网络的简单功能。此函数获取矩阵，加载 mat 文件并使用此参数运行神经网络函数。在 matlab 控制台中，这是完美的。但在 C# 中给出错误；

```
... MWMCR::EvaluateFunction error ... 
Subscript indices must either be real positive integers or logicals.
Error in => neural.m at line 4.

... Matlab M-code Stack Trace ...
    at file c:\xxxxxxxxxxxx\NeuralClass\neural.m, name neural, line 4. 
```

这是我的简单功能；

```
function  result=neural(x1)
load('fonksiyon.mat', 'net')
x1=x1';
result= net(x1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T12:46:54.753

Sim 不使用 .net 程序集。这对我有帮助；

```
function  result=neural(P)
load('c:\function.mat', 'net');

IW = net.IW{1};
b1 = net.b{1};
LW = net.LW{2};
b2 = net.b{2};

P=P';

y1 = satlin (IW * P + b1 );
y2 = tansig (LW * y1 + b2 );

result= y2; 
```

# c# - 避免在将带有 onload=document.form.submit() 的 html 写入 HttpContext.Current.Response 后必须返回两次

> ID：10020509
> 
> 赞同：3
> 
> 时间：2012-04-04T23:05:17.467
> 
> 标签：c#, asp.net

所以这是一个很长的标题，这就是我正在做的事情：为了避免在 URL 中显示报告参数，我在代码隐藏中的按钮单击处理程序中执行此操作以显示报告：

```
System.Web.HttpContext.Current.Response.Clear();
System.Web.HttpContext.Current.Response.Write("<html><head></head>");    
System.Web.HttpContext.Current.Response.Write("<body onload=\"document.mainform.submit(); \">");
System.Web.HttpContext.Current.Response.Write(string.Format(CultureInfo.InvariantCulture, "<form name=\"mainform\" method=\"post\" action=\"{0}\">", ReportURL));
foreach (string key in Params.Keys)
{
    System.Web.HttpContext.Current.Response.Write(string.Format(CultureInfo.InvariantCulture, "<input name=\"{0}\" type=\"hidden\" value=\"{1}\">", key, Params[key]));
}
System.Web.HttpContext.Current.Response.Write("</form>");
System.Web.HttpContext.Current.Response.Write("</body></html>"); 
```

这很好用，但是当我从报告返回时，我被带到我刚刚生成的页面，该页面由于 onload 事件而立即提交表单。我可以快速回击两次以绕过它，但这并不理想。

在编写 html 之前，我尝试使用 ClientScript.RegisterStartupScript 使用 JavaScript 打开一个新窗口，但我不知道如何（或者是否有可能）为新窗口获取 HttpContext。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:22:01.020

我最终打开了一个新窗口。我添加了两个小的 javascript 函数

```
function openNewWin() {
    $('form').attr('target', '_blank');
    setTimeout('resetFormTarget()', 500);
}

function resetFormTarget() {
    $('form').attr('target', '');
} 
```

然后在我设置的链接按钮中

```
OnClientClick="openNewWin();" 
```

OnClick 仍然在服务器端执行上面的代码，但响应被写入新窗口。openNewWin 函数中的 setTimeout 会重置表单的目标属性，因此应用程序在返回到它后仍能正常运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T18:29:51.687

我无法使用您的代码重新创建问题，因此更多上下文可能会有所帮助。根据页面其余部分的结构，您可以使用 PostbackURL 而不是点击处理程序：

```
<form id="form1" runat="server">
    <asp:HiddenField runat="server" ID="Key1" Value="Value1"/>
    <asp:HiddenField runat="server" ID="Key2" Value="Value2"/>
    <asp:Button runat="server" ID="button"
        Text="ok" PostBackUrl="ReportURL.aspx"/>
</form> 
```

这样您就不必担心浏览器历史记录中的额外/替换页面。

# c# - c# windows service with filewatcher

> ID：10020512
> 
> 赞同：2
> 
> 时间：2012-04-04T23:05:48.633
> 
> 标签：c#, windows-services, filesystemwatcher, windows-authentication

第一次发布长期读者。

在将其移动到 Windows 服务之前，我在 Windows 窗体应用程序中构建了一个正常工作的文件观察器，该应用程序 100% 正常运行，现在收到两个单独的问题。该文件观察器读取平面文件以进行行更新（lastwrite），删除/重新创建文件（streamwriter），最后解析强类型数据集，然后上传到 SQL 服务器。（这是我的第一个 Windows 服务） 问题：
1\. filewatcher 中的双重事件触发对服务的影响是否与表单应用程序不同？
2\. 如果我调用的类没有问题，为什么线程会中断，有没有人回答？
3\. 通过 Windows 服务进行 Windows 身份验证是否存在任何已知问题？
4\. 有没有强大的windows服务调试方法？

这是我的windows服务代码，提前感谢，如果代码中有愚蠢的错误，我深表歉意，再次第一次制作windows服务。

```
 FileMonitor m_FileMonitor;
    public WindowsService()
    {
        InitializeComponent();
    }
    protected override void OnStart(string[] args)
    {
            try
            {
                Thread myThread = new Thread(DoTheWork);
                myThread.Start();
            }
            catch
            {

            }

    }
    void DoTheWork()
    {
        m_FileMonitor = new FileMonitor(Properties.Settings.Default.PathToFileToWatch, Properties.Settings.Default.PathToErrorLog);
    }
    protected override void OnStop()
    {
        // TODO: Add code here to perform any tear-down necessary to stop your service.
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:33:03.473

对于调试，请确保您的项目类型是 Windows 应用程序，然后使用：

```
[DllImport("kernel32")]
static extern bool AllocConsole();

private static void Main(string[] args)
{
    var service = new MyService();
    var controller = ServiceController.GetServices().FirstOrDefault(c => c.ServiceName == service.ServiceName);
    if (null != controller && controller.Status == ServiceControllerStatus.StartPending)
    {
        ServiceBase.Run(service);
    }
    else
    {
        if (AllocConsole())
        {
            service.OnStart(args);
            Console.WriteLine("Press any key to exit...");
            Console.ReadKey();
            service.OnStop();
        }
        else
        {
            throw new Win32Exception(Marshal.GetLastWin32Error());
        }
    }
} 
```

如果代码因为 Windows 服务启动而运行，它将作为 Windows 服务运行。否则它将分配一个控制台，运行服务，然后在退出服务之前等待按键。您可以在此基础上测试暂停并继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:09:08.620

**对于调试：**

您必须使用`ServiceBase.Run`in 方法`Main()`作为 Windows 服务执行，但您可以在 main 方法中进行切换以运行与普通控制台应用程序相同的应用程序（例如`--standalone`）。我在我的所有服务上都使用它来使它们易于调试。

**关于其他问题：**

我不完全确定您遇到哪些问题以及“班级休息”和“双事件触发”是什么意思。

Windows 服务在一个特殊的服务帐户下运行，该帐户可能有权也可能没有权限来查看您感兴趣的目录。如果需要，您可以更改服务帐户或授予其对目录的权限。

**链接：**

这是一个codeproject文章的链接，该文章似乎已经实现了文件观察程序windows服务。也许它有帮助：

[http://www.codeproject.com/Articles/18521/How-to-implement-a-simple-filewatcher-Windows-serv](http://www.codeproject.com/Articles/18521/How-to-implement-a-simple-filewatcher-Windows-serv)

# haskell - 在 Haskell 编译期间如何在不同位置包含代码？

> ID：10020521
> 
> 赞同：4
> 
> 时间：2012-04-04T23:07:12.453
> 
> 标签：haskell, abstract-syntax-tree, template-haskell

Quasi-quotes 允许在编译期间生成 AST 代码，但它会在 Quasi-quote 的编写位置插入生成的代码。是否可以以任何方式将编译时生成的代码插入其他地方？例如，在特定的模块文件中，与编写 QQ 的模块文件不同？这将取决于硬编码的模块结构，但这很好。

如果 QQ 无法做到这一点，但任何人都知道实现它的不同方式，我愿意提供建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T09:51:39.067

要回答这个问题，了解什么是准报价者会很有帮助。从[GHC 文档](http://www.haskell.org/ghc/docs/7.4.1/html/users_guide/template-haskell.html#th-quasiquotation)中，准引用者的值是

```
data QuasiQuoter = QuasiQuoter { quoteExp  :: String -> Q Exp,
                                 quotePat  :: String -> Q Pat,
                                 quoteType :: String -> Q Type,
                                 quoteDec  :: String -> Q [Dec] } 
```

也就是说，它是从任意字符串到一个或多个`ExpQ`、`PatQ`、`TypeQ`和的解析器`DecQ`，它们分别是表达式、模式、类型和声明的模板 Haskell 表示。

当您使用准引号时，GHC 将解析器应用到 String 以创建一个`ExpQ`（或其他类型），然后拼接生成的模板 haskell 表达式以产生一个实际值。

听起来您要求做的是将准引号解析和拼接分开，以便您可以访问 TH 表达式。然后你可以将该表达式导入另一个模块并自己在那里拼接。

知道准报价者的类型，很明显这是可能的。通常你使用QQ作为

```
-- file Expr.hs
eval :: Expr -> Integer
expr = QuasiQuoter { quoteExp = parseExprExp, quotePat =  parseExprPat }

-- file Foo.hs
import Expr
myInt = eval [expr|1 + 2|] 
```

相反，您可以自己提取解析器，获取 TH 表达式，然后再拼接：

```
-- file Foo.hs
import Expr

-- run the QQ parser
myInt_TH :: ExpQ
myInt_TH = quoteExp expr "1 + 2"

-- file Bar.hs
import Foo.hs

-- run the TH splice
myInt = $(myInt_TH) 
```

当然，如果您自己编写所有这些，您可以跳过准引号并直接使用解析器和模板 Haskell。无论哪种方式，这几乎都是一样的。

# php - php中定义的变量和数组与函数

> ID：10020524
> 
> 赞同：2
> 
> 时间：2012-04-04T23:07:59.103
> 
> 标签：php, arrays, function, optimization, readability

# 介绍

我有某种值，我可能想在每个页面加载时访问几次。我可以采用两种不同的方法来访问它们，但我不确定哪一种“更好”。三个已经实现的示例是我在此处描述的语言、URI 和显示文本的几个选项：

# 语言

现在它是这样配置的：`lang()`是一个根据参数返回不同值的函数。

示例：`lang("full")`打印当前语言“English”，同时`lang()`打印当前语言的缩写“en”。还有更多选项，例如打印不同内容`lang("select")`的 ,`lang("selectact")`等。该代码太长且与案例无关，因此如果有人想要它，只需询问即可。

# 网址

$Url 数组还根据请求返回不同的值。整个数组在页面的开头完全定义，用于获取当前页面的较短但准确的链接。

示例：`echo $Url['full']`将打印“http://mypage.org/path/to/file.php?page=1”并`echo $Url['file']`打印“file.php”。它对`action=""`表单和许多其他事情很有用。`$Url['folder']`,等有更多的值`$Url['file']`。代码也一样，如果需要，只需请求即可。

# 文本

[您可以跳过此部分]

还有一个名为 $Text 的数组，其定义方式与 $Url 相同。整个数组在开始时定义，进行 mysql 调用并`$Text[$i]`使用 while 循环为当前页面定义 all。我不确定这是否比对单个 mysql 单元的多次调用更有效。

示例：`echo $Text['54']`打印“这只是一个测试数组！” 这可以用类似的函数完美地实现`text(54)`。

# 问题

通过 3 个示例，您可以看到我使用不同的方法来完成几乎相同的功能（没有双关语），但我不确定哪一种应该成为我的代码的标准方法。我可以创建一个名为`url()`和其他调用的函数`text()`来输出我想要的。我认为在这些情况下使用函数会更好，但我不确定为什么。所以我非常感谢你的意见和建议。

**我应该按照我描述的方式混合数组和函数还是应该只使用函数？**

请在此基础上回答您的问题：

*   源代码需要其他开发人员**可读**和**可重用**
*   **资源消耗**（处理、时间和内存）。
*   代码越**短**越好。
*   你**解释**的原因越多越好。

谢谢

PS，现在我知道 $Url 和 $Uri 之间的区别了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:20:48.093

听起来您正在通过数组表示法实现模棱两可的功能。通常，这些是带有方法的类。`$url['full']`将是`$url->getFullPath()`。方法比数组访问器更受欢迎，因为方法已记录在案，并且可以由 IDE 进行自省。对象更可取，因为（在您的示例中）您可以延迟加载信息。现在，您的脚本正在编译`$Url`数组并为每个可能的键计算值，以便在脚本中使用它。而`$request`对象只能根据请求进行解析 - 而不是实例化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:27:39.077

我正在使用类似 config array var 的东西。设置字符串的位置。`$LBL["hello"]='Hi!'`比.更适合以后阅读使用`lbl(5)`。想想你自己什么时候会在一年后回到你的代码:)

# java - 错误：找不到主类

> ID：10020526
> 
> 赞同：2
> 
> 时间：2012-04-04T23:08:08.123
> 
> 标签：java, class, netbeans, main

我是使用 netbeans IDE 7.1.1 的新手 java 开发人员，我正在观看本教程，我马上就在我的程序中收到错误，即使在 5 次重新输入以确保它与视频中的完全相同所以无论如何这是错误

> 错误：无法找到或加载主类 javagame.JavaGame Java 结果：1

这是我写的代码

```
package JavaGame;

import javax.swing.JFrame;

public class JavaGame extends JFrame {

    public JavaGame(){
        setTitle("java game");
        setSize(500, 500);
        setResizable(false);
        setVisible(true);
        //setDefaultCloseOperation();

    }

    public static void main(String[] args){

    }
} 
```

您可以在[这张图片](http://imgur.com/o7evk)中找到我的项目结构的外观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:13:40.537

如果那是您的代码的完全复制粘贴，那么您的问题出在包名称上。Java 是区分大小写的，并且您的包名称是`JavaGame`这样的，您的类的限定名称是`JavaGame.JavaGame`，而您得到的异常是它无法找到该类`javagame.JavaGame`。

将使用 Netbeans 的包从 重命名`JavaGame`为`javagame`. 那应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:03:49.953

问题出在你的包名上。在第 1 行更改代码

```
package JavaGame;    
package javagame; 
```

NetBeans 通常喜欢在包中使用较低的文本。

希望这能解决问题。由于代码在我的机器上运行。

菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T14:19:11.623

转到环境变量并添加JDK的路径。
我过去遇到过这个错误，并通过设置类路径来解决。

# java - Path.transform 被多次应用

> ID：10020527
> 
> 赞同：1
> 
> 时间：2012-04-04T23:08:13.703
> 
> 标签：java, android, path, matrix, live-wallpaper

我正在编写一个使用多种路径的动态壁纸。我使用矩阵在形状的构造函数中缩放这些路径。

```
this.path = pathCoords;
this.path.transform(Scale.getMatrix()); 
```

这是我在 Scale 类中缩放矩阵的方法：

```
public static void setMatrix(DisplayMetrics mDisplayMetrics) {
    matrix.postScale((float) mDisplayMetrics.widthPixels / 540f,
            (float) mDisplayMetrics.heightPixels / 960f);
} 
```

现在动态壁纸在预览中加载得很好，但是当我将它设置为壁纸时，路径似乎又缩小了。事实上，我可以再复制 3 次，每次路径都缩小得更多。最后它崩溃了：

```
E/AndroidRuntime(32434): java.lang.OutOfMemoryError 
```

我究竟做错了什么？这种行为的原因是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:27:00.470

我设法通过在缩放之前添加重置来解决此问题：

```
public static void setMatrix(DisplayMetrics mDisplayMetrics) { 
matrix.reset(); 
matrix.preScale((float) mDisplayMetrics.widthPixels / 540f, (float) mDisplayMetrics.heightPixels / 960f); 
} 
```

但是，我认为问题在于动态壁纸被多次加载（和缩放）到内存中，最终导致 java.lang.OutOfMemoryError。但这完全是另一回事:)

# python - 在 Python wx 中显示来自 Sqlite 数据库的大型数据集

> ID：10020528
> 
> 赞同：1
> 
> 时间：2012-04-04T23:08:20.303
> 
> 标签：python, sqlite, wxpython, wxwidgets

我有一个存储在 SQLite3 数据库中的大型数据集（日志数据）。我使用 Wx.listctrl 创建了一个 Python GUI，它显示来自查询的数据。它适用于少量数据，但显然挂在较大的集合上..因此我想实现以下两件事之一：

- 分页是在 listctrl 中显示前 5000 条记录，然后如果用户单击按钮，则显示下一个 5000 .. 依此类推.. 或者 - 当用户向下滚动 listctrl 时，它会不断填充新数据。 .

我将如何实现这些概念之一？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:17:25.653

使其成为[文档](http://docs.wxwidgets.org/2.8/wx_wxlistctrl.html)中所述的虚拟控件。列表视图将根据需要调用回调，以请求显示的特定行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:33:07.800

在不同的场景下，策略会有所不同。假设您只是将 wxPython 用于演示目的，并且您有一个单独的模块/包来处理数据。wxPython 控件仅从数据抽象层获取数据。

场景一：将所有日志数据加载到内存中，使用 wx.listctrl 或 wx.listview 显示行。

场景二：当 wx 视图更新时从数据库中获取数据。

在场景 I 中，您只需要设置一个变量来记住 UI 已读取的位置，或者如果您将日志加载为列表，您甚至可以简单地使用列表滑动。通过向下/向上滚动来自动更新视图可以在场景 I 中实现，因为所有数据都已加载并且不会再建立 sqlite db 连接。在方案 II 中通过向下/向上滚动来实现自动更新将是一个糟糕的选择，因为会有太多的数据库操作 - 想象一下您非常快速地向下滚动以期望获得第 5000 行？

在场景 II 中，您可以设置页面大小并使用 LIMIT/OFFSET 来获取您想要的数据集。您为偏移量保留另一个变量。使用变量 page_size 和 offset，您可以简单地获取数据并更新 wx 视图。这种情况特别适合限制内存使用。我不知道您的日志有多大，但毕竟将所有日志加载到内存中并不是一个好主意，因为日志不断增长，您可能还需要同时加载其他相对较大的数据集。

# excel - 如何在access/excel中合并相似的行

> ID：10020529
> 
> 赞同：0
> 
> 时间：2012-04-04T23:08:22.037
> 
> 标签：excel, ms-access, merge, duplicates

我有下表

```
Address,                 City,          Data1,   Data2, Data3
123 North 5th Street,    San Francisco, A,       B,     C
123 N 5th Street,        San Francisco, [Blank], D,     [Blank]
123 North 5th St,        San Francisco, E,       F,     G 
```

我想根据 2 个标准合并数据：地址的前 4 位数字和城市。
所以合并行看起来像：

```
123 North 5th Street, San Francisco, AE, BDF, CG 
```

我有大约 6000 条记录，包括“重复”。我在 access 和 excel 中都有表格，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:53:33.593

您确定要对该条件进行匹配吗？例如，您是否希望将以下记录与旧金山北四街 123 号上方的那三个记录相匹配？

执行此操作的理想方法是首先对数据进行标准化，然后对其进行重复数据删除。例如，在新西兰，我们使用 PAF 文件（邮政地址文件）来标准化寻址并准确地为每条记录发布 DPID（递送点标识符）。然后，您将能够匹配数据以执行合并记录的第二步（这仍然是一个棘手的练习）。在美国，会有很多供应商以少量费用为您提供便利，我相信 Axciom 是该领域的全球参与者。

如果您不想这样做，另一种选择是使用第三方工具将这些记录与一些模糊逻辑进行匹配，而不是自己编写代码，我之前使用过一个名为 DQGlobal 的公司的 Excel 插件来运行数据和匹配记录。

# asp.net-mvc-3 - Telerik MVC 3 (Razor) Q1 2012 Editor EditorFor() 绑定返回 Null 值并且不显眼的验证不起作用

> ID：10020530
> 
> 赞同：1
> 
> 时间：2012-04-04T23:08:49.133
> 
> 标签：asp.net-mvc-3, razor, telerik, editor, editorfor

我目前正在开发我的第一个 MVC3 应用程序（使用 Razor 视图引擎），并决定使用开源 Telerik Q1 2012 控件，因为它们将提供我需要的许多功能（并且看起来也不错）。现在我遇到的问题是使用 Telerik Editor 控件并绑定到我的视图模型。我在页面上有标准的 Html.EditorFor() 控件，可以正确返回 ViewModel 中的值，但绑定到 Telerik Editor 的属性为空。他们的文档完全没用（它只提到了一次EditorFor），而且他们似乎也没有在论坛上回答太多问题。我的主要问题是，如何将 Telerik MVC3 编辑器绑定到模型并让它设置绑定到它的属性？我的视图模型代码如下（感谢您提供的任何帮助，

```
public class SupportViewModel
{
    [Display(Name = "Ticket Subject")]
    [MaxLength(30)]
    [Required(ErrorMessage = "The ticket subject is required.")]
    public string TicketSubject { get; set; }

    [Display(Name = "Support Issue")]
    [Min(1, ErrorMessage = "You must select a support issue.")]
    public int SupportIssueID { get; set; }

    [Display(Name = "Ticket Priority")]
    [Min(1, ErrorMessage = "You must select a ticket priority.")]
    public int TicketPriorityID { get; set; }

    //public string EmployeeID { get; set; }
    public bool IsClosed { get; set; }

    [Required(ErrorMessage = "The detail message is required.")]
    public string DetailMessage { get; set; }
} 
```

查看代码：

```
@model RadixMVC.ViewModels.SupportViewModel

@{
    ViewBag.Title = "Create New Support Ticket";
}

<h2>Radix Support: Create New Support Ticket</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset style="width: 500px">
        <legend>Create New Support Ticket</legend>
        <div class="editor-label">
            @Html.LabelFor(model => model.TicketSubject)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.TicketSubject)
            @Html.ValidationMessageFor(model => model.TicketSubject)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.SupportIssueID)
        </div>
        <div class="editor-field">
            @Html.DropDownList("SupportIssueID", string.Empty)
            @Html.ValidationMessageFor(model => model.SupportIssueID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.TicketPriorityID)
        </div>
        <div class="editor-field">
            @Html.DropDownList("TicketPriorityID", string.Empty)
            @Html.ValidationMessageFor(model => model.TicketPriorityID)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.IsClosed)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.IsClosed)
            @Html.ValidationMessageFor(model => model.IsClosed)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.DetailMessage)
        </div>
        <div class="editor-field">  
            @*@Html.EditorFor(model => model.DetailMessage)*@
            @Html.ValidationMessageFor(model => model.DetailMessage)

            <br />

            @{ Html.Telerik().EditorFor(model => model.DetailMessage)
                   .Name("DetailMessageEditor")
                   .HtmlAttributes(new { style = "height: 200px" })
                   .Encode(false)
                   .Render();
            } 
        </div>

        <div>
            <br />
            <input type="submit" value="Create Ticket" title="Submits a new support ticket" />
            <input type="submit" onclick="parent.location='@Url.Action("Index", "Support", "Index")'" value="Cancel" title="Return to Support Home" />
        </div>
    </fieldset>
} 
```

最后，控制器代码：

```
 [HttpPost]
    public ActionResult Create(SupportViewModel vm)
    {
        if (ModelState.IsValid)
        {
            SupportTicket SupportTicket = new SupportTicket()
            {
                SupportTicketID = Guid.NewGuid(),
                EmployeeID = "123456",
                TicketOpenDate = DateTime.Now,
                TicketModifiedDate = DateTime.Now,
                IsClosed = vm.IsClosed,
                TicketSubject = vm.TicketSubject,
                SupportIssueID = vm.SupportIssueID,
                TicketPriorityID = vm.TicketPriorityID
            };

            TicketDetail TicketDetail = new TicketDetail()
            {
                TicketDetailID = Guid.NewGuid(),
                SupportTicketID = SupportTicket.SupportTicketID,
                TicketOrder = 1,
                EmployeeID = "123456",
                DetailDate = DateTime.Now,
                DetailMessage = vm.DetailMessage
            };

            SupportTicket.TicketDetails.Add(TicketDetail);
            db.SupportTickets.Add(SupportTicket);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        ViewBag.SupportIssueID = new SelectList(db.SupportIssues, "SupportIssueID", "Name", vm.SupportIssueID);
        ViewBag.TicketPriorityID = new SelectList(db.TicketPriorities, "TicketPriorityID", "Name", vm.TicketPriorityID);

        return View(vm);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:37:37.343

我能够得到这个工作。该文档要么非常过时，要么只是没有解释如何很好地做到这一点（可能两者兼而有之）。但是我能够通过对我的 Razor 语法进行以下更改来完成这项工作：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.DetailMessage)
    </div>
    <div class="editor-field">  
        @*@Html.EditorFor(model => model.DetailMessage)*@
        @Html.ValidationMessageFor(model => model.DetailMessage)

        <br />

        @{ Html.Telerik().EditorFor(model => model.DetailMessage)
               //.Name("DetailMessageEditor")
               .HtmlAttributes(new { style = "height: 200px" })
               .Encode(true)
               .Render();
        } 
    </div> 
```

从控件中删除“名称”属性解决了无法取回任何东西的问题，但是当我尝试保存时，我立即收到错误（与 XSS、跨站点脚本有关），我认为是因为HTML 没有被编码。我将 Encode 属性更改为 true，现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T10:51:57.277

今天遇到了类似的事情。

我使用的是视图模型，而我想绑定的属性是视图模型中子对象的属性。

当我提交时，RTE 中的值没有被绑定。当我查看 Request.From 对象时，我可以看到该值以正确的格式返回，以便以通常的方式绑定，所以我有点困惑。

无论如何，如果您希望它绑定，您需要将您的财产的**确切**名称提供给 RTE，所以在您的情况下

```
.Name("DetailMessage") 
```

应该工作，但

```
.Name("DetailMessageEditor") 
```

将不会。

我的情况是我必须命名 RTE

```
.Name("object.Property") 
```

其中 object 是我的财产所在的 View 模型上的子对象，以使其工作

希望这可以帮助某人。

# asp.net-mvc - 单个视图上的 MVC 多个表单不起作用

> ID：10020533
> 
> 赞同：0
> 
> 时间：2012-04-04T23:09:26.997
> 
> 标签：asp.net-mvc, jquery, c#-4.0

我在单独的对话框中打开的单个剃刀视图上有 2 个表单。表单是使用 jquery post 提交的。

第一种形式完美运行，但第二种形式根本无法识别，当我尝试序列化数据时，它返回一个空字符串。

下面的代码：

```
@using (Html.BeginForm("SaveElectricReading", "Store", FormMethod.Post, new { id = "frmSaveElectricReading" }))
{
    <div id="electricDialog" style="display: none;" title="Electric Readings">
        <p>
            Please ensure the electric readings have been entered!
        </p>
        <table width="100%">
            <tr>
                <th>
                    Serial:
                </th>
            </tr>
            <tr>
                <td>
                    <input type="text" name="Serial" />
                </td>
            </tr>
            <tr>
                <th>
                    Reading:
                </th>
            </tr>
            <tr>
                <td>
                    <input type="text" name="Reading" />
                </td>
            </tr>
            <tr>
                <th>
                    Comment:
                </th>
            </tr>
            <tr>
                <td>
                    <div class="textwrapper">
                        <textarea rows="5" cols="10" name="Comment"></textarea>
                    </div>
                </td>
            </tr>
        </table>
    </div>
}

@using (Html.BeginForm("SaveWaterReading", "Store", FormMethod.Post, new { id = "myform" }))
{
    <div id="waterDialog" style="display: none;" title="Water Readings">
        <p>
            Please ensure the water readings have been entered!
        </p>
        <table width="100%">
            <tr>
                <th>
                    Serial:
                </th>
            </tr>
            <tr>
                <td>
                    <input type="text" name="WaterSerial" />
                </td>
            </tr>
            <tr>
                <th>
                    Reading:
                </th>
            </tr>
            <tr>
                <td>
                    <input type="text" name="WaterReadingsdfsdf" />
                </td>
            </tr>
            <tr>
                <th>
                    Comment:
                </th>
            </tr>
            <tr>
                <td>
                    <div class="textwrapper">
                        <textarea rows="5" cols="10" name="WaterComment"></textarea>
                    </div>
                </td>
            </tr>
        </table>
    </div>
}

function showWaterDialog() {
    var $dialog = $('#waterDialog').dialog({
        autoOpen: false,
        modal: true,
        width: 400,
        height: 400,
        buttons: {
            Submit: function () {
                //                $('#frmCreateStore').submit();
                var data = $('#frmSaveWaterReading');

                $.post("/Store/SaveWaterReading",
                    $("#frmSaveWaterReading").serialize(),
                    function () {
                        $("#waterDialog").dialog("close");
                    });
                //$(this).dialog("close");
            },
            Cancel: function () {
                $(this).dialog("close");
            }
        }
    });

    $dialog.dialog('open');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T10:25:50.330

在用于显示包含表单的对话框的 jquery 函数中，我需要将该对话框内容添加到页面上的第二个表单中，如下所示：

$("#waterDialog").parent().appendTo($("form").eq(1)[0]);

# api - Flickr API - 照片搜索，不包括标签：我做错了吗？

> ID：10020535
> 
> 赞同：0
> 
> 时间：2012-04-04T23:09:29.323
> 
> 标签：api, search, tags, flickr

因此，我试图通过 提取特定用户帐户的所有照片`flickr.photos.search method`，但我想排除带有特定标签的照片。相关文档页面指出“*您可以通过在前面加上 - 字符来排除与术语匹配的结果。* ”......好吧，我尝试实现该选项，但得到的只是一张照片（即使[有几张照片有问题的标签](http://www.flickr.com/photos/68293262@N03/tags/blog/)），并且无论该特定照片是否有问题的标签以及我是否使用“-”选项排除该标签而不是包含它，结果都保持不变。我还尝试了`text`具有相同结果的方法。这是我的 REST 调用：

```
http://api.flickr.com/services/rest/?&method=flickr.photos.search&api_key='.$api_key.'&user_id='.$user_id.'&tag_mode=any&tags=-blog&extras=url_o,url_t&format=json 
```

这是我试图让这一切正常工作的页面：

[http://corazonbrew.com/temp/](http://corazonbrew.com/temp/)

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:09:40.950

看来我之前链接到的[Flickr 讨论板](http://www.flickr.com/groups/api/discuss/72157625456418732/)中的答案被证明是正确的。为了使用排除选项，还必须至少有一个其他非排除标签。好吧，这对我来说还不够好。

几个朋友告诉我，这是一个长期存在的错误，不会很快修复，如果有的话。但是那些朋友也好心地提醒了我我的 n00bishness - 这一直以来我都认为我需要影响提要以获得所需的输出。我完全没有意识到我可以使用一些好的 ol' PHP if 语句来清除我不想要的东西。

# google-app-engine - Google App Engine 是否使用任何管理程序？

> ID：10020537
> 
> 赞同：1
> 
> 时间：2012-04-04T23:09:35.510
> 
> 标签：google-app-engine, hypervisor

由于 Google App Engine 是一个 PaaS，它是否使用任何管理程序？众所周知，Amazon EC2 使用 XEN，Microsoft Azure 使用 Hyper-V。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T09:17:49.077

EC2 是基础设施即服务，提供对硬件的低级访问；因此，管理程序的选择是相关的。MS 的 Azure 还提供了相当低级别的访问。App Engine 是围绕 Google 堆栈构建的；它不提供对内核级服务的访问，因此管理程序的选择（或存在）无关紧要。

# mysql - 检查满足特定条件的最大连续天数

> ID：10020540
> 
> 赞同：5
> 
> 时间：2012-04-04T23:09:53.497
> 
> 标签：mysql, sql

我有一个结构如下的 MySQL 表：

饮料日志（ID，用户 ID，饮料 ID，时间戳）

我正在尝试计算用户（ID 为 1）每天至少记录 5 次饮料（ID 为 1）的连续天数的最大值。我很确定这可以使用如下视图来完成：

```
CREATE or REPLACE VIEW daycounts AS
SELECT count(*) AS n, DATE(timestamp) AS d FROM beverages_log
WHERE users_id = '1' AND beverages_id = 1 GROUP BY d;

CREATE or REPLACE VIEW t AS SELECT * FROM daycounts WHERE n >= 5;

SELECT MAX(streak) AS current FROM ( SELECT DATEDIFF(MIN(c.d), a.d)+1 AS streak
FROM t AS a LEFT JOIN t AS b ON a.d = ADDDATE(b.d,1)
LEFT JOIN t AS c ON a.d <= c.d
LEFT JOIN t AS d ON c.d = ADDDATE(d.d,-1)
WHERE b.d IS NULL AND c.d IS NOT NULL AND d.d IS NULL GROUP BY a.d) allstreaks; 
```

但是，每次运行此检查时重复为不同用户创建视图似乎效率很低。MySQL 中有没有一种方法可以在单个查询中执行此计算，而无需创建视图或多次重复调用相同的子查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T00:38:52.220

只要 users_id 和 Drinks_id 上有一个复合索引，这个解决方案似乎表现得很好 -

```
SELECT *
FROM (
    SELECT t.*, IF(@prev + INTERVAL 1 DAY = t.d, @c := @c + 1, @c := 1) AS streak, @prev := t.d
    FROM (
        SELECT DATE(timestamp) AS d, COUNT(*) AS n
        FROM beverages_log
        WHERE users_id = 1
        AND beverages_id = 1
        GROUP BY DATE(timestamp)
        HAVING COUNT(*) >= 5
    ) AS t
    INNER JOIN (SELECT @prev := NULL, @c := 1) AS vars
) AS t
ORDER BY streak DESC LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:36:07.817

为什么不在他们的 daycounts 视图中包含 user_id，并按 user_id 和日期分组。

还要在视图 t 中包含 user_id。

然后，当您反对 t 时，将 user_id 添加到 where 子句。

然后，您不必为每个用户重新创建视图，您只需要记住将其包含在 where 子句中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:36:31.327

这有点棘手。我将从按天总结事件的观点开始：

```
CREATE VIEW BView AS
    SELECT UserID, BevID, CAST(EventDateTime AS DATE) AS EventDate, COUNT(*) AS NumEvents
    FROM beverages_log
    GROUP BY UserID, BevID, CAST(EventDateTime AS DATE) 
```

然后，我将使用 Dates 表（只是一个每天一行的表；非常方便）来检查所有可能的日期范围并丢弃任何有间隙的日期范围。这可能会很慢，但这是一个开始：

```
SELECT
    UserID, BevID, MAX(StreakLength) AS StreakLength
FROM
    (
    SELECT
        B1.UserID, B1.BevID, B1.EventDate AS StreakStart, DATEDIFF(DD, StartDate.Date, EndDate.Date) AS StreakLength
    FROM
        BView AS B1
        INNER JOIN Dates AS StartDate ON B1.EventDate = StartDate.Date
        INNER JOIN Dates AS EndDate ON EndDate.Date > StartDate.Date
    WHERE
            B1.NumEvents >= 5
        -- Exclude this potential streak if there's a day with no activity
        AND NOT EXISTS (SELECT * FROM Dates AS MissedDay WHERE MissedDay.Date > StartDate.Date AND MissedDay.Date <= EndDate.Date AND NOT EXISTS (SELECT * FROM BView AS B2 WHERE B1.UserID = B2.UserID AND B1.BevID = B2.BevID AND MissedDay.Date = B2.EventDate))
        -- Exclude this potential streak if there's a day with less than five events
        AND NOT EXISTS (SELECT * FROM BView AS B2 WHERE B1.UserID = B2.UserID AND B1.BevID = B2.BevID AND B2.EventDate > StartDate.Date AND B2.EventDate <= EndDate.Date AND B2.NumEvents < 5)
    ) AS X
GROUP BY
    UserID, BevID 
```

# c# - C# 列表作为字典键

> ID：10020541
> 
> 赞同：18
> 
> 时间：2012-04-04T23:09:59.680
> 
> 标签：c#, list, dictionary, containskey

我有一本由列表键入的字典：

```
private Dictionary<List<custom_obj>, string> Lookup; 
```

我正在尝试使用 ContainsKey，但它似乎不起作用，我不知道为什么。这是来自我的 Visual Studio 即时窗口的调试信息：

```
?Lookup.Keys.ElementAt(7)[0]
{custom_obj}
    Direction: Down
    SID: 2540
?Lookup.Keys.ElementAt(7)[1]
{custom_obj}
    Direction: Down
    SID: 2550
searchObject[0]
{custom_obj}
    Direction: Down
    SID: 2540
searchObject[1]
{custom_obj}
    Direction: Down
    SID: 2550
?Lookup.ContainsKey(searchObject)
false 
```

按照我的常识，最后一个 ContainsKey 应该是真的。希望我在这里包含了足够的信息......有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T23:15:01.423

`List<custom_obj>`充当键的实例在引用上不等于 searchObject 引用的实例。

如果您希望字典使用列表中的值而不是引用相等来查找匹配键，则必须在字典的[构造函数](http://msdn.microsoft.com/en-us/library/ms132072.aspx)中提供 IEqualityComparer（因为您不能覆盖 Equals 和 GetHashCode `List<T>`）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-04T23:15:54.390

您有两个`List`包含相同元素的独立 s。找出两个列表是否相等的正确方法是使用`SequenceEqual`方法。

默认情况下，你不能做你想做的事。但是，您可以编写自定义`IEqualityComparer`并将其传递给`Dictionary`构造函数。

这是一个通用示例`IEqualityComparer`：

```
class ListComparer<T> : IEqualityComparer<List<T>>
{
    public bool Equals(List<T> x, List<T> y)
    {
        return x.SequenceEqual(y);
    }

    public int GetHashCode(List<T> obj)
    {
        int hashcode = 0;
        foreach (T t in obj)
        {
            hashcode ^= t.GetHashCode();
        }
        return hashcode;
    }
} 
```

您可能希望改进`GetHashCode`实施，因为这是一个快速而肮脏的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-04T23:15:22.280

这仅在查找中使用的实际列表实例与作为键添加的实例相同时才有效。它不会比较列表内容。如果您尝试直接比较两个 List 对象，则会得到相同的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T23:16:56.980

您确定您在查找方法中使用的实例与字典键中的实例相同吗？这是我唯一能想到的。

# node.js - 永远使用；如何找出子进程的pid？

> ID：10020543
> 
> 赞同：2
> 
> 时间：2012-04-04T23:10:18.363
> 
> 标签：node.js

我在我的 node.js 应用程序中使用[Forever 。](http://github.com/nodejitsu/forever)我正在启动一个子进程，例如：

```
var forever = require('forever');

child = new (forever.Monitor)('path/to/my/server.js', {
    max: 3,
    silent: true,
    options: []
});

child.start(); 
```

我怎样才能找出那个子进程的pid？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T01:19:23.083

```
var forever = require('forever');

child = new (forever.Monitor)('path/to/my/server.js', {
    max: 3,
    silent: true,
    options: []
});

child.on('start', function(process, data) { console.log(data.pid); });
child.start(); 
```

监听 'start' 事件，它是传递给回调函数的第二个参数的 pid 属性。

# apache - 没有标志 R 的 RewriteRule

> ID：10020544
> 
> 赞同：0
> 
> 时间：2012-04-04T23:10:23.593
> 
> 标签：apache, mod-rewrite, url-rewriting

为什么这个规则：

```
RewriteRule ^(.*)/([1-9]+)[^/]$ /$1/?utm_source=$2 [R,L] 
```

使用 R 标志，没有它不起作用。有什么问题 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T07:17:11.693

因为没有`R`标志，它是内部重写，它不是实际的重定向。

您可以自己进行一些搜索：

*   [这是serverfault.com](https://serverfault.com/questions/214512/everything-you-ever-wanted-to-know-about-mod-rewrite-rules-but-were-afraid-to-as)的 wiki
*   howto的[htaccess 官方指南](http://httpd.apache.org/docs/2.2/howto/htaccess.html)
*   [官方 mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)指南

## 两个提示可以帮助您更快地完成工作：

* * *

请尝试使用该`RewriteLog`指令：它可以帮助您追踪问题：

```
# Trace:
# (!) file gets big quickly, remove in prod environments:
RewriteLog "/web/logs/mywebsite.rewrite.log"
RewriteLogLevel 9
RewriteEngine On 
```

* * *

我最喜欢的检查正则表达式的工具：

[https://regex101.com/](https://regex101.com/)（不要忘记选择 ereg(POSIX) 而不是 preg(PCRE)！）

当您想检查 URL 并查看它们是否有效时，您可以使用此工具。

# selenium - 可以用 VB.Net 为 selenium rc 编写测试吗？

> ID：10020546
> 
> 赞同：0
> 
> 时间：2012-04-04T23:10:32.973
> 
> 标签：selenium

可以在 VB.Net 中为 Selenium 编写测试脚本吗？还是只有 c#（除了 java、perl、php 等）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:20:29.440

是的，但是 Selenium 工具不会显式导出到 VB，您需要从 C# 手动转换它（或使用自动化工具）。

[本文](http://jorno.org/20100304/selenium-for-vb-net/)展示了代码在 VB 中的外观，并提供了一个转换工具的链接，我在[这里](http://www.developerfusion.com/tools/convert/csharp-to-vb/)也链接了该链接

# iis - 为什么在 IIS 7.5 中使用 ISAPI 重定向时收到 http 错误 403.14

> ID：10020550
> 
> 赞同：1
> 
> 时间：2012-04-04T23:11:28.053
> 
> 标签：iis, load-balancing, tomcat5.5, isapi-redirect

我正在尝试使用 IIS 作为在 Tomcat 上运行的 Java 应用程序的负载平衡器进行测试。[当我按照此站点上](http://blogs.mulesoft.org/load-balancing-tomcat-7-using-iis-7-5/)的教程尝试在浏览器中加载站点时，会出现一个 IIS 错误页面，内容为“HTTP 错误 403.14 - 禁止访问。Web 服务器配置为不列出此目录的内容。” 我重新审视了教程的每一个细节，没有发现任何失误。

一个很大的变化是我正在使用一个 Java 应用程序，它与 Tomcat 5.5 捆绑在一起。

我通过将工作人员缩小到负载平衡器和一个 Tomcat 实例/AJP 工作人员来简化事情。

我查阅了其他教程和[Apache 提供的文档](http://tomcat.apache.org/connectors-doc/reference/iis.html)，这导致我将 isapi_redirect.dll、workers.properties 和 uriworkermap.properties 文件移动到 Tomcat 目录中，并将 isapi_redirect.properties 设置移动到注册表中（并调整目录属性文件和 IIS 中引用的路径以匹配）。我继续收到 403.14 错误。当我在 IIS 中启用目录列表时，该站点会加载 bin 目录中的文件列表。

isapi_redirect 日志没有生成，所以我认为问题出在 IIS 或 isapi_redirect 设置中。我可能缺少什么会导致 403.14 错误？

我正在使用 Windows Server 2008 R2、IIS 7.5、ISAPI_redirect 1.2.35、Tomcat 5.5。

# python - Django 模型使用关键字 IN

> ID：10020551
> 
> 赞同：0
> 
> 时间：2012-04-04T23:11:37.123
> 
> 标签：python, django, django-models

我试图弄清楚如何在 django 模型查询中使用 IN 关键字。

我试图替换：

```
db = database.connect()
c = db.cursor()
c.execute("SELECT MAX(Date) FROM `Requests` WHERE UserId = %%s AND VIN = %%s AND Success = 1 AND RptType in %s" % str(cls.SuperReportTypes), (userID, vin)) 
```

有了这个：

```
myrequests = Request.objects.filter(user=userID, vin = vin, report_type in cls.SuperReportTypes)
myrequests.aggregate(Max('Date')) 
```

我得到一个：

```
SyntaxError: non-keyword arg after keyword arg (<console>, line 1) 
```

当我删除结尾`"report_type in cls.SuperReportTypes"`时，查询功能正常。

我认识到在管理结果集的查询之后有一种方法可以执行此操作，但我希望以 MYSQL 执行执行的方式处理此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:14:08.617

[`field__in=seq`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#in)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:47:43.253

你在声明中使用了错误的

[https://docs.djangoproject.com/en/dev/ref/models/querysets/#in](https://docs.djangoproject.com/en/dev/ref/models/querysets/#in)

# clearcase - 将 RationalTeamConcert SCM 导入 Clearcase

> ID：10020552
> 
> 赞同：2
> 
> 时间：2012-04-04T23:11:39.697
> 
> 标签：clearcase, rtc, ibm-rational

我正在尝试将完整的 RTC 存储库导入 ClearCase VOB。我曾尝试使用 clearfsimport 但它似乎只需要最新版本的文件。有什么方法可以在保留历史记录（评论、重命名等）的同时导入代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:02:44.150

这种导入应该逐个组件地完成到[UCM 组件 Vob](https://stackoverflow.com/a/10017263/6309)中，而不是到一个普通的 Base ClearCase Vob 中。
UCM 组件（和流）与 RTC 组件和 Streams 映射得非常好，但是使用`clearfsimport`，导入过程仍然是：

*   手册（因为您必须选择要查看的每个 RTC 基线才能[“clearfsimport”它们](https://stackoverflow.com/questions/416875/creating-a-new-subdirectory-structure-in-clearcase/418196#418196)）
*   *仅针对基线完成（导入所有*RTC 修订会太长）
*   没有像合并或重命名这样的元数据

**理论上，这是可能的**（但我还没有测试过），通过名为“ClearCase Synchronizer”的[ClearCase-RTC 连接器之一。](https://jazz.net/library/article/785)

> **ClearCase Synchronizer**是 ClearCase 和 Rational Team Concert 源控制之间的双向数据复制。
> 您可以选择 UCM 流或 ClearCase 分支并设置与 Rational Team Concert 源控制流的同步。
> 它利用 Jazz Team Build，您可以按计划或按您的要求运行同步。
> 这将为企业客户提供灵活性，让部分团队选择使用 SCM 工具，并通过单个 SCM 存储库管理所有最新的源代码。

请参阅“[使用 Rational ClearCase 同步器和导入器](https://jazz.net/help-dev/clm/index.jsp?topic=/com.ibm.team.connector.scm.cc.doc/topics/c_sync_intro.html&re=1&scope=null)”。
但我不知道它在一侧使用空 UCM 组件，另一侧使用完整历史 RTC 组件的情况下（或者是否完全可以使用）效果如何。

![ClearCase 同步器](../Images/94d9e72e014ef507c0b893d02d943a1c.png)

# c - 使用 __builtin_ia32_shufps 将向量移动 32 位？

> ID：10020553
> 
> 赞同：0
> 
> 时间：2012-04-04T23:11:53.747
> 
> 标签：c, vectorization, simd, shift

这是函数的原型：

```
v4si __builtin_ia32_shufps (v4si, v4si, int) 
```

在一些网站上，我发现它们在 int 字段中只有十六进制，看起来像是将高位和低位分开，但我想要的是逻辑 32 位移位。

```
X3 X2 X1 X0 shifted by 32 bits to get X2 X1 X0 0 
```

另一个使用 2 个 v4si 向量的示例：

```
X7 X6 X5 X4 | X3 X2 X1 X0, where each X is a 32 bit and what I want for a shift is the 
same a logical shift, but with each vector element. So:
X7 X6 X5 X4 | X3 X2 X1 X0 << 2 = X5 X4 X3 X2 | X1 X0  0  0 
```

shufps 是执行此操作的正确命令吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T05:50:58.600

用两个向量查看您的示例，我认为您可能正在寻找的是[_mm_alignr_epi8 (PALIGNR)](http://msdn.microsoft.com/en-us/library/bb514041.aspx)。这适用于将一对向量任意移位任意*字节*数，因此您需要将移位参数乘以`sizeof(int)`，例如

```
v = _mm_alignr_epi8(v0, v1, 2 * sizeof(int)); 
```

请注意，此指令仅在 SSSE3 及更高版本中可用，这意味着自 2005 年以来几乎所有的英特尔 CPU。

# android - 如何在 ViewPager 上使用自定义字体？

> ID：10020555
> 
> 赞同：0
> 
> 时间：2012-04-04T23:11:59.413
> 
> 标签：android, android-viewpager, custom-font

我有一个使用 ViewPager 的 Android 应用程序，它可以正常工作，但现在我想在我的视图中添加自定义字体，当我在页面之间滑动时，我会更改布局。这是我的代码：

```
import com.viewpagerindicator.TitlePageIndicator;
import com.viewpagerindicator.TitleProvider;
import android.app.Activity;
import android.content.Context;
import android.graphics.Typeface;
import android.os.Bundle;
import android.os.Parcelable;
import android.support.v4.view.PagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.TextView;

/** *************************************************************************************************
/** Clase:   public class LCMeter extends Activity
/** Notas:   esta Activity usa desplazamiento por paginas horizontal
/** Funcion: obtiene de puerto USB los datos de frecuencia, inductancia, capacitancia y los muestra
/**          con multiples funciones como creacion de graficos, logs, etc
****************************************************************************************************/
public class LCMeter extends Activity {

    // titulos de las paginas
    private static String[] titulosPaginas = { "APP 1", "APP 2", "APP 3" };
    private Context cxt;
    private ViewPager columnas;
    private ColumnasAdapter myAdapter;
    TextView txt;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);  //layout con PagerViewer
        cxt = this;

        myAdapter = new ColumnasAdapter();
        columnas = (ViewPager) findViewById(R.id.columnas);
        columnas.setAdapter(myAdapter);

        // Agrega los titulos
        TitlePageIndicator titleIndicator = (TitlePageIndicator) findViewById(R.id.titulos);    //layout XML
        titleIndicator.setViewPager(columnas);
    }

/** *************************************************************************************************
/** Clase:   private class ColumnasAdapter extends Pager Adapter implements TitleProvider
/** Notas:   extends PagerAdapter hace uso de la libreria y al usar implements TitleProvider permite
/**          colocar titulos a las paginas por las que nos movemos
/** Funcion: crea paginas por las cuales deslizarse hotizontalmente cambiando los Layout
****************************************************************************************************/
    private class ColumnasAdapter extends PagerAdapter implements TitleProvider {

        /// Obtiene numero de paginas en este caso el numero de elementos en el String
        @Override
        public int getCount() {
            return titulosPaginas.length;
        }

        // Obtiene el titulo para ponerle a la pagina
        @Override
        public String getTitle(int position) {
            // TODO Auto-generated method stub
            return titulosPaginas[position];    // titulo de la pagina
        }

        //Cambia los layout de acuerdo a las paginas
        @Override
        public Object instantiateItem(View collection, int position) {
            LinearLayout v = (LinearLayout) LayoutInflater.from(cxt).inflate(R.layout.lcmeter, null);

            // Ejecuto una Activity de acuerdo a la pagina en la que este
            switch (position) {
            case 0:
                v = (LinearLayout) LayoutInflater.from(cxt).inflate(R.layout.lcmeter, null);
                break;
            }

            ((ViewPager) collection).addView(v, 0);

            return v;
        }

        //Destruye las paginas cuando dejan de usarse
        @Override
        public void destroyItem(View collection, int position, Object view) {
            ((ViewPager) collection).removeView((LinearLayout)view);
        }

        @Override
        public boolean isViewFromObject(View view, Object object) {
            return view == ((LinearLayout) object);
        }

        @Override
        public void finishUpdate(View arg0) {}

        @Override
        public void restoreState(Parcelable arg0, ClassLoader arg1) {}

        @Override
        public Parcelable saveState() {
            return null;
        }

        @Override
        public void startUpdate(View arg0) {}

    }
} 
```

我想在名为“lcmeter”的布局上添加自定义字体，但是当我放它时：

```
TextView txt = (TextView) findViewById(R.id.custom_font);  
Typeface font = Typeface.createFromAsset(getAssets(), "Chantelli_Antiqua.ttf");  
txt.setTypeface(font); 
```

我在运行应用程序时得到了 FC，但是当我将相同的代码放在一个简单的 Activity whitout ViewPager 上时，它工作得很好，我认为问题出在：

```
Typeface font = Typeface.createFromAsset(getAssets(), "Chantelli_Antiqua.ttf"); 
```

也许上下文不正确，但我对此很陌生，所以我不太了解。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:15:34.013

尝试

```
TextView txt = (TextView) v.findViewById(R.id.custom_font); 
```

然后改变你的字体

像这样的东西：

```
// Ejecuto una Activity de acuerdo a la pagina en la que este
switch (position) {
     case 0:
            v = (LinearLayout) LayoutInflater.from(cxt).inflate(R.layout.lcmeter, null);
            TextView txt = (TextView) v.findViewById(R.id.custom_font); 
            Typeface font = Typeface.createFromAsset(getAssets(), "Chantelli_Antiqua.ttf");  
            txt.setTypeface(font); 
            break;
     } 
```

# php - 关于计数帖子的 Wordpress 插件

> ID：10020556
> 
> 赞同：0
> 
> 时间：2012-04-04T23:12:06.373
> 
> 标签：php, widget, wordpress

我正在尝试计算作者一个月内的帖子数。所以，我不知道如何编码和保存在任何地方。我认为它必须是接口。有什么优惠吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:14:23.567

[http://codex.wordpress.org/Function_Reference/wp_count_posts](http://codex.wordpress.org/Function_Reference/wp_count_posts)

# php - 使用 sendfile 方法和 php 将 xml 文件发送到 Web 服务

> ID：10020563
> 
> 赞同：1
> 
> 时间：2012-04-04T23:14:04.923
> 
> 标签：php, xml

我需要使用他们的 SendFile 方法将文件发送到 Web 服务（ebridge）。这可能对他们的服务来说太具体了，任何人都无法回答，但我想我会试一试。这是我能找到的关于 SendFile 方法的唯一文档：

> **目的**
> 此方法用于提交数据以供 ePortal 处理。
> **输入参数**
> Login（字符串） ePortal 用户 ID。
> 密码（字符串）该用户的 ePortal 密码。
> 内容（字符串）这是要上传的文档。
> Filename (string) 这是没有路径信息的文件名。
> **返回值**
> SendFileResult (boolean) 布尔返回值代表文件提交成功或失败。

这是他们发布的示例 xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
 <soap:Body>
<SendFile xmlns="eBridge.WebServices">
  <login>mylogin</login>
  <password>mypassword</password>
  <content>string</content>
  <filename>string</filename>
</SendFile>
  </soap:Body>
</soap:Envelope> 
```

我还收到了我应该发送的文件 (ASN.xml) 样本。我已经尝试将此文件中的 xml 放在内容标签之间，并将“test.xml”放在文件名标签中。那是行不通的。我知道我正在建立连接，因为如果我像上面一样离开它，我会收到回复，它只会返回 false，因为我没有发送任何东西。也许我误解了他们想要的内容和文件名？有谁知道我应该怎么做？

**澄清：**我想知道的是，如果 xml 文件作为字符串进入“内容”，那么“文件名”是什么？它实际上是在寻找一个文件还是这只是一个稍后分配给某物的名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:18:34.520

他们的网页有一个“实时聊天”。你为什么不问他们？

[http://www.ebridgeconnections.com/support/development-kit/API-services.html](http://www.ebridgeconnections.com/support/development-kit/API-services.html)

但我相信`<content>`这正是这个意思：您应该在 SOAP 消息中包含整个 XML 文件 - 作为一个字符串。

恕我直言...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:35:51.783

嗯，你在创建一个[SOAPClient](http://www.php.net/manual/en/class.soapclient.php)吗？该 xml 文件实际上是 SOAP 请求的主体，由 PHP 中的 SOAPClient 类封装。

对于 WSDL 文件：[https](https://www.ebridgeservices.com/ePortalService.asmx?WSDL) ://www.ebridgeservices.com/ePortalService.asmx?WSDL 使用 SOAPClient 类构建您对其服务的请求。使用 $soapReq->SendFile({args and blah here})

如果您不喜欢 PHP 手册：这是一个[示例/教程](http://www.vankouteren.eu/blog/2009/03/simple-php-soap-example/)。

# c# - 晦涩的 NHibernate 3.2 批量插入/HQL 问题

> ID：10020566
> 
> 赞同：1
> 
> 时间：2012-04-04T23:14:13.290
> 
> 标签：c#, .net, nhibernate, hql, bulkinsert

我需要根据用户传入的一组日期将事件记录“批量”插入到数据库中。

我的事件实体有一个 StartTime 属性和一个 StopTime 属性。Event 实体是我的应用程序中的核心实体，因此有许多与之关联的集合和实体引用。这是一个沉重的实体。

所以，我的原始代码让我遍历日期并执行以下操作：

```
 Session.Save(new Event {StartTime=startdate, StopTime=endDate}); 
```

然而，这并没有很好地扩展，我们在插入几百个日期时感受到了性能。

所以我想到了将所有日期插入临时表，但我不知道如何使用 HQL 来完成。

所以我的下一个想法是将所有日期作为子查询包含在内，这让我最接近。这是这种方法：

```
var hql = "INSERT INTO Event (Code, Comment, Description, Status, StartTime, StopTime)
           SELECT ev.Code, ev.Comment, ev.Description, ev.Status, Dates.SDate, Dates.EDate
           FROM Event ev, 
                (
                    SELECT '1/2/2012 3:00:00 PM' as SDate, '1/2/2012 6:00:00 PM' as EDate
                    UNION ALL SELECT '1/3/2012 3:00:00 PM', '1/3/2012 6:00:00 PM' 
                    UNION ALL SELECT '1/4/2012 3:00:00 PM', '1/4/2012 6:00:00 PM'
                ) as Dates
           WHERE ev.Id = :sourceEventId";

Session.CreateQuery(hql).SetInt32("sourceEventId", @event.Id).ExecuteUpdate(); 
```

但是 hql 以非常模糊的错误代码失败。我在网上的研究告诉我，hql 还不支持 UNION 子句。

现在，我将这种方法重写为 SQL 并通过 Session.CreateSQLQuery() 执行它，效果很好。但我不想将它作为 SQL 运行。无论如何，这违背了使用 NHibernate 的目的。

有没有另一种方法可以使用 HQL（或任何其他 NHibernate 技术）来解决这个问题？

非常感谢这里的任何帮助！

## 更新

1.  我忘了提到这是一个遗留的 SQL Server 数据库（我在 sqlite 上运行单元测试），并且所有实体都使用 SQL 的 Identity 列生成它们的 ID。所以任何批处理的尝试都会失败。

2.  正如我在下面的评论中解释的那样，我也尝试了无状态会话方法。NHibernate 将无法告诉我我需要先保存所有延迟加载的实体。我通过删除这些映射暂时解决了这个问题，它确实有效，而且比常规会话更快。但我最终还是不得不一次插入每个实体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:20:35.980

尝试使用无状态会话而不是会话

```
using (var session = sessionFactory.OpenStatelessSession())
using (var tx = session.BeginTransaction())
{
for (int i = 0; i < count; i++)
{
    session.Insert(yourObjects[i]);
}
tx.Commit();
} 
```

[这个链接也很有帮助](http://ayende.com/blog/4137/nhibernate-perf-tricks)

此外，您可以使用 ADO.net SqlBulkCopy 代替无状态会话，[请检查此](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T15:43:06.960

那这个呢？

```
var sdates = new []{ "1/2/2012 3:00:00 PM", "1/3/2012 3:00:00 PM", "1/4/2012 3:00:00 PM" };
var edates = new []{ "1/2/2012 6:00:00 PM", "1/3/2012 6:00:00 PM", "1/4/2012 6:00:00 PM" };

var hql = "INSERT INTO Event (Code, Comment, Description, Status, StartTime, StopTime)
       SELECT ev.Code, ev.Comment, ev.Description, ev.Status, :sdate, :edate
       FROM Event ev
       WHERE ev.Id = :sourceEventId";

for(var i=0;i<sdates.Length;i++)
{
     Session.CreateQuery(hql).SetInt32("sourceEventId", @event.Id)
                             .SetString("sdate", sdates[i])
                             .SetString("edate", edates[i])
                             .ExecuteUpdate();
} 
```

可能您需要使用 DateTime 而不是字符串并对代码进行一些调整，但这是一个想法。基本上，您将执行三个命令而不是一个命令，而不是 n+1（这就是您的扩展问题，对吗？）

希望能帮助到你。

# php - Socket.IO 与 Apache2 集成以实现实时更新日历

> ID：10020571
> 
> 赞同：0
> 
> 时间：2012-04-04T23:14:47.517
> 
> 标签：php, apache2, socket.io

我正在尝试使用 Socket.IO Websocket 构建一个带有实时更新的日历。我设法让 Socket.IO 服务器在端口 8181 上运行，但我的 calendar.php 是通过端口 80 上的 apache 管理的。

我想要做的是将我的 calendar.php 与 apache 一起使用，同时在端口 8181 上连接到我的 Socket.IO 服务器（或使用 apache 将其绑定到端口 80，但这似乎很复杂，我试过了后代理但不起作用）以在有人编辑日历中的事件时接收更新。我的事件存储在 SQL 数据库中。

那么有没有办法在端口 80 上由 apache 提供的 php 页面中使用端口 8181 上的 Socket.IO？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:22:08.773

我不确定我是否理解您的问题。一旦页面由 PHP 在 80 端口提供服务，您将以最简单的设置连接到 8181 上的 socket.io 服务器。

从那时起，您将不再需要与 php 交互，因为您可能会将消息发送到您的 socket.io 服务器进行处理。

对于负载平衡 socket.io，我认为您可以使用 HAProxy，而且我认为 LearnBoost 在 Github 上也有替代方案。实际上我的应用程序还没有达到这一步，所以我不能在这里提供太多信息。

但是，是的，您的 socket.io 服务器应该接收、处理和发送消息。如果您有多个 socket.io 实例正在运行，您也可以将 redis 用于 Pub/Sub。

有一个异步 MySQL 驱动程序的节点模块，可让您直接与数据库交互。我在我的应用程序中使用 MongoDb，所以我从未使用过 MySQL 模块。

我想，或者，您可以将您的 PHP 服务器用作 Web 服务，并且您的 socket.io 服务器可以与之交互，但我想这样做会很慢。

希望这可以解决问题。似乎您的设置已经在开发环境中运行。

# sql - PostgreSQL：额外列的性能影响

> ID：10020573
> 
> 赞同：11
> 
> 时间：2012-04-04T23:14:53.017
> 
> 标签：sql, database, performance, postgresql

给定一个大表（10-1 亿行），向其中添加一些额外（未索引）列的最佳方法是什么？

1.  只需添加列。
2.  为每个额外的列创建一个单独的表，并在您想要访问额外的值时使用连接。

答案是否会根据额外的列是密集的（主要不是空的）还是稀疏的（主要是空的）而改变？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-04T23:29:45.510

[*在大多数情况下*](https://stackoverflow.com/a/7383198/939860)，可以将具有`NULL`值的列添加到行中而无需对数据页的其余部分进行任何更改。**NULL 位图**中只需设置一位。所以，是的，在大多数情况下，添加稀疏列要便宜得多。[](https://stackoverflow.com/a/7383198/939860)

 *****为其他列创建单独的 1:1 表**是否是一个好主意，很大程度上取决于用例。它通常更昂贵。对于初学者，每行有 28 个字节的开销（堆元组头加上项目标识符），每个表还有一些额外的开销。`JOIN`查询中的行也比一块读取它们要昂贵得多。并且您需要在其上添加一个主/外键列和一个索引。如果您在大多数查询中不需要额外的列，那么拆分可能是一个好主意。大多数情况下，这是一个坏主意。

在 PostgreSQL 中添加列很快。**更新**列中的值可能很昂贵，因为每个都会`UPDATE`写入一个新行（由于[MVCC](https://www.postgresql.org/docs/current/mvcc-intro.html)模型）。因此，一次更新多个列是个好主意。

[手册中的数据库页面布局。](https://www.postgresql.org/docs/current/storage-page-layout.html)

如何计算行大小：

*   [理解 Postgres 行大小](https://stackoverflow.com/questions/13570613/making-sense-of-postgres-row-sizes/13570853#13570853)
*   [在 PostgreSQL 中计算和节省空间](https://stackoverflow.com/questions/2966524/calculating-and-saving-space-in-postgresql/7431468#7431468)***

# javascript - 我的游戏自己玩？

> ID：10020575
> 
> 赞同：0
> 
> 时间：2012-04-04T23:15:16.977
> 
> 标签：javascript, html, canvas

我一直在用 HTML5 制作画布游戏，并且对其中的很多内容都很陌生。我也想单独使用 javascript 来创建我的元素（这种方式更容易嵌入到其他网站中，我觉得它更干净）。我重新加载了游戏以便再次玩，但我希望能够跟踪分数和多个其他变量，而不必将每个变量都放入 URL（我一直在这样做）以使游戏看起来像还在做。我还将添加“power ups”和其他需要被脚本“记住”的东西。

无论如何，这是我的问题。当一个玩家杀死另一个玩家时，游戏会自行运行一段时间，让我的电脑变得非常慢，直到我重新加载页面。为什么要这样做？我清除了主要功能的间隔（循环游戏并保持一切运行），这曾经使一切停止移动 - 它不再如此。这里有什么问题？

这是我的游戏：[http ://dl.dropbox.com/u/11168436/game/game.html](http://dl.dropbox.com/u/11168436/game/game.html)

控制：用箭头键移动滑雪者并用 M 射击（你朝你上次移动的方向射击）。滑雪板用 ESDF 移动并用 Q 射击。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T01:47:51.597

好的，这就是基本上发生的事情，可变区间存在于不同的范围内。所以你试图清除一个间隔..但它不是正确的范围，所以 var`interval`真的从来没有被清除过（你也使用了不正确的语法来清除一个间隔）。

**[工作演示](http://jsfiddle.net/rGQDr/1/)**

您应该了解有关[函数范围](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope)的更多信息。你有`var interval`几个不同的地方，一个是全局的，一个是本地的。这将创建两个名为间隔的单独变量。这是一个简单的例子，

```
var a = 10;
function(){
    var a = 1;
    console.log(a);
   // a will equal 1

}

console.log(a);
// a will equal 10 
```

无论如何，我为修复它所做的事情被声明为一个全局变量，`interval`并且该变量是现在唯一用于清除 ect 的变量。

我看到的下一个问题是你正在使用

`interval = window.clearInterval(interval)`

你只需要打电话

`window.clearInterval(interval)`

这是一个很好的第一次尝试，只是继续学习:)。希望您了解我在工作示例中所做的工作。只需将其与您的代码进行比较，只有一些细微的差异都与您的变量范围有关`interval`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:23:26.687

这些行可能是罪魁祸首：

`var interval = window.setInterval(main, 1);`

把那个间隔说出来，`30`你的问题应该会消失。

# ruby-on-rails - Rails：使用 ruby -gmail gem 会导致问题

> ID：10020584
> 
> 赞同：0
> 
> 时间：2012-04-04T23:16:23.727
> 
> 标签：ruby-on-rails, ruby, gem, gmail, gemfile

我有以下简单的代码，它在 ruby​​（不是 rails）应用程序中工作：

```
require 'gmail'

Gmail.new('my_account', 'my_password') do |gmail|
end 
```

我能够连接到 Gmail 帐户并在那里做一些事情。

但是，我想在 Rails 应用程序中使用这个 Gem，因此我尝试将以下内容添加到 Gemfile 中：

```
gem "ruby-gmail",         "0.2.1"
gem "mime",               "0.1" 
```

但是，当我尝试在 rake 任务中使用它时，如下所示：

```
task :scrap_receipts_gmail => :environment do
  Gmail.new('my_account', 'my_password') do |gmail|
    puts gmail.inspect
  end
end 
```

我收到以下错误：

> 未初始化的常量 Object::Gmail

如果我添加`require 'gmail'`. 我的问题是：

`require gmail`如果我已经在 Gemfile 中指定了，我为什么要这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:45:54.223

模块/类命名空间必须与目录结构相匹配。例如，in `lib/foo/bar.rb`，当且仅当命名空间是`Foo::Bar`Rails 才能自动加载它，否则您必须显式地要求它。

在这种情况下，Gmail 被定义为一个与目录结构不匹配的类。如果 Gmail 被定义为一个模块（命名空间`::Gmail`匹配目录结构），那么您将永远不需要显式`require "gmail"`.

# c# - 从代码执行 Windows Server 2003 和 ii6 中的进程 - 权限错误

> ID：10020587
> 
> 赞同：0
> 
> 时间：2012-04-04T23:17:07.937
> 
> 标签：c#, process, permissions, iis-6, windows-server-2003

我在从我们的测试服务器执行进程时遇到问题。在使用 Windows XP 和 iis5.1 的本地主机上，我将 machine.config 文件更改为具有以下行 -

然后我将 iis 的登录名更改为以本地系统帐户登录并允许服务器与桌面交互。这解决了我从 xp 中的代码执行进程的问题。

在 windows server 2003 上使用相同的方法（使用 iis6 隔离模式）时，不会执行该进程。

这是执行该过程的代码（我已经通过命令行测试了 iecapt 的输入并生成了图像） -

```
 public static void GenerateImageToDisk(string ieCaptPath, string url, string path, int delay)
    {
        url = FixUrl(url);
        ieCaptPath = FixPath(ieCaptPath);
        string arguments = @"--url=""{0}"" --out=""{1}"" --min-width=0 --delay={2}";
        arguments = string.Format(arguments, url, path, delay);
        ProcessStartInfo ieCaptProcessStartInfo = new ProcessStartInfo(ieCaptPath + "IECapt.exe");
        ieCaptProcessStartInfo.RedirectStandardOutput = true;
        ieCaptProcessStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        ieCaptProcessStartInfo.UseShellExecute = false;
        ieCaptProcessStartInfo.Arguments = arguments;
        ieCaptProcessStartInfo.WorkingDirectory = ieCaptPath;
        Process ieCaptProcess = Process.Start(ieCaptProcessStartInfo);
        ieCaptProcess.WaitForExit(600000);
        ieCaptProcess.Close();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:25:12.757

默认情况下，IIS 用户帐户具有拒绝权限。尝试将其关闭，并确保您对运行 IIS 应用程序池的帐户具有写入权限。我相信这是网络服务帐户。

# python - 如何描述 Python 对象，属性、身份、类型和值之间的关系是什么？

> ID：10020589
> 
> 赞同：1
> 
> 时间：2012-04-04T23:17:18.080
> 
> 标签：python, object, attributes, python-3.x

（关于 Python 3.2）

我试图按照以下方式发表声明：

> 在 Python 中，对象是...

根据文档（[http://docs.python.org/py3k/reference/datamodel.html#objects-values-and-types](http://docs.python.org/py3k/reference/datamodel.html#objects-values-and-types)）：

> 每个对象都有一个标识、一个类型和一个值

但是属性在哪里呢？如果我做了`a = 3; print(a.__class__)`我得到的事情，`<class 'int'>` 我假设这是对象`a`引用的类型，这意味着“类型”是对象的“属性”。所以从这个意义上说，我们可以说一个对象拥有的一组足够的“事物”将是它的身份、价值和属性。但是，查看 using 的属性`dir(a)`，我看不到任何类似身份的东西（即使我知道该`id()`函数会告诉我该信息）。

所以我的问题是，以下任何最小语句是否足以描述 Python 对象的概念？

> 1.  在 Python 中，对象具有属性，其中始终包含标识、类型和值。
>     
>     
> 2.  在 Python 中，对象具有标识和属性，其中始终包括其类型和值。
>     
>     
> 3.  在 Python 中，对象具有标识、值和属性，其中始终包括其类型等。

如果不是，有人可以给我一个传达对象的关系属性、身份、类型和值的定义吗？

（我希望数字 1 是真的。：P）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T01:34:41.400

虽然您可以通过属性访问对象的类型，但它的类型不仅仅是一个属性——该类型定义了对象在没有任何属性之前是如何创建的。仅凭这一事实，这些陈述都不足以描述 Python 对象。

我会这样说：

> 在 Python 中，一切都是对象。
> 
> 对象是一个信息块，它有一个类型，它定义了它的创建以及它如何与其他对象交互，一个标识，它将它与所有其他对象区分开来，以及一个值，它是块中的信息。属性是与给定对象关联的其他对象，包括作为其类型的对象。

然后，您应该给出一些人们可能不希望成为对象的事物的示例，例如函数。

可以在[Dive Into Python](http://www.diveintopython.net/getting_to_know_python/everything_is_an_object.html)中找到关于“什么是对象”的段落：

> Python 中的一切都是对象，几乎所有东西都有属性和方法。所有函数都有一个内置属性`__doc__`，它返回函数源代码中定义的文档字符串。`sys`模块是一个对象，它具有（除其他外）一个名为`path`. 等等。
> 
> 不过，这引出了一个问题。什么是对象？不同的编程语言以不同的方式定义“对象”。在某些情况下，这意味着所有对象都必须具有属性和方法；在其他情况下，这意味着所有对象都是可子类化的。在 Python 中，定义比较宽松；有些对象既没有属性也没有方法（第 3 章会详细介绍），而且并非所有对象都是可子类化的（第 5 章会详细介绍）。但从某种意义上说，一切都是对象，它可以分配给变量或作为参数传递给函数（第 4 章会详细介绍）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:14:21.293

> 但是属性在哪里呢？

（某种组合）特定对象的属性*记录并确定*其值。

值、类型和身份这三个都是抽象概念，只能通过示例才能真正理解。考虑：

```
>>> a = (1, 2)
>>> b = (1, 2)
>>> c = a
>>> d = (3, 4)
>>> e = 2 
```

你无疑明白`a`,`b`和`c`都是相等的，但只有 a 和 c 是*同一个对象*。即三者都具有相同的值，并且a和c具有相同的标识。`d`是与（元组）相同类型的对象`a`，但具有不同的值；e 是完全不同的类型（int）。的值`e`对于人类来说很容易理解（因为 int 字面量是用众所周知的符号拼写的），但 Python 会跟踪它的几个属性：

```
>>> e.numerator
2
>>> e.denominator
1
>>> e.real
2
>>> e.imag
0 
```

这些共同决定了值 - 尽管是`int`，但可以保证分母为 1，虚部为 0（实际上，所有内置[Rational](http://docs.python.org/py3k/library/numbers.html#numbers.Rational)的虚部都为零）。所以，an 的值`int`就是它的分子。

但是“价值”是抽象的东西——它对人类来说是有意义的，计算机必须把它提炼一点。与 type 类似——“这是什么类型的东西？” 是人类直接理解的东西；计算机没有，但 Python 使用类来实现它——因此，

```
>>> type('')
<class 'str'>
>>> type(2)
<class 'int'> 
```

你问“这是什么类型的东西？”，它给了你它的类。类型存储为属性，但这只是因为 Python 将对象的类型视为其值的（潜在）一部分。身份不是值的一部分（尽管在某些情况下，它们可以是等价的），因此它没有记录在属性中 - 它存储在内部机制中，当你说 . 时，它可以让 Python 找到你想要的对象`a`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T23:35:56.970

我认为你把你的术语弄混了。

## 身份

对象的身份只是一个值，它在其生命周期内唯一标识该对象。因此，`id(1)`保证与 不同`id(2)`。

## 类型

对象的类型可以告诉您更多信息；它告诉您可以对该对象使用哪些操作，以及可以在该对象中存储哪些可能的值。有两种类型：内置的和用户定义的。内置类型是`int`,`string`等。用户定义是您自己定义的类。

## 价值

这是存储在类型中的内容。

## 属性

这些是您可以从现有对象中获取的附加变量。

## 例子：

```
>>> s = "foo" # s is a new variable
>>> id(s) # it has a unique identifier
4299579536
>>> type(s) # it has a type ("str")
<type 'str'>
>>> s # it has a value ("foo")
'foo'
>>> s.__class__ # it has an attribute called __class__ that has the following value:
<type 'str'> 
```

所以你的所有三个陈述都可能是正确的，但＃3对我来说听起来“最正确”。我也听说过

```
In Python, an object is a dict. 
```

这对我来说很有意义，但可能对每个人都没有意义。

# python - 如何重新采样具有应用于每列的不同函数的数据框？

> ID：10020591
> 
> 赞同：43
> 
> 时间：2012-04-04T23:17:23.453
> 
> 标签：python, numpy, time-series, pandas

我有一个熊猫的温度和辐射时间序列`dataframe`。时间分辨率为 1 分钟，以常规步长为单位。

```
import datetime
import pandas as pd
import numpy as np

date_times = pd.date_range(datetime.datetime(2012, 4, 5, 8, 0),
                           datetime.datetime(2012, 4, 5, 12, 0),
                           freq='1min')
tamb = np.random.sample(date_times.size) * 10.0
radiation = np.random.sample(date_times.size) * 10.0
frame = pd.DataFrame(data={'tamb': tamb, 'radiation': radiation},
                     index=date_times)
frame
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 241 entries, 2012-04-05 08:00:00 to 2012-04-05 12:00:00
Freq: T
Data columns:
radiation    241  non-null values
tamb         241  non-null values
dtypes: float64(2) 
```

如何将其下采样`dataframe`到一小时的分辨率，计算温度的每小时**平均值**和辐射的每小时**总和？**

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-07-22T19:13:55.277

在 pandas 0.18 中，重采样 API 发生了变化（请参阅[文档](http://pandas.pydata.org/pandas-docs/version/0.18.0/whatsnew.html#resample-api)）。所以对于 pandas >= 0.18 的答案是：

```
In [31]: frame.resample('1H').agg({'radiation': np.sum, 'tamb': np.mean})
Out[31]: 
                         tamb   radiation
2012-04-05 08:00:00  5.161235  279.507182
2012-04-05 09:00:00  4.968145  290.941073
2012-04-05 10:00:00  4.478531  317.678285
2012-04-05 11:00:00  4.706206  335.258633
2012-04-05 12:00:00  2.457873    8.655838 
```

* * *

老答案：

我正在回答我的问题以反映与时间序列相关的变化`pandas >= 0.8`（所有其他答案都已过时）。

使用 pandas >= 0.8 的答案是：

```
In [30]: frame.resample('1H', how={'radiation': np.sum, 'tamb': np.mean})
Out[30]: 
                         tamb   radiation
2012-04-05 08:00:00  5.161235  279.507182
2012-04-05 09:00:00  4.968145  290.941073
2012-04-05 10:00:00  4.478531  317.678285
2012-04-05 11:00:00  4.706206  335.258633
2012-04-05 12:00:00  2.457873    8.655838 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T01:45:17.900

您还可以使用[objects](http://pandas.sourceforge.net/timeseries.html#up-and-downsampling)`asof`的方法进行下采样。[`pandas.DateRange`](http://pandas.sourceforge.net/timeseries.html#up-and-downsampling)

```
In [21]: hourly = pd.DateRange(datetime.datetime(2012, 4, 5, 8, 0),
...                          datetime.datetime(2012, 4, 5, 12, 0),
...                          offset=pd.datetools.Hour())

In [22]: frame.groupby(hourly.asof).size()
Out[22]: 
key_0
2012-04-05 08:00:00    60
2012-04-05 09:00:00    60
2012-04-05 10:00:00    60
2012-04-05 11:00:00    60
2012-04-05 12:00:00    1
In [23]: frame.groupby(hourly.asof).agg({'radiation': np.sum, 'tamb': np.mean})
Out[23]: 
                     radiation  tamb 
key_0                                
2012-04-05 08:00:00  271.54     4.491
2012-04-05 09:00:00  266.18     5.253
2012-04-05 10:00:00  292.35     4.959
2012-04-05 11:00:00  283.00     5.489
2012-04-05 12:00:00  0.5414     9.532 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-07T20:34:43.157

为了吸引您，在 pandas 0.8.0（在`timeseries`GitHub 上的分支中进行大量开发）中，您将能够：

```
In [5]: frame.convert('1h', how='mean')
Out[5]: 
                     radiation      tamb
2012-04-05 08:00:00   7.840989  8.446109
2012-04-05 09:00:00   4.898935  5.459221
2012-04-05 10:00:00   5.227741  4.660849
2012-04-05 11:00:00   4.689270  5.321398
2012-04-05 12:00:00   4.956994  5.093980 
```

上述方法是当前生产版 pandas 的正确策略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T01:11:14.483

您需要这样使用`groupby`：

```
grouped = frame.groupby(lambda x: x.hour)
grouped.agg({'radiation': np.sum, 'tamb': np.mean})
# Same as: grouped.agg({'radiation': 'sum', 'tamb': 'mean'}) 
```

输出为：

```
 radiation      tamb
key_0                      
8      298.581107  4.883806
9      311.176148  4.983705
10     315.531527  5.343057
11     288.013876  6.022002
12       5.527616  8.507670 
```

所以本质上我是拆分小时值，然后计算平均值`tamb`和总和`radiation`并返回`DataFrame`（类似于 R's 的方法`ddply`）。有关更多信息，我将查看[groupby](http://pandas.sourceforge.net/groupby.html)的文档页面以及[此](http://wesmckinney.com/blog/?p=125)博客文章。

**编辑：**为了使这个比例更好一点，你可以在日期和时间上分组：

```
grouped = frame.groupby(lambda x: (x.day, x.hour))
grouped.agg({'radiation': 'sum', 'tamb': 'mean'})
          radiation      tamb
key_0                        
(5, 8)   298.581107  4.883806
(5, 9)   311.176148  4.983705
(5, 10)  315.531527  5.343057
(5, 11)  288.013876  6.022002
(5, 12)    5.527616  8.507670 
```

# ruby-on-rails - RoR 应用程序中未定义的方法“simple_form_for”

> ID：10020593
> 
> 赞同：29
> 
> 时间：2012-04-04T23:17:25.667
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我一直在浏览堆栈溢出，我注意到很多人使用 simple_form 来让他们的生活更轻松。

我想试一试，所以我将 gem 添加到我的 gem 文件 ( `gem 'simple_form'`) 中并发送：

```
rails generate simple_form:install --bootstrap 
```

阅读安装消息后，我使用自述文件中的示例代码创建了一个视图：

```
<%= simple_form_for @user do |f| %>
  <%= f.input :username %>
  <%= f.input :password %>
  <%= f.button :submit %>
<% end %> 
```

不幸的是，我一尝试加载页面就收到此错误：

```
undefined method `simple_form_for' for #<#<Class:0x69dd688>:0x6903ac8> 
```

是什么赋予了？怎么连方法都认不出来？我觉得我在这里很简单地错过了一些东西。可能是因为我使用的是 bootstrap-sass 吗？我需要在我的用户控制器中包含一个助手吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-04-11T03:16:50.093

你重启你的服务器了吗？请始终记住，在安装 gem 或插件之后。总是重启你的服务器

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-13T12:53:42.593

这完全是因为您在安装了 simple_form、devise 等新库后没有重新启动服务器。

尝试停止您的服务器并重新启动它。你的代码是完美的！我遇到过几次。解决方案只是重新启动服务器！。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-07-14T05:22:25.880

安装`simple_form`gem 后必须重新启动服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-09T06:55:39.353

对于任何绝对的初学者。如果您忘记安装，就会出现此错误`simple_form`。要纠正，请将其添加到您的 Gemfile

```
gem 'simple_form' 
```

和`bundle install`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-09T09:19:22.197

总结上面的所有可能性，希望这个列表对其他宝石也有用。

1.  检查`simple_form`gem 是否安装正确

    `Gemfile`在和中找到宝石`Gemfile.lock`。另一种方法是在终端中运行此命令：`bundle list | grep simple_form`

2.  如果输出为空

    可能`simple_form`尚未安装在您的项目中。由于 gem 是一个外部 gem，它不包含在 Rails 框架中。Rails 有自己的表单库（又名`form_with`和`form_for`）。

    要添加`simple_form`到您的项目中，请打开 Gemfile 并添加`gem 'simple_form'`，然后在终端中运行命令`bundle install`。

3.  如果输出不为空

    检查您是否已经重新启动服务器。

4.  重启服务器后，仍然无法访问`SimpleForm`常量

    检查 gem 是否`require: false`在 Gemfile 中设置为。如果是这样，请删除此部分并运行`bundle install`.

5.  `rails console`您可以通过键入或`rails c`在终端中检查 gem 是否从 rails 控制台加载。

    加载控制台后，键入`SimpleForm`并按 Enter。如果出现一些抱怨常量未定义的错误，请参阅前面的步骤来修复。

# git - 我可以将一个 git 存储库提交日志复制到没有历史记录的（几乎）相同的存储库吗？

> ID：10020594
> 
> 赞同：2
> 
> 时间：2012-04-04T23:17:27.227
> 
> 标签：git

我目前正在修改一个大型电子商务平台

在项目开始之前已经进行了大量的初步开发，并且没有任何版本控制，所以我没有文件历史记录。

为了构建之前完成的所有工作的图景，我从干净安装平台开始，并在 git 版本控制下一点一点地合并所有之前的更改。

我现在有两个几乎相同的软件副本，一个是工作开发服务器，另一个是我的本地存储库，其中包含更改历史记录。

我想将 repo 克隆到服务器上的工作副本上，而不会破坏已经存在的内容。

我不喜欢擦除开发服务器并克隆我的本地存储库的想法。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:15:47.553

您可以转到开发服务器并运行`git init`以将那里的根目录转换为 git repo。此时，您可以将您的更改推送到它（或者让它从其他地方拉出，这可能是更好的路线），这将使它能够访问您构建的历史记录。假设此时历史记录在 中`origin/master`，您现在可以执行类似基于此历史记录`git branch master origin/master`创建分支的操作​​。`master`最后，您可以在不修改工作副本的情况下`git reset master`运行`HEAD`您的新副本。`master`

此时，由于您说它们几乎相同，因此您的开发服务器现在应该在 git 之上运行，未提交的更改表示开发服务器的版本和新构建的版本之间的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:16:22.957

你可以将 repo 克隆成一个空的。

```
git clone --bare /path/to/repo.git 
```

这将创建一个名为“repo.git”的存储库，它是一个裸存储库文件夹。您可以将此文件夹复制到 /path/to/devserver/，例如

```
mv repo.git /path/to/devserver/.git 
```

现在您在同一个地方拥有存储库和 devserver 文件。如果您键入 git status 您将看到一些文件已更改等。如果您按原样暂存所有内容并提交它，您将拥有旧的历史记录 + 一个提交，这是您的原始存储库和当前开发服务器代码之间的差异.

# javascript - 选择没有 .Class 或 #Id 的 div

> ID：10020596
> 
> 赞同：4
> 
> 时间：2012-04-04T23:17:37.837
> 
> 标签：javascript, jquery

出于某种原因，如果可以选择与一组特定的相似样式属性匹配的所有 div，对我来说会容易得多。

**我要选择的 div 示例**

```
<div style="background-image: url(http://localhost/website/images/template/markers/cluster.png); height: 34px; line-height: 34px; width: 34px; text-align: center; cursor: pointer; color: rgb(255, 255, 255); position: absolute; font-size: 12px; font-family: Arial, sans-serif; font-weight: bold; top: 78.15521871251985px; left: 725.3256078213453px; background-position: 0px 0px; ">15</div> 
```

除了这个 div 之外，其他需要选择的 div 可以与这个类似，但`height`位置不同`top` `left`。然而，好消息是`background-image url()`保持不变。

如何使用 jQuery 进行选择？谢谢 ！！

## 编辑

**环绕代码** *更容易提供屏幕截图*

![在此处输入图像描述](../Images/c37b6531ca39d386c2baa3b856a1fc3b.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T23:19:57.610

**我认为这不是一个好主意，但您可以通过特定的****内联**样式选择元素：

```
$('div[style*="height: 34px"]') 
```

[例子](http://jsbin.com/etuyom/edit#javascript,html,live)

# lua - 在 Lua 中，我如何知道一个表是否包含一个类函数？

> ID：10020605
> 
> 赞同：2
> 
> 时间：2012-04-04T23:19:20.773
> 
> 标签：lua

假设我使用 : 运算符声明了一个 lua 函数，如下所示：

```
function ClassName:myFunc( stuff )
    --do stuff
end 
```

然后说我将该函数存储在一个表中，如下所示：

```
someTable = {
    ClassName.myFunc,
    someGlobalFunc,
} 
```

然后，假设我有另一个函数通过表并尝试调用给定函数。

```
function ClassName:callStuffInThisTable(table)
    -- I go through the table, which might be someTable above, and call all the functions
end 
```

我的问题是，我如何知道表中的函数是否由 ClassName 拥有，以便我可以使用 self 调用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T23:36:23.997

你没有。至少，Lua 不会告诉你。

`function ClassName:myFunc( stuff )`就 Lua 而言，它只是语法糖。这和这个没有什么不同：`ClassName.myFunc = function (self, stuff)`。功能是等价的。同样对于 : 调用语法，`ClassName:myFunc(stuff)`在语义上等价于`ClassName.myFunc(ClassName, stuff)`.

由*您*决定您的功能是什么以及它们的作用。这需要编码纪律。如果您有一个需要在循环中调用的函数列表，那么它们应该被设计为使用*相同*的参数调用。

有两种方法可以做到这一点。一种方法是使所有函数成为“类函数”：

```
someTable = {
    ClassName.myFunc,
    function(self, ...) return someGlobalFunc(...) end,
} 
```

这样，`self`参数将被忽略。显然，您可以创建一个特殊的函数表对象，该对象具有将“全局”函数插入到将自动生成包装器的表中的函数：

```
function insertFuncIntoTable(self, func)
  self[#self + 1] = function(self, ...) func(...) end
end

insertFuncIntoTable(someTable, someGlobalFunc) 
```

注意：这些之间存在差异，假设“someGlobalFunc”实际上是全局表的成员（而不是 a `local`）。此版本将采用`_G["someGlobalFunc"]` *当前*具有的值，就像您的原始代码一样。但是，第一个版本采用它*在调用时*的值，这可能与`someTable`创建时的函数不同。

所以这个版本更安全。

或者，您可以使表中的任何“类函数”显式绑定到对象实例：

```
someTable = {
    function(self, ...) ClassName.myFunc() end,
    function(self, ...) return someGlobalFunc(...) end,
} 
```

顺便说一句，一般来说，如果你使用`:`语法声明一个函数，你应该以这种方式*使用*该函数，通过`instance:myFunc(...)`. 显然它只是一个 Lua 函数，和其他函数一样，所以你可以做你喜欢的事。但是滥用会使理解发生的事情变得更加困难。

Lua 为您提供了强大的功能。但是你仍然需要在编码时进行判断和纪律。Lua 不会（完全）把你从你自己手中拯救出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:16:56.530

判断函数是否为 ClassName“拥有”的一种方法是扫描和检查。

```
ClassName = {}
function ClassName:fn(self) ... end

t = { function() ... end , ClassName.fn() }

function has_value( klass, value )
  for k,v in pairs(klass) do
    if v==value then return true
  end
  return false

function ClassName:callStuffInThisTable(table)
  for k,v in pairs(table) do
    if has_value(ClassName, v) then
      v(self)
    else
      v()
    end
  end
end 
```

由于表扫描，这具有 O(n^2) 行为。我们可以通过使用 ClassName 中的函数作为新表将其减少到 O(n log(n)) )

```
function ClassName:callStuffInThisTable(table)
  local t = {}
  for k,v in pairs(ClassName) do
    t[v] = 1
  end

  for k,v in pairs(table) do
    if t[v]==1 then
      v(self)
    else
      v()
    end
  end
end 
```

# android - 在 Android 中使用 StringEntity 发送 POST 请求？

> ID：10020608
> 
> 赞同：0
> 
> 时间：2012-04-04T23:19:36.753
> 
> 标签：android, parsing, http-post

我在 2 个程序中使用完全相同的代码，除了存储 POST 数据。在第一种方法（有效的方法）中，我使用 NameValuePair，在另一种方法中，我使用 StringEntity（不起作用，但我也不使用任何编码）。我不使用编码的原因是因为它完全弄乱了我的字符串。不过，带有 StringEntity 的代码将不起作用......这是代码：

```
public static String sendNamePostRequest(String urlString, String nameField) {

    HttpClient client = new DefaultHttpClient();

    HttpPost post = new HttpPost(urlString);

    StringBuffer sb = new StringBuffer();

    try {

        post.setEntity(new StringEntity(
                "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE3NDM5MzMwMzRkZA%3D%3D&__EVENTVALIDATION=%2FwEWBAL%2B%2B4CfBgK52%2BLYCQK1gpH7BAL0w%2FPHAQ%3D%3D&_nameTextBox=John&_zoekButton=Zoek&numberOfLettersField=3"));

        HttpResponse response = client.execute(post);
        HttpEntity entity = response.getEntity();

        BufferedReader br = new BufferedReader(new InputStreamReader(
                entity.getContent()));
        String in = "";

        while ((in = br.readLine()) != null) {
            sb.append(in + "\n");
        }

        br.close();

    } catch (Exception e) {
        e.printStackTrace();
    }

    return sb.toString();
} 
```

此代码确实发送了请求（用wireshark 嗅探以检查），但不返回适当的HTML 数据。这可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:55:08.087

而不是使用：

```
HttpResponse response = client.execute(post);
HttpEntity entity = response.getEntity();

BufferedReader br = new BufferedReader(new InputStreamReader(
                entity.getContent())); 
```

删除`HttpEntity entity = response.getEntity();`并执行以下操作：

```
HttpResponse response = client.execute(post);
BufferedReader br = new BufferedReader(new InputStreamReader(
                response.getEntity().getContent(), "UTF-8")); 
```

对于 NameValuePair，请查看[此链接](http://www.androidsnippets.com/executing-a-http-post-request-with-httpclient)

# scala - scalatra 过滤器行为的变化

> ID：10020611
> 
> 赞同：1
> 
> 时间：2012-04-04T23:20:06.850
> 
> 标签：scala, scalatra

我的应用程序中有多个过滤器，其中一个位于根目录。

```
<filter>
    <filter-name>root</filter-name>
    <filter-class>
        my.own.classpath.RootFilter
    </filter-class>
</filter>

<filter>
    <filter-name>root</filter-name>
    <filter-class>
        my.own.classpath.SubFilter
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>root</filter-name>
    <url-pattern>/</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>sub</filter-name>
    <url-pattern>/sub/*</url-pattern>
</filter-mapping> 
```

在 Scalatra 2.0.0 中这很好用。如果`RootFilter`(which extends `ScalatraFilter`) 有一个 url 的绑定，它会处理它，否则它会传递给其他过滤器。但是，在更高版本的 Scalatra 中，它的工作方式不同。当我提供由 处理的 url 时`SubFilter`，仍会调用正确的过滤器，但不会显示结果文本。而是返回一个空白页面（没有 HTML）。

这是Scalatra中的错误，还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T15:56:34.653

我不确定，Scalatra 并没有以 Java 的速度发展，所以事情发生了变化。

这是 Scalatra Book v2.0 关于 ScalatraServlet 与 ScalatraFilter 的一个片段；这里可能有一些关于问题所在的线索，特别是关于 Not Found 和 ScalatraFilter 委托给链中的下一个过滤器（在你的情况下，在 sub 之后没有下一个过滤器）

> 主要区别在于找不到路由时的默认行为。ScalatraFilter 将委托给链中的下一个过滤器或 servlet（由 web.xml 配置），而 ScalatraServlet 将返回 404 响应。
> 
> 另一个区别是 ScalatraFilter 匹配相对于 WAR 上下文路径的路由。ScalatraServlet 匹配相对于 servlet 路径的路由。这允许您在同一个 WAR 的不同名称空间下挂载多个 servlet。
> 
> 在以下情况下使用 ScalatraFilter：
> 
> ```
> You are migrating a legacy application inside the same URL space
> You want to serve static content from the WAR rather than a dedicated web server 
> ```
> 
> 在以下情况下使用 ScalatraServlet：
> 
> ```
> You want to match routes with a prefix deeper than the context path. 
> ```

# mysql - MySQL 分页和返回总计

> ID：10020615
> 
> 赞同：0
> 
> 时间：2012-04-04T23:20:43.087
> 
> 标签：mysql, paging

我到处搜索，但在 MySQL 中找不到一个简单的分页示例，它也返回该特定查询的总行数。在 SQL Server 中有很多方法可以做到这一点，但没有 MySQL 的示例。有没有人有这种存储过程，它接受页面、页面大小、排序依据和排序方向参数，并返回该页面排序的行数，以及该查询中的总结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:27:29.040

你检查过`SQL_CALC_FOUND_ROWS`吗`FOUND_ROWS()`？

[http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

# css - 无法正确浮动 div

> ID：10020617
> 
> 赞同：0
> 
> 时间：2012-04-04T23:21:06.173
> 
> 标签：css, html, css-float

我的 div 正在显示楼梯效果，如下所示。通常在您可以使用的表格中`vertical-align: top`，不知道如何为 div 执行此操作。

```
 ____1_____     
            _____2_____      
                        ______3_____ 
```

到目前为止，我拥有的 CSS 是：

```
 .areadiv
{
float:left;
display: inline-block;
height:auto;
margin:0 auto; 
width:130px;
padding:5px;
} 
```

HTML 是：

```
<div>
<div class="areadiv">
content
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:04:23.570

好的，首先包含的 div 的宽度必须设置为 = 或 >，而不是浮动的组合宽度，这就是它知道移动到下一行的方式。

例如..

```
.areadiv 
{
    display: inline-block;
    vertical-align: top;
    width: 130px;
    padding: 5px;
}

.containerdiv 
{
    width: 421px; /* ( 130 + 10 ) x 3 + 1 just in case */
} 
```

和 HTML：

```
<div class="containerdiv">
    <div class="areadiv">
    </div>
    <div class="areadiv">
    </div>
    <div class="areadiv">
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:48:02.097

我和@bartolsthoorn 一起说你的CSS 很混乱。但我不会使用 float 我只会使用`display: inline-block`. 当您使用时，`inline-block`您必须记住设置`vertical-align`以及大多数（所有？）浏览器默认设置为`middle`：

```
.areadiv {
    display: inline-block;
    vertical-align: top;
    width: 130px;
    padding: 5px;
} 
```

这就是你所需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:31:30.310

您的 CSS 对于您要实现的布局没有太大意义，它应该是：

```
.areadiv {
  float: left;
  display: block;
  width: 130px;
  padding: 5px;
} 
```

用于使`margin: 0 auto;`容器 div 居中，您不需要内联块。

# algorithm - 跨多个重叠动态区间绘制值的总和

> ID：10020619
> 
> 赞同：0
> 
> 时间：2012-04-04T23:21:48.427
> 
> 标签：algorithm

我有一个区间数组 [a,b]（其中 [a,b] = 所有 x 的集合，使得 a<=x<=b）。这些间隔中的每一个都有一个与之关联的值（将其视为跨该间隔的某物的成本）。间隔可以重叠。间隔是动态的（可以添加、删除、转换它们，并且可以更改它们的大小）。此外，与任何此类间隔相关的值可能会发生变化。

我需要创建一个图表，其中包含跨区间 [start, end] 的所有此类值的总和，该区间被定义为包含所有此类区间的区间。为了做到这一点，我需要一个有序列表，列出这些值在哪里发生变化，以及它们在哪些值之间变化。当原始数组中的间隔发生变化时，需要轻松/快速地更新此类列表。

旁注：假设间隔不是很大（数百个？）。

有关有效执行此操作的数据结构/算法的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T11:42:10.940

[区间树](http://en.wikipedia.org/wiki/Interval_tree)能够执行这样的操作

# sql-server - 在同一台服务器上执行触发器和存储过程所需的 MS DTC

> ID：10020623
> 
> 赞同：0
> 
> 时间：2012-04-04T23:21:59.730
> 
> 标签：sql-server, sql-server-2005, stored-procedures

当使用同一 SQL Server 2005 中的两个数据库集成两个应用程序时会出现此问题。两个应用程序在同一台服务器上都有自己的数据库，但我们必须将一些数据从一个数据库传输到另一个数据库。我们正在使用触发器和存储过程来做到这一点。

如果我们使用 SQL Server Management Studio 将数据插入数据库，则不需要 msdtc，但如果我们使用应用程序插入数据，我们会收到错误消息，指出 DTC 未启用。我们无法控制应用程序插入数据。

简而言之，我的问题是为什么在使用应用程序插入数据时需要 msdtc？

注意：触发器不会在数据库之间进行调用，只有存储过程是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T07:07:26.827

在很多情况下，可能会间接使用 MSDTC：集群服务器、配置复制、COM+ 的大多数用法等等。

但是，正如@MitchWheat 在评论中已经指出的那样，只要您在单个事务范围内有多个数据库连接，SQL Server 2005（以及 Oracle 资源管理器）就会专门使用 MSDTC。此行为已在 SQL Server 2008 中修复（如果您认为它不便）。

就您而言，这是客户端问题，而不是服务器端问题，但通常都可以。

# javascript - 为什么我传递给我的函数的functionToCallOnOk在我通过jQuery附加到回调时没有被调用？

> ID：10020626
> 
> 赞同：0
> 
> 时间：2012-04-04T23:22:07.233
> 
> 标签：javascript, jquery, function-pointers

所以我尝试这样的代码：

```
function showAlertWithCallback(w, h, name, body_text, functionToCallOnOk) {
    prepareWindow();
    var ran_alert_number=Math.random()*50000;
    $("#alert_content").html(body_text + '<br/>' + '<input type=\"button\" class=\"eButton\" value=\"Cancel\" onClick=$(\".alert\").hide() />' + '<input id=\"general-alert-'+ ran_alert_number +'\" type=\"button\" class=\"eButton\" value=\"OK\" onClick=\"$(\'.alert\').hide();\"/>');
$('#general-alert-' + ran_alert_number).click(functionToCallOnOk);  
 // also tried $('#general-alert-' + ran_alert_number).click(function(){functionToCallOnOk();});
    showAlertBase(w, h, name);
} 
```

通过以下方式调用：

```
showAlertWithCallback(
       600, 
       100 , 
       ('New name for to ' + file_title + ' file.'),
       '<input type="text" style="width:590px" class="text" value=\"' + file_title + '\">', 
       function(){
         alert("hi!");
       }
    ); 
```

运行时没有错误（chrome 调试器），但单击 OK 时未调用函数。为什么以及如何解决这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:27:27.723

`Math.random()*50000`会产生一个像 38518.060150090605 这样的数字，当你`'#general-alert-'`在 jQuery 调用中连接时会产生一个像这样的选择器：

```
#general-alert-38518.060150090605 
```

这将被视为查找具有 id`general-alert-38518`和 class的元素的选择器`060150090605`，因为类名位于点之后。

要生成随机数，请改用，比如说`Math.floor(Math.random()*5000)`。

更好的选择是使用递增的全局变量（例如，`_global_counter++`每次使用它时），那么您将没有机会获得具有相同 id 的两个元素。

更好的解决方案是在 JavaScript 中创建实际的 DOM 元素，将事件附加到这些元素，*然后*将这些元素插入到文档中的正确位置。这样他们就根本不需要ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:27:12.417

尝试删除`onClick`OK 按钮的属性。

# java - 哪个 Java 线程负责 PostgreSQL 数据库进程？

> ID：10020627
> 
> 赞同：2
> 
> 时间：2012-04-04T23:22:19.143
> 
> 标签：java, database, linux, postgresql, jdbc

给定一个连接到 PostgreSQL 数据库（在 Linux 上）的 JVM，有没有办法找出 Java 中的哪个线程负责数据库中的一个进程？

注意：我正在调试一个资源泄漏错误，它显示为数据库中的一些空闲事务进程。将这些与负责的线程匹配会很有用，因为线程名称将缩小搜索范围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T00:40:51.347

一个有用的技巧是向 Java 进程发送一个 SIGQUIT 信号，例如

```
kill -QUIT your_process_id 
```

这不会杀死它，但会告诉它打印线程转储。这将列出所有线程，并回溯它们当前正在做什么。不幸的是，这通常不会包含像“conn.setAutoCommit(false)”这样明显的东西，但它会告诉你每个线程在哪里。

然后，您可以在代码中找到这些点并尝试回溯以查看事务开始之前是否有任何与提交/回滚不匹配的点。

编写应用程序时有用的另一件事是有一个创建和控制连接的公共位置（即另一个抽象层！）。当创建连接并将其分配给线程以及在其中一个线程上开始事务时，这将成为放置日志记录语句的好地方。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-04T23:48:57.670

您可以将 application_name（使用`SET`语句）设置为可以与 Java 线程名称匹配的名称。

# objective-c - 这个 Mtd 中 .parent 的目的是什么？

> ID：10020630
> 
> 赞同：0
> 
> 时间：2012-04-04T23:22:50.137
> 
> 标签：objective-c, ios, cocos2d-iphone

我试图弄清楚 .parent 属性在此方法中实现的目的以及通常具有调用此属性的“get [ClassNameHere]”方法的目的。

```
-(HudLayer*) getHud
{
return (HudLayer*)[self.parent.parent.parent getChildByTag:kTagHudLayer];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T04:09:24.890

仅从此处显示的此方法无法了解详细信息。但是 .parent 确实返回了当前 cocos 对象作为子对象所属的 Cocos 父级、精灵或图层。本质上，这段代码建议您有一个子画面或图层，该子画面有更多的孩子和这些孩子的更多孩子，这是一种找出流上游的大父母是谁，然后从该父母那里得到一个新孩子的方法.

就我个人而言，这似乎很草率。我自己永远不会那样编码。难以阅读（如您所见）并且像这样将如此多的父属性串在一起为错误打开了很多空间。如果最重要的父母做它需要做的事情，而不是一个遥远的孙子沿着链条上升，那会更明智。这样做会破坏 MVC 模型，如下所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T01:09:19.400

可能类`HudLayer`有一个`parent`属性指向另一个同类对象，因此有一个`parent` 属性指向另一个 HudLayer 等等，向上爬了三个级别。然后它只是向它发送一条`getChildByTag`消息。

# c++ - 是否有解决数组中无效八进制数字的方法？

> ID：10020634
> 
> 赞同：2
> 
> 时间：2012-04-04T23:23:29.200
> 
> 标签：c++, arrays, compiler-errors, octal

我正在尝试创建一个数组来保存一天中的几个小时，这样我就可以循环遍历它以获得时钟。

我有：

```
int hourArray[24] = {12, 01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12, 01, 02,
                     03, 04, 05, 06, 07, 08, 09, 10, 11}; 
```

我按顺序收到以下数字的错误`08, 09, 08, 09`。

它告诉我：

> 错误：八进制数无效

我以前从未遇到过这种情况，我想知道是否有任何解决方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-04T23:25:43.183

当然：当你不是八进制时不要使用前导 0：

```
int hourArray[24] = {12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 
   1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}; 
```

不要忘记您只是指定数组中的*数字*- 而不是数字的任何特定文本表示。（所以如果你写`012`这相当于写`10`- 你最终会得到相同的*数字*。）如果你想稍后用前导 0 格式化这些数字，那是代码的一个完全不同的方面。

# git - git squash 并保留最后一次提交的时间戳

> ID：10020641
> 
> 赞同：28
> 
> 时间：2012-04-04T23:24:31.890
> 
> 标签：git

考虑我有提交

```
... -- A -- B -- C 
```

如果我`git rebase -i`过去将所有三个提交压缩为一个，我们可以

```
pick A
squash B
squash C 
```

我看到结果提交`A`具有其原始时间戳。如何让它继承提交的时间戳`C`（最后一个）？

我能想到的是`git commit --amend --date=<new_time>`，但是这种方式需要记住`C`squash之前的commit时间戳或来自reflog的时间戳。

我发现最新提交的时间戳更合理，因为它显示了我实际完成提交中的工作的时间。

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T00:35:48.897

没有一种简单的方法可以做到这一点，但有一些选择。这是一个：

```
git commit --amend --date="$(git show -s --pretty=tformat:%ai <sha1-of-C>)" 
```

还有一个：

```
git commit --amend -c <sha1-of-C> 
```

后者将破坏您现有的提交消息，因此您必须重写它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-08T15:00:23.343

`git commit --amend --reset-author`

# javascript - JavaScript 返回方法

> ID：10020643
> 
> 赞同：4
> 
> 时间：2012-04-04T23:24:46.367
> 
> 标签：javascript

我是 javascript 的新手。我不明白为什么函数在下面的例子中返回 T1 对象（不仅仅是字符串'hi'）。

```
 function T1(){
    return 'hi';
 }
 function T(){
    return new T1();
}
T(); 
```

输出：T1

并在以下示例中返回函数

```
 function T1(){
    return function(){ return 'hi'; }
 }
 function T(){
    return new T1();
}
T(); 
```

输出：函数（​​）{返回'嗨'}

为什么第一个示例返回一个对象（不是字符串“hi”，预期会发生什么），而第二个示例返回从第一个函数返回的函数体（不是预期的对象）？

请解释一下这个结果。谢谢）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:26:48.270

`new`关键字。这就是一个对象。

```
 function T1(){
    return 'hi';
 }
 function T(){
    return T1();
}
T(); // 'hi' 
```

JavaScript 对象应该是这样的：

```
 function T1(){
    this.test = function(){
        return 'hi';
    };
 }
 function T(){
    return new T1();
}
var test = T(); // T1 object
test.test(); // 'hi' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T23:27:32.317

运算符返回由`new`运算符创建的对象，除非构造函数返回不同的对象。构造函数的任何非对象返回值都会被忽略，这就是为什么当你返回时`hi`你看不到这个。

[规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)的第 13.2.2 节（*“[[Construct]]”*），由第 11.2.2 节（*“**运算符”*）引用。*`new`*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T23:52:10.970

在您的代码中：

```
> function T1() {
>      return 'hi';
> } 
```

作为构造函数调用的函数将**始终**返回一个对象，它不会返回一个字符串。因此，当简单地作为函数调用时，T1 将返回字符串“hi”，但当作为构造函数调用时，它将返回一个新的 T1 实例。由于该实例没有分配任何属性，而且 T1.prototype 似乎也没有任何属性，因此它与使用 .prototype 创建的对象几乎无法区分`new Object()`。

它将是一个`instanceof T1`并且其构造函数属性将引用 T1。

```
> function T() {
>      return new T1();
> } 
```

按照惯例，只有构造函数以大写字母开头（常量除外，它可能全部大写）。

```
> T(); 
```

T 函数只是返回一个新的 T1 对象，它没有分配给任何东西，因此不能被引用或调用，因此它可以立即用于垃圾回收。它没有特殊的方法或属性。

```
var t = T(); // returns a new T1 instance
t();  // throws an error since t is a plain object, 
      // not a function and so can't be called. 
```

### 编辑

由于问题已更改：

```
function T1() {
     return function(){ return 'hi'; }
} 
```

在这种情况下，当 T1 作为构造函数调用时，return 语句返回一个函数，它是一个 Object（所有函数都是对象），所以返回的就是这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-04T23:34:13.483

该函数在第二个示例中返回，因为您返回了一个匿名函数，因此，您可以在 if 前面`T1()`放置一对括号来执行它：`()`

```
function T1(){ 
    return function(){ return 'hi'; } 
} 
function T(){ 
   return new T1(); 
} 
T()(); // hi
// or
var T2 = T();
T2(); // hi 
```

这不是错误，它是 JS 的一个强大功能。只记得“蜘蛛侠”框架：

> 强大的力量伴随着巨大的责任。

**编辑：**
现在我看到了真正的问题：**为什么第一个示例返回一个对象（不是字符串“hi”，预期会发生什么），第二个返回从第一个函数返回的函数体（不是预期的对象)?**

这对我来说似乎是一个错误，但可能是设计使然，因为可以使用返回的函数和对象，并且很容易执行带有参数的工作区。

# c# - 程序集解析器忽略 PrivateBinPath

> ID：10020645
> 
> 赞同：3
> 
> 时间：2012-04-04T23:25:12.090
> 
> 标签：c#, assemblies

我有一个程序集，我想从 appbase 的子文件夹中加载。我在创建 AppDomain 期间在 PrivateBinPath 中设置了该子文件夹。

问题是我在应用程序库中有同一个 DLL 的另一个版本。从外观上看，解析器首先检测到错误的版本，说存在不匹配并停止。因此，永远不会加载正确的版本（位于子文件夹中）。

我已经通过删除应用程序库中的那些 DLL 对此进行了测试，它解决了这个问题。即使找到错误的版本，有没有办法强制搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:28:50.857

您可以使用`AppDomainSetup.PrivateBinPathProbe`：

```
AppDomainSetup.PrivateBinPathProbe = "x" 
```

**编辑：**只需将其设置为另一个值`null`就足够了，另请参阅此 MSDN 条目：

[http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpathprobe.aspx](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpathprobe.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:29:00.997

您*只想*使用`PrivateBinPath`? 如果是这样，看起来您可以设置[`PrivateBinPathProbe`](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpathprobe.aspx)为任何非空字符串引用：

> 将此属性设置为任何非空字符串值，包括 String.Empty ("")，以从应用程序的搜索路径中排除应用程序目录路径（即 ApplicationBase），并仅在 PrivateBinPath 中搜索程序集。

当然，如果您*确实*想要 include ，那也无济于事`ApplicationBase`，而是使用`PrivateBinPath`in *preference*。

# mysql - 从管理区域添加类别时出现 MySql 错误

> ID：10020648
> 
> 赞同：-1
> 
> 时间：2012-04-04T23:25:32.333
> 
> 标签：mysql, position

MYSQL 错误

> 错误：“on 子句”中的未知列“T1.Field_ID”

询问：

```
SELECT `T2`.`ID`, `T2`.`Key`, `T2`.`Type` 
FROM `fl_listing_relations` AS `T1` 
RIGHT JOIN `fl_listing_fields` AS `T2` ON `T1`.`Field_ID` = `T2`.`ID` 
WHERE `T1`.`Category_ID` = '42' ORDER BY `T1`.`Position` 
```

函数：getAll 类：rlDb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:18:50.827

我猜`Field_ID`表中的字段`fl_listing_relations`不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T05:40:46.773

仔细检查 fl_listing_relations 表，可能缺少 Field_ID

# css - 跨浏览器的字体大小非常不同

> ID：10020650
> 
> 赞同：5
> 
> 时间：2012-04-04T23:25:46.707
> 
> 标签：css, html, fonts, css-reset

**更新**：使用 normalize.css添加了简单的测试示例[http://jsfiddle.net/7UhrW/1/ 。](http://jsfiddle.net/7UhrW/1/)

Chrome/WebKit 和 Firefox 具有不同的渲染引擎，它们以不同的方式渲染字体，尤其是不同尺寸的字体。这并不太令人惊讶，但令人惊讶的是一些差异的大小。

我总是可以将页面上的单个元素调整为更相似，但至少可以这么说，这很乏味。我一直在寻找更系统的解决方案，但许多资源（例如 SO 答案）只是说“使用重置包”。虽然我确信这可以解决许多其他问题，例如填充和间距，但它似乎对字体尺寸没有任何影响。

例如，如果我从[http://html5reset.org/](http://html5reset.org/)获取重置包，我可以显示出相当大的差异（注意检查器中显示的布局尺寸）。[下面的图像实际上比此答案中显示/调整大小的分辨率更高-例如，在 Chrome 中，您可以右键单击并在新选项卡中打开图像。]

```
<h1 style="font-size:64px; background-color: #eee;">Article Header</h1> 
```

![在此处输入图像描述](../Images/76686cd06cd11db713ce76402267e112.png)

使用 Helvetica，Chrome 的高度反而更短。

```
<h1 style="font-size:64px; background-color: #eee; font-family: Helvetica">Article Header</h1> 
```

![在此处输入图像描述](../Images/88be9c089fe61365d2b7b37cbf313860.png)

使用[不同的字体](http://fontzone.net/font-details/MyriadPro-Light/)，Chrome 再次渲染出更高的字体，但另外字母间距变得混乱（可能是由于字体的粗体）：

```
<style>

@font-face {
  font-family: "MyriadProRegular";
  src: url("fonts/myriadpro-regular-webfont.eot");
  src: local("?"), url("fonts/myriadpro-regular-webfont.woff") format("woff"), url("fonts/myriadpro-regular-webfont.ttf") format("truetype"), url("fonts/myriadpro-regular-webfont.svg#webfonteknRmz0m") format("svg");
  font-weight: normal;
  font-style: normal; }

@font-face {
  font-family: "MyriadProLight";
  src: url("fonts/myriadpro-light-webfont.eot");
  src: local("?"), url("fonts/myriadpro-light-webfont.woff") format("woff"), url("fonts/myriadpro-light-webfont.ttf") format("truetype"), url("fonts/myriadpro-light-webfont.svg#webfont2SBUkD9p") format("svg");
  font-weight: normal;
  font-style: normal; }

@font-face {
  font-family: "MyriadProSemibold";
  src: url("fonts/myriadpro-semibold-webfont.eot");
  src: local("?"), url("fonts/myriadpro-semibold-webfont.woff") format("woff"), url("fonts/myriadpro-semibold-webfont.ttf") format("truetype"), url("fonts/myriadpro-semibold-webfont.svg#webfontM3ufnW4Z") format("svg");
  font-weight: normal;
  font-style: normal; }

</style>

...

<h1 style="font-size:64px; background-color: #eee; font-family: Helvetica">Article Header</h1> 
```

![在此处输入图像描述](../Images/86e96adfedecab4cb12e92a06069258e.png)

如果我们尝试添加 unitless `* { line-height: 1; }`，正如评论所建议的那样，我们会看到虽然它确实产生相同的高度，但垂直偏移量是不同的，页面上的其他元素也是如此：

![在此处输入图像描述](../Images/f38f27a4d0fd54282f7c4cd5abdd47e4.png)

我尝试了一些重置/规范化包无济于事。我只是想在这里确认这确实是生活中的事实（甚至省略了像 IE 和移动设备这样更明显的违规者），而且我不会错过一些超级棒的解决方案来解决这个烂摊子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:37:27.920

`line-height`对`BODY`（或`HTML`）元素使用无单位：

```
BODY {line-height: 1.25; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:35:00.323

在 pt 中使用字体站点，而不是像`font-size:12pt`

# android - 中心垂直。& 水平。TableLayout 中的 ProgressBar？

> ID：10020652
> 
> 赞同：0
> 
> 时间：2012-04-04T23:26:24.427
> 
> 标签：android, xml, progress-bar, android-asynctask, tablelayout

我有一个包含 TableLayout 的 ScrollView。当 AsyncTask 完成为我获取数据时，表格布局以编程方式激活。然后一个方法根据返回的数据量构建 TableRows 并将它们附加到 TableLayout。

在 XML 中，TableLayout 中的唯一项是 ProgressBar。这是 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/electionsScrollView" android:layout_width="wrap_content"
    android:layout_height="wrap_content">

    <TableLayout android:id="@+id/electionsQuestionContainer"
        android:layout_width="match_parent" android:layout_height="wrap_content">

        <ProgressBar android:id="@+id/electionsProgressBar"
            style="?android:attr/progressBarStyleLarge" android:layout_width="wrap_content"
            android:layout_height="match_parent" android:layout_gravity="center_vertical|center_horizontal" />

    </TableLayout>
</ScrollView> 
```

我显然不能将 ProgressBar 放在滚动视图中，因为滚动视图只能托管一项（表格布局）。我想我不想将 ProgressBar 放在表格行中，因为我想删除它比仅运行 progressBar.setVisibility(View.GONE); 的 AsyncTask 更麻烦。那么 tableRow 是我唯一的选择，还是我的 ProgressBar 不在屏幕中间垂直和水平居中是有原因的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:52:00.047

我大约到了一半。通过更改 TableLayout 的 layout_gravity：

```
<TableLayout android:id="@+id/electionsQuestionContainer"
    android:layout_width="match_parent" android:layout_height="wrap_content"
    android:layout_gravity="center_vertical|center_horizontal"> 
```

但是，当我以编程方式添加行时，这会破坏外观。有谁知道哪个 Gravity.CONSTANT 会使 tableLayout 返回默认值？当我没有为 TableLayout 的 layout_gravity 设置任何东西时，它看起来很完美。所以现在，我的 ProgressDialog 看起来完全符合我的喜好，但填充的行看起来不正确。怎么了？顶部表格行大约在屏幕顶部的一半处（换句话说，我只能看到第一个表格行的一半，其余部分不在屏幕顶部并且无法滚动到达）。

我最终使用了两个单独的布局，并删除了旧的。

# c++ - 有没有办法阻止 _popen 打开一个dos窗口？

> ID：10020653
> 
> 赞同：11
> 
> 时间：2012-04-04T23:26:24.783
> 
> 标签：c++, windows, shell, popen

我正在使用 _popen 启动一个进程来运行命令并收集输出

这是我的 C++ 代码：

```
bool exec(string &cmd, string &result)
{
   result = "";

   FILE* pipe = _popen(cmd.c_str(), "rt");
   if (!pipe)
      return(false);

   char buffer[128];
   while(!feof(pipe))
   {
        if(fgets(buffer, 128, pipe) != NULL)
               result += buffer;
   }
   _pclose(pipe);
   return(true);
} 
```

是否有任何方法可以在不打开控制台窗口的情况下执行此操作（就像当前在 _popen 语句中所做的那样）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:43:54.060

在 Windows 上，具有 STARTUPINFO 结构的 CreateProcess 具有包含 STARTF_USESSHOWWINDOW 的 dwFlags。然后将 STARTUPINFO.dwFlags 设置为 SW_HIDE 将导致控制台窗口在触发时隐藏。示例代码（可能格式不正确，包含 C++ 和 WinAPI 的混合）：

```
#include <windows.h>
#include <iostream>
#include <string>

using std::cout;
using std::endl;

void printError(DWORD);

int main()
{
  STARTUPINFOA si = {0};
  PROCESS_INFORMATION pi = { 0 };

  si.dwFlags = STARTF_USESHOWWINDOW | STARTF_USESTDHANDLES;
  si.wShowWindow = SW_HIDE;
  BOOL result = ::CreateProcessA("c:/windows/system32/notepad.exe", NULL, NULL, NULL, FALSE, 0, NULL, NULL, &si, &pi);
  if(result == 0) {
      DWORD error = ::GetLastError();
      printError(error);
      std::string dummy;
      std::getline(std::cin, dummy);
      return error;
  }

  LPDWORD retval = new DWORD[1];
  ::GetExitCodeProcess(pi.hProcess, retval);
  cout << "Retval: " << retval[0] << endl;
  delete[] retval;

  cout << "Press enter to continue..." << endl;
  std::string dummy;
  std::getline(std::cin, dummy);

  return 0;
}

void printError(DWORD error) {
    LPTSTR lpMsgBuf = nullptr;
     FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        error,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPTSTR) &lpMsgBuf,
        0, NULL );
     cout << reinterpret_cast<char*>(lpMsgBuf) << endl;
     LocalFree(lpMsgBuf);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T23:32:53.790

据我所知，您不能¹：您正在启动一个控制台应用程序（cmd.exe，它将运行指定的命令），并且 Windows 在启动控制台应用程序时总是会创建一个控制台窗口。

* * *

1.  但是，您*可以*`CreateProcess`在进程开始后隐藏窗口，或者如果您将适当的标志传递给;甚至可以将其隐藏起来。问题是，`_popen`不要传递这些标志，因此您必须使用 Win32 API 而不是`_popen`创建管道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:39:52.650

[最终编辑]

一个类似的 SO question 合并了上面所说的所有内容，并在没有控制台的情况下为您提供输出 [C++ popen 命令](https://stackoverflow.com/questions/7063859/c-popen-command-without-console)

[再次编辑]

呃。抱歉，我对产卵过程感到兴奋。我重读了你的q。除了额外的窗口之外，您实际上是在尝试获取进程的标准输出/标准错误。为此，我想补充一点，可悲的是，我的所有建议都无关紧要。但我会把它们留在这里以供参考。

[已编辑]

没有很好的具体原因（除了“打开”适用于 windows 和 mac），我使用 ShellExecute 来生成进程而不是 CreateProcess。我稍后会研究..但这是我的 StartProcess 函数。

隐藏或最小化似乎产生相同的结果。cmd 窗口确实出现了，但它被最小化并且永远不会在桌面上弹出，这可能是您的主要目标。

```
#if defined(PLATFORM_WIN32)
#include <Windows.h>
#include <shellapi.h>
#elif defined(PLATFORM_OSX)
#include <sys/param.h>
#endif
namespace LGSysUtils
{
// -----------------------------------------------------------------------
// pWindow      : {Optional} - can be NULL
// pOperation   : "edit", "explore", "find", "open", "print"
// pFile        : url, local file to execute
// pParameters  : {Optional} - can be NULL otherwise a string of args to pass to pFile
// pDirectory   : {Optional} - set cwd for process
// type         : kProcessWinNormal, kProcessWinMinimized, kProcessWinMaximized, kProcessHidden
//
bool StartProcess(void* pWindow, const char* pOperation, const char* pFile, const char* pParameters, const char* pDirectory, LGSysUtils::eProcessWin type)
{
    bool rc = false;
#if defined(PLATFORM_WIN32)

    int showCmd;
    switch(type)
    {
    case kProcessWinMaximized:
        showCmd = SW_SHOWMAXIMIZED;
        break;

    case kProcessWinMinimized:
        showCmd = SW_SHOWMINIMIZED;
        break;

    case kProcessHidden:
        showCmd = SW_HIDE;
        break;

    case kProcessWinNormal:
    default:
        showCmd = SW_NORMAL;
    }

    int shellRC = (int)ShellExecute(reinterpret_cast<HWND>(pWindow), pOperation,pFile,pParameters,pDirectory,showCmd);
    //Returns a value greater than 32 if successful, or an error value that is less than or equal to 32 otherwise.
    if( shellRC > 32 )
    {
        rc = true;
    }

#elif defined(PLATFORM_OSX)
    char cmd[1024];
    sprintf(cmd, "%s %s", pOperation, pFile);
    int sysrc = system( cmd );
    dbPrintf("sysrc = %d", sysrc);
    rc = true;
#endif
    return rc;
}

} 
```

[和之前提到的]

如果您可以控制启动的应用程序的源代码，则可以尝试将其添加到 main.cpp 的顶部（或您命名的任何名称）

```
// make this process windowless/aka no console window
#pragma comment( linker, "/subsystem:\"windows\" /entry:\"mainCRTStartup\"" ) 
```

您也可以直接将这些选项提供给链接器。对于不同的构建配置，以上内容更容易使用恕我直言。

# iphone - Xcode 上的错误 - 警告：所有应用程序都应包含 armv7 架构（当前 ARCHS = ""）

> ID：10020655
> 
> 赞同：16
> 
> 时间：2012-04-04T23:26:29.033
> 
> 标签：iphone, objective-c, ios, xcode

在构建应用程序时，我经常遇到以下错误。

错误是：检查依赖项

没有要编译的架构（ARCHS=armv7，VALID_ARCHS=arm6 arm7）。警告：所有应用程序都应包含 armv7 架构（当前 ARCHS = ""）。

我该如何解决这个问题？我正在使用 Xcode 4.3.1。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-11-04T08:45:12.397

在您的目标的构建设置中查看“**仅构建活动架构**”将调试设置为“否”并将发布设置为“否”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-07T19:03:03.380

当我将 iPhone 连接到我的 Mac 时，我的应用程序发生了这种情况。当我断开它并再次选择 iOS 设备存档时，一切正常。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-04T23:30:59.773

在您的目标的构建设置中有一个名为“架构”的设置，它可能是空的。向其中添加“armv7”和/或“armv6”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-30T20:42:39.257

我的问题是我写了“armv7，armv7s”，只需删除引号“，”就可以了。

# url - 网站如何使它们的 URL 干净（没有任何文件名/扩展名）以及从中获得什么好处（不包括性感）？

> ID：10020656
> 
> 赞同：1
> 
> 时间：2012-04-04T23:26:29.250
> 
> 标签：url, url-style

```
www.site.com/site/ 
```

代替

```
www.site.com/site/index.php 
```

* * *

```
www.site.com/articleName/ 
```

代替

```
www.site.com/articleName.php 
```

它已经存在了这么久，但我似乎在任何地方都找不到关于它的文章！

我知道你可以简单地用目录和 index.php 文件来做，但我敢肯定大多数网站不会那样做......

这些人是怎么做到的？除了看起来漂亮干净的 URL 之外，它还有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:28:57.783

一种方法是使用[Apache 的 mod_rewrite 模块](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)。

我确定还有其他人...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:29:43.010

对于 Apache/PHP，主要使用 ( [.htaccess](http://en.wikipedia.org/wiki/Htaccess) )[重写规则](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。对于 IIS/ASP 站点，通常使用[URL 重写模块](http://www.iis.net/download/urlrewrite) ，但还有许多其他技术（例如：处理所有不存在的 URL 并确定如何处理请求的“特殊 404 处理程序”）。

重写规则可以（来）非常复杂或非常简单；重写规则可用于 url 中的每个方法（或操作），或者它可以简单到将每个请求传递给相同的“index.php”（或等效项）并让代码处理其余的找出要做什么做。

为什么完成了？主要是因为 SEO 原因或“容易记住的 url”（现在谁输入了完整的 url？）或“[用户友好的 url](http://en.wikipedia.org/wiki/Clean_URL) ”。您可能想查看维基百科上的[这篇文章，其中还指出](http://en.wikipedia.org/wiki/Rewrite_engine)

> 该技术在用于生成网页的文件和呈现给外界的 URL 之间增加了一定程度的分离。

作为一个原因并总结了一些[缺点和好处](http://en.wikipedia.org/wiki/Rewrite_engine#Benefits_and_drawbacks)。更多可以在[这里](http://en.wikipedia.org/wiki/Clean_URL#Reasoning_and_common_practices)找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:30:02.517

您可以在 linux 上使用 modrewrite，为 iis 6 或 7 使用 isapi rewrite 或为 iis 7.5+ 使用 url 重写模块。

在 SO 中搜索`[friendly-url]`以找到答案。

# java - 如何调用java方法

> ID：10020658
> 
> 赞同：-3
> 
> 时间：2012-04-04T23:26:45.223
> 
> 标签：java

我对java编码很陌生。我很难找出如何将我`main`的方法与确定值是否为素数的方法联系起来。当我在 Eclipse 中运行下面的代码时，该方法似乎根本没有执行。有谁知道我做错了什么？

此外，对于最后一部分，我正在考虑`System.out`打印输入值是否为素数。即`true`或者`false`会很好。

```
import java.util.*;

class IsPrime {
    public boolean isprime(int n) {
        Scanner input1= new Scanner(System.in);
        System.out.println("input single integer?");

        int n1 = input1.nextInt();

        int i,c=0;

        for(i=1;i<=n1;i++) {
            if(n1%i==0){
                c++;
            }
        }
        if(c==2) {
            return true;
        } else {
            return false;  
        }
        System.out.println("Your number is:")
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:36:37.563

首先，Strawberry 和 appclay 说的都是对的。

另一方面，您的方法`isprime`是实例方法，而您的`main`（我猜您谈论的是主类的方法）是类（静态）方法。

尝试以下操作：

```
public static void main(String[] args) {
    int possiblePrime = // initialise your parameter
    IsPrime isPrime = new IsPrime();
    boolean primeOrNot = isPrime.isprime(possiblePrime);
    System.out.println("Your number is prime: " + primeOrNot);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:32:23.023

线

```
 System.out.println("Your number is:") 
```

无法访问，因为您有

```
else {
return false;
} 
```

在它之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:39:17.137

如果我了解您想要的是实现一个 isprime 方法并在 main.js 中调用它。

```
class IsPrime {
    public boolean isPrime(int n) {
        int i,c=0;

        for(i=1;i<=n;i++) {
            if(n%i==0){
                c++;
            }
        }
        if(c==2) {
            return true;
        } else {
            return false;  
        }
    }
    public static void main(String[] args) {
        Scanner input1= new Scanner(System.in);
        System.out.println("input single integer?");

        int n = input1.nextInt();
        IsPrime isPrime = new IsPrime();
        System.out.println("Your number is prime: " + isPrime.isPrime(n));
    }
} 
```

那应该做你想做的事。但是，您的代码中有一个错误。对于所有数字，您所拥有的将返回 true，而不仅仅是素数。我会留给你来发现错误和修复。

编辑：没有错误。请参阅下面的评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:52:46.217

将您的方法更改为静态，您可以在不创建该类的实例的情况下引用它

```
public static boolean isprime(int n) { 
```

# entity-framework - 为什么 EF Code First [InverseProperty] 属性与 [ForeignKey] 属性一起使用时无法正常工作？

> ID：10020660
> 
> 赞同：3
> 
> 时间：2012-04-04T23:26:55.550
> 
> 标签：entity-framework, foreign-keys, ef-code-first, data-annotations, entity-framework-4.3

## 使用：EF 4.3.1、Visual Studio 2010、SQL CE 4.0

我的理解是，在EF中用DataAnnotation声明外键时，可以通过以下任一方式完成：

### 选项1-

```
[ForeignKey("Player1Home")]
public long? HPlayer1Id { get; set; }

public virtual Player Player1Home { get; set; } 
```

### 选项 2-

```
public long? HPlayer1Id { get; set; }

[ForeignKey("HPlayer1Id")]
public virtual Player Player1Home { get; set; } 
```

## 问题：

当 InverseProperty DataAnnotation 与选项 2 一起使用时，除了 HPlayer1Id 之外，还会在数据库(Player1Home_Id) 中**生成一个额外的列。**

```
[Table("Matches")]
public class Match
{
    [Key]
    public long Id { get; set; }

    //-- Option 1 - THIS WORKS GREAT --//
    public long? HPlayer1Id { get; set; }
    [ForeignKey("HPlayer1Id")]
    public virtual Player Player1Home { get; set; }

    //-- Option 2 - THIS DOES NOT WORK, it generates an extra column in the database --//
    [ForeignKey("Player1Home")]
    public long? HPlayer1Id { get; set; }
    public virtual Player Player1Home { get; set; }
}

[Table("Players")]
public class Player
{
    [Key]
    public long Id { get; set; }

    [InverseProperty("Player1Home")]
    public virtual ICollection<Match> MatchesAsHome1 { get; set; }
} 
```

当然，如果我将 HPlayer1Id 重命名为 Player1HomeId，那么选项 2 将再次正常工作。但是 DataAnnotation 的全部目的是在“约定”无法自动确定匹配属性时允许显式命名。

删除 Player 类上的 InverseProperty DataAnnotation 似乎也解决了这个问题，但不幸的是我不能这样做，因为我的实际 Match 类中有四个 Player，因此我需要显式映射。

最后，我知道我可以只使用选项 1，但我更喜欢在 Id 字段上声明我的所有键（主键和外键）而不是在导航属性上声明外键的一致性。从技术上讲，任何一种方式都应该有效。

这只是 4.3.1 中的一个错误吗？首先在EF代码中？

还是不支持将 ForeignKey 和 InverseProperty 从两个不同的属性映射到公共的第三个属性？

任何信息将不胜感激！

## 更新：第二个错误？

第三个选项应该也可以（如 Slauma 所建议的那样），但会在我第一次尝试将实体添加到数据库时引发 NullReferenceException。数据库永远不会被创建，而上面的选项 2 没有这个问题。看来这在 EF 4.1 上对 Slauma 有效，但对我在 EF 4.3.1 上无效。（我在 SQL CE 4.0 中使用它）

```
[Table("Matches")]
public class Match
{
    [Key]
    public long Id { get; set; }
    [ForeignKey("Player1Home")]
    public long? HPlayer1Id { get; set; }
    [InverseProperty("MatchesAsHome1")]
    public virtual Player Player1Home { get; set; }
}

[Table("Players")]
public class Player
{
    [Key]
    public long Id { get; set; }
    public virtual ICollection<Match> MatchesAsHome1 { get; set; }
}

public class MyContext : DbContext
{
    public DbSet<Match> Matches { get; set; }
    public DbSet<Player> Players { get; set; }
} 
```

用法：

```
try
{
    MyContext mc = new MyContext();
    //NullReferenceException gets thrown on the next call
    mc.Matches.Add(new Match());
    mc.SaveChanges();
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-23T18:46:37.727

This was fixed in EF5 and I've confirmed it still behaves correctly in EF6.

You can see notes of investigation on this issue - [https://entityframework.codeplex.com/workitem/138](https://entityframework.codeplex.com/workitem/138).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T00:17:00.463

EF 4.1 中的行为相同。

您没有提到将`InverseProperty`属性移动到关系另一端的选项：

```
[Table("Matches")]
public class Match
{
    [Key]
    public long Id { get; set; }

    [ForeignKey("Player1Home")]
    public long? HPlayer1Id { get; set; }

    [InverseProperty("MatchesAsHome1")]
    public virtual Player Player1Home { get; set; }
}

[Table("Players")]
public class Player
{
    [Key]
    public long Id { get; set; }

    public virtual ICollection<Match> MatchesAsHome1 { get; set; }
} 
```

这对我有用，并没有创建额外的列。

您的选项 2 的行为对我来说看起来像是代码优先的错误。

**编辑**

确认将版本从 EF 4.1 更改为 EF 4.3.1 会导致出现`NullReferenceException`上述模型。没有创建数据库。

# javascript - 使用函数会导致“函数源代码”而不是评估函数值？

> ID：10020664
> 
> 赞同：3
> 
> 时间：2012-04-04T23:27:19.373
> 
> 标签：javascript

以下代码示例（也在[http://jsfiddle.net/MZwBS/](http://jsfiddle.net/MZwBS/)）

```
var items = [];

items.push({
    example: function() {
        if(0 > 1) {
            return 'true';
        } else {
            return 'false';
        }
    }
});

document.write(items[0].example); 
```

生产

```
'function () { if (0 > 1) { return "true"; } else { return "false"; } }' 
```

代替

```
'false' 
```

看来我已经能够使用 ExtJS 完成类似的事情了。谁能告诉我哪里出错了？我想即时评估这样的匿名函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:29:00.083

你的意思是执行吗？

```
document.write(items[0].example());​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:28:51.217

你要：

```
document.write(items[0].example()); 
```

当你跳过括号时，你说的是“打印这个函数”。当你拥有它们时，你是在说，“评估这个函数并打印结果。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T03:22:05.847

我通过在匿名函数后添加“（）”解决了我的问题，如下所示。
[http://jsfiddle.net/MZwBS/7/](http://jsfiddle.net/MZwBS/7/)

```
var items = [];

items.push({
    example: function() {
        if(0 > 1) {
            return 'true';
        } else {
            return 'false';
        }
    }()
});

document.write(items[0].example); 
```

这个代码块现在产生了预期的结果

```
'false' 
```

# php - PHP Twitter API“获取用户/查找”。从 id 中获取 screen_name

> ID：10020672
> 
> 赞同：1
> 
> 时间：2012-04-04T23:27:36.163
> 
> 标签：php, json, api, twitter

我制作了一个简单的 Twitter API 程序，它将遍历您的关注者并抓取所有关注者。它通过他们的 ID 获取他们。我如何获得他们的 screen_name？

我知道我必须使用 user_id 作为参数之一来处理用户/查找。

我注意到我认为是我的问题。

我试图得到的 JSON 代码是这样的。

```
[
 {
  "screen_name": "twitter"
 }
] 
```

我已经做到了（如下。）

```
{
  "screen_name": "twitter"
} 
```

使用查找功能 ( [https://dev.twitter.com/docs/api/1/get/users/lookup](https://dev.twitter.com/docs/api/1/get/users/lookup) ) 它以“[”开头。

我在想我必须做类似的事情。

$LookUp_JSON->[1]->screen_name 然后会打印“twitter”，但显然不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T09:05:53.877

查看 Twitter API 控制台 ( [https://dev.twitter.com/console](https://dev.twitter.com/console) )

..并对其进行一些破解，因为从控制台的角度来看它没有记录。

转到`users/show`你会看到这个的地方

http://api.twitter.com/1/users/show.json?screen_name={screen_name}

改成这个

http://api.twitter.com/1/users/show.json?user_id={id}

IE 的 ID 为 @TwitterAPI (6253282) 此调用

http://api.twitter.com/1/users/show.json?user_id=6253282

会给你这个：

```
{
  "id": 6253282,
  "id_str": "6253282",
  "name": "Twitter API",
  "screen_name": "twitterapi",
  "location": "San Francisco, CA",
etc...
} 
```

# jquery - 如何替换 CSS/切换大量元素？

> ID：10020675
> 
> 赞同：4
> 
> 时间：2012-04-04T23:28:02.900
> 
> 标签：jquery

**编辑：**问题变成了如何将大规模 CSS 更改优化为 700 个或更多 div。我将在下面留下旧问题来描述我的原始方法。

我有以下 jQuery，但它的行为不像我预期的那样。大约有 700 个具有 gr 类的 div，因此隐藏它们需要相当长的时间。我正在尝试做：

1.  单击“显示/隐藏发音”时，立即将该文本更改为“工作中”
2.  等到所有 'div.gr' 都被隐藏/显示
3.  “工作”回到“显示/隐藏发音”

    ```
    $(document).ready(function () {
     $('#togglePron').click(function() {
       $('#togglePron').html("Working...");
       $('div.gr').toggle();
       $('#togglePron').html("Show/hide Pronunciation");
      });
    });
    ...
    ... 
    <div class="pronlink" id="togglePron">Show/hide P</div>

    <div class="gr">hai</div><div class="zi">A</div>
    <div class="gr">nao</div><div class="zi">B</div>  
    etc. 
    ```

感谢 Mike Lentini [，这个问题有一个 jsfiddle。](http://jsfiddle.net/SVf5k/4/)

**[这是我正在处理的完整页面](http://freezoo.alwaysdata.net/readhash8.py)**

我观察到的行为是“显示/隐藏 P”需要很长时间才能更改，然后它会短暂更改为“工作”，然后又回到“显示/隐藏”。那么 jQuery 是否将 html() 和 .toggle() 捆绑在一起，而不是先运行 html()？

这似乎是特定于浏览器的，因为在 Opera 中它可以满足我的需求。在 IE 7 和 Chrome 18 中，行为如我所述。有没有办法让我在 Chrome 中想要的行为发生？还是做我所描述的更好的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:07:53.667

**编辑 ：**

与其使用切换功能来绑定事件，不如直接在所有元素上交换一个类？这应该*更快*：

```
$(document).ready(function(){
  $('#toggleP').click(function(){
    $('.gr').toggleClass('hidden');
  });
}); 
```

然后在你的 CSS 中，添加这个样式：

```
.hidden { display: none !important; } 
```

有关示例，请参[见此小提琴。](http://jsfiddle.net/5E45Q/4/)

**附加编辑：**

正如[kingjeffrey](https://stackoverflow.com/questions/10020675/10079888#comment12935287_10079888)所指出的，交换父元素而不是子元素的类交换效率更高：

```
JS:
$('#togglePron').click(function(){
  $('table').toggleClass('hide-pron');
});

CSS:
table.hide-pron .gr { display: none !important; } 
```

对于（相对）少量的孩子，这些方法之间的差异可以忽略不计——但随着孩子数量的增加，交换父类的速度会明显更快。

* * *

**原始答案：**

`click()`在函数返回之前，您的元素不会更新。这是一种方法（可能不是**最好**的方法）：

```
$(document).ready(function () {
  $('#toggleP').click(function() {
    $('#toggleP').html("Working...");
    setTimeout(
      "$('div.g').toggle(10,function(){$('#toggleP').html('Show/Hide P');});",
      10)
  });
}); 
```

现在`toggle()`是异步的，因为在未来通过`setTimeout()`. 这意味着该`click()`函数几乎可以立即返回，而无需等待`toggle()`完成。

正如其他人所指出的那样，最好的选择可能是将所有`div`s 包装在 parent 中（如果这对您的实际代码可行），然后切换该 parent `div`。

JSFiddle 链接：http: [//jsfiddle.net/5E45Q/](http://jsfiddle.net/5E45Q/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:17:40.120

如果您可以将所有的`div.g`'s 分组在一个父元素中，您将能够隐藏该单个父元素而无需修改 DOM 700 次。见[http://jsfiddle.net/SVf5k/6/](http://jsfiddle.net/SVf5k/6/)

但如果这是不可避免的，您可以在切换`div.g`'s. 这将使 js 引擎有机会更改 .html 上的 html `#toggleP`。见[http://jsfiddle.net/SVf5k/5/](http://jsfiddle.net/SVf5k/5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T14:54:36.517

**编辑**：我最初的回答旨在解决您对为什么只看到“正在工作......”很短时间并且`toggle()`直到一段时间后才看到效果的困惑。在实际查看您正在构建的网站时，我可以看到您真正关心的是让这个 UI 更新*更快*，在这种情况下，我强烈推荐[贾斯汀的回答](https://stackoverflow.com/a/10079888/105570)（尽管我也有兴趣解释为什么会有这样的那里有巨大的性能差异）。

* * *

简短的回答：我认为你想要的是**一个异步迭代器**，我已经在其他项目中看到过它，但奇怪的是我认为我没有在开源库中看到过（并不意味着它不存在- -我只是没见过）。

[像这样的东西。](https://gist.github.com/2351944)

你可以[在这里](http://jsfiddle.net/SVf5k/8/)看到它的行为方式（我认为）你所期望的。

现在，为了解释：

> 那么 jQuery 是否将 html() 和 .toggle() 捆绑在一起，而不是先运行 html()？

我不认为它是 jQuery；关于浏览器的渲染引擎如何处理来自事件循环的 UI 更新，我相信您所看到的是与浏览器相关的行为。我知道很多 UI 实现不会立即更新 UI 元素，而只会在处理的每个事件之间更新。

对于浏览器，我的一般观察（我并不是这方面的权威；您必须与实际的浏览器贡献者交谈）是*一些*UI 更新会立即发生，而*有些*更新除了在每个完整的通过事件循环。所以在我看来，无论 jQuery 在幕后做什么`toggle()`都属于后者。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T11:40:37.677

一种方法是使用 javascript 直接（而不是每个元素）动态修改您的 css 样式。

在您的页面中，每个 div 中的所有文本 div 中`<td>`都有一个`class='gr'`WITH 一个 inline `style="display:block;"`。首先，我将 移到`display:block;`样式表中（最好移到第一个位置）。

使用这个[SO 答案](https://stackoverflow.com/a/311437/496405)（和[这个页面](http://dev.opera.com/articles/view/dynamic-style-css-javascript/#stylesheetproperties)，还有这个[SO 答案](https://stackoverflow.com/a/622193/496405)），我会浏览每个样式表，直到你得到你感兴趣的那个（添加一个标题`<css />`可以让你轻松地做到这一点）。删除显示块（这是一个简单的`stylesheet.deleteRule(<index>)`索引将为零，因为您将它放在 .css 中的第一个）。添加一个新的`display:none;`.

这将实质上改变页面的整个 css，而不是单独改变它们 PER 元素，因为你被迫使用 JQuery。

也许不是最流行的解决方案，但仍然允许您保留当前的设计（不复制信息）并使用 css 来完成它应该做的事情（虽然“动态”）。

* * *

**跟进：** 很好的发现[“完全 Pwn CSS with Javascript”](http://www.hunlock.com/blogs/Totally_Pwn_CSS_with_Javascript)。完全符合我在您的情况下会做的事情（想在此处添加以供后代使用:)）

在旁注中，有人应该向 JQuery 提出功能请求，以便能够轻松地做这样的事情。:)

* * *

**跟进 2：** *刚刚意识到其他人在我之前发布了解决方案*

另一种方法是删除“gr”类并添加另一个“grHide”类。看看这个[小提琴](http://jsfiddle.net/SVf5k/13/)，看看我的意思。

按照我上面说的做，将内联`display:block;`移到 .gr 类下的 css 样式表中。添加一个单独的类，它可以完成 .gr 所做的所有事情，但会做 a `display:none;`。

这应该允许您使用 jquery 并且仍然非常快。无论如何，小提琴很快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T23:31:27.190

如果你查看 jQuery 文档，你会看到它`toggle()`有一个回调——尽管如果你想要一个回调，你还必须指定一个持续时间。所以你的代码可能看起来像：

```
$(document).ready(function () {
  $('#toggleP').click(function() {
    $('#toggleP').html("Working...");
    $('div.g').toggle(500, function() {
      $('#toggleP').html("Show/hide P");
    });
  });
});
...
... 
<div class="plink" id="toggleP">Show/hide P</div> 
```

如果半秒对你来说是一个很好的持续时间。在此处查看更多信息：http: [//api.jquery.com/toggle/](http://api.jquery.com/toggle/)

编辑：快速 jsfiddle：http: [//jsfiddle.net/SVf5k/](http://jsfiddle.net/SVf5k/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T14:59:31.480

在这里使用`$.ajax()`小提琴：http: [//jsfiddle.net/SVf5k/10/](http://jsfiddle.net/SVf5k/10/)

```
$(function () {
    $('#toggleP').click(function() {
       $(this).html("...Working...");

        $.ajax({
           success: function(){
              $('div.g').toggle(500, function() {
                     $('#toggleP').html("Show/hide P");
              });
          }
      })
  });
});
​ 
```

# php - 从 PHP 向 Python 传递命令

> ID：10020676
> 
> 赞同：2
> 
> 时间：2012-04-04T23:28:06.820
> 
> 标签：php, python, apache

我在 vps 上有一个 python 脚本，不过我运行了一个简单的命令。

```
./script.py [ipaddress] [portnumber] 
```

例子

```
./script.py 127.0.0.1 8080 
```

* * *

我想做的是在我的 apache 服务器（相同的 vps）上放置一个简单的 php 脚本，并在页面上使用一个表单来输入 ip 地址和端口号。以及一个 go 按钮。

运行脚本后，我希望它显示下面的脚本输出。如果可能的话（因为我真的不确定）我希望能够让几个人同时使用它......例如.. 10 个用户同时将数据传递给同一个脚本。

我的服务器正在运行 CentOS

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:30:11.527

popen() 是你想要的

[http://www.php.net/manual/en/function.popen.php](http://www.php.net/manual/en/function.popen.php)

这允许您运行任意命令并获得标准输出结果。

# opengl - glGetUniformBlockIndex 如何知道是查看顶点着色器还是片段着色器？

> ID：10020679
> 
> 赞同：1
> 
> 时间：2012-04-04T23:28:31.683
> 
> 标签：opengl, glsl, shader, uniform

我首先将两个着色器附加到我的程序，然后调用`glGetUniformBlockIndex`绑定统一缓冲区。我希望有一个`glBindShader`函数可以让我指定要解析哪个着色器以找到制服，但没有这样的事情。我如何告诉 OpenGL 它应该查看哪个着色器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:53:41.130

假设程序已经完全链接，那没关系。以下是可能性[`glGetUniformBlockIndex`](http://www.opengl.org/wiki/GLAPI/glGetUniformBlockIndex)及其后果：

*   给定的统一块名称不在任何着色器中。然后你回来`GL_INVALID_INDEX`。
*   给定的统一块名称用于其中一个着色器。然后你取回它的块索引，用于[`glUniformBlockBinding`](http://www.opengl.org/wiki/GLAPI/glUniformBlockBinding).
*   给定的统一块名称用于多个着色器。然后你得到块索引，这意味着*所有这些*，要与[`glUniformBlockBinding`](http://www.opengl.org/wiki/GLAPI/glUniformBlockBinding).

最后一部分是关键。如果您在两个着色器中指定同名的统一块，则 GLSL 要求这些统一块的*定义*相同。如果不是，那么您会在`glLinkProgram`. 因为它们是相同的（否则你不会到这里），GLSL 认为它们是*相同*的统一块。

即使它们处于两个着色器阶段，它们仍然是同一个统一块。因此，您可以在阶段之间共享统一的块，所有这些都具有一个块绑定。只要它确实是*同一个*统一块。

# language-agnostic - 什么是二进制字面量？

> ID：10020680
> 
> 赞同：0
> 
> 时间：2012-04-04T23:28:37.953
> 
> 标签：language-agnostic, programming-languages, binary-data

有人可以清楚地解释什么是二进制文字吗？二进制文字，十六进制和二进制数字，字符串有什么区别？它们是用来做什么的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:30:35.427

它们用于使用位表示数字。

```
0b0010010101001 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:31:16.753

因为有时用二进制表示值的意图更容易。这也适用于 16 进制。归根结底，它们都是数字，但是如果我想分配一个设置了多个位的标志，这样的事情似乎比替代方案更清楚。

```
flags = 0b110101 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T23:33:42.290

文字：http : [//cpp.comsci.us/etymology/literals.html](http://cpp.comsci.us/etymology/literals.html)。

> 字面常量（通常称为字面量或常量）是不变量，其值由其表示隐含

正如十六进制文字是“0xABCD”形式的字符串一样，二进制文字是“0b11011011”形式的字符串。可以通过检查前两个字符来区分它们。

[http://docs.oracle.com/javase/7/docs/technotes/guides/language/binary-literals.html](http://docs.oracle.com/javase/7/docs/technotes/guides/language/binary-literals.html)

# python - Python NLTK 最大熵分类器错误

> ID：10020682
> 
> 赞同：3
> 
> 时间：2012-04-04T23:28:43.257
> 
> 标签：python, nlp, classification, nltk

我目前正在使用 NLTK 的朴素贝叶斯分类器，但我也想尝试 Max Ent 分类器。从文档看来，它应该采用与朴素贝叶斯相同的功能集格式，但由于某种原因，当我尝试它时出现此错误：

```
 File "/usr/lib/python2.7/site-packages/nltk/classify/maxent.py", line 323, in train
    gaussian_prior_sigma, **cutoffs)
  File "/usr/lib/python2.7/site-packages/nltk/classify/maxent.py", line 1453, in train_maxent_classifier_with_scipy
    model.fit(algorithm=algorithm)
  File "/usr/lib64/python2.7/site-packages/scipy/maxentropy/maxentropy.py", line 1026, in fit
    return model.fit(self, self.K, algorithm)
  File "/usr/lib64/python2.7/site-packages/scipy/maxentropy/maxentropy.py", line 226, in fit
    callback=callback)
  File "/usr/lib64/python2.7/site-packages/scipy/optimize/optimize.py", line 636, in fmin_cg
    gfk = myfprime(x0)
  File "/usr/lib64/python2.7/site-packages/scipy/optimize/optimize.py", line 176, in function_wrapper
    return function(x, *args)
  File "/usr/lib64/python2.7/site-packages/scipy/maxentropy/maxentropy.py", line 420, in grad
    G = self.expectations() - self.K
ValueError: shape mismatch: objects cannot be broadcast to a single shape 
```

我不确定这意味着什么，但我使用的输入与我运行朴素贝叶斯时使用的输入完全相同，并且有效。（训练数据，表示为对列表，其中第一个成员是特征集，并且第二个是分类标签。）有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-05T03:54:25.490

我在使用 NLTK 时也遇到了这个问题。虽然我无法令人满意地解决它（即使用 scipy 让 Maxent 工作），但当我使用不同的算法时，我能够在 NLTK 中训练一个 maxent 分类器。尝试训练

```
me_classifier = nltk.MaxentClassifier.train(trainset,algorithm="iis") 
```

或其他可接受的算法值之一，例如“gis”或“megam”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:57:42.103

此问题还取决于您使用的 scipy 版本。

NLTK 使用 scipy.maxentropy，它在 scipy 0.10 中已弃用并在 0.11 中删除，请参阅文档：[http ://docs.scipy.org/doc/scipy-0.10.0/reference/maxentropy.html#](http://docs.scipy.org/doc/scipy-0.10.0/reference/maxentropy.html#)

我确实在 github 上为此创建了一个问题：[https ://github.com/nltk/nltk/issues/307](https://github.com/nltk/nltk/issues/307)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-16T09:23:43.300

你必须安装 nltk 然后你才能分类。使用下面的代码在 python 中使用最大熵进行分类

```
me_classifier = nltk.MaxentClassifier.train(trainset,algorithm="gis")
print(me_classifier.classify(testing)) 
```

# jquery-mobile - jQueryMobile 数据绑定选项

> ID：10020692
> 
> 赞同：3
> 
> 时间：2012-04-04T23:29:37.760
> 
> 标签：jquery-mobile, asp.net-mvc-4

我正在阅读有关 jQueryMobile 的一些基本教程，并且想知道 -可用于 jQueryMobile
的不同*数据绑定选项有哪些？*

我进行了搜索，结果只发现了 knockoutjs -
这是唯一的方法还是我可以像我们通常对普通 html 控件所做的那样绑定控件？

本质上，我想将 jQueryMobile 与 MVC 4 一起使用，并将控件与 JSON 绑定。

请指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:17:31.347

您应该能够像对待任何其他 MVC 应用程序一样对待使用 MVC 构建的 jquery 移动网站。您可能会遇到基于 jqm 的 ajax 导航问题，但可以使用`data-ajax="false"`.

[http://jquerymobile.com/test/docs/forms/forms-sample.html](http://jquerymobile.com/test/docs/forms/forms-sample.html)

您还可以全局进行此更改：“如果可能，jQuery Mobile 将通过 Ajax 自动处理链接点击和表单提交。如果为 false，URL 哈希侦听也将被禁用，并且 URL 将作为普通 HTTP 请求加载。”

```
$(document).bind("mobileinit", function(){
  $.mobile.ajaxEnabled = false;
}); 
```

[http://jquerymobile.com/test/docs/api/globalconfig.html](http://jquerymobile.com/test/docs/api/globalconfig.html)

最后，基于 ajax 的导航是关于性能的。如果你想使用通用的 asp.net MVC，你将不得不权衡这些权衡。

# delphi - 每当显示 DBGrid 时，如何获取要调用的方法？

> ID：10020695
> 
> 赞同：1
> 
> 时间：2012-04-04T23:29:49.357
> 
> 标签：delphi, autosize, dbgrid

TMS 的 DBStringGrid 组件有一个自动调整行高的内置方法。我了解该方法工作所需的属性设置，并且在调用它时效果很好。

我希望网格的行在显示网格时自动调整大小，但我不知道在哪里放置方法调用。我认为组件的 OnCustomCellDraw 事件将是正确的选择，但这只会导致与无限循环相关的闪烁和内存使用（即使 grid.doubleBuffering 设置为 true）。

如果我希望在显示网格的任何时候调用 AutoSizeRows，你会建议我在哪里调用它？

更新：Ken 的回答很好，但我也发现将调用放在 DataSource 的 OnDataChange 事件中，每当数据库进入编辑模式时，可能对我的目的同样有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:38:21.367

您可以使用父（包含）表单的`OnShow`事件：

```
procedure TForm1.FormShow(Sender: TObject);
begin
  // Make sure grid's data is available by opening the
  // dataset first, and then call your AUtoSizeRows here.
end; 
```

# asp.net-mvc - 带有数据实体框架的下拉列表

> ID：10020696
> 
> 赞同：1
> 
> 时间：2012-04-04T23:30:00.653
> 
> 标签：asp.net-mvc, ado.net

这是我的下拉列表：

```
 <div class="editor-label">
    <p>
        <%: Html.LabelFor(model => model.Gov) %>
    </p>
    </div>
    <div class="editor-field">
    <p>
        <%=Html.DropDownListFor(model => model.Gov, ViewBag.gov as SelectList)%>
        <%: Html.ValidationMessageFor(model => model.Gov) %>
    </p> 
```

这是我的视图控制器：

```
 public ActionResult TestR()
    {
        ViewBag.gov = new SelectList(entity.gouvernerat, "Idgov", "Nomg");
        return View();
    } 
```

使用 HttpPost ：

```
 [HttpPost]
    public ActionResult TestR(LogModel.preRegister Model)
    {
        if (ModelState.IsValid)
        {
            if (LogModel.preRegister.Verifuser(Model.IDag))
            {
                ModelState.AddModelError("", "Agence existe deja");
                return View(Model);
            }
            else
            {
                int ins = LogModel.preRegister.Register(Model);
                if (ins > 0)
                {

                    return View("Index");
                }
                else return View();
            }
        }
        else
        {
            return View();
        }

    } 
```

现在下拉列表显示我的数据库中的政府列表（这就是我想要的），但是当我点击创建时，我的 DropdownLisrt 中出现了这个错误`There is no ViewData item of type 'IEnumerable <SelectListItem>' with key 'Gov'.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:19:18.610

使用 LINQ to SQL 很容易做到这一点。假设您有一个`Govs`包含“Tunis”、“Ariana”等字符串的表。然后，您可以像这样创建您的选择列表：

```
govs.Select( x => new SelectListItem { Text = x.Name, Value = x.Name } ); 
```

当然，您甚至可以更灵活地将值分配给其他东西，例如 ID。

**更新：**更多详细信息以回答评论中提出的问题：

在视图模型中添加选择列表项：

```
public IEnumerable<SelectListItem> GovItems { get; set; } 
```

然后，在控制器中，在返回视图之前：

```
// database code to get "Govs" table goes here....

var vm = new MyViewModel {
  GovItems = govs.Select( x => new SelectListItem { Text = x.Name, Value = x.Name } );
} 
```

那么在你看来：

```
@Html.DropDownListFor( x => x.Gov, Model.Govs ) 
```

我希望这有帮助。如果您仍然感到困惑，我建议您阅读一些有关 ASP.NET MVC 的教程。我推荐微软官方的一款：

[http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/getting-started-with-mvc3-part1-cs](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/getting-started-with-mvc3-part1-cs)

# android - 如何使 PreferenceActivity 启动对话框以设置自定义首选项

> ID：10020701
> 
> 赞同：12
> 
> 时间：2012-04-04T23:30:30.637
> 
> 标签：android, dialog, sharedpreferences, android-preferences

我有一个从菜单选项启动的工作首选项设置。在首选项中，我设置了一个自定义首选项，它必须启动一个带有 3 个 TextView 的对话框来设置确认和更改密码。现在我不知道如何从 PreferenceActivity 的 onPreferenceClick 启动对话框。如果我听起来像个新手——我是，对不起！

这是我的对话框弹出的xml布局：

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout
    android:layout_height="match_parent"
    android:layout_width="match_parent"
    android:orientation="vertical"
    android:id="@+id/root"
    xmlns:android="http://schemas.android.com/apk/res/android">

    <TextView
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:id="@+id/TextView_Pwd1"
        android:text="@string/settings_oldpassword"
        android:textStyle="bold" />

    <EditText
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:id="@+id/EditText_OldPwd" />

    <TextView
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:id="@+id/TextView_Pwd1"
        android:text="@string/settings_password"
        android:textStyle="bold" />

    <EditText
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:id="@+id/EditText_Pwd1"
        android:inputType="textPassword" />

    <TextView
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:id="@+id/TextView_Pwd2"
        android:text="@string/settings_password2"
        android:textStyle="bold" />

    <EditText
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:id="@+id/EditText_Pwd2"
        android:inputType="textPassword" />

    <TextView
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:id="@+id/TextView_PwdProblem"
        android:textStyle="bold"
        android:gravity="center" />

    <TextView
        android:id="@+id/TextView_PwdProblem"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="@string/settings_pwd_not_equal" />

    <CheckBox
        android:id="@+id/checkShowPwdText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/settings_showpwd_text" /> 
```

这是对话框弹出窗口的 DialogChangePassword 类：

```
package biz.linsys.package;

import android.app.Dialog;
import android.content.Context;
import android.content.SharedPreferences;
import android.preference.DialogPreference;
import android.text.Editable;
import android.text.TextWatcher;
import android.util.AttributeSet;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;

public class DialogChangePassword extends DialogPreference {

    private String strPass1;
    private String strPass2;

    public DialogChangePassword(Context context, AttributeSet attrs) {
        super(context, attrs);
        setDialogLayoutResource(R.layout.dialog_pwdchange);
    }

    @Override
     protected void onBindDialogView(View view) {

        Dialog pwdDialog            = getDialog();
        final EditText password1    = (EditText) pwdDialog.findViewById(R.id.EditText_Pwd1);
        final EditText password2    = (EditText) pwdDialog.findViewById(R.id.EditText_Pwd2);
        final TextView error        = (TextView) pwdDialog.findViewById(R.id.TextView_PwdProblem);      

        password2.addTextChangedListener(new TextWatcher() {

            @Override
            public void afterTextChanged(Editable s) {

                strPass1 = password1.getText().toString();
                strPass2 = password2.getText().toString();

                if (strPass1.equals(strPass2)) {

                    error.setText(R.string.settings_pwd_equal);
                } else {

                    error.setText(R.string.settings_pwd_not_equal);
                }
            }  public void beforeTextChanged(CharSequence s, int start, int count, int after) {}
               public void onTextChanged(CharSequence s, int start, int before, int count) {}
        });

        super.onBindDialogView(view);

    }

    @Override
    protected void onDialogClosed(boolean positiveResult) {

        if(!positiveResult) return;

        SharedPreferences.Editor editor = getEditor();

        if (strPass1.equals(strPass2)) {

            editor.putString("password", strPass1);
            editor.commit();
        }

        super.onDialogClosed(positiveResult);

    }
} 
```

这是包含自定义首选项 onPreferenceClick 的 PreferenceActivity 类。这是我需要调用对话框来更改用户密码设置的地方。

```
package biz.linsys.package;

import android.content.Context;
import android.os.Bundle;
import android.preference.Preference;
import android.preference.Preference.OnPreferenceClickListener;
import android.preference.PreferenceActivity;

public class Preferences extends PreferenceActivity {

    public static Context dialogContext;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);

        // Get the custom preference
        Preference customPref = (Preference) findPreference("customPref");

        customPref.setOnPreferenceClickListener(new OnPreferenceClickListener() {

            public boolean onPreferenceClick(Preference preference) {

                // [ NEED TO CALL DIALOG FROM HERE ]

                return false;
           }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-21T16:21:34.200

这是文档中缺少的东西，我发现了很多类似的问题，大部分都没有明确的答案。我今天遇到了同样的问题，不知何故我找到了解决方案，所以我将在这里总结我的任务，希望有人会觉得这很有用。顺便说一句，您的问题是最详细和最准确的。

一般的一点是您不需要手动创建对话框，您只需 1）创建 DialogPreference 的子类，它将处理复杂首选项的逻辑，以及 2）在您的 preferences.xml 中创建正确类型的节点所以对话框将自动生成。

Android SDK 的问题是您无法使用可视 XML 编辑器添加正确的节点，您需要手动编辑文件。

文档的问题在于它错过了这一点信息。

所以这里是一步一步的解决方案：

1) 创建一个 DialogPreference 的子类来处理您的特殊偏好。有关您的子类所需内容的详细信息，我建议您使用[此答案](https://stackoverflow.com/a/4805325/1380150)。

2) 在您的preferences.xml 中创建一个Preference 节点。

3) 编辑preferences.xml 并将Preference 替换为DialogPreference 子类的全名，包括包路径，例如com.sample.MyPreferenceDialog。您还可以向节点添加一些属性以自定义对话框（标题、图标等），有关详细信息，请参阅[此答案](https://stackoverflow.com/a/8818446/1380150)或 DialogPreference 的文档。

就这样。您不需要将 OnPreferenceClickListener 添加到首选项中，对话框将自动显示。

注意：我不是 100% 确定这是使用事物的预期方式，但它似乎正在工作。

# java - JMX 异常“引起：java.lang.ClassNotFoundException：[Lbyte;”

> ID：10020702
> 
> 赞同：3
> 
> 时间：2012-04-04T23:30:32.907
> 
> 标签：java, exception, jmx

运行一些 HBase 代码时出现以下问题。看起来它起源于 MXBean 位。我对此一无所知，但看起来相当低级。

```
javax.management.NotCompliantMBeanException: org.apache.hadoop.hbase.master.MXBean: Method org.apache.hadoop.hbase.master.MXBean.getRegionServers has parameter or return type that cannot be translated into an open type
    at com.sun.jmx.mbeanserver.Introspector.throwException(Introspector.java:419)
    at com.sun.jmx.mbeanserver.MBeanAnalyzer.<init>(MBeanAnalyzer.java:118)
    at com.sun.jmx.mbeanserver.MBeanAnalyzer.analyzer(MBeanAnalyzer.java:104)
    at com.sun.jmx.mbeanserver.MXBeanIntrospector.getAnalyzer(MXBeanIntrospector.java:71)
    at com.sun.jmx.mbeanserver.MBeanIntrospector.getPerInterface(MBeanIntrospector.java:181)
    at com.sun.jmx.mbeanserver.MBeanSupport.<init>(MBeanSupport.java:136)
    at com.sun.jmx.mbeanserver.MXBeanSupport.<init>(MXBeanSupport.java:66)
    at com.sun.jmx.mbeanserver.Introspector.makeDynamicMBean(Introspector.java:184)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:936)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:330)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:516)
    at org.apache.hadoop.metrics.util.MBeanUtil.registerMBean(MBeanUtil.java:58)
    at org.apache.hadoop.hbase.master.HMaster.registerMBean(HMaster.java:1646)
    at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:527)
    at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:336)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.lang.IllegalArgumentException: Method org.apache.hadoop.hbase.master.MXBean.getRegionServers has parameter or return type that cannot be translated into an open type
    at com.sun.jmx.mbeanserver.ConvertingMethod.from(ConvertingMethod.java:45)
    at com.sun.jmx.mbeanserver.MXBeanIntrospector.mFrom(MXBeanIntrospector.java:81)
    at com.sun.jmx.mbeanserver.MXBeanIntrospector.mFrom(MXBeanIntrospector.java:51)
    at com.sun.jmx.mbeanserver.MBeanAnalyzer.initMaps(MBeanAnalyzer.java:135)
    at com.sun.jmx.mbeanserver.MBeanAnalyzer.<init>(MBeanAnalyzer.java:116)
    ... 14 more
Caused by: javax.management.openmbean.OpenDataException: Cannot obtain array class
    at com.sun.jmx.mbeanserver.OpenConverter.openDataException(OpenConverter.java:1389)
    at com.sun.jmx.mbeanserver.OpenConverter.makeArrayOrCollectionConverter(OpenConverter.java:346)
    at com.sun.jmx.mbeanserver.OpenConverter.makeConverter(OpenConverter.java:295)
    at com.sun.jmx.mbeanserver.OpenConverter.toConverter(OpenConverter.java:277)
    at com.sun.jmx.mbeanserver.OpenConverter.makeTabularConverter(OpenConverter.java:376)
    at com.sun.jmx.mbeanserver.OpenConverter.makeParameterizedConverter(OpenConverter.java:417)
    at com.sun.jmx.mbeanserver.OpenConverter.makeConverter(OpenConverter.java:312)
    at com.sun.jmx.mbeanserver.OpenConverter.toConverter(OpenConverter.java:277)
    at com.sun.jmx.mbeanserver.OpenConverter.makeCompositeConverter(OpenConverter.java:482)
    at com.sun.jmx.mbeanserver.OpenConverter.makeConverter(OpenConverter.java:309)
    at com.sun.jmx.mbeanserver.OpenConverter.toConverter(OpenConverter.java:277)
    at com.sun.jmx.mbeanserver.OpenConverter.makeTabularConverter(OpenConverter.java:377)
    at com.sun.jmx.mbeanserver.OpenConverter.makeParameterizedConverter(OpenConverter.java:417)
    at com.sun.jmx.mbeanserver.OpenConverter.makeConverter(OpenConverter.java:312)
    at com.sun.jmx.mbeanserver.OpenConverter.toConverter(OpenConverter.java:277)
    at com.sun.jmx.mbeanserver.ConvertingMethod.<init>(ConvertingMethod.java:197)
    at com.sun.jmx.mbeanserver.ConvertingMethod.from(ConvertingMethod.java:40)
    ... 18 more
Caused by: java.lang.ClassNotFoundException: [Lbyte;
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:186)
    at com.sun.jmx.mbeanserver.OpenConverter.makeArrayOrCollectionConverter(OpenConverter.java:344)
    ... 33 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:48:23.370

看起来这已经在 HBase JIRA 上报告过了

[https://issues.apache.org/jira/browse/HBASE-5718](https://issues.apache.org/jira/browse/HBASE-5718)

[他们认为这是一个 JMX 问题，我在查看下面的源代码](http://www.docjar.com/html/api/com/sun/jmx/mbeanserver/OpenConverter.java.html)后倾向于同意这一点。请注意关于从未见过原始数组的评论。不知何故，一个原始数组进入了这里，并被视为一个对象类。

```
 323       /* Make the converter for an array type, or a collection such as
  324        * List<String> or Set<Integer>.  We never see one-dimensional
  325        * primitive arrays (e.g. int[]) here because they use the identity
  326        * converter and are registered as such in the static initializer.
  327        */
  328       private static OpenConverter
  329           makeArrayOrCollectionConverter(Type collectionType, Type elementType)
  330               throws OpenDataException {
  331   
  332           final OpenConverter elementConverter = toConverter(elementType);
  333           final OpenType<?> elementOpenType = elementConverter.getOpenType();
  334           final ArrayType<?> openType = ArrayType.getArrayType(elementOpenType);
  335           final Class<?> elementOpenClass = elementConverter.getOpenClass();
  336   
  337           final Class<?> openArrayClass;
  338           final String openArrayClassName;
  339           if (elementOpenClass.isArray())
  340               openArrayClassName = "[" + elementOpenClass.getName();
  341           else
  342               openArrayClassName = "[L" + elementOpenClass.getName() + ";";
  343           try {
  344               openArrayClass = Class.forName(openArrayClassName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-29T23:21:35.573

验证您没有使用 OpenJDK 来运行 HBase。虽然从[在线文档的先决条件列表](http://hbase.apache.org/book.html#basic.prerequisites)中看不明显，但显然一些较旧的 Hbase 版本可能需要 Oracle Java。请参阅[此链接](http://mail-archives.apache.org/mod_mbox/hbase-user/201212.mbox/%3CCAD-H3pJ4kkZfStiUvaoWk-7eRMG-TKSA6g_jdnKvmxp56bZLAQ@mail.gmail.com%3E)。

# java - Java：扫描程序在遇到撇号 (') 字符时突然终止中间文件

> ID：10020704
> 
> 赞同：0
> 
> 时间：2012-04-04T23:30:50.497
> 
> 标签：java, character-encoding, io

我正在使用扫描仪从文本文件中读取。它在遇到文件中的撇号 ( ' ) 字符（十六进制代码 27）时突然退出。我在这里发现了一个类似的问题，最终在意识到文件的字符集是 LATIN-1 时克服了这个问题。我不知道我正在阅读的文件的编码，似乎没有简单的方法来确定它。我尝试在 Scanner 构造函数（文件，字符集）中插入随机字符集，但无济于事。我在这里错过了什么吗？

# c# - C# 局部变量和实例变量的正确大小写约定是什么？

> ID：10020705
> 
> 赞同：4
> 
> 时间：2012-04-04T23:30:50.920
> 
> 标签：c#, .net, coding-style, naming-conventions

我公司有很多前 Java 开发人员在 C# 中使用驼峰式大小写来实现这两个方面。C# 最广泛接受/使用的外壳是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-04T23:33:32.907

[这是微软约定](http://msdn.microsoft.com/en-us/library/ms229043.aspx)

[![在此处输入图像描述](../Images/2905a32e7f3bf79f7dff4dd476cc058a.png "点击查看全图")](https://i.stack.imgur.com/ejz3B.gif "点击查看全图")

[这是完整的 MSDN 约定](http://msdn.microsoft.com/en-us/library/ms229002.aspx)

[以下是 Brad Abrams 的内部指南（涵盖几乎所有内容，而不仅仅是亮点）](http://blogs.msdn.com/b/brada/archive/2005/01/26/361363.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-04T23:46:17.633

...还有这个...
[内部编码指南](http://blogs.msdn.com/b/brada/archive/2005/01/26/361363.aspx)（设计指南、托管代码和 .NET 框架）
我更喜欢这个，有一个关于命名/大小写的明确段落。它只是更严格一点。

编辑：这应该是新的链接，存档 -[内部编码指南](https://docs.microsoft.com/en-us/archive/blogs/brada/internal-coding-guidelines)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T23:33:34.990

最常见的外壳是`camelCasing`.

**Microsoft .NET Framework Reference Guidelines**要求方法参数采用camelCasing 格式，因为这些类似于局部变量，所以我会以同样的方式对待它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-04T23:32:04.333

与 Java 中的完全相同：

```
int someVeryLongLocalVariableName; 
```

[官方酸](http://msdn.microsoft.com/en-us/library/ms229043(v=vs.100).aspx)：

> **骆驼套管**
> 
> 标识符的第一个字母小写，每个后续连接的单词的第一个字母大写。
> 
> 当标识符由多个单词组成时，不要在单词之间使用分隔符，例如下划线（“_”）或连字符（“-”）。相反，使用大小写来指示每个单词的开头。
> 
> 以下指南提供了标识符的一般规则。
> 
> **对所有由多个单词组成的公共成员、类型和命名空间名称使用 Pascal 大小写。**
> 
> 请注意，此规则不适用于实例字段。出于成员设计指南中详述的原因，您不应使用公共实例字段。
> 
> **请使用驼峰式大小写作为参数名称。**
> 
> 下表总结了标识符的大小写规则，并提供了不同类型标识符的示例。

# ios - UIImageView -> UIScrollview，裁剪和剪辑滚动视图坐标

> ID：10020718
> 
> 赞同：1
> 
> 时间：2012-04-04T23:31:50.293
> 
> 标签：ios, objective-c, uiscrollview, uiimageview, crop

有人可以指出我正确的方向。我一直在寻找这个，但似乎无法找到明确的答案。我有一个 300x300 像素的 UIScrollview。在里面我有一个 UIImageView。这个想法是允许用户从他们的照片库中抓取一张照片，然后在 300x300 滚动视图中捏合和缩放它。然后将视口另存为新照片。

到目前为止，我有这个...

```
 -(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo {

    UIImageView *insideImgView = [[UIImageView alloc] initWithImage:image];
    scroller.contentSize = CGSizeMake(image.size.width, image.size.height);
    scroller.maximumZoomScale = 4.0;
    scroller.minimumZoomScale = 0.0;
    scroller.clipsToBounds = YES;
    scroller.delegate = self;
    [self setSendImage:insideImgView];
    [scroller addSubview:insideImgView];
}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView {
    return sendImage;
} 
```

这工作正常。我可以拉入图像并捏合和缩放。但是现在我如何获得缩放和坐标以在完成后将照片切片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:45:32.830

将视图的内容导出到图像中非常简单。

尝试在这篇文章中使用 St3fan 的答案：[Get a PDF/PNG as output from a UIWebView or UIView](https://stackoverflow.com/questions/2454309/get-a-pdf-png-as-output-from-a-uiwebview-or-uiview)。

# iphone - 如何呈现一个 tabview 控制器？

> ID：10020721
> 
> 赞同：0
> 
> 时间：2012-04-04T23:32:05.987
> 
> 标签：iphone, ios

嗨，我有一个基于选项卡的应用程序，我所做的是将另一个视图作为欢迎屏幕，我已经让它首先加载，问题是我不知道如何从我创建的视图中调用 tabview 控制器。

presentmodal 视图控制器它只显示第一个视图

这就是我的 .m 文件中的内容

```
-(IBAction) next_OnClick
{
  FirstView *f=[[FirstView alloc] init];
  [self presentModalViewController:f animated:YES];

} 
```

请告诉我这样做的正确方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:05:21.630

当 FirstView（它应该被称为 FirstViewController）决定是时候离开时，它可以这样做：

```
[self dismissModalViewControllerAnimated:YES]; 
```

# android - 为 TextView 使用自定义嵌入字体

> ID：10020723
> 
> 赞同：0
> 
> 时间：2012-04-04T23:32:15.660
> 
> 标签：android, fonts, textview

所以我有一个布局，它有`TextView`：

```
<TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="GLASSES RX EXPIRATION DATE"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/black"
                android:typeface="monospace" /> 
```

我的`assets/fonts/`文件夹中还存储了一个 futura 字体。我知道如何使用 java 设置字体，但是在 xml 布局中有没有办法将字体设置为我的嵌入资产字体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:38:25.013

`normal`不，除了默认字体、`monospace`、`sans`和之外，没有办法在 xml 布局中设置自定义字体`serif`。您可以使用自定义属性制作自己的`TextView`，该属性可以采用 xml 中的额外字体并使用它而不是普通`TextView`类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T04:45:25.647

在标准形式中，您将无法做到这一点，但 Luksprog 提到有一种解决方法。你基本上需要

1.  在 styleable 中声明一个属性，用于指定字体类型。
2.  在 assets/fonts 文件夹中添加您的自定义字体。
3.  在扩展 TextView 的构造函数中使用指定的字体类型来访问自定义字体。

这将使您能够使用自定义字体，而无需在整个应用程序的 java 中设置它。这是它的[教程](http://www.shubhayu.com/android/custom-control-extending-existing-views)。

# android - 从 android 到 Google 应用引擎

> ID：10020727
> 
> 赞同：5
> 
> 时间：2012-04-04T23:32:56.283
> 
> 标签：android, google-app-engine

有人可以向我提供一个教程的链接，该教程显示并解释了如何将数据从 android 模拟器发送到 Google 应用程序引擎。我自己用谷歌搜索过，但没有找到任何好的。我是一个初学者，所以任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T06:00:57.287

标准方法是在 GAE 上创建一个 REST 服务，然后从 Android 调用它。

服务器端：有几个 REST 库，我个人选择的是[Resteasy](http://docs.jboss.org/resteasy/docs/2.3.1.GA/userguide/html/index.html)。

Android 端：有很多如何使用 REST 服务的[示例。](https://stackoverflow.com/questions/8267928/android-rest-client-sample)您可能还想查看[Spring 中的 Android 客户端](http://www.springsource.org/spring-android)。

对于完整的示例，您可能需要查看[LeanEngine 的源代码](http://www.lean-engine.com/)。

# python - Python：IMAP 连接到 gmail 返回错误

> ID：10020735
> 
> 赞同：3
> 
> 时间：2012-04-04T23:33:48.920
> 
> 标签：python, gmail, imap

突然，我连接到 gmail 并检查未读电子邮件的代码停止工作：

```
Connecting to Inbox..
Error
Traceback (most recent call last):
  File "./run", line 27, in <module>
    mail.login("xxx@dddd.com", "xxxxx123")
  File "/usr/lib/python2.6/imaplib.py", line 498, in login
    typ, dat = self._simple_command('LOGIN', user, self._quote(password))
  File "/usr/lib/python2.6/imaplib.py", line 1060, in _simple_command
    return self._command_complete(name, self._command(name, *args))
  File "/usr/lib/python2.6/imaplib.py", line 890, in _command_complete
    raise self.abort('command: %s => %s' % (name, val))
imaplib.abort: command: LOGIN => socket error: EOF 
```

这是代码：

```
#!/usr/bin/env python

import imaplib, re
import os
import time
import socket

imap_host = 'imap.gmail.com'
mail = imaplib.IMAP4_SSL(imap_host, 993)
mail.login("xxxx@xxxx.com", "xxxx")

while True:
    try:
        print 'Connecting to Inbox..'
        mail.select("inbox") # connect to inbox.
        result, data = mail.uid('search', None, 'UNSEEN')
        uid_list = data[0].split()
        print len(uid_list), 'Unseen emails.'
        if len(uid_list) > 20:
         os.system('heroku restart --app xxx-xx-203')
        time.sleep(30)
    except:
        print 'Error'
        time.sleep(120)
        imap_host = 'imap.gmail.com'
        mail = imaplib.IMAP4_SSL(imap_host, 993)
        mail.login("xxx@xxx.com", "xxxx")
        pass 
```

而且我也经常遇到这个错误：

```
Traceback (most recent call last):
  File "./run", line 10, in <module>
    mail.login("xxx@xxx.com", "xxx")
  File "/usr/lib/python2.6/imaplib.py", line 498, in login
    typ, dat = self._simple_command('LOGIN', user, self._quote(password))
  File "/usr/lib/python2.6/imaplib.py", line 1060, in _simple_command
    return self._command_complete(name, self._command(name, *args))
  File "/usr/lib/python2.6/imaplib.py", line 893, in _command_complete
    self._check_bye()
  File "/usr/lib/python2.6/imaplib.py", line 808, in _check_bye
    raise self.abort(bye[-1])
imaplib.abort: [UNAVAILABLE] Temporary System Error 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:38:03.297

诡异的。我运行了你的确切代码并很好地连接到了 gmail。我建议尝试从另一个系统连接。

如果您无法访问任何其他系统，我可以为您提供一个帐户，如果您愿意，可以尝试使用我的帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T05:58:19.833

这最终必然会发生。解决方案是捕获中止异常并重新初始化 imap 连接。

# php - 时间戳查询不起作用

> ID：10020738
> 
> 赞同：0
> 
> 时间：2012-04-04T23:34:15.207
> 
> 标签：php, mysql, datetime, variables, date

我有一个时间戳问题。我想检查时间戳是在过去还是将来。如果是过去，则应该进行查询。

到目前为止，我得到了一个 mysql-timestamp，它将被

```
$row = $query->fetch_object();
$timestamp = $row->time 
```

其中包含：

```
2012-04-04 12:06:38 
```

对于进一步的设置，我使用另外两个变量，它们将是：

```
$added = $timestamp + 1209600;  //what adds 14days (1209600 seconds) to my db-timestamp
$check = $added < time();  //what checks if the 14days have passed or not 
```

好的，现在如果我用 var_dump 测试所有这些，它将为每个返回：

```
string(19) "2012-04-04 12:06:38" at var_dump($timestamp)
int(1211612) at var_dump($added)
bool(true) at var_dump($check) 
```

所以我的问题是，以下查询将一直执行，即使应该已经过了 14 天。我知道，因为我将时间戳更改为 1 月的较早日期。这是我的查询：

```
if ($check === true){
    $update = $db->query("UPDATE table SET xy='1' WHERE x='$x'");
    } 
```

有些事情似乎是错误的，我不知道那可能是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:42:21.483

在我看来，您尝试添加字符串和 int。

也许您应该在将常量添加到它之前尝试将时间戳转换为和 int。

当您使用例如以下`TO_SECONDS()`方法选择时间戳时，您可以直接在查询中执行此操作：

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:49:33.593

我同意barsju。MySQL 的结果是 DateTime 条目的字符串，实际上不是时间戳。将其保留在 PHP 中的另一个选项是`strtotime($string);`将字符串转换为其时间戳。重要的是您在检查之前获得时间戳。

我会在你的例子的这一行做：

```
$timestamp = strtotime($row->time); 
```

我相信还有其他几种方法可以让 MySQL 也返回时间戳。

# c# - 视频会议 - 使用 SilverLight 的 ASP.net

> ID：10020739
> 
> 赞同：0
> 
> 时间：2012-04-04T23:34:21.650
> 
> 标签：c#, asp.net, visual-studio, video

我正在尝试构建一个视频通话应用程序。它可以是基于 Web 的，也可以是桌面应用程序。我已经设法使用 SilverLight 制作了一个基于 Web 的，但是在我的服务器（由 GoDaddy 托管）上托管服务器部分时，以下代码：

```
Listener_Socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
Listener_Socket.Bind(new IPEndPoint(AddressAr[0], Port));
Listener_Socket.Listen(-1); 
```

（主要在 .Bind 语句处）产生以下异常：

```
Request for the permission of type 'System.Net.SocketPermission, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed

at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark& stackMark, Boolean isPermSet)
at System.Security.CodeAccessSecurityEngine.Check(CodeAccessPermission cap, StackCrawlMark& stackMark)
at System.Security.CodeAccessPermission.Demand()
at System.Net.Sockets.Socket.Bind(EndPoint localEP)
at WebApplication3.SocketCoderVideoServer.Start_A_Server_On(Int32 Port) 
```

我可能的解决方案是什么？另外，如果我要放弃以下项目，如果可能的话，最好的替代方案是什么，我消除了服务器监听新连接的需要？

请帮助我，因为我需要尽快设置视频会议...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:08:35.217

如果您在某处使用 Flash 和 RTMP 服务器实现，您的运气会好得多。我花了太多时间在 Silverlight 上进行视频会议，但它并不是为此而生的。除非您打算在接下来的几年中解决这些问题，否则您需要在本机运行代码，Flash 提供了这一点，而 Silverlight 没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:44:39.587

托管未授予您的代码创建和使用套接字的权限 - 这是有道理的，因为 GoDaddy 不希望托管代码创建和使用任意套接字连接，这将是安全和性能的噩梦。

我的建议是尝试使用一些已经启动并运行的第三方服务——Skype 和 MSN Messanger 都支持视频会议，你不能利用它吗？

我认为基于 XMPP 协议的即时消息服务器也可以支持视频 - 请参阅[http://xmpp.org/about-xmpp/](http://xmpp.org/about-xmpp/)

# android - 如何在 android 项目中导入 jars？

> ID：10020740
> 
> 赞同：2
> 
> 时间：2012-04-04T23:34:22.773
> 
> 标签：android, ksoap2

我正在使用 Eclipse。我已经按照多个教程在我的 android 项目上设置 ksoap。ksoap2 jar 文件包含在我的构建路径中。本教程包括以下几行。

```
 SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
    SoapSerializationEnvelope envelope = new SoapSerializaionEnvelope(SoapEnvelope.VER11);
    envelope.setOutputSoapObject(request); 
```

SoapObject 带有红色下划线，当我将鼠标悬停在它上面时，不会提示我选择导入它。创建类、创建接口等都是选项。

任何帮助是极大的赞赏。

![在此处输入图像描述](../Images/3d833f7b4b4720d905b1c88ed69851eb.png)

![在此处输入图像描述](../Images/7aa7617a04555e30f96dba8cca95dfea.png)

![在此处输入图像描述](../Images/cad6f437a2db4fac85178556d839c4bd.png)

![在此处输入图像描述](../Images/c43ced551addaa3c6d31460803c4e7e6.png)

![在此处输入图像描述](../Images/190a0ce119887c8ae5229c67f32f8d52.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:39:33.737

我将 jar 复制到我的项目的 libs 文件夹中。如果它不存在，请制作 libs 目录。进入 Eclipse 选择您的项目，右键单击/刷新（F5 有效？）。您会在文件面板中看到 lib 文件夹。

一旦 lib 显示在您的项目中，进入 project->properties->java build path [add jars]。您应该在该文件夹中看到带有 jar 的 lib 文件夹。选择它，你应该很好。

设置完成后，项目应该会看到它...尝试使用 clean。

![在此处输入图像描述](../Images/fcf9ea478976d44086da6550b75d7b50.png)

![在此处输入图像描述](../Images/8340117e33dafd0da44dce66cc02abd0.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:56:40.547

单击“订购和导入”选项卡并确保选中它旁边的复选框。

**编辑：**

试试这个：请确保您已包含所有这些：

导入 org.ksoap2.*；

导入 org.ksoap2.serialization.KvmSerializable；

导入 org.ksoap2.serialization.Marshal；

导入 org.ksoap2.serialization.PropertyInfo；

导入 org.ksoap2.serialization.SoapObject；

导入 org.ksoap2.serialization.SoapPrimitive；

导入 org.ksoap2.serialization.SoapSerializationEnvelope；

导入 org.ksoap2.transport.AndroidHttpTransport；

导入 org.ksoap2.transport.HttpTransportSE；

导入 org.xmlpull.v1.XmlPullParserException；

希望有帮助！

**最后编辑：** 看来我们已经正确设置了一切。从此源重新下载 jar 文件。我觉得你的说法不正确。这里：http: [//sourceforge.net/projects/ksoap2/](http://sourceforge.net/projects/ksoap2/)

![在此处输入图像描述](../Images/7728e7c7a0019eb019b935503b74ade2.png)

# android - Android：更好的做法是使用全局字符串或带有额外数据的意图？

> ID：10020744
> 
> 赞同：7
> 
> 时间：2012-04-04T23:35:43.320
> 
> 标签：android

在当前的 Android 项目中，我在几个活动之间传递了一些数据。我只是好奇是否有在活动之间发送数据的最佳实践。我有一个字符串，它将根据一项活动的结果进行更新/附加，然后用于 Facebook 共享两项活动。应该将此字符串设置为全局静态字符串，然后共享，还是应该使用传递字符串`intent.PutExtra`？

全局字符串可能代码较少，但意味着另一个静态变量。或者，额外的意图很好，但似乎重复，因为它正在通过几个活动。无论哪种方式都可以，只是想知道一个是否优于另一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-04T23:46:02.383

在我看来，只有 Intent 会起作用。在 Android 上，您的应用程序必须为它被终止的事件做好准备（例如，传入的视频呼叫将其置于后台，并且还消耗大量内存，因此后台应用程序被终止）。当 Android 恢复您的应用程序时，它会重新启动正在显示的 Activity 并重新发送启动它的 Intent，因为这些已保存到持久存储中。但是其他类的状态（包括它们的静态变量）没有保存，如果你不保存它们，就会丢失/重置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T00:05:29.887

您应该始终避免使用全局变量。有时您会需要它们，在大多数情况下，这是由于设计问题。您不应该“因为代码更少”或更容易编码而使用全局变量。顺便说一句，仅属于公共静态变量而不属于常量。全局变量使您的生活更加艰难，因为

*   您的代码更难阅读（该变量来自哪里......它超出了“范围”）
*   更难测试（谁读取变量？谁修改变量？）
*   没有访问控制（没有 getter/setter）
*   穿线
*   还有更多

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:13:35.517

有额外数据的意图。最好传递 getExtras 并且您的父活动已预定义事件以跟踪子活动何时完成。

# python - 如何使用 re.compile 搜索中间有公共区域的字符串

> ID：10020745
> 
> 赞同：0
> 
> 时间：2012-04-04T23:35:43.950
> 
> 标签：python, regex, string, beautifulsoup

我从一个杂乱的 HTML 文件中搜索以下行：

```
 <span id="fooPack1_xpl01_name11">150.00 FTL</span>
    <span id="fooPack1_xpl02_name11">350.00 FTL</span>
    <span id="fooPack1_xpl03_name11">250.00 FTL</span>
    <span id="fooPack1_xpl04_name11">230.00 FTL</span> 
```

我使用 BeautifulSoup 和 re 来搜索和查找字符串：

```
 tags = soup.find_all('span', id=re.compile(r'[fooPack1_xpl04_name11]\d+')) 
```

但很明显，该字符串的共同部分是在开头和结尾，而部分总是在中间变化。如何重组我的搜索模式，以便它搜索“fooPack1_xpl”+（不同的字符串）+“_name11”

谢谢。

// 编辑 //

当我查询以下内容时：

```
 <span id="FullView1_spl02_Stack_4">03/04/12</span>
    <span id="FullView1_spl03_Stack_4">01/03/11</span>
    <span id="FullView1_spl04_Stack_4">02/25/02</span>
    <span id="FullView1_spl05_Stack_4">07/16/04</span>
    <span id="FullView1_spl01_Stack32">999.00 SPL</span>
    <span id="FullView1_spl02_Stack82">150.00 XPP</span>
    <span id="FullView1_spl03_Stack82">350.00 XPP</span>
    <span id="FullView1_spl04_Stack82">450.00 XPP</span>
    <span id="FullView1_spl05_Stack82">550.00 XPP</span>
    <span id="FullView1_spl06_Stack82">650.00 XPP</span>
    <span id="FullView1_spl07_Stack22">888.00 SPL</span>
    <span id="FullView1_spl202_stckFriendName">Red Car</span>
    <span id="FullView1_spl203_stckFriendName">Green Car</span>
    <span id="FullView1_spl204_stckFriendName">Blue Car</span> 
```

和：

```
 foo=soup.findAll('span', id=re.compile(r'FullView1_spl\d+_stack82')) 
```

我得到以下结果：

```
 <span id="FullView1_spl204_stckFriendName">Blue Car</span>
    <span id="FullView1_spl02_Stack82">150.00 XPP</span>
    <span id="FullView1_spl03_Stack82">350.00 XPP</span>
    <span id="FullView1_spl04_Stack82">450.00 XPP</span>
    <span id="FullView1_spl05_Stack82">550.00 XPP</span>
    <span id="FullView1_spl06_Stack82">650.00 XPP</span> 
```

显然，我不需要检测顶部元素。所以这是唯一的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:39:35.027

您快到了。您要搜索`fooPack1_xpl`后跟数字，然后是`_name11`，那么如何：

```
re.compile(r'fooPack1_xpl\d+_name11') 
```

请注意，我只是`\d+`在您期望数字的地方放了一个 for，否则您正在搜索的文字字符串。

# javascript - 有没有办法在文本中获得图像映射样式的行为？

> ID：10020746
> 
> 赞同：0
> 
> 时间：2012-04-04T23:35:47.607
> 
> 标签：javascript, html

还记得图像映射吗？他们在 90 年代到处都是。网页上会有一张图片，当你点击它时，它不仅可以根据图片，还可以根据你点击的确切像素采取一些行动。

现在，假设我在 div 中有一些文本，以等宽字体呈现，排列为 2D 网格。有什么方法可以在 div 上放置一些 Javascript，这样如果我单击该网格中的任何字符，它就会触发一个脚本并为其提供我单击的字符的索引？

我知道我可以通过使用自己的自定义标签围绕网格中的每个字符来强制执行此`<a>`操作，但是有没有更简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:49:03.933

[这是一个 jsfiddle，它证明了这个概念并且似乎有效](http://jsfiddle.net/NTbrR/8/)。每次单击都会将单击的字母的矩阵索引记录到控制台。（它是基于 0 和列，行）

*   将您的文本放入等宽网格
*   将处理程序附加到包含元素的 onClick
*   使用只有 1 个字母的隐藏元素计算单个字母（例如“m”）的尺寸
*   除以单个字母的尺寸以获得您在文本中单击的字母的`event.clientX`坐标`event.clientY`

另请参阅[使用 javascript 计算文本宽度](https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript)。

# javascript - 需要 InnerHTML 解决方案 - 应该很容易回答

> ID：10020750
> 
> 赞同：0
> 
> 时间：2012-04-04T23:35:59.683
> 
> 标签：javascript, variables, innerhtml

我是 JavaScript 新手，所以请理解我的情况。

我创建了一个简单的 HTML 表单，其中包括一个下拉菜单（用于选择项目数量）和一个提交按钮（用于添加到购物车）。

提交后，表单的结果将显示在网页上的表格中。

到目前为止，我的代码可以显示表单选项的结果。

但是，我需要用“qtytoy1”的变量结果替换数量。

这是我的代码。

```
function addToy1New()
{
var i = document.getElementById("qty_toy1");
var qtytoy1 = i.options[i.selectedIndex].text;
var htmlTagString="<table width=\"100%\" border=\"0\">"
                    +"  <tr>"
                    +"    <td>Optimus Prime</td>"
                    +"    <td> x 1</td>"
                    +"    <td>$26.99</td>"
                    +"  </tr>"

                    +"  <tr>"
                    +"    <td></td>"
                    +"    <td>Total:</td>"
                    +"    <td>$26.99</td>"
                    +"  </tr>"
                    +"</table>";

document.getElementById("toy1_add").innerHTML=htmlTagString;
document.getElementById("toy1_test").innerHTML=qtytoy1;
} 
```

如何用我的变量“qtytoy1”替换“$26.99”？

我很确定这种方法有更好的方法。如果您这么认为，请分享，但请确保对于像我这样的新手来说是可以理解的。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:42:59.743

```
var htmlTagString="<table width=\"100%\" border=\"0\">"
                    +"  <tr>"
                    +"    <td>Optimus Prime</td>"
                    +"    <td> x 1</td>"
                    +"    <td>" + qtytoy1 + "</td>"
                    +"  </tr>"

                    +"  <tr>"
                    +"    <td></td>"
                    +"    <td>Total:</td>"
                    +"    <td>" + qtytoy1 + "</td>"
                    +"  </tr>"
                    +"</table>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:41:50.437

您应该能够`replace`在您的字符串上使用该方法：

```
htmlTagString = htmlTagString.replace("$26.99", qtytoy1); 
```

然后从那里继续。

# sql - 使用未选择的值返回 Select 中的合并行

> ID：10020751
> 
> 赞同：2
> 
> 时间：2012-04-04T23:36:00.597
> 
> 标签：sql, oracle, group-by

我有一个格式如下的表：

```
DB_KEY     DB_VALUE
------     --------
row1       value1
row2;1     value2
row2;2     value3
row3       value4
row4;1     value5
row4;2     value6
row4;3     value7 
```

我只想返回 DB_VALUE 列，如果 DB_KEY 的第一部分（分号之前）在任何行上都相同，则将这些行合并在一起。所以上面这个例子的回报是：

```
value1
value2value3
value4
value5value6value7 
```

我想用 group by 做一些事情，但如果没有选择您分组的列，似乎无法使用。IE：

```
SELECT DB_VALUE FROM TABLE GROUP BY REXEP_SUBSTR(DB_KEY, ';', 1, 1) 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:53:40.130

你可以做这样的事情

```
SQL> ed
Wrote file afiedt.buf

  1  with x as (
  2    select 'row1' db_key, 'value1' db_value from dual union all
  3    select 'row2;1', 'value2' from dual union all
  4    select 'row2;2', 'value3' from dual union all
  5    select 'row3', 'value4' from dual union all
  6    select 'row4;1', 'value5' from dual union all
  7    select 'row4;2', 'value6' from dual union all
  8    select 'row4;3', 'value7' from dual
  9  )
 10  select key,
 11         max( sys_connect_by_path(db_value, ' '))
 12             keep( dense_rank last order by curr ) db_value
 13    from (select key,
 14                 db_value,
 15                 row_number() over (partition by key
 16                                        order by db_value) curr,
 17                 row_number() over (partition by key
 18                                        order by db_value) - 1 prev
 19            from (select substr( db_key,
 20                                 1,
 21                                 (case when instr( db_key, ';' ) = 0
 22                                       then length(db_key)
 23                                       else instr( db_key, ';' ) - 1
 24                                   end)) key,
 25                          db_value
 26                     from x))
 27     group by key
 28   connect by prev = PRIOR curr and key = prior key
 29*    start with curr = 1
SQL> /

KEY                      DB_VALUE
------------------------ ------------------------------
row1                      value1
row2                      value2 value3
row3                      value4
row4                      value5 value6 value7 
```

您还可以查看 Tim Hall 的页面，其中列出[了 Oracle 中的各种字符串聚合技术](http://www.oracle-base.com/articles/misc/StringAggregationTechniques.php#row_number)。如果您使用的是 Oracle 11.2，或者您可以创建函数或类型，那么您应该能够生成一个更简单的查询来产生相同的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T06:52:44.847

您可以使用 WM_CONCAT 来实现这一点，但不是每个人都赞成这个功能。您可以使用其他一些连接功能来代替 WM_CONCAT，后者在较新版本的 oracle 中可用。

```
 SELECT DISTINCT (SELECT DISTINCT NVL(WM_CONCAT(DB1.DB_VALUE), DB.DB_VALUE)
                   FROM DB_BUFFER DB1
                  WHERE SUBSTR(DB1.DB_KEY, 0, INSTR(DB1.DB_KEY, ';') - 1) =
                        SUBSTR(DB.DB_KEY, 0, INSTR(DB.DB_KEY, ';') - 1)) AS DB_VALUE
  FROM DB_BUFFER DB 
```

这将检查 DB_KEY 部分的开始（之前；）。如果它匹配，它将所有值连接到一个字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:53:35.683

如果您愿意创建一个 Oracle "group_concat" 聚合函数，那么您可以在查询中使用它来获得所需的结果。如果你搜索 AskTom 和 group concat，你会发现所有的定义。这是一个例子： http: [//kb.yarmakconsulting.com/2008/06/oracle-analog-of-mysql-groupconcat.html](http://kb.yarmakconsulting.com/2008/06/oracle-analog-of-mysql-groupconcat.html)

我想你也可以用分层查询来做到这一点。

# css - WordPress Twitter Bootstrap CSS 插件 - 已更新，现在没有任何效果

> ID：10020752
> 
> 赞同：0
> 
> 时间：2012-04-04T23:36:02.867
> 
> 标签：css, wordpress, plugins, twitter-bootstrap

刚刚将 WordPress Twitter Bootstrap CSS 插件更新到版本 2.0.2.1。

现在我所有的 Bootstrap 样式都消失了。我运行了一个强制错误并返回：

```
Notice: Undefined index: page in /home2/mttwbshc/public_html/wp-content/plugins/wordpress-bootstrap-css/hlt-bootstrapcss.php on line 161 
```

然后我引用了该行，如下所示：

```
$sSubPageNow = $_GET['page'];
        if ( $sSubPageNow == 'hlt-directory') {
            echo '
                ';
        } 
```

这是引用错误页面的问题吗？我是一个 PHP 菜鸟，所以这真的是我最好的猜测。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T09:06:04.033

很抱歉听到您在使用此插件时遇到问题（我是作者）。我不知道为什么它会删除你的设置——也许 WordPress 有一个小故障，然后停用了插件。

该插件目前已编写（v2.0.2.1 及更早版本）以在停用时删除所有插件设置。

在开发中的新版本 2.0.3 中，我已将默认行为更改为在停用时不删除设置，并在配置页面中提供了更改此设置的选项。

希望这将抵消您遇到的问题，并允许更多的灵活性。

一些人也准备了最新版本：- WordPress 的 Twitter Bootstrap LESS 编译器 :)

干杯!

保罗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T13:50:47.680

根据您在此处提出的问题，我已经更新了插件的代码，因此最新版本现在是 2.0.2.3

此更新消除了发生此特定错误的可能性，并且现在在插件停用时也停止删除所有插件选项。用于打开/关闭此特定设置的用户可配置选项将随 2.0.3 一起提供。

当然，如果您有任何建议/问题（http://bit.ly/p4GmWR），很乐意听到您对该插件的任何反馈。

谢谢！保罗。

# mongodb - MongoMapper 靠近 maxDistance - Mongo::OperationFailure：地理值必须是数字：

> ID：10020755
> 
> 赞同：4
> 
> 时间：2012-04-04T23:36:10.113
> 
> 标签：mongodb, geospatial, mongomapper

我正在尝试在 MongoMapper 支持的模型中封装一个带有 maxDistance 的近查询。

我的查询语法一定是在做一些愚蠢的事情。

模型

```
class Site
  include MongoMapper::Document

  key :id, Integer 
  key :name, String
  key :location, Array
  ensure_index [[:location, '2d']]

  def self.nearest(center_point, range)
    where(:location => {'$near' => center_point, '$maxDistance' => range}).all
  end

end 
```

试图在一个点的 200 英里范围内得到所有东西......

> > Site.nearest([-122.0,44.0],200)

```
> Mongo::OperationFailure: geo values have to be numbers: {
> $maxDistance: 200, $near: [ -122.0, 44.0 ] }  from
> /Library/Ruby/Gems/1.8/gems/mongo-1.6.1/lib/mongo/cursor.rb:144:in
> `next'    from
> /Library/Ruby/Gems/1.8/gems/mongo-1.6.1/lib/mongo/cursor.rb:290:in
> `each'    from
> /Library/Ruby/Gems/1.8/gems/mongo-1.6.1/lib/mongo/cursor.rb:308:in
> `to_a'    from
> /Library/Ruby/Gems/1.8/gems/mongo-1.6.1/lib/mongo/cursor.rb:308:in
> `to_a'    from
> /Library/Ruby/Gems/1.8/gems/plucky-0.4.4/lib/plucky/query.rb:74:in
> `all'     from /Users/nick/Code/web/map/app/models/site.rb:40:in
> `nearest'     from (irb): 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-27T08:42:12.383

您可能遇到了[这个](https://jira.mongodb.org/browse/SERVER-1990)需要`$near`并`$maxDistance`首先订购的错误`$maxDistance`。

无论如何，我发现了这个问题，因为我`OperationFailure: database error: geo values have to be number`在使用 PyMongo 时遇到了问题，并且交换顺序修复了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:09:22.220

我猜这实际上是数据问题或索引问题，您的查询看起来正确。

请参阅[http://www.mongodb.org/display/DOCS/Geospatial+Indexing](http://www.mongodb.org/display/DOCS/Geospatial+Indexing) ... MaxDistance 200 可能太大：

> 默认情况下，索引假定您正在索引经度/纬度，因此配置为 [-180..180) 值范围。
> 
> 距离单位与您的坐标系中的相同。

还可以尝试`Site.distinct(:location)`查找任何非数字数据。（或者`Site.query.distinct(:location)`如果您不在 MM 0.11.1 上）。

提示：如果您想查看查询到达 MongoDB 时的样子，请添加`.criteria.to_hash`：

```
Site.where(:location => {'$near' => center_point, '$maxDistance' => range}).criteria.to_hash
# =>
{
  :location=> {
    "$near"        => [-122.0, 44.0],
    "$maxDistance" => 200
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T07:35:52.697

这是另一个解决[方案](https://jira.mongodb.org/browse/PYTHON-292?focusedCommentId=66774&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-66774)

```
{'location' : SON([('$near', [55.55632, 25.13522]), ('$maxDistance', 0.01)])}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-06T20:42:05.837

存储在会话中的数据出现此错误（不同的比赛，php + zf2）：floatval（lat），floatval（lon）解决了这个问题:)我发布它以防有人需要它:)

# ssl - 通过完全记录握手来破坏 TLS 安全性

> ID：10020760
> 
> 赞同：1
> 
> 时间：2012-04-04T23:36:32.200
> 
> 标签：ssl, packet-capture, man-in-the-middle

我最近一直在研究 TLS，我不确定它为什么如此安全，但可能是由于对它的工作原理存在误解。但是如果整个握手被记录下来，无论是使用中间人攻击还是目标计算机上的数据包嗅探器，那么任何剩余的通信都可以被解密，因为您将拥有客户端和服务器用来生成的所有信息加密密钥。

我怀疑 tls 中会有这样的漏洞，但是谁能告诉我 tls 如何防御这个漏洞？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:44:15.443

客户端在 TLS 握手中发送到服务器的关键数据使用服务器的[公钥](http://en.wikipedia.org/wiki/Public-key_cryptography)进行加密。因此，即使数据包在网络上被捕获，它也需要私钥（假定只有服务器知道）来解密数据包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:37:14.110

握手的主要目的是确保双方共享的预主密钥的秘密交换（然后导致共同的主密钥和共享的加密密钥）。

如何做到这一点取决于密码套件以及使用的密钥交换算法。使用认证密钥交换，主要有两种变体：

*   RSA 密钥交换，客户端使用服务器的公钥（从证书中获得）加密预主密钥。
*   [Diffie-Hellman 密钥交换](http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange)，客户端使用服务器的公钥验证服务器的签名 DH 参数。

您可能对这些链接感兴趣：

*   [TLS 1.1：身份验证和密钥交换](https://www.rfc-editor.org/rfc/rfc4346#appendix-F.1.1)（不是匿名密钥交换）
*   [为什么第一个证书在 x.509 中有一个 RSA 公钥？](https://security.stackexchange.com/q/13930/2435)
*   [如何在 ssl 密钥交换期间查看 Wireshark 中的加密密钥？](https://stackoverflow.com/q/10245473/372643)
*   [为什么 ssl 密钥交换采用不同的密钥交换技术？](https://security.stackexchange.com/q/14081/2435)（参见关于*临时*Diffie-Hellman 的讨论）。

# node.js - 节点中的哪些操作是线程安全的？

> ID：10020761
> 
> 赞同：12
> 
> 时间：2012-04-04T23:36:35.643
> 
> 标签：node.js

我正在使用[这种方法](https://stackoverflow.com/questions/2219333/nodejs-in-memory-storage)将数据存储在托管 http 服务器的全局数组中，其中某些请求将操纵全局数组。

我有点担心遇到某些操作的线程问题——主要是`push`和`splice`. 我想如果一个请求让我遍历数组并根据条件删除项目，而另一个请求让我调用`.push()`我会遇到问题的数组。谁能证实这一点？

我主要在 C# 中编写，即使是简单的增量也不是线程安全的（启动 25 个执行 i++ 的线程，并不能保证 i == 25 毕竟说完了）。

**更新**：

我写了 5 个例子来证明我在说什么。测试 1 和测试 3 工作正常。测试 2 失败，因为……通常称为线程问题（无论它们是否是实际的 CPU 线程）。测试 4 和 5 在并行运行时似乎有效（这意味着它们没有像测试 2 那样的碰撞问题）。

**[http://pastebin.com/HcJHTDFY](http://pastebin.com/HcJHTDFY)**

我正在使用 ApacheBench 进行测试，发出 1000 个并行请求。

这让我相信测试 1 和测试 3 工作正常，因为 nodejs 不会在并行 javascript 函数中并行执行超过 1个~~回调~~~~实例`app.get('/test3'...)`~~（阻塞？）。一旦你实现了一个 setInterval/setTimeout，它就会释放 nodejs 来执行另一个回调实例（非阻塞？）。

我真的只是想了解到底是什么`non-blocking I/O model`意思。这是否意味着“嘿，如果您需要非阻塞，可以使用 setTimeout 和 setInterval 进行非阻塞，否则我们将阻止任何其他外层函数运行，直到我们用完我们正在使用的函数” ? 我觉得有必要知道这一点，这样我就不会陷入困境，以为我可以实现 /test2 之类的东西并且完全安全。

另外，如果我试图不阻塞我的回调，我真的应该打电话`setTimeout(code, 1)`吗？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-04T23:39:47.867

都是线程安全的。

没有线程，JavaScript 是单线程的，两条 javascript 语句不可能同时运行。

顺便说一句，你不应该使用全局变量，因为全局变量是邪恶的

**编辑：**

测试 2 失败，因为您使用的是异步回调，这意味着控制权返回到节点并且它可以处理更多请求。如所见，这会产生竞争条件。

在节点中，任何不是异步块的东西。您拥有的唯一异步内容是 setTimeout/setInterval/process.nextTick 和任何异步 IO 操作。

不应该手动使计算异步。一个人应该避免做太多的计算。

我写了一篇关于[非阻塞意味着什么的文章](http://raynos.org/blog/13/What-it-means-to-be-non-blocking-in-node.)

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-04-05T00:29:23.603

Raynos 基本上是正确的。但是仅仅因为 JavaScript 是单线程的并不意味着你可以放松警惕。您仍然需要了解线程。一个很好的例子来说明这一点，socket.io 如何与不同的客户端保持连接，并且仍然能够跟踪这些客户端。

JavaScript 的函数式编程部分通过变量绑定工作（比如...很多）。不了解线程会使您错误地假设您的变量是正确绑定的。就像 socket.io 的例子一样，你怎么能确定你得到的连接是你认为你得到的客户端？如果引用绑定出错并且连接实际上引用了不同的客户端怎么办？

这是您需要注意的事情类型。

# php - 使用 $echo 的 php 非英文字符

> ID：10020762
> 
> 赞同：2
> 
> 时间：2012-04-04T23:36:36.830
> 
> 标签：php

在 PHP 中，我想使用打印**杜塞尔多夫**

```
 echo 'Düsseldorf'; 
```

然而，结果却是像这样**的杜塞尔多夫**

请建议我应该怎么做才能打印大部分非英文的欧洲字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-04T23:38:31.827

PHP、文件和 HTML 编码应该相同。

对于 PHP：

```
<?php header('Content-Type: text/html; charset=utf-8'); ?> 
```

检查文本编辑器的编码。

对于 HTML：

```
<meta charset=utf-8> 
```

快速而肮脏的方式：

```
echo 'D&uuml;sseldorf ist eine sch&oouml;ne Stadt!';
// Düsseldorf ist eine schöne Stadt! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:39:04.020

如果您能够将其指定为常量，请执行以下操作。

```
$echo 'D&#252;sseldorf'; 
```

有关详细信息，请参阅此处的图表：[http ://www.ascii.cl/htmlcodes.htm](http://www.ascii.cl/htmlcodes.htm)

每个可打印的字符都有一个对应的 HTML 实体。

# python - time.clock 和 time.strftime 给出完全不同的结果

> ID：10020764
> 
> 赞同：1
> 
> 时间：2012-04-04T23:36:39.387
> 
> 标签：python, time, sleep

我的程序在每个循环中进行一次测量并休眠指定的时间，在本例中为 10 秒。它还测量时间。它以两种方式测量时间。一次使用 time.strftime，另一次使用 time.clock()。在我的大多数计算机上，这些结果是完全一致的，我没有任何问题。在一台计算机上，他们根本不同意。

这是有问题的代码段。在我的程序中，它在三个线程中独立运行。self.delay 是一个浮点数，包含用户指定的延迟，在本例中为 10.0 秒。

```
 cycles = 0
    startTime = time.clock()
    while(blah)
        cycleBeginTime = time.clock()
        ...

        t = time.strftime("%Y-%m-%d %H:%M:%S")

        ...

        cycles += 1
        cycleEndTime = time.clock()
        wakeUp = startTime + cycles * self.delay

        if cycleEndTime > wakeUp:  #we overslept
            continue
        else:
            #not guaranteed to sleep for the exact specified amount of time
            time.sleep(float(wakeUp - cycleEndTime))
        afterSleepTime = time.clock()
        print ("sleep(" + str(wakeUp - cycleEndTime) + ") lasted " +
               str(afterSleepTime - cycleEndTime) +" seconds\n" +
               "Total time for this cycle: " +
               str(afterSleepTime - cycleBeginTime) +
               "\ntime from start of cycle to sleep " +
               str(cycleEndTime-cycleBeginTime) ) 
```

这是控制台上使用 time.clock 测量的时间结果。跳到下一部分进行总结。

```
sleep(9.8107975515) lasted 4.31354512806 seconds
Total time for this cycle: 4.50274184753
time from start of cycle to sleep 0.189196719463
sleep(9.83803382537) lasted 4.35964227608 seconds
Total time for this cycle: 4.5216022856
time from start of cycle to sleep 0.161960009523
sleep(9.83973893539) lasted 4.36409510551 seconds
Total time for this cycle: 4.52435043356
time from start of cycle to sleep 0.160255328054

sleep(15.3537603228) lasted 5.42625884166 seconds
Total time for this cycle: 5.56417636459
time from start of cycle to sleep 0.137917522931
sleep(15.3879203849) lasted 5.45131225502 seconds
Total time for this cycle: 5.5384287755
time from start of cycle to sleep 0.0871165204752
sleep(15.3801304296) lasted 5.45686671345 seconds
Total time for this cycle: 5.55443364994
time from start of cycle to sleep 0.0975669364944

sleep(19.7024141096) lasted 2.5903386547 seconds
Total time for this cycle: 2.81485116786
time from start of cycle to sleep 0.224512513157
sleep(19.7236584582) lasted 2.61606277881 seconds
Total time for this cycle: 2.81505236078
time from start of cycle to sleep 0.198989581976
sleep(19.7569903213) lasted 2.64424758408 seconds
Total time for this cycle: 2.8228942459
time from start of cycle to sleep 0.178646661821

sleep(26.8608515814) lasted 3.1923968974 seconds
Total time for this cycle: 3.44044448649
time from start of cycle to sleep 0.248047589093
sleep(26.9264651571) lasted 3.24803654453 seconds
Total time for this cycle: 3.42464766929
time from start of cycle to sleep 0.176611124756
sleep(26.9123819307) lasted 6.19344847627 seconds
Total time for this cycle: 6.39064386998
time from start of cycle to sleep 0.197195393715

sleep(30.50445713) lasted 11.3544706882 seconds
Total time for this cycle: 11.5452852063
time from start of cycle to sleep 0.190814518069
sleep(30.5479180492) lasted 11.4011029222 seconds
Total time for this cycle: 11.5583578442
time from start of cycle to sleep 0.157254922059
sleep(30.5384771841) lasted 11.3943939803 seconds
Total time for this cycle: 11.5739287254
time from start of cycle to sleep 0.179534745126

sleep(29.032023896) lasted 9.57638019147 seconds
Total time for this cycle: 9.6907935091
time from start of cycle to sleep 0.114413317628
sleep(28.9997437096) lasted 9.55454254173 seconds
Total time for this cycle: 9.70431450053
time from start of cycle to sleep 0.149771958799
sleep(29.0315669415) lasted 9.57838381284 seconds
Total time for this cycle: 9.69044695504
time from start of cycle to sleep 0.112063142198

sleep(29.2684610421) lasted 11.5343751591 seconds
Total time for this cycle: 11.7100907949
time from start of cycle to sleep 0.175715635808
sleep(29.4380200767) lasted 11.7063676658 seconds
Total time for this cycle: 11.7231073229
time from start of cycle to sleep 0.01673965716
sleep(29.2840066914) lasted 11.5395576362 seconds
Total time for this cycle: 11.7081641622
time from start of cycle to sleep 0.168606525989 
```

这是使用 time.strftime 获取的时间戳的摘要，与 time.clock 的测量值和尝试的睡眠时间进行比较。

```
2012-04-04 17:22:07
2012-04-04 17:22:17 (diff 10s. Attempted sleep time 10s   time.clock says 4.5s)
2012-04-04 17:22:32 (diff 15s. Attempted sleep time 15.4s time.clock says 5.4s)
2012-04-04 17:22:52 (diff 20s. Attempted sleep time 19.7s time.clock says 2.8s)
2012-04-04 17:23:46 (diff 54s. Attempted sleep time 27s   time.clock says 3.4s)
2012-04-04 17:24:16 (diff 30s. Attempted sleep time 30.5s time.clock says 11.5s)
2012-04-04 17:24:45 (diff 29s. Attempted sleep time 29s   time.clock says 9.7s)
2012-04-04 17:25:15 (diff 30s. Attempted sleep time 29.4s time.clock says 11.7s) 
```

如您所见， time.strftime 最同意 sleep ，但不是所有时间（他们在 2012-04-04 17:23:46 不同意），而 time.clock 一直完全是胡说八道。有什么东西会导致这两个函数给出完全无意义的结果吗？

编辑：为简洁起见，完全重写了帖子。

编辑：嗯，我有一个解决方案，但我不明白为什么。 [这个页面](http://docs.python.org/library/time.html)说 time.clock() 在 Windows 下使用时给出挂钟时间，但在 Unix 下使用时给出 CPU 时间。此后删除他帖子的回答者之一错误地说 time.clock() 是 CPU 时间，但我想知道他是否可能是正确的，尽管有文档。当我将所有对 time.clock() 的调用替换为对 time.time() 的调用时，我的程序现在甚至可以在有问题的计算机上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:28:08.593

行为不端的 PC 是否具有多核 CPU？在 3.2 之前，可能会出现这样一种情况：一个线程被设置为一个内核，会释放 GIL，而在分配给另一个内核的另一个线程可以获得 GIL 之前，第一个线程已经重新获取它。有关更多详细信息，请参阅[此帖子](http://mail.python.org/pipermail/python-dev/2009-October/093321.html)。

更新：

再多一点研究表明，`time.clock`并不`time.time`一定使用同一个时钟来测量时间。正如您所发现的，解决方案是选择一个或另一个，然后只使用那个。您需要进行一些测试，看看哪个提供了最佳稳定性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:00:47.580

考虑到任何应用程序的睡眠或定时器功能不正确，解决此问题的最佳方法是使用时间戳和目标执行时间。

因此，将目标时间设置为 EPOCH + ExecuteTime，将间隔设置为一个较小的数字但不要太小以避免不必要的循环。然后你在循环中检查执行时间的部分是如何检查它。

您知道应用程序何时会挂起一毫秒吗？它不会根据启动的实际时间验证超时等，它只是相信它从中断的地方继续。

# ruby-on-rails - Rails：如何使用 Devise 将注册限制为管理员

> ID：10020766
> 
> 赞同：4
> 
> 时间：2012-04-04T23:37:17.927
> 
> 标签：ruby-on-rails, ruby, devise

我正在尝试将注册限制为 Devise 管理员。如果可能的话，我想暂时避免使用 CanCan。我已经创建了一个单独的 Devise Admin 模型，如选项 #1 中所述：[https](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-Role) ://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-Role 。

接下来，我为用户设置了一个 CRUD 界面，如下所述：[https](https://github.com/plataformatec/devise/wiki/How-To:-Manage-users-through-a-CRUD-interface) ://github.com/plataformatec/devise/wiki/How-To:-Manage-users-through-a-CRUD-interface 。

我想通过`before_filter :authenticate_admin!`在用户控制器中使用类似的东西来限制新注册，但由于某种原因，它不限制新注册。

我的 routes.rb 看起来像这样：

```
devise_for :admins
devise_for :users, :path_prefix => 'd'
resources :admins
resources :users, :controller => "users" 
```

有什么想法为什么`before_filter :authenticate_admin!`不限制新注册？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T00:38:54.443

您不能`before_filter :authenticate_admin!`在用户控制器中使用，因为 admin 和 user 在您的应用程序中是两个不同的模型。

我不知道我是否完全理解你的意思，但如果你不想接受用户（或管理员）的新注册，你可以这样做：

```
# in your User(Admin) model
devise :registerable # remove :registerable 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T00:45:12.783

我正在寻找类似的东西；完全禁用新注册。我在某处的邮件列表中找到了这个，虽然它解决了我的问题，但它可能是你的一个不错的起点：

```
class RegistrationsController < Devise::RegistrationsController 
  def new
    flash[:failure] = t('registrations.registrations_disabled')
    redirect_to root_path
  end
end 
```

也许类似的东西，但添加一个检查，看看 current_user 是否是管理员，然后基于此重定向......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-01T14:24:34.623

我想了一会儿，终于想到了这个。

devise 创建的每个模型都有一个辅助函数

```
class UsersController < Devise::RegistrationsController

  before_filter :authenticate_admin!

  def new
    if admin_signed_in?
      super
    else
      redirect_to admin_session_path
    end
   end 
```

希望这可以帮助。它就像一个魅力:)

# php - 用php检查日期差异

> ID：10020772
> 
> 赞同：-1
> 
> 时间：2012-04-04T23:37:39.737
> 
> 标签：php

> **可能重复：**
> [如何使用 PHP 计算两个日期之间的差异？](https://stackoverflow.com/questions/676824/how-to-calculate-the-difference-between-two-dates-using-php)

我如何检查 php，与以下给定 php 变量的日期差异？

```
$year = 2012;
$month = 5;
$day = 20;
$hour = 23;
$min = 15;
$sec = 0; 
```

**我想要做什么**

我想将上面显示的 php 变量与实际当前时间进行比较，然后输出当前时间和 php 变量之间的差异，以天甚至小时为单位？在 php 中做这样的事情的最好和最快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:42:01.373

从这些变量构建一个日期字符串。使用[DateTime](http://www.php.net/manual/en/class.datetime.php)对象并使用它的函数来执行您想要的操作，例如 $dateTime->diff(new DateTime("now")) 并阅读 DateInterval 以了解如何取回您想要的。

编辑：这假设你有 PHP 5.3。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:42:59.470

[时间](http://php.net/manual/en/function.mktime.php)

```
$time_diff = mktime($hour, $min, $sec, $month, $day, $year) - time(); 
```

将在几秒钟内为您提供差异。您可以根据需要使用它来显示它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T23:46:41.330

用于`mktime`转换为 UTC，然后使用简单的数学计算差异。

# java - 无法返回数据

> ID：10020773
> 
> 赞同：0
> 
> 时间：2012-04-04T23:38:15.873
> 
> 标签：java, android, json, listview, append

我从 HttpGet 返回数据，然后使用适配器将字符串传递到 Listview 中。问题是，在我将数据返回到字符串之后，Eclipse 不允许我返回数据。

错误：无效方法无法返回值。

代码：

```
public class ChatService extends ListActivity {
    /** Called when the activity is first created. */

    BufferedReader in = null;
    String data = null;
    List headlines;
    List links;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        try {
            ContactsandIm();
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (URISyntaxException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        CheckLogin();
    }

    private void CheckLogin() {
        // TODO Auto-generated method stub
        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();

        /* login.php returns true if username and password is equal to saranga */
        HttpPost httppost = new HttpPost("http://gta5news.com/login.php");

        try {

            // Execute HTTP Post Request
            Log.w("HttpPost", "Execute HTTP Post Request");
            HttpResponse response = httpclient.execute(httppost);

            String str = inputStreamToString(response.getEntity().getContent())
                    .toString();
            Log.w("HttpPost", str);

            if (str.toString().equalsIgnoreCase("true")) {
                Log.w("HttpPost", "TRUE");
                try {
                    Thread.sleep(250);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                // put intent here(21/3/12);

            } else {
                Log.w("HttpPost", "FALSE");

            }

        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private StringBuilder inputStreamToString(InputStream is) {
        String line = "";
        StringBuilder total = new StringBuilder();
        // Wrap a BufferedReader around the InputStream
        BufferedReader rd = new BufferedReader(new InputStreamReader(is));
        // Read response until the end
        try {
            while ((line = rd.readLine()) != null) {
                total.append(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        // Return full string
        return total;
    }

    public void ContactsandIm() throws URISyntaxException,
            ClientProtocolException, IOException {
        headlines = new ArrayList();

        // TODO Auto-generated method stub
        BufferedReader in = null;
        String data = null;

        HttpClient get = new DefaultHttpClient();
        URI website = new URI("http://www.gta5news.com/test.php");
        HttpGet webget = new HttpGet();
        webget.setURI(website);
        HttpResponse response = get.execute(webget);
        Log.w("HttpPost", "Execute HTTP Post Request");
        in = new BufferedReader(new InputStreamReader(response.getEntity()
                .getContent()));
        StringBuffer sb = new StringBuffer("");
        String l ="";
        String nl = System.clearProperty("line.seperator");
        while ((l =in.readLine()) !=null) {
            sb.append(l + nl);  
        }
        in.close();
         data = sb.toString();
        return data;

        headlines.add(sb);

        ArrayAdapter adapter = new ArrayAdapter(this,
                android.R.layout.simple_list_item_1, headlines);

        setListAdapter(adapter);

    }

    // end bracket for "ContactsandIm"

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:41:36.453

您不能在`void`方法中返回任何内容。如果您希望返回一个`ContactsandIm()`. 此外，调用将退出该方法，因此返回后的任何代码都是死代码。`String``String``return x`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:42:13.763

`ContactsAndIm`在你做完之后在`data = sb.toString();`你的函数中`return data;`摆脱它，你应该没问题。不是eclipse，是java编译器告诉你不能在带有void签名的函数中返回值

# r - 如何从 R 中的这个函数构造这个列表？

> ID：10020777
> 
> 赞同：0
> 
> 时间：2012-04-04T23:39:15.447
> 
> 标签：r, list

我有一个函数`h(n)`返回每个整数 1 =< n =< k 的值。

如何构建`(h(1), h(2), h(3), ...)`k 较大的表单列表，因此手动执行此操作需要一些时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:44:07.040

如果没有你的函数，我不确定，但`lapply(1:k, h)`应该取 1 到 k 之间的每个值并将其发送到你的函数并在列表中返回它们。

```
> h <- function(n) return(1:n)
> lapply(1:5, h)
[[1]]
[1] 1

[[2]]
[1] 1 2

[[3]]
[1] 1 2 3

[[4]]
[1] 1 2 3 4

[[5]]
[1] 1 2 3 4 5 
```

PS这不是作业吧？

# boost - 增加编译和运行 Firebreath 的奇怪故障

> ID：10020778
> 
> 赞同：4
> 
> 时间：2012-04-04T23:39:15.487
> 
> 标签：boost, firebreath

我今天在 Firebreath 中发现了一个非常奇怪的错误。我试图编译我的项目，`make`在我的构建目录上做一个。我得到了一个[巨大的输出](http://pastebin.com/Pr76ffZe)，有很多错误。我尝试从头开始运行一个新项目，但出现以下错误：

```
alucard@hell ~/Documentos/sc/build
> make
[  1%] Built target FireBreath_Cmake
[  2%] Building CXX object boost/libs/thread/CMakeFiles/boost_thread.dir/src/tss_null.cpp.o
  In file included from /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/boost/thread/detail/platform.hpp:17:0,
             from /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/boost/thread/detail/config.hpp:20,
             from /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/libs/thread/src/tss_null.cpp:7:
   /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/boost/config/requires_threads.hpp:29:4: error: #error "Threading support unavaliable: it has been explicitly disabled with BOOST_DISABLE_THREADS"
  In file included from /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/boost/thread/detail/config.hpp:20:0,
             from /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/libs/thread/src/tss_null.cpp:7:
    /home/alucard/Documentos/sc/firebreath/src/3rdParty/boost/boost/thread/detail/platform.hpp:67:9: error: #error "Sorry, no boost threads are available for this platform."
make[2]:  [boost/libs/thread/CMakeFiles/boost_thread.dir/src/tss_null.cpp.o] Error 1
make[1]:  [boost/libs/thread/CMakeFiles/boost_thread.dir/all] Error 2
make:  [all] Error 2 
```

我的系统似乎有问题，但如果我尝试以下示例，我不会收到任何错误：

```
#include <boost/thread.hpp>

int main(int argc, char *argv[]) {
    return 0;
} 
```

编译：`g++ test.cpp -pthread -lboost_thread`。

任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T03:37:01.957

为了解决我的问题，我必须做两件事：

1.  [将此](https://stackoverflow.com/a/8297708/992347)补丁应用于我`libstdcpp3.hpp`位于`src/3rdParty/boost/boost/config/stdlib`.
2.  删除我的构建目录并重新运行`prepmake.sh`.

再次感谢@taxilian 提供快速有用的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T04:49:42.337

尝试删除您的构建目录并重新运行 prepmake.sh；鉴于有多少其他人在使用 FireBreath 而没有遇到此问题，我只能猜测它并不是真正的 firebreath 错误，因此该错误很可能与 build/ 目录中的某些内容有关。

# mysql - 带有条件的 grails findAll 或 executeQuery

> ID：10020782
> 
> 赞同：1
> 
> 时间：2012-04-04T23:39:41.317
> 
> 标签：mysql, hibernate, grails, groovy, subquery

我一直在这方面花了一些时间。我的问题涉及带回具有某些标准和条件的域对象：

我有一大堆自行车。有可能拥有多辆车轮尺寸相似的自行车。例如我可以有 5 辆自行车：

```
owner_id | bike | wheel | price | active | toolset | forLance
_________|______|_______|_______|________|_________|__________
15459    |liner |    12 |  100  |     Y  |   null  |   H       
15459    |larker|    15 |  150  |     Y  |   null  |   H      
15459    |jefro |    21 |  225  |     Y  |   null  |   H      
15459    |raz   |    21 |  230  |     Y  |   null  |   L      
15459    |jynx  |    21 |  295  |     Y  |   null  |   P 
```

我在下面的查询检索了所有车轮尺寸不重复且价格最低的自行车。

MySQL查询：

```
select * from bike b 
where b.owner_id = 15459 
and not exists( select * from bike 
where wheels = b.wheels AND price < b.price 
and owner_id = b.owner_id)  and b.active = 'Y'; 
```

结果会给我自行车的行：**liner、larker 和 jefro**。

在 grails//groovy 中是否有等效的方法来执行此操作？（**将 liner、larker 和 jefro 获取**到域对象列表中）

我尝试过使用如下结构：

```
def bikes = Bike.executeQuery(...)
or
def bike = Bike.findAll(...) 
```

但我似乎无法执行与我制作的 MySQL 脚本结构相似的查询。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T09:51:11.737

在您的 MySQL 中，您使用子查询来检索数据。AFAIK 这对于 GORM 是不可能的。你可以做的是用[Hibernate Query Language (HQL)编写它](http://grails.org/doc/latest/guide/GORM.html#hql)

假设您的域类称为 Bike。

```
Bike.findAll("from Bike as b where b.active = 'Y' and b.owner = :owner and b.id in elements(select b1.id from Bike where b1.owner = :owner and b1.active = 'Y' and b1.price < b.price)", ['owner':owner]) 
```

# excel - Excel VBA：获取单元格的值，与单元格的格式无关

> ID：10020783
> 
> 赞同：10
> 
> 时间：2012-04-04T23:39:43.467
> 
> 标签：excel, vba

在 Excel VBA 中，`Range("A1").Value`应返回工作表上范围 A1 的基础值。但是，如果单元格格式为“会计”，我会得到不同的值。

如何获得单元格的实际基础价值？

**工作表**

创建一个新文档，在单元格中输入以下值：

*   A1：0.00001
*   A2：=A1
*   A3：=A1=A2

如您所料，A3 结果为`TRUE`. 现在将 A2 的格式更改为会计，使用 2 个小数位。A2 现在读取`$ 0.00`，但基础值仍然存在`0.00001`，所以 A3 仍然存在`TRUE`。

**VBA**

创建一个新模块并添加以下功能：

```
Function f(addr As String)
    f = Range(addr).Value
End Function 
```

如您所见，这只是使用对象的`Value`方法获取范围的值`Range`。

**工作表**

回到工作表。输入以下值：

*   B1: =f("A1")
*   B2: =f("A2")
*   B3：=B1=B2

`A1`并且`A2`具有相同的基础价值，但`B1`和`B2`不具有相同的基础价值，即使它们都是使用 和 的`Value`方法计算`A1`的`A2`。

`A3`( ) 中的表达式正在访问and`=A1=A2`的实际基础值。如何在 VBA 中访问这些值？`A1``A2`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-04T23:58:26.240

它最初对我来说也是正确的，因为我在输入公式后添加了格式。

复制 - 重新编辑 B2。

要获得基础值，您需要使用似乎忽略格式的 VALUE2 属性：

```
Function f(addr As String)
    f = Range(addr).Value2
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T01:57:27.503

[Dick 博客上](http://www.dailydoseofexcel.com/archives/2009/10/08/the-currency-format/)的这篇文章很好地涵盖了将 VBA 和 Value 与超过 4 个小数点的货币格式单元格一起使用的问题

> 如果您在 Excel 中的无格式单元格中键入一个数字，该数字将存储在 Double 数据类型中。格式化该数字时，会以特定方式显示它，但不会更改数字。例如，如果将数字 1 格式化为逗号样式，则会得到 1.00。基础数据仍然是 1，只是显示方式不同。日期格式和货币格式是此规则的两个例外。
> 
> 当您将某些内容格式化为日期或货币时，您实际上更改了基础数据类型（存储在 Value 属性中的值）。对于 Date 格式，这是语义，因为您可以在 Date 和 Double 数据类型之间切换，而无需对数据进行任何更改。与货币数据类型无关。Currency**仅支持四位小数**，因此将带有五位小数的 Double 插入 Currency 数据类型将导致不同的数字。

# tcl - 跳回到不同的 Tcl 堆栈帧

> ID：10020785
> 
> 赞同：3
> 
> 时间：2012-04-04T23:40:13.730
> 
> 标签：tcl

有没有一种简单的方法可以在 Tcl 中展开堆栈？我有一个奇怪的问题，我必须回到一个特定的堆栈帧，字面意思。我可以使用`info`命令获取所有帧信息，但要实际获取特定帧，我必须在每个过程中设置一些局部变量并相应地检查它们。我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T10:40:49.897

如果您需要获取代码来执行非本地返回（即，跳过几个级别），您可以从 8.5 开始`-level`使用`return`. 看这个例子：

```
proc foo-a {} {
    puts a-in
    foo-b
    puts a-out
}
proc foo-b {} {
    puts b-in
    foo-c
    puts b-out
}
proc foo-c {} {
    puts c-in
    foo-d
    puts c-out
}
proc foo-d {} {
    puts d-in
    bar
    puts d-out
}
proc bar {} {
    puts bar-in
    return -level 3
    puts bar-out
}
foo-a 
```

这是通过抛出一种特殊的异常来实现的；细节相当隐蔽。或者，如果您有 8.6 或它们的脚本实现，您也可以使用`try`（`throw`请参阅[Tcler 的 Wiki](http://wiki.tcl.tk/21608#pagetocb8310c43)，了解在讨论 8.6 中的代码期间使用的 Tcl 代码）。

对于较旧的 Tcl 版本，最简单的机制是使用`return -code 42`并将一些代码放置`catch`在自定义异常的堆栈上，并确定它是否是魔法值（这里是 42；它将是 的结果`catch`）并适当地响应。这可能非常有效，但也很混乱。这就是为什么 8.5 及更高版本为您提供更易于使用的工具的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T00:26:44.450

简短的回答是你可能会更好地重新考虑你的设计。

更长的答案是，唯一真正的方法（我能想到的）是抛出一个错误并将其重新捕获到您需要停止它的级别。当然，除了在调用堆栈中一直检查变量的不那么火爆的方式。然而，对控制流使用错误是……不好的形式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:34:33.563

如果您愿意成为最前沿的人，协程（在 8.6 中可用）可能会满足您的需求。

否则，您可能会尝试记录您在那里时需要达到的例程级别（即，将全局变量设置为 [info level]），然后在更深的 proc 中，[uplevel] 到那个绝对堆栈帧。就像是

```
proc need-to-be-here {} {
   set ::myframe [info level]
   deeper-calls
}

proc deepest-call {} {
   uplevel #$::myframe {what I need to do}
} 
```

（未经测试）

# c# - 如何从视图模型中发布对象？

> ID：10020786
> 
> 赞同：2
> 
> 时间：2012-04-04T23:40:54.667
> 
> 标签：c#, asp.net-mvc-3, razor, viewmodel

我希望这会起作用:(调试时隐藏的输入似乎指向一个对象，但在帖子中没有任何显示。这是我尝试过的（请注意，为了简洁起见，这是一个示例）

模型

```
public class myViewModel
{
 public MyObject MyObject { get; set; }
 public int MyNumber { get; set; }
} 
```

控制器

```
public ActionResult displaySimpleView()
{
 var mVM = new myViewModel();
 mVM.MyObject = //let MyObject be filled with 10 fields of data
 return View(mVM);
} 
```

看法

```
@model namespace.myViewModel

//display the fields of data

@using (Ajax.BeginForm("Complete", ajaxOpts))//simple Ajax Options not really relevant
{
@Html.ValidationSummary(true)

@Html.HiddenFor(m => m.MyObject)
@Html.EditorFor(m => m.MyNumber)

<p><input type="submit" value="Go" /></p>
} 
```

再次控制器

```
[HttpPost]
public ActionResult getMyObject(myViewModel mVM)
{
 mVM.MyObject is null here.
 mVM.MyNumber has a value.
 return RedirectToAction("someGetAction");
} 
```

如何将 MyObject 传递给 getMyObject？我宁愿不必为每个属性都有一个隐藏字段，然后重新映射，因为其中一些属性是嵌套对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:01:23.957

看法：

```
@{
  TempData["passMyObject"] = Model.MyObject;
 } 
```

控制器岗位：

```
var myObject = TempData["passMyObject"]; 
```

# c - 将包含大写字母的字符串转换为小写字母

> ID：10020798
> 
> 赞同：-1
> 
> 时间：2012-04-04T23:42:13.933
> 
> 标签：c, ascii

我需要能够在字符串中转换大小写，这样`"Hello"`就变成了`"hello"`. 最终，我需要比较它们。

我将如何转换：

```
char *string = "HEllO"; 
```

到字符串`"hello"`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-04T23:44:38.753

首先，您的字符串没有正确声明，它应该是：

```
char *string = "Hello"; 
```

现在，要转换为小写，试试这个：

```
char *lowercase(const char *str)
{
    int length = strlen(str);
    char *dup = malloc(length + 1);
    strcpy(dup, str);

    for (int i = 0; i < length; i++)
    {
         dup[i] = tolower(dup[i]);
    }

    return dup; // remember to free when done!
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:49:26.930

只需内联执行此操作。

```
 char string[] = "Hello";
   char * ptr;

   for (ptr = string; *ptr != '\0'; ++ptr)
   {
       *ptr = tolower(*ptr);
   } 
```

# java - 初始化实例变量以在方法外使用

> ID：10020800
> 
> 赞同：0
> 
> 时间：2012-04-04T23:42:16.157
> 
> 标签：java

我的一种方法中有一个名为“数量”的变量，但我需要在另一种方法中引用它。我不确定使用的语法。

这是代码：

```
public static void startup()
{
    String message = "Welcome to Toronto Mutual!";
    //prompts user to enter their employee ID
    String logIn = JOptionPane.showInputDialog("Please enter your employee `enter code here`ID.");
    int employeeID = Integer.parseInt(logIn);

    String input = JOptionPane.showInputDialog("Please enter the transaction `enter code here`type, bank ID and amount all separated by a comma.");
    input=input.toUpperCase();
    if (input.equals("END")){
        JOptionPane.showMessageDialog(null,"Goodbye.");
        System.exit(0);
    }
    else
    {
        int balance = 100;
        String []transaction = new String[3];
        transaction = input.split(",");
        String type = transaction[0]; 
        int bankID = Integer.parseInt(transaction[1]);
        type=type.toUpperCase();
... // there's more but it's irrelevant 
```

如何在方法之外使用变量“amount”和“bankID”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T16:56:19.383

两种方式：

1.  通过参数传递`amount`给另一个方法

    `private void otherMethod(int amount) {...}`

2.  创建一个实例变量，以便您可以在类范围内访问它

    `private int amount;`

    如果你走这条路线，最好使用getter和setter。

    ```
    public int getAmount() {
        return amount;
    }

    public void setAmount(int amount) {
        this.amount = amount;
    } 
    ```

# php - PHP 函数和 SQL 访问分层

> ID：10020801
> 
> 赞同：1
> 
> 时间：2012-04-04T23:42:18.223
> 
> 标签：php, mysql, sql

我正在重写一个 php 文件，该文件从 MYSQL 数据库中获取人员及其详细信息并将其分层（以防止黑客攻击等......）

我正在编辑的 PHP 文件是这样的：

```
<div id='idLeft'>
<?php
@session_start();
$_SESSION['auth'] = 'ok';
$db_server = "localhost";
$db_user = "username";
$db_pass = "******";
$db_database = "mydatabase";
    $db_con = @mysql_connect($db_server, $db_user, $db_pass);
if(!$db_con) die("Database error!");
if(!@mysql_select_db($db_database, $db_con)) die("Database error!");
mysql_query("SET NAMES UTF8");

$query = "SELECT osobaID,ime,prezime FROM ssa_osoba";
$rs = mysql_query($query);
$i=0;
while( $row = mysql_fetch_assoc($rs)) {
?>
<div class='osoba'>
    <div class="brojosobe">
    <span class="otekst"><?php echo $i++.'.'; ?></span>
    </div>
    <div class ="imeprezime">
    <span class="otekst"><?php echo $row['ime'].' '.$row['prezime'];?></span>
    </div>
        <div class='hidden'><?php echo $row['osobaID'];?></div>
</div>
<?php
}
?> 
```

我这样重写它：

```
 <?php
@session_start();
try
{   
    require "inc/func.php"; 
    require_once("db/db.php");
    $db = db_layer::get();
    $DBCONNECTION = $db->getHandle();
}
catch( Exception $Ex )
{
    exit();
    //die ( $Ex->getMessage() );
    //echo $Ex;
} 
```

应该输出它的部分是这样的。

```
 <?php
    $i=0;
while( $row = get_osoba() ) {
    ?>
<div class='osoba'>
    <div class="brojosobe">
    <span class="otekst"><?php echo$i++.'.'; ?></span>
    </div>
    <div class ="imeprezime">
    <span class="otekst"><?php echo $row['ime'].' '.$row['prezime'];?></span>
    </div>
<?php
}
?> 
```

我的函数在 /inc 文件夹中（一个文件 functions.php） 我有这些函数：

```
function osoba_query()
{
$query ="SELECT osobaID,ime,prezime FROM ssa_osoba";
return mysql_query($query);
}
function get_osoba()
{
$rs =  osoba_query();
static $row = mysql_fetch_assoc($rs);
return $row;
} 
```

但它总是只输出第一行。mysql_fetch_assoc 应该将指针移动到下一行，但在这种情况下它不会。

我该怎么办？

编辑1：

如果我这样做：

```
$query ="SELECT osobaID,ime,prezime FROM ssa_osoba";
$rs = mysql_query($query);
function get_osoba()
{
global $rs;
$row = mysql_fetch_assoc($rs);
return $row;
} 
```

PHP 输出：警告：mysql_fetch_assoc() 期望参数 1 是资源，在第 7 行的 D:\Xampp\htdocs\ssa\ilayer\inc\func.php 中给出 null

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:45:17.200

每次`osoba_query()`调用时您都会重新运行查询，这会重置所有内容。

不要那样做。

# c# - String.Join 不接受 IEnumerable

> ID：10020803
> 
> 赞同：2
> 
> 时间：2012-04-04T23:42:25.883
> 
> 标签：c#, .net-3.5

我有一个带有这个签名的方法：

```
IEnumerable<string> GetCombinations(string s, int length) 
```

我正在尝试`string.Join`像这样使用它：

```
var combinations = GetCombinations(text, 2);
string result = string.Join(", ", combinations); 
```

但我收到以下编译器错误：

`cannot convert from 'System.Collections.Generic.IEnumerable<string>' to 'string[]'`

不能`string.Join`带`IEnumerable<string>`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-04T23:45:26.320

您使用的是哪个版本的 .NET Framework？在 .NET 4 中添加了接受 IEnumerable 而不是数组[的 String.Join](http://msdn.microsoft.com/en-us/library/dd783876.aspx)的重载。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-04T23:45:21.177

调用 .ToArray 就可以了？

```
String.Join(", ",combinations.ToArray()); 
```

**编辑**

另请参阅[Dan J 的回答](https://stackoverflow.com/a/10020827/215042)：自 .Net 4 以来，String.Join 的重载**确实**接受 IEnumerable。

# c++ - 类构造函数中第一行大小为 8 的无效写入

> ID：10020813
> 
> 赞同：7
> 
> 时间：2012-04-04T23:43:42.940
> 
> 标签：c++, valgrind

我无法让一个简单的类构造函数工作。

```
// In XModule.h
class XModule
{
...
public:
  TXMHeader     header;     // module header
  TXMInstrument*    instr;      // all instruments (256 of them)
  TXMSample*        smp;        // all samples (256 of them, only 255 can be used)
  TXMPattern*       phead;      // all pattern headers (256 of them)
} 
```

模块.cpp

```
// In XModule.cpp
....
XModule::XModule()
{
  // allocated necessary space for all possible patterns, instruments and samples
  phead = new TXMPattern[256]; // Line # 1882
  instr = new TXMInstrument[256];
  smp = new TXMSample[MP_MAXSAMPLES];

  memset(&header,0,sizeof(TXMHeader));

  if (instr)
    memset(instr,0,sizeof(TXMInstrument)*256);

  if (smp)
    memset(smp,0,sizeof(TXMSample)*MP_MAXSAMPLES);

  if (phead)
    memset(phead,0,sizeof(TXMPattern)*256);

}
.... 
```

提取器.cpp

```
#include "Extractor.h"
#include "XModule.h"

#include <iostream>
using namespace std;

int main ()
{
  XModule* module = new XModule();
  SYSCHAR* fileName = "Greensleeves.xm";

  ...

  return 0;
} 
```

当我使用 valgrind 运行时，出现以下错误：

```
==21606== Invalid write of size 8
==21606==    at 0x408BD3: XModule::XModule() (XModule.cpp:1882)
==21606==    by 0x4012D8: main (Extractor.cpp:9)
==21606==  Address 0x64874f0 is not stack'd, malloc'd or (recently) free'd 
```

在该行的后面它会将和`memset(instr,0,sizeof(TXMInstrument)*256);`归零。`phead``instr``smp`

使用 gdb 单步执行显示，在此之前`phead`，`instr`、 和`smp`已正确设置，但数组指针的地址位于为数组新分配的区域内`instr`。检查`&phead`发现这是真的。

为什么新调用分配用于的`instr = new TXMInstrument[256];`内存空间，`phead`我可以做些什么来解决这个问题或进一步诊断问题？`instr``smp`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T05:01:22.867

事实证明，类定义中有一堆#IFDEF，所以当我针对使用项目makefile构建的库编译我的实用程序时，它使用源头文件并认为类具有不同数量的属性，所以它们是没有正确排列在内存中，并被数组的分配压垮。

我通过不使用项目库、将源文件复制到新文件夹并运行`g++ *.cpp`.

# jquery - 流体网格上的 JQuery UI 可排序列表在拖动时向左对齐

> ID：10020815
> 
> 赞同：0
> 
> 时间：2012-04-04T23:44:04.043
> 
> 标签：jquery, ruby-on-rails-3, jquery-ui, twitter-bootstrap, jquery-ui-sortable

我在使用流体网格的 twitter 引导应用程序中使用 jquery-ui 可排序列表。列表中的所有元素都使用 居中`margin:0 auto`。

数据方面一切正常，但是当用户拖动列表中的一个元素时，它在拖动时会在视觉上向左对齐，这可能是因为 jquery 将位置设置为绝对。

有没有办法覆盖这种行为？

**更新**

以下是可能相关的代码位：

*HTML结构*

```
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span2"></div>
        <div class="span10">
            <div id="sortable-list" data-update-url="some-url">
            <span id="position-zero"></span>
                <div class="item-container">
                    <div class="item-inner">Some text</div>
                    <div class="item-toolbar"></div>
                </div>
    </div>
        </div>
    </div>
</div> 
```

*CSS位*

```
.row-fluid {
    width:100%;
}

.item-container {
margin:0 auto;
width:1205px;
}

.item-inner {
margin: 0 auto;
width:1163px;
}

.item-toolbar {
margin:0 auto;
display:none;
width:1203px;
}

#list-column {
margin: 0 auto 300px 0;
min-height:500px;
} 
```

*JS（咖啡脚本）*

```
jQuery ->
    $("#sortable-list").sortable
    axis: 'y'
    placeholder: "item-placeholder"
    handle: '.icon-move'
    sort: ->
        $('.item-toolbar').hide()
    update: ->
        $.post($(this).data('update-url'), $(this).sortable('serialize')) 
```

# python - UML图中类的定位

> ID：10020822
> 
> 赞同：8
> 
> 时间：2012-04-04T23:45:04.290
> 
> 标签：python, uml, drawing, graph-drawing, pyreverse

我正在创建一个工具，用于将 Python 项目显示为 UML 图（+ 使用 GUI 显示一些代码错误检测）

我使用 Pyreverse 扫描了一些项目，我拥有绘制 UML 图所需的所有数据。问题是类框在画布上的定位

首先，我决定使用已经实现的基于力的算法来决定类的位置，它工作得很好这是结果 [https://github.com/jvorcak/gpylint/blob/master/screenshots/gpylint.png](https://github.com/jvorcak/gpylint/blob/master/screenshots/gpylint.png) 和这里[代码](https://github.com/jvorcak/gpylint/blob/master/gpylint/writer.py#L53-58)（Python ，但即使对于非 Python 程序员也很容易理解）

有一个问题，它非常适合显示图表，但是如果我想显示 UML，我希望有一些增强，例如，如果 2 个类扩展一个超类，我希望它们在图表中处于同一级别就像[点程序生成的图表一样](http://umldot.sourceforge.net/demo.gif)

你能告诉我一个算法如何做到这一点吗？或者至少给我一些想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T14:54:25.923

您似乎缺少的主要增强功能是将您的图表转换为[分层图表。](http://en.wikipedia.org/wiki/Layered_graph_drawing)这**不是一件容易的事，但它是可行的**。（结果的质量可能会因过程中投入的时间和思想而异）。

主要思想是对图进行某种[拓扑排序](http://en.wikipedia.org/wiki/Topological_sorting)，将其拆分为层，在其中进行一些排列，然后绘制图形。（你可以在网上找到 python 代码来做一个真正的拓扑排序（[例子](http://code.activestate.com/recipes/577413-topological-sort/)），但真正的 TS 只会产生一个长线状的图形，我们想要一些不同的东西）

因此，我将尝试描述一种将给定图形转换为分层图形的算法：

1.  拓扑排序不适用于具有循环的图，因此如果输入图还不是没有循环的有向图，则必须找到一组可以删除（或可能反转）的边以创建循环图表（稍后您会将它们添加到分层图表中，但这会破坏分层并使图表不那么漂亮:)。由于找到可以删除的最小可能边集是 NP 完全的（非常困难） - 我认为你必须在这里做一些捷径，不一定要找到最小的边集，但要在合理的时间内完成。

2.  将图分成层，这里可以做很多优化，但我建议你保持简单。迭代所有图的顶点，每次收集所有没有传入边的顶点到一个层。在一些简单的情况下，这可能会产生类似线的图，但它非常适合 UML 图的情况。

3.  [一个好的图是相互交叉](http://en.wikipedia.org/wiki/Crossing_number_%28graph_theory%29)的边数最少的图，这听起来并不重要，但这一事实对图的整体外观有很大贡献。决定交叉点数量的是每一层中边缘的排列顺序。但同样，找到最小交叉点数或找到最大无交叉边集是 NP 完全的 :( “所以这又是典型的求助于启发式方法，例如将每个顶点放置在一个位置，该位置通过找到其邻居在前一层的位置的平均值或中值来确定，然后交换相邻对，只要这样可以提高交叉的数量。”

4.  在算法的第一步中移除（或反转）的边缘将返回到它们的原始位置。

你有它！您的 UML 的一个很好的分层图。

*   如果我的解释不够清楚，请尝试再次阅读有关[分层图形绘制](http://en.wikipedia.org/wiki/Layered_graph_drawing)的 Wikipedia 文章，或者问我任何问题，我会尽力回复。
*   请记住，这是针对一般情况的算法，可以进行大量优化以更好地处理您的特定情况。
*   如果您想了解更多关于 UML 工具功能的想法，请查看 Jetbrains 为他们的[IntelliJ UML 工具所做的出色工作](http://www.jetbrains.com/idea/training/demos/uml-class-diagrams.html)

希望我在这里的评论对您有所帮助。

**重要更新：** 既然您说您正在“*寻找来自可靠和/或官方来源的答案。* ”我附上了来自 graphviz（dot 算法）**[的](http://www.graphviz.org/Documentation/TSE93.pdf)** 正式文档，其中“描述了用于绘制有向图的四遍算法。第一遍使用网络单纯形算法找到最佳等级分配。第二遍通过迭代启发式设置等级内的顶点顺序，结合新颖的权重函数和局部转置以减少交叉。第三遍通过构造和找到节点的最佳坐标对辅助图进行排序。第四次通过样条曲线绘制边缘。该算法绘制好并且运行速度快。 [http://www.graphviz.org/Documentation/TSE93.pdf](http://www.graphviz.org/Documentation/TSE93.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T18:47:50.177

连接组件的约束布局是一个重要的问题，您最好使用现有工具来解决。您提到了[Graphviz](http://www.graphviz.org/)，但我认为您不会找到一个直接的算法来移植到 Python。更好的解决方案可能是使用[pydot](http://code.google.com/p/pydot/)与 Graphviz 交互并让它处理布局。

流程看起来像：

1.  为 UML 图生成数据
2.  使用 pydot 转换为点语言
3.  使用Graphviz工具布局，输出点语言包括布局
4.  使用 pydot 解析输出的布局
5.  使用 Python 显示

Graphviz 处理布局，但所有显示仍在 Python 中，以允许您想要支持的任何自定义行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T22:00:55.193

[在 blahdiblah 的基础上](https://stackoverflow.com/a/10094618/517815)提供我自己的答案，您确实可以使用建议的工作流程成功生成您的 UML 图。

但是，这似乎需要通往您的解决方案的花园路径，这对于您的应用程序的设计似乎并不理想。具体来说，我们希望减少实现这项工作[*所需的理论运动部件的数量。*](https://en.wikipedia.org/wiki/Moving_parts#Mechanical_efficiency_and_wear)

我建议不要使用[pyreverse ，而是查看](http://www.logilab.org/2560)[此线程中提到的替代方法](https://stackoverflow.com/questions/260165/whats-the-best-way-to-generate-a-uml-diagram-from-python-source-code)。具体来说，像[Epydoc](http://epydoc.sourceforge.net/)这样的工具可以更好地满足您的需求，既可以减少依赖关系，也可以减少其 ( [MIT](https://en.wikipedia.org/wiki/MIT_License) ) 许可结构。

无论您选择哪条路径，祝您申请顺利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T23:50:06.957

如果您想以有序的方式显示班级（父母在上，孩子在下），您应该跟踪每个班级的“权重”。我所说的重量是指“父母”的数量。

例如，如果 B 继承自 A，则 B.weight = 1 且 A.weight = 0。如果 C 继承自 B，则 C.weight = 2。如果将其表示为一行，则 A 类将打印在第 0 行, B 在第 1 行，C 在第 2 行。一般来说，相同“权重”的所有类别都将打印在同一虚拟行上。

当然这只是基本思想，如果您希望您支持复杂的对象（多继承等），定位元素将比这更困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T09:33:13.643

我不是 python 程序员，但功能上我可以给你一些建议。

1.  您必须计算每节课的行数

2.  保留班级的级别编号，这将有助于您根据级别编号组织课程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-15T07:38:23.303

您不太可能从不是首先开发 UML 的实际项目中获得好的结果。这是我们大约 10 年前使用第一个 java-uml 往返工具 (TogetherJ) 学到的一个教训。在文本模式下，很容易摆脱无法很好绘制的代码。作为一种深入了解代码的方法，smalltalk 系统的基于浏览器的动态视图比 UML 工具目前所能提供的要有效得多。

对于布局，只需查看 CAD 中针对电子产品所做的所有工作，尤其是印刷电路板 (PCB)。那里有很好的放置和路由算法。我还没有看到自动化 UML 工具正确处理的一件事是处理大量子类，您希望布局从父类下方的单行类更改为低节点移动半个节点的双行。

# visual-studio-2010 - MissingMethodException w/ Method present -> 伤脑筋的 VS2010 错误？

> ID：10020826
> 
> 赞同：2
> 
> 时间：2012-04-04T23:45:25.687
> 
> 标签：visual-studio-2010, missingmethodexception

两天来，我对 VS 2010 (SP 1) 有一个非常讨厌的问题。我的解决方案由 1 个 Azure 项目组成，每个项目有 4 个角色，每个 1 个实例。它们中的每一个都在第一行之一执行配置更改，以设置 ServiceStack.Text JSON 序列化程序的日期格式。

```
JsConfig.DateHandler = JsonDateHandler.ISO8601; 
```

有人会认为这里不会出错，但不知何故，我的 VS 不这么认为。如果我执行 Clean+Rebuild，解决方案就可以正常工作。如果我停止调试（或其他一些异常结束调试运行），则每次进一步的调试运行都将在此行停止并抛出 MissingMethodException ![抛出异常](../Images/d86bf5f763a4c5224c03d0d307fdd546.png)。

如果我再次执行 Clean+Rebuild，它恰好可以运行 1 次，然后再次引发异常。显然，该方法不能消失，但我对这个问题的根源一无所知，它只会破坏我在每次更改后清理 + 重建的效率。

之前的 ServiceStack.Text 版本确实没有这个方法（是的，我几天前就使用了之前的版本），但是我删除了它的每一点。我什至通过 QuickWatch 查看了 typeof(JsConfig).Assembly 以确认它加载了最新版本，它确实如此，所以我无法想象以前的版本如何负责。

我已经尝试过但没有改变任何东西的操作：

*   删除了 .suo
*   停用的 AV 和 SearchProtocolHost（也许他们锁定了文件或其他东西）
*   通过 NuGet 删除所有与 ServiceStack.Text 相关的内容，并在每个（使用）项目中重新安装它
*   重启VS2010十亿次
*   重新启动
*   在 Sysinternals Process Monitor 中寻找明显的东西

顺便提一句。我不认为这个问题真的与 ServiceStack.Text 库有关，但显然我不能确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T07:32:05.370

我遇到了同样的问题（请参阅我的评论），但在升级到最新版本的 Servicesstack.Text 后，问题就消失了。

拉尔西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T18:46:28.100

好吧，问题已解决，但我不知道到底是怎么回事。

我将我的 TFS 工作区移到了另一个驱动器，该驱动器（不知道，以为它只会将所有内容移至新驱动器）刚刚从存储库中获取了最新版本，之后似乎已修复它。所以问题一定出在那些被排除在 TFS 源代码控制之外的文件上。它不能是 .suo，因为我多次删除它，但也不能是那些被每次构建覆盖的文件（“清理”已经删除了它们），所以不应该留下很多文件. 希望至少有一点帮助。

# arrays - Scala中“java.lang.ArrayIndexOutOfBoundsException：-1”中的数字是什么意思？

> ID：10020828
> 
> 赞同：0
> 
> 时间：2012-04-04T23:45:29.597
> 
> 标签：arrays, scala

我收到了这个错误，但它并没有帮助我靠近错误发生的位置。错误后面的数字是什么意思？过去几个小时我一直在查看错误，但我并没有真正了解错误的来源。我的代码是：

```
val str = "(and x y)";

def stringParse ( exp: String, expreshHolder: ArrayBuffer[String] ): ArrayBuffer[String] = { //takes three arguments, string, int, arraybuffer

    var b = 0; //position of where in the expression String I am currently in
    var temp = expreshHolder; //holder of expressions without parens
    if(temp == 0) b = 0; else {b = temp(temp.length-1).toInt; temp.remove(temp.length-1)} //this sets the position of wherever the string was read last plus removes that check from the end of the ArrayBuffer
    var arrayCounter = temp.length; //just counts to make sure an empty spot in the array is there to put in the strings

    if(exp(b) == '(') {
        b = b + 1;

        while(exp(b) == ' '){b = b + 1;} //point of this is to just skip any spaces between paren and start of expression type
        if(exp(b) == 'a') {
            //first create the 'and', 'or', 'not' expression types to figure out 
            temp += exp(b).toString; 
            b = b+1; 
            temp(arrayCounter) = temp(arrayCounter) + exp(b).toString; //concatenates the second letter
            b = b+1; 
            temp(arrayCounter) = temp(arrayCounter) + exp(b).toString; //concatenates the last letter for the expression type
            arrayCounter+=1
            //this part now takes the symbols and puts them in an array
            b+=1;
            while(exp(b) == ' ') {b+=1;} //just skips any spaces until it reaches the first symbol
            if(exp(b) == '(') { temp += b.toString; temp = stringParse(exp, temp);
            b = temp(temp.length-1).toInt; 
            temp.remove(temp.length-1); 
            arrayCounter = temp.length 
            } else {
            temp += exp(b).toString; 
            arrayCounter+=1; b+=1; }
            while(exp(b) == ' ') {b+=1;} //just skips any spaces until it reaches the second symbol

            if(exp(b) == '(') { temp += b.toString; temp = stringParse(exp, temp); 
                            b = temp(temp.length-1).toInt; 
                            temp.remove(temp.length-1); 
                            arrayCounter = temp.length } else {temp += exp(b).toString; arrayCounter+=1; b+=1; }    
        }
    temp;
    } else { 
      temp(arrayCounter) +="failed"; temp;} //this is just incase it fails and I should probably check this incase it fails when it doesnt encounter an opening paren
}//end of while loop

hold = stringParse(str, ho );
for(test <- hold) println(test); 
```

很抱歉代码量很大，但据我所知，它是正确的。这段代码的重点是读取顶部的第一个字符串，然后将“and”、“x”、“y”放入数组中。它应该在更复杂的版本上进行，但我首先在一个简单的版本上尝试它以测试并确保它有效。我得到的错误是：

```
java.lang.ArrayIndexOutOfBoundsException: -1
at scala.collection.mutable.ResizableArray$class.apply(ResizableArray.scala:45)
at scala.collection.mutable.ArrayBuffer.apply(ArrayBuffer.scala:44)
at Driver$.stringParse$1(Driver.scala:19)
at Driver$.main(Driver.scala:60)
at Driver.main(Driver.scala)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at scala.tools.nsc.util.ScalaClassLoader$$anonfun$run$1.apply(ScalaClassLoader.scala:78)
at scala.tools.nsc.util.ScalaClassLoader$class.asContext(ScalaClassLoader.scala:24)
at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.asContext(ScalaClassLoader.scala:88)
at scala.tools.nsc.util.ScalaClassLoader$class.run(ScalaClassLoader.scala:78)
at scala.tools.nsc.util.ScalaClassLoader$URLClassLoader.run(ScalaClassLoader.scala:101)
at scala.tools.nsc.ObjectRunner$.run(ObjectRunner.scala:33)
at scala.tools.nsc.ObjectRunner$.runAndCatch(ObjectRunner.scala:40)
at scala.tools.nsc.MainGenericRunner.runTarget$1(MainGenericRunner.scala:56)
at scala.tools.nsc.MainGenericRunner.process(MainGenericRunner.scala:80)
at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:89)
at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala) 
```

对能够阅读此错误消息并了解它发生的位置有任何帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T01:09:22.753

错误在第 19 行`Driver.scala`：

```
at Driver$.stringParse$1(Driver.scala:19) 
```

看一眼：

```
if(temp == 0) b = 0; else {b = temp(temp.length-1).toInt; temp.remove(temp.length-1)} 
```

`temp`是一个`ArrayBuffer[String]`，而不是一个数字，所以`temp == 0`总是假的。这意味着该`else`子句将始终执行，即使`temp.length`是 0。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-04T23:53:36.700

这意味着您要递减的变量已达到`-1`

另请注意，您需要做的就是按照行号。例如，首先要查看的位置是第 '45' 行

```
 scala.collection.mutable.ResizableArray$class.apply(ResizableArray.scala:45) 
```

处理您首先编写的方法。

# wordpress - 如果当前页面使用的是 single.php，则 Wordpress URL 重写

> ID：10020830
> 
> 赞同：0
> 
> 时间：2012-04-04T23:45:41.270
> 
> 标签：wordpress, rewrite, permalinks

好的，所以最近三天我一直在环顾四周，但我无法弄清楚..

这是问题所在以及我需要解决的问题。

问题 - 我使用 Wordpress 作为 CMS，几乎所有内容都设置为使用自定义模板的页面。我有一个名为 Blog 的页面，它使用一个模板来调用我写的所有帖子减去自定义帖子类型。它列出了所有像任何普通博客一样完美找到的内容。即使当我点击一个帖子时，它仍然有效并使用 single.php 模板文件重定向到该帖子。但是点击帖子后，URL 会从 A 转到 B。

A（点击前）：[http](http://www.mysite.com/blog) ://www.mysite.com/blog 到 B（点击后）：[http ://www.mysite.com/this-is-my-post](http://www.mysite.com/this-is-my-post)

我试过弄乱永久链接，但没有什么能按照我需要的方式正常工作。

解决方案：我需要最终的 URL 来输出[http://www.mysite.com/blog/this-is-my-post](http://www.mysite.com/blog/this-is-my-post)

如果我为博客使用自定义页面模板，我该如何重写 URL？

感谢您的帮助，这让我的大脑受伤了；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T03:22:22.130

转到设置 -> 永久链接，然后在单选按钮中选择“自定义结构”选项。然后输入“/blog/%postname%/”作为值。

# sql-server - 当前交易盈亏sql查询

> ID：10020831
> 
> 赞同：0
> 
> 时间：2012-04-04T23:45:41.957
> 
> 标签：sql-server, tsql

我正在尝试几个测试员数据库面试问题；来自客户端背景，我正在做一些事情以达到标准，我目前正在努力。

我有一个包含“TradeID”、“Ticker”、“Price”和“Volume”的投资组合表。目前表中有 3 行，2 次买入 10,000 和 1 次卖出 10,000，都是同一家公司。我基本上需要计算出给定价格的每日投资组合价值。因此，如果当前价格为 1.00，则总价值将为 10,000。

我已经尝试了所有可能的子查询，但我一生都无法让它工作，我最终错误地得到了一个聚合或组，任何帮助将不胜感激。抱歉，如果我错过了什么。

编辑：我正在尝试创建这样的查询：

```
select
 sum
((sum(trade.volume) * 1.0) -
  (sum(trade.volume * trade.price)))

from trade 
```

Edit2：我目前拥有的测试数据并使示例更容易：

1.0 是收盘价。我有 3 笔交易；这三个的 trade.volume 将是 +10,000、+10,000、-10,000 - 都是同一家公司 trade.price : 1.1 - 是购买股票的价格

所以使用 sum((trade.volume) *1) 我试图获得 10,000，因为未平仓交易量 (sum(trade.volume * trade.price)) 的当前值将是 11,000 作为购买价格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:00:55.960

如果卖出是负数，那么

```
Select ticket, sum(volume*trade) from table group by ticket 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T08:08:30.557

我认为这就是你所拥有的：

```
CREATE TABLE Portfolio (
    TradeID int,
    Ticker varchar(10),    -- the company identifer
    Price money,
    Volume int,    -- probably not actually an int
) 
```

有数据：

```
INSERT Portfolio VALUES ( 1, 'ACME', 1.1, 10000) -- a buy
INSERT Portfolio VALUES ( 2, 'ACME', 1.1, 10000) -- a buy
INSERT Portfolio VALUES ( 3, 'ACME', 1.1, -10000) -- a sell 
```

给定

> 我基本上需要计算出给定价格的每日投资组合价值。因此，如果当前价格为 1.00，则总价值将为 10,000。

我*认为*您想要当前的 net`Volume`乘以今天的价格：

```
DECLARE @priceNow money
SET @priceNow = 1.0

DECLARE @currentValue money
SELECT @currentValue = @priceNow * SUM(Volume) FROM Portfolio WHERE Ticker = 'ACME' 
```

请注意，*交易价格与知道当前拥有的**价值*无关。

# python - 如何使用 Pyparsing 为以下数据创建语法

> ID：10020840
> 
> 赞同：5
> 
> 时间：2012-04-04T23:47:10.537
> 
> 标签：python, parsing, pyparsing

我有类似于 YAML 的数据，需要使用 Pyparsing 为其创建语法。与 Python 一样，Yaml 的数据范围由空格定义

数据：

```
object : object_name 
comment : this object is created first 
methods:   
  method_name:
    input: 
      arg1: arg_type
      arg2: arg2_type
    output:   

  methond2_name:
    input:
    output:
      arg1 : arg_type 
```

解析上述内容后，它应该会输出类似以下内容：

```
{'comment': 'this object is created first',
 'object': 'object_name',
 'methods': {'method_name': {'input': {'arg1': 'arg_type', 'arg2': 'arg2_type'}, 
 'output': None}, 'methond2_name': {'input': None, 'output': {'arg1': 'arg_type'}}}} 
```

[编辑] 数据类似于 YAML，但不完全相同。所以 YAML Python 解析器无法解析它。我留下了一些细节以使示例数据更简单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T09:29:50.960

[您可以使用PyYAML](http://pyyaml.org/wiki/PyYAML)代替 Pyparsing 。

```
import yaml
f = open('yyy.yaml', 'r')
print yaml.load(f) 
```

输出：

```
{'comment': 'this object is created first',
 'object': 'object_name',
 'methods': {'method_name': {'input': {'arg1': 'arg_type', 'arg2': 'arg2_type'}, 
 'output': None}, 'methond2_name': {'input': None, 'output': {'arg1': 'arg_type'}}}} 
```

# clojure - 如何更新跷跷板模型？

> ID：10020841
> 
> 赞同：5
> 
> 时间：2012-04-04T23:47:29.660
> 
> 标签：clojure, jtree, seesaw

我一直在使用[seesaw.tree/simple-tree-model](http://daveray.github.com/seesaw/seesaw.tree-api.html#seesaw.tree/simple-tree-model)创建我的 TreeModels，文档说这是只读的。最初我不需要编辑树结构，但现在我需要！

跷跷板中有一个[拉取请求](https://github.com/daveray/seesaw/pull/50)，用于添加`update-tree!`. 虽然这是8个月大。

**使用 seesaw / clojure 创建和编辑 JTrees 的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T12:59:45.990

不幸的是，Seesaw 的树支持很差劲。JTree（和它一样讨厌的表亲 JTable）非常复杂，因此提出一个涵盖许多用例的干净包装器已被证明是困难的。

无论如何，如果你想要一个可编辑的树模型，你将不得不创建自己的 TreeModel 实现，或者构建[DefaultTreeModel](http://docs.oracle.com/javase/6/docs/api/javax/swing/tree/DefaultTreeModel.html)，教程[在这里](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)。关键是始终通过对象而不是直接通过节点`DefaultTreeModel`进行修改（添加/删除子项等） 。`DefaultTreeModel`这可以确保正确触发事件并重新绘制树等。如果您发现自己`updateUI`在树上手动调用或类似的东西，那么您做错了什么。

希望这可以帮助。很抱歉给您带来不便。想到有人使用 Seesaw 必须进行互操作，这让我感到恶心 :)

# sql - sql函数如何根据表中值的条件返回字符串

> ID：10020843
> 
> 赞同：0
> 
> 时间：2012-04-04T23:47:34.387
> 
> 标签：sql

我有这个 SQL 表 Invoice。我想要实现的是编写一个函数，您可以将主键值发送到以获取特定发票。然后我想检查 Invoice 'Received' 的一个字段，这是一个位字段。如果是 1，我想从函数“已接收”返回。如果为 0，我想返回“未收到”。

我自己尝试了一下：

```
ALTER FUNCTION dbo.InvoiceStatus(@InvoiceId INT)
RETURNS VARCHAR
BEGIN
declare @Status varchar(100)

    SELECT * 
      FROM [Invoices_Prod].[dbo].[Invoice]
      Where InvoiceId = @InvoiceId

      ...

      How to check the received value?

      ...

    return @Status

END
GO 
```

因此，我将 InvoiceId 传入并使用 select 语句获取特定的 Invoice。我缺少的是如何检查 Received 字段并设置要返回的状态值。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:50:01.783

查看[案例](http://msdn.microsoft.com/en-us/library/ms181765.aspx)。

```
Select [foo], [bar],
  case when [received] = 1 
    then 'Received'
    else 'Not received'
  end as Status
From [Invoice]
Where [InvoiceId] = @InvoiceId
.... 
```

但是，我确实建议将这种表示层逻辑保留**在**您的 UDF 之外，甚至完全远离整个数据层/RDBMS，从而在应该完成的地方处理表示：在表示层中/逻辑。

# in-app-purchase - 如果重新安装应用程序，“购买所有”应用程序内购买会导致不必要的购买

> ID：10020844
> 
> 赞同：1
> 
> 时间：2012-04-04T23:47:35.233
> 
> 标签：in-app-purchase

我们正在开发一款包含 4 次应用内购买的游戏。添加内容 A、添加内容 B、添加内容 C 和全部购买。

附加内容只是从应用程序内解锁，没有下载任何内容。

所以这是导致我遇到的问题的步骤。

用户购买“全部购买”项目。代码知道这是购买的并解锁所有 Add'l Content A、B、C。游戏会保存所有东西都已购买，因此当您再次去商店时，所有按钮都不可用。

然后用户重新安装应用程序（新手机、同一部手机等）。
由于应用内购买的所有保存数据都丢失了，当他们去商店时，所有物品都可以再次使用。现在如果：

a）用户再次选择“全部购买”，应用商店允许它免费发生，因为它是重新下载，代码解锁并保存一切，一切都很好。

但是，如果他们：

b) 选择购买 Add'l Content A. 现在，即使过去选择了 Buy All，也没有购买 Buy All 或解锁内容的本地记录，并且由于用户从未实际购买过 Add'l Content 项目A、App Store收费（无需重新下载）。内容已解锁，但如果用户再次重新购买，他们将获得免费重新下载和所有内容，但为 Add'l Content A 支付了两次费用。

问题在于，我认为注册的应用内购买无法将其他人标记为已购买，即使与他们一起购买的内容是通过“全部购买”购买的。

我为此提出了一些解决方案，但我不知道哪些是有效的，甚至是 Apple 允许的

1) 什么都不做，让用户多损失 0.99 美元。

2）放置一个“恢复购买”按钮，该按钮将要求恢复，再次询问用户密码，并根据需要更新所有解锁的内容。这将解决问题，但用户仍然可能不会选择它，并且该按钮从未出现在我们游戏的原始设计中。对我来说没什么大不了的，但客户可能不喜欢它。

3）自动恢复购买检查。我知道你不应该在每次登录时都这样做，但它可以在用户第一次进入商店或用户第一次尝试购买东西时自动调用。

这些有效的解决方案中的任何一个，还是我可以采取其他措施来防止重复购买内容？我真的比用户更担心 Apple 标准，但我必须确保我第一次就做对了。

谢谢你-莫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T13:53:26.347

您的 Buy All 购买成本是否低于 ABC 的总和？

如果不是，您可以只购买所有 A、B 和 C 的 NSSet，而不是再生产一个产品。

您也可以尝试恢复交易，当用户点击A产品并检查他是否已经购买了它，然后让他购买。

# android - 如何将 SVN 导入转换为 Android 项目

> ID：10020845
> 
> 赞同：2
> 
> 时间：2012-04-04T23:47:50.323
> 
> 标签：android, eclipse, svn

`Android`我已经使用`Subeclipse`（文件 > 导入 > 从 SVN 结帐）检查了应用程序的存储库。但`Eclipse`它只是显示为一个文件夹。它不能作为 android 项目运行。如何解决这个问题？如何将此项目转换为 Android 项目以便我可以使用 adt 构建它？

编辑：我在 Ubuntu 12.04 中使用 Eclise 3.7 Indigo

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T00:05:55.717

先将项目从 SVN 检出到本地文件系统：

```
svn checkout URL /Users/Home/myproject 
```

然后创建一个 Android 项目并将其作为现有源导入（文件 -> 新建 -> Android 项目）： ![在此处输入图像描述](../Images/7d5b40888d01d7fb4faed04b95d0a740.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T11:13:11.573

我遇到的问题是将android项目导入eclipse后，运行时不起作用。试试这个。这种方法对我有用。

1.  以正常方式将项目从svn导入eclipse。

2.  转到属性-> java构建路径-> order and export

3.  您将看到部分选择的源包和未选择的库。只需选择所有库，然后单击确定。

4.  重启eclipse（重启重要）并将项目作为android应用程序运行。

5.  享受您的工作应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T10:00:24.427

将 SVN 项目转换为 android 项目

1）将您的项目签出到文件系统。

像 F:\projects\yourproject

2）去日食。

文件 -> 新 -> 来自现有代码的 Android 项目

浏览到 F:\projects （重要的浏览到上一级，不要在这里点击“你的项目”）

现在eclipse将检测文件夹'projects'中的android项目并列出它们。

现在，选择“你的项目”

完毕。

# c# - 比较 2 个 .XLS 文件并将结果输出到一个新的 .xls 文件中？

> ID：10020848
> 
> 赞同：1
> 
> 时间：2012-04-04T23:48:15.777
> 
> 标签：c#

所以我正在编写一个程序来比较 2 个 .xls 文件并在一个新的 .xls 文件中输出差异。我所说的差异是指价值观的差异。.xls 文件中还有多个工作表。如何在 C# 中实现这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:40:43.483

处理 Excel 文件的最佳方法是启动 Excel 并通过 Office 互操作性库对其进行控制。自己读写 .XLS 文件非常非常困难，而远程控制 Excel 一点也不难。

[http://www.codeproject.com/Articles/15760/How-to-Integrate-Excel-in-a-Windows-Form-Applicati](http://www.codeproject.com/Articles/15760/How-to-Integrate-Excel-in-a-Windows-Form-Applicati)是调用什么函数、使用什么程序集等等的一个可容忍的起点那。

# c++ - 调用子类的虚拟成员时崩溃/段错误

> ID：10020849
> 
> 赞同：1
> 
> 时间：2012-04-04T23:48:21.973
> 
> 标签：c++, class, segmentation-fault, virtual

我一直试图让这段代码工作但没有成功。gdb 告诉我 void Compiler::GenerateCode_ToFile(char* filename) 函数中的某处存在段错误，我已手动将问题追溯到该行的某处：

```
 std::string tempfile = this->code->CodeGen( temp, AST_TYPE_UNDEF, symtab, 0); 
```

但不是在它之后或之前。此外，它似乎在运行该虚拟功能的任何代码之前崩溃。

任何人都可以在这里看到问题吗？我只是看不出是什么导致它崩溃。这是调用虚函数的函数：

```
void Compiler::GenerateCode_ToFile(char* filename){

char directory[MAX_PATH];   //Actually represents the full path.
strcpy( directory, this->cwd.c_str());
strcat( directory, filename);

if(this->isVerboseMode)
    std::cout << "Source Output: " << directory << '\n';

std::fstream file( directory, std::ios::out);

int* temp = new int;
Symtable* symtab = new Symtable;
file << emit_core_code();
file << "\n\n";
std::string tempfile = this->code->CodeGen( temp, AST_TYPE_UNDEF, symtab, 0);
file.close();
} 
```

这是this->code所代表的类的定义。

```
/// CollectionExprAST - Expression class for multiple branches.
class CollectionExprAST : public ExprAST {
  std::vector<ExprAST*>* Code;
public:
  CollectionExprAST(std::vector<ExprAST*>* code) : Code(code) {}
  virtual std::string CodeGen(int* GeneratedCodeOpType,int WantOpType,Symtable* symtab, int depth);
  int GetType(void){return AST_TYPE_COLLECTION;};
  void* GetCollection(void){return this->Code;};
  void DebugPrint(int level);
}; 
```

这是它的超类：

```
/// ExprAST - Base class for all expression nodes.
class ExprAST {
public:
  virtual ~ExprAST() {}
  virtual std::string CodeGen(int* GeneratedCodeOpType,int WantOpType,Symtable* symtab, int depth) {return std::string("");};
  virtual void DebugPrint(int level){return;};
  virtual int GetType(void){return AST_TYPE_UNDEF;};
  virtual void* GetCollection(void){return NULL;};
}; 
```

最后，这是被调用的虚函数（尽管它在运行之前似乎崩溃了）：

```
std::string CollectionExprAST::CodeGen(int* GeneratedCodeOpType,int WantOpType,Symtable* symtab, int depth)
{
Sleep(3000);
std::string ret;
int j=0;
for(;j<this->Code->size();j++){
    int temp;
    int i=0;
    for(;i<depth;i++)
        ret += "\t";
    ret += (*this->Code)[j]->CodeGen(&temp,WantOpType,symtab, depth+1);
    ret += '\n';
}
return ret;
} 
```

我知道它在运行之前会崩溃，因为 Sleep() 永远不会运行。

谁能看到导致这个神秘段错误的错误？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:03:39.773

I see nowhere in your example where you actually allocate the `Code` member variable. It is a pointer and what it points to needs to be allocated at some point.

There are other problems as well, though not directly related to your crash.

First, you never delete `symtab` or `temp` in `GenerateCode_ToFile`. This is a memory leak. For that matter, why in the world are you dynamically allocating an `int` there? Just declare an int on the stack and pass its address to the `CodeGen` function. Same goes for `symtab` if possible.

```
int i = 10;
SomeFuncThatTakesAPointer(&i); 
```

Actually, looking more closely, you don't even use the `int*` parameter in the function and it isn't saved anywhere, so just get rid of it entirely.

Next...

```
std::vector<ExprAST*>* Code; 
```

Pointers to vectors and vectors that store pointers are almost always wrong. You are preventing the vector from handling dynamic memory allocation and deallocation for you. You may as well just use an array at this point (ok, an array doesn't grow for you if you assign something beyond its boundaries, but still, bad practice).

Vectors use a pattern called [RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization) to handle safely allocating and deallocating memory for you. When you maintain a pointer to a vector you circumvent that process and are required to call `delete` on the vector yourself.

When you store pointers in a vector you, once again, prevent the vector from deallocating its stored objects. It will store the *pointers themselves* dynamically and call `delete` on them, but this will not deallocate what the original pointer was pointing to.

C++ is a complex language. I suggest spending some time learning more about memory management in general and patterns like RAII which can simplify the process for you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-04T23:54:49.480

原因是`code`未分配或损坏。

在运行函数之前检查`nil`，然后检查是否可以从该指针运行任何其他函数。第一个很明显，后者可能意味着指针在某处损坏。

# ruby-on-rails - 连接表导轨的访问列

> ID：10020850
> 
> 赞同：2
> 
> 时间：2012-04-04T23:48:24.573
> 
> 标签：ruby-on-rails, activerecord

我有以下型号

```
class Player < ActiveRecord::Base
  has_many :players_to_teams
  has_many :teams, through: :players_to_teams
end

class Team < ActiveRecord::Base
  has_many :players_to_teams
  has_many :players, through: :players_to_teams
  belongs_to :account
end 
```

这些通过 player_to_teams 表加入：

```
class PlayersToTeam < ActiveRecord::Base
  belongs_to :player
  belongs_to :team
end 
```

`players_to_teams`有一个名为 的列`BT`。我在访问此专栏时遇到了困难。

这失败了：

```
player = Player.find(13)
player.players_to_teams.BT 
```

出现此错误：

```
NoMethodError:   undefined method `BT' for #<ActiveRecord::Relation:0x007fd52f170c58>
PlayersToTeam Load (332.2ms)    from /Users/Tyler/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.1/lib/active_record/relation/delegation.rb:45:in `method_missing'
  SELECT `players_to_teams`.* FROM `players_to_teams` WHERE `players_to_teams`.`player_id` = 13
    from /Users/Tyler/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.1/lib/active_record/associations/collection_proxy.rb:101:in `method_missing'
    from (irb):4
    from /Users/Tyler/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands/console.rb:47:in `start'
    from /Users/Tyler/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands/console.rb:8:in `start'
    from /Users/Tyler/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:41:in `<top (required)>'
    from /Users/Tyler/Development/Rails/csbb/script/rails:6:in `require'
    from /Users/Tyler/Development/Rails/csbb/script/rails:6:in `<top (required)>'
    from -e:1:in `load'
    from -e:1:in `<main>' 
```

但是，这确实有效：

```
player.players_to_teams.select("BT") 
```

`select`有没有办法在不使用该选项的情况下访问存储在 Rails 3.2.1 中的连接表中的值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-04T23:56:18.103

由于players_to_teams 是一个连接表并且您没有在其上运行所有内容，因此您得到了一个关系。

首先，您需要为集合调用 all 或首先为单个 PlayersToTeam 对象调用。

此外，我很确定它会因为大写（Ruby 中的常量具有大写字符）而被称为 BT 的方法阻塞。

# java - 我错过了一个变量吗？

> ID：10020851
> 
> 赞同：0
> 
> 时间：2012-04-04T23:48:27.523
> 
> 标签：java, variables, hashmap

我正在开发一个基于文本的冒险游戏项目。它涉及带有物品的房间并在房间之间导航。有一个类叫做Item，这个更大的类叫做Room。除了我的 addItem 方法外，我所有的方法都可以正常工作。它应该将物品放入空房间或替换房间中的物品（如果它已经存在）。当我创建一个新房间时，我可以将一个项目放入一个房间，并且我的 removeItem 方法有效，但 addItem 既不能用于空房间也不能用于满房间。我是否缺少某种“房间”变量（我的教授没有提到类似的东西）或者我的项目变量有问题？这是课堂房间的完整代码：

```
 public class Room
{
    private String roomDescription;
    private Item item;
    private HashMap <String, Room> myNeighbors;

    public Room (String pDescription){
        roomDescription = pDescription;
        item = null;
    }

    public Room (String pDescription, Item pItem){
        roomDescription = pDescription;
        item = pItem;
    }

    public String getRoomDescription(){
        return roomDescription;
    }

    public Item getItem(){
        return item;
    }

    public void addItem (Item i){
        i = item;
    }

    public boolean hasItem(){
        if(item != null){
            return true;
        }else{
            return false;
        }
    }

    public void addNeighbor (String pDirection, Room r){
        myNeighbors.put(pDirection, r);
    }

    public Room getNeighbor (String pDirection){
        return myNeighbors.get(pDirection);
    }

    public Item removeItem(){
        item = null;
        return item;
    }

    public String getLongDescription(){
        String longDescription = "You are at " + roomDescription + "You see " + item;
        return longDescription;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:50:22.580

改变`i = item;`为`item = i;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T23:51:31.563

```
public void addItem (Item i){
    item = i;
} 
```

是这个错误吗？

希望这可以帮助。

菲尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:56:43.587

正在发生的事情是您正在给出`i`、 参数、 对`item`、 实例变量的引用，而不是相反。该方法结束并且`i`不再存在，没有任何改变。

# php - Group_concat 然后将其分解成一个数组

> ID：10020854
> 
> 赞同：3
> 
> 时间：2012-04-04T23:48:35.480
> 
> 标签：php, mysql

我是 group_concat 来自我的数据库的一堆评论，它把它变成了这样的东西：

这是评论1，这是评论2

然后我将它分解成一个数组，如：

```
$review = $row->review;
$row->review = explode(',', $review); 
```

这很好用，直到有人在那里评论添加一个`,`然后它不再适用。那么有没有办法 group_concat 并在它们之间加上逗号之外的东西？有没有更好的方法来解决这个问题？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:51:19.177

是的，不要使用`GROUP_CONCAT`. 创建一个子表，其中包含评论和适当的关系，这些关系将每个评论链接到......您正在处理的任何实体。

如果您已经将其设置为这样，并且只是用于`GROUP_CONCAT`将多个评论提取到单个结果集中......那么仍然不要使用`GROUP_CONCAT`. 使用子查询。

# c# - 在编辑项模板中上传文件

> ID：10020856
> 
> 赞同：2
> 
> 时间：2012-04-04T23:48:53.293
> 
> 标签：c#, asp.net, listview

我希望能够使用列表视图更新数据库中的图像但我做不到文件上传总是给我一个空值并且无法解决问题任何人都可以帮助我成为 asp.net 的初学者和C＃

这是我的代码：

```
 <body>
    <form id="form1" runat="server">
    <div>

    <asp:Panel ID="Panel1" runat="server" Height="1138px">
        &nbsp;&nbsp;&nbsp;
        <br />
        <br />
        <br />
        &nbsp;&nbsp;&nbsp;
        <asp:Label ID="Label1" runat="server" Text="Articles" ForeColor="#FF3300"></asp:Label>
        &nbsp;<asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
            DataSourceID="SqlDataSource1" DataTextField="Name" DataValueField="Name" 
            Height="16px" Width="267px">
        </asp:DropDownList>
        <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
            ConnectionString="<%$ ConnectionStrings:siteDBConnectionString %>" 
            SelectCommand="SELECT * FROM [Articles]"></asp:SqlDataSource>
        &nbsp;&nbsp;
        <br />
        <br />
        &nbsp;&nbsp;
        <asp:ListView ID="ListView1" runat="server" DataKeyNames="Article_No" 
            DataSourceID="SqlDataSource2" GroupItemCount="3" 
            onselectedindexchanged="ListView1_SelectedIndexChanged">
            <AlternatingItemTemplate>
                <td runat="server" style="background-color: #FAFAD2;color: #284775;">
                    Name:
                    <asp:Label ID="NameLabel" runat="server" 
                        Text='<%# Eval("Name") %>' />
                    <br />
                    Subject:
                    <asp:Label ID="SubjectLabel" runat="server" Text='<%# Eval("Subject") %>' />
                    <br />
                    Date:
                    <asp:Label ID="DateLabel" runat="server" Text='<%# Eval("Date") %>' />
                    <br />
                    Picture:
                    <asp:Label ID="PictureLabel" runat="server" Text='<%# Eval("Picture") %>' />
                    <br />
                    Content:
                    <asp:Label ID="ContentLabel" runat="server" Text='<%# Eval("Content") %>' />
                    <br />
                    Article_No:
                    <asp:Label ID="Article_NoLabel" runat="server" 
                        Text='<%# Eval("Article_No") %>' />
                    <br />
                    <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                        Text="Delete" />
                    <br />
                    <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
                    <br />
                </td>
            </AlternatingItemTemplate>
            <EditItemTemplate>
                <td runat="server" style="background-color: #FFCC66;color: #000080;">
                    Name:
                    <asp:TextBox ID="NameTextBox" runat="server" 
                        Text='<%# Bind("Name", "{0}") %>' />
                    <br />
                    Subject:
                    <asp:TextBox ID="SubjectTextBox" runat="server" 
                        Text='<%# Bind("Subject", "{0}") %>' />
                    <br />
                    Date:
                    <asp:TextBox ID="DateTextBox" runat="server" 
                        Text='<%# Bind("Date", "{0:g}") %>' />
                    <br />
                    Picture:
                    <asp:FileUpload ID="fuimage" runat="server"  />
                    <br />
                    Content:
                    <asp:TextBox ID="ContentTextBox" runat="server" 
                        Text='<%# Bind("Content", "{0}") %>' TextMode="MultiLine" />
                    <br />
                    Article_No:
                    <asp:Label ID="Article_NoLabel1" runat="server" Enabled="False" 
                        Text='<%# Eval("Article_No", "{0}") %>' />
                    <br />
                    <asp:Button ID="UpdateButton" runat="server" CommandName="Update" 
                        OnClick="UpdateButton_Click1" Text="Update" />
                    <br />
                    <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                        Text="Cancel" />
                    <br />
                </td>
            </EditItemTemplate>
            <EmptyDataTemplate>
                <table runat="server" 
                    style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;">
                    <tr>
                        <td>
                            No data was returned.</td>
                    </tr>
                </table>
            </EmptyDataTemplate>
            <EmptyItemTemplate>
                <td runat="server" />
            </EmptyItemTemplate>
            <GroupTemplate>
                <tr ID="itemPlaceholderContainer" runat="server">
                    <td ID="itemPlaceholder" runat="server">
                    </td>
                </tr>
            </GroupTemplate>
            <InsertItemTemplate>
                <td runat="server" style="">
                    Name:
                    <asp:TextBox ID="NameTextBox" runat="server" Text='<%# Bind("Name") %>' />
                    <br />
                    Subject:
                    <asp:TextBox ID="SubjectTextBox" runat="server" Text='<%# Bind("Subject") %>' />
                    <br />
                    Date:
                    <asp:TextBox ID="DateTextBox" runat="server" Text='<%# Bind("Date") %>' />
                    <br />
                    Picture:
                    <asp:TextBox ID="PictureTextBox" runat="server" Text='<%# Bind("Picture") %>' />
                    <br />
                    Content:
                    <asp:TextBox ID="ContentTextBox" runat="server" Text='<%# Bind("Content") %>' />
                    <br />
                    <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
                        Text="Insert" />
                    <br />
                    <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                        Text="Clear" />
                    <br />
                </td>
            </InsertItemTemplate>
            <ItemTemplate>
                <td runat="server" style="background-color: #FFFBD6;color: #333333;">
                    Name:
                    <asp:Label ID="NameLabel" runat="server" 
                        Text='<%# Eval("Name") %>' />
                    <br />
                    Subject:
                    <asp:Label ID="SubjectLabel" runat="server" Text='<%# Eval("Subject") %>' />
                    <br />
                    Date:
                    <asp:Label ID="DateLabel" runat="server" Text='<%# Eval("Date") %>' />
                    <br />
                    Picture:
                    <asp:Label ID="PictureLabel" runat="server" Text='<%# Eval("Picture") %>' />
                    <br />
                    Content:
                    <asp:Label ID="ContentLabel" runat="server" Text='<%# Eval("Content") %>' />
                    <br />
                    Article_No:
                    <asp:Label ID="Article_NoLabel" runat="server" 
                        Text='<%# Eval("Article_No") %>' />
                    <br />
                    <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                        Text="Delete" />
                    <br />
                    <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
                    <br />
                </td>
            </ItemTemplate>
            <LayoutTemplate>
                <table runat="server">
                    <tr runat="server">
                        <td runat="server">
                            <table ID="groupPlaceholderContainer" runat="server" border="1" 
                                style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;font-family: Verdana, Arial, Helvetica, sans-serif;">
                                <tr ID="groupPlaceholder" runat="server">
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr runat="server">
                        <td runat="server" 
                            style="text-align: center;background-color: #FFCC66;font-family: Verdana, Arial, Helvetica, sans-serif;color: #333333;">
                            <asp:DataPager ID="DataPager2" runat="server" PageSize="12">
                                <Fields>
                                    <asp:NextPreviousPagerField ButtonType="Button" ShowFirstPageButton="True" 
                                        ShowLastPageButton="True" />
                                </Fields>
                            </asp:DataPager>
                        </td>
                    </tr>
                </table>
            </LayoutTemplate>
            <SelectedItemTemplate>
                <td runat="server" 
                    style="background-color: #FFCC66;font-weight: bold;color: #000080;">
                    Name:
                    <asp:Label ID="NameLabel" runat="server" 
                        Text='<%# Eval("Name") %>' />
                    <br />
                    Subject:
                    <asp:Label ID="SubjectLabel" runat="server" Text='<%# Eval("Subject") %>' />
                    <br />
                    Date:
                    <asp:Label ID="DateLabel" runat="server" Text='<%# Eval("Date") %>' />
                    <br />
                    Picture:
                    <asp:Label ID="PictureLabel" runat="server" Text='<%# Eval("Picture") %>' />
                    <br />
                    Content:
                    <asp:Label ID="ContentLabel" runat="server" Text='<%# Eval("Content") %>' />
                    <br />
                    Article_No:
                    <asp:Label ID="Article_NoLabel" runat="server" 
                        Text='<%# Eval("Article_No") %>' />
                    <br />
                    <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                        Text="Delete" />
                    <br />
                    <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
                    <br />
                </td>
            </SelectedItemTemplate>
        </asp:ListView>
        <asp:SqlDataSource ID="SqlDataSource2" runat="server" 
            ConnectionString="<%$ ConnectionStrings:siteDBConnectionString %>" 
            DeleteCommand="DELETE FROM [Articles] WHERE [Article_No] = @Article_No" 
            InsertCommand="INSERT INTO [Articles] ([Name], [Subject], [Date], [Picture], [Content]) VALUES (@Name, @Subject, @Date, @Picture, @Content)" 
            SelectCommand="SELECT [Name], [Subject], [Date], [Picture], [Content], [Article_No] FROM [Articles] WHERE ([Name] = @Name)" 

            UpdateCommand="UPDATE [Articles] SET [Name] = @Name, [Subject] = @Subject, [Date] = @Date, [Picture] = @Picture, [Content] = @Content WHERE [Article_No] = @Article_No">
            <DeleteParameters>
                <asp:Parameter Name="Article_No" Type="Int32" />
            </DeleteParameters>
            <InsertParameters>
                <asp:Parameter Name="Name" Type="String" />
                <asp:Parameter Name="Subject" Type="String" />
                <asp:Parameter Name="Date" Type="DateTime" />
                <asp:Parameter Name="Picture" Type="String" />
                <asp:Parameter Name="Content" Type="String" />
            </InsertParameters>
            <SelectParameters>
                <asp:ControlParameter ControlID="DropDownList1" Name="Name" 
                    PropertyName="SelectedValue" Type="String" />
            </SelectParameters>
            <UpdateParameters>
                <asp:Parameter Name="Name" Type="String" />
                <asp:Parameter Name="Subject" Type="String" />
                <asp:Parameter Name="Date" Type="DateTime" />
                <asp:Parameter Name="Picture" Type="String" />
                <asp:Parameter Name="Content" Type="String" />
                <asp:Parameter Name="Article_No" Type="Int32" />
            </UpdateParameters>
        </asp:SqlDataSource>
        <br />
        &nbsp;
        <br />
        <br />
    </asp:Panel>

</div>
</form> 
```

这是我放的代码：

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Web.UI;
    using System.Web.UI.WebControls;
    using System.IO;
    using System.Data.SqlClient;

    namespace WebApplication2
    {
     public partial class WebForm4 : System.Web.UI.Page
     {
    SqlConnection cnn = new SqlConnection(@"Data           Source=.\SQLEXPRESS;AttachDbFilename=C:\Documents and Settings\Moeman\My   Documents\siteDB.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void DateTextBox_TextChanged(object sender, EventArgs e)
    {

    }

    protected void ListView1_SelectedIndexChanged(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {

    }

    protected void UpdateButton_Click1(object sender, EventArgs e)
    {
        FileUpload fuimage = (FileUpload)ListView1.FindControl("fuimage");
        String fupload = fuimage.FileName;

        if (fuimage != null && fuimage.HasFile)
        {

            fuimage.SaveAs(Server.MapPath("~\\Images\\" + fupload.Trim()));

            string path = "~\\Images\\" + fupload.Trim();
            cnn.Open();
            SqlCommand cmd = new SqlCommand("update Articles set Picture=@Picture ", cnn);
            if (fuimage.HasFile)
            {
                cmd.Parameters.AddWithValue("@Picture", path);
            }
            else
            {
                cmd.Parameters.AddWithValue("@Picture", "");
            }
            cmd.ExecuteNonQuery();
            cnn.Close();
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-04T23:56:50.260

改为使用[`ListView.EditItem`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.edititem.aspx)来查找您的`FileUpload`控件。

```
FileUpload fuimage = (FileUpload)ListView1.EditItem.FindControl("fuimage"); 
```

# mysql - MySQL 如何完成这个 select concat？

> ID：10020860
> 
> 赞同：1
> 
> 时间：2012-04-04T23:49:11.783
> 
> 标签：mysql, select, concat

我有以下表格

[http://sqlfiddle.com/#!2/647e9](http://sqlfiddle.com/#!2/647e9)

如何选择 concat 显示如下

**期望的结果：**

```
+---------+-----------+---------------+---------------------------------+
| Origin  | Stock     | Farm Title    |            Farm Values          |
+---------+-----------+---------------+---------------------------------+
| US      | P1        | Perdue        |                             333 |
| US      | P3        | Holstein      |                             825 | 
| CA      | Q4        | FarmOne       |         455,536,617,698,779,860 |
| CA      | Q4        | Beef Farm     |         540,550,560,570,580,590 |
| CA      | Q4        | CattleOne     |   1080,1100,1120,1140,1160,1180 |
| MX      | B3        | Cow Mill      |                              11 |
| MX      | B3        | Dotterers     |                              98 | 
| MX      | B3        | AgriZone      |                             202 |
+---------+-----------+---------------+---------------------------------+ 
```

我试过了

```
Select
ORIGIN_NAME
STOCK_TITLE
FARM_TITLE
concat(FARM_VALUES, ",")

From Farm f
JOIN STOCK s on S.S_ID=f.S_ID
JOIN ORIGIN o on o.ORI_ID=s.ORI_ID 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:58:51.387

小提琴中的数据有点不同，所以结果并不完全正确，但这似乎是你想要的：

```
select origin_name, stock_title, farm_title, group_concat(FARM_COMPONENETS)  from ORIGIN o
inner join STOCK s on o.ORIGIN_ID = s.ORIGIN_ID
inner join FARM f on s.stock_id = f.stock_id 
inner join gate g on f.farm_id = g.farm_id
group by origin_name, stock_title, farm_title 
```

# c# - 使用 LinqToXSD，如何在不强制转换的情况下获取 xml 中的对象？

> ID：10020869
> 
> 赞同：2
> 
> 时间：2012-04-04T23:50:24.093
> 
> 标签：c#, xml, xml-serialization, linq-to-xml, linq-to-xsd

我正在使用这项技术将我的 XML 文件作为数据库进行管理。当我这样做时，通常我在库中创建类并使用 XSD.exe 我可以获得我的 XSD。

然后，使用 LinqToXSD 和生成的新 XSD，我可以访问数据。这是我的第一堂课，应该在我的课程中。

```
public class Foo
{
    string FirstName
    string LastName
} 
```

并访问我使用这个命名空间的数据

```
urn.foo 
```

我意识到，它们是两个不同的类，我的意思是我需要将这个类（来自 XSD 的 urn.foo）转换为真正的 Foo（第一个）。所以，我有两个不同的课程，我只想上一个！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T06:48:02.180

xsd.exe 生成`partial`类。因此，如果您将“真实”`Foo`放入与生成的程序集相同的名称空间中，也将其放入`partial`并删除任何重复的部分，那么您将只有一种`Foo`类型。

# xml - 如何删除 XSLT 中的特定子元素？

> ID：10020871
> 
> 赞同：3
> 
> 时间：2012-04-04T23:50:53.570
> 
> 标签：xml, xslt, xslt-2.0

我有一个这样的 XML 结构：

```
<root>
    <element>
        <name>Foo</name>
        <subelement>
             <key>1.1</key>
             <value>Lorem ipsum</value>
        </subelement>
        <subelement>
             <key>1.2</key>
             <value>Lorem ipsum dolor</value>
        </subelement>
    </element>
    <element>
        <name>Bar</name>
        <subelement>
             <key>7.3.4</key>
             <value>Seven three four</value>
        </subelement>
        <subelement>
             <key>7.3.8</key>
             <value>Seven three eight</value>
        </subelement>
        <subelement>
             <key>7.1</key>
             <value>Seven one</value>
        </subelement>
    </element>
</root> 
```

我试图实现的是删除`<subelement>`除具有“最高”键的 s 之外的所有 s 。我似乎找不到任何方法来比较`<key>`s 内的`<subelements>`s `<element>`。

生成的 XML 如下所示：

```
<root>
    <element>
        <name>Foo</name>
        <subelement>
             <key>1.2</key>
             <value>Lorem ipsum dolor</value>
        </subelement>
    </element>
    <element>
        <name>Bar</name>
        <subelement>
             <key>7.3.8</key>
             <value>Seven three eight</value>
        </subelement>
    </element>
</root> 
```

任何提示都非常受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T03:29:04.753

**此 XSLT 2.0 转换适用于键中任意数量的“关键组件”以及任何关键组件的任何可能的正整数值**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:my="my:my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
 "subelement
   [not(key eq my:max(../subelement/key))
   or
    key = preceding-sibling::subelement/key
   ]"/>

 <xsl:function name="my:max" as="xs:string">
   <xsl:param name="pValues" as="xs:string+"/>

   <xsl:sequence select=
    "if(not(distinct-values($pValues)[2]))
       then $pValues[1]
     else
      for $vMax1 in
             max(for $s in $pValues
                  return
                    xs:integer(substring-before(concat($s,'.'),'.'))
                 ),

          $vcntMax1Values in
             count($pValues[starts-with(., string($vMax1))])

        return
          if($vcntMax1Values eq 1)
            then $pValues[starts-with(., string($vMax1))]
                          [1]
            else
             for $submax in
                     (my:max(for $val in
                                    $pValues[starts-with(., string($vMax1))]
                                                [contains(., '.')],
                                    $subval in substring-after($val, '.')
                                return
                                    $subval
                             )
                      )
                 return
                   concat($vMax1, '.', $submax)

    "/>
 </xsl:function>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**（提供的文档，已扩展以使其更有趣）时：

```
<root>
    <element>
        <name>Foo</name>
        <subelement>
            <key>1.1</key>
            <value>Lorem ipsum</value>
        </subelement>
        <subelement>
            <key>1.2</key>
            <value>Lorem ipsum dolor</value>
        </subelement>
    </element>
    <element>
        <name>Bar</name>
        <subelement>
            <key>7.3.4</key>
            <value>Seven three four</value>
        </subelement>
        <subelement>
            <key>7.3.8</key>
            <value>Seven three eight</value>
        </subelement>
        <subelement>
            <key>7.3.8.1</key>
            <value>Seven three eight one</value>
        </subelement>
        <subelement>
            <key>7.3.8.1</key>
            <value>Seven three eight one</value>
        </subelement>
        <subelement>
            <key>7.1</key>
            <value>Seven one</value>
        </subelement>
        <subelement>
            <key>10.1</key>
            <value>Ten one</value>
        </subelement>
        <subelement>
            <key>10.1</key>
            <value>Ten one</value>
        </subelement>
    </element>
</root> 
```

**产生了想要的正确结果**：

```
<root>
   <element>
      <name>Foo</name>
      <subelement>
         <key>1.2</key>
         <value>Lorem ipsum dolor</value>
      </subelement>
   </element>
   <element>
      <name>Bar</name>
      <subelement>
         <key>10.1</key>
         <value>Ten one</value>
      </subelement>
   </element>
</root> 
```

**说明**：

**这个通用解决方案的核心是一个函数`my:max()`**，它给出一个非空的“结构化值”序列（结构化值是一个正整数序列，与“。”字符连接），产生一个（许多可能的）最大值。

**这个函数是递归的。它执行以下操作**：

1.  如果所有传递的值都相同，则返回其中的第一个。

2.  否则，找到第一个组件的最大值。

3.  如果只有一个值具有找到最大值的第一个分量，则返回此值。

4.  否则，找到具有最大第一个分量的所有值的“尾部”的最大值（递归）。

5.  最后，将在上一步中找到的最大的第一个分量与最大的“尾部”连接在一起——并返回这个值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-05T00:33:30.233

以下版本 2.0 XSLT

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="element">
        <xsl:variable name="sorted">
            <xsl:for-each select="subelement">
                <xsl:sort select="key"/>
                <xsl:copy-of select="."/>
            </xsl:for-each>
        </xsl:variable>
        <xsl:variable name="highest" select="$sorted/subelement[count($sorted/subelement)]/key"/>
        <element>
            <xsl:copy-of select="name"/>
            <xsl:copy-of select="subelement[key=$highest]"/>
        </element>
    </xsl:template>

</xsl:stylesheet> 
```

当应用于示例输入 XML 时，会生成所需的输出 XML

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <element>
        <name>Foo</name>
        <subelement>
            <key>1.2</key>
            <value>Lorem ipsum dolor</value>
        </subelement>
    </element>
    <element>
        <name>Bar</name>
        <subelement>
            <key>7.3.8</key>
            <value>Seven three eight</value>
        </subelement>
    </element>
</root> 
```

# c# - 使用自引用约束动态创建 ac# 泛型类型

> ID：10020872
> 
> 赞同：5
> 
> 时间：2012-04-04T23:50:56.637
> 
> 标签：c#, generics, reflection, reflection.emit

我有一个看起来像这样的通用类型

```
public class Entity<T> where T : Entity<T>{ ... } 
```

我需要动态构造类型 T。所以它看起来像这样：

```
public class MyClass : Entity<MyClass>{ ... } 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T00:11:33.160

```
AssemblyName assemblyName = new AssemblyName("TestAssembly");
AssemblyBuilder assemblyBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly(assemblyName, AssemblyBuilderAccess.Run);

ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule(assemblyName.Name);

TypeBuilder typeBuilder = moduleBuilder.DefineType("MyClass", TypeAttributes.Public);

Type entityType = typeof(Entity<>).MakeGenericType(typeBuilder);

typeBuilder.SetParent(entityType);

Type t = typeBuilder.CreateType(); 
```

# android - AsyncTask 的 Android 网络问题

> ID：10020873
> 
> 赞同：0
> 
> 时间：2012-04-04T23:50:57.337
> 
> 标签：android, multithreading, networking

我正在开发一个用于网络练习的 Android 应用程序，但我遇到了各种各样的问题。我有一个在我的计算机上运行的工作 C 服务器，我正在编写的应用程序旨在连接到服务器，进行身份验证，然后启动从服务器到客户端的文件传输。我对 Android 很陌生，最近才知道阻塞 UI 线程通常是被禁止的。

我创建了一个 AsyncTask 来帮助我解决这个问题。但是，当我调用它时，它完全失败了。但是，它并没有明显失败。我看到的唯一问题是我的主屏幕缩小并奇怪地四处移动。有时 UI 线程完全阻塞，操作系统告诉我我的应用程序没有响应，这对我来说没有任何意义，因为我正在处理阻塞的操作！

这是我用于 AsyncTask 的代码：

```
private class LoginTask extends AsyncTask<String, Void, Boolean> {

    @Override
    protected Boolean doInBackground(String... input) {
        int count = input.length;
        if (count != 4)
            return false;
        String ipAddress = input[0];
        int portNumberInt = Integer.parseInt(input[1]);
        String username = input[2];
        String password = input[3];
        // Step 0: Establish a connection to the server
        PrintWriter out;
        BufferedReader in;
        try {
            serverSocket = new Socket(ipAddress, portNumberInt);
            out = new PrintWriter(serverSocket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(serverSocket.getInputStream()));
        } catch (IOException e) {
            ((TextView)findViewById(R.id.textView1)).setText(e.getMessage());
            ((TextView)findViewById(R.id.textView2)).setText("");
            return false;
        }
        // Step 1: send "Authorize" to the server
        out.print("Authorize");
        // Step 2: server sends a random 64 character challenge string
        char[] buffer = new char[64];
        String challenge = null;
        try {
            in.read(buffer);
            challenge = new String(buffer);
        } catch (IOException e) {
            ((TextView)findViewById(R.id.textView1)).setText(e.getMessage());
            ((TextView)findViewById(R.id.textView2)).setText("");
            return false;
        }
        challenge = username + password + challenge;
        // Step 3: Compute MD5 hash of username + password + challenge and send it to the server
        MessageDigest md5;
        try {
            md5 = MessageDigest.getInstance("MD5");
        } catch (NoSuchAlgorithmException e) {
            return false;
        }
        byte[] digest = md5.digest(challenge.getBytes());
        out.print(digest);
        // Step 4: Server computes the same hash, determines whether or not to accept the connection
        String authResult;
        try {
            in.read(buffer);
            authResult = new String(buffer);
        } catch (IOException e) {
            ((TextView)findViewById(R.id.textView1)).setText(e.getMessage());
            ((TextView)findViewById(R.id.textView2)).setText("");
            return false;
        }
        if (authResult.equals("Pass")) {
            return true;
        } else {
            return false;
        }
    }

} 
```

这是调用 AsyncTask 的代码：

```
public boolean authenticate(final String ipAddress, final int portNumberInt, final String username, final String password) {
    try {
        Toast.makeText(getApplicationContext(), "Starting async task...", Toast.LENGTH_LONG).show();
        boolean result = new LoginTask().execute(ipAddress, Integer.toString(portNumberInt), username, password).get();
        Toast.makeText(getApplicationContext(), "Async task done!", Toast.LENGTH_LONG).show();
        return result;
    } catch (InterruptedException e) {
        Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
        return false;
    } catch (ExecutionException e) {
        Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
        return false;
    }

} 
```

什么可能导致这个问题？我正在运行我的服务器，但它没有显示任何已建立连接的迹象。如果是这种情况，那么我的代码永远不应该阻塞......对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:31:29.803

尽管我无法对您的问题给出明确的答案，但我会在这里解决许多问题。从你的问题中引用两句...

> 我最近才知道阻塞 UI 线程通常是被禁止的。

实际上，这不仅仅是“一般”禁止的，只是永远不要这样做。

> ...操作系统告诉我我的应用程序没有响应，这对我来说没有任何意义，因为我正在处理阻塞的操作！

由于您的`authenticate`方法中的这一行，这并不完全正确...

```
boolean result = new LoginTask().execute(<cut-for-clarity>).get(); 
```

您正在使用“等待”结果的`get()`方法，`AsyncTask`基本上将执行异步任务的调用转换为同步任务。

用于`get()`执行网络操作`AsyncTask`可能与简单地在 UI 线程上执行代码一样糟糕。我一直不明白为什么`AsyncTask`有这些`get(...)`方法。

我看到的下一个问题在以下代码中......

```
try {
    serverSocket = new Socket(ipAddress, portNumberInt);
    out = new PrintWriter(serverSocket.getOutputStream(), true);
    in = new BufferedReader(new InputStreamReader(serverSocket.getInputStream()));
} catch (IOException e) {
    ((TextView)findViewById(R.id.textView1)).setText(e.getMessage());
    ((TextView)findViewById(R.id.textView2)).setText("");
    return false;
} 
```

首先，您的`catch`块只是在寻找`IOException`. 创建您的套接字也可能会抛出`UnknownHostException`. 创建你的`PrintWriter`也可以扔`NullPointerException`等

其次，在您的`catch`块中，您试图设置两个`TextView`s 的文本。线程的第二条黄金法则（除了不阻塞 UI 线程）是永远不要尝试从 UI 线程以外的任何线程操作 UI 元素 - 它不会起作用。

所以基本上

1.  清理您的代码以至少处理相关异常 -如果需要，请`try{...} catch(Exception e) {...}`在everyting 周围放置一个泛型。`doInBackground(...)`
2.  不要使用以下`get()`方法`AsyncTask`
3.  摆脱任何试图操纵 UI 元素的东西`doInBackground(...)`
4.  查看 logcat 以查看失败的原因以及在哪一行。

**编辑：**

> 更一般地说，如何将信息从 AsyncTask 传递回 UI 线程？

这完全是在 UI 线程上执行的`onPostExecute(...)`方法的重点。`AsyncTask`

`doInBackground(...)`不仅用于身份验证，还用于下载您需要的文件。如果有任何问题，请将`false`结果传递给`onPostExecute(...)`该方法并让该方法创建某种警报或错误消息，然后进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:37:52.780

如果您在计算机上运行 C 服务器，则需要在 android 上运行客户端。客户端将使用 Socket。您正在使用 ServerSocket ...

# javascript - 在 JavaScript 循环之外声明变量对速度和内存有好处吗？

> ID：10020875
> 
> 赞同：4
> 
> 时间：2012-04-04T23:51:16.077
> 
> 标签：javascript, jquery

C# 也有类似的问题，但我们没有看到 JavaScript 的任何问题。

在循环内声明变量是公认的做法吗？

假设一个循环有 200 次迭代。

在样本 1 上使用样本 2 是否有性能要求（内存和速度）？我们正在使用 jQuery 进行循环。它提高了我们将 var 保留在循环内的代码可读性，但如果这不是最佳实践，或者会导致性能显着降低或内存使用量增加，我们将进行切换。

```
**Sample 1:**
$(this).each( function() {
   var i = $(some_div).clone();
   *** edit i ***
   $(another_div).append( i );
});

**Sample 2:**
var i = null;
*** edit i ***
$(this).each( function() {
   i = $(some_div).clone();
   $(another_div).append( i );
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:58:50.517

样本 1（内部变量）更快：http: [//jsperf.com/variable-outside-faster](http://jsperf.com/variable-outside-faster)

但这种差异并不值得关心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T00:24:07.487

这是一个微优化，停止这样做。

而是将精力投入到编写可读代码以及为代码编写文档和测试上。

但是，有一些高级问题值得优化：

*   删除像 jQuery 这样让你慢一个数量级的臃肿抽象。
*   减少您在屏幕上进行的渲染和绘图量
*   降低算法的大 O 复杂度
*   减少服务器-客户端行程的延迟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:58:56.390

这将取决于实施，但原则上我认为性能不会有任何明显差异。由于您使用 jQuery 进行循环，因此`i`变量将在第一种情况下位于函数范围内，而在第二种情况下位于外部范围内。这对内存分配的影响可能略有不同，但我怀疑它是否会引起注意。确保它选择实现并尝试衡量其中性能的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:07:36.810

这些在语义上可能不同，因此这是一个苹果与橘子的比较：例如，如果您使用的是`i`内部 ajax 回调而不是同步，那么您几乎肯定会`i`多次使用最后一次赋值，而不是使用每个不同的值（如果您进行了此更改） .

**纯猜测如下：**

因此我们知道，如果您使用`var`内部表单的全部潜力，您将需要每个 不同的内存地址`i`，那么它必须做更多的工作。

需要大量分析才能确定`$.each`同步使用它的回调参数。因此，*如果*这是一个有效的优化，我怀疑大多数 JS 编译器将无法做到这一点，而手工制作应该会给你（恒定时间）速度和内存改进。

**其他注意事项：**

更多的词法范围可能意味着查找变量的成本线性增加。

# apache - 这个 apache 设置有什么问题？

> ID：10020879
> 
> 赞同：0
> 
> 时间：2012-04-04T23:51:37.563
> 
> 标签：apache, apache2, virtual-hosts

下面是我的 /etc/apache2/sites_available/default 文件。

我已将 mysite.com 指向 /etc/hosts 中的 localhost，当从运行它的同一台机器访问该网站时，该网站工作正常。

但是，如果我有第二台机器，编辑它的 /etc/hosts 并将 mysite.com 指向第一台机器，那么 apache 只会提供一般`Not Found: The requested URL / was not found on this server`消息。（如果我在第一台机器上导航到[http://127.0.0.1](http://127.0.0.1)而不是使用名称 mysite.com，则会收到完全相同的消息） access.log 或 error.log 中没有任何内容，但 other_vhosts_access.log 中有内容

为什么会发生这种情况，我该如何解决？另外，当我踢 Apache 时，它​​会说`NameVirtualHost *:80 has no VirtualHosts`，以防万一。

这是配置文件：

```
<VirtualHost mysite.com:80>
    ServerName mysite.com
    ServerAdmin webmaster@mysite.com

    DocumentRoot /var/www/mysite.com/public_html
    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>
    <Directory /var/www/mysite.com/public_html>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel info

    ErrorLog ${APACHE_LOG_DIR}/mysite.com.error.log
    CustomLog ${APACHE_LOG_DIR}/mysite.com.access.log combined
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-04T23:53:50.350

我相信您的问题出在您的`<VirtualHost mysite.com:80>`. 我会尝试`<VirtualHost *:80>`。

如果我没记错的话，那个位置应该是流量进入的 IP。我只知道当我配置我的 Web 服务器时，我总是在那个位置使用“*”或服务器的静态 IP。

# python - 如何在 pylucene 3.5 中实例化 StandardAnalyzer？版本对象在哪里？

> ID：10020880
> 
> 赞同：1
> 
> 时间：2012-04-04T23:51:43.437
> 
> 标签：python, lucene, pylucene

我正在尝试使用 PyLucene，但我找不到任何在我当前版本中实际运行的代码示例。（例如，参见[http://nullege.com/codes/search/PyLucene.StandardAnalyzer](http://nullege.com/codes/search/PyLucene.StandardAnalyzer)）。

在某些时候，您需要实例化一个分析器。看起来这应该通过调用 lucene.StandardAnalyzer() 来完成。但是，这给出了一个错误：

```
lucene.InvalidArgsError: (<type 'StandardAnalyzer'>, '__init__', ()) 
```

错误的原因很清楚： http: [//lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/core/index.html](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/core/index.html)上的 StandardAnalyzer 文档说它需要一个 Version 对象的参数.

**那么我从哪里得到一个版本对象呢？**

以下内容已出现在代码示例中，但实际上不起作用：

*   lucene.Version.LUCENE_CURRENT
*   lucene.Version.LUCENE_30

这些名称是未定义的。这是我的 lucene.Version 类中的内容：

```
>>> print dir(lucene.Version)
['__class__', '__delattr__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '_jobject', 'cast_', 'class', 'compareTo', 'declaringClass', 'equals', 'getClass', 'getDeclaringClass', 'hashCode', 'instance_', 'name', 'notify', 'notifyAll', 'of_', 'onOrAfter', 'ordinal', 'parameters_', 'toString', 'valueOf', 'values', 'wait'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-31T21:48:52.060

现在，PyLucene 版本的 tarball 有一个“samples”目录，其中包含适用于该特定版本的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T20:22:49.487

我想通了，现在我终于可以将其发布为答案：

运行后`lucene.initVM()`，lucene.Version 对象将填充各种版本对象，例如`lucene.Version.LUCENE_35`.

并且有一个有效的 PyLucene 示例：

[http://metaoptimize.com/blog/2010/08/09/pylucene-3-0-in-60-seconds-tutorial-sample-code-for-the-3-0-api/](http://metaoptimize.com/blog/2010/08/09/pylucene-3-0-in-60-seconds-tutorial-sample-code-for-the-3-0-api/)

# jquery - 基于Jquery中的属性值排序Divs

> ID：10020881
> 
> 赞同：4
> 
> 时间：2012-04-04T23:51:44.943
> 
> 标签：jquery

我有几个这样的div

```
<div rel="5">
  Divs content goes here
</div>
<div rel="3">
   Div 3 Here
</div>
<div rel="4">
  Div 4 Here
 </div>
 <div rel="4.5">
   Div 4.5 here
</div> 
```

您将如何使用 Jquery 对 div 进行排序，以便在 DOM 中对它们进行物理排序，首先使用最少的 rel 属性？

例如 3、4、4.5、5

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-05T02:48:53.370

看我的小提琴：http: [//jsfiddle.net/6hpNz/8/](http://jsfiddle.net/6hpNz/8/)

您可以利用 javascript 和 jQuery 的组合很容易地做到这一点：

给定以下 HTML：

```
<div class="unsorted">
    <div rel="5">
      Div 5 here
    </div>
    <div rel="3">
       Div 3 Here
    </div>
     <div rel="4.5">
       Div 4.5 here
    </div>
    <div rel="4">
      Div 4 Here
     </div> </div>
<div class="sorted"></div> 
```

此脚本将为您提供所需的输出：

```
$(document).ready(function () {
    var sortedDivs = $(".unsorted").find("div").toArray().sort(sorter);
    $.each(sortedDivs, function (index, value) {
        $(".sorted").append(value);
    });
});

function sorter(a, b) {
    return a.getAttribute('rel') - b.getAttribute('rel');
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T02:10:51.450

我确信有一种更有效的方法，但无论如何这是我的答案：

HTML：

```
<div rel="5">
      Divs content goes here
    </div>
    <div rel="3">
       Div 3 Here
    </div>
    <div rel="4">
      Div 4 Here
     </div>
     <div rel="4.5">
       Div 4.5 here
    </div> 
```

jQuery：

```
var array = new Array();

$('div').each(function(){   
    array.push($(this).attr('rel'));
});

array = array.sort();

var reordedDivs = "";

$.each(array, function(i, obj1){

    $('div').each(function(j, obj2) {

        if ($(obj2).attr('rel') == obj1) {

            var divContent = $(obj2).html();
            var rel = obj1;

         reordedDivs += "<div rel='" + rel + "'>" + divContent + "</div>";

        }

            });  
});

$('body').html(reordedDivs); 
```

小提琴：http: [//jsfiddle.net/F6csV/17/](http://jsfiddle.net/F6csV/17/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-04T23:57:26.163

您可以使用 DOM 方法选择元素，将 DOM 列表转换为 Array，然后使用[`Array.sort()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort).

# json - 在快速 Web 服务器中访问 JSON 值

> ID：10020884
> 
> 赞同：1
> 
> 时间：2012-04-04T23:51:52.563
> 
> 标签：json, web-services, parsing, node.js, express

我能够使用[此答案](https://stackoverflow.com/questions/10005939/how-to-consume-json-post-data-in-an-express-application)中的代码来访问发布到服务器的 JSON 字符串中的值。

如果服务器获取，则可以使用 访问`{"MyKey":"My Value"}`的值。`"MyKey"``request.body.MyKey`

但是发送到我的服务器的 JSON 字符串如下所示：

```
[{"id":"1","name":"Aaa"},{"id":"2","name":"Bbb"}] 
```

我找不到访问其中任何内容的方法。你怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T02:33:54.297

`request.body`是一个标准的 JavaScript 对象，在你的例子中是一个普通的 JavaScript 数组。您可以`request.body`像处理任何 JavaScript[`Array`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array)对象一样处理。例如

```
app.post('/', function(request, response){
  var users = request.body;
  console.log(users.length);   // the length of the array

  var firstUser = users[0];    // access first element in array
  console.log(firstUser.name); // log the name

  users.forEach(function(item) { console.log(item) }); // iterate the array logging each item

  ... 
```

# python - 创建带有条目字段的弹出消息框

> ID：10020885
> 
> 赞同：15
> 
> 时间：2012-04-04T23:51:57.517
> 
> 标签：python, tkinter, user-input

我想创建一个弹出消息框，提示用户输入输入。我在一个类中有这个方法。我的代码基于[java2s 的本指南](http://www.java2s.com/Code/Python/GUI-Tk/Getinputvaluefromadialog.htm)。

```
class MyDialog:
    def __init__(self, parent):
        top = self.top = Toplevel(parent)

        Label(top, text="Value").pack()

        self.e = Entry(top)
        self.e.pack(padx=5)

        b = Button(top, text="OK", command=self.ok)
        b.pack(pady=5)

    def ok(self):
        print "value is", self.e.get()
        self.top.destroy()

root = Tk()
d = MyDialog(root)

root.wait_window(d.top) 
```

但在这方面，`top = self.top = Toplevel(parent)`对我不起作用。

我有一个我想要完成的模型。

![图形用户界面样机](../Images/e39731e408c497bdd66b84b75ecd53c9.png)

我的程序结构如下所示：

```
class MainUI:
   def__int__(self):
       ...
       self.initUI()

   def initUI(self):
       .......
       Popup = Button(self, text="Enter Value", command=self.showPopup)

   def showPopup(self):
       #create the popup with an Entry here 
```

如何在 Python 中创建一个接受用户输入的消息框？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-05T00:41:18.763

我对你的两个不同的代码块有点困惑。只处理第一块代码，什么都没有发生，因为您从未进入主循环。为此，您需要调用`root.mainloop()`. 执行此操作的典型方法是向根小部件添加一个按钮并将回调函数绑定到 Button（包括`d=MyDialog()`和`root.wait_window(d.top)`）

这是一些基本代码，我希望它们能满足您的需求...

```
from Tkinter import *
import sys

class popupWindow(object):
    def __init__(self,master):
        top=self.top=Toplevel(master)
        self.l=Label(top,text="Hello World")
        self.l.pack()
        self.e=Entry(top)
        self.e.pack()
        self.b=Button(top,text='Ok',command=self.cleanup)
        self.b.pack()
    def cleanup(self):
        self.value=self.e.get()
        self.top.destroy()

class mainWindow(object):
    def __init__(self,master):
        self.master=master
        self.b=Button(master,text="click me!",command=self.popup)
        self.b.pack()
        self.b2=Button(master,text="print value",command=lambda: sys.stdout.write(self.entryValue()+'\n'))
        self.b2.pack()

    def popup(self):
        self.w=popupWindow(self.master)
        self.b["state"] = "disabled" 
        self.master.wait_window(self.w.top)
        self.b["state"] = "normal"

    def entryValue(self):
        return self.w.value

if __name__ == "__main__":
    root=Tk()
    m=mainWindow(root)
    root.mainloop() 
```

我从 popupWindow 获取值并在主程序中使用它（看看与 b2 关联的 lambda 函数）。

主窗口：

[![主窗口](../Images/d8ec0f0df3715dad09ae9b0e499e49ff.png)](https://i.stack.imgur.com/KhTMq.png)

“点我”窗口：

[![点我窗口](../Images/cca3e35d8c5d0ce4702bfd9eb6c1fd6b.png)](https://i.stack.imgur.com/AA7mp.png)

“点击我”打开时的主窗口：

[![主窗口变灰](../Images/6acefbfd5919b05e100e0093af0b5d14.png)](https://i.stack.imgur.com/xHAeJ.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2020-07-01T08:13:04.167

```
import tkinter as tk
from tkinter import simpledialog

ROOT = tk.Tk()

ROOT.withdraw()
# the input dialog
USER_INP = simpledialog.askstring(title="Test",
                                  prompt="What's your Name?:")

# check it out
print("Hello", USER_INP) 
```

享受 ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-10T02:02:13.127

我在没有任何课程的情况下在 Tkinter 中完成了它。我创建了一个启动新窗口的函数。

```
popup.Tk()
popup.mainloop() 
```

在那个窗口中，有一个 Entry 字段，我从中获取带有变量的文本，该变量的值为：`entry.get()`

然后，您可以将该变量用于您需要的任何内容，它将从该条目字段中获取文本。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-07-13T02:14:14.590

我刚试过这个：

def get_me(): s = simpledialog.askstring("输入字符串", "请输入您添加的文本")

来源：[https ://www.youtube.com/watch?v=43vzP1FyAF8](https://www.youtube.com/watch?v=43vzP1FyAF8)

# header - Fmod 包含错误

> ID：10020888
> 
> 赞同：0
> 
> 时间：2012-04-04T23:52:36.073
> 
> 标签：header, c++-cli, fmod

我正在制作一个 C++ 程序来播放一些 mp3 文件并且遇到了麻烦。我收到未找到标识符的错误。除了包括标题之外，任何人都可以给我一些建议吗？

这是我的代码：

```
#include "fmod.h"
#include "windows.h"
#include <string>
#include <iostream>
#include <msclr\marshal_cppstd.h>
#include <conio.h>

#pragma comment (lib, "fmodex64_vc.lib")

using namespace System;
using namespace System::ComponentModel;
using namespace System::Collections;
using namespace System::Windows::Forms;
using namespace System::Data;
using namespace System::Drawing;
using namespace std;

/// <summary>
/// Summary for Form1
/// </summary>
public ref class Form1 : public System::Windows::Forms::Form
{

public:
    FSOUND_SAMPLE* handle;
    Form1(void)
    {
        InitializeComponent();
        //
        //TODO: Add the constructor code here
        //
    }

protected:
    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    ~Form1()
    {
        if (components)
        {
            delete components;
        }
    }
private: System::Windows::Forms::TextBox^  textBox1;
protected: 
private: System::Windows::Forms::Label^  label1;
private: System::Windows::Forms::ListBox^  list;
private: System::Windows::Forms::Button^  button1;
private: System::Windows::Forms::Button^  button2;

private:
    /// <summary>
    /// Required designer variable.
    /// </summary>
    System::ComponentModel::Container ^components;

#pragma region Windows Form Designer generated code
    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    void InitializeComponent(void)
    {
        this->textBox1 = (gcnew System::Windows::Forms::TextBox());
        this->label1 = (gcnew System::Windows::Forms::Label());
        this->list = (gcnew System::Windows::Forms::ListBox());
        this->button1 = (gcnew System::Windows::Forms::Button());
        this->button2 = (gcnew System::Windows::Forms::Button());
        this->SuspendLayout();
        // 
        // textBox1
        // 
        this->textBox1->Location = System::Drawing::Point(97, 23);
        this->textBox1->Name = L"textBox1";
        this->textBox1->Size = System::Drawing::Size(518, 20);
        this->textBox1->TabIndex = 0;
        this->textBox1->TextChanged += gcnew System::EventHandler(this, &Form1::textBox1_TextChanged);
        // 
        // label1
        // 
        this->label1->AutoSize = true;
        this->label1->Location = System::Drawing::Point(12, 26);
        this->label1->Name = L"label1";
        this->label1->Size = System::Drawing::Size(79, 13);
        this->label1->TabIndex = 1;
        this->label1->Text = L"Libray Location";
        // 
        // list
        // 
        this->list->FormattingEnabled = true;
        this->list->Location = System::Drawing::Point(15, 80);
        this->list->Name = L"list";
        this->list->Size = System::Drawing::Size(757, 472);
        this->list->TabIndex = 2;
        // 
        // button1
        // 
        this->button1->Location = System::Drawing::Point(697, 571);
        this->button1->Name = L"button1";
        this->button1->Size = System::Drawing::Size(75, 23);
        this->button1->TabIndex = 3;
        this->button1->Text = L"Play";
        this->button1->UseVisualStyleBackColor = true;
        this->button1->Click += gcnew System::EventHandler(this, &Form1::button1_Click);
        // 
        // button2
        // 
        this->button2->Location = System::Drawing::Point(616, 571);
        this->button2->Name = L"button2";
        this->button2->Size = System::Drawing::Size(75, 23);
        this->button2->TabIndex = 4;
        this->button2->Text = L"Refresh";
        this->button2->UseVisualStyleBackColor = true;
        this->button2->Click += gcnew System::EventHandler(this, &Form1::button2_Click);
        // 
        // Form1
        // 
        this->AutoScaleDimensions = System::Drawing::SizeF(6, 13);
        this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
        this->ClientSize = System::Drawing::Size(784, 606);
        this->Controls->Add(this->button2);
        this->Controls->Add(this->button1);
        this->Controls->Add(this->list);
        this->Controls->Add(this->label1);
        this->Controls->Add(this->textBox1);
        this->Name = L"Form1";
        this->Text = L"Form1";
        this->ResumeLayout(false);
        this->PerformLayout();

    }

    private: System::Void textBox1_TextChanged(System::Object^  sender, System::EventArgs^  e) {

    }
    private: System::Void button2_Click(System::Object^  sender, System::EventArgs^  e) {
        msclr::interop::marshal_context context;
        std::string standardString = context.marshal_as<std::string>(textBox1->Text);
        GetAllFiles(standardString);
        //list->Items->Add();

    }

    void GetAllFiles(string sPath){
    WIN32_FIND_DATA FindFileData;
    string sTmpPath = sPath;
    sTmpPath += "\\*.*";

    HANDLE hFind = FindFirstFile( sTmpPath.c_str(), &FindFileData );

    if ( hFind == INVALID_HANDLE_VALUE )
        return;
    else {
        do {
            if ( ( FindFileData.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY ) ) {
        // if directory:
                if ( strcmp(".", FindFileData.cFileName ) && strcmp("..", FindFileData.cFileName) ) {
            sTmpPath = sPath;
                    sTmpPath += "\\";
            sTmpPath += FindFileData.cFileName;
                    GetAllFiles( sTmpPath.c_str() );
                }
            }
            else // if file:
            {
                sTmpPath = sPath;
                sTmpPath += "\\";
                sTmpPath += FindFileData.cFileName;
                string fileType = sTmpPath.substr(sTmpPath.length()-3, sTmpPath.length());
                if(fileType == "mp3"){
                    String^ myTempPath = gcnew String(sTmpPath.c_str());
                    list->Items->Add(myTempPath);//cout << sTmpPath << endl;
                }
            }
        } while ( FindNextFile( hFind, &FindFileData) != 0 );

        FindClose( hFind );
    }
    return;
}

    private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
        // init FMOD sound system
        FSOUND_Init (44100, 32, 0);

        // load and play mp3
        handle=FSOUND_Sample_Load (0,"E:\\Steve\\Music\\2 Pac\\Unknown Album\\Temptations.mp3",0, 0, 0);
        FSOUND_PlaySound (0,handle);
        FSOUND_Sample_Free (handle);
        FSOUND_Close();
    } 
```

};

这是我的错误：

```
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(26): error C2143: syntax error : missing ';' before '*'
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(26): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(26): error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(187): error C3861: 'FSOUND_Init': identifier not found
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h (190): error C2065: 'handle' : undeclared identifier
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(190): error C3861: 'FSOUND_Sample_Load': identifier not found
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(191): error C2065: 'handle' : undeclared identifier
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h (191): error C3861: 'FSOUND_PlaySound': identifier not found
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(192): error C2065: 'handle' : undeclared identifier
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(192): error C3861: 'FSOUND_Sample_Free': identifier not found
1>c:\users\steve\documents\visual studio 2010\projects\testforms\testforms\Form1.h(193): error C3861: 'FSOUND_Close': identifier not found
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:05:03.207

嗯，仔细检查一下你的头文件末尾是否有分号，如果你定义了它“#ifndef”......很容易忘记

# php - 确保在 PHP 中编写文件在尽可能多的服务器上工作的方法

> ID：10020889
> 
> 赞同：0
> 
> 时间：2012-04-04T23:52:45.850
> 
> 标签：php

一些服务器想要 777 的权限，一些阻止超过 755 的任何文件，一些阻止您想要用来更改它的 chmod 函数等等。我想使用 file_get_contents 将简单文件写入服务器，但在脚本中将在许多不同的服务器上分发和使用，这些服务器非常多样化。假设至少 PHP5，写入/覆盖简单文本文件的最“跨服务器”和“跨主机”方式是什么？我以前使用过这样的东西：

```
@chmod($filePath, 0755);
$result = file_put_contents($filePath, $fileData); 
```

假设它可以在尽可能多的服务器上工作：如果可以，请设置权限，但如果不能，则没有错误（因为某些服务器 file_put_contents 工作正常，但它会在 chmod 上引发实际上不需要的错误，但其他服务器需要 chmod）。但是必须有一个可以在每个可以想象的服务器附近运行的解决方案（假设 PHP5+）。这里有没有人有更好的方法的更多经验？

**澄清：**

我不指望任何人来拯救世界，也许它不能适用于每台服务器，但我们仍然可以让它在尽可能多的服务器上运行，这就是我希望完成的。至少让我们用尽所有方法来解决尽可能多的问题，并尝试以尽可能多的方式编写它。

例如：

```
file_put_contents($filePath, $fileData); 
```

写入文件。耶！但在某些服务器上或在某些情况下，它可能会因为文件权限而失败。当。所以让我们让它变得更好一点。

```
chmod($filePath, 0777);
file_put_contents($filePath, $fileData); 
```

现在它首先更改权限！酷，在更多人的服务器上工作！但是等等，一些服务器拒绝 0777，所以也许 0755 会比 0777 更多的服务器工作。

```
chmod($filePath, 0755);
file_put_contents($filePath, $fileData); 
```

太好了，现在它适用于更多人的服务器。但是等等：一些服务器阻止了 chmod 功能。但这并不意味着该文件已经不可写，这只是一个备份，以防万一它不可写，所以仍然至少尝试编写它，但不要在 chmod 没有的服务器上抛出错误'不工作，因为它无论如何都可以很好地工作（我们总是可以测试它是否在之后这样做，所以它不会默默地失败）。

```
@chmod($filePath, 0755);
file_put_contents($filePath, $fileData); 
```

等等等等。看看我是如何添加功能以尝试更多方法让它工作的，同时确保我不会破坏它已经工作的地方？我不是要求任何人“无论如何都要让 chmod 工作”。我在问是否有人有继续这种思路的经验，找到了更多可以避免的文件写入失败的地方，并在他们的片段中解释它们，直到它成为最好的文件写入片段，工作在尽可能多的地方。也许不是在任何地方，但在上面代码片段的更多地方。我知道肯定有人在比我更多样化的服务器环境方面有经验，并且可以比我做得更好（或已经做到了），所以我在问！

**基于反馈的补充：**

1) 一种反馈是权限在不同服务器上的工作方式不同。从技术上讲，是的。但在某些方面，事情并不是那么简单。

一些服务器设置为...反叛是一个很好的词...如果您将文件权限设置为比 755 更宽松，例如 777，并且根本不让文件被读取/写入/执行，只需返回 500 错误。在其他服务器上，根据服务器，您的 php 代码似乎不是文件的“所有者”，在这种情况下，我假设组需要 7 作为墙，或者文件所有权需要更改（这会带来了另一组“跨服务器”的复杂性）。我承认我可能理解错误的根源（如果是这种情况，那是我希望澄清的另一件事，有人对问题有更深入的了解并因此提出了更优雅的解决方案！） ,**不能**像理论上那样在每台服务器上工作（事实上我想说它只适用于我的客户安装了这种类型的代码片段的服务器中的大约 90%）。所以我想问是否有人以这种方式处理过许多服务器，并且有一种更防弹的方法：一种可以绕过随机主机如何设置服务器之间的各种差异的方法。我假设它将有多个步骤，首先确保文件是可写的，然后多次尝试以各种方式编写文件本身。

2) 是的，文件需要持久化，这就是重点:) 例如编辑 XML 文件或在 CMS 中创建新的 html 页面。并将其扼杀在萌芽状态：不要给我“您应该使用数据库获取信息，而不是编写文件”。这也有它的位置，不过我问了一个*不同*的问题，关于写文件，因为有时你也需要这样做：P

3) 我知道在某些情况下您根本无法写入文件。但我要问的是，是否有人有将其*最小化*的经验，以便它在尽可能多的情况下工作。我知道我上面所拥有的并不是人类可能的最普遍的片段，所以我在问可能是什么:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T13:10:48.390

我不是服务器之间差异方面的专家，所以这就是为什么我希望从有人那里得到答案，但显然编码的创造力不是 PHP 社区的强项:) 所以我自己写了一个，并且虽然比只调用 chmod 然后调用 file_put_contents 好得多，但我不是服务器专家，我认为它可以更好......但总比没有好。（脚本适用于我测试过的超过 99% 的服务器，而 85%-90% 的服务器只调用 chmod 然后 file_put_contents 正在运行）。

```
function makeFileWritable($filename, $perm = 0755)
{
    if (!file_exists($filename))
    {
        $folderpath = dirname($filename);
        if(is_writable($folderpath)) return true;

        @chmod($folderpath, $perm);
        if(is_writable($folderpath)) return true;

        if ($perm == 0755) return makeFileWritable($filename, 0775);
        return false;
    }
    else
    {
        $folderpath = dirname($filename);
        if(is_writable($folderpath) && is_writable($filename)) return true;
        if (!is_writable($folderpath)) @chmod($folderpath, $perm);
        if (!is_writable($filename)) @chmod($filename, $perm);
        if (is_writable($folderpath) && is_writable($filename)) return true;

        if ($perm == 0755) return makeFileWritable($filename, 0775);
        return false;
    }
}

@makeFileWritable($filePath);
$result = file_put_contents($filePath, $writeData); 
```

基本上你在预期的文件路径上调用@makeFileWritable。如果文件存在，它会尝试将文件权限和包含它的文件夹的权限设置为 0755，如果文件不存在，它只会尝试将其包含文件夹的权限更改为 0755。一旦完成，它会尝试确定文件现在是否可写。如果是，那么它就完成了。如果不是，那么它会再次调用自己（以某种递归方式），但这次尝试对 0775 做同样的事情，以防服务器需要它是组可写的才能工作。但无论如何，它不会返回任何错误并仍然尝试写入文件，以防文件一直是可写的，但我们确定它是否可写的测试不准确（如果第一部分静默失败也没关系）失败，

所以你去吧，那个脚本使我的 10 个不写文件的服务器中有 1 个或 2 个变成了基本上 0 个不写文件的服务器……一个 AS3/JS 程序员在一堆之后写了它的 PHP 程序员告诉他问题不存在或无法解决。我认为需要为 PHP 社区注入更多的创造力，我希望他们能有一点创造性，并提出一些改进建议，因为我怀疑作为一个非 PHP 专家，我是否已经做到了这一点： (

# iphone - 初始化后在视图控制器中加载/刷新新数据

> ID：10020890
> 
> 赞同：0
> 
> 时间：2012-04-04T23:52:58.500
> 
> 标签：iphone, refresh, init

我有一个包含建筑信息（字符串）的建筑类。当我推动我的 DetailViewController（不是来自 tableviewcontroller）时，我推动了与它一起使用的建筑物，它加载了正确的信息。我想要做的是在下一个构建实例中加载的详细视图上有一个按钮。我尝试了以下但没有运气 - 所有数据都变为空白/空。我一定没有正确连接到我的建筑物阵列。

在我的 mainViewController

```
-(IBAction)pushDetailsVC:(id)sender {

    DetailViewController* controller = [[DetailViewController alloc] init]; 
    // Pass the Building object to the controller
    building = [self.buildings objectAtIndex:nsu_selBldg];
    controller.building = building;
    NSLog(@"Building name is now: %@", building);
    [self presentModalViewController:controller animated:YES];
    [controller.uib_backButton addTarget:self action:@selector(close:) forControlEvents:UIControlEventTouchUpInside];
    [controller release];
} 
```

在我的 DetailViewController // h 中有

```
@property (nonatomic, retain) Building *building;
@property (nonatomic, retain) PhotoViewerViewController *photoVC; 
```

//m 有

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // This works as expected - the data loads in great.
    self.uill_bldgName.text = self.building.name;
    self.uitt_bldgInfo.text = self.building.bldgInfo;
    self.uiivv_bldgPlan.image = [UIImage imageNamed:self.building.bldgPlan];
    self.uiivv_bldgImage.image = [UIImage imageNamed:self.building.bldgImageZoom];
    NSLog(@"first name%@",self.building.bldgImageZoom);
}

-(IBAction)nextBldg {
    // This does not work - data goes null. PhotoVC is my main view controller and buildings is the array of buildings
    building = [photoVC.buildings objectAtIndex:2];
    Building *building = building;
    NSLog(@"building %@",building);
    NSLog(@"building %@",[photoVC.buildings objectAtIndex:2]);  
    self.uill_bldgName.text = self.building.name;
    self.uitt_bldgInfo.text = self.building.bldgInfo;
    self.uiivv_bldgPlan.image = [UIImage imageNamed:self.building.bldgPlan];
    self.uiivv_bldgImage.image = [UIImage imageNamed:self.building.bldgImageZoom];
    NSLog(@"secon name %@",self.building.bldgImageZoom);    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:14:13.687

我看不到您在哪里初始化 photoVC。没有初始化，你肯定没有建筑数据。

更好的方法是将构建数组（和当前索引 nsu_selBldg）传递给 DetailViewController。然后它将可以访问它想要的任何建筑物。

```
// DetailVC.h

@property (nonatomic, retain) NSArray *buildings;
@property (nonatomic, assign) NSUInteger currentIndex;

// DetailVC.m

Building *currentBuilding = [self.buildings objectAtIndex:self.currentIndex];
NSUInteger nextIndex = (self.currentIndex == self.buildings.count-1)? 0 : self.currentIndex+1;
Building *nextBuilding = [self.buildings objectAtIndex:nextIndex]; 
```

# mysql - MySQL：返回空字段而不是没有行

> ID：10020891
> 
> 赞同：1
> 
> 时间：2012-04-04T23:53:16.680
> 
> 标签：mysql

我有两张表，一张用于英文类别名称，另一张用于西班牙类别名称。

我正在尝试编写一个小界面，允许管理员查看仍必须为哪些英语类别提供翻译。

我会假设当您创建西班牙语类别时，它会继承英语类别的 ID。

要获得相应类别的结果集，我有以下查询：

```
SELECT tbl_cms_categories_en.id as id, 
   tbl_cms_categories_en.name as en, 
   tbl_cms_categories_es.name as es 
FROM   tbl_cms_categories_en, tbl_cms_categories_es 
WHERE  tbl_cms_categories_en.id = tbl_cms_categories_es.id 
```

这会返回一个很好的条目列表：

![在此处输入图像描述](../Images/abd0ca12a4618d37e071a065653185fe.png)

这很好地满足了我的目的，但有一个不足之处。如果西班牙表中没有行，则它根本不返回派生行。

我怎样才能更改我的查询，以便如果英语表中有一行但西班牙语表中没有，我可以返回派生行说“未找到翻译”。

类似于：

```
ID = 8, en = "Security", es = "Translation Not Found" 
```

任何指导将不胜感激。

谢谢大佬！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-04T23:56:04.733

尝试

```
SELECT tbl_cms_categories_en.id as id, 
   en.name as en_name, 
   IF(es.name IS NULL, "No Translation Found", es.name) as es_name 
FROM   tbl_cms_categories_en AS en
LEFT JOIN tbl_cms_categories_es AS es
    ON tbl_cms_categories_en.id = tbl_cms_categories_es.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-04T23:58:50.960

为什么不将所有西班牙语行的默认值设置为“找不到翻译”？

只是一个建议...

# svn - How to find out if 'svn up' finished successfully?

> ID：10020901
> 
> 赞同：4
> 
> 时间：2012-04-04T23:54:48.940
> 
> 标签：svn

I run `sudo svn --username radek update ".$codebase." --force";` from my php script (on SuSE) every night before automation testing starts. So the testing is done on the latest code that was checked in today.

How can I for sure know that `svn up` finished successfully? So in case it wasn't the testing is not triggered?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T04:18:56.837

`svn update` should return a non-zero value if there were any failures (e.g. network error/disk error)

However an additional consideration is merge conflicts. `svn update` considers as "success" updating the working copy with merge conflicts.

Therefore, it may be important for you to also run `svn status -q` and look for files with "C" status, depending on your application--I'm assuming you want to take a different action if the update completes with conflicts.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T03:45:44.223

From the command line, I usually run `svn status -q` which should print nothing if everything is up to date. Otherwise, it will either error out, or display what files haven't been updated yet.

As others have mentioned, `svn up` should return a non-zero value if it failed for any particular reason.

You should look into using a continuous build system like [Jenkins](http://jenkins-ci.org). You could have Jenkins run your tests with every commit, or automatically have it run at a particular time during the day. This way, you're not reinventing the wheel. Plus, Jenkins could email the test results and give you a place to display them.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T01:23:56.677

use either the return code of the svn command(should be zero), or check the last line of the std-output. It should be something like:

```
At revision 123. 
```

Keep in mind, that you should have the correct LOCALE

# php - jQuery Mobile 登录脚本

> ID：10020903
> 
> 赞同：1
> 
> 时间：2012-04-04T23:54:52.303
> 
> 标签：php, jquery, mobile, login

我制作了一个基本的 HTML/PHP 登录页面和 jQuery 移动登录页面。我想让它们都提交到同一个名为 checklogin.php 的文件，如果登录成功，则旨在将它们重定向到各自的主页。它适用于基本页面，但不适用于 jQuery Mobile 页面。尝试通过移动页面提交会将我带到一个带有“未定义”短语的页面。

因此，我尝试编写一些 PHP 和 jQuery 脚本，以便如果检测到移动帖子，而不是立即转到主页，它会返回成功，并且登录页面本身会将用户重定向到主页面页。尽管出于测试目的单击提交会产生一个成功的“表单已发送”警报，但正确的登录不会使页面发生变化。我应该添加什么？

这是我的 PHP 登录检查器。

```
<?php
$host=// Host name
$username=// Mysql username
$password=// Mysql password
$db_name=// Database name
$tbl_name=// Table name

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form
$myusername=$_POST['myusername'];
$mypassword=$_POST['mypassword'];

// To prevent MySQL injection (a form of internet hacking)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);

$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);
// If result matched $myusername and $mypassword, table row must be 1 row

    if($count==1)
    {
        // Register $myusername, $mypassword and redirect to the main page"
        session_register("myusername");
        session_register("mypassword");
        //Send them back to the page they were at/
        if(!$_POST['mobile']) 
        {
            header("location:main.php");
        }
        else
        {

            header('HTTP/1.0 401 Unauthorized', true, 401);

        }
    }
    else 
    {
        echo "Wrong Username or Password";
    }

    ?> 
```

这是我在登录页面上用于重定向用户的脚本。

```
<script language="javascript">  
      // Global declarations - assignments made in $(document).ready() below  
      var hdrMainvar = null;  
      var contentMainVar = null;  
      var ftrMainVar = null;  
      var contentTransitionVar = null;  
      var stateLabelVar = null;  
      var whatLabelVar = null;  
      var stateVar = null;  
      var whatVar = null;  
      var form1var = null;  
      var confirmationVar = null;  
      var contentDialogVar = null;  
      var hdrConfirmationVar = null;  
      var contentConfirmationVar = null;  
      var ftrConfirmationVar = null;  
      var inputMapVar = null;  

      // Constants  
      var MISSING = "missing";  
      var EMPTY = "";  
      var NO_STATE = "ZZ";  

      function getFormValues() {
        data = {};
        data['username'] = $("#username").val();
        data['password'] = $("#password").val();
        return data;
      }

      function transmitPost() {
        $.ajax({
            url: 'checklogin.php',
            type:"post",
            data: getFormValues(),
            statusCode: {
            401: function() {
                alert("Wrong Password");
                },
            200: function() {
                window.location = "m/main.php";
                alert('Submitted');}
            }
            error: function(value) {
                alert("error");
            }
        });  
      }

      $('#submitButton').bind('click', function() {
        alert('User clicked on "foo."');
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T07:49:06.493

我还没有查看所有代码，但是当您将表单提交到非 jqm 页面时，您应该添加`data-ajax="false"`到`<form>`标签中。说 jqm 它应该正常加载页面，而不是将其解释为 jqm 页面的内容。这为我解决了“未定义”的事情......

# python - 将科学 python 集成到现有的 Rails webapp 中

> ID：10020908
> 
> 赞同：4
> 
> 时间：2012-04-04T23:55:17.587
> 
> 标签：python, ruby-on-rails, numpy

我喜欢使用正确的工具来完成这项工作。

在我的公司，数据分析师（包括我自己）主要使用 Python，因为它拥有强大的科学库；楼下的网络人员使用 Ruby on Rails 构建我们自己的人力资源管理 web 应用程序以及维护我们的在线形象。

我们希望两个团队更紧密地合作，以开发科学 web 应用程序，但不确定如何进行。

我们对这两种技术都有大量投资，我们需要继续使用大量代码库。

关于使用两种不同语言集成科学编程和 Web 应用程序这两个领域的最佳方法，有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:26:22.993

[我首先建议您评估一个SOA](http://en.wikipedia.org/wiki/Service-oriented_architecture)解决方案，而不是大幅拆分任何一个代码库以适应另一个代码库。

> *例如，为您的 Python 系统* **创建一个 API 接口**，并让 Rails 应用程序调用该 API 以满足 HR 和公共站点系统的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T02:16:07.650

我假设 Python 部分是一堆后端库/科学函数模块，而 Ruby-on-Rail 部分主要是前端。然后一个相对简单的解决方案是将这些 Python 模块/库包装到服务中，并让 Ruby-on-Rail 构建的前端函数调用这些服务。

要构建 Python 服务，您可以使用 xmlrpc 进行简单实现，或者使用一些复杂的框架（例如 twisted）进行更大规模的实现。你也可以只创建一个门户服务来托管你所有的 Python 模块/库，这基本上会给你一个应用程序服务器来处理来自 Ruby-on-Rails 前端的所有请求。使用哪种策略取决于 Python 库/模块的规模和复杂性。

# c# - 是否可以将 C# 双列表中的所有元素除以该双列表元素总和（这使得总计 = 1）

> ID：10020909
> 
> 赞同：7
> 
> 时间：2012-04-04T23:55:24.227
> 
> 标签：c#, list, elements, divide

想象一个像下面这样的双重列表

```
List<double> lstDouble=new List<double>{4,6,2,7,1,1}; 
```

所以我想要的是将此列表中的所有元素划分为元素的总和（21）。

因此列表在划分后变为：

```
lstDouble = {4/21,6/21,2/21,7/21,1/21,1/21} 
```

这意味着元素的新总和 = 1

我可以通过迭代等来做到这一点，但我想知道自从 Matlab 有什么捷径。我的助理教授一直告诉我学习 Matlab 并使用它，但我不想 :DI love C#

谢谢你。

C# 4.0 WPF 应用程序

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-04T23:59:35.437

```
var sum = lstDouble.Sum();
var result = lstDouble.Select(d => d / sum); 
```

*   [Enumerable.Sum 方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.sum.aspx)
*   [Enumerable.Select 方法](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.select.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-04T23:59:48.013

您可以使用 LINQ 执行此操作：

```
var sum = lstDouble.Sum();
var newLst = lstDouble.Select( x => x/sum ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-04T23:58:48.550

使用 lambda 表达式：

```
 lstDouble.ForEach(x => x = x/21); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T00:00:39.923

```
var sum = lstDouble.Sum();
var result = lstDouble.Select(v => v / sum); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-04T23:59:02.357

这是一个伪代码：

```
double sum = 0;
for(int i=0; i<array.length; i++)
   sum+=array[i];
for(int i=0; i<array.length; i++)
   array[i]=array[i]/sum; 
```

# wordpress - 如何更改wordpress中所有页面的“阅读更多”文本

> ID：10020913
> 
> 赞同：0
> 
> 时间：2012-04-04T23:56:04.193
> 
> 标签：wordpress

在 wordpress 中，我有 loop.php 文件。在那里我可以看到“阅读更多”代码。我更改了它，它确实在索引页面上生效。但是，如果我进入标签页面`../?tag=reference`，我会得到旧的“继续阅读”文本，而不是来自 loop.php 的“阅读更多”的编辑文本

这就是我在 loop.php 上的内容

```
<div class="entry-content">
<?php the_content( __( '<span class="read_more">Read More</span>', 'boilerplate' ) ); ?>
</div><!-- .entry-content --> 
```

这就是我在 tag.php 上使用的

```
get_template_part( 'loop', 'tag' ); 
```

但正如我所说，而不是得到“阅读更多”（当我进入索引页面时）我得到“继续阅读”

我查看了 general-template.php 和 functions.php 并没有任何迹象表明它与阅读更多代码有关。我在谷歌上的所有研究都只是指向编辑 loop.php 文件或创建一个新的 loop-tag.php 文件。我做了，但结果是一样的：我没有得到“阅读更多”，而是得到“继续阅读”

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:55:43.813

这实际上取决于您的主题以及如何将 loop.php 实现到每个主题文件中。

但请参阅[http://codex.wordpress.org/Customizing_the_Read_More](http://codex.wordpress.org/Customizing_the_Read_More)以获得更多帮助。

根据[http://wordpress.org/support/topic/theme-boilerplate-excerpt-more-link-customization?replies=3](http://wordpress.org/support/topic/theme-boilerplate-excerpt-more-link-customization?replies=3)：

```
function volta_setup() {
    remove_filter( 'get_the_excerpt', 'boilerplate_custom_excerpt_more' );
    remove_filter( 'excerpt_more', 'boilerplate_auto_excerpt_more' );
}

add_action('after_setup_theme', 'volta_setup'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T01:11:02.357

我以前曾与这种令人困惑的行为作斗争。`<!--more-->`当您使用标签和编辑帖子时使用摘录字段时，Wordpress 对待摘录的方式不同。

`<!--more-->`如果检测到标签，the_content() 只会在您的示例中包含使用“阅读更多”文本。

查看 Codex 了解更多详情。[http://codex.wordpress.org/Customizing_the_Read_More](http://codex.wordpress.org/Customizing_the_Read_More)

编辑：哎呀，@markratledge 已经为您指明了正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-20T10:12:48.227

这可能不是最佳实践，但就我而言，它解决了问题......

```
<script>
jQuery( document ).ready(function() {
jQuery(".read_more").text("Change me");
});
</script> 
```

[来源](https://divi.tutsdirectory.com/listing/change-read-more-button-text/)- 基于 DIVI 主题的阅读更多按钮

# coldfusion - Coldfusion - 四舍五入到最接近的 5 美分

> ID：10020917
> 
> 赞同：2
> 
> 时间：2012-04-04T23:56:33.097
> 
> 标签：coldfusion

在coldfusion中，如何将小数四舍五入到最接近的5美分？因此，0.39675 的数字将四舍五入为 0.40。如果这个数字是 0.3690，它会向下舍入到 0.35。我似乎无法通过谷歌找到任何有用的东西。

很抱歉这个简短的问题，但我认为这就是我真正可以输入的全部内容。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-05T00:15:48.713

乘以 20，四舍五入，除以 20：

```
 RoundedNumber = ( Round( Number * 20 ) / 20 ) 
```

# c - C 预处理器的 Null 指令有什么意义？

> ID：10020922
> 
> 赞同：7
> 
> 时间：2012-04-04T23:57:25.860
> 
> 标签：c, standards

因此，在翻阅 C99 标准的 n869 草案时，我偶然发现了这一节：

> **6.10.7 空指令语义**
> 
> 形式的预处理指令
> 
> ```
> # new-line 
> ```
> 
> 没有效果。

所以，我写了这个程序来测试它：

```
#
#include <stdio.h>
#

int main(void)
{
  puts("Hello, world!");

  return 0;
} 
```

果然`gcc`，即使我一路发出警告等等，我也对这段代码没有任何不满。我意识到该语言中还有一些其他不明显的结构，例如初始化程序中允许的额外逗号、枚举定义等，但这是有目的的（例如，简化了代码生成器的编写）。

但是，我看不出这个有什么用。任何人都可以想到一个合理的用例/理由吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T00:01:09.657

来自[GNU](http://gcc.gnu.org/onlinedocs/gcc-4.0.4/cpp/Other-Directives.html)文档：

> .....null 指令存在的主要意义在于输入行只包含一个`#' will produce no output, rather than a line of output containing just a`#'。据说一些旧的 C 程序包含这样的行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T00:08:33.253

来自 GCC 文档，第 1.7 节：

> 由#' 组成的n​​ull 指令`#' followed by a Newline, with only whitespace (including comments) in between. A null directive is understood as a preprocessing directive but has no effect on the preprocessor output. The primary significance of the existence of the null directive is that an input line consisting of just a`将不产生任何输出，而不是仅包含'#' 的一行输出。据说一些旧的 C 程序包含这样的行。

*   [http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html)

请记住，C 预处理器本身就是一个程序，它具有输入和输出。C 预处理器的输出通常*包括*程序注释，但如果注释出现在以“#”符号开头的行上，并且除了空格和注释之外没有其他内容，那么注释将不会出现在预处理器输出中。因此，null 指令会导致内容出现在源代码中，但不会出现在预处理器输出中。

例子：

预处理器将转换

```
#include <stdio.h>
#define HELLO 1
# /*This comment is for preprocessor only*/
HELLO
/*This comment is for preprocessed code*/ 
```

进入

```
(... preprocessed contents of stdio.h ...)
1
/*This comment is for preprocessed code*/ 
```

# java - Android HTTP Post 请求不起作用，但股票 Java 可以吗？

> ID：10020924
> 
> 赞同：0
> 
> 时间：2012-04-04T23:57:30.570
> 
> 标签：java, android, http, post, request

所以我有2个代码应该做同样的事情。然而，我在 Android 上使用的那个返回错误的 HTML 数据。股票 Java 一在发送请求后返回正确的数据。我这里有两个代码。你能告诉我（即使我给了 ANDROID 互联网许可）为什么 Android 不工作，而股票 Java 工作？这是安卓代码：

编辑：我找到了修复。如果要使用 StringEntity 将这样的字符串发送到服务器，则必须将内容设置为 application/x-www-form-urlencoded。我编辑了我的代码以显示这一点：

```
public static String sendNamePostRequest(String urlString) {

    HttpClient client = new DefaultHttpClient();

    HttpPost post = new HttpPost(urlString);

    StringBuffer sb = new StringBuffer();

    try {
           StringEntity se = new StringEntity(
                "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE3NDM5MzMwMzRkZA%3D%3D&__EVENTVALIDATION=%2FwEWBAL%2B%2B4CfBgK52%2BLYCQK1gpH7BAL0w%2FPHAQ%3D%3D&_nameTextBox=John&_zoekButton=Zoek&numberOfLettersField=3"); 

        se.setContent("application/x-www-form-urlencoded");

        post.setEntity();

        HttpResponse response = client.execute(post);
        HttpEntity entity = response.getEntity();

        BufferedReader br = new BufferedReader(new InputStreamReader(
                entity.getContent()));
        String in = "";

        while ((in = br.readLine()) != null) {
            sb.append(in + "\n");
        }

        br.close();

    } catch (Exception e) {
        e.printStackTrace();
    }

    return sb.toString();
} 
```

这是股票 Java 代码：

```
public String sendNamePostRequest(String urlString) {

    StringBuffer sb = null;

    try {
        String data = "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE3NDM5MzMwMzRkZA%3D%3D&__EVENTVALIDATION=%2FwEWBAL%2B%2B4CfBgK52%2BLYCQK1gpH7BAL0w%2FPHAQ%3D%3D&_nameTextBox=John&_zoekButton=Zoek&numberOfLettersField=3";

        // String data = "";

        URL requestUrl = new URL(urlString);

        HttpURLConnection conn = (HttpURLConnection) requestUrl
                .openConnection();

        conn.setDoOutput(true);
        conn.setDoInput(true);
        conn.setRequestMethod("POST");

        DataOutputStream dos = new DataOutputStream(conn.getOutputStream());

        dos.writeBytes(data);
        dos.flush();

        BufferedReader br = new BufferedReader(new InputStreamReader(
                conn.getInputStream()));

        String in = "";
        sb = new StringBuffer();

        while ((in = br.readLine()) != null) {
            sb.append(in + "\n");
        }

        dos.close();
        br.close();

    } catch (Exception e) {
        e.printStackTrace();
    }
    return sb.toString();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T04:19:38.183

您可以使用 NameValuePair 和 UrlEncodedFormEntity：

```
List<BasicNameValuePair> nvps = new ArrayList<BasicNameValuePair>();
nvps.add(new BasicNameValuePair(KEY1, VALUE1));
nvps.add(new BasicNameValuePair(KEY2, VALUE2));
UrlEncodedFormEntity p_entity = new UrlEncodedFormEntity(nvps,HTTP.UTF_8);
post.setEntity(p_entity); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T03:43:25.470

如果数据正在到达服务器，您可能想查看那里发生了什么（日志、错误、异常等）。除此之外：

*   use can use `HttpURLConnection`，所以你可以有完全相同的代码
*   对于 HttpClient，不确定您是否自己编码实体。用于`NameValuePair`设置参数，HttpClient 将为您（正确）编码。

# ios - 检查当前响应者？

> ID：10020931
> 
> 赞同：0
> 
> 时间：2012-04-04T23:58:32.010
> 
> 标签：ios, xcode, cocoa-touch

我正在制作一个应用程序，该应用程序需要使用多个带有数字键盘的文本字段作为第一响应者。我创建了一个图像用作否定按钮，它将作为数字键盘的补充。

我想知道是否有办法检查数字键盘正在输入的文本字段。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T01:51:20.370

如果您所有潜在的第一响应者都是 UITextFields，另一种方法是使您的控制器类符合 UITextFieldDelegate 协议，然后在开始编辑时获取对当前正在编辑的 UITextView 的引用。在 .h 中符合您的课程：

```
MyController : NSObject <UITextFieldDelegate>  //Might often be a UIViewController rather than an NSObject subclass... 
```

定义一个属性：

```
@property (weak, nonatomic) UITextField *editingField; 
```

然后在你的 .m 中合成：

```
@synthesize editingField = __editingField 
```

然后实现：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField
{
    [self setEditingField:textField];
}

- (void)textFieldDidEndEditing:(UITextField *)textField
{
    [self setEditingField:nil];
} 
```

现在，每当您想知道哪个文本字段是您的第一响应者时：

```
UITextField *firstResponder = [self editingField]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T01:39:13.597

如果它们的数量有限，您可以使用 [textFieldN isFirstResponder] 查询每个。如果你想要一个通用的实用程序，你可以查看视图中的每个子视图，看看它是否是第一响应者，或者它的任何子视图是否在层次结构中更远。

# cocoa-touch - 在基于 Cocoa Touch 的匿名类别中允许使用 ivars，但在“常规”Cocoa 中不允许使用？

> ID：10020932
> 
> 赞同：1
> 
> 时间：2012-04-04T23:58:40.633
> 
> 标签：cocoa-touch, cocoa, objective-c-2.0

在 iOS 和常规 OS X 开发之间切换时，我注意到两件事：

```
//SomeClass.h
@interface SomeClass: SomeUIClass

    @property (retain)SomeProperty* someProperty;

@end

//SomeClass.m
@interface SomeClass ()
{
    SomePrivateVar* somePrivateVar;
}
@end

@implementation SomeClass

@synthesize someProperty;
@end 
```

以上将在iOS下编译得很好。那是：

1.  我可以在公共 @interface 中不显式声明 ivar 的情况下合成属性
2.  我可以在匿名类别（类扩展名）下的 .m 文件中进一步声明其他私有 ivars。

但是，如果为 OS X 编译并继承一些基于 NS 的类而不是基于 UI 的类（例如，NSView 而不是 UIView），上述两种情况都会导致编译器错误。

我想我认为 Objective-C 2\. 通常允许上述内容，但它们只是 iOS 中的“快捷方式”？或者它们在 iOS 中被允许但在 OS X 中是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:13:54.580

这些是[“现代运行时”](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtVersionsPlatforms.html)的功能，只能用于 Mac OS X 上的 64 位应用程序。您可能正在构建一个还包括 32 位版本的通用二进制文件。

# c++ - 如何从 C++ 中的泛型类创建对象？

> ID：10020938
> 
> 赞同：0
> 
> 时间：2012-04-04T23:58:53.147
> 
> 标签：c++

我写了一个类，它有两个组件，一个随机类类型 T 和一个整数，我实现它如下： 在 Test.h 中像：

```
 template <class A, int B>class Test { // two components, 
    private: 
        A first;
        int second;

    public:
        Test();
        Test (A,int);
    } 
```

在 Test.cpp 我做了：

```
 template <class T,int i> Test<T,i>::Test() {}
    template <class A,int i>Test<A,i>::Test(T a, int b):first(a) {second=b;} 
```

**但是在主要功能中：**

```
 Test<int, int >  T1; //It can not be passed
    Test<int, 4> T2; //It can not be passed 
    int x = 8;
    Test<int, x> T3 (3,4);// can not be passed 
```

如何从上述泛型类声明对象实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T00:01:43.050

You forgot the semicolon at the end of the class template definition.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:03:51.910

```
template <class T,int i> Test<T,i>::Test() {}
template <class A,int i>Test<A,i>::Test(T a, int b):first(a) {second=b;} 
```

You need to put these two template function definitions in the header rather than the `.cpp` - the actual code needs to be made available to all compilation units that call these functions, not just the declaration.

```
Test<int, int >  T1; //It can not be passed 
```

This is invalid, the second `int` is a type, but the template expects an `int` value

```
Test<int, 4> T2; //It can not be passed 
```

There's nothing wrong with this

```
int x = 8;
Test<int, x> T3 (3,4);// can not be passed 
```

You need to make the first of these lines `static const x = 8` (i.e. make `x` a compile-time constant) to make it a usable as a template parameter

And there's also the missing semicolon at the end of the class definition.

# sharepoint - SharePoint 2010 与 PerformancePoint、Excel Services 和 Reporting Services 参考

> ID：10020940
> 
> 赞同：0
> 
> 时间：2012-04-04T23:58:59.143
> 
> 标签：sharepoint, sharepoint-2010, performancepoint, sharepoint-branding

我最近的任务是成为 SharePoint 2010 专家。但是，还包括 PerformancePoint Services (PPS)、Excel Services 和 Reporting Services (SSRS) 的集成。关于 PPS 的关键点是分解树和显示详细信息。SSRS 的使用将超出传统的报告查看器，但据我了解，它会返回随后在 PPS 中使用的图表。

我需要学习的下一个项目是品牌；具体从两个角度。首先，品牌化单个网站（网站集），例如 Intranet。下一个将是一个基于用户登录名或 URL 的网站。这方面的一个例子可能是每个客户都有自己的域/子域，每个客户都有自己的品牌。但是，所有这些都由同一个 SharePoint 实例托管。

我的问题是，由于我必须快速完成此操作，您会推荐什么作为必须参考？这可能包括操作方法、教程、博客、书籍、视频等。顺便说一下，我喜欢视频。我是一个视觉和动手类型的人。

永远不要少，谢谢你的想法！杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T16:39:49.027

对于那些也有兴趣学习 SharePoint 2010 和 PerformancePoint Services 2010 的人，这里有一些有用的链接：

在线的

*   SharePoint 培训索引： http: [//office.microsoft.com/en-us/sharepoint-server-help/CL010257455.aspx](http://office.microsoft.com/en-us/sharepoint-server-help/CL010257455.aspx)
*   SharePoint 培训： http: [//office.microsoft.com/en-us/sharepoint-server-help/CH010372432.aspx](http://office.microsoft.com/en-us/sharepoint-server-help/CH010372432.aspx)
*   SharePoint 列表：[http ://sharepoint.microsoft.com/Blogs/GetThePoint/Lists/Posts/Post.aspx?ID=383](http://sharepoint.microsoft.com/Blogs/GetThePoint/Lists/Posts/Post.aspx?ID=383)
*   SharePoint Pro IT 培训：[http ://technet.microsoft.com/en-us/sharepoint/ee410529](http://technet.microsoft.com/en-us/sharepoint/ee410529)
*   SharePoint 高级 IT 培训：[http ://technet.microsoft.com/en-us/sharepoint/ff678054.aspx](http://technet.microsoft.com/en-us/sharepoint/ff678054.aspx)
*   SharePoint 商业智能培训：[http ://technet.microsoft.com/en-us/sharepoint/hh239866](http://technet.microsoft.com/en-us/sharepoint/hh239866)
*   SharePoint 开发人员培训：http: [//msdn.microsoft.com/en-us/sharepoint/aa905692](http://msdn.microsoft.com/en-us/sharepoint/aa905692)
*   SharePoint 高级开发人员培训：[http ://technet.microsoft.com/en-us/sharepoint/ff420385.aspx](http://technet.microsoft.com/en-us/sharepoint/ff420385.aspx)

图书：

*   [Microsoft SharePoint 2010，释放](https://rads.stackoverflow.com/amzn/click/com/0672333252)
*   [SharePoint 2010 管理员指南](https://rads.stackoverflow.com/amzn/click/com/0735627207)
*   [专业版 SharePoint 2010 商业智能解决方案](https://rads.stackoverflow.com/amzn/click/com/1430232854)
*   [SharePoint 2010 商业智能，24 小时培训师](https://rads.stackoverflow.com/amzn/click/com/111802642X)
*   [使用 Visual Studio 2010 进行 SharePoint 2010 开发](https://rads.stackoverflow.com/amzn/click/com/0321718313)
*   [专业的 SharePoint 2010 品牌和用户界面设计](https://rads.stackoverflow.com/amzn/click/com/0470584645)

# iphone - 在 Xcode 4 中更改分支会使方案混乱

> ID：10020943
> 
> 赞同：0
> 
> 时间：2012-04-04T23:59:16.210
> 
> 标签：iphone, xcode, git, xcode4, xcode4.2

在 Xcode 4 中更改分支时，该方案会自动重置为 My Mac 64 位，而我正在制作 iPhone 应用程序。要解决这个问题，我需要创建一个新方案，并删除旧方案。当我需要切换分支时，有什么办法可以防止这种情况发生？

# javascript - jQuery UI，对齐网格示例，创建网格线？

> ID：10020947
> 
> 赞同：5
> 
> 时间：2012-04-04T23:59:51.477
> 
> 标签：javascript, jquery

尝试使用以下演示示例，使用 80px x 80px 对齐网格演示。

[http://jqueryui.com/demos/draggable/#snap-to](http://jqueryui.com/demos/draggable/#snap-to)

有没有办法在背景中显示一个网格，它也可以捕捉？现在它只是一个白色背景。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T00:04:51.240

用你喜欢的图像编辑程序制作一个 80 x 80px 的盒子，将其设置为容器的背景，并设置：

```
background-repeat: repeat; 
```

这样，背景将平铺。

粗略演示：http: [//jsfiddle.net/mostthingsweb/cRayJ/1/](http://jsfiddle.net/mostthingsweb/cRayJ/1/)

# c# - 礼品包装算法

> ID：10020949
> 
> 赞同：2
> 
> 时间：2012-04-05T00:00:06.007
> 
> 标签：c#, algorithm, c#-4.0

我将面板上的一组点保存到`List<MyVector> savedPoints`，然后我计算了坐标 y 最低的点：

```
 public void searchLowest()  
    {
        MyVector temp;
        double ylon = savedPoints[0].getY();
        for (int i = 0; i < savedPoints.Count; i++)
        {
            if (savedPoints[i].getY() > ylon)
            {
                ylon = savedPoints[i].getY();
                lowest = i;
            }
        }

        temp = savedPoints[lowest];
    } 
```

在此之后，我提出了一种计算极角的方法：

```
public static double angle(MyVector vec1, MyVector vec2) 
        {
            double angle = Math.Atan2(vec1.getY() - vec2.getY(), vec1.getX() - vec2.getX());
            return angle;
        } 
```

现在不知道如何在我的情况下使用礼品包装算法。WikiPedia[链接](http://en.wikipedia.org/wiki/Gift_wrapping_algorithm)上的伪代码对我来说不是很容易理解，所以我在这里寻求帮助。

我正在使用 C# 并赢得表单（net.framework 4.0）

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T03:19:54.417

以此为参考，[这里](https://stackoverflow.com/questions/3972154/why-doesnt-this-implementation-of-jarvis-march-gift-wrapping-algorithm-wor)是代码：

```
namespace GiftWrapping
{
    using System.Drawing;
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;

    class Program
    {
        static void Main(string[] args)
        {
            List<Point> test = new List<Point>(
                new Point[]
                    {
                        new Point(200,200), new Point(300,100), new Point(200,50), new Point(100,100),
                        new Point(200, 100), new Point(300, 200), new Point(250, 100), 
                    });

            foreach (Point point in ConvexHull(test))
            {
                Console.WriteLine(point);
            }

            Console.ReadKey();

        }

        public static List<Point> ConvexHull(List<Point> points)
        {
            if (points.Count < 3)
            {
                throw new ArgumentException("At least 3 points reqired", "points");
            }

            List<Point> hull = new List<Point>();

            // get leftmost point
            Point vPointOnHull = points.Where(p => p.X == points.Min(min => min.X)).First();

            Point vEndpoint;
            do
            {
                hull.Add(vPointOnHull);
                vEndpoint = points[0];

                for (int i = 1; i < points.Count; i++)
                {
                    if ((vPointOnHull == vEndpoint)
                        || (Orientation(vPointOnHull, vEndpoint, points[i]) == -1))
                    {
                        vEndpoint = points[i];
                    }
                }

                vPointOnHull = vEndpoint;

            }
            while (vEndpoint != hull[0]);

            return hull;
        }

        private static int Orientation(Point p1, Point p2, Point p)
        {
            // Determinant
            int Orin = (p2.X - p1.X) * (p.Y - p1.Y) - (p.X - p1.X) * (p2.Y - p1.Y);

            if (Orin > 0)
                return -1; //          (* Orientation is to the left-hand side  *)
            if (Orin < 0)
                return 1; // (* Orientation is to the right-hand side *)

            return 0; //  (* Orientation is neutral aka collinear  *)
        }
    }
} 
```

适应你的私人课程，将是你的功课。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T03:25:15.630

这是使用 WindowsBase 中的 System.Windows.Point 类的实现：

```
public struct PolarVector {
    public double Radius { get; set; }
    public double Angle { get; set; }

    public override string ToString() {
        return "{" + Radius + "," + Angle + "}";
    }
}

private static void Main(string[] args) {
    var points = new[] {
                            new Point {X = 0, Y = 0},
                            //new Point {X = 2, Y = 0},
                            new Point {X = 0, Y = 2},
                            new Point {X = 1.5, Y = 0.5},
                            new Point {X = 2, Y = 2},
                        };
    foreach(var point in ConvexHull(points)) {
        Console.WriteLine(point);
    }
    Console.WriteLine();
    if(Debugger.IsAttached) {
        Console.WriteLine("Press any key to exit...");
        Console.ReadKey();
    }
}

public static IList<Point> ConvexHull(IList<Point> points) {
    var pointOnHull = LeftMost(points);
    var pointsOnHull = new List<Point>();
    Point currentPoint;
    do {
        pointsOnHull.Add(pointOnHull);
        currentPoint = points[0];
        foreach(var nextPoint in points.Skip(1)) {
            if (currentPoint == pointOnHull || IsLeft(nextPoint, pointOnHull, currentPoint)) {
                currentPoint = nextPoint;
            }
        }
        pointOnHull = currentPoint;
    }
    while (currentPoint != pointsOnHull[0]);
    return pointsOnHull;
}

private static Point LeftMost(IEnumerable<Point> points) {
    return points.Aggregate((v1, v2) => v2.X < v1.X ? v2 : v1);
}

private static bool IsLeft(Point nextPoint, Point lastPoint, Point currentPoint) {
    var nextVector = ToPolar(nextPoint, lastPoint);
    var currentVector = ToPolar(currentPoint, lastPoint);
    return nextVector.Radius != 0 && Normalize(nextVector.Angle - currentVector.Angle) > 0;
}

private static PolarVector ToPolar(Point target, Point start) {
    var vector = target - start;
    return new PolarVector { Radius = Math.Sqrt((vector.Y * vector.Y) + (vector.X * vector.X)), Angle = Math.Atan2(vector.Y, vector.X)};
}

private static double Normalize(double radians) {
    while(radians > Math.PI) {
        radians -= 2*Math.PI;
    }
    while (radians < -Math.PI) {
        radians += 2*Math.PI;
    }
    return radians;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-31T23:53:36.563

对于礼品包装算法的实现，建议使用左测试技术

```
 // Left test implementation given by Petr 
    private static int Orientation(Point p1, Point p2, Point p)
    {
        // Determinant
        int Orin = (p2.X - p1.X) * (p.Y - p1.Y) - (p.X - p1.X) * (p2.Y - p1.Y);

        if (Orin > 0)
            return -1; //          (* Orientation is to the left-hand side  *)
        if (Orin < 0)
            return 1; // (* Orientation is to the right-hand side *)

        return 0; //  (* Orientation is neutral aka collinear  *)
    } 
```

可以这么说，使用这种（左测试）比较技术可以帮助我们更快地包装礼物。

永远不要使用反正切计算，它会在很大程度上影响运行时间。

参考：此处提到的左侧测试技术 - [https://stackoverflow.com/a/1560510/1019673](https://stackoverflow.com/a/1560510/1019673)

# c - 将一串数字转换为整数，存储结果

> ID：10020954
> 
> 赞同：0
> 
> 时间：2012-04-05T00:01:18.337
> 
> 标签：c

抱歉这个令人困惑的问题，但我想做的是将数组存储在变量中。

我想将数字存储在`*value`其中，而`int value: -12118433669`不是`int value: 123456789`.

输出

```
123456789
array: '123456789' int value: -1218433669
0001234
array: '0001234' int value: -1218433669
5
array: 'abc5xyz' int value: -1218433669

array: '' int value: -1218433669
987654321
array: '987654321' int value: -1218433669 
```

来源

```
#include <stdio.h>

MyFNatoi(char *numArray, int *value) {

    int i;

    for (i = 0; i < 10; i++) {
        if (numArray[i] > 47 && numArray[i] < 58) {
            printf("%c", numArray[i] - 0);
        }
    }

}

int main() {

    char numbers[5][10] = { "123456789", "0001234", "abc5xyz", "", "987654321" };
    int i, value;

    for(i = 0; i < 5; i++) {
        MyFNatoi(numbers[i], &value);
        printf("\narray: '%s' int value: %d\n", numbers[i], value);
    }
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T05:54:27.453

我提出这个功能：

```
void MyFNatoi(const char *str, int *value)
{
    if (value == NULL)
        return;

    *value = 0;

    if (str != NULL)
    {
        int negative = 0;

        if (*str == '-')
        {
            negative = 1;
            str++;
        }

        while (*str && isdigit(*str))
        {
            *value = (*value * 10) + (*str++ - '0');
        }

        if (negative)
            *value *= -1;
    }
} 
```

它处理负数，并且只检查前导数字（`"abc123def456"`例如，不会从中提取数字）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-05T00:55:28.423

**我的版本：**

```
void MyFNatoi(char *numArray, int *value)
{
    for (*value = 0; *numArray != '\0'; ++numArray) {
        if (0x30 <= *numArray && *numArray <= 0x39) {
            *value = 10* *value + *numArray - 0x30;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T10:14:11.453

```
#define Zero '0'
#define Nine '9'

void MyFNatoi(char *numArray, int *value) {

    int i;
    *value = 0;
    for (i = 0; i < 10 && numArray[i] != 0; i++) {
        if (numArray[i] >= Zero && numArray[i] <= Nine) {
            *value = *value * 10 + (numArray[i] - Zero);
        }
    }

} 
```

# java - 为什么在比较字符串、java 1.6.0_29、osx 时可以使用“==”？

> ID：10020955
> 
> 赞同：4
> 
> 时间：2012-04-05T00:01:22.510
> 
> 标签：java

昨天（2012 年 4 月 5 日）我正在尝试比较环境中的字符串：

电脑 1

1.  Java(TM) SE 运行时环境（构建 1.6.0_29-b11-402-11D50b）
2.  OS X 10.7.3

电脑 2

1.  Java(TM) SE 运行时环境（构建 1.6.0_29-b11-402-11D50b）
2.  窗口 7

电脑 3

1.  Java(TM) SE 运行时环境（构建 1.6.0_29-b11-402-11D50b）
2.  Linux Ubuntu 11.10

这是我正在尝试的代码

```
public class TComp{
    public static void main(String[] args){
        String a = "arif";
        String b = "arif";
        if(a==b){
            System.out.println("match!");
        }
    }
} 
```

据我所知，要在 java 中比较字符串，我们应该使用 .equal() 函数，而 '==' 将在这种情况下进行实习。但是对于那些所有具有不同操作系统的计算机，为什么实习生在计算机 1 上工作正常，而我在计算机 2 和计算机 3 上却出现错误？

如果我有任何错误，请纠正。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T00:21:10.357

在同一个类中，所有字符串常量都`.class`被编译器（在编译时）折叠到文件常量池中。这意味着编译器将只存储字符串的一份副本（因为谁需要在池中使用两个相同的常量？）。

这意味着在一个类中，`==`字符串的比较*通常是*有效的。然而，在你太兴奋之前，有一个很好的理由永远不要使用`==`字符串比较。 **不能保证**您比较的两个字符串都来自类内常量池。

所以，

```
"foo" == new String("foo") 
```

完全有可能失败，而

```
"foo" == "foo" 
```

可能会奏效。这*可能*在很大程度上取决于实现，如果您对实现而不是规范进行编码，那么如果实现发生更改，您可能会发现自己非常令人讨厌，因为规范实际上并不需要*该*实现。

简而言之，每次都`.equals(...)`用于比较。`Object`仅`==`用于原始比较和“这是同一对象实例”比较。即使您认为这两者`Strings`可能被实习（或同一个对象），因为您永远不知道何时会在不同的类加载器下、在不同的 JVM 实现上或在决定不实习所有内容的机器上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:04:48.743

字符串实习完全取决于编译器。== 不会“实习”任何东西；它只是比较对象身份。在某些情况下，a 和 b 可以指向同一个对象。在其他情况下，他们不会。两者都是合法的，所以你确实应该使用 .equals()。

另请参见[http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.5)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:51:50.987

这是因为每当您创建编译时常量字符串时，Java 都会执行[String interning 。](http://en.wikipedia.org/wiki/String_interning)

JLS 15.28。常量表达式

> 使用 String.intern 方法，String 类型的编译时常量表达式始终是“内部”的，以便共享唯一的实例。

这就是为什么在使用“==”进行比较时会得到 true 的原因，因为它们实际上是同一个对象。 String.valueOf() 的工作方式与字符串常量相同。

```
String x = "a";
String y = "a";
System.out.println(x == y); // true

String w = new String("b");
String z = "b";
System.out.println(w == z); // false 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T00:04:05.640

在一台计算机上，它们是同一对象，而在另一台计算机上却不是。语言的规则没有指定它们是否是同一个对象，所以它可以以任何一种方式发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T00:05:10.917

使用 == 来比较对象根本不可靠。除非你真的在寻找完全相同的实例，否则你永远不应该使用 == 来比较对象是否相等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T00:06:15.360

== 运算符确定两个对象引用是否指向同一个实例。

另一方面， .equals() 方法比较对象中的实际字符。

这些应该与您使用的计算机无关。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-05T00:42:47.420

最好的办法是始终使用 .equals 来比较对象。但是对于 String 如果您出于某些奇怪的原因需要使用 == 运算符，则需要确保比较[.intern 方法](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#intern%28%29)的结果。它总是返回实习值，并且文档告诉它是唯一的。医生说所有的 const 都是实习生的，也是独一无二的。

# c++ - 初始化 std::auto_ptr: "错误: 调用不匹配 '(std::auto_ptr ) (int*)'"

> ID：10020957
> 
> 赞同：1
> 
> 时间：2012-04-05T00:01:28.307
> 
> 标签：c++, raii, auto-ptr

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:07:41.293

要初始化类的字段，请使用初始化列表语法：

```
class Toy  {

public:
    std::auto_ptr<int> line;

    Toy() : line(new int(3))
    {

    }
}; 
```

否则，您可能会获得默认初始化`line`并使用其`reset`方法重新安装它：

```
class Toy  {

public:
    std::auto_ptr<int> line;

    Toy()
    {
        line.reset(new int(3));
    }
}; 
```

但是这段代码还有更多问题；首先，`new int(3)`不会创建三个`int`s 的数组（我认为您认为），但它会创建一个`int`初始化为`3`. 你的意思可能是`new int[3]`.

*但是*:`new int[3]`需要`delete[]`释放 a ，但`auto_ptr`使用 plain `delete`，即它不打算管理数组。这是因为标准库提供的用于管理数组的解决方案是`std::vector`，您可能应该使用它来代替自制解决方案，因为`std::vector`与“普通”动态数组相比几乎没有开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:04:37.573

您的麻烦不在于`auto_ptr`，而在于 C++ 中的构造函数。您需要在构造函数初始化列表中*初始化类成员：*

```
Toy() : line(new int(3)) { } 
```

请注意，这会创建一个`int`带有 value的动态`3`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:04:06.810

您没有调用构造函数。相反，您尝试调用一个不存在的函数调用运算符。这些将调用构造函数：

```
Toy() : line(new int(3)) { 
```

或（不完全是你想要的）

```
Toy() {
    auto_ptr<int> line(new int(3)); 
```

或（如上，不是你想要的）

```
Toy() {
    auto_ptr<int>(new int(3)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:05:35.577

那不是您构造成员变量的地方。您想使用初始化列表。

```
Toy() 
    : line(new int(3))
{ } 
```

成员是在您的类构造函数代码运行*之前构造的。*您可以在构造函数代码中分配它们。它们是按照它们在类定义中出现的顺序构造的，*而不是按照它们在这个列表中出现的顺序*。如果这个列表有问题，大多数编译器都会警告你，只是因为这样可以避免混淆。你也可以用同样的方式构造父对象，使用父类的类型（因为它没有名字）

```
class Toy : public Thing {
   Toy() : Thing("APPLE") {}
}; 
```

# ruby - Strip ruby string of a specific control character

> ID：10020962
> 
> 赞同：3
> 
> 时间：2012-04-05T00:02:21.837
> 
> 标签：ruby

This is pretty simple: how do I strip a ruby string of a special character? Here's the character: [http://www.fileformat.info/info/unicode/char/2028/index.htm](http://www.fileformat.info/info/unicode/char/2028/index.htm)

And here's the string, with the two special characters between the period and the ending quote:

```
"Each of the levels requires logic, skill, and brute force to crush the enemy.  " 
```

I've unsuccessfully tried this:

```
string.gsub!(/[\x00-\x1F\x7F]/, '') 
```

and `gsub("/\n/", "")`

I'm using ruby 1.9.3p125

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T02:33:26.557

`String#gsub` will work, but is more general and less efficient at this than [String#tr](http://ruby-doc.org/core-1.9.3/String.html#method-i-tr)

```
irb> s ="Hello,\u2028 World; here's some ctrl [\1\2\3\4\5\6] chars"
=> "Hello,\u2028 World; here's some ctrl [\u0001\u0002\u0003\u0004\u0005\u0006] chars"

irb> s.tr("\u0000-\u001f\u007f\u2028",'')
=> "Hello, World; here's some ctrl [] chars"

require 'benchmark'
Benchmark.bm {|x|
  x.report('tr')   { 1_000_000.times{ s.tr("\u0000-\u001f\u007f\u2028",'') } }
  x.report('gsub') { 1_000_000.times{ s.gsub(/[\0-\x1f\x7f\u2028]/,'') } }
}

          user     system      total        real
tr    1.440000   0.000000   1.440000 (  1.448090)
gsub  4.110000   0.000000   4.110000 (  4.127100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T00:09:32.520

我想到了！`.gsub(/\u2028/, '')`

# flash - Flash builder：如何在数据网格中获取选定的单元格值？

> ID：10020966
> 
> 赞同：2
> 
> 时间：2012-04-05T00:03:04.587
> 
> 标签：flash, datagrid, flash-builder

我有一个可编辑的数据网格。我想知道用户编辑单个单元格后是否可以检索单元格值。

如果用户完成编辑，我的数据网格将触发`griditemEditorSessionSave`事件，但我不知道如何获取新的单元格值。

```
//script
protected function dg_gridItemEditorSessionSaveHandler(event:GridItemEditorEvent):void
  {
     //I can only get the columnIndex but not the value
      Alert.show (event.columnIndex);

  } 

//mxml

<s:DataGrid id="dg" editable="true" x="5" y="3" width="734" height="153"
                  gridItemEditorSessionSave="dg_gridItemEditorSessionSaveHandler(event)"
>
....
.....

</Datagrid> 
```

有什么想法吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T01:21:20.587

是的，这是可能的..就在最近我遇到了同样的问题。我很熟悉这个主题中没有太多的 As3 文档，因此或多或少只是初始化 DataGrid 并填充它，因此；不抓住价值本身。

在我的 Datagrid 上，我发现每次编辑整个 dataGrid 时都更容易保存它，因为我没有找到为每个单独的单元格执行此操作的方法。就像用逗号分隔值的文本文件一样

使用循环函数遍历每个数组长度、列/行，如果您需要此项目的完整源代码，请转到：

[http://files.com/flash_files/3559/index.html](http://ffiles.com/flash_files/3559/index.html)

# c# - C# ArrayList Combinations

> ID：10020969
> 
> 赞同：1
> 
> 时间：2012-04-05T00:03:30.943
> 
> 标签：c#

```
static IEnumerable<string> GetCombinations(string s, int length) 
{
    if (length > s.Length || length == 0)
    {
        return new[] { String.Empty };
        if (length == 1)
        {
            return s.Select(c => new string(new[] { c }));
        }
    }
    return from c in s
    from combination in GetCombinations(
      s.Remove(s.IndexOf(c), 1),
      length - 1
    )
    select c + combination;
} 
```

This code work in strings.But I want ArrayList Combinations..For Example,

```
Arraylist.add('a,b');
Arraylist.add('a,c');
Arraylist.add('f,g');
Arraylist.add('h,l'); 
```

for length=3

```
'a,b,c','a,b,f','a,b,g'........ 
```

I'm sorry I'm new to C #.. Very even though I tried I could not.. Do you have an idea for this?

# html - Legend doesn't float left on IE7

> ID：10020972
> 
> 赞同：0
> 
> 时间：2012-04-05T00:03:46.737
> 
> 标签：html, css, internet-explorer-7, legend

I am having trouble on IE7\. I have following html format.

```
<fieldset class="wrapper">
    <legend class="ct">Legend </legend>
    <div class="ct">Div 1</div>
    <div class="ct">Div 2</div>
</fieldset> 
```

And this is the css style

```
.wrapper .ct {
    display:inline-block;
    *display:inline; /*IE7*/
    float:left
} 
```

when I test this on other browser it works fine but IE7 does not. Please see screenshot below. But if I use div instead legend then it works. Here is on [Jsfiddle](http://jsfiddle.net/2EZPY/2/) ![enter image description here](../Images/6adaab6d885316285d59ee418f2ed9bd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T03:29:29.340

安德烈斯几乎拥有它。在“float：left”之后添加一个“*float：none”，你应该很好。

```
.wrapper .ct {
    display:inline-block;
    float:left;
    *display:inline;
    *float:none;
}​ 
```

[这是更新的小提琴](http://jsfiddle.net/2EZPY/11/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T00:11:19.730

仅对于 IE7，尝试设置为 display: inline (not inline-block)。

对了，忘记了一个痛苦的传说是多少。您可能需要使用绝对位置来放置它 - 在其他位置上留有左边距或在父级上使用 padding-left。取决于设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T00:14:11.067

IE 不理解`display:inline-block`，您可以使用`display:inline`hack 来单独针对该浏览器，如下所示：

```
.wrapper .ct {
    display:inline-block;
    *display:inline;
    float:left
} 
```

# javascript - javascript / jquery - 查找数组中最接近的值

> ID：10020983
> 
> 赞同：0
> 
> 时间：2012-04-05T00:04:42.023
> 
> 标签：javascript, jquery

我正在修改 jquery ui 滑块。我希望用户能够滑动到某些“停止点”，以滑块总宽度的百分比表示。因此，例如，如果我有 3 个停靠点，它们将均匀分布在 0、50 和 100 (%) 处。我将这些存储在数组 [0,50,100] 中。

当用户拖动滑块并释放时，我捕获滑块的当前值。因此，如果他滚动了 56% 的横条，他的 stopVal 为 56。

如何编写一个函数来确定这个 stopVal 最接近数组中的哪个数字？这是我的代码：

```
var optValArr = [0,50,100];

function slideStop( event, ui ) {
    var stopVal = ui.value;
    //NOW NEED TO FIND CLOSEST ARRAY VALUE TO stopVal   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:18:43.477

这个功能可以让你做到这一点：

```
Array.prototype.closest = function(value) {
   var i;

   function diff(n) {
      var diff = n - value;

      return diff < 0 ? -diff : diff;
   }

   var found = this[0],
       mindiff = diff(found);

   for (i = 1 ; i < this.length ; i++) {
      var currentdiff = diff(this[i]);

      if (currentdiff < mindiff) {
          found = this[i];
          mindiff = diff(found);
      }
   }

  return found;
} 
```

现在你可以这样做：

```
var optValArr = [0,50,100];

function slideStop( event, ui ) {
    var stopVal = ui.value;
    //NOW NEED TO FIND CLOSEST ARRAY VALUE TO stopVal 

   stopVal = optValArr.closest(stopVal);
} 
```

注意：有些人认为为本地类型定义原型很危险，因为如果两个库做同样的事情（就像全局变量一样），它可能会导致冲突。因此，如果您正在编写公共库，则应避免添加到本机类型的原型中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T00:17:40.577

试试这个：

```
var optValArr = [0,50,100];

function slideStop( event, ui ) {
    var stopVal = ui.value;
    var diff=101;
    var val =0;

    for(var i =0; i < optValArr.length; i++){
        var tmpDiff = Math.abs(stopVal - optValArr[i]);
        if(tmpDiff < diff){
           diff=tmpDiff;
           val = optValArr[i]
        }
    }             
}
slideStop("something", {"value":20}); 
```

演示：http: [//jsfiddle.net/ggzZj/](http://jsfiddle.net/ggzZj/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T00:28:50.213

```
var optValArr = [0,50,100];

function slideStop( event, ui ) {
    var stopVal = ui.value;
    var closestVal = optValArr.reduce(function (memo, curr) {
        var currDiff = Math.abs(curr - stopVal),
            memoDiff = Math.abs(memo - stopVal)

        return memoDiff < currDiff ? memoDiff : currDif
    }) 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T00:23:19.013

“更接近”的另一个常见定义是基于差异的平方。但是，您可以通过简单地在原始数组中添加所需的数字来做到这一点，如下所示：

```
[10,40,50, my_number] 
```

然后，对数组进行排序，然后选择要从右侧还是左侧最接近的位置。

你怎么看？

# java - CNAME 和 cookie

> ID：10020987
> 
> 赞同：1
> 
> 时间：2012-04-05T00:05:07.703
> 
> 标签：java, servlets, cookies, cname

我有两个域 - abc.com 和 xyz.com。我有一个将 xyz.com 指向 abc.com 的 CNAME。xyz.com 设置 cookie nx=true。鉴于此设置，我应该能够读取 abc.com 上的 cookie。这是一个示例 Java 代码`在此处输入代码

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    PrintWriter out = response.getWriter();

    Enumeration<String> h = request.getHeaders("Cookie");
    while (h.hasMoreElements()) {
        out.println("From request.getHeaders(\"Cookie\")-->" + h.nextElement().toString());

    }
        out.flush();
    out.close();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T00:07:51.010

浏览器不知道（或关心）它是 CNAME、A 记录还是其他什么；它所知道的是它是一个**不同的域**，你不能设置跨域 cookie。您可能想查看“ [Facebook 如何设置和使用跨域 cookie](http://nfriedly.com/techblog/2010/08/how-facebook-sets-and-uses-cross-domain-cookies/) ”以获取提示或[此 SO 答案](https://stackoverflow.com/a/1095901/215042)。

如果您必须为域 abc.foo.com 和 xyz.foo.com 设置 cookie，那就完全是另一回事了。在这种情况下，您需要做的就是将 cookie 的域设置为不包括“子域”、“主机名”，以及您想要调用的“abc”和“xyz”。

有关更多信息，请查看[此 Wikipedia 文章](http://en.wikipedia.org/wiki/HTTP_cookie)。

# events - Dojo 中的 ArrowIndicator 事件处理

> ID：10020989
> 
> 赞同：1
> 
> 时间：2012-04-05T00:05:19.263
> 
> 标签：events, dojo, event-handling, gauge

我有一个仪表图，它有一个箭头指示器。我试图捕获箭头指示器上的值更改事件。我尝试了 dojo.connect() 和 on() 方法来为我的仪表设置事件处理程序，但两次都失败了。这就是我所做的...

```
var arrow = new dojox.gauges.AnalogArrowIndicator({....});

dojo.connect(arrow, 'change', handlerFunction); 
```

和

```
var arrow = new dojox.gauges.AnalogArrowIndicator({....});
define(["dojo/on"], function(on){
on(arrow, "change", myHandleFunction);
}); 
```

我没有收到任何错误消息或任何东西......我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T00:21:14.513

valuechange 事件在量表级别公开：

```
dojo.connect(gauge.indicators[0], "valueChanged", dojo.hitch(gauge, function(){
  //new value is in this.indicators[0].value
})); 
```

其中，gauge 是保存标尺 dijit 的 jsid 或 js 变量

根据您添加指标的方式，它可能是指标[1] 或类似的

# php - php 如何在 mySQL php 中将来自服务器 1 的查询结果插入到服务器 2 表中

> ID：10020994
> 
> 赞同：1
> 
> 时间：2012-04-05T00:05:58.530
> 
> 标签：php, mysql, fetch

我首先是 PHP 新手..

我的问题是，一旦我使用 mysql_query 从 Server1 获得 $result ，如何创建存储在 host2 中的 Table2

```
<?php

$connect1 = mysql_connect(host1,user,pass);
$selected = mysql_select_db(database1,$connect1);

$result = mysql_query("select a,b,c from table1");

$connect2 = mysql_connect(host2,user,pass);
$selected = mysql_select_db(database2,$connect2);

mysql_query("create table table2 as select $result from table2"); 

?> 
```

它们是两个不同的服务器（都在 MySQL 中）.. 详细回答将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T00:13:26.563

`mysql_query`接受两个参数。第二个是连接，你试过这个吗？

```
mysql_query("create table table2 as select $result from table2", $connect2); 
```

PHP 文档`mysql_query`： http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

# codeigniter - CodeIgniter 中的外部链接

> ID：10020996
> 
> 赞同：2
> 
> 时间：2012-04-05T00:06:04.553
> 
> 标签：codeigniter

我有以下代码：

```
<div><strong>Name: </strong><?php echo anchor('http://'.$link, $row->Name); ?></div> 
```

它需要用户输入链接（$link）并将 url 放入锚标记中。但是，它不会重定向到外部链接，而只是使用存储的 URL 修改站点的基本 URL。我试图将“http://”添加到提交的链接的开头，除非用户已经在链接输入中提供了 http，否则该链接有效。任何关于如何克服这个问题的建议都会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T04:04:21.687

是[的，根据文档](http://codeigniter.com/user_guide/helpers/url_helper.html)，`anchor()`根据您网站的 URL 创建链接。

如果在 URL 带有前缀时一切正常`http://`，但是您遇到用户有时添加`http://`有时不添加的问题，您可以~~简单地检查链接以确定它是否正常，或者是否需要添加前缀。这是一个使用的基本示例[`strpos`](http://php.net/manual/en/function.strpos.php)：~~

 ~~```
if(strpos($link, 'http') === FALSE){
    // link needs a prefix...
    $link = 'http://' . link;
} else {
    // link is ok!
} 
```~~  ~~...使用 CodeIgniter 的`prep_url()`功能（感谢[@cchana](https://stackoverflow.com/users/750593/cchana)提醒我！）：

> 如果 URL 中缺少方案，此函数将添加 http://。将 URL 字符串传递给函数，如下所示：
> 
> ```
> $url = "example.com";
> 
> $url = prep_url($url); 
> ```~~

# google-earth - Google Earth API - 绘制曲线？

> ID：10020997
> 
> 赞同：1
> 
> 时间：2012-04-05T00:06:06.970
> 
> 标签：google-earth, google-earth-plugin

我一直在玩谷歌地球 API。我认为从相对 3D 的角度在地点之间画一些线会很整洁。我搜索了通用电气文档并在谷歌上搜索了答案，但没有找到任何让我走上正确道路的东西，所以我想我会发布一些代码，也许会有所了解。

下面的代码绘制了两个地方，然后在这些地方之间画了一条线。不幸的是，绘制的线将地球连接起来。当像这样以 3D 绘制时，有没有一种方法可以让它包裹到地球的轮廓？我试图以不同程度的成功来改变线的高度位置，但是当线似乎没有连接这些地方时，会以准确性和整体视觉吸引力为代价。

```
function init() {
    google.earth.createInstance('map3d', initCB, failureCB);
}

function initCB(instance) {
    ge = instance;
    ge.getWindow().setVisibility(true);

    //---------------------------------PLACES   

    // Create the placemark.
    var placemark = ge.createPlacemark('');
    placemark.setName("Location 1");

    // Set the placemark's location.  
    var point = ge.createPoint('');
    point.setLatitude(39.96028);
    point.setLongitude(-82.979736);
    placemark.setGeometry(point);

    // Add the placemark to Earth.
    ge.getFeatures().appendChild(placemark);

    // Create the placemark.
    var placemark2 = ge.createPlacemark('');
    placemark2.setName("Hop #2");

    // Set the placemark's location.  
    var point2 = ge.createPoint('');
    point2.setLatitude(25.7615);
    point2.setLongitude(-80.2939);
    placemark2.setGeometry(point2);

    // Add the placemark to Earth.
    ge.getFeatures().appendChild(placemark2);

    //---------------------------------FOCUS

    var lookAt = ge.createLookAt('');
    lookAt.setLatitude(39.96028);
    lookAt.setLongitude(-82.979736);
    lookAt.setRange(1000000.0);
    lookAt.setAltitude(0);
    lookAt.setTilt(45);
    ge.getView().setAbstractView(lookAt);

    //---------------------------------LINES

    // Create the placemark
    var lineStringPlacemark = ge.createPlacemark('');

    // Create the LineString
    var lineString = ge.createLineString('');
    lineStringPlacemark.setGeometry(lineString);

    // Add LineString points
    lineString.getCoordinates().pushLatLngAlt(39.96028, -82.979736, 0);
    lineString.getCoordinates().pushLatLngAlt(25.7615, -80.2939, 0);
    //lineString.setAltitudeMode(ge.ALTITUDE_CLAMP_TO_GROUND);
    //lineString.setAltitudeMode(ge.ALTITUDE_RELATIVE_TO_GROUND);
    lineString.setAltitudeMode(ge.absolute);

    // Create a style and set width and color of line
    lineStringPlacemark.setStyleSelector(ge.createStyle(''));
    var lineStyle = lineStringPlacemark.getStyleSelector().getLineStyle();
    lineStyle.setWidth(2);
    lineStyle.getColor().set('9900ffff');  // aabbggrr format

    // Add the feature to Earth
    ge.getFeatures().appendChild(lineStringPlacemark);

}

function failureCB(errorCode) {
}

google.setOnLoadCallback(init); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:26:43.813

您需要将线串上的细分设置和可选的拉伸设置为 true。

有关详细信息，请参阅[https://developers.google.com/kml/documentation/kmlreference#tessellate](https://developers.google.com/kml/documentation/kmlreference#tessellate)和[https://developers.google.com/kml/documentation/kmlreference#extrude](https://developers.google.com/kml/documentation/kmlreference#extrude)

对于 API，您的语法类似于

```
lineStringPlacemark.setTessellate(true);
lineStringPlacemark.setExtrude(true); 
```

在[https://developers.google.com/earth/documentation/geometries上有一些额外的 API 示例](https://developers.google.com/earth/documentation/geometries)